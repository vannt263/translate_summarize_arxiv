{
  "article_text": [
    "particle systems appearing in plasma physics or radiative transfer can be described at different scales . when the system is far from its thermodynamical equilibrium , a kinetic description is necessary .",
    "particles are then represented by a distribution function @xmath1 which depends on time @xmath2 , position @xmath3 and velocity @xmath4 , @xmath5 . the distribution @xmath6 satisfies a collisional kinetic equation .",
    "particle methods are often used for simulating kinetic problems , especially in realistic @xmath7-dimensional situations , @xmath8 .",
    "however , they are affected by numerical noise due to their probabilistic character . a simple way to reduce",
    "this noise is to increase the number of particles , but then the numerical cost increases as well .",
    "other standard kinetic descriptions , as phase space grid methods , may require too much memory in the two or three dimensional framework .",
    "otherwise , macroscopic descriptions depending only on @xmath9 and @xmath10 can be sufficient if the system stays near its thermodynamical equilibrium , and are less expensive since their unknown does not depend on the velocity variable anymore . beside the noisy character of standard particle methods , there is an additional difficulty in kinetic descriptions which is linked to the presence of various scales in the system .",
    "multi - scale phenomena may indeed appear in plasma devices or radiative transfer applications , depending on some physical parameters as for example the mean free path of particles or the knudsen number denoted here by @xmath11 .",
    "this multi - scale character is often represented by stiff terms in the kinetic equation , and the general challenge is to construct efficient numerical methods for these multiscale kinetic equations : this means that , without numerically resolving the stiffness , the numerical method must solve accurately the kinetic regime , must have the right asymptotics in the high - stiffness limit ( the so - called asymptotic preserving property ) and its computational cost should decrease as the system approaches the equilibrium ( a time diminishing property ) .",
    "note that direct numerical methods whose parameters resolve the smallest scale of size @xmath11 are impossible to use , since they automatically involve an extremely high computational cost .",
    "several strategies have been proposed to overcome this strong constraint .",
    "domain decomposition methods can be applied when we have different regions with different values of the scaling parameter , see @xcite .",
    "when the different scales are less clearly delimited , we have to develop kinetic schemes that naturally reduce to good approximations of the macroscopic problem when the system goes near its equilibrium , and overcome the stiffness .",
    "such schemes are often called asymptotic - preserving ( ap ) , see @xcite .",
    "mainly , the numerical cost remains comparable to the one of the non - stiff kinetic problem , even when @xmath12 .",
    "our goal is to design an efficient ap scheme , _ using particles _",
    ", for the following kinetic radiative transport equation ( rte ) in the diffusion scaling @xmath13 where @xmath14 , @xmath15 , @xmath16 $ ] , @xmath17 and @xmath18 is a given initial condition .",
    "periodic boundary conditions are considered .",
    "it is well - known ( see @xcite ) that when @xmath11 goes to zero , the distribution function @xmath19 converges towards @xmath20 , where @xmath21 satisfies the following diffusion equation @xmath22    an extension to the vlasov - poisson - bgk case is presented in section [ ssec : e ] .",
    "the kinetic equation is coupled to a poisson equation for the electric field denoted by @xmath23 .",
    "more precisely , we consider @xmath24 where @xmath14 , @xmath25 , @xmath26 , @xmath27 is the absolute maxwellian and we consider periodic boundary conditions .",
    "note that an additional condition @xmath28 is imposed to obtain a well - posed problem .",
    "when @xmath11 goes to zero , the asymptotic model is a drift - diffusion equation satisfied by @xmath29 ( see @xcite ) @xmath30 where @xmath31 is linked to @xmath21 by the poisson equation @xmath32",
    ".    the strategy will be the use of the micro - macro decomposition ( see @xcite ) .",
    "it consists in writing the distribution function as the sum of the equilibrium part and a rest .",
    "one can then derive a system of two equations : a kinetic one for the rest @xmath33 and a macroscopic one for the equilibrium @xmath34 .",
    "ap micro - macro schemes for ( [ eq : etrbgk ] ) have been proposed in @xcite .",
    "these schemes consist in a semi - implicit phase space grid method for the kinetic part , coupled to a classical spatial grid method for the macro part .",
    "our strategy in this work follows the strategy of @xcite in the case of a fluid scaling : we use particles to sample the kinetic part whereas an eulerian solver is used to discretize the macro unknown .",
    "the main motivation of this strategy lies in the fact that the micro part @xmath35 converges to zero when @xmath11 goes to zero , so that a very few number of particles can sample it . as a consequence , in this regime",
    ", the cost of the global micro - macro solver is almost the same as the cost of an asymptotic solver for .    in this work ,",
    "we focus on a diffusion type scaling ( as in or ) so that an additional scale is involved compared to the fluid scaling considered in @xcite . in @xcite ,",
    "a diffusion scaling was studied , but using a fully grid based solver .",
    "hence , the stiffest term ( of order @xmath36 ) is considered implicit in time in the micro equation , which enables to stabilize the transport term ( of order @xmath37 ) and then to derive an ap scheme for and .",
    "the use of particles for the micro part prevents from a similar strategy since a splitting between the transport term ( of order @xmath37 ) and the source term needs to be done .",
    "then , a uniform stable scheme is hard to obtain in this context . to overcome this difficulty , a suitable formulation of the original model",
    "is performed so that the stiff transport term @xmath38 becomes @xmath39 .",
    "this reformulation is correct up to @xmath40 ( for fixed @xmath41 ) and has the good behavior when @xmath11 goes to zero ( for fixed @xmath42 ) .",
    "this formulation is the starting point of the design of micro - macro - particle based numerical schemes which enjoy the ap property and for which the numerical cost diminishes as @xmath11 goes to zero .",
    "this approach is extended to the second - order ( in time ) and to the vlasov - poisson - bgk case - .",
    "the sequel of the paper is organized as follows . in section [ sec:1storder_00 ] , we recall the formal derivation of the asymptotic model of and . the first - order ( in time )",
    "reformulation of is presented in subsection [ sec:1storder ] and its lagrangian discretization in subsection [ ssec : pic ] .",
    "its extension to a second - order in time model is detailed in section [ sec:2ndorder_0 ] : the continuous model is presented in subsection [ sec:2ndorder ] and its discretization is developed in subsection [ subsec : ordre2_discr ] .",
    "section [ ssec : e ] proposes an extension of our strategy to the vlasov - poisson - bgk system .",
    "finally , section [ sec : numres ] is devoted to numerical simulations .",
    "[ sec:1storder_00 ] in this section , we recall the main steps of the derivation of the model obtained from when @xmath11 goes to zero . to do so , we consider the micro - macro decomposition ( see @xcite ) of @xmath1 : @xmath43 , with @xmath44 , @xmath45 is the maxwellian equilibrium and the rest @xmath35 satisfies @xmath46 .",
    "here @xmath47 , with @xmath26 and we also use the notation @xmath48 . the following micro - macro model is equivalent to the original model @xmath49= -\\frac{1}{\\varepsilon^2}g .",
    "\\end{aligned }   \\right.\\ ] ] since @xmath50 and @xmath51 , the micro equation can be rewritten as[micro ] _ t g + = -g .",
    "when @xmath11 goes to zero , one gets from : @xmath52 .",
    "then the macro equation becomes @xmath53 = { \\cal o}(\\varepsilon),\\ ] ] which gives , using @xmath54 the following drift - diffusion equation satisfied by the limit @xmath21 @xmath55 the same calculations enables to derive the micro - macro model equivalent to @xmath56= -\\frac{1}{\\varepsilon^2}g ,     \\end{aligned }   \\right.\\ ] ] from which we derive the corresponding asymptotic model @xmath57 with @xmath17 , @xmath58 $ ] and @xmath59 .",
    "[ sec:1storder_0 ]    in this part , a first - order reformulation of the micro part is proposed , which enables to avoid the stiff transport term in space .",
    "the strategy is presented in the case of the equation and its corresponding micro - macro model .",
    "we start with ( [ eq : etrbgk ] ) ( with periodic boundary condition in space ) and consider the micro - macro decomposition of @xmath60 ( here @xmath61 for all @xmath62 $ ] ) and the micro - macro model .",
    "first , we rewrite the micro part of as [ eq : expg ] _ t ( e^t/^2 g ) = - ( , g ) , where @xmath63 is given by [ def : f ] ( , g ) = v_x + v_x g - _ x vg .",
    "we denote @xmath42 the time step , @xmath64 with @xmath65 .",
    "then , a second step consists in integrating on @xmath66 $ ] to get @xmath67 to derive a continuous ( in time ) equation , we make appear a discrete time derivative on the left - hand side [ micro2 ] = g(t^n ) - ( ( t^n),g(t^n ) ) + o(t^2 ) , which can be rewritten , up to terms of order @xmath68 , as @xmath69 we finally obtain the first - order reformulation of @xmath70 with @xmath63 given by .",
    "we remark that the micro equation does not contain any stiff term and then has a suitable form for a numerical discretization using particles .",
    "moreover , this first - order reformulation satisfies the following properties .",
    "* consistency : for all fixed @xmath71 , equation ( [ eq : mm_micro ] ) is consistent with the initial micro equation ( [ micro ] ) as @xmath0 goes to zero . *",
    "asymptotic behaviour : for all fixed @xmath72 , as @xmath11 goes to zero , we get from ( [ eq : mm_micro ] ) @xmath73 , which injected in the macro equation ( [ eq : mm_macro ] ) provides the limit model .",
    "this subsection is devoted to the derivation of an ap - particle based numerical scheme for ( [ eq : mm_macro])-([eq : mm_micro ] ) .",
    "[ [ explicit - in - time - discretization ] ] explicit in time discretization + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we propose now a lagrangian discretization of ( [ eq : mm_micro ] ) .",
    "more precisely , we adopt a particle method , see @xcite , and consider a set of @xmath74 macro particles . the position of particle @xmath75 , @xmath76 ,",
    "is denoted by @xmath77 $ ] , with @xmath78 , its velocity by @xmath79 $ ] and its weight by @xmath80 .",
    "let @xmath81 .",
    "the function @xmath35 is then assumed to be of the form @xmath82 where @xmath83 denotes the dirac mass function .",
    "weights @xmath84 are related to the distribution function @xmath35 through @xmath85 initially , particles are randomly distributed in the phase - space domain @xmath86\\times v$ ] and their weights are computed following ( [ eq : poids ] ) .    the density @xmath87 is computed on a uniform spatial grid defined by @xmath88 , @xmath89 , @xmath90 and @xmath91 .",
    "we denote by @xmath92 the approximation at time @xmath64 and position @xmath93 of @xmath94 , with @xmath42 the time step .",
    "moreover , @xmath95 , @xmath96 , @xmath97 and @xmath98 .",
    "let us remark that @xmath99 , so that the velocities @xmath100 are constant in time and we will note @xmath101 for all @xmath102 .",
    "our goal is then to extend the particle discretization of @xcite to diffusion scaling . to that purpose",
    ", we exploit the reformulation ( [ eq : mm_micro ] ) .",
    "as already said in @xcite , we have to use a splitting procedure between the transport part and the source part .",
    "then , the ( first - order ) splitting writes    * start with an initial repartition of the @xmath103 particles @xmath104 , with @xmath105 , * solve the transport part @xmath106 with the ( non stiff ) characteristics [ carx ] _",
    "k = v_k , * solve the source part @xmath107 , \\ ] ] using the equation satisfied by the weights [ weight ] _ k = _ k - .",
    "now , we detail the time discretization of the two steps .",
    "first , ( [ carx ] ) is approximated by a simple forward euler scheme [ carxd ] x_k^n+1 = x_k^n + ( 1-e^-t/^2)v_k .",
    "second , we compute the last term in . the term @xmath108 is approximated on the spatial grid @xmath93 using [ momg ] v g ( _ i ) _",
    "b_(_i - x_k^n+1 ) v_k , where @xmath109 is a b - spline function of order @xmath110 : @xmath111 we then approximate the equation on the weights ( [ weight ] ) using a first - order explicit integrator [ weightd ] ^n+1_k = e^-t/^2 _ k^n - ( 1-e^-t/^2 ) , with [ poids_rhs ] _",
    "k^n= v_k _ x ^n(x_k^n+1 )  _ k^n=- _ x vg ( x_k^n+1 ) . to compute @xmath112 ( resp .",
    "@xmath113 ) , since @xmath114 ( resp .",
    "@xmath108 ) is known on the spatial grid , we approximate @xmath115 ( resp .",
    "@xmath116 ) by centered finite differences and evaluate at @xmath117 using an interpolation with b - spline functions , for example @xmath118 finally , the macro equation ( [ eq : mm_macro ] ) is advanced through @xmath119 where @xmath120 is computed using .",
    "then , we have the following proposition .    the scheme given by ( [ carxd])-([weightd])-([macrod0 ] ) enjoys the ap property , _",
    "i.e. _ it satisfies the following properties    * for fixed @xmath41 , the scheme is a first - order ( in time ) approximation of the original model ( [ eq : etrbgk ] ) , * for fixed @xmath42 , the scheme degenerates into an explicit first - order ( in time ) scheme of .",
    "[ prop : lag_1st_exp ]    the consistency follows directly from standard approximation . for the asymptotic behavior ,",
    "when @xmath11 goes to zero , we get @xmath121 ( since @xmath122 @xmath123 ) . computing",
    "the momentum of @xmath124 means that we use ( [ momg ] ) with @xmath124 , or in the limit regime @xmath125|_{x=\\mbox{x}_i }   + { \\cal o}(\\varepsilon^2 ) \\nonumber\\\\ & \\approx & -\\varepsilon   \\frac{1}{3 } \\partial_x \\rho_i^n + { \\cal o}(\\varepsilon^2).\\end{aligned}\\ ] ] injecting in the macro equation ( [ eq : mm_macro ] ) then leads to a consistent discretization of .",
    "as detailed in @xcite , we have to correct the particle weights in order to preserve at the numerical level the micro - macro structure .",
    "indeed , the micro - macro decomposition technique uses the zero - mean property @xmath46 .",
    "but nothing guarantees that this property is satisfied at the discrete level ( on the weights @xmath126 ) .",
    "that is why we have to correct the weights , by applying a discrete approximation of the operator @xmath127 to each weight @xmath126 , which is consistent with the continuous model .",
    "we do not give the details of this correction ( called _ projection step _ in following algorithms ) and refer the reader to @xcite .",
    "[ [ implicit - time - discretization ] ] implicit time discretization + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this part , we want to make the previous scheme ( [ carxd])-([weightd])-([macrod0 ] ) degenerate into an implicit time discretization of ( as done in @xcite ) .",
    "to do so , we decompose ( [ weightd ] ) into two parts so that the macro flux becomes @xmath128 with @xmath129 given by and @xmath130 since @xmath112 is the weight of @xmath131 ( see ) and @xmath132 , we can write @xmath133 so that the macro scheme can be @xmath134 we can go further by considering now the diffusion term implicit in time to get @xmath135 we can write the following proposition .",
    "the scheme given by ( [ carxd])-([weightd])-([macrod0_cn ] ) enjoys the ap property , _",
    "i.e. _ it satisfies the following properties    * for fixed @xmath41 , the scheme is a first - order ( in time ) approximation of the original model ( [ eq : etrbgk ] ) , * for fixed @xmath42 , the scheme degenerates into an implicit first - order ( in time ) scheme of .",
    "[ prop : lag_1st_imp ]    instead of an implicit scheme , it is possible to use a crank - nicolson method .",
    "the scheme is finally summarized in the following algorithm .       * initialize @xmath104 , @xmath136 and @xmath137 .",
    "+ at each time step : * \\1 ) advance micro part : * * advance the characteristics with ( [ carxd ] ) , * * compute @xmath138 with ( [ momg ] ) , * * advance the equation on the weights with ( [ weightd ] ) . *",
    "\\2 ) projection step : compute @xmath139 using @xcite . *",
    "\\3 ) advance macro part : * * compute @xmath140 with ( [ momg ] ) , * * compute @xmath141 with ( [ macrod0_cn ] ) .",
    "[ algo : lag_1st ]",
    "this section is devoted to the derivation of a second - order scheme for the micro - macro system ( [ eq : micromacro_initial ] ) . as for the first - order scheme",
    ", we will first reformulate the microscopic equation ( [ micro ] ) in order to suppress stiff terms ( see subsection [ sec:1storder ] for the first - order case ) , and then discretize the obtained micro - macro model to get an ap efficient numerical scheme ( see subsection [ ssec : pic ] for the first - order case ) .",
    "let start from the following ( equivalent ) reformulation of the micro part of @xmath142 where @xmath63 is defined by .",
    "we now integrate with respect to @xmath143 $ ] and use a second - order mid - point quadrature @xmath144 to derive a continuous ( in time ) equation , we make appear a discrete time derivative on the left - hand side @xmath145 we now look for a continuous ( in time ) equation for which the previous relation is a second numerical scheme . to do so , we perform taylor expansions of the different terms at @xmath146 @xmath147 finally , the microscopic equation of is reformulated up to the second - order by @xmath148 and we can now consider the second - order reformulated micro - macro system @xmath149 .",
    "\\label{eq : mm_micro_2nd}\\end{aligned}\\ ] ]      we are now interested in the construction of an ap scheme for system ( [ eq : mm_macro_2nd])-([eq : mm_micro_2nd ] ) , based on a second - order runge - kutta ( rk2 ) method for the time discretization and a lagrangian method for the phase space discretization of the micro part .    the rk2 is based on a prediction step on @xmath150 ( first - order ) and a correction step on @xmath0 .",
    "then , a second - order ( in time ) scheme for ( [ eq : mm_macro_2nd])-([eq : mm_micro_2nd ] ) would read @xmath151 we still have to fix @xmath152 in in order to get a second - order scheme and to ensure the convergence of @xmath124 to zero as @xmath11 goes to zero .",
    "it turns out the choice @xmath153 ensures the two conditions .",
    "indeed , we get for the correction step of the micro part @xmath154 up to now , the micro part converges exponentially fast to zero ( when @xmath11 goes to zero ) , so that the asymptotic behavior of the scheme is @xmath155 .",
    "hence , the last but not the least step consists in modifying the macro part to capture the correct asymptotic limit .    as done in section [ sec:1storder_0 ] , we will modify the discretization in order to make appear the diffusion term directly in the macro part .",
    "however , the modification has to be of order @xmath156 for a fixed @xmath41 to not spoil the second - order accuracy of the scheme .",
    "the correction we propose consists in computing @xmath157 using a crank - nicolson scheme for the diffusion weighted which is of order @xmath158 for fixed @xmath41 and which degenerates to @xmath0 when @xmath11 goes to zero @xmath159      we consider the same notations as in subsection [ ssec : pic ] and detail here the lagrangian discretization of the micro - macro system ( [ eq : mm_macro_2nd])-([eq : mm_micro_2nd ] ) . in the prediction step ,",
    "we compute @xmath160 with a forward euler integrator @xmath161 and advance the weights with @xmath162\\frac{l_xl_v}{n_p}.   \\end{split}\\label{eq : poids_pred}\\ ] ] we end this prediction step by computing the flux @xmath163 with to get the density @xmath164 now in the correction step , we compute the position at @xmath165 with @xmath166 then the weights are given by @xmath167\\frac{l_xl_v}{n_p}. \\label{eq : poids_corr}\\ ] ] now , using in the last step , we have @xmath168 where @xmath169 is computed using .",
    "we finally have the following result .",
    "the scheme given by ----- enjoys the ap property , _",
    "i.e. _ it satisfies the following properties    * for fixed @xmath41 , the scheme is a second - order ( in time ) approximation of the original model ( [ eq : etrbgk ] ) , * for fixed @xmath42 , the scheme degenerates into an implicit second - order ( in time ) scheme of .",
    "[ prop : lag_2st ]    when @xmath170 , we get from ( [ eq : poids_pred ] ) @xmath171 exponentially fast and then @xmath172 . by injecting it in the macro equation ( [ eq : rho_corr ] )",
    ", we have at the limit @xmath173 , which is a crank - nicolson discretization of the diffusion equation .",
    "let us emphasize that the moments @xmath174 have to be computed with b - spline functions of order @xmath175 in order to obtain a second - order in time scheme .",
    "taking @xmath176 would lead to space discontinuities preventing the time scheme to be of second - order .",
    "the projection step being by construction a first - order step , we do it in the prediction step .",
    "the scheme is finally summarized in the following algorithm .",
    "* initialization of @xmath104 , @xmath136 and @xmath137 .",
    "+ at each time step : + * prediction step : from @xmath177 to @xmath146 . * * \\1 ) advance micro part : * * advance the characteristics with ( [ eq : cara_pred ] ) , * * compute @xmath138 with ( [ momg ] ) and b - spline functions of order @xmath175 , * * advance the equation on the weights with ( [ eq : poids_pred ] ) . *",
    "\\2 ) projection step : compute @xmath178 using @xcite . * \\3 ) advance macro part : * * compute @xmath163 with ( [ momg ] ) and b - spline functions of order @xmath175 , * * compute the density with ( [ eq : rho_pred ] ) . + * correction step : from @xmath177 to @xmath165 . * * \\4 ) advance micro part : * * advance the characteristics with ( [ eq : cara_corr ] ) , * * compute @xmath138 with ( [ momg ] ) and b - spline functions of order @xmath175 , * * advance the equation on the weights with ( [ eq : poids_corr ] ) . *",
    "\\5 ) advance macro part with ( [ eq : rho_corr ] ) .",
    "[ algo:2ndorder ]",
    "this section is devoted to the extension of our method to kinetic equation making appear an electric field in the velocity direction .",
    "we consider the vlasov - poisson - bgk system in the diffusion scaling @xmath179 where @xmath180\\subset\\mathbb{r}$ ] , @xmath181 and @xmath27 is the absolute maxwellian .",
    "let @xmath182 the initial distribution function and let consider periodic boundary conditions in @xmath10 : @xmath183 , @xmath184 , @xmath185 @xmath186 .",
    "we can extend our schemes to this problem by adapting the computations of subsections [ sec:2ndorder ] and [ subsec : ordre2_discr ] .",
    "we do not give all the details of the computations but insist on difficulties coming from the electric field term and write the resulting schemes .",
    "the second - order reformulated micro - macro system corresponding to ( [ eq : vlasovbgk ] ) is @xmath187 .",
    "\\label{eq : mm_micro_2nd_bis}\\end{aligned}\\ ] ] the limit model is here the drift - diffusion equation coupled to poisson equation ( [ eq : ddlimit ] ) .",
    "equipped with this system ( [ eq : mm_macro_2nd_bis])-([eq : mm_micro_2nd_bis ] ) , we construct the following lagrangian , second - order in time scheme for ( [ eq : vlasovbgk_2])-([eq : poisson])-([eq : zeromean ] ) . in the prediction step , characteristics are solved through @xmath188 the weights evolve with @xmath189\\frac{l_xl_v}{n_p } \\end{split } \\label{eq : poidswithe}\\ ] ] and the macro equation is advanced with @xmath190    in the correction step , characteristics are solved through @xmath191 the weights evolve with @xmath192\\frac{l_xl_v}{n_p}. \\end{split } \\label{eq : poidswithe2}\\ ] ] and the macro equation is advanced with @xmath193    the limit has been directly written in the macroscopic equation and the diffusion term is managed by a crank - nicolson method , in the prediction as well as in the correction step .",
    "we have the following proposition .",
    "the scheme given by ----- enjoys the ap property , _",
    "i.e. _ it satisfies the following properties    * for fixed @xmath41 , the scheme is a second - order ( in time ) approximation of the original model ( [ eq : vlasovbgk ] ) , * for fixed @xmath42 , the scheme degenerates into an implicit second - order ( in time ) scheme of .",
    "the scheme is finally summarized in the following algorithm .       * initialize @xmath104 , @xmath136 , and @xmath194 . *",
    "compute @xmath195 thanks to fft or finite differences . at each time step : + * prediction step : from @xmath177 to @xmath146 . * * \\1 ) advance micro part : * * advance the characteristics with ( [ eq : characwithe ] ) , * * compute @xmath138 with ( [ momg ] ) and b - spline functions of order @xmath175 , * * advance the equation on the weights with ( [ eq : poidswithe ] ) . *",
    "\\2 ) projection step : compute @xmath178 using @xcite . * \\3 ) advance macro part : * * compute @xmath163 with ( [ momg ] ) and b - spline functions of order @xmath175 , * * compute @xmath196 with ( [ eq : rhowithe ] ) , * * compute @xmath197 thanks to fft or finite differences .",
    "+ * correction step : from @xmath177 to @xmath165 . * * \\4 ) advance micro part : * * advance the characteristics with ( [ eq : characwithe2 ] ) , * * compute @xmath138 with ( [ momg ] ) and b - spline functions of order @xmath175 , * * advance the equation on the weights with ( [ eq : poidswithe2 ] ) . *",
    "\\5 ) advance macro part : * * compute @xmath157 with ( [ eq : vp_lag_2nd_man ] ) , * * compute @xmath198 thanks to fft or finite differences .",
    "[ algo : vp_lag_2nd ]    we propose to use an upwind discretization of the derivative @xmath199 : @xmath200 where the standard notations @xmath201 and @xmath202 are used .",
    "the same discretization is done for @xmath203 in the prediction step .",
    "this section is devoted to some numerical experiments comparing the here designed micro - macro model with particles ( denoted by mima - part-1 for the first - order scheme and by mima - part-2 for the second - order scheme ) to the micro - macro eulerian model ( denoted by mima - grid ) , the moment guided method ( denoted by moment g. ) and ( i ) the full pic method in kinetic regimes ( @xmath11 of order 1 ) or ( ii ) the limit scheme in diffusion regime ( @xmath12 ) .",
    "mima - part-1 corresponds to proposition [ prop : lag_1st_imp ] and mima - part-2 corresponds to proposition [ prop : lag_2st ] .",
    "the micro - macro eulerian scheme is presented in appendix [ subsec : eulerian ] .",
    "the moment guided method was first presented in @xcite and is adapted to our context in appendix [ app : mgm ] .",
    "the full pic method @xcite consists in applying the particle representation ( [ eq : diracmasses ] ) to the whole function @xmath1 ( and not only to the perturbation @xmath35 ) and to solve the characteristics and the equations on weights coming from equation or . in the sequel",
    ", we consider three families of test cases : radiative transport equation ( rte ) test cases with periodic boundary conditions ( see equation ( [ eq : etrbgk ] ) ) in subsection [ ssec : rteperio ] , vlasov - poisson - bgk test cases ( see equations ( [ eq : vlasovbgk])-([eq : vlasovbgkpoisson ] ) ) of landau damping type in subsection [ ssec : landau ] and two - stream instability ( tsi ) test cases in subsection [ ssec : tsi ] .",
    "we consider the rte test case given by the initial condition @xmath204 , v\\in\\left[-1,1\\right],\\ ] ] with @xmath205 $ ] , and periodic boundary conditions in @xmath10 .",
    "we propose here to verify numerically the convergence of mima - part-2 ( presented in subsection [ ssec : pic_o2 ] ) , lagrangian in space , of second - order in time and with an implicit treatment of the diffusion term ( see algorithm [ algo:2ndorder ] ) . in figure",
    "[ fig : etr_ordre2_1 ] , we plot the error in @xmath206 norm of the density @xmath87 at time @xmath207 as a function of @xmath0 ( from @xmath208 to @xmath209 ) for the following parameters : @xmath210 , @xmath211 . for @xmath212 , @xmath213 and @xmath209 ,",
    "the reference solution is computed with mima - part-2 using the same parameters but with @xmath214 .",
    "whereas for @xmath215 , the reference is a numerical solution of the diffusion equation ( computed on a space grid , with @xmath210 and @xmath214 ) . in figure [ fig : etr_ordre2_cloche ] , the error in @xmath206 norm is now represented as a function of @xmath11 for different values of @xmath0 : @xmath216 , @xmath217 , @xmath218 and @xmath208 .",
    "these plots confirm the fact that mima - part-2 is second - order accurate in time for any fixed @xmath41 , and also when @xmath170 .",
    "however , for intermediate regimes ( for instance @xmath219 ) , order reduction is observed .",
    "this is a classical observation for ap schemes .",
    "note that similar behaviour is obtained with @xmath220 norm .    in figure",
    "[ fig : etr_ordre2_ap ] , we verify the ap property of the mima - part-2 scheme and plot the density @xmath221 as a function of @xmath10 for different values of @xmath11 : @xmath222 , @xmath223 , @xmath217 and @xmath224 .",
    "we take fixed parameters : @xmath225 , @xmath226 and @xmath227 .",
    "we compare the solutions obtained by mima - part-2 to a numerical solution of the diffusion equation ( computed on a space grid , with @xmath228 and @xmath229 ) and see that the @xmath11-dependent solutions come closer to the diffusion one when @xmath11 decreases .",
    "moreover , we illustrate in figure [ fig : etr_ordre2_npart ] the fact that the cost of our method is very small at the limit . for that , we plot the density @xmath221 as a function of @xmath10 for @xmath215 ( @xmath225 and @xmath230 ) and see that @xmath211 is sufficient to represent in a good way ( without noise ) the density .",
    "the numerical cost is then very close to the one of the asymptotic model .            in this subsection",
    ", we present landau damping test cases in both regimes ( kinetic when @xmath231 and diffusive when @xmath170 ) .",
    "the initial distribution function is given by @xmath232,~v\\in \\mathbb{r},\\ ] ] with the wave number @xmath233 and @xmath234 .",
    "for the micro - macro model ( [ eq : vlasovbgk ] ) , the initial condition is @xmath235 and @xmath236 .",
    "for the limit drift - diffusion equation ( [ eq : drift - diff ] ) , we have @xmath235 .",
    "we first verify the order in time of the mima - part-2 scheme detailed in section [ ssec : e ] and plot in figure [ fig : vp_ordre2_1 ] the error in @xmath206 norm of the density @xmath87 at time @xmath207 as a function of @xmath0 ( from @xmath208 to @xmath209 ) for the following parameters : @xmath210 , @xmath211 . for @xmath212 , @xmath213 and @xmath209 , the reference solution is computed with mima - part-2 using the same parameters but with @xmath214 . whereas for @xmath215",
    "the reference is a numerical solution of the drift - diffusion equation ( computed on a space grid , with @xmath210 and @xmath214 ) .",
    "results are similar to the rte case : the second - order in time is preserved for big and small values of @xmath11 but not for intermediate regimes .",
    "we are now interested in more qualitative tests by considering the time history of the electric energy @xmath237 in semi - logarithmic scale for different values of @xmath11 .",
    "we compare the results obtained by mima - part-2 ( detailed in algorithm [ algo : vp_lag_2nd ] ) to other schemes : mima - part-1 , moment g. and full pic ( for @xmath11 of order 1 ) or the scheme for the drift - diffusion model ( for small values of @xmath11 ) .",
    "we expect that the number of particles that is necessary to represent in a good way the perturbation @xmath35 in mima - part methods decreases when @xmath11 diminishes and consider @xmath238 if @xmath239 , @xmath240 if @xmath219 and @xmath241 if @xmath242 . for comparison ,",
    "we take the same @xmath103 for moment guided and full pic methods .",
    "results for @xmath243 are given in figure [ figlandaukin10 ] .",
    "for the four particle methods , we take @xmath244 , and @xmath245 . with the same parameters , results for @xmath212",
    "are presented in figure [ figlandaukin ] . for @xmath246 ,",
    "we consider @xmath247 and @xmath248 for the four particle methods .",
    "results are given in figure [ figlandauinter ] .",
    "for these three values of @xmath11 , the reference is given by mima - grid with @xmath249 and @xmath250 .",
    "first , we note that the behaviour of the electric energy is well described during time by micro - macro schemes ( mima - part and mima - grid ) .",
    "as observed in @xcite , the full pic method suffers from numerical noise .",
    "this is due to the probabilistic character of particle methods ( for instance the random initialization of particles ) . to reduce this noise",
    ", we should consider more particles , which would increase the numerical cost .",
    "as expected , the moment guided method gives better results than the full pic one , but suffers however also from this noise .",
    "in mima - part schemes , only the perturbation @xmath35 is represented by particles ( not the whole distribution function @xmath1 ) , that is why for the same @xmath103 , the noise is lower , which enables to capture the reference solution for large times . in addition , mima - part-2 is closer to the reference mima - grid than the first - order version mima - part-1 .",
    "[ h ]    [ h ]       [ h ]       for smaller values of @xmath11 , we compare the four ap schemes ( mima - part-1 , mima - part-2 , mima - grid and moment g. ) to the limit scheme .",
    "results for @xmath219 are given in figure [ figlandaudif ] .",
    "parameters are the following : @xmath226 and @xmath245 for particle methods , @xmath251 and @xmath252 for mima - grid .",
    "we observe that mima - part-2 is the best method since it almost coincides with the reference mima - grid method .",
    "finally , results for @xmath242 are given in figure [ figlandaudiflim ] , where we have @xmath230 and @xmath245 for particle methods , @xmath251 and @xmath252 for mima - grid .",
    "the asymptotic regime is well recovered by all these ap methods .",
    "[ h ]        [ h ]       as in @xcite , we remark that few particles are sufficient in the particle - micro - macro schemes to describe in a good way the solution when @xmath11 is small .",
    "the cost is then reduced at the limit .",
    "we propose now a study in which the perturbation @xmath35 is not zero initially and consider the two - stream instability ( tsi ) test case in both regimes ( kinetic and diffusive ) .",
    "the initial distribution function is given by @xmath253,~v\\in\\mathbb{r},\\ ] ] with the wave number @xmath233 and @xmath234 .",
    "the initial condition for the micro - macro model ( [ eq : vlasovbgk ] ) is @xmath235 and @xmath254 .",
    "for the limit drift - diffusion equation ( [ eq : drift - diff ] ) , we have as in the landau damping case @xmath235 .",
    "we first verify the order in time of the mima - part-2 scheme detailed in section [ ssec : e ] and plot in figure [ fig : tsi_ordre2_1 ] the error in @xmath206 norm of the density @xmath87 at time @xmath207 as a function of @xmath0 ( from @xmath208 to @xmath209 ) for the following parameters : @xmath210 , @xmath211 . for @xmath212 , @xmath213 and @xmath209 ,",
    "the reference solution is computed with mima - part-2 using the same parameters but with @xmath214 .",
    "whereas for @xmath215 , the reference is a numerical solution of the drift - diffusion equation ( computed on a space grid , with @xmath210 and @xmath214 ) .    as for the rte and the landau damping cases , the second - order in time is preserved for big and small values of @xmath11 but not for intermediate regimes .",
    "we are now interested in the time evolution of the electric energy @xmath237 in all regimes .",
    "results for @xmath243 are given in figure [ figtsikin10 ] .",
    "for the four particle methods , we take @xmath255 , @xmath244 , and @xmath245 . by taking @xmath238 , @xmath244 , and @xmath245 for particle methods ,",
    "we obtain results for @xmath212 presented in figure [ figtsikin ] . for @xmath246 ,",
    "we consider @xmath238 , @xmath247 and @xmath248 for the four particle methods .",
    "results are given in figure [ figtsiinter ] .",
    "for these three values of @xmath11 , the reference is given by mima - grid with @xmath249 and @xmath250 .",
    "the behaviour of the electric energy is well described during time by micro - macro schemes ( mima - part and mima - grid ) . as previously , the full pic method , as well as moment guided method suffer from numerical noise .",
    "[ h ]    [ h ]       [ h ]       to illustrate the efficiency of the method , we plot @xmath256 obtained by the reference mima - grid , by mima - part-2 and by full pic for @xmath243 on figure [ fig3deps10 ] and for @xmath246 on figure [ fig3deps05 ] . for mima - grid and mima - part-2 ,",
    "@xmath1 is reconstruted from @xmath35 , @xmath87 and @xmath257 , whereas the approximation of @xmath1 is directly given by the full pic scheme .",
    "the numerical parameters are the same as previously ( see comments on figures [ figtsikin10 ] and [ figtsiinter ] ) . on figure [ fig3deps10 ] , we observe that the result obtained by mima - part-2 and full pic are in good agreement with mima - grid ; however , some numerical noise can be distinguished on @xmath1 obtained by the full pic method . on figure [ fig3deps05 ] ( @xmath246 )",
    ", we can see clearly that the level of the noise is higher for full pic , which prevents it from giving good results . on the contrary ,",
    "mima - part-2 produces good results compared to mima - grid , since the noise only affects the micro part @xmath35 , which is small in this regime .",
    "[ h ]      [ h ]      for smaller values of @xmath11 , we compare the four ap schemes ( mima - part-1 , mima - part-2 , mima - grid and moment g. ) to the limit scheme .",
    "results for @xmath258 are given in figure [ figtsidif ] .",
    "parameters are the following : @xmath226 , @xmath245 and @xmath227 for particle methods , @xmath251 and @xmath252 for mima - grid . as in the landau damping case , mima - part-2 gives the best result comparing to the reference mima - grid . finally , results for @xmath242 are given in figure [ figtsidiflim ] , where we have @xmath230 , @xmath245 and @xmath211 for particle methods , @xmath251 and @xmath252 for mima - grid .",
    "the asymptotic regime is well recovered by all these ap methods .",
    "[ h ]        [ h ]",
    "in this paper , we have presented new micro - macro models for the kinetic radiative transport equation ( rte ) , as well as for the vlasov - poisson - bgk system , in the diffusion scaling with periodic boundary conditions .",
    "first - order in time and second - order in time models are derived , and their lagrangian discretizations are detailed .",
    "the obtained schemes are proved to degenerate into implicit discretizations of the limit model ( the diffusion equation in the rte case and the drift - diffusion equation in the vlasov - poisson - bgk case ) when @xmath170 .",
    "this asymptotic property is shown in the numerical results too .",
    "moreover , thanks to the use of particle methods for the microscopic equation , the numerical cost is reduced when @xmath11 diminishes .",
    "finally , compared to a standard pic method ( where @xmath1 is represented by particles , and not @xmath35 ) , the numerical noise is reduced .    in future works",
    ", we would like to extend the monte - carlo approach proposed for the hydrodynamic limit of vlasov - bgk in @xcite to the diffusion and the drift - diffusion limits .",
    "we present the time discretization of ( [ eq : micromacro_initial ] ) having in spirit a eulerian discretization of the phase space . obviously , the numerical scheme proposed in @xcite works well .",
    "now , ( [ eq : mm_micro ] ) also provides a numerical scheme that we will exploit in this appendix .",
    "let us consider staggered grids in the phase - space domain and adopt the following notations : @xmath88 and @xmath259 , @xmath260 , define two grids in space and @xmath261 , @xmath262 , defines a grid in velocity , where @xmath263 ( resp .",
    "@xmath264 ) is the step in space ( resp . in velocity ) .",
    "time is also discretized with a time step @xmath0 and we note @xmath64 , @xmath65 .",
    "the density @xmath87 is discretized on the first space grid : @xmath92 approximates @xmath94 , whereas the perturbation @xmath35 is discretized on the second one : @xmath265 approximates @xmath266 .",
    "let an approximation @xmath267 of the spatial derivative , the numerical scheme we propose consists in computing @xmath268 with @xmath269 , \\nonumber\\\\\\end{aligned}\\ ] ] where @xmath270 , and then to compute @xmath157 with [ macrod ] _",
    "i^n+1 = _ i^n - _ j ( v_j ) v.    the scheme given by ( [ s2])-([macrod ] ) enjoys the ap property , _",
    "i.e. _ it satisfies the following properties    * for fixed @xmath41 , the scheme is a first - order ( in time ) approximation of the original model ( [ eq : etrbgk ] ) , * for fixed @xmath42 , the scheme degenerates into an explicit first - order ( in time ) scheme of .",
    "[ prop : euler_1st_exp ]    we observe easily that when @xmath11 goes to zero , ( [ s2 ] ) gives @xmath271 which , injected in the time discretization ( [ macrod ] ) for @xmath87 , gives up to terms of order @xmath272 @xmath273 since @xmath274 is an approximation of @xmath275 , we obtain a consistent discretization of the diffusion equation .",
    "proposition [ prop : euler_1st_exp ] is of big interest for impliciting the diffusion term @xmath276 .",
    "indeed , let us rewrite as follows @xmath277 with @xmath278.$ ] injecting this relation into the macro part , we get @xmath279 since @xmath280 as @xmath11 goes to zero after two iterations , the asymptotic preserving property is ensured .",
    "moreover , the diffusion term can now be chosen as implicit , so that the macro equation becomes @xmath281 and the scheme is now free from the usual diffusion condition on the time step .",
    "the algorithm finally writes       * initialize @xmath282 and @xmath137 .",
    "+ at each time step : * advance micro part with ( [ s2 ] ) . * advance macro part with ( [ macrod_cn ] ) .",
    "[ algo : euler_1st ]    and we have the following result .    the scheme given by ( [ s2])-([macrod_cn ] ) enjoys the ap property , _",
    "i.e. _ it satisfies the following properties    * for fixed @xmath41 , the scheme is a first - order ( in time ) approximation of the original model ( [ eq : etrbgk ] ) , * for fixed @xmath42 , the scheme degenerates into an implicit first - order ( in time ) scheme of .",
    "[ prop : euler_1st_imp ]    we do not present here the extension to the vlasov - poisson - bgk case , but it is straightforward .",
    "in this section , we present the adaptation of the moment guided particle method proposed in @xcite to our context . for the sake of simplicity , we present it in the rte case but note that these computations can also be extended to the vlasov - poisson - bgk case , without difficulty .",
    "the kinetic equation on @xmath1 has to be reformulated to avoid the singularity linked to the transport term . to do that , we proceed as previously , but from ( [ eq : etrbgk ] ) .",
    "indeed , we rewrite equation ( [ eq : etrbgk ] ) as @xmath283,\\ ] ] and we integrate between @xmath177 and @xmath165 to get @xmath284 { \\textnormal{d}}t.\\ ] ] we make the following approximation @xmath285,\\ ] ] where @xmath286 and @xmath287 , @xmath288 .        to derive an ap scheme for this latter system satisfied by @xmath292 ,",
    "we adapt the strategy presented in @xcite to our diffusion framework . to do so ,",
    "we first remark that @xmath293 and using the expression of @xmath35 obtained by ( [ eq : mm_micro ] ) , we get the following approximation for the macro flux ( considered implicit in time ) @xmath294 then , we get the following scheme for @xmath87 @xmath295        to do that , the transport part is solved with the ( non stiff ) characteristics [ carxf ] _",
    "k(t ) = v_k(t ) .",
    "the source part is solved using the equation satisfied by the weights [ weightf ] _",
    "k(t ) = _ k(t ) + ( t , x_k(t ) ) .",
    "the last step consists in matching the moment of @xmath298 obtained by the particle method with @xmath141 obtained with ( [ eq : rhomg ] ) .",
    "this can be done using the techniques proposed in @xcite . indeed , considering the function @xmath299",
    ", its weight can be written as @xmath300 then , we apply the discrete version of @xmath301 to the weights @xmath302 as in @xcite @xmath303       + n. crouseilles and m. lemou are supported by the french anr project moonrise anr-14-ce23 - 0007 - 01 and by the enabling research eurofusion project cfp - wp14-er-01/ipp-03 .",
    "a. crestetto is supported by the french anr project achylles anr-14-ce25 - 0001 .            , _ kinetic / fluid micro - macro numerical schemes for vlasov - poisson - bgk equations using particles _ , kin .",
    "models * 5 * , pp .",
    "787 - 816 ( 2012 ) . ,",
    "_ asymptotic - preserving scheme based on a finite volume / particle - in - cell coupling for boltzmann - bgk - like equations in the diffusion scaling _ , finite volumes for complex applications vii - elliptic , parabolic and hyperbolic problems , springer proceedings in mathematics and statistics * 78 * , pp .",
    "827 - 835 ( 2014 ) . ,",
    "_ asymptotically stable and time diminishing schemes for rarefied gas dynamics _ , accepted in kin",
    "models .                        , _ asymptotic solution of neutron transport problems for small mean free paths _",
    ", j. math .",
    "phys , * 15 * pp . 75 - 81 ( 1974 ) . , _ relaxed micro - macro schemes for kinetic equations _ , comptes rendus mathmatique * 348 * , pp . 455 - 460 ( 2010 ) ."
  ],
  "abstract_text": [
    "<S> in this work , we derive particle schemes , based on micro - macro decomposition , for linear kinetic equations in the diffusion limit . due to the particle approximation of the micro part </S>",
    "<S> , a splitting between the transport and the collision part has to be performed , and the stiffness of both these two parts prevent from uniform stability . to overcome this difficulty , the micro - macro system is reformulated into a continuous pde whose coefficients are no longer stiff , and depend on the time step @xmath0 in a consistent way . </S>",
    "<S> this non - stiff reformulation of the micro - macro system allows the use of standard particle approximations for the transport part , and extends the work in @xcite where a particle approximation has been applied using a micro - macro decomposition on kinetic equations in the fluid scaling . beyond the so - called asymptotic - preserving property which is satisfied by our schemes , they significantly reduce the inherent noise of traditional particle methods , and they have a computational cost which decreases as the system approaches the diffusion limit </S>"
  ]
}