{
  "article_text": [
    "boolean reversible circuits have attracted attention as components in several quantum algorithms including shor s quantum factoring @xcite and stabilizer circuits . in the recent years , considerable efforts have been made to synthesize a boolean reversible function by a set of quantum gates @xcite .    the proposed technologies for quantum computing suffer from practical limitations for implementation .",
    "for example , popular quantum technologies allow computation on a few qubits in a linear nearest neighbor ( lnn ) architecture where only adjacent qubits can interact @xcite . additionally , physical qubits are fragile and can hold their states only for a limited time , called _ coherence time _ , @xcite .",
    "to reflect technological constraints in the synthesis stage , different technology - specific cost metrics have been introduced .",
    "* _ two - qubit cost _ is the number of two - qubit gates of any type and the number of one - qubit gates ( reported separately ) in a given circuit .",
    "the number of two - qubit gates for an @xmath0-qubit toffoli gate ( for @xmath0 @xmath1 3 ) is estimated as @xmath2 @xcite .",
    "_ quantum cost _ ( qc ) is the number of not , cnot , controlled - v and controlled - v@xmath3 gates required to implement a given reversible function . * _ interaction cost _ is the distance between gate qubits for any two - qubit gate .",
    "quantum circuit technologies with 1d , 2d and 3d interactions exist @xcite .",
    "interaction cost for a circuit is calculated by a summation over the interaction costs of its gates . * _ number of ancillae _ and _ garbage qubits _ reflect the limited number of qubits in the current quantum technologies . *",
    "_ depth _ is the largest number of elementary gates on any path from inputs to outputs in a circuit .",
    "reducing circuit depth can increase coherence time .",
    "synthesis of reversible boolean circuits has an exponential search space .",
    "consequently , many heuristic algorithms have been proposed to consider the effects of quantum cost and two - qubit cost in the synthesis stage [ 7 - 10 ] .",
    "additionally , several post - process optimization methods have been developed to improve quantum cost @xcite , interaction cost @xcite , and depth @xcite .",
    "however , the number of algorithms which consider different parameters simultaneously  the focus of this work  is very limited .",
    "besides technological limitations , studying theoretical aspects of circuits with either limited interactions among qubits of gates or limited depth attracts interest in complexity theory .",
    "for example , nc@xmath4 is the class of decision problems solvable by a uniform family of boolean circuits with polynomial size , depth of @xmath5 and fan - in=2 .",
    "qnc is the class of constant - depth quantum circuits without fanout gates @xcite .    in this paper ,",
    "a synthesis algorithm for boolean reversible circuits is proposed which uses a cycle - based strategy to synthesize circuits for the lnn architecture .",
    "the proposed technique leads to improved synthesis costs as compared to the best prior methods for several benchmarks .",
    "moreover , a parallel structure for reversible boolean circuits is presented which significantly reduces circuit depth with 2@xmath0 ancillae .",
    "overall , our circuits can be considered as depth - optimized reversible circuits for the lnn architecture .",
    "this paper is organized as follows .",
    "basic concepts are introduced in section [ sec : pre ] .",
    "related synthesis and post - process optimization methods are reviewed in section [ sec : relat ] .",
    "the proposed cycle - based synthesis algorithm for the lnn architecture is described in section [ sec : mk - cycle ] .",
    "section [ subsec : parallel ] presents a parallel structure to reduce circuit depth .",
    "experimental results are reported in section [ sec : exper ] , and section [ sec : conclu ] concludes the paper .",
    "in this section , preliminary concepts are briefly introduced .",
    "further background can be found in @xcite",
    ".    * permutation function .",
    "* let @xmath6 be any set and define @xmath7@xmath8 @xmath6 @xmath9 @xmath6 as a one - to - one and onto transition function .",
    "the function @xmath7 is a _ permutation _ function , as applying @xmath7 to @xmath6 leads to a set with the same elements of @xmath6 and probably in a different order . if @xmath10 , there exist two elements @xmath11 and @xmath12 belonging to @xmath6 such that @xmath13 . a @xmath14-cycle with _ length",
    "_ @xmath14 is denoted as @xmath15 which means that @xmath16 and @xmath17 .",
    "a given @xmath14-cycle @xmath18 could be written in different ways , such as @xmath19 .",
    "cycles @xmath20 and @xmath21 are called _ disjoint _ if they have no common members . any permutation can be written uniquely , except for the order , as a product of disjoint cycles .",
    "if two cycles @xmath20 and @xmath21 are disjoint , they can _ commute _ , i.e. , @xmath22 = @xmath23 .",
    "a cycle with length two is called _",
    "transposition_. a cycle or a permutation is called _ even _ ( _ odd _ ) if it can be written as an even ( odd ) number of transpositions .",
    "when @xmath14-cycle is even ( odd ) then @xmath14 is odd ( even ) .",
    "* reversible function . * an @xmath0-input , @xmath0-output , fully specified boolean function @xmath7@xmath8 @xmath6 @xmath9 @xmath6 over variables @xmath24 is called _",
    "reversible _ if it maps each input pattern to a unique output pattern .",
    "each reversible function can be considered as a permutation function .",
    "the added lines to a circuit are called _ ancillae _ and typically start out with a 0 or 1 .    * reversible gate . *",
    "an @xmath0-input , @xmath0-output gate is reversible if it realizes a reversible function .",
    "a multiple - control toffoli gate can be written as c@xmath25not(c ; t ) , where @xmath26 is the set of _ control _ lines , @xmath27 with @xmath28 is the _ target _ line and @xmath29 .",
    "a control line may be _ positive _ ( _ negative _ ) which means that if its value is one ( zero ) , the value of the target is inverted . for @xmath30=0 and @xmath30=1 , the gates are called not ( n ) and cnot ( c ) , respectively . for @xmath30=2 , the gate is called c@xmath31not or toffoli ( t ) .",
    "the swap(@xmath32,@xmath33 ) gate changes the value of two qubits @xmath32 and @xmath33 , and can be constructed by three cnot gates c(@xmath32,@xmath33)c(@xmath33,@xmath32)c(@xmath32,@xmath33 ) .",
    "the controlled - v ( controlled - v@xmath3 ) gate changes the value of its target line using the transformation given by the matrix v ( v@xmath3 ) if the control line has the value 1 .",
    "\\dag    = \\frac{{1 - i}}{2}\\left [ { \\begin{array}{*{20}c }     1 & i   \\\\",
    "\\end{array } } \\right]\\ ] ]",
    "in this section , we review prior synthesis and optimization techniques that are used in this paper .    in @xcite , an nct - based synthesis method is proposed which decomposes a given cycle into a set of transpositions . to implement an arbitrary transposition @xmath35 for distinct @xmath32 , @xmath33 , @xmath36 , @xmath37 @xmath38 0 , @xmath39 , the authors introduced three subcircuits , namely @xmath40 , @xmath41 and @xmath42 ( the inverse of @xmath40 ) , where the @xmath41 circuit , c@xmath43not(@xmath44 ) , implements a fixed transposition ( @xmath45 , @xmath46 ) ( @xmath47 , @xmath48 ) .",
    "accordingly , a synthesis algorithm was proposed to transform @xmath32 , @xmath33 , @xmath36 and @xmath37 to @xmath45 , @xmath46 , @xmath47 and @xmath48 , respectively . by cascading @xmath40 , @xmath41 and @xmath42",
    ", an arbitrary transposition can be implemented with quantum cost @xmath49 .",
    "the nct - based synthesis method in @xcite was extensively improved in @xcite , @xmath14-cycle method hereafter . in the @xmath14-cycle method , a given cycle of length @xmath50 is decomposed into a set of cycles of lengths @xmath51 , called _",
    "elementary cycles_. next , a set of synthesis algorithms was proposed to synthesize different elementary cycles , i.e. , a pair of 2-cycles , a single 3-cycle , a pair of 3-cycles , a single 5-cycle , a pair of 5-cycles , a single 2-cycle ( 4-cycle ) followed by a single 4-cycle ( 2-cycle ) and a pair of 4-cycles . similar to @xcite , 0 and @xmath39 terms are fixed before synthesis because their effect on their synthesis results is negligible @xcite .",
    "nct gates with positive controls are used in both @xcite and @xcite .",
    "the effect of decomposition on the result of @xcite was considered in @xcite where a cycle - assignment technique based on graph matching was proposed .",
    "the worst - case quantum cost for synthesizing an arbitrary reversible function on @xmath0 lines is @xmath52 in @xcite .    in @xcite",
    ", the authors introduced a post - process optimization algorithm to reduce the depth of a given quantum circuit . to achieve this , a set of circuit templates ( circuit identities )",
    "was proposed to reduce quantum cost and circuit depth .",
    "the suggested templates are applied to change either gate locations or control / target positions in a subcircuit to parallelize more gates .",
    "the introduced templates were used by a greedy algorithm which starts from gate @xmath53 and traverses the gates afterwards . at each step , the algorithm moves gates to left whenever possible and applies templates to check whether other gates can be moved to left or not .",
    "if no change is possible , it starts the same process from gate @xmath54 .    in @xcite ,",
    "a synthesis flow was proposed to improve the interaction cost of a given quantum circuit .",
    "the authors studied the exact synthesis of some small gates for the lnn architecture .",
    "the proposed optimal circuits are used to simplify larger circuits . besides",
    ", some circuit templates are introduced to reduce the number of swap gates .",
    "finally , local and global reordering of input qubits are considered to reorder gate qubits for improving the interaction cost .",
    "the proposed techniques were consolidated in a unified design flow to implement a given circuit with arbitrary interactions for architectures with limited interactions .",
    "[ fig : examp1]-a shows a 3-input full adder with depth 4 @xcite and six elementary gates .",
    "actually , depth 4 is optimal since four qubits are involved in the fourth qubit @xcite .",
    "[ fig : examp1]-b shows the same circuit after inserting swap gates to make the gate qubits adjacent with qc=24 and depth=23 .",
    "[ fig : examp1]-c illustrates the same circuit after applying the method in @xcite for reducing the number of swap gates where qc=18 and depth=17 .",
    "the main contribution of @xcite is to propose a cycle - based synthesis approach with the primary focus on quantum cost as the sole metric considered .",
    "however , another important implementational constraint , namely interaction cost , is considered besides the quantum cost in our proposed cycle - based method in this section . to do that , we improve the @xmath14-cycle method by using negative controls and adapting the synthesis algorithms of elementary cycles to the lnn architecture .",
    "particularly , two new elementary odd cycles , a 2-cycle and a 4-cycle , are included to improve quantum cost .",
    "these odd cycles are synthesized as a pair of 2-cycles and a pair of 4-cycles in @xcite with one ancilla .",
    "odd cycles need one ancilla in the nct library for the implementation @xcite . in our experiments",
    ", we used this ancilla for the decomposition of complex gates into elementary gates .",
    "additionally , 0 and @xmath39 terms are not fixed before synthesis to be used in the proposed parallel structure as discussed in section [ subsec : parallel ] . * negative controls",
    "* can reduce the number of elementary gates in the @xmath41 , @xmath40 and @xmath42 circuits both with and without considering nearest neighbor restriction .",
    "multiple - control toffoli gates with at least one positive control can be simulated as efficiently as complex toffoli gates with only positive controls @xcite . by using cnot and toffoli gates with negative controls",
    ", one may not fix 0 and @xmath39 terms before synthesis as compared with the methods in @xcite .",
    "* cycle construction length ( ccl ) * is defined as the number of lines required to implement a given cycle of length @xmath55 . in theory , the minimum ccl is @xmath56 . to implement the elementary cycles by nct gates , at most two more lines",
    "are required in the proposed approach  one to avoid toffoli gates without any positive control in the @xmath41 circuit , and one to improve circuit cost in the @xmath40 , @xmath42 circuits .",
    "accordingly , we set ccl@xmath57=2 , ccl@xmath58=4 , ccl@xmath59=3 , ccl@xmath60=5 , ccl@xmath61=4 , ccl@xmath62=5 , ccl@xmath63=5 , ccl@xmath64=5 and ccl@xmath65=6 . for an @xmath0-line circuit , lines required to construct a given cycle , ccl in total , can be selected in @xmath0 @xmath66 @xmath67 @xmath66 ... @xmath66@xmath68 different ways .",
    "to improve interaction cost and depth we place the selected lines close to each other in the middle of the @xmath41 circuit at positions @xmath14 , @xmath69 and @xmath70 for @xmath71 .",
    "details are discussed later .        to synthesize a given elementary cycle",
    ", one needs to change input terms into the terms specified by the @xmath41 circuit .",
    "this is done by converting the input terms into _ intermediate terms _ specified by the @xmath40 circuit .",
    "afterwards , the intermediate terms are transformed into @xmath41 terms by a few specific gates , called _",
    "static gates_. in the proposed method , the control and target lines in the @xmath40 circuit are selected such that interaction cost can be reduced . since @xmath41 cycles are constructed in the middle of the circuit and the intermediate terms are designed with at least one `` 1 '' , as boldfaced in column _ int .",
    "terms _ in table [ t : ec ] , it is possible to select control and target lines of each gate with length @xmath72 . considering two swap gates with cost 6 leads to qc@xmath73 @xmath74 for each gate . to reduce circuit depth ,",
    "the gates required to fix bit positions at the first half and the second half are applied in parallel .",
    "algorithm [ alg : one ] provides the details .",
    "the @xmath75 circuits in @xcite and the proposed @xmath75 circuit are shown in fig .",
    "[ fig : interval]-a and fig .",
    "[ fig : interval]-b , respectively . fig .",
    "[ fig : interval]-c illustrates one example of the @xmath40 circuit in @xcite .",
    "the input term is `` 11110111 '' which should be changed to the second term in the @xmath75 circuit in @xcite , i.e. , `` 11111101 '' .",
    "this is done by a circuit with qc=16 and depth=11 .",
    "in contrast , `` 11110111 '' should be changed to `` 00100100 '' in the proposed method .",
    "[ fig : interval]-d shows the @xmath40 circuit with qc=5 and depth=3 based on algorithm 1 .      in this section , direct synthesis of the suggested elementary cycles ,",
    "i.e. , ( 2 ) , ( 2,2 ) , ( 3 ) , ( 3,3 ) , ( 4,2 ) , ( 4,4 ) , ( 5 ) , ( 5,5 ) , is discussed .",
    "[ fig : all - k ] illustrates the @xmath41 circuits of all elementary cycles .",
    "we give a full description of the synthesis method for a pair of 2-cycles first .    *",
    "( 2,2)-synthesis : * to change @xmath76 to @xmath75 terms :    * at most @xmath0 not gates can be used to convert @xmath32 to `` 0 ... 1000 ... 0 '' .",
    "other terms @xmath33 , @xmath36 , and @xmath37 may be changed to new terms @xmath77 , @xmath78 and @xmath79 , respectively .",
    "* at most one cnot gate conditioned on either the @xmath53-@xmath80 line @xmath53@xmath38@xmath81 ( positive ) or @xmath82 ( negative ) can be used to set the ( @xmath83)-@xmath80 bit of @xmath77 .",
    "next , at most @xmath84 cnot gates conditioned on the ( @xmath83)-@xmath80 bit can be applied to change the @xmath85-@xmath80 bit of @xmath77 ( @xmath86 , @xmath85@xmath38@xmath83 ) to `` 0 ... 1001 ... 0 '' .",
    "@xmath78 , and @xmath79 may be changed to new terms @xmath87 and @xmath88 .",
    "* at most one cnot gate conditioned on either the @xmath53-@xmath80 line @xmath53@xmath38@xmath81 ( positive ) or @xmath82 ( negative ) can be used to set the @xmath14-@xmath80 bit of @xmath87 .",
    "next , at most @xmath84 cnot gates with positive control conditioned on the @xmath14-@xmath80 bit can be applied to change the @xmath85-@xmath80 bit of @xmath87 ( @xmath86 , @xmath89 ) to `` 0 ... 1010 ... 0 '' . the last term @xmath88",
    "may be changed to a new term @xmath90 .",
    "* at most one cnot gate conditioned on either the @xmath53-@xmath80 line @xmath53@xmath38@xmath81 ( positive ) or @xmath82 ( negative ) can be used to set the ( @xmath91)-@xmath80 bit of @xmath90 .",
    "next , at most @xmath84 cnot gates with positive control conditioned on the ( @xmath91)-@xmath80 bit can be applied to change the @xmath85-@xmath80 bit of @xmath90 ( @xmath86 , @xmath85@xmath38 @xmath81 ) to `` 0 ... 1111 ... 0 '' . * a toffoli gate conditioned on the ( @xmath83)-@xmath80 and",
    "the @xmath14-@xmath80 lines can be used to set the ( @xmath91)-@xmath80 line .",
    "therefore , it changes `` 0 ... 1111 ... 0 '' to `` 0 ... 1011 ... 0 '' .",
    "note that converting each term does not corrupt the previously fixed terms .",
    "the same number of gates are needed for the @xmath42 circuit .",
    "accordingly , a total number of @xmath92 elementary gates are required for the @xmath40 and @xmath42 circuits .",
    "the @xmath41 circuit in fig .",
    "[ fig : all - k]-b implements @xmath93 with cost @xmath94 .",
    "therefore , an arbitrary pair of 2-cycles @xmath76 can be implemented by at most @xmath95 elementary gates .        following the above discussion for the ( 2,2)-synthesis method , details for the synthesis of other elementary cycles",
    "are given in table [ t : ec ] . in this table , subscripts in column _",
    "input cycle(s ) _ denote orders in considering each term .",
    "intermediate terms are represented by binary expansions with lsb on the right and the underlined bit in the @xmath14-@xmath80 position ( @xmath14=@xmath96 ) .",
    "the boldfaced `` 1 '' is _ pivot _ in algorithm [ alg : one ] for each term .",
    "the parenthesized pairs in column _ max . cost _ represent cnot count with negative and positive controls , respectively .",
    "the numbers given in column _ terms _ for the @xmath41 circuit are bit positions with value `` 1 '' in binary representation .",
    "table [ t : tableqc ] reports the resulting quantum cost of each elementary cycle .",
    "as can be seen , the total number of elementary gates is improved by a linear factor in most cases .",
    "considering the worst - case cost of @xmath97 for each gate in the @xmath40 and @xmath42 circuits in the lnn architecture and @xmath98 elementary gates ( i.e. , two chains of @xmath99 swap gates ) for the @xmath41 circuits leads to the results given in _ total cost ( lnn ) _ column in table [ t : tableqc ] .      in this section , an upper bound on the number of gates in the proposed cycle - based method",
    "is calculated . to achieve this ,",
    "let all terms of a truth table be involved in the input cycles to have a cycle with the maximum length @xmath100 for an @xmath0-input/@xmath0-output function . to convert a cycle with length@xmath1015 to a set of elementary cycles",
    ", we may have some repeated terms in non - disjoint cycles . as such",
    ", @xmath100+@xmath102 shows the maximum number of terms where @xmath102 is the maximum number of repeated terms and can be estimated as @xmath103 which results in @xmath104 .",
    "theorem [ th : wc ] discusses the maximum number of elementary gates in our approach .",
    "[ th : wc ] the maximum number of elementary gates for any permutation in the proposed approach is @xmath105 and @xmath106 without and with considering interaction cost , respectively .    in table",
    "[ t : tableqc ] , the column _ cost / length _ determines a cost needed for setting a term in each elementary cycle . to calculate the maximum cost ,",
    "suppose at most one 3-cycle , one 4-cycle and one 5-cycle are included which can be synthesized by the related synthesis algorithms .",
    "all other terms are supposed to be synthesized as pairs of 2-cycles . note that the number of elementary gates for fixing terms in a pair of 2-cycles is greater than any other pairs ( see table [ t : tableqc ] ) .",
    "the repeated terms in non - disjoint 5-cycles are synthesized by the ( 5,5)-cycle synthesis method .",
    "accordingly we will have , @xmath107__cost / length@xmath108 _ _",
    "+ @xmath109__cost / length@xmath110 _",
    "_ + @xmath111__cost / length@xmath112 _ _",
    "+ @xmath113__cost / length@xmath114 _ _",
    "+ @xmath115__cost / length@xmath116 _ _ which leads to @xmath117 elementary gates in the worst - case with arbitrary interaction and @xmath118 with limited interaction .",
    "the worst - case quantum cost of @xcite is @xmath119 for architectures with limited interaction .",
    "in this section , a parallel circuit structure is introduced for reversible logic that can be used to considerably reduce circuit depth of reversible circuits in most cases .",
    "the general idea is to copy input lines into @xmath14 sets of zero - initialized ancillae , divide the input specification into @xmath14 sets of disjoint cycles and then synthesize each set independently by using the prepared ancillae .",
    "the final results can be recovered by several cnots .",
    "it should be mentioned that adding ancillae has been previously used for quantum cost reduction in the synthesis and optimization methods @xcite . in the proposed method ,",
    "ancillae are used for the propose of depth reduction without considerable overhead on quantum cost , thanks to the specific form of input representation , i.e. , cycle . note that each cycle can be synthesized by a different synthesis method .",
    "* input storing block . * copying an arbitrary quantum state is not possible in general but a boolean value can be copied into a zero - initialized ancilla by a cnot gate conditioned on the main line and targeted on the ancilla . for @xmath30",
    "@xmath0-line zero - initialized ancillae , the input storing block includes @xmath30@xmath0 cnot gates with constant depth @xmath30 . fig .",
    "[ pre]-a shows the input storing block for a circuit with @xmath0 main lines and @xmath30 @xmath0-line ancillae .",
    "the interaction cost can be calculated as @xmath120 .",
    "[ pre]-b illustrates another circuit structure with improved interaction cost , @xmath121 .",
    "circuit depth in fig .",
    "[ pre]-a can be improved from linear factor to logarithmic factor @xmath122 @xcite as shown in fig .",
    "thus , interaction cost can be calculated as @xmath123",
    ".            * output restoring block . *",
    "since each subcircuit implements a set of disjoint cycles , for a given input combination , only one circuit ( active ) produces the results and the outputs of other subcircuits ( inactive ) are the same as the inputs .",
    "the number of inactive subcircuits is equal to the number of @xmath0-line ancillae registers , which is even . as such , xoring ( by cnot ) the outputs of all subcircuits on the main lines cancels inputs and restores correct outputs at the main lines .",
    "overall , for @xmath30 @xmath0-line ancillae and @xmath30 + 1 sets of disjoint cycles , @xmath30@xmath0 cnots with depth @xmath30 are sufficient .",
    "[ term]-a illustrates the output restoring block for @xmath30 @xmath0-line ancillae with interaction cost @xmath124 .",
    "cnot - circuit with common target can be implemented with logarithmic depth @xcite as illustrated in fig .",
    "[ term]-b for @xmath0=4 and @xmath30=4 . in this case ,",
    "interaction cost is @xmath125 .",
    "[ th : par ] consider a given specification @xmath126 on @xmath0 lines written as a set of disjoint cycles @xmath127 for an odd @xmath30 .",
    "assume that subcircuit @xmath128 implements @xmath129 .",
    "the specification @xmath126 can be implemented with depth o(@xmath130 ) in the presence of @xmath30 @xmath0-line ancillae .",
    "copying the input lines to @xmath131 @xmath0-line zero - initialized ancillae replicates inputs at the ancillae .",
    "disjoint cycles commute .",
    "hence , each subcircuit can be implemented on one register independently .",
    "the input storing / output restoring blocks have constant depth @xmath30 . therefore , circuit depth is dominated by the maximum depth of all subcircuits .",
    "a given specification may contain a set of disjoint cycles with exponential lengths , i.e. , @xmath132 .",
    "in such cases , circuit depth can not be further improved by theorem [ th : par ] . however , as will be shown in section [ sec : exper ] , circuit depth can be reduced considerably even with a small number of @xmath0-line ancillae . to efficiently employ the result of theorem [ th : par ] , one needs to determine disjoint cycle sets .",
    "[ ex:4 ] _ assume that the input cycles ( 1,3 ) ( 7,10 ) ( 0,4 ) ( 6,15 ) ( 2,8 ) ( 5,13 ) are given for a circuit with 4 lines .",
    "all cycles are elementary and no decomposition is required . let 2 4-line ancillae be available and each pair of 2-cycles be assigned to one set , i.e. , ( 1,3 ) ( 7,10 ) to set # 1 , ( 0,4 ) ( 6,15 ) to set # 2 and ( 2,8 ) ( 5,13 ) to set # 3 . applying",
    "the input storing block provides the input data on the added zero - initialized ancillae .",
    "now , the proposed method in section [ sec : mk - cycle ] can be applied for each cycle pair which leads to three subcircuits . to combine the results",
    ", one needs to add the output restoring block .",
    "accordingly , total depth is equal to the maximum depth of the synthesized subcircuits ( i.e. , 33 ) plus 4 ( 2 for each input storing / output restoring block ) . fig .",
    "[ fig : exmp ] illustrates the result . _",
    "* cycle distribution .",
    "* consider @xmath0 elementary cycles and @xmath30 register sets , including the input register .",
    "the problem is to assign disjoint cycles into different registers such that the total depth of the circuit in each register is minimized and the depths of the registers are almost equal . to achieve this goal ,",
    "we modeled the cycle distribution problem as the bin packing problem such that the number of used bins are minimized . given a bin of size @xmath133 and a list @xmath134 of sizes of the items , one should find an integer @xmath6 and a @xmath6-partition @xmath135 of @xmath136 such that @xmath137 for all @xmath138 .",
    "a solution is optimal if it has minimal @xmath6 .",
    "] with a few exceptions . in our modeling , registers are bins and cycles are objects .",
    "each cycle is decomposed into a set of elementary cycles and cost values in table [ t : tableqc ] are used as the weights of elementary cycles .",
    "if the input permutation is odd , the permutation in one bin should be odd .",
    "many heuristic algorithms have been developed to solve different variants of the bin packing problem .",
    "examples include first fit and best fit algorithms .",
    "to solve the problem , a best fit algorithm is developed which sorts @xmath36 elementary cycles according to their maximum synthesis costs and proceeds one cycle at a time . to distribute cycles , the first cycle is selected and temporarily assigned to bin @xmath53 for @xmath139",
    "then , the total cost is calculated among all the bins and the cycle is permanently assigned to the bin which results in the lowest total cost . in the case of a tie , the bins are selected in sequence .",
    "the algorithm continues until all the cycles are assigned .",
    "therefore , the total time complexity is @xmath140 . at the end ,",
    "the algorithm checks the permutation of each bin to make sure that at most one bin has an odd permutation .",
    "odd permutations need one ancilla in the nct library @xcite .",
    "if more than one bin is found with an odd permutation ( called odd bin ) , the algorithm moves the smallest odd cycle of the odd bin with maximum depth to the odd bin with the minimum depth .",
    "this can take @xmath141 time .",
    "after the changes , the involved bins should have even permutations .",
    "this process is continued until at most one bin with an odd permutation exists  this occurs when the input permutation is odd and at least @xmath30 even permutations exist to fill all the bins .",
    "altogether , the whole process has a time complexity of @xmath140 .",
    "the proposed cycle - based synthesis method for the lnn architecture and the suggested parallel structure for reversible logic synthesis were implemented in c++ and all of the experiments were performed on an intel pentium iv 2.5ghz computer with 4 gb memory . to evaluate the proposed synthesis method ,",
    "some of the reversible benchmark functions from @xcite were synthesized .",
    "the selection criteria for these benchmarks will be discussed later in this section and their specifications are given in table [ t : tablecycles ] _ before _ and _ after _ decomposition .",
    "the decomposition approach of @xcite is used in our method to decompose the input cycles into the proposed elementary cycles .",
    "the number of elementary cycles ( ec ) and non - elementary cycles ( nec ) of each benchmark is reported is this table .",
    "after decomposition , all cycles are elementary with length@xmath1426 .",
    "note that @xcite proposes the best prior synthesis algorithm for medium - size _ hwbn _ and _ n - th prime _",
    "functions if no ancilla is available @xcite . while _",
    "hwbn _ functions can be implemented with a polynomial cost @xmath143 if a logarithmic number of garbage bits @xmath144 is available @xcite , the proposed approach is more general and can be applied to many reversible functions .",
    "to evaluate the proposed parallel structure , the cycle - based algorithm of section [ sec : mk - cycle ] was used for synthesizing each subset . since the number of signals is limited in the current quantum technologies , the minimum number of ancillae ( 2 @xmath0-line registers ) was used .",
    "therefore , the number of input cycles should be @xmath1013 to have at least one cycle in each subset . in our experiments ,",
    "the results of @xcite were used for decomposing multiple - control toffoli gates and calculating quantum cost for the gates with negative controls . besides , the two - qubit cost model of @xcite is used for evaluating the results .",
    "a naive swap insertion method and the method of @xcite were used to evaluate the results for the lnn architecture . for the naive method , _",
    "move _ and _ delete _ rules were applied on the synthesized circuits to remove redundant gates . to estimate circuit depth ,",
    "the greedy level compaction algorithm of @xcite was implemented without applying the templates .",
    ".comparison of the proposed approach and prior best results . # a is the number of ancillae . r and p are used for regular and parallel structures , respectively .",
    "the resulted circuits are available at http://ceit.aut.ac.ir/~arabzadeh/results/ , and may be viewed with rcviewer+ @xcite . [ cols=\"<,^,^,^,^,^,^,^,^,^,^,^,^ \" , ]     table [ t : tableres1 ] and table [ t : tableres4 ] report the quantum cost ( qc ) , the two - qubit cost ( 2-qubit ) and the depth ( depth ) for the synthesized circuits without and with limited interaction . since @xcite does not target the limited interaction in the lnn architecture , we used the method of @xcite on the results of @xcite and ours to insert swap gates .",
    "runtime of @xcite and our method is less than one minute for the selected benchmarks . in the proposed method ,",
    "this time includes the time required for applying the distribution procedure in the parallel structure and the time required for synthesis and applying the _ move _ and _ delete _ rules . in the parallel structure , due to the qubit reordering in @xcite , at most @xmath145 swap gates",
    "are used between the input storing block , the subsets and the output restoring block to order lines .    as can be seen in table [ t : tableres4 ] ,",
    "the effect of the post - process method is more significant for @xcite but altogether the results of the proposed lnn - based method are better than those of @xcite after applying @xcite on both methods .",
    "notice that using negative controls does not allow to increase the quantum cost . for odd permutations",
    ", one more ancilla should be added .",
    "the two - qubit costs are compared in table [ t : tableres1 ] and the results show 13.6% and 11.5% improvement on average for the regular and parallel structures , respectively . in the parallel structure , the average depth improvement of the _ n - th prime _",
    "benchmarks is less than that of _ hwbn _ functions since the input cycles of those functions are unstructured with different cycle lengths which result in unbalanced subsets after distribution .",
    "input cycle distributions after decomposition ( dcm ) and distribution ( dist ) are reported in table [ t : tablecycles ] . for _ hwbn",
    "_ functions , applying the distribution method leads to 3 sets with almost the same numbers of elementary cycles .",
    "we report the circuit depth for each set along with the total depth after considering the effect of input storing and output restoring blocks in this table .",
    "as reported in table [ t : tablecycles ] , function _",
    "nth_prime8 _ has one disjoint input cycle .",
    "accordingly , the resulting elementary cycles should be assigned to one set by the proposed method .    in choosing the benchmark functions that were considered in this paper ,",
    "the general guidelines presented in @xcite and @xcite were considered .",
    "these guidelines stipulate that one of the scenarios in which the cycle - based methods render significantly superior results is when the input function contains permutations without regular patterns such as _ hwbn _ , _ n - th prime",
    "_ @xcite functions . for this reason ,",
    "only the results of these functions are reported in this paper . as for other functions in @xcite ,",
    "some are reported in @xcite along with a discussion on their suitability for the cycle - based approach ( like permanent ) . to avoid being repetitive",
    ", we did not include this set in this paper .",
    "there are yet other benchmarks that include important arithmetic functions like adders , multipliers and group arithmetic ( e.g. , in galois fields ) .",
    "since the proposed cycle - based synthesis method is a general synthesis approach , it may not produce interesting results compared to other approaches specifically developed for those benchmark functions .",
    "in this paper , a synthesis approach is proposed in order to reduce logical depth for architectures with limited interactions which applies a cycle - based approach to synthesize a given specification .",
    "the proposed method focuses on the interaction cost and depth besides the traditional quantum cost metric as a multi - objective view in the large picture . to achieve this",
    ", we redesigned the elementary cycles in @xcite with negative controls and limited interaction between gate lines .",
    "moreover , a new parallel circuit structure was proposed for reversible logic in the presence of several ancillae registers .",
    "altogether , the mentioned structure , which can be used with other synthesis methods , filling with the proposed cycle - based synthesis method for interaction cost leads to our whole flow for depth - optimized reversible circuit synthesis .",
    "a given permutation is written as a set of disjoint cycles to be used in the proposed parallel circuit structure .",
    "then , the resulting cycles are distributed among the available @xmath0-line registers based on the bin packing problem .",
    "the cycles are then synthesized on the assigned registers independently .",
    "our experiments and analysis show the effectiveness of the proposed approach with and without the interaction cost limitations for the attempted benchmarks and in the worst - case ."
  ],
  "abstract_text": [
    "<S> in this paper , simultaneous reduction of circuit depth and synthesis cost of reversible circuits in quantum technologies with limited interaction is addressed . </S>",
    "<S> we developed a cycle - based synthesis algorithm which uses negative controls and limited distance between gate lines . to improve circuit depth , a new parallel structure </S>",
    "<S> is introduced in which before synthesis a set of disjoint cycles are extracted from the input specification and distributed into some subsets . </S>",
    "<S> the cycles of each subset are synthesized independently on different sets of ancillae . </S>",
    "<S> accordingly , each disjoint set can be synthesized by different synthesis methods . </S>",
    "<S> our analysis shows that the best worst - case synthesis cost of reversible circuits in the linear nearest neighbor architecture is improved by the proposed approach . </S>",
    "<S> our experimental results reveal the effectiveness of the proposed approach to reduce cost and circuit depth for several benchmarks . </S>"
  ]
}