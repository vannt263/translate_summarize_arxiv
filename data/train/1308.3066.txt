{
  "article_text": [
    "there are many astrophysical applications where the physical domain of interest is a sphere or a circle , e.g.  the numerical simulation of core convection @xcite or of convection in giant planets @xcite .",
    "the usability of spherical coordinate systems is restricted due to the grid singularity in the centre of the sphere as discussed , for instance , by @xcite . with a cartesian grid ,",
    "a huge part of the computational resources are wasted @xcite and to improve resolution along spheres , complex adaptive mesh refinements have to be used @xcite to keep the computational requirements manageable .",
    "therefore , all default grids used in numerical astrophysics have some fatal deficiencies .    for the specific case of a sphere with grid singularity at the centre , @xcite proposed a different approach .",
    "they use spectral expansion methods on a spherical grid . to avoid the time step restriction due to converging grid lines at the centre",
    ", they lower the order of the harmonic expansion at the centre . the equations are recast in a form such that boundary conditions can easily be applied at the centre . in this way",
    ", the simulation domain can be extended to the full sphere . anyway",
    ", their procedure still requires the specification of a boundary condition at the centre and applies only to spherical domains .",
    "@xcite implemented a discontinuous galerkin method on arbitrary static and moving voronoi meshes . in theory ,",
    "their approach promises great flexibility and wide applicability . in applications , however , there are still numerical difficulties present , e.g.  in the treatment of shocks , making the use of the method in astrophysical applications difficult at the moment .    in this paper , we present the methods used to extend the applicability of the simulation code antares @xcite to more general geometries . until now , antares was exclusively applied to numerical simulations of solar and stellar surface convection and stellar interiors in cartesian geometry ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) as well as convection in cepheids in spherical geometry ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "for the inviscid part of the navier ",
    "stokes equations , the weno finite difference scheme is employed @xcite . the weno scheme is a highly efficient shock - capturing scheme which can be implemented at several different orders of accuracy . in this paper , we consider the fifth order variant called weno5 .",
    "its superiority compared to other high - order schemes was shown , e.g. , in @xcite .",
    "nevertheless , its applicability is restricted by its specific requirements concerning the grid geometry @xcite .",
    "the technique of curvilinear or mapped grids is widely used in engineering @xcite , but until now was only seldomly applied in an astrophysical setting @xcite . in principle , given a suitable mapping function , any problem defined on a general domain can be transformed into a problem in a computational space which is equidistant and cartesian and where any standard numerical scheme , the applicability of which often is restricted to cartesian and equidistant grids , can be used .",
    "the only requirement is that the grid in physical space is structured .    in the context of curvilinear coordinates",
    ", @xcite presented several functions mapping spherical domains to the cartesian computational domain .",
    "these functions are not strongly differentiable and were mainly applied in engineering applications until now .    in this paper",
    ", we will show how well the weno finite difference and finite volume scheme performs on smooth and non - smooth grids for flows in the intermediate flow regime of @xmath0 typical for many problems in stellar astrophysics . we will call a grid ( non)smooth if the associated mapping function is ( non)smooth .",
    "@xcite applied the weno finite difference scheme in a straightforward way to smooth grids . in all numerical examples in the mentioned paper ,",
    "the mach number @xmath1 was higher than @xmath2 .",
    "the behaviour of the method in the low mach number limit on cartesian grids was investigated in  @xcite .",
    "they showed that the weno5 finite difference scheme does not perform well for mach numbers smaller than @xmath3 even on cartesian grids .",
    "most of the findings of this paper are not restricted to our specific code , but apply to any finite difference or finite volume code . from the numerical experiments in section  [ sec - results ] , we conclude in which situations and in which numerical setup the mapped grid technique gives reliable results .",
    "thereby , we concentrate on the weno algorithm and on astrophysical simulations .",
    "we demonstrate the usefulness and applicability of the mapping functions for a sphere from  @xcite in this setting .",
    "the euler equations are a system of partial differential equations . in two spatial dimensions and in a cartesian coordinate system ,",
    "their differential form is    @xmath4    with the state vector @xmath5 and the flux functions @xmath6 and @xmath7 given by    @xmath8    where the pressure @xmath9 is given by an equation of state and @xmath10 is the internal energy . in the following ,",
    "we will write @xmath11 for the velocity vector .    we discretise the euler equations as described in  [ app - disc ] and in @xcite for the case of an equidistant cartesian grid . in the finite difference case ,",
    "the fluxes are reconstructed directly , whereas in the finite volume case , the conservative variables are reconstructed .",
    "the procedure is described in pseudo code in algorithms  [ alg - fd - euler ] and  [ alg - fv - euler ] .",
    "@xmath12 is given as point value at the cell centre .",
    "@xmath13 , @xmath14 @xmath15 , @xmath16 @xmath17    @xmath18 is given as cell average .",
    "@xmath19 , @xmath20 @xmath21 , @xmath22 @xmath23    both algorithms need the specification of a reconstruction operator .",
    "a reconstruction operator calculates the point value of a function given its cell averages .",
    "the weno reconstruction operator is described , e.g. , in @xcite and  [ app - rec5th ] . in the derivation of the finite difference scheme , we required the grid to be equidistant .",
    "the fluxes in the finite volume scheme are second - order approximations to the analytical fluxes which are line integrals over the cell boundary .",
    "details can be found in  [ app - disc ] .",
    "numerical schemes which are designed for cartesian , equidistant grids can be generalised to more complicated domains with the technique of mapped grids . there , a mapping function    @xmath24 ^ 2 \\to \\omega,\\ m(\\xi,\\eta ) = ( x , y)^t,\\ ] ]    is defined which maps the cartesian and equidistant computational space into the physical space . the information about the geometry of the physical space is then contained in the transformed partial differential equations .",
    "the euler equations in strong conservation form in physical space   are transformed into strong conservation form in computational space . in two dimensions",
    ", they take the form    @xmath25    with    @xmath26    [ eulercurvi2d ]    where @xmath27 is the determinant of the inverse jacobian of the mapping function @xmath28 ( see , e.g. , * ? ? ?",
    "@xmath29 and @xmath30 are the computational variables defined by the mapping function @xmath28 .",
    "we present two derivations of the strong conservation form of the two - dimensional euler equations in computational space   which differ in their differentiability assumptions concerning the mapping function @xmath28 .",
    "the classical first approach assuming strong differentiability of the mapping function can be found in  [ app - strong ] .",
    "a more general derivation is sketched out in the following section .    in applications ,",
    "the mapping function @xmath28 which maps the computational domain into the physical domain @xmath31 is unknown or does not possess an analytical form .",
    "we therefore seek for a derivation of the transformed equations   which does not require any differentiability of the mapping function @xmath28 .",
    "following the description in @xcite , we assume that a structured set of nodes @xmath32 , @xmath33 , @xmath34 , is given ( e.g. , by an external grid generation program , see * ? ? ?",
    "* ) , instead of an analytical expression for @xmath28 .",
    "@xmath31 is the smallest region @xmath35 such that @xmath36 , where @xmath37 is the closure of @xmath38 .",
    "then we define the discrete mapping function @xmath39 point - wisely by    @xmath40    for @xmath41                         \\times \\left [ \\eta_{j-\\frac{1}{2}},\\eta_{j+\\frac{1}{2 } } \\right]$ ] , we define @xmath42 by bilinear interpolation of the physical coordinates of the edges of the cell . in this way , we continue @xmath39 to @xmath43 \\times \\left [ -1 , 1 \\right ] \\to \\omega$ ] .",
    "@xmath28 is continuous , linear in each @xmath44 , but not differentiable on the boundary of each cell @xmath44 .",
    "it follows that @xmath45 ^ 2)$ ] , but",
    "@xmath46 ^ 2)$ ] .",
    "if the mapping function is defined in this way , the image of each cell @xmath44 is a quadrilateral @xmath47 with edges @xmath48 , @xmath49 , @xmath50 , and @xmath51 in physical space .",
    "all cell sides are straight lines .",
    "we can choose the quadrilateral @xmath47 as the ( arbitrary ) control volume @xmath52 of the integral formulation of the euler equations    @xmath53\\,da ,   \\\\",
    "\\frac{\\partial}{\\partial t } \\int_{w } e            \\,dv = &       - \\int_{\\partial w } { \\bf n } \\cdot \\left ( p + e \\right ) { \\bf u}\\,da,\\end{aligned}\\ ] ]    [ eulerint ]    where @xmath54 is the unit outward normal on @xmath55 , the boundary of @xmath56 . due to gauss theorem ( p. 627",
    "* ) , equations   are equivalent to the differential form   for sufficiently smooth functions @xcite . but",
    "@xmath57 consists of the four straight lines    @xmath58    their length is given by    @xmath59    and the normal vectors @xmath60 in equations   are exactly    @xmath61    on @xmath62 and    @xmath63    on @xmath64 .",
    "from now on , we will write @xmath65 for the normal vector on @xmath62 and @xmath66 for the normal vector on @xmath64 . the surface area of the quadrilateral @xmath47 is    @xmath67    since @xmath68 , we define the cell average of the state vector @xmath12 in the cell @xmath69 by    @xmath70    with @xmath71 , @xmath72 , we can write equations   as    @xmath73    where    @xmath74    evaluating the line integrals in   with the midpoint rule , we get    @xmath75    in the computational space , all standard numerical methods can be used to calculate the value of the numerical flux functions @xmath76 and @xmath77 since the computational space is equidistant and cartesian . in particular , both the finite difference and the finite volume weno scheme as described in algorithms  [ alg - fd - euler ] and  [ alg - fv - euler ] can be applied to solve  .",
    "the specific form of the algorithms for curvilinear coordinates can be found in algorithms  [ alg - fd - curvi ] and  [ alg - fv - curvi ] .",
    "@xmath12 is given as point value at the cell centre .",
    "@xmath78 , + @xmath79 @xmath80 , @xmath81",
    "@xmath82    @xmath18 is given as cell average .",
    "@xmath83 , @xmath84    @xmath85 , + @xmath86 @xmath87    the advantage of the weak derivation , besides that it does not require @xmath28 to be differentiable , is that one gets formulae for all metric terms occurring in the transformation process .",
    "the jacobian of the transformation is given by the area of the corresponding quadrilateral and therefore is positive by definition .",
    "the mapping function is not required to fulfil any smoothness properties .",
    "we therefore prefer to define our mapping function in this way .",
    "we note that similar formulae exist for the three - dimensional case .",
    "the precise formulation can be found , e.g. , in @xcite .",
    "there is no strongly differentiable function ( a diffeomorphism ) from the ( unit ) sphere to the ( unit ) square since the square is not a submanifold of @xmath88 .",
    "therefore , if we want to use the mapped grid technique to perform simulations on spherical domains , we have to rely on mapping functions which are only weakly differentiable .    for the mapped grid technique , @xcite gave some examples of mapping functions which map a circular domain to @xmath89 ^ 2 $ ] and vice versa . in this paper , we want to investigate how the mapping functions @xmath90 and @xmath91 from @xcite defined by    @xmath92 ^ 2 \\to \\omega,\\                  & x = r \\cdot \\frac{\\max \\left",
    "( \\left|\\xi\\right|,\\left|\\eta\\right| \\right ) \\xi } { \\sqrt { \\xi^2 + \\eta^2 } } , \\\\                &",
    "y = r \\cdot \\frac{\\max \\left ( \\left|\\xi\\right|,\\left|\\eta\\right| \\right ) \\eta}{\\sqrt { \\xi^2 + \\eta^2 } } , \\\\",
    "m_2:\\ \\left [ -1 , 1 \\right]^2 \\to \\omega,\\                  & w = \\max \\left ( \\left|\\xi\\right|,\\left|\\eta\\right| \\right)^2 , \\\\                & x = w \\cdot x_{m_1 } + ( 1 - w ) \\cdot",
    "\\frac{r \\xi } { \\sqrt{2 } } ,    \\\\                & y = w \\cdot y_{m_1 } + ( 1 - w ) \\cdot \\frac{r \\eta}{\\sqrt{2}},\\end{aligned}\\ ] ]    [ eq - calhoun ]    where @xmath93 and @xmath94 are the physical coordinates defined by @xmath90 , and    @xmath95    perform in numerical simulations when weno schemes are employed .",
    "it is obvious to see that these functions are only weakly differentiable .",
    "therefore , they should be applied only in the context of the methods developed in section  [ sec - mapped ] .     from @xcite.,scaledwidth=50.0% ]     from @xcite.,scaledwidth=50.0% ]      @xcite emphasize the importance of the following , seemingly simple , test problem .",
    "[ freestreameuler ] given the initial conditions    @xmath96    with constant density @xmath97 and internal energy @xmath98 , the numerical solution of the transformed system   should stay close to the analytical solution    @xmath99    for all times .",
    "@xmath100 is the pressure given by the equation of state .    plugging these initial conditions into the transformed euler equations  , we get    @xmath101    since @xmath102 .",
    "this condition must be fulfilled numerically in order to prevent numerical errors .",
    "since    @xmath103    this is equivalent to the requirement that the second derivatives of the mapping function @xmath28 are symmetric .",
    "every function which is twice ( weakly ) differentiable fulfils this property .    next , we investigate if the freestream is preserved by the finite difference and the finite volume discretisation of the euler equations .",
    "the weno finite difference scheme as summarised in algorithm  [ alg - fd - curvi ] corresponds to the scheme ` weno - g ` in @xcite . in the cited reference",
    ", they describe precisely why the finite difference scheme does not fulfil the freestream preservation property . the fluxes @xmath104 and @xmath105",
    "are reconstructed directly from their value at the cell centre , including the metric terms evaluated at the cell centre .",
    "these fluxes are not constant for the freestream initial conditions",
    ". the reconstructed fluxes at the cell boundary will not be constant , too , and be different on any cell boundary .",
    "therefore , they will not cancel out , and steadily , a numerical error is introduced .",
    "we note that @xcite introduced the ` weno - c ` scheme as a different weno finite difference scheme which fulfils the freestream property by calculating @xmath106 via    @xmath107    we did not consider this scheme in our paper since it is not conservative and its computational costs are three times higher than ` weno - g ` in three dimensions , making the scheme useless for our purposes .    on the contrary , for the weno finite volume scheme",
    "as summarised in algorithm  [ alg - fv - curvi ] , the state vector @xmath5 is reconstructed at the cell boundaries from its cell averages .",
    "therefore , for problem  [ freestreameuler ] the reconstruction process will yield constant approximations for the state vector at the cell interface , i.e.    @xmath108    in the update step  , only the metric terms will be non - constant . in precise terms , the conditions    @xmath109    [ metcond ]    are equivalent to preserving the freestream .",
    "if the metric terms are calculated , as described in section  [ sec - mapped ] , by    @xmath110    [ eq - metric2d ]    conditions   are fulfilled exactly and the freestream will be preserved numerically .",
    "we note that the freestream is never preserved in general if analytical expressions for the metric terms are used ( if available ) .",
    "we remark that even though conditions   look like second - order approximations , they are rather analytical requirements which must be fulfilled by the discretisation of the metric terms in order to preserve the freestream .",
    "they are a consequence of the conservative discretisation of the derivatives in equations  . as described in  [ app - disc ] , the discrete formulations of the euler equations as in   and   are analytically equivalent to  .    for trivial mapping functions such as @xmath43 ^ 2 \\to \\left [ -1 , 1 \\right]^2 $ ] , @xmath111 with @xmath112 , @xmath113 , freestream preservation is of course possible even for the finite difference scheme ` weno - g ` .",
    "we conclude that the mapped grid technique should be used only with the weno finite volume scheme and with the metric terms calculated by  .",
    "non - preservation of the freestream leads to inacceptable errors , as we will demonstrate in the following section .",
    "the weno finite difference scheme can not preserve the freestream and be conservative at the same time .",
    "in the following , we illustrate the theoretical results from the preceeding sections by numerical simulations . besides the mapping functions @xmath90 and @xmath91 defined in",
    ", we use the mapping functions    @xmath114 ^ 2 \\to \\omega,\\      \\begin{split }                & x = -r + 2 r \\cdot \\left ( \\xi   + 0.1 \\sin \\left ( 2 \\pi \\xi \\right ) \\sin \\left ( 2 \\pi \\eta \\right ) \\right ) , \\\\                & y = -r + 2 r \\cdot \\left ( \\eta + 0.1 \\sin \\left ( 2 \\pi \\xi \\right ) \\sin \\left ( 2 \\pi \\eta \\right ) \\right ) , \\\\    \\end{split } \\\\    m_4:\\ \\left [ -1 , 1 \\right]^2 \\to \\omega,\\      \\begin{split }                & x = -r + 2 r \\cdot \\xi , \\\\                & y = -r + 2 r \\cdot \\eta ,    \\end{split}\\end{aligned}\\ ] ]    where @xmath115 ^ 2 $ ] .",
    "@xmath116 was used in @xcite to test the order of accuracy of their scheme since it is a smooth function , whereas @xmath117 gives a cartesian grid .",
    "we will call a grid `` smooth '' if the mapping function defining this grid is smooth .     from @xcite.,scaledwidth=50.0% ]    all simulations are performed with the code antares @xcite using explicit time integration schemes and marquina flux splitting @xcite . if not stated otherwise , the runge ",
    "kutta scheme employed in the simulations is ssp rk(3,2 ) , a second - order runge ",
    "kutta scheme with three stages @xcite . in all simulations ,",
    "the ideal gas equation is used , and the courant number is fixed to @xmath3 .",
    "the weno finite difference scheme corresponds to the method ` weno - g ` in @xcite .",
    "the specific setup of the gresho vortex used in this paragraph is described in @xcite and @xcite .",
    "we repeat the definition here for convenience .",
    "@xmath118    @xmath119 is the distance from the origin and @xmath120 the angular velocity in terms of the polar angle @xmath121 .",
    "note that the difference to the setup as it is described in @xcite is the introduction of a reference mach number @xmath122 .",
    "the pressure @xmath123 is scaled such that the reference mach number is the maximum mach number of the resulting flow .",
    "we performed a simulation with @xmath124 and @xmath125 over a time interval of @xmath126 .",
    "the size of the domain is @xmath127 in each direction , and we use @xmath128 grid points .",
    "the analytical solution is pure angular rotation of the vortex .",
    "the results on the four grids defined by the mapping functions @xmath90 , @xmath91 , @xmath116 and @xmath117 are shown in figure  [ fig - greshoma01-fd ] for the finite difference scheme and in figure  [ fig - greshoma01-fv ] for the finite volume scheme .     with the weno finite difference scheme .",
    "the initial mach number was @xmath3 . in all figures , the results of the simulation with @xmath90 are shown in the top left panel , with @xmath91 in the top right , with @xmath116 in the bottom left and with @xmath117 in the bottom right panel.,scaledwidth=100.0% ]     with the weno finite volume scheme .",
    "the initial mach number was @xmath3.,scaledwidth=100.0% ]    with the non - smooth mapping functions @xmath90 and @xmath91 , the results with the finite difference scheme are catastrophic , whereas with the finite volume scheme , the difference to the solution on the cartesian grid is small .",
    "it is obvious that the problems come from the grid points where the mapping functions are not smooth .",
    "but even with the smooth mapping function @xmath116 , the symmetry of the vortex is destroyed with the finite difference scheme , whereas there is no visible difference to the cartesian solution with the finite volume scheme .",
    "the mach number @xmath124 of this test is rather low for an explicit time integration scheme , but @xcite showed that the weno scheme with runge  kutta time integration yields reliable results in this regime . as shown in figure  [ fig - greshoma05 ] , the deformations due to the grid get smaller with higher mach numbers , but in any case , the results with the finite volume scheme are more accurate . on the other hand",
    ", this explains why applying the mapped grid technique to the weno finite difference scheme in @xcite worked properly : the mapping function were smooth , and the mach number in the numerical tests was always larger than @xmath2 .",
    "we conclude that the weno finite difference scheme should only be used in combination with the mapped grid technique if the mapping function is smooth and if the mach number of the simulation is high .",
    "the reason for the bad performance lies in the violation of the preservation of the freestream .",
    "the finite volume scheme , however , yields accurate results even on non - smooth grids and in low mach number tests .     with the weno finite difference scheme with initial mach number of @xmath129.,scaledwidth=100.0% ]      with the sod shock tube",
    "@xcite we test the performance of our schemes in the high mach number regime .",
    "the computational domain is @xmath130 ^ 2 $ ] and @xmath131 . in each direction",
    ", we use @xmath132 grid points .",
    "the inital shock position is at @xmath133 in @xmath134 direction .     with the weno finite difference scheme .",
    "@xmath90 ( top left panel ) after @xmath135 . in the outermost",
    "three layers , outflow boundary conditions are set.,scaledwidth=100.0% ]     with the weno finite volume scheme . in the outermost three layers , outflow boundary conditions are set.,scaledwidth=100.0% ]    even in this setup where the mach number is rather high , the weno finite difference scheme performs badly with the non - smooth mapping functions @xmath90 and @xmath91 . with @xmath90",
    ", the simulation crashed after @xmath135 because of negative densities .",
    "at the diagonals , numerical artifacts occur even without any flow present at this position as a consequence of the violation of the freestream preservation .",
    "the simulations with the finite volume scheme do not show any anomalies . on the smooth grids , the results from the two schemes are very similar .",
    "@xcite , @xcite and @xcite suggested a non - linear flow example to test the order of accuracy of a scheme .",
    "they showed that a smooth linear flow is not a suitable test case to test the accuracy of a finite volume method , because for a linear initial condition , the integration used to transform equation   into   resp .  in equation",
    "is exact , and the overall order of the method is not restricted .",
    "they suggested to instead use the non - linear initial conditions    @xmath136    with the perturbations of the velocities @xmath137 and @xmath138 , the temperature @xmath139 , and the entropy @xmath140",
    "@xmath141    the computational domain is @xmath142 ^ 2 $ ] , @xmath143 , @xmath144 , @xmath145 and the vortex strength @xmath146 is @xmath147 .",
    "the analytical solution is passive convection of the vortex with the mean flow . for the explicit time integration",
    ", we used the third - order tvd3 scheme @xcite in this test .",
    "the grey line indicates second - order convergence.,scaledwidth=75.0% ]     norm .",
    "the grey line indicates second - order convergence.,scaledwidth=75.0% ]    in figures  [ fig - fdooa ] and [ fig - fvooa ] , the error of the weno finite difference and the finite volume scheme for the nonlinear advection problem are shown .",
    "the error is measured by comparing the numerical solution after @xmath148 to the analytical one in the @xmath149 norm .",
    "we conclude that for the cartesian and the smooth grid defined by the mapping functions @xmath117 and @xmath116 , both schemes show comparable error sizes .",
    "the empirical order of convergence is between two and three for @xmath116 and higher than three for @xmath117 in both cases .",
    "for the non - smooth mapping functions @xmath90 and @xmath91 , the error does not decrease significantly for the finite difference scheme , whereas first- to second - order convergence can be observed with the finite volume scheme .",
    ".mean @xmath150 error sizes and order of accuracy for the finite difference scheme .",
    "[ cols=\"^ , < , < , < , < , < , < , < , < \" , ]     in the finite volume case , we expect second - order convergence for all mappings due to the second - order integration formula used to obtain equation  . consequently , we observe second - order convergence for all grids at least asymptotically for high resolution in table  [ tab - errfv ] . for low resolutions",
    ", the numerical solution exhibits third - order convergence indicating that the temporal error dominates in this regime .",
    "we note that the courant number is @xmath3 in all of our tests minimising the error due to the time integration scheme .",
    "we conclude that the absolute magnitude of the spatial error strongly depends on the mapping function , whereas the convergence order is restricted by the integration rule used to convert equation   into  . to obtain a higher than second order accurate scheme , high - order integration formulae",
    "must be used @xcite .",
    "on cartesian grids , the finite difference algorithm is superior compared to the finite volume algorithm .",
    "as expected , the scheme is at least third order accurate for all resolutions whereas the finite volume scheme shows second - order convergence for high resolutions . for the smooth mapping @xmath116",
    ", @xcite showed that the violation of the freestream preservation leads to large errors which dominate the overall error and decrease the convergence speed . with the non - smooth functions @xmath90 and @xmath91",
    ", this error is particularly large at the diagonals as we can observe for the gresho vortex in figure  [ fig - greshoma01-fd ] .",
    "this error does hardly decrease with grid spacing and leads to the slow convergence found in the data from table  [ tab - errfd ] .",
    "we can explain this slow convergence by the fact that in the finite difference approach , the fluxes @xmath151 and @xmath152 are reconstructed .",
    "but these fluxes are non - smooth themselves since they contain the non - smooth metric terms .",
    "therefore , the reconstruction process is only of low order , too .",
    "this test demonstrates once more that the weno finite difference scheme should only be combined with the mapped grid technique if the mapping function is smooth . with the finite volume scheme",
    ", the simulation converges also on non - smooth grids , but at a much slower rate than on smooth grids . with both algorithms ,",
    "the `` smoother '' function @xmath91 yields more accurate results than @xmath90 .",
    "we conclude that also the finite volume scheme performs better the smoother the grid is .",
    "therefore , non - smooth grids should only be used if absolutely necessary .    for coarse resolutions ,",
    "the results of @xmath91 with the finite volume scheme are better than the results with @xmath90 , but also with the smooth mapping @xmath116 .",
    "they are even comparable with the cartesian mapping @xmath117 . in astrophysical applications where the grid resolution usually is very coarse , grids like",
    "the one defined by @xmath91 combined with the weno finite volume algorithm may well yield sufficiently accurate results .",
    "these grids are an acceptable alternative , if a non - smooth grid is needed by the problem geometry .",
    "curvilinear coordinates are an easy and efficient way to extend existing codes written for cartesian grids to more complicated geometries .",
    "the grid can be generated either by a ( analytical or numerical ) mapping function , or by an external grid generation program . within the framework introduced in section",
    "[ sec - mapped ] it must always be structured .    for the case of spherical domains , @xcite provided mapping functions which are not strongly differentiable .",
    "we showed that the analytical transformation also works in a weak sense without assuming strong differentiability of the mapping function .    in @xcite , the application of the weno finite difference scheme to smooth curvilinear grids",
    "the results are of high accuracy , since the mapping functions are smooth and the mach number of the numerical tests are high .    in this paper , for the first time the weno finite difference and finite volume scheme",
    "were applied with non - smooth mapping functions as those defined by the mapping functions from @xcite .",
    "particular attention is paid to problems arising when the mach number of the flow is rather low . whereas the weno finite volume scheme performs well in these cases",
    ", the weno finite difference scheme does not give a convergent solution .",
    "it only works if the mapping function is smooth , but even in this case the finite volume scheme yields better results for the low mach number tests presented in this paper .",
    "since it is only a minor algorithmic change from the weno finite difference to the weno finite volume scheme , we recommend to switch to the weno finite volume scheme when the mapped grid technique is used for non - smooth mapping functions and also for low mach numbers .",
    "as demonstrated in section  [ sec - results ] the smoother the mapping function is , the more accurate are the results .",
    "therefore , one should always use the smoothest mapping function allowed by the simulation setup .    in theory ,",
    "the finite volume scheme is only second order accurate . in our calculations , however , the empirical order of accuracy of the finite volume scheme was higher . to increase the theoretical order of accuracy the computational requirements and the complexity of the code has to be increased considerably @xcite . in practice ,",
    "weno schemes usually are combined with lower order runge  kutta methods for time integration with highest - possible courant numbers .",
    "the overall error of the scheme will be dominated by the temporal error , and the overall order of the method will be limited to two or three , anyway .",
    "furthermore , in astrophysical simulations the typical resolution is rather coarse . in this case",
    "the spatial error dominates and fast second order time integrators such as ssprk(3,2 ) ( @xcite , cf .",
    "also @xcite ) are sufficient . in this regime ,",
    "non - smooth mapping functions perform nearly as well as smooth ones provided they are combined with the weno finite volume scheme .",
    "we conclude that they are an acceptable alternative , if the problem geometry requires the use of non - smooth mapping functions .",
    "moreover curvilinear coordinates provide enough flexibility for most problems in computational astrophysics whereas keeping the high efficiency and accuracy of the cartesian schemes they are based on .",
    "we show how the grid capability of an existing code written for cartesian coordinates can be extended to more general geometries . in this way",
    ", a wide variety of astrophysical problems can be tackled with antares which were not feasible with standard grids in numerical astrophysics and without any fundamental changes in the numerical method .    in the near future ,",
    "we plan to extend our work to the navier  stokes equations with gravity and diffusion in three spatial dimensions .",
    "it would be interesting to apply low mach number methods such as the one presented in @xcite and @xcite to curvilinear coordinates and further improve their performance for low mach numbers .",
    "furthermore , the influence of the mach number on the results needs additional investigations .",
    "we assume that the distortions due to the freestream preservation violation for finite difference schemes are hidden when there are fast motions of the fluid . only with low mach numbers ,",
    "the numerical errors get large enough to disturb the numerical solution considerably .",
    "we acknowledge financial support from the austrian science fund ( fwf ) , projects p21742 and p25229 .",
    "hgs wants to thank e.  mller , a.  wongwathanarat , p.  edelmann and f.  miczek for helpful and inspiring discussions and the mpa garching for a grant for two research stays in garching .",
    "particular gratitude is owed to a.  wongwathanarat for adverting the work of calhoun et al .  to hgs .",
    "first , we derive the finite difference and finite volume discretisation of the euler equations for the one - dimensional case . the differential form of the euler equations in one spatial dimension is    @xmath153    @xmath154    where @xmath9 . the internal energy @xmath155 is given by @xmath156 .",
    "let @xmath157 $ ] and let a grid on @xmath31 be defined on the half - integer nodes , i.e.    @xmath158    the grid is not necessarily equidistant .",
    "the index @xmath159 refers to the centre of the cell @xmath160 $ ] .",
    "the * cell average operator * @xmath161 on a grid is defined by    @xmath162    applying @xmath161 to gives    @xmath163    with @xmath164 .",
    "@xmath165 is the _ cell average _ of @xmath5 in the cell @xmath166 $ ] .",
    "applying now @xmath167 as in @xcite , we get    @xmath168    @xcite showed that    @xmath169    in general , this is not the case since @xmath170 is a translation operator , but @xmath161 is not translation - invariant . for an equidistant grid , however",
    ", is equivalent to    @xmath171    is called the * shu  osher form * of  .",
    "it is equivalent to   if the grid is equidistant @xcite .",
    "@xmath172 is defined such that its average in cell @xmath173 is given by the point value of the analytical flux function @xmath6 at the cell centre . in terms of @xcite , @xmath6 is exactly the `` primitive function '' of @xmath172 .",
    "a finite volume scheme starts with equation   and computes approximations for @xmath174 from the given cell averaged @xmath175 .",
    "the numerical flux @xmath176 is calculated by    @xmath177    in contrast , the finite difference scheme starts with equation   and computes approximations for @xmath178 from the values of the analytical flux function @xmath6 . since @xmath179 , both approaches are computationally equivalent and require the numerical solution of the following    [ reconstructprob ] given a set of cell averages , compute the value of the underlying function at the half - integer nodes .",
    "the * reconstruction operator * @xmath180 acts on cell averages and reconstructs the point value of the underlying function    @xmath181    on a given grid  .",
    "if the grid is equidistant , the same algorithm can be used to compute @xmath174 and @xmath178 .",
    "the only difference lies in the input for the reconstruction process : in the case of a finite volume scheme , the inputs are given by the cell averages @xmath182 of the state vector , whereas in the case of a finite difference scheme , they are given by the analytical flux function @xmath6 evaluated at the cell centre .",
    "given a reconstruction operator @xmath180 , problem  [ reconstructprob ] can be solved .",
    "the weno reconstruction operator is described in detail in @xcite and also in  [ app - rec5th ] , following the cited reference . in general",
    ", finite volume methods can be designed on non - equidistant grids . however , since the weno reconstruction operator as it is described in  [ app - rec5th ] works only on equidistant grids , the applicability of the finite volume method using this reconstruction method is restricted to equidistant grids , too .",
    "the advantage of the finite difference scheme lies in its easy extension to higher dimensions .",
    "let a region ( i.e. , a non - empty , open , and connected set ) @xmath183 be given .",
    "the euler equations are a system of partial differential equations on @xmath31 . in two spatial dimensions and in a cartesian coordinate system ,",
    "their differential form is    @xmath184    with the state vector @xmath5 and the flux functions @xmath6 and @xmath7 given by    @xmath8    where @xmath9 . in the following ,",
    "we will write @xmath11 for the velocity vector .    in the finite volume approach , applying @xmath185 to the two - dimensional euler equations   results in    @xmath186    the fluxes are now line integrals over the cell boundaries . with the midpoint rule ,    @xmath187    with only one evaluation of the fluxes , the overall order of the method",
    "is restricted to two .",
    "we remark that if @xmath6 is linear , this integration is exact .",
    "contrary , in the finite difference approach , is transformed to    @xmath188    with @xmath189 and @xmath190 .",
    "the overall order of the method only depends on the order of the reconstruction of @xmath172 and @xmath191 , which are one - dimensional reconstruction problems .",
    "the one - dimensional algorithms can be directly applied without loss of order of accuracy .    even if the high order one - dimensional weno reconstruction algorithm is applied to evaluate the flux functions in",
    ", the resulting finite volume method is only second order accurate . to obtain a truely high - order multidimensional finite volume method ,",
    "more complicated integrations for the line integrals in   must be performed , increasing the computational costs of the finite volume scheme tremendously @xcite .",
    "therefore , finite difference schemes are clearly preferable on cartesian grids .",
    "if there is a differentiable function    @xmath24 ^ 2 \\to \\omega,\\ m(\\xi,\\eta ) = ( x , y)^t,\\ ] ]    we can transform the euler equations in differential form   to    @xmath192    with    @xmath26    and the determinant of the inverse jacobian of the transformation    @xmath193    [ eq - curvi2db ]    in this way , the conservation law   defined in the physical space is transformed into a conservation law in the computational space .",
    "if @xmath28 is at least in @xmath194 , all derivatives and the jacobian are well - defined @xcite .    following the description in @xcite",
    ", this form can be derived by multiplying with @xmath27 and rearranging terms .",
    "first we look at @xmath195 . with the chain rule of differentiation ,    @xmath196    in two dimensions ,    @xmath197    and as a direct consequence ,",
    "@xmath198    we can further write    @xmath199    here we assumed the mapping function to be at least in @xmath200 .",
    "the same procedure leads to similar expressions for @xmath201 . plugging all these expressions into leads to .",
    "in the following , the weno reconstruction operator is derived following @xcite .",
    "the purpose of the reconstruction operator is to solve problem  [ reconstructprob ] , i.e.  reconstruct the value of the underlying function at a certain position given a set of cell averages .",
    "we will only consider equidistant one - dimensional grids and reconstruction of the value at the half - integer node @xmath202 .",
    "this is sufficient for the finite difference and finite volume algorithms used in this paper .",
    "the idea of the weno reconstruction process is to use several stencils in the neighbourhood of @xmath202 . on each of the stencils , an interpolating polynomial of high order",
    "is defined .",
    "the interpolated value is obtained by summing these polynomials weighting them according to their smoothness .",
    "if a discontinuity is contained in the stencil of a polynomial , its weight will be very small thereby avoiding oscillatory behaviour known from high order interpolation .",
    "high - order polynomial interpolation is known to produce oscillatory results . to avoid oscillations in the weno approach ,",
    "a convex combination of all candidate stencils @xmath209 is used to compute @xmath205 .",
    "this procedure leads to non - oscillatory approximations of order @xmath219 , where @xmath206 is the width of each of the stencils @xmath208 .",
    "39 natexlab#1#1[2]#2 , , , , ( ) .",
    ", , , , ( ) . , , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , , ( ) . , , , , , , , ( ) . , , , , , , ( ) . .",
    ", , , , , , , ( ) . , , , , , , ( ) . , , , , , , , in : , , , ( eds . ) , , number in , pp . .",
    ", , , , ( ) . , , , ( ) .",
    ", , , , , , , ( ) . , , volume   of _ _ , , , .",
    ", , , , , edition , .",
    ", , cambridge texts in applied mathematics , , .",
    ", , , ( ) . , , , , , .",
    ", , volume   of _ _ , , edition , .",
    ", , , volume   of _ _ , , , edition , .",
    ", , , ( ) . , , , , ( ) .",
    ", , , , , ( ) . , , , ( ) .",
    ", , , , , ( ) . , , ph.d .",
    "thesis , tu mnchen , .",
    ", , , ( ) . . , , ( ) .",
    ", , , , ( ) . , , , , ( ) . , , , ( ) . , , , , ( ) . , , , , , ( ) . , , ( ) .",
    ", , , , , ."
  ],
  "abstract_text": [
    "<S> we investigate the applicability of curvilinear grids in the context of astrophysical simulations and weno schemes . with the non - smooth mapping functions from @xcite </S>",
    "<S> , we can tackle many astrophysical problems which were out of scope with the standard grids in numerical astrophysics . </S>",
    "<S> we describe the difficulties occurring when implementing curvilinear coordinates into our weno code , and how we overcome them . </S>",
    "<S> we illustrate the theoretical results with numerical data . </S>",
    "<S> the weno finite difference scheme works only for high mach number flows and smooth mapping functions whereas the finite volume scheme gives accurate results even for low mach number flows and on non - smooth grids .    </S>",
    "<S> methods : numerical , weno scheme , numerical astrophysics , hydrodynamics , curvilinear coordinates </S>"
  ]
}