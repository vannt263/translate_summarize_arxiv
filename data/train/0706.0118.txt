{
  "article_text": [
    "gene regulatory networks are graphs that represent interactions between genes or proteins . for example , in a transcription network the nodes are genes or operons , identified with their protein products , and the edges represent their transcriptional regulatory regions along dna  @xcite .",
    "the simplest possible approach to study them is to consider their topology .",
    "the main biological question that underlies these studies asks to establish to what extent the empirical biological topology deviates from a `` typical case '' statistics . in order to do that ,",
    "one generates so called `` randomized counterparts '' of the original data set as a null model . that is , an ensemble of random networks which conserve some topological observables of the original , such as the degree sequences , i.e. the number of outgoing and incoming links for each node .",
    "this approach has a wider application for networks of different kinds  @xcite .",
    "a directed network can be conveniently represented as a zero - one adjacency matrix where element @xmath0 is 1 if node @xmath1 has a directed link pointing to node @xmath2 ( fig.1a ) .",
    "the null ensemble of degree - conserving graphs translates into a set of matrices having the same row and column sums of the original matrix . some algorithms to generate this uniformly distributed ensemble",
    "are commonly used  @xcite . in particular ,",
    "one markov chain montecarlo ( mcmc ) algorithm is based on swapping edges at random  @xcite .",
    "this generates an ergodic dynamics , with , however , large relaxation times to a uniform distribution .",
    "another type of algorithm is the so called `` stub - pairing '' or molloy - reed algorithm  @xcite , that consists in randomly linking `` stubs '' made of nodes with required in- and outdegrees , in order to build a randomized instance  @xcite . while useful , this technique may fall in metastable states , where no stubs can be connected .",
    "the algorithm developed by chen _",
    "et al . _",
    "@xcite is more efficient than the mcmc one @xcite and does not run the risk of falling in metastable states .",
    "it is based on an application of importance sampling montecarlo .",
    "it generates matrices with an almost uniform probability , and subsequently adjusts the sample , assigning to every element a certain weight .",
    "finally , it is able to estimate the size of the sampled ensemble .    here , we present an implementation of this algorithm that works specifically on transcription networks , with two variants . the first variant is designed to improve the speed of the algorithm . the second variant enables to deal with ensembles of structured matrices , in particular with structured diagonal , as it is often done in transcription networks when dealing with self - regulations  @xcite .",
    "as the goal is the uniform distribution of the sample , the importance sampling weight for every element is @xmath3 , where @xmath4 is the matrix probability .",
    "the algorithm is illustrated in fig.1a .",
    "the matrix is generated by filling column after column .",
    "suppose , for example , the first column has already been generated and the second one ( in pink in fig.1a ) must be extracted .",
    "one has to consider the row sums having subtracted the first column . at this point",
    ", one can compute a `` constraint '' inside the column in order to allow the algorithm not to fall in metastable states ( fig.1a and  @xcite ) .",
    "subsequently , the constraint - free positions are filled with a probability that can be computed exactly  @xcite . in order to perform this operation ,",
    "the row sums need to be ordered by rank . when all the columns are filled , the total probability of having a certain matrix is the product of all the column probabilities , which can be computed knowing the constraints of each column  @xcite .",
    "this number allows to weigh correctly the matrix sample .",
    "we introduced the following two variants .    * large matrices with compact indegree",
    "* transcription networks typically have several hundreds of nodes .",
    "the computational cost for generating a column is of order @xmath5 where @xmath6 is the length of a column and @xmath7 the number of 1s contained in that column  @xcite .",
    "this is due to the fact that every time that a position must be selected , the algorithm has to evaluate the probability of success for every position inside the column  @xcite .",
    "we have demonstrated that the probability of success in a given position can be well approximated using the corresponding row - sum if the in - degree distribution is sufficiently limited in range .",
    "this last feature is typical of transcription networks .",
    "consequently , as the probability of having a certain zero - one sequence does not depend on the order of extraction , it can be evaluated only once for every column , or , better , for each constraint .",
    "the computational cost for generating a column is then reduced to order @xmath8 .",
    "* structured diagonal * self - regulatory interactions are often considered to have a particular status @xcite .",
    "they are represented in the matrix by 1 on the diagonal  @xcite . in order to constrain the diagonal , one has to modify the way the algorithm calculates the constraints inside the columns , accounting for the fact that some positions are not available for the extraction .",
    "* triangular network motifs * as an example of application we have studied the occurrence of three triangular subgraphs ( fig.1c and 1d ) . the ffl ( feed forward loop ) , sim ( triangular single input module ) and tgc ( three gene chain ) , for the transcription networks of _ e.  coli _",
    "@xcite and _ s. cerevisiae _  @xcite verifying the results that can be found in the literature  @xcite .    in all cases ,",
    "we find a quantitative difference between the subgraph distributions in the randomized ensembles with or without structured diagonal ( fig.1c and 1d ) . in some instances , such as the biologically relevant ffl  @xcite",
    ", this does not affect the decision of whether that subgraph is a motif .",
    "in other cases one can also find qualitative changes .",
    "this difference is more visible in _ e. coli _ as sixty percent of its nodes are autoregulated , and less in _ s. cerevisiae _ with only ten percent of autoregulations .",
    "* feedback * we also evaluated ( fig.1c ) the feedback in the graph , using a simple decimation algorithm that removes the input- and output- treelike components  @xcite . with this algorithm",
    ", the feedback is measured by the size @xmath9 of the decimated graph .",
    "we have ignored autoregolations .",
    "as expected , the sample with structured diagonal is shifted towards smaller amounts of feedback .",
    "this can be explained considering the lower amount of available links to rearrange if the selfregulators are fixed .",
    "in conclusion , we have implemented a montecarlo importance sampling algorithm to randomize directed graphs conserving the degree sequence , and evaluate topological observables .",
    "the algorithm follows the design principles of chen _ et al .",
    "_ , and is designed to be more efficient without loss of uniformity on graphs with compact indegree such as the known transcription networks .",
    "furthermore , we added a variant that works with constrained diagonal , as is usually done in motif discovery  @xcite .",
    "we implemented the code in a simple three - node motif and feedback finder , that reproduces the results known in the literature .",
    "the version of the running code ( in @xmath10 ) used for our analysis is publicly available at http://wwwteor.mi.infn.it/  bassetti / downloads.html , and can be inserted in more general motif finding tools .",
    "the authors would like to thank f. bassetti , s. holmes and p. diaconis for helpful discussion .",
    "the purpose of these notes is to introduce and describe two modifications of the importance sampling randomization algorithm for directed graphs introduced in  @xcite .",
    "the sample of randomized graphs to be generated has to be uniform in the set of graphs having the same degree sequences as the original one , i.e. conserving the number of incoming and outgoing edges for each node  @xcite .",
    "these modifications are produced keeping in mind two important features of transcriptional regulation networks .",
    "the first is that these graphs have compact indegree .",
    "for example in the case of the shen - orr  @xcite data - set for the  _ e.  coli _ transcription network , a graph with about 400 nodes and 600 edges , the maximum indegree is of order 10 , while the maximum outdegree has order 100 .",
    "the second feature is that networks may have an abundance of self - interactions ( this is the case for example in _",
    "e.  coli _ ) .",
    "for this reason , one may wish to consider randomizations that conserve the number of self - interactions , i.e. having structured diagonal in the adjacency matrix ( see below ) .",
    "a directed graph can be represented by an adjacency matrix @xmath11 where the element indexed by @xmath12 is 1 if gene @xmath1 influences gene @xmath2 , and 0 otherwise .",
    "row sums of the matrix represent the number of nodes receiving edges from each node ( outdegree ) , column sums represent the number of nodes sending edges to each node ( indegree ) .",
    "consequently , generating randomized networks with fixed in- and outdegree is equivalent to generating randomized matrices with constant row- and column sums .    the algorithm of  _ _ chen et al.__@xcite has this scope , and achieves it using the montecarlo importance sampling method : every matrix is generated column by column and is then weighted inside the sample with a certain analytically calculated weight .",
    "this weight consists in the inverse of the probability that the matrix is generated by the algorithm .",
    "the calculation of the matrix probability is a crucial point .",
    "it is performed using the conditional poisson distribution  @xcite .",
    "this distribution allows to compute the probability of having a 0 - 1 sequence of length @xmath13 with the constraint of having @xmath14 nonzero entries .",
    "a key role is played by the function @xmath15 where @xmath16 is the set of the possible positions in the sequence ( in this case @xmath17 and @xmath18 is the weight assigned to position @xmath2 . when a column is generated , this weight is @xmath19 , where @xmath20 is the @xmath2th row sum .",
    "suppose now that the positions where 1 are put are extracted one by one and that @xmath21 is the set that contains the positions chosen after the @xmath22th extraction .",
    "at the beginning @xmath23 .",
    "then at the @xmath22th step the position @xmath24 will be extracted with probability @xmath25 where @xmath26 is the weight assigned to position @xmath1 .",
    "the first problem we had to face was due to the dimensions of our matrices .",
    "the networks we considered typically had about 500 nodes , consequently the associated matrix is @xmath27 . with these number , the algorithm of chen _",
    "al . _ is too slow to generate a significant sample in reasonable time .",
    "now , most of the computing time is required by the calculation of @xmath28 .    to avoid this problem , we use the following method .",
    "suppose that the @xmath29th column is being generated , and it has to contain @xmath7 edges , or units .",
    "then for every row with @xmath30 , at least the numerator ( it depends on @xmath1 ) of eq .",
    "[ eqn : estrazione ] must be calculated .",
    "the denominator is a common factor to all the rows , and is not important at this step .",
    "a similar calculation has to be performed for every placement from 1 to @xmath7 .",
    "the process for calculating @xmath31 has a computational cost of order @xmath32  @xcite",
    ". this calculation must be repeated for every available position @xmath1 that is of order @xmath33 . to avoid repeating the process for all the @xmath7 extractions",
    ", we approximate @xmath34 with the number of rows @xmath6 ( typically about 500 ) of the matrix , for every @xmath22 , then the cost for generating a column becomes of order @xmath5 .",
    "in other words , approximating the probability of selection of a certain position with its row sum , the algorithm should calculate the function @xmath35 only once for every column , reducing considerably the computational cost .",
    "we will now argue that this approximation is acceptable for graphs with `` small '' indegree .",
    "the probability of selecting a string @xmath36 with prescribed sum does not depend on the extraction order .",
    "it simply writes @xmath37 where @xmath16 is the set that represent the whole column .",
    "this means that for evaluating this probability one does not have to keep into account the whole process of extraction",
    ". however , the problem of making a good extraction still persists .",
    "in fact , even if the calculation of the sequence probability is correct , nothing assures that this sequence has been extracted with the conditional poisson distribution .",
    "first of all note that the statistical meaning of @xmath38 is : @xmath39 where the random variable @xmath40 . consequently ,",
    "if we compare the probabilities of extracting the position @xmath2 and the position @xmath1 at the @xmath22th step , they can be written as          among all the sets @xmath47 , there will be some that contain @xmath1 .",
    "equivalently , for @xmath44 , there will be some sets @xmath47 containing @xmath2 and some not containing it . as the sum runs over all the possible subsets , we can write it as follows      note that the factor multiplying @xmath49 in the first equation is the same as the factor multiplying @xmath50 in the second ( @xmath51 ) .",
    "the same happens for @xmath52 and @xmath53(@xmath54 ) .",
    "thus , we can rewrite equation [ eqn : differenza ] as          we see that @xmath57 , as separately @xmath58 and @xmath59 .",
    "now @xmath60 where @xmath20 and @xmath61 are the updated row sums ( updated after the genration of the previous @xmath62 columns ) .",
    "then it is easy to see that @xmath63 where @xmath64 .",
    "this is due to the fact the worst situation is when for example @xmath65 and @xmath66 . as @xmath67",
    "the most approximated step is when @xmath68 .",
    "this explains why smaller values of @xmath69 lead to a better approximation .",
    "the probability of being in this situation is proportional to the probability that , after @xmath70 generated columns , the column with the maximum row sum is empty apart form one unit . in order to estimate it roughly , we consider the rows as independent and approximate the row distribution with a bernoulli distribution with probability of success @xmath71 , then the probability of having a sequence of @xmath70 zeros is estimated as : @xmath72 this probability decreases if @xmath69 increases .",
    "for example , for the _",
    "e.  coli _ graph , it is equal to 0.00257 , as @xmath73 and @xmath74 .",
    "this gives a rough estimate of the maximum error .",
    "self - interactions ( units on the diagonal of @xmath11 ) have particular status in transcription networks  @xcite .",
    "for this reason , it is interesting to consider randomized ensembles where the diagonal is constrained .",
    "the problem is then how to make the diagonal inaccessible for the algorithm column - filling steps , and in particular , how to calculate the constrains inside the columns .",
    "first , we note that the positions above the diagonal behave as in the previous case .",
    "the problem restricts to are the positions below the diagonal .",
    "the algorithm to find the constraints inside every column can be summarized as follows .    1 .",
    "order the position ranking them from the highest row - sum to the lowest .",
    "if two or more positions have the same row - sums , the positions below the diagonal must be placed first .",
    "3 .   among the positions below the diagonal having the same row sums , a precise order must be followed .",
    "suppose that after the previous ordering step row @xmath2 occupies position @xmath75 .",
    "then the rows with the lowest difference @xmath76 have the priority .",
    "4 .   let @xmath77 be the vector of positions before the ordering step , i.e. the row occupying now position @xmath1 is the row that occupied position @xmath78 before reordering .",
    "considering the difference @xmath79 , one unit must be subtracted if @xmath80 and if @xmath81 is under the diagonal . 5 .   when @xmath22 becomes large enough so that for some @xmath2 @xmath82 , one unit for every @xmath2 must be summed .",
    "this must be done only if previously one unit had been subtracted for that positions .    in this way",
    "the two vectors @xmath83 and @xmath84 identifying the constrains inside the columns will take into account the inaccessibility of the diagonal .",
    "finally , while placing the units inside the columns , it must be kept in mind that the positions of the diagonal are not accessible .",
    "this must be considered also when assigning the weights to every row and the probability of having a certain number of units before every constraint .",
    "i. bekazova , a. sinclair , d. stefankovic , e. vigoda .",
    "_ negative examples for sequential importance sampling of binary contingency tables _ in y. azar , t. erlebach(eds ) : algorithms - esa 2006 , 14th annual european symposium , zurich , switzerland , september 11 - 13,2006 , proceedings .",
    "lecture notes in computer science 4168 springer , 136 - 147 ."
  ],
  "abstract_text": [
    "<S> * motivation : * transcription networks , and other directed networks can be characterized by some topological observables such as for example subgraph occurrence ( network motifs ) . in order to perform such kind of analysis , it is necessary to be able to generate suitable randomized network ensembles . </S>",
    "<S> typically , one considers null networks with the same degree sequences of the original ones . </S>",
    "<S> the commonly used algorithms sometimes have long convergence times , and sampling problems . </S>",
    "<S> we present here an alternative , based on a variant of the importance sampling montecarlo developed by chen _ </S>",
    "<S> et al . _  </S>",
    "<S> @xcite .    * </S>",
    "<S> availability : * softwares are available at http://wwwteor.mi.infn.it/  bassetti / downloads.html    * contact : * marco.cosentino-lagomarsino@curie.fr , diana.fusco@studenti.unimi.it    * supplementary information : * supplementary notes are available at http://wwwteor.mi.infn.it/  bassetti / downloads.html </S>"
  ]
}