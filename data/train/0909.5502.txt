{
  "article_text": [
    "the pseudopotential generation procedure we apply is similar to that used by others , such as hay and wadt@xcite , or troullier and martins@xcite . in this section",
    "we provide a brief summary of the procedure for generating norm - conserving pseudopotentials , primarily to define the notation and context .    for an isolated atom a hf orbital@xcite , @xmath8",
    ", may be labelled by the quantum numbers @xmath9 , @xmath10 and @xmath11 .",
    "separating the angular and radial coordinates leads to @xmath12 the radial part of the orbital , @xmath13 , satisfies @xmath14 \\phi_{i }   = \\epsilon_{i } \\phi_{i } , \\label{eq:1.2}\\ ] ] where the effective potential for orbital @xmath9 is @xmath15   + \\frac { \\hat{v}_x [ \\ { \\phi \\},l_i ] \\phi_i } { \\phi_i } .",
    "\\label{eq:1.3}\\ ] ] the first term arises from the nuclear charge and the second is the hartree potential due to the total electron density .",
    "the third term is the effective exchange potential , which is different for each orbital . for convenience in what follows",
    "we have included the ( cancelling ) self - interaction in the second and third terms .    to construct a pseudopotential we first partition the atomic orbitals into core orbitals",
    ", whose influence will be represented by the pseudopotential , and valence orbitals , which will be represented by the pseudo - orbitals .",
    "the eigenvalues of the pseudo - orbitals are constrained to equal the equivalent all - electron ( ae ) eigenvalues , and the pseudo - orbitals themselves are constrained to equal the equivalent ae orbitals outside of a `` core radius '' , @xmath16 . inside @xmath16",
    "the orbitals are given by an as - yet unspecified function @xmath17 , so that @xmath18 @xmath19 is chosen such that @xmath20 is nodeless , smooth up to a certain order of differentiation at @xmath21 , and that its norm is equal to that of @xmath22 .",
    "the pseudo - orbital for state @xmath9 satisfies @xmath23 \\tilde{\\phi}_{i }   = \\epsilon_{i } \\tilde{\\phi}_{i}\\ ; , \\label{eq:1.5}\\ ] ] and hence the effective potential , @xmath24 , can be obtained by inverting eq .",
    "( [ eq:1.5 ] ) .",
    "the pseudopotential for state @xmath9 , @xmath25 , is then defined by the pseudo - atom equivalent of eq .",
    "( [ eq:1.3 ] ) : @xmath26   + \\frac { \\hat{v}_x [ \\ { \\tilde{\\phi } \\ } , l_i ]       \\tilde{\\phi}_i } { \\tilde{\\phi}_i } \\;.",
    "\\label{eq:1.6}\\ ] ]    to use the pseudopotential in a calculation for a molecule or solid it is expressed in terms of projection operators , and separated into local and non - local parts , @xmath27 the orbitals with @xmath28 feel the local potential , @xmath29 . here",
    "the index @xmath30 is interchangeable with the pseudo - atom orbital index , @xmath9 , since the valence states chosen to construct the pseudopotential must have unique @xmath30 quantum numbers .",
    "in this section we address the question of the locality of the pseudopotentials defined above . we define a pseudopotential to be local within a radius @xmath31 if , for all @xmath9 and @xmath32 , @xmath33 for some @xmath31 and small @xmath34 .    by definition @xmath35 for @xmath36 and hence @xmath37 for @xmath36 .",
    "this equality , together with eqs .",
    "( [ eq:1.3 ] ) and ( [ eq:1.6 ] ) gives @xmath38        \\nonumber \\\\ *   & & + \\frac { \\hat{v}_x [ \\ { \\phi \\ } , l_i ] \\phi_{i } } { \\phi_{i } }   - \\frac { \\hat{v}_x [ \\ { \\tilde{\\phi } \\ } , l_i ]   \\tilde{\\phi}_{i } } { \\phi_{i } } , \\;\\;\\;\\ ; r > r_{ci}. \\nonumber \\\\ * \\label{eq:2.2}\\end{aligned}\\ ] ] the first two terms are independent of the orbital and , since @xmath39 and @xmath40 differ by the exponentially decaying core contribution , the sum of these terms approaches @xmath5 as @xmath41 . however , since the hf exchange potential is non - local there is no reason to expect the final two terms to cancel , or to approach zero faster than @xmath4 as @xmath42 .    to obtain the asymptotic form of @xmath43 \\phi_{i}/ \\phi_{i}$ ] we start from the asymptotic behaviour of the atomic hf orbitals .",
    "et al.__@xcite have shown that the asymptotic form of the atomic hf orbitals as @xmath41 is dominated by an exponential decay with exponent @xmath44 , where @xmath45 denotes the highest occupied orbital .",
    "_ et al.__@xcite derived the full asymptotic form , @xmath46 where we use @xmath47 to denote `` asymptotically approaches as @xmath42 '' .",
    "they found expressions for @xmath48 which can be summarised as @xmath49 where @xmath50 , there are @xmath51 electrons in the atomic configuration , and @xmath52 is the lowest non - zero @xmath30 value in the configuration .    in eq .",
    "( [ eq:2.4 ] ) and the rest of this section we limit our analysis to closed shell atoms to aid clarity .",
    "the generalisation to open shell atoms using spin averaging or eigenfunctions of the total angular momentum is straightforward but algebraically complex , and does not change our conclusions .",
    "( [ eq:2.3 ] ) and ( [ eq:2.4 ] ) do not apply to @xmath53-electron - only atoms . in this case",
    "the exponent for each orbital is different and is given by @xmath54 , and it is straightforward to demonstrate that the sum of the exchange terms in eq .",
    "( [ eq:2.2 ] ) approaches zero exponentially as @xmath6 increases .",
    "we do not consider these pure-@xmath53 atoms in what follows .",
    "expressing the hf exchange potential in spherical polar co - ordinates and taking the limit as @xmath42 gives @xmath55 \\phi_i(r ) & \\sim & - \\sum_j \\sum_l   ( 2 l_j + 1 ) w_j \\left (    \\begin{array}{lll }      l_j & l & l_i \\\\      0    & 0 & 0       \\end{array }    \\right)^2 \\nonumber \\\\ * & & \\times \\frac{\\phi_j}{r^{l+1 } }   \\int_0^{\\infty } r^l \\phi_j \\phi_i dr\\ ; , \\label{eq:2.5}\\end{aligned}\\ ] ] where the wigner @xmath56 notation has been used for triple integrals over spherical harmonics .",
    "the occupation of shell @xmath32 is denoted by @xmath57 , where @xmath58 for a full shell .",
    "we define the effective exchange potential for orbital @xmath9 as @xmath59   \\phi_i(r ) }                 { \\phi_i(r )                               } .",
    "\\label{eq:2.6}\\ ] ] next we explicitly separate the exchange interaction between electrons within shell @xmath9 from the remaining exchange , and use the asymptotic forms for the orbitals of eq .",
    "( [ eq:2.3 ] ) , to obtain    @xmath60    where @xmath61 .",
    "the first term in eq .",
    "( [ eq:2.7 ] ) is always present and is a part of the self - interaction correction ( sic ) which is the same for all orbitals .",
    "the second term is part sic and part exchange interaction , and is non - zero only for @xmath62 .",
    "if present this introduces terms @xmath63 for @xmath64 which are different for each orbital .",
    "the third term is the remainder of the exchange interaction , and we consider the maximum power @xmath65 that appears in this expression with a non - zero coefficient",
    ". given that the wigner @xmath56 symbol is non - zero only for @xmath66 and @xmath67 even , and that the integral is zero for @xmath68 , we find that the maximum @xmath69 takes the values @xmath70 where @xmath71 and @xmath52 is as defined for eq .",
    "( [ eq:2.4 ] ) .    using eq .",
    "( [ eq:2.8 ] ) we may write the effective exchange potential in the limit @xmath72 as @xmath73 where the wigner @xmath56 and its pre - factor in eq .",
    "( [ eq:2.7 ] ) have been subsumed into the parameters @xmath74 and @xmath75 , and the sums are taken over the @xmath30 and @xmath32 that give @xmath76 and @xmath77 . for @xmath78 ,",
    "only the sic term appears since @xmath79 . note that for @xmath80 , @xmath81 is non - zero and the effective exchange potential contains a @xmath82 term in addition to the sic .    using the same line of argument , the pseudo - atom effective exchange potential at large distances is given by @xmath83 again with @xmath79 for @xmath78 .",
    "the sum over @xmath84 is as before , and a similar non - zero limit and @xmath82 term appear .",
    "the occupation of pseudo - shell @xmath32 , @xmath85 , is defined as for the ae atom , but is zero for core states . since the integrals in eq .",
    "( [ eq:2.9 ] ) and eq .",
    "( [ eq:2.10 ] ) are not in general equal , the limits for the ae and pseudo - atom effective exchange potentials are not equal and do not cancel in eq .",
    "( [ eq:2.2 ] ) .",
    "in addition , exchange terms due to core - valence interactions will not cancel as no core orbitals are present in the pseudo - atom .",
    "the asymptotic behaviour of the pseudopotential can be obtained to @xmath86 from the explicit forms of the external , hartree , and exchange potentials .",
    "starting with the ae effective potential , eq .",
    "( [ eq:1.3 ] ) can be expressed as @xmath87 if we write the asymptotic form of the pseudopotential as @xmath88 where @xmath89 and @xmath90 are constants then the equivalent expression for the pseudo - atom effective potential is @xmath91 where there are @xmath92 valence electrons . since @xmath93 for @xmath36",
    "we may equate the coefficients of @xmath82 and @xmath94 to give    @xmath95 & i \\neq ho\\ ; , \\\\",
    "\\end{array }   \\right . \\label{eq:2.14}\\ ] ]    and , assuming that the charge of the ae and pseudo - atoms are equal ( @xmath96 ) , @xmath97   \\right .",
    "+ & \\\\      & \\left.~      \\sum_{\\{lj\\}|n_{ij}=-1 }     a_{ijl } \\left [      \\tilde{w}_j \\int_0^{\\infty } r^l \\tilde{\\phi}_j \\tilde{\\phi}_i dr-      w_j          \\int_0^{\\infty } r^l         \\phi_j          \\phi_i   dr      \\right ] \\right ) & i \\neq ho\\;. \\\\ \\end{array }   \\right . \\label{eq:2.15}\\ ] ]    for @xmath98 , @xmath89 and @xmath90 are generally non - zero since the ae and pseudo - orbitals differ in the core region .",
    "in addition , terms due to exchange between state @xmath9 and core states have no counterpart in the pseudo - atom to cancel with , as @xmath58 and @xmath99 for the core states .",
    "this orbital dependent `` offset potential '' and `` ghost charge '' result from a remnant of the ae exchange interaction remaining in the pseudopotential as it is not completely removed by the exchange interaction in the pseudo - atom , and is generally due to both valence - valence and valence - core exchange . because these terms are orbital dependent the pseudopotential itself is non - local over all space and does not satisfy the locality criteria of eq .",
    "( [ eq:2.1 ] ) for any @xmath31 .",
    "it should be stressed that this extreme non - locality is necessary if we require our hf pseudopotential to be both norm conserving and to reproduce the ae valence eigenvalues and orbitals outside of the core region .    to illustrate the physical consequences of this behaviour we consider the total energy of a collection of identical pseudo - atoms .",
    "the total energy should tend towards the total energy of the isolated pseudo - atoms as they are separated further apart .",
    "this is true if each channel of the pseudopotential approaches @xmath5 for large @xmath6 . for the extreme non - local behaviour found here",
    "this is not the case , and an unphysical interaction persists at large distances . for extended systems",
    "this is catastrophic because the total energy is undefined .",
    "extreme non - locality may be avoided in the construction of a pseudopotential by using a different configuration to construct each channel , such that the configuration used to construct channel @xmath30 has @xmath100 .",
    "although this is practical for h and he , for heavier atoms this requires the construction of pseudopotentials from electronic configurations far from those we wish to use them for",
    ". it would not be reasonable to expect the resulting pseudopotentials to be transferable to systems of interest , and they would not reproduce the valence states of the neutral isolated atom .      the kleinman - bylander form is expressed in terms of operators that project the orbitals onto a set of basis functions , and takes the general form @xmath101 for some @xmath102 .",
    "the pseudopotentials discussed in section [ sec : def_pp ] may be expressed in this form if we define @xmath103 where the @xmath104 are the eigenstates of the pseudo - atom . if a complete set of @xmath104 is included in the sum in eq .",
    "( [ eq:2.1.1 ] ) , this form would be exactly equal to eq .",
    "( [ eq:1.7 ] ) . in practice",
    "a more useful approach is to use a small number of localised , bound , atomic states ( such as those used to construct the original pseudopotential ) with @xmath105 chosen such that @xmath106 as @xmath107 . for this choice of localised bound states ,",
    "@xmath108 is well - behaved at large @xmath6 , since the subspace covered by the projection does not include this asymptotic region - the non - local part of the pseudopotential has been localised by representing it within a localised subspace .",
    "we conclude that converting a norm - conserving hf pseudopotential to kleinman - bylander form removes the long ranged non - locality , and so allows these potentials to be implemented computationally in a manner which avoids the unphysical behaviour described previously .",
    "it should be noted that the `` frozen remnant '' of the atomic exchange interaction which makes up the non - coulombic tail is still present ( although limited to a subspace represented by the pseudo - orbitals ) , and it may still lead to significant errors .",
    "extreme non - locality does not occur for pseudopotentials constructed within kohn - sham dft because the effective potential that represents the electron - electron interaction is the same for all electrons ( i.e. , it is local ) .",
    "more explicitly , in dft the local exchange - correlation potential takes the place of the exchange potential in eq .",
    "( [ eq:2.2 ] ) and hence the equivalent expression for the pseudopotential is @xmath109 + { v}_{xc } [         \\rho   ]   - { v}_{xc } [ \\tilde{\\rho } ] , \\;\\;\\;\\ ; r > r_{ci}. \\label{eq:2.2.1}\\ ] ] for @xmath110 , where @xmath111 $ ] , all @xmath25 are the same , so the pseudopotential is local outside of the core region .    within the optimised potential method ( opm )",
    "@xcite the exchange - correlation energy functional is replaced by an `` exact '' exchange energy functional ( possibly with an added approximate correlation functional ) defined explicitly in terms of the kohn - sham orbitals and implicitly in terms of the charge density .",
    "this exact exchange ( exx ) functional takes the form of the fock term of hf , but is evaluated using the ks orbitals and hence the calculation remains ks - dft @xcite and the opm exchange energy does not equal the hf exchange energy .",
    "norm - conserving pseudopotentials have been defined within this theoretical picture by engel _",
    "et al . _ and others , and `` spurious long range structure''@xcite consistently appears in these pseudopotentials .",
    "given the highly non - local nature of the fock term it seems reasonable that the exchange potential is also an extremely non - local functional of the density .",
    "we also expect the exchange potential to approach zero as @xmath42 , since this behaviour is part of the definition of the exx potential itself @xcite .",
    "these two observations , together with eq .",
    "( [ eq:2.2.1 ] ) , explain the existence of the structure found by engel _",
    "et al . _",
    "@xcite they found that pseudopotentials constructed by removing this long range structure resulted in improved bond distances and energies for simple dimers and bulk al .",
    "note that the opm case is in some regards similar to that found in the hf case , but it is essentially different in that the potential is local for @xmath112 and approaches @xmath5 faster than @xmath4 .",
    "for local ( e.g. , the local density approximation or lda ) or semi - local ( e.g. , the generalised gradient approximation or gga ) exchange - correlation functionals we note that @xmath39 and @xmath40 differ by the exponentially decaying core contribution and obtain the relation @xmath113 the absence of an offset or ghost charge is a consequence of the locality of the approximate exchange - correlation functional .",
    "it is clear that there is no dft analogue of the extreme non - locality present in hf pseudopotentials .",
    "to construct a pseudopotential from an ae atomic hf calculation we must define a form for the pseudo - orbitals inside the core radius , @xmath17 .",
    "we chose the troullier - martins  @xcite form @xmath114 , \\label{eq:3.1}\\ ] ] which is based on the observation that the pseudo - orbitals are smoother if the odd derivatives of the screened pseudopotential at the nucleus are set to zero .",
    "the coefficients are determined by requiring norm - conservation of the charge in the core region , continuity of @xmath115 and its first four derivatives at @xmath16 , and the requirement that @xmath24 has zero curvature at the origin .    as an example we consider ne ( @xmath116 ) and perform a numerical hf calculation and construct @xmath117 for the @xmath118 and @xmath119 orbitals .",
    "we then obtain @xmath53 and @xmath120 pseudopotentials as described in section [ sec : def_pp ] .",
    "we also calculate the @xmath82 and @xmath94 contributions to the asymptotic behaviour directly from the pseudo - orbitals .",
    "first we note that , for ne , the highest occupied orbital is @xmath121 . from eqs .",
    "( [ eq:2.7 ] ) and eq .",
    "( [ eq:2.8 ] ) it follows that the @xmath120 part of the pseudopotential approaches @xmath5 as @xmath122 due to the @xmath123 exchange interaction .",
    "for the @xmath53 part , the exchange interaction contributes the @xmath124 term , which is the only interaction appearing in eqs .",
    "( [ eq:2.11 ] ) and ( [ eq:2.13 ] ) . to obtain values for @xmath125 and @xmath126",
    "we first obtained the asymptotic behaviour of the effective potential @xmath127 by direct substitution of the asymptotic form of the orbital into eq .",
    "( [ eq:1.2 ] ) . equating powers of @xmath6 leads to @xmath128 and @xmath129    using the numerical values of the integrals and eigenvalues we obtain the values of @xmath130 and @xmath131 , and by using eqs .",
    "( [ eq:2.14 ] ) and ( [ eq:2.15 ] ) we obtain @xmath132 a.u .",
    "( 0.26  ev ) and @xmath133 _ e _ , that is , a positive offset to the potential and a positive ghost charge .",
    "the difference between the @xmath53 part of the ne pseudopotential and the coulomb potential , @xmath135 is shown in fig .",
    "it is clear that the pseudopotential does not approach the coulomb potential for large @xmath6 .",
    "the calculated asymptotic form , @xmath136 , is also shown .",
    "the difference between the pseudopotential and the calculated asymptotic form at large @xmath6 arises mainly from a @xmath137 term which was not included in the asymptotic form .    the magnitude of the deviation from the coulomb potential at large @xmath6 shown in fig .",
    "[ fig1 ] is typical of that found for all @xmath120 and @xmath138-block atoms .",
    "we conclude that the non - locality persists far from the nucleus and is of significant magnitude for these atoms . for @xmath53-block atoms the @xmath53 channel is due to the @xmath45 orbital , hence @xmath139 .",
    "the @xmath120 and @xmath138 channels are generally obtained from excited atomic states for which the offset is typically @xmath140",
    "a.u . for the channel which does not correspond to the @xmath45 orbital .      here",
    "we consider several methods for removing the non - coulombic tails of the pseudopotentials in order to localise them within some radius @xmath31 . in",
    "what follows we define the localisation radius , @xmath31 , as in eq .",
    "( [ eq:2.1 ] ) , with @xmath141 a.u .    previous workers ( for example , greef and lester  @xcite ) have expanded pseudopotentials in a gaussian basis , a standard form for quantum chemistry applications . due to the functional form of this expansion",
    "the parameterised pseudopotential is non - local in a finite region surrounding the nucleus , and approaches the coulombic form as @xmath42 , hence the expansion may be used as a localisation procedure .",
    "generally this expansion is obtained numerically by requiring the parameterised pseudopotential to reproduce the pseudo - states of the original pseudopotential to within a given accuracy .",
    "@xcite although this method can work well it is difficult to control the smoothness and the localisation radius , @xmath31 , since the error in the expanded pseudopotential ( and accompanying pseudo - states ) must compensate for the absence of the long range behaviour present in the original pseudopotential .",
    "we prefer to control the localisation of the original pseudopotential and then , if desired , expand the resulting potential in a gaussian basis .",
    "gaussian expansions are not considered further in this paper , but we will present parameterised pseudopotentials obtained in this way in a separate paper@xcite .",
    "we have freedom in our choice of @xmath16 and @xmath19 , and by varying these quantities we might be able to localise the pseudopotential in the sense of eq .",
    "( [ eq:2.1 ] ) , since variations in these quantities will alter the integrals in eqs .",
    "( [ eq:2.14 ] ) and ( [ eq:2.15 ] ) . for ne ( and for most atoms ) the first term in eqs .",
    "( [ eq:2.14 ] ) and ( [ eq:2.15 ] ) is larger than the second because the ae orbitals possess radial intervals where they are negative , while the pseudo - orbitals are positive for all @xmath6 . in order to decrease the value of this integral , causing @xmath125 and @xmath126 to become closer to zero",
    ", @xmath19 might be chosen such that , on average , the electron is closer to the nucleus .",
    "this might be achieved by increasing @xmath16 , allowing the maximum of @xmath142 to be closer to the nucleus .",
    "also , the form of @xmath19 may be altered ( a convenient way of achieving this is to relax the continuity of the @xmath143 and/or @xmath144 derivatives ) .",
    "calculations suggest that neither of these approaches is useful - for a good cancellation of the integrals in eqs .",
    "( [ eq:2.14],[eq:2.15 ] ) @xmath16 must be very large , or @xmath19 must take a form such that the corresponding pseudopotential is far from smooth .",
    "next we consider an elegant procedure described by engel  _ _ et al.__@xcite and used by them to remove the ( local ) intermediate range structure present in opm pseudopotentials .",
    "this approach employs a self - consistent modification of the pseudo - orbitals over all space , while conserving the norm .",
    "the same method may be applied to localise hf pseudopotentials .",
    "the pseudopotential at iteration @xmath145 is denoted by @xmath146 , and the associated pseudo - orbitals are @xmath147 .",
    "the pseudopotentials calculated in section  [ sec : def_pp ] correspond to @xmath148 .",
    "we construct an effective potential which is not yet self - consistent , @xmath149 + v_h [ \\tilde{\\rho}_n ]   + \\frac { \\hat{v}_x [ \\ { \\tilde{\\phi } \\}_n , l_i ]       \\tilde{\\phi}_{i;n } } { \\tilde{\\phi}_{i;n } } \\ ; , \\label{eq:3.10}\\ ] ] where @xmath150 $ ] is the coulomb@xmath151hartree potential due to the ionic core .",
    "equation ( [ eq:3.10 ] ) is the external potential we desire outside of the core radius together with the effective interaction potential of the pseudo - orbitals @xmath147 .",
    "taking the correct asymptotic form for the orbitals , we integrate in from @xmath152 to @xmath16 at energy @xmath153 to obtain the new orbitals @xmath154 in this region , and these are normalised by requiring that the norm of the newly generated and original pseudo - orbitals outside of @xmath16 are equal . in the core region",
    "the new orbital is constructed by using the troullier - martins form and criteria described at the beginning of this section .",
    "taking @xmath154 , we invert the hf equations as described in section [ sec : def_pp ] to find the new external potential that results in these orbitals @xmath155 on solution of the hf equations , @xmath156 .    the new set of orbitals are then used in eq .",
    "( [ eq:3.10 ] ) to generate the effective potential @xmath157 and the entire process repeated until self - consistency is achieved - we use @xmath158 a.u . for all @xmath6 . at self - consistency @xmath146",
    "is the pseudopotential we require .",
    "this method finds the hf orbitals that take the troullier - martins form in the core region , result from a local ionic potential outside of the core region , and have the same eigenvalues and norm as the original ae atom valence states .",
    "a number of difficulties presented themselves with this method .",
    "we found that for atoms with few valence electrons it was not possible to achieve self - consistency .",
    "this appeared to be because the analytic form used for the orbitals in the core region was not general enough to give a self - consistent solution .",
    "furthermore , although engel s approach conserves the norm of the original ae states , it does not conserve the magnitude or the radial derivative of the orbitals at @xmath16 .",
    "consequently the new pseudopotential does not conserve the logarithmic derivative or its energy derivative , and does not reproduce the scattering properties of the ae atom .",
    "for example , for the @xmath53-channel of ne the new pseudopotentials results in a @xmath159 change in the magnitude of the orbital at the core radius , a @xmath160 change in the logarithmic derivative , and a @xmath161 change in the energy derivative of the logarithmic derivative .",
    "these errors may be acceptable , although the error in the logarithmic derivative might be problematic .    by introducing an interface region between the core region and the valence region ( where the pseudopotential is ionic ) it is in principle possible to modify engel s method such that the magnitude of the orbital , the logarithmic derivative and the energy derivative of the logarithmic derivative are all conserved at the core radius .",
    "this was attempted using the troullier - martins form together with additional criteria .",
    "we found that either self - consistency could not be achieved or that the resulting pseudopotentials were far from smooth .",
    "the method we chose to use is to apply a transformation to the original pseudopotential such that deviations from the hartree@xmath151coulombic ionic core potential are removed beyond a certain radius but desirable properties of the original potentials are preserved .",
    "we investigated the transformation",
    "@xmath162 + \\frac{z}{r }      \\right )                               & \\\\      ~ + v_h [ \\rho_{core } ] - \\frac{z}{r }   & r \\geq r_i \\ ; ,    \\end{array }    \\right . \\label{eq:3.4}\\ ] ] where @xmath150 $ ] is the ionic potential .",
    "the gaussian decay of the non - coulombic part of the potential occurs over a distance @xmath163 , and the zeroth and first derivatives of @xmath164 are continuous at @xmath165 .",
    "the precise value of @xmath166 has very little influence on the final result - the cutoff radius , @xmath165 , governs the quality of the pseudopotential .    for the simple cutoff function corresponding to @xmath167 and @xmath168 a.u .",
    "we chose @xmath165 as the minimum value for which the @xmath169 a.u .",
    ", where the @xmath170 are the eigenvalues of the new pseudopotential . for ne",
    "this new pseudopotential is local ( in the sense of eq .",
    "( [ eq:2.1 ] ) ) outside of a radius of @xmath171  a.u .",
    "although this is large in comparison with the core radii of the orbitals themselves , it may be acceptable , although it would be expensive for dmc .",
    "moreover , this approach enforces a gaussian decay on a monotonically increasing function , essentially creating a ( smoothed ) step - like behaviour in the pseudopotential , and it seems likely that this would introduce transferability problems .",
    "note that if we seek to remove this step - like behaviour by decreasing @xmath166 then @xmath31 rapidly becomes impractically large .",
    "a more successful approach is to choose @xmath172 and @xmath173 ( as before , the final result is insensitive to the choice of this parameter ) so that the pseudopotential is non - local in a small region and no step - like behaviour occurs . in order to reproduce the eigenvalues of the original pseudopotential",
    ", @xmath174 must be non - zero , and we use @xmath175 where @xmath166 is chosen as before and @xmath176 and @xmath177 are orbital dependent parameters .",
    "this function is continuous and smooth at @xmath178 , and the second derivative is zero at @xmath179 ( see the discussion following eq .",
    "( [ eq:3.1 ] ) ) .",
    "our goal is to search for values of these parameters such that the localised pseudopotential preserves certain desirable features of the original pseudopotential .",
    "we require that the conditions @xmath180_{r_i}=0 \\ ; , \\nonumber\\\\ * \\tilde{\\epsilon}^{loc}_i-{\\epsilon}^{~}_i=0 \\ ; , \\label{eq:3.6}\\end{aligned}\\ ] ] are satisfied in order to reproduce the original eigenvalues and aid transferability .",
    "conservation of these two quantities takes precedence over norm conservation and we do not require the norm of @xmath181 to be equal to the norm of @xmath182 as we could not find a reliable method to achieve this and give a smooth pseudopotential .",
    "conservation of the logarithmic derivative of each pseudo - orbital at @xmath165 may be achieved exactly , but a simpler and more convenient approximation is used here . starting with the equations for the original pseudo - orbital and the pseudo - orbital resulting from the localised pseudopotential we may follow a similar derivation to that used to arrive at the standard norm - conservation condition to obtain @xmath183_{r_i}&= & \\nonumber \\\\ *    \\int_0^{r_i } \\tilde{\\phi}^{loc}_i                    \\delta v                    \\tilde{\\phi}^{~}_i dr     - ( \\tilde{\\epsilon}^{loc}_i&-&{\\epsilon}_i )   \\int_0^{r_i }",
    "\\tilde{\\phi}^{loc}_i                \\tilde{\\phi}^{~}_i dr \\ ; , \\nonumber \\\\ * \\label{eq:3.7}\\end{aligned}\\ ] ] where the eigenvalues are not yet constrained to be equal and @xmath184 is the difference between the effective potentials for calculations carried out with the original and localised pseudopotentials ( for the configuration used to construct the pseudopotentials ) .",
    "our approximation is to take @xmath185 to be close to the difference between the external potentials , @xmath186 , for @xmath187 .",
    "we start by using simple iteration .",
    "for a fixed @xmath176 we take an initial value of @xmath188 and solve for the resulting pseudo - orbitals . we then update @xmath177 by solving @xmath189 for @xmath177 and continue until self - consistency is achieved",
    "this is repeated for different values of @xmath176 and the condition @xmath190 is enforced by straightforward bisection .",
    "this process is repeated to obtain self - consistency across all channels , and we obtain eigenvalues which differ by @xmath191  a.u . , and @xmath192 to numerical precision . note that as we have not taken into account the change in the effective potential due to changes in the exchange and hartree potentials , the lhs of eq .",
    "( [ eq:3.7 ] ) is not zero , and there will be a small change in the logarithmic derivative",
    ".      localised pseudopotentials for ne are shown in fig .  [ fig2 ] .",
    "the @xmath53 and @xmath120 channels were obtained from the neutral ground state , while the @xmath138 part was obtained from an excited ionic state ( @xmath193 ) .",
    "all excited state configurations used to obtain pseudopotential channels not bound in the ground state configuration are taken from bachelet _ _ et al.__@xcite inset in the same figure is the difference between the localised pseudopotential and the original numerically exact pseudopotential .",
    "this figure demonstrates that our localisation procedure deforms the pseudopotentials by a small amount , mostly within the core region .    for all atoms considered we found that this process results in a localised pseudopotential which modifies the form of the associated orbitals over all space , but by a very small amount - about @xmath194 of each electron is removed from a region around the core radius and redistributed into two regions , one closer to and one further from the nucleus .",
    "the removal of offset and ghost charge ( and higher order terms ) results from a small change in the asymptotic behaviour of the orbital at large @xmath6 .",
    "normalisation must be preserved , and hence the orbitals are also changed slightly at small @xmath6 .",
    "this effect is illustrated in fig .",
    "[ fig3 ] , which shows the difference between the radial charge density of ne resulting from the localised pseudopotential and the radial charge density resulting from the original pseudopotential .",
    "difference between the charge density resulting from the localised ( @xmath195 ) and original ( @xmath40 ) pseudopotentials for ne . to achieve localisation a small amount of charge near the nucleus is redistributed . ]",
    "the transformed ne pseudopotential is local ( in the sense of eq .",
    "( [ eq:2.1 ] ) ) outside of a radius of @xmath196  a.u . a similarly localised pseudopotential constructed by applying eq .",
    "( [ eq:3.4 ] ) with @xmath167 ( using the same @xmath166 and @xmath165 values ) results in a large error in the @xmath118 eigenvalue of @xmath197  a.u .",
    "as the localised version of the pseudopotential is not equal to the original pseudopotential it is not exactly norm conserving , and does not preserve the form of orbitals outside the core region or at the core radius . to illustrate the magnitude of these effects we return to ne , specifically the @xmath53 channel as this is the major source of the extreme non - locality present in the original pseudopotential .",
    "the localisation process results in a @xmath198 change in the magnitude of the orbital at the core radius , a @xmath199 change in the logarithmic derivative ( due to assuming that the exchange and hartree terms to do not contribute in eq .",
    "( [ eq:3.7 ] ) ) , and a @xmath200 change in the energy derivative of the logarithmic derivative .    the minor relaxation of norm - conservation that accompanies the localisation may influence the transferability of the pseudopotential . however , the familiar conservation of the first order change in the radial logarithmic derivative with respect to energy is only valid when the potential inside the core region is fixed .",
    "@xcite for both the hf and dft this is not the case even for an isolated atom , since @xmath201 is a functional of @xmath202 and each @xmath203 is a function of @xmath204 , and we have shown ( from eq .",
    "( [ eq:3.7 ] ) ) that the norm - conservation relation is replaced by @xmath205 this applies to both the ae and pseudo - atoms .",
    "given that eq .",
    "( [ eq:3.9 ] ) tells us that first order changes in the radial logarithmic derivative depend on the variation of the effective potential with @xmath153 as well as the norm , and that norm - conserving pseudopotentials have been successful in the past , it is likely that the very small relaxation of norm - conservation is not significant .",
    "dft is only strictly valid for local external potentials , hence for a non - local pseudopotential there is formally no one - to - one correspondence between the charge density and the ( now non - local ) effective potential .",
    "however , it is common practice to choose a particular correspondence in order to implement ks - dft with non - local pseudopotentials . in standard ks - dft",
    "we define the effective potential as the sum of the non - local pseudopotential and the same explicit functional of density used in the local external potential case . for the opm method",
    "we define the effective potential as the sum of the non - local pseudopotential and the same implicit functional of density used in the local external potential case ."
  ],
  "abstract_text": [
    "<S> we investigate the properties of norm - conserving pseudopotentials ( effective core potentials ) generated by inversion of the hartree - fock equations . in particular we investigate the asymptotic behaviour as @xmath0 and find that such pseudopotentials are non - local over all space , apart from a few special special cases such h and he . </S>",
    "<S> such extreme non - locality leads to a lack of transferability and , within periodic boundary conditions , an undefined total energy . </S>",
    "<S> the extreme non - locality must therefore be removed , and we argue that the best way to accomplish this is a minor relaxation of the norm - conservation condition . </S>",
    "<S> this is implemented , and pseudopotentials for the atoms h@xmath1ar are constructed and tested .    the pseudopotential approximation is a vital part of the practical application of _ ab initio _ methods to problems in quantum chemistry and condensed matter physics . in the pseudopotential approach </S>",
    "<S> the tightly bound core electrons are removed and their influence on the rest of the system is represented by an effective potential . </S>",
    "<S> this reduces the number of electrons that must be considered and yields a smoother potential . </S>",
    "<S> these properties significantly reduce the computational effort required for complex systems .    over the past few years </S>",
    "<S> ultra - soft@xcite pseudopotentials and separable norm - conserving kleinman - bylander @xcite pseudopotentials have come to dominate within plane - wave density functional theory ( dft ) technology . within the quantum chemistry community </S>",
    "<S> it is more usual to use non - separated norm - conserving pseudopotentials , which are the kind we deal with here . </S>",
    "<S> such pseudopotentials can , however , be converted to the separable kleinman - bylander form .    </S>",
    "<S> our main interest is in diffusion quantum monte carlo ( dmc ) calculations  @xcite . </S>",
    "<S> norm - conserving pseudopotentials are routinely used within dmc calculations  @xcite , and there is evidence to show that hartree - fock ( hf ) theory provides better pseudopotentials for this purpose than dft  @xcite . </S>",
    "<S> hf pseudopotentials have been used in various correlated valence quantum chemistry calculations , and we suggest they would be suitable for use in perturbation theories such as the @xmath2 scheme , which has been applied to a number of condensed matter systems@xcite .    </S>",
    "<S> it turns out that most of the hf pseudopotentials available in the quantum chemistry literature diverge at the origin , normally like @xmath3 or @xmath4 , which makes them unsuitable for use in dmc calculations@xcite . </S>",
    "<S> recently ovcharenko _ _ et al.__@xcite developed hf pseudopotentials for be - ne and al - ar which are finite at the origin , and we will compare the pseudopotentials generated here with these . </S>",
    "<S> we would like our pseudopotentials to be as smooth as possible , since lack of smoothness can reduce the transferability of a pseudopotential . </S>",
    "<S> in addition we wish to generate hf orbitals using a variety of basis sets , including plane waves , for which a smooth pseudopotential reduces the computational cost .    </S>",
    "<S> it is advantageous to make the region over which the pseudopotential is non - local as small as possible as the evaluation of the non - local energy within dmc is expensive . </S>",
    "<S> having a small region of non - locality also tends to promote transferability , but tends to make the pseudopotential less smooth .    </S>",
    "<S> an important issue arises in generating hf pseudopotentials by inversion of the hf equations . </S>",
    "<S> it has long been understood that if the norm is not conserved the hartree potential due to the pseudo - ion does not decay as @xmath5 at large @xmath6 ( where @xmath7 is the ionic charge)@xcite . </S>",
    "<S> it has also been appreciated that the exchange interaction gives a long ranged tail to the pseudopotential which should be removed @xcite . </S>",
    "<S> we find that even if norm - conservation is enforced the exchange interaction results in a `` non - coulombic tail '' that decays more slowly than the coulomb part of the pseudopotential , persists far from the atom , and is non - local . </S>",
    "<S> non - coulombic tails in hf pseudopotentials have been reported before in the literature , but the form that we derive here is different from that described by kahn _ _ et al.__@xcite and hay _ _ et al.__@xcite , who suggest that the deviation from @xmath5 decays faster than @xmath4 .    </S>",
    "<S> these non - coulombic tails increase the cost of calculations , lead to unphysical results and , in the case of periodic boundary conditions , leave the total energy undefined . </S>",
    "<S> consequently the tail must be removed for practical applications . </S>",
    "<S> although past workers have constructed hf pseudopotentials with this long range non - local tail removed , we are not aware of a detailed discussion in the literature of the form and magnitude of this tail . understanding this long ranged effect is important when considering how to remove it .    in what follows </S>",
    "<S> we investigate the general properties of norm - conserving@xcite hf pseudopotentials , with particular emphasis on their non - locality and asymptotic behaviour . </S>",
    "<S> we present a method to localise the potential such that it is non - local only within a relatively small region surrounding the nucleus , and enforce the desired asymptotic behaviour .    </S>",
    "<S> in section [ sec : def_pp ] we discuss pseudopotentials obtained from inversion of the hf equations , in section [ sec : nloc ] we derive the asymptotic behaviour of these pseudopotentials , and report detailed results for ne . in section [ sec : results ] </S>",
    "<S> we present and analyse results for the atoms h - ar . </S>",
    "<S> we draw our conclusions in section [ sec : conc ] .    </S>",
    "<S> atomic units are used throughout , unless otherwise indicated . </S>"
  ]
}