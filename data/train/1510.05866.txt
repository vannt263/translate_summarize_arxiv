{
  "article_text": [
    "over the past decade , considerable progress in the field of ultracold gases has given access to experimentally simulating prototypical many - body models , e.g. , known from condensed - matter physics , with a high degree of dynamic control @xcite .",
    "accompanied by theoretical work , this opened up the possibility to study their emergent phases and nonequilibrium dynamics induced by fast changes of the model parameters @xcite .",
    "as _ the _ paradigmatic model for strongly correlated fermions on a lattice , we consider the fermi - hubbard model @xcite .",
    "not only the bosonic variant @xcite but also the fermi - hubbard model has been realized by recent optical - lattice experiments @xcite .",
    "this promises to provide insight into fundamental questions related to the mott transition , to collective order or even to non - fermi - liquid physics .    using standard notations ,",
    "the fermi - hubbard hamiltonian is given by @xmath0 where a fermion at site @xmath1 and with spin projection @xmath2 is annihilated ( created ) by @xmath3 , and where @xmath4 is the density operator .",
    "tunneling between neighboring sites @xmath5 is described by the hopping amplitude @xmath6 .",
    "on the same site , fermions are subjected to the repulsive hubbard interaction @xmath7 .",
    "a nonequilibrium state and nontrivial real - time dynamics of observables can be initiated by fast changes of the time - dependent model parameters @xmath6 and @xmath7 .    despite its conceptual simplicity",
    ", the hubbard model has challenged theoreticians for more than five decades , and has stimulated the development of a large number of different methods .",
    "many approaches which are based on the language of green s functions @xcite have successfully been extended to describe real - time phenomena @xcite , using the keldysh formalism @xcite .",
    "of particular interest in this context are quantum - cluster theories @xcite , which are formulated in the thermodynamic limit , but nevertheless account for nonlocal correlations on a length scale defined by the linear extension of a reference cluster , which can have a profound influence on the nonequilibrium dynamics @xcite .",
    "a simple but conceptually appealing quantum - cluster approach is the cluster - perturbation theory ( cpt ) @xcite . within the cpt",
    ", the infinite lattice is tiled into small clusters , which can be solved exactly by numerical means .",
    "this solution is then extended to the full lattice by infinite - order perturbation theory with respect to the inter - cluster hopping but neglecting vertex corrections @xcite .",
    "this amounts to approximate the self - energy of the full model by the self - energy of the reference system of disconnected clusters .",
    "a major drawback of the cpt consists in the fact that , even for a given geometrical tiling of the lattice , the partitioning of the hopping part and hence the choice of the reference system , i.e. , the starting point of the perturbative expansion is not unique .",
    "however , the nonuniqueness of the cpt construction can be turned into an advantage , if one can find a variational prescription for finding the _ optimal _ starting point for the cluster - perturbation theory .",
    "in fact , this is achieved with the variational - cluster approach ( vca ) @xcite which is best understood in the general framework of self - energy functional theory @xcite .",
    "the main purpose of the present paper is to discuss different practical issues related to the application of the _ nonequilibrium _ vca .",
    "while the main theoretical concept is essentially the same as for the equilibrium vca , we demonstrate that the numerical implementation of the nonequilibrium variant of the approach is by far more complex and requires new techniques . as a proof of principle ,",
    "we present a first numerical implementation of the nonequilibrium vca , based on simple two - site reference clusters , and study two types of parameter quenches ( or fast ramps ) in the one - dimensional fermi - hubbard model with alternating ( dimerized ) hopping amplitudes which have attracted experimental attention recently @xcite .",
    "the paper is organized as follows : in section  [ sec : noneq - greens - funct ] we briefly review the concept of nonequilibrium green s functions used for the nonequilibrium extension of the self - energy functional theory , as described in sec .  [",
    "sec : self - energy - funct ] .",
    "we derive the central euler equation in sec .",
    "[ sec : euler ] and discuss its numerical implementation in sec .",
    "[ sec : numer - impl ] .",
    "results for the dimerized hubbard model are presented in sec .",
    "[ sec : nevca ] .",
    "a summary is given in sec .",
    "[ sec : summary - outlook ] .",
    "the self - energy functional theory relies on functionals that are formally defined by means of all - order perturbation theory and thus on the concept of ( nonequilibrium ) green s functions @xcite . throughout this paper , we make use of the general theory provided by refs .",
    "@xcite but in first place closely follow the formal setup by wagner @xcite .    for a general fermionic lattice model with hamiltonian @xmath8 which is specified by the parameters @xmath9 and @xmath10 , and which initially ( at time @xmath11 ) is prepared in a thermal state with inverse temperature @xmath12 and chemical potential @xmath13 , the elements of the contour - ordered green s function @xmath14 are defined as @xmath15 here , greek indices combine all one - particle orbitals , and @xmath16 is the annihilator ( creator ) in the heisenberg picture with respect to @xmath17 , where @xmath18 is the total particle - number operator .",
    "we use the short - hand notation @xmath19 , where @xmath20 marks an arbitrary point on the keldysh - matsubara contour @xmath21 ( see fig .  [",
    "fig : contour ] ) .",
    "@xmath22 is the contour time ordering .",
    "further , @xmath23 denotes the expectation value in the initial state , where @xmath24 is density operator , @xmath25 , and @xmath26 with @xmath27 is the partition function .     in the complex time plane , extending up to time @xmath28 ; @xmath29 denotes the upper / lower branch and @xmath30 the matsubara branch . ]    from the heisenberg equation of motion for the annihilator , we find the equation of motion @xmath31 where @xmath32 is the contour delta - function and @xmath33 is the self - energy .",
    "the circle @xmath34 on the right - hand side stands for an integration along @xmath21 and an implicit summation over all orbital indices . by setting @xmath35 in eq .",
    "( [ eq : eom - negf ] ) , we obtain the inverse of the `` free '' green s function @xmath36 as @xmath37 using this , we can rewrite eq .",
    "( [ eq : eom - negf ] ) as dyson s equation : @xmath38",
    "the ( nonequilibrium ) self - energy functional theory is based on the following functional of the nonequilibrium self - energy ( see refs .",
    "@xcite for details ) : @xmath39     =     \\frac{1}{\\beta } \\tr\\ln    \\left ( \\mat g_{\\mat t,0}^{-1 } - \\mat\\sigma \\right)^{-1 }     +     \\fcl    f_{\\mat u } [ \\mat \\sigma ] \\ , .\\ ] ] here , the first term on the right - hand side is a simple and explicit functional of @xmath40 and depends on the system s one - particle parameters @xmath9 . the second term is the legendre transform of the luttinger - ward functional @xmath41 $ ] @xcite .",
    "the latter can be defined by means of all - order perturbation theory or , nonperturbatively , within a path - integral formalism analogous to the equilibrium case @xcite .",
    "note , that functionals are indicated by a hat , and that the trace is defined as @xmath42 , where @xmath43 is infinitesimally later than @xmath44 on @xmath21 .",
    "there are two important properties of the self - energy functional ( [ eq : nesefcl ] ) : first , if @xmath45 $ ] is evaluated at the physical self - energy @xmath46 , one obtains the physical grand potential of the system in its initial thermal state . all contributions from the upper and",
    "the lower keldysh branch cancel in this case .",
    "second , the self - energy functional is stationary at the physical self - energy , i.e. , @xmath47 }      { \\delta \\mat \\sigma}\\right|_{\\mat \\sigma = \\mat \\sigma_{\\mat t , \\mat        u } }     =     0 \\ , .",
    "\\label{eq : statpointnesefcl}\\ ] ] in fact , using the well - known properties of the luttinger - ward functional and its legendre transform , it is easy to see that eq.([eq : statpointnesefcl ] ) is equivalent with dyson s equation  ( [ eq : dysoneqnshort ] ) .",
    "( [ eq : statpointnesefcl ] ) constitutes a general variational principle by which one could determine the self - energy ( as well as the grand potential ) of a system of correlated fermions .",
    "however , the explicit form of the functional @xmath48 $ ] is generally unknown .",
    "an important observation is that the luttinger - ward functional , and thus also @xmath48 $ ] is universal , i.e. , it depends ( besides the argument ) on the interaction parameters @xmath10 only , as made explicit by the subscript .",
    "hence , the functional form of @xmath48 $ ] remains unchanged for any reference system with the same interaction @xmath10 as the original system but with a different set of one - particle parameters @xmath49 , i.e. , for any reference system with a hamiltonian of the form @xmath50 .",
    "let us choose a reference system in a particular subspace of one - particle parameters @xmath51 , which has a sufficiently simple structure so that its one - particle green s function , its self - energy , and its grand potential of the initial thermal state at @xmath12 and @xmath13 can be computed exactly for any @xmath51 of the subspace .",
    "( here and in the following , primed quantities will refer to the reference system . )",
    "we can write down the self - energy functional of the reference system , @xmath52     =     \\frac{1}{\\beta }    \\tr\\ln \\left ( \\mat g_{\\mat \\lambda',0}^{-1 } - \\mat\\sigma    \\right)^{-1 }     +     \\fcl f_{\\mat u } [ \\mat \\sigma ] \\",
    ", , \\ ] ] and , due to the mentioned universality , eliminate @xmath53 $ ] by combining eqs .",
    "( [ eq : nesefcl ] ) and ( [ eq : nesefclref ] ) : @xmath54     =     \\fcl\\omega_{\\mat      \\lambda',\\mat u}[\\mat\\sigma ] + \\frac{1}{\\beta } \\tr\\ln    \\left ( \\mat g_{\\mat t,0}^{-1 } - \\mat\\sigma \\right)^{-1 }     -     \\frac{1}{\\beta } \\tr\\ln \\left ( \\mat g_{\\mat \\lambda',0}^{-1 } -      \\mat\\sigma \\right)^{-1 } \\,.\\ ] ] this expression for the self - energy functional , which is still exact , can be evaluated in practice for a certain subclass of trial self - energies , namely for the physical self - energies of the reference system .",
    "inserting @xmath55 , we have @xmath56     =    \\omega_{\\mat \\lambda',\\mat u } + \\frac{1}{\\beta } \\tr\\ln \\left ( \\mat      g_{\\mat t,0}^{-1 } - \\mat\\sigma_{\\mat \\lambda',\\mat u } \\right)^{-1 }    -     \\frac{1}{\\beta } \\tr\\ln \\left ( \\mat g_{\\mat \\lambda',\\mat u }    \\right ) \\,,\\ ] ] where we used @xmath57= \\omega_{\\mat \\lambda',\\mat u}$ ] and dyson s equation for the reference system , see eq .",
    "( [ eq : dysoneqnshort ] ) . using the stationarity principle eq .",
    "( [ eq : statpointnesefcl ] ) , we can optimize the self - energy over the restricted subspace of trial self - energies spanned by the subspace of variational parameters @xmath58 via @xmath59}{\\delta \\mat \\lambda'(z ) } \\right|_{\\mat\\lambda'(z ) =      \\mat\\lambda'_{\\rm opt}(z ) } = 0 \\ , .\\ ] ] this euler equation yields the optimal parameters @xmath60 , the optimal initial - state grand potential @xmath61 $ ] , the optimal self - energy @xmath62 , and the related one - particle green s function @xmath63    the type of approximation is specified by the choice of the reference system .",
    "typically , this is defined by cutting the lattice , which underlies the original model , into disconnected clusters consisting of a small number of sites @xmath64 each . for hubbard - type systems with local interactions",
    ", this generates simple reference systems with a small hilbert space , which can be solved , e.g. , by exact diagonalization techniques .",
    "the resulting approximation is called the variational - cluster approximation ( vca ) @xcite .",
    "a concrete example will be given in sec .",
    "[ sec : nevca ] . to enlarge the number of variational degrees of freedom locally ,",
    "a number @xmath65 of uncorrelated `` bath sites '' can be coupled via a hybridization term to each of the correlated ones .",
    "one may formally re - derive the ( nonequilibrium ) dynamical mean - field theory ( dmft ) @xcite by choosing a reference system of decoupled correlated sites ( @xmath66 ) hybridizing with a continuum of bath sites ( @xmath67 ) .",
    "the reference system is given as a set of decoupled single - impurity anderson models in this case .",
    "the vca , the dmft , and other approximations defined in this way are nonperturbative by construction and can be improved systematically by enlarging the space of variational parameters .",
    "self - energy functional theory in principle provides approximations which respect the macroscopic conservation laws resulting from the invariance of the original system under continuous u(1 ) and su(2 ) symmetry groups .",
    "this is similar to the perturbatively defined `` conserving '' approaches in the sense of baym and kadanoff @xcite which are obtained from the standard recipe by deriving the self - energy from a truncated luttinger - ward functional .",
    "the conserving nature of the nonperturbative approximations generated within the sft framework is ensured by a formal proof @xcite .",
    "this makes use of the fact that variations of the one - particle parameters of the reference system comprise gauge transformations of the form @xmath68 with @xmath69 where @xmath70 denotes the ( spatially ) diagonal part of @xmath49 and @xmath71 its off - diagonal part , and where @xmath72 is a spatially diagonal contour function .",
    "one shows that stationarity with respect to those gauge transformations implies that conservation laws , as expressed by continuity equations , are proliferated from the reference system , where they hold exactly , to the original system where they are expressed in terms of the approximate quantities .",
    "in fact , this is unproblematic in practice for the case of the total particle number and of the @xmath44-component of the total spin . as discussed in ref.@xcite , however , respecting total - energy conservation requires a continuum of variational degrees of freedom . in simple approximations , such as the vca ,",
    "one therefore has to tolerate a violation of total - energy conservation or use this as a measure for the quality of the approximation .",
    "to proceed to a practical computation , one first has to note that the trial self - energy depends on variational parameters @xmath73 which can be different on the two keldysh branches and we therefore distinguish @xmath74 and @xmath75 on @xmath76 and @xmath77 ( cf .",
    "[ fig : contour ] ) . in the end , we are only interested in physical solutions of the euler equation ( [ eq : eulereqn ] ) , namely solutions which satisfy @xmath78 and hence specify a _ physical _ hamiltonian . to make this more explicit , we perform a simple rotation in parameter space and define @xmath79 and @xmath80 .",
    "the physical parameter manifold is given by @xmath81 .",
    "now , it is easy to see that the self - energy functional is trivially always stationary with respect to physical variations when evaluated at a physical parameter set : @xmath82}{\\delta \\mat \\lambda_{\\rm phys}'(t ) }   \\right|_{\\mat\\lambda'_{\\rm trans}(t ) = 0 }    = 0 \\ : .",
    "\\label{eq : delphys}\\ ] ] hence , stationarity with respect to physical variations simply places the solution _ on _ the physical manifold . to fix the solution _ within",
    "_ the physical manifold a second condition is needed , namely stationarity with respect to the transverse variations : @xmath83}{\\delta \\mat \\lambda_{\\rm trans}'(t ) }   \\right|_{\\mat\\lambda'_{\\rm trans}(t ) = 0 }    = 0 \\ : .\\ ] ] this is in fact the central equation of the nonequilibrium sft .",
    "hence , variations necessarily go off the physical manifold and thus , opposed to the standard strategy in the equilibrium case ( see e.g.ref .",
    "@xcite ) , it is convenient to carry out the functional derivative analytically before solving the resulting equation numerically on the physical parameter manifold .    to compute the functional derivative in eq .",
    "( [ eq : eulereqn ] ) or ( [ eq : nontrivvar ] ) , we use the chain rule : @xmath84}{\\delta \\lambda'_{\\alpha_{1}\\alpha_{2}}(z ) } =     \\tr \\left ( \\frac{\\delta \\fcl\\omega_{\\mat t,\\mat u}[\\mat\\sigma_{\\mat\\lambda',\\mat u}]}{\\delta\\mat \\sigma_{\\mat          \\lambda',\\mat u } } \\circ \\frac{\\delta \\mat",
    "\\sigma_{\\mat          \\lambda',\\mat u}}{\\delta \\lambda'_{\\alpha_{1}\\alpha_{2}}(z ) } \\right ) \\,.\\ ] ] the first factor is given by @xmath85/\\delta \\mat \\sigma_{\\mat\\lambda',\\mat u } = \\left ( \\mat g_{\\mat t,0}^{-1 } -    \\mat\\sigma_{\\mat\\lambda',\\mat u } \\right)^{-1 } - \\mat g_{\\mat\\lambda',\\mat u}$ ] and can be rewritten in a more convenient way . with the inter - cluster hopping @xmath86 we immediately have @xmath87 , see eq .",
    "( [ eq : inversefreenegf ] ) .",
    "plugging this into the definition of the sft green s function , eq.([eq : gsft ] ) , and using dyson s equation for the reference system , we get @xmath88 this is actually the central equation of nonequilibrium cluster - perturbation theory @xcite . with the associated lippmann - schwinger equation @xmath89 , where @xmath90 is the corresponding @xmath91-matrix , we eventually obtain @xmath92}{\\delta\\mat \\sigma_{\\mat \\lambda',\\mat u } } = \\frac{1}{\\beta } \\mat g_{\\mat\\lambda',\\mat u } \\circ \\mat    y_{\\mat\\lambda',\\mat t,\\mat u } \\circ \\mat g_{\\mat\\lambda',\\mat u } \\:\\ ] ] for the first factor in eq .",
    "( [ eq : eulereqnchainrule ] ) . to evaluate the second factor , we write @xmath93 .",
    "apart from the @xmath51-dependence of the inverse free green s function , see eq .",
    "( [ eq : inversefreenegf ] ) , we have to consider the derivative of the inverse of the full green s function : from the identity @xmath94 we deduce @xmath95 . finally , making use of the properties of the time ordering operator and the exponential function , a straightforward calculation yields : @xmath96 where @xmath97 is the two - particle green s function of the reference system . collecting the results we find : @xmath98}{\\delta \\lambda'_{\\alpha_1\\alpha_2}(z_1 ) }",
    "=    \\dint d3d4 \\",
    ", y_{\\mat \\lambda',\\mat t,\\mat      u}(4,3 ) \\left .",
    "l_{\\mat\\lambda',\\mat u } ( 3,2,1^+,4 )    \\right|_{z_2=z_1 } = : k^{(0)}[\\mat\\lambda']_{\\alpha_2\\alpha_1}(z_1 ) \\,,\\ ] ] where @xmath99 is the two - particle ( four - point ) vertex function with external legs .",
    "therewith , we have the euler equation of the nonequilibrium sft : @xmath100(t)\\right|_{\\mat\\lambda'=\\mat\\lambda'_{\\rm opt } } = 0\\,,\\ ] ] which will be the starting point for the numerical determination of the optimal parameters .",
    "note that those parameters depend on the real time variable @xmath101 only rather than on the contour variable @xmath44 , because after the transverse variations have been carried out analytically we can restrict the search for optimal parameters to the physical manifold , see eq .",
    "( [ eq : nontrivvar ] ) .",
    "sites at @xmath102 and @xmath103 . as a reference system a two - site cluster is used .",
    "_ left _ : @xmath104 dependence of the jacobian of @xmath105}(t)$ ] ( red , left ordinate axis ) and of @xmath106}(t)$ ] ( blue , right ordinate axis ) .",
    "note , that the ordinate axes scales differ by two orders of magnitude .",
    "results are independent of the time @xmath101 .",
    "_ right _ : time dependence of the optimal parameters . vca results obtained as the roots of @xmath107}(t ) = 0 $ ] [ eq .",
    "( [ eq : dk0dt ] ) ] for different @xmath104 .",
    "the ordinate axis refers to the result for @xmath108 ; results for larger @xmath104 are constantly shifted by multiples of @xmath109.,title=\"fig : \" ]   sites at @xmath102 and @xmath103 . as a reference system",
    "a two - site cluster is used .",
    "_ left _ : @xmath104 dependence of the jacobian of @xmath105}(t)$ ] ( red , left ordinate axis ) and of @xmath106}(t)$ ] ( blue , right ordinate axis ) .",
    "note , that the ordinate axes scales differ by two orders of magnitude .",
    "results are independent of the time @xmath101 . _",
    "right _ : time dependence of the optimal parameters . vca results obtained as the roots of @xmath107}(t ) = 0 $ ] [ eq .",
    "( [ eq : dk0dt ] ) ] for different @xmath104 .",
    "the ordinate axis refers to the result for @xmath108 ; results for larger @xmath104 are constantly shifted by multiples of @xmath109.,title=\"fig : \" ]    with the _ time - dependent _ euler equation  ( [ eq : sfteuler ] ) we are facing a profound root - finding problem of formally infinite dimensions . however , the sft variational principle is inherently causal which allows us to determine the optimal parameters at a given time on a discrete time grid , without affecting the results at previous grid times , and then proceed to the next time .",
    "this causality is most easily seen when discussing eq .",
    "( [ eq : k0 ] ) : the integrals over @xmath110 and @xmath111 extend over the entire contour @xmath21 but can be confined to times which are ( physically ) earlier than @xmath112 ( cf .  fig .",
    "[ fig : contour ] ) . if one or both times are located beyond @xmath113 , the later time can be shifted from the upper to the lower branch ( or vice versa ) without altering the contour ordering , and the respective contributions to the integral cancel .",
    "thus , at time @xmath114 , all quantities in the euler equation  ( [ eq : sfteuler ] ) and therewith the parameter @xmath115 itself depend on parameters at earlier times only .",
    "unfortunately , a straightforward numerical solution of eq .",
    "( [ eq : sfteuler ] ) turns out to be impossible .",
    "the optimal parameters , determined by standard root - finding techniques , quickly accumulate a large error after a few time steps only such that a reasonable solution can not be found in this way .",
    "generally , for a functional depending parametrically on time , which is evaluated on a finite time grid and the parameters of which are varied only at the very last instant of time , we expect the explicit dependence of the variation of the functional on the time step @xmath104 to scale as @xmath116 with @xmath117 , since for an infinitesimally fine grid variations at a single instant of time would reduce to variations on a null set , and thus the variation of the functional must vanish .    in the present case , if one aims to solve eq .   at a given time @xmath101 , keeping the solution @xmath118 fixed at earlier times , the variation @xmath119(t)$ ] of the parameters at the last time - step will scale as @xmath120 , if the whole implementation is based on an equidistant time - grid @xmath104 .",
    "this is verified numerically in fig .",
    "[ fig : k_dtscaling ] ( left ) for a special case ( described in the figure caption ) .",
    "this scaling is independent of the quadrature rules used in solving the time integrals ( if the accuracy of those scales as @xmath120 or better ) .",
    "hence the observed @xmath120 scaling is in fact due to the jacobian @xmath121(t)$ ] itself and turned out to be detrimental for the stability of the algorithm for practically reasonable choices of @xmath104 .",
    "fortunately , this problem can be overcome by requiring the _ time derivative _ of @xmath122(t)$ ] [ see eq .",
    "( [ eq : k0 ] ) ] to vanish for all times @xmath123 and by fixing the initial conditions at @xmath124 by eq .",
    "( [ eq : sfteuler ] ) . hence ,",
    "instead of solving the euler equation ( [ eq : sfteuler ] ) for all times , we rather consider    [ eq : diffeulereqn ] @xmath125(t)\\right|_{\\mat\\lambda'=\\mat\\lambda'_{\\rm          opt } } & = 0 \\ , , \\qquad \\text{for } t=      t_0\\ , ,   \\label{eq : diffeulereqn_eq } \\\\",
    "\\left.\\partial_t \\mat        k^{(0)}[\\mat\\lambda'](t)\\right|_{\\mat\\lambda'=\\mat\\lambda'_{\\rm          opt } } & = 0 \\ , , \\qquad \\text{for } t >      t_0\\ , .",
    "\\label{eq : diffeulereqn_ne }    \\end{aligned}\\ ] ]    as can be seen in fig .",
    "[ fig : k_dtscaling ] ( left ) , the dependence on @xmath104 is only linear in this case .",
    "this greatly improves the accuracy of the parameter optimization and allows us to trace the optimal variational parameters as a function of time . as a simple numerical check",
    ", one may consider the _",
    "problem . the expected time _",
    "in_dependence of the optimal variational parameters is indeed found for sufficiently small @xmath104 , see fig .",
    "[ fig : k_dtscaling ] ( right ) .    according to eq .",
    "( [ eq : k0 ] ) , the time derivative @xmath126(t)$ ] can be obtained from the corresponding equations of motion for the four - point vertex function @xmath127 .",
    "there are two qualitatively different dependencies on @xmath101 : the first one results from the boundary terms due to the time - ordering operator comprised by all green s functions .",
    "contributions from this one cancel out when taking the time derivative .",
    "the second one is the explicit dependence of the annihilator and the creator on the external time @xmath113 .",
    "this is governed by the heisenberg equation of motion .",
    "commuting the operators with the one - particle part of the hamiltonian simply results in matrix products with @xmath51 while commuting with the interacting part gives rise to higher - order products of annihilators and creators which we denote by @xmath128 or @xmath129 , respectively : @xmath130 \\equiv \\psi(1)$ ] and @xmath131 \\equiv \\psi^\\dagger(1)$ ] .",
    "thus , the time derivative of @xmath122(t)$ ] acquires the form : @xmath132(t ) = \\com[\\mat k^{(0)}[\\mat\\lambda'](t),\\mat \\lambda'(t ) ] + \\mat    k^{(1)}[\\mat\\lambda'](t ) \\",
    ", , \\label{eq : dk0dt}\\ ] ] where we have used eq .",
    "( [ eq : k0 ] ) and where @xmath133_{\\alpha_2\\alpha_1}(z_1 ) =     \\dint d3d4\\left .",
    "y_{\\mat \\lambda',\\mat t,\\mat",
    "u}(4,3 )      m_{\\mat\\lambda',\\mat u } ( 3,2,1^+,4 ) \\right|_{z_2=z_1 } \\,,\\ ] ] with @xmath134 the subscript @xmath128 indicates that @xmath135 and @xmath136 are replaced by @xmath128 and @xmath137 in the respective correlation function .",
    "for example , @xmath138 .",
    "the algorithm for the numerical implementation of the vca in the general nonequilibrium case [ eq .",
    "( [ eq : diffeulereqn ] ) ] is sketched in fig .",
    "[ fig : propscheme ] .",
    "the following steps are performed at each time step :    * at a given time @xmath101 and for certain guessed parameters @xmath139 , we propagate @xmath140 and @xmath141 for all relevant orbitals @xmath142 by a time step @xmath104 and store their respective representations in the occupation - number basis . for small cluster sizes ,",
    "this is straightforward .",
    "therewith , arbitrary correlation functions can be calculated for arbitrary times on the contour up to the time @xmath101 . while the single particle green s function @xmath143 can be updated from time step to time step and kept in the storage , the higher correlation functions @xmath144 and @xmath145 have to be recalculated on - the - fly for _ any _ time step and after any update of @xmath139 , because of the external time @xmath101 .",
    "symmetries can be exploited to reduce the actual number of elements that have to be calculated . *",
    "the sft green s function @xmath146 is obtained from the cpt equation ( [ eq : cptequation ] ) , which can be cast in the form of a volterra equation of second kind : @xmath147 .",
    "the latter is solved up to time @xmath101 by standard techniques ( cf .",
    "@xcite ) . here",
    ", we exploit the translational symmetries of @xmath148 and of @xmath149 by fourier transformation with respect to the super - lattice . * the correlation functions @xmath144 , @xmath145 and @xmath150 ,",
    "are then used to calculate both @xmath151(t)$ ] and @xmath152(t)$ ] via eqs .",
    "( [ eq : k0 ] ) and ( [ eq : k1 ] ) . for the initial time @xmath124 ,",
    "only those integrations contribute where both times are on the matsubara branch . for any later time",
    ", the mixed and keldysh integrations have to be carried out , too .",
    "results for the integrals from earlier time steps can not be recycled , due to the external time @xmath101 appearing in the correlation functions @xmath144 and @xmath145 .",
    "for both , the integrations involved in the euler equation  ( [ eq : diffeulereqn ] ) as well as in the volterra equation , we use high - order integration schemes , like the newton - cotes rules or the gregory rules @xcite , to allow for large @xmath153 and large @xmath104 steps @xcite . * generally , the initial guess @xmath154 will not be a root of eqs .",
    "( [ eq : diffeulereqn ] ) , and must therefore be updated .",
    "the standard way of doing this , is to apply newton s method .",
    "this , however , requires the knowledge of the ( inverse of the ) functional s jacobian @xmath155(t_0)$ ] or @xmath156(t)$ ] respectively .",
    "both , the implementation of an analytical expression for the jacobian or a direct numerical evaluation via finite difference methods are rather costly options and thus not feasible .",
    "we thus employ broyden s method @xcite , which provides increasingly improved updates for the ( inverse of the ) jacobian during the course of the newton iteration , starting from an initial guess for both , the root as well as the jacobian itself .",
    "however , at the initial time we evaluate the jacobian numerically by finite differences at some guessed parameter .",
    "this improves the success and the speed of the method significantly . at later times",
    ", we extrapolate both the optimal parameter as well as the inverse jacobian of @xmath157(t)$ ] to again start the broyden iteration from an accurate initial guess - with this , we reliably find the roots of the respective functional after only one to three iterations per time step .    finally , we would like to add an important remark regarding the solution of eq .",
    "( [ eq : diffeulereqn_ne ] ) . as eq .",
    "( [ eq : dk0dt ] ) contains @xmath158 explicitly , a first naive approach would be to guess an `` optimal '' value @xmath139 , calculate @xmath159(t)$ ] and @xmath160(t)$ ] , plug these into eq .",
    "( [ eq : dk0dt ] ) , solve the resulting equation @xmath161(t),\\mat \\lambda'(t ) ] + \\mat k^{(1)}[\\mat\\lambda'_{\\rm g}](t)$ ] for a new @xmath158 , update both functionals and iterate this procedure until convergence . however , there are two complications .",
    "first , close to the optimal point , @xmath122(t)$ ] , and hence also @xmath162(t)$ ] must vanish and therefore solving eq .",
    "( [ eq : dk0dt ] ) for @xmath158 will get more and more unstable .",
    "second , for a guessed parameter it is unlikely that the corresponding functionals will be compatible with eq .",
    "( [ eq : dk0dt ] ) , i.e. , that a solution is existing at all . for this to be the case , e.g. , @xmath152(t)$ ] has to be trace - less , since it otherwise could not equal a commutator of two other matrices . indeed , in our numerics",
    "this requirement is not met in general .",
    "more generally , eqs .",
    "( [ eq : dk0dt ] ) and ( [ eq : diffeulereqn ] ) can be understood as a special case of sylvester s equation , namely @xmath163 , which has a unique solution for any matrix @xmath164 , if and only if the matrices @xmath165 and @xmath166 have distinct spectra ( see refs .",
    "in our case , this is clearly not the case , which is why we can not expect a unique solution ( or any solution at all ) , for some @xmath162(t)$ ] as obtained for an arbitrarily guessed optimal parameter .",
    "a way out would be to not solve eq .",
    "( [ eq : diffeulereqn ] ) directly , but minimize the norm of the left - hand side , which then , in any case , again suffers from the first complication .",
    "in the following , two concrete examples for the application of the nonequilibrium variational - cluster approach are presented to discuss some of its characteristics in detail .",
    "we consider the one - dimensional hubbard model at half - filling and at different interaction strengths and study quenches ( or fast ramps ) of the hopping parameters .",
    "both examples have been in the focus of recent experiments where the redistribution of antiferromagnetic correlations between different bonds and for different ramp times @xcite as well as the topological properties of bloch bands in optical lattices @xcite for the uncorrelated variant of the model @xcite were studied .",
    "figure  [ fig : vcainifin ] provides an illustration of the initial and of the final states as well as of the reference systems : in both cases , the system is initially in the thermal state of a dimerized hubbard model specified by some inverse temperature @xmath12 . in case",
    ", this state is generated by an initial hamiltonian which consists of decoupled two - site clusters .",
    "hence , the initial state is a simple valence - bond state with nearest - neighbor correlations and reduced translational symmetries . the intra - cluster hopping @xmath167 fixes energy and time units . in case ,",
    "the clusters with @xmath167 are weakly coupled by an inter - cluster hopping @xmath168 .    in case , the final - state dynamics after the quench",
    "is governed by the full hubbard hamiltonian where the initially disconnected clusters are linked by a final inter - cluster hopping @xmath169 .",
    "this is a highly nontrivial example where the system should build up longer - ranged nonlocal correlations and entanglement in the course of time . in case",
    "the final - state hamiltonian is basically the same as the hamiltonian specifying the initial state but with the important difference that the nearest - neighbor hopping @xmath170 now connects clusters that are shifted by one lattice constant .",
    "this example is also highly nontrivial as it corresponds to a sudden switch between hamiltonians describing states with well - developed but incompatible valence bonds where the entanglement and the spin correlations must reorganize between two different local situations .",
    "the vca , as a cluster mean - field approximation , can only partly cover the expected final - state dynamics .",
    "clearly , the quality of the approximation decisively depends on the size of the cluster used in the reference system .",
    "note that in both cases one in principle needs clusters of infinite size to recover the exact solution . here",
    ", however , our main intention is to discuss some numerical issues and to demonstrate that the vca can be implemented successfully and yields reasonable results ( which can in principle be improved systematically by going to larger cluster sizes ) .",
    "to this end , we have choosen a simple reference system , namely a system of disconnected clusters consisting of two sites each , indicated by the blue dashed lines in fig .",
    "[ fig : vcainifin ] .",
    "no additional bath degrees of freedom have been added .",
    "thus , the only possible variational parameters are the intra - cluster hopping @xmath171 and the on - site energies @xmath172 in the reference system .",
    "the latter are fixed by the symmetries of the model at half - filling and , therefore , only the intra - cluster hopping @xmath171 is left for optimization .",
    "we have tested the computer code in several trivial limits .",
    "furthermore , for the equilibrium case our data for different @xmath173 and @xmath12 and for a _ homogeneous _ lattice are fully consistent with those obtained previously for @xmath174 in ref.@xcite using a completely different algorithm .",
    "calculations for the systems sketched in fig .",
    "[ fig : vcainifin ] have been performed at inverse temperature @xmath175 which , on the level of the approximation employed , is already representative of the zero - temperature limit as has been checked by varying @xmath12 . using fifth - order integration schemes on the matsubara branch , converged results are obtained with @xmath176 . on the keldysh branch we are limited to the trapezoidal rule only since the implementation of higher - order schemes for the evaluation of the time - propagation operator gives rise to numerical instabilities ( see sec .  [ sec : numer - impl ] and comment  @xcite )",
    ". converged results are obtained for a time step of @xmath177 , and a maximum propagation time of @xmath178 is easily achieved with a desktop computer .",
    "to get converged results with respect to the spatial extension of the one - dimensional lattice , it is sufficient to consider systems with @xmath179 sites ( using periodic boundary conditions ) . rather than a sudden parameter quench we assume a finite ( but short ) ramp within a time interval @xmath180 , using a ramp profile @xmath181 with continuous first - order derivatives at the joints at @xmath182 and @xmath183 .",
    "this has been recognized to stabilize the algorithm significantly .",
    "it is also numerically advantageous to hold the original system in its initial equilibrium state for a few time steps , before starting with the ramp at @xmath184 to build up the desired integration order .",
    "results are shown in fig .",
    "[ fig : vca ] .",
    "we first discuss case . for @xmath182 ,",
    "the optimal value of the variational parameter is found as @xmath185 ( dotted line ) .",
    "in fact , this had to be expected since , for the given problem , the self - energy of the reference system equals the full self - energy [ cf .",
    "( [ eq : gsft ] ) ] and thus the vca is exact in the initial state .",
    "this represents another nontrivial check of our algorithm .    for @xmath186",
    "we find that @xmath187 becomes time - dependent , i.e. , the reference system adjusts itself to the parameter ramp in a time - dependent way to optimally describe the dynamics of the original system . in the limit of infinitely large clusters where vca formally becomes exact , one would expect @xmath188 to become constant after a certain relaxation time . as seen in the figure",
    ", this relaxation of the optimal variational parameter , and also of the double occupancy , takes place on a short time scale given by one or two inverse hoppings . with a reference cluster of two sites only ,",
    "however , some finite - size effects must be tolerated .",
    "these show up indeed as oscillations of @xmath188 around an average value after the relaxation process . for weak @xmath173 , where the physics is governed by the hopping part of the hamiltonian ,",
    "this average is by about 30% higher than the initial value @xmath189 . with increasing @xmath173 ,",
    "the final average value of @xmath188 is seen to decrease and approaches unity for @xmath190 .",
    "this is plausible since for weak @xmath173 the fermion system is more itinerant and thus an increased hopping parameter in the reference system is necessary to ( at least partially ) compensate for the missing inter - cluster hopping in the reference system while for strong @xmath173 this is less important as the physics is more local .",
    "similar arguments can be used to explain the time dependence of the double occupancy . for @xmath182",
    ", there is a strong @xmath173 dependence of @xmath191 , which is exactly reproduced by the vca . for @xmath186 ,",
    "the double occupancy quickly relaxes to a higher value ( apart from significant finite - size oscillations ) as the system becomes more itinerant due to the additional physical inter - cluster hopping .",
    "the effect is strongest for weak @xmath173 .    for case ,",
    "finite - size effects are generally somewhat stronger , see fig .",
    "[ fig : vca ] ( right ) .",
    "still the main trends are clear and plausible : as the inter - cluster hopping is weak , the initial values of @xmath187 and of @xmath192 are close to those of case . for @xmath186 ,",
    "the relaxation process takes place on essentially the same time scale of one or two inverse hoppings .",
    "however , one now expects that the optimal intra - cluster hopping adjusts to a value close to @xmath193 , i.e. , close to the physical hopping parameter ( see final state in fig .  [",
    "fig : vcainifin ] ) .",
    "this is in fact seen ( dotted line in fig .",
    "[ fig : vca ] , right ) .",
    "the decrease of the final average value of the double occupancy with increasing @xmath173 is understood in the same way as in case .",
    "note that the geometrical structure of the reference system is the same for the initial and the final state , see fig .",
    "[ fig : vcainifin ] . given this",
    ", we expect that the description of the initial state is better than that of the final state in the case of the dimerization change .",
    "we have also performed calculations using a reference system that is shifted by one lattice constant for both , the initial and the final state . in this case",
    ", one expects that the vca description of the final - state dynamics is more accurate than for the initial state .",
    "the calculations ( not shown ) yield unphysical results in this case with a diverging optimal intra - cluster hopping after one to two inverse hoppings , depending somewhat on @xmath173 .",
    "this demonstrates the crucial importance of an accurate description of the initial state for the subsequent real - time dynamics . a sudden switch of the geometrical structure of the reference system at @xmath182 , which follows the dimerization change of the original system , would be a legitimate choice and would result in a superior approximation",
    "this , however , requires a substantially higher numerical effort as more than a single two - site cluster must be considered as a building block in the calculation which is beyond the scope of the present work .    in both cases , and , there is a fairly good conservation of the total energy right after the ramp ( recall that @xmath194 ) with some remaining finite - size oscillations but no long - time drift .",
    "note that , _ a priori _ , this could not have been expected as a matter of course , since strict energy conservation within sft can only be ensured by variations _",
    "nonlocal _ in time , which would correspond to the optimization of infinitely many bath - degrees of freedom ( see ref .",
    "@xcite for a detailed discussion ) .    in case and for all interaction strengths , we find that the total energy decreases after the ramp ( see fig .  [ fig : vcaramp ] ) .",
    "this implies that the increase of the total energy due to the heating of the system during the ramp is overcompensated by the energy decrease that is induced by the coupling of the different isolated clusters via @xmath195 and the corresponding lowering of the kinetic energy . in case the total energy increases for all @xmath173 after the ramp ( see fig .",
    "[ fig : vcaflip ] ) . since the initial and the final hamiltonians are identical",
    "apart from a translation by one lattice constant , they have the same ground - state energies .",
    "the observed increase of the total energy must therefore be exclusively due to the heating of the system during the ramp .",
    "the self - energy functional theory ( sft ) provides a unifying framework for different types of cluster and impurity approximations and has recently been extended to nonequilibrium cases @xcite . in the present work ,",
    "we have discussed its numerical implementation in detail .",
    "an important observation is that a straightforward solution of the central sft euler equation is impossible in practice as it suffers from numerical instabilities which could traced back to an inherent quadratic dependence of the jacobian on the time step @xmath104 .",
    "fortunately , the euler equation can equivalently be replaced by its time derivative ( and the appropriate initial condition ) .",
    "the corresponding jacobian shows a numerically much more favorable linear - in-@xmath104 scaling . by using high - order integration schemes and",
    "broyden s method we have put forward and have implemented a stable propagation algorithm for the optimal parameters of the reference system .    as a concrete example",
    ", the variational cluster approach ( vca ) has been applied to study the dynamics initiated by two different ramps of the hopping parameters of an initially dimerized one - dimensional hubbard model .",
    "the time - evolution of the optimal parameters , the double occupancy and the total energy has been studied at different interaction strengths .",
    "these calculations have been performed with a two - site reference cluster and demonstrate that plausible and consistent results can be obtained in fact .",
    "note that , as compared to plain cpt , the strengths of the vca are expected to show up when considering situations involving ( dynamical ) phase transitions or in the possibility to construct approximations involving bath degrees of freedom .",
    "this , however , is beyond the scope of the present paper .    despite the simple two - site reference system used here ,",
    "the resulting real - time dynamics is in fact completely different from a mere superposition of oscillations with frequencies that are characteristic for the finite reference system .",
    "namely , the variational embedding of the cluster rather allows to describe the relaxation of the system to a new stationary final state . depending on the system , on the type of process studied and on the model parameters , however",
    ", the final state does show some unphysical oscillations which are caused by the small size of the reference system and which must be tolerated at the given approximation level .",
    "the sft framework allows to systematically improve the approximation by consideration of larger clusters , clusters with more variational parameters or by attaching uncorrelated bath sites .",
    "we expect that the remaining finite - size oscillations can be systematically controlled in this way .    in practice ,",
    "calculations for larger clusters are computationally expensive .",
    "since the exact intra - cluster 4-point correlation function @xmath196 is required , the practically accessible cluster size is _ eventually _ limited by the exponential growth of the cluster hilbert - space dimension .",
    "however , for small clusters the computational bottleneck of the algorithm actually consists in the necessity to repeatedly calculate the correlation functions @xmath122(t)$ ] ( and @xmath152(t)$ ] ) at each instant of time and for each newton step via a double contour integration and a double sum over the intra - cluster orbitals ( see eqs .",
    "( [ eq : k0 ] ) and ( [ eq : k1 ] ) ) . with the present implementation ,",
    "clusters with 6 or more sites are clearly beyond our capabilities .",
    "approximations generated within the sft framework do respect macroscopic conservation laws in general @xcite . regarding total - energy conservation , however , this would require the optimization of parameters which are nonlocal in time , i.e. , the allocation of infinitely many bath sites .",
    "since this has not been considered here , we also have to tolerate superimposed finite - size oscillations on the total energy .",
    "apart from those , however , conservation of the total energy is described fairly well , in particular , there is no long - time drift .",
    "however , to answer the question of whether or not the stationary final state is a thermal state that can be described by the temperature corresponding to the total energy after the parameter quench or ramp , in fact requires improved approximations and larger reference systems .",
    "we would like to thank k.  balzer for providing computer code for setting up the many - body basis and for cpt reference calculations as well as for helpful discussions .",
    "we would like to thank d.  gole , c.  gramsch , h.  strand for stimulating discussions .",
    "support of this work by the deutsche forschungsgemeinschaft within the sonderforschungsbereich 925 ( projects b5 and b4 ) is gratefully acknowledged .",
    "10 bloch i , dalibard j and zwerger w 2008 _ rev .",
    "phys . _ * 80 * 885                                                                      potthoff m 2014 making use of self - energy functionals : the variational cluster approximation _ dmft at 25 : infinite dimensions _ ( _ modeling and simulation _",
    "vol  4 ) ed eva  pavarini erik  koch d  v and lichtenstein a ( forschungszentrum jlich )            danielewicz p 1984 _ ann .",
    "phys . _ * 152 * 239 ; van leeuwen r , dahlen n  e , stefanucci g , almbladh c  o and von barth u 2006 introduction to the keldysh formalism _ time - dependent density functional theory _",
    "lecture notes in physics vol 706 ed marques m  a  l , ullrich c  a , nogueira f , rubio a , burke k and gross e  k  u ( berlin heidelberg : springer ) , p  33 ; rammer j 2007 _ quantum field theory of nonequilibrium states _",
    "( cambridge university press ) ; kamenev a 2011 _ field theory of non - equilibrium systems _",
    "( cambridge , new york : cambridge university press )                          for a real - time propagation also the time - evolution operator can be implemented in a high - order scheme , e.g. , by making use of techniques suggested by alvermann and fehske @xcite .",
    "this either makes it necessary to know the respective hamilton operator explicitly at _ unequally _ spaced times within the propagation time interval , as needed for gaussian quadrature , or to extrapolate beyond the time interval to past times for the application of `` extended '' open newton - cotes formulas @xcite .",
    "the first case is not feasible here , since our algorithm works on an equidistant time grid .",
    "the second , however , turned out to be highly unstable for any integration scheme of higher order than the trapzoidal rule .",
    "this might be due to runge s phenomenon @xcite .",
    "another explanation could be the following : changing the value of the considered parameter at the last time affects the shape of the fitted function for _ all _ nodes , and hence implicitly induces some acausal propagation which spoils a stable propagation ."
  ],
  "abstract_text": [
    "<S> the nonequilibrium variational - cluster approach is applied to study the real - time dynamics of the double occupancy in the one - dimensional fermi - hubbard model after different fast changes of hopping parameters . a simple reference system , consisting of isolated hubbard dimers , is used to discuss different aspects of the numerical implementation of the approach in the general framework of nonequilibrium self - energy functional theory . opposed to a direct solution of the euler equation , </S>",
    "<S> its time derivative is found to serve as numerically tractable and stable conditional equation to fix the time - dependent variational parameters . </S>"
  ]
}