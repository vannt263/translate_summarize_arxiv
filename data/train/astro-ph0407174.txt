{
  "article_text": [
    "improving our understanding of the formation of neutron stars as a result of the gravitational collapse of the core of massive stars is a difficult endeavour involving many aspects of extreme and not very well understood physics of the supernova explosion mechanism  @xcite .",
    "numerical simulations of core collapse supernova are driving progress in the field despite the limited knowledge on issues such as realistic precollapse stellar models ( including rotation ) or realistic equation of state , as well as numerical limitations due to boltzmann neutrino transport , multidimensional hydrodynamics , and relativistic gravity .",
    "axisymmetric and three - dimensional approaches based on newtonian gravity are available since a few decades now ( see e.g.  @xcite and references therein ) .",
    "these approaches , which are constantly improving over time , have provided valuable information on important issues such as the dynamics of the collapse of a stellar core to nuclear density , the formation of a proto - neutron star , and the propagation of the shock front which ultimately is believed to eject the outer layers of the stellar progenitor .",
    "currently , however , even the most realistic simulations of both nonrotating and rotating progenitor models do not succeed in producing explosions ( see  @xcite and references therein ) .",
    "in addition , the incorporation of full relativistic gravity in the simulations is likely to bring in well - known difficulties of numerical relativity , where the attempts are traditionally hampered by challenging mathematical , computational , and algorithmic issues as diverse as the formulation of the field equations , robustness , efficiency , and long - term stability ( particularly if curvature singularities are either initially present or develop during black hole formation ) . as high densities and velocities are involved in combination with strong gravitational fields , gravitational collapse and neutron star formation",
    "constitute a challenging problem for general relativistic hydrodynamic simulations .",
    "the pace of the progress is , no wonder , slow ; for instance , in the three - dimensional case , there is still no description of core collapse in full general relativity today , even for the simplest matter models one can conceive , where all microphysics is neglected .    in recent years",
    ", the interest in performing core collapse simulations has been further motivated by the necessity of obtaining reliable gravitational waveforms from ( rotating ) core collapse , one of the main targets of gravitational radiation for the present and planned interferometer detectors such as ligo , geo600 , and virgo ( see  @xcite for a review ) . as a result of the complexities listed above , it is not surprising that most previous studies aimed at computing the gravitational wave signature of core collapse supernovae have considered greatly simplified parameterized models  @xcite .",
    "in addition to the burst signal of gravitational waves emitted during core bounce , multidimensional simulations have also provided the signals produced by convection  @xcite ( see also  @xcite for the most realistic simulations available at present ) , as well as those from the resulting neutrino emission  @xcite .    from the above references it becomes apparent that our understanding of core collapse and neutron star formation has advanced mainly by studies carried out employing newtonian dynamics",
    "the situation is now slowly changing , at least for simplified matter models where microphysics and radiation transport are not yet included , with new formulations of the einstein field equations and of the general relativistic hydrodynamics equations .",
    "unfortunately , the @xmath0 einstein equations describing the dynamics of spacetime are a complicated set of coupled , highly nonlinear hyperbolic - elliptic equations with plenty of terms .",
    "their formulation in a form suitable for accurate and stable numerical calculations is not unique , and constitutes one of the major fields of current research in numerical relativity ( see  @xcite and references therein ) .",
    "not surprisingly , approximations of those equations have been suggested , such as the conformal flatness condition of isenberg  wilson  mathews  @xcite ( cfc hereafter ) , who proposed to approximate the 3-metric of the @xmath0 decomposition by a conformally flat metric .    using this approximation , dimmelmeier et al .",
    "@xcite presented the first relativistic simulations of the core collapse of rotating polytropes and neutron star formation in axisymmetry , providing an in - depth analysis of the dynamics of the process as well as of the gravitational wave emission .",
    "the results showed that relativistic effects may qualitatively change in some cases the dynamics of the collapse obtained in previous newtonian simulations  @xcite .",
    "in particular , core collapse with multiple bounces was found to be strongly suppressed when employing relativistic gravity . in most cases , compared to newtonian simulations , the gravitational wave signals are weaker and their spectra exhibit higher average frequencies , as the newly born proto - neutron stars have stronger compactness in the deeper relativistic gravitational potential .",
    "therefore , telling from simulations based on rotating polytropes , the prospects for detection of gravitational wave signals from supernovae are most likely not enhanced by taking into account relativistic gravity .",
    "the gravitational wave signals computed by dimmelmeier et al .",
    "@xcite are within the sensitivity range of the planned laser interferometer detectors if the source is located within our galaxy or in its local neighbourhood .",
    "a catalogue of the core collapse waveforms presented in  @xcite is available electronically  @xcite .",
    "this catalogue is currently being employed by gravitational wave data analysis groups to calibrate their search algorithms ( see e.g.  @xcite for results concerning the virgo group ) .",
    "more recently , shibata and sekiguchi  @xcite have presented simulations of axisymmetric core collapse of rotating polytropes to neutron stars in _ full _ general relativity .",
    "these authors used a conformal - traceless reformulation of the @xmath0 gravitational field equations commonly referred to in the literature by the acronym bssn after the works of  @xcite ( but note that many of the new features of the bssn formulation were anticipated as early as 1987 by nakamura , oohara , and kojima  @xcite ) .",
    "the results obtained for initial models similar to those of  @xcite agree to high precision in both the dynamics of the collapse and the gravitational waveforms .",
    "this conclusion , in turn , implies that , at least for core collapse simulations to neutron stars , cfc is a very precise approximation of general relativity .",
    "we note that in the relativistic core collapse simulations mentioned thus far  @xcite , the gravitational radiation is computed using the ( newtonian ) quadrupole formalism . to the best of our knowledge",
    "the only exception to this is the work of siebel et al .",
    "@xcite , where , owing to the use of the characteristic ( light - cone ) formulation of the einstein equations , the gravitational radiation from axisymmetric core collapse simulations was unambiguously extracted at future null infinity without any approximation .",
    "the most common approach to numerically solve the einstein equations is by means of finite differences ( see  @xcite and references therein ) .",
    "however , it is well known that spectral methods  @xcite are far more accurate than finite differences for smooth solutions ( e.g.  best for initial data without discontinuities ) , being particularly well suited to solve elliptic and parabolic equations . good results can be obtained for hyperbolic equations as well , as long as no discontinuities appear in the solution . the basic principle underlying spectral methods is the representation of a given function @xmath1 by its coefficients in a complete basis of orthonormal functions : sines and cosines ( fourier expansion ) or a family of orthogonal polynomials ( e.g.  chebyshev polynomials @xmath2 or legendre polynomials ) . in practice , of course , only a _",
    "finite _ set of coefficients is used and one approximates @xmath3 by the truncated series @xmath4 of such functions .",
    "the use of spectral methods results in a very high accuracy , since the error made by this truncation decreases like @xmath5 for smooth functions ( exponential convergence ) .    in an astrophysical context spectral methods have allowed to study subtle phenomena such as the development of physical instabilities leading to gravitational collapse  @xcite . in the last few years",
    ", spectral methods have been successfully employed by the _ meudon group _",
    "@xcite in a number of relativistic astrophysics scenarios  @xcite , among them the gravitational collapse of a neutron star to a black hole , the infall phase of a tri - axial stellar core in a core collapse supernova ( extracting the gravitational waves emitted in such process ) , the construction of equilibrium configurations of rapidly rotating neutron stars endowed with magnetic fields , or the tidal interaction of a star with a massive black hole .",
    "their most recent work concerns the computation of the inertial modes of rotating stars  @xcite , of quasi - equilibrium configurations of co - rotating binary black holes in general relativity  @xcite , as well as the evolution of pure gravitational wave spacetimes  @xcite . to carry out these numerical simulations",
    "the group has developed a fully object - oriented library called lorene  @xcite ( based on the c++ computer language ) to implement spectral methods in spherical coordinates .",
    "spectral methods are now employed in numerical relativity by other groups as well  @xcite .      on the other hand ,",
    "robust finite difference schemes to solve hyperbolic systems of conservation ( and balance ) laws , such as the euler equations of fluid dynamics , are known for a long time and have been employed successfully in computational fluid dynamics ( see e.g.  @xcite and references therein ) . in particular ,",
    "the so - called upwind high - resolution shock - capturing schemes ( hrsc schemes hereafter ) have shown their advantages over other type of methods even when dealing with relativistic flows with highly ultrarelativistic fluid speeds ( see e.g.  @xcite and references therein ) .",
    "hrsc schemes are based on the mathematical information contained in the characteristic speeds and fields ( eigenvalues and eigenvectors ) of the jacobian matrices of the system of partial differential equations .",
    "this information is used in a fundamental way to build up either exact or approximate riemann solvers to propagate forward in time the collection of local riemann problems contained in the initial data , once these data are discretized on a numerical grid .",
    "these schemes have a number of interesting properties : ( 1 ) the convergence to the physical solution ( i.e.  the unique weak solution satisfying the so - called entropy condition ) is guaranteed by simply writing the scheme in conservation form , ( 2 ) the discontinuities in the solution are sharply and stably resolved , and ( 3 ) these methods attain a high order of accuracy in smooth parts of the solution .      from the above considerations",
    ", it seems a promising strategy , in the case of relativistic problems where coupled systems of elliptic ( for the spacetime ) and hyperbolic ( for the hydrodynamics ) equations must be solved , to use spectral methods for the former and hrsc schemes for the latter ( where discontinuous solutions may arise ) . showing the feasibility of such an approach is , in fact , the main motivation and aim of this paper .",
    "therefore , we present and assess here the capabilities of a new , fully three - dimensional code whose distinctive features are that it combines both types of numerical schemes and implements the field equations and the hydrodynamic equations using spherical coordinates .",
    "it should be emphasized that our _ mariage des maillages _ approach is hence best suited for formulations of the einstein equations which favor the appearance of elliptic equations against hyperbolic equations , i.e.  either approximations such as cfc  @xcite ( the formulation we adopt in the simulations reported in this paper ) , higher - order post - newtonian extensions  @xcite , or _",
    "exact _ formulations as recently proposed by  @xcite .",
    "the hybrid approach put forward here has a successful precedent in the literature ; using such combined methods , first results were obtained in one - dimensional core collapse in the framework of a tensor - scalar theory of gravitation  @xcite .",
    "we note that one of the main limitations of the previous axisymmetric core collapse simulations presented in  @xcite was the cpu time spent when solving the elliptic equations describing the gravitational field in cfc .",
    "the restriction was severe enough to prevent the practical extension of the investigation to the three - dimensional case . in that sense ,",
    "spectral methods are again particularly appropriate as they provide accurate results with reasonable sampling , as compared with finite difference methods .",
    "the three - dimensional code we present in this paper has been designed with the aim of studying general relativistic astrophysical scenarios such as rotational core collapse to neutron stars ( and , eventually , to black holes ) , as well as pulsations and instabilities of the formed compact objects .",
    "core collapse may involve , obviously , matter fields which are not rotationally symmetric . while during the infall phase of the collapse the deviations from axisymmetry should be rather small , for rapidly rotating neutron stars which form as a result of the collapse , or which may be spun up by accretion at later times , rotational ( nonaxisymmetric ) bar mode instabilities may develop , particularly in relativistic gravity and for differential rotation . in this regard , in the previous axisymmetric simulations of dimmelmeier et al .",
    "@xcite , some of the most extremely rotating initial models yielded compact remnants which are above the thresholds for the development of such bar mode instabilities on secular or even dynamic time scales for maclaurin spheroids in newtonian gravity ( which are @xmath6 and @xmath7 , respectively , with @xmath8 being the ratio of rotational energy and gravitational binding energy ) .",
    "presently , only a few groups worldwide have developed finite difference , three - dimensional ( cartesian ) codes capable of performing the kind of simulations we aim at , where the joint integration of the einstein and hydrodynamics equations is required  @xcite .",
    "further 3d codes are currently being developed by a group in the u.s .",
    "@xcite and by a e.u .",
    "research training network collaboration  @xcite .",
    "the paper is organized as follows : in section  [ section : model_and_equations ] we introduce the assumptions of the adopted physical model and the equations governing the dynamics of a general relativistic fluid and the gravitational field .",
    "section  [ section : numerical_methods ] is devoted to describing algorithmic and numerical features of the code , such as the setup of both the spectral and the finite difference grids , as well as the basic ideas behind the hrsc schemes we have implemented to solve the hydrodynamics equations .",
    "in addition , a detailed comparison of the three different solvers for the metric equations and their practical applicability is given . in section  [ section : tests ] we present a variety of tests of the numerical code , comparing the metric solver based on spectral methods to two other alternative methods using finite differences .",
    "we conclude the paper with a summary and an outlook to future applications of the code in section  [ section : summary ] .",
    "we use a spacelike signature @xmath9 and units in which @xmath10 ( unless explicitly stated otherwise ) .",
    "greek indices run from 0 to 3 , latin indices from 1 to 3 , and we adopt the standard convention for the summation over repeated indices .",
    "let @xmath11 denote the rest - mass density of the fluid , @xmath12 its four - velocity , and @xmath13 its pressure .",
    "the hydrodynamic evolution of a relativistic perfect fluid with rest - mass current @xmath14 and energy - momentum tensor @xmath15 in a ( dynamic ) spacetime @xmath16 is determined by a system of local conservation equations , which read @xmath17 where @xmath18 denotes the covariant derivative .",
    "the quantity @xmath19 appearing in the energy - momentum tensor is the specific enthalpy , defined as @xmath20 , where @xmath21 is the specific internal energy .",
    "the three - velocity of the fluid , as measured by an eulerian observer at rest in a spacelike hypersurface @xmath22 is given by @xmath23 where @xmath24 is the lapse function and @xmath25 is the shift vector ( see section  [ subsection : metric_equations ] ) .",
    "following the work laid out in  @xcite we now introduce the following set of conserved variables in terms of the primitive ( physical ) hydrodynamic variables @xmath26 : @xmath27      s_i   & \\equiv   & \\rho h w^2 v_i , \\\\ [ 0.5 em ]      \\tau & \\equiv & \\rho h w^2 - p - d.    \\end{array}\\ ] ] in the above expressions @xmath28 is the lorentz factor defined as @xmath29 , which satisfies the relation @xmath30 and @xmath31 , where @xmath32 is the 3-metric .    using the above variables , the local conservation laws  ( [ eq : gr_equations_of_motion ] ) can be written as a first - order , flux - conservative hyperbolic system of equations , @xmath33 = { \\mbox{\\boldmath $ q$ } } ,    \\label{eq : hydro_conservation_equation}\\ ] ] with the state vector , flux vector , and source vector given by @xmath34 , \\\\ [ 1.0 em ]    { \\mbox{\\boldmath $ f$}}^i & = & \\displaystyle    \\left [ d \\hat{v}^i , s_j \\hat{v}^i + \\delta^i_j p ,    \\tau \\hat{v}^i + p v^i \\right ] , \\\\ [ 1.0 em ]    { \\mbox{\\boldmath $ q$ } } & = & \\displaystyle    \\left [ 0 , t^{\\mu \\nu } \\left (    \\frac{\\partial g_{\\nu j}}{\\partial x^\\mu } -     { \\it \\gamma}^\\lambda_{\\mu \\nu } g_{\\lambda j } \\right ) ,    \\right . \\\\",
    "[ 1.0 em ]    & & \\displaystyle \\quad \\left .",
    "\\alpha \\left ( t^{\\mu 0 }    \\frac{\\partial \\ln \\alpha}{\\partial x^\\mu } -    t^{\\mu \\nu } { \\it \\gamma}^0_{\\mu \\nu } \\right ) \\right ]   .",
    "\\end{array }    \\label{eq : hydro_conservation_equation_constituents}\\ ] ] here @xmath35 , and @xmath36 , with @xmath37 and @xmath38 being the determinant of the 4-metric and 3-metric , respectively ( see section  [ subsection : adm_metric_equations ] ) .",
    "in addition , @xmath39 are the christoffel symbols associated with @xmath40 .",
    "the system of hydrodynamic equations  ( [ eq : hydro_conservation_equation ] ) is closed by an equation of state ( eos ) which relates the pressure to some thermodynamically independent quantities , e.g.@xmath41 . as in  @xcite we have implemented in the code a hybrid ideal gas eos  @xcite , which consists of a polytropic pressure contribution and a thermal pressure contribution , @xmath42 .",
    "this eos , which despite its simplicity is particularly suitable for stellar core collapse simulations , is intended to model the degeneracy pressure of the electrons and ( at supranuclear densities ) the pressure due to nuclear forces in the polytropic part , and the heating of the matter by shock waves in the thermal part .",
    "the hybrid eos is constructed as follows .    for a rotating stellar core before collapse the polytropic relation between the pressure and the rest mass density , @xmath43 with @xmath44 and @xmath45 ( in cgs units ) is a fair approximation of the density and pressure stratification  @xcite .    in order to start the gravitational collapse of a configuration initially in equilibrium ,",
    "the effective adiabatic index @xmath46 is reduced from @xmath47 to @xmath48 on the initial time slice . during the infall phase of core collapse",
    "the matter is assumed to obey a polytropic eos  ( [ eq : polytropic_relation ] ) , which is consistent with the ideal gas eos for a compressible inviscid fluid , @xmath49 .    to approximate the stiffening of the eos for densities larger than nuclear matter density @xmath50",
    ", we assume that the adiabatic index @xmath46 jumps from @xmath48 to @xmath51 at @xmath52 . at core",
    "bounce a shock forms and propagates out , and the matter accreted through the shock is heated , i.e.  its kinetic energy is dissipated into internal energy .",
    "this is reflected by a nonzero @xmath53 , where @xmath54 with @xmath55 $ ] , in the post - shock region .",
    "we choose @xmath56 .",
    "this choice describes a mixture of relativistic ( @xmath57 ) and nonrelativistic ( @xmath58 ) components of an ideal fluid .    requiring that @xmath13 and @xmath59 are continuous at the transition density @xmath50",
    ", one can construct an eos for which both the total pressure @xmath13 and the individual contributions @xmath60 and @xmath61 are continuous at @xmath50 , and which holds during all stages of the collapse :    p & = & k _ nuc^_1 - ^ - k _ nuc^_1 - 1 + & & + ( _ th - 1 ) .",
    "[ eq : hybrid_eos ]    for more details about this eos , we refer to  @xcite .",
    "our implementation of the hybrid eos allows us to suppress the contribution of the thermal pressure @xmath61 . in this case",
    "the eos  ( [ eq : hybrid_eos ] ) analytically reduces to the polytropic relation  ( [ eq : polytropic_relation ] ) .",
    "we use this eos , with different values for @xmath46 and @xmath62 , in the simulations of polytropic neutron star models presented below .",
    "we adopt the adm @xmath0 formalism  @xcite to foliate the spacetime into a set of non - intersecting spacelike hypersurfaces .",
    "the line element reads @xmath63 where @xmath24 is the lapse function which describes the rate of advance of time along a timelike unit vector @xmath64 normal to a hypersurface , @xmath25 is the spacelike shift three - vector which describes the motion of coordinates within a surface , and @xmath32 is the spatial three - metric .    in the @xmath0 formalism ,",
    "the einstein equations are split into evolution equations for the three - metric @xmath32 and the extrinsic curvature @xmath65 , and constraint equations ( the hamiltonian and momentum constraints ) which must be fulfilled at every spacelike hypersurface : @xmath66      \\partial_t k_{ij } & = & - \\nabla_i \\nabla_j \\alpha +      \\alpha ( r_{ij } + k k_{ij } - 2 k_{ik } k_j^k ) \\\\ [ 0.5 em ]      & & + \\beta^k \\nabla_k k_{ij } + k_{ik } \\nabla_j \\beta^k + k_{jk }      \\nabla_i \\beta^k \\\\ [ 0.5 em ]      & & - \\displaystyle      8 \\pi \\alpha \\ !",
    "\\left ( \\ !",
    "s_{ij } - \\frac{\\gamma_{ij}}{2 }      ( s_k^k - \\rho_{\\rm h } ) \\right ) , \\\\ [ 0.8 em ]      0 & = & r + k^2 - k_{ij } k^{ij } - 16 \\pi \\rho_{\\rm h } , \\\\ [ 0.8 em ]      0 & = & \\nabla_i ( k^{ij } - \\gamma^{ij } k ) - 8 \\pi s^j .",
    "\\end{array }    \\label{eq : adm_metric_equations}\\ ] ] in these equations @xmath67 is the covariant derivative with respect to the three - metric @xmath32 , @xmath68 is the corresponding ricci tensor , @xmath69 is the scalar curvature , and @xmath62 is the trace of the extrinsic curvature @xmath65 .",
    "the matter fields appearing in the above equations , @xmath70 , @xmath71 , and @xmath72 , are the spatial components of the stress - energy tensor , the three momenta , and the total energy , respectively .",
    "the adm equations have been repeatedly shown over the years to be intrinsically numerically unstable .",
    "recently , there have been numerous attempts to reformulate above equations into forms better suited for numerical investigations ( see  @xcite and references therein ) .",
    "these approaches to delay or entirely suppress the excitation of constraint violating unstable modes include the bssn reformulation of the adm system  @xcite ( see section  [ subsection : einstein_equations ] ) , hyperbolic reformulations ( see  @xcite and references therein ) , or a new form with maximally constrained evolution  @xcite . in our opinion",
    "a consensus seems to be emerging currently in numerical relativity , which in general establishes that the more constraints are used in the formulation of the equations the more numerically stable the evolution is .",
    "based on the ideas of isenberg  @xcite and wilson et al .",
    "@xcite , and as it was done in the work of dimmelmeier et al .",
    "@xcite , we approximate the general metric @xmath73 by replacing the spatial three - metric @xmath32 with the conformally flat three - metric , @xmath74 , where @xmath75 is the flat metric ( @xmath76 in cartesian coordinates ) . in general , the conformal factor @xmath77 depends on the time and space coordinates .",
    "therefore , at all times during a numerical simulation we assume that all off - diagonal components of the three - metric are zero , and the diagonal elements have the common factor @xmath78 .    in cfc the following relation between the time derivative of the conformal factor and",
    "the shift vector holds : @xmath79 with this the expression for the extrinsic curvature becomes time - independent and reads @xmath80 if we employ the maximal slicing condition , @xmath81 , then in the cfc approximation the adm equations  ( [ eq : adm_metric_equations ] ) reduce to a set of five coupled elliptic ( poisson - like ) nonlinear equations for the metric components , @xmath82      \\hat{\\delta } ( \\alpha \\phi ) & = & \\displaystyle 2 \\pi \\alpha \\phi^5      \\ ! \\left ( \\ ! \\rho h ( 3 w^2 - 2 ) \\ ! + \\ !",
    "5 p \\ ! + \\ !",
    "\\frac{7 k_{ij }      k^{ij}}{16 \\pi } \\ !",
    "\\right ) , \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! \\\\ [ 1.0 em ]      \\hat{\\delta } \\beta^i & = & \\displaystyle 16 \\pi \\alpha \\phi^4 s^i +      2 \\phi^{10 } k^{ij } \\hat{\\nabla}_j      \\left ( \\frac{\\alpha}{\\phi^6 } \\right ) -      \\frac{1}{3 } \\hat{\\nabla}^i \\hat{\\nabla}_k \\beta^k ,      \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\ !",
    "\\end{array }    \\label{eq : metric_equations}\\ ] ] where @xmath83 and @xmath84 are the flat space nabla and laplace operators , respectively .",
    "we note that the way of writing the metric equations with a laplace operator on the left hand side can be exploited by numerical methods specifically designed to solve such kind of equations ( see sections  [ subsubsection : conventional_poisson_solver ] and  [ subsubsection : spectral_metric_solver ] below ) .",
    "these elliptic metric equations couple to each other via their right hand sides , and in case of the three equations for the components of @xmath25 also via the operator @xmath84 acting on the vector @xmath25 .",
    "they do not contain explicit time derivatives , and thus the metric is calculated by a fully constrained approach , at the cost of neglecting some evolutionary degrees of freedom in the spacetime metric .",
    "in the astrophysical situations we plan to explore ( e.g.evolution of neutron stars or core collapse of massive stars ) , the equations are entirely dominated by the source terms involving the hydrodynamic quantities @xmath11 , @xmath13 , and @xmath85 , whereas the nonlinear coupling through the remaining , purely metric , source terms becomes only important for strong gravity . on each time slice",
    "the metric is hence solely determined by the instantaneous hydrodynamic state , i.e.  the distribution of matter in space .    recently ,",
    "cerd - durn et al .",
    "@xcite have extended the above cfc system of equations ( and the corresponding core collapse simulations in cfc reported in  @xcite ) by the incorporation of additional degrees of freedom in the approximation , which render the spacetime metric exact up to the second post - newtonian order . despite the extension of the five original elliptic cfc metric equations for the lapse , the shift vector , and the conformal factor by additional equations ,",
    "the final system of equations in the new formulation is still elliptic .",
    "hence , the same code and numerical schemes employed in  @xcite and in the present work can be used .",
    "the results obtained by cerd - durn et al .",
    "@xcite for a representative subset of the core collapse models in  @xcite show only minute differences with respect to the cfc results , regarding both the collapse dynamics and the gravitational waveforms .",
    "we point out that shibata and sekiguchi  @xcite have recently considered axisymmetric core collapse of rotating polytropes to neutron stars in full general relativity ( i.e.  no approximations ) using the @xmath0 bssn formulation of the einstein equations .",
    "interestingly , the results obtained for initial models similar to those of  @xcite agree to high precision in the dynamics of the collapse and on the gravitational waveforms , which supports the suitability and accuracy of the cfc approximation for simulations of relativistic core collapse to neutron stars ( see also section  [ subsubsection : comparison_with_full_gr ] ) .",
    "in addition , there has been a direct comparison between the cfc approximation and perturbative analytical approaches ( post - newtonian and effective - one - body ) , which shows a very good agreement in the determination of the innermost stable circular orbit of a system of two black holes  @xcite .      in general ,",
    "the right hand sides of the metric equations  ( [ eq : metric_equations ] ) contain nonlinear source terms of noncompact support . for a system with an isolated matter distribution bounded by some stellar radius @xmath86",
    ", the source term of each of the metric equations for a metric quantity @xmath87 can be split into a `` hydrodynamic '' term with compact support @xmath88 and a purely `` metric '' term with noncompact support @xmath89 .",
    "where no matter is present , only the metric term remains : @xmath90 the source term @xmath89 vanishes only for @xmath91 and thus @xmath92 , i.e.  if the three - velocity vanishes and the matter is static . as a consequence of this , only a spherically symmetric static matter distribution will yield a time - independent solution to eq .",
    "( [ eq : metric_equations_rhs_split ] ) , which is equivalent to the spherically symmetric tolman  oppenheimer  volkoff ( tov ) solution of hydrostatic equilibrium . in this case",
    "the vacuum metric is given by the solution of a homogeneous poisson equation , @xmath93 , the constants @xmath94 and @xmath95 being determined by boundary values e.g.  at @xmath86 .",
    "a time - dependent spherically symmetric matter interior suffices to yield a nonstatic vacuum metric ( @xmath96 everywhere ) .",
    "however , this is not a contradiction to birkhoff s theorem , as it is purely a gauge effect .",
    "a transformation of the vacuum part of the metric from an isotropic to a schwarzschild - like radial coordinate leads to the static ( and not conformally flat ) standard schwarzschild vacuum spacetime .",
    "thus , in general , the vacuum metric solution to eqs .",
    "( [ eq : metric_equations ] ) can not be obtained analytically , and therefore ( except for tov stars ) no exact boundary values can be imposed for @xmath77 , @xmath24 , and @xmath25 at some finite radius @xmath97 .",
    "we note that this property of the metric equations is no consequence of the _ approximative _ character of conformal flatness , as in spherical symmetry the cfc renders the exact adm equations  ( [ eq : adm_metric_equations ] ) , but rather results from the choice of the ( isotropic ) radial coordinate .",
    "the expressions for the hydrodynamic and metric quantities outlined in section  [ section : model_and_equations ] are in covariant form . for a numerical implementation of these equations , however , we have to choose a suitable coordinate system adapted to the geometry of the astrophysical situations intended to be simulated with the code .    as we plan to investigate isolated systems with matter configurations not too strongly departing from spherical symmetry with a spacetime obeying asymptotic flatness , the formulation of the hydrodynamic and metric equations , eqs .",
    "( [ eq : hydro_conservation_equation ] ) and ( [ eq : metric_equations ] ) , and their numerical implementation are based on spherical polar coordinates @xmath98 .",
    "this coordinate choice facilitates the use of fixed grid refinement in form of nonequidistant radial grid spacing .",
    "additionally , in spherical coordinates the boundary conditions for the system of partial differential metric equations  ( [ eq : metric_equations ] ) are simpler to impose ( at finite or infinite distance ) on a spherical surface than on a cubic surface if cartesian coordinates were used .",
    "we have found no evidence of numerical instabilities arising at the coordinate singularities at the origin ( @xmath99 ) or at the axis ( @xmath100 ) in all simulations performed thus far with the code ( see  @xcite for related discussions on instabilities in codes based upon spherical coordinates ) .",
    "both the discretized hydrodynamic and metric quantities are located on the eulerian _ finite difference grid _ at cell centers @xmath101 , where @xmath102 run from 1 to @xmath103 , respectively .",
    "the angular grid zones in the @xmath104- and @xmath105-direction are each equally spaced , while the radial grid , which extends out to a finite radius @xmath106 larger than the stellar radius @xmath86 , can be chosen to be equally or logarithmically spaced .",
    "each cell is bounded by two interfaces in each coordinate direction .",
    "values on ghost zone cell centers , needed to impose boundary conditions , are obtained with the symmetry conditions described in  @xcite .",
    "we further assume equatorial plane symmetry in all simulations presented below ( the code , however , is not restricted to this symmetry condition ) .",
    "expressions containing finite differences in space on this grid are calculated with second order accuracy .",
    "note that the space between the surface of the star , the radius of which in general is angular dependent , and the outer boundary of the finite difference grid is filled with an artificial atmosphere ( as done in codes similar to ours , see  @xcite ) .",
    "this atmosphere obeys the polytropic eos  ( [ eq : polytropic_relation ] ) , and has a very low density such that its presence does not affect the dynamics of the star  @xcite . as an example , we observe a slight violation of conservation of rest mass and angular momentum in simulations of axisymmetric rotational core collapse of the order of @xmath107 .",
    "this small violation can be entirely attributed to the interaction of the stellar matter with the artificial atmosphere ( see appendix  [ subsection : exact_conservation ] ) .        our most general metric solver is based on spectral methods ( see section  [ subsubsection : spectral_metric_solver ] ) .",
    "the basic principle of these methods has been given in section  [ subsection : einstein_equations ] .",
    "let us now describe some details of our implementation in the case of 3d functions in spherical coordinates .",
    "the interested reader can refer to  @xcite for details .",
    "a function @xmath3 can be decomposed as follows ( @xmath108 is linked with the radial coordinate @xmath97 , as given below ) : @xmath109 where @xmath110 are spherical harmonics .",
    "the angular part of the function can also be decomposed into a fourier series , to compute angular derivatives more easily . if @xmath3 is represented by its coefficients @xmath111 , it is easy to obtain the coefficients of e.g.  @xmath112 , @xmath113 ( or the result of any linear differential operator applied to @xmath3 ) thanks to the properties of chebyshev polynomials or spherical harmonics .",
    "for instance , to compute the coefficients of the radial derivative of @xmath114 , we make use of the following recursion formula on chebyshev polynomials : @xmath115 a grid is still needed for two reasons : firstly , to calculate these coefficients through the computation of integrals , and secondly to evaluate non - linear operators ( e.g.  @xmath116 ) , using the values of the functions at grid points ( in physical space ) .",
    "the spectral grid points , called collocation points are situated at @xmath117 , where @xmath102 run from 1 to @xmath118 , respectively .",
    "they are the nodes of a gauss ",
    "lobato quadrature used to compute the integrals giving the spectral coefficients .",
    "the use of fast fourier transforms ( fft ) for the angular part requires equally spaced points in the angular directions , whereas a fast chebyshev transform ( also making use of fft ) requires that the radial grid points correspond , in @xmath108 , to the zeros of @xmath119 .",
    "note that in our simulations each of the domains contains the same number of radial and angular collocation points .",
    "in order to be able to cover the entire space ( @xmath120 $ ] ) and to handle coordinate singularities at the origin ( @xmath99 ) , we use several grid _ domains _ :    * a nucleus spanning from @xmath99 to @xmath121 , where we set @xmath122 , with @xmath123 $ ] and @xmath24 being a constant ( we use either only even chebyshev polynomials @xmath124 , or only odd polynomials @xmath125 ) ; * an arbitrary number ( including zero ) of shells bounded by the inner radius @xmath126 and outer radius @xmath127 , where we set @xmath128 with @xmath129 $ ] and @xmath130 and @xmath131 being constants depending on the shell number @xmath132 ; * a compactified external domain extending from the outer boundary of the finite difference grid at @xmath106 to radial infinity , where we set @xmath133 $ ] , with @xmath129 $ ] and @xmath134 being a constant .    furthermore , we assume that the ratio @xmath135 between the outer boundary radii of two consecutive domains is constant , which yields the relation @xmath136 where @xmath137 is the number of domains ( including the nucleus and the external compactified domain ) .",
    "thus a particular choice of @xmath137 and fixing the radius of the nucleus @xmath121 completely specifies the setup of the spectral grid : @xmath138      & \\vdots & \\\\ [ -0.2 em ]      r_{{\\rm d\\,}i } & = & f_{\\rm d } \\times r_{{\\rm d\\,}i - 1 } , \\\\ [ -0.4 em ]      & \\vdots & \\\\ [ -0.2 em ]      r_{{\\rm d\\,}n_{\\rm d } - 1 } & = & r_{\\rm fd } , \\\\",
    "r_{{\\rm d\\,}n_{\\rm d } } & = & \\infty .",
    "\\end{array }    \\label{eq : domain_radius_calculation}\\ ] ]    the setup of the spectral grid and the associated finite difference grid for a typical stellar core collapse model is exemplified in fig .",
    "[ fig : grid_setup ] for @xmath139 grid points per spectral radial domain and @xmath140 finite difference grid points . particularly in the central parts of the star ( upper panel )",
    "the logarithmic radial spacing of the finite difference grid is obvious .",
    "while the finite difference grid ends at the finite radius @xmath141 ( with the exception of four ghost zones , which are needed for the hydrodynamic reconstruction scheme ; see section  [ subsection : hrsc ] ) , the radially compactified outermost 6th domain of the spectral grid covers the entire space to radial infinity ( lower panel ) .",
    "the finite difference grid is fixed in time , while the boundaries @xmath142 of the spectral radial domains ( and thus the radial collocation points ) change adaptively during the evolution ( for details , we refer to section  [ subsubsection : axisymmetric_core_collapse ] ) .",
    "note that the radial collocation points of the spectral grid , which correspond to the roots of the chebyshev polynomials ( for the gauss ",
    "lobato quadrature ) , are concentrated towards the domain boundaries .",
    "= 8.6 cm    generally speaking , in order to achieve a comparable accuracy in the representation of functions and their derivatives , the finite difference grid needs much more points than the spectral one .",
    "for example , when considering the representation of some function like @xmath143 on the interval @xmath144 $ ] , spectral methods using chebyshev polynomials need @xmath145 coefficients ( and grid points ) to reach machine double precision ( @xmath146 ) for the representation of the function and @xmath147 for the representation of its first derivative . for comparison ,",
    "a third order scheme based on finite differences needs @xmath148 points to achieve the same accuracy .",
    "passing information from the spectral grid to the finite difference grid is technically very easy . knowing the spectral coefficients of a function",
    ", this step simply requires the evaluation of the sum ( [ eq : spec_decomp ] ) at the finite difference grid points .",
    "the drawback of this method , as it will be discussed in section  [ subsection : interpolation_tests ] , is the computational time spent . in 3d this time can even be larger than the time spent by the spectral elliptic solver .",
    "going from the finite difference grid to the spectral grid requires an actual interpolation , taking special care to avoid gibbs phenomena that can appear in the spectral representation of discontinuous functions .",
    "the matter terms entering in the sources of the gravitational field equations can be discontinuous when a shock forms .",
    "thus , it is necessary to smooth or filter out high frequencies that would otherwise spoil the spectral representation .",
    "this introduces a numerical error in the fields that should remain within the overall error of the code . the important point to notice",
    "is that an accurate description needs not be achieved in the spectral representation of the sources ( the hydrodynamic quantities are well described on the finite difference grid ) , but in that of the gravitational field , which is always continuous , as well as its first derivatives .    technically , we interpolate from the finite difference grid to the spectral grid using a one - dimensional algorithm and intermediate grids .",
    "we first perform an interpolation in the @xmath97-direction , then in the @xmath104-direction and finally in the @xmath105-direction .",
    "we can choose between piecewise linear or parabolic interpolations , and a scheme that globally minimizes the norm of the second derivative of the interpolated function  @xcite .",
    "the filtering of spectral coefficients is performed _ a posteriori _ by removing the coefficients corresponding to higher frequencies .",
    "for example , in the radial direction , this is done by canceling the @xmath111 in eq .",
    "( [ eq : spec_decomp ] ) for @xmath132 larger than a given threshold . in practice ,",
    "best results were found when cancelling the last third of radial coefficients .",
    "this can be linked with the so - called `` two - thirds rule '' used for spectral computations of quadratically nonlinear equations  @xcite .",
    "nevertheless , a different ( higher ) threshold would also give good results , in the sense that there are no high - frequency terms rising during the metric iteration .",
    "as in our previous axisymmetric code  @xcite , in the present code the numerical integration of the system of hydrodynamic equations is performed using a godunov - type scheme .",
    "such schemes are specifically designed to solve nonlinear hyperbolic systems of conservation laws ( see , e.g.  @xcite for general definitions and  @xcite for specific details regarding their use in special and general relativistic hydrodynamics ) . in a godunov - type method",
    "the knowledge of the characteristic structure of the equations is crucial to design a solution procedure based upon either exact or approximate riemann solvers . these solvers , which compute at every cell - interface of the numerical grid the solution of local riemann problems , guarantee the proper capturing of all discontinuities which may appear in the flow .    the time update of the hydrodynamic equations  ( [ eq : hydro_conservation_equation ] ) from @xmath149 to @xmath150",
    "is performed using a method of lines in combination with a second - order ( in time ) conservative runge ",
    "kutta scheme .",
    "the basic conservative algorithm reads :    _ i , j , k^n + 1 = _ i , j , k^n & - & ( ^r_i + 1/2,j , k - ^r_i - 1/2,j , k ) + & - & ( ^_i , j + 1/2,k - ^_i , j - 1/2,k ) + & - & ( ^_i , j , k + 1/2 - ^_i , j , k - 1/2 ) + [ 0.5 em ] & + & t _",
    "i , j , k .",
    "the index @xmath151 represents the time level , and the time and space discretization intervals are indicated by @xmath152 and @xmath153 , @xmath154 , and @xmath155 for the @xmath97- , @xmath104- , and @xmath105-direction , respectively .",
    "the numerical fluxes along the three coordinate directions , @xmath156 , @xmath157 , and @xmath158 , are computed by means of marquina s flux formula  @xcite .",
    "a family of local riemann problems is set up at every cell - interface , whose jumps are minimized with the use of a piecewise parabolic reconstruction procedure ( ppm ) which provides third - order accuracy in space .",
    "we note that godunov - type schemes have also been implemented recently in 2d and 3d cartesian codes designed to solve the coupled system of the einstein and hydrodynamic equations , as reported in  @xcite .      in the following",
    "we present the three different approaches we have implemented in our code to numerically solve the system of metric equations  ( [ eq : metric_equations ] ) .",
    "we compare the properties of these solvers with special focus on issues like + - radius and order of convergence , + - scaling with resolution in various coordinate directions , + - imposition of boundary conditions , + - assumptions about the radial extension of the grid , + - computational performance , + - parallelization issues , and + - extensibility from two to three spatial dimensions .    in order to formalize the metric equations we define a vector of unknowns @xmath159 then the metric equations  ( [ eq : metric_equations ] )",
    "can be written as @xmath160 with @xmath161 denoting the vector of the five metric equations for @xmath162 ( @xmath163 ) . for metric solvers  1 and",
    "2 the metric equations are discretized at cell centers @xmath101 on the finite difference grid .",
    "correspondingly , for metric solver  3 the metric equations are evaluated at collocation points @xmath117 on the spectral grid .",
    "thus , when discretized , eq .",
    "( [ eq : metric_equations_vector ] ) transforms into the following coupled nonlinear system of equations of dimension @xmath164 or @xmath165 , respectively : @xmath166 with the vector of discretized equations @xmath167 for the unknowns @xmath168 . for this system",
    "we have to find the roots .",
    "note that , in general , each discretized metric equation @xmath169 couples both to the other metric equations through the five unknowns ( indices @xmath170 ) , and to other ( neighboring ) cell locations on the grid ( indices @xmath171 ) .",
    "all three metric solvers are based on iterative methods , where the new value for the metric @xmath172 is computed from the value at the current iteration @xmath173 by adding an increment @xmath174 which is weighted with a relaxation factor @xmath175 .",
    "the tolerance measure we use to control convergence of the iteration is the maximum increment of the solution vector on the grid the iteration is executed on , i.e.@xmath176      solver  1 , which was already introduced in the core collapse simulations reported in  @xcite , uses a multi - dimensional newton  raphson iteration method to find the roots of eq .",
    "( [ eq : discretized_metric_vector_equations ] ) .",
    "thus , solving the nonlinear system is reduced to finding the solution of a linear problem of the same dimension during each iteration .",
    "the matrix @xmath177 defining the linear problem consists of the jacobi matrix of @xmath178 and additional contributions originating from boundary and symmetry conditions ( see  @xcite for further details ) .",
    "as the spatial derivatives in the metric equations ( which also contain mixed derivatives of second order ) are approximated by second - order central differences with a three - point stencil , @xmath177 has a band structure with @xmath179 bands of blocks of size @xmath180 , where @xmath181 is the number of spatial dimensions of the finite difference grid .",
    "furthermore , matrix @xmath177 is sparse and usually diagonally dominated .",
    "a simple estimate already shows that the size @xmath182 of the linear problem grows impractically large in 3d .",
    "a resolution of 100 grid points in each coordinate direction results in a square @xmath183 matrix @xmath177 .",
    "thus , direct ( exact ) inversion methods , like gauss  jordan elimination or exact lu decomposition , are beyond practical applicability , as these are roughly @xmath184 processes , where @xmath151 is the dimension of the matrix .",
    "even when exploiting the sparsity and band structure of @xmath177 the linear problem remains too large to be solved on present - day computers in a reasonable time by using iterative methods like successive over - relaxation ( sor ) or conjugate gradient ( cg ) methods with appropriate preconditioning .    because of these computational restrictions ,",
    "the use of solver  1 is restricted to 2d axisymmetric configurations , where the matrix @xmath185 has nine bands of blocks . even in this case , for coupled spacetime and hydrodynamic evolutions , the choice of linear solver methods is limited : the computational time spent by the metric solver should not exceed the time needed for one hydrodynamical time step by an excessive amount .",
    "we have found that a recursive block tridiagonal sweeping method  @xcite ( for the actual numerical implementation , see  @xcite ) yields the best performance for the linear problem . here",
    "the three leftmost , middle , and rightmost bands are combined into three new bands of @xmath186 blocks of size @xmath187 and which are inverted in a forward - backward recursion along the bands using a standard lu decomposition scheme for dense matrices .",
    "actual execution times for this method and the scaling with grid resolution are given in section  [ subsubsection : convergence_2d ] .",
    "we point out that the recursion method provides us with a non - iterative linear solver , and the newton ",
    "raphson method exhibits in general very rapid and robust convergence .",
    "therefore , solver  1 converges rapidly to an accurate solution of the metric equations  ( [ eq : metric_equations_vector ] ) even for strongly gravitating , distorted configurations , irrespective of the relative strength of the `` hydrodynamics '' term @xmath88 and `` metric '' term @xmath89 in the metric equations ( see eq .",
    "( [ eq : metric_equations_rhs_split ] ) ) .",
    "its convergence radius is sufficiently large , so that even the flat minkowski metric can be used as an initial guess for the iteration , and the relaxation factor @xmath175 can be set equal to 1 .",
    "note that in solver  1 every metric function is treated numerically in an equal way ; in particular , the equations for each of the three vector components of the shift vector @xmath25 are solved separately .    in its current implementation ,",
    "solver  1 exhibits a particular disadvantage , which will be discussed in more detail in section  [ subsubsection : metric_fall_off ] . as its spatial grid , on which the metric equations are discretized ,",
    "is not radially compactified , there is a need for explicit boundary conditions of the metric functions @xmath162 at the outer radial boundary of the finite difference grid .",
    "this poses a severe problem , as there exists no general analytic solution for the vacuum spacetime surrounding an arbitrary rotating fluid configuration in any coordinate system . even in spherical symmetry",
    ", our choice of isotropic coordinates yields equations with noncompact support terms , which leads to imprecise boundary conditions , as demonstrated in section  [ subsection : noncompact_support ] .",
    "therefore , as an approximate boundary condition for an arbitrary matter configuration with gravitational mass @xmath188 , we use the monopole field for a static tov solution , @xmath189 evaluated at @xmath106 .",
    "the influence of this approximation on the accuracy of the solution for typical compact stars is discussed in section  [ subsubsection : metric_fall_off ] .",
    "we emphasize that the use of a noncompactified finite radial grid is not an inherent restriction of this solver method .",
    "however in the case of metric solver  1 , for practical reasons we have chosen to keep the original grid setup as presented in  @xcite , where both the metric and hydrodynamic equations are solved on the same finite difference grid .",
    "finally , a further drawback of solver  1 is its inefficiency regarding scalability on parallel or vector computer architectures .",
    "the recursive nature of the linear solver part of this method prevents efficient distribution of the numerical load onto multiple processors or a vector pipeline . in combination with the disadvantageous scaling behavior of the linear solver with resolution ( see also table  [ tab : runtime_metric_solver_2d ] below ) , these practical constraints render any extension of solver  1 to 3d beyond feasibility .",
    "while solver  1 makes no particular assumption about the form of the ( elliptic ) equations to be solved , solver  2 exploits the fact that the metric equations  ( [ eq : metric_equations ] ) can be written in the form of a system of nonlinear coupled equations with a laplace operator on the left hand side  ( [ eq : metric_equations_rhs_split ] ) . a common method to solve such kind of equations is to keep the right hand side @xmath190 fixed , solve each of the resulting decoupled linear poisson equations , @xmath191 , and iterate until the convergence criterion  ( [ eq : maximum_solution_vector ] ) is fulfilled .",
    "the linear poisson equations are transformed into integral form by using a three - dimensional green s function ,    & & ^s + 1 ( r , , ) = + & & - r^2 dr ",
    "d d  , [ eq : integral_poisson_equation ]    where the spatial derivatives in @xmath192 are approximated by central finite differences .",
    "the volume integral on the right hand side of eq .",
    "( [ eq : integral_poisson_equation ] ) is numerically evaluated by expanding the denominator into a series of radial functions @xmath193 and associated legendre polynomials @xmath194 , which we cut at @xmath195 .",
    "the integration in eq .",
    "( [ eq : integral_poisson_equation ] ) , which has to be performed at every grid point , yields a problem of numerical size @xmath196 .",
    "however , the problem size can be reduced to @xmath197 by recursion .",
    "thus , solver  2 scales linearly with the grid resolution in all spatial dimensions ( see section  [ subsubsection : convergence_2d ] ) .",
    "however , while the numerical solution of an integral equation like eq .",
    "( [ eq : integral_poisson_equation ] ) is well parallelizable , the recursive method which we employ to improve the resolution scaling performance poses a severe obstacle . in practice",
    "only the parallelization across the expansion series index @xmath198 ( or possibly cyclic reduction ) can be used to distribute the computational workload over several processors .",
    "an advantage of solver  2 is that it does not require the imposition of explicit boundary conditions at a finite radius due to the integral form of the equations .",
    "demanding asymptotic flatness at spatial infinity fixes the integration constants in eq .",
    "( [ eq : integral_poisson_equation ] ) .",
    "however , as the metric equations contain in general source terms with noncompact support ( see section  [ subsection : noncompact_support ] ) , the radial integration must be performed up to infinity to account for the source term contributions .",
    "as the discretization scheme used in solver  2 limits the radial integration to some finite radius @xmath106 , the metric equations are solved only approximately if the source terms with noncompact support are nonzero .",
    "the consequences of this fact are discussed in section  [ subsubsection : metric_fall_off ] . as in the case of metric solver  1",
    ", the metric solver  2 could be used with a compactified radial coordinate as well .",
    "one major disadvantage of solver  2 is its slow convergence rate and a small convergence radius . for simplicity , we decompose the metric vector equation for the shift vector @xmath25 into three scalar equations for its components . if the @xmath104-component of the shift vector does not vanish , @xmath199 , and if the spacetime is nonaxisymmetric , solver  2 does not converge at all ( probably due to diverging terms like @xmath200 in the vector laplace operator ) . even when using a known solution obtained with another metric solver as initial",
    "guess , solver  2 fails to converge .",
    "thus , the use of solver  2 is limited to axisymmetry .",
    "even so , when @xmath199 , a quite small relaxation factor @xmath201 is required .",
    "furthermore , as the iteration scheme is of fix - point type , it already has a much lower convergence rate than e.g.  a newton  raphson scheme .",
    "both factors result in typically several hundred iterations until convergence is reached ( see section  [ subsubsection : convergence_2d ] ) . for strong gravity",
    ", the small convergence radius restricts the initial guess to a metric close to the actual solution of the discretized equations .",
    "the basic principles of this iterative solver are similar to the ones used for solver  2 : a numerical solution of the nonlinear elliptic system of the metric differential equations is obtained by solving the associated linear poisson equations with a fix - point iteration procedure until convergence .",
    "however , instead of using finite difference scalar poisson solvers , solver  3 is built from routines of the publicly available lorene library  @xcite and uses spectral methods to solve scalar and vector poisson equations  @xcite .",
    "before every computation of the spacetime metric , the hydrodynamic and metric fields are interpolated from the finite difference to the spectral grid by the methods detailed in section  [ subsubsection : grid_communication ] .",
    "all three - dimensional functions are decomposed into chebyshev polynomials @xmath202 and spherical harmonics @xmath203 in each domain . when using solver  3 the metric equations  ( [ eq : adm_metric_equations ] ) are rewritten in order to gain accuracy",
    "according to the following transformations .",
    "the scalar metric functions @xmath77 and @xmath24 have the same type of asymptotic behavior near spatial infinity , @xmath204 , @xmath205 , with @xmath206 and @xmath207 approaching 0 as @xmath208 . therefore , to obtain a more precise numerical description of the ( usually small ) deviations of @xmath77 and @xmath24 from unity",
    ", we solve the equations for the logarithm of @xmath77 and @xmath209 , imposing that @xmath210 and @xmath211 approach zero at spatial infinity . another important difference to the other two solvers",
    "is that the vector poisson equation for the shift vector @xmath25 is not decomposed into single scalar components , but instead the entire linear vector poisson equation is solved , including the @xmath212 operator on the left hand side .",
    "therefore , the system of metric equation to be solved reads @xmath213      & & \\displaystyle      - \\hat{\\nabla}^i \\ln \\phi \\ ; \\hat{\\nabla}_i \\ln \\phi , \\\\ [ 0.7 em ]      \\hat{\\delta } \\ln \\alpha \\phi & = & \\displaystyle      2 \\pi \\phi^4 \\left ( \\rho h ( 3 w^2 - 2 ) + 5 p +      \\frac{7 k_{ij } k^{ij}}{16 \\pi } \\right )       \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! \\\\ [ 0.7 em ]      & & \\displaystyle      - \\hat{\\nabla}^i \\ln \\alpha \\phi \\ ;      \\hat{\\nabla}_i \\ln \\alpha \\phi , \\\\ [ 0.7 em ]      \\hat{\\delta } \\beta^i & + & \\displaystyle       \\frac{1}{3 } \\hat{\\nabla}^i \\hat{\\nabla}_k \\beta^k =      \\displaystyle 16 \\pi \\alpha \\phi^4 s^i +      2 \\phi^{10 } k^{ij } \\hat{\\nabla}_j      \\left ( \\frac{\\alpha}{\\phi^6 } \\right)\\!.      \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\ !    \\end{array }    \\label{eq : ln_phi_alpha_metric_equation}\\ ] ] during each iteration a spectral representation of the solution of the linear scalar and vector poisson equations associated with the above system is obtained .",
    "the laplace operator is inverted ( i.e.  the linear poisson equation is solved ) in the following way : for a given pair of indices @xmath198 and @xmath214 of @xmath203 , the linear scalar poisson equation reduces to an ordinary differential equation in @xmath97 . the action of the differential operator @xmath215 acting thus on each multipolar component ( @xmath198 and @xmath214 ) of a scalar function corresponds to a matrix multiplication in the chebyshev coefficient space .",
    "the corresponding matrix is inverted to obtain a particular solution in each domain , which is then combined with homogeneous solutions ( @xmath216 and @xmath217 , for a given @xmath198 ) to satisfy regularity and boundary conditions .",
    "the matrix has a small size ( about @xmath218 ) and can be put into a banded form , owing to the properties of the chebyshev polynomials , which facilitates its fast inversion . for more details about this procedure , and how the vector poisson equation is treated , the interested reader is addressed to  @xcite . note also that when solving the shift vector equation , @xmath25 is decomposed into cartesian components defined on the spherical polar grid ( see  @xcite ) .",
    "the spatial differentials in the source terms on the right hand sides of the metric equations are approximated by second - order central differences in solvers  1 and  2 , while they are obtained by spectral methods in solver  3 ( see section  [ subsubsection : spectral_methods ] ) .",
    "when using @xmath145 collocation points , very high precision ( @xmath219 ) can be achieved in the evaluation of these derivatives .",
    "another advantage of metric solver  3 is that a compactified radial coordinate @xmath220 enables us to solve for the entire space , and to impose exact boundary conditions at spatial infinity , @xmath221 .",
    "this ensures both asymptotic flatness and fully accounts for the effects of the source terms in the metric equations with noncompact support .",
    "solver  3 uses the same fix - point iteration method as solver  2 , but does not suffer from the convergence problem encountered with that solver .",
    "due to the direct solution of the vector poisson equation for the shift vector @xmath25 , it converges to the correct solution in all investigated models ( including highly distorted 3d matter configurations with velocity perturbations , see section  [ subsubsection : convergence_2d ] ) .",
    "furthermore , this can be achieved with the maximum possible relaxation factor , @xmath222 , starting from the flat metric as initial guess .    however , the strongest reason in favor of solver  3 is its straightforward extension to 3d .",
    "as mentioned previously , both metric solvers  1 and  2 are limited to axisymmetric situations .",
    "the spectral elliptic solvers provided by the lorene library are already intrinsically three - dimensional .",
    "indeed , even in axisymmetry the spectral grid of solver  3 requires @xmath223 grid points in the @xmath105-direction order to correctly represent the cartesian components of the shift vector .",
    "there is an additional computational overhead due to the communication between the finite difference and the spectral grids .",
    "these computational costs may actually become a dominant part when calculating the metric ( as will be shown in section  [ subsection : interpolation_tests ] ) .",
    "the interpolation methods also have to be chosen carefully to obtain the desired accuracy .",
    "furthermore , spectral methods may suffer from gibbs phenomena if the source terms of the poisson - like equations contain discontinuities .",
    "for the particular type of simulations we are aiming at , discontinuities are present ( supernova shock front , discontinuity at the transition from the stellar matter distribution to the artificial atmosphere at the boundary of the star ) .",
    "this can result in high - frequency spurious oscillations of the metric solution , if too few radial domains are used , or if the boundaries of the spectral domains are not chosen properly .",
    "as mentioned before , a simple way to reduce the oscillations is to filter out part of the high - frequency spectral coefficients .    as the c++ routines of the lorene library in the current release are optimized for neither vector nor parallel computers , solver  3 can not yet exploit these architectures .",
    "however , we were able to improve the computational performance by coarse - grain parallelizing the routines which interpolate the metric solution in the spectral representation to the finite difference grid .      in a conformally flat spacetime",
    "the dynamical gravitational wave degrees of freedom are not present  @xcite .",
    "therefore , in order to extract information regarding the gravitational radiation emitted in core collapse events and in rotating neutron star evolutions , we have implemented in the code the 3d generalization of the axisymmetric newtonian quadrupole formula used in  @xcite . note that we use spherical polar components for the tensors of the radiation field .    whereas in axisymmetry there exists only one independent component of the quadrupole gravitational radiation field @xmath224 in the transverse traceless gauge , @xmath225 in three dimensions we have @xmath226 ,    \\label{eq : h_tt_3d}\\ ] ] with the unit vectors @xmath227 and @xmath228 defined as    _ + & = & _ _ - _ e _ , + _ & = & _ _ + _ e_. [ eq : e_plus_e_cross ]    the amplitudes @xmath229 and @xmath230 are linear combinations of the second time derivative of some components of the quadrupole moment tensor @xmath231 , which for simplicity we evaluate at @xmath232 on the polar axis and in the equatorial plane , respectively :    rcl a_+^p & = & 1.92ex1.6ex - 1.92ex1.6ex , + [ 0.25 em ] a_^p & = & 2 1.92ex1.6ex ,    & & = 0 , + [ 0.5 em ]    rcl a_+^e & = & 1.92ex1.6ex - 1.92ex1.6ex , + [ 0.25 em ] a_^e & = & - 2 1.92ex1.6ex ,    & & = / 2 . [ eq : a_plus_a_cross_pole_equator_3d ]    a direct numerical calculation of the quadrupole moment in the _ standard quadrupole formulation _ , @xmath233\\ ! ,    \\label{eq : i_ij_sqf_3d}\\ ] ] results in high frequency noise completely dominating the wave signal due to the presence of the second time derivatives in eq .",
    "( [ eq : a_plus_a_cross_pole_equator_3d ] ) .",
    "therefore , we make use of the time - differentiated quadrupole moment in the _ first moment of momentum density formulation _ , @xmath234\\ ! ,    \\label{eq : i_ij_fmomdf_3d}\\ ] ] and _ stress formulation _ , @xmath235\\ ! ,",
    "\\label{eq : i_ij_sf_3d}\\ ] ] of the quadrupole formula  @xcite .    in the above equations ,",
    "@xmath236 and @xmath237 are the coordinates and velocities in cartesian coordinates , respectively . when evaluating eq .",
    "( [ eq : i_ij_sf_3d ] ) numerically , we transform @xmath237 to spherical polar coordinates . in the quadrupole moment",
    ", we use @xmath238 instead of @xmath11 as in  @xcite , as this quantity is evolved by the continuity equation ( note that both quantities have the same newtonian limit ) .",
    "this also allows a direct comparison with the results presented in  @xcite , which we show in section  [ subsubsection : comparison_with_full_gr ] . for a discussion about the ambiguities arising from the spatial derivatives of the newtonian potential @xmath239 in eq .",
    "( [ eq : i_ij_sf_3d ] ) in a general relativistic framework and their solution ( which we also employ in this work ) , we refer to  @xcite .",
    "the total energy emitted by gravitational waves can be expressed either as a time integral ,    e_gw & = & dt , [ eq : e_grav_time_3d ]    or , equivalently , as a frequency integral ,    e_gw & = & ^2 d , [ eq : e_grav_frequency_3d ]    where @xmath240 is the fourier transform of @xmath241 .",
    "we point out that the above general expressions reduce to the following ones in axisymmetry :    & a_+^p = 0 , a_^p = 0 , a_+^e = 1.92ex , a_^e = 0 , & + & e_gw = dt 1.92ex^2= ^2 d 0.6ex^2 - 0.5ex , & [ eq : e_grav_2d ]    with @xmath242 being the only nonzero independent component of the quadrupole tensor , and @xmath243 being the fourier transform of @xmath244 .",
    "the quadrupole wave amplitude @xmath245 used in  @xcite is related to @xmath246 according to @xmath247 .",
    "we have tested the equivalence between the waveforms obtained by the axisymmetric code presented in  @xcite and those by the current three - dimensional code using the corresponding axisymmetric model . in all investigated cases ,",
    "they agree with excellent precision .",
    "we turn now to an assessment of the numerical code with a variety of tests and applications .",
    "we recall that we do not attempt in the present paper to investigate any realistic astrophysical scenario , which is deferred to subsequent publications .",
    "instead , we focus here on discussing standard tests for general relativistic three - dimensional hydrodynamics code , which were all passed by our code .",
    "in particular , we show that the code exhibits long - term stability when evolving strongly gravitating systems like rotational core collapse and equilibrium configurations of ( highly perturbed ) rotating relativistic stars .",
    "each separate constituent methods of the code ( hrsc schemes for the hydrodynamics equations and elliptic solvers based on spectral methods for the gravitational field equations ) has already been thoroughly tested and successfully applied in the past ( see e.g.  @xcite and references therein ) .",
    "therefore , we mainly demonstrate here that the coupled numerical schemes work together as desired .",
    "c@  |c@  |c@  |c@   @xmath197 & type & @xmath248 [ s ] & @xmath249 [ @xmath250 norm ] +    ' '' ''    @xmath251 & 2 & 5.13 & @xmath252 + @xmath251 & 1 & 5.12 & @xmath253 + @xmath251 & 0 & 9.44 & @xmath254 + [ 0.7 em ] @xmath255 & 2 & 2.92 & @xmath256 + @xmath257 & 2 & 1.43 & @xmath258 + @xmath259 & 2 & 0.77 & @xmath260 + @xmath261 & 2 & 0.09 & @xmath262 + [ 0.7 em ] @xmath263 & 2 & 2.55 & @xmath256 + @xmath264 & 2 & 1.60 & @xmath254 + @xmath265 & 2 & 0.32 & @xmath266 + [ 0.7 em ] @xmath267 & 2 & 3.61 & @xmath268 + @xmath269 & 2 & 1.81 & @xmath270 + @xmath271 & 2 & 1.40 & @xmath272 + @xmath273 & 2 & 0.99 & @xmath274 +    the interpolation procedure from the finite difference grid to the spectral grid has been described in section  [ subsubsection : grid_communication ] . among the three possible algorithms we have implemented in the code , the most efficient turned out to be the one based on a piecewise parabolic interpolation ( see table  [ tab : runtime_interpolation_fd_to_sp ] ) .",
    "it is as fast as the piecewise linear interpolation , and more accurate than the algorithm based on the minimization of the second derivative of the interpolated function .",
    "table  [ tab : runtime_interpolation_fd_to_sp ] shows , for a particular example of an interpolated test function @xmath275 $ ] , the relative accuracy @xmath276 ( in the @xmath250 norm ) achieved by this interpolation , as well as the cpu time spent on a pentium iv xeon processor at 2.2 ghz .",
    "the spectral grid consists of two domains ( nucleus + shell ) with @xmath277 , @xmath278 , and @xmath279 .",
    "the outer radius of the nucleus is located at 0.5 , and the outer boundary of the shell is at 1.5 ( corresponding to the radius of the finite difference grid @xmath106 ) .",
    "this test demonstrates that the piecewise parabolic interpolation is indeed third - order accurate , and that the time spent scales roughly linearly with the number of points of the finite difference grid in any direction .",
    "we have made other tests which show that the interpolation accuracy is independent of @xmath280 , and that it scales in time like @xmath281 , where @xmath280 and @xmath151 are the number of points used in each dimension by the spectral and the finite difference grid , respectively .",
    "the interpolation is exact , up to machine precision , for functions which can be expressed as polynomials of degree @xmath282 with respect to all three coordinates .",
    "@  c@",
    "|c@  |c@   @xmath283 & @xmath284 [ s ] & @xmath285 [ @xmath250 norm ] +    ' '' ''    @xmath286 & 75.8 & @xmath287 + @xmath288 & 38.4 & @xmath289 + @xmath290 & 19.6 & @xmath291 + @xmath292 & 10.3 & @xmath293 + [ 0.7 em ] @xmath294 & 40.8 & @xmath295 + @xmath296 & 23.4 & @xmath297 + [ 0.7 em ] @xmath298 & 41.2 & @xmath299 + @xmath300 & 24.6 & @xmath301 + @xmath302 & 16.7 & @xmath303 +    the direct spectral summation from the spectral to the finite difference grid is a very precise way of evaluating a function : for smooth functions , the relative error decreases like @xmath304 ( infinite order scheme )",
    ". this property is fulfilled in our code , as shown in table  [ tab : runtime_interpolation_sp_to_fd ] for the same test function @xmath305 and the same domain setup as for table  [ tab : runtime_interpolation_fd_to_sp ] ( again the timings are for a pentium iv xeon processor at 2.2 ghz ) .",
    "double precision accuracy is reached with a reasonable number of points ( @xmath139 , @xmath278 , and @xmath306 ) . according to table  [ tab : runtime_interpolation_sp_to_fd ] the cpu cost scales linearly with the number of coefficients @xmath280 in any direction .",
    "we have also confirmed that it scales linearly with the number of finite difference grid points @xmath151 in any direction .",
    "the drawback of this most straightforward procedure is that it requires @xmath307 operations , which is much more expensive than the interpolation from the finite difference grid to the spectral one , and even more expensive than the iterative procedure providing the solution of system  ( [ eq : ln_phi_alpha_metric_equation ] ) .",
    "nevertheless , it is computationally not prohibitive since the overall accuracy of the code does not depend on @xmath280 ( which can thus remain small ) .",
    "a way to reduce the execution time is to use a partial summation algorithm ( see e.g.  @xcite ) , which needs only @xmath308 operations , at the additional cost of increased central memory requirement .",
    "another alternative is to truncate the spectral sum , staying at an accuracy level comparable to that of finite difference differential operators .",
    "the theoretical considerations about the convergence properties of the three implemented metric solvers ( as outlined in section  [ subsection : fd_elliptic_solvers ] ) are checked by solving the spacetime metric for a 2d axisymmetric rotating neutron star model in equilibrium ( labeled model rns ) , which we have constructed with the method described in komatsu et al .",
    "this model has a central density @xmath309 , obeys a polytropic eos with @xmath310 and @xmath311 ( in cgs units ) , and rotates rigidly at the mass shedding limit , which corresponds to a polar - to - equatorial axis ratio of 0.65 .",
    "these model parameters are equivalent to those used for neutron star models in  @xcite .",
    "= 8.6 cm    to the initial equilibrium model we add an @xmath97- and @xmath104-dependent density and velocity perturbation , @xmath312 , \\\\ [ 1 em ]      v_r & = & \\displaystyle      0.05 \\sin^2 \\ !",
    "\\left ( \\ ! \\pi",
    "\\frac{r}{r_{\\rm s } } \\right )      \\left ( 1 + \\sin^2 ( 2 \\theta ) \\right ) , \\\\ [ 1 em ]      v_\\theta & = & \\displaystyle      0.05 \\sin^2 \\ !",
    "\\left ( \\ !",
    "\\pi \\frac{r}{r_{\\rm s } } \\right )      \\sin^2 ( 2 \\theta ) , \\\\ [ 1 em ]      v_\\varphi & = & \\displaystyle v_{\\varphi\\,\\rm ini } +      0.05 \\sin^2 \\",
    "! \\left ( \\ !",
    "\\pi \\frac{r}{r_{\\rm s } } \\right )      \\left ( 1 + \\sin^2 ( 2 \\theta ) \\right ) ,    \\end{array }    \\label{eq : perturbation_metric_test_2d}\\ ] ] where @xmath86 is the ( @xmath104-dependent ) stellar radius , and @xmath313 , @xmath314 , and @xmath315 . the metric equations ( eqs .",
    "( [ eq : metric_equations ] ) for solvers  1 and  2 , and eqs .",
    "( [ eq : ln_phi_alpha_metric_equation ] ) in the case of solver  3 ) are then solved using the three implemented metric solvers .",
    "the perturbation of @xmath316 and @xmath317 ensures that the metric equations yield the general case of a shift vector with three nonzero components , which can not be obtained with an initial model in equilibrium .",
    "we point out that by adding the perturbations specified in eq .",
    "( [ eq : perturbation_metric_test_2d ] ) and calculating the metric for these perturbed initial data , we add a small inconsistency to the initial value problem .",
    "as the lorentz factor @xmath28 in the right hand sides of the metric equations contains metric contributions ( which are needed for computing the covariant velocity components ) , it would have to be iterated with the metric solution until convergence .",
    "however , as the perturbation amplitude is small , and as we do not evolve the perturbed initial data , we neglect this small inconsistency .",
    "the most relevant quantity related to convergence properties of the metric solver is the maximum increment @xmath318 of all metric components on the grid ( see fig .",
    "[ fig : convergence_metric_solver_2d ] ) .",
    "as expected solver  1 exhibits the typical quadratic decline of a newton  raphson solver to its threshold value @xmath319 .",
    "as the methods implemented in solvers  2 and  3 correspond to a fix - point iteration , the decline of their metric increment is significantly slower .",
    "therefore , for the poisson - based solvers , we typically use a less restrictive threshold @xmath320 . while the spectral poisson solver  3 allows for a relaxation factor of 1 and thus for a still quite rapid convergence , the conventional poisson solver  2 requires more than 700 iterations due to its much smaller relaxation factor imposed by the @xmath321-equation .",
    "it is worth stressing that all three solvers show rather robust convergence , if one keeps in mind that the initial guess is the flat spacetime metric .",
    "if the metric is changing dynamically during an evolution , the metric values from the previous computation can be used as new starting values , which reduces the number of iterations by about a factor of two with respect to those reported in fig .",
    "[ fig : convergence_metric_solver_2d ] .",
    "besides the convergence rate , the execution time @xmath322 required for a single metric computation and its dependence on the grid resolution is also of paramount relevance for the practical usefulness of a solver .",
    "these times for one metric computation of the perturbed rns stellar model on a finite difference grid with various @xmath323- and @xmath104-resolutions on an ibm rs/6000 power4 processor are summarized in table  [ tab : runtime_metric_solver_2d ] .",
    "as theoretically expected , both solver  1 and 2 show a linear scaling of @xmath322 with the number of radial grid points @xmath186 , i.e.  the ratio @xmath324 is approximately 2 .",
    "while the integration method of solver  2 shows linear dependence also for the number of meridional grid zones @xmath325 , the inversion of the dense @xmath326 matrices during the radial sweeps in solver  1 is roughly a @xmath327 process .",
    "thus , the theoretical value of @xmath328 for that solver is well met by the results shown in table  [ tab : runtime_metric_solver_2d ] .",
    "we note that for even larger values of @xmath325 , specific processor properties like cache - miss problems can even worsen the already cubic scaling of solver  1 , while for @xmath329 solver  2 fails to converge altogether . on the other hand for solver",
    "3 @xmath322 is approximately independent of the number of finite difference grid points in either coordinate direction , as the number of spectral collocation points is fixed . a dependence on @xmath186 and @xmath325 can only enter via the interpolation procedure between the two grids , the time for which is , however , entirely negligible in 2d .",
    "c@  |rrr@  |rrr@",
    "|rrr@   & & & + @xmath330 & & & & & & & & & +    ' '' ''    @xmath331 & 1.8 & & & 2.8 & & & 20.7 & & + @xmath332 & 3.7 & 2.0 & & 5.9 & 2.1 & & 20.6 & 1.0 & + @xmath333 & 7.4 & 2.0 & & 12.9 & 2.2 & & 20.8 & 1.0 & + [ 0.7 em ] @xmath334 & 12.5 & & 6.9 & 5.9 & & 2.1 & 20.8 & & 1.0 + @xmath335 & 25.4 & 2.0 & 6.9 & 12.3 & 2.1 & 2.1 & 20.5 & 1.0 & 1.0 + @xmath336 & 50.8 & 2.0 & 6.9 & 27.1 & 2.2 & 2.1 & 21.7 & 1.1 & 1.0 + [ 0.7 em ] @xmath337 & 109.7 & & 8.8 & 12.4 & & 2.1 & 20.9 & & 1.0 + @xmath338 & 224.2 & 2.0 & 8.8 & & & & 21.5 & 1.0 & 1.1 + @xmath339 & 445.2 & 2.0 & 8.8 & & & & 21.7 & 1.0 & 1.1 +    the break even point for the three solvers corresponds roughly to a resolution of @xmath340 grid points at @xmath341 .",
    "we emphasize that this value of @xmath322 is _ much larger _ than the time needed for one hydrodynamic step at the same resolution , which is roughly @xmath342 . from the results reported in table  [ tab : runtime_metric_solver_2d ] it becomes evident that due to the independence of @xmath322 on the finite difference grid resolution in the spectral metric solver  3 , this method is far superior to the other two solvers for simulations requiring a large number of grid points in general , and particularly in @xmath104-direction .",
    "when comparing in section  [ subsection : fd_elliptic_solvers ] the theoretical foundations of the three alternative metric solvers implemented in the code , we already raised the issue of the existence of source terms with noncompact support in the metric equations  ( [ eq : metric_equations ] ) ( see section  [ subsection : noncompact_support ] ) .",
    "neither the newton  raphson - based solver  1 , which requires explicit boundary conditions at the finite radius @xmath106 ( which are in general not exactly known and possibly time - dependent ) , nor the conventional iterative poisson solver  2 , which integrates the poisson - like metric equations only up to the same finite radius @xmath106 , are able to fully account for the nonlinear source terms , even if the radial boundary of the finite difference grid is in the vacuum region outside the star , @xmath343 .    hence , both solvers yield a numerical solution of the exact metric equations only in very few trivial cases , like e.g.  the solution for the metric of a spherically symmetric static matter distribution ( tov solution ) , when the metric equations reduce to poisson - like equations with compact support .",
    "however , due to the radial compactification of the spectral grid , which allows for the poisson equations to be numerically integrated out to spacelike infinity , the spectral solver  3 can consistently handle all noncompact support source terms in the metric equations in a non - approximative way .",
    "this property holds even when the metric quantities are mapped from the spectral grid onto the finite difference grid , the latter extending only to @xmath106 .",
    "thus , we expect that only solver  3 captures the correct radial fall - off behavior of the metric quantities outside the matter distribution .",
    "= 8.6 cm    in the following we illustrate the effects of noncompact support terms in the metric equations on the numerical solution using the three different solvers .",
    "[ fig : rns_shift_vector_comparison_2d ] shows the radial equatorial profiles of the rotational shift vector component @xmath344 for the rapidly rotating neutron star initial model ( rns ) specified in section  [ subsubsection : convergence_2d ] , obtained with the three alternative metric solvers .",
    "while we restrict our discussion to the particular metric quantity @xmath345 we notice that the radial fall - off behavior and the dependence on the solver method is equivalent for all other metric components .    in the upper panel of fig .",
    "[ fig : rns_shift_vector_comparison_2d ] the equatorial stellar boundary @xmath346 is very close to the radial outer boundary of the finite difference grid , @xmath347 ( both indicated by vertical dotted lines ) .",
    "the star and the exterior atmosphere are resolved using @xmath348 radial grid points for the star and @xmath349 radial grid points for the atmosphere ( along the equator ) , respectively , and @xmath350 meridional points . the spectral solver  3 uses @xmath139 radial and @xmath278 meridional grid points .",
    "if the boundary value for the metric at @xmath106 is exact , solver  1 always yields the correct solution , irrespective of the source terms not having compact support . for stationary solutions like rotating neutron stars these exact values can in principle",
    "be provided by the initial data solver . however ,",
    "for instance in a dynamical situation , exact values can not be provided , and we are forced to use approximate boundary conditions , which we choose according to eq .",
    "( [ eq : vacuum_matching ] ) .",
    "as the approximate boundary value for solver  1 , @xmath351 , is far from the exact value , the corresponding profile of the shift vector ( dashed line ) strongly deviates from the correct @xmath352 obtained by the initial data solver ( solid line ) .",
    "note that the exact solution is given only for @xmath353 , due to limitations of the initial solver method  @xcite .",
    "as shown in the lower panel of the figure , with increasing distance of the finite difference grid boundary from the stellar boundary ( @xmath354 with @xmath355 ) , the approximation for @xmath356 improves noticeably , and so does the matching of @xmath345 with the correct solution .    on the other hand ,",
    "as the integral approach of solvers  2 and  3 requires no specific boundary conditions at a finite radius ( contrary to solver  1 ) , the numerical solution for @xmath345 agrees well with the correct solution even for an integration boundary @xmath106 close to the stellar boundary @xmath346 ( dashed - dotted and dotted lines in fig .",
    "[ fig : rns_shift_vector_comparison_2d ] , respectively ) . for @xmath357 , when the influence of the source terms with noncompact support is increasingly picked up by the radial integral , the solutions supplied by solver  2 rapidly approach the correct one .",
    "the terms with noncompact support usually do not contribute strongly to the solution of the metric equations ( except in cases of very strong gravity and extremely rapid contraction or rotation ) .",
    "thus , solver  2 is superior to solver  1 when approximate boundary values must be used , eq .",
    "( [ eq : vacuum_matching ] ) .",
    "solver  3 , on the other hand , has the key advantage over solver  2 of using very accurate spectral methods for solving the poisson equation over the _ entire",
    "_ spatial volume due to its compactified radial coordinate .",
    "hence , irrespective of the distance of @xmath106 from @xmath346 , it yields the same results on the finite difference grid , onto which the results are mapped from the spectral grid .",
    "the ( small ) difference between the results for @xmath345 from solver  3 and from the initial data solver is partly due to the accuracy of the numerical schemes and the mapping between different grids , and particularly a result of the cfc approximation of the field equations employed by the evolution code ( note that the initial data are generated from a numerical solution of the exact einstein metric equations ) . in the case of rapidly rotating neutron star models we have found that the truncation error and the error arising from the mapping of the initial data to the evolution code is typically more than one order of magnitude smaller than the error which can be attributed to the cfc approximation , if a grid with a resolution @xmath358 , @xmath359 and @xmath139 , @xmath278 is used . for estimates of the quality of the cfc approximation in such cases ,",
    "see  @xcite and references therein .",
    "we again note that , in principle , the use of a compactified radial grid is not confined to the spectral solver  3 .",
    "a finite difference grid extending to spatial infinity could be used for solvers  1 and  2 as well . however , in that case either the exterior atmosphere would also have to be extended to the entire grid too ( generating unnecessary computations ) , or only the relevant portion of the grid containing the star would have to be evolved in time ( creating an additional boundary ) . when using solver  3 , there is a clearcut split between the finite difference grid and the spectral grid .",
    "thus , the hydrodynamic quantities can be defined on a grid with an atmosphere of only small size , while the metric in the compactified domain can be computed very accurately with only few radial collocation points due to the exponential convergence of spectral methods in this smooth region .",
    "additionally , the lorene library provides the use of a compactified radial domain as an already implemented option at no extra cost .",
    "as all three metric solvers yield equally precise numerical solutions of the spacetime metric in 2d , they give nearly identical results when applied to simulations of rotational core collapse , as shown in fig .",
    "[ fig : metric_solver_comparison_2d ] . for the results presented in this figure",
    "we have chosen the stellar core collapse model labeled a3b2g4 in  @xcite ( model scc in the following ) , which rotates differentially and moderately fast , and has an initial central density @xmath360 .",
    "the initial adiabatic index is reduced from @xmath361 to @xmath362 during contraction , and is increased to @xmath363 beyond supranuclear matter densities , @xmath364 .",
    "the details of the eos for this model are given by eq .",
    "( [ eq : hybrid_eos ] ) .",
    "as the metric calculation is computationally very expensive , it is done only every 100/10/50 hydrodynamic time steps before / during / after core bounce , and extrapolated in between ( for details on the satisfactory accuracy of this procedure see  @xcite ) .",
    "the number of zones used in the finite difference grid is @xmath140 and @xmath350 , with logarithmic spacing in the @xmath97-direction and a central resolution of 500  m , and an equidistant spacing in the @xmath104-direction .",
    "again , the grid resolution of the spectral solver  3 is @xmath139 and @xmath278 .",
    "= 8.6 cm    in the upper panel of fig .",
    "[ fig : metric_solver_comparison_2d ] we plot the time evolution of the central conformal factor @xmath365 , which rises steeply when the central density increases to supranuclear densities , reaches a maximum at the time of core bounce @xmath366 ( vertical dotted line ) , and subsequently approaches a new equilibrium value with decreasing ringdown oscillations .",
    "this new state , which is reached asymptotically , signals the formation of a pulsating compact remnant which can be identified with the nascent proto - neutron star .",
    "each of the three curves in this upper panel is the result of using one of the three available metric solver ( see caption for details ) .",
    "the lower panel of the figure demonstrates that the relative differences found in the dynamical evolution of our representative core collapse model are negligibly small when using either metric solver , which proves the applicability of any of the metric solvers in 2d .",
    "= 8.6 cm    however , in such a highly dynamical situation , where the relevant radial scales vary by a factor of about 100 , solver  3 requires a special treatment of the radial domain setup of the spectral grid defined in section  [ subsubsection : spectral_methods ] . during the infall phase of a core collapse simulation the contracting core",
    "must be suffiently resolved by the radial grid , and thus we adjust the radius of the nucleus @xmath121 dynamically before core bounce .",
    "( note that this is no contradiction to the assumption@xmath367 in eq .",
    "( [ eq : domain_boundary_factor ] ) , as @xmath135 may change between _ subsequent _ metric calculations during the evolution . ) initially the value of @xmath121 is given by half the stellar radius .",
    "as the evolution proceeds it is set equal to the radial location of the sonic point in the equatorial plane ( once unambiguously detected ) .",
    "alternatively @xmath121 can be determined by the radius enclosing a shell of a fixed fraction of the total rest mass of the star ( typically 10% ) , whereby @xmath121 moves inward during the collapse , too . in either case",
    "@xmath121 is held fixed when some minimal radial threshold @xmath368 is crossed , which we set equal to the radius of some given radial grid point ( e.g.  the 40th grid point at @xmath369 ) .",
    "this ensures that there is always a sufficient number of grid points on the finite difference grid , such that the interpolation to the spectral grid is well behaved . for @xmath370 domains ,",
    "both approaches yield equally accurate results , the relative difference between the values of @xmath365 being less than @xmath371 throughout the evolution of the collapse model scc ( see lower panel of fig .  [",
    "fig : domain_radius_method_comparison_2d ] ) .",
    "= 8.6 cm    at least for core collapse simulations , the appropriate choice of the radial spectral domain setup parameters @xmath137 and @xmath372 is crucial , as exemplified in fig .",
    "[ fig : domain_number_and_radius_effects_2d ] .",
    "the reduction of @xmath121 with time must follow the contraction of the core to a sufficiently small radius , while @xmath368 must retain enough grid points for the nucleus . furthermore , when splitting the spectral grid into several radial domains , well - behaved differential operators ( in particular , the poisson operator ) are only obtained if , for a _",
    "shell_-type domain , the criterion of thin shell - type domains , @xmath373 , is fulfilled .",
    "this restriction for the ratio @xmath135 between the outer and the inner radii originates from the requirement to keep the condition number of the matrix representing ( for a given multipolar momentum @xmath198 ) the radial poisson operator  ( [ eq : poisson_operator_lm ] ) , which is a very fast growing function of @xmath135 , lower than @xmath374 .    in particular fig .",
    "[ fig : domain_number_and_radius_effects_2d ] shows that if @xmath121 is not properly adjusted or if @xmath368 is too large , the central conformal factor deviates strongly from the correct value ( upper panel ) .",
    "in addition , if the number of domains is too small while keeping the radial resolution @xmath139 fixed , the conformal factor inside the core shows large amplitude oscillations after core bounce , due to a too large value of @xmath135 ( lower panel ) . if @xmath373 is violated because of too few domains in a collapse situation , such oscillations are even present if the radial resolution @xmath375 is increased .    on the other hand , in quasi - stationary situations with no large dynamical radial range ( e.g.  oscillations of neutron stars )",
    ", one can safely reduce @xmath137 from 6 to 3 and keep @xmath121 fixed throughout the evolution .",
    "the optimal number of domains @xmath137 is thus determined by balancing radial resolution and the requirement of thin shell - type domains against computational costs .      only recently , fully general relativistic simulations of axisymmetric rotational core collapse have become available  @xcite .",
    "we now estimate the quality of the cfc approximation adopted in our code by simulating one of the core collapse models presented in  @xcite and comparing the results .",
    "in their simulations , shibata and sekiguchi  @xcite make use of the cartoon method  @xcite which reduces the dimensionality of a code based on 3d cartesian coordinates to 2d in the case of axisymmetric configurations . using this approach , and solving the full set of bssn metric equations , these authors present a series of rotational core collapse models with parameters close ( but not exactly equal ) to the ones simulated by dimmelmeier et al .  @xcite . as an additional difference",
    ", @xmath238 is employed by  @xcite in the gravitational wave extraction with the first moment of momentum density formula , while in  @xcite the wave extraction is performed with the stress formula using the density @xmath11 ( see section  [ subsection : wave_extraction ] for details ) .",
    "furthermore , in the simulations reported in  @xcite , the equidistant cartesian finite difference grid is repeatedly remapped during the collapse , so that the grid spacing in the center increases from initially @xmath376 to @xmath377 during core bounce . as the outer boundary moves in accordingly",
    ", matter leaves the computational grid , resulting in a mass loss of about 3% .",
    "in their paper , shibata and sekiguchi investigated a core collapse model which is identical to our model scc ( a3b2g4 in  @xcite ) with the exception of a slightly smaller rotation length parameter @xmath378 ( compared to @xmath379 in  @xcite ) in the initial equilibrium model .",
    "they found that the evolution of this model ( labeled @xmath380 hereafter ) computed with their fully general relativisitc code agrees qualitatively well with the evolution of our model scc simulated with our cfc code .",
    "however , it produces an increased gravitational wave amplitude of about 20% at the peak during core bounce , and up to a factor 2 in the ringdown . furthermore , the damping time of the ringdown signal of model @xmath380 as shown in  @xcite is significantly longer compared to that of model scc presented in  @xcite .",
    "= 8.6 cm    shibata and sekiguchi offer several possible explanations for this noticeable disagreement , the most plausible ones being the different functional forms of the rest mass density used in the wave extraction method , and the different formulations ( stress formulation  ( [ eq : i_ij_sf_3d ] ) versus first moment of momentum density formulation  ( [ eq : i_ij_fmomdf_3d ] ) ) . by comparing waveforms obtained from evolutions of oscillating neutron stars ( as presented in  @xcite ) , both using the quadrupole formula and by directly reading off metric components , they find that the quadrupole formula underestimates the wave amplitude of model @xmath380 by @xmath381 . extrapolating these results they arrive at the estimate that the waveforms presented in  @xcite are accurate at best to within @xmath382 . shibata and sekiguchi claim that other differences , namely the cfc approximation versus the bssn formulation , different grid setups , coordinate choices and slicing conditions , or the small discrepancy of @xmath383 in the initial model , have only negligible impact on the waveform .    to test this conjecture , we have simulated the evolution of model scc with our new version of the cfc code in 2d , and extracted the wave amplitude @xmath384 using the first moment of momentum density formulation  ( [ eq : i_ij_fmomdf_3d ] ) with @xmath11 , and also alternatively substituting @xmath11 by @xmath385 . as our results show ( see upper panel of fig .",
    "[ fig : comparison_with_shibata_waveform_2d ] ) , the use of @xmath385 results in a small increase of @xmath384 by about 20% during the bounce and the ringdown phase , limiting possible deviations due to the difference in the quadrupole formula stated in  @xcite to about 20% . however , the results depicted in fig .  [ fig : comparison_with_shibata_waveform_2d ] exclude that the doubling of @xmath384 observed by  @xcite for the ringdown signal is due to the wave extraction method . on the contrary , comparing the waveforms for model scc and @xmath380 ( see lower panel of fig .  [",
    "fig : comparison_with_shibata_waveform_2d ] ) , both computed with our cfc method , shows that the strong qualitative difference found by shibata and sekiguchi is clearly due to the differences in the core collapse initial model , notably the small decrease of the differential rotation length scale @xmath383 in model @xmath380 .",
    "this gives rise to an approximately 50% higher peak value of the amplitude during bounce , and a strong increase of the post bounce wave amplitude , as also observed by shibata and sekiguchi ( compare with fig .  13  ( b ) in  @xcite ) .",
    "= 8.6 cm    furthermore , from the evolution of the central density computed with our code ( see fig .  [",
    "fig : comparison_with_shibata_central_density_2d ] ) , it is evident that model @xmath380 exhibits significantly stronger ringdown oscillations than model @xmath386 with a somewhat longer damping timescale , which is also in good agreement with the results in  @xcite ( see their fig .  7  ( b ) ) .",
    "clearly the small difference in the rotation length parameter @xmath383 of the initial model has a major impact on the post - bounce dynamics of the dense core , which is in turn reflected in the gravitational wave signal .",
    "we have also simulated the evolution of models scc and @xmath380 using a larger number of radial and meridional grid points ( @xmath387 and @xmath388 with a central radial resolution @xmath389 ) as compared to the standard grid setup with @xmath140 , @xmath350 , and @xmath390 ( in either case the spectral grid resolution is @xmath139 and @xmath278 ) .",
    "neither improving the resolution of the finite difference grid nor discarding a significant mass fraction in the outer parts of the star ( to mimic the mass loss introduced by the regridding method in  @xcite ) have a significant impact on the collapse dynamics or the waveform for both initial models . when simulating the _ same _ collapse model , the observed small differences to shibata and sekiguchi s results in e.g.  the central density or the waveform are most likely due to the use of the cfc approximation for the spacetime metric employed in our code . nevertheless , for core collapse simulations , the results obtained using either cfc or the full einstein equations agree remarkably well .",
    "while the previous tests were all restricted to 2d ( and thus solvers  1 and  2 could as well be used ) , the genuine 3d properties of the spectral metric solver  3 can be fully exploited and tested when applied to the computation of the metric for a nonaxisymmetric configuration . for this purpose",
    "we consider now the uniformly rotating neutron star initial model rns ( see section  [ subsubsection : convergence_2d ] ) to which we add a nonaxisymmetric perturbation .",
    "this is done by generalizing the expressions in eq .",
    "( [ eq : perturbation_metric_test_2d ] ) through the multiplication of a @xmath105-dependent term of the form @xmath391 .",
    "the effect of such a perturbation on representative quantities is depicted in fig .",
    "[ fig : rns_perturbation_3d ] . the metric equations  ( [ eq : ln_phi_alpha_metric_equation ] )",
    "are then integrated using solver  3 .",
    "convergence is reached after about 50 iterations ( threshold value @xmath320 ) , and the solution for the metric is interpolated from the spectral to the finite difference grid .",
    "= 8.6 cm    to exclude convergence to an incorrect solution and errors within the interpolation routine , we compare the left and right hand sides , @xmath392 and @xmath393 , of selected metric components @xmath87 on the finite difference grid , in fig .",
    "[ fig : rns_metric_sides_3d ] .",
    "we note that in this figure , along each of the profile directions , the two other coordinates are kept fixed ( @xmath394 , @xmath395 , and @xmath232 , respectively ) .",
    "the left and right hand sides of the metric equations  ( [ eq : ln_phi_alpha_metric_equation ] ) for the conformal factor @xmath396 and the shift vector components @xmath397 and @xmath398 , when evaluated on the finite difference grid , match very accurately along all three coordinate directions .",
    "the largest deviations are found near the rotation axis ( @xmath399 ) for @xmath400 .",
    "= 8.6 cm    the accuracy of the metric calculation can be better quantified by plotting the relative difference of the left and right hand sides , @xmath401 , rather than @xmath402 and @xmath393 alone .",
    "this is shown for the metric quantities @xmath77 , @xmath397 , and @xmath403 in the insets of fig .",
    "[ fig : rns_metric_sides_3d ] . along any of the plotted profiles ,",
    "the spectral solver yields a solution for which the relative difference measure is better than @xmath404 .",
    "as @xmath402 and @xmath393 contain second spatial derivatives of the metric , evaluated by finite differencing , this is an accurate numerical result .",
    "we note that some of the metric components are close to zero or change sign .",
    "hence , the relative difference may become large or develop a pole at some locations , as can be seen in the insets of fig .",
    "[ fig : rns_metric_sides_3d ] .",
    "under idealized conditions ( i.e.  without discontinuities in the source terms of the metric equations , no artificial atmosphere , only laminar matter flows , uniform grid spacing of the finite difference grid , and perturbations which are regular at the grid boundaries ) , such a test case also offers an opportunity to examine the order of convergence of the metric solver  3 on the spectral and finite difference grid , respectively . to this end",
    "we perform a metric calculation using increasingly finer resolutions on the two grids . by varying the number of spectral collocation points in all three spatial directions",
    "while keeping the number of finite difference grid points fixed ( at high resolution ) , we observe an exponential decrease of the relative differences @xmath405 between the left and right hand sides of the equation for the various metric components @xmath87 .",
    "correspondingly , the metric solution evaluated on the finite difference grid exhibits second order convergence with grid resolution for a fixed ( and high ) spectral grid resolution .",
    "furthermore , the ( at least ) second order accurate time integration scheme of the code in combination with the ppm reconstruction of the riemann solver also guarantees second order convergence during time evolution . for fixed time steps",
    "we actually observe this theoretical convergence order globally and even locally ( except close to the grid boundaries , where symmetry conditions and ghost zone extrapolation spoil local convergence ) .    in the three - dimensional case the computational load of the interpolation from the spectral grid to the finite difference grid",
    "after every metric calculation on the spectral grid becomes significant .",
    "the time spent in the interpolation between grids can , in fact , even surpass the computational costs of the spectral metric solution itself ( see section  [ subsection : interpolation_tests ] ) . as a consequence , the independence of the metric execution time @xmath322 on the number of finite difference grid points found in the axisymmetric case ( as shown in table  [ tab : runtime_metric_solver_2d ] ) can not be maintained .",
    "table  [ tab : runtime_metric_solver_3d ] reports the summary of runtime results for a single metric computation of the above neutron star model on an ibm rs/6000 power4 processor .",
    "these results indicate an ( albeit sublinear ) increase of @xmath322 with the number of finite difference grid points . as expected , a doubling of the spectral grid resolution e.g.  in the @xmath105-direction ( while keeping @xmath139 and @xmath278 fixed ) results in a proportional increase of @xmath322 .",
    "the runtime scaling results reported in table  [ tab : runtime_metric_solver_3d ] also demonstrate that the different coordinate directions contribute equally to the computational costs .",
    "c@  |rrr@  |rrrr@   & & + @xmath197 & & & & & & & +    ' '' ''    @xmath406 & 37.2 & & & 71.5 & & & 2.0 + @xmath407 & 39.9 & 1.1 & & 77.8 & 1.1 & & 2.0 + @xmath408 & 47.4 & 1.2 & & 90.6 & 1.2 & & 1.9 + @xmath409 & 62.3 & 1.3 & & 116.1 & 1.3 & & 1.9 + [ 0.7 em ] @xmath410 & 48.3 & & 1.3 & 90.7 & & 1.3 & 1.9 + @xmath411 & 62.5 & 1.3 & 1.6 & 116.6 & 1.3 & 1.5 & 1.9 + @xmath412 & 92.0 & 1.5 & 1.9 & 166.2 & 1.4 & 1.8 & 1.8 + @xmath413 & 149.9 & 1.6 & 2.4 & 269.5 & 1.6 & 2.3 & 1.8 + & + @xmath197 & & & +    ' '' ''    @xmath414 & 20.5 & & + @xmath415 & 21.7 & &    it is worth pointing out that the other two metric solvers we have available in the code fail to compute the metric for the nonaxisymmetric neutron star configuration considered in this section due to the known limitations ( excessive computing time for solver  1 , convergence problems for solver  2 ) .",
    "an important requirement for any hydrodynamics code is the preservation of the symmetry of an initially symmetric configuration during time evolution . in a practical application",
    "this means that if a small perturbation is added to symmetric and _ stable _ initial data , the perturbation amplitude must not grow in time .",
    "due to the choice of spherical polar coordinates @xmath416 , our code is particularly well suited to test the preservation of the symmetry of spherically symmetric and axisymmetric initial data .",
    "additionally , this coordinate choice implies that when simulating axisymmetric or spherically symmetric problems , either one or two dimensions can be trivially suppressed , respectively , which results in considerable savings of computational time .",
    "next , we present results from the evolution of both a spherically symmetric neutron star model ( labeled sns ) and the axisymmetric rapidly rotating neutron star model rns .",
    "model sns has the same central density and eos as model rns described in section  [ subsubsection : convergence_2d ] . to each equilibrium model sns and",
    "rns we respectively add an axisymmnetric @xmath417- and a nonaxisymmetric @xmath416-dependent three - velocity perturbation of the form @xmath418      v_\\theta & = & \\displaystyle      0.02 \\sin^2 \\ !",
    "\\left ( \\ !",
    "\\pi \\frac{r}{r_{\\rm s } } \\right )      a \\sin^2 ( 2 \\theta ) ,    \\end{array }    \\label{eq : preservation_of_symmetry_perturbation_2d}\\ ] ] and    v_r & = & 0.02 ^2 ( ) ( 1 + ^2 ( 2 ) ) ( 1 + a ^2 ) , + v _ & = & 0.02 ^2 ( ) ^2 ( 2 ) ( 1 + a ^2 ) , [ eq : preservation_of_symmetry_perturbation_3d ] + v _ & = & v_ini + 0.02 ^2 ( ) ( 1 + ^2 ( 2 ) ) ( 1 + a ^2 ) ,    respectively , where @xmath419 is the perturbation amplitude .",
    "model sns is then evolved in time using the code in axisymmetric 2d mode , and model rns using the fully 3d capabilities of the code .",
    "the metric is calculated every 100 ( 300 ) time steps in 2d ( 3d ) and extrapolated in between .",
    "the number of finite difference grid zones is @xmath420 , @xmath421 , @xmath422 in the 2d case and @xmath420 , @xmath421 , @xmath423 in the 3d case .",
    "correspondingly , for the spectral grid we use @xmath424 , @xmath425 , @xmath223 in 2d , and @xmath424 , @xmath425 , @xmath426 in 3d .",
    "= 8.6 cm    the results of the evolution of the symmetry violating perturbations in both models are depicted in fig .",
    "[ fig : preservation_of_symmetry_ns ] .",
    "the upper panels correspond to model sns which is evolved up to 5 ms , while the bottom panels correspond to model rns which is only evolved up to 1 ms .",
    "the left and right panels differ by the value of the initial amplitude @xmath419 of the velocity perturbation .",
    "we observe that the perturbation amplitude , measured as the relative difference @xmath427 of an arbitrary matter or metric quantity @xmath428 evaluated at two points of constant @xmath97 ( for model sns ) and constant @xmath429 ( for model rns ) , remains practically unchanged for many hydrodynamic time scales .",
    "note that the spikes in @xmath427 appearing in fig .",
    "[ fig : preservation_of_symmetry_ns ] are the poles associated with a vanishing @xmath428 .",
    "[ fig : preservation_of_symmetry_ns ] also shows that the amplitude of the symmetry violation @xmath427 approximately scales with the amplitude @xmath419 of the initial velocity perturbation ( indicated by horizontal dotted lines ) .    in the course of many hydrodynamic time scales , the perturbations ( which are of small amplitude , @xmath430 ) will be finally damped due to the intrinsic numerical viscosity of the schemes implemented in the code .",
    "however , if the rotation rate @xmath431 of a rotating neutron star were high enough such that @xmath432 or even @xmath433 , perturbations of the form given by eq .",
    "( [ eq : preservation_of_symmetry_perturbation_3d ] ) could trigger the onset of _ physically _ growing modes , leading to bar mode instabilities .",
    "the ability to handle long - term evolutions of rapidly rotating relativistic equilibrium configurations is a difficult test for any numerical code . to demonstrate the capabilities of our code to pass this stringent test we evolve",
    "the rotating neutron star initial model rns in 3d until @xmath434 , which corresponds to about 10 hydrodynamic time scales and rotation periods .",
    "the simulation is performed with a resolution for the finite difference grid of @xmath435 , @xmath350 , @xmath436 , and @xmath139 , @xmath278 , @xmath426 for the spectral grid . during the evolution ,",
    "the metric is calculated every 100 time steps and extrapolated in between .",
    "= 8.6 cm    the preservation of the radial profile of the rotation velocity @xmath437 along the equator over a long evolution time is shown in fig .  [",
    "fig : axisymmetric_oscillating_rns_profile_3d ] .",
    "depicted is the initial equilibrium solution ( solid line ) as a function of the radial coordinate ( in the equatorial plane ) and the final configuration ( dashed line ) , after an evolution time of 10  ms ( about 10 rotational periods ) .",
    "the figure shows that @xmath438 remains close to its initial value in the interior of the star , showing the strongest ( but still small ) deviations near the stellar surface ( at the interface to the artificial atmosphere ) .",
    "this local decrease of @xmath438 due to interaction of stellar matter with the atmosphere and its depencence on the order of the reconstruction scheme has also been observed in other studies ( see e.g.  @xcite ) .",
    "it is important to emphasize that the accurate preservation of the rotational profile is achieved because of the use of third - order cell - reconstruction schemes for the hydrodynamics equations , such as ppm , as first shown by  @xcite . despite the comparably coarse resolution of the finite difference grid and the use of the cfc approximation for the gravitational field equations , our code captures the profile of @xmath437 at the stellar boundary about as accurately as codes solving the full einstein metric equations coupled to the hydrodynamics equations  @xcite , or codes restricted to hydrodynamic evolutions in a fixed curved spacetime ( i.e.  using the so - called cowling approximation )  @xcite .",
    "long - term evolutions of rotating neutron stars as the one presented here can be effectively used for extracting the oscillation frequencies of the various pulsation eigenmodes of the star .",
    "this topic has been traditionally studied using perturbation theory ( see e.g.  @xcite and references therein ) . in recent years fully nonlinear hydrodynamical codes have helped to drive progress in the field . they have provided the quasi - radial mode - frequencies of rapidly rotating relativistic stars , both uniformly and differentially rotating , which is a problem still not amenable to perturbation techniques ( see e.g.  @xcite ) .    in order to test our code against existing results",
    "we show next an example of the procedure to compute mode - frequencies using the model rns .",
    "the frequencies can in principle be extracted from a fourier transform of the time evolution of various pulsating quantities when the oscillations are triggered by numerical truncation errors .",
    "however , the results significantly improve when a perturbation of some specific parity is added to the initial equilibrium model . to excite small amplitude quasi - radial oscillations",
    ", we hence apply an @xmath439 radial velocity perturbation to the equilibrium configuration of the form @xmath440 with an amplitude @xmath441 .",
    "= 8.6 cm    due to this perturbation , various metric and hydrodynamic quantities exhibit very regular periodic oscillations around their equilibrium state , as shown for the radial velocity @xmath316 in fig .",
    "[ fig : axisymmetric_oscillating_rns_2d_and_3d ] .",
    "the pulsations , which show no noticeable numerical damping during the entire duration of the simulation ( 10 ms ) , are extracted at half the stellar equatorial radius .",
    "the same oscillation pattern is obtained when instead of using the 3d code ( solid line in the figure ) the model is evolved using the code in axisymmetric mode ( dashed line in fig .  [",
    "fig : axisymmetric_oscillating_rns_2d_and_3d ] with finite difference grid size of @xmath442 , @xmath388 ) .",
    "the latter , axisymmetric setup is currently being used in a comprehensive parameter study of the oscillation frequencies of rotating neutron star models  @xcite .",
    "note that fig .",
    "[ fig : axisymmetric_oscillating_rns_2d_and_3d ] also demonstrates that the oscillation amplitude scales linearly with the initial perturbation amplitude @xmath419 ( at least if @xmath430 ) , which was chosen as @xmath443 in the 2d simulations . in the radial velocity ,",
    "neither an offset nor a noticeable drift with time can be observed .",
    "this is in agreement with previous results using alternative formulations and different numerical codes  @xcite .",
    "l|@l@r@l@r|@l@r@l@r@ & & + & & + [ 0.7 em ] code & & & & +    ' '' ''    current ( 3d ) & 1.40 & ( 3.4 ) & 3.95 & ( 0.2 ) & 1.20 & ( 0.4 ) & 3.68 & ( 1.0 ) + current ( 2d ) & 1.463 & ( 0.9 ) & 3.951 & ( 0.2 ) & 1.219 & ( 2.0 ) & 3.659 & ( 1.6 ) + cactus & 1.450 & & 3.958 & & 1.195 & & 3.717    time evolution data like the one shown in fig .",
    "[ fig : axisymmetric_oscillating_rns_2d_and_3d ] can be used to extract the eigenmode frequencies . a fourier transformation of different metric and hydrodynamic quantities at various locations in the star yields identical ( discrete ) frequencies .",
    "table  [ tab : axisymmetric_oscillating_ns_frequencies_3d ] summarizes the frequencies @xmath444 and @xmath445 for the quasi - radial fundamental mode and its first harmonic overtone , respectively .",
    "both frequencies obtained with the current 3d code differ only by a few percent from those computed with the code in 2d  @xcite or the cactus code , which is based on a cartesian grid and uses the bssn formulation for the einstein equations  @xcite .",
    "additionally , we have investigated the influence of grid resolution and finite evolution time on the accuracy of the frequency extraction .",
    "we have found that the differences in the frequencies between the 2d and 3d simulations presented in table  [ tab : axisymmetric_oscillating_ns_frequencies_3d ] can be almost entirely attributed to the twice as long evolution time of the 2d simulation ( 20 ms ) , for which the fourier transformation renders more accurate frequencies . for practical evolution times of several tens of milliseconds and for grid resolutions better than @xmath358 and @xmath359 ,",
    "the extracted oscillation frequencies are almost independent of the number of grid points used .",
    "note also that the mode - frequencies agree well even though we have used different perturbation amplitudes @xmath419 in the 3d and 2d simulations ( while in the cactus run an @xmath439 rest mass density perturbation with an amplitude @xmath446 was used ) .",
    "table  [ tab : axisymmetric_oscillating_ns_frequencies_3d ] hence proves that our code is able to simulate rotating neutron stars in a fully three - dimensional context for sufficiently long time scales to successfully extract oscillation frequencies .",
    "contrary to the small amplitude nonaxisymmetric perturbations employed in section  [ subsubsection : stability_of_symmetry ] , we turn now to assess the ability of the numerical code to manage long - term stable evolutions of strongly gravitating systems with large departures from axisymmetry .",
    "this is an essential test for future astrophysical applications of the code as e.g.  the numerical investigation of bar mode instabilities in rotating neutron stars .    for this purpose",
    "we construct a uniformly rotating neutron star model with the same parameters as model rns , but with only half the central density .",
    "the finite difference grid extends out to @xmath447 , with 60 equidistant radial grid points resolving the neutron star out to @xmath448 .",
    "the atmosphere is covered by 80 logarithmically spaced radial grid points .",
    "the number of angular zones used in the finite difference grid is @xmath449 and @xmath450 , respectively , while the spectral grid has @xmath277 , @xmath425 , and @xmath451 grid points in 3 radial domains .",
    "= 18.0 cm    on top of the equilibrium neutron star model we add a strongly nonaxisymmetric ( i.e.  @xmath105-dependent ) perturbation of the rest - mass density @xmath452    \\sin^{10 } \\varphi    \\quad    \\mbox{for } r \\le 2 r_{\\rm s } ,    \\label{eq : nonaxisymmetric_neutron_star_perturbation}\\ ] ] with an amplitude @xmath453 , which yields an @xmath454 bar - like structure .",
    "the rotation velocity of the uniformly rotating unperturbed neutron star is extrapolated into the areas filled with matter by the perturbation .",
    "the initial configuration with the perturbation added is shown in the left panel of fig .",
    "[ fig : nonaxisymmatric_rns_3d_density ] .",
    "we have chosen this particular ( albeit unphysically strong ) perturbation and velocity field in order to prevent both , an immediate accretion of the added matter bars on to the neutron star or an ejection .",
    "this allows us to follow the rotation of the neutron star for a time comparable to its rotation period ( which is about 1  ms for the unperturbed neutron star ) . the density and rotation velocity plots in fig .",
    "[ fig : nonaxisymmatric_rns_3d_density ] after @xmath455 ( center panel ) and @xmath456 ( right panel ) prove this property of the chosen perturbation .",
    "these plots also demonstrate that the corotating bar structures slowly disappear .",
    "the innermost parts are being gradually accreted by the neutron star , which leads to a significant initial rise in the central density , as shown in fig .",
    "[ fig : nonaxisymmatric_rns_3d_central_density ] . at later times",
    "the more massive neutron star oscillates with a period of @xmath457 around a new quasi - equilibrium state , which possesses a central density of more than 50% above the initial equilibrium central density . despite this strong interaction of the bar perturbation with the neutron star , the rotation _ profile _ inside the neutron star remains uniform throughout the evolution , although the rotation _ velocity _ nearly doubles during the oscillation maxima .",
    "this behavior is most likely due to the particular choice of a uniform rotation profile for the initial bar perturbation .",
    "for the outer parts of the initial bar , the increasing distance from the neutron star and the sufficiently high specific angular momentum prevents their accretion onto the neutron star .",
    "thus the matter in this region of the bar drifts to larger radii during the evolution . as on the dynamical timescales considered of one rotation period",
    "there is no efficient transport mechanism of local angular momentum by viscous effects ( which act on much longer timescales ) , the evolution leads to the development of spiral arms which are clearly visible in the middle and right panels of fig .",
    "[ fig : nonaxisymmatric_rns_3d_density ] .",
    "the outer parts of these arms are centrifugally expelled from the finite difference grid , crossing the outer boundary at @xmath458 . by the end of the simulation , at @xmath459",
    ", there is neither significant backscattering of matter from the outermost boundary of the radial grid , nor there are numerical artifacts visible at the leading or trailing edges of the spiral arms .",
    "this proves that our numerical treatment of the radial boundary conditions and of the artificial low density atmosphere surrounding the star have the desired behavior .",
    "= 8.6 cm    fig .",
    "[ fig : nonaxisymmatric_rns_3d_central_density ] shows that already after an evolution time of @xmath460 , the evolution of the spiral arms has no further significant impact in the dynamics of the neutron star , as then the slowly decaying oscillation around the final equilibrium state exhibits a rather regular ring - down pattern .",
    "plotted in this figure is also the time evolution of the central density for a model with an amplitude @xmath461 of the initial perturbation given by eq .",
    "( [ eq : nonaxisymmetric_neutron_star_perturbation ] ) ( dashed line ) .",
    "in addition , the dashed - dotted line shows the corresponding time evolution of @xmath462 for an unperturbed model ( the small amplitude oscillations are in this case triggered by the truncation errors of the numerical schemes and by the use of the cfc approximation in the evolution code ) .",
    "the similarity in the behavior of @xmath462 in these cases demonstrates that for perturbations with an amplitude @xmath463 , the dynamics of the central neutron star is virtually unaffected by the initial bar and by the spiral arms forming at later times .",
    "however , we observe that also for small values of @xmath419 spiral arms develop which are stable over many rotation periods .",
    "= 8.6 cm    apparently , strong nonaxisymmetric perturbations of the form  ( [ eq : nonaxisymmetric_neutron_star_perturbation ] ) give rise to significant gravitational wave emission .",
    "the waveforms of the nonzero gravitational wave amplitudes @xmath384 , @xmath464 , and @xmath465 ( as shown in the upper , center , and lower panel of fig .",
    "[ fig : nonaxisymmatric_rns_3d_waveform ] , respectively ) exhibit peak values of up to @xmath466 for the model with a perturbation amplitude @xmath453 ( solid lines ) . in fig .",
    "[ fig : nonaxisymmatric_rns_3d_waveform ] we also present the waveforms for the model with a bar perturbation of amplitude @xmath461 ( dashed lines ) . their amplitudes are roughly a factor 10 smaller than those of the corresponding waveforms of the model with @xmath453",
    ". thus we can infer that the gravitational radiation amplitude approximately scales with @xmath419 .",
    "we emphasize that owing to the particular form of the perturbation  ( [ eq : nonaxisymmetric_neutron_star_perturbation ] ) , the @xmath467-mode of the gravitational radiation is zero at the equator , @xmath468 .",
    "we also note that if instead of the nonaxisymmetric perturbation in eq .",
    "( [ eq : nonaxisymmetric_neutron_star_perturbation ] ) we use an axisymmetric one , @xmath469",
    "\\quad    \\mbox{for } r \\le 2 r_{\\rm s } ,    \\label{eq : axisymmetric_neutron_star_perturbation}\\ ] ] then the @xmath467-mode of gravitational radiation vanishes completely , and only the @xmath470-mode is present ( dashed - dotted line in the upper panel of fig .",
    "[ fig : nonaxisymmatric_rns_3d_waveform ] ) .",
    "additionally , in axisymmetry the @xmath470-mode on the pole is always zero , @xmath471 .",
    "we point out that the waveform pattern for the model with the @xmath453 bar perturbation in fig .",
    "[ fig : nonaxisymmatric_rns_3d_waveform ] does not solely reflect the oscillation and ring - down structure of the central neutron star , as visible in the time evolution of @xmath472 in fig .",
    "[ fig : nonaxisymmatric_rns_3d_central_density ] . for instance",
    "the @xmath470-mode at the equator ( upper panel ) decays on a much longer time scale than the corresponding ring - down time of @xmath472 . on the other hand , the waveforms for the two polarizations of the radiation at the pole exhibit their peaks during the first oscillation of @xmath472 and then decay rapidly ( center and lower panel )",
    "however , after an evolution time of @xmath473 their amplitudes increase again . from this behavior",
    "we deduce that initially the waveform signal is dominated by the gravitational wave emission from the oscillating neutron star .",
    "as this contribution decays during the ring - down , the wave emission from spiral arms becomes increasingly important .",
    "as they expand into the atmosphere the radial weight arm in the quadrupole formula compensates for the relatively low density of the spiral arms , and the radiation emitted in this region becomes visible in the signal .",
    "we can not clearly attribute the late - time increase in the waveform amplitude to the onset of a bar mode instability , because the rotation parameter @xmath431 of our model clearly falls short of the approximate threshold for dynamical growth of bar modes : @xmath474 .",
    "we plan to investigate this issue more thoroughly in the future .",
    "the maximum amplitude @xmath475 of the wave signal for @xmath453 corresponds to a dimensionless gravitational wave amplitude @xmath476 at a distance of @xmath477 to the source .",
    "thus , in this case of a strongly nonaxisymmetric artificial perturbation , the typical wave amplitudes have a value of roughly one order of magnitude above the ones of waveforms obtained from the simplified models of rotational supernova core collapse in axisymmetry by dimmelmeier et al .  @xcite . for the waveforms plotted in fig .",
    "[ fig : nonaxisymmatric_rns_3d_waveform ] we utilize the stress formula  ( [ eq : i_ij_sf_3d ] ) with @xmath385 as density .",
    "the use of this formula efficiently reduces the numerical noise in the signal as compared with the first moment of momentum density formula and particularly with the standard quadrupole formula .",
    "we consider the grid resolution used in this test simulation to be the minimal one required for obtaining reasonably converged results . by repeating the same model with different grid resolutions we are able to estimate that the waveform amplitudes are correctly computed within @xmath478 accuracy .",
    "in this paper we have presented a new three - dimensional general relativistic hydrodynamics code which is primarily intended for applications of stellar core collapse to a neutron star or a black hole , as well as for studies of rapidly rotating relativistic stars which may oscillate in their quasi - normal modes of pulsation , emitting gravitational radiation , or which may be subject to nonaxisymmetric instabilities .",
    "the main novelty of this code compared to other existing numerical relativistic codes is that it _ combines _ very accurate state - of - the - art numerical methods specifically tailored to solve the general relativistic hydrodynamics equations on the one hand , and the gravitational field equations on the other hand .",
    "more precisely , the hydrodynamic equations , formulated in conservation form , are solved using high - resolution shock - capturing schemes based upon approximate riemann solvers and third - order cell - reconstruction interpolation procedures , while the elliptic metric equations are solved using an iterative nonlinear solver based on spectral methods .",
    "furthermore , the present code also departs noticeably from other three - dimensional codes in the coordinate system used in the formulation of the equations and in the discretization . in our approach",
    "both the metric and the hydrodynamics equations are formulated and solved numerically using spherical polar coordinates . in the present investigation we have adopted the so - called conformal flatness approximation of the einstein equations , which reduces them to a set of five elliptic nonlinear equations , particularly suited for the use of spectral methods . recently , constrained formulations of the full einstein equations in which elliptic equations have a preeminence over hyperbolic equations have been reported , and appear to be amenable to the current code .    the main purpose of the paper has been to assess the code by demonstrating that the combination of the finite difference grid and the spectral grid , on which the hydrodynamics and metric equations are respectively solved , can be successfully accomplished .",
    "this approach , which we call _ mariage des maillages _",
    "( french for grid wedding ) , results in high accuracy of the metric solver and , in practice , has allowed for fully three - dimensional applications using computationally affordable resources , along with ensuring long term numerical stability of the evolution . to facilitate the _ mariage des maillages _ ,",
    "i.e.  the combination of the finite difference grid for the hydrodynamic solver and the spectral grid for the metric solver , a sophisticated interpolation and grid communication scheme has been used .",
    "in addition , we have compared our novel approach to two other , finite difference based , methods to solve the metric equations , which we already employed in earlier axisymmetric investigations  @xcite .",
    "we have presented a variety of tests in two and three dimensions , involving neutron star spacetimes and stellar core collapse .",
    "axisymmetric simulations have also been performed to compare core collapse to neutron stars using the cfc approximation and full general relativity , for which only very recently results have become available  @xcite .",
    "this comparison has shown the suitability of the conformally flat approximation for such mildly relativistic scenarios .",
    "furthermore , the code has succeeded in simulating the highly perturbed nonaxisymmetric configuration of a uniformly rotating neutron star for several dynamical times .",
    "this simulation has also been used to assess the 3d gravitational waveform extraction capabilities of the code . in summary the numerical experiments reported in the paper demonstrate the ability of the code to handle spacetimes with and without symmetries in strong gravity . in future work",
    "we plan to apply this code to simulations of stellar core collapse to neutron stars or black holes in three dimensions , and particularly to studies of the nonlinear development of bar mode instabilities in rapidly rotating neutron stars .",
    "this work is dedicated to the memory of jean - alain marck who envisaged long ago , together with s.  bonazzola and j.m .",
    "ibez , the potentiality of the numerical approach presented here .",
    "we gratefully thank e.  gourgoulhon and s.  bonazzola for stimulating discussions and a careful reading of the manuscript .",
    "the simulations have been performed at the max - planck - institut fr astrophysik in garching , germany , and at the laboratoire de lunivers et de ses thories at the observatoire de paris in meudon , france .",
    "h.d .  and e.m.acknowledge financial support from the sfb / transregio  7 `` gravitationswellenastronomie '' by the dfg ; j.a.f .  and j.m.i.acknowledge financial support from the spanish ministerio de ciencia y tecnologa ( grant aya 2001 - 3490-c02 - 01 ) .",
    "in the axisymmetric cfc code presented in  @xcite the source terms @xmath479 for the hydrodynamic momentum equations ( euler equations ) were evaluated on the finite difference grid using a formulation containing time derivatives and explicit christoffel symbols ( see equation  ( [ eq : hydro_conservation_equation_constituents ] ) ) : @xmath480 using the relation between the christoffel symbols and the derivatives of the spacetime metric , @xmath481 the sources @xmath479 can be written in a more compact form as @xmath482 in this formulation , only _",
    "spatial _ derivatives of the metric are needed , and the numerical evaluation of @xmath479 involves significantly fewer terms , making a numerical implementation both faster and more accurate . for these reasons , we have preferred the use of equation  ( [ eq : compact_sources ] ) to equation  ( [ eq : noncompact_sources ] ) in the code presented in this paper .      as emphasized in section  5.4 in  @xcite , the conserved hydrodynamic quantity in the system of conservation equations  ( [ eq : hydro_conservation_equation ] )",
    "is not simply the state vector @xmath483 but rather @xmath484 with @xmath485 .",
    "therefore , if only the state vector @xmath483 is evolved , this gives rise to an additional source term @xmath486 which contains time derivatives of the conformal factor @xmath77 .",
    "these generally time - dependent source terms result in a variation of the volume - integrated state vector with time , and thus in a violation of exact numerical rest mass and angular momentum conservation of several percent , even though the `` physical '' sources vanish , @xmath487 ( see figs .  9 and  10 in ref .",
    "@xcite ) .",
    "it is not possible to evolve @xmath484 in a straightforward way and then consistently solve the elliptic metric equations  ( [ eq : metric_equations ] ) on the new time slice .",
    "this is due to the fact that the sources for these equations contain the pressure @xmath13 , which can only be extracted from @xmath483 but not from @xmath484 .",
    "however , one can make use of the time evolution equation for the conformal factor , eq .",
    "( [ eq : phi_time_evolution ] ) , to obtain an auxiliary value for @xmath77 and thus for @xmath488 on the new time slice . with this",
    "the state vector @xmath483 can be consistently calculated from @xmath484 after the time evolution step to the new time slice , which in turn is used in the sources of the metric equations  ( [ eq : metric_equations ] ) .",
    "these are subsequently solved on the new time slice . with the help of this reformulation of the hydrodynamic time evolution problem in the current code ( in combination with the compact time - independent form for the sources in the euler equations , eq .",
    "( [ eq : compact_sources ] ) ) , we are able to achieve exact numerical conservation of the total rest mass and angular momentum up to machine roundoff errors , provided that there is no artificial atmosphere and no mass flow across the outer radial grid boundary .",
    "the results for the evolution of the central density @xmath462 and the waveform for the core collapse model scc ( a3b2g4 in  @xcite ) presented in this paper slightly differ from those reported in the previous paper by dimmelmeier et al .",
    "this is partly due to the improvements related to evaluating the euler equation source terms in compact form and using exact numerical conservation in the new code , as discussed above .",
    "however , the main reason for the small discrepancy is that in the simulations in  @xcite a symmetric boundary condition for the shift vector component @xmath321 across the equatorial plane was chosen .",
    "this leads to a nonzero value for @xmath321 at @xmath489 close to and after core bounce , i.e.  when meridional motions set in . as a consequence of this ,",
    "the deviation is stronger for models where rotation plays a significant role in the collapse dynamics .",
    "the physically accurate antisymmetric equatorial boundary condition for @xmath321 which is used in the present code , systematically yields lower post - bounce values for @xmath462 in regular collapse type models compared to the simulations presented in  @xcite , with a difference of 11% on average . for models which show multiple bounce behavior ,",
    "we obtain a lower @xmath462 also at core bounce .    accordingly , the waveform amplitudes and frequencies of the gravitational radiation are altered by a small amount ( -11% for @xmath490 and -18% for @xmath491 ) . despite of these small quantitative changes , the qualitative statements related to the influence of general relativistic effects in rotational core collapse made by dimmelmeier et al .",
    "@xcite remain unaffected , even when the antisymmetric boundary condition is used .",
    "we particularly emphasize that the change in the boundary condition for @xmath321 plays no role when comparing our results with the fully general relativistic simulations by shibata and sekiguchi  @xcite discussed in section  [ subsubsection : comparison_with_full_gr ] .",
    "we note that for all core collapse models presented in the parameter study by dimmelmeier et al .",
    "@xcite , results obtained with the new boundary condition for @xmath321 can be found in the revised waveform catalogue  @xcite ."
  ],
  "abstract_text": [
    "<S> we present a new three - dimensional general relativistic hydrodynamics code which is intended for simulations of stellar core collapse to a neutron star , as well as pulsations and instabilities of rotating relativistic stars . </S>",
    "<S> contrary to the common approach followed in most existing three - dimensional numerical relativity codes which are based in cartesian coordinates , in this code both the metric and the hydrodynamics equations are formulated and solved numerically using spherical polar coordinates . </S>",
    "<S> a distinctive feature of this new code is the combination of two types of accurate numerical schemes specifically designed to solve each system of equations . </S>",
    "<S> more precisely , the code uses spectral methods for solving the gravitational field equations , which are formulated under the assumption of the conformal flatness condition ( cfc ) for the three - metric . </S>",
    "<S> correspondingly , the hydrodynamics equations are solved by a class of finite difference methods called high - resolution shock - capturing schemes , based upon state - of - the - art riemann solvers and third - order cell - reconstruction procedures . </S>",
    "<S> we demonstrate that the combination of a finite difference grid and a spectral grid , on which the hydrodynamics and metric equations are respectively solved , can be successfully accomplished . </S>",
    "<S> this approach , which we call _ mariage des maillages _ </S>",
    "<S> ( french for grid wedding ) , results in high accuracy of the metric solver and , in practice , allows for fully three - dimensional applications using computationally affordable resources , along with ensuring long term numerical stability of the evolution . </S>",
    "<S> we compare our new approach to two other , finite difference based , methods to solve the metric equations which we already employed in earlier axisymmetric simulations of core collapse . </S>",
    "<S> a variety of tests in two and three dimensions is presented , involving highly perturbed neutron star spacetimes and ( axisymmetric ) stellar core collapse , which demonstrate the ability of the code to handle spacetimes with and without symmetries in strong gravity . </S>",
    "<S> these tests are also employed to assess the gravitational waveform extraction capabilities of the code , which is based on the newtonian quadrupole formula . </S>",
    "<S> the code presented here is not limited to approximations of the einstein equations such as cfc , but it is also well suited , in principle , to recent constrained formulations of the metric equations where elliptic equations have a preeminence over hyperbolic equations . </S>"
  ]
}