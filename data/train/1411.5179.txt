{
  "article_text": [
    "heart rate variability ( hrv ) refers to the variation over time of the intervals between consecutive heartbeats .",
    "since the heart rhythm is modulated by the autonomic nervous system ( ans ) , hrv is thought to reflect the activity of the sympathetic and parasympathetic branches of the ans .",
    "the continuous modulation of the ans results in continuous variations in heart rate .",
    "one of the most powerful hrv analysis techniques is based on the spectral analysis of the time series obtained from the distances between each pair of consecutive heartbeats .",
    "the hrv power spectrum is a useful tool as a predictor of multiple pathologies @xcite , @xcite .",
    "akselrod et al .",
    "@xcite described three components in the hrv power spectrum with physiological relevance : the very low frequency ( vlf ) component ( frequencies below 0.03 hz ) , which is modulated by the renin - angiotensin system ; the low frequency ( lf ) component ( 0.03 - 0.15 hz ) , which is thought to be of both sympathetic and parasympathetic nature ; and the high frequency ( hf ) component ( 0.18 - 0.4 hz ) , which is related to the parasympathetic system . at present",
    ", there is no absolute consensus on the precise limits of the boundaries of these three bands . in the literature we can find authors who use slightly different bands boundaries @xcite .",
    "there exist several hrv spectral analysis techniques .",
    "these techniques may be classified as nonparametric and parametric @xcite .",
    "the main advantage of the nonparametric methods is the simplicity and speed of the algorithm used ( the fast fourier transform ) .",
    "the main advantage of the parametric methods is that they give smoother spectral components .",
    "however , parametric methods present problems regarding to correct model order selection .",
    "although these techniques are widely used , they have no temporal resolution .",
    "this severely limits their ability to analyze non - stationary signals and transient phenomena . to alleviate this limitation temporal windows are often used , so that small segments of the whole signal are analyzed . among these techniques we may highlight the short time fourier transform ( stft ) @xcite .",
    "however , time - frequency resolution of the stft depends on the spread of the window used .",
    "thus , the stft has fixed time - frequency resolution : high frequency resolution implies poor time resolution and vice versa .",
    "conversely to fourier , the wavelet transform performs time - frequency analysis and it is recognized as a powerful tool to study non - stationary signals @xcite .",
    "hrv analysis toolkits such as kubios hrv kubios or ahrv @xcite only enable hrv spectral analysis based on the fourier transform or parametric methods . to the best of our knowledge , the only option for using the wavelet transform in hrv analysis is to manually implement the algorithms , probably with the support of some general wavelet library .",
    "this is tedious , and prone to error .",
    "although some researchers have done this @xcite , @xcite , many more ( especially those with a medical background ) choose to use fourier - based tools , even when they know that the signal being analyzed is non - stationary . a query in the pubmed database with the terms  heart rate variability fourier transform \" returns 660 articles , while a query with the terms  heart rate variability wavelet transform \" only returns 145 articles . the lack of tools for carrying out hrv analysis using the wavelet transform has made this potentially superior analysis technique underutilized in comparison with the fourier transform .    in this paper",
    "we present an algorithm to perform hrv power spectrum analysis based on the maximal overlap discrete wavelet packet transform ( modwpt ) .",
    "the algorithm calculates the spectrogram in any frequency band , allowing a certain tolerance for the position of the band s boundaries . the algorithm has been validated over simulated and real rr series .",
    "its capability for identifying fast changes in the rr series spectral components has been compared with the stft and a windowed version of the burg method , showing that these techniques miss some transient changes that are successfully identified by the wavelet transform .",
    "we have implemented the algorithm in rhrv , an open - source package for hrv analysis publicly available on the internet .",
    "a previous version of this algorithm was published in @xcite .",
    "section [ sec : waveletreview ] starts with a brief review of the wavelet transform , with particular attention to the modwpt , and then introduces our algorithm to perform hrv power spectrum analysis .",
    "section [ sec : swdes ] provides a short description of the implementation of the algorithm in the rhrv package .",
    "section [ sec : results ] presents a comparison between our algorithm , the stft and the windowed burg method over simulated and real rr series .",
    "finally , the results of this paper are discussed and some conclusions are given .",
    "a brief review of some important wavelet concepts for our algorithm is now given .",
    "a wavelet is a small wave @xmath0 ( oscillating function ) that is well concentrated in time .",
    "this function must have unitary norm @xmath1 and verify the so - called admissibility condition : @xmath2 @xmath3 can be translated and dilated in time , yielding a set of wavelet functions :    @xmath4    where @xmath5 is a dilation factor , and @xmath6 is a real number representing the translations . as @xmath7 generates all @xmath8 functions , it is called mother wavelet .",
    "a continuous wavelet transform measures the time - frequency variations of a signal @xmath9 by correlating it with @xmath8    @xmath10    in order to make the wavelet transform implementable on a computer , both dilation and translation factors must be discretized .",
    "this can be achieved as follows : @xmath11 this family is an orthonormal basis of @xmath12 .",
    "orthogonal wavelets dilated by @xmath13 can be used to study signal variations at the resolution @xmath14 .",
    "thus , these families of wavelets originate a multiresolution signal analysis .",
    "multiresolution analysis projects signals at various resolution spaces @xmath15 .",
    "each @xmath15 space contains all possible approximations at the resolution @xmath14 .",
    "thus , each decomposition level increases the spectral resolution of the decomposition , at the expense of losing temporal resolution .",
    "let @xmath16 be a multiresolution approximation verifying @xmath17 and let @xmath18 be the orthogonal complement of @xmath15 in @xmath19 : @xmath20 . according to @xcite , the families @xmath21are an orthonormal basis for @xmath15 and @xmath18 , respectively , for all @xmath22 .",
    "@xmath23 are the wavelet functions and @xmath24  are the scaling functions .",
    "thus , we can approximate any function @xmath9 @xmath25 at resolution @xmath14 as @xmath26\\phi _ { j , n } \\label{eq : resolutionprojection}\\]]and the orthogonal projection of @xmath9 onto detail space @xmath18 is : @xmath27\\psi _ { j , n}. \\label{eq : detailprojection}\\]]where @xmath28 $ ] and @xmath29 $ ] are called the approximation and detail coefficients , respectively .",
    "mallat proved @xcite that both approximation and detail coefficients may be calculated using a filter bank .",
    "let @xmath30 $ ] and @xmath31 $ ] be the fir filters that will be used to compute the approximation and detail coefficients , respectively .",
    "it has been proven @xcite that the filter @xmath30=\\langle \\frac{1}{\\sqrt{2}}\\phi\\left(\\frac{t}{2}\\right ) , \\phi\\left(t - n\\right)\\rangle $ ] and that @xmath31=\\langle \\frac{1}{\\sqrt{2}}\\psi\\left(\\frac{t}{2}\\right ) , \\phi\\left(t - n\\right)\\rangle $ ] .",
    "@xmath31 $ ] and @xmath30 $ ] can be regarded as an approximation to a high - pass filter ( the wavelet filter ) and to a low - pass filter ( the scaling filter ) , respectively . by applying recursively over the approximation",
    "coefficients the same filtering operation followed by sub - sampling by two , we obtain the multiresolution expression of @xmath9 .",
    "this algorithm , known as the pyramid algorithm , is the most efficient way of computing the fast orthogonal wavelet transform ( fowt ) @xcite .",
    "given that the filtering operation is only applied over the approximation coefficients , the fowt only provides information on a limited set of frequency bands which need not be the ones used in the hrv analysis .",
    "a more suitable wavelet transform is needed for our algorithm : the wavelet packet decomposition ( wpd ) .",
    "instead of dividing only the approximation coefficients @xmath32 $ ] , both detail and approximation coefficients are decomposed successively by applying high pass and low pass filters to each set of coefficients .    among the wpd",
    "transforms we have chosen the modwpt @xcite because it is less sensitive to the starting point of the time series and it is applicable to non dyadic sequences .",
    "furthermore , the modwpt avoids the sub - sampling step , and therefore it has the same number of wavelet coefficients in every decomposition level .",
    "this simplifies computations involving different decomposition levels .",
    "the @xmath33 level of the modwpt decomposes the frequency interval @xmath34 $ ] , where @xmath35 is the sampling frequency of the original signal @xmath9 , into @xmath36 equal width intervals ( see fig . [ modwpt ] ) .",
    "thus , the @xmath37 node ( beginning at zero ) in the @xmath33 level of the decomposition tree , the @xmath38 node , is associated with the frequency interval @xmath39 $ ] .",
    "each node will have @xmath40 wavelet coefficients associated , @xmath40 being the length of the sampled signal @xmath9 .",
    "the @xmath40-dimensional vector @xmath41 will denote the @xmath40 wavelet coefficients associated with the @xmath38 node .",
    "@xmath42 represents the original signal , @xmath43,width=336 ]    modwpt coefficients fulfill that:@xmath44    therefore , given a frequency band @xmath45 = \\frac{f_{s}}{% 2^{j+1}}\\left [ k , k^{\\prime } + 1\\right ] $ ] , @xmath35 being the sampling frequency and @xmath46 , @xmath47 and @xmath48 integers , the spectral power in @xmath45 $ ] , @xmath49 ) $ ] , can be calculated from the appropriate modwpt coefficients .",
    "we just need to find the nodes @xmath50 and @xmath51 and compute the spectral power in the band @xmath52 $ ] as:@xmath53 ) = \\sum_{n = k}^{k^{\\prime } } \\vert \\mathbf{w}% _ { j , n}\\vert ^{2}.   \\label{eq : powerinband}\\ ] ]      equation ( [ eq : powerinband ] ) can only be applied to bands that can be written as @xmath54 $ ] , @xmath35 being the sampling frequency and @xmath46 , @xmath47 and @xmath48 integers . in an hrv spectral analysis",
    "the user can be interested in bands that can not be written this way .",
    "this forces us to permit a certain error when we try to cover the bands with coefficients obtained from the modwpt decomposition .",
    "let @xmath55 $ ] be the band , and let @xmath56 and @xmath57 be the maximum errors allowed for the beginning and the ending of the band , respectively .",
    "we need to find a node @xmath38 whose lower frequency corresponds roughly to @xmath58 with the tolerance allowed by @xmath56 , i.e. : @xmath59 analogously , we also need to find a node @xmath60 whose upper frequency corresponds roughly to @xmath61 with the tolerance allowed by @xmath57 : @xmath62 we shall refer to ( [ c2l ] ) and ( [ c2u ] ) as _ the cover conditions_.    the level @xmath48 of the decomposition tree in which the node @xmath38 that fulfills ( [ c2l ] ) is found needs not be the same as the level @xmath63 in which the node @xmath60 that fulfills ( [ c2u ] ) is found .",
    "but , ( eq : powerinband ) requires that @xmath64 . to avoid this problem",
    "we may think that , after the nodes @xmath38 and @xmath65 have been found , we could descend the node that is at the higher level , decomposing it to the level of the other node @xcite .",
    "however , when descending to low levels in the frequency decomposition tree , frequency resolution increases and temporal resolution decreases because of the gabor - heisenberg uncertainty principle for signals : @xmath66 @xcite .",
    "furthermore , wavelet coefficients suffer a circular time shift as a result of the use of wavelet filters . as we descend to lower levels",
    ", the circular shift will be more pronounced as we perform more convolutions .",
    "therefore , to obtain a good temporal resolution , we should avoid descending to deep levels of the tree .",
    "let s suppose that , when looking for a cover for the band of interest @xmath67 $ ] , the nodes @xmath38 and @xmath60 are selected .",
    "these nodes must fulfill the cover conditions ( [ c2l ] ) and ( [ c2u ] ) with @xmath68 and @xmath69 . generally , the nodes @xmath38 and @xmath60 are at different levels ( i.e. , @xmath70 ) .",
    "furthermore , these nodes cover the band @xmath71   \\cup   \\frac{f_{s}}{2^{j^{\\prime } + 1 } } \\left [ n^{\\prime } , n^{\\prime } + 1 \\right]$ ] , but the band @xmath72=\\left [ f^{\\prime}_1,f^{\\prime}_2\\right]$ ] remains uncovered ( see nodes @xmath73 and @xmath74 of fig .",
    "[ modwpt ] ) .",
    "the problem has been reduced to finding a cover for the band @xmath75 $ ] .",
    "thus , new nodes will be selected fulfilling _ the cover conditions _",
    "( [ c2l ] ) and ( [ c2u ] ) , with @xmath76 and @xmath77 . the complete cover of @xmath67 $ ] can be achieved applying this technique recursively .",
    "the set of nodes resulting from this cover will be referred to as @xmath78 .    there may be overlap between the bands associated with the nodes @xmath38 and @xmath79 ( the original nodes fulfilling the _ cover conditions _ ) .",
    "this overlap will occur if a node is the parent of the other node or if both nodes are equal .",
    "if @xmath80 , the node covers all the band and the search has ended .",
    "if the node @xmath79 is a child of the node @xmath38 , we shall replace the node @xmath38 with its ( unique ) child verifying ( [ c2l ] ) : the node @xmath81 .",
    "thus , the algorithm continues with the nodes @xmath81 and @xmath79 .",
    "the process shall be repeated until there is no overlap between the two nodes fulfilling the _",
    "cover condition_. similarly , if the node @xmath38 is a child of the node @xmath79 , we replace the node @xmath79 with the node @xmath82 .",
    "figure [ modwpt ] illustrates the cover process for the band @xmath83 $ ] hz with @xmath84 hz and @xmath85 using the  nodes at the same level \" criteria used in @xcite ( dashed nodes ) and the  nodes at different levels \" criteria proposed here ( dark nodes ) .",
    "there exist multiple covers of any band @xmath86 $ ] .",
    "our algorithm builds a cover using the nodes of the higher levels of the modwpt tree .",
    "this selection criteria leads to a cover that minimizes temporal shift and maximizes temporal resolution .",
    "furthermore , this cover also _ minimizes _ the number of nodes .",
    "equation ( [ eq : powerinband ] ) can not be applied to this decomposition , because the decomposition uses nodes from different levels . however , because of the wavelet coefficients property    @xmath87    we may write ( [ eq : powerinband ] ) as @xmath53 ) \\approx\\sum_{n = k}^{k^{\\prime } } \\vert \\mathbf{w}% _ { j , n}\\vert ^{2}=\\sum_{\\mathbf{w}_{j , n}\\;\\epsilon\\;\\gamma}\\vert \\mathbf{w}% _ { j , n}\\vert ^{2}.   \\label{eq : newpowerinband}\\ ] ]    in practical applications , the complete modwpt decomposition tree will be rarely needed . in order to improve the execution time of wavelet analysis we have developed a pruning algorithm that we call pruned modwpt ( pmodwpt ) .",
    "the pmodwpt , instead of expanding every node of the decomposition tree will only calculate those children required to cover a frequency band .",
    "figure [ prune ] illustrates the pruning performed when calculating the power of the band @xmath88 $ ] hz being @xmath89 hz .          as a consequence of the frequency - dependent phase response of the wavelet filters , it is necessary to keep track of which",
    "wavelet coefficients contain the energy contribution of a given portion of the signal being analyzed ( see fig . [ shifts ] ) .",
    "that is , the wavelet coefficients must be corrected so that they can be accurately aligned with the original time series .",
    "hess - nielsen and wickerhauser proposed in @xcite a technique to compute shift corrections exact for linear phase filters , and showed how to estimate the perturbation that a deviation from linear phase produces .",
    "this suggests that the method will produce better results with filters whose phase does not deviate much from a linear phase filter .",
    "thus , this algorithm can be used to compute approximate shift corrections for a wide range of wavelets , including least asymmetric and extremal phase daubechies , symmlet or coiflet wavelets .",
    "time shifts proposed in @xcite are based on the notion of the  center of energy \" of a filter .",
    "let @xmath90 be a filter of length @xmath91 .",
    "its center of energy , @xmath92 , is given by :    @xmath93 ^ 2}{\\underset{n=0}{\\overset{l-1 } { \\sum } } a_l[n]^2}\\ ] ]    the time shift needed for the node @xmath38 of the modwpt is always an advance ( shift to the left ) of @xmath94 units that is given by @xcite @xmath95 where @xmath96 is the bit - reversal of the binary gray code which encodes each of the modwpt tree nodes @xcite .",
    "listing [ lst : wsa ] shows the pseudocode of our wavelet - based hrv analysis algorithm . the function _",
    "waveletanalysis _ takes as input parameters the interpolated and filtered rr series , the boundaries of the frequency bands , the wavelet to be used in the analysis , the sampling frequency of the rr series and the tolerance allowed when covering the frequency bands to be analyzed .",
    "the algorithm starts by finding the covers for each of the bands in which the user wants to calculate the spectral power .",
    "the _ calculatecover _",
    "function implements the recursive covering algorithm presented in section [ sec : cover ] .",
    "the _ getnode _ function selects the initial nodes fulfilling the cover conditions given by ( [ c2l ] ) and ( [ c2u ] ) .",
    "it expands the node whose frequency interval contains the boundary frequency ( @xmath9 ) .",
    "if none of its children verify the cover condition for @xmath9 , the child containing @xmath9 is selected and the process is repeated .",
    "the _ fillgapsbetweennodes _",
    "function completes the cover given a pair of initial nodes : @xmath38 and @xmath97 that fulfill ( [ c2l ] ) and ( [ c2u ] ) , respectively .",
    "this function distinguishes the four cases discussed in section [ sec : cover ] : @xmath98 ; @xmath97 is a child of the @xmath38 node ; @xmath38 is a child of @xmath97 or the general case where there is an uncovered band .",
    "once the cover for the bands has been found , the wavelet coefficients are computed using the pmodwpt .",
    "note that we use a single decomposition tree to calculate the power in all the bands .",
    "the shift correction described in section [ sec : shift ] is computed using _",
    "shiftcorrection_. the target nodes are specified to avoid applying corrections to nodes that will not be used in subsequent calculations . since the wavelet and scaling filters",
    "are involved in ( [ shifteq ] ) , the wavelet used to perform the analysis must also be specified in the _ shiftcorrection _ function .",
    "finally , the spectrogram of each band is computed with @xmath99 by the _ getspectrogram _ function .    ....",
    "waveletanalysis($rr$ , $ vlfmin$ , $ vlfmax$ , $ lfmin$ , $ lfmax$ , $ hfmin$ , $ hfmax$,$wavelet$ , $ f_s$,$bandtolerance$ ) {     $ vlfnodes$=calculatecover($[vlfmin , vlfmax]$,$f_s$,$bandtolerance$ )    $ lfnodes$=calculatecover($[lfmin , lfmax]$,$f_s$,$bandtolerance$ )    $ hfnodes$=calculatecover($[hfmin , hfmax]$,$f_s$,$bandtolerance$ )     $ wrr$=pmodwpt($rr$,$wavelet$,$vlfnodes\\cup lfnodes\\cup hfnodes$ )    $ wrr$ = shiftcorrection($wrr$,$wavelet$,$vlfnodes\\cup lfnodes\\cup",
    "hfnodes$ )    $ vlfpower$=getspectrogram($wrr$,$vlfnodes$ )    $ lfpower$=getspectrogram($wrr$,$lfnodes$ )    $ hfpower$=getspectrogram($wrr$,$hfnodes$ )    return($vlfpower$,$lfpower$,$hfpower$ ) }    calculatecover([$f_l$,$f_u$],$f_s$,$error$ ) {     if ( $ f_u$==$f_l$ ) return($\\left\\{\\right\\}$ )     $ w_{j , n}$=getnode($f_l$,$f_s$,$error$ )     $ w_{k , m}$=getnode($f_u$,$f_s$,$error$ )     return(fillgapsbetweennodes($w_{j , n}$,$w_{k , m}$,$f_s$,$error$ ) ) }    getnode($f$,$f_s$,$error$,$type$ ) {         $ i$=$1 $      $ nodetoexpand=0 $      while($true$ ) {            $ b_j$=$nodetoexpand$            $ \\delta$ = $ \\frac{f_s}{2^{i+1}}$            for ( $ j$ in $ ( 2\\cdot b_j):(2\\cdot b_j+1)$ ) {              $ interval$= $ [ j\\delta,(j+1)\\delta]$              if ( $ f$ $ \\in$ $ interval$ ) $ nodetoexpand$=$j$",
    "if ( $ interval$ verifies band cover condition for $ f$ and $ error$ ) return ( $ w_{i , j}$ )            }            $ i = i+1 $      } }    fillgapsbetweennodes($w_{j , n}$,$w_{k , m}$,$f_s$,$error$ ) {     if($w_{j , n}$==$w_{k , m}$ ) return($w_{j , n}$ )     if($w_{k , m}$ is child of $ w_{j , n}$ ) return(fillgapsbetweennodes($w_{j+1,2n}$,$w_{k , m}$,$f_s$,$error$ ) )     if($w_{j , n}$ is child of $ w_{k , m}$ ) return(fillgapsbetweennodes($w_{j , n}$,$w_{k+1,2m+1}$,$f_s$,$error$ ) )     $ mediumnodes$=calculatecover($f_s\\left [ \\frac{n+1}{2^{j+1}},\\frac{m}{2^{k+1 } } \\right]$,$f_s$,$error$ )     return($\\left\\{w_{j , n},w_{k , m}\\right\\}\\cup\\;mediumnodes$ ) }    getspectrogram($wrr$,$nodes$ ) {    $ s_{\\left\\{\\mathbf{x}\\right\\}}[m]=0 $    for ( $ w_{j , n}$ in $ nodes$ ) {      $ d_{j , n}[m]$=getwaveletcoefficients($wrr$ , $ w_{j , n}$ )       $ s_{\\left\\{\\mathbf{x}\\right\\}}[m]=s_{\\left\\{\\mathbf{x}\\right\\}}[m]+|d_{j , n}[m]| ^{2}$    }    return ( $ s_{\\left\\{\\mathbf{x}\\right\\}}[m]$ ) } ....      rhrv is an open - source package for the r environment for statistical computing that comprise a complete set of tools for hrv analysis .",
    "further details about rhrv package may be found in @xcite .",
    "here we shall only describe the rhrv functionality which is related to the algorithm presented in this paper .",
    "rhrv imports data files containing heartbeat positions .",
    "supported formats include ascii ( _ loadbeatascii _ function ) , edf ( _ loadbeatedfplus _ ) , polar ( _ loadbeatpolar _ ) , suunto ( _ loadbeatsuunto _ ) and wfdb data files ( _ loadbeatwfdb _ ) . to compute the instantaneous heart rate series _",
    "buildnihr _ can be used .",
    "a filtering operation can be carried out in order to eliminate outliers or spurious points present in the hr time series with unacceptable physiological values ( _ filternihr _ ) .",
    "a uniformly sampled heart rate signal ( with equally spaced values ) is obtained using _",
    "interpolatenihr_.    spectral power hrv analysis is performed with the _ calculatepowerband _ function .",
    "this function computes the spectrogram of the heart rate series in the ulf , vlf , lf and hf frequency bands .",
    "boundaries of the bands may be chosen by the user .",
    "if boundaries are not specified , default values are used : ulf , @xmath100 $ ] hz ; vlf , @xmath101 $ ] hz ; lf , @xmath102 $ ] hz ; hf , @xmath103 $ ] hz . until now , _",
    "calculatepowerband _ used the stft to compute the spectral power ( window size , window shift and zero padding may be specified by the user ) .",
    "the wavelet analysis algorithm presented in this paper was included in this function in such a way that we maintain backward compatibility .",
    "thus , both fourier and wavelet analysis may be used with the _ calculatepowerband _ function .",
    "type of analysis can be selected by the user by specifying the _ type _ parameter (  fourier \" or  wavelet \" ) .    when using wavelet analysis , in addition to the frequency bands , an error for the boundaries ( default value is 0.1 in absolute terms ) and a mother wavelet can be specified by the user .",
    "some of the most used wavelets are available :  haar \" , extremal phase (  d4 \" ,  d6 \" ,  d8 \" and  d16 \" ) and the least asymmetric (  la8 \" ,  la16 \" and  la20 \" ) daubechies , and the best localized (  bl14 \" and  bl20 \" ) among others . default value is  d4 \" .",
    "listing [ lst : basicexample ] shows all the rhrv code required to perform a typical wavelet - based spectral analysis .    ....",
    "md = createhrvdata ( ) md = loadbeatascii(md , \" beatpositions.beats \" ) md = buildnihr(md ) md = filternihr(md ) md = interpolatenihr(md , freqhr = 4 ) md = createfreqanalysis(md ) md = calculatepowerband(md , indexfreqanalysis=1 , ulfmin = 0 , ulfmax=0.03 , vlfmin = 0.03,vlfmax = 0.05 , lfmin = 0.05 , lfmax = 0.15 , hfmin= 0.15 , hfmax = 0.4 , type=\"wavelet \" , wavelet=\"d4 \" , bandtolerance=0.01 ) plotpowerband ( md , indexfreqanalysis=1 ) ....",
    "in order to compare the temporal resolution of the hrv analysis techniques based on our algorithm with those based on the fourier transform ( the stft ) and parametric estimation ( the windowed burg method ) , simulated rr series will be used .",
    "simulated signals are used instead of real signals because when using real signals , it is difficult to know which is the  correct \" result",
    ". therefore , we use simulated signals to know exactly what spectral components they have at each instant .    the integral pulse frequency modulation ( ipfm ) model @xcite , @xcite is a widely accepted technique used to generate rr series .",
    "the ipfm model simulates the sino - atrial node ( sa ) modulation by using a modulating signal @xmath104 and the sa function as trigger of the cardiac contraction by using a threshold @xmath105 .",
    "we shall use a signal with several fast ( every 16 seconds ) spectral changes as modulating signal :    @xmath106    the idea is to test the time - frequency transforms in a non - stationary scenario . to obtain a more realistic simulation , white noise",
    "was added to the @xmath104 signal .",
    "figure [ simpower ] shows how the wavelet transform correctly finds most of the spectral power in the first band between 16 s and 32 s , and between 48 s and 64 s ; and in the second band between 0 s and 16 s , between 32 s and 48 s and between 64 s and 80s , while the other methods can not track the spectral changes .",
    "the wavelet analysis was performed using a least asymmetric daubechies filter of width 8 .",
    "the tolerance was set to 0.01 .",
    "the selection of the window parameters for the stft and the burg method is not trivial .",
    "note that the minimum size of the window for the stft should be approximately @xmath107 .",
    "however , there is a spectral change every 16 seconds .",
    "the results shown in fig .",
    "[ fourieranns ] were obtained using a 30-second window with a 1-second shift . in the burg method ,",
    "we may use smaller windows , provided that we take enough points to estimate the model in each segment . the parametric analysis shown in fig .",
    "[ parametricanns ] was performed using a 16-second window with a 1-second shift .",
    "the selected value for the model order was 16 @xcite .",
    "it can be appreciated how the stft and the burg method can not track changes on this signal . using smaller length analysis windows",
    "did not improve these results .",
    "ll    for each of the two bands , and for each of the five zones with different spectral components , we calculated the ratio of the power that the band presents in each zone divided by the overall power of the band in the five zones .",
    "theoretically , the power in the vlf band should be distributed among the @xmath108 and @xmath109 zones , whereas the power in the lf band should be distributed among the @xmath110 , @xmath111 and @xmath112 zones .",
    "therefore , the ideal ratios if perfect time - frequency discrimination is obtained are @xmath113 and @xmath114 .",
    "tables [ tablequickf ] , [ tablequickparametric ] and [ tablequickw ] show the real ratios for the stft , the burg method and wavelet analysis , respectively .",
    "we can see that the wavelet ratios are closer to the theoretical values .      the top of fig .",
    "[ comparativa ] compares execution time ( as a function of the signal size ) of hrv analysis algorithms based on modwpt , pmodwpt ( our algorithm ) and the stft .",
    "the input signal to these algorithms was generated randomly . in order to compare fourier with wavelet - based analysis ,",
    "two configurations of the stft typically used on hrv analysis were selected .",
    "first fourier analysis used a window size and a displacement value of 5 minutes and 30 s , respectively (  typical fourier \" in fig .",
    "[ comparativa ] ) .",
    "the second fourier analysis used a shorter window in order to achieve a higher temporal resolution .",
    "window size and displacement took a value of 30 s and 2.5 s , respectively (  high resolution fourier \" in fig .",
    "[ comparativa ] ) .",
    "wavelet analysis was performed using least asymmetric daubechies of width 8 (  la8 \" ) and extremal phase daubechies of width 4 (  d4 \" ) since the efficiency depends on the filter length .",
    "pmodwpt and  typical fourier \" stft are much more efficient than modwpt and  high resolution fourier \" stft when analyzing hrv signals ( see the top of fig .",
    "[ comparativa ] ) .",
    "the bottom of fig .",
    "[ comparativa ] shows that the performance of the pmodwpt is comparable to the  typical fourier \" analysis .",
    "we have tested the algorithms presented in this paper on the recordings of the apnea ecg database used in the physionet / computers in cardiology challenge 2000 @xcite .",
    "obstructive sleep apnea - hypopnea ( osah ) syndrome is a sleep - breathing disorder characterized by the presence of total ( apneas ) and/or partial ( hypopneas ) cessations of respiratory airflow while the patient is asleep .",
    "there is an interest in developing low - cost osah screening tests that can be carried out in the patient s home and that can decrease the workload of hospitals sleep units .",
    "this is related to the goal of the computers in cardiology challenge 2000 : to develop a diagnostic test for osah from a single ecg lead .",
    "the dataset for this challenge is divided into a learning set and a test set .",
    "each of these sets consist of 35 recordings of the modified lead v2 of the patient s ecg recorded during nocturnal rest . both training and test sets",
    "are made of 20 recordings of patients suffering from osah , 5 recordings of patients who were on the borderline between normality and osah , and 10 recordings of control patients who did not suffer from the disorder .",
    "each recording includes minute by minute annotations indicating the presence or absence of apneas during that minute .",
    "the goal of the second part of the challenge , the one which will be addressed here , is to detect whether or nor the patient has suffered an apnea during each minute of nocturnal rest . to this end",
    "we shall use two algorithms previously published in the bibliography which are based on the calculation of a ratio between hrv spectral power in two different bands . specifically , we have computed the drinnan ratio ( @xmath115 ) @xcite and the otero ratio ( @xmath116 ) @xcite .",
    "the drinnan ratio and the otero ratio are defined as @xmath117)}{p(\\left[0.01,0.05\\;hz\\right])}$ ] and @xmath118)}{p(\\left[0.06,0.25\\;hz\\right])},$ ] respectively .",
    "both ratios were computed with rhrv using both wavelet and fourier analysis .",
    "the ratios obtained for each minute of the recording were fed to a support vector machine ( svm ) @xcite .",
    "the svm was trained using the learning set and validated on the validation set of the apnea ecg database .",
    "the scores ( percentage of minutes labelled correctly ) obtained in the minute by minute apnea classification using @xmath115 , @xmath116 and @xmath119 as svm parameters when the spectral power in the bands was calculated using wavelets were : 74.9% , 68.4% and 78.5% , respectively .",
    "when using fourier , the scores were 71.4% , 66.8% and 75.4% , respectively .",
    "wavelet - based analysis performs slightly better than fourier - based analysis in all scenarios .",
    "this may be due to the non - stationary nature of the signal being analyzed , and the fact that the higher temporal resolution of the wavelet analysis can help minimize the spectral contributions of apneas which have occurred outside the minute in question , but close to the end of the previous minute or to the beginning of the following one .",
    "we have presented an algorithm to perform hrv power spectrum analysis based on the modwpt .",
    "the computational load of the our algorithm is comparable to the load of widely used stft - based algorithms .",
    "the algorithm has been validated over simulated rr series with known spectral components .",
    "we have shown that the stft and the windowed burg method miss some quick changes that are successfully identified by the modwpt .",
    "these results suggest that wavelet - based analysis is a better tool to analyze fast transient phenomena in the rr time series than other techniques based on windowing .    in order to obtain optimal temporal resolution",
    ", we should avoid descending to deep levels of the pmodwpt decomposition tree . in rhrv ,",
    "a warning is generated if the band cover needed for the analysis requires expanding more than @xmath120 levels , @xmath40 being the number of samples of the signal and @xmath121 the filter length .",
    "a careful selection of the frequency bands to be analyzed provides some control over the depth of the tree . for example , if the rr time series is sampled at 4 hz , and we want to obtain the power in the band @xmath122 $ ] hz with a tolerance in the position of the band s boundaries of 0.01 , our algorithm will need to descend seven levels on the tree .",
    "however , to calculate the power in @xmath123 $ ] hz with the same tolerance our algorithm only needs to descend three levels . in this way",
    ", we obtain a good estimate of the power in the band @xmath122 $ ] hz without compromising the temporal resolution of the results .",
    "a corollary of the phenomenon described in the previous paragraph is that , in order to achieve optimum temporal resolution ( and therefore maximize the chance of identifying fast transient phenomena ) , the spectral bands used in hrv analysis with wavelets will probably have to differ from those traditionally associated with vlf , lf and hf .",
    "this opens the question of what may be the pathophysiological significance of spectral bands different from those which have already been widely studied in the literature .",
    "the mother wavelet used in hrv analysis also influences the time - frequency resolution because it determines the filter shape .",
    "further study on how the mother wavelet influences the results of the hrv analysis is required .",
    "for example , our initial tests suggest that shorter wavelets have greater time resolution than the larger wavelets , whereas the latter have a better filtering behavior than the first ones .    when performing a wavelet analysis , a careful choice of the bands",
    "is needed to avoid heavy computations , as well as a choice of the mother wavelet .",
    "when using stft analysis we also have to choose the frequency bands ( although we have more flexibility in the choice ) , as well as the window size , window displacement and zero padding size .",
    "overall , more parameter choices need to be made when using the stft .",
    "furthermore , the selection of the stft parameters is complex , not only because of the computation efficiency , but also because the use of a certain window size influences the temporal resolution and the frequency bands available to the analysis . to address this issue ,",
    "some authors use different windows for each frequency band .",
    "this makes the analysis process heavy .",
    "moreover , the results obtained in each of the bands are not comparable since they have been obtained using different windows .",
    "the need for tuning a lower number of knobs , and the possibility of using the same parameters in the analysis of all the hrv frequency bands are two additional advantages of using wavelets in hrv studies .",
    "the algorithm described in this paper has been implemented in the rhrv package for the r environment in its 3.0 version . to the best of our knowledge",
    ", rhrv is the first hrv analysis toolkit that supports wavelet - based spectral analysis of the rr time series .",
    "this software can be freely downloaded from @xcite",
    ". the availability of this package will enable researchers to carry out hrv power spectrum analysis based on the wavelet transform in a simple manner ( see listing [ lst : basicexample ] ) .",
    "we hope that this will help increase the number of hrv studies that use the higher temporal resolution wavelet - based techniques .",
    "this work was supported in part by the european regional development fund ( erdf / feder ) under the project cn2012/151 of the galician ministry of education .",
    "+ notice : this is the author s version of a work that was accepted for publication in biomedical signal processing and control .",
    "changes resulting from the publishing process , such as peer review , editing , corrections , structural formatting , and other quality control mechanisms may not be reflected in this document .",
    "changes may have been made to this work since it was submitted for publication .",
    "a definitive version was subsequently published in biomedical signal processing and control , volume 8 , issue 6 , november 2013 , pages 542550 , doi:10.1016/j.bspc.2013.05.006    25 natexlab#1#1[2]#2 , , , , .",
    ", , , ( ) . , , , , , , , ( ) . , , , , , ( ) . , ( ) .",
    ", , , , , , , ( ) . , , ( ) . , . , . , , ( ) . , , , ( ) . , , , , , in : , pp . . , , , . , , , volume  , , . , , ( ) . , , , ( ) . , , , , , , , ( ) . , , , , , ( ) . , , , in : , p. . , , , , , ( ) . , , , , , , in : , , pp . . , , , , , in : , , pp . . , , , , , , in : , , pp . . , ,",
    ".      * figure 1 : modwpt decomposition tree with the nodes selected to cover the band @xmath124 $ ] hz .",
    "@xmath42 represents the original signal , @xmath43 * figure 2 : prune procedure using the pmodwpt .",
    "the crosses indicates which nodes have been pruned .",
    "* figure 3 : time shift using modwpt without ( top ) and with ( bottom ) ",
    "center of energy \" correction .",
    "the vertical lines indicate where spectral power should be .",
    "* listing 1 : pseudocode of our wavelet - based hrv analysis algorithm .",
    "* listing 2 : hrv wavelet - based analysis in rhrv .",
    "* figure 4 : spectrogram analysis of the simulated rr series . * table 1 : relative power per frequency and per zone for stft , windowed burg method and wavelet analysis .",
    "* figure 5 : performance of hrv analysis using pmodwpt , modwpt and stft ."
  ],
  "abstract_text": [
    "<S> one of the most promising non - invasive markers of the activity of the autonomic nervous system is heart rate variability ( hrv ) . </S>",
    "<S> hrv analysis toolkits often provide spectral analysis techniques using the fourier transform , which assumes that the heart rate series is stationary . to overcome this issue , the short time fourier transform </S>",
    "<S> is often used ( stft ) . </S>",
    "<S> however , the wavelet transform is thought to be a more suitable tool for analyzing non - stationary signals than the stft . given the lack of support for wavelet - based analysis in hrv toolkits , such analysis must be implemented by the researcher . </S>",
    "<S> this has made this technique underutilized .    </S>",
    "<S> this paper presents a new algorithm to perform hrv power spectrum analysis based on the maximal overlap discrete wavelet packet transform ( modwpt ) . </S>",
    "<S> the algorithm calculates the power in any spectral band with a given tolerance for the band s boundaries . the modwpt decomposition tree is pruned to avoid calculating unnecessary wavelet coefficients , thereby optimizing execution time . </S>",
    "<S> the center of energy shift correction is applied to achieve optimum alignment of the wavelet coefficients . </S>",
    "<S> this algorithm has been implemented in rhrv , an open - source package for hrv analysis . to the best of our knowledge </S>",
    "<S> , rhrv is the first hrv toolkit with support for wavelet - based spectral analysis .    </S>",
    "<S> heart rate variability , wavelet transform , wavelet packets , rhrv . </S>"
  ]
}