{
  "article_text": [
    "it is by now well established that the intrinsic karplus - luttinger mechanism@xcite plays a significant role in the anomalous hall conductivity ( ahc ) of ferromagnets .",
    "this contribution can be expressed as an integral of the @xmath0-space berry curvature over the occupied portions of the brillouin zone ( bz).@xcite first - principles calculations of the intrinsic ahc have been carried out by several authors , using either a kubo linear - response formula@xcite or a direct `` geometric '' evaluation of the berry curvature,@xcite and achieving good agreement with experimental values for several ferromagnets .",
    "these studies revealed that the berry curvature is very sharply peaked in certain regions of the bz where spin - orbit splitting occurs near the fermi level . as a result",
    "the calculations tend to be rather demanding ; in the case of bcc fe , for example , millions of @xmath0-points must be sampled to achieve convergence.@xcite more efficient approaches are therefore highly desirable .    in a preceding paper,@xcite we developed a strategy for calculating the ahc in which wannier interpolation of the bloch functions was used to circumvent the need to perform a full first - principles calculation for every @xmath0-point .",
    "thus , while the required number of @xmath0-points was not reduced , the computational load per @xmath0-point was greatly reduced . in this approach",
    ", the actual first - principles calculations are performed on a comparatively coarse @xmath0-mesh .",
    "then , in a postprocessing step , the calculated electronic structure is mapped onto an `` exact tight - binding model '' based on maximally - localized wannier functions.@xcite working in the wannier representation , the berry curvature can then be evaluated very inexpensively at each of the @xmath0-points of the fine mesh needed for accurate evaluation of the ahc .",
    "recently , haldane has shown that while the intrinsic ahc is usually regarded as a fermi - sea property of all the occupied states , it can alternatively , and in some ways more naturally , be regarded as a fermi - surface property.@xcite ( more precisely , haldane showed that these quantities are equal modulo the quantum of transverse conductivity that is well - known from the quantum hall effect , since one can not rule out the possibility that , e.g. , some occupied bands carry non - zero chern numbers.@xcite ) by a kind of integration by parts , haldane showed how the integral of the berry curvature over the occupied portions of the bz could be manipulated first into a fermi - surface integral of a berry connection , and then ultimately into a fermi - surface integral of a fermi - vector - weighted berry curvature , augmented with some berry - phase corrections for the case of non - simply - connected fermi sheets . in discussing his eq .",
    "( 23 ) , haldane mentions in passing that this expression can also be reformulated in terms of the berry phases of electron orbits circulating on the fermi surface .",
    "in this paper we present a tractable and efficient computational scheme that takes the latter point of view as its organizing principle . in our approach",
    ", the bz is divided into a fine mesh of equally - spaced slices normal to the direction of the magnetization , and the integral of the berry curvature over the occupied states of a given slice is transformed into a sum of berry phases of fermi loops lying in that slice . as a result , the three - dimensional bz integration is avoided , and the method relies instead only on information calculated on the two - dimensional fermi surface . as in ref .",
    ", an important ingredient of our approach is the use of a wannier interpolation scheme to lower the cost further by eliminating the need for a full first - principles evaluation at each point on the fermi surface . combining these two complementary strategies , we arrive at a robust and efficient method for computing of the ahc in ferromagnetic metals .",
    "the paper is organized as follows . in sec .",
    "[ sec : method ] we present the necessary formulas relating berry phases on the fermi surface to the ahc , as well as their evaluation in the wannier representation .",
    "the details of the first - principles calculations and the determination of the fermi loops are given in sec .",
    "[ sec : comp ] . in sec .",
    "[ sec : results ] the method is applied to the transition metals fe , co and ni .",
    "a discussion of issues of computational efficiency is given in sec .",
    "[ sec : disc ] , followed by a brief conclusion in sec .  [ sec : summary ] .",
    "our starting point is the ahc expressed as an antisymmetric cartesian tensor in terms of the berry curvature , @xmath1 where the integration is over the three - dimensional bz and the occupation function @xmath2 restricts the sum to the occupied states ( we work at zero temperature ) .",
    "@xmath3 is the berry - curvature matrix of band @xmath4 , defined as @xmath5 where @xmath6 is the periodic part of the bloch function @xmath7 .",
    "because @xmath8 is antisymmetric , we can represent it instead in axial - vector notation as @xmath9 or equivalently , @xmath10 , where @xmath11 is the antisymmetric tensor .",
    "the berry curvature can also be written as @xmath12 where the berry connection is @xmath13    following ref .  , we rewrite eq .",
    "( [ eq : sigma ] ) as @xmath14 where @xmath15 for the case of a completely filled band lying entirely below the fermi level , haldane has shown@xcite that @xmath16 is quantized to be a reciprocal lattice vector ( the `` chern vector '' ) , as will become clear in sec .",
    "[ sec : quantum ] below .",
    "let @xmath17 and @xmath18 be a conjugate set of primitive real - space and reciprocal - space lattice vectors respectively , @xmath19 , and let @xmath20 so that @xmath21 in order to compute @xmath22 , for example , we choose the bz to be a prism whose base is spanned by @xmath23 and @xmath24 and whose height is @xmath25 , and convert the integral into one over slices parallel to the base . in general , separate calculations in which the slices are constructed parallel to the @xmath24-@xmath26 and @xmath23-@xmath26 planes are needed to compute @xmath27 and @xmath28 respectively.@xcite however , this can be avoided in the common case that the magnetization lies parallel to a symmetry axis ; one can then choose @xmath23 and @xmath24 perpendicular to this axis , and only @xmath22 needs to be computed .    inserting eq .",
    "( [ eq : kdef ] ) into eq .",
    "( [ eq : cnjdef ] ) yields @xmath29 where @xmath30 here @xmath31 labels the slice and @xmath32 is the region of the slice in which band @xmath4 is occupied .",
    "recalling eq .",
    "( [ eq : curl ] ) and noting that @xmath33 is the unit vector normal to the slice , the application of stokes theorem to eq .",
    "( [ eq : phibc ] ) yields @xmath34 where @xmath35 is the oriented curve bounding @xmath32 on the slice and @xmath36 has the interpretation of a berry phase . for later convenience",
    "we also define @xmath37 and similarly @xmath38 etc .",
    "the calculation of the ahc has thus been reduced to a calculation that is restricted to the fermi surface only , in the spirit of eq .",
    "( 23 ) of haldane s ref .  .    in general , the occupied or unoccupied region of band @xmath4 in slice @xmath31 need not be simply connected",
    ", in which case the boundary @xmath35 is really the union of several loops .",
    "moreover , loops encircling hole pockets should be taken in the negative direction of circulation .",
    "this is illustrated in fig .",
    "[ fig : loop_demo ] , where the first band exhibits four hole pockets and the second band has one electron pocket , so that @xmath39 is the union of four countercirculating loops and @xmath40 is a fifth loop of positive circulation . if higher bands are unoccupied , then @xmath41 for this slice is just given by the sum of the berry phases of these five loops .",
    "we shall assume for simplicity in the following that @xmath35 is simply connected , but the generalization to composite loops is straightforward .",
    "we claimed earlier that if band @xmath4 is fully occupied , @xmath42 in eq .",
    "( [ eq : kdef ] ) is quantized to a reciprocal lattice vector .",
    "this can now be seen by noting that under those circumstances the integral in eq .",
    "( [ eq : phibc ] ) runs over a two - dimensional bz , which can be regarded as a closed two - dimensional manifold ( two - torus ) , and for topological reasons@xcite the integral of the berry curvature over such a closed manifold must be an integer multiple of @xmath43 ( the chern number ) .",
    "then each @xmath44 is an integer , and @xmath42 in eq .",
    "( [ eq : kn ] ) must be a reciprocal lattice vector as claimed .",
    "if the system is an insulator , then @xmath45 ( summed over occupied bands ) is also guaranteed to be a reciprocal lattice vector , and if it is a nonzero one , the insulator would have a quantized hall conductivity and could be regarded as a quantum hall crystal ( or `` chern insulator'').@xcite no physical realization of such a system is known experimentally , but the search for one remains an interesting challenge .",
    "let us consider again a slice for which band @xmath4 is fully occupied but has a non - zero chern number .",
    "if this slice is regarded as an open rectangle ( or parallelogram ) rather than a closed two - torus , and a continuous choice of gauge is made in its interior ( i.e. , @xmath46 is free of singularities ) , then the boundary @xmath47 is the perimeter of this rectangle and eq .",
    "( [ eq : philoop ] ) will yield the same integer multiple of @xmath43 as eq .",
    "( [ eq : phibc ] ) . in the spirit of fig .",
    "[ fig : loop_demo ] , however , we prefer to regard the slice as a closed two - torus and to exclude the perimeter from our definition of the boundary @xmath35 .",
    "then @xmath47 is null and eq .",
    "( [ eq : philoop ] ) vanishes for the case at hand , in disagreement with eq .",
    "( [ eq : phibc ] ) .",
    "the disagreement arises because of the impossibility of making a continuous choice of gauge on a closed manifold having a non - zero chern number;@xcite the best that can be done is to make @xmath46 finite everywhere except at singularities ( `` vortices '' ) which , when included , restore the missing contributions of @xmath43 .",
    "returning to the general case of a partially occupied band @xmath4 with @xmath35 defined to exclude the perimeter of the slice , we conclude that eq .",
    "( [ eq : philoop ] ) is really only guaranteed to equal the true result of eq .",
    "( [ eq : phibc ] ) modulo @xmath43 .",
    "moreover , the berry phase will be evaluated in practice using a discretized berry - phase formula@xcite of the form @xmath48 where @xmath49 discretizes the loop @xmath35 .",
    "( we will actually use a modified version , eq .",
    "( [ eq : bp ] ) , of this formula . )",
    "the choice of branch cut is now arbitrary , and again the agreement with eq .",
    "( [ eq : philoop ] ) or eq .",
    "( [ eq : phibc ] ) is only guaranteed modulo @xmath43 . by convention",
    "one normally restricts phases to lie in the interval @xmath50 $ ] , but then @xmath36 would in general have unwanted discontinuities at some values of @xmath31 . in practice",
    "we discretize the @xmath31 integration , so that using eq .",
    "( [ eq : cshort ] ) , @xmath38 becomes @xmath51 we then enforce continuity of the total phase @xmath41 of eq .",
    "( [ eq : phitot ] ) by choosing @xmath52 such that @xmath53 for each slice @xmath54 in sequence . since the true phase given by the sum of contributions in eq .",
    "( [ eq : phibc ] ) is also continuous , this guarantees that our calculated @xmath41 differs from the true one by the same multiple of @xmath43 for all @xmath31 .",
    "our computed ahc would then differ from the true one by a multiple of the quantum and could be said to give the `` non - quantized part '' of the intrinsic ahc in the sense of haldane.@xcite however , it is straightforward to remove this overall ambiguity of branch choice by evaluating @xmath41 from eq .",
    "( [ eq : phibc ] ) on the first slice and then enforcing continuity for each subsequent slice , thus arriving at the correct ahc without any question of a quantum .",
    "we note in passing that an isolated point of degeneracy ( `` dirac point '' ) between a pair of bands @xmath4 and @xmath55 can generically occur in three - dimensional @xmath0-space in the absence of time - reversal symmetry.@xcite if such a dirac point occurs below the fermi energy , then @xmath36 and @xmath56 will , when evaluated from eq .",
    "( [ eq : phibc ] ) , exhibit equal and opposite discontinuities of @xmath43 at the @xmath31 of the dirac point",
    ". however , the total phase @xmath41 will remain continuous , so that the algorithm described in the previous paragraph will still work correctly .",
    "we close this subsection by emphasizing that the discussion of possible non - zero chern numbers or the presence of dirac points is rather academic . in our calculations on fe , ni and co , we have not encountered any indications of such anomalies ; they presumably occur rarely or not at all in the materials studied here .",
    "the essential problem now becomes the computation of the loop integral of eq .",
    "( [ eq : philoop ] ) . as is well known , the berry connection @xmath46 of eq .",
    "( [ eq : berry_connection ] ) is gauge - dependent , i.e. , sensitive to the @xmath0-dependent choice of phase of the bloch functions . if eq .",
    "( [ eq : philoop ] ) is to be calculated by the direct evaluation of @xmath46 and its subsequent integration around the loop , this lack of gauge - invariance may present difficulties .",
    "for example , it means that there is no unique kubo - formula expression for @xmath46 .",
    "an alternative and more promising approach is to compute @xmath36 by the discretized berry - phase formula@xcite of eq .",
    "( [ eq : phibp ] ) , where the inner products are computed from the full first - principles calculations at neighboring pairs of @xmath0-points around the loop . however , this may still be quite time - consuming if it has to be done at very many @xmath0-points .",
    "we avoid this by using the technique of wannier interpolation@xcite to perform the needed loop integral inexpensively . in this formulation , the loop integral of eq .",
    "( [ eq : philoop ] ) can be expressed as a sum of two terms , one in which a contribution to @xmath46 is evaluated and integrated explicitly , and a second that takes a form like that of eq .",
    "( [ eq : phibp ] ) .",
    "the key idea of wannier interpolation is to map the low - energy first - principles electronic structure onto an `` exact tight - binding model '' using a basis of appropriately constructed crystalline wannier functions . for metallic systems like those considered here",
    ", the bands generated by these wannier functions are only partially occupied .",
    "they are guaranteed by construction to reproduce the true first - principles bands in an energy window extending somewhat above the fermi level , so that all valence and fermi - surface states are properly described.@xcite in the wannier representation , the desired quantities such as band energies , eigenstates and the derivatives of eigenstates with respect to wavevector @xmath0 can then be evaluated at arbitrary @xmath0-points at very low computational cost . all that is needed is to evaluate , once and for all , the wannier - basis matrix elements of the hamiltonian and position operators.@xcite it is worth pointing out that it may sometimes be expedient to drop some lower occupied bands and construct the wannier functions so that they correctly represent the bloch functions only in some narrower energy window containing the fermi energy ; since the present formulation involves only fermi - surface properties , the nonquantized part of the ahc will then still be given correctly .",
    "the wannier construction procedure of ref .   provides us with a set of @xmath57 wannier functions @xmath58 ( @xmath59 ) in each cell labeled by lattice vector @xmath60 . from these the bloch basis functions",
    "@xmath61 are constructed according to the fourier transform relation @xmath62 here the superscript @xmath63 indicates that these are obtained from the wannier representation , that is , they are not yet hamiltonian eigenstates . to obtain those , we construct the @xmath64 hamiltonian matrix @xmath65 via @xmath66 at",
    "any given @xmath67 this matrix can be diagonalized to yield an @xmath64 unitary matrix @xmath68 , i.e. , @xmath69 where @xmath70 are the energy eigenvalues and @xmath71 are the corresponding band states . by the construction procedure of ref .  , @xmath72 is identical to the true @xmath73 ( and similarly for the eigenvectors @xmath74 ) for all occupied states and low - lying empty states .",
    "this is strictly true only for @xmath0-points on the original _ ab - initio _ mesh .",
    "the power of this interpolation scheme lies in the fact that , by virtue of the spatial localization of the wannier functions , the error remains extremely small even for points away from that grid.@xcite    the next step is to evaluate @xmath75 on a two - dimensional mesh of @xmath0-points covering a single slice and then use a contour - finding algorithm to map out and discretize the fermi loops therein .",
    "this part of our scheme will be described in more detail in sec .",
    "[ sec : contour ] .",
    "for now we can just assume that the output is a sequence of points @xmath49 @xmath76 providing a fairly dense mapping of the contour .",
    "( as before , we assume for simplicity that the fermi contour consists of a single loop ; the extension to multiple loops is straightforward . )",
    "next we need to obtain the berry connection @xmath77 as in eq .",
    "( [ eq : berry_connection ] ) . using eq .",
    "( [ eq : uwu ] ) , this becomes @xmath78 where @xmath79 is computed in practice from the expression @xmath80 in a manner similar to eq .",
    "( [ eq : uu ] ) .",
    "details concerning the method of calculating eqs .",
    "( [ eq : uu ] ) and ( [ eq : ww ] ) can be found in ref .  .    the decomposition of @xmath46 into two terms in eq .",
    "( [ eq : adecomp ] ) is an artifact of the choice of wannier functions ; only the sum of the two terms is physically meaningful ( upon a circuit integration ) .",
    "however , for a given choice of wannier functions , the first term arises because the bloch functions @xmath81 acquire some of the berry curvature attached to the full subspace of @xmath57 wannier functions used to represent them , whereas the second term represents the berry curvature arising from changes of character of this bloch state _ within _ the wannier subspace . to clarify this viewpoint ,",
    "we introduce a notation@xcite in which @xmath82 is defined to be the @xmath4th column vector of matrix @xmath83 , so that the second term of eq .  ( [ eq : adecomp ] ) becomes @xmath84 . plugging into eq .",
    "( [ eq : philoop ] ) , this yields @xmath85 for the berry phase of slice @xmath86 appearing in eq .",
    "( [ eq : csum ] ) .",
    "note that the integrand in the first term is gauge - invariant ( here `` gauge '' refers to the application of a phase twist @xmath87 ) , while in the second term only the entire loop integral is gauge - invariant .",
    "indeed , the second term is just a berry phase defined within the @xmath57-dimensional `` tight - binding space '' provided by the wannier functions . recalling that @xmath49 for @xmath88 is our discretized description of the fermi loop , and using standard methods for discretizing berry phases@xcite as in eq .",
    "( [ eq : phibp ] ) , our final result becomes @xmath89 where @xmath90 .    as we shall see below , in practice",
    "we only encounter closed orbits , in which case it is clearly appropriate to set @xmath91 and close the phases with @xmath92 . for lower - symmetry situations , however , open orbits with @xmath93 may be encountered . even in this case , however , we would still set @xmath94 ; in contrast to the full bloch states which obey@xcite @xmath95 , no extra phase factors are needed here because the fourier - transform convention of eq .",
    "( [ eq : ft ] ) treats the wannier functions as though they are all nominally located at the cell origin .    in summary ,",
    "our strategy is to evaluate eq .",
    "( [ eq : csum ] ) by decomposing each generalized path @xmath96 into connected simple loops , and sum the loop integrals as computed using eq .",
    "( [ eq : bp ] ) .",
    "the operations needed to evaluate eq .",
    "( [ eq : bp ] ) are inexpensive as they all involve vectors and matrices defined in the low - dimensional space of the wannier representation .",
    "fully relativistic band - structure calculations are carried out for the ferromagnetic transition metals fe , co and ni at their experimental lattice constants ( 5.42 , 4.73 , and 6.65 bohr , respectively ) using the pwscf code.@xcite norm - conserving pseudopotentials with spin - orbit coupling@xcite are generated using similar parameters as in ref .  .",
    "an energy cutoff of 60 hartree is used for the planewave expansion of the valence wavefunctions ( 400 hartree for the charge densities ) , and the pbe generalized - gradient approximation@xcite is used for the exchange - correlation functional .",
    "the self - consistent ground state is obtained using a @xmath97 monkhorst - pack@xcite mesh of @xmath0-points and a fictitious fermi smearing@xcite of @xmath98 ry for the brillouin - zone integration .",
    "lccc & bcc fe & fcc ni & hcp co theory & 2.22 & 0.62 & 1.60 experiment & 2.13 & 0.56 & 1.59    [ table : spin_moment ]    the calculated spin magnetic moments are shown in table  [ table : spin_moment ] . the effect of spin - orbit coupling on these moments is included in the calculation , since it is needed in any case to obtain a nonzero ahc",
    "the agreement with experiment is rather good , confirming that our norm - conserving pseudopotentials are suitable for describing the ferromagnetic state of the transition metals .",
    "the maximally - localized wannier functions are generated using the wannier90 code;@xcite details are given in secs .",
    "[ sec : fe]-[sec : co ] below .      as discussed above",
    ", our basic strategy involves dividing the bz into a series of parallel slices and finding the intersections of the fermi surface with each of these slices .",
    "each slice is sampled on a uniform @xmath99 @xmath0-point mesh , with @xmath100 ranging from @xmath101 to @xmath102 , and the band energies are computed on the mesh using wannier interpolation . a standard contour - finding algorithm of the kind used to make contour plots is then used to generate a list of fermi loops and , for each loop , a list @xmath103 of @xmath0-points providing a discretized representation of the loop .    as shown in fig .",
    "[ fig : slice](a ) , the fermi contours in the first bz are sometimes composed of multiple segments terminating at the bz boundary . to insure that we get closed loops suitable for the evaluation of eq .",
    "( [ eq : bp ] ) , we actually do the initial contour - finding procedure in an extended zone with @xmath104 times the size of the first bz .",
    "we then select closed loops located near the central cell while identifying and discarding loops or portions of loops that correspond to periodic images of these chosen loops .",
    "the result is a set of closed loops that partially extend outside the first bz as shown in fig .",
    "[ fig : slice](b ) . of course",
    ", if there were open orbits on the fermi surface , it would not always be possible to select closed loops in the above sense ; one would have to accept a `` loop '' with @xmath93 as discussed following eq .",
    "( [ eq : bp ] ) .",
    "however , we never encounter such open orbits in practice for the types of materials studied here , in which the magnetization is aligned with a three - fold , four - fold , or six - fold rotational symmetry axis .",
    "the slices are perpendicular to the symmetry axis , and the symmetry ensures that open orbits can not occur on the slices .",
    "a potential difficulty in applying the fermi - loop method to real materials arises from the possible presence of degeneracies or near - degeneracies between bands .",
    "if two bands are degenerate at the fermi energy , this means that two fermi loops touch , and it is no longer straightforward to define and compute the berry phases of these loops .",
    "fortunately , the presence of ferromagnetic spin splitting and spin - orbit coupling removes almost all degeneracies . in our calculations we found no true degeneracies in hcp co or fcc ni , and",
    "the only degeneracies in bcc fe were found to lie in the @xmath105 plane .",
    "( in the latter case , we avoid the @xmath105 plane by picking a @xmath31 mesh that is offset so that this plane is skipped over . )",
    "on the other hand , we do find numerous weakly avoided crossings induced by the spin - orbit interaction , and while these introduce no difficulty in principle , they do require special care in practice .",
    "indeed , we find that it is important to sample the fermi surface very accurately in the vicinity of these crossings .",
    "to do so , we calculate the berry curvature at each @xmath49 using wannier interpolation , and if a large value is encountered , we introduce a refined mesh with @xmath106 greater density in this region , repeat the contour - finding procedure there , and replace the discretized representation of this portion of the loop with a denser one",
    ". we also take care to recompute @xmath107 at each @xmath49 and iteratively adjust the @xmath0-point location in the direction transverse to the loop in order to insure that @xmath107 lies precisely at the fermi energy .",
    "an example of a portion of a fermi loop that has been refined in this way is illustrated in the inset to fig .",
    "[ fig : slice](b ) .",
    "overall , the resulting number @xmath108 of @xmath0-points per loop ranges from several hundreds to thousands , depending on the size and complexity of the fermi loop .    in our current implementation",
    ", the entire procedure above is repeated independently on each of the slices . as already mentioned in sec .",
    "[ sec : quantum ] , it is important to make a consistent choice of branch of the berry phase @xmath52 on consecutive slices .",
    "we do this by adding or subtracting a multiple of @xmath43 to the berry phase calculated from eq .",
    "( [ eq : csum ] ) such that @xmath109 is satisfied , always checking for consistency between the first and last slice .      the presence of a net magnetization results in a considerable reduction in symmetry , but several symmetries still remain that can be exploited to reduce the computational cost . in the previous fermi - sea - based methods@xcite",
    "the use of symmetries is straightforwardly implemented by restricting the @xmath0-point sampling to the irreducible wedge of the bz . for the fermi - loop method , the use of symmetries needs more careful treatment .",
    "here we discuss the difficulties , and point out their solution , using ferromagnetic bcc fe as an example .",
    "we focus our attention on the mirror symmetries @xmath110 and @xmath111 .",
    "since each slice lies in an @xmath112-@xmath113 plane , we can use these to restrict the bandstructure calculation and the search for fermi contours to a reduced bz having one - fourth of the area of the full bz , as shown by the dashed line in fig .",
    "[ fig : slice](b ) .",
    "however , a typical fermi loop will no longer close within this reduced bz . because a berry phase is a global property of a closed loop , one can not just compute the berry phase of open segment lying inside the reduced bz and multiply by four ; the berry phase of this segment is ill - defined unless the phases of the wavefunctions at its terminal points are specified .",
    "our solution to this difficulty is illustrated in fig .",
    "[ fig : loop_sym ] .",
    "we make some arbitrary but definite choice of the phases of the bloch functions in the upper - right segment , compute the open - path berry phase following eq .",
    "( [ eq : bp ] ) , and multiply by four .",
    "we then add corrections that take account of the phase jumps at the segment boundaries .",
    "for example , we let @xmath110 acting on the bloch states from @xmath114 to @xmath115 define the bloch states from @xmath116 to @xmath117 .",
    "the correction arising from the @xmath116-@xmath114 boundary is then given by the phase of @xmath118 .",
    "( here @xmath110 is defined in the spinor context and includes a complex conjugation component . since the bloch functions are expressed in the wannier basis in our approach , information about the symmetries of the wannier functions",
    "has to be extracted and made available for the application of the symmetry transformations . )",
    "similar corrections , using also @xmath111 , are obtained for the @xmath117-@xmath119 , @xmath120-@xmath121 , and @xmath122-@xmath115 segment boundaries . by including these mismatch corrections ,",
    "we are able to calculate the global fermi - loop berry phase in a correct and globally gauge - invariant manner .",
    "we have tested this procedure and confirmed that the results obtained are essentially identical to those computed without the use of symmetry .",
    "the bz could in principle be reduced further in bcc fe using the diagonal mirror operations , but we have not tried to implement this .",
    "in this section we present the results of our calculations of the anomalous hall conductivity using the fermi - loop approach of eq .",
    "( [ eq : bp ] ) as applied to the three ferromagnetic transition metals fe , co and ni .",
    "we have previously presented calculations of the ahc of bcc fe computed using the fermi - sea formulation.@xcite here we adopt the same choice of wannier functions as in that work , namely 18 wannier functions covering the @xmath123 , @xmath124 and @xmath125 character and both spins .",
    "the orbitals of @xmath123 , @xmath124 , and @xmath126 character are actually rehybridized into wannier functions of @xmath127 type , and the wannier functions are only approximate spin eigenstates because of the presence of spin - orbit interaction ( see ref .   for details ) .    in our calculation for bcc",
    "fe , bands 5 - 10 cross the fermi energy . fig .",
    "[ fig : fs_fe ] shows the fermi - surface sheets for bands 7 - 10 , plotted using the xcrysden package.@xcite ( bands 5 and 6 give rise to small hole pockets , not shown . )",
    "some of these sheets ( especially 7 and 8) are quite complicated but , as expected , they all conform to the lattice symmetries . what is not clearly visible in these plots are the tiny spin - orbit - induced splittings , which change the connectivity of the fermi surface . as mentioned earlier",
    ", such features play an important role in the ahc , and need to be treated with care .",
    "we take the magnetization to lie along the @xmath128 $ ] axis . choosing @xmath129 and @xmath130 in the notation of sec .",
    "[ sec : floop ] , it follows that @xmath131 where @xmath132 is the primitive reciprocal cell volume , and we only need to compute the @xmath22 in eq .",
    "( [ eq : cshort ] ) .",
    "the slices are square in shape , and @xmath133 is discretized into 500 slices .    in fig .",
    "[ fig : bp_fe ] we have plotted the total berry phase eq .",
    "( [ eq : phitot ] ) on each slice as computed from eq .",
    "( [ eq : bp ] ) .",
    "the results are symmetric under mirror symmetry , so only half of the range of @xmath31 is shown .",
    "the sharp peaks and valleys in fig .  [ fig : bp_fe ] are related to degenerate or near - degenerate bands that have been split by the spin - orbit interaction , as was illustrated , e.g. , in the inset of fig .",
    "[ fig : slice ] . to validate the calculation",
    ", we compare it against a direct numerical integration of the berry curvature over the occupied bands using eq .",
    "( [ eq : phibc ] ) , as indicated by the symbols in fig .",
    "[ fig : bp_fe ] . in spite of rather complex and irregular fermi surfaces , the agreement between the two methods in fig .",
    "[ fig : bp_fe ] is excellent .",
    "the values of the integrated anomalous hall conductivity using the new approach and the reference approach are shown in the first and third lines of table  [ table : ahc ] .",
    "the second line shows the contribution obtained from integrating only the first term of eq .",
    "( [ eq : bp ] ) ; clearly , this contribution is very small .",
    "the agreement with the previous theory of yao _",
    "et al._@xcite is excellent , while the agreement with experiment is only fair .",
    "table  [ table : ahc ] will be discussed further in sec .",
    "[ sec : discresults ] .",
    "our approach also opens the possibility of discussing which fermi sheets are responsible for features visible in fig .",
    "[ fig : bp_fe ] . for example",
    ", the dip near @xmath134 and the peak near @xmath135 ( in units of @xmath136 ) come from sheets 8 - 9 , the peak near @xmath137 comes from sheets 6 - 8 , and the complex structure in the range of @xmath31 from 0.36 - 0.50 comes mainly from sheets 7 - 9 .",
    "overall , the contribution from bands 5 and 10 are almost negligible , and bands 7 - 9 give much the largest contributions .",
    "lrrr & bcc fe & fcc ni & hcp co fermi loop & 750 & @xmath1382275 & 478 fermi loop ( 1st term ) & 7 & 0 & @xmath1384 berry curvature & 753 & @xmath1382203 & 477 previous theory & 751 & @xmath1382073 & 492experiment & 1032 & @xmath138646&480    [ table : ahc ]      for fcc ni we chose 14 wannier functions , seven each of approximately spin - up and spin - down character .",
    "these were comprised of five wannier functions of @xmath125-like symmetry centered on the ni atoms and two wannier functions of tetrahedral symmetry located on the tetrahedral interstitial sites , similar to the choice that was made for cu in ref .  .",
    "the inner energy window was chosen to extend 21ev above the bottom of the bands , thus extending @xmath139 ev above the fermi energy and including several unoccupied bands as well .",
    "our calculation is consistent with previous dft calculations in predicting that five bands ( bands 8 - 12 ) cross the fermi energy in fcc ni .",
    "the fermi sheets for bands 9 - 12 are shown in fig .",
    "[ fig : fs_ni ] .",
    "band 8 only barely crosses the fermi energy and gives rise to very small hole pockets near the x points ( even smaller than those illustrated for band 9 ) .",
    "the existence of these pockets is a delicate feature that is not clearly confirmed experimentally and is inconsistent with some recent lda  +  @xmath83 calculations.@xcite however , including them or not has very little influence on our calculated ahc , as explained below .",
    "the shapes of the fermi sheets in fcc ni are somewhat more spherical than those of bcc fe .",
    "as expected , they again conform to the lattice symmetries .    in the case of fcc ni",
    ", the magnetization lies along the @xmath140 $ ] axis .",
    "choosing @xmath141 and @xmath142 in the notation of sec .",
    "[ sec : floop ] , it follows that @xmath143 , and we only need to compute the @xmath22 in eq .",
    "( [ eq : cshort ] ) .",
    "the slices are hexagonal in shape , and @xmath144 is discretized into about @xmath145 slices .",
    "the results are plotted in fig .",
    "[ fig : bp_ni ] , along with symbols denoting the reference calculation by an integration of the berry curvature over the slice .",
    "once again , the agreement is very satisfactory .",
    "the values of the integrated ahc are again summarized in table  [ table : ahc ] .",
    "a band - by - band analysis indicates that band 8 gives only a very small contribution , less than 5% in magnitude and opposite in sign , to the total ahc .",
    "the hole pockets in band 9 give a slightly larger positive contribution , but we find that the dominant negative contribution to the ahc comes from bands 10 - 12 .",
    "co in the hcp structure has two atoms per unit cell .",
    "we choose 18 wannier functions per co atom , nine for each spin , in a very similar manner as was done for fe in sec .",
    "[ sec : fe ] .",
    "we therefore have 36 wannier functions per cell .    in our calculation ,",
    "seven bands ( bands 16 - 22 ) cross the fermi energy in hcp co. we show the four largest fermi - surface sheets associated with bands 18 - 21 in fig .  [",
    "fig : fs_co ] .",
    "the fermi surfaces can be seen to respect the 6-fold crystal symmetry , and none of them touch each other .",
    "the magnetization of hcp co lies along the @xmath128 $ ] axis .",
    "we thus choose @xmath146 and @xmath147 in the notation of sec .",
    "[ sec : floop ] , and it follows that @xmath148 .",
    "the slices are hexagonal in shape , and @xmath133 is discretized into about @xmath149 slices .",
    "the results are plotted in fig .",
    "[ fig : bp_co ] , along with the symbols denoting the reference calculation by integration of the berry curvature . once again , the peaks and valleys correspond to the places where two loops approach one another closely . some pieces of the fermi surfaces of hcp co are nearly parallel to the slices ( see the bottom right panel of fig .",
    "[ fig : fs_co ] ) , so that the number and shapes of the fermi loops sometimes change rapidly from one slice to another . in particular , we found it difficult to enforce continuity of the branch choice of eq .",
    "( [ eq : bp ] ) as a function of @xmath31 near the sharp features at @xmath150 and @xmath151 in fig .",
    "[ fig : bp_co ] .",
    "we therefore redetermined the correct branch choice by comparing with the result of the berry - curvature integration at slices just outside these difficult regions . despite these difficulties",
    ", it can still be seen that the fermi - loop method works well for this case .",
    "some of the sharp structure appearing in fig .",
    "[ fig : bp_co ] in the range of @xmath31 from 0.4 - 0.5 ( in units of @xmath136 ) arises from the small hole pocket in band 16 , but this gives a rather small contribution to the total ahc .",
    "the peak around @xmath152 and the sharp dip around 0.18 comes mainly from the sheets associated with bands 20 and 21 .",
    "the second row of table  [ table : ahc ] shows the results computed using only the first term of eq .",
    "( [ eq : bp ] ) . in each case",
    ", its contribution is less than 1% of the total , and would therefore be negligible for most purposes .",
    "actually , it can be shown that the inclusion of the first term only in eq .",
    "( [ eq : bp ] ) of the present method is equivalent to carrying out the berry - curvature integration approach of ref .   with the @xmath153@xmath153 term omitted in eq .",
    "( 32 ) of that work ( that is , only the @xmath153@xmath154 and @xmath155 terms included ) .",
    "we have carried out this comparison and find values of 7 , @xmath1380.5 and @xmath1382s / cm for bcc fe , fcc ni , and hcp co , respectively , in very good agreement with the values reported in table  [ table : ahc ] .",
    "the physical interpretation for the small terms in the second row of table  [ table : ahc ] is basically that the full set of bloch - like states constructed from the wannier functions ( e.g. , the manifold of 18 bloch - like states in bcc fe ) has some small berry curvature of its own , and the projection of this curvature onto the occupied subspace gives the small first term of eq .",
    "( [ eq : bp ] ) . on the other hand ,",
    "spin - orbit induced splittings across the fermi level _ between _ bloch - like states built from these wannier functions give large , sharply peaked contributions to the berry curvature of the occupied subspace , and make a very much larger contribution to the total ahc .",
    "of course , the precise decomposition between the first and second term of eq .",
    "( [ eq : bp ] ) depends on the exact choice of wannier functions , but the present results seem to indicate that the dominance of the second term is probably a general feature , at least for systems in which the wannier functions are well localized and the spin - orbit splitting is not very strong .    as mentioned in the previous section , the overall agreement seen in table  [ table : ahc ] between the results computed using the fermi - loop approach and those computed using the berry - curvature integration",
    "indicate the internal consistency of our theory and implementation .",
    "the agreement with the results of yao and coworkers , which were obtained by a berry - curvature integration using an all - electron approach,@xcite also demonstrates the robustness of our pseudopotential implementation , including its ability to represent spin - orbit interactions correctly .      in the last row of table  [",
    "table : ahc ] we show comparison with some representative experimental values for the ahc of fe , ni , and co. however , it should be kept in mind that there is some uncertainty and variation in the values reported by different groups .",
    "for example , ref .",
    "gives a value for ni of @xmath138753s / cm and ref .",
    "reports a value for co of 500s / cm .",
    "it could well be that different kinds of experimental samples have different impurity and defect populations , leading to different extrinsic contributions to the ahc .",
    "since the theoretical values presented in table  [ table : ahc ] are all computed by including only the intrinsic karplus - luttinger contribution to the ahc , so that extrinsic skew and side - jump scattering contributions are neglected , it is most appropriate to compare with experimental measurements in which the effects of the intrinsic contribution are isolated .",
    "a serious effort in this direction has recently been made by studying and correlating the variation of both the longitudinal and the anomalous hall conductivity as a function of temperature.@xcite it was found that for fe , co , and ni , @xmath156 remains roughly constant between 150 and 300k while @xmath157 changes by about a factor of four .",
    "the value of @xmath158 in this plateau was attributed to the intrinsic mechanism , which should be independent of the scattering rate .",
    "the values thus obtained are about 970 and @xmath138480s / cm for fe and ni films respectively ( the value quoted in table  [ table : ahc ] for co from the same work is also a film value ) , and about 2000s / cm for single - crystal fe .",
    "the factor - of - two difference reported in ref .   between the intrinsic @xmath158 of fe in the single - crystal and film forms is puzzling and deserves further investigation .",
    "turning now to the comparison between theory and experiment , we find a very rough agreement at the level of signs and general trends .",
    "however , the agreement is not quantitatively accurate , except for co where the agreement is good .",
    "for fe our results are in very rough agreement ( @xmath15925% low ) compared to the results of ref .   or the film results of ref .  , but a factor of two smaller than the single - crystal results of ref .  .",
    "clearly the most serious discrepancy is for ni , for which we get a consistent sign but a much larger magnitude than indicated by the experiments .",
    "( the issue@xcite of whether a hole pocket really appears in band 8 of fcc ni is not relevant since , as indicated in sec .",
    "[ sec : ni ] , it makes a quite small numerical contribution to our theoretical result . )",
    "while the available experimental values for ni appear to be roughly consistent with each other , we are not aware of any study using the methods of ref .   applied to both films and single crystals of ni . until the experimental situation is clarified further , a final judgment on the degree of disagreement with the values based on dft calculations should perhaps be withheld .    in the meantime",
    ", it would be desirable to face some of the challenges and open questions that remain on the theoretical side .",
    "for example , not much is yet known about the accuracy of common exchange - correlation functionals , such as the pbe functional used here,@xcite for computing the ahc .",
    "fe , ni and co have open @xmath125 shells and can be considered from one point of view to be strongly - correlated systems . the fact that the magnetic moments are given accurately by dft ( see table [ table : spin_moment ] ) does not necessarily mean that more delicate properties , especially those like the ahc and the magnetocrystalline anisotropy@xcite that depend on spin - orbit interactions , will be given accurately .",
    "it is possible that the use of more sophisticated density - functional approaches ( e.g. , current - density functional theories ) or higher - level many - body approaches may ultimately prove necessary .",
    "finally , it would be desirable to develop dft - based methods for computing the defect - related extrinsic contributions , but this will also prove to be a daunting challenge , not least because the relevant defect populations are not known .    in summary ,",
    "experiments and dft - based theories agree on the orders of magnitude and signs of the intrinsic karplus - luttinger contributions to the ahc in these three ferromagnetic metals , and the results for fe and especially co suggest that quantitative agreement may be obtainable . the substantial discrepancy for ni deserves further attention .",
    "the motivation for developing a method for computing the ahc that relies only on information computed on the fermi surface is , to some degree , esthetic and philosophical : haldane argued that the ahc is physically most naturally regarded as a fermi - surface property,@xcite and as such should be computed using a method that does not make use of extraneous information in arriving at the desired quantity .",
    "however , a much more important motivation from the practical point of view is the idea that the computational effort might be drastically reduced by having to compute quantities only on the two - dimensional fermi surface rather than on a three - dimensional mesh of @xmath0-points .    in the present implementation as it stands , unfortunately , the computational savings gained through the use of the fermi - loop berry - phase approach is quite modest . after taking advantage of the symmetry as discussed in sec .",
    "[ sec : sym ] , the total computational time of our ahc calculation for bcc fe is about 1.7 hours using a @xmath160 k - mesh on each of 500 slices , to be compared with about 2 hours using our previous method of ref .  .",
    "( these timings are on a 2.2 ghz amd - opteron pc , and neither includes the wannier construction step , which takes about 2.5 hours . ) roughly , the work on each slice can be divided into three phases : step 1 , computing the energy eigenvalues on the @xmath161 k - mesh ; step 2 , executing the contour - finding algorithm ; and step 3 , evaluating eq .",
    "( [ eq : bp ] ) on the discretized fermi loops .",
    "we find that less than 1% of the computer time goes to step 2 , while the remainder is roughly equally split between step 1 and 3 .",
    "the operations in these steps have been greatly accelerated by making use of wannier interpolation methods , but this is also the case for the comparison method of ref .  .",
    "( we emphasize that , for this reason , both the method of ref .   and the present one are orders of magnitude faster than methods based on direct first - principles calculations at every @xmath0-point . )    many opportunities for further reduction of the computer time are worthy of further exploration .",
    "regarding step 1 , for example , at the moment the contour - finding is done independently on each slice ; it might be much more efficient to step from slice to slice and use a local algorithm to determine the deformation of the fermi contours on each step .",
    "it may also be possible to do a first cut at the contour - finding using a coarser k - mesh ( say @xmath162 ) and then refine it in regions where the loops approach one another or have sharp bends .",
    "it may also be possible to take larger steps between slices in most regions of @xmath31 , and fall back to fine slices only in delicate regions . in implementing all such strategies",
    ", however , one should be careful to avoid missing any small loops that might appear suddenly from one slice to the next , or which might be missed on an initial coarse sampling of the slice .",
    "it may also be interesting to explore truly three - dimensional algorithms for finding contour surfaces , and then derive two - dimensional loops from these .    as for step 3",
    ", it should be possible to use a lower density of @xmath0-points in the portions of the loop discretization where the character of the wavefunctions is changing slowly . the time for this step will also obviously benefit from taking larger steps between slices in regions where this is possible .",
    "finally , a reduction by a factor of two or more may be possible by making use of symmetries not considered in sec .",
    "[ sec : sym ] , such as the diagonal mirror symmetries ( @xmath163 etc . ) in bcc fe .",
    "the exploration of these issues is somewhat independent from the quantum - mechanical formulation of the underlying theory , which is the main focus of the present work , and we have therefore left the exploration of these possibilities for future investigations .    finally , it should be emphasized that the computational load scales strongly with the dimension of the wannier space used to represent the wavefunctions . in our calculations , this was 18 , 14 , and 36 for fe , ni , and co , respectively . in some materials",
    ", there may be only a few bands crossing the fermi energy , and it might be possible to represent them using a much smaller number of wannier functions .",
    "this is the case in many transition - metal oxides such as sr@xmath164ruo@xmath165 , cuprate superconductors , etc . in ferromagnetic materials of this kind",
    ", it should be possible to choose an inner window in the wannier disentanglement procedure@xcite that brackets the fermi energy but does not extend to the bottom of the occupied valence band , and to generate just a handful of wannier functions ( e.g. , three @xmath166 orbitals times two for spin ) to be used in the wannier interpolation procedure",
    ". then all matrices used in that procedure would be very much smaller ( e.g. , 6@xmath1676 ) and the computation would go considerably faster .",
    "in summary , we have developed a first - principles method for computing the intrinsic ahc of ferromagnets as a fermi - surface property .",
    "unlike conventional methods that are based on a @xmath0-space volume integration of the berry curvature over the occupied fermi sea , our method implements the fermi - surface philosophy by dividing the brillouin zone into slices normal to the magnetization direction and computing the berry phases of the fermi loops on these slices .",
    "while haldane has pointed out that only the non - quantized part of the ahc can be determined in principle from a knowledge of fermi - surface properties only , we find in practice that it is straightforward to make the correct branch choice and resolve the quantum of uncertainty by doing a two - dimensional berry - curvature integration on just one or a few of the slices .",
    "our method also makes use of methods of wannier interpolation to minimize the number of calculations that have to be done using a full first - principles implementation ; almost all the operations needed to compute the ahc are actually done by working with small matrices ( e.g. , 18@xmath16718 for bcc fe ) in the wannier representation .",
    "the new method also allows us to discuss the contributions to the ahc arising from individual fermi sheets or groups of sheets .",
    "we have tested and validated our new method by comparing with our earlier implementation of a fermi - sea berry - curvature integration for bcc fe , fcc ni , and hcp co. the different crystal structures and magnetization orientations in these three materials also allow us to demonstrate the flexibility of the method in dealing with these different cases .",
    "we find excellent agreement between the two approaches in all cases ."
  ],
  "abstract_text": [
    "<S> while the intrinsic anomalous hall conductivity is normally written in terms of an integral of the electronic berry curvature over the occupied portions of the brillouin zone , haldane has recently pointed out that this quantity ( or more precisely , its `` non - quantized part '' ) may alternatively be expressed as a fermi - surface property . here </S>",
    "<S> we present an _ ab - initio _ </S>",
    "<S> approach for computing the anomalous hall conductivity that takes advantage of this observation by converting the integral over the fermi sea into a more efficient integral on the fermi surface only . </S>",
    "<S> first , a conventional electronic - structure calculation is performed with spin - orbit interaction included . </S>",
    "<S> maximally - localized wannier functions are then constructed by a post - processing step in order to convert the _ ab - initio _ electronic structure around the fermi level into a tight - binding - like form . working in the wannier representation , the brillouin zone is sampled on a large number of equally spaced parallel slices oriented normal to the total magnetization . on each slice </S>",
    "<S> , we find the intersections of the fermi - surface sheets with the slice by standard contour methods , organize these into a set of closed loops , and compute the berry phases of the bloch states as they are transported around these loops . </S>",
    "<S> the anomalous hall conductivity is proportional to the sum of the berry phases of all the loops on all the slices . </S>",
    "<S> illustrative calculations are performed for fe , co and ni .    # 1 # 1 # 1 # 1    3.1 in 0.5 in </S>"
  ]
}