{
  "article_text": [
    "the hegra system @xcite of imaging atmospheric cherenkov telescopes ( iacts ) is the first installation employing the stereoscopic observation of air showers with multiple cherenkov telescopes on a routine basis . compared to individual telescopes",
    ", iact stereoscopy provides an improved reconstruction of shower parameters and better background rejection ( see , e.g. , @xcite ) .",
    "major new instruments for vhe gamma - ray astronomy now in the construction phase  such as veritas @xcite and hess @xcite  are based on the concept of iact stereoscopy , with frequently half a dozen or more telescopes observing the same shower from different viewing angles .    in cherenkov telescopes @xcite , the cherenkov light emitted by shower particles is imaged onto a `` camera '' in the focal plane of a large reflector , generating an elongated , roughly elliptical image .",
    "the major axis of the image represents the image of the shower axis .",
    "therefore , the major axis of the image points towards the image of the source on one side , and to the point where the shower axis intersects the plane of the telescope dish on the other side ( fig .  [ fig_image ] ) . if a shower is observed by a stereoscopic system of two cherenkov telescopes , its direction ( i.e. , the image of the source ) can be determined by superimposing the two images and intersecting their major axes .",
    "similarly , the core location is obtained by intersecting the image axes , starting from the locations of the two telescopes ( assuming that all telescope dishes are in a common plane ) .",
    "thus , the four parameters describing the major axes of the two images can be used to determine the four parameters describing the shower geometry - a direction in space and an impact point in a reference plane .",
    "it may be worth noting that the stereoscopic reconstruction of air showers makes the single ( trivial ) assumption than on average cherenkov images are symmetric with respect to the ( image of the ) shower axis .    if a shower is observed by more than two telescopes , the shower geometry is overconstrained and some kind of suitable averaging or fitting procedure is required to extract optimum shower parameters from the information obtained from the different views .",
    "particularly crucial is the case where the quality of the information provided by the different telescopes differs significantly , e.g. because one telescope is well within the light pool and sees a large intensity of cherenkov light , whereas a distant telescope may see barely enough light to provide a meaningful image .",
    "ideally , the reconstruction algorithm should take this difference in image quality into account .",
    "this paper reviews a number of different algorithms and describes tests of their performance based on the large sample of gamma rays @xcite collected with the hegra iact system during the 1997 outburst of mkn 501 .",
    "to reconstruct shower parameters from the telescope images , two alternative approaches can be followed :    using image parameters .",
    ": :    images provided by the different telescopes are analyzed individually ,    and their key features are summarized in a small number of parameters    ( usually the well - known hillas parameters ) .",
    "shower parameters are    derived on the basis of these image parameters . using the full image information .",
    ": :    a global optimization procure is applied to derive the shower    parameters directly from the amplitudes measured in the individual    pixels of all cameras .",
    "an example of such techniques are global fits ,    where parameterized shower images or image templates are matched to    the images observed in the different telescopes @xcite .    in this paper",
    ", we will concentrate primarily on methods of the first type .",
    "they are easier to implement , and usually require significantly less processing time .",
    "often , analytical solutions for the shower parameters can be derived , and one does not have to worry about issues which arise in numerical optimization procedures , such as the choice of proper starting values and the convergence to the global optimum . for completeness and to serve as a reference , also results based a technique of the second type will be given .",
    "we will discuss seven different algorithms , six based on the hillas image parameters and one based on a global fit to pixel amplitudes .",
    "algorithm 1 .",
    ": :    for all pairs of telescopes , the image axes , derived using the hillas    parameterization , are intersected . in case of @xmath0    telescope images ,",
    "the resulting @xmath1 intersection    points are averaged , weighted with the sine of the angle between the    image axes , to take into account that image pairs with a large stereo    angle provide the most precise determination of the shower axis .",
    "similarly , the core location can be obtained by intersecting the image    axes , starting from the telescope locations .",
    "this technique is used ,    e.g. , for all published results from the hegra iact system .",
    "it is    illustrated in fig .",
    "[ fig_method](a ) .",
    "algorithm 2 .",
    ": :    a drawback of algorithm 1 is that differences in the quality of the    images in the different telescopes are not taken into account .",
    "the    algorithm can be improved by determining the uncertainty in the    determination of the image c.o.g . and in the direction of the image    axis , and by taking the resulting errors ( see fig .",
    "[ fig_image ] ) into    account when intersecting the image axes , see fig .",
    "[ fig_method](b ) .    for @xmath0 intersecting lines with fixed error bands ,",
    "the    optimum solution can be derived analytically . since the width of the    error band associated with each image depends on the distance    @xmath2 to the image c.o.g .",
    ", one needs to iterate , but the    result is stable after two iterations .",
    "this method also provides    errors on the shower parameters .",
    "algorithm 3 .",
    ": :    the image shape contains information on the distance @xmath2    ( fig .",
    "[ fig_image ] ) between the image c.o.g . and",
    "the image of the    source . in particular , the ratio of image _ width _ over image _ length _    can serve as a measure for @xmath2 ( see also @xcite ) .",
    "smaller    _ width / length _ implies large impact distance and large    @xmath2 .",
    "together with a suitable error estimate for    @xmath2 , the location , orientation and shape of each image    constrains the image of the source to two elliptical regions on both    sides of the image ( reflecting the left - right ambiguity inherent in    the parameterization of shower images ) , see fig .",
    "[ fig_method](c ) . for    two or more images ,",
    "these error ellipses can be combined analytically    to yield the optimum shower direction and its errors .",
    "an analogous    method determines the core location .",
    "algorithm 4 .",
    ": :    algorithms 1,2,3 determine independently the shower direction and the    core location .",
    "since the measurement of the image orientation is used    both in the determination of the shower direction and of the shower    core , a combined determination of core and direction should yield    improved results .",
    "technically , for a given shower geometry , the    predicted image center lines are calculated , and a    @xmath3 is defined measuring the agreement of the    observed image and its orientation with this prediction .",
    "shower    geometry is chosen to minimize the sum of @xmath3 over    telescope images .",
    "this method is illustrated in fig .",
    "[ fig_method](d ) .",
    "algorithm 5 . : :    algorithm 4 can be augmented to include the estimate of    @xmath2 from the _ width / length_-ratio ( see algorithm 3 ) , by    adding corresponding terms to the @xmath3 .",
    "algorithm 6 .",
    ": :    similar to algorithm 4 , this algorithm  proposed by hillas",
    "@xcite     calculates the image axes for a given shower geometry , and varies the    shower parameters such as to minimize the sum of the squared distances    of pixels to the axes , weighted with the pixel amplitudes .",
    "this    technique is analogous to the determination of the image axis for    single images , except that the weighted sum of pixel distances is    minimized for the entire set of images together , rather than for    single images .",
    "algorithm 7 .",
    ": :    this last algorithms makes use of the full image information , by    comparing the measured images with parameterizations of shower images ,    considering the shower geometry , the energy and the height of the    shower maximum as free parameters which are chosen to minimize the    @xmath3 describing the agreement between model and data .    on the basis of monte - carlo simulations ,",
    "the technique was discussed    in @xcite ; a similar method was presented in @xcite .",
    "the method used    here differs from @xcite in a different choice of weights , which    result in improved convergence .",
    "in our implementation , algorithms 1,2 and 3 use analytic expressions ( with one iteration in case of algorithm 3 ) , whereas algorithms 4 through 7 are based on numerical minimization procedures .",
    "to test the different algorithms and to experimentally determine the directional resolution achieved with each algorithm , data collected with the hegra iact system during the 1997 outburst of mkn 501 were used . in the hegra iact system",
    "is located on the site of the observatorio del roque de las muchachos on the canary island of la palma at 2200 m asl . in 1997 ,",
    "the iact system comprised four telescopes , located in the center and at three sides of a square with roughly 100  m side length .",
    "a fifth telescope at the remaining corner was integrated into the system in 1998 .",
    "the telescopes are identical , equipped with 8.5  m@xmath4 mirrors with 5  m focal length , and with 271-pixel cameras with a diameter of the field of view of @xmath5 , and an equivalent pixel size of @xmath6",
    ". detailed about the hardware and the data analysis can be found in @xcite .",
    "the trigger condition for individual telescopes requires a coincidence of two pixels above a threshold of 10 photoelectrons ( before june  97 ) or 8 photoelectrons ( after june  97 ) . for typical gamma - ray images , cameras trigger once the image has more than about 40 photoelectrons . the hegra iact system as a whole",
    "is triggered and data are recorded whenever at least two telescopes trigger in coincidence ( see @xcite for details on the trigger system ) .    in the design of the hegra cameras and their electronics ,",
    "an important aspect was that one wanted to read out not only those telescopes which had triggered , but also the remaining telescopes , which will shower fainter , but frequently still usable images .",
    "camera signals are digitized continuously by 120  mhz flash - adcs and are stored in a 34  @xmath7s ring buffer .",
    "a coincidence trigger of at least two telescopes is generated with a delay of 1 to 2 @xmath7s ; after such a trigger , the readout system addresses the relevant locations in the flash - adc memory and extracts the signals .    in 1997 , mkn 501 was observed in the so - called wobble mode , with the source offset by @xmath8 in declination from the optical axis of the telescopes .",
    "the offset alternated every 20  min .",
    "a region offset by the same amount , but in the opposite direction , is used as a control region and for background subtraction .",
    "the analysis is based on data taken during three new - moon periods , where the gamma - ray flux from mkn 501 was particularly high .",
    "only data at small zenith angles , below @xmath9 , are included ; these showers behave essentially like `` ideal '' vertical showers , at least as far as the angular reconstruction is concerned .",
    "the usual selections concerning data quality were applied , see @xcite . in total , the sample comprises 100748 events within @xmath8 from the source , and 80878 events in the equivalent off - source region .",
    "images were flat - fielded , and corrections for pointing errors of the telescopes were applied @xcite .",
    "image parameters were determined by selecting `` image pixels '' as those pixels which either have a signal of 6 or more photoelectrons , or which have a signal of at least 3 photoelectrons and are adjacent to a pixel with 6 or more photoelectrons .",
    "some of the algorithms discussed above require errors on the image parameters as input for the reconstruction of the shower axis .",
    "the relevant image parameters are the coordinates @xmath10 of the center of gravity of the images , and the direction @xmath11 of the major axis of the image . to parameterize the errors on the center of gravity , it is more convenient to use a coordinate system where axes @xmath12 are defined by the major ( @xmath13 ) and minor ( @xmath14 ) axes of the image . in this system ,",
    "the errors on @xmath13 , @xmath14 , and on the orientation @xmath11 of the image should be essentially uncorrelated . the errors ( in units of degr . )",
    "were parameterized on the basis of monte - carlo simulations @xcite : @xmath15 and @xmath16 here , @xmath17 denotes the number of photoelectrons in the image ( _ size _ ) , @xmath18 the image _ width _ and @xmath19 the _",
    "length_. the error in @xmath13 is not very relevant as long as the major axis of the image points more or less towards the source ; @xmath20 was used .    as a first check to see",
    "if these errors describe the uncertainties in the real data , the distribution in _ miss _ was plotted for individual telescopes of the ( background subtracted ) mkn 501 gamma - ray sample , with the ( signed ) _ miss _ parameter normalized to the expected error .",
    "the _ miss _ parameter describes the distance between the image axis and the point on the camera which corresponds to the image of the source .",
    "the error on _ miss _ is @xmath21 . for typical values of @xmath22",
    "the @xmath23 term gives the dominant contribution .",
    "the normalized _ miss _ distribution has an rms width of 1.06 , and its central part is well described by a gaussian with a width of 0.90 , indicating both that the errors estimated are accurate within 10% , and that alignment errors of the telescopes are small on the scale of the resolution .    to verify that also errors on the shower direction can be reliably calculated by propagating the errors on the image parameters , events were reconstructed with algorithm 2 and those events",
    "were selected where the predicted error on the shower direction was less than @xmath24 ( fig .",
    "[ fig_sel](a ) ) . for these events ,",
    "the distribution in the difference between the reconstructed shower direction and the source , mkn 501 , was plotted ( fig .",
    "[ fig_sel](b ) ) , projected onto two orthogonal axes . indeed , for this subsample of events , a ( projected ) angular resolution of @xmath25 is obtained , confirming the validity of the approach to estimate the errors , by treating the image parameters obtained by the different telescopes as independent measurements . here and in the following",
    ", ` angular resolution ' refers to the width of the angular distribution of shower axes in a projection . if angular resolution is defined as the half opening angle of a cone in space , which contains 68% of the events , the numerical values are a factor 1.5 larger ( assuming a gaussian distribution in the errors ) .",
    "[ fig_sel](c ) finally shows the measured angular resolution as a function of the predicted resolution , demonstrating good agreement except for the tail of events with very large predicted errors ( @xmath26 ) , where the measured angular resolution is slightly better than expected ( most likely due to imperfections in the parameterizations of the errors ) .",
    "hence , already with the extremely simple and fast algorithm 2 one can reliably reject events with poorly reconstructed showers , which is important , e.g. , for the determination of energy spectra .",
    "in addition to errors on the image parameters , algorithms 3 and 5 require an estimate of @xmath2 based on the image shape ; we used the empirical relations @xmath27",
    "the angular resolutions obtained with the seven algorithms described above are summarized in fig .",
    "[ fig_resol ] , for three characteristic data samples chosen to emphasize the specific features on the algorithms :    2-telescope events : :    ( full squares ) . in these events ,",
    "exactly two telescopes have    triggered , and only these two telescopes are used for the    reconstruction .",
    "the 2-telescope sample serves primarily to verify that    all algorithms work properly ; unless additional shape information is    used ( such as in algorithms 3 , 5 , and 7 ) , all algorithms should give    identical results if only two images are used in the    reconstruction .",
    ", compared to the @xmath28 for    the 2-telescope sample  see below . ]",
    "2 + 2-telescope events : :    ( open circles ) . in these events , exactly two telescopes have    triggered , but images in the other two untriggered telescopes are    included in the reconstruction .",
    "these events represent a particular    challenge to reconstruction algorithms , since they combine images of    very different quality .",
    "triggered images contain a mean number of    about 150 photoelectrons , compared to about 30 photoelectrons in    images which did not trigger .",
    "4-telescope events : :    ( full circles ) . in these events ,",
    "all four telescopes have triggered    and are used in the reconstruction .",
    "this class of events will    obviously provide the best angular resolution .",
    "for the 2-telescope sample ( full squares in fig .",
    "[ fig_resol ] ) , algorithms 1 , 2 , 4 and 6 do indeed provide the identical angular resolution .",
    "algorithms 3 , 5 and 7  which add shape information  give significantly improved resolution .",
    "this improvement can be traced to events with small stereo angles , i.e. with shower cores along the line connecting the two telescopes ; for such events , the purely geometrical reconstruction fails and the otherwise relatively poor shape information helps to stabilize the reconstruction .",
    "adding now in the reconstruction the faint images of the other two telescopes , which did not trigger  the 2 + 2-telescope sample ( open circles )  one mixes images of rather different quality .",
    "if all images are combined with equal weight , as in algorithm 1 , the faint images hurt the resolution ; the resulting resolution is worse than if only the two triggered telescopes are used . in all other algorithms ,",
    "the faint images weigh less than the good images , either because explicitly larger errors on the image parameters are assigned ( algorithms 2 - 5 ) , or because the effect of the images is weighted with the number of photoelectrons they contain ( algorithms 6,7 ) .",
    "these algorithms improve the angular resolution by about 20% to 30% compared to the 2-telescope sample .",
    "little is gained by adding the shape information via the @xmath29 relation ; with four views there is always at least one reasonably large stereo angle .    in many respects , the 4-telescope sample ( full circles )",
    "is less critical than the 2 + 2-telescope sample , since the differences between the quality of the four images are not nearly as big .",
    "hence , it is no surprise that the variation between algorithms is smaller , ranging from a resolution of @xmath30 for the worst case ( algorithm 1 ) to @xmath31 for the best case ( algorithm 7 ) .",
    "one may wonder why the joint fits of the shower direction and of the core location ( algorithms 4 , 5 , 6 ) do not provide significant improvements .",
    "the explanation is relatively simple , and is illustrated in fig .",
    "[ fig_dircore ]",
    ". the geometrical figure describing the determination of the direction ( fig .",
    "[ fig_dircore](a ) ) and the figure describing the determination of the core ( fig .",
    "[ fig_dircore](b ) ) are essentially scaled versions of each other , since the _ distance _",
    "parameter @xmath2 of the image is approximately proportional to the distance @xmath32 from the telescope to the core location .",
    "the main difference is that in the determination of the shower direction , the error on the position of the image c.o.g .",
    "enters in addition to the error on the image orientation ; in the core determination , only the latter matters . since the error on the c.o.g .",
    "is usually of little relevance compared to the error on the orientation , the joint fit does not add additional constraints .",
    "indeed , one finds that in algorithm 2 , the @xmath3 describing how well the telescopes match in the determination of the shower direction , and the @xmath3 of the core determination are highly correlated ( fig .  [ fig_dircore](c ) ) .",
    "fitting the full image information ( algorithm 7 ) results in only very modest improvements compared to the simpler algorithms 2 - 6 . at least with the pixel size of @xmath6 of the hegra cameras , the hillas image parameters seem to very efficiently",
    "capture the essence of the information contained in the images .",
    "an interesting question is how the angular resolution depends on the number of telescopes @xmath33 used in the reconstruction .",
    "if the individual images can be considered as independent , the resolution should improve like @xmath34 .",
    "however , at some point shower fluctuations will start to dominate the resolution .    as mentioned above , to address this issue one can not simply use the event samples where exactly 2 , 3 or 4 telescopes have triggered , since the 2-telescope sample is biased towards low - energy or distant showers , whereas in the 4-telescope sample central high - energy events are enhanced . to start from identical event samples and to avoid a `` trigger bias '' ,",
    "the investigation was based on the 4-telescope sample , but only a subset of telescopes was used to reconstruct the shower .",
    "the resulting resolutions are illustrated in fig .",
    "[ fig_resol](a ) , for algorithms 2 and 3 .",
    "( note that algorithm 3 can reconstruct the shower direction from a single image , apart from the head - tail ambiguity . ) except for the minimum number of telescopes  1 for algorithm 3 and 2 for algorithm 2  data are consistent with a @xmath34-dependence .",
    "the issue was further was explored on the basis of monte - carlo simulations for the hess telescope system @xcite .",
    "these simulations used an array of 589 telescopes , arranged as a square grid of 31 x 19 telescopes , spaced 33.3  m. in the analysis , arbitrary subsets of telescopes can be selected .",
    "the sets studied here include a set with all telescopes turned on , a set where every other telescope is active , and sets with telescopes on square grids with an effective spacing of 67  m , 100  m , 133  m , and 167  m. only showers well contained within the array were considered .",
    "[ fig_resol1](b ) shows the resulting angular resolution as a function of the mean number of telescopes used in the reconstruction .",
    "the @xmath34-dependence of the resolution holds up to about 50 telescopes used per event , and resolutions better than @xmath35 . for even higher telescope numbers",
    ", the dependence appears to flatten somewhat .",
    "the main conclusions from these studies of different algorithms for the stereoscopic reconstruction of multi - telescope iact events are :    * by assigning and properly propagating errors of the image parameters , reliable error estimates for the shower direction can be obtained .",
    "it is possible to select subsamples with improved angular resolution ",
    "less than @xmath36 , e.g.  for special purposes , such as to study the size of the source , or to exclude poorly reconstructed events . * in particular when combining multiple and partly redundant images of rather different quality , the reconstruction algorithm must properly account for these differences . *",
    "using image shape information to constrain the direction of the shower axis helps in the case of 2-telescope events with small stereo angles ; for events with more than two telescopes , the improvement is small . *",
    "compared to the simple , robust and fast algorithms 2 and 3 , the more ` fancy ' algorithms 4 , 5 and 6 as well as the rather sophisticated image fitting procedure of algorithm 7 give only modest improvements . for most practical purposes",
    "; algorithms 2 or 3 may represent the simplest and best choice .    of course , these conclusions hold primarily for the hegra cherenkov telescopes .",
    "to which extent they can be applied to other iact systems depends on the degree of similarity in the trigger concept and the layout of the cameras .",
    "the support of the hegra experiment by the german ministry for research and technology bmbf and by the spanish research council cycit is acknowledged .",
    "we are grateful to the instituto de astrofisica de canarias for the use of the site and for providing excellent working conditions .",
    "we thank the other members of the hegra ct group , who participated in the construction , installation , and operation of the telescopes .",
    "we gratefully acknowledge the technical support staff of heidelberg , kiel , munich , and yerevan .",
    "99 a. daum et al . , astropart .",
    "( 1997 ) 1 .",
    "n. bulian et al . , astropart .",
    "( 1998 ) 223 .",
    "f. aharonian et al . , astron .",
    "astrophys . 342",
    "( 1999 ) 69 .",
    "f. aharonian et al . , astropart .",
    "( 1997 ) 343 , 369 .",
    "veritas letter of intent , t.c .",
    "weekes et al .",
    "hess letter of intent , f. aharonian et al .",
    "weekes , space science rev . 75 ( 1996 ) 1 ;",
    "m. f. cawley and t.c.weekes , experimental astronomy 6 ( 1996 ) 7 . m. ulrich et at . , j. phys .",
    "g 24 ( 1998 ) 883 .",
    "s. le bohec et al . , nucl .",
    "instr . meth .",
    "a416 ( 1998 ) 425 .",
    "akerlof et al . , astroph .",
    "j. 377 ( 1991 ) l97 ; j.h .",
    "buckley et al . , astron .",
    "astrophys . 329",
    "( 1998 ) 639 ; v. connaughton et al .",
    ", astropart .",
    "( 1998 ) 179 .",
    "m. hillas , talk at the workshop on tev gamma - ray astronomy with systems of cherenkov telescopes , ringberg castle ( 1996 ) .",
    "g.  hermann , proceedings of the int .",
    "workshop `` towards a major atmospheric cherenkov detector iv '' , padua , ( 1995 ) , m. cresti ( ed . ) , p. 396 .",
    "g. phlhofer et al .",
    ", astropart .",
    "( 1997 ) 101 .",
    "a. konopelko et al .",
    ", astropart .",
    "phys . , in print , and astro - ph/9901199 .",
    "a. konopelko , astropart .",
    ", in print , and astro - ph/9901365 ."
  ],
  "abstract_text": [
    "<S> for air showers observed simultaneously by more than two imaging atmospheric cherenkov telescopes , the shower geometry is overconstrained by the images and image information should be combined taking into account the quality of the images . </S>",
    "<S> different algorithms are discussed and tested experimentally using data obtained from observations of mkn 501 with the hegra iact system . </S>",
    "<S> most of these algorithms provide an estimate of the accuracy of the reconstruction of shower geometry on an event - by - event basis , allowing , e.g. , to select higher - quality subsamples for precision measurements .    epsf    ,    ,    ,    , </S>"
  ]
}