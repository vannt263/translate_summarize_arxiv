{
  "article_text": [
    "starting from the introduction of the lwr model @xcite , a huge literature about macroscopic fluid - dynamic models for traffic flow was developed .",
    "more recently , models , theory and numerical approximations for traffic flow on networks became a hot topic @xcite .",
    "the interest in forecasting traffic flow on large networks became even stronger in the very last years , due to the increasing number of gps devices ( smartphones , satellite navigators , black boxes ) which provide real - time traffic data .",
    "private companies like google , waze mobile , nokia @xcite , inrix , octotelematics @xcite , zeropiu , yandex , started collecting data and , in some cases , broadcasting traffic forecast .    _ the model .",
    "_ in this paper we study from the numerical point of view a first - order version of the model proposed in ( * ? ? ?",
    "* sect.4 ) .",
    "let us consider a network , i.e.  a directed graph with @xmath0 arcs ( roads ) and @xmath1 nodes ( junctions ) .",
    "_ vehicles moving on the network are divided on the basis of their desired path_. let us assume that the number of possible paths on the graph is @xmath2 and denote those paths by @xmath3 .",
    "we stress that paths can share some arcs of the networks .",
    "a point @xmath4 of the network is characterized by both the path @xmath5 it belongs to and the distance @xmath6 from the origin of that path .",
    "we denote by @xmath7 the density of the vehicles following the @xmath5-th path at point @xmath8 at time @xmath9 , and we assume that @xmath10 $ ] for some maximal density @xmath11 . note that we have , by definition , @xmath12 if @xmath13 .",
    "we also define @xmath14 i.e.  @xmath15 is the sum of all densities living at @xmath4 at time @xmath16 .",
    "the function @xmath17 is discontinuous and takes into account the topology of the network .",
    "note that , for any point @xmath8 , the densities @xmath7 , @xmath18 , are admissible if their sum @xmath19 .",
    "let us denote by @xmath20 the velocity of vehicles ( given as a function of the density ) and by @xmath21 the flux of vehicles . the lwr - based model is constituted by the following system of @xmath2 conservation laws with space - dependent and discontinuous flux @xmath22 or , equivalently , @xmath23 for @xmath18 .",
    "if @xmath24 we have , _ a fortiori _ , @xmath25 , then it is convenient to set @xmath26 in ( [ eq : system_f ] ) to avoid singularities . in the following",
    "we assume that the flux @xmath27)\\cap c^1((0,{\\rho_{\\textup{max}}}))$ ] and @xmath28 equations of the system ( [ eq : system_v ] ) ( or ( [ eq : system_f ] ) ) are coupled by means of the velocity @xmath29 , which depends on the total density @xmath17 .",
    "on the other hand , not all the equations of the system are coupled with each other because paths do not have necessarily arcs in common .",
    "it is plain that the number of equations in the system grows rapidly when the number of nodes of the graph increases , making unfeasible the computation of a numerical solution . to keep the computational load within reasonable limits",
    ", we also propose another version of the model which splits the vehicles on the basis on their path only at junctions .",
    "in this way , along the arcs a single equation for the total density @xmath17 is considered .",
    "the price to pay is that the global behavior of drivers is lost .    _ relevant literature . _",
    "the _ multi - path _ model described above differs from the so - called _ multi - population _ or _ multi - class _ models , see , e.g. , @xcite . in those cases ,",
    "the models consist of one equation for a single road ( extension to networks is also possible ) with different velocity functions @xmath30 , one for each class of vehicles .",
    "typically , the populations have different maximal velocities , in order to take into account different types of vehicles or drivers behaviors .",
    "an apparently similar model is the one presented in @xcite ( see also @xcite ) . in that case , vehicles are divided in different populations on the basis on their source - destination pair . given the total density @xmath17 of all vehicles , the density @xmath31 of the @xmath5-th population is given by @xmath32 where @xmath33 specifies the percentage of the total density that started from source @xmath34 , it is moving towards the final destination @xmath35 , and it is at @xmath6 at time @xmath16 .",
    "moreover , @xmath36 , @xmath37 are the origin and the destination associated to the @xmath5-th path , respectively . then , a standard pde for @xmath17 is coupled with a system of pdes for the coefficients @xmath38 s .",
    "several papers investigate from the theoretical point of view the ( systems of ) scalar conservation laws .",
    "the interested reader can find in the book @xcite an introduction to the field , in @xcite some references for the case of discontinuous flux , and in the book @xcite the analysis of the systems of conservation laws .",
    "systems of scalar conservation laws with discontinuous flux are instead less studied .",
    "an attempt related to traffic flow can be found in @xcite , where a model very similar to the one considered here is investigated . from the numerical point of view ,",
    "a good basic reference is again the book @xcite .",
    "we also point out the paper @xcite , where a numerical method for ( systems of ) scalar conservation laws with discontinuous flux is proposed , and the paper @xcite , where the convergence of a godunov - based scheme for scalar conservation laws with discontinuous flux is investigated .    _ goal .",
    "_ the goal of this paper is proposing an algorithm to solve numerically the system ( [ eq : system_f ] ) .",
    "the numerical method is based on the godunov scheme .",
    "the algorithm does not require use of _ ad hoc _ procedures ( e.g. , linear programming ) to solve the dynamics at junctions , as it is done in classical approaches @xcite .",
    "this leads to a very simple algorithm which can be implemented in minutes .",
    "we perform a detailed comparison with the algorithm described in @xcite based on the lwr model and the godunov scheme .",
    "we show that the two algorithms do not coincide in general since the proposed one does not always maximize the flux at junction .",
    "nevertheless , the solution is admissible in the framework of the classical theory and in some cases it is expected to provide a more reasonable behavior of the car flow . a theoretical investigation of the algorithm proposed here can be found in @xcite .",
    "_ paper organization . _",
    "the paper is organized as follows : in section 2 we recall some basic facts of the classical theory of traffic flow on networks and godunov discretization , following @xcite . in section 3",
    "we present the algorithm for small and large networks . in sections 4 , 5 and 6",
    "we report the numerical results and comparisons for the junctions with 2 incoming roads and 1 outgoing road , 1 incoming road and 2 outgoing roads , and 2 incoming roads and 2 outgoing roads , respectively . in section 7",
    "we report the result of an experiment performed on a real network in rome , italy .",
    "finally , in section 8 we sketch some conclusions .",
    "in this section we recall some basic facts of the classical theory of traffic flow on networks , including a numerical approximation based on the godunov scheme .",
    "our main references are @xcite .",
    "let @xmath39 $ ] be a generic arc of the graph , i.e.  a road .",
    "at any time @xmath16 , the evolution of the vehicle density on the network is computed by a two - step procedure : first , a classical conservation law is solved at any internal point of the arcs ; second , the densities at endpoints @xmath40 , @xmath41 which correspond to a junction are computed .",
    "the latter step has not in general a unique admissible solution , so that additional constraints must be added . beside the conservation of vehicles at junctions , we assume here that drivers behave in order to maximize the flux at junctions and that incoming roads are regulated by priorities ( right of way ) .",
    "the second step is performed by a linear programming method .    on each arc , the density @xmath42 of all vehicles ( no distinction among vehicles",
    "is considered here ) is given by the entropic solution of @xmath43 we consider now a generic junction @xmath44 , with @xmath45 incoming roads and @xmath46 , @xmath47 , @xmath48 outgoing roads .",
    "we assume that the choice of the outgoing road is prescribed by a _ matrix of preferences _ , @xmath49 where @xmath50 for every @xmath51 and @xmath52 , and @xmath53 , @xmath54 .",
    "the @xmath55-th column of @xmath56 describes how the traffic from @xmath57 distributes in percentage to the outgoing roads .",
    "a basic requirement for a vector @xmath58 to be an admissible solution to the problem at @xmath44 is that @xmath59 which translates the fact that the vehicles are conserved at junction .",
    "note that ( [ rh ] ) can be seen as a generalization of the rankine - hugoniot condition at junctions .",
    "we define @xmath60,\\\\ f(\\sigma ) , & \\mbox { if } \\rho(b_i , t)\\in]\\sigma,{\\rho_{\\textup{max } } } ] , \\end{array}\\right .",
    "\\quad i=1,\\ldots , n\\ ] ] and @xmath61,\\\\ f(\\rho(a_j , t ) ) , & \\mbox { if } \\rho(a_j , t)\\in]\\sigma,{\\rho_{\\textup{max } } } ] , \\end{array}\\right . \\quad",
    "j = n+1,\\ldots , n+m.\\ ] ] the quantities @xmath62 and @xmath63 represent , respectively , the maximum incoming and the maximum outgoing flux that can be obtained on each road",
    ". then we define @xmath64,\\qquad i=1,\\ldots , n , \\label{omegain } \\\\ & & \\hskip-30pt \\omega_j:= [ 0,\\gamma^j_{\\text{max}}(\\rho(a_j , t))],\\qquad j = n+1,\\ldots , n+m , \\label{omegaout } \\\\ & & \\hskip-30pt \\omega:=\\{(\\gamma^1,\\ldots,\\gamma^n)\\in\\omega_1\\times\\ldots\\times\\omega_n\\ | \\ a ( \\gamma^1,\\ldots,\\gamma^n)^t\\in\\omega_{n+1}\\times\\ldots\\times\\omega_{n+m}\\ } \\label{omega}.\\end{aligned}\\ ] ] the sets @xmath65 , @xmath66 contain all the possible fluxes for the solution at junctions and then the set @xmath67 contains all the possible admissible fluxes at the end of the incoming roads , taking into account the matrix of preferences @xmath56 .",
    "since we want to maximize the flux at junction , we find the solution(s ) of the maximization problem with linear constraints @xmath68 note that the problem ( [ pl ] ) has not in general a unique solution .",
    "for example , if @xmath69 and @xmath70 ( two incoming and one outgoing roads ) we have @xmath71 , and the constraint reads as @xmath72 . if @xmath73 , we have infinite solutions . to fix this , the additional constraint @xmath74 can be introduced , where @xmath75 are the so - called _ priorities _ ( right of way ) coefficients such that @xmath76 and @xmath77 .",
    "equation ( [ constraint_priorities ] ) translates the fact that some incoming roads have priority with respect to the other roads in assigning their flux to the outgoing roads .",
    "the constraint guarantees uniqueness of the solution of problem ( [ pl ] ) ( unless a further projection onto @xmath67 is needed , see @xcite for details ) .",
    "finally , define @xmath78 as the unique solution of problem ( [ pl ] ) ( with the additional constraint ( [ constraint_priorities ] ) if necessary ) , @xmath79 and , consequently , @xmath80      let us describe briefly the godunov scheme for solving a conservation law of the form @xmath81 \\rho(x,0)=\\bar\\rho(x ) \\end{array } \\right.\\ ] ] on a generic arc @xmath39\\subset{\\mathbb r}$ ] of the network and @xmath82 $ ] , where @xmath83 is the final time .",
    "we define a numerical grid in @xmath84\\times[0,t_f]$ ] with space step @xmath85 and time step @xmath86 , satisfying the cfl condition @xmath87 let us denote by @xmath88 ,  @xmath89 , @xmath90 , @xmath91 , the generic grid node and by @xmath92 the density @xmath93 at @xmath94 . once the initial condition @xmath95 has been projected on the grid , in the internal nodes of the interval @xmath84 $ ] the density at time @xmath96 is given by @xmath97 where the numerical flux @xmath98 is defined as @xmath99 at the boundary nodes we proceed as follows :    * if the node is not linked to any junction , then we assign the desired boundary condition ( dirichlet or neumann ) . *",
    "if the node is a right endpoint and corresponds to the @xmath55-th incoming road of a junction , we use the maximal flux ( [ def : gammastar_i ] ) and set @xmath100 * if the node is a left endpoint and corresponds to the @xmath101-th outgoing road of a junction , we use the maximal flux ( [ def : gammastar_j ] ) and set @xmath102",
    "in this section we present a numerical approximation for the system ( [ def : omega]),([eq : system_f ] ) based on the godunov scheme ( [ godunov ] ) .",
    "then , we discuss how the multi - path model can be modified to deal easily with large networks .",
    "let us denote by @xmath103 the approximate density @xmath104 , where @xmath105 is the @xmath106-th node along the path @xmath107 .",
    "then , analogously to ( [ def : omega ] ) , we define @xmath108 from now on , to avoid cumbersome notations , we write @xmath109 instead of @xmath110 . computing properly @xmath111 at every node is the sole part of the algorithm which requires some effort .",
    "indeed , the rest of the algorithm is constituted by the imposition of the boundary conditions at the beginning and the end of the @xmath2 paths and by the computation of the discrete solution at any internal nodes @xmath109 by means of the following conservative scheme : @xmath112 for @xmath113 and @xmath18 .",
    "note the intrinsic asymmetry of ( [ schema ] ) .",
    "the coefficients in front of the fluxes involve only the nodes @xmath109 and @xmath114 , and not @xmath115 .",
    "we stress again that no special management of the junctions is needed . _",
    "the simplicity of the scheme is the main strength of this approach , making it possible to simulate traffic flow on networks in minutes_.      if the network under consideration is small , the number of possible paths is limited .",
    "then , the number of equations in the system ( [ def : omega]),([eq : system_f ] ) fits a manageable size . this is true even if we deal with large networks where many paths are impracticable or negligible .",
    "conversely , if the network is large and has a large number of paths , the computation of @xmath111 becomes a hard task . in this case",
    ", we adopt a hybrid point of view , creating an algorithm which merges the features of the multi - path algorithm described above and the classical algorithm described in section [ sec : classicaltheory ] . in the internal nodes of the arcs a single equation for the _ total _",
    "density @xmath93 ( or @xmath17 ) is solved .",
    "then , just before each junction , vehicles are split on the basis of their direction by means of the matrix of preferences @xmath56 , see ( [ def : a ] ) , and the scheme is applied . just after the junction , densities associated to the same arc are summed again . considering that typical real junctions have at most three incoming and three outgoing roads , we have at most nine different paths at each junction .",
    "as already noted in @xcite , the original ( global ) multi - path approach of section [ sec : num_approx ] _ differs _ from the hybrid ( local ) method , because splitting the density just before the junctions causes the lost of the global behavior of the drivers . to better understand the difference ,",
    "let us consider the network in fig .",
    "[ fig : esempio_network_nonlocale ] .",
    "let us consider only two paths , @xmath116\\cup [ a_3,b_3]\\cup [ a_4,b_4 ] \\textrm { and } p^2=[a_2,b_2]\\cup [ a_3,b_3]\\cup [ a_5,b_5].\\ ] ] if , at some time @xmath16 , vehicles along @xmath117 $ ] are stopped by , say , an accident , the two algorithms will result in two different outcomes in @xmath118 $ ] .",
    "the global algorithm will empty the arc @xmath118 $ ] , while the local algorithm will fill @xmath118 $ ] with a percentage of the density in @xmath119 $ ] .",
    "clearly , only the global algorithm gives the correct solution .",
    "we also note that the classical algorithm described in section [ sec : classicaltheory ] is local , while the one presented in @xcite is global .",
    "in this section we consider a network with three arcs and one junction , with two incoming roads and one outgoing road . on this network",
    "two paths @xmath120 and @xmath121 are defined , see fig .",
    "[ fig : network_2in_1out ] .",
    "( left ) and path @xmath121 ( right).,title=\"fig:\",scaledwidth=45.0% ] ( left ) and path @xmath121 ( right).,title=\"fig:\",scaledwidth=45.0% ]    we denote by @xmath44 the node _ just after _ the junction , see fig .",
    "[ fig : network_2in_1out ] .",
    "note that the nodes before the junction , namely @xmath122 , @xmath123 , etc .",
    ", can refer to one path or the other one , depending on the context .",
    "we have @xmath124 and the scheme ( [ schema ] ) becomes @xmath125    let us first prove that the density @xmath126 is admissible for any @xmath127 and @xmath109 , @xmath128 , i.e.  it does not exceed @xmath11 .",
    "this is a crucial property which the scheme must satisfy .",
    "it is plain that the risk of exceeding the maximal density is only at node @xmath44 . in the other nodes the result comes from the usual properties of the godunov scheme .",
    "[ teo : rhoammissibile ] let the initial densities around the junction be admissible , namely @xmath129 if the following cfl - like condition holds @xmath130 then @xmath131    _ proof .",
    "_ let us first prove that implies @xmath132 let us define @xmath133 .",
    "by we have @xmath134 noting that @xmath135 , and using the lagrange theorem and , we have @xmath136 to simplify the notations , let us introduce the auxiliary variable @xmath137 .",
    "the worst case happens when @xmath138 ( incoming roads try to transfer the maximal flux to cell @xmath44 ) and @xmath139 ( no flux from cell @xmath44 to cell @xmath140 ) . in this case",
    "the equation for @xmath141 is @xmath142 we proceed by induction : assume that @xmath143 and prove that @xmath144 .",
    "we have @xmath145    * case 1 : @xmath146 + we have @xmath147 the conclusion follows easily by , in particular by the fact that @xmath148 * case 2 : @xmath149 * * case 2.1 : @xmath150 + we have @xmath151 and then @xmath152 . * * case 2.2 : @xmath153 + we have @xmath154 the conclusion follows easily by , in particular by the fact that @xmath155    the two cases conclude the proof .",
    "@xmath156    in the following",
    "we present the results of some numerical tests in which we compare the proposed algorithm - with the classical one - .",
    "a theoretical comparison can be found in @xcite .",
    "for all tests we choose @xmath157 and @xmath158 .",
    "we also assume that each arc has the same length , equal to 1 , then the densities @xmath159 computed by the classical algorithm are defined in @xmath160\\times[0,t_f]$ ] , while the densities @xmath161 computed by the proposed algorithm are defined in @xmath162\\times[0,t_f]$ ] .",
    "we discretize each arc by means of 20 cells , then the junction is between the node @xmath163 and the node @xmath164 .",
    "we choose @xmath165 and we discretize the time interval with 241 nodes . at time",
    "@xmath166 the network is empty .",
    "the boundary conditions at any time @xmath16 are : @xmath167 by this choice , two queues are formed behind the junction , since the outgoing road is not able to receive the car flux coming from the two incoming roads .",
    "hereafter , we shall denote by @xmath168 the density on the path defined by two consecutive arcs @xmath57 , @xmath169 . in fig .",
    "[ fig:2in1.confr ]     ( top ) and path @xmath121 ( bottom ) .",
    "note the 1-cell shift at the junction.,title=\"fig:\",scaledwidth=60.0% ] +    ( top ) and path @xmath121 ( bottom ) .",
    "note the 1-cell shift at the junction.,title=\"fig:\",scaledwidth=60.0% ]    we report the solution at the final time computed by the classical algorithm with _",
    "equidistributed priority coefficients _",
    "@xmath170 , and that computed by the proposed algorithm . for path @xmath120 , the solution @xmath171 of the classical algorithm must be compared with the solution @xmath172 of the proposed algorithm , while for path @xmath121 , the solution @xmath173 of the classical algorithm must be compared with the solution @xmath174 of the proposed algorithm .",
    "it can be seen that the two solutions are very similar , except for the fact that the junction is shifted by one cell . indeed , _",
    "the new algorithm makes the cell @xmath164 play the role of the last one of the incoming roads even if it is defined as the first cell of the outgoing road_. we also note that the proposed algorithm propagates the queue back in space slightly slower than the classical algorithm , probably because of the different behavior at the junction ( see next test ) .    in fig .",
    "[ fig:2in1.trans ]     at cell @xmath163 ( top - left ) , density on @xmath121 at cell @xmath163 ( top - right ) , density at cell @xmath164 ( bottom - left ) , and density at cell @xmath175 ( bottom - right).,title=\"fig:\",scaledwidth=49.0% ]   at cell @xmath163 ( top - left ) , density on @xmath121 at cell @xmath163 ( top - right ) , density at cell @xmath164 ( bottom - left ) , and density at cell @xmath175 ( bottom - right).,title=\"fig:\",scaledwidth=49.0% ] +   at cell @xmath163 ( top - left ) , density on @xmath121 at cell @xmath163 ( top - right ) , density at cell @xmath164 ( bottom - left ) , and density at cell @xmath175 ( bottom - right).,title=\"fig:\",scaledwidth=49.0% ]   at cell @xmath163 ( top - left ) , density on @xmath121 at cell @xmath163 ( top - right ) , density at cell @xmath164 ( bottom - left ) , and density at cell @xmath175 ( bottom - right).,title=\"fig:\",scaledwidth=49.0% ] +    we show the evolution in time of the density at cells @xmath176 .",
    "we note that , before the junction ( @xmath177 ) , the two algorithms do not coincide in a transient , in particular when the queue is forming and the characteristic curves change direction ( from left@xmath178right to right@xmath178left ) .",
    "the proposed algorithm leads to a smaller density than the classical algorithm . a cell after the junction ( @xmath179 ) ,",
    "instead , the situation is inverted : starting from the formation of the queue , the density of the proposed algorithm is slightly higher .",
    "nevertheless , these differences are in some sense balanced , since the total number of vehicles which leave the network is exactly the same for the two algorithms , i.e.@xmath180 just after the junction ( @xmath181 ) , the two algorithms show a remarkably different behavior , with two `` alien '' values @xmath182 and @xmath183 which are not immediately justified in the framework of the classical theory , see @xcite .",
    "these values can not be considered by their own because they leave after the junction ( where the two densities coexist ) .",
    "rather , _ the sum of the two alien values is the value by means of which the two incoming roads perceive the presence of the junction ahead_. the cell @xmath44 may be seen as a region with an oversize capacity which gathers the flows coming from the incoming roads .",
    "we may therefore say that the cell @xmath44 has been augmented by a `` buffer '' .",
    "however , our approach differs from the traffic models with buffer @xcite .",
    "in fact , in those models the load of the buffer at any time is described by a dedicated function which evolves according to an additional ordinary differential equation .    finally , in fig .  [ fig:2in1.dbnoncost ]     ( left ) and path @xmath121 ( right ) .",
    "we observe the same behavior as in the previous test.,title=\"fig:\",scaledwidth=49.0% ]   ( left ) and path @xmath121 ( right ) .",
    "we observe the same behavior as in the previous test.,title=\"fig:\",scaledwidth=49.0% ]    we report the solution at the final time @xmath184 computed by the classical algorithm with equidistributed priority coefficients @xmath170 and by the proposed algorithm in the case of a time - dependent left boundary conditions @xmath185 in this test the transient period is kept alive by the time - dependent boundary conditions .",
    "nevertheless , we observe the same behavior as in the previous test , meaning that the different solution around the junction do not affect the solution elsewhere .",
    "in this section we consider a network with three arcs and one junction , with one incoming road and two outgoing roads . on the network two paths @xmath120 and",
    "@xmath121 are defined , see fig .",
    "[ fig : esempio_network_1in2out ] .",
    "( left ) and path @xmath121 ( right).,title=\"fig:\",scaledwidth=45.0% ]   ( left ) and path @xmath121 ( right).,title=\"fig:\",scaledwidth=45.0% ]    as before , we assume that each arc has the same length , equal to 1 .",
    "we denote by @xmath44 the node _",
    "just before _ the junction , see fig .",
    "[ fig : esempio_network_1in2out ] .",
    "note that the nodes after the junction , namely @xmath140 , @xmath186 , etc .",
    ", can refer to one path or the other one , depending on the context .",
    "we have @xmath187 and the scheme ( [ schema ] ) becomes .    as in the previous case ,",
    "we discretize each arc by means of 20 cells .",
    "the junction is between the node @xmath188 and the node @xmath189 . at time",
    "@xmath166 the network is empty .",
    "the boundary conditions for the classical algorithm are @xmath190 and we set the preference coefficients ( [ def : a ] ) as @xmath191 and @xmath192 . by this choice",
    ", a queue is formed behind the junction , since the road 3 is almost full .",
    "according to ( [ 1in2out_db_rho ] ) , we set @xmath193 in fig .",
    "[ fig:1in2.confr ]    ) , ( [ 1in2out_db_mu ] ) .",
    "path @xmath120 ( left ) and path @xmath121 ( right ) .",
    "the two solutions overlap.,title=\"fig:\",scaledwidth=49.0% ] ) , ( [ 1in2out_db_mu ] ) .",
    "path @xmath120 ( left ) and path @xmath121 ( right ) .",
    "the two solutions overlap.,title=\"fig:\",scaledwidth=49.0% ]    we report the solution at the final time @xmath194 computed by the classical algorithm and by the proposed algorithm . in this case",
    "the two solutions overlap , showing no shift in the localization of the junction .",
    "in this section we consider a network with four arcs and one junction , with two incoming roads and two outgoing roads . on the network",
    "four paths @xmath195 are defined .",
    "boundary conditions and preference coefficients are : @xmath196 in fig .",
    "[ fig:2in2 ]     ( top - left ) , path @xmath121 ( top - right ) , path @xmath197 ( bottom - right ) , path @xmath198 ( bottom - right ) .",
    "the two solutions are different.,title=\"fig:\",scaledwidth=49.0% ]   ( top - left ) , path @xmath121 ( top - right ) , path @xmath197 ( bottom - right ) , path @xmath198 ( bottom - right ) .",
    "the two solutions are different.,title=\"fig:\",scaledwidth=49.0% ] +   ( top - left ) , path @xmath121 ( top - right ) , path @xmath197 ( bottom - right ) , path @xmath198 ( bottom - right ) .",
    "the two solutions are different.,title=\"fig:\",scaledwidth=49.0% ]   ( top - left ) , path @xmath121 ( top - right ) , path @xmath197 ( bottom - right ) , path @xmath198 ( bottom - right ) .",
    "the two solutions are different.,title=\"fig:\",scaledwidth=49.0% ] +    we report the solution at the final time @xmath199 computed by the classical algorithm and by the proposed algorithm . in this case the solutions do not coincide .",
    "also , the total number of vehicles that leave the network is not the same ( cfr .  )",
    ", then we infer that the flux at junction must be different . as a consequence , _",
    "the proposed algorithm does not maximize the flux at junction_. remarkably , the proposed algorithm gives the same density in the incoming roads , independently from the choice of the boundary conditions .",
    "the question arises which solution is chosen by the proposed algorithm .",
    "numerical evidence shows that the multi - path algorithm coincides with the classical one in case of no formation of queues .",
    "if , instead , the constraint @xmath200 in ( [ omega ] ) is active , the multi - path algorithm seems to find the solution of the problem ( [ pl ] ) , but with the additional ( and not required for uniqueness of the solution ) constraint ( [ constraint_priorities ] ) , assuming @xmath201 , see fig .",
    "[ fig:2in2_pl ] .",
    "in order to test the proposed algorithm on a real case , we considered a network located in rome ( italy ) , constituted by 6 two - lane roads and 7 junctions .",
    "the whole network is 328.2 km .",
    "we used the local version of the model described in section [ sec : localmodel ] and we set @xmath202 m , @xmath203 s. we also placed four traffic lights coordinated in pairs .",
    "the final time for the simulation is @xmath204 h , see fig .  [ fig : ris_zeropiu ] for a screenshot .",
    "the code is written in c++ ( serial ) and run on an intel i3 2.27 ghz processor .",
    "the cpu time for the entire simulation was 0.5 s. this result suggests that the proposed technique can be actually used to forecast traffic flow in large networks , keeping to a minimum the implementing effort .",
    "the outcomes of the numerical tests allow us to sketch some preliminary considerations . avoiding any additional procedures at junctions ( i.e.  the most annoying part of existing algorithms ) , the multi - path algorithm is able to compute a solution which is admissible in the framework of the classical theory but does not provide in general the maximization of the flux at junctions .",
    "it is useful to stress here that the maximization of flux is only one of the possible conditions to ensure uniqueness of the solution .",
    "moreover , in some cases this condition may prescribe strongly unbalanced fluxes from the incoming roads .",
    "the multi - path algorithm , instead , overrides the flux maximization favouring the flux balance .",
    "we also stress that , once the topology of the network is suitably implemented in the function @xmath17 ( total density ) , adding or removing a single road or path requires minimal effort .",
    "the authors thank r. natalini and b. piccoli for their useful suggestions , and r. m. colombo for having pointed out the reference @xcite .",
    "( mr2807133 ) b. andreianov , k. h. karlsen and n. h. risebro , _ _ a theory of @xmath205-dissipative solvers for scalar conservation laws with discontinuous flux _ _ , _ arch .",
    "rational mech .",
    "_ , * 201 * ( 2011 ) , 2786 .",
    "m. garavello and b. piccoli , _ _ a multibuffer model for lwr road networks _ _ , _ advances in dynamic network modeling in complex transportation systems , complex networks and dynamic systems _ , * 2 * ( 2013 ) , 143161 .",
    "lebacque , _ the godunov scheme and what it means for first order traffic flow models _ , in _ proc . of the 13th international symposium on transportation and traffic theory , lyon , france _",
    "j. b. lesort ) , elsevier , 1996 , 647677 ."
  ],
  "abstract_text": [
    "<S> in this paper we propose a godunov - based discretization of a hyperbolic system of conservation laws with discontinuous flux , modeling vehicular flow on a network . </S>",
    "<S> each equation describes the density evolution of vehicles having a common path along the network . </S>",
    "<S> we show that the algorithm selects automatically an admissible solution at junctions , hence _ ad hoc _ external procedures ( e.g. , maximization of the flux via a linear programming method ) usually employed in classical approaches are no needed . </S>",
    "<S> since users have not to deal explicitly with vehicle dynamics at junction , the numerical code can be implemented in minutes . </S>",
    "<S> we perform a detailed numerical comparison with a godunov - based scheme coming from the classical theory of traffic flow on networks which maximizes the flux at junctions .    </S>",
    "<S> gabriella bretti , maya briani and emiliano cristiani </S>"
  ]
}