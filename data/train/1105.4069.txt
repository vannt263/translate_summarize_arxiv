{
  "article_text": [
    "a _ local histogram _ of an image is a histogram of the values of the pixels that lie in a neighborhood of a given pixel s location .",
    "it indicates the particular combination of pixel intensities or colors that appear in that neighborhood .",
    "when used as features in an image classification scheme , such histograms can help distinguish one texture from another .",
    "we , in particular , use them in automated segmentation - and - classification algorithms for digital microscope images of biological tissues .    to be precise",
    ", the work presented here was motivated by the need to identify and delineate the various tissues exhibited in images of histological sections of teratoma tumors derived from embryonic stem cells , such as the one given in figure  [ figure.histology](a ) .",
    "this image was provided by dr .",
    "carlos castro of the university of pittsburgh and dr .",
    "john a.  ozolek of the children s hospital of pittsburgh , who grow and image such teratomas to gain greater insight into tissue development . in this image , which is purple - pink from hematoxylin and eosin ( h&e ) staining",
    ", even a layman can discern several distinct textures , each corresponding to a distinct tissue type . for each image under study , drs .",
    "castro and ozolek make use of their years of medical training and experience to identify what tissues are present , and to what degree .",
    "moreover , when provided with a point - and - click interface , they can manually segment the image according to tissue type , resulting in per - pixel labels such as those given in figure  [ figure.histology](b ) .",
    "though straightforward for medical experts , such tasks are nevertheless tedious and time - consuming , leading to inconsistencies when working with large data sets .",
    "it is therefore our goal to automate as much of this process as is possible .",
    "our current algorithm is given in  @xcite and builds upon previous work given in  @xcite .",
    "our use of local histograms was motivated by the unique image features found in histology images of teratomas derived from primate embryonic stem cells . in layman",
    "s terms , these tumors begin as masses of undifferentiated cells that are implanted in laboratory animals . over time , these tumors grow and their cells differentiate into many various types  bone , cartilage , skin , etc.until a point at which they are excised , sectioned , stained and viewed under a microscope , resulting in images such as the one in figure  [ figure.histology](a ) . as such ,",
    "these images exhibit a wide variety of tissue types , arranged in a seemingly random fashion .",
    "indeed , to a casual observer such images can appear as a jumbled mess . in truth however , the arrangement of these tissues is not completely random , and is rather the result of not yet well - understood biological mechanisms .",
    "castro and ozolek believe that by looking at many such images  many sections of many teratomas  they can gain greater insight into these mechanisms . here",
    ", spatial context is crucial : one must identify which particular tissue is present at any given point in order to estimate the total amount of each type , as well as the degree to which any given type is adjacent to other types .    in light of these facts ,",
    "we seek an algorithm which assigns a tissue label to each pixel , thereby segmenting ( delineating ) and classifying ( identifying ) the image at the same time",
    ". indeed , such an algorithm would be useful in a broad class of digital pathology applications beyond the teratoma problem  @xcite .",
    "while designing such an algorithm , we must keep in mind that often no single pixel contains enough information to uniquely determine a label .",
    "rather , the decisions will be made based on features computed over some fixed neighborhood of every given pixel location . to determine which specific features to use",
    ", it helps to have a closer look at each individual tissue .",
    "for example , for the @xmath0 image given in figure  [ figure.histology](a ) and thumbnailed in figure  [ figure.histograms](a ) , we zoom in on three tissue types  cartilage , connective tissue and pseudovascular tissue  resulting in the @xmath1 subimages given in figure  [ figure.histograms](b ) , ( c ) and ( d ) , respectively .",
    "each of these three tissue types exhibits a unique aperiodic texture .",
    "for instance , the cartilage texture can be regarded as a light purple field speckled with darker reddish - purple blobs ; each blob represents an individual cell s nucleus .",
    "meanwhile , connective tissue appears as dark purple blobs over a light pink field ; pseudovascular tissue is similar to connective tissue , but contains additional reddish - pink structures .",
    "in particular , these three textures exhibit distinct distributions of color , a fact which can quantitatively be confirmed by computing the two - dimensional histograms of their red - blue ( rb ) pixel value pairs , as depicted in figure  [ figure.histograms](f ) , ( g ) and ( h ) .",
    "+    as certain tissues can be distinguished from others based solely on the distributions of their pixel values , we propose to use histograms as image features in a segmentation - and - classification scheme .",
    "these histograms must be computed locally  over a fixed neighborhood of every pixel location  since global histograms , such as the one depicted in figure  [ figure.histograms](e ) derived from figure  [ figure.histograms](a ) , destroy spatial context by mixing all of the individual distributions together .",
    "a similar issue arises in time - frequency analysis : spectrograms preserve spatial context while fourier transforms do not .",
    "indeed , local histograms are philosophically similar to spectrograms : in a neighborhood of a given point , the local histogram transform estimates the _ frequency of occurrence _ of a given value while the spectrogram estimates frequency in the traditional sense .",
    "the purpose of this paper is to provide a mathematically rigorous justification for the use of local histograms in this fashion . to be precise , we regard our images as functions from a finite abelian group @xmath2 of pixel locations into a second finite abelian group @xmath3 of pixel values .",
    "that is , our images @xmath4 are members of the set @xmath5 .",
    "for example , the @xmath0 , @xmath6-bit red - green - blue ( rgb ) image given in figure  [ figure.histology](a ) has @xmath7 and @xmath8 , where @xmath9 denotes the cyclic group of integers modulo @xmath10 . for purple - pink h&e - stained images",
    ", we often omit the green channel for the sake of computational efficiency , at which point @xmath3 becomes @xmath11 .",
    "the local histograms of an image @xmath4 are defined in terms of a _ weighting function _ , that is , a nonnegatively - valued @xmath12 whose values sum to one .",
    "specifically , the _ local histogram transform _ of @xmath4 with respect to @xmath13 is the function @xmath14 , @xmath15 where @xmath16 if @xmath17 and is otherwise zero . for any fixed @xmath18 ,",
    "the corresponding cross - section of this function , namely @xmath19 , counts the number of instances at which @xmath4 obtains a given value @xmath20 in a @xmath13-neighborhood of @xmath21 .    in this paper",
    ", we show that local histogram transforms   are well - suited to the analysis of a particular class of textures . in short , we want a rigorous explanation of the following hypothesis : say for the sake of argument that 80% of the cartilage texture in figure  [ figure.histograms](b ) consists of  background \" light purple pixels while the remaining 20% of pixels lie in a  foreground \" of darker - reddish purple blobs ; we then expect a local histogram computed over a portion of cartilage to be a mixture  convex combination  of @xmath22 of the background pixels distribution with @xmath23 of the foreground pixels distribution .",
    "other tissues arise from other distinct decompositions .",
    "for example , looking at the pseudovascular tissue of figure  [ figure.histograms](d ) , we might guess it to be @xmath24 light pink , @xmath25 dark purple and @xmath25 reddish - pink .",
    "we rigorously show that such decompositions of local histograms indeed exist for textures arising from a certain class of probabilistic image models ; our long - term goal is to exploit this fact in a segmentation - and - classification algorithm .    to see how to formalize these ideas",
    ", it helps to consider a toy example : imagine that at any given pixel location , a coin is flipped , with  heads \" resulting in a pink pixel value , and  tails \" resulting in a purple one .",
    "one expects that , on average , the local histogram at any point will consist of two peaks : one in the pink portion of @xmath3 , and one in the purple .",
    "such an image can be regarded as the result of _ occluding _ a solid purple image @xmath26 with a solid pink one @xmath27 : at each pixel , the flip of a coin determines whether @xmath27 lies on top of @xmath26 at that point , or vice versa .",
    "more generally , the _ occlusion _ of a set of @xmath10 images @xmath28 in @xmath29 with respect to a given _ label function _",
    "@xmath30 is : @xmath31 that is , at any pixel location @xmath21 , the label @xmath32 determines which of the potential pixel values @xmath33 actually appears in the composite image @xmath34 at that point .    the main results of this paper are concerned with when the local histograms   of a composite image   are related to the local histograms of the individual @xmath35 s .",
    "though it is unrealistic to expect a clean relation for any fixed @xmath36 , we can show that these quantities are indeed closely related , provided one averages over all possible label functions @xmath36 .",
    "indeed , denoting the probability of getting  heads \" in the above toy example as @xmath37 $ ] , we would expect the volumes of the pink and purple peaks of the composite image s local histograms to be @xmath38 and @xmath39 , respectively .",
    "that is , @xmath40 should be @xmath41 , on average .",
    "we generalize this idea so as to permit more realistic textures with more colors and with spatially - correlated pixels .    to be precise ,",
    "fix a set of source images @xmath28 and consider the set @xmath42 of all possible composite images   obtained by letting @xmath36 be any one of the @xmath43 elements of @xmath44 , where @xmath45 denotes the cardinality of @xmath2 .",
    "we refer to a random method for choosing one of these composites as an _ occlusion model _ @xmath46 . formally speaking",
    ", @xmath46 is a random variable version of @xmath36 , meaning there exists a probability density function @xmath47 $ ] such that @xmath48 . for example , imagine three @xmath1 images @xmath26 , @xmath27 and @xmath49 which exhibit a nearly constant shade of pink , purple and red , respectively . given any label function @xmath50 we can produce a corresponding @xmath51 composite image @xmath52 whose pixels are some mixture of pink , purple and red .",
    "for some choices of @xmath36 the resulting composites will look like the pseudovascular tissue texture given in figure  [ figure.histograms](d ) .",
    "however , even in this small example , there are an enormous number of such possible composites  one for each of the possibilities for @xmath36and only a few of these will look like pseudovascular tissue ; most will appear as pink - purple - red static .",
    "the role of the occlusion model @xmath46 is to assign a probability to each of these possible @xmath36 s in a manner that emphasizes those textures one expects to appear in a given tissue while de - emphasizing the rest .    in this paper ,",
    "we provide a sufficient hypothesis on the occlusion model @xmath46 so as to ensure that the local histograms   of a composite image   can , on average with respect to @xmath53 , be decomposed in terms of the local histograms of the individual images .",
    "in particular , we focus on the special case where the occlusion model @xmath46 is _ flat _ , meaning that on average , the probability that @xmath46 chooses label @xmath54 at a given pixel location @xmath21 is equal to the probability of choosing @xmath54 at any other @xmath55 ; formally , @xmath46 is _ flat _ if there exists scalars @xmath56 such that : @xmath57 that is , @xmath46 is flat if the marginal distributions obtained by fixing any given @xmath18 are identical .",
    "note that for any fixed @xmath18 , summing   over all @xmath54 yields that @xmath58 .",
    "indeed , at any given pixel location @xmath21 , the value @xmath59 represents the probability that the random label function @xmath46 will have label @xmath54 at that @xmath21 . in our toy example where the values of @xmath36 are determined by @xmath45 spatially - independent coin flips , the probability of getting any particular @xmath60 is @xmath61 ; substituting this expression into , the binomial theorem implies that this model is indeed flat with @xmath62 and @xmath63 . note that , if @xmath64 , the resulting random image @xmath65 will be more pink than purple ; flatness does not mean that each label is equally likely , but rather that the chance of being pink at any given pixel location is the same as at any other location .",
    "these concepts in hand , we present one of our main results , which formally claims that , on average , the local histograms of composite images produced from flat occlusion models are but mixtures of the local histograms of the source images :    [ theorem.flatness ] if @xmath46 is flat as in  , then the expected value of the local histogram transform   of a composite image   is a convex combination of the local histograms of each individual ]    from the point of view of our motivating application , the significance of theorem  [ theorem.flatness ] is that it gives credence to a certain type of segmentation - and - classification algorithm .",
    "to be precise , given a set of training images which are manually segmented and labeled by medical experts , we , for any given tissue type , can compute local histograms over regions which are labeled as that type . in light of theorem  [ theorem.flatness ]",
    ", it is reasonable to _",
    "demix_decompose into convex combinations  the local histograms of that type into a set of more basic distributions .",
    "for example , we expect that the local histograms of pseudovascular tissue ( figure  [ figure.histograms](d ) ) can be demixed into three simpler distributions  one pink , another purple and a third reddish - pink  while those of connective tissue ( figure  [ figure.histograms](c ) ) are mixtures of only the first two .",
    "once sparse demixings of each tissue type have been found , we then use them to segment and classify : given a new image , we assign a label at any given point by determining which particular set of learned distributions its local histogram is most consistent with .",
    "the remainder of our main results are in support of this interpretation of theorem  [ theorem.flatness ] .",
    "specifically , the next section contains several basic results on local histograms . in section  [ section.occlusion ] , we prove theorem  [ theorem.flatness ] and also a generalization of it  theorem  [ theorem.expected value of lh of occ]to the non - flat case . in section  [ section.flatness ] ,",
    "we provide various methods  theorems  [ theorem.pj ] ,  [ theorem.star product ] and  [ theorem.overlay]for constructing flat @xmath46 s , and some of these produce textures that resemble those found in digital microscope images of histological tissues .",
    "the final section discusses a preliminary segmentation - and - classification algorithm inspired by theorem  [ theorem.flatness ] in which local histograms are decomposed using principal component analysis ( pca ) .",
    "both local histograms and probabilistic image occlusion models have long been subjects of interest .",
    "theorem  [ theorem.propertiesoflhs ] below details how local histograms can be computed as systems of convolutions ; a similar result is given in  @xcite , and both @xcite and @xcite discuss how such a computation can be implemented in optical hardware .",
    "recently , local histograms have been used in an active contour - based segmentation scheme  @xcite ; this algorithm partitions an image into two smoothly bounded regions whose pixel values are maximally separated with respect to the wasserstein ( earth mover s ) distance .",
    "local histograms have also recently been used as smoothing filters  @xcite .",
    "though the work we present here focuses exclusively on local histograms of the pixel values themselves , an alternative approach is to first pass the image through a filter bank and then compute histograms of the resulting values  @xcite .",
    "local histograms , like time - frequency transforms , preserve global spatial context while obscuring all local spatial context , and as such they are well - suited to the processing of _ locally orderless",
    "_ images  @xcite .",
    "we use local histograms to analyze a class of textures generated by a certain probabilistic occlusion model ; this model , like the  _ dead leaves model _",
    "@xcite , generates these textures via a sequential superposition of random sets .",
    "our contribution to this body of literature is a formalism that unifies the theory of local histograms with that of occlusion models and permits us to rigorously prove that local histograms are indeed a useful transform for the analysis of a particular class of textures .",
    "in this section , we discuss an efficient means of computing local histograms   and discuss several of their basic properties . computing local histograms",
    "can be time consuming , especially as @xmath2 and @xmath3 become large .",
    "in particular , for a general window @xmath13 , a direct computation of requires @xmath66 operations : @xmath67 operations for each @xmath18 and @xmath68 . a more efficient method is given in theorem  [ theorem.propertiesoflhs ] below : can be computed as a system of @xmath69 convolutions over @xmath2 , which only requires @xmath70 operations if discrete fourier transforms are used . in particular , we filter the _ characteristic function _ of the graph of @xmath4 , namely @xmath71 , @xmath72 with the _ reversal _ of @xmath12 , namely @xmath73 .",
    "this method for computing local histograms is illustrated in figure  [ figure.graph ] .",
    "an example of how to compute local histograms using theorem  [ theorem.propertiesoflhs](a ) . for the sake of readability , larger numerical values",
    "are represented by darker shades throughout . the source image ( far left )",
    "@xmath4 is @xmath74 and has grayscale values ranging from @xmath75 to @xmath76 .",
    "that , is @xmath77 where @xmath78 and @xmath79 .",
    "its characteristic function   is a @xmath80-valued @xmath81 data cube whose cross - sections ( left column ) indicate those locations at which @xmath4 attains any given value . by theorem  [ theorem.propertiesoflhs](a ) , the @xmath82 data cube that contains the local histograms of @xmath4 ( far right ) may be computed one level at a time ( right column ) by filtering these binary - valued cross - sections with a real - scalar - valued weighting function ( middle column ) . in this simple example , the weighting function is @xmath83 , where the origin lies in the upper left - hand corner of the grid . ]    alternatively , can be computed as a single convolution over @xmath84 ; here , the tensor product of @xmath12 with @xmath85 is defined as @xmath86 , @xmath87 .",
    "[ theorem.propertiesoflhs ] for any @xmath12 , @xmath85 , @xmath77 , @xmath18 , and @xmath68 :    1 .",
    "local histograms can be evaluated as a system of @xmath69 convolutions over @xmath2 : @xmath88 .",
    "2 .   alternatively , may be computed as a single convolution over @xmath84 : @xmath89 .",
    "+ in particular , taking @xmath90 gives @xmath91 .    for ( a ) , replacing @xmath55 with @xmath92 , and substituting the relation @xmath93 into yields : @xmath94 for ( b ) , the definition of @xmath95 gives : @xmath96(x , y ) = \\sum_{(x',y')\\in{\\mathcal{x}}\\times{\\mathcal{y}}}(\\delta_0\\otimes\\omega)(x',y')({\\mathrm{lh } } _ w f)(x - x',y - y ' ) = \\sum_{y'\\in{\\mathcal{y}}}\\omega(y')({\\mathrm{lh } } _ w f)(x , y - y ' ) .",
    "\\label{equation.3dconvresult}\\ ] ] substituting into and using , gives our result : @xmath97(x , y ) & = \\sum_{y'\\in{\\mathcal{y}}}\\omega(y')({{\\tilde { w}}*{1 _ { f^{-1}\\{y - y'\\}}}})(x)\\\\ \\nonumber & = \\sum_{y'\\in{\\mathcal{y}}}\\omega(y')\\sum_{x'\\in{\\mathcal{x}}}\\tilde { w}(x')1 _ { f^{-1}\\{y - y'\\}}(x - x')\\\\ \\nonumber & = \\sum_{(x',y')\\in{\\mathcal{x}}\\times{\\mathcal{y}}}(\\tilde { w}\\otimes\\omega)(x',y')1 _ f(x - x',y - y')\\\\ & = [ { { ( \\tilde { w}\\otimes\\omega)}*{1 _ f}}](x , y).\\qedhere\\end{aligned}\\ ] ]    the next result summarizes several other basic properties of local histograms , the proofs of which are given in  @xcite .",
    "[ proposition.lhresults ] for any @xmath12 and @xmath77 :    1 .",
    "the levels of a local histogram transform sum to @xmath98 : for any @xmath18 , @xmath99 .",
    "local histograms commute with spatial translation @xmath100 : for any @xmath18 , @xmath101 .",
    "3 .   adding constants to images shifts their local histograms along @xmath3 : for any @xmath68 , @xmath102 .",
    "4 .   quantizing an image will bin its local histograms : for any @xmath103 , @xmath104(x , y')=\\sum_{\\substack{y\\in{\\mathcal{y}}\\\\q(y)=y'}}({\\mathrm{lh } } _ w f)(x , y).\\ ] ]    this basic understanding of local histograms in hand , we turn to the theory of applying them to textures generated by the probabilistic image occlusion models discussed in the introduction .",
    "in this section , we rigorously confirm our intuition regarding local histograms of textures generated via random occlusions : if a texture , such as that found in the pseudovascular tissue of figure  [ figure.histograms](d ) , is some sufficiently - spatially - random combination of @xmath105 pink pixels , @xmath106 purple pixels and @xmath106 red pixels , then its local histograms should , on average , be a mixture of three simpler distributions , namely a convex combination of @xmath24 of a purely pink distribution with @xmath25 purely purple and red ones .    to do this , fix any set of @xmath10 source images @xmath28 and let @xmath46 be any occlusion model as defined in the introduction .",
    "that is , let @xmath46 be a random variable version of a label function @xmath107 , as defined by a probability density function @xmath47 $ ] where @xmath48 . in the results that follow , a useful quantity to consider is the expected value  with respect to @xmath53of the characteristic function @xmath108 obtained by letting @xmath109 in  : @xmath110 essentially",
    ", @xmath111 is the probability that a random label function @xmath36 generated by the occlusion model @xmath46 will assign label @xmath54 to pixel location @xmath21 .",
    "when compared with the definition of flatness  , we see that @xmath46 is flat if and only if there exist scalars @xmath56 such that @xmath112 for all @xmath18 and @xmath113 . that is , @xmath46 is flat if and only if @xmath111 is constant with respect to pixel location @xmath21 .",
    "having this concept , we present one of our main results :    [ theorem.expected value of lh of occ ] for any sequence of images @xmath114 , weighting function @xmath13 and any @xmath10-image occlusion model @xmath46 , the expected value of the local histogram   of the composite image   with respect to @xmath13 is : @xmath115 where the error term @xmath116 is bounded by @xmath117 .",
    "moreover , @xmath118 and so states that , on average , the local histograms of the composite image @xmath119 can be approximated by convex combinations of local histograms of each individual image @xmath35 .    the expected value of the local histogram of a composite image is : @xmath120 for any fixed @xmath36 , @xmath21 , and @xmath55 , we have @xmath121 for exactly one @xmath54 . for any fixed @xmath21 , @xmath55 and @xmath20 , we can therefore split a sum of @xmath122 over all @xmath54 into one summand where @xmath123 and the remaining @xmath124 summands for which @xmath125 : @xmath126 where the final equality follows immediately from . substituting into and using yields : @xmath127 rewriting   in terms of @xmath128 $ ] gives our first claim  : @xmath129 for the second claim , we bound @xmath116 using the triangle inequality and the fact that @xmath130 : @xmath131}\\biggr| } \\leq\\sum_{n=0}^{n-1}\\sum_{x'\\in{\\mathcal{x } } } w(x'){|{\\overline1_\\phi(x+x',n)-\\overline1_\\phi(x , n)}|}.\\ ] ] finally , to prove our third claim  , note that for any fixed @xmath18 , gives : @xmath132 since as previously noted we have @xmath133 for exactly one @xmath54 , becomes : @xmath134 .",
    "an example illustrating the direct computation of the left - hand side of   is given in figure  [ figure.elh ] .",
    "an example of how to compute the left - hand side of   explicitly as a probability - weighted sum . for the sake of readability , larger numerical values",
    "are represented by darker shades throughout .",
    "we consider two @xmath135 , @xmath136-bit images , namely @xmath28 in @xmath29 where @xmath137 , @xmath138 and @xmath139 . in this particular example",
    ", the values of the @xmath35 s are all distinct , with @xmath26 assuming values @xmath140 and @xmath27 assuming values @xmath141 ( far left ) .",
    "there are distinct label functions @xmath142 ( left column ) each yielding a composite image @xmath143 ( center column ) ; in accordance with  , we take values from @xmath26 in places where @xmath36 is white and values from @xmath27 where @xmath36 is black . each of these composites has a @xmath144 local histogram transform   ( right column ) .",
    "since occlusion   is nonlinear , there is no clean relationship between the local histograms of any single composite and the local histograms of the source images @xmath26 and @xmath27 . nevertheless , under certain hypotheses",
    ", we can say something about the average of these local histograms ( far right ) with respect to some probability density function @xmath53 on the set @xmath145 of all possible @xmath36 s .",
    "in particular , if the occlusion model @xmath46 is flat  , meaning in this case that the probability - weighted - sum of all @xmath36 s is a constant function of @xmath21 , then theorem  [ theorem.flatness ] states that this average is a convex combination of the local histograms of @xmath26 and @xmath27 as depicted in figure  [ figure.elh2 ] . ]",
    "note that theorem  [ theorem.expected value of lh of occ ] implies that the error term @xmath116 in   will be small provided the probability @xmath111 of assigning label @xmath54 to @xmath21 changes little as @xmath21 varies over regions smaller than the the support of @xmath13 .",
    "the extreme case of this is when the occlusion model @xmath46 is flat , meaning @xmath111 is constant with respect to @xmath21 . in this case , @xmath116 vanishes entirely , leading to theorem  [ theorem.flatness ] as given in the introduction :    if @xmath46 is flat , @xmath146 for all @xmath147 . the error bound in theorem  [ theorem.expected value of lh of occ ] then gives @xmath148 . denoting @xmath111 as @xmath59 in",
    "thus yields our claim .    that is , when @xmath46 is flat , simplifies to  , and so the in - depth computation of figure  [ figure.elh ] can be replaced by the much simpler one depicted in figure  [ figure.elh2 ] .     a continuation of the example of figure  [ figure.elh ] .",
    "when the occlusion model @xmath46 is flat , theorem  [ theorem.expected value of lh of occ ] becomes theorem  [ theorem.flatness ] , with simplifying to  .",
    "though each of the @xmath149 distinct composite images shown in figure  [ figure.elh ] has a distinct local histogram transform , the average of these @xmath149 local histogram transforms with respect to @xmath53 is but a convex combination ( right ) of the local histograms ( center ) of the two source images ( left ) .",
    "that is , when @xmath46 is flat , the average - over - all - composites local histogram computed in figure  [ figure.elh ] is equal to the average - over - all - sources local histogram computed above.,title=\"fig : \" ]    thus , flatness is indeed an important theoretical assumption for the analysis of local histograms of textures generated via random occlusions .",
    "it nevertheless remains to be shown that flatness is also a realistic assumption from the point of view of our motivating application ; this is the topic of the next section .",
    "theorem  [ theorem.flatness ] gives some insight into the behavior of the local histograms of images generated via random occlusions .",
    "however , this result only holds when @xmath46 is flat  , namely when its average characteristic function @xmath111 , as defined in  , is constant with respect to pixel location @xmath21 , but is still permitted to vary with label value @xmath54 . in this section ,",
    "we demonstrate that flatness is a reasonable assumption .",
    "in particular , we provide a variety of methods for constructing flat occlusion models . some of these models produce textures similar to those encountered in digital microscope images of histological tissues .",
    "our first method involves the translation operator @xmath150 , @xmath151 . to be precise , we show that an occlusion model @xmath46 is flat if it is _ translation - invariant _ , meaning that its probability density function @xmath53 satisfies : @xmath152    [ theorem.pj ] if @xmath46 is translation - invariant  , then @xmath46 is flat  .",
    "we begin by placing an equivalence relation @xmath153 on @xmath44 , letting @xmath154 when there exists some @xmath18 such that @xmath155 . letting @xmath156",
    "denote a set of representatives from the corresponding equivalence classes , we have that for all @xmath157 , there exists a unique @xmath158 such that @xmath155 . as such",
    ", @xmath159 now , fix any @xmath158 , and consider the subgroup @xmath160 of the finite abelian group @xmath2",
    ". letting @xmath161 denote a fixed set of coset representatives of @xmath2 with respect to @xmath162 , we claim that @xmath163 , @xmath164 is a bijection .    indeed , to show @xmath165",
    "is one - to - one , note that if @xmath166 , then @xmath167 , implying @xmath168 ; since @xmath21 and @xmath55 are both coset representatives of @xmath161 , this is a contradiction unless @xmath169 .",
    "meanwhile , to show @xmath165 is onto , take any @xmath154 , and consider a corresponding @xmath55 such that @xmath170 . taking the unique @xmath171 and @xmath172 such that @xmath173",
    ", we have : @xmath174 .",
    "invoking this claim , along with the assumed translation - invariance of @xmath46 , yields : @xmath175 again , writing any @xmath176 as @xmath173 , where @xmath171 and @xmath172 , gives : @xmath177 substituting into gives : @xmath178 since @xmath179 substituting into gives : @xmath180 implying @xmath46 is flat , since the value of @xmath111 depends only on @xmath54 and is independent of @xmath21 .",
    "theorem  [ theorem.pj ] indicates that flatness is not too strong of an assumption .",
    "indeed , one method for producing a flat model @xmath46 is to generalize the coin - flipping example given in the introduction : given any random method for picking a number from @xmath9a probability spinner ",
    "produce @xmath36 by conducting @xmath45 independent spins .",
    "the resulting model @xmath46 is translation - invariant , and therefore flat , since @xmath181 is solely determined by the number of times that @xmath36 achieves each given value @xmath54 .",
    "other translation - invariant examples abound .",
    "for instance , for any fixed @xmath182 , we can assign equal probability to @xmath182 and each of its translates , and assign probability @xmath75 to all others ; if the source images @xmath183 are constant , the composite images   produced by such a model are all translates of a single image .",
    "more generally , we can always partition the @xmath43 elements of @xmath44 into translation - invariant equivalence classes and assign any fixed probability to the members of each class , provided we ensure that in the end they all sum to one .",
    "for example , for the case @xmath137 and @xmath138 depicted in figure  [ figure.elh ] , we may partition the @xmath149 possible @xmath36 s into @xmath184 such classes , and pick any probabilities @xmath185 such that @xmath186 , @xmath187 , @xmath188 , @xmath189 , @xmath190 .",
    "armed with one method ",
    "translation - invariance  for producing flat models @xmath46 , we now turn to ways of combining known models to produce more complicated and realistic ones .",
    "digital microscope images of histological tissues often contain randomly distributed blobs .",
    "these blobs correspond to biological structures : cells , nuclei , etc .",
    "the nature of these processes guarantees that the distribution of such structures is roughly uniform , both spatially and in terms of color : two cells can not occupy the same space ; cells will usually grow and reproduce so as to occupy any empty space ; cells in a given tissue all have approximately the same size and color patterns .",
    "we want to construct flat occlusion models that emulate such textures , since in light of theorem  [ theorem.flatness ] , doing so would formally justify the demixing of local histograms as part of a segmentation - and - classification algorithm .",
    "note that there is a natural method for randomly generating a set of roughly uniformly - distributed points : flip a coin at each point @xmath21 . here , we explore the idea of _ expanding _ each of these randomly generated points into a given blob .    to be precise , let @xmath60 indicate a set of randomly generated points .",
    "for each of the points @xmath18 for which @xmath191 , we will replace it with a blob whose shape is indicated by some @xmath192 . the new texture will be the union of all such blobs . formally , given any @xmath60 and @xmath193^{\\mathcal{x}}$ ] , we define the _ expansion _ of @xmath36 by @xmath194 to be @xmath195 , @xmath196 two examples of this expansion operation are given in figure  [ figure.expansion ] .",
    "+    note that expansion itself   is not an occlusion model .",
    "indeed , is but a way of combining functions in @xmath197 to produce other ones , whereas an occlusion model is a random variable @xmath46 defined by a probability density function @xmath53 over @xmath197 .",
    "this fact notwithstanding , the expansion operation   on label functions @xmath36 and @xmath194 does in fact induce a parallel operation on their random variable cousins @xmath46 and @xmath198 .",
    "to be precise , given two occlusion models @xmath46 and @xmath198 from @xmath2 into @xmath199 , we define the expansion of @xmath46 by @xmath198 to be the occlusion model @xmath200 whose probability density function is @xmath201 $ ] , @xmath202^{\\mathcal{x}}\\\\{{\\varphi}\\star{\\{\\psi_x\\}_{x\\in{\\mathcal{x}}}}}=\\sigma}}{\\mathrm{p}}_\\phi(\\varphi)\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x).\\ ] ] note that the probability that @xmath200 will produce a given label function @xmath203 depends on the ways in which @xmath203 can be written as @xmath204 and , moreover , the probability that @xmath46 and @xmath198 will produce those particular @xmath36 s and @xmath205 s , respectively . in the next result , we verify that   indeed defines a probability density function on @xmath197 .",
    "we further show that if @xmath46 is translation - invariant  , then @xmath200 is translation - invariant which implies that @xmath200 is flat by theorem  [ theorem.pj ] .",
    "in particular , image models which produce collections of blobs similar to those found in biological tissues will indeed be flat provided the distribution that produces the  centers \" of these blobs is translation - invariant . moreover ,",
    "if the flatness of @xmath200 is all that is desired , we can weaken the requirement that @xmath46 be translation - invariant so as to only require that @xmath46 is itself flat , provided @xmath46 and @xmath198 are _ effectively disjoint _ : @xmath206 put another way ,   means that there is only at most one way , with nontrivial probability , in which the @xmath21 in   can be written as @xmath207 where both @xmath208 and @xmath209 .",
    "[ theorem.star product ] if @xmath46 and @xmath198 are occlusion models from @xmath2 into @xmath199 , then their expansion @xmath200 , with probability density function  , is as well . moreover ,",
    "if @xmath46 is translation - invariant  , then @xmath200 is translation - invariant .",
    "furthermore , if @xmath46 and @xmath198 are effectively disjoint   and either @xmath46 or @xmath198 is flat  , then @xmath200 is flat .",
    "we first show that   defines a probability density function , namely that values of @xmath210 over all @xmath203 in @xmath197 sum to @xmath98 .",
    "since @xmath53 is a probability density function by assumption , we have : @xmath211 similarly , for any fixed @xmath18 , we have : @xmath212 where the subscript  @xmath21 \" on @xmath213 indicates that this particular @xmath213 is intended to expand @xmath36 at the particular point @xmath21 as opposed to at some other point . taking the product of   with the product of   over all @xmath21 yields : @xmath214^{\\mathcal{x}}}}{\\mathrm{p}}_\\phi(\\varphi)\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x),\\ ] ] where the final quantity in   contains all of the cross terms resulting from distributing the product over all sums of the form  .",
    "now , since for each choice of @xmath36 and @xmath194 there is exactly one resulting @xmath215 , we can rewrite   in terms of the definition   of @xmath216 , obtaining our claim : @xmath217^{\\mathcal{x}}\\\\{{\\varphi}\\star{\\{\\psi_x\\}_{x\\in{\\mathcal{x}}}}}=\\sigma}}{\\mathrm{p}}_\\phi(\\varphi)\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x ) = \\sum_{\\sigma\\in\\ell({\\mathcal{x}},{\\mathbb{z}}_2)}{\\mathrm{p}}_{{{\\phi}\\star{\\psi}}}(\\sigma).\\ ] ] thus , indeed defines a probability density function , as claimed .",
    "we next show that the occlusion model @xmath200 is translation - invariant , if @xmath46 is translation - invariant . to do this",
    ", we claim that if @xmath218 then @xmath219 .",
    "to see this claim , note that @xmath220",
    "if and only if there exists some @xmath55 , @xmath221 in @xmath2 such that @xmath207 , @xmath208 , and @xmath209 . letting @xmath222 , we thus have that @xmath223 if and only if @xmath224 , where @xmath225 and @xmath226 , implying @xmath219 , as claimed .",
    "having the claim ,   implies : @xmath227^{\\mathcal{x}}\\\\{{\\varphi}\\star{\\{\\psi_x\\}_{x\\in{\\mathcal{x}}}}}={\\mathrm{t}}^{\\tilde{x}}\\sigma}}{\\mathrm{p}}_\\phi(\\varphi)\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x ) = \\sum_{\\substack{\\varphi\\in\\ell({\\mathcal{x}},{\\mathbb{z}}_2)\\\\\\{\\psi_x\\}_{x\\in{\\mathcal{x}}}\\in[\\ell({\\mathcal{x}},{\\mathbb{z}}_2)]^{\\mathcal{x}}\\\\{{({\\mathrm{t}}^{-\\tilde{x}}\\varphi)}\\star{\\{\\psi_{x+\\tilde{x}}\\}_{x\\in{\\mathcal{x}}}}}=\\sigma}}{\\mathrm{p}}_\\phi(\\varphi)\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x).\\ ] ] to continue , we make the change of variables @xmath228 and @xmath229 : @xmath230^{\\mathcal{x}}\\\\{{(\\varphi')}\\star{\\{\\psi'_x\\}_{x\\in{\\mathcal{x}}}}}=\\sigma}}{\\mathrm{p}}_\\phi({\\mathrm{t}}^{\\tilde{x}}\\varphi')\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi'_{x-\\tilde{x}}).\\ ] ] since @xmath46 is translation - invariant and @xmath231 , we have : @xmath230^{\\mathcal{x}}\\\\{{(\\varphi')}\\star{\\{\\psi'_x\\}_{x\\in{\\mathcal{x}}}}}=\\sigma}}{\\mathrm{p}}_\\phi(\\varphi')\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi'_{x } ) = { \\mathrm{p}}_{{{\\phi}\\star{\\psi}}}(\\sigma),\\ ] ] and so @xmath200 is indeed translation - invariant  , as claimed .    for our final claim ,",
    "we assume that @xmath46 and @xmath198 are effectively disjoint   and that either @xmath46 or @xmath198 is flat .",
    "to do so , it is helpful to characterize the flatness of an arbitrary occlusion model @xmath46 from @xmath2 to @xmath199 in terms of the corresponding function @xmath232 .",
    "indeed , for any @xmath233 , may be rewritten as @xmath234 and so : @xmath235    in light of  , we claim that @xmath46 is flat if and only if @xmath236 is constant .",
    "indeed , if @xmath46 is flat , then there exists @xmath237 such that @xmath238 for all @xmath18 .",
    "conversely , if @xmath239 is constant , then there exists @xmath237 such that @xmath240 for all @xmath18 ; by , this further implies that @xmath241 for all @xmath18 and so @xmath46 is flat .",
    "having this claim , we show that @xmath200 is flat by showing that @xmath242 is constant . to do this",
    ", we show that if @xmath46 and @xmath198 are effectively disjoint then @xmath243 where",
    " @xmath244 \" denotes standard convolution over @xmath2 . according to the definition of @xmath200   we have : @xmath245^{\\mathcal{x}}\\\\{{\\varphi}\\star{\\{\\psi_x\\}_{x\\in{\\mathcal{x}}}}}=\\sigma}}{\\mathrm{p}}_\\phi(\\varphi){\\biggl({\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x)}\\biggr)}({{\\varphi}\\star{\\{\\psi_x\\}_{x\\in{\\mathcal{x}}}}}).\\ ] ]",
    "since any particular choice of @xmath36 and @xmath246 produces a unique @xmath203 via @xmath247 we can simplify   to @xmath248^{\\mathcal{x}}}}{\\mathrm{p}}_\\phi(\\varphi){\\biggl({\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x)}\\biggr)}({{\\varphi}\\star{\\{\\psi_x\\}_{x\\in{\\mathcal{x}}}}}).\\ ] ] moreover , since @xmath46 and @xmath198 are effectively disjoint   we have @xmath249 meaning becomes : @xmath250^{\\mathcal{x}}}}{\\mathrm{p}}_\\phi(\\varphi){\\biggl({\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x)}\\biggr)}{\\biggl({\\sum_{\\substack{x'\\in{\\mathcal{x}}\\\\\\varphi(x')=1}}{\\mathrm{t}}^{x'}\\psi_{x'}}\\biggr)}\\\\ \\label{equation.proof of star product 7 } & = \\sum_{\\varphi\\in\\ell({\\mathcal{x}},{\\mathbb{z}}_2)}{\\mathrm{p}}_\\phi(\\varphi)\\sum_{\\substack{x'\\in{\\mathcal{x}}\\\\\\varphi(x')=1}}{\\mathrm{t}}^{x'}{\\biggl[{\\sum_{\\{\\psi_x\\}_{x\\in{\\mathcal{x}}}\\in[\\ell({\\mathcal{x}},{\\mathbb{z}}_2)]^{\\mathcal{x}}}{\\biggl({\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x)}\\biggr)}\\psi_{x'}}\\biggr]}.\\end{aligned}\\ ] ] now , for any fixed @xmath176 such that @xmath208 , we factor the corresponding innermost sum in   into a product of @xmath45 distinct sums  one for each @xmath18to obtain : @xmath251^{\\mathcal{x}}}{\\biggl({\\prod_{x\\in{\\mathcal{x}}}{\\mathrm{p}}_\\psi(\\psi_x)}\\biggr)}\\psi_{x ' } = { \\biggl[{\\prod_{x\\neq x'}{\\biggl({\\sum_{\\psi_x\\in\\ell({\\mathcal{x}},{\\mathbb{z}}_2)}{\\mathrm{p}}_\\psi(\\psi_x)}\\biggr)}}\\biggr]}\\sum_{\\psi_{x'}\\in\\ell({\\mathcal{x}},{\\mathbb{z}}_2)}{\\mathrm{p}}_\\psi(\\psi_{x'})\\psi_{x ' } = { \\biggl({\\prod_{x\\neq x'}1}\\biggr)}\\overline\\psi = \\overline\\psi.\\ ] ] substituting into then gives : @xmath252 thus , the effective disjointness of @xmath46 and @xmath198 indeed implies @xmath243 . as such , if we further assume that either @xmath46 or @xmath198 is flat , then either @xmath236 or @xmath253 is constant , implying in either case that @xmath242 is constant and so @xmath200 is flat .",
    "above , we discussed how the expansion   of a binary - valued occlusion model @xmath46 with another such model @xmath198 is a new model @xmath200 that randomly generates label functions of the form @xmath215 as defined in  .",
    "under certain hypotheses , theorem  [ theorem.star product ] gives that such models @xmath200 are flat , meaning their local histograms can be understood in terms of theorem  [ theorem.flatness ] . moreover ,",
    "some examples of these models produce textures that resemble those encountered in histological tissues : if @xmath26 and @xmath27 are roughly constant light purple and dark purple fields , respectively , then the composite image @xmath143 obtained by picking @xmath36 as in figure  [ figure.expansion](f ) bears some similarity to an actual image of cartilage , such as the one given in figure  [ figure.histograms](b ) .",
    "taken together , these facts provide some theoretical justification for the use of local histograms for the analysis of such tissues .",
    "there is however a deficit with this theory : due to the nature of the construction  , models produced by expansion   can only be binary - valued , and as such are insufficient to emulate textures that exhibit three or more distinct color modes , such as the pseudovascular tissue depicted in figure  [ figure.histograms](d ) . in this subsection",
    ", we discuss a method for _ laying _ one occlusion model over another which , amongst other things , permits us to build multivalued models out of binary - valued ones . to be precise , for any @xmath254 , @xmath255 and @xmath256 , we define the _ overlay _ of @xmath36 over @xmath213 with respect to @xmath203 to be @xmath257 , @xmath258 essentially , an overlay   is the result of cutting holes out of an image of @xmath36 and laying it on top of an image of @xmath213 ; the location of these holes is indicated by @xmath203 and the values of @xmath213 are increased by a factor of @xmath259 so that they can not be confused with those of @xmath36 .",
    "examples of this overlay operation are given in figure  [ figure.overlay ] .",
    "+    in a manner similar to the relationship between   and  , we have that   naturally induces a parallel operation on occlusion models : given probability density functions @xmath53 , @xmath260 and @xmath261 on @xmath262 , @xmath263 and @xmath264 , respectively , we define the overlay of the occlusion model @xmath46 over @xmath198 with respect to @xmath265 to be the new occlusion model @xmath266 whose probability density function is @xmath267 $ ] , @xmath268 in the next result , we verify that   indeed defines a probability density function , and moreover that the corresponding model @xmath266 is flat provided @xmath46 , @xmath198 and @xmath265 are flat , meaning that the local histograms   of composite images   produced by such a model will behave according to theorem  [ theorem.flatness ] .",
    "[ theorem.overlay ] if @xmath46 , @xmath198 and @xmath265 are occlusion models on @xmath262 , @xmath263 and @xmath264 , respectively , then   defines a probability density function on @xmath269 .",
    "moreover , if @xmath46 , @xmath198 , and @xmath265 are flat , then @xmath270 is flat .    to show that defines a probability density function on @xmath269 ,",
    "note that : @xmath271 noting that for each fixed @xmath36 , @xmath213 , and @xmath203 , there exists exactly one @xmath272 such that @xmath273 , becomes : @xmath274 as claimed .",
    "for the second conclusion , assume that @xmath46 , @xmath198 , and @xmath265 are flat .",
    "our goal is to show that @xmath270 is flat  , meaning that for any @xmath275 , we want to show that there exists a scalar @xmath59 such that : @xmath276 for all @xmath18 . to see this",
    ", note that for any such @xmath21 and @xmath54 , we have : @xmath277 now , in the special case where @xmath278 , gives that @xmath279 if and only if @xmath133 and @xmath280 .",
    "as such , in this case becomes : @xmath281 if , on the other hand @xmath282 then gives that @xmath279 if and only if @xmath283 and @xmath284 .",
    "in this case , becomes : @xmath285 thus , for any @xmath18 we either have   or   meaning @xmath270 is flat  , as claimed .",
    "in this section , we present a proof - of - concept segmentation - and - classification scheme that is inspired by theorem  [ theorem.flatness ] .",
    "we emphasize that for the algorithm presented here , local histograms are the only image features that are computed .",
    "that is , the decision of which label to assign to a given pixel is based purely on the distribution of color in its surrounding neighborhood .",
    "we do this to demonstrate the validity of the concept embodied by theorem  [ theorem.flatness ] as an image processing tool . for algorithms intended for real - world use",
    ", such color information should be combined with morphological data  size , local and global shape , orientation and organization  in order to obtain better classification accuracies .",
    "an example of such an algorithm , accompanied by thorough testing and comparisons against other state - of - the - art methods , is given in the sister article  @xcite to this one ; these facts are not reprinted here .",
    "the concept of theorem  [ theorem.flatness ] is that the local histograms of certain textures should , on the whole , be able to be decomposed in terms of more basic distributions .",
    "indeed , it is reasonable to expect a local histogram computed over a region of cartilage ( figure  [ figure.histograms](b ) ) to be a mixture of @xmath22 of a  light purple \" distribution  a distribution mostly supported in portions of @xmath3 that correspond to light purple  with @xmath23 of a darker reddish - purple one .",
    "meanwhile , local histograms of other tissues will correspond to distinct mixtures of other distributions .",
    "for example , local histograms computed over a region of pseudovascular tissue ( figure  [ figure.histograms](d ) ) might be a mixture of @xmath24 of a light pink distribution , with @xmath25 of a dark purple one and @xmath25 of a reddish - pink one .",
    "the algorithm we present here exploits this concept .",
    "the first step is to train our classifier .",
    "to do so , let @xmath286 be the number of distinct tissue types found in a training image such as figure  [ figure.classification](a ) or ( d ) .",
    "for any tissue type @xmath287 , we compute local histograms @xmath288 about pixel locations @xmath289 that have been labeled as being of that type by medical experts .",
    "each @xmath290 is a nonnegatively - valued function over @xmath3 that sums to one .",
    "there are several ways to pick the @xmath291 s .",
    "one approach is to have the expert choose each point individually . alternatively ,",
    "if the expert has manually segmented and labeled the entire image ( figure  [ figure.classification](b ) ) , then the @xmath291 s can be chosen at random from regions of type @xmath292 .",
    "the number @xmath293 of local histograms that we compute for type @xmath292 is somewhat arbitrary ; we used repeated experimentation to find a sample size large enough to guarantee reliably - decent performance .",
    "+    in light of theorem  [ theorem.flatness ] , it would be nice to demix the training local histograms @xmath288 in terms of a type - dependent class of more basic distributions .",
    "that is , we would like to find nonnegatively - valued functions @xmath294 over @xmath3 that sum to one and have the property that for each training local histogram @xmath290 there exists nonnegative scalars @xmath295 that themselves sum to one and such that : @xmath296 unfortunately , computing the @xmath294 s that minimize the approximation error in   is a nontrivial optimization problem . as such , we leave this approach for future work , and instead consider a mathematically - simpler problem in which the @xmath297 s and @xmath294 s are permitted to be arbitrary real scalars and vectors , respectively .",
    "that is , we perform pca for each tissue type @xmath292 . to be precise , for each type",
    ", we form a @xmath298 matrix @xmath299 whose columns are the ( vectorized ) local histograms @xmath290 less their average @xmath300 : @xmath301 we then compute the singular value decompositions @xmath302 and identify those left - singular vectors that correspond to some experimentally - determined number @xmath303 of dominant singular values @xmath304 . in this setting , the approximation   is replaced by : @xmath305 the classical theory of pca states that the approximation error in   is optimally small in the sense that these specific @xmath306 s span the particular @xmath303-dimensional subspace of @xmath307 whose orthogonal projection operator @xmath308 minimizes the total squared - error @xmath309 . the vectors @xmath300 and in hand , we store them in memory , completing the training phase of our classification algorithm .    to segment and",
    "label a given image @xmath310 , we compute its local histograms  , obtaining local distributions of color @xmath311 , @xmath312 about every pixel location @xmath18 . at",
    "any given @xmath21 , we then assign a tissue label @xmath313 by finding the tissue type @xmath292 whose shifted subspace @xmath314 is nearest to @xmath315 .",
    "specifically , we let : @xmath316 in implementation , we compute the summations over @xmath3 in   as running sums , looping over all @xmath68 .",
    "this computational trick greatly reduces our memory requirements : at any given time , we only store a single level of @xmath317 . by theorem",
    "[ theorem.propertiesoflhs ] , such a level can be obtained by filtering an indicator function ; in the following experimental results , we avoided edge artifacts by using a weighted noncyclic method of filtering , namely the @xmath247-convolution of  @xcite .",
    "without such a trick , one must store the entire local histogram transform in memory , a daunting task for even modestly - sized images : the full local histogram transform of the @xmath0 , 8-bit rgb image given in figure  [ figure.histology](a ) is a @xmath318 array .",
    "further computational advantages may be gained by quantizing the image and reducing the dimension of the color space . for our particular set of histology images",
    ", we experimentally found that we could still obtain good accuracies even if we discard the green channel of our purple - pink images , and moreover quantize the @xmath6-bit red and blue channels down to @xmath136-bits apiece .",
    "that is , we quantize @xmath3 from @xmath319 to @xmath320 . by proposition  [ proposition.lhresults ] , this is equivalent to binning the original @xmath318 local histogram array down to a new one of size @xmath321 .",
    "the quantized version of figure  [ figure.histology](a ) is given in figure  [ figure.classification](a ) ; for the sake of readability , a @xmath136-bit quanitized version of the unused green channel was included in this rendering .",
    "as a result of this quantization , it only takes a few seconds to assign per - pixel labels to a @xmath0 histology image using a matlab - based implementation of  , running on standard desktop hardware . for this particular set of images , further color quantization , such as using @xmath322-bit colors ( @xmath323 ) or converting the original image to grayscale ( @xmath324 ) , results in an unacceptable loss in classification accuracy , as do attempts at spatial quantization ( @xmath325 ) .",
    "two runs of this classification algorithm are depicted in figure  [ figure.classification ] . in the first run",
    ", we train the classifier on the @xmath136-bit @xmath0 red - blue image given in  figure  [ figure.classification](a ) . for the sake of simplicity , we restrict ourselves to @xmath326 tissue types : cartilage , connective tissue and pseudovascular tissue ; all other tissue types are ignored in the confusion matrices given below . for each type @xmath327",
    ", we randomly choose @xmath328 points of that type , making use of a small number of the @xmath329 ground truth labels given in  figure  [ figure.classification](b ) ; edge artifacts are avoided by not picking points near the border . for each type , we then perform pca on the @xmath330 local histograms @xmath290 of that type , computing an average local histogram @xmath300 as well as the dominant left - singular vectors of @xmath299  . for the sake of simplicity , in a given experiment we will use the same number of principal components for each of the three types , that is , @xmath331 for @xmath327 . at the same time , we experiment with this number itself , letting @xmath10 be either @xmath98 , @xmath322 , @xmath136 or @xmath76 . with the training complete , we then segment and classify figure  [ figure.classification](a ) using the decision rule  , resulting in per - pixel labels such as the ones given in figure  [ figure.classification](c ) for @xmath332 . comparing figure",
    "[ figure.classification](c ) and the ground truth of figure  [ figure.classification](b ) , we see both the power and limitations of local histograms : color is a big factor in determining tissue type , but by ignoring shape , we suffer from oversmoothing .",
    "the accuracy percentages for various choices of @xmath10 are given by a confusion matrix : @xmath333 here each row of the matrix tells us the percentage a certain tissue was labeled as cartilage ( ca ) , connective tissue ( co ) , and pseudovascular tissue ( ps ) . in particular , the first three entries of the first row of this table tell us that when using a single principal component , those points labeled as cartilage by a medical expert in figure  [ figure.classification](b ) are correctly labeled as such by our algorithm @xmath334 of the time , while @xmath335 of it is mislabeled as connective tissue and @xmath336 of it is mislabeled as pseudovascular tissue .",
    "note here that we have trained and tested on the same image ; such experiments indicate the feasibility of our approach in a semi - automated classification scheme in which a medical expert handpicks @xmath330 points of each given type and lets the algorithm automatically assign labels to the rest .",
    "the second run of this algorithm is almost identical to the first , with the exception that we use a distinct image in the training phase . to be precise , for each of the three tissue types , we perform pca on the local histograms of @xmath330 randomly - chosen points of that type in figure  [ figure.classification](d ) , making use of its ground truth labels ( not pictured ) .",
    "we then apply the principal components obtained from figure  [ figure.classification](d ) to generate labels ( figure  [ figure.classification](e ) ) for figure  [ figure.classification](a ) using the decision rule  .",
    "compared to the first run , the algorithm s performance here is a better indication of its feasibility as a fully automated classification scheme , and is summarized by the following confusion matrix : @xmath337 though the performance in the second run is understandably worse than that of the first , it nevertheless demonstrates the real - world potential of the idea exemplified by theorem  [ theorem.flatness ] : the local histograms of certain types of textures can be decomposed into more basic distributions , and this decomposition can serve as an image processing tool .",
    "the authors are extremely grateful to dr .  carlos castro and dr .",
    "john a.  ozolek for introducing us to the motivating application and for providing us with raw image data and manually segmented ground truth labels used throughout this article .",
    "this work is supported by nsf dms 1042701 and ccf 1017278 , afosr f1ata01103j001 and f1ata00183g003nih , nih - r03-eb009875 and 5p01hd047675 - 02 , the pa state tobacco settlement and the kamlet - smith bioinformatics grant .",
    "parts of the work were presented at isbi 2010  @xcite and sbec 2010  @xcite .",
    "the views expressed in this article are those of the authors and do not reflect the official policy or position of the united states air force , department of defense , or the u.s .",
    "government .",
    "r.  bhagavatula , m.  fickus , j.  a.  ozolek , c.  a.  castro , j.  kovaevi , automatic identification and delineation of germ layer components in h&e stained images of teratomas derived from human and nonhuman primate embryonic stem cells , proc .",
    "ieee int .",
    "( 2010 ) 10411044 .",
    "a.  chebira _ et al .",
    "_ , multiresolution identification of germ layer components in teratomas derived from human and nonhuman primate embryonic stem cells , proc .  ieee int",
    ".  biomed .",
    "( 2008 ) 979982 ."
  ],
  "abstract_text": [
    "<S> the local histogram transform of an image is a data cube that consists of the histograms of the pixel values that lie within a fixed neighborhood of any given pixel location . </S>",
    "<S> such transforms are useful in image processing applications such as classification and segmentation , especially when dealing with textures that can be distinguished by the distributions of their pixel intensities and colors . </S>",
    "<S> we , in particular , use them to identify and delineate biological tissues found in histology images obtained via digital microscopy . in this paper </S>",
    "<S> , we introduce a mathematical formalism that rigorously justifies the use of local histograms for such purposes . </S>",
    "<S> we begin by discussing how local histograms can be computed as systems of convolutions . </S>",
    "<S> we then introduce probabilistic image models that can emulate textures one routinely encounters in histology images . </S>",
    "<S> these models are rooted in the concept of image occlusion . </S>",
    "<S> a simple model may , for example , generate textures by randomly speckling opaque blobs of one color on top of blobs of another . under certain conditions , </S>",
    "<S> we show that , on average , the local histograms of such model - generated - textures are convex combinations of more basic distributions . </S>",
    "<S> we further provide several methods for creating models that meet these conditions ; the textures generated by some of these models resemble those found in histology images . </S>",
    "<S> taken together , these results suggest that histology textures can be analyzed by decomposing their local histograms into more basic components . </S>",
    "<S> we conclude with a proof - of - concept segmentation - and - classification algorithm based on these ideas , supported by numerical experimentation .    </S>",
    "<S> local histogram , occlusion , texture , classification , segmentation </S>"
  ]
}