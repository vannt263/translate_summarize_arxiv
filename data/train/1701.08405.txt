{
  "article_text": [
    "in recent years , much research effort has been dedicated to study the electronic transport through magnetic molecules and single atoms in order to combine molecular electronics with spintronics@xcite .",
    "experiments and theoretical works have demonstrated that molecular and atomic spin states can be inferred and sometimes switched through an electrical current@xcite . among the many interesting phenomena arising in devices comprising magnetic molecules",
    ", there is the kondo effect@xcite .",
    "below the so called kondo temperature , @xmath0 , characteristic of each system , the coupling between the electrons from the electrodes and the spin of the molecule promotes the formation of a many - body state with a fully or partially quenched magnetic moment .",
    "this results in a new resonant transport channel at the electrodes fermi level . to date",
    "the kondo effect has been studied in a number of molecular devices @xcite , and exotic manifestations , such as the orbital kondo effect , have also been reported@xcite .",
    "_ ab - initio _ computational studies play a prominent role in molecular electronics and spintronics .",
    "in particular density functional theory ( dft ) combined with the non - equilibrium green s functions ( negf ) formalism@xcite , known as dft+negf for short , has become the dominant method to address electronic transport@xcite . as initial step in a typical dft+negf study of a molecular device ,",
    "one optimizes the atomic configuration of the device active region , usually called `` scattering region '' or `` extended molecule '' .",
    "then the scattering region is joint to two semi - infinite left- and right - hand side leads ( electrodes ) , whose effect on the states in the scattering region is taken into account by the so - called leads self - energies .",
    "this approach allows to treat the extended molecule as an open system , with the leads self - energies that provide quantitative estimates of the molecule - electrode hybridization and of its dynamic character@xcite . finally , the device transmission function and conductance are calculated within the landauer framework@xcite , by considering the kohn - sham ( ks ) eigenvalues as the single - particle excitations .",
    "although this assumption is formally not correct , since even in exact dft only the highest occupied molecular orbital ( homo ) can be rigorously associated to the negative of the ionization potential@xcite , it practically works well for metallic point - contacts@xcite , nanowires and nanotubes @xcite , quasi two - dimensional systems@xcite , and tunnel junctions@xcite .",
    "in contrast , the calculation of transport properties via the ks eigenvalues encounters some drastic limitations in case of molecules .",
    "the fundamental gap between the homo and the lowest unoccupied molecular orbital ( lumo ) is often severely underestimated by the ks gap computed with standard ( semi-)local exchange - correlation density functionals .",
    "furthermore , non - local correlation effects , such as the dynamical response of the electronic system to the addition of an electron or hole@xcite , are not captured .",
    "these shortcomings hinder the ability of dft+negf to predict the correct energy level alignment between a molecule and the electrodes , which often results in overestimated values for the conductance . consequently , different improvements have been proposed , such as corrections for self - interaction error@xcite , scissor operator schemes@xcite and constrained - dft@xcite .",
    "furthermore , in the recent years , there have been several attempts to move beyond the dft+negf method by using the @xmath1 approximation of the many - body perturbation theory@xcite .",
    "the description of the kondo effect , even at the qualitative level , still represents a challenge . on the one hand , electron correlations leading to the kondo effect are beyond the @xmath1 perturbative scheme . on the other hand , the dft ks spectrum fails to display any kondo - related feature , and so does the conductance computed via the landauer approach .",
    "we note that in principle dft is able to capture the kondo effect in one - orbital lattice models@xcite if the exchange - correlation potential has the correct derivative discontinuity at integer number of electrons , and if the conductance is computed from the density through the friedel sum rule@xcite and not from the ks states .    in order to describe the kondo effect in real molecular systems and to overcome",
    "the limitations of dft+negf and @xmath1 , recent studies have proposed to combine dft with model calculations , thus extending to molecular electronics theoretical schemes originally proposed for the study of strongly correlated solid state materials .",
    "these schemes include the dynamical mean - field theory ( dmft)@xcite . the combination of dft and models is typically achieved by partitioning the system of interest in two coupled subsystems , a weakly correlated one , whose electronic structure is well accounted for by dft , and a strongly correlated one .",
    "mathematically , this means that part of the system of interest is projected onto the correlated sub - system , and that the rest is integrated out as an effective bath . in case of molecular devices",
    ", this approach ultimately leads to the reformulation of the electronic structure and transport problem in terms of an effective anderson impurity model ( aim ) , which then has to be solved either exactly or within some approximations .",
    "the potential of this approach has been firstly demonstrated by comparing to photoemission experiments@xcite the computed spectral properties of single magnetic atoms@xcite and molecules@xcite on metallic surfaces .",
    "then , the linear - response ( i.e. zero - bias ) transport properties have been addressed for example by smogunov , tosatti and co - workers@xcite , and jacob and co - workers@xcite .",
    "we have recently contributed to further develop the dft+negf scheme including dmft to study spin transport in solid state devices such as multilayered heterostructures@xcite .    in this article , we present our scheme to project out from dft+negf an aim , which is then solved numerically using continuous time quantum monte carlo ( ctqmc)@xcite . the developed method allows us to evaluate the temperature - dependent linear - response transport properties of magnetic molecules on metal surfaces . an important class of such molecules is formed by the stable organic radicals , which are are paramagnetic compounds presenting an unpaired electron in a singly occupied molecular orbital ( somo)@xcite . in particular , here we consider the 1,3,5-triphenyl-6-oxoverdazyl ( tov , fig .",
    "[ fig.tov ] ) .",
    "this is the first organic radical for which the kondo effect was experimentally observed in a scanning tunneling microscope ( stm ) setup with a gold substrate , and the kondo temperature was reported to be about 37 k@xcite . since the system is well characterized by stm , the comparison of the calculated density of states and kondo temperature with the experiment serves as a stringent test for the theory .",
    "additionally , we demonstrate how the different contributions to the conductance that originate from elastic , non - coherent and quantum interference effects can be disentangled .",
    "an open issue concerns the calculation of the electron - electron interaction energy for the anderson impurity .",
    "here we suggest that a partially screened value should be used in order to reproduce the experimental kondo temperature .",
    "the article is separated in two main parts . in the first part ( sec .",
    "[ sec : method ] ) we describe the theoretical methods , while in the second ( secs .",
    "[ sec : comput ] and [ sec : results ] ) we present the results for the tov molecule on au . in the first part",
    "we initially summarize the projection scheme and outline how the different contributions to the transmission are computed ( secs .",
    "[ sec : negf_setup ] to [ sec : teq ] ) , and then we describe the employed ctqmc algorithm ( sec .",
    "[ sec : ctqmc ] ) and the analytic continuation of the ctqmc data ( sec .",
    "[ sec : analyticcont ] ) . in the second part , we start by listing the computational details of the dft and negf calculations ( sec . [",
    "sec : comput ] ) .",
    "we present the dft results for the gas phase tov , for the tov on gold ( sec .",
    "[ sec : geo ] ) and the dft+negf results for the transport properties ( sec .",
    "[ sec : teq ] ) .",
    "we then introduce the aim and discuss its solution within the mean - field approximation ( sec .",
    "[ sec_mf ] ) and by ctqmc ( sec . [ sec_kondo ] ) . finally , we present the transport properties computed via dft+negf+ctqmc ( sec . [",
    "sec : tctqmc ] ) and we conclude ( sec . [ sec : conclusions ] ) .",
    "the first step of the method is the separation of the anderson impurity sub - system from the full system calculated in the dft+negf setup .",
    "this is done by an appropriate projection scheme , outlined in subsections [ sec : negf_setup ] , [ sec : projection ] , and [ sec : hybridization ] , and schematically summarized in appendix [ sec : appendixsum ] .",
    "then , the aim with an effective interaction term is introduced and solved .",
    "this means that the many - body green s function and self - energy are computed ( subsection [ sec : interaction ] ) so that the transport properties can be obtained ( subsection [ sec : teq ] ) .",
    "the method can , in principle , address both zero- and finite - bias transport problems provided the availability of a computationally efficient out - of - equilibrium solver for the aim .",
    "nevertheless , in this work we only consider the zero - bias case , and therefore the solution of the aim is achieved by using ctqmc for quantum systems in equilibrium at finite temperatures , as outlined in subsection [ sec : ctqmc ] .",
    "the use of ctqmc requires a scheme to carry out the analytic continuation of the many - body green s function from the discrete imaginary matsubara frequencies onto real energies this is presented in subsection [ sec : analyticcont ] . a schematic summary of the whole method is shown in fig .",
    "[ fig : schematicmethod ] .",
    "the method has been implemented in the negf code _ _",
    "smeagol__@xcite , which uses a linear combination of atomic orbitals ( lcao ) basis set @xmath2 , and obtains the ks hamiltonian from the dft package siesta@xcite .",
    "note however that the method is general and can be readily used for any code based on the lcao approach .",
    "each basis orbital @xmath3 in _ smeagol _ is characterized by its integer index @xmath4 , which is a collective index that includes the atom , @xmath5 , the orbital @xmath6 , and the angular momentum @xmath7 indices . the orbital index @xmath6 can run over different radial functions corresponding to the same angular momentum , according to the multiple - zetas scheme@xcite .",
    "any operator @xmath8 can be expressed in this basis by using its matrix form @xmath9 , with the matrix elements given by @xmath10 as a matter of notation we remark that in general upper case symbols represent matrices , and to distinguish operators from matrices we explicitly add a hat on top of the symbol for operators .",
    "the setup used in the calculations is schematically illustrated in fig .",
    "[ fig : p_schematic ] , where the basis set described above is used to expand the charge density@xcite .",
    "like in standard electron transport simulations , the system is first split into a semi - infinite left lead , a so - called scattering region ( or _ extended molecule _",
    "( em ) ) , and the semi - infinite right lead@xcite .",
    "we denote the number of basis orbitals within the em by @xmath11",
    ". we can then introduce the hamiltonian matrix of the em as @xmath12 , where the basis orbitals span all orbitals within the em , and where @xmath13 is the hamiltonian operator . since in general",
    "the basis set is non - orthogonal , we also need to introduce the overlap matrix of the em , @xmath14 , given by @xmath15 we note here that we shift all energies of leads and em in such a way to set the fermi energy , @xmath16 , equal to 0",
    ". such a global shift of the spectrum does not affect the properties of the system .",
    "the em is then further subdivided in a total of 3 subsystems .",
    "a set of pre - determined wave - functions @xmath17 ( @xmath18 $ ] ) , defines the _ anderson impurity _ ( ai ) , with @xmath19 being to the number of interacting states .",
    "the _ interacting region _ ( ir ) includes all basis orbitals inside the em that contribute to the ai , which corresponds to the collection of those basis orbitals of the em where any of the @xmath20 is non - zero .",
    "the number of basis orbitals in the ir , @xmath21 , is usually much larger than @xmath19 .",
    "we require that the overlap and hamiltonian matrix elements between orbitals within the ir and the orbitals of the leads outside the em is zero , so that the em has to be chosen large enough to ensure this . as last subspace we introduce the _ extended interacting region _ ( er ) , which includes all basis orbitals inside the em that have a finite overlap or hamiltonian matrix element with the basis orbitals within the ir .",
    "we denote the number of orbitals within the er as @xmath22 , with @xmath23 . ordered by decreasing size , the 4 subsystems are then : em , er , ir , and ai .",
    "the ai is a subsystem of the ir , the ir is a subsystem of the er , and the er is a subsystem of the em ( see fig .",
    "[ fig : p_schematic ] ) .",
    "( @xmath24 ) , the one of the em as @xmath25 , and the coupling hamiltonian matrix as @xmath26 ( @xmath27 ) .",
    "the em is further subdivided in the _ interacting region _",
    "( ir ) and the _ extended interacting region _ ( er ) .",
    "the ir includes a set of interacting molecular orbitals @xmath28 , with @xmath18 $ ] ( @xmath19 is the number of interacting molecular orbitals ; in the schematic figure @xmath29 ) , forming the _ anderson impurity _ ( ai ) . the er consists of all orbitals in the em that have finite overlap with the ir orbitals , so that the ir orbitals are always also part of the er . in total the system is therefore subdivided into 4 subspaces of decreasing size : em , er , ir , and ai .",
    ", width=321 ]    the first step is therefore to define the set of molecular orbitals , @xmath28 , inside the em that constitute the ai .",
    "the method outlined here is applicable for any arbitrary set of wave - functions , although in general the choice of the @xmath28 is based on physical intuition . in the simplest case",
    "one can simply take a combination of @xmath30 or @xmath31 orbitals for correlated magnetic atoms in the system , or else the wave - functions of the homo or lumo of a molecule attached to metal electrodes .",
    "a practical way to construct such a set of interacting molecular orbitals is to extract from the full em hamiltonian , @xmath25 , and overlap , @xmath14 , matrices sub - blocks with basis orbitals on the molecule , which we denote as @xmath32 and @xmath33 , respectively .",
    "we can then calculate the eigenvalues @xmath34 and eigenvectors @xmath17 of these sub - systems by solving @xmath35 .",
    "note that each of the @xmath17 is a vector of dimension @xmath21 .",
    "once the set of wave - functions that defines the ai as @xmath36 is chosen ( here we have added the subscript `` ir '' to indicate explicitly that the wave - functions extend over the ir ) , the projection matrix onto the ai inside the ir , @xmath37 , is then defined as @xmath38 which is of dimension @xmath39 .",
    "we then construct the er by adding to the ir all basis orbitals within the em that have finite overlap with the ir basis orbitals , and construct the set of wave - functions @xmath40 .",
    "each @xmath41 is a vector of length @xmath22 , and is equal to @xmath42 for its elements within the ir , and 0 for the others .",
    "these vectors therefore define the ai in the er , and lead to the er projection matrix onto the ai , @xmath43 , given by @xmath44 which is of dimension @xmath45 .",
    "note that the simulation setup in _ smeagol _ requires that one leads unit cell is included at both the left and right ends of the em .",
    "for the projection onto the ai we then further require that the orbitals of those cells can not be part of the ir , while they are allowed to be part of the er .    if the basis orbitals indices are approximately ordered from left to right in the em , then the overlap matrix of the em@xcite can be written in the following general block - matrix structure @xmath46 where @xmath47 is a @xmath48 matrix .",
    "@xmath49 ( @xmath50 is a square matrix that includes all the @xmath51 ( @xmath52 ) orbitals within the em on the left ( right ) of the er , so that @xmath53 .",
    "the dimensions of the off - diagonal matrix blocks are determined from the ones of the diagonal blocks , and are therefore not explicitly given .",
    "we subdivide the hamiltonian matrix in an analogous way .",
    "note that by construction the following important relations are satisfied : @xmath54 , @xmath55 , @xmath56 , and @xmath57 .",
    "the green s function ( gf ) matrix of the em is then given by the standard form@xcite @xmath58^{-1 } , \\label{eq : gf}\\ ] ] which has the block - matrix structure analogous to the one of the @xmath25 and @xmath14 matrices in eq .",
    "( [ eq : ssmall ] ) ; @xmath59 is an arbitrary complex number , and @xmath60 and @xmath61 are the left and right leads self - energies that describe the coupling of the em to the leads .",
    "these are computed according the algorithm in ref . .",
    "importantly , @xmath62 can be either the retarded gf if @xmath63 , with @xmath64 the real energy and @xmath65 a vanishingly small positive real number , or the matsubara gf if @xmath66 , with @xmath67 , for @xmath68 and @xmath69 the inverse temperature ( @xmath70 is the boltzmann constant , @xmath71 is the temperature ) .",
    "spin indices are omitted in above equations and in the following subsections to simplify the notation , but they will be explicitly re - introduced when required to emphasize spin - dependent relations .      here",
    "we outline how to separate explicitly the ai sub - system from the rest of the system , which we refer to as the `` bath '' , and that includes the orthogonal subspace to the ai within the em as well as the semi - infinite electrodes . to this aim",
    "we introduce a basis transformation matrix , @xmath72 , which transforms the overlap , hamiltonian , and self - energy matrices as @xmath73 where we denote the transformed matrices with a bar on top of the symbol .",
    "this transformation is required to bring any general matrix extending over the orbitals of the em , @xmath74 , into a transformed form , @xmath75 , in which the top left corner describes the ai , the bottom right corner describes the part of the bath included in the em ( b ) , and the off - diagonal blocks describe the connection terms .",
    "we note that the full bath includes orbitals from both the em and the semi - infinite electrodes , while the @xmath76 matrix @xmath77 contains only the @xmath78 bath orbitals within the em . in mathematical terms",
    "we therefore require @xmath75 to have the following block - matrix structure : @xmath79 we also require the projection to lead to a zero overlap between the ai orbitals and the bath orbitals .",
    "the form of @xmath72 to achieve this for the transport setup is derived in appendix [ sec : appendixafp ] , and is given by @xmath80 here and in the following we denote an identity matrix of dimensions @xmath81 as @xmath82 . we have introduced @xmath83 which is equal to the projection matrix @xmath84 [ eq .",
    "( [ eq : uer ] ) ] , multiplied by the @xmath85 matrix @xmath86 , which in general is constructed in such a way to orthogonalize both the overlap and hamiltonian matrices of the ai itself . in principle this second transformation is arbitrary and can also be omitted , depending on how the ai problem is solved .",
    "the @xmath87 matrix @xmath88 spans the orthogonal space to the ai inside the er , so that @xmath89 , and therefore projects onto the non - interacting part of the er . we denote the number of non - interacting states within the er as @xmath90 , so that @xmath91 .",
    "there is some freedom in the construction of the matrices @xmath86 and @xmath88 , since they are not uniquely defined .",
    "we construct them in such a way to leave the non - interacting part close to the original system , and the detailed relations to construct @xmath86 and @xmath88 are given in appendix [ sec : appendixafp ] , eqs .",
    "( [ eq : w2ai ] ) and ( [ eq : wni ] ) .    the explicit form of the final transformed overlap matrix is then evaluated to @xmath92 which as required has zero overlap between ai and bath orbitals , and where @xmath93 the final general form of the projected hamiltonian matrix is @xmath94 where @xmath95    the general structure of the resulting matrices has the required shape given in eq .",
    "( [ eq : aibath ] ) , with @xmath96 and @xmath97 note that the transformed self - energy matrices extend only over the block of the bath inside the em , and are zero for the other matrix blocks .",
    "this is ensured by the requirement that the orbitals of the left and right leads unit cells included at the boundaries of the em are not part of the ir .",
    "the transformation for the gf is given by @xmath98 and can also be evaluated directly in the transformed system as @xmath99^{-1}. \\label{eq : gfbar}\\ ] ]    it is possible to evaluate the required inverse of @xmath72 by blocks ( appendix [ sec : appendixaip ] ) , and the result is @xmath100 where @xmath101 with @xmath102 the form of the @xmath103 block - matrix @xmath104 is given in appendix [ sec : appendixaip ] , eq .",
    "( [ eq : winvni ] ) .      by removing the ai orbitals from the system",
    "we can introduce the gf of only the bath orbitals within the em , @xmath105 , as @xmath106^{-1 } , \\label{eq : bargb}\\ ] ] which can be written in a block - matrix structure analogous to the one of @xmath107 [ eq .",
    "( [ eq : sb ] ) ] as @xmath108    by using also eqs .",
    "( [ eq : gfbar ] ) , ( [ eq : smatexp ] ) and ( [ eq : hmatexp ] ) the gf on the ai is then obtained as @xmath109^{-1}. \\label{eq : gbar2}\\end{aligned}\\ ] ] here we have introduced the so - called hybridization function , @xmath110 , which is given by @xmath111 we remark that in general @xmath110 is a dense @xmath85 matrix .",
    "therefore , optionally , as alternative possibility one can modify the transformation matrix @xmath86 to an energy - dependent form that diagonalizes @xmath110 rather than @xmath112 . in appendix",
    "[ sec : appendixhyb ] we derive an equivalent , commonly used expression for the hybridization function .",
    "furthermore , in appendix [ sec : appendixlimitdelta ] we show that @xmath110 exhibits the correct physical decay for large @xmath59 .",
    "once @xmath113 and @xmath105 are known , then the remaining block matrices of the gf within the em [ see eq .",
    "( [ eq : aibath ] ) for the general matrix structure ] can be evaluated to @xmath114      the ai is fully characterized at the ks - level through the `` on - site '' upper - block @xmath115 of the hamiltonian matrix in eq .",
    "( [ eq : hmatexp ] ) , which is coupled to the bath via the off - diagonal block @xmath116 .",
    "the aim hamiltonian operator can be rewritten in its standard form as an operator in second quantization @xmath117 , with @xmath118.\\end{aligned}\\ ] ] here @xmath119 is the annihilation ( creation ) operator for an electron of spin @xmath120 in the orbital @xmath121 of the ai , while @xmath122 is the annihilation ( creation ) operator for an electron of spin @xmath120 in an orbital @xmath123 of the total bath , whose hamiltonian matrix is formally written as @xmath124 .",
    "we note that @xmath124 includes the elements of @xmath125 obtained from the projection of the em hamiltonian with the eq .",
    "( [ projection ] ) , as well as the elements of the semi - infinite electrodes .",
    "the effect of the leads is accounted for in the bath green s function [ eq .  ( [ eq : bargb ] ) ] , and therefore in the hybridization function [ eq .  [ eq : bardelta2 ] ] through the projected self - energies @xmath126 and @xmath127 , so that the full @xmath124 never needs to be explicitly computed .    in order to account for many - body correlation effects , we supplement the ai with an effective coulomb interaction , expressed by the operator @xmath128 then the interacting aim hamiltonian operator is defined as @xmath129 @xmath130 is typically chosen to have the form of a generalized hubbard - like interaction , while @xmath131 is the double - counting correction@xcite . this double - counting correction is required in order to subtract the correlation effects in the ai that are already included at the ks level .",
    "the exact form of @xmath131 is unfortunately not known , and several approximations have been introduced , the most common one being the so - called `` fully localized limit''@xcite .",
    "this is the one that we also employ .    for a single impurity one - orbital anderson model ( siam ) one",
    "has @xmath132 with the hubbard @xmath133 being a real number , and @xmath134 ( @xmath135 ) the occupation operator for up - spin ( down - spin ) electrons on the ai .",
    "the double - counting correction in the fully localized limit has the simple expression @xmath136 where @xmath6 is the dft total occupation of the impurity .",
    "+ the solution of the interacting aim leads to the many - body gf on the ai , @xmath137 .",
    "one can then define the many - body self - energy on the ai , @xmath138 , by means of the dyson equation @xmath139 since we are considering the case of a single interacting region , the full many - body self - energy matrix of the em is zero for all elements , except for those of the ai @xmath140 here we use the notation @xmath141 to denote a @xmath81 matrix with all zeroes ; the sizes of the off - diagonal blocks are determined by the ones of the diagonal blocks . if @xmath142 is known , it can be used to directly calculate the many - body gf as @xmath143^{-1}. \\label{eq : gmbbar}\\ ] ]    in cases when the many - body self - energy is required in the original basis , this can be obtained by applying the inverse transformation as @xmath144 by using eqs .",
    "( [ eq : winvsimple ] ) and ( [ eq : sigmamb ] ) the explicit structure of @xmath145 becomes @xmath146 the non - zero block of @xmath147 extends over the er , and is given by @xmath148 with @xmath149 given in eq .",
    "( [ eq : wiabc ] ) . after calculating @xmath150 one",
    "can then obtain the full many - body gf in the original basis as @xmath151^{-1}. \\label{eq : gmb}\\ ] ]      the current flowing out of the em into the right electrode , @xmath152 , can be written as sum of a component transmitted into the right electrode from the left electrode , @xmath153 , and a component flowing from the ai into the right electrode , @xmath154,@xcite @xmath155 a similar expression holds for the current flowing from the left electrode into the em , @xmath156 , as outlined in appendix [ sec : appendixcurrent ] . at steady state",
    "the current conservation condition implies that @xmath157 .",
    "+ the value of @xmath153 can be evaluated using the left to right energy dependent many - body transmission coefficient , @xmath158 , which we will simply denote as transmission , @xmath159 , from now on in order to simplify the notation .",
    "@xmath153 is then given by @xmath160 where @xmath161 is the electron charge , @xmath162 is the planck constant , @xmath163 ( @xmath164 ) is the fermi dirac distribution at the chemical potential of the left ( right ) electrode , and @xmath165\\nonumber\\\\ & = & \\mathrm{tr}\\left[\\bar{\\gamma}_\\mathrm{l}(e ) { \\bar{g}^{\\mathrm{mb}\\dagger}}(e ) \\bar{\\gamma}_\\mathrm{r}(e ) \\bar{g}^\\mathrm{mb}(e)\\right].\\label{eq : tre}\\end{aligned}\\ ] ] @xmath166 includes all interference effects between the possible transport channels across the system , including the effects of interactions on the ai .",
    "the so called coupling matrices @xmath167 are defined as @xmath168,\\label{eq : gammal}\\\\ \\gamma_\\mathrm{r}(e)&= & i\\left[\\sigma_\\mathrm{r}(e)-\\sigma_\\mathrm{r}^\\dagger(e)\\right],\\label{eq : gammar}\\end{aligned}\\ ] ] and @xmath169 .",
    "note that if the matsubara gf is computed by using eqs .",
    "( [ eq : gf ] ) or ( [ eq : gmbbar ] ) with @xmath66 , one has to perform the analytic continuation from the complex matsubara energies to the real axis in order to obtain the retarded gf prior to the calculation of the transmission .",
    "the procedure that we have chosen to carry out such operation is described in sec.[sec : analytic ] .",
    "note also that we can equally express the transmission and current in terms of the quantities in the original basis and in the transformed one . in what follows we work in the transformed basis .",
    "+ the transport properties of a molecular device in dft+negf are usually expressed in terms of the transmission coefficient for the ks system@xcite , denoted as @xmath170 , which is given by@xcite @xmath171.\\label{eq : tr0}\\end{aligned}\\ ] ] it has the analogous structure to @xmath159 , but with the many - body gf replaced by the ks one . therefore @xmath159 accounts for the renormalization of the coherent transport properties via many - body effects not included at the ks dft level , and in the following , we refer to @xmath153 as the coherent , or elastic , component of the current .",
    "in contrast , @xmath154 represents the incoherent component of the current .",
    "+ the incoherent component of the current flowing from the ai to the right electrode is given by ( see appendix [ sec : appendixcurrent ] ) @xmath172 , \\label{eq : irai}\\end{aligned}\\ ] ] where we have introduced the occupation matrix of the ai , @xmath173,@xcite and @xmath174,\\ ] ] which is defined in a similar way to the coupling matrices in eqs .",
    "( [ eq : gammal ] ) and ( [ eq : gammar ] ) , but with the many - body self - energy replacing the the leads self - energies . the general structure of the occupation matrix is analogous to the one of @xmath175 in eq .",
    "( [ eq : sigmamb ] ) , and can be written as @xmath176 the quantity inside the trace of eq .",
    "( [ eq : irai ] ) can be interpreted as a transmission matrix , given by @xmath177 , times the difference in the distribution matrices , given by @xmath178 .",
    "it therefore has the analogous structure to @xmath153 in eq .",
    "( [ eq : ielastic ] ) , with the only difference that since @xmath179 is a matrix it can not be moved outside the trace .",
    "the analogous equations for the current from the left lead into the em , @xmath156 , are given in appendix [ sec : appendixcurrent ] .",
    "if we assume that the matrices @xmath180 and @xmath181 are zero , or more generally that their values are small enough that they can be neglected , and that @xmath182 ( @xmath183 ) extends only over the region @xmath184 ( @xmath185 ) , then we can obtain the transmission function from the gf block matrix of the ni as @xmath186,\\ ] ] where @xmath187 $ ] and @xmath188 $ ] .",
    "the matrices @xmath189 are given by @xmath190^{-1}\\bar{k}_{\\alpha,\\mathrm{ni}},\\\\ \\bar{\\sigma}_\\mathrm{r , ni}(e)&=\\bar{k}_{\\mathrm{ni},\\beta}\\left[\\bar{k}_{\\beta\\beta}- \\left(\\bar{\\sigma}_{\\mathrm{r}}\\right)_{\\beta\\beta}(e)\\right]^{-1}\\bar{k}_{\\beta,\\mathrm{ni}},\\end{aligned}\\ ] ] with @xmath191 having the analogous block - matrix structure to @xmath192 in eq .",
    "( [ eq : hmatexp ] ) , and for real energies @xmath193 and @xmath194 .",
    "note that @xmath195 , @xmath196 , and with the assumptions made in this paragraph we have @xmath197 and @xmath198 . + with eq .",
    "( [ eq : gfexpand ] ) the gf block matrix of the ni can be obtained from the one of the ai as @xmath199 with @xmath200 the transmission can then be decomposed in three components @xmath201 where we have introduced the background or bath transmission @xmath202 , \\label{eq : tbath}\\ ] ] the transmission through the ai @xmath203 , \\label{eq : tai1}\\ ] ] and the interference term of the transmission @xmath204\\nonumber\\\\ & + & \\mathrm{tr}\\left[\\bar{\\gamma}_\\mathrm{l , ni}(e ) { \\bar{g}}_\\mathrm{ni}^{\\dagger}(e ) \\bar{\\gamma}_\\mathrm{r , ni } ( e ) \\delta\\bar{g}_\\mathrm{ni}^\\mathrm{mb}(e)\\right ] .",
    "\\label{eq : tinterference}\\end{aligned}\\ ] ] often the background and ai transmission do not interfere significantly , so that it is useful to give estimates for their separate values . in that case typically",
    "the transmission is composed of a background value , onto which the peaks due to transport through the ai are added . the transmission through the ai can be rewritten as @xmath205 , \\label{eq : tai2}\\ ] ] which depends only on the gf of the ai , and on the hybridization matrices of the ai , given by @xmath206 we can perform the analogous transformations also for @xmath154 from eq .",
    "( [ eq : irai ] ) , and obtain @xmath207,\\end{aligned}\\ ] ] where we have defined @xmath208 .",
    "\\label{eq : gammamb}\\ ] ] in general therefore the calculation of the current requires the knowledge of the impurity occupation matrix @xmath209 , which in turn requires the solution of the non - equilibrium problem . in refs .",
    "@xcite a specific shape is implicitly assumed for this matrix@xcite , which allows simplified estimates of the currents .",
    "the approach proposed in those references requires the inversion of the coupling matrices @xmath210 and @xmath211 , which is however not defined in the general case @xcite .",
    "we now consider the special case where @xmath212 , with @xmath213 a constant@xcite .",
    "this rather strict condition can usually only be fulfilled for a siam , so that in the remainder of this section we consider only the siam . in this case",
    "it is possible to avoid the calculation of @xmath214 by using the current conservation condition @xmath157@xcite , and one obtains @xmath215 with @xmath216 where we have used the fact that for the siam all quantities in the equation are just numbers instead of matrices .    using eqs .",
    "( [ eq : ielastic ] ) and ( [ eq : iraispecial ] ) for the special case of a siam , and @xmath212 ,",
    "we can write the total current as @xmath217 with the total effective transmission , which includes elastic and incoherent terms , given by @xmath218 we can collect the terms that describe the effective total transmission across the ai , @xmath219 , as@xcite @xmath220 . \\label{eq : ttai}\\end{aligned}\\ ] ] eqs .",
    "( [ eq : itotal]-[eq : ttai ] ) extend the results of ref .",
    "@xcite to the more general case including background transmission and interference terms , as typically found for stm experiments of molecules on surfaces .",
    "+ in this article we only consider applications to linear - response transport , so that the conductance @xmath221 is given by @xmath222 this equation generalizes the landauer formula used in dft+negf to the case of an interacting em , with the only difference that @xmath170 ( used in the landauer formula ) is replaced by @xmath219 . therefore ,",
    "following the standard practice used in dft+negf that consists in analyzing the zero - bias transport properties by means of the transmission at equilibrium @xmath170 , here we will present the results for zero - bias transport in presence of many - body effects by plotting @xmath219 .",
    "[ sec : ctqmc ]    in the present work the aim is solved by using ctqmc for quantum systems in thermodynamic equilibrium@xcite , since we only address linear - response transport . in this case",
    "the method is well - established .",
    "we note however that recently there have been a number of developments towards the extension of ctqmc to out - of - equilibrium problems , both in steady - state and time - dependent frameworks@xcite .",
    "+ in this work , two different algorithms have been considered : the weak - coupling approach , called continuous - time auxiliary field ( ct - aux)@xcite , and the hybridization expansion , strong coupling approach ( ct - hyb)@xcite .",
    "ct - aux scales as the product of the interaction @xmath133 and of the inverse temperature , so that its application turns out too computationally demanding for kondo systems at temperatures of the order of only a few kelvin .",
    "in contrast , we found ct - hyb able to provide quite accurate results at a reasonable computational cost for the specific au / tov system considered in the following . since this system is described as a siam , here we present the method only for this case .",
    "however , we remark that our implementation can treat multi - orbital systems as well , although only for density - density interaction terms .",
    "ctqmc is restricted to finite - temperatures , where the partition function is given by @xmath223 $ ] .",
    "the starting step , which is common to all algorithms , is to separate the interacting aim hamiltonian [ eq .",
    "( [ iaim ] ) ] in two parts , a reference hamiltonian @xmath224 and a perturbation hamiltonian @xmath225 , so that @xmath226 .",
    "each ctqmc algorithm differs in the exact definition of @xmath224 and @xmath225@xcite . while in ct - aux and other weak - coupling approaches @xmath225",
    "is set equal to the effective coulomb interaction term @xmath227 [ eq .  ( [ hubbard ] ) ] , in ct - hyb one imposes@xcite @xmath228 with @xmath229 , @xmath230 , @xmath231 and @xmath232 defined in subsection [ sec : interaction ] . therefore the perturbation hamiltonian in ct - hyb is represented by the bath - ai coupling , while the reference hamiltonian is that of the decoupled atomic - like correlated ai and of the isolated bath .",
    "having divided the hamiltonian in two parts , one is able to introduce the interaction picture , where an operator @xmath8 depends on the imaginary time @xmath233 as @xmath234 , with @xmath235 , and the partition function is written as the standard time - ordered exponential @xmath236\\nonumber\\\\ & = \\sum_{n=0}^\\infty\\int_0^\\beta d\\tau_1 ... \\int_{\\tau_{n-1}}^\\beta d{\\tau}_{n}\\ ,   w_n , \\label{part_f}\\end{aligned}\\ ] ] with @xmath237 the time - ordering operator , and @xmath238.\\label{w_part_f}\\ ] ] the partition function has the form of an integral over a configuration space . in such space , any particular configuration is specified by the expansion order @xmath6 , the times @xmath239 and a set of discrete variables , for instance the spin , and it is characterized by the probability distribution @xmath240 .",
    "it is this integral , which is ultimately evaluated by monte carlo techniques . + by using the definitions of @xmath224 and @xmath225 in eqs ( [ h1 ] ) and ( [ h2 ] ) , @xmath241 in eq .",
    "( [ w_part_f ] ) becomes@xcite @xmath242\\\\   \\times\\prod_\\sigma \\det{d_\\sigma^{-1}}(\\tau_{1}^\\sigma, ... ,\\tau_{n_\\sigma}^\\sigma;{\\tau'}_{1}^\\sigma, ... ,{\\tau'}_{n_\\sigma}^\\sigma).\\label{wc}\\end{gathered}\\ ] ] here @xmath243 is the bath partition function , @xmath244 , @xmath245 and the matrix @xmath246 has elements @xmath247 which are the fourier transforms of the hybridization function @xmath248 evaluated for the imaginary - time interval @xmath249 , which separate pairs of operators @xmath250 and @xmath251 in eq .",
    "( [ wc ] ) . in the function",
    "@xmath241 the trace accounts for the impurity that fluctuates between different quantum states as electrons jump in and out , while the determinants resum the bath evolutions which are compatible with the sequence of quantum fluctuations in the impurity .",
    "note that here we have explicitly re - introduced the spin - index that was dropped from the equations in the previous subsections .",
    "however , if the bath is non - magnetic like in most cases , the hybridization function is the same for spin - up and down , and can therefore be obtained from non spin - polarized calculations .    in the specific case of a one - orbital hubbard interaction , ct - hyb can be efficiently implemented by using the so - called `` segment representation''@xcite .",
    "this means that each configuration is depicted by segments , which represent time intervals @xmath252 during which an electron of a given spin resides on the impurity .",
    "notably , with such representation the trace in @xmath241 can be evaluated in polynomial time .",
    "new configurations are then obtained by either adding or removing segments .",
    "this is enough to ensure ergodicity , although other operations ( such as shifting the segments end - points ) and global updates must be implemented to ensure an efficient sampling .",
    "each update is accepted or rejected according to the metropolis algorithm .",
    "the acceptance probability is efficiently computed with standard fast matrix update methods@xcite .    as seen in eq .",
    "( [ delta_tau ] ) , ct - hyb requires the fourier transform of the hybridization function , which in principle is calculated through a summation over an infinite number of frequencies .",
    "however , in practice only a finite number of frequencies smaller than a certain cutoff @xmath253 can be inevitably summed up , although the high - frequency limit of @xmath254 determines @xmath255 close to @xmath256 .",
    "therefore , in order to accurately calculate @xmath257 for any arbitrary @xmath233 , we use a standard approach that consists in adding and removing from eq .",
    "( [ fourier ] ) the high frequency limit of @xmath258 .",
    "this limit is given by @xmath259 , with @xmath260 given in eq .",
    "( [ eq : m1 ] ) of the appendix [ sec : appendixlimitdelta ] .",
    "hence we evaluate @xmath257 as @xmath261+\\frac { m_1}2,\\end{gathered}\\ ] ] where the summation is restricted to positive frequencies , since @xmath262 and @xmath263 .",
    "+ during monte carlo sampling the many - body matsubara gf can be directly estimated . however , following boehnke _",
    "@xcite , we use an expansion of the @xmath264 in terms of legendre polynomials , @xmath265 $ ] , @xmath266 and we estimate the expansion coefficients @xmath267 . the advantage of this choice is twofold .",
    "first , the transformation ( [ gl ] ) can be written as a unitary transformation .",
    "second , only few legendre coefficients are needed to express the matsubara gf .",
    "this is because the legendre coefficients for a matsubara gf decay faster than any power of the legendre expansion index @xmath268@xcite .",
    "a valuable effect of this is that the statistical noise is filtered out due to the cutoff at a certain expansion order .",
    "after extensive tests for the specific system studied in this work , we found that an appropriate choice for the cutoff of the legendre polynomials is around 100 .",
    "however , such cutoff must generally be determined for each specific case .",
    "+ the many - body self - energy is obtained either from the dyson eq .",
    "( [ eq : sai ] ) , or by using the expression@xcite @xmath269 where @xmath270 is the matsubara representation of the correlation function @xmath271 , which can be easily computed in the legendre polynomial basis at no extra cost@xcite .",
    "this last approach usually provides much more accurate results than the calculation through the dyson equation . the inversion of the gf in eq .",
    "( [ eq : sai ] ) amplifies the statistical noise , in particular at high matsubara frequencies , when the difference between interacting and non - interacting gf is very small .",
    "in contrast , such problem is not present when using eq .",
    "( [ fg ] ) .",
    "+ finally , we note that , although in this subsection we have made explicit the dependence of the gf on the spin - index for notation completeness , the spin up and down gfs are equal as long as the substrate is non - magnetic , and there is no zeeman - like term in the aim hamiltonian .",
    "since this is the case for the application presented in this work , we will once again drop this index in the following .",
    "[ sec : analyticcont ]    in order to compute the transport properties , as outlined in subsection [ sec : teq ] , we need the retarded many - body gf on the ai , @xmath272 , whose imaginary part defines the spectral function @xmath273 normalized as @xmath274 and which is related to the real part via the kramers - kronig relation @xmath275 however , ctqmc returns the matsubara gf @xmath276 and not @xmath272 .",
    "the relation between the spectral function , eq .",
    "( [ a_mb ] ) , and the matsubara gf is determined by the hilbert transformation @xmath277 which must therefore be inverted to find the unknown @xmath278 from @xmath276 .",
    "unfortunately , the inversion of the hilbert transformation belongs to the class of ill - posed problems , for which there is no unique solution in a mathematical sense . despite that ,",
    "several numerical methods have been proposed during the last few decades to deal with this problem in the context of quantum monte carlo methods@xcite . here",
    "we employ the stochastic optimization ( so ) , and our implementation is based on the original proposal by mishchenko _",
    "et al._@xcite , with some modifications .",
    "we have verified that there are only negligible quantitative differences between the results obtained with our code and the original version by mishchenko@xcite .",
    "other methods , such as the pade approximation@xcite and the maximum entropy@xcite methods , which are routinely employed by the dmft practitioners , have been tested as well .",
    "however , the results are found to depend critically on the precision of the monte carlo data , so that they result in overall unsatisfactory performances .",
    "the so relies on the parametrization of the spectral function @xmath279 as a sum of @xmath280 rectangles determined by the height @xmath281 , the length @xmath282 and the center @xmath283 , and which is normalized as in eq .",
    "( [ normalization ] ) .",
    "this means that @xmath284 with @xmath285\\\\ 0 \\mbox {     otherwise}\\end{cases}.\\ ] ] accordingly , the gf obtained by using this @xmath286 in eq .",
    "[ analytic ] reads @xmath287 .",
    "\\label{gt_analytic}\\ ] ] the optimization algorithm proceeds through a series of global stochastic updates that change the number , the size and the location of the rectangles in order to minimize a given deviation function between @xmath288 and the original set of gfs obtained by ctqmc .",
    "importantly , the fact that @xmath289 has an analytic expression [ eq .  ( [ gt_analytic ] ) ] largely improves the performances of the method .",
    "once the many - body retarded gf is computed for real energies , the many - body self - energy on the real energy axis can be obtained by using the dyson eq .",
    "( [ eq : sai ] ) .",
    "alternatively , the analytic continuation of the self - energy @xmath290 can be directly carried out @xcite .",
    "the dft calculations for the tov molecule in gas phase are performed by using the siesta code@xcite .",
    "norm - conserving troullier - martin pseudopotentials are used together with a double-@xmath291 plus polarization quality basis set .",
    "the perdew - burke - ernzerhof ( pbe ) generalized gradient approximation ( gga)@xcite for the exchange - correlation density functional is considered .",
    "additional all - electron calculations are carried out with the fhi - aims package@xcite . in particular , fhi - aims is used to compare the results of pbe with those obtained with the pbe0 hybrid functional@xcite . furthermore , the g@xmath292w@xmath292 method@xcite of the many - body perturbation theory is also employed .",
    "g@xmath292w@xmath292 calculations are carried out by using the ( generalized)-ks orbitals and eigenvalues obtained by either pbe or pbe0 ( the notation g@xmath292w@xmath292@pbe and g@xmath292w@xmath292@pbe0 is used in order to distinguish between the two cases ) .",
    "the computational details are the same as those described in ref .",
    "+ fhi - aims is also employed to optimize the geometry of the tov molecule on au within a supercell approach .",
    "the au(111 ) surface is experimentally found to present fcc and hcp domains separated by ridge regions , and with the molecules that are adsorbed on both domains@xcite .",
    "here we consider the fcc surface , which is modeled as a 4-layer slab with a ( 5x5 ) square unit cell , and each slab is separated by 60   of vacuum from its periodic image . only the molecule and the first two au layers are allowed to relax until forces are smaller than @xmath293 ev/@xmath294 .",
    "the pbe+vdw@xmath295 method@xcite is employed in order to include the effect of the van der waals ( vdw ) interactions .",
    "pbe+vdw@xmath295 has been extensively tested for molecules both physisorbed and chemisorbed on metallic substrates , and the results are generally more accurate than those obtained with other common vdw - corrected gga functionals@xcite .",
    "the values of the screened @xmath296 coefficient , the vdw radius and the polarizability for au are provided by ruiz _",
    "_ in the original article about pbe+vdw@xmath295@xcite .",
    "the standard numerical atom - centered orbitals basis set `` tier 1 '' and `` tier 2 '' are considered for au and h , c , n , o , respectively .",
    "the used @xmath70-points mesh is equal to @xmath297 .",
    "all dft calculations for the gas phase molecule and for the molecule on au are spin - polarized in order to account for the magnetism .",
    "_ smeagol _ electron transport calculations are performed with the relaxed geometries described in the previous subsection , where further au layers are added below the molecule , and the top electrode with the au stm tip is included [ fig .",
    "[ fig : structtransport](a ) ] .",
    "the real space mesh is set by an equivalent energy cutoff of 300 ry , and we use the local density approximation ( lda ) for the exchange correlation potential .",
    "we verified that the transport properties are essentially the same when using the lda or gga functionals .",
    "we employ a double-@xmath291 plus polarization basis set for the all atoms of the molecule , a double-@xmath291 basis for the au atoms , and a double-@xmath291 plus polarization basis with extended orbital cutoffs for the au atoms of the tip .",
    "this ensures that there is an appropriate electronic coupling between tip and molecule also at extended tip - molecule separations .",
    "we verified that due to the large size of the supercell in the plane we can evaluate the electronic structure at the @xmath298-point in the brillouin zone perpendicular to the transport direction .",
    "all calculations of the dft+negf transport properties without the inclusion of the many - body self - energy are spin - polarized . in contrast , non - spin - polarized calculations are used to extract the hybridization function @xmath110 and on - site hamiltonian @xmath115 of the aim , since the magnetism of the tov is accounted for within the aim .",
    "spin - polarized calculations of the hybridization function are only required if the substrate is magnetic .",
    "( left ) and cfg@xmath299 ( right).,scaledwidth=50.0% ]    .somo and sumo energies , @xmath300 and @xmath301 , and somo - sumo energy gap @xmath302 computed with several methods : pbe , pbe0 , @xmath303scf , and the g@xmath292w@xmath292 perturbative correction to the ( generalized-)ks spectrum computed with pbe(0 ) .",
    "@xmath303scf provides the somo and sumo energies for an isolated molecule through finite total energy differences @xmath304 and @xmath305 , where @xmath306 is the pbe energy of the neutral molecule and @xmath307 [ @xmath308 is the energy of the corresponding cation ( anion)@xcite . [",
    "cols=\"<,^,^,^,^\",options=\"header \" , ]      the tov molecule has spin 1/2 due to an unpaired electron , delocalized mainly over the nitrogen @xmath309 orbitals of the planar verdazyl heterocycle ( fig .",
    "[ fig.ldos ] ) . the atoms n2 and n4 carry slightly more spin than n1 and n5 , and the difference of the mulliken populations for spin up and down is equal to @xmath310 for n2 and n4 , and to @xmath311 for n1 and n5 . the spin delocalization over the verdazyl heterocycle reflects the character of the somo , and of the corresponding singly unoccupied molecular orbital ( sumo ) ( fig .",
    "[ fig.ldos ] , left panel ) .",
    "in contrast , the highest doubly - occupied molecular orbital ( homo ) and the lowest unoccupied molecular orbital ( lumo ) are mainly located on the phenyl rings .",
    "the results are overall consistent with the established picture for the tov electronic structure@xcite .",
    "+ although the four n atoms in the verdazyl heterocycle are in the same plane , the molecule does not have a flat conformation .",
    "in fact , we find that the the two phenyl groups attached to n1 and n5 are twisted out of the verdazyl heterocycle plane , either in the same direction by about @xmath312 degrees ( geometry 1 in right panel of fig .",
    "[ fig.ldos ] ) , or in opposite directions by about @xmath313 and @xmath314 degrees ( geometry 2 in the right panel of fig .",
    "[ fig.ldos ] ) .",
    "only the latter conformation ( geometry 2 ) has been previously reported in the literature@xcite , but we find that that the energy difference with the geometry 1 is below @xmath315 mev , which is the numerical accuracy of our calculations set by the used basis set@xcite .",
    "in contrast , the energy difference with the geometry obtained by constraining all three phenyl groups in the same plane as the verdazyl heterocycle is about @xmath316 ev .",
    "+ the molecule s spin can be fully compensated either by charging or by attaching a hydrogen to the oxygen atom , thus forming the h - tov molecule . in both cases",
    ", we find a considerable geometrical rearrangement involving also the n atoms , so that the verdazyl core appears largely distorted , and the phenyl groups are further moved out - of - plane in an asymmetric way .",
    "the optimized geometries for the negatively - charged tov and h - tov are displayed in fig .",
    "[ fig.ldos ] , right panel .",
    "negligible differences are found between the results obtained with pbe and pbe0 , and with siesta and fhi - aims .",
    "+ the somo and the sumo are well separated in energy from all other molecular states , and the somo - sumo gaps obtained with different methods are reported in tab .",
    "[ somo_sumo ] .",
    "several works have demonstrated that g@xmath292w@xmath292 yields excellent results for gaps when the generalized ks orbitals from hybrid dft are used as a starting point for the perturbative calculation@xcite .",
    "for this reason , and due to the lack of experimental data , in the following we consider the g@xmath292w@xmath292@pbe0 estimate of @xmath317 ev as reference value .",
    "we note that that no difference is found within our numerical accuracy for the computed somo - sumo gap in case of the two different tov conformations ( geometries 1 and 2 in in the right panel of fig .",
    "[ fig.ldos ] ) , so that the results in tab .",
    "[ somo_sumo ] apply to both .",
    "+ the geometry optimization of the tov / au system reveals that the molecule can be adsorbed in two different configurations , labelled cfg@xmath318 and cfg@xmath299 . in configuration cfg@xmath318 ,",
    "tov is physisorbed and assumes an almost flat conformation on the surface .",
    "the distances of n2/n4 and n1/n3 from the top au layer are @xmath319    and @xmath320  , respectively .",
    "the average adsorption height of the phenyl rings attached to n1 and n3 is @xmath321  , while that of the phenyl ring attached to c3 is @xmath322 .",
    "the adsorption energy is equal to @xmath323 ev , a value that is comparable to that of typical molecules of similar size ( such as perylenetetracarboxylic dianhydride , ptcda ) physisorbed on au@xcite . by analyzing the mulliken populations",
    ", we note that a small charge transfer of about @xmath324 electrons from the au to the molecule occurs .",
    "this leads to an overall decrease of the somo - sumo exchange splitting and to a partial compensation of the molecule magnetic moment , which reduces to @xmath325 .",
    "configuration cfg@xmath299 corresponds to a qualitatively different physisorbed geometry , which has an adsorption energy of @xmath326 ev . for cfg@xmath299 one full electron",
    "is transferred from the surface to the tov , so that the spin on the molecule completely disappears .",
    "although the adsorption energy for cfg@xmath318 and cfg@xmath299 differs by only about @xmath327 mev , the energy barrier separating the two states is quite large ( @xmath328-@xmath329 ev ) .",
    "indeed we observe that the increased charge transfer is accompanied by a substantial distortion of the tov verdazyl heterocycle , with one of the n atoms ( n4 ) being displaced out of the molecular plane towards the au surface ( see fig .",
    "[ fig.barrier ] ) .",
    "the distance between n4 and the surface decreases to @xmath330 , while the distance between n2 and the surface increases to @xmath331 .",
    "this distortion of the verdazyl core is similar to that observed in the gas phase for the negatively - charged molecule ( fig .",
    "[ fig.ldos ] ) , taking into account that now the phenyl groups are kept parallel to the surface because of the vdw interaction .",
    "we note that our calculations for physisorbed h - tov reveal a similar deformation of the molecule .",
    "we point out that the charge transfer and the consequent spin reduction or compensation are likely overestimated by the calculations , because pbe underestimates the somo - sumo gap .",
    "this problem is commonly found in dft - based electronic transport simulations , and it has been cured in practice by using scissor operator schemes@xcite ( see the following section ) .",
    "the overestimated charge transfer may have important implications for the geometry optimization , since it may artificially stabilize the configuration cfg@xmath299 over the configuration cfg@xmath318 .",
    "the calculation of the correct charge transfer for structural relaxations can currently not be addressed on a fully quantitative level even with state - of - art methods .",
    "dft energy functionals that increase the somo - sumo gap , such as hybrid functionals , do not provide a good description of the metal electronic structure . for configuration",
    "cfg@xmath318 the charge transfer is overall rather small , and in cases of small or negligible charge - transfer pbe+vdw@xmath295 has been shown to perform remarkably well when compared to experimental data@xcite .",
    "we therefore expect that the final geometry for cfg@xmath318 , and in particular the molecule - surface average distance , is accurately predicted . in experiments",
    "two types of molecules are observed on the au surface , denoted as type - a and type - b@xcite .",
    "while type - b molecules display a kondo resonance in the low bias conductance , such resonance is absent in type - a molecules .",
    "type - a molecules have been identified as h - tov , while type - b molecules correspond to configuration cfg@xmath318@xcite .",
    "we note that based on our results the type - a molecules could also correspond to molecules adsorbed with geometry cfg@xmath299 .",
    "however , as discussed in the previous paragraph , it is likely that the calculations overestimate the stability of cfg@xmath299 , and in experiments most type - a molecules may indeed be h - tov . in the remaining part of the manuscript we will address only type - b molecules , where the kondo state has been measured experimentally .",
    "the spin - polarized projected density of states ( pdos ) on the molecule in the transport setup for configuration cfg@xmath318 is shown in fig .",
    "[ fig : structtransport](b ) .",
    "after adsorption , the former gas - phase somo and sumo appear as lorentzian - like peaks that extend around @xmath16 .",
    "the combined effects of the hybridization of the somo and sumo states with the au substrate , and of the small surface - to - molecule charge transfer , induce a reduction of the exchange splitting compared to the gas phase , and consequently of the magnetic moment .",
    "the full width at half maximum of the somo and sumo lorentzian peaks gives their electronic coupling to the substrate , @xmath332 , which we calculate to be @xmath333 290 mev .",
    "this system therefore presents a rather strong electronic coupling to the substrate . in contrast , the electronic coupling to the tip is usually much smaller , and it can be neglected compared to @xmath298 .",
    "the analysis of the transport properties is carried out by looking at the transmission coefficient , @xmath166 ( sec .",
    "[ sec : teq ] ) .",
    "this decays exponentially with the tip height and depends sensitively on the in - plane position of the stm tip .",
    "the transmission through the somo and sumo is largest when the tip is on top of the n atoms of the molecule , so that we place it above atom n2 in the subsequent evaluation of the transport properties , with a tip height of about 5.7   above the plane of the molecule .",
    "the spin - polarized transmission as function of energy is shown in fig .",
    "[ fig : tdistance](a ) , and it can be seen that , like the pdos , also @xmath166 is only slightly spin - split .",
    "we investigate the change of @xmath166 for reduced coupling by rigidly shifting the molecule off from the surface by a distance , @xmath334 , of 0.5  , and 1.0 (fig .",
    "[ fig : tdistance](b - c ) ) .",
    "the results demonstrate that if the coupling is reduced by increasing the molecule - surface separation , then the peak of the radical state is less broad , and the spin splitting increases . for @xmath334 of 0.5",
    "  the radical is fully spin - split , while it is only partly spin - split for @xmath335 0.0  .",
    "this shows that in quantitative predictions of hybridizations of molecules to surfaces the correct evaluation of the contact geometry is of central importance .",
    "experimentally such a change of coupling might be achievable by systematically varying the groups attached to the tov molecule .",
    ".,scaledwidth=43.0% ]    as discussed in the previous section , the lda gas phase ks somo - sumo gap is underestimated when compared to experiment . on a surface",
    "however the gap is reduced due to the image charge effect , which is not captured by the lda ks eigenvalues@xcite .",
    "a fortuitous error cancellation between the gap underestimation and the neglect of image - charge effects may sometimes happen , but this is not generally the case .",
    "here we evaluate the effect that a larger gap has on the transport properties by using a scissor operator ( sco ) approach@xcite , where we increase the somo - sumo gap by about 1 ev to illustrate the general trend ( fig .",
    "[ fig : t_dft ] ) .",
    "we apply the sco correction non - self - consistently as a postprocessing step on top of the lda converged charge density as well as self - consistently .",
    "the opening of the somo - sumo gap leads to a fully spin - split state , where one can clearly identify somo and sumo peaks despite their large broadening .",
    "self - consistency does not qualitatively change the results , demonstrating that applying the correction as a post - processing step to the converged lda solution is a good approximation .",
    "the exact value of the somo - sumo gap , which corresponds to the interaction energy @xmath133 [ eq .",
    "( [ hubbard ] ) ] , for molecules on surfaces can only be estimated .",
    "we will address this issue for the tov molecule deposited on au in sec .",
    "[ sec_kondo ] .",
    "finally , we note that the dft+negf pdos and transmission are spin - split and a magnetic moment appears due to the unequal occupation of spin up and down states .",
    "this is a characteristic broken - symmetry picture , which is only valid for applied magnetic fields@xcite . in absence of magnetic field the symmetry is not broken , and the dft symmetry breaking is an artifact caused by the effective exchange - correlation magnetic field .    , and with a sco applied selfconsistently [ sco ( scf)].,scaledwidth=43.0% ]     ( eq .",
    "( [ eq : bardelta2])).,scaledwidth=43.0% ]      the tov adsorbed on au is represented as a siam through the projection described in sec .",
    "[ sec : method ] .",
    "we remind that here non - spin - polarized dft calculations are used , since magnetism is accounted for in the siam calculation .",
    "the hybridization function , calculated with eq .",
    "( [ eq : bardelta2 ] ) , is shown in fig .",
    "[ fig.delta ] , and mainly reflects the au dos . both the real and imaginary parts are rather featureless over a wide energy range , where only the @xmath336 states contribute to the au dos , while very sharp peaks are present at energies below about @xmath337 ev , where the fully filled @xmath338 bands are located .     and mean - field local magnetic moment @xmath339 as function of @xmath133 .",
    "bottom panel : mf and ctqmc squared local magnetic moment @xmath340 and the corresponding square local magnetic moment in the limit of no correlations @xmath341 .",
    "results are for @xmath342",
    ". error bars in the ctqmc estimates are smaller than the symbols . , scaledwidth=40.0% ]    , @xmath343 , @xmath315 and @xmath344 ev . for @xmath345",
    "ev the spectral function for spin up and down are superimposed as the systems is spin - degenerate.,scaledwidth=40.0% ]    before solving the siam by using ctqmc , we address it within the mean - field approximation , where the hamiltonian @xmath346 in eq .",
    "( [ hubbard ] ) is replaced by @xmath347 , and the double - counting correction is the same as in ctqmc [ eq .",
    "( [ hdc ] ) ] .",
    "the mean - field solution can be directly compared to the broken - symmetry dft+negf results , where @xmath348 plays the same role as the ks potential including the sco , and where @xmath133 determines the somo - sumo gap .    at @xmath345 ,",
    "the total ai occupation @xmath349 is equal to the lda occupation of the ai , obtained with the projection described in sec .",
    "[ sec : method ] .",
    "this is slightly larger than @xmath315 , reflecting the small metal - to - molecule charge transfer predicted by dft , and discussed in sec .",
    "[ sec : geo ] .",
    "the magnetic moment @xmath350 is equal to zero , because the aim is mapped from a non - spin - polarized calculation and @xmath351 . for @xmath352",
    "ev , we see in fig.[fig.n_m ] ( top panel ) that the total occupation @xmath353 initially increases as function of @xmath133 , until the system undergoes a transition to the magnetic state . at this point ( between @xmath354 and @xmath355",
    "ev ) the formation of the magnetic moment is accompanied by the reduction of @xmath356 , which then keeps decreasing monotonically for increasing @xmath133 towards the half - filling limit .",
    "this behavior is qualitatively the same that we find when we apply the sco in the dft+negf ( sec .",
    "[ sec : transportdft ] ) .",
    "the spectral function of the ai is a lorentzian at @xmath345 ev ( fig .",
    "[ fig.dos ] ) , and gradually splits into two ( almost ) lorentzian functions as @xmath133 is increased , one for spin up and one for spin down .",
    "importantly , due to the small charge transfer from the au substrate , these functions are not symmetric around @xmath16 .",
    "moreover , the spectral function for spin down is slightly sharper than that for spin up , which is due to the decrease of absolute value of the imaginary part of the hybridization function with increasing energy ( fig .",
    "[ fig.delta ] ) .",
    "this is overall similar to the dft+negf transmission peaks displayed in fig .",
    "[ fig : t_dft ] .    to conclude this section",
    ", we take advantage of the known exact mean - field spectral function for real energies in order to assess the accuracy of the analytic continuation ( sec .",
    "[ sec : analytic ] ) .",
    "this is shown in fig .",
    "[ fig.amf ] , which compares the exact spectral function evaluated directly for real energies , to the one `` analytically continued '' from complex matsubara frequencies to real energies , and which should in principle be identical to one another .",
    "the accuracy is very good for energies around @xmath16 , where the two spectral functions are almost indistinguishable , while the agreement becomes progressively worse for much larger ( in absolute values ) energies .",
    "in particular , the analytically continued spectral function appears broader than the exact one the further one moves away from @xmath16 .",
    "this additional broadening is an artifact of the analytic continuation , and it is caused by the limited accuracy of the so ( sec . [ sec : analytic ] ) .",
    "k ( green line ) . , scaledwidth=40.0% ]     and at @xmath357 k. the noise is a well - know drawback of the so method@xcite . in principle",
    ", it can be greatly reduced by averaging the results of many independent optimizations for the same data set , in practice however it can not be completely removed .",
    "the presented results are obtained by averaging over 250 independent runs.,scaledwidth=43.0% ]     ev and at several different temperatures , @xmath71 .",
    "the inset shows a zoom for the @xmath358 ev - range around the fermi energy .",
    ", scaledwidth=43.0% ]      the ctqmc impurity occupation @xmath359 and squared local magnetic moment @xmath360 for several @xmath133-values at @xmath357 k are presented in fig .",
    "[ fig.n_m ] .",
    "we remark that @xmath361 and not @xmath362 is the appropriate quantity to look at in the analysis of the magnetization for the ctqmc results , since the occupation for spin up and down is equal in absence of any zeeman - like term in the hamiltonian , even in the local moment regime .",
    "this shows that the exact ctqmc solution does not have the unphysical symmetry breaking found for the dft and mean field solutions .",
    "the ctqmc @xmath360 gradually increases as function of @xmath133 , and there is no evidence of an abrupt magnetic transition at @xmath363 ev . nevertheless , when mean - field predicts a stable local magnetic moment for @xmath364 ev , the ctqmc @xmath360 is smaller than the corresponding mean - field value , while @xmath365 is slightly larger . in this region of parameters",
    "the effect of electron correlation is therefore to favor the ai double occupancy compared to the mean - field picture , so that the magnetic moment is partly quenched .",
    "this is a typical behavior expected for a kondo system . for large @xmath133 , after the transition from the kondo screened to the local magnetic moment regime , the mean - field and the ctqmc @xmath366 converge to the same value , and @xmath367 approaches the half - filling limit .",
    "+ important insights into the dominant physics at different energy scales are provided by the ai spectral function @xmath368 . in fig .",
    "[ fig.spectral_u ] we observe that the lorentzian peak found for @xmath345 ev gradually shrinks into a narrow and sharp peak for increasing values of @xmath133 , thus forming the kondo resonance centered around @xmath16 . at the same time , two broad satellite peaks , separated approximately by @xmath133 , develop , and they correspond to the somo and sumo states found in the dft+negf and in the mean - field dos .",
    "note that , unlike in the mean - field case of fig",
    ".  [ fig.dos ] , here the somo and sumo are not formed by breaking the spin - symmetry through an unequal spin - occupation .",
    "furthermore , they are much broader . even though the broadening is partly an artifact caused by the analytic continuation ( see sec .",
    "[ sec_mf ] ) , we can still appreciate the real intrinsic broadening due to electron - electron interaction by comparing fig .",
    "[ fig.spectral_u ] to fig .",
    "[ fig.amf ] . + in fig .",
    "[ fig.spectral_t ] the spectral function is plotted at fixed @xmath369 ev , but at different temperatures , ranging from @xmath370 k to @xmath371 k. the somo and sumo - related peaks do not change significantly as function of @xmath71 within the stochastic and numerical precision of the results , since @xmath133 is constant .",
    "the kondo peak on the other hand progressively shrinks with increasing @xmath71 , in analogy to what has been reported in experiments .",
    "we note that the energy scale for the kondo effect is set by the ratio between @xmath133 and the electronic coupling of the molecule to the substrate @xmath298 ( see below ) .",
    "therefore , for a fixed @xmath298 , increasing @xmath71 at fixed @xmath133 has the analogous effect on the kondo feature as fixing @xmath71 and increasing @xmath133 .",
    "+ the quality of the computed spectral function at @xmath372 can be checked by means of the generalized friedel sum rule@xcite @xmath373 we remind that in this work we set @xmath372 to @xmath374 as explained in subsection [ sec : negf_setup ] .",
    "although in principle the generalized friedel sum rule is valid only at @xmath375 k , we find that it is satisfied within @xmath376 whenever the temperature is low enough that the system can be considered deep in the kondo regime .",
    "this turns out to be the case for @xmath377 ev at @xmath357 k. deviations for larger @xmath133 are mostly due to the finite temperature , since the system gets closer to its kondo temperature ( see below ) .",
    "+ we have also assessed the large energy behaviour of the spectral functions by computing their moments . the normalization condition defined in eq .",
    "( [ normalization ] ) fixes the value of the zero moment , and is enforced in the analytic continuation ( sec .",
    "[ sec : analyticcont ] ) .",
    "the sum rule involving the first moment@xcite @xmath378 is fulfilled within @xmath379 to @xmath380 for every considered value of @xmath133 and @xmath71 [ @xmath381 is the contribution to the on - site energy deriving from the double - counting correction in eq .",
    "( [ hdc ] ) ] .",
    "much larger errors are found for higher moments .",
    "overall these results and the verification of the generalized friedel sum rule confirm the observations in the previous sub - section about the expected accuracy of the computed spectral functions at different energies .",
    "while the accuracy is good for energies around @xmath16 , there is a loss of accuracy at high energies , reflected by the error in the moments beyond the first . + in order to quantitatively relate our simulations to the experiment@xcite we compute the kondo temperature @xmath0 .",
    "this is defined as@xcite @xmath382 where @xmath383 is the quasiparticle weight , also known as the quasiparticle mass - renormalization factor , @xmath384^{-1}.\\label{z_real}\\ ] ] since ctqmc simulations yield the self - energy at the matsubara frequencies , @xmath383 is approximated in the discrete form@xcite @xmath385^{-1}.\\label{z_mats}\\ ] ] with @xmath386 .",
    "we note that the definition of @xmath0 in eq .",
    "[ t_k1 ] was originally derived for the symmetric aim in the kondo limit , where the occupation is @xmath387 , and where the charge susceptibility is zero and the magnetic susceptibility becomes equal to that of the @xmath388 model , also called kondo model , with @xmath389 for @xmath390@xcite . despite that ,",
    "in recent works@xcite it has been employed to study general aims with the parameters obtained from dft , and it was shown able to provide reliable estimates of @xmath0 , so that its use has become justified in practice . moreover , in our case the symmetric aim is a good approximation to the studied aim , since the investigated system is close to half - filling and its hybridization function appears rather featureless over a wide energy range around the fermi energy ( fig .  [ fig.delta ] ) .    in experiments@xcite @xmath0",
    "is extracted from the measurement of the full width at half maximum of the kondo peak , @xmath391 , as a function of temperature by means of the approximate relation@xcite @xmath392 therefore , additionally to eq .",
    "[ t_k1 ] , we have also considered this equation , with @xmath71 equal to our simulation temperature , and @xmath393 as the kondo - peak width of the spectral functions in fig .",
    "[ fig.spectral_u ] . +     for @xmath357 k. the ctqmc results obtained with eqs .",
    "( [ t_k1 ] ) ( blue circles ) and ( [ t_k2 ] ) ( orange squares ) are compared to the experimental value ( horizontal green dashed line ) .",
    "the black curve represents the fit of the ctqmc data from eq .",
    "( [ t_k1 ] ) in the range of @xmath377 by using the model eq .",
    "( [ gamma_u_t_asym ] ) for the asymmetric siam ( with @xmath394 ) .",
    "this fit allows the extrapolation of the calculated @xmath0 to larger @xmath133 . for comparison",
    ", the pink dash - dotted line shows the expected @xmath0 for the symmetric siam ( @xmath395).,scaledwidth=45.0% ]    the estimated @xmath0 as a function of @xmath133 for simulations at @xmath357 k is plotted in fig .",
    "[ fig.kondo_t ] on a logarithmic scale .",
    "the results obtained by using the two alternative definitions in eqs .",
    "( [ t_k1 ] ) and  ( [ t_k2 ] ) are in good agreement , showing that both methods are largely equivalent for the evaluation of @xmath0 .",
    "note that the numerical and stochastic precision of the computed @xmath383 , and consequently of @xmath0 through eq .",
    "[ t_k1 ] , degrade for @xmath133 larger than 2 ev as @xmath383 becomes small , although its error bar stays of the order of 0.1 . in this case",
    "the system is approaching the transition point between the kondo and the local moment regime , where @xmath383 is not a well - defined quantity anymore .",
    "a precise evaluation of the kondo temperature via eq .",
    "[ t_k1 ] for @xmath396 would require much lower simulation temperatures than @xmath357 k , where the system would be deep in the kondo regime , but these simulations turned out too computationally demanding .",
    "the results can then be compared to the kondo temperature for the asymmetric siam , given by ( see page 168 in ref .  [ ] ) @xmath397 which is valid for @xmath398 .",
    "here @xmath399 , and @xmath400 is the on - site energy of the impurity .",
    "the asymmetric siam reduces to the symmetric siam for @xmath395 .",
    "[ gamma_u_t_asym ] shows that for large @xmath133 the value of @xmath0 decreases exponentially with @xmath133 . in our calculations",
    "@xmath400 is used a parameter that is obtained by fitting with eq .",
    "[ gamma_u_t_asym ] the @xmath0 , which is calculated via eq .",
    "( [ t_k1 ] ) in fig .",
    "[ fig.kondo_t ] , for small @xmath133 ( @xmath401 ev ) .",
    "we then obtain @xmath394 .",
    "this value deviates from the symmetric value @xmath395 because , as we pointed out above , there is a small substrate - to - molecule charge - transfer .",
    "the fitted @xmath400 approximately agrees with @xmath402 ( @xmath403 for @xmath401 ) , and accordingly also to the position of the somo peak with respect to @xmath16 in the spectral functions in figs .",
    "[ fig.spectral_u ] and [ fig.spectral_t ] .",
    "this agreement confirms the applicability of the model , and shows that for @xmath377 ev our dft+negf+ctqmc calculations provide reliable estimates of the kondo temperature .",
    "then , by using eq .",
    "( [ gamma_u_t_asym ] ) with the fitted @xmath400 , we can extrapolate the calculated values of @xmath0 to larger values of @xmath133 , where the @xmath0 computed directly from the ctqmc data becomes inaccurate .",
    "we note that for the special case of the symmetric siam with @xmath395 in eq .",
    "( [ gamma_u_t_asym ] ) , we obtain a steeper decay of the predicted kondo temperature as function @xmath133 than for the fitted asymmetric case ( see fig .",
    "[ fig.kondo_t ] ) .",
    "the tov / au system has an experimental @xmath0 of @xmath404 k@xcite , and the estimated value of @xmath133 that gives such @xmath0 in our calculation for the fitted asymmetric siam equation is @xmath405 ev ( fig .",
    "[ fig.kondo_t ] ) .",
    "consistently , for this @xmath133 the value of @xmath383 is calculated to be approximately zero , and the squared local magnetic moment @xmath360 approaches the mean - field value ( see fig  [ fig.n_m ] ) .",
    "the estimated @xmath133 that reproduces the experimental kondo temperature can then be compared to the somo - sumo gap obtained for the gas phase molecule ( tab .",
    "[ somo_sumo ] ) , which is computed to be @xmath317 with g@xmath292w@xmath292@pbe0 . when the molecule is put on the au surface at a height of about 3.1   ( sec .",
    "[ sec : geo ] ) , metal - induced image - charge corrections reduce the static gap@xcite . in order to estimate this static gap reduction ,",
    "a classical image - charge model can be used , with an image plane placed at 1   above the au surface @xcite . with this model the reduction of the gap results to be about 3.4 ev , which then leads to an approximate static @xmath133 for the molecule on the surface that is @xmath329 ev .",
    "this static @xmath133 corresponds to the lower limit for @xmath133 , since it implies full screening of any charge fluctuation on the molecule by the au surface .",
    "the value of @xmath405 ev that best matches experiment lies somewhat above this lower limit , but well below the upper limit of the gas phase molecule values .",
    "we explain this result by observing that , since the fluctuations responsible for the kondo physics happen on a rather fast time - scale , they will generally not be fully screened .",
    "while much effort has been dedicated to compute fully - screened @xmath133 values in both molecular and solid state systems with several alternative methods , such as constrained random phase approximation ( crpa)@xcite , constrained dft ( cdft)@xcite , screened hybrid functionals@xcite and ( self - consistent ) linear response@xcite , the intermediate situation that we suggest here has not been analyzed yet .",
    "this represents therefore an important aspect for future theoretical studies about kondo physics .",
    "we point out that an accurate estimate of the kondo temperature is a great challenge . as seen in eq .",
    "( [ gamma_u_t_asym ] ) , the kondo temperature is an exponential function of the ratio between @xmath133 and @xmath298 .",
    "this latter quantity is determined by the molecule adsorption distance and position , which means that the quantitative modeling of kondo systems critically depends on the accuracy of the dft structural relaxation for molecules on surfaces .",
    "this in turn requires a correct description of both covalent and vdw interactions , which is an open direction of research in itself@xcite , despite notable recent advancements , such as the introduction of the pbe+vdw@xmath295 functional@xcite that we use here .",
    "the total elastic transmission in presence of many - body correlations , @xmath166 , of the system is calculated with eq .",
    "( [ eq : tre ] ) .",
    "importantly , we have verified that the same result is obtained by using the original or the projected matrices , so that the evaluation of the inverse projection of the many - body self - energy [ eq .",
    "( [ eq : sigmambinv ] ) ] is in principle not required for the calculation of the transmission .",
    "the results for the setup outlined in sec . [ sec : tdft ] , and for three different values of @xmath133 , are given in fig .",
    "[ fig : t_mb](a ) .",
    "the non - spin - polarized transmission without correlations , @xmath406 , corresponds to @xmath166 for @xmath345 , and has a broad lorentzian peak around @xmath16 .",
    "when increasing @xmath133 this peak gets narrower and becomes the kondo peak , with two broad satellite peaks separated by about @xmath133 , following the evolution of the dos in fig .",
    "[ fig.spectral_u ] .",
    "the peak below @xmath16 is less pronounced than the one above @xmath16 , which indicates an energy dependent coupling to the electrodes , and is in qualitative agreement with the results obtained using a scissor operator ( fig .",
    "[ fig : t_dft ] ) . the breakdown of @xmath166 into its components , as derived in sec .",
    "[ sec : teq ] , is shown in figs .",
    "[ fig : t_mb](b - d ) . by construction the background transmission in fig .",
    "[ fig : t_mb](b ) [ eq .",
    "( [ eq : tbath ] ) ] is independent of @xmath133 , and reflects the dos and coupling of the tip to the substrate mediated by non - interacting states of the molecule . for the considered values of @xmath133 the transmission of the ai itself , defined in eq .",
    "( [ eq : tai2 ] ) and shown in fig .",
    "[ fig : t_mb](d ) , decays to zero for energies @xmath344 ev below and above @xmath16 , where the ai dos vanishes ( fig .",
    "[ fig.spectral_u ] ) .",
    "the interference terms are shown in fig .",
    "[ fig : t_mb](c ) [ eq .",
    "( [ eq : tinterference ] ) ] , and are rather small , so that in this case @xmath166 largely corresponds to the sum of @xmath407 and @xmath408 . in general however @xmath409 can be large and lead to a change of shape of the kondo peak from a symmetric lorentzian - type to an asymmetric fano - type , and our method allows to evaluate the contributions individually .",
    "for the contribution of the ai we evaluate also the total transmission including incoherent components , @xmath410 , and the results are shown in fig .",
    "[ fig : t_mb](d ) . qualitatively @xmath410 and @xmath408 are similar , but @xmath408 becomes significantly smaller than @xmath410 as @xmath133 increases , since it neglects incoherent components of the electron transport .",
    "note that at zero temperature the many - body self - energy at @xmath16 vanishes in the kondo regime , so that one should have @xmath411 and @xmath412 .",
    "however , at finite temperature the many - body self - energy is small , but not exactly 0 , which results in the kondo transmission peak shrinking when compared to the non - interacting case and to @xmath413 for @xmath414",
    ".    we can now evaluate how the transmission depends on the tip shape .",
    "since the tip - molecule coupling is rather weak at our considered tip height , we can assume that the tip does not significantly influence the electron correlation effects in the molecule , so that we use the same many - body self - energy for the different tip shapes . to evaluate the transmission for a blunt tip , we remove the single - tip au atom , so that we have a tip with 3 au atoms in the bottom - most plane closest to the molecule .",
    "we then shift the height of these atoms from the molecule to be equal to the one of the single - atom tip considered in fig .",
    "[ fig : t_mb ] .",
    "the comparison of the transmission for the two tip shapes , and for @xmath415 ev , is shown in fig .",
    "[ fig : t_mb_bt ] .",
    "the main difference is that the 3-atom tip has a stronger coupling to the molecule , which increases all contributions to the transmission .",
    "the background transmission becomes less featured , since the increased dos around @xmath16 for the 1-atom tip is generally broadened for a 3-atom tip @xcite . with the used value of @xmath415 ev , which is close to the value obtained by comparing the kondo temperature to experiment , our transport results are in good agreement with experimental conductance measurements in ref .",
    "@xcite , which show a kondo resonance at small bias on top of a background conductance , which is approximately constant in the considered low bias range . in general the relative height of background transmission to kondo peak depends on tip shape , size and position , and can therefore be one of the tools to infer a nanoscale junction geometry .",
    "we have presented a rigorous way to extract an effective aim from dft+negf calculations for molecules adsorbed on a substrate .",
    "this effective aim is then solved at finite - temperature with our implementation of ctqmc . with the developed method we can describe the linear - response conductance of systems in the kondo regime , and evaluate the separate contributions to the overall conductance originating from the transmission through the molecule itself , from the background transmission , and from interference terms . furthermore , for the siam we can compare the elastic contributions to the total conductance including incoherent effects .",
    "the results for the specific case of the tov radical adsorbed on au demonstrate that the method can potentially return accurate values for the kondo temperature , provided that dft gives reliable adsorption geometries , and that one can estimate the value of @xmath133 for the effective electron - electron interaction .",
    "we propose that a partially screened @xmath133 has to be considered to describe the kondo physics for such molecules on metallic surfaces . +",
    "our results show that the developed method is a promising tool to evaluate the linear - response conductive properties of strongly correlated nanoscale systems .",
    "we note that the extension beyond linear response to finite - bias problems is in principle straightforward , and the current can be calculated as outlined in sec .",
    "[ sec : teq ] .",
    "the main developments required for such finite bias calculations are accurate and computationally efficient solvers for the out - of - equilibrium aim in the steady - state .",
    "such developments are still an open research direction , and important progresses have been recently made@xcite .",
    "the authors are grateful to l. chioncel , a.r .",
    "rocha and s. kurth for useful discussions .",
    "a.d thanks i. de marco for some interactions about the problem of the analytic continuation .",
    "the work was sponsored by the european union through the project 618082 acmol .",
    "ad received additional support from the `` ministerio de economia y competitividad '' ( mineco ) of spain .",
    "as first step in the projection scheme we introduce a new basis set @xmath416 , which is identical to the original set of @xmath417 , with the exception that the @xmath19 basis orbitals , which have largest overlap with the set @xmath418 are replaced with the corresponding @xmath41 of the ai .",
    "note that by construction the replaced basis orbitals are always part of the ir , since @xmath41 has non - zero elements only within ir basis orbitals .",
    "this transformation is achieved with the projection matrix @xmath419 the matrix @xmath420 has the dimension @xmath87 , and is an identity matrix with the @xmath19 columns removed , which correspond to the ones of the replaced basis functions .",
    "we collect all the unity vectors removed when forming @xmath420 into a @xmath45 matrix @xmath421 , so that @xmath422 and @xmath423 .",
    "the overlap and hamiltonian matrices in the new basis , @xmath424 and @xmath425 , are then obtained as @xmath426 the general structure of the resulting @xmath424 is @xmath427 where @xmath428 is a @xmath85 matrix , @xmath429 is an @xmath430 matrix , and the dimensions of the off - diagonal blocks are determined from the ones of the diagonal blocks .",
    "importantly , the sub - blocks for the overlap between the ai and the @xmath184 and @xmath185 subsystem are 0 , since the er is chosen to be large enough to guarantee this by construction .",
    "the basis functions of the ai are generally not orthogonal to the other er orbitals , so that @xmath432 . if the anderson impurity solver can deal with such non - orthogonal systems , then one can pass this matrix directly to such a solver .",
    "most ai solvers however require orthogonality between the ai and all other orbitals in the system .",
    "we therefore perform a second transformation , which orthogonalizes all the orbitals to the ones of the ai .",
    "importantly , we require such transformation to keep the orbitals of the ai , and of the @xmath184 and @xmath185 regions , unchanged",
    ". one can achieve this with the following transformation matrix : @xmath433 with @xmath434 this leads to the transformed hamiltonian , @xmath435 , and overlap , @xmath436 , matrices .",
    "@xmath437 has the new structure @xmath438 with @xmath439 we therefore now have the ai orthogonal to all bath basis orbitals .    as a further optional step we can diagonalize @xmath428 and @xmath440 . to this aim",
    "we first orthogonalize the orbitals in the ai via a lwdin transformation by calculating the square root of the inverse of the ai overlap matrix , @xmath441 , and then obtain the eigenvalues and the matrix of all eigenvectors , @xmath442 , of the resulting eigenvalue system @xmath443 . here",
    "@xmath442 is a @xmath85 matrix , with each column equal to an eigenvector of the eigenvalues system , and @xmath444 is a @xmath85 diagonal matrix , where the diagonal elements are the corresponding eigenvalues . the resulting transformation matrix to the new basis acts only on the orbitals of the ai , and is @xmath445 with @xmath446 the transformed matrices are @xmath447 , and @xmath448 , and keep the non - zero structure of @xmath449 and @xmath437 , except that the top - left @xmath85 elements become diagonal matrices .",
    "the total transformation matrix , @xmath72 , then is @xmath450 which when multiplied out gives the result in eq .",
    "( [ eq : wshort ] ) , repeated in the following for convenience @xmath451 here we have introduced @xmath452 with @xmath453      in this section we evaluate the inverse of @xmath72 [ eq .",
    "( [ eq : wshort ] ) ] . by using eq .",
    "( [ eq : w123 ] ) we obtain its general form as @xmath454 the inverse of @xmath455 is @xmath456 where @xmath457 is a @xmath458 matrix , and @xmath459 is a @xmath103 matrix .",
    "they are obtained by evaluating @xmath460 if we recollect that all the unity vectors removed when forming @xmath420 are combined into a matrix @xmath421 ( @xmath461 ) , then we can give analytic expressions for @xmath457 and @xmath459 as @xmath462 note that since for large systems the matrices @xmath420 and @xmath421 consist mainly of zeroes , and the matrix @xmath463 is only of dimensions @xmath464 , the calculation of the non - zero elements of @xmath465 by using eq .",
    "( [ eq : abu ] ) is a fast order(@xmath11 ) operation .",
    "we write the dense @xmath471 matrix @xmath472 in the block matrix form analogous to the one of the overlap matrix [ eq .",
    "( [ eq : ssmall ] ) ] as @xmath473 by using eqs .",
    "( [ eq : gtran ] ) and ( [ eq : winvsimple ] ) we obtain the following expression for the green s function projected on the ai : @xmath474 which is an equivalent expression to the one given in eq .",
    "( [ eq : gbar2 ] ) . if the task is to calculate @xmath475 , one can therefore also first use eq .",
    "( [ eq : gbar1 ] ) to obtain @xmath476 , and then eq . ( [ eq : gbar2 ] )",
    "to evaluate @xmath475 as @xmath477 however , especially for large @xmath59 , this indirect way of obtaining @xmath478 is significantly less accurate than the direct way through eq .",
    "( [ eq : bardelta2 ] ) .",
    "the reason is that for large @xmath59 the quantities @xmath59 and @xmath479 in eq .",
    "( [ eq : bardelta1 ] ) are both very large , while the resulting difference is small , with a leading term proportional to @xmath480 ( see sec .",
    "[ sec : appendixlimitdelta ] ) . in a practical calculation",
    "we therefore always use eq .",
    "( [ eq : bardelta2 ] ) to calculate @xmath481 .      by means of eq .",
    "( [ eq : bardelta2 ] ) we can evaluate the limit of @xmath481 as @xmath59 goes to infinity . in eq .",
    "( [ eq : bardelta2 ] ) @xmath481 is given by a multiplication between energy independent matrices , @xmath482 and @xmath483 , with the energy dependent matrix @xmath484 .",
    "we therefore need to evaluate the asymptotic limit of @xmath484 , defined in eq .",
    "( [ eq : bargb ] ) , for large @xmath59 .    to this aim",
    "we first evaluate the limit for large @xmath59 of @xmath60 and @xmath61 .",
    "the left self - energy satisfies the following recursive relation@xcite @xmath485 where @xmath486 ( @xmath487 ) is the left lead s onsite overlap ( hamiltonian ) matrix , and @xmath488 ( @xmath489 ) is the left lead s coupling overlap ( hamiltonian ) matrix between nearest neighbor cells .",
    "if we expand this relation for large @xmath59 , we can see that there is a dominant term proportional to @xmath59 , a constant term , plus terms proportional to @xmath480 and smaller . for large",
    "@xmath59 we can therefore write @xmath490 with @xmath491 and @xmath492 constant matrices to be evaluated . if we insert this relation in eq .",
    "( [ eq : senerecursive ] ) and evaluate it for large energies , we obtain the recursive relation @xmath493 which has the analogous form of eq .",
    "( [ eq : senerecursive ] ) when the hamiltonian is set to 0 , multiplied by @xmath480 .",
    "@xmath494 can therefore be evaluated by using the standard method of ref . with the hamiltonian set to 0 , and can be interpreted as the `` self - energy '' matrix in the calculation of the inverse of the bare left semi - infinite overlap matrix .",
    "when we perform the perturbation expansion of eq .",
    "( [ eq : senerecursive])to the next lower order we obtain the following recursive relation for @xmath492 : @xmath495 since the coupling matrices @xmath489 and @xmath488 are usually small compared to the onsite terms , we can keep the result only to lowest order in these matrices , so that we can write @xmath496 however this remaining term is still of second order in the coupling matrices , so that it is usually small , and we can therefore neglect it altogether and approximate it as @xmath497 .",
    "we can perform an analogous expansion for the right self - energy , for which we can then write @xmath498 , with @xmath499 .    with this expansion for the leads self - energies , we can now expand @xmath500 in eq .",
    "( [ eq : bargb ] ) to second order in @xmath480 as @xmath501^{-1}\\nonumber\\\\ & \\approx&\\frac{1}{z } m_1 + \\frac{1}{z^2 } m_2 + o\\left(\\frac{1}{z^3}\\right ) , \\label{eq : limitsg}\\end{aligned}\\ ] ] with @xmath502 the asymptotic limit of the hybridization function for large @xmath59 can then be evaluated by inserting eq .",
    "( [ eq : limitsg ] ) into eq .",
    "( [ eq : bardelta2 ] ) .",
    "if the hamiltonian and overlap matrices are real , then also @xmath260 and @xmath503 are real . in this case , if the energy @xmath59 is purely imaginary , @xmath66 ( with @xmath504 a matsubara frequency or any other real number ) , then the leading term of the imaginary part of @xmath481 is proportional to @xmath260 and decays as @xmath505 , while the real part is proportional to @xmath503 and decays as @xmath506 . on the other hand , in the case of a very large real energy with a small imaginary part @xmath65 added , @xmath507 ,",
    "the real part of the leading term of @xmath481 is proportional to @xmath260 and decays as @xmath508 , while the leading imaginary part is also proportional to @xmath260 and decays as @xmath509 .",
    "the current flowing from the left electrode into the em , @xmath156 , is given by@xcite @xmath510.\\end{aligned}\\ ] ] the integral runs over real energies , @xmath64 , so that @xmath511 and @xmath512 are the retarded and advanced green s functions , respectively , and @xmath513 is the lesser green s function@xcite .",
    "@xmath514 is defined in eq .",
    "( [ eq : gammal ] ) .    in an analogous way the current flowing from the em into the right electrode , @xmath152 , is @xmath515 , \\label{eq : ir1}\\end{aligned}\\ ] ] where @xmath164 is the fermi dirac distribution at the chemical potential of the right electrode , and @xmath516 is defined in eq .",
    "( [ eq : gammar ] ) .    with @xmath517 defined in eq .",
    "( [ eq : gammamb ] ) , the following relation is fulfilled @xmath518\\bar{g}^{\\mathrm{mb}{\\raisebox{0.5ex}{\\footnotesize $ \\dagger$}}}(e)\\nonumber\\\\ & = & -i\\bar{g}^{\\mathrm{mb}{\\raisebox{0.5ex}{\\footnotesize $ \\dagger$}}}(e)\\left[\\bar{\\gamma}_\\mathrm{l}(e)+\\bar{\\gamma}_\\mathrm{r}(e)+\\bar{\\gamma}^\\mathrm{mb}(e)\\right]\\bar{g}^\\mathrm{mb}(e),\\nonumber\\end{aligned}\\ ] ] and the lesser gf is given by @xmath519\\bar{g}^{\\mathrm{mb}{\\raisebox{0.5ex}{\\footnotesize $ \\dagger$}}}(e ) , \\label{eq : glesser}\\end{aligned}\\ ] ] where we have introduced the occupation matrix of the ai , @xmath173@xcite . using relations ( [ eq : grelations ] ) and ( [ eq : glesser ] ) in eq .",
    "( [ eq : ir1 ] ) , one obtains the expression for the current in eqs .",
    "( [ eq : ir],[eq : ielastic],[eq : irai ] ) .    in an analogous way one obtains the current @xmath156 as sum of a component transmitted from the left electrode into the right electrode , @xmath520 , and a component flowing from left electrode into the ai , @xmath521 ,",
    "@xmath522 the value of @xmath520 can be evaluated as @xmath523 with @xmath524.\\label{eq : trel}\\end{aligned}\\ ] ]          1 .",
    "define a set of interacting orbitals , @xmath28 .",
    "2 .   determine the extensions of em , er , ir , and ai ; with this information subdivide the total @xmath14 and @xmath25 matrices according to eq .",
    "( [ eq : ssmall ] ) , and set the basic projection matrices @xmath43 , @xmath420 , and @xmath421 .",
    "3 .   calculate @xmath526 and @xmath527 .",
    "4 .   calculate @xmath441 , and with it @xmath442 by solving the eigenvalue system @xmath443 .",
    "then evaluate @xmath528 .",
    "5 .   with the stored quantities",
    "calculate @xmath529 and @xmath88 , by using eqs .",
    "( [ eq : wai ] ) and ( [ eq : wni ] ) ; with these quantities the total projection matrix , @xmath72 , is known through eq .",
    "( [ eq : wshort ] ) . 6 .",
    "the inverse projection matrix , @xmath530 , is obtained from eq .",
    "( [ eq : winvsimple ] ) . 7 .   required blocks of the transformed matrices , @xmath531 and @xmath192 , can then be calculated with the relations ( [ eq : smatexp ] ) and ( [ eq : hmatexp ] ) . 8 .",
    "the hybridization function of the ai , @xmath481 , is obtained by using eq .",
    "( [ eq : bardelta2 ] ) , and its green s function is obtained from eq .",
    "( [ eq : gbar2 ] ) if needed",
    "optionally , the asymptotic limits of @xmath481 for large energies are obtained from eqs .",
    "( [ eq : limitsg][eq : m2 ] ) and eq .",
    "( [ eq : bardelta2 ] ) . 10 .",
    "once the many - body self - energy of the ai , @xmath532 , is calculated , its inverse projection is obtained by using eq .",
    "( [ eq : sigmambinv ] ) ; this then allows to evaluate the full interacting gf , @xmath533 , of the em in the original basis by using eq .",
    "( [ eq : gmb ] ) .",
    "note however that to evaluate the transmission this inverse projection is not required .",
    "j.j.parks , a.r .",
    "champagne , t.a .",
    "costi , w.w .",
    "shum , a.n .",
    "pasupathy , e.  neuscamman , s.  flores - torres , p.s .",
    "cornaglia , a.a .",
    "aligia , c.a .",
    "balseiro , g.k .- l .",
    "chan , h.d .",
    "abruna , d.c .",
    "ralph , science * 328 * , 1370 ( 2010 ) .",
    "j.  ferrer , c.j .",
    "lambert , v.  m garcia - suarez , d.zs .",
    "manrique , d.  visontai , l.  oroszlany , r.  rodriguez - ferradas , i.  grace , s.w.d .",
    "bailey , k.  gillemot , hatef sadeghi and l.a .",
    "algharagholy , new j. phys .",
    "* 16 * , 093029 ( 2014 ) .                                                                                                                                                                                                                                                    n.  blmer in _ the lda+dmft approach to strongly correlated materials _ , edited by e.  pavarini , e.  koch , d.  vollhardt and a.  lichtenstein , reihe modeling and simulation , vol . 1 ( verlag des forschungszentrum jlich , 2011 ) , open access at http://www.cond - mat.de / events / correl11/manuscripts/."
  ],
  "abstract_text": [
    "<S> we present a computational method to quantitatively describe the linear - response conductance of nanoscale devices in the kondo regime . </S>",
    "<S> this method relies on a projection scheme to extract an anderson impurity model from the results of density functional theory and non - equilibrium green s functions calculations . </S>",
    "<S> the anderson impurity model is then solved by continuous time quantum monte carlo . </S>",
    "<S> the developed formalism allows us to separate the different contributions to the transport , including coherent or non - coherent transport channels , and also the quantum interference between impurity and background transmission . </S>",
    "<S> we apply the method to a scanning tunneling microscope setup for the 1,3,5-triphenyl-6-oxoverdazyl ( tov ) stable radical molecule adsorbed on gold . </S>",
    "<S> the tov molecule has one unpaired electron , which when brought in contact with metal electrodes behaves like a prototypical single anderson impurity . </S>",
    "<S> we evaluate the kondo temperature , the finite temperature spectral function and transport properties , finding good agreement with published experimental results . </S>"
  ]
}