{
  "article_text": [
    "solutions of the hydrodynamical riemann problem were introduced to the numerical hydrodynamics by godunov already in 1959 @xcite . after 50 years their significance is hard to be overestimated . especially in the numerical relativistic hydrodynamics , most of the so - called high resolution shock capturing schemes is based on the modifications of the original godunov idea ( for a good review on this issue see @xcite ) .    in general , by a riemann problem for a set of hyperbolic partial differential equations we understand an initial value formulation , where the initial data consist of two constant states separated by a discontinuity in the form of a plane surface . an elementary introduction and some theorems on such a general case can be found in @xcite . since in his original paper riemann was concerned with equations of motion of the inviscid fluid , it is also customary to refer to the riemann problem as a problem in hydrodynamics @xcite .",
    "the special case of the relativistic riemann problem , where the gas in both initial states is assumed to be at rest with respect to a chosen inertial frame , was first considered by thompson in @xcite . the general riemann problem with arbitrary velocities ,",
    "but in one dimension only , was solved by smoller and temple @xcite for the ultra - relativistic equation of state and by mart and mller @xcite for the perfect gas equation of state .",
    "the latter work was generalized to the case of arbitrary initial velocities , also tangent to the initial discontinuity , by pons , mart and mller in @xcite .    at this point",
    "the relativistic hydrodynamics differ strongly from its newtonian counterpart .",
    "the solution of the newtonian riemann problem is independent of the velocities tangent to the initial discontinuity and the whole problem can be treated in just one spatial dimension . in the relativistic case",
    "all components of the velocity couple to other hydrodynamic quantities through lorentz factors , and even the wave pattern of the solution can depend on the tangent velocity .",
    "a solution analogous to that of pons , mart and mller has recently been obtained for ultra - relativistic equation of state by pitka and the author in @xcite . due to the simplicity of the ultra - relativistic equation of state",
    ", this solution can be expressed almost entirely in analytical terms , and as such it can be used both to construct and test modern multidimensional numerical codes solving equations of hydrodynamics .",
    "our original motivation for dealing with solutions of the riemann problem was to construct a numerical scheme that could be used in simulations of cosmological hydrodynamical perturbations in the radiation - dominated universe .",
    "it is however worth pointing out that the issue is not only numerical .",
    "recently , aloy and rezzolla used a solution of the riemann problem with non - vanishing tangential velocities discussed in @xcite to explain a purely hydrodynamical mechanism boosting astrophysical relativistic jets to large lorentz factors @xcite .    the ultra - relativistic equation of state , commonly used in cosmology , has the form @xmath0 , where @xmath1 is the pressure , @xmath2 the energy density , and @xmath3 is a proportionality constant ( @xmath4 can be interpreted as the local sound velocity ) . on the other hand ,",
    "most numerical codes are adjusted to equations of state depending explicitly on the baryonic ( rest - mass ) density @xmath5 and the specific internal energy @xmath6 ( satisfying @xmath7 ) .",
    "this is , for instance , the case of the standard perfect gas equation of state of the form @xmath8 , where @xmath9 is a constant .",
    "although the ultra - relativistic equation of state can be viewed as a limit of the perfect gas equation of state with @xmath10 , @xmath11 and @xmath12 , a numerical code has to be rewritten in order to evolve a fluid with the ultra - relativistic equation of state .    in this paper",
    "we will summarize the analysis given in @xcite , and then describe the construction of a 3-dimensional relativistic hydrodynamical code with the ultra - relativistic equation of state .",
    "we will also show the results of tests of this code against the presented exact solution .",
    "equations expressing the conservation of the energy and momentum in the relativistic hydrodynamics can be written as @xmath13 where @xmath14 is the energy - momentum tensor of the perfect fluid . in this formula",
    "@xmath2 denotes the energy density , @xmath1 is the pressure , @xmath15 are the components of the four - velocity of the fluid , and @xmath16 is the metric tensor of the minkowski space - time while latin ones are reserved for spatial dimensions only @xmath17 . ] .    for barotropic equations of state of the form @xmath18",
    "the above equations constitute a complete set of relevant equations of hydrodynamics .",
    "however , if the equation of state depends explicitly on the rest - mass density @xmath5 ( which is the case for the perfect gas equation of state ) we also have to take into account the continuity equation , i.e. , @xmath19 thus , the set of the equations of hydrodynamics is different for those two cases , and this difference becomes especially important if we allow for discontinuous solutions . in the following we will restrict our attention to the ultra - relativistic equation of state of the form @xmath0 .",
    "since we aim at solving the general riemann problem , it is convenient to express equations ( [ energy_momentum_cons ] ) in the form @xmath20 where @xmath21 and @xmath22 here @xmath23 denotes the lorentz factor @xmath24 , and @xmath25 are the components of the three - velocity @xmath26 ( note that @xmath27 ) .",
    "we will now search for the solutions of the riemann problem for equations ( [ energy_momentum_cons ] ) . without loss of generality",
    ", we can assume that the initial discontinuity is perpendicular to the @xmath28 axis , and it is located at @xmath29 .",
    "thus , due to the translational symmetry of the initial data in the directions @xmath30 and @xmath31 , equations ( [ energy_momentum_cons ] ) can be reduced to @xmath32    the structure of solutions of the riemann problem for the set of equations ( [ set ] ) is similar to that obtained in the newtonian case . in general , the initial discontinuity can decay into three kinds of elementary waves ( not all of them have to be present in the solution ) propagating along the @xmath28 direction and separated by some constant states .",
    "one of those waves , the so - called rarefaction wave , is a smooth self - similar solution of ( [ set ] ) .",
    "the other are two discontinuities : a shock wave and a contact discontinuity .",
    "the distinction between them is based on the behavior of the pressure @xmath1 and velocity @xmath33 , which can be discontinuous at a shock wave and have to be equal on both sides of a contact discontinuity .",
    "in fact , the only quantities that can exhibit a jump at the contact discontinuity in the case of the ultra - relativistic equation of state are @xmath34 and @xmath35 .    denoting the riemann states , that is the initial data for @xmath36 and @xmath37 by @xmath38 and @xmath39 respectively , we can symbolically write the solution of the riemann problem as @xmath40 . here",
    "the subscript arrows refer to the direction from which the particles of the fluid enter the wave @xmath41 , which , in turn , can be either a rarefaction wave @xmath42 or a shock wave @xmath43 ( four different wave patterns corresponding to @xmath44 are possible ) .",
    "the symbol @xmath45 denotes a possible contact discontinuity and @xmath46 , @xmath47 are some intermediate constant states",
    ".    the exact form of the solution can be found by considering the dependence of the energy density @xmath2 on the velocity @xmath33 behind the waves @xmath48 and @xmath49 .",
    "( the exact form of this function depends on the states @xmath38 and @xmath39 in front of the waves . ) since at the contact discontinuity only @xmath34 and @xmath35 can be discontinuous , we must have @xmath50 .",
    "it turns out that the solution of this equation allows us to establish the solution in the intermediate states @xmath46 and @xmath47 , and the precise form of @xmath51 . in the forthcoming sections we will derive the required relations @xmath52 for both rarefaction and shock waves .",
    "let us consider a rarefaction wave , that is a smooth solution of ( [ set ] ) depending on @xmath28 and @xmath53 through @xmath54 .",
    "under such an assumption the equations ( [ set ] ) can be reduced to @xmath55    non - trivial solutions to the above homogeneous set of ordinary equations exist only if the wronskian of the whole system vanishes , i.e. , when @xmath56 are the eigenvalues of the jacobian @xmath57 .",
    "these eigenvalues can be computed yielding @xmath58 where the eigenvalue @xmath59 is twofold degenerate @xcite . in the special case with @xmath60 , the eigenvalues @xmath61",
    "can be expressed as @xmath62 where @xmath4 can clearly be identified with the local speed of sound ( in the linearized picture the eigenvalues of @xmath57 can be interpreted as the speeds of propagation of acoustic signals )",
    ".    it can be shown next that for @xmath63 one have @xmath64 where @xmath65 . an assumption that @xmath66 leads us to the contact discontinuity , which will be discussed later . introducing the tangential velocity @xmath67",
    ", we can show that @xmath68 , where @xmath69 denotes a constant .    at this stage equations ( [ set2 ] ) can be integrated . for @xmath70 ( no tangential velocities )",
    "one obtains @xmath71 while for non - zero tangential velocities we get @xmath72 where @xmath73 and @xmath74 are integration constants , that can be computed knowing the state in front of the wave ( for more details concerning this solution see @xcite ) .",
    "the solution in the form of a shock wave can be obtained from the appropriate rankine ",
    "hugoniot conditions . for the set of equations ( [ energy_momentum_cons ] ) they can be expressed as @xmath75 \\right ] n_\\mu = 0,\\ ] ] where @xmath76 is the unit vector normal to the surface of discontinuity .",
    "the symbol @xmath77 $ ] is used to denote the difference between the limits of a given function at both sides of the discontinuity .",
    "as we are primarily interested in establishing the state behind the shock wave basing on the known state in front of it , we assume a notation in which the value of a given quantity in front of the shock wave is denoted with a dash , while an unaltered symbol is reserved for the value behind the discontinuity . in this notation a jump of a given quantity @xmath78 is denoted as @xmath79 = f - \\bar f$ ] ( a similar convention was adopted in @xcite ) .    for the discontinuity surface being a plane perpendicular to the @xmath28 axis",
    ", the components of the normal vector @xmath76 can be written as @xmath80 , where @xmath81 . here",
    "@xmath82 has the interpretation of the shock wave velocity .",
    "the rankine ",
    "hugoniot conditions can be now written as @xmath83 \\right ] v_s & = & \\left [ \\left [ \\rho w^2 v^x \\right ] \\right ] ,   \\\\ \\left [ \\left [ \\rho w^2 v^x \\right ] \\right ] v_s            & = & \\left [ \\left [ \\rho w^2 ( v^x)^2 + \\kappa \\rho \\right ] \\right ] ,   \\\\ \\left [ \\left [ \\rho w^2 v^y \\right ] \\right ] v_s            & = &   \\left [ \\left [ \\rho w^2 v^x v^y \\right ] \\right ] ,   \\\\ \\left [ \\left [ \\rho w^2 v^z \\right ] \\right ] v_s            & = &   \\left [ \\left [ \\rho w^2 v^x v^z \\right ] \\right ] . \\end{array}\\ ] ] for @xmath84 the only physical solution of the above algebraic set of equations is given by @xmath85 where @xmath86 .",
    "the shock wave velocity @xmath82 can be expressed as @xmath87 \\right ] / \\left [ \\left [ \\rho w^2 - \\kappa \\rho \\right ] \\right].\\ ] ]    for non - zero tangential velocities @xmath88 the speed of propagation of the shock wave can be obtained as the root of the following cubic equation @xmath89 & & \\\\ - ( \\bar v^t)^2 ( 1 - v^x v_s ) ( 1 - v_s^2 ) & = & 0.\\end{aligned}\\ ] ] the value of @xmath82 can always be computed with the help of cardano s formulae , but a newton  raphson scheme may be more efficient in numerical applications .",
    "the above equation was derived from ( [ rankine_hugoniot ] ) under the assumption that @xmath90 .",
    "the case with @xmath91 , corresponds to a contact discontinuity .",
    "having obtained a solution for @xmath82 we can express the value of the energy density behind the shock wave as @xmath92}{(v^x - v_s)(1 - v^x v_s)(1 - \\bar v^x v_s)}.\\ ] ] the solution is completed by the expression for the tangential velocity @xmath93      apart form the shock waves described above , equations ( [ rankine_hugoniot ] ) admit non - trivial solutions for which @xmath91 , that is , the discontinuity is moving with the flow of the fluid . in this case",
    "we have @xmath94 and @xmath95 .",
    "there is , however , no constraint on the tangential velocity , and it can exhibit an arbitrary jump .",
    "such a discontinuity is called a contact one .",
    "w should also note that in this respect the hydrodynamics with the ultra - relativistic equation of state differs qualitatively from that of the perfect gas equation of state .",
    "in the latter case a contact discontinuity can also be present due to the jump in the rest mass density and the specific internal energy .",
    "whether we are dealing with the rarefaction or a shock wave can be distinguished basing on the ratio of the pressure @xmath96 in front of the wave to the pressure @xmath1 behind the wave .",
    "for @xmath97 we have a rarefaction wave , while the condition @xmath98 is characteristic for a shock wave @xcite .",
    "it follows from the results presented in the preceding sections that this distinction can be translated into a condition concerning the velocity @xmath33 .",
    "let @xmath99 be the energy density behind the shock wave understood as a function of the post - shock velocity @xmath33 and given by equation ( [ post_shock_density ] ) ( here again the arrows refer to the direction from which the fluid enters the wave ) .",
    "let us also introduce a similar function for the rarefaction wave and denote it by @xmath100 .",
    "the expressions for the energy density behind an arbitrary wave @xmath101 can be now written as @xmath102 for a right moving wave , and @xmath103 for a left moving one .",
    "the symbol @xmath104 used here denotes the normal velocity in front of a wave . in order to show the influence of the tangential velocities on the solution",
    ", we depicted several of such functions on fig .",
    "[ fig_rho ] , plotting the graphs for different values of @xmath105 for both right and left - moving waves .     on the velocity @xmath33 behind the wave for the ultra - relativistic equation of state with @xmath106 .",
    "different curves refer to values of the tangential velocity @xmath105 in front of the wave equal to 0 , 0.5 , 0.8 , and 0.865 .",
    "the velocity @xmath104 in front of the wave is equal 0.5 , and the density @xmath107 was set to 1 .",
    "increasing curves correspond to the right moving waves , while decreasing ones to the left moving waves.,width=377 ]    the strategy of finding the solution of the riemann problem can be now described as follows .",
    "we consider a function @xmath108 for the state @xmath38 and @xmath109 for the state @xmath39 , where the states @xmath38 and @xmath39 represent the data in front of the waves .",
    "the intersection of the graphs of those functions gives the values of @xmath110 and @xmath111 , common for both intermediate states @xmath46 and @xmath47 , and also identifies the character of both waves ( the so - called wave pattern ) . to complete",
    "the solution one only needs to establish the velocities with which the fronts of the waves , and the tail of the rarefaction wave ( if present ) propagate .",
    "the shock wave moves with the velocity @xmath82 , which can be easily computed once the value of @xmath110 has been obtained .",
    "the velocity of the head of the rarefaction wave is given by @xmath61 ( plus for @xmath112 , minus for @xmath113 ) calculated for the suitable riemann state .",
    "the location of the tail of the rarefaction wave can be computed from the condition that the energy density in the wave should reach the value of @xmath111 .    a sample solution obtained in this way",
    "is shown on figs .",
    "[ fig_solution2 ] and [ fig_velocities ] . as the initial states for this example we chose @xmath114 , @xmath115 , @xmath116 for the left state and @xmath117 , @xmath118 , @xmath119 for the right one .",
    "the equation of state was assumed to be @xmath120 .    .",
    "the left initial state is given by @xmath114 , @xmath115 , @xmath116 and the right state by @xmath117 , @xmath118 , @xmath119 .",
    ", width=377 ]    .",
    "the solid line corresponds to the velocity @xmath88 , while the dotted one depicts @xmath33.,width=377 ]",
    "we will now describe a numerical code that has been implemented in order solve equations ( [ three_plus_one ] ) in @xmath121 dimensions .",
    "the construction of the code is similar to the one described in @xcite .",
    "the vector of conserved quantities @xmath122 given by ( [ u_def ] ) is discretized on a cartesian grid of cells and its time derivative is computed according to the following method of lines @xmath123 here indices @xmath124 , @xmath125 , @xmath126 number the cells of the grid in the directions @xmath28 , @xmath30 and @xmath31 , while @xmath127 , @xmath128 and @xmath129 are numerical fluxes at cells interfaces . with this discretization",
    "the values of @xmath130 are evolved with the standard runge ",
    "kutta method of the second order .",
    "the time step for this evolution is limited by the courant criterion , in which it is convenient to assume the speed of light @xmath131 as the upper bound for the velocity of any signals .",
    "the numerical fluxes are computed following a method developed by harten , lax and van leer @xcite ( hll method , hereafter ) and proposed for the relativistic hydrodynamics by schneider et al .",
    "@xcite . a flux between two cells characterized by the states @xmath132 and @xmath133 is given by @xmath134 where @xmath135 and @xmath136 . here",
    "@xmath137 and @xmath138 denote the eigenvalues of the jacobians @xmath139 as given by the formula ( [ eigenvalues ] ) and computed for the states @xmath132 and @xmath133 respectively .",
    "the so - called minmod reconstruction method of van leer @xcite was used to improve the spatial accuracy of the scheme . in this approach",
    "the states @xmath140 used to compute numerical fluxes are obtained as follows .",
    "we first define the `` minmod '' function @xmath141 and the slope limiters @xmath142 then the expressions for left and right states used to compute the numerical flux at the interface @xmath143 are given by @xmath144 the above formulae actually refer to the reconstruction procedure in @xmath28 direction . formulae for other directions are analogous .    the recovery of primitive variables , i.e. , obtaining the values of @xmath1 , @xmath2 , @xmath33 , @xmath34 and @xmath35 from @xmath122 is straightforward , and , unlike in simulations with the perfect gas equation of state , it does not involve a numerical solution to a nonlinear algebraic equation . in the latter case",
    "this is usually obtained using an iterative newton ",
    "raphson scheme .",
    "this fact results in a robust performance of the code for the ultra - relativistic equation of state , as compared to the standard case .",
    "we omit the exact formulae for the recovery of the primitive quantities , as they follow directly from ( [ u_def ] ) .",
    "boundary conditions are implemented by adding to the numerical domain 2 `` ghost '' zones in each direction , following the standard procedure used in numerical hydrodynamics ( see e.g. @xcite ) .",
    "the method of `` ghost '' zones is also used to split the grid into parts in the parallel message passing interface ( mpi ) implementation of the code . in this case",
    "the values of the `` ghost '' zone variables are obtained from adjacent parts of the grid .",
    "we used the exact solution presented on figs .",
    "[ fig_solution2 ] and [ fig_velocities ] to test the code . to this end",
    "we performed a couple of 2-dimensional runs , so that the tangential velocity was also evolved , reaching the time @xmath145 .",
    "we used equidistant grids of 100 , 200 , 400 , 800 and 1600 zones per unit length . in each case the courant factor was set to 0.1 .",
    "results of a run with the resolution of 800 zones per unit length are shown on figs .",
    "[ fig_num_density ] and [ fig_num_velocities ] .",
    "the data depicted on these graphs come from one @xmath146 slice of the grid .",
    "we see that the resolution of discontinuities is worse for the tangential velocities , most probably due to non - negligible numerical viscosity of the scheme .",
    "( solid line ) .",
    "the numerical solution was obtained with the spatial resolution of 800 zones per unit length.,width=377 ]     and @xmath88 ( points ) plotted over the exact curves from fig .  [ fig_velocities ] .",
    "the numerical solutions were obtained with the spatial resolution of 800 zones per unit length.,width=377 ]    table [ tab ] gives the estimates of the absolute numerical errors computed with respect to the @xmath147 norm on the interval @xmath148 $ ] .",
    "the exact solution was taken as the reference for the calculation of these errors .",
    "the linear convergence in all variables is characteristic for test problem involving strong discontinuities .",
    ".estimates of absolute errors of sample numerical runs for the riemann problem illustrated on figs .",
    "[ fig_solution2 ] and [ fig_velocities ] .",
    "the errors were computed in the @xmath147 norm on the interval @xmath148 $ ] with respect to the exact solution . [ cols=\"^,^,^,^\",options=\"header \" , ]     we should also point out that the hll riemann solver implemented in the scheme is an approximate one and it does not exploit the analytical solution presented in this chapter .",
    "thus the presented test and the implementation of the code are independent  we are not testing a given solution against itself .",
    "we have presented the exact solution of the riemann problem in the relativistic hydrodynamics with the ultra - relativistic equation of state , in which the fluid is allowed to move with arbitrary velocities , also tangent to the surface of the initial discontinuity .",
    "we have also described a 3-dimensional numerical scheme for solving relativistic equations of hydrodynamics with the ultra - relativistic equation of state .",
    "tests of the implemented code against the obtained analytic solution show satisfactory convergence and accuracy allowing to hope for future applications of the code .",
    "we are also convinced that the analytic solution discussed in this article can also be used to construct an exact riemann solver for the 3-dimensional hydrodynamic codes with the ultra - relativistic equation of state .",
    "we also believe that this solution can find its applications outside strictly numerical hydrodynamics .",
    "it was already mentioned in the beginning that a similar solution for the perfect gas equation of state can be used to explain a boosting mechanism present in relativistic jets @xcite .",
    "the required `` boosting '' property is also exhibited by solutions of this paper .",
    "this fact can be noticed , for instance , by looking at the solution from fig .",
    "[ fig_velocities ] , where the tangential velocity in the rarefaction wave reaches values much greater than any of velocities present in the initial states .",
    "godunov , _ mat .",
    "_ * 47 * , 271 ( 1959 ) j.@xmath149 mart , e. mller , _ living rev",
    ". relativity _ * 6 * , 7 , + ` http://www.livingreviews.org/lrr-2003-7 ` ( 2003 ) l.c .",
    "evans , _ partial differential equations _ , american mathematical society ( 1998 ) b. riemann , _ abhandlungen der gesellshaft der wissenshaften zu gttingen _ , mathematisch - physikalishe klasse * 8 * , 43 ( 185859 ) k.w .",
    "thompson , _",
    "j. fluid mech .",
    "_ * 171 * , 365 ( 1986 ) j. smoller , b. temple , _ commun . math . phys . _",
    "* 156 * , 67 ( 1993 ) j.@xmath149 mart , e. mller , _",
    "j. fluid mech . _ * 258 * , 317 ( 1994 ) j.a .",
    "pons , j.@xmath149 mart , e. mller , _ j. fluid mech .",
    "_ * 422 * , 125 ( 2000 ) p. mach , m. pitka , _ the exact solution of the hydrodynamical riemann problem with non - zero tangential velocities and the ultra - relativistic equation of state _ , ` http://arxiv.org/abs/0905.0349 ` ( 2009 ) , _ phys .",
    "rev . _ * e81 * , 046313 ( 2010 ) m.a .",
    "aloy , l. rezzolla , _ astrophys .",
    "j. _ * 640 * , l115 ( 2006 ) a.m. anile , g. russo , _ phys .",
    "fluids _ * 29 * , 2847 ( 1986 ) a.j .",
    "taub , _ ann .",
    "fluid mech .",
    "_ * 10 * , 301 ( 1978 ) m.a .",
    "aloy , j.@xmath149 ibez , j.@xmath149 mart , e. mller , _ astrophys . j. suppl . _ * 122 * , 151 ( 1999 ) a. harten , p.d .",
    "lax , b. van leer , _ siam rev .",
    "_ , * 25 * , 35 , ( 1983 ) . v. schneider et al .",
    ", _ j. comput .",
    "_ , * 105 * , 92 , ( 1993 ) b. van leer , _ j. comput",
    "_ , * 32 * , 101 ( 1979 ) c.b .",
    "laney , _ computational gasdynamics _ , cambridge university press , cambridge ( 1998 )"
  ],
  "abstract_text": [
    "<S> we present an analytic solution of the riemann problem for the equations of relativistic hydrodynamics with the ultra - relativistic equation of state and non - zero tangential velocities . a 3-dimensional numerical code solving such equations is described and then tested against the analytic solution .    </S>",
    "<S> pacs numbers : 47.75.+f , 47.40.nm , 47.85.-g    = by -1 </S>"
  ]
}