{
  "article_text": [
    "the enhancement and detection of elongated structures is important in many biomedical image analysis applications .",
    "these tasks become problematic when multiple elongated structures cross or touch each other in the data . in these cases",
    "it is useful to decompose an image in local orientations by constructing an orientation score . in the orientation score ,",
    "we extend the domain of the data to include orientation in order to separate the crossing or touching structures ( fig .",
    "[ fig:2dos ] ) . from 3d data",
    "@xmath2 we construct a 3d orientation score @xmath3 , in a similar way as is done for the more common case of 2d data @xmath4 and 2d orientation score @xmath5 .",
    "next , we consider operations on orientation scores , and process our data via orientation scores ( fig .",
    "[ fig : overviewoperations ] ) .",
    "for such operations it is important that the orientation score transform is invertible , in a well - posed manner . in comparison to continuous wavelet transforms on the group of 3d rotations , translations and scalings",
    ", we use all scales simultaneously and exclude the scaling group from the wavelet transform and its adjoint , yielding a coherent state type of transform @xcite , see app.a .",
    "this makes it harder to design appropriate wavelets , but has the computational advantage of only needing a single scale transformation .",
    "the 2d orientation scores have already showed their use in a variety of applications . in @xcite",
    "the orientation scores were used to perform crossing - preserving coherence - enhancing diffusions .",
    "these diffusions greatly reduce the noise in the data , while preserving the elongated crossing structures .",
    "next to these generic enhancement techniques , the orientation scores also showed their use in retinal vessel segmentation @xcite , where they were used to better handle crossing vessels in the segmentation procedure .    to perform detection and enhancement operations on the orientation score ,",
    "we first need to transform a given greyscale image or 3d dataset to an orientation score in an invertible way . in previous works",
    "various wavelets were introduced to perform a 2d orientation score transform .",
    "some of these wavelets did not allow for an invertible transformation ( e.g. gabor wavelets @xcite ) .",
    "a wavelet that allows an invertible transformation was proposed by kalitzin @xcite .",
    "a generalization of these wavelets was found by duits @xcite who derived a unitarity result and expressed the wavelets in a basis of eigenfunctions of the harmonic oscillator .",
    "this type of wavelet was also extended to 3d .",
    "this wavelet however has some unwanted properties such as poor spatial localization ( oscillations ) and the fact that the maximum of the wavelet did not lie at its center ( * ? ? ?",
    "4.11 ) . in @xcite",
    "a class of cake - wavelets were introduced , that have a cake - piece shaped form in the fourier domain ( fig .",
    "[ fig : cakewavelets ] ) .",
    "the cake - wavelets simultaneously detect oriented structures and oriented edges by constructing a complex orientation score @xmath6 .",
    "because the different cake - wavelets cover the full fourier spectrum , invertibility is guaranteed .",
    "in this paper we propose an extension of the 2d cake - wavelets to 3d .",
    "first , we discuss the theory of invertible orientation score transforms .",
    "then we construct 3d cake - wavelets and give an efficient implementation using a spherical harmonic transform .",
    "finally we mention two application areas for 3d orientation scores and show some preliminary results for both of them . in the first application",
    ", we present a practical proof of concept of a natural extension of the crossing preserving coherence enhancing diffusion on invertible orientation scores ( cedos ) @xcite to the 3d setting . compared to the original idea of coherence enhancing diffusion acting directly on image - data @xcite",
    "we have the advantage of preserving crossings .",
    "diffusions on se(3 ) have been studied in previous ssvm - articles , see e.g. @xcite , but the full generalization of cedos to 3d was never established .",
    "is correlated with an oriented filter @xmath7 to detect structures aligned with the filter orientation @xmath8 .",
    "bottom left : this is repeated for a discrete set of filters with different orientations .",
    "bottom right : the collection of 3d datasets constructed by correlation with the different filters is an orientation score and is visualized by placing a 3d dataset on a number of orientations.,title=\"fig:\",scaledwidth=60.0% ] +   is correlated with an oriented filter @xmath7 to detect structures aligned with the filter orientation @xmath8 .",
    "bottom left : this is repeated for a discrete set of filters with different orientations .",
    "bottom right : the collection of 3d datasets constructed by correlation with the different filters is an orientation score and is visualized by placing a 3d dataset on a number of orientations.,title=\"fig:\",scaledwidth=70.0% ]",
    "an invertible orientation score @xmath9:{\\mathbb{r}}^3 \\times s^2 \\rightarrow { \\mathbb{c}}$ ] is constructed from a given ball - limited 3d dataset @xmath10 , with @xmath11 by correlation @xmath12 with an anisotropic kernel @xmath13)({\\mathbf{x}},{\\mathbf{n}})=(\\overline{\\psi_{\\mathbf{n } } } \\star f)({\\mathbf{x}})=\\int_{{\\mathbb{r}}^ 3 }   \\overline { \\psi_{\\mathbf{n}}({\\mathbf{x}}'-{\\mathbf{x}})}f({\\mathbf{x}}')\\ , \\d { \\mathbf{x } } ' , \\label{eq : construction1}\\ ] ] where @xmath14 is a wavelet aligned with and rotationally symmetric around the @xmath15-axis , and @xmath16 the rotated wavelet aligned with @xmath17 . here",
    "@xmath18 is any rotation which rotates the @xmath15-axis onto @xmath17 where the specific choice of rotation does not matter because of the rotational symmetry of @xmath19 .",
    "the overline denotes a complex conjugate .",
    "the exact reconstruction formula for this transformation is @xmath20)({\\mathbf{x } } ) \\\\ & = \\mathcal{f}_{{\\mathbb{r}}^3}^{-1 } \\left [ m_\\psi^{-1 }   \\mathcal{f}_{{\\mathbb{r}}^3 } \\left [ \\tilde{{\\mathbf{x } } } \\mapsto \\int_{s^2 } ( \\check { \\psi}_{\\mathbf{n}}\\star { \\mathcal{w}}_\\psi[f](\\cdot,{\\mathbf{n}}))(\\tilde{{\\mathbf{x}}})\\ , \\d \\sigma({\\mathbf{n } } ) \\right ] \\right ] ( { \\mathbf{x } } ) , \\end{split } \\label{eq : reconstruction1}\\ ] ] with @xmath21 the fourier transform on @xmath22 given by @xmath23 and @xmath24 .",
    "in fact @xmath25 is a unitary mapping on to a reproducing kernel space , see app .",
    "a. the function @xmath26 is given by @xmath27({\\boldsymbol{\\omega } } ) \\right|^2 \\d \\sigma({\\mathbf{n}}).\\ ] ] the function @xmath28 quantifies the stability of the inverse transformation @xcite , since @xmath29 specifies how well frequency component @xmath30 is preserved by the cascade of construction and reconstruction when @xmath31 would not be included in eq .",
    "( [ eq : reconstruction1 ] ) .",
    "an exact reconstruction is possible as long as @xmath32 in practice it is best to aim for @xmath33 in view of the condition number of @xmath34 with @xmath35 . also , when @xmath36 we have @xmath37-norm preservation @xmath38 and eq .",
    "( [ eq : reconstruction1 ] ) simplifies to @xmath39(\\cdot,{\\mathbf{n}}))({\\mathbf{x } } ) \\d \\sigma({\\mathbf{n}})$ ] .",
    "we can further simplify the reconstruction for wavelets for which @xmath40({\\boldsymbol{\\omega } } ) \\d \\sigma({\\mathbf{n } } ) \\approx 1 $ ] , where the reconstruction formula simplifies to an integration over orientations    @xmath41      in the previous section , we considered a continuous orientation score transformation . in practice",
    ", we have only a finite number of orientations . to determine this discrete set of orientations we uniformly sample the sphere using platonic solids and/or refine this using tessellations of the platonic solids .",
    "assume we have a number @xmath42 of orientations @xmath43 , and define the discrete invertible orientation score @xmath44:{\\mathbb{r}}^3\\times { \\mathcal{v}}\\rightarrow { \\mathbb{c}}$ ] by @xmath45)({\\mathbf{x}},{\\mathbf{n}}_i)=(\\overline{\\psi_{{\\mathbf{n}}_i } } \\star f)({\\mathbf{x } } ) .",
    "\\label{eq : construction1discrete}\\ ] ] the exact reconstruction formula is in the discrete setting given by @xmath46)({\\mathbf{x } } ) \\\\ & = \\mathcal{f}_{{\\mathbb{r}}^3}^{-1 } \\left [ ( m_\\psi^d)^{-1 }   \\mathcal{f}_{{\\mathbb{r}}^3 } \\left [ \\tilde { { \\mathbf{x } } } \\rightarrow \\sum_{i=1}^{n_o } ( \\check { \\psi}_{{\\mathbf{n}}_{i } } \\star { \\mathcal{w}}_\\psi^d[f](\\cdot,{\\mathbf{n}}_i))(\\tilde { { \\mathbf{x } } } ) \\d \\sigma({\\mathbf{n}}_i ) \\right ] \\right ] ( { \\mathbf{x } } ) , \\end{split } \\label{eq : reconstruction1discrete}\\ ] ] with @xmath47 the discrete spherical area measure which for reasonably uniform spherical sampling can be approximated by @xmath48 , and @xmath49({\\boldsymbol{\\omega } } ) \\right|^2 \\d \\sigma({\\mathbf{n}}_i).\\ ] ] again , an exact reconstruction is possible iff @xmath50 .",
    "a class of 2d cake - wavelets , see @xcite , was successfully used for the 2d orientation score transformation .",
    "we now generalize these 2d cake - wavelets to 3d cake - wavelets .",
    "our 3d transformation using the 3d cake - wavelets should fulfill a set of requirements , compare @xcite :    1 .",
    "the orientation score should be constructed for a finite number ( @xmath42 ) of orientations .",
    "2 .   the transformation should be invertible and all frequencies should be transferred equally to the orientation score domain ( @xmath51 ) .",
    "3 .   the kernel should be strongly directional .",
    "4 .   the kernel should be polar separable in the fourier domain , i.e. , @xmath52 , with @xmath53 . because by definition the wavelet @xmath19 has rotational symmetry around the @xmath15-axis we have @xmath54 .",
    "5 .   the kernel should be localized in the spatial domain , since we want to pick up local oriented structures .",
    "the real part of the kernel should detect oriented structures and the imaginary part should detect oriented edges . the constructed oriented score is therefore a complex orientation score .",
    "we now discuss the procedure used to make 3d cake - wavelets . according to requirement 4",
    "we only consider polar separable wavelets in the fourier domain , so that @xmath55 . for the radial function",
    "@xmath56 we use , as in @xcite , @xmath57 which is a gaussian function with scale parameter @xmath58 multiplied by the taylor approximation of its reciprocal to order @xmath59 to ensure a slower decay .",
    "this function should go to 0 when @xmath60 tends to the nyquist frequency @xmath61 .",
    "therefore the inflection point of this function is fixed at @xmath62 with @xmath63 by setting @xmath64 . in practice",
    "we have @xmath65 , and because radial function @xmath66 causes @xmath67 to become really small when coming close to the nyquist frequency , reconstruction eq . becomes unstable .",
    "we solve this by either using approximate reconstruction eq . or by replacing @xmath68 , with @xmath69 small .",
    "both make the reconstruction stable at the cost of not completely reconstructing the highest frequencies which causes some additional blurring .",
    "we now need to find an appropriate angular part @xmath70 for the cake - wavelets .",
    "first , we specify an orientation distribution @xmath71 , which determines what orientations the wavelet should measure . to satisfy requirement 3 this function should be a localized spherical window , for which we propose a b - spline @xmath72 , with @xmath73 and @xmath74 the @xmath75th order b - spline given by @xmath76 the parameter @xmath77 determines the trade - off between requirements 2 and 3 , where higher values give a more uniform @xmath67 at the cost of less directionality .",
    "first consider setting @xmath78 so that @xmath19 has compact support within a convex cone in the fourier domain .",
    "the real part of the corresponding wavelet would however be a plate detector and not a line detector ( fig .",
    "[ fig : cakepiececreatesplatedetector ] ) .",
    "the imaginary part is already an oriented edge detector , and so we set    @xmath79    where the real part of the earlier found wavelet vanishes by anti - symmetrization of the orientation distribution @xmath80 while the imaginary part remains . as to the construction of @xmath81 , there is the general observation that we detect a structure that is perpendicular to the shape in the fourier domain , so for line detection we should aim for a plane detector in the fourier domain . to achieve this",
    "we apply the funk transform to @xmath80 , and we define @xmath82 where integration is performed over @xmath83 denoting the great circle perpendicular to @xmath84 .",
    "this transformation preserves the symmetry of @xmath80 , so we have @xmath85 .",
    "thus , we finally set @xmath86 for an overview of the transformations see fig .",
    "[ fig : cakewavelets ] .      in subsection [ ssect : cake ] we defined the real part and the imaginary part of the wavelets in terms of a given orientation distribution . in order to efficiently implement the various transformations ( e.g. funk transform ) , and to create the various rotated versions of the wavelet we express our orientation distribution @xmath80 in a spherical harmonic basis @xmath87 up to order @xmath88 : @xmath89 because of the rotational symmetry around the @xmath15-axis",
    ", we only need the spherical harmonics with @xmath90 , i.e. , @xmath91 . for determining the spherical harmonic coefficients we use the pseudo - inverse of the discretized inverse spherical harmonic transform ( see ( * ? ? ?",
    "* section 7.1 ) ) , with discrete orientations given by an icosahedron of tesselation order 15 .",
    "according to @xcite , the funk transform of a spherical harmonic equals @xmath92 with @xmath93 the legendre polynomial of degree @xmath94 evaluated at @xmath95 .",
    "we can therefore apply the funk transform to a function expressed in a spherical harmonic basis by a simple transformation of the coefficients @xmath96 .",
    "we have @xmath97 .",
    "we therefore anti - symmetrize the orientation distribution eq .",
    "( [ eq : antisymmetrize ] ) via @xmath98 .      to make the rotated versions @xmath99 of wavelet @xmath19 we have to find @xmath100 in @xmath101 . to achieve this we use the steerability of the spherical harmonic basis .",
    "spherical harmonics rotate according to the irreducible representations of the so(3 ) group @xmath102 ( wigner - d functions )    @xmath103    here @xmath104 and @xmath105 denote the euler angles with counterclockwise rotations , i.e. , @xmath106 .",
    "this gives @xmath107 because both anti - symmetrization and funk transform preserve the rotational symmetry of @xmath80 , we have @xmath108 , and eq .  ( [ eq : rotationh ] )",
    "reduces to @xmath109",
    "we now use the invertible orientation score transformation to perform data - enhancement according to fig . [",
    "fig : overviewoperations ] .",
    "because @xmath110 is not a lie group , it is common practice to embed the space of positions and orientations in the lie group of positions and rotations se(3 ) by setting @xmath111 with @xmath112 any rotation for which @xmath113 .",
    "this holds in particular for orientation scores @xmath114 .",
    "the operations @xmath115 which we consider are scale spaces on se(3 ) ( diffusions ) , and are given by @xmath116 with @xmath117 here @xmath118 is the solution of @xmath119 } , \\label{eq:}\\ ] ] where in coherence enhancing diffusion on orientation scores ( cedos ) @xmath120 is adapted locally to data @xmath121}$ ] based on exponential curve fits ( see @xcite ) , and with @xmath122 the left - invariant vector fields on se(3 ) , for motivation and details see @xcite .",
    "furthermore @xmath120 is chosen such that equivalence relation eq .",
    "is maintained for @xmath118 .",
    "these operations are already used without adaptivity in the field of diffusion weighted mri , where similar data ( of the type @xmath123 ) is enhanced @xcite .",
    "we then obtain euclidean invariant image processing via @xmath124 which includes inherent projection @xmath125 of orientation scores , even if @xmath116 maps outside of the space of orientation scores in the embedding space ( see app .",
    "[ app : appendixa ] ) .",
    "below we show some preliminary results of these flows that enhance the elongated structures while preserving the crossing , fig .",
    "[ fig : results ] and fig . [ fig : resultsadamkiewitzc ] .",
    "we use the 3d orientation scores to extend the earlier work on 2d vessel segmentation via invertible orientation scores @xcite to 3d vessel segmentation in mra - data .",
    "even though true crossing structures hardly appear in 3d data , we do encounter vessels touching other vessels / structures .",
    "the orientation scores also allow us to better handle complex structures , such as bifurcations . in fig .",
    "[ fig : resultsvesseltracking ] we show some first results of the vessel segmentation algorithm .",
    "we have extended 2d cake - wavelets to 3d cake - wavelets , which can be used for a 3d invertible orientation score transformation .",
    "efficient implementation for calculating the wavelets via spherical harmonics were introduced .",
    "the developed transformation allows us to consider all kinds of enhancement operations via orientation scores such as the adaptive crossing preserving flows which we are currently working on .",
    "next to data - enhancement we also showed some first results of 3d vessel segmentation using 3d orientation scores .",
    "we thank dr .",
    "janssen for advice on the presentation of this paper .",
    "the research leading to these results has received funding from the european research council under the european community s seventh framework programme ( fp7/2007 - 2013 ) / erc grant _ lie analysis _ , agr .",
    ".  335555 .",
    "the continuous wavelet transform constructed by unitary irreducible representations of locally compact groups was first formulated by grossman et al .",
    "@xcite . given a hilbert space @xmath126 and a unitary irreducible representation @xmath127 of any locally compact group @xmath128 in @xmath126 , a non - zero vector @xmath129",
    "is called admissible if @xmath130 where @xmath131 denotes the left - invariant haar measure .",
    "given an admissible vector @xmath19 and a unitary representation of a locally compact group @xmath128 in @xmath126 , the coherent state ( cs ) transform @xmath132 is given by @xmath133)(g)=(\\mathcal{u}_{g}\\psi , f)_h$ ] .",
    "@xmath134 is an isometric transform onto a unique closed reproducing kernel space @xmath135 with @xmath136 as an @xmath137-subspace @xcite .",
    "we distinguish between the isometric wavelet transform @xmath138 and the unitary wavelet transform @xmath139 .",
    "we drop the formal requirement of @xmath140 being square - integrable and @xmath19 being admissible in the sense of , and replace the requirement by , as it is not strictly needed in many cases .",
    "this includes our case of interest @xmath141 and its left - regular action on @xmath142 where @xmath143 gives rise to an orientation score @xmath144 @xmath145 with @xmath146 _ any _ rotation mapping @xmath147 onto @xmath148 and @xmath19 symmetric around the @xmath15-axis . here",
    "the domain is the coupled space of positions and orientations : @xmath149 , cf .",
    "@xcite .    from the general theory of reproducing kernel spaces , @xcite ( where one does not even rely on the group structure )",
    ", it follows that @xmath150 is unitary , where @xmath151 denotes the abstract complex reproducing kernel space consisting of functions on @xmath152 with reproducing kernel @xmath153 with left - regular representation @xmath154 given by @xmath155 .",
    "now , as the characterization of the inner product on @xmath156 is awkward @xcite , we provide a basic characterization next via the so - called @xmath28 inner product .",
    "this is in line with the admissibility conditions in @xcite .",
    "[ mpsirecon ] let @xmath19 be such that ( [ eq : admissibilityrequirement ] ) holds .",
    "then @xmath150 is unitary , and we have @xmath157 where @xmath158,\\mathcal{t}_{m_{\\psi}}[{\\mathcal{w}}_\\psi g])_{\\mathbb{l}_{2}({\\mathbb{r}}^3\\rtimes s^2))}$ ] , with @xmath159({\\mathbf{y}},{\\mathbf{n}}):=\\mathcal{f}^{-1}\\bigg{[}\\boldsymbol{\\omega}\\mapsto(2\\pi)^{-3/4}m_{\\psi}^{-1/2}(\\boldsymbol{\\omega})\\mathcal{f}[u ( \\cdot,{\\mathbf{n}})](\\boldsymbol{\\omega } ) \\bigg{]}({\\mathbf{y}})$ ] .",
    "let @xmath162 on @xmath22 .",
    "the space @xmath163 is a closed subspace of hilbert space @xmath164 , where @xmath165\\in\\mathbb{l}_{2}(\\mathbb{r}^3)\\}$ ] , and projection of embedding space onto the space of orientation scores is given by @xmath166 , where @xmath167 is the natural extension of the adjoint to the embedding space ."
  ],
  "abstract_text": [
    "<S> the enhancement and detection of elongated structures in noisy image data is relevant for many biomedical applications . to handle complex crossing structures in 2d images , 2d orientation scores @xmath0 were introduced , which already showed their use in a variety of applications . </S>",
    "<S> here we extend this work to 3d orientation scores @xmath1 . </S>",
    "<S> first , we construct the orientation score from a given dataset , which is achieved by an invertible coherent state type of transform . for this transformation </S>",
    "<S> we introduce 3d versions of the 2d cake - wavelets , which are complex wavelets that can simultaneously detect oriented structures and oriented edges . for efficient implementation of the different steps in the wavelet creation we use a spherical harmonic transform </S>",
    "<S> . finally , we show some first results of practical applications of 3d orientation scores .    scores , reproducing kernel spaces , 3d wavelet design , scale spaces on se(3 ) , coherence enhancing diffusion on se(3 ) </S>"
  ]
}