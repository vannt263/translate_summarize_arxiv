{
  "article_text": [
    "this paper deals with the problem of computing long - time trajectories for the euler equations of quasi - geostrophic fluids by means of volume preserving numerical methods .",
    "such equations are widely used in applications like weather and climate predictions on earth as well as for other gas planets , such as jupiter . due to the highly inhomogeneities in the atmosphere or ocean",
    ", there is a wide range of unresolved scales of motion and the system displays a seemingly chaotic behaviour . as a consequence , it is impossible to simulate particular solutions with a prescribed accuracy .",
    "the application of ideas from statistical mechanics to these geostrophic flows , on the other hand , has lead to promising predictions for the ocean , atmosphere and giant planets , in agreement with contemporary observations @xcite .",
    "the statistics are obtained by performing very long numerical simulations for some initial condition . because of the seemingly chaotic behaviour and the large number of unresolved scales , the numerical approximation produced will be far off the trajectory one was set to simulate . however , as long as the iteration map is ergodic , time averages are equal to space averages almost everywhere . if the iteration map is ergodic , the long time trajectory will visit a large number of points in the phase space with the same probability , and the time averages will converge to the spatial averages .",
    "ergodicity is equivalent to the preservation of an invariant measure ( preservation of a volume form ) .",
    "thus it makes sense to study the effect of volume preserving integrators on the long - time dynamic of such systems .",
    "our starting point will be arakawa s energy and enstrophy preserving semi - discretization @xcite , which has been shown to preserve volume in phase space @xcite .",
    "we will investigate an explicit volume preserving numerical integrator based on splitting methods .",
    "the method does not preserve exactly the underlying integrals of the semi - discretization , however it is self - adjoint and therefore expected to preserve some nearby integrals by virtue of backward error analysis . in order to construct an explicit splitting method",
    ", we will show that the @xmath0th component of the vector field does not depend on the @xmath0th variable  thus the differential equation is _ diagonal free _ in addition to be divergence free ( the latter was shown in @xcite ) .",
    "this will allow us to split the vector field in _ canonical shears _",
    ", which are volume preserving , see @xcite . to retain the right complexity , the splitting must be performed in such a way that computing one step of the explicit method does not cost more than evaluating the vector field ( @xmath1 operations , where @xmath2 is the number of variables ) , which is a tricky task due to the presence of the laplacian operator , that mixes up all the variables .",
    "this will be discussed in section  [ sec : constructionvp ] .",
    "the simplest way to implement the canonical splitting is by solving in a sequential order for the variables .",
    "however , our preliminary numerical tests showed that this yields a poor method in terms of error propagation .",
    "it is known that chessboard - like ordering of the variables can yield better error propagation for some applications ( see for instance @xcite ) .",
    "we will also propose a new ordering method ( see  [ sec : indexing ] ) that is obtained by minimizing a measure of the error of the splitting method : we identify the commuting vector fields , collect them together , and add , at each step , those that whose commutation error is minimal among the remaining one .",
    "this aggregation gives a significant improvement for the error accumulation of the numerical simulations .",
    "we perform a number of long term simulations , for the different indexing strategies and different number of variables in  [ sec : numerical ] .",
    "the conclusions of this work can be summarized as follows : for a relatively small number of discretization points , the second order explicit volume preserving numerical method gives satisfactory results when implemented with our indexing strategy , and the errors on the conserved quantities stay small over a very long integration time , yielding statistically reliable estimated parameters . however , when the number of discretization points increase , there is a deterioration of the long - time conservative properties of the methods , even with our proposed indexing strategy .",
    "thus , it might be appropriate to increase the order of the method .",
    "although it is disappointing to observe this effect of the dimensionality on the long - time conservative properties of the proposed volume preserving scheme , there is also a constructive side , as the error on the conserved quantities can be used to monitor the error on the statistical quantities of interest and hence is a measure of their reliability .",
    "we will consider one of the simplest geophysical models , a barotropic two - dimensional flow with topography on a periodic domain .",
    "the model is described by the differential equations @xmath3 where @xmath4 is the vorticity , @xmath5 is the stream function and @xmath6^t$ ] and @xmath7 is the topography .",
    "all functions are defined on a a square @xmath8\\times [ 0,2\\pi]$ ] , and we assume periodic boundary conditions . due to the commuting properties of the differential operators and the differentiation rules ,",
    "the equation can be written in the form @xmath9 where @xmath10 is any of the following equivalent formulations @xmath11 the system is hamiltonian , with poisson bracket @xmath12 and hamiltonian energy functional @xmath13 the poisson bracket is degenerate and the system possesses an infinite set of casimir invariants , of the form @xmath14 where @xmath15 is any scalar function .",
    "it is customary to consider invariants of the form @xmath16 , for @xmath17 ( vorticity moments ) .",
    "the most important are the the first moment , also referred as the _ total circulation _",
    "@xmath18 ( or total vorticity ) , and the second moment of vorticity , also called _ enstrophy _ , @xmath19 the higher moments do not seem to have much relevance in applications , except for the _ third moment _ @xmath20 which has been seen to have some relevance in the statistical analysis of the discretized flow @xcite .",
    "arakawa @xcite considered semi - discretizations of the above equations , in which the differential operators were replaced by standard central divided difference operators : @xmath21 in the discussion that follows , it is important that the operators are skew - symmetric , i.e.  @xmath22 .",
    "we consider a symmetric discrete approximation to the laplacian , @xmath23 , and , for the time being , we assume it to be invertible . will be used instead , see discussion later .",
    "] we introduce a discretization of the domain .",
    "thus , for an arbitrary function @xmath24 , we set @xmath25 , where @xmath26 is the spacing in the @xmath27 and @xmath28 directions ( isotropic discretization ) and @xmath29 is the number of mesh points in each direction ( for a total of @xmath2 grid points and as many variables ) .",
    "further , by @xmath30 , we will denote the vector of the @xmath31 using the standard column - wise ordering . letting @xmath32 we can express the equations in terms of the sole variable @xmath33 , so that the semi - discretized system takes the form @xmath34 where @xmath35 is one of the expressions below : @xmath36 @xmath37 , which are finite difference discretizations of the corresponding formulations - .",
    "the ` @xmath38 ' operator denotes componentwise multiplication of vectors , @xmath39 , so that the product @xmath40 is fully symmetric .",
    "differently from the analytical case , the semi - discretizations - _ are not _ equivalent , rather , they have very different properties .",
    "all of them preserve the discrete version of the total vorticity , @xmath41 otherwise , the flows have different conservation properties .",
    "arakawa showed that the choice preserves a discrete version of the energy , @xmath42 ( but not the enstrophy ) , while preserves the discrete enstrophy , @xmath43 ( but not the energy ) .",
    "@xmath44 preserves neither the discrete energy nor the enstrophy .",
    "in addition to - , arakawa considered also a semi - discretized flow that preserves energy _ and _ enstrophy ( and also linear momentum ) , @xmath45 the proofs of conservation can be found in the original work of arakawa .",
    "a more modern approach , based on nambu bracket formalism , can be found in @xcite .",
    "the semi - discretizations - and are also _ volume _ preserving . a proof , using the skew - symmetry of the discretized differential operators @xmath46 and the symmetry of @xmath47 , as well as the properties of the trace operators , can be found in @xcite .",
    "the divergence - free differential equation @xmath48 preserves the volume , as it has the property that @xmath49 .",
    "similarly , a numerical method for @xmath50 , @xmath51 is _ volume preserving _ provided that @xmath52 or , equivalently , @xmath53 = 1 $ ] for all @xmath54 ( whenever @xmath55 ) . following @xcite , a system obeying the condition @xmath56 is called _ diagonal - free _ system , since the @xmath0-th component does not depend on the @xmath0-th variable .",
    "diagonal - free systems are obviously divergence free , but the converse is not true , as there exists divergence - free system that are not diagonal free .",
    "it is easier to design volume preserving numerical methods for diagonal - free systems , while the general case with nonzero diagonal contributions is typically more complicated @xcite .",
    "let us consider a splitting method , based on the splitting of the function @xmath57 in @xmath58 `` sub vector fields ''",
    "@xmath59 each of them also divergence free .",
    "assume that each vector field @xmath60 is integrated exactly by @xmath61 , for @xmath62 .",
    "then , the composition @xmath63 is also volume preserving and yields an order one method .",
    "we will consider the _",
    "composition , @xmath64 which yields a second order method ( each @xmath65 is an exact integrator , thus self - adjoint , @xmath66^*$ ] ) .",
    "a simple and natural splitting of diagonal - free systems in vector fields that can be solved exactly is that of _ canonical shears _ , advancing one coordinate at a time , while keeping the others constant . in detail , we take @xmath58 to be the number of variables , and set @xmath67 to be the vector field equal to @xmath68 for the @xmath0-th variable , and @xmath69 for the remaining : for @xmath70 , @xmath71 it is immediate to see that the variables @xmath72 , @xmath73 are constant , while the @xmath0-th variable can be integrated exactly by a step of the forward euler method , as @xmath68 depends solely on the other variables . in other words , the exact solution is given by @xmath74 since @xmath75 solves @xmath76 exactly and @xmath67 is divergence free , it is volume preserving .",
    "alternatively , one can proof directly the condition by observing that the matrix @xmath77 differs from the identity matrix only for the off - diagonal elements in row @xmath0 , and clearly it has determinant one .",
    "consequently , the symmetric composition yields an explicit , symmetric , order two , volume preserving integrator .",
    "it must be noted that composition methods do not necessarily preserve first integrals and/or conserved quantities .",
    "a first integral @xmath78 will be preserved if and only if each of the flows @xmath61 also preserves @xmath78 , which is typically not the case of the shears .",
    "so , the symmetric composition method is not expected to preserve the integrals and the casimirs of the @xmath79 discretization .",
    "however , due to the symmetry of the composition , there exist theorems that guarantee that the conserved quantities are approximately well preserved over long simulation times @xcite .",
    "in the context of the qg equations , we have @xmath80 , so that @xmath68 is the @xmath0th component of @xmath35 . since @xmath81 , the @xmath35 vector fields are all quadratic in the @xmath33 variable .",
    "this means that they can be written in the form @xmath82 where @xmath83 .",
    "we have omitted the dependence of the matrices and their elements on the vector field @xmath84 for sake of simiplicity . in order to be able to apply the canonical shears methods described above",
    ", we must make sure that the vector field is diagonal - free .",
    "to do so , we study the coefficients @xmath85 .    the coefficients @xmath85 can be computed explicitly and once for all at the beginning of the numerical simulations .",
    "they do not depend on the topography or the vorticity , but only on the differential operators .",
    "let @xmath86 and @xmath87 . then : @xmath88 - ( d_y)_{i , l}[(l_x)_{l , k}+(l_x)_{i , k } ]   \\nonumber \\\\      & & \\qquad \\mbox{}+ \\underbrace{[(d_x)_{i,:}*(d_y)_{l,:}- ( d_y)_{i,:}*(d_x)_{l , : } ] } _ { \\hbox{row vector } } \\underbrace{(\\delta_n^{-1 } ) _ { : , k}}_{\\hbox{col.\\ vector } } \\big ) , \\label{eq : aikl_ez } \\\\      0 : \\qquad        a^i_{k , l } & = &   ( d_x)_{i , l}(l_y)_{i , k } - ( d_y)_{i , l}(l_x)_{i , k } \\label{eq : aikl_0}\\\\      \\mathcal{e } : \\qquad       a^i_{k , l } & = &   ( d_x)_{i , l}(l_y)_{l , k } - ( d_y)_{i , l}(l_x)_{l , k }        \\label{eq : aikl_e } \\\\      \\mathcal{z } : \\qquad          a^i_{k , l } & = & \\underbrace{[(d_x)_{i,:}*(d_y)_{l,:}- ( d_y)_{i,:}*(d_x)_{l,:}]}_{\\hbox{row vector}}\\underbrace{(\\delta_n^{-1 } ) _ { : , k}}_{\\hbox{col.\\ vector } } , \\label{eq : aikl_z}\\end{aligned}\\ ] ] where we have used matlab semicolon notation to denote rows / columns of matrices .",
    "we use the standard five point stencil with periodic boundary conditions .",
    "let @xmath89 the @xmath90 shift matrix ( periodic ) .",
    "then , @xmath91 where @xmath92 .",
    "similarly , @xmath93 for periodic boundary conditions , the matrix @xmath94 is circulant hence singular . in turn",
    ", @xmath95 is block circulant , with circulant block , and singular .",
    "further , if the matrix @xmath94 is symmetric , also the blocks in @xmath95 are symmetric .",
    "the matrix @xmath95 has a rank - one subspace corresponding to constant solutions .",
    "thus , we need an  inverse \" that projects constant functions to zero .",
    "the moore ",
    "penrose pseudo - inverse matrix @xmath96 has this property .",
    "let @xmath97 the an orthogonal eigenvalue decomposition of @xmath95 ( which exists , since @xmath95 is symmetric , hence normal ) .",
    "one eigenvalue of @xmath95 , hence one diagonal element of @xmath98 , will be equal to zero .",
    "define the matrix @xmath99 with diagonal elements @xmath100 the pseudoinverse is then defined as @xmath101 .",
    "some important observations are in place .",
    "consider the @xmath35 vector field in , whose @xmath0-th component coefficients are given as in .",
    "the @xmath102 matrices , obtained using the divided differences operators , are sparse and have only a few number of columns , depending on the choice of the discretized differential operators . in particular , for the @xmath103 case , only 4 nonzero columns , while for the @xmath79 case , 8 nonzero columns .",
    "this can be proved as follows .",
    "for a fixed @xmath0 , it is readily observed that @xmath104 is nonzero for two values of @xmath105 ( and independently of @xmath106 ) , and so is @xmath107 , yielding possibly nonzero elements for four columns for the @xmath108 cases .",
    "further , the row vector @xmath109 $ ] can be nonzero at at most four values of @xmath105 ( two values from the first product , further two from the second product ) .",
    "this implies that the @xmath110-case matrices also have only four columns . finally , for the @xmath79 cases , we have the superposition of the @xmath108 case and the @xmath110 case , giving 8 columns ( at most ) .",
    "[ th : prop2 ] @xmath111 does not depend on @xmath112 , i.e.  @xmath113 for all @xmath114 .",
    ": for @xmath115 , it is obvious that @xmath116 since @xmath117 are skew symmetric hence they have zero diagonal elements .",
    "in the case @xmath118 , we have @xmath119 .",
    "we show the case @xmath120 , the other one is similar .",
    "we have @xmath121 .",
    "the third last passage follows from the symmetry of @xmath95 and skew - symmetry of @xmath122 and the second last follows from the fact that the differential operators @xmath122 and @xmath95 commute .",
    "hence @xmath123 .    : for @xmath115",
    ", this is the analogous of the @xmath69 case . for @xmath118 , we have @xmath124 . because of the tensor - product structure of @xmath122 and @xmath125 , it is immediate to observe that @xmath126 for any @xmath127",
    ". hence at most one of them is nonzero at each time .",
    "assume @xmath128 ( hence @xmath129 ) .",
    "we look at @xmath130 . because of the structure of @xmath125 , for any fixed index @xmath105 , there are at most two indices @xmath131 for which @xmath132 and @xmath133 are nonzero .",
    "moreover , @xmath134 , hence it is sufficient to show that @xmath135 .",
    "this latter statement follows because of the structure of @xmath47 , which has circulant and symmetric blocks ( in addition to being block - circulant and block symmetric ) , since such is @xmath95 .",
    "the case @xmath136 ( hence @xmath137 ) can be proven in a very similar manner .",
    ": for @xmath115 , the row vector in is obviously identically zero , since , as observed above , @xmath138 for any @xmath139 .",
    "for @xmath118 , the proof is a verification as in the @xmath140 case . for any @xmath127 , either the row vector is identically zero ( for instance if the indices @xmath127 correspond to the same block ) , or , fixed @xmath0 , there exist ( at most four ) values of @xmath105 for which the row vector @xmath141 has a _ single _ nonzero element , corresponding to the index @xmath142 .",
    "for the same values of @xmath127 , the term @xmath143 has exactly the same _ single _ nonzero element , but at a position @xmath144 .",
    "it is true that @xmath145 .",
    "the proof is tedious and technical , but , again , it follows from the special structure of @xmath146 , being block circulant , with circulant blocks , block symmetric , with symmetric blocks , and its connections with convolutions .    finally , the @xmath79 case is the combination of the three cases , hence it follows from those .",
    "[ th : aisame ] the matrices @xmath102 in are the identical up to a shift on the physical domain .",
    "the coefficient of the matrices are determined only by the relative position of @xmath147 , @xmath148 with respect to the variable @xmath112 .",
    "this is true because the differential operators in the definition of the vector field : the interaction between @xmath112 and @xmath147 depends only on their position in the grid .      from this point",
    ", we focus on the @xmath79 case ( energy and entropy - preserving discretization , whose @xmath102 matrix elements are given in .",
    "the matrices @xmath102 ( in fact , because of prop  , they can all be identified with a single matrix , that is then shifted over the domain ) as well as the differential operators are computed once and for all .",
    "each @xmath68 evaluation requires a vector - matrix - vector multipication , where the matrices @xmath102 have only @xmath149 nonzero columns and @xmath2 rows .",
    "hence each @xmath68 requires @xmath150 multiplications and as many additions .",
    "this must be repeated for all the @xmath2 variables , and the result doubled if a symmetric composition is used .",
    "hence the complexity of one step of the symmetric method is @xmath151 , counting both multiplications and additions .",
    "thus , evaluating one step of the explicit splitting method has the same order of magnitude of computing the whole vector field @xmath57 .      given a splitting of a vector field in @xmath58 terms ,",
    "there are @xmath152 possible orderings ( permutations of indices ) for the symmetric composition",
    ". a standard approach would be that of choosing a _ sequential _ ordering .",
    "other popular approaches are based on _ checkerboard _ orderings .",
    "our preliminary numerical simulations indicated that these strategies were not satisfactory , hence a better strategy for the ordering of the vector fields was needed , as each ordering will have a different effect insofar error propagation is concerned .",
    "to have an idea of the error propagation by the splitting method , we analyze by the _",
    "symmetric bch _ formula , @xmath153 where @xmath154 - \\frac{\\tau^3}{24 } \\sum_{\\stackrel{\\mbox{\\scriptsize $ i , k=1$}}{i",
    "< k}}^m   [ \\mathbf{f}_i , [ \\mathbf{f}_i , \\mathbf{f}_k ] ] + o(\\tau^5).\\ ] ] the leading error term is governed by the double commutators of vector fields , defined as @xmath155 = \\nabla \\mathbf{f }   \\ ; \\mathbf{g } - \\nabla \\mathbf{g}\\;\\mathbf{f}$ ] , where @xmath156 is the jacobian of the vector field @xmath157 .",
    "it is immediate to observe that collecting together commuting vector fields will decrease the number of error terms , it is reasonable to collect together commuting vector fields .",
    "when the vector fields do not commute , minimizing the commutator is still a reasonable strategy .",
    "thus we estimate the norm of the commutators and collect together terms in order of increasing non - commutativity . to this goal , after computing the matrices @xmath102 , for @xmath158 , for each @xmath102 , we look at the column values and the row values . if , for an index @xmath159 , @xmath160 and @xmath161 , then @xmath68 does not depend on @xmath147 .",
    "similarly , if @xmath162 and @xmath163 , then @xmath164 does not depend on @xmath112 , hence @xmath165 and @xmath166 commute .    disregarding the dependence on the topography @xmath167 , the vector fields are of the form @xmath168 ( i.e.  they are quadratic and advance one variable at a time , @xmath112 ) , hence @xmath67 and @xmath169 will nearly commute if the coefficients in @xmath102 that invoke the @xmath170-th variable are small .",
    "thus , we look at @xmath171 the variable @xmath172 is a measure of the independence of the vector field @xmath67 on the variable @xmath72 .",
    "more formally , we have @xmath173 hence , assuming @xmath174 and @xmath175 , we can bound @xmath176 \\|}_2",
    "\\leq   a c^i_j\\ ] ] for any @xmath177 . if @xmath178 for all @xmath106 , then @xmath67 is independent of @xmath72 and @xmath67 and @xmath169 commute .",
    "the vector @xmath179^t$ ] is then reshaped to the grid , giving a matrix @xmath180 .",
    "the matrix @xmath180 is _ essentially _ the same for all the variables , as the matrices @xmath102 are _ essentially _ the same for all the variables ( cfr .",
    "[ th : aisame ] ) , they only differ by a shift in the location .",
    "boundary wrapping must be considered , as we the problem has periodic boundary conditions , see figure  [ fig : ci ] .    for simplicity",
    ", we illustrate the case when @xmath181 .",
    "the arguments extend also to the generic case @xmath29 even ( our numerical tests are all performed with @xmath29 even ) .",
    "the @xmath180 matrices look like perfectly symmetrical ` vulcanos ' .",
    "the locations at the same distance from the centre have the same commutation weight .",
    "the commutation weight decreases with the distance to the centre and it is minimal for the point on the grid that is furthest away ( considering wrap - around ) from it . for the standard",
    "divided difference choice we get the following commutation pattern : divide the grid in four quadrants , nw , sw , ne , se . the flow corresponding to each variable @xmath0 in the nw quadrant commutes with the flow of the corresponding variable in the se quadrant .",
    "similarly , the flow of a variable in the sw quadrant commutes with the flow of the corresponding variable in the ne quadrant ( see figures  [ fig : comm_dd]-[fig : spycomm_dd ] for an illustration in the case @xmath182 , i.e.  @xmath183 grid , @xmath184 variables ) .",
    "commutation can be proved , but the proof ( technical , in the style of prop .  [",
    "th : prop2 ] ) is not so relevant for the discussion .",
    "notice also that the closest positions ( hence variables ) to the centre are always those with the highest non - commutativity .",
    "this explains why a plain sequential indexing of the variables , @xmath185 , will typically display much larger error .     for the choice of the standard 5-points discretization of the laplacian by divided differences .",
    "]     is 1 if @xmath68 does not depend on @xmath72 , zero otherwise .",
    "this graph displays the same information as the nw - se and sw - ne diagrams in figure  [ fig : comm_dd ] . ]     with divided differences as in , for @xmath186 , for a @xmath183 grid .",
    "the values are the same , just shifted across the domain , centered on the grid position of the @xmath0th variable . @xmath187 commutes with variable @xmath188 and @xmath189 commutes with @xmath190 ( cfr .",
    "[ fig : comm_dd ] ) .",
    "notice the wrapping along the boundaries . ]",
    "once the matrix @xmath191 is computed , each @xmath180 is obtained by shifting on the relevant position in the domain .",
    "if we consider the indexing @xmath192 , the error will be approximately the sum of the two commutation weights , i.e.  @xmath193 .",
    "since we aim at minimizing these cumulative sums , we choose the variable @xmath194 to be the position where @xmath191 has a minimum value ( different from the centre of the vulcano ) .",
    "this gives us a partial ordering @xmath195 , with cumulative commutation weight @xmath196 .",
    "then we look at the values of @xmath197 , sorted in increasing order , ignoring the minima corresponding to @xmath198 , and take the next minimal value . in case of a tie",
    ", we obtain a new list , of candidate indices for which we compute the cumulative weight ( starting from the first index in the new list ) . the new list , sorted according to the cumulative weight ,",
    "is then added to the previous list , and the corresponding commutation weight matrices are added to @xmath197 .",
    "we look at the new minima , get a new list of candidate indices , eventually sort them , and so on , until the final ordering list is obtained . the procedure can be formalized as an algorithm .",
    "+    [ alg : multin][mincom ] indexing of the vector fields for divided differences , by minimal cumulative estimated commutation weight .",
    "description : sorting of the vector fields .",
    "creates a ordered list of indices + from @xmath199 to @xmath2 ( number of vector fields ) .",
    "+ input : the commutation weight matrix @xmath191 , @xmath29 , starting index ` i1 ` .",
    "+ output : a list of indices @xmath200 with a minimal cumulative estimated commutation weight .",
    "+   + % initialization + ` list = [ i1 ] ` ; + ` newlist ` = ` list ` ; + @xmath197 = ` zeros(n , n ) ` ; %  cumulative commutation \" weight matrix +   + % main loop + * until * = all variable @xmath201 are in ` list ` * do * + * for * = all ` i ` in ` newlist ` + shift the commutation weight matrices @xmath191 in position ` i ` to obtain @xmath180 ; + @xmath202 ; + * end for * + % find the next most commuting indices ` newlist ` ( candidate indices ) by getting + % new minimal value : + ` [ sval , newlist ] = sort(c_\\mathrm{list } ( : ) ) ` ; % ` sval ` temporary variable with sorted values + remove from ` newlist ` all indices already in ` list ` ; + set ` inewlist ` to be the first index in ` newlist ` ; + ` minval = sval(inewlist ) ` ; % new minimum + find all indices in ` newlist ` that have value equal to ` minval ` and remove rest ; + sort the element in ` newlist ` so that they locally ` ... ` + have the least cumulative commutation matrix with starting ` ... `",
    "+ index ` inewlist ` ( recursive call ) ; + ` list = [ list , newlist ] ` ; % concatenate lists + * end do *    the procedure for the algorithm and the intermediate cumulative weight matrices for the @xmath182 case is illustrated in figure  [ fig : alg1 ] below .     for indexing of a @xmath183 grid , showing the cumulative commutation matrix @xmath197 with starting index @xmath203 .",
    "blue values : commuting / almost commuting .",
    "red values : high dependence on these variables ( the commutator is expected to be larger ) .",
    "top left to bottom right : at the fist step , newlist=[37 ] is added ( commuting with 1 ) . at the second step , newlist = [ 5 , 33 ] .",
    "as they too commute in between , no sorting is needed . at the third step , newlist = [ 3 , 39 , 7 , 35 , 21 , 49 , 53 , 17 ] .",
    "they have been sorted so that the cumulative commutation matrix of the new list , starting with the @xmath204 , has the smallest possible value in the corresponding positions . at step 4 ,",
    "newlist = [ 19 , 55 , 51 , 23 ] , ( also sorted ) . at step 5 , newlist = [ 10 , 46 , 42 , 14 , 44 , 16 , 48 , 12 , 28 , 64 , 60 ,",
    "32 , 30 , 58 , 26 , 62 ] ( sorted ) and finally at step 6 , newlist = [ 2 , 38 , 34 , 6 , 8 , 36 , 40 , 4 , 56 , 20 , 52 , 24 , 22 , 50 , 18 , 54 , 29 , 57 , 61 , 25 , 9 , 45 , 13 , 41 , 47 , 11 , 43 , 15 , 27 , 63 , 31 , 59 ] ( sorted ) . ]",
    "interestingly enought , the results of this algorithm returns a grid that reminds of multigrid approaches , which might give an intuition of why this ordering should give better results .",
    "but there are differences : in the multigrid approach , the computed values are not variable values , rather , they are transferred to the relevant variables at the higher resolution by some interpolation operator , until the finest level . in this approach , we do compute the actual variable values and no interpolation is taking place : all the computations are done at the same grid level .",
    "we perform numerical simulations with the @xmath205 vector field on the test problem of @xcite .",
    "the topography function is @xmath206 the coefficients of our vp implementation based on splitting methods are given in .",
    "we test different sizes of the grid . for each grid size",
    ", we use the same initial condition , computed numerically using an optimization technique and random initial condition , with the constraints @xmath207 , @xmath208 , and first and third moment equal to zero as in @xcite .",
    "we estimate the mean fields of the numerical simulations and compare with the mean field predictions of the @xmath79 semi - discretization .",
    "the numerical experiments consist in estimating the average fiels @xmath209 and the correlation @xmath210 between the average vorticity @xmath211 and @xmath209 . in facts , under the assumptions of energy and enstrophy conservation , and conservation of linear momentum ( total vorticity )",
    ", the statistical theory asserts that @xmath212 and , further , that @xmath209 is a function of @xmath27 only ( as such is @xmath213 ) .",
    "the least squares solution for @xmath210 gives the estimate @xmath214 for the values of energy and enstrophy above , @xmath207 , @xmath208 , and zero total vorticity , the predicted value of @xmath210 was estimated by @xcite to be @xmath215 for @xmath216 .",
    "we have computed the predictions for different values of @xmath29 below .",
    "the algorithm for the prediction , described in @xcite and adapted from the spectral analysis in @xcite , is reported here for convenience .",
    "the ensemble averages for energy and estrophy are split into a mean part and a fluctuation , @xmath217 , @xmath218 . then using a spectral truncation",
    ", one has @xmath219 starting with suitable guesses for @xmath220 , the actual values are computed by iteration ( nonlinear least squares ) using  in conjunction with the assumption that @xmath221 and @xmath222 , see table  [ tab : predictedmu ] .",
    ".predicted values of @xmath210 as a function of @xmath29 for fixed @xmath223 , @xmath224 and topography @xmath213 as in .",
    "[ cols=\"<,>,>,>,>,>,>,>\",options=\"header \" , ]      clearly , the @xmath225 simulation , even with the optimized ordering of the splitting terms , does not show satisfactory results , as there is a clear linear drift in the estimation of @xmath210 .",
    "this seems to be apparently due to worse accumulation of error , that eventually displays an exponential growth .",
    "this is disappointing , as dimensionality seems to play a role in how long the method is close to a  nearby problem \" . if the energy and the enstrophy ( and linear momentum ) grow too much , it is clear that the computed statistical averages will be affected .    to enforce better preservation of the conserved quantities , we test the approach using an order four implementation of the volume preserving splitting method using yoshida s technique @xcite : given a self - adjoint method @xmath226 of order two , it is possible to increase the order from two to four using the composition @xmath227 where @xmath228 obey the conditions @xmath229 there is a unique real solution to the above equations , given by @xmath230 and @xmath231 . by a similar token , it is possible to increase the order from four to eight and further , though it is known that this approach might lead to higher leading error term and compositions with fewer terms and smaller leading error can be constructed , see for instance @xcite .",
    "the results of the order four implementation of the volume preserving splitting method for the @xmath225 example with the same initial condition as the order two method , are shown in figure  [ fig:22x22_multin4 ] , and the computed values for @xmath210 are tabulated in table  [ tab:22x22 ] .",
    "the fourth order method has a better conservation of all the integrals of the @xmath79 semi - discretization , and in addition it displays a good preservation of the third order momentum .",
    "however , there is still a mild linear tendency in the estimated @xmath210 .",
    "grid , order 4 implementation with ` mincom ' ordering of the indices , using yoshida s technique .",
    "bottom left : relative error in the energy ( solid line ) and enstrophy ( dashed line ) .",
    "bottom right : absolute errors in the total vorticity ( solid line ) , which is also the first moment of the system , and third moment ( dashed line ) . ]     grid , order 4 implementation with ` mincom ' ordering of the indices .",
    "energy , enstrophy and total vorticity . ]      with the increase of the grid dimension , we have observed that the splitting methods display an increase in error accumulation , in particular for the total vorticity ( first momentum ) , which is an integral of the semi - discrete problem , as are the energy and the enstrophy ( in contrast to the third moment , which was not an integral of the discretization ) . the total vorticity had overall a consistent error propagation worse than the energy and the enstrophy .",
    "the statistical predictions for the qg flow are valid under the assumption that energy , enstrophy and total linear momentum are conserved .",
    "when this is not any longer the case , the numerical computed asymptotic values do not reflect any longer the theoretical predictions of the model , and the computed @xmath210 parameter shows a clear linear trend instead of converging to an asymptotic value .",
    "thus , particular care has to be used when using a splitting method .",
    "the ordering of the vector fields matters for error propagation and we have proposed an algorithm that produces an ordering of the vector fields that is nearly optimal .    when a volume preserving method is used , with nearby - conservation of first integrals , the ergodicity property of the flow is respected and the departure from the nearby integrals can be used as a criterium of how good the averaged result is , in these case for which the statistical quantities depend on the first integrals of the system .",
    "if the volume is not preserved , the preservation of integrals alone might give false positives , as generally no estimation of how much the ( high - dimensional ) space shrinks or expands is available , hence no indication of how reliable the estimated statistical quantities are .",
    "in @xcite the volume preservation of the projected heun method and of the implicit midpoint rule was studied , by computing the determinant of the jacobian of the discrete map , @xmath232 .",
    "it was observed that a projected heun method ( preserving the integrals ) , computed the expected average parameters , with a far too fast convergence .",
    "further , it was observed that the volume was strongly contracted , implying that only a smaller region of the space was visited by the trajectory .",
    "they also tested thoroughly the implicit midpoint rule , which preserved intrinsically the integrals to machine precision .",
    "the imr is a geometric integrator and backward error analysis guarantees that it solves a nearby hamiltonian problem for exponentially long time",
    ". the imr does not preserve volume however it is symplectic , therefore it preserves the sum of 2-dimensional projected areas : for a shorter simulation time and a smaller number of particles ( @xmath233 ) , and it was seen to slightly increase ( about @xmath234 for @xmath235 steps with stepsize @xmath236 ) .    in our experience , if the statistical parameters were required up to @xmath237 decimals , the relative error for the energy and enstrophy should be no larger than @xmath238 in magnitude .",
    "we wish to acknowledge helpful discussion with jason frank , who first introduced us to this problem and provided us with invaluable feedback during this work , robert mclachlan for suggesting higher order splitting method and sebastian reich for discussion ."
  ],
  "abstract_text": [
    "<S> we consider the euler equation of quasi - geostrophic fluids which is widely used in weather forecast . our goal is to study explicit volume - preserving numerical methods for </S>",
    "<S> very long simulations on an energy and enstrophy preserving discretization . to this purpose , we compute the average fields and estimate statistical parameters . </S>",
    "<S> it is observed that the statistical parameters depend on the integrals of the discretization and that the computed parameters are affected by the error in those , even if the volume of the phase space is correctly preserved . </S>",
    "<S> we conclude that monitoring the error in the integrals by the explicit volume preserving method can be used as an indication of how good the estimated parameters are . </S>"
  ]
}