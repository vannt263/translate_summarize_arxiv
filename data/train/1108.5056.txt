{
  "article_text": [
    "the effects of absorption and scattering by interstellar dust grains on the structural parameters of galaxies has been a long - standing and controversial issue . the only way to tackle",
    "this problem is to properly solve the continuum radiative transfer equation , taking into account realistic geometries and the physical processes of absorption and multiple anisotropic scattering . over the years",
    ", many different and complementary approaches have been developed to tackle the continuum radiative transfer problem in simple geometries such as spherical or plane - parallel symmetry .",
    "while one - dimensional radiative transfer calculations have been crucial to isolate and demonstrate the often counter - intuitive aspects of important parameters such as star - dust geometry , dust scattering properties and clumping @xcite , we need more sophisticated radiative transfer models to model complicated systems such as disc galaxies in detail .",
    "thanks to new techniques and ever increasing computing power , the construction of 2d and 3d realistic radiative transfer models is now possible .    a complementary and powerful way to study",
    "the content of galaxies is to use the direct emission of dust at long wavelengths .",
    "large dust grains will typically reach a state of local thermal equilibrium ( lte ) in the local interstellar radiation field ( isrf ) and re - radiate the absorbed uv / optical radiation at far - infrared ( fir ) and submm wavelengths .",
    "thanks to the spectacular advances in instrumentation in the fir / submm wavelength region , we have seen a significant improvement in the amount of fir / submm data on both nearby and distant galaxies . in particular , the launch of the herschel space observatory with the sensitive pacs and spire instruments has enabled both the detailed study of nearby , resolved galaxies and the detection of thousands of distant galaxies . whereas large grains typically emit as a modified blackbody at an equilibrium temperature of 15 - 30  k and hence dominate the fir / submm emission of galaxies , small grains and pah molecules are transiently heated by the absorption of single uv photons to much higher temperatures . the nlte emission from very small grains and",
    "pahs dominates the emission of galaxies at mid - infrared wavelengths .",
    "the iso and particularly the spitzer mission have been instrumental in uncovering the mid - infrared emission of nearby galaxies @xcite .",
    "different approaches have been developed to calculate the nlte emission spectrum due to very small grains and pahs , but the integration of nlte emission into radiative transfer codes has proven to be a challenging task .",
    "the main reason is that the computational effort necessary to calculate the temperature distribution of the different dust grains is substantial . in the general case ,",
    "the calculation of the dust emissivity in a single dust cell requires the solution of a large matrix equation for each single dust population , with the size of the matrix determined by the number of temperature or enthalpy bins . in the so - called thermal continuous cooling approximation @xcite",
    ", this matrix equation can be solved recursively , but still the calculation of the emission spectrum remains a significant computational challenge .",
    "indeed , since the temperature distribution of dust grains depends strongly on both the size of the grains and the strength and hardness of the isrf , a large number of temperature or enthalpy bins is necessary to sample the temperature distribution correctly .",
    "moreover , because of this strong dependence on grain size and isrf , the choice of the temperature bins is hard to fix a priori and an iterative procedure is to be preferred .    in spite of the high numerical cost , nlte dust emission has been built into several radiative transfer codes , using various approximations and/or assumptions .",
    "the most simple approach is the one followed by e.g.  @xcite and @xcite , who use a set of predefined nlte dust emissivities with the simplifying assumption that the emissivity is a function only of strength and not of the spectral shape of the exciting isrf .",
    "a pioneering code in which nlte dust emission was included in a self - consistent way was the 2d ray - tracing code by .",
    "the number of temperature distribution calculations are minimized by the assumptions that grains with a size larger than about 80    are in thermal equilibrium , and by the use of a pre - fixed time dependence of the cooling of pah grains .",
    "a similar approach was adopted in the 3d monte carlo radiative transfer code dirty @xcite .",
    "the trading code by uses a different approach : this code uses a fixed ( and limited ) grid of temperature bins for all isrfs and grain sizes , which allows to precompute and tabulate a significant fraction of the quantities necessary for the calculation of the temperature distribution .",
    "yet a different approach is the work by : driven by the observation that the spectrum of the local isrf is very similar in many places in a dusty medium , they considered the idea of a dynamic library of dust emission spectra .",
    "the idea is that the intensity of the isrf at a very limited number of reference wavelengths ( they typically used only two ) suffices to make a reliable estimate of the total isrf and hence of the dust emission spectrum .    in this paper",
    "we present an updated version of the skirt monte carlo radiative transfer code .",
    "this code , of which the name is an acronym to stellar kinematics including radiative transfer , was initially developed to study the effect of dust absorption and scattering on the observed kinematics of dusty galaxies @xcite . in a second stage ,",
    "the skirt code was extended with a module to self - consistently calculate the dust emission spectrum under the assumption of local thermal equilibrium @xcite .",
    "this lte version of skirt has been used to model the dust extinction and emission of various types of galaxies , as well as circumstellar discs @xcite and clumpy tori around active galactic nuclei @xcite . in this present paper",
    "we present a strongly extended version of the skirt code that can perform efficient 3d radiative transfer calculations including a self - consistent calculation of the dust temperature distribution and the associated fir / submm emission with a full incorporation of the emission of transiently heated grains and pah molecules .",
    "in section  [ skirt-general.sec ] we present the general characteristics of the skirt code , whereas we highlight a number of particular aspects in section  [ particular.sec ] and some implementation details in section  [ implementation.sec ] . in section  [ applications.sec ]",
    "we describe a number of tests and applications , and section  [ conclusions.sec ] we present our conclusions .",
    "skirt is a 3d continuum radiative transfer code based on the monte carlo algorithm .",
    "the key principle in monte carlo radiative transfer simulations is that the radiation field is treated as a flow of a finite number of photon packages .",
    "a simulation consists of consecutively following the individual path of each single photon package through the dusty medium .",
    "the journey or lifetime of a single photon package can be thought of as a loop : at each moment in the simulation , a photon package is characterized by a number of properties , which are generally updated when the photon package moves to a different stage on its trajectory .",
    "the trajectory of the photon package is governed by various events such as emission , absorption and scattering events .",
    "each of these events is determined statistically by random numbers , generated from the appropriate probability distribution @xmath0 .",
    "typically , a photon is emitted by a star , undergoes a number of scattering events and its journey ultimately ends when it is either absorbed by the dust or it leaves the system . a monte carlo simulation repeats this same loop for every single one of the photon packages and analyzes the results afterwards .",
    "the mathematical details and practical implementation of monte carlo radiative transfer have both been described in detail by various authors and will not be repeated here in full detail .",
    "our overall approach is comparable to the dirty @xcite and trading radiative transfer codes and we refer the interested reader to these papers for more details",
    ". we will only give a compact description of the general characteristics of the skirt monte carlo code and not describe all the details .",
    "instead , we will focus our attention to those aspects of the skirt code that are novel and/or different compared to the other codes .",
    "each skirt simulation consists of four phases : the initialization phase , the stellar emission phase , the dust emission phase , and the clean - up phase .",
    "the initialization phase consists of adopting the correct unit system , setting up the random number generator , computing the optical properties of the various dust populations , constructing the dust grid , setting up the stellar geometry and setting up the instruments of the various observers .",
    "once this initialization is finished , the actual simulation can start .      in the stellar emission phase , we consider the transfer of the primary source of radiation ( usually stellar sources , but it can also include an accretion disc or nebular line emission ) through the dusty medium .",
    "the stellar emission phase consists of a set of parallel loops , each of them corresponding to a single wavelength . at every single wavelength ,",
    "the total luminosity of the stellar system is divided into a very large number ( typically @xmath1 to @xmath2 ) of monochromatic photon packages , which are launched consecutively through the dusty medium in random propagation directions .",
    "once a photon package is launched into the dusty medium ( either after an emission event or following a scattering event ) , it can be absorbed by a dust grain , it can be scattered by a dust grain , or it can travel through the system without any interaction . in a naive monte carlo routine ,",
    "these three possibilities are possible and it is randomly determined which of the three will happen .",
    "this is generally an inefficient procedure , though , which leads to poor signal - to - noise both in the absorption rates in the different cells and in the scattered light images . to overcome these problems ,",
    "we have set up a combination of continuous absorption and eternal forced scattering ( see section  [ forced.sec ] for details ) .",
    "the result is that , contrary to most monte carlo codes where the life cycle of a photon package ends when it either leaves the system or is absorbed , the photon packages in skirt can never leave the system .",
    "the life cycle of a photon package ends when the package contains virtually no more luminosity ( typically we use the criterion that it must have lost 99.99% of its original luminosity ) .",
    "whenever this happens , a different stellar photon package is launched until also this one finishes its life cycle .",
    "this loop is repeated for all stellar photon packages at a given wavelength , and subsequently for all wavelengths ( in a multi - core system , each core can handle the loop corresponding to a different wavelength at the same time ) .",
    "after the stellar emission phase , the code moves to the dust emission phase .",
    "this phase is roughly similar to the stellar phase , except that the sources that emit the radiation are now not the primary , stellar sources but the dust cells . from the stellar emission phase we know the total amount of absorbed radiation at each wavelength in each cell of the dust domain . from this absorption rate",
    "we can calculate the mean intensity of the isrf in each cell , which allows the calculation of the dust emissivity , depending on the physical processes the skirt user is interested in ( see section  [ dustemissivity.sec ] ) . with the sources ( the dust cells ) and",
    "their emissivity determined , the simulation now enters a loop that is very similar to the one in the stellar emission phase . at each individual wavelength ,",
    "a huge number of photon packages is generated which are launched and followed consecutively through the dusty medium .",
    "care is taken that all regions of the dusty medium , including those cells where only a small amount of luminosity has been absorbed , are well - sampled .",
    "the dust - emitted photon packages in turn increase the absorption rate in the dust cells where they pass through .",
    "this results in an increase of the mean intensity of the isrf .",
    "the result is that at the end of the dust emission phase , the absorption rates used to calculate the dust emissivity in each cell do not correspond to the mean intensity of the isrf .",
    "this naturally leads to an iterative procedure , in which the absorption rate , the mean intensity and the dust emissivity are updated until convergence is achieved .",
    "we hence repeat the dust emission phase of the code several times .",
    "we typically require a 1% level accuracy in the dust bolometric absorption rate of each cell as a stopping criterion for the iteration .",
    "it is typically reached in only a few iterations ; for all the simulations we have done so far , less then five iterations have been necessary .",
    "the last phase of the monte carlo simulation starts when the last of the photon packages emitted by the dust component has lost 99.99% of its initial luminosity .",
    "it simply consists of calibrating and reading out the instruments ( all output is written to fits files ) and other useful information , such as 3d absorption rate maps and dust temperature distributions .",
    "a critical aspect in monte carlo radiative transfer simulations is the choice of the dust grid .",
    "the dust grid consists of tiny cells , each of which have a number of characteristics that fully describe the physical properties of the dust at the location of the cell .",
    "the choice of the grid has a significant impact on both the run time and the memory requirement of the simulation .",
    "indeed , each photon package typically requires several integrations through the dust ( i.e. the determination of the optical depth along the path and the conversion of a given optical depth to a physical path length ) , and the calculation time of a single optical depth typically scales with the number of grid cells crossed .",
    "different kinds of dust grids can be applied in the skirt code .",
    "the most general grid is a 3d cartesian grid in which each dust cell is a rectangular cuboid . for simulations with a spherical or axial symmetry",
    ", we also have 1d spherical and 2d cylindrical grids ( the elementary dust cells being shells or tori respectively ) .",
    "the distribution of the grid points ( in 1d spherical , 2d cylindrical or 3d cartesian grids ) can be chosen arbitrarily ; linear , logarithmic , or power - law cell distributions have been pre - programmed , but any user - supplied grid cell distribution is possible .    the main goal of the dust grid is to discretize the dust density .",
    "we assume that the density of each dust component is uniform within each individual cell . in principle , the density does not need to be constant within each dust cell .",
    "in the first versions of skirt , we have experimented with a more sophisticated kind of dust grid , where the density of the dust within each cell is not uniform but determined by trilinear interpolation of the values of the density on the eight border points of the cell ( in case of a cartesian grid with cubic cells ) . in this case , the computation of optical depths in the dusty medium take more computation time , but the accuracy is increased such that a grid with less cells and less photon packages are needed per simulation . for models in which only absorption and scattering are taken into account , we found that this kind of dust grid is computationally more efficient than a dust grid with uniform density , in particular when the system harbors a large dynamical range of dust densities @xcite .",
    "however , for radiative transfer simulations in which the thermal emission of the dust is taken into account , each dust cell needs to contain an absorption rate counter , which collects the absorbed luminosity at every wavelength .",
    "the size of the dust cells is hence the typical resolution of the simulation , and the advantage of the interpolated grid ( where the dust grid can be coarser because the density is resolved within each cell ) largely disappears .",
    "skirt therefore only uses dust grids with a uniform density in each cell .",
    "the first step in the life cycle of each stellar photon is the random generation of the location where it is emitted .",
    "this means that we have to generate random positions from the three - dimensional probability distribution @xmath3 where @xmath4 is the luminosity density at the wavelength @xmath5 of the photon package .",
    "as skirt is primarily focused towards modeling galaxies , we have done efforts to optimize the generation of random positions from arbitrary 3d probability functions .",
    "the skirt code contains a library with common geometries for which the generation of a random position vector can be performed analytically .",
    "these include spherical @xcite , @xcite or @xcite models , or axisymmetric power - law , exponential , sech or isothermal disc models .",
    "for other frequently used luminosity density profiles , e.g.  flattened @xcite or @xcite models , or more general density profiles that can not be described by an analytical function , such a direct analytical inversion is not possible .",
    "two complementary approaches have been included in the skirt code to deal with generating random positions from such density profiles .",
    "the first technique is to expand the density profile into a set of subcomponents .",
    "skirt contains a routine to perform a multi - gaussian expansion ( mge ) of surface brightness distributions .",
    "an mge expansion basically expands any surface brightness distribution as a finite sum of two - dimensional gaussian components .",
    "the mge method has proven to be a very powerful tool for image analysis : even with a relatively modest set of gaussian components , @xmath6 , even complex geometries can be reproduced accurately .",
    "one of the reasons why a mge expansion is very useful for skirt is that this approach enables a straightforward determination of the 3d spatial distribution : if the euler angles of the line of sight are known , the de - projection of a 2d gaussian distribution on the plane of the sky is a 3d gaussian distribution and the conversion formulae are completely analytical . generating random positions from a sum of 3d gaussian probability distributions is straightforward .",
    "an example of this approach can be seen in figure  [ sombrero.pdf ] , where we present a radiative transfer model for the sombrero galaxy based on the mge expansion of its surface brightness distribution presented by .",
    "the second approach consists of sampling random positions directly from the stellar density distribution using the so - called stellar foam .",
    "the stellar foam is a skirt structure based on the foam library developed by @xcite and @xcite .",
    "foam is a self - adapting cellular monte carlo tool aimed at monte carlo integration of multi - dimensional functions , including integrands with an arbitrary pattern of singularities .",
    "it achieves a high efficiency thanks to an intelligent division of the integration space into small simplical or hyper - rectangular form , which are created in a self - adaptive way by binary splitting .",
    "it has originally been developed for use in high - energy physics ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , but it can also be adopted as a general - purpose monte carlo event generator .",
    "we use an adapted version of the foam library for the generation of random positions from an arbitrary probability density @xmath7 .",
    "one problem is that the probability density @xmath7 from which we want to generate random positions is typically defined on the entire 3d space , whereas foam requires a probability density on the @xmath8-dimensional unit hypercube @xmath9^n$ ] .",
    "we achieve this through a coordinate transformation from the usual coordinates @xmath10 to new coordinates @xmath11 such that we map each infinite interval @xmath12 $ ] onto the unit interval @xmath9 $ ] .",
    "the probability density @xmath7 , normalized such that @xmath13 is transformed to a new probability density @xmath14 this new density will be defined and normalized to one on the unit cube , @xmath15 there are many possible transformations we can apply to achieve this .",
    "we have chosen the transformation    [ barxyz ] @xmath16    with @xmath17 , @xmath18 and @xmath19 three scale parameters , which we can adapt for the specific probability density we are considering .",
    "the inverse transformation is    [ xyz ] @xmath20    and the jacobian reads @xmath21 summarizing , if we want to generate random positions @xmath22 from an arbitrary probability density @xmath7 , we first determine representative scale lengths @xmath17 , @xmath18 and @xmath19 along the three dimensions , and subsequently calculate the corresponding probability density @xmath23 using equations  ( [ barp ] ) , ( [ xyz ] ) and ( [ jacobian ] ) .",
    "the foam generator is applied to this new probability function to generate the random points @xmath24 , which are converted to the desired positions @xmath22 through the formulae  ( [ xyz ] ) .",
    "the construction of the stellar foam takes only a few seconds in two dimensions up to about one minute in three dimensions .",
    "once a photon package has been generated at a random location ( sampled from the stellar density ) and it has been given a random propagation direction ( sampled randomly from the unit sphere ) , it is ready to start its journey through the dusty medium .",
    "it has three possible fates : it can be absorbed by a dust grain at a certain position along its path , it can be scattered by a dust grain at a certain position on its path , or it can travel along its path through the system without any interaction .",
    "the probability for each of these three options are determined by the scattering albedo @xmath25 and the optical depth @xmath26 along the path , defined as @xmath27 where @xmath28 is the extinction coefficient , @xmath29 is the dust density and the integral covers the entire path of the photon package through the dusty medium .",
    "the most straightforward way to model these different physical processes in a monte carlo radiative transfer code is to generate randomly which of these three processes will take place . in case",
    "the photon package leaves the system , its lifetime is terminated and a different package is launched . in the case of a scattering event , the position of the scattering event is determined by choosing a random path length from the appropriate probability distribution and a scattering event is simulated .",
    "finally , in case it is absorbed , the position of the absorption is determined in a similar way , the luminosity of the photon package is stored in a local absorption rate counter attached to the dust cell where the absorption event took place , and the photon package s life is terminated .",
    "these local absorption rates are used in a later stage of the simulation to estimate the local mean intensity of the isrf , necessary to calculate the thermal dust emission .",
    "this traditional method has two significant drawbacks : along paths where the optical depth is modest , many photon packages will escape from the system without interactions , which will result in bad statistics of the scattered intensity and the absorbed luminosity . even if the photon packages do interact",
    ", most interactions will take place on those sections of the path where the density is largest .",
    "many absorption events are necessary in each cell to guarantee a high - quality estimate of the local absorption rate and the corresponding mean intensity . in dust cells with a low density ( such that only few absorptions take place ) and at wavelengths where the absorption rate is low",
    ", this usually requires large numbers of photon packages .",
    "these two problems can be minimized using the efficient combination of two clever monte carlo techniques : forced scattering and continuous absorption .",
    "continuous absorption ( or lucy estimation ) is a technique to estimate the mean intensity of the isrf throughout the dusty medium .",
    "the continuous absorption technique is designed to solve the problem of poor statistics in the absorption rate in low - density regions by spreading the absorption over all cells along the photon package s path instead of concentrating it in one single cell . a different but equivalent way to see",
    "it is that the mean intensity in each cell is estimated using the sum of the path lengths covered by all photon packages that traverse that particular cell .",
    "forced scattering is an old technique that was already implemented in the first monte carlo radiative transfer codes .",
    "when applying forced scattering , photon packages are forced to interact with a dust grain before they leave the system .",
    "this incorrect behavior is corrected for by decreasing the luminosity of the photon package .    in most radiative transfer codes ,",
    "forced scattering is considered only after an emission event and subsequent scattering events are unforced . in the skirt code",
    "we always consider forced scattering , such that we have eternal forced scattering .",
    "the combination of eternal forced scattering and continuous absorption results in a very efficient monte carlo routine . instead of determining randomly whether a photon package with luminosity @xmath30 will escape , will be absorbed or will be scattered , we split it into @xmath31 child photon packages ( with @xmath32 the number of dust cells along the path ) : one child photon package that will leave the system without interaction , one child photon package that will be scattered by a dust grain somewhere along the path , and @xmath32 children that will be absorbed , one in each of the @xmath32 cells along the path .",
    "the luminosity of each of these children is easy to calculate : we find @xmath33 with @xmath34 the optical depth to the point on the path where the photon package would leave the @xmath35th dust cell .",
    "obviously , we have @xmath36 in our monte carlo simulation , we now consider each of these @xmath31 child photon packages .",
    "each one of the @xmath32 children with luminosity @xmath37 is absorbed in the @xmath35th cell along the path , which means that its luminosity is added to the absorption rate counter attached to this dust cell . the child photon package with luminosity @xmath38 escapes from the system , which implies that we do nt have to take this one into account anymore .",
    "finally , the child photon package with luminosity @xmath39 is scattered somewhere along the path .",
    "this is basically the only photon package that we need to follow up .",
    "we still have to randomly determine the location of the scattering event along the path .",
    "this is achieved by selecting a random optical depth @xmath40 from an exponential distribution over the finite range @xmath41 , i.e.@xmath42 and translate this randomly generated @xmath40 to a physical path length by solving the equation @xmath43 for @xmath44 .",
    "once this path length has been determined , we can determine the position of the scattering event . if we then also determine a new propagation direction , determined randomly by generating a random direction from the scattering phase function , we are back at the starting point .",
    "this child now becomes the parent , it can be split into children and we can repeat the same loop all over again .",
    "summarizing , the net result of the combination of continuous absorption and eternal forced scattering is that after each emission / scattering event , we distribute a fraction of the photon package s luminosity among all the cells along the path , and we continue the monte carlo loop with a less luminous photon package that is always scattered at some point along the path .",
    "hence , contrary to most monte carlo codes where the life cycle of a photon package ends when it either leaves the system or is absorbed , the photon packages in skirt can never leave the system .",
    "the life cycle of a photon package ends when the package contains virtually no more luminosity .",
    "typically we use the criterion that it must have lost 99.99% of its original luminosity , which immediately is the minimum level of absolute energy conservation of the simulation .",
    "the goal of a monte carlo radiative transfer simulation is to simulate observable properties of a dusty system , i.e.  images and spectral energy distributions .",
    "skirt uses the technique of peel - off photon packages to create an arbitrary number of images / seds at different observing positions . peeling off",
    "is a monte carlo technique designed to create high signal - to - noise images ( in particular scattered light images ) , adopted for the first time by @xcite and included in almost all state - of - the - art monte carlo radiative transfer codes .",
    "after every emission or scattering event , the code calculates which fraction of the luminosity contained in the photon package would arrive at the observers locations and at which point on the plane of the sky , if the photon package would be emitted or scattered in the appropriate propagation direction .",
    "repeating this for every photon package at every emission or scattering event implies that the maximum available information is obtained for a fixed set of photon packages and hence strongly increases the signal - to - noise compared to the more simple monte carlo codes where only photon packages that leave the system are recorded .",
    "each skirt detector is basically an integral field detector , i.e.  a data cube with two spatial and one wavelength dimension . in most monte carlo",
    "radiative transfer codes the simulated detectors are natural , idealized representations of actual ccd detectors ( or a series of them at each wavelength ) .",
    "they basically consist of a two- or three - dimensional array of pixels , which act as a reservoir for the incoming photon packages .",
    "when a photon package leaves the system and arrives at the location of the observer , the correct pixel is determined and the luminosity of the photon package is added to the luminosity at that pixel . at the end of the simulation , the detector",
    "is read out pixel by pixel and the surface brightness distribution is constructed . while this approach seems the most natural way to simulate the detection of photon packages in a monte carlo simulation , it might not be the most efficient",
    ". we must be aware that , although we are simulating a real detection as closely as possible , we have more information at our disposal than real observers . the maximum information that a real observer can obtain ( in the theoretical limit of perfect noise - free observations and instruments ) when imaging with a ccd detector is the number of photon packages that arrive in each of his pixels . as numerical simulators , we have at our disposal the full information on the precise location of the impact of each photon package on the detector .",
    "in order to use this information , we have considered the concept of smart detectors , which take full advantage of the exact location of the impact of the incoming photon packages @xcite .",
    "the principle of these smart detectors is based on the estimate of the density distribution in smoothed particle hydrodynamics simulations .",
    "while preserving the same effective resolution and having virtually no computational overhead , smart detectors realize a noise reduction of about 10 percent .",
    "a crucial aspect of the skirt code is the calculation of the dust emissivity . from the stellar emission phase we know the total amount of absorbed radiation @xmath45 at each wavelength in each cell of the dust domain . from this absorption rate",
    "we can calculate the mean intensity of the isrf @xmath46 in each cell using @xmath47 where @xmath48 is the dust absorption coefficient , @xmath49 is the dust density and @xmath50 is the volume in cell number @xmath51 respectively .",
    "knowledge of the mean intensity and the dust properties in each cell allows the dust emissivity @xmath52 to be determined .",
    "skirt contains three different modules for the calculation of the dust emissivity , depending on the physical processes that are taken into account .",
    "the simplest option is to consider the dust grains as a single species that is in local thermal equilibrium ( lte ) with the local isrf . in this case",
    ", the dust emits as a modified blackbody radiator , @xmath53 where the dust equilibrium temperature @xmath54 of the @xmath51th dust cell is determined by the condition of thermal and radiative equilibrium , @xmath55 the second , somewhat more realistic option is to still consider lte for the dust grains , but taking into account that each species and size of dust grain reaches its own equilibrium temperature .",
    "the skirt code allows to consider dust mixtures with an arbitrary number of grain species and size distributions .",
    "the size distributions of the various dust species are subdivided into different bins , resulting in a dust mixture with @xmath56 populations , each of them corresponding to a dust species and a small size bin .",
    "assuming lte for each individual population , the dust emissivity is given by a sum of modified blackbodies , where the temperature of each population is still determined by the condition of thermal and radiative equilibrium , @xmath57 with @xmath58 is the contribution of the @xmath59th dust population to the total absorption coefficient @xmath48 , and @xmath60 the equilibrium temperature of the @xmath59th population in cell number @xmath51 , determined by @xmath61 the third option , in fact the only realistic option to model the spectral energy distribution of galaxies , is to consider nlte dust emission . in theory ,",
    "the transit from lte to nlte dust emission is not an enormous step .",
    "the main difference is that each dust population is not characterized by a single equilibrium temperature , but by a temperature distribution .",
    "once the temperature distribution function has been determined , the dust emissivity can easily be determined . as argued in the introduction ,",
    "however , the practical inclusion of nlte dust emission in radiative transfer codes is a notoriously tough nut to crack .    rather than develop our own routines to calculate the nlte emission for transiently heated grains , we have opted to couple the skirt code to the dustem code .",
    "dustem is a publicly available , state - of - the - art numerical tool designed to calculate the nlte emission and extinction of dust given its size distribution , optical and thermal properties .",
    "the code builds on the work by and uses an adaptive temperature grid on which the temperature distribution of the grains is calculated iteratively .",
    "no lte approximation is made , i.e.  even for large grains the temperature distribution is calculated explicitly .",
    "one of the advantages why we have chosen to couple skirt to the dustem code is that the latter code has been designed to deal with a variety of grain types , structures and size distributions and that new dust physics ( ionization of pahs , polarized emission , spinning dust emission , temperature - dependent dust emissivity ) can easily be included . on the other hand ,",
    "a consequence of choosing for a very complete and accurate nlte routine in which basically no simplifications or assumptions have been made , is that the computation load is substantial . for a typical dust model consisting of three or four dust species each with their size distribution , the calculation of the emissivity for a single isrf takes typically of the order of several seconds on a standard desktop / laptop computer .",
    "while this is compatible with 1d or 2d simulations with up to @xmath62 cells , this is excessively long for general 3d simulations for which we have designed skirt .      to overcome this problem ,",
    "we have adopted a strategy based on a library of dust emissivity profiles , inspired by the work of .",
    "their approach consists of three steps : they first run an exploratory radiative transfer simulation on a grid with a reduced number of grid cells , without taking dust re - emission into account .",
    "this low - resolution simulation is used to determine the range of isrfs encountered in the simulation .",
    "the second step consists of picking a small number @xmath63 of reference wavelengths @xmath64 ( typically @xmath65 ) .",
    "the different isrfs found in step one are discretized onto logarithmic intervals at each of the reference wavelengths , and at each bin in the @xmath63-dimensional parameter space , the full nlte dust emission spectrum is calculated and stored in a library .",
    "the final step in the simulation consists of running a radiative transfer simulation at the full resolution .",
    "the dust emissivity at any given cell is found by looking at the isrf at the @xmath63 reference wavelengths and interpolating the dust emissivities from the library .",
    "while valuable and inspiring , we see two drawbacks in the method as implemented by . in panchromatic radiative transfer simulations of galaxies , we typically solve the transfer equation at many uv / optical wavelengths , and hence have the isrf at all these wavelengths at our disposal at every grid cell .",
    "it would be a pity not to use this information to determine the dust emissivity and only base our estimate on the value of the isrf at a very small number of reference wavelengths .",
    "in particular , the isrf in monte carlo simulations can be noisy in certain cells ; when the dust emissivity is determined based on the value of the isrf at a small number of reference wavelengths , this noise could lead to a significant error .",
    "using an estimate that exploits the available information at all wavelengths can minimize this error .",
    "the second drawback is that the library method of requires an exploratory , low - resolution simulation in which the parameter space of isrfs is explored and the library of dust emissivities is built .",
    "this extra simulation not only requires a computational overhead , it also creates the danger that it does not cover the entire range of strengths and shapes of the isrf .",
    "for example , one can assume that the strongest isrf in a simulation is found in small dust cells very close to the heating sources .",
    "in a low - resolution simulation , with larger dust cells , this strong isrf will be smoothed over the larger grid cells .",
    "similarly , the weakest isrf ( or equivalently , the coldest dust ) in some simulations could be found in the inner regions of dense cores , and due to smoothing a low - resolution simulation might not reach these weakest isrf levels .",
    "the result is that the low - resolution grid will not cover the full range of isrfs encountered in the high - resolution grid , and hence that the library of dust emissivities must be somehow extended to incorporate this missing part in the parameter space .",
    "are aware of this inconvenience ( they discuss only the coldest spectrum as they concentrate on dark clouds illuminated by an external radiation field ) .",
    "they argue that this problem is not expected to be significant , and that it could be relieved by using a low - resolution simulation with a slightly higher density .",
    "still , it is clear that the use of a low - resolution grid leads to an additional overhead and complication and is a potential source of error , and it would be better to avoid it .    to overcome both problems ,",
    "we have taken a slightly different approach to implement our dust emissivity library .",
    "the first step in our library approach is to calculate a number of parameters that characterize the isrf in each dust cell after the stellar emission phase . instead of the value of @xmath66 at a number of wavelengths ,",
    "we use parameters that use combined information at all available wavelengths . from the various range of possibilities ,",
    "we choose the lowest - order moments of @xmath67 , the product of the isrf and the dust absorption coefficient . instead of the actual zeroth - order moment or normalization of this function",
    ", we consider the equivalent would - be equilibrium dust temperature @xmath68 of the dust mixture , found by solving the equation @xmath69 as a second parameter , we take the first - order moment @xmath67 , i.e.  the mean wavelength , @xmath70 in skirt we limit ourselves to two parameters , but in principle this procedure can be extended to more parameters .    with @xmath68 and @xmath71 calculated in each dust cell ,",
    "we construct a 2d rectangular grid with @xmath72 pixels in the @xmath73 parameter space , based on the range of values encountered in the present simulation . in every parameter space pixel",
    "we construct a reference isrf by averaging all isfrs that correspond to those particular values of @xmath68 and @xmath71 .",
    "we experimented with different ways of averaging , including taking the straight mean , the median or the mean using sigma - clipping , but found no noticeable difference .",
    "the final step of the library construction is to feed the reference isrfs to the dustem routine , and save each of the resulting dust emissivity profiles in the library .",
    "once the library is constructed , finding the correct dust emissivity for a given dust cell is straightforward , as each dust cell is already connected to a certain pixel in the @xmath74 parameter space and hence a dust emissivity profile in the library .",
    "while the very first version of skirt were written in fortran  77 , the code is now completely written in ansi c++ and currently contains some 30000 lines of code .",
    "it uses the object - oriented nature of the c++ language extensively to support a strong modularity .",
    "the use of inheritance and abstract classes renders the inclusion of new components ( such as new density distributions for the stars or dust , or new dust mixtures ) straightforward .",
    "the dustem code is written in fortran  95 and has been slightly adapted to be coupled to skirt .",
    "the entire skirt code is driven by a graphic user interface written in pyqt .",
    "batch jobs can be run using a command line version with xml input files .",
    "an important implementation aspect of skirt is the parallelism .",
    "parallelism can typically work on two domains : data parallelism focuses on distributing the data across different parallel computing nodes , with the principle aim of enabling simulations that need more memory consumption than is available on a single node . task or control parallelism focuses on distributing execution processes ( threads ) across different parallel computing nodes with the principle aim of decreasing the run - time of a program .",
    "ideally , both approaches can be combined .",
    "monte carlo radiative transfer codes are easily parallelized in a task parallelism approach : the different levels of iterations can easily be split over different nodes .",
    "skirt uses the openmp protocol to support task parallelism on shared - memory machines .",
    "one of the advantages of openmp parallelism is the spectacularly low coding cost : less than 100 lines of code ( on a total of 30000 ) have been added to skirt to convert it from a serial into a parallel code .",
    "the main parallelism is situated in the loop over wavelength , which implies that skirt runs both the stellar and dust phases at different wavelengths simultaneously .",
    "one of the planned future developments of skirt is to look into the possibilities of using the mpi interface for data parallelism , in order to allow monte carlo simulations to be run on distributed memory systems .",
    "data parallelism is much harder to achieve for monte carlo simulations than task parallelism .",
    "the main reason is the non - local nature of the physical problem : each photon package in a simulation typically requires data from the entire physical domain ( read access to calculate the optical depth and write access to update the absorption rates ) .",
    "contrary to e.g.  grid - based hydrodynamic codes , distributing the dust cells over different parts of memory would imply an enormous overhead in communication between the different nodes . in principle , data parallelism could be achieved by splitting the data in the wavelength dimension , where different nodes contain different parts of the absorption rate counters of the dust grid and different parts of the detectors . however , in this approach a large amount of data ( such as the dust density grid ) would need to be shared / copied between the different nodes and communication overheads would be significant in the dust emission phase .",
    "future work will investigate whether the benefits of distributed - memory parallelism can outweigh the communication overheads and the significant additional coding complexity .",
    "we have run extensive tests to check the accuracy of the skirt code against other radiative transfer codes .",
    "the early versions of the code were already tested against several other results , most importantly the set of spiral galaxy models by @xcite ( see e.g. * ? ? ? * ) .",
    "we have successfully tested the lte version of skirt against the 1d and 2d lte circumstellar benchmark problems of @xcite and .",
    "skirt is also one of the codes used in a new ongoing lte benchmark effort focusing on a disc galaxy environment ( baes et al .  2011 , in preparation ) .",
    "the preliminary results , based on the results from five independent radiative transfer codes indicate excellent agreement , with relative differences in the seds around the 1% level or even below .    as a full nlte",
    "radiative transfer benchmark is not ( yet ) available at the moment , we have tested our nlte radiative transfer code , and particularly the library approach , using different models with gradually increasing levels of complexity . in order to run simulations in a realistic setting",
    ", we adopt the sbc galaxy ugc4754 as a template model .",
    "ugc4754 is a edge - on spiral galaxy , which has always been a favorite class of galaxies for radiative transfer modellers , as the dust is clearly visible both in absorption and emission .",
    "this galaxy was one of the first large edge - on galaxies to be observed with the herschel space observatory as part of the herschel astrophysical terahertz large area survey ( h - atlas , * ? ? ? * ) science demonstration phase observations . in , we fitted a radiative model to the observed images of ugc4754 in the sdss and ukidss bands .",
    "we subsequently used the skirt code to predict the galaxy s sed and images at fir wavelengths . while the radiative transfer model used in that paper was sufficient to serve its goal ( investigation of the dust energy balance ) , it suffered from two significant limitations : the assumptions of lte dust emission and of a smooth interstellar medium .",
    "these two assumptions prevented us from making a self - consistent model covering the entire spectral region from the uv to mm wavelengths .",
    "moreover , they also might introduce a significant source of uncertainty , as it has been demonstrated by several authors that the extinction properties of a clumpy interstellar medium can be significantly different from those of a smooth medium .    in this section",
    "we will gradually refine our model for ugc4754 from a smooth , 2d , lte model to a fully 3d model that includes nlte dust emission and a clumpy structure of the dusty ism .",
    "the main objectives are to test the accuracy of our approach using a realistic setting , and to demonstrate the ability of skirt to run realistic 3d nlte radiative transfer calculations . for a full investigation of the dust energy balance in spiral galaxies , based on our refined skirt code and multi - wavelength imaging data ,",
    "we refer to future work .",
    "the starting point for our models is the best fitting , smooth 2d model from .",
    "the stellar distribution consists of two components : a double - exponential stellar disc with a scale length of 4.05  kpc and a scale height of 330  pc , and a flattened srsic bulge with a major axis effective radius of 800  pc , a srsic parameter of 0.9 and an intrinsic flattening of 0.6 .",
    "both components have a similar intrinsic sed , corresponding to a population of 8 gyr old with an exponentially decaying star formation rate and an initial burst duration of 0.15 gyr .",
    "the total bolometric luminosity of the system is @xmath75 , of which the bulge contributes 8% .",
    "the dust is also distributed in a double - exponential disc with a scale length of 6.1  kpc and a scale height of 270  pc .",
    "the total amount of dust is characterized by the @xmath76-band edge - on optical depth of 0.73 , which corresponds to a total dust mass of @xmath77 .",
    "contrary to where we used the @xcite model to describe the dust optical properties , we now use the @xcite dust model , as this model is embedded in the dustem library .",
    "simulations are run on a wavelength grid with 181 grid points , with 101 grid points distributed logarithmically beween 0.05 and 5000  @xmath78 m and 80 additional grid points distributed logarithmically between 1 and 30  @xmath78 m to capture the pah peaks . for our 2d simulations , we considered an axisymmetric grid with 51 grid points in the radial direction and 51 grid points in the vertical direction , resulting in a total number of @xmath79 grid cells .",
    "the grid points are chosen to have a power - law distribution , with an extent of 30  kpc ( 2  kpc ) for the radial ( vertical ) distribution and a size ratio of 30 between the innermost and outermost bins . in all skirt",
    "runs discussed here , we used @xmath80 photon packages for each wavelength in both the stellar and the dust emission phase .",
    "figure  [ totalsed.pdf ] shows the resulting seds of two different skirt 2d simulations based on this model setup , as well as the observed galex , sdss , ukidss , iras and herschel fluxes for ugc4754 .",
    "the blue curve shows the sed corresponding to a model assuming lte dust re - emission , where we took into account that different grain types and sizes reach different equilibrium temperatures .",
    "the black curve shows the sed of the model that includes nlte dust re - emission using the library approach discussed in section  [ dustemissivity.sec ] .",
    "the red curve represents the flux of the model without dust extinction , the yellow line corresponds to the contribution of the dust to the sed in the nlte case .",
    "it is logical that there is no difference between the lte and nlte models in the uv / optical / nir part of the sed , as only the dust emissivity differs between the models .",
    "there is , however , a significant difference between the lte and nlte models in the mir / fir / submm window : in the lte models , all absorbed radiation is re - emitted as modified blackbody emission in the fir / submm region , whereas the nlte models emit part of the absorbed radiation in the mir region .     between the dust seds of 2d nlte models for ugc4754 using the brute force ( bf ) approach and the library ( lib ) approach.,scaledwidth=48.0% ]    to test the accuracy of our library approach , we ran a second nlte simulation , where we did not use the library approach , but where we calculated the dust emissivity in each cell by an explicit call to the dustem code .",
    "the relative difference between the seds of the skirt nlte models using the library approach and the brute force approach is shown in figure  [ bruteforce.pdf ] .",
    "this figure convincingly shows that the library approach is accurate : the relative error is everywhere below 0.2% and in the region where the dust emission dominates even smaller .",
    "the difference in run time between the two approaches is substantial , and this difference is only due to the difference in the number of calls to the dustem routine . in the brute force approach ,",
    "the number of calls is obviously equal to @xmath81 ( or sometimes a bit less if there are empty dust cells ) .",
    "the maximum number of calls to the dustem routine in the library approach is obviously @xmath72 , the number of pixels in the library parameter space . as the intensity of the isrf is the main parameter that drives the shape of the dust emissivity spectrum , it is appropriate to choose @xmath82 somewhat larger than @xmath83 ; the values we propose are @xmath84 and @xmath85 .",
    "this infers a maximum of 250 calls to the dustem routine . in most cases ,",
    "however , not the entire @xmath73 parameter space is covered , such that the number of calls is even further reduced . in the present simulation , we needed to call the dustem routine only 71 times in the library approach , compared to 2500  times in the brute force approach .",
    "given that the average dustem run time is about 7  s ( on a typical desktop computer ) and that the overhead of the construction of the library is negligible , this makes a substantial difference .",
    "it should be noted that 2500 calls is still a very manageable number , but the brute force approach becomes impossible when moving to 3d grids with several million cells .",
    "for example , for a simulation with ten million dust cells , we would need a dustem computation time of more than 2 years on a single core computer , compared to several minutes using the library approach .     between the dust seds using the mw isrf template ( tem ) approach and our library ( lib ) approach.,title=\"fig:\",scaledwidth=48.0% ]    between the dust seds using the mw isrf template ( tem ) approach and our library ( lib ) approach.,title=\"fig:\",scaledwidth=48.0% ]    as a final test and a demonstration of the necessity of our library approach , we ran our 2d simulation again , but now using a set of precomputed template emissivity profiles . in a sense",
    "this mimics the approach taken by e.g.  @xcite , although their approach is somewhat different as they calculate the emission by big grains using the lte approximation and only use a template for the small grains .",
    "the basic idea of our template approach is that the dust emissivity from a cell depends only on a single parameter @xmath86 , being the integrated mean intensity of the isrf in the considered cell expressed in terms of the integrated mean intensity of the isrf in the milky way , @xmath87 for the isrf of the mw , the standard parameterization of is adopted .",
    "we constructed a library of 501 dust emissivity profiles , corresponding to values of @xmath86 distributed logarithmically between @xmath88 and @xmath89 .",
    "these dust emissivity profiles can be computed once and for all ( using the dustem routine ) and saved in a file . in the dust emission phase , we simply calculate @xmath86 in every dust cell and determine the dust emissivity profile using logarithmic interpolation between the precomputed library profiles .",
    "this approach definitely has a strong appeal : it is straightforward to implement and very fast , as it requires only the calculation of @xmath86 and a simple interpolation of precomputed values . in this sense",
    "it is more attractive than our library approach , which requires the construction of a library for every simulation .",
    "the disadvantage of the template approach , however , is that only the strength and not the shape or hardness of the isrf is taken into account to calculate the dust emissivity .",
    "as also argued by @xcite , the shape of the isrf can have a significant importance , both because of the differing cross - sections of grains of different sizes and because high - energy photons will excite larger thermal fluctuations than low - energy photons for a given value of @xmath86 .    in figure  [ milkywaylibrary.pdf ]",
    "we show the comparison of the fixed template approach and our dynamic library approach ( dynamic in the sense that the library is tailored to the specific simulation ) .",
    "the top panel shows the total sed and the dust emission sed for our 2d model for ugc4754 obtained using both approaches . at first sight ,",
    "the seds agree fairly well ( definitely when plotted in log - log scale ) .",
    "looking at the bottom panel , where we plot the relative difference of the dust emission sed corresponding to both approaches , we do see a significant difference , with relative deviations up to more than 40% .",
    "here we have to give an important side note , in the sense that we believe that this 40% difference is actually a underestimate of the error one can make .",
    "the shape of the intrinsic sed of the stellar population in our model is independent of position ; as a result , the variations in the shape of the isrf in different cells in the simulation are only the result of varying levels of absorption and scattering .",
    "since the stellar population model we adopted for ugc4754 ( an 8  gyr old population with an exponentially decaying star formation rate and an initial burst duration of 150 myr ) is not very different from the average stellar population in the milky way , this implies that the shape of the isrf in the different cells in our model will on average be quite close to the shape of the milky way isrf .",
    "as far as the comparison between our library approach and the milky way template approach concerns , we must hence conclude that ugc4754 simulations are not the strongest test . for systems with isrfs",
    "which deviate much more from the average milky way isrf , such as starburst galaxies or circumstellar discs around young hot stars , we expect much larger differences than the 40% we obtained here .",
    "having tested the accuracy of our library approach , we are ready to run full - scale 3d nlte radiative transfer models with skirt .",
    "the first 3d model we consider has exactly the same set - up as the 2d nlte model , except that we now consider a uniform 3d cartesian grid . in the @xmath90 and @xmath91 directions",
    "we consider 401 grid points each and a maximum extent of 30  kpc , in the vertical direction we use 61 grid points with a maximum extent of 2  kpc .",
    "this results in @xmath92 grid cells , each with a dimension of 150  pc in the @xmath90 and @xmath91 directions and 66.7  pc in the vertical direction .",
    "note that we need to store , at each dust grid cell , the entire isrf @xmath66 at each of the wavelength grid points , which basically turns our grid into a 4-dimensional grid structure with @xmath93  grid cells .",
    "the memory required to run such a large - scale skirt radiative transfer simulation is about 23  gb .     between the seds of 2d and 3d nlte models for ugc4754 .",
    "the red curve corresponds to a 3d model with a uniform cartesian dust grid in all three dimensions , the blue curve corresponds to a 3d model with a power - law grid in the vertical direction , similar to the vertical grid structure of the 2d model.,scaledwidth=48.0% ]    figure  [ compare2d3d.pdf ] compares the sed of the smooth 2d and 3d models for ugc4754 .",
    "the relative differences are below 2% in the entire uv - mm domain .",
    "the existing small differences are mainly due to the discretization of the grid in the vertical direction : for the 2d model we used a vertical grid with a power - law distribution , with smaller bins close to the equatorial plane , where the dust density has the strongest gradients .",
    "the innermost grid cell has a height of only 8.75  pc , compared to the 66.7  pc in the case of the 3d grid .",
    "the result is that the discretization of the dust density on the 3d grid is much coarser . to demonstrate that this vertical grid distribution is the origin of this @xmath94 difference , we ran another 3d simulation where we now apply the same power - law distribution for the vertical grid cells as we did for the 2d model .",
    "the relative differences between the sed of this model and the sed of the 2d simulation are also indicated in figure  [ compare2d3d.pdf ] .",
    "the reason why we considered a uniform cartesian dust grid is because such a grid forms the basis for a fully 3d model with a clumpy , two - phase dust distribution . to generate such a model",
    ", we followed the strategy outlined by @xcite .",
    "the dusty interstellar medium consists of two phases , a smooth inter - clump component and a clumpy component , and is characterized in terms of two parameters , namely the volume filling factor _",
    "ff _ of the dense clumps and the density contrast @xmath95 between the clump and inter - clump medium .",
    "the practical construction of the two - phase medium consists of randomly assigning a status ( clump or inter - clump ) to each dust cell in the dust medium .",
    "typical values for the parameters @xmath95 and _ ff _ vary widely in the literature .",
    "we use the values @xmath96 and @xmath97 in this work , which are within the range of typical parameters used in other studies ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) .         between the seds of clumpy and smooth 3d nlte models for ugc4754.,scaledwidth=48.0% ]    in figure  [ clumpysmooth.pdf ]",
    ", we show simulated images corresponding to the clumpy and smooth 3d models for the inner region of ugc4754 at three different wavelengths ( 0.55 , 24 and 500  @xmath78 m ) .",
    "it is important to note that the pixel - to - pixel variations in the images on the bottom row are not due to poisson noise in the monte carlo routine , but represent real intensity variations due to the clumpy nature of the dust in the models .",
    "figure  [ compareclumpysmooth.pdf ] compares the total sed of the clumpy and smooth models .",
    "the relative differences are below 6% in the entire uv - mm domain . at uv wavelengths ,",
    "the clumpy model is slightly brighter than the smooth model , or put differently , slightly less uv radiation is absorbed by the dust .",
    "this is in agreement with conclusions found by other authors : for a fixed amount of dust , a clumpy dust medium absorbs radiation less efficiently than a smooth dust medium ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "when moving to longer wavelengths , the difference between the smooth and clumpy models decreases , as the fraction of absorbed versus unattenuated radiation decreases with increasing wavelength . at nir wavelengths , there is virtually no difference anymore between the seds of the smooth and clumpy models . moving to mir and fir wavelengths",
    ", we find that the clumpy model emits significantly less , particularly at wavelengths up to about 100  @xmath78 m .",
    "this is no surprise , as the clumpy model was less efficient in absorbing uv and optical radiation .",
    "the result is that , for the same total mass , the dust in a clumpy model is on average both cooler and less luminous than the dust in a smooth model .",
    "we have presented an updated version of the 3d monte carlo radiative transfer code skirt .",
    "the code uses various advanced optimization techniques , both well - known and novel ones , that make the monte carlo process orders of magnitude more efficient than the most basic monte carlo technique .",
    "these techniques include an optimized combination of eternal forced scattering and continuous absorption , a multi - gaussian expansion technique and an efficient foam generator to generate random positions from the stellar density , and the use of peeling - off and smart detectors to create high signal - to - noise images and seds .",
    "the main novelty of the new skirt code is the possibility to calculate the dust temperature distribution and the associated infrared and submm emission with a full incorporation of the emission of transiently heated grains and pah molecules . to achieve this",
    ", we have chosen to link the skirt code to dustem , a publicly available , state - of - the - art numerical tool designed to calculate the nlte emission of arbitrary mixtures of dust grains .",
    "the advantages of this approach is that no lte approximation is made , even for large grains , and that new physics ( such as spinning dust emission or a temperature - dependent dust emissivity ) can readily be included .",
    "we have implemented a library approach to limit the computational cost of the nlte dust emission calculations inherent in dustem .",
    "our approach is inspired by the work by , but uses a slightly different approach that makes maximum use of all information in the simulation to calculate the dust emissivity and avoids the need for additional low - resolution simulations .",
    "we have tested the accuracy of the skirt code , in particular of our nlte library approach , through a set of simulations based on the edge - on spiral galaxy ugc 4754 , previously modelled by .",
    "the models we ran were gradually refined from a smooth , 2d , lte model to a fully 3d model that includes nlte dust emission and a clumpy structure of the dusty ism .",
    "using 2d models , we demonstrated the accuracy of our library approach : the relative differences in the sed between a model that uses the library approach and a model that uses brute force to calculate the dust emission are less than 0.2% at all wavelengths .",
    "even for this 2d model with only 2500 dust cells , the difference in run time between both approaches are substantial ; for 3d grids with several million dust cells the brute force approach becomes impossible .",
    "we have also explored the possibility to use a fixed set of precomputed dust emission templates instead of a dynamic library as the one we have chosen .",
    "while a template approach has the advantage that it is easier to implement and faster to run , we have demonstrated that it leads to significant deviations due to the fact that it does not take into account the shape of the interstellar radiation field .",
    "this highlights the need for a more advanced approach such as the library approach we propose .",
    "we have subsequently applied the skirt code to calculate full - scale 3d nlte models for ugc 4754 .",
    "we found small differences ( @xmath98% ) between 2d and 3d smooth models that are mainly due to differences in the vertical discretization of the internal grid .",
    "finally , we have compared 3d models with a smooth and a clumpy interstellar dust medium .",
    "we confirm the result found by other authors that , for a fixed amount of interstellar dust , a clumpy dust medium absorbs radiation less efficiently than a smooth dust medium . as a direct consequence ,",
    "the dust in clumpy models is on average both cooler and less luminous , and the observed infrared emission of clumpy models is less than the emission at these wavelengths of smooth models with the same dust mass .",
    "our simulations demonstrate that , given the appropriate use of optimization techniques , it is possible to efficiently and accurately perform monte carlo radiative transfer simulations of arbitrary 3d structures of several million dust cells , including a full calculation of the nlte emission by arbitrary dust mixtures .",
    "this significantly increases the number of applications where detailed radiative transfer modeling can be used .",
    "for example , we have started an investigation of the energy balance crisis in a set of edge - on spiral galaxies : our intention is to fit detailed radiative transfer models to uv / optical / nir images for a set of edge - on spiral galaxies , predict the resulting mir / fir / submm emission and compare these predictions with the available long wavelength data .",
    "many other applications ( agns , circumstellar discs , merging galaxies ,  ) are possible , and the authors welcome all projects that can make use of skirt ."
  ],
  "abstract_text": [
    "<S> we present an updated version of skirt , a 3d monte carlo radiative transfer code developed to simulate dusty galaxies </S>",
    "<S> . the main novel characteristics of the skirt code are the use of a stellar foam to generate random positions , an efficient combination of eternal forced scattering and continuous absorption , and a new library approach that links the radiative transfer code to the dustem dust emission library . </S>",
    "<S> this approach enables a fast , accurate and self - consistent calculation of the dust emission of arbitrary mixtures of transiently heated dust grains and polycyclic aromatic hydrocarbons , even for full 3d models containing millions of dust cells . </S>",
    "<S> we have demonstrated the accuracy of the skirt code through a set of simulations based on the edge - on spiral galaxy ugc4754 . </S>",
    "<S> the models we ran were gradually refined from a smooth , 2d , lte model to a fully 3d model that includes nlte dust emission and a clumpy structure of the dusty ism . </S>",
    "<S> we find that clumpy models absorb uv and optical radiation less efficiently than smooth models with the same amount of dust , and that the dust in clumpy models is on average both cooler and less luminous . </S>",
    "<S> our simulations demonstrate that , given the appropriate use of optimization techniques , it is possible to efficiently and accurately run monte carlo radiative transfer simulations of arbitrary 3d structures of several million dust cells , including a full calculation of the nlte emission by arbitrary dust mixtures . </S>"
  ]
}