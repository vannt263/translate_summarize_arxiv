{
  "article_text": [
    "x - ray data are generally very sparse in nature . to deal with this problem ,",
    "astronomers are often forced to either bin or smooth their data .",
    "the most commonly used techniques are simply binning to square blocks of a fixed size or convolving with a fixed kernel .",
    "however , due to the large dynamic range in many extended objects , ordinary binning and smoothing techniques are never able to capture structure on large scales without masking detail on smaller scales .",
    "this deficiency is the motivation for spatially adaptive algorithms .    with the advent of the two major x - ray satellites , _",
    "chandra _ and _ xmm - newton _ , it is now possible to resolve fine morphological structures in extended x - ray emitting sources , such as galaxies , clusters , or supernova remnants .",
    "this calls for new techniques to reliably extract spatial information .",
    "* hereafter sf01 ) were the first to answer with a 2-dimensional adaptive binning algorithm , applicable to background - corrected intensity images and hardness ratio maps .",
    "however , this algorithm is restricted to a limited set of bin sizes , which prevents it from being fully adaptive and from adjusting its resolution so as to keep the signal - to - noise ratio ( s / n ) constant .",
    "this creates jumps in s / n of a factor of @xmath0 , which , along with its quadrilateral bin shapes , can lead the eye and suggest structure that is not there .    motivated by the different problem of analysing 2-dimensional optical integral field spectroscopic data , ( * ? ? ?",
    "* hereafter cc03 ) developed an innovative adaptive binning technique using voronoi tesselations .",
    "their algorithm is able to smoothly adjust the bin size to the local s / n requirements and does not impose a cartesian geometry on the image .",
    "unfortunately , it can be used only with strictly positive , poissonian or optimally weighted data whose s / n is guaranteed to add in quadrature .",
    "this prevents it from being useful in even simple situations in x - ray astronomy , involving data corrected for exposure map effects or background , or in creating hardness ratio maps .    in this paper , we generalise cc03 s voronoi binning technique so that it can be used with any type of data .",
    "the generalised algorithm makes use of weighted voronoi tesselations ( wvt ) , and combines the virtues of both cc03 s and sf01 s techniques .",
    "it is as robust as , and even more versatile than , sf01 s code , yet retains the advantage of cc03 s flexible bin sizes . the algorithm produces smoothly varying binning structures that are geometrically unbiased and do not lead the eye .    in section [ existingabinning ] of this paper ,",
    "we review the two binning techniques of sf01 and cc03 in more detail , pointing out their advantages and drawbacks . in  [ wvtbinning ] , we explain the functionality of the generalised wvt binning technique , and compare its performance to the two older algorithms in section [ performance ] .",
    "section [ applications ] then demonstrates the utility of wvt binning in creating x - ray intensity images , hardness ratio maps , and temperature maps , and in disentangling the diffuse gas emission in elliptical galaxies from the contribution of unresolved point sources .",
    "finally ,  [ asmoothcomparison ] quantitatively compares wvt binning to commonly used adaptive smoothing algorithms , before commenting on the availability of the code in section [ availability ] and ending with conclusions in  [ conclusions ] .",
    "the pivotal work on spatial binning of sparse x - ray data is that of sf01 , who produce surface brightness and colour maps for the analysis of x - ray cluster images .",
    "their algorithm starts with the smallest possible bin size of @xmath1 pixel and calculates the s / n for each bin .",
    "each bin with a s / n higher than the user supplied minimal value @xmath2 is marked as binned , its pixel members are removed from the pixel list , and ignored for the rest of the binning process . in the next iteration , the unbinned pixels are rebinned with square bins of double the side length .",
    "the s / n of each bin is computed , and those exceeding the threshold are marked .",
    "this process is repeated until either all pixels are binned or the bin size exceeds the image size .",
    "thus , the bins are generally square , with areas of @xmath3 pixels , except for regions at the transition between two binning levels .",
    "there , some pixels may have already been binned on a previous level and removed .",
    "the resulting bin shapes can be rectangular , l - shaped , or more complicated .",
    "even non - contiguous bins are common .    owing to its hierarchical structure , which resembles a quadratic tree commonly used in n - body simulations , we refer to this method as `` quadtree '' binning .",
    "although slightly different implementations are conceivable , we take sf01 s version as representative . in section [ comparison_qt ] , we make a rigorous quantitative comparison between this algorithm and wvt binning .      motivated by the need to optimally bin integral - field spectroscopic data ,",
    "cc03 present a method to spatially bin two - dimensional images using voronoi tesselations .",
    "the goal is again to obtain a uniform s / n per bin over the image , while keeping each bin as compact as possible .",
    "a voronoi tesselation ( vt ) is a partitioning of a region , defined by a set of points called the generators .",
    "each point in the region , or in this case , each pixel in the image , is assigned to the generator to which it is closest . as a consequence of this scheme ,",
    "the boundary between two adjacent bins is always the perpendicular bisector of the connecting line between the two generators ( figure [ wvt ] ) .",
    "a subset of vts , called centroidal voronoi tesselations ( cvts ) , has the additional property that the generators coincide with the centroids of the bins .",
    "cvts are meaningful when there is a density , @xmath4 , defined over the region to be binned , and the generators are the density - weighted bin centroids . since the centroids can not be calculated before the bins themselves are constructed , it is necessary to construct a cvt by iteration .",
    "a helpful tool is the lloyd algorithm @xcite , which iteratively constructs cvts with generators at each iteration taken as the centroids from the previous step .",
    "the lloyd iterations have the desirable effect of moving generators into regions of higher density , thereby creating smaller bins . for a uniform density",
    ", this algorithm tends to create hexagonal lattice structures @xcite .    in binning an image , one generally works with a signal @xmath5 per resolution element @xmath6 ( `` pixel '' from now on ) and the associated noise per pixel , @xmath7 .",
    "one can compute the s / n of a bin @xmath8 as @xmath9 for pure poisson statistics , or certain forms of optimal weighting , the @xmath10 is additive ( cc03 ) . with this restriction",
    ", one can make use of a property of the lloyd algorithm known as gersho s conjecture : applying the lloyd algorithm to the square of the density tends to produce a configuration with equal mass per bin @xcite .",
    "cc03 exploit this conjecture by applying the lloyd algorithm to the quantity @xmath11 , thus producing a cvt with a constant s / n per bin .    in order for the lloyd algorithm to converge , a good initial set of generators",
    "is necessary .",
    "cc03 solve this problem with a `` bin - accretion '' algorithm . starting from the pixel with the highest s /",
    "n in the input image , one grows a bin by accreting nearest neighbours until the bin reaches a minimum s / n or violates an imposed `` roundness '' criterion .",
    "then the next bin is started from the pixel closest to the weighted centroid of all previously binned pixels .",
    "this method is guaranteed to generate compact bins within the desired s / n range .",
    "bins that do not meet both of these criteria are marked as `` bad '' and their pixels are reassigned to the next closest bin .",
    "the centroids of the resulting bins are then used as the initial set of generators for the lloyd algorithm .    by definition ,",
    "a voronoi tesselation can produce neither gaps in the data nor non - contiguous bins .",
    "the tesselation adjusts to uneven boundaries smoothly , and the cc03 algorithm generally converges to a solution with small , spatially independent scatter around the target s / n .",
    "the bins are usually very compact , but can get more elongated or ragged close to the boundaries , or in regions with very strong s / n gradients .",
    "the principal drawback of cc03 s algorithm lies in its applicability .",
    "the algorithm works only for data in which s / n adds in quadrature , as the iterative part is based on gersho s conjecture .",
    "this precludes the possibility of applying the code to background - corrected or exposure - corrected data , hardness ratios , or other types of data where @xmath10 is not additive .",
    "as described above , a normal vt assigns each pixel @xmath6 to the generator @xmath12 to which it is closest ; i.e. , one finds the bin to which the pixel belongs by minimising its distance to the generator @xmath13 over all bins @xmath14 . in order to make this definition more flexible , we use a generalisation known as a weighted voronoi tesselation ( e.g. , * ? ? ?",
    "in a wvt , each bin @xmath14 has an associated scale length @xmath15 in addition to its generator @xmath12 , and a pixel @xmath6 is assigned to the bin that minimises @xmath16 .",
    "one can picture @xmath15 as a factor that stretches or compresses the metric inside the bin @xmath14 .",
    "an intuitive analogy is simultaneous crystal growth , with the generators representing the seeds and the scale length representing the growth rate @xcite .",
    "a wvt is completely described by its set of generators and scale lengths and can therefore be stored very efficiently .",
    "figure [ wvt ] illustrates the appearance of a wvt ( right ) with a simple example of bins with different relative scale lengths , and compares it to an unweighted vt with the same generators ( left ) .",
    "note how the bin boundaries move closer to the generators with the smaller associated scale lengths , making their bins rounder and more compact .",
    "for wvts , the boundaries @xmath17 between two bins @xmath14 and @xmath18 always fulfill the equation @xmath19 , implying that the ratio of the bin radii is equal to the ratio of scale lengths .",
    "this property is used below to modify the bin sizes by manipulating their relative scale lengths and letting the generator locations adjust .",
    "this replaces the gersho prescription which changes the bin sizes by explicitly moving the generators .",
    "( crosses ) .",
    "the numbers attached to the bins are the associated scale lengths @xmath15 .",
    "the dashed lines connect neighbouring bin generators .",
    "note how the bin boundaries are always perpendicular to them . for a normal vt ,",
    "the bin boundaries are the perpendicular bisectors ; for a wvt , the dashed lines are divided proportional to the respective scale lengths.[wvt],width=317 ]      in the following discussion , we assume that there is some general way to combine the signal and noise of various pixels to calculate the resulting s / n for the bins .",
    "we emphasise that the details of how the s / n is actually calculated are irrelevant for the functionality of the wvt binning algorithm .",
    "our algorithm creates a weighted voronoi tesselation , choosing the scale lengths @xmath15 such that the bins have a near - uniform s / n distribution , with the least possible scatter around the target signal - to - noise @xmath20 . to find the appropriate scale lengths , it is useful to consider the quantity @xmath21 , defined by @xmath22 where @xmath23 is the bin area and @xmath24 is the s / n ratio in bin @xmath14 .",
    "the algorithm is aiming for a configuration where the bins have a s / n equal to the target value , @xmath20 . in this configuration , we should have , approximately , @xmath25 where @xmath26 is a dimensionless constant that depends weakly on bin shape ( for circular bins , @xmath27 ) . combining equations ( [ mu ] ) and ( [ mu2 ] )",
    "gives a rule for setting the scale length at each iteration : @xmath28 since the binning depends only on the ratio of the scale lengths , the value of @xmath26 is unimportant .",
    "we show below that good results are obtained taking @xmath29 for all bins , regardless of shape .",
    "this prescription replaces the gersho - lloyd procedure which , at each iteration , moves the generators to the @xmath10 weighted centroids .",
    "such weighting is superfluous in our algorithm , so we adopt the geometric bin centres as the new generators .",
    "the wvt binning procedure thus proceeds as follows :    1 .",
    "start with an initial wvt .",
    "2 .   for each bin @xmath14 , evaluate the signal to noise @xmath24 , the area @xmath23 and the geometric centres @xmath12 .",
    "[ loopstart ] 3 .",
    "calculate the scale length @xmath15 for each bin according to equation ( [ delta ] ) .",
    "4 .   reassign all pixels according to the new wvt with generators @xmath12 and scale lengths @xmath15 .",
    "return to step ( ii ) until the bins stop changing significantly .",
    "a binning with constant s / n across the field is a natural stable fixed point of this iteration scheme , as it satisfies the relation @xmath30 .    as in ordinary voronoi binning",
    ", this algorithm requires a good set of initial generators .",
    "we adopt cc03 s solution of `` bin accretion '' with a few modifications for speed , relaxing some acceptance criteria to suit sparse and not strictly positive data ( e.g. background subtracted x - ray images ) .",
    "we also employ a soft lower s / n boundary for accepting bins , in which the s / n has no longer to be larger than the fixed target s / n . instead , accretion terminates if the addition of another pixel would increase the scatter around the target s / n .",
    "this modification keeps the average s / n closer to the target value .",
    "while the simplicity of the quadtree binning algorithm makes it easy to understand and apply , there are several disadvantages , which we illustrate in this section using simulated x - ray data . a suitable model for the surface brightness profiles @xmath31 of a galaxy or galaxy cluster is the circular @xmath32model @xcite : @xmath33^{0.5 - 3\\beta}+i_{bg},\\ ] ] where @xmath34 is the central surface brightness",
    ", @xmath35 is the core radius , @xmath32 is a slope parameter , and @xmath36 is an additive , flat background .",
    "we adopt the same parameters used by sf01 : the image size is set to @xmath37 pixels , @xmath35 is @xmath38 pixels , @xmath34 is @xmath39 , @xmath32 is @xmath40 and @xmath36 is @xmath41 .",
    "the simulated x - ray image is obtained by populating the image with counts according to a poisson distribution .",
    "for the quadtree algorithm , a minimum s / n limit of @xmath42 ( @xmath43 ) produces an average @xmath44 of @xmath45 in the test image and is therefore chosen as the equivalent to a target s / n of 20 for the comparison with the wvt algorithm .",
    "the results of the quadtree and wvt binning algorithms are shown on the left and right sides of figure [ fracdiff ] , respectively .",
    "the middle panels show the full images ; the upper panels zoom in on a small region to emphasise the differences between the binning structures .",
    "note that the quadtree algorithm regularly forms non - contiguous bins and can leave single pixels or small sets of pixels `` stranded '' . in a few cases , these pixels can be directly picked out as isolated dark spots in the image , since a larger binning level usually also corresponds to a lower average flux per bin .",
    "this effect occurs predominantly in regions where neighbouring pixels have already been binned on a previous binning level .",
    "sf01 offer two ways to deal with this problem .",
    "the first is to handle isolated sets of pixels of a non - contiguous bin separately , violating the minimum s / n criterion as the bin is being split up .",
    "the alternative is to redistribute the pixels to an adjacent neighbour bin . in the latter case ,",
    "the s / n of the neighbouring bin will be elevated , which can lead to an increased scatter in s / n . at the same time , one sacrifices resolution , as the effective number of bins is decreased . throughout the remainder of this discussion , we do not enforce contiguous bins in the quad - tree algorithm for simplicity .",
    "we simply note that this problem is absent in the wvt algorithm , which can easily be made to enforce contiguous bins .",
    "the main problem with the quadtree algorithm lies in its small set of discrete bin sizes . except in small transition regions , where the bin shapes are not square , the bin area",
    "is restricted to values of @xmath3 pixels .",
    "this discontinuous distribution of bin sizes is visible in the binned image , and illustrated in the upper panels of figure [ quadfig ] , which show the radial dependence of the bin areas for quadtree ( left ) and wvt ( right ) binning .",
    "the solid line indicates the optimal , theoretical bin size needed to produce the target s / n .",
    "the discrete steps in the quadtree bin area translate into an inhomogeneous s / n distribution , shown in the lower left panel of figure [ quadfig ] .",
    "each sharp increase in s / n corresponds to a sudden jump in bin size , which decreases the local resolution beyond the requirements of the target s / n .",
    "these jumps in s / n are easily visible as circular rings in the fractional difference image in the bottom left of figure [ fracdiff ] , showing that the binning algorithm can create spurious structure .",
    "in contrast , wvt binning allows bins to adjust their size smoothly in single pixel steps , which results in a reduced scatter around the target s / n and the removal of misleading spurious features ( bottom right panels of figures [ fracdiff ] and [ quadfig ] ) .",
    "the spatially correlated fractional error distribution resulting from quadtree binning can be particularly misleading when the the bin value is decoupled from the actual s / n distribution .",
    "an good example is a hardness ratio map . here",
    ", the signal is given by a flux ratio of two independent bandpasses , whereas the s / n is determined by the total flux of both bands .",
    "figure [ color_perseus ] show quadtree and wvt binned hardness ratio maps of the perseus cluster .",
    "the eye identifies two concentric rings in the quadtree binned map ( left ) at around 50 and 150 arcsec .",
    "these features are imprints of the discontinuous jumps in bin size , and are completely absent in the wvt binned map ( right ) .",
    "wvt binned hardness ratio maps are described in more detail in  [ hardnessratiomaps ] .",
    "as the wvt algorithm generalises the method of cc03 , which was designed for optical integral field spectroscopic data , it is natural to test the code on the same type of data .",
    "we apply our wvt binning algorithm to the test data provided by cappellari & copin , in their on - line code release .",
    "the test data consist of a list of coordinates and signal and noise values of the wavelength - integrated spectra of a sauron @xcite observation of ngc 2273 .",
    "figure [ cappvswvt ] compares the results of both algorithms for a target s / n of @xmath46 .",
    "both yield consistent results with a comparable scatter around the target s / n of only @xmath47 .",
    "the only noticable difference lies in the compactness of the individual bins , especially close to the border and in regions of strong gradients .",
    "while cc03 s code tends to generate strongly elongated shapes in these cases , the wvt bins stay consistently rounder . to quantitatively measure roundness , we introduce the average bin radius @xmath48 and the effective bin radius @xmath49 : @xmath50 @xmath51 the more compact the bin , the smaller is the ratio @xmath52 .",
    "its minimum at a value of @xmath53 represents a perfectly circular bin .",
    "figure [ roundness_cvt ] shows @xmath54 as a function of the distance from the galaxy centre and confirms that the wvt algorithm ( filled circles ) produces more compact bins without edge effects . at a distance of 20 arcsec , cc03 s voronoi bins ( open circles ) get more elongated , as shown by the jump in @xmath55 .",
    "this is mainly due to cc03 s use of a weighted bin centroid , which pushes the generators toward the bright end of the bin , elongating the bins in the opposite direction .        ,",
    "the most common application for adaptive binning in x - ray astronomy is intensity binning . as discussed above ,",
    "s voronoi binning algorithm is valid only for purely poissonian data .",
    "this would correspond to raw counts for a perfectly flat detector response without any background .",
    "however , real x - ray data are not as simple .",
    "many x - ray faint targets have surface brightness values comparable to the background , which itself may be spatially dependent .",
    "in addition , real observations exhibit strong variations in effective area per pixel , due to chip gaps , node boundaries , or partly overlapping multiple exposures .",
    "an observation s effective area @xmath56 per pixel @xmath6 is saved in an `` exposure map , '' which together with the effective exposure time @xmath57 , can be used to convert raw counts @xmath58 per pixel into a flux @xmath59 with physical units ; see http://cxc.harvard.edu/ciao/download/doc/expmap_intro.ps for more details on exposure maps .",
    "] of @xmath60 : @xmath61 here , @xmath62 is the background flux per pixel .",
    "the variance in the same pixel can be expressed as @xmath63 where @xmath64 denotes the uncertainty that is attached to the background value .",
    "the prescription for combining these quantities to produce a s / n per bin is given by equation ( [ addsn ] ) . for",
    "the hypothetical case where @xmath65 , @xmath66 and @xmath67 , the signal @xmath59 reduces to pure counts and the binning scheme will converge to a solution with a constant number of counts per bin .",
    "we use the well - known 50 ks _",
    "observation of cassiopeia a @xcite to demonstrate the power of adaptive binning for x - ray images .",
    "the lower left panel of figure [ casa ] shows the unbinned , exposure map corrected counts image for the full exposure . in the panel directly above , we restrict the data to only 1 ks of exposure time .",
    "we bin this image with the wvt algorithm to a target s / n of @xmath68 ( upper right ) .",
    "a comparison with the full 50 ks exposure shows that wvt binning successfully reduces the noise , bringing out the large - scale features in the outer parts of the image , while keeping the appropriate resolution in the better exposed filamentary features . even in this short exposure , one is able to pick out the central neutron star in the wvt binned image .",
    "the image in the lower right of figure [ casa ] shows the full 50 ks image , adaptively binned to a s / n of @xmath69 , to demonstrate the applicability of wvt binning to a different s / n regime .",
    "another useful tool in x - ray astronomy is the hardness ratio ( or `` colour '' ) map .",
    "the hardness ratio @xmath70 can generally be defined as the quotient between the fluxes @xmath71 and @xmath72 in two different bands @xmath73 and @xmath74 , summed over all pixels of the bin @xmath8 : @xmath75 the associated error can be expressed in terms of the noise in the individual bands : @xmath76 depending on the choice of energy bands , a hardness ratio map can be used as a diagnostic for any spectrally identifiable properties , such as temperature gradients or photoelectric absorption features ( e.g. sf01 ) .",
    "a general discussion about the physical interpretation of these maps , an appropriate choice of bands , and a generalisation to @xmath77 different bands can be found in sf01 or @xcite .",
    "we use the well - known 25 ks _ chandra _",
    "observation of the perseus cluster @xcite to demonstrate a wvt binned hardness ratio map .",
    "the right panel of figure [ color_perseus ] shows a colour map for the perseus cluster , in which bright colours indicate regions of lower temperature and/or lower photoelectric absorption .",
    "our choice of bands ( a : @xmath78kev , b:@xmath79kev ) shows both effects for illustrative purposes ; in principle , a different choice is able to separate these two properties .",
    "the sharp dark feature close to the centre is due to the photoelectric absorption `` shadow '' of an infalling dwarf galaxy in the line of sight @xcite . to the north - east of the centre",
    ", one can pick out a giant radio cavity , with cooler rims surrounding it .",
    "the smooth colour gradient toward the centre also supports a cooling flow model ( see e.g. * ? ? ? * ) and the `` swirl '' of the bright emission has been interpreted as a sign for angular momentum of the infalling gas @xcite .",
    "note that the wvt colour map does not contain the spurious circular features present in its quadtree counterpart .",
    "hardness ratio maps are often insufficient to disentangle the spectral components of extended sources .",
    "this requires a detailed spectral analysis of multiple regions within the field of view .",
    "current state - of - the - art techniques to generate maps of temperature or other spectral parameters usually specify a regular grid of points , within which circular or square regions are `` grown '' until they reach a minimum number of counts for the spectral analysis ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "one can extract a spectrum and create response files for each region and feed them into an x - ray spectral fitting package such as xspec , isis or sherpa .",
    "just as in adaptive smoothing ( see also  [ asmoothcomparison ] ) , the measurements in this `` adaptively accreted '' temperature map are not independent of each other .",
    "the user is burdened with the task of deciding which features are actually resolved and thus believable , i.e. which features are larger than the extraction regions .",
    "wvt binning , on the other hand , has the power to automatically divide the field into unbiased , independent bins with constant source counts per bin , while keeping the individual bins as compact as possible .",
    "in addition , this reduces automatically the number of time - consuming spectral fits from the total number of pixels to the number of independent bins .    to demonstrate this capability , we adaptively bin the 46 ks _ chandra _ observation of ngc 4636 @xcite to 900 counts per bin .",
    "we then extract a spectrum for each bin and fit it with an absorbed , single temperature apec model .",
    "the left panel of figure [ tempmap ] shows the resulting temperature map , with the corresponding relative error distribution on the right .",
    "this figure is directly comparable to figure 2a of @xcite .",
    "they interpret the asymmetric temperature distribution as the result of hotter gas surrounding the cool core of ngc 4636 , which is penetrated by a `` plume '' of gas extending to the southwest . inside of this plume",
    "sits a concave , rising radio bubble , surrounded by cool rims .",
    "the higher temperature inside this cavity is interpreted as a projection effect , as the bubble pushes the cooler gas away and thus increases the relative contribution of the hotter surrounding gas along the line of sight .",
    "the wvt binned temperature map shows the same large - scale features as the @xcite map , with no ambiguity as to their statistical significance .          in many astronomical sources , the observed",
    "emission comes from multiple overlapping components .",
    "a good example are normal elliptical galaxies , where the diffuse x - ray emission is made up of contributions from interstellar gas and low mass x - ray binaries ( lmxbs ) .",
    "because of their spectral differences , hot gas and lmxbs contribute differently to the soft - band and the hard - band images .",
    "@xcite show how this fact can be exploited to recover the gas emission alone .",
    "let @xmath80 and @xmath81 represent the background - subtracted soft and hard images in each pixel @xmath6 .",
    "we can express both as linear combinations of the unresolved point source emission @xmath82 , the gas emission @xmath83 , and their respective softness ratios @xmath84 and @xmath85 : @xmath86 thus , the uncontaminated gas image and its associated noise can be expressed as @xmath87 @xmath88 @xcite discuss the determination of the constants @xmath84 and @xmath85 with spectral models .",
    "figure [ gasimage ] demonstrates the isolation of the gas emission using wvt binning , in a simulated observation .",
    "we assume gas and lmxb sources with very different spatial distributions for purposes of illustration .",
    "we adopt an elliptical de vaucouleurs profile for the lmxbs ( top left ) , and a @xmath32 model , with a nearly orthogonal major axis , for the gas ( top right ) and simulate hard and soft band images .",
    "the bottom left panel of figure [ gasimage ] shows the full band emission , which is nearly round .",
    "applying wvt adaptive binning ( lower right ) to the gas image ( equation [ [ linearcombtwo ] ] ) , we are able to reconstruct the true shape of the diffuse gas emission very accurately .",
    "two adaptive smoothing algorithms are in widespread use due to their inclusion in the main data analysis systems of _ chandra _ and _ xmm - newton_. the adaptive smoothing tool of the _ xmm _ science analysis system ( xmmsas ) is named _ asmooth _ , whereas the _ chandra _ interactive analysis of observations ( ciao ) tool is usually referred to as _ csmooth _ ( ebeling , white & rangarajan , private communication ) .",
    "although their output is generally not used for quantitative analyses , they have become the primary tools to create `` pretty pictures '' for papers , talks and press releases .",
    "adaptive smoothing algorithms are thus instrumental in forming and influencing the perceptions of the broader astronomical community and the public .    in adaptive smoothing",
    ", the size of the smoothing kernel changes over the field of view to create a constant s / n per pixel in the output image .",
    "it is worth emphasising that the number of independent measurements is equal in adaptively smoothed and adaptively binned images of the same target s / n .",
    "thus one does not gain any additional spatial information by smoothing rather than binning .    in this section ,",
    "we give some cautionary advice on the interpretation of adaptively smoothed images .",
    "we take a @xmath32model surface brightness distribution ( equation [ [ betamodel ] ] ) with @xmath89 , @xmath90 , and @xmath91 , with a background of @xmath92 , shown in the upper left of figure [ candasmooth ] .",
    "we simulate a counts image , which we adaptively smooth or bin to a target s / n of 5 .",
    "the _ asmooth _ algorithm is thoroughly described in the xmmsas 6.0.0 user manual .",
    "the basic idea is to increase the size of the smoothing kernel for each pixel until the pixel can `` accrete '' enough signal to meet the s / n requirement .",
    "thus , each pixel has a scale associated with it , which determines the size of the convolution kernel that contributes to the smoothed flux value at this point . in wvt binning ,",
    "each _ bin _ has a scale associated with it . in both cases ,",
    "the scale is determined from the local s / n distribution .",
    "figure [ candasmooth ] shows the results of applying wvt binning ( upper right ) and _ asmooth _ ( lower right ) to the same test model .",
    "both algorithms are able to reproduce the underlying surface brightness distribution .",
    "figure [ asmootherrhist ] compares the distributions of relative errors for _ asmooth _ ( long dashed line ) and wvt binning ( solid line )",
    ". both distributions are consistent with the constant targeted s / n value of @xmath68 , but _",
    "s error distribution is not as regular as wvt s and is skewed slightly toward higher fluxes .",
    "the skewed error distribution is a result of _ asmooth _",
    "s tendency to preferentially misidentify high flux pixels over low flux pixels as real features .",
    "we find that the asmooth algorithm tends to build `` bridges '' , connecting nearby , independent noise peaks , and making them appear as linear filamentary structures .",
    "examples can be seen in the outer parts of figure [ candasmooth ] .",
    "a cleaner illustration is shown in figure [ flatbackground ] .",
    "here we have simulated a flat - field image , with a vertical gradient in s / n .",
    "the figure compares the results of _ asmooth _ ( left ) and wvt binning ( right ) .",
    "the smoothed image shows a wealth of spurious linear features that strongly lead the eye , suggesting filaments and cavities .",
    "the binned image , on the other hand , looks to the eye like a featureless but noisy flat field .",
    "one can easily see that all of the apparent structure in the smoothed image happens at the scale of the wvt bin sizes , and is therefore not statistically significant despite the target s / n of @xmath68 given as input .    in conclusion , if an adaptively smoothed image is necessary , we urge that it be published only in conjunction with its smoothing scale map or an equivalent wvt binned image .    .",
    "the wvt binning ( solid line ) and _ asmooth _",
    "( dashed line ) histograms are consistent with the target s / n value of 5 ( i.e. they approximate a gaussian with a width of 20% ) .",
    "note that the adaptively smoothed image is _ not _ a statistically better representation of the true surface brightness .",
    "the histogram of _ csmooth _ results ( dotted line ) is very irregular with a wide range of positive and especially negative errors , demonstrating the failure of this algorithm .",
    "[ asmootherrhist],width=317 ]          more than half of all _ chandra _ press release images of the diffuse emission from galaxies and clusters of galaxies are generated with the ciao tool _",
    "csmooth_. we demonstrate here that this algorithm creates very serious artefacts and should be used only with extreme caution .",
    "the _ csmooth _ algorithm ( ebeling , white & rangarajan , private communication ) first calculates a set of smoothing kernel sizes , ranging from the size of a single pixel to that of the entire image . starting with the smallest kernel , all pixels with a sufficient s / n within the kernel to match the target s / n requirements are convolved and added to the output image .",
    "these pixels are then removed from the input image , so they make no contribution at larger scales .",
    "the algorithm then picks the next larger kernel and starts over with the remaining pixels .",
    "this continues until no more pixels are left in the image , or the kernel size reaches its maximum .",
    "the final _ csmoothed _ image is the sum of all these individually convolved slices , and the flux from each pixel is spread over a different area , according to its smoothing scale .",
    "unfortunately , there is a fundamental flaw in this algorithm . because a different smoothing kernel is assigned to each pixel in the input image , each pixel in the output image is the sum of many convolutions of different parts of the input image with different kernels .",
    "this is fundamentally distinct from the _ asmooth _ algorithm , where the kernel is assigned to the pixel in the output image , whose flux is then a result of a single convolution using a single kernel . in other words ,",
    "_ asmooth collects _ flux , while _ csmooth distributes _ flux .",
    "these procedures are identical only for pure convolution with a fixed kernel .",
    "when the kernel is variable , the _ csmooth _ algorithm has the effect of moving flux from low surface brightness regions into high surface brightness regions .",
    "this is particularly destructive in regions of relatively flat emission , where _ csmooth _ will move flux into the high - flux tail of the noise distribution , creating spurious emission features in the smoothed image .",
    "a good example is given in the lower left panel of figure [ candasmooth ] , where _ csmooth _ obviously produces spurious radial features .",
    "note also the annulus of depressed emission ( deep purple colours ) at a radius of about 200 pixels . here",
    ", the kernel reaches its maximum size , dispersing the flux over a large area .",
    "the missing flux from this annulus accumulates in regions with smaller smoothing scales , producing a relatively sharp surface brightness edge around a radius of 150 pixels .",
    "the relative errors in these two regions range from + 100% to -200% ( figure [ asmootherrhist ] ) , indicating the magnitude of this effect .",
    "wvt binning is implemented in idl 5.6 , and publicly available under http://www.phy.ohiou.edu/~diehl/wvt .",
    "a manual and download instructions are provided on the website , along with examples for its usage .",
    "we have presented a generalisation of the voronoi adaptive binning technique by @xcite , broadly applicable to x - ray and other data .",
    "the generalised algorithm exploits the properties of weighted voronoi tesselations , rather than the overly restrictive gersho conjecture .",
    "wvt binning is applicable to any type of data as long as there is a way to robustly calculate the s / n , and the s / n distribution changes smoothly over the size of a bin .",
    "we have demonstrated the capabilities of wvt binning on exposure- and background - corrected x - ray intensity images , colour and temperature maps , and in isolating the diffuse gas emission in elliptical galaxies .",
    "wvt binning overcomes the shortcomings of both voronoi and quadtree binning , the latter of which is in growing use in x - ray astronomy .",
    "@xcite have recently published results using a `` contour binning '' algorithm , in which the bin boundaries follow the isophotes of an adaptively smoothed image .",
    "this creates very irregular and elongated bins , which lead the eye and introduce a shell - like appearance .",
    "we are unable to make a rigorous quantitative comparison with this technique , as the details are still unpublished .",
    "however , we reemphasise that our wvt binning produces an unbiased distribution of compact bins , and does not lead the eye .",
    "we have also demonstrated the pitfalls of adaptive smoothing , and regretfully advise against the use of the ciao tool _ csmooth _ for images of diffuse emission , as it creates very serious artefacts .",
    "if an adaptive smoothing technique has to be used , we recommend the xmmsas tool _ asmooth _ instead .",
    "however we urge that adaptively smoothed images be published only in conjunction with the smoothing scale map or an equivalent wvt binned image to facilitate the identification of real structures .",
    "we would like to thank michele cappellari and yannick copin for extremely helpful discussions and for making their voronoi binning code publicly available .",
    "our implementation of wvt binning is inspired by and based on their original algorithm .",
    "r. , copin y. , monnet g. , miller b.  w. , allington - smith j.  r. , bureau m. , marcella carollo c. , davies r.  l. , emsellem e. , kuntschner h. , peletier r.  f. , verolme e.  k. , tim de zeeuw p. , 2001 ,",
    "mnras , 326 , 23"
  ],
  "abstract_text": [
    "<S> we present a technique to adaptively bin sparse data using weighted voronoi tesselations ( wvts ) . </S>",
    "<S> wvt binning is a generalisation of cappellari & copin s ( 2001 ) voronoi binning algorithm , developed for integral field spectroscopy . </S>",
    "<S> wvt binning is applicable to many types of data and creates unbiased binning structures with compact bins that do not lead the eye . </S>",
    "<S> we apply the algorithm to simulated data , as well as several x - ray data sets , to create adaptively binned intensity images , hardness ratio maps and temperature maps with constant signal - to - noise ratio per bin . </S>",
    "<S> we also illustrate the separation of diffuse gas emission from contributions of unresolved point sources in elliptical galaxies . </S>",
    "<S> we compare the performance of wvt binning with other adaptive binning and adaptive smoothing techniques . </S>",
    "<S> we find that the ciao tool _ csmooth _ creates serious artefacts and advise against its use to interpret diffuse x - ray emission .    </S>",
    "<S> [ firstpage ]    methods : data analysis  techniques : image processing  ism : general  supernova remnants  galaxies : clusters : general  x - rays : galaxies </S>"
  ]
}