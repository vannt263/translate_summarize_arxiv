{
  "article_text": [
    "when the electronic structure is well described by a single slater determinant , it can be modeled accurately by modern single - reference electron correlation methods .",
    "for example , many - body perturbation and coupled - cluster theory have proven to be very effective , allowing researchers to predict energies , geometric parameters , and spectroscopic properties at times with accuracies on the order of wavenumbers.@xcite however , there are yet many chemical systems that exhibit an electronic structure requiring more than one electronic configuration to be taken into account .",
    "this is particularly true for quasi - degenerate electronic states near avoided crossings or conical intersections in photochemical relaxation processes or in chemical reactions involving bond breaking .",
    "these multi - configurational electronic structures are ubiquitous in inorganic chemistry , for instance , in most transition metal compounds where states arising from varying the occupations of the _ d_-orbitals are close in energy .",
    "multiconfigurational self - consistent field methods designed for such systems , for instance the complete active space self - consistent field ( casscf ) method , are generalizations of the single - determinantal hartree  fock method.@xcite the dynamical correlation models that use casscf wave functions as a reference have been developed over the past few decades ; the successful models include multi - reference second - order perturbation and configuration interaction methods.@xcite among the most widely used forms of multi - reference second - order perturbation methods is the complete active space second order perturbation ( caspt2 ) approach that employs the so - called internally contracted basis for efficiency.@xcite the caspt2 method has been applied to a variety of chemical problems including the spectra of organic compounds , transition metal complexes , and heavy elements.@xcite    when multiple electronic states are nearly degenerate , special care has to be taken , because errors in the state - specific approach may arise as the caspt2 states are generally a linear combination of the casscf reference states and may not be accurately approximated by a single casscf state .",
    "the multi - state ( ms ) caspt2 approach has been derived from quasi - degenerate perturbation theory based on the bloch wave operator formalism , which mixes different caspt2 states by forming an effective hamiltonian and diagonalizing it to obtain the mixing coefficients,@xcite recently the  extended \" version of ms - caspt2 ( xms - caspt2 ) has been proposed@xcite to rectify its failure near conical intersections and avoided crossings where its potential energy surfaces are sometimes singular .",
    "the xms - caspt2 method introduces a rotation of the reference casscf states to be used in the caspt2 theory such that the fock operator is diagonal within the reference space and reduces to the standard ms - caspt2 method when this rotation is set to unit .",
    "implementation of analytical nuclear gradients for fully internally contracted caspt2 has been an outstanding challenge for two decades .",
    "the equations for the nuclear gradients of internally contracted multireference theories are extremely complex , in part because the configuration interaction ( ci ) coefficients in the casscf reference wave functions are geometry dependent .",
    "the nuclear gradient implementation was , therefore , limited to uncontracted@xcite or partially contracted@xcite analogues until very recently , when macleod and shiozaki realized it for a fully internally contracted variant using an automatic code generation approach.@xcite the use of full internal contraction in our program allows us to evaluate nuclear gradients far more efficiently than the existing implementations based on uncontracted and partially contracted multireference perturbation theories .",
    "for instance , the application of the analytical gradient program for a partially contracted variant by celani and werner@xcite is limited to small molecules , because it treats closed and active orbitals on an equal footing [ their implementation is technically limited to 32 occupied ( i.e. , closed and active ) orbitals ] . in the following",
    ", the efficiency of our code will be demonstrated by numerical examples that were intractable with previously reported methods .",
    "herein , we present the implementation of ms - caspt2 and xms - caspt2 nuclear gradients using fully internally contracted basis functions . two full internal contraction schemes for ( x)ms - caspt2 wave functions , called the  ms - mr \" and  ss - sr \" schemes ( see below ) , are considered .",
    "vertical shifts , which are often necessary in excited - state calculations , are included in the gradient code.@xcite the program is parallelized and ready for applications .",
    "the ground- and excited - state geometries of a cu corrole and benzophenone are presented to demonstrate the efficiency and versatility .",
    "in this section , we elaborate on the nuclear gradient theory for the fully internally contracted xms - caspt2 method .",
    "the working equations are based on the nuclear - gradient formulas for the partially internally contracted xms - caspt2 reported by shiozaki _",
    "et al._,@xcite which , in turn , was based on the caspt2 lagrangian proposed by celani and werner.@xcite our implementation is interfaced to the bagel program package@xcite as an extension to the state - specific caspt2 nuclear gradient program recently reported by us.@xcite hereafter , we use the following index notation : @xmath2 and @xmath3 label closed orbitals , @xmath4 , @xmath5 , and @xmath6 label active orbitals , @xmath7 and @xmath8 label virtual orbitals , and @xmath9 , @xmath10 , @xmath11 , and @xmath12 label general orbitals .",
    "the casscf reference states , labeled by @xmath13 , @xmath14 , and @xmath15 , are a linear combination of slater determinants @xmath16 , @xmath17 the orbitals are determined such that the state - averaged ( sa ) casscf energy , @xmath18 , is stationary with respect to the orbital rotation parameters ( i.e. , the orbital - rotation gradients of @xmath19 , often labeled as @xmath20 , are zero ) .",
    "the weight @xmath21 in the sa - casscf is set to be @xmath22 in our program with @xmath23 being the number of states included in the calculation .",
    "it is also assumed in this work that the numbers of states included in the casscf and caspt2 calculations are identical , though this restriction can be easily lifted .",
    "the xms procedure@xcite has recently been proposed to make the ms - caspt2 theory invariant with respect to rotations among reference states .",
    "this invariance has been shown to be essential for accurate description of state crossings.@xcite in xms , the fock operator is diagonalized within the reference configuration space , @xmath24 and , using this rotation matrix @xmath25 , we define a new set of reference configurations , @xmath26 note that the hamiltonian matrix within the reference space is no longer diagonal , @xmath27 in the following , we present the equations for xms - caspt2 based on these rotated reference states .",
    "the equations for ms - caspt2 can be obtained by setting @xmath25 to be a unit matrix .",
    "the first - order wave functions in the state - specific caspt2 theory is parameterized using the internally contracted basis as @xmath28 in which the internally contracted basis functions are generated from the union of the reference states .",
    "this parametrization is often referred to as the  ms - mr \" contraction scheme .",
    "another popular parameterization used in the original ms - caspt2 implementation by finley _",
    "et al_.@xcite @xmath29 is often referred to as the  ss - sr \" contraction scheme . in",
    "what follows , we report the working equations based on the  ms - mr \" contraction primarily in terms of @xmath30 defined in eq .   to be consistent with the way our code is implemented .",
    "all of the equations are implemented with the  ss - sr \" contraction as well ; the working equation for the  ss - sr \" contraction is a subset of those with the  ms - mr \" contraction and can be obtained by only retaining the diagonal terms .",
    "generally speaking , the  ms - mr \" contraction guarantees invariance of the theory with respect to any rotation among reference functions,@xcite whereas the  ss - sr \" contraction allows for the computation of ms - caspt2 with computational costs that are linear in the number of states.@xcite    the amplitudes @xmath31 for state @xmath13 are determined by the amplitude equation , @xmath32 which should hold for each @xmath14 . here ,",
    "the state - averaged fock operator @xmath33 is used , which is defined as @xmath34_{xy } \\{\\hat{e}_{xy}\\}_c , \\nonumber\\\\ & [ \\mathbf{g}(\\mathbf{d})]_{xy } = \\sum_{kl } \\left[(xy|zw)d_{zw } - \\frac{1}{4 } ( xw|zy)(d_{zw}+d_{wz})\\right].\\end{aligned}\\ ] ] normal ordering is used with respect to the closed - fock vacuum and is denoted as @xmath35 : @xmath36 \\hat{e}_{xy } & \\quad \\mathrm{otherwise } \\end{array } \\right.\\end{aligned}\\ ] ] the hamiltonian @xmath37 is also normal ordered with respect to the closed - fock vacuum .",
    "@xmath38 is the state - averaged zeroth - order density matrix , i.e. , @xmath39 @xmath40 in the amplitude equation is the zeroth - order energy of the @xmath13th state , @xmath41 in which the summation runs only over active orbitals , owing to the normal ordering .",
    "@xmath42 is a shift parameter .",
    "the amplitude equation is solved using a subspace residual minimization algorithm . in general , the internally contracted basis is linearly dependent ; therefore , we typically truncate the eigenvalues of the overlap matrix below 10@xmath43 when updating the amplitudes .",
    "once convergence is achieved , the effective hamiltonian is constructed , @xmath44 the diagonalization of which gives the xms - caspt2 energy ( for @xmath45th state ) , @xmath46 the final energy can be explicitly written as @xmath47 in the subsequent subsections , we present an algorithm for computing the total derivatives of @xmath48 with respect to nuclear displacements .",
    "the xms - caspt2 energy @xmath48 is not stationary with respect to the variation of the @xmath49 amplitudes .",
    "we therefore define the lagrangian that is stationary with respect to the parameters in the caspt2 part , @xmath50 in which the amplitude equations are included as a constraint .",
    "the @xmath0 operator is defined similarly to the @xmath49 operator : @xmath51 where @xmath52 are the lagrange multipliers for the corresponding amplitudes .",
    "note that taking the derivative of @xmath53 with respect to @xmath54 yields the amplitude equation in eq .  .",
    "taking the derivative of @xmath53 with respect to @xmath55 , one obtains the so - called @xmath0 equation : @xmath56 with thus determined @xmath0 amplitudes , @xmath53 is now stationary with respect to all of the @xmath49 , @xmath0 , and @xmath57 parameters .",
    "however , @xmath53 is not stationary with respect to orbital rotation or to the variation of the ci coefficients in the reference calculations . by including the constraints associated with the casscf optimization , we arrive at the total xms - caspt2 lagrangian , which consists of @xmath53 and the constraints from the casscf procedure , i.e. , @xmath58 -\\frac{1}{2}\\mathrm{tr}[\\mathbf{x}(\\mathbf{c}^\\dagger \\mathbf{s}\\mathbf{c}-1 ) ] \\nonumber\\\\ & + \\sum_n w_n \\left[\\sum_{i } z_{i , n } \\langle i | \\hat{h } - e^\\mathrm{ref}_n | n\\rangle   - \\frac{1}{2}x_n ( \\langle n",
    "| n\\rangle -1 )   \\right ] \\nonumber\\\\ & + \\sum_i^\\mathrm{closed } \\sum_j^\\mathrm{frozen } z^c_{ij } f_{ij } + \\sum_{mn } w_{mn } \\langle \\tilde{m}|\\hat{f}|\\tilde{n}\\rangle.\\end{aligned}\\ ] ] taking the derivatives of @xmath59 with respect to @xmath60 and @xmath61 , for instance , lead to the orbital and ci conditions for the sa - casscf optimization .",
    "next we determine @xmath60 , @xmath61 and @xmath62 by solving the so - called @xmath1-vector equation,@xcite which is formally a set of linear equations corresponding to the stationary condition of the lagrangian with respect to orbital rotation parameters and variations of the ci coefficients .",
    "first , we calculate the derivatives of the caspt2 lagrangian @xmath53 with respect to the unitary generator for orbital rotations @xmath63 and the ci coefficients @xmath64 , i.e. , @xmath65 the former is calculated from the correlated density matrices.@xcite the first - order contributions to the correlated density matrices are @xmath66 in which we have introduced the ",
    "mixed \" states , @xmath67 the mixed states have also been used in the previous implementation with partial internal contraction.@xcite the second - order contributions are @xmath68 \\displaystyle \\bar{d}_{xy}^{(2 ) } & \\quad\\mathrm{otherwise } \\end{array } \\right.\\end{aligned}\\ ] ] where @xmath69 and @xmath70 are respectively defined as @xmath71 an efficient density - fitted algorithm for computing the orbital derivative @xmath72 using these correlated density matrices has been detailed in ref .  .",
    "the derivatives of the caspt2 lagrangian @xmath53 with respect to @xmath73 are @xmath74_{rs},\\end{aligned}\\ ] ] from which those with respect to @xmath64 [ @xmath75 in eq .  ]",
    "can be easily calculated using the xms rotation matrix @xmath76 as @xmath77 we have implemented a multi - passing algorithm for the computation of @xmath78 , in which the index @xmath16 is divided into several chunks such that the ci derivatives of the higher - order rdms fit in distributed memory , and the associated @xmath78 are computed separately .",
    "this avoids the storage of the entire ci derivatives of the rdms , which previously limited the size of the active spaces.@xcite    the lagrange multiplier for the xms constraint can be calculated using @xmath79 to be @xmath80 which follows from the chain rule .",
    "the derivatives of the xms term with respect to the orbital rotations and variation of ci coefficients are @xmath81_{xy},\\\\ & \\tilde{y}'_{i ,",
    "n } = 2\\sum_m \\langle i | \\hat{f } | \\tilde{m}\\rangle w_{mn } + 2w_n \\sum_{rs } \\langle i | \\hat{e}_{rs } |\\tilde{n}\\rangle [ \\mathbf{g}(\\check{\\mathbf{d}})]_{rs},\\end{aligned}\\ ] ] respectively , where @xmath82 is an effective density matrix for the xms term , @xmath83 note that @xmath84 is set to zero when computing ms - caspt2 nuclear gradients without the xms procedure .",
    "@xmath85 and @xmath75 are used to solve the @xmath1 vector equation ; the effective density matrices are then formed and contracted to the gradient integrals .",
    "the details of the @xmath1-casscf equations and the contraction to the gradient integrals using density fitting are found in ref .",
    "( see also ref .  ) .",
    "there are four steps in the xms - caspt2 energy and nuclear gradient evaluation , in which we solve a linear equation .",
    "since solving linear equations could potentially introduce numerical instability , here we analyze the stability of these equations in detail .",
    "these steps include the amplitude equation [ eq .",
    "] , the @xmath0 equation [ eq .  ] , the xms response term [ eq .  ] , and the @xmath1-vector equation ( ref .  ) .",
    "the other steps are tensor multiplications , which are numerically stable .    first , the numerical instability in the amplitude equation ( called the intruder - state problem ) can be eliminated by the vertical shift @xmath42.@xcite this also means that the vertical shift can stabilize the @xmath0 equation , because the condition number of the @xmath0 equation is identical to that of the amplitude equation ( the only difference between these two equations is in the source terms [ see eqs .   and ] ) .",
    "the response of the xms rotation matrix [ eq .  ] involves the division by the difference of the zeroth - order energies of each pair of reference states ( @xmath86 ) .",
    "this apparent divergence reflects the fact that , when the zeroth - order energies are degenerate , the xms procedure does not yield a unique set of reference states .",
    "however , when they are degenerate , it follows from quasi - degenerate perturbation theory@xcite that the final xms - caspt2 energies are invariant with respect to any rotations among reference states as well .",
    "therefore , whenever @xmath87 is very close to zero , one can simply set the corresponding element of the xms response @xmath84 to zero .",
    "finally , we analyze the stability of the @xmath1-vector equation .",
    "let us use a short - hand notation @xmath88 for the @xmath1-vector equation , where @xmath9 is a column vector consisting of @xmath89 and @xmath61 and @xmath8 is that consisting of @xmath85 and @xmath75.@xcite the matrix @xmath90 on the left - hand side is the second derivatives of the sa - casscf energy with respect to the orbital rotations and variations of the ci coefficients .",
    "since the sa - casscf solutions are minima in the parameter space , this matrix is guaranteed to be positive definite .",
    "whenever some of the eigenvalues of @xmath90 are close to zero , it means that the active space is ill - defined ; in other words , there are nearly empty or doubly - occupied orbitals in the active space , making the state - averaged reference energy almost invariant with respect to these orbital rotations . in practice ,",
    "the @xmath1-vector elements that correspond to these nearly redundant rotations can be set to zero .",
    "it is important to note that the stability of the @xmath1-vector equation is determined solely by the sa - casscf conditions ( and not by the properties of electron correlation methods ) , because all of the terms that are dependent on @xmath53 are contained in @xmath8 in the above abbreviated expression , which is the source term of the linear equation .    in summary , we have shown that , as long as the intruder - state problems in the amplitude equations are addressed by the vertical shift @xmath42,@xcite there is no additional numerical issue in the caspt2 gradient evaluation . our experience with the code",
    "so far also supports this analysis .",
    "all of the working equations are implemented using a code generator , named smith , that we have recently reported.@xcite our code generator can handle spin - free equations for multireference electron correlation theories@xcite and implements the following expressions :    @xmath91    where @xmath92 is an excitation operator , @xmath93 is a general operator ( such as hamiltonians ) , @xmath94 and @xmath95 are arbitrary active - space configurations , and @xmath16 labels slater determinants .",
    "the generated code does not utilize symmetry at the moment .",
    "it was previously used to implement analytical nuclear gradient programs for state - specific caspt2.@xcite    in this work , we extensively make use of this machinery .",
    "for instance , when evaluating eq .  , the generated code is called within the three - fold nested loops over possible @xmath13 , @xmath14 , and @xmath15 states ; inside these loops , we set appropriate rdms and energies to the tensors to be read by the generated code , @xmath96 using these quantities , the corresponding state - specific caspt2 code is called to calculate the contribution to the residual vector .",
    "the same approach is used in the @xmath0 equation and the evaluation of the correlated density matrices and ci derivatives .",
    "all of the explicit formulas are complied in the supplementary information of ref .  .",
    "the programs generated by smith are parallelized using the mpi remote memory access protocols ( rma ) .",
    "the recently extended interfaces in the mpi3 standard ( e.g. , mpi_rget , mpi_rput , and mpi_raccumulate ) allow us to check the completion of specific one - sided communications without global fencing . at this moment , these one - sided communications are used as a blocking operation ( i.e. , we call these function and wait until their completion ) . in tensor contractions ,",
    "the data locality is used such that mpi_raccumulate is intra - node while mpi_rget can be inter - node ; we made this decision because mpi_raccumulate is typically not implemented at the hardware level unlike mpi_rget and mpi_rput .",
    "the index permutation of tensors is currently performed at the destination ; further optimization using a scalable universal matrix multiplication algorithm ( summa)@xcite to avoid the repeated permutation operations will be performed in the future .",
    "optimizations of the ground and excited states of a copper corrole and benzophenone are presented .",
    "unless otherwise stated , all of the optimizations were performed using the bagel package without imposing spatial symmetry .",
    "corroles are non - innocent , porphyrin - like macrocycles that exhibit unique coordination chemistry and electronic structure . while structurally similar to porphyrins , two of the pyrrole rings in the corrole are directly bound and the ligand is trianionic when fully deprotonated ( see fig .",
    "[ fig : corrole ] ) .",
    "corroles have an electronic structure that consists of the four so - called gouterman orbitals,@xcite which include two a@xmath98 and two b@xmath98 orbitals where each has one occupied and one unoccupied orbital ( note that , although we label orbitals using the notation in the c@xmath99 symmetry , the actual symmetry of the molecule is c@xmath100 , not c@xmath99 ) .",
    "metallocorroles have _ d_-orbitals that are close in energy to the corrole @xmath101-system .",
    "this , in combination with the non - innocent ligand , has been shown to yield a multiconfigurational ground state .",
    "furthermore , work by pierloot _",
    "et al_. on the copper corrole suggested that as the geometry of the complex changes from planar to saddled , the ordering of the two lowest singlet states inverts.@xcite there has been much discussion in the literature regarding the formal oxidation states of the metal ( and likewise the extent to which a radical is present on the ligand).@xcite the proposed electronic structures in the literature fall to two extremes : ( 1 ) a d@xmath102 cu(ii ) center with a radical in the b@xmath98 orbital of the corrole or ( 2 ) a closed shell cu(iii ) center where no spin is present on the ligand .",
    "the copper corrole complex .",
    "active orbitals are listed on the right .",
    "the resulting geometries range from planar ( c@xmath99 ) to a saddled ( c@xmath100 ) structure .",
    ", scaledwidth=45.0% ]    in order to study how the geometry changes from the ground state singlet ( s@xmath97 ) to the first excited singlet ( s@xmath98 ) , geometry optimizations were performed using xms - caspt2 and the cc - pvdz basis set along with the tzvpp jkfit basis set ( since there is no cu basis set in cc - pvdz jkfit ) for density fitting . a vertical shift of 0.2 was also employed .",
    "the active orbitals include the four gouterman orbitals@xcite and the _ d_@xmath103 orbital resulting in a ( 4_e_,5_o _ ) active space ( see fig .",
    "[ fig : corrole ] ) .",
    "the remaining four _ d _ orbitals are doubly occupied and sufficiently low in energy to remain in the inactive space .",
    "the orbitals were state averaged over two states .    the largest contributions to the s@xmath97 and s@xmath98 wave functions are ( a@xmath100)@xmath104(b@xmath98)@xmath105(d@xmath103)@xmath105 and ( a@xmath100)@xmath105(b@xmath98)@xmath104(d@xmath103)@xmath105 , respectively .",
    "the t@xmath97 state was also optimized and yields a planer c@xmath99 structure .",
    "both of the two singlet states are formally cu(ii ) and differ in energy by 8.7 kcal / mol at the c@xmath99 t@xmath97 xms - caspt2 optimized geometry .",
    "the geometry change between the minima of these two states is most notable in a saddling motion that can be quantified by averaging the c  c  n  cu dihedral angle ( denoted @xmath106 ) where the first carbon is a @xmath107-carbon on the pyrrole group ( see red circles in fig .",
    "[ fig : corrole ] ) .",
    "when starting from a geometry with @xmath106 = 2@xmath108 , the convergence to the minimum geometry of the s@xmath97 state took 31 geometry optimization steps .",
    "for this optimized structure , @xmath106 is very distorted at 18.5@xmath108 . on the other hand the nearly planar @xmath106 = 2@xmath108 structure was a much better guess for the s@xmath98 state which converged in 15 geometry steps to a structure with @xmath106 = 0.1@xmath108 . when the  ss - sr \" scheme is employed , the value for @xmath106 at the s@xmath97 and s@xmath98 minima changes only slightly yielding values of 0.5@xmath108 and 18.3@xmath108 , respectively .",
    "each geometry optimization step took 41 minutes using the  ms - mr \" scheme and 20 minutes using the  ss - sr \" scheme using 128 cpu cores ( xeon e5 - 2650 2.0  ghz ) .",
    "optimized geometries and their corresponding total energies are available in the supporting information .",
    "we note in passing that this system was selected partly because pierloot _",
    "et al_. reported that the ms - caspt2 method overestimated the coupling between these states.@xcite in our calculations , however , the coupling between caspt2 states was found to be small .",
    "the benzophenone molecule is widely used as a triplet sensitizer because it rapidly undergoes intersystem crossing from the excited ( s@xmath98 ) state to triplet states with a quantum yield close to one .",
    "this transition has been observed in single crystals , in solution , and in isolated matrices.@xcite the most pronounced change in geometry between the s@xmath97 to s@xmath98 states involves the elongation of the c - o bond and a change in the tilting angle between the two phenyl rings ( see fig .",
    "[ fig : benzophenone ] and table  [ table : benzophenone]).@xcite the initial s@xmath97 to s@xmath98 excitation and the nature of the subsequent transition into the t@xmath98 state was recently studied in detail by sergentu _",
    "et al._@xcite here , we present the xms - caspt2 optimized geometry for benzophenone in the ground and first excited singlet states .",
    "the first excitation in benzophenone includes a transition from the non - bonding oxygen lone pair orbital ( n@xmath97 ) to the @xmath101 * orbitals in the c  o double bond . to optimize the geometry of the @xmath109 state",
    ", we constructed an ( 8@xmath110,7@xmath111 ) active space consisting of n@xmath97 and several @xmath101 orbitals .",
    "the active orbitals are shown in fig .",
    "[ fig : benzophenone ] .     the benzophenone molecule and the active orbitals included in the ( 8_e_,7_o _ ) active space.,scaledwidth=45.0% ]    .[table : benzophenone ]",
    "select geometric parameters for the optimized s@xmath97 and s@xmath98 states .",
    "ph refers to the angle between the two planes of the phenyl rings .",
    "@xmath112 is the adiabatic excitation energy in ev . [",
    "cols=\"^,^,^,^\",options=\"header \" , ]     the geometry was optimized using xms - caspt2 with the cc - pvdz basis set and the corresponding jkfit basis employing the  ss - sr \" scheme and a vertical shift of 0.2 .",
    "the first three singlet states were included . for comparison , the s@xmath97 and s@xmath98 states were also optimized with sa - casscf ( 8_e_,7_o _ ) and pbe0 using the molcas and turbomole packages , respectively.@xcite in the sa - casscf calculation , the same basis set and state - averaging was used with cholesky decomposition .",
    "pbe0 calculations were performed using the def2-tzvp basis set .",
    "select geometric parameters from these optimizations are given in table  [ table : benzophenone ] , and the coordinates are given in the supporting information .",
    "the ground state has a ph  ph angle of 53@xmath108 and a c  o bond distance of 1.23  . in the s@xmath98 state ,",
    "the @xmath101 * orbital on the c  o bond is occupied and as a result the c  o bond distance increases to 1.35  .",
    "for all three methods , the bond distances demonstrate the same trend ; however , the c1c2 and c2c3 bond distances differ slightly more in the s@xmath97 state with casscf than with either caspt2 or pbe0 . additionally , the difference between the s@xmath97 and s@xmath98 ph ",
    "ph angles is 14@xmath113 when either caspt2 or pbe0 are used ; however , the difference with casscf is larger by 5@xmath113 .",
    "one geometry step took about 19 min using 64 cpu cores ( xeon e5 - 2650 2.0  ghz ) .",
    "efficient computation of analytical gradients presented here is a first step toward reliable simulations of photochemical dynamics , for which standard dft fails to describe state crossings between the ground and excited states .",
    "we have developed an efficient program for calculating analytical nuclear energy gradients for ms- and xms - caspt2 with full internal contraction , by extending the state - specific caspt2 analytical gradient code previously reported by us .",
    "we derived and implemented the so - called @xmath0 and @xmath1-vector equations based on the ( x)ms - caspt2 lagrangian .",
    "the program is parallelized using the mpi3 rma instructions .",
    "we demonstrated the efficiency of the code by optimizing a copper corrole complex and benzophenone for their s@xmath97 and s@xmath98 states .",
    "the program is interfaced to the bagel program package,@xcite which is publicly available under the gnu general public license .",
    "the code generator smith3 is also open source.@xcite we will investigate in the near future the use of symmetry and scalable parallel algorithms by extending the code generator and interfacing the code with parallel runtime libraries .",
    "jeff hammond is thanked for helpful comments on the mpi3 rma .",
    "this work has been supported by the department of energy , basic energy sciences ( grant no .",
    "de - fg02 - 13er16398 ) and the air force office of scientific research young investigator program ( grant no .  fa9550 - 15 - 1 - 0031 ) .",
    "40ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop _ _  ( ,  ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) in  @noop _ _ ,  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> we report the development of the theory and computer program for analytical nuclear energy gradients for ( extended ) multi - state complete active space perturbation theory ( caspt2 ) with full internal contraction . </S>",
    "<S> the vertical shifts are also considered in this work . </S>",
    "<S> this is an extension of the fully internally contracted caspt2 nuclear gradient program , recently developed for a state - specific variant by us [ macleod and shiozaki , j. chem . </S>",
    "<S> phys . * 142 * , 051103 ( 2015 ) ] ; in this extension , the so - called @xmath0 equation is solved to account for the variation of the multi - state caspt2 energies with respect to the change in the amplitudes obtained in the preceding state - specific caspt2 calculations , and the @xmath1-vector equations are modified accordingly . </S>",
    "<S> the program is parallelized using the mpi3 remote memory access protocol that allows us to perform efficient one - sided communication . </S>",
    "<S> the optimized geometries of the ground and excited states of a copper corrole and benzophenone are presented as numerical examples . </S>",
    "<S> the code is publicly available under the gnu general public license . </S>"
  ]
}