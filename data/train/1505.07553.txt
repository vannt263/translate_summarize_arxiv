{
  "article_text": [
    "given a cyclic group @xmath7 and a generator @xmath8 of @xmath9 , the discrete logarithm ( dl ) of @xmath10 is the element @xmath11 such that @xmath12 .",
    "in well - chosen groups , the exponentiation @xmath13 is very fast but computing @xmath14 from @xmath15 is conjectured to be very difficult : this is the discrete logarithm problem ( dlp ) , at the heart of many asymmetric cryptosystems .",
    "the first group proposed for dlp was the multiplicative group of a prime finite field . nowadays , the group of points of elliptic curves defined over prime fields are replacing the prime fields for dlp - based cryptosystems . in pairing - based cryptography ,",
    "the finite fields are still used , because they are a piece in the pairing mechanism .",
    "it is important in cryptography to know precisely the difficulty of dl computation in the considered groups , to estimate the security of the cryptosystems using them .",
    "finite fields have a particularity : there exists a subexponential - time algorithm to compute dl in finite fields of medium to large characteristic : the number field sieve ( nfs ) . in small characteristic",
    ", this is even better : a quasi - polynomial - time algorithm was proposed very recently  @xcite .    in may 2015 ,",
    "an international team of academic researchers revealed a surprisingly efficient attack against a diffie - hellman key exchange in tls , the _ logjam _ attack  @xcite .",
    "after a seven - day - precomputation stage ( for relation collection and linear algebra of nfs - dl algorithm ) , it was made possible to compute any given individual dl in about one minute , for each of the two targeted 512-bit prime finite fields .",
    "this was fast enough for a man - in - the - middle attack .",
    "this experience shows how critical it can be to be able to compute individual logarithms very fast .",
    "another interesting application for fast individual dl is _ batch - dlp _ , and _ delayed - target dlp _ : in these contexts , an attacker aims to compute several dl in the same finite field . since the costly phases of relation collection and linear algebra are only done one time for any fixed finite field , only the time for one individual dl is multiplied by the number of targets",
    "this context usually arises in pairing - based cryptography and in particular in broadcast protocols and traitor tracing schemes , where a large number of dlp - based public / private key pairs are generated .",
    "the time to compute one individual dl is important in this context , even if parallelization is available .",
    "we recall that the nfs algorithm is made of four steps : polynomial selection , relation collection , linear algebra and finally , individual logarithm computation . _",
    "this last step is mandatory to break any given instance of a discrete logarithm problem .",
    "_ the polynomial selection outputs two irreducible polynomials @xmath16 and @xmath8 defining two number fields @xmath17 and @xmath18 .",
    "one considers the rings @xmath19/(f(x))$ ] and @xmath20/(g(x))$ ] .",
    "there exist two maps @xmath21 to @xmath0 , as shown in the following diagram .",
    "moreover , the monic polynomial defining the finite field is @xmath22 , of degree @xmath23 .    ( qqx ) @xmath24 $ ] ; ( middle ) ; ( kf ) @xmath19/(f(x))$ ] ; ( kg ) @xmath25/(g(y ) ) = r_g$ ] ; ( qqx )  node ( kf ) ; ( qqx )  node ( kg ) ; ( gfpn ) @xmath26/(\\psi(z))$ ] ;    ( kf )  ( gfpn ) ; ( rho - f ) @xmath27 ; ( kg )  ( gfpn ) ; ( rho - g ) @xmath28 ;    in the remaining of this paper , we will only use @xmath29 , @xmath30 and @xmath31 .",
    "after the relation collection and linear algebra phases , the ( virtual ) logarithm of a subset of elements in each ring @xmath32 is known .",
    "the individual dl step computes a preimage in one of the rings @xmath32 of the target element in @xmath0 .",
    "if one can write the target preimage as a product of elements of known ( virtual ) logarithm , then one can deduce the individual dl of the target .",
    "the key point of individual dl computation is finding a smooth decomposition in small enough factors of the target preimage .",
    "the asymptotic running time of nfs algorithm steps are estimated with the @xmath33-function : @xmath34 = \\exp \\bigl ( \\bigl(c+o(1)\\bigr ) ( \\log q)^\\alpha ( \\log \\log    q)^{1-\\alpha } \\bigr ) \\quad \\mbox { with } \\alpha \\in [ 0,1 ] \\mbox { and    } c > 0~.\\ ] ] the @xmath35 parameter measures the gap between polynomial time ( @xmath36=\\log^c q$ ] ) and exponential time ( @xmath37 = q^c$ ] ) . when @xmath38 is implicit , or obvious from the context , we simply write @xmath39 $ ] .",
    "when the complexity relates to an algorithm for a prime field @xmath40 , we write @xmath41 $ ] .",
    "[ [ large - prime - fields . ] ] large prime fields .",
    "+ + + + + + + + + + + + + + + + + + +    many improvements for computing discrete logarithms first concerned prime fields .",
    "the first subexponential dl algorithm in prime fields was due to adleman @xcite and had a complexity of @xmath42 $ ] . in 1986 ,",
    "coppersmith , odlyzko and schroeppel @xcite introduced a new algorithm ( cos ) , of complexity @xmath43 $ ] .",
    "they computed individual dl @xcite in @xmath44 $ ] in two steps ( finding a boot of medium - sized primes , then finding relations of logarithms in the database for each medium prime ) .",
    "in these two algorithms , the factor basis was quite large ( the smoothness bound was @xmath44 $ ] in both cases ) , providing a much faster individual dl compared to relation collection and linear algebra .",
    "this is where the common belief that individual logarithms are easy to find ( and have a negligible cost compared with the prior relation collection and linear algebra phases ) comes from .    in 1993 , gordon @xcite proposed the first version of nfs  dl algorithm for prime fields @xmath40 with asymptotic complexity @xmath45 $ ] .",
    "however , with the @xmath46 $ ] algorithm there are new difficulties , among them the individual dl phase . in this @xmath46 $ ] algorithm , many fewer logarithms of small elements are known , because of a smaller smoothness bound ( in @xmath46 $ ] instead of @xmath47 $ ] ) .",
    "the relation collection is shortened , explaining the @xmath46 $ ] running time .",
    "but in the individual dl phase , since some non - small elements in the decomposition of the target have an unknown logarithm , a dedicated sieving and linear algebra phase is done for each of them .",
    "gordon estimated the running - time of individual dl computation to be @xmath48 $ ] , i.e. _ the same as the first two phases_. in 1998 , weber @xcite compared the nfs ",
    "dl algorithm to the cos algorithm for a 85 decimal digit prime and made the same observation about individual dl cost .    in 2003 , ten years after gordon s algorithm , joux and lercier @xcite were the first to dissociate in nfs relation collection plus linear algebra on one side and individual dl on the other side .",
    "they used the _",
    "special_-@xmath49 technique to find the logarithm of medium - sized elements in the target decomposition .",
    "in 2006 , commeine and semaev @xcite analyzed the joux ",
    "lercier method .",
    "they obtained an asymptotic complexity of @xmath50 $ ] for computing individual logarithms , independent of the relation collection and linear algebra phases . in 2013 , barbulescu ( * ? ? ? * ,  7.3 ) gave a tight analysis of the individual dl computation for prime fields , decomposed in three steps : booting ( also called smoothing ) , descent , and final combination of logarithms .",
    "the booting step has an asymptotic complexity of @xmath51 $ ] and the descent step of @xmath52 $ ] .",
    "the final computation has a negligible cost .",
    "[ [ non - prime - fields - of - medium - to - large - characteristic . ] ] non - prime fields of medium to large characteristic .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in 2006 , joux , lercier , smart and vercauteren @xcite computed a discrete logarithm in a cubic extension of a prime field .",
    "they used the special-@xmath49 descent technique again .",
    "they proposed for large characteristic fields an equivalent of the _ rational reconstruction _ technique for prime fields and the _ waterloo _ algorithm @xcite for small characteristic fields , to improve the initializing step preceding the descent .",
    "for dls in prime fields , the target is an integer modulo @xmath1 .",
    "the rational reconstruction method outputs two integers of half size compared to @xmath1 , such that their quotient is equal to the target element modulo @xmath1 . finding a smooth decomposition of the target modulo @xmath1 becomes equivalent to finding a ( simultaneous ) smooth decomposition of two elements , each of half the size .",
    "we explain their method ( that we call the jlsv fraction method in the following ) for extension fields in sec .",
    "[ sec : jlsv06 fraction ] .",
    "[ [ link - with - polynomial - selection . ] ] link with polynomial selection .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the running - time for finding a smooth decomposition depends on the norm of the target preimage .",
    "the norm preimage depends on the polynomial defining the number field .",
    "in particular , the smaller the coefficients and degree of the polynomial , the smaller the preimage norm .",
    "some polynomial selection methods output polynomials that produce much smaller norm . that may be one of the reasons why the record computation of joux _ et al . _",
    "@xcite used another polynomial selection method , whose first polynomial has very small coefficients , and the second one has coefficients of size @xmath53 . thanks to the very small coefficients of the first polynomial , their fraction technique was very useful .",
    "their polynomial selection technique is now superseded by their jlsv@xmath54 method @xcite for larger values of @xmath1 . as noted in @xcite ,",
    "the fraction technique is useful in practice for small @xmath23 .",
    "but for the jlsv@xmath54 method and @xmath3 , this is already too slow ( compared to not using it ) . in 2008 , zajac  @xcite implemented the nfs - dl algorithm for computing dls in @xmath55 with @xmath1 of 40 bits ( 12 decimal digits ( dd ) , i.e. @xmath55 of 240 bits or 74 dd ) .",
    "he used the methods described in @xcite , with a first polynomial with very small coefficients and a second one with coefficients in @xmath53 .",
    "in this case , individual dl computation was possible ( see the well - documented  @xcite ) . in 2013 ,",
    "hayasaka , aoki , kobayashi and takagi  @xcite computed a dl in @xmath56 with @xmath57 ( @xmath58 of 203 bits or 62 dd ) .",
    "we noted that all these records used the same polynomial selection method , so that one of the polynomials has very small coefficients ( e.g. @xmath59 ) whereas the second one has coefficients in @xmath53 .    in 2009 ,",
    "joux , lercier , naccache and thom  @xcite proposed an attack of dlp in a protocol context . the relation collection is sped up with queries to an oracle .",
    "they wrote in ( * ? ? ? *  b ) an extended analysis of individual dl computation . in their case , the individual logarithm phase of the nfs - dl algorithm has a running - time of @xmath60 $ ] where @xmath61 in the large characteristic case , and @xmath62 in the medium characteristic case .",
    "in 2014 , barbulescu and pierrot @xcite presented a multiple number field sieve variant ( mnfs ) for extension fields , based on coppersmith s ideas  @xcite .",
    "the individual logarithm is studied in ( * ? ? ?",
    "they also used a _ descent _ technique , for a global estimated running time in @xmath63 $ ] , with a constant @xmath64 . recently in 2014 , barbulescu , gaudry , guillevic and morain @xcite announced 160 and 180 decimal digit discrete logarithm records in quadratic fields .",
    "they also used a technique derived from the jlsv fraction method and a special-@xmath49 descent technique , but did not give an asymptotic running - time .",
    "it appears that this technique becomes inefficient as soon as @xmath23 = 3 or 4 .",
    "[ [ overview - of - nfs - dl - asymptotic - complexities . ] ] overview of nfs - dl asymptotic complexities .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the running - time of the relation collection step and the individual dl step rely on the smoothness probability of integers .",
    "an integer is said to be @xmath65-smooth if all its prime divisors are less than @xmath65 .",
    "an ideal in a number field is said to be @xmath65-smooth if it factors into prime ideals whose norms are bounded by @xmath65 . usually , the relation collection and the linear algebra are balanced , so that they have both the same dominating asymptotic complexity . the nfs algorithm for dl in prime and large characteristic fields",
    "has a dominating complexity of @xmath66 $ ] . for the individual dl in a prime field @xmath40 ,",
    "the norm of the target preimage in the number field is bounded by @xmath1 .",
    "this bound gives the running time of this fourth step ( much smaller than relation collection and linear algebra ) .",
    "finding a smooth decomposition of the preimage and computing the individual logarithm ( see @xcite ) has complexity @xmath67 $ ] with @xmath68 , and @xmath69 with the improvements of @xcite .",
    "the booting step is dominating . in large characteristic fields ,",
    "the individual dl has a complexity of @xmath70 $ ] , dominated by the booting step again ( ( * ? ? ?",
    "*  b ) for jlsv@xmath71 , table  [ tab : new booting step cpx ] for gjl ) .    in generic medium characteristic fields ,",
    "the complexity of the nfs algorithm is @xmath72 $ ] with the jlsv@xmath54 method proposed in @xcite , @xmath73 $ ] with the conjugation method @xcite , and @xmath74 $ ] with the mnfs version @xcite .",
    "we focus on the individual dl step with the jlsv@xmath54 and conjugation methods . in these cases ,",
    "the preimage norm bound is in fact much higher than in prime fields . without any improvements ,",
    "the dominating booting step has a complexity of @xmath60 $ ] with @xmath62 @xcite or @xmath75 ( * ? ? ?",
    "however , this requires to sieve over ideals of degree @xmath76 . for the conjugation method ,",
    "this is worse : the booting step has a running - time of @xmath77 $ ] ( see our computations in table  [ tab : new booting step cpx ] ) .",
    "applying the jlsv fraction method lowers the norm bound to @xmath78 for the conjugation method .",
    "the individual logarithm in this case has complexity @xmath79 $ ] as for prime fields ( without the improvements of @xcite ) .",
    "however , this method is not suited for number fields generated with the jlsv@xmath54 method , for @xmath3 .      in practice",
    ", we realized that the jlsv fraction method which seems interesting and sufficient because of the @xmath78 bound , is in fact not convenient for the gjl and conjugation methods for @xmath23 greater than 3 .",
    "the preimage norm is much too large , so finding a smooth factorization is too slow by an order of magnitude .",
    "we propose a way to lift the target from the finite field to the number field , such that the norm is strictly smaller than @xmath78 for the gjl and conjugation methods :    [ th : smaller norm bound ] let @xmath6 and @xmath80 a random element ( not in a proper subfield of @xmath0 ) .",
    "we want to compute its discrete logarithm modulo @xmath81 , where @xmath82 , with @xmath83 the @xmath23-th cyclotomic polynomial .",
    "let @xmath17 be the number field given by a polynomial selection method , whose defining polynomial has the smallest coefficient size , and @xmath84/(f(x))$ ] .",
    "then there exists a preimage @xmath85 in @xmath31 of some @xmath86 , such that @xmath87 and such that the norm of @xmath85 in @xmath17 is bounded by @xmath88 , where @xmath89 is equal to    1 .",
    "@xmath90 for the gjl and conjugation methods ; 2 .",
    "@xmath91 for the jlsv@xmath54 method ; 3 .",
    "@xmath92 for the conjugation method , if @xmath17 has a well - chosen quadratic subfield satisfying the conditions of lemma  [ lemma : fp2 simplification ] ; 4 .",
    "@xmath93 for the jlsv@xmath54 method , if @xmath17 has a well - chosen quadratic subfield satisfying the conditions of lemma  [ lemma : fp2 simplification ] .",
    "our method reaches the optimal bound of @xmath94 , with @xmath95 the euler totient function , for @xmath96 combined with the gjl or the conjugation method .",
    "we show that our method provides a dramatic improvement for individual logarithm computation for small @xmath23 : the running - time of the booting step ( finding boots ) is @xmath60 $ ] with @xmath97 for @xmath98 , @xmath99 for @xmath100 and @xmath101 for @xmath102 .",
    "it generalizes to any @xmath23 , so that the norm is always smaller than @xmath78 ( the prime field case ) , hence the booting step running - time in @xmath60 $ ] always satisfies @xmath103 for the two state - of - the - art variants of nfs for extension fields ( we have @xmath104 for prime fields ) . for the jlsv@xmath54 method ,",
    "this bound is satisfied for @xmath105 , where we have @xmath106 ( see table  [ tab : new booting step cpx ] ) .",
    "we select three polynomial selection methods involved for nfs - dl in generic extension fields and recall their properties in sec .",
    "[ subsec : polyselect ] .",
    "we recall a commonly used bound on the norm of an element in a number field ( sec .",
    "[ subsec : norm bound ] ) .",
    "we present in sec .",
    "[ sec : jlsv06 fraction ] a generalization of the jlsv fraction method of @xcite . in sec .",
    "[ sec : asympt cpx ] we give a proof of the booting step complexity stated in lemma  [ th : asympt cpx ] .",
    "we sketch in sec .",
    "[ subsec : special - q descent cpx ] the special-@xmath49 descent technique and list the asymptotic complexities found in the literature according to the polynomial selection methods .",
    "we present in sec .",
    "[ sec : preimage ] our main idea to reduce the norm of the preimage in the number field , by reducing the preimage coefficient size with the lll algorithm .",
    "we improve our technique in sec .",
    "[ sec : preimage smaller norm ] by using a quadratic subfield when available , to finally complete the proof of theorem  [ th : smaller norm bound ] .",
    "we provide practical examples in sec .",
    "[ sec : practical examples ] , for 180 dd finite fields in sec .",
    "[ subsec : 180dd examples ] and we give our running - time experiments for a 120 dd finite field @xmath107 in sec .",
    "[ subsec : fp4 120dd ] .",
    "we recall an important property of the lll algorithm  @xcite that we will widely use in this paper .",
    "given a lattice @xmath108 of @xmath109 defined by a basis given in an @xmath110 matrix @xmath33 , and parameters @xmath111 , @xmath112 , the lll algorithm outputs a @xmath113-_reduced basis _ of the lattice .",
    "the coefficients of the first ( shortest ) vector are bounded by @xmath114 with @xmath113 close to @xmath115 ( as in ntl or magma ) , the approximation factor @xmath116 is bounded by @xmath117 ( see @xcite ) ) .",
    "gama and nguyen experiments @xcite on numerous random lattices showed that on average , @xmath118 . in the remaining of this paper",
    ", we will simply denote by @xmath119 this lll approximation factor .",
    "we will study the booting step of the nfs algorithm with these three polynomial selection methods :    1 .",
    "the joux  lercier ",
    "vercauteren ( jlsv@xmath54 ) method @xcite ; 2 .",
    "the generalized joux  lercier ( gjl ) method @xcite , @xcite ; 3 .",
    "the conjugation method @xcite .    in a non - multiple nfs version ,",
    "the jlsv@xmath71 @xcite and gjl methods have the best asymptotic running - time in the large characteristic case , while the conjugation method holds the best one in the medium characteristic case .",
    "however for a record computation in @xmath4 , the conjugation method was used @xcite . for medium characteristic fields of record size ( between 150 and 200 dd ) ,",
    "is seems also that the jlsv@xmath54 method could be chosen ( @xcite ) . since the use of each method is not fixed in practice , we study and compare the three above methods for the individual logarithm step of nfs .",
    "we recall now the construction and properties of these three methods .",
    "[ [ jouxlerciersmartvercauteren - jlsv_1-method . ] ] joux  lercier  smart  vercauteren ( jlsv@xmath54 ) method .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    this method was introduced in 2006 .",
    "we describe it in algorithm  [ alg : jlsv1 ] .",
    "the two polynomials @xmath120 have degree @xmath23 and coefficient size @xmath121 .",
    "we set @xmath22 monic of degree @xmath23 .",
    "we will use @xmath122 to represent the finite field extension @xmath123/(\\psi(x))$ ] .    select @xmath124 , two polynomials with small integer coefficients ,",
    "@xmath125 @xmath126 a rational reconstruction of @xmath127 modulo @xmath1 @xmath128    [ [ generalized - jouxlercier - gjl - method . ] ] generalized joux ",
    "lercier ( gjl ) method .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    this method was independently proposed in @xcite and @xcite ( see also @xcite ) .",
    "this is a generalization of the joux ",
    "lercier method @xcite for prime fields .",
    "we sketch this method in algorithm  [ alg : gjl ] .",
    "the coefficients of @xmath8 have size @xmath129 and those of @xmath16 have size @xmath130 , with @xmath131 and @xmath132 .",
    "choose a polynomial @xmath133 of degree @xmath134 with small integer coefficients which has a monic irreducible factor @xmath135 of degree @xmath23 modulo @xmath1 reduce the following matrix using lll @xmath136    [ [ conjugation - method . ] ] conjugation method .",
    "+ + + + + + + + + + + + + + + + + + +    this method was published in @xcite and used for the discrete logarithm record in @xmath4 , with @xmath137 .",
    "the coefficient size of @xmath16 is in @xmath130 and the coefficient size of @xmath8 is in @xmath121 .",
    "we describe it in algorithm  [ alg : conjugation ] .",
    "@xmath138 @xmath126 a rational reconstruction of @xmath127 @xmath139    @xmath140      in sec .",
    "[ sec : preimage ] we will compute the norm of an element @xmath141 in a number field @xmath17 .",
    "we will need an upper bound of this norm .",
    "for all the polynomial selection methods chosen , @xmath16 is monic , whereas @xmath8 is not .",
    "we remove the leading coefficient of @xmath16 from any formula involved with a monic @xmath16 .",
    "so let @xmath16 be a monic irreducible polynomial over @xmath142 and let @xmath143/(f(x))$ ] a number field .",
    "write @xmath144 as a polynomial in @xmath145 , i.e. @xmath146 . the norm is defined by a resultant computation : @xmath147 we use kalkbrener s bound ( * ? ? ?",
    "* corollary 2 ) for an upper bound : @xmath148 where @xmath149 , and @xmath150 the absolute value of the greatest coefficient .",
    "an upper bound for @xmath151 is @xmath152 .",
    "we will use the following bound in sec .",
    "[ sec : preimage ] : @xmath153      row and column indices . in the following",
    ", we will define matrices of size @xmath154 , with @xmath155 .",
    "for ease of notation , we will index the rows and columns from @xmath156 to @xmath157 instead of 1 to @xmath158 , so that the @xmath159-th row at index @xmath160 , @xmath161_{0 \\leq j \\leq d-1}$ ] , can be written in polynomial form @xmath162 , and the column index @xmath163 coincides with the degree @xmath163 of @xmath164 .    in 2006",
    "was proposed in @xcite a method to generalize to non - prime fields the rational reconstruction method used for prime fields . in the prime field",
    "setting , the target is an integer modulo @xmath1 .",
    "the rational reconstruction method outputs two integers of half size compared to @xmath1 and such that their quotient is equal to the target element modulo @xmath1 . finding a smooth decomposition of the target modulo @xmath1 becomes equivalent to finding at the same time a smooth decomposition of two integers of half size each .    to generalize to extension fields ,",
    "one writes the target preimage as a quotient of two number field elements , each with a smaller norm compared to the original preimage .",
    "we denote by @xmath141 the target in the finite field @xmath0 and by @xmath165 a preimage ( or lift ) in @xmath166 .",
    "here is a first very simple preimage choice .",
    "let @xmath123/(\\psi(x))$ ] and @xmath167 , with @xmath168 .",
    "we lift the coefficients @xmath169 to @xmath170 then we set a preimage of @xmath141 in the number field @xmath166 to be @xmath171 with @xmath172 such that @xmath173/(f(x))$ ] .",
    "( we can also write @xmath174 , with @xmath35 a root of @xmath16 in the number field : @xmath175",
    "we have @xmath176 .",
    "now lll is used to obtain a quotient whose numerator and denominator have smaller coefficients .",
    "we present here the lattice used with the jlsv@xmath54 polynomial selection method .",
    "the number field @xmath166 is of degree @xmath23 .",
    "we define a lattice of dimension @xmath177 . for the corresponding matrix",
    ", each column of the left half corresponds to a power of @xmath172 in the numerator ; each column of the right half corresponds to a power of @xmath172 in the denominator .",
    "the matrix is @xmath178 the first @xmath23 coefficients of the output vector , @xmath179 give a numerator @xmath180 and the last @xmath23 coefficients give a denominator @xmath181 , so that @xmath182 with @xmath14 a scalar in @xmath142",
    ". the coefficients @xmath183 are bounded by @xmath184 since the matrix determinant is @xmath185 and the matrix is of size @xmath186",
    ". however the product of the norms of each @xmath187 in the number field @xmath166 will be much larger than the norm of the single element @xmath165 because of the large coefficients of @xmath16 in the norm formula .",
    "we use formula to estimate this bound : @xmath188 and the same for @xmath189 , hence the product of the two norms is bounded by @xmath190 .",
    "the norm of @xmath165 is bounded by @xmath191 which is much smaller whenever @xmath192 .",
    "finding a smooth decomposition of @xmath180 and @xmath181 at the same time will be much slower than finding one for @xmath165 directly , for large @xmath1 and @xmath193 .",
    "this is mainly because of the large coefficients of @xmath16 ( in @xmath121 ) .",
    "the method of @xcite to improve the smoothness of the target norm in the number field @xmath17 has an advantage for the gjl and conjugation methods .",
    "first we note that the number field degree is larger than @xmath23 : this is @xmath194 for the gjl method and @xmath177 for the conjugation method .",
    "for ease of notation , we denote by @xmath195 the degree of @xmath16 .",
    "we define a lattice of dimension @xmath196 .",
    "hence there is more place to reduce the coefficient size of the target @xmath165 .",
    "we put @xmath1 on the diagonal of the first @xmath197 rows , then @xmath198 coefficients from row @xmath23 to @xmath199 , where @xmath200 ( @xmath122 is of degree @xmath23 and has @xmath201 coefficients ) .",
    "the rows from index @xmath195 to @xmath196 are filled with @xmath202 ( these elements have @xmath195 coefficients ) .",
    "we obtain a triangular matrix @xmath33 .",
    "@xmath203 since the determinant is @xmath204 and the matrix of dimension @xmath205 , the coefficients obtained with lll will be bounded by @xmath206 .",
    "the norm of the numerator or the denominator ( with @xmath207 ) is bounded by @xmath208 the product of the two norms will be bounded by @xmath78 hence we will have the same asymptotic running time as for prime fields , for finding a smooth decomposition of the target in a number field obtained with the gjl or conjugation method .",
    "we will show in sec .",
    "[ sec : preimage ] that we can do even better .",
    "in this section , we prove the following lemma on the booting step running - time to find a smooth decomposition of the norm preimage .",
    "this was already proven especially for an initial norm bound of @xmath78 .",
    "we state it in the general case of a norm bound of @xmath209 .",
    "the smoothness bound @xmath210 $ ] used here is not the same as for the relation collection step , where the smoothness bound was @xmath211 $ ] .",
    "consequently , the special-@xmath49 output in the booting step will be bounded by @xmath65 .",
    "[ th : asympt cpx ] let @xmath212 of order @xmath81 .",
    "take at random @xmath213 $ ] and assume that the norm @xmath214 of a preimage of @xmath215 , in the number field @xmath17 , is bounded by @xmath216 $ ] .",
    "write @xmath217 $ ] the smoothness bound for @xmath214 .",
    "then the lower bound of the expected running time for finding @xmath218 s.t .",
    "the norm @xmath214 of @xmath219 is @xmath220-smooth is @xmath221 $ ] , obtained with @xmath222 and @xmath223 .",
    "first , we need a result on smoothness probability .",
    "we recall the definition of @xmath65-smoothness already stated in sec .",
    "[ sec : contributions ] : an integer @xmath224 is @xmath65-smooth if and only if all its prime divisors are less than or equal to @xmath65 .",
    "we also recall the @xmath33-notation widely used for sub - exponential asymptotic complexities : @xmath34 = \\exp \\bigl ( \\bigl(c+o(1)\\bigr ) ( \\log q)^\\alpha ( \\log \\log    q)^{1-\\alpha } \\bigr ) \\quad \\mbox { with } \\alpha \\in [ 0,1 ] \\mbox { and    } c > 0~.\\ ] ] the canfield ",
    "pomerance @xcite theorem provides a useful result to measure smoothness probability :    [ cor : b - smooth pr ] suppose @xmath225 , @xmath226 , and @xmath227 are fixed . for a random integer @xmath224 bounded by @xmath228 $ ] and a smoothness bound @xmath229 $ ] , the probability that @xmath224 is @xmath65-smooth is @xmath230\\ ] ] for @xmath231 .",
    "we prove now the lemma  [ th : asympt cpx ] that states the running - time of individual logarithm when the norm of the target in a number field is bounded by @xmath232 .    from theorem",
    "[ cor : b - smooth pr ] , the probability that @xmath224 bounded by @xmath216 $ ] is @xmath220-smooth with @xmath217 $ ] is @xmath233 $ ] .",
    "we assume that a @xmath220-smoothness test with ecm takes time @xmath234 = l_q [ \\frac{\\alpha_{b}}{2 } , ( 2 \\gamma \\alpha_{b})^{1/2}]$ ] .",
    "the running - time for finding a @xmath220-smooth decomposition of @xmath224 is the ratio of the time per test ( ecm cost ) to the @xmath220-smoothness probability of @xmath224 : @xmath235   l_q \\bigl [ 1-\\alpha_{b } , ( 1-\\alpha_{b})\\frac{e}{\\gamma } \\bigr ] ~.\\ ] ] we optimize first the @xmath35 value , so that @xmath236 ( that is , not exceeding the @xmath35 of the two previous steps of the nfs algorithm ) : @xmath237 this gives the system @xmath238 so we conclude that @xmath239 .",
    "the running - time for finding a @xmath220-smooth decomposition of @xmath224 is therefore @xmath240~.\\ ] ] the minimum : this is @xmath241 and find that the minimum of @xmath242 for @xmath243 is @xmath244 . with @xmath245 and @xmath246 , we obtain the minimum : @xmath247 .",
    "] of the function @xmath248 is @xmath249 , corresponding to @xmath223 , which yields our optimal running time , together with the special-@xmath49 bound @xmath65 : @xmath250\\quad \\mbox { with } q \\leq b = l_q\\bigl[2/3 , ( e^2/3)^{1/3}\\bigr]~.\\ ] ]      the second step of the individual logarithm computation is the _",
    "special-@xmath49 descent_. this consists in computing the logarithms of the medium - sized elements in the factorization of the target in the number field . the first special-@xmath49 is of order @xmath251 $ ] ( this is the boot obtained in the initialization step ) and is the norm of a degree one prime ideal in the number field where the booting step was done ( usually @xmath17 ) . the idea is to _ sieve _ over linear combinations of degree one ideals , in @xmath17 and @xmath18 at the same time , whose norms for one side will be multiples of @xmath49 by construction , in order to obtain a relation involving a degree one prime ideal of norm @xmath49 and other degree one prime ideals of norm strictly smaller than @xmath49 .",
    "here is the common way to obtain such a relation .",
    "let @xmath252 be a degree one prime ideal of @xmath17 , whose norm is @xmath49 .",
    "we can write @xmath253 , with @xmath254 a root of @xmath16 modulo @xmath49 ( hence @xmath255 ) .",
    "we need to compute two ideals @xmath256 whose respective norm is a multiple of @xmath49 , and sieve over @xmath257 .",
    "the classical way to construct these two ideals is to reduce the two - dimensional lattice generated by @xmath49 and @xmath258 , i.e. to compute @xmath259 @xmath260 to obtain two degree - one ideals @xmath261 with shorter coefficients .",
    "one sieves over @xmath262 and @xmath263 .",
    "the new ideals obtained in the relations will be treated as new special-@xmath49s until a relation of ideals of norm bounded by @xmath264 is found , where @xmath264 is the bound on the factor basis , so that the individual logarithms are finally known .",
    "the sieving is done in three stages , for the three ranges of parameters .    1 .",
    "for @xmath265 $ ] : large special-@xmath49 ; 2 .   for @xmath266",
    "$ ] with @xmath267 : medium special-@xmath49 ; 3 .   for @xmath268 $ ] : small special-@xmath49 .",
    "the proof of the complexity is not trivial at all , and since this step is allegedly cheaper than the two main phases of sieving and linear algebra , whose complexity is @xmath269 $ ] , the proofs are not always expanded .",
    "there is a detailed proof in @xcite and @xcite for prime fields @xmath40 .",
    "we found another detailed proof in ( * ? ? ? *  b ) for large characteristic fields @xmath0 , however this was done for the polynomial selection of @xcite ( which has the same main asymptotic complexity @xmath269 $ ] ) . in ( * ? ? ?",
    "* , pp .  144150 ) the nfs - dl algorithm is not proposed in the same order : the booting and descent steps ( step ( 5 ) of the algorithm in @xcite ) are done as a first sieving , then the relations are added to the matrix that is solved in the linear algebra phase .",
    "what corresponds to a booting step is proved to have a complexity bounded by @xmath79 $ ] and there is a proof that the descent phase has a smaller complexity than the booting step .",
    "there is a proof for the jlsv@xmath54 polynomial selection in @xcite and ( * ? ? ?",
    "*  a ) for a mnfs variant .",
    "we summarize in tab .  [",
    "tab : cpx - descent - bib ] the asymptotic complexity formulas for the booting step and the descent step that we found in the available papers .",
    ".complexity of the booting step and the descent step for computing one individual dl , in @xmath40 and @xmath0 , in medium and large characteristic .",
    "the complexity is given by the formula @xmath60 $ ] , only the constant @xmath38 is given in the table for ease of notation .",
    "the descent of a medium special-@xmath49 , bounded by @xmath270 $ ] with @xmath267 , is proven to be negligible compared to the large and small special-@xmath49 descents . in ( * ? ? ?",
    "*  b , c ) , the authors used a sieving technique over ideals of degree @xmath271 for large and medium special-@xmath49 descent . [ cols=\"^,^,^,^,^,^,^,^ \" , ]",
    "we present an example for each of the three polynomial selection methods we decided to study .",
    "the conjugation method provides the best timings for @xmath4 at 180 dd @xcite .",
    "we apply the gjl method to @xmath272 according to ( * ? ? ?",
    "* fig .  3 ) .",
    "we decided to use the jlsv@xmath54 method for @xmath107 ( * ? ? ? * fig .",
    "4 ) .",
    "we take the parameters of the record in @xcite : @xmath1 is a 90 decimal digit ( 300 bit ) prime number , and @xmath274 are computed with the conjugation method .",
    "we choose a target @xmath141 from the decimal digits of @xmath275 .",
    "@xmath276 we first compute @xmath277 then reduce @xmath278 then @xmath279 produces @xmath85 of degree 3 and coefficient size @xmath280 .",
    "actually lll outputs four short vectors , hence we get four small candidates for @xmath85 , each of norm @xmath281 , i.e. 90 dd . to slightly improve the smoothness search time",
    ", we can compute linear combinations of these four reduced preimages . @xmath282",
    "the norm of the first element is @xmath283 of 90 decimal digits , as expected . for a close to optimal running - time of @xmath284 \\sim 2^{40}$ ] to find a boot , the special-@xmath49 bound would be around 64 bits .",
    "we take @xmath1 of 60 dd ( 200 bits ) so that @xmath272 has size 180 dd ( 600 bits ) as above .",
    "we took @xmath1 a prime made of the 60 first decimal digits of @xmath286 .",
    "we constructed @xmath287 with the gjl method described in @xcite .",
    "@xmath288 we set @xmath289 .",
    "the lattice to be reduced is @xmath290\\ ] ] then @xmath279 computes four short vectors @xmath85 of degree 3 , of coefficient size @xmath121 , and of norm size @xmath291 .",
    "@xmath292 the norm of the first element is @xmath293 of 117 decimal digits ( with @xmath294 dd ) . for a close to optimal running - time of @xmath295 \\sim 2^{45}$ ] to find a boot , the special-@xmath49 bound would be around 77 bits .",
    "@xmath296 we set @xmath297 .",
    "the subfield simplification for @xmath141 gives @xmath298 we reduce the lattice defined by @xmath299\\ ] ] then @xmath279 produces these four short vectors of degree 3 , coefficient size @xmath121 , and norm @xmath300 ( smaller than @xmath78 ) .",
    "@xmath301 the norm of the first element is @xmath302 of 155 decimal digits ( with @xmath303 ) . for a close to optimal running - time of @xmath304 \\sim 2^{49}$ ] to find a boot , the special-@xmath49 bound would be approximately of 92 bits .",
    "this is very large however .",
    "we experimented our booting step method for @xmath107 of 120 dd ( 400 bits ) . without the quadratic subfield simplification ,",
    "the randomized target norm is bounded by @xmath305 of 135 dd ( 450 bits ) .",
    "the largest special-@xmath49 in the boot has size @xmath306 $ ] ( 25 dd , 82 bits ) according to lemma [ th : asympt cpx ] with @xmath307 .",
    "the running - time to find one boot would be @xmath308 \\sim 2^{44}$ ] .",
    "we apply the quadratic subfield simplification .",
    "the norm of the randomized target is @xmath309 of 105 dd ( @xmath310 350 bits ) .",
    "we apply theorem  [ th : asympt cpx ] with @xmath311 .",
    "the size of the largest special-@xmath49 in the boot will be approximately @xmath312 $ ] which is 21 dd ( 69 bits ) .",
    "the running - time needed to find one boot with the special-@xmath49 of no more than 21 dd is @xmath313 \\sim 2^{40}$ ] ( to be compared with the dominating part of nfs - dl of @xmath314 \\sim 2^{57}$ ] ) .",
    "we wrote a magma program to find boots , using gmp - ecm for @xmath49-smooth tests .",
    "we first set a special-@xmath49 bound of 70 bits and obtained boots in about two cpu hours .",
    "we then reduced the special-@xmath49 bound to a machine word size ( 64 bits ) and also found boots in around two cpu hours .",
    "we used an intel xeon e5 - 2609 0 at 2.40ghz with 8 cores .",
    "we have presented a method to improve the booting step of individual logarithm computation , the final phase of the nfs algorithm .",
    "our method is very efficient for small @xmath23 , combined with the gjl or conjugation methods ; it is also usefull for the jlsv@xmath54 method , but with a slower running - time .",
    "for the moment , the booting step remains the dominating part of the final individual discrete logarithm .",
    "if our method is improved , then special-@xmath49 descent might become the new bottleneck in some cases .",
    "a lot of work remains to be done on final individual logarithm computations in order to be able to compute one individual logarithm as fast as was done in the logjam  @xcite attack , especially for @xmath3 ."
  ],
  "abstract_text": [
    "<S> the number field sieve ( nfs ) algorithm is the best known method to compute discrete logarithms ( dl ) in finite fields @xmath0 , with @xmath1 medium to large and @xmath2 small . </S>",
    "<S> this algorithm comprises four steps : polynomial selection , relation collection , linear algebra and finally , individual logarithm computation . </S>",
    "<S> the first step outputs two polynomials defining two number fields , and a map from the polynomial ring over the integers modulo each of these polynomials to @xmath0 . after the relation collection and linear algebra phases , </S>",
    "<S> the ( virtual ) logarithm of a subset of elements in each number field is known . </S>",
    "<S> given the target element in @xmath0 , the fourth step computes a preimage in one number field . </S>",
    "<S> if one can write the target preimage as a product of elements of known ( virtual ) logarithm , then one can deduce the discrete logarithm of the target .    </S>",
    "<S> as recently shown by the logjam attack , this final step can be critical when it can be computed very quickly . </S>",
    "<S> but we realized that computing an individual dl is much slower in medium- and large - characteristic non - prime fields @xmath0 with @xmath3 , compared to prime fields and quadratic fields @xmath4 . </S>",
    "<S> we optimize the first part of individual dl : the _ booting step _ , by reducing dramatically the size of the preimage norm . </S>",
    "<S> its smoothness probability is higher , hence the running - time of the booting step is much improved . </S>",
    "<S> our method is very efficient for small extension fields with @xmath5 and applies to any @xmath6 , in medium and large characteristic . </S>"
  ]
}