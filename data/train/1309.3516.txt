{
  "article_text": [
    "representing flying quantum information , photons are ideally suited for communication between the stations of a quantum network @xcite . among various photonic quantum states ,",
    "single - photon states are the most fundamental . in principle",
    ", single - photon - based qubits would allow for scalable quantum computation based on linear - optical circuits , auxiliary quantum states of single and many photons , and photon counters @xcite . however , nonclassical states beyond single photons are also expected to be useful for future advanced quantum information processing @xcite .",
    "single - photon sources are often divided into two types @xcite , where one corresponds to transitions in electronic energy levels accompanied by a photon emission , and the other is implemented by probabilistically generating photon pairs , and detecting one photon and thus heralding another one .",
    "the first type of sources allow for an on - demand emission of photons , which has been demonstrated with various matter systems @xcite , such as trapped atoms , defects in diamonds , and semiconductor quantum dots .",
    "however , these systems typically share a common disadvantage , namely a very low efficiency for collecting the emitted photons in a specific single spatial mode , and so it remains unclear whether a photon emission has actually happened until the photon is detected @xcite .",
    "so far , only the class of heralded sources offers high fidelity and flexibility , though at the expense of their intrinsic randomness .",
    "the photon pairs of the heralded sources are typically produced via an optical nonlinearity , namely either parametric down conversion @xcite or four - wave mixing @xcite .",
    "since this only requires a perturbative coupling between light and matter , heralded photons can be emitted in a well - defined mode with good purity and optical coherence . as a consequence ,",
    "a negative wigner function has been observed so far only with this type of source @xcite .",
    "moreover , measuring parts of a nonlinear optical resource state also allows for the heralded preparation of quantum states beyond single photons or qubits @xcite . finally , in contrast to the highly restrictive wavelengths of existing on - demand sources , basically determined by the corresponding matter energy levels , the heralded approach allows for a broader range of wavelengths , in particular , including the telecom wavelength @xcite .",
    "owing to these advantages , the most advanced quantum information experiments have been demonstrated with such heralding schemes @xcite . on the negative side , however , since those events when a photon is heralded are totally random and uncontrollable , the probability for creating many such heralded photons simultaneously , as required for instance in linear - optical quantum computation @xcite , drops exponentially with the number of photons  unless efficient quantum memories are available .",
    "therefore , a possible solution to overcome the intrinsic randomness of the heralded schemes is to store a heralded state until it is required @xcite . indeed ,",
    "single photons were stored in matter systems in previous experiments @xcite . however , by introducing such buffer memories , some of the disadvantages of matter systems again emerge , such as low photon purity and limited tunability of the optical wavelength ( though the memory efficiencies are actually improving @xcite ) . as a remedy , several all - optical experiments have been reported , however , none of them demonstrated high purity @xcite .",
    "moreover , each had their own additional disadvantages : when the optical delay lines were combined with optical switches , only discrete delays were possible @xcite ; when the dynamical control of the q factor of a photonic - crystal nanocavity was successful , the memory time scale was still only sub - nanoseconds @xcite . in any case , it appears generally inefficient to first create flying photons and then couple them with stationary memories .",
    "in fact , using atomic ensemble memories , duan et al .  proposed a scalable quantum repeater with linear optics by smartly unifying the heralding and storage ( write - in ) processes @xcite .",
    "our scheme relies upon a similar one - step mechanism , however , in an all - optical fashion , where a heralded photon is created and automatically stored in an optical cavity .    here",
    ", we propose the storage and controlled release of heralded quantum states by concatenating two cavities , and we experimentally demonstrate our scheme for the case of heralded single photons .",
    "we succeeded for the first time in acquiring , effectively on demand , a quantum feature as strong as the negativity of the wigner function .",
    "this feature is essentially different from the more conventional single - photon character of anti - bunching @xcite , which is immune to linear optical losses and hence valid even for sources with very low purity .",
    "the wigner - function negativity rules out any description in terms of a classical phase - space distribution , and thus is important in quantum computing @xcite .",
    "moreover , we stress that our system is much more general than a simple photon gun .",
    "it is rather an all - optical unification of a ( potentially continuous - variable , high - dimensional ) entanglement generator and a quantum memory .",
    "in fact , our heralding mechanism can produce quantum states of light more general than single photons @xcite , and all such states can be potentially stored in our system . in principle , our system may function as a universal quantum memory , where optical , flying quantum information of arbitrary dimension is written into the memory via unconditional continuous - variable quantum teleportation @xcite , and later recalled on demand .",
    "a schematic of our experimental setup with a diagram in the optical frequency domain is shown in fig .",
    "[ fig : setup ] . inside a nondegenerate optical parametric oscillator ( nopo )",
    "operating far below threshold , signal and idler photons are probabilistically created and simultaneously appearing in different longitudinal modes .",
    "we placed a shutter cavity ( sc ) at the exit of the nopo .",
    "then , a photon inside the nopo passes through the sc only when it is resonant with the sc , while otherwise it remains inside the nopo",
    ". therefore , the nopo concurrently works as a memory cavity ( mc ) . the switch for releasing a photon",
    "is quickly realized by shifting the resonance frequency of the sc using an electro - optic modulator ( eom ) . at first",
    ", we set the sc resonant to an idler photon .",
    "any idler photon immediately escapes from the concatenated cavities and is then sent to a photon detector to herald the presence of its partner signal photon inside the mc [ fig .",
    "[ fig : setup](a , b ) ] .",
    "after the photon creation succeeded , the signal photon can be released by switching the sc whenever wanted [ fig .",
    "[ fig : setup](c , d ) ] . note that an extension of this technique to multi - photon , phase - sensitive states appears to be remarkably straightforward @xcite .",
    "multiple clicks of the photon detector would project the intra - cavity signal state onto a multi - photon state , and , unlike previous demonstrations without memory @xcite , these clicks would not have to occur simultaneously . further note that the switching eom , which is often lossy , is placed outside the mc .",
    "this is another reason for the high purity here compared to a previous scheme based on an optical delay loop that contained the switching eom inside the loop @xcite .    on a more fundamental level ,",
    "that intuitive explanation for the high output purity relies on the physics of general coupled systems .",
    "more specifically , we may define the damping ratio of the coupled cavities to determine whether they are over - damped or under - damped , which is eventually reflected by the pulse shape of the released single photons .",
    "although this observation is certainly of great interest , it is not directly related to the main experimental achievement to be reported here , which is rather the controlled timing for releasing high - purity single photons . therefore , we choose to leave the above issue for future works .",
    "the experimental parameters used in our demonstration are described in the following section and in the supplemental material @xcite .",
    "the output quantum states were characterized by optical homodyne detection .",
    "homodyne detection employs interference with a strong local - oscillator light beam , and hence it indicates the photons coherence and their tunability to some specific wavelength .",
    "this is in strong contrast to single photons verified by anti - bunching , for which two single - photon creations are necessary and quantum coherence is confirmed by the hong - ou - mandel effect @xcite .",
    "the experimental results are shown in fig .",
    "[ fig : results ] , arranged in an array of rows and columns . the storage time was set to @xmath2  ns , @xmath3  ns , @xmath4  ns , and @xmath0  ns in addition to the intrinsic delay of about @xmath5  ns after occurrence of the heralding signal , corresponding to columns from left to right .",
    "first , we focus on the leftmost column , corresponding to the intrinsic delay .",
    "figure  [ fig : results](a ) shows the temporal shape of the wavepacket envelope @xmath6 of the released flying photons , which was estimated from the raw data of homodyne detection @xcite ( details can be found in the supplemental material ) .",
    "the horizontal axis is a relative time , where @xmath2  ns corresponds to the events of the idler photon detection .",
    "after opening the shutter at about @xmath5  ns , the wavepacket amplitude suddenly increases and rapidly goes to zero , which represents the emission of the photon .",
    "the photon pulse width is about @xmath7  ns .",
    "in fact , it can be inferred from the experimental parameters that the photon wavepacket exhibits damped oscillations ( corresponding to under - damping ) .",
    "this is experimentally indicated by the overshoot of the temporal shape down to negative values . before the photon emission",
    ", there are already nonzero values from around @xmath8  ns , showing pre - leakage . in fig .",
    "[ fig : results](b ) , the quadrature samples and their histogram corresponding to the envelope function @xmath6 are presented .",
    "there is a dip at the center of the histogram , which is a characteristic of a single - photon state @xcite . by performing maximum likelihood estimation on the quadrature distribution @xcite",
    ", we obtained the wigner function [ fig .",
    "[ fig : results](c ) ] and the photon - number distribution [ fig .",
    "[ fig : results](d ) ] , where a dip with a negative value of @xmath9 for the wigner function occurs at the phase - space origin as a result of a @xmath10 fraction for the single - photon component .    next , we look at the other panels to see whether the photon wavepacket alters its shape and position for longer storages . as shown in fig .",
    "[ fig : results](a ) , the emission times are correctly shifted . however , the shape of the wavepacket is independent of the storage time , except for the pre - leakage .",
    "these facts together indicate the success of our demonstration .",
    "the single - photon components were estimated as @xmath11 , @xmath12 , and @xmath13 , for @xmath3  ns , @xmath4  ns , and @xmath0  ns , respectively .",
    "although longer storage renders the wigner function positive , the single photons may still be useful depending on applications owing to small multi - photon components @xcite .",
    ", @xmath3 , @xmath4 , and @xmath0 ns , in addition to the intrinsic @xmath5 ns .",
    "( b ) absolute square of the envelopes in * a * , proportional to the photon probability density with respect to time . ( c )",
    "decay of the single - photon component with respect to the storage time , including the intrinsic delay of @xmath5 ns .",
    "red , experimental values of @xmath10 , @xmath11 , @xmath12 , and @xmath13 , with error bars of @xmath14 .",
    "the error was roughly estimated by the bootstrap method @xcite .",
    "blue , exponential fitting curve @xmath15 , where @xmath16 and @xmath17 @xmath18s . ]",
    "all our results are combined in fig .",
    "[ fig : results_summary ] for an easy comparison between the envelope function @xmath6 [ fig .",
    "[ fig : results_summary](a ) ] , its absolute square @xmath19 [ fig .",
    "[ fig : results_summary](b ) ] , and the single - photon component [ fig .",
    "[ fig : results_summary](c ) ] . the probability density for the presence of a photon at time @xmath20 is proportional to the absolute square @xmath19 . from fig .",
    "[ fig : results_summary](b ) , we can infer that the contribution of the pre - leakage is very small .",
    "the lifetime of the photon storage is of the order of @xmath21  @xmath18s , as can be seen from the fitting curve in fig .",
    "[ fig : results_summary](c ) , which is comparable with the lifetimes of some ensemble memories @xcite . in principle",
    ", this lifetime can be further extended by decreasing the intracavity losses . in the following",
    ", we will now summarize our experimental methods .",
    "our setup is shown in fig .  [",
    "fig : setup ] .",
    "the source laser is a continuous - wave ti : sapphire laser with a wavelength of @xmath22  nm .",
    "a part of the laser output is frequency - doubled to @xmath23  nm , which is used as a pump beam for the nopo .",
    "two longitudinal modes of the nopo at @xmath22  nm , separated by a free spectrum range ( fsr ) , are used as the signal and idler . a single longitudinal mode ( idler )",
    "is selected by filter cavities , and a photon detection projects the twin mode ( signal ) onto a single - photon state .",
    "after some predetermined waiting time , a high voltage of @xmath24  v is applied to the eom to release the signal photon .",
    "it was experimentally essential to avoid above - threshold oscillation at the unused longitudinal modes of the nopo .",
    "the photon generation rate was about @xmath0 per second with a nopo pumping power of @xmath25  mw .",
    "the power of the lo was @xmath26  mw , which produced an optical shot noise about @xmath27  db above the detector s electronic noise .",
    "the bow - tie shaped mc contains a periodically - poled ktiopo@xmath28 ( ppktp ) crystal as a nonlinear medium to operate as a nopo ; it has a round - trip length of @xmath29  m ( corresponding to the fsr of @xmath30  mhz ) , where the round - trip optical loss was @xmath31@xmath32 .",
    "these values determine the photon lifetime .",
    "the sc contains a rbtiopo@xmath28 ( rtp ) eom for the resonant - frequency shift ; it has a round - trip length of @xmath33  m , where the round - trip optical loss was @xmath34 .",
    "the coupler reflectivity between the mc and the sc is @xmath35 , while that between the sc and the external field is @xmath36 .",
    "while the homodyne detection is a phase - sensitive measurement , the single - photon state is a phase - insensitive state .",
    "this phase - insensitivity was confirmed by the invariance of the quadrature distribution with the scanned and unscanned phase of the local oscillator .",
    "the photon envelope @xmath6 is determined by the principal component analysis ( pca ) @xcite .",
    "each quadrature sample is obtained by a weighted integral of the continuous homodyne data @xmath37 as @xmath38 . when we replaced the idler beam by other , uncorrelated light before the photon detection , the observed signal state was almost a zero - photon state , which ensures that the original signal field was indeed conditionally obtained via the idler detection .",
    "further information on the experimental methods can be found in the supplemental material @xcite .",
    "in conclusion , we proposed and experimentally demonstrated the insertion of a quickly tunable cavity at the exit of a nopo , effectively serving as a kind of quantum memory .",
    "after a heralded creation , storage , and on - demand release of single photons with this system , the output states exhibited strong nonclassicality , as became manifest through their negative wigner functions .",
    "our device works at normal temperature and pressure .",
    "moreover , our scheme is compatible with hybrid quantum optical experiments , where photon and homodyne detections are employed at the same time , like quantum teleportation @xcite and entanglement distillation @xcite .",
    "many advanced quantum demonstrations are possible with our system in the future , e.g. , the storage and release of multi - photon and/or phase - sensitive states of light @xcite , the controlled interference of many photons simultaneously released from independent memories @xcite , and the deterministic transfer of arbitrary quantum optical states into the memories via unconditional continuous - variable quantum teleportation @xcite .",
    "this work was partly supported by pdis , gia , g - coe , and apsa commissioned by the mext of japan , first initiated by the cstp of japan , and refost of japan .",
    "p.v.l .  acknowledges support from quorep of the bmbf in germany",
    ".    99    n.  gisin and r.  thew , nat .",
    "* 1 * , 165171 ( 2007 ) .    h.j .",
    "kimble , nature ( london ) * 453 * , 10231030 ( 2008 ) .",
    "e.  knill , r.  laflamme , and g.j .",
    "milburn , nature ( london ) * 409 * , 4652 ( 2001 ) .",
    "p.  kok , w.j .",
    "munro , k.  nemoto , t.c .",
    "ralph , j.p .",
    "dowling , and g.j .",
    "milburn , rev .",
    "phys .  * 79 * , 135174 ( 2007 ) .",
    "a.  mari and j.  eisert , phys .  rev .",
    "lett .  * 109 * , 230503 ( 2012 ) .",
    "d.  gottesman , a.  kitaev , and j.  preskill , phys .",
    "a * 64 * , 012310 ( 2001 ) .",
    "p.  marek , r.  filip , and a.  furusawa , phys .",
    "a * 84 * , 053802 ( 2011 ) .",
    "e.  bimbard , n.  jain , a.  macrae , and a.i .",
    "lvovsky , nat .",
    "photon .  * 4 * , 243247 ( 2010 ) .",
    "m.  yukawa , k.  miyata , t.  mizuta , h.  yonezawa , p.  marek , r.  filip , and a.  furusawa , opt .",
    "* 21 * , 55295535 ( 2013 ) .",
    "m.  yukawa , k.  miyata , h.  yonezawa , p.  marek , r.  filip , and a.  furusawa , arxiv:1305.4336 [ quant - ph ] ( 2013 ) .",
    "n.  lee , h.  benichi , y.  takeno , s.  takeda , j.  webb , e.  huntington , and a.  furusawa , science * 332 * , 330333 ( 2011 ) .",
    "s.  takeda , t.  mizuta , m.  fuwa , p.  van loock , and a.  furusawa , nature ( london ) * 500 * , 315318 ( 2013 ) .",
    "eisaman , j.  fan , a.  migdall , and s.v .",
    "polyakov , rev .",
    "instrum .  * 82 * , 071101 ( 2011 ) .",
    "g.s .  buller and r.j .",
    "collins , meas .",
    "technol .",
    "* 21 * , 012002 ( 2010 ) .",
    "castelletto and r.e .",
    "scholten , eur .",
    "j.  appl .  phys .",
    "* 41 * , 181194 ( 2008 ) .",
    "j.  fulconis , o.  alibart , j.l .",
    "obrien , w.j .",
    "wadsworth , and j.g .",
    "rarity , phys .",
    "lett .  * 99 * , 120501 ( 2007 ) .",
    "lvovsky , h.  hansen , t.  aichele , o.  benson , j.  mlynek , and s.  schiller , phys .",
    "lett .  * 87 * , 050402 ( 2001 ) .",
    "neergaard - nielsen , b.  melholt nielsen , h.  takahashi , a.i .",
    "vistnes , and e.s .",
    "polzik , opt .  exp .  *",
    "15 * , 79407949 ( 2007 ) .",
    "s.  fasel , o.  alibart , s.  tanzilli , p.  baldi , a.  beveratos , n.  gisin , and h.  zbinden , new j.  phys .",
    "* 6 * , 163 ( 2004 ) .",
    "c.  simon _ et al . , _ eur .",
    "j.  d * 58 * , 122 ( 2010 ) .",
    "eisaman , a.  andr , f.  massou , m.  fleischhauer , a.s .",
    "zibrov , and m.d .",
    "lukin , nature ( london ) * 438 * , 837841 ( 2005 ) .",
    "t.  chanelire , d.n .",
    "matsukevich , s.d .",
    "jenkins , s .- y .",
    "lan , t.a.b .",
    "kennedy , and a.  kuzmich , nature ( london ) * 438 * , 833836 ( 2005 ) .",
    "specht , c.  nlleke , a.  reiserer , m.  uphoff , e.  figueroa , s.  ritter , and g.  rempe , nature ( london ) * 473 * , 190193 ( 2011 ) .",
    "m.p .  hedges , j.j .",
    "longdell , y.  li , and m.j .",
    "sellars , nature ( london ) * 465 * , 10521056 ( 2010 ) .",
    "lvovsky , b.c .",
    "sanders , and w.  tittel , nat .",
    "photon .  * 3 * , 706714 ( 2009 ) .",
    "pittman , b.c .",
    "jacobs , and j.d .",
    "franson , phys .",
    "a * 66 * , 042303 ( 2002 ) .",
    "q.  xu , p.  dong , and m.  lipson , nat .",
    "phys .  * 3 * , 406410 ( 2007 ) .",
    "y.  tanaka , j.  upham , t.  nagashima , t.  sugiya , t.  asano , and s.  noda , nat .",
    "* 6 * , 862865 ( 2007 ) .",
    "elshaari , a.  aboketaf , and s.f .",
    "preble , opt .",
    "18 * , 30143022 ( 2010 ) .",
    "duan , m.d .",
    "lukin , j.i .",
    "cirac , and p.  zoller , nature ( london ) * 414 * , 413418 ( 2001 ) .",
    "n.  sangouard , c.  simon , h.  de riedmatten , and n.  gisin , rev .",
    "phys .  * 83 * , 3380 ( 2011 ) .",
    "see supplemental material .",
    "k.  sanaka , a.  pawlis , t.d .",
    "ladd , k.  lischka , and y.  yamamoto , phys .",
    "lett .  * 103 * , 053601 ( 2009 ) .",
    "h.  adbi and l.j .",
    "williams , wires comp stat * 2 * , 433459 ( 2010 ) .",
    "k.  banaszek , phys .",
    "a * 57 * , 50135015 ( 1998 ) .",
    "r.  filip and l.  mita , jr .",
    "lett .  * 106 * , 200401 ( 2011 ) .",
    "h.  takahashi , j.s .",
    "neergaard - nielsen , m.  takeuchi , m.  takeoka , k.  hayasaka , a.  furusawa , and s.  masahide , nat .",
    "* 4 * , 178181 ( 2010 ) .",
    "j.  fiurek , phys .",
    "a * 82 * , 042331 ( 2010 ) .",
    "b.  efron and r.j .",
    "tibshirani , _ an introduction to the bootstrap , _",
    "( champman & hall / crc , 1994 ) .",
    "0    * supplemental material for + creation , storage , and on - demand release + of optical quantum states + with a negative wigner function *",
    "in the analysis based on the principal component analysis ( pca ) in the main text , the pre - leakage of the signal photon also contributes to the purity .",
    "the obtained wavepackets are informative in the sense that they show the actual shape of the photon wavepacket , however , the inclusion of the pre - leakage to the analysis reveals an overestimation of the memory lifetime .",
    "an important figure here is the probability of a single photon in a mode time - shifted in accordance with the storage time , because it contributes to a successful multi - photon interference from independent memories .    in figs .",
    "[ fig : results_shifted ] and [ fig : results_summary_shifted ] , we show the results for time - shifted wavepackets .",
    "the wavepacket estimated from the results of the intrinsic delay is the original one . here ,",
    "the time bin from @xmath39  ns to @xmath40  ns was clipped , and the wavepacket then renormalized .",
    "subsequently , it was shifted by @xmath3  ns , @xmath4  ns , and @xmath0  ns to analyze the correspondingly delayed results .",
    "no correction of losses was performed in the data processing .",
    "we anticipate a reduction of the pre - leakage by increasing the number of the shutters serially",
    ". another interesting option would be to monitor the pre - leakage by a photon detector .",
    "if we detect a photon before opening the shutter , we can simply discard the stored light and start a new creation of quantum states . in this way",
    ", the purity will be increased compared to the case of not monitoring the pre - leakage .        , @xmath3 , @xmath4 , and @xmath0 ns , in addition to the intrinsic @xmath5 ns .",
    "( b ) absolute square of the envelopes in ( a ) , proportional to the photon probability density with respect to time . ( c )",
    "decay of the single - photon component with respect to the storage time , including the intrinsic delay of @xmath5 ns .",
    "red , experimental values of @xmath10 , @xmath41 , @xmath42 , and @xmath43 , with error bars of @xmath14 .",
    "blue , exponential fitting curve @xmath15 , where @xmath44 and @xmath45 @xmath18s . ]",
    "in this section , we will describe the experimental methods and parameters , which are not included in the main text , except for the quantum state reconstruction from the homodyne outcomes , which will be discussed separately in the next section .    the schematic setup is shown in fig .",
    "[ fig : setup ] of the main text .",
    "the contents of this section can be listed as follows : first , chopping of bright beams , second , filtering of the idler path , third , detuning of optical frequencies , fourth , data storage by the oscilloscope , fifth , other experimental parameters .      in order to keep the cavities resonant to the laser beams",
    ", we utilized interference of auxiliary bright beams , from which we obtained error signals for classical feedback control .",
    "however , such bright beams , except for the local oscillator ( lo ) beam and the pump beam , can induce fake clicks or even break down the avalanche photodiode ( apd ) .",
    "therefore , in the experiment , we switched the optical system cyclically between two phases : one is the phase for actively controlling the optical system with classical feedback by using bright beams ( classical phase ) , and the other is the phase for manipulating the quantumness at the single - photon level by blocking the bright beams ( quantum phase ) .",
    "the blocking and unblocking of the bright beams was achieved by switching on and off the diffraction via two acousto - optic modulators ( aoms ) .",
    "one aom upshifted the frequency , while the other aom downshifted it to cancel out the frequency shift .",
    "the cavity lengths , which determine the cavity resonances , were controlled by using piezoelectric transducers ( pzts ) , except for the fast switching of the shutter cavity ( sc ) , which was achieved by an electro - optic modulator ( eom ) . during the quantum phase ,",
    "the resonance of the cavities was held by keeping the voltages applied to the pzts .",
    "we also placed a switching aom just before the avalanche photodiode ( apd ) , so that only the beam at the quantum phase can enter the apd .",
    "note that these aoms and pzts , as well as several eoms that modulated the bright beams for the pound - drever - holl locking of the cavities , are omitted from fig .",
    "[ fig : setup ] of the main text .",
    "we repeated the quantum - classical phase changes at a rate of @xmath46  khz and with a time ratio of @xmath47 .",
    "thus , the @xmath0 counts per second for the single - photon generation in the experiment effectively correspond to @xmath48 counts per second if we could maintain the quantum phase .",
    "the repetition was controlled by the same fpga that controlled the storage time after the heralding signals .",
    "the heralding signals were gated by the fpga , so that only those at the quantum phase drive the switching eom of the sc .",
    "we utilized three filter cavities .",
    "one was a bow - tie shaped ring cavity with a round - trip length of @xmath49  mm , and the other two were fabry - perot cavities with a round - trip lengths of several  mm .",
    "the first ring cavity also worked as a spatial separator of the signal and idler beams .",
    "these three cavities had different free spectral ranges ( fsrs ) to prevent beams other than the target idler from entering the apd .",
    "between the two fabry - perot cavities , we inserted an optical isolator in order to decouple the two cavities .",
    "after the final filter cavity , as noted above , we placed an aom for switching the beam path .",
    "a spatial single mode was selected by a single - mode fiber before the apd to reduce fake clicks by stray light .",
    "the transmission efficiencies of the filter cavities were @xmath50 , @xmath51 , and @xmath52 .",
    "that of the optical isolator was @xmath53 .",
    "the diffraction efficiency of the aom was @xmath54 .",
    "the coupling efficiency to the single - mode fiber was @xmath36 .",
    "the apd was an spcm - aqrh-16 ( excelitas technologies ) , whose dark counts were @xmath46 counts per second ( taking into account the time ratio , @xmath55 counts per second ) . note that the losses on the idler line do not deteriorate the purity of the heralded signal - photon states , but only decrease the photon generation rate , including a relative increase of the dark - count contribution .",
    "the bright light source was a continuous wave ( cw ) ti : sapphire laser operating at @xmath22  nm , whose frequency is denoted by @xmath56 .",
    "the optical frequency of the pump , signal , and idler beams for the nondegenerate optical parametric oscillator ( nopo ) are denoted by @xmath57 , @xmath58 , and @xmath59 , respectively . from the energy conservation condition of the parametric down conversion",
    ", we have @xmath60 . here , since we must take into account the finite bandwidth of each beam , we use the approximately equal sign ` @xmath61 ' instead of the equal sign ` @xmath62 ' . for the characterization of the emitted light wavepacket , we employed the output of the ti : sapphire laser without frequency shift as the lo for the homodyne detection , thus @xmath63 .",
    "the signal and idler frequencies were separated by nearly the fsr of the nopo @xmath64 , thus @xmath65 , while we did not distinguish plus or minus in the experiment .",
    "therefore , the pump beam was the second harmonic of the light source with a frequency shift about the fsr , @xmath66 .",
    "the frequency of the second harmonic was shifted by an acousto - optic frequency shifter ( aofs ) to produce the pump beam , as depicted in fig .",
    "[ fig : setup ] of the main text .",
    "however , as will be discussed below , we made use of detuning for various experimental reasons .",
    "the pump frequency shift @xmath67 was not exactly @xmath64 , but detuned by @xmath46  mhz .",
    "in addition , the signal frequency @xmath58 was not exactly at the lo frequency @xmath56 , but detuned by @xmath0@xmath68  khz .",
    "the former detuning was applied on the pump beam by the aofs .",
    "the latter detuning corresponds to a shift of the resonance of the nopo .",
    "however , this detuning was also realized via an aofs , which is omitted from fig .",
    "[ fig : setup ] of the main text .",
    "it was achieved by shifting the frequency of the auxiliary bright beam utilized for the locking of the nopo .",
    "next , we explain the experimental reasons for the two detunings .      as mentioned in sec .  [",
    "sec : experiment ] of the main text , our nopo starts above - threshold oscillation at unused longitudinal modes unless detuning is utilized . since the longitudinal modes are almost equally spaced by the fsr @xmath64 in the frequency domain , whenever a pair of @xmath58 and @xmath59 satisfies the energy conservation condition , there are other pairs of longitudinal modes @xmath69 and @xmath70 with an integer @xmath71 that also satisfy the energy conservation condition .",
    "every longitudinal mode has a different finesse due to the frequency dependence of the sc . the higher the finesse is , the stronger is the intracavity vacuum field of the mode . as a result ,",
    "every pair that satisfies the energy conservation has a different gain of the down conversion , proportional to the product of the corresponding intra - cavity field strengths . in the experiment",
    ", we used the pair of a high - finesse mode ( signal ) and a low - finesse mode ( idler ) at the memory excitation ( write - in ) stage .",
    "however , almost inevitably , pairs exist that are composed of two high - finesse modes .",
    "such pairs have much larger gain of the down conversion than the selected signal and idler pair , thus the nopo easily goes beyond threshold for these pairs .    on the other hand ,",
    "the high - finesse modes have much narrower bandwidth than the low - finesse modes .",
    "thus , in principle , the down conversion gain becomes very small with a small detuning of the pump frequency for a pair of two high - finesse modes , while it remains almost unchanged for a pair of high- and low - finesse modes . by this technique",
    ", the above - threshold oscillation can be avoided .",
    "experimentally , a relatively large detuning of @xmath46  mhz was introduced to remove any above - threshold oscillation .",
    "another option would be to insert wavelength - selective components inside the mc or the sc .",
    "however , since such components are typically lossy , we did not explore this option in our demonstration .      in the experiment ,",
    "the lo beam for the homodyne detection was not switched .",
    "therefore , the lo was being scattered during the quantum phase , mainly at the photodiodes of the homodyne detector .",
    "we observed that the scattered lo , corresponding to a weak coherent state at the single - photon level , was stored inside the mc and induced phase - space displacements of the stored signal states .",
    "this can be avoided though , with only a small deterioration of the measured quality of the single - photon states , by slightly detuning the signal - mode frequency of the mc from that of the lo .",
    "we detuned the signal frequency by @xmath0  khz@xmath68  khz , which is much smaller than the released photon bandwidth of about @xmath27  mhz and thus did not significantly degrade the photon quality observed by the homodyne detection .",
    "the detuning was achieved by a small shift of the mc round - trip length from the lo resonance , controlled by a pzt .",
    "we did not take much care of the exact value of the detuning , because the target quantum state was a phase - insensitive single - photon state .",
    "if we did want to write in a phase - sensitive state , since the stored state during its storage is expected to rotate in phase space relative to the lo frame at the detuning frequency , we would have to either compensate this rotation or remove the displacements from the lo scattering according to the detuning condition .",
    "however , we stress that the scattered light in our experiment was solely a technical problem of the verification part of the setup , and not at all a fundamental deficiency of the memory system itself .",
    "the heralding signals , which were processed by the fpga , were not only to trigger the eom driver , but also to trigger the oscilloscope storage of the homodyne signal .",
    "the oscilloscope captured the homodyne signal for @xmath21  @xmath18s around each trigger signal .",
    "the resolution of the analog - to - digital conversion was @xmath72  bits and the sampling rate was @xmath21  gs / s .",
    "we repeatedly acquired the frame @xmath73 times for each condition .",
    "in addition to the parameters given above and in sec .  [ sec : experiment ] of the main text , there are the following experimental parameters : the propagation efficiency from the exit of the sc to the homodyne detector was @xmath35 , the quantum efficiency of the homodyne detector was @xmath74 , and the interference visibility between the lo and the output beam of the sc was @xmath74 .    the size of the second - order nonlinear optical ppktp crystals for the nopo and the shg was @xmath75  mm in length and @xmath21  mm by @xmath21  mm in cross section .",
    "the radius of curvature of the two concave mirrors of the nopo was @xmath5  mm , while the focal length of the lens inside the sc was @xmath68  mm .",
    "the fpga that controled the bright beam chopping and the delay of the trigger signal to shift the resonance of the sc was virtex-4 ( xilinx ) .",
    "the fpga clock period was @xmath75  ns , and thus , in our system , the photon emission times were discretized into @xmath75  ns intervals , whereas the optical system itself would , of course , allow emissions continuous in time .",
    "as described above , we recorded a @xmath21  @xmath18s frame of homodyne signal around each heralding signal .",
    "every frame contained a single measurement result corresponding to a single - photon state . however , every frame also contained vacuum noise of other orthogonal modes",
    ". we must therefore extract the information of the target single photon from such background noise , which is a big difference from click - by - click photon detection . in this section",
    ", we will compare the homodyne and photon detections , and discuss how the information of the single - photon state can be extracted from the homodyne signal .",
    "the contents of this section are as follows .",
    "we will first review the mathematical description of the output wavepacket , introducing the mode function .",
    "the mode function is equivalent to the wavepacket envelope used in the main text , however , here we choose a different terminology .",
    "next , we will describe both the photon and the homodyne detection , with a focus on optical coherence .",
    "then , we explain how to estimate the mode function via the pca .",
    "finally , we briefly describe how to represent quantum states by wigner functions .      since the transverse modes and the polarization are determined by the lo , here we focus on the longitudinal modes of the wavepackets .",
    "we use the time @xmath20 as a continuous degree of freedom in the longitudinal direction , which could also be , alternatively , the spatial coordinate @xmath76 , with @xmath77 and @xmath78 the speed of light .",
    "we define annihilation and creation operators at time @xmath20 as @xmath79 and @xmath80 , respectively .",
    "their commutation relation is , @xmath81 = & \\delta(t - t^\\prime ) , & [ \\hat{a}(t),\\hat{a}(t^\\prime ) ] = & 0,\\end{aligned}\\ ] ] where @xmath82 is the dirac delta function .",
    "the photon density operator at time @xmath20 is defined as , @xmath83    similarly , we define annihilation and creation operators for a wavepacket mode specified by a mode function @xmath6 as follows , @xmath84 where the superscript @xmath85 denotes the complex conjugate . in the following , for simplicity",
    ", we often drop the argument @xmath86 of the mode function .",
    "the usual single - mode bosonic commutation relations are equivalent to the normalization of the mode function @xmath87 , with the inner product of two mode functions , @xmath88 the corresponding photon - number operator is defined as , @xmath89 note that @xmath90 is very different from @xmath91 . related to this fact is the impossibility to determine the photon number in a given wavepacket @xmath92 in a simple way using photon detection , as will be discussed later .",
    "an infinite set of orthonormal mode functions @xmath93 specifies orthogonal modes such that @xmath94 = & \\delta_{k\\ell } , & \\text{iff}\\quad ( \\psi_k,\\psi_\\ell ) = & \\delta_{k\\ell},\\end{aligned}\\ ] ] where @xmath95 is the kronecker delta .",
    "we choose an infinite number of such orthonormal functions @xmath93 to obtain a basis for the function space .",
    "then , the creation operator of an arbitrary mode @xmath92 is expressed in this basis as , @xmath96 since the number operators @xmath97 of orthonormal modes are mutually commutative and independent , they have simultaneous eigenstates with independent eigenvalues @xmath98 , @xmath99 where @xmath100 is the zero - photon ( vacuum ) state , @xmath101 for all @xmath20 .",
    "an arbitrary pure state is a superposition of such number states .",
    "this also means that the overall hilbert space @xmath102 of the multi - mode quantum states can be decomposed into a tensor product of single - mode hilbert spaces , @xmath103 operators acting on the total hilbert space @xmath102 may also be decomposed into such tensor products , e.g. , @xmath104 where @xmath105 is the identity operator .",
    "however , this does not hold in general .",
    "for example , a density operator @xmath106 which can not be expressed as a convex sum of tensor products describes an entangled ( inseparable ) state .",
    "the single - mode density operator @xmath107 is obtained by tracing out all the orthogonal modes , @xmath108 where @xmath109 is the partial trace over a hilbert space @xmath110 . in the following",
    ", we will use @xmath106 for an overall density operator and @xmath111 for a density operator reduced to a single mode .",
    "an ideal single - photon state , for which exactly one photon is present in some wavepacket @xmath92 , is expressed as @xmath112 realistic single - photon states , however , are effectively mixtures of the above pure single - photon state and the vacuum state , @xmath113 from the decomposition in eq .  , the reduced density operator of the mode @xmath114 is , @xmath115 \\notag\\\\ & = p|(\\psi_0,\\psi)|^2 { |{1}\\rangle } { \\langle{1}| } + [ 1-p|(\\psi_0,\\psi)|^2 ] { |{0}\\rangle } { \\langle{0}| } , \\end{aligned}\\ ] ] where @xmath116 is a single - mode @xmath71-photon state .",
    "as expected , the purity is maximized by setting the observed mode function @xmath114 equal to the ideal mode function of the single photon @xmath92 . however , whenever these two functions are different , the purity decreases depending on the mode mismatch from @xmath117 to @xmath118 .    for a single - photon state , the photon density with respect to time @xmath20 is , @xmath119 therefore , as mentioned in the main text , the probability density for the presence of a photon at time @xmath20 is proportional to the absolute square of the mode function .      a photon detector , such as an apd in the geiger mode , detects photons click by click in a particle - like manner , whereas a homodyne detector observes the wave - like interference of the signal with a lo .",
    "therefore , unlike photon detection , a single homodyne outcome can never show the presence of a photon .",
    "however , from the statistics of the outcomes , we can estimate the state  a technique known as quantum tomography .",
    "homodyne characterization is advantageous in several respects , such as high quantum efficiencies and the full characterization of a single optical mode . on the other hand",
    ", it is also demanding , because it requires a light source coherent with the target field .",
    "what we would like to stress here is that the sole capability of homodyne verification is already an indication for the coherence of the obtained single photons .",
    "this is in strong contrast to photon - detection - based verification relying upon the observation of anti - bunching .",
    "the latter negates the simultaneous presence of photons , but it contains no information about the coherence .",
    "another important point is that the anti - bunching is immune to linear optical losses . on the other hand ,",
    "the purity , which is given by the probability of the corresponding wavepacket to contain exactly one photon , also directly represents the success probability for creating single photons in the specific wavepackets coherently .",
    "the purity is degraded by optical losses , and in this sense , it is generally much more difficult to obtain good purity than to obtain good anti - bunching .      here",
    "we suppose that the speed of the photon detector is high enough compared to the time scale of the photon wavepacket .",
    "then , the observable of the photon detection at time @xmath20 is well approximated by the photon density operator @xmath120 . given a density operator @xmath106 containing at most one photon ,",
    "the probability density of the photon detection is @xmath121 , where @xmath122 is the quantum efficiency of the detection system . inserting the density operator @xmath123 from eq .",
    ", we obtain the probability density to detect a photon at time @xmath20 , @xmath124 therefore , by taking statistics of the detection time @xmath20 , we gain information about the mode function without its phase component , @xmath125 . the photon probability @xmath117 is estimated from @xmath126 if the quantum efficiency @xmath122 is known . however , as already mentioned , detecting a photon with a probability density @xmath127 can never be a proof for the presence of a photon in a wavepacket @xmath92 . for example , we are not able to distinguish functions different in phase , @xmath6 and @xmath128 .",
    "note that an optical frequency shift by @xmath129 corresponds to setting @xmath130 .",
    "furthermore , we can not even distinguish a pure state from a decohered mixed state . in order to show this",
    ", we consider smooth functions @xmath131 in order to deconvolute the photon density as @xmath132 , where @xmath133 and @xmath134 .",
    "then , a mixed state , @xmath135 gives the same probability density @xmath136 as a pure single - photon state @xmath137 .",
    "however , the single - photon purity with respect to the wavepacket @xmath138 is decreased from @xmath21 to , @xmath139 { |{1}\\rangle } \\notag\\\\ = \\int d\\tau p(\\tau)|(\\phi_\\tau,\\psi)|^2.\\end{aligned}\\ ] ]    the discrepancy between a photon click and the actual purity associated with some mode function @xmath114 may be explained as follows .",
    "the quantum state @xmath107 must be estimated from the observables on the mode @xmath114 , constructed from @xmath140 and @xmath141 .",
    "however , any observable constructed from @xmath142 can never provide this due to the lack of interference terms @xmath143 for @xmath144 .",
    "as will be discussed later , in contrast , homodyne detection can provide observables that are constructed from @xmath140 and @xmath141 , which allows us to estimate @xmath107 .    since the coherence , as well as the stability of the frequency , etc .",
    ", is crucial for interferometric usage , these properties should be ensured experimentally .",
    "for this purpose , in photon detection experiments , we typically create two photons and check the beam splitter interference , by which we observe the photon bunching effect depending on their indistinguishability , i.e. , whether they have identical frequencies , polarizations , and so forth ; but not whether some decoherence like in eq",
    ".   occurs .",
    "so far , we have discussed photon detection on fields which contain at most one photon . in the experiment , also the effective vanishing of the multi - photon probability must be checked to verify the single - photon character . this can be achieved by observing the anti - bunching effect , which appears in the second - order photon correlation , @xmath145 where @xmath146 is the expectation value of an observable @xmath147 , and @xmath148 is the normally ordered form of an operator @xmath147 .",
    "it is obtained by using two photon detectors ( the hanbury - brown and twiss setup ) .",
    "if the multi - photon probability is zero at any instant of time , we have @xmath149 . in contrast , when the photon probabilities are totally uncorrelated , @xmath150 , which is typically the case for @xmath151 .",
    "therefore , the anti - bunching is typically observed as a gap at @xmath152 in the correlation function @xmath153 .",
    "a coherent state shows a poissonian statistics corresponding to @xmath154 , irrespective of its average photon number , and we have @xmath155 for any incoherent mixture of coherent states .",
    "therefore , a measure of the quality of a single - photon stream is , beyond the classical limit of one , how much @xmath156 gets closer to zero .",
    "note that @xmath153 itself says nothing about the coherence of the single photons , similar to the case of a single - photon detector discussed above .",
    "another point is that @xmath156 is the multi - photon probability normalized by the single - photon probabilities , such that it quantifies the deviation from a random photon emission .",
    "therefore , @xmath153 remains unchanged under linear optical losses ( i.e. , the effect of @xmath157 is canceled between the numerator and denominator ) .",
    "this is both good and bad . on the one hand",
    ", it can verify the nonclassicality of a very faint light beam , where the photon detection events only scarcely occur . on the other hand",
    ", it even validates very inefficient single - photon sources , even though these may be actually creating wavepackets very close to vacuum states .",
    "such inefficient , rarely successful single - photon generators are not useful for many applications .    on the other hand , the single - photon purity measures how much a given wavepacket @xmath114 contains the ideal single - photon state in a coherent manner .",
    "especially , when its value exceeds one half , a stronger form of nonclassicality , that is the negativity of the wigner function , emerges . the density matrix and the wigner function are usually obtained by homodyne tomography , as we discuss next .",
    "the annihilation and creation operators @xmath158 and @xmath159 in the particle picture correspond to complex and complex conjugate amplitudes of the light field in the wave picture .",
    "they are not observables , because they are not self - adjoint . however , the quadrature amplitudes are self - adjoint , @xmath160 analogously to the quantum mechanical position and momentum operators , @xmath161 and @xmath162 can not be simultaneously measured with perfect precision , since they do not commute with each other , @xmath163=i$ ] .",
    "the instantaneous outcome of the homodyne detection is , for an ideal detector with infinite bandwidth , a quadrature at time @xmath20 , @xmath164/\\sqrt{2}$ ] , as shown below .",
    "note that realistically , due to the finite bandwidth of the detector , we can never measure a truly instantaneous quadrature , which would have an infinitely large variance .",
    "however , since we are interested in a situation where the bandwidth of single photons is much narrower than that of the homodyne detector , we may faithfully equate an instantaneous homodyne outcome with an instantaneous quadrature outcome .",
    "homodyne detection measures the interference between a lo beam and a signal light field .",
    "the lo has a large coherent amplitude @xmath165 .",
    "we consider a rotating frame , so that the complex amplitude of the lo is constant . by combining at a beamsplitter the lo and an instantaneous field represented by the annihilation operator @xmath79",
    ", we obtain the two output field amplitudes @xmath166 and @xmath167 .",
    "we then detect their photocurrents and take the difference of the two signals , which is proportional to a certain quadrature , @xmath168 therefore , by adjusting the phase @xmath169 of the lo , we can measure any quadrature at an arbitrary phase .",
    "the quadrature values @xmath170 of mode @xmath92 can be expressed as an integral over the instantaneous quadratures , @xmath171\\hat{x}(t)+{\\mathrm{im}}[\\psi(t)]\\hat{p}(t)\\}.\\end{aligned}\\ ] ] since we can not simultaneously measure @xmath172 and @xmath173 at any time @xmath20 , in general , we do not obtain a measurement outcome for @xmath170 from the instantaneous outcomes .",
    "however , if the mode function @xmath92 is a real function in the rotating frame of the lo , we obtain @xmath170 by integrating over @xmath172 with a weight function of @xmath6 .",
    "this condition is the same as matching the frequencies of the signal mode and the lo .",
    "the quadrature distribution of an arbitrary single - mode state @xmath174 is sensitive to the phases @xmath169 .",
    "such a state can be reconstructed from the distributions of the quadratures @xmath175 for various phases @xmath169 .",
    "however , all photon - number states , including the vacuum and single - photon states as well as their incoherent mixtures , have phase - insensitive quadrature distributions , which exactly applies to our experiment .",
    "therefore , we could reconstruct a diagonal density operator @xmath176 , containing the corresponding photon - number distribution , from the quadrature distribution for some single phase . as described in sec .",
    "[ sec : experiment ] of the main text , the phase - insensitivity of our quantum states was experimentally confirmed by checking that two distributions coincide : one for which the lo phase @xmath169 was slowly scanned , and another one for which it was not scanned .",
    "this phase scan was slow enough so that the phase remained constant within each photon pulse . in the following ,",
    "we choose the measured observable to be @xmath161 without loss of generality .    as can be found in standard textbooks , the quadrature distributions of the vacuum and single - photon states are , @xmath177 similarly , all multi - photon states have their own distributions",
    ". the distribution for an incoherent mixture of photon - number states can be decomposed into distributions of pure photon - number states , @xmath178 the photon - number distribution corresponds to the coefficients of this decomposition . in the decomposition of the experimental distribution",
    ", we maximized the likelihood by using the downhill simplex method .",
    "as discussed above , if we know a priori the real mode function @xmath92 of the single photons , we can obtain the density operator @xmath107 that maximizes the purity @xmath179 by setting @xmath180 . in the experiment , we estimated the mode function @xmath92 from the homodyne raw data .",
    "this was possible , because only a single mode @xmath92 was excited , and the other orthogonal modes were basically in vacuum states .",
    "therefore , we could easily observe the target mode @xmath114 , since its photon number is maximized .",
    "note that this maximization of the photon number is equivalent to the maximization of the phase - insensitive quadrature variance , @xmath181    from the homodyne raw data , we can calculate the auto - covariance , @xmath182 then , optimization of the mode function @xmath114 corresponds to finding the eigenfunction of the auto - covariance , which then gives the maximal eigenvalue .",
    "therefore , the problem is solved via the spectral decomposition of the auto - covariance . in the experiment , owing to the finite sampling rate and the finite frame length , the auto - covariance gives a finite - dimensional square matrix , whose diagonalized form serves our purposes .",
    "this method of decomposing a mixed signal into independent signals is referred to as the principal component analysis ( pca ) .",
    "note that , in order to validate this method , the detector response must be sufficiently flat in the frequency region of interest .",
    "in addition , the pca never discriminates two components with the same variance .",
    "therefore , in case there is some noise due to experimental imperfections , with a variance close to that of a single - photon quadrature , the resulting function becomes in general a combination of that noise and the true function .",
    "the quadrature samples are random , obeying some statistics .",
    "therefore , an estimation via the pca may capture the accidental deviation from the true distribution , which increases the eigenvalue , leading to some overestimation of the average photon number .",
    "this query then affects the precision of the estimation of the mode function @xmath114 .",
    "we checked that the mode match @xmath183 between two mode functions obtained from two different sets of quadrature samples was typically more than @xmath74 .",
    "even when we used different sets of samples for the estimation of mode @xmath114 and for the estimation of the photon - number distribution @xmath107 , the change in the obtained purity was negligible .",
    "a wigner function @xmath184 of a single - mode quantum state is a two - dimensional quasi - probability distribution in phase space , characterized by an operator algebra @xmath163 = i$ ] , @xmath185 it resembles a classical distribution function @xmath186 in the phase space of a general position @xmath187 and momentum @xmath117 , where each point of the function @xmath186 has a meaning of a joint probability density . just like a classical distribution function",
    ", the wigner function gives the correct quadrature distributions via its marginal distributions , @xmath188 the distribution of a quadrature @xmath189 at an arbitrary phase @xmath169 is obtained similarly .",
    "the biggest difference between wigner and classical distribution functions is that wigner functions allow for negative values . due to the uncertainty principle",
    ", we can never determine the conjugate variables @xmath161 and @xmath162 simultaneously .",
    "therefore , a single point of the wigner function @xmath184 alone can not be interpreted as a joint probability ; only when integrated , the meaning of a probability density arises , like in eq .  .",
    "for this reason , wigner functions may take on negative values  a strong quantum feature , because it is a consequence of the noncommutative operator algebra .",
    "note that even though @xmath184 may take on negative values , the integrated probability densities never become negative .",
    "in fact , a single - photon state is a prominent example of such nonclassical states with a negative wigner function .",
    "the wigner functions for a single - photon and a vacuum state are given by , @xmath190 as expected , they are rotationally symmetric in the @xmath187-@xmath117 plane . the function is always positive for a vacuum state ( being a gaussian function ) , whereas it has a negative region for a single - photon state . in particular , at the phase - space origin , the function value is @xmath191 for a vacuum state , while it is @xmath192 for a single - photon state . since the map between a wigner function and a density operator is linear , the wigner function for an incoherent mixture of a vacuum state and a single - photon state is obtained by summing their wigner functions with the corresponding weights , @xmath193 thus , if the single - photon component exceeds one half , the total wigner function has negative values around the origin .",
    "more precisely , for even - photon - number states , we have @xmath194 , while for odd - photon - number states , @xmath195 . therefore ,",
    "if the contribution of multi - photon components , e.g. , a three - photon component , is no longer negligible , the wigner function can take on negative values even if the single - photon purity is below one half ."
  ],
  "abstract_text": [
    "<S> highly nonclassical quantum states of light , characterized by wigner functions with negative values , have been created so far only in a heralded fashion . in this case </S>",
    "<S> , the desired output emerges rarely and randomly from a quantum - state generator . </S>",
    "<S> an important example is the heralded production of high - purity single - photon states , typically based on some nonlinear optical interaction . </S>",
    "<S> in contrast , on - demand single - photon sources were also reported , exploiting the quantized level structure of matter systems . </S>",
    "<S> these sources , however , lead to highly impure output states , composed mostly of vacuum . </S>",
    "<S> while such impure states may still exhibit certain single - photon - like features such as anti - bunching , they are not enough nonclassical for advanced quantum information processing . </S>",
    "<S> on the other hand , the intrinsic randomness of pure , heralded states can be circumvented by first storing and then releasing them on demand . here </S>",
    "<S> we propose such a controlled release , and we experimentally demonstrate it for heralded single photons . we employ two optical cavities , where the photons are both created and stored inside one cavity , and finally released through a dynamical tuning of the other cavity . </S>",
    "<S> we demonstrate storage times of up to @xmath0 ns , while keeping the single - photon purity around @xmath1 after storage . </S>",
    "<S> this is the first demonstration of a negative wigner function at the output of an on - demand photon source or a quantum memory . in principle , our storage system is compatible with all kinds of nonclassical states , including those known to be essential for many advanced quantum information protocols . </S>"
  ]
}