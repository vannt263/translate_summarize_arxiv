{
  "article_text": [
    "the paper considers the optimization of general one - hop multiple - input multiple - output ( mimo ) interference networks .",
    "such a network can be represented by a bipartite graph with multi - antenna transmitter nodes on the left and multi - antenna receiver nodes on the right , with non - zero channels between them as edges .",
    "each transmitter may send independent data to multiple receivers and each receiver may collect independent data from multiple transmitters .",
    "consequently , the network is a combination of multiple interfering broadcast channels ( bc ) and multiaccess channels ( mac ) and we name it the broadcast - multiaccess channel ( b - mac ) , the _ b - mac network _ , or the b - mac interference network .",
    "it includes bc , mac , interference channels @xcite , x channels @xcite , x networks @xcite , and most practical communication networks , such as ( cooperative ) cellular networks , wireless lan , and digital subscriber line , as special cases .",
    "therefore , optimization of such networks has both theoretical and practical impact .",
    "we assume gaussian input and that each interference is either completely cancelled or treated as noise .",
    "a wide range of interference cancellation is allowed , from no cancellation to any cancellation specified by a binary coupling matrix of the data links , as long as each signal is decoded and possibly cancelled at no more than one receiver .",
    "for example , simple linear receivers , dirty paper coding ( dpc ) @xcite at transmitters , and/or successive interference cancellation ( sic ) at receivers may be employed . for the more sophisticated han - kobayashi scheme where a common message is decoded at more than one receiver ,",
    "the results in this paper may be generalized as discussed in remark [ rem : ext - han - kobayashi ] of section [ sub : polite water - filling ] and in section [ sec : conclusion ] .",
    "the reasons of considering the above setting are as follows .",
    "1 ) the capacity regions and optimal transmission strategies of b - mac networks are unknown except for the special cases of bc and mac , where dpc and sic are optimal . even for the well studied mimo bc and mac , the optimal input structure is unknown in general , except for the water - filling structure for sum - rate optimal points @xcite .",
    "2 ) low complexity is desired in practical systems . the more sophisticated techniques such as han - kobayashi scheme",
    "@xcite may not be implementable if the transmission schemes of the interference are not available and thus , can not be decoded .",
    "3 ) treating weak interference as noise is sometimes optimal @xcite .",
    "4 ) limiting to the above setting enables us to make progress and gain insight into the problem .",
    "the results and insight serves as a stepping stone to more sophisticated design .",
    "the generally non - convex optimization of this important class of networks has been hindered by that beyond the full solution in the 1998 seminal work @xcite on single antenna multiaccess channels , little is known about the structure of the pareto optimal input of the achievable rate region . finding the boundary points of a mac / bc capacity region ,",
    "can be done using modified general purpose convex programming , e.g. , @xcite .",
    "but it is desirable to exploit the structure of the problem to design more efficient and lower complexity algorithms that will work well for more general networks where the problems are likely non - convex .",
    "for the special case of sum - rate maximization in mimo mac , a water - filling structure is discovered in @xcite .",
    "the sum - rate can be combined into one logdet function as in the single - user case .",
    "then , one user s optimal input has the single - user water - filling structure when other users signals are considered as noise . for individual power constraints",
    ", it results in a simple and efficient iterative water - filling algorithm @xcite . using duality ,",
    "the approach is modified for sum - rate maximization for bc to take care of sum power constraint instead of individual power constraints @xcite .",
    "the above approach works because the objective function happens to look like a single - user rate and thus , can not be used for weighted sum - rate maximization , which depends on other pareto optimal points .",
    "the approach in @xcite is generalized for weighted sum - rate maximization with a single antenna at receivers @xcite .",
    "its generalized water - filling structure no longer has an exact water - filling interpretation and can not be used for the cases with more than one receive antennas .",
    "directly applying single - user water - filling to networks is referred to as selfish water - filling here .",
    "it is well known to be far from optimal @xcite .",
    "the reason is that selfish water - filling only considers the interference from others , without considering the interference to others , when maximizing a link s own rate .",
    "based on selfish water - filling , the game - theoretic , distributed , and iterative algorithms have been well studied for the digital subscriber line @xcite , which has parallel siso ( single - input single - output ) interference channels , for mimo interference channels , e.g. , , and for multiaccess channels , e.g. , @xcite .",
    "the uniqueness of the nash equilibrium is established and the algorithms converge only under stringent conditions . even in the case of convergence ,",
    "the performance is rarely optimal    the importance of controlling interference to others has been recognized in literature , e.g. , @xcite . but a systematic , general , and optimal method has not been found . in @xcite , siso ( parallel ) interference channels is considered . the idea in @xcite is to minimize each link s individual interference to the single most vulnerable user subject to this link s minimum rate requirement . in @xcite ,",
    "it is proposed to levy a tax on each user s power .",
    "the tax rate of a user is the negative of the derivative of other users weighted sum - rate over the user s power . in ( * ? ? ?",
    "* section iv ) , after directly solving the karushkuhntucker ( kkt ) conditions , a term @xmath0 , which is the same as the previous tax rate , appears in the solution and affects the water - filling level . in @xcite",
    ", it is recognized that the traditional water - filling is selfish and in a mimo interference channel , the direction causing less interference to others is the same as the direction receiving less interference from others in the reverse link .",
    "consequently , the following problems have been open .    * in single - user mimo channels or parallel channels , no one uses general purpose convex programing for transmitter optimization because we know the optimal input structure is water - filling and thus , we only need to optimize the parameters of the water - filling . why havent we been able to do the same for networks ?",
    "* what is the optimal input structure of _ all _ boundary points of the mimo mac / bc capacity region ? * is it possible that there exists some kind of water - filling that is different from the single - user water - filling and is optimal for all boundary points of the mac capacity region ?",
    "if so , it can be used to design low - complexity high - performance algorithms for all optimization problems related to the boundary points .",
    "general purpose convex programing is no longer necessary . *",
    "even more ambitious questions are for the b - mac networks .",
    "these general interference networks are much less understood and the related optimization problems are generally non - convex .",
    "what is the optimal input structure of all the boundary points of the achievable region ?",
    "what is the optimal method to control interference to others while avoiding interference from others in a network ?",
    "can we decompose a network to multiple equivalent single - user channels so that the ( distributed ) optimization can be made easy ?",
    "does there exist a network version of water - filling that is optimal ?",
    "can we use the optimal input structure to design low complexity algorithms for all related optimization problems , including those for cellular networks , multi - cell cooperative networks , cognitive radios , and digital subscriber lines , so that it is hard not to find near optimal solutions even in non - convex cases",
    "?    the main contribution of this paper is an optimal network version of water - filling for the above problems .",
    "related method to water - filling is zero forcing , which has good performance at high signal - to - noise power ratio ( snr ) .",
    "spatial interference alignment @xcite can be viewed as the network counter part of zero - forcing in broadcast channels and can be found by transmitter optimization algorithms . in @xcite ,",
    "the duality based alternating optimization is employed to design distributed interference alignment algorithms .",
    "however , interference alignment is usually suboptimal at moderate or low snr .",
    "better algorithms solving the problem of how to choose the right number of data streams for each link is given in @xcite .",
    "in @xcite , interference alignment / zero - forcing is employed to maximize the multiplexing gain of the x channel , which is a combination of two - user mac and two - user bc .",
    "however , the iterative schemes in @xcite are specialized for the two user x channel and generalizations to general networks are not straightforward .",
    "the new water - filling in this paper automatically results in near optimal zero forcing transmission at high snr and may be modified to conduct zero forcing directly for general interference networks .      in this paper",
    ", we extend the mac - bc rate duality to the forward and reverse links of the b - mac networks .",
    "the duality has a deep connection to the new water - filling structure and can be used to design low complexity iterative algorithms .",
    "the extension is a simple consequence of the signal - to - interference - plus - noise power ratio ( sinr ) duality .",
    "the sinr duality states that if a set of sinrs is achievable in the forward links , then the same sinrs    can be achieved in the reverse links when the set of transmit and receive beamforming vectors are fixed and the roles of transmit and receive beams are exchanged in the reverse links .",
    "thus , optimizing the transmit vectors of the forward links is equivalent to optimizing the receive vectors in the reverse links , which can reduce complexity because receive vector optimization is simpler .",
    "the sinr duality between single - input multiple - output ( simo ) mac and multiple - input single - output ( miso ) bc was first found in @xcite and further developed in @xcite .",
    "alternating optimization based on it has been employed in @xcite . significant insight and progress",
    "was achieved in @xcite , where the sinr duality is extended to any one - hop mimo networks with linear beamformers by the lagrange duality of linear programming .",
    "the mac - bc rate duality has been established in @xcite .",
    "the forward link bc and reverse link mac have the same capacity region and the dual input covariance matrices can be calculated by different transformations . in @xcite ,",
    "the dual input covariance transformation is derived based on the flipped channel and achieves the same rates as the forward links with equal or less power .",
    "the transformation can not be calculated sequentially in general b - mac networks , unless there is no loops in the interference graphs as discussed later .",
    "the mac - bc duality can also be derived from the sinr duality as shown in @xcite , where a different dual covariance transformation is calculated from the mmse receive beams and power allocation that makes the sinrs of the forward and reverse links equal .",
    "such a transformation achieves equal or higher rates than the forward links under the same sum power .",
    "because the transformation does not need to be calculated sequentially , it can be easily generalized to b - mac networks as followed in this paper .",
    "furthermore , the precoding matrices in the sinr duality based transformation can be designed such that there is no interference among the streams of a link @xcite .",
    "this orthogonal stream technique is directly applicable to b - mac networks .",
    "the above mac - bc duality assumes sum power constraint .",
    "it can be generalized to a linear constraint using minimax duality and sinr duality @xcite .",
    "efficient interior point methods have been applied to solve optimizations with multiple linear constraints in @xcite , where the advantage is that the optimal primary variables and lagrange multipliers are searched jointly .",
    "it is expected that exploiting optimal input structure will produce better algorithms that also work for more general networks , as discussed later .",
    "the following is an overview of the contributions of this paper .    *",
    "_ duality : _ as a simple consequence of the sinr duality , we show that the forward and reverse links of b - mac networks have the same achievable rate region in section [ sub : main - results ] .",
    "the dual input covariance matrices are obtained from a transformation based on the mmse filtering and the sinr duality .",
    "different from the input covariance transformation in @xcite , which achieves the same rate as the forward links but with equal or less power and can not be calculated sequentially for general b - mac networks , the transformation in this paper achieves equal or larger rates with the same power and can be calculated easily for general b - mac networks .",
    "we show that the two transformation coincide at the pareto rate points .",
    "* _ polite water - filling : _ the long sought - after network version of water - filling for _ all _ the pareto optimal input of the achievable rate region of the b - mac networks is found in section [ sub : polite water - filling ] .",
    "different from the traditional selfish water - filling , the polite water - filling _ optimally _ balances between reducing interference to others and maximizing a link s own rate in a beautifully symmetric form , while the traditional selfish water - filling only considers interference from others .",
    "conceptually , it tells us that the optimal method to control the interference to others is through optimal pre - whitening of the channel of a link .",
    "it offers an elegant method to decompose a network into multiple equivalent single - user channels and thus , paves the way for designing / improving low - complexity centralized or distributed / game - theoretic algorithms for almost all network optimization problems , e.g. , those in @xcite .",
    "in fact , when imposing the optimal structure at every iteration of an algorithm , intuition and empirical results show that it is hard not to obtain a good solution even in non - convex cases .",
    "consequently , general purpose convex or non - convex programing is no longer necessary .",
    "it also provides hints on the optimization of han - kobayashi transmission scheme @xcite .",
    "the polite water - filling has the following structure .",
    "consider link @xmath1 with channel matrix @xmath2 and pareto optimal input covariance matrix @xmath3 .",
    "the equivalent input covariance matrix @xmath4 is found to be the water - filling of the pre- and post - whitened equivalent channel @xmath5 , where @xmath6 is the interference - plus - noise covariance of the forward link , used to avoid interference from others .",
    "the physical meaning of @xmath7 , used to control interference to others , is two folded . in terms of the reverse link , it is the interference - plus - noise covariance of the reverse link , resulted from the optimal dual input . in terms of the forward link , it is the lagrangian penalty for causing interference to other links .",
    "the deep connection to duality is that the optimal lagrange multipliers work out beautifully to be the optimal dual reverse link powers .",
    "a surprising property is that the forward and reverse link equivalent input powers satisfy @xmath8 for _ all _ _ individual _ links under _ _ total or other",
    "_ _ power constraints .",
    "this property will be useful for designing distributed algorithms .",
    "for the sum - rate optimal input , the polite water - filling does not reduce to the water - filling in @xcite because the polite water - filling is related to each individual link . * _ extension to a linear constraint : _ we show that all results in the paper , including duality , polite water - filling structure , and algorithms , can be generalized from the case of a sum power constraint and white noise to the case of a linear constraint on all links input covariance matrices and colored noise in section [ sub : extension - linear - constraints ] .",
    "the dual of the linear constraint in the forward link is the colored noise in the reverse link , the same as in multiaccess and broadcast channels @xcite .",
    "the linear constraint result can be used as basis to handle multiple linear constraints , which arise in individual power constraints , per - antenna power constraints , and interference reduction to primary users in cognitive radios @xcite , and therefore , is useful for many practical applications .",
    "more details on the extension of the algorithms will be discussed in section [ sec : conclusion ] on future work . * _ weighted sum - rate maximization : _ the polite water - filling can be applied to most existing optimization problems of b - mac networks . in section [ sec : near optimal scheme ] , the weighted sum - rate maximization is used as an example to illustrate its superiority .",
    "the lowest complexity per iteration of the designed algorithms is linear with respect to the total number of data links .",
    "+ they have superior accuracy and convergence speed , which , unlike generic convex programming , does not depend on the total number of data links .",
    "this is a result of enforcing optimal input structure by polite water - filling , where the interference is summarized by @xmath6 and @xmath7 no matter how many interfering links are there . *",
    "_ itree networks : _ the optimization for b - mac networks is not convex in general . to analyze the algorithms and to provide a monotonically converging algorithm",
    ", we introduce a narrower class of networks , named interference tree ( itree ) networks in section [ sub : itree ] , which seems worth studying in its own right . after interference cancellation",
    ", the remaining interference among links can be represented by a directional graph .",
    "if there is no directional loop in the graph , the network is called an itree network , where one can find an indexing such that any link is not interfered by the links with smaller indices .",
    "it appears to be a logical extension of mac and bc .",
    "an approach to making progress in network information theory is to study special cases such as deterministic channels @xcite and degree of freedom @xcite .",
    "itree networks looks promising in this sense .",
    "the rest of the paper is organized as follows .",
    "section [ sec : system model ] defines the achievable rate region and summarizes the preliminaries .",
    "section [ sec : main - results ] presents the theoretical results on the duality and polite water - filling . as an example , polite water - filling",
    "is applied to weighted sum - rate maximization in section [ sec : near optimal scheme ] , where itree networks is introduced for optimality analysis .",
    "the performance of the algorithms is verified by simulation in section [ sec : simulation - results ] .",
    "the results of this paper provides a stepping stone for solving more general problems , such as the optimization of han - kobayashi transmission scheme and cognitive radios , distributed optimization , and analysis of itree networks .",
    "they are discussed in section [ sec : conclusion ] along with the conclusions .",
    "we first define the achievable rate region studied in the paper .",
    "it is followed by a summary of the sinr duality in @xcite , which will be useful for the derivation in the next section .",
    "we use @xmath9 for @xmath10 norm and @xmath11 for @xmath12 norm .",
    "the complex gradient of a real function will be used extensively in the paper and is defined as follows . define @xmath13 .",
    "the extension of the results in @xcite gives the gradient of @xmath14 over @xmath15 as @xmath16 where @xmath17 is defined as@xmath18,\\ ] ] and @xmath19 , @xmath20 .",
    "if @xmath15 is hermitian , it can be proved that the above formula can be used without change by treating the entries in @xmath15 as independent variables .",
    "we consider the most general one - hop mimo interference network with multiple transmitters and receivers , which is a combination of interfering broadcast and multiaccess channels .",
    "we call it a b - mac network where each physical transmitter may have data for multiple receivers and each physical receivers may want data from multiple transmitters .",
    "there are @xmath21 transmission links .",
    "let @xmath22 and @xmath23 denote the virtual transmitter and receiver of link @xmath1 equipped with @xmath24 and @xmath25 antennas respectively .",
    "the received signal at @xmath23 can be expressed as    @xmath26    where @xmath27 is the transmit signal of link @xmath28 and is assumed to be circularly symmetric complex gaussian ; @xmath29 is the channel state matrix between @xmath30 and @xmath23 ; and @xmath31 is a circularly symmetric complex gaussian noise vector with zero mean and identity covariance matrix .    to handle a wide range of interference cancellation , we define a coupling matrix @xmath32 as a function of the interference cancellation scheme .",
    "it specifies whether interference is completely cancelled or treated as noise : if @xmath33 , after interference cancellation , still causes interference to @xmath34 , @xmath35 and otherwise , @xmath36 .",
    "for example , when no interference cancellation technique is used , @xmath37 is a matrix of 1 s with zero diagonal entries .",
    "if the transmitters ( receivers ) of several links are associated with the same physical transmitter ( receiver ) , interference cancellation techniques such as dirty paper coding ( successive decoding and cancellation ) can be applied at this physical transmitter ( receiver ) to improve the performance .",
    "the coupling matrices valid for the results of this paper are those for which there exists a transmission and receiving scheme such that each signal is decoded and possibly cancelled by no more than one receiver , because in the achievable rate region defined later , a rate is determined by one equivalent channel . in the han - kobayashi scheme",
    ", a common message is decoded by more than one receiver .",
    "future extension to the han - kobayashi scheme is discussed in remark [ rem : ext - han - kobayashi ] .",
    "we give some examples of valid coupling matrices .",
    "for a bc ( mac ) employing dpc ( sic ) where the @xmath38 link is the @xmath38 one to be encoded ( decoded ) , the coupling matrix is given by @xmath39 and @xmath40 . in    fig .",
    "[ fig : sysfig1 ] , we give an example of a b - mac network employing dpc and sic .",
    "both @xmath41 and @xmath42 ( @xmath43 and @xmath44 ) are associated with the same physical transmitter ( receiver ) .",
    "the following @xmath45 are valid coupling matrices for link @xmath46 under the corresponding encoding and decoding orders : _ a_.",
    "@xmath47 is encoded after @xmath48 and @xmath48 is decoded after @xmath49 ; _",
    "b_. @xmath48 is encoded after @xmath47 and @xmath48 is decoded after @xmath49 ; _",
    "c_. @xmath47 is encoded after @xmath48 and @xmath49 is decoded after @xmath48 ; _ d_. there is no interference cancellation.@xmath50 , & \\:\\mathbf{\\phi}^{b}=\\left[\\begin{array}{ccc } 0 & 1 & 1\\\\ 0 & 0 & 0\\\\ 1 & 1 & 0\\end{array}\\right],\\\\ \\mathbf{\\phi}^{c}=\\left[\\begin{array}{ccc } 0 & 0 & 1\\\\ 1 & 0 & 1\\\\ 1 & 0 & 0\\end{array}\\right ] , & \\:\\mathbf{\\phi}^{d}=\\left[\\begin{array}{ccc } 0 & 1 & 1\\\\ 1 & 0 & 1\\\\ 1 & 1 & 0\\end{array}\\right].\\end{aligned}\\ ] ]    [ rem : patialsic]when dpc and sic are combined , it is possible that an interference may not be fully cancelled under a specific encoding and decoding order .",
    "for example , in fig .",
    "[ fig : sysfig1 ] , if @xmath48 is encoded after @xmath47 and @xmath49 is decoded after @xmath48 , the interference from @xmath48 and @xmath47 to @xmath49 may not be fully cancelled @xcite    .",
    "such case can not be described by the coupling matrix of 0 s and 1 s defined above .",
    "however , one may employ the results in this paper to obtain the inner and outer bounds of rates using pessimistic or optimistic coupling matrices .",
    "another possible solution is to decompose the network into sub - networks , such as the methods proposed in @xcite where the two - user x channel is decomposed into two bcs or two macs using zero - forcing and alternating optimization .",
    "then each sub - network has a valid coupling matrix and the results in this paper can be applied .",
    "it will be an interesting future research to design more sophisticated coding techniques to fully cancel the interference from @xmath48 and @xmath47 to @xmath49 .",
    "the assumption of either full or no cancellation of each interference can be relaxed .",
    "all results in the paper still hold when the interference from link @xmath28 to link @xmath1 is partially cancelled , as long as the covariance matrix of the remaining interference has the form of @xmath51 , where @xmath52 can be any constant matrix .",
    "this is because @xmath53 can be treated as the equivalent channel from link @xmath28 to link @xmath1 .    for the above b - mac network ,",
    "we define an achievable rate region .",
    "unless explicitly specified , all achievable regions in this paper refer to the following one .",
    "note that @xmath54 by definition .",
    "the interference - plus - noise of the @xmath55 link is @xmath56 , whose covariance matrix is @xmath57 where @xmath58 is the covariance matrix of @xmath33 .",
    "we denote all the covariance matrices as @xmath59 then the mutual information ( rate ) of link @xmath1 is given by a function of @xmath60 and @xmath37    @xmath61    the _ achievable rate region _ with _ _ a fixed coupling matrix @xmath37 _ _ and sum power constraint @xmath62 is defined as    @xmath63    assuming the sum power constraint is the necessary first step for more complicated cases .",
    "it has its own theoretical value and the result can be easily used for individual power constraints and the more general multiple linear constraints as discussed in section [ sub : extension - linear - constraints ] and [ sec : conclusion ] .",
    "if @xmath64_{l=1:l}$ ] is a pareto rate point of @xmath65 , the input covariance matrices @xmath60 are said to be _",
    "pareto optimal_.    a bigger achievable rate region can be defined by the convex closure of @xmath66 , where @xmath67 is a set of valid coupling matrices .",
    "for example , if dpc and/or sic are employed , @xmath67 can be a set of valid coupling matrices corresponding to various encoding and/or decoding orders . in this paper",
    ", we focus on a fixed _ _ coupling matrix @xmath37 _ _ and fixed channel matrices . the optimal _ _ coupling matrix _ _ @xmath37 , or equivalently , the optimal encoding and/or decoding order of the weighted sum - rate maximization problem is partially characterized in section [ sub : wsrmp ] .",
    "it is straightforward to extend the results in this paper to random channel cases like fading channels .",
    "the reason to consider sum power constraints is given in section [ sub : extension - linear - constraints ] .",
    "the above definition ensures the following .",
    "[ thm : stongpareto]the boundary points of the region @xmath65 are pareto optimal .",
    "that is for each boundary point @xmath68 , there does not exist another @xmath69 satisfying @xmath70 and @xmath71 , i.e. , all boundary rate points are strong pareto optimums .    the proof is given in appendix [ sub : proof - strongpareto ] .    in section [ sec : main - results ] , we will characterize the pareto optimal input covariance matrices based on a rate duality between the achievable rate regions of the forward and reverse links .",
    "the reverse links are obtained by reversing the directions of the forward links and replacing the channel matrices by their conjugate transposes . .",
    "we use the notation @xmath72 to denote the corresponding terms in the reverse links .",
    "for example , in the reverse links of the b - mac network in fig .",
    "[ fig : sysfig1 ] , @xmath73 ( @xmath74 ) becomes the receiver ( transmitter ) , and @xmath75 is decoded after @xmath76 and @xmath77 is encoded after @xmath78 , if in the forward links , @xmath47 is encoded after @xmath48 and @xmath48 is decoded after @xmath49 .",
    "the interference - plus - noise covariance matrix of reverse link @xmath1 is @xmath79 and the rate of reverse link @xmath1 is given by    @xmath80    for a fixed @xmath81 , the achievable rate region for the reverse links is defined as :    @xmath82      the above achievable rate region can be achieved by a spatial multiplexing scheme with successive interference cancellation ( sic ) using minimum mean square error ( mmse ) filtering and decoding .    [",
    "def : decomposition]the _ decomposition of a mimo link to multiple siso data streams _ is defined as , for link @xmath1 and @xmath83 , finding a precoding matrix @xmath84 $ ] satisfying @xmath85 where @xmath86 is a transmit vector with @xmath87 ; and @xmath88 are the transmit powers .",
    "we also define @xmath89^{t}$ ] to be the transmit power vector of all links .",
    "note that the precoding matrix is not unique because @xmath90 with unitary @xmath91 also gives the same covariance matrix in ( [ eq : decomsig ] ) . without loss of generality",
    ", we assume the intra - signal decoding order is that    the @xmath92 stream is the @xmath92 to be decoded and cancelled .",
    "the receive vector @xmath93 for the @xmath94 stream of link @xmath1 is obtained by the mmse filtering as @xmath95 where @xmath96 is chosen such that @xmath97 .",
    "this is referred to as mmse - sic ( mmse successive interference cancellation ) receiver in this paper .    for each stream",
    ", one can calculate its sinr and rate .    for convenience ,",
    "define the collections of transmit and receive vectors as @xmath98_{m=1, ...",
    ",m_{l},l=1, ... ,l},\\label{eq : udef}\\\\ \\mathbf{r } & = & \\left[\\mathbf{r}_{l , m}\\right]_{m=1, ... ,m_{l},l=1, ... ,l}.\\label{eq : trkdef}\\end{aligned}\\ ] ] @xmath99 then the sinr and the rate for the @xmath94 stream of link @xmath1 can be expressed as a function of @xmath100 , @xmath101 and @xmath102,@xmath103    such decomposition of data to streams with mmse - sic receiver is information lossless due to the following fact .",
    "[ fac : mmse - sc]the mutual information in ( [ eq : linkkmig ] ) is achieved by the mmse - sic receiver @xcite , i.e. , it is equal to the sum - rate of all streams of link @xmath1 :    @xmath104    in the reverse links , we can obtain sinrs using @xmath101 as transmit vectors and @xmath100 as receive vectors .",
    "the transmit powers is denoted as @xmath105^{t}$ ] .",
    "the decoding order of the streams within a link is the opposite to that of the forward link , i.e. , the @xmath92 stream is the @xmath92 last to be decoded and cancelled .",
    "then the sinr for the @xmath94 stream of reverse link @xmath1 can be expressed as@xmath106 for simplicity , we will use @xmath107 ( @xmath108 ) to denote the transmission and reception strategy described above in the forward ( reverse ) links .",
    "the achievable sinr regions of the forward and reverse links are the same .",
    "define the achievable sinr regions @xmath109 and @xmath110 as the set of all sinrs that can be achieved under the sum power constraint @xmath62 in the forward and reverse links respectively .",
    "for given set of sinr values @xmath111_{m=1, ...",
    ",m_{l},l=1, ... ,l}$ ] , define a diagonal matrix @xmath112 being a function of @xmath113 and @xmath114 , where the @xmath115 diagonal element is given by    @xmath116    the sinr duality in @xcite is restated in the following lemma .",
    "[ lem : lem1g]if a set of sinrs @xmath114 is achieved by the transmission and reception strategy @xmath107 with @xmath117 in the forward links , then @xmath114 is also achievable in the reverse links with @xmath108 , where the transmit power vector @xmath118 satisfies @xmath119 and is given by@xmath120 and thus , one has @xmath121 .",
    "in this section , we first establish a rate duality , which is a simple consequence of the sinr duality in @xcite . then based on the rate duality ,",
    "the polite water - filling structure and properties of the pareto optimal input are characterized .",
    "finally , we discuss the extension from a sum power constraint to a linear constraint and the extension from white noise to colored noise .      the rate duality is a simple consequence of the sinr duality .",
    "[ thm : mainthem]the achievable rate regions of the forward and reverse links of a b - mac network defined in ( [ eq : ratereg1 g ] ) and ( [ eq : ratereg2 g ] ) respectively are the same , i.e. , @xmath122 .    for any rate point @xmath68 in the region",
    "@xmath65 achieved by the input covariance matrices @xmath60 , the covariance matrix transformation defined below can be used to obtain @xmath123 for the reverse links such that a reverse link rate point @xmath124 under the same sum power constraint @xmath62 can be achieved , according to lemma [ lem : mainlem ] .",
    "the same is true for the reverse links .",
    "therefore , we have @xmath122 .",
    "[ def : covt]let @xmath125 be a decomposition of @xmath60 . compute the mmse - sic receive vectors @xmath101 from ( [ eq : mmserev1 g ] ) and the transmit powers @xmath118 in the reverse links from ( [ eq : qpower ] ) . the _ covariance transformation _ from @xmath60 to @xmath123 is defined as    @xmath126    and @xmath123 is called the dual input covariance matrices of @xmath60 .",
    "[ lem : mainlem ]    for any input covariance matrices @xmath60 satisfying the sum power constraint @xmath62 and achieving a rate point @xmath127 , the corresponding dual input covariance matrices @xmath123 achieves a rate point @xmath124 in the reverse links under the same sum power constraint .",
    "according to fact [ fac : mmse - sc ] , @xmath68 is achieved by the transmission and reception strategy @xmath107 with @xmath128 .",
    "it follows from lemma    [ lem : lem1 g ] that @xmath108 with @xmath129 can also achieve the same rate point @xmath68 in the reverse links .",
    "note that @xmath100 may not be the mmse - sic receive vectors , which is optimal for the reverse links .",
    "therefore , the reverse link rates may be improved with a better receiver to obtain @xmath124 .",
    "the following corollary follows immediately from lemma [ lem : mainlem ] and theorem [ thm : mainthem ] .",
    "[ cor : simplematrix]for any input covariance matrices @xmath60 achieving a pareto rate point , the corresponding dual input covariance matrices @xmath123 achieves the same pareto rate point in the reverse links .",
    "the following makes connection of the covariance transformation ( [ eq : covtrans ] ) to the existing ones .",
    "first , it is essentially the same as the mac - bc transformations in @xcite and @xcite which are also based on sinr duality .",
    "the only difference is that we do not restrict the choice of the precoding matrix @xmath130 in ( [ eq : decomsig ] ) . in @xcite ,",
    "the precoding matrix @xmath130 is chosen as the eigenvectors of @xmath3 . and",
    "in @xcite , the precoding matrix @xmath130 is chosen to decorrelate each link @xmath1 such that the streams of link @xmath1 are orthogonal to each other .",
    "second , we show that the mac - bc transformation in @xcite is equivalent to the covariance transformation in ( [ eq : covtrans ] ) at the pareto rate point .    [",
    "thm : contmacbc]for any input covariance matrices @xmath60 achieving a pareto rate point , the dual input covariance matrices @xmath123 produced by the covariance transformation ( [ eq : covtrans ] ) are the same as that produced by the mac - bc transformation in @xcite , i.e. , @xmath131 where @xmath132 are obtained by the thin singular value decomposition ( svd ) : @xmath133 ; and @xmath134 is the rank of @xmath2 .",
    "the proof relies on theorem [ thm : wfst ] in section [ sub : polite water - filling ] , which states that at the pareto rate point , both @xmath60 and its dual input covariance matrices @xmath123 satisfy the polite water - filling structure as in ( [ eq : wffar ] ) and ( [ eq : wfrev ] ) respectively .",
    "then we have @xmath135 where the first and last equations follow from ( [ eq : wffar ] ) and ( [ eq : wfrev ] ) respectively",
    ".    however , at the inner point of the rate region , the above two transformations are different . the transformation in ( [ eq : covtrans ] )",
    "keeps the sum transmit power unchanged while not decreasing the achievable rate , while the mac - bc transformation in @xcite keeps the achievable rate the same while not increasing the sum transmit power .",
    "furthermore , the extension of mac - bc transformation in @xcite to b - mac networks can only be sequentially calculated for itree networks defined in section [ sub : itree ] , a sub - class of b - mac networks whose interference graph has no loops .      in the following ,",
    "we show that the pareto optimal input covariance matrices have a _",
    "polite water - filling structure_. it generalizes the well known water - filling solution to networks . for single - user channel , the polite water - filling structure reduces to the conventional water - filling solution .",
    "first , we formally define the term _ polite water - filling structure_.    [ def : defgwf]given input covariance matrices @xmath60 , obtain the dual input covariance matrices @xmath123 by the covariance transformation in ( [ eq : covtrans ] ) .",
    "let @xmath6 s and @xmath7 s respectively be the corresponding interference - plus - noise covariance matrices in the forward and reverse links . for each link @xmath1 , pre- and post- whiten the channel @xmath2 to produce an equivalent single - user channel @xmath5 .",
    "define @xmath4 as the equivalent input covariance matrix of the link @xmath1 .",
    "the input covariance matrix @xmath3 is said to possess a _ polite water - filling structure _ if @xmath136 satisfies the structure of water - filling over @xmath137 , i.e. , @xmath138 where @xmath139 is the water - filling level ; the equivalent channel of link @xmath1 is decomposed using the thin svd as @xmath140 , where @xmath141 ; and @xmath134 is the rank of @xmath2 . if all @xmath3 s possess the polite water - filling structure , then @xmath60 is said to possess the _",
    "polite water - filling structure_.    for b - mac , the polite water - filling structure of the pareto optimal input can be proved by observing that the optimal input covariance matrix for each link is the solution of some single - user optimization problem .",
    "we use the notation @xmath142 for the optimal variables corresponding to a pareto rate point . without loss of generality , assume that @xmath143 , where @xmath144 , achieves a pareto rate point @xmath145_{l=1, ... ,l}$ ] and @xmath146 are the corresponding dual input covariance matrices . for the pareto rate point where the rates of some links are zero",
    ", the proof also holds by simply deleting these links and applying the proof for the resulting smaller network . the corresponding interference - plus - noise covariance matrices",
    "are denoted as @xmath147 and @xmath148 respectively",
    ". then it can be proved by contradiction that the pareto optimal input covariance matrix @xmath149 is the solution of the following single - user optimization problem for link @xmath1 , where the transmission and reception schemes of other links are fixed as the pareto optimal scheme , @xmath150 .",
    "@xmath151 where @xmath152 ; and @xmath153 is the interference from link @xmath1 to the @xmath94 stream of link @xmath28 and is constrained not to exceed the optimal value @xmath154 .",
    "the constraints force the rates to be the pareto point while the power of link @xmath1 is minimized .",
    "the lagrangian of problem ( [ eq : minpowl ] ) is@xmath155 where the dual variables @xmath156 and @xmath157_{m=1, ...",
    ",m_{k},k\\ne l}\\in\\mathbb{r}_{+}^{\\sum_{k\\neq l}m_{k}\\times1}$ ] are associated with the rate constraint and the interference constraints in ( [ eq : incinmip ] ) respectively ; @xmath158 is a function of @xmath159 ; @xmath160 is the matrix dual variables associated with the positive semidefiniteness constraint on @xmath3 .",
    "note that problem ( [ eq : minpowl ] ) is convex , and thus , the duality gap is zero @xcite and @xmath149 minimizes the lagrangian ( [ eq : lag_minp ] ) with optimal dual variables @xmath161 and @xmath162_{m=1, ... ,m_{k},k\\ne l}$ ] , i.e. , it is the solution of @xmath163    note that in the objective function of problem ( [ eq : prtp1 ] ) , the constant terms in the lagrangian ( [ eq : lag_minp ] ) have been deleted for simplicity of notations , and the term associated with the positive semidefiniteness constraint @xmath164 is explicitly handled by adding the constraint @xmath165 .",
    "the following theorem states that the physical meaning of the optimal dual variables @xmath166_{k\\ne l}$ ] is exactly the optimal power allocation in the reverse links .",
    "[ thm : optdual]the optimal dual variables of problem ( [ eq : minpowl ] ) are given by @xmath167 where @xmath168 is the sinr of the @xmath94 stream of forward link @xmath1 achieved by @xmath169 .",
    "therefore , @xmath170_{k\\ne l}\\right ) & = & \\tilde{\\hat{\\mathbf{\\omega}}}_{l}.\\end{aligned}\\ ] ]    the proof is given in appendix [ sub : proofwfst ] .",
    "the polite water - filling structure is shown by a single - user - channel view using the above results .",
    "let @xmath171 and @xmath172 respectively be the equivalent channel and the equivalent input covariance matrix for link @xmath1 . since @xmath148 is non - singular , problem ( [ eq : prtp1 ] ) is equivalent to a single - user optimization problem@xmath173 of which @xmath174 is an optimal solution .",
    "since the optimal solution to problem ( [ eq : prtop2 ] ) is unique and is given by the water - filling over @xmath137 with @xmath161 as the water - filling level @xcite , the following theorem is proved .",
    "[ thm : wfst]for each @xmath1 , perform the thin svd as @xmath140 , where @xmath141 , and @xmath134 is the rank of @xmath2 . at a pareto rate point",
    ", the input covariance matrix @xmath149 must have a _ polite water - filling structure _ , i.e. , the equivalent input covariance matrix @xmath175 satisfies @xmath176 similarly , the corresponding @xmath177 produces @xmath178 , which satisfies@xmath179    the insight given by the proof of theorem [ thm : wfst ] is that restricting interference to other links can be achieved by pre - whitening the channel with reverse link interference - plus - noise covariance matrix . and",
    "thus , the mutual interfering b - mac can be converted to virtually independent equivalent channels @xmath180 .",
    "the restriction of interference to others is achieved in two steps .",
    "first , in @xmath171 , the multiplication of @xmath181 reduces the channel gain in the interfering directions so that in @xmath182 , less power will be filled in these directions .",
    "second , in @xmath183 , the power to the interfering directions is further reduced by the multiplication of @xmath181 .",
    "[ rem : ext - han - kobayashi]the lagrangian interpretation of @xmath148 makes it possible to extend the duality and polite water - filling to han - kobayashi transmission scheme . cancelling the interference requires the interference power to be greater than a threshold rather than less than it .",
    "therefore , some lagrange multipliers are negative in @xmath184 . if we still interpret the lagrange multiplier as reverse link power , we must introduce the concept of negative power . with the new concept of negative power and the modified coupling matrix",
    ", one may establish the duality and polite water - filling for han - kobayashi scheme .",
    "the matrix @xmath148 likely remains positive definite .",
    "otherwise , the solution to problem ( [ eq : prtp1 ] ) has infinite power , which suggests there is no feasible power allocation to satisfy all the constraints .",
    "theorem [ thm : wfst ] says that at the pareto rate point , it is necessary that @xmath60 and @xmath123 have the polite water - filling structure .",
    "the following theorem states that @xmath3 having the polite water - filling structure suffices for @xmath185 to have the polite water - filling structure even at a non - pareto rate point .",
    "this enables the optimization of the network part by part .",
    "a lemma is needed for the proof and reveals more insight to the duality . although the covariance transformation preserves total power such that @xmath186 , in general , @xmath187 is not true .",
    "surprisingly , @xmath188 is true .",
    "[ lem : trq ] let @xmath123 be the covariance matrices obtained from @xmath60 by the transformation in definition [ def : covt ] . define the equivalent covariance matrices @xmath4 and @xmath189 .",
    "the power of the forward and reverse link equivalent covariance matrices of each link is equal , i.e. , @xmath188 .    the proof is given in appendix [ sub : proof - of - trq ] .",
    "[ thm : fequrgwf]if one input covariance matrix @xmath3 has the polite water - filling structure while other @xmath190 are fixed , so does its dual @xmath185 , i.e. , @xmath189 is given by water - filling over the reverse equivalent channel @xmath191 as in ( [ eq : wfrev ] ) .",
    "because water - filling uniquely achieves the single - user mimo channel capacity @xcite , @xmath136 achieves the capacity of @xmath137 .",
    "since the capacities of @xmath137 and @xmath192 are the same under the same power constraint @xcite , @xmath193 achieves the capacity of @xmath192 with the same power by lemma [ lem : trq ] and lemma [ lem : mainlem ] .",
    "therefore , @xmath193 is a water - filling over @xmath192 .",
    "decompose a mimo problem to siso problems using beams can often reduce the complexity .",
    "but for different decompositions of the input covariance matrices @xmath60 , @xmath194 and @xmath195 are different in general , and thus the covariance transformation may also be different .",
    "however , as shown by the theorem below , the covariance transformation of ( [ eq : covtrans ] ) is unique and has an explicit matrix expression if the input covariance matrices have the polite water - filling structure .",
    "[ thm : at - the - boundary]for any input covariance matrices @xmath60 satisfying the polite water - filling structure , the covariance transformation ( [ eq : covtrans ] ) is unique , i.e. , for all decompositions of @xmath60 , it will be transformed to the same dual input @xmath123 , and vice versa .",
    "furthermore , the dual input covariance matrices @xmath196 satisfies the following matrix equation    @xmath197 and can be explicitly expressed as @xmath198 where @xmath199 is the water - filling level in the polite water - filling structure of @xmath3 in ( [ eq : defwffar ] ) .    the proof is given in appendix [ sub : proof - of - conj ] .",
    "the matrix equation in ( [ eq : mtformtf ] ) is natural . at the pareto rate point",
    ", the covariance transformation will give the same set of rates for the forward and reverse links .",
    "hence we have@xmath200 theorem [ thm : at - the - boundary ] shows that not only the determinant but also the corresponding matrices are equal , i.e. , @xmath201 .",
    "so far we have assumed sum power constraint @xmath202 and white noise for simplicity .",
    "but individual power constraints is more common in a network , which can be easily handled by the following observation .",
    "all results in this paper can be directly applied in a much larger class of problems with a linear constraint @xmath203 and/or colored noise with covariance @xmath204=\\mathbf{w}_{l}$ ] , where @xmath205 and @xmath206 are assumed to be non - singular and hermitian    .",
    "the single linear constraint appears in lagrangian functions for multiple linear constraints , which arise in cases of individual power constraints , per - antenna power constraints , interference reduction in cognitive radios , etc . @xcite .",
    "combined with a simple lagrange multiplier update , the algorithms in this paper can be generalized to solve the cases of multiple linear constraints .    for a single linear constraint and colored noise ,",
    "we denote @xmath207,\\sum_{l=1}^{l}\\textrm{tr}\\left(\\mathbf{\\sigma}_{l}\\hat{\\mathbf{w}}_{l}\\right)\\leq p_{t},\\left[\\mathbf{w}_{l}\\right]\\right),\\label{eq : net - color - linear - constraint}\\ ] ] as a network where the channel matrices is given by @xmath208 $ ] ; the input covariance matrices must satisfy the linear constraint @xmath203 ; and the covariance matrix of the noise at the receiver of link @xmath1 is given by @xmath206 .",
    "if some links have the same physical receiver and thus the same noise , the noise covariance matrices of these links are implicitly assumed to be the same .",
    "similarly , if some links have the same physical transmitter , the linear constraint matrices @xmath205 s associated with these links are also assumed to be the same .",
    "the extension is facilitated by the following lemma which can be proved by variable substitutions .",
    "[ lem : whiten - net]the achievable rate region of the network ( [ eq : net - color - linear - constraint ] ) is the same as the achievable rate region of the network with sum power constraint and white noise @xmath209,\\sum_{l=1}^{l}\\textrm{tr}\\left(\\mathbf{\\sigma}_{l}^{'}\\right)\\leq p_{t},\\left[\\mathbf{i}\\right]\\right).\\label{eq : net - whitened}\\ ] ] if @xmath210 achieves certain rates and satisfies the sum power constraint in network ( [ eq : net - whitened ] ) , @xmath60 obtained by @xmath211 achieves the same rates and satisfies the linear constraint in network ( [ eq : net - color - linear - constraint ] ) and vice versa .",
    "the above implies that the dual of colored noise in the forward link is a linear constraint in the reverse link and the dual of the linear constraint in the forward link is colored noise in the reverse link as stated in the following theorem .",
    "[ thm : linear - color - dual]the dual of the network ( [ eq : net - color - linear - constraint ] ) is the network@xmath212,\\sum_{l=1}^{l}\\textrm{tr}\\left(\\hat{\\mathbf{\\sigma}}_{l}\\mathbf{w}_{l}\\right)\\leq p_{t},\\left[\\hat{\\mathbf{w}}_{l}\\right]\\right),\\label{eq : net - forward - color - dual}\\ ] ] in the sense that 1 ) both of them have the same achievable rate region ; 2 ) if @xmath60 achieves certain rates and satisfies the linear constraint in network ( [ eq : net - color - linear - constraint ] ) , its covariance transformation is replaced by @xmath206 and the all - one vector @xmath213 in ( [ eq : qpower ] ) is replaced by the vector @xmath214_{m=1, ...",
    ",m_{l},l=1, ... ,l}$ ] . ]",
    "@xmath123 achieves better rates , satisfies the dual linear constraint in network ( [ eq : net - forward - color - dual ] ) , and @xmath215 .",
    "apply lemma [ lem : whiten - net ] to networks ( [ eq : net - color - linear - constraint ] ) and ( [ eq : net - forward - color - dual ] ) to produce a network and its dual with sum power constraint and white noise .",
    "then the result follows from lemma [ lem : mainlem ] .    for the special case of a bc with a single linear constraint , the duality result here reduces to that in @xcite .",
    "in this section , we use the weighted sum - rate maximization of b - mac networks as an example to illustrate the benefit of polite water - filling .",
    "we first present the simpler case of a sub - class of b - mac networks , _ _ the interference _ _ _ _ _ _ _ tree ( itree ) network___s , with a concave objective function .",
    "then the algorithm is modified to find sub - optimal but good solutions for the general b - mac networks .",
    "readers who are interested in algorithms implementation only may directly go to section [ sub : alg - b - mac ] and read table [ tab : table2 ] for algorithm pt and table [ tab : table3 ] for algorithm pp .",
    "algorithm p and p1 are more of theoretic value .",
    "we consider the following weighted sum - rate maximization problem ( * wsrmp * ) with a fixed coupling matrix @xmath37 , where @xmath216 is the weight for link @xmath1 .    for the special case of dpc and sic , we give a partial characterization of the optimal @xmath37 , or equivalently , the optimal encoding / decoding order .",
    "it is in general a difficult problem because the encoding and decoding orders at the bc transmitters and the mac receivers need to be solved jointly .",
    "however , for _",
    "bc_/_mac _ defined below in the b - mac network , the optimal encoding / decoding order maximizing @xmath217 is easily determined by the weights and",
    "is consistent with the optimal order of an individual bc or mac , as proved in theorem [ thm : optorder ] below .    in a b - mac network    , a physical transmitter with a set of associated links , whose indices forms a set @xmath218 , is said to be a _ bc _ if either all links in @xmath218 completely    interfere with a link @xmath28 or all links in @xmath218 do not interfere with a link @xmath28 , @xmath219 , i.e. , the columns with indices in @xmath218 of the coupling matrix @xmath37 , excluding rows in @xmath218 , are the same . a physical receiver with a set of associated links , whose indices forms a set @xmath220 ,",
    "is said to be a _ mac _ if either all links in @xmath220 are completely interfered by a link @xmath28 or all links in @xmath220 are not interfered by a link @xmath28 , @xmath221 , i.e. , the rows with indices in @xmath220 of the coupling matrix @xmath37 , excluding columns in @xmath220 , are the same .    for example , if    @xmath222 , link @xmath1 is the last one to be decoded at its receiver    , then the corresponding physical transmitter is a bc . if @xmath223 , link @xmath1 is the first one to be encoded at its transmitter , then the corresponding physical receiver is a mac .",
    "[ thm : optorder]in a b - mac network employing dirty paper coding and successive decoding and cancellation , if there exists a pseudo bc transmitter ( pseudo mac receiver ) , its optimal encoding ( decoding ) order @xmath224 of the following problem @xmath225 is that the signal of the link with the @xmath226 largest ( smallest ) weight is the @xmath226 one to be encoded ( decoded ) .",
    "it is proved by isolating the bcmac from the network to form an individual bc or mac .",
    "let @xmath218 be a set of links associated with bc . in the optimal solution of ( [ eq : max - pi ] ) , @xmath227 and @xmath224",
    "are also the optimal input and encoding order that maximizes the weighted sum - rate of a bc with fixed interference from links in @xmath228 and under multiple linear constraints that the interference to links in @xmath228 must not exceed the optimal values . the known result on bc with multiple linear constraints in @xcite implies that the optimal encoding order is as stated in the theorem . for a set of links belonging to mac , using similar method and generalizing the result in section [ sub : extension - linear - constraints ] to multiple linear constraints gives the desired decoding order .",
    "all the rest of the paper is for a fixed coupling matrix @xmath37 and the argument @xmath37 in @xmath229 is omitted . in the simulation , dpc and sic are employed and the encoding / decoding order is chosen to satisfy theorem [ thm : optorder ] .",
    "we consider centralized algorithms with global channel knowledge . distributed algorithms with partial knowledge can be developed based on them .",
    "more is discussed in section [ sec : conclusion ] .",
    "itree networks appears to be a natural extension of mac and bc .",
    "we define it below .    a b - mac network with a fixed coupling matrix is called an _ interference tree ( itree ) network _ if after interference cancellation , the links can be indexed such that any link is not interfered by the links with smaller indices .",
    "in an _ interference graph _ , each node represents a link . a directional edge from node @xmath230 to node",
    "@xmath231 means that link @xmath230 causes interference to link @xmath231 .",
    "the itree network is related to but different from the network with tree topology in terms of nonzero channel gain    .",
    "a network with tree topology implies itree network only if the interference cancellation order is chosen properly .",
    "for example , a mac which has tree topology is not an itree network if the successive decoding is not employed at the receiver .",
    "similarly , a bc is not an itree network if dirty paper coding is not employed . on the other hand ,",
    "even if there are loops in a network , it may be an itree network if the interference cancellation order is right .",
    "we give such an example in fig .",
    "[ fig : itree ] where there are three physical transmitters and three physical receivers with four transmission links 1 , 2 , 3 , and 4 , and dirty paper coding and successive decoding and cancellation are employed .",
    "let @xmath34 be the transmit signal of link @xmath1 . for encoding / decoding order a ,",
    "at the physical receiver corresponding to @xmath43 and @xmath44 , the signal @xmath48 is decoded after @xmath49 . at the physical transmitter corresponding to @xmath41 and @xmath42 , the signal @xmath47 is encoded after @xmath48 . with this encoding and decoding order , each link @xmath232 is not interfered by the first @xmath233 links .",
    "therefore , the network in fig .",
    "[ fig : itree ] is still an itree network even though it has a loop of nonzero channel gains .",
    "however , for encoding / decoding order b , sic is not employed at @xmath74 , and @xmath48 is encoded after @xmath47 at @xmath73 . the network in fig .",
    "[ fig : itree ] is no longer an itree network because the interference graph has directional loops , making the itree indexing impossible .",
    "itree networks can be equivalently defined using their interference graphs .",
    "a b - mac network with a fixed coupling matrix is an itree network if and only if after interference cancellation , its interference graph does not have any directional loop .",
    "if the interference graph has no loops , the following algorithm can find indices satisfying the definition of the itree network : 1 ) @xmath234 ; 2 ) index a node whose edges are all incoming by @xmath1 ; 3 ) delete the node and all the edges connected to it ; 4 ) let @xmath235 and repeat 2 ) until all nodes are indexed .",
    "on the other hand , the interference graph of an itree network only has edges from a node to the nodes with lower indices , making them impossible to form a directional loop .",
    "since the coupling matrix of the reverse links is the transpose of the coupling matrix of the forward links , the interference relation is reversed as stated in the following lemmas . without loss of generality , we consider itree networks where the @xmath236 link is not interfered by the first @xmath233 links in this paper , i.e. , the coupling matrix is given by @xmath39 and @xmath40 .",
    "[ lem : revinf]if in an itree network , the @xmath236 link is not interfered by the links with lower indices , in the reverse links , the @xmath236 link is not interfered by the links with higher indices .",
    "the following is obvious .",
    "the interference graph of the reverse links can be obtained from the interference graph of the forward links by reversing the directions of all the edges .    two examples of itree networks with concave",
    "weighted sum - rate functions are as follows .",
    "an obvious example is the mac with the decoding order equal to the ascending order of the weights @xmath237 .",
    "the second example is the _ _ two - user z channel _ _ , where the cross link channel gain satisfies @xmath238 , providing that some further conditions are satisfied as stated in the following theorem .",
    "[ thm : zconcave]the weighted sum - rate of a _ _ two - user z channel is concave _",
    "_ function of the input covariance matrices _ _ if the following are satisfied__.    1 .",
    "the channel matrices @xmath239 and @xmath240 are invertible and satisfy @xmath241 .",
    "2 .   the weights satisfy @xmath242 .",
    "the proof is given in appendix [ sub : proof - of - theoremzconcave ] . the important question of a complete characterization of the subset of itree networks with concave weighted sum - rate function , i.e. , finding the necessary and sufficient conditions on @xmath243 and @xmath37 for the subset , is out of the scope of this paper and is left for future work .",
    "the algorithm in this section illustrates the usage of polite water - filling and is a nontrivial generalization of the algorithm in @xcite .",
    "first we show that * wsrmp * ( [ eq : wsrmp ] ) of an itree network with concave objective function @xmath244 can be equivalently solved by the following convex optimization problem .    @xmath245    where @xmath246 for @xmath247 with @xmath248 .",
    "the objective function is defined as@xmath249_{l}\\right), ...",
    ",\\mathbf{\\sigma}_{l}\\left(\\left[l - i\\right]_{l}\\right), ...",
    ",\\mathbf{\\sigma}_{l}\\left(\\left[l - i\\right]_{l}\\right)\\right),\\end{aligned}\\ ] ] where @xmath250_{l}=\\left(n\\ \\textrm{mod}\\ l\\right)+1 $ ] .",
    "the physical meaning of the optimization problem ( [ eq : mwsrm ] ) is that it is a weighted sum - rate maximization problem of @xmath21 networks , all of which are identical to the network in the original problem in ( [ eq : wsrmp ] ) .",
    "the purpose of expanding the single - network optimization problem in ( [ eq : wsrmp ] ) to the multiple - network optimization problem in ( [ eq : mwsrm ] ) is to decouple the power constraints so that the input covariance matrices of a network belong to different power constraints and the input covariance matrices of a power constraint belong to different networks . in problem ( [ eq : mwsrm ] ) , the update of the input covariance matrices of a power constraint is easier because there is no interference among the networks , and other input covariance matrices not belonging to this power constraint can be treated as constants , resulting in monotonically convergent iterative algorithm .",
    "a similar method is also used in @xcite .",
    "we use the subscript @xmath230 to denote the terms corresponding to the @xmath251 network , e.g. , the input covariance matrices for the @xmath251 network is denoted as @xmath252 .",
    "the one - to - one mapping between @xmath253 and @xmath254 is given by@xmath255_{l}\\right),\\label{eq : mapsigma}\\\\ \\mathbf{\\sigma}_{l}\\left(k\\right ) & = & \\mathbf{\\sigma}_{\\left[l - k\\right]_{l},l},\\forall i , k , l\\in\\left\\",
    "{ 1, ... ,l\\right\\ } .\\nonumber \\end{aligned}\\ ] ] then we have @xmath256 note that the power constraint @xmath257 couples the networks together .",
    "the following example illustrates the mapping in ( [ eq : mapsigma ] ) for @xmath258:@xmath259 where the element at the @xmath38 column and @xmath260 row is equal to @xmath261 , the input covariance matrix for the @xmath38 link of the @xmath260 network .",
    "the following lemma holds for @xmath262 .",
    "[ lem : propfmod]the function @xmath262 satisfies the following properties :    1 .",
    "let @xmath263 , satisfy @xmath202 .",
    "the mapping @xmath264 , results in @xmath257 , and @xmath265 satisfying @xmath266 .",
    "2 .   let @xmath267 , satisfy @xmath257 .",
    "the mapping @xmath268 @xmath269 results in @xmath202 and @xmath270 satisfying + @xmath271    the first property is obvious and the second property holds because@xmath272 where ( [ eq : fmodeqf ] ) follows from the concavity of @xmath244 .",
    "the lemma says that the problems ( [ eq : wsrmp ] ) and ( [ eq : mwsrm ] ) are equivalent and every optimal solution @xmath273 of problem ( [ eq : mwsrm ] ) maps directly to the optimal solution @xmath274 of the * wsrmp * ( [ eq : wsrmp ] ) .",
    "we first obtain insight of the problem by finding the necessary and sufficient conditions satisfied by the optimum . with the insight",
    ", we design an algorithm which monotonically increases the objective function until convergence to the optimum .",
    "[ thm : optimality]necessity : if @xmath275 is an optimum of problem ( [ eq : mwsrm ] ) , then @xmath276 , @xmath277 must satisfy the following optimality conditions :    1 .",
    "for any @xmath278 , @xmath279 possesses the polite water - filling structure as in definition [ def : defgwf ] , i.e. , @xmath280_{l},l}^{1/2}\\mathbf{\\tilde{\\sigma}}_{l}\\left(k\\right)\\tilde{\\mathbf{\\hat{\\mathbf{\\omega}}}}_{\\left[l - k\\right]_{l},l}^{1/2}$ ] is given by water - filling over the equivalent channel @xmath281_{l},l}^{-1/2}\\mathbf{h}_{l , l}\\tilde{\\mathbf{\\hat{\\mathbf{\\omega}}}}_{\\left[l - k\\right]_{l},l}^{-1/2}$ ] .",
    "the water - filling level for @xmath279 is given by @xmath282 , where @xmath161 does not depend on @xmath28 and @xmath283 is chosen such that @xmath284 .    sufficiency : if certain @xmath275 satisfies the above optimality conditions , then it must satisfy the kkt conditions of problem ( [ eq : mwsrm ] ) , and thus is the global optimum of problem ( [ eq : mwsrm ] ) .",
    "we go over the proof in detail as it helps design the algorithm .",
    "it can be proved by contradiction that the optimum @xmath275 must satisfy @xmath285 . otherwise ,",
    "if @xmath286 for some @xmath28 , we can strictly improve the rate of the first link in the @xmath287_{l})^{\\text{th}}$ ] network by increasing the power of @xmath288 until @xmath284 .",
    "all other rates are not affected because the first link causes no interference to other links .",
    "then the objective function can be strictly increased , we can still increase the objective function by improving the rate of the second link in the @xmath289_{l})^{\\text{th}}$ ] network , and so on .",
    "] , which contradicts that @xmath275 is an optimum .",
    "the remaining necessity part is proved by showing that if for some @xmath28 , @xmath290 does not satisfy the polite water - filling structure in theorem [ thm : optimality ] , the objective function can be strictly increased by enforcing this structure on @xmath290 . without loss of generality",
    ", we only need to prove this for @xmath291 due to the circular structure of @xmath262 , i.e. , @xmath292    we define some notations and give two useful lemmas . for the @xmath293 network , fixing the input covariance matrices @xmath294 for the last @xmath295 links , the first @xmath230 links form a sub - network@xmath207_{k , l=1, ... ,i},\\sum_{l=1}^{i}\\textrm{tr}\\left(\\mathbf{\\sigma}_{i , l}\\right)=p_{t}^{i},\\left[\\mathbf{w}_{i , l}\\right]_{l=1, ... ,i}\\right),\\label{eq : sub1toi}\\ ] ] where @xmath296 is the covariance matrix of the equivalent colored noise of link @xmath1 ; @xmath297 .",
    "it is obvious that this sub - network is still an itree network . by theorem",
    "[ thm : linear - color - dual ] , the corresponding dual sub - network is @xmath212_{k , l=1, ... ,i},\\sum_{l=1}^{i}\\textrm{tr}\\left(\\hat{\\mathbf{\\sigma}}_{i , l}\\mathbf{w}_{i , l}\\right)=p_{t}^{i},\\left[\\mathbf{i}\\right]_{l=1, ... ,i}\\right).\\label{eq : sub1toi - dual}\\ ] ] denote @xmath298 and @xmath299 the forward and reverse link rates of the @xmath55 link of the @xmath293 sub - network ( [ eq : sub1toi ] ) achieved by @xmath300 and @xmath301 respectively . in contrast ,",
    "@xmath302 and @xmath303 denote the forward and reverse link rates of the @xmath55 link of the @xmath293 network .",
    "[ lem : rsigmasub]let @xmath304 be the covariance transformation of @xmath305 , applied to the @xmath251 network .",
    "then @xmath306 is also the covariance transformation of @xmath307 , applied to the @xmath293 sub - network ( [ eq : sub1toi ] ) .",
    "the interference from link @xmath308 is counted in the colored noise in the @xmath293 sub - network ( [ eq : sub1toi ] ) .",
    "therefore , the mmse - sic receive vectors @xmath309 are the same in both @xmath293 network and its sub - network . because the @xmath293 network is an itree network , in its dual network , there is no interference from link @xmath308 to link @xmath310 by lemma [ lem : revinf ] .",
    "therefore , for link @xmath310 , there is no difference between the @xmath293 dual sub - network ( [ eq : sub1toi - dual ] ) and the @xmath293 dual network . in both dual networks ,",
    "the transmit powers of the first @xmath230 links given by ( [ eq : qpower ] ) in the covariance transformation achieve the same sinrs as in the @xmath293 network .",
    "but for fixed @xmath309 and @xmath311 , the transmit powers producing the same sinrs are unique ( * ? ? ?",
    "* lemma 1 ) .",
    "therefore the transmit powers of the first @xmath230 links must be the same for the two dual networks , which implies that lemma [ lem : rsigmasub ] must hold .",
    "[ lem : kktitree]the necessary and sufficient conditions for @xmath312 to be the optimal solution of problem ( [ eq : wsrmp ] ) for an itree network with concave objective function are listed below .    1 .",
    "it possesses the polite water - filling structure as in definition [ def : defgwf ] .",
    "the water - filling level @xmath161 for @xmath313 is given by @xmath282 , where @xmath283 is chosen such that @xmath314 .",
    "the proof is given in appendix [ sub : proof - of - lemma - kktitree ] .",
    "then we give an algorithm to improve the objective function if @xmath315 does not satisfy the two necessary conditions in theorem [ thm : optimality ] .",
    "it contains three steps .",
    "note that @xmath315 contains the input covariance matrices of the @xmath293 link of the @xmath293 network for @xmath316 , i.e. , @xmath317 .",
    "* step * 1 : for @xmath316 , calculate @xmath318 by the covariance transformation applied to the @xmath293 sub - network .",
    "due to the special interference structure of the itree network , the calculation of the reverse transmit powers of the covariance transformation can be simplified to be calculated one by one as follows . when calculating @xmath319 , the transmit powers @xmath320 @xmath321 and @xmath322",
    "have been calculated .",
    "therefore , we can calculate @xmath323 and obtain the interference - plus - noise covariance matrix of the reverse link @xmath1 as @xmath324 .",
    "then @xmath319 is given by@xmath325 and correspondingly @xmath326 by theorem [ thm : linear - color - dual ] , we have @xmath327 and @xmath328 .    * step * 2 : improve @xmath329 by enforcing the polite water - filling structure on @xmath330 .",
    "by lemma [ lem : revinf ] , in the @xmath251 sub network , the reverse link @xmath230 causes no interference to the first @xmath331 reverse links .",
    "fixing @xmath332 , we can improve @xmath329 without reducing the rates of reverse link @xmath333 in the @xmath251 sub - network for all @xmath230 by solving the following weighted sum - rate maximization problem for @xmath21 parallel channels with colored noise :    where @xmath334 and @xmath335 .",
    "this is a classic problem with unique water - filling solution .",
    "the solution with sum power constraint is obtained in @xcite , which can be extended to the case of linear constraint here .",
    "alternatively , the solution can be obtained from theorem [ thm : wfst ] and lemma [ lem : whiten - net ] for a network of parallel channels .",
    "perform the thin svd @xmath336 .",
    "let @xmath337 and @xmath338 be the @xmath339 diagonal element of @xmath340 . obtain @xmath341 as @xmath342 where @xmath343 is chosen such that @xmath344 .",
    "the calculation of @xmath343 is easy : 1 ) let @xmath345 index the @xmath339 eigen - channel of the @xmath293 network s @xmath293 link .",
    "initialize the set of indices of channels with nonnegative power as @xmath346 @xmath347 to include all eigen - channels ; 2 ) calculate @xmath343 for the channels in @xmath348 without @xmath349 operation ; 3 ) for all @xmath350 , if @xmath351 , fix it with zero power @xmath352 , delete @xmath353 from @xmath348 .",
    "repeat step 2 ) until all @xmath354 .",
    "then the optimal solution of problem ( [ eq : wsrm - parallel ] ) is given by @xmath355 i.e. , @xmath356 satisfy the polite water - filling structure and the water - filling levels are proportional to the weights @xmath357 . by theorem [ thm : fequrgwf ] , if @xmath358 does not satisfy the polite water - filling structure or the water - filling levels are not proportional to the weights , nor    does @xmath359 , which means that it is not the optimal solution of problem ( [ eq : wsrm - parallel ] ) . therefore if we let @xmath360 , we must have @xmath361 .",
    "* step * 3 : improve the objective function by the covariance transformation from @xmath362 to @xmath363 for all the @xmath21 sub - networks .",
    "again , the calculation of the transmit powers of the covariance transformation can be simplified similar to ( [ eq : rlpowtree ] ) .",
    "let @xmath364 @xmath365 . by theorem [ thm : linear - color - dual ] , we have @xmath366 and @xmath367 @xmath368 @xmath369 , which implies that the sum power of @xmath370 is still @xmath371 .",
    "note that the first @xmath230 links cause no interference to other links and @xmath372 . combining the above facts and the second property in lemma [ lem : propfmod ] , the objective function can be strictly increased by updating @xmath290 s as @xmath373 where @xmath374 is obtained from @xmath370 according to ( [ eq : mapsigma ] ) ; and the updated @xmath290 s satisfy @xmath375 .",
    "this contradiction proves that the optimal @xmath376 must satisfy the polite water - filling structure and the water - filling level for @xmath279 is given by @xmath377 .",
    "the condition that @xmath378 can also be proved by contradiction . if @xmath379 s are different , the water - filling levels @xmath380 s of the input covariance matrices @xmath381 for the first network are not proportional to the weights . then by lemma [",
    "lem : kktitree ] , @xmath381 is not the optimal solution of problem ( [ eq : wsrmp ] ) with sum power constraint @xmath382 for the first network , which implies that there exists @xmath383 achieving a higher weighted sum - rate for the first network with the same sum power .",
    "similarly , for the @xmath260 network , @xmath384 , there exists @xmath385 achieving a higher weighted sum - rate with the same sum power . then after updating @xmath290 s from @xmath385 s using ( [ eq : updatesigma ] ) , the objective function of problem ( [ eq : mwsrm ] ) is strictly increased .",
    "this contradiction completes the proof for the necessity part .",
    "now , we prove the sufficiency part . for convenience ,",
    "we map @xmath275 to @xmath386 @xmath387 using ( [ eq : mapsigma ] ) and show that @xmath388 satisfies the kkt conditions of problem ( [ eq : mwsrm ] ) .",
    "the lagrangian of problem ( [ eq : mwsrm ] ) is@xmath389_{l},l}\\right)\\right)\\\\   & + \\sum_{i=1}^{l}\\sum_{l=1}^{l}\\textrm{tr}\\left(\\mathbf{\\sigma}_{i , l}\\mathbf{\\theta}_{i , l}\\right).\\end{aligned}\\ ] ] the kkt conditions are@xmath390_{l},l}\\right)=p_{t};\\nonumber \\\\ \\textrm{tr}\\left(\\mathbf{\\sigma}_{i , l}\\mathbf{\\theta}_{i , l}\\right)=0 ; &   & \\mu_{k}\\geq0,\\:\\mathbf{\\sigma}_{i , l},\\mathbf{\\theta}_{i , l}\\succeq0;\\label{eq : kkt1}\\end{aligned}\\ ] ] for all @xmath391 .",
    "the condition @xmath392 can be expressed as @xmath393_{l}}}\\mathbf{\\phi}_{k , l}\\mathbf{h}_{k , l}^{\\dagger}\\nonumber \\\\   & \\times\\left(\\mathbf{\\omega}_{i , k}^{-1}-\\left(\\mathbf{\\omega}_{i , k}+\\mathbf{h}_{k , k}\\mathbf{\\sigma}_{i , k}\\mathbf{h}_{k , k}^{\\dagger}\\right)^{-1}\\right)\\mathbf{h}_{k , l}+\\mathbf{i}\\nonumber \\\\ = & \\frac{w_{l}}{\\mu_{[l - i]_{l}}}\\mathbf{h}_{l , l}^{\\dagger}\\left(\\mathbf{\\omega}_{i , l}+\\mathbf{h}_{l , l}\\mathbf{\\sigma}_{i , l}\\mathbf{h}_{l , l}^{\\dagger}\\right)^{-1}\\mathbf{h}_{l , l}+\\frac{1}{\\mu_{[l - i]_{l}}}\\mathbf{\\theta}_{i , l}.\\label{eq : dlequ}\\end{aligned}\\ ] ] since @xmath394 satisfies the polite water - filling structure with water - filling levels given by @xmath395 s , by theorem [ thm : at - the - boundary ] , the dual input covariance matrices @xmath396 can be expressed as@xmath397 then we have@xmath398 choose the dual variables @xmath399 as @xmath400 and substitute @xmath394 into condition ( [ eq : dlequ ] ) to obtain @xmath401 because equation ( [ eq : keykkt ] ) is also the kkt condition of the single - user polite water - filling problem over the channel @xmath402 and @xmath403 has polite water - filling structure over this channel with water - filling level @xmath404 by the optimality condition , @xmath388 satisfies condition ( [ eq : keykkt ] ) .",
    "it can be verified that @xmath388 also satisfies all other kkt conditions in ( [ eq : kkt1 ] ) .",
    "since problem ( [ eq : mwsrm ] ) is convex , kkt conditions are sufficient for global optimality .",
    "this completes the proof for theorem [ thm : optimality ] .",
    "the proof of theorem [ thm : optimality ] actually gives an algorithm to find the optimal solution of problem ( [ eq : mwsrm ] ) by monotonically increasing the objective function .",
    "we refer to it as _ _ algorithm p and summarize it in table [ tab : table1 ] , where p stands for polite .",
    "note that although in each iteration , we only enforce the polite water - filling structure in theorem [ thm : optimality ] on @xmath315 , all @xmath290 s will eventually satisfy the polite water - filling structure due to ( [ eq : updatesigma ] ) .",
    "the convergence and optimality of algorithm p is proved in the theorem below .",
    ".[tab : table1]algorithm p ( for itree networks with concave @xmath244 ) [ cols= \" < \" , ]     it is observed in the simulations that both algorithm pt and algorithm pp have faster convergence speed and higher accuracy than the algorithms not exploiting the optimal input structure .    in most cases , algorithm pt and pp are observed to have similar convergence speed .",
    "but for networks with strong interference loops such as strong interference channel , algorithm pp is observed to have a better convergence behavior than algorithm pt .",
    "another advantage of algorithm pp is that the polite water - filling procedure to obtain has lower complexity than the covariance transformation in algorithm pt , as will be discussed in section [ sub : complexity - analysis ] .",
    "[ rem : a - nontrivial - conv]a nontrivial future work is to find the convergence conditions of algorithm pt or pp for itree networks and general b - mac networks . it has been observed that algorithm pt and pp always converge monotonically in itree networks with concave or non - concave objective functions , just like the provably monotonically convergent algorithms designed for itree networks in @xcite .",
    "it is possible that the structure of the itree networks guarantees it , which suggests that itree networks has more useful properties to be found . for general b - mac networks ,",
    "one possible solution may be extending the approach used in @xcite for iterative selfish water - filling to polite water - filling .",
    "it is proved in @xcite that under certain stringent conditions , the selfish water - filling is a contraction mapping , and thus the uniqueness of the nash equilibrium and the convergence of the iterative selfish water - filling is guaranteed by the fixed point theory .",
    "the physical interpretation of these conditions is that the interference among the links is sufficiently small .",
    "because in the polite water - filling , the interference to other links is well taken care of by the pre - whitening of the channel using @xmath405 , we conjecture that the convergence conditions for algorithm pt or pp will be much looser than iterative selfish water - filling .",
    "this conjecture is verified by the simulations in section [ sec : simulation - results ] , where algorithm pp is observed to converge for almost all general b - mac networks simulated .",
    "algorithm pt also converges for most general b - mac networks simulated except for the interference channel with very strong interference .",
    "but even for this case , algorithm pt still converges after a few trials , e.g. , three trials , to select a good initial point .",
    "another approach to convergence proof may be interpreting the polite water - filling as message passing in a factor graph and derive the conditions of convergence on the graph .",
    "the following is the connection to another iterative water - filling algorithm proposed in ( * ? ? ?",
    "* section iv ) for parallel siso interference networks .",
    "it is derived by directly solving the kkt conditions of the weighted - sum rate maximization problem . as expected",
    ", the result    also has a term @xmath0 related to the interference to other nodes . in the siso case",
    ", the matrix @xmath406 equals to @xmath407 in @xcite only for stationary points .",
    "algorithm pt or pp can be used there to reduce the inner and outer iterations to one iteration , reducing the complexity .",
    "on the other hand , we can design an algorithm by directly solving the kkt conditions for the mimo case and by using the concept of polite water - filling .",
    "it results in an algorithm that has similar performance to algorithm pt but does not take the advantage of the duality . in the algorithm",
    ", we replace the matrix @xmath406 by the term @xmath408 in ( [ eq : kktwsr-1 ] ) , avoiding the covariance transformation in algorithm pt and reverse link polite water - filling in algorithm pp . but as a result , the equivalent channel becomes a function of @xmath343 and in order to perform the polite water - filling , svd has to be repeatedly done while searching for @xmath343 to satisfy the power constraint , increasing the overall complexity .",
    "we first give a brief analysis to show the complexity order per iteration of the proposed algorithms .",
    "the main computation complexity lies in the svd and matrix inverse operations in the polite water - filling procedure and in the calculation of the mmse - sic receivers for the covariance transformation .",
    "note that both svd and matrix inverse are performed over the matrices whose dimensions are equal to the number of the transmit and receive antennas at each node and are not increased with the number of transmission links @xmath21 .",
    "this , however , is not true for generic optimization methods which do not take advantage of the polite water - filling structure of the optimal solution .",
    "since the operations of svd and matrix inverse have similar complexity , we use the order of the total number of svd and matrix inverse operations to measure the complexity . note",
    "that we need to calculate @xmath409 mmse - sic receive vectors for the @xmath236 link in the covariance transformation .",
    "however , as pointed out in @xcite , if the precoding matrix @xmath130 is chosen to decorrelate the streams of link @xmath1 , we only need to perform one matrix inverse and one svd to find such precoding matrices and the corresponding mmse - sic receive vectors .",
    "* we give the complexity order of each iteration of algorithm p. in step 1 , we need to calculate @xmath410 by the covariance transformation , which has a complexity order of @xmath411 . in step 2 , the complexity order of the polite water - filling procedure to obtain @xmath412 s is also @xmath411 . and",
    "in step 3 , the covariance transformation to calculate @xmath413 has a complexity order of @xmath414 .",
    "therefore , the total complexity order is @xmath414 .",
    "* algorithm p1 only adds a linear search compared to algorithm p. therefore , it has the same complexity order as algorithm p. * the complexity order of algorithm pt depends on whether the network under optimization is itree network or not . for itree network , it is clear that the covariance transformation to obtain @xmath123 in step 1 and the polite water - filling to obtain @xmath3 s in step 2 have a complexity order of @xmath411 because the reverse link power in the covariance transformation can be calculated one by one . for other networks , to calculate the reverse transmit powers in the covariance transformation , we need to solve a @xmath415-dimensional linear equation as in ( [ eq : qpower ] ) , whose complexity depends on the density and structure of the cross - talk matrix @xmath416 . in the worst case ,",
    "the complexity order is @xmath417 . in other cases such as with triangular or sparse @xmath416 ,",
    "the complexity is much lower .",
    "fortunately , there are many fast algorithms to solve the linear equations even for relatively large dimensions , and in practice , @xmath416 is usually sparse for a large wireless network because of path loss or interference suppression techniques . *",
    "the complexity order of algorithm pp is @xmath411 regardless of whether the network is an itree network or not since the reverse input covariance matrices are also obtained by polite water - filling .    in practice ,",
    "algorithm pt is the choice for itree networks because its performance is similar to algorithm p1 but the complexity is much lower , while algorithm pp , which has even lower complexity , is a better choice for general b - mac networks because it also has fast convergence speed and the convergence behavior is less sensitive to the interference loops and interference strength",
    ". therefore , algorithm p and p1 are more of theoretic value .",
    "although algorithm p and p1 have higher complexity than the @xmath411 algorithms in @xcite , they are still much simpler than the standard interior point methods of complexity order of @xmath417 @xcite and can be used in more general cases compared to those for mimo mac / bc .",
    "second , we discuss the number of iterations needed or in other words , the convergence speed . the number of neighbors of a node in the network is expected to have little influence on the convergence speed of the designed algorithms because at each link , the forward link interference - plus - noise covariance matrix and its reverse link dual summarize all interference no matter how many neighbors of the link are there .",
    "the convergence speed is expected to depend on the girth of the network because each iteration propagates the influence of the transmission scheme of a transmitter to its closest neighbors .",
    "but in a wireless network , large girth with uniformly strong channel gains has small probability to happen .",
    "in addition , the optimal polite water - filling structure is forced on to the solution at each iteration .",
    "therefore , the number of iterations needed is small . in simulations results , we observe that 1.5 iterations achieves much of the rate and 2.5 iterations achieves most of the rate of 50 user multiaccess channels and two or three user interference channels , where half an iteration refers to an update in the forward link or reverse link .",
    "define the accuracy as the difference between the performance of a certain number of iterations and the maximum , if known .",
    "accuracy versus iteration numbers gives a closer look at the asymptotic convergence behavior .",
    "as expected , the algorithms in this paper have superior accuracy because of the optimality of the polite water - filling structure .    in summary , algorithm pt and pp",
    "are expected and have been verified by simulation to have superior performance , complexity per iteration , convergence speed , and accuracy than other algorithms that do not take the advantage of the optimal input structure .",
    "in this section , simulations are used to verify the performance of the proposed algorithms .",
    "block fading channel is assumed and the channel matrices are independently generated by @xmath418 , where @xmath419 has zero - mean i.i.d .",
    "gaussian entries with unit variance and @xmath420 is a constant . in most cases , we let @xmath421 except for fig . [",
    "fig : figitreegiwf ] and fig .",
    "[ fig : figifcgiwf ] . for weighted sum - rate",
    ", the weights are randomly chosen between 0.8 and 1.2 . in fig .",
    "[ fig : fig1]-[fig : fig1 - 2 ] , fig .",
    "[ fig : figitreegiwf ] and fig .",
    "[ fig : figifcgiwf ] , each simulation is averaged over 100 randomly generated channel realizations to show that the performance difference is not an accident . in all other figures , the simulation is performed over a single channel realization to show the details of the or the effect of different initial points . in fig .",
    "[ fig : figxconvg ] , fig .",
    "[ fig : figifcgiwf ] , and fig .",
    "[ fig : figifcbp ] where we run algorithm pt or pp with several initial points , the first initial point is chosen to be zero and other initial points are randomly generated . in all other cases ,",
    "we use zero initial points for all algorithms .    to make fair comparison of the convergence speed by taking into account the complexity",
    ", we use _ effective iterations_. each iteration of the algorithm pt or pp consists of an update in the forward links and an update in the reverse links .",
    "the rates are output at 0.5 , 1.5 , 2.5 , _ etc .",
    "_ , effective iterations . for algorithm p1 ,",
    "the @xmath260 iteration is also the @xmath260 effective iteration because each iteration consists of the update in the reverse and then the update in the forward links . for the other algorithms that we compared with in the literature ,",
    "the @xmath260 iteration is counted as the @xmath422 effective iteration because they only have update in the forward links .",
    "this is a conservative approach because some of these other algorithms complexity of each iteration is higher than that of one half iteration of algorithm pt or pp .",
    "nevertheless , algorithms pt and pp still show clear advantages .",
    "we first demonstrate the superior convergence speed of algorithms p1 , pt and pp .",
    "[ fig : fig1]-[fig : fig1 - 2 ] plot the ( weighted ) sum - rate versus effective iteration number for a mimo mac with 2 transmit antennas at each user and 8 receive antennas .",
    "the scenarios of sum - rate , weighted sum - rate , 10 users , and 50 users are simulated .",
    "the results are compared with those of the steepest ascent algorithm in @xcite with matlab code from @xcite , the ` original algorithm ' and ` algorithm 2 ' of jrvg in @xcite with matlab code from @xcite , and the dual decomposition algorithm in @xcite .",
    "the ` original algorithm ' in @xcite is obtained by enforcing the water - filling structure for the sum - rate in @xcite at each iteration .",
    "it is observed in @xcite that the sum - rate of the ` original algorithm ' grows fast initially and then may decrease and/or oscillate .",
    "therefore , a hybrid algorithm called ` original + algorithm 2 ' is considered the best in @xcite , where the ` original algorithm ' is performed for the first five iterations , and then ` algorithm 2 ' in @xcite is used for all the subsequent iterations .",
    "it is observed that algorithms p1 , pt and pp have similar initial convergence speed as that of ` original + algorithm 2 ' and outperform all other algorithms .",
    "as expected , the convergence speed of algorithms p1 , pt and pp appears to be independent of the number of users because the girth of the interference graph of the mac is one , regardless of the number of users . in fig .",
    "[ fig : figsrerror ] and fig .",
    "[ fig : figwsrerror ] , we compare the asymptotic convergence speed , or accuracy , defined as the errors from the maximums of the sum - rate and the weighted sum - rate respectively .",
    "algorithm p1 , pt and pp have the highest accuracy than other algorithms except for the dual decomposition algorithm in @xcite .",
    "this is not surprising because the dual decomposition algorithm is a water - filling directly on the objective function , sum - rate , while the polite water - filling is on each link .",
    "the errors accumulate when summing all the links rates together . in summary ,",
    "for sum - rate , the best algorithm will be ` original algorithm + algorithm pt or pp ' for a compromise of initial convergence speed and accuracy .",
    "for weighted sum - rate , the best is algorithm pt or pp .    in fig .",
    "[ fig : fig3 ] , we plot the sum - rate for a z channel with concave sum - rate function and the weighted sum - rate for a 3-user interference channel . in both channels ,",
    "each node has 4 antennas . for the z channel",
    ", it can be observed that algorithms p1 and pt have faster convergence speed than algorithm p. for the 3-user interference channel where the problem may be non - convex , algorithm pt and pp have the same performance and converge fast and monotonically to a stationary point .    in fig .",
    "[ fig : figxconvg ] , we show the convergence speed of algorithm pp for a nontrivial example of b - mac networks , the two - user x channel , with 3 antennas at each transmitter and 3 antennas at each receiver .",
    "we plot the weighted sum - rate versus the effective iteration number with three different initial points for the same channel realization . for all initial points",
    ", algorithm pp converges quickly to some stationary points .",
    "however , the convergence speed is observed to depend on the initial point . and due to the non - convexity of the problem , algorithm pp with different initial points",
    "may converge to different stationary points .",
    "as expected , the polite water - filling is superior to the selfish water - filling .",
    "the selfish water - filling can be obtained by fixing the @xmath7 s in algorithm pt or pp as identity matrices .",
    "selfish water - filling is expected to converge in itree networks but not in networks with strong interference loops as shown in fig .",
    "[ fig : figitreegiwf ] for the itree network of fig .",
    "[ fig : itree ] and in fig .",
    "[ fig : figifcgiwf ] for a 3-user interference channel .",
    "each node is assumed to have four antennas . in the upper sub - plot of fig .",
    "[ fig : figitreegiwf ] , we consider the moderate interference case , where we set @xmath423 . in the lower sub - plot of fig .",
    "[ fig : figitreegiwf ] , we consider strong interference case , where we set @xmath424 for the interfering links , and @xmath425 for other @xmath426 s .",
    "it can be observed that the three algorithms converge in both cases . but",
    "algorithm pt and pp achieve a much higher sum - rate than the selfish water - filling . in the upper sub - plot of fig .",
    "[ fig : figifcgiwf ] , we set @xmath421 , and similar results as in fig . [",
    "fig : figitreegiwf ] can be observed . in the lower sub - plot",
    ", we consider a strong interference channel , where we set @xmath427 , and @xmath428 . in this case",
    ", the selfish water - filling based algorithm no longer converges .",
    "algorithm pt converges with a good initial point found by a typically three trials .",
    "but even with a non - converging initial point , algorithm pt still achieves a higher sum - rate than the selfish water - filling .",
    "algorithm pp converges for almost all channel realizations , which demonstrates its insensitivity to the interference loops and strength .",
    "algorithms pt and pp can be used to find the approximate boundary of the convex hull of the achievable rate region of mimo b - mac networks . in fig .",
    "[ fig : figifcbp ]    , we plot the approximate boundary achieved by algorithm pp for a two - user interference channel with 3 antennas at each transmitter and 4 antennas at each receiver .",
    "the sum power constraint is @xmath429 .",
    "the weights are @xmath430 and @xmath431 , with @xmath343 varying from 0.01 to 0.99 with step 0.01 .",
    "the boundary ( dot line ) obtained from a single initial point for algorithm pp is close to the _ _ _ pseudo global optimum _ _ _ ( solid line ) , _ _ which is the best solution of algorithm pt with many randomly generated initial points .",
    "the result demonstrates that algorithm pp can find good solutions even with single initial point",
    ".    not showing is that algorithm pt with a single initial point also achieves near pseudo optimum boundary .",
    "this paper extends bc - mac rate duality to the mimo one - hop interference networks named b - mac networks with gaussian input and any valid coupling matrix .",
    "the main contribution is the discovery that the pareto optimal input has a polite water - filling structure , which optimally balances between reducing interference to others and maximizing a link s own rate .",
    "it provides insight into understanding interference in networks and an elegant method to decompose a network to multiple equivalent single - user links .",
    "it can be employed to design / improve most network optimization algorithms . as an example ,",
    "low complexity weighted sum - rate maximization algorithms are designed and demonstrated to have superior convergence speed and accuracy . a sub - class of the b - mac networks , the interference tree ( itree ) networks ,",
    "is identified , for which the optimality of the algorithm is discussed .",
    "itree networks appears to be a natural extension of broadcast and multiaccess networks and possesses many desirable properties .    the results in this paper is a stepping stone for solving many interesting problems .",
    "some future work is listed below .    *",
    "_ extension to han - kobayashi transmission scheme : _ han - kobayashi scheme cancels more interference and is especially beneficial when the interfering channel gain is large .",
    "but its optimization is still an open problem .",
    "as discussed in remark [ rem : ext - han - kobayashi ] of section [ sub : polite water - filling ] , the lagrangian interpretation of the reverse link interference - plus - noise covariance matrix for the polite water - filling makes it possible to extend the duality and polite water - filling to han - kobayashi transmission scheme so as to help understand the optimal input structure and design low complexity optimization algorithms .",
    "the approach in this paper may also be useful in multi - hop networks , relay channels , and ad - hoc networks . * _ general linear constraints , cognitive radio , and other optimization problems : _ polite water - filling is beneficial to most b - mac network optimization problems .",
    "for example , the extension to a linear constraint in section [ sub : extension - linear - constraints ] means that the duality and polite water - filling can be powerful tools to optimize networks with general linear constraints , such as per antenna power constraints and interference constraints in cognitive radio . in these problems ,",
    "the single linear constraint in this paper becomes a weighted sum of multiple linear constraints where the weights are lagrange multipliers .",
    "searching these lagrange multipliers together with the primary variables is an advantage of the efficient interior point algorithms in @xcite .",
    "the techniques in this paper can lead to better iterative algorithms by taking advantage of the structure of the problems : polite water - filling can solve the problem efficiently to obtain @xmath136 s for fixed lagrange multipliers , where the covariances @xmath7 s are functions of the lagrange multipliers . then , at each iteration and for fixed @xmath136 s , we may update the lagrange multipliers by forcing @xmath432 to satisfy the linear constraints so that both the optimal primary and dual variables can be found jointly .",
    "a better approach is to introduce virtual nodes for the constraints and take advantage of the polite water - filling and duality for the larger network where those lagrange multipliers become some of the reverse link powers .",
    "other optimization problem examples include ones with quality of service requirement , such as minimizing power under rate constraints and maximizing the minimum of weighted rates under a sum power constraint in our recent work @xcite .",
    "* _ distributed optimization and finite rate message passing : _ this paper studies centralized optimization with global channel state information and a sum power constraint . in practice and for large networks , we have to design distributed / game - theoretic optimization algorithms with partial channel state information under individual or group power constraints @xcite . the insight from polite",
    "water - filling structure turns out to be very useful as it turns the problem into single - user optimization problems under the influence of interference from and to others as summarized by the covariance matrices @xmath6 and @xmath7 .",
    "partial or full knowledge of these covariance matrices can be obtained from reverse link transmission or pilot training in time division duplex ( tdd ) systems or from message passing among the nodes in frequency division duplex ( fdd ) systems @xcite .",
    "the observation that very few iterations , usually two to three , suffices for the algorithms to achieve most of the gain makes the message passing approach meaningful . in practice ,",
    "the message passing is further limited to finite rate .",
    "the single - user view of the polite water - filling structure makes it convenient to extend the results of the single - user finite rate feedback in @xcite to b - mac networks . * _ extension to fading channels , ofdm systems , and adaptive transmission : _ fixed channel matrices are considered in this paper .",
    "it is straightforward to extend the results to time varying channels like fading channels and ofdm system by considering parallel b - mac networks .",
    "then , the polite water - filling will be across users , space ( antennas ) , time , and frequency .",
    "the optimization of encoding / decoding order in general is an open problem .",
    "progress may be first made for the itree networks . in time varying channels ,",
    "the insight of viewing reverse link power as lagrange multipliers can be employed to design adaptive transmission algorithms where the lagrange multipliers are adaptively adjusted .",
    "in fact , the iterative algorithms in this paper can be used with little modification by , e.g , updating to the latest channel matrices whenever they are available + . * _ itree networks : _ a fruitful approach to the open problem of network information theory is to study various special cases , such as deterministic channels @xcite and degree of freedom @xcite , in order to gain insight into the problem .",
    "itree networks appears to be a useful sub - class of networks to study .",
    "because there is no interference loops , the optimization of a link will affect some other nodes , but which in turn will not change the interference to this link .",
    "therefore , it is possible to say more about the optimality of the transmission and make more progress on network information theory for itree networks .",
    "the tree structure also makes it easier to analyze the distributed optimization by iterative message passing @xcite , just like how the tree structure in ldpc decoding graph facilitates its analysis @xcite .",
    "in fact , a factor graph interpretation of the polite water - filling may reveal some more insight .",
    "because of mutual interference in wireless channels , there are likely many loops in the interference graph defined in section [ sub : itree ] .",
    "interference cancellation techniques like the han - kobayashi scheme @xcite can be viewed as a method to break the strong loops and make the graph more like a tree , making itree networks relevant to practice and more meaningful to study .",
    "assume @xmath68 is a boundary point and @xmath210 achieves a rate point @xmath70 , and @xmath71 .",
    "one can find an @xmath433 such that @xmath434 .",
    "then , the extra power @xmath435 can be used to improve _ all _ non - zero rate users rates over @xmath68 using @xmath436 as the input covariance matrices , where @xmath437 is chosen such that @xmath438 .    by the definition",
    "that the region is a union of sets @xmath439 , @xmath68 must not be a boundary point , which contradicts with the assumption .",
    "therefore , the statement in theorem [ thm : stongpareto ] must be true .      without loss of generality , we only prove theorem [ thm : optdual ] for link 1 .",
    "we assume @xmath440 for simplicity of notations .",
    "the proof is obtained by solving the kkt conditions of another sum power minimization problem as will be formulated later in ( [ eq : minpowl ] ) , where the minimization is over @xmath441 and the transmit powers of other links @xmath442^{t}\\in\\mathbb{r}_{+}^{\\left(l-1\\right)m\\times1}$ ] with the transmit and receive vectors for other links fixed as @xmath443 .",
    "we first give lemma [ lem : nesaykkt ] which states that there exist dual variables satisfying the kkt conditions of problem ( [ eq : minpowl ] ) .",
    "then we show that the dual variables in lemma [ lem : nesaykkt ] are the optimal dual variables of problem ( [ eq : minpowl ] ) and they must be uniquely given by theorem [ thm : optdual ] . finally , we prove lemma [ lem : nesaykkt ] by the enhanced fritz john necessary conditions ( * ? ? ?",
    "first we define the notations used in the proof .",
    "define four sub matrices of the cross - talk matrix @xmath444 in ( [ eq : faig ] ) as @xmath445\\ ] ] where @xmath446_{m=1, ... ,m , l=1, ... ,l}$ ] and @xmath447_{m=1, ...",
    ",m , l=1, ... ,l}$ ] are the pareto optimal transmit and receive vectors .",
    "let @xmath448 and @xmath449 respectively be the sub matrices at the upper left and lower right corner of @xmath450 in ( [ eq : dg ] ) , where @xmath114 is set as the sinr values achieved by @xmath451 , i.e. , @xmath452 .",
    "define @xmath453 for @xmath454 , let @xmath455 be the @xmath456 row of @xmath457 .",
    "then we formulate another optimization problem in ( [ eq : minpowl ] ) and show that the dual variables satisfying the kkt conditions of problem ( [ eq : minpowl ] ) is also the optimal dual variables of problem ( [ eq : minpowl ] ) .",
    "suppose for other links , the transmit and receive vectors are fixed as @xmath458 and @xmath459 respectively . in problem ( [ eq : minpowl ] )",
    ", the power allocation for other links is also fixed as @xmath460^{t}$ ] .",
    "now consider the following sum power minimization problem where the power allocation for other links is not fixed .",
    "@xmath461 where @xmath462 is the interference - plus - noise covariance matrix of link 1 .",
    "note that the constraints in ( [ eq : infcon ] ) imply the individual rate constraints : @xmath463 , where@xmath464 is the sinr for the @xmath94 stream of link @xmath28 achieved by @xmath441 , @xmath465 , and @xmath443 .",
    "this is because from the definition of @xmath466 , the constraint @xmath467 is equivalent to @xmath468 .",
    "it can be proved by contradiction that the pareto optimal input @xmath469 and @xmath470 is an optimal solution of ( [ eq : minpowl ] ) .",
    "the lagrangian of problem ( [ eq : minpowl ] ) is given by@xmath471    where the dual variables @xmath472 and @xmath473^{t}\\in\\mathbb{r}_{+}^{\\left(l-1\\right)m\\times1}$ ] are associated with the rate constraint and the constraints in ( [ eq : infcon ] ) respectively ; @xmath474 is defined in ( [ eq : lag_minp ] ) ; @xmath160 is the matrix dual variables associated with the positive semidefiniteness constraint on @xmath441 . because this problem may not be convex    , later",
    ", we will prove the following lemma which states that there exist dual variables satisfying the kkt conditions of problem ( [ eq : minpowl ] ) .",
    "[ lem : nesaykkt]the kkt conditions are necessary for @xmath475 to be optimal for problem ( [ eq : minpowl ] ) , i.e. , there exist dual variables @xmath476_{k\\ne1}\\in\\mathbb{r}_{+}^{\\left(l-1\\right)m\\times1},\\tilde{\\nu}_{1}\\geq0 $ ] and @xmath477 such that@xmath478    note that @xmath479 .",
    "then ( [ eq : psd1 ] ) can be expressed as@xmath480 because ( [ eq : psdv1 ] ) is also the same as the equation that the derivative of lagrangian of the problem ( [ eq : minpowl ] ) equals to zero , and @xmath469 is the optimal solution of problem ( [ eq : minpowl ] ) , @xmath481 also satisfy the kkt conditions of problem ( [ eq : minpowl ] ) . since problem ( [ eq : minpowl ] ) is convex , @xmath482 are the optimal dual variables of problem ( [ eq : minpowl ] ) .",
    "we show below that @xmath483 and @xmath484 in lemma [ lem : nesaykkt ] is uniquely given by ( [ eq : optidual ] ) and ( [ eq : optidual2 ] ) . combining this fact and lemma [ lem : nesaykkt ]",
    ", we conclude that @xmath483 and @xmath484 given by ( [ eq : optidual ] ) and ( [ eq : optidual2 ] ) are the optimal dual variables of problem ( [ eq : minpowl ] ) .",
    "this will complete the proof for theorem [ thm : optdual ] .",
    "it is difficult to directly solve @xmath483 and @xmath484 from ( [ eq : psd1 ] ) and ( [ eq : psd2 ] ) . to simplify the problem , without loss of generality , we restrict @xmath441 to be @xmath485 in the lagrangian . for convenience ,",
    "define @xmath486 where @xmath487 is the sinr of the @xmath94 stream of link @xmath488 achieved by @xmath489 as in ( [ eq : sinr1 g ] ) .",
    "note that @xmath490 , and * @xmath491 * because @xmath492 and @xmath493 is positive semidefinite .",
    "then the lagrangian ( [ eq : lag - sigma1-p1 ] )    can be rewritten as a function of @xmath494 and @xmath495^{t}$ ] as follow.@xmath496 note that ( [ eq : psd1 ] ) and ( [ eq : psd2 ] ) imply@xmath497^{t}\\right)\\right|_{\\mathbf{p}_{1}=\\tilde{\\mathbf{p}}_{1 } } & = & \\mathbf{0},\\label{eq : tidu0p}\\\\ \\nabla_{\\mathbf{p}_{-1}}\\bar{l}\\left.\\left(\\tilde{\\mathbf{\\lambda}},\\tilde{\\nu}_{1},[\\tilde{\\mathbf{p}}_{1}^{t},\\mathbf{p}_{-1}^{t}]^{t}\\right)\\right|_{\\mathbf{p}_{-1}=\\tilde{\\mathbf{p}}_{-1 } } & = & \\mathbf{0}.\\label{eq : tidu0p1}\\end{aligned}\\ ] ] as will be shown below , the solution of the above equations is uniquely given by ( [ eq : optidual ] ) and ( [ eq : optidual2 ] ) .",
    "therefore , this unique solution must also be the solution of the more complex equations in ( [ eq : psd1 ] ) and ( [ eq : psd2 ] ) .",
    "for convenience , define @xmath498 $ ] and @xmath499 where @xmath500 .",
    "it can be derived from ( [ eq : defr1p ] ) and @xmath501 that@xmath502 note that @xmath503 and recall the definitions of the sub matrices of @xmath504 and @xmath505",
    ". then equation ( [ eq : tidu0p ] ) and ( [ eq : tidu0p1 ] ) can be expressed as@xmath506 respectively . define @xmath507^{t}$ ] . then ( [ eq : tdjm1 ] ) and ( [ eq : tdjm2 ] ) together form the following linear equations@xmath508 since @xmath509 is invertible @xcite , @xmath510 is uniquely given by @xmath511 which means @xmath512 is uniquely given by ( [ eq : optidual ] ) and ( [ eq : optidual2 ] ) .",
    "the rest is to prove lemma [ lem : nesaykkt ] .",
    "first , we give some notations and definitions .",
    "let @xmath513 be the column vector obtained by stacking the columns of the matrix @xmath514 on top of each other .",
    "define a convex set of @xmath515-dimensional complex vectors @xmath516^{t}:\\mathbf{\\sigma}_{1}\\succeq0,\\mathbf{p}_{-1}\\geq0\\right\\ } .\\label{eq : cvxherset}\\ ] ] we also define the _ complex normal cone _ of a convex set as a natural generalization of the real one defined in ( * ? ? ?",
    "[ def : cnc]denote @xmath517 a convex set of @xmath518-dimensional complex vectors . for @xmath519,@xmath520\\leq0,\\forall\\mathbf{\\bar{x}}\\in\\mathcal{x}\\right\\ } , \\end{aligned}\\ ] ]",
    "is called the _ complex normal cone _ of @xmath517 at @xmath521",
    ".    then problem ( [ eq : minpowl ] ) can be rewritten as an optimization problem over the convex set @xmath517 ,    where the cost function and constraint functions are real functions of a complex vector @xmath519 and an optimal solution is given by @xmath522^{t}$ ] .",
    "the proof is based on the enhanced fritz john necessary conditions in ( * ? ? ?",
    "5.2 ) , where they are expressed in real number .",
    "because a real function of a complex vector @xmath521 is equivalent to a real function of a real vector @xmath523^{t}$ ] , for convenience , we will later rewrite the enhanced fritz john necessary conditions in ( * ? ? ?",
    "5.2 ) in complex form using the definition of the complex gradient of a real function in section [ sec : system model ] .",
    "define a function related to the lagrangian function in ( [ eq : lag - sigma1-p1 ] ) @xmath524 where @xmath525^{t}$ ] ; and @xmath526 . because the cost function and constraint functions in problem ( [ eq : minpowl ] ) are smooth over @xmath519 and @xmath517 is a nonempty closed set , the optimal solution @xmath527 must satisfy the enhanced fritz john necessary conditions ( * ? ? ?",
    "5.2 ) : there exist @xmath528 such that@xmath529 where @xmath530 , and @xmath531 is the complex normal cone of @xmath517 at @xmath527 .",
    "it can be shown that @xmath532 is real by the definitions of @xmath533 and @xmath517 . then by definition [ def : cnc ] , the condition ( [ eq : jcond1 ] ) can be expressed as @xmath534    we first show that if @xmath535 , the above enhanced fritz john conditions are equivalent to the kkt conditions of problem ( [ eq : minpowl ] ) . then we show that @xmath536 is impossible .",
    "this concludes that @xmath475 must satisfy the kkt conditions in ( [ eq : psd1 ] ) and ( [ eq : psd2 ] ) . for convenience ,",
    "define @xmath537 then @xmath538^{t}$ ] . for @xmath539^{t}\\in\\mathcal{x}$ ] , where @xmath540 can be any positive semidefinite matrix , by ( [ eq : jcond1a ] ) , we have@xmath541 in addition to that @xmath542 is hermitian , it implies that @xmath542 is a positive semidefinite matrix . for @xmath543^{t}$ ] , by ( [ eq : jcond1a ] ) , we have @xmath544 since both @xmath542 and @xmath545 are positive semidefinite , we must have @xmath546 for @xmath547^{t}$ ] , ( [ eq : jcond1a ] ) becomes @xmath548 since @xmath549 and @xmath465 can be any nonnegative vector , we must have @xmath550 if @xmath535 , we can make @xmath551 , @xmath552 .",
    "then , the kkt conditions in lemma [ lem : nesaykkt ] are satisfied by observing @xmath553    the rest is to prove that @xmath536 is impossible by contradiction .",
    "suppose @xmath536 .",
    "define a function @xmath554 the it follows from ( [ eq : deftiduj ] ) and ( [ eq : vecjcondpre ] ) that @xmath555 note that * @xmath556 * because @xmath557 .",
    "if we restrict @xmath441 to be @xmath558 , then @xmath490 and @xmath559 can be rewritten as a function of @xmath560 @xmath561 then ( [ eq : vecjcond ] ) and ( [ eq : vecjcond1 ] ) imply@xmath562 let @xmath563 $ ] , where @xmath564 is given by @xmath565 define @xmath566^{t}$ ] . then following similar steps as those solving ( [ eq : tidu0p ] ) and ( [ eq : tidu0p1 ] ) , it can be shown that ( [ eq : tdjeq1 ] ) and ( [ eq : tdjeq2 ] ) form together the following linear equations@xmath567 because @xmath509 is invertible @xcite , @xmath568 must hold , which implies @xmath569 .",
    "this contradicts with the condition ( [ eq : jcond2 ] ) that @xmath528 can not be all zeros .",
    "therefore , we must have @xmath535 .",
    "it is a consequence of the sinr duality applied to a single - user channel @xmath570 .",
    "decompose @xmath136 and @xmath193 to beams as @xmath571 , where @xmath572 is the equivalent transmit power and @xmath573 is the equivalent transmit vector ; and @xmath574 , where @xmath575 and @xmath576 .",
    "according to the covariance transformation , @xmath577 , @xmath194 , @xmath88 and @xmath195 achieves the same set of sinrs in the forward and reverse links respectively .",
    "correspondingly , @xmath578 , @xmath579 , @xmath580 and @xmath581 achieves the same set of sinrs in the single - user channel @xmath137 and @xmath192 respectively .",
    "apply theorem 1 of @xcite to this single - user network , we obtain @xmath582 , i.e. , @xmath583 .",
    "the proof contains three parts .",
    "the uniqueness of the covariance transformation is shown by the idea that the covariance transformation for a network can be equivalently viewed as the covariance transformations for parallel single - user channels , where the capacity achieving input covariance matrix for each single - user channel is unique .",
    "the other two parts , the matrix equations ( [ eq : mtformtf ] ) and ( [ eq : sigmhdirect ] ) , are proved by utilizing the polite water - filling structure .    first we prove the uniqueness of the covariance transformation by showing that different decompositions of @xmath60 produce the same @xmath123 through the covariance transformation .",
    "we will use the notations as in the proof of lemma [ lem : trq ] .",
    "suppose @xmath60 is transformed to @xmath123 using the decomposition @xmath125 with @xmath194 as the corresponding mmse - sic receive vectors and @xmath195 as the transmit powers in the reverse links .",
    "the corresponding equivalent input covariance matrices are @xmath571 and @xmath574 . for a new decomposition @xmath584",
    ", we can change from the old decomposition to the new decomposition one link at a time . without loss of generality ,",
    "let @xmath1 be the first link to be changed and prove @xmath123 remains the same . in this case , the transmission schemes of all other links are still @xmath585 , and the corresponding mmse - sic receive vectors are still @xmath586 because the interference at link @xmath587 does not depend on the decomposition of @xmath3 .",
    "furthermore , we artificially fix the transmit powers of all other reverse links as @xmath588",
    ". then both @xmath6 and @xmath406 are not changed .",
    "find @xmath589 by calculating the mmse - sic receive vectors @xmath590 and the unique @xmath591 such that the sinr of the @xmath92 stream of the @xmath55 forward and reverse link are the same , @xmath592 . since @xmath136 is a water - filling solution over the forward equivalent channel @xmath137 and",
    "thus achieves the capacity of @xmath137 @xcite , the corresponding @xmath593 achieves the capacity of the equivalent reverse channel @xmath192 with power @xmath594 by lemma [ lem : trq ] applied to a single - user network of link @xmath1 .",
    "therefore , @xmath595 because @xmath193 also achieves the capacity of the @xmath192 with the same power @xmath596 and the capacity achieving covariance matrix is unique @xcite .",
    "it follows that @xmath597 , which implies the interference from reverse link @xmath1 to other reverse links does not change .",
    "then , @xmath598 and @xmath599 achieves the same sinrs as the forward links and thus @xmath600 is the result of the covariance transformation and is invariant with the decomposition of @xmath3 .",
    "second , we prove ( [ eq : mtformtf ] ) . in the rest of the proof , we will only use the terms corresponding to link @xmath1 .",
    "the subscript @xmath1 will be omitted for simplicity .",
    "we will use the notations defined in theorem [ thm : wfst ] . noting that @xmath601 , @xmath602 , @xmath603 , @xmath604 and @xmath605 , we have @xmath606 where the last equation follows from ( [ eq : wffar ] ) and ( [ eq : wfrev ] ) in theorem [ thm : wfst ] .    finally , we prove ( [ eq : sigmhdirect ] ) .",
    "expand @xmath607 and @xmath608 to full unitary matrices @xmath609\\in\\mathbb{c}^{l_{r}\\times l_{r}}$ ] and @xmath610\\in\\mathbb{c}^{l_{t}\\times l_{t}}$ ] .",
    "we also zero pad @xmath611 and @xmath612 to @xmath613 and @xmath614 .",
    "then we have    @xmath615    where the equation ( [ eq : q - water - filling ] ) follows from @xmath616 and the equation ( [ eq : omghsim ] ) follows from @xmath617 and @xmath618 .",
    "the weighted sum - rate function for a two - user z channel can be expressed as@xmath619 because the sum of concave functions is still concave , and the first and third terms in ( [ eq : zwsrf ] ) are logdet functions and thus are concave , we only need to show that the second term @xmath620 is a concave function .",
    "it can be derived that @xcite@xmath621+\\textrm{tr}\\left(\\mathbf{b}\\mathbf{y}_{2}\\mathbf{b}\\mathbf{y}_{2}\\right),\\end{aligned}\\ ] ] where @xmath622 and @xmath623 are positive definite matrices . if @xmath241 , it can be proved that @xmath624 .",
    "then @xmath625 which implies that @xmath626 and @xmath627 is a concave function .",
    "this completes the proof .      without loss of generality ,",
    "we consider an itree network where the @xmath38 link is not interfered by the first @xmath233 links . because problem ( [ eq : wsrmp ] ) is convex , we only need to show that the conditions in lemma [ lem : kktitree ] are necessary and sufficient to satisfy the kkt conditions of problem ( [ eq : wsrmp ] ) given in ( [ eq : kktwsr-1 ] ) .",
    "the sufficient part is proved in theorem [ thm : algp2kkt ] for general b - mac networks .",
    "we only need to prove the necessary part , i.e. , if @xmath312 satisfy the kkt conditions with the optimal dual variable @xmath628 , it must satisfy the conditions in lemma [ lem : kktitree ] . due to the interference structure of itree networks , we have @xmath629 for @xmath630 , and thus the condition @xmath631 can be solved one by one from @xmath234 to @xmath632 . for @xmath234 , @xmath631 can be expressed as@xmath633 where @xmath634 . because equation ( [ eq : keykkt1 ] ) is also the kkt condition of the single - user polite water - filling problem ,",
    "the solution @xmath635 is unique and must satisfy the polite water - filling structure with water - filling level @xmath636 as in lemma [ lem : kktitree ] . by theorem [ thm : at - the - boundary ] , we have @xmath637 then for @xmath638 , @xmath631 can be expressed as@xmath639    where @xmath640 similarly , the solution @xmath641 must satisfy the polite water - filling structure with water - filling level @xmath642 as in lemma [ lem : kktitree ] . following similar proof as above , it can be shown that for @xmath643 , @xmath313 must satisfy the conditions in lemma [ lem : kktitree ] .",
    "this completes the proof .",
    "the authors would like to thank ashutosh sabharwal for encouragement and helpful discussions , and giuseppe caire for discussions on the state - of - the - art algorithms for general linear constraints and detailed comments on the paper .",
    "m.  maddah - ali , a.  motahari , and a.  khandani , `` communication over mimo x channels : interference alignment , decomposition , and performance analysis , '' _ ieee transactions on information theory _ , vol .  54 , no .  8 , pp . 34573470 , aug .",
    "2008 .",
    "n.  jindal , w.  rhee , s.  vishwanath , s.  jafar , and a.  goldsmith , `` sum power iterative water - filling for multi - antenna gaussian broadcast channels , '' _ ieee trans .",
    "inform . theory _",
    "51 , no .  4 , pp .",
    "15701580 , april 2005 .",
    "e.  telatar and d.  tse , `` bounds on the capacity region of a class of interference channels , '' _ in proc .",
    "ieee international symposium on information theory 2007 _ , vol .",
    "2871 - 2874 , nice , france , jun . 2007 .",
    "x.  shang , g.  kramer , and b.  chen , `` a new outer bound and the noisy - interference sum - rate capacity for gaussian interference channels , '' _ submitted to ieee trans .",
    "info . theory _ , 2007 .",
    "[ online ] .",
    "available : http://arxiv.org/abs/0712.1987      v.  s. annapureddy and v.  v. veeravalli , `` gaussian interference networks : sum capacity inthe low interference regime and new outerbounds on the capacity region , '' _ ieee trans .",
    "6 , pp . 30323050 , june 2009 .",
    "b.  bandemer , a.  sezgin , and a.  paulraj , `` on the noisy interference regime of the miso gaussian interference channel , '' _ in proc .",
    "42nd asilomar conference on systems , signals and computers , pacific grove , ca _ , pp . 10981102 , 2008 .",
    "v.  s. annapureddy , v.  v. veeravalli , and s.  vishwanath , `` on the sum capacity of mimo interference channel in the low interference regime , '' _ in proc .",
    "42nd asilomar conference on systems , signals and computers , pacific grove , ca _ , nov 2008 .",
    "d.  n.  c. tse and s.  v. hanly , `` multiaccess fading channels ",
    "part i : polymatroid structure , optimal resource allocation and throughput capacities , '' _ ieee trans .",
    "info . theory _",
    "44 , no .  7 , pp . 27962815 , nov .",
    "h.  viswanathan , s.  venkatesan , and h.  huang , `` downlink capacity evaluation of cellular networks with known - interference cancellation , '' _ ieee j. select .",
    "areas commun .",
    "_ , vol .  21 , no .  5 , pp .",
    "802811 , june 2003 .",
    "s.  t. chung , s.  j. kim , j.  lee , and j.  cioffi , `` a game - theoretic approach to power allocation in frequency - selective gaussian interference channels , '' _ in proceedings 2003 ieee international symposium on information theory , _ , pp .",
    "316  316 , june-4 july jun . 2003 .",
    "k.  shum , k .- k .",
    "leung , and c.  w. sung , `` convergence of iterative waterfilling algorithm for gaussian interference channels , '' _ ieee journal on selected areas in communications _ , vol .",
    "25 , no .  6 , pp .",
    "1091 1100 , august 2007 .",
    "g.  scutari , d.  palomar , and s.  barbarossa , `` asynchronous iterative water - filling for gaussian frequency - selective interference channels , '' _ ieee transactions on information theory _ , vol .",
    "54 , no .  7 , pp .",
    "2868 2878 , july 2008 .",
    "g.  arslan , m.  demirkol , and y.  song , `` equilibrium efficiency improvement in mimo interference systems : a decentralized stream control approach , '' _ ieee transactions on wireless communications _ , vol .  6 , no .  8 , pp . 29842993 , august 2007 .",
    "g.  scutari , d.  palomar , and s.  barbarossa , `` competitive design of multiuser mimo systems based on game theory : a unified view , '' _ ieee journal on selected areas in communications _",
    "26 , no .",
    "10891103 , september 2008 .",
    "j.  huang , r.  cendrillon , m.  chiang , and m.  moonen , `` autonomous spectrum balancing ( asb ) for frequency selective interference channels , '' _ in proceedings 2006 ieee international symposium on information theory _",
    "610 614 , july 2006 .",
    "a.  liu , a.  sabharwal , y.  liu , h.  xiang , and w.  luo , `` distributed mimo network optimization based on duality and local message passing , '' in _ proc .",
    "allerton conf . on commun . , control , and computing _ , sep .",
    "2009 , pp .",
    "a.  liu , y.  liu , h.  xiang , and w.  luo , `` mimo b - mac network optimization under fairness or rate constraints by polite water - filling and duality , '' _ ieee trans .",
    "signal processing _ , to be submitted , apr .",
    "2010 .",
    "chang , l.  tassiulas , and f.  rashid - farrokhi , `` joint transmitter receiver diversity for efficient space division multiaccess , '' _ ieee transactions on wireless communications _",
    ", vol .  1 , no .  1 , pp .",
    "1627 , jan 2002 .",
    "m.  schubert and h.  boche , `` solution of the multiuser downlink beamforming problem with individual sinr constraints , '' _ ieee transactions on vehicular technology _ , vol .",
    "53 , no .  1 ,",
    "1828 , jan . 2004 .",
    "h.  weingarten , y.  steinberg , and s.  s. ( shitz ) , `` the capacity region of the gaussian mimo broadcast channel , '' in _ ieee international symposium on information theory ( isit 04 ) _ , chicago , il , usa , june 2004 ,",
    "p. 174 .",
    "x.  shang , b.  chen , and h.  v. poor , `` multi - user miso interference channels with single - user detection : optimality of beamforming and the achievable rate region , '' _ submitted to ieee trans .",
    "_ , july 2009 .",
    "a.  avestimehr , s.  diggavi , and d.  tse , `` a deterministic model for wreless relay networks an its capacity , '' _ 2007 ieee information theory workshop on information theory for wireless networks _ , pp . 16 , 2007 .",
    "m.  varanasi and t.  guess , `` optimum decision feedback multiuser equalization with successive decoding achieves the total capacity of the gaussian multiple - access channel , '' in _ proc .",
    "thirty - first asilomar conference on signals , systems and computers _ , vol .  2 , 1997 ,",
    ". 14051409 ."
  ],
  "abstract_text": [
    "<S> the general mimo interference network is considered and is named the b - mac network , for it is a combination of multiple interfering broadcast channels and multiaccess channels . </S>",
    "<S> included as special cases are interference channels , x channels , x networks , and most practical wireless networks . </S>",
    "<S> the optimization of this important class of networks has been hindered by that beyond the single antenna multiaccess channels , little is known about the optimal input structure , which is found here to be the polite water - filling , satisfied by all pareto optimal input . </S>",
    "<S> this network version of water - filling is polite because it optimally balances between reducing interference to others and maximizing a link s own rate , offering a method to decompose a network into multiple equivalent single - user channels and thus , paving the way for designing / improving low - complexity centralized / distributed / game - theoretic algorithms for most network optimization problems . </S>",
    "<S> deeply connected is the rate duality extended to the forward and reverse links of the b - mac networks . as a demonstration , weighted sum - rate maximization algorithms with superior performance and low complexity </S>",
    "<S> are designed for b - mac networks and are analyzed for interference tree ( itree ) networks , a sub - class of the b - mac networks that possesses promising properties for further information theoretic study .    </S>",
    "<S> water - filling , duality , mimo , interference channel , one - hop network , transmitter optimization , network information theory </S>"
  ]
}