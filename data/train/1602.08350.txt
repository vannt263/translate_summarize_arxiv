{
  "article_text": [
    "electrical power grids are the backbone of today s society .",
    "losses during generation and distribution cause major problems , including financial losses to electricity providers and a decrease of stability and reliability .",
    "they can be classified into technical losses and non - technical losses .",
    "technical losses are naturally occurring and mainly include losses to power dissipation in electrical components , such as in generators , transformers and transmission lines due to internal electrical resistance .",
    "they are possible to detect and control given a knowledge of the quantities of loads .",
    "non - technical losses ( ntl ) faced by electricity providers include , but are not limited to , electricity theft by rewiring or manipulating meters .",
    "other types include faulty meters and errors in meter readings and billing .",
    "there are different estimates of the financial losses caused by ntls and they can range up to 40% of the total electricity distributed in countries such as brazil , india , malaysia or lebanon @xcite , @xcite .",
    "they are also of relevance in developed countries , for example estimates of ntls in the us range from usd 1 - 6 billion @xcite .    in order to detect ntls ,",
    "inspections of customers are carried out , based on predictions whether there may be a ntl at a customer .",
    "the inspection results are then used in the learning of algorithms in order to improve predictions . however , carrying out inspections is expensive , as it requires physical presence of technicians .",
    "it is therefore important to make accurate predictions in order to reduce the number of false positives .",
    "detecting ntls is challenging because of the wide range of possible causes of ntls , such as different fraudulent types of customers . from a machine learning perspective",
    ", a key problem is the imbalance of the data , meaning that there are significantly more regular customers than customers with ntls .",
    "we believe that this property has not adequately been addressed and reported in the literature .",
    "we therefore assess various prediction models for different proportions of ntls in the data and discuss representative performance measures for a reliable assessment of them .",
    "we believe that an accurate discussion of this topic is necessary for future work on ntl detection in a smart meter environment .",
    "the rest of this paper is organized as follows .",
    "section [ chapter : review ] provides a literature review of ntl detection and its challenges .",
    "section [ chapter : ntl ] describes different proposed ntl detection models and the respective data set .",
    "section [ chapter : eval ] presents experimental results and comparison of the models on the data for different ntl proportions in the data .",
    "section [ chapter : end ] summarizes this work and provides an outreach on future work .",
    "ntl detection can be treated as a special case of fraud detection , for which a general survey is provided in @xcite .",
    "it highlights two approaches as key methods to detect fraudulent behavior in credit card fraud , computer intrusion and telecommunications fraud : ( i ) expert systems that represent domain knowledge in order to make decisions typically using hand - crafted rules and ( ii ) data mining or machine learning techniques that employ statistics to learn patterns from sample data in order to make decisions for future unseen data .",
    "both approaches have their justification and neither is generally better or worse than the other one in artificial intelligence @xcite .    one method to detect ntls is to calculate the energy balance @xcite , which requires topological information of the network .",
    "this does not work accurately for those reasons :",
    "( i ) in developing countries , network topology undergoes continuous changes in order to satisfy the rapidly growing demand of electricity , ( ii ) infrastructure may break and lead to wrong energy balance calculations and ( iii ) it requires transformers , feeders and connected meters to be read at the same time .",
    "another approach is to analyze the customer load profile using artificial intelligence methods , such as machine learning or expert systems .",
    "support vector machines ( svm ) are used in @xcite , working on daily average consumption features of the last 24 months for less than 400 highly imbalanced training examples , ignoring the class imbalance in the results reported .",
    "that work is combined with fuzzy logic @xcite or genetic algorithms @xcite , focusing on an optimization of the svm output .",
    "a rule - based expert system system outperforms a svm in @xcite for an unknown amount of customers , focusing on high performance implementations .",
    "fuzzy logic following c - means fuzzy clustering is applied to a data set of 20k customers in @xcite .",
    "furthermore , neural networks using hand - crafted features calculated from the consumption time series plus customer - specific pre - computed attributes are used in @xcite for 1k balanced customers . applying smart half - hour meter readings of three weeks of 6k customers",
    "are fed into a neural network in @xcite .",
    "optimum - path forest are applied to ntl detection in @xcite for 10k customers outperforming different svms and a neural network .",
    "a different method is to estimate ntls by subtracting an estimate of the technical losses from the overall losses @xcite . in many electricity grids it may be challenging to accumulate the entire losses and furthermore , this method does not scale to large numbers of meters .",
    "the class imbalance problem of electricity theft detection has initially been addressed in @xcite .",
    "it applies an ensemble of two smvs , optimum - path forest and c4.5 decision tree learning to 300 on - field inspection test data .",
    "however , the degree of imbalance of the 1.5k training examples is not reported .",
    "furthermore , in the optimization of the classifiers , the true negative rate is ignored , which results in too many costly inspections of non - fraudulent customers .",
    "many of these results are constrained to either just a few test examples or report accuracies on highly imbalanced classes . to date , working on large and long - term data sets and properly measuring the performance of the classifiers on imbalanced data sets has not adequately been studied in the literature . however , ignoring the class imbalance in reported results is also true for many other machine learning applications . in this paper",
    ", we focus on large data sets comprising each of 100k inspection results spanning four years of consumption data and apply different ntl detection methods on it .",
    "we particularly address the class imbalance problem using accurate performance measures .",
    "it must be noted that most ntl detection methods are supervised .",
    "anomaly detection - a superclass of ntl - is generally challenging to learn in a supervised manner for the reasons stated in @xcite : ( i ) anomaly data sets contain a very small number of positive examples and large number of negative examples , resulting in imbalanced classes , ( ii ) it is used for many different kinds of anomalies as it is hard for any algorithm to learn from just a few positive examples what the anomalies might look like and ( iii ) there may be also future anomalies which may look completely different to any of the anomalous examples learned so far .",
    "in contrast , supervised learning works best for ( i ) large numbers of both positive and negative examples , ( ii ) when there are enough positive examples so that the algorithm can get a sense of what positive examples might look like and ( iii ) future positive examples are likely to be similar to the ones in the training set .",
    "the data used in this paper is from an electricity provider in brazil .",
    "it consists of three parts : ( i ) 700k customer data , such as location , type , etc . ,",
    "( ii ) 31 m monthly consumption data from january 2011 to january 2015 such as consumption in kwh , date of meter reading and number of days between meter readings and ( iii ) 400k inspection data such as presence of fraud or irregularity , type of ntl and inspection notes .",
    "most inspections do not find ntls , making the classes highly imbalanced . in order for the models to be applied to other regions or countries ,",
    "they must be assessed on different ntl proportions .",
    "therefore , the data was subsampled using 17 different ntl proportion levels : 0% , 0.1% , 1% , 2% , 3% , 4% , 5% , 10% , 20% , 30% , 40% , 50% , 60% , 70% , 80% , 90% and 100% .",
    "each sample contains 100k inspection results .      in this section ,",
    "the different models for ntl detection of this paper are described .",
    "the first model is a choice technologies product based on boolean logic and is used as a baseline .",
    "it is extended to fuzzy logic in the second model in order to smoothen the decision making process .",
    "the third model is a support vector machine , a state - of - the - art machine learning algorithm .",
    "this model is an expert system , it consists of hand - crafted rules created by the choice technologies expert team which are conjunctions of ( in)equality terms , such as : @xmath0 @xmath1 is a so - called attribute .",
    "possible attributes are change of consumption over the last 3 months , slope of consumption curves , etc .",
    "and @xmath2 is a numeric value . in total ,",
    "42 attributes are used in 14 rules . if at least one rule outcome is true , that customer is considered to potentially cause a ntl .",
    "fuzzy systems @xcite have a long tradition in control applications allowing to implement expert knowledge in a softer decision making process .",
    "they allow to relate to classes of objects , breaking up boundaries , making membership a matter of degree . in this paper ,",
    "the 14 boolean rules were fuzzified and incorporated in a mamdani fuzzy system using the centroid defuzzification method @xcite .",
    "fuzzy rules rely on membership functions .",
    "the number of membership functions for each attribute depends on the ranges of values found in the rules among which 1 attribute has 1 function , 32 attributes have 2 membership functions and 9 attributes have 4 functions . in most cases ,",
    "trapezoid membership functions are used to keep the model simple .",
    "the exact parameters , such as membership function boundaries or the mean of sigmoid membership functions were determined from the distribution of attribute values .",
    "however , these parameters could be optimized using : ( i ) gradient techniques @xcite , ( ii ) genetic algorithms @xcite or ( iii ) neuro - fuzzy systems @xcite . techniques ( i ) and ( ii )",
    "are highly constrained optimization problems due to dependence among parameter values to keep the fuzzy system valid . technique ( i )",
    "was studied further and its results are reported in section  [ chapter : eval ] .      a support vector machine ( svm ) @xcite is a maximum margin classifier , i.e. it creates a maximum separation between classes .",
    "therefore , a svm is less prone to overfitting than other classifiers , such as a neural network @xcite .",
    "support vectors hold up the separating hyperplane . in practice",
    ", they are just a small fraction of the training examples .",
    "the training of a svm can be defined as a lagrangian dual problem having a convex cost function . in that form",
    ", the optimization formulation is written in terms of only the dot product @xmath3 between points in the input space . by default , the separating hyperplane is linear . for complex problems , it is advantageous to map the data set to a higher dimension space , where it is possible to separate them using a linear hyperplane .",
    "a kernel is an efficient function that implicitly computes the dot product in the higher dimensional space .",
    "a popular kernel is the gaussian radial basis function : @xmath4 .",
    "inspired by @xcite , for @xmath5 customers @xmath6 over the last @xmath7 months @xmath8 , a feature matrix @xmath9 is computed , in which element @xmath10 is a daily average kwh consumption feature during that month : @xmath11 where for customer @xmath12 , @xmath13 is the kwh consumption increase between the meter reading to date @xmath14 and the previous one @xmath15 .",
    "@xmath16 is the number of days between both meter readings of customer @xmath12 .",
    "similarly , a binary target vector @xmath17 is created in which element @xmath18 is the most recent inspection result for customer @xmath12 in the respective period of time .",
    "ntls are encoded by 1 if they are detected and 0 if not .",
    "in many classification problems , the classification rate , or accuracy is used as a performance measure .",
    "given the number of true positives ( tp ) , true negatives ( tn ) , false positives ( fp ) and false negatives ( fn ) : @xmath19 .",
    "however , many publications ignore that it is only of minor expressiveness for imbalanced classes . for a ntl detection example , given a data set of 990 negative and 10 positive test examples , a classifier that always predicts negative has an accuracy of @xmath20 .",
    "this example clearly demonstrates that other performance measures must be used for ntl detection .",
    "the recall is a measure of the proportion of the true positives found .",
    "it is also named true positive rate ( tpr ) or sensitivity : @xmath21 .",
    "the specificity is a measure of the proportion of the true negatives classified as negative .",
    "it is also named true negative rate ( tnr ) : @xmath22 .",
    "the false positive rate ( fpr ) is @xmath23 .",
    "a receiver operating characteristic ( roc ) curve plots the tpr against the fnr .",
    "the area under the curve ( auc ) is a performance measure between 0 and 1 , where any binary classifier with an auc @xmath24 performs better than random guessing . while in many applications",
    "multiple thresholds are used to generate points plotted in a roc curve , the auc can also be computed for a single point , when connecting it with straight lines to @xmath25 and @xmath26 as shown in @xcite : @xmath27 .    for ntl detection , the goal is to reduce the fpr to decrease the number of costly inspections , while increasing the tpr to find as many ntl occurrences as possible . in order to assess a ntl prediction model using a single performance measure ,",
    "the auc is the most suitable .      throughout the experiments ,",
    "consumption readings and inspection result data are used .",
    "further data , such as location of customers are not used . in the comparison of the three classifiers ,",
    "the auc performance measure is used for the different levels of ntl proportion mentioned in section  [ chapter : ntl : data ] .",
    "we assessed different values for the number of the most recent meter readings @xmath7 .",
    "only customers with complete time series of the last @xmath7 months before the respective inspection are considered .",
    "the larger @xmath7 , the less data is available .",
    "at least 12 months should be considered in order to represent seasonality effects .",
    "experiments for the last 12 , 18 and 24 months were carried out , for which 12 months have proven to lead to the best results as the other experiments lead to more overfitting . due to lack of space ,",
    "those results are omitted .",
    "the svm is the only classifier that requires training in our experiments .",
    "however , since it is a binary classifier , it could not be trained on ntl proportions of 0% and 100% . for the ntl proportions used for training , 10-folded cross validation",
    "is performed for every ntl proportion , splitting the data into a 60%/20%/20% training / validation / test ratio .",
    "the auc score is used as the validation measure to pick the best classifier fold . throughout the experiments ,",
    "a linear svm is used .",
    "the same experiments were repeated using a gaussian kernel , which proved to overfit for all ntl proportions .",
    "the boolean and fuzzy classifiers were implemented in ` matlab ` , the latter using the fuzzy logic toolbox @xcite .",
    "the svm classifier was implemented in python using ` scikit - learn ` @xcite , which builds on top of ` libsvm ` @xcite .",
    "the regularization parameter and the inverse variance parameter @xmath28 of the gaussian kernel were not optimized explicitly , as ` scikit - learn ` optimizes them automatically . using 10-fold cross - validation to train 10 svms and to select the best one takes about 2 minutes per ntl proportion on a state - of - the - art i5 notebook . using the boolean or fuzzy systems to classify the same amount of data takes about 1 second .",
    "however , both classifiers use pre - computed customer - specific attributes .",
    "computing them takes a couple of hours in a cloud infrastructure .      for different ntl proportions ,",
    "the change of test auc for the boolean and fuzzy systems and the svm can be observed in fig .  [",
    "fig : auc1 ] .",
    "the boolean classifier has an auc @xmath29 for all ntl proportions and therefore performs worse than random guessing .",
    "the same applies for the fuzzy system , except for a ntl proportion of 0.1% .",
    "the svm performs only ( noticeably ) better than random guessing for ntl proportions between 50% and 80% .",
    "given the theory of fuzzy systems and their potential , the parameters of the fuzzy system were optimized using stochastic gradient descent ( sgd ) for each of the 15 binary ntl proportions : 0.1% to 90% . out of the 15 optimized fuzzy systems ,",
    "the one with the greatest auc test score is picked and tested on all ntl proportions .",
    "the fuzzy system trained on 30% and tested on all ntl proportions - fuzzy sgd 30% - significantly outperforms both , the boolean and fuzzy systems , as shown in fig .",
    "[ fig : auc2 ] .",
    "the same methodology as for the optimized fuzzy system is applied to the svm .",
    "svms are trained on all 15 binary ntl proportions and svm 60% , the svm trained on 60% ntl proportion , is selected because of the greatest auc test score . its performance",
    "compared to the boolean and fuzzy sgd 30% are shown in fig .",
    "[ fig : auc2 ] . in summary ,",
    "svm 60% performs in a similar range as fuzzy sgd 30% compared to the boolean system , except for very small ntl proportions @xmath30 .",
    "however , comparing the confusion matrices of both classifiers , they perform very differently as shown in tables  [ table : compared5 ] and [ table : compared20 ] for selected ntl levels of 5% and 20% , respectively .",
    "the optimized fuzzy system has a higher tnr , but lower tpr compared to the optimized svm . in return ,",
    "the svm has a higher tpr , but a lower fnr .",
    "cc|c|c|c| & & + & & tnr & fpr + & & fnr & tpr + & & 0.53 & 0.47 + & & 0.60 & 0.40 + & & 0.87 & 0.13 + & & 0.77 & 0.23 + & & 0.36 & 0.64 + & & 0.26 & 0.74 +    cc|c|c|c| & & + & & tnr & fpr + & & fnr & tpr + & & 0.53 & 0.47 + & & 0.58 & 0.42 + & & 0.87 & 0.13 + & & 0.78 & 0.22 + & & 0.35 & 0.65 + & & 0.25 & 0.75 +      the initial boolean and fuzzy models perform worse than random guessing and are therefore not suitable for real data , as they trigger too many inspections while not many of them will lead to ntl detection .",
    "optimized fuzzy and svm models trained on 30% and 60% ntl proportion , respectively , result in significantly greater auc scores . however , both perform very differently , as the optimized fuzzy system is more conservative in ntl production .",
    "in contrast , the optimized svm is more optimistic , leading also to a higher fpr . in general , neither can be named better than the other one , as picking the appropriate model from these two is subject to business decisions .",
    "however , this work also demonstrates that for real data , ntl classifiers using only the consumption profile are limited .",
    "therefore , it is desirable to use more features like location , inspection notes , etc .",
    "another issue with the real data is the potential bias of inspections so that this sample of customers does not represent the overall population of customers .",
    "we expect a correction of the bias to lead to better predictions , too .",
    "in this work , we have proposed three models for ntl detection for large data sets of 100k customers : boolean , fuzzy and support vector machine .",
    "in contrast to other results reported in the literature , the optimized fuzzy and svm models were assessed for varying ntl proportions on imbalanced real world consumption data .",
    "both have an auc @xmath24 for all ntl proportions @xmath31 and significantly outperform simple boolean or unoptimized fuzzy models .",
    "the improved models are about to be deployed in a choice technologies product .",
    "the contribution methodology is necessary for future smart meter research , in order to report their effectiveness in imbalanced and large real world data sets .",
    "we are planning to evaluate unsupervised methods , in particular deep learning , in order to detect ntl more accurately by finding hidden correlations in the data .",
    "furthermore , we are planning to use other features in our models , such as the location and latent features and to investigate cost - based optimization in order to maximize the total electricity recovered through inspections .",
    "also , we are planning to make our implementations faster and more scalable using apache spark @xcite .",
    "e. dos angelos , o. saavedra , o. cortes and a. de souza ,  detection and identification of abnormalities in customer consumptions in power distribution systems \" , ieee transactions on power delivery , vol .",
    "2436 - 2442 , 2011 .",
    "s. s. s. r. depuru , l. wang , v. devabhaktuni and r. c. green ,  high performance computing for detection of electricity theft \" , international journal of electrical power & energy systems , vol .",
    "47 , issue 1 , pp .",
    "21 - 30 , may 2013 .",
    "v. ford , a. siraj and w. eberle ,  smart grid energy fraud detection using artificial neural networks \" , ieee symposium on computational intelligence applications in smart grid ( ciasg ) , pp . 1 - 6 , 9 - 12 , december 2014 .",
    "j. nagi , k. s. yap , s. k. tiong , s. k. ahmed and a. m. mohammad ,  detection of abnormalities and electricity theft using genetic support vector machines , \" ieee region 10 conference on tencon 2008 , pp . 1 - 6 , november 2008 .    j. nagi , k. s. yap , s. k. tiong , s. k. ahmed and f. nagi ,  improving svm - based nontechnical loss detection in power utility using the fuzzy inference system \" , ieee transactions on power delivery , vol .",
    "26 , issue 2 , pp .",
    "1284 - 1285 , april 2011 .",
    "j. nagi , k. s. yap , s. k. tiong , s. k. ahmed and m. mohamad ,  nontechnical loss detection for metered customers in power utility using support vector machines \" , ieee transactions on power delivery , vol .",
    "25 , issue 2 , pp .",
    "1162 - 1171 , apr . 2010 .        c. muniz , k. figueiredo , m. m. b. r. vellasco , g. chavez and m. a. c. pacheco ,  irregularity detection on low tension electric installations by neural network ensembles \" , ieee - inns - enns international joint conference on neural networks , june 2009 .",
    "c. c. o. ramos , a. n. souza , j. p. papa and a. x. falcao ,  fast non - technical losses identification through optimum - path forest \" , 15th international conference on intelligent system applications to power systems ( isap ) , november 2009 .",
    "s. sahoo , d. nikovski , t. muso and k. tsuru ,  electricity theft detection using smart meter data , \" ieee power & energy society innovative smart grid technologies conference ( isgt ) , pp . 1 - 5 , february 2015 .    lala septem riza , christoph bergmeir , francisco herrera and jose manuel benitez ,  frbs : fuzzy rule - based systems for classification and regression in r \" , journal of statistical software , vol .",
    "65 , issue 6 , may 2015 .",
    "y. tang , y .- q .",
    "zhang , n. v. chawla and s. krasser ,  svms modeling for highly imbalanced classification \" , ieee transactions on systems , man , and cybernetics , part b : cybernetics , vol .",
    "39 , issue 1 , pp .",
    "281 - 288 , feb . 2009 .",
    "m. zaharia , m. chowdhury , m. j. franklin , s. shenker and i. stoica ,  spark : cluster computing with working sets \" , hotcloud10 proceedings of the 2nd usenix conference on hot topics in cloud computing , 2010 ."
  ],
  "abstract_text": [
    "<S> non - technical losses ( ntl ) such as electricity theft cause significant harm to our economies , as in some countries they may range up to 40% of the total electricity distributed . </S>",
    "<S> detecting ntls requires costly on - site inspections . </S>",
    "<S> accurate prediction of ntls for customers using machine learning is therefore crucial . to date </S>",
    "<S> , related research largely ignore that the two classes of regular and non - regular customers are highly imbalanced , that ntl proportions may change and mostly consider small data sets , often not allowing to deploy the results in production . in this paper </S>",
    "<S> , we present a comprehensive approach to assess three ntl detection models for different ntl proportions in large real world data sets of 100ks of customers : boolean rules , fuzzy logic and support vector machine . </S>",
    "<S> this work has resulted in appreciable results that are about to be deployed in a leading industry solution . </S>",
    "<S> we believe that the considerations and observations made in this contribution are necessary for future smart meter research in order to report their effectiveness on imbalanced and large real world data sets .    </S>",
    "<S> electricity theft detection , fuzzy logic , imbalanced classification , non - technical losses , support vector machine </S>"
  ]
}