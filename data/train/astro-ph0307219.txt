{
  "article_text": [
    "markov - chain monte carlo ( mcmc ) sampling is a universal technique used to explore high - dimensional density fields and has several advantages over more conventional grid - based approaches ( see , for example , gilks , richardson & speigelhalter 1995 ) . in an astrophysical context , the mcmc approach was first applied to the determination of cosmological parameters from estimates of the total intensity cosmic microwave background ( cmb ) power spectrum by christensen et al .",
    "( 2001 ) and knox , christensen & skordis ( 2001 ) .",
    "more recently lewis & bridle ( 2002 ) released the publicly - available cosmo - mc software package for this purpose .",
    "mcmc sampling methods have also recently been applied to the detection and characterisation of sunyaev - zeldovich clusters in maps of primordial cmb anisotropies ( hobson & mclachlan 2002 ) .    in an mcmc algorithm , a markov chain is constructed whose equilibrium distribution is the density field ( or posterior ) of interest @xmath0 .",
    "thus , after propagating the markov chain for a given _ burn - in _ period , one obtains ( correlated ) samples from @xmath0 , provided the markov chain has converged .",
    "a markov chain is characterised by the fact that the state @xmath1 is drawn from a distribution ( or _ transition kernel _ ) that depends only on the previous state of the chain @xmath2 , and not on any earlier state . in its simplest form",
    "an mcmc sampler can be constructed using the metropolis algorithm as follows . at each step @xmath3 in the chain , the next state @xmath1 is chosen by first sampling a _ candidate _",
    "point @xmath4 from some symmetric _ proposal distribution _",
    "@xmath5 , which may in general depend on the current state of the chain @xmath2 .",
    "the candidate point @xmath4 is then accepted with probability @xmath6 if the candidate point is accepted , the next state becomes @xmath7 , but if the candidate is rejected , the chain does not move , so @xmath8 . in the limit of infinite number of chain steps ,",
    "the density of the samples is proportional to the density @xmath0 , provided the proposal function : ( i ) satisfies detailed balance , which requires that the probability of proposing @xmath4 from @xmath9 is the same as probability to proposing @xmath9 from @xmath4 , and ( ii ) is such that every point in the parameter space has a finite probability of being proposed .    given an infinite number of steps any sampler satisfying the above conditions will eventually reach a converged state in which the samples are representative of target density @xmath0 . in practice",
    ", however , the number of steps required to achieve convergence and fully explore the target density can vary dramatically depending on the form of the proposal distribution .",
    "a good proposal function produces candidate points that have a high probability of being accepted and ensures good mobility of the chain around the target density .    a common choice for the proposal function , used for example by knox et al .",
    "( 2001 ) , is a multivariate gaussian centred on the current chain position , with fixed widths @xmath10 in each parameter direction .",
    "there are , however , some problems associated with using this proposal function alone as the single mcmc ` engine ' .",
    "firstly , the proposal widths must be chosen with considerable care and tailored to the application in hand .",
    "if the proposal widths are set too large , the acceptance rate will be very low , so that the chain remains stuck at a single point for a considerable number of steps , sometimes indefinitely in practical terms .",
    "on the other hand , if the proposal widths are too narrow , the acceptance rate will be high , but the chain has a limited mobility because it effectively executes a random walk and thus diffuses only very slowly around the target density . in particular",
    ", this can lead to severely underestimated confidence limits on parameters and spurious peaks in the sample distribution associated with the initial chain position .",
    "a second problem with the standard multivariate gaussian proposal distribution is that , in high - dimensional problems , the degeneracy directions often take the form of small ` tunnels ' in the target density , which are unlikely to be explored by chance .",
    "even with appropriate proposal widths the chain must ` zig - zag ' through such structures and therefore these degeneracy directions are likely to be undersampled .    in an attempt to speed up the sampling process",
    ", the cosmo - mc package ( lewis & bridle 2002 ) employs an number of devices that improve upon the simple multivariate gaussian proposal function ; these are explained in section  [ sec : cosmomc ] below .",
    "this widely - used package has proved very successful in analysing cmb power spectrum measurements from ground - based and balloon - bourne experiments",
    ". nevertheless , as we show in section  [ sec : application ] , with the inclusion of wmap data ( bennett et al .",
    "2003 ) , which is cosmic variance limited out to @xmath11 , the cosmo - mc sampler still suffers from a number of the disadvantages listed above",
    ". in particular , it produces marginalised probability distributions for some cosmological parameters that yield underestimates of confidence limits by up to a factor of two .",
    "this undersampling of the target density is yet more pronounced for cosmic variance limited cmb data out to @xmath12 , as is expected from the planck mission .    in this paper",
    ", we therefore present a new sampler module ( called cog ) that is trivially substituted for the existing sampler in the cosmo - mc software .",
    "this sampler employs a number of strategies to avoid the difficulties encountered in the use of the standard multivariate gaussian proposal function and the native cosmo - mc sampler .",
    "these strategies are explained in detail in section  [ sec : cog ] , but the single most important advantage of the cog sampler is its use of the very well - known cosmological parameter degeneracies for cmb data ( efstathiou & bond 1999 ) , hence ensuring good mobility around the target density . in section  [ sec :",
    "application ] , we test the cog sampler on the current cmb data set and a simulated data set of the quality expected from the planck mission .",
    "in addition to producing reliable marginalised distributions , the cog sampler also requires far fewer evaluations of theoretical @xmath13 spectra to explore the target density fully , and therefore provides speed up by a factor @xmath14 over the standard cosmo - mc software when analysing the current cmb data set . in the analysis of the planck - like data set ,",
    "this speed increase rises to a factor of @xmath15 .",
    "our conclusions are presented in section  [ sec : conclusions ] .",
    "the cosmo - mc sampler uses camb ( lewis , challinor & lasenby 2000 ) as its underlying theoretical cmb power spectrum generator . the proposal density employed in this single - chain sampler",
    "is based on a multivariate gaussian , but is tailored specifically to exploit the difference between ` fast ' and ` slow ' parameters in camb , in order to increase the speed with which the target density may be sampled .    at any given point @xmath2 in the chain ,",
    "it is much quicker to calculate the theoretical @xmath13 spectrum ( and hence the value of the posterior ) at the next candidate point @xmath4 if some of the parameter values are the same for both points . in particular , since the perturbation evolution is assumed linear , once the transfer function for each wavenumber has been computed , it is fast to calculate the @xmath13 spectrum corresponding to changes in any parameters governing the initial primoridal power spectra of scalar and tensor perturbations ; these are thus termed ` fast ' parameters . on the other hand ,",
    "if one changes parameters governing the perturbation evolution , the resulting @xmath13 spectrum will be much slower to compute since it requires a detailed recalculation of the linear physics ; these are thus termed ` slow ' parameters .    in detail , the basic sampler works as follows .",
    "first it performs an initial sampling of the target density with a proposal density based on a multivariate gaussian distribution determined by a set of user defined proposal widths @xmath10 , one for each parameter .",
    "it begins by placing the parameters in random order in a ` queue ' .",
    "if the first parameter in the queue is fast , all the fast parameters are updated to obtain the next candidate point @xmath4 .",
    "if the first parameter in the queue is slow , both this parameter and the next 02 parameters in the queue are updated ( the number of additionally updated parameters being drawn randomly from a uniform distribution ) . in either case , the corresponding candidate point is then either accepted or rejected in the usual manner . in subsequent iterations ,",
    "the above process is repeated , each time starting from the next parameter in the queue .",
    "once the entire queue has been looped over twice , the parameter order is again randomly reshuffled , and the process repeated . for each parameter that is updated , the new parameter value is drawn from a gaussian distribution centred at the present parameter value and having width @xmath16 , where @xmath17 is the total number of parameters changed .",
    "the extra @xmath18 factor ensures that proposals in which many parameters change still have a reasonable acceptance rate .",
    "after the initial sampling stage , one then has the option of performing a complete resampling of the the target distribution using information gained from the inital stage . in particular , the empirical covariance matrix of the initial set of samples is calculated , which is then diagonalised to obtain a set of principal directions which are taken as the new ` parameters ' . these new parameters",
    "are then placed in random order in a queue as above , and at each proposal between 1 and 3 of them are updated ( the precise number of updated parameters again being chosen at random ) .",
    "each time the queue has been looped through twice , it is again randomly reshuffled .",
    "we note that a covariance matrix for the standard 6-parameter inflationary flat @xmath19cdm model is provided in advance in the cosmo - mc package .",
    "thus , in this case , one can dispense with the initial sampling stage altogether .    in spite of the increased sampling speed achieved by the above devices",
    ", this basic sampler still suffers from the difficulties discussed in section  [ sec : intro ] most notably , the user - supplied proposal widths @xmath10 must still be chosen with considerable care to avoid acceptance rates that are either too low ( so the chain becomes stuck ) or too high ( so the chain mobility is limited , leading to underestimated confidence limits ) .",
    "also , the use of a multivariate gaussian proposal function can lead to undersampling along narrow degeneracy directions .",
    "the cog sampler is a replacement mcmc engine for the cosmo - mc software .",
    "it may be downloaded from ` http://www.mrao.cam.ac.uk/\\simanze/cog ` and included easily into the cosmo - mc package .",
    "it does , however , also require the gnu scientific library for the integration of the degeneracy quantities discussed below .",
    "the sampler is composed of four separate mcmc engines : fast parameter changes ( e1 ) , all parameter changes ( e2 ) , principal direction changes ( e3 ) , degeneracy direction changes ( e4 ) ; each of these engines is explained below . at any given step in the chain , only one of engines is used to propose the next candidate point @xmath4 .",
    "which engine is used is decided randomly at each step according to a set of relative probabilities fixed by the user at compilation . to allow for the engines to respond dynamically to the stucture of the target density , at regular intervals ( the number of chain steps defining an ` interval ' being fixed by the user at compliation : default 300 ) the engines e1 , e2 and e3 are overhauled .",
    "in particular , for e1 and e2 , the proposal widths @xmath10 are adjusted to ensure reasonable acceptance rates ( see below ) . for e3 , the empirical covariance matrix of recent samples is recalculated .",
    "we note that an overhaul is only performed after a rejection of a candidate point , thus ensuring that detailed balance is maintained .      during a fast parameter change ( engine e1 ) , only fast parameters in camb",
    "are updated .",
    "each fast parameter is assigned a probability @xmath20 of being updated in any given e1 proposal .",
    "these are defined by the user at compilation .",
    "note that the @xmath20 need not sum to unity . if @xmath17 fast parameters are updated , each new parameter value is drawn from a gaussian distribution centred at the present parameter value and having width @xmath16 .",
    "for the first sampling interval the @xmath10 are those supplied by the user at compilation .",
    "in contrast to the cosmo - mc sampler , however , the proposal width @xmath10 for each parameter is then updated at each overhaul , based on the acceptance rates achieved for that parameter in the previous sampling interval .",
    "if the average acceptance rate of a given parameter is less than a user selected target @xmath21 ( defined at compilation : default 0.4 ) , it is likely that the proposal width for this parameter is too large and so the corresponding @xmath10 is decreased by a fixed factor ( defined at compilation : default 0.8 ) .",
    "similarly , if the acceptance rate is less than @xmath21 the proposal width is probably too narrow and is thus increased by a fixed factor ( defined at compilation : default 1.2 ) . as we show in section  [ sec : application ] , the proposal width for each parameter eventually settles down to a stable value appropriate to the target density being sampled .",
    "the all - parameter - change engine ( e2 ) operates in an identical manner to e1 , except that in this case the full set of fast and slow parameters may be updated .",
    "the engine ( e3 ) implements prinicipal - direction changes and makes use of the covariance information collected from early samples .",
    "this engine is only switched - on once the chain has taken a given number of steps ( defined at compilation : default 200 ) , at which point the empiricial covariance matrix of the parameters is calculated using preceeding samples ; an upper limit on the number of preceeding samples used in the calculation is defined at compilation ( default 2000 ) .",
    "the covariance matrix is then updated at each overhaul . the eigenvectors and eigenvalues of the covariance matrix",
    "are then determined , which yield the principal directions in which changes may be proposed and the corresponding gaussian proposal widths . in an analogous manner to engines e1 and e2 , each principal direction",
    "is assigned a probability @xmath20 of being updated ( defined at compilation ) .",
    "once again the @xmath20 need not sum to unity .",
    "this approach has two advantages over the covariance matrix method used in the cosmo - mc sampler .",
    "firstly , the covariance matrix corresponds to the local degeneracy directions and is thus optimised for the current position of the chain . secondly",
    ", it alleviates the need to run the entire sampling process twice , thus making the computation requirements considerably smaller .",
    "the degeneracy directions engine ( e3 ) is the most important innovation in the cog sampler , and ensures good mobility of the chain around the target density .",
    "this engine takes advantage of the fact that there are degeneracies in cosmological parameter space that are intrinsic to any cmb observation and can not be broken even with cosmic - variance limited data .",
    "some of these degeneracies have been extensively analysed in efstathiou and bond ( 1999 ) . in particular , we implement motion of the chain along the two most important degeneracies : namely the geometrical degeneracy and the peak position degeneracy . in addition , we also implement motion of the chain along the degeneracy directions spanned by the parameters @xmath22 and @xmath23 .",
    "the probability @xmath20 of updating along each degeneracy direction is defined at compilation ( default 0.25 ) .",
    "the geometrical degeneracy is a nearly exact degeneracy in cosmological parameter space for cmb data ; it therefore allows large movement of the chain in the space . according to efstathiou and bond ( 1999 )",
    ", two cosmological models are degenerate if they have the same physical matter densities @xmath24 and @xmath25 , the same primordial scalar and tensor fluctuation spectra and the same value of parameter @xmath26 where @xmath27 , @xmath28 is given by the integral @xmath29 } , \\label{eq : es2}\\ ] ] and @xmath30 for a flat universe the function @xmath31 equals unity , and for closed universes it simplifies to @xmath32 .",
    "the integral ( [ eq : es2 ] ) may be evaluated numerically , where the lower limit is obtained using the fitting formula for the redshift of recombination given by hu and sugiyama ( 1995 ) , namely @xmath33 [ 1 + g_1 \\omega_m^{g_2}]\\ , , \\label{eq:20}\\\\ g_1 & = &   0.0783 \\omega_b^{-0.238 } [ 1 + 39.5 \\omega_b^{0.763 } ] ^{-1}\\ , , \\nonumber \\\\ g_2 & = &   0.560 [ 1 + 21.1 \\omega_b^{1.81 } ] ^{-1 } \\ , .",
    "\\nonumber\\end{aligned}\\ ] ] the quantity @xmath34 is thus a function of the parameter set @xmath35 .",
    "these parameters can be calculated from the equivalent cosmo - mc parametrisation @xmath36 .    when a geometric degeneracy change is proposed , the parameter @xmath34 is calculated for the current chain position @xmath9 .",
    "a fixed - width gaussian change in @xmath37 is proposed and the @xmath38 direction is then searched using a numerical minimiser until a model with a matching @xmath34 is found . finally , the new set of parameters are converted back to the standard cosmo - mc parametrisation for this new candidate point @xmath4 .",
    "the proposal width in @xmath37 is set at compilation and can be quite large ( default @xmath39 ) , since the degeneracy is almost exact so candidate points should have a high acceptance rate . indeed , the difference in cmb power spectrum between models @xmath9 and @xmath4 is below the level of cosmic variance .",
    "however , due to inaccuracies in above approximations , as well as intrinsic numerical inaccuracies in the camb code , the acceptance rate for these changes is less than unity . finally , we note that although the numerical minimisation step involves many numerical integrations , the time spent searching this space is negligible compared to the calculation of a single cmb power spectrum .",
    "another important degeneracy is the first peak position degeneracy .",
    "although not as exact as geometrical degeneracy it still allows the chain to make large steps in the parameter space . following efstathiou & bond ( 1999 ) ,",
    "the position of the first peak is approximately given by @xmath40 where @xmath41 in which @xmath42 is the normalised scale factor at matter - radiation equality and @xmath43 . to a good approximation @xmath44 thus @xmath45 is also a function of the parameter set @xmath46 .",
    "since @xmath47 and @xmath48 are not required to be fixed there is considerably more freedom in choosing which parameters to change . in the present implementation @xmath48",
    "is always changed with @xmath47 and @xmath38 being changed with some finite probability .",
    "the @xmath37 direction is then numerically searched for a model with a matching first peak position .",
    "we note in passing that the third degeneracy mentioned in efstathiou & bond ( 1999 ) , i.e. the height of the first peak degeneracy , is not very relevant to future analysis , since it is already broken by the existing cmb dataset .",
    "another well - known approximate physical degeneracy in the cosmological parameter space for cmb data is that between @xmath51 and @xmath52 ( see e.g. lewis & bridle 2002 ) this occurs because the cmb power spectrum on scales smaller than the horizon size at reionisation is damped by a factor @xmath53 , and @xmath54 scales with the power in the primordial perturbation .",
    "the corresponding parameters in the cosmo - mc software are @xmath49 and @xmath50 .",
    "we note that @xmath49 is a ` slow ' parameter , whereas @xmath50 is a ` fast ' one .",
    "when a move in @xmath49 is proposed , the sampler additionally proposes up to 30 ( or a number selected at the compilation time ) proposals in @xmath50 .",
    "the proposal probability distribution function for @xmath50 is a half gaussian with the correct orientation ( i.e. increasing @xmath49 requires increasing @xmath50 and therefore sampler always proposes change which has the right orientation with respect to the degeneracy direction ) .",
    "since @xmath50 is a fast parameter the computational cost is essentially just one camb call .",
    "there is a weak degeneracy in the parameters @xmath24@xmath56 .",
    "we have implemented a degeneracy sampling system that is analogous to that described in the previous section with the slow parameter @xmath57 and the fast parameter @xmath55 .      as mentioned in section  [ sec : intro ] , any mcmc sampler requires a burn - in period for the chain to reach equilibrium and hence sample from the target distribution @xmath0 .",
    "unfortunately , there exists no formula for determining the length of the burn - in period , or for confirming that a chain has reached equilibrium . indeed , the topic of convergence is still a matter of ongoing statistical research .",
    "nevertheless , several _ convergence diagnostics _ for determining the length of burn - in have been proposed .",
    "these employ a variety of theoretical methods and approximations that make use of the output samples from the markov chain .",
    "a review of such diagnostics is given by cowles & carlin ( 1994 ) .",
    "it is worth noting that running several parallel chains , rather than a single long chain , can aid the diagnosis of convergence , as discussed below in section  [ sec : application ] .",
    "it is also useful during burn - in to employ an _ annealing schedule _ in which the target density is raised to some power @xmath58 , which varies gradually from zero to unity .",
    "thus , one begins sampling from a modified posterior with @xmath59 and slowly raises @xmath58 according to some ( geometric ) _ annealing schedule _ until @xmath60 .",
    "this allows the chain to sample from remote regions of the posterior distribution , which in turn facilitates extensive chain mobility and ensures more reliable relaxation of the chain into the global optimum .",
    "this approach also has the convenient by - product of yielding an estimate from the burn - in samples of the bayesian evidence for the model under consideration ( see , for example , hobson & mclachlan 2002 ; slosar et al .",
    "to test the quality of our improved sampler , we have performed parameter estimation in a 7-parameter inflationary @xmath19cdm model the using the two separate data sets outlined below .",
    "we have compared the results from the cog sampler with those obtained using the standard cosmo - mc software . for both samplers , the initial starting position of the chain and the initial proposal widths @xmath10 for each parameter",
    "were identical , and are listed in table  [ t1 ] .",
    "also listed are the limits of the top - hat priors adopted for the parameters .",
    "both the cosmo - mc and cog samplers were run until 6000 post burn - in accepted samples had been collected for each chain . for both samplers",
    ", eight independent chains were run on separate nodes of a beowulf cluster .",
    "thus , the total number of post burn - in accepted samples was 48000 .",
    "this approach also allows one to compare samples obtained from different individual chains , which aids the determination of convergence .",
    ".the initial chain position @xmath61 , the range of top - hat prior , and the initial proposal width @xmath10 used for each parameter .",
    "the @xmath10 were chosen to be small to give the original cosmo - mc sampler some chance of exploring the cosmic variance limited model.[t1 ] [ cols=\"<,^,^,^\",options=\"header \" , ]      the first data set ( data set 1 ) consists of wmap , vsa , acbar and cbi band - power measurements of the total intensity cmb power spectrum ( bennett et al . 2003 ; grainge et al .",
    "2003 ; kuo et al . 2003",
    "; pearson et al . 2003 ) ; for @xmath62 only points from the wmap experiment are used . in the calculation of the wmap likelihood",
    "we use an adapted version of the publicly - available code ( kogut et al .",
    "200 ; hinshaw et al . 2003",
    "; verde et al .",
    "2003 ) .",
    "the average acceptance rates for the cosmo - mc and cog samplers are plotted in fig .",
    "[ d1fig0 ] as a function of the number of calls to the sampler .",
    "the original cosmo - mc sampler was supplied with the precomputed basic 6-parameter covariance matrix that comes supplied with the cosmo - mc software ; this includes all the parameters given in table  [ t1 ] except for @xmath63 . for this last parameter ,",
    "cosmo - mc uses a gaussian proposal distribution with the width indicated in the table .",
    "the provision of the covariance matrix in advance gives the cosmo - mc sampler some advantage as compared with its own ` initial ' sampling phase .",
    "nevertheless , the cog sampler at first equals this acceptance rate , and very soon surpasses it , once it has learnt the appropriate length scales of the posterior .",
    "after many samples , the acceptance rate for the cosmo - mc sampler is found to be around 0.1 . to obtain 6000 post burn - in accepted samples , 65000 calls to the sampler",
    "were made . by contrast",
    ", the average acceptance rate of the cog sampler is around 0.4 and only 17000 calls to sampler were required .     +    in fig .  [ d1fig1 ] ( top panel ) , we plot the acceptance rates for each of the four mcmc engines used in the cog sampler as a function of the number of overhauls , which are performed after every 300 chain steps .",
    "as one might expect , the engines e1 and e2 have acceptance rates of around 0.4 , since the proposal widths for the parameters are chosen to achieve this target . more interestingly , the e3 engine also has an acceptance rate of almost 0.4 , once equilibrium has been achieved .",
    "we note , however , that the initial acceptance rate for e3 is zero , since there are not enough samples to compute the covariance matrix . for e4 ( degeneracy direction changes )",
    ", one might have expected the acceptance rate to be high , since the change in the theoretical cmb power spectra corresponding to such a proposal is generally quite small .",
    "nevertheless , inexactness in the degeneracies and small numerical inaccuracies in both in camb and the calculation of the degeneracy parameters means that the acceptance rate is reduced somewhat below unity , although its equilibrium value of around 0.6 is higher than for the other engines . moreover , successful proposals along the degeneracy directions take the chain a considerable distance from its original position and are thus very important .    in fig .",
    "[ d1fig1 ] ( middle and bottom panels ) , we plot the proposal widths @xmath10 for the slow and fast parameters respectively , as a function of overhaul number ; each width is expressed as a fraction of its initial value as given in table  [ t1 ] .",
    "we see that each proposal widths initially decrease and then start oscillating around their equilibrium values .",
    "this oscillation could be avoided by adding a damping term to the proposal width change function , but we believe that oscillating gives the sampler opportunity to sample a larger range of distances and potentially escape local minima while at the same time maintaining high acceptance rate . additionally we note that the requirement to maintain an acceptance rate of @xmath64 means that the proposal widths are considerably smaller than widths of inferred uncertainties in parameters .",
    "we have performed simulations on a multivariate gaussian and results show that this is indeed an effective sampling technique .",
    "the marginalised probability distributions of the cosmological parameters obtained from the cosmo - mc and cog samplers are shown in fig .",
    "[ d1fig2 ] .",
    "we see that the distributions for the parameters @xmath24 , @xmath25 , @xmath55 , @xmath49 and @xmath50 are consistent within the sampling uncertainties for the two samplers .",
    "we note , however , that the marginalised distributions for @xmath65 , @xmath63 , @xmath66 and @xmath67 differ somewhat .",
    "in particular , we see that the distributions produced by the cosmo - mc sampler are significantly narrower than those obtained using the cog sampler .",
    "this provides a useful illustration of the poorer mobility of the chain in the cosmo - mc sampler along the geometrical degeneracy .",
    "this leads to underestimation of the confidence limits on the associated parameters .",
    "indeed , in some cases , the limits are underestimated by around a factor of two .",
    "conversely , the explicit degeneracy direction engine in the cog sampler allows its chain to move freely around the parameter space .",
    "this ensures that the marginalised distributions reflect the proper structure of the posterior .",
    "it should be noted , however , that the underestimation of the confidence limits by the cosmo - mc sampler is usually not a serious problem , since an informative prior on @xmath65 breaks the geometrical degeneracy sufficiently that the resulting marginalised distributions are reasonably accurate .",
    "the second data set ( data set 2 ) consists of simulated cosmic - variance limited measurements of the cmb power spectrum at each multipole out to @xmath68 .",
    "such data is expected from the forthcoming planck satellite mission . in detail ,",
    "a target concordance model was chosen with parameter values @xmath69 ,",
    "@xmath70 , @xmath71 , @xmath72 , @xmath73 , @xmath74 and @xmath75 .",
    "the corresponding theoretical cmb power spectrum was calculated using camb with the flat - universe code switched off . in an earlier analysis of data set 2",
    ", we noticed that discontinuities occurred in the sample distribution which were associated with the switch over in the camb code from flat universes to universes with arbitrary curvature .",
    "this inaccuracy in the camb code is only important when analysing data of such high precision , and has been previously identified ( lewis , private communication ) . to create data",
    "set 2 , we assumed that the cosmic variance limit can be well - approximated by a gaussian distribution centred on the true @xmath13 value and having a dispersion given by @xmath76 in practice , with real data , one should take into account that the probability of any given @xmath13 value follows a @xmath77-distribution ; this is particularly important at low @xmath78 values .",
    "the average acceptance rates for the cosmo - mc and cog samplers are plotted in fig .",
    "[ d2fig0 ] as a function of the number of calls to the sampler .",
    "once again , the original cosmo - mc sampler was given the precomputed basic 6-parameter covariance matrix that comes supplied with the cosmo - mc software , which gives the cosmo - mc sampler some initial advantage .",
    "one sees , however , that the cog sampler soon overtakes and , in this case , there is a very large difference between the equilibrium acceptance rates of the two samplers .",
    "after many samples , the acceptance rate for the cosmo - mc sampler is found to be around 0.01 . even after 70000 sampler calls for each chain ,",
    "only around 600 post burn - in accepted samples were obtained for the best - performing chain .",
    "conversely , the cog sampler achieved an equilibrium acceptance rate of 0.22 , and required only 28000 sampler calls to obtain 6000 post burn - in accepted samples for each chain .",
    "we also note that , as a result of the simulated annealing used in the cog sampler , it required only 3100 sampler calls were required to burn - in , as compared with 10000 sampler calls for cosmo - mc ( in the latter case , the end of burn - in was determined interactively by examining the posterior values associated with the chain samples ) .",
    "+    in fig .  [ d2fig1 ] ( top panel ) , we plot the acceptance rates for each of the four mcmc engines used in the cog sampler as a function of the number of overhauls . once again , by construction , the engines e1 and e2 have acceptance rates of around 0.4 once equilibrium has been achieved . for e3 ( principal direction changes ) , we again see that the initial acceptance rate is zero , since there are not enough samples to compute the covariance matrix , but in this case the acceptance rate remains low , reaching an equilibrium value of only 0.05 .",
    "we believe this behaviour is associated with the fact that , for data set 2 , the corresponding multivariate gaussian proposal distribution is a poorer approximation to the true posterior than for data set 1 . for e4 ( degeneracy direction changes ) , we see that the inexactness in the degeneracies and small numerical inaccuracies in both in camb and the calculation of the degeneracy parameters have a more profound effect for the analysis of data set 2 , resulting in a lower equilibrium acceptance rate of around 0.25 . as for data set 1 , however , successful proposals along the degeneracy directions take the chain a considerable distance from its original position and are thus very important .      the marginalised probability distributions of the cosmological parameters obtained from the cog sampler are shown in fig .",
    "[ d1fig2 ] .",
    "[ fig2 ]    we do not plot the corresponding distributions for the cosmo - mc sampler , because it was only able to produce a total of 1500 accepted post burn - in samples from 70000 sampler calls for each of the eight chains .",
    "this results in the corresponding marginalised distributions being dominated by sampling error .",
    "we note that the distributions for each parameter produced by the cog sampler contain the corresponding true value at high probability . for @xmath24 , @xmath25 , @xmath55 , @xmath49 and @xmath50 the distributions are reasonably smooth . however , the marginalised distributions for @xmath65 , @xmath63 , @xmath66 and @xmath67 contain some additional features .",
    "in particular , we note that each of these distributions contains a ` drop - out ' ; these occur at @xmath79 and @xmath80 , @xmath81 , @xmath82 and @xmath83 .",
    "these features are , in fact , the projections of a single feature in the multidimensional parameter space defining the geometrical degeneracy direction .",
    "we have separately examined the marginalised distributions produced for each of the eight chains , and found that all of them contain these features .",
    "it is therefore most likely that this feature is an artifact in the camb code .",
    "more importantly , setting aside these drop - outs , we see that the geometrical degeneracy is well - sampled , leading to wide tails on the marginalised distributions for @xmath63 , @xmath66 and @xmath67 .",
    "this confirms the well - known result that , even with cmb data of planck quality , the spatial curvature of the universe can not be well - constrained without the inclusion of informative priors .",
    "we have presented a fast markov - chain monte carlo sampler tailored to the problem of estimating cosmological parameters from measurements of the cmb total intensity power spectrum .",
    "this sampler employs a number of strategies to avoid the difficulties encountered in the use of the standard multivariate gaussian proposal function used , for example , in the cosmo - mc software package ( lewis & bridle 2002 ) . in particular , it achieves rapid convergence and produces reliable confidence limits by using dynamic widths for proposal distributions , dynamic covariance matrix sampling , and a dedicated proposal distribution for moving along well - known degeneracy directions .",
    "the new sampler module ( called cog ) is trivially substituted for the existing sampler in the cosmo - mc software . in section  [ sec : application ] , we test the cog sampler on the current cmb data set and a simulated data set of the quality expected from the planck mission . in each case , the sampler produces reliable marginalised distributions with considerably fewer sampler calls than the native cosmo - mc sampler .    in future work , we intend to enhance the efficiency of the cog sampler still further by allowing communication between chains . at present running several independent chains on different processors of a beowulf cluster provides a useful means of diagnosing convergence , but does not take advantage of the possibility of sharing the information obtained by the chains on the shape of the target density .",
    "in particular , we are investigating cross - chain proposals based on genetic algorithms ( see e.g. davis 1991 ) .",
    "we thank charles mclachlan , phil marshall , john skilling , steve gull and carolina dman for many interesting conversations regarding markov - chain monte carlo sampling .",
    "we are also grateful to antony lewis and sarah bridle for useful discussions and for making their cosmo - mc software publicly available . as acknowledges the support of st .",
    "johns college , cambridge .",
    "bennett c.l .",
    "et al . , apj , in press ( astro - ph/0302207 ) christensen n. , meyer r. , knox l. , luey b. , 2001 , class .",
    "18 , 2677 cowles m.k . ,",
    "carlin b.p . , 1994 ,",
    "technical report 94 - 008 , division of biostatistics , school of public heath , university of minnesota davis l. , 1991 , _ handbook of genetic algorithms_. van nostrand reinhold , new york .",
    "et al . , 2003 , apj , submitted ( astro - ph/0212289 ) efstathiou g. , bond j.r . , 1999 , mnras , 304 , 75 gilks w.r . , richardson s. , spiegelhalter d.j . , 1995 , in eds gilks w.r . , richardson s. , spiegelhalter d.j . , _ markov chain monte carlo in practice_. chapman & hall , london . grainge k. et al . , 2003 , mnras , 341 , l23 hinshaw g. et al . , 2003 , apj , in press ( astro - ph/0302217 ) hobson m.p",
    "mclachlan c. , 2002 , mnras , 388 , 365 hu w. , sugiyama n. , 1995 , prd , 50 , 7173 kogut a. et al . , 2003 , apj , in press ( astro - ph/0302213 ) knox l. , christensen n. , skordis c. , 2001 , apj , 563 , l95 lewis a.l . ,",
    "bridle s.l . , 2002 , prd , 66 , 3511 lewis a.l . , challinor a.d . ,",
    "lasenby a.n . , 2000 , apj , 538 , 473 pearson t.j .",
    "2003 , apj , 591,556 slosar a. et al . , 2003 , mnras , 341 , l29 verde l. et al . , 2003 , apj , in press ( astro - ph/0302218 )"
  ],
  "abstract_text": [
    "<S> markov - chain monte carlo sampling has become a standard technique for exploring the posterior distribution of cosmological parameters constrained by observations of cmb anisotropies . given an infinite amount of time , </S>",
    "<S> any mcmc sampler will eventually converge such that its stationary distribution is the posterior of interest . in practice , however , naive samplers require a considerable amount of time to explore the posterior distribution fully . in the best case , </S>",
    "<S> this results only in wasted cpu time , but in the worse case can lead to underestimated confidence limits on the values of cosmological parameters . even for the current cmb data set , the sampler employed in the widely - used cosmo - mc package does not sample very efficiently . </S>",
    "<S> this difficulty is yet more pronounced for data sets of the quality anticipated for the planck mission . </S>",
    "<S> we thus propose a new mcmc sampler for analysing total intensity cmb observations , which can be easily incorporated into the cosmo - mc software , but has rapid convergence and produces reliable confidence limits . </S>",
    "<S> this is achieved by using dynamic widths for proposal distributions , dynamic covariance matrix sampling , and a dedicated proposal distribution for moving along well - known degeneracy directions .    </S>",
    "<S> cosmic microwave background  </S>",
    "<S> methods : data analysis  methods : statistical . </S>"
  ]
}