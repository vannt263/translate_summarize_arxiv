{
  "article_text": [
    "dynamics of magnetized plasma at sufficiently large spatial and temporal scales can be adequately described by the set of magnetohydrodynamic ( mhd ) equations @xcite . in many problems",
    "we face the situation with high lundquist ( a.k.a .",
    "magnetic reynolds ) number @xmath0 where @xmath1 is the characteristic size of the system , @xmath2 the typical alfvn velocity ( @xmath3 and @xmath4 being the magnetic field strength and plasma density , respectively ) and @xmath5 the electric resistivity . a direct consequence of the high lundquist number is a large separation between the system size and the dissipation scale .",
    "the cascading fragmentation of the current layer in the magnetic reconnection in solar flares @xcite can serve as an example of such a multi - scale problem : the span between the eruption size ( @xmath6  km ) and the dissipation scale ( 1  m ",
    "10  m ) in the practically collision - less coronal plasmas easily extends seven orders of magnitude .    in general , there are two approaches how to handle such a broad range of scales .",
    "the first one uses a moderate numerical resolution and models the physics on the sub - grid ( unresolved ) scales using some plausible assumptions on the micro - scale statistical properties ( correlations ) of the quantities that define the system ( e.g. flow or magnetic field ) . among them , e.g. , the large - eddy simulations ( les ) @xcite or reynolds - averaged numerical simulations ( rans ) @xcite belong to the well known methods used widely in engineering applications in the fluid dynamics .",
    "the second approach is based on direct simulations that cover all the scales contained in the problem .",
    "traditionally , the adaptive mesh refinement ( amr ) technique is used with the finite - difference / finite volume methods in order to resolve high - gradient regions locally , keeping the total number of grid points required for simulation at a manageable level @xcite",
    ". nevertheless , also this approach has its limitations caused by introduction of artificial boundaries between fine and coarse meshes .",
    "this problem , however , can be cured by the methods based on unstructured mesh , such as is used in fem . with this in mind",
    "we have implemented a fem - based solver for mhd equations and present it in the current paper . from various fem formulations we have chosen the lsfem because it is robust , universal ( it can solve all kinds of partial differential equations ) and it is efficient  it always leads to the system of linearized equations with symmetric , positive definite matrix @xcite .",
    "the lsfem keeps many key properties of the rayleigh - ritz formulation even for systems of equations for which the equivalent optimization problem ( in rayleigh - ritz sense ) does not exist @xcite .",
    "despite of the fem applications in the fluid dynamics made a substantial development in the past years , its usage for numerical solution of mhd equations is still rather rare .",
    "for example , the _ nimrod _ @xcite and _ m3d _ codes @xcite  based on galerkin formulation ",
    "belong to a few known implementations of fem - based mhd solvers .",
    "related work also has been done by @xcite who implemented the mhd ( and two - fluid ) equations within the more general code framework sel @xcite based on the galerkin formulation with high - order jacobi polynomials as the basis functions . however , to our knowledge , the lsfem implementation of the mhd solver described in the current paper is the first attempt of this kind .",
    "the paper is organized as follows : first , we briefly describe the underlying mhd model . then , the mhd equations are re - formulated in the general flux / source ( conservative ) formulation .",
    "temporal discretization , reduction to the first - order system , and linearization procedure are described subsequently .",
    "then , the properties of the least - square formulation of fem are briefly summarized .",
    "some practical arrangements of the lsfem implementation of the mhd solver follows .",
    "finally , the code is tested on a couple of standardized model problems and the results are discussed with respect to the intended application of the code to the current - layer filamentation and decay during the magnetic reconnection in solar eruptions .",
    "the large - scale dynamics of magnetized plasma can be described by mhd equations for compressible resistive fluid @xcite : @xmath7 where @xmath4 , @xmath8 , @xmath9 , @xmath10 are density , macroscopic velocity , magnetic field , and total energy density , respectively , @xmath11 being the gravity acceleration . the energy flux @xmath12 and auxiliary variables @xmath13 ( current density ) and @xmath14 ( plasma pressure ) are given by the following relations : @xmath15    in the ( almost ) collision - less plasma , in which we are mostly interested , the classical resistivity usually plays a small role . instead of that various microscopical ( kinetic ) effects",
    "influence the plasma dynamics via other terms in the generalized ohms law @xcite . in order to mimic these processes ,",
    "whose modeling is beyond the scope of mhd approach , we re - consider the parameter @xmath5 as a generalized resistivity , including the effects like wave - particle interactions or off - diagonal components in the electron pressure tensor into it . as such effects are  in general  observed in the highly filamented , intense current sheets we model the anomalous generalized resistivity as follows : @xmath16 thus , the non - ideal effects are turned on whenever the current - carrier drift velocity @xmath17 exceeds the critical threshold @xmath18 .    in order to solve the eqs .",
    "( [ eq : mhd ] ) numerically , it is convenient to rescale all the quantities into the dimensionless units .",
    "thus , all the spatial coordinates are expressed in the characteristic size @xmath1 and times in alfvn transit time @xmath19 , where @xmath20 is a typical alfvn speed .",
    "magnetic field strength @xmath3 and plasma density @xmath4 are given in units of their characteristic values @xmath21 and @xmath22 and similar scaling holds for the other quantities ",
    "see @xcite or @xcite for details . from now on we shall use this dimension - less system .    in order to utilize a more universal lsfem implementation for more general form of equations ( c.f . with sel approach * ? ? ?",
    "* ) the set of mhd eqs .",
    "( [ eq : mhd ] ) is rewritten into the conservative ( flux / source ) formulation : @xmath23 here the local state vector @xmath24 , @xmath25 being the momentum density .",
    "the flux @xmath26 and the source - term @xmath12 are defined as @xmath27 where @xmath28 is the @xmath29 unit matrix , @xmath30 is the permutation pseudo - tensor , @xmath31 is the electric field strength .",
    "the the enthalpy and kinetic energy densities are @xmath32 and @xmath33 , respectively .",
    "in general , fem is formulated for the linear problem @xmath34 where @xmath35 is the linear ( differential ) operator , @xmath36 the boundary operator , @xmath37 is the domain and @xmath38 is the boundary of @xmath37 .    in order to reformulate the system of eqs .",
    "( [ eq : mhdcons ] ) into the standardized problem  ( [ eq : fem ] ) several steps have to be undertaken .",
    "first of all , we perform the time discretization .",
    "we use the standard @xmath39-differencing scheme ( see , e.g. , * ? ? ?",
    "* ) : @xmath40 where parameter @xmath41 controls the implicitness of the scheme , and @xmath42 and @xmath43 designate the old and new time - steps , respectively .",
    "the scheme leads to the following semi - implicit equation @xmath44 where the rhs vector @xmath45 consists of components known at old time step .",
    "since _ practical _ implementations of lsfem require first order system of pdes @xcite we further transform the system  ( [ eq : mhdcons ] ) to the required form introducing a new independent system variable  the electric field @xmath46 the procedure is basically analogous to the velocity - vorticity formulation of the navier - stokes equations in the cfd .    a frequent problem in the numerical mhd is a violence of the solenoidal condition @xmath47 , where the ( dummy ) variable @xmath48 represents the artificial density of the magnetic charge .",
    "the advantage of the lsfem implementation is that this constraint can be directly included into the set of the governing equations @xcite . then assembling the solenoidal condition together with eqs .",
    "( [ eq : impl ] ) and ( [ eq : efield ] ) we arrive to the following 1st - order vector equation for our modeled system : @xmath49 where all the lhs terms are evaluated in the advanced time - step @xmath43 . here , @xmath50 and @xmath51",
    "are given by eq .",
    "( [ eq : mhdfluxsource ] ) with @xmath52 considered as an independent variable now and @xmath53 .",
    "the fluxes @xmath54 and @xmath55 imply from eq .",
    "( [ eq : efield ] ) and the solenoidal condition .",
    "the source term component @xmath56 .",
    "we keep the artificial magnetic - charge density @xmath48 at zero .",
    "( [ eq : mhdext1 ] ) can be written in the conservative form similarly as in eq .",
    "( [ eq : mhdcons ] ) @xmath57 with the extended state vector , fluxes and source terms in the form @xmath58    since the extended flux @xmath59 and source term @xmath60 depend non - linearly on the state vector @xmath61 , a linearization procedure has to be applied in order to transform the system  ( [ eq : mhdext2 ] ) into the fem - conforming form  ( [ eq : fem ] ) .",
    "we use the standard newton - raphson ( nr ) iterations in each time step @xcite .",
    "thus , the flux at the nr iteration @xmath62 can be expressed as @xcite : @xmath63 and analogous expression holds for the source term .",
    "introducing the jacobians @xmath64 the final equation for nr iterations reads @xmath65 where the rhs contains only the terms from the @xmath66th iteration of the currently solved time - step @xmath43 and variables known at the previous step @xmath42 .",
    "( [ eq : nrfinal ] ) is already in the form  ( [ eq : fem ] ) with @xmath67",
    "in the least - square formulation of the fem the problem described by eqs .",
    "( [ eq : fem ] ) is transformed to seeks the minimum of the functional @xmath68 where @xmath69 is appropriate mesh - dependent weighting factor @xcite . as in other fem implementations ,",
    "the solution is searched for in a limited subspace of functions that are formed as a union of the piece - wise functions @xmath70 defined on a single , in our code triangular element , as a linear combination of the basis functions @xmath71 : @xmath72 where @xmath73 can always represent the value of a function @xmath74 in a properly selected point ( the node ) @xmath75 .",
    "here @xmath76 denotes element - wise index of the node . in our code",
    "we use lagrangian polynomials for basis functions @xmath71 .    varying the functional ( [ eq : femfunc ] ) and inserting the expansion ( [ eq : basis ] ) we arrive to a set of linear algebraic equations for each internal element in the form @xmath77 where @xmath78 is the domain of the @xmath79-th element in the global domain @xmath37 .",
    "the boundary elements contain additional terms obtained from the boundary operator ( the second term in eq .",
    "( [ eq : femfunc ] ) ) . for fast evaluation of local integrals",
    "we use gaussian quadrature @xcite in the system of element natural coordinates @xcite .",
    "equations  ( [ eq : lsfem_loc ] ) for each element are finally assembled to a global linear system of equations via mapping the element - wise node index @xmath80 to a global node index @xmath81 described in @xcite , to obtain @xmath82 the final matrix @xmath83 is sparse , symmetric and positive definite . in our code",
    "we use preconditioned jacobi conjugate gradient method ( jcgm ) @xcite for solution of the system  ( [ eq : fem_glob ] ) .",
    "the entire algorithm can be summarized as follows :    * time loop  adapt time step size according to cfl condition , check final desired time * * linearization loop  if @xmath84 or maximum iteration count is reached continue to next time step * * * assembling stiffness matrix @xmath83 element by element * * * * integration by gaussian quadrature 1 .",
    "compute the operator matrices for each basis function 2 .",
    "multiply the operator matrices then add the result into stiffness matrix 3 .",
    "multiply the operator matrix by the rhs then add result into the load vector * * * * next gaussian point * * * next element * * find new solution @xmath85 of system  ( [ eq : fem_glob ] ) by the jcgm * * next linearization * next time step    thanks to the iterative nature of the jcgm , the solver algorithm can be rather easily parallelized via mpi .",
    "we decompose the entire domain into subdomains , splitting the global matrix @xmath83 and the load vector @xmath86 into corresponding segments with rather small overlaps related to internal - boundary nodes shared by both adjacent subdomains .",
    "matrix multiplications are then performed only locally ( per - process ) and , finally , resulting global vectors are appropriately assembled using mpi operations that transfer the data related to overlapping nodes only .",
    "in order to assess usability and properties of the lsfem mhd solver we perform several tests on standardized ideal ( non - resistive ) and resistive mhd problems . for all test",
    "we use the adiabatic index @xmath87 , the implicitness parameter @xmath88 ( crank - nicholson time discretization ) , and the courant number 0.6 .",
    "first , we applied our code onto the standard ryu - jones ideal mhd 1d shock / discontinuity problem @xcite .",
    "the initial state is given by prescriptions @xmath89 in the left half , and @xmath90 in the right half of the computational box , respectively .",
    "the domain @xmath91 was divided into 512 elements .",
    "we used the first order basis functions to approximate the fem solution .",
    "the boundary conditions on both ends are of von neumann type .",
    "results at time @xmath92 are shown in fig .",
    "[ fig : rj0lsfem ] .",
    "they correspond and could be compared with fig .",
    "3b in @xcite .     with the first - order basis functions . ( a ) density profile ( red dashed line ) and @xmath93 profile along @xmath94-axis .",
    "( b ) @xmath95 profile along @xmath94-axis.,width=604 ]    in order to study influence of basis - function order on the approximate solution we calculate the same test problem , now with the second - order lagrange polynomials .",
    "all other parameters are the same as in the previous case displayed in fig .",
    "[ fig : rj0lsfem ] .",
    "the results are shown in fig .  [",
    "fig : rj1lsfem ] .     with the second - order basis functions . displayed quantities",
    "are the same as in fig .",
    "[ fig : rj0lsfem].,width=604 ]      a next test we performed standard orszag - tang 2d ideal - mhd vortex problem @xcite .",
    "the initial state was given by the following relations : @xmath96 the computational domain @xmath97 was discretized by @xmath98 triangular elements .",
    "we apply periodic boundary conditions at all boundaries .",
    "the first - order basis functions were used in this simulation .",
    "results in figs .",
    "[ fig : orszagtangdens ] and  [ fig : orszagtangb ] show the plasma density and the magnitude of the magnetic field , respectively , at times @xmath99 ( a ) , and @xmath100 ( b ) .",
    "( a ) and @xmath100 ( b).,width=604 ]     ( a ) and @xmath100 ( b).,width=604 ]      in order to assess the applicability of our code to the solutions of non - ideal ( resistive ) mhd problems and to estimate its numerical resistivity we performed a following test : at the initial state @xmath101 a cylindrical current @xmath102 with @xmath103 flows through a plasma of a uniform density @xmath22 . here , @xmath104 is the amplitude of the current density on the cylinder axis , @xmath105 is the cylinder radius , and @xmath106 is the first null of the bessel function of the 0th order @xmath107 .",
    "the resistivity inside the cylinder ( @xmath108 ) is uniform @xmath109 , outside @xmath110 . in order to be able to compare the numerical results with an analytical solution and to split advective and resistive properties of the code we set all velocities to zero at @xmath101 and the density to a very high value @xmath111 to keep the plasma in rest . in the limit",
    "@xmath112 the mhd system  ( [ eq : mhd ] ) effectively reduces into the diffusion equation @xmath113 whose analytical solution for our initial state keeps the form @xmath114 with @xmath115\\delta(r - r_o)\\ , \\ ] ] where @xmath116 is the bessel function of the 1st order and @xmath117 is the dirac delta function .",
    "the decrement @xmath118 reads @xmath119 the second term in eq .",
    "( [ eq : jt_anal ] ) represents an induced surface current that compensates resistive decrease of the current density inside the column to keep the magnetic field in the outer super - conducting domain constant .",
    "the corresponding magnetic field is of the form @xmath120 where @xmath121 for internal ( @xmath122 ) region and @xmath123 for the outer space .",
    "computational domain is divided into a homogeneous mesh of @xmath124 triangles in our numerical test .",
    "we use the first order basis functions to approximate the numerical solution .",
    "free boundary conditions were applied on all boundaries .",
    "the results of this test are shown in fig .",
    "[ fig : resistive ] .",
    "[ fig : resistive](a ) shows time evolution of the current density profile along @xmath125 for five subsequent time instants .",
    "resistive decrease of @xmath126 inside the column accompanied by formation of the induced surface current are well visible . fig .",
    "[ fig : resistive](b ) shows a comparison of numerical and analytical solutions for time evolution of the current density @xmath127 at @xmath128 .",
    "the fem represent an alternative to fdm / fvm that are traditionally used for solution of mhd problems in astrophysics .",
    "its attractivity implies from its unstructured mesh that allows for appropriate local refinement without formation of qualitative internal boundaries between the fine and coarse meshes .",
    "this property makes it very useful for handling the multi - scale problems , for example the problem of magnetic reconnection in solar flares @xcite ( and other large - scale systems ) or mhd turbulence .     at five subsequent times .",
    "( b ) the time profile of @xmath129 - comparison of numerical and analytical [ eq .  ( [ eq : jt_anal ] ) ] solutions.,width=604 ]    with this intention in mind we have developed the lsfem implementation of a mhd solver whose descriptions and preliminary results from its application to the standardized test problems are presented in this paper .    to sum up the main points of our implementation : transformation of the mhd equations  ( [ eq : mhd ] ) to the standard fem problem  ( [ eq : fem ] ) involves several steps : ( i ) standard @xmath39- time discretization , ( ii ) decrease of the order of the system of equations by introduction of a new variable  electric field strength , and ( iii ) newton - raphson linearization .",
    "the possibility to include the solenoidal condition @xmath130 directly into the system of equations certainly belongs to advantages of lsfem formulation , as well as a natural involvement of the boundary conditions .",
    "the element - by - element assembling of the global stiffness matrix and the iterative nature of jcgm solver allow for rather easy and efficient mpi parallelization .",
    "integrals over elements are efficiently performed via gauss quadrature .",
    "we performed several standardized tests focused on an ideal and resistive mhd .",
    "the lsfem mhd solver quite closely reproduces results published for the ryu - jones shock tube problem @xcite .",
    "small spurious oscillations appear around the points where the first derivative of an analytical solution does not exist .",
    "choice of the higher - order basis functions makes the situation even slightly worse .",
    "similar feature can be seen in the results from the orszag - tang vortex test problem . while the large - scale dynamics agree well with those obtained from the gauge codes , small oscillations accompanying the shocks are visible again .",
    "these effects are caused by the least squares curve fitting approach @xcite .",
    "we believe that it can be cured by an introduction of a small background resistivity and local refinement of the mesh around the discontinuities , with the element size corresponding to the resistivity - controlled ( magnetic ) reynolds number .",
    "such approach is fully in line with the intended usage of the code for detailed studies of the current sheet filamentation and fragmentation in a large - scale magnetic reconnection in solar flares .",
    "indeed , in the solar corona we have a very small background classical resistivity due to ( rare ) collisions between electrons and ions as well .",
    "hence , having mesh around the filamenting current sheet locally refined as much as possible we can set the background ( physical ) resistivity accordingly and approach thus the realistic lundquist number in the solar corona .",
    "finally  with the intended usage of the code in mind",
    " we have tested the properties of our implementation for solution of the resistive problems . in order to get a comparison with an analytical solution we have frozen the plasma dynamics by setting high matter density and we concentrated on a purely diffusive problem .",
    "the results show a rather good agreement with the analytical solution .",
    "namely , the induced surface current density is located only at a few elements and did not diffuse further with time .",
    "this is an important result for intended future studies of the current - sheet filamentation in the flare reconnection .",
    "the tests show basic applicability of our lsfem implementation of the mhd solver for a solution of selected problems . at the same moment",
    "they reveal the necessity to involve both the adaptive spatial refinement ( it has already been implemented ) and adaptive change of the order of basis functions over selected elements ( h - p refinement ) .",
    "these features will be implemented into our code in a near future .",
    "this research was supported by the grants p209/12/0103 ( ga r ) , p209/10/1680 ( ga r ) , and the research project rvo:67985815 .",
    "m.b . acknowledges support of the european commission via the pcig - ga-2011 - 304265 project financed in frame of the fp7-people-2011-cig programme .                  ,",
    "b. , olson , k. , ricker , p. , timmes , f.  x. , zingale , m. , lamb , d.  q. , macneice , p. , rosner , r. , truran , j.  w. , tufo , h. , nov .",
    "flash : an adaptive mesh hydrodynamics code for modeling astrophysical thermonuclear flashes .",
    "astrophysical journal supplements 131 , 273334 .",
    ", c.  r. , glasser , a.  h. , gianakon , t.  a. , barnes , d.  c. , nebel , r.  a. , kruger , s.  e. , schnack , d.  d. , plimpton , s.  j. , tarditi , a. , chu , m.  s. , mar .",
    "nonlinear magnetohydrodynamics simulation using high - order finite elements .",
    "journal of computational physics 195 , 355386 ."
  ],
  "abstract_text": [
    "<S> many problems in physics are inherently of multi - scale nature . </S>",
    "<S> the issues of mhd turbulence or magnetic reconnection , namely in the hot and sparse , almost collision - less astrophysical plasmas , can stand as clear examples . </S>",
    "<S> the finite element method ( fem ) with adaptive gridding appears to be the appropriate numerical implementation for handling the broad range of scales contained in such high lundquist - number mhd problems . in spite </S>",
    "<S> the fem is now routinely used in engineering practice in solid - state and fluid dynamics , its usage for mhd simulations has recently only begun and only few implementations exist so far . in this paper </S>",
    "<S> we present our mhd solver based on the least - square fem ( lsfem ) formulation . </S>",
    "<S> we describe the transformation of the mhd equations into form required for finding the lsfem functional and some practical issues in implementation of the method . </S>",
    "<S> the algorithm was tested on selected problems of ideal ( non - resistive ) and resistive mhd . </S>",
    "<S> the tests show the usability of lsfem for solving mhd equations </S>",
    "<S> .    magnetohydrodynamics ( mhd ) , least - squares finite element method , adaptive mesh refinement , magnetic reconnection , solar eruptions , mhd turbulence </S>"
  ]
}