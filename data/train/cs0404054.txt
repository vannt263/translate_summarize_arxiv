{
  "article_text": [
    "privacy on the internet gains importance as most network activity can be linked to a user s identity . proposed solutions that use chaumian mixes",
    "show certain traffic patterns if not every user runs a node in the system .",
    "we describe a realistic threat model and present a new set of protocols that allow unobservable communication .    in 1981 , david chaum presented the concept of _ mixes _ , a protocol to provide sender  receiver _ unlinkability _ under standard cryptographic assumptions .",
    "unlinkability means that an observer does not learn anything to improve her guesses on who communicates with whom ( the _ a  priori _ probability of two entities being related is equal to the _ a  posteriori _ probability ) .",
    "the notion of the _ anonymity set _ is essential when measuring anonymity .",
    "it is the set of all possible subjects who might cause an action @xcite . in the context of classical communication protocols , it consists of the senders and receivers .    currently employed implementations of mix networks are , for example , the cypherpunks @xcite and mixmaster @xcite remailers and the nascent mixminion project @xcite .",
    "chaum s work motivated other schemes which avoid expensive decryption at each step , to minimize delay , for example , crowds @xcite and onion routing @xcite .    in practice",
    ", most users of these systems do not run mix nodes themselves .",
    "they cause traffic patterns to and from the set of mix nodes , which a global , passive adversary can use to reduce the anonymity provided by the systems .",
    "possible attacks by such an observer include intersection , timing and packet counting attacks on remailers and other systems derived from chaumian mixes @xcite .",
    "suggested solutions introduce _ cover traffic _ into the protocols .",
    "this is achieved mainly by having the senders inject _ dummy messages _",
    "@xcite , which are discarded at some mix .",
    "_ unobservability _ is a stronger property than unlinkability , meaning that an observer can not tell if messages are being sent or received _ at all_.    this paper presents techniques to enlarge the anonymity set by including noninvolved subjects who provide cover traffic for the protocol in question .",
    "our approach is to hide communication within transit traffic going through http browsers .    in our model ,",
    "the adversary can not distinguish senders or receivers in the hidden protocol from other http users contacting the same set of servers .",
    "this enlarges the anonymity set beyond senders and receivers and provides unobservability .",
    "the rest of the paper is organized as follows . in section",
    "[ attack ] , we define our adversary model .",
    "section [ back ] briefly introduces chaumian mixes and explains why http is a good choice of cover protocol .",
    "related work is examined in section  [ related ] .",
    "section  [ s2s ] describes a new class of covert channels inside http which allow communication between servers under the cover of user  generated traffic . to show how these channels can be put to use in a chaumian mix , we present a simple protocol in section  [ mup ] .",
    "unsolved problems and areas for future research are discussed in section [ disc ] .",
    "we conclude with section  [ concl ] .",
    "to mount the timing and intersection attacks against many employed systems , the observer only needs to inspect the headers in the layers below the application layer of the tcp / ip stack at selected points on the internet .",
    "this precisely matches the capabilities of current ( legal ) telecommunication surveillance . to cite the calea implementation section of the fbi :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ examine[ing ]",
    "the full packet stream and examine protocol layers higher than layer 3 would place a high load on existing network elements in most architectures .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    the specification of `` traffic data '' in the eu convention on cybercrime @xcite indicates that the intended mandatory surveillance by internet service providers is restricted to the lower three layers of the tcp / ip stack .",
    "we grant our adversary the additional ability to inspect application layer headers .",
    "this adversary model corresponds to an observer who is datamining traffic logs for cliques of communicating people .",
    "this is a realistic and impending threat .",
    "in chaumian mixes , nodes relay messages for each other . each node has a @xmath0 pair . to send a message along a chain of relaying mixes through the mix overlay network , the address of the final recipient",
    "is attached to the message .",
    "the result is encrypted with the public key of the last node in the chain .",
    "the address of the node is attached to the result and the process repeated for each node along the chosen path toward the first . on receipt of a message , a node decrypts it and  if it is not the final recipient itself  forwards it to the node specified in the decrypted text .",
    "later improvements on chaum s scheme suggest random delays , various strategies to process and subsequently dispatch messages ( _ flushing _ ) @xcite , re  ordering of messages in the pool , padding the messages to a fixed size after decryption , and other improvements to ensure unlinkability .",
    "although recently contributed schemes ( e.g. morphmix @xcite , gnunet s gap @xcite or tarzan @xcite ) require users to transport traffic for other users , many deployed chaumian mixes and derived systems suffer from the problem that most users do not  or perhaps can not  run nodes in the systems themselves .",
    "they may be hindered by network address translation @xcite , dynamic  and therefore unstable  ip addresses or restrictive firewalling policies .",
    "this greatly weakens the achievable anonymity , as a passive adversary can observe traffic patterns leading to and coming from the mix network .    to thwart traffic analysis",
    ", we suggest hiding the protocol inside the well  established hypertext transfer protocol ( http@xcite ) .",
    "according to recent measurements@xcite , http accounts for the highest percentage of data on the internet , only slightly less than fasttrack s @xcite peer  to  peer protocol .    using http as cover traffic brings another advantage .",
    "there is already an extensive body of research , and several implementations , which aim at providing some degree of anonymity for http clients in the presence of various adversaries , see for example @xcite , @xcite , @xcite and @xcite .",
    "these techniques can be employed to enhance unlinkability .",
    "http is a client  server protocol . at first",
    ", this seems to imply that hidden data can only be forwarded through a chain of alternating clients and servers , all of which have to be participants of the hidden network .",
    "we will show , however , that communication between servers is feasable through standard web  clients which need not be part of the community using the covert protocol .",
    "the concept of covert channels was introduced by b. lampson in 1973 @xcite .",
    "covert channels in the network and transport layers of the tcp / ip protocol were examined by rowland @xcite and fisk et al .",
    "@xcite . using http as substrate for other application level protocols",
    "is discussed in rfc  3205 @xcite , where only overt encapsulation of protocols is considered , naturally .",
    "there are several tools that tunnel protocols through http , mostly for circumvention of firewalls , for example , lars brinkhoff s httptunnel @xcite .",
    "these tools can be used to disguise any protocol as http traffic , but the set of entities in which to hide ( the _ anonymity set _",
    "@xcite ) consists of just the sender and receiver , whereas the constructions listed in section [ s2s ] use real cover traffic , involving unwitting web surfers as cover . in infranet",
    "@xcite , covert channels in http are used to circumvent web  censorship .",
    "web servers participating in the infranet receive hidden requests for censored web pages and return the pages content steganographically hidden in harmless images .",
    "goldberg and wagner s taz and rewebber network @xcite implements anonymous publishing based on http .    in @xcite ,",
    "the authors briefly touch on the subject of unobservability , but conclude that real users would inadvertedly destroy this property .",
    "surveys such as raymond s @xcite mention the concept , but do not point to protocols that provide it .",
    "in this section , we explain how http servers can communicate through clients without the consent or knowledge of the user .",
    "this constitutes a new class of covert channel , which transports data indirectly .",
    "[ s2s ] the main mechanisms inside http / html that allow such data transmissions are :    1 .",
    "redirects [ redir ] 2 .",
    "cookies [ cook ] 3 .",
    "referer headers[ref ] 4 .",
    "html elements [ elem ] 5 .",
    "`` active content '' [ active ]    these features can be employed as follows :      redirects ( rfc 2616 `` 303 '' messages @xcite ) are used to refer the client to another location.[rrr ] the location can be the url of a cgi script , with optional parameters in the query_string @xcite .",
    "this allows cgi scripts to send data in said parameters to other cgi scripts through the browsers of unwitting web surfers .",
    "this channel s capacity is restricted to 1024  url  encoded bytes @xcite .",
    "cookies constitute a mechanism to keep state information on the client side . to advise the client to keep a ( key , value ) pair for further communication",
    ", a server sends a set - cookie : header in the reply to a request .",
    "the value part is allowed to be up to 4 kilobytes long , and the standard specifies that a client must be able to store up to a maximum of 40  cookies per server . in the server  to  server context , we can use optional features to transport data between the servers .",
    "the definition of cookies in rfc 2109 @xcite defines a protocol sub  field domain which carries information about what group of web servers the cookie is to be sent to .",
    "the rfc states that the domain must contain at least two dots if it ends in a three  letter top level domain ( tld ) and at least three dots if it ends in a two  letter tld .",
    "there are a many free dynamic dns services online , most of which provide hostnames in domains with this property , e.g. , all hostnames in the zone administered by dyndns.org are in the same cookie domain .",
    "if a cgi script on server foo.dyndns.org sends a cookie of the form    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ key = value ; domain = .dyndns.org ; path = / ; _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    to a browser and the browser connects to server + bar.dyndns.org , then bar will get foo s ( key , value ) pair . to get the browser to request data objects from bar.dyndns.org ,",
    "the document requested from foo could contain one of the tags mentioned below under `` html elements '' , or contains active content that requests data from bar automatically .",
    "referer headers contain the location of the web page or script that linked to the presently requested one . since the naming of contents can be chosen arbitrarily by a server  and forced upon the browser by automatic requests as described below in subsection [ ht ]  this is another channel between servers through unwitting browsers .",
    "the length restriction of redirects applies here , too .",
    "the hypertext markup language ( html ) version  4 contains elements that cause most browsers to automatically request given documents from http servers .",
    "the following html tags and attributes have this property : +    * frame src = url indicates a part of a frameset . *",
    "iframe src = url defines an embedded frame . *",
    "img src = url defines an inline image .",
    "* script src = url indicates that javascript ( see below ) functions for this page should be loaded from url . *",
    "link href = url indicates out  of  band information for the current page . *",
    "object src = url defines an embedded multi ",
    "media object to load . *",
    "applet codebase = url indicates that java ( see below ) classes for this page should be loaded from url .",
    "* embed src = url defines an embedded multi  media object to load . *",
    "layer src = url defines a transparent layer of this page .",
    "if the html document is created by a cgi script , the url value in the tags above can be set to contain the address of another script together with parameters .",
    "+ the tag / attribute allows embedding of http protocol header fields in the body of an http message .",
    "this is useful for our purposes , because the header thus embedded in the body escapes the inspection of our adversary defined in section [ attack ] .",
    "interesting applications in our context are :    * redirects ( return code  303 @xcite ) inside successful replies ( return code  500 ) : +   + this line of html causes the browser to request + some.html from www.some.org after 3  seconds . * setting cookies without a set  cookie header : +   + this line sets a cookie on the browser , which will be transmitted to every server in the dyndns.org sub  domain to which the browser subsequently connects .",
    "so  called `` active content '' is code that is executed on the client .",
    "currently used languages for active content are sun s java @xcite , netscape s javascript @xcite , macromedia s flash @xcite and microsoft s activex @xcite , the latter being restricted to a single browser , so it will not be discussed here . in java",
    "s design , considerable effort was made to make the execution of untrusted code on the client secure .",
    "java s security framework inhibits connections to servers differing from the one which supplied the running applet , so it can not be used to transmit data to different servers . of the remaining two languages , we chose javascript , because it is more wide ",
    "spread and better documented . running code on unsuspecting surfer s machines opens a number of channels of varying bandwidth between scripts on servers .",
    "to name two examples :    * it is trivial to program redirects to cgi scripts ( with parameters ) in javascript .",
    "* a script may construct an invisible form @xcite , fill the fields with data and send all of it to a cgi script in the body of a post request without user interaction .",
    "this channel allows almost arbitrarily large payloads .",
    "all the above mechanisms are heavily relied on by authors of html documents and cgi scripts .",
    "to demonstrate how a anonymous messaging protocol can use http as cover traffic to achieve unobservability against our adversary , we present a simple chaumian mix .      in our variant of chaum s protocol , the _",
    "muted posthorn _ , four ( not necessarily disjoint ) groups of entities are involved :    * the node maintainers * provide cgi scripts on http servers .",
    "the scripts work as mix nodes and so every script has a @xmath1 pair and a pool for messages to be forwarded .",
    "a script is called with the message as the parameter of a post request .",
    "the scripts work as in chaum s mix networks , i.e. on receipt of a message , they decrypt it and look at headers specifying further processing . in our simple protocol , there are three possible actions , forwarding the message to another node , storing the message in a local mailbox with a supplied name ( a 128  bit number ) , and sending the content of a given mailbox back to the requesting http client . the outward visible action of the scripts is to return either an html document with javascipt code that submits data to another node , or a short , static html document .    *",
    "the linkers * maintain web pages which all seem to contain the same small icon or banner advert .",
    "they do this by including an iframe which includes a frameset on one of the nodes .",
    "the frameset consists of a frame with the image and a second , invisible frame .",
    "this frame is created by a node and either contains the javascript code that does the actual transport , or the short html document .    *",
    "the senders and receivers * use this setup to communicate encrypted messages .",
    "senders construct messages as in recent mix networks , e.g. mixmaster @xcite , but the final delivery address of a message is always a mailbox on a node , and special actions must be taken for the first hop in a chain . a message thus constructed",
    "is sent to the first of the nodes in the chain by sending a post request to a script .",
    "receivers must pull their mailboxes .",
    "they do this by sending encrypted `` send mailbox number n '' requests to the nodes where they keep mailboxes .",
    "* hapless web surfers * just visit the pages maintained by the linkers .",
    "their browsers execute the javascript code returned by the node , transfering messages in the process .",
    "a simple variant of our protocol uses two kinds of messages :    to : messages contain encrypted messages to nodes in the network .",
    "get : messages request mailboxes from nodes .",
    "messages are always padded to a fixed length with randomness . when preparing a message @xmath2 for a sequence of nodes @xmath3 , the sender recursively computes @xmath4 where @xmath5 encrypts message @xmath6 for @xmath7 s public key . for the last node , the to header is omitted .",
    "the sender submits the encrypted message to the last node in a post request .",
    "a receiving node tries to decrypt the message with its secret key .",
    "if decryption succeeds , the resulting text is parsed for headers .    if it is a get message , the node looks up the requested mailbox .",
    "if it exists , the node throws a coin . on @xmath8",
    ", the content is sent  through the requesting client  as a message to a random node in the mix network .",
    "the client can extract the message , for example , from its local browser cache .",
    "on @xmath9 , a fixed html response is sent to the client .",
    "if the mailbox does not exist , again a coin is tossed , this time to decide whether to send a randomly chosen message from the pool through the client or the html response .",
    "if it is a to message , the address is examined . if it is a mailbox number , the message is stored in it .",
    "if the addressee is a url , the message is put in the message pool for further delivery .",
    "again , a coin throw decides whether a randomly chosen message from the pool or the fixed html response is returned to the client .    against a passive observer as the adversary defined in section [ attack ]",
    ", this protocol provides unobservability .",
    "senders of messages and requesters of mailboxes send http get requests as any harmless client . upon receipt of the javascript document ,",
    "they substitute their own messages for the ones set inside the javascript code , and then let the browser execute the code .",
    "an observer who is restricted to the ip / tcp / http headers thus can not distinguish between harmless browsers and senders / receivers .",
    "this increases the anonymity set by the noninvolved web surfers .",
    "the simple protocol above is susceptible to a trivial denial of service attack .",
    "an adversary can simply request the frameset from a node repeatedly to drain its message pool .    to defend against this attack ,",
    "we introduce acknowledgements for received messages ( acks ) between the nodes .",
    "each message is kept in the pool and is re  sent until an ack for the message is received .",
    "acks are not sent immediatly , but are put in the message pool themselves .",
    "an ack should be tied to the message it acknowledges and to the node the message was addressed to , to avoid forged acks and replays .",
    "the standard approach would be to sign acks with the node s secret key . but deploying digital signatures at all would imply that the nodes know each other s public keys .",
    "experience with remailers , however , shows that knowledge about such a global state of the mix network is hard to achieve . for this reason we would like to avoid all public key operations at the nodes , except decryption .",
    "our suggestion is to send the hash of the decrypted text as ack to the previous node ( to make them indistinguishable from other messages , acks are padded with randomness to the fixed message size ) .",
    "the original sender knows all intermediate messages on the path , since she constructs them layer by layer .",
    "so she can inform every node on the path about what ack to expect .",
    "she does this by including the acks as values of additional ack headers .",
    "the rule for constructing the next layer is now : @xmath10    a node keeps three tables : the message pool of outgoing messages , a list of outstanding acks and a list of mailboxes ( see figure  [ fig1 ] ) .    on receipt of a message , a node checks if it is an acknowledgement",
    "this is done by inspecting the first @xmath11  bits of the message , where @xmath12 is the cryptographic hash function used for acks .",
    "the resulting block is checked against the table of outstanding acks .",
    "if the block matches , the ack itself and the message corresponding to it are removed from the table and the pool , respectively .",
    "note that the url of the sending node is transmitted by the client in the referer header .",
    "when processing to messages , the node now creates an entry in its ack table with the value of the ack header .",
    "the node computes the hash of the decrypted message and constructs an ack message for the node that sent the message      the protocol inherits practical advantages from http .",
    "all transactions of senders , receivers and unwitting web surfers can be performed through http anonymizing systems such as anonymizer @xcite , crowds @xcite or jap @xcite .",
    "the protocol s traffic is typically not blocked or modified at firewalls , and passes though network address translation @xcite without problems .",
    "the coin tossing on the nodes makes the auto  submits terminate after two repetitions , in the mean . for a fixed message size of four kilobytes ,",
    "the resulting traffic for the client is about the same as that for a banner advertisement ( typically 16  kb ) .",
    "although the idea of a mix network with an enlarged anonymity set seems promising , a number of open problems and possible enhancements must be discussed .",
    "_ do acknowledgements ( or lack thereof ) introduce new points of attack ?",
    "if a node does not receive an ack for a message , it will re - send the message at some later time .",
    "the repeating pattern marks it as being a message as opposed to an ack or randomness .",
    "_ user behaviour influences the timing of message delivery .",
    "_ this could lead to a trickle @xcite attack . to reduce this influence ,",
    "a node could send randomness of appropriate size to a randomly chosen node , if a client connects but the node s batching strategy does not dispatch a message from the pool .",
    "this would allow reuse of most of the known pooling algorithms .    _",
    "the time a message spends in the mix network before final delivery is dependent on external factors _ , namely the whims and inclinations of unknown web surfers , and the willingness of web  site maintainers ( linkers ) to place links to the nodes on their pages . should all the linker s pages become unpopular at some point , communication would stop entirely .",
    "one way around this problem would be to combine the mix network with an internet advertising company .",
    "the advertisements ( placed in iframes ) would show ads while at the same time transporting data between the different servers of the advertising company .",
    "if cookies are used as the channel of communication , it would not be noticeably different from what doubleclick inc .",
    "is doing now @xcite .",
    "_ can we achieve unobservability against a global observer _ who inspects complete data payloads , instead of just the headers ?",
    "universal re ",
    "encryption @xcite offers a solution .    in universal re  encryption ,",
    "a third party ( the unwitting clients , in our case ) can change the random factor in a probabilistic public key encryption , and the following properties hold :    1 .",
    "the third party does not need to know the public key with which the message is encrypted .",
    "2 .   for two given encrypted messages , after re  encryption ,",
    "an adversary can not tell which of the outputs corresponds to which original encryption .    in @xcite ,",
    "p. golle et al .",
    "show how universal re  encryption can be implemented with el ",
    "gamal and a public @xmath13 @xmath14 pair .",
    "they also show how re  encryption can be extended to hybrid encryption schemes , where the public key scheme is used to encrypt a session key and the message itself is encrypted with a symmetric cipher and the session key .",
    "unfortunately , javascript has no built  in functions for arithmetic of large numbers nor symmetric ciphers , and implemented in javascript , they would be extremely slow .",
    "java , however , offers the math.biginteger and securerandom classes necessary for implementing the re  encryption algorithm .",
    "inconsistent with the security requirements of java , standard browser implementations allow javascript to call public methods and variables of java objects .",
    "javascript in turn can be used to submit the re  encrypted message to the next node , as in the protocol above .",
    "the global observer would see a random  looking message delivered to the client and another random  looking message from the client to the next node . because of the properties of el ",
    "gamal ( and the symmetric cipher in the case of hybrid encryption ) , the observer can not distinguish real messages from randomness .",
    "because of the properties of universal re  encryption , she can only guess whether the outgoing message is a re  encryption of the received one or a completely new message substituted by the client . inspection of the http body does not help to distinguish senders and receivers from unwitting web surfers .",
    "universal re  encryption also remedies the problem of repeated messages , mentioned above .",
    "the node would re  encrypt the message in the pool before sending , so that observable messages are always different .",
    "privacy is of growing concern for users of the internet s services .",
    "existing privacy enhancing technologies can assure anonymity only if the anonymity set is sufficiently large . in most current protocols , the size of the anonyity set",
    "is bounded by the number of the active users of a protocol . after defining a reasonable adversary model",
    ", we showed how the anonymity set of a protocol can be enlarged by having non  participants generate cover traffic .",
    "we presented new covert channels in the most wide  spread protocol on the internet , the hypertext transfer protocol , and proceeded to describe a simple chaumian mix based on cgi scripts , in which the anonymity set consist of senders , receivers and unknowing participants , thereby enhancing anonymity for the senders and receivers .",
    "we explained remaining problems of our protocol and suggested areas for future research .",
    "we thank niels provos , marius aamodt eriksen , andrei serjantov and roger dingledine for helpful suggestions and comments .",
    "traffic analysis attacks and trade - offs in anonymity providing systems . in _",
    "information hiding ( ih 2001 ) _ ( 2001 ) , i.  s. moskowitz , ed . , springer - verlag , lncs 2137 , pp .",
    "http://www.cypherspace.org/adam/pubs/traffic.pdf .",
    "web mixes : a system for anonymous and unobservable internet access . in _",
    "designing privacy enhancing technologies .",
    "workshop on design issues in anonymity and unobservability _ ( 2001 ) , h.  f. ( ed . ) , ed . ,",
    "springer , pp .",
    "115129 . 2009 .",
    "traffic analysis : protocols , attacks , design issues and open problems . in _ designing privacy enhancing technologies : proceedings of international workshop on design issues in anonymity and unobservability _ ( 2001 ) , h.  federrath , ed .",
    ", springer - verlag , pp .",
    "1029 . 2009"
  ],
  "abstract_text": [
    "<S> this paper presents new methods enabling anonymous communication on the internet . </S>",
    "<S> we describe a new protocol that allows us to create an anonymous overlay network by exploiting the web browsing activities of regular users . </S>",
    "<S> we show that the overlay network provides an anonymity set greater than the set of senders and receivers in a realistic threat model . </S>",
    "<S> in particular , the protocol provides unobservability in our threat model .    [ security and protection ] [ privacy ] </S>"
  ]
}