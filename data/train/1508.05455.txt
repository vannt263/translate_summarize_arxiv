{
  "article_text": [
    "the solar coronal magnetic field produces solar activity , including extremely energetic solar flares and coronal mass ejections .",
    "there is considerable interest in accurate modeling of magnetic fields in and around active regions on the sun , the locations of the most intense coronal fields and the drivers of flares and many mass ejections , with the aim of better understanding the physics underlying magnetic energy release , and improving the ability to predict space weather storms caused by large events .",
    "a popular model for the coronal magnetic field @xmath0 is the nonlinear force - free field ( nlfff ) model ( see the reviews by @xcite and @xcite ) , which assumes a static configuration with a zero lorentz force , @xmath1 where @xmath2 is the electric current density , together with the solenoidal condition , @xmath3 the model current density is everywhere parallel to the magnetic field , and equation  ( [ eq : force - free1 ] ) is often written @xmath4 where @xmath5 is the force - free parameter .",
    "the proper boundary conditions on the model are the specification of the normal component of the field @xmath6 over the bounding surfaces of the solution domain , together with the normal component of the electric current density @xmath7 ( or , alternatively , @xmath5 ) over one polarity of the field in the boundary ( i.e. , either over the region where @xmath8 or over the region where @xmath9 )  @xcite . the current density is only required over one polarity of the field because current density streamlines follow magnetic field lines , so values of @xmath7 at one polarity are `` mapped '' to the other polarity by the geometry of the field lines of the solution . stated another way , taking the divergence of equation  ( [ eq : force - free2 ] ) and applying the solenoidal condition yields the general property @xmath10 which indicates that @xmath5 is invariant along magnetic field lines ( though @xmath5 may be different from line to line ) . in the following , we consider the problem in a half space ( @xmath11  0 ) , with the plane @xmath12  =  0 representing the base of the ( assumed force - free ) corona .",
    "this geometry neglects solar curvature , which is appropriate for the local modeling done in this study .",
    "solar observations provide a set of boundary data for application of the model .",
    "spectro - polarimetric measurements of magnetically sensitive lines  @xcite are used to construct vector ( three - component ) magnetogram data that are presumed to be located on a planar surface representing the top of the photosphere .",
    "the vertical current density @xmath13 may be estimated from such vector magnetogram data using @xmath14_{z=0},\\ ] ] provided the 180-degree ambiguity in the direction of the field transverse to the line of sight is resolved @xcite .",
    "vector magnetogram data are now routinely produced by ground based instruments , and more recently have been provided by two space - based vector magnetographs : the solar optical telescope / spectro - polarimeter ( sot - sp ) on the hinode satellite  @xcite , and the helioseismic and magnetic imager on the solar dynamics observatory ( sdo / hmi ; @xcite ) .",
    "the use of such vector magnetogram data for nlfff modeling builds on earlier work done with data from the haleakala stokes polarimeter ( hsp ) , the imaging vector magnetograph ( ivm ) , the solar flare telescope ( sft ) , and the advanced stokes polarimeter ( asp ) in the previous decades ( e.g. , @xcite ) .",
    "the earliest vector magnetogram data possessed spatial resolutions of multiple arc seconds , whereas the hinode / sot - sp magnetogram data have a resolution as high as 032 .    in practice , however , additional modeling assumptions are needed in order to use vector magnetogram data with nlfff modeling .",
    "one problem is that the boundary conditions on @xmath13 ( or @xmath5 ) are inconsistent with the nlfff model over the two polarities of @xmath15 @xcite .",
    "additionally , boundary data are not available at the top and side surfaces of the three - dimensional solution domain .",
    "furthermore , the vector magnetogram measurements contain uncertainties .",
    "the polarization measurements are subject to observational uncertainty , and the process of determining magnetic field values by inverting the stokes polarization spectra involves making various assumptions about the radiative transport of polarized radiation through the magnetized solar atmosphere .    given the scientific importance of determining the free energy in the solar coronal magnetic field , coupled with the recent increase in availability of vector data over the past decade , a sequence of yearly workshops was organized between 2004 and 2009 in an effort to characterize and improve nlfff modeling .",
    "the workshops demonstrated that nlfff methods work for analytic test cases and for synthetic , solar - like test data , but encounter specific problems in application to photospheric vector magnetogram data  @xcite .",
    "there are a number of different methods of solution of the nlfff model in use , which were found to produce significantly different results .",
    "discrepancies include the locations and magnitudes of currents within the solution volume , and the total magnetic energy in the solution domain .",
    "issues identified during these studies include the inconsistency of photospheric vector magnetogram data with the nlfff model , the possibility that high spatial - resolution data are needed to account for small - scale currents , the limited field of view of the data , and the lack of account of the substantial uncertainties in the boundary field values .",
    "more recently , additional nlfff modeling workshops were held to address these issues . in this article , we follow up on one such issue and characterize the influence of the spatial resolution of vector magnetogram data on the results of the modeling .",
    "examining this issue at this time is motivated by the increasing availability of vector data from various space- and ground - based instrumentation , all of which provide vector data at different spatial resolutions .",
    "for instance , the national solar observatory s synoptic optical long - term investigations of the sun vector spectromagnetograph instrument ( solis / vsm ) provides full disk data with a spatial sampling of 1@xmath161 @xcite , while sdo / hmi full - disk vector magnetograms have a pixel size of 0@xmath165 @xcite , and `` normal - map '' and `` fast - map '' hinode / sot - sp data are sampled at 0@xmath1616 and 0@xmath1632 respectively @xcite .    to assess the sensitivity of the results of nlfff modeling to variations in spatial resolution , we use data for noaa active region ( ar ) 10978 .",
    "vector magnetograms are constructed from a hinode / sot - sp normal - map scan of this region , with the spatial resolution of the data artificially degraded by a sequence of binning factors .",
    "the methodology is to perform inversions on rebinned polarization spectra ( as opposed to simply rebinning the resulting vector data inverted from spectra at the native hinode / sot - sp resolution ) in order to approximate observations of ar  10978 by instruments having different spatial resolutions . in common with the earlier workshop studies ,",
    "we apply a number of different methods of solution of the nlfff model in order to also gauge the dependence of the results on the solution method .",
    "the effects of spatial resolution on coronal field modeling have been discussed in several earlier studies . @xcite claimed that the concentration of photospheric magnetic fields into unresolved fibrils renders currents inferred from vector magnetograms meaningless , but @xcite argued in response that it is only necessary to resolve the large - scale twist in the field to correctly infer the current .",
    "@xcite presented a method for inferring @xmath17 ( for observations at disk center ) that is independent of the ambiguity resolution , and argued for the reality of electric currents obtained using this method applied to asp data .",
    "more recently , @xcite investigated the influence of noise and spatial resolution on the ambiguity resolution step in the treatment of vector magnetogram data ( see also @xcite , @xcite , and @xcite ) . a hare - and - hounds exercise was run on an analytic test case , and it was shown that failure to resolve observed structures due to low resolution leads to serious errors in ambiguity resolution .",
    "@xcite also looked at the results of artificial degradation of hinode / sot - sp data on vector magnetic field values , including degrading observed stokes spectra , and using full - resolution spectra but degrading the field values derived from the spectra .",
    "they examined , in particular , the effect of these steps on the statistics of the derived fields .",
    "they found that degraded resolution data can exhibit increased average flux densities , lower total flux , and field vectors shifted towards the line of sight .",
    "the distribution of @xmath13 was found to be very sensitive to the spatial resolution .",
    "recently @xcite compared nlfff reconstructions for an active region based on hinode / sot - sp and sdo / hmi data , including calculations for the hinode data at original resolution and rebinned to match the hmi data .",
    "they found similar results for the different - resolution data from hinode , but significantly different results for data between the two instruments , in particular , e.g. , differences in magnetic connectivity .",
    "we note that @xcite rebinned vector magnetogram field values , rather than rebinning the original hinode / sot - sp spectral data as is done in the experiments presented here . rebinning the spectra was shown in @xcite to produce different vector magnetogram values than rebinning the field values .",
    "these earlier studies motivate the present investigation of the influence of resolution on nlfff modeling .",
    "the structure of the paper is as follows . in section  [ sec : data - methods ]",
    "the data used and the different methods are presented , with section  [ subsec : data ] describing the preparation of the different resolution vector magnetograms , and section  [ subsec : codes ] explaining the methods of solution of the nlfff model , and their treatment of boundary conditions . in section  [ sec : results ] we present a quantitative analysis of the energy and relative magnetic helicity of the resulting solution fields ( section  [ subsec : results - energy - helicity ] ) , including assessment of non - solenoidal field errors , and an analysis of how the solution methods alter the vector magnetogram boundary data ( section  [ subsec : results - bc - changes ] ) . in section  [ sec : conclusions ] , results are discussed and conclusions drawn .",
    "an ideal active region for this study would be one that is flux - balanced and is mostly isolated , shows evidence of nonpotentiality , is located near disk center , is small enough for the full active region to be observed with high - resolution spectropolarimetry , and has accompanying high - resolution coronal imagery suitable for comparisons between coronal loops and the field lines from the resulting extrapolations .",
    "unfortunately , no such target satisfying all of these criteria was found from archive data . as a result , we prioritized the requirements for the nonpotentiality , location , isolation , and size for the magnetic field , and present in section  [ sec : results ] performance metrics that do not rely on coronal loop data .",
    "although some data from both the x - ray telescope ( xrt ) on hinode and the transition region and coronal explorer ( trace ) instrument were available , there were an insufficient number of distinct and discernible loops for useful analysis .",
    "based on the above specifications , noaa  ar  10978 was selected from the archive of hinode / sot - sp observations .",
    "the sot - sp instrument returns full stokes spectra for the doublet at approximately 630.2  nm with high spectral sampling ( 2.15  pm ) .",
    "polarization spectra for ar  10978 were obtained in normal - map mode on 2007 december  13 , 12:1813:41  ut    over a field of view of approximately 164@xmath18164@xmath19 ( on a 1024@xmath201024 grid ) , with high spatial sampling ( 0@xmath1616 ) both along the slit and in the direction of the scan .",
    "figure  [ fig1](a ) shows a magnetogram of ar  10978 from the michelson doppler interferometer ( mdi ; @xcite ) on board the solar and heliospheric observatory ( soho ) on 2007 december  13 .",
    "the region is isolated , being the only numbered active region on the disk at the time .",
    "the inset in figure  [ fig1](b ) shows the soft x - ray emission from the core of the region , as observed by hinode / xrt .",
    "the core of the active region , where the strongest vertical currents ( of critical importance to nlfff modeling ) are often located , lies within the hinode / sot - sp scan area , which is demarcated by the white boxes in figures  [ fig1](a ) and  ( b ) .",
    "figures  [ fig1](c ) and  ( d ) illustrate the continuum intensity and the longitudinal magnetic field from hinode / sot - sp .",
    "the region is sufficiently small to allow the hinode field of view to encompass most of the magnetic flux .    in the middle of its disk passage ,",
    "ar  10978 possessed a hale classification of @xmath21 , indicating a high degree of flare productivity , and indeed almost 30 soft x - ray flares are attributed to the region in the national geophysical data center goes soft x - ray event lists over the course of its observed history on the solar disk .",
    "all were relatively small and short events .",
    "the largest flare was a very short and impulsive c4.5 flare which occurred at 09:39  ut on 2007 december  13 , a few hours before the hinode / sot - sp normal - map scan used here was recorded .",
    "additionally , the region produced a c1.0 flare within the hour following the completion of the scan .    in this study , we construct a set of vector magnetograms from the chosen hinode / sot - sp scan of ar  10978 in order to investigate the effects of spatial resolution on the subsequent nlfff extrapolations .",
    "vector magnetograms are prepared at near - hinode normal - map resolution , and also at spatial resolutions lowered by factors ranging from 2 to 16 .",
    "the northernmost 25% of the hinode field of view ( mostly containing quiet sun ) is excluded in order to make the subsequent nlfff extrapolations more computationally tractable .",
    "the region considered for modeling is contained within the dashed box in figure  [ fig1](d ) .    because the codes used for nlfff modeling in this paper assume a cartesian geometry",
    ", it is necessary to project the hinode data onto a regular helioplanar grid .",
    "the field of view of the hinode observations is small relative to the solar radius , making the effects of curvature small , and as a result this remapping is not expected to significantly affect the modeling results . during the remapping process , @xmath0 is reprojected so that it appears as if the active region were located at disk center .",
    "the resulting set of remapped vector magnetograms span a region approximately 168  mm@xmath20124  mm in size .",
    "the local helioplanar coordinates are denoted @xmath22 , with @xmath23 denoting solar west direction , @xmath24 solar north , and @xmath12 the vertical direction .",
    "the procedure followed in preparing the vector magnetogram data at each resolution level is as follows : ( 1 ) the level-1 hinode / sot - sp polarization spectra are rebinned by the specified factor ; ( 2 ) a spectral inversion using the high altitude observatory milne - eddington inversion code @xcite is performed ; ( 3 ) the 180@xmath25 disambiguity is resolved using the northwest research associates `` me0 '' minimum energy algorithm @xcite ; ( 4 ) helioplanar components of @xmath0 , and values for the vertical component of the current density @xmath13 and force - free parameter @xmath26 , are calculated ; and ( 5 ) the resulting values are remapped ( interpolated ) onto a regular and uniformly spaced helioplanar grid .    throughout this article",
    ", we refer to the various vector magnetograms by the factor by which the observed polarization spectra are rebinned in step ( 1 ) .",
    "for example , `` bin  2 '' data are rebinned by a factor of two in each dimension , `` bin  3 '' data are rebinned by a factor of three in each dimension , etc .",
    "we also retain a `` bin  1 '' dataset that is prepared without any rebinning .",
    "the grid and pixel sizes for these data as a function of the bin level are summarized in the first three columns of table  [ table - vmag ] .",
    "cccccccc    1 & 1129@xmath20837 & 0.106 & 0.030 & 8.3@xmath2010@xmath27 & 1.1@xmath2010@xmath28 & 0.37 & 2.4@xmath2010@xmath29 + 2 & 564@xmath20418 & 0.212 & 0.026 & 9.7@xmath2010@xmath27 & 1.1@xmath2010@xmath28 & 0.37 & 2.4@xmath2010@xmath29 + 3 & 375@xmath20278 & 0.318 & 0.024 & 3.6@xmath2010@xmath27 & 1.1@xmath2010@xmath28 & 0.36 & 2.5@xmath2010@xmath29 + 4 & 282@xmath20209 & 0.424 & 0.026 & 9.3@xmath2010@xmath27 & 9.5@xmath2010@xmath30 & 0.36 & 2.4@xmath2010@xmath29 + 6 & 187@xmath20138 & 0.635 & 0.024 & 4.8@xmath2010@xmath30 & 8.2@xmath2010@xmath30 & 0.36 & 2.5@xmath2010@xmath29 + 8 & 141@xmath20104 & 0.847 & 0.026 & 5.1@xmath2010@xmath30 & 5.9@xmath2010@xmath30 & 0.35 & 2.7@xmath2010@xmath29 + 10 & 112@xmath2082 & 1.06 & 0.031 & 8.8@xmath2010@xmath30 & 5.8@xmath2010@xmath30 & 0.35 & 2.6@xmath2010@xmath29 + 12 & 93@xmath2068 & 1.27 & 0.029 & 7.7@xmath2010@xmath30 & 7.3@xmath2010@xmath30 & 0.35 & 2.8@xmath2010@xmath29 + 14 & 80@xmath2058 & 1.48 & 0.030 & 1.4@xmath2010@xmath28 & 6.0@xmath2010@xmath30 & 0.35 & 2.8@xmath2010@xmath29 + 16 & 70@xmath2052 & 1.69 & 0.038 & 1.6@xmath2010@xmath28 & 5.0@xmath2010@xmath30 & 0.35 & 2.9@xmath2010@xmath29 +    [ table - vmag ]    uncertainties are provided for the components of @xmath0 , for @xmath13 , and for the force - free parameter @xmath5 , based on propagation of uncertainties from the inversion and disambiguation steps .",
    "the disambiguation uncertainties comprise azimuthal errors of 180@xmath25 assigned to points where multiple trials of the disambiguation code produced different results with a frequency greater than 10% when the optimization procedure used is seeded with different sets of random numbers .",
    "figure  [ fig2 ] illustrates the reprojected vector magnetogram data .",
    "the figure shows maps of @xmath15 and @xmath13 for the bin  1 and bin  8 data ( with the @xmath13 values shown only for points where the signal - to - noise ratio in @xmath5 is greater than  0.25 ) .",
    "we have set @xmath31 at points in the reprojected coordinate system that lie outside of the hinode field of view ( such points are located at the eastern and western edges of the remapped data ) .",
    "the dashed boxes in the figure correspond to the region used for comparing nlfff extrapolations in section  [ sec : results ] , and is slightly smaller than the remapped field of view .",
    "as expected , figure  [ fig2 ] shows that large - scale structures present in @xmath13 at the photosphere are retained in the reduced - resolution data ( albeit with a smaller magnitude ) , but structures on scales below the reduced resolution limit are lost .",
    "the structure of the magnetic field , which is inferred from the rebinned polarization spectra , is affected by the spatial resolution , sometimes in non - intuitive ways . some of the trends depend on the underlying structure . to illustrate this effect , we use continuum intensity maps from hinode / sot - sp to segment the boundary data into umbral and penumbral regions . figure  [ fig : continuum_contours](a )",
    "shows a bin  1 continuum intensity image with contours outlining umbral and penumbral regions overlaid . when downsampling the contours from the bin  1 data down to the resolution of the bin  16 data and comparing with the rebinned intensity image , as shown in figure  [ fig : continuum_contours](b ) , differences between the downsampled contours and the locations of umbral and penumbral pixels are evident .",
    "this effect is especially noticeable in regions in the bin  1 data where small - scale features are present , leading to the classification of some pixels determined to be in the umbral region in the bin  1 image being identified as penumbral in the bin  16 image .",
    "figure  [ fig : boundary_var ] shows how the magnetogram - averaged absolute vertical flux density @xmath32 , absolute horizontal flux density @xmath33 , @xmath17 , and @xmath5 vary as the spatial resolution changes . in the set of plots ,",
    "the inferred values of these quantities are plotted as a function of spatial resolution in two ways , depending on whether the contours used in the segmentation are determined from the rebinned continuum images or are determined from downsampling those from the high - resolution bin  1 image .",
    "the differences between the two pairs of curves in @xmath34 and @xmath35 ( figs .",
    "[ fig : boundary_var](a ) and ( b ) ) as a function of resolution are often due to the spatial resolution affecting whether pixels are classified as being within the umbral or penumbral contours .",
    "more strikingly , the average vertical current densities @xmath36 are seen to decrease as the spatial resolution decreases , indicating that the vertical currents often have structure on small scales .",
    "this effect also affects the trend in @xmath5 , with both umbral and penumbral values getting closer to zero ( i.e. , potential ) as the spatial resolution decreases .",
    "the penumbral and umbral values of @xmath5 possess different signs for most bin levels , though the mean @xmath5 value in penumbral areas changes sign as the boundary data become less resolved .",
    "table  [ table - vmag ] lists values of the net magnetic flux @xmath37 , and the components @xmath38 ( with @xmath39 ,  @xmath24 ,  @xmath12 ) of the magnetic force on the coronal volume , as a function of the bin level .",
    "the flux is calculated by integrating @xmath15 over the magnetogram area , and the force components are obtained by performing the integrals in @xcite , which are derived from moments of equation  ( [ eq : force - free2 ] ) . the net flux @xmath37 is expressed as a fraction of the unsigned magnetic flux @xmath40 ( the integral of @xmath32 over the magnetogram area ) , and the force components are in units of @xmath41 , the integral of the magnetic pressure over the magnetogram area .",
    "the net flux is zero if the observed area is in flux balance , and the force components vanish if the boundary data are consistent with the nlfff model .",
    "the values in the table indicate that the region is close to flux - balanced .",
    "the region has relatively small horizontal force components and larger vertical forces ( cf .",
    "@xcite ) .",
    "many methods of solution of the nlfff equations exist . in the study presented here , implementations of three such methods",
    " the optimization , magnetofrictional , and grad - rubin methods  are applied to the sequence of vector magnetogram data described in section  [ subsec : data ] .",
    "altogether there are five codes ( one code implementing the optimization method , one code implementing the magnetofrictional method , and three codes implementing the grad - rubin method in different ways ) .",
    "each of the five codes solves for a nlfff on a uniform three - dimensional cartesian grid with equal grid spacing in each dimension .",
    "the grids used are defined by the helioplanar vector magnetogram boundary data at the lower boundary and the choice of a vertical height for the grid .",
    "the codes differ in how they incorporate the vector magnetogram data at the lower boundary , and how they use the information provided by the uncertainties in the data .",
    "the boundary conditions at the side and top of the computational domain are not constrained by the observational data , and as a consequence the different codes handle boundary conditions at these surfaces in different ways . in the following subsections , we briefly describe each of the specific codes used in this study .      the optimization method is a relaxation scheme that seeks to minimize a volume integral such that , if the integral becomes zero , the field is divergence- and force - free . in its original form @xcite , the method proceeds as follows .",
    "an initial magnetic field is chosen in the computational volume , and lower boundary values are replaced by the required vector boundary conditions @xmath0 .",
    "the field is evolved forward using equations that minimize a functional containing the magnitudes of the lorentz force and of the divergence of @xmath0 .",
    "the process is halted when the field reaches an approximately steady state .",
    "the optimization solutions discussed here are based on the algorithm described in @xcite and @xcite , which includes several modifications to the original method .",
    "as discussed in @xcite , the optimization solutions are found to improve when a preprocessing scheme is applied to the vector boundary data .",
    "preprocessing reduces the magnitude of the integrals representing the boundary - integrated magnetic force and torque ( which necessarily vanish for a nlfff ) , subject to penalty functions that simultaneously aim to preserve agreement with the observed vector magnetogram data .",
    "spatial smoothing is also applied to the boundary data .",
    "the specific preprocessing scheme used here involves four weighting parameters that determine which constraints are most closely met .",
    "the values used here are @xmath42 and @xmath43 , where the weighting parameters are as described in equation  ( 6 ) in @xcite .",
    "additionally , modifications of the lower boundary values are permitted during the optimization process , implemented by including an additional optimization term in the functional that takes into account the measurement uncertainties in the vector magnetogram data .",
    "this term allows more substantial changes to the components of the field at points where the associated uncertainties are larger .",
    "these changes are controlled by a two - dimensional weighting matrix @xmath44 in an optimization integral over the lower boundary , as described in @xcite .",
    "the modified optimization method also includes three - dimensional weighting functions @xmath45 and @xmath46 in the functionals for the volume - integrated lorentz force and divergence ( see equation  ( 4 ) of @xcite ) .",
    "these weights @xmath47 and @xmath48 are set to unity in the entire model volume , except for finite boundary layers adjacent to the lateral and top boundaries of the computational volume , where they smoothly approach zero .",
    "this causes the solution obtained by the method to remain fixed at the boundary values prescribed by the initial field , and introduces buffer regions at the side and top boundaries where the solution field may depart from a force - free and divergence - free state .",
    "these buffer regions are excluded from the analysis in section  [ sec : results ] .",
    "another feature of the optimization code used here is a grid - refinement scheme .",
    "the scheme entails applying the optimization code on coarser grids , the solutions of which are then used to initialize the optimization algorithm on successively more refined grids . typically several refinement levels are used .",
    "the series of increasingly more refined grids is started by using a potential field to initialize the coarsest grid .",
    "this scheme has been shown in earlier studies to improve the quality of the resulting solutions to the nlfff model , and decreases the running time of the full calculation .",
    "magnetofrictional codes evolve the magnetic induction equation using a velocity field that advances the solution to a more force - free state ( e.g. , @xcite ) .",
    "the magnetofrictional code used here is described in @xcite , and its application to solar data is presented in @xcite .",
    "the magnetofrictional method uses the full vector field over the entire lower boundary as boundary condition , taking as input preprocessed vector magnetogram data .",
    "both the horizontal and vertical components of @xmath0 may be adjusted during the preprocessing stage to make the boundary data more compatible with the force - free model , although changes in the boundary data are constrained to be within certain limits @xcite . as the field",
    "is evolved forward in time , the boundary conditions at the side and top boundaries are constructed by the code at each iteration of the magnetofrictional relaxation method using the neighboring volume values of the field at the previous iteration @xcite . the construction uses first order polynomial interpolation , and requires that the solenoidal condition is met at the boundary points , and that the lorentz force falls to zero at ghost points just exterior to the volume .",
    "a grid - refinement strategy analogous to that used in the optimization code is also used here .",
    "the domain having the coarsest refinement is initialized using a potential magnetic field with values of @xmath15 matching the initial preprocessed lower boundary values , and subsequent , more refined domains are initialized using the resulting fields from the less refined solutions .    for this particular active region ,",
    "the magnetofrictional extrapolations of the full field of view at all tested resolutions developed abnormally strong but stable large - scale currents near the northern lateral boundary .",
    "such behavior is unusual , and remained even after tuning the parameters of the algorithm . as a result , additional cropping of the magnetogram at the northern side",
    "was performed before running the magnetofrictional models shown here . in all but the case using bin",
    "3 boundary data , the cropped magnetograms allowed the preprocessing algorithm to produce more compatible ( more force - free ) boundary conditions for the extrapolation code , and the resulting extrapolated fields did not develop any unusual current at the northern lateral boundary . for the bin  3 case , even this additional cropping did not yield a consistent preprocessed boundary condition , and consequently this case is omitted from the analyses presented in section  [ sec : results ] .",
    "three different implementations of the grad - rubin method are used .",
    "these are the cfit code  @xcite ; the xtrapol code ( as described in @xcite and with the boundary conditions given in @xcite ) ; and the femq code  @xcite .",
    "a brief account of the specific implementations and boundary conditions is given here .",
    "grad - rubin methods take as boundary conditions the normal component of the field in the boundary and the value of the force - free parameter @xmath5 over one polarity of the field in the boundary . since there are two choices of polarity there are two solutions , which are in general different if the boundary data are inconsistent with the force - free model .",
    "we present both solutions for all grad - rubin codes in this paper , using @xmath49 and @xmath50 to denote solutions with @xmath5 chosen from positive- and negative - polarity regions in the lower boundary , respectively .",
    "grad - rubin methods involve updates to both  @xmath0 and  @xmath51 at each iteration , involving the solution of linear hyperbolic and elliptic partial differential equations , respectively .",
    "the cfit code performs the update to  @xmath51 by propagating lower boundary values of @xmath5 along numerically traced field lines .",
    "the update to  @xmath0 is achieved by solving the poisson equation for the vector potential for the field using a two - dimensional fourier transform method , with transforms in the  @xmath23 and  @xmath24 directions .",
    "solutions from the code are correspondingly periodic in  @xmath23 and  @xmath24 .    with the cfit code ,",
    "the lower boundary conditions on the field are the values of  @xmath15 from the vector magnetogram data .",
    "boundary conditions on  @xmath5 are chosen as follows .",
    "values of  @xmath5 calculated using equation  ( [ eq : vmag_jz0 ] ) are used at a given boundary point provided the signal - to - noise ratio is at least 5% , based on the uncertainties provided with the data , and provided the boundary point does not exhibit a large localized spike in @xmath5 .",
    "boundary points not meeting these criteria are assigned values @xmath52 .",
    "this procedure is referred to as `` censoring '' of the boundary data .",
    "additionally , during the grad - rubin iteration procedure , points in the domain that are threaded by field lines that intersect the top or side boundaries are assigned @xmath53 to ensure @xmath54 globally . as a result ,",
    "boundary points in such open - field regions are treated as having @xmath53 , however the regions of open and closed field lines generally change as the calculation proceeds , and consequently boundary points that are thus censored at one iteration may not be censored at another .",
    "the iteration is initiated with a potential field in the volume with values of @xmath15 matching the vector magnetogram at the lower boundary values , obtained by a two - dimensional fourier transform solution .",
    "the cfit code is parallelized using both the openmp @xcite and mpi @xcite standards .",
    "further details on the solution method and the handling of boundary conditions are given in @xcite .",
    "the xtrapol code solves a mixed elliptic - hyperbolic boundary - value problem for @xmath5 and @xmath0 , which is mathematically well posed  @xcite .",
    "it uses a finite - difference approach with a representation of @xmath0 based on a vector potential @xmath55 ( defined with a convenient gauge ) on a staggered mesh .",
    "this ensures that the divergence operator remains exactly on the kernel of the curl operator ( and thus @xmath56 to rounding errors ) , independently of the mesh resolution .",
    "it solves iteratively the elliptic problem through a positive definite linear system , and the hyperbolic problem by transporting @xmath5 along the characteristics ( the magnetic field lines ) , imposing @xmath5 originating from only one or the other polarity .",
    "the code uses the mpi library .",
    "the solution can be provided for both balanced or non - balanced photospheric magnetic flux , in which case field lines can intersect other external boundaries .",
    "see  @xcite for more details .",
    "the femq code solves the same well posed boundary - value problem as xtrapol .",
    "however femq uses a finite - element approach , and works directly with @xmath0 using a least - squares approach that minimizes the divergence of @xmath0 .",
    "the hyperbolic equations at each iteration can be solved either using the same method as in xtrapol or by solving a non - positive - definite linear system for @xmath5 by an iterative method .",
    "more details can be found in  @xcite .",
    "this section presents quantitative comparisons amongst the extrapolated solution fields and characterizes the effects of the spatial resolution of the boundary data on the solutions .",
    "we analyze the energy and helicity of the solutions and discuss the departure of the lower boundary field values in the resultant solutions from the vector magnetogram values .",
    "the magnetic energy analysis includes a helmholtz decomposition of the solution fields into solenoidal and non - solenoidal components , following the procedure of @xcite , and a discussion of the effects of the non - solenoidal component on the resulting energies . because physical magnetic fields are solenoidal ( due to @xmath56 ) ,",
    "comparing the non - solenoidal and solenoidal components provides a check on the consistency of the solutions .    performing a nlfff extrapolation using the bin",
    "1 data remains a challenge for the codes and for computer hardware .",
    "an extrapolated field @xmath0 corresponding to these data and represented by a single - precision , floating - point , three - dimensional array possesses of order @xmath571000@xmath58 points and requires @xmath5912  gb of computer memory .",
    "the codes as written require multiple copies of this and similar three - dimensional arrays to be stored simultaneously in computer memory . as a result ,",
    "memory use is an issue .",
    "a more constraining factor is the scaling of the time to completion , taken to be at best @xmath60 for serial calculation on a grid with @xmath61 points ( e.g. , @xcite ) .",
    "a number of the methods employ parallel implementations to improve performance , but the total computational time remains a problem for large grids . as a result of these constraints , we do not present the results obtained for the bin  1 data .",
    "results are presented for bin levels 216 for all five codes ( the optimization and magnetofrictional method codes , and the cfit , xtrapol and femq grad - rubin codes ) , with the exception of the magnetofrictional solution using the bin  3 boundary data .",
    "for the three grad - rubin codes , results are presented for both the @xmath49 and @xmath50 cases .",
    "altogether , there are 71 solution data cubes .    for a given resolution level ,",
    "the five codes employ domains that are slightly different . to standardize the comparisons across codes and resolutions",
    ", we will use a fixed analysis volume @xmath62 , chosen to be the largest common physical volume for all solutions across codes and resolutions .",
    "this analysis volume is 136@xmath2077@xmath20107  mm@xmath58 and covers approximately the region from @xmath23  =  14.3  mm to @xmath23  =  150.0  mm , from @xmath24  =  14.3  mm to @xmath24  =  92.8  mm , and from @xmath12  =  0  mm to @xmath12  = 107  mm , where the origin is located at the lower left - hand corner of the input magnetograms . for each resolution ,",
    "relative to the boundary data , are as follows : bin  2 : [ 48:504 ,  48:312 ,  0:360 ] ( size 457@xmath20265@xmath20361 ) ; bin  3 : [ 32:336 ,  32:208 ,  0:240 ] ( size 305@xmath20177@xmath20241 ) ; bin  4 : [ 24:252 ,  24:156 ,  0:180 ] ( size 229@xmath20133@xmath20181 ) ; bin  6 : [ 16:167 ,  16:103 ,  0:119 ] ( size 152@xmath2088@xmath20120 ) ; bin  8 : [ 12:126 ,  12:78 ,  0:90 ] ( size 115@xmath2067@xmath2091 ) ; bin  10 : [ 10:100 ,  10:62 ,  0:71 ] ( size 91@xmath2053@xmath2072 ) ; bin  12 : [ 8:84 ,  8:52 ,  0:60 ] ( size 77@xmath2045@xmath2061 ) ; bin  14 : [ 7:71 ,  7:44 ,  0:51 ] ( size 65@xmath2038@xmath2052 ) ; bin  16 : [ 6:63 ,  6:39 ,  0:45 ] ( size 58@xmath2034@xmath2046 ) . ]",
    "the footprint of the analysis volume @xmath62 on the photosphere is indicated by the dashed lines in the vector magnetogram data shown in figure  [ fig2 ] .",
    "figure  [ fl_fig9a ] presents visualizations of field lines within @xmath62 for the solutions for the different methods for the finest resolution level for which there are solution data .",
    "qualitatively , it is evident that there are some differences between the results obtained with the different methods or codes at this resolution .",
    "such variation across the solution methods is in common with our earlier studies ( e.g. , @xcite ) . when examining the differences in solution data across the range of resolution levels , as calculated by any of the codes , the initial qualitative impression is that there are only minor differences in ( for example ) the detailed field - line trajectories .",
    "the shape of the field - line bundles originating in different locations across the lower boundary of the analysis region appears similar for all resolutions , and the boundaries separating field lines that leave the analysis volume versus those that are contained within the domain appear similar . in the sections that follow ,",
    "we show that more significant variations exist amongst the solutions , both across resolution levels and across methods and codes , when quantitative comparisons are performed .",
    "+     +          in this section , the magnetic energies @xmath63 , the relative magnetic helicities @xmath64 of the extrapolated magnetic fields , and additional extrapolation metrics are discussed .",
    "the variations amongst the energies and helicities of the extrapolated fields depend on many factors , including the effects of resolution , the boundary conditions taken as input , and the handling of boundary conditions by the various codes .",
    "an additional consideration is that , for each resolution level , the same numerical grid is used for the calculation of these quantities , regardless of code and method , with interpolation onto this grid performed when necessary ( such as when analyzing results from xtrapol , in which variables are offset with each other on a staggered mesh ) .",
    "centered , second - order finite differences are used to calculate the needed derivatives , and this differencing scheme may also be different than the one used by the various codes ( e.g. , the magnetofrictional code uses fourth - order differences ) .",
    "figure  [ energy ] illustrates the magnetic energy @xmath63 , the magnetic energy of the corresponding reference potential field @xmath65 , the free energy @xmath66 , and the ratio @xmath67 as a function of spatial resolution for each of the extrapolations within the common analysis volume @xmath62 .",
    "the reference potential fields are computed numerically by solving the laplace equation for the potential with neumann boundary conditions based on the normal component of @xmath0 on all six boundaries of the analysis volume ( which we denote @xmath68 ) . following thomson s theorem ( e.g. , @xcite ) , the potential field uniquely represents the field with the minimum energy for any divergence - free field where @xmath6 matches @xmath68 . as a consequence of each solution field having its own @xmath68 , there are separate reference potential fields for each of the solution fields .",
    "cccccccc    optimization & 16 & 1.41 & 1.12 & 0.66 & 0.13 & 19 . & 0.38 + & 14 & 1.38 & 1.14 & 0.03 & 0.14 & 18 . & 0.37 + & 12 & 1.43 & 1.18 & 0.16 & 0.12 & 16 . & 0.39 + & 10 & 1.39 & 1.15 & 0.24 & 0.14 & 10 . &",
    "0.33 + & 8 & 1.46 & 1.18 & 0.47 & 0.11 & 6.1 & 0.23 + & 6 & 1.43 & 1.18 & 0.63 & 0.11 & 3.7 & 0.21 + & 4 & 1.48 & 1.21 & 0.24 & 0.10 & 2.2 & 0.18 + & 3 & 1.47 & 1.20 & 0.92 & 0.13 & 1.7 & 0.19 + & 2 & 1.50 & 1.24 & 0.04 & 0.10 & 1.1 & 0.16 +   +   + magnetofrictional & 16 & 1.37 & 1.16 & 1.29 & 0.30 & 82 . & 0.51 + & 14 & 1.22 & 1.15 & 3.79 & 0.30 & 71 . & 0.51 + & 12 & 1.23 & 1.17 & 2.62 & 0.32 & 52 . & 0.53 + & 10 & 1.26 & 1.19 & 3.65 & 0.25 & 46 . &",
    "0.51 + & 8 & 1.28 & 1.14 & 4.89 & 0.31 & 33 . & 0.34 + & 6 & 1.11 & 1.09 & 3.17 & 0.29 & 18 . &",
    "0.51 + & 4 & 1.23 & 1.12 & 3.96 & 0.27 & 13 . & 0.26 + & 2 & 1.08 & 1.10 & 1.80 & 0.29 & 13 . & 0.34 +   +   + cfit ( @xmath49 / @xmath50 ) & 16 & 1.12 / 1.12 & 1.04 / 1.03 & 3.55 / 3.43 & 0.35 / 0.40 & 11./ 12 . &",
    "0.08 / 0.09 + & 14 & 1.09 / 1.08 & 1.06 / 1.04 & 4.14 / 3.38 & 0.32 / 0.38 & 9.9 / 11 . & 0.07 / 0.10 + & 12 & 1.11 / 1.11 & 1.05 / 1.04 & 3.56 / 3.95 & 0.32 / 0.36 & 7.6 / 9.8 & 0.06 / 0.10 + & 10 & 1.09 / 1.09 & 1.05 / 1.05 & 3.51 / 4.23 & 0.32 / 0.34 & 6.5 / 8.6 & 0.08 / 0.11 + & 8 & 1.12 / 1.12 & 1.05 / 1.05 & 3.32 / 4.58 & 0.32 / 0.31 & 6.4 / 7.3 & 0.12 / 0.13 + & 6 & 1.11 / 1.09 & 1.07 / 1.05 & 4.05 / 3.68 & 0.27 / 0.29 & 4.7 / 6.1 & 0.10 / 0.14 + & 4 & 1.19 / 1.16 & 1.11 / 1.10 & 5.21 / 3.88 & 0.28 / 0.30 & 5.0 / 6.1 & 0.21 / 0.24 + & 3 & 1.11 / 1.11 & 1.06 / 1.06 & 2.45 / 2.95 & 0.27 / 0.26 & 4.0 / 4.8 & 0.21 / 0.24 + & 2 & 1.12 / 1.10 & 1.06 / 1.05 & 4.47 / 2.32 & 0.24 / 0.25 & 2.1 / 3.4 & 0.19 / 0.25 +   +   + xtrapol ( @xmath49 / @xmath50 ) & 16 & 1.29 / 1.29 & 1.02 / 1.02 & 2.68 / 2.30 & 0.26 / 0.25 & 7.9/ 7.8 & 0.03 / 0.03 + & 14 & 1.25 / 1.25 & 1.03 / 1.03 & 3.01 / 3.01 & 0.25 / 0.24 & 6.7/ 6.5 & 0.03 / 0.02 + & 12 & 1.28 / 1.27 & 1.03 / 1.03 & 3.21 / 2.99 & 0.24 / 0.22 & 6.0/ 5.7 & 0.03 / 0.02 + & 10 & 1.27 / 1.26 & 1.04 / 1.03 & 3.99 / 2.75 & 0.21 / 0.19 & 5.1/ 4.7 & 0.03 / 0.02 + & 8 & 1.29 / 1.28 & 1.04 / 1.04 & 3.47 / 3.24 & 0.21 / 0.18 & 3.1/ 3.0 & 0.02 / 0.02 + & 6 & 1.27 / 1.26 & 1.05 / 1.04 & 3.45 / 2.72 & 0.17 / 0.16 & 2.2/ 2.1 & 0.02 / 0.02 + & 4 & 1.29 / 1.28 & 1.05 / 1.05 & 3.52 / 4.13 & 0.13 / 0.16 & 1.2/ 1.2 & 0.02 / 0.04 + & 3 & 1.28 / 1.27 & 1.05 / 1.04 & 3.40 / 2.83 & 0.12 / 0.12 & 0.83 / 0.77 & 0.02 / 0.02 + & 2 & 1.28 / 1.28 & 1.05 / 1.05 & 3.46 / 2.24 & 0.14 / 0.13 & 0.46 / 0.40 & 0.08 / 0.06 +   +   + femq ( @xmath49 / @xmath50 ) & 16 & 1.29 / 1.30 & 1.04 / 1.03 & 2.87 / 2.50 & 0.28 / 0.25 & 6.4/ 6.9 & 0.02 / 0.02 + & 14 & 1.25 / 1.25 & 1.03 / 1.03 & 3.32 / 3.14 & 0.26 / 0.26 & 5.2/ 5.3 & 0.02 / 0.02 + & 12 & 1.28 / 1.28 & 1.03 / 1.03 & 3.24 / 3.06 & 0.25 / 0.24 & 4.5/ 4.6 & 0.02 / 0.02 + & 10 & 1.27 / 1.26 & 1.04 / 1.04 & 3.87 / 2.70 & 0.22 / 0.20 & 3.5/ 3.5 & 0.02 / 0.02 + & 8 & 1.29 / 1.28 & 1.05 / 1.04 & 3.93 / 3.50 & 0.21 / 0.19 & 2.8/ 2.8 & 0.02 / 0.02 + & 6 & 1.27 / 1.26 & 1.05 / 1.04 & 3.65 / 2.65 & 0.17 / 0.15 & 1.8/ 1.7 & 0.02 / 0.01 + & 4 & 1.30 / 1.28 & 1.05 / 1.05 & 3.66 / 3.87 & 0.12 / 0.15 & 0.99 / 0.98 & 0.01 / 0.04 + & 3 & 1.29 / 1.28 & 1.05 / 1.04 & 3.34 / 2.79 & 0.11 / 0.11 & 0.69 / 0.66 & 0.04 / 0.03 + & 2 & 1.29 / 1.28 & 1.06 / 1.05 & 3.87 / 2.97 & 0.10 / 0.11 & 0.42 / 0.38 & 0.07 / 0.07 +     +     +        the energy metrics are listed in table  [ t : eh ] . taken as a group , the energies of the solution fields range from 1.08@xmath2010@xmath69  j to 1.50@xmath2010@xmath69  j , with a mean value of 1.25@xmath2010@xmath69  j and a standard deviation of 10% . in terms of free energy @xmath70 ,",
    "the solutions range from near - potential fields having free energy 2% above @xmath65 ( both @xmath49 and @xmath50 models of xtrapol using the bin  16 boundary data ) to a case where the free energy is 24% of the associated potential field ( optimization using the bin  2 boundary data ) . in physical units ,",
    "the free energy @xmath70 is in the range 0.32.9@xmath2010@xmath71  j.    figures  [ energy](c ) and  ( d ) show that the solutions obtained with the magnetofrictional and optimization methods have higher free energies than those calculated using grad - rubin methods ( cfit , xtrapol , and femq ) , both in absolute ( @xmath72 ) as well as in relative ( @xmath73 ) terms . when more highly resolved boundary data are used , all methods return solutions that trend toward higher energies , with the exception of the magnetofrictional method .",
    "figure  [ energy ] illustrates that the free energies for the magnetofrictional method range from 10% to 19% , with higher resolution cases generally having less free energy .",
    "in contrast , the free energies from the optimization method increase as the resolution increases from 12% to 24% .",
    "the free energies in the grad - rubin codes are also seen to double over the range of resolutions , becoming greater for the more spatially resolved cases ( as with the optimization method ) , though this variation corresponds to changes of a few percent of the total magnetic energy . within the set of grad - rubin solutions , the relative free energy values are slightly higher at all resolutions for cfit than for femq and xtrapol .",
    "free energies for the @xmath49 solutions are equal or marginally higher than those from the @xmath50 solutions .",
    "at each resolution value , the spread in free energies for the grad - rubin codes appears small , with the exception of the cfit calculations using the bin  4 boundary data ( addressed further in the next subsection ) .",
    "two aspects of the calculation methods may explain the spreads in total and free energies .",
    "first , the larger spread in energies from the optimization and magnetofrictional solutions may be attributed in part to their divergences , as evaluated numerically , being greater than the grad - rubin methods ( which is expected on the basis of past results , see , e.g. , @xcite ) .",
    "these methods introduce a departure from @xmath74 upon initialization , and then seek to minimize this error during iteration .",
    "in contrast , the grad - rubin implementations employ schemes that are initialized with divergence - free fields , and aim to provide divergence - free fields at all iterations .",
    "( we further address the contribution from residual non - solenoidal field components to the total energy in the next subsection . )",
    "second , the higher energies of the magnetofrictional and optimization solutions may be due in part to the preprocessing used with these methods .",
    "as was the case in @xcite and @xcite , preprocessing the boundary data to be more compatible with the force - free assumption can result in solution fields having greater free energies .",
    "all grad - rubin implementations presented here remove spikes in @xmath5 ( many of which likely result from poorly constrained values of @xmath75 and @xmath76 ) , but do not otherwise preprocess the boundary data . the degree to which the codes necessarily alter the boundary data",
    "are discussed further in section  [ subsec : results - bc - changes ] .      accurate numerical solutions to the force - free model should be solenoidal , to within numerical errors .",
    "however , the methods of solution to the equations , and the inconsistency of the boundary data with the model , can lead to significant departures from solenoidality . @xcite",
    "provide a method for quantifying how much a non - zero divergence in a nlfff solution affects the accuracy of the estimate for the magnetic field energy .",
    "the @xcite method is an application of thomson s theorem .",
    "the magnetic field is decomposed into a potential and a current carrying part , and each of these is split into solenoidal and non - solenoidal components via helmholtz decomposition .",
    "the energies of the components are then compared . in this section ,",
    "we summarize the decomposition as applied to each of the nlfff calculations , leaving the details to appendix  [ sec : solenoidal - appendix ] .",
    "the magnetic energy within @xmath62 may be written @xmath77 where @xmath78 and @xmath79 are the energies of the potential and current - carrying solenoidal components , @xmath80 and @xmath81 are those of the non - solenoidal components , and @xmath82 is a non - solenoidal mixed term ( see equations  ( 7 ) and  ( 8) in @xcite for the expressions for the energies in terms of the field components ) .",
    "the energies in equation  ( [ eq : thomson ] ) are positive by definition , with the exception of @xmath82 . for a perfectly divergence - free field , @xmath83 and @xmath84 , while @xmath85 . in practice",
    ", a nlfff calculated numerically will not be perfectly solenoidal , and @xmath80 , @xmath81 , and  @xmath82 will instead be finite . comparing the non - solenoidal components with the free energy",
    "can be used to gauge the reliability and uncertainty of the free energy determination .",
    "the values of each term in equation  ( [ eq : thomson ] ) for each method and spatial resolution are plotted in figure  [ decomp ] . for the grad - rubin methods ,",
    "the results are plotted for both the @xmath50 and @xmath49 solutions using identical ( and often overlapping ) symbolism .",
    "figure  [ decomp ] shows that the energies contained in the non - solenoidal components are generally lower than the solenoidal portions .",
    "the primary exceptions to this trend are with the optimization solutions , where the magnitudes of the mixed terms @xmath86 for all resolution levels are of the same order as the free energy @xmath79 .",
    "the energy of the non - solenoidal component of the potential field @xmath80 is smaller by at least a factor of 10@xmath58 in all cases , and in almost all cases decreases for higher resolutions .",
    "@xmath80 is generally smaller than @xmath81 and @xmath86 , which indicates that the potential component of each field is generally closer to a solenoidal state than the current - carrying component of the field . of @xmath81 and @xmath86 ,",
    "the latter is usually larger .",
    "the elevated values for @xmath81 and @xmath86 for the cfit solutions using the bin  4 boundary data contribute to the outlying points ( i.e. , points that appear to not follow the apparent trend ) in the total energy plots shown figure  [ energy ] .      for each calculation , the relative magnetic helicity @xmath64 in the analysis volume @xmath62 is computed using the method in @xcite .",
    "the resulting values for all solutions are listed in table  [ t : eh ] and plotted in figure  [ helicity ] .",
    "we find a wide range of values for @xmath64 , with no clear trend that depends on spatial resolution but significant dependence upon the extrapolation method employed .",
    "values of @xmath64 across all methods and resolutions are predominantly positive , except for a few of the optimization method solutions .    the solutions calculated using the three grad - rubin implementations possess values of @xmath64 that lie between 2@xmath2010@xmath69  wb@xmath87 and about 5@xmath2010@xmath69  wb@xmath87 .",
    "the variations with resolution within one implementation are found to be of a similar order as the variations between the implementations .",
    "the xtrapol and femq codes return the most consistent results between different resolutions , and between @xmath49 and @xmath50 solutions , with a mean relative helicity ( over all xtrapol and femq solutions ) of ( 3.2@xmath880.5)@xmath2010@xmath69  wb@xmath87 .",
    "the cfit code solutions exhibit slightly greater variation with spatial resolution ; the average helicity over all cfit solutions is ( 3.7@xmath880.7)@xmath2010@xmath69  wb@xmath87 .",
    "the values of @xmath64 from the magnetofrictional solutions trend higher and then lower as the resolution changes , with a mean of ( 3.1@xmath881.2)@xmath2010@xmath69  wb@xmath87 , in somewhat general agreement with the values of @xmath64 found from the grad - rubin solutions .",
    "the optimization method solutions have the lowest @xmath64 values  including several that are negative  with a mean and standard deviation of ( @xmath890.1@xmath880.5)@xmath2010@xmath69  wb@xmath87 .",
    "the larger fractional variation in @xmath64 values obtained by the magnetofrictional and optimization methods compared with the grad - rubin codes may be partly explained by the larger non - solenoidal errors in these solutions , as outlined in section  [ subsubsec : non - solenoidality ] .",
    "additionally , preprocessing has been applied independently to the magnetograms at different resolutions for these methods , which may lead to greater variety in the values of @xmath64 for the extrapolated fields .",
    "the last three columns of table  [ t : eh ] list domain - averaged metrics that have been used in earlier studies .",
    "these are @xmath90 , the mean sine of the angle @xmath91 between @xmath51 and @xmath0 at each point , weighted by @xmath51 ; the fractional flux ratio @xmath92 , where @xmath93 and where @xmath94 is the grid spacing ; and @xmath95 , the average of the magnitude of the lorentz force to the sum of the magnitudes of its constituent pressure and tension components ( see equation  ( 10 ) in @xcite ) .",
    "the @xmath90 and @xmath95 metrics are measures of how force - free a solution field is , both of which vanish for perfectly force - free fields .",
    "the grad - rubin solutions show similar ( albeit opposite ) trends for both metrics , with @xmath90 decreasing as more highly resolved boundary data are used and @xmath95 mostly showing the reverse behavior .",
    "no significant difference is apparent between the @xmath49 and @xmath50 solutions . for the magnetofrictional method ,",
    "neither @xmath90 nor @xmath95 exhibit well defined trends , though there is a tendency for both metrics to indicate more force - free solutions as the resolution of the boundary data is increased .",
    "the solutions calculated by the optimization method do show a clear trend for @xmath95 , with the more highly resolved fields having lower values of @xmath95 , however any trend for the @xmath90 metric is less clear , though the general tendency is for more force - free solutions when higher resolution boundary data are used .",
    "the @xmath92 metric is a measure of how divergence - free a solution field is , vanishing for divergence - free fields .",
    "for all methods , this metric decreases as more highly resolved boundary data are used .",
    "cccccc    optimization & 16 & 161 . & 307 .",
    "& 7.89 & 22.2 + & 14 & 117 . & 281 . & 5.96 & 21.3 + & 12 & 134 . & 319 . & 6.81 & 23.8 + & 10 & 103 . & 286 . & 4.93 & 21.6 + & 8 & 117 . & 322 .",
    "& 5.32 & 23.7 + & 6 & 117 . & 289 . & 5.32 & 21.3 + & 4 & 80.9 & 337 . & 3.38 & 24.1 + & 3 & 72.4 & 301 . & 2.88 & 20.5 + & 2 & 33.4 & 365 . & 1.17 & 22.1 +   +   + magnetofrictional & 16 & 80.0 & 225 .",
    "& 4.77 & 14.7 + & 14 & 81.2 & 228 .",
    "& 4.76 & 15.1 + & 12 & 80.6 & 226 . & 4.54 & 14.8 + & 10 & 82.2 & 229 .",
    "& 4.47 & 14.6 + & 8 & 82.4 & 231 .",
    "& 4.41 & 14.1 + & 6 & 82.9 & 234 .",
    "& 4.22 & 14.0 + & 4 & 83.9 & 237 .",
    "& 3.96 & 13.4 + & 2 & 84.9 & 239 .",
    "& 3.43 & 11.7 +   +   + cfit ( @xmath49 / @xmath50 ) & 16 & & 348 .",
    "/ 351 . & & 21.2 / 21.4 + & 14 & & 342 .",
    "& & 21.6 / 22.1 + & 12 & & 354 .",
    "/ 361 . & & 22.3 / 22.8 + & 10 & & 370 .",
    "/ 369 . & & 21.7 / 22.3 + & 8 & & 381 .",
    "/ 380 . & & 22.2 / 22.8 + & 6 & & 384 .",
    "/ 379 . & & 22.3 / 22.7 + & 4 & & 395 .",
    "/ 387 . & & 22.2 / 22.1 + & 3 & & 401 .",
    "/ 401 . & & 22.4 / 22.2 + & 2 & & 408 .",
    "/ 409 . & & 20.8 / 20.7 +   +   + xtrapol ( @xmath49 / @xmath50 ) & 16 & & 304 .",
    "/ 300 . & & 21.4 / 22.1 + & 14 & & 306 .",
    "& & 21.9 / 22.9 + & 12 & & 308 .",
    "/ 315 . & & 22.3 / 23.5 + & 10 & & 317 .",
    "/ 318 . & & 22.2 / 23.0 + & 8 & & 323 .",
    "/ 334 . & & 22.3 / 23.2 + & 6 & & 332 .",
    "/ 342 . & & 22.3 / 23.5 + & 4 & & 349 .",
    "/ 361 . & & 22.7 / 24.0 + & 3 & & 362 .",
    "/ 370 . & & 22.2 / 23.4 + & 2 & & 382 . / 387 . & & 20.9 / 21.6 +   +   + femq ( @xmath49 / @xmath50 ) & 16 & & 322 .",
    "/ 325 . & & 22.0 / 22.6 + & 14 & & 327 .",
    "/ 333 . & & 22.5 / 23.3 + & 12 & & 328 .",
    "/ 339 . & & 30.4 / 24.0 + & 10 & & 335 .",
    "/ 341 . & & 22.8 / 23.7 + & 8 & & 339 .",
    "/ 354 . & & 22.7 / 23.9 + & 6 & & 352 .",
    "/ 362 . & & 22.9 / 24.2 + & 4 & & 366 .",
    "/ 378 . & & 23.2 / 24.5 + & 3 & & 375 .",
    "/ 382 . & & 22.7 / 23.7 + & 2 & & 386 .",
    "/ 392 . & & 21.0 / 22.0 +              all of the solution methods introduce significant changes to the vector magnetogram boundary conditions , either initially , and/or during solution of the nlfff equations .",
    "the magnitude of the changes are based on the uncertainties associated with the remapped vector magnetogram data , and thus tend to be more significant in weak - field regions than in regions of stronger field . here , we characterize these changes by directly comparing the values of @xmath0 on the lower boundary of the resultant nlfff solutions to the values of @xmath0 supplied by the vector magnetogram boundary data .    for each solution",
    "we define the change @xmath96 in the vector field at @xmath97 as @xmath98 comparing the solution @xmath0 with the disambiguated vector magnetogram value @xmath99 .",
    "the normalized change @xmath100 accounts for the uncertainties @xmath101 in each component @xmath102 , such that @xmath103 where @xmath104 and @xmath105 , for each component @xmath106 .",
    "we consider separately the magnitudes of the vertical components of the changes ( @xmath107 and @xmath108 ) , and the magnitudes of the horizontal components of the changes , defined by @xmath109 and @xmath110 , with the factor of @xmath111 introduced so that the expected value for normalized changes in the horizontal field , taking into account its uncertainties , is unity .",
    "table  [ t : bcchanges ] lists root - mean - square ( rms ) values for the magnitudes of the vertical and horizontal components of the changes in the boundary conditions defined by equations  ( [ eq : delta_bvec ] ) and  ( [ eq : delta_bvec_norm ] ) for all solutions , for boundary points within the footprint of the analysis volume @xmath62 . in calculating the rms values for the normalized changes , boundary points with assigned uncertainties less than 1  g",
    "have the uncertainty replaced by a value of 1  g. this step prevents the small uncertainties biasing the rms values .",
    "the table shows that all methods introduce changes in the horizontal field boundary values substantially larger than the uncertainties assigned to the vector magnetogram data . in absolute units ,",
    "the magnitude @xmath112 of the changes in the horizontal field are largely similar ( several hundred gauss ) for the different methods .",
    "the magnetofrictional method introduces the smallest changes , with rms values of order 230  g to 240  g , and the other methods introduce changes which are larger by about 50% . in a normalized sense ,",
    "any resolution dependence on @xmath113 appears weak .",
    "the grad - rubin methods show no substantial difference in the values of @xmath113 for the @xmath49 and @xmath50 solutions .",
    "in addition , the optimization and magnetofrictional methods introduce changes in the vertical field , as is evident from table  [ t : bcchanges ] . as with the horizontal field changes ,",
    "these also exceed the uncertainties . in absolute units ,",
    "@xmath114 for the optimization method decreases from about 160  g when using more coarsely resolved boundary data to about 30  g when more finely resolved data are used .",
    "similarly , there is a clear trend in the normalized change @xmath115 , which is found to decrease from a factor of 7.89 when the coarsest boundary data are used to 1.17 for the data with the highest resolution .",
    "the magnetofrictional method consistently makes adjustments between 80  g and 85  g for all resolution levels . as with the optimization method ,",
    "the normalized changes @xmath115 for the magnetofrictional method trend smaller as more highly resolved data are used , ranging from 4.77 for the bin  16 data to 3.43 for the bin  2 data . by design , the grad - rubin methods ( cfit , xtrapol , and femq ) preserve the values of the vertical field on the boundary and thus there are no changes to the vertical components .    for the magnetofrictional method ,",
    "the changes in the boundary values are introduced by the preprocessing applied to the boundary data , prior to the nlfff calculation .",
    "the changes are comparable to the maximum values allowed by the preprocessing ( see section  [ sec : mfmethod ] ) .",
    "the specific method of preprocessing used constrains the point - wise changes in the boundary values to @xmath88100  g ( for @xmath15 ) , and @xmath88150  g ( for @xmath75 and @xmath76 ) .",
    "the maximum / minimum values correspond to rms values @xmath107",
    "=  100  g and @xmath116  280  g. for the optimization method , changes are introduced by its version of the preprocessing , which does not impose fixed point - wise constraints , and also during the calculation , as described in section  [ sec : optmethod ] .",
    "although the grad - rubin methods preserve the values of the vertical field in the boundary , they do introduce changes in the horizontal field in the initial calculation of boundary values of the force - free parameter @xmath5 .",
    "changes are also introduced during solution of the boundary value problem ( see section  [ sec : grmethod ] ) .",
    "the boundary values of the horizontal field are ignored _ a priori _ over one polarity of the vertical field .",
    "figures  [ fig : bc - analysis - fig1 ] and  [ fig : bc - analysis - fig2 ] show the spatial distribution of the normalized changes  @xmath108 and  @xmath117 across the lower boundary . in figure",
    "[ fig : bc - analysis - fig1 ] , the changes in the vertical component @xmath15 of the vector magnetogram boundary data introduced by the magnetofrictional and optimization methods are shown for both the bin  2 and bin  8 calculations .",
    "the figure indicates that the magnetofrictional method changes @xmath15 by similar amounts ( on a normalized basis ) for both resolutions , with the more highly resolved boundary changed slightly less .",
    "the sign of @xmath108 correlates with the polarity , and indicates that the magnetofrictional code systematically reduces the magnitude of @xmath15 across the full field of view .",
    "the optimization method , in contrast , is seen to change the more highly resolved ( bin  2 ) case significantly less than the lower - resolution ( bin  8) case , on a normalized basis , without any apparent dependence on polarity .",
    "figure  [ fig : bc - analysis - fig2 ] illustrates the changes introduced in the magnitude of the horizontal component @xmath118 of the vector magnetogram data , for all methods when using the bin  2 boundary data .",
    "this figure shows that @xmath117 is about the same for all methods , with the exception for the magnetofrictional method where it is lower by about 25% due to the limits imposed during the preprocessing step .",
    "the normalized changes in @xmath118 are more prominent in the lower portion of the field of view where both the values of @xmath118 are the weakest and the uncertainties are the highest . for the grad - rubin methods , while there are some differences between the @xmath49 and @xmath50 solutions in the locations of the more prominent changes to @xmath118 , there is a good general correspondence between the different methods , for a given polarity .",
    "this is expected on the basis of the grad - rubin method : if the different solutions ( for a given polarity ) have a similar connectivity , then field lines carrying strong currents will reconnect to the boundary in the opposite polarity at similar locations , and introduce the largest changes in the horizontal field at these specific locations .",
    "nonlinear force - free fields ( nlfffs ) are increasingly used to model the magnetic structure in the sun s corona . an earlier series of studies ( e.g. , @xcite ) showed that the nlfff solution methods regularly achieved success on fields with known solutions and with appropriate boundary conditions , but still encountered difficulties in their application of the model to solar data . in this paper",
    "we re - examine one aspect identified in @xcite believed to affect the reliability of nlfff modeling : the influence of the spatial resolution of the boundary vector magnetogram data on the nlfff solutions .",
    "the boundary data used for this experiment are a sequence of vector magnetograms with different spatial resolutions constructed from a single normal - map scan in december 2007 of ar  10978 by the hinode / sot - sp .",
    "the vector magnetograms are produced by rebinning the observed polarization spectra by factors ranging from 2 to 16 , performing a milne - eddington inversion on these rebinned spectra , and then resolving the 180@xmath25 ambiguity in each case .",
    "this processing results in vector magnetograms having a spatial resolution ranging from  059 to  467 , a range of approximately one half to one sixteenth of the native hinode / sot - sp normal - map resolution .",
    "the procedure of rebinning the polarization spectra ( rather than the inverted vector magnetogram data ) is intended to mimic observations by spectrographs with different intrinsic resolutions .",
    "ar  10978 was a relatively small and isolated region at the time of the observation , and as a result was selected for this experiment because of the presumption that much of the current - carrying field lines lie in the volume above the hinode field of view .",
    "the region exhibited some magnetic complexity and was flare productive .",
    "five different codes implementing solution of the nlfff model with three different methods ( the optimization , the magnetofrictional , and grad - rubin methods ) are applied to the set of vector magnetogram data produced from the rebinned polarization spectra .",
    "solutions are calculated using these data , spanning the set of spatial resolutions and ( for the grad - rubin methods ) for the two choices of polarity in the boundary conditions ( @xmath49 and @xmath50 ) on the force - free parameter @xmath5 .",
    "although the hinode / sot - sp polarization spectra were also processed at the intrinsic instrumental resolution ( i.e. , without any rebinning ) , these data proved problematic for codes and computer hardware due to the size ( in pixels ) of the modeling domain and the corresponding time to completion , and thus we report only on the results for the boundary data at bin levels  2 to  16 . in total ,",
    "71 different solution data cubes are examined .",
    "considered as a group , the physical quantities of interest of the nlfff solutions span a wide range . as calculated within the common volume @xmath62 chosen for analysis , estimated total energies @xmath63 range from 1.081.50@xmath2010@xmath69  j , estimated free energies @xmath70 range from  2% to  24% of the potential field energies , and estimated relative magnetic helicities",
    "@xmath64 range from 0.92@xmath2010@xmath69  wb@xmath87 to 5.2@xmath2010@xmath69  wb@xmath87 .",
    "the broad ranges in these estimates of physical quantities are affected by several factors .",
    "the three most significant factors are as follows :    1 .   the input vector magnetogram data exhibit differences across the resolution levels , as shown in section  [ subsec : data ] .",
    "as a result , some variation in the subsequent nlfff extrapolations , the lower bounds of which are constrained by the vector data , is expected .",
    "the most general trend in the results is that as the spatial resolution of the boundary data increases , the nlfff metrics improve . in particular , using more highly resolved boundary data usually results in nlfff solutions that are both more force- and divergence - free , as found by calculating the metrics @xmath90 , @xmath92 , and @xmath95 , as well as by performing the helmholtz decomposition discussed in section  [ subsec : results - energy - helicity ] .",
    "additionally , improvement in the nlfff metrics is correlated with larger @xmath70 in most instances .",
    "measurements of @xmath64 , on the other hand , do not show any discernible trends with spatial resolution .",
    "although values of @xmath64 from most methods agree to within a factor of two ( excepting the optimization method , for which values of @xmath64 are clustered around zero ) , the lack of any trend with resolution suggests that @xmath64 is difficult to determine from nlfff solutions .",
    "vector magnetogram data determined from photospheric spectral lines are not force - free , and thus are not immediately applicable to nlfff modeling . as a result",
    ", the nlfff extrapolation codes necessarily change the provided vector boundary data to be more compatible with the nlfff model , resulting in boundary data that are in a more force - free state , much as what is expected at the base of the corona .",
    "the measurement uncertainties provided with the data are used to guide how these changes at the boundary occur , and changes to the field ( particularly the horizontal components ) are substantial when compared with the specified uncertainties , even when higher spatial resolution boundary data are used ( though the specified uncertainties may be underestimates of the true uncertainties ) , as discussed in section  [ subsec : results - bc - changes ] .",
    "different extrapolation codes implement the changes in different ways , resulting in solutions from the different codes , while qualitatively similar in appearance ( e.g. , as in the field - line renderings of fig .  [ fl_fig9a ] ) , that have quantitatively different characteristics ( e.g. , the energy estimates shown in fig .",
    "[ energy ] ) .",
    "[ item : bcchanges ] 3 .",
    "variations from method to method in the cases presented here may be as large as the effects of spatial resolution .",
    "for example , the optimization and magnetofrictional methods typically contain about  2 to  5 times more free energy than the group of grad - rubin methods .",
    "these variations result from a combination of effects , including not only the different treatments of the vector magnetogram data ( point  [ item : bcchanges ] above ) , but also the different conditions imposed on the lateral and top boundaries , how unbalanced flux and currents are handled , the size of the field of view relative to the flux and current systems important for nlfff modeling , and the presence or absence of solenoidal errors .",
    "variations amongst methods seen in earlier nlfff extrapolation studies ( e.g. , @xcite ) were similarly wide - ranging .",
    "we conclude that most nlfff solutions appear more consistent with both the force- and divergence - free conditions when more highly resolved vector magnetogram data are used .",
    "higher resolution boundary data are associated with nlfff solutions having larger amounts of free energy .",
    "however , the use of more highly resolved boundary data does not by itself guarantee a more internally consistent solution . from a pragmatic perspective , given the spreads in @xmath119 , @xmath70 , and @xmath64 from the series of nlfff models shown here and past experience with constructing nlfff solutions , we recommend that users perform the following checks before a nlfff model is employed in a scientific setting :    1 .",
    "check metrics such as @xmath90 , @xmath92 , and @xmath95 and assess the degree to which a field is force- and divergence - free .",
    "in addition , performing a helmholtz decomposition on a nlfff model seems to be a useful way to determine the degree to which the total and free energies in the model arise from residual errors in the divergence of @xmath0 .",
    "these errors may be significant and may call into question the accuracies of the free energy estimates , as shown in section  [ subsubsec : non - solenoidality ] .",
    "2 .   additionally ,",
    "either verify that there is good agreement between the modeled field lines and the resulting euv and x - ray loop trajectories before using any estimates of physical quantities from nlfff solutions can be relied upon , or use the observed coronal loops to place additional constraints during the nlfff solution process .",
    "the research presented in this article benefited from resources ( meeting space and travel support ) provided by the international space science institute ( issi ) in bern , switzerland during meetings of international team 238 , `` nonlinear force - free modeling of the solar corona : towards a new generation of methods '' , held in 2013 and 2014 .",
    "we gratefully acknowledge the support provided by issi .    m.l.d",
    ".  would like to acknowledge support from nasa contract nnm07aa01c to lockheed martin .",
    "m.s.w .  acknowledges support from a faculty of science mid - career researcher scheme at the university of sydney .",
    "k.d.l . and g.b .",
    "were supported by nasa contract nnh12cc03c .",
    "t.a .  and a.c .",
    "thank the institute i.d.r.i.s .",
    "of the centre national de la recherche scientifique for providing computational facilities , as well as the centre national detudes spatiales ( cnes ) for its support",
    ". s.a.g .  acknowledges receipt of an australian postgraduate research award . j.k.t .  acknowledges support from austrian science fund ( fwf ) p25383-n27 .",
    "g.v .  acknowledges the support of the leverhulme trust research project grant 2014 - 051 , and funding from the european commissions seventh framework programme under the grant agreements number 284461 ( eheroes project ) .",
    "hinode is a japanese mission developed and launched by isas / jaxa , collaborating with naoj as a domestic partner , and nasa ( usa ) and stfc ( uk ) as international partners .",
    "scientific operation of the hinode mission is conducted by the hinode science team organized at isas / jaxa .",
    "this team mainly consists of scientists from institutes in the partner countries .",
    "support for the post - launch operation is provided by jaxa and naoj ( japan ) , stfc ( uk ) , nasa ( usa ) , esa , and nsc ( norway ) .",
    "this appendix provides more details related to the helmholtz decomposition of the magnetic energies discussed in section  [ subsubsec : non - solenoidality ] .",
    "values of all components in the decomposition of the magnetic energy @xmath63 , as defined in equation  ( [ eq : thomson ] ) , for all of the nlfff solutions are listed in table  [ t : edivb ] .",
    "the tilde over an energy indicates normalization with respect to the total energy , so that , e.g. , @xmath120 .",
    "there is a clear distinction in results obtained with the magnetofrictional and optimization methods , which seek to minimize departures from solenoidality during computation , and the grad - rubin implementations , which explicitly solve for a solenoidal ( divergence - free ) field . in the following discussion , we compare the non - solenoidal contributions to the total energy to the @xmath121 component , because @xmath121 is equivalent to the free energy @xmath122 in a perfectly solenoidal field and it is @xmath122 that holds significant physical interest .",
    "the grad - rubin code solutions have non - solenoidal contributions which are , in most cases , at least one order of magnitude smaller than @xmath121",
    ". the grad - rubin codes also show little difference in results between the @xmath49 and @xmath50 solutions . for the cfit solutions , the calculations using the bin  4 boundary data exhibit the largest non - solenoidal contributions among the cfit results for different resolutions , with values of @xmath123 and @xmath124 that lie above the trend established by the cfit solutions for the other resolution levels . excepting this case",
    ", the non - solenoidal errors decrease with increasing resolution from 21% ( for bin  16 boundary data ) to 1% ( for bin  2 data ) of the free energy @xmath121 .",
    "the solutions obtained with the xtrapol code have dominant non - solenoidal contributions from @xmath124 that decrease with increasing resolution from 33% ( for bin  16 data ) to 1% ( for bin  2 data ) of @xmath121 .",
    "the solutions obtained with the femq code lie , on average , between the cfit and the xtrapol results , except for the cases using the bin  4 and bin  6 boundary data .",
    "the femq solution for bin  6 boundary data has non - solenoidal contributions of @xmath125 , which are the smallest amongst all methods and bin levels .",
    "these contributions are also smaller than the non - solenoidal contribution from their corresponding potential fields .    the magnetofrictional solutions exhibit non - solenoidal contributions which are a significant fraction of the free energy in about half of the cases .",
    "for example , the case using the bin  10 boundary data shows a non - solenoidal contribution of about one third of @xmath121 .",
    "the non - solenoidal contributions decrease with increasing resolution down to 6% of the free energy for the case where bin  2 data are used .",
    "the magnetofrictional solutions are affected by non - solenoidal contributions with energies a significant fraction of the nominal free energy , and , on average , one order of magnitude larger than for the grad - rubin codes .",
    "the optimization method solutions exhibit the largest non - solenoidal contributions , and the @xmath124 term is larger than the nominal free energy @xmath121 at most bin levels .",
    "the mixed term generally increases in size with resolution , from a factor of 1.16 ( for bin  16 data ) to a factor of 1.52 ( for bin  2 data ) of the nominal free energy @xmath121 .",
    "the solenoidal properties of the evolutionary methods are found to improve when the relaxation parameters are adjusted .",
    "for instance , by changing the parameter @xmath48 in equation  ( 4 ) of @xcite from 1.0 to 1.5 , thereby weighting the divergence term more strongly during the minimization process , the solutions obtained by the optimization method are reduced by about an order of magnitude , as illustrated in figure  [ fig : julia2 ] . these solutions",
    ", however , are less force - free and have less free energy than the solutions analyzed in section  [ sec : results ] . for these divergence - optimized solutions , the metrics @xmath90 and @xmath73 range from  0.46 to  0.52 and from  1.02 to  1.08 , respectively ( cf .  table  [ t : eh ] ) .    in summary ,",
    "the grad - rubin codes produce solutions with relatively small non - solenoidal contributions , which can be of order 1% of @xmath121 at the highest resolution .",
    "the magnetofrictional and optimization methods exhibit significantly larger non - solenoidal contributions in energy . because equation  ( 8) in @xcite suggests that non - solenoidal contributions are correlated with the magnitude of the current - carrying part of the field , and because the magnetofrictional and optimization method solutions have the largest free energies , it is perhaps not surprising that they are characterized by the largest non - solenoidal errors .",
    "irrespective of this effect , further reduction of the non - solenoidal errors seems likely to increase the reliability of free energy estimates from solutions obtained with the optimization and magnetofrictional methods .",
    "finally , we note that the non - solenoidal mixed term @xmath82 is negative in a number of the nlfff solutions and may partially cancel @xmath81 in equation  ( [ eq : thomson ] ) .",
    "large , negative contributions from @xmath82 can in principle lead to non - physical solutions , with negative free energy .",
    "this may occur for methods that do not explicitly impose @xmath74 , and especially if non - preprocessed magnetograms are used .",
    "this was the case for some of the solutions obtained with the magnetofrictional and optimization methods presented in @xcite ( cf .",
    "table  1 in that paper ) . in @xcite",
    "it is shown , for one particular case , how the large negative values of @xmath82 and non - physical solutions arise ( mostly ) because of the inconsistency of the vector magnetogram data with the force - free equations .",
    "optimization & 16 & 8.90 & 4.93 & 4.73 & 2.94 & 5.75 + & 14 & 8.78 & 5.88 & 4.15 & 3.94 & 5.88 + & 12 & 8.48 & 5.38 & 3.37 & 6.03 & 9.21 + & 10 & 8.71 & 5.78 & 3.01 & 4.69 & 6.63 + & 8 & 8.50 & 6.06 & 1.98 & 4.76 & 8.49 + & 6 & 8.47 & 7.61 & 1.30 & 5.16 & 7.13 + & 4 & 8.29 & 6.69 & 0.76 & 6.66 & 9.75 + & 3 & 8.34 & 8.16 & 0.50 & 6.94 & 7.70 + & 2 & 8.08 & 7.25 & 0.30 & 9.07 & 11.0 +   +   + magnetofrictional & 16 & 8.65 & 11.5 & 8.17 & 16.3 & 0.22 + & 14 & 8.68 & 12.0 & 6.42 & 17.9 & 0.65 + & 12 & 8.55 & 11.6 & 6.53 & 21.9 & 0.68 + & 10 & 8.37 & 12.1 & 4.64 & 17.8 & 2.33 + & 8 & 8.79 & 10.5 & 3.25 & 36.5 & 2.12 + & 6 & 9.16 & 9.3 & 2.53 & 20.9 & 3.02 + & 4 & 8.89 & 11.0 & 1.32 & 26.8 & 2.58 + & 2 & 9.11 & 8.6 & 0.43 & 5.1 & 0.26 +   +   + cfit ( @xmath49 / @xmath50 ) & 16 & 9.60 / 9.67 & 4.77 / 4.15 & 15.5 / 15.5 & 1.19 / 1.18 & 1.02 / 1.07 + & 14 & 9.47 / 9.66 & 5.97 / 4.12 & 11.0 / 11.1 & 0.91 / 0.90 & 0.88 / 0.90 + & 12 & 9.54 / 9.57 & 5.07 / 4.72 & 9.77 / 9.84 & 0.76 / 0.74 & 0.61 / 0.64 + & 10 & 9.49 / 9.51 & 5.52 / 5.26 & 7.56 / 7.59 & 0.56 / 0.58 & 0.53 / 0.51 + & 8 & 9.48 / 9.51 & 5.48 / 5.16 & 5.28 / 5.26 & 0.38 / 0.39 & 0.39 / 0.36 + & 6 & 9.37 / 9.51 & 6.44 / 5.07 & 3.62 / 3.68 & 0.27 / 0.27 & 0.25 / 0.24 + & 4 & 9.04 / 9.09 & 7.56 / 6.33 & 1.84 / 1.88 & 1.45 / 1.93 & 1.84 / 2.55 + & 3 & 9.46 / 9.45 & 5.50 / 5.53 & 1.20 / 1.20 & 0.09 / 0.09 & 0.09 / 0.09 + & 2 & 9.40 / 9.51 & 6.02 / 4.95 & 0.56 / 0.58 & 0.04 / 0.05 & 0.05 / 0.05 +   +   + xtrapol ( @xmath49 / @xmath50 ) & 16 & 9.78 / 9.76 & 3.07 / 3.31 & 9.47 / 9.14 & 4.15 / 3.80 & 1.01 / 1.05 + & 14 & 9.75 / 9.72 & 3.29 / 3.60 & 6.92 / 6.71 & 3.34 / 3.13 & 0.890 / 0.936 + & 12 & 9.68 / 9.73 & 3.67 / 3.21 & 6.01 / 5.83 & 2.51 / 2.28 & 0.603 / 0.615 + & 10 & 9.59 / 9.66 & 4.60 / 3.88 & 4.76 / 4.69 & 2.02 / 1.89 & 0.560 / 0.575 + & 8 & 9.58 / 9.63 & 4.59 / 4.07 & 3.45 / 3.39 & 1.37 / 1.28 & 0.393 / 0.389 + & 6 & 9.55 / 9.64 & 4.72 / 3.84 & 2.42 / 2.40 & 0.95 / 0.90 & 0.281 / 0.275 + & 4 & 9.48 / 9.54 & 5.28 / 4.77 & 1.34 / 1.32 & 0.50 / 0.48 & 0.146 / 0.149 + & 3 & 9.50 / 9.59 & 5.06 / 4.22 & 0.83 / 0.82 & 0.33 / 0.31 & 0.101 / 0.106 + & 2 & 9.50 / 9.56 & 5.08 / 4.48 & 0.40 / 0.39 & 0.19 / 0.19 & 0.048 / 0.050 +   +   + femq ( @xmath49 / @xmath50 ) & 16 & 9.66 / 9.67 & 3.35 / 3.25 & 9.01 / 8.68 & 7.97 / 7.49 & 0.117 / 0.120 + & 14 & 9.73 / 9.68 & 3.08 / 3.53 & 6.92 / 6.71 & 4.39 / 4.15 & 0.454 / 0.461 + & 12 & 9.67 / 9.67 & 3.45 / 3.41 & 5.91 / 5.71 & 3.92 / 3.67 & 0.205 / 0.197 + & 10 & 9.59 / 9.63 & 4.24 / 3.79 & 4.75 / 4.66 & 3.20 / 3.05 & 0.183 / 0.199 + & 8 & 9.55 / 9.63 & 4.68 / 3.94 & 3.45 / 3.39 & 1.76 / 1.63 & 0.272 / 0.275 + & 6 & 9.53 / 9.62 & 4.64 / 3.75 & 2.44 / 2.41 & 2.07 / 2.04 & 0.001 / 0.001 + & 4 & 9.48 / 9.57 & 5.18 / 4.32 & 1.33 / 1.32 & 9.48 / 9.26 & 0.003 / 0.001 + & 3 & 9.49 / 9.58 & 5.11 / 4.28 & 0.83 / 0.82 & 3.91 / 3.72 & 0.064 / 0.066 + & 2 & 9.45 / 9.54 & 5.51 / 4.57 & 0.40 / 0.39 & 4.45 / 4.38 & 0.023 / 0.024 +                      , m.  l. , schrijver , c.  j. , barnes , g. , leka , k.  d. , lites , b.  w. , aschwanden , m.  j. , amari , t. , canou , a. , mctiernan , j.  m. , rgnier , s. , thalmann , j.  k. , valori , g. , wheatland , m.  s. , wiegelmann , t. , cheung , m.  c.  m. , conlon , p.  a. , fuhrmann , m. , inhester , b. , & tadesse , t. 2009 , , 696 , 1780                  , c.  j. , keller , c.  u. , harvey , j.  w. , georgoulis , m.  k. , hadder , n.  l. , norton , a.  a. , raouafi , n .- e . , & toussaint , r.  m. 2009 , in astronomical society of the pacific conference series , vol .",
    "405 , solar polarization 5 : in honor of jan stenflo , ed .",
    "s.  v. berdyugina , k.  n. nagendra , & r.  ramelli , 47              , b.  w. , akin , d.  l. , card , g. , cruz , t. , duncan , d.  w. , edwards , c.  g. , elmore , d.  f. , hoffmann , c. , katsukawa , y. , katz , n. , kubo , m. , ichimoto , k. , shimizu , t. , shine , r.  a. , streander , k.  v. , suematsu , a. , tarbell , t.  d. , title , a.  m. , & tsuneta , s. 2013 , , 283 , 579            , t.  r. , leka , k.  d. , barnes , g. , lites , b.  w. , georgoulis , m.  k. , pevtsov , a.  a. , balasubramaniam , k.  s. , gary , g.  a. , jing , j. , li , j. , liu , y. , wang , h.  n. , abramenko , v. , yurchyshyn , v. , & moon , y .-",
    "2006 , , 237 , 267    , z. , & mcclymont , a.  n. 1994 , in astronomical society of the pacific conference series , vol .",
    "68 , solar active region evolution : comparing models with observations , ed .",
    "k.  s. balasubramaniam & g.  w. simon , 225            , p.  h. , bogart , r.  s. , bush , r.  i. , hoeksema , j.  t. , kosovichev , a.  g. , schou , j. , rosenberg , w. , springer , l. , tarbell , t.  d. , title , a. , wolfson , c.  j. , zayer , i. , & mdi engineering team .",
    "1995 , , 162 , 129    , j. , scherrer , p.  h. , bush , r.  i. , wachter , r. , couvidat , s. , rabello - soares , m.  c. , bogart , r.  s. , hoeksema , j.  t. , liu , y. , duvall , t.  l. , akin , d.  j. , allard , b.  a. , miles , j.  w. , rairden , r. , shine , r.  a. , tarbell , t.  d. , title , a.  m. , wolfson , c.  j. , elmore , d.  f. , norton , a.  a. , & tomczyk , s. 2012 , , 275 , 229    , c.  j. , de rosa , m.  l. , metcalf , t. , barnes , g. , lites , b. , tarbell , t. , mctiernan , j. , valori , g. , wiegelmann , t. , wheatland , m.  s. , amari , t. , aulanier , g. , dmoulin , p. , fuhrmann , m. , kusano , k. , rgnier , s. , & thalmann , j.  k. 2008 , , 675 , 1637              , s. , ichimoto , k. , katsukawa , y. , nagata , s. , otsubo , m. , shimizu , t. , suematsu , y. , nakagiri , m. , noguchi , m. , tarbell , t. , title , a. , shine , r. , rosenberg , w. , hoffmann , c. , jurcevich , b. , kushner , g. , levay , m. , lites , b. , elmore , d. , matsushita , t. , kawaguchi , n. , saito , h. , mikami , i. , hill , l.  d. , & owens , j.  k. 2008 , , 249 , 167"
  ],
  "abstract_text": [
    "<S> the nonlinear force - free field ( nlfff ) model is often used to describe the solar coronal magnetic field , however a series of earlier studies revealed difficulties in the numerical solution of the model in application to photospheric boundary data . we investigate the sensitivity of the modeling to the spatial resolution of the boundary data , by applying multiple codes that numerically solve the nlfff model to a sequence of vector magnetogram data at different resolutions , prepared from a single hinode / sot - sp scan of noaa active region 10978 on  2007 december  13 . </S>",
    "<S> we analyze the resulting energies and relative magnetic helicities , employ a helmholtz decomposition to characterize divergence errors , and quantify changes made by the codes to the vector magnetogram boundary data in order to be compatible with the force - free model . </S>",
    "<S> this study shows that nlfff modeling results depend quantitatively on the spatial resolution of the input boundary data , and that using more highly resolved boundary data yields more self - consistent results . </S>",
    "<S> the free energies of the resulting solutions generally trend higher with increasing resolution , while relative magnetic helicity values vary significantly between resolutions for all methods . </S>",
    "<S> all methods require changing the horizontal components , and for some methods also the vertical components , of the vector magnetogram boundary field in excess of nominal uncertainties in the data . </S>",
    "<S> the solutions produced by the various methods are significantly different at each resolution level . </S>",
    "<S> we continue to recommend verifying agreement between the modeled field lines and corresponding coronal loop images before any nlfff model is used in a scientific setting . </S>"
  ]
}