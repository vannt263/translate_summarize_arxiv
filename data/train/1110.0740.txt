{
  "article_text": [
    "theoretical advances in modern astrophysics have largely benefited from computational models and techniques that have been improved over the past decades . in the field of gasdynamics ,",
    "shock - capturing schemes represent the current establishment for reliable numerical simulations of high mach - number , possibly magnetized flows in newtonian or relativistic regimes . as increasingly more sophisticated methods developed , a number of computer codes targeting complex physical aspects to various degrees have now become available to the community . in the field of magnetohydrodynamics ( mhd ) ,",
    "examples worth of notice are astrobear @xcite , athena @xcite , bats - r - us @xcite , echo @xcite , flash @xcite , nirvana @xcite , pluto @xcite , ramses @xcite and vac @xcite .",
    "some of these implementions provide additional capabilities that can approach the solution of the equations in the relativistic regimes : amrvac and pluto for special relativistic hydro , while the echo code allows to handle general relativistic mhd with a fixed metric .",
    "other frameworks were specifically designed for special or general relativistic purposes , e.g. the ram code @xcite , harm @xcite and raishin @xcite .    in some circumstances , adequate theoretical modeling of astrophysical scenarios may become extremely challenging since great disparities in the spatial and temporal scales may simultaneously arise in the problem of interest . in these situations",
    "a static grid approach may become quite inefficient and , in the most extreme cases , the amount of computational time can make the problem prohibitive .",
    "typically , such conditions occur when the flow dynamics exhibit very localized features that evolve on a much shorter scale when compared to the rest of the computational domain . to overcome these limitations ,",
    "one possibility is to change or adapt the computational grid dynamically in space and time so that the features of interest can be adequately captured and resolved .",
    "adaptive mesh refinement ( amr ) is one such technique and can lead , for a certain class of problems , to a considerable speed up .",
    "some of the aforementioned numerical codes provide amr implementations through a variety of different approaches .",
    "examples worth of notice are the patch - based block - structured approach of @xcite ( e.g. astrobear ) , the fully - octree approach described in @xcite ( e.g. ramses ) or the block - based octree of @xcite ( e.g. flash ) and @xcite ( e.g. bats - r - us , amrvac ) .",
    "the present work focuses on the block - structured amr implementation in the pluto code and its application to computational astrophysical gasdynamics .",
    "pluto@xmath0is a godunov - type code providing a flexible and versatile modular computational framework for the solution of the equations of gasdynamics under different regimes ( e.g. , classical / relativistic fluid dynamics , euler / mhd ) .",
    "a comprehensive description of the code design and implementation may be found , for the static grid version , in @xcite ( paper i henceforth ) .",
    "recent additions to the code include a relativistic version of the hlld riemann solver @xcite , high - order finite difference schemes @xcite and optically thin radiative losses with a non - equilibrium chemical network @xcite .",
    "here we further extend the code description and show its performance on problems requiring significant usage of adaptively refined nested grids .",
    "pluto@xmath0takes advantage of the chombo library that provides a distributed infrastructure for parallel computations over block - structured adaptively refined grids .",
    "the choice of block - structured amr ( as opposed to octree ) is justified by the need of exploiting the already implemented modular skeleton introducing the minimal amount of modification and , at the same time , maximizing code re - usability .",
    "the current amr implementation leans on the corner - transport - upwind ( ctu , * ? ? ?",
    "* ) method of @xcite ( mt henceforth ) in which a conservative finite volume discretization is adopted to evolve zone averages in time .",
    "the scheme is dimensionally unsplit , second - order accurate in space and time and can be directly applied to relativistic mhd as well .",
    "spatial reconstruction can be carried out in primitive or characteristic variables using high - order interpolation schemes such as the piecewise parabolic method ( ppm , * ? ? ?",
    "* ) , weighted essentially non - oscillatory ( weno ) or linear total variation diminishing ( tvd ) limiting .",
    "the divergence - free constraint of magnetic field is enforced via a mixed hyperbolic / parabolic correction of @xcite that avoids the computational cost associated with an elliptic cleaning step , and the scrupulous treatment of staggered fields demanded by constrained transport algorithms @xcite . as such",
    ", this choice provides a convenient first step in porting a considerable fraction of the static grid implementation to the amr framework . among the novel features",
    ", we also show how to extend the time - stepping scheme to include dissipative terms describing viscous , resistive and thermally conducting flows . besides",
    ", we propose a novel treatment for efficiently computing the time - step in presence of cooling and/or reacting flows over hierarchical block - structured grids .",
    "the paper is structured as follows . in section [ sec : equation ]",
    "we overview the relevant equations while in section [ sec : numint ] we describe the integration scheme used on the single patch . in section [ sec : chombo ] an overview of the block - structured amr strategy as implemented in chombo is given .",
    "sections [ sec : mhd_test ] and [ sec : rmhd_test ] show the code performance on selected multidimensional test problems and astrophysical applications in classical and relativistic mhd , respectively . finally , in section",
    "[ sec : summary ] we summarize the main results of our work .",
    "the pluto@xmath0code has been designed for the solution of nonlinear systems of conservative partial differential equations of the mixed hyperbolic / parabolic type . in the present context",
    "we will focus our attention on the equations of single - fluid magnetohydrodynamics , both in the newtonian ( mhd ) and special relativistic ( rmhd ) regimes .",
    "we consider a newtonian fluid with density @xmath1 , velocity @xmath2 and magnetic induction @xmath3 and write the single fluid mhd equations as @xmath4    + \\nabla p_t&= & \\nabla\\cdot{\\mathsf{\\tau } } + \\rho{\\mathbf{g}}\\ , , \\\\",
    "\\noalign{\\medskip } { \\displaystyle}{\\frac{\\partial \\cal e}{\\partial t } } + \\nabla\\cdot\\left [    \\left({\\cal e } + p_t\\right){\\mathbf{v } } -     \\left({\\mathbf{v}}\\cdot{\\mathbf{b}}\\right){\\mathbf{b}}\\right ] & = &       \\nabla\\cdot{\\mathsf{\\pi}}_{\\cal e } - \\lambda + \\rho{\\mathbf{v}}\\cdot{\\mathbf{g}}\\ , , \\\\",
    "\\noalign{\\medskip } { \\displaystyle}{\\frac{\\partial { \\mathbf{b}}}{\\partial t } } - \\nabla\\times\\left({\\mathbf{v}}\\times{\\mathbf{b}}\\right )      & = & -\\nabla\\times\\left({\\mathsf{\\eta}}{\\mathbf{j}}\\right)\\ , , \\end{array}\\ ] ] where @xmath5 is the total ( thermal+magnetic ) pressure , @xmath6 is the total energy density , @xmath7 is the gravitational acceleration term and @xmath8 accounts for optically thin radiative losses or heating .",
    "divergence terms on the right - hand side account for dissipative physical processes and are described in detail in section [ sec : nonideal ] .",
    "proper closure is provided by choosing an equation of state ( eos ) which , for an ideal gas , allows to write the total energy density as @xmath9 with @xmath10 being the specific heat ratio .",
    "alternatively , by adopting a barotropic or an isothermal eos , the energy equation can be discarded and one simply has , respectivelty , @xmath11 or @xmath12 ( where @xmath13 is the constant speed of sound ) .",
    "chemical species and passive scalars are advected with the fluid and are described in terms of their number fraction @xmath14 where @xmath15 label the particular ion .",
    "they obey non - homogeneous transport equations of the form @xmath16 where the source term @xmath17 describes the coupling between different chemical elements inside the reaction network ( see for instance * ? ? ?",
    "non - ideal effects due to dissipative processes are described by the differential operators included on the right - hand side of eq .",
    "( [ eq : mhd ] ) .",
    "viscous stresses may be included through the viscosity tensor @xmath18 defined by @xmath19\\,,\\ ] ] where @xmath20 is the kinematic viscosity and @xmath21 is the identity matrix .",
    "similarly , magnetic resistivity is accounted for by prescribing the resistive @xmath22 tensor ( diagonal ) .",
    "dissipative terms contribute to the net energy balance through the additional flux @xmath23 appearing on the right hand side of eq .",
    "( [ eq : mhd ] ) : @xmath24 where the different terms give the energy flux contributions due to , respectively , thermal conductivity , viscous stresses and magnetic resistivity .",
    "the thermal conduction flux @xmath25 smoothly varies between classical and saturated regimes and reads : @xmath26 where @xmath27 is the magnitude of the saturated flux @xcite , @xmath28 is a parameter of order unity accounting for uncertainties in the estimate of @xmath29 , @xmath30 is the isothermal speed of sound and @xmath31\\ ] ] is the classical heat flux with conductivity coefficients @xmath32 and @xmath33 along and across the magnetic field lines , respectively @xcite .",
    "indeed , the presence of a partially ordered magnetic field introduces a large anisotropic behavior by channeling the heat flux along the field lines while suppressing it in the transverse direction ( here @xmath34 is a unit vector along the field line ) .",
    "we point out that , in the classical limit @xmath35 , thermal conduction is described by a purely parabolic operator and flux discretization follows standard finite difference . in the saturated limit ( @xmath36 ) ,",
    "on the other hand , the equation becomes hyperbolic and thus an upwind discretization of the flux is more appropriate @xcite .",
    "this is discussed in more detail in appendix [ app : sattc ] .",
    "a ( special ) relativistic extension of the previous equations requires the solution of energy - momentum and number density conservation .",
    "written in divergence form we have @xmath37    + \\nabla p_t & = & 0",
    "\\noalign{\\medskip } { \\displaystyle}{\\frac{\\partial { \\mathbf{b}}}{\\partial t } } - \\nabla\\times\\left({\\mathbf{v}}\\times{\\mathbf{b}}\\right ) & = & 0   \\ , , \\\\",
    "\\noalign{\\medskip } { \\displaystyle}{\\frac{\\partial \\cal e}{\\partial t } }     + \\nabla\\cdot\\left({\\mathbf{m}}-\\rho\\gamma{\\mathbf{v}}\\right ) & = & 0",
    "\\ , , \\end{array}\\ ] ] where @xmath1 is the rest - mass density , @xmath38 the lorentz factor , velocities are given in units of the speed of light ( @xmath39 ) and the fluid momentum @xmath40 accounts for matter and electromagnetic terms : @xmath41 , where @xmath42 is the electric field and @xmath43 is the gas enthalpy .",
    "total pressure and energy include thermal and magnetic contributions and can be written as @xmath44 finally , the gas enthalpy @xmath43 is related to @xmath1 and @xmath45 via an equation of state which can be either the ideal gas law , @xmath46 or the tm ( taub - mathews , * ? ? ?",
    "* ) equation of state @xmath47 which provides an analytic approximation of the synge relativistic perfect gas @xcite .    a relativistic formulation of the dissipative terms will not be presented here and will be discussed elsewhere .      in the following",
    "we shall adopt an orthonormal system of coordinates specified by the unit vectors @xmath48 ( @xmath49 is used to label the direction , e.g. @xmath50 in cartesian coordinates ) and conveniently assume that conserved variables @xmath51 - for the mhd equations - and @xmath52 - for rmhd - satisfy the following hyperbolic / parabolic partial differential equations @xmath53 where @xmath54 and @xmath55 are , respectively , the hyperbolic and parabolic flux tensors .",
    "the source term @xmath56 is a point - local source term which accounts for body forces ( such as gravity ) , cooling , chemical reactions and the source term for the scalar multiplier ( see eq .",
    "[ eq : glm2x2 ] below ) .",
    "we note that equations containing curl or gradient operators can always be cast in this form by suitable vector identities .",
    "for instance , the projection of @xmath57 in the coordinate direction given by the unit vector @xmath48 can be re - written as @xmath58 where the second term on the right hand side should be included as an additional source term in eq .",
    "( [ eq : conslaw ] ) whenever different from zero ( e.g. in cylindrical geometry ) .",
    "similarly one can re - write the gradient operator as @xmath59 .",
    "several algorithms employed in pluto@xmath0are best implemented in terms of primitive variables , @xmath60 . in the following we shall assume a one - to - one mapping between the two sets of variables , provided by appropriate conversion functions , that is @xmath61 and @xmath62 .",
    "pluto@xmath0approaches the solution of the previous sets of equations using either finite - volume ( fv ) or finite - difference ( fd ) methods both sharing a flux - conservative discretization where volume averages ( for the former ) or point values ( for the latter ) of the conserved quantities are advanced in time .",
    "the implementation is based on the well - established framework of godunov type , shock - capturing schemes where an upwind strategy ( usually a riemann solver ) is employed to compute fluxes at zone faces . for the present purposes , we shall focus on the fv approach where volume - averaged primary flow quantities ( e.g. density , momentum and energy ) retain a zone - centered discretization .",
    "however , depending on the strategy chosen to control the solenoidal constraint , the magnetic field can evolve either as a cell - average or as a face - average quantity ( using stoke s theorem ) .",
    "as described in paper i , both approaches are possible in pluto@xmath0by choosing between powell s eight wave formulation or the constrained transport ( ct ) method , respectively .    a third , cell - centered approach based on the generalized lagrange multiplier ( glm ) formulation of @xcite has recently been introduced in pluto@xmath0and a thorough discussion as well as a direct comparison with ct schemes can be found in the recent work by mt .",
    "the glm formulation easily builds in the context of mhd and rmhd equations by introducing an additional scalar field @xmath63 which couples the divergence constraint to faraday s law according to @xmath64 where @xmath65 is the ( constant ) speed at which divergence errors are propagated while @xmath66 is a constant controlling the rate at which monopoles are damped .",
    "the remaining equations are not changed and the conservative character is not lost . owing to its ease of implementation , we adopt the glm formulation as a convenient choice in the development of a robust amr framework for newtonian and relativistic mhd flows .",
    "the system of conservation laws is advanced in time using the corner - transport - upwind ( ctu , * ? ? ?",
    "* ) method recently described by mt . here",
    "we outline the algorithm in a more concise manner and extend its applicability in presence of parabolic ( diffusion ) terms and higher order reconstruction .",
    "although the algorithms illustrated here are explicit in time , we will also consider the description of more sophisticated and effective approaches for the treatment of parabolic operators in a forthcoming paper .",
    "we shall assume hereafter an equally - spaced grid with computational cells centered in @xmath67 having size @xmath68 .",
    "for the sake of exposition , we omit the integer subscripts @xmath69 or @xmath70 when referring to the cell center and only keep the half - increment notation in denoting face values , e.g. , @xmath71 when @xmath72 . following @xcite , we use @xmath73 and @xmath74 to denote , respectively , the cell volume and areas of the lower and upper interfaces orthogonal to @xmath48 .",
    "an explicit second - order accurate discretization of eqns .",
    "( [ eq : conslaw ] ) , based on a time - centered flux computation , reads @xmath75 where @xmath76 is the volume - averaged array of conserved values inside the cell @xmath77 , @xmath78 is the explicit time step whereas @xmath79 and @xmath80 are the increment operators corresponding to the hyperbolic and parabolic flux terms , respectively : @xmath81 in the previous expression @xmath82 and @xmath83 are , respectively , right ( @xmath84 ) and left ( @xmath85 ) face- and time - centered approximations to the hyperbolic and parabolic flux components in the direction of @xmath48 .",
    "the source term @xmath86 represents the directional contribution to the total source vector @xmath87 including body forces and geometrical terms implicitly arising when differentiating the tensor flux on a curvilinear grid . cooling , chemical reaction terms and the source term in eq .",
    "[ eq : glm2x2 ] ( namely @xmath88 ) are treated separately in an operator - split fashion .",
    "the computation of @xmath82 requires solving , at cell interfaces , a riemann problem between time - centered adjacent discontinuous states , i.e. @xmath89 where @xmath90 is the numerical flux resulting from the solution of the riemann problem . with pluto@xmath0",
    ", different riemann solvers may be chosen at runtime depending on the selected physical module ( see paper i ) : rusanov ( lax - friedrichs ) , hll , hllc and hlld are common to both classical and relativistic mhd modules while the roe solver is available for hydro and mhd .",
    "the input states in the eq .",
    "( [ eq : ctu_flux ] ) are obtained by first carrying an evolution step in the normal direction , followed by correcting the resulting values with a transverse flux gradient .",
    "this yields the corner - coupled states which , in absence of parabolic terms ( i.e. when @xmath91 ) , are constructed exactly as illustrated by mt .",
    "for this reason , we will not repeat it here .    when @xmath92 , on the other hand , we adopt a slightly different formulation that does not require any change in the computational stencil . at constant @xmath93-faces , for instance",
    ", we modify the corner - coupled states to @xmath94\\,,\\ ] ] where , using godunov s first - order method , we compute for example @xmath95 i.e. , by solving a riemann problem between cell - centered states .",
    "states at constant @xmath96 and @xmath97-faces are constructed in a similar manner",
    ". the normal predictors @xmath98 can be obtained either in characteristic or primitive variables as outlined in section [ sec : np_char ] and section [ sec : np_prim ] , respectively .",
    "parabolic ( dissipative ) terms are discretized in a flux - conservative form using standard central finite difference approximations to the derivatives . for any term in the form @xmath99 ,",
    "for instance , we evaluate the right interface flux appearing in eq .",
    "( [ eq : incrementop_par ] ) with the second - order accurate expression @xmath100 and similarly for the other directions ( a similar approach is used by * ? ? ?",
    "we take the solution available at the cell center at @xmath101 in eq .",
    "( [ eq : transv ] ) and at the half time step @xmath102 in eq .",
    "( [ eq : update ] ) . for this latter update ,",
    "time- and cell - centered conserved quantities may be readily obtained as @xmath103 the algorithm requires a total of @xmath104 solutions to the riemann problems per zone per step and it is stable under the courant - friedrichs - levy ( cfl ) condition @xmath105 ( in 2d ) or @xmath106 ( in 3d ) , where @xmath107\\ ] ] is the cfl number , @xmath108 and @xmath109 are the ( local ) largest signal speed and diffusion coefficient in the direction given by @xmath50 , respectively",
    ". equation ( [ eq : ca ] ) is used to retrieve the time step @xmath110 for the next time level if no cooling or reaction terms are present .",
    "otherwise we further limit the time step so that the relative change in pressure and chemical species remains below a certain threshold @xmath111 : @xmath112\\ ] ] where @xmath113 and @xmath114 are the maximum fractional variations during the source step @xcite .",
    "we note that the time step limitation given by equation ( [ eq : dt_cool ] ) does not depend on the mesh size and can be estimated on unrefined cells only .",
    "this allows to take full advantage of the adaptivity in time as explained in section [ sec : cool_source ] .",
    "the computation of the normal predictor states can be carried out in characteristic variables by projecting the vector @xmath115 of primitive variables onto the left eigenvectors @xmath116 of the primitive system .",
    "specializing to the x direction : @xmath117 where @xmath118 labels the characteristic wave with speed @xmath119 and the projection extends to all neighboring zones required by the interpolation stencil of width @xmath120 .",
    "the employment of characteristic fields rather than primitive variables requires the additional computational cost associated with the full spectral decomposition of the primitive form of the equations .",
    "nevertheless , it has shown to produce better - behaved solutions for highly nonlinear problems , notably for higher order methods .",
    "for each zone @xmath121 and characteristic field @xmath122 , we first interpolate @xmath123 to obtain @xmath124 , that is , the rightmost ( @xmath84 ) and leftmost ( @xmath85 ) interface values from within the cell .",
    "the interpolation can be carried out using either fourth- , third- or second - order piecewise reconstruction as outlined later in this section .",
    "extrapolation in time to @xmath125 is then carried out by using an upwind selection rule that discards waves not reaching a given interface in @xmath126 .",
    "the result of this construction , omitting the @xmath122 index for the sake of exposition , reads @xmath127     - w^{\\rm ref}_{i,+}\\right\\}\\,,\\ ] ] @xmath128     - w^{\\rm ref}_{i,-}\\right\\}\\,,\\ ] ] where @xmath129 is the courant number of the @xmath122-th wave , @xmath130 , whereas @xmath131 and @xmath132 are defined by @xmath133 the choice of the reference state @xmath134 is somewhat arbitrary and one can simply set @xmath135 @xcite which has been found to work well for flows containing strong discontinuities .",
    "alternatively , one can use the original prescription @xcite @xmath136\\,,\\ ] ] @xmath137\\,,\\ ] ] where @xmath138 and @xmath139 are chosen so as to minimize the size of the term susceptible to characteristic limiting @xcite .",
    "however we note that , in presence of smooth flows , both choices may reduce the formal second order accuracy of the scheme since , in the limit of small @xmath140 , contributions carried by waves not reaching a zone edge are not included when reconstructing the corresponding interface value @xcite . in these situations ,",
    "a better choice is to construct the normal predictors without introducing a specific reference state or , equivalently , by assigning @xmath141 in eq .",
    "( [ eq : wnorm_predp ] ) and ( [ eq : wnorm_predm ] ) .",
    "the time - centered interface values obtained in characteristic variables through eq .",
    "( [ eq : wnorm_predp ] ) and ( [ eq : wnorm_predm ] ) are finally used as coefficients in the right - eigenvector expansion to recover the primitive variables : @xmath142 where @xmath143 is the right eigenvector associated to the @xmath122-th wave , @xmath144 is a source term accounting for body forces and geometrical factors while @xmath145 and @xmath146 arise from calculating the interface states in primitive variables rather than conservative ones and are essential for the accuracy of the scheme in multiple dimensions .",
    "see mt for a detailed discussion on the implementation of these terms .",
    "as mentioned , the construction of the left and right interface values can be carried out using different interpolation techniques .",
    "although some of the available options have already been presented in the original paper @xcite , here we briefly outline the implementation details for three selected schemes providing ( respectively ) fourth- , third- and second - order spatially accurate interface values in the limit of vanishing time step . throughout this section",
    "we will make frequent usage of the undivided differences of characteristic variables ( [ eq : char_var ] ) such as @xmath147 for the @xmath121-th zone .",
    "[ [ piecewise - parabolic - method ] ] piecewise parabolic method + + + + + + + + + + + + + + + + + + + + + + + + + +    the original ppm reconstruction by @xcite ( see also * ? ? ?",
    "* ) can be directly applied to characteristic variables giving the following fourth - order limited interface values : @xmath148 where slope limiting is used to ensure that @xmath149 are bounded between @xmath150 and @xmath151 : @xmath152\\ ] ] and @xmath153 is the minmod function .",
    "the original interface values defined by eq .",
    "( [ eq : ppm1 ] ) must then be corrected to avoid the appearance of local extrema . by defining @xmath154 , we further apply the following parabolic limiter @xmath155 where the first condition flattens the distribution when @xmath156 is a local maximum or minimum whereas the second condition prevents the appearance of an extremum in the parabolic profile .",
    "once limiting has been applied , the final interface values are obtained as @xmath157 in some circumstances , we have found that further application of the parabolic limiter ( [ eq : ppm_parabolic_lim ] ) to primitive variables may reduce oscillations .    [",
    "[ third - order - improved - weno ] ] third - order improved weno + + + + + + + + + + + + + + + + + + + + + + + + +    as an alternative to the popular tvd limiters , the third - order improved weighted essentially non - oscillatory ( weno ) reconstruction proposed by @xcite ( see also @xcite ) may be used .",
    "the interpolation still employs a three - point stencil but provides a piecewise parabolic profile that preserves the accuracy at smooth extrema , thus avoiding the well known clipping of classical second - order tvd limiters .",
    "left and right states are recovered by a convex combination of @xmath158 order interpolants into a weighted average of order @xmath159 .",
    "the nonlinear weights are adjusted by the local smoothness of the solution so that essentially zero weights are given to non smooth stencils while optimal weights are prescribed in smooth regions . in compact notation : @xmath160 where @xmath161 as one can see , an attractive feature of weno reconstruction consists in completely avoiding the usage of conditional statements .",
    "the improved weno scheme has enhanced accuracy with respect to the traditional 3rd order scheme of @xcite in regions where the solution is smooth and provides oscillation - free profiles near strong discontinuities .",
    "[ [ linear - reconstruction ] ] linear reconstruction + + + + + + + + + + + + + + + + + + + + +    second - order traditional limiting is provided by @xmath162 where @xmath163 is a standard limiter function such as the monotonized - central ( mc ) limiter ( eq . [ eq : mclim ] ) .",
    "other , less steep forms of limiting are the harmonic mean @xcite : @xmath164 the van albada limiter @xcite : @xmath165 or the minmod limiter , eq .",
    "( [ eq : minmod ] ) .",
    "linear reconstruction may also be locally employed in place of a higher order method whenever a strong shock is detected .",
    "this is part of a built - in hybrid mechanism that selectively identifies zones within a strong shock in order to introduce additional dissipation by simultaneously switching to the hll riemann solver .",
    "even if the occurrence of such situations is usually limited to very few grid zones , this fail - safe mechanism does not sacrifice the second - order accuracy of the scheme and has been found to noticeably improve the robustness of the algorithm avoiding the occurrence of unphysical states .",
    "this is described in more detail in appendix [ app : multid_flattening ] . however , in order to assess the robustness and limits of applicability of the present algorithm , it will not be employed for the test problems presented here unless otherwise stated .",
    "the normal predictor states can also be directly computed in primitive variables using a simpler formulation that avoids the characteristic projection step . in this case ,",
    "one - dimensional left and right states are obtained at @xmath166 using @xmath167\\,,\\ ] ] where @xmath168 and @xmath169 may be used to introduce a weak form of upwind limiting , in a similar fashion to section [ sec : np_char ] .",
    "time - centered conservative variables @xmath170 follow from a simple conservative muscl - hancock step : @xmath171 +         \\frac{\\delta t^n}{2}\\hat{{\\mathbf{s}}}_d\\,,\\ ] ] where @xmath172 and @xmath173 are the area and volume elements and @xmath174 are obtained using linear reconstruction ( eq . [ eq : linear ] ) of the primitive variables .",
    "this approach offers ease of implementation over the characteristic tracing step as it does not require the eigenvector decomposition of the equations nor their primitive form .",
    "notice that , since this step is performed in conservative variables , the multidimensional terms proportional to @xmath175 do not need to be included .",
    "1    ) covering the entire computational domain .",
    "solid lines are representative of the level resolution . dashed lines contour the ghost zones of two patches of level @xmath176 .",
    "colors indicate different filling methods : physical outer boundaries ( red ) , boundaries filled by exchanging values with adjacent patches on the same level ( blue ) , boundaries filled by interpolating from the next coarser level ( yellow ) . ]",
    "the support for adaptive mesh refinement ( amr ) calculations in pluto@xmath0is provided by the chombo library .",
    "chombo is a software package aimed at providing a distributed infrastructure for serial and parallel calculations over block - structured , adaptively refined grids in multiple dimensions .",
    "it is written in a combination of c++ and fortran77 with mpi and is developed and distributed by the applied numerical algorithms group of lawrence berkeley national laboratory ( https://seesar.lbl.gov/anag/chombo/ ) .    in the block - structured amr approach ,",
    "once the solution has been computed over a rectangular grid which discretizes the entire computational domain , it is possible to identify the cells which require additional resolution and cover them with a set of rectangular grids ( also referred to as blocks or patches ) , characterized by a finer mesh spacing .",
    "chombo follows the @xcite strategy to determine the most efficient patch layout to cover the cells that have been tagged for refinement .",
    "this process can be repeated recursively to define the solution over a hierarchy of @xmath177 levels of refinement whose spatial resolutions satisfy the relation @xmath178 , where the integer @xmath179 is the refinement ratio between level @xmath180 and level @xmath181 .",
    "a level of refinement is composed by a union of rectangular grids which has to be : _ disjointed _ , i.e. two blocks of the same level can be adjacent without overlapping ; _ properly nested _ ,",
    "i.e. a cell of level @xmath180 can not be only partially covered by cells of level @xmath181 and cells of level @xmath181 must be separated from cells of level @xmath182 at least by a row of cells of level @xmath180 .",
    "a simple example of a bidimensional adaptive grid distributed over a hierarchy of three levels of refinement is depicted in fig .",
    "[ fig : amrgrid ] . following the notation of @xcite , a global mapping",
    "is employed on all levels : in three dimensions , cells on level @xmath183 are identified with global indexes @xmath184 ( @xmath185 , @xmath186 , @xmath187 , with @xmath188 being the equivalent global resolution of level @xmath180 in the three directions ) .",
    "correspondingly , the cell @xmath184 of level @xmath180 is covered by @xmath189 cells of level @xmath181 identified by global indexes @xmath190 satisfying the conditions @xmath191 , @xmath192 , @xmath193 . taking direction 1 as an example , the expressions @xmath194 , @xmath195 , @xmath196 , define the physical coordinates of the left edge , center and right edge of a cell respectively .    1    [ !",
    "the length of the horizontal black arrows is proportional to the timestep size @xmath197 .",
    "curved vertical arrows indicate interlevel communications .",
    "red arrows represent fine - to - coarse communications between synchronized adjacent levels , including conservative averaging ( eq . [ eq : avgdown ] ) and refluxing ( eq . [ eq : fluxcorr ] , [ eq : addreflux ] ) .",
    "green arrows represent coarse - to - fine communications , including the conservative interpolation ( eq . [ eq : prolong ] ) needed to fill ghost zones and to define the solution on newly generated cells of the finer level.,title=\"fig : \" ]    if the adaptive grid is employed to evolve time - dependent hyperbolic partial differential equations , the cfl stability condition allows to apply refinement in time as well as in space , as first proposed by @xcite and further developed in @xcite .",
    "in fact , each level @xmath180 advances in time with a time - step @xmath198 which is @xmath199 times smaller than the time - step of the next coarser level @xmath182 . starting the integration at the same instant , two adjacent levels",
    "synchronize every @xmath179 timesteps , as schematically illustrated in fig .",
    "[ fig : time ] for a refinement ratio @xmath200 .",
    "even though in the following discussion we will assume that level @xmath181 completes @xmath179 timesteps to synchronize with level @xmath180 , chombo allows the finer level @xmath181 to advance with smaller substeps if the stability condition requires it .",
    "anyway , the additional substeps must guarantee that levels @xmath180 and @xmath181 are synchronized again at time @xmath201 .",
    "the time evolution of single patches is handled by pluto@xmath0 , as illustrated in section [ sec : numint ] . before starting the time evolution",
    ", the ghost cells surrounding the patches must be filled according to one of these three possibilities : ( 1 ) assigning `` physical '' boundary conditions to the ghost cells which lie outside the computational domain ( e.g. the red area in fig .",
    "[ fig : amrgrid ] ) ; ( 2 ) exchanging boundary conditions with the adjacent patches of the same level ( e.g. the blue area in fig .",
    "[ fig : amrgrid ] ) ; ( 3 ) interpolating values from the parent coarser level for ghost cells which cover cells of a coarser patch ( e.g. the yellow area in fig .",
    "[ fig : amrgrid ] ) .",
    "c c c @xmath202 & @xmath93 & @xmath203 + @xmath204 & @xmath96 & @xmath97 + @xmath205 & @xmath97 & / + @xmath206 & @xmath93 & @xmath207 + @xmath208 & @xmath96 & @xmath97 + @xmath209 & @xmath97 & / + @xmath210 & @xmath211 & @xmath212 + @xmath213 & @xmath214 & @xmath215 + @xmath216 & @xmath217 & / + @xmath218 & @xmath219 & @xmath220    1     = 2 . cells on level @xmath181 can be filled by linearly interpolating the coarse values on level @xmath180 ( empty circles ) at cross - marked points ( prolongation , green dashed lines , eq . [ eq : prolong ] ) .",
    "cells on level @xmath180 can be filled by averaging down values from level @xmath181 in a conservative way ( restriction , red dotted lines , eq .",
    "[ eq : avgdown ] ) . ]    1        as schematically illustrated in fig .",
    "[ fig : projection ] in two dimensions , the coarse - to - fine prolongation needed in case ( 3 ) ( green dashed lines ) is based on a piecewise linear interpolation at points marked by crosses using the linear slopes computed from the surrounding coarse cells . in three dimensions",
    "the interpolant has the general form : @xmath221 where @xmath222 is the volume coordinate of cell centers of level @xmath180 in direction @xmath49 and @xmath223 is its value on the right and left faces of the cell respectively ( see table [ table : coord ] for definitions ) .",
    "the linear slopes @xmath224 are calculated as central differences , except for cells touching the domain boundary , where one - sided differences are employed . the monotonized - central limiter ( eq [ eq : mclim ] ) is applied to the linear slopes so that no new local extrema are introduced .",
    "notice that , since two contiguous levels are not always synchronized ( see fig .",
    "[ fig : time ] ) , coarse values at an intermediate time are needed to prolong the solution from a coarse level to the ghost zones of a finer level",
    ". coarse values of level @xmath180 are therefore linearly interpolated between time @xmath225 and time @xmath201 and the piecewise linear interpolant eq .",
    "( [ eq : prolong ] ) is applied to the coarse solution @xmath226 where @xmath227 .",
    "this requires that , everytime level @xmath180 and level @xmath181 are synchronized , a timestep on level @xmath180 must be completed before starting the time integration of level @xmath181 .",
    "therefore , the time evolution of the entire level hierarchy is performed recursively from level @xmath228 up to @xmath229 , as schematically illustrated by the pseudo - code in fig .",
    "[ fig : pseudocode ] .    1     and the cells of level @xmath181 adjacent on one side are represented , assuming a refinement ratio @xmath230 .",
    "whenever level @xmath180 and @xmath181 are synchronized , the coarse flux ( red arrow ) must be replaced by the spatial and temporal average of the finer fluxes crossing the fine - coarse interface ( blue arrows , eq .",
    "[ eq : fluxcorr ] ) and the solution must be corrected accordingly ( eq . [ eq : addreflux ] ) . ]",
    "when two adjacent levels are synchronized , some corrections to the solutions are performed to enforce the conservation condition on the entire level hierarchy . to maintain consistency between levels , the solution on the finer level @xmath181 is restricted to the lower level @xmath180 by averaging down the finer solution in a conservative way ( red dotted lines in fig .",
    "[ fig : projection ] ) @xmath231 where @xmath232 is the volume of cell @xmath184 of level @xmath180 .",
    "moreover , the flux through an edge which is shared between a cell of level @xmath180 and @xmath233 cells of level @xmath181 must be corrected to maintain the conservative form of the equations .",
    "for example if the cell @xmath184 on level @xmath180 shares its left boundary with @xmath233 cells of level @xmath181 ( see fig .",
    "[ fig : reflux ] ) , the flux calculated during the coarse integration must be replaced with the average in time and space of the fluxes crossing the @xmath233 faces of the finer level cells . in this particular example , the flux correction is defined as : @xmath234 where the index",
    "@xmath29 sums over the timsteps of level @xmath181 , while @xmath235 and @xmath236 are the indexes transverse to direction @xmath49 .",
    "the flux correction is added to the solution on level @xmath180 after the time integration of level @xmath180 and @xmath181 has been completed : @xmath237    finally , when levels from @xmath180 up to @xmath238 are synchronized , it is possible to tag the cells which need refinement and generate a new hierarchy of grids on levels from @xmath181 up to @xmath238 which covers the tags at each level .",
    "whenever new cells are created on level @xmath181 it is possible to fill them interpolating from level @xmath180 according to eq .",
    "( [ eq : prolong ] ) .",
    "it is important to notice that this interpolant preserves the conservative properties of the solution .      in pluto - chombo zones",
    "are tagged for refinement whenever a prescribed function @xmath239 of the conserved variables and of its derivatives exceeds a prescribed threshold , i.e. , @xmath240 .",
    "generally speaking , the refinement criterion may be problem - dependent thus requiring the user to provide an appropriate definition of @xmath239 .",
    "the default choice adopts a criterion based on the second derivative error norm @xcite , where @xmath241 where @xmath242 is a function of the conserved variables , @xmath243 are the undivided forward and backward differences in the direction @xmath49 , e.g. , @xmath244 .",
    "the last term appearing in the denominator , @xmath245 , prevents regions of small ripples from being refined @xcite and it is defined by @xmath246 similar expressions hold when @xmath72 or @xmath247 . in the computations reported in this paper we use @xmath248 as the default value .      in the usual amr strategy , grids belonging to level @xmath180 are advanced in time by a sequence of steps with typical size @xmath249 where we assume , for simplicity , a grid jump of 2 . here",
    "@xmath250 is chosen by collecting and re - scaling to the base grid the time steps from all levels available from the previous integration step : @xmath251\\,,\\ ] ] where @xmath252 is computed using ( [ eq : dt_cool ] ) . however",
    ", this procedure may become inefficient in presence of source terms whose time scale does not depend on the grid size . as an illustrative example , consider a strong radiative shock propagating through a static cold medium . in the optically thin limit , radiative losses are assumed to be local functions of the state vector , but they do not involve spatial derivatives . if the fastest time scale in the problem is dictated by the cooling process , the time step should then become approximately the same on all levels , @xmath253 , regardless of the mesh size .",
    "however from the previous equations , one can see that finer levels with @xmath254 will advance with a time step @xmath255 smaller than required by the single grid estimate .",
    "( [ eq : level_dt ] ) is nevertheless essential for proper synchronization between nested levels .",
    "simple considerations show that this deficiency may be cured by treating split and leaf cells differently .",
    "split zones in a given level @xmath180 are , in fact , overwritten during the projection step using the more accurate solution computed on children cells belonging to level @xmath181 .",
    "thus , accurate integration of the source term is not important for these cells and could even be skipped .",
    "from these considerations , one may as well evaluate the source term - related time step on leaf cells only , where the accuracy and stability of the computed solution is essential .",
    "this trick should speed up the computations by a factor of approximately @xmath255 , thus allowing to take full advantage of the refinement offered by the amr algorithm without the time step restriction .",
    "besides , this should not alter nor degrade the solution computed during this single hierarchical integration step as long as the projection step precedes the regrid process .",
    "the proposed modification is expected to be particularly efficient in those problems where radiative losses are stronger in proximity of steep gradients .",
    "both pluto@xmath0and pluto - chombo@xmath0support calculations in parallel computing environments through the message passing interface ( mpi ) . since the time evolution of the amr hierarchy",
    "is performed recursively , from lower to upper levels , each level of refinement is parallelized independently by distributing its boxes to the set of processors .",
    "the computation on a single box has no internal parallelization .",
    "boxes are assigned to processors by balancing the computational load on each processor .",
    "currently , the workload of a single box is estimated by the number of grid points of the box , considering that the integration requires approximately the same amount of flops per grid point .",
    "this is not strictly true in some specific case , e.g in the presence of optically thin radiative losses , and a strategy to improve the load balance in such situations is currently under development .",
    "on the basis of the box workloads , chombo s load balancer uses the kernighan - lin algorithm for solving knapsack problems .",
    "chombo _ weak _ scaling performance has been thoroughly benchmarked : defining the initial setup by spatially replicating a 3d hydrodynamical problem proportionally to the number of cpus employed , the execution time stays constant with excellent approximation ( see * ? ? ?",
    "* for more details ) .",
    "to test the parallel performance of pluto - chombo in real applications , we performed a number of _ strong _ scaling tests by computing the execution time as a function of the number of processors for a given setup .",
    "while this is a usual benchmark for static grid calculations , in the case of amr computations this diagnostic is strongly problem - dependent and difficult to interpret .    in order to find some practical rule to improve the scaling of amr calculations , we investigated the dependency of the parallel performance on some parameters characterizing the adaptive grid structure : the maximum box size allowed and the number of levels of refinement employed using different refinement ratios .",
    "as a general rule , the parallel performance deteriorates when the number of blocks per level becomes comparable to the number of processors or , alternatively , when the ideal workload per processor ( i.e. the number of grid cells of a level divided by the number of cpus ) becomes comparable to the maximum box size .",
    "as we will show , decreasing the maximum possible block size can sensibly increase the number of boxes of a level and therefore improves the parallel performance . on the other hand ,",
    "using less refinement levels with larger refinement ratios to achieve the same maximum resolution can lower the execution time , reducing the parallel communication volume and avoiding the integration of intermediate levels .    in section [ sec : mhd_test ] and",
    "[ sec : rmhd_test ] we will present several parallel scaling tests and their dependence on the aforementioned grid parameters .",
    "in this section we consider a suite of test problems specifically designed to assess the performance of pluto - chombo@xmath0for classical mhd flows .",
    "the selection includes one , two and three - dimensional standard numerical benchmarks already presented elsewhere in the literature as well as applications of astrophysical relevance .",
    "the single - patch integrator adopts the characteristic tracing step described in section [ sec : np_char ] with either ppm , weno or linear interpolations carried out in characteristic variables .",
    "the shock tube test problem is a common benchmark for an accurate description of both continuous and discontinuous flow features . in the following we consider one and three dimensional configurations of standard shock tubes proposed by @xcite and @xcite .      1     with @xmath256 .",
    "solid lines correspond to admissible analytic solutions with ( black ) and without ( red ) a compound wave .",
    "the numerical solution ( symbols ) is obtained with 400 grid points . ]     at the vicinity of the compound wave locus , with @xmath257 .",
    "the amr levels vary from @xmath258 to @xmath259 as reported in the legend , exploring cases of equivalent resolution of @xmath260 ( solid ) , @xmath261 ( dot ) , @xmath262 ( dash ) , @xmath263 ( dot - dash ) , @xmath264 ( @xmath159 dot - dash ) , @xmath265 ( long dash ) and @xmath266 ( solid red ) points . at high resolution",
    "the solution converges to the regular one .",
    "this figure is analogous to fig . 3 of @xcite .",
    "]    following @xcite we address the capability of the amr scheme to handle and refine discontinuous features as well as to correctly resolve the non uniqueness issue of mhd riemann problems in finite volume schemes ( @xcite and references therein ) . left and right states are given by @xmath267 where @xmath268 is the vector of primitive variables and @xmath269 .",
    "as discussed by @xcite , for a wide range of initial conditions mhd riemann problems have unique solutions , consisting of lax shocks , contact discontinuities or usual rarefaction waves . nevertheless , there exist certain sets of initial values that can result in non unique solutions .",
    "when this occurs , along with the regular solution arises one that allows for irregular mhd waves , for example a compound wave .",
    "a special case where the latter appears is when the initial transverse velocity components are zero and the magnetic field vectors are anti - parallel .",
    "such a case was noted by @xcite and can be reproduced by simply choosing @xmath270 in our initial condition .",
    "a one dimensional non unique solution is calculated using a static grid with @xmath271 zones , @xmath272 $ ] . left and right boundaries are set to outflow and the evolution stops at time @xmath273 , before the fast waves reach the borders .",
    "the resulting density profile is shown in fig .",
    "( [ fig : sod1d ] ) .",
    "the solid lines denote the two admissible exact solutions : the regular ( red ) and the one containing a compound wave ( black ) , the latter situated at @xmath274 .",
    "it is clear that the solution obtained with the godunov - type code is the one with the compound wave ( symbols ) .",
    "the crucial problematic of this test occurs when @xmath275 is close to but not exactly equal to @xmath276 .",
    "@xcite has proven that regardless of scheme , the numerical solution will erroneously tend to converge to an `` irregular '' one similar to @xmath256 ( pseudo - convergence ) , even if the initial conditions should have a unique , regular solution .",
    "this pathology can be cured either with high order schemes @xcite or with a dramatic increase in resolution on the region of interest , proving amr to be quite a useful tool . to demonstrate this we choose @xmath257 for the field s twist .",
    "cccccc 512 & 0.5 & 0 & 2 & 0.5 & 1 + 1024 & 1.9 & 1 & 2 & 1.1 & 1.7 + 2048 & 7.5 & 2 & 2 & 2.3 & 3.3 + 4096 & 31.6 & 3 & 2 & 4.5 & 7.0 + 8192 & 138.0 & 4 & 2 & 8.7 & 15.9 + 16384 & 546.1 & 5 & 2 & 16.9 & 32.3 + 1048576 & 2.237 @xmath277@xmath278 & 10 & 2 ( 4 ) & 1131.1 & 1977.8 [ tab : mhd_shocktube_timing ]    starting from a coarse grid of @xmath260 computational zones , we vary the number of refinement levels , with a consecutive jump ratio of two . the @xmath259 level run ( solid red line ) incorporates also a single jump ratio of four between the sixth and seventh refinement levels , reaching a maximum equivalent resolution of @xmath266 zones ( see fig .",
    "[ fig : sod1d_amr ] ) .",
    "the refinement criterion is set upon the variable @xmath279 using eq .",
    "( [ eq : refcrit ] ) with a threshold @xmath280 , whereas integration is performed using ppm with a roe riemann solver and a courant number @xmath281 .",
    "as resolution increases the compound wave disentangles and the solution converges to the expected regular form @xcite . in table",
    "[ tab : mhd_shocktube_timing ] we compare the cpu running time of the amr runs versus static uniform grid computations at the same effective resolution . with 5 and 10 levels of refinement ( effective resolutions 16,384 and 1,048,576 zones , respectively )",
    "the amr approach is @xmath282 and @xmath283 times faster than the uniform mesh computation , respectively .",
    "1            the second riemann problem was proposed by @xcite and later considered also by @xcite , @xcite , @xcite , @xcite , @xcite .",
    "an initial discontinuity is described in terms of primitive variables as @xmath284 where @xmath285 is the vector of primitive variables .",
    "the subscript `` 1 '' gives the direction perpendicular to the initial surface of discontinuity whereas `` 2 '' and `` 3 '' correspond to the transverse directions .",
    "we first obtain a one - dimensional solution on the domain @xmath286 $ ] using 6144 grid points , stopping the computations at @xmath287 .    in order to test the ability of the amr scheme to maintain the translational invariance and properly refine the flow discontinuities ,",
    "the shock tube is rotated in a three dimensional cartesian domain .",
    "the coarse level of the computational domain consists of @xmath288 $ ] zones and spans @xmath289 $ ] in the @xmath93 direction while @xmath290 $ ] .",
    "the rotation angles , @xmath38 around the @xmath96 axis and @xmath275 around the @xmath97 axis , are chosen so that the planar symmetry is satisfied by an integer shift of cells @xmath291 .",
    "the rotation matrix can be found in @xcite . by choosing @xmath292 and @xmath293",
    ", one can show @xcite that the three integer shifts @xmath294 must obey @xmath295 where cubed cells have been assumed and @xmath296 will be used .",
    "computations stop at @xmath297 , once again before the fast waves reach the boundaries .",
    "we employ 4 refinement levels with consecutive jumps of two , corresponding to an equivalent resolution of @xmath298 zones .",
    "the refinement criterion is based on the normalized second derivative of @xmath299 with a threshold value @xmath300 .",
    "integration is done with ppm reconstruction , a roe riemann solver and a courant number of @xmath301 .",
    "the primitive variable profiles ( symbols ) are displayed in fig .",
    "[ fig : sod3db ] along the @xmath93 direction axis .",
    "] , together with the one dimensional reference solution in the @xmath302 $ ] region . in agreement with the solution of @xcite ,",
    "the wave pattern produced consists of a contact discontinuity that separates two fast shocks , two slow shocks and a pair of rotational discontinuities .",
    "a three dimensional closeup of the top - hat feature in the density profile is shown in fig .",
    "[ fig : sod3da ] , along with amr levels and mesh .",
    "the discontinuities are captured correctly , and the amr grid structure respects the plane symmetry .",
    "our results favorably compare with those of @xcite and previous similar 2d configurations .",
    "the amr computation took approximately @xmath303 and @xmath304 minutes on two @xmath305 quad - core intel xeon processors ( @xmath306 cores in total ) .",
    "for the sake of comparison , we repeated the same computation on a uniform mesh of @xmath307 zones ( @xmath308 of the effective resolution ) with the static grid version of pluto@xmath0employing @xmath309 seconds .",
    "thus , extrapolating from ideal scaling , the computational cost of the fixed grid calculation is expected to increase by a factor @xmath310 giving an overall gain of the amr over the uniform grid approach of @xmath311 .      1            the next test problem considers the two dimensional advection of a magnetic field loop .",
    "this test , proposed by @xcite , aims to benchmark the scheme s dissipative properties and the correct discretization balance of multi - dimensional terms through monitoring the preservation of the initial circular shape of the loop .    as in @xcite and @xcite",
    ", we define the computational domain by @xmath312 $ ] and @xmath313 $ ] discretized on a coarse grid of @xmath314 grid cells . in the initial condition , both density and pressure are uniform and equal to @xmath315 , while the velocity of the flow is given by @xmath316 with @xmath317 , @xmath318 and @xmath319 . the magnetic field",
    "is then defined through its magnetic vector potential as @xmath320 where @xmath321 , @xmath322 , and @xmath323 .",
    "the simulation evolves until @xmath324 , when the loop has thus performed two crossing through the periodic boundaries .",
    "the test is repeated with @xmath325 , @xmath159 and @xmath326 levels of refinement ( jump ratio of two ) , resulting to equivalent resolutions of @xmath327 $ ] , @xmath328 $ ] and @xmath329 $ ] respectively .",
    "refinement is triggered whenever the second derivative error norm of @xmath330 , computed via eq .",
    "( [ eq : refcrit ] ) , exceeds the threshold @xmath300 . the integration is carried out utilizing weno reconstruction and the roe riemann solver , with @xmath301 .    the temporal evolution of magnetic energy density is seen in fig .",
    "( [ fig : fl2d ] ) , with @xmath326 levels of refinement . as the field loop is transported inside the computational domain ,",
    "the grid structure changes to follow the evolution and retain the initial circular form .",
    "an efficient way to quantitatively measure the diffusive properties of the scheme is to monitor the dissipation of the magnetic energy . in the top panel of fig .",
    "( [ fig : fl2d_energy ] ) we plot the normalized mean magnetic energy as a function of time . by increasing the levels of refinement the dissipation of magnetic energy decreases , with @xmath331 ranging from @xmath332 to @xmath333 of the initial value . in order to quantify the computational gain of the amr scheme we repeat the simulations with a uniform grid resolved onto as many points as the equivalent resolution , without changing the employed numerical method .",
    "the speed - up is reported in the bottom panel of fig .",
    "[ fig : fl2d_energy ] .      1        , analogous to the magnetic reconnection rate @xmath6 , as a function of resistivity .",
    "symbols represent the actual data , whereas over - plotted ( dashed line ) is the sweet - parker scaling @xmath334 , along with a best fit ( solid line ) .",
    "the numerical results are in agreement with the theoretical scaling . ]     as a function of the number of processors ( @xmath335 ) for the resistive reconnection problem .",
    "the different lines refer to the execution times obtained with 5 levels of refinement with consecutive jumps of 2 ( red squares ) , 3 levels with jump ratios @xmath336 ( green crosses ) and a fixed uniform grid with @xmath337 zones ( black plus signs ) .",
    "the dotted line gives the ideal scaling whereas the number of blocks on the finest level at the end of integration is reported above each curve . ]",
    "magnetic reconnection refers to the process of breaking and reconnection of magnetic field lines with opposite directions , accompanied with a conversion of magnetic energy into kinetic and thermal energy of the plasma .",
    "this is believed to be the basic mechanism behind energy release during solar flares .",
    "the first solution to the problem was given independently by @xcite and @xcite , treating it as a two dimensional boundary layer problem in the laminar limit .",
    "according to the sweet - parker model , the magnetic field s convective inflow is balanced by ohmic diffusion . along with the assumption of continuity ,",
    "this yields a relation between reconnection and plasma parameters . if @xmath183 and @xmath338 are the boundary layer s half length and width respectively , we can write the reconnection rate @xmath6 as @xmath339 with @xmath340 and @xmath341 we denote the inflow and outflow speeds , into and out of the boundary layer , respectively .",
    "the lundquist number for the boundary layer is defined as @xmath342 , with @xmath343 being the alfvn velocity directly upstream of the layer , @xmath22 the magnetic resistivity and @xmath183 the layer s half length .",
    "this dependency of the reconnection rate with the square root of magnetic resistivity is called the sweet - parker scaling and has been verified both numerically @xcite and experimentally @xcite .    following the guidelines of the gem magnetic reconnection challenge @xcite ,",
    "the computational domain is a two dimensional cartesian box , with @xmath344 $ ] and @xmath345 $ ] where we choose @xmath346 and @xmath347 .",
    "the initial condition consists of a harris current sheet : the magnetic field configuration is described by @xmath348 whereas the flow s density is @xmath349 , where @xmath350 , @xmath351 and @xmath352 .",
    "the flow s thermal pressure is deduced assuming equilibrium with magnetic pressure , @xmath353 .",
    "the initial magnetic field components are perturbed via @xmath354 where @xmath355 .",
    "the coarse grid consists of @xmath356 $ ] points and additional levels of refinement are triggered using the following criterion based on the current density : @xmath357 where @xmath358 and @xmath359 are the undivided central differences of @xmath360 and @xmath361 in the @xmath93 and @xmath96 direction , respectively , and @xmath362 is the ratio of grid spacings between the base ( @xmath258 ) and current level ( @xmath363 ) .",
    "the threshold values @xmath364 and @xmath365 are chosen in such a way that refinement becomes increasingly harder for higher levels .",
    "we perform test cases using either @xmath366 levels of refinement with a consecutive jump ratio of two or @xmath159 levels with jump ratio @xmath336 reaching , in both cases , an equivalent resolution of @xmath367 mesh points .",
    "boundaries are periodic in the @xmath93 direction , whereas perfectly conducting boundary walls are set at @xmath368 .",
    "we follow the computations until @xmath369 using ppm reconstruction with a roe riemann solver and a courant number @xmath370 . in fig .",
    "[ fig : gem_evolution ] we display the temporal evolution of the current density for a case where the uniform resistivity is set to @xmath371 .",
    "a reconnection layer is created in the center of the domain , which predisposes resistive reconnection @xcite . in agreement with @xcite",
    "the maximum value of the current density decreases with time , ( fig .",
    "4 of that study ) .",
    "as seen in the first two panels ( @xmath372 ) , the refinement criterion is adequate to capture correctly both the boundary layer and the borders of the magnetic island structure . in the rightmost panel ( @xmath369 )",
    "we also draw sample magnetic field lines to better visualize the reconnection region .    in order to compare our numerical results with theory , we repeated the computation varying the value of the magnetic resistivity @xmath22 . for small values of resistivity ( large lundquist numbers @xmath373 ) , the boundary layer is elongated and presents large aspect ratios @xmath374 .",
    "@xcite reports that for @xmath375 beyond the critical value of @xmath376 the boundary layer is tearing unstable , limiting the resistivity range in which the sweet - parker reconnection model operates .",
    "since in the sun s corona @xmath373 can reach values of @xmath377 , secondary island formation must be taken into account @xcite . in this context , ensuring that we respect biskamp s stability criterion , we calculate the temporal average of @xmath378 , analogous to the reconnection rate @xmath6 , for various @xmath22 and reproduce the sweet - parker scaling ( fig . [",
    "fig : gem_rate ] ) .",
    "the boundary layer s half -width ( @xmath338 ) and -length ( @xmath183 ) are estimated from the e - folding distance of the peak of the electric current , while the amr scheme allows us to economically resolve the layer s thickness with enough grid points .",
    "parallel performance for this problem is shown in fig .",
    "[ fig : mhd_gemscaling ] , where we plot the speedup @xmath379 as a function of the number of processors @xmath335 for the 3- and 5-level amr computations as well as for fixed uniform grid runs carried out at the equivalent resolution of @xmath337 zones . here",
    "@xmath380 is the same reference constant for all calculations and equal to the ( inferred ) running time of the single processor static mesh computation while @xmath381 is the execution time measured with @xmath335 processors .",
    "the scaling reveals an efficiency ( defined as @xmath382 ) larger than @xmath383 for less than @xmath384 processors with the 3- and 5-level computations being , respectively , @xmath306 to @xmath385 and @xmath326 to @xmath366 times faster than the fixed grid approach .",
    "the number of blocks on the finest level is maximum at the end of integration and is slightly larger for the 3-level run ( 1058 vs. 835 ) .",
    "this result indicates that using fewer levels of refinement with larger grid ratios can be more efficient than introducing more levels with consecutive jumps of 2 , most likely because of the reduced integration cost due to the missing intermediate levels and the decreased overhead associated with coarse - fine level communication and grid generation process .",
    "efficiency quickly drops when the number of cpu tends to become , within a factor between @xmath325 and @xmath159 , comparable to the number of blocks .      1         for the current sheet problem .",
    "pressure contours , along with the refinement levels and grid are shown . ]",
    "the current sheet problem proposed by @xcite and later considered by @xcite in the amr context is particularly sensitive to numerical diffusion .",
    "the test problem follows the evolution of two current sheets , initialized through a discontinuous magnetic field configuration . driven solely by numerical resistivity ,",
    "reconnection processes take place , making the resulting solution highly susceptible to grid resolution .",
    "the initial condition is discretized onto a cartesian two dimensional grid @xmath386 $ ] , with @xmath387 zones at the coarse level .",
    "the fluid has uniform density @xmath388 and thermal pressure @xmath389 .",
    "its bulk flow velocity @xmath390 is set to zero , allowing only for a small perturbation in @xmath391 , where @xmath392 .",
    "the initial magnetic field has only one non - vanishing component in the vertical direction , @xmath393 where @xmath394 , resulting in a magnetically dominated configuration .",
    "boundaries are periodic and the integration terminates at @xmath395 .",
    "we activate refinement whenever the maximum between the two error norms ( given by eq .",
    "[ eq : refcrit ] ) computed with the specific internal energy and the @xmath96 component of the magnetic field exceeds the threshold value @xmath396 . in order to filter out noise between magnetic island",
    "we set @xmath397 .",
    "we allow for @xmath326 levels of refinement and carry out integration with the roe riemann solver , the improved weno reconstruction and a cfl number of @xmath398 .    in fig .",
    "[ fig : current_evolution ] we show temporal snapshots of pressure profiles for @xmath399 and @xmath400 , along with sample magnetic field lines .",
    "since no resistivity has been specified , the elongated current sheets are prone to tearing instability as numerical resistivity is small with respect to biskamp s criterion @xcite .",
    "secondary islands , `` plasmoids '' , promptly form and propagate parallel to the field in the @xmath96 direction . as reconnection occurs , the field is dissipated and its magnetic energy is transformed into thermal energy , driving alfvn and compressional waves which further seed reconnection @xcite . due to the dependency of numerical resistivity on the field topology , reconnection events are most probable at the nodal points of @xmath401 . at the later stages of evolution ,",
    "the plasmoids eventually merge in proximity of the anti - nodes of the transverse speed , forming four larger islands , in agreement with the results presented in @xcite . a closeup on the bottom left island is shown in fig . [ fig : current_grid ] , at the end of integration .",
    "the refinement criterion on the second derivative of thermal pressure , as suggested by @xcite , efficiently captures the island features of the solution .      1         for the 3d rayleigh - taylor problem computed with 2 ( green crosses ) and 4 ( red squares ) refinement levels between @xmath324 and @xmath402 .",
    "the dotted line gives the ideal scaling .",
    "the number of blocks on the finest level at @xmath324 is printed above and below the corresponding curves . ]    in this example we consider the dynamical evolution of two fluids of different densities initially in hydrostatic equilibrium .",
    "if the lighter fluid is supporting the heavier fluid against gravity , the configuration is known to be subject to the rayleigh - taylor instability ( rti ) .",
    "our computational domain is the box spanned by @xmath403 $ ] , @xmath404 $ ] with gravity pointing in the negative @xmath96 direction , i.e. @xmath405 . the two fluids are separated by an interface initially lying in the @xmath406 plane at @xmath407 , with the heavy fluid @xmath408 at @xmath409 and @xmath410 at @xmath411 . in the current example",
    "we employ @xmath412 , @xmath413 and specify the pressure from the hydrostatic equilibrium condition : @xmath414 so that the sound crossing time in the light fluid is @xmath415 .",
    "the seed for instability is set by perturbing the velocity field at the center of the interface : @xmath416}{10\\cosh(10y)^2}\\ ] ] where @xmath417 .",
    "we assume a constant magnetic field @xmath418 parallel to the interface and oriented in the @xmath93 direction with different field strengths , @xmath419 ( hydro limit ) , @xmath420 ( moderate field ) and @xmath421 ( strong field ) . here",
    "@xmath422 is the critical field value above which instabilities are suppressed @xcite .",
    "we use the ppm method with the roe riemann solver and a courant number @xmath423 .",
    "the base grid has @xmath424 cells and we perform two sets of computations using i ) @xmath326 refinement levels with a grid spacing ratio of @xmath325 and ii ) @xmath325 refinement levels with a grid jump of @xmath326 , in both cases achieving the same effective resolution ( @xmath425 ) .",
    "refinement is triggered using the second derivative error norm of density and a threshold value @xmath426 .",
    "periodic boundary conditions are imposed at the @xmath93 and @xmath97 boundaries while fixed boundaries are set at @xmath427 and @xmath428 .",
    "results for the un - magnetized , weakly and strongly magnetized cases are shown at @xmath429 in fig .",
    "[ fig : mhd_rt ] . in all cases ,",
    "we observe the development of a central mushroom - shaped finger .",
    "secondary instabilities due to kelvin - helmholtz modes develop on the side and small - scale structures are gradually suppressed in the direction of the field as the strength is increased .",
    "indeed , as pointed out by @xcite , the presence of a uniform magnetic field has the effects of reducing the growth rate of modes parallel to it although the interface still remains rayleigh - taylor unstable in the perpendicular direction due to interchange modes . as a net effect ,",
    "the evolution becomes increasingly anisotropic as the field strengthens .",
    "parallel performance is plotted , for the moderate field case , in fig . [",
    "fig : mhd_rtscaling ] where we measure the speedup factors of the 4- and 2- level computations versus the number of cpus . here",
    "the speedup is defined by @xmath379 where @xmath380 is the inferred running time relative to the 4-level computation on a single - processor .",
    "the two - level case shows improved performance over the four - level calculation both in terms of cpu cost as well as parallel efficiency @xmath382 .",
    "indeed the relative gain between the two cases approaches a factor of @xmath325 for an increasing number of cpus .",
    "likewise , the efficiency of the fewer level case remains above @xmath430 up to @xmath260 processors and drops to @xmath431 ( versus @xmath432 for the 4-level case ) at the largest number of employed cores ( @xmath261 ) which is less than the number of blocks on the finest grid .      1",
    "the shock - cloud interaction problem has been extensively studied and used as a standard benchmark for the validation of mhd schemes and inter - code comparisons ( see @xcite and reference therein ) . in an astrophysical context , it adresses the fundamental issue of the complex morphology of supernova remnants as well as their interaction with the interstellar medium . energy , mass and momentum exchange leading to cloud - crushing strongly depends on the orientation of the magnetic field and the resulting anisotropy of thermal conduction .",
    "following @xcite , we consider the two - dimensional cartesian domain @xmath433 $ ] , @xmath434 $ ] with the shock front propagating in the positive @xmath96 direction and initially located at @xmath435 .",
    "ahead of the shock , for @xmath436 , the hydrogen number density @xmath437 has a radial distribution of the form : @xmath438 }   \\,,\\quad    r = \\sqrt{x^2+y^2}\\ ] ] where @xmath439 is the hydrogen number density at the cloud s center , @xmath440 is the ambient number density , @xmath441 is the cloud s radius ( @xmath442 ) and @xmath203 is the radial distance from the center of the cloud .",
    "the ambient medium has a uniform temperature @xmath443 in pressure equilibrium with the cloud , with a thermal pressure of @xmath444 ( we assume a fully ionized gas ) .",
    "downstream of the shock , density and transverse components of the magnetic field are compressed by a factor of @xmath445 while pressure and normal velocity are given by @xmath446 where @xmath447 is the inverse of the hydrogen mass fraction and @xmath448 is the post - shock temperature .",
    "the normal component of the magnetic field ( @xmath360 ) remains continuous through the shock front .",
    "we perform two sets of simulations with a magnetic field strength of @xmath449 , initially parallel ( case bx4 ) or perpendicular ( case by4 ) to the shock front . adopting the same notations as @xcite",
    ", we solve in each case the mhd equations with ( tn ) and without ( nn ) thermal conduction effects for a total of 4 cases .",
    "thermal conductivity coefficients along and across the magnetic field lines ( see eq .",
    "[ eq : tc_flux ] ) are given , in c.g.s units , by @xmath450 the resolution of the base grid is set to @xmath451 points and @xmath366 levels of refinement are employed , yielding an equivalent resolution of @xmath452 .",
    "upwind characteristic tracing ( section [ sec : np_char ] ) together with ppm reconstruction ( eq . [ eq : ppm1 ] ) and the hlld riemann solver are chosen to advance the equations in time .",
    "open boundary conditions are applied on all sides , except at the lower @xmath96 boundary where we keep constant inflow values .",
    "the cfl number is @xmath370 .",
    "refinement is triggered upon density with a threshold @xmath453 .    in fig .",
    "[ fig : mhd_shockcloudbx4 ] and [ fig : mhd_shockcloudby4 ] we show the cloud evolution for the four different cases at three different times @xmath454 ( in units of the cloud crushing time @xmath455 ) .",
    "our results are in excellent agreement with those of @xcite confirming the efficiency of thermal conduction in suppressing the development of hydrodynamic instabilities at the cloud borders .",
    "the topology of the magnetic field can be quite effective in reducing the efficiency of thermal conduction . for a field parallel to the shock front ( tn - bx4 ) , the cloud s expansion and evaporation",
    "are strongly limited by the confining effect of the enveloping magnetic field . in the case of a perpendicular field ( tn - by4 ) , on the contrary , thermal exchange between the cloud and its surroundings becomes more efficient in the upwind direction of the cloud and promotes the gradual heating of the core and the consequent evaporation in a few dynamical timescales . in this case ,",
    "heat conduction is strongly suppressed laterally by the presence of a predominantly vertical magnetic field .      1        [ cols= \" < , < \" , ]      across the middle shock in the radiative jet model at @xmath456 .",
    "temperature density distributions are plotted in the top panel while the first ionization stage of o , h , n and neutral sulphur are plotted in the bottom panel . ]",
    "radiative jet models with a variable ejection velocity are commonly adopted to reproduce the knotty structure observed in collimated outflows from young stellar objects .",
    "the time variability leads to the formation of a chain of perturbations that eventually steepen into pairs of forward / reverse shocks ( the  internal working surfaces ",
    "see , for instance * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) which are held responsible for the typical spectral signature of these objects .",
    "while these internal working surfaces travel down the jet , the emission from post - shocked regions occurs on a much smaller spatial and temporal scale thus posing a considerable challenge even for amr codes .    as an example application",
    ", we solve the mhd equations coupled to the chemical network described in @xcite , evolving the time - dependent ionization and collisionally - excited radiative losses of the most important atomic / ionic species : h , he , c , n , o , ne and s. while hydrogen and helium can be at most singly - ionized , we only consider the first three ( instead of five ) ionization stages of the other elements which suffices for the range of temperatures and densities considered here .",
    "this amounts to a total of 19 additional non - homogeneous continuity / rate equations such as eq .",
    "( [ eq : species ] ) .",
    "the initial condition consists of an axisymmetric supersonic collimated beam in cylindrical coordinates @xmath457 in equilibrium with a stationary ambient medium .",
    "density and axial velocity can be freely prescribed as @xmath458 where @xmath459 and @xmath460 are the jet and ambient mass density , @xmath461 is the jet velocity and @xmath462 is the radius .",
    "the jet density is given by @xmath463 where @xmath464 is the total particle number density , @xmath465 is the mean molecular weight and @xmath466 is the atomic mass unit .",
    "both the initial jet cross section and the environment are neutral with the exception of c and s which are singly ionized .",
    "the steady state results from a radial balance between the lorentz and pressure forces and has to satisfy the time - independent momentum equation : @xmath467 where , for simplicity , we neglect rotations and assume a purely azimuthal magnetic field of the form @xmath468 } \\,.\\ ] ] here @xmath469 is the magnetization radius and @xmath470 is a constant that depends on the jet and ambient temperatures",
    ". direct integration of eq .",
    "( [ eq : rad_equil ] ) yields the equilibrium profile @xmath471 where @xmath472 is the jet pressure on the axis , @xmath465 is the mean molecular weight , @xmath466 is the atomic mass unit , @xmath473 is the boltzmann constant and @xmath474 is the jet temperature . the value of @xmath470 is recovered by solving equation ( [ eq : pequil ] ) in the @xmath475 limit given the jet and ambient temperatures @xmath476 and @xmath477 , respectively .",
    "our choice of parameters is similar to the one adopted by @xcite .",
    "the computational domain is defined by @xmath478 $ ] , @xmath479 $ ] with axisymmetric boundary conditions holding at @xmath480 . at @xmath481",
    "we keep the flow variables constant and equal to the equilibrium solution and add a sinusoidal time - variability of the jet velocity with a period of @xmath482 and an amplitude of @xmath483 around the mean value .",
    "free - outflow is assumed on the remaining sides .",
    "we integrate the equations using linear reconstruction with the mc limiter , eq .",
    "( [ eq : mclim ] ) , and the hllc riemann solver .",
    "the time step is computed from eq .",
    "( [ eq : ca ] , [ eq : dt_cool ] ) using a courant number @xmath484 , a relative tolerance @xmath485 and following the considerations given in section [ sec : cool_source ] .",
    "shock - adaptive hybrid integration is used by locally switching to the more diffusive minmod limiter ( eq . [ eq : minmod ] ) and the hll riemann solver , according to the mechanism outlined in appendix [ app : multid_flattening ] .",
    "the base grid consists of @xmath486 zones and @xmath366 additional levels with grid refinement jumps of @xmath487 are used . at the effective resolution of @xmath488 zones",
    "the minimum length scale that can be resolved corresponds to @xmath489 ( @xmath490 au ) , the same as model @xmath491 of @xcite .",
    "zones are tagged for refinement when the second derivative error norm of density exceeds the threshold value @xmath453 . in order to enhance the resolution of strongly emitting shocked regions , we prevent levels higher than @xmath325 to be created if the temperature does not exceed @xmath492 where @xmath180 is the level number .",
    "the results are shown , after @xmath493 years , in figure [ fig : mhd_radjet ] where the steepening of the perturbations leads to the formation of forward / reverse shock pairs .",
    "radiative losses become strongly enhanced behind the shock fronts where temperature attains larger values and the compression is large .",
    "this is best illustrated in the closeup views of fig [ fig : mhd_radjet ] where we display density , temperature , hydrogen fraction and magnetization for the second ( upper panel ) and third shocks ( lower panel ) , respectively located at @xmath494 and @xmath495 ( in units of the jet radius ) .",
    "owing to a much shorter cooling length , @xmath496 , a thin radiative layer forms the size of which , depending on local temperature and density values , becomes much smaller than the typical advection scale .",
    "an extremely narrow one - dimensional cut shows , in figure [ fig : mhd_radjetcuts ] , the profiles of temperature , density and ionization fractions across the central radiative shock , resolved at the largest refinement level . immediately behind the shock wave , a flat transition region with constant density and temperature",
    "is captured on @xmath497 grid points and has a very small thickness @xmath498 .",
    "a radiatively cooled layer follows behind where temperature drops and the gas reaches the largest ionization degree .",
    "once the gas cools below @xmath499 k , radiative losses become negligible and the gas is accumulated in a cold dense adiabatic layer . a proper resolution of these thin layers",
    "is thus crucial for correct and accurate predictions of emission lines and intensity ratios in stellar jet models @xcite .",
    "such a challenging computational problem can be tackled only by means of adaptive grid techniques .",
    "in this section we apply pluto - chombo@xmath0to test problems involving relativistic magnetized flows in one , two and three dimensions .",
    "both standard numerical benchmarks and applications will be considered . by default , the conservative muscl - hancock predictor scheme ( eq . [ eq : muscl - hancock ] ) together with linear reconstruction on primitive variables are used during the computation of the normal predictors .",
    "1     components of magnetic field and velocity ( bottom left and right ) for the one - dimensional relativistic magnetized shock tube problem at t=0.4 .",
    "we employ a base grid of @xmath271 cells with @xmath366 levels of refinement with consecutive jump ratios of @xmath500 yielding an equivalent resolution of @xmath501 zones .",
    "the grid hierarchy is shown in the top left panel ( dashed red line ) while magnifications of the thin shell are plotted , for each quantity , using symbols in the interior plot windows . ]",
    "our first test consists of an initial discontinuity located at @xmath502 separating two regions of fluids characterized by @xmath503 ( see @xcite and references therein ) .",
    "the fluid is initially at rest with uniform density @xmath388 and the longitudinal magnetic field is @xmath504 .",
    "we solve the equations of relativistic mhd with the ideal gas law ( @xmath505 ) using the 5-wave hlld riemann solver of @xcite and @xmath484 .",
    "the computational domain @xmath506 $ ] is discretized using @xmath366 levels of refinement with consecutive grid jump ratios of @xmath500 starting from a base grid ( level @xmath258 ) of @xmath271 grid zones ( yielding an effective resolution of @xmath501 zones ) .",
    "refinement is triggered upon the variable @xmath507 using eq .",
    "( [ eq : refcrit ] ) with a threshold @xmath300 . at @xmath508 the resulting wave pattern ( fig .",
    "[ fig : rmhd_shocktube ] ) is comprised of two left - going rarefaction fans ( fast and slow ) and two right - going slow and fast shocks . the presence of magnetic fields makes the problem particularly challenging since the contact wave , slow and fast shocks propagate very close to each other , resulting in a thin relativistic blast shell between @xmath509 and @xmath510 .",
    "cccccc 1600 & 6.1 & 1 & 4 & 1.8 & 3.4 + 3200 & 29.9 & 2 & 2 & 3.8 & 7.9 + 6400 & 124.5 & 3 & 2 & 8.2 & 15.2 + 12800 & 502.3 & 4 & 2 & 18.1 & 27.8 + 25600 & 2076.1 & 5 & 2 & 41.2 & 50.4 [ tab : rmhd_shocktube_timing ]    in table [ tab : rmhd_shocktube_timing ] we compare , for different resolutions , the cpu timing obtained with the static grid version of the code versus the amr implementation at the same effective resolution , starting from a base grid of @xmath271 zones . in the unigrid computations , halving the mesh size implies approximately a factor of four in the total running time whereas only a factor of two in the amr approach . at the large resolution employed here ,",
    "the overall gain is approximately @xmath511 .",
    "this example confirms that the resolution of complex wave patterns in rmhd can largely benefit from the use of adaptively refined grids .      1         showing @xmath512 with the overplotted block distribution .",
    "the base grid has @xmath513 zones and @xmath366 levels of refinement are used . ]",
    "the generic alfvn test @xcite consists of the following non planar initial discontinuity @xmath514 where , as in section [ sec : compound ] , @xmath515 is given in the frame of reference aligned with the direction of motion @xmath202 .",
    "the ideal equation of state ( [ eq : gammaeos ] ) with @xmath516 is adopted .",
    "here we consider a two - dimensional version by rotating the discontinuity front by @xmath517 with respect to the mesh and following the evolution until @xmath518 .",
    "the test is run on a coarse grid of @xmath513 zones covering the domain @xmath519 $ ] , @xmath520 $ ] with 6 additional levels of refinement resulting in an effective resolution of @xmath521 zones ( a factor of 2 in resolution is used between levels ) . in order to trigger refinement across jumps of different nature",
    ", we define the quantity @xmath512 together with eq .",
    "( [ eq : refcrit ] ) and a threshold value @xmath280 .",
    "the courant number is @xmath522 and the hlld riemann solver is used throughout the computation .",
    "boundary conditions assume zero - gradients at the @xmath93 boundaries while translational invariance is imposed at the top and bottom boundaries where , for any flow quantity @xmath29 , we set @xmath523 .    the breaking of the discontinuity , shown in fig .",
    "[ fig : rmhd_inclinedtube ] , leads to the formation of seven waves including a left - going fast rarefaction , a left - going alfvn discontinuity , a left - going slow shock , a tangential discontinuity , a right - going slow shock , a right - going alfvn discontinuity and a right - going fast shock .",
    "our results indicate that refined regions are created across discontinuous fronts which are correctly followed and resolved , in excellent agreement with the reference solution ( obtained on a fine one - dimensional grid ) .",
    "note also that the longitudinal component of the magnetic field , @xmath524 , does not present spurious jumps ( fig .",
    "[ fig : rmhd_inclinedtube ] ) and shows very small departures from the expected constant value . in the central region , for @xmath525 , rotational discontinuities and slow shocks are moving slowly and very adjacent to each other thus demanding relatively high resolution to be correctly captured . with the given prescription ,",
    "grid adaptation efficiently provides adequate resolution where needed .",
    "this is best shown in the closeup of the central region , fig .",
    "[ fig : rmhd_inclinedtubelevels ] , showing @xmath526 together with the amr block structure .",
    "a comparison of the performance between static and adaptive grid computations is reported in table [ tab : rmhd_inclinedtube_timing ] using different resolutions and mesh refinements . at the resolution employed here ,",
    "the gain is approximately a factor of @xmath385 .",
    "cccccccccc 128 & 1.8 & & 1 & 2 & 4 & 1.1 & @xmath527 + 256 & 10.8 & & 2 & 2 & 14 & 6.1 & @xmath528 + 512 & 75.2 & & 3 & 2 & 44 & 33.0 & @xmath529 + 1024 & 557.8 & & 4 & 2 & 126 & 185.9 & @xmath530 + 2048 & 4390.5 & & 5 & 2 & 306 & 900.0 & @xmath531 + 4096 & 35250.0 & & 6 & 2 & 761 & 4346.9 & @xmath532 [ tab : rmhd_inclinedtube_timing ]      1         and @xmath533 zones , respectively .",
    "the number of blocks on the finest level ( @xmath534 ) at the end of integration is reported above and below the corresponding curve .",
    "the dotted black line gives the perfect scaling . ]    the two - dimensional rotor problem @xcite consists of a rapidly spinning disk embedded in a uniform background medium ( @xmath535 ) threaded by a constant magnetic field @xmath536 . inside the disk , centered at the origin with radius @xmath537 ,",
    "the density is @xmath538 and the velocity is prescribed as @xmath539 where @xmath540 is the angular frequency of rotation .",
    "the computational domain is the square @xmath541 $ ] with outflow ( i.e. zero - gradient ) boundary conditions .",
    "computations are performed on a base grid with @xmath542 grid points and @xmath104 levels of refinement using the hll riemann solver and a cfl number @xmath543 .",
    "zones are tagged for refinement whenever the second derivative error norm of @xmath544 , computed with ( [ eq : refcrit ] ) , exceeds @xmath545 .",
    "the effective resolution amounts therefore to @xmath546 zones , the largest employed so far ( to the extent of our knowledge ) for this particular problem .",
    "results are shown at @xmath508 in fig .",
    "[ fig : rmhd_rotor ] where one can see an emerging flow structure enclosed by a circular fast forward shock ( @xmath547 ) traveling into the surrounding medium .",
    "an inward fast shock bounds the innermost oval region where density has been depleted to lower values .",
    "the presence of the magnetic field slows down the rotor and the maximum lorentz factor decreases from @xmath259 to @xmath548 .",
    "the numerical solution preserves the initial point symmetry and density corrugations , present in lower resolution runs , seem drastically reduced at this resolution , in accordance with the findings of @xcite .",
    "divergence errors are mostly generated in proximity of the outer fast shock and are damped while being transported out of the domain at the speed of light in the glm formulation .",
    "we monitor the growth of such errors by plotting the volume - average of @xmath549 as a function of time showing ( bottom panel in fig .",
    "[ fig : rmhd_rotor ] ) that the growth of monopole errors is limited to the same values of @xcite ( the factor of @xmath326 comes from the fact that our computational domain is twice as small ) .",
    "parallel performance for this particular test is shown in fig . [",
    "fig : rmhd_rotorscaling ] plotting the speedup , defined as @xmath550 , where @xmath551 is the execution time of the uniform grid run performed at the same effective resolution ( @xmath546 ) on @xmath306 processors while @xmath381 is the running time measured with @xmath335 processors .",
    "amr scaling has been quantified for computations using maximum patch sizes of @xmath552 and @xmath533 grid points resulting , respectively , in @xmath553 and @xmath554 total number of blocks at the end of integration .",
    "approximately half of it belongs to the finest level , as reported in fig [ fig : rmhd_rotorscaling ] . in general , the amr approach offers a @xmath366 to @xmath259 speedup gain in terms of execution time over the uniform , static grid approach . for @xmath555 the parallel efficiency , measured as @xmath382 , is larger than @xmath556 while it tends to be reduced for more processors .",
    "computations carried with fewer blocks ( i.e. larger block sizes ) tend to be more efficient when fewer cpus are in use since inter - processor communications are reduced .",
    "however , this cost becomes sensibly larger at @xmath260 ( or more ) processors resulting in a loss of efficiency .",
    "1        strong symmetric explosions in highly magnetized environments can become rather arduous benchmarks probing the code s ability to evolve strongly magnetized shocks ( see , for instance * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "failures may lead to unphysical densities or pressures whenever the scheme does not introduce adequate dissipation across oblique discontinuities and/or if the divergence - free condition is not properly controlled .",
    "the two dimensional setup considered here consists of the cartesian square @xmath557\\times[-6,6]$ ] initially filled with constant density and pressure values @xmath558 and @xmath559 and threaded by a constant horizontal magnetic field with strength @xmath394 .",
    "a cylinder with radius @xmath560 and centered at the origin delimits a higher density and pressure region where @xmath561 , @xmath562 .",
    "the ideal eos with with @xmath563 is used .",
    "our choice of parameters results in a low @xmath564 plasma ( @xmath565 ) and corresponds to the strongly magnetized cylindrical explosion discussed by @xcite .",
    "we point out that this configuration differs from the one discussed in @xcite and @xcite by having the ambient pressure ten times larger .",
    "this allows to run the computation without having to introduce any specific change or modification in the algorithm , such as shock flattening or redefinition of the total energy .",
    "we adopt a base grid of @xmath566 zones in each direction with outflow boundary conditions holding on all sides .",
    "integration proceeds until @xmath395 using the hllc riemann solver @xcite using @xmath366 levels of refinement , reaching an effective resolution of @xmath567 zones .",
    "total energy triggers refinement with a threshold of @xmath568 .",
    "the over - pressurized region , fig .",
    "[ fig : rmhd_blast2d ] , sets an anisotropic blast wave delimited by a weak fast forward shock propagating almost radially . the explosion is strongly confined along the @xmath93 direction by the magnetic field where plasma is accelerated to @xmath569 .",
    "the inner structure is delimited by an elongated structure enclosed by a slow shock adjacent to a contact discontinuity .",
    "the two fronts blend together as the propagation becomes perpendicular to the field line . since the problem is purely two dimensional , rotational discontinuties are absent .",
    "the block distribution , shown in the lower panel of fig .",
    "[ fig : rmhd_blast2d ] , shows that refinement clusters around the outer discontinuous wave as well as the multiple fronts delimiting the extended inner region .",
    "the total number of blocks is @xmath570 with the finest level giving a relative contribution of @xmath571 and a corresponding volume filling factor of @xmath572 .",
    "the numerical solution retains the expected degree of symmetry and the agreement with earlier results demonstrate the code can robustly handle strongly magnetized relativistic shocks within the glm - mhd formalism .",
    "results obtained with @xmath326 processors show that calculation done with amr is faster than the static grid runs by a factor of @xmath573 .      1              and @xmath574 zones , respectively .",
    "the number of blocks on the finest level , reported above and below each line , stays constant in time .",
    "ideal scaling is given by the dotted black line . ]    in the next example we consider a three - dimensional extension of the cylindrical blast wave problem presented in @xcite .",
    "the initial condition consists of a sphere with radius @xmath560 centered at the origin filled with hot gas having @xmath561 , @xmath562 ( the ideal eos with @xmath563 is used ) . outside this region , density and pressure decrease linearly reaching the constant ambient values @xmath558 , @xmath559 for @xmath575 .",
    "the plasma is at rest everywhere and a constant magnetic field is set oblique to the mesh , i.e. , @xmath576 with @xmath577 .",
    "the computational domain is the cartesian box @xmath557 ^ 3 $ ] covered by a base grid of @xmath574 zones in each direction with outflow boundary conditions holding on all sides . using the hlld riemann solver , we follow integration until @xmath395 using @xmath326 levels of refinement ( effective resolution @xmath578 ) and a cfl number @xmath579 .",
    "zones are tagged for refinement upon density fluctuations with a threshold value of @xmath453 .",
    "results shown in figure [ fig : rmhd_blast3d ] reveal an oval - shaped explosion enclosed by an outer fast shock propagating almost radially .",
    "a strong reverse shock confines a prolate spheroidal region where magnetic field has been drained and inside which expansion takes place radially .",
    "the largest lorentz factor @xmath580 is attained in the direction of magnetic field lines close to the ellipsoid poles .    in order to measure parallel performance on a fixed number of blocks , we have integrated the solution array starting from @xmath581 for a fixed number of steps by enforcing zero interface flux .",
    "results are shown in fig .",
    "[ fig : rmhd_blast3dscaling ] where we compare two sets of `` frozen - flux '' computations with maximum block sizes of 20 and 40 mesh points corresponding , respectively , to 27661 ( 22598 on the finest level ) and 11229 ( 9462 on the finest level ) total number of blocks . in the former case",
    ", the larger number of patches allows to reach a better efficiency ( more than @xmath582 ) whereas the latter case performs worse for increasing number of processors .",
    "even if the finest level has a number of blocks still larger than the maximum number of cpus employed , many boxes are much smaller than the maximum block size allowed .",
    "the ideal workload per processor ( i.e. the number of cells of the finest level divided by the number of processors ) is comparable to the maximum block size in the 1024 cpus run and becomes smaller in the 2048 cpus run . in this latter case ,",
    "the workload of the processors integrating the larger blocks is therefore larger than the ideal one and most of the cpus must wait for these processors to complete the integration .",
    "this could explain the poor parallel performance of this case .      1         between the execution time of the static uniform grid run at the same effective resolution ( @xmath583 ) on @xmath306 processors and the running time measured with @xmath335 processors",
    ". red lines corresponds to the 3-level run using max grid sizes of 16 ( squares ) and 32 ( crosses ) .",
    "green lines corresponds the the 6-level compuations . ]    in the next example @xcite we consider a two - dimensional planar domain with @xmath519 $ ] , @xmath584 $ ] initially filled with a ( relativistically ) hot gas with constant density @xmath388 and pressure @xmath585 .",
    "an initially perturbed shear velocity profile of the form @xmath586\\ ] ] is set across the domain , where @xmath587 is the nominal flow velocity , @xmath588 is the amplitude of the perturbation while @xmath589 , @xmath590 .",
    "the tm equation of state , eq .",
    "( [ eq : tmeos ] ) , is used during the evolution to recover the gas enthalpy from density and pressure .",
    "the magnetic field is initially uniform and prescribed in terms of the components parallel and perpendicular to the plane of integration : @xmath591 where @xmath592 , @xmath593 .",
    "we perform the integration on a base grid of @xmath594 cells with @xmath104 additional levels of refinement , reaching an effective resolution of @xmath595 zones .",
    "the courant number is set to @xmath596 and refinement is triggered whenever eq .",
    "( [ eq : refcrit ] ) computed with total energy density exceeds @xmath597 .",
    "open boundary conditions hold at the lower and upper @xmath96 boundaries while periodicity is imposed in the @xmath93 direction .",
    "[ fig : rmhd_kh ] shows density and magnetic field distributions at @xmath598 which approximately marks the transition from the linear phase to the nonlinear evolution ( see the discussion in * ? ? ?",
    "both density and magnetic field are organized into filaments that wrap around forming a number of vortices arranged symmetrically with respect to the central point .",
    "refined levels concentrate mainly around the location of the fluid interface and accurately follow the formation of the central vortex and the more elongated adjacent ones .",
    "the computation preserves the initial point - symmetry even if the grid generation algorithm does not necessarily do so .",
    "the lower resolution outside this region contributes to damp acoustic waves as they travel towards the outer boundaries and eventually reduces the amount of spurious reflections .    in fig .",
    "[ fig : rmhd_khscaling ] we compare the parallel speedup between a number of adaptive grid calculations using either @xmath104 levels ( grid jump of 2 ) or @xmath159 levels ( grid jump of 4 ) and the equivalent uniform grid run with @xmath583 zones . generally , the amr approach is @xmath599 faster than the fixed grid run .",
    "in addition , the 3-level computation seems to perform somewhat better than the 6-level run although the number of blocks on the finest levels is essentially the same at the end of computation ( 1085 and 1021 , respectively ) .",
    "parallel scaling sensibly deteriorates when the number of blocks per processor becomes less than @xmath159 or @xmath326 , in accordance with the results of previous tests .      1        in the next example we consider a three - dimensional extension of the planar relativistic shock - cloud interaction originally presented in @xcite",
    ". the initial condition consists of a high density ( @xmath538 ) spherical clump ( radius @xmath600 ) centered at @xmath601 adjacent to a shock wave located at @xmath602 with downstream and upstream values given by @xmath603 for @xmath604 and @xmath605 for @xmath606 .",
    "the remaining quantities are set to zero .",
    "the computational domain is the box @xmath607 $ ] , @xmath608 $ ] . at the base level we fix the resolution to @xmath609 zones and employ @xmath326 levels of refinement equivalent to an effective resolution of @xmath610 .",
    "the refinement criterion ( [ eq : refcrit ] ) uses the conserved density for zone tagging with a threshold @xmath396 .",
    "the equations of relativistic mhd are solved using the tm eos @xcite , the hlld riemann solver and linear reconstruction with the harmonic limiter ( [ eq : harmonic_lim ] ) .",
    "shock adaptive hybrid integration provides additional numerical dissipation in proximity of strong shock waves by switching the integration scheme to the hll riemann solver and the minmod limiter ( eq . [ eq : minmod ] ) , according to the strategy described in appendix [ app : multid_flattening ] . for efficiency purposes ,",
    "we take advantage of the symmetry across the @xmath611 and @xmath406 planes to reduce the computation to one quadrant only .",
    "[ fig : rmhd_shockcloud ] shows a three - dimensional rendering of density and magnetic pressure through a cross - sectional view of the @xmath611 and @xmath406 planes at @xmath612 .",
    "the collision generates a fast , forward bow shock propagating ahead and a backward reverse shock transmitted back into the cloud .",
    "the cloud becomes gradually wrapped by the incident shock into a mushroom - shaped shell reaching a large compression ( @xmath613 , @xmath614 ) .",
    "grid refinement concentrates mainly around the incident and forward shocks and the tangential discontinuities bordering the edge of the cloud .      1         as a final application",
    ", we discuss the three - dimensional propagation of a relativistic magnetized jet carrying an initially purely azimuthal magnetic field .",
    "indeed , the presence of a substantial toroidal component of the field is commonly invoked and held responsible for the acceleration and collimation of jets from active galactic nuclei .",
    "if on one hand cylindrical mhd configuration are expected to be unstable to reflection , kelvin - helmholtz and current driven modes , on the other hand astrophysical jets appear to be quite stable thus posing an unsolved issue , see @xcite and reference therein .",
    "following @xcite we set the box @xmath615 $ ] , @xmath616 $ ] as our computational domain , initially filled with constant uniform density and pressure @xmath617 and @xmath618 .",
    "the beam is injected at the lower boundary for @xmath619 , @xmath620 with a density @xmath459 , a longitudinal velocity corresponding to a lorentz factor @xmath621 and an azimuthal magnetic field given by @xmath622 where @xmath623 is the magnetic field strength in the fluid s frame and @xmath624 is the magnetization radius .",
    "the pressure profile is found by imposing radial momentum balance across the beam giving @xmath625\\,,\\ ] ] where @xmath618 is the ambient pressure defined in terms of the sonic mach number @xmath626 : @xmath627 with @xmath516 although the tm equation of state ( [ eq : tmeos ] ) is used during the evolution .",
    "the actual value of @xmath623 may be found by prescribing the magnetization parameter @xmath628 defined as the ratio between beam - averaged magnetic energy density and thermal pressure .",
    "the final result yields @xcite : @xmath629 for the present simulation we adopt @xmath630 , @xmath631 , @xmath632 , @xmath633 and @xmath634 thus corresponding to a magnetically dominated , underdense relativistic jet .",
    "we follow the simulation up to @xmath635 ( in units of the speed of light crossing of the jet radius ) , starting with a base grid of @xmath636 with @xmath326 levels of refinement .",
    "the refinement ratio between consecutive levels is 2 so that , at the finest resolution , we have @xmath637 points per beam radius . zones belonging to levels 0,1 and 2 are tagged for refinement using the normalized second - derivative eq .",
    "( [ eq : refcrit ] ) of the total energy density with a threshold @xmath638 . zones at the finest level grid are instead created by using @xmath639 in place of the total energy density .",
    "the rationale for choosing this selective rule is to provide the largest resolution on the jet material only , still being able to track the sideway expansion of the cocoon at lower resolution .",
    "we use the hlld riemann solver with the harmonic limiter ( [ eq : harmonic_lim ] ) except at strong shocks where we employ the multidimensional shock dissipation switch outlined in appendix [ app : multid_flattening ] .",
    "the courant number is @xmath640 .    the jet structure , fig .",
    "( [ fig : rmhd_jet ] ) , shows that the flow maintains a highly relativistic central spine running through multiple recollimation shocks where jet pinching occurs . at the jet head the beam decelerates to sub - relativistic velocities favoring the formation of a strongly magnetized termination shock where @xmath641",
    ", the presence of a predominant toroidal magnetic field induces current driven ( cd ) kink instability which are responsible for the observed jet wiggling and symmetry breaking ( see @xcite ) .",
    "this test shows that pluto - chombo@xmath0can be effectively used in simulations involving relativistic velocities , highly supersonic flows and strongly magnetized environments .    at @xmath635",
    "the finest level grid has a volume filling factor of @xmath642 per cent with 10761 blocks while level @xmath159 occupies @xmath643 per cent of the total volume with 5311 blocks . for this particular application ,",
    "the benefits offered by grid adaptivity are more evident at the beginning of the computation when most of the computational zones in the domain are unrefined . in this respect",
    ", we have found that the cpu time increases ( for @xmath644 ) with the number of steps @xmath236 approximately as @xmath645 where @xmath646 , @xmath647 , @xmath648 and @xmath649 .",
    "this suggests that , as long as the filling factor remains well below @xmath315 , the amr calculation with the proposed refinement criterion should be at least @xmath650 times faster than an equivalent computation using static mesh refinement and considerably larger if compared to a uniform grid run at the effective resolution .",
    "in this paper , we have presented a cell - centered implementation of the pluto code for multi - dimensional adaptive mesh refinement ( amr ) computations targeting newtonian and relativistic magnetized flows .",
    "a block structured approach has been pursued by taking full advantage of the high - level parallel distributed infrastructure available in the chombo library .",
    "this choice provides the necessary level of abstraction in delivering amr functionality to the code allowing , at the same time , full compatibility with most of the modular implementations already available with the static grid version .",
    "this eases up the process of adding or replacing physics modules as long as they comply with the interface requirements .",
    "a novel extension to incorporate diffusion terms such as viscosity , resistivity and heat conduction without the need for operator splitting , has been illustrated in the context of the dimensionally unsplit corner transport upwind ( ctu ) time stepping scheme .",
    "in addition , the scheme has also been extended to the realm of relativistic mhd ( rmhd ) using a characteristic projection - free , muscl - hancock normal predictor step .",
    "the integration scheme retains second - order spatial and temporal accuracy requiring 6 riemann solvers per cell per step .",
    "interface states are calculated using the piecewise parabolic method ( ppm ) integration although alternatives based on weighted essentially non - oscillatory ( weno ) or linear slope - limited schemes are also available .",
    "the proposed cell - centered version of pluto - chombo enforces the divergence - free condition by augmenting the system of equations with a generalized lagrange multiplier ( glm , see * ? ? ?",
    "* ) , in the implementation outlined by @xcite .",
    "the choice of the glm - mhd formalism has proven to be a convenient starting point in porting a significant fraction of the static grid code implementations to the amr framework .",
    "although future extensions will also consider other strategies to enforce the @xmath651 condition , the proposed formulation offers substantial ease of implementation and a viable robust alternative to a constrained transport approach which typically requires additional care for prolongation and restriction operations at fine - coarse interfaces ( see , for instance , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "a suite of several test problems including standard numerical benchmarks and astrophysical applications for mhd and rmhd has been selected to assess the efficiency of pluto - chombo in resolving complex flow patterns viable through an adaptive grid approach in 1 , 2 and 3 dimensions .",
    "examples include simple shock - tube problems , resistive sheets , radiative and thermally conducting flows , fluid instabilities and blast wave explosions in highly magnetized environments .",
    "the computational saving offered by an adaptive grid computation has been shown , for many of the selected test , to be several times or even order of magnitudes faster than a static grid integration .",
    "parallel performance , evaluated for some of the proposed tests , suggests good scalability properties for two- and three - dimensional problems as long as the number of grids per processor is larger than a factor between @xmath325 and @xmath159 .",
    "both the static and amr version of pluto@xmath0are distributed as a single software package publicly available at ` http://plutocode.ph.unito.it/ ` while the chombo library can be freely downloaded from ` https://seesar.lbl.gov/anag/chombo/ ` . the amr version of pluto@xmath0has been designed to retain salient features characterizing the static grid version @xcite such as modularity - the possibility to easily combine different numerical schemes to treat different physics- , portability and user - friendliness . while stable code releases along with extensive documentation and benchmarks are made available on the web , the code is being actively developed and future development will address additional new physical aspects as well as improved numerical algorithms .",
    "this work has been supported by the prin - inaf 2009 grant .",
    "we acknowledge the cineca awards n. hp10cj1j54 and n. hp10bhhhej , 2010 under iscra initiative for the availability of high performance computing resources and support .",
    "intensive parallel computations were performed on the 4.7 ghz ibm power 6 p575 cluster running aix 6 or the 0.85 ghz ibm bluegene / p cluster running cnl .",
    "the discretization of the heat conduction flux , eq .",
    "( [ eq : tc_flux ] ) , reflects the mixed parabolic / hyperbolic mathematical nature of the underlying differential operators , as anticipated in section [ sec : nonideal ] . from the diffusion limit , @xmath652 , we compute @xmath653 at cell interfaces using second - order accurate central difference expressions for @xmath654 , e.g. , at constant @xmath93-faces , @xmath655 and similarly at constant @xmath96- and @xmath97- faces . in the purely hyperbolic limit , @xmath656",
    ", we see that @xmath657 where @xmath658 is a unit vector in the direction of the heat flux . to gain more insights , we re - write the one - dimensional energy equation in this limit by keeping only pressure - related terms , that is , @xmath659 where @xmath660 is the isothermal speed of sound and @xmath661 .",
    "equation ( [ eq : sat_eq ] ) is a nonlinear advection equation of the form @xmath662 where @xmath663 and @xmath664 is the hyperbolic saturated flux .",
    "a stable discretization is therefore provided by adopting an upwind scheme @xcite such as @xmath665 in the previous equation @xmath666 , @xmath667 and @xmath668 are computed from the left / right input states for the riemann problem .",
    "finally , we define the thermal conduction flux at constant @xmath93-faces ( for instance ) as the harmonic mean between the two regimes , @xmath669 where @xmath670 is computed from eq .",
    "( [ eq : sat_flux ] ) .",
    "in regions of strong shocks or gradients spurious numerical oscillations may arise and quickly lead to the occurrence of unphysical states characterized , for example , by negative pressures , energies , densities or , in the case of relativistic flows , superluminal speeds .",
    "such episodes are usually limited to very few grid zones and are originated by either insufficient numerical diffusion or lack of a physical solution of the riemann problem .    to circumvent this potential hitch , pluto@xmath0provides a safeguard built - in mechanism that i ) flag zones that may potentially reside inside a strong shock wave and ii ) introduces additional numerical dissipation by locally replacing the integration scheme with a more diffusive one .",
    "for these reasons , most of the interpolation schemes and riemann solvers available with pluto@xmath0embody a hybrid selective mechanism that allows to switch , if required , to a more dissipative choice .",
    "this process is controlled by a 3d array of integers where each element represents a set of flags that can be individually turned on or off by simple bitwise operations .",
    "zones are flagged according to a flexible shock - detection criterion , @xmath671 where @xmath672 is a standard central difference operator , @xmath29 is thermal ( default ) or magnetic pressure , @xmath673 is the velocity and @xmath674 is a free adjustable parameter ( default is 5 ) .",
    "the first condition detects zones within a strong gradient while the second one is switched on where compressive motion takes place .",
    "when both conditions are met , we flag the zone @xmath675 to be updated with the hll riemann solver . at the same time",
    "we also flag all neighboring zones whose interpolation stencil includes the shocked zone to be interpolated using slope - limited reconstruction with the minmod limiter .",
    "we note that both flags may be selected and combined independently and , in any case , preserve the second - order accuracy of the scheme ."
  ],
  "abstract_text": [
    "<S> we present a description of the adaptive mesh refinement ( amr ) implementation of the pluto code for solving the equations of classical and special relativistic magnetohydrodynamics ( mhd and rmhd ) . </S>",
    "<S> the current release exploits , in addition to the static grid version of the code , the distributed infrastructure of the chombo library for multidimensional parallel computations over block - structured , adaptively refined grids . we employ </S>",
    "<S> a conservative finite - volume approach where primary flow quantities are discretized at the cell - center in a dimensionally unsplit fashion using the corner transport upwind ( ctu ) method . </S>",
    "<S> time stepping relies on a characteristic tracing step where piecewise parabolic method ( ppm ) , weighted essentially non - oscillatory ( weno ) or slope - limited linear interpolation schemes can be handily adopted . a characteristic decomposition - free version of the scheme is also illustrated . </S>",
    "<S> the solenoidal condition of the magnetic field is enforced by augmenting the equations with a generalized lagrange multiplier ( glm ) providing propagation and damping of divergence errors through a mixed hyperbolic / parabolic explicit cleaning step . among the novel features </S>",
    "<S> , we describe an extension of the scheme to include non - ideal dissipative processes such as viscosity , resistivity and anisotropic thermal conduction without operator splitting . </S>",
    "<S> finally , we illustrate an efficient treatment of point - local , potentially stiff source terms over hierarchical nested grids by taking advantage of the adaptivity in time . </S>",
    "<S> several multidimensional benchmarks and applications to problems of astrophysical relevance assess the potentiality of the amr version of pluto in resolving flow features separated by large spatial and temporal disparities .    1 </S>"
  ]
}