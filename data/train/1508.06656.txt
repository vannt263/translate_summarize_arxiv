{
  "article_text": [
    "massive multiple - input multiple - output ( mimo ) transmission , in which a base station is equipped with hundreds of antennas for multiuser operation , is considered as one of the key enabling technologies for 5 g  @xcite . in @xcite , it was first proposed for multi - cell noncooperative scenarios .",
    "such large antenna arrays can substantially reduce the effects of noise , small - scale fading and inter - user interference , using only simple signal processing techniques with reduced total transmit power , and only inter - cell interference caused by pilot contamination remains  @xcite .",
    "subsequently , the energy and spectral efficiency of very large multiuser mimo systems were investigated in the single cell scenarios in @xcite , which showed that the power radiated by the terminals could be made inversely proportional to the square - root of the number of base station antennas with no reduction in performance when considering imperfect channel state information ( csi ) , and that the power could be made inversely proportional to the number of antennas if perfect csi were available .",
    "currently , massive mimo combined with cooperative relaying is considered as a strong candidate for the development of future energy - efficient networks and has received increasing attention  @xcite . in the field of cooperative relaying , two - way relaying technique",
    "outperforms one - way relaying in terms of spectral efficiency , since it employs the principle of network coding at the relay in order to mix the signals received simultaneously from two links for subsequent forwarding , and then applies the self - interference cancellation ( sic ) at each user to extract the desired information  @xcite . for the multi - pair two - way relaying with massive mimo",
    ", @xcite obtained the asymptotic spectral and energy efficiencies of the system analytically with both maximum - ratio combining / maximum - ratio transmission ( mrc / mrt ) and zero - forcing reception / zero - forcing transmission ( zfr / zft ) beamforming , supposing that the number of relay antennas approaches to infinity and the transmit power of all users is equal .",
    "however , only asymptotic cases with perfect csi and perfect sic were studied and no closed - form expression for the ergodic achievable rate with finite number of relay antennas was derived in @xcite . in @xcite , the ergodic achievable rates were investigated with perfect csi based mrc / mrt used at the relay , providing a capacity lower bound , the derivation of which involved asymptotic approximations .",
    "neither @xcite nor @xcite considers imperfect csi or power allocation ( pa ) problems .    in the literature ,",
    "instantaneous power allocation schemes based on instantaneous rate for regular scale mimo rather than massive mimo were presented for one way or two way af wireless relay systems to improve system performance  @xcite . in massive mimo systems ,",
    "ergodic rate is usually used in power allocation because the instantaneous rate approaches the ergodic rate as the number of antennas tends to infinity due to the law of large numbers , and such pa schemes are more practical with lower complexity than instantaneous rate based ones . in @xcite , an ergodic rate based optimal power allocation ( opa ) scheme was proposed for a multi - pair decode - and - forward ( df ) one - way relaying with massive arrays .",
    "nevertheless , power allocation has not been addressed in a massive mimo two - way relaying system .",
    "besides , there is no closed - form ergodic rate expressions derived for massive mimo two - way relaying with zfr / zft in the literature .",
    "this paper considers a multi - pair two - way af relaying system where multiple sources exchange information via a relay node equipped with large - scale arrays . assuming imperfect csi estimation , the relay station employs the mrc / mrt and zfr / zft beamforming to process the signals , respectively .",
    "first , utilizing the technique in @xcite , we derive for the first time two statistical csi ( scsi ) based closed - form lower bounds for the ergodic achievable rate in the case of arbitrary number of relay antennas ( without resorting to asymptotic approximations ) with mrc / mrt and zfr / zft processing , respectively , based on the properties of wishart and inverse wishart matrices .",
    "having obtained the closed - form expressions , we are able to design an opa scheme that maximizes the sum spectral efficiency under certain practical constraints . the proposed opa scheme is based on geometric programming ( gp )  @xcite , which can be solved by conventional optimization tools , such as cvx  @xcite .",
    "considering the massive mimo properties , an asymptotically opa is presented for the asymptotic regimes with closed - form solutions .",
    "the derived closed - form expressions for the achievable rate are verified to be accurate predictors of the system performance by monte - carlo simulations .",
    "furthermore , in order to demonstrate the effectiveness of the developed opa schemes , simulations of spectral efficiency are conducted under different system configurations , respectively , in comparison to the equal power allocation ( epa ) schemes .",
    "the rest of the paper is organized as follows .",
    "we briefly describe the system model for the multi - pair two - way af relaying in section  [ sec : sys_model ] . in section  [ achiev_rate ] , two closed - form expressions for the achievable rate",
    "are derived for mrc / mrt and zfr / zft , respectively , followed by asymptotic analysis .",
    "then , an opa and an asymptotically opa are proposed by solving the sum - rate maximization based optimization problem in section  [ pa ] .",
    "furthermore , simulation results under different system configurations are given in section  [ numericalresults ] to demonstrate the effectiveness of both derived rate expressions and developed opas . finally , we draw our conclusions in section  [ conclusion ] .    _",
    "notations : _ for a matrix @xmath0 , we use @xmath1 , @xmath2 , @xmath3 and @xmath4 to denote the trace , the transpose , the hermitian transpose , and the conjugate , respectively .",
    "the symbol @xmath5 indicates the 2-norm of vector @xmath6 and @xmath7 denotes a diagonal matrix with @xmath6 being its diagonal entries .",
    "moreover , @xmath8 denotes the @xmath9 identity matrix , @xmath10 $ ] and @xmath11 $ ] denotes the expectation and the variance operators , respectively .",
    "@xmath12^+$ ] denotes @xmath13 .",
    "finally , @xmath14 represents a circularly symmetric complex gaussian vector @xmath6 with zero mean and covariance matrix @xmath15 .",
    "[ fig : systemmodel ] shows the considered multi - pair two - way af relaying network , where @xmath16 pairs of users communicate with the help of a common relay station by sharing the same time - frequency resources . in this system ,",
    "two single - antenna users in the @xmath17th user pair denoted by @xmath18 or @xmath19 ( for @xmath20 ) want to exchange information with each other via the relay equipped with @xmath21  ( @xmath22 ) antennas .",
    "notably , the direct links between the corresponding users are assumed non - existing in the two - way relaying system .",
    "typically , a two - way network is divided into two phases , namely the multiple - access ( ma ) phase and the broadcast ( bc ) phase @xcite . in the ma phase",
    ", information is sent from the user pairs to the relay ; while in the bc phase , the relay broadcasts the processed information .",
    "let @xmath23  ( @xmath24 ) and @xmath25 denote the power transmitted by user @xmath26 and the relay corresponding to the ma and bc phases , respectively .",
    "we assume that all the channels between the users and the relay follow independent and identically distributed ( i.i.d . )",
    "rayleigh fading and time division duplex ( tdd ) is adopted in all transceivers .",
    "thus , supposing that @xmath27 is the channel between the @xmath26th user and the relay , @xmath28 contains the i.i.d .",
    "@xmath29 elements , where @xmath30 represents the corresponding large - scale fading coefficient . in this way",
    ", we can denote the channel matrix between all the users and the relay accounting for both small - scale fading and large - scale fading by @xmath31 \\in { \\mathbb{c}^{n \\times 2k } } \\end{split}\\ ] ] where @xmath32 includes the i.i.d .",
    "@xmath33 small - scale fading coefficients , and @xmath34 is the large - scale fading diagonal matrix with the @xmath26th diagonal elements denoted by @xmath30  ( @xmath35 ) .      practically , the channel matrices in both the ma and bc phases have to be estimated for relay processing .",
    "however , due to the large - scale antenna array at the relay , channel estimation at the user side becomes rather impractical .",
    "thus , time division duplex ( tdd ) is adopted here and channel reciprocity can be utilized , i.e. , only channel matrix @xmath36 between all the users and the relay has to be estimated based on the uplink training .",
    "the relay then has the estimated csis of all uplink and downlink channels .",
    "the required channel related information at the user side can be calculated by the relay and fed back to the users , as will be explained later . at the beginning of each coherence interval @xmath37 ,",
    "all users simultaneously transmit pilot sequences of length @xmath38 symbols .",
    "the pilot sequences of all the @xmath39 users are pairwisely orthogonal , i.e. , @xmath40 is required .",
    "then the training matrix received at the relay is @xmath41 where @xmath42 is the transmit power of each pilot symbol , @xmath43 is the additive white gaussian noise ( awgn ) matrix with i.i.d .",
    "components following @xmath44 , the training vector transmitted by the @xmath26th  ( @xmath45 ) user is denoted by the @xmath26th row of @xmath46 , satisfying @xmath47 . moreover , since the rows of pilot sequence matrices are pairwisely orthogonal , we have @xmath48  ( @xmath49 ) .    in order to estimate the channel matrices",
    "@xmath36 , we employ the minimum mean - square - error ( mmse ) estimation at the relay .",
    "the mmse channel estimates are given by  @xcite @xmath50 where we define @xmath51 and @xmath52 .",
    "according to the property of @xmath53 , we conclude that @xmath54 is composed of i.i.d .",
    "@xmath44 elements .",
    "then , @xmath55 \\in { \\mathbb{c}^{n \\times 2k}}\\ ] ] where @xmath56 $ ] denotes the estimation error matrix which is independent of @xmath57 from the property of mmse channel estimation  @xcite .",
    "hence , we have @xmath58 with @xmath59 , and @xmath60 with @xmath61 .",
    "the diagonal elements satisfy @xmath62 and @xmath63 with @xmath64 .",
    "since the relay station estimates all the channels , it employs linear processing mrc / mrt and zfr / zft based on the imperfect csi . while each user only has the knowledge of its pairwise effective channel coefficient for data detection and self - interference cancellation coefficient for sic , which are calculated and sent out by the relay . in the ma phase ,",
    "all the users transmit their signals simultaneously to the relay . that is , the received signal at the relay station is given by @xmath65 where @xmath66 , @xmath67 with each power satisfying @xmath68 , @xmath69^t}$ ] with the @xmath26th element @xmath70 representing the transmitted signal by the @xmath26th user and @xmath71 = { { \\bf{i}}_{2k}}$ ] , @xmath72 , and @xmath73 is the additive white gaussian noise ( awgn ) vector at the relay with zero mean and the variance of @xmath74 .",
    "then , in the bc phase , the relay multiplies the received signal by a linear receiving and precoding matrix to yield the relay transmitted signal given by @xmath75 , where @xmath76 is the combined beamforming matrix at the relay and its expression will be given in the next subsection .",
    "the transmitted signal satisfies the expected transmit power constraint at the relay  @xcite , i.e. , @xmath77 = { \\rm tr}\\left\\ { { { \\rm e}\\left [ { { \\bf{f}}\\left ( { { \\tilde{\\bf g}}{{{\\tilde{\\bf g}}}^h } + \\sigma _ n^2{\\bf{i}}_n } \\right){{\\bf{f}}^h } } \\right ] } \\right\\}. \\end{split}\\ ] ] with a total power constraint @xmath78 and @xmath79 are two constants preset for the total power constraint and individual power constraint , respectively . ] . in the bc phase",
    ", the received signal at the @xmath80th user can be expressed as @xmath81 where @xmath82 is defined to indicate the @xmath83th . ]",
    "user pair , and @xmath84 represents the awgn noise at the @xmath80th user side with zero mean and variance of @xmath85 .    using the estimated csi , the relay calculates and sends out the sic coefficient @xmath86  ( @xmath87 ) for each user .",
    "hence , the received signal at the @xmath80th user after sic is rewritten as @xmath88 where the residual self - interference involves @xmath89 , since the sic coefficient @xmath90 for user @xmath80 is obtained from the estimated csi . here",
    ", we suppose that there is no error during the sic coefficients transmission from the relay .      in this subsection",
    ", the simple and widely used mrc / mrt beamforming is adopted .",
    "according to @xcite , the imperfect csi based mrc / mrt beamforming is given by @xmath91 where @xmath92 is the block diagonal permutation matrix indicating the user pairing format with @xmath93 $ ] , and @xmath94 is a normalization constant , chosen to satisfy the power constraint at the relay station in ( [ power_consr ] ) .    by substituting ( [ f ] ) into ( [ power_consr ] ) , we have @xmath95 + { \\rm e}\\left [ { { { \\left\\| { { { \\hat{\\bf g}}^*}{\\bf{t}}{{\\hat{\\bf g}}^h}{{\\bf{n}}_{\\rm{r } } } } \\right\\|}^2 } } \\right]}}}\\\\ & \\mathop   = \\limits^{(b)}\\sqrt { \\frac{{{p_{\\rm{r}}}}}{{n\\left ( { n + 1 } \\right)\\left [ { 2\\left ( { \\psi   + \\sigma _ n^2 } \\right)\\hat\\phi   + \\left ( { n + 1 } \\right)\\sum\\limits_{i = 1}^k { { \\hat\\psi _ i}{\\hat\\phi _ i } } } \\right ] } } } \\end{split}\\ ] ] where @xmath96 the detailed derivation of the equation is given in appendix a.      when employing zfr / zft with imperfect csi , in which the pseudo - inverse of the estimated channels in ( [ estimated_csi_exp ] ) are needed for processing , the linear beamforming is given by  @xcite @xmath97 where @xmath98 and @xmath99 is the normalization constant , chosen to satisfy the transmit power constraints at the relay .",
    "notably , sic is not necessary as zfr / zft leads to @xmath100  ( @xmath101 ) .",
    "on the basis of ( [ hat_f ] ) and @xmath102 , we have @xmath103 + { \\rm e}\\left [ { { { \\left\\| { { \\hat { \\bar { \\bf{g}}}}^*{\\bf{t}}{\\hat { \\bar { \\bf{g}}}}^h{{\\bf{n}}_{\\rm{r } } } } \\right\\|}^2 } } \\right]}}}\\\\ & \\mathop   = \\limits^{(b ) } \\sqrt { \\frac{{{p_{\\rm{r}}}}}{{\\sum\\limits_{i = 1}^{2k } { \\frac{{{p_{i'}}}}{{\\left ( { n - 2k - 1 } \\right)\\hat \\sigma _ i^2 } } + \\hat \\eta \\left ( { \\sum\\limits_{j = 1}^{2k } { { p_j}\\sigma _ { { \\xi _ j}}^2 }   + \\sigma _ n^2 } \\right ) } } } } \\end{split}\\ ] ] where @xmath104 . the detailed derivation of ( [ hat_alpha ] ) is given in appendix b.",
    "in this section , a general form of the ergodic achievable rate of the transmission link @xmath105 for mrc / mrt processing is given first , followed by a rate expression for zfr / zft . in order to obtain a basic and insightful expression that can be used for power allocation optimization",
    ", a simplified capacity lower bound is derived utilizing the technique of @xcite , in which the received signal is rewritten as a known mean times the desired symbol , plus an uncorrelated effective noise . the worst - case uncorrelated effective noise , where each additive term is treated as independent gaussian noise of the same variance ,",
    "is employed to derive a lower bound .    from ( [ rereceive_signal ] ) ,",
    "the ergodic achievable rate of the transmission link @xmath105 is expressed as ( [ icsi_rate ] ) .",
    "@xmath106 . \\end{split}\\ ] ]    _ remark 1 : _ here , the ergodic achievable rate is valid based on the assumption that the receiving user @xmath80 knows perfectly @xmath107 in the detection process . to demonstrate the accuracy of the derived lower bounds , we compare the lower bounds with monte - carlo realized ( [ icsi_rate ] ) in section [ numericalresults ] .",
    "the normalization constant for @xmath108 in ( [ icsi_rate ] ) is assumed to be calculated based on instantaneous csi by satisfying @xmath109",
    ".    further derivation of ( [ icsi_rate ] ) is difficult because of the intractability to carry out the ensemble average analytically .",
    "instead , we adopt the technique in @xcite to derive a worst - case lower bound of the achievable rate . the first step is to rewrite @xmath110 in ( [ rereceive_signal ] ) as the sum of @xmath111{x_k}$ ] and @xmath112 } \\right){x_k}$ ] , where the first part is now considered as the `` desired signal '' .",
    "that is , ( [ rereceive_signal ] ) can be expressed as @xmath113{x_k}}_{\\text{desired signal } } + \\underbrace{{{\\tilde n}_{k'}}}_{\\text{effective noise}}\\ ] ] where @xmath114 is considered as the effective noise and given by @xmath115 } \\right){x_k } + \\sqrt { { p_{k ' } } } \\lambda_{k'}{x_{k ' } } \\\\ & + { \\bf{g}}_{k'}^t{\\bf{f}}\\sum\\limits_{i \\ne k , k'}^{2k } { \\sqrt { { p_i } } { { \\bf{g}}_i}{x_i } }   + { \\bf{g}}_{k'}^t{\\bf{f}}{{\\bf{n}}_{\\rm{r } } } + { n_{k'}}. \\end{split}\\ ] ] it is straightforward to show that the first term `` desired signal '' and the second term `` effective noise '' in ( [ app_receive_signal ] ) are uncorrelated .",
    "the exact pdf of @xmath116 is not easy to obtain , but we know that the worst - case is to approximate the effective noise as independently gaussian distributed  @xcite . since the relay is equipped with large - scale antenna arrays by assuming @xmath22 , the central limit theorem provides a tight statistical csi based lower bound for the achievable rate .",
    "then , the statistical csi based achievable rate lower bound of the transmission link @xmath105 can be obtained as @xmath117 } \\right|}^2}}}{{{p_k}{\\rm var}\\left [ { { \\bf{g}}_{k'}^t{\\bf{f}}{{\\bf{g}}_k } } \\right ] + { \\rm{s}}{{\\rm{i}}_{k'}}+ { \\rm{i}}{{\\rm{p}}_{k ' } } + { \\rm{n}}{{\\rm{r}}_{k ' } } + { \\rm{n}}{{\\rm{u}}_{k ' } } } } } \\right ) \\end{split}\\ ] ] where @xmath118 , @xmath119 , @xmath120 and @xmath121 denote the residual self - interference after sic , the inter - pair interference , the amplified noise from relay and the noise at user , respectively , i.e. ,    [ scsi_rate_ext ] @xmath122      \\end{split}\\\\      \\begin{split }      { \\rm{i}}{{\\rm{p}}_{k ' } } \\buildrel \\delta \\over = & \\sum\\limits_{i \\ne k , k'}^{2k } { { p_i}{\\rm e}\\left [ { { { \\left| { { \\bf{g}}_{k'}^t{\\bf{f}}{{\\bf{g}}_i } } \\right|}^2 } } \\right ] }      \\end{split}\\\\      \\begin{split }      { \\rm{n}}{{\\rm{r}}_{k ' } } \\buildrel \\delta \\over = & { \\rm e}\\left [ { { { \\left| { { \\bf{g}}_{k'}^t{\\bf{f}}{{\\bf{n}}_{\\rm{r } } } } \\right|}^2 } } \\right],~{\\rm{n}}{{\\rm{u}}_{k ' } } \\buildrel \\delta \\over = { \\rm e}\\left [ { { { \\left| { { n_{k ' } } } \\right|}^2 } } \\right ] .      \\end{split }      \\end{aligned}\\ ] ]    when mrc / mrt beamforming is employed , further mathematical derivation of ( [ scsi_rate ] ) leads to the following theorem :    _ theorem 1 : _ with imperfect csi based mrc / mrt , the ergodic achievable rate of the transmission link @xmath105 , for a finite number of antennas at the relay , is lower bounded by ( [ scsi_rate_cf ] ) ,    @xmath123    @xmath124    where @xmath125 , @xmath126 , @xmath127 @xmath128 $ ] , @xmath129 @xmath130 $ ] , @xmath131 @xmath132 $ ] , and @xmath133 .    _",
    "proof : _ see appendix c.    for imperfect csi based zfr / zft processing , a closed - form expression for the achievable rate in ( [ scsi_rate ] ) is derived as follows :    _ theorem 2 : _ with imperfect csi based zfr / zft beamforming , the achievable rate of the transmission link @xmath105 , for a finite number of antennas at the relay , is lower bounded by ( [ hat_scsi_rate_cf ] ) , where @xmath134 , @xmath135 , @xmath136 , @xmath137 , @xmath138 , and @xmath139 .",
    "_ proof : _ see appendix d.    theorems 1 and 2 are also valid for conventional mimo systems , while the bounds become less tight as the antenna scale goes down . the capacity lower bounds for perfect csi can always be obtained by setting @xmath140 and @xmath141  ( @xmath142 ) in ( [ scsi_rate_cf ] ) and ( [ hat_scsi_rate_cf ] ) .",
    "moreover , it can be observed from ( [ scsi_rate_cf ] ) that when the estimation error is severe , the residual si occupies the major part of the imperfect csi effect in comparison to other terms . on the other hand , if channel estimation is rather accurate , the residual si has slight effects in comparison to other terms . while for zfr / zft , both the residual si and inter - pair interference are determined by the channel estimation accuracy .",
    "based on the derived closed - form expressions for the achievable rate in ( [ scsi_rate_cf ] ) and ( [ hat_scsi_rate_cf ] ) , this section provides the asymptotic analysis under two different cases when the number of relay antennas approaches to infinity .",
    "suppose that all users have the same transmit power , i.e. , @xmath143 .",
    "_ proposition 1 : _ in case i where @xmath42 is fixed , @xmath144  ( @xmath24 ) , @xmath145 , and @xmath146 and @xmath147 are fixed , to achieve non - vanishing user rate as @xmath148 , the user and relay transmit power scaling factor @xmath149 and @xmath150 must satisfy @xmath151 and @xmath152 .",
    "when @xmath153 and @xmath154 , the asymptotic achievable rate expressions of the transmission link @xmath105 for imperfect csi based mrc / mrt and zfr / zft are ( [ scsi_rate_p1 ] ) and ( [ hat_scsi_rate_p1 ] ) ,    @xmath155    @xmath156    @xmath157 + 2\\sigma _ n^8\\sum\\limits_{j = 1}^k { \\sigma _ j^4\\sigma _ { j'}^4 } } } } \\right)\\ ] ]    @xmath158    respectively , which show that the transmit powers at both users and relay sides can be scaled down by up to @xmath159 to maintain a given rate in case i. when @xmath160 and @xmath161 , the asymptotic achievable rate of each user approaches to infinity as @xmath148 .    in case ii where @xmath162 , @xmath144  ( @xmath24 ) , @xmath145 , and @xmath146 and @xmath147 are fixed , to achieve non - vanishing user rate as @xmath148 , the pilot , user and relay transmit power scaling factors @xmath163 , @xmath149 and @xmath150 must satisfy @xmath164 , @xmath165 and @xmath166 . when @xmath167 , @xmath168 and @xmath169 , the asymptotic achievable rate of the transmission link @xmath105 for imperfect csi based mrc / mrt and zfr / zft are ( [ scsi_rate_p2 ] ) and ( [ hat_scsi_rate_p2 ] ) , respectively , from which we conclude that the transmit powers of each user and the relay can only be reduced by up to @xmath170 when the pilot transmit power is set as @xmath171 , in order to maintain a given spectral efficiency . similarly , when @xmath172 and @xmath173 , the asymptotic achievable rate of each user approaches to infinity as @xmath148 .",
    "_ remark 2 : _ when the pilot power scaling factor @xmath174 , which means that the pilot power scales down by @xmath159 , to guarantee user rate there is @xmath175 , which means the relay and user transmit power must stay constant and do not scale down with @xmath21 .",
    "the achievable rate in this case can be derived from ( [ scsi_rate_cf ] ) and ( [ hat_scsi_rate_cf ] ) , but not shown here due to space limitation .",
    "it is found that channel estimation error induced interference and inter - pair interference can not be eliminated when @xmath42 is scaled down proportionally to @xmath159 with fixed @xmath176 and @xmath177 in case ii .",
    "it can be observed from theorems 1 and 2 that for fixed @xmath178  ( @xmath179 ) , @xmath180 , and @xmath42 , the achievable rate of each pair - wise user transmission link depends on the user power , i.e. , the values of @xmath23 ( @xmath45 ) , and the relay power .",
    "next we propose the optimal power allocation for the studied system .",
    "in this section , a power allocation problem is first formulated and solved for multi - pair users in the ma phase transmission and the relay in the bc phase , which maximizes the sum spectral efficiency",
    ". the achievable rate of a transmission link @xmath181 for @xmath182 used in the optimization refers to the scsi based achievable rate , given in ( [ scsi_rate_cf ] ) and ( [ hat_scsi_rate_cf ] ) .",
    "power allocation can be performed at the relay side according to the scsi , and then the relay notifies the user pairs their allocated power values .",
    "moreover , closed - form asymptotic power allocation solutions are presented for mrc / mrt and zfr / zft , respectively , for the asymptotic regimes with high snr and @xmath183 .",
    "most power optimization in communications aims to maximize the sum spectral efficiency , which is defined as the sum - rate ( in bits ) per channel use . assuming that @xmath37 is the length of the coherent interval ( in symbols ) , in which @xmath184 symbols are used for channel estimation , the sum spectral efficiency denoted as @xmath185 , where @xmath186 is the signal - to - interference - plus - noise ratio ( sinr ) .",
    "then , the power allocation problem to maximize the sum spectral efficiency can be formulated as    [ opt3 ] @xmath187    where @xmath188 in constraint ( [ constraints31 ] ) is the total power allocated to all the users and relay , and constraints ( [ constraints32 ] ) specify the peak power limits @xmath79 and @xmath189 for each user @xmath190 and relay , respectively .",
    "the objective in ( [ objective3 ] ) can be equivalently rewritten as @xmath191^{-1}$ ] , as @xmath192 is a monotonic increasing function of @xmath193 .",
    "we can see that the constraints are posynomial functions .",
    "if the objective function is a monomial or posynomial function , the problem ( [ opt3 ] ) becomes a gp which can be reformulated as a convex problem , and thus , can be solved efficiently by convex optimization tools , such as cvx  @xcite . however , the rewritten objective function for ( [ opt3 ] ) is still neither a monomial nor posynomial , making solving the problem directly by the convex optimization tools impossible . to solve this problem ,",
    "an approximation for the objective function can be efficiently found by using the technique in @xcite .",
    "specifically , according to ( * ? ? ?",
    "* lemma 1 ) , we can use a monomial function @xmath194 to approximate @xmath195 near an arbitrary point @xmath196 , where @xmath197 and @xmath198 .",
    "consequently , the objective function can be approximated as @xmath199 , which is a monomial function . in this way",
    ", the problem is transformed into a gp problem by the approximation .",
    "similar to @xcite , a successive approximation algorithm for the power allocation problem in ( [ opt3 ] ) is proposed as algorithm 1 .",
    "( [ trans2_opt3_cons1 ] ) is the relaxed constraint .",
    "notably , the parameter @xmath200 here is utilized to control the desired approximation accuracy .",
    "the accuracy is high when @xmath200 is close to 1 , but the convergence rate is low , and vice versa . as shown in @xcite , @xmath201 is an option that introduces a good accuracy trade off in most practical cases .",
    "[ tab:1 ]    p0.9 * algorithm 1 : * successive approximation algorithm for power allocation + * initialization : * given tolerance @xmath202 , the maximum number of iterations @xmath203 , and parameter @xmath204 . set @xmath205 .",
    "select the initial values @xmath206 for @xmath207  ( @xmath208 ) . +",
    "* repeat : *    1 .",
    "compute @xmath209 and @xmath210 ; 2 .",
    "solve the gp : + [ trans2_opt3 ] @xmath211^{-1}\\\\      \\label{trans2_opt3_cons1 }      { \\rm{s.t.}}~~&{{{a_{k}}{p_{k ' } } } \\over { \\sum\\limits_{i = 1}^{2k } { \\left ( { b_{k , i}^{(1 ) } + b_{k , i}^{(2)}p_{\\rm{r}}^ { - 1 } } \\right){p_i } }   + { c_{k}}{p_{k } } + \\left ( { d_{k}^{(1 ) } + d_{k}^{(2)}p_{\\rm{r}}^ { - 1 } } \\right)}}\\le \\chi_k\\\\      & \\text{(\\ref{constraints31})},~\\text{(\\ref{constraints32})},~{\\beta ^ { - 1}}{\\chi_{k , m } } \\le { \\chi _ k } \\le \\beta { \\chi _ { k , m } }      \\end{aligned}\\ ] ] 3",
    ".   set @xmath212 , and update @xmath213 , where @xmath214  ( @xmath208 ) are obtained based on the solutions @xmath215  ( @xmath35 ) and @xmath216 of the gp ;    * until : * stop if @xmath217 or @xmath218 ; + * output : * output @xmath215  ( @xmath35 ) and @xmath216 as the solutions . +      obviously , the optimal power allocation scheme in algorithm 1 is an iterative numerical solution with no closed - form .",
    "however , more tractable expressions can be found for mrc / mrt and",
    "zfr / zft , respectively , when we consider the asymptotic regimes with high snr and @xmath183 .",
    "suppose that the snrs at both the relay and user sides are very high , i.e. , @xmath219 , @xmath220 and @xmath221  ( @xmath179 ) , and @xmath222 .",
    "then the lower bound can be simplified as given by the following lemma .",
    "_ lemma 1 : _",
    "when @xmath219 , @xmath220 , @xmath221  ( @xmath179 ) , and @xmath222 , the rate of the transmission link @xmath105 can be approximated as @xmath223    _ proof : _ firstly , we have @xmath224 for @xmath179 due to @xmath220 .",
    "then , we divide both the denominator and numerator of the sinr in ( [ scsi_rate_cf ] ) by @xmath225 .",
    "each item with @xmath226 in the denominator is able to be ignored based on @xmath148 .",
    "then , according to @xmath227 and @xmath221 for @xmath179 , ( [ scsi_rate_cf_app ] ) can be obtained .    in order to obtain a closed - form solution for asymptotically optimal power allocation",
    ", we set the fixed link condition @xmath228 for @xmath179 .",
    "since the approximated rate expressions involve no @xmath229 , we do not need to find the optimal solution for @xmath229 . for a fixed @xmath230 , ( [ opt3 ] ) can be rewritten as    [ opt3_app ] @xmath231    where the peak power constraints for each user are ignored for analysis simplicity by assuming that the channel large - scale factors are on the same order of magnitude .",
    "then , we have the following _ theorem 3 _ with regard to the optimal allocated power for each user .",
    "_ theorem 3 : _ the optimal solution to ( [ opt3_app ] ) is obtained as @xmath232    _ proof : _ since @xmath233  @xcite in probability when @xmath234 , according to the inequality of arithmetic and geometric means , the objective in ( [ objective3_app ] ) is upper bounded by @xmath235 where the equality is achieved if and only if @xmath236 for @xmath237 . to maximize the sum rate ,",
    "it is obvious that the total user power should reach the largest value @xmath238 in ( [ constraints31_app ] ) .",
    "thus ( [ solution_app ] ) can be obtained to satisfy @xmath239 , indicating that the optimal allocated power for each user is inverse to its corresponding large - scale fading factor of the channel from the user to the relay , and proportional to the channel from the relay to its destination when mrc / mrt beamforming is used at the relay under the condition that the link end - to - end large - scale fading factors among all pairs are equal .",
    "furthermore , the asymptotic sum - rate is independent of the allocated power .",
    "similarly , we make the same assumption for zfr / zft that the snrs at both the relay and user sides are very high and @xmath222",
    ". then the following lemma can be obtained .",
    "_ lemma 2 : _ when @xmath219 , @xmath220 , @xmath221  ( @xmath179 ) , and @xmath222 , the rate of the transmission link @xmath105 can be approximated as @xmath240 therefore , without any assumptions on link conditions , ( [ opt3 ] ) can be rewritten as    [ opt3_app1 ] @xmath241    _ theorem 4 _ states the optimal allocated power for each user .",
    "_ theorem 4 : _ the optimal solution to ( [ opt3_app1 ] ) is given by @xmath242^ + } \\ ] ] where @xmath243 is chosen to satisfy ( [ constraints31_app ] ) .",
    "_ proof : _ obviously , we can obtain the solution to ( [ opt3_app1 ] ) by the lagrange multiplier approach associated with karush - kuhn - tucker ( kkt ) conditions .    from ( [ solution_app1 ] ) , it can be concluded that the allocated powers are equal for zfr / zft when @xmath244 .",
    "simulations are conducted to validate the derived achievable rate expressions and examine the performance of the designed power allocation schemes , respectively . in the simulation study",
    ", we set the length of the coherent interval @xmath245 ( symbols ) , the number of user pairs @xmath246 , the training length @xmath247 , and the noise variance is normalized to be @xmath248 .",
    "furthermore , @xmath249 is defined at the relay side .",
    "firstly , the effectiveness of the derived scsi based achievable rate in ( [ scsi_rate_cf ] ) and ( [ hat_scsi_rate_cf ] ) is evaluated by comparing the spectral efficiency with the monte - carlo simulation results . for simplicity",
    ", we assume that the large - scale fading factors are @xmath250 for all @xmath35 and equal power allocation for users is utilized with the total power @xmath251 . in fig .",
    "[ scsi_icsi1 ] with @xmath252  db , the spectral efficiency curves versus @xmath253 obtained from the analytical lower bounds ( [ scsi_rate_cf ] ) and ( [ hat_scsi_rate_cf ] ) , are compared with the ones given by the exact capacity expression ( [ icsi_rate ] ) obtained through monte - carlo simulation . it is evident that the relative performance gap between the capacity lower bound ( [ hat_scsi_rate_cf ] ) and the exact capacity ( [ icsi_rate ] ) for zfr / zft is even smaller than that for mrc / mrt , especially with larger number of antennas .",
    "moreover , fig .",
    "[ scsi_icsi1 ] shows that the spectral efficiency of zfr / zft increases much faster than that of mrc / mrt as snr increases .",
    "it is due to the fact that the effect of interference is much larger than that of the noise for higher snr while zfr / zft is able to null multi - user interference signals  @xcite .",
    "hence , the effectiveness of the derived closed - form lower bounds for both mrc / mrt and zfr / zft has been demonstrated .",
    "db , epa , @xmath254 ) . ]",
    "db , epa , @xmath255 , @xmath256 ) . ]",
    "db , epa , @xmath257  db ) . ]    fig .",
    "[ scsi_icsi2 ] compares the spectral efficiency of mrc / mrt with that of zfr / zft at different snrs , which shows that zfr / zft does not always outperform mrc / mrt in the massive mimo two - way relaying systems .",
    "as @xmath16 increases , i.e. , the average snr ( @xmath258 ) of each user decreases , the noise effect exceeds the interference effect causing wore performance of zfr / zft . fig .",
    "[ scsi_icsi3 ] depicts the performance of zfr / zft over mrc / mrt with different @xmath259 ratios .",
    "different from the results obtained by fig .",
    "[ scsi_icsi2 ] , fig .",
    "[ scsi_icsi3 ] shows that under a fixed @xmath259 , the gains brought by zft / zfr grow even though the average snr ( @xmath258 ) of each user decreases as the number of user pairs @xmath16 increases .",
    "these observations indicate that two asymptotic regimes , large - scale antenna arrays and high snr , are equivalent  @xcite .",
    "moreover , larger gains over mrc / mrt are achieved by the zfr / zft processing at higher @xmath259 .    next the asymptotic analyses with massive arrays for the two cases in propositions 1 and 2 are examined , supposing @xmath260 and epa employed with the transmit power at each user satisfying @xmath261  ( @xmath35 ) .",
    "[ asy_ana1 ] shows the required user transmit power @xmath253 to achieve @xmath262  bit / s / hz per user .",
    "it is obvious from fig .",
    "[ asy_ana1](a ) that in case i where the pilot power @xmath42 is fixed , the required user transmit power is significantly reduced as @xmath21 increases , and that the required @xmath253 with zfr / zft is lower than that with mrc / mrt . regarding the imperfect csi effect , less user transmit power is required when @xmath42 is high . on the other hand ,",
    "when @xmath42 is low and @xmath21 is small , the required @xmath262  bit / s / hz achievable rate per user can not be achieved even with infinite @xmath253 , which means that the only way to reduce the imperfect csi effect and thus achieve required spectral efficiency is to increase the number of antennas at the relay . for case ii with @xmath263 and the pilot power scaling down by @xmath264 , fig .",
    "[ asy_ana1](b ) shows that higher @xmath163 leads to more slowly reduced @xmath253 , because the imperfect csi effect becomes much severer when the pilot power is reduced faster with the increase of @xmath21 .    ) . ]      in this subsection , the proposed power allocation schemes in section [ pa ] are examined in regard to the performance of the spectral efficiency .    in opa",
    ", simulations are performed assuming that @xmath265  db , @xmath266  db and @xmath267  db .",
    "first , we choose the large - scale fading matrix as follows @xmath268 which is a snapshot of the practical setup , indicating that all large - scale fading factors fall into the interval @xmath269 $ ] .",
    "[ opt3 ] shows the spectral efficiency versus @xmath42 with fixed @xmath270 , @xmath271 and @xmath272 under both opa and epa .",
    "the employed epa here allocates equal power to each user where the sum power consumed by all users achieves its maximum value @xmath273 with @xmath274 , i.e. , @xmath275 for all @xmath35 . for the opa ,",
    "algorithm 1 is utilized with the initial values chosen as follows : @xmath276 , @xmath277 , @xmath201 , and @xmath278  ( @xmath279 ) are obtained by the epa scheme .",
    "it can be observed from fig .",
    "[ opt3 ] that opa outperforms epa , especially when the number of relay antennas is high , which demonstrates the effectiveness of our proposed pa .",
    "furthermore , the spectral efficiency improvement in opa for mrc / mrt beamforming is always smaller than that for zfr / zft under different @xmath42 .    for aopa , fig .",
    "[ difopa ] validates the effectiveness of ( [ solution_app ] ) and ( [ solution_app1 ] ) at a large @xmath21 and a high snr in comparison to opa and epa .",
    "notably , the opa here considers fixed @xmath280 , i.e. , only user power allocation is performed .",
    "[ difopa](a ) shows that when @xmath281  db , the obtained spectral efficiency in aopa for mrc / mrt for @xmath282 according to the assumption in section  [ pa ] . ]",
    "is almost the same as that in opa , reaching high gains over epa .",
    "however , if the snr is reduced to @xmath283  db , the gain achieved by aopa over epa becomes rather slight even when the number of antennas is significantly increased . while regarding the zfr / zft , fig .",
    "[ difopa](b ) illustrates that when the number of antennas is large and snr is high , aopa tends to epa as predicted by ( [ solution_app1 ] ) .",
    "furthermore , fig .",
    "[ difopa](b ) shows that aopa outperforms epa slightly when the snr is reduced to @xmath283  db .",
    "( @xmath265  db , @xmath266  db , @xmath267  db ) . ]     for different power allocation schemes ( @xmath284 ) . ]",
    "in this paper , closed - form ergodic achievable rate expressions have been derived for a multi - pair massive mimo two - way af relaying system with imperfect csi and linear processing .",
    "optimal power allocations schemes based on the obtained rate expressions have been shown to outperform equal power allocation in various scenarios .",
    "it has been found that the asymptotically optimal power solutions for mrc / mrt and zfr / zft achieve almost the same performance as opa when the snr is high and the number of antennas at the relay is large .",
    "both aopa and opa outperform epa on the spectral efficiency .",
    "besides , the allocated power of each user in aopa is inverse to the large - scale fading factor of the channel from the user to the relay , and proportional to the channel from the relay to its destination for mrc / mrt under the condition that the link end - to - end large - scale fading factors among all pairs are equal , and the aopa for zfr / zft tends to be epa when @xmath21 is large .",
    "to prove ( [ alpha ] ) , we start from the expectation @xmath285 $ ] , which is rewritten as ( [ alpha_0 ] ) .    @xmath286\\mathop   = \\limits^{(a)}~&{\\rm tr}\\left\\ { { { \\rm e}\\left [ { { { \\hat{\\bf g}}^*}{\\bf{t}}{{\\hat{\\bf g}}^h}\\left ( { { \\hat { \\bf g } } - { \\bf{\\xi } } } \\right){\\bf{p}}{{\\bf{p}}^h}{{\\left ( { { \\hat{\\bf g } } - { \\bf{\\xi } } } \\right)}^h}{\\hat { \\bf g}}{{\\bf{t}}^h}{{\\hat{\\bf g}}^t } } \\right ] } \\right\\}\\\\ \\mathop   = \\limits^{(b)}~&{\\rm tr}\\left\\ { { { \\rm e}\\left [ { { \\hat { \\bf g}}{\\bf{p}}{{\\bf{p}}^h}{{\\hat{\\bf g}}^h}}{{\\hat{\\bf g}}{{\\bf{t}}^h}{{\\hat{\\bf g}}^t}{{\\hat{\\bf g}}^*}{\\bf{t}}{{\\hat{\\bf g}}^h } } \\right ] } \\right\\}+{\\rm tr}\\left\\ { { { \\rm e}\\left[{{\\bf{\\xi } } { \\bf{p}}{{\\bf{p}}^h}{{\\bf{\\xi } } ^h } } { { \\hat{\\bf g}}{{\\bf{t}}^h}{{\\hat{\\bf g}}^t}{{\\hat{\\bf g}}^*}{\\bf{t}}{{\\hat{\\bf g}}^h } } \\right ] } \\right\\ } \\end{split}\\ ] ]    @xmath287 } \\right\\}\\mathop   = \\limits^{(a)}&{\\rm tr}\\left\\ { { \\sum\\limits_{k = 1}^{2k}{p_{k } } { { \\rm e}\\left[{{\\hat{\\bf g}}_{k}}{\\hat{\\bf g}}_{k}^h{\\sum\\limits_{i = 1}^k { \\left ( { { { \\hat{\\bf g}}_{2i - 1}}{\\hat{\\bf g}}_{2i}^t + { { \\hat{\\bf g}}_{2i}}{\\hat{\\bf g}}_{2i - 1}^t } \\right)\\left ( { { \\hat{\\bf g}}_{2i - 1}^*{\\hat{\\bf g}}_{2i}^h + { \\hat{\\bf g}}_{2i}^*{\\hat{\\bf g}}_{2i - 1}^h } \\right ) } } \\right ] } } \\right\\}\\\\ \\mathop   = \\limits^{(b ) } & { 2n\\left ( { n + 1 } \\right)\\hat\\psi\\hat\\phi   + n{{\\left ( { n + 1 } \\right)}^2}\\sum\\limits_{i = 1}^k{\\hat\\psi _ i}}\\hat\\phi_i \\end{split}\\ ] ]    @xmath288 } \\right\\ } = ~{\\rm tr}\\left\\ { { \\rm e}\\left [ { { { \\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h } \\right]{\\rm e}\\left [ { { { \\hat{\\bf g}}_{2i}}{\\hat{\\bf g}}_{2i - 1}^h}{{{\\hat{\\bf g}}_{2i-1}}{\\hat{\\bf g}}_{2i}^h } \\right ] \\right\\ } = { n^2}\\hat\\sigma _ { 2i - 1}^2\\hat\\sigma _ { 2i}^2\\hat\\sigma _ k^2 \\end{split}\\ ] ]    @xmath289 } \\right\\ } = ~{\\rm tr}\\left\\ { { \\rm e}\\left [ { { { \\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h } \\right]{\\rm e}\\left [ { { { \\hat{\\bf g}}_{2i - 1}}{\\hat{\\bf g}}_{2i - 1}^h } \\right]{\\rm e}\\left [ { { { \\hat{\\bf g}}_{2i}}{\\hat{\\bf g}}_{2i}^h } \\right ] \\right\\ } = n\\hat\\sigma _ { 2i - 1}^2\\hat\\sigma _ { 2i}^2\\hat\\sigma _ k^2 \\end{split}\\ ] ]    @xmath290 } \\right\\}=~2n\\left ( { n + 1 } \\right)\\hat \\sigma _ { 2i}^2\\hat \\sigma _ { 2i - 1}^4 + { n}\\left ( { n + 1 } \\right)^2\\hat \\sigma _ { 2i}^2\\hat \\sigma _ { 2i - 1}^4 \\end{split}\\ ] ]    @xmath291 } \\right\\}=~ 2n\\left ( { n + 1 } \\right)\\hat \\sigma _ { 2i - 1}^2\\hat \\sigma _",
    "{ 2i}^4 + { n}\\left ( { n + 1 } \\right)^2\\hat \\sigma _ { 2i - 1}^2\\hat \\sigma _ { 2i}^4 \\end{split}\\ ] ]    @xmath292 } \\right\\}= ~ & \\sum\\limits_{j = 1}^{2k } { { p_j}\\sigma _ { { \\xi _ j}}^2}{\\rm tr}\\left\\{{{\\rm e}\\left[{\\sum\\limits_{i = 1}^k { \\left ( { { { \\hat{\\bf g}}_{2i - 1}}{\\hat{\\bf g}}_{2i}^t + { { \\hat{\\bf g}}_{2i}}{\\hat{\\bf g}}_{2i - 1}^t } \\right)\\left ( { { \\hat{\\bf g}}_{2i - 1}^*{\\hat{\\bf g}}_{2i}^h + { \\hat{\\bf g}}_{2i}^*{\\hat{\\bf g}}_{2i - 1}^h } \\right ) } } \\right]}\\right\\}\\\\ = ~ & 2n\\left ( { n + 1 } \\right)\\hat\\phi\\sum\\limits_{j = 1}^{2k } { { p_j}\\sigma _ { { \\xi _ j}}^2}. \\end{split}\\ ] ]    step @xmath293 is obtained by @xmath71 = { { \\bf{i}}_{2k}}$ ] and substituting @xmath294 and ( [ estimated_csi_exp ] ) into the equation , and step @xmath295 results from the independence between @xmath296 and @xmath297 and the property @xmath102 .",
    "as for the first term in ( [ alpha_0 ] ) , we have ( [ alpha_1_main ] ) , where @xmath298 with @xmath299 and @xmath300 with @xmath301 . step @xmath293 in ( [ alpha_1_main ] ) results from substituting @xmath296 in ( [ estimated_csi_exp ] ) , @xmath302 and @xmath303 into the equation and formula expansion based on the fact that the expectation of @xmath304}$ ] @xmath305 for any @xmath306 .",
    "step @xmath295 is obtained by @xmath102 , some results from gaussian distributed estimated channel in ( [ estimated_csi_exp ] ) ) , we have that @xmath307 and @xmath308 are mutually independent @xmath309 vectors with @xmath310 whose elements are i.i.d .",
    "zero - mean gaussian distributed with variances @xmath311 and @xmath312 , respectively .",
    "then , it can be concluded that @xmath313=n\\hat\\sigma _ i^2 $ ] , @xmath314 , and @xmath315=0 $ ] .",
    "also , we can obtain that @xmath316=n\\hat\\sigma _ i^2\\hat\\sigma _",
    "]  @xcite , and ( * ? ? ?",
    "* lemma  2.9 ) . to elaborate in detail , for the items in @xmath293 with any @xmath317 or @xmath318 , we have ( [ alpha_1_ext1 ] ) and ( [ alpha_1_ext2 ] ) , where the properties @xmath319 and @xmath320 for arbitrary vectors @xmath321 and @xmath322 are utilized .",
    "while for the items with @xmath323 and @xmath318 , we have ( [ alpha_1_ext3 ] ) and ( [ alpha_1_ext4 ] ) . on account of the independence between @xmath324 and @xmath325 , the second term in ( [ alpha_0 ] )",
    "becomes ( [ alpha_1_error ] ) . by substituting ( [ alpha_1_main ] ) and ( [ alpha_1_error ] ) into ( [ alpha_0 ] ) , we have @xmath326=n\\left ( { n + 1 } \\right)\\left[2\\psi\\hat\\phi   + \\left ( { n + 1 } \\right)\\sum\\limits_{i = 1}^k{\\hat\\psi _ i}\\hat\\phi_i\\right ] \\end{split}\\ ] ] where @xmath327 with @xmath328 .    to proceed , we need to calculate the expectation @xmath329 $ ] in ( [ alpha ] ) , which is elaborated as follows @xmath330\\mathop   = \\limits^{(a)}{\\rm tr}\\left\\ { { \\sigma _ n^2{\\rm e}\\left [ { { { \\hat{\\bf g}}^*}{\\bf{t}}{{\\hat{\\bf g}}^h}{\\hat{\\bf g}}{{\\bf{t}}^h}{{\\hat{\\bf g}}^t } } \\right ] } \\right\\ } \\mathop   = \\limits^{(b)}\\\\ & { \\rm tr}\\left\\ { \\sigma _ n^2{{\\rm e}\\left [ { \\sum\\limits_{i = 1}^k { \\left ( { { \\hat{\\bf g}}_{2i - 1}^*{\\hat{\\bf g}}_{2i}^h + { \\hat{\\bf g}}_{2i}^*{\\hat{\\bf g}}_{2i - 1}^h } \\right)\\left ( { { { \\hat{\\bf g}}_{2i - 1}}{\\hat{\\bf g}}_{2i}^t + { { \\hat{\\bf g}}_{2i}}{\\hat{\\bf g}}_{2i - 1}^t } \\right ) } } \\right ] } \\right\\}\\\\ & \\mathop   = \\limits^{(c ) } 2n\\left ( { n + 1 } \\right)\\sigma _ n^2\\hat\\phi \\end{split}\\ ] ] where step @xmath293 is obtained by @xmath331 = \\sigma _ n^2{{\\bf{i}}_n}$ ] and @xmath102 , @xmath295 results from substituting @xmath296 in ( [ estimated_csi_exp ] ) , @xmath332 and @xmath303 into the equation and the fact that the expectation of @xmath333}=0 $ ] for any @xmath306 , and step @xmath334 results from the properties of @xmath102 , @xmath319 and @xmath320 for arbitrary vectors @xmath321 and @xmath322 , and the properties of gaussian distributed vectors , respectively , the detailed derivation of which is @xmath335\\right\\}\\\\ = ~ & 2{\\rm e}\\left [ { { \\hat{\\bf g}}_{2i}^h{{\\hat{\\bf g}}_{2i - 1}}{\\hat{\\bf g}}_{2i - 1}^h{{\\hat{\\bf g}}_{2i } } } \\right ] + 2{\\rm e}\\left [ { { \\hat{\\bf g}}_{2i}^h{{\\hat{\\bf g}}_{2i } } } \\right]{\\rm e}\\left [ { { \\hat{\\bf g}}_{2i - 1}^h{{\\hat{\\bf g}}_{2i - 1 } } } \\right]\\\\ = ~ & 2n\\left ( { n + 1 } \\right)\\hat\\sigma _ { 2i - 1}^2\\hat\\sigma _ { 2i}^2 .",
    "\\end{split}\\ ] ] hence , by substituting ( [ alpha_1 ] ) and ( [ alpha_2 ] ) into the step @xmath293 in ( [ alpha ] ) , the proof of ( [ alpha ] ) is completed .",
    "to prove ( [ hat_alpha ] ) , likewise , we start from @xmath336 $ ] , which can be rewritten as ( [ hat_alpha_1 ] ) ,      where @xmath104 , step @xmath293 is based on the fact that the estimation error matrix @xmath338 is independent of @xmath57 , and step @xmath295 is obtained by an intuitive property of @xmath339 , the definition of @xmath340 and @xmath341}=\\sum\\limits_{i = 1}^{2k } { { p_i}\\sigma _ { { \\xi _ i}}^2}{{\\bf{i}}}_{n}$ ] , which is derived from the distribution of @xmath342 . here ,",
    "@xmath343 is defined with @xmath344 for @xmath345 , following an inverse wishart distribution of @xmath346 .",
    "furthermore , step @xmath334 is based on @xmath102 . as to the detailed derivation of @xmath347",
    ", we use the identity  @xcite @xmath348 = \\frac{{{{\\bf{\\sigma } } ^ { - 1}}}}{{n - m - 1}}\\ ] ] where @xmath349 is an @xmath350 central complex wishart matrix with @xmath351  ( @xmath352 ) degrees of freedom and the distribution of @xmath353 is called an inverted wishart distribution , following @xmath354 .",
    "it can be easily concluded that @xmath355 with @xmath356 for @xmath345 , hence @xmath357 = { \\rm e}\\left [ { { { \\left ( { { \\hat{\\bf{g}}^h}\\hat{\\bf{g } } } \\right)}^ { - 1 } } } \\right ] = \\frac{{{\\hat{\\bf{d}}^ { - 1}}}}{{n - 2k - 1}}\\ ] ] where @xmath358 . in this way , we have @xmath359={\\rm e}\\left[{\\hat\\omega _ { k , k}}\\right]={\\frac{1}{{\\left ( { n - 2k - 1 } \\right)\\hat\\sigma _ k^2}}}$ ] for @xmath208 , ( [ hat_alpha2_ext1 ] ) and ( [ hat_alpha2_ext2 ] ) , where @xmath360 $ ]  ( @xmath361 ) , @xmath362 $ ] and @xmath363 $ ]  ( @xmath364 ) are calculated based on the properties of the inverse wishart matrix @xmath365  @xcite .    then , the calculation of @xmath366 $ ] in ( [ hat_alpha ] ) can be elaborated as ( [ hat_alpha_2 ] ) .",
    "hence , by substituting ( [ hat_alpha_1 ] ) and ( [ hat_alpha_2 ] ) into the step @xmath293 in ( [ hat_alpha ] ) , the proof of ( [ hat_alpha ] ) is completed .",
    "to derive the closed - form expression of the achievable rate in ( [ scsi_rate ] ) , we start from the expectation @xmath367 $ ] in the numerator based on mrc / mrt in ( [ f ] ) , given by ( [ mean_upp ] ) , where step @xmath293 is obtained by @xmath368 and the independence between @xmath369 and @xmath370 , step @xmath295 results from substituting @xmath76 in ( [ f ] ) , @xmath371 in ( [ estimated_csi_exp ] ) and @xmath303 into the equation and the fact @xmath372=0 $ ] , @xmath334 is obtained by formula expansion based on the fact that the expectation of @xmath373=0 $ ] for any @xmath374 and @xmath375 , and step @xmath347 results from the property @xmath102 and the properties of gaussian distributed vectors .",
    "@xmath376 = { \\rm{cov}}\\left [ { \\hat \\omega _ { j , j}^*{{\\hat \\omega } _ { j',j ' } } } \\right ] + { \\rm e}\\left [ { \\hat \\omega _ { j , j}^ * } \\right]{\\rm e}\\left [ { { { \\hat \\omega } _ { j',j ' } } } \\right]\\\\ = ~&\\frac{2}{{\\left ( { n - 2k } \\right){{\\left ( { n - 2k - 1 } \\right)}^2}\\left ( { n - 2k - 3 } \\right){\\hat \\sigma } _",
    "j^2{\\hat \\sigma } _ { j'}^2}}+\\frac{1}{{{{\\left ( { n - 2k - 1 } \\right)}^2}{\\hat \\sigma } _",
    "j^2{\\hat \\sigma } _ { j'}^2 } } \\end{split}\\ ] ]    @xmath377 = ~{\\mathop{\\rm var } } \\left [ { { \\hat \\omega_{i , j } } } \\right ] + { \\rm e}^2\\left [ { { \\hat \\omega_{i , j } } } \\right ] = ~ \\frac{2}{{{{\\left ( { n - 2k - 1 } \\right)}^2}\\left ( { n - 2k - 3 } \\right)\\hat \\sigma _ i^2\\hat \\sigma _ j^2 } } \\end{split}\\ ] ]    @xmath378 = ~{\\rm tr}\\left\\ { { \\sigma _ n^2{\\rm e}\\left [ { { { { { \\hat{\\bf \\omega}}}^*}{{\\bf t}{\\hat { \\bf \\omega}}{\\bf t } } } } \\right ] } \\right\\}= ~ \\sigma _ n^2\\sum\\limits_{j = 1}^{2k } { \\left ( { { \\rm e}\\left [ { \\hat \\omega_{j , j}^*{{\\hat \\omega}_{j',j ' } } } \\right ] + { \\rm e}\\left [ { { { \\left| { { \\hat \\omega_{i , j } } } \\right|}^2 } } \\right ] } \\right ) } = ~\\hat \\eta { \\sigma _ n^2}. \\end{split}\\ ] ]    @xmath379 \\mathop   = \\limits^{(a)}~ & { \\rm e}\\left [ { { \\hat{\\bf g}}_{k'}^t{\\bf{f}}{{\\hat{\\bf g}}_k } } \\right ] + { \\rm e}\\left [ { { \\bf{\\xi } } _ { k'}^t{\\bf{f}}{{\\bf{\\xi } } _ k } } \\right]\\mathop = \\limits^{(b ) } \\alpha_1 { \\rm e}\\left [ { { \\hat{\\bf g}}_{k'}^t\\sum\\limits_{i = 1}^k { \\left ( { { \\hat{\\bf g}}_{2i - 1}^*{\\hat{\\bf g}}_{2i}^h + { \\hat{\\bf g}}_{2i}^*{\\hat{\\bf g}}_{2i - 1}^h } \\right ) } { { \\hat{\\bf g}}_k } } \\right]\\\\ \\mathop   = \\limits^{(c)}~ & \\alpha_1 { \\rm e}\\left [ { { \\hat{\\bf g}}_{k'}^t{\\hat{\\bf g}}_k^*{\\hat{\\bf g}}_{k'}^h{{\\hat{\\bf g}}_k } + { \\hat{\\bf g}}_{k'}^t{\\hat{\\bf g}}_{k'}^*{\\hat{\\bf g}}_k^h{{\\hat{\\bf g}}_k } } \\right ] \\mathop   = \\limits^{(d ) } \\alpha_1 n\\left ( { n + 1 } \\right)\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil } \\end{split}\\ ] ]    @xmath380 \\mathop   = \\limits^{(a ) } & { \\rm e}\\left [ { { { \\left| { { { \\bf g}}_{k'}^t{\\bf{f}}{{{\\bf g}}_k } } \\right|}^2 } } \\right ] - { \\left| { { \\rm e}\\left [ { { { \\bf g}}_{k'}^t{\\bf{f}}{{{\\bf g}}_k } } \\right ] } \\right|^2}\\mathop   = \\limits^{(b ) } { { \\rm e}\\left [ { { \\hat{\\bf g}}_{k'}^t{\\bf f}{{\\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h{\\bf f}^h{\\hat{\\bf g}}_{k'}^ * } \\right]}+{{\\rm e}\\left [ { { \\hat{\\bf g}}_{k'}^t{\\bf f}{{{\\bf \\xi}}_k}{{\\bf \\xi}}_k^h{\\bf f}^h{\\hat{\\bf g}}_{k'}^ * } \\right]}\\\\ & + { { \\rm e}\\left [ { { { \\bf \\xi}}_{k'}^t{\\bf f}{{\\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h{\\bf f}^h{{\\bf \\xi}}_{k'}^ * } \\right]}+{{\\rm e}\\left [ { { { \\bf \\xi}}_{k'}^t{\\bf f}{{{\\bf \\xi}}_k}{{\\bf \\xi}}_k^h{\\bf f}^h{{\\bf \\xi}}_{k'}^ * } \\right ] } - { \\alpha_1 ^2}{n^2}{\\left ( { n + 1 } \\right)^2}\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}^2 \\end{split}\\ ] ]    @xmath381}\\mathop   = \\limits^{(a)}~&{\\alpha_1 ^2}\\sum\\limits_{i = 1}^k { { \\rm e}\\left [ { { \\hat{\\bf g}}_{k'}^t\\left ( { { \\hat{\\bf g}}_{2i - 1}^*{\\hat{\\bf g}}_{2i}^h + { \\hat{\\bf g}}_{2i}^*{\\hat{\\bf g}}_{2i - 1}^h } \\right){{\\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h\\left ( { { { \\hat{\\bf g}}_{2i - 1}}{\\hat{\\bf g}}_{2i}^t + { { \\hat{\\bf g}}_{2i}}{\\hat{\\bf g}}_{2i - 1}^t } \\right){\\hat{\\bf g}}_{k'}^ * } \\right]}\\\\ \\mathop   = \\limits^{(b)}~ & 2n\\left ( { n+1 } \\right)^2{\\alpha_1 ^2}\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}^2 + 2n\\left ( { n+1 } \\right){\\alpha_1 ^2}\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}\\hat\\phi+n^2\\left(n+1\\right)^2{\\alpha_1 ^2}\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}^2 \\end{split}\\ ] ]    @xmath382=~ 2{\\rm tr}\\left\\ { { { \\rm e}\\left [ { { { \\hat{\\bf g}}_{k'}}{\\hat{\\bf g}}_{k'}^h{{\\hat{\\bf g}}_{k'}}{\\hat{\\bf g}}_{k'}^h } \\right]{\\rm e}\\left [ { { { \\hat{\\bf g}}_k}{{\\hat{\\bf g}}_k}^h{{\\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h } \\right ] } \\right\\}+ { \\rm e}\\left [ { { { \\left| { { \\hat{\\bf g}}_k^h{{\\hat{\\bf g}}_{k ' } } } \\right|}^4 } } \\right ] \\\\   & ~~+ { \\rm e}\\left [ { { { \\left\\| { { { \\hat{\\bf g}}_k } } \\right\\|}^4 } } \\right]{\\rm e}\\left [ { { { \\left\\| { { { \\hat{\\bf g}}_{k ' } } } \\right\\|}^4 } } \\right]=~2n\\left ( { n+1 } \\right)^2\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}^2 + 2n\\left ( { n+1 } \\right)\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}^2+n^2\\left(n+1\\right)^2\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}^2 \\end{split}\\ ] ]    @xmath383= 2{\\rm e}\\left [ { { \\hat{\\bf g}}_{2i - 1}^h{{\\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h{{\\hat{\\bf g}}_{2i - 1 } } } \\right]{\\rm e}\\left [ { { \\hat{\\bf g}}_{2i}^h{{\\hat{\\bf g}}_{k'}}{\\hat{\\bf g}}_{k'}^h{{\\hat{\\bf g}}_{2i } } } \\right]\\\\ & ~~+ 2{\\rm tr}\\left\\ { { { \\rm e}\\left [ { { { \\hat{\\bf g}}_{k'}}{\\hat{\\bf g}}_{k'}^h } \\right]{\\rm e}\\left [ { { { \\hat{\\bf g}}_{2i}}{\\hat{\\bf g}}_{2i}^h } \\right]{\\rm e}\\left [ { { { \\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h } \\right]{\\rm e}\\left [ { { { \\hat{\\bf g}}_{2i - 1}}{\\hat{\\bf g}}_{2i - 1}^h } \\right ] } \\right\\}=~2n\\left(n+1\\right)\\hat\\phi_{i}\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil } \\end{split}\\ ] ]    [ var_down_main2 ] @xmath384}=n\\left ( { n + 1 } \\right)^2{\\alpha_1 ^2}\\sigma _ { { { \\bf{\\xi } } _ { k}}}^2\\hat \\sigma _ { k'}^2\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil } + 2n\\left ( { n + 1 } \\right){\\alpha_1 ^2}\\sigma _ { { { \\bf{\\xi } } _ { k}}}^2\\hat \\sigma _ { k'}^2\\hat \\phi      \\end{split}\\\\      \\begin{split }      { { \\rm e}\\left [ { { { \\bf \\xi}}_{k'}^t{\\bf f}{{\\hat{\\bf g}}_k}{\\hat{\\bf g}}_k^h{\\bf f}^h{{\\bf \\xi}}_{k'}^ * } \\right]}=n\\left ( { n + 1 } \\right)^2{\\alpha_1 ^2}\\sigma _ { { { \\bf{\\xi } } _ { k'}}}^2\\hat \\sigma",
    "_ { k}^2\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil } + 2n\\left ( { n + 1 } \\right){\\alpha_1 ^2}\\sigma _ { { { \\bf{\\xi } } _ { k'}}}^2\\hat \\sigma _ {",
    "k}^2\\hat \\phi      \\end{split}\\\\      \\begin{split }      { { \\rm e}\\left [ { { { \\bf \\xi}}_{k'}^t{\\bf f}{{{\\bf \\xi}}_k}{{\\bf \\xi}}_k^h{\\bf f}^h{{\\bf \\xi}}_{k'}^ * } \\right]}=2n\\left ( { n + 1 } \\right){\\alpha_1 ^2}\\sigma _ { { { \\bf{\\xi } } _ k}}^2\\sigma _ { { { \\bf{\\xi } } _ { k'}}}^2\\hat \\phi .      \\end{split }      \\end{aligned}\\ ] ]    @xmath385 = & n\\left ( { n+1 } \\right){\\alpha_1 ^2}\\left[\\left ( { n + 1 } \\right)\\hat\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}\\left(\\sigma _ { k'}^2\\hat \\sigma",
    "_ { k}^2+\\sigma _ k^2\\hat \\sigma _ { k'}^2\\right)+2\\phi_{\\left\\lceil { \\frac{{k'}}{2 } } \\right\\rceil}\\hat\\phi\\right ] \\end{split}\\ ] ]    [ down_others ] @xmath386      \\end{split}\\\\      \\begin{split }      { \\rm{i}}{{\\rm{p}}_{k ' } }   = & \\sum\\limits_{i \\ne k , k'}^{2k } { { p_i } n\\left ( { n + 1 } \\right){\\alpha_1 ^2}\\left [ { \\left ( { n + 1 } \\right)\\left ( { \\sigma _ i^2\\hat\\sigma _ { k'}^4\\hat\\sigma _ { k}^2 + \\sigma _ { k'}^2\\hat\\sigma _ { i}^4\\hat\\sigma _ { i'}^2 } \\right ) + 2\\sigma _ i^2\\sigma _ { k'}^2\\hat\\phi } \\right ] }      \\end{split}\\\\      \\begin{split }      { \\rm{n}}{{\\rm{r}}_{k ' } }   = & n\\left ( { n + 1 } \\right){\\alpha_1 ^2}\\sigma _ n^2\\left [ { \\left ( { n + 1 } \\right)\\hat\\sigma _ k^2\\hat\\sigma _ { k'}^4 + 2\\sigma _ { k'}^2\\hat\\phi } \\right],~{\\rm{n}}{{\\rm{u}}_{k ' } }   = \\sigma _ n^2 .",
    "\\end{split }      \\end{aligned}\\ ] ]    @xmath387 } \\right|}^2}}}{{{p_k}{\\rm var}\\left [ { { { \\bf g}}_{k'}^t{\\bf{f}}{{{\\bf g}}_k } } \\right ] + { \\rm{s}}{{\\rm{i}}_{k ' } } + { \\rm{i}}{{\\rm{p}}_{k ' } } + { \\rm{n}}{{\\rm{r}}_{k ' } } + { \\rm{n}}{{\\rm{u}}_{k'}}}}\\\\ \\mathop   = \\limits^{(a)}~&\\frac{{{p_k}n\\left ( { n + 1 } \\right)\\hat\\sigma _ k^4\\hat\\sigma _ { k'}^4}}{\\sum\\limits_{i=1}^{2k}{{p_i}\\left\\{\\varsigma_{k',i}+\\frac{\\sigma_n^2}{p_{\\rm r}}\\left[2\\hat\\phi\\sigma_i^2\\sigma_{i'}^2+\\left(n+1\\right)\\hat\\sigma_i^4\\hat\\sigma_{i'}^2\\right]\\right\\}}+{c_{k'}}{p_{k'}}+\\sigma _ n^2\\left [ { \\left ( { n + 1 } \\right)\\hat\\sigma _ k^2\\hat\\sigma _ { k'}^4 + 2\\sigma _ { k'}^2\\hat\\phi } \\right]+ \\frac{{2\\sigma _ n^4\\hat\\phi}}{{{p_{\\rm{r } } } } } } \\end{split}\\ ] ]    @xmath388 = \\alpha_2 { \\rm e}\\left [ { { { \\left ( { { { { \\hat{\\bf g}}}_{k ' } } - { { \\bf{\\xi } } _ { k ' } } } \\right)}^t}{{\\hat { \\bar{\\bf g}}}^*}{\\bf { { t}}}{{\\hat { \\bar { \\bf g}}}^h}\\left ( { { { { \\hat{\\bf g}}}_k } - { { \\bf{\\xi } } _ k } } \\right ) } \\right]\\mathop   = \\limits^{(a)}\\alpha_2 { \\rm e}\\left [ { { \\hat{\\bf g}}_{k'}^t{{\\hat { \\bar { \\bf g}}}^*}{\\bf{{t}}}{{\\hat { \\bar { \\bf g}}}^h}{{\\hat{{\\bf g}}}_k } } \\right ] + \\alpha_2 { \\rm e}\\left [ { { \\bf{\\xi } } _ { k'}^t{{\\hat { \\bar { \\bf g}}}^*}{\\bf{{t}}}{{\\hat { \\bar { \\bf g}}}^h}{{\\bf{\\xi } } _ k } } \\right]\\mathop   = \\limits^{(b ) } \\alpha_2 \\end{split}\\ ] ]    then , the variance of @xmath389 in the denominator of ( [ scsi_rate ] ) is ( [ var_down_main ] ) , where step @xmath293 indicates the definition of the variance and @xmath295 results from @xmath390 and the independence between @xmath391 and @xmath392  ( @xmath393 ) . for the first term of step @xmath295 in ( [ var_down_main ] ) ,",
    "we have ( [ var_down_main1 ] ) , where step @xmath295 is obtained simply by the property @xmath102 , the properties of gaussian distributed vectors , and ( * ? ? ?",
    "* lemma  2.9 ) . to elaborate in detail , for the items of @xmath293 in ( [ var_down_main1 ] ) with @xmath394 , we have ( [ var_down_ext1 ] ) , where the properties of @xmath395 = { \\left ( { n + 1 } \\right)}\\sigma _ i^4{{\\bf{i}}_n}$ ]  ( @xmath35 ) resulting from the fact that vectors @xmath396 contains the i.i.d .",
    "@xmath29 elements , @xmath397 = 2\\sigma _ \\theta",
    "^4 $ ] for arbitrary complex value @xmath398 , and ( * ? ? ?",
    "* lemma  2.9 ) are utilized , respectively .",
    "while for the items with @xmath399 , we have ( [ var_down_ext2 ] ) , where @xmath102 and the properties of gaussian distributed vectors are utilized , respectively .",
    "subsequently , the left three terms of step @xmath295 in ( [ var_down_main ] ) are calculated and expressed as ( [ var_down_main2 ] ) . substituting ( [ var_down_main1 ] ) and ( [ var_down_main2 ] ) into ( [ var_down_main ] ) leads to ( [ var_down ] ) , where we define @xmath400 with @xmath401 .",
    "similarly , we obtain ( [ down_others ] ) . substituting ( [ mean_upp ] ) , ( [ var_down ] ) and ( [ down_others ] ) into ( [ scsi_rate ] )",
    ", we have ( [ scsi_rate_alpha ] ) , where @xmath402 , @xmath403 @xmath404 $ ] , and step @xmath293 is obtained by substituting ( [ alpha ] ) into ( [ scsi_rate_alpha ] ) . in this way , ( [ scsi_rate_cf ] ) is obtained and thus theorem 1 is demonstrated .",
    "in this appendix , we focus on the proof of the closed - form expression in ( [ scsi_rate ] ) with imperfect csi based zfr / zft processing .",
    "first , we start from the expectation @xmath367 $ ] in the numerator , given by  ( [ hat_mean_upp ] ) , where step @xmath293 is based on the fact that the estimation error matrix @xmath405 is independent of @xmath57 , i.e. , @xmath406 is independent of @xmath407 for @xmath408 , and step @xmath295 is obtained by @xmath409 on account of @xmath410 .      @xmath411 = { \\rm e}\\left [ { { { \\left| { { \\bf{g}}_{k'}^t{\\bf{f}}{{\\bf{g}}_k } } \\right|}^2 } } \\right ] - { \\left| { { \\rm e}\\left [ { { \\bf{g}}_{k'}^t{\\bf{f}}{{\\bf{g}}_k } } \\right ] } \\right|^2 } = { \\rm e}\\left [ { { \\bf{\\hat g}}_{k'}^t{\\bf{f}}{{{\\bf{\\hat g}}}_k}{\\bf{\\hat g}}_k^h{{\\bf{f}}^h}{\\bf{\\hat g}}_{k'}^ * } \\right]- { { \\alpha_2 } ^2 } + { \\rm e}\\left [ { { \\bf{\\hat g}}_{k'}^t{\\bf{f}}{{\\bf{\\xi } } _ k}{\\bf{\\xi } } _ k^h{{\\bf{f}}^h}{\\bf{\\hat g}}_{k'}^ * } \\right]\\\\ & + { \\rm e}\\left [ { { \\bf{\\xi } } _ { k'}^t{\\bf{f}}{{{\\bf{\\hat g}}}_k}{\\bf{\\hat g}}_k^h{{\\bf{f}}^h}{\\bf{\\xi } } _ { k'}^ * } \\right ] + { \\rm e}\\left [ { { \\bf{\\xi } } _ { k'}^t{\\bf{f}}{{\\bf{\\xi } } _ k}{\\bf{\\xi } } _ k^h{{\\bf{f}}^h}{\\bf{\\xi } } _ { k'}^ * } \\right ] \\mathop   = \\limits^{(a)}\\sigma_{{\\xi _ k}}^2{\\rm e}\\left [ { { \\bf{\\hat g}}_{k'}^t{\\bf{f}}{{\\bf{f}}^h}{\\bf{\\hat g}}_{k'}^ * } \\right ] + \\sigma _ { { \\xi _ { k'}}}^2{\\rm e}\\left [ { { \\bf{\\hat g}}_k^h{{\\bf{f}}^h}{\\bf{f}}{{{\\bf{\\hat g}}}_k } } \\right]\\\\ & + \\sigma _ { { \\xi _ k}}^2\\sigma _ { { \\xi _ { k'}}}^2{\\rm tr}\\left\\ { { { \\rm e}\\left [ { { \\bf{f}}{{\\bf{f}}^h } } \\right ] } \\right\\ } \\mathop = \\limits^{(b)}{{\\alpha_2 } ^2}\\sigma _ { { \\xi _ k}}^2{\\rm e}\\left [ { { \\bf{e}}_{k'}^t{\\bf t}\\hat{\\bf{\\omega}}{\\bf t}{{\\bf{e}}_{k ' } } } \\right ] + { { \\alpha_2 } ^2}\\sigma _ { { \\xi _ { k'}}}^2{\\rm e}\\left [ { { \\bf{e}}_k^t{\\bf t}\\hat{\\bf{\\omega}}^*{\\bf t}{{\\bf{e}}_k } } \\right ] + { { \\alpha_2 } ^2}\\sigma _ { { \\xi _ k}}^2\\sigma _ { { \\xi _ { k'}}}^2{\\rm tr}\\left\\ { { { \\rm e}\\left [ { { { \\hat{\\bf { \\omega}}}^*}{\\bf t}\\hat{\\bf{\\omega}}{\\bf t } } \\right ] } \\right\\}\\\\ & \\mathop   = \\limits^{(c)}{{\\alpha_2 } ^2}\\sigma _ { { \\xi _ k}}^2{\\rm e}\\left [ { { { \\hat \\omega}_{k , k } } } \\right ] + { { \\alpha_2 } ^2}\\sigma _ { { \\xi _ { k'}}}^2{\\rm e}\\left [ { \\hat \\omega_{k',k'}^ * } \\right ] + { { \\alpha_2 } ^2}\\sigma _ { { \\xi _ k}}^2\\sigma _ { { \\xi _ { k'}}}^2\\sum\\limits_{j = 1}^{2k } { \\left ( { { \\rm e}\\left [ { \\hat \\omega_{j , j}^*{{\\hat \\omega}_{j',j ' } } } \\right ] + { \\rm e}\\left [ { { { \\left| { { { \\hat \\omega } _ { j , j ' } } } \\right|}^2 } } \\right ] } \\right)}\\mathop   = \\limits^{(d)}{{\\alpha_2 } ^2}{\\theta _ { k',k } } \\end{split}\\ ] ]    where @xmath412 with @xmath413 , step @xmath293 results from the property @xmath102 , @xmath414 and @xmath415=\\sigma_{\\xi_i}^2{\\bf i}_{n}$ ] for @xmath416 , step @xmath295 is obtained by the definition of @xmath343 with @xmath344 for @xmath345 and the fact of @xmath417 and @xmath418 , @xmath334 is just an intuitive transformation , and @xmath347 is derived according to the properties of the inverse wishart matrix in ( [ hat_alpha2_ext1 ] ) and ( [ hat_alpha2_ext2 ] ) .",
    "considering that no sic is performed as @xmath419 , the self - interference term can be rewritten as @xmath420=p_{k'}{\\alpha_2 ^2}\\left({\\theta _ { k',k ' } } + \\sigma _ { { \\xi _ { k'}}}^4\\hat \\eta\\right ) .",
    "\\end{split}\\ ] ]          @xmath422 } \\right|}^2}}}{{{p_k}{\\rm var}\\left [ { { \\bf{g}}_{k'}^t{\\bf{f}}{{\\bf{g}}_k } } \\right ] + { \\rm{s}}{{\\rm{i}}_{k'}}+ { \\rm{i}}{{\\rm{p}}_{k ' } } + { \\rm{n}}{{\\rm{r}}_{k ' } } + { \\rm{n}}{{\\rm{u}}_{k'}}}}\\\\ \\mathop   = \\limits^{(a)}~&\\frac{{{p_k}}}{{\\sum\\limits_{i = 1}^{2k } { { p_i}\\left [ { { \\theta _ { k',i } } + \\frac{{\\sigma _ n^2}}{{{p_{\\rm{r}}}}}\\left ( { \\frac{1}{{\\left ( { n - 2k - 1 } \\right)\\hat \\sigma _ { i'}^2 } } + \\sigma _ { { \\xi _ i}}^2\\hat \\eta } \\right ) } \\right ] }   + { p_{k'}}\\sigma _ { { \\xi _ { k'}}}^4\\hat \\eta + \\frac{{\\sigma _ n^2}}{{\\left ( { n - 2k - 1 } \\right)\\hat \\sigma _ k^2 } } + \\sigma _ n^2\\sigma _ { { \\xi _ { k'}}}^2\\hat \\eta   + \\frac{{\\sigma _ n^4\\hat \\eta } } { { { p_{\\rm{r } } } } } } } \\end{split}\\ ] ]                  h.  a.  suraweera , h.  q.  ngo , t.  q.  duong , c.  yuen and e.  g.  larsson , `` multi - pair amplify - and - forward relaying with large antenna arrays , '' in _ proc .",
    "ieee inter .",
    "( icc13 ) _ , pp .",
    "3228 - 3233 , jun .  2013 .",
    "h.  q.  ngo , h.  a.  suraweera , m.  matthaiou , and e.  g.  larsson , `` multipair full - duplex relaying with massive arrays and linear processing , '' _ ieee j. sel .",
    "areas commun .",
    "_ , vol .",
    "32 , no .  9 , pp . 17211737 , sept .",
    "2014 .",
    "p.  c.  weeraddana , m.  codreanu , m.  latva - aho , and a.  ephremides , `` resource allocation for cross - layer utility maximization in wireless networks , '' _ ieee trans .",
    "_ , vol .  60 , no .  6 , pp .",
    "27902809 , jul ."
  ],
  "abstract_text": [
    "<S> in this paper , we consider a multi - pair two - way amplify - and - forward relaying system where multiple sources exchange information via a relay node equipped with large - scale antenna arrays . </S>",
    "<S> given that channel estimation is non - ideal , and that the relay employs either maximum - ratio combining / maximum - ratio transmission ( mrc / mrt ) or zero - forcing reception / zero - forcing transmission ( zfr / zft ) beamforming , we derive two corresponding closed - form lower bound expressions for the ergodic achievable rate of each pair sources . </S>",
    "<S> the closed - form expressions enable us to design an optimal power allocation ( opa ) scheme that maximizes the sum spectral efficiency under certain practical constraints . as the antenna array size tends to infinity and the signal to noise ratios </S>",
    "<S> become very large , asymptotically optimal power allocation schemes in simple closed - form are derived . the capacity lower bounds are verified to be accurate predictors of the system performance by simulations , and the proposed opa outperforms equal power allocation ( epa ) . </S>",
    "<S> it is also found that in the asymptotic regime , when mrc / mrt is used at the relay and the link end - to - end large - scale fading factors among all pairs are equal , the optimal power allocated to a user is inverse to the large - scale fading factor of the channel from the user to the relay , while opa approaches epa when zfr / zft is adopted . </S>"
  ]
}