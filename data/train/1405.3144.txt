{
  "article_text": [
    "x - ray free electron lasers are now operating  @xcite or under construction around the world  @xcite .",
    "these provide sources of high brightness , monochromatic x - rays that are driving forward many new scientific discoveries .",
    "there is now also increasing user interest in the simultaneous delivery of such radiation at two distinct colours , either simultaneously , or with a short time - delay in a pump - probe architecture",
    ".    two colour operation of an fel was first reported with a relatively low colour contrast in an infra - red oscillator configuration  @xcite , with greater colour contrasts also possible  @xcite .",
    "more recently , two colour operation has been achieved from the uv into the x - ray using different configurations of an fel amplifier .",
    "for example , two - colour operation is being investigated using an electron beam composed of ` beamlets ' of more than one energy  @xcite .",
    "these beamlets , typically of energy separation greater than the fel amplification bandwidth , propagate through identical undulator modules and lase independently and simultaneously .",
    "if the higher energy beamlet emits at an harmonic of the lower energy , then coupling between the beamlets that is favourable to shorter wavelength generation can occur  @xcite .",
    "an alternative approach has been used in  @xcite using a single monoenergetic electron beam propagating sequentially through two undulator modules each tuned to the two different colours .",
    "this method can generate two - colour radiation with a frequency separation of @xmath0  @xcite .",
    "in  @xcite , a frequency separation of @xmath1 was demonstrated using an alternating series of undulator modules tuned to the two colours .",
    "this method generates radiation frequencies with a temporal overlap .",
    "in addition to the beating effects of the two resonant colours  @xcite , a modal spectral structure  @xcite may arise due to the temporal shifts of each colour as it propagates non - resonantly over the electrons in alternate undulator modules .    averaged fel simulation codes such as  @xcite that make the slowly varying envelope approximation ( svea )  @xcite , can readily model 2-colour fel interactions when the radiation wavelengths are close to a fundamental frequency @xmath2 and e.g. its third harmonic @xmath3 .",
    "this requires the radiation to be described by two distinct computational fields as the field sampling at any resonant radiation frequency @xmath4 means the frequency range able to be sampled is limited by the nyquist condition to @xmath5 .",
    "furthermore , the accuracy of the model decreases the further away from the resonant frequency . for a fundamental and e.g. its 3rd harmonic field",
    ", the sampling can be over a common set of ` slices , ' each an integer number of fundamental wavelengths in length",
    ".    however , for cases where the two frequencies in a 2-colour fel are strongly non - harmonic and well separated , e.g. where @xmath6 , modeling of two computational fields using the averaged svea approximation becomes problematic - integer wavelength long slices of the two fields can not be coincident and so when radiation propagation effects are modeled , electrons within these different length slices are driven asymmetrically in phase space leading to unphysical instabilities .",
    "the unaveraged free electron laser simulation code puffin  @xcite does not make the svea approximation and is therefore not restricted to the limited bandwidth of conventional averaged fel codes .",
    "we therefore define such unaveraged simulation codes as being ` broad - bandwidth ' . furthermore , because puffin also models the electron beam dynamics without averaging , the electrons are not confined to localised ` slices ' of width the fundamental radiation wavelength , and a realistic electron beam interaction can occur over a broad bandwidth of radiation wavelengths .",
    "puffin ( along with other unaveraged codes e.g.  @xcite ) is then ideally suited to simulating and investigating the physics of multi - color fels .    in what follows",
    ", the puffin code was modified to allow for undulator modules of different undulator parameters @xmath7 .",
    "this code was then used to simulate a high - gain 2-colour fel amplifier , with undulator modules alternately tuned to well separated , non - harmonic wavelengths .",
    "it is not immediately clear how such an interaction would be expected to progress and in particular how the electron phase space would develop when interacting resonantly with two distinct radiation wavelengths .",
    "the interaction is therefore first seeded , rather than starting from noise , to allow a clearer picture of the electron beam and radiation evolution in the 2-colour interaction .",
    "an example is then given of an unseeded , 2-colour sase fel interaction .",
    "the resonant wavelength of the fel interaction is given by  @xcite : @xmath8 where @xmath9 is the rms undulator parameter , @xmath10 is the rms undulator magnetic field strength , @xmath11 is the undulator period and @xmath12 is the initial electron beam lorentz factor .",
    "alternating the @xmath7 of successive undulator modules , such as used in  @xcite , generates the two resonant colours in the fel interaction for a single monoenergetic electron beam .",
    "a variable undulator parameter is defined as @xmath13 , where @xmath14 is a constant initial value .",
    "puffin uses a system of equations which utilises scaled variables developed in  @xcite .",
    "these dimensionless variables are scaled with respect to the fel parameter , defined as : @xmath15 and @xmath16 . to model alternate undulator modules of different tuning , the modules are tuned by altering the rms undulator magnetic field only . a change in the tuning therefore also changes the fel parameter , and",
    "so it is convenient to redefine the scaling used in puffin to account for the different undulator tunings .",
    "the variable fel parameter is then defined as : @xmath17 where @xmath18 is a constant using @xmath14 and the @xmath19 dependence of @xmath20 is understood .",
    "the electron beam focusing factor @xmath21 of  @xcite , is made variable to maintain a constant beam radius throughout different module tunings so that @xmath22 .",
    "the puffin equations can then be re - scaled with respect to the constant @xmath18 and @xmath14 , making @xmath20 explicit .",
    "the resulting equations are identical in form to equations @xmath23 of  @xcite , with the exception of two multiplicative factors of @xmath20 in equations @xmath24 and @xmath25 , which describe the evolution of the scaled transverse and longitudinal electron momentum @xmath26 and @xmath27 , respectively . ignoring the explicit scaling of the focusing terms ,",
    "these become : @xmath28 \\label{pperpdotgen }    % - \\frac { u \\sqrt{\\eta_0}}{2\\sqrt{2 } f_0\\bar{k}_{\\beta 0 } \\rho_0 l_{0j } } \\times \\nonumber \\\\ & \\biggl ( \\bar{k}_{\\beta 0}^2 ( \\bar{x}_{0j}-i\\bar{y}_{0j } ) % \\left .",
    "+ \\frac{\\eta_0}{(1+\\eta_0 p_{2 0 j } ) } \\left ( \\frac{d\\bar{x}_{0j}}{d\\bar{z}_0 } - i \\frac{d\\bar{y}_{0j}}{d\\bar{z}_0 }   \\right ) \\frac{dp_{20j}}{d\\bar{z}_0}\\bigr|_f \\right ) \\label{pperpdotgen } \\end{aligned}\\ ] ]    @xmath29 , \\label{qeqgen } % + \\frac{dp_{2 0 j}}{d\\bar{z}_0}\\bigr|_f \\label{qeqgen}\\end{aligned}\\ ] ]    where the scaled interaction length is @xmath30 and @xmath31 is the gain length of the @xmath32 interaction .",
    "the system of equations obtained is general , and @xmath20 can be made any function of distance through the interaction as required .",
    "it could , for example , be used to taper the undulator in puffin , or to provide any number of differently tuned undulator modules . for the purposes of this paper",
    ", @xmath20 is varied between two values @xmath33 , corresponding to the two colours of fel radiation , @xmath34 .    in the 2-colour fel , with only one resonant wavelength interaction occurring in each undulator module",
    ", radiation at the non - resonant wavelength will effectively propagate in free space .",
    "two effects can be expected from this .",
    "firstly , the non - resonant wavelength in an undulator module will undergo free - space diffraction ( unless it is an harmonic when some guiding can occur  @xcite ) , which will reduce the net coupling of the radiation to the electron beam and so increase the effective gain length of the interaction for both colours .",
    "secondly , the addition of extra relative slippage between the radiation and the electrons in the non - resonant undulator modules may reduce the radiation bandwidth  @xcite and affect the spectrum by introducing modal effects  @xcite , the latter being the subject of current study .",
    "simulations using this modified version of puffin are now presented that model a 2-colour fel interaction using a single electron beam in sequential undulators tuned to two different resonant wavelengths .",
    "the first example is seeded by temporally coherent external laser sources at both of the resonant frequencies with intensities @xmath35 less than the normal fel saturation power .",
    "the seed powers are assumed constant over the duration of the electron pulse .",
    "these assumptions result in a simpler ( cleaner ) electron beam phase space from which the nature of the 2-colour interaction is more easily observed . while such seeding is feasible at longer wavelengths , e.g. in the uv , it is not yet possible in the x - ray .",
    "hence , the second example starts up from the electron beam shot - noise i.e. 2-color sase to demonstrate x - ray operation .",
    "radiation output spectra for differently tuned 2-colour fels are then summarised .    in a 2-color fel",
    ", there will be a small drift section between each undulator module that may require radiation / electron beam phase matching using small tuning chicanes .",
    "although puffin is capable of modelling the drift sections none are modelled here and an instantaneous change in undulator parameter is applied .",
    "puffin is also used here in the 1d limit as described in @xcite , so that simulations cost considerably less computational effort and the 2-colour interaction can be observed in its simplest form .",
    "more detailed effects including diffraction , that can be expected to alter the optimum set - up , will be investigated in future work .",
    "modules with a fixed number of undulator periods are used which , while reflecting a probable experimental configuration , limits somewhat the options for driving both colours to the same powers . to compensate for the difference in gain lengths of the alternating modules ( @xmath36 ) ,",
    "the @xmath37 undulator modules are arranged in the configuration of fig .",
    "[ figure1 ] .",
    "nm and @xmath38 nm . ]    this has a greater similarity to the configuration of  @xcite , allowing both colours to experience gain periodically through the interaction , and is unlike the configurations of  @xcite which amplify each wavelength in two consecutive interactions .",
    "the limit on the beam energy spread which must be satisfied for gain , @xmath39 , also approximates the energy spread at fel saturation.the undulator configuration of fig .",
    "[ figure1 ] has modules resonant at the wavelengths [ 1,1,2,1,2,2 ] and is chosen to avoid too much initial amplification of the longer wavelength .",
    "when the two colours are well contrasted , as in the following simulations , the longer wavelength interaction could inflate the beam energy spread to impede the interaction at the shorter wavelength , which has the tighter energy spread constraint .",
    "for the same reason , it is preferable that the shorter wavelength is driven close to saturation prior to the longer and then ending the interaction at the longer wavelength .",
    "the undulator module layouts in all of the following cases are designed with these arguments in mind , and are chosen to avoid full saturation of either colour .",
    "the post - saturation regime may be the subject of further publications .",
    "the parameters for the first seeded case are shown in table [ table ] .",
    ".parameters for the 2-colour simulations [ cols=\"^,^,^,^\",options=\"header \" , ]     [ table ]    a small seed field is injected at each resonant frequency , and the electron beam has a ` flat - top ' current profile . in the scaled frame @xmath40 , where @xmath41 is the cooperation length  @xcite of the shorter wavelength , the scaled resonant frequencies @xmath42 are @xmath43 and @xmath44 .",
    "in addition to the scaled radiation field @xmath45 of  @xcite , it is useful to define a measure of the spectral bunching of the @xmath46 electrons as : @xmath47 where : @xmath48 is the source term of the unaveraged radiation wave equation in the compton limit  @xcite for the @xmath49 undulator and @xmath50 is the peak linear density of electrons per unit @xmath51 .",
    "detail of the electron phase space and the modulus of the spectral bunching parameter is shown in fig .",
    "[ figure2 ] at the end of the third module , and still in the linear regime , where @xmath52 .",
    "( top ) ; and modulus of spectral bunching parameter @xmath53 ( bottom ) at the output of the 3rd undulator module at @xmath54 . ]    the bunching spectrum , shown in the bottom plot of fig .  [ figure2 ] , clearly shows bunching components at both frequencies , @xmath55 and @xmath56 .",
    "it is interesting to note here that the beam also displays bunching components at the harmonics and the sums and differences between all of these frequencies . in the beam phase space of the top plot ,",
    "these bunching components are seen in the superimposed periodic electron modulations of periods in @xmath51 of @xmath57 and @xmath58 respectively .",
    "the corresponding scaled ` instantaneous ' temporal intensity ( i.e. including the fast oscillatory terms of the field  @xcite ) and the scaled spectral intensity at the end of the third module are plotted in fig .",
    "[ figure3 ] .     as a function of the scaled temporal coordinate @xmath51 ( top ) and the scaled spectral intensity @xmath59 ( bottom ) at the output of the 3rd undulator module at @xmath54 .",
    "the red line in the temporal intensity plot indicates the current profile of the electron beam . ]",
    "the head of the electron pulse ( shown in red in the top window ) starts the beginning of the interaction at @xmath60 , and slips behind the radiation towards larger values of @xmath61 as the interaction progresses through the undulator .",
    "coherent spontaneous emission at the tail and head of the rectangular current distribution are visible in the top intensity plot .",
    "detail of the spectrum in the bottom plot shows the strong emission at the resonant frequencies @xmath55 and @xmath56 , of the two undulator modules .",
    "a weaker emission is seen at the difference frequency @xmath62 .    figs .",
    "[ figure4 ] and [ figure5 ] plot the same output at the end of the sixth undulator module at @xmath63 , where the longer wavelength is close to saturation , slightly ahead of the shorter .     at output from 6th undulator module at @xmath63 .",
    "]     at output from 6th undulator module at @xmath63 . ]",
    "a quite complex electron phase space has developed as a result of the 2-colour interaction which has generated spectral intensities that are approximately equal for the two colours .",
    "the interaction at the longer wavelength @xmath64 has a greater energy spread tolerance , so the energy modulations at @xmath65 do not have as great an effect on the @xmath64 interaction . due to dispersion in non - resonant undulators",
    ", this can reduce bunching at the shorter wavelength @xmath65 in regions where the energy modulation at @xmath64 shifts the beam off - resonance .",
    "the resultant oscillation of the bunching at @xmath65 therefore occurs with period @xmath64 , and consequently bunching is observed at the sum and difference frequencies @xmath66 and @xmath67 .",
    "this effect generates more frequency components in the bunching as the fel process develops . as seen in fig .",
    "[ figure4 ] , the same mechanism applies as the bunching at @xmath64 and its harmonics grow , so that components develop not just at the sum and difference of the lasing frequencies , but also with the higher harmonic frequencies .",
    "the 2-colour fel interaction is now modelled starting from noise via sase  @xcite . a similar , but extended , undulator beamline as that of fig .",
    "[ figure1 ] is used with @xmath68 modules in a @xmath69 $ ] configuration , to allow for a longer build - up from noise .",
    "otherwise all parameters are identical to the previous seeded case .",
    "one factor that is present in the 2-colour sase , that does not exist in the seeded case , is the potential for phase mis - matching between the radiation and the electron beam due to the extra induced slippage in the alternate non - resonant undulator modules .",
    "this may be mitigated by using modules @xmath70 gain length , ensuring relative slippages are not significantly longer than a cooperation length , so maintaining beam / radiation phase matching . while additional slippage may also assist in improving the coherence of the radiation field as discussed above",
    ", this should not significantly affect the results presented here .",
    "undulator module for sase : detail of electron phase space between @xmath71 ( top ) ; and modulus of spectral bunching parameter @xmath53 ( bottom ) at the output of the @xmath72 undulator module at @xmath73 . ]",
    "as the system now starts from noise , the resultant beam phase space is less structured but maintains similar characteristics to the previous seeded simulations .",
    "similarly to fig .",
    "[ figure4 ] , the electron phase space close to saturation is seen from fig .",
    "[ figure6 ] to have bunching components at both resonant frequencies @xmath34 and at the sum and difference frequencies .",
    "the corresponding scaled radiation intensity and spectrum equivalent to the seeded case of fig .",
    "[ figure5 ] are plotted in fig .",
    "[ figure7 ] , where the spectral intensity levels at both resonant frequencies are seen to be approximately equal . unlike the seeded case , the temporal intensity has the familiar chaotic pulse structure .     as a function of the scaled temporal coordinate @xmath51 ( top ) and the scaled spectral intensity @xmath59 ( bottom ) at the output of the @xmath72 undulator module at @xmath73 .",
    "the red line in the temporal intensity plot indicates the current profile of the electron beam . ]",
    "similar 2-colour sase simulations were also carried out for a system with a longer gain length more typical of an x - ray fel , and with the electron beam and undulator parameters similar to the athos fel proposed at swissfel  @xcite .",
    "the fel parameter is reduced to @xmath74 , and the number of undulator periods per module has been increased to @xmath75 to accomodate the longer gain length .",
    "there are now @xmath76 modules in a @xmath77 $ ] configuration . maintaining the same higher resonant wavelength of @xmath78 nm for @xmath79 ,",
    "simulations for two different 2-colour configurations were carried out for @xmath80 nm and @xmath81 nm corresponding to @xmath82 and @xmath83 respectively .",
    "the normalised saturated sase spectra ( i.e. neglecting the strong cse emitted from the head and tail of the flat - top electron beam ) of the scaled output intensities are plotted in fig .",
    "[ figure8 ] and demonstrates that the principle of such 2-colour fel operation applies across a wide range of wavelengths and to similar saturated radiation powers .",
    "no attempt has been made to optimise the output here , so that the output at a given wavelength may be improved upon .",
    "the statistical nature of the output is also unaccounted for in these single - shot simulations .",
    "the principle of 2-colour fel amplifier lasing using a mono - energetic electron beam in a series of alternately tuned undulator modules was , for the first time , simulated at widely spaced , non - harmonic wavelengths .",
    "such simulations are only practical using non - averaged , broad bandwidth fel simulation codes such as puffin  @xcite .",
    "to enable 2-colour modelling , puffin was modified from that described in  @xcite to allow for any general variation in the magnetic field strength along the undulator .    both seeded and sase 2-colour operation were demonstrated to saturation and gave similar peak spectral intensities at both the resonant wavelengths .",
    "such simultaneous fel lasing to saturation by one electron beam at two distinct , harmonically uncoupled , wavelengths is perhaps not an immediately intuitive result .",
    "however , the electron phase - space evolution has a rich structure , including bunching at the sum and difference frequencies and harmonic components , that clearly demonstrates the simultaneous electron bunching and emission at the two distinct wavelengths .",
    "this result may open up other avenues for further research , for example in the generation of higher - modal radiation emission , multi - modal emission using multiply tuned undulator modules , or perhaps non - linear frequency mixing processes in the fel  @xcite .    in the case of the 2-color sase simulations ,",
    "only a limited number of simulations were performed for each case so that the statistical nature of the 2-colour processes were not explored . in both the seeded and sase cases",
    "the scaled saturation variables indicates that parameters such as photon numbers and pulse durations will be similar to those for the equivalent single colour interaction .",
    "other factors must be taken into account in future 3d simulations .",
    "diffraction will clearly have an effect during ` free ' propagation of the radiation in the non - resonant undulator modules .",
    "another factor is the transverse beam matching to different undulator modules .",
    "this could become more problematic for larger differences in @xmath7 between undulator modules and may limit the range of the 2-colour operation .",
    "clearly , further examination in @xmath84d is needed to identify and perhaps find solutions to such issues .",
    "we gratefully acknowledge the computing time granted by the john von neumann institute for computing ( nic ) and provided on the supercomputer juropa at jlich supercomputing centre ( jsc ) , under project hhh20 ; stfc memorandum of agreement no .",
    "4132361 ; and archie - west high performance computer , epsrc grant",
    "ep / k000586/1 +      p. emma _ et al .",
    "photonics * 4 * , 641 ( 2010 ) h. tanaka _",
    "et al . _ , nat .",
    "photonics * 6 * , 540 ( 2012 ) b.w.j .",
    "mcneil and n. r. thompson , nat .",
    "photonics * 4 * , 814 ( 2010 ) d.a .",
    "jaroszynski , r. prazeres , f. glotin , and j.m .",
    "ortega , phys .",
    "lett . * 72 * , 2387 ( 1994 ) srinivas krishnagopal and vinit kumar , optics comm . * 119 * , 313 - 319 ( 1995 ) c. ronsivalle _",
    "_ , new journal of physics * 16 * , 033018 ( 2014 ) v. petrillo _ et al _ , phys rev lett * 111 * , 114802 ( 2013 ) f. ciocci , g. dattoli , s. pagnutti , a. petralia , e. sabia , p. l. ottaviani , m. ferrario , f. villa and v. petrillo , phys rev lett * 111 * , 264801 ( 2013 ) b.w.j . mcneil and g.r.m .",
    "robb , phys rev e * 70 * , 035501(r ) ( 2004 ) a.a .",
    "lutman , r. coffee , y. ding , z. huang , j. krzywinski , t. maxwell , m. messerschmidt and h .- d .",
    "nuhn , phys rev lett * 110 * , 134801 ( 2013 ) t. hara _",
    "et al _ , nature comm . * 4 * , 2919 ( 2013 ) a. marinelli _",
    "et al _ , phys rev lett * 111 * , 134801 ( 2013 ) n.r .",
    "thomson and b.w.j .",
    "m@xmath85neil , phys . rev .",
    "lett . * 100 * , 203901 ( 2008 ) h.p .",
    "freund , phys .",
    "e , * 52 * , 5401 ( 1995 ) .",
    "s. reiche , nucl .",
    "instr . and meth .",
    "a * 429 * , 243 - 248 ( 1999 ) .",
    "et al _ , nucl .",
    "instr . and meth .",
    "a * 429 * , 233 - 237 ( 1999 ) .",
    "fawley , proceedings of fel 2006 , bessy , berlin , germany , 218 - 221 ( 2006 ) .",
    "f.t . arecchi and r. bonifacio , ieee j. quantum electron .",
    "* qe-1 * , 169 ( 1965 ) .",
    "l.t . campbell and b.w.j .",
    "mcneil , physics of plasmas * 19 * , 093119 ( 2012 ) n. piovella , phys .",
    "plasmas * 6 * , 3358 ( 1999 ) b.w.j .",
    "mcneil , g.r.m .",
    "robb and d.a .",
    "jaroszynski , optics comm . * 165 * , 65 ( 1999 ) s.i .",
    "bajlekov , s.m . hooker and r.",
    "bartolini , proc .",
    "fel 2009 liverpool , mopc42 ( 2009 ) c. maroli , v. petrillo and m. ferrario , phys . rev .",
    "beams * 14 * , 070703 ( 2011 ) r. bonifacio , c. pellegrini and l.m .",
    "narducci , opt . comm . * 50 * , 373 ( 1984 ) .",
    "thompson , d.j . dunning and b.w.j .",
    "mcneil , proceedings of ipac10 , kyoto , japan , tupe050 ( 2010 ) j. wu , a. marinelli and c. pellegrini , proceedings of fel 2012 , nara , japan , tupd07 ( 2012 ) dao xiang , yuantao ding , zhirong huang , and haixiao deng , phys . rev .",
    "beams * 16 * , 010703 ( 2013 ) b.w.j .",
    "mcneil , n.r .",
    "thompson and d.j .",
    "dunning , phys .",
    "lett . , * 110 * , 134802 ( 2013 ) swissfel conceptual design report , psi bericht nr .",
    "10 - 04 , ( ed .",
    "romain ganter ) , 2012"
  ],
  "abstract_text": [
    "<S> studies of a broad bandwidth , two - colour fel amplifier using one monoenergetic electron beam are presented . </S>",
    "<S> the two - colour fel interaction is achieved using a series of undulator modules alternately tuned to two well - separated resonant frequencies . using the broad bandwidth fel simulation code puffin , </S>",
    "<S> the electron beam is shown to bunch strongly and simultaneously at the two resonant frequencies . </S>",
    "<S> electron bunching components are also generated at the sum and difference of the resonant frequencies . </S>"
  ]
}