{
  "article_text": [
    "the problem of constructing models of complex dynamic systems from its time series is of great interest in various fields of science and economics . this is important both for insights",
    "they may provide into the dynamics and for making predictions . since the dynamics of such systems is expected to be non linear in nature , different methods",
    "have been suggested for constructing the models @xcite , @xcite .",
    "these include local linear models , radial basis function approach , artificial neural networks ( ann ) , genetic algorithm ( ga ) and genetic programming ( gp ) . in this note",
    ", we work with the genetic programming framework similar to that used by szpiro @xcite and extend it in some ways .",
    "a brief description of gp is given in sec .",
    "the approach is first tested with two deterministic chaotic time series ( logistic map and rossler system ) @xcite .",
    "we obtain an excellent representation of the data in terms of a non - linear regressive map . in order to further validate the model we also make dynamic predictions . in our view , this is a crucial test of the model . for the logistic map we find impressive results but for the rossler map the results are not so good ( sec .",
    "we next consider two measured or observed time series .",
    "the first one is the time series of measurement of ion saturation current in aditya tokamak plasma @xcite and the second one is the finanical nasdaq composite index .",
    "these series are non - stationary and exhibit fluctuations that are statistical in nature . in view of this",
    "we first separate the fluctuations from the underlying mean behaviour of the series using wavelet transforms @xcite a brief account of wavelets is given in sec .",
    "iv a. further , as in statistical physics ( e.g. langevian equation for brownian particle ) we assume mean dynamics to be deterministic and fluctuations to be stochastic . in order to model the mean dynamics in the gp framework",
    "we first construct an appropriate embedding in the reconstructed phase space for each time series .",
    "this is briefly summarized in sec .",
    "iv b. the properties of the embedding together with genetic programming then gives us an analytical expression for the map .",
    "interestingly , the optimal non - linear model that is generated in this manner is of the pade form @xcite .",
    "they have many interesting mathematical properties , e.g. same or better convergence properties as compared to power series and can model functions with singularities .",
    "we find that the maps describe the dynamics quite well and give good one step predictions .",
    "however , when iterated , the prediction deteriorates rapidly .",
    "our results for the aditya tokamak data and those for the nasdaq composite index are presented in sec .",
    "iv c and d respectively .",
    "v contains some concluding remarks .",
    "under the umbrella of evolutionary algorithms ( ea ) @xcite , @xcite , @xcite , various approaches like genetic algorithm ( ga ) , genetic programming ( gp ) , evolution strategies ( es ) etc have been framed that are aimed at solving complex search and optimization problems .",
    "the approaches differ from one another by the implementation details of genetic structures and the use of various genetic operators . in the present note",
    "we have used genetic programming ( gp ) framework that uses a nonlinear structure for chromosomes ( details given in appendix ) that represent candidate solutions , as against the more popular approach of genetic algorithm ( ga ) @xcite that uses linear structures of chromosomes .    genetic programming ( gp )",
    "uses an iterative computation to progressively get better and better candidate solutions .",
    "we first initialize the population p(time t=0 ) randomly with chromosomes generated as per a template structure , such as    @xmath0    where a , b , c , d are either time lagged variables ( to be described later ) or real numbers and",
    "@xmath1 is one of the arithmatic operators + , - , @xmath2 or @xmath3 .",
    "the population p(t ) is then iterated by following the steps given below :    1 .",
    "evaluate chromosomes in p(t ) using an objective function that is a measure of fitness .",
    "sort the population p(t ) according to fitness values .",
    "2 .   preserve a portion of good chromosomes of p(t ) by copying them on another population p(t+1 ) using the copy operator .",
    "this would assure that the best chromosomes found so far are not lost due to the application of genetic operations on p(t ) .",
    "this feature is known as _",
    "elitism_. 3 .",
    "select pairs of chromosomes from the remaining portion of p(t ) ( typically using a roulette wheel selection criteria that gives more preference to chromosomes having higher fitness values ) and recombine the pairs ( i.e. parents ) stochastically to generate offsprings and put them in p(t+1 ) .",
    "4 .   mutate offsprings in p(t+1 ) stochastically .",
    "steps 3 and 4 give rise to the next generation population p(t+1 ) .",
    "replace newly generated population p(t+1 ) with p(t ) 7 .",
    "advance time t to @xmath4 . 8 .",
    "verify the termination criteria ( i.e. whether generation number t has crossed a preassigned upper limit or whether convergence for fitness values of top chromosomes have been achieved ) .",
    "once satisfactory solution(s ) have been found , the iteration is stopped .",
    "we have followed the general outline of genetic programming ( gp ) as in szpiro @xcite to fit a given data set of time series .",
    "for the time series considered presently , we use 500 points for fitting the data and then carry out an out - of - sample prediction .",
    "the prediction is done using a one - step approach and a dynamic iterative approach , to be described later .",
    "for all the time series considered presently , we assume the map equation to have the form @xmath5    where f represents a function involving time series values @xmath6 in the immediate past , arithmatic operators ( + , - , @xmath7 and @xmath3 ) and numbers bound between -10 and 10 with a precision of 1 digit ; d represents number of previous time series values that may appear in the function and @xmath8 represents a time delay ( to be described later in sec .",
    "iv b ) .",
    "the sum of squared errors , @xmath9    is minimized , where n represents number of @xmath6 values [ eq .",
    "( [ eq : mapequation ] ) ] that are fitted during the gp optimization .    for a given chromosome , the lower the above sum of squared errors , the fitter is the chromosome .",
    "the fitness measure derived from @xmath10 is defined as : @xmath11    where @xmath12 is the average of all @xmath6 ( eq .",
    "[ eq : mapequation ] ) to be fitted .",
    "as described in @xcite , the genetic programming is discouraged to overfit by generating longer strings of chromosomes .",
    "this is achieved by modifying the fitness measure as follows , @xmath13    where n is the number of equations to be fitted in the training set and k is the total number of time lagged variables of the form @xmath14 , @xmath15 , ... etc ( including repetitions ) occurring in the given chromosome .",
    "this modified fitness measure prefers a parsimonious model . for @xmath16 close to 0",
    ", r can be negative .",
    "we consider the time series of 2 known systems , namely 1 ) logistic map and 2 ) rossler system .",
    "the logistic map is defined by the equation @xmath17    we have chosen the control parameter r as 3.891 so that eq .",
    "( [ eqn : logisticmap ] ) generates a chaotic time series . choosing @xmath18=0.1 and bypassing initial 2000 transient points we generate the time series .",
    "we then use gp to fit the data set of 500 points to get the best possible map function using d=1 and @xmath8=1 .",
    "the fit obtained is very good giving @xmath10=3.523*@xmath19 and modified fitness r=1.0 .",
    "the map equation for @xmath6 as a function of time lagged variables as obtained by gp is as follows :    @xmath20    we use the notation @xmath21=@xmath22 and show double precision numbers to only 3 significant digits for the sake of simplicity .",
    "it can be seen that many of the factors in the numerator and the denominator approximately cancel ( apart from higher precision effect ) and the resulting simplified form of the map is @xmath6@xmath23 ) that is remarkably close to the actual map equation .    the normalized mean square error ( nmse ) , @xmath24^{2 }   } { variance \\ of \\ n \\ data \\ points } \\label{eqn : nmse}\\ ] ]",
    "is used as an index for the goodness of fit . for the above gp fit for the dataset of 500 points of logistic map , we get nmse=9.84294*@xmath25 .",
    "the map is then used to make an out - of - sample one - step prediction ( in which given time lagged values are successively used to predict the next dataset value ) starting at different regions in the time series .",
    ".[tab : logisticnmse]nmse ( eq . [ eqn : nmse ] ) for logistic time series using one - step prediction of 200 points starting at different data points . [ cols=\">,<\",options=\"header \" , ]     from table [ tab : nasdaqfitness ] , we see that the fitness values for the two gp solutions are very good .",
    "it must be pointed out that we have enforced persistent solutions in the initial pool of chromosomes having fitness values 0.9924 and 0.9962 for level 2 and 3 series respectively to obtain the gp solutions ( eq . [ eq : gpsoln_nasdaq ] ) .",
    "this feature of enforcing persistent solutions is explained in appendix sec .",
    "2 .    cc    ....               ( a )                         ( b ) ....    fig .",
    "[ fig : nasdaq_fit500 ] ( a ) and ( b ) show comparision between given and gp calculated values of datasets of 500 points for level=2 and level=3 series respectively .",
    "the thick lines close to 0.0 in the figures indicate the difference between the given and calculated values and the small values for differences indicate that the fits are reasonable . the fit is better for level=3 series as compared to level=2 series .",
    "next we carry out a one - step out - of - sample prediction beyond the fitted dataset of 500 points .    cc    ....               ( a )                         ( b ) ....    fig .",
    "[ fig : nasdaq_predict501_1step ] ( a ) and ( b ) show one - step prediction for 500 points beginning at data point 501 for nasdaq level=2 and level=3 smoothened time series respectively .",
    "it can be seen that the one - step prediction is quite good .",
    "the nmse values ( eq . [ eqn : nmse ] ) for the one - step prediction for 100 points are 0.0593 and 0.0242 for level=2 and level=3 smoothened time series resepctively .",
    "cc    ....               ( a )                         ( b ) ....    next a dynamic prediction is made using the gp solutions .",
    "it may be noted that the first point ( i.e. data point 501 ) is not guaranteed to match exactly .",
    "however considering the fact that the general dynamics of the time series would have been captured by gp , the calculated series is shifted such that the data point 501 is matched with the given value .",
    "this requires a marginal shifting for the two calculated series value by -0.0219 ( for level=2 series ) and by -0.0073 ( for level=3 series ) .",
    "[ fig : nasdaq_predict501_mstep ] ( a ) and ( b ) show comparison between actual and predicted values for nasdaq level=2 and level=3 smoothened series resepectively . as can be seen from the figure ,",
    "the predictions are not good .",
    "the dynamic prediction for 10 points gives nmse value as 2.325 and 3.102 for level=2 and level=3 series respectively .",
    "the lyapunov exponents for db-4 level=2 and level=3 nasdaq time series are 0.127 and 0.133 respectively . using these lyapunov exponents",
    "it is estimated that an initial error of 0.026 in @xmath26 step ( level=2 ) would grow in 10 steps to 0.093 and an initial error of 0.036 in @xmath26 step ( level=3 ) would grow in 10 steps to 0.14 . in fig .",
    "[ fig : nasdaq_predict501_mstep ] the error between calculated ( dynamic ) and given data values on the @xmath27 step are 0.078 ( for level=2 ) and 0.21 ( for level=3 ) .",
    "our findings with different data sets suggest that modeling deterministic time series using genetic programming is a very promising approach .",
    "this is particularly the case for data of real systems having complex dynamics after the statistical fluctuations are filtered out .",
    "the filtered series is to modeled by gp and the fluctuations by their statistical properties .",
    "also it may be noted that as against other modeling approaches , gp does not require the calculation of any derivatives within the optimization procedure , and therefore it is well suited for the modeling of rapidly fluctuating time series .",
    "our results for logistic map and rossler discretized system are quite impressive , giving good fitness values , good nmse values , good 1-step predictions and above all good dynamic predictions . on the other hand",
    "the gp models for time series of real systems are satisfactory for giving good fitness values .",
    "as we have seen , a short coming of this method so far is that for real systems the iterative dynamic predictions are poor . in view of this",
    "we have developed ( see appendix sec .",
    "3 ) an extension of gp to include fitting a sequence of values of the time series .",
    "this will enable us to capture patterns in the time series data .",
    "this work will be reported separately .",
    "we wish to acknowledge dr .",
    "r. jha of institute for plasma research for providing us with aditya tokamak data @xcite .",
    "here we give details of implementation and improvements that have been made in our work .      a genetic programming ( gp )",
    "considers an ensemble of chromosomes , called the population , as the starting point and then processes it from one generation to the next .",
    "a given chromosome encodes a candidate solution of the optimization problem .",
    "the fitness of the chromosome is decided by an objective function that maps the chromosome structure to a fitness value .",
    "it is assumed that highly fit chromsomes are more likely to breed offsprings for the next generation .",
    "genetic operators , namely copy , crossover and mutation are applied to generate a new ensemble of chromsomes . as a result of this evolutionary cycle of selection ,",
    "crossover and mutation , more and more suitable chromsomes for the given optimization problem emerge within the population .",
    "it is at the discretion of the user to select the top ( or one of the top most ) chromosome of the population at the end of a sufficient number of generations of the population .",
    "* structure of chromosome : we have used a binary tree representation of the chromosome as described below . * an objective function for assessing the fitness of a chromosome : eq .",
    "[ eq : rsquaremodified ] that uses eq .",
    "[ eq : sumsqerrors ] and eq .",
    "[ eq : rsquare ] is used as an objective function .",
    "* values of parameters of the gp , such as the following : 1 .",
    "population size : we have used 400 chromosomes for 1-step fit .",
    "2 .   number of generations : maximum number of generations is set at 5000 , however if the fitness of the top chromsome does not vary sizably for around a few hundred generations , then iterations are stopped .",
    "probabilities for appying genetic operators : whenever an operator needs to be chosen at random , we use 40% and 60% for selecting either a number ( from -10.0 to 10.0 with the precision of one decimal ) or a time lagged variable . for the mutation probability",
    "we have used 90% for enforcing mutation leaving aside top 10% chromosomes from getting mutated .",
    "this is referred to as _ elitism _ in ga literature that helps preserve a proportion of top most population in successive generations thereby not loosing whatever good that has been found so far .        where d is the embedding dimension and @xmath8 is the sampling time .",
    "the aim of genetic programming is to find out the best possible functional form of f that gives rise to the map of the given time series in terms of the previous time lagged components .",
    "once the map equation is available by fitting a given set of data points , it can be used for predicting the future state of the system , i.e. generate out - of - sample time series data .",
    "the structure of chromosome is in the form of an algebraic expression involving binary operators , numbers and time lagged variables of the form @xmath14 .",
    "we have used a binary tree representation using non - linear dynamic data structures for the structural representation of chromosomes .",
    "* brackets are not required to be stored explicitly in the binary representation . * the genetic operations on the chromosomes ,",
    "are considerably simplified as only pointers need to be manipulated while carrying out the crossover operation . * since binary tree is grown using a dynamic data structures , it is not required to specify an upper limit for number of tokens in the expression tree .",
    "this eliminates the need for boundary level checking for the overflow of the size of expression tree beyond the specified limit . in such a case of overflow of expression size",
    ", one normally brings back the expression to a template structure thereby loosing the structural information found so far .",
    "* it has been found that many of the gp solutions turn out to be in the pade form .",
    "it is quite straight forward to check whether a given gp solution is in the pade form or not .",
    "this is done just by inspecting the operator in the root node of the tree and confirming whether it is division operator or not . in the same way , it is quite straight forward to optionally impose a pade form for gp solution . * evaluation of the expression in binary tree representation is considerably simpler ( each leaf sub - tree is evaluated and collapsed to a numerical value using a recursive procedure till the whole tree finally reduces to a number ) .",
    "in contrast , if an expression has a linear structure ( e.g. an array ) , then multiple passes of array are required to give due credence to the hierarchy of operators .",
    "it is observed that for a non - stationary time series ( e.g. nasdaq series ) , a persistent solution @xmath6=@xmath29 , although not the best possible solution , usually gives quite a good fitness value close to 1.0 .",
    "further it is observed that if during gp iterations such persistent solutions are found , they tend to dominate the population thereby giving rise to convergence to such trivial solutions . since these trivial solutions are of no interest from the viewpoint of underlying dynamics of the system , it is essential to get the gp away from such trivial solutions",
    ". it is interesting to understand the reason why the majority of the population tends to get flooded by trivial solutions .",
    "this is because the tree for such solutions is a single node tree and so crossover can not lead to new solutions .",
    "mutation would also not help in such situations because gp settles down to a single node solution corresponding to the best possible time lagged variable ( say @xmath29 ) , and changing this variable to another time lagged variable leads to decrease in fitness value .",
    "thus gp optimization is virtually helpless i.e. is left without any means to come out of the local minima arising out of persistent solution .    in order to resolve this problem ,",
    "we use various forms of multipliers to the gp chromosome .",
    "the multiplier can be a constant number c or possibly a gaussian curve passing through the data set of points to be fitted . in case of a constant multiplier ,",
    "the trivial solution is in the form of @xmath30 and it is easy to see that gp can now possibly vary and grow this structure by the genetic crossover and mutation operators to optimize the fitness value .",
    "in fact , we have been able to transform the problem ( arising out of convergence to local minima due to such trivial solutions ) to our advantage by starting the gp iteration from the reasonably higher fitness values of trivial solution . on the other hand",
    "if we start with a purely random population , we have usually found that the top most chromosome in the population has a much lower value of fitness compared to that of a trivial solution and it has to undergo a substantially large number of iterations to reach to this fitness value if not surpass it .",
    "the usual method adopted for prediction is to first fit a given data set of points and then make out - of - sample prediction using either 1-step or multi - step ( dynamic ) prediction .",
    "the 1-step predictions obtained by gp fit are usually found to be good .",
    "the real test of any dynamic model however lies in whether it is able to make out - of - sample dynamic predictions outside the range of data set used for fitting by gp .",
    "it is observed that the dynamic prediction is either not good or at the most it gives good predictions only for a very few number of points . in a way",
    "this is understandable because our fit itself is of 1-step nature .",
    "the number of equations to be fitted by gp during an iteration are all trying to fit the next point using a map involving its time lagged variables occurring in immediate past .",
    "thus gp is not trained to make multiple time step predictions .",
    "we have therefore also considered a multi - step fit by gp .",
    "we require gp to fit not just the next step @xmath6 ( of eq . [ eq : mapequation ] ) , but also @xmath31 , @xmath32 , ... @xmath33 , where m is a predefined number of steps .",
    "thus for a given equation to be fitted , the sum of squared errors invloves not only @xmath34^{2}$ ] , but in addition @xmath35^{2}$ ] , ... up to @xmath36^{2}$ ] .",
    "however it may be noted that multi - step gp fit leads to a very involved computation and we are currently able to carry out such gp fit for a limited population size only .",
    "a.s.weigend and n.a.gershenfeld , _ time series prediction : forecasting the future and understanding the past _ santa fe institute studies in the science of complexity , proc .",
    "* xv * , addison - wesley , reading ( 1993 ) ."
  ],
  "abstract_text": [
    "<S> analytic models of two computer generated time series ( logistic map and rossler system ) and two real time series ( ion saturation current in aditya tokamak plasma and nasdaq composite index ) are constructed using genetic programming ( gp ) framework . in each case , the optimal map that results from fitting part of the data set also provides a very good description of rest of the data . </S>",
    "<S> predictions made using the map iteratively range from being very good to fair . </S>"
  ]
}