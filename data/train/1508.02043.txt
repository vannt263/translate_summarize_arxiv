{
  "article_text": [
    "motivated by the availability of data on many real world systems , the last few years have witnessed an explosion in both methodological as well as theoretical development of various complex network models . the aim of these models is to explain structural features observed in the data ( e.g. power law degree distribution or `` small world '' connectivity ) as well as understand and predict the behavior of dynamic processes on these networks including disease contact networks , search algorithms , random walks , evolution and dissolution of communities and a wide array of related processes @xcite .",
    "one sub - field of this vast field which has been particularly active is temporal or time varying networks .",
    "see the recent surveys @xcite and the references therein for both methodological developments as well as applications in a wide array of fields ranging from social networks and online communication , cell biology including temporal properties of protein interaction networks , and infrastructure systems such as the power grid .",
    "many such proposed models are driven by a collection of parameters that describe the evolution of the network .",
    "a natural question in this context is the study of _ change points _ , the effect of abrupt changes in parameters driving the evolution of the network , on structural properties of the network . to fix ideas , first consider the simplest version of the classical ( offline ) change point detection in the context of _ iid _ data described as follows .",
    "fix two distribution functions @xmath0 and @xmath1 ( unknown but different ) and a parameter @xmath2 .",
    "consider a stream of data @xmath3 with distribution : for @xmath4 @xmath5 are _ iid _ with distribution @xmath0 whilst for @xmath6 , @xmath5 are _ iid _ with distribution @xmath1 ( and independent of the initial segment ) . based on the observed data , @xmath7 ,",
    "the aim is then to estimate the change point @xmath8 using estimators that are consistent as the sample size @xmath9 .    in this spirit",
    ", this paper has two main goals :    we start with a variation of the standard preferential attachment model of evolving networks that incorporates a change point .",
    "this conceptually simple model allows for a simple interpretation of the effect of the change point on network dynamics .",
    "we rigorously study the effect of this change point on structural properties of the network including the scale - free or heavy tailed nature of the limiting degree distribution as well as asymptotics for the maximal degrees .",
    "we then propose and study consistency properties of offline estimation procedures to detect the location of this change point from observed data .",
    "in particular this allows one to gain insight into the effect of the non - stationary nature of the evolution of the network model on various known heuristics for estimation in the _ iid _ setting .",
    "both change point detection as well as preferential attachment models have witnessed enormous amount of work over the last few decades .",
    "we defer a fuller discussion of these two fields , their relevance to this paper as well as related work to section [ sec : disc ] .",
    "we start in section [ sec : model ] by defining the model . in section",
    "[ sec : prelim ] we setup notation required for the main results .",
    "section [ sec : res ] contains our main results , starting with section [ sec : res - deg - dist ] that describes asymptotics for functionals of the networks including the degree distribution as well as maximal degrees as the network size @xmath10 .",
    "section [ sec : res - stat ] formulates estimators to find the change point and formulates consistency properties for these estimators .",
    "proofs for asymptotics of network functionals can be found in section [ sec : proofs ] .",
    "section [ sec : leafclt - proofs ] develops a functional central limit theorem for a specific functional of the network .",
    "section [ sec : consistency ] then uses this clt to prove consistency of the proposed estimator .",
    "we start by describing the original model of preferential attachment with no change point @xcite .",
    "there are many variants of this model . throughout the paper",
    "we will consider the simplest case where the network at each stage is a tree .",
    "the methodology can be generalized to the general network setup .",
    "start with a single vertex at time @xmath11 ( this vertex will be referred to as the _ root _ or the original progenitor of the process and denoted by @xmath12 ) .",
    "fix a parameter @xmath13 . at each discrete time point",
    "@xmath14 a new vertex enters the system with a _ single edge _ which it will then connect to a pre - existing vertex .",
    "the vertex connects to a pre - existing vertex @xmath15 with probability proportional to the current degree of @xmath15 @xmath16 .",
    "let @xmath17 denote the graph at time @xmath18 and @xmath19 be the entire graph valued process .",
    "note that since each new vertex has one edge which it uses to connect to the current graph , @xmath17 for any @xmath18 is a tree ( which we view as rooted at @xmath12 ) .",
    "thus for @xmath20 , the degree of every vertex is at least @xmath21 . further calling the pre - existing vertex that a new vertex attaches to as the _ parent _ of this vertex",
    ", one can view this process as generating a directed tree with edges pointed from parents to children .",
    "we will soon switch over to a continuous time version of the process where it is convenient to work with a slight variant of the above process .",
    "note that for a ( directed rooted ) tree , the degree of every vertex other than the root is @xmath22 out - degree of the vertex . for the root , the degree and the out - degree coincide .",
    "now fix a single vertex at time @xmath11 and a parameter @xmath23 .",
    "the variant considered in this paper is as follows : at each stage @xmath20 a new vertex enters the system and connects to a pre - existing vertex @xmath24 with probability proportional to @xmath25 out - degree of @xmath15 in @xmath26 .",
    "this variant results in all the same asymptotic properties as the original model and is slightly easier to deal with rigorously .",
    "this model has been studied extensively and in particular it is known @xcite that the degree distribution converges in the large network limit . precisely , for fixed @xmath27 , let @xmath28 denote the number of vertices with degree @xmath29 in @xmath30 .",
    "then , @xmath31 here for @xmath32 , we use the notation @xmath33 . write @xmath34 for a random variable with the above distribution .",
    "it is easy to check that there exists a constant @xmath35 such that @xmath36    further , arranging the degrees in @xmath30 in decreasing order as @xmath37 , it is known @xcite that for any fixed @xmath27 , there exists a non - degenerate probability distribution @xmath38 on @xmath39 such that @xmath40      now fix two attachment parameters @xmath41 , a change point parameter @xmath2 , and a system size @xmath42 .",
    "the model does preferential attachment as before , but now the attachment dynamics changes after time @xmath43 namely    for time @xmath44 , the new vertex entering the system at time @xmath18 connects to pre - existing vertices with probability proportional to their current out - degree @xmath45 .    for time",
    "@xmath46 , the new vertex connects to pre - existing vertices with probability proportional to their current out - degree @xmath47 .",
    "let @xmath48 be the driving set of parameters of the model .",
    "we will let @xmath49 denote the rooted tree at time @xmath18 and @xmath50 for the entire graph valued process .",
    "when the context is clear , for ease of notation we suppress the dependence on @xmath51 and write @xmath52 .",
    "this model is the main object of interest for the rest of the paper .      to state our main results",
    "we will need to define some additional objects .",
    "recall the parameter set @xmath53 used to construct the model . let @xmath54 be a sequence of independent exponential random variables such that for each fixed @xmath27 , @xmath55 has rate @xmath56 .",
    "view the above as the inter - arrival times of a point process @xmath57 on @xmath58 .",
    "more precisely write , @xmath59 consider the point process @xmath60 analogously define @xmath61 , @xmath62 and the corresponding point process @xmath63 . for",
    "fixed @xmath64 , write @xmath65 $ ] for the number of points in @xmath66 which fall in the interval @xmath67 $ ]",
    ".    we will need variants of the above point process .",
    "fix @xmath68 and @xmath23 .",
    "let @xmath69 be the point process where we use the sequence of points @xmath70 to construct the point process so that the first point arrives after an exponential rate @xmath71 amount of time , the second point arrives at rate @xmath72 after the first point and so forth . as before",
    "let @xmath73 be the corresponding counting process and note that @xmath74 .",
    "define the constant @xmath75 on the interval @xmath76 $ ] , define the `` truncated '' exponential distribution described via the cumulative distribution function @xmath77.\\ ] ] write @xmath78 for a random variable with distribution @xmath79 ( the reason for this terminology will become clear in the proof ) .",
    "generate a counting process @xmath80 as above ( independent of @xmath78 ) and let @xmath81 $ ] , namely the number of points that occur before the random time @xmath78 . here",
    "@xmath82 is a mnemonic for `` after change point '' .",
    "we are now in a position to define the limiting degree distribution .",
    "consider the following integer valued random variable @xmath83 :    with probability @xmath84 , @xmath85 .    with probability @xmath8 ,",
    "@xmath86 $ ] where @xmath34 is a random variable with distribution as in , namely the limiting degree distribution _ without _ change point .",
    "more precisely , generate @xmath34 with distribution as in .",
    "conditional on @xmath34 , generate the point process @xmath87 and count the number of points in the interval @xmath76 $ ] and add this to the original random variable @xmath34 .",
    "write @xmath88 for the probability mass function of the above random variable namely @xmath89",
    "let us now describe our main results .",
    "we state results about the asymptotic degree distribution in section [ sec : res - deg - dist ] .",
    "we formulate statistical procedures to estimate the change point and the associated consistency results in section [ sec : res - stat ] .      fix @xmath90 . for",
    "fixed @xmath27 let @xmath28 denote the number of vertices with degree @xmath29 in the random tree @xmath30 constructed in the change point model as in section [ sec : model - cp - def ] .",
    "the random variable @xmath83 in the following result is as defined in .",
    "[ thm : deg - dist ] fix @xmath27 . as @xmath10 the degree distribution satisfies , @xmath91 further for @xmath92 and @xmath93 , @xmath94 .",
    "however there exist constants @xmath95 such that for all @xmath27 @xmath96    this theorem says that one * does feel * the effect of the change point in the empirical degree distribution if @xmath92 and @xmath2 , however comparing with , for any fixed @xmath2 , this does * not * change the tail behavior .",
    "this is a little surprising as one might assume , especially for @xmath8 close to zero and @xmath97 ( where the no change point dynamics with @xmath98 instead of @xmath99 results in a degree distribution with a heavier tail ) , the tail of the degree distribution might scale like @xmath100 , namely the dynamics of attachment driven by @xmath98 should kick in .",
    "however this is not the case .",
    "the techniques developed in this paper easily extend to the setting of multiple change points .",
    "we describe these extensions in theorem [ thm : multi - change - pt ] .",
    "the next result deals with maximal degree asymptotics . as before arrange the degrees in @xmath30 in decreasing order as @xmath101 .",
    "[ thm : max - deg ] fix @xmath27 and consider the @xmath29 maximal degrees @xmath102",
    ". then the sequence of @xmath39 valued random variables defined by setting @xmath103 is tight and bounded away from zero .    comparing the scaling of the maximal degrees above to the setting of no change point",
    "as described in , one sees that the maximal degrees do not feel the effect of the change point , at least in terms of their order of magnitude .",
    "we further conjecture that @xmath104 converge weakly to a non - degenerate distribution on @xmath105 .",
    "we have not pursued this further in this paper .     and a corresponding sample of the same size from the predicted degree distribution .",
    "the model parameters are taken as @xmath106 and the change point @xmath107 .",
    "we discuss other values of the parameters in section [ sec : disc ] . ]",
    "the aim of this section is to formulate a non - parametric estimator for the change point based on observations of the network and state consistency results for this estimator .",
    "we first need some notation . for",
    "fixed @xmath27 let @xmath108 denote the number of vertices with degree @xmath29 in the tree @xmath17 .",
    "rescaling time by @xmath109 , for @xmath110 , let @xmath111 .",
    "finally define @xmath112 namely the proportion of vertices with degree @xmath29 at time @xmath113 .",
    "the @xmath32 case corresponds to the number of leaves . to ease notation in the displays below , write @xmath114 .",
    "now define the continuous function , @xmath115 we will prove in section [ sec : leaf - expec ] that for each fixed @xmath116 , @xmath117 will represent the limiting proportion of leaves in @xmath118 . to simplify notation in the sequel ,",
    "define the function @xmath119 $ ] by the prescription @xmath120 note that @xmath121 for @xmath122 .",
    "now define the positive function @xmath123 via the formulae @xmath124 & \\mbox { if } 0{\\leqslant}t{\\leqslant}\\gamma,\\\\          & \\\\",
    "\\gamma^{2\\delta_\\alpha}\\left(\\frac{t}{\\gamma}\\right)^{2\\delta_\\beta } \\delta_\\beta p^{{\\scriptscriptstyle}(\\infty)}_t(1- \\delta_\\beta p^{{\\scriptscriptstyle}(\\infty)}_t ) , & \\mbox{if } \\gamma < t{\\leqslant}1 .",
    "\\end{array }      \\right.\\ ] ] for later use define the functions @xmath125 & \\mbox { if } 0{\\leqslant}t{\\leqslant}\\gamma,\\\\          & \\\\           \\delta_\\beta p^{{\\scriptscriptstyle}(\\infty)}_t(1- \\delta_\\beta p^{{\\scriptscriptstyle}(\\infty)}_t ) , & \\mbox{if } \\gamma < t{\\leqslant}1 ,        \\end{array }      \\right.\\ ] ] and @xmath126    define the diffusion @xmath127 via the prescription @xmath128 here @xmath129 is standard brownian motion on @xmath58 . thus @xmath130 is essentially a deterministic time change of @xmath131 namely @xmath132 in particular @xmath133 is a gaussian process on @xmath134 $ ] . finally define the functions @xmath135    define the process @xmath136 by ito s formula @xmath137 solves the sde @xmath138 where @xmath139 and @xmath140 are as in and respectively",
    ". then we have the following result .",
    "[ thm : leaves - fclt ] consider the process of re - centered and normalized number of leaves @xmath141 with linear interpolation between time points . then @xmath142 where @xmath1 is the diffusion defined in and convergence is with respect weak convergence on @xmath143)$ ] with respect to the usual skorohod metric .",
    "for the rest of this section , let @xmath144 denote the proportion of leaves ( degree one vertices ) in @xmath17 .",
    "fix @xmath145 .",
    "we will define two functions on the interval @xmath146 $ ] .",
    "let @xmath147 let @xmath148 in words , @xmath149 represents the average proportion of leaves in the process between time @xmath150 and @xmath113 while @xmath151 represents the same quantity but after time @xmath113 .",
    "define the function @xmath152.\\ ] ] write @xmath153 for the collection of points @xmath154 for which the corresponding function value @xmath155 is within @xmath156 of the maximum of the function . precisely , let @xmath157 } d_n(t)$ ] and let @xmath158 : |d_n(t ) - d_n^*|{\\leqslant}\\frac{\\log{n}}{\\sqrt{n}}\\right\\}}.\\ ] ] finally let @xmath159 the functionals @xmath160 all depend on @xmath161 but we suppress this dependence to ease exposition below .",
    "[ thm : cp - estimator - cons ] assume that the change point @xmath162 .",
    "then the estimator @xmath163 and in fact @xmath164 thus @xmath165 is a consistent estimator for the change point @xmath8 .",
    "the @xmath161-truncation away from zero is a technical compensation for the factor @xmath154 in the denominator in .",
    "technically one should be able to choose a sequence @xmath166 slowly enough such that the above result ( modified using this sequence @xmath167 instead of the fixed @xmath161 ) is true .",
    "this would make the assumption of @xmath168 irrelevant in the statement of the theorem .",
    "the threshold @xmath156 in was arbitrary in the sense that if we chose the threshold to be @xmath169 where @xmath170 arbitrarily",
    "slowly then the corresponding estimator would satisfy with bound @xmath169 .",
    "see figure [ fig : dtv ] for a figure based on simulations for the function @xmath155 with @xmath161 taken to be zero .     with network size @xmath171 , and model parameters @xmath106 and the change point @xmath107 as in figure [ fig : log - log ] .",
    "we now discuss the relevance of our results , their connections to existing literature and possible extensions of the results in this paper .",
    "the proof techniques carry over in a straightforward fashion to the general setting of multiple change points .",
    "fix time points @xmath172 and parameters @xmath173 .",
    "as before write @xmath174 for the parameter set .",
    "consider the random tree @xmath175 where    in the interval @xmath176 , vertices use the attachment scheme driven by @xmath99 ( namely each new vertex attaches to an existing vertex with probability proportional to out - degree @xmath45 ) .    in subsequent intervals",
    "@xmath177 where @xmath178 , vertices perform the attachment scheme driven by the parameter @xmath179 . here",
    "we use the convention @xmath180 .    as in section",
    "[ sec : prelim ] define the point processes @xmath181 and for fixed @xmath68 , the point processes @xmath182 . to simplify notation , for any @xmath64 and point process @xmath183 , set @xmath184 $ ] for the _ number _ of points in the interval @xmath67 $ ] .",
    "define the constants @xmath185 note that @xmath186 is a probability mass function .",
    "write @xmath187 for a random variable with distribution @xmath188 ( i.e. @xmath189 for @xmath190 ) . using the constants @xmath191",
    "let @xmath192 denote corresponding truncated exponential distributions as in and let @xmath193 denote a random variable with distribution @xmath192 .",
    "now construct the random variable @xmath194 as follows :    generate a collection of independent random variables @xmath187 and @xmath195 with distributions specified as above .",
    "conditional on @xmath196 , let @xmath197 where again by convention , if @xmath198 , @xmath199 and so @xmath200 .    construct a positive integer valued random variable @xmath83 as follows :    generate @xmath201 as above and the corresponding random variable @xmath194 .",
    "if @xmath187 takes a non - zero value @xmath202 , conditional on @xmath203 , generate the switching point process @xmath204 on the interval @xmath205 $ ] as follows :    * initialization : * in the interval @xmath206 $ ] , start with @xmath207 .",
    "suppose by time @xmath193 , @xmath208 = k$ ] .",
    "now generate a point process @xmath209 and let @xmath210 = { \\mathcal{p}}_{\\star}[0,{{\\sf age } } _ i]+{\\mathcal{p}}_{\\beta_{i+1}}^k[0,a_{i+1}]$ ] .",
    "* recursion : * for each subsequent interval @xmath211 $ ] with @xmath212 , conditional on @xmath213 = k_j $ ] , generate the point process @xmath214 .",
    "define @xmath215 = { \\mathcal{p}}_{\\star}[0,{{\\sf age } } _",
    "i+a_{i+1}+\\cdots a_j ] + { \\mathcal{p}}_{\\beta_{j+1}}^{k_j+1}[0,a_{j+1}].\\ ] ] iterate until the last interval resulting in @xmath216 $ ] .    now define @xmath217 $ ] .    if @xmath218 , so that @xmath219 , generate a random variable @xmath34 with distribution @xmath220 as in .",
    "conditional on @xmath34 , generate @xmath204 in the interval @xmath221 $ ] with distribution @xmath222 and then sequentially proceed as in ( ii ) . in this case , define @xmath223 $ ] .",
    "write @xmath224 for the pmf of @xmath83 .",
    "as before for @xmath27 , let @xmath28 denote the number of vertices with degree @xmath29 in @xmath30",
    ". then we have the following result .",
    "[ thm : multi - change - pt ] as @xmath10 we have @xmath225 further there exist constants @xmath226 such that for all @xmath27 @xmath227      this problem has a vast history owing to its obvious importance in applications in fields ranging from quality control and reliability of industrial processes , in particular quick detection of process failure in production , to fields such as signal processing ( e.g. biomedical data including neuronal spike data and seismic data ) , automatic segmentation of signals into stationary segments via identification of change points etc .",
    "while it is impossible to provide a representative sampling of this area , we direct the interested reader to @xcite and the references therein for an overview of just some of the statistical methodology as well as applications .    in this context ,",
    "recall the motivating example of an independent stream of data @xmath7 with a change point in the distribution from @xmath0 to @xmath1 at time @xmath228 described in section [ sec : intro ] .",
    "let @xmath229 and @xmath230 denote the empirical distribution of the data before and after @xmath154 namely @xmath231 now define @xmath232 where @xmath233 is any standard notion of distance between probability distributions on @xmath234 e.g. kolmogarov - smirnov supremum norm or total variation distance .",
    "finally define @xmath235 } d_n(t).\\ ] ] then in @xcite it is shown that @xmath165 is a consistent estimator of @xmath8 .",
    "this was partial motivation for our estimator . note the `` asymmetry '' as a function of @xmath154 between the `` classical '' context and the model with change point highlighting the non - ergodic nature of the evolution of the model after the change point .",
    "a second point to note is that we use information on leaf densities in the large network @xmath10 limit . as in @xcite ,",
    "one should be able to build on the functional clt for leaf counts to establish a joint functional clt for @xmath236 after proper normalization and re - centering for any fixed @xmath237 . modifying the estimator in section [ sec : consistency ] should enable one to get estimators that perform better for finite @xmath109 .",
    "as described in the introduction , the availability of data on real world networks over the last few years has motivated development of mathematical methodology in a wide array of fields including computer science , statistical physics and probability to make sense of this data . with regards to problems philosophically similar to change point detection , analogous to segmentation and boundary detection @xcite ,",
    "there has been a significant amount of work detecting anomalous subgraphs and motifs _ within _ networks , see e.g. @xcite , for a wide - ranging survey see @xcite .",
    "this also includes anomalous edge detection via link prediction algorithms @xcite . with regards to detection of change points in temporal ( time - varying ) network data and in particular structural properties of these objects",
    "see @xcite that posits an algorithmic approach based on minimum description length to understand evolving communities in social networks . for statistically grounded approaches",
    "see @xcite .",
    "see @xcite for an overview of the state of the art regarding change point detection in networks and develops new statistical methodology using a generalized hierarchical random graph model ( ghrg ) and various likelihood ratio based test statistics to detect existence of change points via online detection algorithms .",
    "this paper also studies the performance of these algorithms on simulated as well as real data including the mit proximity data @xcite and the enron email network data .",
    "see @xcite for rigorous analysis of models where each time slice of the model is assumed to be an erdos - renyi random graph .",
    "this model has become one of the standard workhorses in the complex networks community , in particular for its ability to give a generative reason for the power law / heavy tailed degree distribution observed in an array of real world systems . at this point",
    "it is impossible to compile a representative list of references , we will try to give an overview , restricting ourselves as far as possible to papers close in spirit to this paper ; see @xcite where it was introduced in the combinatorics community , @xcite for bringing this model to the attention of the networks community , @xcite,@xcite for survey level treatments of a wide array of models , @xcite for the first rigorous results on the asymptotic degree distribution , and @xcite , @xcite , @xcite , and @xcite and the references therein for more general models and results .",
    "we are not aware of other analysis of the effect of change point in structural properties of such network models .",
    "there has been a lot of recent interest in understanding and detecting the `` initial seed '' @xcite .",
    "here one starts with an initial `` seed graph '' at time @xmath238 and then performs preferential attachment started from that seed .",
    "the aim is then to estimate this initial seed based on an observation of the network at some large time @xmath109 . while different from this paper , this body of work again emphasizes the sensitive dependence on initial conditions for such network models .",
    "a number of techniques have been developed to rigorously analyze functionals such as asymptotic degree distributions ( see @xcite for nice pedagogical treatment ) .",
    "the standard technique involves writing down recursions for the expected degree distribution @xmath239 using the prescribed dynamics of the process , to show that these expectations ( normalized by @xmath109 ) converge in the limit and then showing that the deviations @xmath240 are small via concentration inequalities .",
    "in this paper , for understanding structural properties we use a different technique , essentially embedding the discrete time model in a corresponding `` continuous time '' branching process @xmath241 ( based on the athreya - karlin embedding of urn processes @xcite ) .",
    "this explains the various point processes that arise in the description of the limiting degree distribution . while mathematically more involved , this technique gives more insight into the results as it elucidates the natural time scale of the process . in various other settings",
    "this technique has resulted in the study of much more general functionals of the process such as the spectral distribution of the adjacency matrix @xcite and has been used to derive asymptotic results in `` non - local '' preferential attachment models @xcite . in this paper",
    "the technique also allows one to intuitively understand why the degree exponent does not change .",
    "we advise the reader to come back to the text below after going through the proofs but let us explain the basic intuition here . in the continuous time version , the process grows exponentially and in particular takes time @xmath242 to get to size @xmath228 . at this time",
    "there is a change in the evolution where each vertex adopts attachment dynamics driven by the parameter @xmath98 .",
    "however owing to the exponential growth rate , the time for the process to get to size @xmath109 is @xmath243 where @xmath244 is as in .",
    "thus the process does not have enough time for the dynamics with attachment parameter @xmath98 to change the degree exponent ( since we only have to wait an @xmath245 extra units of time to get to system size @xmath109 from @xmath246 ) .",
    "these ideas are made mathematically rigorous in the next few sections .",
    "for the interested reader , much of the foundational work on continuous time branching processes relevant for this paper can be found in @xcite .",
    "recall that the gaussian process defined in underlying the main consistency result theorem [ thm : cp - estimator - cons ] depends on @xmath48 .",
    "one consequence of this dependence is that when the parameter values @xmath99 and @xmath98 are close , the change point becomes harder to detect in the sense that larger @xmath109 is required to get good estimates .",
    "this is most easily seen in terms of the fluctations of the proportion of leaves in the graph .    .",
    "the red line represents the theoretical predictions in . ]    .",
    "the red line represents the theoretical predictions in . ]    in both figures [ fig : leaves - good ] and [ fig : leaves - bad ] , the preferential attachment process starts with @xmath247 and decreases , to @xmath248 in [ fig : leaves - good ] and @xmath249 in [ fig : leaves - bad ] .",
    "furthermore the predicted behavior ( red line ) is almost the same : the proportion of leaves is constant up to the change point @xmath250 and then increases , consistent with a _ decrease _ in the attachment parameter .    despite the sizes of the final graphs in both simulations being @xmath171 vertices , at first glance the fluctuations appear much greater in the latter case . on closer examination however ,",
    "this is simply an illusion of the axes . in essence ,",
    "when the shift in parameters is smaller , the change in the proportion of leaves pre- and post-@xmath8 is smaller compared to the natural fluctuations in the proportion of leaves which is of order @xmath251 ( theorem [ thm : leaves - fclt ] ) . therefore any difference is more difficult to detect for same @xmath109 .",
    "this is not surprising , but worth noting in practice .",
    "as described in section [ sec : disc - proof ] , the main conceptual idea is a continuous time embedding of the discrete time process .",
    "we start in section [ sec : proof - idea ] by describing this embedding and deriving simple properties .",
    "then in section [ sec : convg - degree ] we prove theorem [ thm : deg - dist ] .",
    "section [ sec : proof - tail - bd ] proves the assertion that the degree exponent does not change .",
    "section [ sec : max - degree - proof ] analyzes asymptotics for the maximal degrees .",
    "section [ sec : leafclt - proofs ] contains an in - depth analysis of the density of leaves and proves theorem [ thm : leaves - fclt ] .",
    "section [ sec : consistency ] then uses this theorem to prove the consistency of the estimator namely theorem [ thm : cp - estimator - cons ] .",
    "we start with the following definition .",
    "to ease notation , for the rest of the paper we use @xmath246 instead of @xmath252 .",
    "fix @xmath253 .",
    "we let @xmath254 be a continuous time branching process driven by the point process @xmath66 defined in . precisely :    at time @xmath255 we start with one individual called the root @xmath12 with an offspring point process with distribution @xmath256 .",
    "the times of this point process represent times of birth of new offspring of @xmath12 .",
    "every new vertex @xmath15 that is born into the system is given its own offspring point process @xmath257 , independent across vertices .",
    "label vertices using integer labels according to the order in which they enter @xmath258 so that the root is labelled as @xmath21 , the next vertex to be born labeled by @xmath259 and so on . for fixed @xmath64",
    ", we will view @xmath260 as a ( random ) labelled tree representing the genealogical relationships between all individuals in the population present at time @xmath154 .",
    "see figures [ fig : test1 ] and [ fig : test2 ] .",
    "write @xmath261 for the number of individuals in the tree by time @xmath154 .",
    "fix @xmath262 and define the stopping time @xmath263 since there are no deaths and each individual reproduces at rate at least @xmath264 , the stopping times @xmath265 a.s . for all @xmath262 .",
    "now consider the original preferential attachment model where there is no change point .",
    "using properties of the exponential distribution , the following lemma is easy to check and is just a special case of the famous athreya - karlin embedding @xcite .",
    "[ lem : embed - distr ] viewed as random rooted trees on vertex set @xmath266 $ ] one has @xmath267 .",
    "in fact the two processes of growing random trees have the same distribution namely @xmath268     [ fig : test1 ]     [ fig : test2 ]    to construct the variant @xmath30 where one has a change point , we run @xmath269 till time @xmath270 ( when the original process reaches size @xmath246 ) and then every vertex changes the way it reproduces .",
    "more precisely , after this stopping time , an individual with @xmath29 children would have reproduced at rate @xmath271 in the original model but in the change point model this vertex reproduces at rate @xmath272 and uses the parameter @xmath98 instead of @xmath99 for each subsequent offspring times .",
    "each new vertex @xmath15 produced after time @xmath270 reproduces according to an independent copy of the point process @xmath63 .",
    "call the resulting process @xmath273 and run the process till time @xmath274 when the continuous time process has @xmath109 individuals .",
    "analogous to , define the collection of stopping times @xmath275 by replacing @xmath276 with @xmath277 .",
    "the following is a simple extension of the previous lemma .",
    "[ lem : embed - distr - cp ] recall the family of random trees @xmath50 generated using the change point preferential attachment model in section [ sec : model - cp - def ] . then , @xmath278    note that the processes @xmath279 when one has a change point are * not * nested in a nice manner as growing trees for * different values * of @xmath109 .",
    "compare this with the original model ( without change point ) where we can view the entire sequence @xmath280 as an increasing family of random trees . in the above construction it will be convenient to couple the processes across different @xmath109 by using a * single * common branching process @xmath276 to generate the tree before the change point @xmath270 and then let the process evolve independently after the change point for different @xmath109 using the prescribed dynamics modulated by the attachment parameter @xmath98 .",
    "further it will be convenient to allow the process @xmath277 to continue to grow after time @xmath274 as opposed to stopping it exactly at time @xmath274 .",
    "for future reference , for each vertex @xmath15 , we will use @xmath281 for the time of birth of this vertex into the system . for fixed time @xmath154 and a vertex @xmath15 born before time @xmath154 ( namely @xmath282 )",
    ", we write @xmath283 for the number of children of this vertex by time @xmath154 .",
    "note that for all @xmath284 , the full degree of @xmath15 by time @xmath154 is @xmath285 .",
    "we will need some simple stochastic calculus calculations below to derive martingales related to processes of interest .",
    "given a process @xmath286 adapted to a filtration @xmath287 , we write @xmath288 for an adapted process @xmath289 if @xmath290 is a ( local ) martingale .",
    "similarly write @xmath291 if the process @xmath292 is a local martingale .",
    "now recall that @xmath293 is the random tree before the change point .",
    "these random trees are distributed as the original preferential attachment model without change point using attachment dynamics with parameter @xmath99 . using and recalling that @xmath294 denotes the number of vertices with degree @xmath29 results in the following .",
    "[ lem : as - pre - convg ] for each fixed @xmath27 we have @xmath295 , as @xmath10 where @xmath296 is the probability mass function in .",
    "recall that the branching process @xmath276 is driven by the offspring point process @xmath57 and @xmath297 $ ] is the number of points in @xmath67 $ ] .",
    "define the process @xmath298    [ lem : palpha - martingale ] the process @xmath299 is a martingale with respect to the natural filtration of @xmath57 .",
    "in particular @xmath300    * proof : * write @xmath287 for the natural filtration of the process .",
    "it is enough to show for all @xmath64 , @xmath301 . by construction @xmath302 further @xmath303 elementary algebra completes the proof .",
    "the final assertion regarding follows using the martingale property of @xmath304 and the initial condition @xmath305 .",
    "the starting point in the analysis of continuous time branching processes is the so called malthusian rate of growth parameter @xmath306 which solves the equation @xmath307 using lemma [ lem : palpha - martingale ] now implies @xmath308 let @xmath309 be an exponential random variable with parameter @xmath310 independent of @xmath57 and consider the integer valued random variable @xmath311 .",
    "note that is equivalent to @xmath312 . recall that @xmath34 is a random variable with the ( non - change point ) degree distribution .",
    "it is easy to check that @xmath313 . in particular for @xmath13 , @xmath314 using standard jagers - nerman stable age - distribution theory for branching processes @xcite now implies the following .    [",
    "prop : size - bp - alpha ] there exists an integrable a.s .",
    "positive random variable @xmath315 such that @xmath316 in particular @xmath317 for a finite random variable @xmath318 .",
    "we conclude this section with asymptotics for the amount of `` continuous time '' where the attachment dynamics using @xmath98 is valid , namely @xmath319 .",
    "recall the constant @xmath244 from .",
    "we will also write @xmath320 for the natural filtration of the process @xmath241 .",
    "[ lem : a - def - asymp ] let @xmath321 denote the time after the change point in the continuous time embedding . then @xmath322 as @xmath323 . here",
    "@xmath324 is a standard normal random variable .",
    "* proof : * note that @xmath273 is a markov process .",
    "further for @xmath325 conditional on @xmath326 , the rate at which a new individual is born into the system is given by @xmath327 in particular @xmath328 where @xmath329 is a sequence of _ iid _ rate one exponential random variables .",
    "using lyapunov s central limit theorem now completes the proof . using the distributional characterization in and standard concentration inequalities for sums of independent random variables",
    ", one can show the following tail bound on @xmath330 .",
    "we omit the proof .",
    "[ lem : upsion - tail ] for any @xmath331 there exists @xmath332 such that for all @xmath333 , @xmath334 in particular by borel - cantelli , @xmath335    here the bound @xmath336 was arbitrary .",
    "an upper bound of @xmath337 with any @xmath338 would result in identical result as above .",
    "we fix @xmath336 for definiteness .",
    "we end this section by defining the yule process .",
    "properties of this process will be needed in the next few sections .",
    "[ def : yule - process ] fix @xmath339 .",
    "a rate @xmath340 yule process is a pure birth process @xmath341 with @xmath342 and where the rate of birth of new individuals is proportional to size of the current population .",
    "more precisely @xmath343 where @xmath287 is the natural filtration of the process .",
    "the following is a standard property of the yule process , see e.g. ( * ? ? ?",
    "* section 2.5 ) .",
    "[ lem : yule - prop ] fix time @xmath344 and rate @xmath339 .",
    "then the random variable @xmath345 , namely the number of individuals in the population by time @xmath154 has a geometric distribution with parameter @xmath346 namely @xmath347      in this section we will prove theorem [ thm : deg - dist ] . recall the description of the limit random variable @xmath83 in section [ sec : prelim ]",
    ". it will be easier to deal with the random variable @xmath348 .",
    "then the distribution of @xmath349 can be written succinctly as :    with probability @xmath8 , @xmath350 where @xmath351 $ ] ;    with probability @xmath84 , @xmath352 where @xmath353 and @xmath354 is as defined in section [ sec : prelim ] .",
    "now recall that for any time @xmath154 and vertex @xmath15 born before time @xmath154 , @xmath283 denotes the number of children ( out - degree ) of vertex @xmath15 at time @xmath154 .",
    "for fixed @xmath355 define @xmath356 and @xmath357 in words , @xmath358 are the number of vertices that were born before the change point and have out - degree at least @xmath29 by time @xmath274 ( thus in the tree @xmath359 ) whilst @xmath360 is defined analogously but for vertices born after the change point @xmath270 .",
    "the following proposition is equivalent to theorem [ thm : deg - dist ] .",
    "[ prop : pre - post - convg ] fix @xmath355 .",
    "then we have @xmath361 as @xmath323 .",
    "the rest of this section deals with proving this proposition .",
    "we start with the easier case .",
    "we will need some more notation . for fixed @xmath363 ,",
    "define @xmath364 for the number of vertices that were born before the the change point @xmath270 with out - degree exactly @xmath365 at time @xmath270 that end up with at least @xmath29 children by time @xmath274 .",
    "note that @xmath366 namely the number of vertices with total degree @xmath367 ( thus out - degree @xmath29 ) in the tree before change point @xmath368 . recall that lemma [ lem : as - pre - convg ] , the asymptotic degree distribution of @xmath368 is @xmath369 and thus the asymptotic out - degree distribution of the tree @xmath368 is @xmath370 . using the form of @xmath371",
    ", it is thus enough to show for each fixed @xmath372 , @xmath373{\\geqslant}k - j).\\ ] ] we start with the following simple lemma .",
    "[ lem : binom - convg ] fix @xmath374 , a sequence of non - negative integer valued random variables @xmath375 and a sequence @xmath376 $ ] .",
    "conditional on @xmath377 , let @xmath378 be a binomial@xmath379 random variable .",
    "further suppose @xmath380 then @xmath381 .",
    "* proof : * we assume we work on a rich enough probability space where we can couple @xmath382 with a sequence @xmath383 where @xmath384 is binomial@xmath385 such that @xmath386 .",
    "standard exponential tail bounds for the binomial distribution coupled with borel cantelli and the hypothesis of the lemma imply that @xmath387 . since @xmath388 , again using the hypothesis of the lemma completes the proof .",
    "we now proceed with the proof .",
    "analogous to @xmath364 , for each @xmath389 define @xmath390 for the number of vertices born before the change point @xmath270 such that at @xmath270 they have out - degree exactly @xmath365 and further by time @xmath391 they have degree at least @xmath29 .",
    "then note that conditional on the information at time @xmath270 , @xmath392{\\geqslant}k - j ) ) \\ ] ] further the random variables of interest @xmath393 where @xmath330 is as in lemma [ lem : a - def - asymp ] .",
    "thus writing @xmath394 and @xmath395 and using lemma [ lem : upsion - tail ] , @xmath396 using the binomial convergence lemma [ lem : binom - convg ] and noting that by lemma [ lem : as - pre - convg ] and choice of @xmath397 , the hypothesis of this lemma are satisfied , implies that @xmath398{\\geqslant}k - j),\\ ] ] where take @xmath399 as either @xmath400 or @xmath401 . now using proves .",
    "this completes the analysis of @xmath362 .",
    "we start by setting up some notation .",
    "fix @xmath355 and define the function @xmath403{\\geqslant}k ) , \\qquad u{\\geqslant}0.\\ ] ] here @xmath63 is the offspring point process with attachment parameter @xmath98 . then writing out the form of the distribution of @xmath404 more explicitly ( and using the definition of @xmath244 from ) , to prove the second assertion of",
    ", we want to show @xmath405 for @xmath389 , define @xmath406 for the number of individuals born in the interval @xmath407 $ ] such that by time @xmath408 , these vertices have at least @xmath29 children",
    ". then note that @xmath409 . mimicking the proof of @xmath410 ,",
    "it is enough to show that @xmath411 where @xmath399 is either the sequence @xmath412 or @xmath413 . to ease notation",
    "we will just work with the sequence @xmath414 .",
    "the entire proof goes through by replacing @xmath244 in the steps below by @xmath399 .",
    "we start with a few preliminary results .",
    "the first result describes strong concentration results of the growth of the number of individuals in @xmath277 in the interval @xmath407 $ ] .",
    "define the process @xmath415    [ prop : szn - conc ] there exists a constant @xmath416 such that for all @xmath109 , @xmath417    * proof : * the plan is to use doob s @xmath418-maximal inequality for continuous time martingales ( see e.g. ( * ? ? ?",
    "* chapter 1.9 ) ) .",
    "for this we will need to derive martingales related to the process @xmath419 . throughout",
    "we will write @xmath420 for the filtration @xmath421 .",
    "recall from the rate description in that @xmath419 is a pure birth process such for any @xmath64 , conditional on @xmath422 , @xmath423 at rate @xmath424 . arguing as in the proof of lemma [ lem : palpha - martingale ] it is easy to check that the process @xmath425 is a mean zero martingale .",
    "this in particular gives that @xmath426 by doob s @xmath418-maximal inequality applied to the process @xmath427 we have for any @xmath306 , @xmath428 if we can show there exists a constant @xmath429 such that @xmath430 , using @xmath431 and algebraic manipulation of completes the proof .",
    "so let us now derive this bound on @xmath432 .    first squaring the expression in , expanding and using gives for @xmath64 , @xmath433 thus we need to understand the evolution of the process @xmath434 . again using the rate description of @xmath435 , this process undergoes a change @xmath436 at rate @xmath437 . using",
    "this one may check that the following process on @xmath76 $ ] @xmath438 is also a martingale . in particular since first moments are conserved , @xmath439 using shows that there exists a constant @xmath440 such that @xmath441 expanding the first bracket in , using and shows that @xmath430 for some constant @xmath440 .",
    "this completes the proof .",
    "now divide the interval @xmath442 $ ] into @xmath443 intervals of length @xmath336 : @xmath444 , \\left[\\tau_{\\gamma n}+\\frac{1}{n^{1/3 } } , \\tau_{\\gamma n}+\\frac{2}{n^{1/3}}\\right ] , \\ldots , \\left[\\tau_{\\gamma n}+\\frac{an^{1/3}-1}{n^{1/3}},\\tau_{\\gamma n}+\\frac{an^{1/3}}{n^{1/3}}\\right]\\right\\}},\\ ] ] of length @xmath336 . to ease notation ,",
    "write the above collection as @xmath445 .",
    "further let @xmath446 with @xmath447 so that @xmath448 $ ] .",
    "now write @xmath449 for the collection of vertices that were born in interval @xmath450 ( i.e. the collection of vertices @xmath15 with birth times @xmath451 ) and write @xmath452 for the number of individuals born in this interval",
    ". then the following is an easy corollary of proposition [ prop : szn - conc ] .",
    "[ cor : szni - good - conc ] we have @xmath453 as @xmath10 .    for future reference",
    "write @xmath454 for the event above namely @xmath455    now for each interval @xmath450 , we will partition the vertices born in this interval into two classes :    the collection of good vertices @xmath456 : this consists of all @xmath457 such that they produce * no * children by the end of the interval i.e. vertices @xmath15 with @xmath458 $ ] such that by time @xmath459 , vertex @xmath15 still has no children .",
    "note that since the intervals are of time length @xmath336 , one expects a large proportion of vertices born in the interval @xmath450 to be good .",
    "write @xmath460 for the number of good vertices in @xmath450 .",
    "the collection of bad vertices @xmath461 , the collection of vertices born in @xmath450 which produce at least one child by time @xmath462 . write @xmath463 for the number of such bad vertices in @xmath450 . write @xmath464 for the total number of bad vertices .    fix a constant @xmath440 and define the event @xmath465 .",
    "these events depend on @xmath440 but we suppress this in the notation .    [",
    "prop : bad - set - bound ] we can choose constant @xmath416 large such that @xmath466 as @xmath10 . in particular for the total number of bad vertices we have @xmath467 .",
    "* proof : * fix an interval @xmath450 .",
    "note that every bad vertex is one of two types :    a vertex that is a direct child of a vertex born before this time interval .",
    "write @xmath468 for these _ direct _ bad vertices and write @xmath469 for the number of such vertices .",
    "further write @xmath470 for the total number of descendants of direct bad vertices born in the interval @xmath450 ( including the direct bad vertices ) .",
    "a vertex that is bad and is a child of a vertex born in @xmath450 .",
    "thus the parent of this vertex is necessarily bad .",
    "thus in particular we have that @xmath471 .",
    "now note that direct bad vertices in @xmath468 are created via the following steps :    a descendant ( maybe good or bad ) of a vertex born before @xmath450 is born into the system . the number of such individuals @xmath472 , the total number of individuals born in the interval @xmath450 . using corollary [ cor : szni - good - conc ]",
    ", there exists a constant @xmath440 such that whp as @xmath10 , _ for all _ the intervals @xmath473 , @xmath474 .",
    "conditional on * all these * descendants of vertices born before @xmath450 , such a descendant has to give birth to one individual in the interval @xmath475 $ ] . recall that the time to give birth to the first child is an exponential random variable @xmath476 with rate @xmath477 .",
    "thus the probability of birthing this first child is bounded by @xmath478 further by construction none of these vertices can have a parent child relationship and thus their offspring lineages evolve independently .",
    "in particular , conditional on all descendants of vertices born before time interval @xmath450 , @xmath479 here @xmath480 denotes stochastic domination . thus using corollary",
    "[ cor : szni - good - conc ] , and standard tail bounds for the binomial distribution implies that there exists a constant @xmath416 such that @xmath481 as @xmath10 .",
    "let us now complete the analysis of @xmath470 .",
    "let us start with the evolution of descendants of a single bad _",
    "direct _ vertex after it gives birth to its child .",
    "this process then starts reproducing at rate @xmath482 .",
    "further whenever a new vertex is added to the system , the rate of production increases by at most @xmath483 . thus writing @xmath484 and @xmath485 ,",
    "the number of descendants of such a bad vertex can be bounded by a rate @xmath340 yule process ( see definition [ def : yule - process ] ) that starts with @xmath486 individuals at time zero .",
    "write @xmath487 for such a process .",
    "thus the number of descendants of such a bad vertex in the time interval @xmath488 $ ] can be stochastically bounded by @xmath489 .",
    "in particular , conditional on @xmath490 , @xmath491 here @xmath492 are an _",
    "iid _ collection of yule processes with distribution @xmath493 . using the explicit distribution of the yule process at a fixed time ( lemma [ lem : yule - prop ] ) , it is easy to check that given constant @xmath494 we can find @xmath495 such that @xmath496 using this exponential bound with completes the proof .    we now proceed with the proof of . for @xmath473 ,",
    "let @xmath497 be the number of * good * vertices in @xmath449 which have at least @xmath29 children by time @xmath244 . then note that conditional on @xmath498 , @xmath499 define the events @xmath500    [ prop : good - vertex - close ] there exists a constant @xmath416 such that @xmath501 as @xmath10 .",
    "* proof : * note that @xmath502 . combining corollary [ cor : szni - good - conc ] with proposition [ prop : bad - set - bound ] implies that @xmath503 now using the distributional identity and standard tail bounds for the binomial distribution completes the proof .",
    "we are finally in a position to complete the proof of .",
    "first note that @xmath504 using proposition [ prop : bad - set - bound ] @xmath505 . using proposition",
    "[ prop : good - vertex - close ] @xmath506 this completes the proof of and thus the assertion of the convergence of the degree distribution of the model to the asserted limit in theorem [ thm : deg - dist ] .",
    "we conclude this section with a related result regarding the evolution of the degree distribution .",
    "this follows by directly modifying the proof above .",
    "recall the definitions of @xmath507 and @xmath508 from section [ sec : res - stat ] . for future use",
    "define for each @xmath27 and @xmath110 @xmath509 namely the number of vertices with degree at least @xmath29 respectively at discrete time @xmath18 and at time @xmath154 when we rescale time by @xmath109 .",
    ". note that since we divide by @xmath109 and not @xmath113 in this expression we have @xmath511 .",
    "now note that by lemma [ lem : as - pre - convg ] we have for each fixed @xmath512 , @xmath513 where @xmath514 as in is the limiting degree distribution with no change point .",
    "for @xmath515 , analogous to the definition of @xmath244 in define @xmath516 analogous to the definition of @xmath83 in section [ sec : prelim ] , define @xmath517 by replacing @xmath244 by @xmath518 throughout the construction .",
    "thus @xmath519 .",
    "let @xmath520 let @xmath521 . for @xmath110 , let @xmath522 .",
    "[ prop : dmvtheta - t - sup ] for all @xmath27 we have @xmath523 as @xmath10 .    *",
    "proof : * for fixed @xmath524 , define the stopping time @xmath525 namely the first time that the continuous time embedding reaches size @xmath526 .",
    "note that at this time , the corresponding tree has distribution @xmath527 .",
    "write @xmath528 for the amount of ( continuous ) time it takes for the process to reach this size after the change point . then note that by proposition [ prop : szn - conc ] we can choose an appropriate constant @xmath416 such that @xmath529 as @xmath10 , where @xmath518 is as defined in . repeating the above proof for the convergence of degree distribution and replacing @xmath244 by @xmath518 throughout the argument shows that for each @xmath524 @xmath530 .",
    "combining this with implies that we have pointwise convergence @xmath531 .",
    "now note that for each fixed @xmath109 , the function @xmath532 is non - decreasing on @xmath134 $ ] while the limit function is also monotonically increasing and continuous ( and thus uniformly continuous ) .",
    "given @xmath533 , fix @xmath534 such that for any @xmath535 $ ] with @xmath536 , @xmath537 divide @xmath134 $ ] into intervals @xmath538\\right\\}}$ ] for @xmath539 of length @xmath540 . via the pointwise convergence above , get @xmath541 large such that for all @xmath542 @xmath543 write @xmath544 for the event in the above equation .",
    "then on this event , by the choice of @xmath540 , for all @xmath545 we have @xmath546 . using monotonicity , for any @xmath547 $ ] , @xmath548 . by the triangle inequality on @xmath549 , for all @xmath550 $ ] and @xmath542 , @xmath551",
    "since @xmath552 is independent of @xmath154 , this completes the proof .",
    "the aim of this section is to prove the asserted tail bound , namely .",
    "first note that the lower tail bound is obvious since with probability @xmath8 , @xmath83 stochastically dominates @xmath34 and by , @xmath34 has the asserted tail behavior .",
    "the main crux is then proving the upper bound , namely @xmath553 recall definition [ def : yule - process ] of the yule process and in particular lemma [ lem : yule - prop ] on finite time marginal distribution of the yule process .",
    "now note that in the description of the limit random variable @xmath83 , with probability @xmath84 , @xmath554 { \\leqslant}_{{{\\sf st } } } n_\\beta[0,a]$ ] where as before @xmath555 represents stochastic domination .",
    "now define @xmath556 let @xmath557 be a rate @xmath340 yule process started with @xmath486 individuals at time zero . comparing the rate of production of new individuals in the point process @xmath63 with @xmath557 , we get that @xmath558 { \\leqslant}_{{{\\sf st } } } y_\\nu^k(a ) $ ] . by lemma [ lem : yule - prop ]",
    ", @xmath559 is the sum of @xmath486 independent geometric random variables .",
    "using the fact that a geometric random variable has finite moment generating function in a neighborhood of zero and an elementary chernoff bound implies that there exist constants @xmath560 such that for all @xmath561 , we have an exponential tail bound , @xmath562 > x ) { \\leqslant}\\operatorname{\\mathds{p}}(y_{\\nu}^k(a ) > x){\\leqslant}\\kappa^\\prime \\exp(-\\kappa x),\\ ] ] thus when with probability @xmath84 @xmath563 $ ] then the corresponding random variable has exponential tail . thus the main contribution to",
    "the tail arises when with probability @xmath8 , @xmath564 $ ] . arguing as above ( and assuming @xmath565 ) , conditional on @xmath566 , we have @xmath567 { \\leqslant}_{{{\\sf st } } } \\sum_{j=1}^k y_\\nu^{(j),k}(a),\\ ] ] where @xmath568 are a collection of independent rate @xmath340",
    "yule processes each started at time zero with @xmath486 individuals and independent of @xmath34 .",
    "the following elementary lemma completes the proof .",
    "[ lem : sum - exp - heavy - tail ] let @xmath569 be non - negative integer valued random variable with @xmath570 for all @xmath561 , for two constants @xmath571 .",
    "let @xmath572 be a sequence of independent and identically distributed positive integer valued random variables , independent of @xmath573 .",
    "consider the random variable @xmath574 .",
    "if @xmath575 has finite moment generating function in a neighborhood of zero then there exists a constant @xmath576 such that for all @xmath577 , @xmath578    * proof : * for the rest of the proof , write @xmath579 . then note that @xmath580 where the second equation follows using the fact that @xmath581 for all @xmath545 and the tail bound for @xmath573 from the hypothesis of the lemma . to complete the proof , note that standard large deviation bounds imply (",
    "since @xmath582 has a finite moment generating function about zero ) imply that there exist constants @xmath583 such for all large @xmath584 @xmath585 this completes the proof .",
    "the only item left to complete the proof of theorem [ thm : deg - dist ] is to show that the change point * does * change the degree distribution from the original ( no change point ) model . in section [ sec : leafclt - proofs ]",
    "we will carry out a detailed analysis of the density of leaves which in particular will show that the asymptotic density of leaves @xmath586 .      the aim of this section is to prove theorem [ thm : max - deg ] . for simplicity and to ease notation , we will deal with @xmath32 namely just the maximal degree .",
    "the general case follows in an identical fashion .",
    "first note that using , writing @xmath587 for the maximal degree of a vertex in @xmath368 namely in the tree just before the change point implies that @xmath588 converges weakly to a strictly positive random variable . since @xmath589",
    ", this implies that given any @xmath145 , there exists a constant @xmath590 such that @xmath591 thus to complete the proof of theorem [ thm : max - deg ] we need to show , given any @xmath145 , @xmath592 such that @xmath593 for any vertex @xmath594 $ ] time point @xmath595 $ ] , write @xmath596 for the degree of vertex @xmath15 in @xmath17 with the obvious convention that @xmath597 if @xmath598 . then note that @xmath599 where @xmath600}{\\deg(v , n ) } , \\qquad m_{\\operatorname{post}}(n):=\\max_{v\\in [ n\\gamma+1,n]}{\\deg(v , n)}.\\ ] ] let us first analyze the maximal degree of vertices that appeared after the change point .",
    "recall the constant @xmath244 from and @xmath601 from .",
    "[ lem : post - cp - max ] we have @xmath602 as @xmath10 .    * proof : * we will assume @xmath565 below .",
    "else replace @xmath98 with one in the rest of the argument below .",
    "for simplicity write @xmath603 . recall that in the continuous time embedding",
    ", @xmath281 represents the time of birth of vertex @xmath15 and further for @xmath604 $ ] , each such vertex is equipped with a offspring point process @xmath605 . as in section",
    "[ sec : proof - tail - bd ] , @xmath606 where @xmath607 is a rate @xmath340 yule process started with @xmath486 individuals at time zero .",
    "now note that via our continuous time embedding , @xmath608 } ( 1+{\\mathcal{p}}_\\beta^v(0,\\tau_n - t_v)),\\ ] ] since by time @xmath609 , a vertex born after the change time has been alive for @xmath610 units of time .",
    "now @xmath611}(1 + { \\mathcal{p}}_\\beta^v(0,a+1 ) ) >",
    "k_n ) + \\operatorname{\\mathds{p}}(\\upsilon_n >",
    "a+1 ) . \\end{aligned}\\ ] ] using lemma [ lem : a - def - asymp ] we have @xmath612 .",
    "let @xmath613\\right\\}}$ ] be a family of independent rate @xmath340 yule processes started with @xmath486 individuals at time zero . using lemma [ lem : yule - prop ] a simple union bound and the choice of @xmath614 implies @xmath615 } y_\\beta^v(a+1 ) > k_n)\\to 0 $ ] .",
    "thus the above lemma implies that the maximal degree amongst vertices that arrive after the change point is @xmath616 . to complete the proof of",
    ", it is enough to show that holds with @xmath617 replaced by @xmath618 .",
    "thus fix @xmath619 . using proposition [ prop : size - bp - alpha ] fix @xmath620 such that @xmath621 now consider the following process @xmath622 :    run the process @xmath276 till time @xmath623 .    at this time : all vertices in @xmath624 switch to the dynamics with parameter @xmath98 namely each vertex now reproduces at rate proportional to its out - degree + @xmath625 .",
    "run this process for an additional @xmath626 units of time where @xmath244 is as in .    abusing notation ,",
    "let @xmath627 denote the maximal degree by time @xmath628 of all vertices born _ before _ time @xmath629 .",
    "we can obviously couple the original process @xmath277 and @xmath622 such that on the set @xmath630 we have @xmath631",
    ".    further note that for any fixed @xmath486 we have @xmath632 first choosing @xmath633 appropriately as in and using lemma [ lem : a - def - asymp ] we get that for any fixed @xmath486 , @xmath634 the following lemma completes the proof of .",
    "[ lem : mpre - star - bound ] fix @xmath635 . given any @xmath145",
    ", we can choose @xmath636 such that @xmath637    * proof : * first note that till time @xmath638 , the process @xmath639 is a the continuous time version of a ( non - change point ) preferential attachment model with attachment parameter @xmath99 .",
    "this continuous time embedding was used to derive asymptotics for the maximal degree in @xcite . in particular the bounds derived in these papers",
    "imply the following for a fixed @xmath633 : write @xmath640 for the maximal degree exactly at time @xmath638 .",
    "then there exists @xmath641 such that @xmath642 now note that on the event @xmath643 at time @xmath644 , the degree of every fixed vertex in the system is stochastically dominated by a rate @xmath340 yule process started with @xmath645 vertices at time zero and run for time @xmath626 where @xmath340 is as in .",
    "write @xmath646 for such a random variable and note that by the description of the dynamics of the yule process and lemma [ lem : yule - prop ] , we have that @xmath647 where @xmath648 are iid geometric random variables with @xmath649 . further note that using proposition [ prop : size - bp - alpha ] on the size of the branching process",
    ", we can choose @xmath440 such that @xmath650 thus on the `` good '' event @xmath651 we have that @xmath652 where @xmath653 is an iid sequence with distribution .",
    "note that @xmath654 .",
    "let @xmath655 .",
    "then standard large deviations for the geometric distribution implies that there exists a constant @xmath656 such that for all @xmath657 @xmath658 thus by the union bound , @xmath659 as @xmath10 .",
    "thus we have , @xmath660 using , and .",
    "this completes the proof of the lemma and thus the analysis of the maximal degree asymptotics .",
    "the aim of this section is to prove theorem [ thm : leaves - fclt ] . in the next section",
    "we will use the proportion of leaves ( degree one vertices ) to construct consistent estimators of the change point @xmath8 .",
    "we start in section [ sec : leaf - expec ] by deriving strong error bounds between the expected proportion of leaves and the asserted limits in .",
    "then in section [ sec : leaf - clt - proof ] we complete the proof of the functional central limit theorem .",
    "we start with some preliminary notation . for the rest of the proof , to ease notation",
    ", we will write @xmath661 for the number of leaves in @xmath662 and let @xmath663 .",
    "recall the asserted limiting proportion @xmath664 from . for",
    "each @xmath665 define the collection of real numbers @xmath666 @xmath667      the following proposition is the main result of this section .",
    "[ prop : explicit - form - p0 ] there exists a constant @xmath416 independent of @xmath109 such that the expectations satisfy @xmath668    note that by proposition [ prop : dmvtheta - t - sup ] , we know there exists a function @xmath669 such that @xmath670 for @xmath116 . by the bounded convergence theorem , @xmath671 .",
    "thus the above proposition implies that @xmath672 .",
    "in particular it shows that the degree distribution owing to the change point is * different * from the degree distribution without change point .",
    "this is the final nail in proving theorem [ thm : deg - dist ] .",
    "a similar result was shown in the context of no change point in ( * ? ? ? * section 8.6 ) and @xcite ( not just for leaves but for all fixed @xmath27 ) .",
    "our proof uses slightly different ideas starting from the same point as in @xcite .",
    "while we do not consider higher degree vertices , as in @xcite , the result above can be used as a building block to show identical error bounds for expectations of the number of higher degree vertices about limit constants .    *",
    "proof : * to ease notation write @xmath673 .",
    "the main crux of the proof is studying a recursion relation for @xmath674 in terms of @xmath675",
    ". we will give a careful analysis of the time period before the change point and then describe how the same ideas give the result for after the change point .",
    "for each @xmath676 write @xmath677 for the event that vertex @xmath678 connects to a leaf vertex in @xmath17 . then note that conditioning on @xmath17 , when @xmath679 we have @xmath680 when @xmath681 we have the same recursion as above but with @xmath99 replaced by @xmath98 .",
    "taking full expectations and simplifying gives the following recursion : @xmath682 where @xmath683 are as defined in .",
    "* before the change point : * repeatedly using this recursion and using the boundary condition @xmath684 gives for @xmath685 , @xmath686 now fix @xmath687 large enough such that the following three conditions hold :    for all @xmath688 @xmath689 here @xmath8 is the euler  mascheroni constant .",
    "see @xcite .    for all @xmath688 , @xmath690 .",
    "we may choose a constant @xmath416 such that for all @xmath27 , @xmath691 further there exists a constant @xmath692 such that for all @xmath693 , @xmath694 and @xmath695    to ease notation , for the rest of the proof let @xmath696 . using the elementary inequality @xmath697 for @xmath698 and the choice of @xmath699 above , the following inequalities with a constant @xmath700",
    "are readily verified :    for all @xmath701 , @xmath702    for all @xmath701 , @xmath703    for all @xmath701 , @xmath704    now note that by the `` lindeberg '' trick , for any @xmath705 and two collections of non - negative numbers @xmath706 and @xmath707 we have @xmath708 using this with @xmath709 and @xmath710 and using , and gives the following lemma .",
    "[ lem : prd - sm - delta ] fix @xmath699 as above . writing @xmath711 there exists a constant @xmath416 such that for all @xmath712 , @xmath713    now using the form of the expectation @xmath675 in , the error bound in the above lemma and the integral comparison @xmath714 shows that there exists a constant @xmath440 such that for @xmath715 @xmath716 this is the assertion for the expected number of leaves before the change point .",
    "* after the change point : * we now describe the evolution of @xmath675 for @xmath717 .",
    "we only give the basic idea as the details are the same as before the change point .",
    "first note that by the above analysis , there exists a constant @xmath440 such that @xmath718 .",
    "now the evolution of the process after @xmath246 is as in with @xmath99 replaced by @xmath98 .",
    "thus starting at @xmath719 and using the argument above we get @xmath720 simplifying notation and writing @xmath721 where @xmath722 and repeating the arguments above it is easy to check that there exists a constant @xmath440 independent of @xmath109 such that @xmath723 where @xmath724 is as in .",
    "this completes the proof .",
    "a central limit theorem for the number of leaves @xmath725 ( in fact all degree counts @xmath726 ) at time @xmath109 in the setting of no change point was established in @xcite .",
    "we will extend this to a functional central limit theorem in the change point setting .",
    "first recall the function @xmath727 from .",
    "define the stochastic process @xmath728 recall the process @xmath133 in and the relationship between @xmath130 and @xmath1 . using proposition [ prop : explicit - form - p0 ] and the continuous mapping theorem ,",
    "it is enough to show the following result .",
    "[ prop : mn - to - m ] we have @xmath729 on @xmath730 $ ] as @xmath10 .",
    "* proof : * the main idea is to study martingales associated with the @xmath731 and then use the martingale functional central limit theorem .",
    "there are an enormous number of variants of such functional limit theorems under a multitude of conditions .",
    "we quote the specific form relevant to this setting .",
    "recall the function @xmath732 and the corresponding diffusion @xmath133 defined in .",
    "[ thm : mart - fclt][@xcite ] for each @xmath657 , let @xmath733 be a mean zero martingale with finite second moments adapted to a filtration @xmath734 . write @xmath735 for the associated martingale difference sequence namely @xmath736 with @xmath737",
    ". assume the following two hypothesis :    for each @xmath110 @xmath738 ^ 2\\right|{\\mathcal{f}}_n(m-1)\\right ) { \\stackrel{\\mathrm{p}}{\\longrightarrow}}\\phi(t),\\qquad \\mbox{as } n\\to\\infty.\\ ] ]    for each fixed @xmath145 @xmath739 ^ 2 { \\mathds{1}}{\\left\\{|x_n(m)| > { \\varepsilon}\\right\\}}\\right|{\\mathcal{f}}_{n}(m-1)\\right){\\stackrel{\\mathrm{p}}{\\longrightarrow}}0.\\ ] ]    then defining the process @xmath740 , one has @xmath741 in @xmath730 $ ] .    for our example ( following @xcite ) define the process @xmath742 here @xmath743 is as in . using the recursion results in the following lemma .",
    "[ lem : nnstar - mart ] the process @xmath744 is a martingale with respect to the filtration generated by @xmath745 .",
    "now define the corresponding martingale differences @xmath746 .",
    "define @xmath747 .",
    "then simple algebra and implies that for @xmath715 @xmath748,\\ ] ] and @xmath749 for @xmath681 we have identical formulae as and but now @xmath99 is replaced by @xmath98 . for the rest of the argument we will replace the denominator for the second term @xmath750 by @xmath750 .",
    "it is easy to check that the error is negligible and will ease presentation .",
    "now use proposition [ prop : dmvtheta - t - sup ] which allows us to uniformly approximate @xmath751 by @xmath752 .",
    "further the asymptotics of @xmath753 derived in the previous section implies that for @xmath715 , @xmath754 while for @xmath719 , @xmath755 where @xmath756 as as defined in . taking conditional expectations in , using and using the above approximations results in @xmath757 ^ 2|{\\mathcal{t}}_{m-1})\\sim \\begin{cases }          m^{2\\delta_\\alpha}\\left[\\delta_{\\alpha}p_{m / n}^{{\\scriptscriptstyle}(\\infty)}(1-\\delta_{\\alpha}p_{m / n}^{{\\scriptscriptstyle}(\\infty)})\\right ] & \\text {",
    "if } m{\\leqslant}n\\gamma , \\\\          & \\\\      ( n\\gamma)^{2\\delta_\\alpha}\\left(\\frac{m}{n}\\right)^{2\\delta_{\\beta } } \\left[\\delta_{\\beta}p_{m / n}^{{\\scriptscriptstyle}(\\infty)}(1-\\delta_{\\beta}p_{m / n}^{{\\scriptscriptstyle}(\\infty)})\\right ] & \\text { if } m{\\geqslant}n\\gamma      \\end{cases}\\ ] ] now consider the martingale @xmath758 we will apply theorem [ thm : mart - fclt ] to this martingale .",
    "let @xmath759 denote the corresponding martingale differences .",
    "first fix @xmath122 and recall the definition of the cumulative conditional variance @xmath760 till time @xmath154 in . using the first expression in we get @xmath761\\\\      & \\to \\int_0^t s^{2\\delta_{\\alpha}}\\left[\\delta_{\\alpha}p_{s}^{{\\scriptscriptstyle}(\\infty)}(1-\\delta_{\\alpha}p_{s}^{{\\scriptscriptstyle}(\\infty)})\\right]ds = \\phi(t),\\end{aligned}\\ ] ] as @xmath10 . thus is satisfied for @xmath122 . a similar calculation now incorporating the second expression in implies that is satisfied for all @xmath550 $ ] with @xmath762 as in in .",
    "now let us check the second condition namely .",
    "note that for @xmath715 , @xmath763 implies that @xmath764 . for large @xmath109",
    "this is impossible for all @xmath715 .",
    "a similar calculation for @xmath719 completes the proof of .",
    "using theorem [ thm : mart - fclt ] we get that @xmath765 in @xmath730 $ ] .",
    "using the asymptotics for @xmath753 derived in section [ sec : leaf - expec ] in now completes the proof of proposition [ prop : mn - to - m ] and thus theorem [ thm : leaves - fclt ] .",
    "the aim of this section is to prove theorem [ thm : cp - estimator - cons ] .",
    "fix a truncation level @xmath145 from zero as in the theorem . recall the time averaged proportion of leaves before and after each time @xmath154 namely and .",
    "also recall the expression for the limiting proportion of leaves from . for any fixed interval @xmath766\\subseteq [ 0,1]$ ] , define @xmath767 $ ] by @xmath768:= \\frac{1}{t - s}\\int_s^t p_u^{{\\scriptscriptstyle}(\\infty ) } du.\\ ] ] the interpretation is as follows : the above gives the expected proportion of leaves in the large network limit if one were to sample a time point @xmath769 $ ] uniformly at random .",
    "now define the two functions @xmath770 and @xmath771 via :    * case 1 : * for @xmath772 @xmath773\\ ] ]    * case 2 : * for @xmath774 @xmath775 ) , \\qquad { h_t}:= h([t,1]).\\ ] ]    define analogously to the function @xmath776.\\ ] ] routine algebra shows that @xmath777\\big| & \\mbox { for } { \\varepsilon}{\\leqslant}t{\\leqslant}\\gamma.\\\\              & \\\\              ( 1-{\\varepsilon})\\big|h[{\\varepsilon},t]-h[{\\varepsilon},1]\\big| & \\mbox { for } t > \\gamma .",
    "\\end{array } \\right.\\ ] ] using the form of the limit proportion @xmath117 from the following result is easy to check .",
    "[ lem : d - inf - properties ] fix @xmath778 and assume @xmath779",
    ". then @xmath780 is a continuous function on @xmath146 $ ] such that @xmath780 is constant on the interval @xmath781 $ ] and then is strictly monotonically decreasing on the interval @xmath782 $ ] with @xmath783 as @xmath784 .",
    "further the function has a strictly negative right derivative at @xmath8 namely @xmath785    now theorem [ thm : leaves - fclt ] immediately results in the following result .",
    "[ lem : dinf - dn ] fix @xmath145",
    ". then @xmath786}|d_n(t ) - d(t)| = o_p\\left(\\frac{1}{\\sqrt{n}}\\right).\\ ] ]    now combining lemmas [ lem : d - inf - properties ] and [ lem : dinf - dn ] completes the proof .",
    "sb has been partially supported by nsf - dms grants 1105581 and 1310002 and ses grant 1357622 .",
    "abn has been partially supported by nsf - dms grant 1310002 and nih r01 mh101819 - 01 .",
    "jj has been partially supported by nsf - dms grant 1310002 .",
    "we thank edward carlstein for several illuminating conversations on change point detection .",
    "we thank frances tong for extensive help with regards to visualization of various plots in the paper ."
  ],
  "abstract_text": [
    "<S> inspired by empirical data on real world complex networks , the last few years have seen an explosion in proposed generative models to understand and explain observed properties of real world networks , including power law degree distribution and `` small world '' distance scaling . in this context , a natural question is the phenomenon of _ change point _ , understanding how abrupt changes in parameters driving the network model change structural properties of the network . </S>",
    "<S> we study this phenomenon in one popular class of dynamically evolving networks : preferential attachment models . </S>",
    "<S> we derive asymptotic properties of various functionals of the network including the degree distribution as well as maximal degree asymptotics , in essence showing that the change point does effect the degree distribution but does * not * change the degree exponent . </S>",
    "<S> this provides further evidence for long range dependence and sensitive dependence of the evolution of the process on the initial evolution of the process in such self - reinforced systems . </S>",
    "<S> we then propose an estimator for the change point and prove consistency properties of this estimator . </S>",
    "<S> the methodology developed highlights the effect of the non - ergodic nature of the evolution of the network on classical change point estimators . </S>"
  ]
}