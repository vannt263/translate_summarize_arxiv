{
  "article_text": [
    "recent observations of non - thermal radiation from shell - type supernova remnants ( snrs ) are showing that effective particle acceleration takes place in these astrophysical objects ( see @xcite for a recent review ) .",
    "in particular the detection of spatially resolved non - thermal x - rays from thin regions close to the forward shock in several snrs has showed the first clear evidence for strong magnetic field amplification as could be expected if the shock is efficiently accelerating cosmic rays .",
    "the recent detection of tev gamma rays ( @xcite ) is likely to provide further information on the magnetic field amplification by adding to multifrequency observations and by possibly allowing the measurement of the shape of the tev gamma ray spectrum .    in the scenario with large magnetic field ,",
    "low fluxes of gamma radiation through inverse compton scattering ( ics ) of electrons are expected , thereby leaving a hadronic origin of the gamma ray emission as a more likely possibility .",
    "this latter conclusion is however of more limited strength and requires further confirmation through a continuous effort to detect snrs in gamma rays , not only in the tev region but also in the gev energy range , as should become possible after the upcoming launch of the glast gamma ray telescope .",
    "x - rays observed in the 1 - 10 kev energy range from snrs are generated by synchrotron emission of relativistic electrons and the thickness of the brightness profiles allows one to estimate the total field in the shock vicinity to be of order 100 - 500 @xmath0 in basically all cases in which measurements exist ( @xcite ) .",
    "this appears to be the strongest evidence for efficient cosmic ray acceleration at snr shocks , where here we use the word _",
    "efficient _ to indicate that an appreciable fraction of the kinetic pressure at the shock is transformed into accelerated particles , which in turn change the dynamics of the shock . in this regime the standard _",
    "test particle theory _ ( tpt ) fails and a non - linear theory is required ( see @xcite for a review ) .",
    "from the phenomenological point of view the introduction of the non - linear effects is crucial .",
    "the reaction of the accelerated particles onto the shock structure has been calculated within different approaches , both semi  analytical ( see @xcite for a recent review ) and numerical ( e.g. @xcite and references therein ) .",
    "semi - analytical kinetic approaches provide a detailed description of the process of particle acceleration at cosmic ray modified shocks , including particle spectra , modified shock dynamics and thermodynamics , and have recently been generalized to include magnetic field amplification ( @xcite ) .",
    "the main limitation of these approaches is the fact that they all solve the stationary problem of acceleration .",
    "this problem is simply ill defined in the case of acceleration of protons ( or nuclei ) in sources such as supernova remnants : in fact in these cases there is no appreciable energy loss process , and stationarity can not be reached .",
    "this is in principle true even in test particle approaches , but there the problem is limited to momenta close to the maximum momentum , while the shape of the spectrum at lower momenta is rather well defined and stationary . in the non - linear regime ,",
    "the entire particle spectrum changes as a consequence of the time dependence of the maximum momentum , therefore the assumption of stationarity is in principle not well justified , though it is tacitly assumed that the situation to describe is one of quasi - stationarity .",
    "several approaches to time - dependent shock acceleration at cosmic ray modified shocks have been put forward ( @xcite ) , but all of them are based on numerical approaches ( e.g. finite difference solution of the equations ) . in particular , @xcite found that quasi - stationary solutions are rather good approximations to the full time - dependent solutions . despite this , a generalization of the semi - analytical approaches to include time dependence would be highly desirable , and would probably help to shed some light on the problem of the appearance of multiple solutions , as discussed below .",
    "the first kinetic model that provided a semi - analytical ( stationary ) solution of the problem was developed by @xcite and @xcite for strongly modified shocks with a given , spatially constant , diffusion coefficient .",
    "a simple , approximate kinetic approach was later proposed by @xcite .",
    "this approach provides an accurate description of the shock modification and its effects on particle acceleration provided the diffusion coefficient has a sufficiently strong dependence on momentum @xmath1 ( the underlying assumption is somewhat similar to the starting assumption adopted by @xcite ) .",
    "it also allows to obtain the solution to the problem in a very short computational time , which is particularly important when the particle acceleration process must be described in the context of complex and time consuming hydrodynamical simulations ( for instance in the case of snrs ) .",
    "@xcite showed , among other things , that the solutions obtained with malkov s method and those of blasi s method are in very good agreement for bohm diffusion coefficient , while the agreement becomes gradually worse for kraichnan ( @xmath2 ) and kolmogorov ( @xmath3 ) diffusion coefficients , as expected .",
    "even in these two cases , however , the differences were not very large and the model of @xcite still provided an acceptable description of the main physical aspects of the problem .    more recently a solution of the system of equations describing the transport of accelerated particles and the dynamics of the shock was found by @xcite , where the diffusion coefficient could formally be taken as an arbitrary function of both momentum and spatial coordinate ( although solutions were actually computed for a few specific choices of @xmath4 ) .",
    "contrary to the simple approach of @xcite where a physically reasonable ansatz was used to simplify the problem , this approach is mathematically rigorous but more expensive from the computational point of view .    in a second paper by @xcite the self - generation of the waves and the determination of the resulting diffusion coefficient ,",
    "though in the context of quasi - linear theory , were introduced . the method for taking into account magnetic field amplification during the acceleration process at a modified shock , as assessed in this work , also allowed for the determination of the maximum momentum in these complex circumstances ( @xcite ) .    since the two methods introduced above aim at describing the same problem but using a different set of approximations and , very important , with a quite different computational cost , we wish to assess here the advantages and disadvantages of using one or the other .",
    "while doing so , we also discuss an important feature which is found in both approaches , and more generally in semi - analytical kinetic approaches ( as well as in stationary two - fluid models @xcite ) , namely the appearance of multiple solutions .",
    "we conclude that for most applications related to the description of the phenomenology of particle acceleration in supernova remnants the model of @xcite can be succesfully applied despite its simplifications , provided the diffusion coefficient scales rapidly enough with momentum .",
    "this is certainly the case for bohm diffusion .",
    "moreover we complete this simple model with recipes that allow us to determine the level of magnetic field amplification and the maximum energy of the accelerated particles .",
    "the present paper is structured as follows : in  [ sec : twoapproaches ] we briefly introduce the two kinetic approaches of @xcite , model a hereafter , and @xcite , model b. in the subsections we discuss in detail the results of the two theoretical approaches . in  [ sec : pmax ] we describe the introduction in the first approach of a recipe for the acceleration time which allows us to estimate the maximum momentum of the accelerated particles .",
    "we conclude in  [ sec : concl ] .",
    "in this section we briefly discuss two kinetic approaches , the one of @xcite ( model a ) that is expected to work for diffusion coefficients @xmath5 that change rapidly enough with the particle momentum , and the one proposed by @xcite ( model b ) and valid for any choice of @xmath6 .",
    "the main point of the section is to illustrate the results obtained with the two approaches , identifying the advantages and possible shortcomings of the first , which is being implemented in some computationally heavy hydrodynamical codes , in which the formal solution of model b would be hardly possible to introduce due to the much longer computational time required .",
    "the basic equations are the transport equation : @xmath7 -   u   \\frac{\\partial f ( x , p)}{\\partial x } +   \\frac{1}{3 } \\left(\\frac{d u}{d x}\\right ) ~p~\\frac{\\partial f(x , p)}{\\partial p } + q(x ,",
    "p ) = 0 , \\label{eq : trans}\\ ] ] and the conservation equation for the total momentum : @xmath8 here @xmath9 is the particle distribution function in the shock frame , @xmath10 is the velocity of the background fluid , which equals @xmath11 downstream and changes continuously upstream , from @xmath12 immediately upstream of the subshock to @xmath13 at upstream infinity .",
    "the quantity @xmath14 is the normalized velocity , bound to equal unity at @xmath15 . in eq .",
    "[ eq : normalized1 ] , @xmath16 is the cosmic ray pressure at the position @xmath17 , normalized to the kinetic pressure @xmath18 at upstream infinity .",
    "it is customary to introduce the compression factor @xmath19 at the subshock and the total compression factor @xmath20 .",
    "assuming homogenisation of the cosmic ray plasma in the downstream section ( @xmath21 , a consequence of the assumption of stationarity ) one easily obtains ( @xcite ) that the distribution function of the particles at the shock location is @xmath22 where we introduced the function @xmath23 , with @xmath24 this result is very general and is not related to the assumptions of the model of @xcite .",
    "here we assumed , as usual , that the injection is a delta function in space ( at the shock ) and in momentum ( at the injection momentum @xmath25 ) in the form @xmath26 , with @xmath27 the gas density immediately upstream ( @xmath28 ) and @xmath29 the fraction of the particles crossing the shock which are going to take part in the acceleration process .",
    "the compression factors @xmath30 and @xmath31 , if the gas in the upstream frame evolves adiabatically , are related through the following expression : @xmath32^{\\frac{1}{\\gamma_g+1}}. \\label{eq : rsub_rtot}\\ ] ]    .5 cm this model was proposed by @xcite and put in a form to include the reacceleration of seed particles by @xcite .",
    "it is characterized by a simple implementation that makes it fast in terms of numerical computation while keeping all the main physical ingredients of the problem .",
    "for these reasons it has been implemented in hydrodynamical codes in order to calculate the instantaneous spectrum of accelerated particles in an expanding supernova shell ( @xcite ) .",
    "the essence of the approach is based on the observation that the function @xmath9 in eq .",
    "[ eq : up ] is expected to suffer an exponential suppression at a distance @xmath33 such that @xmath34 .",
    "the spatial position where this suppression is found in general depends on momentum if the diffusion coefficient depends on momentum .",
    "these spatial locations for different values of @xmath1 are well defined if @xmath5 is a strong function of momentum , as was first pointed out by @xcite , and become more ill defined for @xmath5 weakly dependent on @xmath1 . as a first approximation we may assume that the distribution function is @xmath35 at @xmath36 gives @xmath37 . the distance @xmath33 has the meaning of the typical distance to which particles with momentum @xmath1 can diffuse away from the shock in the upstream fluid , and",
    "the fluid velocity at that point is @xmath38 .",
    "it follows that eq .",
    "[ eq : normalized1 ] can be transformed into an equation which depends only on the particle momentum @xmath1 : @xmath39 where @xmath40 and @xmath41 is the velocity of particles with momentum @xmath1 .",
    "differentiating eq .",
    "[ eq : normalized2 ] with respect to momentum we finally have : @xmath42 = \\frac{4\\pi}{3 \\rho_0 u_0 ^ 2 } p^4 v(p ) f_0(p ) .",
    "\\label{eq : differential}\\ ] ] for @xmath43 we have @xmath44 , while for @xmath45 one has @xmath46 .",
    "the procedure to calculate the solution is therefore straightforward : for a given guess of @xmath30 ( and therefore of @xmath31 through eq .",
    "[ eq : rsub_rtot ] ) we can solve the differential equation eq .",
    "[ eq : differential ] coupled with the expression for @xmath47 as a function of @xmath48 ( eq . [ eq : inje ] ) in an iterative way . in general we end up with @xmath49 , which implies that the given value of @xmath30 is not a solution of our problem .",
    "the solution corresponds to that value of @xmath30 ( and @xmath31 ) for which @xmath50 .",
    "this value also identifies completely the function @xmath48 and the distribution function at the shock @xmath47 , which is the sought after result .",
    "it is important to notice that this procedure does not lead only to the determination of @xmath47 but also to the values of the thermodynamical quantities at the shock , such as the temperature of the gas upstream and downstream .",
    "what model a can not provide is the spatial dependence of the quantities in the precursor , although we provide below a physical ansatz that may indirectly make this piece of information available .",
    "we later check the results by comparing them with the outcome of model b.    in both approaches that we describe here we adopt the injection recipe known as _ thermal leakage _",
    "( @xcite ) which connects the value of @xmath29 to that of @xmath30 in a unique way through the relation : @xmath51 here @xmath52 is a parameter that identifies the injection momentum as a multiple of the momentum of the thermal particles in the downstream section ( @xmath53 ) . the latter is an output of the non - linear calculation , since we solve exactly the modified rankine - hugoniot relations together with the cosmic rays transport equation . for the numerical calculations that follow we typically use values of @xmath52 between @xmath54 and @xmath55 , which correspond to fractions of order @xmath56 of the particles crossing the shock to be injected in the accelerator .",
    ".5 cm    a formal solution of the transport equation and the conservation equations for an arbitrary choice of the diffusion coefficient in both its dependence on momentum and spatial coordinate was found by @xcite .",
    "@xcite and @xcite showed that an excellent approximation to the solution @xmath9 has the form @xmath57 , \\label{eq : solution}\\ ] ] where @xmath58 is the local slope of @xmath47 in momentum space .",
    "in fact the factor @xmath59 in the argument of the exponential was introduced by @xcite in order to satisfy exactly the boundary condition at the shock , even for weakly modified shocks .    in terms of the distribution function",
    "[ eq : solution ] ) , we can also write the normalized pressure in accelerated particles as : @xmath60 , \\label{eq : normalized3}\\ ] ] where for simplicity we introduced @xmath61 .    by differentiating eq .",
    "[ eq : normalized3 ] with respect to @xmath17 we obtain @xmath62 where @xmath63 } { \\int_{p_{inj}}^{p_{max } }   dp~p^3 v(p ) f_0(p ) \\exp\\left [ -\\int_x^0 dx '    \\frac{u(x')}{x_p(x',p)}\\right ] } ,   \\label{eq : lambda}\\ ] ] and @xmath64 is expressed as a function of @xmath65 through eq .",
    "[ eq : normalized1 ] .    finally , after integration by parts of eq .  [ eq : up ] , one is able to express @xmath66 in terms of an integral involving @xmath64 alone : @xmath67\\ , \\label{eq : up2}\\ ] ] which allows one to easily calculate @xmath47 through eq .",
    "[ eq : inje ] .",
    "[ eq : normalized1 ] and [ eq : differ ] can be solved by iteration in the following way : for a fixed value of the compression factor at the subshock , @xmath30 , the value of the dimensionless velocity at the shock is calculated as @xmath68 . the corresponding pressure in the form of accelerated particles",
    "is given by eq .",
    "[ eq : normalized1 ] as @xmath69 .",
    "this is used as a boundary condition for eq .",
    "[ eq : differ ] , where the functions @xmath64 and @xmath70 ( and therefore @xmath47 ) on the right hand side at the @xmath71 step of iteration are taken as the functions at the step @xmath72 . in this way the solution of eq .",
    "[ eq : normalized1 ] at the step @xmath73 is simply @xmath74,\\ ] ] with the correct limits when @xmath75 and @xmath15 . at each step of iteration",
    "the functions @xmath64 , @xmath47 , @xmath70 are recalculated ( through eq .",
    "[ eq : normalized1 ] , eqs .",
    "[ eq : up2 ] and [ eq : inje ] , and eq .  [ eq : lambda ] , respectively ) , until convergence is reached . the solution of this set of equations , however , is also a solution of our physical problem only if the pressure in the form of accelerated particles as given by eq .",
    "[ eq : normalized1 ] coincides with that calculated by using the final @xmath47 in eq .",
    "[ eq : normalized2 ] .",
    "this occurs for a value of @xmath30 , which fully determines the solution of our problem for an arbitrary diffusion coefficient as a function of location and momentum .",
    "all approaches to particle acceleration at modified shocks predict the formation of a precursor in the upstream region , resulting in a gradient of the velocity profile of the fluid .",
    "since qualitatively the spectrum of the accelerated particles is still determined by an effective compression factor felt by the particles of given momentum , and the velocity in the precursor increases with the distance from the shock , it is easy to infer that the spectrum of the accelerated particles is not expected to be a power law and more precisely that it should be concave ( steeper at low energies and flatter at high energies ) .",
    "here we discuss the detailed shape of the spectrum at the shock as obtained through the two kinetic approaches described above . in fig .",
    "[ fig : spectrum ] ( left panel ) we plot the spectra as a function of the momentum of particles for model b ( solid lines ) and for model a ( dashed lines ) .",
    "the curves are obtained for @xmath76 , @xmath77 , @xmath78 and for the values of the mach number at upstream infinity @xmath79 ( curves labeled as 1 , 2 and 3 , respectively ) .",
    "bohm diffusion is assumed .",
    "the agreement between the two sets of curves is excellent for relatively low mach numbers ( @xmath80 ) and remains good even up to much larger mach numbers , and in fact for all values we have tried .",
    "the largest discrepancies between the two methods are at the level of @xmath81 .",
    "the reason for such discrepancies is to be found in the assumption that @xmath82 is required to equal unity in the approach of model a.    the velocity profile of the fluid in the precursor is plotted in fig .",
    "[ fig : spectrum ] ( right panel ) for the two models ( again solid and dashed lines respectively ) .    on the x - axis",
    "we plot the distance @xmath17 from the shock in the upstream region in units of @xmath83 , which is defined as @xmath84 some comments are required on the calculation of @xmath64 for model a. as discussed in the previous section , this model does not keep any information about the spatial dependence of the quantities in the precursor , although such information is somehow contained in the relation between a momentum @xmath1 and the mean diffusion length of particles with such momentum , @xmath85 .",
    "the dashed lines in fig .",
    "[ fig : spectrum ] ( right panel ) are obtained in the following way : for a given location @xmath17 upstream , the equation @xmath86 is inverted and a corresponding value @xmath1 of the minimum momentum of particles that may have diffused to the point @xmath17 is obtained . at this point",
    "the velocity @xmath64 ( in units of @xmath13 ) is by definition @xmath66 for the value of @xmath1 corresponding to @xmath17 . by definition the fluid velocity in the simple model",
    "is bound to be unity at @xmath87 because no particles are supposed to be able to reach farther regions .",
    "in the exact solution there is a spread in the distances that can be diffusively reached at given momentum and the transition to @xmath88 is smoother .",
    "this difference in the velocity profile affects mainly the results for the spectrum at @xmath89 , but since these particles carry an appreciable amount of energy in the case of modified shocks , the whole spectral shape is somewhat affected ( at the level of at most @xmath81 in the strongly modified cases ) .",
    "as discussed above , the ingredient of model a that makes it much faster in terms of computational time consists in the assumption that particles with given momentum all travel to some given maximum distance from the shock in the upstream region .",
    "this physical ansatz was first put forward by @xcite .",
    "this assumption has the precious implication that the calculation of the spectrum of accelerated particles , of the velocity profile in the precursor , and of all thermodynamical properties of the background plasma , can be carried out without knowing _ a priori _ the diffusion coefficient as a function of momentum , which in general is an input to the problem and is very poorly known .",
    "the solid curves plotted in figs .",
    "[ fig : spectrum ] are obtained for a bohm diffusion coefficient in model b , and as stressed above the agreement between the two approaches is very good . as discussed by @xcite",
    "the goodness of the result becomes gradually worse for diffusion coefficients in the form of kraichnan ( @xmath90 ) and kolmogorov ( @xmath91 ) that show a weaker dependence on momentum . on the other hand ,",
    "x - ray observations of snrs shocks seem to hint to bohm - like diffusion coefficients ( see @xcite for recent results ) .",
    "the price to pay for the short computational time is that one can keep track of the spatial dependence of the different quantities involved only through the approximate relation @xmath92 . in model b ,",
    "which is more challenging computationally , the spatial dependence is fully accounted for and any form of the diffusion coefficient can be adopted .",
    "this appears to be especially important since the diffusion coefficient as calculated by @xcite in the case of classical streaming instability leading to strong magnetic field amplification has a flat dependence on momentum in the energy region close to the maximum momentum ( although the overall shape and normalization of the diffusion coefficient are close to bohm - like ) .",
    "the stratification of the cosmic ray pressure in the upstream region , together with the escape of particles with momentum @xmath93 from upstream infinity ( equivalent to having a radiative shock ) , make the fluid more compressible and therefore lead to an increase of the total compression factor @xmath31 between upstream infinity and downstream . in this section",
    "we investigate the behavior of @xmath31 as a function of some parameters of the problem , most notably the parameter @xmath52 which defines the injection momentum and the mach number @xmath94 .",
    "the fraction of particles that are injected and take part in the acceleration process increases when @xmath52 decreases and as a consequence the compression factor also increases . in fig .",
    "[ fig : rtotxi ] ( left panel ) we plot the total compression factor as obtained in model a. the same quantity for the model b is plotted in the right panel of fig .",
    "[ fig : rtotxi ] .",
    "both plots are obtained for @xmath95 , @xmath77 and @xmath93 between @xmath96 and @xmath97 ( different curves are labeled by the value of @xmath98 ) .",
    "the most striking feature in the behaviour of @xmath31 versus @xmath52 is the rather sharp transition from strongly modified shocks ( low values of @xmath52 , @xmath99 ) to weakly modified shocks ( large values of @xmath52 , @xmath100 ) .",
    "the even more striking point is that , for @xmath101 , in the very thin transition region in parameter space three solutions may appear .",
    "multiple solutions were initially found in two - fluid models @xcite and later found in the models of @xcite . after introducing the thermal leakage model for injection the appearance of multiple solutions",
    "was found to be strikingly reduced and limited to very narrow regions in parameter space ( @xcite ) .",
    "the multiple solutions are here shown to exist even in model b , though , again , in very narrow regions of parameter space .",
    "in fact this region is so small that the phenomenon was previously missed , since for standard values of the parameters ( in particular for @xmath78 which is most often used ) we never find more than one solution .",
    "although we can not prove it in a formal way at the present stage , it is likely that the appearance of the multiple solutions in very narrow regions of parameter space is accompanied by the existence of some type of instability that allows the system to chose among the three : from fig .",
    "[ fig : rtotxi ] one can see that the three solutions are found only in the region of values of @xmath52 for which the behaviour of the system suffers a transition from a strongly modified shock ( @xmath102 ) to a weakly modified shock ( @xmath103 ) . in the transition region ,",
    "a tiny change in the value of @xmath52 around @xmath104 leads to either one or the other regime .",
    "it is therefore likely that at least one of the solutions in this transition region may be unstable .",
    "of the three solutions that we find , one is certainly non physical ( the intermediate solution in fig .",
    "[ fig : rtotxi ] ) since it predicts that @xmath31 increases with increasing @xmath52 .    the question of the stability of the other two solutions is still open .",
    "investigations on the stability of these shocks were carried out by @xcite .",
    "the behaviour of @xmath31 as a function of the mach number is more subtle in that one can change the mach number by fixing the temperature and varying the shock velocity or by fixing the shock velocity and changing the temperature of the background gas , although in terms of astrophysical applications the first case is probably the most relevant or at least the most frequent .",
    "below we consider the two situations separately .    increasing the mach number ( for a fixed temperature of the background gas ) leads to an increasing modification of the shock and therefore to an increase in the value of @xmath31 . for @xmath105",
    "k , @xmath106 and @xmath107 , the parameters used in the lower curves of fig . [ fig : tcost ] , this trend continues up to @xmath108 . for larger values of the mach number , there is no energy left to convert into accelerated particles and the shock returns to be a _ test particle _ accelerator . in the thin transition region between the strongly modified regime and the regime of weakly modified shocks again",
    "three solutions appear . if @xmath78 is used instead of @xmath107 the transition moves to much larger mach numbers , of no astrophysical interest .",
    "these characteristics are shown in fig .",
    "[ fig : tcost ] for the model a ( left panel ) and b ( right panel ) .",
    "the two sets of curves are in very good agreement , although for the same parameters model b shows the appearance of the multiple solutions at slightly larger mach numbers than the simple model a. the maximum value of the compression factor is also slightly larger in the model of @xcite than it is in the simple model .",
    "the upper curve in both plots refers to @xmath78 and shows that no multiple solutions are found in this case .",
    "when the increase of the mach number is achieved by fixing the shock velocity and changing the temperature , the behaviour of the total compression factor as a function of @xmath94 is as shown in fig .",
    "[ fig : ucost ] . for @xmath107 ,",
    "oddly enough , the multiple solutions appear for large values of @xmath94 and remain three irrespective of how large @xmath94 becomes . at @xmath109",
    "( for the values of the parameters adopted here ) there is a bifurcation : one branch that smoothly connects to the weakly modified solution for low values of @xmath94 remains and tends asymptotically to @xmath110 , while two other branches appear , one with compression factor that keeps increasing and the other with compression factor that tends to @xmath111 .",
    "even a qualitative comparison of figs .",
    "[ fig : tcost ] and [ fig : ucost ] reveals that the two cases are intrinsically different . for @xmath78 ( upper curve )",
    "no multiple solutions are found , and the shock always shows an appreciable level of modification .    the presence or absence of a transition to a weakly modified shock at sufficiently large mach number can be understood in a semi - quantitative way by using the following argument .",
    "let us assume that the shock is weakly modified , namely that the pressure in the form of accelerated particles is much smaller than @xmath18 , so that the spectrum can be approximated as a power law with slope @xmath112 ( @xmath113 ) . in this case",
    "the total pressure of the accelerated particles at the shock location is @xmath114 p_{inj } \\ln\\left[\\frac{p_{max}}{m_p c}\\right].\\ ] ] the term @xmath115 is roughly the total number of particles at the shock location , which can be written as @xmath116 .",
    "it follows that @xmath117 .",
    "\\label{eq : limit}\\ ] ] if one neglects the logarithmic term , the pressure in accelerated particles is easily seen to scale with the injection momentum only . in the context of the thermal leakage approach and in the limit of strong shock , we can write @xmath118 , where @xmath119 .",
    "it follows that @xmath120 , so that @xmath121 .",
    "the linear scaling of the cosmic ray pressure with @xmath12 should be compared with the ram pressure scaling , which is @xmath122 .",
    "this comparison immediately suggests that for sufficiently large values of @xmath12 there is always enough kinetic pressure to fuel cosmic ray acceleration without appreciable modification of the shock .",
    "notice that when the mach number is increased by keeping the fluid velocity constant , this argument does not apply and indeed in that case the transition is not seen , while the three solutions persist at sufficiently high mach numbers .",
    "if the mach number is increased by increasing the shock velocity ( keeping the temperature constant ) then the transition is observed when the fluid velocity is larger ( in fact about one order of magnitude larger ) than a critial value @xmath123 , which can be estimated from eq .",
    "[ eq : limit ] : @xmath124.\\ ] ] it is clear that the larger the values of @xmath52 the smaller the critical velocity for which the shock may become weakly modified .",
    "the same threshold effect was previously found by @xcite .",
    "some more discussion is required about the role of stationarity in the appearance of multiple solutions .",
    "the phenomenon of multiple solutions has been reported in the context of both two fluid models @xcite and kinetic approaches , but in both cases stationarity was assumed .",
    "multiple solutions do not seem to appear in time - dependent numerical calculations . from the physical point of view a stationary solution of the diffusion - convection equation when particle escape or energy losses are absent can not exist . even in the context of the test - particle approach quasi - stationarity",
    "can be recovered only at low momenta , far from @xmath93 , while the temporal evolution reflects into an increase of @xmath93 . in the non - linear regime",
    "an increase of @xmath93 leads to a modification of the precursor and therefore of the entire spectrum .",
    "hence the assumption of stationarity is harder to justify in the context of a non - linear theory of particle acceleration at shocks .",
    "this internal inconsistency of both two - fluid models and semi - analytical kinetic models may be one of the reasons why multiple solutions do not appear in time - dependent approaches .",
    "one of the most important predictions of the non - linear theory of diffusive particle acceleration at shocks is that for strongly modified shocks an appreciable fraction of energy is in the form of particles at the maximum momentum . on the other hand , these particles are also the only ones that are allowed to leave the system from upstream infinity . in other words ,",
    "the return probability to the shock from upstream is unity for all particles but for those with @xmath89 .",
    "the energy carried away from the shock by the highest energy particles makes the shock radiative and the increased compressibility of the background gas enhances the modification of the shock structure .",
    "the equation for the conservation of the flux of energy provides us with precious information , namely the flux of energy in the form of accelerated particles that is advected towards downstream infinity and the one that escapes towards upstream infinity .",
    "the conservation equation between downstream and upstream infinity can be written in the following form :    @xmath125    where @xmath126 is the flux of particles escaping at the maximum momentum from the upstream section of the fluid ( berezhko & ellison , 1999 ) .",
    "this term is peculiar of modified shocks , being completely negligible when acceleration takes place in the test particle regime , as we confirm in the calculations below .    in eq .",
    "[ eq : energy ] we can divide all terms by @xmath127 and calculate the normalized escaping flux :    @xmath128    from momentum conservation at the subshock we also have : @xmath129 so that the escaping flux only depends upon the _ environment _ parameters ( for instance the mach number at upstream infinity ) and the compression parameter @xmath30 which is part of the solution . the adiabatic index appropriate for cosmic rays , @xmath130 ,",
    "is here calculated self - consistently as : @xmath131 where @xmath132 is the energy density in the form of accelerated particles and @xmath133 is the kinetic energy of a particle with momentum @xmath1 . it can be easily seen that @xmath134 when the energy budget is dominated by the particles with @xmath135 ( namely for strongly modified shocks ) and @xmath136 for weakly modified shocks . in eq .",
    "[ eq : energy_norm ] the term @xmath137 is clearly the fraction of flux which is advected downstream with the fluid .    the escaping flux , the advected flux and the total flux in the form of accelerated particles are plotted in fig .",
    "[ fig : fluxes ] for @xmath138 , @xmath139 and @xmath78 .",
    "all fluxes are normalized to @xmath127 .",
    "clearly the difference between the total flux in accelerated particles and unity gives the rate of conversion of the total energy into heating of the background gas . for large mach numbers this difference vanishes , which implies that the gas is not appreciably heated at the shock , one of the most impressive predictions of the non - linear theory of particle acceleration .",
    "it is worth discussing in some details the physical meaning of the advected and escaping fluxes . as we already pointed out earlier , the escaping flux is all in the form of a narrow distribution in momentum around @xmath135 .",
    "one should keep in mind that in situations of astrophysical interest , such as in the case of supernova remnants ( snrs ) , after the beginning of the sedov phase the maximum momentum decreases with time .",
    "a distant observer is likely to observe ( from a single snr ) an overlap of peaked functions with @xmath140 . in specific situations",
    "( e.g. @xcite ) it has been shown that this superposition leads to power law time - integrated spectra .",
    "since the particles of @xmath135 carry an appreciable fraction of energy ( in fig .",
    "[ fig : fluxes ] one can see that @xmath141 for large mach numbers ) , this spectrum should roughly coincide with the _ injection _ spectrum emitted by the snr , despite the fact that the spectrum at the shock has a shape of the type illustrated in fig .",
    "[ fig : spectrum ] ( at a given time ) .",
    "one should keep this argument in mind when arguing about the effects induced by concavity in the source spectra on the spectrum of diffuse cosmic rays observed at the earth .",
    "the spectrum of particles advected downstream , roughly speaking is @xmath142 , therefore the flux of energy carried by these particles is @xmath143 .",
    "since for modified shocks @xmath144 , the actual advected flux is not very large .",
    "we stress that this is the flux which is actually _ useful _ from the phenomenological point of view in terms of conversion of energy into gamma rays and other types of radiation within the source . on the other hand",
    "the particles that escape from upstream may interact with a thick target in the upstream region and produce a detectable signal there ( @xcite ) . from fig .",
    "[ fig : fluxes ] one can see that the advected flux takes less than @xmath145 of the total energy influx for strongly modified shocks .",
    "actually such flux is larger for shocks which are less modified , which in fig .",
    "[ fig : fluxes ] correspond to lower mach numbers , but even in this case it remains smaller than @xmath146 in units of @xmath127 .",
    "the particles which are advected downstream remain behind the shock and may eventually leave the remnant only at later times , suffering adiabatic energy losses due to the expansion of the supernova shell . their final spectrum , as could be observed by a distant observer , is a complex convolution of the temporal evolution of the shell , the changing maximum momentum , and the different levels of shock modification at different times .",
    "for low values of the mach number the shock modification predicted by kinetic models decreases , and as a consequence the concavity typical of the modified spectra is reduced , until the test particle solution is approached .",
    "once the slope of the spectrum at @xmath135 drops below @xmath147 the energy flux that escapes towards upstream infinity gets suppressed , as shown in fig .",
    "[ fig : fluxes ] .",
    "the physical origin of the escaping flux is again rather puzzling and requires some comments : from the mathematical point of view the requirement of having an escaping flux at upstream infinity derives from imposing energy conservation . from the physical point of view",
    "it is not obvious that the conditions for such escape exist .",
    "for instance , in the case of supernova explosion , one may envision escape of particles during the sedov phase , but not during the free expansion phase .",
    "in fact in the latter phase , the maximum momentum increases with time . nevertheless , a time - independent approach such as the stationary kinetic models discussed here , would predict a flux escape even during the free expansion phase , in order to conserve energy .",
    "although this problem is usually not discussed in the literature , we think that this may again call for the need to develop time - dependent non - linear kinetic models . in such approaches",
    "particle escape from upstream infinity should be invoked only when there are the physical conditions for it to occur .      in the previous section",
    "we have amply discussed that the non - linear theory of particle acceleration tends to convert large fractions of the flux traversing a shock into accelerated particles .",
    "one of the effects that in astrophysical situations are likely to reduce such an efficiency is the so - called turbulent heating .",
    "this generic expression is used to refer to any process that may determine non - adiabatic gas heating in the precursor .",
    "the two best known examples of this type of processes are alfvn heating ( @xcite ) and acoustic instability ( @xcite ) .",
    "both effects are however very hard to implement in a quantitative calculation : in the case of alfvn heating , the mechanism was originally introduced as a way to avoid the turbulent magnetic field to grow to non - linear levels , while it is usually used even in those cases in which @xmath148 .",
    "acoustic instability develops in the pressure gradient induced by cosmic rays in the precursor and results in the development of a train of shock waves that heat the background gas ( @xcite ) .",
    "the analysis of the instability is carried out in the linear regime , therefore it is not easy to describe quantitatively the heating effect . in both cases",
    "the net effect is the non - adiabatic heating of the gas in the precursor , which results in the weakening of the precursor itself and in the reduction of the acceleration effciency compared with the case in which the turbulent heating is not taken into account .    in order to simply illustrate the effect and compare the findings of model a and b in describing the fluxes of advected and escaping accelerated particles in the case of turbulent heating",
    ", we adopt the simple recipe provided in @xcite for alfvn heating .",
    "the recipe consists in modifying the relation between the gas pressure upstream of the subshock at the location @xmath17 , @xmath149 , and the gas pressure at upstream infinity , in order to take into account the amount of non adiabatic heating .",
    "the proposed expression is @xmath150\\right\\},\\ ] ] where @xmath151 is the alfvenic mach number at upstream infinity .",
    "one can easily check that the non - adiabatic heating vanishes for @xmath152 . with this simple recipe , eq .",
    "[ eq : normalized1 ] is modified in the following way : @xmath153\\right\\}. \\label{eq : pressmodified}\\ ] ] if one keeps in mind that this modification also changes the relation between @xmath30 and @xmath31 , it is easy to realize that the computational procedures of the two kinetic models are left otherwise unchanged and we are now able to determine the effect of turbulent heating , at least in the context of this simple approach .",
    "the best way to illustrate the effect of turbulent heating is by plotting the same fluxes as in fig .",
    "[ fig : fluxes ] but including now the turbulent heating .",
    "the results are plotted in fig .",
    "[ fig : hfluxes ] , where the lines are obtained with model a and the symbols represent the preditions of model b. aside from the very good agreement between the two methods , it is worth stressing that the turbulent heating leads to less modified shocks , and therefore to a smaller flux towards upstream infinity .",
    "the total flux ( advected plus escaping ) in the form of accelerated particles is also substantially reduced , so that appreciable heating can occur at the subshock .",
    "the maximum momentum that particles accelerated at modified shocks can achieve has been calculated by @xcite , for arbitrary level of modification and for arbitrary choice of the diffusion coefficient . here",
    "we summarize the calculations of the acceleration time and illustrate a recipe that allows us to include this calculation in model a. we compare the results to those obtained with the formal approach of model b. the acceleration time up to a momentum @xmath1 is given by @xmath154_{s=0 } =   \\frac{3 r_{tot}}{u_0 ^ 2}\\ \\int_{p_{inj}}^p \\frac{dp'}{p ' } \\left\\ {    \\frac{r_{tot } d_2(p')}{r_{tot}u_p(p')-1 } + \\frac{u_0 \\lambda(p ' ) } { r_{tot } u_p(p ' ) -1 } \\right\\ } , \\label{eq : tacc}\\ ] ] where @xmath155 is the diffusion coefficient in the downstream plasma and @xmath156 in the limit of test particle acceleration , this acceleration time reduces to the well known expression ( @xcite ) : @xmath157 .",
    "\\label{eq : lagage}\\ ] ] we recall that in the model of @xcite the information on the spatial distributions in the precuror is kept only through the relation @xmath158 . this recipe has also been used to couple @xmath17 to @xmath1 in the integral for @xmath159 .",
    "the maximum momentum is assumed here to be determined by the equality between the acceleration time and the age of the accelerator .",
    "clearly other recipes can be easily implemented as well .",
    "below we consider two cases : 1 ) a background magnetic field @xmath160 ; 2 ) the field is amplified by streaming instability to the saturation value @xmath161 ( @xcite ) .    in both cases",
    "the diffusion coefficient is assumed to be bohm - like .",
    "the magnetic field downstream , needed to calculate @xmath155 , remains @xmath162 in case 1 ) , while in case 2 ) the two components of the field perpendicular to the shock normal are compressed by @xmath30 whereas the parallel component is left unaltered .",
    "our results for the maximum momentum as a function of the mach number are plotted in fig .",
    "[ fig : pmax ] , where we assumed that the diffusion coefficient is spatially constant in the precursor .",
    "we also adopted @xmath163 , @xmath78 and @xmath164 , while the age of the accelerator is fixed at @xmath165 years .",
    "the curves in fig .",
    "[ fig : pmax ] refer to model a , while the symbols illustrate the results of @xcite for model b. the lower curve ( and symbols ) refers to the case @xmath160 , while the upper curve ( and symbols ) refers to the case of magnetic field amplified by streaming instability .",
    "once again , the agreement between the two kinetic approaches is very good , once model a is completed with a recipe that allows us to recover the spatial information in the precursor .    as already noticed by @xcite , the main factor in enhancing the maximum momentum of the accelerated particles",
    "is the magnetic field amplification . on the other hand ,",
    "increasing the @xmath93 also induces a larger shock modification ( the same effect occurs when the mach number increases ) .",
    "larger shock modifications lead to a slight reduction of the maximum momentum .",
    "the reason is simple to understand : as an order of magnitude estimate , the acceleration time is inversely proportional to the square of a mean fluid velocity , as averaged over the precursor .",
    "for strongly modified shocks the fluid upstream slows down appreciably , thereby increasing the acceleration time . for our benchmark values of the parameters , typical of supernova remnants , we obtain maximum momenta between @xmath166 and @xmath167 , comparable with the energy where the knee is observed in the cosmic ray spectrum .",
    "the recent growth of observational evidence of efficient particle acceleration , at least in the case of supernova remnants , has posed a serious challenge to describe the chain of physical processes that are all taking place at the same time and in a strongly correlated manner : particle acceleration is likely to excite streaming instability leading to magnetic field amplification upstream .",
    "this field is then advected downstream and leads to effective synchrotron emission of electrons in narrow filaments which are observed in x - rays .",
    "the amplified magnetic field makes it possible to reach maximum momenta of accelerated protons which are comparable with the knee in the cosmic ray spectrum , but it also leads to , and requires , efficient particle acceleration , which in turn modifies the shock structure .",
    "the description of this complex chain of non - linear phenomena ideally requires the particle acceleration process to be treated at the same time of and coupled to a hydrodynamic ( or even mhd ) code for the evolution of the remnant , thereby leading to the need for a fast , efficient and accurate code for the description of non - linear particle acceleration . in many previous papers",
    "the simple approach of @xcite was adopted .",
    "that approach , though qualitatively appropriate , forced the spectrum of accelerated particles to be a broken power law with given points where the slopes changed , an assumption that can only be considered as a _ working hypothesis_.    the approach of @xcite , discussed here as model a , is based on a physical ansatz on the spatial distribution of particles in the precursor .",
    "it allows one to obtain the spectrum of accelerated particles and all thermodynamical quantities of the fluid in a short computational time . for this reason it has recently been implemented in the hydrodynamical code of @xcite .",
    "model b , also discussed here , leads to a formal solution of the problem of particle acceleration , that we have shown to work well for a number of different assumptions on the spatial and momentum dependence of the diffusion coefficient .",
    "however its computational time is too long to allow one to use it in more complex calculations .    in this paper",
    "we discussed the main results obtained by using the two kinetic approaches , with two goals in mind : 1 ) show that model a provides sufficiently accurate results to allow its use in more complex calculations ; 2 ) investigate one aspect of kinetic approaches ( and in fact of all stationary approaches ) that is still poorly understood , namely the appearance of multiple solutions .    in order to assess the goodness of model a we compared its results with the fomal solution of @xcite ( model b )",
    "this was possible after completing model a with a recipe to infer the spatial information on particle distribution in the precursor , as discussed in ",
    "[ sec : spectra ] .",
    "the differences between the results of the two models are typically smaller than 20% for all quantities which have been calculated ( spectra , velocity profile in the precursor , compression factors ) .",
    "the recipe mentioned above also allowed us to apply to model a the calculation of the acceleration time as presented by @xcite and therefore to infer the maximum energy of the accelerated particles .",
    "also in this respect , as discussed in ",
    "[ sec : pmax ] , model a returns results in very good agreement with the formal solution ( model b ) .",
    "multiple solutions were first found in the context of stationary two fluid models @xcite and later in the kinetic approach of @xcite .",
    "@xcite showed that treating injection as a thermal leakage , multiple solutions persisted only in a very narrow range of parameters .",
    "while confirming this finding here for model a , we found that also the formal solution of model b leads to multiple solutions , in about the same regions of parameters as for model a. since the two methods are based on quite different criteria for the solution of the equations , this is a strong hint to the fact that the multiple solutions are an intrinsic property of the system and not an artifact of the iteration procedure used to solve the equations .",
    "a detailed discussion of the appearance of multiple solutions has been presented in  [ sec : multiple ] .",
    "however a physical understanding of the multiple solutions is still missing .",
    "it is intriguing that they are found in time - independent approaches , where stationarity is assumed , while they are not found in time - dependent approaches .",
    "one should keep in mind that a stationary solution of the equations for particle acceleration at a shock , in the absence of losses and escape does not exist , and that the assumption of stationarity is therefore rather artificial .    on the other hand ,",
    "time - dependent approaches are usually based on the solution of the coupled transport equation and fluid equations in such a way that the solution at a given time @xmath168 is advanced , following a predefined integration scheme , to a time @xmath169 . in such approaches",
    "we can not envision a procedure that would lead to the appearance of multiple solutions .",
    "what probably could happen is that there may be a strong dependence on initial conditions . to our knowledge",
    "there has been no investigation of such effects",
    ". moreover , as pointed out above , even if multiple solutions do exist one or more of them are likely to be unstable .",
    "the requirement of stationarity implies that a flux of energy must escape from upstream infinity . such a flux",
    "is actually predicted on physical grounds in some circumstances , such as the slowing down of the fluid motion in the sedov phase of a snr evolution , or because of the fact that during such phase the magnetic field amplification is expected to decrease with time , thereby reducing @xmath93 . in this way particles accelerated to higher maximum momentum at previous times",
    "can no longer be confined in the accelerator and escape .",
    "but the stationary non - linear calculations of particle acceleration at modified shocks also predict escape in situations where it is not immediate to foresee it on physical grounds . again , since the role of this escaping flux has profound implications on the acceleration process it would be appropriate to investigate it using time - dependent techniques ."
  ],
  "abstract_text": [
    "<S> kinetic approaches provide an effective description of the process of particle acceleration at shock fronts and allow to take into account the dynamical reaction of the accelerated particles as well as the amplification of the turbulent magnetic field as due to streaming instability . </S>",
    "<S> the latter does in turn affect the maximum achievable momentum and thereby the acceleration process itself , in a chain of causality which is typical of non - linear systems . </S>",
    "<S> different kinetic approaches are characterized by different levels and types of approximations that also imply different computational times . here </S>",
    "<S> we present the results of two such approaches : one which is mathematically rigorous but rather demanding from the point of view of computational time , and the other which is computationally very fast but based on an ansatz that , while physically justified , is not rigorous . </S>",
    "<S> the identification of possible differences can be crucial in assessing the possibility of implementation of one such calculation in hydrodynamical codes for supernova explosions . </S>",
    "<S> special emphasis is given to a discussion of the appearance of multiple solutions in both approaches .    </S>",
    "<S> [ firstpage ]    acceleration of particles - shock waves </S>"
  ]
}