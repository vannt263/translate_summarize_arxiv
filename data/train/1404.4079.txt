{
  "article_text": [
    "let @xmath0 be a compact set of an euclidean space .",
    "we note by @xmath1 the space of finite , positive measures supported on @xmath2 , equipped with the weak-@xmath3 topology . for a continuous function @xmath4 , denote by @xmath5 the integral of @xmath6 by the measure @xmath7 . when no confusion may arise , we note @xmath8 for the integral to simplify exposition and to insist on the duality relationship between continuous functions and measures .",
    "the dirac measure supported at @xmath9 is denoted by @xmath10 .    for multi - index @xmath11 and vector @xmath12",
    ", we use the notation @xmath13 .",
    "denote by @xmath14 the set @xmath15 .",
    "the moment of multi - index @xmath11 of measure @xmath16 is then defined as the real @xmath17 . a multi - indexed sequence of reals @xmath18 is said to have a _ representing measure _ on @xmath2 if there exists @xmath19 such that @xmath20 for all @xmath11 .",
    "denote by @xmath21 $ ] the ring of polynomials in the variables @xmath22 .",
    "a set @xmath0 is basic semi - algebraic if it is defined as the intersection of finitely many polynomial inequalities : @xmath23 , \\",
    ", i = 1 \\ldots n_{\\mathbf{z}}\\rbrace$ ] .",
    "finally , we use the notation @xmath24 to denote parameters of the state space where trajectories @xmath25 live .",
    "we use the same convention @xmath26 for the controls @xmath27 .",
    "this notation makes the passage from temporal integration to integration with respect to a measure transparent .",
    "this section outlines the main steps of the convex lift step of the moment approach for bounded ocps as presented in @xcite .",
    "we only highlight the important features necessary for the following sections .",
    "consider the following end - constrained problem : @xmath28 , \\end{aligned}\\ ] ] where the state @xmath29 , controls @xmath30 and functions @xmath31 $ ] .",
    "sets @xmath32 and @xmath33 are compact , basic semialgebraic sets , and are assumed w.l.g . to be contained in a ball included in the algebraic definition of those sets .    for a process @xmath34 admissible for",
    ", the _ occupation measure _ @xmath35 is defined by : @xmath36 where @xmath37 , @xmath38 and @xmath39 are borel subsets of resp .",
    "@xmath40 , @xmath33 and @xmath32 .",
    "when evaluating a continuously differentiable test function @xmath41 along such an admissible trajectory , straightforward computations reveal that the occupation measure is admissible for the following measure lp , while achieving the same cost as : @xmath42 : \\ ; \\left [ v ( \\cdot , x(\\cdot))\\right]_{t_i}^{t_f } = \\langle \\frac{\\partial v}{\\partial t } + \\frac{\\partial v}{\\partial { \\underline{x } } }   f , \\mu \\rangle , \\\\ & \\mu \\in { \\mathcal{m}^+}(\\mathbf{t } \\times \\mathbf{u } \\times \\mathbf{x } ) . \\end{aligned}\\ ] ] obviously , since the admissible elements have been enlarged , @xmath43 .",
    "it is however expected generically that @xmath44 hold , see e.g. the discussion in @xcite .    as problem data was assumed polynomial , viz .",
    "$ ] and @xmath32 as well as @xmath33 are basic , semi - algebraic set , a dual to putinar s theorem ( see ( * ? ? ?",
    "3.8b ) ) allows to handle measures by their moment sequences .",
    "one obtains a finite - dimensional convex relaxation of by truncating the problem with only the first few moments as decision variables , as well as only a few of the linear constraints . denoting by @xmath45 the cost of the semi - definite relaxation considering moments of degree up to @xmath46 , @xcite",
    "have proven that the cost of the relaxations converge from below to the cost of measure lp :    @xmath47    the following corollary is immediate , and provides the basis for the termination criterion of  [ sec : inverse ] :    [ th : termination ] let an admissible pair @xmath34 have the same cost as a moment relaxation .",
    "then the solution is globally optimal .",
    "for the rest of the paper , we make the following standing assumptions , to ease exposition :    [ th : uniqueness ] problem admits a unique optimal process .    note that assumption [ th : uniqueness ] is generic , and can be enforced almost surely by perturbing randomly the coefficients of the polynomials data , as done for polynomial optimization in the ` sparsepop ` toolbox @xcite .",
    "note that as an immediate corollary , assumption [ th : uniqueness ] imposes the uniqueness of the optimal measure by ( * ? ? ?",
    "1.4 ) , and since measures are moment determinate on compact sets , uniqueness of optimal moment sequences are guaranteed as well .",
    "the next sections explore how this unique optimal measure can be reconstructed from its moments data .",
    "that is , given definition , we propose an algorithm for reconstructing the approximate support of @xmath48 .",
    "this section outlines convergence results for approximating occupation measures by atomic measures , that is , measures supported on a finite number of points only . in the next sections ,",
    "it is shown how trajectories can be recovered from these approximate measures .    at",
    "any given relaxation , only a finite subset of the moment constraints of can be taken into account numerically . as a result ,",
    "if the optimized moment sequence possesses a representing measure , there always exists an atomic measure with the exact same moments ( * ? ? ?",
    "b.12 ) :    [ th : tchaka ] let @xmath48 be a finite , positive , borel measure with compact support @xmath49 , and let @xmath50 be a fixed positive integer",
    ". then there exists @xmath51 points @xmath52 and positive weights @xmath53 such that @xmath54 for every polynomial @xmath55 $ ] of degree at most @xmath56 .    to obtain a finite dimensional lp , we therefore propose fixing a time - space grid of dirac measures , as proposed in @xcite for solving directly .",
    "as such the only decision variables are then the mass of the dirac measures , which enter linearly in the problem .",
    "the crucial difference here with @xcite is that we do not attempt to find an optimal measure , since its ( approximate ) moments are already given by the semi - definite relaxations . instead , by segregating optimization and approximation",
    ", we circumvent the problem encountered in @xcite , where there might not be a given atomic measure on a given grid satisfying the truncated moment constraints within a given tolerance .",
    "we also prevent the distortion of solutions when prescribed moment tolerances are too loose .",
    "denote by @xmath57 a mesh of given resolution @xmath58 supported on finitely many points , such that for all @xmath59 , there exists @xmath60 such that @xmath61 . by compactness of @xmath2 ,",
    "such a @xmath62 always exists .",
    "consider the following lp : @xmath63 where @xmath64 are given moments of a representing measure @xmath19 .",
    "then , as the mesh is refined , moments of the approximate atomic measure @xmath65 converge to those of @xmath48 : @xmath66    indeed , th .",
    "[ th : tchaka ] asserts the existence of an atomic measure supported on @xmath67 points @xmath68 such that @xmath69 , for all @xmath70 .",
    "therefore , for any @xmath71 , by continuity of the monomials and the finite number of moment constraints , one can always find an @xmath72 such that there exists a measure @xmath73 that is admissible for lp .",
    "as @xmath74 is arbitrary and 0 is a lower bound for the cost , this concludes the proof .",
    "see also the related developments in @xcite , which however try to approximate directly by a lp . to optimize over the cost , moment tolerance @xmath74",
    "must then be fixed a priori , and carefully chosen to minimize distortions while guaranteeing the existence of an atomic approximation on the given grid  a very difficult task .",
    "problem can be interpreted as a truncation of a minimum norm problem , when the weak-@xmath3 topology is considered for measures . indeed , on compact sets , it is sufficient to consider a dense basis of the continuous function equipped with the supremum norm .",
    "the monomials @xmath75 are such a possible choice , such that the minimum norm problem would read : @xmath76 clearly , is just the truncation of down to a finite number of moments .",
    "this has an immediate consequence by the mere definition of weak-@xmath3 convergence , as relaxation order @xmath77 in is increased :    [ th : assympconv ] @xmath65 converges weakly-@xmath3 to @xmath48 as @xmath78 and @xmath79 .",
    "corollary [ th : assympconv ] shows the good asymptotic properties of the algorithm as the grid is refined and the number of moments is increased .",
    "obviously , only a finite number of moments are supplied by any given moment relaxation , and the practical resolution of the lp imposes a maximum size on the approximation grid . from now on ,",
    "we take a practical view on the inverse problem , working with a finite data set , and with possibly approximate / relaxed moment data as problem input . in the next section , this standing assumption of `` good enough '' moments and grid resolution will be tested a posteriori by hot - starting a direct method .",
    "fix a grid @xmath62 indexed by @xmath80 points .",
    "then is rewritten as the following minimum norm problem parametrized by the ( positive ) weights @xmath81 associated to each atom @xmath82 : @xmath83 with vector @xmath84 the truncated moment vector @xmath85 , @xmath86 returned by the semi - definite relaxation of order @xmath77 , and @xmath87 a @xmath88 matrix , whose elements are given by @xmath89 .",
    "this problem can be solved by standard linear programming routines .",
    "the support of the atomic measure  which is expected to approximate closely the support of occupation measure  is recovered by the elements of @xmath62 whose optimal weights are non - zero . by ass .",
    "[ th : uniqueness ] , those way - points closely approximate the unique optimal trajectory and controls .",
    "note that for the numeric experiments below , it was observed to be more efficient to solve by an interior point method and apply a threshold than to use a simplex - based algorithm .",
    "there is nonetheless a severe restriction to this approach : the dimension of @xmath90 leads quickly to lps of extremely large sizes , a direct consequence of the `` curse of dimensionality '' of dynamic programming , the conic dual of . indeed , in the opinion of the author",
    ", this is the second main restriction for using the numeric approach of @xcite for solving directly .",
    "even with a coarse grid of @xmath91 points in each direction , a basic implementation of the algorithm would lead to a lp of a minimum of @xmath92 billion variables for a problem with @xmath93 control and @xmath94 states .",
    "therefore , we propose a middle ground between the rigor and the better scalabilty of the moment approach , and the practical information on the support of the occupation measure given by the lp approach . from the data given by a relaxation , we only consider moments of the form @xmath95 .",
    "that is we , use only moments of time and one of the states or the controls , such as to perform a coordinate - by - coordinate identification of trajectory and control time series .",
    "this way of proceeding keeps the size of the lps small enough , such that the inverse problem has a negligible resolution time in comparison to that of the moment relaxation , while maintaining a sufficient resolution @xmath58 of the grid .    obviously ,",
    "although likely to give excellent results even in the face of approximated and truncated data , this procedure does not guarantee admissibility of the reconstructed states and controls for ocp . to refine the numeric solutions , we propose to use those approximate time - series to hot - start a direct optimal control method .",
    "for all the numeric tests of the next section , we used the freely available software ` bocop ` @xcite .",
    "corollary [ th : termination ] then provides a numeric termination criterion for the moment method : if the cost of the solution given by the direct method is within a prescribed tolerance of the cost of the moment relaxation , the local solution is validated as globally optimal and the hierarchy of moment relaxations can be terminated .",
    "however , as shown in the next section , even non - tight relaxations are already enough to recover the global optimal solution via this approach , although those solutions can obviously not be certified to be optimal .",
    "we present now three illustrative examples .",
    "moment relaxations were solved via ` gloptipoly ` @xcite , using ` sedumi ` @xcite as the semi - definite solver .",
    "consider the problem of driving the double integrator to the origin in minimum time : @xmath96 . \\end{aligned}\\ ] ]    figures [ fig : doubleintx1 ] to [ fig : doubleintu ] present the optimal solution , along with the reconstructed trajectory following a coordinate - by - coordinate identification as proposed in ",
    "[ sec : inverse ] .",
    "moments of the fourth - order relaxation were used , since they closely approximate the true moments of the optimal occupation measure .",
    "as one can see , the reconstructed trajectories and controls closely match the true solution .",
    "figures [ fig : doubleintx1 ] to [ fig : doubleintu ] also compare the proposed atomic reconstruction approach with methods based on the results of @xcite and @xcite .",
    "the approach hinted in @xcite consists in extracting dual solutions to each moment relaxation , which give a polynomial ( sub)approximation @xmath97 to the value function satisfying , on @xmath98 , @xmath99 around the optimal trajectories , equality in must hold .",
    "we therefore propose a very coarse exploitation of such results : for each time @xmath100 in a given discretization of the time interval , find the couple @xmath101 minimizing @xmath102 .",
    "we did so by exhaustive search on the same time - state - control grid used by the atomic approximation technique , for comparison purposes . obviously , the main drawback of the approach is the curse of dimensionality , the example presented with @xmath93 control and @xmath103 states being already computationally intensive .",
    "the method gives excellent result for reconstructing the state , although slightly less precise than the faster atomic approximation .",
    "finally , the approach in @xcite considers moments of the form @xmath104 to approximate occupation measures by absolutely continuous ( with respect to the lebesgue measure on time ) measures with polynomial densities .",
    "this results in a simple linear system to solve . as can be seen in fig .",
    "[ fig : doubleintx1 ] , the method allows for a correct approximation of the first state , while the second state in fig .",
    "[ fig : doubleintx2 ] can not capture properly the switch of velocity .",
    "the picture is worse for the control , as seen in fig .",
    "[ fig : doubleintu ] , as the polynomial density fails to identify any structure such as bang arcs , and gives controls below @xmath105 , hence non - admissible .",
    "such behavior is of course expected from a polynomial approximation of a discontinuous function . in addition , this method simply fails if several solutions are encoded in an occupation measures , since the recovered density will be a weighted mean of those solutions . on the other hand",
    ", the atomic approximation measure will be supported on all these trajectories .",
    "as long as their number is finite , they could be extracted form the approximate measures , albeit with a more sophisticated technique to identify optimal arcs individually .    as a summary ,",
    "the atomic approximation combines computational effectiveness with a good approximation quality , especially considering admissibility of reconstructed trajectories and detection of control structures .",
    "consider the problem : @xmath106 , \\\\ & u(t ) \\in [ 1,1 ] , \\\\ & \\left ( x(t ) - \\nicefrac{1}{5 } \\right)^2 + \\left ( t - \\nicefrac{1}{2 } \\right)^2 \\geq \\left ( \\nicefrac{1}{5 } \\right)^2 .",
    "\\end{aligned}\\ ] ] the last constraint represents a time - dependent obstacle to be avoided , with the cost favoring solution passing below it . however , these solutions can not be admissible , as the end - point constraints will not be satisfied , and the optimal solution necessarily passes above the obstacle ( see fig .",
    "[ fig : nonconvex ] ) .",
    "this interplay between non - convex constraints and the cost make this problem very difficult to initialize for local methods , as a few tries with solver ` bocop ` @xcite may reveal .",
    "we now show that the method proposed can be used efficiently to initialize the local method .",
    "figure [ fig : nonconvex ] presents the extracted trajectories from moments of the second relaxation ( cost of @xmath107 ) , the sixth relaxation ( cost of @xmath108 ) and the optimal solution ( cost of @xmath109 ) .",
    "as expected , the sixth relaxation offers a finer reconstruction of the optimal trajectory .",
    "however , it should be noted that the very coarse trajectory reconstructed from the second relaxation is already enough to initialize the direct method implemented in ` bocop ` so that it converges to the global optimum .",
    "this suggests that the method proposed in this paper could be widely used for hot starting local methods , as lower - order relaxations are very cheap to compute .",
    "this is in contrast with using hamilton - jacobi - bellman solvers as in @xcite , which offer little possibility of trading solution accuracy with computational load .      in this last example , we show some alternative use of the proposed approach beyond optimal control .",
    "consider the ( uncontrolled ) dynamical system @xmath110 given by the van der pol oscillator : @xmath111 suppose one would like to compute its limit set , which is known here to be the union of a stable limit cycle and an unstable fixed point .",
    "following e.g. @xcite , one can relax this as the measure feasibility test @xmath112 : \\ ;   \\langle   \\frac{\\partial v}{\\partial { \\underline{x } } }   f , \\mu \\rangle = 0 , \\\\ & \\langle 1 , \\mu \\rangle = 1 , \\\\ & \\mu \\in { \\mathcal{m}^+}(\\mathbf{x } ) , \\end{aligned}\\ ] ] with @xmath32 a given compact , basic , semi - algebraic set",
    ". this problem can be solved via moment relaxations in a similar procedure as the one presented in ",
    "[ sec : ocp ] . applying the atomic extraction procedure for the support of the resulting measure on @xmath113 ^ 2 $ ] , and using moments of the @xmath114th relaxation ,",
    "one obtains the results of fig .",
    "[ fig : vdp ] .",
    "as expected , the extraction procedure locates ( within precision of the supplied grid ) the stable limit cycle , as well as the unstable equilibrium .",
    "in this paper , we present a method for recovering trajectories from the moments of occupation measures .",
    "this allows for a numerical method solving optimal control problem globally , in a `` black box '' fashion .",
    "first , moment relaxations as presented in @xcite are computed to obtain approximate truncated moment sequences .",
    "then , the method outlined here solves the inverse problem to obtain approximate global solutions .",
    "those solutions are then fed to a local method to guarantee admissibility of the process .",
    "numerically , the inverse problem possesses a simple structure , as one tries to minimize the distance in a finite - dimensional space , as measured by the supremum norm , from a point to a linear subspace . as such",
    ", it is expected that one could use dedicated solvers , using large scale , problem - specific routines to outperform the simple linear programming method considered here .",
    "see e.g. @xcite for an introduction on the subject .",
    "this opens the possibility of identifying approximate trajectories and controls in one pass , using all information available from moments .",
    "finally , we also presented the approach for bounded control for ease of exposition , but the method holds as well for modal occupation measures of switched systems @xcite and impulsive occupation measures @xcite .",
    "this demonstrates the high flexibility of the approach .",
    "this work was supported by the engineering and physical sciences research council under grant ep / g066477/1 , and benefited from discussions with jean - bernard lasserre and pierre martinon .",
    "h. waki , s. kim , m. kojima , m. muramatsu and h. sugimoto , sparsepop : a sparse semidefinite programming relaxation of polynomial optimization problems , acm trans .",
    "mathematical software , 35(2):15 , 2008 ."
  ],
  "abstract_text": [
    "<S> moment optimization techniques have been recently proposed to solve globally various classes of optimal control problems . </S>",
    "<S> as those methods return truncated moment sequences of occupation measures , this paper explores a numeric method for reconstructing optimal trajectories and controls from this data . </S>",
    "<S> in fact , by approximating occupation measures by atomic measures on a given grid , the problem reduces to a finite - dimensional linear program . </S>",
    "<S> in contrast with earlier numerical methods , this linear program is guaranteed to be feasible , no tolerance needs to be specified , and its size can be properly controlled . </S>",
    "<S> when combined with local optimal control solvers , this yields a powerful and flexible numerical approach for tackling difficult control problems , as demonstrated by examples . </S>",
    "<S> +    moments optimization techniques have emerged recently as a versatile tool for the global resolution of many non linear optimization problems , see for instance @xcite and references therein for applications to polynomial optimization , optimal control , stochastic processes , and more . </S>",
    "<S> the general procedure is illustrated in fig . </S>",
    "<S> [ fig : momentapproach ] . </S>",
    "<S> first of all , the problem of interest is lifted or relaxed as a linear program ( lp ) on measures . </S>",
    "<S> as such , the problem becomes convex , albeit on a vector space which is hardly tractable in the general case , besides brute - force discretization . </S>",
    "<S> however , when problem data is polynomial , measures can be manipulated by their moments , which leads to a well studied hierarchy of moment relaxations , whose cost converges asymptotically to that of the measure lp .    </S>",
    "<S> [ ->,>=stealth , shorten > = 1pt , node distance = 1.7 cm , auto , block/.style = rectangle , draw , thick , text width=7em , text centered , rounded corners , minimum height=3em ] ( opti ) optimization + problem ; ( gmp ) lp on + measures ; ( gmpmoms ) lp on + moments ; ( relax ) semi - definite + relaxations ; ( ghostl1 ) ; ( ghostl2 ) ; ( ghostr1 ) ; ( ghostr2 ) ; ( ghostb1 ) ; ( ghostb2 ) ;    ( opti ) edge ( gmp ) ; ( gmp ) edge ( gmpmoms ) ; ( gmpmoms ) edge ( relax ) ; ( ghostl1 ) edge node[left , rotate=90 , anchor = south ] convex lift ( ghostl2 ) ; ( ghostr2 ) edge node[right , rotate=90 , anchor = north ] inverse problem ( ghostr1 ) ; ( ghostb1 ) edge node[above ] numeric optimization ( ghostb2 ) ;    after numeric resolution of one of those relaxations , it is of obvious interest to assert termination of the hierarchy , as well as extract from moment data the solution of the measure lp , which in turn must be interpreted in terms of solutions of the original problem . </S>",
    "<S> this last step of the method is a typical example of an inverse problem .    for polynomial , finite - dimensional optimization as proposed in @xcite , </S>",
    "<S> the full approach is now well mastered . from the optimized moment data </S>",
    "<S> , one can expect generically at a finite relaxation order @xcite to recover the support of the measure , which is located at the ( generically unique ) optimal point . </S>",
    "<S> numerical tools allow for the resolution of such polynomial problems by the mere definition of the problem ( see for instance @xcite ) , for small size problems .    for optimal control problems ( ocp ) , on the other hand , most recent </S>",
    "<S> work has been focused on the convex lift and optimization step of the approach , for various classes of systems : from the case of bounded controls as presented in lasserre et al . </S>",
    "<S> @xcite , the approach was subsequently extended to impulsive controls @xcite or switched systems @xcite . </S>",
    "<S> however , very little work has been done on the inverse problem , which precludes the same `` black box '' operations as for polynomial optimization . to the author s knowledge </S>",
    "<S> , only exploitation of the dual problem as hinted in @xcite or the resolution of an inverse problem with very limited moment data @xcite have been investigated . </S>",
    "<S> we present briefly those methods and compare them to the one presented on this paper in  [ sec : example ] .    </S>",
    "<S> several obstacles related to the nature of solutions of ocps explain such a gap . </S>",
    "<S> first of all , trajectories are inherently infinite - dimensional objects , such that one can only expect to have approximate moments to the measure lp as a result of any given _ finite order _ </S>",
    "<S> moment relaxation . </S>",
    "<S> in addition , even if those moments were exact , their finite number prevents the exact reconstruction of an infinite dimensional object . </S>",
    "<S> therefore , only approximate optimal trajectory and control law can be recovered . </S>",
    "<S> this is especially true for the control , which is expected to be highly discontinuous , switching in between bang , path - constrained and singular arcs .    due to the restrictions mentioned above </S>",
    "<S> , we propose a numeric approach to reconstruct trajectories . in much of the spirit of the moment approach itself </S>",
    "<S> , we propose a convex program for extracting trajectory / control way points . </S>",
    "<S> as such , the scheme is guaranteed to converge if an admissible solution exists , and users should not specify any starting point for the method . </S>",
    "<S> the method is based on the approach developed by rubio ( see @xcite and the references therein ) , which uses a linear program to solve the measure lp directly . </S>",
    "<S> however , the key difference here is that in our approach , only an inverse problem must be solved , whereas the actual trajectory optimization is performed through semi - definite relaxations . </S>",
    "<S> the segregation between optimization and inverse problem allow the overcome several difficulties arising in those earlier works .    as a last step , </S>",
    "<S> the obtained way points are used as starting data of a direct optimal control routine . </S>",
    "<S> this allows for the reconstructing of a trajectory to any given precision . as a result </S>",
    "<S> , this also equips to approach with a termination criterion ; at any given relaxation order , if the cost of the solution of the direct method agrees with some prescribed tolerance to the cost of the moment relaxation , the solution is certified as globally optimal .    </S>",
    "<S> the idea of using a global method for hot - starting local optimal control methods is surprisingly not well studied in the literature . </S>",
    "<S> we explain this with the fact that the numeric resolution of the hamilton - jacobi - bellman ( hjb ) equation is an endeavor that can be hardly undertaken gradually in function of computational power available , as bounds on the discretization grid must be enforced to avoid numerical instability . </S>",
    "<S> in addition , once the solution is available , only those applications requiring high - precision solutions truly need a second round of computations from a local method . </S>",
    "<S> this is the motivation behind cristiani and martinon @xcite , who propose to solve the hjb equation on a coarse grid to initialize an indirect method exploiting pontryagin s maximum principle @xcite , via their well - known relationship ( see e.g. @xcite in the constrained case ) .    </S>",
    "<S> in contrast with these limitations , moment relaxations of low order are very cheap to compute , and as shown in the examples , are usually tight enough to hot start a local method in a sufficiently close neighborhood of the optimal solution . up to the author </S>",
    "<S> s knowledge , this is the first time that moment relaxations are used for such a purpose . </S>"
  ]
}