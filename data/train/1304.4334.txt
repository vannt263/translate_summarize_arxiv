{
  "article_text": [
    "bayesian approaches have inherent advantages in solving inference and decision problems , but practical applications pose challenges for computation . as these challenges have been met bayesian approaches have proliferated and contributed to the solution of applied problems .",
    "mcgrayne ( 2011 ) has recently conveyed these facts to a wide audience .",
    "the evolution of bayesian computation over the past half - century has conformed with exponential increases in speed and decreases in the cost of computing .",
    "the influence of computational considerations on algorithms , models , and the way that substantive problems are formulated for statistical inference can be subtle but is hard to over - state .",
    "successful and innovative basic and applied research recognizes the characteristics of the tools of implementation from the outset and tailors approaches to those tools .",
    "recent innovations in hardware ( graphics processing units , or gpus ) provide individual investigators with massively parallel desktop processing at reasonable cost . corresponding developments in software ( extensions of the c programming language and mathematical applications software ) make these attractive platforms for scientific computing .",
    "this paper extends and applies existing sequential monte carlo ( smc ) methods for posterior simulation in this context .",
    "the extensions fill gaps in the existing theory to provide a thorough and practical foundation for sequential posterior simulation , using approaches suited to massively parallel computing environments .",
    "the application produces generic posterior simulators that make substantially fewer analytical and programming demands on investigators implementing new models and provides faster , more reliable and more complete posterior simulation than do existing methods inspired by conventional predominantly serial computational methods .",
    "sequential posterior simulation grows out of smc methods developed over the past 20 years and applied primarily to state space models (  particle filters \" ) .",
    "seminal contributions include baker ( 1985 , 1987 ) , gordon et al .",
    "( 1993 ) , kong et al .",
    "( 1994 ) , liu and chen ( 1995 , 1998 ) , chopin ( 2002 , 2004 ) , del moral et al .",
    "( 2006 ) , andrieu et al .",
    "( 2010 ) , chopin and jacob ( 2010 ) and del moral et al .",
    "( 2011 ) .",
    "the posterior simulator proposed in this paper , which builds largely on chopin ( 2002 , 2004 ) , has attractive properties .",
    "* it is highly generic ( easily adaptable to new models ) .",
    "all that is required of the user is code to generate from the prior and evaluate the prior and data densities .",
    "* it is computationally efficient relative to available alternatives .",
    "this is in large part due to the specifics of our implementation of the simulator , which makes effective use of low - cost massively parallel computing hardware .",
    "* since the simulator provides a sample from the posterior density at each observation date conditional on information available at that time , it is straightforward to compute moments of arbitrary functions of interest conditioning on relevant information sets .",
    "marginal likelihood and predictive scores , which are key elements of bayesian analysis , are immediately available . also immediately available",
    "is the probability integral transform at each observation date , which provides a powerful diagnostic tool for model exploration (  generalized residuals \" ; e.g. , diebold et al . , 1998 ) .",
    "* estimates of numerical standard error and relative numerical efficiency are provided as an intrinsic part of the simulator .",
    "this is important but often neglected information for the researcher interested in generating dependable and reliable results . *",
    "the simulator is robust to irregular posteriors ( e.g. , multimodality ) , as has been pointed out by jasra et al .",
    "( 2007 ) and others . *",
    "the simulator has well - founded convergence properties .",
    "but , although the basic idea of sequential posterior simulation goes back at least to chopin ( 2002 , 2004 ) , and despite its considerable appeal , the idea has seen essentially no penetration in mainstream applied econometrics .",
    "applications have been limited to relatively simple illustrative examples ( although this has begun to change very recently ; see herbst and schorfheide , 2012 ; fulop and li , 2012 ; chopin et al . , 2012 ) .",
    "this is in stark contrast to applications of smc methods to state space filtering (  particle filters \" ) , which have seen widespread use .",
    "relative to markov chain monte carlo ( mcmc ) , which has become a mainstay of applied work , sequential posterior simulators are computationally costly when applied in a conventional serial computing environment .",
    "our interest in sequential posterior simulation is largely motivated by the recent availability of low cost hardware supporting massively parallel computation .",
    "smc methods are much better suited to this environment than is mcmc .",
    "the massively parallel hardware device used in this paper is a commodity graphical processing unit ( gpu ) , which provides hundreds of cores at a cost of well under one dollar ( us ) each .",
    "but in order to realize the huge potential gains in computing speed made possible by such hardware , algorithms that conform to the single - instruction multiple - data ( simd ) paradigm are needed .",
    "the simulators presented in this paper conform to the simd paradigm by design and realize the attendant increases in computing speed in practical application .",
    "but there are also some central issues regarding properties of sequential posterior simulators that have not been resolved in the literature .",
    "since reliable applied work depends on the existence of solid theoretical underpinnings , we address these as well .",
    "our main contributions are as follows .    1 .",
    "_ theoretical basis .",
    "_ whereas the theory for sequential posterior simulation as originally formulated by chopin ( 2002 , 2004 ) assumes that key elements of the algorithm are fixed and known in advance , practical applications demand algorithms that are adaptive , with these elements constructed based on the information provided by particles generated in the course of running the algorithm . +",
    "while some progress has been made in developing a theory that applies to such adaptive algorithms , ( e.g. , douc and moulines , 2008 ) , we expect that a solid theory that applies to the kind of algorithms that are used and needed in practice is likely to remain unattainable in the near future .",
    "+ in section [ sec : algorithms ] we provide an approach that addresses this problem in a different way , providing a posterior simulator that is highly adapted to the models and data at hand , while satisfying the relatively straightforward conditions elaborated in the original work of chopin ( 2002 , 2004 ) .",
    "numerical accuracy .",
    "_ while chopin ( 2004 ) provides a critical central limit theorem , the extant literature does not provide any means of estimating the variance , which is essential for assessing the numerical accuracy and relative numerical efficiency of moment approximations ( geweke , 1989 ) .",
    "this problem has proved difficult in the case of mcmc ( flegal and jones , 2010 ) and appears to have been largely ignored in the smc literature . in section [ sec : parpostsims ] we propose an approach to resolving this issue which entails no additional computational effort and is natural in the context of the massively parallel environment as well as key in making efficient use of it .",
    "the idea relies critically upon the theoretical contribution noted above .",
    "marginal likelihood .",
    "_ while the approach to assessing the asymptotic variance of moment approximations noted in the previous point is useful , it does not apply directly to marginal likelihood , which is a critical element of bayesian analysis .",
    "we address this issue in section [ sec : pml ] .",
    "parallel implementation .",
    "_ it has been noted that sequential posterior simulation is highly amenable to parallelization going back to at least chopin ( 2002 ) , and there has been some work toward exploring parallel implementations ( e.g. , lee et al . , 2010 ; fulop and li , 2012 ) .",
    "building on this work , we provide a software package that includes a full gpu implementation of the simulator , with specific details of the algorithm tuned to the massively parallel environment as outlined in section [ sec : algorithms ] and elsewhere in this paper .",
    "the software is fully object - oriented , highly modular , and easily extensible .",
    "new models are easily added , providing the full benefits of gpu computing with little effort on the part of the user .",
    "geweke et al .",
    "( 2013 ) provides an example of such an implementation for the logit model . in future work",
    ", we intend to build a library of models and illustrative applications utilizing this framework which will be freely available .",
    "section [ ss : software ] provides details about this software .",
    "5 .   _ specific recommendations . _",
    "the real test of the simulator is in its application to problems that are characteristic of the scale and complexity of serious disciplinary work . in section [ sec : application ] , we provide one such application to illustrate key ideas . in other ongoing work , including geweke et al .",
    "( 2013 ) and a longer working paper written in the process of this research ( durham and geweke , 2011 ) , we provide several additional substantive applications . as part of this work ,",
    "we have come up with some specific recommendations for aspects of the algorithm that we have found to work well in a wide range of practical applications .",
    "these are described in section [ ss : details ] and implemented fully in the software package we are making available with this paper .",
    "the sequential simulator proposed in this paper is based on ideas that go back to chopin ( 2002 , 2004 ) , with even earlier antecedents including gilkes and berzuini ( 2001 ) , and fearnhead ( 1998 ) .",
    "the simulator begins with a sample of parameter vectors (  particles \" ) from the prior distribution .",
    "data is introduced in batches , with the steps involved in processing a single batch of data referred to as a cycle . at the beginning of each cycle , the particles represent a sample from the posterior conditional on information available up to that observation date . as data",
    "is introduced sequentially , the posterior is updated using importance sampling ( kloek and van dijk , 1978 ) , the appropriately weighted particles representing an importance sample from the posterior at each step . as more data is introduced , the importance weights tend to become  unbalanced \" ( a few particles have most of the weight , while many others have little weight ) , and importance sampling becomes increasingly inefficient .",
    "when some threshold is reached , importance sampling stops and the cycle comes to an end . at this point ,",
    "a resampling step is undertaken , wherein particles are independently resampled in proportion to their importance weights .",
    "after this step , there will be many copies of particles with high weights , while particles with low weights will tend to drop out of the sample .",
    "finally , a sequence of metropolis steps is undertaken in order to rejuvenate the diversity of the particle sample . at the conclusion of the cycle ,",
    "the collection of particles once again represents a sample from the posterior , now incorporating the information accrued from the data newly introduced .",
    "this sequential introduction of data is natural in a time - series setting , but also applicable to cross - sectional data . in the latter case ,",
    "the sequential ordering of the data is arbitrary , though some orderings may be more useful than others .",
    "much of the appeal of this simulator is due to its ammenability to implementation using massively parallel hardware .",
    "each particle can be handled in a distinct thread , with all threads updated concurrently at each step .",
    "communication costs are low . in applications where computational cost is an important factor ,",
    "nearly all of the cost is incurred in evaluating densities of data conditional on a candidate parameter vector and thus isolated to individual threads .",
    "communication costs in this case are a nearly negligible fraction of the total computational burden .",
    "the key to efficient utilization of the massively parallel hardware is that the workload be divided over many simd threads . for the gpu hardware used in this paper optimal usage",
    "involves tens of thousands of threads . in our implementation",
    ", particles are organized in a relatively small number of groups each with a relatively large number of particles ( in the application in section [ sec : application ] there are @xmath0 groups of @xmath1 particles each ) .",
    "this organization of particles in groups is fundamental to the supporting theory .",
    "estimates of numerical error and relative numerical efficiency are generated as an intrinsic part of the algorithm with no additional computational cost , while the reliability of these estimates is supported by a sound theoretical foundation .",
    "this structure is natural in a massively parallel computing environment , as well critical in making efficient use of it .",
    "the remainder of this section provides a more detailed discussion of key issues involved in posterior simulation in a massively parallel environment .",
    "it begins in section [ subsec : compenv ] with a discussion of the relevant features of the hardware and software used .",
    "section [ subsec : notation_assumption ] sets up a generic model for bayesian inference along with conditions used in deriving the analytical properties of various sequential posterior simulators in section [ sec : algorithms ] .",
    "section [ sec : parpostsims ] stipulates a key convergence condition for posterior simulators , and then shows that if this condition is met there are attractive generic methods for approximating the standard error of numerical approximation in massively parallel computing environments .",
    "section [ sec : algorithms ] then develops sequential posterior simulators that satisfy this condition .      the particular device that motivates this work is the graphics processing unit ( gpu ) . as a practical matter several gpu s can be incorporated in a single server ( the  host \" ) with no significant complications , and desktop computers that can accommodate up to eight gpu s are readily available .",
    "the single- and multiple - gpu environments are equivalent for our purposes .",
    "a single gpu consists of several multiprocessors , each with several cores .",
    "the gpu has global memory shared by its multiprocessors , typically one to several gigabytes ( gb ) in size , and local memory specific to each multiprocessor , typically on the order of 50 to 100 kilobytes ( kb ) per multiprocessor .",
    "( for example , this research uses a single nvidia gtx 570 gpu with 15 multiprocessors , each with 32 cores .",
    "the gpu has 1.36 gb of local memory , and each multiprocessor has 49 kb of memory and 32 kb of registers shared by its cores . )",
    "the bus that transfers data between gpu global and local memory is significantly faster than the bus that transfers data between host and device , and accessing local memory on the multiprocessor is faster yet . for greater technical detail on gpu s ,",
    "see hendeby et al .",
    "( 2010 ) , lee et al .",
    "( 2010 ) and souchard et al .",
    "( 2010 ) .",
    "this hardware has become attractive for scientific computing with the extension of scientific programming languages to allocate the execution of instructions between host and device and facilitate data transfer between them . of these",
    "the most significant has been the compute unified device architecture ( cuda ) extension of the c programming language ( nvidia , 2013 ) .",
    "cuda abstracts the host - device communication in a way that is convenient to the programmer yet faithful to the aspects of the hardware important for writing efficient code .",
    "code executed on the device is contained in special functions called kernels that are invoked by the host code .",
    "specific cuda instructions move the data on which the code operates from host to device memory and instruct the device to organize the execution of the code into a certain number of blocks with a certain number of threads each .",
    "the allocation into blocks and threads is the virtual analogue of the organization of a gpu into multiprocessors and cores .    while the most flexible way to develop applications that make use of gpu parallelization is through c / c++ code with direct calls to the vendor - supplied interface functions , it is also possible to work at a higher level of abstraction .",
    "for example , a growing number of mathematical libraries have been ported to gpu hardware ( e.g. , innovative computing laboratory , 2013 ) .",
    "such libraries are easily called from standard scientific programming languages and can yield substantial increases in performance for some applications .",
    "in addition , matlab ( 2013 ) provides a library of kernels , interfaces for calling user - written kernels , and functions for host - device data transfer from within the matlab workspace .",
    "we augment standard notation for data , parameters and models .",
    "the relevant observable random vectors are @xmath2 @xmath3 and @xmath4 denotes the collection @xmath5 .",
    "the observation of @xmath2 is @xmath6 , @xmath7 denotes the collection @xmath8 , and therefore @xmath9 denotes the data .",
    "this notation assumes ordered observations , which is natural for time series .",
    "if @xmath10 is independent and identically distributed the ordering is arbitrary .",
    "a model for bayesian inference specifies a @xmath11 unobservable parameter vector @xmath12 and a conditional density @xmath13 with respect to an appropriate measure for @xmath14 .",
    "the model also specifies a prior density @xmath15 with respect to a measure @xmath16 on @xmath17 .",
    "the posterior density @xmath18 follows in the usual way from and @xmath19 .",
    "the objects of bayesian inference can often be written as posterior moments of the form @xmath20 $ ] , and going forward we use @xmath21 to refer to such a generic function of interest .",
    "evaluation of @xmath21 may require simulation , e.g.  @xmath22 $ ] , and conventional approaches based on the posterior simulation sample of parameters ( e.g.  geweke , 2005 , section 1.4 ) apply in this case .",
    "the marginal likelihood @xmath23 famously does not take this form , and section [ sec : pml ] takes up its approximation with sequential posterior simulators and , more specifically , in the context of the methods developed in this paper .",
    "several conditions come into play in the balance of the paper .",
    "[ cond : prior_evaluate](prior distribution ) .",
    "the model specifies a proper prior distribution .",
    "the prior density kernel can be evaluated with simd - compatible code .",
    "simulation from the prior distribution must be practical but need not be simd - compatible .",
    "it is well understood that a model must take a stance on the distribution of outcomes @xmath14 _ a priori _ if it is to have any standing in formal bayesian model comparison , and that this requires a proper prior distribution .",
    "this requirement is fundamentally related to the generic structure of sequential posterior simulators , including those developed in section [ sec : algorithms ] , because they require a distribution of @xmath24 before the first observation is introduced .",
    "given a proper prior distribution the evaluation and simulation conditions are weak .",
    "simulation from the prior typically involves minimal computational cost and thus we do not require it to be simd - compatible .",
    "however , in practice it will often be so .",
    "[ cond : lf_evaluate](likelihood function evaluation ) the sequence of conditional densities @xmath25 can be evaluated with simd - compatible code for all @xmath12 .    evaluation with simd - compatible code is important to computational efficiency because evaluation of ( [ model_conditional_pdf ] ) constitutes almost all of the floating point operations in typical applications for the algorithms developed in this paper .",
    "condition [ cond : lf_evaluate ] excludes situations in which unbiased simulation of ( [ model_conditional_pdf ] ) is possible but exact evaluation is not , which is often the case in nonlinear state space models , samples with missing data , and in general any case in which a closed form analytical expression for ( [ model_conditional_pdf ] ) is not available .",
    "a subsequent paper will take up this extension .",
    "[ cond : bounded_like ] ( bounded likelihood ) the data density @xmath26 is bounded above by @xmath27 for all @xmath28 .",
    "this is one of two sufficient conditions for the central limit theorem invoked in section [ subsec : nonadaptive ] .",
    "it is commonly but not universally satisfied .",
    "when it is not , it can often be attained by minor and innocuous modification of the likelihood function ; section [ sec : application ] provides an example .",
    "[ cond : prior_var](existence of prior moments ) if the algorithm is used to approximate @xmath29 $ ] , then @xmath30<\\infty$ ] for some @xmath31 .    in any careful implementation of posterior simulation",
    "the existence of relevant posterior moments must be verified analytically .",
    "this condition , together with condition [ cond : bounded_like ] , is sufficient for the existence of @xmath32 $ ] and @xmath33 $ ] .",
    "condition [ cond : prior_var ] also comes into play in establishing a central limit theorem .",
    "consider the implementation of any posterior simulator in a parallel computing environment like the one described in section [ subsec : compenv ] .",
    "following the conventional approach , we focus on the posterior simulation approximation of @xmath34 . \\label{post_moment}\\ ] ] the posterior simulator operates on parameter vectors , or particles , @xmath35 organized in @xmath36 groups of @xmath37 particles each ; define @xmath38 and @xmath39 .",
    "this organization is fundamental to the rest of the paper .",
    "each particle is associated with a core of the device .",
    "the cuda software described in section [ subsec : compenv ] copes with the case in which @xmath40 exceeds the number of cores in an efficient and transparent fashion .",
    "ideally the posterior simulator is simd - compatible , with identical instructions executed on all particles .",
    "some algorithms , like the sequential posterior simulators developed in section [ sec : algorithms ] , come quite close to this ideal .",
    "others , for example gibbs samplers with metropolis steps , may not .",
    "the theory in this section applies regardless .",
    "however , the advantages of implementing a posterior simulator in a parallel computing environment are driven by the extent to which the algorithm is simd - compatible .",
    "denote the evaluation of the function of interest at particle @xmath35 by @xmath41 and within - group means by @xmath42 @xmath43 .",
    "the posterior simulation approximation of @xmath44 is the grand mean @xmath45    in general we seek posterior simulators with the following properties .",
    "[ cond : normal_approx](asymptotic normality of posterior moment approximation ) the random variables @xmath46 are independently and identically distributed .",
    "there exists @xmath47 for which @xmath48 as @xmath49 .",
    "going forward , @xmath50 will denote a generic variance in a central limit theorem .",
    "convergence is part of the rigorous foundation of posterior simulators , e.g. geweke ( 1989 ) for importance sampling , tierney ( 1994 ) for mcmc , and chopin ( 2004 ) for a sequential posterior simulator . for importance sampling",
    "@xmath51 @xmath52 , where @xmath53 is the ratio of the posterior density kernel to the source density kernel .    for to be of any practical use in assessing numerical accuracy there must also be a simulation - consistent approximation of @xmath50 .",
    "such approximations are immediate for importance sampling . they have proven more elusive for mcmc ; e.g. , see flegal and jones ( 2010 ) for discussion and an important contribution . to our knowledge",
    "there is no demonstrated simulation - consistent approximation of @xmath50 for sequential posterior simulators in the existing literature .",
    "however , for any simulator satisfying condition [ cond : normal_approx ] this is straightforward .",
    "given condition [ cond : normal_approx ] , it is immediate that @xmath54 define the estimated posterior simulation variance @xmath55 \\sum_{j=1}^{j}\\left ( \\overline{g}_{j}^{n}-\\overline{g}^{\\left ( j , n\\right ) } \\right ) ^{2}\\label{vhat}\\ ] ] and the numerical standard error ( _ nse _ ) @xmath56 ^{1/2}=\\left\\ { \\left [ j\\left ( j-1\\right ) \\right ] ^{-1}\\sum_{j=1}^{j}\\left ( \\overline{g}_{j}^{n}-\\overline{g}^{\\left ( j , n\\right ) } \\right)^2 \\right\\ } ^{1/2}. \\label{nse_def}\\ ] ] note the different scaling conventions in and : in the scaling is selected so that @xmath57 approximates @xmath50 in because we will use this expression mainly for methodological developments ; in the scaling is selected to make it easy to appraise the reliability of numerical approximations of posterior moments like those reported in section [ sec : application ] .",
    "one conventional assessment of the efficiency of a posterior simulator is its relative numerical efficiency ( _ rne _ ) ( geweke , 1989 ) , @xmath58 where @xmath59 , the simulation approximation of @xmath60 $ ] .",
    "[ prop : clt_var_approx]condition [ cond : normal_approx ] implies @xmath61 and @xmath62 ^{1/2}\\overset{d}{\\rightarrow } t\\left ( j-1\\right ) , \\label{p1b}\\ ] ] both as @xmath63 .",
    "conditions [ cond : prior_evaluate ] through [ cond : prior_var ] imply @xmath64 = var\\left [   \\overline{g}^{\\left ( j , n\\right ) } \\right ] .",
    "\\label{p1c}\\ ] ]    from condition [ cond : normal_approx ] , @xmath65 as @xmath63 . substituting in yields .",
    "condition [ cond : normal_approx ] also implies @xmath66 as @xmath63 . since and are independent in the limiting distribution",
    ", we have .",
    "conditions [ cond : prior_evaluate ] through [ cond : prior_var ] imply the existence of the first two moments of @xmath67 . then follows from the fact that the approximations @xmath68 are independent and identically distributed across @xmath69 .",
    "we seek a posterior simulator that is generic , requiring little or no intervention by the investigator in adapting it to new models beyond the provision of the software implicit in conditions [ cond : prior_evaluate ] and [ cond : lf_evaluate ] .",
    "it should reliably assess the numerical accuracy of posterior moment approximations , and this should be achieved in substantially less execution time than would be required using the same or an alternative posterior simulator for the same model in a serial computing environment .",
    "such simulators are necessarily adaptive : they must use the features of the evolving posterior distribution , revealed in the particles @xmath70 , to design the next steps in the algorithm .",
    "this practical requirement has presented a methodological conundrum in the sequential monte carlo literature , because the mathematical complications introduced by even mild adaptation lead to analytically intractable situations in which demonstration of the central limit theorem in condition [ cond : normal_approx ] is precluded .",
    "this section solves this problem and sets forth a particular adaptive sequential posterior simulator that has been successful in applications we have undertaken with a wide variety of models .",
    "section [ sec : application ] details one such application .",
    "section [ subsec : nonadaptive ] places a nonadaptive sequential posterior simulator ( chopin , 2004 ) that satisfies condition [ cond : normal_approx ] into the context developed in the previous section .",
    "section [ subsec : adaptive ] introduces a technique that overcomes the analytical difficulties associated with adaptive simulators .",
    "it is generic , simple and imposes little additional overhead in a parallel computing environment .",
    "section [ ss : details ] provides details on a particular variant of the algorithm that we have found to be successful for a variety of models representative of empirical research frontiers in economics and finance .",
    "section [ ss : software ] discusses a software package implementing the algorithm that we are making available .",
    "we rely on the following mild generalization of the sequential monte carlo algorithm of chopin ( 2004 ) , cast in the parallel computing environment detailed in the previous section . in this algorithm",
    ", the observation dates at which each cycle terminates ( @xmath71 ) and the parameters involved in specifying the metropolis updates ( @xmath72 ) are assumed to be fixed and known in advance , in conformance with the conditions specified by chopin ( 2004 ) .",
    "[ alg : general_nonadaptive](nonadaptive )  let @xmath73 be fixed integers with @xmath74 and let @xmath75 be fixed vectors .    1 .   initialize @xmath76 and",
    "let @xmath77 .",
    "2 .   for @xmath78 1 .",
    "correction @xmath79 phase : 1 .",
    "2 .   for @xmath81@xmath82 3 .",
    "selection @xmath84 phase , applied independently to each group @xmath85 : using multinomial or residual sampling based on @xmath86 , select @xmath87 3 .",
    "mutation @xmath88 phase , applied independently across @xmath89 : @xmath90 where the drawings are independent and the p.d.f .   satisfies the invariance condition @xmath91 3 .",
    "@xmath92    the algorithm is nonadaptive because @xmath93 and @xmath94 are predetermined before the algorithm starts .",
    "going forward it will be convenient to denote the cycle indices by @xmath95 . at the conclusion of the algorithm , the simulation approximation of a generic posterior moment is .",
    "[ prop_chopin ] if conditions [ cond : prior_evaluate ] through [ cond : prior_var ] are satisfied then algorithm [ alg : general_nonadaptive ] satisfies condition [ cond : normal_approx ] .",
    "the results follow from chopin ( 2004 ) , theorem 1 ( for multinomial resampling ) and theorem 2 ( for residual resampling ) .",
    "the assumptions made in theorems 1 and 2 are    1 .",
    "@xmath96 and @xmath97 @xmath98 , 2 .   the functions @xmath99 are integrable on @xmath100 , and 3 .",
    "the moments @xmath101 exist .",
    "assumption 1 is merely a change in notation ; conditions [ cond : prior_evaluate ] through [ cond : bounded_like ] imply assumption 2 ; and conditions [ cond : prior_evaluate ] through [ cond : prior_var ] imply assumption 3 .",
    "theorems 1 and 2 in chopin ( 2004 ) are stated using the weighted sample at the end of the last @xmath102 phase , but as that paper states , they also apply to the unweighted sample at the end of the following @xmath103 phase . at the conclusion of each cycle @xmath104 , the @xmath36 groups of @xmath37 particles each , @xmath105 @xmath106 , are mutually independent because the @xmath107 phase is executed independently in each group .    at the end of each cycle",
    "@xmath104 , all particles @xmath108 are identically distributed with common density @xmath109 . particles in different groups are independent , but particles within the same group are not .",
    "the amount of dependence within groups depends upon how well the @xmath103 phases succeed in rejuvenating particle diversity .",
    "in fact the sequences @xmath110 and @xmath111 for which the algorithm is sufficiently efficient for actual application are specific to each problem . as a practical matter",
    "these sequences must be tailored to the problem based on the characteristics of the particles @xmath112 produced by the algorithm itself .",
    "this leads to algorithms of the following type .",
    "[ alg : general_adaptive](adaptive ) algorithm [ alg : general_adaptive ] is the following generalization of algorithm [ alg : general_nonadaptive ] . in each cycle",
    "@xmath104 ,    1 .",
    "[ alg : general_adaptive_cond1]@xmath113 may be random and depend on @xmath114 ; 2 .",
    "[ alg : general_adaptive_cond2]the value of @xmath115 may be random and depend on @xmath116 .    while such algorithms can be effective and are what is needed for practical applied work , the theoretical foundation relevant to algorithm [ alg : general_nonadaptive ] does not apply .",
    "the groundwork for algorithm [ alg : general_nonadaptive ] was laid by chopin ( 2004 ) . with respect to the first condition of algorithm [ alg : general_adaptive ] , in chopin s development each cycle",
    "consists of a single observation , while in practice cycle lengths are often adaptive based on the effective sample size criterion ( liu and chen , 1995 ) .",
    "progress has been made toward demonstrating condition [ cond : normal_approx ] in this case only recently ( douc and moulines , 2008 ; del moral et al . , 2011 ) , and it appears that conditions [ cond : prior_evaluate ] through [ cond : prior_var ] are sufficient for the assumptions made in douc and moulines ( 2008 ) . with respect to the second condition of algorithm [ alg : general_adaptive ] , demonstration of condition [ cond : normal_approx ] for the adaptations that are necessary to render sequential posterior simulators even minimally efficient appears to be well beyond current capabilities .",
    "there are many specific adaptive algorithms , like the one described in section [ ss : details ] below , that will prove attractive to practitioners even in the absence of sound theory for appraising the accuracy of posterior moment approximations . in some cases condition [ cond :",
    "normal_approx ] will hold ; in others , it will not but the effects will be harmless ; and in still others condition [ cond : normal_approx ] will not hold and the relation of to will be an open question .",
    "investigators with compelling scientific questions are unlikely to forego attractive posterior simulators awaiting the completion of their proper mathematical foundations .",
    "the following algorithm resolves this dilemma , providing a basis for implementations that are both computationally effective and supported by established theory .",
    "[ alg : general_hybrid](hybrid )    1 .",
    "[ alg : general_hybrid_step1]execute algorithm [ alg : general_adaptive ] .",
    "retain @xmath117 @xmath118 and discard @xmath119 @xmath120 .",
    "[ alg : general_hybrid_step3]execute algorithm [ alg : general_nonadaptive ] using the retained @xmath117 but with a new seed for the random number generator used in the @xmath107 and @xmath103 phases .    [ prop : hybrid ] if conditions [ cond : prior_evaluate ] through [ cond : prior_var ] are satisfied then algorithm [ alg : general_hybrid ] satisfies condition [ cond : normal_approx ] .    because the sequences @xmath121 and @xmath122 produced in step [ alg : general_hybrid_step1 ] are fixed ( predetermined ) with respect to the random particles @xmath123 generated in step [ alg : general_hybrid_step3 ] , the conditions of algorithm [ alg : general_nonadaptive ] are satisfied in step [ alg : general_hybrid_step3 ] . from proposition",
    "[ prop_chopin ] , condition [ cond : normal_approx ] is therefore satisfied .",
    "applications of bayesian inference are most often directed by investigators who are not specialists in simulation methodology .",
    "a generic version of algorithm [ alg : general_adaptive ] that works well for wide classes of existing and prospective models and data sets with minimal intervention by investigators is therefore attractive . while general descriptions of the algorithm such as provided in sections [ subsec : nonadaptive][subsec : adaptive ] give a useful basis for discussion , what is really needed for practical use is a detailed specification of the actual steps that need to be executed .",
    "this section provides the complete specification of a particular variant of the algorithm that has worked well across a spectrum of models and data sets characteristic of current research in finance and economics .",
    "the software package that we are making available with this paper provides a full implementation of the algorithm presented here ( see section [ ss : software ] ) .",
    "c phase termination : :    the @xmath102 phase is terminated based on a rule assessing the    effective sample size ( kong et al . , 1994 ; liu and chen , 1995 ) .    following each update step @xmath124 as described in algorithm    1 , part 2(a)ii , compute    @xmath125                ^{2}}{\\sum_{j=1}^{j}\\sum_{n=1}^{n}w_{jn}\\left ( s\\right ) ^{2}}.\\ ] ]    it is convenient to work with the relative sample size ,    @xmath126 , where    @xmath40 is the total number of particles . terminate the    @xmath102 phase and proceed to the @xmath107 phase if    @xmath127 .",
    "+    we have found that the specific threshold value used has little effect    on the performance of the algorithm .",
    "higher thresholds imply that the    @xmath102 phase is terminated earlier , but fewer metropolis    steps are needed to obtain adequate diversification in the    @xmath103 phase ( and inversely for lower thresholds ) .",
    "the    default threshold in the software is 0.5 .",
    "this can be easily modified    by users , but we have found little reason to do so .",
    "resampling method : :    we make several resampling methods available .",
    "the results of chopin    ( 2004 ) apply to multinomial and residual resampling ( baker , 1985 ,    1987 ; liu and chen , 1998 ) .",
    "stratified ( kitagawa , 1996 ) and systematic    ( carpenter et al . , 1999 )",
    "samplers are also of potential interest .",
    "we    use residual sampling as the default .",
    "it is substantially more    efficient than multinomial at little additional computational cost .",
    "stratified and systematic resamplers are yet more efficient as well as    being less costly and simpler to implement ; however , we are not aware    of any available theory supporting their use and so recommend them    only for experimental use at this point .",
    "metropolis steps : :    the default is to use a sequence of gaussian random walk samplers    operating on the entire parameter vector in a single block . at    iteration @xmath128 of the @xmath103 phase in cycle    @xmath104 , the variance of the sampler is obtained by    @xmath129 where @xmath130 is the sample variance of    the current population of particles and @xmath131 is a     stepsize \" scaling factor .",
    "the stepsize is initialized at 0.5 and    incremented depending upon the metroplis acceptance rate at each    iteration .",
    "using a target acceptance rate of 0.25 ( gelman et al . ,    1996 ) , the stepsize is incremented by 0.1 if the acceptance rate is    greater than the target and decremented by 0.1 otherwise , respecting    the constraint @xmath132 .",
    "+    an alternative that has appeared often in the literature is to use an    independent gaussian sampler",
    ". this can give good performance for    relatively simple models , and is thus useful for illustrative purposes    using implementations that are less computationally efficient .",
    "but for    more demanding applications , such as those that are likely to be    encountered in practical work , the independent sampler lacks    robustness .",
    "if the posterior is not well - represented by the gaussian    sampler , the process of particle diversification can be very slow .",
    "the    difficulties are amplified in the case of high - dimensional parameter    vectors .",
    "and the sampler fails spectacularly in the presence of    irregular posteriors ( e.g. , multimodality ) .",
    "+    the random walk sampler gives up some performance in the case of near    gaussian posteriors ( though it still performs well in this situation ) ,    but is robust to irregular priors , a feature that we consider to be    important .",
    "the independent sampler is available in the software for    users wishing to experiment .",
    "other alternatives for the metropolis    updates are also possible , and we intend to investigate some of these    in future work .",
    "m phase termination : :    the simplest rule would be to terminate the @xmath103 phase    after some fixed number of metropolis iterations , @xmath133 . but    in practice , it sometimes occurs that the @xmath102 phase    terminates with a very low @xmath134 . in this case",
    ",    the @xmath103 phase begins with relatively few distinct    particles and we would like to use more iterations in order to better    diversify the population of particles .",
    "a better rule is to end the    @xmath103 phase after    @xmath135 iterations if    @xmath136 and after    @xmath137 iterations if    @xmath138 ( the default settings in the    software are @xmath139 , @xmath140 ,    @xmath141 and @xmath142 ) .",
    "we refer to this    as the  deterministic stopping rule . \"",
    "+    but , the optimal settings , especially for @xmath143 ,    are highly application dependent . setting @xmath143    too low results in poor rejuvenation of particle diversity and the    _ rne _  associated with moments of functions of interest will typically    be low .",
    "this problem can be addressed by either using more particles    or a higher setting for @xmath143 .",
    "typically , the    latter course of action is more efficient if _ rne _  drops below about    0.25 ; that is , finesse ( better rejuvenation ) is generally preferred    over brute force ( simply adding more particles ) . on the other hand ,",
    "there is little point in continuing @xmath103 phase iterations    once _ rne _  gets close to one ( indicating that particle diversification    is already good , with little dependence amongst the particles in each    group ) .",
    "continuing past this point is simply a waste of computing    resources .",
    "+    _ rne _  thus provides a useful diagnostic of particle diversity .",
    "but it    also provides the basis for a useful alternative termination    criterion .",
    "the idea is to terminate @xmath103 phase iterations    when the average _ rne _  of numerical approximations of selected test    moments exceeds some threshold .",
    "we use a default threshold of    @xmath144 .",
    "it is often useful to compute moments of    functions of interest at particular observation dates . while it is    possible to do this directly using weighted samples obtained within    the @xmath102 phase , it is more efficient to terminate the    @xmath102 phase and execute @xmath107 and @xmath103    phases at these dates prior to evaluating moments . in such cases , it    is useful to target a higher _ rne _  threshold to assure more accurate    approximations .",
    "we use a default of @xmath145 here .",
    "we    also set an upper bound for the number of metropolis iterations , at    which point the @xmath103 phase terminates regardless of _",
    "the default is @xmath146 .",
    "+    while the deterministic rule is simpler , the _ rne_-based rule has    important advantages : it is likely to be more efficient than the    deterministic rule in practice ; and it is fully automated , thus    eliminating the need for user intervention .",
    "some experimental results    illustrating these issues are provided in section [ sec : application ] .",
    "+    an important point to note here is that after the @xmath107    phase has executed , _",
    "no longer provides a useful as a measure of    the diversity of the particle population ( sincle the particles are    equally - weighted ) .",
    "_ rne _  is the only useful measure of which we are    aware .",
    "parameterization : :    bounded support of some parameters can impede the efficiency of the    gaussian random walk in the @xmath103 phase , which has unbounded    support .",
    "we have found that simple transformations , for example a    positive parameter @xmath147 to    @xmath148 or a parameter @xmath149    defined on @xmath150 to    @xmath151 , can greatly    improve performance .",
    "this requires attention to the jacobian of the    transformation in the prior distribution , but it is often just as    appealing simply to place the prior distribution directly on the    transformed parameters .",
    "section 5.1 provides an example .",
    "the posterior simulator described in this section is adaptive ( and thus a special case of algorithm [ alg : general_adaptive ] ) .",
    "that is , key elements of the simulator are not known in advance , but are determined on the basis of particles generated in the course of executing it . in order to use the simulator in the context of the hybrid method ( algorithm [ alg : general_hybrid ] ) , these design elements must be saved for use in a second run . for the simulator described here",
    ", we need the observations @xmath152 at which each @xmath102 phase termination occurs , the variance matrices @xmath153 used in the metropolis updates , and the number of metropolis iterations executed in each @xmath103 phase @xmath154 . the hybrid method then involves running the simulator a second time , generating new particles but using the design elements saved from the first run .",
    "since the design elements are now fixed and known in advance , this is a special case of algorithm [ alg : general_nonadaptive ] and thus step 2 of algorithm [ alg : general_hybrid ] . and",
    "therefore , in particular , condition [ cond : normal_approx ] is satisfied and the results of section [ sec : parpostsims ] apply .",
    "the software package that we are making available with this paper ( http://www.quantosanalytics.org/garland/mp-sps_1.1.zip ) implements the algorithm developed in section [ ss : details ] .",
    "the various settings described there are provided as defaults but can be easily changed by users .",
    "switches are available allowing the user to choose whether the algorithm runs entirely on the cpu or using gpu acceleration , and whether to run the algorithm in adaptive or hybrid mode .",
    "the software provides log marginal likelihood ( and log score if a burn - in period is specified ) together with estimates of nse , as described in section [ subsec : ml ] .",
    "posterior mean and standard deviation of functions of interest at specified dates are provided along with corresponding estimates of rne and nse , as described in section [ sec : parpostsims ] .",
    "rss at each @xmath102 phase update and rne of specified test moments at each @xmath103 phase iteration are available for diagnostic purposes , and plots of these are generated as part of the standard output",
    ".    for transparency and accessibility to economists doing practical applied work , the software uses a matlab shell ( with extensive use of the parallel / gpu toolbox ) , with calls to functions coded in c / cuda for the computationally intensive parts . for simple problems where computational cost is low to begin with ,",
    "the overhead associated with using matlab is noticeable .",
    "but , for problems where computational cost is actually important , the cost is nearly entirely concentrated in c / cuda code .",
    "very little efficiency is lost by using a matlab shell , while the gain in transparency is substantial .",
    "the software is fully object - oriented , highly modular , and easily extensible .",
    "it is straightforward for users to write plug - ins implementing new models , providing access to the full benefits of gpu acceleration with little programming effort .",
    "all that is needed is a matlab class with methods that evaluate the data density and moments of any functions of interest .",
    "the requisite interfaces are all clearly specified by abstract classes .    to use a model for a particular application , data and a description of the prior must be supplied as inputs to the class constructor .",
    "classes implementing simulation from and evaluation of some common priors are included with the software . extending the package to implement additional prior specifications",
    "is simply a matter of providing classes with this functionality .",
    "the software includes several models ( including the application described in section [ sec : application ] of this paper ) , and we are in the process of extending the library of available models and illustrative applications using this framework in ongoing work .",
    "geweke et al .",
    "( 2013 ) provides an example of one such implementation for the logit model .",
    "marginal likelihoods are fundamental to the bayesian comparison , averaging and testing of models .",
    "sequential posterior simulators provide simulation - consistent approximations of marginal likelihoods as a by - product  almost no additional computation is required .",
    "this happens because the marginal likelihood is the product of predictive likelihoods over the sample , and the @xmath102 phase approximates these terms in the same way that classical importance sampling can be used to approximate marginal likelihood ( kloek and van dijk , 1978 ; geweke , 2005 , section 8.2.2 ) . by contrast",
    "there is no such generic approach with mcmc posterior simulators .    the results for posterior moment approximation apply only indirectly to marginal likelihood approximation .",
    "this section describes a practical adaptation of the results to this case , and a theory of approximation that falls somewhat short of condition [ cond : normal_approx ] for posterior moments .",
    "any predictive likelihood can be cast as a posterior moment by defining @xmath155 then @xmath156      : = \\overline{g}\\left(t , s\\right ) .",
    "\\label{pl__formula}\\ ] ]    [ prop_pl]if conditions [ cond : prior_evaluate ] , [ cond : lf_evaluate ] and [ cond : bounded_like ] are satisfied , then in algorithms [ alg : general_nonadaptive ] and [ alg : general_hybrid ] condition [ cond : normal_approx ] is satisfied for the function of interest ( [ pl_func ] ) and the sample @xmath157 .",
    "it suffices to note that conditions [ cond : prior_evaluate ] through [ cond : bounded_like ] imply that condition [ cond : prior_var ] is satisfied for .",
    "the utility of proposition [ prop_pl ] stems from the fact that simulation approximations of many moments ( [ pl__formula ] ) are computed as by - products in algorithm [ alg : general_nonadaptive ] .",
    "specifically , in the @xmath102 phase at for @xmath158 and @xmath159 @xmath160    from proposition [ prop_pl ] applied over the sample @xmath161 implies for @xmath158 and @xmath162 @xmath163 algorithms [ alg : general_nonadaptive ] and [ alg : general_hybrid ] therefore provide weakly consistent approximations to expressed in terms of the form .",
    "the logarithm of this approximation is a weakly consistent approximation of the more commonly reported log predictive likelihood .",
    "the numerical standard error of @xmath164 is given by , and the delta method provides the numerical standard error for the log predictive likelihood .",
    "the values of @xmath124 for which this result is useful are limited because as @xmath124 increases , @xmath165 becomes increasingly concentrated and the computational efficiency of the approximations @xmath166 of @xmath167 declines . indeed ,",
    "this is why particle renewal ( in the form of @xmath107 and @xmath103 phases ) is undertaken when the effective sample size drops below a specified threshold .",
    "the sequential posterior simulator provides access to the posterior distribution at each observation in the @xmath102 phase using the particles with the weights computed at . if at this point one executes the auxiliary simulations @xmath168",
    "@xmath169 then a simulation - consistent approximation of the cumulative distribution of a function @xmath170 , evaluated at the observed value @xmath171 , is @xmath172 } \\left [ f\\left ( y_{sjn}^{\\left ( \\ell -1\\right ) } \\right ) \\right ] } { \\sum_{j=1}^{j}\\sum_{n=1}^{n}w_{jn}\\left ( s-1\\right)}.\\ ] ] these evaluations are the essential element of a probability integral transform test of model specification ( rosenblatt , 1952 ; smith , 1985 ; diebold et al . , 1998",
    "; berkowitz , 2001 ; geweke and amisano , 2010 ) .",
    "thus by accessing the weights @xmath173 from the @xmath102 phase of the algorithm , the investigator can compute simulation consistent approximations of any set of predictive likelihoods ( 18 ) and can execute probability integral transform tests for any function of @xmath174      to develop a theory of sequential posterior simulation approximation to the marginal likelihood , some extension of the notation is useful . denote @xmath175 and then @xmath176    it is also useful to introduce the following condition , which describes an ideal situation that is not likely to be attained in practical applications but is useful for expositional purposes .",
    "[ cond : mphase]in the mutation phase of algorithm [ alg : general_nonadaptive ] @xmath177    with the addition of condition [ cond : mphase ] it would follow that @xmath178 $ ] in condition [ cond : normal_approx ] , and computed values of relative numerical efficiencies would be about 1 for all functions of interest @xmath179",
    ". in general condition [ cond : mphase ] is unattainable in any interesting application of an sequential posterior simulator , for if it were the posterior distribution could be sampled by direct monte carlo .",
    "[ prop_ml]if conditions [ cond : prior_evaluate ] , [ cond : lf_evaluate ] and [ cond : bounded_like ] are satisfied then in algorithms [ alg : general_nonadaptive ] and [ alg : general_hybrid ] @xmath180 as @xmath63 , and @xmath181 ^{-1}\\sum_{j=1}^{j } \\left ( \\overline{w}_{j}^{n}-\\overline{w}^{\\left ( j , n\\right ) } \\right ) ^{2}\\right\\ } = \\mathrm{var}\\left ( \\overline{w}^{\\left ( j , n\\right ) } \\right ) .",
    "\\label{prop_4a}\\ ] ] if , in addition , condition [ cond : mphase ] is satisfied then @xmath182 \\overset{d}{\\rightarrow } n\\left ( 0,v\\right ) .",
    "\\label{prop_4b}\\ ] ]    from proposition [ prop_pl ] , condition [ cond : normal_approx ] is satisfied for @xmath183 .",
    "therefore @xmath184 as @xmath63 @xmath185 .",
    "the result follows from the decomposition @xmath186    condition [ cond : bounded_like ] implies that moments of @xmath187 of all orders exist . then follows from the mutual independence of @xmath188 .",
    "result follows from the mutual independence and asymptotic normality of the @xmath189 terms @xmath190 , and @xmath50 follows from the usual asymptotic expansion of the product in @xmath187 .",
    "note that without condition [ cond : mphase ] , @xmath191and @xmath192 are not independent and so condition [ cond : normal_approx ] does not provide an applicable central limit theorem for the product @xmath193 ( although condition [ cond : normal_approx ] does hold for each @xmath194 @xmath195 individually , as shown in section [ subsec : pl ] ) .",
    "let @xmath196 denote the term in braces in .",
    "proposition [ prop_ml ] motivates the working approximations @xmath197,\\notag \\\\ & & \\log \\left ( \\overline{w}^{\\left ( j , n\\right ) } \\right ) \\overset{\\cdot } { \\thicksim } n\\left [ \\log p\\left ( y_{1:t}\\right ) , \\frac{{\\mathrm{v}\\widehat{\\mathrm{a}}\\mathrm{r}}\\left ( \\overline{w}^{\\left ( j , n\\right ) } \\right ) } { \\left ( \\overline{w}^{(j , n)}\\right ) ^{2}}\\right ] .",
    "\\label{ml_se}\\end{aligned}\\ ] ] standard expansions of @xmath198 and @xmath199 suggest the same asymptotic distribution , and therefore comparison of these values in relation to the working standard error from ( [ ml_se ] ) provides one indication of the adequacy of the asymptotic approximation .",
    "condition [ cond : mphase ] suggests that these normal approximations will be more reliable as more metropolis iterations are undertaken in the algorithm detailed in section [ ss : details ] , and more generally , the more effective is the particle diversity generated by the @xmath103 phase .",
    "the predictive distributions of returns to financial assets are central to the pricing of their derivatives like futures contracts and options .",
    "the literature modeling asset return sequences as stochastic processes is enormous and has been a focus and motivation for bayesian modelling in general and application of sequential monte carlo ( smc ) methods in particular .",
    "one of these models is the exponential generalized autoregressive conditional heteroskedasticity ( egarch ) model introduced by nelson ( 1991 ) .",
    "the example in this section works with a family of extensions developed in durham and geweke ( 2013 ) that is highly competitive with many stochastic volatility models .    in the context of this paper",
    "the egarch model is also of interest because its likelihood function is relatively intractable .",
    "the volatility in the model is the sum of several factors that are exchangeable in the posterior distribution .",
    "the return innovation is a mixture of normal distributions that are also exchangeable in the posterior distribution .",
    "both features are essential to the superior performance of the model ( durham and geweke , 2013 ) .",
    "permutations in the ordering of factors and mixture components induce multimodal distributions in larger samples .",
    "models with these characteristics have been widely used as a drilling ground to assess the performance of simulation approaches to bayesian inference with ill - conditioned posterior distributions ( e.g. , jasra et al . , 2007 ) .",
    "the models studied in this section have up to @xmath200 permutations , and potentially as many local modes . although it would be possible to optimize the algorithm for these characteristics , we intentionally make no efforts to do so . nonetheless , the irregularity of the posteriors turns out to pose no difficulties for the algorithm .",
    "most important , in our view , this example illustrates the potential large savings in development time and intellectual energy afforded by the algorithm presented in this paper compared with other approaches that might be taken .",
    "we believe that other existing approaches , including importance sampling and conventional variants on markov chain monte carlo ( mcmc ) , would be substantially more difficult . at",
    "the very least they would require experimentation with tuning parameters by bayesian statisticians with particular skills in these numerical methods , even after using the approach of geweke ( 2007 ) to deal with dimensions of posterior intractability driven by exchangeable parameters in the posterior distribution .",
    "the algorithm replaces this effort with a systematic updating of the posterior density , thereby releasing the time of investigators for more productive and substantive efforts .      an egarch model for a sequence of asset returns @xmath201 has the form @xmath202 the return disturbance term @xmath203 is distributed as a mixture of @xmath204 normal distributions , @xmath205where @xmath206 is the gaussian density with mean @xmath207 and variance @xmath208 , @xmath209 @xmath210 and @xmath211 .",
    "the parameters of the model are identified by the conditions @xmath212 and @xmath213 ; equivalently , @xmath214 the models are indexed by @xmath215 , the number of volatility factors , and @xmath204 , the number of components in the return disturbance normal mixture , and we refer to the specification ( [ egarch_mod1])([egarch_mod2 ] ) as ` egarch_ki ` .",
    "the original form of the egarch model ( nelson , 1991 ) is  with @xmath216 .",
    "all parameters have gaussian priors with means and standard deviations indicated below ( the prior distribution of @xmath217 is truncated below at @xmath218 ) . indices @xmath219 and @xmath220 take on the values @xmath221 and @xmath222 .    .parameters and prior distributions for the egarch models [ cols=\"^,^,^,^\",options=\"header \" , ]",
    "[ t : rbar ]    table [ t : rbar ] shows the outcome of an exercise exploring the relationship between the number of metropolis iterations undertaken in the @xmath103 phases and the performance of the algorithm .",
    "the first 8 rows of the table use the deterministic @xmath103 phase stopping rule with @xmath143 = 5 , 8 , 13 , 21 , 34 , 55 , 89 and 144 .",
    "the last row of the table , indicated by ` * ' in the @xmath143 field , uses the _",
    "rne_-based stopping rule with @xmath144 , @xmath145 and @xmath223 .",
    "the last column of the table reports a measure of computational performance : precision ( i.e. , @xmath224 ) normalized by computational cost ( time in seconds ) .",
    "the ratio of precision to time is the relevant criterion for comparing two means of increasing numerical accuracy : more steps in the @xmath103 phase versus more particles .",
    "the ratio of precision to time is constant in the latter strategy .",
    "( in fact , on a gpu , it increases up to a point because the gpu works more efficiently with more threads , but the application here with @xmath225 particles achieves full efficiency . ) therefore adding more steps in the @xmath103 phase is the more efficient strategy so long as the ratio of precision to time continues to increase . table [ t : rbar ]",
    "shows that in this example , adding iterations is dominant at @xmath226 and is likely dominant at @xmath227 .",
    "ideally , one would select @xmath143 to maximize the performance measure reported in the last column of the table .",
    "rne_-based stopping rule , shown in the last line of the table , does a good job of automatically picking an appropriate stopping point without requiring any user input or experimentation .",
    "the number of metropolis iterations varies from one @xmath103 phase to the next with this stopping rule , averaging just over 100 in this application .",
    "although the rne - based rule uses fewer metropolis steps overall relative to @xmath227 , total execution time is greater .",
    "this is because the metropolis iterations are more concentrated toward the end of the sample period with the _ rne_-based rule , where they are more computationally costly .",
    "the fact that so many metroplis iterations are needed to get good particle diversity is symptomatic of the extremely irregular posterior densities implied by this model ( we return to this issue in section [ ss : irregular ] ) . for models with posterior densities that are closer to gaussian",
    ", many fewer metropolis iterations will typically be needed .",
    "models for asset returns , like the egarch models considered here , are primarily of interest for their predictive distributions .",
    "we illustrate this application using the three functions of interest @xmath228 introduced in section [ subsec : egarch_performance ] .",
    "moments are evaluated by monte carlo approximation over the posterior distribution of @xmath229 using the particles obtained at time @xmath230 , as described in section [ sec : parpostsims ] .",
    "the last observation of the sample , march 31 , 2010 in this application ( @xmath231 ) , is typically of interest . for illustration , we specify the same date one year earlier , march 31 , 2009 ( @xmath232 ) , as an additional observation of interest .",
    "volatility is much higher on the earlier date than it is on the later date . at each date of interest ,",
    "the @xmath102 phase is terminated ( regardless of the _ rss _ ) and @xmath107 and @xmath103 phases are executed .    ; ( c ) @xmath226 ; ( d ) @xmath227 . ]",
    "figure [ f : rne ] shows _ rne _  for all three test functions @xmath233 at each metropolis iteration of each cycle @xmath104 .",
    "the figure reports results for four different @xmath103 phase stopping rules : the _ rne_-based rule ( with @xmath144 , @xmath145 and @xmath223 ) and the deterministic rule with @xmath143 = 34 , 89 and 144 .",
    "the beginning of each @xmath103 phase is indicated by a vertical line .",
    "the lower axis of each panel indicates the metropolis iteration ( cumulating across cycles ) ; the top axis indicates the observation date @xmath230 at which each @xmath103 phase takes place ; and the left axis indicates _",
    "rne_. for reference , figure [ f : rne ] includes a horizontal line indicating @xmath234 .",
    "this is the default target for the _ rne_-based stopping rule and serves as a convenient benchmark for the other rules as well .    in the early part of the sample ,",
    "the deterministic rules execute many more metropolis steps than needed to achieve the nominal target of @xmath234 . however , these require relatively little time because sample size @xmath230 is small .",
    "as noted above , there is little point in undertaking additional metropolis iterations once _ rne _  approaches one , as happens toward the beginning of the sample for all three deterministic rules shown in the figure .    toward the end of the sample , achieving any fixed _",
    "target in the @xmath103 phase requires more iterations due to the extreme non - gaussianity of the posterior ( see section [ ss : irregular ] for a more detailed discussion of this issue ) .",
    "rne_-based rule adapts automatically , performing iterations only as needed to meet the _ rne _  target , implying more iterations as sample size increases in this application .    at observation @xmath235 ,",
    "november 15 , 1991 , the @xmath102 phase terminates with very low @xmath134 ( regardless of @xmath103 phase stopping rule used ) , the result of a return that is highly unlikely conditional on the model and past history of returns .",
    "the deterministic rules undertake additional metropolis iterations to compensate , as detailed in section 3.3 .",
    "rne_-based rule also requires more iterations than usual to meet the relevant threshold ; but in this case the number of additional iterations undertaken is determined algorithmically .",
    "cccccccccccccccccccc & & & & & & + @xmath143 & compute & e & sd & nse & rne & & e & sd & nse & rne & & e & sd & nse & rne + & time & & & & & & & & & & & & & & +   + 5 & 91 & -37.405 & 0.373 & 0.027 & 0.003 & & 95.877 & 7.254 & 0.513 & 0.003 & & -1.999 & 0.823 & 0.063 & 0.003 + 8 & 127 & -37.388 & 0.390 & 0.029 & 0.003 & & 96.457 & 7.543 & 0.531 & 0.003 & & -2.204 & 0.837 & 0.060 & 0.003 + 13 & 205 & -37.347 & 0.366 & 0.020 & 0.005 & & 97.311 & 7.167 & 0.361 & 0.006 & & -2.348 & 0.774 & 0.034 & 0.008 + 21 & 304 & -37.382 & 0.352 & 0.014 & 0.009 & & 96.767 & 6.938 & 0.255 & 0.011 & & -2.530 & 0.788 & 0.030 & 0.011 + 34 & 482 & -37.339 & 0.349 & 0.011 & 0.015 & & 97.582 & 6.913 & 0.211 & 0.016 & & -2.569 & 0.812 & 0.021 & 0.023 + 55 & 776 & -37.340 & 0.353 & 0.007 & 0.034 & & 97.591 & 6.970 & 0.142 & 0.037 & & -2.563 & 0.811 & 0.011 & 0.079 + 89 & 1245 & -37.330 & 0.364 & 0.006 & 0.055 & & 97.735 & 7.133 & 0.109 & 0.065 & & -2.574 & 0.812 & 0.010 & 0.105 + 144 & 2120 & -37.332 & 0.355 & 0.004 & 0.141 & & 97.743 & 6.996 & 0.066 & 0.172 & & -2.580 & 0.816 & 0.007 & 0.230 + * & 2329 & -37.334 & 0.359 & 0.003 & 0.170 & & 97.687 & 7.037 & 0.063 & 0.192 & & -2.587 & 0.818 & 0.005 & 0.406 +   + 5 & 91 & -50.563 & 0.309 & 0.014 & 0.007 & & 0.596 & 0.253 & 0.013 & 0.006 & & -2.078 & 0.816 & 0.063 & 0.003 + 8 & 127 & -50.514 & 0.309 & 0.011 & 0.012 & & 0.662 & 0.276 & 0.013 & 0.007 & & -2.274 & 0.838 & 0.059 & 0.003 + 13 & 205 & -50.517 & 0.309 & 0.009 & 0.016 & & 0.696 & 0.284 & 0.010 & 0.013 & & -2.425 & 0.771 & 0.033 & 0.008 + 21 & 304 & -50.512 & 0.310 & 0.007 & 0.031 & & 0.736 & 0.295 & 0.008 & 0.021 & & -2.599 & 0.780 & 0.028 & 0.012 + 34 & 482 & -50.492 & 0.309 & 0.006 & 0.044 & & 0.754 & 0.301 & 0.006 & 0.045 & & -2.616 & 0.795 & 0.018 & 0.030 + 55 & 776 & -50.491 & 0.310 & 0.004 & 0.097 & & 0.755 & 0.302 & 0.004 & 0.103 & & -2.610 & 0.797 & 0.010 & 0.093 + 89 & 1245 & -50.482 & 0.315 & 0.003 & 0.164 & & 0.765 & 0.308 & 0.003 & 0.162 & & -2.640 & 0.794 & 0.008 & 0.145 + 144 & 2120 & -50.483 & 0.314 & 0.002 & 0.381 & & 0.765 & 0.308 & 0.002 & 0.240 & & -2.632 & 0.800 & 0.006 & 0.276 + * & 2329 & -50.482 & 0.315 & 0.002 & 0.460 & & 0.769 & 0.307 & 0.002 & 0.588 & & -2.643 & 0.796 & 0.005 & 0.452 +    table [ t : moments ] reports details on the posterior mean approximations for the two dates of interest .",
    "total computation time for running the simulator across the full sample is provided for reference . the last line in each panel , indicated by `",
    "* ' in the @xmath143 field , uses the _",
    "rne_-based stopping rule .",
    "for both dates , the _ nse _  of the approximation declines substantially as @xmath143 increases .",
    "comparison of the compute times reported in table [ t : moments ] again suggests that increasing @xmath143 is more efficient for reducing _",
    "nse_than would be increasing @xmath37 , up to at least @xmath226 .",
    "some bias in the moment approximations is evident with low values of @xmath143 .",
    "the issue is most apparent for the 3% loss probability on march 31 , 2010 .",
    "since volatility is low on that date , the probability of realizing a 3% loss is tiny and arises from tails of the posterior distribution of @xmath229 , which is poorly represented in small samples . for example , with @xmath236 , _ rne _  is 0.013 , implying that each group of size @xmath237 has an effective sample size of only about 13 particles .",
    "there is no evidence of bias for @xmath238 or with the _ rne_-based rule .",
    "plots such as those shown in figure [ f : rne ] provide useful diagnostics and are provided as a standard output of the software .",
    "for example , it is easy to see that with @xmath239 ( panel ( b ) of the figure ) not enough iterations are performed in the @xmath103 phases , resulting in low _ rne _  toward the end of the sample . with lower values of @xmath143",
    "the degradation in performance is yet more dramatic . as @xmath143",
    "is increased to 89 and 144 in panels ( c ) and ( d ) of the figure , respectively , the algorithm is better able to maintain particle diversity through the entire sample .",
    "rne_-based rule does a good job at choosing an appropriate number of iterations in each @xmath103 phase and does so without the need for user input or experimentation .",
    "in the ` egarch_23 ` model there are 2 permutations of the factors @xmath240 and 6 permutations of the components of the normal mixture probability distribution function of @xmath241 .",
    "this presents a severe challenge for single - chain mcmc as discussed by celeux et al .",
    "( 2000 ) and jasra et al .",
    "( 2007 ) , and for similar reasons importance sampling is also problematic .",
    "the problem can be mitigated ( frhwirth - schnatter , 2001 ) or avoided entirely ( geweke , 2007 ) by exploiting the special mirror image  structure of the posterior distribution .",
    "but these models are still interesting as representatives of multimodal and ill - behaved posterior distributions in the context of generic posterior simulators .",
    "we focus here on the 6 permutations of the normal mixture in ` egarch_23 ` .",
    "consider a @xmath242 parameter subvector @xmath243 with three distinct values of the triplets @xmath244 @xmath245 .",
    "there are six distinct ways in which these values could be assigned to components @xmath246 of the normal mixture in the ` egarch_23 ` model .",
    "these permutations define six points @xmath247 @xmath248 . for all sample sizes",
    "@xmath230 , the posterior densities @xmath249 at these six points are identical .",
    "let @xmath250 be a different parameter vector with analogous permutations @xmath251 @xmath252 . as the sample adds evidence @xmath253 or @xmath254 .",
    "thus , a specific triplet set of triplets @xmath255 @xmath256 and its permutations will emerge as pseudo - true values of the parameters ( geweke , 2005 , section 3.4 ) .     from selected posterior distributions conditional on @xmath157 ( @xmath257 , @xmath258 , @xmath259 , @xmath260 , @xmath239 ) .",
    "]    the marginal distributions will exhibit these properties as well .",
    "consider the pair @xmath261 , which is the case portrayed in figure [ egarch_multimodal_sigma ] .",
    "the scatterplot is symmetric about the axis @xmath262 in all cases . as sample size",
    "@xmath230 increases six distinct and symmetric modes in the distribution gradually emerge .",
    "these reflect the full marginal posterior distribution for the normal mixture components of the ` egarch_23 ` model ( i.e. , marginalizing on all other parameters ) that is roughly centered on the components @xmath263 , @xmath264 and @xmath265 .",
    "the progressive decrease in entropy with increasing @xmath230 illustrates how the algorithm copes with ill - behaved posterior distributions .",
    "particles gradually migrate toward concentrations governed by the evidence in the sample .",
    "unlike mcmc there is no need for particles to migrate between modes , and unlike importance sampling there is no need to sample over regions eliminated by the data ( on the one hand ) or to attempt to construct multimodal source distributions ( on the other ) .",
    "similar phenomena are also evident for the other mixture parameters as well as for the parameters of the garch factors .",
    "the algorithm proposed in this paper adapts to these situations without specific intervention on a case - by - case basis .      to benchmark the performance of the algorithm against a more conventional approach",
    ", we constructed a straightforward metropolis random walk mcmc algorithm , implemented in c code on a recent vintage cpu using the ` egarch_23 ` model .",
    "the variance matrix was tuned manually based on preliminary simulations , which required several hours of investigator time and computing time .",
    "the algorithm required 12,947 seconds for 500,000 iterations .",
    "the numerical approximation of the moment of interest @xmath266 $ ] for march 31 , 2010 , the same one addressed in table [ t : moments ] , produced the result @xmath267 and a _ nse_of @xmath268 . taking the square of _ nse _  to be inversely proportional to the number of mcmc iterations , an _",
    "nse _  of @xmath269 ( the result for the _ rne_-based stopping rule in table [ t : moments ] ) would require about 1,840,000 iterations and 47,600 seconds computing time .",
    "thus posterior simulation for the full sample would require about 20 times as long using random walk metropolis in a conventional serial computing environment .",
    "although straightforward , this analysis severely understates the advantage of the sequential posterior simulator developed in this paper relative to conventional approaches .",
    "the mcmc simulator does not traverse all six mirror images of the posterior density .",
    "this fact greatly complicates attempts to recover marginal likelihood from the mcmc simulator output ; see celeux et al .",
    "( 2000 ) . to our knowledge",
    "the only reliable way to attack this problem using mcmc is to compute predictive likelihoods from the prior distribution and the posterior densities @xmath270 @xmath271 . recalling that @xmath272 , and taking computation time to be proportional to sample size ( actually , it is somewhat greater ) yields a time requirement of @xmath273 seconds ( 2.28 cpu years ) , which is almost 100,000 times as long as was required in the algorithm and implementation used here .",
    "unless the function of interest @xmath274 is invariant to label switching ( geweke , 2007 ) , the mcmc simulator must traverse all the mirror images with nearly equal frequency .",
    "as argued in celeux et al .",
    "( 2000 ) , for all practical purposes this condition can not be met with any reliability even with a simulator executed for several cpu centuries .",
    "this example shows that simple speedup factors  may not be useful in quantifying the reduction in computing time afforded by massively parallel computing environments . for the scope of models set in this work  that is , those satisfying conditions [ cond : prior_evaluate ] through [ cond : prior_var]sequential posterior simulation is much faster than posterior simulation in conventional serial computing environments",
    "this is a lower bound .",
    "there are a number of routine and reasonable objectives of posterior simulation , like those described in this section , that simply can not be achieved at all with serial computing but are fast and effortless with smc .",
    "most important , sequential posterior simulation in a massively parallel computing environment conserves the time , energy and talents of the investigator for more substantive tasks .",
    "recent innovations in parallel computing hardware and associated software provide the opportunity for dramatic increases in the speed and accuracy of posterior simulation .",
    "widely used mcmc simulators are not generically well - suited to this environment , whereas alternative approaches like importance sampling are .",
    "the sequential posterior simulator developed here has attractive properties in this context : inherent adaptability to new models ; computational efficiency relative to alternatives ; accurate approximation of marginal and predictive likelihoods ; reliable and well - grounded measures of numerical accuracy ; robustness to irregular posteriors ; and a well - developed theoretical foundation . establishing these properties",
    "required a number of contributions to the literature , summarized in section 1 and then developed in sections 2 , 3 and 4 .",
    "section 5 provided an application to a state - of - the - art model illustrating the properties of the simulator .",
    "the methods set forth in the paper reduce computing time dramatically in a parallel computing environment that is well within the means of academic investigators .",
    "relevant comparisons with conventional serial computing environments entail different algorithms , one for each environment .",
    "moreover , the same approximation may be relatively more advantageous in one environment than the other .",
    "this precludes generic conclusions about speed - up factors .  in the example in section [ sec : application ] , for a simple posterior moment ,",
    "the algorithm detailed in section [ ss : details ] was nearly 10 times faster than a competing random - walk metropolis simulator in a conventional serial computing environment . for predictive likelihoods and marginal likelihood it was 100,000 times faster .",
    "the parallel computations used a single graphics processing unit ( gpu ) . up to eight gpu s can be added to a standard desktop computer at a cost ranging from about $ 350 ( us ) for a mid - range card to about $ 2000 ( us ) for a high - performance tesla card .",
    "computation time is inversely proportional to the number of gpu s .",
    "these contributions address initial items on the research agenda opened up by the prospect of massively parallel computing environments for posterior simulation . in the near term it should be possible to improve on the specific contribution made here in the form of the algorithm detailed in section [ ss : details ] .",
    "looking forward on the research agenda , a major component is extending the class of models for which generic sequential posterior simulation will prove practical and reliable .",
    "large - scale hierarchical models , longitudinal data , and conditional data density evaluations that must be simulated all pose fertile ground for future work .",
    "the research reported here has been guided by two paramount objectives .",
    "one is to provide methods that are generic and minimize the demand for knowledge and effort on the part of applied statisticians who , in turn , seek primarily to develop and apply new models .",
    "the other is to provide methods that have a firm methodological foundation whose relevance is borne out in subsequent applications .",
    "it seems to us important that these objectives should be central in the research agenda .",
    "baker je ( 1985 ) .",
    "adaptive selection methods for genetic algorithms . in grefenstette j ( ed . ) , proceedings of the international conference on genetic algorithms and their applications , 101111 .",
    "malwah nj : erlbaum .",
    "chopin n , jacob p ( 2010 ) .",
    "free energy sequential monte carlo , application to mixture modelling . in : bernardo jm , bayarri mj , berger jo , dawid ap , heckerman d , smith afm , west m ( eds . ) , bayesian statistics 9 .",
    "oxford : oxford university press .",
    "chopin n , jacob pi , papaspiliopoulis o ( 2011 ) .",
    "smc@xmath275 : a sequential monte carlo algorithm with particle markov chain monte carlo updates . working paper .",
    "geweke j , durham g , xu h ( 2013 ) .",
    "bayesian inference for logistic regression models using sequential posterior simulation .",
    "lee l , yau c , giles mb , doucet a , homes cc ( 2010 ) . on the utility of graphics cards to perform massively parallel simulation of advanced monte carlo methods .",
    "journal of computational and graphical statistics 19 : 769789 .",
    "mcgrayne shb ( 2011 ) .",
    "the theory that would not die : how bayes rule cracked the enigma code , hunted down russian submarines , and emerged triumphant from two centuries of controversy .",
    "new haven : yale university press .",
    "souchard ma , wang q , chan c , frelinger j , cron a , west m ( 2010 ) .",
    "understanding gpu programming for statistical computation : studies in massively parallel massive mixtures .",
    "journal of computational graphics and statistics 19 : 419438 ."
  ],
  "abstract_text": [
    "<S> massively parallel desktop computing capabilities now well within the reach of individual academics modify the environment for posterior simulation in fundamental and potentially quite advantageous ways .   but to fully exploit these benefits algorithms that conform to parallel computing environments are needed . </S>",
    "<S> sequential monte carlo comes very close to this ideal whereas other approaches like markov chain monte carlo do not . </S>",
    "<S> this paper presents a sequential posterior simulator well suited to this computing environment . </S>",
    "<S> the simulator makes fewer analytical and programming demands on investigators , and is faster , more reliable and more complete than conventional posterior simulators . </S>",
    "<S> the paper extends existing sequential monte carlo methods and theory to provide a thorough and practical foundation for sequential posterior simulation that is well suited to massively parallel computing environments .   </S>",
    "<S> it provides detailed recommendations on implementation , yielding an algorithm that requires only code for simulation from the prior and evaluation of prior and data densities and works well in a variety of applications representative of serious empirical work in economics and finance . </S>",
    "<S> the algorithm is robust to pathological posterior distributions , generates accurate marginal likelihood approximations , and provides estimates of numerical standard error and relative numerical efficiency intrinsically . </S>",
    "<S> the paper concludes with an application that illustrates the potential of these simulators for applied bayesian inference .    </S>",
    "<S> keywords : graphics processing unit ; particle filter ; posterior simulation ; sequential monte carlo ; single instruction multiple data    jel classification : primary , c11 ; secondary , c630 . </S>"
  ]
}