{
  "article_text": [
    "financial derivatives ( also known as contingent claims ) are now a ubiquitous tool in risk management with approximately 600 trillion dollars worth of such contracts currently in the market .",
    "the pricing of such derivatives is therefore an active area of research in both mathematics and finance ( see for example @xcite and the references therein ) . in this paper",
    ", we will apply the perturbative ( asymptotic ) method introduced in @xcite for numerically solving parabolic equations and then use this method to price european options .",
    "one of the earliest models used in pricing derivatives is the black - scholes - merton model @xcite , for which the movement in the price @xmath0 of the underlying asset on which the claim is based is modeled by geometric brownian motion . for the black - scholes - merton as well as for other models given by stochastic differential equations",
    ", the pricing of european options can be reduced to the calculation of certain solutions of parabolic equations , obtained through ito s lemma ( and the change of variables @xmath1 ) in the backward kolmogorov equation .",
    "the resulting equation is a fokker - planck equation , which is an equation of parabolic type .",
    "fokker - planck equations more generally have important applications in statistical mechanics and in probability ( see for example the monographs @xcite ) .",
    "given that the asset price is always assumed positive , the fokker - planck equation is solved on the positive half - line .",
    "one difficulty in treating this type of the equation is that the coefficients of the fokker ",
    "planck operator typically vanish at the boundary , making the equation degenerate .    for example , for the black - scholes - merton model",
    ", the resulting fokker - planck equation is given by @xmath2 where @xmath3 is the _ black - scholes operator _",
    ", a degenerate elliptic operator , @xmath4 is the time to expiry , and @xmath5 is the so - called _ pay - off _ function . for a _",
    "european call option with strike @xmath6 _ and expiry ( or exercice ) date @xmath7 , the pay - off function @xmath5 is given by the formula @xmath8 , where @xmath9 is the price of the underlying asset at time @xmath7 .",
    "above , @xmath10 and @xmath11 are constant parameters , representing respectively the _ volatility _ of the underlying asset , and the current _",
    "interest rate_. since the operator is degenerate at the boundary @xmath12 , it can be shown that the solution automatically vanishes there and no explicit boundary condition need to be imposed .",
    "a popular model related to the black - scholes - merton model is the cev model @xcite . in the cev model ,",
    "the operator @xmath13 is the form @xmath14 where @xmath10 , @xmath15 , @xmath11 are constant .",
    "yet another popular model is dupire s local volatility model , for which we allow the volatility to change with time : @xmath16    except in special cases , such as the black - scholes - merton equation above and when @xmath13 has constant coefficients , very few exact solution formulas to the problem are available .",
    "it is therefore important to devise fast , accurate approximate solution methods .",
    "the focus of this paper is on obtaining approximate solution methods that are fast and accurate by combining standard numerical methods with the asymptotic techniques developped in @xcite .",
    "fast solution methods are crucial when calibrating unknown parameters , especially in the baeysian inference framework .",
    "we hope to address this question in a forthcoming paper .    in view of the above discussion , it is justified to study the forward initial - value problem for the general case when @xmath13 is an operator of the form : @xmath17 we therefore allow for _ variable _ coefficients _ in both space and time_. we assume throughout that @xmath18 , for @xmath19 and that the coefficients @xmath20 , @xmath21 , @xmath22 are smooth functions .",
    "the perturbative method introduced in @xcite for the study of parabolic equations in arbitrary dimensions was fully justified in the case when @xmath20 , @xmath21 , and @xmath22 and all their derivatives are bounded , and are bounded away from zero :  @xmath23 . in this paper",
    "we complete the results of @xcite with explicit formulas for the 1d case .",
    "then we numerically test our formulas for the black - scholes - merton and cev models , obtaining an excellent agreement between our theoretical results and the numerical tests .",
    "both the black - scholes - merton model and and the cev model are more general than the models considered in @xcite in that their coefficients do not satisfy the assumptions of the paper , yet the numerical tests indicates that the results of that paper are still valid for the more general models considered here .",
    "this observation suggests that the theoretical framework of @xcite is applicable in greater generality .",
    "we plan to study this point in a forthcoming paper .",
    "to explain our method , let us recall that , under certain conditions on the operator @xmath13 and initial value @xmath5 , described in details in the next section , there exists a _",
    "smooth function _",
    "@xmath24 such that the solution to has the representation @xmath25 the kernel function @xmath24 in is the fundamental solution or the so - called _ green function _ for the problem .",
    "[ rem.kernel ] given that @xmath24 arises in several different contexts , we will call the function @xmath24 the _ transition density kernel , pricing kernel , heat kernel _ , or _",
    "green function _ interchangeably , depending on the context in which the object arises .    as mentioned above , except for some very special cases no explicit formulas for @xmath24 or @xmath26 are available . for the black - scholes - merton model ,",
    "a change of variables reduces the pde to a heat equation that can then be solved explicitly .",
    "therefore , exact formulas for the kernel @xmath27 and the solution @xmath28 exist , which we recall now for further reference : @xmath29 where @xmath30 is the cumulative normal distribution function ( cumulative gaussian distribution function ) and @xmath31 however , for the time - dependent black - scholes - merton model , where @xmath10 and @xmath11 are time - dependent , or local volatility models in general , closed form solutions are generally given by series expansions and difficult to use in practice or are not known ( see , for instance , @xcite ) .",
    "the method that we use in this paper is to give an approximate closed - form solution for the equation by giving an approximate closed - form expansion for the green s function @xmath24 .",
    "since our approximation of the green s function is in terms of gaussian - type integrals , it gives a closed - form for the approximate price of a european call option for _ any _ one - dimensional model where the operator @xmath13 is given by .",
    "in fact , as an application , we give the prices and greeks ( that is , suitable derivatives ) of a european call option and perform an error analysis in section [ sec.error ] .",
    "there exists a vast literature on obtaining asymptotic expansions of the green s function @xmath24 when @xmath4 small and @xmath32 is close to @xmath33 , especially in the case that @xmath13 is independent of time @xcite .",
    "( see also @xcite ) .",
    "many of these methods are based on a geometric interpretation of the operator @xmath13 ( or at least its principal part ) as a laplace operator on curved space , and require computing the geodesics in this space , which very often must be done numerically .",
    "other approaches are based on pseudo - differential calculus .",
    "in particular , corielli , foschi , and pascucci @xcite use a _ parametrix _ construction for the problem to obtain a closed - form approximate solution .",
    "we recently developed in @xcite a complementary approach to computing short - time asymptotics for @xmath34 , based on parabolic rescaling , taylor s expansions of the coefficients , duhamel s and dyson s formulas , and exact commutator expansion .",
    "we called this method the _ dyson - taylor commutator method_. our method is more elementary and appears very stable in practical implementations .",
    "let us fix a function @xmath35 with the properties that @xmath36 and all its derivatives are bounded .",
    "the function @xmath37 will represent the _ basepoint _ for a parabolic rescaling of the green s function .",
    "then our short - time asymptotics give an expansion for the kernel in the form : @xmath38}(x , y;z ) + t^{(n+1)/2 }    { { \\mathcal e}}_t^{[n]}(x , y ; z ) \\\\    { { \\mathcal g}}_t^{[n]}(x , y;z ) & = g_t^{[0]}(x , y ; z ) + t^{1/2 }    g_t^{[1]}(x , y ; z ) + \\cdots + t^{n/2 } g^{[n]}_t(x , y ; z ) , \\\\ \\end{split}\\end{aligned}\\ ] ] where @xmath39}$ ] is the sum on the first @xmath40 terms of the expansion and represents the @xmath40-th order approximate kernel , while @xmath41}$ ] is the remainder .",
    "the first term , @xmath42}$ ] is given by a dilated gaussian function @xmath43}(x , y ) =    g_{t}^{[0]}(x - y ) =    \\frac{1}{\\sqrt{2 t \\pi a(0,z)^2 } } \\exp ( - \\frac{|x - y|^2}{2 t a(0,z)^2}).\\ ] ] the dyson - taylor commutator method  yelds an explicit algorithm to compute the terms @xmath44}$ ] for _ any _",
    "@xmath40 , if @xmath13 is an operator of the form and corresponding analogs in higher dimension .",
    "more precisely , our main result in @xcite is that for the local volatility operator , the @xmath40-th order approximate kernel has the form    @xmath45}(x , y ) : = t^{-1/2 }     \\mathfrak{p}^k(\\,z , \\,z+\\ , \\frac{x - z}{t^{1/2}}\\ , ,     \\,\\frac{x - y}{t^{1/2}}\\ , ) g^{[0]}_t (    \\,\\frac{x - y}{t^{1/2}}\\,),\\ ] ]    where the functions @xmath46 are algorithmically computable ( recall that @xmath47 ) . in this paper",
    "we shall compute the functions @xmath48 , for @xmath49 at an _ arbitrary _ basepoint @xmath37 .",
    "the details , based on the dyson - taylor commutator method  method , can be found in section [ sec.framework ] and [ sec.basepoints ] .",
    "we therefore obtain _ new _ closed form asymptotic expansions of the green function for local volatility models .",
    "in particular , the first order asymptotic expansion at arbitrary @xmath47 is given by @xmath50}(x , y;z ) = \\frac{1}{\\sqrt{2 \\pi\\ , t\\ , a(0,z)^2 } } \\left [ 1      + \\frac{3 a(0,z ) a ' ( 0,z ) - 2 b(0,z ) } { 2 a(0,z)^2 } ( x - y )      \\right .",
    "\\\\      \\left .",
    "- \\frac{a'(0,z)}{2 t\\ , a(0,z)^3}(x - y)^3 + ( x - z )      \\frac{(x - y)^2 - t\\,a(0,z)^2}{t\\ , a(0,z)^3 } \\right ]    e^ { - \\frac{|x - y|^2}{2 t\\ , a(0,z)^2}. } \\end{gathered}\\ ] ] we provide an explicit formula for the second order expansion of the green function at the end of section [ sec.framework ] .",
    "this algorithm can be implemented very efficiently at least in dimension 1 and for @xmath40 small , @xmath51 , @xmath52 .",
    "the numerical tests in section [ sec.error ] show that already the second - order approximation is adequate for the black - scholes and cev models .    for each term @xmath53}$ ] in the expansion of the green function , let @xmath54}$ ] denote the corresponding term in the expansion of the solution , @xmath55}(t , x ) = \\int_0^\\infty g_t^{[k]}(x , y ) h(y;k)dy.\\end{aligned}\\ ] ] then using and , we arrive at the expansion of the value of the contingent claim ,    @xmath56}(t , x ) + t^{(n+1)/2}{\\mathfrak e}^{[n]}(t , x ) \\\\ &    u^{[n]}(t , x ) = { { \\mathcal u}}^{[0]}(t , x ) + t^{1/2 } { { \\mathcal u}}^{[1]}(t , x ) + t    { { \\mathcal u}}^{[2]}(t , x ) + \\cdots t^{n/2 } { { \\mathcal u}}^{[n]}(t , x )    \\end{split}\\end{aligned}\\ ] ]    where @xmath57}(t , x ) : = t^{(n+1)/2}\\int_0^\\infty    { { \\mathcal e}}_t ^{[n]}h(y;k ) = u(t , x ) - u^{[n]}(t , x)\\end{aligned}\\ ] ]    is the remainder term ( or error ) in the expansion of the solution . in @xcite",
    "we have shown that the remainder can be controlled in exponentially weighted sobolev norms , when the operator @xmath13 is uniformly strongly elliptic .",
    "these bounds on the remainder imply that , in this case , the error made by replacing @xmath34 with @xmath58}_t$ ] in is of order @xmath59 _ globally _ in space , the expected optimal rate . in @xcite , we consider degenerate operators , the symbol of which is strongly elliptic with respect to some complete metric of bounded geometry .",
    "for example , the black - scholes and the sabr models fit into this framework .",
    "by contrast , the cev model with @xmath60 does not fit into this framework .",
    "our numerical tests indicate nevertheless that the error term has the same order in @xmath4 even for the cev model with @xmath61 . for pedagogical purposes and error analysis we will list all the details for the time - dependent black - scholes and cev models , although our results are more general .    in section [ sec.error ] we perform a numerical error analysis by computing both the numerical solution @xmath62 and expansion @xmath63}$ ] and estimating the error @xmath64}(t , x ) |\\end{aligned}\\ ] ] pointwise for the basepoint @xmath65 , when @xmath66 .",
    "the error analysis is in good agreement with the theoretical results , even though the local volatility operators considered in this paper do not necessarily satisfy the assumptions on the coefficients of @xmath13 needed to establish the analytic error estimates performed in @xcite .    in section [ sec.error ]",
    "we then perform an error analysis . for the black - scholes - merton model ,",
    "for which an exact solution formula is readily available , we compare the expansions at the basepoint @xmath65 with the exact solution .",
    "( note however , that numerical errors arise also in the calculation of exact solutions , due to round - off errors and other approximations . ) for the cev model , we compare the expansions with benchmark formulas in the literature , in particular the hagan - woodward implied volatility approximation @xcite .",
    "given that the kernel approximation is asymptotic in time , it guarantees good error control _ a piori _ only for sufficiently small @xmath4 . in section [ bootstrap ] , we shall introduce a bootstrap scheme to extend our method to arbitrary large time .",
    "this strategy is based on the evolutionary property of the solution operator to . by doing so ,",
    "we show that the error is remarkedly reduced . as an application in portfolio management",
    ", we also compute the greeks ( or hedging parameters ) of a european call option and compare our approximations with the true black - scholes greeks in section [ greeks ] and section [ bootstrap ] .",
    "these applications again underline the accuracy of our methods .",
    "the authors would like to thank marco avellaneda for valuable suggestions and comments on the manuscript , and jim gatheral for useful discussions .",
    "victor nistor also gladly acknowledges support from the max planck institute for mathematics , where part of this work has been performed .",
    "we begin by recalling the dyson - taylor commutator method , which we introduced in @xcite , to obtain small - time asymptotic expansions for the solution of the initial - value problem : @xmath67 throughout the paper , the operator @xmath13 will be given by , and we will omit the explicit dependence of @xmath13 and of its coefficients on @xmath32 .",
    "in addition , we tacitly assume that all the coefficients of @xmath13 are regular enough to carry our the manipulations described next . for",
    "a rigorous justification in the case @xmath13 is not degenerate , we refer to @xcite .",
    "if there is a unique solution to the initial - value problem , then the linear operator that maps the initial data @xmath5 to the solution @xmath62 is well defined .",
    "we refer to such operator as the _ solution operator_. for constant - coefficient second - order operators , @xmath68 , the solution operator forms a _ semigroup _ , denoted by @xmath69 , @xmath70 ; that is , the solution operator has the following properties :    1 .",
    "2 .   @xmath72 , @xmath73 .",
    "[ i.semigroup2 ]    the same conclusion hold for variable - coefficient , but time - independet operators @xmath13 , under some conditions , for instance if @xmath13 is strongly elliptic @xcite ( that is , @xmath74 for all @xmath32 ) . when @xmath13 is a time - dependent operator , @xmath75 , the solution operator is no more a semigroup , but under some additional mild conditions , forms an _ evolution system _",
    "@xmath76 @xcite . for an evolution system , property ( [ i.semigroup2 ] ) is replaced by  @xmath77 , if @xmath78 . following the notation set forth in the introduction",
    ", we denote the kernel or green s function of the solution operator to the problem by @xmath79 .",
    "our method relies heavily on the study of distribution kernels of the evolution operators defined by our fokker - planck operator , so a brief discussion of distribution kernels and of our conventions is in order .",
    "[ rem.genkerneldef ] given a linear operator @xmath7 mapping smooth functions with compact support into distributions , there exist a _",
    "distribution kernel _",
    "@xmath80 such that @xmath81 the integral above is interpreted as the pairing between test functions and distributions . in this paper , we will be interested in the integral representation in the case that @xmath7 is a _ smoothing _ operator , that is , an operator that maps compactly supported distributions into smooth functions .",
    "then , the kernel @xmath80 is a _",
    "smooth function _ , and the notation @xmath82 is justified pointwise .",
    "( for a more detailed dicussion , see for example @xcite . ) in this case , we will write @xmath83 to denote the kernel @xmath82 , and in general , _ we shall identify an operator with its distribution kernel_. let @xmath84 be a smooth function , then we denote the operators of multiplication by @xmath84 also with @xmath84 .",
    "additonally , we notice that there is no confusion when writing @xmath85 or @xmath86 since the distribution kernels of these operators are given by @xmath87 or @xmath88 .",
    "similarly , there is no confusion when writing @xmath89 , since the distribution kernel of @xmath90 is @xmath91 .",
    "however @xmath92 .",
    "we now introduce parabolic rescaling , which is a basic tool used in this paper .",
    "let @xmath37 be a fixed , but arbitrary point in @xmath93 and @xmath94 a parameter . given a function @xmath95 we denote by @xmath96 the _ parabolic rescaling by @xmath97 of the function @xmath84 about @xmath98_. thus @xmath99 for a function that does not depend on @xmath4 .",
    "we will refer to @xmath37 as the _ basepoint _ for the rescaling .",
    "similarly , we define a rescaled operator @xmath100 by @xmath101 if @xmath62 solves the initial - value problem , then @xmath102 solves the rescaled problem @xmath103 consequently , the green functions of the operator @xmath104 and of the rescaled operator @xmath105 are related by @xmath106    we now proceed to compute the green s function @xmath107 of the rescaled problem when @xmath108 . in order to do so",
    ", we shall consider the taylor expansion in @xmath97 at @xmath109 of the rescaled operator @xmath100 , given in equation , up to order @xmath40 . by `` taylor expansion '' we mean that we taylor expand the coefficients of @xmath100 and group all terms of the same order in @xmath97 .",
    "the operator @xmath100 can then be written as follows @xmath110 where @xmath111 contains all the remainder terms from the taylor expansion of the coefficients .    in this paper , we concentrate on calculating explicitly the second - order approximation of the green function of @xmath13 .",
    "hence , _ we fix @xmath52 from now on_. for notational convenience , we denote @xmath112 and @xmath113 . then the second - order taylor expansion in @xmath97 of @xmath114 at @xmath109 is given by @xmath115 with @xmath116 the remainder . below @xmath117 and",
    "all the other functions are to be evaluated at @xmath98 , unless stated otherwise .",
    "we then readily have the second order taylor expansion of @xmath100 in @xmath97 at @xmath109 : @xmath118 and , @xmath119 , where @xmath120 hence @xmath121 where @xmath122 is the remainder term .",
    "[ remark.1 ] each @xmath123 in has polynomial coefficients of order @xmath124 in @xmath125 and of order @xmath126 in @xmath4 .",
    "in particular , @xmath127 is a constant coefficient operator , for which the green s function is computed explicitly in .",
    "thus , in order for the expansion to capture the time dependence of the coefficients , the coefficient must be expanded at least to second order in @xmath97 .",
    "time - dependent corrections will therefore appear only at order @xmath128 in the expansion of @xmath129 .",
    "let @xmath130 be the green function of the parabolic problem , that is , the solution is given by  @xmath131 .",
    "we begin the approximation scheme for @xmath79 by decomposing @xmath13 into a constant - coefficient , second - order operator @xmath68 , for which we can explicitly compute the solution operator , and a remainder : @xmath132 where @xmath133 is a time - dependent , variable coefficient , second order operator .    by duhamel",
    "s principle we then have @xmath134 repeated applications of duhamel s formula leads to a recursive representation of @xmath130 as a time - ordered expansion : @xmath135 where , for notational convenience , we have set @xmath136",
    ". this expansion can be rigorously justified , at least in the case when @xmath13 uniformly strongly elliptic and all the coefficients of @xmath13 and their derivatives are bounded .",
    "see @xcite for details . in the limit @xmath137",
    ", it yields an asymptotic time - ordered series , also called a _",
    "dyson series _",
    ", for the green s function .",
    "the integer @xmath138 stands for the _ iteration level _ in the time - ordered expansion , which at this point is distinct from the order @xmath40 of the taylor expansion of the operator @xmath13 . for consistency",
    "we need @xmath139 @xcite . _",
    "we set from now on @xmath140 .",
    "_    a similar formula holds for the green s function @xmath141 of the solution operator for the rescaled problem .",
    "we recall that it is enough to compute an approximate green s function at @xmath142 for the rescaled problem by .",
    "we now choose the operator @xmath68 to be exactly the zeroth - order taylor expansion of @xmath100 , given in .",
    "then : @xmath143 and using with @xmath140 and @xmath108 yields @xmath144 where @xmath145 even though we set @xmath142 , we still keep the @xmath4 dependence explicit in @xmath146 to emphasize this term comes from taylor expansion in @xmath4 .",
    "the term @xmath147 in contains all the higher order terms and will be included in the remainder .",
    "the approximation for the green s function @xmath79 of the original problem is now obtained as follows .",
    "let @xmath148 be the distribution kernel of the operator @xmath149 .",
    "the desired second order approximation is then given by @xmath150}(x ,",
    "y ) = t^{-1/2 } t^{\\sqrt{t},z}(z + ( x - z)/\\sqrt{t } , z +    ( y - z)/\\sqrt{t}),\\ ] ] where @xmath47 is an admissible function . in particular , the kernels @xmath151}_t$ ] appearing in are given by @xmath152}_t ( x , y ) : = t^{-1/2 } g_{n}(z + ( x - z)/\\sqrt{t } , z +    ( y - z)/\\sqrt{t } ; z(x , y)).\\ ] ]    we thus need to compute the distribution kernels of the operators @xmath153 , @xmath154 , @xmath155 , @xmath156 , @xmath146 . in order to do so , we exploit the semigroup property of @xmath157 to carry out explicitly the time integration in . before we proceed",
    ", we introduce some useful notation .    by @xmath158:=t_1 t_2 - t_2 t_1 = - [ t_2 , t_1]$ ]",
    "we shall denote the commutator of two operators @xmath159 and @xmath160 .",
    "two operators @xmath161 commute if @xmath158 = 0.$ ] for any two operators @xmath159 and @xmath160 , we define @xmath162 by @xmath163,$ ] and , for any integer @xmath164 , we define @xmath165 recursively by @xmath166    we next recall a baker - campbell - hausdorff - type identity proved and used in this setting in @xcite ( note that the operators @xmath167 are unbounded ) . namely , for any @xmath168 and differential operator @xmath169 with _ polynomials coefficients _ in @xmath32 , we have @xmath170 where @xmath171 is a differential operator with polynomial coefficients in @xmath32 given by @xmath172 in proving this formula , we use the fact that the series is actually a finite sum , as we show below . in particular , @xmath173 can be _ explicitly _ computed .    a simple calculation gives the following lemma .",
    "[ lemma.f.comm ] let @xmath174 be a second - order differential operator with polynomial coefficients of degree at most @xmath175 .",
    "then @xmath176 for @xmath177 .",
    "in particular , we have @xmath178 = 0 $ ] , @xmath179 , and @xmath180 .",
    "the proof is a simple calculation .",
    "we now proceed to compute the integrals in @xmath181)e^{l_0^{z}}d{\\tau}_1\\\\ & = & ( l_1^{z}+\\frac{1}{2}[l_0^{z},l_1^{z}])e^{l_0^{z}},\\\\\\end{aligned}\\ ] ] @xmath182)(l_1^{z}+        ( 1-{\\tau}_2 ) [ l_0^{z},l_1^{z}])e^{l_0^{z}}d\\tau_2 d { \\tau}_1 , \\\\          & = & ( \\frac{1}{2 } ( l_1^{z})^2 +          \\frac{1}{3 } l_1^{z}[l_0^{z},l_1^{z } ] +          \\frac{1}{6}[l_0^{z},l_1^{z}]l_1^{z } +          \\frac{1}{8}[l_0^{z},l_1^{z}]^2)e^{l_0^{z}},\\\\\\end{aligned}\\ ] ] @xmath183+\\frac{(1-{\\tau}_1)^2}{2}[l_0^{z},[l_0^{z},l_{2,x}^{z } ]       ] ) e^{l_0^{z}}d{\\tau}\\\\ & = & \\big ( l_{2,x}^{z } + \\frac{1}{2}[l_0^{z},l_{2,x}^{z } ] +      \\frac{1}{6}[l_0^{z},[l_0^{z},l_{2,x}^{z } ] ]   \\big ) e^{l_0^{z } } , \\\\\\end{aligned}\\ ] ] @xmath184 hence becomes @xmath185 where @xmath186 , \\\\    q_2   = \\frac{1}{2 } ( l_1^{z})^2 +   \\frac{1}{3 } l_1^{z}[l_0^{z } , l_1^{z } ] +    \\frac{1}{6 } [ l_0^{z } , l_1^{z } ] l_1^{z } + \\frac{1}{8 } [ l_0^{z } ,   l_1^{z}]^2 , \\\\",
    "+ l_{2,x}^{z } + \\frac{1}{2 } [ l_0^{z } , l_{2 , x}^{z } ] + \\frac{1}{6 }    [ l_0^{z } , [ l_0^{z } , l_{2 , x}^{z } ] ] + \\frac{1}{2 } l_{2,t}^{z } , \\end{gathered}\\ ] ] and @xmath147 is again the error term as in .",
    "therefore , we only need to compute the commutators in the above formula to get the second - order approximation of @xmath187 .",
    "we recall that we agreed that all functions in the commutator formulas below are evaluated at @xmath98 .",
    "hence @xmath117 , @xmath188 , and so on .",
    "we have @xmath189 = a(0,z)^3 a ' ( 0,z ) \\partial_x^3 = a^3   a'\\partial_x^3 , \\quad [ l_0^{z},l_1^{z}]^2 = a^6 { a'{}^2}\\partial_x^6,\\ ] ] and hence @xmath190 & = a^4 { a'{}^2}(x - z ) \\partial_x^5 + b a^3   a ' \\partial_x^4 , \\\\   [ l_0^{z},l_1^{z}]l_1^{z } & = a^4 { a'{}^2}(x - z)\\partial_x^5 + \\left ( b +   3 aa ' \\right ) a^3 a ' \\partial_x^4 . \\end{split}\\end{aligned}\\ ] ]    to compute the other commutators , we need the following lemma , which can be proved by induction using that @xmath191 = a[b , c ] + [ a , c]b$ ]",
    ". in particular ,  @xmath192 = 2 \\partial_x$ ] and @xmath193 = 2 + 4(x - z)\\partial_x$ ] .    for @xmath194 integers we have @xmath195",
    "we therefore have : @xmath196 & = a^2 \\left ( { a'{}^2}+ a { a'{}'}\\right)(x - z ) \\partial_x^3 , \\\\   & + a^2 \\left ( b ' + { a'{}^2}/2 + a { a'{}'}/2 \\right ) \\partial_x^2 , \\end{split}\\end{aligned}\\ ] ] and hence @xmath197 = a^4 ( { a'{}^2}+ a { a ' { } ' } ) ,   \\partial_x^4,\\ ] ] so that finally @xmath198    it follows that the approximation kernel of @xmath199 is given by the applications of a differential operator with polynomial coefficients to the green s function of @xmath157 .",
    "if @xmath200 is a smooth function , we denote by   @xmath201  the convolution operator with @xmath200 , then  @xmath202 , which shows that the distribution kernel of  @xmath203 is @xmath204 .",
    "it is immediate to check that @xmath205 while  @xmath206 . by remark [ remark.1 ] ,",
    "the distribution kernel of @xmath153 is given by @xmath207 and hence @xmath153 is a convolution operator .",
    "then , by  @xmath208 , where  @xmath209 and  @xmath210 are the ( rescaled hermite ) polynomials satisfying @xmath211 and @xmath212 .",
    "the polynomials @xmath210 are easily computed by induction as : @xmath213 using we have @xmath214 and @xmath215 ) e^{l_0 }   \\big ) ( x , y ) \\\\    & = \\left ( b \\partial_x + a a ' ( x - z ) \\partial_x^2 +    \\frac{1}{2}a^3 a ' \\partial_x^3 \\right ) e^{l_0^z}(x , y)\\\\    &   = \\left ( bh_1(\\theta ) + a a ' ( x - z ) h_2(\\theta ) +    \\frac{1}{2}a^3 a ' h_3(\\theta ) \\right ) e^{l_0^z } \\\\    & = \\frac{1}{\\sqrt{2 \\pi a^2 } } e^ { - \\frac{|x - y|^2}{2 a^2 } } \\left [      \\left ( \\frac{3 a a ' - 2 b}{2 a^2 } \\right)(x - y ) -      \\frac{a'}{2a^3}(x - y)^3 \\right . \\\\ & \\left .",
    "+ ( x - z ) \\left (      \\frac{(x - y)^2 - a^2 } { a^3 } \\right ) \\right ] . \\end{split}\\ ] ]    we now carry out a similar calculation for the next ( and last ) term of our asymptotic expansion , namely @xmath216 with @xmath217 given by equation .",
    "we finally have @xmath218 + \\frac{1}{6 } [ l_0^{z } , [ l_0^{z } ,        l_{2,x}^{z } ] ] \\right .",
    "\\\\    & \\left .",
    "+ \\frac{1}{2}l_1^{z,2 } + \\frac{1}{3 } l_1^{z } [ l_0^{z } ,      l_1^{z } ] + \\frac{1}{6 } [ l_0^{z } , l_1^{z } ] l_1^{z}+\\frac{1}{8 }         [ l_0^{z } , l_1^{z}]^2 \\right ) e^{l_0^z}\\\\ & = \\left         ( p_0+\\sum_{i=1}^6 p_ih_i ( \\theta)\\right ) e^{l_0^z } ( x , y)\\ , .",
    "\\end{split}\\end{aligned}\\ ] ] where @xmath219 are polynomials in @xmath220 and @xmath221 with coefficients given in terms of the values of the functions @xmath20 , @xmath21 , and @xmath22 , and their derivatives , all evaluated at @xmath35 , as follows @xmath222,\\\\ & p_3=a(x - z ) ( a'b + \\frac{1}{2 } a^2 { a'{}'}+ \\frac{3}{2 }    a { a'{}^2}),\\\\ & p_4=\\frac{a^2}{3 } \\big [ \\frac{1}{2 } a^3 { a'{}'}+ 2 a^2 { a'{}^2}+ a           \\frac{3}{2 } a ' b + \\frac{3}{2 } { a'{}^2}(x - z)^2 \\big ] , \\\\ & p_5=\\frac{1}{2 } a^4{a'{}^2}(x - z ) , \\ \\ p_6=\\frac{1}{8 }",
    "a^6 { a'{}^2}. \\end{split}\\ ] ]    in particular , we obtain the following explicit formula .",
    "[ ex.cev1 ] for the cev model given by equation , we have @xmath223 , @xmath224 , @xmath225 , @xmath35 , and hence , @xmath226 e^ { - \\frac{|x - y|^2}{2 { \\sigma}^2 z^{2{\\alpha } } } } .\\end{gathered}\\ ] ]    let us introduce the _ time dependent black - scholes - merton model _ to correspond to the operator @xmath227 thus the difference between the usual black - scholes - merton model and the time dependent black - scholes - merton model is that in the latter we allow @xmath10 and @xmath11 to depend on time .",
    "then the asymptotic formula for the time dependent black - scholes - merton model is obtained by setting @xmath228 in the example [ ex.cev1 ] , since that formula does not contain time derivatives of the coefficients .    at this stage",
    ", we can allow the basepoint @xmath37 to vary with @xmath32 and @xmath33 . in section [ sec.basepoints ] below we compute the expansion for the basepoint @xmath65 and compare it in section [ sec.error ] .",
    "different choices of basepoints @xmath37 may lead to more accurate and stable approximations . in future work",
    ", we plan to study how to optimize the choice of @xmath37 .",
    "[ def.admissible ] we call a function @xmath47 _ admissible _ if @xmath36 and all derivatives of @xmath37 are bounded .    in @xcite , we rigorously prove error bounds for the remainder term in in sobolev spaces under the assumption that @xmath37 be admissible ( and all the coefficients of @xmath13 , together with their derivatives , be bounded functions , and @xmath13 be uniformly strongly elliptic ) .",
    "the function @xmath47 can be thus quite general .",
    "the choice @xmath230 yields a simplified expression for the approximation , since certain terms disappear , and the approximation yields the price of a european call option in closed form .",
    "in fact , the convolution with the approximate green s function can be evaluated exactly and the price of a european call option given in closed form .",
    "in particular there is no need for numerical quadrature in evaluating the integrals , thus improving the speed of our calculations .    by setting @xmath230 in and evaluating all coefficient functions at @xmath231",
    ", we obtain the first - order correction to the rescaled kernel @xmath199 in the form : @xmath232    similarly , the second - order correction to the rescaled kernel @xmath199 is obtained in the form : @xmath233 where @xmath234 , and @xmath235 are given by .    for the time - dependent black - scholes - merton equation",
    ", we have @xmath236 , @xmath237 and @xmath238 so that @xmath239,\\end{aligned}\\ ] ] where all coefficient functions are calculated at @xmath231 .    the second - order correction to the rescaled kernel",
    "is given by @xmath240 , \\end{split}\\end{aligned}\\ ] ] where @xmath241    for the time - dependent cev model , @xmath242 and @xmath243 , @xmath244 with @xmath245 so that    @xmath246 , \\end{split}\\end{aligned}\\ ] ]    and    for the second order correction we have @xmath247 where @xmath248 @xmath249 and @xmath250 @xmath251    note that in the above two examples for the cev model , setting @xmath252 leads to the corresponding approximation for the bsm model .",
    "in this section , we consider european call options . for european put options similar results can also be obtained , either directly from the definition or by using put - call parity @xcite . in",
    "what follows , we will work with the expansion obtained by setting @xmath65 as the basepoint . in this case , we are able to compute the integrals defining the approximate option price @xmath253}$ ] from @xmath254}$ ] in closed form , which bypasses the need for more computationally intensive integration methods such as numerical quadrature , which are needed for more general basepoints @xmath37 .    by and , the first - order approximate green s function in given by @xmath255}(x , y ) = \\frac{1}{\\sqrt{2\\pi t}a}e^{-\\frac{(x - y)^2}{2a^2         t}}\\left(1 + \\frac{3aa'- 2b } { 2a^2}(x - y ) - \\frac{a'}{2a^3       t}(x - y)^3 \\right ) .\\ ] ]    similarly , by and the second - order approximate green s function is given by    we recall that we implicitly assume all coefficients are evaluated at @xmath231 .",
    "@xmath256}(x , y)= \\frac{\\sqrt{t}}{\\sqrt{2\\pi }      a}e^{-\\frac{(x - y)^2}{2a^2 t } } \\cdot \\left ( p_6 h_6(\\xi)+p_4h_4(\\xi)+p_2 h_2(\\xi)-r \\right ) \\ ] ]    where @xmath257 , the functions @xmath258 are given by , and @xmath259 all the coefficient functions are evaluated at @xmath260 .    for european call options with strike price @xmath6 , by the @xmath261- order approximated option price",
    "is @xmath262}(t , x)=\\int_0^\\infty { { \\mathcal g}}_t^{[n]}(x , y)(y - k)^+dy,\\ ] ] where we only take @xmath66 here .",
    "we recall that @xmath263 is the time to expiry @xmath7 and @xmath264 is real time .",
    "so to be more precise , _ the @xmath261-order option pricing formula for european call options with expiry time",
    "@xmath7 is  @xmath265}(t-\\mathfrak{t},x)$]_.    we have already observed that the general form of the approximate kernel , when @xmath229 , is a product of polynomial functions against a rescaled gaussian . therefore , the integration in above can be carried out in terms of error functions .",
    "explicitly , @xmath266}(t , x)&=&\\frac{\\sqrt{t}}{2\\sqrt{2\\pi } } e^{-\\frac{(x - k)^2}{2a^2 t}}\\left ( 2a - a'(x - k ) \\right ) \\\\ & & + \\frac{1}{2}\\cdot \\left ( { \\rm erf } \\left(\\frac{x - k}{\\sqrt{2 t}a}\\right)+1\\right ) \\left(b\\ , t+x - k\\right),\\end{aligned}\\ ] ] and @xmath267}(t , x)=u^{[1]}(t , x)+\\frac{rt}{2 } \\left ( erf\\left ( \\frac{x - k}{a\\sqrt{2 t } } \\right)+1 \\right ) ( k - x)\\\\ & + \\frac{1}{2\\sqrt{2\\pi   t}}e^{-\\frac{(x - k)^2}{2a^2 t}}\\cdot \\left ( \\frac{t^2}{6 } a^2{a'{}'}-a(r+a'^2/12)\\ , t^2 \\right.\\\\ & + ( t\\ , \\dot{a}+{a'{}'}(x - k)^2/3 ) \\ , t+\\frac{t}{a } ( t\\ , b^2-a'^2(x - k)^2/6)\\\\ & \\left.+\\frac{t\\ , b a ' ( x - k)^2}{a^2}+\\frac{a'^2(x - k)^4}{4a^3 } \\right ) , \\end{split}\\ ] ] note that in financial applications ( _ i.e. , _ in the risk free measure ) @xmath268 and @xmath237 .    for the cev model we have @xmath269}(t , x)&=\\frac{\\sigma x^{{\\alpha}- 1 } \\sqrt{t}}{2\\sqrt{2\\pi } } e^{-\\frac{(x - k)^2}{2   \\sigma^{2}t\\ , x^{2{\\alpha}}}}\\left ( ( 2 - { \\alpha})x + \\alpha k \\right ) \\\\ & + \\frac{1}{2}\\cdot \\left (    { \\rm erf } \\left(\\frac{x - k}{\\sqrt{2 t}\\sigma x^{\\alpha}}\\right)+1\\right    ) \\left ( ( 1 + r t)\\,x - k \\right ) .",
    "\\end{split}\\end{aligned}\\ ] ] and when @xmath252 , it reduces to the first order approximation for the black - scholes - merton model .",
    "in this section , we discuss the accuracy and efficiency of our approximation for the black - scholes - merton and the cev model . we employ the black - scholes - merton model primarily as a didactic example , given that an exact kernel and option pricing formulas exists . for the cev model",
    ", we compare our approximation to other solution formulas considered a benchmark in the literature , in particular the hagan - woodward scheme @xcite .",
    "what we find in general is a very good agreement of the approximate pricing formulas we derive in this paper with those available in the literature , but with significant advantage in the computational efficiency . in particular , the agreement is good even for times that are not small . in section [ bootstrap ] , we propose a bootstrap scheme in time to improve the accuracy of our approximation for large time .",
    "we start by discussing the black - scholes - merton model , and choose the parameters @xmath270 , @xmath271 and @xmath272 , and plot the exact and approximate solutions for @xmath273 .",
    "we compare our formula with the black scholes exact solution formula for different times @xmath4 .",
    "figure [ figure bs ] gives two different cases , which show that when @xmath4 is small the two solutions are in very good agreement with an absolute error of order @xmath274 .",
    "we notice that even when @xmath4 is not small , the error is small .",
    "tables [ table 1 ] and [ table 2 ] give a analysis of the _ pointwise _ error for the first order approximation with respect to the exact black - scholes formula .",
    "throughtout this section , we _ fix the basepoint @xmath229 _ , so that we have closed - form approximate solution formulas , and we can better gauge the error introduced by the our method . for more general basepoints @xmath37 ,",
    "further error is introduced by the numerical quadrature used for the integration and the truncation of the pay - off function @xmath5 at large @xmath32 ( this error is lower order , however , if @xmath5 is truncated at @xmath32 large enough with respect to @xmath6 ) .    .",
    "basepoint @xmath229 .",
    "the left picture is for @xmath275 , and the right one is for @xmath276 .",
    "note that the x - axis is scaled by 10 , i.e. the label 150 means the stock price is 15 .",
    ", title=\"fig:\",width=211 ] .",
    "basepoint @xmath229 .",
    "the left picture is for @xmath275 , and the right one is for @xmath276 .",
    "note that the x - axis is scaled by 10 , i.e. the label 150 means the stock price is 15 .",
    ", title=\"fig:\",width=211 ]       as predicted , we can increase the number of bootstrap steps to obtain arbitrary accuracy in the aproximation .",
    "furthermore , for relatively large @xmath4 the number of bootstrap steps should be correspondingly large , so that the compound error from each bootstrap step is under control at the end .",
    "for example ,",
    "in our tests when @xmath279 , it is not enough to reduce the error by bootstrapping with @xmath280 steps .",
    "using only @xmath280 steps in this case , in fact , introduces additional errors . for more detail , see @xcite .",
    "in order to eliminate the effect of the truncation error , we shall work with a butterfly option in the rest of this section .",
    "mathematically , a butterfly option corresponds to an intial pay - off given by a hat function , figure .",
    "our method gives closed - form solution for butterfly options as well , by linearity .",
    "figure shows the errors of a butterfly option within the black - scholes - merton model with @xmath281 , @xmath282 , @xmath283 obtained by our first order and second order approximation with or without bootstrap .",
    "the benchmark is the true solution .",
    "the parameters we were using are the same as we mentioned before .",
    "again , we truncate the half line at @xmath284 . for a butterfly option ,",
    "the truncation error is clearly very small , given that the data is compactly supported ( figure ) .",
    "for the second order approximation with a bootstrap scheme , the error is almost zero .",
    "it is in the scale of @xmath278 , while without the bootstrap the error is of the scale @xmath285 .",
    "this coincides with our theoretical results .",
    "we conclude by discussing the bootstrap scheme for the greeks . directly using the closed - form approximation formula to compute the greeks for very long maturity time ( @xmath286 )",
    "is not advisable .",
    "in fact , our closed - form approximation for call option oscillates near the strike price , and the oscillation grows with the time to expiry , as the overall error grows .",
    "the appearance of the oscillation is due to the discontinuity of first derivative of the pay - off function at the strike price .",
    "this phenomenon is clearly visible for butterfly options , where the first derivative of the payoff function has three discontinuities , figure .",
    "this oscillation is amplified in the calculation of greeks .",
    "the bootstrap scheme reduces this oscillation dramatically .    for the numerical simulation",
    ", we choose the same parameters as those in section .",
    "the small time step ensures very good error control at each time step . also , we minimize the truncation error as before by truncating the integral at @xmath287 and comparing the approximations only on the interval @xmath288 $ ] near the strike price @xmath289 . the left graph of figure plots the true delta and our approximation in the same picture , and the right one plots the difference between these two curves , which shows that the difference between the true value and our approximation is in the order of @xmath290 with the biggest error around @xmath291",
    "thus our approximation is quite accurate . for the gamma ,",
    "we obtain similar results , see figure [ figure gamma bootstrap ] .",
    "the difference is in the order of @xmath292 , and the biggest error is around @xmath293 . in both cases ,",
    "there are no oscillations on the same scale of the solution .    .",
    "basepoint : @xmath229 .",
    "the left graph plots the delta computed by our bootstrap method and the true delta .",
    "the right graph plots their difference . in our numerical integration",
    ", we truncate the half line at 400 . note that in the second figure the scale is @xmath290 . the x - axis scaled by 10 ,",
    "i.e. the label 400 means the stock price is 40 .",
    ", title=\"fig:\",width=211 ] .",
    "basepoint : @xmath229 .",
    "the left graph plots the delta computed by our bootstrap method and the true delta .",
    "the right graph plots their difference . in our numerical integration",
    ", we truncate the half line at 400 .",
    "note that in the second figure the scale is @xmath290 .",
    "the x - axis scaled by 10 , i.e. the label 400 means the stock price is 40 .",
    ", title=\"fig:\",width=211 ]    .",
    "basepoint : @xmath229 .",
    "the left graph plots the gamma computed by our bootstrap method and the true gamma .",
    "the right graph plots their difference . in our numerical integration ,",
    "we truncate the half line at 400",
    ". note that in the second figure the scale is @xmath292 .",
    "the x - axis is scaled by 10 , i.e. the label 400 means the stock price is 40.,title=\"fig:\",width=211 ] .",
    "basepoint : @xmath229 .",
    "the left graph plots the gamma computed by our bootstrap method and the true gamma .",
    "the right graph plots their difference . in our numerical integration ,",
    "we truncate the half line at 400",
    ". note that in the second figure the scale is @xmath292 .",
    "the x - axis is scaled by 10 , i.e. the label 400 means the stock price is 40.,title=\"fig:\",width=211 ]                    r.  costantinescu , n.  costanzino , a.  l. mazzucato , and v.  nistor .",
    "approximate solutions to second order parabolic equations i : analytical estimates .",
    "arxiv preprint 0910.1562v2 , i m a preprint 2248 . submitted ."
  ],
  "abstract_text": [
    "<S> we obtain new closed - form pricing formulas for contingent claims when the asset follows a dupire - type local volatility model . to obtain the formulas we use the dyson - taylor commutator method  that we have recently developed in @xcite for short - time asymptotic expansions of heat kernels , and obtain a family of general closed - form approximate solutions for both the pricing kernel and derivative price . </S>",
    "<S> a bootstrap scheme allows us to extend our method to large time . </S>",
    "<S> we also perform analytic as well as a numerical error analysis , and compare our results to other known methods . </S>"
  ]
}