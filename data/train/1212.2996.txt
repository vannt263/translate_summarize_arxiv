{
  "article_text": [
    "the success or failure of magnetic field modeling of the solar corona depends on both the choice of the theoretical model , as well as on the choice of the used data sets .",
    "the simplest method is potential field modeling , which requires only a line - of - sight magnetogram @xmath2 , but only few solar active regions match a potential field model . also linear force - free field ( lfff ) models are generally considered as unrealistic , where a single constant value for the force - free parameter @xmath3 represents the multi - current system of an entire active region in the solar corona .",
    "the state - of - the - art is the nonlinear force - free field ( nlfff ) model , which can accomodate for an arbitrary configuration of current systems , described by a spatially varying @xmath4 parameter distribution in an active region .",
    "the next strategic decision is the choice of data sets to constrain the theoretical model .",
    "nlfff models generally require vector magnetograph data , @xmath5 $ ] , which are used as a lower boundary constraint and are extrapolated into the corona .",
    "however , a fundamental problem that has been identified is that the zone in the photosphere and lower chromosphere is not force - free ( metcalf , 1995 ) , which spoils the extrapolation into coronal heights and leads to a substantial mismatch between the extrapolated field lines and observed coronal loops , typically amounting to a 3d misalignment angle of @xmath6 ( derosa , 2009 ; sandman , 2009 ) .",
    "obviously , this fundamental problem can only be circumvented by using additional constraints from coronal data , since the corona above the transition region is generally force - free , except when the plasma-@xmath7 parameter is larger than unity ( e.g. , in filaments ) or when the equilibrium brakes down ( e.g. , during filament eruptions , flares , and coronal mass ejections ) .",
    "the problem amounts now how to implement coronal data into a theoretical magnetic field model , such as coronal loops , which are believed to be reliable tracers of the coronal magnetic field .",
    "a feasible approach is the method of stereoscopic triangulation , which can be applied by using the solar rotation or stereoscopic observations from dual spacecraft , as provided by the stereo mission ( for reviews of solar stereoscopy see , e.g. , inhester 2006 ; wiegelmann , 2009 ; aschwanden 2011 ) .",
    "stereoscopically triangulated coronal loop coordinates @xmath8 $ ] ( as a function of the curvilinear abscissa @xmath9 ) have been used to constrain : ( i ) potential field models in terms of buried unipolar magnetic charges ( aschwanden and sandman 2010 ) or buried dipoles ( sandman and aschwanden 2011 ) , ( ii ) linear force - free fields ( feng , 2007 ; inhester , 2008 ; conlon and gallagher 2010 ) , and ( iii ) nonlinear force - free fields ( aschwanden , 2012a ) .",
    "the proof of concept to fit nlfff codes to prescribed field lines was also demonstrated with artificial ( non - solar ) loop data , fitting either 3d field line coordinates @xmath8 $ ] , or 2d projections @xmath10 $ ] ( malanushenko , 2009 , 2012 ) .",
    "the method of malanushenko , ( 2012 ) employs a grad - rubin type nlfff code ( grad and rubin , 1958 ) that fits a lfff with a local @xmath3-value to each coronal loop and then iteratively relaxes to the closest nlfff solution , while the method of aschwanden , ( 2012a ) uses an approximative analytical solution of a force - free and divergence - free field , parameterized by a number of buried magnetic charges that have a variable twist around their vertical axis , and is forward - fitted to observed loop coordinates .",
    "the latter method is numerically quite efficient and achieves a factor of two better agreement in the misalignment angle ( @xmath11 ) than standard nlfff codes using magnetic vector data .",
    "however , the major limitation of the latter method is the availability of solar stereoscopic data , which restricts the method to the beginning of the stereo mission ( i.e. , the year of 2007 ) , when stereo had a small spacecraft separation angle that is suitable for stereoscopy ( aschwanden , 2012b ) .",
    "hence , the application of nlfff magnetic modeling using coronal constraints could be considerably enhanced , if the methodical restriction to coronal 3d data , as it can be provided only by true stereoscopic measurements , could be relaxed to 2d data , which could be furnished by any high - resolution euv imager , such as from the soho / eit , trace , and sdo / aia missions .",
    "this generalization is exactly the purpose of the present study .",
    "we develop a modified code that requires only a line - of - sight magnetogram and a high - resolution euv image , where we trace 2d loop coordinates to constrain the forward - fitting of the analytical nlfff code described in aschwanden ( 2012a ) , and compare the results with those obtained from stereoscopically triangulated 3d loop coordinates ( described in aschwanden , 2012a ) .",
    "furthermore we test also magnetic forward - fitting to automatically traced 2d loop data , and compare the results with manually traced 2d loop data .",
    "the latter effort brings us closer to the ultimate goal of fully automated ( nlfff ) magnetic field modeling with widely accessible input data .",
    "the content of the paper is a follows : the theory of the analytical nlfff forward - fitting code is briefly summarized in section 2 , the numerical code is described in section 3 , tests of nlfff forward - fitting to simulated data are presented in section 4 , and to stereoscopic and single - image data in section 5 , while a discussion of the application is given in section 6 , with a summary of the conclusions provided in section 7 .",
    "a nonlinear force - free field ( nlfff ) is implicitly defined by maxwell s force - free and divergence - free conditions , @xmath12 @xmath13 where @xmath4 is a scalar function that varies in space , but is constant along a given field line , and the current density @xmath14 is co - aligned and proportional to the magnetic field @xmath15 .",
    "a general solution of equations ( 1)-(2 ) is not available , but numerical solutions are computed ( see review by wiegelmann and sakurai 2012 ) using ( i ) force - free and divergence - free optimization algorithms ( wheatland , 2000 ; wiegelmann 2004 ) , ( ii ) evolutionary magneto - frictional methods ( yang , 1986 ; valori , 2007 ) , or grad - rubin - style ( grad and rubin , 1958 ) current - field iteration methods ( amari , 1999 , 2006 ; wheatland 2006 ; wheatland and regnier 2009 ; malanushenko , 2009 ) .",
    "numerical nlfff solutions bear two major problems : ( i ) every method based on extrapolation of force - free magnetic field lines from photospheric boundary conditions suffers from the inconsistency of the photospheric boundary conditions with the force - free assumption ( metcalf 1995 ) , and ( ii ) the calculation of a single nlfff solution with conventional numerical codes is so computing - intensive that forward - fitting to additional constraints ( requiring many iteration steps ) is unfeasible .",
    "hence an explicit analytical solution of equations ( 1)-(2 ) would be extremely useful , which could be computed much faster and be forward - fitted to coronal loops in force - free domains circumventing the non - force - free ( photospheric ) boundary condition .",
    "an approximate analytical solution of equations ( 1)-(2 ) was recently calculated ( aschwanden 2012a ) that can be expressed by a superposition of an arbitrary number of @xmath16 magnetic field components @xmath17 , @xmath18 , @xmath19 where each magnetic field component @xmath17 can be decomposed into a radial @xmath20 and an azimuthal field component @xmath21 , @xmath22 @xmath23 @xmath24 @xmath25 where ( @xmath26 ) are the spherical coordinates of a magnetic field component system ( @xmath27 with a unipolar magnetic charge @xmath28 that is buried at position ( @xmath29 , has a depth @xmath30 , a vertical twist @xmath31 , and @xmath32^{1/2}$ ] is the distance of an arbitrary coronal position @xmath33 to the subphotospheric location @xmath34 of the buried magnetic charge .",
    "the force - free parameter @xmath3 can also be expressed in terms of the parameter @xmath35 ( equation 7 ) , which quantifies the number @xmath36 of full twist turns over a ( loop ) length @xmath37 , @xmath38 this analytical approximation is divergence - free and force - free to second - order accuracy in the parameter @xmath39 , which is proportional to the force - free parameter @xmath3 as defined by equation ( 7 ) .",
    "this approximate nlfff solution is very appropriate for cases with small vertical twist , but may break down for highly non - potential cases with large twist or magnetic field domains with strong horizontal twist , such as near - horizontal filaments or a gold - hoyle flux rope ( gold and hoyle 1960 ; aschwanden 2012a , appendix a ) . in the limit of vanishing vertical twist ( @xmath40 or @xmath41 ) ,",
    "the azimuthal component vanishes , @xmath42 , and the radial component degenerates to the potential - field solution of a unipolar magnetic charge , @xmath43 , which is simply a radial field that points away from the buried charge and decreases with the square of the distance .",
    "a numerical code that fits this analytical approximation to a given 3d magnetic field is described and tested in aschwanden and malanushenko ( 2012 ) using analytical models .",
    "applications to real solar data using stereoscopically triangulated coronal loops from the stereo mission , which supposedly outline force - free magnetic field lines in the solar corona , are presented in aschwanden , ( 2012a ) .",
    "the numeric code that fits the approximative analytical nlfff solution ( equations 3 - 7 ) to a line - of - sight magnetogram @xmath2 plus coronal loop coordinates @xmath8 $ ] for an ensemble of stereoscopically triangulated loops in a solar active region is described in detail and tested in aschwanden and malanushenko ( 2012 ) .",
    "we are using a cartesian coordinate system @xmath33 with the origin in the center of the sun and the plane - of - the - sky is in the @xmath44-plane , while the z - axis is the line - of - sight .",
    "this allows us to take the curvature of the solar surface into full account , in contrast to some other nlfff codes that approximate the solar surface with a flat plane .",
    "the forward - fitting part of the code consists of two major parts , ( i ) the decomposition of buried unipolar magnetic charges from a line - of - sight magnetogram @xmath2 ( see appendix a of aschwanden , 2012a ) , and ( ii ) iterative optimization of the nonlinear force - free @xmath4 parameters by minimizing the misalignment angles between the loop data and the fitted nlfff model .",
    "the new approach in this work is the generalization of the forward - fitting code from 3d loop coordinates ( using stereoscopic measurements before ) to 2d loop coordinates @xmath10 $ ] only , which can simply be provided from any high - resolution euv image without requiring stereoscopic views .    the two different methods are juxtaposed in fig .  1 . in the 3d",
    "forward - fitting method , the 3d misalignment angle @xmath45 is computed for a number of @xmath46 loop segment positions and @xmath47 coronal loops , defined by the scalar product that calculates the angle @xmath48 between the 3d vectors of the loop direction @xmath49 and the magnetic field direction @xmath50 at a given loop position @xmath51 $ ] , @xmath52 this is illustrated in figure ( 1 ) , where the loop directions ( black arrows ) and magnetic field directions ( red arrows ) are depicted at three loop segment positions , for two orthogonal projections ( figure 1 left panels ) .",
    "the root - mean - square value of all misalignment angles for each loop segment @xmath53 and loop @xmath54 is then minimized in the forward - fitting procedure to find the best nlfff approximation , @xmath55 ^ 2 \\right)^{1/2 } \\ .\\ ] ] in addition to the 3d misalignment angle @xmath48 , we can also define a 2d misalignment angle @xmath56 with the same equations ( 9 ) and ( 10 ) , except that the magnetic field vectors @xmath57 and loop vectors @xmath50 are a function of two - dimensional space coordinates @xmath58 , as they are seen in the 2d projection into the @xmath44-plane ( figure 1 , bottom right panel ) .",
    "if we have only 2d loop coordinates available ( in the case without stereoscopy ) , we can only forward - fit the field lines parameterized with a nlfff code by minimizing the 2d misalignment angle @xmath56 , because the third space variable @xmath59 is not available .",
    "our strategy here is to calculate the 2d misalignment angle @xmath56 in each position for an array of altitudes , @xmath60 , that covers a limited altitude range @xmath61 $ ] or search volume in which we expect coronal loops to be detectable ( figure 1 , top right panel ) . for euv images ,",
    "loops are generally detectable within one density scale height , for which we use a height range of @xmath62 $ ] solar radii here .",
    "this yields multiple @xmath63 misalignment angles for each 2d loop position @xmath64 , which are shown in the @xmath65-plane ( fig .",
    "1 top right panel ) and @xmath66-plane ( fig .",
    "1 bottom right panel ) .",
    "our strategy is then to estimate the unknown third @xmath67-coordinate in each 2d position @xmath64 from that height @xmath68 that shows the smallest 2d misalignment angle @xmath56 , and can then proceed with the forward - fitting procedure like in the case of 3d stereoscopic data @xmath69 , which is described in detail in aschwanden and malanushenko ( 2012 ) .",
    "a side - effect of the generalized 2d method is that the parameter space is enlarged by an additional dimension , the unknown @xmath70 or @xmath68 coordinate of the altitude of each loop position @xmath64 , which in principle increases the computation time by a linear factor of the number @xmath71 of altitude levels .",
    "however , we optimized the code by vectorization and by organizing the optimization of the altitude variables @xmath67 ( for each loop segment @xmath72 and loop @xmath73 ) and the @xmath74-parameter variables ( for each magnetic charge @xmath75 ) in an interleaved mode , so that the computation time reduced by 1 - 2 orders of magnitude compared with earlier versions of the code ( aschwanden and malanushenko 2012 ; aschwanden , 2012a ) , without loss of accuracy .",
    "when comparing 3d with 2d misalignment angles , we have to be aware that the unknown third dimension @xmath67 at every loop position @xmath64 is handled differently in the two methods . in our new 2d method",
    "we optimize the third coordinate @xmath67 by minimizing the 2d misalignment angle independently at every loop segment position @xmath64 , interleaved with the optimization of the nonlinear force - free @xmath31 parameter . in the ( stereoscopic )",
    "3d method the third coordinate @xmath67 is used as a fixed constraint like the observables @xmath64 . however , we can calculate the median 2d misalignment angle @xmath56 with both methods , while the 3d misalignment angle @xmath48 is only defined for the ( stereoscopic ) 3d - fit method , but not for the ( loop - tracing ) 2d - fit method .",
    "in order to test the numerical convergence behavior , the uniqueness of the solutions , and the accuracy of the method in terms of misalignment angles we test our code first with simulated data .",
    "we simulate six cases that correspond to the same six nonpotential cases presented in aschwanden and malanushenko ( 2012 ; cases # 7 - 12 ) , consisting of a unipolar case ( n7 ; figure 2 top ) , a dipolar case ( n8 ; figure 2 middle ) , a quadrupolar case ( n9 ; figure 2 bottom ) , and three decapolar cases with 10 randomly buried magnetic charges each ( n10 , n11 , n12 ; figure 3 ) . in each case",
    "we run both the 3d - fitting code ( mimicking the availability of stereoscopic loop data ) , as well as the 2d - fitting code ( corresponding to loop tracings from a single euv image without stereoscopic information ) . thus , in the 3d - fitting code the target loops are parameterized with 3d data @xmath76 $ ] , while we ignore the third coordinate in the 2d - fitting code and fit only the 2d coordinates @xmath77 $ ] of the target loops .",
    "the results are shown in figures 2 and 3 , with the 2d fits in the left - hand panels , and the 3d fits in the right - hand panels .",
    "the convergence of the 2d - code can be judged by comparing with the previously tested 3d - code ( aschwanden and malanushenko 2012 ) .",
    "we list a summary of the results in table 1 .",
    "the 3d - fits achieve a mean 3d misalignment angle of @xmath78 and a 2d misalignment angle of @xmath79 .",
    "this is reasonable and slightly better than the results of an earlier version of the 3d - code ( @xmath80 in table 4 of aschwanden and malanushenko 2012 ) . in comparison ,",
    "our new 2d - fitting code achieves an even better agreement with @xmath81 for the 2d - misalignment angle @xmath56 , while the 3d - misalignment angle @xmath48 is not defined for the 2d code ( due to the lack of line - of - sight coordinates @xmath82 ) . the better performance of the 2d code is due to the smaller number of constraints ( i.e. , 200 constrains for 2d - loop coordinates of 10 loops with 10 segments , compared with 300 constraints for the 3d - fit method ) .",
    "the smaller number of free parameters generally improves the accuracy of the solution .",
    "the uniqueness of the solution can be best expressed by the mean misalignment angle @xmath56 .",
    "strictly speaking , a nlfff solution would only be unique if the number of free parameters ( i.e. , the number of magnetic charges @xmath16 in our case ) matches the number of constraints ( i.e. , the number of fitting positions ( i.e. , the product of the number of loops @xmath83 times the number of fitted segment positions @xmath84 , i.e. , @xmath85 in our case ) .",
    "moreover , the los magnetogram is approximated by a number of magnetic charges @xmath16 that neglects weak magnetic sources , and there are residuals in the decomposition of magnetic charges that contribute to the noise or uncertainty and non - uniqueness of the solutions .",
    "therefore , the uniqueness of a nlfff solution can best be specified by an uncertainty measure for each field line , which can be quantified either by the misalignment angle @xmath56 or by a maximum transverse displacement of a field line , i.e , @xmath86 for a particular field line with full length @xmath37 .",
    "we show in table 1 also the ratios @xmath87 of the nonpotential to the potential energies for the 3d and 2d fit methods , which agree within an accuracy of order @xmath88 .",
    "note , that the simulated data have 1 , 2 , 4 , and 10 magnetic charges , which corresponds to the number of free parameters in the fit , while we used the double number of magnetic charges in the decomposition of the simulated los magnetogram , in order to make the parameterization of the fitted model somewhat different from the target model",
    ". nevertheless , although the 2d solutions have a high accuracy ( with a mean misalignment of @xmath89 ) , we have to be aware that the simulated data and the forward - fitting code use the same parameterization of nonlinear @xmath3-parameters , which warrants a higher accurcay in forward - fitting than real data with a unknown parameterization .",
    "hence , we test the code with real solar data in the following section .",
    "for testing the feasibility , fidelity , and accuracy of the new analytical nlfff forward - fitting code based on 2d tracing of loops ( rather than 3d stereoscopy ) we are using the same observations for which either stereoscopic 3d reconstruction has been attempted earlier ( aschwanden , 2008b , c , 2009 , 2012a ; sandman , 2009 ; derosa , 2009 ; aschwanden and sandman 2010 ; sandman and aschwanden 2011 ; aschwanden 2012a ) , such as for active regions observed with stereo on 2007 april 30 , may 9 , may 19 , and december 11 , or where 2d loop tracing was performed and documented , such as for an active region observed on 1998 may 19 with trace ( aschwanden , 2008a ) . the active region numbers , observing times , spacecraft separation angles , number of traced loops , and maximum magnetic field strengths of these observations are listed in table 2 . in all cases we used line - of - sight magnetograms @xmath2 from the michelson doppler imager ( mdi ; scherrer , 1995 ) on board the _ solar and heliospheric observatory ( soho ) _ , while euv images were used either from the _ transition region and coronal explorer _",
    "( trace ; handy , 1999 ) , or from the _ extreme ultraviolet imager _ ( euvi ; wlser , 2004 ) onboard the stereo spacecraft a(head ) and b(ehind ) .",
    "we show the results of the nlfff forward - fitting of the six active regions in figures 4 to 9 , all in the same format , which includes the decomposed line - of - sight magnetogram of soho / mdi ( grey scale in center of figures 4 to 9 ) , the stereoscopically triangulated or visually traced loops ( blue curves in figures 4 to 9 ) , and the best - fit magnetic field lines ( red curves for the segments covered by the observed loops , and in orange color for complementary loops parts ( although truncated at a height of 0.15 solar radii ) .",
    "the orthogonal projections of the best - fit magnetic field lines are also shown in the right - hand and top panels of figures 4 to 9 , as well as the histograms of 2d @xmath90 and 3d ( @xmath48 ) misalignment angles ( in bottom panels of figures 4 to 9 ) .",
    "the median misalignment angles @xmath56 and @xmath48 are also listed in table 3 , for both the previous stereoscopic reconstructions ( aschwanden , 2012a ; aschwanden 2012b ) , marked with `` stereo '' in table 3 , and based on 2d loop tracing in the present study , marked with `` tracing '' in table 3 .",
    "the active region a ( 2007 april 30 ; figure 4 ) shows a lack of stereoscopically triangulated loops in the core of the active region ( due to the high level of confusion for loop tracing over the `` mossy '' regions ) , where the highest shear and degree of non - potentiality is expected , and thus deprives us from measuring the largest amount of free magnetic energy , while standard nlfff codes have stronger constraints in these core regions . in all 5 active regions we see sunspots with strong magnetic fields , but since we limit our nlfff solutions to an altitude range of @xmath91 solar radii , we can not see whether the diverging field lines above the sunspots are open or closed field lines .",
    "in principle we could display our nlfff solutions to larger altitudes to diagnose where open and closed field regions are , but the accuracy of reconstructed field lines is expected to decrease with height with our method , especially because of the second - order approximation that can represent helical twist well for vertical segments of loops ( near the surface ) , but not so well for horizontal segments of loops ( in large altitudes ) .",
    "we see in table 3 that the 3d misalignment angles @xmath48 have a mean value of @xmath92 for the stereoscopy method .",
    "if we compare the 2d misalignment angles @xmath56 between the two methods in table 3 , we see that the stereo method has a somewhat larger mean , @xmath93 , than the 2d loop tracing method , with @xmath94 .",
    "this is an effect of the optimization of the 2d misalignment angles in the 2d loop tracing method , where the third coordinate is a free variable and thus has a larger flexibility to find an appropriate model field line with a small 2d misalignment angle , in contrast to the stereoscopic method , where the third coordinate of every observed loop is entirely fixed and leaves less room in the minimization of the misalignment angles between observed loops and theoretical field models .",
    "ideally , if stereoscopy would work perfectly , the third coordinate should be sufficiently accurate so that the best field solution can be found easier with fewer free parameters .",
    "however , reality apparently reveals that there is a significant stereoscopic error that hinders optimum field fitting , which is non - existent in the 2d forward - fitting situation .",
    "actually , from the two stereoscopic misalignment angles we can estimate the stereoscopic error @xmath95 , assuming isotropic errors .",
    "thus , defining the 2d misalignment angle as @xmath96 , and the 3d misalignment angle as @xmath97 , with isotropic errors @xmath98 , we expect @xmath99 which yields a stereoscopic error of @xmath100 .",
    "this is somewhat larger than estimated earlier from the parallelity of stereoscopically triangulated loops with close spatial proximity , which amounted to @xmath101 ( aschwanden and sandman 2010 ) .",
    "thus both estimates assess a substantial value to the stereoscopic error that exceeds the accuracy of the best - fit nlfff solution based on 2d loop tracing ( @xmath102 ) by far",
    ". nevertheless , both best - fit misalignment angles @xmath56 are consistent with each other for the two forward - fitting methods .",
    "this forward - fitting experiment thus demonstrates that _ we obtain equally accurate nlfff fits to coronal data with or without stereoscopy _ , and thus makes the new method extremely useful .      for the 2d loop tracing method of stereoscopic data ( cases",
    "a , b , c , and d in table 1 ) we just ignored information on the @xmath82-coordinate of loops in the 2d forward - fitting algorithm . for cases e and f , we compare visual tracing of loops ( case e ) with automated loop tracing ( case f ) .",
    "interestingly , we find the most accurate forward - fit for case e , which has a 2d misalignment error of only @xmath103 ( figure 8) , which may have resulted from the higher spatial resolution of loop tracing using trace data ( with a pixel size of @xmath104 ) in case e , compared with the three times lower resolution of stereo ( with a pixel size of @xmath105 ) in the cases a , b , c , and d.      comparing visually traced ( figure 8) versus automatically traced loops ( figure 9 ) , we note that the automated tracing leads to a less accurate nlfff fit , with @xmath106 versus @xmath107 for visual tracing .",
    "apparently , the automated loop tracing method ( aschwanden , 2008a ) can easily be mis - guided or side - tracked by about @xmath108 onto near - cospatial loops with similar coherent large curvature .",
    "comparing individual field lines in figure 8 with figure 9 , we see also that the automated loop tracing algorithm produces a number of short loop segments with large misalignment angles , which are obviously a weakness of the automated tracing code , resulting into a larger misalignment error for the fitted nlfff solution ( which is a factor of @xmath109 larger in the average for this case ) .      in figure 10",
    "we show scatterplots of the magnetic field strengths @xmath110 retrieved at the photospheric level for the stereoscopic 3d method versus the field strength @xmath111 obtained from the 2d loop tracing method .",
    "the analytical nlfff forward - fitting algorithm starts first a decomposition of point - like buried magnetic charges from the line - of - sight component @xmath2 , but has no constraints for the transverse components @xmath112 and @xmath113 , except for the coronal loop coordinates .",
    "thus , the directions of coronal loops near the footpoints will determine the transverse components @xmath112 and @xmath113 in the photosphere .",
    "the scatterplots of @xmath111 versus @xmath110 in figure 10 show that the smallest scatter between the two methods appears for active region b , which is the one closest to a potential field ( although we are not able to trace and triangulate loops in the core of the active region , where supposedly the highest level of non - potentiality occurs ) .",
    "the linear regression fits show a good correspondence in the order of @xmath114 between the two methods , which results from different fitting criteria of the nonpotential field components .",
    "a ratio of @xmath115 in the azimuthal field ( or nonpotential ) field component @xmath21 ( equation 5 ) with respect to the potential field component @xmath20 ( equation 4 ) would result into a change @xmath116 of @xmath117 in the magnetic field strength .",
    "the free magnetic energy , which is the difference between the nonpotential and the potential field energy , integrated over the spatial volume of an active region , has been calculated for the stereoscopic forward - fitting method in aschwanden 2012b ( table 1 therein ) . here",
    "we calculate these quantities also for the 2d loop tracing method , both methods being juxtaposed in table 3 and in figure 11 .",
    "the absolute values of the potential field energy @xmath118 agree within a factor of @xmath119 between the two methods , while the free energies show differences of 1%-2% of the potential energy .",
    "if we consider the difference in the free energy between two methods as a measure of a systematic error , we assess an uncertainty of @xmath120 , or about @xmath121 .",
    "quantitative comparisons of various nonlinear force - free field ( nlfff ) calculation methods applied to coronal volumes that encompass an active region included optimizational , magneto - frictional , grad - rubin based , and green s function based models ( schrijver , 2006 ; 2008 ; derosa , 2009 ) . a critical assessment of 11 nlfff methods revealed significant differences in the nonpotential magnetic energy and in the degree of misalignment ( @xmath122 ) with respect to stereoscopically triangulated coronal loops .",
    "the chief problem responsible for these discrepancies were identified in terms of the non - force - freeness of the lower ( photospheric ) boundary , too small boundary areas , and uncertainties of the boundary data ( derosa , 2009 ) .",
    "obviously , the non - force - freeness of the photosphere can only be circumvented by incorporating coronal magnetic field geometries into nlfff extrapolations , such as the information from stereoscopically triangulated loops .",
    "implementation of coronal magnetic field data into nlfff codes is not straightforward , because most of the conventional nlfff codes are designed to extrapolate from a lower boundary in upward direction , and thus the volume - filling coronal information can not be treated as a boundary problem .",
    "a natural method to match arbitrary constraints that are not necessarily a boundary problem is a forward - fitting approach , which however , requires a parameterization of a magnetic field model .",
    "since nlfff models are implicitly defined by the two differential equations of force - freeness and divergence - freeness , an explicit parameterization of a magnetic field is not trivial .",
    "there are essentially three approaches that have been attempted so far : ( i ) preprocessing of magnetic boundary data by minimizing the lorentz force at multiple spatial scales ( wiegelmann 2004 ; jing , 2009 ) ; ( ii ) linear force - free fitting with subsequent relaxation to a nonlinear force - free field ( malanushenko , 2009 , 2012 ) ; and ( iii ) magnetic field parameterization with buried magnetic charges and forward - fitting of an approximative analytical nlfff solution ( aschwanden 2012a , b ; aschwanden and malanushenko 2012 ) .",
    "the third method requires stereoscopically triangulated 3d coordinates of coronal loops , which have been successfully modeled in four different active regions , improving the misalignment angles between the observed loops and a potential field ( @xmath123 ) by a factor of about two , when fitted with the analytical nlfff solution ( @xmath124 ; aschwanden , 2012a ) .",
    "however , although this method provides a more realistic nlfff model , the main restriction is the availability of stereo data , as well as the inferior spatial resolution of stereo / euvi compared with other euv imagers ( e.g. , trace , or sdo / aia ) . in order to circumvent this restriction we developed a generalized code in this study that requires only a high - resolution euv image , from which a sufficient large number of coronal loops can be traced in two dimensions , plus a line - of - sight magnetogram , which were essentially always available since the lauch of the soho mission in 1995 .",
    "a fortunate outcome of this study is that the reduction of 3d information from coronal loops to 2d coordinates does not handicap the accuracy of a nlfff forward - fitting method , as we demonstrated here .",
    "one potential limitation of forward - fitting of analytical nlfff approximations may be the accuracy for strong nonpotential cases ( say near flaring times ) , since our analytical nlfff approximation is only accurate to second order of the force - free @xmath3-parameter .",
    "another caveat may be the universality of the analytical nlfff parameterization .",
    "our approximation is designed to model azimuthal ( rotational ) twist around a vertical axis with respect to the solar surface , which corresponds to electric currents flowing in vertical direction .",
    "this geometry may not be appropriate for horizontally twisted structures , such as horizontally extended filaments .",
    "for such cases , a more general nlfff solution could be desirable . in this respect ,",
    "more general nlfff solutions such as currently developed by malanushenko , ( 2009 ; 2012 ) may provide new tools , after they will be generalized for a spherical solar surface and optimized for computational speed .",
    "nevertheless , our analytical nlfff forward - fitting algorithm can always be used to find a quick first approximation of a nlfff solution , which then could be refined by alternative ( more time - consuming ) nlfff codes .",
    "note that our forward - fitting code calculates one trial magnetic field configuration in about 0.01 s , while some @xmath125 iterations are needed for the convergence of an approximate nlfff solution , accumulating to a few minutes total computation time .",
    "our forward - fitting code computes a solution to an active region with an average computation time of @xmath126 minutes ( see cpu times in table 3 ) on a mac os x , 2 @xmath127 3.2 ghz quad - core intel xeon , 32 gb memory , 800 mhz ddr2 fb - dimm computer .",
    "simple cases that can be represented with @xmath128 magnetic charges , require only computation times of order @xmath129 s ( see cpu times in table 1 ) .",
    "we developed an analytical nlfff forward - fitting code that requires only the input of a line - of - sight magnetogram @xmath2 and a set of 2d loop tracing coordinates @xmath130 that can be obtained from any high - resolution euv image .",
    "this is the first attempt to measure the coronal magnetic field based on directly observed 2d images alone , while we needed stereoscopically triangulated 3d loop coordinates @xmath131 from stereo in previous studies .",
    "there exists only one other study ( to our knowledge ) that heads into the same direction of forward - fitting a nlfff model to 2d data ( malanushenko , 2012 ) , using simulated 2d data based on analytical nlfff solutions ( from low and lou 1990 ) or previous nlfff modeling ( from schrijver , 2008 ) .",
    "we forward - fitted analytical nlfff approximations to four active regions ( cases a , b , c , d ) using 2d loop tracings only and compared them with previous nlfff fits using ( stereoscopic ) 3d loop coordinates .",
    "furthermore we forward - fitted analytical nlfff approximations to another active region using visual 2d loop tracings ( case e ) or automatically traced 2d loop coordinates ( case f ) .",
    "our findings of these exercises are the following :    1 .   our forward - fitting experiment with two different methods demonstrated that a nonlinear force - free magnetic field ( nlfff ) solution @xmath132 can be obtained with equal accuracy _ with or without stereoscopy_. this result relinquishes the necessity of stereo data for future magnetic modeling of active regions on the solar disk , but the availability of suitable stereo data was crucial to establish this result .",
    "the accuracy of a forward - fitted nlfff approximation that includes vertical currents ( with twisted azimuthal magnetic field components ) matches coronal loops observed in euv with a median 2d misalignment angle of @xmath133 , while stereoscopic 3d data exhibit a commensurable 2d misalignment angle , but a substantially larger 3d misalignment angle ( @xmath92 ) , which implies stereoscopic measurement errors in the order of @xmath134 .",
    "these substantial stereoscopic measurement errors lead to less accurate nlfff fits than 2d loop tracings with unconstrained line - of - sight positions .",
    "2d loop tracings in high resolution images ( @xmath104 pixels with trace ) lead to more accurate nlfff fits ( with a misalignment angle of @xmath103 in case e ) than images with lower spatial resolution ( @xmath105 pixels with stereo ) , yielding @xmath135 for the cases a , b , c , and d. 4 .   visually ( or manually ) traced 2d loop coordinates appear to be still superior to the best automated loop tracing algorithms , yielding a misalignment angle of @xmath103 ( in case e ) versus @xmath136 ( in case f ) .",
    "magnetic field strengths @xmath137 of best - fit nlfff approximations are retrieved with an accuracy of @xmath114 , comparing the 2d loop tracing method with the stereoscopic 3d triangulation method .",
    "magnetic energies differ by a factor of @xmath138 between the two methods , while the free energy has a systematic error of @xmath139 ( of the total magnetic energy ) between the two methods , which is about an order of magnitude smaller than found between other ( standard ) nlfff codes .",
    "the computational speed of our nlfff code allows the computation of a space - filling magnetic field configuration of an active region in about 0.01 s , while forward - fitting to a set of coronal loops is feasible with about @xmath125 iterations , requiring a total computation time of a few minutes .",
    "these results demonstrate clearly that we can perform accurate nlfff magnetic modeling based on 2d loop tracings , which will relinquish the need of stereo data in future , at least for active regions near the solar disk center .",
    "the analyzed active regions extended up to 0.65 solar radii away from disk center , so in principle we can perform nlfff modeling for at least half of the number of active regions observed on the solar disk , especially since the parameterization of our analytical nlfff approximation takes the sphericity of the solar surface fully into account ( which is not the case in most other nlfff codes ) . for future developments",
    "we expect that other nlfff codes could implement minimization of the misalignment angle @xmath56 with coronal loops in parallel to the optimization of force - freeness and divergence - freeness , rather than by preprocessing of vector boundary data .",
    "further improvements in automated 2d loop tracings could replace visual / manual tracing methods and this way render nlfff modeling with coronal constraints in a fully automated way .",
    "the author appreciates the constructive comments by an anonymous referee and helpful discussions with allen gary , anna malanushenko , marc derosa , and karel schrijver .",
    "part of the work was supported by nasa contract nng 04ea00c of the sdo / aia instrument and the nasa stereo mission under nrl contract n00173 - 02-c-2035 .",
    "amari , t. , boulmezaoud , t.z . and mikic , z . , 1999 , 350 , 1051 .",
    "amari , t. , boulmezaoud , t.z . , and aly , j.j . , 2006 , , 446 , 691 .",
    "aschwanden , m.j . ,",
    "lee , j.k . ,",
    "gary , g.a . , smith , m . , and inhester , b .",
    "2008a , , 248 , 359 .",
    "aschwanden , m.j . ,",
    "wuelser , j.p . ,",
    "nitta , n.v . , and lemen , j.r .",
    "2008b , , 679 , 827 .",
    "aschwanden , m.j . ,",
    "nitta , n.v .",
    ", wuelser , j.p . , and lemen , j.r .",
    "2008c , , 680 , 1477 .",
    "aschwanden , m.j .",
    ", wuelser , j.p . , nitta , n. , lemen , j. , and sandman , a. 2009 , , 695 , 12 .",
    "aschwanden , m.j . and",
    "sandman , a.w .",
    "2010 , astronomical j. 140 , 723 .",
    "aschwanden , m.j .",
    "2011 , living reviews in solar physics 8 , 5 .",
    "aschwanden , m.j .",
    "2012a , , online - first , doi 10.1007/s11207 - 012 - 0069 - 7 .",
    "aschwanden , m.j . and malanushenko , a. 2012 , , online - first .",
    "aschwanden , m.j . ,",
    "wuelser , j.p . ,",
    "nitta , n. , lemen , j. , schrijver , c.j .",
    "derosa , m. , and malanushenko , a. , 2012a , , 756 , 124 .",
    "aschwanden , m.j . , 2012b , , ( in press ) .",
    "aschwanden , m.j . ,",
    "wuelser , j.p . ,",
    "nitta , n.v . , and lemen , j.r . , 2012b , , 281 , 101 .",
    "conlon , p.a . and",
    "gallagher , p.t . , 2010 , , 715 , 59 .",
    "derosa , m.l .",
    ", schrijver , c.j . ,",
    "barnes , g. , leka , k.d . , lites , b.w .",
    ", aschwanden , m.j . , amari , t. , canou , a. , mctiernan , j.m . ,",
    "regnier , s. , thalmann , j. , valori , g. , wheatland , m.s . ,",
    "wiegelmann , t. , cheung , m.c.m . , conlon , p.a . ,",
    "fuhrmann , m. , inhester , b. , and tadesse , t. 2009 , , 696 , 1780 .",
    "feng , l. , wiegelmann , t. , inhester , b. , solanki , s. , gan , w. q. , and ruan , p. , 2007",
    ", , 241 , 235 .",
    "gold , t. and hoyle , f .",
    "1960 , mnras 120/2 , 89 .",
    "grad , h. , rubin , h. , 1958 , _ proc .",
    "2nd un int .",
    "peaceful uses of atomic energy _ , 31 , 190 .",
    "handy , b. , 1999 , , 187 , 229 .",
    "inhester , b. 2006 , arxiv e - print : astro - ph/0612649 .",
    "inhester , b. , feng , l . , and wiegelmann , t . , 2008 , , 248 , 379 .",
    "jing , j. , tan , c . ,",
    "yuan , y. , wang , b. , wiegelmann , t. , xu , y . , wang h. , 2010 , , 713 , 440 .",
    "low , b.c . , and",
    "lou , y.q .",
    ", 1990 , , 408 , 689 .",
    "malanushenko , a. , longcope , d.w . , and mckenzie , d.e . , 2009 , , 707 , 1044 .",
    "malanushenko , a. , schrijver , c.j . ,",
    "derosa , m.l . ,",
    "wheatland , m.s . ,",
    "gilchrist , s.a .",
    ", 2012 , , 756 , 153 .",
    "metcalf , t.r . ,",
    "jiao , l. , uitenbroek , h. , mcclymont , a.n . , canfield , r.c .",
    "1995 , , 439 , 474 .",
    "sandman , a. , aschwanden , m.j . , derosa , m. , wuelser , j.p . and alexander , d. 2009 , , 259 , 1 .",
    "sandman , a.w .",
    "and aschwanden , m.j .",
    "2011 , , 270 , 503 .",
    "scherrer , p.h . , , 1995 , , 162 , 129 .",
    "schrijver , c.j . , derosa , m. , metcalf , t.r . ,",
    "liu , y. , mctiernan , j. , regnier , s. , valori , g. , wheatland , m.s . , and wiegelmann , t. 2006 , , 235 , 161 .",
    "schrijver , c.j .",
    ", derosa , m. , metcalf , t.r .",
    ", barnes , g. , lites , b. , tarbell , t. , mctiernan , j. , valori , g. , wiegelmann , t. , wheatland , m.s . ,",
    "amari , t. , aulanier , g. , demoulin , p. , fuhrmann , m. , kusano , k. , regnier , s. , and thalmann j.k . , 2008 , , 675 , 1637 .",
    "valori , g. , kliem , b. , and fuhrmann , m. , 2007 , , 245 , 263 .",
    "wheatland , m.s . ,",
    "sturrock , p.a . ,",
    "roumeliotis , g. 2000 , , 540 , 1150 .",
    "wheatland , m.s .",
    ", 2006 , , 238 , 29 .",
    "wheatland , m.s . and regnier , s. , 2009 , 700 , l88 .",
    "wiegelmann , t. , 2004 , , 219 , 87 .",
    "wiegelmann , t. , inhester , b. , and feng , l. 2009 , annales geophysicae 27/7 , 2925 .",
    "wiegelmann , t. and sakurai t. 2012 , living rev .",
    "solar phys . ,",
    "wlser j.p . , 2004 , spie , 5171 , 111 .",
    "yang , w.h . ,",
    "sturrock , p.a . , and antiochos , s.k .",
    ", 1986 , , 309 , 383 .",
    "lrrrrrr n7 & 0.3 & @xmath140 & @xmath141 & @xmath142 & 1.009 & 1.034 + n8 & 2.1 & @xmath143 & @xmath144 & @xmath140 & 1.010 & 1.009 + n9 & 3.0 & @xmath145 & @xmath146 & @xmath144 & 1.016 & 1.015 + n10 & 16.5 & @xmath147 & @xmath148 & @xmath149 & 1.055 & 1.054 + n11 & 12.5 & @xmath150 & @xmath143 & @xmath151 & 1.066 & 1.050 + n12 & 17.8 & @xmath152 & @xmath146 & @xmath153 & 1.140 & 1.094 + & & & & & + mean & @xmath154 & @xmath155 & @xmath156 & @xmath157 & & +    lllllrcc a & 10953 ( s05e20 ) & 2007-apr-30 & 23:00 - 23:20 & 22:24 & stereo 6.0@xmath158 & 200 & [ -3134,+1425 ] + b & 10955 ( s09e24 ) & 2007-may-9 & 20:30 - 20:50 & 20:47 & stereo 7.1@xmath158 & 70 & [ -2396,+1926 ] + c & 10953 ( n03w03 ) & 2007-may-19 & 12:40 - 13:00 & 12:47 & stereo 8.6@xmath158 & 100 & [ -2056,+2307 ] + d & 10978 ( s09e06 ) & 2007-dec-11 & 16:30 - 16:50 & 14:23 & stereo 42.7@xmath158 & 87 & [ -2270,+2037 ] + e & 8222 ( n22w30 ) & 1998-may-19 & 22:21 - 22:22 & 20:48 & trace ( manu ) & 201 & [ -1787,+1200 ] + f & 8222 ( n22w30 ) & 1998-may-19 & 22:21 - 22:22 & 20:48 &",
    "trace ( auto ) & 222 & [ -1787,+1200 ] +    lrrrrrr a ) 2007-apr-30 & 1103 & @xmath159 & @xmath152 & @xmath160 & 1.006 & 1.007 + b ) 2007-may-9 & 208 & @xmath161 & @xmath145 & @xmath146 & 1.023 & 1.009 + c ) 2007-may-19 & 415 & @xmath162 & @xmath163 & @xmath164 & 1.085 & 1.053 + d ) 2007-dec-11 & 390 & @xmath165 & @xmath149 & @xmath166 & 1.044 & 1.026 + e ) 1998-may-19 ( manu ) & 631 & & & @xmath167 + f ) 1998-may-19 ( auto ) & 915 & & & @xmath168 + & & & & & + ( a - f ) mean & @xmath169&@xmath170 & @xmath171 & @xmath172 +"
  ],
  "abstract_text": [
    "<S> we developed a new nonlinear force - free magnetic field ( nlfff ) forward - fitting algorithm based on an analytical approximation of force - free and divergence - free nlfff solutions , which requires as input a line - of - sight magnetogram and traced 2d loop coordinates of coronal loops only , in contrast to stereoscopically triangulated 3d loop coordinates used in previous studies . </S>",
    "<S> test results of simulated magnetic configurations and from four active regions observed with stereo demonstrate that nlfff solutions can be fitted with equal accuracy with or without stereoscopy , which relinquishes the necessity of stereo data for magnetic modeling of active regions ( on the solar disk ) . </S>",
    "<S> the 2d loop tracing method achieves a 2d misalignment of @xmath0 between the model field lines and observed loops , and an accuracy of @xmath1 for the magnetic energy or free magnetic energy ratio . </S>",
    "<S> the three times higher spatial resolution of trace or sdo / aia ( compared with stereo ) yields also a proportionally smaller misalignment angle between model fit and observations . </S>",
    "<S> visual / manual loop tracings are found to produce more accurate magnetic model fits than automated tracing algorithms . </S>",
    "<S> the computation time of the new forward - fitting code amounts to a few minutes per active region . </S>"
  ]
}