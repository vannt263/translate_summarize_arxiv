{
  "article_text": [
    "the calculation of an interacting @xmath0-matrix is one of the first problems encountered in quantum field theory ( qft )  @xcite .",
    "the majority of physical models must be calculated perturbatively in the coupling constant and there exists a whole calculational industry with one sole purpose : to make the increasingly tedious calculations manageable for a large variety of interaction lagrangians  @xcite .",
    "selected theories ( such as the @xmath2 model ) were studied even in more detail providing many - loop expansions in terms of the feynman diagrams including closed expressions for their multiplicity factors  @xcite .",
    "these works fall into a broader effort of the feynman diagram enumeration  @xcite .",
    "the purpose of this paper is to develop a different method to construct perturbative contributions which is based on ( what seems to be ) an unexplored link between wick s theorem  @xcite ( or its statistics equivalent due to isserlis  @xcite ) and a certain system of linear diophantine equations .",
    "based on this insight , our approach is readily applicable to a large class of boson scalar theories and have a great chance of being generalized to a much larger class of theories typically considered in qft .",
    "it is not our goal to compete with the aforementioned multipurpose packages to perform perturbative calculations .",
    "rather , we hope that our method will offer a new conceptual insight into perturbative calculations where a speedy calculation of scattering amplitudes and multiplicities would be a nice bonus .",
    "indeed , from the practical point of view , the method provides an extremely streamlined and versatile way of calculating the @xmath0-matrix contributions including multiplicities to a high perturbative order , for any number of interacting fields and for a large class of real scalar bosonic theories without the need to summon feynman s diagrams ( all position - based feynman diagrams are automatically obtained in the diophantine approach ) . a strategy to go beyond scalar boson models",
    "is outlined as well .",
    "the effortless nature of the presented method is quite surprising due to the fact that solving diophantine equations has a well - earned reputation of being hard . in more detail , it turns out that the number of ways to simplify an @xmath1-point green s function is given by all nonnegative solutions of a linear diophantine system .",
    "this , on the other hand , is a problem equivalent to counting the number of interior points of convex polyhedra  a major topic in algebraic geometry  @xcite .",
    "there are circumstances where the increase of perturbative components does not make sense from the physical point of view .",
    "it is well known that some theories are ( super)renormalizable and others are not ( depending of the spacetime dimension @xmath3 )  @xcite .",
    "additionally , infinities of a different type creep even into those theories which are renormalizable because their perturbative expansion is asymptotic  @xcite .",
    "a typical example is the quantum electrodynamics lagrangian  @xcite whose perturbative contributions start to increase at the order of the inverse of the fine - structure constant .",
    "nonetheless , we feel that the generality of the presented method and its potential to go beyond boson theories together with so far unnoticed connection ( to the best author s knowledge ) of perturbative calculations to algebraic geometry / number theory makes the method interesting and we return to the potentially fruitful link between qft perturbative calculations and lattice polyhedra in the last section .",
    "it may seem that the number of real scalar boson theories in qft that are worth of exploring to any order and for any number of interacting fields is limited .",
    "even if it was true , there exists a number of physical processes where such expansions are desirable .",
    "one of them is a model of a real scalar field linearly coupled to a two - level quantum system known as the unruh - dewitt ( udw ) particle detector .",
    "it was conceived in  @xcite , improved  @xcite and studied in many physical situations  @xcite . the starting point for perturbative calculations",
    "is the hamiltonian formalism ( equivalent to the lagrangian approach in the absence of a derivative coupling ) .",
    "but one quickly notices a qualitative difference compared to the perturbative expansions in qft since the problem does not seem to suffer from the convergence problems  @xcite .",
    "contrary to a typical situation in qft , it is shown that the number of perturbative terms grows polynomially with the perturbative order .",
    "it is not clear whether an actual non - perturbative solution exists ( we leave it as an interesting open problem ) but the main result of our calculation based on a diophantine system of linear equations is the next best thing : an efficiently calculable expansion to an arbitrary order in the coupling constant .",
    "the paper is organized as follows . after a brief recollection of the scalar boson theory in section  [ sec : bosonsinteracting ] through its lagrangian formulation we present the main findings of this paper in section  [ sec : diophantinesols ] .",
    "this is accompanied by several examples in section  [ sec : apps ] of the perturbative contributions of the @xmath2 and @xmath4 theory ( for an easy comparison with the published results ) and their multiplicities and one major application which is the perturbative calculation of a pair of udw detectors to an arbitrary order in the coupling constant . in section  [ sec : beyondscalars ] we discuss the necessary steps in order to generalize the current formalism to more complicated perturbative models in qft and section  [ sec : discussions ] concludes with several open problems .",
    "an important object of study in interacting qft is the s - matrix , which is proportional to the @xmath1-point interacting green s function @xmath5 where @xmath6 is the interacting vacuum for the given theory , @xmath7 are the interacting fields and @xmath8 stands for the time - ordering operator . in the lagrangian formulation of the theory",
    "the way of calculating green s function   is through the formula  @xcite @xmath9\\}}{\\mathop{|0_m\\rangle}\\nolimits}\\over{\\mathop{\\left<0_m\\,\\right|}\\nolimits}\\mathsf{t }    \\{\\exp{[i\\int{\\mathrm{d}^d z}{\\pazocal{l}}_{\\mathrm{int}}]}\\}{\\mathop{|0_m\\rangle}\\nolimits}},\\ ] ] where the interacting part of the complete lagrangian @xmath10 appears , @xmath11 are free fields and @xmath12 is a free ground state in @xmath3-dimensional minkowski spacetime ( minkowski vacuum ) .",
    "the type of theories we will study in this work are the @xmath13-mode boson scalar theories whose free lagrangian reads @xmath14 and the interaction part can take many different forms . instead of trying to write the most general @xmath15 , we will list several types of interaction ( omitting the multiplicative terms making the lagrangian densities of dimension  @xmath16 ) : @xmath17 in the first line we set @xmath18 , in the second item we skipped the numerical prefactors and in the third line we have @xmath19 with @xmath20 forming a @xmath13-component boson field exhibiting the @xmath21 symmetry ( the so - called @xmath21 sigma model ) .",
    "the fields in   are real but the current analysis is equally applicable to complex fields with only minor modifications ( and for suitable interaction lagrangians  we discuss this and other possible generalizations in section  [ sec : beyondscalars ] ) .",
    "this is due to the fact that @xmath22 and @xmath23 must be considered independent .",
    "after all , the @xmath24 sigma model can be rewritten as a one - mode complex theory whose interaction term reads @xmath25 .    by looking at the rhs of  ,",
    "the solution is given by expanding the numerator around the coupling parameter .",
    "the denominator ( the free @xmath0-matrix ) is known to factor out and this removes the disconnected contributions of the scattering amplitudes in the numerator . here comes our main contribution .",
    "we present an efficient way of calculating the perturbative expansion of the numerator of   for arbitrary number @xmath26 of interacting fields @xmath27 , for an extensive class of interaction lagrangians such as those in eqs .   and to any perturbative order in the coupling constant .",
    "a generic expansion element in the numerator reads @xmath28 and the expectation value ( the @xmath29-point green s function ) is the focus of this work .",
    "here we make the perturbative calculations extremely straightforward for _ any _ @xmath30 and @xmath26 without relying on feynman rules or constructing feynman position - space diagrams .",
    "we show how to efficiently factorize the @xmath29-point green s function for large @xmath31 into a sum of products of two - point green s functions ( feynman propagators ) with no effort whatsoever .",
    "this is typically the most tedious step when dealing with perturbation techniques .",
    "lagrangians may also contain derivative interactions @xmath32 .",
    "this is more or less a technical issue despite the fact that the identity @xmath33 complicates the extraction of the derivatives out of the propagator .",
    "it was shown in  @xcite that the delta function contributions cancel out in the perturbative expansion of the whole @xmath0-matrix . hence , in principle , we could use the ` essentially ' correct identity @xmath34 and perform the same analysis we will present here .",
    "[ thm : isserlis ] let @xmath35 be a gaussian random variable satisfying @xmath36=0 $ ]",
    ". then @xmath37=\\sum_{r=1}^{(2m-1)!!}\\prod_{\\genfrac{}{}{0pt}{2}{j ,",
    "k=1}{j < k}}^{m}\\bbe_r[x_{j}x_{k}],\\ ] ] where the sum goes over the products of bivariate expectation values @xmath38 .",
    "in our case the gaussian random variable will be a product of time - ordered free scalar fields @xmath11 and @xmath39 and the expectation value will be taken w.r.t . to minkowski vacuum @xmath12 : @xmath40={\\mathop{\\left<0_m\\,\\right|}\\nolimits}\\mathsf{t}\\big\\{\\prod_{i=1}^{2m}\\phi_{i}\\big\\}{\\mathop{|0_m\\rangle}\\nolimits}\\equiv\\lan\\prod_{i=1}^{2m}i\\ran_0,\\ ] ] where @xmath41 ( or @xmath42 ) and on the rhs is the minimalist notation we will be mostly using .",
    "the theorem is also known as wick s theorem  @xcite .",
    "wick s theorem transforms time - ordered operator expressions into a normal form  @xcite and isserlis result is recovered upon taking a ( free ) vacuum expectation value . as a matter of fact ,",
    "isserlis theorem is more general since naturally there is no notion of time - ordering in eq .",
    "( [ eq : isserlis ] ) and so the theorem applies even for ` ordinary ' products of free scalar fields .",
    "of course , we are actually calculating the time ordered version as it appears in the definition of the sought green s function .",
    "for @xmath43 different random variables @xmath35 ( scalar fields",
    "@xmath44 ) in eq .  ( [ eq : notation ] ) there is nothing else to say but isserlis theorem can be refined if the number of _ different _ variables @xmath35 in   is less than @xmath43 .",
    "[ def : compositions ] a @xmath26-composition of @xmath45 is @xmath1 written as an ordered sum of @xmath26 strictly positive integers .",
    "order matters unlike for integer partitions .",
    "there are @xmath46 @xmath26-compositions of @xmath1 .",
    "for example , for @xmath47 , there are three 2-compositions : @xmath48 and @xmath49 .",
    "[ def : lexi ] given a finite set of positive integers @xmath50 we define the lexicographic ordering on the subset of two elements of @xmath51 as @xmath52 iff @xmath53 or @xmath54 together with @xmath55 .",
    "[ thm : isserlisrefined ] let @xmath56 such that @xmath57 . then , green s function @xmath58 can be written as a product of two - point correlation functions @xmath59 where @xmath60 is the product multiplicity , @xmath61 and @xmath62 .",
    "the number of products is a polynomial function of @xmath63 for a fixed number of fields @xmath64 .",
    "[ def : coformations ] a product @xmath65  is called a  _ conformation _ and @xmath66 a _",
    "conformation exponent_.    the conformation exponent @xmath66 will always be lexicographically ordered but it is not necessary for the proof of the above theorem .    to solve eq .",
    "( [ eq : greensproduct ] ) means to find all nonnegative solutions @xmath67 of the system @xmath68 where @xmath69 .",
    "it is a system of linear diophantine equations and they have zero , one or infinitely many solutions ( counting both positive and negative ones ) . in this case , the numerical coefficients for the variables @xmath67 are simple so we can easily guess a solution for @xmath70 in   ( say @xmath71 and so @xmath72 which has infinitely many solutions ) .",
    "it also means that there are finitely many nonnegative solutions @xmath67 we are looking for .",
    "let us prove the second statement first and polynomially upper bound the number of non - negative solutions . by setting @xmath73 ,",
    "the first row of   becomes @xmath74 let us also set @xmath75 for the moment .",
    "the task of finding the number of nonnegative solutions resembles the problem of finding the number of @xmath26-compositions of @xmath76 ( see definition  [ def : compositions ] ) . indeed ,",
    "if we take @xmath77 then we only need to know how to distribute @xmath78 @xmath26-composition in @xmath79 ` slots ' . or , put differently , how many ways we can pad a @xmath26-composition with zeros .",
    "this equals to @xmath80 and by summing over all @xmath26-compositions we get @xmath81 we have to add all possible @xmath82 on the rhs of  . since @xmath83 , the parameter @xmath76 decreases by the multiples of two so we will need to distinguish between odd and even @xmath76 and sum only the appropriate ones .",
    "but we are interested in an upper bound so let s pretend @xmath76 can be any positive integer and just calculate @xmath84 where @xmath85 is a polynomial of degree @xmath86 .",
    "there is @xmath64 linear equations in system  .",
    "each consecutive equation has one independent variable less than the previous one but if we assume for a while that all @xmath64 equations contain  @xmath64 independent variables then the number of solutions is upper bounded by a polynomial of degree @xmath87 .",
    "how do we obtain all nonnegative solutions in a systematic way ?",
    "since @xmath88 and @xmath89 for @xmath90 we start in the first equation of system   ( @xmath70 ) by fixing the lowest possible values of @xmath91 up to @xmath92 ( @xmath93 ) and simply list all the admissible @xmath94 s for @xmath95 .",
    "we continue by increasing @xmath92 by one and repeat the procedure until we hit @xmath96}$ ] .",
    "then we repeat the whole process for @xmath97 all the way to @xmath98 . in the next step we move to   for @xmath99 by inserting all",
    "found @xmath64-tuples @xmath100 and repeat the procedure until we find all admissible solutions in the second row .",
    "as a result we obtain an @xmath101-tuple @xmath102 . as it is clear from   the second row ` inherits ' one variable ( @xmath103 ) from the first row .",
    "we continue in a similar fashion for all @xmath104 .",
    "the result is a complete list of @xmath105-tuples @xmath66 thus solving eqs .",
    "( [ eq : diophantgeneral ] ) .",
    "note that the number of nonnegative solutions is gruesomely overestimated .",
    "one can convert the second part of the proof of theorem  [ thm : isserlisrefined ] into a program that systematically finds all the solutions . essentially , if it takes one time step to find the first solution then all the @xmath106 solutions can be find in @xmath106 time steps where @xmath106 increases polynomially .",
    "there is really no need for solving a diophantine system by some sophisticated number - theoretic methods since due to the simple form of  ( [ eq : diophantgeneral ] ) we get _ all _ nonnegative solutions by inspection and only need to list them ( i.e. , save them to the memory ) .",
    "a related problem is how to get a closed form for the number of nonnegative solutions for given @xmath63 and @xmath64 without actually listing and counting the solutions .",
    "this is a nontrivial task attempted by the author in a very special case of @xmath107 and @xmath108  @xcite ( the chosen values have no relevance to perturbative qft ) .",
    "it is a problem studied by the ehrhart theory  @xcite where the interior points of convex lattice polyhedra are counted  @xcite .",
    "the ehrhart theory does not provide a closed expression for the number of lattice points , however , and , typically , computer algebra systems are used to count the interior points .",
    "the connection to convex geometry comes from rewriting system   as a system of inequalities @xmath109 which is an algebraic definition of a convex polyhedron .    to get the conformation multiplicity factor @xmath110 in theorem  [ thm : isserlisrefined ] we present an auxiliary lemma .",
    "[ lem : fcncardinality ] let @xmath0 and @xmath111 be discrete sets where @xmath112 .",
    "then there is @xmath113 bijective functions @xmath114 where @xmath115 and @xmath116 where @xmath117 .",
    "for @xmath118 we set eq .",
    "( [ eq : fcncardinality ] ) to one .",
    "if @xmath119 then  ( [ eq : fcncardinality ] ) becomes @xmath120 which is known to be the number of bijections from a set to itself ( the number of permutations ) . to make the notation more concise in following text we will use the definition of the falling factorial : @xmath121_n\\df m\\times\\ldots\\times ( m - n+1)$ ] .",
    "so eq .  ( [ eq : fcncardinality ] ) becomes @xmath122_n$ ] .",
    "the coefficient @xmath123 is simply a number of all possible domains @xmath124 whose cardinality is @xmath1 .",
    "then for every domain @xmath125 there is @xmath126 codomains @xmath127 of the same cardinality .",
    "the coefficient @xmath120 comes from the number of permutations within each of @xmath128 codomains @xmath129 .",
    "[ thm : multiplicity ] the multiplicity factor @xmath110 for a given conformation exponent @xmath66 reads @xmath130 where    [ eq : gammas ] @xmath131_{\\a_{ij}},\\label{eq : gammasgaij }      \\end{aligned}\\ ] ]    where @xmath132_{\\a_{ij}}$ ] denotes the falling factorial introduced in the remark below lemma  [ lem : fcncardinality ] .    we will use repeatedly lemma  [ lem : fcncardinality ] by identifying @xmath133 for @xmath90 from theorem  [ thm : isserlisrefined ] by setting : @xmath134 set @xmath0 is the set of all @xmath104 s and @xmath111 is the set of all @xmath135 s .",
    "however , if we calculate more than one two - point green s function ( like in theorem  [ thm : isserlisrefined ] ) we have to take into account the fact that the sets @xmath0 and @xmath111 might have shrunk .",
    "this depends on whether in the preceding green s function @xmath136 we had @xmath137 or @xmath138 .",
    "the strategy we will follow here is to first count the multiplicity of @xmath139 as they are independent ( meaning non - overlapping for different @xmath104 s ) and then the multiplicities of @xmath133 . in that case",
    "the derivation follows the lexicographic ordering , def .",
    "[ def : lexi ] , which is a handy tool here .",
    "the multiplicity of @xmath139 immediately follows from isserlis theorem .",
    "looking at eq .",
    "( [ eq : isserlis ] ) we see that if @xmath140 there will be @xmath141 identical products .",
    "hence ( @xmath30 is @xmath142 here ) @xmath143 as follows from eq .",
    "( [ eq : fcncardinality ] ) as stated or from the counting done in lemma  [ lem : fcncardinality ] . ] .",
    "the factor of two in the binomial ` denominator ' accounts for the two @xmath104 s in @xmath144 .",
    "repeating this procedure for all @xmath104 we get @xmath145 in eq .",
    "( [ eq : gammasgamma ] ) . to get @xmath146 we then have to keep track of the set cardinality and",
    "this is the point where the used lexicographic order becomes important .",
    "we follow the ordered set of @xmath147 where @xmath148 ( note the sharp inequality ) . hence , @xmath149 and we find all @xmath146 where @xmath90 .",
    "the first one is @xmath150 and so we set @xmath151 ( using the notation of lemma  [ lem : fcncardinality ] ) and notice that the cardinality of the discrete set of ` ones ' is decreased by those contributing to the previously analyzed case @xmath152 , namely @xmath153 .",
    "so @xmath154 .",
    "similarly , the cardinality of the ` twos ' is decreased by the number of elements contributing to @xmath155 .",
    "so @xmath156 and @xmath157_{\\a_{12}}$ ] follows . at this point",
    "we can proceed and construct a generic @xmath146 .",
    "the ` source pool ' of @xmath104 s will be depleted by three contributions : @xmath158 and @xmath159 .",
    "the bounds of the sums are chosen such that only the preceding contributions to the sought @xmath146 are accounted for .",
    "similarly , the ` target pool ' of @xmath135 s is depleted by @xmath160 and @xmath161 , but the sum bounds only choose those contributions preceding @xmath146 ( using the lexicographic ordering ) .",
    "we notice an interesting asymmetry , where in the falling factorial part of   there is only one sum .",
    "this is because all ( negative ) contributions @xmath162 come after any @xmath146 given the lexicographic ordering and @xmath163 was taken care of separately .",
    "we again emphasize the importance of the lexicographic ordering by which we followed the construction of @xmath146 s .",
    "other orderings are certainly plausible and have to provide the same @xmath110 , eq .  .",
    "but we believe the lexicographic ordering and the construction based on it is the most intuitive one .    having a decomposition into a product of two - point green s functions obtained through theorem  [ thm : isserlisrefined ] we can proceed as usual .",
    "the position - based feynman diagrams can be immediately read off from the products of green s functions . however , even different diophantine solutions ( different green s products ) lead to the same feynman diagram , that is , to the same physical processes .",
    "this is typical for real scalar theories since when we permute the internal degrees of freedom it is often the same physical process ( the same integral in the @xmath0-matrix ) . however , when charges are involved , like for complex fields , the internal lines are directed and we may need to distinguish among the diophantine solutions .",
    "for more , see sections  [ sec : apps ] and  [ sec : beyondscalars ] . at this point",
    "it is advantageous to express our results in the language of graph theory which leads to feynman diagrams .",
    "this is just an advantageous way of presenting the results and not a starting point as it typically is in qft .",
    "the connection between feynman diagrams and graph theory is well - documented  @xcite and here we recall a few basic concepts and results  @xcite .    [ def : graph ] a labeled undirected graph @xmath164 is a set of vertices @xmath165 and a set @xmath166 of unordered pairs of elements of @xmath165 called edges .",
    "a graph is called simple if no loops and no multiple edges connecting the same pair of vertices are allowed .",
    "graphs allowing both loops and multiple edges are called pseudographs .    the following definition of graph isomorphism is split into two : the standard one  @xcite and a version upgraded by a requirement on the labeling ,",
    "see  ( * ? ? ?",
    "* chapter  1 ) .",
    "we will need both definitions .",
    "[ def : graphisoauto ] a type-1 graph isomorphism @xmath167 is a bijection @xmath168 such that @xmath169 .",
    "a type-2 graph isomorphism @xmath170 is a bijection @xmath171 such that @xmath172 while also preserving the labeling .",
    "an automorphism of a labeled graph @xmath173 is defined as @xmath174 .",
    "the set of all automorphisms of @xmath173 forms the group @xmath175}$ ] .",
    "if we restrict ourselves to boson scalar theories then a position - based feynman diagram is a labeled undirected pseudograph @xmath164 ( we will omit the prefix pseudo- and all other adjectives from now on unless we need them to avoid confusion ) .",
    "the main observation here is that the conformation exponent @xmath176 from theorem  [ thm : isserlisrefined ] generates @xmath173 where @xmath177 and @xmath178 .",
    "let us summarize in    we call @xmath179 an @xmath66-generated labeled undirected graph if every @xmath180 ( from theorem  [ thm : isserlisrefined ] ) denotes @xmath67 edges connecting two vertices @xmath104 and @xmath135 .",
    "we split the edges and vertices into external and internal ones according to the details of the studied boson theory , calculated perturbative order and the number of interacting fields and write @xmath181 .",
    "we further define the internal subgraph of @xmath179 as @xmath182 .",
    "the internal vertices are the internal degrees of freedom that are integrated over in lagrangian   ( @xmath183 ) .",
    "the external vertices represent the interacting fields ( @xmath184 ) and are connected to the internal vertices by external edges .",
    "the internal edges connect the internal vertices . finally , only connected graphs are considered .",
    "a symmetric adjacency matrix is a way of encoding an undirected graph .",
    "if we take an upper - triangular part of the matrix and flatten it row by row we get our conformation exponent  @xmath66 .",
    "@xcite[thm : labelings ] the number of labelings of a given graph  @xmath173 with @xmath185 vertices is @xmath186}|}.\\ ] ]    theorem  [ thm : labelings ] answers the question of how many labeled type-1 isomorphic graphs to @xmath173 there are .",
    "[ lem : feynmanmulti ] let @xmath179 be an @xmath66-generated labeled undirected graph where @xmath187 and @xmath188 together with @xmath189 . given a partition of @xmath190 into @xmath191 disjoint sets @xmath192 of cardinality @xmath193 @xmath194 there is @xmath195}|}\\ ] ] feynman diagrams representing the same physical interaction .",
    "we set @xmath196 .",
    "let us emphasize what we do and do not count in this lemma . in fig .",
    "[ fig : multipl ]  ( a ) , there is an example of a simple feynman diagram with 4 ! ways of permuting the external vertices .",
    "but at the level of a system of diophantine equations , all 4 !",
    "possibilities corresponds to a single nonnegative solution and its multiplicities were calculated in theorem  [ thm : multiplicity ] . in fig .",
    "[ fig : multipl ] ( b ) , there is a generic @xmath66-generated graph where the grey circle represents an arbitrary relation among the six internal vertices @xmath197 .",
    "there can be multiple edges and loops and internal vertices need not be connected to any external vertex .",
    "the external vertices are labeled by @xmath35 and a swap of @xmath35 with different @xmath197 corresponds to a different solution of a diophantine system .",
    "all such possibilities are then enumerated by @xmath198 in  .",
    "the graph @xmath179 is @xmath66-generated and so we assume that if an internal vertex connects to one or more external vertices their number is fixed .",
    "then , the product of binomials @xmath199 counts the number of ways the external vertices can be connected to the internal ones . the @xmath104-th binomial ` numerator ' is depleted by the external vertices already connected to the internal ones and there are naturally many ways ( depending on the order of @xmath200 ) leading to the same result .",
    "the coefficient @xmath201 in   comes from theorem  [ thm : labelings ] and it is a permutation of all internal vertices .",
    "we now introduce two procedures named _ amputation _ ( not to be confused with the equally called procedure for removing infinities in the momentum - based feynman diagrams ! ) and _ grafting _ in order to determine @xmath202}|$ ] . for a given @xmath179",
    "we first remove all the external vertices but keep the external edges ` freely floating ' .",
    "this is called amputation and at this point it is not a graph .",
    "we make it a graph again by creating loops of out the amputated external edges .",
    "this step will be called grafting and the whole procedure is illustrated in fig .",
    "[ fig : ampgraft ] .",
    "the newly created loops hold the information about the internal subgraph symmetry and thus its automorphism group ( using definition  [ def : graphisoauto ]  type-2 isomorphism ) .",
    "then , @xmath203}|}$ ] is the total number of internal graphs with different @xmath66 corresponding to different solutions of the diophantine system leading to the same graph .",
    "note that a grafted graph is not a vacuum feynman diagram .",
    "this can be seen in fig .",
    "[ fig : ampgraft ] on the right where some vertices have different vertex orders ( the number of edges meeting there ) .",
    "it is just a pseudograph we have created to help us calculate the overall multiplicity factor of the graph we started with .",
    "even though the graph automorphism order is always studied when dealing with feynman diagrams ( explicitly like in  @xcite or implicitly like everywhere else ) , our approach invokes it at a different stage of the calculations and for grafted graphs compared to other studies .",
    "how do we calculate @xmath198 ?",
    "there are two different routes",
    ". we can follow theorem  [ thm : labelings ] and that includes the calculation of @xmath202}|$ ] . for moderate graphs ,",
    "it can be done by realizing that the whole list of diophantine solutions @xmath66 splits into several classes of physically indistinguishable processes ( the same feynman diagrams ) .",
    "we take _ any _ representative of the class we are interested in , process it according to the previous lemma and calculate @xmath202}|$ ] .",
    "the problem of graph automorphism is not known to be tractable and is closely related to the well - known graph isomorphism membership problem  @xcite . however , practically efficient algorithms are known and implemented ( for pseudographs and discrete mathematics in general , sage  @xcite is a great tool ) . even though almost all finite graphs possess no symmetry ( that it , a trivial @xmath204}$ ] , as proved in  @xcite for simple graphs ) , we need the exact counting .    to check the graph automorphism order we can take the second route to get @xmath198 . by solving a diophantine system",
    "we get all admissible conformation exponents @xmath66 and within each class there is obviously never the same @xmath66 more than once . in other words ,",
    "the graph automorphism order is already accounted for and @xmath198 is nothing else than the cardinality of the class we are interested in .",
    "we did not get away with the hardness of the problem , though . in order to compute the cardinality we have to take a representative and check how many graphs from the list of all @xmath66 s it is isomorphic to ( using definition  [ def : graphisoauto ] ,  type-1 isomorphism ) .",
    "this approach is most likely harder from the computational complexity viewpoint because the graph isomorphism membership algorithm has to be invoked many times and it is computationally equivalent to the graph automorphism order  @xcite . on the other hand , recall that the diophantine system of solutions grows polynomially and , mainly , many solutions are computationally easy to disprove to be isomorphic to the studied representative by checking whether the graph is ( dis)connected , by counting the edges or checking any other graph invariant  @xcite that is computationally cheap to implement on the level of the conformation exponent @xmath66 ( to name a few more it is the number of loops , the ways the external edges are connected to the internal vertices etc . ) .",
    "but to the author s knowledge there is no guarantee that two different classes always differ at least in one invariant ( for any bosonic theory ) . after finding @xmath198",
    ", we can immediately obtain the graph automorphism order by counting @xmath205 and @xmath206 and inserting it into  eq .  .",
    "both routes will be illustrated in the next section .",
    "our hope is that the structure of a convex lattice polyhedron where all nonnegative solutions of a diophantine system live will provide yet another way of counting the graph automorphism order , this time without the need to run computationally costly algorithms .",
    "we will briefly return to this open problem in section  [ sec : discussions ] .",
    "several explicit examples are worked out in the next section .",
    "one can promptly ( that is , in linear time in the number of diophantine solutions ) processed the solutions of the diophantine system and keep only the diagrams of interest such as all connected diagrams or all vacuum diagrams and so on .",
    "it is well - known that the vacuum contributions in the numerator of eq .",
    "cancel with the free @xmath0-matrix in the denominator  @xcite and the cancellation can be done at the level of diophantine solutions .",
    "again , we illustrate it in the next section",
    ".    let s calculate the third term from the expanded numerator of  eq .",
    "( [ eq : greeninteracting ] ) .",
    "it is proportional to @xmath207 upon setting @xmath108 , eq .",
    "becomes @xmath208 next , we solve   that took the following form :    [ eq : diophantinef4 ] @xmath209    where @xmath210 and @xmath211 .",
    "the result is eleven conformation exponents @xmath212 whose lexicographic ordering is @xmath213 the solutions and the values of @xmath63 are inserted into    [ eq : gammasf4 ] @xmath214_{\\a_{12}},\\label{eq : gammasga12}\\\\        \\g_{13 } & = \\binom{\\ell_1 - 2\\a_{11}-\\a_{12}}{\\a_{13}}[\\ell_3 - 2\\a_{33}]_{\\a_{13}},\\label{eq : gammasga13}\\\\        \\g_{14 } & = \\binom{\\ell_1 - 2\\a_{11}-\\a_{12}-\\a_{13}}{\\a_{14}}[\\ell_4 - 2\\a_{44}]_{\\a_{14}},\\\\        \\g_{23 } & = \\binom{\\ell_2 - 2\\a_{22}-\\a_{12}}{\\a_{23}}[\\ell_3 - 2\\a_{33}-\\a_{13}]_{\\a_{23 } } , \\\\",
    "\\g_{24 } & = \\binom{\\ell_2 - 2\\a_{22}-\\a_{12}-\\a_{23}}{\\a_{24}}[\\ell_4 - 2\\a_{44}-\\a_{14}]_{\\a_{24}},\\\\        \\g_{34 } & = \\binom{\\ell_3 - 2\\a_{33}-\\a_{13}-\\a_{23}}{\\a_{34}}[\\ell_4 - 2\\a_{44}-\\a_{14}-\\a_{24}]_{\\a_{34 } }      \\end{aligned}\\ ] ]    to get eq .",
    "whose explicit form reads @xmath215    we obtain @xmath216 and perform a highly non - trivial check of both theorems  [ thm : isserlisrefined ] and  [ thm : multiplicity ] : @xmath217 we obtained eleven diagrams but not all are physically distinguishable .",
    "to account for them we use theorem  [ thm : multiplicity ] ( valid for connected diagrams which are physically most interesting ) .",
    "the unique diagrams and their conformations are depicted in fig .",
    "[ fig : feynmanphi4 ] . in the first row we put all three connected diagrams ( the first three rows in  ) with multiplicity two which we will now verify . @xmath218 and",
    "@xmath219 hold for all diagrams .",
    "for the left upper diagram we find @xmath220 while for the other two we get @xmath221 .",
    "then , following the procedure of amputation and grafting , we create new graphs where the upper left one has no symmetry ( and so @xmath222}|=1 $ ] ) while the other two are identical upon swapping @xmath223 ( hence @xmath224}|=2 $ ] ) .",
    "so we get    @xmath225    and indeed @xmath226 in   are the other class members for @xmath227 ( in this order ) .",
    "we just explored the two routes of calculating @xmath198 as described below lemma  [ lem : feynmanmulti ] .",
    "a final check is the overall multiplicity of a given feynman diagram : @xmath228 for @xmath229 in accord with  ( * ? ? ?",
    "* table  ii ) .    by solving   for @xmath230",
    "we get 17 conformations @xmath231 and find @xmath232 from  .",
    "a calculation performed in  @xcite leads to a closed expression for the number of non - negative solutions of   ( for @xmath107 even ) to be @xmath233 for @xmath234 we get @xmath235 in accord with the above result . in theory",
    ", one can get closed expressions for the number of nonnegative diophantine solutions following the methods of ehrhart theory  @xcite .",
    "we study @xmath236 by solving the corresponding diophantine system we obtain 960 nonnegative solutions whose conformation exponents will not be listed . after filtering out the disconnect graphs we find in total 8 classes of connected graphs just like in  (",
    "* table  iii ,  @xmath237 ) .",
    "our results completely agree with the multiplicities of all 8 feynman diagrams .",
    "let s provide two class examples whose representatives are @xmath238 where @xmath239 . for @xmath240",
    "we find @xmath241 and @xmath242 .",
    "following lemma  [ lem : feynmanmulti ] we get a grafted graph @xmath243 where @xmath222}|=2 $ ] leading to @xmath244 thus @xmath245 as it should be . in the second case",
    "we have @xmath246 and @xmath247}|=1 $ ] and so @xmath248 therefore , @xmath249 again in agreement with  @xcite .    here",
    "we analyze @xmath250 similarly , the second expansion term of the denominator of   ( the vacuum digrams ) is proportional to @xmath251 using theorem  [ thm : isserlisrefined ] we find 8 conformations for eq .",
    "( [ eq : phi3expansionnum ] ) and theorem  [ thm : multiplicity ] yields their multiplicities @xmath252 we check the solution by inspecting @xmath253 where the rhs follows from @xmath254 and @xmath255 . by considering just connected diagrams ,",
    "@xmath256 and @xmath257 represent the same processes as confirmed by lemma  [ lem : feynmanmulti ] after we do the proper counting , grafting and graph automorphism counting :    @xmath258    hence @xmath259 as we can find in  ( * ? ? ?",
    "* chapter  7 ) .",
    "for   we get only two solutions @xmath260 with multiplicities @xmath261 . as these are vacuum graphs , there is no need to remove the external edges and graft and so following lemma  [ lem : feynmanmulti ] we find that @xmath262 .",
    "the final answer is then @xmath263 in agreement with  ( * ? ? ?",
    "* chapter  7 ) .",
    "a realistic unruh - dewitt detector  @xcite is described by the following interaction hamiltonian @xmath264 and @xmath265 is a real scalar field where @xmath266 is a four - momentum , @xmath267 is a detector s window function ( @xmath268 is its proper time and @xmath269 are minkowski coordinates ) , @xmath270 a smearing function , @xmath271 are the detector ladder operators , @xmath272 stands for the energy gap and @xmath273 for a coupling constant .",
    "the evolution operator for observer @xmath274 reads @xmath275}\\exp{\\big[-i\\int_{\\tau_0}^{\\tau_2}{\\mathrm{\\,d } \\tau''}h_b(\\tau'')\\big]}\\big\\}}.\\end{aligned}\\ ] ]    out task is to efficiently calculate the following unitary ( tensor product and time - ordering implied ) @xmath276 for any @xmath1 , no matter how large , and for any input atomic state .",
    "we denoted @xmath277 and so @xmath278 holds .",
    "note that we set @xmath270 to be a delta function for convenience .",
    "the result of this calculation is oblivious to the details of smearing , window functions or trajectories .",
    "the expression that matters is eq .",
    "( [ eq : twoudwdetectors ] ) together with the fact fact that @xmath279 are boson scalar fields .",
    "our final goal is to express @xmath280-point green s functions in terms of a polynomial number of two - point correlators and not their calculation where these details are relevant .",
    "the matrix elements of  ( [ eq : twoudwdetectors ] ) will be written as @xmath281 where @xmath282 denote the canonical basis of the detectors initial and final state and a tensor product is implied . in all previous examples we calculated a transition amplitude @xmath283 for a perturbatively evolved @xmath0-matrix .",
    "this is a typical task in qft . here",
    "we are after a different ( but , of course , related ) quantity : the transition probability .",
    "more precisely , we want to perturbatively expand density matrix   where the probabilities lie on the diagonal .",
    "we will derive @xmath284 for @xmath285 ( that is , assuming the detectors are in their ground states ) and later argue that a trivial modification of our analysis will enable us to calculate eq .",
    "( [ eq : omega ] ) for any canonical basis state @xmath286 .",
    "this , on the other hand , will lead to a ` standalone ' unitary matrix @xmath287 expressed perturbatively which then can be used to find @xmath284 for _ any _ detector input state and thus completely solving the problem .",
    "we start by taming the exponential number ( in @xmath1 ) of the summands of the core expression ,  eq .",
    "( [ eq : twoudwdetectors ] ) . by plugging the result into  eq .",
    "[ eq : omega ] we get again a polynomial number of @xmath280-point green s functions and apply the results obtained in this paper to express them in terms of the two - point green s functions .",
    "let us recall the algebra of pauli operators representing the two - level detector(s ) .",
    "they satisfy @xmath288 and also @xmath289 together with @xmath290 .",
    "that is , the atomic operators for the two detectors commute in the unruh - dewitt model .",
    "[ prop : phasei ] for @xmath291 we obtain from eq .",
    "( [ eq : twoudwdetectors ] ) @xmath292 and for @xmath293 we get @xmath294    the initial state @xmath295 is a ground state : @xmath296 .",
    "there are two possibilities for the output states : @xmath295 and @xmath297 but taking into account the nilpotency property of @xmath271 we can also enumerate all possible ways the output states can be obtained .",
    "it is simply @xmath298 for all @xmath299 .",
    "all other operator sequences result in zero . in our case",
    "we have two sets of ladder operators  for the @xmath274 and @xmath300 hilbert spaces and so    [ eq : allpaths2atoms ] @xmath301    in the first two lines @xmath1 is even and in the last two lines @xmath1 is odd .",
    "the sums should be understood as counting all possible strings of the sigma operators leading to a given output state on the left and we will now find the explicit expressions . let s call them _",
    "nonzero strings_. given the desired output state , the main observation is that there are always only two sigma operators that do not destroy the previous nonzero string .",
    "this is because every nonzero string acting on @xmath302 can land in only one of the four possible states .",
    "for instance , if the state is @xmath303 the next sigma operator can be @xmath304 or @xmath305 to get another nonzero string .",
    "similarly for the other three states and so we can represent all nonzero strings as a complete binary tree of the depth @xmath1 where we adopt the following convention : the root node is the initial state @xmath302 where the left offsprings correspond to the action of @xmath306 and the right offsprings correspond to @xmath307 .",
    "the nodes are labeled by the resulting state @xmath286 , see fig .",
    "[ fig : littlebintree ] . in all the branchings that follow the left offsprings correspond to the action of @xmath308 and the right offsprings correspond to @xmath309 .",
    "given the offspring node , the choice of either @xmath310 or @xmath311 in the branching is unambiguous .    but this immediately provides the desired counting because we have just proved a bijection between the number of branches of a perfect binary tree of the depth @xmath1 and the number of non - zero strings of the same length .",
    "consider  eq .",
    "( [ eq : allpaths2atoms00 ] ) .",
    "we set the total number of branchings @xmath291 and @xmath312 giving us @xmath313 .",
    "the number of paths with @xmath314 left branchings ( one @xmath76 for @xmath306 and one @xmath76 for @xmath315 making it even since we have to end up in @xmath316 ) out of the total @xmath291 branchings is @xmath317 and so is the number of nonzero strings in  eq .",
    "( [ eq : allpaths2atoms00 ] ) .",
    "identically , for  ( [ eq : allpaths2atoms11 ] ) we again set @xmath291 and @xmath312 and obtain @xmath318 of nonzero strings ( @xmath319 left branchings and @xmath320 right branchings ) . for eq .",
    "( [ eq : allpaths2atoms01 ] ) we set @xmath293 and @xmath312 .",
    "hence @xmath321 is the total number of nonzero strings . finally , for eq .",
    "( [ eq : allpaths2atoms10 ] ) we have @xmath293 and we now set @xmath322 . in this way",
    "we obtain the same number of nonzero strings @xmath321 as in the previous case .",
    "the proposition statement is obtained by inspecting the lhs of eqs .",
    "( [ eq : expeven ] ) and  ( [ eq : expodd ] ) where the boson operators @xmath279 accompany the corresponding ladder operators and the rhs consist of the products of the boson operators from nonzero strings .",
    "[ fig : bintree ] illustrates the proof .",
    "it also illustrates the fact that the same analysis can be done for any initial state @xmath286 .",
    "depending on the values of @xmath104 and @xmath135 the arrows in the binary tree will represent different ladder operators leading to the same counting and different boson operators on the rhs of eqs .",
    "( [ eq : expeven ] ) and  ( [ eq : expodd ] ) . in this way we are able to find all the unitary matrix elements and therefore we can act on any input state ( pure or mixed ) from a space spanned by @xmath323 .    setting @xmath324 in eq .",
    "( [ eq : expeven ] ) and @xmath325 in eq .",
    "( [ eq : expodd ] ) ( corresponding to the perturbative order @xmath47 ) we quickly reproduce the fourth order calculation in  @xcite and the result can be applied to a variety of situations  @xcite . with the same ease",
    "we can obtain an output state for @xmath326 .",
    "a non - trivial check is the trace of  ( [ eq : omega ] ) being equal to one irrespective of the perturbative order .",
    "case @xmath47 was verified in  @xcite and",
    "a straightforward calculation shows that it is true for @xmath327 as well component of  ( [ eq : omega ] ) is zero and two of the eigenvalues of @xmath284 are negative . ] .",
    "we use proposition  [ prop : phasei ] to insert eqs .",
    "( [ eq : expeven ] ) and  ( [ eq : expodd ] ) to eq .",
    "( [ eq : omega ] ) and get the output state components to the @xmath1-th order .",
    "let s take a look at the @xmath328 component : @xmath329 we identified @xmath330 and @xmath331 and in this form it is ready for theorem  [ thm : isserlisrefined ] and onto theorem  [ thm : multiplicity ] .",
    "the number of terms in  eq .",
    "( [ eq : omega00 ] ) is polynomial in @xmath30 and therefore in @xmath1 as well .",
    "wick s theorem is at the core of any perturbative calculation and so the method based on finding all nonnegative solutions of a diophantine system can in principle be used everywhere .",
    "but there are several , mainly technical , obstacles in extending the current formalism to more general theories .",
    "one of the was mentioned in section  [ sec : bosonsinteracting ] regarding the presence of derivative interactions in the lagrangian .",
    "another obstacle to overcome in order to generalize the developed scheme is to consider wick s theorem for anticommuting fields .",
    "this is a standard tool in qft  @xcite where one has to keep track of the parity and change the sign whenever two fermions swap their place in a correlation function .",
    "there seems to be no equivalent of isserlis theorem for anticommuting variables but one can envisage a generalization of random gaussian variables to a gaussian integral over ( anticommuting ) random grassmann variables . after all , grassmann variables are routinely used to study the properties of fermions in the path integral formulation of qft using _ similar _ algebraic properties of the car and grassmann algebra . then , a generalization of our refinement of wicks / isserlis theorem ( theorem  [ thm : isserlisrefined ] ) is straightforward as well but due to the nilpotency of grassmann variables there is really not much to generalize as the higher powers are missing .",
    "once we know how treat anticommuting fields we proceed in the same way by solving a system of diophantine equations . the difference is ( and this is true for any complex boson theory as well ) that we have to disregard the solutions where a contraction of two fields is zero .",
    "for example , for the second order expansion of the yukawa interaction term @xmath332 , where @xmath333 is anticommuting , the contribution given by contracting @xmath334 is zero . the diophantine system , of course , treats all fields equally and so we have to exclude such contributions manually . but",
    "this can be easily done just by going through the list of diophantine solutions and removing all those containing at least one zero propagator such as @xmath335 or any other kinematically forbidden process . by easily we mean without an additional computational complexity cost .    finally , one has to face the calculation of the graph automorphism order to get the right multiplicities . already starting with complex boson theories",
    "the graphs are in general directed , distinguishing between scattering of particles and antiparticles . this will result in a rather minor modification of lemma  [ lem : feynmanmulti ] .",
    "in particular , directed edges or edges of different types ( different fields ) will decrease the grafted graph symmetry compared to the real scalar case .",
    "among several open problems stands out the following one . we have seen that in order to get the right multiplicity factor of a perturbative contribution one has to use a potentially computationally expensive procedure of calculating the graph automorphism order or graph isomorphism membership problem .",
    "this procedure bundles the graphs from the same class of physically indistinguishable scattering processes . recall that they are represented by different solutions of a diophantine system and every",
    "such a solution is an interior point of a certain convex polyhedron .",
    "could it be that solutions from the same class form an exceptional subset in the polyhedron ( perhaps even with nice geometric properties ) or are they scattered randomly ? in the former case we could use such knowledge to avoid the potentially costly calculation of the graph isomorphisms ( costly for large graphs in extremely high perturbative orders ) .    a closely related question is whether the study of the contributions from one perturbative order ( for a given lagrangian and a fixed number of interacting fields ) tells us something about the structure of the contributions from higher perturbative orders .",
    "all nonnegative solutions come from a diophantine system whose size ( the number of interior lattice points ) grows but its structure is very similar across the perturbative orders .",
    "does geometry of the corresponding convex polyhedra have anything in common across perturbative orders ?",
    "if the answer is affirmative , could a new insight be gained into how to sum the related perturbative contributions ?",
    "another outstanding problem is a generalization of the major application of our method : an efficient perturbative calculation of the interaction hamiltonian for a pair of unruh - dewitt ( udw ) detectors in minkowski spacetime .",
    "the result is independent on the detector details and works for any smearing , envelope function or trajectory by efficiently decomposing a generic @xmath280-point correlation function to a product of two - point green s functions where the detector details play a role .",
    "an efficient calculation means that the number of perturbative terms increases polynomially with the perturbative order of the coupling constant .",
    "it would be interesting to generalize the proofs for any number of unruh - dewitt detectors to study the multipartite structure of minkowski and other spacetimes .",
    "a related open problem is to clarify whether the udw perturbative expansion suffers from the convergence issues .",
    "everything suggests that the series is not of an asymptotic character .",
    "it is unlikely but not entirely impossible that the density matrix components or even the unitary entries themselves are actually analytically summable . to answer these questions one could perhaps first look at single udw detector coupled to minkowski vacuum as the simplest case .",
    "another interesting question is what happens with the divergencies in the momentum space after all perturbative components are added .",
    "is renormalization still necessary as claimed in  @xcite or do the divergencies cancel out ?",
    "this material is based upon work supported by the air force office of scientific research under award number fa9550 - 17 - 1 - 0083 ."
  ],
  "abstract_text": [
    "<S> we present a method of calculating the interacting @xmath0-matrix to an arbitrary perturbative order for a large class of boson interaction lagrangians . </S>",
    "<S> the method takes advantage of a previously unexplored link between the @xmath1-point green s function and a certain system of linear diophantine equations . by finding all nonnegative solutions of the system , </S>",
    "<S> the task of perturbatively expanding an interacting @xmath0-matrix becomes elementary for any number of interacting fields , to an arbitrary perturbative order ( irrespective of whether it makes physical sense ) and for a large class of scalar boson theories . </S>",
    "<S> the method does not rely on the position - based feynman diagrams and promises to be extended to many perturbative models typically studied in quantum field theory . aside from interaction field calculations </S>",
    "<S> we showcase our approach by expanding a pair of unruh - dewitt detectors coupled to minkowski vacuum to an arbitrary perturbative order in the coupling constant . </S>"
  ]
}