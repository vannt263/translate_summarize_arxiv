{
  "article_text": [
    "the security of cryptographic protocols , whether quantum or classical , depends on the satisfaction of certain assumptions .",
    "these include the integrity of each party s lab and their having a trusted source of randomness to make the random choices called for by the protocol . beyond these , _ classical _ protocols will also usually include assumptions regarding the computational power of dishonest parties .",
    "the security of _ quantum _ protocols , in contrast , is based only on the validity of quantum theory .",
    "nevertheless , to harness this validity , assumptions regarding the implementation must be made .",
    "most protocols make many such assumptions , including regarding the internal workings of the devices used in the implementation , e.g. specifying the hilbert space dimension of the quantum systems used and the bases of the measurements performed . protocols of this type are said to be _ device - dependent_. clearly , it is desirable to base security on a minimum number of assumptions , as this facilitates its evaluation .",
    "the aim of the _ device - independent _ approach to quantum cryptography @xcite is to do just that by doing away with a maximum number of assumptions regarding the implementation .",
    "more specifically , a cryptographic protocol is said to be device - independent if its security can be guaranteed without making assumptions about the internal workings of the devices used in its implementation .",
    "this can be achieved by carrying out bell tests on entangled systems .",
    "the level of security is then deduced from the observed amount of nonlocality . in particular ,",
    "each device is treated as a black box with knobs and registers for selecting and displaying ( classical ) inputs and outputs .",
    "for instance , in device - independent quantum key - distribution a high violation of the chsh inequality @xcite guarantees that an eavesdropper will have no information about the ( post - processed ) key @xcite .",
    "in contrast , in the ( device - dependent ) entanglement - based version of the bb84 protocol it has been shown that if the source dispenses qudits instead of qubits then security can be utterly compromised @xcite .",
    "indeed , recent hacking attacks on quantum key - distribution systems , such as those of @xcite , exploit device - dependent modes of failure and would not be successful in device - independent settings .",
    "+ in addition to quantum key - distribution , device - independent protocols have been introduced for diverse tasks such as randomness generation @xcite , the self - testing of quantum computers @xcite , state estimation @xcite , genuine multipartite entanglement certification @xcite , and entanglement quantification @xcite . however , until recently it was not known whether the scope of the device - independent approach also covers protocols in the _ distrustful cryptography class _ , where the parties do not trust each other and may have conflicting goals .",
    "problems in this class present us with an extra challenge in device - independent settings as compared to tasks such as quantum - key distribution .",
    "namely , how to allow remote distrustful parties to certify the presence of nonlocality without collaborating . in @xcite it was shown that imperfect bit commitment admits a device - independent formulation , and , since bit commitment may serve as a primitive for coin flipping , so does coin flipping ( a device - independent coin flipping protocol , not based on bit commitment , was also introduced in @xcite ) .",
    "whether these results extend to all problems in the distrustful cryptography class remains an open question .",
    "a notable feature of the protocols of @xcite is that they are based on ghz correlations @xcite .",
    "indeed , bit commitment and coin flipping are the only examples we have of bipartite tasks , which admit a device - independent formulation , but which are not known to admit one based on chsh testing ( i.e. sequential tests of the chsh inequality ) , or , more generally , on some other bipartite bell inequality testing .",
    "this is especially interesting in light of reichardt et al.s recent demonstration @xcite that chsh testing can provide the basis for many device - independent applications in the most general settings where the devices have long - term quantum memory .    in @xcite , the pseudo - telepathic nature of ghz correlations",
    "is exploited to circumvent the unique difficulties associated with distrustful cryptography , specifically , the fact that different parties have conflicting goals and do not trust each other .",
    "quantum pseudo - telepathy is the term coined for the phenomenon of always winning in nonlocal games , which classically ( i.e. without sharing entanglement ) can only be won part of the time .",
    "a famous example is the ghz game @xcite .",
    "in particular , pseudo - telepathy entails perfect correlations . in @xcite pseudo - telepathy",
    "is used to allow bob to verify the presence of nonlocal correlations ( ghz correlations ) and _ at the same time _ to verify alice s commitment ( that the token of her commitment is consistent with the value of the bit she reveals ) .",
    "crucially , bob uses the same measurements to verify both the presence of nonlocality and the commitment .",
    "unfortunately , pseudo - telepathy is absent in the chsh setting @xcite , and so it is a priori unclear whether bipartite distrustful cryptographic tasks can be based on chsh testing  which is the case for all other examples of bipartite tasks that are known to admit a device - independent formulation . beyond a theoretical interest",
    ", this question is also practically motivated , since manipulating tripartite entanglement , as would be required in a ghz - based protocol , is obviously more difficult than manipulating epr pairs , as would be required in a chsh - based protocol .",
    "+ in this work we present a device - independent bit commitment protocol , based on chsh testing , which achieves the same security as that of @xcite : ( in the limit of an infinite number of tests ) alice s control equals @xmath0 , while bob s information gain equals @xmath1 .",
    "this shows that pseudo - telepathy is not only inessential for device - independent distrustful cryptography , but that its absence does not necessarily impact security .",
    "specifically , we show how to guarantee that the devices have no way of telling whether they are used as part of the nonlocality testing phase or the verification of the commitment ; this being the crucial element on which security hinges .    our security analysis covers the case of imperfect devices ( i.e. the chsh inequality is not maximally violated ) and is carried out in the most general settings where memory effects ( the dependence of a measurement outcome not only on the setting , but also on previous settings and outcomes ) are taken into account .",
    "it should be noted that in our protocol the reveal time is fixed and can not be chosen at will by alice . strictly speaking ,",
    "the protocol is thus not a bit commitment protocol .",
    "nevertheless , depending on the application , it may still be used as a primitive .",
    "for example , our protocol can be used to implement coin flipping .",
    "the restriction on the reveal time can be lifted at the price of increasing alice s cheating probability ( see appendix b ) , or by working in the large office scenario where instead of a pair of boxes there are many pairs ( see appendix c ) .",
    "we also study the problem in a post - quantum world where _ both dishonest and honest _ parties are restricted only by the impossibility of signaling .",
    "this helps us identify the contribution of different resources to security .",
    "on the one hand , we might expect such a world to offer less security since a dishonest party would have access to stronger correlations . on the other hand",
    ", we might expect the converse , since the protocol itself could be modified to make use of these stronger correlations ( in particular , pseudo - telepathy is restored in this setting ) .",
    "it turns out that on the balance this allows for more security .",
    "+ the paper is structured as follows .",
    "we begin in section ii by defining the problem of bit commitment , and making explicit exactly what we mean by device - independence .",
    "next , in section iii , we present the protocol , followed by the proofs of alice s and bob s securities in sections iv and v , respectively .",
    "we conclude with a summary in section vi . in appendix",
    "a we present the post - quantum version of our protocol .",
    "appendices b and c present modifications of the protocol where alice can freely choose the reveal time .",
    "bit commitment is a cryptographic primitive comprising two remote , distrustful parties .",
    "party @xmath2 , usually referred to as alice , commits a bit to party @xmath3 , usually referred to as bob , such that following her commitment alice can not change its value and bob is unable to learn it until she chooses to reveal it .",
    "classically , if the dishonest party s computational power is unlimited , they can cheat perfectly .",
    "quantumly , the dishonest party can not cheat perfectly @xcite , though perfect bit commitment is still impossible @xcite .",
    "a bit commitment protocol consists of two phases : the commit phase in which alice sends bob some token of her commitment , and the reveal phase in which alice reveals to bob the value of the committed bit .",
    "the probability with which dishonest alice is able to control the value of the bit she wants to reveal following the commit phase , without being caught cheating by bob , is referred to as alice s control , which we will denote by @xmath4 . here",
    "@xmath5 ( @xmath6 ) is alice s probability of successfully revealing @xmath7 ( @xmath8 ) and the factor of @xmath9 is due to the implicit assumption that she is equally likely to wish to reveal @xmath7 as @xmath8 .",
    "similarly , dishonest bob s probability of correctly learning the value of the bit before the reveal phase is referred to as bob s information gain , which we will denote by @xmath10 . in a perfect bit commitment protocol @xmath11 .",
    "a protocol is said to be balanced if @xmath12 .",
    "quantumly , in any balanced protocol @xmath13 , with the bound being saturable @xcite .      in this subsection",
    "we make more concrete exactly what we mean by device - independence .",
    "we make the following standard assumptions .    1",
    ".   alice and bob have access to boxes , each with a knob for selecting a classical input @xmath14 and a register for displaying a classical output @xmath15 .",
    "entering an input always results in an output ( i.e. we do not consider losses ) .",
    "alice and bob , whether honest or dishonest , are restricted by quantum theory .",
    "the boxes may be prevented at will from communicating with one another .",
    "alice and bob each have a trusted source of randomness .",
    "no information leaks out of an honest party s lab .",
    "suppose now that an honest party has a pair of boxes @xmath7 and @xmath8 .",
    "assumptions 2 and 3 imply that the probability of outputting @xmath16 and @xmath17 when inputting @xmath18 and @xmath19 into boxes @xmath7 and @xmath8 , respectively , is given by @xmath20 where @xmath21 is some joint quantum state and @xmath22 is the povm element corresponding to inputting @xmath23 and outputting @xmath24 .",
    "this is the _ only _ constraint on the boxes behavior .",
    "specifically , a dishonest party may choose the state @xmath21 and the povm elements @xmath25 as best suits them .",
    "the boxes may also have internal memories , clocks , gyroscopes , etc .",
    ", allowing a dishonest party to program them such that their behavior depends on their location , their past trajectories , the time at which inputs are fed , or any other aspect of their past history .    in the following , we will consider situations where boxes are sent from one party to the other . by this , we do not mean that actual measurement devices are sent ( though it is easier to present and formulate our results in this way ) .",
    "instead , what we mean is that quantum states , or classical information , encoding instructions for the measurement devices , are exchanged between the parties , such that _ in an honest execution of the protocol _ the same state @xmath21 and the povm elements @xmath22 characterizing the behavior , say , of alice s box before the transmission of quantum information , will characterize the behavior of bob s box after receiving the transmission .",
    "finally , we wish to emphasize that spacelike related measurements are not necessary in order to prevent the boxes from communicating ( i.e. assumption 3 ) .",
    "we may equally well shield each box ( see @xcite for a discussion of this point ) .",
    "this observation is important because @xmath26 in our protocol many of the measurements are not spacelike related ; @xmath27 relativistic causality is by itself sufficient for perfect bit commitment ( whether purely classical @xcite or quantum @xcite ) , albeit at the cost of assigning at least one party two remote secure labs .",
    "before we go on to present the protocol , we fix notation . in the following",
    "we will consider a pair of four - input , @xmath28 , two - output , @xmath29 , boxes .",
    "the random variables designating the input and output corresponding to the @xmath30th use of box @xmath31 will be labeled by @xmath32 and @xmath33 , respectively , with a specific realization ( i.e. a specific value which they may assume ) being labeled by lower - case letters @xmath34 and @xmath35 .",
    "similarly , the random strings corresponding to @xmath36 consecutive uses of box @xmath31 will be labeled by @xmath37 and @xmath38 .",
    "we define @xmath39 and @xmath40",
    ". we will refer to a specific realization @xmath41 as the history of the protocol .",
    "finally , @xmath42 ( @xmath43 ) will be taken to represent the positive ( negative ) eigenstate of @xmath44 .",
    "the protocol is based on epr - state correlations . in an ideal implementation ,",
    "the boxes are supposed to give rise to a violation of @xmath45 of the chsh inequality in the sense that @xmath46 in addition , the boxes are supposed to output @xmath47 given the pairs of inputs @xmath48 , @xmath49 ( @xmath50 ) .",
    "these correlations can be quantumly realized by preparing @xmath51 qubits , each in the @xmath52 state .",
    "the inputs @xmath7 , @xmath8 , @xmath53 , and @xmath54 of box @xmath7 correspond to the measurements @xmath55 , @xmath44 , @xmath56 , and @xmath57 , respectively , where @xmath58 .",
    "the inputs @xmath7 , @xmath8 , @xmath53 , and @xmath54 of box @xmath8 correspond to the measurements @xmath56 , @xmath57 , @xmath55 , and @xmath44 , respectively .",
    "since we would also like to consider the noisy case , we do not assume in the following that the parties have perfect resources , i.e. the boxes are expected to give rise to a chsh violation @xmath59 and the outcomes @xmath60 , @xmath61 for the pairs of inputs @xmath48 and @xmath49 are not perfectly correlated .",
    "we consider a family of protocols .",
    "each protocol in the family is specified by a parameter @xmath62 and a series of fixed times @xmath63 @xmath64 with @xmath65 . for a given @xmath51 and choice of @xmath63 ,",
    "the protocol proceeds as follows :    1 .   _ random selection _  at time @xmath66 bob picks uniformly at random , and _ _ in private _ _",
    "is chosen privately and randomly by bob in order for him to be able to ascertain that in the @xmath67th use the boxes are chsh violating .",
    "otherwise , dishonest alice can prepare the boxes such that they are chsh violating only in the first @xmath68 uses . ] , a number @xmath69 and two input strings @xmath70 and @xmath71 . at each of the @xmath68 times @xmath63 he feeds @xmath72 and @xmath73 into boxes @xmath7 and @xmath8 , respectively .",
    "he uses the corresponding output strings @xmath74 and @xmath75 to compute the observed chsh violation @xmath76 where @xmath77 is the chsh indicator function in ( [ chsh_k ] ) is just a normalization taking into account that bob picks all four possible input pairs with equal probability . with this definition",
    "the expected value @xmath78 is the usual chsh expression . ] at step @xmath36 .",
    "bob then compares @xmath79 to some previously agreed threshold @xmath80 . if @xmath81 he aborts the protocol",
    "otherwise , he flips a classical coin .",
    "denote its outcome by @xmath82 . at time @xmath83",
    "he sends box @xmath82 to alice .",
    "2 .   _ commit phase _",
    " let @xmath84 be the value of the bit alice wishes to commit .",
    "alice inputs @xmath85 into her box .",
    "she selects uniformly at random a classical bit @xmath86 , and at time @xmath87 ( @xmath88 ) sends bob the classical bit @xmath89 as a token of her commitment .",
    "3 .   _ reveal phase _  at time @xmath90 ( @xmath91 ) alice sends bob @xmath84 and @xmath92 . if @xmath84 and @xmath92 are not received before @xmath93 bob aborts . otherwise , bob checks whether @xmath94 or @xmath95 .",
    "if both relations are not satisfied , he aborts .",
    "else at time @xmath96 he inputs @xmath97 into his box and verifies that @xmath98 .",
    "if this last test fails , he aborts .",
    "we note that in an honest execution of the protocol , bob may end up aborting the protocol in the random selection phase _ even when the settings are ideal_. moreover , bob will never know if his having to abort is due to alice having been dishonest or due to the boxes having exhibited a statistically unlikely behavior .",
    "this is just a by - product of the statistical nature of the protocol , which is of course absent in the limit that @xmath99 .",
    "however , if bob does not abort the protocol in the random selection phase , then ( assuming ideal settings and an honest execution ) he will not abort it in the reveal phase and will always learn the correct value of the bit committed by alice .",
    "in contrast , if there are physical imperfections present , such as noise or a misalignment of the measurement axes , then there is a non - vanishing probability that bob will abort the protocol in the reveal phase even when alice is honest .",
    "this is true of any practical formulation ( i.e. a formulation accommodating imperfections ) , and has nothing to do with the protocol being device - independent .",
    "we have required that bob s measurements , including the one in the reveal phase , take place at fixed times @xmath63 takes place at any time during the interval @xmath100 $ ] , so long as this time is large enough to allow for the commit and reveal phases to be completed in the remainder of the interval . ] .",
    "this is in order to ensure that the box bob keeps can not tell whether it is being measured in the random selection phase or in the reveal phase ( unless bob picked @xmath101 ) .",
    "otherwise , alice may program the boxes such that in the random selection phase they maximally violate the chsh inequality , while in the reveal phase they behave deterministically , thereby allowing her to cheat perfectly .",
    "specifically , the intervals @xmath102 must be sufficiently long to allow the following sequence of operations : ( _ i _ ) the sending of quantum information from bob to alice , ( _ ii _ ) alice s measurement of the quantum system received from bob , ( _ iii _ ) the sending of classical information from alice and its receipt by bob , and ( _ iv _ ) bob s measurement of the quantum system remaining in his possession at @xmath103 .",
    "as mentioned earlier , since the reveal time can not be chosen at will , strictly speaking , the protocol is not a bit commitment protocol .",
    "nevertheless , depending on the application , it may still be used as a primitive .",
    "for example , our protocol may be used to implement coin flipping .",
    "the restriction on the reveal time can be lifted at the price of increasing alice s control ( see appendix b ) , or by working in the large office scenario ( see appendix c ) .",
    "in the following , when considering the @xmath67th measurement of the boxes , i.e. the measurements taking place in the commit and reveal phases , we drop the subscript @xmath104 on the @xmath105 and @xmath106 .",
    "alice only receives a single box from bob and does not verify the chsh violation .",
    "most general cheating strategy is therefore to prepare alice s box in an entangled state with an ancillary system in his possession . since in the commit phase bob receives from alice a single classical bit @xmath107",
    ", bob will perform one out of a pair of two - outcome measurements on his ancillary system to infer alice s input @xmath108 ( and consequently the committed bit @xmath109 ) .",
    "we denote bob s binary input and output by @xmath110 and @xmath111 , where @xmath112 ( @xmath113 ) corresponds to the measurement he carries out when alice sends @xmath114 ( @xmath115 ) , and @xmath111 is his guess of @xmath108 .",
    "the probability @xmath116 of obtaining the output @xmath111 , given the input @xmath110 , explicitly depends on alice s input - output pair @xmath108 and @xmath117 ( or , what is the same thing , on @xmath84 and @xmath117 ) because bob s ancillary system and alice s box are entangled .",
    "bob s information gain is therefore given by :    @xmath118\\\\   & = & \\frac{1}{4}\\max_{\\mathcal{s}}\\sum_{r^c,\\ , b=0,\\,1}\\bigl[p\\left(r^c,\\ , g = b\\mid s^c = b+2,\\ , m = r^c\\right)\\bigr.\\bigl.+p\\left(r^c,\\ , g = b\\mid   s^c = b+2,\\,m = r^c\\oplus b\\right)\\bigr]\\nonumber \\\\   & = & \\frac{1}{4}\\max_{\\mathcal{s}}\\bigl[2p\\left(0,\\,0\\mid 2,\\,0\\right)+2p\\left(1,\\,0\\mid 2,\\,1\\right)+p\\left(0,\\,1\\mid 3,\\,0\\right)\\bigr.\\bigl.+p\\left(1,\\,1\\mid 3,\\,1\\right)+p\\left(0,\\,1\\mid 3,\\,1\\right)+p\\left(1,\\,1\\mid 3,\\,0\\right)\\bigr]\\ , ,   \\label{bound pgain}\\end{aligned}\\ ] ]    where @xmath119 denotes the set of all cheating strategies .",
    "note that since alice is honest she picks @xmath84 and @xmath86 fully at random and so for any pair @xmath84 and @xmath86 @xmath120 . from normalization and the no - signaling constraints ( i.e. @xmath121 and @xmath122 )",
    "we obtain that @xmath123 and @xmath124 , implying that @xmath125 .",
    "bob s optimal cheating strategy is to prepare alice s box such that @xmath126 and guess @xmath127 .",
    "since alice is honest @xmath107 equals @xmath117 ( and thus equals @xmath109 ) @xmath128 of the time .",
    "alternately , bob can employ a device - dependent strategy ( i.e. where alice s measurements are those prescribed by the protocol ) . in this strategy",
    "bob actually prepares the boxes as prescribed by the protocol . noting that the measurement settings which correspond to @xmath129 and @xmath130 are identical , bob inputs @xmath7 into his box .",
    "since @xmath107 equals alice s outcome @xmath128 of the time , bob always treats it as her output .",
    "if his outcome equals @xmath107 bob guesses that alice input @xmath53 , otherwise , he guesses that she input @xmath54 .",
    "whenever alice inputs @xmath53 , bob s guess is correct .",
    "whenever alice inputs @xmath54 , bob s guess is correct only half of the time .",
    "bob s information gain is thus seen to equal the optimum , as well as the result of @xcite .",
    "this section is divided into three . in subsections",
    "a and b we consider the case where the boxes at the @xmath104th iteration ( i.e. after bob s chsh estimation ) are known to be characterized by a fixed bell violation @xmath131 . as we will see in subsection c ,",
    "this is equivalent to considering the asymptotic limit in which the number of tests bob carries out tends to infinity .",
    "specifically , in subsection a we derive an upper bound on alice s control , given the chsh expectation value @xmath132 , and in subsection b we present an optimal cheating strategy which saturates it .",
    "finally , in subsection c we use the bound derived in subsection a to derive an upper bound on alice s control in the general case where bob carries out an arbitrary number of tests . in the limit that this number tends to infinity",
    "we recover the bound of subsection a.      most generally , in the commit phase alice carries out a two - outcome measurement on the systems in her possession : box @xmath82 , which she received from bob , and possibly some ancillary system with which the boxes may be entangled .",
    "the result of the measurement determines the value of @xmath107 she sends bob . in the reveal phase she then performs one out of four possible two - outcome measurements , depending on the value of @xmath107 and whether she wishes to reveal @xmath7 or @xmath8 , in order to determine @xmath117 .",
    "we note , however , that when she wishes to reveal @xmath7 the last measurement is redundant because @xmath107 must equal @xmath117 .",
    "alice therefore does not lose anything by _",
    "always _ performing in the reveal phase one out of the two measurements corresponding to her wishing to reveal @xmath8 .",
    "this implies that without loss of generality these two measurements may be combined with the measurement in the commit phase to form a single four - outcome measurement in the commit phase .",
    "this measurement decides the two values of @xmath117 , and simultaneously the value of @xmath107 . to sum up",
    ", in the commit phase alice carries out a four - element povm @xmath133 ( @xmath134 ) acting on @xmath135 , such that if she wishes to reveal @xmath7 ( @xmath8 ) she sends bob @xmath136 in the commit phase and @xmath137 ( @xmath138 ) in the reveal phase .",
    "suppose that alice wishes to reveal @xmath139 ( @xmath130 ) .",
    "bob will first check whether @xmath140 ( since @xmath139 , @xmath141 ) .",
    "bob will then input @xmath129 and verify that @xmath142 . in this case",
    "alice s cheating probability equals @xmath143 $ ] , where the factor of @xmath9 is due to bob sending boxes @xmath7 and @xmath8 with equal probability .",
    "suppose that alice wishes to reveal @xmath144 ( @xmath145 ) , then @xmath146 or @xmath147 .",
    "bob will input @xmath148 and verify that @xmath142 . in this case",
    "alice s cheating probability equals @xmath149 $ ] .",
    "alice s overall cheating probability is therefore given by @xmath150\\,.\\end{aligned}\\ ] ]    to obtain alice s control , we must maximize the above expression under the constraint that the chsh expectation value is no less than @xmath80 .",
    "this translates to the following optimization problem @xmath151=\\bigl[m_{ij}^{c},\\,\\pi_{k\\mid l}^{\\bar{c}}\\bigr]=\\bigl[m_{ij}^{c},\\ , m_{kl}^{\\bar{c}}\\bigr]=0\\,,\\nonumber\\\\   &   & \\pi_{i\\mid j}^{c}\\succeq0\\,,\\quad m_{ij}^{c}\\succeq0\\,,\\quad\\sum_{i=0,\\,1}\\pi_{i|j}^{c}=   \\mathds{1}\\,,\\quad\\sum_{i,\\ , j=0,\\,1}m_{ij}^{c}=\\mathds{1}\\ , ,   \\label{maximization}\\end{aligned}\\ ] ] where @xmath152 and @xmath153 is the povm element corresponding to inputting @xmath14 into box @xmath82 and obtaining the output @xmath15 .",
    "problems of this type can be relaxed to a hierarchy of semi - definite programming ( sdp ) problems , using the method introduced in @xcite .",
    "this hierarchy provides increasingly tighter upper bounds on the solution of the original problem , which are guaranteed to converge to it at a sufficiently high order .",
    "we have solved the second order sdp relaxation of eq .",
    "( [ maximization ] ) . in the next subsection we present a cheating strategy which saturates it ( up to @xmath154  the numerical accuracy of the sdp solver ) , implying that the second order relaxation already converges .",
    "1 presents alice s control as a function of the chsh expectation value .     in the asymptotic limit .",
    "the curve was obtained from eqs .",
    "( [ optimal strategy pcont])-([optimal strategy phi ] ) .",
    "the curve saturates the second order relaxation of eq .",
    "( [ maximization ] ) up to @xmath154  the numerical accuracy of the sdp solver .",
    "]      we present below an optimal cheating strategy , in which it suffices for alice to perform a single two - outcome measurement , rather than a four - outcome one as described in the previous subsection .",
    "the strategy proceeds as follows .",
    "alice prepares the boxes such that each contains one qubit out of a pair in the maximally entangled state @xmath155 .",
    "box @xmath7 is prepared such that inputting @xmath7 and @xmath8 gives rise to the measurements @xmath156 and @xmath44 , respectively , where @xmath157 .",
    "box @xmath8 is prepared such that inputting @xmath7 and @xmath8 gives rise to the measurements @xmath158 and @xmath159 , respectively . if alice receives box @xmath7 ( @xmath8 ) she measures @xmath160 ( @xmath161 ) .",
    "that is , she always measures along an axis midway between bob s measurement axes in @xmath162-plane ( see fig .",
    "she then sends bob values of @xmath84 and @xmath117 equal to the result of her measurement .",
    "pairs of measurements along axes , differing by an angle of @xmath163 , in the @xmath162-plane ( since @xmath164 is invariant under rotations in the @xmath162-plane ) give rise to correlated outcomes with probability @xmath165 .",
    "therefore , irrespectively of whether alice reveals @xmath7 or @xmath8 ( or , what is the same thing , whether bob inputs @xmath7 or @xmath8 ) , her cheating probability equals @xmath166    of course the values of @xmath163 and @xmath167 are restricted by the constraint on the value of the chsh violation .",
    "for the measurements above we have @xmath168 for a given value of @xmath163 the maximum violation is obtained for @xmath169 by plugging @xmath170 into eq .",
    "( [ optimal strategy chsh ] ) , and using eq .",
    "( [ optimal strategy pcont ] ) to obtain @xmath163 as a function of @xmath171 , we obtain @xmath132 as a function of @xmath171 .",
    "the resulting curve saturates the sdp obtained curve in fig . 1 .     ( @xmath8 ) .",
    "the dotted axes correspond to alice s measurements ( alice always measures midway between bob s axes ) .",
    "the axes all lie in the @xmath162-plane . @xmath172 . @xmath173 and @xmath163 are related via eq .",
    "( [ optimal strategy phi ] ) ]    .",
    "[ optimalstrategya ]      for any given value of @xmath68 , alice s control is a function of the chsh expectation value @xmath174 characterizing the behavior of the devices at step @xmath104 given the history @xmath175 .",
    "alice s control can therefore be expressed as @xmath176 where @xmath177 is the unit step function , ensuring that only histories , such that the observed chsh violation is no less than the threshold @xmath80 , contribute .",
    "the partitioning of the sum into two is due to the fact that the boxes may have internal counters keeping track of the number of times they have been tested . since the @xmath178th use of the boxes , if occurring at all ( i.e. if bob picks @xmath51 ) , necessarily occurs in the reveal phase , it is never part of the chsh testing .",
    "therefore , in an optimal cheating strategy alice will program the boxes such that in their @xmath178th use they behave deterministically .    for each history",
    "@xmath175 with @xmath179 we can define the set of all _ compatible _ histories @xmath180 that could have occurred had bob carried out @xmath181 repetitions instead of @xmath68 .",
    "alice s control can therefore be re - expressed as @xmath182    let @xmath183 denote the last repetition , up to and including the @xmath184th repetition , of the compatible history @xmath180 for which the observed chsh violation is no less than @xmath80 , i.e. @xmath185 we can bound alice s control probability as follows : @xmath186 where we have used the fact that @xmath187 for all @xmath68 such that @xmath188 ; the inequality being due to the possibility of histories for which @xmath187 for at least one value of @xmath189 .",
    "defining @xmath190 , we have @xmath191 where in the second sum in the first line we have used the concavity of @xmath192 , in the first sum in the second line the fact that @xmath193 , and where @xmath194 is the set of all histories satisfying @xmath195 in appendix d we show that the probability of occurrence of @xmath196 is bounded by @xmath197 where @xmath198 , and so @xmath199    .",
    "the curve presents the results of numerical solutions of eq .",
    "( [ bound pcont ] ) for different values of @xmath51 , given @xmath200 . in the limit @xmath99 alice s control tends to the asymptote @xmath201 ( represented by the dashed curve ) . ]",
    "making use of this last inequality , we finally get that @xmath202+\\frac{1}{n}\\nonumber \\\\   &   \\leq    & \\frac{n-1}{n}\\min_{\\varepsilon \\geq 0}\\biggl[\\sum_{k=1}^{k_{0}-1}\\sum_{\\{\\mathrm{\\mathbf{w}}_{n-1}|k(\\mathrm{\\mathbf{w}}_{n-1})=k\\}}p(\\mathrm{\\mathbf{w}}_{n-1})c(i_\\mathrm{th}-\\varepsilon ) \\biggr .",
    "\\nonumber\\\\   & & \\biggl.+\\sum_{k = k_{0}}^{n-1}\\sum_{\\{\\mathrm{\\mathbf{w}}_{n-1 } |k(\\mathrm{\\mathbf{w}}_{n-1})=k\\}}p(\\mathrm{\\mathbf{w}}_{n-1})c(i_\\mathrm{th}-\\varepsilon)\\nonumber\\\\   & & + \\sum_{k = k_{0}}^{n-1}\\sum_{\\{\\mathrm{\\mathbf{w}}_{n-1 } |k(\\mathrm{\\mathbf{w}}_{n-1})=k,\\,\\mathrm{\\mathbf{w}}_{n-1}\\in\\pi_k(\\varepsilon)\\}}p(\\mathrm{\\mathbf{w}}_{n-1})(1-c(i_\\mathrm{th}-\\varepsilon))\\biggr]+\\frac{1}{n}\\nonumber \\\\   & \\leq & \\frac{n-1}{n}\\min_{\\varepsilon \\geq 0 } \\bigl[c(i_\\mathrm{th } -\\varepsilon)+(1-c(i_\\mathrm{th}-\\varepsilon))q(\\varepsilon)\\bigr]+\\frac{1}{n}\\ , .",
    "\\label{bound pcont } \\end{aligned}\\ ] ] note that if we choose the behavior of @xmath203 such that in the limit @xmath204 it decays more slowly than @xmath205 , then @xmath206 and the bound tends to @xmath207 . for finite @xmath51",
    "it seems unlikely that the bound is saturable , since @xmath208 is non - vanishing .",
    "3 presents the results of numerical solutions of eq .",
    "( [ bound pcont ] ) for different values of @xmath51 for @xmath209 .",
    "in particular , in the limit @xmath204 alice s control tends to @xmath210 , recovering the result of @xcite .",
    "distrustful cryptography presents unique challenges in device - independent settings , which are absent in non - distrustful cryptographic tasks , such as quantum key - distribution . in particular , since the parties do not trust each other and may have conflicting goals , they can not work together to certify the presence of nonlocality . in @xcite",
    "this problem was circumvented by making use of the pseudo - telepathic nature of ghz correlations , but pseudo - telepathy is absent in a chsh setting . in this work",
    "we have shown that pseudo - telepathy is not essential for doing device - independent distrustful cryptography .",
    "this was achieved by reformulating the device - independent bit commitment protocol of @xcite , such that it relies on sequential testing of the chsh inequality ( instead of the single - shot testing of ghz correlations ) , but ( in the asymptotic limit ) nevertheless achieves the same security .",
    "the security analysis was therefore carried out in the most general settings , where the devices may have long - term quantum memory .",
    "strictly speaking , the protocol we have presented is not a bit commitment protocol since alice can not choose the reveal time at will .",
    "this by itself is not necessarily a problem .",
    "for example , it does not prevent the protocol from being used to implement coin flipping . however , if we would like alice to have the freedom to choose the reveal time , then we can do so either , as shown in appendix b , at the price of increasing her control , or , as shown in appendix c , at the price of using additional resources , i.e. by working in the large office scenario , where the parties have access to many pairs of boxes , which can be measured in parallel .",
    "our work opens the door for real - life implementation of device - independent bit commitment and coin flipping .",
    "the protocol of @xcite requires the ability to reliably produce particles in a ghz state and to store , manipulate , and transmit them while maintaining their coherence .",
    "the protocol presented here , on the other hand , only requires manipulation of bipartite entanglement which is simpler given state - of - the - art technology .    finally , we point out that the techniques developed in this work are not especially tailored for device - independent bit commitment , and we expect them to be useful , and possibly even essential , for other distrustful cryptographic tasks , such as non - bit commitment - based device - independent coin flipping , and device - independent oblivious transfer .    s.p .",
    ", s.m . , and j.s .",
    "acknowledge financial support from the european union under the projects qcs , qalgo , and diqip , and from the f.r.s .- fnrs under the project diqip . s.p .",
    "acknowledges support from the brussels - capital region through a bb2b grant .",
    "s.p . is a research associate of the fonds de la recherche scientifique f.r.s.- fnrs ( belgium ) .",
    "j.s . was a postdoctoral researcher of the fonds de la recherche scientifique f.r.s.- fnrs ( belgium ) at the time this research was carried out .",
    "n.a acknowledges support from the bsf ( grant no .",
    "32/08 ) and the niedersachsen - israeli research cooperation program .",
    "the matlab toolboxes yalmip @xcite and sedumi @xcite were used to solve the sdp problem eq .",
    "( [ maximization ] ) .",
    "we present a device - independent bit commitment protocol using a pr box @xcite .",
    "+ we have seen that reformulating the ghz - based protocol of @xcite to be chsh - based comes at the price of pseudo - telepathy .",
    "indeed , quantum theory does not allow for pseudo - telepathy in a two - party , two - input setting @xcite .",
    "however , in a post - quantum world  in which both _ dishonest and honest _ parties are restricted only by the no - signaling constraints  pseudo - telepathy is restored .",
    "it is interesting to ask what would happen to our protocol if we were to adapt it to such a world . on the one hand",
    ", we might expect such a world to offer less security since a dishonest party would now have access to stronger correlations . on the other hand",
    ", we might expect the converse , since the protocol itself can be modified to make use of these stronger correlations .",
    "we will see that on the balance this allows for more security .",
    "a pr box is a post - quantum , bipartite , two - input , two - output resource , which achieves the algebraic bound of the chsh inequality , while at the same time satisfying the no - signaling constraints .",
    "up to local relabeling of the inputs and outputs , the pr box satisfies @xmath211 in the following , it will be convenient to think of the pr box as consisting of a pair of two - input , two - output boxes , one in the possession of alice , and the other in the possession of bob .",
    "the pr - based protocol is essentially a simplified version of our earlier protocols with the first step ( statistical estimation of the chsh violation and random selection of the box used to encode alice s commitment ) omitted , and with the verification of nonlocal correlations and alice s commitment being performed at the same time .",
    "this last possibility follows from pseudo - telepathy , as in the protocol of @xcite .",
    "we assume that at the start of the protocol alice has box @xmath7 and bob has box @xmath8 .",
    "the protocol proceeds as follows :    1 .",
    "_ commit phase _ - alice inputs into her box the value of the bit she wishes to commit .",
    "she then selects uniformly at random a classical bit @xmath86 , and sends bob another classical bit , @xmath212 , as a token of her commitment .",
    "2 .   _ reveal phase _ - alice sends bob @xmath18 and @xmath16 .",
    "bob checks whether @xmath213 or @xmath214 . if both relations are not satisfied , he aborts .",
    "otherwise , he picks an input @xmath19 uniformly at random and verifies that @xmath215 .",
    "if this last test fails , he aborts .",
    "we recall that in the quantum case ( both in the ghz - based and chsh - based formulations ) alice s security relies only on the no - signaling constraints .",
    "since we are still working in a non - signaling setting , alice s security will remain unchanged , i.e. bob s information gain is upper - bounded by @xmath216 .",
    "the proof proceeds exactly as in subsection iv.a , except that the instead of inputting @xmath53 and @xmath54 , alice inputs @xmath7 and @xmath8 .",
    "one optimal strategy for bob is to assume that @xmath213 , and input @xmath217 , obtaining an output @xmath17 .",
    "he then guesses @xmath218 .",
    "when @xmath219 , @xmath213 and bob s guess , @xmath220 , is correct .",
    "when @xmath221 and @xmath222 , @xmath213 and bob s guess , @xmath220 , is again correct .",
    "however , when @xmath221 and @xmath223 , @xmath224 and bob s guess , @xmath225 , is wrong .",
    "since alice is honest she picks @xmath86 uniformly at random , implying that @xmath226 .",
    "recall that in a device - independent scenario dishonest alice can prepare the boxes in any state she wishes , possibly entangled with ancillary systems in her possession .",
    "since in the commit phase alice sends a classical bit @xmath107 as a token of her commitment , without receiving any information from bob , without loss of generality we may assume that she decides on the value of @xmath107 before the start of the protocol , and accordingly prepares the boxes to maximize @xmath171 .",
    "furthermore , since alice s cheating probability is invariant under the simultaneous relabeling @xmath227 and @xmath228 , no value of @xmath107 is preferable , and we may assume that she sends @xmath114 .",
    "suppose now that alice wishes to reveal @xmath7 .",
    "since @xmath219 , it follows that alice must send @xmath229 as bob will first check whether @xmath229 or not .",
    "bob will then test whether the pr box correlations , eq .",
    "( [ prbox ] ) , are satisfied : bob will uniformly at random pick a value of @xmath19 and verify that @xmath230 .",
    "alice s control in this case equals @xmath231 $ ] .",
    "suppose now that alice wishes to reveal @xmath8 , then both values of @xmath232 are possible , and the only relevant test is whether the pr box correlations are satisfied .",
    "alice s control in this case equals @xmath233 $ ] .",
    "alice s overall control is obtained by maximizing @xmath234\\nonumber\\\\   & = & \\frac{1}{4}\\left[p(r^{1}=0|s^{1}=0)+p(r^{1}=0|s^{1}=1)\\right.\\nonumber\\\\   & + & p(r^{0}=0,\\ , r^{1}=0\\mid s^{0}=1,\\ , s^{1}=0)+p(r^{0}=0,\\ , r^{1}=1\\mid s^{0}=1,\\ , s^{1}=1)\\nonumber\\\\   & + & p(r^{0}=1,\\ , r^{1}=1\\mid s^{0}=1,\\ , s^{1}=0)+\\left.p(r^{0}=1,\\ , r^{1}=0\\mid s^{0}=1,\\ , s^{1}=1)\\right]\\end{aligned}\\ ] ] and is easily seen to be no greater than @xmath216 .",
    "alice s optimal strategy is to prepare bob s box such that @xmath235 , i.e. a classical box .",
    "in this appendix we consider a modification of the protocol , such that the reveal time can be chosen at will .",
    "this comes at the price of increasing alice s control .",
    "the protocol proceeds as follows :    1 .",
    "_ random selection _  at time @xmath66 bob picks uniformly at random , and in private , a number @xmath69 and two input strings @xmath70 and @xmath71 . at each of the @xmath68 times @xmath63 he feeds @xmath72 and @xmath73 into boxes @xmath7 and @xmath8 , respectively .",
    "he uses the corresponding output strings @xmath74 and @xmath75 to compute the observed chsh violation , @xmath236 , and compares it to some previously agreed threshold @xmath80 .",
    "if @xmath81 , he aborts the protocol . otherwise , he flips two classical coins .",
    "denote their outcomes by @xmath82 and @xmath237 . at time @xmath83",
    "he sends box @xmath82 to alice . at time @xmath93",
    ", he inputs @xmath238 into box @xmath239 .",
    "2 .   _ commit phase _  let @xmath84 be the value of the bit alice wishes to commit .",
    "alice inputs @xmath85 into her box .",
    "she then selects uniformly at random a classical bit @xmath86 , and at time @xmath240 sends bob the classical bit @xmath89 as a token of her commitment .",
    "3 .   _ reveal phase _  at any time of her choosing @xmath241 alice sends bob @xmath84 and @xmath92 . bob checks whether @xmath94 or @xmath95 .",
    "if both relations are not satisfied , he aborts . otherwise , if @xmath242",
    "( i.e. @xmath243 ) he verifies that @xmath98 .",
    "if this last test fails , he aborts .",
    "clearly , the analysis of alice s security remains the same as in the original protocol .",
    "bob s random choice of the @xmath67th input into box @xmath239 implies that half the time he will not be able to carry out the last test in the reveal phase and will accept whatever value dishonest alice reveals , independently of her cheating strategy . the remaining half of the time , bob s actions will precisely be identical to those analyzed previously ( in particular , the last input is introduced into box @xmath239 at time @xmath93 , and thus , unless @xmath101 , this box can not tell whether it is measured in the random selection phase or the reveal phase ) .",
    "alice s control is therefore modified as follows : @xmath244 .",
    "in this appendix we consider the large office scenario , where bob has a large number of pairs of boxes , and where the boxes in each pair can not only be prevented from communicating with one another , but also with the other pairs . while impractical , this scenario allows us to modify the protocol such that the reveal time can be chosen at will while maintaining the same level of security .",
    "+ before we begin , we adapt the notation to this new scenario .",
    "we consider @xmath245 pairs ( @xmath246 for the chsh estimation and @xmath8 for the commitment ) . ] of four - input , @xmath28 , two - output , @xmath29 , boxes .",
    "the random variables designating the input and output of the @xmath247th box ( @xmath248 ) of the @xmath30th pair will be labeled by @xmath32 and @xmath33 , respectively , with a specific realization being labeled by lower - case letters @xmath34 and @xmath35 .",
    "we also define @xmath249 and @xmath250 .",
    "finally , we define the random strings @xmath251 , @xmath252 , and @xmath253 . + the protocol proceeds as follows :    1 .   _ random selection _",
    " bob picks uniformly at random and _ in private _ a number @xmath254 and a classical bit @xmath82 .",
    "he sends box @xmath82 of the @xmath255th pair to alice .",
    "2 .   _ commit phase _",
    " let @xmath84 be the value of the bit alice wishes to commit .",
    "alice inputs @xmath256 into her box .",
    "she then selects uniformly at random a classical bit @xmath86 , and sends bob the classical bit @xmath89 as a token of her commitment .",
    "3 .   _ reveal phase _",
    " alice sends bob @xmath84 and @xmath257 .",
    "bob checks whether @xmath258 or @xmath259 .",
    "if both relations are not satisfied , he aborts . otherwise , he picks uniformly at random two input strings @xmath260 and @xmath261 , which he feeds into the corresponding boxes .",
    "_ at the same time _",
    "he feeds @xmath262 into box @xmath239 of the @xmath255th pair .",
    "if @xmath263 , he aborts .",
    "else , he uses the corresponding output strings @xmath264 and @xmath265 to compute the observed chsh violation @xmath266 and compares it to some previously agreed threshold @xmath80 .",
    "if this last test fails , he aborts .",
    "clearly , the analysis of alice s security remains the same as in the original protocol .",
    "we will not derive here the dependence of alice s control on the number of pairs @xmath245 . instead",
    ", we will show that it is upper - bounded by that of the original protocol ( section iii ) . to see this ,",
    "consider another protocol , identical to the one above in all except that instead of using the inputs and outputs of all the pairs ( bar the one chosen for the commitment ) to estimate the chsh violation , bob uses only those of the first @xmath267 pairs ( alice is of course aware of this and of the numbering of the pairs ) .",
    "clearly , the new protocol can only increase alice s control .",
    "now we note that this protocol would be identical to that of the sequential case , up to the fact that the reveal time can be chosen at will of pair @xmath68 are simultaneous . ] , if box @xmath31 of pair @xmath36 were to have full information about the inputs and outputs of all the @xmath247th boxes of the first @xmath268 pairs .",
    "clearly , such a modification can only increase alice s control .",
    "we therefore conclude that alice s control in the sequential case provides an upper bound on her control in the large office scenario .",
    "let      it is straightforward to show that @xmath270 is a martingale ( i.e. @xmath271 ) .",
    "moreover , for any history @xmath272 we have that @xmath273 where @xmath274 ; the @xmath275 coming from the @xmath276 term and the @xmath45 from the @xmath277 term . the azuma - hoeffding inequality",
    "@xcite then tells us that @xmath278 where @xmath194 is defined to be the union of all histories @xmath279 satisfying @xmath280 ."
  ],
  "abstract_text": [
    "<S> * bit commitment and coin flipping occupy a unique place in the device - independent landscape , as the only device - independent protocols thus far suggested for these tasks are reliant on tripartite ghz correlations . </S>",
    "<S> indeed , we know of no other bipartite tasks , which admit a device - independent formulation , but which are not known to be implementable using only bipartite nonlocality . another interesting feature of these protocols is that the pseudo - telepathic nature of ghz correlations  in contrast to the generally statistical character of nonlocal correlations , such as those arising in the violation of the chsh inequality  is essential to their formulation and analysis . in this work </S>",
    "<S> , we present a device - independent bit commitment protocol based on chsh testing , which achieves the same security as the optimal ghz - based protocol . </S>",
    "<S> the protocol is analyzed in the most general settings , where the devices are used repeatedly and may have long - term quantum memory . </S>",
    "<S> we also recast the protocol in a post - quantum setting where both honest and dishonest parties are restricted only by the impossibility of signaling , and find that overall the supra - quantum structure allows for greater security . * </S>"
  ]
}