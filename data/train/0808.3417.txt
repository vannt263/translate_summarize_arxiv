{
  "article_text": [
    "in diffusion quantum monte carlo ( dmc ) a trial wave - function is used to enforce both the antisymmetry of the electronic many - body wave - function@xcite and the nodal structure of the solution . in highly correlated materials ,",
    "the accuracy of the trial wave - function becomes increasingly important and determines the success or failure of the method .",
    "indeed , concerns about the fixed - node accuracy have tended to limit applications of dmc to pre - transition metal elements .",
    "the discovery and development of new methods to improve the trial wave - functions , ideally without great computational expense , is consequently highly desirable for almost all dmc calculations .    in dmc calculations",
    "the trial wave - function @xmath0 is commonly a product of an antisymmetric function @xmath1 and a jastrow factor @xmath2 .",
    "usually @xmath1 is a slater determinant constructed with single particle kohn - sham orbitals from density functional theory ( dft ) or from other mean field approaches such as hartree - fock .",
    "the jastrow factor does not change the nodes , but accelerates convergence and improves the algorithm s numerical stability .",
    "the jastrow factor is optimized in a previous variational monte carlo ( vmc ) calculation .",
    "the dmc algorithm finds the lowest energy of the set of all wave - functions that share the nodes of @xmath0 .",
    "the exact ground - state energy will be obtained only if the exact nodes are provided .",
    "since any change to an antisymmetric wave - function must result in a higher energy than the antisymmetric ground state , the energy obtained with arbitrary nodes is an upper bound to the exact ground - state energy.@xcite only in small systems is it currently possible to improve the nodes @xcite or even avoid the trial wave - function approach altogether.@xcite for small or weakly correlated systems , where other numerical approaches can compete , the utility of dmc as a method depends crucially on the accuracy of the trial wave - function .",
    "multiple determinant , pfaffian,@xcite and back - flow@xcite wave - functions and geminal products@xcite are increasingly popular due to the improved accuracy .    to improve the dmc energy one must improve the nodal surface of the trial wave - function .",
    "however , to our knowledge , all algorithms for wave - function optimization are based on the vmc approach , with any improvement in the dmc energy occurring only as a side - effect .",
    "the use of vmc might be a limitation since vmc samples more frequently the regions of the wave - function that have larger probability density and are thus far from the nodes.@xcite accordingly , vmc based optimization methods improve first the wave - function at regions which are far from the nodes , while the nodes are only improved indirectly .",
    "it has been found , however , that vmc based optimization methods , in general , also improve the dmc energy.@xcite nevertheless , a direct optimization of the dmc energy is desirable , and might have improved convergence properties compared to current indirect approaches . while it has been shown by us and others that , within the single slater determinant approach , the computational cost of an electronic update step in the dmc algorithm can have an almost linear scaling with the number of electrons,@xcite the use of these methods is limited if we do not find a better source of trial wave - functions than those obtained from mean - field approaches such as dft .",
    "we recently showed@xcite that kohn - sham dft wave - functions can not be expected to yield good nodes in general .",
    "as correlations increase , kohn - sham dft wave - functions can be bad sources of nodal surfaces.@xcite indeed , we also found that as the size of the system increases , the nodal error of dft wave - functions might be of the order of the triplet excitation energies , precluding the prediction of accurate optical properties@xcite even for simple carbon fullerenes .",
    "accordingly , it is highly desirable to find a method to ( i ) obtain trial wave - functions with accurate nodal structures , ( ii ) retain the simplicity of a mean field approach , or ( iii ) use a minimum number of slater determinants i.e. , the wave - functions are compact and easily evaluated , ( iv ) directly optimize the nodes in dmc , and ( v ) improve the nodal structure systematically independently of the starting point . in this contribution",
    "we provide such a method .    in order to use dmc to find the best trial wave - function we overcome two major obstacles : ( i )",
    "obtain a representation of the fixed - node ground - state dmc wave - function suitable for optimization of the nodes , and ( ii ) find a method to keep the trial wave - function compact in large systems by minimizing the number of determinants .",
    "this work is the natural continuation of a recent article ( ref .  ) where we proved the existence of an optimal effective nodal potential for generating the orbitals in the determinants in the trial wave - function used in dmc .",
    "while some details are rederived here , we recommend reading ref .   before this article .",
    "we previously proved@xcite that specific properties of the interacting ground state can be retained via minimization of cost functions in the set of pure - state non - interacting densities .",
    "each cost function defines the gradient of an effective non - interacting potential which is optimized in a newton - raphson - like approach until the cost function reaches a minimum . in this paper",
    "we take the next step : we use known properties of the walker distribution function generated in a dmc run to define a cost function relating the non - interacting wave - functions with the fixed - node ground - state wave - function .",
    "this allows us to obtain , for example , the kohn - sham potential or an effective nodal potential from the dmc calculation .",
    "the method appears to be limited by the quality of the fit , the statistics that one can collect in dmc and the representability of the nodal surface , which becomes increasingly more demanding as the number of electrons in the system increases .",
    "although this might limit the applicability of the method to systems with small electron counts , we note that dmc is readily parallelized with excellent scaling on modern computers .",
    "we also expect that improved sampling and optimization schemes can be constructed using the initial ideas and methods presented here and in ref . .",
    "the remainder of this paper is organized as follows . in section [ sc : prove ] we demonstrate that the nodes can be improved by locally removing the kinks in the fixed - node ground state . in section [ sc : multideterminants ] we derive a formalism and a method to obtain a multi - determinant expansion of the fixed - node ground - state wave - function directly from a dmc run . for many applications",
    ", this expansion may already be sufficient . in section [ sc : singledeterminant ]",
    "we present a cost function that allows the optimization of more compact trial wave - functions that match the fixed - node ground state . a formalism for wave - function optimization based on an effective dft - like",
    "nodal potential is given .",
    "in section [ sc : model ] we apply and compare these methods to a model system that can be solved nearly analytically and demonstrate its convergence properties . in section [ sc : algorithm ] we propose a general algorithm based on the experience gathered solving the model . finally in section [ sc : discussion ] we summarize and discuss the prospects of this method for application in large systems .",
    "the importance sampling dmc algorithm , in the fixed - node approximation , finds the lowest energy  @xcite @xmath3 among the set of all wave - functions that share the nodal surface @xmath4 where the trial wave - function @xmath5 and changes sign . the symbol @xmath6 denotes a point in the many - body @xmath7 dimensional space of electron coordinates .",
    "we denote this wave - function @xmath8 as the fixed - node ground state .",
    "it can be shown that @xmath8 corresponds to the ground state of the interacting hamiltonian containing an additional infinite external potential located at the nodes of @xmath9 .    , blue dots ) , fixed - node ground - state ( @xmath10 , purple continuous ) , ground - state ( @xmath11 , black dash and dots ) , and new trial wave - function ( @xmath12 , red dashed line ) in the direction perpendicular to the nodal surface ( @xmath13 ) .",
    "we show that smoothing the kink in the fixed - node wave - function @xmath10 moves the nodes of @xmath12 towards the nodes of the ground state @xmath11 .",
    "b ) schematic representation of how the nodal surface evolves , shown with increasing purple line thickness , after each iteration in the algorithm .",
    "the noise introduced in the nodes by random fluctuations of the walkers is assumed to correct itself if the statistics is increased from one iteration to the next . ]",
    "the gradient of the fixed - node ground - state wave - function @xmath8 can be discontinuous at the nodal surface @xmath4.@xcite indeed , if the nodes of the trial wave - function do not correspond exactly to the nodes @xmath14 of an eigenstate of the hamiltonian , the laplacian of the fixed - node ground - state wave - function must have a @xmath15 contribution at least on part of @xmath4 .",
    "otherwise , since the time independent schrdinger equation is satisfied elsewhere by @xmath8 with an energy @xmath3 , without this delta in the laplacian at the nodal surface , @xmath8 would be an eigenstate of the hamiltonian .",
    "this implies that the gradient of @xmath8 must be discontinuous at least at one point of @xmath4 if the nodal surface @xmath16 .    in fig .",
    "[ fg : nodes]a we show a schematic representation of the trial wave - function @xmath0 , the ground - state wave - function @xmath17 and the fixed - node ground - state @xmath8 . in this section",
    "we show that when this kink in @xmath8 is locally smoothed away as @xmath18 the nodes of the resulting functions improve for a broad class of @xmath19 .",
    "provided that @xmath10 is an antisymmetric function with finite projection on the ground state @xmath20 , it has been shown@xcite that @xmath11 , and its nodes converge to the exact ground state @xmath21 where @xmath22 is the hamiltonian and @xmath23 is an estimate for the ground - state energy . setting @xmath24 in eq .",
    "( [ eq : propagator ] ) yields the equivalent equation @xmath25 in the limit of small @xmath26 a real - space linear - order expansion of @xmath27 takes the form @xmath28 where @xmath29 is the potential energy term ( including interactions ) in the hamiltonian and the @xmath30 are eigenvalues of the eigenvectors @xmath31 . replacing the first line in eq .",
    "( [ eq : delta ] ) in eq .",
    "( [ eq : dmc ] ) we obtain a function @xmath32 that has , by construction [ see eq .",
    "( [ eq : delta ] ) second line ] , an energy less than or equal to the energy of @xmath33 ( being equal for @xmath34 ) .",
    "this form of trial wave - function is similar to a shadow wave - function.@xcite if we could evaluate eq .",
    "( [ eq : dmc ] ) analytically@xcite and use the result @xmath32 in a new dmc run , we would obtain a new fixed - node ground - state wave - function with an even lower dmc energy .",
    "this implies that the nodes of @xmath32 are better than the ones of @xmath0 .",
    "note that eq .",
    "( [ eq : delta ] ) tends to the dirac @xmath35 function as @xmath36 for @xmath37 .",
    "the factor @xmath38 in eq .",
    "( [ eq : delta ] ) does not alter the nodes : it is a positive scalar function ( only acts as a branching term in a one time step simulation ) . accordingly , to linear order in @xmath26 , only the gaussian is required to improve the nodes . in turn the gaussian factor can be replaced by any other approximation of the @xmath35 function as long as it does the same to the nodes of @xmath8 as some gaussian for small @xmath26 .    in order to determine the class of smoothing functions that move the node in eq .",
    "( [ eq : dmc ] ) as a gaussian , we consider a patch @xmath39 of the nodal surface @xmath4 centered at @xmath40 with a diameter small enough ( so that it can be considered a flat hyper - plane ) but much larger than @xmath41 .",
    "the integration of the 3n dimensional gaussian in the directions of the hyper - plane leads to a one dimensional gaussian @xmath42 .",
    "any approximation of @xmath43 after integration in @xmath44 coordinates should result in a function @xmath45 that can be rescaled and translated to satisfy the following properties : @xmath46    in the immediate vicinity of @xmath40 , the function @xmath8 depends only on the coordinate in the direction normal to the surface @xmath47 defined as @xmath48 . for @xmath49 we can approximate @xmath50 and @xmath51 in eq .",
    "( [ eq : appsi ] ) the wave - function is expanded as a combination of a smooth function ( with coefficients @xmath52 and @xmath53 ) plus a kink ( @xmath54 and @xmath55 ) . replacing eq .",
    "( [ eq : appsi ] ) and eq .",
    "( [ eq : apderpsi ] ) into eq .",
    "( [ eq : dmc ] ) and replacing the gaussian by a generic approximation of @xmath56 we get : @xmath57 \\sqrt{\\tau}+o(\\tau)\\ ] ] and the first derivative @xmath58 + 4 k_2 a[d ] \\sqrt{\\tau } + o(\\tau)\\ ] ] where @xmath59=\\int |x| d(x ) dx$ ] and @xmath60=\\int \\mathrm{sign}(x ) d(x ) dx$ ] .",
    "note that if @xmath45 has the gaussian form @xmath61=\\sqrt{2/\\pi}>0 $ ] and @xmath62=0 $ ] . using eqs .",
    "( [ eq : val ] ) and ( [ eq : der ] ) we can estimate the displacement of the node to be @xmath63}{c_1 + k_1 s[d ] } \\sqrt{\\tau } + o(\\tau).\\ ] ] therefore , for any symmetric approximation of the @xmath35 function @xmath60=0 $ ] , provided that @xmath59>0 $ ] , one can obtain the same displacement in the node as a gaussian with @xmath64 ^ 2 \\tau/2 $ ] . for a non - symmetric @xmath45 , the node will move in the same direction as long as the sign in the denominator of eq .",
    "( [ eq : newnode ] ) does not change .",
    "however , a uniform rescaling of @xmath26 to match the gaussian form will no longer be possible .",
    "that means that the node will move faster towards the exact node in some regions of the surface than in others .",
    "thus , as long as the approximation of the delta used for smoothing is a function of the distance only , with @xmath59>0 $ ] , one can find some gaussian that moves the node in the same way for every patch @xmath65 .",
    "this movement corresponds to a better node .",
    "the restrictions in @xmath45 can be alleviated by using a repeated convolution . using the central limit theorem",
    "it can be shown that a recursive convolution of any approximation of @xmath45 tends to a gaussian as long as the taylor expansion of its fourier transform exists .",
    "thus if the shape of @xmath45 is not known the method would be more stable if it is applied sequentially .    in section [ sc :",
    "multideterminants ] we will use a smoothing function of the form @xmath66 where the @xmath67 are continuous functions without kinks forming a complete basis and the `` @xmath68 '' in @xmath69 means that only some elements are included in the sum ( with a criterion described below ) . if the @xmath67 in eq .",
    "( [ eq : deltaexp ] ) are obtained from a non - interacting problem and the criterion for truncation is an energy cutoff , it can be shown that the resulting function is only a function of the distance @xmath70 . since in that limit",
    "only plane waves of large energy are added to eq .",
    "( [ eq : deltaexp ] ) and all the lower plane waves are included in the lower energy components , the basis can be transformed with a unitary transformation into a plane - wave basis with a spherical cutoff in reciprocal space . if there is the same number of plane waves in any direction the results of eq .",
    "( [ eq : deltaexp ] ) only depend on the distance which implies that @xmath60=0 $ ] .    since we restrict the sum in eq .",
    "( [ eq : deltaexp ] ) to fermionic antisymmetric @xmath67 , eq .",
    "( [ eq : deltaexp ] ) expands an antisymmetrized delta@xcite .",
    "this form projects out any non - fermionic component introduced in the wave - function along the dmc algorithm as in the a - function approach used by bianchi and collaborators.@xcite    in section [ sc : singledeterminant ] we propose a simple interpolation scheme to smooth the node where the expansion used in eq .",
    "( [ eq : deltaexp ] ) is not taken to the high energy cutoff limit .",
    "the fact that these smoothing methods work in practice suggests that the conditions to improve the nodes are extended beyond the exact equivalence to a gaussian form .",
    "note that a discontinuity of the gradient of the fixed - node wave - function @xmath8 at the node implies@xcite that , if walkers are distributed according to @xmath8 with the sign ( or phase ) of @xmath8 , there will be more walkers in the vicinity of one side of the nodal surface than on the other .",
    "accordingly , if these walkers are released in a pure diffusion algorithm,@xcite for @xmath37 they will cross , on average , more from one side of the nodal surface than from the other .",
    "the nodes defined by the population of these signed walkers@xcite would move in the same direction that would result from smoothing the kink in @xmath8 provided the time step is short enough and kinetic energy term in the green s function [ eq .",
    "( [ eq : delta ] ) ] is dominant .",
    "consequently , the nodes can be improved by moving them in the direction of least `` walker pressure '' within a pure diffusion approach .",
    "any method to obtain @xmath8 from the walker distribution in a dmc run@xcite will carry the error of statistical fluctuations from using a finite sample of walkers . even if the @xmath8 is forced to remain antisymmetric,@xcite the nodes might move in the wrong direction because of these fluctuations .",
    "we assume the method is robust against these random fluctuations when applied recursively , and can form the basis of an optimization process to improve the trial wave - function .",
    "note that if incorrect fluctuations increase the kink in @xmath8 at the node , the probability to sample the correct fixed - node wave - function will remain higher and also the probability to move the node in the correct direction in successive iterations .",
    "conversely , fluctuations that correctly improve the nodes will be reinforced@xcite in successive iterations .",
    "since these fluctuations are reduced when the statistical sampling is improved , the nodal surfaces will converge to the true nodes if the statistics is improved from one iteration to the next ( fig .",
    "[ fg : nodes]b ) .",
    "note that we do not claim that this process is necessarily the most efficient optimization approach : more sophisticated iterative methods and optimization algorithms are clearly possible .    summarizing",
    ", we should be able to improve the nodes systematically provided we can obtain _ the anti - symmetric function _ @xmath8 from the walker configurations ( probability distribution ) of a dmc calculation after convolution with a smoothing function.@xcite",
    "the distribution function of the walkers in an importance sampling dmc algorithm is given by:@xcite @xmath71 where @xmath0 typically has the slater - jastrow form @xmath72 in which @xmath1 consists of a single determinant for each electronic spin component composed of single - particle orbitals .",
    "the results of this paper are also valid if @xmath1 has a more general form such as consisting of multi - determinant expansions for each spin component and/or containing back - flow or two - particle pfaffians .",
    "the @xmath73 in eq .",
    "( [ eq : eta ] ) correspond to the positions of an equilibrated ensemble of @xmath74 configurations in a dmc algorithm ( we have set the weights equal to one for simplicity ) .",
    "we note that @xmath8 in eq .",
    "( [ eq : eta ] ) can be rewritten as an antisymmetric function times the jastrow factor @xmath2 as @xmath75 where @xmath76 is a complete configuration interaction ( ci ) expansion in the basis of electron - hole pairs .",
    "accordingly , in eq .",
    "( [ eq : expan ] ) the @xmath77 are slater determinants or pfaffians@xcite obtained from replacing in @xmath78 some of the occupied @xmath79 single particle functions by unoccupied @xmath80 functions , accordingly @xmath81 .    in practice ,",
    "the ci expansion can be truncated retaining , for example , only the @xmath82 with a non - interacting energy below a given energy cutoff .",
    "the ci expansion in principle consists of all single , double , triple , quadruple and higher - order excitations . by analogy with conventional ci calculations ,",
    "the higher - order excitations are expected to contribute less to the wave - function than low - order excitations . as the kinetic energy of higher - order excitations increases as compared with the interaction , their contribution to the ground - state wave - function decreases .    while a jastrow factor @xmath2 is not formally required in a complete expansion of the wave - function in eq .",
    "( [ eq : expan ] ) , it is believed that the introduction of a jastrow factor limits the number of coefficients required in the multi - determinant expansion , due in part to the more efficient description of the electron - electron cusp .",
    "for some applications it may be desirable to _ not _ employ a jastrow factor , since the extracted wave - function may be more easily used in later analysis .",
    "replacing eq .",
    "( [ eq : expan ] ) and eq .",
    "( [ eq : psit ] ) in eq .",
    "( [ eq : eta ] ) we obtain @xmath83 borrowing a method from optimized effective potentials ( oep ) we define the following projectors:@xcite @xmath84 note that the projectors @xmath85 are symmetric ( bosonic ) functions.@xcite replacing @xmath86 by eq .",
    "( [ eq : expaneta ] ) , using the definition of @xmath85 [ eq .",
    "( [ eq : xi ] ) ] and the orthogonality condition it can be demonstrated that @xmath87 thus , the coefficients of the multi - determinant expansion eq .",
    "( [ eq : expan ] ) of the fixed - node dmc ground - state wave - function can be estimated directly as a sum over the total number of walkers @xmath74 along the dmc random walk , using the second line of eq .",
    "( [ eq : eta ] ) , as @xmath88 where @xmath89 for convenience we divided by the number of walkers @xmath74 in eqs .",
    "( [ eq : eta ] ) and  (    [ eq : sampcoeff ] ) since the normalization constant of @xmath8 and the corresponding coefficients @xmath90 is arbitrary .",
    "the factor @xmath91 in eq .",
    "( [ eq : sampcoeff ] ) is a time step , @xmath26 , correction derived following ref .   that corrects the divergences of the projectors @xmath92 at the nodes .",
    "this correction is not always applied to estimators ( e.g. the local energy ) but we find that it reduces the error of the wave - function coefficients .",
    "for an uncorrelated sample of walker configurations the error bar of the multi - determinant expansion can be determined from @xmath93 as @xmath94 in eq .",
    "( [ eq : errorbar ] ) the error bar in the multi - determinant coefficients @xmath90 goes to zero . as usual , the error bars can be used to monitor convergence of the calculation . while the eventual goal is to obtain small error bars , we found in practice it is better to start with @xmath74 small and then to slowly increase it with each iteration as the trial wave - function improves ( see below ) .    by substituting eqs .",
    "( [ eq : eta ] ) , ( [ eq : psit ] ) , and ( [ eq : xi ] ) into eq .",
    "( [ eq : coeff ] ) and defining the fixed - node function @xmath95 in terms of the trial function jastrow and the fixed - node wave - function @xmath10 @xmath96 one can obtain this expression @xmath97 for @xmath90 .",
    "we define @xmath32 to be the truncated expansion ( denoted using @xmath68 ) of eq .",
    "( [ eq : expan ] ) @xmath98 substituting eq .",
    "( [ eq : lambda_expression ] ) into eq .",
    "( [ eq : psit_trunc ] ) yields the equation @xmath99 \\phi_{fn } ( { \\bf r}^\\prime ) \\ ; .\\ ] ] in section [ sc : prove ] we showed that the appearance of a smoothing function of the form of eq .",
    "( [ eq : deltaexp ] ) as in the term in brackets in eq .",
    "( [ eq : psit_trunc_delta ] ) will smooth the nodes of @xmath100 yielding _ better nodes _ for @xmath32 . since the @xmath77 are selected to be eigenvectors of a non - interacting problem",
    ", highly localized features of @xmath101 would require components with high eigenvalues .",
    "at the same time , resolving those details would require a large number of configurations to improve the statistics .",
    "accordingly , we truncate the expansion in eq .",
    "( [ eq : psit_trunc ] ) to the coefficients with relative errors smaller than 25% .",
    "note that as the statistics is improved , the error bars diminishes , the number of functions retained in eq .",
    "( [ eq : deltaexp ] ) increases and so does the localization of @xmath102 . thus the conditions to improve the nodes systematically as described in section [ sc : prove ] are reached as the statistics improves .      instead of expressing @xmath8 as a product of the same jastrow factor used in @xmath0 times a different multi - determinant expansion",
    ", one can choose to optimize the jastrow factor while using the same antisymmetric function @xmath1 .",
    "it is easy to show that there is a symmetric bosonic factor that turns @xmath1 into @xmath8 which is formally given by @xmath103 replacing eq .",
    "( [ eq : expan ] ) in eq .",
    "( [ eq : getjastrow ] ) we find @xmath104 note that the product @xmath105 yields eq .",
    "( [ eq : expan ] ) . while this shows that the projectors @xmath106 could be used to improve the jastrow factor , since they diverge for @xmath107 , it is necessary to fit instead a continuous functional form using values away from the nodes where truncation and sampling errors play a dominant role ( see section [ sc : singledeterminant ] ) . updating the multi - determinant expansion of the antisymmetric part of the new trial wave - function ,",
    "( [ eq : psit_trunc ] ) , alters the nodes because ( i ) the expansion is truncated and ( ii ) the coefficients of the multi - determinant expansion have a random error due to finite sampling in eq .",
    "( [ eq : sampcoeff ] ) . on the other hand ,",
    "updating the jastrow factor , see eq .",
    "( [ eq : givejastrow ] ) , keeps the nodes fixed but reduces the number of determinants required and the overall computational cost .",
    "there is a compromise between accuracy and speed.@xcite a very good wave - function might have a very small variance in the local energy , but if it is expensive to evaluate one might obtain the same statistical error in less wall - clock time with a faster lower quality wave - function . in an ideal case ,",
    "if the nodes are @xmath108-representable ( see below and ref .  ) only a single determinant is required to describe the fixed - node ground - state wave - function to sufficient accuracy . in practice ,",
    "the form of the jastrow factor @xmath109 is unknown , while an infinite multi - determinant expansion is infeasible .",
    "this implies that both the factors in eq .",
    "( [ eq : expan ] ) are required in general ; an efficient scheme will optimize both the jastrow factor and determinantal part of the wave - function .",
    "particularly for the case of a metallic system , the cost of a multi - determinant expansion might be prohibitive due to the large number of low - energy excitations . in this case",
    "it might be preferable to concentrate on an optimized jastrow factor.@xcite      we have formulated , for small systems , a working iterative algorithm based on a multi - determinant or multi - pfaffian expansion of the fixed - node ground - state wave - function . in this algorithm the calculated coefficients",
    "( [ eq : sampcoeff ] ) of the expansion are used to form a new trial wave - function defined by eq .",
    "( [ eq : psit_trunc ] ) .",
    "initially the statistical errors present in @xmath90 due to finite sampling appear to have a beneficial role , particularly when the initial trial wave - function has poor nodes .",
    "note that in the limit of an infinite number of determinants in eq .",
    "( [ eq : psit_trunc ] ) with no statistical sampling errors in @xmath90 the trial wave - function would exactly reproduce the fixed - node wave - function , and an iterative improvement of the nodes would not be possible .",
    "statistical fluctuations in the coefficients @xmath90 allow the nodes to move . in the next iteration regions near beneficial fluctuations are revisited by walkers while bad statistically insignificant fluctuations tend not to propagate or grow .",
    "this stability against random noise appears to be valid in practice .",
    "thus , the statistical error in the coefficients plays the role of a random thermal fluctuation in a simulated annealing algorithm.@xcite it is ironic and remarkable that random errors can be used to eliminate systematic errors .    while it is relatively economical to calculate a large number of multi - determinants every autocorrelation length , as more determinants",
    "are included in the trial wave - function each time step of the dmc calculation becomes more demanding .",
    "accordingly , for large or continuum systems a method to minimize the number of determinants used to represent a given nodal surface is required .",
    "this is described in the next section .",
    "while a working multi - determinant algorithm can be constructed on the basis of the multi - determinant expansion of the previous section , a significant step forward can be taken using the theory developed in ref .   and taking advantage of eq .",
    "( [ eq : eta ] ) to construct a new trial wave - function that can be evaluated more efficiently than the multi - determinant expansion eq .",
    "( [ eq : psit_trunc ] ) .",
    "this method will be most effective when the initial single particle orbitals involved in @xmath1 are poor , e.g. if the system is strongly correlated .      given a probability density @xmath110 and a binned statistical sample of @xmath74 configurations of the random variable @xmath6 , we can define a new random variable @xmath111 ^ 2 } { n_c \\omega_i \\bar{p}({\\bf r}_i)}\\ ] ] which is distributed by the chi - squared distribution function.@xcite in eq .",
    "( [ eq : chi2 ] ) @xmath112 is the volume of the bin @xmath113 , with @xmath114 configuration counts , @xmath115 is the average of @xmath110 in @xmath112 and @xmath116 is the number of bins .",
    "each term in eq .",
    "( [ eq : chi2 ] ) is the square deviation of @xmath114 divided by the expectation value of the mean . in the limit of large counts the square of the mean",
    "is expected to be equal to the square deviation for the poisson distribution of counts in a bin .",
    "accordingly , in @xmath117 relative deviations from the mean have the same impact independently of the absolute value of the probability density .",
    "we will take advantage of this property to replace a wave - function difficult to evaluate eq .",
    "( [ eq : eta ] ) by a simpler approximate one that retains key properties . setting @xmath118 in eq .",
    "( [ eq : chi2 ] ) , dividing by @xmath74 taking the limit @xmath119 , and using the mean value theorem , we find a cost function to compare two continuous distribution functions : @xmath120 ^ 2 } { p({\\bf r } ) } \\ ; .\\ ] ]    we showed in ref .   that if we wish to preserve properties , other than the density , cost functions can be defined relating the many - body ground - state @xmath17 with a non - interacting wave - function @xmath121 .",
    "the walker distribution function@xcite given by eq .",
    "( [ eq : eta ] ) allows us to construct several cost functions relating the wave - function to optimize with the exact fixed - node ground - state @xmath8 . using eq .",
    "( [ eq : p.vs.q ] ) as a guide , we propose the following expression : @xmath122 where @xmath123 is a trial wave - function to be optimized , @xmath124^{-1 } $ ] , @xmath86 is given by eq .",
    "( [ eq : expaneta ] ) with coefficients obtained from a previous dmc run using eq .",
    "( [ eq : sampcoeff ] ) , @xmath125 is the heaviside function , and @xmath126 is a small positive n umber .",
    "note in eq .",
    "( [ eq : kdmc ] ) that the first factor vanishes when @xmath127 . indeed , if @xmath123 is constrained to have the nodal surface @xmath4 and the sign ( or phase ) of @xmath0 , the integral of the first factor in eq .",
    "( [ eq : kdmc ] ) measures the probability that the distribution of a given ensemble of walkers @xmath86 corresponds to the distribution@xcite @xmath128    in eq .",
    "( [ eq : kdmc ] ) , we add an absolute value function in the denominator of the first factor and a heaviside function in order to extend the set of @xmath123 where the cost function can be evaluated beyond the fixed - node space .",
    "note that , since @xmath129 , while negative values for @xmath130 are allowed , they are penalized in the numerator more than positive values . in eq .",
    "( [ eq : kdmc ] ) , we add @xmath131 to enforce @xmath132 for any @xmath133 . in eq .",
    "( [ eq : kdmc ] ) the nodes of @xmath123 can move within a distance [ which depends on @xmath126 and @xmath134 ) ] around @xmath4 . otherwise , if the zeros of the numerator and denominator of eq .",
    "( [ eq : kdmc ] ) do not match , the value of the cost function would rise to infinity .",
    "an additional effect of @xmath135 is that any kink of @xmath8 at the node is not enforced by the cost function in @xmath123 .",
    "since @xmath123 will be obtained from the minimum energy solution of a non - interacting problem@xcite and departures at the node are not penalized , it will interpolate smoothly avoiding a kink .",
    "note that we can choose alternative cost function forms .",
    "for example , we can replace the denominator in eq .",
    "( [ eq : kdmc ] ) by @xmath134 ) .",
    "this choice would simplify the derivatives of the cost function but it has a couple of disadvantages : first @xmath136 is expected to be a very noisy function when its magnitude is small , while the product of non - interacting @xmath108-representable wave - functions @xmath137 is expected to be smooth ( see [ ssc : represent ] ) .",
    "we choose not to amplify the noise of @xmath136 in the denominator .",
    "second , in eq .",
    "( [ eq : kdmc ] ) a small number for @xmath130 outside the window defined by the heaviside function is highly penalized which confines the node of @xmath138 to remain inside the window where the heaviside function is zero .",
    "given an interaction in a many - body system , the hohenberg - kohn theorem@xcite establishes a functional correspondence between electronic densities @xmath139 , external potentials @xmath140 , and ground - state wave - functions @xmath17 .",
    "the subset of densities @xmath139 corresponding to a ground state of an interacting system under an external potential @xmath140 are denoted as _ pure state _ @xmath108-representable.@xcite a non - interacting _ pure state _",
    "@xmath108-representable density is given instead by @xmath141 where @xmath142 are kohn - sham - like@xcite single particle orbitals , or eigenvectors , of the single - particle hamiltonian : @xmath143 \\phi_{\\nu}\\left({\\bf r } \\right ) = \\varepsilon_{\\nu } \\phi_{\\nu } \\left ( { \\bf r}\\right),\\ ] ] where @xmath144 is an effective single particle potential . the lowest energy slater determinant constructed with the solution of eq .",
    "( [ eq : heff ] ) is a many - body non - interacting ground state . for simplicity",
    "we denote those quantities that are simultaneously interacting and non - interacting @xmath108-representable as simply _",
    "@xmath108-representable_. in addition , certain quantities can be _ multi - determinant _",
    "@xmath108-representable , meaning that they can be represented by a finite multi - determinant expansion constructed with the solutions of eq .",
    "( [ eq : heff ] ) .",
    "since , the ground - state density @xmath139 determines the ground - state wave - function @xmath145,@xcite @xmath139 defines also the points @xmath146 of the nodal surface @xmath14 where @xmath147 .",
    "the nodes of the trial wave - function , instead , are by construction those of @xmath1 ( non - interacting @xmath108-representable in the single determinant case ) .",
    "the exact nodes @xmath14 may or may not be representable in this manner.@xcite      the trial wave - function is often constructed with non - interacting orbitals derived from an effective potential [ see eq . ( [ eq : heff ] ) ] , e.g. from kohn - sham dft . for the moment we will assume that @xmath123 is given in the single determinant slater - jastrow form : @xmath148 ( this derivation is extended to multiple determinants or pfaffians in [ ssc : opmultideterminants ] ) .",
    "however , for now , we assume that the node _ can move _ within all the non - interacting @xmath108-representable set , which is a less restrictive condition than the fixed - node approximation but implies accepting an error if @xmath14 is not @xmath108-representable .    in ref .",
    "we showed that , if the trial wave function depends on non - interacting orbitals in an effective potential [ as in eq .",
    "( [ eq : heff ] ) ] , the effective potential @xmath149 required to retain a given property is a function of the cost function @xmath150 . to simplify formulae , discussion and notation we assume here that all wave - functions are real .",
    "the potential can be obtained by adding recursively the following correction :    @xmath151    where @xmath152 is adjusted during the optimization .",
    "replacing @xmath150 by @xmath153 we get @xmath154 where @xmath155 for which we obtain @xmath156 \\mu \\ ;",
    "\\psi_t({\\bf r } ) \\theta \\left ( f({\\bf r } ) - \\eta \\right ) , \\end{aligned}\\ ] ] with @xmath157 . within first order perturbation theory @xmath158 replacing eq .",
    "( [ eq : dkdmc ] ) and eq .",
    "( [ eq : linearresp ] ) in eq .",
    "( [ eq : vk ] ) , we find @xmath159    in eqs .",
    "( [ eq : vk ] ) , ( [ eq : linearresp ] ) , and ( [ eq : vdmc ] ) we used @xmath160 ( @xmath161 ) to define sums over occupied ( unoccupied ) states . in turn in eq .",
    "( [ eq : betn ] ) @xmath162 means replacing the occupied state @xmath79 by @xmath80 which results from combining the cofactors of @xmath163 [ @xmath164 ] in eq .",
    "( [ eq : dkdmc ] ) with @xmath165 in eq .",
    "( [ eq : linearresp ] ) . the first factor in function @xmath166 [ eq .",
    "( [ eq : wr ] ) ] is obtained from the derivative of the cost function eq .",
    "( [ eq : kdmc ] ) with respect to @xmath130 [ ignoring contributions coming from the discontinuities of @xmath167 since the heaviside function in eq .",
    "( [ eq : kdmc ] ) is zero near the nodes ] .",
    "the second factor in @xmath166 results from the derivative of @xmath130 with respect to @xmath123 . [ note that @xmath168 is also dependent on @xmath123 ]      we argued in the previous section that an optimal jastrow factor can be used to reduce the number of determinants in the multi - determinant expansion . optimizing the jastrow factor is important to limit the exponential cost of the ci expansion because , while the jastrow factor can not influence the nodes , it can reduce the burden of correcting the probability density from any value given by a slater determinant ( see eq .",
    "( [ eq : getjastrow ] ) ) . accordingly , if the jastrow factor is optimized , the antisymmetric part of the wave - function is free to search for the nodes",
    ". often the @xmath169 is dependent on a set of parameters @xmath170 .",
    "the value of the cost function ( eq .  [ eq : kdmc ] ) is also affected by the jastrow factor @xmath171 .",
    "thus the gradient of the cost function with respect to an arbitrary change in @xmath171 can be obtained within dmc via @xmath172      note at this point that ( 1 ) both the coefficients @xmath173 and @xmath170 are integrals of the function @xmath166 which is only dependent on the particular form of the cost function selected in eq .",
    "( [ eq : kdmc ] ) and a representation of the walkers distribution @xmath86 .",
    "\\(2 ) the function @xmath86 is an essential component of @xmath174 that can be obtained from the dmc run using eqs .",
    "( [ eq : expaneta ] ) and ( [ eq : sampcoeff ] ) or sampled directly by binning.@xcite    \\(3 ) provided that @xmath86 is known , a distribution of configurations @xmath73 with probability @xmath175 can be generated with the metropolis algorithm .",
    "all integrals of the form @xmath176 involved in eqs .",
    "( [ eq : vdmc ] ) and ( [ eq : opj ] ) can be evaluated in a single correlated sampling step as @xmath177 g({\\bf    r}_i)$ ] using points @xmath73 drawn from the probability distribution defined by the absolute value of @xmath166 .",
    "\\(4 ) in most methods , the jastrow parameters @xmath170 are optimized within a variational monte carlo approach ( either minimizing the total energy or the energy variance ) . here",
    "we optimize them within a dmc run .",
    "the role of the jastrow factor within this approach , is different .",
    "its role instead is to correct the trial wave - function @xmath178 to match @xmath101 .",
    "the optimization of the jastrow parameters with eq .",
    "( [ eq : opj ] ) only ensures that the cost - function eq .",
    "( [ eq : kdmc ] ) is minimum .",
    "optimization of the jastrow factor is required to allow the antisymmetric part of the wave - function to move the nodes while the jastrow factor takes care of the symmetric contribution . however ,",
    "if the variational freedom of the jastrow factor or the statistics are limited , the minimization of eq .",
    "( [ eq : kdmc ] ) does not necessarily imply a minimum in the vmc energy or its variance : the variance of the local energy might rise . in those cases",
    "the jastrow factor must be optimized twice : first when the potential is optimized and second during a vmc variance minimization before a collection dmc run .",
    "finally , ( 5 ) note that @xmath123 and @xmath0 have different jastrow factors ( @xmath0 is kept fixed during the cost function optimization steps ) .",
    "the multi - determinant expansion obtained in this subsection is different from the one obtained in section [ sc : multideterminants ] . in section [ sc : multideterminants ] we found a multi - determinant expression of @xmath8 in a given non - interacting orbital basis set for a given fixed jastrow factor .",
    "here we optimize the jastrow factor and the non - interacting basis to match @xmath8 within a prescribed small number of determinants .",
    "if we restrict the search to pure - state non - interacting @xmath108-representable nodes , the minimum energy @xmath179 will be larger than the true ground - state energy @xmath180 $ ] , because of the upper - bound theorem , unless @xmath14 is @xmath108-representable . in dmc the @xmath108-representability constraint",
    "is not required and can be partially removed by including multi - determinants in @xmath1 giving more variational freedom to the nodes .",
    "note that if we express @xmath123 as a multi - determinant expansion of the form @xmath181 an equivalent expression for wave - function optimization can be found .",
    "the sum over occupied ( unoccupied ) levels in eq .",
    "( [ eq : vk ] ) must be extended to every orbital that is occupied ( unoccupied ) in @xmath182 . also , it is easy to prove that the only change in eq .",
    "( [ eq : vdmc ] ) required is in the values of the @xmath183 which must be replaced by    @xmath184    where the operators @xmath185 and @xmath186 change , when possible , the single particle state @xmath79 with @xmath80 in the slater determinant @xmath187 ; and give zero if @xmath79 is not included or @xmath80 is already occupied .",
    "the function @xmath166 is still given by eq .",
    "( [ eq : wr ] ) .",
    "the coefficients @xmath188 can be optimized using the following expression @xmath189",
    "in this section , to demonstrate the methods described above , we solve a simple yet non - trivial interacting model as a function of the interacting potential strength and shape .",
    "we then test a simple version of the algorithm described in section [ sc : multideterminants ] .",
    "subsequently , we replace the model interaction by a realistic coulomb interaction .",
    "finally , in subsection [ ssc : model2 ] we optimize the wave - functions by obtaining the effective nodal potential , as described in section [ sc : singledeterminant ] .      for illustrative purposes we choose the same problem studied in ref .   where we derived the existence of an effective potential for the wave - function nodes",
    "briefly , we solve the ground state of two spin - less electrons moving in a two dimensional square of side length @xmath190 with a repulsive interaction potential of the form@xcite @xmath191}\\cos{[\\alpha    \\pi(y - y^{\\prime})]}$ ] . in this paper",
    "we show results for @xmath192 and @xmath193 . with this choice of parameters",
    "the system is in the highly correlated regime , because the matrix element of the interaction potential between the non - interacting ground state and first excited state is larger than the non - interacting energy difference .",
    "we expand the many - body wave - function in a full ci expansion of slater determinants with the same symmetry as the ground state .",
    "the ground state is degenerate because there are only two electrons .",
    "we choose one of the ground - state wave - functions according to the @xmath194 subgroup of the @xmath195 symmetry of the hamiltonian . for more details",
    "see ref . .",
    "black points denote the average value of the local energy for each dmc step .",
    "green points mark the reference energy used for population control .",
    "orange lines mark the average energy of the trial wave - function .",
    "the horizontal blue line marks the energy of the ground state in the full ci calculation .",
    "vertical lines mark the steps when the coefficients of wave - function are updated .",
    "inset : detail of the dmc run for the first 10000 steps ( same conventions as in the main figure ) . ]    from the full ci calculation we obtain a nearly exact expression of the ground state @xmath196 .",
    "in order to facilitate the comparison with the full ci results , we sample the mixed - estimator density with the projectors @xmath85 constructed using the same basis functions of the ci expansion . for the same reason",
    ", we utilized no jastrow function ( @xmath197 in eq .",
    "[ eq : xi ] ) .    an initial trial wave - function must be selected . while the non - interacting solution has very good nodes,@xcite we intentionally chose a poor initial trial wave - function in order to test the strength of the multi - determinant method described in section [ sc : multideterminants ] .",
    "the worst case scenario is when the trial wave - function is orthogonal to the exact ground state .",
    "if the exact ground state is not included in the trial wave - function , a projector method such as the standard dmc algorithm _ can not _ yield the exact ground - state energy .",
    "accordingly , to test the method , we chose for this example @xmath198 , @xmath199 and @xmath200 for all remaining @xmath201.@xcite expanding , @xmath8 with these @xmath90 and replacing it in eq .",
    "( [ eq : xi ] ) we obtain the projectors @xmath85 .",
    "next we obtained new values @xmath90 sampling eq .",
    "( [ eq : sampcoeff ] ) every autocorrelation time .",
    "after many configurations are sampled , we construct a new trial wave - function with the new @xmath90 .",
    "we only include in the wave - function the coefficients that satisfied the condition @xmath202 , i.e. that the coefficients are well determined according to this empirical threshold .",
    "note that because the multi - determinants are solutions of a non - interacting problem , they will tend to have more nodes as their energy increases .",
    "accordingly , high energy components of the wave - function will have smaller coefficients ( @xmath203 ) in absolute value as compared with the error ( @xmath204 ) . as a consequence",
    ", this acceptance threshold removes the contribution of the high energy components which implies that the resulting wave - function will be smoother than @xmath8 without the kinks at the nodes .",
    "this process is the core of a more complex algorithm we propose for larger systems that is explained in section [ sc : algorithm ] ( see steps 3 and 4 ) .    the result of this iterative approach is summarized in figs .",
    "[ fg : dmccirun ] , [ fg : dmccoeff ] , [ fg : dmccoeffb ] and [ fg : dmcproj ] . in fig .",
    "[ fg : dmccirun ] we show the average of the local energy @xmath205 ( black dots ) and the best estimator for the energy @xmath206 ( green dots)@xcite as a function of the number of dmc steps .",
    "the average energy of the trial wave - function @xmath207 ( orange ) is also given for comparison .",
    "the run was carried out for a targeted population of @xmath208 walkers .",
    "the exact full ci result is given by the blue line .",
    "there is a dramatic decrease of @xmath205 , @xmath206 and @xmath209 as the trial wave - function is updated , and all these values converge to the full ci result .",
    "similar results are obtained with different starting points and interaction strengths .",
    "the only limiting factor to reaching the exact ci results appears to be the iteration time .",
    "the reduction in the energy variance can be seen in fig .",
    "[ fg : dmccirun ] where the fluctuations in the local energy decrease as the run continues .        in fig .",
    "[ fg : dmccoeff ] we show a plot of the values of the full ci coefficients as a function of the coefficient index compared with the average values obtained from the optimized trial wave - function and a final dmc run using eq .",
    "( [ eq : sampcoeff ] ) .",
    "the coefficients are ordered with increasing non - interacting energy .",
    "the error bars of the coefficient are also given .",
    "the figure shows that a wave - function expansion with the quality of a ci expansion can be obtained with dmc .",
    "note that ( i ) knowledge of the ground - state wave - function allows for the calculation of any other observable with an error bar that can be obtained from the error bars of the expansion coefficients .",
    "( ii ) the same wave - function could be expressed with a smaller number of determinants if a jastrow factor had been used .        in fig .",
    "[ fg : dmccoeffb ] we show the evolution of the values of the full ci coefficients as a the algorithm progresses starting from a trial wave - function orthogonal to the ground state .",
    "[ see eq .",
    "( [ eq : rp ] ) ] as a function of the total weighted number of configurations along the complete run @xmath210 .",
    "the lines are a guide to the eye .",
    "inset : projection of the dmc self - healed wave - function onto the full ci ground state as function of the logarithm of @xmath210 . ]",
    "the improved quality of the dmc optimized trial wave - function is also evident in fig .",
    "[ fg : dmcproj ] .",
    "we plot the logarithm of the residual projection @xmath211}\\ ] ] on the `` exact '' ci ground state as a function of the logarithm of the total weighted number of configurations along the complete run @xmath210 .",
    "remarkably , the error of the wave - function projection has decreased to @xmath212 starting from 1 . by noting that @xmath213 is the difference between the ground - state @xmath214 and the trial wave function @xmath215 we get @xmath216 \\;.\\ ] ]",
    "we can see that for a significant section of the run @xmath217 , where @xmath210 is the total number of weighted configurations of the run .",
    "this means that the magnitude of the error in the trial function decays with a _",
    "faster _ exponent than @xmath218 ( @xmath219 ) .",
    "this is surprising because if we had provided the exact ground state as trial wave - function , the error after finite sampling would have scaled as @xmath220 , which replaced in eq .",
    "( [ eq : rpapprox ] ) gives @xmath221 .",
    "this faster exponent , in a section of the plot , is a direct consequence of the fact that both the quality of the trial wave - function and the statistics have improved .",
    "this is another indication that the nodes continue to improve along the run . for the final part of the graph ( the last three points )",
    ", however , @xmath222 scales as @xmath218 .",
    "this possibly signals that after the nodal structure is improved to a critical distance from the exact ground state , the statistical error in the determination of the coefficients and not a small fluctuation in the nodal structure , is the limiting factor for this algorithm .",
    "we believe that a final @xmath218 scaling of @xmath222 signals also that the overall nodal structure of the solution is correct and only small fluctuations of the coefficients are responsible for the small fluctuations from the exact node .",
    "since a direct sampling of the fixed - node wave - function ( eq .",
    "( [ eq : sampcoeff ] ) ) aims to reproduce the fixed - node solution , a single dmc run can not improve the nodes . only by iterating with different trial wave - functions can the nodes be improved . in particular , if an infinite number of configurations were used , the nodes would not change . in practice",
    "however , we find that for a finite sample , the error in the wave - function coefficients plays a positive role .",
    "errors act as random fluctuations in a simulated annealing algorithm .",
    "these fluctuations are reinforced@xcite or discarded in subsequent iterations .",
    "this allows the nodal error to be systematically reduced to the point that trial wave - functions with 0.9995 projections on the full ci ground state can be found starting from a trial wave - function initially orthogonal to the ground state . since poor nodes are associated with discontinuities in the derivative of @xmath8 at the nodal surface , and consequently an increase in the kinetic energy , it is also convenient at first to initially limit the number of configurations sampled ( including first the ones that cost less non - interacting energy ) .",
    "we recognize that the current work does not address the suitability and convergence of this method of relying on random fluctuations for systems with large numbers of electrons ; this will be the subject of later studies .",
    "the use of a simplified electron - electron interaction facilitates the ci calculations and the validation of the optimization method described in section [ sc : multideterminants ] .",
    "however , it is also important to test the convergence and stability of the method with a realistic coulomb interaction .",
    "note that in two dimensions ( 2d ) the correlations are enhanced as compared with three dimensions ( 3d ) while the nodal surface remains non - trivial .",
    "we tested the stability of the algorithm by replacing the interaction potential with:@xcite @xmath223 .",
    "since the length of the square box side is 1 , the difference in kinetic energy between the non - interacting ground state and the first - excited state is @xmath224 .",
    "this choice of parameters for the coulomb potential placed the system in a strongly interacting regime .",
    "to further increase the role of correlations and the difficulties that the algorithm must overcome we did not included a jastrow term , i.e. @xmath197 .",
    "we also increased the chances of _ failure _ by setting the initial trial wave - function equal to the _ first excited state _ of the non - interacting system .        in fig .",
    "[ fg : coulombenvar ] we show the evolution of the average of the local energy for each dmc optimization block as a function of the number of dmc steps in each optimization block @xmath225 .",
    "data for eq .",
    "( [ eq : sampcoeff ] ) is accumulated every @xmath226 dmc steps . as in the case of the model hamiltonian",
    ", we increase @xmath225 in each optimization as @xmath227 where @xmath228 is the total number of blocks . with this choice",
    "we can expect the error bar in the energy and in the coefficient @xmath90 of the multi - determinant expansion eq .",
    "( [ eq : expan ] ) to be reduced a factor @xmath229 after four successive blocks .",
    "note that during each dmc run not only the local energy is sampled but also the values of the projectors @xmath230 used to construct the expansion of the trial wave - function of the next point on the right with eq .",
    "( [ eq : sampcoeff ] ) .    the blue squares in fig .",
    "[ fg : coulombenvar ] show the progression in average dmc energy starting from the first excited state .",
    "the initial energy is above 420 compared with the fully converged energy of 402.718 @xmath231 0.008 .",
    "even starting from such a bad initial trial wave function , our method is able to improve in the second block after only accumulating @xmath232 configurations .",
    "in contrast , the red circles in fig .",
    "[ fg : coulombenvar ] denote the results obtained with an initial trial wave - function constructed with data collected with the right most blue square , a very good initial trial wave - function .",
    "as the optimization process is repeated , the average dmc energy fluctuates .",
    "since the coefficients carry a statistical error , the wave - function is not the same from one block to the other and neither is the nodal error .",
    "there is a shift from one iteration to the next which is sometimes larger than the error bar in the energy .",
    "the energy and the variance can fluctuate and locally increase .",
    "however , as the statistics improve , fluctuations in the coefficients decrease .",
    "the statistical errors play the role of a thermal noise in the coefficient expansion .",
    "improved statistics correspond to reduced temperatures in simulated annealing .",
    "note that , initially , the average dmc energy from the very poor trial wave - function decreases ( blue squares ) as the algorithm progresses , while the energy of the average dmc energy from the good trial wave - function ( red circles ) actually increases .",
    "this is because when the statistics are poor the errors in the coefficient expansion allows improvement of a bad trial wave function but spoil a good quality one .",
    "figure [ fg : coulombenvar ] shows that , as the algorithm progresses and improved statistics are obtained , the quality of the solution becomes independent the initial trial wave - function . note that for intermediate blocks the dmc energy becomes flat , signaling that the the statistics are not enough to reduce the nodal error , but are sufficient to stop deterioration of the wave - function .    repeating the algorithm iteratively leads to an incremental improvement in the statistics which results in a clear reduction of the dmc energy beyond the error bar of the preceding calculations .",
    "the dmc energy and the energy variance are reduced systematically which is a clear indication of the reduction of nodal errors and improvement in the overall quality of the wave - function .",
    "the ground - state energy obtained after 240000 accumulated dmc iterations is 402.718 @xmath231 0.008 .        in fig .",
    "[ fg : coulombcoeff ] we show the values of the coefficients of the multi - determinant expansion as obtained with eq .",
    "( [ eq : sampcoeff ] ) corresponding to the right - most blue point in fig .",
    "[ fg : coulombenvar ] .",
    "note that since no jastrow factor is used and the interaction potential includes a singularity at @xmath233 , the number of coefficients with significant value is much larger the model interaction described earlier .",
    "the final reduction of nodal errors shown in the final steps of fig .",
    "[ fg : coulombenvar ] is associated with subtle variations of the coefficients .",
    "if the jastrow factor is set to one , the density takes a simple form ( eq .  ( [ eq : density ] ) ) in terms of the single - particle orbitals @xmath234 .",
    "knowledge of this density allows the calculation of the kohn - sham potential as explained in ref .",
    "( see below ) and suggests an alternative route for calculation of forces by applying@xcite the hellmann - feynman theorem directly to the kohn - sham total energy instead of the usual statistical sampling.@xcite the dmc density can be obtained in terms of the single - particle orbitals with the following equation:@xcite @xmath235 note in eq .",
    "( [ eq : density ] ) that all the matrix elements @xmath236 corresponding to states that differ in more than one electron hole pair , do not contribute to the ground - state density .    .",
    "a ) left side of the density of the many - body ground state constructed with the converged coefficients shown in fig .",
    "[ fg : coulombcoeff ] .",
    "b ) kohn - sham non - interacting density constructed as explained in ref .  .",
    "]     and [ fg : coulombden ] .",
    "the potential was constructed using the methods explained in ref .  .",
    "]    in fig .",
    "[ fg : coulombden]a we show the density corresponding to the coefficients of fig .  [ fg : coulombcoeff ] and in fig .",
    "[ fg : coulombden]b the non - interacting kohn - sham density constructed using the methods explained in ref .  .    in fig .",
    "[ fg : coulombpot ] we show the kohn - sham potential obtained using the methods described in ref .  .",
    "we minimized the cost function in eq .",
    "( 2 ) of ref .   using 14 fourier components in the potential expansion .",
    "we believe that the sampled oscillations in the kohn - sham potential carry some physical meaning .",
    "indeed , these oscillations are required in order to match the non - interacting density in fig .",
    "[ fg : coulombden]b to the interacting self - healed dmc density in fig .",
    "[ fg : coulombden]a .",
    "however , since the density @xmath139 has an error @xmath237 , there is also an error in the kohn - sham potential . in linear response,@xcite",
    "the error bar in the potential @xmath238 ( not shown ) can be obtained in terms of @xmath239 and the inverse susceptibility as @xmath240    since , we have removed degeneracies in the ground state by restricting the symmetry of the wave - function , two potentials that give the same density can only differ by a constant .",
    "we have obtained from dmc not only the approximated dmc energy but also the derivative of the total energy with respect to local fluctuations of the density .",
    "figures [ fg : coulombden ] and [ fg : coulombpot ] show that this method can provide accurate benchmarks for the validation of dft approximations in the highly correlated regime .      to demonstrate that the effective nodal potential and jastrow factor can be obtained through sampling in dmc ,",
    "in this section we determine these quantities for a model corresponding to two electrons in a square box with coulomb interactions .",
    "an additional goal is to show that a complex ( multi - determinant ) wave - function can potentially be replaced by a simpler one while retaining the same nodal structure .    the results below correspond to a trial wave - function represented using the multi - determinant expansion shown in fig .",
    "[ fg : coulombcoeff ] .",
    "while for larger dimensional systems the integrals can be performed more efficiently using a stochastic approach , in this case the probability densities were binned numerically over a grid of fifteen bins in all four dimensions .",
    "approximately , @xmath241 weighted@xcite configurations were collected .",
    "the one - body and two - body jastrow factors were simply written as a fourier expansion and their coefficients were minimized with an accelerated steepest decent algorithm using eq .",
    "( [ eq : opj ] ) .",
    "the antisymmetric part of the wave - function was given by a single determinant corresponding to the ground - state solution of a non - interacting effective potential .",
    "the effective interactive potential was expressed as a sum of cosine functions and optimized as explained in ref .  .",
    "the jastrow factors and the potentials can be optimized at the same time .",
    "however , since we wanted the jastrow factor to carry most of the load in the optimization of the symmetric corrections to the probability density , the potential was optimized only every third iteration that the jastrow factor was optimized .    the resulting potential , and jastrow factors are shown in fig .",
    "[ fg : optimization ] .",
    "the value of the cost - function was reduced an order of magnitude from starting with the non - interacting ground state with zero effective potential .",
    "the effective potential resulting from this minimization procedure is an example of the nodal potential predicted in ref .  .",
    "we also performed tests of this optimization algorithm using the model interaction discussed in subsection [ ssc : model1 ] . in this case",
    "the nodal structure of the wave - function was also improved ( as signaled by a reduction of the average dmc energy below the error bar of the preceding calculation ) .    ) , in which the multi - determinant expansion of fig .",
    "[ fg : coulombcoeff ] has been replaced by a single determinant function . ]",
    "it is clear from previous sections that an effective wave - function optimization algorithm can be constructed solely on the basis of iteratively updating @xmath242 by the multi - determinant expansion of @xmath10 .",
    "an example of this algorithm applied to a soluble model is presented in subsection [ ssc : model1 ] .",
    "however , multi - determinant expansions in dmc are computationally very expensive in large or continuum system , since the required number of determinants to reach a given accuracy will in general grow combinatorially . the method developed in section [ sc : singledeterminant ] to optimize a single slater determinant",
    "becomes very attractive .",
    "( results of the application of this method were shown in subsection [ ssc : model2 ] ) . for large systems",
    ", the number of multi - determinants must be kept to a minimum and the two methods combined .",
    "experimentation in small systems allows us to suggest an algorithm that will be efficient in larger systems :    1 .",
    "an initial trial trial wave - function @xmath1 is generated using any fast method , e.g. an empirical screened pseudopotential@xcite or a thomas - fermi theory .",
    "the jastrow factor @xmath243 is optimized within vmc .",
    "a dmc run is performed .",
    "the number of configurations @xmath74 sampled is increased as this step is repeated .",
    "statistically uncorrelated values of @xmath85 and @xmath244 are accumulated .",
    "the multi - determinant expansion of @xmath86 is constructed .",
    "only the terms that are significantly non - zero are included in the expansion .",
    "a distribution of configurations @xmath73 with probability @xmath175 is generated .",
    "the gradients of @xmath153 with respect to the effective nodal potential and the gradients of the jastrow factor coefficients are evaluated with eqs .",
    "( [ eq : vdmc ] ) , and ( [ apeq : opak ] ) .",
    "( eventually the multi - determinant expansion coefficients @xmath188 can be included , see subsection [ ssc : opmultideterminants ] . )",
    "6 .   the effective potentials @xmath245 and @xmath169 are updated ( eventually also the @xmath188 ) .",
    "new single particle orbitals are constructed using eq .",
    "( [ eq : heff ] ) .",
    "therefore the single particle orbitals used to construct the slater determinants in the trial wave - function are now determined solely within dmc .",
    "7 .   a new @xmath123 is constructed .",
    "steps ( 5 - 7 ) are repeated until @xmath123 does not change .",
    "8 .   at this step",
    "we can choose to improve the scaling in large systems .",
    "the single - particle orbitals @xmath234 shared by all determinants in the expansion @xmath178 can be transformed to non - orthogonal localized orbitals.@xcite 9 .",
    "the trial wave - function @xmath1 is updated to @xmath178 .",
    "steps ( 2 - 9 ) are repeated until @xmath123 and @xmath179 do not change.@xcite    note that ( i ) the methods in sections [ sc : multideterminants ] and [ sc : singledeterminant ] are complementary . in section [ sc : multideterminants ] , we find a representation of the fixed - node ground state in a given basis . in section [ sc : singledeterminant ] , instead , we optimize and change the basis of the wave - functions so as to reproduce the fixed - node ground - state wave - function with a minimum number of slater determinants .",
    "( ii ) only single configurations are included in eq .",
    "( [ eq : vdmc ] ) but multiple configurations are included in eq .",
    "( [ eq : expan ] ) .",
    "( iii ) we include a jastrow function in eq .",
    "( [ eq : expan ] ) to minimize the number of slater determinants required in the expansion .",
    "however , a final run with no jastrow factor included with the configuration interaction expansion might be useful in order to obtain a pure expression of the ground - state density in terms of the single particle orbitals .",
    "atomic forces could be obtained from this density .",
    "finally ( iv ) the method is , in principle , self reliant : no dft or hf are required .",
    "we have presented an algorithm for sampling the fixed - node many - body wave - function in a single or multi - determinant expansion from a diffusion quantum monte carlo ( dmc ) calculation within the importance sampling technique . by combining this algorithm with a previously developed method for constructing effective potentials targeted at reproducing specific properties of the many - body wave - function,@xcite we presented an iterative algorithm that improves the nodes of the trial / fixed - node wave - functions used in dmc .",
    "tests on a simple two electron model system confirm that this method is able to improve the nodes and that , at least in the case of the tested system , we find wave - functions and energies that exactly match fully converged configuration interaction calculations .",
    "we have proven that the nodes of the fixed - node wave - function improve as compared with the trial wave - function if the kinks at the nodes are locally smoothed out .",
    "the algorithms presented take advantage of this proof .",
    "we have argued that if the kink at the node increases with the `` distance '' from the exact ground - state node to the trial wave - function node , the algorithm should be stable against random statistical fluctuations .",
    "proving this property in general might be difficult and is beyond the scope of this article . clearly , in the absence of a proof , experimentation in larger systems",
    "is required .",
    "while in the past , methods were used to obtain the fixed - node wave - function ( e.g ref .  ) , to our knowledge this is the first time the fixed - node wave - function has been obtained through importance sampling .",
    "the availability of the fixed - node wave - function provides routes to determine the exact kohn - sham potential , allowing benchmark tests of density functionals in highly non - trivial and inhomogeneous systems .",
    "it also seems likely that many of the wave function optimization approaches ( e.g. refs .  )",
    "currently applied within variational monte carlo can be recast in the present scheme , making direct use of the fixed - node wave - function , and likely obtaining improved results .    in ongoing work",
    ", we are continuing to develop these methods .",
    "applications to larger and more complex electronic systems will be reported elsewhere .",
    "research performed at the materials science and technology division and the center of nanophase material sciences at oak ridge national laboratory sponsored the division of materials sciences and the division of scientific user facilities u.s .",
    "department of energy .",
    "this work performed under the auspices of the u.s .",
    "department of energy by lawrence livermore national laboratory under contract de - ac52 - 07na27344 .",
    "the authors would like thank j. kim for discussions and c. umrigar for clarifications related to the use of eq .",
    "( [ eq : gamma ] ) .",
    "equation  ( [ eq : dmc ] ) can be thought of as a one - step ( @xmath248 in eq .",
    "( [ eq : propagator_m ] ) ) in a pure - diffusion dmc run using the small @xmath26 propagator of eq .",
    "( [ eq : delta ] ) , in which the positive and negative walkers have the initial distribution @xmath33 and are not constrained by the nodes of @xmath9 . because of elemental group theory theorems , i ) the product of two anti - symmetric functions is symmetric , ii ) the product of any symmetric operator with any anti - symmetric function results in an anti - symmetric function ( with no projection on any symmetric bosonic function or any other representation of the symmetric group ) .",
    "thus our analytic derivation is true .",
    "since we use an anti - symmetric representation of the wave - function , our numerical method will _ not _ find bosonic states since they are excluded from the search.@xcite the nodes continue to move statistically in the same direction in successive iterations .",
    "the `` release - node '' method @xcite involves two fixed trial wave - functions and two populations of walkers .",
    "our method is very different since , instead , involves only one trial wave - function that is updated and a single population of walkers . in our method",
    "the walkers _ never _ cross the node : we move the node instead . in the so called release - node method",
    "the node is removed .",
    "r. bianchi , d. bressanini , p. cremaschi , m. mella , and g. morosi , j. chem .",
    "phys . * 98 * , 7204 ( 1993 ) ."
  ],
  "abstract_text": [
    "<S> we develop a formalism and present an algorithm for optimization of the trial wave - function used in fixed - node diffusion quantum monte carlo ( dmc ) methods . </S>",
    "<S> the formalism is based on the dmc mixed estimator of the ground - state probability density . </S>",
    "<S> we take advantage of a basic property of the walker configuration distribution generated in a dmc calculation , to ( i ) project - out a multi - determinant expansion of the fixed - node ground - state wave function and ( ii ) to define a cost function that relates the fixed - node ground - state and the non - interacting trial wave functions . </S>",
    "<S> we show that ( a ) locally smoothing out the kink of the fixed - node ground - state wave - function at the node generates a new trial wave - function with better nodal structure and ( b ) we argue that the noise in the fixed - node wave - function resulting from finite sampling plays a beneficial role , allowing the nodes to adjust towards the ones of the exact many - body ground state in a simulated annealing - like process . based on these principles , </S>",
    "<S> we propose a method to improve both single determinant and multi - determinant expansions of the trial wave - function . </S>",
    "<S> the method can be generalized to other wave - function forms such as pfaffians . </S>",
    "<S> we test the method in a model system where benchmark configuration interaction calculations can be performed and most components of the hamiltonian are evaluated analytically . comparing the dmc calculations with the exact solutions </S>",
    "<S> , we find that the trial wave - function is systematically improved . </S>",
    "<S> the overlap of the optimized trial wave function and the exact ground state converges to 100% even starting from wave - functions orthogonal to the exact ground state . </S>",
    "<S> similarly , the dmc total energy and density converges to the exact solutions for the model . in the optimization process </S>",
    "<S> we find an optimal non - interacting nodal potential of density - functional - like form whose existence was predicted in a previous publication [ phys . rev . </S>",
    "<S> b * 77 * , 245110 ( 2008 ) ] . tests of the method are extended to a model system with a conventional coulomb interaction where we show we can obtain the exact kohn - sham effective potential from the dmc data . </S>"
  ]
}