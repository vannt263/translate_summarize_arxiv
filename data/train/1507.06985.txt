{
  "article_text": [
    "a conventional light detection and ranging ( lidar ) system , which uses a pulsed light source and a single - photon detector , forms a depth image pixelwise using the histograms of photon detection times .",
    "the acquisition times for such systems are made long enough to detect hundreds of photons per pixel for the finely binned histograms these systems require to do accurate depth estimation . in this letter",
    ", we introduce a framework for accurate depth imaging using only a small number of photon detections per pixel , despite the presence of an unknown amount of spatially - varying background light in the scene .",
    "our framework uses a poisson observation model for the photon detections plus a union - of - subspaces constraint on the scene s discrete - time flux at any single pixel .",
    "using a greedy signal - pursuit algorithm  a modification of cosamp  @xcite  we solve for accurate estimates of scene depth and background flux .",
    "our method forms estimates pixelwise and thus avoids assumptions on transverse spatial correlations that may hinder the ability to resolve very small features . using experimental single - photon data",
    ", we demonstrate that our proposed depth imaging framework outperforms log - matched filtering , which is the maximum - likelihood ( ml ) depth estimator given zero background light .",
    "because our proposed framework is photon - efficient while using an estimator that is pixelwise and without background calibration , it can be useful for dynamic low light - level imaging applications , such as environmental mapping using unmanned aerial vehicles .",
    "the conventional lidar technique of estimating depth using histograms of photon detections is accurate when the number of photon detections is high . in the low photon - count regime ,",
    "the depth solution is noisy due to shot noise .",
    "it has been shown that image denoising methods , such as wavelet thresholding , can boost the performance of scene depth recovery in the presence of background noise  @xcite .",
    "also , using an imaging model that incorporates occlusion constraints was proposed to recover an accurate depth map  @xcite . however , these denoising algorithms implicitly assume that the observations are gaussian distributed .",
    "thus , at low photon - counts , where depth estimates are highly non - gaussian  @xcite , their performance degrades significantly  @xcite .",
    "first - photon imaging ( fpi )  @xcite is a framework that allows high - accuracy imaging using only the first detected photon at every pixel .",
    "it demonstrated that centimeter - accurate depth recovery is possible by combining the non - gaussian statistics of first - photon detection with spatial correlations of natural scenes .",
    "the fpi framework uses an imaging setup that includes a raster - scanning light source and a lensless single - photon detector .",
    "more recently , photon - efficient imaging frameworks that use a detector array setup , in which every pixel has the same acquisition time , have also been proposed  @xcite .",
    "we observe two common limitations that exist in the prior active imaging frameworks for depth reconstruction .    * * over - smoothing : * many of the frameworks assume spatial smoothness of the scene to mitigate the effect of shot noise . in some imaging applications , however , it is important to capture fine spatial features that only occupy a few image pixels .",
    "using methods that assume spatial correlations may lead to erroneously over - smoothed images that wash out the scene s fine - scale features . in such scenarios , a robust _ pixelwise",
    "_ imager is preferable . * * calibration : * many imaging methods assume a calibration step to measure the amount of background flux existing in the environment",
    ". this calibration mitigates bias in the depth estimate caused by background - photon or dark - count detections , which have high temporal variance . in practical imaging scenarios",
    ", however , the background response varies in time , and continuous calibration may not be practical . furthermore , many methods assume background flux does not vary spatially .",
    "thus , a _ calibrationless _ imager that performs simultanous estimation of scene parameters and spatially - varying background flux from photon detections is useful .    in this letter , we propose a novel framework for depth acquisition that is applied pixelwise and without calibration . at each pixel , our imager estimates the background response along with scene depth from photon detections .",
    "similar to @xcite , we use a union - of - subspaces constraint for modeling the scene parameters .",
    "however , our union - of - subspace constraint is defined for both the incoherent signal and background waveform parameters that generate photon detections ; the constraint in @xcite is defined for only the coherent signal waveform that is perturbed by gaussian noise , not photon noise .    using the derived imaging model",
    ", we propose a greedy signal pursuit algorithm that accurately solves for the scene parameters at each pixel .",
    "we evaluate the photon efficiency of this framework using experimental single - photon data . in the presence of strong background light , we show that our pixelwise imager gives an absolute depth error that is @xmath0 times lower than that of the pixelwise log - matched filter .",
    "figure .  [ fig_setup ] illustrates our imaging setup , for one illumination pulse , in which photon detections are made .",
    "a focused optical source , such as a laser , illuminates a pixel of the scene with the pulse waveform @xmath1 that starts at time @xmath2 and has root - mean - square pulsewidth @xmath3 .",
    "this illumination is repeated every @xmath4 seconds for a sequence of @xmath5 pulses .",
    "the single - photon detector , in conjunction with a time correlator , is used to time stamp individual photon detections , relative to the time at which the immediately preceding pulse was transmitted .",
    "these detection times , which are observations of a time - inhomogeneous poisson process , whose rate function combines contributions from pixel return , background light , and dark counts , are used to estimate scene depth for the illuminated pixel .",
    "this pixelwise acquisition process is repeated for @xmath6 image pixels by raster scanning the light source in the transverse directions .",
    "in this section , we study the relationship between the photon detections and the scene parameters . for simplicity of exposition and notation ,",
    "we focus on one pixel ; this is repeated for each pixel of a raster - scanning or array - detection setup .",
    "let @xmath7 , @xmath8 , and @xmath9 be unknown scalar values that represent reflectivity , depth , and background flux at the given pixel .",
    "the reflectivity value includes the effects of radial fall - off , view angle , and material properties .",
    "then , after illuminating the scene pixel with a single pulse @xmath1 , the backreflected waveform that is incident at the single - photon detector is @xmath10      using ( [ eq_reflected ] ) , we observe that the rate function that generates the photon detections is @xmath11 where @xmath12 $ ] is the quantum efficiency of the detector and @xmath13 is the dark - count rate of the single - photon detector .",
    "let @xmath14 be the time bin duration of the single - photon detector .",
    "then , we define @xmath15 to be the total number of time bins that capture photon detections .",
    "let @xmath16 be the vector of size @xmath17 that contains the number of photon detections at each time bin after we illuminate the pixel @xmath5 times with pulse waveform @xmath1 .",
    "then , from photodetection theory  @xcite , we can derive @xmath18 \\",
    "dt \\right ) , \\label{eq_photon}\\end{aligned}\\ ] ] for @xmath19 .",
    "note that we have assumed that our total pixelwise acquisition time @xmath20 is short enough that @xmath9 is constant during that time .",
    "let @xmath21 for @xmath22 , where @xmath23 is a small number , such that @xmath4 is divisible by @xmath23 and @xmath24 . defining @xmath25 to be an @xmath26 vector of ones",
    ", we can approximate the rate function in ( [ eq_photon ] ) and rewrite the distribution as @xmath27 for @xmath28 . finally , defining @xmath29 $ ] and @xmath30^t$ ] , we can further rewrite ( [ obs_fin2 ] ) as @xmath31 so far ,",
    "we have simplified the pixelwise single - photon observation model , such that the photon - count vector @xmath32 is a linear measurement of scene response vector @xmath33 corrupted by poisson noise .      using the expression in ( [ approx_v ] ) , we observe that @xmath34 for @xmath35 , where @xmath36 is an indicator function that equals @xmath37 if @xmath38 and @xmath2 otherwise . in other words ,",
    "vector @xmath39 has exactly one nonzero element , and the value and index of the nonzero element represents the scene reflectivity and depth at an image pixel , respectively .",
    "we defined our @xmath40 signal @xmath41 to be a concatenation of @xmath39 , which is the scene response vector of size @xmath42 , and @xmath43 , which is the scalar representing background flux . since @xmath39 has exactly one nonzero entry , @xmath41 lies in the union of @xmath42 subspaces defined as @xmath44 where each subspace is of dimension @xmath45 .",
    "using accurate photodetection statistics and scene constraints , we have interpreted the problem of robust single - photon depth imaging as a noisy linear inverse problem , where the signal of interest @xmath41 lies in the union of subspaces @xmath46 . using ( [ obs_fin ] ) ,",
    "the observed photon count histogram @xmath16 has the probability mass function @xmath47 thus , neglecting terms in the negative log - likelihood function that are dependent on @xmath16 but not on @xmath41 , we can define the objective function @xmath48.\\end{aligned}\\ ] ] this objective can be proved to be convex in @xmath41 .",
    "we solve for @xmath41 by minimizing @xmath49 with the constraint that @xmath41 lies in the union of subspaces @xmath50 . also , because photon flux is a non - negative quantity , the minimization results in a more accurate estimate when we include a non - negative signal constraint . in summary ,",
    "the optimization problem that we want to solve can be written as @xmath51    to solve our constrained optimization problem , we propose an algorithm that is inspired by existing fast greedy algorithms for sparse signal pursuit .",
    "cosamp  @xcite is a greedy algorithm that finds a @xmath52-sparse approximate solution to a linear inverse problem .",
    "we modify the cosamp algorithm so that we obtain for a solution constrained to the union of subspaces @xmath50 , instead of a @xmath52-sparse one .",
    "* input : * @xmath16 , @xmath53 , @xmath54    * output : * @xmath55    initialize @xmath56 , @xmath57 , @xmath58 ; @xmath59 ; @xmath60 ; @xmath61 } )   \\cup \\text{supp}(\\mathbf{x}^{(k-1)}_{1:n } )   \\cup \\{n+1\\}$ ] ; @xmath62 ; @xmath63 ; @xmath64}^t , \\hspace{1 mm } \\mathbf{b}_{n+1}]^t \\right)$ ] @xmath65    [ algorithm1 ]    [ cols=\"^,^,^,^,^,^,^,^,^,^ \" , ]     our proposed greedy algorithm is given in algorithm  [ algorithm1 ] .",
    "we define @xmath66 to be the thresholding operator setting all negative entries of @xmath41 to zero , @xmath67 to be the set of indices of nonzero elements of @xmath41 , and @xmath68}$ ] to be the vector that approximates @xmath41 with its @xmath69 largest terms .",
    "also , we take @xmath70 to be a matrix with columns of @xmath53 chosen by the index set @xmath71 .",
    "finally , we use @xmath72 and @xmath73 to denote the transpose and pseudo - inverse of matrix @xmath53 , respectively .    to solve the constrained optimization problem in ( [ opt ] )",
    ", our algorithm iteratively performs the following steps :    1 .",
    "gradient descent on @xmath49 , which is approximated by the squared @xmath74-norm @xmath75 for computational efficiency ; 2 .",
    "projection of the intermediate estimate onto the closest subspace in the union of subspaces @xmath50 ; and 3 .   projection of the intermediate estimate onto the non - negative cone ,    until a convergence criterion is satisfied .",
    "we define convergence of the solution as @xmath76 , where @xmath54 is a small number .",
    "to validate our imaging framework , we used a dataset collected by d. venkatraman for the first - photon imaging project  @xcite ; this dataset and others are available from  @xcite .",
    "the experimental setup uses a pulsed laser diode with pulsewidth @xmath77 and repetition period @xmath78 .",
    "a two - axis galvo was used to scan @xmath79 pixels of a mannequin face at a distance of about @xmath80 .",
    "a lensless spad detector with quantum efficiency @xmath81 was used for detection .",
    "the background light level was set using an incandescent lamp .",
    "the original mannequin data from  @xcite had the background count rate approximately equal to the signal count rate .",
    "our experiment uses the cropped data showing only the mannequin s face , where the background count rate was approximately @xmath82 of the average signal count rate .",
    "although we used a raster - scanning setup for our single - photon imaging experiments , since our imaging algorithm is applied pixelwise , it can be also used for imaging with a floodlight illumination source and a single - photon detector array .",
    "we could compare our imaging method with the ml estimator of scene parameters .",
    "unfortunately , due to nonzero background flux , ml estimation of @xmath7 , @xmath9 , and @xmath8 requires minimizing a non - convex cost function , leading to a solution without an accuracy guarantee .",
    "thus , zero background is assumed conventionally such that the ml depth estimate reduces to the simple log - matched filter  @xcite : @xmath83 we use ( [ logmatch ] ) as the baseline depth estimator that is compared with our proposed estimator .",
    "figure  [ results1 ] shows the results of recovering depth of the mannequin face using single - photon observations .",
    "the kernel matrix @xmath84 was obtained by an offline measurement of the pulse shape .",
    "note that this measurement depends only on the source , not on properties of the scene .",
    "the ground - truth depth , shown in fig .",
    "[ results1](b ) , was generated separately by using background - calibrated ml estimation from @xmath85 photons at each pixel .    in our depth imaging experiment ,",
    "the number of photon detections at each pixel was set to @xmath86 .",
    "we observe that , due to extraneous background photon detections , the log - matched filter estimate in fig .",
    "[ results1](c ) ( @xmath87 ) is corrupted with high - variance noise and the facial features of the mannequin are not visible . on the other hand , our estimate , shown in fig .",
    "[ results1](d ) , shows high - accuracy depth recovery ( @xmath88 ) . as shown by the error maps in fig .",
    "[ results1](e ) , ( f ) , both methods fail in depth recovery in the face boundary regions , where very little light is reflected back from the scene to the single - photon detector and the signal - to - background ratio is thus very low .",
    "also , we observe that our estimated average background level over all pixels was @xmath89 , which is very close to the calibrated true background level @xmath90 . in this experiment , we had @xmath91 . also , we set @xmath92 and the average number of iterations until convergence was measured to be @xmath93 over all pixels .",
    "code and data used to generate results can be downloaded from @xcite .",
    "in this letter , we presented an imaging framework for calibrationless , pixelwise depth reconstruction using single - photon observations .",
    "our imaging model combined photon detection statistics with the discrete - time flux constraints expressed using a union - of - subspaces model .",
    "then , using our imaging model , we developed a greedy algorithm that recovers scene depth by solving a constrained optimization problem .",
    "our pixelwise imaging framework can be used in low light - level imaging applications , where the scene being imaged has fine features and filtering techniques that exploit patchwise smoothness can potentially wash out those details . for example , it can be useful in applications such as airborne remote sensing  @xcite , where the aim is to recover finely - featured 3d terrain maps .",
    "it is straightforward to generalize the proposed single - photon imaging framework to multiple - depth estimation , where more than one reflector may be present at each pixel . in the case of estimating depths of @xmath52 reflectors at a pixel , the @xmath37-sparsity assumption",
    "must be changed to more general @xmath52-sparsity assumption when defining the union - of - subspaces constraint .",
    "a.  mccarthy , r.  j. collins , n.  j. krichel , v.  fernndez , a.  m. wallace , and g.  s. buller , `` long - range time - of - flight scanning sensor based on high - speed time - correlated single - photon counting , '' _ appl .",
    "optics _ , vol .",
    "48 , no .",
    "32 , pp . 62416251 , 2009 .",
    "d.  shin , a.  kirmani , v.  k. goyal , and j.  h. shapiro , `` photon - efficient computational 3-d and reflectivity imaging with single - photon detectors , '' _ ieee trans .",
    "comput . imaging _ ,",
    "vol .  1 , 2015 , to appear ."
  ],
  "abstract_text": [
    "<S> light detection and ranging systems reconstruct scene depth from time - of - flight measurements . for low light - level depth imaging applications , such as remote sensing and robot vision , these systems use single - photon detectors that resolve individual photon arrivals . </S>",
    "<S> even so , they must detect a large number of photons to mitigate poisson shot noise and reject anomalous photon detections from background light . </S>",
    "<S> we introduce a novel framework for accurate depth imaging using a small number of detected photons in the presence of an unknown amount of background light that may vary spatially . </S>",
    "<S> it employs a poisson observation model for the photon detections plus a union - of - subspaces constraint on the discrete - time flux from the scene at any single pixel . </S>",
    "<S> together , they enable a greedy signal - pursuit algorithm to rapidly and simultaneously converge on accurate estimates of scene depth and background flux , without any assumptions on spatial correlations of the depth or background flux . using experimental single - photon data </S>",
    "<S> , we demonstrate that our proposed framework recovers depth features with 1.7 cm absolute error , using 15 photons per image pixel and an illumination pulse with 6.7-cm scaled root - mean - square length . </S>",
    "<S> we also show that our framework outperforms the conventional pixelwise log - matched filtering , which is a computationally - efficient approximation to the maximum - likelihood solution , by a factor of 6.1 in absolute depth error .    </S>",
    "<S> computational imaging , lidar , single - photon imaging , union - of - subspaces , greedy algorithms . </S>"
  ]
}