{
  "article_text": [
    "particle - laden flows are frequently encountered in engineering applications such as coastal sediment transport , gas - solid fluidization , and aerosol deposition .",
    "numerical simulations of these systems can improve the physical understanding of these flows . with the development of available computational resources , the cfd ",
    "dem approach becomes an increasingly promising approach for particle - laden flows . in cfd ",
    "dem , dem approach tracks the motion of lagrangian particles based on newton s second law ; cfd solves the motion of fluid flow based on locally - averaged navier ",
    "stokes equations  @xcite .",
    "dem solvers include commercial solvers , research codes , and open - source solvers . these solvers solve similar equations for fluid flow and particle motion , and use similar submodels ( i.e. , drag force model and particle collision model ) .",
    "commercial solvers , such as fluent edem and the cfd ",
    "dem packages in star - ccm+ and avl - fire  @xcite , are general - purposed solvers without emphasis on sediment transport",
    ". in - house research codes  @xcite can also be applied to cfd  dem simulations , but the accessibility of these solvers is limited . on the other hand ,",
    "open - source solvers  @xcite provide the user with good versatility in the development of the numerical model .",
    "the efforts in the development of cfd  dem solver focus on gas - solid flows .",
    "however , several unique features in sediment transport should be accounted for .",
    "first , for subaqueous sediment transport , the lubrication and the added mass force on the particle are much larger than gas - solid flows",
    ". the influences of them should be accounted for in cfd ",
    ". moreover , sediment transport occurs at the boundary layer . to resolve the fluid flow ,",
    "the size of cfd mesh can be smaller than sediment particle .",
    "therefore , a robust algorithm is required when converting the properties of discrete particles to the eulerian cfd mesh .",
    "finally , the parallel efficiency of the code is important since the number of sediment particles can be as large as @xmath1 in the simulation of laboratory - scale problems . because these unique features of sediment transport are ignored in previous numerical simulations  @xcite , a robust open - source solver is still desirable for the study of sediment transport . in this work , a three - dimensional , massively parallel , and open - source cfd ",
    "dem solver _ sedifoam _ with emphasis on sediment transport is presented .",
    "the originality of _ sedifoam _ includes : ( a ) the lubrication and the added mass force on the particle ; ( b ) the averaging algorithm to map the properties of lagrangian particles to eulerian mesh  @xcite ; ( c ) the parallel algorithm and the performance test .",
    "the potential advantage of _ sedifoam _ include the ability to simulate polydispersed particle mixtures , and the flexibility of applying turbulence models because of the robustness of openfoam , among others  @xcite .",
    "the present solver is developed based on two state - of - the - art open - source solvers , i.e. , cfd solver openfoam ( open field operation and manipulation ) , and molecular dynamics simulator lammps ( large - scale atomic / molecular massively parallel simulator ) .",
    "the two solvers are selected because they are both open - source , parallelized , highly modular and well established  @xcite .",
    "the rest of this paper is organized as follows .",
    "the methodology of the present code is introduced in section  [ sec : cfddem ] , including the mathematical formulation of fluid equations , particle motion equations , and fluid  particle interactions .",
    "section  [ sec : implementation ] describes the implementations , including the communication and the parallelization of the code .",
    "the numerical validations of the code for various sediment transport problems are performed in section  [ sec : simulations ] .",
    "the parallel efficiency of the present solver is detailed in section  [ sec : parallel - eff ] .",
    "finally , section  [ sec : conclude ] concludes the paper .",
    "in the cfd ",
    "dem approach , the translational and rotational motion of each particle is calculated based on newton s second law as the following equations  @xcite :    [ eq : newton ] @xmath2    where @xmath3 is the velocity of the particle ; @xmath4 is time ; @xmath5 is particle mass ; @xmath6 represents the contact forces due to particle  particle or particle  wall collisions ; @xmath7 is the lubrication force due to the fluid squeezed out from the gaps between two particles ; @xmath8 denotes fluid  particle interaction forces ( e.g. , drag , lift force , added mass force , and buoyancy ) ; @xmath9 denotes body force .",
    "similarly , @xmath10 and @xmath11 are angular moment of inertia and angular velocity , respectively , of the particle ; @xmath12 , @xmath13 and @xmath14 are the torques due to contact forces , lubrication , and fluid  particle interactions , respectively . to compute the collision forces and torques , the particles",
    "are modeled as soft spheres with inter - particle contact represented by an elastic spring and a viscous dashpot .",
    "further details can be found in  @xcite .",
    "the fluid phase is described by the locally - averaged incompressible navier  stokes equations .",
    "assuming constant fluid density @xmath15 , the governing equations for the fluid are  @xcite :    [ eq : ns ] @xmath16    where @xmath17 is the solid volume fraction ; @xmath18 is the fluid volume fraction ; @xmath19 is the fluid velocity .",
    "the terms on the right hand side of the momentum equation are : pressure ( @xmath20 ) gradient , divergence of the stress tensor @xmath21 , gravity , and fluid  particle interactions forces , respectively .",
    "large eddy simulation is performed in the present work , the stress tensor is composed of both viscous and reynolds stresses @xmath22 , where @xmath23 is the dynamic viscosity of the fluid flow ; @xmath24 is the reynolds stress .",
    "the expression of the reynolds stress is : @xmath25 where @xmath26 is the dynamics eddy viscosity ; @xmath27 ; @xmath28 is the turbulent kinetic energy .",
    "it is noted that in the stress tensor @xmath21 term , the fluctuations of the fluid flow at the boundary of the particle are not resolved .",
    "the eulerian fields @xmath17 , @xmath29 , and @xmath30 in eq .",
    "( [ eq : ns ] ) are obtained by averaging the information of lagrangian particles .",
    "however , the fluid variables are not averaged before sending to the particle , which is because the averaged fluid variables might be too diffusive for calculation .",
    "it is noted that the coupling of the fluid and solid phases is similar with scheme 3 according to the literature  @xcite . at each time step , the fluid - particle interaction forces on individual particles are calculated first in the cfd cell , and the values are then summed to produce the interaction force at the cell scale .",
    "detailed information of the coupling between the solvers can be found in section  [ sec : implementation ] .",
    "the fluid - particle interaction force @xmath30 consists of buoyancy @xmath31 , drag @xmath32 , lift force @xmath33 , and added mass force @xmath34 .",
    "although the lift force and the added mass force are usually ignored in fluidized bed simulation , they are important in the simulation of sediment transport .    the drag on an individual particle @xmath35 is formulated as : @xmath36 where @xmath37 and @xmath38 are the volume and the velocity of particle @xmath35 , respectively ; @xmath39 is the fluid velocity interpolated to the center of particle @xmath35 ; @xmath40 is the drag correlation coefficient which accounts for the presence of other particles . the @xmath41 value for the drag force is based on  @xcite : @xmath42 where the particle reynolds number re is defined as : @xmath43 the @xmath44 is the correlation term : @xmath45 with @xmath46 note that other drag force models are also implemented in  _ sedifoam _ with correlations for @xmath47 in dense particle - laden flows  @xcite . in addition to drag , the lift force on a spherical particle is modeled in _",
    "sedifoam _ as  @xcite : @xmath48 where @xmath49 indicates the cross product of two vectors , and @xmath50 is the lift coefficient . the added mass force is considered in _ sedifoam _ due to the comparable densities of the carrier and disperse phases in sediment transport applications .",
    "this is modeled as : @xmath51 where @xmath52 is the coefficient of added mass . the lagrangian particle acceleration term @xmath53 utilizes the particle velocity at the previous time ;",
    "the material derivative of fluid phase velocity @xmath54 can be obtained in openfoam at each time step .",
    "the lift force and added mass models used in the present work is only applicable for particle - laden flows in small reynolds number and low volume fraction regime .",
    "the study of  @xcite has indicated the accuracy of such modeling scheme is acceptable for sediment transport applications .      according to eq .",
    "( [ eq : ns ] ) , the continuum eulerian fields of @xmath55 , @xmath56 , and @xmath57 are obtained by averaging from discrete particle data . in the present solver , the averaging algorithm previously proposed by the authors  @xcite is implemented .    taking the averaging process of @xmath17 as an example .",
    "in the first step , the particle volumes at each cfd cell are obtained .",
    "then , the solid volume fraction for cell @xmath28 is calculated by dividing the total particle volume by the volume of this cell @xmath58 .",
    "that is : @xmath59 where @xmath60 is the number of particles in cell @xmath28 . with the initial condition in eq .",
    "( [ eq : pcm - k ] ) , a transient diffusion equation for @xmath61 is solved to obtain the continuum eulerian field of @xmath17 : @xmath62 where @xmath63 is the laplacian operator ; @xmath64 is pseudo - time .",
    "it has been established in  @xcite that the results obtained by eq .",
    "( [ eq : diffusion - c ] ) is equivalent with gaussian kernel based averaging with bandwidth @xmath65 .",
    "similarly , the smoothed @xmath29 and @xmath30 fields can be obtained by using this approach .",
    "we note that a similar averaging procedure has been proposed earlier by  @xcite , where a mollification procedure with gaussian kernel is followed by solving a diffusion equation of the obtained volume fraction .",
    "both methods are conservative and mesh - independent , and are theoretically equivalent .",
    "the novelty of  @xcite lies in the following aspects .",
    "first , they established the theoretical equivalence between the diffusion based averaging procedure and the gaussian kernel averaging commonly used in statistical mechanics  @xcite .",
    "based on this insight , they provided a clear physical interpretation of the normalized diffusion time , rendering it a physical parameter related to the wake of the particles .",
    "second , the wall boundaries are treated in  @xcite with a straightforward , efficient no - flux boundary condition , and the conservativeness has been proved analytically .",
    "in contrast ,  @xcite ensured the conservativeness of the averaging procedure at wall boundaries by using ghost particles .",
    "finally , the coarse - graining procedure of  @xcite is implemented based on the open - source , general - purpose , three - dimensional , massively parallel cfd solver with a generic unstructured body - fitting mesh , while  @xcite used an in - house cfd solver based on a cartesian mesh with an immersed boundary method .",
    "more details of the averaging algorithm can be found in  @xcite .",
    "the solution of the particle motions including their interactions via collisions and endured contacts are handled by lammps .",
    "the fluid forces @xmath66 on the particles are computed in openfoam , supplied into lammps , and used in the integration of particle motion equations  ( [ eq : newton ] ) .",
    "the particle forces in the fluid equations are computed in openfoam according to the forces on individual particles via the averaging procedure .",
    "the fluid equations in  ( [ eq : ns ] ) are solved by openfoam using the finite volume method @xcite .",
    "the discretization is based on a collocated grid , i.e. , pressure and all velocity components are stored in cell centers .",
    "piso ( pressure implicit splitting operation ) algorithm is used for velocity  pressure decoupling  @xcite .",
    "second - order central schemes are used for the spatial discretization of convection terms and diffusion terms .",
    "time integrations are performed using a second - order implicit scheme .",
    "the averaging method involves solving transient diffusion equations based on the openfoam platform .",
    "the diffusion equations are also solved on the cfd mesh .",
    "a second - order central scheme is used for the spatial discretization of the diffusion equation ; a second - order implicit scheme is used for the temporal integration .     to solve the equation of motion of the particles in ( [ eq : newton ] ) , the nearest particles of each particle are tracked . to find the nearest particles , lammps uses a combination of neighbor lists and link - cell binning  @xcite and the scale of the computation is only @xmath67  @xcite . the collision force is computed with a linear spring - dashpot model , in which the normal elastic contact force between two particles is linearly proportional to the overlapping distance  @xcite .",
    "the lubrication model is based on  @xcite , in which the force is proportional to the relative velocity and inversely proportional to the relative distance .",
    "the torque on the particles due to the lubrication and collision are integrated to calculate the particle rotation , but the interaction of the particle rotation and fluid is not considered .",
    "finally , the time step to resolve the particle collision is 1/50 the contact time to avoid particle inter - penetration  @xcite .",
    "_ sedifoam _ was originally developed by the second author and his co - workers to study particle segregation dynamics  @xcite . to improved the solver , we enhanced its parallel computing capabilities and implemented the averaging algorithm for sediment transport .",
    "the source code of _ sedifoam _ is available at https://github.com/iurnus/sedifoam.git .",
    "the diagram of the code is shown in fig .",
    "[ fig : block - diagram ] .",
    "it can be seen in the figure that the fluid and particle equations are solved individually by the cfd and dem module at each time step .",
    "the averaging procedure is performed in the cfd module before solving the fluid equations .",
    "in addition to solving the equations , the information of the sediment particles is updated before cfd module starts the averaging procedure ; the fluid - particle interaction force of each particle is updated the before dem module evolves the motion of the particles .",
    "these procedures before solving the fluid and particle equations are the coupling between cfd and dem modules .    in the parallelization of _ sedifoam _ , which is essential for simulating large granular systems ,",
    "the equations are solved in parallel by the dem and cfd modules .",
    "therefore , the parallelization of _ sedifoam _ concerns with the coupling of the modules between multiple processors .",
    "when using multiple processors to accelerate the simulation , both modules decompose the computational domain into @xmath68 subdomains . in the coupling procedure ,",
    "the particle information obtained in each module is transfered to the other module .",
    "if the subdomains of individual processors in each module were perfectly consistent , the information of every particle would be local to each processor for both cfd and dem modules .",
    "in this situation , inter - processor communication is unnecessary in the coupling .",
    "however , the subdomains in most numerical simulations are inconsistent ( see fig .  [",
    "fig : domain - overlap ] ) .",
    "this is due to the consideration of parallel efficiency when decomposing the domain .",
    "in this situation , the information of some particles obtained in cfd and dem module are not stored in the same processor .",
    "hence , inter - processor communication is required for these non - local particles .",
    "an example is used to describe the parallelization of the coupling procedure in _ sedifoam_. the geometry of this example employing three processors is shown in fig .",
    "[ fig : domain - transpose - layout ] .",
    "the parallelization in the present solver is performed as follows :    1 .",
    "the dem module of _ sedifoam _ evolved the particles one step forward , shown in fig .",
    "[ fig : domain - transpose](a ) .",
    "the non - local particles are found in the dem module , shown in fig .",
    "[ fig : domain - transpose](b ) .",
    "this is the preparation step before transferring non - local data .",
    "3 .   in each processor",
    ", the information of non - local particles is transfered to other processors .",
    "this step is illustrated in fig .",
    "[ fig : domain - transpose](c ) .",
    "the particle information obtained in the dem module is now local to the cfd module , shown in fig .",
    "[ fig : domain - transpose](d ) .",
    "the information of the particles in the cfd module is updated and can be used in the next cfd step .",
    "after step 4 , the inter - processor communication is finished .",
    "the non - local data obtained by the dem module is transferred to update the information of sediment particles in the cfd module . following this approach ,",
    "the non - local information obtained in the cfd module can also be transferred to the particles in the dem module .",
    "extensive validation tests of _ sedifoam _ have been performed previously for fluidized bed simulations  @xcite . in the present work ,",
    "three numerical tests are presented to demonstrate the capability of _ sedifoam _ in the simulation of sediment transport .",
    "the sedimentation of a single particle in water is detailed in section  [ sec : pw - bounce ] , which aims to validate the implementation of lubrication and added mass .",
    "the motion of 500 particles on fixed sediment bed is discussed in section  [ sec : moderate - sediment ] .",
    "the purpose of this case is to validate the properties of the fluid and sediment particles obtained by using _",
    "sedifoam_. simulations of relatively large number of particles ( @xmath69 ) are detailed in section  [ sec : large - sediment ] .",
    "the objective of this test is to demonstrate the capability of the present solver in the simulation of large and complex cases .",
    "most numerical simulations using cfd  dem are performed to study gas  solid flows .",
    "however , the behavior of a sediment particle in liquid is different with that in gaseous flow .",
    "this is because liquid has higher density and dynamic viscosity than gas .",
    "as such , lubrication and virtual mass force of the same particle in liquid ",
    "solid flows are approximately @xmath70 times larger than those in gas  solid flows , and can be comparable to the weight of the sediment particle . therefore , the influences of lubrication and virtual mass ( usually negligible in gas  solid flows ) can be critical in the simulation of subaqueous sediment transport . to test the implementation of the two forces in _ sedifoam",
    "_ , a series of simulations of particle  wall collision are performed based on the experiments of  @xcite .    the geometry of the domain in the particle ",
    "wall collision test is shown in figure  [ fig : layout - lub ] along with the coordinate system .",
    "the parameters used in this case are detailed in table  [ tab : param - all ] .",
    "periodic boundary condition is applied at the boundaries in both @xmath71- and @xmath72-directions . in the simulation ,",
    "the fluid is quiescent initially and the particle falls in the vertical direction due to the gravity force .",
    "the initial particle ",
    "wall distance is large enough so that the particle accelerates to the terminal velocity before the collision occurs .    to test the influence of lubrication and",
    "added mass , the locations of the particle obtained in the collision test are compared with the experimental results .",
    "the comparison is performed at two different stokes numbers , which is defined as : @xmath73 in fig .",
    "[ fig : lub - collision ] , the locations of the center of the sphere are plotted as a function of time . it can be seen that the results obtained in the simulation that considered both lubrication and added mass are consistent with the experimental measurements . theoretically , added mass force adds to the inertia of the particle , which leads to larger rebound height regardless of the stokes number . on the other hand ,",
    "the lubrication depends on the viscous effect and decreases with stokes number . at @xmath74 ,",
    "the viscous effect is large by definition .",
    "consequently , the locations of the particle predicted without lubrication are significantly different from the experimental data . at @xmath75 ,",
    "the viscous effects is small , so accounting for lubrication at large stokes number does not significantly influence the predictions of the particle motions .    the prediction of the effective restitution coefficient using _ sedifoam _ in particle  wall bouncing test is shown in fig .",
    "[ fig : lub - restitution ] .",
    "the effective restitution coefficient is defined as @xmath76 , where @xmath77 and @xmath78 are the restitution coefficients for the same collision occurs in water and air , respectively .",
    "the amount of decrease of @xmath79 from 1 denotes the influence of lubrication and added mass in the collision .",
    "it can be seen in fig .",
    "[ fig : lub - restitution ] that the predictions from _ sedifoam _ agree favorably with the experimental data when the influence of lubrication and added mass is considered .",
    "in contrast , the predictions without accounting for these forces deviate significantly from experimental measurements by over - predicting the effective restitution coefficients , particularly at small stokes number . accordingly ,",
    "if sediment transport occurs at relatively low stokes number  @xcite , the influence of lubrication and added mass should be considered in cfd ",
    "dem modeling of sediment transport .",
    "note that the calculation of lubrication incurs significant increase in computational costs .",
    "consequently , lubrication are accounted for by using a smaller dry restitution coefficient in the literature  @xcite .    in summary ,",
    "the influence of added mass and lubrication is important in the cfd ",
    "dem modeling of sediment transport .",
    "additionally , the test cases validate the implementation of the added mass force and lubrication force in _",
    "sedifoam_.      in this case , sediment transport at the boundary layer in the channel is studied .",
    "the results obtained by using _",
    "sedifoam _ are compared with the numerical benchmark to illustrate the capability of the present solver .",
    "the averaging algorithm proposed by  @xcite is applied to obtain the continuum eulerian quantities from discrete particles .",
    "this algorithm enables cfd  dem simulation at the boundary layer where the size of cfd cells is smaller than particles .",
    "the numerical setup is based on the numerical benchmark studying the motion of 500 movable particles  @xcite .",
    "the geometry of the simulation is shown in figure  [ fig : layout - st ] .",
    "the dimensions of the domain , the mesh resolutions , and the fluid and particle properties used are detailed in table  [ tab : param - all ] . the cfd mesh in the vertical ( @xmath80- ) direction",
    "is progressively refined towards the bottom boundary .",
    "periodic boundary condition is applied in both @xmath71- and @xmath72-directions , no - slip wall condition is applied at the bottom in @xmath80-direction , and slip wall condition is applied on the top in @xmath80-direction .",
    "the bulk reynolds number @xmath81 of the flow in the channel is 3010 .",
    "six layers of fixed particles are arranged hexagonally to provide a bottom boundary condition to the moving particles , as is shown in fig .",
    "[ fig : layout - st ] . in the coordinate system ,",
    "the top of the fixed particle bed is at @xmath82 . to obtain the profiles of fluid velocity and reynolds stresses ,",
    "the simulations are averaged for 50 flow - through times , and spatial average is performed in the horizontal domain .",
    "the bandwidth @xmath83 used in the averaging procedure is @xmath84 in width and thickness directions and @xmath85 in vertical direction .",
    "the flow properties are presented in fig .",
    "[ fig : kempe - flow - all ] , including the streamwise velocity and reynolds stresses @xmath86 , @xmath87 , and @xmath88 . fig .",
    "[ fig : kempe - flow - all](a ) shows that _ sedifoam _ is able to capture the decrease of the fluid velocity in the near - wall boundary layer and within the bed , which is due to the drag force of the sediment particles .",
    "the velocity profile near the particle bed at @xmath82 is negative because of the diffusion effect of the averaging algorithm .",
    "therefore , the diffusion bandwidth in the vertical direction is taken as small as @xmath85 to reduce the effect of the numerical diffusion .",
    "it can be seen from fig .",
    "[ fig : kempe - flow - all](b ) to fig .",
    "[ fig : kempe - flow - all](d ) that the predictions of different components of reynolds stresses from the present solver agree well with the numerical benchmark . compared with the flow that has no particles in the channel , _ sedifoam _",
    "captures the increase of the reynolds stresses induced by the motion and collision of particles .",
    "it can be seen that the overall agreement of results obtained by using _",
    "sedifoam _ and dns is good for @xmath86 and @xmath88 .",
    "the discrepancy in @xmath88 is slightly larger than other components , which may be attributed to the fact that cfd ",
    "dem do not resolve the flow fluctuation at the particle surface and can not capture this quantity as good as the dns .",
    "other quantities of interest in sediment transport include solid volume fraction and particle velocity .",
    "figure  [ fig : kempe - sedi - all ] demonstrates the time - averaged probability density function ( pdf ) and streamwise velocity of the particles at different vertical locations .",
    "it can be seen that both the probability density function and streamwise velocity agree well with the results in the numerical benchmark  @xcite . in the present simulation , the averaged streamwise velocity of all particles",
    "@xmath89 is 0.28 .",
    "compared with the prediction 0.35 from the numerical benchmark , the error is 20% . however , this error is insignificant since @xmath90 is proportional to the sediment transport rate , which varies significantly in the experimental measurements .",
    "therefore , the accuracy of cfd  dem modeling is acceptable .",
    "it is noteworthy considering the fact that the total computational costs of cfd  dem are much smaller than the interface - resolved method . for this case ,",
    "the number of cfd mesh in the present simulation is @xmath91 , whereas this number in the dns simulation is @xmath92 .",
    "the purpose of this simulation is to test the performance of the present code in the simulation of larger problems of sediment transport .",
    "the results of both bed load sediment transport and suspended sediment transport are demonstrated .",
    "the layout of this case is similar to case 2 .",
    "the domain geometry , the mesh resolution , and the properties of fluid and particles are detailed in table  [ tab : param - all ] .",
    "periodic boundary condition is applied in both @xmath71- and @xmath72-directions .",
    "slip wall condition is applied at the top of the domain , and no - slip wall condition is applied at the bottom .",
    "three layers of solid particles are fixed at the bottom to provide rough wall boundary condition for dem simulation .",
    "the flow velocities in five numerical simulations range from @xmath93  m / s to @xmath94  m / s .",
    "each simulation is performed for 50 flow - through times for time - averaging .",
    "the bandwidth @xmath83 used in the averaging procedure is @xmath95 in width and thickness directions and @xmath84 in vertical direction .",
    "the geometry of this case is identical to the numerical tests using the same number of particles by  @xcite .",
    "the averaged properties of sediment particles are presented in fig .",
    "[ fig : sedi2-rate ] , including the sediment transport rate and the friction coefficient .",
    "the sediment transport rate @xmath96 is obtained by multiplying the mean streamwise velocity of all particles by the total volume of the particles , and divide it by the area of the horizontal plane .",
    "the non - dimensional sediment fluxes @xmath97 at different shields parameters @xmath98 are shown in fig .",
    "[ fig : sedi2-rate](b ) .",
    "it can be seen in the figure that the sediment transport rates agree favorably with the experimental data .",
    "note that the @xmath99 in different regimes ( i.e. , bed load and suspended load ) used different regression curves .",
    "it is worth mentioning that the predictions of @xmath99 in suspended load regime using _ sedifoam _ are better than the results obtained in the literature  @xcite .",
    "this is because the drag force model in the present simulations can better predict the motion of sediment particles since the influence of @xmath17 is accounted for .",
    "the coefficient of friction of the surface is defined as @xmath100 and describes the roughness of the bed . shown in fig .",
    "[ fig : sedi2-rate](c ) , @xmath101 obtained in the present simulation are larger than the predictions by the law of the wall ( i.e. , nikuradse value ) .",
    "this increase in @xmath101 is because the hydraulic roughness over a loose bed is larger in the presence of movable particles .",
    "note that the @xmath101 predicted by _",
    "sedifoam _ is slightly smaller than the results predicted by  @xcite .",
    "this is because @xcite ignored the volume fraction in the numerical simulation and used a smaller @xmath102 when calculating @xmath101 .",
    "the spatially and temporally averaged profiles of solid volume fraction and flow velocity are shown in fig .",
    "[ fig : sedi2-fluid ] .",
    "it can be seen from fig .",
    "[ fig : sedi2-fluid](a ) that the @xmath17 above @xmath103 is approximately zero in the bed load regime .",
    "this is because the sediment particles are rolling and sliding on the sediment bed in this regime . in the suspended load regime ,",
    "the particles are suspended in the flow due to turbulent eddies .",
    "therefore , the @xmath17 above @xmath103 is much larger .",
    "the flow velocity profiles also vary at different regimes of sediment transport . in the bed load regime ,",
    "the height of the sediment bed is approximately @xmath104 .",
    "the sediment particles on the sediment bed are moving slowly in this regime .",
    "hence , the streamwise flow velocity decays rapidly under the sediment bed . in the suspended load regime ,",
    "the flow velocity at the sediment bed is more diffusive since the particles at the sediment bed are moving more rapidly . compared with the data obtained in the literature  @xcite ,",
    "the overall agreement of solid volume fraction and flow velocity is satisfactory .",
    "the parallel efficiency is crucial to cfd ",
    "dem solvers for simulations of large and complex problems . in section  [ sec",
    ": parallel - fb ] and  [ sec : parallel - st ] , the parallel efficiencies in the simulations of fluidized bed and sediment transport are studied separately .",
    "this is because the setup , the flow regime , and the behavior of particles are different between the two cases .",
    "the cpu time spent on different parts of _ sedifoam _ is detailed in section  [ sec : parallel - comp ] .",
    "both strong and weak scalability are studied in the parallel efficiency tests .",
    "the strong scalability is to evaluate the performance of a solver for a constant sized problem being separated by using more and more processors .",
    "the amount of the total work is constant but the amount of communication work increases .",
    "the parallel efficiency of the strong scalability test is @xmath105 , where @xmath106 and @xmath107 are the number of processors employed in the simulation of the baseline case and the test case , respectively ; @xmath108 and @xmath109 are the cpu time .",
    "the speed - up is defined as @xmath110 , which is the relative improvement of the cpu time when solving the problem .",
    "the weak scalability evaluates the performance of a solver for the problem with increasing number of processors . in the weak scalability test",
    ", the amount of the work in different processors is the same .",
    "the parallel efficiency of the weak scalability test is @xmath110 .",
    "the scale - up is defined as @xmath111 , which is the improvement in the scale of the problem that _ sedifoam _ can solve .      the validation case of fluidized bed  @xcite is applied to test the parallel efficiency of _",
    "pcm - based averaging , which requires little computational cost , is applied to reduce the influence of averaging algorithm . in the simulation of fluidized bed ,",
    "various numbers of processors are used from 4 to 256 .",
    "the computational hours are calculated by running 100 time steps in each case .    to test the strong scalability of the code for large - scale simulations ,",
    "the numerical test is performed using 5.3 million sediment particles and 1.3 million cfd cells .",
    "the domain is @xmath112  mm @xmath113  mm @xmath114  mm in width ( @xmath71- ) , height ( @xmath80- ) , and transverse thickness ( @xmath72- ) directions .",
    "the results obtained in the strong scalability test are shown in fig .",
    "[ fig : paraefficiency - fb](a ) .",
    "it can be seen that the parallel efficiency of _ sedifoam _ is close to 100% when employing less than 32 processors and is still as high as 85% when using 128 processors .",
    "however , the parallel efficiency decreases to 52% when using 256 processors . in the test",
    "using 256 processors , the number of sediment particles in each processor is as small as 20,000 . from the results reported in the literature ,",
    "the parallel efficiency of _ sedifoam _ is approximately 15% higher than other solvers when using this number of particles  @xcite .",
    "it is noted in fig .",
    "[ fig : paraefficiency - fb](a ) that the parallel efficiency fluctuates when using 4 to 32 processors .",
    "this may attributes to the fluctuation of the cpu time when solving the linear system . when using different numbers of processors , the decomposition of the domain leads to different linear systems and different converge rates when solving these linear systems",
    ". this fluctuation may also be due to the variation of cpu cache or memory .",
    "the fluctuation of the cpu time can also be seen in the speed - up curve , but the magnitude is small .    to test the weak scalability of _ sedifoam _ , @xmath115 particles are located in each processor with the dimensions of @xmath116  mm @xmath113  mm @xmath117  mm in width ( @xmath71- ) , height ( @xmath80- ) , and transverse thickness ( @xmath72- ) directions .",
    "the numbers of processors vary from 4 to 256 , and thus the total numbers of particles vary from 0.3 million to 21 million . it can be seen in fig .",
    "[ fig : paraefficiency - fb](b ) that good weak scalability is observed .",
    "the parallel efficiency is close to 100% when using less than 32 processors and gradually decreases to 61% when using 256 processors .",
    "therefore , the ultimate scale - up of the code by using 256 processors is as large as 156 .",
    "simulations of sediment transport cases are performed to test the parallel efficiency of _ sedifoam _ when the number of cfd mesh is larger than the number of particles .",
    "the diffusion - based averaging algorithm is applied in the simulations .",
    "the numbers of processors used vary from 8 to 512 .    to test the strong scalability of the code for large - scale simulations , we expanded the domain in case 3 to be @xmath118  mm @xmath119  mm @xmath120  mm in width ( @xmath71- ) , height ( @xmath80- ) , and transverse thickness ( @xmath72- ) directions .",
    "the numbers of sediment particles and cfd cells are 10 million and 13 million , respectively .",
    "it can be seen in fig .",
    "[ fig : paraefficiency - st](a ) that good scalability and parallel efficiency are obtained in this test .",
    "the parallel efficiency is close to 100% when using less than 64 processors and decreases to 52% when using 512 processors .    to test the weak scalability for sediment transport , @xmath121 particles",
    "are located in each processor with the dimension of @xmath122  mm @xmath119  mm @xmath123  mm in width ( @xmath71- ) , height ( @xmath80- ) , and transverse thickness ( @xmath72- ) directions .",
    "the total numbers of particles vary from 0.6 million to 40 million . the parallel efficiency and the scale - up of _ sedifoam _",
    "are shown in fig .",
    "[ fig : paraefficiency - fb](b ) . compared with the results obtained in the fluidized bed test ,",
    "the parallel efficiency in sediment transport test is lower .",
    "this is because solving the fluid equations is difficult in parallel when the number of cfd cells is very large .    in summary , although the parallel efficiency of _ sedifoam _ in the sediment transport cases is smaller than the fluidized bed cases , the general efficiency is still satisfactory compared to other cfd  dem solvers  @xcite .",
    "moreover , simulations of @xmath0 number of particles are performed , which demonstrates the capability of _ sedifoam _ in the simulation of relatively large scale problems .",
    "the investigation of the computational costs of different components in _ sedifoam _ is detailed in this section .",
    "the study consists of both simulations of fluidized bed and sediment transport , using the results obtained in the tests of section  [ sec : parallel - fb ] and  [ sec : parallel - st ] .",
    "the time spent on the cfd module , the dem module , the coupling between the two modules , and the averaging algorithm are discussed .",
    "the results obtained in the fluidized bed simulation are shown in table .  [",
    "tab : weight - fb ] .",
    "it can be seen in the table that the most time - consuming process is solving the collision between the particles , which accounts for 46% to 76% of the total costs . solving the fluid equations",
    "is the second most time - consuming process , which takes 21% to 31% of the total computational costs for both strong scaling and weak scaling .",
    "it is noted that the coupling process takes less than 2% of the total costs when using less than 64 processors .",
    "however , the proportion of this part increases significantly to about 20% when using 256 processors .",
    "this is because the time spent on the inter - processor communication increases due to the increase number of processors used in the simulation .",
    "this increase can also be seen in the weak scaling test for both the cfd and dem modules , which are well - established solvers with good parallel efficiency .",
    "the computational costs of different components in the sediment transport simulation are detailed in table .",
    "[ tab : weight - st ] . since the number of cfd cells is larger than the number of sediment particles , the computational costs of the cfd module are larger than the dem module .",
    "it can be seen that the proportion of cfd part is approximately 21% to 48% the total computational costs for both strong scaling and weak scaling tests .",
    "the dem part accounts for about 17% to 37% of the total costs .",
    "it is noted that the computational overhead of the averaging also accounts for 20% to 33% of the total computational overhead .",
    "the time spent on the coupling is less than 2% of the total time when using less than 128 processors .",
    "however , when using as many as 512 processors the time spend on the communication increases significantly .",
    "in this work , the parallelized open - source cfd  dem solver _ sedifoam _ is developed with emphasis on the simulation of sediment transport .",
    "the cfd and dem modules are based on openfoam and lammps , respectively .",
    "the communication between the modules is implemented using parallel algorithm to enable the simulation of large - scale problems .",
    "numerical validations are performed to test the capability of the present solver .",
    "the single particle sedimentation test demonstrates the importance of added mass and lubrication in cfd  dem simulations . in the numerical simulations of with 500 sediment particles , the fluid and particle properties obtained are consistent with the results obtained by interface - resolved method",
    "this indicates the accuracy of _ sedifoam _ is desirable .",
    "the numerical simulation using @xmath69 particles demonstrates the capability of _ sedifoam _ in the simulation of various regimes in sediment transport .",
    "parallel efficiency tests are conducted to investigate the scalability of _",
    "sedifoam_. from the test , the scalability of _ sedifoam _ is satisfactory compared with other existing cfd  dem solvers .",
    "this demonstrates that _ sedifoam _ is a desirable solver for the simulation of sediment transport of large - scale and complex problems .",
    "the computational resources used for this project are provided by the advanced research computing ( arc ) of virginia tech , which is gratefully acknowledged .",
    "we also thank dr .",
    "jin sun at university of edingburgh , who helped improve the quality of the manuscript through technical discussions .",
    "moreover , we thank dr .",
    "calantoni for the discussions , which helped with the numerical simulations in the present paper .",
    "the authors gratefully acknowledge partial funding of graduate research assistantship from the institute for critical technology and applied science ( ictas , grant number 175258 ) in this effort .",
    "ball , r.  c. , melrose , j.  r. , 1997 . a simulation technique for many spheres in quasi - static motion under frame - invariant pair drag and brownian forces .",
    "physica a : statistical mechanics and its applications 247  ( 1 ) , 444472 .",
    "calantoni , j. , holland , k.  t. , drake , t.  g. , 2004 . modelling sheet - flow sediment transport in wave - bottom boundary layers using discrete - element modelling .",
    "philosophical transactions of royal society of london : series a 362 , 19872002 .",
    "kempe , t. , vowinckel , b. , frhlich , j. , 2014 . on the relevance of collision modeling for interface - resolving simulations of sediment transport in open channel flow",
    ". international journal of multiphase flow 58 , 214235 .",
    "kidanemariam , a.  g. , uhlmann , m. , 2014 .",
    "interface - resolved direct numerical simulation of the erosion of a sediment bed sheared by laminar channel flow . international journal of multiphase flow 67 , 174188 ."
  ],
  "abstract_text": [
    "<S> with the growth of available computational resource , cfd  dem ( computational fluid dynamics  discrete element method ) becomes an increasingly promising and feasible approach for the study of sediment transport . </S>",
    "<S> several existing cfd  </S>",
    "<S> dem solvers are applied in chemical engineering and mining industry . however , a robust cfd  </S>",
    "<S> dem solver for the simulation of sediment transport is still desirable . in this work , </S>",
    "<S> the development of a three - dimensional , massively parallel , and open - source cfd  dem solver _ sedifoam _ is detailed . </S>",
    "<S> this solver is built based on open - source solvers openfoam and lammps . </S>",
    "<S> openfoam is a cfd toolbox that can perform three - dimensional fluid flow simulations on unstructured meshes ; lammps is a massively parallel dem solver for molecular dynamics . </S>",
    "<S> several validation tests of _ sedifoam _ are performed using cases of a wide range of complexities . </S>",
    "<S> the results obtained in the present simulations are consistent with those in the literature , which demonstrates the capability of _ sedifoam _ for sediment transport applications . in addition to the validation test , the parallel efficiency of _ sedifoam _ is studied to test the performance of the code for large - scale and complex simulations . </S>",
    "<S> the parallel efficiency tests show that the scalability of _ sedifoam _ is satisfactory in the simulations using up to @xmath0 particles .    </S>",
    "<S> cfd  dem , sediment transport , particle - laden flow , multi - scale modeling </S>"
  ]
}