{
  "article_text": [
    "although several important chemical and physical properties of matter are determined by the lowest energy electronic configuration ( or ground state ) , a significant number of physical properties are crucially dependent on the excitation spectra .",
    "these properties range from electronic optical excitations to transport and thermodynamic behavior .",
    "while elegant theories that take advantage of the variational principle have been formulated for the ground state ,  @xcite the theories on the excitation spectra are far more complex .",
    "@xcite therefore , although excited states are extremely important , our understanding of them is limited as compared with the ground state .",
    "diffusion quantum monte carlo ( dmc ) is the method of choice to obtain the ground state energy of systems with more than @xmath0 electrons .",
    "the dmc algorithm  @xcite transforms the calculation of an excited state ( e.g. , the fermionic ground state ) into a ground state calculation .",
    "the accuracy of the method depends , however , on a previous estimate of the zeros ( nodes ) of the wave - function .",
    "the ground state wave - function of most many - body hamiltonians @xmath1 is a bosonic ( symmetric ) wave - function without nodes .",
    "any other eigenstate of a many - body hamiltonian @xmath1 must have nodes in order to be orthogonal to the bosonic ground state . in the case of fermions ( e.g. , electrons )",
    ", the ground state must be antisymmetric .",
    "therefore , the electronic ground state is an excited state of the many - body hamiltonian @xmath1 and must have nodes ( hyper - surfaces in @xmath2 space where the wave - function becomes zero and changes sign , being @xmath3 the number of particles ) .",
    "the standard diffusion monte carlo ( dmc ) approach  @xcite finds the lowest energy @xmath4 of all the wave - functions that share the nodes @xmath5 of a trial wave - function @xmath6 , where @xmath7 is a point in the @xmath2 coordinate space .",
    "this lowest energy wave - function is denoted as the fixed - node ground state @xmath8 .    since `` no nodes '' is a condition easy to satisfy",
    ", the ground state energy of a bosonic system can be found with a precision limited only by statistical and time - step errors . for any other eigenstate @xmath9 , a good approximation of its nodal surface @xmath10",
    "must be provided in order to avoid systematic errors .",
    "departures in @xmath5 from the exact nodes @xmath11 cause , in general , errors of the energy as compared with the exact eigenstate energy .",
    "@xcite for the fermionic ground state , the standard dmc algorithm provides only an upper bound of the ground state energy .",
    "@xcite moreover , if @xmath9 is non degenerate , any departure of @xmath5 from @xmath11 creates a kink in the fixed - node ground state .",
    "@xcite accordingly , accurate many - body calculations require methods to obtain and improve @xmath5 .",
    "the problem of searching the exact nodes @xmath11 , the surfaces in @xmath2 space where the wave - function of an arbitrary eigenstate @xmath12 changes sign , is one of the outstanding problems in condensed matter theory .  @xcite    this paper is the natural conclusion of earlier work . in ref .",
    "we showed that even the _ exact _ kohn - sham@xcite wave - functions _ can not _ be expected to provide accurate nodal structures for dmc calculations .",
    "however , we also showed that an optimal kohn - sham - like nodal potential exists . subsequently in ref .",
    "we demonstrated that the nodes of the fermionic ground state wave - function can be found in an iterative process by locally smoothing the kinks of the fixed - node wave - function .",
    "we also showed that an effective nodal potential can be found to obtain a compact representation of an optimized trial wave - function with good nodes . while some details are rederived here , reading those papers before this one is _",
    "highly_@xcite recommended .    in this paper the self - healing diffusion monte carlo method ( shdmc ) is extended to find the nodes , wave - functions , and energies of low - energy eigen - states of bosonic and fermionic systems .",
    "this paper describes how to extend the `` simple shdmc algorithm '' ( as described in section iii.c of ref . ) to excited states .",
    "an extension to optimize the multi - determinant expansion , ( see section iv in ref . ) is clearly possible and will be explained elsewhere .",
    "the ground state shdmc algorithm builds upon the importance sampling dmc method .",
    "@xcite the standard diffusion monte carlo approach is based on the ceperley - alder@xcite equation :  @xcite @xmath13   f({\\bf r},\\tau ) \\ ; , \\end{aligned}\\ ] ] where @xmath14/\\psi_t({\\bf r } ) $ ] is the `` local energy , '' @xmath15 is the many - body hamiltonian operator , @xmath16 denotes a point in @xmath2 space , and @xmath17 is a reference energy .",
    "equation ( [ eq : ceperleyalder ] ) is often solved numerically@xcite using a large number @xmath18 of electron configurations ( or walkers ) which are points @xmath19 in the @xmath2 space .",
    "these walkers i ) randomly diffuse according to the first term in eq .",
    "( [ eq : ceperleyalder ] ) and ii ) drift according to the second term a time @xmath20 .",
    "in addition , iii ) the walkers branch \\{or pass on } with probability @xmath21 $ ] \\{or @xmath22 - 1 $ ] } .",
    "to prevent large fluctuations in the population of walkers and excessive branching or killing , often a statistical weight is assigned to each walker .",
    "a detailed review of the numerical methods used for minimizing errors and accelerating dmc calculations is given in ref . .",
    "in the limit of @xmath23 , the distribution function of the walkers in an importance sampling dmc algorithm is given by@xcite @xmath24 the @xmath25 in eq .",
    "( [ eq : fr ] ) correspond to the positions of walker @xmath26 at the step @xmath27 for an equilibrated dmc run of @xmath18 configurations .",
    "the original shdmc method for the ground state was implemented in a mixed branching with weights scheme . for reasons that will be clear below ,",
    "it is easier to formulate a method for excited states with a constant number of walkers with weights @xmath28 which are given by @xmath29 k \\ ; \\delta\\tau},\\ ] ] with @xmath30 being a number of steps , @xmath31 the time step , and @xmath32 the energy reference @xmath17 in eq .",
    "( [ eq : weights ] ) is adjusted so that @xmath33 assuming a constant @xmath17 for @xmath34 steps .",
    "note that setting all @xmath35 in eq .",
    "( [ eq : fr ] ) gives at equilibrium , by construction , a distribution @xmath36 , because this is equivalent to setting @xmath37 in eq .",
    "( [ eq : ceperleyalder ] ) .",
    "if one sets the initial distribution of walkers as @xmath38 , then the distribution of walkers at imaginary time @xmath39 is given by @xmath40 \\\\",
    "\\nonumber                  & = & \\psi_t({\\bf r } ) \\psi_t({\\bf r},\\tau ) \\\\",
    "\\nonumber                   & = & \\lim_{n_c \\rightarrow \\infty } \\frac{1}{n_c } \\sum_i^{n_c }   w_i^j(k ) \\delta \\left({\\bf r - r}_i^j \\right ) \\ ; . \\end{aligned}\\ ] ] therefore , at equilibrium and in a no branching approach , the weights @xmath41 contain all the difference between @xmath42 and @xmath43 . in eq .",
    "( [ eq : evoltau ] ) @xmath44 is the fixed - node evolution operator , which is a function of the fixed - node hamiltonian operator @xmath45 given by @xmath46 \\right\\ } \\ ; .\\ ] ] the third term in the right - hand side of eq .",
    "( [ eq : hfn ] ) adds an infinite potential at the points @xmath7 with minimum distance to any point of the nodal surface @xmath47 $ ] smaller than @xmath48 .",
    "@xcite    using eq .",
    "( [ eq : evoltau ] ) one can formally obtain @xmath49 and using eq .",
    "( [ eq : fr ] ) one obtains @xmath50 the trial wave - function @xmath51 is commonly a product of an antisymmetric function @xmath52 and a jastrow@xcite factor @xmath53 .",
    "often @xmath54 is a truncated sum of slater determinants or pfaffians @xmath55 : @xmath56    in ref .",
    "we proved that we can evaluate @xmath57 for @xmath58 using a numerically stable algorithm .",
    "the analytical derivation of the algorithm@xcite can be summarized@xcite here as @xmath59 the operator @xmath60 is defined in eq .",
    "( [ eq : deltaexp ] ) .",
    "equation ( [ eq : algorithmground ] ) means that the ground state @xmath61 @xcite can be obtained recursively by generating a new trial wave - function @xmath62 from a fixed - node dmc calculation that uses the previous trial wave - function @xmath63 , which is given by @xmath64 equation ( [ eq : psitnew ] ) means that new coefficients @xmath65 of a truncated expansion of a trial wave - function of the form given in eq .",
    "( [ eq : psit ] ) are obtained _ numerically _ from the distribution of walkers of a dmc run as @xmath66 where @xmath67 and @xcite @xmath68    a complete explanation of our method is given in ref . .",
    "briefly here , our method systematically improves the nodes for three main reasons :    \\1 ) the projectors in eq .",
    "( [ eq : xi ] ) include only functions @xmath69 that retain all symmetries of the ground state . in more technical terms",
    ", the ground state is expanded only with functions that belong to the same irreducible representation .",
    "this means that if the @xmath55 are determinants , for example , the bosonic ground state is excluded .",
    "therefore , fluctuations that depart from the fermionic hilbert space are filtered and do not propagate into the trial wave - function from one dmc run to the next shdmc iteration .",
    "\\2 ) the projection of @xmath8 into a finite set of @xmath69 with low non - interacting energy can be shown@xcite to be equivalent to locally smoothing the kinks at the node of the fixed - node wave - function with a function of the form @xmath70 we proved that a large class of local smoothing functions have the same effect on the nodes as a gaussian , under certain conditions , which includes the case of eq .",
    "( [ eq : deltaexp ] ) . in turn , in ref .",
    "we proved that , to linear order in @xmath71 , the convolution of a gaussian with any continuous function has the same effect on the nodes as the imaginary time propagator @xmath72 [ this allows replacing eq .",
    "( [ eq : prevground ] ) by eq .",
    "( [ eq : algorithmground ] ) ] .",
    "thus our method can be viewed as the recursive application of two operators on the trial wave - function : i ) @xmath73 that turns @xmath74 into @xmath75 and ii ) @xmath60 that samples and truncates the expansion and changes the nodes as @xmath76 . accordingly , our method is formally related to the shadow wave - function  @xcite and the a - function approach  @xcite [ see eq .",
    "( [ eq : prevground ] ) ] .",
    "\\3 ) finally , we argued that the method is robust against statistical noise , because the kink should increase with the distance between the exact node @xmath77 and the node of the trial wave - function @xmath5 [ the kink must disappear for @xmath78 .",
    "in addition , we took the relative error in @xmath65 as truncation criterion for @xmath60 .",
    "a detailed explanation of the advantages and limitations of the standard fixed - node approximation for excited states is given in ref .",
    "this paper explores the possibility of overcoming these limitations in calculating excited states by excluding the projection of lower energy states from the set of @xmath79 .",
    "however , in to follow this path the problem of inequivalent nodal pockets has to be addressed .",
    "the expression `` nodal pocket '' denotes a volume in @xmath2 space enclosed by the nodal surface @xmath5 .",
    "it has been shown  @xcite that the ground state of any fermionic hamiltonian with a local potential has nodal pockets that belong to the same class , meaning that the complete @xmath2 space can be covered by applying all symmetry operations ( e.g. , particle permutations ) to just one nodal pocket . therefore ,",
    "if the trial wave - function is obtained from such a hamiltonian , all nodal pockets are equivalent by symmetry . for the ground state ,",
    "one can obtain the fixed - node wave - function in just one pocket and map it to the rest of the @xmath2 space using permutations of the particles and other symmetries of @xmath15 .    in the case of arbitrary excited states , there are inequivalent nodal pockets that present a challenge to the fixed - node approach .",
    "@xcite due to this inequivalent pocket problem , alternatives to the fixed - node method and variations have been tried .",
    "@xcite self - healing dmc@xcite implicitly takes advantage of the equivalence of nodal pockets in the fermionic ground state and must be extended to the inequivalent pocket case .",
    "for this reason a nonbranching formulation is used in the excited state case .      a first complication , which has a simple solution , of the nonbranching fixed - node approximation is that the number of walkers in each nodal pocket is also fixed by the nodes . as a consequence of the drift or `` quantum force '' term [ second term in eq .",
    "( [ eq : ceperleyalder ] ) ] , the walkers are repelled from the regions where the wave - function is zero and they can not cross the node for @xmath80 . the fact that the population in each nodal pocket is fixed has no consequence for the ground state because all nodal pockets are equivalent .",
    "for the ground state it is not important in which nodal pocket the walker is trapped because particle permutations can move every walker into the same nodal pocket and the projectors @xmath79 in eq .",
    "( [ eq : xi ] ) are invariant under such permutations .",
    "however , in the case of excited states , which have more nodes than those required by symmetry ,  @xcite there are inequivalent nodal pockets . in a nonbranching dmc scheme with weights , the population is locked from the start in a set of pockets .",
    "if the initial distribution of @xmath18 walkers is chosen with a metropolis algorithm to match @xmath43 , there would be random variations in the starting population of the order of @xmath81 , where @xmath82 is the number of inequivalent nodal pockets .",
    "this would cause systematic errors if the wave - function coefficients @xmath65 were sampled without taking preventive measures . moreover , even if the initial numbers of walkers in each pocket were set `` by hand '' ( to be proportional to the integral @xmath43 in each pocket ) , the resolution of the sampling can not be better than @xmath83 .",
    "the importance of this error grows if @xmath18 is small or if the number of inequivalent nodal pockets is large .    to prevent this error from occurring ,",
    "some walkers are simply allowed to cross the node after the wave - function coefficients are sampled . at the end of a sub - block of @xmath34 steps , for every walker @xmath26 at @xmath84 , a random move @xmath85",
    "is generated with a gaussian distribution using @xmath86 , _ without _ the drift velocity contribution .",
    "this move is accepted only if the wave function changes sign with a metropolis probability @xmath87 ^2 \\right\\ } $ ] .",
    "this ensures that i ) the distribution of walkers remains proportional to @xmath43 and ii ) the average number of walkers in each pocket is proportional to the integral of @xmath43 as the number of sub - blocks @xmath88 tends to @xmath89 .",
    "a second complication of the fixed - node approach for the general case of excited states appears because small departures of @xmath5 from the exact nodes @xmath11 often will result in inequivalent nodal pockets having fixed - node solutions with different fixed - node energies .",
    "when nodal pockets are not equivalent , a standard dmc algorithm will converge to a `` single nodal pocket '' population . in this case",
    ", the lowest energy pocket will contain all the walkers in a branching algorithm [ or all significant weights ( @xmath90 ) ] .",
    "accordingly , the average energy sampled will correspond to the lowest energy nodal pocket , which will be different from that of the true excited - state energy ( see chapter 6 in ref . and references therein ) .",
    "if the coefficients of an excited - state fixed - node wave - function are sampled with the same procedure used for the ground state@xcite [ see eq .",
    "( [ eq : sampcoeff ] ) ] , they would correspond to a function that is different from zero just at the class of nodal pockets with lowest dmc energy and zero everywhere else .",
    "this function will not be , in general , orthogonal to the lower energy states .",
    "moreover , this will result in kinks at the nodes in the wave - function sampled with eq .",
    "( [ eq : sampcoeff ] ) between lowest energy nodal pockets and inequivalent ones .",
    "a first preventive measure to avoid a single pocket population is to avoid the limit @xmath23 in eqs .",
    "( [ eq : algorithmground ] ) and ( [ eq : psitnew ] ) which replaces @xmath91 by @xmath92 in eq .",
    "( [ eq : psitnew ] ) . as a result @xmath34 in eq .",
    "( [ eq : sampcoeff ] ) is limited to small values , which brings all values of @xmath28 closer to @xmath93 .",
    "since the approach is recursive , the limit of @xmath23 is reached as @xmath94 ( since successive applications of the algorithm are accumulated in @xmath95 ) .",
    "in addition , to prevent the wave - function from falling into lower energy states , two techniques are used : i ) direct projection and ii ) unequal reference energies .      while the trial wave - function",
    "can be forced to be orthogonal to the ground state , or any other excited state calculated before , the fixed - node wave - function can develop a projection into lower energy states , because the dmc algorithm only requires @xmath8 to be zero at the nodes @xmath96 . to prevent excited states from drifting into lower energy states ,",
    "let me assume , for a moment , that approximated expressions of the excited states @xmath97 with @xmath98 can be obtained and used to build the projector @xmath99 is the multiplication by a jastrow .",
    "since the @xmath100 shall be obtained statistically , they will have errors and will not form an orthogonal basis in general .",
    "therefore , @xmath101 are elements of the conjugated basis that satisfy @xmath102 .",
    "they can be constructed inverting the overlap matrix @xmath103 as @xmath104 then , the extension of the self - healing algorithm to the next excited @xmath105 can be rederived analytically as follows : @xmath106 equation ( [ eq : shdmcexcited ] ) means that for any initial trial wave - function @xmath107 with latexmath:[$\\hat p    excited state @xmath105 recursively .",
    "the numerical implementation of the algorithm for excited states ( see section [ sc : algorithm ] for details ) is almost identical to the ground state version@xcite with three differences :",
    "i ) there is no branching and the product @xmath109 is chosen so as @xmath110 [ see eq . ( [ eq : sampcoeff ] ) ] , ii ) the projection of the vector of coefficients @xmath65 into the ones corresponding to eigenstates calculated earlier is removed with @xmath111 , and iii ) some walkers cross the node after @xmath34 time steps ( see above ) . eq .",
    "( [ eq : shdmcexcited ] ) holds in the limit of @xmath112 , @xmath80 , @xmath113 , @xmath114 , and @xmath115 . in the derivation of eq .",
    "( [ eq : shdmcexcited ] ) , the following properties were used : @xmath116 , and @xmath117 \\simeq 0 $ ] . in ref .",
    "it was shown that , under certain conditions , @xmath118 \\simeq s \\left [   \\tilde d e^{-k \\delta\\tau   \\hat \\mathcal{h}^{(\\ell-1)}_{fn } } \\hat p    \\right ] \\ ; ; \\ ] ] that is , the nodes of the two functions in the brackets are approximately the same .",
    "note that the second term in brackets of eq .",
    "( [ eq : orthogonality ] ) has precisely the form given in eq .",
    "( [ eq : deltaexp ] ) . by construction",
    ", this term would generate a function with nodes corresponding to a linear combination of lower energy eigenstates .",
    "the projector @xmath111 , instead , excludes any change in the wave - functions introduced by the projection and sampling operator @xmath60 or by @xmath119 in the direction of lower energy wave - functions ( which includes their nodes ) .",
    "if walkers at one side of the node have more weight than at the other ( because of inequivalent pockets with different fixed - node energies ) , the propagated wave - function obtained by sampling the walkers will be multiplied by a larger ( smaller ) factor for the low ( high ) energy side of the nodal surface .",
    "this generates an additional contribution to the kink at the node that , when locally smoothed , increases the volume of lower energy pockets at the expense of the higher energy ones , causing the volume of the lower ( higher ) energy pockets to grow ( diminish ) .",
    "this , in turn , will have an impact on the kinetic energy : due to quantum confinement effects , the difference in fixed - node energies will increase in the next iteration .",
    "this very interesting effect in fact acts to our advantage by helping us to find the ground state even when starting from a very poor wave - function .",
    "@xcite for excited states , this effect is prevented by i ) limiting the maximum value of @xmath34 and ii ) the projector @xmath111 in eq .",
    "( [ eq : shdmcexcited ] ) . however , the eigenstates @xmath120 will have statistical errors that can create systematic errors in the higher states . to partially prevent these errors , and to limit the number of orthogonality constraints , the energy reference can be changed in order to invert this contribution to the kink to our advantage .    while a single reference energy @xmath17 can still be used for the dmc run in each block , the projectors of eq .",
    "( [ eq : sampcoeff ] ) are redefined using a reference energy dependent on the nodal pocket .",
    "in addition , following a suggestion of c. umrigar ,  @xcite the change in the coefficients @xmath121 is sampled instead of the total value @xmath122 . @xmath123k \\ ; \\delta\\tau } -1)\\ ; \\xi_n^*({\\bf r}_i^j ) \\ ; \\gamma({\\bf r}_i^j ) \\ ; , \\end{aligned}\\ ] ] where @xmath124 is an adjustable parameter and @xmath125 is the weighted average of the local energy during the lifetime of the walker @xmath26 since the start of the block or the last time it crossed the node at step @xmath126 . if @xmath127 is selected in eq .",
    "( [ eq : sampnew ] ) , the factor @xmath128}$ ] just replaces in the definition of the weights [ see eq .",
    "( [ eq : weights ] ) ] @xmath129 by @xmath130 .",
    "the energy @xmath131 for @xmath132 is expected to converge to the fixed - node energy of the nodal pocket where the walker @xmath26 is trapped ; however , only the last two - thirds of the block are used to accumulate values to allow @xmath131 to equilibrate .    it was argued before that , for @xmath133 , the differences in the fixed - node energies of neighboring nodal pockets create a contribution to the kink that , when locally smoothed , increases the volume of nodal pockets with low fixed - node energy . for @xmath134 ,",
    "it is likely that this contribution to the kink is inverted so that the volume of the lower ( higher ) energy pockets is reduced ( increased ) by the smoothing function ( [ eq : deltaexp ] ) .",
    "therefore , it can be assumed that a value of @xmath134 should stabilize the higher energy nodal pockets , increasing their volume and , thus , reducing their energy .",
    "this process will stop when the fixed - node energy of all nodal pockets becomes equal .",
    "note that by introducing this artificial contribution to the kink , one may stabilize some nodal structures , preventing nodal fluctuations that reduce the energy of one nodal pocket at the expense of the others .",
    "however , fluctuations that lower the energy of every nodal pocket are not prevented . therefore ,",
    "if several eigenstates have the same nodal topology , higher energy states could drift into lower energy ones if orthogonality constraints [ see eq .",
    "( [ eq : orthogonality ] ) ] are not imposed .",
    "finally , note that choosing @xmath134 can also cause problems if the quality of the wave - function is not good or if the statistics is poor .",
    "for example , a small statistical fluctuation in the values of @xmath65 could create a new nodal pocket with high energy . in successive blocks ( as @xmath135 increases )",
    ", this pocket will grow at the expense of the others , causing the total energy to rise .",
    "a basis of @xmath55 must be constructed , taking advantage of all the symmetries of @xmath136.@xcite the @xmath55 should be selected to be eigen - functions of a noninteracting many - body system  @xcite belonging to the same irreducible representation for every symmetry group of @xmath137 .",
    "the calculation must be repeated for each irreducible representation .",
    "note that the same algorithm is used for bosons or fermions : the only difference is the basis used to expand the wave - functions .",
    "the calculation of excited states with shdmc is composed of a sequence of blocks .",
    "each block @xmath135 has @xmath88 sub - blocks with @xmath34 standard dmc steps .",
    "the basic algorithm is the following :    1 .",
    "an initial set of coefficients for the expansion of the trial wave - function is selected .",
    "the changes @xmath138 are accumulated [ see eqs .",
    "( [ eq : xi ] ) and ( [ eq : sampnew ] ) ] at the end of each sub - block .",
    "some walkers near the node can cross it at the end of each sub - block .",
    "3 .   at the end of each block @xmath135",
    ", the error in @xmath138 is evaluated .",
    "if this error is larger than 25% of @xmath139 , then @xmath140 is set to zero ;  @xcite otherwise , @xmath140 is set to @xmath141 .",
    "a new trial wave - function is constructed at the end of each block @xmath135 using the new values of the coefficients sampled after removing with @xmath111 the projection into eigenstates calculated earlier .",
    "if the scalar product between the vector of new @xmath142 with the one obtained in the previous block ( @xmath143 ) is positive , the number of sub - blocks @xmath88 is increased by one .",
    "otherwise , @xmath88 is _ multiplied _ by a factor larger than one ( e.g. , @xmath144 ) .",
    "this factor increases the statistics reducing the impact of noise .",
    "@xcite 6 .",
    "steps 2 - 6 are repeated until the variance of the weights @xmath28 is smaller than a prescribed tolerance ( see fig .",
    "[ fg : variance ] in section [ sc : modeltest ] ) .",
    "the projector @xmath111 is updated to include the new excited state .",
    "steps 1 - 7 are repeated until a desired number of excited states is obtained .",
    "some points about the application of the algorithm should be addressed before discussing the results .    * in this paper , to test the method , intentionally poor trial wave - functions have been selected as a starting point .",
    "good initial wave - functions and a good jastrow are advised in real production runs in large systems .",
    "methods to select good initial trial wave - functions will be discussed elsewhere .",
    "* time - step errors and , in particular , persistent walker configurations@xcite can cause significant problems .",
    "when this happens it often results in an increase in the error bar of every @xmath65 which causes a large reduction in the number of coefficients retained in the trial wave - function .",
    "this problem is avoided in the algorithm by discarding the entire block if a 50% reduction in the number of basis functions retained is detected .",
    "nevertheless , if the quality of the initial @xmath51 is bad , it is strongly recommended to reduce the time step @xmath145 .",
    "as the quality of the wave - function improves with successive iterations , one can increase @xmath31 .",
    "for fast convergence @xmath146 should be of the order of the interparticle distance .",
    "* as a strategy , it is better to run at first using @xmath147 in eq .",
    "( [ eq : sampnew ] ) including every state calculated before in @xmath111 [ see eq .",
    "( [ eq : orthogonality ] ) ] . once the wave - function @xmath51",
    "is converged , one can set @xmath148 and @xmath149 and monitor if @xmath51 evolves into a subset of lower energy states . to prevent the propagation of errors of every lower energy state included in @xmath111 into the next excited state , a run including only this subset in @xmath111 can be performed . * to obtain accurate total energies , a long run with large @xmath34 is required ( this is almost a standard dmc run ) . * shdmc should not be used blindly as a library routine .",
    "the calculation of excited states with shdmc is a task that will probably remain limited to quantum monte carlo experts .",
    "while , in contrast , density functional approximated methods have suddenly become very easy to use , it is not quite clear to the author that requiring expertise and a deep understanding is a disadvantage .",
    "any new code using shdmc should be tested in a small system where analytical solutions or results with an alternative approach@xcite are available .",
    "the comparison with a soluble model is presented in the next section .",
    "this section compares the methods described above for the calculation of excited states with shdmc , with full configuration interaction ( ci ) calculations in the model system used in refs . and .",
    "briefly , the lower energy eigenstates are found for two electrons moving in a two dimensional square with a side length @xmath93 with a repulsive interaction potential of the form@xcite @xmath150}\\cos{[\\alpha \\pi(y - y^{\\prime})]}$ ] with @xmath151 and @xmath152 .",
    "the many - body wave - function is expanded in functions @xmath55 that are eigenstates of the noninteracting system .",
    "the @xmath55 are linear combinations of functions of the form @xmath153 with @xmath154 .",
    "full ci calculations are performed to obtain a nearly exact expression of the lower energy states of the system @xmath155 .",
    "we solve the problem both for the singlet and the triplet case .",
    "the singlet state of this system is bosonic - like , since the ground state wave - function has no nodes .",
    "the lowest energy excitations of the noninteracting problem @xmath55 that have the same symmetry ( that is , that are invariant under exchange of particles , and under all symmetry operations of the group @xmath156 ) are selected to expand @xmath136 . for the case of the triplet ,",
    "the wave - function must change sign for permutations of the particles .",
    "the ground state is , however , degenerate ( belongs to the @xmath157 representation of @xmath156 ) .",
    "the @xmath157 representation can be described by wave - function even ( odd ) for reflections in @xmath158 and odd ( even ) for reflections in @xmath159 .",
    "we choose the wave - functions that are odd in the @xmath158 direction : belonging to a @xmath160 subgroup of the @xmath156 symmetry . for more details on the triplet ground state calculations ,",
    "see refs . and .    to facilitate the comparison with the full ci results , projectors @xmath79",
    "are constructed with the same basis functions used in the ci expansion .",
    "for the same reason , no jastrow function is used [ @xmath161 in eq .",
    "( [ eq : xi ] ) ] .    to test the method ,",
    "poor initial trial wave - functions are intentionally chosen as follows : for the ground state the lowest energy function of the noninteracting system is selected . for the @xmath162 ( @xmath163 ) excited state , the initial trial wave - function @xmath164 columns of a determinant with",
    "the first @xmath165 coefficients of the @xmath166 eigenstates calculated before .",
    "subsequently , the vector of cofactors of the last column was calculated .",
    "the coefficients of this vector are used to construct a trial wave - function orthogonal to all the eigenstates calculated earlier .",
    "( trivial ) irreducible representation of the group @xmath156 in the singlet state .",
    "black lines denote the average value of the local energy .",
    "the horizontal blue dashed lines mark the energy of the corresponding excitation in the full ci calculation .",
    "[ fg : dmccirun : sglex ] ]    figure [ fg : dmccirun : sglex ] shows the results of successive shdmc runs for the singlet ground state and the next @xmath167 excitations that belong to the same symmetry ( total spin @xmath168 , and irreducible representation @xmath169 of the group @xmath156 ) .",
    "the shdmc calculations were done using @xmath170 walkers with a sub - block length @xmath171 , a time step @xmath172 ,  @xcite @xmath173 ( for the ground state @xmath174 ) and , @xmath175 in eq .",
    "( [ eq : sampnew ] ) .    the lines in fig .",
    "[ fg : dmccirun : sglex ] join the values obtained for the weighted average of the local energy @xmath176 for each time step .",
    "the horizontal dashed lines mark the energy of the nearly analytical result obtained with full ci .",
    "the agreement between shdmc and full ci is extremely good .",
    "as higher energy eigenstates are calculated however , and the number of nodal pockets and nodal surfaces increases , time step errors start to play a dominant role . in particular , for the @xmath177 excitation ( not shown ) @xmath178 must be reduced .",
    "the occasional peaks ( or drops ) observable in the data are correlated with the update of @xmath51 , and their reduction also reflects a systematic improvement in the trial wave - function . at the end of each block ,",
    "the trial wave - function coefficients @xmath65 are updated and all weights are reset to 1 .",
    "they gradually reach equilibrium values when new energies are sampled , completing a sub - block of length @xmath34 . as a result , at the beginning of each block , the energy sampled is the average of the trial wave - function energy , which is often different than the dmc energy sampled thereafter ( but it can be smaller or higher for a bad trial wave - function with small @xmath18 ) .",
    "one interesting result is that some orthogonality constraints are not required to obtain some excited states .",
    "this is the case , for example , of the first excited state calculated with @xmath127 .",
    "this is presumably due to the fact that the number of nodal pockets is different for the excited state and the ground state and the decay path from the first excited state to the ground state is obstructed by the formation of a kink between inequivalent nodal pockets if a value of @xmath179 is used .",
    "this is also the case for states @xmath180 and @xmath181 , which were obtained _ before _ state 5 despite the fact that they have higher energy .",
    "a similar effect is observed in some triplet excitations . due to the choice of initial trial wave - function and the kink induced by @xmath149 , the @xmath182 excitation",
    "is found before the @xmath183 , and the @xmath184 is obtained before the @xmath183 and the @xmath185 .",
    "this interesting effect disappears if @xmath147 is chosen .",
    "table [ tb : overlap ] shows the logarithm of the residual projection @xmath186 of the excited state wave - function @xmath120 sampled with shdmc onto the corresponding full ci result @xmath187 as a function of the number of iterations for different eigenstates .",
    "the states are ordered as they first appear in the calculation .",
    "in addition , table [ tb : overlap ] compares the values of the eigen - energies obtained with ci and shdmc .",
    "the agreement is very good . in some cases the difference is larger than the error bar",
    "this might signal that small nodal errors remain .",
    "note that there is no upper bound theorem for excited states but for the ground state within an abelian irreducible representation.@xcite    .values obtained for @xmath188 [ see eq .",
    "( [ eq : lrp ] ) ] for a total of ( a ) @xmath189 ( b ) @xmath190 and ( c ) @xmath191 dmc steps and corresponding eigen - energies for two electrons in a square box with a model interaction .",
    "the logarithm of the residual projection @xmath188 of the shdmc wave - function with the corresponding full result ci is given for different eigenstates belonging to the same symmetry of the ground state as a function of the number of steps used to sample the wave - function .",
    "[ tb : overlap ] the states are included in the order they were obtained .",
    "[ cols=\"^,^,^,^,^,^,^ , < , < \" , ]     ) ] for the ground ( square ) , first ( diamond ) , second ( up triangle ) and third ( down triangle ) eigenstates with @xmath169 symmetry and s=0 .",
    "[ fg : lrp ] ]    figure [ fg : lrp ] shows @xmath192 at the end of each block for the ground state and low - lying excitations of the system as a function of the total number of shdmc steps .",
    "the calculations were done by first running @xmath193 shdmc steps for each eigenstate before starting the calculation of the next .",
    "subsequently , an additional set of @xmath193 shdmc steps was run , improving the projector @xmath111 .",
    "the kinks in the data around @xmath194 are due to the changes in the coefficients of the lower energy states involved in @xmath111 [ see eq .",
    "( [ eq : orthogonality ] ) ] .    one important conclusion of table [ tb : overlap ] and figure [ fg : lrp ] is that errors in the determination of lower energy states calculated earlier only propagate `` locally '' because of the orthogonality constraints in eq .",
    "( [ eq : orthogonality ] ) .",
    "this error does not have a strong impact on much higher energy excitations .",
    "this is apparently due to the fact that each newly calculated excitation tends to occupy the hilbert space left by lower excitations due to statistical error .",
    "this is clear , for example , for the @xmath184 and @xmath195 excitations , which have an error much smaller than several excitations calculated earlier ( e.g. , @xmath182 and @xmath185 ) .",
    "the error in the @xmath182 and @xmath185 excitations is mainly due to mixing among themselves .",
    "this result is important because it means that the present method can be used to calculate several higher excitations in spite of the errors in lower energy ones .",
    "excited state of the singlet state of @xmath169 symmetry .",
    "light gray colors denote older coefficients , whereas darker ones denote more converged results .",
    "the full ci results are highlighted in small red diamonds.[fg : dmcsltex ] ]    figure  [ fg : dmcsltex ] shows the evolution of the values of the coefficients @xmath196 of @xmath95 as a function of the coefficient index @xmath12 for the @xmath184 excited state corresponding to the singlet configuration of the @xmath169 representation of the group @xmath156 .",
    "the shade of gray is light for the older ( small @xmath135 ) coefficients and deepens to black for the final results ( large @xmath135 ) .",
    "the calculation started from a trial wave - function orthogonal to the states calculated before as described above .",
    "the coefficients of the wave - function sampled with shdmc overlap with the ones obtained with full ci ( see table [ tb : overlap ] ) .",
    "similar results are obtained for all the other excited states calculated .",
    "an important observation is that the coefficients @xmath65 evolve continuously towards the exact solution , which suggests the possibility of accelerated algorithms that extrapolate the values of @xmath197 .",
    "some eigenstates are significantly more difficult to calculate than others .",
    "this is typically the case for eigenstates with similar eigenvalues ( e.g. , the @xmath198 excitation in the singlet case ) .",
    "a bigger challenge , however , is when @xmath176 is ill behaved , for example , the case of the @xmath183 , @xmath185 , and @xmath198 excitations of the triplet state .",
    "even the full ci wave - function with 300 basis functions has a large variance for @xmath176 . in that case",
    "the coefficients obtained with shdmc and ci are different .",
    "this is due to the fact that the two methods minimize different things : ci minimizes @xmath199 on a truncated basis , and shdmc minimizes @xmath200 with @xmath201 .",
    "accordingly , the fact that the results are different indicates that neither calculation , ci or shdmc , is converged with the basis chosen .",
    "the @xmath185 and @xmath198 excitations with e symmetry in the triplet case obtained with shdmc are a linear combination of the corresponding ones in full ci .",
    "( color online ) average of the local energy @xmath176 as a function to the number of dmc time steps for two shdmc runs with @xmath202 starting from a converged trial wave - function corresponding to the @xmath195 singlet excitation of @xmath169 symmetry with a ) @xmath203 and b ) @xmath204 in eq .",
    "( [ eq : sampnew ] ) .",
    "the dotted lines mark the beginning of some of the fixed - node dmc blocks of a shdmc run for the @xmath204 case .",
    "same conventions as in fig .",
    "[ fg : dmccirun : sglex ] . ]    figure [ fg : drop ] shows the effect of @xmath111 and @xmath124 [ see eq .",
    "( [ eq : sampnew ] ) ] on a shdmc run .",
    "the figure shows the average of the local energy @xmath176 for two calculations that start from the final trial wave - function obtained for the @xmath195 singlet excitation with @xmath169 symmetry ( please compare it with fig .",
    "[ fg : dmccirun : sglex ] ) .",
    "both calculations were run with the same parameters as in fig .",
    "[ fg : dmccirun : sglex ] with two exceptions : i ) @xmath202 was used , which removes the orthogonality constraints , and ii ) one calculation was run with @xmath203 and the other with @xmath147 in eq .",
    "( [ eq : sampnew ] ) .",
    "an initial number of blocks @xmath205 was used .",
    "both calculations depart from the initial configuration .",
    "however , the run with @xmath206 falls very quickly to the singlet ground state . the calculation with @xmath207 remains much longer in the vicinity of the @xmath195 excitation .",
    "this clearly shows the stabilizing effect unequal energy references on excited states .",
    "since presumably the @xmath195 excitation is not the minimum of its nodal topology , it finally drifts away . for the @xmath207 case with @xmath208 ,",
    "the algorithm becomes numerically unstable to noise after the @xmath209,000 $ ] time step because the variance in the distribution of weights of the walkers increases and the statistics is dominated by a reduced number of walkers .",
    "in contrast , the first excitation does not drift with @xmath210 and @xmath211 ( not shown ) .",
    "( color online ) average of the local energy @xmath176 of 200 walkers as the shdmc algorithm converges to the ground , first and second eigenstates with @xmath169 symmetry and s=0 of two electrons with coulomb interactions in a square box . ]",
    "the use of a simplified electron - electron interaction facilitates the ci calculations and the validation of the optimization method . however , it is also important to test the convergence and stability of the method with a realistic coulomb interaction as in the case of the ground state .",
    "@xcite    the results shown in this section have an interaction potential of the form@xcite @xmath212 as in ref . .",
    "to mimic the difficulties that the algorithm would have to overcome in larger or more realistic systems , the jastrow term is _ not _ included , i.e. @xmath161 . most shdmc parameters are the same as in the model interaction case .",
    "all calculations with coulomb interactions were run with @xmath147 , the initial number of sub - blocks @xmath213 , and the time step reduced to @xmath214 .",
    "the initial trial wave - functions were selected with the criteria used for the model case .",
    "figure [ fg : coulomb ] shows the average of the local energy @xmath176 obtained for the ground state and the first two excitations with the same symmetry ( singlet @xmath169 ) .",
    "the results are qualitatively similar to those obtained with the model potential .",
    "it is evident from the data that the variance of @xmath176 and its average are reduced as the wave - function is optimized .",
    "occasionally , @xmath176 might rise when @xmath111 is updated ( improving the description of lower energy states ) .",
    "the energy of the singlet ground state is 400.749 @xmath215 0.013 , which is only slightly smaller than the lowest triplet energy@xcite 402.718 @xmath215 0.008 with symmetry @xmath157 .",
    "these energies are very close because of the dominance of the coulomb repulsion as compared to the kinetic energy , which forces the particles to be well separated and therefore the cost of a node in the triplet state is small .",
    "this result is consistent with the choice of parameters that sets the system in the highly correlated regime .",
    "the energies obtained for the first and second excitations are@xcite @xmath216 and @xmath217 respectively .     for the @xmath183 excitation with @xmath218 symmetry with coulomb interaction ( see fig . [",
    "fg : coulomb ] ) .",
    "the lines are visual guides .",
    "[ fg : variance ] ]    while figs .",
    "[ fg : dmccirun : sglex ] and [ fg : coulomb ] are qualitatively similar , the results shown in fig .",
    "[ fg : dmccirun : sglex ] are more convincing since they are directly compared with full ci calculations and they are less noisy , as noted by one referee . when the model interaction potential is replaced by a coulomb interaction , full ci calculations are still possible , but they involve the numerical calculation of @xmath219 integrals with coulomb singularities .",
    "ci calculations are typically done using a gaussian basis ,  @xcite which limits the impact of the matrix element integrals of these singularities . however , as the size of the system increases , ci calculations become too expansible numerically .",
    "accordingly , self - reliant methods to validate the quality of the shdmc wave - functions must be developed .",
    "as noted earlier , in a fixed population scheme , the weights contain all the difference between @xmath42 and @xmath43 .",
    "since @xmath42 and @xmath43 should be equal if @xmath51 is an eigenstate , the variance of the weights can be used to measure the quality of the wave - function .",
    "figure [ fg : variance ] shows the evolution of the logarithm of the variance @xmath220 of the weights of the walkers @xmath28 [ see eq .",
    "( [ eq : weights ] ) ] as a function of the shdmc block index @xmath135 .",
    "@xmath220 is evaluated as @xmath221 by using a linear order expansion in @xmath31 in eq .",
    "( [ eq : weights ] ) and using eq . ( [ eq : enaverage ] ) , it is straightforward to relate eq .",
    "( [ eq : logvar ] ) to the variance of @xmath222 .",
    "the latter is an average of @xmath176 .",
    "a common measure of the quality of the ground state wave - function is the variance of @xmath176 .",
    "the results shown in fig .",
    "[ fg : variance ] correspond to the @xmath183 singlet excitation with @xmath169 symmetry ( see fig .",
    "[ fg : coulomb ] ) .",
    "similar results are obtained for the ground state and the first excitation ( not shown ) .",
    "the error bar in @xmath220 is smaller than the size of the symbols .",
    "the fluctuations in @xmath220 result from the random fluctuations of the coefficients @xmath65 that are obtained statistically .",
    "note that in spite of the noise , a clear trend shows the improvement of the quality of the wave - function and @xmath17 as the shdmc algorithm progresses .",
    "however , these improvements are not uniform , which is reflected by the oscillations in @xmath220 in fig .",
    "[ fg : variance ] and in the amplitude of @xmath176 in fig .",
    "[ fg : coulomb ] . a careful user of shdmc should track @xmath220 and use the best quality wave - function to calculate energies and @xmath111 .",
    "an algorithm to obtain the approximate nodes , wave - functions , and energies of arbitrary low - energy eigenstates of many - body hamiltonians has been presented .",
    "this algorithm is a generalization of the `` simple '' self - healing diffusion monte carlo method developed for the calculation of the ground state of fermionic systems,@xcite which in turn is built upon the standard dmc method .",
    "@xcite    at least in the case of the tested system , wave - functions and energies that continuously approach fully converged configuration interaction calculations can be obtained depending only on the computational time .",
    "the wave - function , in turn , allows the calculation of any observable .",
    "it is found that some special eigenstates , presumably the minimum energy eigenstate for a given nodal topology , can be obtained without calculating the lower excitations by artificially generating a kink in the propagated function using unequal energy references in different nodal pockets .",
    "the present method can be implemented easily in existing codes .",
    "ongoing tests on the ground state method@xcite in larger systems give serious hope@xcite that the current generalization will also be useful .    while there are methods to obtain the excitation spectra of a many - body hamiltonian in a variational monte carlo context  @xcite they require obtaining the hamiltonian and the overlap matrix elements .",
    "this requirement would present a challenge for very large systems .",
    "shdmc is a complementary technique that could potentially scale better for larger sizes .",
    "the evaluation and storage of the matrix elements of @xmath136 is not required .",
    "the number of quantities sampled [ the projectors @xmath223 , eq .",
    "( [ eq : xi ] ) ] is equal to the number of basis functions @xmath224 .",
    "in contrast , energy minimization methods or configuration interaction ( ci ) require the evaluation of @xmath225 matrix elements .",
    "in addition , the solution of a generalized eigenvalue problem with statistical noise is avoided .",
    "this can be an advantage in very large systems since algorithms for eigenvalue problems are difficult to scale to take maximum advantage of large supercomputers .",
    "in contrast , the sampling of a large number of determinants can be trivially distributed on different processors .",
    "moreover , recent advances in determinant evaluation could facilitate sampling a very large number of projectors @xmath226 .",
    "@xcite    an apparent disadvantage of shdmc is that the method is recursive .",
    "this disadvantage is partially removed since i ) the number of blocks @xmath88 used to collect data is increased only if necessary to improve the wave - function significantly ,  @xcite ii ) and , the propagation to large imaginary times is avoided by using precisely this recursive approach that accumulates the propagation in successive blocks .",
    "in addition , a small value of @xmath227 limits large fluctuations in the weights , which recently have been claimed to cause an exponential cost in the convergence of dmc results .",
    "@xcite    the dominant cost of the present algorithm to obtain the wave - functions and their nodes scales as @xmath228 , with @xmath229 being the number of excited states , @xmath224 the number of projectors @xmath79 sampled , and @xmath230 the total number of shdmc steps . of course , the error and the cost depend on the quality of the method used to construct @xmath231 and the quality of the initial trial wave - functions .",
    "systematic errors decrease when @xmath224 is large , and the statistical error decreases when @xmath230 increases . for a fixed absolute error , @xmath224 is expected to increase exponentially with the number of electrons @xmath3 .  @xcite    note that in order to describe an arbitrary wave - function of a system with @xmath3 electrons and a typical size @xmath232 in @xmath233 dimensions with a resolution @xmath234 , one needs approximately @xmath235 basis functions .",
    "the nodal surface alone requires  @xmath236 degrees of freedom .",
    "therefore , finding an algorithm to obtain the nodes @xmath11 of any eigenstate @xmath12 with an arbitrary interaction in a time polynomial in @xmath3 is potentially a `` philosopher s stone '' quest .",
    "however , if exponential factors actually control the accuracy of the dmc approach , as claimed ,  @xcite just a rock solid method to find the nodes which simultaneously improves the wave - function ( reducing the population fluctuations ) could be considered a satisfactory solution",
    ". the presented work could be the basis of such a method .    in ongoing work ,",
    "shdmc methods are being developed and tested in larger systems .",
    "the author would like thank c. umrigar for suggesting the sampling of @xmath138 instead of the absolute value of the coefficients .",
    "the author also thanks r. q. hood , m. bajdich and p. r. c. kent for a critical reading of the manuscript and for related discussions . finally , the author thanks the anonymous referee who inspired the calculations presented in figs . [ fg : drop ] and [ fg : variance ] .    research performed at the materials science and technology division sponsored by the department of energy and the laboratory directed research and development program of oak ridge national laboratory , managed by ut - battelle , llc , for the u.s .",
    "department of energy under contract no .",
    "de - ac05 - 00or22725 .",
    "note that the limit @xmath238 is taken after the amplitude of the potential tends to @xmath89 .",
    "thus , this potential does not have the @xmath239 form , and every eigenstate of @xmath240 must be zero at @xmath5 .",
    "if the change in the wave - function coefficients is dominated by random noise , the scalar product between the old and the new @xmath142 can be negative and @xmath88 is multiplied by a factor larger than 1 ."
  ],
  "abstract_text": [
    "<S> a recently developed self - healing diffusion monte carlo algorithm [ prb * 79 * , 195117 ] is extended to the calculation of excited states . </S>",
    "<S> the formalism is based on an excited - state fixed - node approximation and the mixed estimator of the excited - state probability density . </S>",
    "<S> the fixed - node ground state wave - functions of inequivalent nodal pockets are found simultaneously using a recursive approach . </S>",
    "<S> the decay of the wave - function into lower energy states is prevented using two methods : i ) the projection of the improved trial - wave function into previously calculated eigenstates is removed ; and ii ) the reference energy for each nodal pocket is adjusted in order to create a kink in the global fixed - node wave - function which , when locally smoothed , increases the volume of the higher energy pockets at the expense of the lower energy ones until the energies of every pocket become equal . </S>",
    "<S> this reference energy method is designed to find nodal structures that are local minima for arbitrary fluctuations of the nodes within a given nodal topology . </S>",
    "<S> it is demonstrated in a model system that the algorithm converges to many - body eigenstates in bosonic and fermionic cases . </S>"
  ]
}