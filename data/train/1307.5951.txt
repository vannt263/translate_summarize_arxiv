{
  "article_text": [
    "the optical control of avalanche photodiodes ( apds ) has been discussed recently , and was also implemented experimentally .",
    "it allows to control passively-  @xcite , actively - quenched  @xcite and gated  @xcite avalanche photodiodes .",
    "the electrical output of superconducting nanowire single - photon detectors ( snspds ) can also be influenced  @xcite .",
    "the high degree of control allows to intrude into quantum key distribution ( qkd ) setups  @xcite or to change the outcome of generic quantum optical experiments such as bell tests up to non - physical values  @xcite .",
    "all experiments that rely on the detection of single photons can be influenced .",
    "the underlying theory has been outlined in a number of papers  @xcite : experiments require an electronic circuit which provides distinct control over a number of light sources .",
    "qkd implementations rely often on encoding the qubits into polarization states of single photons . in this scenario ,",
    "the avalanche photo detectors can be influenced by polarized bright laser pulses . to achieve a full level of control",
    ", it is required to target different detectors , which are combined into a complete polarization analyzer . for qkd experiments",
    "the so - called `` faked - state '' attack has been developed  @xcite . in this scheme ,",
    "an eavesdropper eve receives approximate single photons sent out by the legitimate sender ( alice ) , analyzes and saves the measurement outcome .",
    "immediately after , eve sends a tailored light pulse onwards to the legitimate receiver ( bob ) .",
    "thereby , eve has full knowledge on the legitimate connection of alice and bob .",
    "since bob s detector confuses the received pulse with a single - photon click , nothing indicates an intrusion into the key distribution scheme .",
    "most security proofs do not cover this intrusion mechanism , since is acts on a classical part of single - photon detection .",
    "the latter are represented by electrical pulses , which we name `` clicks '' through the paper .    in this paper",
    ", we provide a detailed technical description of a universal detector control unit .",
    "this device was used to influence the outcome of several experiments  @xcite .",
    "several ways to characterize the fidelity of control of a targeted system are described .",
    "the unit can be used to launch pulses into a variety of quantum - optical measurement setups .",
    "the system was designed to perform the entire optical and electronic control , and tp be compact and portable ( @xmath0 ) .",
    "therefore , the unit can be used at different setups on - site .",
    "to detect single photons , an apd is operated in geiger mode , biased at a voltage slightly below the breakdown voltage with no illumination .",
    "an avalanche breakdown happens when an electron - hole pair , which is created by an absorbed photon , multiplies . during avalanche ,",
    "macroscopic currents flows through the apd .",
    "when these currents exceeds a comparator threshold , an electrical pulse is produced at the detector output .",
    "afterwards , the voltage across the apd is reduced below the breakdown voltage , to stop the avalanche  @xcite .",
    "this so - called quenching can be introduced by various methods : active quenching reduces the bias voltage , passive quenching utilizes the finite recharge time of the device itself , and gating the apds reduces the voltage periodically . during quenching",
    ", the apd is converted into a classical linear detector , i.e. , the current through the apd depends linearly on the incident optical power  @xcite .",
    "after quenching , the voltage across the apd recovers back to the bias voltage , and the detector becomes ready for signaling the next photon .",
    "s        in a typical single - photon detector , the click rate increases linearly up to saturation ( at sometimes up to several million clicks per second ) as the number of incident photons per second is increased .",
    "if the input number of photons is increased above saturation , the electrical response decays quickly . although the amount of incident light is increased .",
    "the basic reason for this is that the apd is no longer sensitive to single photons as in the linear regime .",
    "powerful illumination can suppress the apd s voltage below the breakdown voltage , since there is no full recovery between individual photons .",
    "after a certain threshold blinding power @xmath1 , the detector falls completely silent , since the avalanches become too small to exceed the comparator threshold . for an experimental response function of a single photon counting avalanche photo diode",
    ", please refer to fig .",
    "[ fig : detresp ] .",
    "several methods have been demonstrated to launch a click in such a `` blinded '' detector  @xcite .",
    "a simple method to launch a single click is to temporarily reduce the incident light power from above @xmath1 to zero  @xcite .",
    "the detector recovers some sensitivity , and interprets the subsequent rise of illumination back to above @xmath1 as a single - photon detection event .",
    "another method , mostly used in this paper , is to constantly illuminate the detector by a power above @xmath1 , and to apply a short much brighter pulse .",
    "this causes an additional photocurrent in the linear mode , which is sufficient to cross the comparator threshold and to produce a click  @xcite .",
    "in addition to apds , snspds have also been used in modern qkd setups .",
    "snspds can be controlled in a very similar way  @xcite .",
    "our detector control apparatus can be easily adjusted to be applied to a qkd setup based on snspds .",
    "tilted basis ( @xmath2 ) .",
    "( b ) when the detector receives a linear input polarization , the light is distributed unequally among the detectors .",
    "( c ) ideally , under attack the click probability should reach 100% for each targeted detector and vanish for untargeted detectors .",
    "( d ) the implemented attack uses the so - called faked - state scheme . in this scheme ,",
    "the eavesdropper ( eve ) detects the photon with a device bob@xmath3 similar to the legitimate receiver ( bob ) , then sends a _ faked state _ onwards to the latter .",
    "the faked state can generate the identity matrix ( c ) or any other matrix at bob , at the eavesdropper s will .",
    "fsg , faked - state generator ; bs , beamsplitter ; pbs , polarizing beamsplitter ; hwp , half - wave plate rotated at @xmath4 angle . ]",
    "one question prior to the development of the control apparatus was whether a real detection apparatus , practically used in qkd , can be fully controlled . a typical detection apparatus , known as polarization analyzer  @xcite , is shown in fig .  [ fig : polana](a ) .",
    "it contains four single - photon detectors , each of which detects photons with one of the four polarization orientations  @xcite ( see inset in fig .  [",
    "fig : polana](a ) ) .",
    "when a faked state is sent , at a certain detector , also the other three might click with different probabilities , since they might receive a certain amount of light from the control setup .",
    "the exact amount of incident power on each detector depends on the incoming polarization . to target only one detector ,",
    "it is possible to send only a distinct linear polarization , such that only one detector sees 50% of the incoming light . in the other basis , rotated by @xmath2 , each of the two detectors receives 25% of the light .",
    "the fourth detector is orthogonally oriented to the incoming light , such that ideally , it does not receive any light ( see fig .  [",
    "fig : polana](b ) for a distribution of powers ) .",
    "the overall control efficiencies can be represented by a matrix of probabilities .",
    "an ideal control method corresponds to an identity matrix ( fig .",
    "[ fig : polana](c ) ) .",
    "this produces a click with unity probability at the target detector while keeping the other three detectors in the same row silent .",
    "if we just send a very bright pulse below @xmath1 for all the detectors , we will produce a matrix filled with 100% for all values .",
    "this is simply because all detectors are in the linear detection regime and will click with high probability under illumination below @xmath1 .",
    "the exact power and polarization of light sent from the setup should be finely adjusted , in order to meet the following requirements : to hit the correct detector , to launch a click with ( ideally ) 100% efficiency , and not introduce any double - clicks , such as firing an unwanted detector .",
    "subsequently , the power has to be higher than a certain threshold to launch a click in a blinded detector . for low incident powers",
    ", the success rate at the target detector will be lower than unity .",
    "this might be interpreted as a virtual optical loss of the connection .",
    "a lower success rate can always happen and is usually compensated by the qkd setup under attack . if the incident power is too high , an unwanted detector might be launched simultaneously as the targeted one , which results in a double click at the receiver . for security reasons in qkd",
    ", this has to be treated by replacing the double click with a random bit value  @xcite .",
    "thereby , an unknown bitflip in the resulting key string is introduced .",
    "subsequently , the knowledge of the eavesdropper becomes less than perfect , hampering her ability to decode the final key . to reliably realize the attack ,",
    "the introduction of double clicks must be strictly avoided .",
    "the faked - state attack can be implemented , if the response matrix is sufficiently close to an identity matrix .",
    "the eavesdropper ( eve ) analyzes the single photons sent by the legitimate sender ( alice ) and sends a tailored light pulse onwards to the legitimate receiver ( bob ) ( see fig .",
    "[ fig : polana](d ) ) . since",
    "eve and bob share the same detection events , eve has the full knowledge of the secret key , when deducing valid events from public channel information .",
    "the scheme described above allows the influence very general quantum - optical experiments .",
    "this setup may not only be used just to attack qkd schemes , but also addresses several tests of bell s inequality  @xcite .",
    "we set the requirements for the device to build as follows , to be universal in the choice of the attack : the blinding power has to be controllable to blind all detectors at desired levels .",
    "further , by applying light pulses both before and after the desired click time , it is possible to achieve a significant degree of control for each detector ( as will be explained in secti n  [ sec : control - diagrams ] ) .",
    "the implementation described below requires 9 lasers in total : one for the blinding power , keeping all detectors silent , and four times two lasers to target each detector .",
    "the device has to be fully programmable and also fast in terms of propagation delay and jitter .",
    "the optical design of the control apparatus is shown in fig .  [",
    "fig : optics ] .",
    "it is entirely based on laser diodes as light sources .",
    "the apparatus was built with fiber - based optics to resist disturbances from the environment and drifts for long - time data acquisitions .",
    "this is required for long - time experiments .",
    "each laser diode only produces one optical pulse per control event , and the relative power level for the diodes is not changed .",
    "the diodes are either _ on _ or _",
    "off _ , driven directly by electronic pulses .",
    "this allows for a high driving speed and for a simple electronic driving circuit .",
    "the details of the electronic driver are discussed later .",
    "the coupling of the diodes is adapted , or variable optical attenuators are used , to change the required power levels .",
    "all pulses are combined by fiber beamsplitters to form a control pattern .",
    "all laser diodes are single transverse mode diodes and the output light of the setup can be a mixture of differently polarized pulses .    for a certain qkd system  @xcite , we chose the most powerful available single - mode laser diode ( sanyo dl-8141 - 002 ) at the wavelength of 808  nm .",
    "the light produced by the laser diodes is coupled into single - mode fibers by means of a compact diode - to - fiber coupler ( oz optics ) , equipped with a built - in variable attenuator .",
    "the light passes polarization controllers ( oz optics ) and is combined by means of fiber beam - splitters .",
    "the fiber polarization controllers allow for changing the relative polarization states . for a speficic experimental configuration , a fiber polarization controller at the optical output",
    "allows to target an arbitrarily aligned detector .",
    "the coupling efficiency from the diode to fiber reaches up to 60% .",
    "considering the losses through the fiber path ( insertion loss , connector loss and coupling loss of fiber beamsplitters ) , the overall efficiency throughout the system is about 6% .",
    "the laser diodes have a nominal output power of 200  mw .",
    "a maximal power of 12  mw can be achieved at the fiber output of the setup .",
    "this is orders of magnitude higher than the specified detection range of the single - photon detectors , and much higher than the required blinding power for the single - photon detectors .",
    "this allows to compensate for losses in the transmission line to the target detector .",
    "higher output peak - powers can be reached by reducing the number of laser diodes and fiber beamsplitters in the setup .",
    "the overall optical design is based on the combination of nine laser diodes . a single diode , which delivers circularly polarized light , can be used to blind all detectors simultaneously . for convenience ,",
    "this diode was equipped with a digital variable attenuator ( oz optics da-100 ) .",
    "this allows for fast change of the power level and can be used for alignment .",
    "four diodes deliver linear polarization from the pre - pulse generator ( ppg ) , which allows for an increased blinding power targeted to any three out of the four detectors .",
    "the click - launch generator ( clg ) is intended to launch the clicks in the targeted detector .",
    "it is formed by another set of four laser diodes , which deliver linear polarization .",
    "this allows for maximum flexibility of the control pattern to target the detectors ( see section  [ sec : control - diagrams ] ) .     interference filter ( if ) .",
    "( b ) for long - distance experiments , the system was fiber - coupled with single - mode fiber ( smf).,width=302 ]    initially , the experiment was carried out in the lab with @xmath5 free - space separation between eve and bob ( fig .",
    "[ fig : experiment](a ) ) .",
    "it was possible to influence the targeted single - photon detectors in the desired way .",
    "however , for long - distance experiments , the coupling efficiency of light from eve to bob would be lower and we would need more powerful laser diodes , which were not easily available at the time of our study .    the main experiment was carried out via a @xmath6 long single - mode fiber ( see fig .  [",
    "fig : experiment](b ) )  @xcite . before the experiment started , the control diagram shown in fig .",
    "[ fig : ctrldiag](c ) was obtained by a precise tuning .",
    "the experiment lasted for about @xmath7 overnight .",
    "the alignment had been maintained and no significant drift was observed .",
    "the electronics was designed to form faked states that have certain sequence of light powers and polarizations , which can be eventually field - adjustable .",
    "we call this sequence a _ control diagram . _",
    "the optical pulses are formed in response to the signal received by a copy of the legitimate receiver unit ( bob@xmath3 , see fig .",
    "[ fig : polana](d ) ) .",
    "the electronic circuit was built to allow for different control diagrams ( different pre- and click - launch pulses ) and for precise timing .",
    "the latter is required since many qkd protocols rely on a precise timing between the legitimate sender and the legitimate receiver , which should be preserved in the presence of an eavesdropper .",
    "the electronics has to be able to compensate for different detector time delays and the internal optical propagation delay in the optics part .",
    "further , the electronic circuit has to trigger the internal time - stamping of the eavesdropper , which is done by recording the click - launch pulses sent onwards to bob . depending on the exact qkd protocol",
    ", it might occur that the eavesdropper receives more clicks than can be sent onwards .",
    "two similar electronic circuits were built for the ppg and the clg .",
    "for highest possible flexibility , these included a programmable logic element .",
    "an external delay generator ( highland technology p400 ) was used for different longer time - delays , such as setting the laser pulse lengths .    each of these custom - built circuits ( see fig .  [",
    "fig : circuitry ] ) consists of 4 independent input channels and a dedicated reset line .",
    "the input signals from the detector have nuclear instrumentation ( nim ) logic levels , @xmath8 and @xmath9 into a @xmath10 load . at the input ,",
    "they are converted to emitter - coupled logic ( ecl ) levels , @xmath11 and @xmath12 by a transistor ( bfr93 ) and a differential receiver ( mc100el16 ) .",
    "the resulting ecl signals are combined on a logic or element ( mc100el01 ) and launch a trigger pulse _",
    "trig _ for an external delay generator .",
    "tunable delay stages ( trimmer - adjustable one - shot triggers ) are used to compensate different arrival timing of pulses from the different channels .",
    "the ecl signals are converted into transistor - transistor logic ( ttl ) levels by a converter ( mc100h603 ) , and processed by a generic array logic ( gal ) integrated circuit ( gal16v8 ) .",
    "the gal is programmed to produce a rising edge on the desired channel and to produce a falling edge by the reset line , triggered by the external delay generator .",
    "the function of the circuit can be easily modified by using differently programmed gals .",
    "the external delay generator defines the output pulse width with sub - nanosecond precision by activating the _ reset _ line .",
    "the pulses produced by the gal are buffered and amplified with a complementary metal - oxide - semiconductor ( cmos ) line driver ( 74act11004 ) , which directly drives the laser diodes via small current - limiting resistors .",
    "the design for this control circuit was partly derived from ref .  .",
    "in our experiment , one of the circuits described above takes the input from the receiver unit bob@xmath3 , and its output drives the laser diodes in the ppg ( fig .",
    "[ fig : electronics ] ) .",
    "the second circuit is cascaded to the first one and receives its input from the gal in the first circuit .",
    "this circuit drives the clg .",
    "the delay generator is triggered by the first circuit and sets both the pulse width of the ppg and the pulse delay and width of the clg .",
    "for recording the actual faked states , the time - stamp unit ts of the eavesdropper is attached to the output of the first circuit .",
    "this ensures that only events that are actually sent onwards are recorded . since the optical design of the ppg and the clg is equal , it was possible to run all control diagrams discussed in the next section with the above described optical and electronic configuration .",
    "just the gal was reprogrammed .",
    "the ppg was used as the only source to generate pulses , for simple control diagrams with only one optical pulse per received click , such that it was used as a clg .",
    "the constructed device allowed for different control schemes of single - photon detectors .",
    "initially , it was unclear if an unwanted cross - talk between multiple detectors on different polarizations leads to accidental clicks . for simplicity ,",
    "some of our experiments were conducted with simple protocols ( such as described in ref .",
    "further refinements of the control diagram allowed to reach higher efficiencies and to reduce the number of accidental clicks in the case of a slight misalignment . these more robust protocols were used in our experiment , in which we conduct an attack on qkd that was carried out partially outdoors  @xcite .",
    "it led to eavesdropping the entire secret key . in total , three control diagrams have been characterized .",
    "the protocols are described below .",
    "[ [ diagram1 ] ] diagram  1 : + + + + + + + + + +    the first control diagram was proposed earlier  @xcite .",
    "all four detectors are blinded by constant illumination of mixed linear polarizations from 4 lasers .",
    "a click at the target detector is realized by introducing a temporal gap .",
    "the polarization of illumination corresponds to the orthogonal - basis detector ( only the corresponding laser is kept on , while the other three are switched off ) , see fig .",
    "[ fig : ctrldiag](a ) .",
    "the power is adjusted to a level where the detectors in the conjugate basis are kept blinded . at the end of the gap , only the target detector recovers sensitivity and clicks when the power is restored , while the other three remain silent .",
    "the click probability at the target detector with a gap of 600  ns is only 5283% ( fig .",
    "[ fig : ctrldiag](a ) ) .",
    "this lack of efficiency is not a problem , since the reduced efficiency would be interpreted as an additional optical loss in the qkd experiment and would be simply reducing the bitrate .",
    "this control diagram was employed in the study of non - physical bell tests  @xcite .",
    "since this diagram is targeting passively - quenched apds , the timing relates to the recovery time of the apd response .",
    "this time is approximately @xmath13 .",
    "the click efficiency is forming a sigmoidal curve , which starts at zero for gap - times below 300400  ns , and which reaches up to unity , when the gap - time is increased above microseconds .",
    "minimally four laser diodes and one of the aforementioned circuits are required for this protocol .",
    "a more powerful control diagram is proposed below , attempting to overcome the two disadvantages of diagram  1 : low click probability and long gap - time .",
    "[ [ diagram2 ] ] diagram  2 : + + + + + + + + + +    all four detectors are blinded by constant illumination with circular polarization .",
    "a click is launched at the target detector by a very bright ( mw range ) polarized pulse instead of a timing gap ( see fig .  [",
    "fig : ctrldiag](b ) ) .",
    "the power of the pulse is adjusted to not launch the other three detectors .",
    "some unwanted clicks still existed in practice , as illustrated by the small off - diagonal elements in the matrix .",
    "the main reason is that the four detectors do not necessarily have identical optical and electrical characteristics .",
    "this diagram is significantly more compact in time than diagram  1 .",
    "the requirements for this diagram are five laser diodes and one control circuit .",
    "[ [ diagram3 ] ] diagram  3 : + + + + + + + + + +    to eliminate unwanted clicks , a pre - pulse polarized orthogonally in respect to the target detector is introduced @xmath14 before the click - launch pulse ( fig .",
    "[ fig : ctrldiag](c ) ) .",
    "this blinds the non - target detectors deeper and makes it more difficult to be launched by the main pulse .",
    "the deeper blinding occurs via reducing the voltage across the apd much lower than strictly necessary for blinding . at low voltages ,",
    "the apd has smaller finite multiplication gain than when biased just below its breakdown voltage .",
    "the off - diagonal elements in the matrix are eliminated .",
    "although the click probability at the target detector is slightly lower than 100% , the eavesdropper can still get full information on the key by listening to the key sifting procedure during classical communication part of the qkd protocol .",
    "this control diagram is the final implementation to our eavesdropper setup . for this diagram , nine laser diodes and the full electronic scheme as shown in fig .",
    "[ fig : electronics ] are required .",
    "further control diagrams are feasible with the presented setup .",
    "all diagrams rely on either switching off a laser for a given detector or increasing the power significantly .",
    "the remaining detectors see less laser power than the targeted one . to allow for an even higher efficiency in unfavorable conditions",
    ", it might be possible to increase the blinding power further before an actual click - launch event .",
    "this might be analyzed in further studies .      in order to achieve good control of bob s detectors , polarizations and powers of eve s lasers",
    "have to be individually adjusted for each particular receiving unit .",
    "the alignment procedure is carried out as three steps : first , the circular blinding power is adjusted .",
    "then , the pre- and later the click - launch pulses are aligned . to emulate a copy of the detector unit ( bob@xmath3 ) ,",
    "a simple pulse generator at a frequency of 10  khz was used , producing 15  ns wide pulses similar to detector output pulses .",
    "there is a waiting time of @xmath15 between consecutive pulses , which is a relaxed condition comparing to what a real bob@xmath3 can output ( as further discussed below ) .",
    "the goal is to implement the aforementioned diagram  3 . for alignment of the circularly polarized blinding power ,",
    "the blinding diode is turned on in continuous - wave mode .",
    "it is ensured that all apds are blinded by adjusting the electronic controllable attenuation .",
    "the alignment is complicated by the unequal blinding characteristics of bob s apds .",
    "a better control is obtained by distributing blinding light unevenly before them .",
    "this can be achieved by a slightly elliptical polarization .",
    "the polarization is adjusted by monitoring bob s count rates in the linear , unsaturated regime , below @xmath1 .",
    "only the targeted detector should be launched at 100% efficiency .",
    "this task could not be achieved with only one circularly ( or slightly elliptically ) polarized blinding light . ideally , the blinding power is set to a reasonable level , such that the unbalance of four apds can be compensated most .",
    "then , a unity matrix can be achieved after introducing pre - pulses .",
    "we introduce the alignment for diagram  2 described in the following paragraphs . the blinding power is found based on measurements of diagram  2 , as shown in fig .",
    "[ fig : perfoc ] .",
    "it is instead required to align the click - launch pulses right after setting the blinding power for the simpler structured diagram  2 . in fig .",
    "[ fig : perfoc ] , the blinding power is displayed against the peak - power of the click - launch pulse for each of the three detectors which receive a part of the incident power ( see fig .",
    "[ fig : polana ] ) .",
    "the fourth detector does not receive any light and will remain silent throughout the experiment .",
    "for each of the three illuminated detectors the threshold of silence ( labeled as 0% ) is displayed .",
    "for the targeted detector , we also introduced a curve , which shows when the detector is fired with unity probability ( labeled as 100% ) .",
    "the alignment has to ensure , that only the targeted one is launched with 100% efficiency , while the others remain silent .",
    "we have to align both the circular blinding power and the peak - power . for both settings",
    ", there is an optimal point .",
    "the windows between the power for reaching unity click efficienty and silent other detectors should be large .",
    "this equals a blinding power of around 10@xmath16  w for the displayed situations .",
    "see fig .",
    "[ fig : perfoc](a ) as an example .",
    "this ensures the stability of the apparatus , also for slight changes in the optical alignment . in fig .",
    "[ fig : perfoc](d ) , the main problem of diagram  2 becomes evident : there is no such window .",
    "this is likely due to variation in individual apd s characteristics . due to the lack of such a window , it is impossible to reach an optimal alignment with unity click - efficiency for the targeted detector .",
    "if we increase the click efficiency , we will introduce cross - talk to other detectors .",
    "this can be avoided by using pre - pulses .",
    "after setting the blinding power , it is required to set the pre - pulse level .",
    "these pre - pulses are used to decrease the sensitivity against further illumination .",
    "it is important that the pre - pulses do not launch clicks on their own . during adjustment ,",
    "the power of pre - pulses is increased until they start launching clicks in some of the detectors .",
    "subsequently , their level is slightly reduced .    to generate a click in diagram  3",
    ", it is required to have additional pulses to actually launch a click in the targeted detector .",
    "these pulses were generally very powerful ( tens of mw ) and the pulse powers were adjusted as a final alignment step . for a 10  khz excitation rate with a pulse generator , the power is increased until clicks were received on the targeted detector .",
    "the power is further increased to reach an efficiency of unity . in most cases with diagram  3",
    "this is sufficient to reach a diagonal matrix with unity click efficiency , since the power level of blinding light and pre - pulses have already been adjusted .",
    "a cross - talk between adjacent pulses led to slightly less than 100% click probability in the measured matrix .",
    "the alignment was accomplished by inserting eve into the fiber line before attack and manually calibrating her polarizations and power levels to match bob s detector settings .",
    "the calibration only requires that the transmission on the classical channel is public , which is one of the basic assumptions of qkd .",
    "the stability has been proven by the fact that the alignment kept steady for @xmath1712 hours in an overnight experiment . to be more robust",
    ", this alignment procedure could be automated and implemented in a non - obtrusive way when the link is constantly running  @xcite .",
    "the introduction of an eavesdropper into a quantum cryptographic connection will also affect the timing between the two communicating parties .",
    "it is required that alice and bob have a common clock .",
    "this is commonly realized by an external timing reference e.g. from the global positioning system , or by atomic clocks . in the system under attack ,",
    "the timing is servoed over the joint detection events .",
    "these originate from the accurate timing of the entangled photons used for qkd protocol .",
    "it is not required to have an atomic time reference for initial negotiation  @xcite . in the following",
    "we will discuss timing issues between the communication partners and the disturbance introduced by an eavesdropper .",
    "insertion delay of the eavesdropper is an important change in the communication protocol . for our system , we measured insertion delay of about @xmath18 ( see fig .",
    "[ fig : delay ] ) .",
    "its main sources are the pulse length of the required laser pre - pulses and the electronic and optical propagation delay in the system .",
    "it is possible to compensate for this insertion delay . as a lower limit it is evident that the detection event of bob@xmath3 has to be long enough to trigger an electronic circuit to drive the laser diodes .",
    "an additional delay will be introduced by the population inversion build - up time of the semiconductor laser diode . for the laser pulses , the circuit described in this paper",
    "is designed to fully turn the diodes on and off .",
    "it will be faster to drive the diode from just below the lasing threshold to above the lasing threshold , as commonly done in telecommunication transmitters .",
    "we estimate a lower limit for a delay of the eavesdropper to be within @xmath19@xmath20 .",
    "this assumes normal off - the - shelf available electronic components and laser diodes . it would be possible to shortcut a part of the communication line with free - space line - of - sight radio - frequency or an optical link for fiber based system  @xcite .",
    "the propagation delay in such link is @xmath21 times shorter than in optical fiber of equal length .",
    "this would not help in case of a free - space qkd system .    in an ideal case ,",
    "all four photodiodes in the legitimate detector unit have the same optical and electrical delay , however in practice the delays are not the same and have to be compensated in software post - processing  @xcite .",
    "changes in these relative delays between different detector combinations alice  bob are another possible signature of eve s presence . by careful adjustment of the tunable delay stages in eve s electronics ,",
    "these relative delays were kept unchanged ( as evident in fig .",
    "[ fig : delay ] ) .",
    "each detector has a distinct deadtime after click , during which it is not single - photon sensitive , since the voltage level is below the detection threshold and the pulse - discriminator has just fired . besides this",
    ", the deadtime might also be influenced by other detector channels , because of limitations of bob s click registration system ( cross - channel effect ) .",
    "the introduction of an eavesdropper has varied these deadtimes ( see fig .  [",
    "fig : deadtime ] ) .",
    "for a detector unit , the pulses _ for different detectors _ have a very short time - delay of @xmath22 .",
    "this is the lower limit , given by the deadtime of the time - stamp unit used for these experiments .",
    "we have artificially introduced @xmath23 deadtime , to reduce uneven responsivity of detectors recovering from the previous launch- and pre - pulses .",
    "for the _ same detector _ , the deadtime is @xmath24 , simply introduced by the recovery of the apds responsivity to the trigger pulse .",
    "since the apparatus is targeting qkd systems , the question arises if such an intrusion event can be detected by bob , or even by alice in the qkd communication .",
    "the demonstrated attack is well - documented and several countermeasures are evident . it might be possible to obscure all countermeasures by smarter attack design .",
    "a variety of attacks into qkd connections exist already . by _ not _ detecting the below mentioned side - effects it _ can not _ be guaranteed that the connection is secure .",
    "since we introduce a bright - light source to blind the detector efficiently , it will be possible to detect the blinding light directly with an additional photodiode in the polarization detector and only allow for single - photon counting if the background light level allows for single - photon counting .",
    "also , the current drawn by the apd power supply will be increased , since the diode voltage level is constantly reduced , such that the system would draw more current . in this sense",
    ", a simple current monitor might be sufficient to detect this intrusion .",
    "an eavesdropper with own pulse - shaping ( a few hundred ns ) and electrical delay ( a few hundred ns ) will introduce a few hundred ns delay between alice and bob .",
    "depending on the exact configuration , it can be possible to measure , e.g. , the distance between the legitimate communicating parties , and allow only for a tight ranges of transfer delay",
    ". an eavesdropper would exceed this bound and the connection would be regarded as insecure . in the qkd system we attacked , the exact time synchronization is servoed over the detection events . only for initial synchronization two external referenced clocks were used . by carefully introducing longer and longer delays , it might be possible to keep the connection up and running and introduce the eavesdropper",
    ".    relative timing between alice and bob has a certain jitter .",
    "an eavesdropper should seek not to change the present jitter too much .",
    "eve s fsg and the response of the legitimate detector unit to eve s control constitute an additional source of jitter under attack .",
    "this jitter may or may not be smaller than detector s intrinsic jitter in the single - photon detection regime . in the case of the qkd system we tested ,",
    "bob s jitter under control was much lower , down to @xmath25 full width at half maximum ( fwhm ) , than its intrinsic single - photon detection jitter of @xmath26 fwhm .",
    "( we remark that the reduction of jitter under control has also been observed in snspds  @xcite . )",
    "the system we tested had @xmath27 fwhm jitter averaged over all cross - correlations under normal operation without the presence of the eavesdropper , while with the eavesdropper it increased to @xmath28 fwhm ( fig .",
    "[ fig : delay ] ) .",
    "the difference is at the lower limit of detectability .",
    "note that the eavesdropper might compensate the increased jitter by reducing the jitter of her own detectors .    in the above design ,",
    "it is evident that the legitimate detector unit ( bob ) will not receive any double clicks on different detectors .",
    "this is also the case for clicks that have a very short time delay between different polarization bases .",
    "only one pulse will be given out per detection event and the pulse length ( @xmath29 in case of diagram  3 ) is an effective deadtime . if the qkd system used a time - stamp unit with no or reduced inter - channel deadtime , it would be possible to observe a modified photon statistics in the presence of an eavesdropper .",
    "this holds especially for entanglement - based qkd schemes , but is not an issue with prepare and send schemes such as bb84 with a low clock rate . in further versions of this apparatus",
    ", it will be possible to trigger any photon pattern on a target detector .",
    "this requires more laser diodes and a more sophisticated electronic .",
    "the optical fine - tuning is conducted such that we reach a diagonal blinding matrix with unity click efficiency .",
    "if the eavesdropper is very close to the sending unit , the optical loss between them might be very low .",
    "this would result in a detection rate of bob@xmath3 exceeding bob s usual rate . in the actual experiment ,",
    "it is required to reduce the coupling efficiency on the incoming side of the eavesdropper , such that the bitrate is matching with the situation without an eavesdropper .",
    "similarly , there is a problem , if there is a slight mismatch of detector efficiencies at the legitimate receiver . in the attack scenario of an eavesdropper generating faked states ,",
    "any mismatch is hidden by the unity click efficiency .",
    "subsequently , any mismatch in eavesdropper s copy of the legitimate receiver unit is replicated onto bob s detectors .",
    "this might introduce statistical fingerprints , which might be evident to alice and bob .",
    "the intermediate position of an eavesdropper might also be deducted when the apd detection flashback is analyzed .",
    "an ideal photodiode would not emit any light when it is fired , but in realistic devices , apds emit a small flash , when receiving a photon and launching a click  @xcite . if the receiving unit of the eavesdropper is closer than the legitimate receiver unit , alice might receive a flashback from eve s detection events",
    ". this event will be earlier detectable than with the legitimate detector unit of bob .    by the countermeasures mentioned above",
    ", it is relatively simple to detect eavesdropping by different measures . in many implementations of qkd the countermeasures discussed",
    "are not implemented and as a consequence they may be vulnerable to the types of attack demonstrated in the paper . and",
    "even if all the above countermeasures are introduced , there might be other ways of intruding into such systems .",
    "an alternative approach to solving detector vulnerability problems is to employ device - independent heralded qubit amplifier  @xcite or measurement - device - independent  @xcite qkd protocols .",
    "once these have been fully implemented , our intrusion will face strong challenges , since the security will no longer rely on properties of single - photon detectors .",
    "in this paper we have described a technical apparatus for control of various single - photon polarization analyzers , not only attacking qkd schemes , but also influencing very general quantum - optical experiments , e.g. , tests of bell s inequality .",
    "it was successfully used to control the outcome of passively - quenched single - photon detectors in several experiments  @xcite . for polarization - encoded qubits , such as in qkd",
    ", it was possible to target a single detector while keeping the other detectors silent .",
    "the design goal was to optimize the click probability to unity and to reduce the cross - talk to the other detectors to zero .",
    "we further discussed how an optimal alignment can be reached , and possible side effects of the attack .    in future studies , this apparatus will allow to study the saturation behavior and linearity of various photodetectors , test countermeasures to detector control attacks and hacking - resistant qkd schemes .",
    "the photodetector active control system developed provides power outputs of up to @xmath30 for each receiver element .",
    "this provides sufficient flexibility for testing photodetectors with a wide range of response characteristics .",
    "this work was supported by the national research foundation and the ministry of education , singapore , and the research council of norway ( grant no .",
    "180439/v30 ) .",
    "thanks industry canada for later support .",
    "i.g .  thanks j.  wrachtrup for continuous support .",
    "25ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1088/1367 - 2630/11/6/065003 [ * * ,   ( ) ] link:\\doibase    10.1364/oe.19.023590 [ * * ,   ( ) ] link:\\doibase    10.1038/nphoton.2010.214 [ * * ,   ( ) ] link:\\doibase    10.1364/oe.18.027938 [ * * ,   ( ) ] link:\\doibase 10.1088/1367 - 2630/13/11/113042 [ * * ,   ( ) ] @noop   link:\\doibase    10.1038/ncomms1348 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.107.170404 [ * * ,   ( ) ] link:\\doibase 10.1080/09500340410001730986 [ * * ,   ( ) ] link:\\doibase    10.1080/09500340408235272 [ * * ,   ( ) ] link:\\doibase 10.1080/09500349414552281 [ * * ,   ( ) ] link:\\doibase    10.1038/419450a [ * * ,   ( ) ] link:\\doibase    10.1117/12.483036 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.59.3301 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.78.032302 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2348775 [ * * , ( ) ] link:\\doibase    10.1103/physreva.78.020301 [ * * ,   ( ) ] link:\\doibase    10.1088/1367 - 2630/11/4/045007 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2149007 [ * * ,   ( ) ] link:\\doibase 10.1088/1367 - 2630/11/4/045011 [ * * , ( ) ] link:\\doibase 10.1364/oe.15.009388 [ * * , ( ) ] link:\\doibase    10.1080/09500340108240905 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.105.070501 [ * * ,   ( ) ] link:\\doibase 10.1038/nphys2469 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.108.130503 [ * * ,   ( ) ] @noop"
  ],
  "abstract_text": [
    "<S> the influence of bright light on a single - photon detector has been described in a number of recent publications . </S>",
    "<S> the impact on quantum key distribution ( qkd ) is important , and several hacking experiments have been tailored to fully control single - photon detectors . </S>",
    "<S> special attention has been given to avoid introducing further errors into a qkd system . </S>",
    "<S> we describe the design and technical details of an apparatus which allows to attack a quantum - cryptographic connection . </S>",
    "<S> this device is capable of controlling free - space and fiber - based systems and of minimizing unwanted clicks in the system . with different control diagrams , we are able to achieve a different level of control . </S>",
    "<S> the control was initially targeted to the systems using bb84 protocol , with polarization encoding and basis switching using beamsplitters , but could be extended to other types of systems . </S>",
    "<S> we further outline how to characterize the quality of active control of single - photon detectors . </S>"
  ]
}