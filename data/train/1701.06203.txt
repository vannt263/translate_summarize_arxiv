{
  "article_text": [
    "this article makes a survey of the main issues in optimal control theory , with a specific focus on numerical solution methods and applications to aerospace problems .",
    "the purpose is to show how to address optimal control problems using modern techniques of geometric optimal control and how to build solution algorithms based on continuation techniques .",
    "the geometric optimal control ( stated in the early 1980s and having widely demonstrated its advantages over the classical theory of the 1960s ) and the continuation techniques ( which are not new , but have been somewhat neglected until recently in optimal control ) are powerful approaches for aerospace applications .",
    "as motivation , an overview of optimal control problems raised by aerospace missions is first presented .",
    "these problems are classified in three categories depending on the departure and the arrival point .",
    "the interested reader will thus have a general view on how space transportation missions translate into optimal control problems .",
    "a detailed example is then presented to illustrate the application of geometric optimal control techniques and numerical continuation methods on a practical problem .",
    "this example deals with a minimum time maneuver of a coupled attitude - trajectory dynamic system . due to the system high nonlinearity and the existence of a chattering phenomenon ( see sections [ chatphenom ] and [ fullexample ] for details ) , the standard techniques of optimal control do not provide adequate solutions to this problem . through this example",
    ", we will show step by step how to build efficient numerical procedures with the help of theoretical results obtained by applying geometric optimal control techniques .    before this example",
    ", we will recall briefly the main techniques of optimal control theory , including the pontryagin maximum principle , the first - order and higher order optimality conditions , the associated numerical methods , and the numerical continuation principles .",
    "most mathematical notions presented here are known by many readers , and can be skipped at the first reading .    in section [ sec_appliaero ] ,",
    "several optimal control problems stemming from various aerospace missions are systematically introduced . in section [ sec_gocr ] ,",
    "we provide a brief survey of geometric optimal control , including the use of lie and poisson brackets with first and higher order optimality conditions . in section [ sec_nmoc ] , we recall classical numerical methods for optimal control problems , namely indirect and direct methods . in section [ sec_cm ] , we recall the concept of continuation methods , which help overcoming the initialization issue for indirect methods . in section [ fullexample ] ,",
    "we detail a full nonacademic example in aerospace , in order to illustrate how to solve optimal control problems with the help of geometric optimal control theory and the continuation methods .",
    "finally in section [ sec_ato ] , we shortly give other applications of geometric optimal control and of continuation for space trajectory optimization problems .",
    "transport in space gives rise to a large range of problems that can be addressed by optimal control and mathematical programming techniques .",
    "three kinds of problems can be distinguished depending on the departure and the arrival point : ascent from the earth ground to an orbit , reentry from an orbit to the earth ground ( or to another body of the solar system ) , transfer from an orbit to another one . a space mission is generally composed of successive ascent , transfer and reentry phases , whose features are presented in the following paragraphs .",
    "ascent missions necessitate huge propellant masses to reach the orbital velocity and deliver large payloads such as telecommunications satellites . due to the large lift - off mass , only chemical rocket engines are able to deliver the required thrust level .",
    "consumption minimization is the main concern for these missions whose time of flight is generally about half an hour .",
    "heavy launchers lift off vertically from a fixed ground launch pad , whereas airborne launchers are released horizontally by an airplane , benefiting thus from a higher initial altitude and an initial subsonic velocity .",
    "the first part of the trajectory occurs in the earth atmosphere at increasing speed .",
    "the large aerodynamics loads met during the atmospheric flight require flying at near zero angle of attack , so that the atmospheric leg is completely driven by the initial conditions . due to the large masses of propellants carried on board , the whole flight must be track by ground radar stations and stringent safety constraints must be applied regarding the area flown over . once in vacuum",
    "the vehicle attitude is no longer constrained and the thrust direction can be freely chosen . when the orbital velocity is reached",
    "the thrust level can be reduced and coast arcs may help sparing propellant to reach the targeted orbit .",
    "figure [ ascenttraj ] gives an overview of the constraints applied to an ascent trajectory .",
    "reentry missions aim at retrieving either experiment results or space crews .",
    "the trajectory is split into a coast arc targeting accurate conditions at the atmospheric entry interface and a gliding atmospheric leg of about half an hour until the landing .",
    "the most stringent constraint comes from the convection flux that grows quickly when entering the dense atmosphere layers at hypersonic speeds .",
    "a near - horizontal flight is mandatory to achieve a progressive braking at limited thermal flux and load factor levels .",
    "the aerodynamic forces are controlled through the vehicle attitude .",
    "the angle of attack modulates the force magnitude and the loads applied to the vehicle .",
    "the bank angle orientates the lift left or right to follow an adequate descent rate and achieve the required downrange and cross - range until the targeted landing site .",
    "the landing may occur vertically in the sea or on the ground , or horizontally on a runway .",
    "depending on the landing options the final braking is achieved by thrusting engines or by parachutes .",
    "if necessary the touchdown may also be damped by airbags or legs , for example for delivering scientific payloads on the mars surface .",
    "the reentry is always the final part of a space mission .",
    "the example of the space shuttle servicing the international space station is pictured on figure [ issreentry ] .",
    "orbital missions deal with orbit changes around the earth and also with interplanetary travels . a major difference with ascent and reentry trajectories",
    "is the much larger duration , which ranges from days to months or even years to reach the farthest planets of the solar system .",
    "the motion is essentially due to the gravity field of the nearest body and possibly of a second one .",
    "the vehicle operational life is limited by its onboard propellant so that all propelled maneuvers must be achieved as economically as possible .",
    "depending on the engine thrust level the maneuvers are modeled either as impulsive velocity changes ( impulsive modelling ) or as short duration boosts ( high thrust modelling ) or as long duration boosts ( low thrust modelling ) .",
    "low thrust engines are particularly attractive due to their high specific impulse , but they require a high electrical power that can not be delivered by onboard batteries .",
    "the energy is provided by large solar panels and the engine must be cut - off when the vehicle enters the earth shadow .",
    "low thrust orbit raising of telecommunication satellites toward the geostationary orbit at 36000 km lead thus to quite complex optimal control problems as pictured on figure [ lowthrust ] .",
    "other orbital transfer problems are the removal of space debris or the rendezvous for orbit servicing .",
    "interplanetary missions raise other difficulties due to the gravity of several attracting bodies . for missions towards the lagrange points ( see figure [ emorbits ] ) the detailed analysis of manifolds in the three body problem can provide very inexpensive transfer solutions",
    ".        for farther solar system travels successive fly - bys around selected planets allow `` free '' velocity gains .",
    "the resulting combinatorial problem with optional intermediate deep space maneuvers is challenging .",
    "the above non exhaustive list gives a preview of various space transportation problems . in all cases",
    "the mission analysis comprises a simulation task and an optimization task ( see figure [ simuoptitasks ] ) .",
    "various formulations and methods are possible regarding these two tasks . selecting an adequate approach is essential in order to build a satisfying numerical solution process .",
    "the simulation task consists in integrating the dynamics differential equations derived from mechanics laws .",
    "the vehicle is generally modeled as a solid body .",
    "the motion combines the translation of the center of gravity defining the trajectory and the body rotation around its center of gravity defining the attitude .",
    "the main forces and torques originate from the gravity field ( always present ) , from the propulsion system ( when switched on ) and possibly from the aerodynamics shape when the vehicle evolves in an atmosphere . in many cases a gravity model including the first zonal term due to the earth flattening is sufficiently accurate at the mission analysis stage .",
    "the aerodynamics is generally modeled by the drag and lift components tabulated versus the mach number and the angle of attack .",
    "the atmosphere parameters ( density , pressure , temperature ) can be represented by an exponential model or tabulated with respect to the altitude .",
    "a higher accuracy may be required on some specific occasions , for example to forecast the possible fall - out of dangerous space debris , to assess correctly low thrust orbital transfers or complex interplanetary space missions .",
    "in such cases the dynamical model must be enhanced to account for effects of smaller magnitudes .",
    "these enhancements include higher order terms of the gravitational field , accurate atmosphere models depending on the season and the geographic position , extended aerodynamic databases , third body attraction , etc , and also other effects such as the solar wind pressure or the magnetic induced forces .",
    "complex dynamical models yield more representative results at the expense of larger computation times . in view of trajectory",
    "optimization purposes the simulation models have to make compromises between accuracy and speed . a usual simplification consists in assuming that the translation and the rotation motions are independent .",
    "with this assumption the trajectory problem ( also called the guidance problem ) and the attitude problem ( also called the control problem ) can be addressed separately .",
    "this uncoupling of the guidance and the control problem is valid either when the torque commands have a negligible effect on the cog motion or when the control time scale is much shorter than the guidance time scale .",
    "most space vehicles fall into one of these two categories .",
    "the main exceptions are atmospheric maneuvering vehicles such as cruise or anti - ballistic missiles and airborne launchers ( see figure [ airbornelaunchers ] ) .",
    "such vehicles have to perform large reorientation maneuvers requiring significant durations .",
    "these maneuvers have a sensible influence of the cog motion and they must be accounted for a realistic trajectory optimization .",
    "another way to speed up the simulation consists in splitting the trajectory into successive sequences using different dynamical models and propagation methods .",
    "ascent or reentry trajectories are thus split into propelled , coast and gliding legs , while interplanetary missions are modeled by patched conics .",
    "each leg is computed with its specific coordinate system and numerical integrator .",
    "usual state vector choices are cartesian coordinates for ascent trajectories , orbital parameters for orbital transfers , spherical coordinate for reentry trajectories .",
    "the reference frame is usually galilean for most applications excepted for the reentry assessment . in this case",
    "an earth rotating frame is more suited to formulate the landing constraints .",
    "the propagation of the dynamics equations may be achieved either by semi - analytical or numerical integrators .",
    "semi - analytical integrators require significant mathematical efforts prior to the implementation and they are specialized to a given modelling .",
    "for example averaging techniques are particularly useful for long time - scale problems , such as low thrust transfers or space debris evolution , in order to provide high speed simulations with good differentiability features . on the other hand numerical integrators",
    "can be applied very directly to any dynamical problem .",
    "an adequate compromise has then to be found between the time - step as large as possible and the error tolerance depending on the desired accuracy .",
    "the dynamics models consider first nominal features of the vehicle and of its environment in order to build a reference mission profile .",
    "since the real flight conditions are never perfectly known , the analysis must also be extended with model uncertainties , first to assess sufficient margins when designing a future vehicle , then to ensure the required success probability and the flight safety when preparing an operational flight .",
    "the desired robustness may be obtained by additional propellant reserves for a launcher , or by reachable landing areas for a reentry glider ( see figure [ dispertraj ] ) .",
    "the optimization task consists in finding the vehicle commands and optionally some design parameters in order to fulfill the mission constraints at the best cost . in most cases ,",
    "the optimization deals only with the path followed by one vehicle . in more complicated cases ,",
    "the optimization must account for moving targets or other vehicles that may be jettisoned parts of the main vehicle .",
    "examples or such missions are debris removal , orbital rendezvous , interplanetary travel or reusable launchers with recovery of the stages after their separation .",
    "a typical reusable launcher mission is pictured on figure [ rlv ] .",
    "the goal is to reach the targeted orbit with the upper stage carrying the payload , while the lower and the upper stage must be recovered safely for the next launches .",
    "this problem necessitates a multi - branch modelling and a coordinated optimization method .        for preliminary design studies ,",
    "the vehicle configuration is not defined .",
    "the optimization has to deal simultaneously with the vehicle design and the trajectory control .",
    "depending on the problem formulation the optimization variables may thus be functions , reals or integers .    in almost all cases",
    "an optimal control problem must be solved to find the vehicle command law along the trajectory . the command aims at changing the magnitude and the direction of the forces applied , namely the thrust and the aerodynamic force .",
    "the attitude time scale is often much shorter than the trajectory time scale so that the attitude control can be considered as nearly perfect , i.e. , instantaneous or with a short response time .",
    "the rotation dynamics is thus not simulated and the command is directly the vehicle attitude .",
    "if the rotation and the translation motions are coupled , the 6 degrees of freedom must be simulated .",
    "the command are then the nozzle or the flap deflections depending on the vehicle control devices .",
    "the choice of the attitude angles depends on the mission dynamics . for a propelled launcher , the motion",
    "is controlled by the thrust force which is nearly aligned with the roll axis .",
    "this axis is orientated by inertial pitch and yaw angles . for a gliding reentry vehicle , the motion",
    "is controlled by the drag and lift forces .",
    "the angle of attack modulates the force magnitude while the bank angle only acts on the lift direction . for orbital maneuvering vehicles , the dynamics",
    "is generally formulated using the orbital parameters evolution , e.g. , by gauss equations , so that attitude angles in the local orbital frame are best suited .",
    "if the trajectory comprises multiple branches or successive flight sequences with dynamics changes and interior point constraints , discontinuities may occur in the optimal command law .",
    "this occurs typically at stage separations and engine ignitions or shutdowns .",
    "the commutation dates between the flight sequences themselves may be part of the optimized variables , as well as other finite dimension parameters , leading to a hybrid optimal control problem .",
    "a further complexity occurs with path constraints relating either to the vehicle design ( e.g. , dynamic pressure or thermal flux levels ) , or to the operations ( e.g. , tracking , safety , lightening ) .",
    "these constraints may be active along some parts of the trajectory , and the junction between constrained and unconstrained arcs may raise theoretical and numerical issues .    the numerical procedures for optimal control problems are usually classified between direct and indirect methods .",
    "direct methods discretize the optimal control problem in order to rewrite it as a nonlinear large scale optimization problem .",
    "the process is straightforward and it can be applied in a systematic manner to any optimal control problem .",
    "new variables or constraints may be added easily . but achieving an accurate solution requires a careful discretization and the convergence may be difficult due to the large number of variables . on the other hand indirect methods are based on the pontryagin maximum principle which gives a set of necessary conditions for a local minimum .",
    "the problem is reduced to a nonlinear system that is generally solved by a shooting method using a newton - like algorithm .",
    "the convergence is fast and accurate , but the method requires both an adequate starting point and a high integration accuracy .",
    "the sensitivity to the initial guess can be lowered by multiple shooting which breaks the trajectory into several legs linked by interface constraints , at the expense of a larger nonlinear system .",
    "the indirect method requires also prior theoretical work for problems with singular solutions or with state constraints . handling these constraints by penalty method",
    "can avoid numerical issues , but yields less optimal solutions .    in some cases",
    "the mission analysis may address discrete variables .",
    "examples of such problems are the removal of space debris by a cleaner vehicle or interplanetary travels with multiple fly - bys . for a debris cleaning mission ( see figure [ debris ] ) the successive targets are moving independently of the vehicle , and the propellant required to go from one target to another depends on the rendezvous dates .",
    "the optimization aims at selecting the targets and the visiting order in order to minimize the required propellant .",
    "the path between two given targets is obtained by solving a time - dependent optimal control problem .",
    "the overall problem is thus a combinatorial variant of the well - known traveling salesman problem , with successive embedded optimal control problems .        for an interplanetary mission successive fly - bys around planets",
    "are necessary to increase progressively the velocity in the solar system and reach far destinations .",
    "additional propelled maneuvers are necessary either at the fly - by or in the deep space in order to achieve the desired path . an impulsive velocity modelling is considered for these maneuvers in a first stage .",
    "if a low thrust engine is used , the maneuver assessment must be refined by solving an embedded optimal control problem .",
    "the optimization problem mixes discrete variables ( selected planets , number of revolutions between two successive fly - bys , number of propelled maneuvers ) and continuous variables ( fly - bys dates , maneuver dates , magnitudes and orientations ) .    in preliminary design studies ,",
    "the optimization problem addresses simultaneously the vehicle configuration and its command along the trajectory .",
    "the goal is usually to find the minimal gross weight vehicle able to achieve the specified mission .",
    "the configuration parameters are either continuous or discrete variables . for a propelled vehicle",
    "the main design parameters are the number of stages , the number of engines , the thrust level , the propellant type and the propellant masses . for a reentry vehicle",
    "the design is driven by the aerodynamic shape , the surface and by the auxiliary braking sub - systems if any .",
    "the gross mass minimization is essential for the feasibility of interplanetary missions .",
    "an example is given by a mars lander composed of a heat shield , one or several parachutes , braking engines , airbags and legs .",
    "the sub - system designs drive the acceptable load levels and thus the state constraints applied to the entry trajectory .",
    "the successive sequence of the descent trajectory are depicted on figure [ mission ] .",
    "large uncertainties have also to be accounted regarding the mars environment in order to define a robust vehicle configuration .        multidisciplinary optimization deals with such problems involving both the vehicle design and the mission scenario .",
    "the overall problem is too complex to be address directly , and a specific optimization procedure must be devised for each new case .",
    "a bi - level approach consists in separating the design and the trajectory optimization .",
    "the design problem is generally non differentiable or may present many local minima .",
    "it can be addressed in some cases by mixed optimization methods like branch and bound , or more generally by meta - heuristics like simulated annealing , genetic algorithms , particle swarm , etc .",
    "none is intrinsically better than another and a specific analysis is needed to formulate the optimization problem in a way suited to the selected method .",
    "these algorithms are based partly on a random exploration of the variable space . in order to be successful",
    "the exploration strategy has to be customized to the problem specificities .",
    "thousands or millions of trials may be necessary to yield a candidate configuration , based on very simplified performance assessment ( e.g. , analytical solutions , impulsive velocities , response surface models etc . ) .",
    "the trajectory problem is then solved for this candidate solution in order to assess the real performance , and if necessary iterate on the configuration optimization with a corrected the performance model .",
    "meta - heuristics may also be combined with multi - objective optimization approaches since several criteria have to be balanced at the design stage of a new space vehicle .",
    "the goal is to build a family of launchers using a common architecture of propelled stages with variants depending the targeted orbit and payload . by this way the development and manufacturing costs are minimized while the launcher configuration and the launch cost can be customized for each flight .",
    "geometric optimal control ( see , e.g. , @xcite ) combines classical optimal control and geometric methods in system theory , with the goal of achieving optimal synthesis results .",
    "more precisely , by combining the knowledge inferred from the pontryagin maximum principle ( pmp ) with geometric considerations , such as the use of lie brackets and lie algebras , of differential geometry on manifolds , and of symplectic geometry and hamiltonian systems , the aim is to describe in a precise way the structure of optimal trajectories .",
    "we refer the reader to @xcite for a list of references on geometric tools used in geometric optimal control .",
    "the foundations of geometric control can be dated back to the chow s theorem and to @xcite , where brunovsky found that it was possible to derive regular synthesis results by using geometric considerations for a large class of control systems .",
    "apart from the main goal of achieving a complete _ optimal synthesis _ , geometric control aims also at deriving higher - order optimality conditions in order to better characterize the set of candidate optimal trajectories .    in this section , we formulate the optimal control problem on differentiable manifolds and recall some tools and results from geometric optimal control .",
    "more precisely , the lie derivative is used to define the order of the state constraints , the lie and poisson brackets are used to analyze the singular extremals and to derive higher order optimality conditions , and the optimality conditions ( order one , two and higher ) are used to analyze the chattering extremals ( see section [ chatphenom ] for the chattering phenomenon ) .",
    "these results will be applied in section [ fullexample ] on a coupled attitude and trajectory optimization problem .",
    "let @xmath0 be a smooth manifold of dimension @xmath1 , let @xmath2 be a smooth manifold of dimension @xmath3 , let @xmath4 and @xmath5 be two subsets of @xmath0 , and let @xmath6 be a subset of @xmath2 .",
    "we consider the general nonlinear optimal control problem ( @xmath7 ) , of minimizing the cost functional @xmath8 over all possible trajectories solutions of the control system @xmath9 and satisfying the terminal conditions @xmath10 where the mappings @xmath11 , @xmath12 , and @xmath13 are smooth , and where the controls are bounded and measurable functions defined on @xmath14 $ ] of @xmath15 , taking values in @xmath6 .",
    "the final time @xmath16 may be fixed or not .",
    "we denote @xmath17 the set of _ admissible controls _ such that the corresponding trajectories steer the system from an initial point of @xmath4 to a final point in @xmath5 .    for each @xmath18 and @xmath19 , we can integrate the system from @xmath20 to @xmath21 , and assess the cost @xmath22 corresponding to @xmath23 and @xmath24 for @xmath25 $ ] . solving the problem ( @xmath7 )",
    "consists in finding a pair @xmath26 minimizing the cost . for convenience ,",
    "we define the end - point mapping to describe the final point of the trajectory solution of the control system .",
    "[ def_endpmap ] the _ end - point mapping",
    "_ @xmath27 of the system is defined by @xmath28 where @xmath29 is the trajectory solution of the control system associated to @xmath30 such that @xmath31    assuming moreover that @xmath17 is endowed with the standard @xmath32 topology , then the end - point mapping is @xmath33 on @xmath17 , and in terms of the end - point mapping , the optimal control problem under consideration can be written as the infinite - dimensional minimization problem @xmath34;u)\\right\\}.\\ ] ] this formulation of the problem will be used when we introduce the lagrange multipliers rule in section [ subsubsec_langrange ] in a simpler case when @xmath35 and @xmath36 and @xmath37 .",
    "if the optimal control problem has a solution , we say that the corresponding control and trajectory are minimizing or optimal .",
    "we refer to @xcite for existence results in optimal control .",
    "next , we introduce briefly the concept of lie derivative , and of lie and poisson brackets ( used in section [ hooc ] for higher order optimality conditions )",
    ". these concepts will be applied in section [ fullexample ] to analyze the pull - up maneuver problem .",
    "let @xmath38 be an open and connected subset in @xmath0 , and denote the space of all infinitely continuously differentiable functions on @xmath38 by @xmath39 .",
    "let @xmath40 be a vector field .",
    "@xmath41 can be seen as defining a first - order differential operator from the space @xmath39 into @xmath39 by taking at every point @xmath42 the directional derivative of a function @xmath43 in the direction of the vector field @xmath44 , i.e. , @xmath45 defined by @xmath46    we call @xmath47 the _ lie derivative _ of the function @xmath48 along the vector field @xmath41 , and generally one denote the operator by @xmath49 , i.e. , @xmath50 in general , the order of the state constraints in optimal control problems is defined through lie derivatives as we will show on the example in section [ example2 ] .",
    "the _ lie bracket _ of two vector fields @xmath41 and @xmath51 defined on a domain @xmath38 is the operator defined by the commutator @xmath52=x \\circ y - y\\circ x = xy - yx.\\ ] ]    the lie bracket actually defines a first - order differential operator . for any function @xmath48",
    "we have @xmath53(\\varphi ) & = x(y.\\varphi)-y(x.\\varphi ) \\\\ & = x(\\nabla \\varphi y)-y(\\nabla \\varphi x)\\\\ & = \\nabla(\\nabla \\varphi y)x - \\nabla(\\nabla \\varphi x)y \\\\ & = \\nabla(\\nabla \\varphi ) ( y , x)- \\nabla(\\nabla \\varphi)(x , y ) + \\nabla \\varphi ( dy \\cdot x - dx \\cdot y ) \\\\ & =   \\nabla \\varphi ( dy \\cdot x- dx \\cdot y ) , \\end{split}\\ ] ] where @xmath54 denotes the action of the hessian matrix of the function @xmath48 on the vector fields @xmath41 and @xmath51 , and @xmath55 and @xmath56 denote the matrices of the partial derivatives of the vector fields @xmath41 and @xmath51 .",
    "therefore , if @xmath57 , and @xmath58 , are coordinates for these vector fields , then @xmath52(z)= dy(z)\\cdot x(z)-dx(z ) \\cdot y(z).\\ ] ]    let @xmath41 , @xmath51 , and @xmath59 be three @xmath60 vector fields defined on @xmath38 , and let @xmath61 , @xmath62 be smooth functions on @xmath38 .",
    "the lie bracket has the following properties :    * @xmath63 $ ] is a bilinear operator ; * @xmath64 = -[y , x]$ ] ; * @xmath65=[x , z]+[y , z]$ ] ; * @xmath66 + [ y,[z , x]]+[z,[x , y ] ] = 0 $ ] ( jacobi identity ) ; * @xmath67 = \\alpha \\beta [ x , y ] + \\alpha(l_x\\beta)y - \\beta ( l_y\\alpha)x$ ] .",
    "these properties show that the vector fields ( as differential operators ) form a lie algebra .",
    "lie algebra _ over @xmath68 is a real vector space @xmath69 together with a bilinear operator @xmath63 : \\g \\times \\g \\to \\g$ ] such that for all @xmath70 we have @xmath64 = -[y , x]$ ] and @xmath65=[x , z]+[y , z]$ ] .",
    "going back to the problem ( @xmath7 ) , we assume that @xmath71 , @xmath72 , and @xmath73 , and we define a @xmath33 function by @xmath74 where @xmath75 is the adoint vector and @xmath59 is a vector field .",
    "the function @xmath76 is the hamiltonian lift of the vector field @xmath59 . accordingly , and with a slight abuse of notation , we denote by @xmath77 the value at time @xmath78 of @xmath76 along a given extremal .",
    "the derivative of this function is @xmath79(x ) \\rangle + u \\langle p,[f_1,z](x ) \\rangle .",
    "\\end{split}\\ ] ]    let us recall also the concept of the _ poisson bracket_. the poisson bracket is related to the hamiltonians",
    ". in the canonical coordinates @xmath80 , given two @xmath33 functions @xmath81 and @xmath82 , the poisson bracket takes the form @xmath83    according to , taking @xmath84 we have @xmath85 where @xmath86 and @xmath87 .    for convenience ,",
    "we adopt the usual notations @xmath88,\\ , \\textrm{resp . } \\",
    ", \\mathrm{ad}\\ , h_0.h_1 = \\left\\{h_0,h_1\\right\\},\\ ] ] and @xmath89,\\ , \\textrm{resp . } \\ , \\mathrm{ad}^ih_0.h_1 = \\left\\{h_0,\\mathrm{ad}^{i-1}h_0.h_1\\right\\}.\\ ] ]    we will see in section [ opticondisec ] ( and also in section [ fullexample ] ) that the lie brackets and the poisson brackets are very useful for deriving higher order optimality conditions in simpler form and for calculating the singular controls .",
    "this section gives an overview of necessary optimality conditions .",
    "for the first - order optimality conditions , we recall the lagrange multipliers method for the optimal control problem without control constraints .",
    "such constraints can be accounted in the lagrangian with additional lagrange multipliers @xcite . this method leads to weaker results than the pontryagin maximum principle which considers needle - like variations accounting directly for the control constraints .",
    "in some cases , the first - order conditions do not provide adequate information of the optimal control , and the higher order optimality conditions are needed .",
    "therefore we recall the second and higher order necessary optimality conditions that must be met by any trajectory associated to an optimal control @xmath30 .",
    "these conditions are especially useful to analyze the singular solutions because the first - order optimality conditions do not provide any information in such cases .",
    "[ [ subsubsec_langrange ] ] lagrange multipliers rule .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    we consider the simplified problem ( @xmath7 ) with @xmath90 , @xmath91 , @xmath92 , and @xmath37 . according to the well known lagrange multipliers rule ( and assuming the @xmath33 regularity of the problem ) , if @xmath93 is optimal then there exists a nontrivial couple @xmath94 such that @xmath95 where @xmath96 and @xmath97 denote the frchet derivative of @xmath98 and @xmath99 , respectively . defining the lagrangian by @xmath100",
    "this first - order necessary condition can be written in the form @xmath101 if we define as usual the intrinsic second - order derivative @xmath102 of the lagrangian as the hessian @xmath103 restricted to the subspace @xmath104 , a second - order necessary condition for optimality is the nonpositivity of @xmath102 ( with @xmath105 ) , and a second - order sufficient condition for local optimality is the negative definiteness of @xmath102 .",
    "these results are weaker to those obtained with the pmp .",
    "the lagrange multiplier @xmath106 is in fact related to the adjoint vector introduced in the pmp .",
    "more precisely , the lagrange multiplier is unique up to a multiplicative scalar if and only if the trajectory @xmath107 admits a unique extremal lift up to a multiplicative scalar , and the adjoint vector @xmath108 can be constructed such that @xmath109 up to some multiplicative scalar .",
    "this relation can be observed from the proof of the pmp .",
    "the lagrange multiplier @xmath110 is associated with the instantaneous cost .",
    "the case with @xmath111 null is said abnormal , which means that there are no neighboring trajectories having the same terminal point ( see , e.g. , @xcite ) .",
    "[ [ pontryagin - maximum - principle . ] ] pontryagin maximum principle .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the pontryagin maximum principle ( pmp , see @xcite ) for the problem ( @xmath7 ) with control constraints and without state constraints is recalled in the following statement .",
    "[ thm_pmp ] if the trajectory @xmath107 , associated to the optimal control @xmath30 on @xmath112 $ ] , is optimal , then it is the projection of an extremal @xmath113 where @xmath114 , and @xmath115 \\mapsto t^\\ast_{x(t ) } m$ ] , @xmath116 is the cotangent space to @xmath0 at @xmath117 . ]",
    "is an absolutely continuous mapping ( called adjoint vector ) with @xmath118 , such that almost everywhere on @xmath112 $ ] , @xmath119 where the hamiltonian is defined by @xmath120 and there holds almost everywhere on @xmath112 $ ] .",
    "@xmath121 if moreover , the final time @xmath16 is not fixed , then @xmath122 if @xmath4 and @xmath5 ( or just one of them )",
    "are submanifolds of @xmath0 locally around @xmath18 and @xmath123 , then the adjoint vector satisfies the transversality conditions at both endpoints ( or just one of them ) @xmath124 where @xmath125 ( resp . ,",
    "@xmath126 ) denote the tangent space to @xmath4 ( resp .",
    ", @xmath5 ) at the point @xmath117 .",
    "the quadruple @xmath113 is called the _ extremal lift _ of @xmath107 . an extremal is said to be _ normal _ ( resp . , _ abnormal _ ) if @xmath127 ( resp . , @xmath128 ) .",
    "according to the convention chosen in the pmp , we consider @xmath114 .",
    "if we adopt the opposite convention @xmath129 , then we have to replace the maximization condition with a minimization condition . when there are no control constraints , abnormal extremals project exactly onto singular trajectories .",
    "the proof of the pmp is based on needle - like variations and uses a conic implicit function theorem ( see , e.g. , @xcite )",
    ". since these needle - like variants are of order one , the optimality conditions given by the pmp are necessary conditions of the first - order . for singular controls ,",
    "higher order control variations are needed to obtain optimality conditions .",
    "a singular control is defined precisely as follows .",
    "[ def_sin_e ] assume that @xmath91 .",
    "a control @xmath30 defined on @xmath112 $ ] is said to be _ singular _ if and only if the frchet differential @xmath130 is not of full rank .",
    "the trajectory @xmath107 associated with a singular control @xmath30 is called singular trajectory .    in practice",
    "the condition @xmath131 ( the hessian of the hamiltonian is degenerate ) is used to characterize singular controls .",
    "an extremal @xmath113 is said _ totally singular _ if this condition is satisfied .",
    "the is especially the case when the control is affine ( see section [ hooc ] ) .    the pmp claims that if a trajectory is optimal , then it should be found among projections of extremals joining the initial set to the final target .",
    "nevertheless the projection of a given extremal is not necessarily optimal .",
    "this motivates the next section on second - order optimality conditions .",
    "the literature on first and/or second - order sufficient conditions with continuous control is rich ( see , e.g. , @xcite ) , which is less the case for discontinuous controls ( see , e.g. , @xcite ) .",
    "we recall hereafter the legendre type conditions with poisson brackets to show that geometric optimal control allows a simple expression of the second - order necessary and sufficient conditions ( see theorem [ gohcond ] ) .",
    "[ [ legendre - type - conditions . ] ] legendre type conditions .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    for the optimal control problem ( @xmath7 ) , we have the following second - order optimality conditions ( see , e.g. , @xcite ) .    _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    * if a trajectory @xmath107 , associated to a control @xmath30 , is optimal on @xmath112 $ ] in @xmath32 topology , then the legendre condition holds along every extremal lift @xmath113 of @xmath107 , that is @xmath132 * if the strong legendre condition holds along the extremal @xmath113 , that is , there exists @xmath133 such that @xmath134 then there exists @xmath135 such that @xmath107 is locally optimal in @xmath32 topology on @xmath136 $ ] . if the extremal is moreover normal , i.e. , @xmath137 , then @xmath107 is locally optimal in @xmath138 topology on @xmath136 $ ] . _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    the @xmath138 local optimality and @xmath32 local optimality are respectively called strong local optimality and weak local optimality is fixed , then @xmath139 is said to be locally optimal in @xmath32 topology ( resp . in @xmath138 topology ) , if it is optimal in a neighborhood of @xmath30 in @xmath32 topology ( resp . in a neighborhood of @xmath139 @xmath138 topology ) .",
    "+ if the final time @xmath16 is not fixed , then a trajectory @xmath139 is said to be locally optimal in @xmath32 topology if , for every neighborhood @xmath140 of @xmath30 in @xmath141,u)$ ] , for every real number @xmath142 so that @xmath143 , for every control @xmath144 satisfying @xmath145 there holds @xmath146 .",
    "moreover , a trajectory @xmath139 is said to be locally optimal in @xmath138 topology if , for every neighborhood @xmath147 of @xmath139 in @xmath0 , for every real number @xmath142 so that @xmath143 , for every trajectory @xmath107 , associated to a control @xmath144 on @xmath148 $ ] , contained in @xmath147 , and satisfying @xmath149 , @xmath150 , there holds @xmath146 . ] . the legendre condition is a necessary optimality condition , whereas the strong legendre condition is a sufficient optimality condition .",
    "we say that we are in the _ regular case _ whenever the strong legendre condition holds along the extremal . under the strong legendre condition ,",
    "a standard implicit function argument allows expressing , at least locally , the control @xmath30 as a function of @xmath117 and @xmath75 .    in the totally singular case , the strong legendre condition is not satisfied and we have the following generalized condition @xcite .",
    "[ gohcond ] _ ( goh and generalized legendre condition ) _    * if a trajectory @xmath107 , associated to a piecewise smooth control @xmath30 , and having a totally singular extremal lift @xmath113 , is optimal on @xmath112 $ ] in @xmath32 topology , then the goh condition holds along the extremal , that is @xmath151 where @xmath152 denotes the poisson bracket on @xmath153 .",
    "moreover , the generalized legendre condition holds along every extremal lift @xmath113 of @xmath107 , that is @xmath154 * if the goh condition holds along the extremal lift @xmath113 , if the strong legendre condition holds along the extremal @xmath113 , that is , there exists @xmath133 such that @xmath155 and if moreover the mapping @xmath156 is one - to - one , then there exists @xmath135 such that @xmath107 is locally optimal in @xmath32 topology on @xmath136 $ ] .    as we have seen , the legendre ( or generalized legendre ) condition is a necessary condition , while the strong ( or strong generalized legendre ) condition is a sufficient condition .",
    "however , these sufficient conditions are not easy to verify in practice .",
    "this leads to the next section where we explain how to use the so - called _ conjugate point _ along the extremal to determine the time when the extremal is no longer optimal .",
    "[ [ conjugate - points . ] ] conjugate points .",
    "+ + + + + + + + + + + + + + + + +    we consider here the simplified problem ( @xmath7 ) with @xmath90 , @xmath91 , @xmath92 , and @xmath37 . under the strict legendre assumption assuming that the hessian @xmath157 is negative definite , the quadratic form @xmath102 is negative definite if @xmath158 is small enough .",
    "[ def_conj_p ] the first conjugate time is defined by the infimum of times @xmath159 such that @xmath160 has a nontrivial kernel .",
    "we denote the first conjugate time along @xmath107 by @xmath161 .",
    "the extremals are locally optimal ( in @xmath32 topology ) as long as we do not encounter any conjugate point .",
    "define the _ exponential mapping _ @xmath162 where the solution of starting from @xmath163 at @xmath20 is denoted as @xmath164 .",
    "then , we have the following result ( see , e.g. , @xcite for the proof and more precise results ) :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ the time @xmath161 is a conjugate time along @xmath107 if and only if the mapping @xmath165 is not an immersion at @xmath166 , i.e. , the differential of the mapping @xmath165 is not injective . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    essentially this result states that computing a first conjugate time @xmath161 reduces to finding the zero of some determinant along the extremal . in the smooth case",
    "( the control can be expressed as a smooth function of @xmath117 and @xmath75 ) , the survey article @xcite provides also some algorithms to compute first conjugate times . in case of bang - bang control ,",
    "a conjugate time theory has been developed ( see @xcite for a brief survey of the approaches ) , but the computation of conjugate times remains difficult in practice ( see , e.g. , @xcite ) .",
    "when the singular controls are of order one ( see definition [ def_singorder ] ) , the second - order optimality condition is sufficient for the analysis . for higher order singular controls ,",
    "higher order optimality conditions are needed which are recalled in the next section .      in this section",
    "we recall briefly the order of singular controls and the higher order optimality conditions . they will be used in section [ example1 ] to analyze the example , which exhibits a singular control of order two .",
    "it is worth noting that when the singular control is of _ order @xmath167 _ ( also called _ minimal order _ in @xcite ) , these higher order optimality conditions are not required .    to illustrate how to use these conditions , we consider the minimal time control problem on @xmath0 @xmath168 where @xmath169 , @xmath170 and @xmath171 are smooth vector fields on @xmath0 .",
    "we assume that @xmath5 is accessible from @xmath172 , and that there exists a constant @xmath173 such that for every admissible control @xmath30 , the corresponding trajectory @xmath174 satisfies @xmath175 for all @xmath176 $ ] .",
    "then , according to classical results ( see , e.g. , @xcite ) , there exists at least one optimal solution @xmath177 , defined on @xmath112 $ ] .",
    "let @xmath178 , @xmath179 , and @xmath180 .",
    "according to the pmp ( see section [ subsubsec_langrange ] ) , the hamiltonian of the problem is defined by @xmath181 where @xmath182 is the adjoint variable , and @xmath114 is a real number such that @xmath118 . defining @xmath183 ,",
    "the maximization condition of the pmp yields @xmath184 almost everywhere on @xmath112 $ ] , whenever @xmath185 .",
    "we call @xmath186 ( as well as its components ) the _ switching function_. we say that an arc ( restriction of an extremal to a subinterval @xmath187 ) is _ regular _ if @xmath188 along @xmath187 .",
    "otherwise , the arc is said to be _",
    "singular_.    following @xcite , we give here below a precise definition of the order of a singular control .",
    "the use of poisson ( and lie ) brackets simplifies the formulation of the higher order optimality conditions .",
    "this is one of the reasons making geometric optimal control theory a valuable tool in practice .",
    "[ def_singorder ] the singular control @xmath189 defined on a subinterval @xmath190 $ ] is said to be of _ order @xmath191 _ if    1 .",
    "the first @xmath192-th time derivatives of @xmath193 , @xmath194 , do not depend on @xmath30 and @xmath195 2 .",
    "the @xmath196-th time derivative of @xmath193 , @xmath194 , depends on @xmath30 linearly and @xmath197 along @xmath187 .    the control @xmath30 is said to be of _ intrinsic order _ @xmath191",
    "if the vector fields satisfy also @xmath198 \\equiv 0,\\quad k=1,\\cdots,2q-2,\\quad i=1,2.\\ ] ]    the condition of a nonzero determinant guarantees that the optimal control can be computed from the @xmath196-th time derivative of the switching function .",
    "note that this definition requires that the two components of the control have the same order .",
    "we next recall the goh and generalized legendre - clebsch conditions ( see @xcite ) .",
    "it is worth noting that in @xcite , the following higher - order necessary conditions hold even when the components of the control @xmath30 have different orders .",
    "[ necconds0 ] _ ( higher - order necessary conditions ) _ we assume that a singular control @xmath189 defined on @xmath187 is of order @xmath191 , that @xmath30 is optimal and not saturating , i.e. , @xmath199 . then the goh condition @xmath200 must be satisfied along @xmath187 . moreover , the matrix having as @xmath201-th component @xmath202 is symmetric and negative definite along @xmath187 ( generalized legendre - clebsch condition ) .    in practice",
    ", it happens that the singular controls are often of intrinsic order @xmath203 , and that @xmath204 = 0 $ ] , @xmath205 = 0 $ ] , and @xmath206 = 0 $ ] .",
    "the conditions given in the above definition yield @xmath207 = 0 $ ] , @xmath208 = 0 $ ] , @xmath209 = 0 $ ] , @xmath210 = 0 $ ] , @xmath211(x ) \\rangle \\neq 0 $ ] , @xmath212(x ) \\rangle \\neq 0 $ ] , and @xmath213(x ) \\rangle \\langle p ,   [ g_2,\\mathrm{ad}^3 f.g_2 ] ( x ) \\rangle - \\langle p ,   [ g_2,\\mathrm{ad}^3 f.g_1 ] ( x ) \\rangle \\langle p ,   [ g_1,\\mathrm{ad}^3 f.g_2 ] ( x ) \\rangle \\neq 0,\\ ] ] we have thus the following higher - order necessary conditions , that will be used on the example in section [ example1 ]",
    ".    [ necconds ] we assume that the optimal trajectory @xmath107 contains a singular arc , defined on the subinterval @xmath187 of @xmath112 $ ] , associated with a non saturating control @xmath189 of intrinsic order @xmath203 . if the vector fields satisfy @xmath214 = 0 $ ] , @xmath215   = 0 $ ] , for @xmath216 , then the goh condition @xmath217 ( x(t ) ) \\rangle = 0 ,",
    "\\quad \\langle p(t ) , [ g_1,\\mathrm{ad}^2 f.g_2 ] ( x(t ) ) \\rangle = \\langle p(t ) , [ g_2,\\mathrm{ad}^2 f.g_1 ] ( x(t ) ) \\rangle = 0,\\ ] ] and the generalized legendre - clebsch condition ( in short , glcc ) @xmath218(x(t))\\rangle { \\leqslant}0 , \\quad i=1,2,\\ ] ] @xmath219(x(t))\\rangle = \\langle p(t),[g_2,\\mathrm{ad}^3f.g_1](x(t))\\rangle\\ ] ] must be satisfied along @xmath187 .",
    "moreover , we say that the strengthened glcc is satisfied if we have a strict inequality above , that is , @xmath220(x(t))\\rangle < 0 $ ] .    in the next section , we recall the chattering phenomenon that may happen in the optimal control problem .",
    "this phenomenon is actually not rare as illustrated in @xcite by many examples ( in astronautics , robotics , economics , and etc . ) .",
    "these examples are mostly single input systems .",
    "the existence of chattering phenomenon for bi - input control affine systems is also proved in @xcite .",
    "we call _ chattering phenomenon _ ( or fuller s phenomenon ) the situation when the optimal control switches an infinite number of times over a compact time interval . it is well known that , if the optimal trajectory involves a singular arc of higher order , then no connection with a bang arc is possible and the bang arcs asymptotically joining the singular arc must chatter . on figure [ chattering](b ) ,",
    "the control is singular over @xmath221 , and the control @xmath24 with @xmath222 , @xmath223 , @xmath224 is chattering .",
    "the corresponding optimal trajectory is called a chattering trajectory . on figure [ chattering](a ) , the chattering trajectory `` oscillates '' around the singular part and",
    "finally  gets off \" the singular trajectory with an infinite number of switchings .",
    "the chattering phenomenon is illustrated by the fuller s problem ( see @xcite ) , which is the optimal control problem @xmath225 we define @xmath226 as the unique positive root of the equation @xmath227 , and we define the sets @xmath228 the optimal synthesis of the fuller s problem yields the following feedback control ( see @xcite ) .",
    "@xmath229 the control switches from @xmath230 to @xmath231 at points on @xmath232 and from @xmath231 to @xmath230 at points on @xmath233 .",
    "the corresponding trajectories crossing the switching curves @xmath234 transversally are chattering arcs with an infinite number of switchings that accumulate with a geometric progression at the final time @xmath158 .    the optimal synthesis for the fuller s problem is drawn on figure [ fuller ] .",
    "the optimal control of the fuller s problem , denoted @xmath235 , contains a countable set of switchings of the form @xmath236 ,        \\end{cases}\\ ] ] where @xmath237 is a set of switching times that satisfies @xmath238 , @xmath239 and converges to @xmath240 .",
    "this means that the chattering arcs contain an infinite number of switchings within a finite time interval @xmath158 .",
    "numerical approaches in optimal control are usually distinguished between direct and indirect methods .",
    "indirect methods consist in solving numerically the boundary value problem derived from the application of the pmp .",
    "direct methods consist in discretizing the state and the control , and solving the resulting nonlinear optimization problem .",
    "the principles of both methods are recalled hereafter .      in indirect approaches ,",
    "the pontryagin maximum principle ( first - order necessary condition for optimality ) is applied to the optimal control problem in order to express the control as a function of the state and the adjoint .",
    "this reduces the problem to a nonlinear system of @xmath1 equations with @xmath1 unknowns generally solved by newton - like methods .",
    "indirect methods are also called shooting methods .",
    "the principle of the simple shooting method and of the multiple shooting method are recalled .",
    "the problem considered in this section is ( @xmath7 ) .",
    "[ [ simple - shooting - method . ] ] simple shooting method .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    using , the optimal control can be expressed as a function of the state and the adjoint variable @xmath241 . denoting @xmath242 ,",
    "the extremal system can be written under the form @xmath243 .",
    "the initial and final conditions , the transversality conditions , and the transversality condition on the hamiltonian can be written under the form of @xmath244 .",
    "we thus get a two boundary value problem @xmath245 let @xmath246 be the solution of the cauchy problem @xmath247 then this two boundary value problem consists in finding a zero of the equation @xmath248 this problem can be solved by newton - like methods or other iterative methods .",
    "[ [ subsec_tirmultiple ] ] multiple shooting method .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    the drawback of the single shooting method is the sensitivity of the cauchy problem to the initial condition @xmath249 .",
    "the multiple shooting aims at a better numerical stability by dividing the interval @xmath112 $ ] into @xmath2 subintervals @xmath250 $ ] and considering as unknowns the values of @xmath251 at the beginning of each subinterval .",
    "the application of the pmp to the optimal control problem yields a multi - point boundary value problem , which consists in finding @xmath252 , @xmath253 such that the differential equation @xmath254 and the constraints @xmath255 @xmath256 are satisfied .",
    "the nodes of the multiple shooting method may involve the switching times ( at which the switching function changes sign ) , and the junction times ( entry , contact , or exit times ) with boundary arcs . in this case an a priori knowledge of the solution structure is required .",
    "the multiple shooting method improves the numerical stability at the expense of a larger nonlinear system .",
    "an adequate node number must be chosen making a compromise between the system dimension and the convergence domain .",
    "direct methods are so called because they address directly the optimal control problem without using the first - order necessary conditions yielded by the pmp . by discretizing both the state and the control",
    ", the problem reduces to a nonlinear optimization problem in finite dimension , also called nonlinear programming problem ( nlp ) .",
    "the discretization may be carried out in many ways , depending on the problem features . as an example we may consider a subdivision @xmath257 of the interval @xmath112 $ ] . we discretize the controls such that they are piecewise constant on this subdivision with values in @xmath6 .",
    "meanwhile the differential equations may be discretized by an explicit euler method : by setting @xmath258 , we get @xmath259 .",
    "the cost may be discretized by a quadrature procedure .",
    "these discretizations reduces the optimal control problem @xmath7 to a nonlinear programming problem of the form @xmath260    from a more general point of view , a finite dimensional representation of the control and of the state has to be chosen such that the differential equation , the cost , and all constraints can be expressed in a discrete way .",
    "the numerical resolution of a nonlinear programming problem is standard , by gradient methods , penalization , quasi - newton , dual methods , etc .",
    "( see , e.g. , @xcite ) .",
    "there exist many efficient optimization packages such as ` ipopt ` ( see @xcite ) , ` muscod - ii ` ( see @xcite ) , or the ` minpack ` project ( see @xcite ) for many optimization routines .",
    "alternative variants of direct methods are the collocation methods , the spectral or pseudo - spectral methods , the probabilistic approaches , etc .",
    "another approach to optimal control problems that can be considered as a direct method , consists in solving the hamilton - jacobi equation satisfied ( in the viscosity sense ) by the value function which is of the form @xmath261 the value function is the optimal cost for the optimal control problem starting from a given point @xmath262 ( see @xcite for some numerical methods ) .",
    "the main advantages and disadvantages of the direct and indirect methods are summarized in table [ comparisons ] ( see also , e.g. , @xcite ) .",
    ".pros and cons for direct and indirect methods [ cols=\"<,<,<\",options=\"header \" , ]     [ table_statistic_res3 ]    figure [ paran ] plots the success rate and the execution time depending of the number of nodes .",
    "the test case is the planar maneuver with the regularization parameter @xmath263 set to @xmath264 .",
    "the rate of success does not increase monotonically with respect to the number of node points , and the execution time does not change significantly for @xmath2 less than 6 .",
    "when @xmath265 , the success rate decreases quickly and equals to zero when @xmath266 .",
    "when the number of unknowns for the shooting method becomes too large , the domain of convergence of a newton - type method reduces which finally leads to lower rate of success .     by solving ( @xmath267),scaledwidth=70.0% ]      along multi - burn ascent trajectories , the control ( euler angles ) exhibit jumps at the stage separations",
    "( see for example ( * ? ? ?",
    "* figure 3 ) ) . in this case , a reorientation maneuver is necessary to follow the optimal thrust direction . for this reason ,",
    "we apply the above algorithm as well to the maneuver problem of the upper stages of the launch vehicles .",
    "opposite to the airborne launch vehicle s pull - up maneuvers , these reorientation maneuvers are in general three - dimensional and of lower magnitude .",
    "they occur at high altitudes ( typically higher than 50 km since a sufficiently low dynamic pressure is required to ensure the separation safety ) and high velocity ( since the first stage has already delivered a large velocity increment ) .",
    "the maneuver occurs in vacuum so that no state constraints apply . finding the minimum time maneuver corresponds to solving the problem ( @xmath268 ) .    in the example",
    ", we set the system parameters in to @xmath269 , @xmath270 , which approximate an ariane - like launcher .",
    "the initial conditions are @xmath271 @xmath272 and the final conditions are @xmath273    [ h ]   for a reorientation maneuver.,title=\"fig:\",scaledwidth=90.0% ]    [ h ]   for a reorientation maneuver.,title=\"fig : \" ]    the multiple shooting method is applied with four node points . on figures [ state_mul ] and [ control_mul ] , we report the components of state and control variables .",
    "we observe that , when @xmath274\\ , s$ ] , the control is quasi null , and the attitude angles take the solution values of the zero order problem ( @xmath275 ) : @xmath276 , @xmath277 . the regularization term @xmath278 in the cost functional yields",
    "a continuous control plotted on figure [ control_mul ] and avoids chattering for this application case the regularization parameter moves from @xmath279 ( @xmath280 ) until @xmath281 ( @xmath282 ) and the computing time is about @xmath283 .",
    "the maneuver duration @xmath16 is about @xmath284 due to the large direction change required on the velocity . during a real flight",
    "the velocity direction change is much smaller and the maneuver takes at most a few seconds .",
    "our purpose when presenting this `` unrealistic '' case is rather to show that the proposed algorithm is robust in a large range of system configurations and terminal conditions .",
    "the previous section was devoted to an ascent trajectory application .",
    "the example dealt with the pull - up maneuver of an airborne launch vehicle just after its release from the carrier .",
    "this section gives a brief overview of optimal geometric control and continuation techniques applied to other mission categories , namely orbital transfer and atmospheric reentry .",
    "the orbital transfer problem consists in steering the engine from an initial orbit to a final one while minimizing either the duration or the consumption .",
    "this problem has been widely studied in the literature , and the solution algorithms involve direct methods as well as indirect methods .",
    "the reader is referred to @xcite and @xcite for a list of methods and references .",
    "our aim is here to recall how geometric optimal control theory and numerical continuation methods can help solving such problems .",
    "the dynamics is modelled by the controlled kepler equations @xmath285 where @xmath286 is the position of the spacecraft , @xmath287 is the gravitational constant of the planet , @xmath288 is the bounded thrust , and @xmath289 is the mass with @xmath62 a constant depending on the specific impulse of the engine .",
    "controllability properties ensuring the feasibility of the problem have been studied in @xcite , based on the analysis of lie algebra generated by the vector fields of the system .    the minimum time low thrust transfer is addressed for example in @xcite .",
    "it is observed that the domain of convergence of the newton - type method in the shooting problem becomes smaller when the maximal thrust decreases .",
    "therefore , a natural continuation process consists in starting with larger values of the maximal thrust and then decreasing step by step the maximal thrust . in @xcite",
    ", the authors started with the maximal thrust @xmath290 and achieved the continuation up to @xmath291 .",
    "the minimum fuel consumption orbit transfer problem has also been widely studied . with the cost functional @xmath292 , the problem is more difficult than minimizing the time , since the optimal control is discontinuous . in @xcite ,",
    "the authors propose a continuation on the cost functional , starting from the minimum - energy problem .",
    "the cost functional is defined by @xmath293where @xmath294 $ ] is the homotopy parameter .",
    "when @xmath295 ( minimum - energy ) , the control derived from the pmp is continuous and the shooting problem is thus easier to solve .",
    "the authors prove the existence of a zero path from @xmath295 and to @xmath296 .",
    "this continuation approach is later applied in @xcite for studying the @xmath297-minimization of trajectory optimization problem .",
    "such minimum - fuel low - thrust transfers are very important for deep space explorations , since all the propellant must be carried on board by the satellite .",
    "similar continuation procedures have also been applied to the well - known goddard s problem , and to its three - dimensional variants ( @xcite ) .",
    "the possible singular arcs ( along which the norm of the thrust is neither zero nor maximal ) have thus been analyzed and numerically computed .",
    "continuation procedures are also valuable for high - thrust orbital transfer problems . in @xcite ,",
    "the authors proposed a continuation procedure starting from a flat earth model with constant gravity .",
    "the variable gravity and the earth curvature are introduced step by step by homotopy parameters .",
    "the theoretically analysis of the flat earth model shows that the solution structure consists in a single boost followed by a coast arc .",
    "this helps solving the starting problem in a direct way , before coming back by continuation to the real round earth problem .",
    "the round earth solution exhibits a different solution structure ( boost  coast  boost ) which appears progressively along the continuation process .",
    "an atmospheric reentry typically begins at an altitude of @xmath298 and ends with a landing phase .",
    "the final landing phase until the touchdown is generally studied apart and it is highly dependent on the mission specifications ( ground or sea landing , manned or unmanned flight , etc ) .",
    "the so - called atmospheric leg aims at reducing the vehicle energy before the final landing phase .",
    "no fuel is used and the braking has to be fully achieved by aerodynamics while satisfying the state constraints , in particular on the thermal flux .",
    "the final conditions specify a target position at a low altitude , typically less than @xmath299 .",
    "the vehicle is considered as a glider submitted to the gravity and the aerodynamical forces , the control @xmath30 being the bank angle and possibly the angle of attack .",
    "the optimal control problem consists thus in steering the space shuttle from given entry conditions to targeted final conditions while minimizing the total heat and satisfying state constraints on the thermal flux , the normal acceleration , and the dynamic pressure .",
    "we refer the readers to @xcite for a formulation of this problem .",
    "the control @xmath30 acts on the lift force orientation , changing simultaneously the descent rate and the heading angle .",
    "a practical guidance strategy consists in following the constraint boundaries , successively : thermal flux , normal acceleration , and dynamic pressure .",
    "this strategy does not care about the cost functional and it is therefore not optimal . applying the pontryagin maximum principle with state constraints is not promising due to a narrow domain of convergence of the shooting method . finding a correct guess for the initial adjoint vector proves quite difficult",
    ". therefore direct methods are generally preferred for this atmospheric reentry problem ( see , e.g. , @xcite ) .",
    "here we recall two alternative approaches to address the problem by indirect methods .",
    "the first approach is to analyze the control system using geometric control theory .",
    "for example , in @xcite , a careful analysis of the control system provides a precise description of the optimal trajectory .",
    "the resulting problem reduction makes it tractable by the shooting method .",
    "more precisely , the control system is rewritten as a single - input control - affine system in dimension three under some reasonable assumptions .",
    "local optimal syntheses are derived from extending existing results in geometric optimal control theory .",
    "based on perturbation arguments , this local nature of the optimal trajectory is then used to provide an approximation of the optimal trajectory for the full problem in dimension six , and finally simple approximation methods are developed to solve the problem .",
    "a second approach is to use the continuation method .",
    "for example , in @xcite , the problem is solved by a shooting method , and a continuation is applied on the maximal value of the thermal flux .",
    "it is shown in @xcite that under some appropriate assumptions , the change in the structure of the trajectory is regular , i.e. , when a constraint becomes active along the continuation , only one boundary arc appears .",
    "nevertheless it is possible that an infinite number of boundary arcs appear ( see , e.g. , @xcite ) .",
    "this phenomenon is possible when the constraint is of order three at least . by using a properly modified continuation procedure ,",
    "the reentry problem was solved in @xcite and the results of @xcite were retrieved .",
    "the aim of this article was to show how to apply techniques of geometric optimal control and numerical continuation to aerospace problems .",
    "after an overview of space transportation missions , some classical techniques of optimal control have been recalled , including pontryagin maximum principle , first and second - order optimality conditions , and conjugate time theory .",
    "techniques of geometric optimal control have then been recalled , such as higher - order optimality conditions and singular controls .",
    "a quite difficult problem has illustrated in detail how to design an efficient solution method with the help of geometric optimal control tools and continuation methods .",
    "other applications in space trajectory optimization have also been recalled .",
    "though geometric optimal control and numerical continuation provide a nice way to design efficient approaches for many aerospace applications , the answer to `` how to select a reasonably simple problem for the continuation procedure '' for general optimal control problems remains open .",
    "a deep understanding of the system dynamics is necessary to devise a simple problem that is `` physically '' sufficiently close to the original problem , while being numerically suited to initiate a continuation procedure .    in practice",
    ", many problems remain difficult due to the complexity of real - life models . in general",
    ", a compromise should be found between the complexity of the model under consideration and the choice of an adapted numerical method .",
    "as illustrated by the example of airborne launch vehicles , many state and/or control constraints should also be considered in a real - life problem , and such constraints makes the problem much more difficult . for the airborne launch problem",
    "a penalization method combined with the previous geometric analysis proves satisfying .",
    "but this approach has to be customized to the specific problem under consideration . a challenging task is then to combine an adapted numerical approach with a thorough geometric analysis in order to get more information on the optimal synthesis .",
    "we refer the readers to @xcite for a summary of open challenges in aerospace applications .",
    "bonnans , a. hermant , stability and sensitivity analysis for optimal control problems with a first - order state constraint and application to continuation methods .",
    "_ esaim control optim .",
    "_ , 2008 , vol .",
    "4 , no . 14 , p. 825 - 863 .",
    "b. bonnard , j.b .",
    "caillau , e. trlat , second order optimality conditions in the smooth case and applications in optimal control , _ esaim : control , optimisation and calculus of variations _ , 2007 , vol . 13 , p. 207 - 236 .        b. bonnard , l. faubourg , e. trlat , optimal control of the atmospheric arc of a space shuttle and numerical simulations by multiple - shooting techniques .",
    "models methods appl .",
    "_ , 2005 , vol . 1 , no . 15 , p. 109",
    "- 140 .",
    "caillau and j. noailles , continuous optimal control sensitivity analysis with ad , automatic differentiation : from simulation to optimization , _ springer , berlin _ , 2002 ,",
    "p. 109 - 117 .",
    "m. caponigro , b. piccoli , f. rossi , e. trlat , sparse jurdjevic ",
    "quinn stabilization of dissipative systems , preprint hal ( 2016 ) , 21 pages , to appear in _ ieee trans .",
    "_              j.b .",
    "clegern , m.j .",
    "ostrander , pegasus upgrades - a continuing study into an air - breathing alternative . _ in 31 st aiaa , asme , sae , and asee , joint propulsion conference and exhibit _ , san diego , ca , 1995 .",
    "h. maurer , c. , bskens , j.h.r .",
    "kim , c.y .",
    "kaya , optimization methods for the verification of second - order sufficient conditions for bang - bang controls .",
    "control appl . _ , 2005 ,",
    "methods 26 , p. 129 - 156 .",
    "n. markopoulos , a. calise , near - optimal , asymptotic tracking in control problems involving state - variable inequality constraints , _ in aiaa guidance , navigation and control conference _ , monterey , california , 1993 .",
    "mosier , g.n .",
    "harris , c. whitmeyer , pegasus air - launched space booster payload interfaces and processing procedures for small optical payloads , in _ international society for optics and photonics _ , 1991 , orlando91 , orlando , fl , p. 177",
    "- 192 .",
    "j. stoer , r. bulirsch , introduction to numerical analysis , translated from the german by r. bartels , w. gautschi and c. witzgall . second edition .",
    "texts in _ applied mathematics , springer verlag _ , 1993 , new york , vol . 12 .",
    "a. wchter , l.t .",
    "biegler , on the implementation of an interior - point filter line - search algorithm for large - scale nonlinear programming , _ mathematical programming _ , 2006 , vol .",
    "106 , p. 25",
    "https://projects.coin - or.org / ipopt_.              j. zhu , e. trlat , m. cerf , planar tilting maneuver of a spacecraft : singular arcs in the minimum time problem and chattering , _ discrete cont .",
    ", 2016 , vol .",
    "4 , p. 1347 - 1388"
  ],
  "abstract_text": [
    "<S> this survey article deals with applications of optimal control to aerospace problems with a focus on modern geometric optimal control tools and numerical continuation techniques . </S>",
    "<S> geometric optimal control is a theory combining optimal control with various concepts of differential geometry . </S>",
    "<S> the ultimate objective is to derive optimal synthesis results for general classes of control systems . </S>",
    "<S> continuation or homotopy methods consist in solving a series of parameterized problems , starting from a simple one to end up by continuous deformation with the initial problem . </S>",
    "<S> they help overcoming the difficult initialization issues of the shooting method . </S>",
    "<S> the combination of geometric control and homotopy methods improves the traditional techniques of optimal control theory .    </S>",
    "<S> a nonacademic example of optimal attitude - trajectory control of ( classical and airborne ) launch vehicles , treated in details , illustrates how geometric optimal control can be used to analyze finely the structure of the extremals . </S>",
    "<S> this theoretical analysis helps building an efficient numerical solution procedure combining shooting methods and numerical continuation . </S>",
    "<S> chattering is also analyzed and it is shown how to deal with this issue in practice .    * </S>",
    "<S> keywords : * optimal control , pontryagin maximum principle , optimality condition , numerical methods , numerical continuation , shooting method , aerospace , attitude control , trajectory optimization , coupled system , chattering . </S>"
  ]
}