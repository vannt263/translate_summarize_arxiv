{
  "article_text": [
    "spatially resolved optical spectroscopy became a tool for studying the dynamics of external galaxies when pease ( 1918 ) observed rotation in the inner part of m31 ( rubin 1995 ) .",
    "later , babcock ( 1939 ) effectively measured an optical `` rotation curve '' of m31 by measuring velocities of individual nebular regions separately .",
    "although required exposure times were very long , somewhat larger samples of rotation curves were amassed in the inner portions of galaxies ( burbidge & burbidge 1975 ) , and finally in the outer regions .",
    "now , optical rotation curves of nearby galaxies can be measured with brief exposure times , enabling the construction of very large samples of rotation curves for statistical purposes ( e.g. rubin et al .",
    "1985 ; mathewson , ford & buchhorn 1992 ; courteau 1997 ) .",
    "improvements in the spatial and velocity resolution of optical spectrographs have revealed complex velocity structure in both elliptical and spiral galaxies .",
    "the phenomena include distinct , nuclear kinematic components in spiral galaxies ( e.g. marziani et al .",
    "1994 ; rubin , kenney & young 1997 ; bureau & freeman 1999 ) , and in the cores of elliptical galaxies ( e.g. franx , illingworth & heckman 1989 ) .",
    "the physics behind the complex velocity structure seen in emission lines is difficult to unravel .",
    "although there are numerous techniques for inferring the line - of - sight velocity structure of a stellar system from a non - gaussian _ absorption _ line profile ( e.g. rix & white 1992 ; van der marel & franx 1993 ; merrifield & kuijken 1994 ) , the analogous measurements for emission - line kinematics are largely unconstrained .",
    "emitting regions have non - uniform internal velocity structure which complicates the structure of the emission lines ( e.g. from individual hii regions ; osterbrock 1989 ) .    to date , estimates of the true kinematic structure of galaxies with complex emission line profiles are largely qualitative ( e.g. rubin et al .",
    "1997 ) , and most rotation curve reductions assign a single velocity at each slit position . in",
    "most longslit , emission - line spectroscopic studies , velocities are computed with some form of gaussian line fitting ( e.g. keel 1996 ) or line centroiding or peak fitting ( e.g. courteau 1997 ; rubin et al .",
    "1997 ) , of either the brightest emission line or a subset of emission lines simultaneously .",
    "mathewson et al . ( 1992 ) and mrquez & moles ( 1996 ) use cross - correlation to measure rotation curves , but without detailed description of their technique .    in this era of large , high - quality rotation curve samples , techniques for",
    "rotation curve reduction need to be re - examined . here",
    ", we evaluate a little - used but easily - implemented technique for longslit rotation curve reduction , cross correlation .",
    "we give special attention to the fact that each aperture along the slit may contain emission from multiple velocities .",
    "the technique ( 1 ) yields a well - defined response to all line profiles  the velocity and error have a clear physical relationship to the observed line profile , ( 2 ) is accurate when extracting redshifts of low signal - to - noise ( s / n ) spectra , and ( 3 ) is easily automated .",
    "focusing on ( 1 ) , we compare the technique to the fundamentally different , parametric technique of gaussian line fitting .",
    "we test the techniques for redshift measurement in a controlled manner , using model spectra with varied properties .",
    "our intent is to highlight the most relevant features of the techniques , not to explore parameter space exhaustively . in   2 , we describe two techniques which represent fundamentally different approaches , cross - correlation and gaussian fitting . in   3 , we test them with single - aperture gaussian and two - component line profiles , to illustrate that when the line profile is non - gaussian , different techniques can yield different results , and to track the error behavior . in   4",
    ", we apply the techniques to two - dimensional model rotation curves to illustrate the error behavior in situations which commonly arise in longslit spectroscopy . in   5 we briefly discuss applying cross - correlation to longslit spectral data .",
    "we conclude in   6 .",
    "we evaluate an effective technique for redshift measurement , cross - correlation ( xc ) , which is little - used for emission - line measurements .",
    "we compare it to an alternative technique , simultaneous emission line fitting ( semlf ; as in keel 1996 ) .",
    "the techniques represent the two fundamentally different approaches to these measurements .",
    "semlf is parametric , involving modeling the emission lines and fitting for the parameters .",
    "xc is non - parametric in the sense that we do not fit for parameters , although the technique does involve assumptions  we use a model spectrum for a template in the computation .",
    "our comparison of the techniques shows that when a single - velocity measurement is ill - defined , as when components at two separate velocities contribute to the spectrum , different approaches yield different results .",
    "thus , these cases must be flagged and dealt with separately for a proper characterization of the velocity structure of each galaxy .",
    "both techniques can be reliably automated , although semlf requires some fine - tuning , as does xc in the low s / n case .",
    "xc is easily implemented with * xcsao * ( see kurtz & mink 1998 ) , within the iraf ( tody 1986 ; 1993 ) environment .",
    "we use a version of semlf based on that of kannappan et al .",
    "( 1999 ) implemented with idl ( landsman 1995 ) .",
    "both techniques apply a specific model to the data  they assume a pre - determined line profile which is usually a gaussian .",
    "however , longslit observations are designed to detect spatially separated components _ at different velocities_. these components may broaden line profiles , or may turn them into double - peaked profiles . when the gaussian model is not a good representation of the data , the techniques will produce different results .",
    "below , we explore results for gaussian and double - gaussian profiles .",
    "we use artificial emission - line spectra with noise to explore and compare the xc and semlf techniques .",
    "we construct the spectra with the * linespec * task in rvsao , and add noise with * mknoise * in noao.artdata .",
    "figure  [ fg : a1 ] shows the basic spectrum , a set of 5 gaussian profiles centered at the major emission lines , h@xmath1 , [ sii ] and [ nii ] , redshifted to 4000.0 km  s@xmath2 .",
    "we choose linewidths typical of spectra taken with a 1200 g / mm grating and a narrow ( 1.0@xmath3 ) slit  h@xmath1 has a full width at half maximum ( fwhm ) of 2.3    @xmath4  104  km  s@xmath2 .",
    "the other lines satisfy 2.26  @xmath5   .",
    "to add the noise , we assume a gain of 1.5 e@xmath6/dn and a read noise of 7.0 e@xmath6 .",
    "although the continuum s / n ratio is not defined in these model spectra , the effective signal - to - noise ratio of the h@xmath1 line is very large in many of them : the h@xmath1 signal in the spectrum in fig .",
    "1 is @xmath02300  e@xmath6 over 5 pixels , so the s / n ratio in h@xmath1 is @xmath045 .",
    "although we vary the s / n ratio in the model spectra in the examples of   3.1 , most of the other test spectra have comparably large s / n ratios .",
    "the discrete pixel sampling scale is @xmath022  km  s@xmath2 .",
    "kurtz & mink ( 1998 ) describe cross - correlation exhaustively for application to redshift surveys , using the task * xcsao * in the rvsao package , within the iraf environment ( tody 1986 , 1993 ) .",
    "they include template construction and error analysis in their discussion .",
    "we apply the xc technique using * xcsao * in rvsao , according to the procedure that would be used for actual data ( excluding bias subtraction , flat - fielding , wavelength calibration , and cosmic ray removal ) .",
    "we construct the template based on the median widths and relative heights of the `` emission lines '' in a large ensemble of model spectra , just as we would for actual data ( see   4 ) . because the high - resolution models are undersampled relative to the optimal sampling rate for * xcsao * , we must adjust the rebinning in * xcsao * , by using both linear and spline3 interpolation and choosing the best result based on the @xmath7 statistic .    fig .",
    "[ fg : a2 ] shows a sample peak in the correlation function , which * xcsao * fits to find the velocity for the spectrum in fig .",
    "[ fg : a1 ] .",
    "because the sample spectrum has a very large s / n ratio and a nearly - perfect gaussian profile , the peak is well - defined and the redshift , @xmath8 , is close to the input model value of @xmath9 .",
    "cross - correlation errors include the effects of spectrum / template mismatch , and therefore have a clear relationship to the spectral profile .",
    "the internal error estimator of kurtz & mink ( 1998 ) follows from the discussion in tonry & davis ( 1979 , td hereafter ) , with the additional assumption that the noise is sinusoidal .",
    "* xcsao * computes an error of @xmath10 , where @xmath11 is the fwhm of the correlation peak and @xmath7 , defined by td , is a measure of the noise based on the antisymmetric part of the correlation function .",
    "td assume that the ( symmetric ) template , convolved with a simple symmetric function , is a noise - free spectral match to the object  that all spectrum / template mismatch is the result of noise . under these assumptions ,",
    "the antisymmetric part of the correlation function yields a measure of the height of the average noise peak  a galaxy with symmetric line profiles , cross - correlated with a template with symmetric line profiles , has noise and no signal in the antisymmetric part of its correlation function .",
    "the error that * xcsao * computes is the shift in the correlation peak center that would result from a spurious noise peak , where @xmath12 is the average distance to the nearest noise peak and , with the assumptions of td , @xmath7 is an estimate of the height of the true correlation peak divided by of the height of the average noise peak .",
    "if @xmath7 is small , there are spurious peaks in the correlation function comparable to or exceeding the highest peak . * xcsao * is likely to fit one of these spurious peaks instead of the true peak ; then the computed velocity is arbitrarily far from the true velocity , much farther than the formal error indicates .",
    "thus , @xmath7 is a measure of the reliability of the redshift .",
    "kurtz & mink ( 1998 ) require @xmath13 for automatic acceptance of the extracted redshift .",
    "however , redshifts with @xmath14 can be used in longslit reduction because there are data in neighboring apertures .",
    "if * xcsao * fits the wrong peak , the redshift will appear discrepant from neighboring apertures and the reduction can be checked manually , or rejected .",
    "if the template has a single velocity component , the assumptions underlying the error estimator are incorrect for spectra with multiple components at different velocities . in this multiple - component case , spectrum / template mismatch results from noise _ and _ from additional peaks in the spectrum at different velocities .",
    "the mismatch generally appears in the antisymmetric part of the correlation function , and @xmath7 _ measures this template mismatch_. thus @xmath7 becomes a measure of how well the template fits the spectrum .",
    "low @xmath7 values indicate a poor fit , and result in large error . @xmath11",
    "also reflects additional nearby velocity components ; an additional nearby component results in a wider correlation peak , a larger @xmath11 and a larger error .",
    "therefore , additional velocity components enlarge xc errors significantly .",
    "below , we explore this effect using model spectra .",
    "kurtz & mink ( 1998 ) find that @xmath15 systemically over or underestimates nuclear redshift errors by @xmath020% . for large redshift surveys consisting of nuclear spectra reduced uniformly with a single template ,",
    "@xmath11 remains roughly constant . in that case",
    ", error calibration can be applied to eliminate the discrepancy .",
    "kurtz & mink ( 1998 ) solve for a template - dependent constant , @xmath16 , where the true error is then @xmath17 .",
    "however , in longslit spectroscopy , where multiple - velocity spectra abound , @xmath11 is not constant . throughout this paper",
    ", we use @xmath15 to estimate xc errors .",
    "we recommend computing errors proportional to @xmath18 for all longslit reduction implemented with xc , because @xmath11 reflects the presence of multiple velocity components and wide velocity components .",
    "the major steps involved in semlf reduction are similar to the steps required to implement cross - correlation , except that we measure velocities by fitting single - gaussian functions to the major emission lines simultaneously , when the lines are detected at @xmath19 .",
    "all spectra reduced with the semlf program were first transformed to log(@xmath20 ) space using the task * transform * in the longslit package of iraf , with an artificial calibration lamp image . in our implementation of semlf ,",
    "the relative wavelengths are fixed and the linewidths are constrained to be the same value for each line ; the overall linewidth and each individual peak height may vary . we derive the formal model - dependent errors from @xmath21-minimization fitting using the gaussian model ( press et al .",
    "1992 ) .    when the minimal @xmath22 , where @xmath23 is the number of degrees of freedom in the fit , the formal errors can not be justified rigorously .",
    "press et al .",
    "( 1992 ) emphasize that these errors are unsuitable when a model is an incorrect representation of the data .",
    "finding the true errors requires other methods ( e.g. monte carlo simulation ) which are usually computationally expensive .",
    "authors generally compute errors that account for photon statistics ; some error calculations are independent of profile shape ( courteau 1997 uses the weighted mean ) and/or include line widths ( keel 1996 )",
    ". however , these errors do not include mismatch between the data and a basic model that in every case assumes a single , well - defined velocity . here , we attempt to partially account for this mismatch , taking an approach guided by the analogy between xc errors and the error derived from weighting by the reduced @xmath21 , because @xmath21 is an estimator of the suitability of the gaussian model and reflects irregular line profiles . although the procedure is not rigorously justified , we consider weighted errors as a computationally convenient way of achieving an estimate of the proper error behavior ; below , we multiply the error by the reduced @xmath24 . we demonstrate that the weighted errors display the expected error behavior and are similar to the xc errors .",
    "this similarity arises because both the xc @xmath25 statistic and the semlf @xmath26 are based on the cross product of the object and model spectra divided by an estimator of the variance .",
    "the formal semlf error performs the same function as the width factor ( @xmath12 ) in * xcsao * ; it provides a scale by which to multiply the goodness of fit measure ( @xmath26 for semlf , @xmath25 for xc ) in order to estimate the uncertainty of the measurement .",
    "the @xmath27 cutoff of semlf is analogous to imposing a lower limit on @xmath7 in the xc technique .",
    "the limit is somewhat arbitrary and could be modified . in general",
    ", we do not modify the limit in our tests , so these tests do not directly compare the effectiveness of the two techniques on very low s / n spectra .",
    "we apply the semlf technique to the spectrum of fig .",
    "[ fg : a1 ] , with a redshift of 4000  km  s@xmath2 .",
    "the resulting fit , with a velocity and weighted error of @xmath28 , is nearly indistinguishable from the spectrum .",
    "thus , both semlf and xc find the correct velocity of the line profiles when they are gaussian ( with large s / n ratios ) .",
    "semlf measures the proper error in the gaussian case ; thus semlf , used with calibration spectra consisting of gaussian line profiles , provides one method of calibrating the xc error when necessary .",
    "in the following sections , we explore the behavior of xc and semlf .",
    "we use one - dimensional spectra with varying line profiles .",
    "we fix the emission line ratios to standard hii region values similar to the xc template .",
    "later , we consider two - dimensional spectra which mimic different features of galaxy rotation curves , including varying emission - line ratios .",
    "all models match the resolution of the data described in   3 .",
    "however , most of the model spectra have larger snr s , and therefore much larger @xmath7 values , than typical rotation curve data .",
    "we apply xc and semlf to a set of 400 single - gaussian spectra identical to fig .",
    "[ fg : a1 ] , except that h@xmath1 s / n ratios vary from @xmath054 to @xmath29 .",
    "xc finds a velocity with @xmath30 for 297 of the spectra ; semlf finds a redshift for 285 using the @xmath31 cutoff ; we use the 283 spectra with results from both techniques for our analysis . fig .",
    "[ fg : a3]a shows a histogram of the difference between the xc velocity and the input model velocity ( solid line ) , superimposed on the difference between the semlf velocity and the model velocity ( dashed line ) for these 283 spectra .",
    "the two distributions are similar .",
    "[ fg : a3]b shows the same quantity divided by the error for each velocity measurement ; the dotted line reflects @xmath26-weighted semlf errors ; the graph is very similar with unweighted errors .",
    "if errors were gaussian and were properly estimated , the histograms would be gaussian with @xmath32 ( shown as the thick dot - dashed line ) .",
    "the results of the two techniques differ little in the case of simple , gaussian line profiles .",
    "these results appear to conflict with those of kurtz & mink ( 1998 ) , who find that cross - correlation is more sensitive than emission line fitting  * xcsao * found reliable velocities for many test spectra which could not be fit with * emsao * , the automatic emission line fitting routine in rvsao .",
    "however , the line fitting algorithm in * emsao * differs substantially from the semlf technique of this paper  we apply constraints to the model we fit , namely the relative wavelengths and widths of the emission lines , thus enabling the fitting of spectra with lower s / n .",
    "therefore , velocities for low s / n spectra should be computed with techniques that assume these or similar constraints .",
    "a single , unresolved velocity component with a symmetric line profile usually dominates a wide - aperture nuclear spectrum of a galaxy ; thus techniques that assign a single , systemic velocity based on the center of a galaxy are appropriate .",
    "however , longslit observations are designed to detect spatially separated components _ at different velocities_. if components at distinct velocities within the same seeing disk are separated by a small velocity difference and are smoothly varying , they may only broaden the line profile .",
    "one example is the unresolved but rapidly rotating inner region of a galaxy with a circumnuclear gas disk .",
    "however , if components are separated by a large velocity they produce a multi - peaked line profile .",
    "examples include the transition region between a rapidly rotating circumnuclear gas disk or a bar and the outer regions of a galactic disk ( rubin et al .",
    "1997 ) . in this case",
    ", the spectrum shows two distinct velocity components .    when line profiles are non - gaussian , xc may yield a different velocity than either semlf or centroiding techniques .",
    "because the goal of these reduction techniques is to assign a single velocity to a spectrum , none of the techniques used for rotation curve reduction , including cross - correlation , completely model the system in the multiple - component case . at best",
    ", an automated technique can reflect the presence of more than one component in the computed error statistics .    to examine the behavior of the reduction methods in the two - component case",
    ", we construct spectra equivalent to fig .",
    "[ fg : a1 ] , except that they have two distinct gaussian velocity components .",
    "[ fg : a4 ]    [ fg : a5 ] show spectra where the intensity ratios of the two velocity components are 2:1 ( fig .",
    "[ fg : a4 ] ) or 4:1 ( fig .",
    "[ fg : a5 ] ) . in each case",
    ", the left part of the figure shows components separated by @xmath33 , or 0.58 of the fwhm of the h@xmath1 line ( 104  km  s@xmath2 ) , and the right side shows components separated by @xmath34 , or 1.5 times the fwhm of h@xmath1 .",
    "the figures show the `` spectrum '' around h@xmath1 ( solid line ) and the semlf fit ( long - dashed line ) , along with the output xc ( dashed vertical line ) and semlf ( dotted vertical line ) velocities .",
    "note that when the velocity resolution differs from the model spectra we present ( the fwhm of h@xmath1 is 104  km  s@xmath2 ) , @xmath35 must be scaled to compare with our results .    in fig .",
    "[ fg : a4]a , the two separate components are not visible as separate peaks .",
    "semlf and xc yield very similar results . in fig .",
    "[ fg : a4]b , @xmath36  two distinct peaks are visible .",
    "the semlf technique fits one wide gaussian to the two components .",
    "in contrast , xc finds a velocity closer to the stronger peak .",
    "the xc error increases by a factor of @xmath016 over the result in fig .",
    "[ fg : a4]a , signaling the presence of the two distinct components .",
    "appropriately , @xmath7 decreases substantially , from 192 to 14 , and and @xmath11 increases from 147 to 182 .",
    "the semlf `` formal '' error in the @xmath34 case is only @xmath0 2 times larger than in the @xmath37 case , but the @xmath26  weighted error is @xmath023 times larger .",
    "we note a similar trend for the spectral components with a larger flux ratio ( 4:1 ) in fig .",
    "[ fg : a5]a ( @xmath38 ) to fig .",
    "[ fg : a5]b ( @xmath39 ) , except that both techniques fit close to the velocity of the brighter peak ( @xmath40 ) . in fig .",
    "[ fg : a5]b , semlf primarily fits the brighter peak , and the secondary peak , which does displace the resulting line profile , is not strongly reflected in the unweighted error . on the other hand ,",
    "the xc error and the semlf weighted error are @xmath05 and 6 times larger , respectively , than the errors in fig .",
    "[ fg : a5]a , indicating model mismatch .",
    "again , @xmath7 decreases substantially from 164 to 29 ; @xmath11 stays roughly the same .",
    "[ fg : a6 ]    [ fg : a8 ] explore these trends for a range of @xmath35 .",
    "the model velocity components have flux ratios of 4:3 , 2:1 or 4:1 ; the brighter component is always at the larger velocity .",
    "the model spectra for each component are identical to the spectra above ( e.g. fig .",
    "[ fg : a5]b provides the points with @xmath39 and flux ratio 4:1 for figs .  [ fg : a6 ]    [ fg : a8 ] ) .    to explore the effects of lesser peaks on the derived velocity for the two techniques , we compare xc and semlf results to the velocity of the brightest component .",
    "[ fg : a6 ] shows the difference between the velocity determined by each technique and the input model velocity of the brighter component , as a function of @xmath35 .",
    "we compare the results to the flux - weighted mean of the h@xmath1 peaks ( thin dotted line ) .",
    "the solid line shows the xc results ; the dashed line shows the semlf results . for small @xmath35 ,",
    "the xc line is close to or above the semlf line  the xc velocity is generally closer to the velocity of the brighter component and semlf tracks the flux - weighted mean . at larger @xmath35 , in models with larger component flux ratios ,",
    "the lines cross  semlf stops tracking the flux - weighted mean and the semlf result is closer to the velocity of the bright component . in the 4:3 flux ratio model ,",
    "semlf switches to fitting only the brighter peak at @xmath41 ( not shown ) ; in this model , the greatest difference between the velocities from the two techniques is 44% of the component separation , when @xmath42 times the fwhm of h@xmath1 . in summary , at low component separation , for all the models , semlf fits closer to the mean of the components , while xc fits closer to the brightest peak . at larger component separation , when the component flux ratio is large , this trend reverses and semlf fits the brighter peak only .",
    "[ fg : a7 ] shows the errors computed by each technique as a function of component velocity separation , for xc ( solid line ) and semlf ( dashed line  unweighted ; dotted line  weighted by @xmath26 ) .",
    "these figures illustrate the necessity of weighting the formal semlf errors by @xmath26 .",
    "the xc errors and the weighted semlf errors increase dramatically as @xmath35 increases , indicating the presence of additional components , although the weighted semlf errors begin to decrease again at very large @xmath35 , for 2:1 or 4:1 flux ratios , when only the strongest peaks enter the fit . in this case",
    ", the @xmath26 remains large , as shown in the next figure .    in fig .",
    "[ fg : a8]a and b , we illustrate the behavior of the xc errors and of the @xmath26 of the semlf gaussian fits for flux ratios of 4:3 and 4:1 ; we plot the @xmath7 value on top , then @xmath11 , then @xmath26 . in the 4:1 flux ratio model",
    "@xmath11 increases until @xmath35 is so large that only one component contributes to the fit and @xmath11 begins to decrease .",
    "however , @xmath7 decreases with @xmath35 for each model at large @xmath35 , signaling the increasing inadequacy of a single - component template as the velocity components separate .",
    "the decrease in @xmath7 accounts for the increase in the errors ; thus the errors increase monotonically as @xmath35 increases . likewise , @xmath26 increases rapidly as @xmath35 increases , slowing only at the very largest @xmath35 , where the component ratio is 4:1 .    in these examples , xc and semlf compute velocities which differ by up to 44% of the component velocity separation .",
    "xc errors increase monotonically , and by a large factor , as the velocity component separation ( @xmath35 ) increases . for larger component flux ratios , the unweighted semlf errors remain small and begin to decrease at large @xmath35 , making them unsuitable for spectra with multiple velocity components .",
    "the @xmath26  weighted semlf errors behave much more like the xc errors , increasing by large factors as @xmath35 increases , although they do not increase monotonically for large component flux ratios with large @xmath35 .",
    "note that because the @xmath26 taken alone does increase monotonically , @xmath26 is preferable to the weighted error as an indicator of multiple velocity components when using semlf .",
    "the cross - correlation technique flags the multiple - component case consistently , even as the secondary component becomes weak or widely separated in velocity from the primary component .",
    "cross - correlation errors are less model - dependent than formal @xmath21-minimization errors in the sense that they include mismatch between the model ( the template ) and the spectrum .",
    "thus in spite of a template - dependent systematic bias in the errors , the cross - correlation errors roughly scale properly ; they even reflect velocity components that do not overlap the strongest component in wavelength .",
    "the @xmath26 of the semlf technique also reflects the presence of secondary velocity components that overlap the main component in wavelength .",
    "here , we model effects from multiple velocity components that can be important in longslit galaxy spectroscopy . we compare the results of xc and semlf .",
    "when neighboring discrete disk components of a galaxy are not sufficiently resolved , they overlap spatially , resulting in spectra with multiple velocity components .",
    "spectra with multiple velocity components also occur when galaxies have kinematically distinct , cospatial components , like circumnuclear disks .",
    "we illustrate these two cases with two - dimensional models of `` rotation curves '' ; we construct the models using artificial one - dimensional emission - line templates , or sums of templates , created with * linespec * in rvsao , joined with * mk1dspec * and * mk2dspec * in nrao.artdata .",
    "[ fg : mod0 ] is an image of a model spectrum which illustrates spatially overlapping components .",
    "[ fg : mod0]a shows a greyscale plot of the region around h@xmath1 of the model longslit spectrum  the dispersion axis is horizontal , while the spatial axis is vertical and spans 100 pixels .",
    "our two - dimensional spectra consist of segments ( the lumps in the image ) with gaussian intensity variations in the spatial direction .",
    "the horizontal lines in the top portion of fig .",
    "[ fg : mod0]b show each segment as a horizontal line across its spatial fwhm , where the spatial direction is along the x - axis .",
    "the actual `` emission '' extends beyond its fwhm .",
    "the y - axis shows the velocity of each segment .",
    "the circles show the results from xc ( left ) and semlf ( right ) , with the errors on an expanded scale at the bottom of the figure .",
    "we show both unweighted semlf errors and semlf errors weighted by @xmath26 .",
    "the velocity structure is gaussian and does not vary along each segment ; line profiles are irregular ( e.g. double - peaked ) where the segments overlap and thus more than one segment contributes to the spectrum .",
    "widths in the dispersion direction are fixed by the basic spectrum , fig .",
    "[ fg : a1 ] , used in the models . as in the one dimensional case ,",
    "we add read noise ( 7.0  e@xmath6 ) and poisson noise to the spectra using * mknoise * in nrao.artdata .",
    "although the model is a step function in velocity , the calculated rotation curve varies smoothly because the segments at different velocities overlap spatially .",
    "the biggest differences between the xc and semlf curves occur between segments , at pixel @xmath055 .",
    "the errors behave similarly for the two techniques .",
    "the errors for both models increase significantly in the overlap regions ; they are larger where adjacent components are separated by larger velocities .",
    "the weighted semlf errors increase by a larger factor than the unweighted errors increase .",
    "as expected , @xmath11 increases in the regions of overlap , and @xmath7 decreases ; @xmath7 also decreases when the signal fades ( e.g. at pixel values @xmath43 ) .    the model in fig .",
    "[ fg : mod2]a resembles a 2-component galaxy with an inner disk ( see e.g. rubin et al .",
    "[ fg : mod2]b shows the positions and velocities of the segments ; each segment has a fwhm of 4 pixels in the spatial direction , although we plot only points . the outer disk model ( dashed line ) approximately traces a standard rotation curve .",
    "the second model component ( thick solid line ) represents an inner gas disk ; it rotates as a solid body , is twice as intense as the outer curve , and has emission lines twice as broad .",
    "[ fg : mod2]b shows that the techniques fit similar rotation curves , with similar errors , to the model . in the cross - correlation case ,",
    "the @xmath25 contribution to the error decreases in the center of the model due to larger signal , but _ the cross - correlation errors increase _ because @xmath11 increases , signaling the presence of the second , distinct velocity component ( see fig .",
    "[ fg : mod2]b ) .",
    "when the formal semlf errors are not weighted by @xmath26 , _ the errors decrease in the center of the model _ due to the larger s / n ratio .",
    "only @xmath26weighted errors reflect the velocity uncertainty due to the two components , because @xmath26 increases as a single gaussian becomes a poor fit",
    ".      nonstandard line ratios ( e.g. in the nuclear regions of agn ) are another potential source of template or model mismatch . in real galaxies ,",
    "non - thermal activity and multiple components often arise together ; we consider a combined model here .",
    "we compare the xc and semlf responses to nonstandard line ratios in the nuclear region using the `` inner disk '' model ; we plot results in fig .",
    "[ fg : a11 ] . the left column of fig .",
    "[ fg : a11 ] shows the model of fig .",
    "[ fg : mod2 ] on top , the xc velocity minus the semlf velocity in the middle , and the errors from the two techniques on the bottom .",
    "the middle column model has [ nii ] lines with heights greater by a factor of ten in the inner disk component ; the outer disk and the [ sii ] and h@xmath1 lines remain the same .",
    "the model we show in the right column has [ nii ] lines that are ten times larger and no h@xmath1 emission in the inner disk component .",
    "again , the outer disk and [ sii ] profiles remain the same  thus , there is a small amount of h@xmath1 emission from the outer disk component .",
    "the velocity structure of the models remains the same .    the changing line ratios influence the results of the techniques somewhat , especially at the edge of the inner disk component .",
    "the peak difference between semlf and xc results occurs at aperture 40 in fig .",
    "[ fg : a11]e , where the difference is @xmath44 , corresponding to @xmath45 of the velocity difference between the inner and outer disks at that aperture .",
    "in xc , the contributions to the velocity from each emission line are effectively weighted by their heights in the template .",
    "h@xmath1 is the strongest emission line in the hii region template we use .",
    "thus , xc weights the contribution of the faint outer disk much more heavily than semlf does , due to its small amount of h@xmath1 emission .",
    "peak heights in semlf may vary to accommodate changing line ratios ; thus the semlf errors increase only moderately .",
    "the xc errors increase due to spectrum / template mismatch .",
    "when the mismatch is severe , the templates can be adjusted .",
    "for example , when balmer absorption eliminates h@xmath1 , the line can be removed from the template .",
    "increased errors may result from many sources , including changing line ratios , lower s / n , or additional velocity components .",
    "all three of these effects increase the @xmath7 error statistic in xc .",
    "@xmath11 reflects multiple velocity components that are not spaced too widely . to determine the cause of increased errors , it is usually necessary to examine the line profiles in the region of interest",
    "however , the dip in the computed rotation curve at the transition between the inner and outer disk ( fig .",
    "[ fg : mod2 ] , aperture 43 ) , accompanied by the increased error , or especially by an increased @xmath11 , provides a strong clue to the nature of the increase  a second velocity component . in automated reduction with xc",
    ", one can select out rotation curves where there are many adjacent points with large errors as candidates for multiple - component systems .",
    "with semlf , the formal errors do not clearly reflect additional components ; they flag only regions of low s / n ratio .",
    "the effects of spectrum / model mismatch are isolated by @xmath26 ; regions with multiple velocity components can be flagged as regions where @xmath26 is significantly greater than 1 .",
    "barton et al . ( 1999 ) use xc to reduce a large sample of rotation curves of galaxies in pairs ; fig .",
    "[ fg : a12]a shows an example .",
    "barton et al .",
    "( 1999 ) describe the reduction procedures in detail .",
    "the curve shows the inner part of cgcg 373 - 046 , which has a separate kinematic component in the center .",
    "the errors enlarge in the center to reflect this component .",
    "[ fg : a12]b shows h@xmath1 and [ nii ] line profiles at various slit positions ; the line profiles are clearly doubled near the center of the galaxy , where the errors enlarge .",
    "the models described in this paper explore only the simplest cases ; they exclude the effects of uncertainty in wavelength solution , night sky contamination , cosmic rays , non - gaussian line profiles other than multiple - component profiles , continuum emission and extra emission lines ( that are not included in the template spectra ) . at minimum ,",
    "the steps necessary for longslit redshift reduction are : ( 1 ) bias subtraction and flat - fielding , ( 2 ) `` line - straightening , '' or solving for the wavelength solution at each pixel in the spatial direction , ( 3 ) cosmic - ray removal and sky subtraction , ( 4 ) a correction for differential atmospheric refraction and ( 5 ) a redshift determination at each point along the slit .",
    "template selection or construction is also necessary , after step ( 4 ) , when cross - correlation is used in step ( 5 ) .",
    "the best template will reflect the spectrum of a typical single - velocity component .",
    "barton et al .",
    "( 1999 ) build cross - correlation templates using the observed relative line heights and widths . to measure line heights and widths for the template",
    ", they run the task * emsao * in the rvsao package ( kurtz & mink 1998 ) which fits unconstrained gaussian functions to the major emission lines with enough signal .",
    "they use each aperture in which * emsao * finds all 5 emission lines ; they compute the median relative line heights and the median absolute line widths for each run ( 4  5 nights ) .",
    "barton et al .",
    "use the resulting values as input parameters to create a template of smooth gaussian `` emission '' lines with * linespec * in rvsao .",
    "they test the performance of separate templates for each observing run , night , and galaxy and find that a run template yields the smallest errors on average . in practice , a single , carefully constructed template used for all data from a particular instrumental setup should suffice for most purposes ( see kurtz & mink 1998 ) .    for the low s / n case , a small amount of fine - tuning is necessary to extract complete rotation curves ; barton et al . find that restricting the wavelength range of allowable solutions to within @xmath01000  km  s@xmath2 of the systemic velocity is easy to implement and yields accurate curves in low s / n regions , although it may exclude extreme cases of separate velocity components . for example , morris et al .",
    "( 1985 ) find a component of ngc  7582 1300  km  s@xmath2 off the systemic velocity . .",
    "we describe the use of cross - correlation to determine velocity fields of nearby galaxies using optical emission lines observed with longslit spectroscopy .",
    "the method is easily automated , makes simultaneous use of the strongest emission lines , and is efficient for low signal - to - noise spectra . as we describe , the technique yields well - defined errors .",
    "we compare cross - correlation to a fundamentally different , parametric technique , simultaneous gaussian fitting of emission lines .",
    "velocities and errors computed by the two techniques agree very well in the case of a single gaussian velocity component .    when line profiles are non - gaussian ( e.g. because more than one component contributes at the same slit position ) , the results of the two techniques differ . in our examples ,",
    "the xc and semlf techniques give velocities which differ by up to 52% of the component velocity separation . for standard hii region emission line ratios and component separations up to 1.5 times the fwhm of h@xmath1 , xc fits closer to the brightest peak and semlf fits closer to the mean . as the separation becomes larger , semlf also switches to the brightest peak .",
    "the formal semlf error and the error computed by xc differ significantly because the xc error consistently reflects mismatch of the spectrum and model ( template ) , whereas formal semlf errors are model - dependent .",
    "however , when semlf errors are weighted by @xmath26 , semlf errors behave much more like xc errors .",
    "only minor differences remain , as the semlf errors do not increase monotonically in reflecting components with increasing velocity separation from the primary velocity component .",
    "thus , the @xmath26-weighting procedure is empirically justified by comparison with xc .    for automated reduction of large data sets , multiple components and other non - gaussian line structures",
    "can be flagged for further inspection using the increase in either the xc error ( or the statistic @xmath11 ) , or the semlf @xmath26 .",
    "however , a complete description of these multiple - component cases _ requires additional modeling _ to explore the different components .",
    "the choice of whether to use xc or semlf should be guided by the following considerations : ( 1 ) xc is readily available as the iraf routine * xcsao * , in the rvsao package .",
    "it is easily automated and requires no initial redshift guess ( although constraints on the allowed solutions are useful for spectra with small s / n ratios ) , ( 2 ) for two - component profiles , xc generally fits closer to the brighter peak , whereas semlf shifts from fitting the flux - weighted mean to fitting the brighter peak for larve @xmath35 and large flux ratios , ( 3 ) both xc errors and the semlf @xmath26 statistic may be used to flag multiple components , ( 4 ) the xc error increases monotonically with peak velocity separation , as does the semlf @xmath26 , but the semlf errors do not behave monotonically because at large @xmath35 , semlf switches to fitting only the brightest peak , ( 5 ) semlf errors are exact in the ideal gaussian case , whereas the overall normalization of the xc errors must be calibrated for each template if @xmath46% errors are not accurate enough , ( 6 ) in xc the choice of template fixes the model emission line ratios and linewidths , whereas these can vary ( or be fit ) , in semlf , and ( 7 ) semlf measures shape information for the line profiles in the single - gaussian case .",
    "we thank d. fabricant , d. mink and s. tokarz for useful discussions and assistance with the software .",
    "e. b. and s. k. received support from harvard merit fellowships .",
    "e. b. received support from a national science foundation graduate research fellowship , and s. k. received support from a nasa graduate student researchers program fellowship .",
    "this research was supported in part by the smithsonian institution .",
    "babcock , h. w. 1939 , lick obs . bull .",
    "19 , 41 barton , e. j. , et al .",
    "1999 , in preparation bureau , m. , & freeman , k. c. 1999 , , 118 , 126 burbidge , e. m. , & burbidge , g. r. 1975 , in stars and stellar systems , vol .",
    "4 , galaxies and the universe , ed .",
    "a. sandage , m. sandage , & j. kristian ( chicago univ .",
    "chicago press ) 81 courteau , s. 1997 , , 114 , 2402 franx , m. , illingworth , g. , & heckman , t. 1989 , , 344 , 613 kannappan , s. j. , et al .",
    "1999 , in preparation keel , w. c. 1996 , , 106 , 27 kurtz , m. j. , & mink , d. j. 1998 , , 110 , 934 landsman , w. b. 1995 , in astronomical data and analysis software and systems iv , asp conference series , vol .",
    "shaw , h.e .",
    "payne , and j.je .",
    "hayes , eds .",
    ", p. 437 marziani , p. , keel , w. c. , dultzin - hacyan , d. , & sulentic , j. w. 1994 , , 435 , 668 mathewson , d. s. , ford , v. l. , & buchhorn , m. 1992 , , 81 , 413 mrquez , i. , & moles , m. 1996 , , 120 , 1 merrifield , m. r. , & kuijken , k. 1994 , , 432 , 575 morris , s. , ward , m. , whittle , m. , wilson , a. s. , & taylor , k. 1985 , , 216 , 193 osterbrock , d. e. 1989 , astrophysics of gaseous nebulae and active galactic nuclei ( mill valley : university science books ) pease , f. g. 1918 , proc .",
    "natl . acad .",
    "sci . , 4 , 21 press , w. h. , teukolsky , s. a. , vetterling , w. t. , & flannery , b. p. 1992",
    ", numerical recipes in c , second edition ( cambridge : cambridge univ . press ) rix , h .- w . , & white , s. d. m. 1992 , , 254 , 389 rubin , v. c. , burstein , d. , ford , w. k. , jr . , & thonnard , n. 1985 , , 289 , 81 rubin , v. c. 1995 , , 451 , 419 rubin , v. c. , kenney , j. d. p. , & young , j. s. 1997 , , 113 , 1250 tody , d. 1986 , in proc .",
    "spie instrumentation in astronomy vi , ed .",
    "d. l. crawford , 627 , 733 tody , d. 1993 , in astronomical data analysis software and systems ii , a.s.p .",
    "conference series , vol .",
    "r. j. hanisch , r. j. v. brissenden , and j. barnes , 173 tonry , j. l. , & davis , m. 1979 , , 43 , 393 ( td ) van der marel , r. p. , & franx , m. 1993 , , 407 , 525"
  ],
  "abstract_text": [
    "<S> longslit spectroscopy is entering an era of increased spatial and spectral resolution and increased sample size . improved instruments reveal complex velocity structure that can not be described with a one - dimensional rotation curve , yet samples are too numerous to examine each galaxy in detail . </S>",
    "<S> therefore , one goal of rotation curve measurement techniques is to flag cases in which the kinematic structure of the galaxy is more complex than a single - valued curve .    </S>",
    "<S> we examine cross - correlation as a technique that is easily automated and works for low signal - to - noise spectra . </S>",
    "<S> we show that the technique yields well - defined errors which increase when the simple spectral model ( template ) is a poor match to the data , flagging those cases for later inspection .    </S>",
    "<S> we compare the technique to the more traditional , parametric technique of simultaneous emission line fitting . when the line profile at a single slit position is non - gaussian </S>",
    "<S> , the techniques disagree . for our model spectra with two well - separated velocity components , </S>",
    "<S> assigned velocities from the two techniques differ by up to @xmath052% of the velocity separation of the model components . </S>",
    "<S> however , careful use of the error statistics for either technique allows one to flag these non - gaussian spectra . </S>"
  ]
}