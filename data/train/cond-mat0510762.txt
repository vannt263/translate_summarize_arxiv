{
  "article_text": [
    "the study of the structure - function relationship of large biomolecules often requires to follow their dynamics on a meso- or even macro - scopic time scale while retaining its atomic scale spatial resolution .",
    "a typical example is molecular and ion transport through channel proteins@xcite .",
    "while structural details of the inner lining of the channel in particular , and that of the protein - lipid - solvent environment in general , are needed at atomic resolution in order to determine the forces that guide the diffusion of the particles across the channel , the duration of the permeation process may exceed by several orders of magnitude the time scale of several tens of nanoseconds currently attainable by all atom molecular dynamics ( md ) simulations@xcite . in this case",
    "a simplified alternative approach is to model the transported molecule in the channel as an overdamped brownian particle that diffuses along the axis of the channel in the presence of an effective _ potential of mean force _ ( pmf ) that describes its interaction with the rest of the atoms in the system@xcite .",
    "a pmf is the landau free energy profile along a _",
    "reaction coordinate _ ( rc ) , or _ _ order parameter__@xcite , and it can be determined from the equilibrium statistical distribution function of the system by systematically integrating out all degrees of freedom except the rc@xcite . in principle , both the effective diffusion coefficient and the pmf , quantities that enter the langevin equation of motion ( or , equivalently , the corresponding fokker - planck equation @xcite ) which determines the dynamics of the transported molecule , can be determined from md simulations . in practice , however , the calculation of free energy differences and pmfs are rather difficult and computationally expensive@xcite .",
    "since even the longest equilibrium md ( emd ) trajectories can sample only a small region of the rc domain of interest , the one situated in the vicinity of the corresponding pmf minimum , simple emd simulations are not suitable for pmf calculations .",
    "the traditional method for calculating pmfs by means of biased emd simulations is _ umbrella sampling _",
    "( us)@xcite . however , us may become inefficient and computationally unaffordable when the number of required sampling windows becomes too large .",
    "this may happen when the amplitude of the equilibrium fluctuations of the rc is very small compared to the size of the rc interval in which the pmf is sought .    in such cases",
    "the rc can be sampled efficiently by employing _ _ steered molecular dynamics__@xcite ( smd ) in which the system is guided ( or steered ) , according to a predefined protocol , along the rc by using , e.g. , a _ harmonic guiding potential _ ( hgp ) . by choosing a sufficiently large value for the elastic constant of the hgp , i.e. , within the _ stiff - spring _ approximation@xcite ( ssa ) , the distance between the target and actual value of the rc at a given time can be kept below a desired value . in general , for a large system ( @xmath4  atoms ) computationally one can afford only a limited number ( typically @xmath5 ) of such _ nonequilibrium _ smd pullings , and the real challenge is to find a way to reconstruct the pmf ( at least semiquantitatively ) along the rc using this limited amount of data . in principle , the equilibrium pmf can be reconstructed from the celebrated _ jarzynski equality _ (",
    "je ) that relates the equilibrium free energy difference @xmath6 between two states to the average of the external work @xmath7 done along all nonequilibrium paths that connect those states and are subject to the preestablished rc variation protocol@xcite . in terms of the _ dissipative work _",
    "@xmath8 , je can be written as @xmath9 , where @xmath10 , @xmath11 is the boltzmann constant and @xmath12 is the temperature of the heat bath ( environment ) .",
    "we note that if the smd pulling occurs infinitely slowly then the system is in equilibrium at all times and @xmath13 ( reversible paths ) .",
    "thus je is trivially satisfied and @xmath14 is the _",
    "reversible work_. in general smd pullings are nonequilibrium with @xmath15 along most of the trajectories .",
    "however , the validity of je depends crucially on a small fraction of trajectories with @xmath16 , that transiently violate the _",
    "second law_. since such trajectories ( whose number decreases exponentially with @xmath17 ) are very unlikely to occur among a few fast smd pullings , it is clear that the sought pmf can not be determined by the direct application of je , except when the pulling paths are close to equilibrium ( i.e. , when @xmath18 ) . under near - equilibrium conditions , the validity of je has been confirmed in an rna stretching experiment@xcite .",
    "also , je has been successfully applied for free energy calculations in computer simulation of small and/or simplified model systems . however , in spite of a large number of papers dedicated to the applications of je and other _ _ fluctuation theorems__@xcite , there are surprisingly few studies which use smd simulations combined with the je to calculate pmfs for large biomolecules@xcite .",
    "the purpose of this paper is to propose a simple and efficient method , referred to as the _ fr method _ , for calculating simultaneously both the pmf @xmath0 and the corresponding diffusion coefficient @xmath1 along a reaction coordinate @xmath2 for a classical many particle system by employing a small number of fast nonequilibrium smd pullings in both forward ( f ) and time reverse ( r ) directions , without invoking je .",
    "in fact , as already mentioned , for such limited number of processes je fails to hold .",
    "the essence of the fr method , detailed in sec .",
    "[ sec : theory ] , can be summarized as follows : several fast f and r smd pullings are carried out within the ssa .",
    "the latter guaranties that ( i ) the rc follows closely its target value determined by the pulling protocol , ( ii ) the change in pmf ( @xmath19 ) is well approximated by the corresponding change in the free energy ( @xmath6 ) of the system biased by the hgp , and ( iii ) the work distribution function @xmath20 along f / r paths is gaussian . a few f and",
    "r smd trajectories are sufficient to sample @xmath20 about its maximum ( see fig .  [",
    "fig : p - w ] ) and , therefore , determine approximately the mean f / r work @xmath21 .",
    "however , the same data is insufficient for even a rough estimate of the variance @xmath22 , i.e. , of the actual width of @xmath20 . from crooks _ _ transient fluctuation theorem__@xcite ( tft ) [ see eq .  ] , which is more general than je , follows that if @xmath23 is gaussian then @xmath24 is also a gaussian with the same variance ( width ) @xmath25 , and peak position @xmath26 .",
    "thus , ( i ) the pmf is given by @xmath27 , and ( ii ) the mean dissipative work is the same for both f and r paths , given by @xmath28 . from @xmath3",
    "the position dependent diffusion coefficient is @xmath29 ) , where @xmath30 is the pulling speed .",
    "thus , the reason why previous studies failed to reconstruct the pmf from _ unidirectional _ smd pullings far from nonequilibrium by using je is because such approach requires the complete sampling of the corresponding work distribution function that is simply impossible to obtain from a limited number of pullings .",
    "( in fact , the sampling of @xmath31 has to be so complete that it must include paths with @xmath16 as discussed above . ) while the mean work can be easily estimated , breaking this up into the pmf and the mean dissipative work ( i.e. , the heat exchanged with the environment ) requires either the knowledge of the precise width ( variance ) of the f work distribution function ( e.g. , when the f smd paths are close to equilibrium and @xmath3 is small ) or additional information that may come from a set of r smd pullings , as outlined above .",
    "the solution to this problem offered by our fr method is surprisingly simple , however , its validity depends crucially on crooks tft ( from which je can be derived ) and the gaussian nature of @xmath20 guaranteed by ssa . in particular",
    ", the conclusion that the mean dissipative work is the same for both f and r smd paths is highly non trivial .",
    "the remaining of the paper is organized as follows . in sec .",
    "[ sec : theory ] we describe in detail the theoretical basis of our proposed fr method.in order to test its efficiency and viability , in sec .",
    "[ sec : res ] we apply the fr method to calculate the pmf and the position dependent diffusion coefficient of water molecules moving across densely packed single walled carbon nanotubes ( swnt ) that connect two water reservoirs .",
    "the obtained pmf is compared with the ones obtained from emd and us simulations .",
    "finally , conclusions are drawn in sec .",
    "[ sec : conc ] .",
    "we consider a classical many particle system ( e.g. , a channel protein in a fully solvated lipid bilayer ) described by the hamiltonian @xmath32 , where @xmath33 represents the coordinates and momenta of all the atoms in the system .",
    "the dynamics of the system may be either deterministic or stochastic , but we assume that the conditions for which je and tft hold are met , i.e. , the dynamics are markovian and preserve the equilibrium ensemble , and the energy of the system is finite@xcite .",
    "these conditions are met in md simulations in both nvt and npt ensembles@xcite .      in general ,",
    "any pmf calculation starts with the identification of a properly chosen rc whose change in time describes the evolution of the state of the system@xcite .",
    "for example , in describing the progression of a transported molecule in a nanopore ( e.g. , channel protein or swnt ) a proper rc is the projection of the com of the molecule ( or of a part of the molecule ) on either the permeation direction across the membrane , hereafter denoted by @xmath2 , or on the axis of the pore .",
    "if the channel is relatively straight then the difference between the two rc choices can be neglected . for simplicity , here we assume that this is always the case .",
    "is the one sampled in f / r smd pullings .",
    "the tail region of @xmath34 corresponding to negative dissipative work is also highlighted.,width=307 ]    by definition , the pmf @xmath0 is determined from the equilibrium distribution function of the system by integrating out all degrees of freedom except the reaction coordinate @xmath2 , i.e. , @xcite @xmath35 \\;,\\ ] ] where @xmath36 is the equilibrium distribution function of the reaction coordinate , @xmath37 is the partition function and @xmath38 is the dirac - delta function whose filtering property guarantees that the integrand in eq .",
    "is nonzero only when the rc has the desired value , i.e , when @xmath39 .",
    "hereafter we use the convention that @xmath2 [ or @xmath40 represents the target value of the rc while @xmath41 represents the actual value of the rc . also ,",
    "unless otherwise stated , throughout this paper the energy is measured in units of @xmath42 , e.g. , in eq .",
    "one needs to set @xmath43 .    in principle , the equilibrium distribution function @xmath36 can be easily computed from emd simulations , since it is proportional to the logarithm of the binned histogram of the rc sampled along the md trajectory . thus , the pmf is readily given by @xmath44\\;.\\ ] ] in terms of the @xmath0 the equilibrium average of any function @xmath45 of the rc can be calculated as    @xmath46\\\\    & = & \\int dz\\ , e^{-u(z ) } f(z )   = \\int dz\\ , p_0(z ) f(z ) \\;.",
    "\\nonumber\\end{aligned}\\ ] ]    in practice , however , even the longest emd trajectories sample only a restricted region of the reaction coordinate domain of interest ( i.e. , within the vicinity of the pmf minimum ) and the direct application of eq .",
    "is impractical .      in order to properly sample energetically more difficult to reach regions",
    ", one needs to _ guide _ or _",
    "steer _ the system towards those regions by employing , e.g. , a harmonic guiding potential ( hgp ) @xmath47 ^ 2 \\;,\\ ] ] where @xmath48 is the stiffness ( elastic constant ) of the hgp . with this extra potential energy ,",
    "the hamiltonian of the new biased system becomes @xmath49 . as a result , atom `` @xmath50 '' in the selection that define the rc will experience an additional force @xmath51 \\frac{\\partial{\\tilde{z}(\\gamma)}}{\\partial{\\mathbf{r}_j}}\\;.\\ ] ] thus",
    ", the hgp ( [ eq : hgp ] ) will force the system to evolve in the configuration space in such a way that at all times @xmath52 stays confined in the vicinity of @xmath2 .    the free energy difference @xmath53 between the equilibrium states of the systems described by the hamiltonians @xmath54 and @xmath55 can then be written as a gaussian convolution of @xmath56 $ ] .",
    "indeed ,    @xmath57      the sought pmf , @xmath0 , can be obtained from eq .   by gaussian deconvolution of the free energy factor @xmath58 .",
    "however , it is more convenient to resort to the large @xmath59 or _ _ stiff - spring approximation__@xcite ( ssa ) . assuming that we seek to determine @xmath0 with a spatial resolution @xmath60 , by choosing the spring constant such that @xmath61 one can easily see that in eq .",
    "the main contribution to the last integral comes from the region @xmath62 , and therefore one can write @xmath63 now , taking the logarithm of both sides in eq .",
    ", one obtains @xmath64 and , therefore , @xmath65 thus , within the ssa the pmf of the unbiased system is well approximated by the free energy difference of the system biased by the hgp . note that in smd simulations , to make sure that the distance between the target @xmath66 and actual @xmath52 values of the rc on average stays smaller than the desired @xmath60 , one needs to chose the spring constant according to @xmath67 where @xmath68 is the highest pmf barrier one wants to explore , and @xmath69 .      in umbrella sampling@xcite",
    ", the range of rc values of interest @xmath70 is divided into @xmath71 _ sampling windows _ centered about conveniently chosen values @xmath72 , @xmath73 .",
    "next , the reaction coordinate is sampled in each window separately by preparing identical replicas of the system and applying the harmonic guiding potential @xmath74 . as a result",
    ", the biased distribution functions can be readily obtained by direct sampling of the reaction coordinate for the biased system , i.e , @xmath75 , where , for brevity , the index @xmath72 has been replaced by @xmath76 . by inverting this equation ,",
    "the equilibrium distribution in each window can be expressed in terms of the biased distribution of the reaction coordinate .",
    "the standard method for efficiently stitching together the biased @xmath77 s in order to obtain the equilibrium @xmath36 , and therefore the sought pmf , is the so called _ weighted histogram analysis method _ or wham @xcite , according to which    [ eq : wham ] @xmath78    with @xmath79 the number of data points used to construct @xmath77 .",
    "the above non - linear coupled wham equations , that need to be solved iteratively , minimize the errors in determining @xmath36 .",
    "when applicable , us combined with wham is perhaps the best choice for calculating pmfs .",
    "in practice , however , one often encounters situations in which the minimum number of us windows required to properly cover the range of rc values of interest is excessively large and the application of the method may become computationally unattainable . molecular transport in channel proteins is a good example .      in smd simulations@xcite , where initially the system is in an equilibrium state characterized by @xmath80 , the target value of the rc @xmath66 ( also referred to as _ control parameter _ ) is varied in time according to a prescribed protocol .",
    "for example , in constant velocity smd ( cv - smd ) @xmath81 , @xmath82 , where @xmath30 is the constant pulling speed equal to the ratio of the total pulling distance to the desired simulation time .",
    "we refer to the smd pulling paths of the system when @xmath83 increases from @xmath84 to @xmath85 as forward ( f ) paths .",
    "the time reverse ( r ) pulling paths are obtained by starting the system from an equilibrium state corresponding to @xmath86 and reversing the sign of @xmath83 in @xmath66 for f paths . in our cv - smd example , this amounts to setting @xmath87 , @xmath82 .",
    "the choice of a sufficiently large spring constant ( see sec  [ sec : ssa ] ) in the now time dependent hgp [ eq .  ] guarantees that the instantaneous rc , @xmath88 , follows closely the target value @xmath66 during the pulling process . thus , cv - smd is a fast sampling method of the rc by driving the system out of equilibrium .",
    "the faster the pulling the more significant is the deviation from equilibrium .",
    "the work done during a cv - smd simulation is given by @xmath89 = k\\int_{z_0}^{z(t ) } dz ( z-\\tilde{z})\\;.\\ ] ]    crooks has shown that under rather general conditions , listed at the beginning of this section , the following nonequilibrium fluctuation theorem holds@xcite    [ eq : crooks ] @xmath90 or @xmath91    here @xmath92 is an arbitrary function of the work @xmath7 , and @xmath93 represents the average over forward / reverse paths or , equivalently , the average with respect to the forward / reverse work distribution functions @xmath20 .",
    "the dissipative work in a f / r process is given by @xmath94 with @xmath95 .",
    "the je follows immediately from eqs .   by setting @xmath96 , and it can be written in any of the following forms    [ eq : jes ] @xmath97 @xmath98    another important equality , that connects the f and r work distribution functions , can be derived from eqs .   by setting @xmath99 and carrying out the integral with respect to @xmath100 .",
    "the result is crooks transient fluctuation theorem@xcite ( tft ) @xmath101 this equation is used to derive our new results in sec .",
    "[ sec : f - r - smd ] .",
    "an increasingly popular alternative for calculating pmfs is based on the application of the je from repeated unidirectional nonequilibrium smd simulations@xcite . within the ssa",
    "the sought pmf can be readily obtained from eqs .   and",
    "@xmath102 here the index @xmath103 indicates that the average is taken over the ensemble of forward pulling paths . as already mentioned , the average of the exponential in eq .",
    "can not be estimated reliably even for a reasonably large number of smd pullings , unless the pulling speed is sufficiently small so that the system is close to equilibrium along the pulling paths .",
    "this is due to the fact that the overlap between @xmath104 and the sampled part of @xmath23 is in general exponentially small .",
    "nevertheless , there exist two approaches that in principle may give fairly good estimates of eq .  , provided that the system is not too far from equilibrium during pullings .",
    "the first method is the cumulant approximation@xcite , according to which    [ eq : pmf - smd-2 ] @xmath105    where for simplicity we have dropped the index `` f '' and @xmath106 is the variance ( 2nd cumulant ) of the work .",
    "it has been shown that within ssa the work distribution function @xmath23 is gaussian , and therefore generally recognized that in this case the cumulant approximation in fact is exact . however , as mentioned in sec .",
    "[ sec : intro ] , the reason why in practice eq .",
    "is valid only close to equilibrium is because smd pulling paths can sample only a narrow region about the peak of the gaussian @xmath23 .",
    "this allows for a fairly accurate determination of the mean work @xmath107 but , in general seriously underestimates the variance @xmath108 .    the second method for evaluating the average in eq .",
    "is a weighted histogram approach suggested by hummer and szabo@xcite , and indirectly by crooks@xcite .",
    "the nonequilibrium fluctuation theorem due to crooks can also be written as @xmath109\\exp(-w_d ) \\right\\rangle_f = \\left\\langle f[z_r(0 ) ]    \\right\\rangle_r = \\left\\langle f[z(t ) ] \\right\\rangle_{eq}\\;\\ ] ] where @xmath110 represents the time evolution of the control parameter during reverse pullings , @xmath111 $ ] is an arbitrary function and the index `` eq '' means the equilibrium average corresponding to the biased system with hamiltonian @xmath112 . by inserting @xmath111=\\delta(z-\\tilde{z})$ ] into eq .",
    "one obtains @xmath113 since the equilibrium average @xmath114 corresponding to the unbiased system contributes only an additive constant to the pmf , from eq .",
    "one obtains the following result    [ eq : pmf - smd - wh ] @xmath115 where @xmath116 \\nonumber \\\\ & & - \\frac{k}{2}[z'(\\tau)-\\tilde{z}(\\tau)]^2\\;. \\end{aligned}\\ ] ]    thus , @xmath0 can be calculated from the work time series obtained in repeated cv - smd simulations by constructing a weighted histogram of the rc according to eqs .  .",
    "this method resembles to the us and wham and is preferable to the cumulant approximation method whenever we have a large number of pulling paths .",
    "however , in the case of large systems when only a limited number of trajectories can be sampled this method is inapplicable because of insufficient data .      in this section",
    "we present our new method for calculating pmfs from few fast smd pullings along the rc in both f and r directions , hereafter referred to as the _",
    "fr method_. we assume that the pullings are done with a sufficiently stiff spring such that the ssa holds ( sec .  [ sec : ssa ] ) . in this case , the f work distribution @xmath23 is gaussian , and according to crooks tft it follows that the r work distribution @xmath24 is also gaussian .",
    "thus one can write @xmath117\\ ] ] where @xmath21 and @xmath118 are the mean work and variance corresponding to the f and r pulling directions , respectively .",
    "the mean dissipative work in the two distinct pulling directions is @xmath119    inserting into and taking into account that @xmath120 , after little algebra it follows that tft can hold only if    [ eq : fr-2 ] @xmath121 and @xmath122 finally , inserting eq .   into",
    ", one finds that the mean dissipative work is the same in both f and r pulling directions , i.e. , @xmath123    equations are the key formulas of our fr method for calculating pmfs from fast f and r smd pullings . assuming that a few ( @xmath124 such smd pullings can sample reasonably well the work about the peak position @xmath21 of @xmath20 , as indicated by the shaded regions in fig .",
    "[ fig : p - w ] , then eqs .   yield essentially with the same degree of accuracy both the desired pmf , @xmath125 , and the mean dissipative work , @xmath3 .",
    "this feature makes the proposed method superior to the currently used approaches described in the previous sections .",
    "in fact , these other methods can only determine the mean total work @xmath126 with some statistical correction either through the cumulant approximation or a weighted histogram method .",
    "furthermore , since it is reasonable to assume that @xmath3 is proportional to the pulling speed @xmath30 , one can readily determine the position dependent friction coefficient @xmath127 from the slope of the mean dissipative work @xmath128 .",
    "then , the corresponding diffusion coefficient is given by the einstein relation ( in @xmath129 energy units ) @xmath130 now that both @xmath0 and @xmath1 are determined , the equation of motion of the rc on a meso ( or macro ) time scale is given by the langevin equation corresponding to an overdamped brownian particle@xcite    [ eq : fr - l - fp ] @xmath131 or equivalently , the corresponding fokker - planck equation for the probability distribution function @xmath132 of the rc @xmath133    where @xmath134 is the langevin force ( modeled as a gaussian white noise ) and @xmath135 is the probability current density .",
    "we emphasize again that far from equilibrium the variance @xmath136 of the f / r work calculated from smd pullings data [ cf .  ]",
    "is in general much smaller than the variance @xmath137 of the actual work distribution function , and therefore it can not be used to estimate even approximately the mean dissipative work , unless an exponentially large number of smd trajectories are collected and used for this purpose .",
    "finally , we note that @xmath23 and @xmath24 are identical gaussians centered about @xmath126 and @xmath138 , respectively .",
    "one can also define a distribution function for the dissipative work through @xmath139 , which is centered about @xmath3 ( fig .",
    "[ fig : p - w ] ) .",
    "this allows us to calculate the fraction of the smd trajectories that violates the second law , i.e. , for which @xmath16 ; these trajectories are crucial in establishing the validity of the je . we have @xmath140 which clearly indicates that for @xmath141 ( i.e. , @xmath142 in si units ) the number of such trajectories is exponentially small , and finding any of them in smd simulations of large biomolecules is rather unlikely .",
    "the idea of combining results from both f and r simulations is not new , dating back to the original bennett s _ _ acceptance ratio method__@xcite .",
    "however , in previous such studies@xcite the focus was mainly on determining the free energy difference between two states and to estimate the corresponding error , unlike in our fr method in which the pmf , the mean dissipative work and the corresponding diffusion coefficient are determined simultaneously from specially designed f and r pullings with gaussian distributed work .",
    "for example , starting from the nonequilibrium fluctuation theorem and following the general philosophy of the bennett acceptance ratio method , crooks has shown@xcite that the best estimate ( i.e. , with smallest error ) of the free energy [ see eqs .",
    "] @xmath143 is obtained by choosing the @xmath144 $ ] , where @xmath145 represent the number of f / r paths sampled .",
    "essentially the same result was derived by pande and collaborators@xcite by applying the _ maximum likelihood estimator _ ( mle ) method to crooks tft .",
    "thus , the best estimate of the free energy difference @xmath6 between two equilibrium states corresponding to the rcs @xmath80 and @xmath66 is given by the solution of the following transcendental equation @xmath146 in order to calculate the pmf @xmath0 along the rc , @xmath2 , by using the above mle method , first , one needs to divide the domain of interest @xmath147 into @xmath148 intervals determined by the division points @xmath72 , @xmath149 .",
    "then the system needs to be steered into these point via smd , and in each of them it needs to be equilibrated .",
    "then , depending on the available computational resources , a well defined number of f and r cv - smd pullings should be carried out between adjacent division point , each time starting from a different equilibrium configuration . finally , solving eq .   within the ssa",
    ", one determines the change @xmath150 along each segment @xmath151 .",
    "although , strictly speaking , the above methods that combine f and r smd pullings can determine the free energy difference between initially equilibrated states , in practice we find that in many cases eqs  - give good results even between the division points @xmath72 ( see sec .",
    "[ sec : cnt - pmf - smd ] ) .",
    "this means that @xmath148 does not need to be a large number , and therefore the computational overhead due to the intermediate equilibrations can be significantly reduced .",
    "in this section we calculate the pmf that guides the translocation of water molecules across a periodic structure of densely - packed swnts , as well as , the corresponding position dependent diffusion coefficient .",
    " , @xmath152     and @xmath153   ) of the simulated water and swnt system using van der waals and surface representations .",
    "water molecules cross the swnts in single files . figure rendered with vmd@xcite.,width=307 ]    the choice of this system as a testing ground for our fr method was motivated by the following .",
    "first , water filled swnts are nontrivial many particle systems comprising thousands of atoms , yet they are easy to simulate and the pmf of waters inside the swnts can be easily tuned by changing the van der waals interaction parameters between the carbon and water molecules@xcite .",
    "second , swnts are hydrophobic nanopores that can be regarded as simplified models for the much more complex channel proteins .",
    "thus , they are ideal for testing new computational methods and hypothesis that later can be applied to protein channels .",
    "finally , during the past few years , swnt have been intensively studied through md simulations revealing many interesting and surprising properties . in particular",
    ", these simulations revealed that hexagonally packed ( 6,6 ) swnts , with diameter of 8.1   , spontaneously fill with a single file of water molecules when connecting two water reservoirs .",
    "water molecules diffuse across the tubes in a concerted fashion , with a diffusion rate close to the corresponding bulk value .",
    "this correlated motion can be described rather well with a continuous - time random walk ( ctrw ) model@xcite . as an alternative to the ctrw model , here we propose a more general stochastic model in which the motion of each water molecule along the @xmath154axis of a swnt is characterized by an effective ( position dependent ) diffusion coefficient @xmath1 and a pmf , @xmath0 .",
    "both quantities can be determined efficiently and simultaneously by our fr method .",
    "we consider a periodic system ( see fig .  [",
    "fig : cnt ] ) of 4 hexagonally - packed identical swnts of ( 6,6 ) armchair type .",
    "each swnt ( 156 atoms ) has a c@xmath155c diameter of @xmath156 and length @xmath157 . on both sides of the swnts",
    "there is a water layer of width @xmath158 .",
    "the system contains @xmath159 water molecules in total .",
    "the unit cell has dimensions @xmath160 and contains a total of @xmath161 atoms .",
    "all md simulations were performed in the npt ensemble ( @xmath162  k and @xmath163  atm ) , using periodic boundary conditions and the pme method for full electrostatics@xcite .",
    "water molecules were modeled as tip3p@xcite . to facilitate the comparison between the pmfs obtained with different methods , the van der waals parameters of the c atoms ( of type ca for benzene in the charmm force field)@xcite were changed ( from @xmath164 to @xmath165 , and from @xmath166 to @xmath167 , respectively ) to artificially increase the size of the potential barriers in the pmf from @xmath168 to @xmath169 .",
    "all simulations were performed with the program namd2@xcite , with a performance of @xmath170  1  day / ns on 8 cpus of a g4 beowulf cluster ( preferred for repeated smd pullings ) , or @xmath170  12  hours / ns on 24 cpus ( preferred for long emd simulations ) . just like in previously reported simulations@xcite , the initially empty swnts filled up completely with water ( i.e. , 5 molecules per nanotube ) in the first few hundreds of ns . also , the arrangement of the swnts prevented water molecules from entering the space between them .",
    "the pmf @xmath171 [ eq .  ] was determined from a 9  ns long emd trajectory recorded after the system was equilibrated .",
    "the histogram @xmath36 was constructed by binning the @xmath2-coordinate of the o - atoms of all water molecules .",
    "no visible change in the normalized distribution @xmath36 could be noticed when the first 7  ns part of the emd trajectory was used to build it , indicating that the sampling was complete . inside the swnts ( see fig .",
    "[ fig : cnt - pmf]a ) @xmath171 has five equidistant minima ( water binding sites ) with separation distance @xmath172 and almost identical potential barriers of height @xmath173 .",
    "it is convenient to label these minima from 1 to 5 along the positive @xmath2-direction .     of a water molecule along the @xmath2-axis of one of the swnts obtained through equilibrium md simulations .",
    "the included snapshot illustrates a completely filled swnt with five water molecules located about the corresponding pmf minima .",
    "( b ) comparison between @xmath171 ( thin curve ) and the same pmf @xmath174 ( thick curve ) obtained from umbrella sampling .",
    "graphics rendered with the program vmd@xcite.,width=307 ]    on both sides , moving away from the swnts into the bulk water the pmf exhibits three more minima ( labeled @xmath175 and @xmath176 , respectively ) before it flattens out .",
    "water molecules to move in an out the swnts [ i.e. , to hop between minima @xmath177 and @xmath178 must overcome roughly the same energy barrier as the ones located inside the tubes . however , there is a strong spatial inhomogeneity of the water distribution right outside the nanotubes that is related to the large asymmetry of the energy barrier connecting minima @xmath179 and @xmath180 , respectively . the pmf profile is reflected by the snapshot of the water molecules in fig .",
    "[ fig : cnt - pmf]a and is compatible with the observation that single - file water transport through swnts usually occurs in unidirectional bursts .",
    "we have also determined the pmf , @xmath174 , inside the swnts by using umbrella sampling and wham , as described in sec .",
    "[ sec : us - wham ] .",
    "a total of six sampling windows were used . for convenience ,",
    "these were centered , by means of hgps with @xmath181 , on the six maxima within the swnts of @xmath171 .",
    "the samplings of the biased systems were carried out through 5  ns long emd simulations . to speed up the computation ,",
    "the hgps in the four swnts were centered on different maxima .",
    "thus each emd trajectory provided four biased distribution histograms @xmath77 .",
    "the fact that these were properly sampled was tested by making sure that the histograms corresponding to the first 4  ns part of the emd trajectory coincided with the one obtained from the entire trajectory . finally , @xmath174 was determined by solving the wham eqs .  .",
    "as shown in fig .",
    "[ fig : cnt - pmf]b , the agreement between the calculated @xmath171 and @xmath174 is rather good , though not perfect .",
    "next , by employing our new fr approach described in sec .",
    "[ sec : f - r - smd ] , the pmf @xmath182 was determined from a small number of fast f and r cv - smd pullings of water molecules across the swnts . in each cv - smd simulation",
    "four water molecules were pulled across the swnts ( one molecule per nanotube ) by applying a stiff ( @xmath183 ) hgp [ see eq .  ] that moved with @xmath184   / ns along the @xmath2-axis of the nanotubes .",
    "only four such pullings were performed in both f and r directions between the extremities of the interval @xmath185 $ ]   .",
    "each cv - smd simulation was started from an equilibrated configuration ( in accordance with the applicability of crooks tft ) and was 1  ns long .",
    "out of the @xmath186 f and r trajectories only those where retained for analysis in which the corresponding swnt remained filled with water at all times . in several cases ,",
    "once the pulled water molecule crossed halfway the channel the binding sites behind it remained unoccupied . since such configurations correspond to a different free energy profile , such trajectories must be dropped in determining the pmf for a completely filled swnt .",
    "thus , we ended up with 7 f and 14 r paths for calculating the pmf .",
    "is shown as a thick solid curve .",
    "( c ) comparison between @xmath171 ( thin curve ) and @xmath187 ( thick curve ) , obtained from fast forward and reverse smd pullings .",
    "vertical dashed lines indicate the extremities of swnts.,width=307 ]    because we already know the `` exact '' pmf @xmath171 , we deliberately did not choose to add more trajectories from extra simulations .",
    "indeed , since in the case of large biomolecules one can afford only a small number of smd runs , our goal here is to test the viability of the proposed fr method for calculating pmfs under such unfavorable conditions .",
    "the external work along the f and r paths , including the mean work @xmath21 , are shown in fig .",
    "[ fig : pmf - cnt]a and b , respectively .",
    "note that in order to display @xmath188 on the same plot with @xmath189 , the sign of the former needs to be reversed and shifted to the origin of the latter . as shown in fig .",
    "[ fig : pmf - cnt]c , within the swnts ( indicated by dashed vertical lines ) the pmf @xmath190 agrees surprisingly well with @xmath191 and @xmath192 .",
    "we have checked ( results not shown ) that by increasing the pulling speed to @xmath193 and using a similarly small number of f and r trajectories , the quality of the obtained pmf is very similar to the one shown in fig .",
    "[ fig : pmf - cnt]c",
    ". however , in this particular case , the higher the pulling speed the most likely that the swnts will partially empty during pulling and , therefore , more runs are necessary to collect a minimum number of paths for calculating the pmf . as discussed in sec .",
    "[ sec : smd - tft - je ] , for tft to be valid it is necessary that the initial states of both f and r pullings be sampled from an equilibrium distribution .",
    "thus , strictly speaking the above results using the fr method applies only to the two ends of the considered interval .",
    "the good agreement between @xmath194 and @xmath191 suggests that our method may give reliable pmfs for all values of the rc @xmath2 in the considered interval .",
    "however , as shown next , it is simple to extend our fr method to cases where this issue may impact negatively on the determination of the pmf .",
    "thus , the rc interval was divided into 40 segments of the same length . for each division point , the system was equilibrate for a few hundreds of ns by using the same hgp centered about those points .",
    "starting from statistically independent equilibrium configurations , 4 pullings with the same @xmath195   / ns in both f and r directions were carried out on each segment .",
    "none of the swnt emptied during these short cv - smd runs and , therefore , all trajectories were used for analysis .",
    "the resulting pmf , @xmath196 , is shown in fig .",
    "[ fig : pmf - smd]a .",
    "the agreement with the previously determined @xmath194 is fairly good , especially inside the swnts .",
    "closer inspection suggests that compared to the `` exact '' @xmath191 , @xmath197 is not as good as @xmath194 . thus , one may conclude , that more sampling in the fr method does not necessarily give better results .",
    "indeed , in the fr method we only need a good estimate of the mean f and r work , and not a complete sampling of the corresponding work distribution functions .",
    "however , it is very difficult to estimate how good is the mean work calculated from a few fast pullings .",
    "also , we have calculated the pmf in the division points by using the mle method , as shown in fig .",
    "[ fig : pmf - smd]a .",
    "the @xmath198 points fall right on the @xmath197 curve , suggesting again that in the fr method the quality of the sampled paths is more important than the optimal statistical analysis of the trajectories .        in fig .",
    "[ fig : pmf - smd]b the mean f and r work is plotted for both cases when the f / r pullings are done in one shot ( thick curves ) and on the segments separately ( thin curves ) .",
    "while @xmath138 for both cases match almost perfectly , the difference between the corresponding mean f work is quite significant and most definitively is the source of discrepancy between @xmath194 and @xmath197 .",
    "this difference may be due to the smaller number of f trajectories used in case one , or to partially emptied sites towards the ends of the swnts during the simulations along the segments that were not accounted for properly .",
    "however , it is worth noticing that the mismatch between the pmfs is less pronounced than for the mean f work .    in any event",
    ", for the same smd data , the fr method gives far better results than the currently used cumulant approximation method based on je ( see sec .  [",
    "sec : pmf - smd - je ] ) . in fig .",
    "[ fig : pmf - smd]c the pmfs determined by applying the cumulant approximation separately to f and r trajectories , i.e. , @xmath199 and @xmath200 , are compared to @xmath194 .",
    "it is clear that both @xmath199 and @xmath200 are biased in opposite directions .",
    "apparently this behavior was recognized in previous work in which the pmf of a glycerol molecule in a glpf channel was calculated for the first time . to eliminate the bias from only f pullings , the authors partitioned the glpf channel into 12 segments and artificially applied in an alternating fashion f and r pullings in adjacent segments .",
    "our fr approach for determining pmfs naturally solves this biasing issue due to the invalidity of je for few , fast unidirectional smd trajectories .",
    "we also note that the arithmetic mean of @xmath199 and @xmath199 ( fig .",
    "[ fig : pmf - smd]c ) matches rather well @xmath194 indicating that in fact the 2nd cumulant correction of the work to the pmf is irrelevant in the fr method , in which the mean dissipative work @xmath201 is already correctly accounted for by combining f with r paths .",
    "next , we focus on the determination of the mean dissipative work and the corresponding diffusion coefficient .     in the corresponding dissipative work @xmath202 is determined from the fr ( thick ) and the cumulant approximation ( thin ) methods , respectively.,width=326 ]    in fig .",
    "[ fig : wd]a the mean dissipative work derived from the individual f / r pullings and from the fr method are plotted . as expected",
    ", @xmath203 calculated from the variance of @xmath204 seriously underestimate @xmath3 determined from the fr method by using eq .  .",
    "this observation has several consequences .",
    "first , the fact that @xmath205 does not increase fast enough with the pulling distance clearly indicates that only a small region about @xmath21 of @xmath20 is sampled and not the entire work distribution function .",
    "second , the strongly biased pmfs @xmath206 , obtained from the cumulant approximation , lead to underestimated dissipative work @xmath207 that give the false impression that the je equation is satisfied along the f / r pullings , as shown in fig .",
    "[ fig : wd]b ( thin curves ) .",
    "this , of course , is expected because @xmath206 are calculated based on the assumption that je holds .",
    "the reality is that , in fact , je fails to hold for both f and r pullings as the system departs from equilibrium .",
    "the reason , of course , is that paths with negative dissipative work ( @xmath16 ) that are crucial for the validity of je ( eq .  )",
    "are not sampled .",
    "this is clearly illustrated in fig .",
    "[ fig : wd]b where @xmath208 , plotted by using the correct expressions @xmath209 ( thick curves ) , decay rapidly towards zero as the system is pulled away from equilibrium .",
    "clearly , the larger the deviation from equilibrium",
    "the less je is satisfied .",
    "the position dependent @xmath1 can be calculated from the slope of @xmath3 according to eq .  .",
    "since the mean dissipative work is almost linear it is not surprising that the diffusion coefficient has an almost constant value @xmath210  @xmath211/ns .",
    "this is more than three times smaller than the bulk diffusion coefficient of water @xmath212  @xmath211/ns .",
    "the determined @xmath213 and @xmath214 provide the input in the fpe eq .   for describing water transport through swnt on meso / macro time scales .",
    "this should be regarded as a generalization of ctrw model of berezhkovskii and hummer @xcite . in principle , by solving the fpe for the nonequilibrium distribution function @xmath132 for well defined initial and boundary conditions one can completely characterize the single - file transport of water molecules in the considered swnts .",
    "a detailed analysis along this line will be reported in another publication .    in the ctrw model single - file water molecules",
    "occupy the binding sites ( pmf minima ) within the swnt .",
    "since they can not pass each other , the diffusion of water molecules across the nanotube is brought about by random hops to the empty binding sites right in front or behind them .",
    "the waiting ( or residence ) time between two consecutive hops is a stochastic poisson process . besides the equidistant spacing between two adjacent sites @xmath215 ,",
    "the mean waiting time @xmath85 is the defining parameter of the ctrw model . in terms of @xmath85",
    "the effective diffusion coefficient is @xmath216 .    in our stochastic model @xmath85",
    "is identified with the mean first passage time@xcite ( mfpt ) from one minimum ( @xmath72 , @xmath217 ) of the pmf @xmath0 into the adjacent one @xmath218 , with @xmath219 , and is given by @xmath220 now , the mean waiting time can be expressed as @xmath221 in our case @xmath222 and the corresponding mean waiting time @xmath223 . applying our stochastic model to the pristine swnt considered in ref .",
    "( for which the barrier height between binding sites is only @xmath224 compared to @xmath173 in our modified swnts ) one obtains @xmath225  ns that compares very well with the reported @xmath226  ns .",
    "furthermore , the effective diffusion coefficient @xmath227 of single - file water molecules in swnts can be defined as @xmath228 where @xmath229 is the mean spacing between two adjacent binding sites .",
    "@xmath227 describes the diffusion of fictitious particles in the absence of the pmf with the same mean diffusion time on a distance @xmath230 as the mean waiting time @xmath231 . in our case",
    "we get @xmath232 .",
    "it is this diffusion coefficient that can be measured from the well known asymptotic formula @xmath233 from emd simulations .",
    "indeed , from our simulations we obtain @xmath234 , in very good agreement with the result from our stochastic model .",
    "finally , one can calculate the mean permeation time @xmath12 across the channel in two different ways : ( i ) as the mfpt from one end of the nanotube to the other , and ( ii ) as @xmath235 , where @xmath236 is the length of the swnt . in both cases one obtains essentially the same result : @xmath237  ns between @xmath238 and @xmath239 , and @xmath240  ns between @xmath241 and @xmath242 ( i.e. , between the binding sites right outside the ends of the swnts ) .",
    "the observed 12 permeations per nanotube in 9  ns corresponds to a permeation time 1.38  ns that is a good estimate for @xmath12 but it is considerably shorter than @xmath243 .",
    "thus , even in this relatively simple case very long emd simulations are needed to calculate the unidirectional water flux through the modified swnts by simply counting the number of full permeations of water molecules , reinforcing once again the value of our stochastic modeling approach .",
    "the potential and value of crooks tft for determining free energy profiles is becoming more apparent both theoretically@xcite and experimentally@xcite . in this paper",
    "we have shown that by employing crooks tft@xcite within the stiff spring approximation the potential of mean force along a suitably chosen reaction coordinate can be determined ( at least semiquantitatively ) from combining a few fast forward and time reversed nonequilibrium processes started from an equilibrium configuration and subject to the same evolution protocol of the reaction coordinate . in the proposed fr method",
    "one determines simultaneously both the pmf ( @xmath244 ) and the mean dissipative work ( @xmath3 ) without invoking je .",
    "in fact , je is not even satisfied for fast f or r pullings simply because processes with negative dissipative work ( that transiently violates the second law and are exponentially small in number ) are not sampled .",
    "the fr method is based on a key observation involving crooks tft ( which is more general than je ) : whenever the f work distribution function @xmath23 is gaussian ( e.g. , in the case of the stiff - spring approximation ) then @xmath24 is also gaussian .",
    "furthermore , @xmath20 have the same width and are shifted by precisely twice the corresponding free energy difference between the equilibrium states connected by the f and r processes .",
    "thus , both @xmath244 and @xmath3 can be readily determined from the mean f and r work ( @xmath21 ) .",
    "the practical success of the fr method stems from the fact that the mean work @xmath204 can be measured rather accurately from only a few fast f / r pullings .",
    "this also explains why previous methods , based on the direct application of je , fail to work away from equilibrium , making them inefficient for practical applications .",
    "indeed , the width of @xmath20 , which is proportional to @xmath3 , can not be determined even approximately from a few unidirectional pullings , unless these are close to equilibrium and rendering @xmath20 sufficiently narrow .",
    "this fr method works rather well for both small and large ( e.g. , biomolecular ) systems .",
    "although here we applied and tested the fr method in the context of smd simulations , in principle this can be applied equally well to analyze properly designed single molecule experiments .    to test its viability ,",
    "we have applied the fr method to determine the pmf and position dependent diffusion coefficient of single - file water molecules in swnts .",
    "the derived pmf was found to be in good agreement with the one obtained from standard emd methods , e.g. , umbrella sampling . in case of large biomolecular systems ,",
    "when emd methods become computationally unaffordable , the proposed fr method may provide the only hope for determining pmfs .",
    "in addition , the fr method has the unique feature that it determines simultaneously both the pmf and the corresponding position dependent diffusion coefficient .",
    "these two quantities then can be used in a stochastic model that permits the study of the dynamics of the system along the reaction coordinate on meso / macro time scale by retaining its microscopic spatial resolution .",
    "for example , our stochastic model provides a generalization of the recently proposed ctrw model for single - file water transport in swnts@xcite .",
    "this work was supported in part by grants from the university of missouri research board , the institute for theoretical sciences , a joint institute of notre dame university and argonne national laboratory , the u.s .",
    "department of energy , office of science through contract no .",
    "w-31 - 109-eng-38 , and nsf through fibr-0526854 ."
  ],
  "abstract_text": [
    "<S> in general , the direct application of the jarzynski equality ( je ) to reconstruct _ potentials of mean force _ ( pmfs ) from a small number of nonequilibrium unidirectional _ steered molecular dynamics _ ( </S>",
    "<S> smd ) paths is hindered by the lack of sampling of extremely rare paths with negative dissipative work . </S>",
    "<S> such trajectories , that transiently violate the _ second law _ , are crucial for the validity of je . as a solution to this daunting problem , we propose a simple and efficient method , referred to as the _ fr method _ , for calculating simultaneously both the pmf @xmath0 and the corresponding diffusion coefficient @xmath1 along a reaction coordinate @xmath2 for a classical many particle system by employing a small number of fast smd pullings in both forward ( f ) and time reverse ( r ) directions , without invoking je . by employing crook s _ transient fluctuation theorem _ ( that is more general than je ) and the stiff spring approximation , we show that : ( i ) the mean dissipative work @xmath3 in the f and r pullings are equal , ( ii ) both @xmath0 and @xmath3 can be expressed in terms of the easily calculable mean work of the f and r processes , and ( iii ) @xmath1 can be expressed in terms of the slope of @xmath3 . to test its viability , </S>",
    "<S> the fr method is applied to determine @xmath0 and @xmath1 of single - file water molecules in single - walled carbon nanotubes ( swnts ) . </S>",
    "<S> the obtained @xmath0 is found to be in very good agreement with the results from other pmf calculation methods , e.g. , umbrella sampling . </S>",
    "<S> finally , @xmath0 and @xmath1 are used as input in a stochastic model , based on the fokker - planck equation , for describing water transport through swnts on a mesoscopic time scale that in general is inaccessible to md simulations . </S>"
  ]
}