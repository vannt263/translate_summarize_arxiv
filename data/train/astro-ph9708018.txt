{
  "article_text": [
    "a major goal of observational cosmology is the determination of the primordial power spectrum of mass fluctuations , @xmath0 .",
    "this spectrum is a direct prediction of theories of cosmic structure formation , and precise measurements of @xmath0 would allow one to test these theories and constrain cosmological parameters , especially when combined with constraints from cosmic microwave background ( cmb ) anisotropies on very large scales .",
    "most efforts to measure @xmath0 have focused on galaxy redshift surveys .",
    "this route to the primordial power spectrum has several obstacles , including shot noise stemming from the discrete nature of the galaxy distribution and non - linear gravitational evolution of @xmath0 , which is important over much of the accessible range of scales .",
    "the most difficult problem to overcome is the uncertain relation between the galaxy and mass distributions , usually parametrized in terms of a ( possibly scale - dependent ) `` bias factor '' between the galaxy and mass power spectra .",
    "furthermore , galaxy redshift surveys primarily probe structure at a single epoch , redshift zero .",
    "there are studies of clustering evolution , but the noise problems that afflict power spectrum measurements are even more severe in dilute , high redshift samples , and the evolution of bias is uncertain .",
    "recent theoretical models of the  forest predict a tight , physically simple relation between the optical depth for  absorption and the underlying mass density ( @xcite ; @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) .",
    "this paper describes a method that exploits this tight relation to recover the mass power spectrum in the high redshift universe from qso absorption spectra .",
    "we test the method using cosmological simulations and present an illustrative application to a single qso spectrum ( of q1422 + 231 ) .",
    "studies of the autocorrelation function of  forest lines have shown little evidence for clustering on velocity scales @xmath9 and only weak clustering on smaller scales ( @xcite and references therein ) .",
    "pando & fang ( 1995 ) , however , find significant large scale clustering in a power spectrum analysis of forest lines , using a technique based on wavelets .",
    "correlation analyses of metal line absorbers also show evidence for large scale clustering ( @xcite ; @xcite ; @xcite ; @xcite ) .",
    "the approach we take in this paper differs from these earlier studies in several respects .",
    "first , we work directly with the observed flux instead of with lines identified from it ( as in the autocorrelation analyses of press & rybicki [ 1993 ] and zuo & bond [ 1994 ] , though we focus on the power spectrum rather than the autocorrelation function ) .",
    "this approach has the advantage of reducing shot noise , as information in the continuous qso spectrum is not condensed into a relatively small set of discrete numbers ( line redshifts ) .",
    "it also circumvents ambiguities associated with line - identification algorithms , and it can be applied to spectra that have insufficient spectral resolution and/or signal - to - noise ratio for secure line identification . equally important ,",
    "we show how to recover the _ amplitude _ of the mass power spectrum from our measurements .",
    "the power spectrum of lines would be related to this quantity by an uncertain , and probably model dependent , `` bias factor '' of forest lines .",
    "our method is motivated by and relies upon the physical picture of the  forest that has emerged from hydrodynamic simulations of cosmic structure formation ( @xcite ; @xcite ; @xcite ; @xcite ) and related analytic models of the intergalactic medium ( @xcite ; @xcite ; @xcite ; hui 1997 ; @xcite ) . in this picture , the  forest arises in highly photoionized gas with density typically between 0.1 and 10 times the cosmic mean . for most of the gas in this density regime , the  optical depth obeys the approximate relation @xmath10 , where @xmath11 is the density of neutral hydrogen , @xmath12 is the temperature of the gas , and @xmath13 is the local baryon density .",
    "baryons trace the dark matter in this density regime , and the interplay between cooling by the expansion of the universe and heating by photoionization leads to a simple , tight relation between gas density and temperature ( @xcite ; @xcite ) .",
    "thus , to a good approximation , the optical depth satisfies @xmath14 , with @xmath15 .",
    "this discussion ignores the effects of peculiar velocities , thermal broadening , shock heating , and collisional ionization , but simulations with all of these effects included retain the tight relation between @xmath16 and @xmath17 ( see figure  2 of @xcite ) .",
    "the transmitted flux in a qso spectrum , @xmath18 , is monotonically related to @xmath17 in this approximation .",
    "fluctuations in the density field along the line of sight to the qso produce fluctuations in the absorption , which are seen as the  forest . because the relation between @xmath16 and @xmath17 is fairly simple",
    ", one can extract information about the underlying mass density field from the observed flux distribution .",
    "one approach would be to invert the above relations , deriving @xmath16 from @xmath19 and @xmath17 from @xmath16 .",
    "however , the mapping between @xmath17 and @xmath19 is non - linear ( an exponential of a power law ) , and it depends on the unknown constant of proportionality in the @xmath20 relation .",
    "also , it is difficult to measure @xmath16 accurately in saturated regions , where @xmath21 .    rather than attempt a direct inversion , in this paper we use the fact that the primordial density field is expected to have a gaussian probability distribution function ( pdf ) , at least in inflationary models for the origin of fluctuations .",
    "we monotonically map the flux in a qso spectrum back to a gaussian density field , as in weinberg s ( 1992 ) method for recovering primordial fluctuations from the observed galaxy distribution .",
    "we measure the 1-dimensional power spectrum @xmath22 of this gaussian density field and convert it to the equivalent 3-dimensional @xmath0 . at this point",
    "we have the shape of the initial mass @xmath0 , but since the variance of the gaussian pdf is not yet known , we have no information about its amplitude . to normalize @xmath0 we evolve an n - body simulation using gaussian fluctuations with the derived @xmath0 for the initial conditions .",
    "we then use the temperature  density relation to generate qso spectra from this simulation , choosing the photoionization rate to reproduce the observed mean  opacity .",
    "the amplitude of the _ flux _ power spectrum depends almost exclusively on the amplitude of the mass @xmath0 .",
    "therefore , when the amplitude of the flux power spectrum in the simulated spectra matches that measured from the observations , the underlying mass @xmath0 has the correct amplitude .",
    "we then have the normalized @xmath0 of linear mass fluctuations at the redshift probed by the qso spectrum .",
    "obviously , there are many assumptions and approximations involved in the procedure outlined above , and it is not obvious a priori that it will work . most of this paper will be devoted to testing these assumptions and the method as a whole . in ",
    "2 we explain the method for recovering @xmath0 in more detail , testing the steps of the procedure individually . in ",
    "3 we test the procedure as a whole by attempting to recover the mass power spectrum from simulated observational spectra extracted from hydrodynamic simulations of different cosmological models . in ",
    "4 we apply the method to the spectrum of qso q1422 + 231 ( provided by a. songaila and l. cowie ) . in ",
    "5 we summarize our results and outline directions for future investigation .",
    "qso spectra extracted from hydrodynamic cosmological simulations will play the role of simulated observations , against which we test our procedure . with these simulated spectra",
    ", we can control the physical and `` instrumental '' effects incorporated and test their influence in isolation , and we know the true mass power spectrum that the method should recover . as already mentioned , our method for recovering @xmath0 presumes the basic picture of the  forest that emerges from these simulations , and our tests in this paper depend on its validity .",
    "we will briefly mention tests of the scenario itself in  5 .",
    "our simulations use the n - body plus smoothed - particle hydrodynamics ( sph ) code treesph ( @xcite ; @xcite ) .",
    "we consider three different cold dark matter ( cdm ) cosmological models ; the simulations are the same ones analyzed by croft ( 1997a ) , and we refer the reader to that paper for details beyond those given here .",
    "the first model is `` standard '' cdm ( scdm ) , with @xmath5 , @xmath6 ( where @xmath23 ) .",
    "the power spectrum is normalized so that the rms amplitude of mass fluctuations in @xmath24 spheres , linearly extrapolated to @xmath25 , is @xmath26 .",
    "this normalization is consistent with that advocated by white , efstathiou , & frenk ( 1993 ) to match the observed masses of rich galaxy clusters , but it is inconsistent with the normalization implied by the cobe - dmr experiment .",
    "our second model is identical to the first except that @xmath27 .",
    "this higher amplitude is consistent with the 4-year cobe data ( @xcite ) , and we therefore label the model ccdm .",
    "the third model , ocdm , assumes an open universe with @xmath28 , @xmath29 .",
    "this model is also cobe - normalized , with @xmath30 ( @xcite ) .",
    "the baryon density parameter for all of these models is @xmath31 , a value taken from walker et al .",
    "( 1991 ) .",
    "we simulate one periodic cube of side length @xmath32 for each model , using @xmath33 collisionless dark matter particles and @xmath33 gas particles .",
    "each simulation was evolved to @xmath34 .",
    "we will deal exclusively with the @xmath35 outputs in this paper .",
    "a uniform photoionization field was imposed and radiative cooling and heating rates calculated assuming optically thin gas , as described in katz ( 1996 ) .",
    "qso absorption spectra were extracted from lines of sight through the simulation outputs as described in hernquist ( 1996 ) and croft ( 1997a ) .",
    "the simulated spectra exhibit a tight relation between the  optical depth , @xmath16 , and the underlying baryon density , @xmath13 , for @xmath36 .",
    "this relation arises because the temperature of the low density gas is determined by the interplay between photoionization heating by the uv background and adiabatic cooling by the expansion of the universe , leading to a simple temperature  density relation that is well approximated by a power law , @xmath37 the constants @xmath38 and @xmath39 depend on the spectral shape of the uv background and on the history of reionization ; they are likely to lie in the ranges @xmath40 and @xmath41 ( see @xcite ) .",
    "the  optical depth is proportional to the neutral hydrogen density @xmath11 ( @xcite ) , which for gas in photoionization equilibrium is proportional to the density multiplied by the recombination rate . for temperatures @xmath42k ,",
    "the combination of these effects yields @xmath43 with @xmath44 in the range @xmath45",
    ". here @xmath46 is the hi photoionization rate , and @xmath47 is the hubble constant at redshift @xmath48 . in this paper",
    "we will treat the ( observationally uncertain ) quantity @xmath46 as a free parameter , which we set by requiring that our simulated spectra match the observed mean  flux decrement at @xmath35 , @xmath49 ( @xcite ; @xcite ; but see @xcite , who estimate a lower mean decrement ) .",
    "if we adopted a different baryon density or reionization history in the simulations then the required value of @xmath46 would be different .",
    "as equation  ( [ eqn : tau ] ) suggests , in a given cosmological model the mean flux decrement basically constrains the parameter combination @xmath50 , and for a fixed value of this combination one gets nearly identical spectra from an underlying density field , whatever the individual values of the parameters .",
    "the optical depth depends on the density of neutral atoms in redshift space rather than in real space , so peculiar velocities and ( to a lesser extent ) thermal broadening introduce scatter in the relation between @xmath16 and @xmath51 .",
    "equation  ( [ eqn : tau ] ) breaks down more drastically in regions with @xmath52 because of shock heating and collisional ionization , but these regions have a small volume filling factor so they affect only a small fraction of a typical spectrum .",
    "as shown in figure  2 of croft ( 1997a ) , the correlation between @xmath16 and @xmath51 remains tight over most of the spectrum even when all of the relevant physical effects are taken into account . finally , because the gaseous structures responsible for typical forest lines are large ( @xmath53 kpc ) , low density , and fairly cool ( @xmath42k ) , pressure gradients have only a small effect on their dynamics relative to gravity , and the gas within them traces the underlying dark matter except on very small scales .",
    "equation  ( [ eqn : tau ] ) therefore provides a link between the  optical depth and the total mass density @xmath54",
    ". we will show below that , as a result of this link , the power spectrum of the flux has the same shape as the power spectrum of the underlying mass fluctuations on large scales .      given the relation between optical depth and density , we would like to recover the density field along the line of sight and measure its power spectrum . we could attempt to recover @xmath17 by inverting equation  ( [ eqn : tau ] ) , but we would encounter several obstacles . in high density regions the qso spectrum saturates , and when @xmath55 it is difficult to measure @xmath56 accurately . since the power spectrum weights high amplitude regions strongly ( the galaxy power spectrum , for instance , is strongly affected by galaxies in rich clusters even though field galaxies are much more common ) , small amounts of noise in saturated regions could produce large uncertainties in the power spectrum of the recovered density field .",
    "obtaining @xmath17 by direct inversion also requires a priori knowledge of the proportionality constant @xmath57 in equation  ( [ eqn : tau ] ) .",
    "a given spectrum could potentially be produced either by a weakly fluctuating density field with a large value of @xmath57 or by a strongly fluctuating density field with a small value of @xmath57 . since the @xmath20 relation is non - linear , changes in @xmath57 are not equivalent to linear rescalings of @xmath0 .",
    "when we extract spectra from simulations , we fix @xmath57 by matching the observed mean flux decrement , but we are able to do so only because the simulation itself provides the density field .",
    "finally , from the point of view of testing cosmological models , we are interested primarily in the power spectrum of the initial , linear mass fluctuations , rather than the power spectrum of the non - linear density field . at large scales and high redshifts , non - linear evolution has little effect on @xmath0 , and the linear and non - linear power spectra can be related by analytic approximations ( @xcite ; @xcite ; @xcite ) or by numerical calculations .",
    "however , to the extent that we can recover the linear @xmath0 directly from the observations , we are somewhat closer to our ultimate goal of addressing cosmological questions",
    ".    we can circumvent all of these obstacles  saturation , the unknown value of @xmath57 , and non - linear evolution of the density field  using `` gaussianization , '' a technique introduced by weinberg ( 1992 ) as a tool for recovering primordial density fluctuations from the observed galaxy distribution .",
    "inflationary models for the origin of structure predict that the initial density field has a gaussian pdf .",
    "gravitational evolution skews the pdf , but it tends to carry high density regions of the initial conditions into high density regions of the evolved density field , low density regions into low density regions , and so on in between ; it therefore preserves an approximately monotonic relation between initial and final density even on scales that are moderately non - linear . given an evolved density field on a grid",
    ", one can recover an approximate map of the initial fluctuations by sorting the pixels in order of density and then assigning new densities to the pixels so that they have the same rank order but a gaussian pdf .",
    "the overall amplitude of the fluctuations , corresponding to the width of the gaussian , must be determined in a separate step , by evolving the recovered initial conditions and comparing them to the observations .    in the application described by weinberg ( 1992 ) ,",
    "the input data set is a galaxy density field from a redshift survey .",
    "in our case we will apply gaussianization to  forest spectra , where the physical discussion in  2.1 gives us excellent reason to expect a monotonic relation between observed flux and mass density , approximately @xmath58.$ ] because gaussianization uses only the rank order of the pixel densities , we do not need to know the parameters of this non - linear relation , only that it is monotonic .",
    "an individual spectrum yields only a 1-dimensional probe through the density field , but we aim to recover the power spectrum of fluctuations rather than the full density field .",
    "peculiar velocities can depress the power spectrum on small scales by smoothing structure in redshift space and adding scatter to the @xmath20 relation .",
    "however , on large scales they should not alter the shape of @xmath0 .",
    "coherent flows into high density regions and out of low density regions can amplify the redshift - space power spectrum ( @xcite ) , but our normalization procedure ( described in  2.3 below ) will automatically account for this effect .",
    "figure [ gausshow ] illustrates the gaussianization procedure for a sample spectrum taken from our scdm model . the transmitted flux @xmath19 ( normalized to @xmath59 for no absorption ) is computed along a random line of sight through the simulation .",
    "the observed wavelength is related to the velocity by @xmath60 , where @xmath61 is the  rest wavelength and @xmath35 .",
    "the velocity range @xmath62 ( @xmath63 ) is set by the size of the periodic simulation box ; a simulated spectrum like that in figure  [ gausshow]a corresponds to a small section of an observed qso spectrum .",
    "we have added noise to the spectrum ( s / n=50 in the unabsorbed regions ) in a manner described in  2.4 below .",
    "figure  [ gausshow]b shows the pdf of the flux for 100 simulated spectra .",
    "this pdf is mapped by gaussianization to the gaussian pdf of the density contrast , @xmath64 , shown in figure  [ gausshow]c .",
    "figure  [ gausshow]d shows the line - of - sight density contrast field @xmath65 inferred from the spectrum .",
    "this field is equivalent to the `` initial '' density contrast , in the sense that the fluctuations are gaussian instead of having a pdf skewed by gravitational evolution .",
    "the amplitude of the field is arbitrary at this stage , and will be determined by a separate normalization process ( described in  2.3 ) .",
    "noise in the spectrum causes the small scale spikiness seen in the recovered density contrast field , especially in the lowest and highest density regions .",
    "smoothing the spectrum over a few pixels prior to gaussianization would suppress the noise and remove this spikiness , but we have not incorporated such smoothing in our analysis because we find that the noise does not change the derived power spectrum on the scales where our recovery method is reliable .",
    "now that we have an approximation to the initial mass density field along the line of sight , we would like to measure the 3-dimensional power spectrum , @xmath0 .",
    "we first estimate the 1-dimensional power spectrum , @xmath66 , where @xmath67 for the simulated spectra , we compute @xmath68 using a fast fourier transform , then average over multiple lines of sight to find @xmath22 .",
    "when we analyze the spectrum of q1422 + 231 in  4 , we will average over bins in @xmath69 rather than multiple lines of sight .",
    "the 1-dimensional power spectrum @xmath22 is related to the 3-dimensional power spectrum @xmath0 by @xmath70 ( @xcite ) .",
    "equation  ( [ eqn : p1d ] ) shows that the 1-dimensional power spectrum on large scales receives contributions from 3-dimensional fluctuations at all smaller scales ( higher @xmath69 ) .",
    "because of this aliasing of power , the 1-dimensional power spectra of pencil beam galaxy redshift surveys can sometimes show spurious large scale features that are not present in the 3-dimensional power spectrum ( @xcite ; @xcite ) . in order to recover @xmath0 from @xmath22 , one must invert equation  ( [ eqn : p1d ] ) , @xmath71 the dilute sampling in pencil beam galaxy surveys can make such an inversion noisy , but in our case we start from a continuous spectrum instead of a discrete distribution of objects , and the inversion  ( [ eqn : invert ] ) proves quite practical even given realistic levels of observational noise .",
    "figure  [ pkscdm ] illustrates the recovery of the shape of @xmath0 from 100 spectra drawn from the scdm simulation at @xmath35 . we did not add noise to these spectra ;",
    "we will examine the effects of noise and instrumental resolution in  2.4 below .",
    "filled circles represent the 3-dimensional @xmath0 recovered from the gaussianized spectra .",
    "the normalization has been chosen to match the amplitude of the linear theory scdm mass power spectrum at @xmath35 , shown by the solid curve .",
    "open circles show the 3-dimensional @xmath0 recovered directly from the flux , without gaussianization , again normalized to match the linear theory mass power spectrum at large scales .",
    "the power spectrum derived from the gaussianized flux matches the shape of the linear theory @xmath0 quite well for comoving wavelengths @xmath72 , up to the scale of the simulation box , @xmath73 .",
    "the redshift path length of the  forest region for a @xmath35 qso corresponds to roughly 20 of our simulated spectra .",
    "we have therefore divided our 100 gaussianized spectra into five sets of 20 and computed @xmath0 separately for each set .",
    "the error bars on the filled circles in figure  [ pkscdm ] show the @xmath74 dispersion of these five @xmath0 estimates and thus indicate the uncertainty in @xmath0 expected from a single observed qso spectrum .",
    "note , however , that our 100 spectra are all drawn from the same simulation volume and may therefore underestimate the `` cosmic variance '' caused by large scale variations in the density field .",
    "also , we have not yet included the effects of instrumental noise and continuum fitting , nor have we indicated the uncertainty in the overall amplitude of @xmath0 that will arise from our normalization procedure .    on small scales , the recovered @xmath0 falls below the linear theory power spectrum .",
    "the depression of small scale power is caused by the `` smearing '' of the absorption spectrum by peculiar velocities and thermal broadening and by non - linear gravitational effects that are not fully reversed by gaussianization .",
    "to indicate the scales affected , the dashed line in figure  [ pkscdm ] shows the linear theory scdm spectrum multiplied by @xmath75 with @xmath76 .",
    "this smoothed linear theory spectrum is a good match to the @xmath0 derived from the gaussianized flux . it might be possible to extend the dynamic range of our method by incorporating analytic ( or numerical ) corrections for this loss of small scale power ; however , these corrections might well depend on the assumed cosmological model , and we will not attempt them here .",
    "the power spectrum of the flux also has the same shape as the mass power spectrum on large scales , even though the relation between flux and mass density is highly non - linear .",
    "this agreement is reminiscent of weinberg s ( 1995 ) results for locally biased galaxy formation , which show that a non - linear but local relation between galaxy and mass density does not change the shape of the power spectrum on large scales , though it may change the amplitude by a constant factor .",
    "the error bars , again derived from the dispersion among five sets of 20 spectra , are slightly larger than those for the gaussianized flux @xmath0 , probably because gaussianization `` regularizes '' the spectra and reduces the impact of rare , strong absorption regions .",
    "however , the agreement between the filled and open circles indicates that the recovery of the power spectrum shape is not sensitive to our assumption of a gaussian primordial pdf  we could recover the shape of @xmath0 without gaussianizing at all , at the cost of slightly larger statistical uncertainty .",
    "the gaussian assumption will play a more important role when we normalize @xmath0 as described in  2.3 below , using simulations with random phase initial conditions .",
    "figure  [ pkgauss ] shows the recovery of the power spectrum shape for the three different cosmological models ( scdm , ccdm , ocdm ) for which we have treesph simulations . in each case",
    "the normalization is adjusted to match the linear theory @xmath0 at large scales .",
    "results for the scdm model are repeated from figure  [ pkscdm ] .",
    "the power spectrum shape is also correctly recovered for the higher amplitude , ccdm model , though the drop below linear theory shifts to somewhat lower @xmath69 because of the larger scale of non - linearity .",
    "we even recover the subtle difference in shape between the ocdm and scdm power spectra , though this difference is even smaller when the wavenumber is expressed in directly observable units of @xmath77 ( see  4 ) , so a clean distinction will require measurements to larger scales .    since the three cdm models have similar power spectrum shapes , we want to check that our method can indeed recover the correct shape for a model with a significantly different @xmath0 .",
    "figure  [ pklinen-1 ] shows the @xmath0 recovered from the gaussianized flux in a model with an @xmath78 power law initial power spectrum ( and @xmath5 , @xmath6 ) .",
    "we do not have a treesph simulation of this model ; instead we created artificial spectra by an extended n - body simulation technique described in  2.3 below . at small scales",
    "the recovered @xmath0 is depressed by non - linear evolution and velocity smoothing and is similar to that of the cdm models .",
    "however , at @xmath79 the recovered @xmath0 bends sharply and matches onto the correct linear theory power spectrum shape , shown by the solid line .",
    "thus , the method is clearly capable of distinguishing an @xmath78 power law model from a cdm model .    as a further test",
    ", we have measured the gaussianized flux @xmath0 for a model designed to have no large scale clustering .",
    "we use a program written by j. miralda - escud that builds up simulated qso spectra by placing discrete absorption lines with voigt profiles at random redshifts .",
    "the hi column densities of the lines are drawn from a power law distribution @xmath80 and the @xmath81 parameters from a truncated gaussian distribution peaking at @xmath82 .",
    "the model and parameters are described in more detail in croft ( 1997a ) .",
    "the derived power spectrum is shown by the open circles in figure  [ pklinen-1 ] . on small scales",
    "we see a `` clustering '' signal in the gaussianized flux caused by the finite width of the lines ( @xcite ) .",
    "however , the derived @xmath0 is consistent with zero for all @xmath83 , as expected given the absence of any intrinsic clustering in the line model .",
    "the gaussianized flux power spectrum can clearly distinguish an unclustered line model from a model where the  forest arises in an intergalactic medium with large scale fluctuations .",
    "once we have applied the procedure described in  2.2 to simulated or observed qso spectra , we know the ( approximate ) shape of the initial power spectrum , but we do not know its amplitude . to determine this normalization , we use the derived @xmath0 to set up initial conditions for a series of cosmological simulations , with different linear fluctuation amplitudes . we assign random complex phases to the individual fourier modes , again exploiting the theoretical expectation that the primordial fluctuations are gaussian .",
    "we evolve these simulations to the observed redshift and extract artificial spectra . in simulations with a low fluctuation amplitude , the intergalactic medium ( igm )",
    "is relatively smooth , and the extracted spectra show weaker fluctuations than the input spectra . for a high fluctuation amplitude ,",
    "the simulated igm is clumpy , and the corresponding  spectra have too much structure .",
    "we take the correct linear theory amplitude to be the one for which the extracted  spectra have the correct degree of structure  specifically , we normalize the mass @xmath0 by requiring that the evolved simulations reproduce the 3-dimensional power spectrum of the ( non - gaussianized ) flux on large scales",
    ".    this normalization procedure would be computationally impractical if we had to evolve full hydrodynamic simulations for each trial fluctuation amplitude .",
    "fortunately , the physical discussion of the  forest in  2.1 suggests a useful shortcut .",
    "we use a particle - mesh ( pm ) n - body code ( @xcite ) to evolve a collisionless dark matter simulation from the specified initial conditions .",
    "we assume that the baryons trace the dark matter distribution and that the gas temperature is given by the power law temperature  density relation  ( [ eqn : td ] ) .",
    "we can then extract  spectra from the simulated gas distribution in the usual fashion and measure their flux power spectra .",
    "this simple , `` pseudo - hydro '' technique ( details given below ) is very similar to semi - analytic igm models that have been used to predict properties of the  forest ( @xcite ; @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) , except that these use the lognormal approximation ( @xcite ) or variations of the zeldovich approximation ( @xcite ) to compute the non - linear dark matter density field .",
    "the pm method , being fully non - linear , should yield more accurate results at a still  modest computational cost .",
    "a similar numerical approach has been used by petitjean ( 1995 ; see also @xcite ) and by gnedin & hui ( 1997 ; see also @xcite ) ; both of these groups also incorporate simplified hydrodynamic effects in their pm evolution .",
    "we have visually compared spectra computed by the pm approach to spectra produced by treesph from the same initial conditions , and we find good agreement in nearly all regions .",
    "the pm technique breaks down in high density regions where shock heating and/or radiative cooling drive gas away from the temperature  density relation  ( [ eqn : td ] ) , which holds only when photoionization heating and adiabatic cooling are the dominant processes affecting the gas temperature . in visual comparisons of our present simulation spectra",
    ", we see that these effects appear to be more important than the effects of pressure gradients in limiting the accuracy of the approximation .",
    "our tests below will show that the approximation is adequate for our present purpose , determining the normalization of @xmath0 .",
    "clearly this approximation ( or the `` hydro - pm '' approximation of @xcite ) is potentially useful for other  forest applications , though its suitability needs to be tested against full hydrodynamic calculations on a case - by - case basis .",
    "in addition to the linear fluctuation amplitude , a number of uncertain parameters must be specified before a given set of initial conditions can be evolved and used to create artificial spectra .",
    "these include the cosmological parameters @xmath84 , @xmath85 , and @xmath86 , and four parameters that influence the density , temperature , and ionization state of the igm : @xmath87 , @xmath38 , @xmath39 , and @xmath46 .",
    "one might worry that the derived normalization of @xmath0 would be sensitive to the assumed values of these parameters .",
    "fortunately , the discussion in  2.1 suggests that these parameters collectively influence the  spectrum mainly through a single combination , the constant @xmath57 in the @xmath20 relation  ( [ eqn : tau ] ) ( the index @xmath88 has only a slight dependence on these parameters ) . for a specified initial @xmath0 ,",
    "the statistical properties of the underlying density field depend mainly on the linear fluctuation amplitude at the redshift in question and are insensitive to cosmological parameters .",
    "once the pm code has provided the density field , the value of @xmath57 can be determined by matching the observed mean flux decrement @xmath89 , a constraint that is independent of the flux power spectrum .",
    "our tests below will show that once this mean decrement constraint is imposed the @xmath0 normalization derived by matching the flux power spectrum is virtually independent of the uncertainties in cosmological and igm parameters .",
    "our full procedure for producing spectra from the pm code is as follows : + ( a ) we generate initial conditions . for the tests in this section , we want to suppress the statistical fluctuations caused by variations of structure from one simulation to another , and we therefore start our pm simulations from the same initial density fields that were used for the treesph simulations , varying only the linear fluctuation amplitude . in  3 and",
    " 4 , where we present end - to - end tests of our method and apply it to observations , we generate gaussian fluctuations with the @xmath0 shape derived from the input data , using the standard technique of drawing the real and imaginary parts of each fourier mode from independent gaussian distributions with mean zero and variance @xmath90 . in all cases we use the same box size as the treesph simulations ( 11.111 @xmath91 comoving ) and @xmath33 particles .",
    "+ ( b ) we evolve the models from @xmath92 to @xmath35 in 20 timesteps ( each timestep corresponding to a change in expansion factor @xmath93 ) .",
    "we use a @xmath94 mesh for density  potential computations in the pm code .",
    "we must adopt values of @xmath95 , and @xmath86 for this evolution , but we will show below that the results are insensitive to this choice .",
    "+ ( c ) we interpolate the density and velocity fields onto a @xmath96 grid using a cloud - in - cell ( cic ) scheme .",
    "we then smooth the fields with a gaussian filter of radius 1 grid cell ( following hui 1997 ) in order to ensure that velocities are defined everywhere .",
    "this scheme is different from the method used to extract line - of - sight fields from the treesph simulations , which involves lagrangian smoothing with the sph kernel ( see @xcite ) .",
    "the success of our tests below indicates that the flux power spectrum is insensitive to the detailed procedure used to extract  spectra from a simulation .",
    "+ ( d ) we select random lines of sight through the simulation along which to extract spectra .",
    "we assign temperatures to each pixel along these lines of sight using the relation @xmath97 .",
    "typical values would be @xmath98 , @xmath99 , but we will show below that the results do not change for other reasonable choices of @xmath38 and @xmath39 .",
    "+ ( e ) we adopt provisional values of @xmath87 and @xmath46 and compute the neutral hydrogen fraction in each pixel , using its density and temperature and assuming photoionization equilibrium .",
    "we compute the  optical depth @xmath16 from the neutral hydrogen density .",
    "+ ( f ) we map the absorption spectrum @xmath100 from real space to redshift space , redistributing @xmath16 values as implied by the peculiar velocity field and convolving with the appropriate thermal broadening .",
    "+ ( g ) finally , we multiply the @xmath16 values in all of the spectra by a constant chosen so that the mean flux decrement in the spectra matches the observed @xmath89 . this step is equivalent to changing the parameter combination @xmath101 from the provisional value adopted in step ( e ) . + we compute the flux power spectrum as described in  2.2 , estimating @xmath22 by fft and deriving the 3-dimensional flux power spectrum , @xmath102 , using equation  ( [ eqn : invert ] ) .",
    "the 3-dimensional @xmath102 provides a more robust normalization constraint than the 1-dimensional flux power spectrum because we can match power on large scales ; @xmath22 contains aliased small scale power even at low @xmath69 ( eq .  [ [ eqn : p1d ] ] ) . in our flux power spectrum plots",
    "we show the quantity @xmath103 , the contribution of logarithmic @xmath69 intervals to the variance ( @xcite ) , instead of @xmath102 . because the flux power spectra are steep at the scales that we examine , the @xmath104 factor reduces the dynamic range of the plots and makes it easier to discern differences in amplitude",
    "the use of @xmath105 also minimizes potential confusion with our plots of the recovered mass fluctuation power spectrum , where we will continue to show @xmath0 itself .",
    "we note here that the flux power spectrum , @xmath105 , is an interesting statistic in its own right , and can be used as a measure of structure in the  forest .",
    "however , in this paper we will concern ourselves solely with its usefulness in determining the normalization of the mass power spectrum @xmath0 .",
    "figure  [ fluxpksig8 ] demonstrates the sensitivity of @xmath105 to the amplitude of linear theory mass fluctuations .",
    "the points show @xmath105 measured from the three treesph simulations , with error bars calculated as in the previous figures from the @xmath74 dispersion among five sets of 20 spectra each .",
    "the lines show @xmath105 computed from pm simulations that have the same initial fluctuations as the corresponding treesph simulations but different linear theory amplitudes .",
    "we evolve the pm simulations using the appropriate cosmological parameters ( @xmath84 , @xmath85 , and @xmath86 ) and extract spectra as described above , using the temperature  density relation measured from the corresponding treesph run ( e.g. , @xmath106 , @xmath99 for scdm ) .",
    "we label each curve by @xmath107 , the rms linear theory mass fluctuation in @xmath24 spheres at @xmath25 implied by the adopted power spectrum normalization .",
    "figure  [ fluxpksig8 ] shows results at @xmath35 , when the linear theory amplitudes are lower by a factor of 4.0 in the two @xmath5 models and 2.71 in the open model .",
    "we measure @xmath105 from 1000 lines of sight for each pm simulation , enough that the fluctuations in the @xmath105 curves do not change with the addition of more spectra .",
    "some fluctuations remain because we are always simulating a single @xmath108 box with the same initial phases and therefore have a finite number of independent structures in the evolved gas distribution .",
    "we use the same initial phases for the pm and treesph runs in this section in order to limit the effect of this cosmic variance on the @xmath105 comparisons .",
    "as expected , on large scales ( @xmath109 ) the amplitude of the flux power spectrum increases steadily with increasing mass fluctuation amplitude . on small scales",
    "the @xmath105 curves turn over because of non - linear gravitational evolution and blurring of the  spectra by peculiar velocities , and the curves for @xmath110 converge . in each panel of figure",
    "[ fluxpksig8 ] , we use a heavy solid line to indicate the @xmath105 curve from the pm simulation with the correct linear theory amplitude . in all cases ,",
    "this curve provides the best overall visual fit to the @xmath105 values obtained from the treesph simulation .",
    "figure  [ fluxpksig8 ] thus demonstrates two essential points : the flux power spectrum at small @xmath69 is sensitive to the mass fluctuation amplitude , making it an appropriate fitting constraint for @xmath0 normalization , and the pm approximation is accurate enough for determining this normalization properly .    as mentioned above",
    ", we choose the value of @xmath111 for each pm fluctuation amplitude to match the mean flux decrement of the treesph spectra , @xmath112 . as the mass fluctuation amplitude increases , more of the gas flows into near - saturated regions , and a higher value of @xmath111 is required to give the correct @xmath89 .",
    "for example , the pm simulations of scdm require a value of @xmath111 2.4 times higher for @xmath113 than for @xmath26 , consistent with the results from the treesph simulations themselves ( see croft 1997a ) .",
    "figure  [ diffjfluxpk ] highlights the importance of the mean flux decrement constraint to the normalization procedure .",
    "the points and heavy solid line , repeated from figure  [ fluxpksig8]a , show , respectively , @xmath105 from the treesph simulation and from the pm simulation with the correct linear theory amplitude and a value of @xmath111 that yields @xmath114 . the dashed line and thin solid line show @xmath105 from the same pm simulation with the value of @xmath111 respectively increased and decreased by a factor of two .",
    "these changes alter @xmath105 by about a factor of two at large scales , roughly what one might expect from the physical discussion in  2.1 . the changes to @xmath111 alter the constant @xmath57 in the @xmath20 relation  ( [ eqn : tau ] ) by a factor of two , and",
    "this constant serves as a sort of `` bias factor '' between density fluctuations and optical depth fluctuations . in studies of galaxy clustering",
    ", the bias between galaxies and mass is not known a priori ; if it is assumed to be independent of scale , then one obtains the shape of the mass power spectrum but not its amplitude .",
    "we can obtain the shape _ and amplitude _ of the mass power spectrum from  forest observations because the mean flux decrement provides an observational constraint on the effective `` bias factor '' that is independent of the flux power spectrum itself  @xmath89 measures the mean  opacity , while @xmath105 measures fluctuations about the mean .",
    "high precision estimates of the amplitude of mass fluctuations require reliable measurements of @xmath89 from observations .",
    "current estimates of @xmath89 are not all consistent ( e.g. , compare press et al .",
    "1993 and @xcite with @xcite ) , a situation that must be resolved in order to make the most of our normalization procedure .    from equation  ( [ eqn : tau ] )",
    ", it is clear that the value of @xmath111 needed to match @xmath89 for a given density field will itself depend on the adopted values of the igm parameters @xmath38 and @xmath39 and the cosmological parameters @xmath84 , @xmath85 , and @xmath86 , which collectively determine @xmath47 . to the extent that the approximation  ( [ eqn : tau ] ) holds , the effects of changing these parameters and of changing @xmath111 are degenerate ( except for the small influence of @xmath39 on the index of the @xmath20 relation ) .",
    "normalizing to the observed @xmath89 therefore eliminates their influence on the derived amplitude of mass fluctuations .",
    "however , varying these parameters also changes the amount of thermal broadening and peculiar velocity distortion in the  spectrum ( eq .",
    "[ [ eqn : tau ] ] ignores these effects ) , and we must check that such variations do not thereby alter the inferred @xmath0 normalization .    figure  [ t0fluxpk ] illustrates the effects of @xmath38 and @xmath39 on @xmath105 at fixed @xmath89 .",
    "the filled circles and heavy solid line , repeated from figures  [ fluxpksig8]a and  [ diffjfluxpk ] , show @xmath105 obtained , respectively , from the scdm treesph simulation and from the pm simulation with the same initial conditions and the values @xmath106 , @xmath99 that fit the temperature  density relation of the treesph run .",
    "the other lines show @xmath105 obtained from the pm simulation with different ( rather extreme ) values of @xmath38 and @xmath39 . for each combination of @xmath38 and @xmath39 , we adjust @xmath111 so that the mean flux decrement of the pm spectra is @xmath114 ; for example , @xmath111 is 2.2 times higher for @xmath115 than for @xmath106 . with the @xmath89 constraint imposed ,",
    "we see that @xmath105 is almost completely insensitive to the value of @xmath39 and to a factor @xmath116 increase or decrease in @xmath38 . for @xmath115 , the larger degree of thermal broadening depresses @xmath105 on small scales , but even this extreme variation does not significantly alter @xmath105 for @xmath117 .",
    "changes in the cosmic reionization history and the spectral shape of the uv background influence the low density igm through the parameters @xmath38 and @xmath39 ( @xcite ) .",
    "since figure  [ t0fluxpk ] shows that changing @xmath38 and @xmath39 does not alter @xmath105 if @xmath89 is held fixed , we conclude that uncertainties in the reionization history and uv background spectral shape do not affect our ability to normalize @xmath0 accurately .",
    "figure  [ omegafluxpk ] shows the influence of changing the cosmological parameters @xmath84 , @xmath85 , and @xmath86 on @xmath105 . the filled circles in panels ( a ) and ( b ) show the treesph results for the scdm and ocdm models , respectively , as in figures  [ fluxpksig8]a and  [ fluxpksig8]c .",
    "in each panel the heavy solid line ( again repeated from the corresponding panel of figure  [ fluxpksig8 ] ) shows @xmath105 from the pm simulation with the correct mass fluctuation amplitude , temperature  density relation , and cosmological parameters .",
    "the other lines show results from pm simulations with the same linear theory density fluctuations and temperature  density relation but different values of the cosmological parameters . in each pm simulation",
    "we adopt a comoving box size of @xmath108 and scale the amplitude of the initial fluctuations ( at @xmath92 ) so that their linear theory amplitude at @xmath35 matches that of the corresponding treesph simulation .",
    "we also adjust @xmath111 to keep @xmath114 .    with @xmath89 and the linear theory mass fluctuations",
    "held fixed , @xmath105 is insensitive to the adopted cosmological parameters . except in the cores of virialized objects ,",
    "the non - linear mass density field depends almost exclusively on the linear theory mass fluctuations , independent of @xmath84 and @xmath85 ( @xcite ; @xcite ) .",
    "linear theory peculiar velocities are approximately proportional to @xmath118 ( @xcite ) , but at high redshift @xmath119 is always close to one ; for @xmath120 , the @xmath118 factor at @xmath35 is 0.83 in the open model and 0.99 in the flat , non - zero @xmath121 model .",
    "the value of @xmath47 depends on @xmath84 , @xmath85 , and @xmath86 , but the overall scaling of optical depths with @xmath122 is removed by the @xmath89 normalization . for fixed @xmath38 and @xmath39 ,",
    "the importance of thermal motions relative to hubble flow and peculiar velocities is larger when @xmath47 is smaller , but even for small @xmath47 the impact of thermal broadening on @xmath105 is insignificant .",
    "other statistical properties of the flux might be able to detect the direct influence of these cosmological parameters , but our normalization of @xmath0 will not depend on them .",
    "note , however , that once other observational constraints are imposed ( for example , the abundance of massive galaxy clusters at @xmath25 , or the amplitude of cmb anisotropies ) , the @xmath0 predicted on mpc scales at high redshift will depend on the adopted cosmological parameters .",
    "thus , the combination of @xmath0 from qso spectra with other robust observational measures can provide critical tests of cosmological models .",
    "we will return to this issue in  5 .    in our tests",
    "so far , we have evolved pm simulations from the same initial fluctuations as the treesph simulations , varying only the amplitude .",
    "however , figure  [ pkscdm ] shows that the mass power spectrum inferred from the gaussianized  flux is systematically depressed on small scales , and we must check that this systematic error in the _ shape _ of @xmath0 at high @xmath69 does not change the _ amplitude _ of @xmath0 inferred by matching @xmath105 at lower @xmath69 . as shown in figure  [ pkscdm ] , the small scale depression is roughly equivalent to smoothing the true @xmath0 with a gaussian filter of comoving radius @xmath123 .",
    "figure  [ rsfluxpk ] shows the flux power spectrum @xmath105 from the treesph , scdm simulation and from the pm simulation evolved from the same initial conditions , as in figure  [ fluxpksig8]a .",
    "the thin solid line shows @xmath105 from a pm simulation in which the initial fluctuations are smoothed with a @xmath123 gaussian filter before they are evolved forward .",
    "as one might expect , @xmath105 at @xmath35 is somewhat lower at high @xmath69 because of the reduced small scale power in the initial fluctuations .",
    "however , on the larger scales that we use for determining the @xmath0 normalization , the smoothing of the initial conditions has little effect .",
    "one could slightly improve the accuracy of the normalization procedure by amplifying the small scale power in the gaussianized flux @xmath0 before the pm evolution step , but to keep the presentation of our method reasonably simple , we will not include such corrections in this paper .",
    "the results of this section are encouraging and easy to summarize .",
    "the flux power spectrum @xmath105 depends directly on the linear theory amplitude of mass fluctuations , and it is insensitive to the adopted values of igm parameters and cosmological parameters as long as one adjusts @xmath111 to match the mean flux decrement @xmath89 to the observed value .",
    "the pm approximation provides an accurate and inexpensive method to compute @xmath105 .",
    "we therefore have a practical and robust procedure for determining the normalization of @xmath0 , once its shape has been derived from the gaussianized  flux as described in  2.2 .",
    "real qso spectra may have coarser resolution than our simulated spectra , and they are affected by photon noise from the qso and the sky and by instrumental readout noise .",
    "the throughput of the atmosphere and instrument as a function of wavelength may not be known exactly , and in any case one does not have precise a priori knowledge of the underlying qso continuum in the  forest region .",
    "therefore , the flux level corresponding to zero absorption is usually determined from the spectrum itself by a local continuum fitting procedure . in this section",
    ", we will add noise to the treesph spectra , degrade their spectral resolution , and apply local continuum fitting to see how these observational realities affect our ability to determine @xmath0 .    to model the effect of limited spectral resolution",
    ", we take the simple approach of rebinning the treesph spectra ( which have @xmath124 pixels ) into larger pixels  a `` top hat '' smoothing of the transmitted flux .",
    "we then add photon noise with a specified signal - to - noise ratio s / n in the continuum .",
    "for each pixel , we draw the photon noise from a poisson distribution with a mean proportional to the transmitted flux level , effectively assuming the limit where noise from the qso itself dominates over noise from the sky .",
    "a more thorough treatment of sky photon noise requires specifying the qso and sky flux at the observed  forest wavelengths ; we defer detailed tests of these effects to a later paper where we analyze a large observational data set .",
    "in addition to photon noise , we add noise drawn from a gaussian distribution with zero mean and standard deviation @xmath125 ( where @xmath59 represents the unabsorbed continuum ) , independent of the pixel flux level , to model instrument readout noise .",
    "we try three different combinations of spectral resolution / noise parameters : + ( 1 ) high resolution ( 4 @xmath126 pixels ) , high s / n ( 50 per resolution element in the continuum ) .",
    "these values are characteristic of a typical keck hires spectrum ( e.g. , @xcite ) .",
    "+ ( 2 ) high resolution ( 4 @xmath126 pixels ) , low s / n ( 10 per resolution element ) .",
    "+ ( 3 ) low resolution ( 40 @xmath126 pixels ) , low s / n ( 10 per resolution element ) .",
    "+ since we degrade the spectral resolution by top hat rebinning , a `` resolution element '' is simply a pixel of the rebinned spectrum .    the implicit assumptions in standard continuum fitting procedures are that the qso continuum and instrumental response vary slowly as a function of wavelength and that the highest observed flux levels correspond to the unabsorbed continuum ( plus noise ) . in high resolution ,",
    "echelle spectra , the continuum is often determined separately for each echelle order by ( 1 ) fitting a 3rd - order polynomial to the data points , ( 2 ) rejecting all points that lie more than 2-@xmath127 below this polynomial fit , and ( 3 ) repeating the process with the points that remain , iterating until the continuum fit converges .",
    "this is the procedure that we will use here ( it was also used by @xcite ) .",
    "each of our simulated spectra is periodic on the scale of the simulation box , which at @xmath35 corresponds to @xmath128 in the scdm and ccdm simulations and @xmath129 in the ocdm simulation .",
    "this scale is shorter than the @xmath130 length of a typical keck hires echelle order . in order to partially account for this difference in length and reduce edge effects",
    ", we periodically extend each spectrum by an equal length on either side of the simulation box to create a @xmath131 region .",
    "we fit the continuum to this region .",
    "nonetheless , the systematic depression of the continuum below its true value should be larger in our simulated observations than in real data because there is less chance of finding a region of genuinely low absorption in the short spectra we have available .",
    "our tests should therefore give an upper limit to the effects of continuum fitting on the determination of @xmath0 .",
    "figure  [ cf ] illustrates the effect of continuum fitting on several example spectra from the scdm simulation , for the high resolution , high s / n and low resolution , low s / n observational parameters . in each panel ,",
    "the heavy solid line shows the treesph spectrum , rebinned to the appropriate spectral resolution , with added noise .",
    "the dotted line shows the fitted continuum .",
    "light solid lines show the renormalized spectra , with the original flux in each pixel divided by the local continuum level . clearly",
    "the main effect of continuum fitting and renormalization is to remove absorption ( boost the flux ) in low density regions , since the fitted continuum is systematically depressed there .",
    "the effect is largest for the low resolution , low s / n spectra , where the mean flux decrement is reduced by @xmath132 . in the high resolution ,",
    "high s / n spectra , continuum renormalization reduces the mean flux decrement by @xmath133 .",
    "figure  [ pkcf ] shows how noise and continuum fitting influence the shape of @xmath0 derived from the gaussianized flux .",
    "these results from the degraded spectra can be compared to those from the noiseless spectra shown in figure  [ pkscdm ] .",
    "the low resolution , low s / n spectra give somewhat noisier @xmath0 estimates at small scales , but noise and continuum fitting do not appear to distort the shape of the inferred @xmath0 .",
    "the largest scale points ( @xmath134 ) lie a factor @xmath135 below the linear theory power spectrum .",
    "since there are only a few modes at this scale in our simulation box , this depression of large scale power could be a statistical fluctuation , but it could also be a systematic effect of continuum fitting , which tends to even out large scale fluctuations .",
    "the uncertainties in continuum determination may ultimately set the upper limit to the scale where @xmath0 can be determined reliably from the  forest .",
    "this question is best addressed in the context of specific observational data using larger volume simulations , and we therefore defer a more thorough investigation of continuum fitting procedures and their effects to future work . for",
    "now , we note that figure  [ pkcf ] shows that there is an interesting range of scales over which noise and continuum fitting do not pose serious problems for the determination of the shape of @xmath0 .",
    "noise and continuum fitting have even less impact on the normalization of @xmath0 using @xmath105 .",
    "figure  [ fluxpkcf ] shows @xmath105 in the scdm model measured from the noiseless treesph spectra ( points with error bars , repeated from figure  [ fluxpksig8]a ) and from the degraded , continuum ",
    "renormalized spectra .",
    "the flux power spectrum cuts off on small scales in the low resolution spectra as one might expect , but @xmath105 is virtually unchanged on the larger scales that we use for normalization . even with @xmath136 pixels the suppression of power is limited to scales a factor of two smaller than those where the gaussianized flux power spectrum matches the linear theory mass @xmath0 ( see figure  [ pkcf ] ) , suggesting that we could use still coarser resolution spectra for power spectrum determination without losing useful information .",
    "( however , continuum determination might be more problematic in lower resolution spectra , so we might ultimately lose information on _ large _ scales . ) in general , pixel  scale variations in detector response ( e.g. , flat  fielding errors , cosmic rays ) only affect @xmath105 and @xmath0 at high @xmath69 , where our recovery is limited in any case by the effects of peculiar velocities , thermal motions , and non - linear evolution .",
    "it is only large scale , coherent variations that are cause for concern .",
    "as figure  [ fluxpksig8 ] shows , the fluctuation amplitudes ( per logarithmic @xmath69 bin ) predicted by cdm models are of order unity on the scales considered in this paper , so any systematic errors would have to be quite substantial to influence the recovered power spectrum .",
    "we have now tested all of the pieces of our power spectrum recovery method individually . for the tests in  2 ,",
    "we have always used the same initial density field that was used in the treesph simulations , in order to separate errors in the recovery procedure from the statistical fluctuations in finite  volume realizations of a given model . in this section",
    "we will treat spectra from the treesph simulations as if they were observational data , and attempt to recover the mass power spectrum from them without using prior knowledge of the initial conditions or cosmological parameters .",
    "comparison of the results to the models true linear power spectra will provide end  to  end tests of the full @xmath0 recovery procedure .    as our starting point",
    ", we take the low resolution , low s / n spectra from  2.4 .",
    "these are the worst case observational parameters that we have considered , and if the procedure works well for these spectra then it should be very widely applicable in practice .",
    "we generate 100 spectra for each of the three cosmological models , fitting a continuum to each spectrum as described in  2.4",
    ". we will again compute error bars from the dispersion among five sets of 20 spectra , each set roughly equal in redshift path length to a single observed qso spectrum .",
    "one caveat to bear in mind is that these five simulated `` qsos '' probe the structure in a single simulation box ; on scales comparable to the box , there are only a handful of fourier modes , and their average power may not equal the true cosmic average predicted by the model .",
    "real spectra of the same total path length would sample more independent large scale fluctuations and should therefore yield an average @xmath0 closer to the true value",
    ". however , the dispersion in @xmath0 estimates from one spectrum to another should also be larger if they are fully independent , so the statistical error bars that we derive will be somewhat underestimated .    to recap , the steps of the @xmath0 recovery procedure are as follows : + ( 1 ) gaussianization .",
    "we reassign pixel flux values so that they have a gaussian pdf but the same rank order as in the original spectrum .",
    "this step yields an unnormalized estimate of the linear density contrast field along each line of sight . +",
    "( 2 ) measurement of the shape of @xmath0 .",
    "we estimate the 1-dimensional power spectrum of the gaussianized flux using an fft .",
    "we convert to the 3-dimensional @xmath0 using equation  ( [ eqn : invert ] ) .",
    "+ ( 3 ) determination of the amplitude of @xmath0 .",
    "+ ( a ) we use @xmath0 from step ( 2 ) to create realizations of an initial , random phase , linear density field .",
    "we evolve each density field forward under gravity using a pm code .",
    "we choose the cosmological parameters relevant to the scdm model ( @xmath137 , @xmath138 , @xmath6 ) to do this , but we have seen in  2.3 that any other choice will make essentially no difference to the results .",
    "+ ( b ) at each of several output times , we generate spectra using a power law temperature  density relation ( any reasonable choice of @xmath38 and @xmath39 in eq .  [ [ eqn : td ] ] will do ) and the value of @xmath111 that yields the same mean flux decrement as the input spectra , in this case @xmath114 . because the linear density contrast grows in proportion to the expansion factor in an @xmath5 universe , the multiple output times of a single simulation are physically equivalent to the outputs at a fixed time ( or redshift ) of simulations with different amplitudes of the linear theory mass power spectrum .",
    "+ ( c ) we estimate @xmath105 for each mass fluctuation amplitude , averaging results obtained from several realizations of the initial density field that have the same @xmath0 but different random phases .",
    "we compare these @xmath105 values to those measured from the `` observed '' spectra , on large scales .",
    "the normalization of @xmath0 is found by linearly interpolating between the output times ( fluctuation amplitudes ) that reproduce the @xmath105 amplitude most closely .",
    "we apply this procedure to the three cdm models in turn . for the normalization step ,",
    "we use four different random phase realizations in each case , with pm simulation boxes @xmath32 on a side , matched to the treesph simulations .",
    "we extract spectra along 1000 lines of sight from each simulation cube at each output .",
    "figure  [ simobsfluxpk ] shows the @xmath105 results used in the normalization step for the three models .",
    "for the wavenumber @xmath69 , we now use @xmath77 units , since these can be related directly to observed wavelength . the conversion from @xmath126 to comoving @xmath91",
    "would depend on our adopted cosmological parameters . at @xmath35 ,",
    "the scdm and ccdm simulation cubes are @xmath139 on a side , but the ocdm simulation is @xmath140 on a side .",
    "therefore , we measure @xmath105 over a different range of @xmath69 values in the open model .",
    "the heavy solid line in each panel of figure  [ simobsfluxpk ] shows results from the pm output with the same linear theory mass fluctuation amplitude as the corresponding treesph simulation .",
    "other lines show @xmath105 for output times with smaller and larger expansion factors @xmath141 .",
    "we adopt @xmath5 in the pm simulations , so the amplitude of the linear density fluctuations scales with @xmath141 . on large scales , the @xmath105 values from the simulated observations",
    "are usually matched by a pm output within @xmath93 of the correct value , indicating that the normalization procedure recovers the correct amplitude to an accuracy of @xmath142 or better . to obtain the final normalization for @xmath0 , we take the four @xmath105 points with @xmath143 and use linear interpolation among the pm outputs to find the amplitude that best fits that point .",
    "we average the four results to obtain the @xmath0 amplitude and take the scatter between them as an estimate of the normalization error .",
    "analysis of larger volume simulations or a large sample of observational results would warrant a more sophisticated treatment of the amplitude fitting and normalization error .",
    "figure  [ simobspk ] shows the final product , the normalized estimates of @xmath0 for the three models .",
    "we again plot the results in the directly observable length units , @xmath126 . since @xmath0 has dimensions of length@xmath144 , the scaling between @xmath91 and @xmath126 affects both the @xmath145 and @xmath146 axes .",
    "error bars attached to the individual points represent the @xmath74 dispersion in @xmath0 obtained from the five sets of 20 spectra .",
    "the error bar in the lower left corner of each panel indicates the uncertainty in the overall amplitude derived from the normalization procedure ; the full set of @xmath0 points can be coherently shifted up or down by this amount .",
    "solid curves in figure  [ simobspk ] show the true linear theory power spectra of the three cosmological models .",
    "figure  [ simobspk ] is the principal result of this paper .",
    "it demonstrates that the procedure we have described can recover the correct shape and amplitude of the linear theory mass power spectrum at high redshift , even when it is applied to continuum  fitted spectra with a relatively low signal - to - noise ratio and only moderate spectral resolution .",
    "in this section we present an illustrative application of our @xmath0 recovery method to a single qso spectrum .",
    "we will analyze larger data sets and carry out more detailed comparisons to the predictions of cosmological models in future work .",
    "we analyze a keck hires spectrum of the qso q1422 + 231 ( @xmath147 ) kindly provided by a. songaila and l. cowie .",
    "other analyses of the  forest and associated civ forest of this qso spectrum appear in songaila & cowie ( 1996 ) and kim et al .",
    "the region of the spectrum between  and ly@xmath88 covers a redshift range @xmath148 , over which evolution of the universe has a non - negligible impact .",
    "the strongest effect is the changing relation between optical depth and mass overdensity caused by the expansion of the universe and the change in the hubble expansion rate . for photoionized gas expanding with the hubble flow in an @xmath5 universe",
    ", the  optical depth evolves as @xmath149 at constant uv background intensity . following rauch ( 1997 )",
    ", we scale the optical depths in the spectrum using this relation to the values they would have at the central redshift of absorption ( @xmath150 ) .",
    "the mean flux decrement that we obtain for this spectrum is @xmath151 , slightly below the value @xmath152 implied by the results of press ( 1993 ) . in order to minimize the effect of the evolution in spatial scales , we scale all pixels to the size they would have in @xmath126 at @xmath153 .",
    "the maximum resulting change in pixel size is @xmath154 . in practice , this rescaling means that the pixels , which have a constant separation in observed wavelength , are treated as having a constant separation in velocity , @xmath155 .",
    "this scaling removes the first - order effect of the expansion of the universe over @xmath156 .",
    "second - order effects due to the change in the hubble parameter caused by deceleration will remain , but these should be small .",
    "once we have carried out the above rescalings , we gaussianize the spectrum and calculate @xmath0 as described in  2.2 .",
    "unlike the simulated spectra , the real spectrum does not have periodic boundaries , so that the 1-dimensional power spectrum we measure by using an fft is a convolution of the true 1-dimensional power spectrum with a top hat window function that represents the finite length of the qso spectrum . because the qso spectrum is much longer than the largest scale on which we will estimate @xmath0 , the effect of this convolution is negligible .",
    "since we have only a single spectrum , we can not calculate error bars on @xmath0 as we did with the ensemble of simulated observations .",
    "instead we split the @xmath69 range of interest into logarithmically spaced bins , estimate @xmath0 itself by averaging over the fourier modes in each bin , and estimate the uncertainty in @xmath0 from the poisson errors based on the number of discrete @xmath69 modes in the bin ( i.e. , @xmath157 , where @xmath158 is the number of fourier modes in the bin ) .",
    "we use the estimated @xmath0 to set up the initial density field for the pm code , as described in  2.3 .",
    "we linearly interpolate between the binned estimates of @xmath0 to assign power to all @xmath69 modes in the initial conditions . as in our simulation tests from  3 ,",
    "we generate four different random phase realizations of this initial power spectrum , adopting @xmath5 and a comoving simulation box size @xmath108 ( @xmath139 at @xmath35 ) .",
    "we evolve the simulations forward so that the scale factor @xmath141 grows by a factor of 24 in 120 steps of equal @xmath159 .",
    "we create artificial spectra with @xmath151 at several different output times and measure the flux power spectrum .",
    "the resulting values of @xmath105 are shown in figure  [ fluxpkq1422 ] , together with @xmath105 for q1422 + 231 . in figure  [ fluxpkq1422 ]",
    "we label the different simulation output times with expansion factors @xmath141 relative to the expansion factor @xmath160 at which the simulations reproduce the observed @xmath105 . as in  3 , we find the normalization of @xmath0 using the four largest scale points , estimating the amplitude required to match each point by linearly interpolating between the two outputs that bracket the point . we adopt the standard deviation of the four estimates as our estimate of the overall normalization uncertainty . we find that the @xmath161 error on the amplitude @xmath141 is @xmath162",
    ". this error does not include the sampling variance that results from the use of only one qso spectrum , and which could be of comparable magnitude , or even greater .",
    "another source of uncertainty is the value of @xmath89 used in the normalizing simulations .",
    "if we had adopted the press ( 1993 ) value of @xmath89 instead of the mean decrement measured from q1422 + 231 , then our estimated mass fluctuation amplitude would be lower by @xmath154 ( 20% in @xmath0 ) . on the other hand , as the zuo & lu ( 1993 ) estimate of @xmath89 is somewhat lower , assuming their value instead would yield a higher amplitude for @xmath0 .",
    "figure  [ pkq1422 ] shows the normalized @xmath0 derived from the spectrum of q1422 + 231 .",
    "the `` normalization error '' in the lower left corner indicates the uncertainty in the overall amplitude from the normalization procedure , and error bars on individual points are based on poisson errors in the number of fourier modes in each @xmath69 bin .",
    "note that the tests shown in figure  [ simobspk ] imply that @xmath0 may be systematically underestimated on the smallest scales , @xmath163 .",
    "the curves in figure  [ pkq1422 ] show the linear theory power spectra of the scdm , ccdm , and ocdm models at @xmath164 .",
    "the shape of the derived @xmath0 appears to be broadly compatible with the shape predicted for cdm , roughly an @xmath165 power law on the scales probed by this measurement .",
    "the best fit amplitude seems somewhat lower than that in any of our three models , and this difference is seen at large scales where the loss of small - scale power in our tests is negligible .",
    "for comparison , we also show the linear theory power spectrum for an @xmath5 , @xmath6 cdm model with a lower amplitude , @xmath166 .",
    "this model fits the data fairly well over the range of @xmath69 where the @xmath0 recovery is reliable .",
    "since figure  [ pkq1422 ] is based on a single qso spectrum , it would be premature to draw strong conclusions about which cosmological models are compatible or incompatible with the data , but it is encouraging that the results derived by our method are roughly in line with theoretical expectations .",
    "comparison to figure  [ pklinen-1 ] shows that the large scale power detected in the spectrum of q1422 + 231 is incompatible with a model in which the  forest is produced by a superposition of unclustered , voigt - profile lines .",
    "we have presented a method for recovering the linear power spectrum of mass fluctuations from qso  forest spectra .",
    "the method is motivated by a simple , approximate description of the relation between  optical depth and underlying mass density in the `` fluctuating igm '' scenario for the origin of the  forest .",
    "we have carried out extensive tests on artificial qso spectra created from realistic hydrodynamic cosmological simulations to show that the method successfully recovers both the shape and the amplitude of the mass power spectrum on an interesting range of scales .",
    "a preliminary application to the spectrum of q1422 + 231 gives results compatible with a low amplitude cdm model .    on small scales , roughly @xmath167 comoving , our method fails to recover the initial @xmath0 because of non - linear gravitational evolution and the effective smoothing of the  spectrum produced by peculiar velocities and thermal broadening .",
    "our present investigation does not tell us the largest scale out to which our method can recover @xmath0 ; it appears to work from @xmath168 up to the @xmath108 scale of our simulation boxes .",
    "there is a hint from the tests in  2.4 that local continuum fitting may artificially suppress power at the largest of these scales , but because our simulations contain only a few modes at this wavelength , it is difficult to tell whether this is a genuine effect or a statistical fluctuation .",
    "the continuum  fitting issue requires further investigation with larger volume simulations . for purposes of measuring @xmath0 , techniques that fit a low - order continuum over the largest practical wavelength ranges may be more effective than the conventional fitting technique employed here .",
    "there are other , physical effects that might ultimately limit our ability to measure @xmath0 on very large scales .",
    "one is the inhomogeneity of the uv background intensity ( and hence the photoionization rate @xmath46 ) due to the finite number of sources ( @xcite ) .",
    "fluctuations in @xmath46 cause fluctuations in the  optical depth that are unconnected to fluctuations in density .",
    "the short range of the  forest `` proximity effect '' relative to the mean separation of qsos ( see , e.g. , @xcite ; @xcite ) implies that fluctuations in @xmath46 are much smaller than unity over most of space , but on large scales the power induced by @xmath46 fluctuations might become comparable to the power in the density field itself .",
    "other subtle effects could become important for @xmath169 ( @xmath170^{-1}\\;\\kms$ ] ) , such as evolution of the uv background and evolution of the density field itself .",
    "our method explicitly incorporates the assumption that primordial fluctuations are gaussian , as predicted in most inflationary models .",
    "figure  [ pkscdm ] suggests that the recovered _ shape _ of @xmath0 is not particularly sensitive to this assumption ; gaussianization is a useful , theoretically motivated tool for `` regularizing '' the observed absorption and thus reducing statistical fluctuations in the @xmath0 estimates , but because non - linear local transformations do not alter the shape of the power spectrum at large scales , we obtain a similar average @xmath0 from our simulated spectra whether or not we gaussianize the flux .",
    "we rely more heavily on the gaussian assumption when we normalize @xmath0 , since we employ pm simulations with random phase initial conditions . because we use the flux power spectrum , a variance measure , as our criterion for normalizing @xmath0",
    ", we might obtain similar results even for other assumptions , but the sensitivity of the normalization to the gaussian assumption can only be assessed quantitatively in the context of a more explicit model for non - gaussian primordial fluctuations .",
    "the recovery of the mass power spectrum relies more generally on the theoretical scenario for the  forest provided by cosmological simulations and outlined in  2.1 .",
    "forest observations also provide the means to test this scenario , and to test the assumption of gaussian fluctuations , especially once the range of cosmological models to be considered is narrowed by the @xmath0 determination .",
    "traditional measures based on line - fitting , such as the column density and @xmath81-parameter distributions , provide one class of important tests . statistical methods that treat the spectrum as a continuous field rather than a superposition of lines may ultimately prove more powerful , since they are tied more directly to the quantities observed and are better attuned to the physics of a continuous , fluctuating igm ( see , e.g. , @xcite ; @xcite ; @xcite ; weinberg et al .",
    ", in preparation )",
    ". observations of absorption along neighboring lines of sight probed by qso pairs and groups can also provide crucial tests , by constraining the sizes and geometry of the absorbing structures ( @xcite ; @xcite ; @xcite ; @xcite ) .    within the broad context of inflationary models for structure formation ,",
    "`` free '' parameters include @xmath84 , @xmath85 , @xmath86 , @xmath87 , the neutrino density parameter @xmath171 ( with the implied cold dark matter density parameter @xmath172 ) , the primeval spectral index @xmath173 , the ratio of tensor - to - scalar contributions to large angle cmb anisotropies , and the energy density of the relativistic particle background ( from cmb photons and light neutrinos , for example ) .",
    "particular regions within this parameter space are often identified as named models , such as mixed dark matter , @xmath121cdm , open cdm , or tilted cdm .",
    "these models resolve the observational conflicts that beset the most `` natural '' inflation model ( @xmath174 , @xmath175 , etc . ) by appealing to different variations of the fundamental physics  e.g. , by adjusting the matter content , the vacuum energy , the space geometry , or the inflaton potential . in combination with existing observational constraints from cmb anisotropies and large scale structure , precise measurements of the shape and amplitude of @xmath0 at @xmath8",
    "can rapidly shrink the viable regions of parameter space and thus rule out or severely restrict many of these conceptually distinct models .",
    "these measurements even have the potential to rule out the general inflationary , adiabatic fluctuation scenario for the origin of structure by revealing a radically different @xmath0 , though our results from q1422 + 231 suggest that they will not .",
    "the @xmath0 constraints from the  forest complement the observational constraints from the cmb and large scale structure because they probe epochs between recombination and the present day and because they respond differently to parameter variations .",
    "consider , for example , the ccdm model , which appears at least marginally incompatible with the @xmath0 inferred from q1422 + 231 ( figure  [ pkq1422 ] ) .",
    "it is well known that the ccdm model is incompatible with the observed virial masses of rich galaxy clusters , because it combines @xmath174 with a high value of @xmath107 ( see , e.g. , white 1993 ) .",
    "however , our @xmath0 measurement challenges this model on different grounds , and the challenge would also apply to a low-@xmath84 model that has the same @xmath0 amplitude at @xmath35 , even though such a model might pass the cluster test .",
    "a difference from large scale structure constraints also arises because the directly observable `` length '' units for  forest studies are @xmath126 , and the relation of these scales to @xmath91 at @xmath25 depends on the time evolution of the hubble expansion rate , and hence on @xmath84 and @xmath85",
    ". the constraints from the  forest @xmath0 will be especially powerful if they can be extended to redshifts low enough that the fluctuation growth rate and the redshift dependence of @xmath47 start to differ measurably from one cosmological model to another .",
    "since our tests indicate that high spectral resolution and high signal - to - noise ratio are not essential , the data from the hst absorption line key project ( @xcite ; @xcite ) and other hst studies of the low-@xmath48  forest may well be adequate for this purpose .",
    "the critical questions are whether the relation between  optical depth and mass density remains sufficiently tight as the universe evolves and whether large scale fluctuations remain measurable with the much lower mean absorption observed at low redshift ( reflecting the lower value of @xmath57 in equation  [ [ eqn : tau ] ] ) .",
    "high resolution hydrodynamic simulations evolved to @xmath25 should soon provide the means to answer these questions .",
    "the prospects for determining @xmath0 at @xmath176 with existing qso absorption data are excellent .",
    "( at @xmath177 , continuum determination may be a significant obstacle because of the high mean opacity . )",
    "there are already numerous keck hires spectra comparable in quality to the q1422 + 231 spectrum that we have analyzed here . furthermore , our tests show that spectra of moderate resolution and signal - to - noise ratio are adequate for @xmath0 determinations , and since one wants as many spectra as possible in order to beat down cosmic variance and achieve high statistical precision over a range of redshifts , the large existing samples of `` pre - keck '' spectra ( e.g. , @xcite ) may be even better suited to this purpose . for future programs designed specifically for power spectrum studies , observations targeting groups of qsos with transverse separations of several to several 10 s of comoving @xmath91 ( e.g. , @xcite ) might be especially valuable , as cross - correlating spectra along parallel lines of sight rapidly multiplies the number of baselines available for estimating @xmath0 . with a sufficiently large sample , one could even use the angular dependence of @xmath0 to constrain spacetime geometry ( @xcite ; @xcite ; @xcite ; @xcite ) . the sloan digital sky survey , which will obtain @xmath178 qso spectra with @xmath179 resolution and typical s / n@xmath180 , may eventually provide the ideal data set for such a study .",
    "the promise of the method described in this paper arises from the happy coincidence between the excellent observational data on the  forest and the simple physical interpretation of these data that has emerged from cosmological simulations .",
    "because the  forest arises primarily in the diffuse , smoothly fluctuating igm , this route to @xmath0 sidesteps the uncertainties in theoretical modeling of galactic star formation , feedback , galaxy mergers , and so forth , which inevitably affect interpretations of large scale structure data .",
    "determination of the mass power spectrum in the high redshift universe now looks to be within relatively easy reach .",
    "we thank a. songaila and l. cowie for providing the q1422 + 231 spectrum and j. miralda - escud for helpful discussions and for the program used to generate the voigt - profile line model used in figure  [ pklinen-1 ] .",
    "this work was supported by nasa astrophysical theory grants nag5 - 2864 , nag5 - 3111 , nagw-2422 , nag5 - 2793 , and nag5 - 3922 , by nasa long - term space astrophysics grant nag5 - 3525 , and by the nsf under grants asc93 - 18185 and the presidential faculty fellows program .",
    "the sph simulations were performed at the san diego supercomputer center .",
    "croft , r. a. c. , weinberg , d. h. , hernquist , l. , & katz , n. 1997b , in proceedings of the 18th texas symposium on relativistic astrophysics , eds .",
    "a. olinto , j. frieman , & d. schramm , ( singapore : world scientific ) , in press ( astro - ph 9701166 )"
  ],
  "abstract_text": [
    "<S> we present a method to recover the shape and amplitude of the power spectrum of mass fluctuations , @xmath0 , from observations of the high redshift  forest . </S>",
    "<S> the method is motivated by the physical picture that has emerged from hydrodynamic cosmological simulations and related semi - analytic models , in which typical  forest lines arise in a diffuse , continuous , fluctuating intergalactic medium . </S>",
    "<S> the thermal state of this low density gas ( @xmath1 ) is governed by simple physical processes , which lead to a tight correlation between the  optical depth and the underlying matter density . to recover the mass power spectrum , </S>",
    "<S> we ( 1 ) apply a monotonic gaussian mapping to convert the qso spectrum to an approximate line - of - sight density field with arbitrary normalization , ( 2 ) measure the power spectrum of this continuous density field and convert it to the equivalent 3-dimensional @xmath0 , and ( 3 ) evolve cosmological simulations with this @xmath0 shape and a range of normalizations and choose the normalization for which the simulations reproduce the observed power spectrum of the transmitted qso flux . imposing the observed mean  opacity as a constraint in step ( 3 ) makes the derived @xmath0 normalization insensitive to the choice of cosmological parameters , ionizing background spectrum , or reionization history . </S>",
    "<S> thus , in contrast to estimates of @xmath0 from galaxy clustering , there are no uncertain `` bias parameters '' in the recovery of the mass power spectrum from the  forest . </S>",
    "<S> we test the full recovery procedure on smoothed - particle hydrodynamics ( sph ) simulations of three different cosmological models and show that it recovers the true mass power spectrum of the models on comoving scales @xmath2 mpc , the upper scale being set by the size of the simulation boxes . </S>",
    "<S> the procedure works well even when it is applied to noisy ( s / n@xmath310 ) , moderate resolution ( @xmath4 pixels ) spectra . </S>",
    "<S> we present an illustrative application to songaila & cowie s keck hires spectrum of q1422 + 231 ; the recovered @xmath0 is consistent with that of an @xmath5 , @xmath6 , @xmath7 cold dark matter model . </S>",
    "<S> the statistical uncertainty in this result is large because it is based on a single qso , but the method can be applied to large samples of existing qso spectra and should thereby yield the power spectrum of mass fluctuations on small and intermediate scales at redshifts @xmath8 .    </S>",
    "<S> 1n_hi 1dkp_1d(k ) </S>"
  ]
}