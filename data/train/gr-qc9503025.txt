{
  "article_text": [
    "progress in three dimensional numerical relativity has been impeded in part by a lack of computers with sufficient memory and computational power to perform well resolved calculations of 3d spacetimes . to date , only a few groups have attempted full 3d numerical relativity calculations , notably the kyoto and texas groups . the kyoto group has applied themselves to pure gravitational wave spacetimes in the linearized limit  @xcite , and more recently to general relativistic hydrodynamical studies of revolving neutron stars . the texas group has designed a code for the simulation of various cosmological spacetimes  @xcite , and has recently turned to the problem of black hole spacetimes  @xcite .",
    "such 3d calculations in numerical relativity have proved quite difficult due to constraints placed by the largest computers available .",
    "however , these artificial restrictions on the physical simulations dictated by memory and speed considerations are being relaxed considerably due to the introduction of massively parallel machines",
    ". machines available today have gigabytes of memory and are capable of speeds of tens of gigaflops , allowing a completely new class of problems to be investigated .",
    "it is our intention to develop general purpose numerical codes to model general 3d spacetimes , including dynamic multiple black hole spacetimes .",
    "simulations of general black hole interactions are inherently three dimensional problems . to date ,",
    "numerical simulations of black hole spacetimes have been limited to two dimensional axisymmetric geometries @xcite .",
    "a grand challenge effort is currently under way in the numerical relativity community to develop three dimensional codes that will be applied , for example , to the coalescence of binary black hole systems .",
    "some progress has already been made to construct initial data in three dimensions representing two black hole configurations with arbitrary positions , radii , linear momenta and spin @xcite .    in this paper",
    "we report on progress made in the development of a new 3d numerical code based on the standard adm or 3 + 1 approach @xcite that we call the `` g '' code .",
    "we have also developed another 3d code based on a completely different formulation of the einstein equations due to bona and mass @xcite that we call the `` h '' code .",
    "this promising formulation and a recent extension @xcite casts the equations in a first order , flux conservative , hyperbolic ( fofch ) form that allows very accurate and sophisticated numerical methods to be applied to the einstein equations for the first time .",
    "applications of this formalism to black holes and gravitational waves are very promising in 1d and 3d studies .",
    "we will report on results from the fofch codes in a future paper .    here",
    "we apply the adm code to the problem of black hole spacetimes , showing the first evolutions of black holes in a 3d cartesian coordinate system .",
    "this is a difficult problem in 3d due to the large gradients that typically develop near the black hole , and we report on progress we have achieved towards evolving a spherical black hole to about @xmath2 in time , where @xmath1 is the mass of the black hole .",
    "this time scale is many characteristic time scales of the black hole , as the light crossing time of the black hole is @xmath3 , while its fundamental quasinormal mode period is about @xmath4 .",
    "there are several reasons why we study the spherical black hole spacetime before looking at more general spacetimes .",
    "first , this system has been studied extensively in 1d and 2d  @xcite , so it can be used as a standard system for testing out numerical schemes .",
    "second , evolving a spherical black hole is a difficult exercise , as shown in refs .",
    "@xcite , even when the coordinate system is chosen to match the underlying geometry of the system ( e.g. , spherical - polar coordinates ) .",
    "it represents one of the first major challenges to 3d black hole evolutions since it is the longitudinal , or spherical part of the calculations that presents the most serious problems in terms of the gradients in metric functions that develop as the system evolves . since we are solving this problem using 3d _ cartesian _",
    "coordinates , the spherical system has no special symmetry from the point of view of the code . by concentrating first on solving the problems associated with evolving this system",
    ", we will learn the techniques that are required to evolve much more general black hole spacetimes .",
    "finally , the schwarzschild spacetime is the endpoint for any generic 3d black hole spacetime that does not have net angular momentum , so it is important to understand the problems associated with the end state of more complex calculations that will be performed in the future .",
    "we should point out that there is work going on in our group using the same 3d relativity code to evolve gravitational waves .",
    "this work will be described in a separate paper @xcite .",
    "our strategy is to study first the issues of black holes without the complications of gravitational waves , and waves without the complications of black holes , and then to combine them when we consider distorted black holes that will evolve and emit gravitational waves as they `` ring down '' to schwarzschild ( see , e.g. , ref .",
    "@xcite ) .",
    "we discuss the theoretical foundations of the adm approach and the numerical algorithms used to solve the resulting equations in sections [ sec : math ] and [ sec : numeric ] , respectively .",
    "the initial data is discussed in section [ sec : initial ] and various issues regarding black hole evolutions in 3d , including computational approaches and gauge conditions are discussed elsewhere in section [ sec : evolution ] . in section [ sec : results ] we present case study tests of different slicings and shift conditions .",
    "finally in section [ sec : summary ] we discuss the results and future directions for this work .",
    "appendix  [ sec : appendix ] provides information about programming and performance issues encountered in developing a massively parallel 3d code .",
    "we use the standard 3 + 1 adm approach @xcite to write the general spacetime metric in the form @xmath5 using geometrized units such that the gravitational constant @xmath6 and the speed of light @xmath7 are both equal to unity . throughout this paper",
    ", we use latin indices to label spatial coordinates , running from 1 to 3 .",
    "the lapse function @xmath8 and the shift vector @xmath9 determine how the slices are threaded by the spatial coordinates .",
    "together , @xmath8 and @xmath10 represent the coordinate degrees of freedom inherent in the covariant formulation of einstein s equations , and can therefore be chosen freely .",
    "various choices used in our code are discussed in sections  [ sec : lapse ] and  [ sec : shift ] .",
    "the ricci tensor of the spacetime may be decomposed into its spatial and timelike components , and when the vacuum einstein equations are imposed these reduce to the four constraint equations @xmath11 @xmath12 and the twelve evolution equations @xmath13 @xmath14 + \\beta^{c}d_{c}k_{ab}+ k_{ac}d_{b}\\beta^{c}+k_{cb}d_{a}\\beta^{c}.\\ ] ] here @xmath15 is the ricci tensor , @xmath16 the scalar curvature , and @xmath17 the covariant derivative associated with three - dimensional metric @xmath18 .",
    "the einstein equations are contained in eqs .",
    "( [ hamiltonian constraint ] ) , ( [ momentum constraint ] ) and ( [ excurv evolution ] ) , while eq .",
    "( [ metric evolution ] ) follows from the definition of the extrinsic curvature @xmath19 . in our work",
    "the constraints are solved on an `` initial '' hypersurface using the well known conformal decomposition method of york and coworkers  @xcite and then evolved forward in time using the evolution equations ( [ metric evolution ] ) and ( [ excurv evolution ] ) .",
    "if the constraints are satisfied on any hypersurface , the bianchi identities then guarantee that they remain satisfied on all subsequent hypersurfaces . in a numerical solution , this may not be the case and the constraints have to be monitored carefully in order to ensure that the spacetimes generated are accurate .",
    "traditional alternatives to this approach involve solving the constraint equations on each slice for certain metric and extrinsic curvature components , and then simply monitoring the `` left over '' evolution equations . this issue is discussed further by choptuik in ref .",
    "@xcite , and in detail for the schwarzschild spacetime in ref .",
    "new approaches to this problem of constraint vs. evolution equations are currently being pursued  @xcite .",
    "in this section we discuss the various numerical algorithms we have developed to evolve the spacetime .",
    "the methods presented here are not specialized to black holes but apply generally to all systems we plan to study with this code .",
    "we have developed methods for solving both the hyperbolic evolution equations and various elliptic equations , such as the initial data and maximal slicing equations .",
    "the numerical grid we use is a fixed cartesian grid with constant spacing between spatial grid points .",
    "cartesian grids have the advantage of covering the spacetime with coordinates that are inherently singularity free . to date we have considered only fixed , constant time step sizes in our evolution schemes , discussed below .",
    "we utilize the conventional indices @xmath20 , @xmath21 , and @xmath22 to label the space steps , and @xmath23 to label the time steps in the finite differenced forms of the evolution equations .",
    "the use of macsyma scripts written by david hobill @xcite to generate symbolic expressions for the adm form of the einstein equations and the ability of macsyma to translate symbolic expressions into fortran code tremendously reduced the amount of time spent on laborious calculations and allowed us to write a 3d code in a short period of time .",
    "our numerical methods are adopted from previous work in developing 2d axisymmetric codes .",
    "we briefly describe those methods here but refer the reader to references @xcite for further details .",
    "the explicit leapfrog method is used to evolve the hyperbolic system of equations explicitly in time to second order accuracy . in the conventional leapfrog method , the extrinsic curvature ( @xmath19 ) variables",
    "are offset a half step in time relative to the metric field variables ( @xmath18 ) .",
    "placing the metric components at the half timestep and the extrinsic curvature at the full step , we can write the finite differenced forms of ( [ metric evolution ] ) and ( [ excurv evolution ] ) schematically as @xmath24 and @xmath25            -\\left(\\nabla^2\\alpha\\right)_{i , j , k}^n\\right\\}\\delta t,\\ ] ] where we have dropped the tensor index notation to prevent confusion with the indices @xmath20 , @xmath21 , and @xmath22 which are used to locate a quantity on the spatial grid , and where a number of terms have been omitted for clarity .",
    "these equations introduce first order errors due to the placement of the lapse function and the nonlinear terms @xmath26 .",
    "we adjust for this problem by extrapolating the necessary variables to the @xmath27 time slice using the formula @xmath28 we have used this method of solution in previous work @xcite and found it to work very well .",
    "spatial first and second derivatives of the metric components present in the terms @xmath29 and @xmath30 are defined using either standard second or fourth order center differences .",
    "the added complexity of higher order differences poses certain performance problems with regard to parallel machines .",
    "these issues are discussed in appendix a. we found in previous work @xcite that fourth order differences provide more accurate solutions and propagate gravitational waves with less dispersion and damping than the second order differences .",
    "our code is designed to allow for both second and fourth order differences as options . however ,",
    "fourth order differences are more unstable than second order , particularly at late times in the evolution when large gradients develop near the horizon .",
    "all results presented in this paper were obtained with second order derivatives .",
    "the 3d code allows for an arbitrary set of initial conditions , time slicings , and gauge conditions for the spacetime , all of which can require solutions to elliptic equations .",
    "for example , in previous work ( see , e.g. , @xcite or @xcite ) maximal slicing has frequently been used for black hole spacetimes due to its singularity avoiding nature and smooth properties ( although this is not necessarily the case in 3d , as we show in section [ sec : maxresults ] ) .",
    "satisfying the maximal slicing condition requires the solution of an elliptic equation , however .",
    "furthermore , the initial data problem is usually formulated in terms of elliptic equations that must be solved on the initial hypersurface .",
    "the schwarzschild initial data evolved in this paper is known analytically , but for more general initial data sets we often will need to solve an elliptic pde .",
    "the solution of elliptic equations , particularly on large meshes and on parallel computers , is a costly operation .    at the time this code was developed , there was no general purpose package for solving linear systems of equations on parallel machines .",
    "furthermore , we found previously that many standard packages available on other machines ( e.g. , cray ) were not efficient enough to solve elliptic equations in a time that made them effective for these problems  @xcite .",
    "this prompted us to develop a specialized 2d solver for the cray and then to develop a more general 3d solver called cmstab  @xcite , initially for the cm-5 , to provide a variety of conjugate gradient and conjugate gradient - like algorithms for solving the elliptic equations .",
    "the cmstab code is publicly available and can be obtained from our web server ( see section [ sec : summary ] ) .",
    "we are presently moving it to other architectures .      in order to solve elliptic equations numerically ,",
    "the usual approach is to approximate the derivatives with finite difference operators and solve the resulting system of simultaneous equations .",
    "fortunately , our elliptic equations are linear , so the resulting system is a linear system of simultaneous equations .",
    "( nonlinearities are typically handled by linearizing and iterating , so the technique is essentially the same . ) as an illustration of this process , the maximal slicing equation for the lapse function @xmath8 will be used ( see section [ sec : maximal ] below for a discussion of this condition ) : @xmath31 here , @xmath32 is the determinant of the covariant 3-metric .",
    "( [ maximal slicing ] ) involves both first and second order derivatives of @xmath8 .",
    "second order accurate , central finite differences are used . since",
    "the differencing is done in three dimensions and all mixed derivatives are involved , we have a nineteen - point stencil leading to the following equation , valid at each grid point @xmath33 not on the boundary : @xmath34 the stencil coefficients @xmath35 are obtained by finite differencing the left hand side of the maximal slicing equation in such a way as to make the resulting matrix symmetric , at least before the application of boundary conditions . for terms of the form @xmath36 ,",
    "a finite difference equation that results in a symmetric matrix is @xmath37 and for terms of the form @xmath38 , @xmath39 the equation for solving the hamiltonian constraint for the initial data would be handled similarly .",
    "( [ fdalp ] ) forms a set of @xmath40 equations in @xmath40 unknowns , where @xmath40 is the total number of grid zones , that can be solved for the values of @xmath8 at each grid point .",
    "the standard form for a set of linear equations is that of a matrix equation * ax*@xmath41*b * , where * a * is an @xmath42 square matrix containing all the finite difference coefficients , * x * is a vector of @xmath40 elements consisting of all the unknowns and * b * ( the right - hand side ) is a vector containing all the source terms of the differential equation . in this way",
    "we generate a standard matrix form of the problem where * a * is now a very sparse matrix with diagonal structure as shown in fig .",
    "[ fig:19diag ] .",
    "each of the diagonals corresponds to a finite difference coefficient in the nineteen - point stencil . for details on this procedure",
    "see press , et al .",
    "other details of our solver can be found in appendix a or in ref .",
    "at present the evolution of 3d black holes is very difficult because of problems with boundary conditions and resolution requirements . in this paper",
    "we outline these difficulties and present techniques we developed to overcome them .",
    "the boundary conditions on the black hole throat are generally provided by an isometry condition that maps the black hole exterior to a geometrically identical interior sheet , and these can be troublesome if the coordinate system does not naturally match the throat .",
    "( see sec .",
    "[ sec : isometry ] below , where we show that one can either evolve the entire domain , including the region interior to the throat , or just the exterior region , when we use an isometry condition to provide boundary data inside the black hole throat . ) the outer boundary conditions for black hole evolution are often taken to be static  @xcite , but this is acceptable only if the outer boundary is sufficiently far away , a condition that is difficult to obtain in an evenly spaced cartesian 3d grid with present computer memories .",
    "the resolution requirements are quite severe , as has been stressed in previous 1d and 2d studies of black holes  @xcite .",
    "whenever a singularity avoiding lapse is used , large gradients in the metric functions develop due to the pathological nature of such a slicing condition  @xcite .",
    "the evolution of the system is frozen inside the horizon , while it marches ahead just outside , leading to severe stretching of the coordinates and sharp peaks in the metric .",
    "an example of this effect is shown in fig .",
    "[ fig:1dgrr ] , where the radial metric function is shown at various times for a maximally sliced black hole ( see below for definitions and more discussion of this point . ) this behavior often leads to instabilities in 1d and 2d beyond about @xmath43 , depending on the resolution , and the problem can be more pronounced in 3d because of the limited resolution that can be achieved .    in this paper",
    "we compare extensively the results obtained using the 3d cartesian code with those obtained using the 1d codes we previously developed . such comparisons are very important in understanding the effect of various boundary condition and resolution effects in the 3d code .",
    "the spherical initial data set that we consider in this paper is the schwarzschild spacetime represented by a single , einstein - rosen bridge .",
    "this construction is discussed in detail in ref .",
    "the initial 3-metric is given by @xmath44 where the conformal factor is @xmath45 . here",
    "@xmath46 is the isotropic radius , related to the standard schwarzschild radius @xmath47 by @xmath48 .",
    "transforming to cartesian coordinates , we have @xmath49 where the cartesian coordinates @xmath50 , @xmath51 , and @xmath52 are related to the isotropic radius @xmath46 in the usual way .    in this paper",
    ", we shall concentrate on this spherical black hole initial data set .",
    "the study of other 3d data sets representing a black hole distorted by a brill wave  @xcite and two colliding black holes  @xcite will be reported elsewhere .      the present version of the code is written with a fixed coordinate grid with equal spacing @xmath53 in the cartesian coordinate labels .",
    "because the conformal factor @xmath54 is singular at the origin , we usually use a grid which straddles the origin ( and coordinate axes ) , so that the coordinate axes are offset from grid zones by a half zone , located midway between them .",
    "however , the code can also place grid zones coincident with the coordinate axes if desired . in this case",
    "we can set the coordinate values of the origin to be very small but finite to avoid numerical overflows .",
    "results presented in this paper have been computed with the staggered grid .    before going into the details of the calculations ,",
    "it is instructive to compare the current cartesian grid with the logarithmic @xmath55 grid used in other numerical work on black holes  @xcite . in that system",
    ", a radial coordinate @xmath55 is defined by @xmath56 where @xmath46 is the schwarzschild isotropic radius and @xmath1 is the schwarzschild mass of the black hole .",
    "this coordinate has the advantage of providing fine resolution near the throat of the black hole and also near the peak that develops in the radial metric function , while also allowing the outer boundary to be placed far from the hole . typical high resolution calculations in 1d and 2d based on this coordinate use @xmath57 , with the outer boundary placed at @xmath58 , or @xmath59 .",
    "low resolution calculations are performed with @xmath60 .",
    "disadvantages of this coordinate are that : ( _ i _ ) the throat region remains extremely well resolved , even after the horizon has moved significantly away from the hole .",
    "therefore much computational effort is wasted well inside the horizon where the lapse is typically near zero and the region is causally disconnected from the outside .",
    "( _ ii _ ) the grid becomes very coarse outside the horizon in the radiation zone , because equal spacing in the @xmath55 coordinate leads to larger and larger spacing in the more physical @xmath46 coordinate . under these conditions waves",
    "may be reflected back toward the black hole as they are scattered off of the coarse grid at larger radii , as discussed in refs .",
    "@xcite .",
    "one can estimate what kind of resolutions will be necessary to solve the spherical black hole problem in 3d by doing runs with a spherically symmetric ( 1d ) code in @xmath55 coordinates .",
    "it is instructive to study a high resolution 1d black hole run ( @xmath61 ) with maximal slicing to @xmath0 , as shown in fig .",
    "[ fig:1dgrr ] . at that time",
    ", the peak in the radial metric function is located at approximately @xmath62 .",
    "this corresponds to an isotropic radius @xmath46 of approximately @xmath63 .",
    "the effective resolution at the peak in isotropic radial coordinates is thus @xmath64 .",
    "given that this peak is the sharpest feature in the domain , one might expect that it would be possible to obtain reasonable results with a 3d code with @xmath65 .",
    "we also have a 1d code which uses isotropic radial coordinates , which are more closely related to our 3d cartesian coordinates .",
    "experiments with this code suggest that a resolution of @xmath66 is actually needed to obtain reasonably accurate results to a time of @xmath2 .",
    "this difference is due to the fact that although the equally spaced @xmath55 coordinates cover the throat region extremely well , where the peak begins to develop at early times , the equally spaced @xmath46 coordinates do not , and therefore higher resolution is required .",
    "there are also important geometric factors to consider in 3d , such as the length of the diagonal of a cartesian cube being @xmath67 , which make the resolution requirements more stringent yet .",
    "we show the size of the black hole throat on a grid of typical resolution ( @xmath68 ) in fig .",
    "[ fig : grid ] . in this figure",
    "the throat is located at @xmath69 , so we see that the throat itself is not extremely well resolved .",
    "( recall that @xmath46 denotes the isotropic , not schwarzschild radius . )",
    "we show below why it is not necessary to have the throat highly resolved in many cases .",
    "as mentioned above , the 1d code with @xmath55 coordinates was run with an @xmath70 , which corresponds to @xmath71 . with equally spaced cartesian zones such",
    "a luxury is impractical with present computer memories and speeds : the resolution @xmath72 recommended above would require @xmath73 zones .",
    "experiments with 1d codes show that if one is interested in following the metric and extrinsic curvature components only to a time of @xmath2 , the outer boundary should be placed at a radius of greater than about @xmath74 .",
    "when the outer boundary is too close , its influence will be felt by the interior solution if the boundary conditions are not properly formulated , producing error in the height of the peak .",
    "common treatments of the outer boundary involve holding the metric functions fixed or extrapolating them to the outer zones @xcite , but these are adequate only when the boundary is placed quite far away . when the boundary is placed at @xmath75 , by @xmath0",
    "the error in the peak of @xmath76 ( reconstructed from the six cartesian metric functions ) due to boundary effects ( using maximal slicing ) can be about 10% , depending on the treatment of the outer boundary conditions .",
    "these effects clearly point to the need for appropriate outer boundary conditions for black hole spacetimes , which we discuss in section [ sec : bc ] .",
    "although experiments with 1d codes allow us to estimate how much resolution will be needed , they are incomplete guides to the 3d problem .",
    "first of all , resolution issues will be different in cartesian coordinates . in 1d and 2d ( axisymmetric ) codes ,",
    "constant coordinate lines are essentially perpendicular to the gradients , so that symmetries are easily preserved .",
    "however , with a cartesian grid the constant coordinate lines cross developing features at all angles , causing finite difference errors to be larger than a 1d treatment would show .",
    "thus , one expects that even better resolution will be needed than that implied by the 1d code tests .",
    "also , when considering how far out to put the boundary of a cartesian grid , one must take into consideration that the outer boundary does not have the shape which is characteristic to the problem ( it is a cube , not a sphere ) .",
    "thus , boundary conditions must be applied carefully there .",
    "however , in spite of these problems we believe that cartesian coordinates are to be preferred over other specialized coordinate systems .",
    "the symmetries of this first 3d black hole problem are artificial .",
    "a general 3d spacetime with multiple black holes will not suggest a preferred coordinate system , as a single hole does , so a cartesian mesh should be just as effective as a spherical or boundary fitted coordinate system ( e.g. ade coordinates  @xcite ) , at least as far as the near zone is concerned .",
    "furthermore , the singularity free nature of cartesian coordinates is clearly desirable . all axisymmetric numerical relativity codes ( written in either @xmath77 or @xmath78 type coordinates ) that we are aware of have difficulties near the symmetry axes and origin ( see , e.g. , discussion in ref .",
    "@xcite ) , and in 3d these problems are much more severe  @xcite .",
    "present memory available on the ncsa 512 node cm-5 ( 16 gbytes ) allows calculations of up to about @xmath79 zones with our present code ( see the appendix for discussion of memory requirements for 3d numerical relativity . ) with the above discussion in mind , it is clear that in 3d black hole simulations , balancing the demands of high resolution with the need to place the outer boundary sufficiently far from the hole are quite difficult with a fixed , equally spaced grid .",
    "we have explored a number of techniques to deal with these difficulties , including ( _ i _ ) testing better boundary conditions that allow one to move the boundary closer to the hole , thereby increasing the affordable resolution , ( _ ii _ ) using a variable grid spacing or adaptive mesh refinement ( amr ) to add resolution where it is needed , and ( _ iii _ ) using an apparent horizon boundary condition to remove the peak from consideration , thereby reducing the resolution requirements dramatically .",
    "the boundary conditions and apparent horizon shift are discussed in sections [ sec : bc ] and [ sec : shift ] respectively .",
    "the use of variable meshes and dynamic adaptive mesh refinement will be reported elsewhere .      in this section",
    "we discuss our choice and implementation of boundary conditions . because we are evolving a spherical black hole ,",
    "it is not necessary to evolve the entire system . in order to achieve the highest possible resolution",
    ", we often choose to place the black hole at the origin of our coordinate system and evolve only a single octant of it .",
    "then the boundary conditions on the @xmath80 , @xmath81 , and @xmath82 planes are given by the symmetry of the spacetime , as discussed below .",
    "note that this treatment can be extended to all spacetimes which have both axial and equatorial symmetry , so that all of the ncsa axisymmetric black hole studies performed to date , including the collision of two equal mass black holes , can be studied with this geometry .",
    "as we report below , we also have performed simulations where the entire domain is evolved , and comparisons with the evolutions performed with symmetry conditions show identical results , as expected .",
    "application of boundary conditions on the inner surface that is the black hole throat is made difficult by the choice of an `` unnatural '' grid .",
    "cartesian grids do not conform to the spherical black hole surface and as a result the formulation of accurate finite differenced conditions at the throat is considerably more involved than would be the case if we had adopted a spherical coordinate system as we have in previous 2d work @xcite .",
    "we use an einstein - rosen bridge construction to connect two asymptotically flat sheets and form a black hole .",
    "this construction provides boundary conditions by allowing the use of an isometry to map the metric exterior to the throat ( or isometry surface ) to the interior regions .",
    "the isometry conditions take the form of a map @xmath83 which identifies the two sheets through the throat @xcite : @xmath84 with @xmath85 and @xmath86 , where @xmath87 is the radius of the black hole throat centered at @xmath88 .",
    "the mapping ( [ isom1 ] ) is applicable to both the metric and extrinsic curvature tensor fields .",
    "this isometry technique has been used extensively in the construction of black hole initial data sets  @xcite , but can also be used to provide boundary conditions during the evolution of black hole spacetimes .",
    "for example , in all previous ncsa 2d evolutions of distorted  @xcite , rotating  @xcite , and colliding  @xcite black holes , a coordinate system was chosen so the isometry condition on the 3-metric took on a very simple form : @xmath89 , where @xmath55 is a radial coordinate .",
    "the evolution equations themselves also respect this symmetry if the lapse , shift , and extrinsic curvature variables obey the isometry as well .",
    "generally , the radial component of the shift must vanish on the throat , and the lapse and extrinsic curvature components must have the same isometry sign ( positive or negative ) . under such conditions",
    "all evolution and constraint equations are preserved across the throat .",
    "the same situation occurs in the 3d case , as long as one is careful to apply proper boundary conditions on all variables .",
    "as we discuss in sections [ isom ] and [ sec : results ] below , it is also possible to _ evolve _ the data inside the throat , so that the isometry condition need not be applied if it is not desired .    the change of sign in eq .",
    "( [ isom1 ] ) results from the square of the map being an identity so that @xmath83 is its own inverse and is chosen from the continuity and consistency constraints of the einstein equations .",
    "for example , the metric must obey the isometry with a plus sign to be nonsingular on the throat and we define the lapse condition as @xmath90 with the sign taken to be the same as that of the extrinsic curvature . in the work presented in this paper we have used time slices in which the lapse is either symmetric or antisymmetric across the throat so that either of the isometry signs in ( [ isom2 ] ) may be used .",
    "if the metric is conformally flat so that @xmath91 where @xmath92 is the flat space background , we get from ( [ isom1 ] ) @xmath93 for the conformal factor . because our initial data is defined to be conformally flat and we fix @xmath54 to be constant in time , we compute the conformal factor at the first time slice and apply the isometry to the conformal metric in subsequent time slices . denoting @xmath94 , we can write the isometry on @xmath95 as @xmath96 where @xmath95 is the conformal metric . we found this construction to be more accurate and stable than performing the isometry to the full unconformed metric components , since the conformal factor is known analytically and the `` flat '' metric functions can be more accurately interpolated .",
    "note that this important trick can be used even if the conformal factor is known only numerically .",
    "boundary conditions on @xmath95 at the throat can be derived by differentiating equation ( [ isomconf ] ) and taking the limit @xmath97 ( see for example reference @xcite ) .",
    "an alternative construction that we have developed is to compute the isometric coordinates @xmath98 for @xmath99 and evaluate the corresponding tensor components inside the throat by volume weighting the nearest isometric neighbors as @xmath100 where the index @xmath23 refers to the eight cells overlapping a cube of size @xmath101 centered around @xmath102 .",
    "@xmath103 are the corresponding volume weights . in this way",
    "we solve algebraic identities and not differential relations across the throat which would require a complex network of discrete stencils and logical switches as discussed in reference @xcite .",
    "uniform grid spacing and limitations on available computer time and memory severely restrict the placement of the outer boundaries .",
    "ideally we would like to impose asymptotic and conformal flatness @xmath104 as @xmath105 .",
    "one would expect that in 3d , where the outer boundary is not far enough away from the throat , neither asymptotic flatness nor static outer boundaries would be sufficient .",
    "however , we found that for most of our runs , static outer boundaries worked better than any extrapolation boundary condition .",
    "for the runs which used an apparent horizon locking shift , however , one extrapolation outer boundary condition worked well .",
    "the method involves matching a schwarzschild - like solution to the outer boundary zones and is applicable to the diagonal metric components .",
    "this is done by defining an effective mass `` constant '' @xmath106 @xmath107 independently for the outermost zones ( labeled by the index @xmath108 ) that still live inside the computational domain .",
    "we then construct the boundary condition by extending the schwarzschild - like solution to the outside boundary zone as @xmath109    another kind of boundary in our code comes from our evolving only one octant of the system .",
    "boundary conditions must also be supplied for the planes @xmath80 , @xmath81 , and @xmath82 .",
    "the setting of boundary condition there is straightforward as they are determined by the symmetries of the problem @xmath110 and @xmath111 the extrinsic curvature components obey identical conditions as the corresponding metric components .",
    "we stress that our code is not restricted to the use of these boundary conditions , and that the black hole may be placed in the center of the grid if desired . in section [ sec : results ] below we present examples of such calculations which show that the results are identical whether the black hole is placed in a corner of the grid or in the center , as they should be .",
    "we are exploiting this symmetry in order to achieve the highest possible resolution , while still treating the black hole as a true 3d system in one octant .",
    "this treatment allows us to study 3d evolution with effectively eight times the memory than we would have with a black hole at the center of the grid .      in this section",
    "we discuss a few important computational issues regarding the evolution of 3d black holes in cartesian coordinates .",
    "we have developed various techniques to make black hole evolution calculations accurate and stable .",
    "specific examples of results obtained using these techniques are provided in the sections that follow .",
    "the conformal factor @xmath54 is usually obtained by solving the hamiltonian constraint on the initial time slice in numerical relativity calculations . for black hole initial data , this function often peaks up near the throat of the black hole(s ) . for our initial data",
    "set , @xmath54 is known analytically to be @xmath112 .",
    "since the metric functions are related to @xmath113 , they can become quite steep near the throat . in 3d",
    "cartesian coordinates , it can be difficult to afford high resolution in this region of the spacetime if one also wishes to cover the radiation zone away from the hole , so derivatives of the full metric functions can be particularly inaccurate if special care is not taken to compute them .",
    "we have dealt with this problem by constructing the conformal factor @xmath54 and all its spatial derivatives on the initial time slice and storing them in memory with machine accuracy .",
    "then , while the full metric functions ( e.g. @xmath114 ) are evolved , their spatial derivatives are computed by taking the conformal factor explicitly into account .",
    "the conformal metric functions are computed by dividing out the conformal factor .",
    "derivatives of these ( more slowly varying ) conformal functions are computed numerically , and the full metric derivatives are constructed by substituting the appropriate stored `` analytic '' values for the conformal factor and its derivatives .",
    "this procedure , which we call `` conformal differentiation '' , proves critical in obtaining accurate and stable evolutions particularly near the throat .",
    "it should be noted that this technique will be useful even when we have numerically generated initial data , because the initial data problem for the conformal factor @xmath54 can be solved with very high accuracy , and then its numerically computed derivatives can also be known as accurately as desired on the grid used for the evolution .",
    "experimentation shows that it is most important to apply this technique to the diagonal 3-metric functions .      in section [ sec : isometry ] above we discussed the implementation of the isometry condition on the black hole throat .",
    "this condition provides a good boundary condition on the inner region of the black hole spacetime .",
    "it forces the spacetime interior to the throat , in the other `` universe '' , to have the same geometry as that outside the the throat , where the spacetime is actually evolved , and its application allows us to evolve only the region on and outside the black hole throat .",
    "however , this is simply a choice that one can make as a matter of convenience in evolving the spacetime .",
    "alternatively one could evolve both sides of the throat as one sees fit . in our 3d cartesian coordinate system , this is an easy option .",
    "the initial data are known everywhere , both inside the throat and out , so in principle one can simply evolve the entire spacetime without appealing to an isometry condition on the black hole throat . although the region inside the throat is very poorly resolved and the spacetime will not be very accurate there , this need not pose a problem since we are really only interested in the exterior region .    as we discuss in the sections below on the evolution of the black hole , we decide whether or not to apply the isometry depending on the behavior of the chosen lapse in the region of interest .",
    "if one is interested in evolving the black hole with geodesic slicing , where large gradients will develop near the throat , it is important to use the isometry boundary condition for accurate results that can be compared with 1d codes . for some singularity avoiding lapses that tend to collapse quickly , the isometry need not be imposed and the entire spacetime , inside and outside the throat , can be evolved without problems ( until late times when large peaks develop in metric functions near the horizon ) . in these cases",
    "the lapse tends to collapse near the black hole throat and also inside it , so that the evolution is essentially frozen in this region . for lapses that have the negative isometry",
    "sign initially , we have found it to be important to use the isometry throughout the evolution because of large gradients that develop in the lapse near the origin , as we discuss in more detail in section [ sec : results ] below .",
    "finally , we point out that we are ultimately interested in applying an apparent horizon boundary condition in 3d black hole spacetimes , which in principle obviates the need to consider any treatment of the throat  @xcite . in section [ sec : ahresults ] below we will show an example of how this can be achieved in 3d .",
    "another important problem that occurs when evolving black hole spacetimes is related to effects of singularity avoiding time slicing conditions .",
    "large peaks develop in the vicinity of the black hole horizon as time slices push forward away from the hole but are held back inside it ( see , e.g. , fig .",
    "[ fig:1dgrr ] ) .",
    "sharp peaks that develop in the solution to hyperbolic equations can cause numerical instabilities  @xcite , as we have seen in the black hole problem . a common strategy to cope with",
    "this problem is to add a small diffusion term to the evolution equations that effectively smooths out short wavelength features ( such as numerical noise ) .",
    "the usual way of achieving this is to add a second derivative term to an evolution equation with a small coefficient in front . in this way ,",
    "for example , the evolution for the metric functions would be @xmath115 where @xmath116 is very small . as we discuss below",
    ", this technique is important for the lapse evolution used for algebraic slicings but it has not cured the difficulties associated with grid stretching .",
    "it does damp out some noise at early times , but at late times when peaks are poorly resolved , it is not adequate .",
    "it is well known that the einstein equations do not determine either the lapse function or the shift vector .",
    "these quantities may be chosen freely . as nearly all work to date in numerical relativity has been done in 1d or 2d , most lapse and shift conditions have been developed with a particular symmetry or coordinate system in mind . in 3d cartesian coordinates , with no symmetries , these gauge and slicing conditions must be reexamined . in this section",
    "we discuss standard slicing conditions and their use in 3d , and propose another class of algebraic slicings that seem especially suited to 3d work .",
    "when evolving black holes numerically , the choice of lapse function is motivated by the need to keep the numerical grid from falling into the singularity .",
    "it has been shown that maximal slicing has this singularity avoiding property @xcite , so this slicing condition has been the most frequently used in 1d and 2d calculations . however , using maximal slicing requires solving an elliptic equation , which is computationally expensive , especially in 3d . therefore ,",
    "as we report below , we have also used a number of algebraic slicings which mimic maximal slicing .",
    "a very strong test of the code can be made by evolving the black hole with geodesic slicing , or simply @xmath117 and @xmath118 . with this slicing condition",
    "one can show ( see , e.g. , @xcite ) that a point initially on the black hole throat must fall into the singularity after a proper time ( in this case identical to coordinate time ) @xmath119 . in a numerical evolution , this is manifested by the radial metric function @xmath76 approaching @xmath120 and the angular metric function @xmath121 going to zero as a true curvature singularity develops . in short , the code must crash at @xmath122 . but particularly as all the various @xmath123 metric functions are evolved , not the just spherical metric functions @xmath76 and @xmath121 , and the isometry routine is used to provide boundary conditions on the throat as grid points crash towards the singularity , this is a serious code test .",
    "the system must remain spherical , even as singular structures are developing in the various cartesian metric functions .",
    "geodesic slicing also allows us to compare data from the 3d code with that obtained from a spherically symmetric 1d code without the complication of a lapse computation .",
    "see section [ sec : geodresults ] for both the crash time tests and the 1d comparisons .",
    "maximal slicing has been used extensively in numerical relativity ( see , e.g. , @xcite ) for several reasons : considerable analytic work has been done delineating its excellent singularity avoiding properties @xcite , it was used in early numerical work which centered on computing black hole spacetimes with einstein - rosen bridges , and it is conveniently computed from the 3metric and extrinsic curvature .",
    "maximal slices ( i.e. hypersurfaces with maximal volume ) are characterized by the vanishing of their mean curvature @xmath124 inserting this condition on the evolution equation for @xmath125 yields a condition on the lapse @xmath126 or , using the hamiltonian constraint , @xmath127 this latter form , fully expanded in eq .",
    "( [ maximal slicing ] ) , is the form used in the code .",
    "the right - hand - side of eq .",
    "( [ maximal slicing1 ] ) contains second derivatives of the metric functions , which can become difficult to compute accurately when peaks develop at late times .",
    "the form given by eq .",
    "( [ maximal slicing2 ] ) eliminates these derivatives and tends to be better behaved numerically .",
    "as noted in section [ sec : elliptic ] , we have developed a routine for the cm-5 which solves this kind of 3d elliptic equation .",
    "the results we obtained using this routine are discussed in section [ sec : maxresults ] .",
    "maximal slicing is an effective time slicing condition for avoiding singularities , but it suffers from several problems .",
    "it is very costly , especially in 3d on parallel machines , and it must be solved to a very high tolerance if noise in the solution is to be avoided , as we discuss in appendix [ sec : appendix ] below .",
    "however , slicing conditions are completely arbitrary , and there are many singularity avoiding lapse conditions that do not involve solving elliptic equations .",
    "the most convenient of these slicing conditions for numerical purposes belong to a class of _ algebraic _ lapse conditions .",
    "these lapse functions are algebraic combinations of the 3-metric components ; typically they are functions of the determinant of the 3-metric .",
    "one of the most well known of these slicing conditions is the harmonic time slicing condition . in the absence of a shift vector",
    ", this condition reduces to the simple equation @xmath128 where @xmath32 is the determinant of the conformal 3-metric and @xmath129 is a function of the three spatial coordinates to be specified .",
    "this lapse choice is known to be singularity avoiding , but just barely so .",
    "it has been shown by bona and mass  @xcite that this condition does not allow a time slice to hit a curvature singularity within a finite coordinate time , but it will come arbitrarily close .",
    "a separate code that uses this slicing condition exclusively , based on the formulation of bona and mass  @xcite , has been developed  @xcite .",
    "however , it is not considered here as the weak singularity avoiding nature of harmonic slicing makes it difficult to apply to black holes without some sort of apparent horizon boundary condition .",
    "their formulation has recently been extended to cover all singularity avoiding slicing conditions considered in this paper , including maximal @xcite , and a 3d code based on this formulation is under construction .    motivated by the harmonic slicing",
    ", we have explored a number of algebraic conditions that are simple to compute and avoid singularities more strongly than the harmonic condition .",
    "many such conditions have been explored by bernstein  @xcite in his studies of spherical black holes . generalizing the harmonic condition",
    "we can choose @xmath130 where again @xmath129 is an arbitrary function of the spatial coordinates and @xmath131 is some function of the conformal determinant of the 3-metric .",
    "these functions can be chosen as desired .",
    "one choice for @xmath131 that works particularly well leads to the slicing condition @xmath132 this lapse condition has the remarkable property that it mimics the action of maximal slicing . for spherical black holes , even at late times",
    "this slicing condition leads to spatial metric functions ( e.g. @xmath76 and @xmath121 ) that are quite similar in profile and size to those obtained with maximal slicing .",
    "a comparison of the metric radial function obtained with these two slicings in 1d is shown in fig .",
    "[ fig : a1dmaxalg ] .",
    "furthermore , one can show that if @xmath133 itself obeys an isometry condition , this lapse condition has the nice property that it transforms properly under the isometry operation discussed in section [ sec : isometry ] , so that the 3-metric @xmath18 , the extrinsic curvature @xmath19 , and the lapse @xmath8 all transform across the throat in such a way as to preserve the evolution equations .",
    "the algebraic slicings do have one notable drawback relative to maximal slicing in that they tend to be a bit too `` local '' .",
    "if some feature develops at a particular point in the 3-metric , the algebraic lapse responds instantly and locally .",
    "this is then fed back into the evolution equations through first and second spatial derivatives of the lapse , which can exaggerate undesirable features in the solution .",
    "the solution to an elliptic equation , on the other hand , tends to smooth over any local inhomogeneities . in order to decrease the locality of the algebraic lapse conditions , we have taken advantage of the evolution equation for the determinant of the 3-metric and used it to actually evolve the lapse .",
    "then we may add a diffusion term to the evolution equation for the lapse .",
    "the diffusion tends to smooth out any local , higher frequency features that develop , leading to a more stable evolution .",
    "this approach leads to the following scheme for the lapse : @xmath134 where @xmath135 is given by @xmath136 with lapse choices like this we were able to evolve the spherical black hole to nearly @xmath2 in time , as discussed in section [ sec : algeresults ] .",
    "for the most part the simulations presented in this paper are performed using a vanishing shift vector .",
    "however , the presence of black holes in numerical spacetimes introduces extreme behavior in the metric variables leading to large gradients that inevitably develop in the vicinity of the horizon when traditional singularity avoiding lapses are used . in 1d and 2d codes",
    "these problems have been troublesome , but not insurmountable , as the coordinate systems have generally been well suited to the problem at hand . in 2d , the trouble is essentially reduced to a 1d problem since the gradients occur primarily in the radial direction . for this reason , in these systems one could afford to add enough radial zones to solve or tame the problem by brute force for a certain period of time .",
    "however , even in these cases significant errors ( particularly evident in the horizon mass ) emerge from @xmath137 and grow to severe code crashing proportions by @xmath138 @xcite .",
    "an approach that is often tried is to use a shift vector to help reduce the gradients that develop in black hole simulations .",
    "a careful study of many commonly used shift conditions applied to the schwarzschild spacetime has been carried out by bernstein  @xcite .",
    "he has found that , at least for maximal time slicing , shift vectors such as minimal distortion , quasi - isotropic ( for this spherical case the quasi - isotropic gauge is the minimal distortion gauge @xcite ) , minimal strain , and various others , fail for the spherical black hole .",
    "however , in that study the radial component of the shift was forced to vanish at the throat of the black hole to satisfy the boundary condition that the isometry surface remains there .    in a new approach to evolving black hole spacetimes , the inner boundary of the computation is chosen not to be the throat of the wormhole , but the apparent horizon  @xcite or some point just inside the apparent horizon  @xcite .",
    "data inside this region , including the singularity , are causally disconnected from the region outside the horizon and are simply deleted from the calculation .",
    "for this reason , a singularity avoiding lapse is not required for black hole evolution ; the singularity is avoided by removing it from the problem .",
    "such an apparent horizon boundary condition has shown _ dramatic _ improvements in evolving black hole spacetimes in 1d , allowing evolutions of order @xmath139 with errors of order a few percent or less  @xcite .",
    "we believe this sort of apparent horizon shift condition will be essential to the development of accurate and stable 3d black hole codes in the future .    in ref .",
    "@xcite a number of shift vectors were introduced and studied for the realization of the apparent horizon boundary condition .",
    "although the location of the horizon is independent of the shift vector on any particular time slice , the time rate of change of its coordinate position is not .",
    "hence we can determine the value of the shift at the horizon that is needed to keep the horizon from moving across coordinates by , e.g. , @xmath140 where @xmath141 is the horizon position and @xmath142 is the expansion of the outgoing null rays on the spacelike 2-surface that defines the apparent horizon ( @xmath143 ) with unit outward pointing 3-vector @xmath144 @xcite .",
    "in addition to defining a local shift vector to control the motion of the horizon , we must also specify values for the shift at all other points in the spacetime .",
    "several such constructions were presented in ref .",
    "@xcite , including a `` distance freezing '' shift , an `` area freezing '' shift , and the `` minimal distortion '' shift . here",
    "we adopt one of these constructions , namely the `` distance freezing '' shift , to explore the feasibility of implementing horizon locking coordinates in 3d .",
    "in particular , we require that the radial metric function remain constant in time such that @xmath145 . in spherical geometry this yields a first order differential equation for the radial shift vector that can be solved as a single boundary value problem with the boundary condition set to lock the horizon in place .",
    "of course as the problem is treated as a full 3d problem , we use the three cartesian shift components @xmath146 , @xmath147 , and @xmath148 in this construction .",
    "results using this particular shift vector are discussed in more detail in sec .",
    "[ sec : ahresults ]",
    "as mentioned above in section  [ sec : geodesic ] , when a schwarzschild black hole is evolved with geodesic slicing , the analytic solution requires that the time slice hit the singularity at a proper time of @xmath149 .",
    "many runs were made at different resolutions to test our code against this analytic result . in fig .",
    "[ fig : crashtimes ] we show the time required to hit the singularity for a set of runs in which all parameters are held constant except for the spatial resolution and the courant factor .",
    "clearly , as either the grid spacing or the courant factor is decreased , the `` crash time '' approaches @xmath150 .",
    "there are two effects at work here .",
    "first , as one increases the resolution , the code is able to more accurately resolve the throat region where metric functions are becoming singular .",
    "second , as the time step is made smaller one is able to resolve the time at which the slice hits the singularity with more precision .",
    "evolving the black hole with geodesic slicing also allows one to perform a serious test of the evolution equations without the complication of the lapse computation .",
    "when one runs the code with high spatial resolution , e.g. @xmath151 , the peaks in @xmath76 and @xmath121 obtained from the cartesian metric functions line up almost exactly with those produced by a spherical , 1d code run with the same resolution , as shown in figs .",
    "[ fig : geodcompa ] and [ fig : geodcompb ] .",
    "these functions have been constructed from the cartesian metric function that are actually evolved . in fig .",
    "[ fig : geogxx ] we show a 2d slice through the plane @xmath82 of the cartesian metric function @xmath152 evolved to a time @xmath153 .",
    "( we factor out the dependence of the conformal factor @xmath54 to show the dynamical evolution more clearly . ) along the @xmath50-direction , this function behaves like @xmath154 , but in other directions it does not .",
    "it is only through the combination of all cartesian metric functions that the spherical behavior of @xmath155 is seen .    as mentioned above",
    ", it is not necessary in principle to apply the isometry condition across the throat .",
    "we have shown , however , that for accurate evolution it is necessary for the geodesic slicing case .",
    "when the isometry is not applied , the peak in the radial metric function grows faster than it should , causing the code to crash earlier than it would otherwise .",
    "also , the agreement with the 1d code is much better when the isometry condition is applied . this should not be surprising , because the isometry condition maps the entire spacetime region exterior to the throat to the domain inside the throat . as we are covering this interior region with a very small number of zones , it is impossible to evolve the interior accurately in this manner . by mapping the well resolved exterior numerical solution to the poorly resolved interior , we are able to achieve very high effective resolution inside the throat .",
    "the 3d results discussed thus far were obtained with the black hole throat located in a corner of the 3d grid , thereby permitting simulations that cover only one - eighth of the total spacetime volume .",
    "symmetry conditions were applied at the faces of the cube that match up to other interior regions of the spacetime , as discussed in section  [ sec : bc ] . to show that this technique does not affect our results ,",
    "we now show results obtained by evolving the full spacetime domain with the black hole throat located at the center of the 3d grid . in fig .",
    "[ fig : geofullgrr ] , we show a surface plot of a slice of the full 3d grid ( at @xmath82 ) of the metric function @xmath155 reconstructed from the cartesian metric functions",
    ".    we also took advantage of the simplicity of geodesic slicing to perform convergence tests on the evolution equations .",
    "convergence tests done on the code with second order spatial derivatives show that our code is indeed second order .",
    "a number of metric functions have been tested with similar results .",
    "convergence tests of this code applied to gravitational wave data sets give similar results  @xcite .",
    "in addition to comparing directly the behavior of metric functions obtained with our 3d cartesian and 1d spherical codes , we have also compared derived quantities that are sensitive measures of the physics being computed .",
    "for example , the location and mass of the apparent horizon of a black hole evolved numerically are particularly sensitive to errors in the calculations  @xcite . although we have not yet connected a full 3d apparent horizon solver to our code , we can take advantage of the fact that we expect our data to be spherical .",
    "( a 3d apparent horizon finder is under development  @xcite . )",
    "therefore we can transform the cartesian metric and extrinsic curvature components into their spherical coordinate counterparts , interpolate them onto a radial line which intersects the origin , and locate the apparent horizon along that line using a 1d apparent horizon finder . using this method",
    ", we were able to locate the position of the apparent horizon and compute its mass @xmath156 using the area relation @xmath157 where @xmath158 is the surface area of the horizon .",
    "for a schwarzschild spacetime , @xmath156 should be equal to the adm mass of the spacetime throughout the evolution , but due to numerical error this is difficult to achieve at late times , even in 1d and 2d codes  @xcite . with our 3d code",
    "we have computed these quantities along four different lines ( the @xmath159 , @xmath160 , and @xmath161 axes and the diagonal ) . using the location of the horizon found along these lines",
    ", we can compute an effective mass at each point by taking the metric functions found there and computing the area , assuming spherical symmetry .",
    "both the mass @xmath156 and the location of the horizon agree well both along different lines in the 3d domain , and with the values obtained with a 1d code .",
    "the position of the apparent horizon is shown in fig .",
    "[ fig : geodah ] .",
    "all lines are shown , but they are indistinguishable on this plot . in fig .  [",
    "fig : geodahmass ] we plot the apparent horizon mass computed along all four lines in 3d , as well as the 1d result .",
    "the masses are all within 0.07% of each other and the adm mass at @xmath153 .",
    "we now turn to results obtained using maximal slicing .",
    "these simulations were all performed by evolving the spacetime both outside and inside the throat , without using the isometry condition .",
    "earlier work on numerical black hole evolution with maximal slicing in 1d ( see , e.g.  @xcite ) and 2d ( see , e.g. ,  @xcite ) has taken advantage of the isometry to use the throat as an inner boundary on both the evolution and the solution to the maximal slicing equation . in those cases ,",
    "the isometry was a simple differential condition across the throat in the spherical coordinate system used . in this 3d case",
    "the cartesian boundary conditions on the lapse are cumbersome to apply in the elliptic solver , so we have chosen to evolve the entire domain inside and outside the throat . as we will show below , the lapse collapses quickly both outside _ and _ inside the throat , halting the evolution there .",
    "although in this case the evolution inside the throat is no longer isometric to that outside , it is of little consequence .",
    "the first case we consider is a simulation evolving a single octant of the full 3d spacetime .",
    "this is a typical run , with a resolution of @xmath162 equally spaced zones , with @xmath163 .",
    "the outer boundary was located at @xmath164 .",
    "such a calculation can be performed on a daily basis on the ncsa cm-5 . in this case",
    "the boundary conditions on the metric and extrinsic curvature components are treated as in section  [ sec : otherbc ] .",
    "the boundary conditions on the lapse are treated in a similar manner , with reflection symmetry used at the inner boundaries ( @xmath80 , @xmath81 , and @xmath82 planes ) and the spherical schwarzschild value is maintained at the outer edges of the grid ( i.e. @xmath165 ) .",
    "this treatment at the outer edges of the cube was crucial in maintaining a stable evolution there .",
    "if the lapse is taken to be , say @xmath166 in the outer region , serious edge effects and nonspherical behavior develop quickly .",
    "first we show the lapse function @xmath8 at a late time of @xmath167 . in fig .",
    "[ fig : maxalpha ] a 2d slice of the lapse through the plane @xmath82 is shown .",
    "it has collapsed throughout the throat region and also in a region outside it , and then climbs steeply towards its outer schwarzschild value in spherical step function fashion .",
    "a full 3d analysis indicates that the lapse is quite spherical throughout the volume , in spite of the fact that our solution is carried out in cartesian coordinates with boundary conditions imposed on the faces of a cartesian cube .    in fig .",
    "[ fig : maxgxx ] we show a 2d slice ( at the plane @xmath82 ) of the conformal metric function @xmath168 at the same time @xmath167 . by this time",
    "serious gradients and shearing are developing in the metric functions due to the grid stretching effects that result from maximal slicing . along the @xmath159direction",
    ", the metric function @xmath169 behaves much like a radial metric function @xmath155 . along the @xmath160direction , however , the function @xmath169 is essentially flat , and along the diagonal there is a very sharp transition region .",
    "this is quite typical of the effects of singularity avoiding lapse conditions . in fig .",
    "[ fig : maxgrr ] we show a 2d slice ( through the plane @xmath80 ) of the metric function @xmath170 reconstructed from the six cartesian metric functions at time @xmath167 for the same simulation .",
    "the familiar spherical peak is developing around the black hole , as in 1d and 2d calculations ( see , e.g. , fig .",
    "[ fig:1dgrr ] ) .    as in the previous section on geodesic slicing , we have tracked and analyzed the apparent horizon in these simulations , and compared the results to those obtained using a spherical , 1d code . in fig .",
    "[ fig : maxah ] we show the apparent horizon location from our 3d code as determined by considering radial lines along the @xmath159 , @xmath160 , and @xmath161 axes and the diagonal of the cube .",
    "the independent results obtained by evolving a maximally sliced spherical black hole with a 1d code are shown as a dot - dashed line .",
    "the agreement is quite good , within one 3d grid zone at late times . we do not expect perfect agreement in the location of the horizon in coordinate space , since the slicing and boundary conditions are slightly different . in the 1d case ,",
    "the evolution was performed with an isometry condition across the throat .",
    "consequently , the maximal slicing condition was implemented with a symmetric boundary condition there .",
    "the 3d calculation was performed _ without _ an isometry at the throat .",
    "furthermore , the maximal slicing condition becomes a simple ordinary differential equation in 1d , whereas in 3d it was solved as a full 3d elliptic equation with boundary conditions applied on the faces of a cube .",
    "for these reasons the slicing and geometric meaning of the coordinates will differ somewhat from the 1d case .",
    "a more geometrically meaningful measurement is of the _ mass _ of the apparent horizon as defined by eq .",
    "( [ ahmass ] ) , which we compute in each of four directions , as described in the geodesic slicing case above .",
    "results are plotted in fig .",
    "[ fig : maxahmass ] , and compared with results obtained for the 1d simulation .",
    "as this is a schwarzschild spacetime , @xmath156 should be the schwarzschild mass and constant in time . from the figure",
    "one can see that the error is slightly larger along the diagonal than in the other cases after about @xmath171 .",
    "this can be understood by considering that the effective resolution in the radial direction is less along the diagonal due to geometric effects .",
    "the measurements made along the three axes agree with each other , as expected , and agree reasonably well with measurements made along the diagonal line . also , the measurements made along all four lines agree well with the 1d result , although at the end of the calculation , when the peaks in metric functions are growing dramatically ( see , e.g. , fig .",
    "[ fig : maxgrr ] ) , the 1d result is slightly better .    as noted above , these results are typical of what is achieved at `` medium '' resolution . with this resolution ,",
    "instabilities develop in the region of strong metric peaks and the code crashes by about @xmath172 . at the highest resolution achievable with our present code and the present ncsa cm-5 ( about @xmath173 zones with maximal slicing ) , we can reach about @xmath174 . as the code is second order accurate ,",
    "the results are better at higher resolution .    to demonstrate that our code can also evolve a black hole in full 3d , without symmetries used at the boundaries , we show results for a maximally sliced black hole placed at the center of the computational grid .",
    "because this calculation requires eight times the memory and computer time , it can not be run at the same resolution as the calculation discussed above . in fig .",
    "[ fig : maxgrrfull ] we show a 2d slice through the @xmath82 plane of the metric function @xmath155 on the full grid at a time @xmath175 .",
    "the spherical nature of this function is evident . in fig .",
    "[ fig : maxgrrcompare ] we show a comparison of a 1d cross section of this slice with the same function obtained by evolving a single octant of the spacetime at the same resolution with the same outer boundary location . in the plot , it is clear that the functions agree extremely well .",
    "it turns out , however , that for the maximal slicing case the results are not _ exactly _ the same because of the iterative solver used to compute the lapse function .",
    "however , the resulting difference is negligible .",
    "it is clear that maximal slicing presents a number of problems for 3d black hole evolution .",
    "not only is it very time ( and memory ) consuming to solve a 3d elliptic equation on every time slice , but it is also difficult to resolve on a 3d cartesian grid the kinds of very sharp , spherical step function features that develop in the solution .",
    "tolerances on the solver must be set quite tightly , especially at late times , in order to get a good solution . towards the end of the calculation , just before instabilities in the hyperbolic solution set in , the solution for @xmath8 can actually become slightly negative at the `` base '' of the step function , and the derivatives of @xmath8 can become unsmooth , both due to difficulties associated with solving for this function on a 3d cartesian grid .",
    "these problems can be delayed by increasing tolerances or resolution , but at some point they will develop in all cases studied .      as shown above ,",
    "maximal slicing is effective for avoiding a black hole singularity , but in cartesian coordinates it can develop problems at late times , and it is very time consuming .",
    "algebraic slicings are cost effective alternatives to maximal slicing that have not been explored extensively in numerical relativity .",
    "a theoretical discussion of slicings we have considered was given in section  [ sec : algebraic ] above . in this section",
    "we discuss results obtained for the condition @xmath176 where @xmath129 is an arbitrary function of the spatial coordinates . for more detailed discussion of its properties",
    "please refer to section  [ sec : algebraic ] .",
    "as the function @xmath129 can be chosen at will , this slicing condition still has considerable freedom .",
    "the grid stretching problems associated with black hole evolutions are severe enough in 3d to halt the evolution due to the unbounded growth in metric functions , as shown above for maximal slicing .",
    "therefore , in choosing @xmath129 one would like to delay the grid stretching effects while allowing true dynamics to evolve . a good choice for this is a lapse condition that vanishes on the black hole throat . in this case",
    ", we choose the function @xmath129 to have the value of the schwarzschild lapse and evolve @xmath8 with eq .",
    "( [ evolvelapse ] ) . in principle",
    "this choice of slicing condition makes the time coordinate @xmath177 the killing time , so that if the system were evolved analytically the metric would be truly static .",
    "however , this requires perfect cancellation between second derivatives of the lapse and ricci tensor components in the extrinsic curvature evolution equations ( see eq .",
    "( [ excurv evolution ] ) ) , which will not occur due to discretization error .",
    "therefore , the black hole will evolve in time , although the initial grid stretching effects will be slowed dramatically due to the lapse profile . at later times",
    "the lapse collapses and develops a profile similar to the maximal slicing discussed above .",
    "such `` antisymmetric '' ( in the appropriate sense across the throat ) lapse conditions have been used extensively in other calculations , such as the collision of two black holes  @xcite and rotating black holes  @xcite .    in figs .",
    "[ fig : alglapse]a , b , c we show the lapse at times @xmath178 , @xmath179 ( partially collapsed ) and @xmath180 respectively for a simulation run with @xmath181 zones with @xmath182 .",
    "as the lapse is antisymmetric across the throat , it approaches the value @xmath183 at the origin , and its gradient becomes undefined there .",
    "for this reason it is essential to perform the evolution with the isometry condition imposed so that the throat interior is obtained by mapping the exterior solution rather than through evolution equations . by time",
    "@xmath172 the lapse has begun to collapse around the throat and by @xmath180 it has collapsed dramatically with a profile very similar to that seen with maximal slicing .    in fig .",
    "[ fig : alggrr ] the metric function @xmath184 is shown , also at @xmath180 .",
    "as before , this function has been constructed from the cartesian metric coefficients , and shows the familiar peak surrounding the black hole throat .",
    "the prominent peak structure _ inside _ the throat results from the mapping of the exterior to the interior region . as in the previous cases ,",
    "we have also compared the evolution with the black hole placed in the center of the grid to the evolution with the hole in the corner , with the same results .    because of the growth of the large gradients in the metric functions , the evolution becomes unstable shortly after this time , causing the code to crash by @xmath0 at this resolution .",
    "higher resolution can stall the development of this instability somewhat , but at some point it develops for all computational parameters tested to date ( e.g. , artificial viscosity parameters , resolution , outer boundary , slicing choice , etc . ) . as we discuss in the next section ,",
    "the use of a shift and an apparent horizon boundary condition is a promising way of avoiding this problem .",
    "it is clear from the results in the above sections that in using singularity avoiding slicings , independent of the choice of lapse , a sharp peak will develop in a region slightly inside the horizon , where the lapse has not completely collapsed .",
    "this is the major limitation to an accurate long term evolution . as discussed in sec .",
    "[ sec : shift ] the development of such a peak can be suppressed by using an apparent horizon boundary condition  @xcite . here",
    "we report on the first results obtained in testing this condition in 3d .    in this first trial implementation of the apparent horizon boundary condition",
    ", we compute the `` distance freezing '' shift for the 3d cartesian evolution by first going back to spherical coordinates , determining the appropriate shift at each time step and then transforming the resulting shift vector back to 3d cartesian coordinates .",
    "the determination of this shift in the spherical coordinate case has been discussed in detail in  @xcite .",
    "[ fig : ahshiftlapse ] and  [ fig : ahshiftgrr ] show the results for the lapse function and conformal radial metric function @xmath154 ( reconstructed from the cartesian components ) at various times , up to @xmath172 .",
    "these results are run using a @xmath185 grid with cell sizes of @xmath186 placing the outer boundary at @xmath187 in each direction .",
    "the data are displayed along the diagonal line running from the center of the black hole to the furthest corner . in this case , the shift vector is imported and translated from a 1d simulation , but all other computations in the evolution are performed in the full 3d code .",
    "the equations are evolved in their most general 3d form , without using explicitly any simplification due to the particular gauge choice . in this simulation",
    ", we allow the spacetime to evolve for a short time ( @xmath188 ) before phasing in the shift vector . during this period",
    ", the maximal slicing condition makes the lapse collapse slightly ( as shown in fig .",
    "[ fig : ahshiftlapse ] ) and the coordinate position of the horizon moves outward .",
    "this motion of the horizon allows for a `` buffer '' region of zones inside the horizon  @xcite . from @xmath189 , while the horizon continues to move outward , we smoothly phase in the distance freezing shift vector . by @xmath190",
    "the shift vector is fully phased in and the horizon remains approximately locked in place at @xmath191 . at this point",
    "we drop the inner part ( @xmath192 ) of the grid from the dynamical evolution . at the inner most grid point retained in the evolution ,",
    "we import the values of the metric functions determined with the spherical code , in the same way as we import the shift vector . with the part of the grid which is going to run into the singularity dropped from the evolution ,",
    "there is no need to further collapse the lapse , which is hence held constant in time from this point onward .",
    "notice that with such a time independent lapse , which is non - zero everywhere in the evolved domain , it is _ not _ possible to evolve the spacetime in the usual treatment without a horizon boundary condition . the metric functions ( of which @xmath76 in fig . [ fig : ahshiftgrr ] is typical ) evolve rapidly before and during the phase - in period , but settle down afterwards .",
    "there is _ no _ sharp peak , and @xmath76 is of order one throughout the evolution .",
    "this is to be compared to @xmath76 in figs .",
    "[ fig : maxgrr ] and  [ fig : alggrr ] above obtained without the distance freezing shift . without a sharp peak in the metric function , the requirement on resolution is reduced substantially .",
    "ideally the radial metric function @xmath76 would remain constant in time with the imported shift vector .",
    "however , at late times there is a slow downward drifting of the metric functions observed away from the values at which they are supposed to be `` locked '' ( for details , see  @xcite ) .",
    "we note that , in this implementation , once the metric functions start drifting , there is nothing to stop them from drifting further , as the shift is taken to be a constant in time in this implementation .",
    "what is noteworthy is that such a simple implementation is already effective .",
    "it nearly freezes @xmath76 as designed for quite some time , and , more importantly , the steep peaks observed in the previous sections have been eliminated . in comparison to those fast growing sharp peaks , the slow and rather smooth drift shown in fig .",
    "[ fig : ahshiftgrr ] should be considered very satisfactory .",
    "the elimination of steep peaks is important , and is expected to lead to a much more accurate evolution . as a check on the accuracy of this simulation",
    "we have computed the location and mass of the apparent horizon as in the previous sections . in fig .",
    "[ fig : ahshiftah ] we show the location of the apparent horizon computed during this simulation as a solid line , and the same quantity computed with a 1d code at the same resolution without the use of a horizon locking shift . after the initial phase - in period",
    ", the horizon is firmly locked in place by the shift , while it continues to move away from the throat without the shift . in fig .",
    "[ fig : ahshiftahmass ] we show the apparent horizon mass obtained in the 3d code with the horizon locking shift , compared to the 1d case without such a shift . in this first 3d test case",
    "the error in the horizon mass is about the same as the 1d case without shift at @xmath172 , the final time computed in the 3d case .",
    "however , and more importantly , the slopes of the curves suggest that the 3d result will be significantly more accurate at later times than the 1d result without a horizon locking shift .",
    "we consider these results very satisfactory in this first test of the horizon boundary condition in 3d , using a highly simplified treatment .",
    "these results support the claim that apparent horizon boundary conditions are realizable in the near future and we are currently working on the full scale horizon boundary treatment .",
    "progress on that will be reported elsewhere .",
    "we have developed a general 3d cartesian code for solving the einstein equations in the absence of symmetries .",
    "this code has been applied to the problem of black hole spacetimes , and we have reported on the first long term evolution of a black hole in 3d .",
    "black hole spacetimes are made quite difficult to study by the need to avoid the singularity inside the horizon .",
    "we concentrated in this paper on the evolution of a spherical black hole , since it has the most troublesome feature ( the singularity ) and can be studied very carefully in 1d as a benchmark for what is required of a 3d evolution .",
    "however , because we treat the spherical test problem in a general way in cartesian coordinates , we have been able to learn a great deal about the generic 3d black hole spacetime problem , which we summarize here .",
    "the boundary conditions on the spacetime can be treated in a number of ways .",
    "we have demonstrated that the isometry that is commonly applied at the black hole throat can be applied effectively in a 3d black hole evolution in cartesian coordinates , but this is not necessary .",
    "for some slicing conditions the isometry condition is important in maintaining accuracy near the throat , but for others it is not required .",
    "for example , in our maximal slicing simulations , the isometry is not needed and the entire black hole spacetime inside and outside the throat can be evolved .",
    "the boundary conditions at the outer edge of the grid are more delicate , however . in previous calculations carried out in 1d and 2d , the outer boundary has been placed far enough away that the metric could be held static , but in 3d this does not work as well .",
    "we have tested several conditions that use extrapolation , but in most cases , extrapolation boundary conditions give worse results than keeping the outer boundary static .",
    "the reason why these methods do not work well is clear : these methods deal only with the spatial part of the metric , without taking the time slicing into account . the time slicing introduces two effects .",
    "first as the constant @xmath177 slices , with @xmath177 not the killing time of the schwarzschild geometry ( e.g. , maximal slicing with certain boundary conditions ) , are `` tilted '' with respect to the killing one . with the grid points moving normal to the time slicing as in the case without a shift ,",
    "they are moving ( for maximal slicing , infalling ) with respect to the geometry .",
    "this directly affects the angular part of the metric functions , here in cartesian coordinates some combination of @xmath18 .",
    "secondly , as the constant @xmath177 slices are also `` curved '' with respect to the killing one , the `` speeds '' with which the grid points move with respect to the geometry will be different .",
    "this affects the radial part of the metric function , here a different combination of @xmath18 . with the assumption that the spacetime geometry near the outer boundary is locally the same as that of schwarzschild ,",
    "both of these two effects can be taken into account by analyzing how a time slicing , as specified by a given lapse function , is locally embedded in the schwarzschild geometry . in the present case ,",
    "as we are actually evolving a schwarzschild hole , this boundary condition is exact and can be put arbitrarily close to the hole . for a general spacetime , whenever the outer boundary can be placed far out enough so that the spacetime there can be approximated by the schwarzschild geometry locally , this will provide an accurate outer boundary condition .",
    "we have successfully constructed such an outer boundary scheme in the 1-d case , and its extension to 3d is at present under development , and will be reported elsewhere .    many slicing and gauge conditions",
    "have been tested and reported in this paper . for geodesic",
    "slicing , we demonstrated that the 3d code reproduces the results from a 1d code with a high degree of accuracy , both by comparing metric functions and by looking at derived quantities such as apparent horizon locations and masses .",
    "a number of singularity avoiding slicings have been developed for 3d , including maximal and a class of algebraic slicings .",
    "maximal slicing works well , as in 1d and 2d simulations , until the gradients in the metric become very pronounced . at that time",
    "very tight tolerances on the elliptic solver are required to improve the accuracy and smoothness of the lapse solution , but problems develop at late times in all cases studied .",
    "we have shown that the algebraic slicings are quite promising and economical , and in some cases we have been able to evolve beyond @xmath0 .",
    "we regard the algebraic slicings as a major step forward for 3d black hole evolution , but in _ all _ slicings studied the evolution can not be carried beyond a certain point due to extreme grid stretching effects .",
    "these difficulties have been long recognized in 1d and 2d studies , but they are more severe in 3d . by adding more resolution or viscosity terms one can delay the growth of instabilities , but a more fundamental approach to the problem is needed .",
    "different formulations of the equations , such as those discussed in  @xcite , allow for the use of other numerical techniques that may be able to handle the peaks that show up in the metric functions better .    in order to solve these problems ,",
    "apparent horizon boundary conditions are under development by a number of researchers  @xcite .",
    "we have demonstrated that a shift vector designed to prevent coordinates from falling into the hole , combined with cutting away the singular region inside , can work quite well in a 3d cartesian black hole simulation . in fact , our simulations indicate that with apparent horizon boundary conditions , 3d calculations can be as accurate or better than standard 1d calculations without such a boundary condition .",
    "we are presently working to develop a full implementation of an apparent horizon boundary condition in 3d .    in the near future",
    "we plan to use our code to solve the problems of the axisymmetric distorted black hole , both rotating and non - rotating , and also the axisymmetric misner data for two colliding black holes .",
    "these will be the first truly dynamic black hole spacetimes with gravitational radiation to be studied in 3d , but they can be compared with results obtained with mature , axisymmetric codes .",
    "these are all steps towards the simulation of general , 3d binary black hole interactions .",
    "scientific animations of some of our simulations have been prepared and are kept on our www server .",
    "they may be viewed at the url http://jean-luc.ncsa.uiuc.edu .",
    "we are pleased to acknowledge helpful conversations with a number of our colleagues , especially robert ferrell and larry smarr .",
    "the calculations were performed on the cray c90 at the pittsburgh supercomputing center and the thinking machines corporation cm-5 at ncsa .",
    "this work has been supported by ncsa , by nsf grants nos .",
    "phy91 - 16682 , phy94 - 07882 , phy94 - 04788 , and phy / asc93 - 18152 ( arpa supplemented ) , by nasa grant no .",
    "nag 5 - 2201 , and by the joint nsf - nasa jnnie project asc 89 - 02829 .",
    "j.m . acknowledges a fellowship ( p.f.p.i . ) from ministerio de educacin y ciencia of spain .",
    "here we discuss various issues involved in developing our 3d code , making it efficient for a wide variety of architectures , and particular numerical issues relevant to the black hole problem .",
    "we are currently running our codes on the thinking machines cm-5 massively parallel distributed memory system , the cray c90 vector multiprocessor and the silicon graphics power challenge multiprocessor . we are extending our codes to run on many other parallel systems . in the approach we have taken ,",
    "the basic programming language is fortran  90 , a data parallel model . extensions available in high - performance fortran ( hpf ) are used when needed , but special functions unique to a particular machine are avoided whenever possible . in this way",
    "the vast majority of the code can be used on all machines .    to deal with differences among the machines we implement a preprocessing stage to all the source files . by using compiler conditionals to select appropriate code for specific operations ,",
    "we are able to maintain a single set of source files that can be used for compilations on all the systems . for example",
    ", at present , only the cm-5 supports fortran  90 array intrinsic functions such as maxloc(a ) . in these situations ,",
    "we use such functions when supported , but also provide alternate code for other machines to perform the same operation where necessary .",
    "this has led to a rather sophisticated build process , but provides great benefits in the maintenance and development of the code .      in numerical relativity",
    "a large number of variables must be stored . in the standard adm split ,",
    "the basic variables are six metric functions , six extrinsic curvature variables , three shift components , and the lapse . during an evolution ,",
    "most of the quantities must be stored on two time slices , requiring approximately 30 variables just for the evolution alone .",
    "in addition , in order to reduce the complexity of expressions and to save repeated computation , it is convenient to compute the contravariant metric components @xmath193 , 3-ricci components @xmath15 , and numerous temporary variables throughout the code , resulting in excess of 50 variables that need to be stored on every time slice .",
    "however , there are other important considerations for distributed memory machines",
    ". there are dozens of spatial derivatives that must be computed on every time slice , and these derivatives appear repeatedly in the einstein equations .",
    "each derivative operation requires communication between memory locations , which can be computationally expensive on a distributed memory machine because the data required for a derivative operation may reside on different processors .",
    "the communications overhead is more serious for higher order accurate derivatives ( e.g. second vs. fourth order ) because more data points and hence more communications are required .",
    "therefore , we adopt the strategy of computing and storing all spatial derivatives on each time slice , so we may compute derivatives once and reuse the results as needed .",
    "this technique improves performance dramatically on distributed memory machines , ( although it is unimportant on shared memory machines such as a cray c90 ) , but it requires much more storage on each time slice .",
    "however , in 3d if one doubles the storage requirements , the maximum resolution one can achieve in each direction only decreases by @xmath194 , or about 28% . with techniques like these",
    "we have been able to achieve performance for the `` g '' code used in this paper of nearly 12 gflops for very large problems on a 512 node cm-5 , although smaller problems run less efficiently . on that machine , with 16 gbytes of memory , we can perform simulations of about @xmath79 zones .",
    "we use an explicit hyperbolic scheme to evolve the spacetime .",
    "such algorithms are especially suited to parallel computing , because most computation is local to a processor .",
    "the spacetime data are distributed across the various processors , and the evolution of data on a particular point on the grid depends only on `` nearby '' information in a hyperbolic system .",
    "communication time between processors , which is usually the bottleneck in parallel computing , is required only when computing spatial derivatives via finite differences that connect different processors .",
    "communications are done only once on each time slice , and then extremely long numerical calculations are performed to evaluate expressions in the evolution equations . therefore , the relevant communications to computation ratio is very small , leading to excellent performance .",
    "the einstein equations are ideal for distributed , parallel computing .",
    "a difficult code optimization problem comes in solving the elliptic equations necessary when we evolve the system using maximal slicing .",
    "the code then needs to solve a new elliptic equation on every time step , although one can save work by solving the equation less frequently , as it is only a gauge condition .    for efficiency in memory use ,",
    "the matrix of finite difference coefficients can be stored as nineteen 3d arrays requiring us to store only @xmath195 elements as opposed @xmath196 elements for the full matrix which consists primarily of zeroes .",
    "this also allows us to store the coefficients in a manner that relates logically to the computational grid . if the elliptic operator for the equation is symmetric in form , we could also realize further memory conservation by storing only the upper or lower triangular portions of the coefficient matrix and need to have only ten 3d arrays .",
    "however , due to the communications expense in implementing this scheme on parallel architectures , it is much more efficient to store the entire matrix , even when it is symmetric .",
    "when we use maximal slicing to foliate the spacetime , the lapse function develops a nearly step - function profile , making it difficult to compute accurate finite difference derivatives of this function for the hyperbolic evolution part of the code .",
    "therefore , we need to solve the maximal slicing equation to a very high tolerance to resolve sharp features accurately , requiring many iterations of the solver .",
    "each iteration of the iterative solver requires one or more products of the sparse coefficient matrix with a vector .",
    "when running the code on the cm-5 , the communications become very time consuming , because in order to compute the matrix - vector product , each processing node requires some data from another processor .",
    "optimization of this communication is crucial for an efficient implementation .",
    "investigation into alternative solvers has shown that , particularly for massively parallel architectures , iterative methods are typically more efficient than direct solvers .",
    "recent work in parallel direct solvers may change this  @xcite , but at present iterative methods are quite good for problems involving regular computational meshes .",
    "experience in development of ncsa 2d evolution codes indicates that multigrid solvers will play an important role for very large meshes that will be needed to solve the 3d evolution problem accurately .",
    "we are currently investigating a parallel implementation of multigrid for our problem .",
    "the current performance of the code is nearly 12 gflops on the 512 node cm-5 at ncsa .",
    "this is achieved using a grid of @xmath79 points and evolving the system with geodesic slicing .",
    "it takes approximately 2 seconds of cpu time per time step , with every grid point requiring more than 4000 floating point operations per time step .",
    "algebraic slicings require a bit more time per iteration due to the use of the isometry conditions .",
    "typical daily runs of @xmath181 grid points on a 256 node cm-5 require about 1.5 hours to complete an evolution of 2000 iterations .    with maximal slicing",
    ", the elliptic solver slows down the performance to nearly 6 gflops for a maximum grid size of @xmath173 .",
    "both the performance and the run time strongly depend on the tolerance imposed on the iterative solver and on how often one solves for the lapse .",
    "typical runs of @xmath181 take more than 3 hours .",
    "these numbers are constantly changing , as we continue to optimize the code and new versions of the compiler are released .",
    "a complete table showing the latest performance numbers for the current version of the code and analysis of linear speedup can be found in our web server at http://jean-luc.ncsa.uiuc.edu ."
  ],
  "abstract_text": [
    "<S> we report on a new 3d numerical code designed to solve the einstein equations for general vacuum spacetimes . </S>",
    "<S> this code is based on the standard 3 + 1 approach using cartesian coordinates . </S>",
    "<S> we discuss the numerical techniques used in developing this code , and its performance on massively parallel and vector supercomputers . as a test case , we present evolutions for the first 3d black hole spacetimes . </S>",
    "<S> we identify a number of difficulties in evolving 3d black holes and suggest approaches to overcome them . </S>",
    "<S> we show how special treatment of the conformal factor can lead to more accurate evolution , and discuss techniques we developed to handle black hole spacetimes in the absence of symmetries . </S>",
    "<S> many different slicing conditions are tested , including geodesic , maximal , and various algebraic conditions on the lapse . with current resolutions , limited by computer memory sizes , </S>",
    "<S> we show that with certain lapse conditions we can evolve the black hole to about @xmath0 , where @xmath1 is the black hole mass . </S>",
    "<S> comparisons are made with results obtained by evolving spherical initial black hole data sets with a 1d spherically symmetric code . </S>",
    "<S> we also demonstrate that an `` apparent horizon locking shift '' can be used to prevent the development of large gradients in the metric functions that result from singularity avoiding time slicings . </S>",
    "<S> we compute the mass of the apparent horizon in these spacetimes , and find that in many cases it can be conserved to within about 5% throughout the evolution with our techniques and current resolution . </S>"
  ]
}