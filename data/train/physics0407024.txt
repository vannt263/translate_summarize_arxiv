{
  "article_text": [
    "the evolution problem for a collection of charges under the action of their own fields when certain initial conditions are given is , in general , a formidable one .",
    "numerical methods are often the only way to obtain an approximate solution , while there are only a few cases in which finding an exact treatment is possible .",
    "in this paper we report a fully self - consistent solution to one of these problems , namely the evolution of a relativistic electron beam under the action of its own fields in the ( longitudinal ) direction of motion .",
    "the problem of longitudinal space - charge oscillations has been , so far , solved only from an electrodynamical viewpoint @xcite , or using limited one - dimensional models @xcite . on the contrary , in our derivation",
    "the beam , which is assumed infinitely long in the longitudinal direction , is accounted for any given radial dependence of the particle distribution function .",
    "an initial condition is set so that the beam is considered initially modulated in energy and density at a given wavelength .",
    "when the amplitude of the modulation is small enough the evolution equation can be linearized .",
    "an exact solution can be found in terms of an expansion in ( self - reproducing ) propagating eigenmodes .",
    "our findings are , in first instance , of theoretical importance since they constitute one of the few exact solutions known up to date to the problem of particles evolving under the action of their own fields .",
    "next to theoretical and academical interest of our study we want to emphasize here its current relevance to applied physics and technology .",
    "for example , particle accelerator physics in general and fel physics in particular make large use of simulation codes ( see for instance @xcite ) in order to obtain the influence of space - charge fields on the beam behavior .",
    "yet , these codes are benchmarked against exact solutions of the electrodynamical problem alone ( i.e. solutions of poisson equation ) and only recently @xcite partial attempts have been made to benchmark them against some analytical model accounting for the system evolution . however , such attempts are based on one - dimensional theory which can only give some incomplete result . on the contrary",
    ", we claim that our findings can be used as a standard benchmark for any space - charge code from now on .    to give some up - to - date example of practical applications ( besides , again , theoretical and numerical importance ) we wish to underline that our results are of relevance to an entire class of problems arising in state - of - the - art fel technology .",
    "in fact , several applications rely on feeding ( optically ) modulated electron beams into an fel . for instance , optical seeding is a common technique for harmonic generation @xcite .",
    "moreover pump - probe schemes have been proposed that couple the laser pulse out of an x - ray fel with an optical laser . to solve",
    "the problem of synchronization between the two lasers a method has been proposed , which makes use of a single optically modulated electron beam in order to generate both pulses .",
    "this proposal relies on the passage of this electron beam through an x - ray fel and an optically tuned fel @xcite : given the parameters of the system , plasma oscillations turn out to be a relevant effect to be accounted for .",
    "it is also worth to mention , as another example , the relevance of plasma oscillation theory in the understanding of practical issues like longitudinal space - charge instabilities in high - brightness linear accelerators .",
    "high - frequency components of the bunch current spectrum ( at wavelengths much shorter than the bunch length ) can induce , through self - interaction , energy modulation within the electron beam which is then converted into density modulation when the beam passes through a magnetic compression chicane , thus leading to beam microbunching and break up .",
    "when longitudinal space - charge is the self - interaction driving the instability ( see @xcite ) , one is interested to know with the best possible accuracy how plasma oscillations modulate the bunch , in energy and density , before the compression chicane .",
    "our calculations can be applied to these cases directly or in support to macroparticle simulations thus providing outcomes of immediate practical importance .    throughout this paper",
    "we will make use of @xmath3 units .",
    "our work is organized as follows .",
    "next to this introduction , in section [ sec : theory ] , we pose the problem in the form of an integro - differential equation which makes use of naturally normalized quantities . in section [ sub : axis ]",
    "we present our main theoretical results . in the following section [ sub : test ]",
    "we describe some applications and important exemplifications of the obtained results , including the role of the initial condition .",
    "finally , in section [ sec : concl ] we come to conclusions .",
    "we are interested in developing a theory to describe longitudinal plasma waves in a relativistic electron beam . in order to do",
    "so we have to find a way to translate in mathematical terms the idea of dealing with the longitudinal dynamics only , while keeping intact the general three - dimensional description of the system ( electromagnetic fields and particle distribution ) .",
    "immediately related with the development of a theory , is its range of applicability .",
    "the idea of selecting longitudinal dynamics translates from a physical viewpoint in the assumption that the longitudinal space - charge fields , alone , describe the system evolution .",
    "this corresponds to a situation with physical parameters tuned in such a way that , on the time - scale of a longitudinal plasma oscillation , transverse dynamics does not play a role .",
    "one may , of course , devise different methods to select the longitudinal dynamics alone : actually he will come up with some ideal approximation of what real focusing systems in modern linear accelerators do , provided that the @xmath4-functions are large enough with respect to the plasma wavelength .    whatever the practical or ideal mean chosen to select longitudinal dynamics such a choice translates , from a mathematical viewpoint , in the choice of dynamical variables along the direction of motion only , while transverse coordinates enter purely as parameters in the description of the fields and of the particle distribution .",
    "our beam is initially modulated at some wavelength @xmath5 , in density and energy .",
    "this is no restriction because , as said in section [ sec : intro ] , the modulation amplitude is considered small enough so that we can linearize the evolution equation .",
    "then , a fourier analysis of any perturbation in energy and density is customary .",
    "once the modulation wavelength @xmath5 has been fixed , it is natural to define the phase @xmath6 , where @xmath7 is the longitudinal electron velocity at the nominal beam kinetic energy @xmath8 , @xmath9 , @xmath10 is the time and @xmath11 the longitudinal abscissa . upon this , and after what has been said about the choice of longitudinal dynamics , it is appropriate to operate in energy - phase variables @xmath12 , @xmath13 being the deviation from the nominal energy .    in this spirit the total derivative of the phase @xmath14 is given by :    @xmath15    now , if we assume that the particle energy is not significantly different from the nominal energy we can expand @xmath16 in @xmath17 around @xmath18",
    ". keeping up to second order terms in @xmath17 and using the definition of @xmath13 we find    @xmath19    where we took advantage of the fact that @xmath20 ) , where @xmath21 .",
    "note that , here , we distinguish from the very beginning between @xmath22 and @xmath23 ( or @xmath24 and @xmath25 ) .",
    "in fact our theory can be applied to the case of an electron beam in vacuum as well as to the case of a beam under the action of external electromagnetic fields , for example in an undulator : in the first situation @xmath26 , strictly , while in the latter they obviously have different values .",
    "the full derivative of @xmath13 is simply given by @xmath27 where @xmath28 is the space - charge field in the @xmath11 direction .",
    "( [ psieq2 ] ) and eq .",
    "( [ peq ] ) are the equation of motion for our system and they can be interpreted as hamilton canonical equations corresponding to the hamiltonian @xmath29 :    @xmath30    in this sense , eq .",
    "( [ hfin ] ) , alone , defines our theory . the bunch density distribution will be then represented by the density @xmath31 , where the semicolon separates dynamical variables from parameters and it will be subjected to the ( vlasov ) evolution equation    @xmath32    with appropriate initial condition at @xmath33 . here",
    "we are interested in a beam initially modulated in energy and density ; moreover , as said in section [ sec : intro ] , the modulation must be small enough to ensure that linearization of eq .",
    "( [ vla ] ) is possible .",
    "thus we will take @xmath34 .",
    "@xmath35 is a so called unperturbed solution of the evolution equation eq .",
    "( [ vla ] ) , and it does not depend on @xmath11 , while @xmath36 is known as the perturbation ; it is understood that , in order to be in the linear regime , @xmath37 for any value of dynamical variables or parameters . in the following we assume that the dynamical variable @xmath13 and the parameter @xmath38 are separable in @xmath35 so that we may write @xmath39 , where the local energy spread function @xmath40 is considered normalized to unity . the initial modulation can be written as a sum of density and energy modulation terms : @xmath41 .",
    "on the one hand @xmath42 is responsible for a pure density modulation and can be written as    @xmath43    where we set to zero an unessential , initial modulation phase .    on",
    "the other @xmath44 is responsible for a pure energy modulation and can be assumed to be    @xmath45    where @xmath46 is an initial ( relative ) phase between density and energy modulation .",
    "finally it is convenient to define complex quantities @xmath47 , and @xmath48 so that @xmath49 . in the linear regime , then , one can write @xmath50 . further definition of @xmath51 in such a way that @xmath52 allows one to write down the vlasov equation , eq .",
    "( [ vla ] ) , linearized in @xmath53 :    @xmath54    eq .",
    "( [ vlalin ] ) is far from being the final form of the evolution equation , since we still have to couple it with maxwell equations , which constitute the electrodynamical part of the problem .",
    "however an integral representation of @xmath53 can be given at this stage :    @xmath55    let us now introduce the longitudinal current density @xmath56 , where @xmath57 and @xmath58 .",
    "( [ integrapr ] ) can be integrated in @xmath13 thus giving    @xmath59~. \\label{integrapr2}\\end{aligned}\\ ] ]    the next step is to present the equation for the electric field @xmath60 which , coupled with eq .",
    "( [ integrapr2 ] ) , will describe the system evolution in a self - consistent way .",
    "we start with the inhomogeneous maxwell equation for the z - component of the electric field    @xmath61    where @xmath62 is the electron charge density . remembering the definition of complex quantities @xmath60 and @xmath63 and accounting for the fact that @xmath64 one can rewrite eq .",
    "( [ max1 ] ) as    @xmath65    where @xmath66 is the laplacian operator over transverse coordinates .",
    "explicit calculations of partial derivatives with respect to @xmath10 and @xmath11 give    @xmath67    @xmath68    @xmath69    @xmath70    substitution back into eq .",
    "( [ max2 ] ) yields ( @xmath71 ) :",
    "@xmath72    it is reasonable to assume that the envelope of fields and currents vary slowly enough over the @xmath11 coordinate , in order to neglect first and second derivatives with respect to @xmath11 in eq .",
    "( [ max3a ] ) .",
    "mathematically , this corresponds to the requirements    @xmath73    @xmath74    and @xmath75 where we introduced the wave number @xmath76 .",
    "we note that @xmath77 is , roughly , the field formation length : by imposing conditions ( [ assumpsempl ] ) , ( [ assumpsempl2 ] ) and ( [ assumpsempl3 ] ) we are requiring that the characteristic lengths of variation for current , field and its derivative are much longer than the field formation length ( actually condition ( [ assumpsempl2 ] ) over the variation of the field derivative already included in condition ( [ assumpsempl ] ) , since @xmath78 ) : this simply means that we can neglect retardation effects or , in other words , that the fields are known at a certain time , when the charge distribution are known at the same time .",
    "this assumption is not a restriction and it is verified in all cases of practical interest",
    ". then eq .",
    "( [ max3a ] ) is simplified to    @xmath79    which forms , together with eq .",
    "( [ integrapr2 ] ) , a self - consistent description for our system .",
    "similarity techniques can be now used in order to obtain a dimensionless version of eq .",
    "( [ integrapr2 ] ) and eq .",
    "( [ max3 ] ) .",
    "first note that the dependence of @xmath80 on the transverse coordinates can be expressed , in all generality , as    @xmath81^{-1}~ , \\label{j0radial}\\ ] ]    where @xmath82 is the beam current , @xmath83 the transverse profile parameter ( i.e. the typical transverse size of the beam ) , @xmath84 the transverse profile function of the beam and the integral in @xmath85 is calculated over all the transverse plane .",
    "furthermore it is understood that the normalization of @xmath84 is chosen is such a way that @xmath86 .",
    "it is then customary to introduce the current density parameter @xmath87^{-1}$ ] so that we can define quite naturally the dimensionless current densities @xmath88 and @xmath89 .",
    "it follows from eq .",
    "( [ max3 ] ) that the electric field should be normalized to @xmath90 , which suggests the definition @xmath91 . for the normalization of the transverse",
    "coordinates we use @xmath92 so that one is naturally guided by eq .",
    "( [ max3 ] ) to introduce the transverse size parameter    @xmath93    eq .",
    "( [ max3 ] ) can now be written in its final dimensionless form :    @xmath94    where @xmath95 is the laplacian operator with respect to normalized transverse coordinates .    by analyzing eq .",
    "( [ integrapr2 ] ) and using the normalized quantities defined above we recover a dimensionless variable @xmath96 , where @xmath97 is given by    @xmath98^{1/2 } \\label{lmbdapar } ~,\\ ] ]    @xmath99 being the alfven current .    using eq .",
    "( [ lmbdapar ] ) and looking now at the exponential factors in eq .",
    "( [ integrapr2 ] ) it is straightforward to introduce the dimensionless energy deviation @xmath100 , @xmath101 being defined by    @xmath102    from the definition of @xmath103 it follows immediately that the factor @xmath104 is a natural measure for energy deviations .",
    "the rms energy spread @xmath105 can be measured by the dimensionless parameter    @xmath106    the local energy spread distribution @xmath40 was defined as normalized to unity , so that it is customary to introduce @xmath107 as the distribution function in the reduced momentum @xmath103 also normalized to unity .",
    "for example , when the energy spread is a gaussian we have @xmath108 . when @xmath109 our beam can be considered cold meaning that @xmath110",
    ". however note that , in order to specify quantitatively the range of validity of the cold beam assumption with respect to the values of @xmath111 , one should first solve the more generic evolution problem for a non - cold beam and then study the limit for small values of @xmath111 .    now eq .",
    "( [ integrapr2 ] ) can be expressed in the final , dimensionless form :    @xmath112~ , \\label{integrapr3}\\end{aligned}\\ ] ]    where @xmath113 and @xmath114 .",
    "one can combine eq .",
    "( [ integrapr3 ] ) and eq .",
    "( [ max4 ] ) in order to obtain a single integrodifferential equation for @xmath115 or , alternatively , an integral equation for @xmath116 .    as regards the description of the evolution in terms of @xmath115 , direct substitution of eq .",
    "( [ integrapr3 ] ) in eq .",
    "( [ max4 ] ) yields immediately    @xmath117~.&&\\cr \\label{integrodiff}\\end{aligned}\\ ] ]    on the other hand , the description of our system in terms of @xmath116 can be obtained first by solving eq .",
    "( [ max4 ] ) and then substituting the solution in eq .",
    "( [ integrapr2 ] ) . for the solution of eq .",
    "( [ max4 ] ) we can use the following result ( see for example @xcite ) :    @xmath118    where @xmath119 indicates the modified bessel function of the second kind .",
    "then , substitution in eq .",
    "( [ integrapr3 ] ) yields    @xmath120~. \\label{integralcurr}\\end{aligned}\\ ] ]    note that the description of the system in terms of fields or currents is completely equivalent . using one or the other is only a matter of convenience",
    "; it will turn out in the following sections that the description in terms of the fields is particularly suitable for analytical manipulations , while the description in terms of currents is advisable in case of a numerical approach .",
    "it is interesting to explore the asymptote of eq .",
    "( [ integrodiff ] ) for @xmath121 . in this case one obtains the following simplified equation for the field evolution :    @xmath122~. \\label{integro}\\end{aligned}\\ ] ]    in the case of a cold beam @xmath123 and eq .",
    "( [ integro ] ) transforms to    @xmath124    finally , after double differentiation with respect to @xmath125 we get back the well - known pendulum equation for one - dimensional systems :    @xmath126    in this approximation , and in the particular case @xmath127 , we recover the one - dimensional plasma wave number @xmath128 , which agrees with the normalization @xmath129 .",
    "it should be noted that such a normalization is natural in the limit @xmath130 but it progressively loses its physical meaning as @xmath131 becomes smaller and smaller : of course , using our dimensionless equations for @xmath132 will still yield correct results , because the equations are correct , but the normalization fits no more the physical feature of the system , in that case .",
    "( [ integro ] ) , which describes the system evolution in the limit @xmath121 , corresponds to the the one - dimensional case .",
    "we can use eq .",
    "( [ integro ] ) and impose @xmath133 thus getting the electromagnetic field at the beginning of the evolution , i.e. the solution of the electromagnetic problem in the limit @xmath121 :    @xmath134    this can be easily written in dimensional form as    @xmath135    where @xmath136 .",
    "we can check eq .",
    "( [ soledim ] ) with already known results in scientific literature .",
    "in fact , the field generated by an electron beam modulated in density in free space can be easily calculated in the system rest frame ( see e.g. @xcite and @xcite ) . in the limit of a pancake beam ( i.e. for large transverse dimension ) the following impedance per unit length of drift has been found :    @xmath137    the first factor on the right hand side of eq .",
    "( [ soledim ] ) , which is the impedance per unit drift according to our calculations , is exactly the result in eq .",
    "( [ imp ] ) which proves that our starting equation eq .",
    "( [ integrodiff ] ) can be used to solve correctly the electromagnetic problem in the case @xmath138 , as it must be .",
    "finally , before proceeding , it is worth to estimate the value of our parameters for some practical example and to see how our assumptions compare with an interesting case .",
    "nowadays photo - injected linacs , to be used as linear colliders or fel injectors constitute cutting edge technology as regards electron particle accelerators .",
    "currents of about @xmath139a with energy such that @xmath140 can be achieved together with quite a small energy spread @xmath141ev , radial dimensions of order @xmath142 m and a normalized emittance @xmath143 mm mrad . in these conditions , a typical modulation wavelength of about @xmath144 m will lead to a value of @xmath145 , which is well outside the region of applicability of the one - dimensional theory so that a generalized theory like the ours must be used .",
    "it is interesting to note that , by means of the definitions of @xmath131 and @xmath128 , we can write @xmath146^{1/2 } q^{-1}$ ] : this suggests that a natural measure for the current is indeed @xmath147 which is , in practice , the alfven - lawson current ( see @xcite , @xcite , @xcite ) . in our numerical example @xmath145 and the value of @xmath101",
    "is actually determined by the ratio @xmath148 . as a result @xmath149",
    ": this means that our simplified maxwell equation , eq .",
    "( [ max3 ] ) , is valid up to an accuracy of @xmath150 .",
    "moreover , in this case , @xmath151 so that the cold beam case turns out to be of great practical interest . finally @xmath143 mm mrad .",
    "this corresponds , for @xmath140 , to a betatron function @xmath152 m. our choice of considering the longitudinal motion alone is satisfied when the period of a plasma oscillation is much shorter than the period of a betatron oscillation , that is when @xmath153 .",
    "it should be noted , though , that this estimation can not have a rigorous mathematical background before a more comprehensive theory , including the effects of transverse dynamics , is developed : only then our present theory can be reduced to an asymptote of a more general situation , and conditions for its applicability can be derived in a rigorous way .",
    "keeping this fact in mind , in our example @xmath154m@xmath155 which means @xmath156 signifying that this particular case is at the boundary of the region of applicability of our theory .",
    "( [ integrodiff ] ) with appropriate initial conditions for @xmath157 it is possible to find an analytical solution to the evolution problem .",
    "the method is similar to the one used for the solution of the self - consistent problem in fel theory ( see @xcite ) and relies on the introduction of the laplace transform of @xmath115 , namely :    @xmath158    with @xmath159 .",
    "the advantage of the laplace transform technique is that the evolution equation is transformed from the integrodifferential equation eq .",
    "( [ integrodiff ] ) into the following ordinary differential equation :    @xmath160\\bar{e}= i q^2 \\left ( \\hat{d}_0 \\hat{a}_{1d } + \\hat{d}\\hat{a}_{1e } \\right)~ , \\label{diff1}\\ ] ]    where @xmath161 and @xmath162 with the boundary conditions @xmath163 for @xmath164 and @xmath165 for @xmath166 .",
    "we can rewrite eq .",
    "( [ diff1 ] ) as    @xmath167    having introduced    @xmath168    @xmath169    and    @xmath170    note that only eq .",
    "( [ integrodiff ] ) can benefit from the use of the laplace transform but not the integral equation eq .",
    "( [ integralcurr ] ) .",
    "( [ diff2 ] ) is a nonhomogeneous , linear , second - order differential equation .",
    "we are interested in solving eq .",
    "( [ diff2 ] ) for any given @xmath171 such that @xmath172 .",
    "solution is found if we can find the inverse of the operator @xmath173 , namely a green function @xmath174 obeying the given boundary conditions ; in this case we simply have    @xmath175      depending on the choice of @xmath176 , i.e. on the choice of @xmath84 , @xmath177 and @xmath171 , the differential operator @xmath173 can change its character completely making @xmath173 more or less difficult to deal with .",
    "for example , the case of a self - adjoint operator is obviously a simple situation , since its eigenvalues are real and its eigenfunctions form a complete and orthonormal set for the space of squared - integrable functions @xmath178 ( defined over the entire transverse plane through @xmath179 ) with respect to the internal product :    @xmath180    then , such a orthonormal set can be used to provide , quite naturally , an expansion for @xmath174 .",
    "however , in the most general situation , @xmath173 is not self - adjoint : to see this , it is sufficient to note that @xmath176 is not real . as a result , the eigenvalues of @xmath173 are not real , its eigenfunctions are not orthogonal with respect to the internal product in eq .",
    "( [ inn ] ) , we do not know wether the spectrum of @xmath173 is discrete , completeness is not granted and we can not prove the existence of a set of eigenfunctions either .    to the best of our knowledge",
    "there is no theoretical mean to really deal with our problem in full generality .",
    "when not self - adjoint operators are encountered in different branches of physics ( see , for example , @xcite and @xcite ) mathematical rigorousness is somehow relaxed assuming , rather than proving , certain properties of the operator .",
    "we will do the same here assuming , to begin , the existence of eigenfunction sets ; then , as for example has been remarked in @xcite and @xcite one can consider , together with the spectrum of @xmath173 defined by the eigenvalue problem :    @xmath181    also the spectrum of its adjoint , defined by @xmath182^ { * } { \\psi}_{j}^{*}~. \\label{spec2}\\ ] ] it can be shown by using the bi - orthogonality theorem @xcite that    @xmath183    in other words the sequence @xmath184 admits @xmath185 as a bi - orthonormal sequence .",
    "then one has to _ assume _ completeness and discreteness of the spectrum so that the following expansion is correct :    @xmath186    we ascribe to alternative theoretical approaches and numerical techniques the assessment of the validity region of this assumption , which should be ultimately formulated in terms of a restriction on the possible choices of @xmath84 and @xmath177 . in other words",
    "we give here a general method for solving our problem which is valid only under the fulfillment of certain assumptions , but we make clear that it is not possible , to the best of our knowledge , to strictly formulate the applicability region of this method in terms of properties of @xmath84 and @xmath177 as it would be desirable .    with this in mind one can use the fact that @xmath187 and write    @xmath188    finally , substituting eq .",
    "( [ expgf ] ) in eq .",
    "( [ green1 ] ) one gets    @xmath189    to find @xmath115 we use the inverse laplace transformation that is the fourier - mellin integral :    @xmath190    where the integration path in the complex @xmath171-plane is parallel to the imaginary axis and the real constant @xmath191 is positive and larger than all the real parts of the singularities of @xmath192 .",
    "the application of the fourier - mellin formula comes with another , separate mathematical problem related with the ability of performing the integral in eq .",
    "( [ invlapl ] ) .",
    "one method to calculate the integral is to use numerical techniques and integrate directly over the path defined , on the complex @xmath171-plane , by @xmath193 .    yet",
    ", there is some room for application of analytical techniques left .",
    "in fact , under the hypothesis that @xmath192 is also defined , except for isolated singularities , as an analytical function on the _ left _ half complex @xmath171-plane _ and _ on the imaginary axis and under the hypotesis that @xmath194 uniformly faster than @xmath195 for a chosen @xmath196 and for @xmath197 within @xmath198 $ ] one could use jordan lemma and close the integration contour of eq .",
    "( [ invlapl ] ) by a semicircle at infinity on the left half complex @xmath171-plane .",
    "an obvious ( and well - known ) problem is that @xmath192 is defined only for @xmath159 according to eq .",
    "( [ lapl ] ) . yet , _ if _ the border points at @xmath199 are regular points of @xmath192 ( except for isolated singularities ) then one can consider the ( unique ) analytical continuation of @xmath192 along the border , from the original domain of analyticity ( i.e. the points @xmath171 with @xmath159 except for isolated singularities ) to the entire complex plane ( again , isolated singularity excluded ) .",
    "then one can still apply jordan lemma on the analytic continuation of @xmath192 ( provided that it obeys the other assumption ) , because the final result is the integral in eq .",
    "( [ invlapl ] ) which is uniquely defined by the original function @xmath192 for @xmath159 .",
    "the problem is trivially solved for the case of a cold beam because @xmath200 so that @xmath201 and @xmath202 .",
    "( [ greenf ] ) defines indeed an analytic function in all points of the complex plane with the exception of @xmath203 and the points such that @xmath204 .",
    "all the hypothesis of jordan lemma are verified and the method can be applied without any problem .",
    "the situation is completely different in the case of a generic energy spread function @xmath177 .",
    "in fact by inspection of eq .",
    "( [ d0 ] ) and eq .",
    "( [ d0d ] ) one is immediately confronted with the fact that the integrands in @xmath205 and @xmath206 are , usually , singular at all the points of the imaginary axis @xmath199 since the integration in @xmath103 is taken from @xmath207 to @xmath208 . as a result",
    "the points @xmath199 are not regular points of @xmath192 and @xmath192 can not be analytically continued through the border @xmath199 .",
    "this problem is the same encountered in the treatment of landau damping ( see @xcite ) .",
    "of course one may follow the solution proposed by landau and present particular _",
    "definitions _ of @xmath205 and @xmath206 at @xmath199 that are    @xmath209    and @xmath210 so that @xmath211 and @xmath212 are now regular for @xmath199 and can be ( uniquely ) continued at @xmath213 by    @xmath214    and @xmath215 in this way the definition of @xmath192 could be extended , except for isolated singularities , to an analytical function on the entire complex @xmath171-plane and , if @xmath107 behaves relatively well , jordan lemma can be applied without further problems .",
    "yet , we think that the application of landau s prescription , i.e. the definition in eq .",
    "( [ d0zero ] ) and eq .",
    "( [ d0dzero ] ) should be taken with extreme caution .",
    "as it is reviewed by klimontovich @xcite and references therein , landau s method is equivalent to the introduction of additional assumptions on the system , namely the adiabatic switching on of the space - charge field at @xmath216 .",
    "another method equivalent to landau s consists , as has been remarked long ago by lifshitz @xcite , in the introduction of a small dissipative term into the linearized vlasov equation which ceases to be _",
    "non_-dissipative from the very beginning .",
    "the vlasov equation is then solved by fourier technique and the limit for a vanishing dissipating term is taken in the final result , which leads , in the end , to landau s result . yet , the limit for a vanishing dissipation must be taken in the final formulas in order to recover landau s coefficient _ and not before_. this means that landau s method consists in the introduction of additional assumptions regarding the system under study or equivalently , in changing the very nature of the equations describing our system ( from non - dissipative to dissipative ) : therefore in practical calculations , we prefer to deal only with the case of a cold beam where the original non - dissipative nature of the system is maintained without problems , leaving the other case to future study .",
    "such a viewpoint constitutes a restriction but as we have seen in the previous section the cold beam case is practically quite an important issue : in this section , we will present our results in full generality without fixing @xmath177 but keeping in mind , however , all the warnings discussed before .    in any case and again , in all generality , we can say that wether or not the conditions of jordan lemma are satisfied depends on the distribution @xmath107 . in the case",
    "jordan lemma is applicable one can find a closed , analytic expression for @xmath115 :    @xmath217^{-1 } & & \\cr \\times \\int_0^{\\infty } d{\\bf{\\hat{r}'_\\bot}}\\phi_{n}(\\bf{\\hat{r}'_\\bot } ) f({\\bf{\\hat{r}'_\\bot}},\\lambda_j)~ , \\label{final1}\\end{aligned}\\ ] ]    where @xmath218 and @xmath219 are solutions of the equations :    @xmath220    or , which is the same , solution of eq .",
    "( [ spec1 ] ) as @xmath221 : from this viewpoint the functions @xmath222 constitute the kernel of the operator @xmath173 and @xmath219 are the values of @xmath171 such that @xmath173 admits a non - empty kernel .",
    "it is interesting to note that @xmath223 is a subset of @xmath224 naturally suited to expand any function of physical interest ( the field @xmath115 ) . in this sense",
    ", one may say that the fields are subjected to constraints given by maxwell equations , which are codified through the operator @xmath173 ; these constraints are implicitly used during the anti - laplace transform process , thus selecting only those @xmath224 of physical interest . in this spirit , although @xmath171 is mathematically allowed to span over all the complex plane with @xmath159 , only the particular values for which @xmath225 have physical meaning in the final result .",
    "an explicit expression for @xmath226 can be found .",
    "( [ orto ] ) and eq .",
    "( [ spec1 ] ) we can write    @xmath227    then , differentiating eq .",
    "( [ lambda ] ) we have    @xmath228    our final result is therefore written as follows :    @xmath229    where the coupling factor @xmath230 is given by    @xmath231_{p=\\lambda_j } } } ~.\\label{coupl}\\ ] ]    eq .",
    "( [ finalend ] ) describes the evolution of the system under the action of self - fields in a generic way , for any bunch transverse shape @xmath84 , for any choice of local energy spread @xmath103 and any initial condition ( under the assumptions mentioned before ) .",
    "our solution is indeed an analysis in ( self - reproducing ) propagating eigenmodes of the electric field .",
    "we have seen that , due to the fact that @xmath173 is in general not self - adjoint , the modes @xmath232 are not orthogonal in the sense of eq .",
    "( [ inn ] ) nor , as a consequence , @xmath233 are . moreover ,",
    "even if @xmath232 were orthogonal , @xmath233 are chosen among the @xmath232 at different values of @xmath171 so that orthogonality of @xmath233 with respect to eq .",
    "( [ inn ] ) is also not granted .",
    "it is possible , however , to formulate appropriate initial conditions to obtain a single propagating mode as a solution of our self - consistent problem .",
    "this demonstrates that single modes have physical meaning besides being mathematical tools for function decompositions .",
    "suppose , for example , that we wish to excite a single mode at _ fixed _ values of @xmath234 .",
    "on the one hand eq .",
    "( [ finalend ] ) is simplified to    @xmath235    and , differentiating with respect to @xmath11 , one also obtains    @xmath236    on the other hand , the evolution equation , eq .",
    "( [ integrodiff ] ) at @xmath133 reads :    @xmath237    where we introduced    @xmath238    the same eq .",
    "( [ integrodiff ] ) differentiated with respect to @xmath125 and evaluated at @xmath133 gives    @xmath239    which may be rewritten using eq .",
    "( [ diffsimplend ] ) as :    @xmath240    finally , if @xmath241 , comparison of eq .",
    "( [ evdz1 ] ) and eq .",
    "( [ evz0 ] ) gives :    @xmath242    since for plasma oscillations @xmath243 has to be imaginary , eq .",
    "( [ constr ] ) fixes the phase @xmath244 ( with @xmath245 integer number ) .",
    "the actual shape of @xmath246 ( and @xmath247 ) is obtained , modulus a multiplicative constant , by substitution of eq .",
    "( [ simplend ] ) , calculated at @xmath133 , in eq .",
    "( [ evz0 ] ) and it is fixed by the following condition :    @xmath248    we will now present some remarkable example of how to apply eq . ( [ finalend ] ) and explore , in particular cases , the applicability region of our method .    we will start our exploration discussing the situation of an axis - symmetric beam which is still quite a generic one .",
    "given the symmetry of the problem we will make use , from now on , of a cylindrical ( normalized ) coordinate system @xmath249 , with obvious meaning of symbols .",
    "since @xmath250 , @xmath251 and @xmath252 , it is convenient to decompose them in azimuthal harmonics according to    @xmath253    @xmath254    and @xmath255 moreover , in cylindrical coordinates we have    @xmath256 + { 1\\over{r^2}}{\\partial^2\\over{\\partial \\phi^2}}~. \\label{nablacyl}\\ ] ]    these definitions allow us to write our equations and results for the @xmath257-th azimuthal harmonic of the electric field .",
    "in this situation the operators @xmath173 and @xmath258 can be written as    @xmath259    where , now , @xmath260 in the definition of @xmath176 and    @xmath261    so that    @xmath262    having specialized our results to the axis - symmetric case it is worth to spend some words on the nature of the operator @xmath173 in one particular case . as we have said at the beginning of this section ,",
    "the case of a self - adjoint operator is a particularly blessed one .",
    "it is interesting to note that in the axis - symmetric case , when @xmath84 , @xmath177 and @xmath171 are such that @xmath176 is real , we deal with a singular sturm - liouville problem as it is shown immediately by multiplying side by side by @xmath263 eq .",
    "( [ diff2sym ] ) .",
    "in fact , in this case @xmath173 can be written in the usual form presented in sturm - liouville theory :    @xmath264 - { n^2\\over{\\hat{r } } } + \\hat{r}\\hat{g}(\\hat{r},p)~. \\label{operausua}\\ ] ]    in this case given the internal ( axisisymmetric ) product in @xmath178 :    @xmath265    self - adjointness condition for @xmath173 is satisfied in the interval @xmath266 by all the functions in the linear space @xmath267 which we define as the space of integrable - square functions not singular with their first derivatives at @xmath268 and such that , for any @xmath269 chosen in @xmath267 the following condition is satisfied :    @xmath270=0~. \\label{conadj}\\ ] ]    note that @xmath267 is a subset of @xmath178 .",
    "this is of course a very particular situation , interesting to discuss but unfortunately not very useful in practise , since in order to solve our problem we still have to _ assume _ that eq .",
    "( [ expg1 ] ) is correct for a generic @xmath171 .",
    "when this assumption is made , in the axis - symmetric case our results eq .",
    "( [ finalend ] ) and eq .",
    "( [ coupl ] ) take the form    @xmath271    where    @xmath272_{p=\\lambda^{(n)}_j } } } ~.\\label{couplsym}\\ ] ]    within this special situation we will now treat in detail the case of a stepped or parabolic transverse profile . further on",
    "we will see how the solution for the stepped transverse profile can be used to obtain a semi - analytic solution for any transverse profile .",
    "consider the case of a step function @xmath127 for @xmath273 and @xmath274 for @xmath275 . in this case @xmath276 inside the operator @xmath173 is simply given by    @xmath277    let us restrict to the assumption of a cold beam with @xmath278 .",
    "then @xmath279 .",
    "first we look for the solutions of eq .",
    "( [ spec1 ] ) with the boundary condition that @xmath280 and their first derivatives vanish at infinity .",
    "the search for the eigenfunctions can be broken down into an internal ( @xmath273 ) and an external ( @xmath281 ) problem , with the conditions of continuity for @xmath280 and its derivative across the boundary , since the final result , the electric field , is endowed with these properties too .",
    "we recognize immediately that the internal and the external problems are , respectively , the complex bessel and modified bessel equations with appropriate boundary conditions .",
    "keeping in mind the physical nature of our problem , we impose that @xmath280 must be regular functions of @xmath263 over @xmath266 .",
    "then , without loss of generality , we can exclude bessel functions @xmath282 and @xmath283 from entering our expression for @xmath280 .    since for the field calculations we are interested in finding the eigenfunctions @xmath284 we can impose @xmath285 , thus obtaining    @xmath286    where @xmath287 and @xmath288 are roots of @xmath289 , to be still determined at this stage . imposing continuity of @xmath280 and",
    "its derivative at @xmath290 one finds    @xmath291    which leaves the choice of an unessential multiplicative constant , and    @xmath292    eq .",
    "( [ conpsi2 ] ) can be rewritten with the help of recurrence relations for bessel functions in the following form :    @xmath293    eq .",
    "( [ conpsi2bis ] ) is our eigenvalue equation , defining the values of @xmath294 or , equivalently , of @xmath295 .",
    "since @xmath131 is real and positive one must have that @xmath296 is real and positive .",
    "then , it can be shown that @xmath294 must be real . as a result @xmath288 are imaginary and such that @xmath297 .",
    "for any given eigenvalue @xmath288 , also @xmath298 is solution of eq .",
    "( [ conpsi2bis ] ) corresponding to fast and slow plasma waves : from now on we will consider , for simplicity of notation , only the branch @xmath299 .",
    "note that from a physical viewpoint , the condition that @xmath288 is imaginary means that we are in the absence of damped or amplified oscillations . on the other hand ,",
    "the fact that @xmath300 means that plasma oscillations have a minimum wavelength given by @xmath301 .",
    "it is interesting to plot the behavior of @xmath302 , parameterized for several values of @xmath257 and @xmath234 as a function of @xmath131 .",
    "[ eig0 ] , fig .",
    "[ eig1 ] and fig .",
    "[ eig2 ] show the behavior , as a function of @xmath131 , of the first five eigenvalues for the first three azimuthal harmonics .",
    "it should be noted that @xmath302 increases with @xmath131 and therefore with @xmath83 , but @xmath128 scales as @xmath303 ; as a result , the period of the self - reproducing solution identified by fixed values of @xmath257 and @xmath234 , that is @xmath304 , will increase as @xmath83 is increased .",
    "as it can be seen by inspection all the imaginary parts of the eigenvalues converge to @xmath305 as @xmath138 ; this can also be derived directly from eq .",
    "( [ conpsi2bis ] ) . as @xmath138",
    "we have @xmath306 , so that eq .",
    "( [ conpsi2bis ] ) gives simply @xmath307 ; this is possible only when @xmath308 , where @xmath309 is the @xmath234-th root of @xmath310 .",
    "then , in this limit , @xmath311 and @xmath312 since @xmath313 .",
    "note that convergence to unity tends to get slower as @xmath257 and @xmath234 increase . on the other hand ,",
    "when @xmath131 becomes smaller and smaller the plasma wavelength associated with each mode starts to differ significantly from @xmath128 and , as noted before , we should use an effective @xmath314 in place of @xmath128 in our dimensionless quantities in order for these to retain their physical insight .",
    "the asymptotic behavior of @xmath315 for @xmath316 can be derived directly from eq .",
    "( [ conpsi2bis ] ) too .",
    "we consider first the case @xmath317 . in the limit @xmath316 we have @xmath318 , where @xmath319 is the euler gamma constant .",
    "we remember that @xmath320 for @xmath321 and that @xmath322 . neglecting @xmath323",
    "we easily find @xmath324 .",
    "this result is only valid for @xmath325 which corresponds , once plotted in fig .",
    "[ eig0 ] , to the solution for @xmath326 only .",
    "the case @xmath327 is solved using the fact that @xmath328 : then the eigenvalue equation is solved only when @xmath329 which means @xmath330 for @xmath331 .    for @xmath332 instead , when @xmath316 we have @xmath333 .",
    "then , since @xmath334 , we find @xmath335 and , therefore , @xmath336 . these asymptotic limits are compared with the actual solutions of the eigenvalue equation in fig .",
    "[ eig0 ] , fig .",
    "[ eig1 ] and fig .",
    "[ eig2 ] .    note that in the region @xmath316 , if the alternative normalization using @xmath314 is selected , @xmath101 shows only a weak logarithmic dependence on the transverse beam size @xmath131 in the case @xmath317 , @xmath326 and no dependence on @xmath131 in the other cases .",
    "looking at the slopes in the figures we can conclude that , with the use of @xmath314 in place of @xmath128 , @xmath101 is , for realistic choices of @xmath337 , much smaller than unity .",
    "the same applies when @xmath138 : in this case @xmath338 and @xmath101 will also be small with respect to unity . as a result @xmath101 , defined using @xmath314 , can be considered much smaller than unity in a wide range of parameters which justifies , at least in this particular situation , the assumptions used in the derivation of eq .",
    "( [ max3 ] ) .",
    "the first five ( imaginary ) eigenvalues @xmath295 in units of @xmath339 as a function of @xmath131 for @xmath317 . ,",
    "width=340 ]     the first five ( imaginary ) eigenvalues @xmath295 in units of @xmath339 as a function of @xmath131 for @xmath340 .",
    ", width=340 ]     the first five ( imaginary ) eigenvalues @xmath295 in units of @xmath339 as a function of @xmath131 for @xmath341 . ,",
    "width=340 ]    we can now write our final solution in the following form :    @xmath342    and the coupling factors @xmath343 are given by :    @xmath344_{p=\\lambda_j^{(n)}}}}~ , \\label{ujstep}\\ ] ]    where @xmath345 .",
    "at this point we should show that the expansion eq .",
    "( [ expg1 ] ) is correct , so that the method used up to now can be rightfully applied .",
    "yet we can not do this .",
    "we assume this fact , instead , and we prove that this assumption is right both using numerical techniques in section [ sub : test ] and with the help of an alternative analytical technique here : in fact , interestingly enough , one can solve eq .",
    "( [ diff1 ] ) also by finding directly a green function without any particular expansion simply imposing that the green function obeys @xmath346 for all @xmath263 except @xmath347 , where it must be continuous and such that its derivative is discontinuous ( the difference of the left and right limit must equal @xmath348 )",
    ". moreover it must be finite at @xmath268 .",
    "we do not work out details , which can be found in @xcite , but we underline the fact that the anti - laplace transform of @xmath349 calculated with this method coincides with our previous result eq .",
    "( [ stepfinal ] ) .",
    "note that in the case the green function is derived without the expansion in @xmath350 the final solution for @xmath115 is automatically valid , but still subjected to the assumptions on the validity of jordan lemma ; without the introduction of other assumptions on the system under study we can safely say that our result holds for the case of a cold beam only .",
    "a parabolic transverse profile corresponds to the case @xmath351 .",
    "this is one of the few profiles for which the evolution problem can be solved analytically .",
    "the study of this situation offers , therefore , the possibility of crosschecking analytical and numerical results with or without the use of the semi - analytical method described in section [ subsub : mult ] .    in the parabolic case @xmath276 inside the operator @xmath173",
    "is given by    @xmath352    here we assume , strictly , @xmath353 .",
    "solution for the homogeneous problem defined by @xmath173 can be found in @xcite , since it is of relevance in fel theory as well .",
    "we can use that solution in order to solve our eigenvalue problem , and to write the expressions for the eigenfunctions @xmath350 to be inserted in eq .",
    "( [ finalend ] ) .",
    "let us introduce the following notations : @xmath354 , @xmath355 , @xmath356 , @xmath357 .",
    "after some calculation we find :    @xmath358    where@xmath359 is the confluent hypergeometric function , and the eigenvalue equation analogous of eq .",
    "( [ conpsi2bis ] ) is now    @xmath360 + d k_{n+1}(d ) ~_1f_1(\\epsilon , n+1 , \\delta ) = 0\\label{eigepara}\\end{aligned}\\ ] ]    once more we should show that the expansion eq .",
    "( [ expg1 ] ) is correct .",
    "we assume this fact , and we present a cross - check of our result eq .",
    "( [ parfinal ] ) using numerical techniques in section [ sub : test ] .",
    "an arbitrary gradient axisymmetric profile can be approximated by means of a given number of stepped profiles , or layers , superimposed one to the other .",
    "this means that results in section [ subsub : step ] can be used to construct an algorithm to deal with any profile ( see @xcite or @xcite for more details and a comparison with the same technique in fel physics ) .",
    "the normalized radius of the beam boundary is simply unity ; let us divide the region @xmath361 into @xmath362 layers , assuming that the beam current is constant within each layer . within each layer",
    "@xmath363 , according to eq .",
    "( [ integrodiff ] ) , the solution for the eigenfunction is of the form    @xmath364    where @xmath365 , @xmath366 and @xmath367 are constants , @xmath310 and @xmath368 are the bessel functions of first and second kind of order @xmath257 , and    @xmath369    here @xmath370 and @xmath371 . to avoid singularity of the eigenfunction at @xmath372",
    "we should let @xmath373 .",
    "then , the continuity conditions for the eigenfunctions and its derivative at the boundaries between the layers allow one to find all the other coefficients .",
    "the continuity conditions can be expressed in matrix form in the following way :    @xmath374    where the coefficients @xmath375 are given by @xmath376 :    @xmath377~ , & & \\cr ( t_k)_{12 } ~=~ ( \\pi/2)\\hat{r}_k\\left[\\mu_k n_{n+1}(\\mu_k\\hat{r}_k)n_n(\\mu_{k+1}\\hat{r}_k)\\right.&&\\cr\\left .",
    "-\\mu_{k+1}n_n(\\mu_k\\hat{r}_k)n_{n+1}(\\mu_{k+1}\\hat{r}_k)\\right]~ , & & \\cr ( t_k)_{21 } ~=-(\\pi/2)\\hat{r}_k\\left[\\mu_k j_{n+1}(\\mu_k\\hat{r}_k)j_n(\\mu_{k+1}\\hat{r}_k)\\right.&&\\cr\\left .",
    "-\\mu_{k+1}j_n(\\mu_k\\hat{r}_k)j_{n+1}(\\mu_{k+1}\\hat{r}_k)\\right]~ , & & \\cr ( t_k)_{22 } ~=-(\\pi/2)\\hat{r}_k\\left[\\mu_k n_{n+1}(\\mu_k\\hat{r}_k)j_n(\\mu_{k+1}\\hat{r}_k)\\right.&&\\cr\\left . -\\mu_{k+1}n_n(\\mu_k\\hat{r}_k)j_{n+1}(\\mu_{k+1}\\hat{r}_k)\\right]~. & & \\cr \\label{matrelem}\\end{aligned}\\ ] ]    eq .",
    "( [ integrodiff ] ) also dictates the form of the solution for the eigenfunction outside the beam @xmath275 , satisfying the condition of quadratic integrability :    @xmath378    then , continuity at the boundary , i.e. at @xmath379 gives the following relations :    @xmath380    and    @xmath381    the two relations above can be also written in matrix form as :    @xmath382    where the coefficient @xmath383 can be expressed in terms of the coefficient @xmath384 by multiple use of eq .",
    "( [ matrixco ] ) . since",
    "@xmath384 can be chosen arbitrarily , we may set @xmath385 to obtain the following matrix equation :    @xmath386    the matrix @xmath387 depends on the unknown quantity @xmath388 . the other unknown quantity in eq .",
    "( [ matmid ] ) , the coefficient @xmath383 , can be easily excluded , thus giving the eigenvalue equation :    @xmath389    which allows one to find the eigenvalue @xmath388 . then using eq .",
    "( [ matrixco ] ) and eq .",
    "( [ matbound ] ) it is possible to calculate the eigenfunction .",
    "the results in section [ sub : axis ] constitute one of the few existing solutions for the evolution problem of a system of particles and field . yet , to derive it , we had to rely on several assumptions , among which that of a small perturbation , in order to get linearized maxwell - vlasov equations .",
    "this is not too restrictive , since in practice one has often to deal with space - charge waves in the linear regime , but it would be interesting to provide a solution for the full problem . from this viewpoint , the only way to proceed is the development of some numerical code based on macroparticle approach capable to deal with the most generic problem . as a first , initial step towards this more ambitious goal we present here a numerical solution of the evolution equation in the case of an axis - symmetric beam , that we will cross - check with our main result , eq .",
    "( [ finalend ] ) . in order to build a numerical solution one may , in principle , use eq .",
    "( [ integrodiff ] ) , but it turns out more convenient to make use of eq .",
    "( [ integralcurr ] ) .",
    "@xmath390 as a function of @xmath125 and @xmath263 .",
    "here @xmath391 , @xmath317 and the first five eigenfunctions have been used .",
    "a stepped transverse profile has been used.,width=340 ]     @xmath390 as a function of @xmath125 and @xmath263 .",
    "here @xmath391 , @xmath317 and the first five eigenfunctions have been used .",
    "a parabolic transverse profile proportional to @xmath392 with @xmath393 has been used.,width=340 ]     @xmath390 as a function of @xmath125 and @xmath263 .",
    "here @xmath391 , @xmath317 and the first five eigenfunctions have been used .",
    "a gaussian transverse profile proportional to @xmath394 with @xmath395 has been used.,width=340 ]     comparison between analytical results ( solid line ) and numerical methods ( circles ) .",
    "@xmath390 is plotted as a function of @xmath263 for several values of @xmath125 .",
    "here @xmath391 , @xmath317 and the first five eigenfunctions have been used .",
    "a stepped transverse profile has been used.,width=340 ]     comparison between analytical results ( solid line ) , multilayer approximation with 15 layers ( dotted line ) and numerical methods ( circles ) .",
    "@xmath390 is plotted as a function of @xmath263 for several values of @xmath125 .",
    "here @xmath391 , @xmath317 and the first five eigenfunctions have been used .",
    "a parabolic transverse profile proportional to @xmath392 with @xmath393 has been used.,width=340 ]     comparison between multilayer approximation with 15 layers ( solid line ) and numerical methods ( circles ) .",
    "@xmath390 is plotted as a function of @xmath263 for several values of @xmath125 .",
    "here @xmath391 , @xmath317 and the first five eigenfunctions have been used . a gaussian transverse profile",
    "proportional to @xmath394 with @xmath395 has been used.,width=340 ]    eq .",
    "( [ integralcurr ] ) can be specialized to the axis - symmetric case by integration of eq .",
    "( [ ez1 ] ) over the azimuthal angle @xmath396 which leads to    @xmath397 ~,\\label{ez2b}\\ ] ]    where @xmath398 @xmath283 being the modified bessel functions of the first kind of order @xmath257 .",
    "the equation for the @xmath257-th azimuthal harmonic of the field can be written from eq .",
    "( [ ez2b ] ) as    @xmath399    therefore , under the assumption of a cold beam , eq .",
    "( [ integralcurr ] ) can be rewritten as    @xmath400~ , \\label{integrodiff2bibis}\\end{aligned}\\ ] ]    which can be easily transformed , by double differentiation with respect to @xmath125 into the integro - differential equation :    @xmath401    eq .",
    "( [ differj ] ) is of course to be considered together with proper initial conditions for @xmath116 and its z - derivative at @xmath33 .",
    "the interval @xmath402 can be then divided into an arbitrary number of parts so that eq .",
    "( [ differj ] ) is transformed in a system of the same number of 2nd order coupled differential equations .",
    "the possibility of transforming eq .",
    "( [ differj ] ) in a system of 2nd order coupled differential equations explains the choice of starting , in this case , with eq.([integralcurr ] ) instead of eq .",
    "( [ integrodiff ] ) : in this way our system can be solved straightforwardly by means of numerical techniques .",
    "to do so we used a @xmath403-order runge - kutta integration method , which gave us the solution of the evolution problem in terms of the beam current .",
    "then , using eq .",
    "( [ ez2n ] ) we could get back @xmath115 and we compared obtained results with eq .",
    "( [ finalend ] ) for different choices of transverse profiles .",
    "the real field @xmath404 should be recovered , for any particular situation , passing to the dimensional quantity @xmath60 and , then , remembering @xmath405 : yet , all relevant information is included in @xmath406 . to give first a general idea of the obtained result we present , in figs .",
    "[ step3d ] , [ para3d ] and [ gauss3d ] , @xmath406 as a function of @xmath125 and @xmath263 in the case of stepped , gaussian and parabolic profile respectively , with parameters choice specified in the figure captions . in all cases",
    "the initial conditions are proportional to the transverse distribution functions ( stepped , gaussian , parabolic ) , @xmath407 and @xmath317 .",
    "we consider only initial density modulation ( i.e. @xmath408 ) .",
    "note that , in order to be consistent with the perturbation theory approach we should really choose @xmath409 , since it is normalized to the bunch current density .",
    "however using , for example , @xmath410 with @xmath411 will simply multiply our results by an inessential factor @xmath101 so , for simplicity , we chose @xmath412 .",
    "note the oscillatory behavior in the @xmath125 direction .",
    "comparison with the runge - kutta integration program are shown in figs .",
    "[ cmps ] , [ cmpp ] and [ cmpg ] . in the parabolic case ,",
    "both pure analytical solution and solution with multilayer approximation method are present , while in the gaussian case only a solution with the multilayer method is possible , to be compared with the numerical runge - kutta result .",
    "this comparison shows that the assumption of the validity of eq .",
    "( [ expg1 ] ) is correct in the parabolic case , and validates it once more for the stepped profile situation .",
    "here we present some further exemplification of the obtained results .     the final result and the first five modes @xmath413 with @xmath414 at @xmath133 and for @xmath415 .",
    "the final result is the sum of the first fifty modes , here.,width=340 ]     the final result and the first five modes @xmath413 with @xmath414 at @xmath416 and for @xmath415 .",
    "the final result is the sum of the first fifty modes , here.,width=340 ]    in particular we are interested in investigating , in a few cases , what is the role of the initial condition in the final results , in order to develop some common sense regarding our analytical formulas .",
    "the main parameter in our system is the transverse beam extent @xmath131 .",
    "however , intuitively , one can set two limiting initial conditions : one in which only a small part of the transverse section of the beam is modulated and the other in which all of it is modulated . depending on the profile of the initial modulation",
    ", one can have excitation of many modes or only a few , while the conditions for excitation of a single mode have been discussed in section [ sub : axis ] .",
    "the transverse parameter @xmath131 will fix the eigenvalue problem and , therefore , the oscillation wavelength ( in the @xmath11 direction ) of the various modes .",
    "if @xmath131 is smaller than or comparable to unity we expect to have appreciable differences in the eigenvalues , which lead to a quick ( in @xmath125 ) change of the relative phases between different modes . as a result",
    "the initial shape of the fields will change pretty soon . on the other hand ,",
    "when @xmath131 is larger than unity , we will have all the eigenvalues converging to unity as in the one - dimensional case , which means that the relative phases between different modes will stay fixed for a much longer interval in @xmath417 and the initial shape of the fields will not change during the evolution .     the final result and the first five modes @xmath413 with @xmath414 at @xmath133 and for @xmath418 .",
    "the final result is the sum of the first fifty modes . here",
    "@xmath317 . , width=340 ]     the final result and the first five modes @xmath413 with @xmath419 at @xmath416 and for @xmath418 .",
    "the final result is the sum of the first fifty modes . here",
    "@xmath317.,width=340 ]    to exemplify this situation we set up several calculations using our analytical solutions to the initial value problem .",
    "in particular we considered two cases @xmath415 and @xmath418 , and a radial stepped profile .",
    "again , we consider only initial density modulation ( i.e. @xmath408 ) and we study two subcases : in the first we set @xmath413 with @xmath414 and in the second we put @xmath420 .",
    "as said before , in order to be consistent with the perturbation theory approach we should really choose @xmath409 , since it is normalized to the bunch current density but using , for example , @xmath410 with @xmath411 will simply multiply our results by an inessential factor @xmath101 so , for simplicity , we chose , again , @xmath412 .",
    "moreover we considered the azimuthal harmonic @xmath317 .",
    "figures [ q1pz0 ] and [ q1pz10 ] present the first five eigenfunctions ( with relative weights and phases ) and the sum of the first fifty ( i.e. the final result ) for @xmath421 with @xmath414 at @xmath133 and at @xmath416 and for @xmath415 .",
    "as one can see , the relative phases have changed and the shape of the total field , our final result , has also changed with @xmath125 .     the final result and the first five modes @xmath422 at @xmath133 and for @xmath415 .",
    "the final result is the sum of the first fifty modes . here",
    "@xmath317 . , width=340 ]     the final result and the first five modes @xmath422 at @xmath416 and for @xmath418 .",
    "the final result is the sum of the first fifty modes . here",
    "@xmath317 . , width=340 ]     the final result and the first five modes @xmath422 at @xmath133 and for @xmath418 .",
    "the final result is the sum of the first fifty modes . here",
    "@xmath317 . , width=340 ]     the final result and the first five modes @xmath422 at @xmath416 and for @xmath418 .",
    "the final result is the sum of the first fifty modes . here",
    "@xmath317 . , width=340 ]    on the contrary , figs .",
    "[ q100pz0 ] and [ q100pz10 ] present the first five eigenfunctions ( with relative weights and phases ) and the sum of the first fifty ( i.e. the final result ) for @xmath413 with @xmath414 at @xmath133 and at @xmath416 , and for @xmath418 . here",
    "the relative phases have almost not changed and the shape of the total field , our final result , is also remained unvaried ( of course one must account for the fact that the system is undergoing plasma oscillation , so the shape , and not the field magnitude , is what is important here ) .     the final result and the first five modes when the initial condition is set in order to excite the third mode alone .",
    "the final result is the sum of the first fifty modes . here",
    "@xmath317 . , width=340 ]     the final result and the first five modes when the initial condition is set in order to excite the third mode alone .",
    "the final result is the sum of the first fifty modes . here",
    "@xmath317 . , width=340 ]    for comparison , it is interesting to plot analogous figures for the second situation , that is @xmath420 . figs .",
    "[ q1fz0 ] and [ q1fz10 ] depict the situation for @xmath415 at @xmath133 and @xmath416 respectively .",
    "the way the phases behave is similar to what has been seen before , i.e. there is a rapid change in the relative phases between the modes , but now it is more difficult to see from the plots because , in contrast with the case of @xmath413 already the first mode is sufficient to fit the initial conditions relatively well so that the field shape is almost unchanged . in figs .",
    "[ q100fz0 ] and [ q100fz10 ] we plot , instead , the case @xmath418 always as @xmath133 and @xmath416 respectively , and with @xmath420 .",
    "here it is easy to see , once more , that the relative phases between different modes are almost unchanged .",
    "what is of interest in this latter set of four pictures is the way different modes are working together to satisfy initial conditions , in comparison with the way they mix in the case for @xmath413 : note , in particular , how the first mode is almost enough to satisfy the initial conditions ( figs .",
    "[ q1fz0 ] and [ q1fz10 ] ) , while in figs .",
    "[ q1pz0 ] and [ q1pz10 ] it is almost completely suppressed .",
    "this should not be a surprise , considering that we may actually select a single mode by fixing appropriate initial conditions as described in eq .",
    "( [ constr ] ) and eq .",
    "( [ condi ] ) .",
    "for instance , if we fix @xmath408 and we want to excite only the @xmath234th mode for a given value of the azimuthal harmonic @xmath257 in the case @xmath127 , then , according to eq .",
    "( [ condi ] ) and eq .",
    "( [ stepfinal ] ) we must set ( modulus a constant factor ) :    @xmath423    where @xmath294 is defined in eq .",
    "( [ conpsi2bis ] ) .",
    "for example if we choose @xmath317 and @xmath424 ( third mode ) for @xmath415 we obtain the results presented in fig .",
    "[ singlez0 ] at @xmath133 and in fig .",
    "[ singlez10 ] at @xmath416 .",
    "as it can be seen by inspection only the third mode is excited and evolves",
    ". our condition eq .",
    "( [ inicondfirst ] ) set strictly to zero the contributions of all the modes with @xmath425 .",
    "of course , in practice , actual data plotted in the figures show finite contributions of the other modes ascribed to the finite accuracy of our computations : to be precise , the difference between the final result ( sum of the first fifty modes ) and the third mode alone was found to be on the fourth significative digit .",
    "in this paper paper we presented one of the few self - consistent analytical solutions for a system of charged particles under the action of their own electromagnetic fields .",
    "namely , we considered a relativistic electron beam under the action of space - charge at given initial conditions for energy and density modulation and we developed a fully analytical , three - dimensional theory of plasma oscillations in the direction of the beam motion .",
    "we used the assumption of a small modulation so that we could investigate the system behavior in terms of a linearized vlasov equation coupled with maxwell equation , under the assumption that field retardation effects can be neglected .",
    "then we introduced normalized quantities according to similarity techniques and we provided two equivalent presentations for the evolution problem in terms of a integrodifferential equation for the electric field and of a integral equation for the beam current .    the integrodifferential equation for the fields was particularly suited to be solved with the help of laplace transform techniques : we did so in all generality and we discussed the mathematical difficulties involved in the general treatment , namely the assumption of a well - behaved differential operator allowing eigenmodes expansion of the green function and the problem of the analytic continuation of the laplace transform of the field to all the complex plane ( isolated singularities excluded ) , in relation with the application of the fourier - mellin integral to antitransform @xmath192 .",
    "our considerations led us to restrict our attention to the cold beam case .",
    "we specialized the general method to the important cases of stepped and parabolic transverse profiles , which are among the few analytically solvable situations .",
    "in particular , the stepped profile case could be used to develop a semi - analytical technique to solve the evolution problem for the field using an arbitrary transverse shape .",
    "we tested our results by discussing the limit for the 1-d theory ( @xmath121 ) .",
    "we also developed an algorithm able to solve the evolution problem in terms of the beam currents .",
    "the integral equation for the currents could be easily approximated to a system of second order ordinary differential equations which could be solved by means of numerical runge - kutta integration method .",
    "once the solution for the current was known we recovered the electric field evolution by integration of the current with a suitable green function .",
    "numerical and analytical or semi - analytical solutions for the fields were then compared and gave a perfect agreement . in this way we could state that the assumption of the correctness of the eigenmodes expansion for the green function has been proved , for some particular profiles , by means of numerical crosschecks ( in the stepped profile case , by means of alternative analytical techniques too ) .",
    "finally we exemplified the role of the initial condition , which we have seen to control the way one ore more modes interact together to give the final result .",
    "in particular we have shown how to build up initial conditions in such a way that a single mode is excited and propagates through .",
    "we checked our prescription by setting up particular initial conditions and looking at the propagation of various eigenmodes .    in conclusion we proposed , checked and analyzed , both from physical and mathematical viewpoint , a theory of space - charge waves on gradient - profile relativistic electron beams .",
    "this work is of fundamental importance , since it is one of the few known analytical solution to evolution problems for systems of particles and fields . in particular , today",
    ", it is of great relevance in the physics of fel and high - brightness linear particle accelerators .",
    "we thank reinhard brinkmann ( desy ) , martin dohlus ( desy ) , michele correggi ( sissa ) , klaus floettman ( desy ) and helmut mais ( desy ) for useful discussions .",
    "we thank jochan schneider ( desy ) and marnix van der wiel ( tue ) for their interest in this work .",
    "99 j. rosenzweig et al . in proc . of advanced accelerator workshop , lake tahoe , 1996 c. limborg - deprey , z. huang , j. welch et al . , in proceedings of epac2004 , lucerne , switzerland , to be published m. dohlus , k. floettmann , o.s.kozlov et al . , nucl .",
    "instr . and meth . a , 2004 , in press tesla technical design report , desy 2001 - 011 , edited by f.richard et .",
    "al . , and http://tesla.desy.de/ the lcls design study group , lcls design study report , slac reports slac- r521 , stanford ( 1998 ) and http://www-ssrl.slacstanford.edu/lcls/cdr",
    "yu , m.babzien , i. ben - zvi et al . , science , 289 ( 2000 ) j. feldhaus , m. koerfer , t. moeller et al .",
    ", desy 03 - 091 , issn 0418 - 9833 e.l .",
    "saldin , e.a .",
    "schneidmiller and m.v .",
    "yurkov , desy tesla - fel-2003 - 02 and nucl .",
    "instr . and",
    "meth a , 2004 , in press e.l .",
    "saldin , e.a .",
    "schneidmiller and m.v .",
    "yurkov , the physics of free electron lasers , springer - verlag , 2000 e.l .",
    "saldin , e.a .",
    "schneidmiller and m.v .",
    "yurkov , physics reports , 260 , 1995 p. 187",
    "h. alfven , phys .",
    "55 , 425 ( 1939 ) j.d .",
    "lawson , j. electron .",
    "control 3 , 587 , ( 1957 ) c.l . olson and j.w .",
    "poukey , phys .",
    "a , 9 2631 ( 1974 ) e.l .",
    "saldin , e.a .",
    "schneidmiller and m.v .",
    "yurkov , optics communications , 186 , 2000 pages 185 - 209 yu .",
    "l. klimontovich , physics - uspekhi 40 ( 1 ) , 1997 yu .",
    "l. klimontovich , statistical physics , harwood academic publ .",
    ", new york , 1986 e.m .",
    "lifshitz and l. p. pitaevskii , physical kinetics , moscow , nauka , 1979 s. krinsky and l.h .",
    "a 35 ( 1987 ) , p. 3406 a.e .",
    "siegman , phys .",
    "a 39 ( 1989 ) , p. 1253",
    "bernard friedman , principles and techniques of applied mathematics ( wiley , new york , 1956 ) g. ecker , theory of fully ionized plasma , academic press , new york , 1972"
  ],
  "abstract_text": [
    "<S> we developed an exact analytical treatment for space - charge waves within a relativistic electron beam in terms of ( self - reproducing ) propagating eigenmodes . </S>",
    "<S> this result is of obvious theoretical relevance as it constitutes one of the few exact solution for the evolution of charged particles under the action of self - interactions . </S>",
    "<S> it also has clear numerical applications in particle accelerator physics where it can be used as the first self - consistent benchmark for space - charge simulation programs . </S>",
    "<S> today our work is of practical relevance in fel technology in relation with all those schemes where an optically modulated electron beam is needed and with the study of longitudinal space - charge instabilities in magnetic bunch compressors .    </S>",
    "<S> * deutsches elektronen - synchrotron *    * + *    desy 04 - 112    july 2004    @xmath0    @xmath1    * theory of space - charge waves on gradient - profile relativistic electron beam : an analysis in propagating eigenmodes *    @xmath2    gianluca geloni , evgeni saldin , evgeni schneidmiller and mikhail yurkov    _ + deutsches elektronen - synchrotron desy , hamburg _ @xmath1 @xmath1 @xmath1 @xmath1 @xmath1 @xmath1 @xmath1 @xmath1 @xmath1 @xmath1 @xmath1 issn 0418 - 9833 @xmath1    * notkestrasse 85 - 22607 hamburg * </S>"
  ]
}