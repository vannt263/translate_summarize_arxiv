{
  "article_text": [
    "the automatic identification of features in solar images provide an increasingly helpful tool for the analysis of solar physics data .",
    "previous methods of solar feature identification used , e.g , contrast , intensity and contiguity criteria in ca ii k images to identify structures like sunspots and plage @xcite . here",
    "we are mainly interested in identifying closed loop structures in active regions .",
    "coronal plasma loops are optical thin and coronal images , e.g. in x - rays or euv radiation , provide only a 2d projection of the 3d structures .",
    "the line - of - sight integrated character of these images complicates their interpretation .",
    "the corresponding problem that loop structures visible in images are often a superposition of individual loops occurs particularly in high resolution trace images @xcite , although occasionally individual loops are clearly visible over a large fraction of their length @xcite . to get insights regarding the structure of the coronal plasma",
    "it is important to consider the distribution of the plasma @xmath0 with height .",
    "the plasma @xmath0 varies from @xmath1 in the photosphere over @xmath2 in the mid - corona to @xmath1 in the upper corona ( see @xcite(@xcite ) for details ) . for the interpretation of coronal loops",
    "it is helpful that they are located in the low @xmath0 corona and consequently their structure is dominated by the coronal magnetic field . in the following",
    "we will therefore discuss how information about the magnetic field can be used for the analysis of coronal images , e.g. , from soho / eit , soho / sumer , or in future from the two stereo spacecrafts .",
    "the strongest emissivity in euv - images originates from closed magnetic loops in active regions . due to the high conductivity",
    "the coronal plasma becomes trapped on close magnetic field lines and consequently the emitting plasma outlines the magnetic field @xcite .",
    "this feature has previously been used ( in combination with line of sight photospheric magnetograms ) to compute free parameters ( e.g. , the linear force - free parameter @xmath3 ) in coronal magnetic field models .",
    "@xcite(@xcite ) used global potential fields and scaling laws to fill the coronal magnetic field lines with plasma and computed so called synthetic eit images from their magnetic field model , which they compared with real eit observations . while potential fields give a rough impression regarding the global structure of the solar corona ( e.g. the location of coronal holes and active regions , @xcite @xcite ) they often fail to describe magnetic fields in active regions accurately . here",
    "we use different magnetic field models ( potential , force - free fields and coronal magnetic fields reconstructed directly from measurements ) in combination with coronal plasma images to identify coronal structures , where we concentrate on closed loops in an active region .",
    "while the space in the corona is basically filled with magnetic field , only some fraction of all field lines shows a strong emissivity .",
    "our aim is to identify out of the many ( theoretical infinite ) number of field lines the ones which are accompanied by a strong plasma radiation .",
    "@xcite ( @xcite ) picked out individual loops from two eit images and applied a geometrical fit ( assumption of circular loops ) and dynamic stereoscopy to draw conclusions regarding the 3d structure of the loops .",
    "@xcite ( @xcite ) used these circular 3d loops and a mdi magnetogram to compute the optimal linear force - free field consistent with these observations .",
    "the method was extended by @xcite ( @xcite ) to work with 2d coronal images , in which an individual loop is visible in coronal images along it s entire length ( including the approximate location of both footpoints ) .",
    "an alternative approach was taken by ( ) , who identified several loops or ( large ) parts of loops in eit - images ( by manual tracing ) .",
    "the purpose of these papers was not feature identification , but to use coronal images and line of sight magnetograms to compute the coronal magnetic field within a linear force - free model .",
    "a manual selection of the loops was necessary .",
    "the aim of this work is to automize these procedures and allow more general magnetic field models .",
    "we use linear and non - linear force - free magnetic field models and also give an example with measured magnetic fields . in the special case of linear force - free fields",
    "our method automatically calculates the optimal linear force - free parameter @xmath3 .    in this sense",
    "the method is a further development for computing linear force - free fields from line - of sight magnetograms and coronal images .",
    "we outline the paper as follows : in section [ sec2 ] we outline the loop identification method and in section [ sec3 ] we describe how our method finds the optimal values for magnetic field models with free parameters . section [ sec4 ] contains an example where we tested our algorithm with different magnetic field models .",
    "finally we draw conclusions and give an outlook for future work in section [ sec5 ] .",
    "to extrapolate photospheric magnetic field measurements into the corona .",
    "we plot only closed magnetic field lines with a magnetic field strength above @xmath4 at the solar surface .",
    "please note that the vertical scale is stretched by a factor of two.,width=604,height=529 ]    previous loop identification methods used the enhanced brightness of coronal loops compared with the background .",
    "@xcite(@xcite ) and @xcite(@xcite ) identified loops by visually selecting the brightest pixels in coronal images and fitting them by least square with a polynomial function .",
    "@xcite ( @xcite ) subtracted a smoothed image ( using a @xmath5 boxcar ) from the original to enhance the loop structure .",
    "the key assumption for our method is that the coronal plasma , visible e.g. with eit , also outlines the coronal magnetic field . due to the low plasma pressure in the corona the magnetic field dominates the structures of the corona and due to the high conductivity",
    "the coronal plasma is trapped on field lines .",
    "the method involves the following steps :    1 .",
    "compute the coronal magnetic field .",
    "2 .   calculate magnetic field lines .",
    "project all magnetic field lines onto an image of the coronal plasma , e.g. from eit .",
    "4 .   compute emissivity and emissivity gradient of the image along the projected field lines .",
    "check how well projected field lines and plasma features agree expressed by a quantitative parameter .",
    ".   sort loops and choose the best ones in the sense of agreement with the plasma features .",
    "plot some representative loops onto the image .",
    "direct observations of the coronal magnetic field are only available for a few individual cases ( see section [ sec4 ] ) and usually one has to extrapolate the coronal magnetic field from photospheric measurements .",
    "full disc line of sight magnetograms are routinely observed with , e.g. , soho / mdi and at kitt peak .",
    "assumptions regarding the coronal current flow are essential for the extrapolation method .",
    "* current free potential fields can be computed from los - magnetograms alone .",
    "potential fields are usually not a good model for magnetic fields in active regions .",
    "* linear force free fields are also computed from los - magnetograms , but contain a free parameter @xmath3 .",
    "we will illustrate later , how our method finds the optimal value of @xmath3 , i.e. the one fits the observations best .",
    "* nonlinear force - free fields require photospheric vector magnetograms as input and are numerically more expensive to compute . if these data are available , nonlinear force - free fields are preferred over linear force - free fields .",
    "the reason is that linear force - free fields are a subclass of non - linear force - free fields and consequently non - linear fields provide a larger class of solutions .",
    "unfortunately , current vector magnetograms usually have a limited field of view , large noise in the transversal field component and are simply often not available for active regions of interest .",
    "this situation will improve once solis starts providing regular vector magnetograms .",
    "let us remark that the result of the extrapolation is as well influenced by the lateral and top boundary conditions of the computational box .",
    "a popular choice for the upper boundary of global potential fields is a source surface ( all field lines are forced to become radial on the source surface . )",
    "the extrapolation method of linear force - free fields implicitly specifies the upper boundary by assuming that the magnetic field is bounded at infinity ( see @xcite(@xcite ) for details . ) the limited field of view of magnetograms effect the extrapolation as well , because distance sources become neglected and one has to specify lateral boundary conditions , e.g. symmetry assumptions or a boundary layer towards the lateral and top boundaries of the computational box .",
    "the effects of the lateral boundary conditions on the reconstruction can be diminished by choosing a well isolated active region with low magnetic flux close to the side boundaries of the computational box ( see @xcite(@xcite for details ) .",
    "our method usually uses linear force - free fields , but we will present also one example where we used non - linear force - free fields and coronal magnetic loops deduced directly from spectropolarimetric observations .",
    "we use a forth order runge - kutta field line tracer to compute a large number of magnetic field lines .",
    "the starting points for the field line integration are chosen randomly at the solar surface , whereby the number of traced field lines starting from a given surface area is proportional to the strength of the magnetogram signal . the particular concentration on loops with high magnetic flux",
    "is motivated by scaling laws @xcite which suggests that loops with a strong magnetic field are also bright loops .    because the coronal plasma is trapped on closed magnetic loops and has a high emissivity there we are interested here in studying closed magnetic loops .",
    "we therefore store only field lines which are closed .",
    "[ fig1 ] shows an example .",
    "we computed the 3d magnetic field of ar7953 with the help of a linear force - free model using the method of @xcite ( @xcite ) for a linear force - free value of @xmath6 .",
    "we plot only closed magnetic field lines where at least one footpoint has @xmath7 in the photosphere .",
    "the value of the magnetic field is implicit also a threshold for the brightness of the loops and we are interested mainly in identifying bright loops .",
    "this is in particular important for the stereo mission , where we want to identify pairs of loops in two images .",
    "the faint , optically thin , structure of the coronal emission does not give information regarding its height in the corona .",
    "therefore the 3d magnetic field lines are projected onto an eit - image on the disk for comparison .",
    "it is assumed that the source of high emission is located in closed magnetic structures .",
    "we compute the emissivity @xmath8 and it s gradient @xmath9 along the magnetic field lines .",
    "the coronal plasma is assumed to outline the magnetic field and consequently the emissivity gradient parallel to the field lines should be small .",
    "we use the following measure to get quantitative information on how good a given field line and the plasma emission agree .",
    "@xmath10 where @xmath11 is the length of the loop and the integrals sum along the loop . the lower the value of @xmath12",
    "the better magnetic loop and plasma agree with each other .",
    "one may certainly play around with the exact parameters in eq .",
    "[ defc ] , e.g. use simply @xmath13 or @xmath14 .",
    "the form used in eq .",
    "[ defc ] gives stronger weight to loops with a high emissivity and long loops .",
    "we compute a value of @xmath12 for all field lines .",
    "is unimportant .",
    "different images with a different emissivity , wavelength etc .",
    "will usually have different ranges for @xmath12 .",
    "we multiply the absolute values of @xmath12 with @xmath15 for the examples presented here to get handy numbers . ]",
    "the gradient along the center of the coronal loop is low but also the gradient could be low far from the loops and the denominator normalization factor may not always correct this if the first potence of the emissivity is used in the nominator .",
    "we find that taking the square of the emissivity in the nominator ensures that c becomes large far from the loops and the nominator compensates the low emissivity gradient in the background plasma .",
    "the computation of @xmath12 might become influenced by overlapping and crossing loops which locally enhance the emissivity and the emissivity gradient .",
    "since any coronal image samples only gas within a limited range of temperatures , this method assumes that coronal loops have a homogeneous temperature along their entire length .",
    "this is a relative good approximation ( e.g. ) .",
    "another possibility to check the agreement between magnetic field lines and the coronal emission is to fit a gaussian to the coronal plasma perpendicular to the magnetic field lines and to compute the shift between the center of the gaussian and magnetic field lines integrated along the loop @xcite .",
    "this method was especially successful for single isolated loops , where both footpoint areas of the loop have been identified and only field lines connecting both footpoint areas have been considered for the gaussian fit .",
    "note that this technique does not rely on the assumption of loops with uniform temperature . within this work we are planning to automatically detect the loops without any prior footpoint identification .",
    "often one or both footpoints are not visible in the coronal emission .",
    "a gaussian fit can also give misleading results when different coronal loops lie close together in the image .",
    "we sort all field lines with respect to the measure @xmath12 . in principle",
    "every plasma feature consists of an infinite number of magnetic field lines and after sorting the loops with respect to @xmath12 it might happen that the best identified loops ( lowest values of @xmath12 ) lie close together . for the identification and illustration of coronal loops it seems to be better that every feature is only represented by one field line . to do",
    "so we compute the difference of all projected field lines ( e.g. the area between two field lines ) and choose only loops which are clearly separated ( area between the loops above a certain threshold ) .",
    "eventually we plot the projections of the best loops onto the coronal images .",
    "[ fig2 ] a ) shows four identified loops .",
    "the alignment of the coronal structures with the magnetic loops is obvious .",
    "a more detailed discussion of this figure is given in section [ sec3 ] .",
    "let us remark that our method not only provides the locations of the 2d projection of the loop , but additional information as well .",
    "the magnetic field automatically provides the 3d structure of the identified coronal features , the magnetic field strength and current density along the loop .",
    "together with other information from coronal images , e.g. information regarding the plasma flow with sumer , we can draw further conclusions regarding physical properties . for example ( )",
    "studied plasma flows along magnetic field lines for this active region with the help of sumer data .",
    "coronal images give information regarding the direction of the coronal magnetic field .",
    "a magnetic field model provides the 3d - magnetic field in the entire space and projections of corresponding magnetic field lines onto the disk can be compared with the coronal image . for",
    "non - linear force - free field extrapolations from vector magnetograms or models based on measurements of coronal magnetic fields the projected model field lines are independent from the coronal image .",
    "magnetic field model and coronal image provide independent from each other information regarding the direction of the magnetic field .",
    "unfortunately models based on non - linear force - free extrapolations or direct measurements are currently only available for a few individual cases .",
    "usually the only available magnetic field data are line - of - sight magnetograms from e.g. mdi or kitt peak . under the assumption of current - free potential fields the coronal magnetic field",
    "can be derived from los - magnetograms .",
    "unfortunately current - free models are usually not a good description for magnetic fields in active regions .",
    "we can , however , consider electric currents with the help of linear force - free models where the current free parameter @xmath3 is unknown a priori and can not be derived from the los - magnetogram .",
    "@xcite ( @xcite ) used 3d stereoscopic reconstructed loops from @xcite ( @xcite ) to fix @xmath3 and @xcite ( @xcite ) fitted @xmath3 with the help of a plasma loop identified earlier .",
    "we generalize the method and use the eit - image ( without any pre - identification of structures ) together with the fitting routine described in section [ sec2 ] to compute the optimal value of @xmath3 . to do so , we compute magnetic field lines for several values of @xmath3 and apply the feature identification method ( see sect . [ sec2 ] ) to each of the models and compute the values of @xmath12 for several loops in each model . as an example we tried to identify coronal loops with the help of a potential field model @xmath16 in fig .",
    "[ fig2 ] b ) and with @xmath17 in fig .",
    "[ fig2 ] c ) .",
    "it is obvious from the images that the alignment of plasma structures and magnetic field lines is worse than for the optimal value of @xmath18 .",
    "the value of @xmath3 corresponding to the lowest value of @xmath12 depicts the optimal value of @xmath3 . as a consequence the method automatically computes the optimal coronal magnetic field ( within the linear force - free approximation ) from los - magnetograms and a plasma image ( within the limitations listed in sect .",
    "[ sec2.5 ] ) . in fig .",
    "[ fig2 ] d ) we show quantitatively , with help of the measure define in eq .",
    "[ defc ] how well magnetic field model and emission structures agree with respect to @xmath3 .",
    "the minimum of the function depicts the optimal value of the linear force - free parameter , @xmath18 .",
    "let us remark that the main reason for using linear - force free fields are their mathematical simplicity and because non - linear force - free models require vector magnetograms which are often not available or have a limit fov and high noise / ambiguity in the transversal field .",
    "if these data are available a non - linear force - free model is preferred over a linear one .",
    "we find , however , that linear force - free fields often give a reasonable approximation of the coronal magnetic field in active regions ( much better than potential fields .",
    "see section [ sec4 ] and @xcite ) .",
    "the linear force - free model has only one free parameter , but in principle one can also use a magnetic field models with several free parameters , e.g. a wider class of magnetohydrostatic equilibria , together with a multi - dimensional search for the optimal ( lowest value of @xmath12 ) parameter set .",
    "until now we used linear force - free models for the loop identification and in many cases this will remain the first choice because this model requires only line - of - sight magnetograms , which are routinely observed and available online ( mdi : http://soi.stanford.edu/ , kitt peak : http://www.noao.edu/kpno/ ) . in the near future ,",
    "when vector magnetograms will be observed routinely ( e.g. from solis or solar - b ) non - linear force - free models can be employed .    here",
    "we provide an example of our fitting routine with different magnetic field models .",
    "we use a vector magnetogram of the developing active region noaa 9451 observed with the german vacuum tower telescope ( vtt ) and the tenerife infrared polarimeter .",
    "the pictures have been taken close to the disk center @xmath19 and the images have not been corrected .",
    "we compute a potential field and a linear force - free field from the line - of sight component of the magnetogram using the method of @xcite ( @xcite ) ( see figs .",
    "[ fig3 ] b ) and d ) , respectively ) . with the help of an optimization principle",
    "@xcite we also compute a non - linear force - free field from the full vector magnetogram ( see fig .",
    "[ fig3 ] panel c ) . for this active region",
    "the chromospheric magnetic field vector has been measured ( see fig .",
    "[ fig3 ] a ) .",
    "the direct field measurements as well as the linear and non - linear extrapolation methods ( fig .",
    "[ fig3 ] panels a - c , respectively ) are able to identify a loop structure in the center of a corresponding h alpha image with similar accuracy @xmath20 .",
    "the potential field is not able to identify any structure in the image and the measure @xmath21 is almost an order of magnitude higher than for the other magnetic field models .",
    "this result is not surprising , because the direct magnetic field measurements have been compared with extrapolated magnetic fields and the comparison revealed that a potential field model was not appropriate for this developing active region @xcite .",
    "the comparison with different magnetic field models has revealed that field line parallel electric currents are important to describe the structure and thus the configuration contains magnetic shear .",
    "within this work we have developed a method for the automatic identification of coronal loops .",
    "the method uses a suitable coronal magnetic field model , e.g. from a force - free extrapolation , and compares the projection of 3d magnetic field lines with structures on images , e.g. from soho / eit . as a result coronal structures are represented by 1d curves .",
    "a further use of the method is planned in particular for the analysis of data from the two stereo spacecrafts .",
    "the reconstruction of curves is attractive for the stereo mission for two reasons .",
    "firstly structures on the solar surface are dominated by thin flux tubes which often can well be approximated by idealized curves .",
    "secondly , the stereoscopic reconstruction problem for 1d objects is well posed .",
    "formally , a projected curve in an image can be projected back along the view direction giving rise to a 3d solution surface on which the 3d curve must lie . from two images ,",
    "we obtain two such surfaces and their intersection must be the solution curve .",
    "this is different for a point - like object .",
    "its projection yields two coordinate parameters in two images while only 3 spatial coordinates are required .",
    "formally , the triangulation of point - like objects is therefore over - determined .",
    "conversely , if we want to solve for optically thin , curved surfaces we have an underdetermined problem because the bright limb visible in the two images might project back to different parts of the surface .",
    "it is therefore useful to identify 1d objects ( loops ) out of 2d images for a stereoscopic reconstruction by e.g. tie - point - like methods @xcite .",
    "let us remark that the structure identification method by magnetic field lines provides already a 3d structure of the loop which might be further refined by stereoscopic methods .",
    "in particular , the advent of the stereo mission has produced an increased interest of the solar physics community in stereoscopic ( @xcite,@xcite,@xcite and tomographic techniques @xcite used in other branches of physics , image and information sciences . however , unlike many of the `` experiments '' conducted in the latter disciplines , the stereo mission does not provide sufficient control over many of the parameters which determine the conditions for an optimal 3d reconstruction .",
    "tomographic methods will in particular be useful in situations where individual loops can not be identified due to the superposition of many loops due to the line - of - sight integrated character of 2d images .",
    "we acknowledge the use of data from soho / eit , nso / kitt peak and the german vtt .",
    "the work of t. wiegelmann was supported by dlr - grant 50 oc 0007 and by a jsps visitor grant at the national astronomical observatory in tokyo .",
    "aschwanden m.  j. , newmark j.  s. , delaboudini ` ere j. , neupert w.  m. , klimchuk j.  a. , gary g.  a. , portier - fozzani f. , zucker a. , 1999 , apj , 515 , 842 aschwanden m.  j. , alexander d. , hurlburt n. , newmark j.  s. , neupert w.  m. , klimchuk j.  a. , gary g.  a. , 2000 , apj , 531 , 1129 aschwanden m.  j. , nightingale r.  w. , alexander d. , 2000 , apj , 541 , 1059 brkovi ' c a. , landi e. , landini m. , r \" uedi i. , solanki s.  k. , 2002 , a&a , 383 , 661 carcedo l. , brown d.  s. , hood a.  w. , neukirch t. , wiegelmann t. , 2003 , soph , 218 , 29 frazin r.  a. , 2000 , apj , 530 , 1026 gary g.  a. , 2001 , soph , 203 , 71 hall j.  r. , sheth p. , dejong e. , lorre j. , liewer p. , 2004 ,",
    "agufmsh21 , 422 klimchuk j.  a. , lemen j.  r. , feldman u. , tsuneta s. , uchida y. , 1992 , pasj , 44 , l181 klimchuk j.  a. , 2000 , soph , 193 , 53 lagg a. , woch j. , krupp n. , solanki s.  k. , 2004 , a&a , 414 , 1109 marsch e. , wiegelmann t. , xia l.  d. , 2004 , a&a , 428 , 629 neugebauer m. , liewer p.  c. , smith e.  j. , skoug r.  m. , zurbuchen t.  h. , 2002 , jgra , 107 , 13 petrie g.  j.  d. , neukirch t. , 2000 , a&a , 356 , 735 poletto g. , vaiana g.  s. , zombeck m.  v. , krieger a.  s. , timothy a.  f. , 1975 , soph , 44 , 83 preminger d.  g. , walton s.  r. , chapman g.  a. , 2001 , soph , 202 , 53 schrijver c.  j. , et al . , 1999 , soph , 187 , 261 schrijver c.  j. , sandman a.  w. , aschwanden m.  j. , derosa m.  l. , 2004 , apj , 615 , 512 sakurai t. , uchida y. , 1977 , soph , 52 , 397 sakurai t. , 1989 , ssrv , 51 , 11 seehafer n. , 1978 , soph , 58 , 215 solanki s.  k. , lagg a. , woch j. , krupp n. , collados m. , 2003 , natur , 425 , 692 wheatland m.  s. , sturrock p.  a. , roumeliotis g. , 2000 , apj , 540 , 1150 wiegelmann t. , neukirch t. , 2002 , soph , 208 , 233 wiegelmann t. , inhester b. , 2003 , soph , 214 , 287 wiegelmann t. , 2004 , soph , 219 , 87 wiegelmann t. , lagg a. , solanki s.  k. , inhester , b. , woch j. , 2005 , a&a , in press worden j.  r. , white o.  r. , woods t.  n. , 1998 , apj , 496 , 998 zidowitz s. , 1999 , jgr , 104 , 9727"
  ],
  "abstract_text": [
    "<S> the structure of the solar corona is dominated by the magnetic field because the magnetic pressure is about four orders of magnitude higher than the plasma pressure . due to the high conductivity </S>",
    "<S> the emitting coronal plasma ( visible e.g. in soho / eit ) outlines the magnetic field lines . </S>",
    "<S> the gradient of the emitting plasma structures is significantly lower parallel to the magnetic field lines than in the perpendicular direction . </S>",
    "<S> consequently information regarding the coronal magnetic field can be used for the interpretation of coronal plasma structures . </S>",
    "<S> we extrapolate the coronal magnetic field from photospheric magnetic field measurements into the corona . </S>",
    "<S> the extrapolation method depends on assumptions regarding coronal currents , e.g. potential fields ( current free ) or force - free fields ( current parallel to magnetic field ) . as a next step we project the reconstructed 3d magnetic field lines on an eit - image and </S>",
    "<S> compare with the emitting plasma structures . </S>",
    "<S> coronal loops are identified as closed magnetic field lines with a high emissivity in eit and a small gradient of the emissivity along the magnetic field .    </S>",
    "<S> kluwer prepress department + p.o . </S>",
    "<S> box 990 + 3300 az dordrecht + the netherlands </S>"
  ]
}