{
  "article_text": [
    "offline software framework of the pierre auger observatory  @xcite provides an infrastructure to support a variety of distinct computational tasks necessary to analyze data gathered by the observatory .",
    "the observatory itself is designed to measure the extensive air showers produced by the highest energy cosmic rays ( @xmath0  ev ) with the goal of discovering their origins and composition .",
    "two different techniques are used to detect air showers .",
    "firstly , a collection of telescopes is used to sense the fluorescence light produced by excitation of nitrogen induced by the cascade of particles in the atmosphere .",
    "this method can be used only when the sky is moonless and dark , and thus has roughly a 10% duty cycle .",
    "the second method uses an array of detectors on the ground to sample particle densities as the air shower arrives at the earth s surface .",
    "each surface detector consists of a tank containing 12 tons of purified water instrumented with photomultiplier tubes to detect the cherenkov light produced when particles pass through it .",
    "the surface detector has a 100% duty cycle .",
    "a subsample of air showers detected by both instruments , dubbed hybrid events , are very precisely measured and provide an invaluable energy calibration tool . in order to cover the full sky ,",
    "the observatory will consist of two sites , one in the southern hemisphere and one in the north .",
    "the southern site is located in mendoza , argentina , and construction there is nearing completion , at which time the observatory will comprise 24 fluorescence telescopes overlooking 1600 surface detectors spaced 1.5  km apart on a hexagonal grid .",
    "colorado has been selected as the location for the northern site .",
    "the requirements of this project place rather strong demands on the software framework underlying data analysis .",
    "most importantly , the framework must be flexible and robust enough to support the collaborative effort of a large number of physicists developing a variety of applications over the projected 20 year lifetime of the experiment .",
    "specifically , the software must support simulation and reconstruction of events using surface , fluorescence and hybrid methods , as well as simulation of calibration techniques and other ancillary tasks such as data preprocessing .",
    "further , as the experimental run will be long , it is desirable that the software be extensible in case of future upgrades to the observatory instrumentation .",
    "the offline framework must also handle a number of data formats in order to deal with event and monitoring information from a variety of instruments , as well as the output of air shower simulation codes .",
    "additionally , it is desirable that all physics code be `` exposed '' in the sense that any collaboration member must be able to replace existing algorithms with his own in a straightforward manner . finally ,",
    "while the underlying framework itself may exploit the full power of c++ and object - oriented design , the portions of the code directly used by physicists should not assume a particularly detailed knowledge of these topics .",
    "the offline framework was designed with these principles in mind .",
    "implementation has taken place over the last three years , and the first physics results based upon this code were recently presented at the @xmath1 international cosmic ray conference  @xcite .",
    "the offline framework comprises three principal parts : a collection of processing _ modules _ which can be assembled and sequenced through instructions provided in an xml file , an _ event _ structure through which modules can relay data to one another and which accumulates all simulation and reconstruction information , and a _ detector description _ which provides a gateway to data describing the configuration and performance of the observatory as well as atmospheric conditions as a function of time .",
    "these principal ingredients are depicted in figure  [ f : general ] .",
    "these components are complimented by a set of foundation classes and utilities for error logging , physics and mathematical manipulation , as well as a unique package supporting abstract manipulation of geometrical objects .",
    "each of these aspects of the framework is described in more detail below .",
    "experience has shown that most tasks of interest of the pierre auger collaboration can be reasonably factorized into sequences of well - defined processing steps .",
    "physicists prepare such processing algorithms in so - called _ modules _ , which they can insert into the framework via a registration macro in their code .",
    "this modular design allows collaborators to easily exchange code , compare algorithms and build up a wide variety of applications by combining modules in various sequences .",
    "run - time control over module sequences is afforded through a _",
    "run controller _ which invokes the various processing steps within the modules according to a set of externally provided instructions .",
    "as most of our applications do not require extremely sophisticated sequencing control at the module level , we have chosen to construct a very simple xml  @xcite - based language for specifying sequencing instructions .",
    "this provides users with a tool which can be learned very quickly , but which is still rich enough to still support most common applications .",
    "figure  [ f : xml ] shows a simple example of the structure of a sequencing file .    ....",
    "< sequencefile >     < loop numtimes=\"unbounded \" >       < module > simshowerreader <",
    "/module >       < loop numtimes=\"10 \" >          < module > eventgenerator < /module",
    ">          < module > tanksim         < /module",
    ">          < module > triggersim      < /module >",
    "< module > eventexporter   < /module",
    ">       < /loop",
    ">     < /loop >",
    "< /sequencefile > ....    parameters , cuts and configuration instructions used by modules or by the framework itself are also stored in xml files . a central directory points modules to their configuration file(s ) using a local filename or uri and creates parsers to assist in reading information from these files .",
    "this directory is constructed from a _ bootstrap _ file whose name is passed on the command line at run time .",
    "the configuration mechanism can also concatenate and write a log file with all configuration data accessed during a run .",
    "the log file format identical to the _ bootstrap _ format , so the logs can be subsequently read in to reproduce a run with an identical configuration .",
    "this configuration logging mechanism may also be used to record the versions of modules and external libraries which are used during a run .    to check configuration files for errors ,",
    "we employ xml schema  @xcite validation throughout .",
    "this has proved successful in saving coding time for developers and users alike , and facilitates much more detailed error checking than most users are likely to implement on their own .",
    "all xml handling is based upon the xerces  @xcite validating parser , augmented by a wrapper to simplify use and compliment functionality with features such as unit handling , expression evaluation , and casting of data in xml files to atomic types or stl containers .",
    "the offline framework provides two parallel hierarchies for accessing data : the _ event _ for reading and writing information that changes per event , and the read - only _ detector description _ for retrieving static or slowly varying information such as detector geometry , calibration constants , and atmospheric conditions .",
    "the event data structure contains all raw , calibrated , reconstructed and monte carlo data and acts as the principal backbone for communication between modules . as it is a communication backbone ,",
    "reference semantics are used throughout to access data structures in the event and constructors are kept private to prevent accidental copying of event components .",
    "the event structure is built up dynamically as needed , and is instrumented with a simple protocol allowing modules to interrogate the event at any point to discover its current constituents .",
    "the event representation in memory is decoupled from the representation on disk .",
    "serialization is currently implemented using the root  @xcite toolkit , though the design is intended to allow for relatively straightforward changes of serialization machinery .",
    "a set of simple - to - use input / output modules are provided to allow users to transfer all or part of the event from memory to a file at any stage in the processing , and to reload the event and continue processing from that point onward .",
    "these modules are are built upon a a set of utilities to support the multi - format reading and writing required to deal with different raw event and monitoring formats as well as the different formats used by the aires  @xcite , corsika  @xcite and conex  @xcite air shower simulation packages .      the _ detector description",
    "_ provides a unified interface from which module authors can retrieve information about the detector configuration and performance at a particular time .",
    "the interface is organized following the hierarchy normally associated with the observatory instruments .",
    "requests for data are passed by this interface to a registry of so - called _ managers _ , each of which is capable of extracting a particular sort of information from a particular data source .",
    "data retrieved from the manager are cached in the interface for future use . in this approach ,",
    "the user deals with a single interface even though the data sought may reside in any number of different sources .",
    "generally we choose to store static detector information in xml files , and time - varying monitoring and calibration data in mysql  @xcite databases .",
    "the structure of the detector description machinery is illustrated in figure  [ f : detector ] .",
    "note that it is possible to implement more than one manager for a particular sort of data . in this way",
    ", a special manager can override data from a general manager .",
    "for example , a user can decide to use a database for the majority of the description of the detector , but override some data by writing them in an xml file which is interpreted by the special manager .",
    "the specification of which data sources are accessed by the manager registry and in what order they are queried is detailed in a configuration file .",
    "the configuration of the manager registry is transparent to the user code .",
    "the detector description is also equipped to support a set of plug - in functions , called _ models _ which can be used for additional processing of data retrieved through the detector .",
    "these are used primarily to interpret atmospheric monitoring data . as an example",
    ", users can invoke a model designed to evaluate attenuation due to aerosols between two points in the atmosphere .",
    "this model interrogates the detector interface to find the atmospheric conditions at the specified time , and computes the attenuation .",
    "models can also be placed under command of a _ super - model _ which can attempt various methods of computing the desired result , depending on what data are available at the specified time .",
    "the offline framework is built on a collection of utilities , including a xerces - based xml parser , an error logger , various mathematics and physics services , testing utilities and a set of foundation classes to represent objects such as signal traces , tabulated functions and particles .",
    "the utilities collection also includes a novel geometry package , which we describe in more detail here .    as discussed previously ,",
    "the pierre auger observatory comprises many instruments spread over a large area and , in the case of the fluorescence telescopes , oriented in different directions .",
    "consequently there is no natural preferred coordinate system for the observatory ; indeed each detector component has its own preferred system , as do components of the event such as the air shower itself .",
    "furthermore , since the detector spans some 40  km from side to side , the curvature of the earth can not generally be neglected .",
    "in such a circumstance , the necessity of keeping track of all the the required transformations when performing geometrical computations is tedious and error prone .    this problem is alleviated in the offline geometry package by providing geometrical objects such as points and vectors which keep track of the coordinate system in which they are represented .",
    "operations on these objects can then be written in an abstract way , independent of any particular coordinate system choice .",
    "there is no need for pre - defined coordinate system conventions , or coordinate system conversions at module boundaries .",
    "coordinate systems themselves are defined in terms of transformations of other coordinate systems , with an ultimate root coordinate system as the foundation . in order to avoid reliance on this root",
    "coordinate system by all of the client code , a registry of pre - defined coordinate systems is provided .",
    "furthermore , various specialized coordinate systems , such as the coordinate system of the shower or one of the telescopes , can be retrieved from different parts of the event and detector description .",
    "locations of detector components are provided by survey teams in utm ( universal transverse mercator ) coordinates , which are convenient for navigation , but less so for data analysis .",
    "the geometry package therefore includes support for transformations between geodetic and cartesian coordinates .",
    "to help ensure code maintainability and stability in the face of a large number of contributors and a decades long experimental run , unit and acceptance testing are integrated into the offline framework build and distribution system .",
    "this sort of quality assurance mechanism is crucial for any software which must continue to develop over a timescale of many years .",
    "our build system is based on the gnu autotools  @xcite , which provide hooks for integrating tests with the build and distribution system .",
    "a substantial collection of unit tests has been developed , each of which is designed to comprehensively test a single framework component .",
    "these unit tests are run at regular intervals , and in particular prior to releasing a new version of the software .",
    "we have employed the cppunit  @xcite testing framework as an aid in implementing these unit tests .",
    "we are currently in the process of developing more involved acceptance tests which will be used to verify that modules and framework components working in concert continue to function properly during ongoing development .",
    "the choice of external packages upon which to build the offline framework was dictated not only by package features , support and the requirement of being open - source , but also by our best assessment of prospects for longevity . at the same time",
    ", we attempted to avoid locking the design to any single - provider solution . to help achieve this , the functionality of external libraries is often provided to the client code through wrappers or faades , as in the case of xml parsing described in section  [ sec : config ] , or through a bridge , as in the case of the detector description described in section  [ sec : detector ] .",
    "the collection of external libraries currently employed includes root  @xcite for serialization , xerces  @xcite for xml parsing and validation , clhep  @xcite for expression evaluation and geometry foundations , boost  @xcite for its many valuable c++ extensions , and optionally geant4  @xcite for detailed detector simulations .",
    "we have implemented an offline software framework for the pierre auger observatory .",
    "it provides machinery to help collaborators work together on data analysis problems , compare results , and carry out production runs of large quantities of simulated or real data .",
    "the framework is configurable enough to adapt to a diverse set of applications , while the user side remains simple enough for c++ non - experts to learn in a reasonable time .",
    "the modular design allows straightforward swapping of algorithms for quick comparisons of different approaches to a problem .",
    "the interfaces to detector and event information free the users from having to deal individually with multiple data formats and data sources .",
    "this software , while still undergoing vigorous development and improvement , has been used in production of the first physics results from the observatory .",
    "the authors would like to thank the fearless early users of the offline framework ."
  ],
  "abstract_text": [
    "<S> the pierre auger observatory is designed to unveil the nature and the origins of the highest energy cosmic rays . </S>",
    "<S> the large and geographically dispersed collaboration of physicists and the wide - ranging collection of simulation and reconstruction tasks pose some special challenges for the offline analysis software . </S>",
    "<S> we have designed and implemented a general purpose framework which allows collaborators to contribute algorithms and sequencing instructions to build up the variety of applications they require . </S>",
    "<S> the framework includes machinery to manage these user codes , to organize the abundance of user - contributed configuration files , to facilitate multi - format file handling , and to provide access to event and time - dependent detector information which can reside in various data sources . </S>",
    "<S> a number of utilities are also provided , including a novel geometry package which allows manipulation of abstract geometrical objects independent of coordinate system choice . </S>",
    "<S> the framework is implemented in c++ , and takes advantage of object oriented design and common open source tools , while keeping the user side simple enough for c++ novices to learn in a reasonable time . </S>",
    "<S> the distribution system incorporates unit and acceptance testing in order to support rapid development of both the core framework and contributed user code .    </S>",
    "<S> offline software , framework , object oriented , simulation , cosmic rays </S>"
  ]
}