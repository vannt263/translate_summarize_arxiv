{
  "article_text": [
    "this work is concerned with the numerical solution of the steady - state equation of radiative transfer ( ert ) with isotropic physical coefficients and scattering kernel  @xcite : @xmath0 where @xmath1 ( @xmath2 ) is a bounded domain with smooth boundary @xmath3 , @xmath4 is the unit sphere in @xmath5 , and @xmath6 ( @xmath7 being the unit outer normal vector at @xmath8 ) is the incoming part of the phase space boundary . for the only reason of simplifying the presentation , we have assumed that there is no incoming source on the boundary .",
    "moreover , we have assumed that the internal source @xmath9 is only a function of the spatial variable .",
    "in fact , this is not needed either for our algorithm to work ; see more discussions in section  [ sec : concl ] .",
    "the equation of radiative transfer is a popular model for describing the propagation of particles in complex media .",
    "it appears in many fields of science and technology , ranging from classical fields such as nuclear engineering  @xcite , astrophysics  @xcite , and remote sensing  @xcite , to modern applications such as biomedical optics  @xcite , radiation therapy and treatment planning  @xcite , and imaging in random media  @xcite .",
    "the coefficients @xmath10 and @xmath11 have different physical meanings in different applications . in general , the coefficient @xmath11 measures the strength of the scattering of the underlying medium at @xmath12 , while @xmath13 measures the strength of the physical absorption of the medium .",
    "the coefficient @xmath10 measures the total absorption at @xmath12 due to both the physical absorption and absorption caused by scattering , that is the loss of particles from the current traveling direction into other directions due to scattering .",
    "numerical methods for solving the equation of radiative transfer has been extensively studied , see for instance  @xcite and references therein for an overview . besides monte carlo type of methods that are based on stochastic representation of the ert  @xcite , many different deterministic discretization schemes have been proposed  @xcite and numerous iterative schemes , as well as preconditioning strategies , have been developed to solve the discretized systems ; see for instance  @xcite and references therein .",
    "there are many challenging issues in the numerical solutions of the equation of radiative transfer .",
    "one of such challenges is the high - dimensionality involved .",
    "the ert is posed in phase space , meaning that the main unknown in the equation , in steady state , depends on both the spatial variable and the angular variable . in the spatial three - dimensional case",
    ", the unknown @xmath14 depends on five variables , three in the spatial domain and two in the angular domain .",
    "this poses significant challenges in terms of both solution speed and storage .    in this work ,",
    "we propose a new method to solve the ert in isotropic media , that is , media whose physical coefficients and the scattering kernel do not depend on the angular variable @xmath15 , i.e. , the media absorb and scatter particles in the same manner for all directions .",
    "our method is based on the observation that when the underlying medium is isotropic , the angularly averaged ert solution , @xmath16 , satisfies a fredholm integral equation of the second type .",
    "this integral equation can be solved , using a fast multiple method , for @xmath16 .",
    "once this is done , we can plug @xmath16 into the ert   to solve for @xmath14 itself .",
    "the rest of this paper is organized as follows . in section  [ sec : integral ] , we re - formulate the ert   into a fredholm integral equation of the second type for the unknown @xmath16 .",
    "we then propose in section  [ sec : fmm ] a numerical procedure for solving the ert based on this integral formulation and implement an interpolation - based fast multipole method  @xcite to solve the integral equation .",
    "important issues on the implementation of our method are discussed in section  [ sec : impl ] . in section  [ sec : num ] we present some numerical tests for the algorithm that we developed .",
    "concluding remarks are then offered in section  [ sec : concl ] .",
    "our algorithm is based on the integral formulation of the ert  .",
    "this is a well - developed subject .",
    "we refer to  @xcite for more details .",
    "to present the formulation , let us first introduce a function @xmath17 defined as @xmath18 we can then rewrite the equation of radiative transfer , using the method of characteristics , into the following integral form  @xcite : @xmath19 here @xmath20 is the distance it takes for a particle to go from @xmath12 to reach the domain boundary @xmath3 in the @xmath21 direction : @xmath22 the integral formulation in   is classical and has been used to derive many theoretical results and numerical methods on the ert  @xcite .",
    "the most crucial step of our algorithm is to integrate the integral formulation   again over @xmath4 to obtain an integral equation for the local density @xmath23 : @xmath24 the result is a fredholm integral equation of the second type .",
    "it reads @xmath25 where the linear integral operator @xmath26 is defined as @xmath27 to simplify the expression for @xmath26 , let @xmath28 , and define the function @xmath29 @xmath30 which is nothing but the total absorption along the line segment between @xmath12 and @xmath31 .",
    "we can then express the integral operator @xmath26 as @xmath32 where the integral kernel @xmath33 is defined as @xmath34 with @xmath35 the surface area of the unit sphere @xmath4 .",
    "@xmath36 when @xmath37 and @xmath38 when @xmath39 . in the case where @xmath40 and @xmath41 are independent of the spatial variable",
    ", the integral kernel @xmath33 simplifies to @xmath42    the algorithm we propose here is based on the integral formulation of the ert for the variable @xmath43 that we derived in  .",
    "we need the following result on the operator @xmath26 .",
    "the proof is standard .",
    "let @xmath40 and @xmath41 be bounded such that @xmath44 @xmath45 .",
    "then the linear operator @xmath46 , defined in  , is compact .    for any @xmath47",
    ", we define @xmath48 since @xmath40 and @xmath41 are bounded , we conclude that @xmath49 is bounded , by boundedness of @xmath50 , and therefore @xmath51 .",
    "therefore , the operator @xmath52 defined as @xmath53 is a hilbert - schmidt integral operator and hence a compact operator .",
    "let @xmath54 be a sufficiently large ball that contains @xmath50 , that is , @xmath55 .",
    "for any @xmath56 , we have that @xmath57 where the last step comes from the young s convolution theorem .",
    "this implies that , when @xmath58 , we have @xmath59 therefore , @xmath60 as @xmath58 . since @xmath52 is compact for each @xmath47 ,",
    "we conclude , by for instance  ( * ? ? ?",
    "* chapter 3 , theorem 5 ) , that @xmath26 is compact .    from ( [ eq : ert intgrl u ] )",
    ", we can obtain that @xmath61 where @xmath62 .",
    "the operator @xmath63 is a fredholm operator , and by fredholm alternative theorem and the fact that the ert admits only the zero solution when @xmath64 , see for instance  @xcite , we conclude that there is a unique solution to  .",
    "let us finish this section with the following important observation .",
    "the kernel   for the volume integral equation that we derived here takes the same form in the cases of homogeneous ( i.e. @xmath40 and @xmath41 do not depend on spatial variable ) and inhomogeneous ( i.e. @xmath40 and @xmath41 depend on spatial variable ) media .",
    "this means that the algorithm that we present in the next sections work for both homogeneous and inhomogeneous media , even though in the case of homogeneous media some simplifications can be made to reduce the computational costs of the algorithm .",
    "this is quite different for integral formulations of many other problems , such as the helmholtz or the laplace equation where only homogeneous problems can be done with explicit kernels ( that are mostly the corresponding green functions )  @xcite .",
    "our strategy of solving the ert   is to first solve for @xmath43 and then solve for @xmath14 from @xmath43 .",
    "the main solution procedure is as follows .",
    "* algorithm i : general solution procedure *    1 .",
    "evaluate the source function @xmath65 analytically , or by : 1 .   solving the following scattering - free transport equation for @xmath66 : @xmath67 2 .",
    "evaluating @xmath68 .",
    "2 .   use a krylov subspace method , such as the gmres  algorithm or the minres  algorithm  @xcite , to solve the integral equation   for @xmath43 .",
    "3 .   recover the ert solution @xmath14 by 1 .",
    "evaluating the source @xmath69 ; 2 .   solving the following scattering - free transport equation for @xmath14 : @xmath70    the solution of the scattering - free transport equations in the first and last steps can be done efficiently with a fast sweeping method such as that in  @xcite or even analytically in special cases .",
    "therefore , our focus here will be on the solution of the integral equation in the second step .",
    "let us remark that one feature of the above method for solving the ert   is that it _ does not _ require an explicit discretization over the angular variable .",
    "it is clear that the main computational cost of the algorithm is on the solution of the integral equation   which involves only the spatial variable .",
    "therefore , besides the solution of the scattering - free transport equation , the computational complexity of the algorithm _ does not _ scale with the size of the angular discretization . in many applications , the main quantities of interests",
    "is the local density @xmath23 , not @xmath71 . in these cases ,",
    "the @xmath72 step of algorithm i is not necessary .",
    "the computational complexity of the algorithm therefore is completely independent of the angular discretization .",
    "for the same reason , the storage requirement of the algorithm also depends only on the spatial discretization .",
    "there are many existing methods for the discretization of the integral equation   with weakly singular kernel @xmath73 ; see for instance  @xcite and references therein . here",
    "we assume that we have a spatial discretization , consisting of @xmath74 nodes , of the integral equation   that gives us the following approximation to the integral equation @xmath75 with @xmath76 the weight for the @xmath77-th point . since @xmath33 is singular at @xmath78 , we set @xmath79 in the above summation and use the weight @xmath80 to control the self - contribution of @xmath81 to the summation .",
    "to solve the integral equation @xmath82 with a gmres  or minres  algorithm , we need to be able to evaluate matrix - vector product of the form @xmath83 for different vectors @xmath43 .",
    "therefore , the main computational cost will be determined by the computational cost of the evaluation of @xmath84 , that is the summation  .",
    "direct evaluation of such a summation takes @xmath85 operations in general . in this work",
    ", we use the fast multipole method ( fmm ) , originally developed by greengard and rokhlin  @xcite , to accelerate the evaluation of this matrix - vector product . for the simplicity of implementation",
    ", we use an interpolation - based fmm that was proposed by fong and darve in  @xcite .",
    "other efficient implementations of fmm , see for instance  @xcite and references therein , may also be applied to our problem here .",
    "this will be a future work .",
    "the fmm method in  @xcite , based on chebyshev interpolation , works as follows .",
    "let @xmath86 be the first - kind chebyshev polynomial of degree @xmath87 defined on @xmath88 $ ] .",
    "define the function @xmath89 with the conventions @xmath90 and @xmath91 .",
    "then a two - variable kernel @xmath73 , assuming to be smoothed enough , on @xmath88^d\\times [ -1 , 1]^d$ ] can be approximated by the following interpolation formula  @xcite @xmath92 where @xmath93 , @xmath94 being the set of chebyshev interpolation notes which are simply taken as the set of the @xmath95-dimensional tensor product of the chebyshev nodes of @xmath96 .",
    "the same approximation can be constructed when the kernel @xmath33 is defined on any regular domains by a linear transform .",
    "if we now plug the approximation   into the summation  , we have , after a slight re - arrangement , the following formula @xmath97 this formula allows us to evaluate @xmath84 efficiently in three steps by simply following the order of the summations : ( i ) evaluate @xmath98 , @xmath99 ; ( ii ) evaluate @xmath100 , @xmath101 ; and then ( iii ) evaluate @xmath102 , @xmath103 .",
    "if the computational cost of the evaluations of the interpolation polynomial @xmath104 and the kernel @xmath33 do not scale with @xmath105 and @xmath74 , then the costs of the three steps scale as @xmath106 , @xmath107 and @xmath106 respectively . therefore , the total cost scales as @xmath108 when @xmath109 is sufficiently small .    in our implementation of the fong - darve fmm algorithm  @xcite , we follow the standard multilevel approach with tree structures",
    "the only specialty for our implementation is the related to the evaluation of the kernel @xmath110 for the pair @xmath111 which we describe in the next section .",
    "we now briefly comment on some important issues on the implementation of the algorithm we described in the previous section .",
    "[ [ validity - of - low - rank - approximation . ] ] validity of low rank approximation  .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    due to boundedness of the exponential factor @xmath29 at @xmath78 and the fact that @xmath29 decays as a function of @xmath112 , our kernel @xmath113 in   should admit the same if not better low - rank approximation as the kernel @xmath114 which has been well - studied in the fast multipole method community  @xcite .",
    "this justifies the chebyshev interpolation in  .",
    "[ [ the - computational - cost . ] ] the computational cost .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    the mostly computationally expensive step of the fmm algorithm is step ( ii ) of evaluating   where we have to evaluate the integral kernel @xmath33 for different @xmath115 pairs .",
    "each evaluation of the kernel requires the evaluation of a line integral of the total absorption coefficient @xmath40 along the line that connects @xmath12 and @xmath31 .",
    "if the integral can be analytically computed , for instance when @xmath40 is constant in which case the integral is simply @xmath116 , this evaluation is relatively cheap . otherwise , these evaluations have to be done numerically with selected quadrature rules .    in many practical applications ,",
    "the total absorption coefficient @xmath40 consists of a constant background with localized perturbations . in this case",
    ", we can think of @xmath40 as a function with the periodic boundary condition .",
    "we can therefore accelerate the evaluation of the line integrals with the technique of fast fourier transform ( fft ) .",
    "assume that @xmath40 is sufficiently smooth to allow for the @xmath117 term fourier representation : @xmath118 where @xmath119 is assumed to ensure that @xmath40 is real - valued .",
    "it is then straightforward to verify that the line integral of @xmath40 from @xmath12 to @xmath31 is given by @xmath120 where @xmath121 , @xmath122 , and @xmath123 for a given set of chebyshev interpolation points , we have a fixed number of pairs of @xmath115 for which we need to evaluate @xmath113 . in our implementation",
    ", we cache all these kernel evaluations .",
    "these kernel evaluations will be reused without any extra calculations during the gmres  iterations ; see for instance the numerical results in tab .  [",
    "tab : con coeff ] and tab .",
    "[ tab : var coeff ] of section  [ sec : num ] .",
    "[ [ fmm - approximation - accuracy . ] ] fmm approximation accuracy .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    the accuracy of solution to the ert   with our numerical procedure depends mainly on two factors : the resolution of the spatial discretization , and the accuracy of the fast multipole approximation of the summation  , the latter relying on the order of the chebyshev polynomial used .",
    "increasing the order of the polynomial will increase the accuracy of the approximation in general .",
    "however , that will also increase the computational cost of the algorithm , due to the increase of cost in evaluating @xmath104 for instance .",
    "we have to therefore balance between accuracy and cost .",
    "compared to existing kernels that have been studied the fmm community , our kernel here decays faster when the total absorption @xmath40 is large .",
    "we therefore have to use more chebyshev interpolation points in general to ensure accuracy of the approximation .",
    "let @xmath124 be the numerical solution with a direct evaluation of the summation in   and @xmath125 the fmm - accelerated numerical solution .",
    "when @xmath124 and @xmath125 solutions are computed on the same mesh , the finer mesh will produce larger error @xmath126 when the same number of interpolation points is used .",
    "this is because finer mesh provides structures that are harder to capture with the same interpolation polynomial .",
    "moreover , the accuracy of approximating @xmath124 by @xmath125 depends on the total absorption coefficient @xmath40 since the larger @xmath40 is , the faster the exponential decay is in the integral kernel .",
    "therefore , for the same order of interpolation , the larger @xmath40 is , the worse the approximation is .",
    "we observe these phenomenon in our numerical experiments ; see for instance , the simulations in section  [ sec : num ] .",
    "0.5 cm     we now present some numerical simulations to demonstrate the performance of our algorithm .",
    "we focus on the comparison between the algorithm for solving   with a regular gmres  solver and with our algorithm , i.e. , a gmres  solver with fmm accelerations on the evaluation of  .",
    "our main purpose is to demonstrate that the computational complexity of the fmm - accelerated gmres  algorithm indeed scales linearly with respect to the size of the spatial discretization , while maintains desired accuracy .",
    "this means that the main cost of our algorithm for solving the ert   is independent of the angular discretization .    in all the simulations , we nodimensionalize the transport equation .",
    "all the simulations are done in the fixed square domain @xmath127 with physical absorption coefficient @xmath128 .",
    "we vary the scattering coefficient to test the performance of the algorithm in different regimes .",
    "the larger the scattering coefficient @xmath40 is , the more diffusive the solution of the ert behaves , since the size of the domain and the physical absorption coefficient are fixed .",
    "however , as we will see , the performance of our algorithm does not change dramatically from the low scattering transport regime to the highly scattering diffusive regime .",
    "we introduce four time measures : ( i ) @xmath129 denotes the time cost of direct summation for  ; ( ii ) @xmath130 denotes the time cost of fmm evaluation of  ; ( iii ) @xmath131 denotes the time cost of the gmres  algorithm with direct summation for solving  ; and ( iv ) @xmath132 denotes the time cost of the gmres  algorithm with fmm - acceleration for solving  . note that in our computations , we have cached all the line integrals needed when setting up the algorithm .",
    "therefore , the @xmath133 ( resp .",
    "@xmath134 ) does not include @xmath130 ( resp .",
    "@xmath129 ) .",
    "all the computational times shown below are based on a dell optiplex 745 pentium d 3.4ghz desktop with 16 gb ram .    to measure the accuracy of the fmm - accelerated calculation , with respect to the solution of the regular discretization",
    ", we use the relative @xmath135 error @xmath136 where @xmath124 and @xmath125 are respectively the solutions with the direct gmres  algorithm and the fmm - accelerated gmres  algorithm .",
    "l*6cl @xmath74 & @xmath137 & @xmath138 & @xmath139 & @xmath140 & @xmath141 & relative error    ' '' ''    ' '' ''     +    ' '' ''    1,024 & 4 & 1.20e @xmath142 01 & 3.51e @xmath142 02 & 1.18e @xmath143 00 & 3.71e @xmath143 00 & 2.17e @xmath142 04 + 4,096 & 4 & 6.65e @xmath142 01 & 1.25e @xmath142 01 & 4.02e @xmath143 01 & 6.23e @xmath143 01 & 3.39e @xmath142 04 + 16,384 & 4 & 3.25e @xmath143 00 & 4.98e @xmath142 01 & 1.09e @xmath143 03 & 9.93e @xmath143 02 & 3.90e @xmath142 04 + 65,536 & 4 & 1.50e @xmath143 01 & 2.04e @xmath143 00 &  &  &  + 262,144 & 4 & 6.29e @xmath143 01 & 1.00e @xmath143 01 &  &  & ",
    "+   + 1,024 & 6 & 2.38e @xmath142 01 & 4.95e @xmath142 02 & 1.18e @xmath143 00 & 3.71e @xmath143 00 & 2.06e @xmath142 06 + 4,096 & 6 & 1.38e @xmath143 00 & 1.61e @xmath142 01 & 4.02e @xmath143 01 & 6.23e @xmath143 01 & 3.02e @xmath142 06 + 16,384 & 6 & 8.23e @xmath143 00 & 8.83e @xmath142 01 & 1.09e @xmath143 03 & 9.93e @xmath143 02 & 3.18e @xmath142 06 + 65,536 & 6 & 3.59e @xmath143 01 & 2.89e @xmath143 00 &  &  &  + 262,144 & 6 & 1.59e @xmath143 02 & 1.23e @xmath143 01 &  &  &  +   + 1024 & 9 & 5.43e @xmath142 01 & 1.32e @xmath142 01 & 1.18e @xmath143 00 & 3.71e @xmath143 00 & 9.90e @xmath142 16 + 4096 & 9 & 3.64e @xmath143 00 & 5.29e @xmath142 01 & 4.02e @xmath143 01 & 6.23e @xmath143 01 & 4.24e @xmath142 09 + 16,384 & 9 & 2.17e @xmath143 01 & 2.80e @xmath143 00 & 1.09e @xmath143 03 & 9.93e @xmath143 02 & 4.47e @xmath142 09 + 65,536 & 9 & 1.10e @xmath143 02 & 1.09e @xmath143 01 &  &  &  + 262,144 & 9 & 5.76e @xmath143 02 & 4.87e @xmath143 01 &  &  &  +    [ [ experiment - i . ] ] experiment i. + + + + + + + + + + + + +    in the first set of numerical experiments , we perform simulations with a fixed scattering coefficient @xmath144 and total absorption coefficient @xmath145 ( which means the physical absorption is @xmath146 ) .",
    "the source function we used is a ring source illustrated in the left plot of fig .",
    "[ fig : sources ] . in tab .",
    "[ tab : con coeff ] we show comparisons in three groups with increasing number of chebyshev interpolation points : @xmath147 , @xmath148 and @xmath149 .",
    "we first note that , with reasonable relative approximation accuracy ( on the order of @xmath150 with @xmath147 ) , the ffm - gmres  algorithm outperforms the regular gmres  algorithm dramatically .",
    "this trend is kept when we increase the accuracy of the fmm approximation by increasing , @xmath137 , the number of chebyshev interpolation points .",
    "when the spatial discretization is too fine , it takes the regular gmres  algorithm too much time to finish the calculations .",
    "however , the ffm - accelerated gmres  can still solve the system in relatively short time .",
    "l*6cl @xmath74 & n & @xmath138 & @xmath139 & @xmath140 & @xmath141 & relative error    ' '' ''    ' '' ''     +    ' '' ''    1,024 & 4 & 2.01e @xmath142 01 & 3.07e @xmath142 02 & 8.46e @xmath142 01 & 1.94e @xmath143 00 & 2.16e @xmath142 04 + 4,096 & 4 & 1.12e @xmath143 00 & 9.55e @xmath142 02 & 2.88e @xmath143 01 & 3.26e @xmath143 01 & 3.23e @xmath142 04 + 16,384 & 4 & 5.26e @xmath143 00 & 3.52e @xmath142 01 & 7.78e @xmath143 02 & 5.20e @xmath143 02 & 3.69e @xmath142 04 + 65,536 & 4 & 2.35e @xmath143 01 & 1.62e @xmath143 00 &  &  &  + 262,144 & 4 & 1.01e @xmath143 02 & 6.64e @xmath143 00 &  &  & ",
    "+   + 1,024 & 6 & 3.19e @xmath142 01 & 2.15e @xmath142 02 & 8.46e @xmath142 01 & 1.94e @xmath143 00 & 1.73e @xmath142 05 + 4,096 & 6 & 2.37e @xmath143 00 & 1.27e @xmath142 01 & 2.88e @xmath143 01 & 3.26e @xmath143 01 & 1.36e @xmath142 05 + 16,384 & 6 & 1.30e @xmath143 01 & 5.23e @xmath142 01 & 7.78e @xmath143 02 & 5.20e @xmath143 02 & 6.83e @xmath142 06 + 65,536 & 6 & 6.24e @xmath143 01 & 2.22e @xmath143 00 &  &  &  + 262,144 & 6 & 2.89e @xmath143 02 & 9.79e @xmath143 00 &  &  &  +   + 1024 & 9 & 7.40e @xmath142 01 & 8.72e @xmath142 02 & 8.46e @xmath142 01 & 1.94e @xmath143 00 & 2.71e @xmath142 15 + 4096 & 9 & 7.01e @xmath143 00 & 4.44e @xmath142 01 & 2.88e @xmath143 01 & 3.26e @xmath143 01 & 4.84e @xmath142 06 + 16,384 & 9 & 4.18e @xmath143 01 & 2.32e @xmath143 00 & 7.78e @xmath143 02 & 5.20e @xmath143 02 & 3.09e @xmath142 06 + 65,536 & 9 & 2.10e @xmath143 02 & 1.05e @xmath143 01 &  &  &  + 262,144 & 9 & 1.02e @xmath143 03 & 4.85e @xmath143 01 &  &  &  +    [ [ experiment - ii . ] ] experiment ii .",
    "+ + + + + + + + + + + + + +    in the second set of numerical experiments , we repeat the simulations in experiment i for an inhomogeneous medium . the coefficients are given as @xmath151 we again use the a ring source illustrated in the left plot of fig .",
    "[ fig : sources ] . in tab .",
    "[ tab : var coeff ] we show comparison in three groups with increasing number of chebyshev interpolation points .",
    "the first noticeable difference between tab .",
    "[ tab : var coeff ] and tab .",
    "[ tab : con coeff ] is that the time it takes to evaluate the matrix - vector multiplication is now considerably more expensive .",
    "this is mainly due to the fact that for variable coefficient , we need to evaluate the integrals by numerical quadrature rules , while in the constant coefficient case the kernels are given analytically for any pair @xmath115 . in our implementation , we cached all",
    "the line integrals so that they can be used repeatedly during gmres  iterations .",
    "this is the reason why the solution costs @xmath133 for variable coefficient cases in tab .",
    "[ tab : var coeff ] is very similar to the corresponding constant coefficient cases in tab  [ tab : con coeff ] .",
    "the overall computational costs again scale linearly with respect to the spatial discretization .",
    "l*6cl @xmath74 & n & @xmath40 & @xmath41 & relative error    ' '' ''    ' '' ''     + 1024 & 4 & 2.2 & 2.0 & 8.39e @xmath142 05 + 1024 & 4 & 5.2 & 5.0 & 1.93e @xmath142 04 + 1024 & 4 & 10.2 & 10.0 & 4.13e @xmath142 04 +   + 1024 & 6 & 2.2 & 2.0 & 8.85e @xmath14207 + 1024 & 6 & 5.2 & 5.0 & 1.82e @xmath14206 + 1024 & 6 & 10.2 & 10.0 & 5.15e @xmath14206 +   + 1024 & 9 & 2.2 & 2.0 & 5.02e @xmath14216 + 1024 & 9 & 5.2 & 5.0 & 7.91e @xmath14216 + 1024 & 9 & 10.2 & 10.0 & 1.17e @xmath14215 +    l*6cl @xmath74 & n & @xmath40 & @xmath41 & relative error    ' '' ''    ' '' ''     + 4096 & 4 & 2.2 & 2.0 & 1.15e @xmath142 04 + 4096 & 4 & 5.2 & 5.0 & 3.07e @xmath142 04 + 4096 & 4 & 10.2 & 10.0 & 9.08e @xmath142 04 +   + 4096 & 6 & 2.2 & 2.0 & 1.27e @xmath142 06 + 4096 & 6 & 5.2 & 5.0 & 2.79e @xmath142 06 + 4096 & 6 & 10.2 & 10.0 & 9.62e @xmath142 06 +   + 4096 & 9 & 2.2 & 2.0 & 1.39e @xmath142 08 + 4096 & 9 & 5.2 & 5.0 & 2.46e @xmath142 08 + 4096 & 9 & 10.2 & 10.0 & 6.86e @xmath142 08",
    "+    l*6cl @xmath74 & n & @xmath40 & @xmath41 & relative error    ' '' ''    ' '' ''     + 16384 & 4 & 2.2 & 2.0 & 1.26e @xmath142 04 + 16384 & 4 & 5.2 & 5.0 & 3.60e @xmath142 04 + 16384 & 4 & 10.2 & 10.0 & 1.20e @xmath142 03 +   + 16384 & 6 & 2.2 & 2.0 & 1.30e @xmath142 06 + 16384 & 6 & 5.2 & 5.0 & 2.92e @xmath142 06 + 16384 & 6 & 10.2 & 10.0 & 1.04e @xmath142 05 +   + 16384 & 9 & 2.2 & 2.0 & 1.82e @xmath142 08 + 16384 & 9 & 5.2 & 5.0 & 3.20e @xmath142 08 + 16384 & 9 & 10.2 & 10.0 & 9.71e @xmath142 08 +    . from top to bottom : @xmath144 , @xmath152 and @xmath153 . shown",
    "are ( from left to right ) : the solution @xmath124 and the error @xmath126 with @xmath147 , @xmath148 , and @xmath149 . ]     except that @xmath154 . ]     except that @xmath155 . ]",
    "[ [ experiment - iii . ] ] experiment iii .",
    "+ + + + + + + + + + + + + + +    in the third set of numerical experiments , we study the dependence of the computational cost of the algorithm on the scattering coefficient of the ert . we perform simulations using the source function that is illustrated in the right plot of fig .",
    "[ fig : sources ] .",
    "the results are summarized in tab .",
    "[ tab : periodic conv para-1024 ] , tab .",
    "[ tab : periodic conv para-4096 ] and tab .",
    "[ tab : periodic conv para-16384 ] for different scattering coefficients , @xmath156 , @xmath157 , and @xmath158 , with different levels of spatial discretizations .",
    "the solution by the gmres  algorithm with direct summation   @xmath124 as well as the error @xmath126 ( with @xmath125 being the solution with a fmm - accelerated gmres  algorithm ) are shown in fig .",
    "[ fig : periodic 1024 ] , fig .",
    "[ fig : periodic 4096 ] , and fig .",
    "[ fig : periodic 16384 ] respectively for the domain with @xmath159 , @xmath160 and @xmath161 cells , using different numbers of chebyshev interpolation points .",
    "the results show that the error of the fmm approximation does not change dramatically with respect to the change of the scattering coefficient .",
    "that is , the algorithm we developed works in both diffusive regimes and transport regimes , as long as the medium is isotropic .",
    "l*6cl @xmath74 & n & @xmath40 & @xmath41 & relative error    ' '' ''    ' '' ''     + 1024 & 4 & 2.2 & 2.0 & 9.53e @xmath142 05 + 1024 & 4 & 5.2 & 5.0 & 2.13e @xmath142 04 + 1024 & 4 & 10.2 & 10.0 & 4.50e @xmath142 04 +   + 1024 & 6 & 2.2 & 2.0 & 1.19e @xmath14206 + 1024 & 6 & 5.2 & 5.0 & 2.09e @xmath14206 + 1024 & 6 & 10.2 & 10.0 & 5.53e @xmath14206 +   + 1024 & 9 & 2.2 & 2.0 & 7.71e @xmath14216 + 1024 & 9 & 5.2 & 5.0 & 8.47e @xmath14216 + 1024 & 9 & 10.2 & 10.0 & 1.10e @xmath14215 +    l*6cl @xmath74 & n & @xmath40 & @xmath41 & relative error    ' '' ''    ' '' ''     + 4096 & 4 & 2.2 & 2.0 & 1.24e @xmath142 04 + 4096 & 4 & 5.2 & 5.0 & 3.28e @xmath142 04 + 4096 & 4 & 10.2 & 10.0 & 9.58e @xmath142 04 +   + 4096 & 6 & 2.2 & 2.0 & 1.48e @xmath142 06 + 4096 & 6 & 5.2 & 5.0 & 2.99e @xmath142 06 + 4096 & 6 & 10.2 & 10.0 & 1.01e @xmath142 05 +   + 4096 & 9 & 2.2 & 2.0 & 1.85e @xmath142 08 + 4096 & 9 & 5.2 & 5.0 & 2.94e @xmath142 08 + 4096 & 9 & 10.2 & 10.0 & 7.68e @xmath142 08 +    [ [ experiment - iv . ] ] experiment iv .",
    "+ + + + + + + + + + + + + +    we repeat here the numerical simulations in experiment iii with a different source function , the source function in the left plot of fig .  [",
    "fig : sources ] .",
    "the relative error of the fmm - accelerated solutions are summarized in tab .",
    "[ tab : ring conv para-1024 ] , tab .",
    "[ tab : ring conv para-4096 ] , and tab .",
    "[ tab : ring conv para-16384 ] .",
    "the results are very similar respectively to those showed in tab .",
    "[ tab : periodic conv para-1024 ] , tab .",
    "[ tab : periodic conv para-4096 ] , and tab .",
    "[ tab : periodic conv para-16384 ] .",
    "this shows again that the performance of the algorithm does not depend on the strength of the scattering of the underlying medium .",
    "overall , in either diffusive or transport regime , we can achieve very good accuracy with only a few chebyshev interpolation points in each direction .",
    "the solution by the gmres  algorithm with the direct summation , @xmath162 and the error @xmath163 are show in fig .",
    "[ fig : ring 1024 ] and fig .",
    "[ fig : ring 4096 ] .    l*6cl @xmath74 & n & @xmath40 & @xmath41 & relative error    ' '' ''    ' '' ''     + 16384 & 16 & 2.2 & 2.0 & 1.35e @xmath14204 + 16384 & 16 & 5.2 & 5.0 & 3.82e @xmath14204 + 16384 & 16 & 10.2 & 10.0 & 1.20e @xmath14203 +   + 16384 & 36 & 2.2 & 2.0 & 1.51e @xmath14206 + 16384 & 36 & 5.2 & 5.0 & 3.14e @xmath14206 + 16384 & 36 & 10.2 & 10.0 & 1.09e @xmath14205 +   + 16384 & 64 & 2.2 & 2.0 & 2.19e @xmath14208 + 16384 & 64 & 5.2 & 5.0 & 3.60e @xmath14208 + 16384 & 64 & 10.2 & 10.0 & 1.05e @xmath14207 +     with the source in the left plot of fig .",
    "[ fig : sources ] . from top to bottom : @xmath144 , @xmath152 and @xmath153 . shown",
    "are ( from left to right ) : the solution @xmath124 and the error @xmath126 with @xmath147 , @xmath148 , and @xmath149 . ]     except that @xmath154 . ]",
    "to summarize , we presented in this work a fast numerical method for solving the equation of radiative transfer in isotropic media .",
    "the main idea of the method is to reformulate the ert into an integral equation of the second type and then use the fast multipole technique to accelerate the solution of such an integral equation .",
    "our numerical tests show that the algorithmic cost indeed scales linearly with respect to the size of the spatial component of the problem .",
    "there are a few features of the method we proposed here .",
    "first , with the integral formulation , we avoid angular discretization of the ert in the most expensive part of the solution process .",
    "this in principle allows us to handle large problems that would be hard to handle in , for instance , the discrete ordinate formulation , with limited ram .",
    "second , the kernel in our integral formulation of the ert takes the same form for homogeneous and inhomogeneous media .",
    "therefore , the algorithm we developed does not need to be modified going from homogeneous media problems to inhomogeneous media problems .",
    "this is quite different from existing fast multipole based methods .",
    "that said , in homogeneous media , the setup of our algorithm is relatively computationally inexpensive since the kernel in the corresponding integral equation is explicitly given .",
    "in inhomogeneous media , the setup requires the evaluation of the kernel for different @xmath164 pairs that involves line integrals of the total absorption coefficients between @xmath12 and @xmath31 .",
    "this evaluation is more expensive than the homogeneous media case , but is still relatively low . in many practically relevant problems",
    ", we have coefficients that can be treated as periodic functions .",
    "fast fourier transform type of techniques can be used to accelerate the setup process of the algorithm . in our implementation of the fmm algorithm",
    ", we cached all the calculations that involve the evaluation of the line integrals .",
    "this does not cause major storage problem since the number of chebyshev interpolation nodes used in the implementation is always relatively small .",
    "let us also emphasize that , even though our formulation requires that the underlying medium to be isotropic , the internal and boundary source functions need not to be isotropic at all .",
    "in fact , the only thing that would have changed for the algorithm with an anisotropic source is the evaluation of @xmath165 .",
    "in addition , as we have seen from our numerical tests , the fmm approximation with a very small number of chebyshev interpolation nodes already give relatively accuracy approximations to the true numerical solutions .",
    "this suggests that we can probably use the algorithm with small numbers of chebyshev interpolation points as a preconditioning strategy for a general transport solver for more complicated problems .",
    "we are currently exploring in this direction .",
    "to the best of our knowledge , what we proposed is the first algorithm for solving the ert within the frame work of the fast multipole method .",
    "our contribution is mainly on the introduction of the idea , not on the implementation of fast multipole methods .",
    "indeed , our implementation is rather primitive which we believe can be greatly improved , either by refining the current strategy or by exploring other approaches  @xcite .",
    "the study we have in this short paper is by no means enough to draw conclusions on every aspect of the algorithm , for instance how the algorithm benchmarks with existing methods .",
    "however , numerical simulations we have performed show that this is a promising method that is worth careful further investigated .",
    "we hope that this work can motivate more studies in this direction .",
    "this work is partially supported by the national science foundation through grants dms-1321018 and dms-1620473 .                                                                                                                                        , _ a kinetic theory for nonanalog monte carlo particle transport algorithms : exponential transform with angular biasing in planar - geometry anisotropically scattering media _ , j. comp .",
    "phys . , 145 ( 1998 ) , pp ."
  ],
  "abstract_text": [
    "<S> we propose in this work a fast numerical algorithm for solving the equation of radiative transfer ( ert ) in isotropic media . </S>",
    "<S> the algorithm has two steps . in the first step , </S>",
    "<S> we derive an integral equation for the angularly averaged ert solution by taking advantage of the isotropy of the scattering kernel , and solve the integral equation with a fast multipole method ( fmm ) . in the second step , </S>",
    "<S> we solve a scattering - free transport equation to recover the original ert solution . </S>",
    "<S> numerical simulations are presented to demonstrate the performance of the algorithm for both homogeneous and inhomogeneous media .    </S>",
    "<S> equation of radiative transfer , integral equation , fast algorithm , fast multipole method , preconditioning .    65f08 , 65n22 , 65n99 , 65r20 , 45k05 </S>"
  ]
}