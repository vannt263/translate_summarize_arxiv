{
  "article_text": [
    "the usual way to approach the control of the guidance of satellites consists of considering separately the attitude and the trajectory dynamics .",
    "however , for the launchers like ariane or pegasus , the trajectories are controlled by their attitude angles , and it is desirable to determine the optimal control subject to the coupled dynamical system .",
    "thus , we consider the time minimum control of the attitude reorientation of a rocket taking in consideration both the attitude movement and the trajectory dynamics .",
    "we denote this problem as @xmath0 .",
    "our objective is to design an efficient numerical strategy to solve the problem @xmath0 .",
    "there are two main types of numerical approaches to solve an optimal control problem . on the one part , the direct methods ( see , e.g. , @xcite ) consist of discretizing the state and the control and thus of reducing the problem to a nonlinear optimization problem ( nonlinear programming ) with constraints . on the other part , the indirect methods consist of numerically solving a boundary value problem obtained by applying pontryagin maximum principle ( pmp , see @xcite ) , by means of a shooting method .",
    "both direct and indirect methods are not easy to initialize successfully , it is required to combine them with other theoretical or numerical approaches ( see the survey @xcite ) .",
    "the numerical continuation is a powerful tool to be combined with the indirect shooting method based on the pontryagin maximum principle .",
    "the idea of _ continuation _ is to solve a problem step by step from a simpler one by parameter deformation ( see e.g. @xcite ) .",
    "for example , in @xcite , the continuation method is used to solve difficult orbit transfer problems . here",
    ", we will use numerical continuation to numerically solve the problem .",
    "indeed , the coupling of the attitude movement ( fast ) with the trajectory dynamics ( slow ) in the problem @xmath0 generates difficulties in numerical approaches , especially in the indirect methods , where the newton - like methods are used to solve the boundary value problem . moreover , this property makes the numerical approaches extremely difficult to be initialized .",
    "another difficulty in numerically solving the problem @xmath0 is the chattering phenomenon . _",
    "chattering _ means that the control switches an infinite number of times over a compact time interval .",
    "such a phenomenon typically occurs when trying to connect bang arcs with a higher - order singular arc ( see , e.g. , @xcite ) .",
    "we proved in @xcite that there exists such a chattering phenomenon in the problem @xmath0 , and the chattering phenomenon is a bad news when applying numerical approaches .    in view of these difficulties ,",
    "we propose an efficient numerical continuation procedure to compute optimal and sub - optimal trajectories for the problem @xmath0 . due to the chattering phenomenon , numerical continuation combined with shooting can not give an optimal solution to the problem for certain terminal conditions for which the optimal trajectory contains a singular arc of higher - order . in that case",
    ", our indirect approach generates sub - optimal solutions , by stopping the continuation procedure before its failure due to chattering .",
    "our objective is to design and implement a numerical method having the following qualities : general ( vehicle features , terminal conditions ) , robust , fast and automatic , so that it could be used efficiently by an inexperienced user on a large scope of applications of the real world .",
    "numerical experiments indicates that this approach happens to meet to all the expected features .",
    "the paper is organized as follows . in section [ pbstate ] , we establish the model of the rocket movement and we formulate the problem @xmath0 . in section [ there s ] ,",
    "the pmp is applied to the problem @xmath0 and some theoretical results on the extremals are introduced . in section [ auxipro ] , two auxiliary problems are introduced and the continuation procedure is stated .",
    "some numerical tips improving the proposed numerical strategy are also presented .",
    "finally in section [ chp_numerical ] , numerical results are given .",
    "we will consider two types of launchers : one is a classical launcher like ariane rocket , the other one is an airborne launcher like pegasus rocket ( being launched horizontally from an airplane ) . in the case of an ariane - type launcher ,",
    "the aerodynamical forces are very small compared with its thrust and the gravity , and so we ignore them . however , in case of a pegasus - type launcher , we will need to add the aerodynamical forces to the model . throughout the paper",
    ", we make the following assumptions :    * the earth is a sphere and is fixed in the inertial space .",
    "* the position and the mass of the rocket are constant during the maneuver . * the rocket is an axial symmetric cylinder . *",
    "the rocket engine can not be shut off during the maneuver and the module of the thrust force is constant , taking its maximum value , i.e. , @xmath1 .",
    "all the coordinate systems introduced here are cartesian coordinate systems .",
    "the * launch frame * ( reference frame ) @xmath2 is fixed around the launch point @xmath3 ( where the rocket is launched ) .",
    "the axis @xmath4 is pointing radially outwardly ( normal to the local tangent plane ) , and the axis @xmath5 points to the north .",
    "the * body frame * @xmath6 is defined as follows .",
    "the origin of the frame @xmath7 is fixed around the mass center of the rocket , the axis @xmath8 is along the axis - symmetric axis of the rocket , and the axis @xmath9 is in the cross - section .",
    "the body frame can be derived by three ordered unit single - axis rotations from the launch frame , @xmath10 where @xmath11 is the pitch angle , @xmath12 is the yaw angle , @xmath13 is the roll angle and @xmath14 means to rotate the frame around the axis @xmath15 by an angle @xmath16 .",
    "therefore , the transfer matrix from @xmath17 to @xmath18 is @xmath19 .",
    "the * velocity frame * @xmath20 is fixed around the mass center of rocket .",
    "the axis @xmath21 is parallel to the velocity of the rocket @xmath22 , and the axis @xmath23 is normal to the velocity , pointing to the direction of the lift force @xmath24 of the rocket .",
    "this frame can be derived by two unit single - axis rotations from the launch frame , @xmath25 where @xmath26 is the flight path angle and @xmath27 is the bank angle of the flight .",
    "denote by @xmath28 the module of the velocity vector , i.e. , @xmath29 .",
    "since @xmath30 , we have @xmath31 this frame will be used to introduce aerodynamical forces ( lift @xmath24 and drag @xmath32 ) into the model .",
    "[ [ attitude - motion ] ] attitude motion + + + + + + + + + + + + + + +    the dynamical and kinematic equations of the attitude are @xmath33 where @xmath34 is the control input expressed in frame @xmath18 , @xmath35 is the angular velocity of the launcher @xmath36 expressed in frame @xmath18 ( assuming that there is no rotation along the asymptotical axis of the launcher ) , and @xmath37 is the angular acceleration constant depending on @xmath38 ( the maximum angle between the thrust @xmath39 and the axis @xmath8 ) , @xmath40 ( the inertia around the axis @xmath9 ) , @xmath41 ( the length of the rocket ) . note that @xmath42 .",
    "see @xcite for details of this model .",
    "[ [ trajectory - dynamics ] ] trajectory dynamics + + + + + + + + + + + + + + + + + + +    the drag @xmath32 and lift @xmath24 are calculated by @xmath43 , @xmath44 , where @xmath45 is the air density , @xmath46 is the reference surface , @xmath47 and @xmath48 are constant coefficients of the drag and the lift . in the velocity frame",
    "@xmath49 , the components of the vectors @xmath32 and @xmath24 are expressed as @xmath50 , @xmath51 where @xmath52 and @xmath53 . by using the transfer matrix from @xmath49 to @xmath17 , we get @xmath54 and so we get the trajectory dynamical equations in frame @xmath17 as @xmath55 where @xmath56 is the velocity of the launcher @xmath22 expressed in @xmath17 , @xmath57 is the gravity vector expressed in @xmath17 , @xmath58 is the thrust acceleration . for the ariane rocket , we do not consider the aerodynamical forces , i.e. , @xmath59 .      defining the state variable @xmath60 and the control variable @xmath61 as @xmath62 the initial conditions are defined by @xmath63 , @xmath64 , @xmath65 , @xmath66 , @xmath67 , @xmath68 , @xmath69 and @xmath70 , @xmath71    the desired final velocity is required to be parallel to the axis @xmath8 , according to @xmath72 .",
    "the constraints on the final conditions are defined by @xmath73 , @xmath74 , @xmath75 , @xmath76 and @xmath77 .",
    "@xmath78 note that the parallel condition on the final velocity is due to the fact that most rockets are planned to maintain a zero angle of attack along the flight .",
    "the angle of attack , when the wind is set to zero , is defined as the angle between the velocity and the rocket body axis .",
    "we set @xmath79 , and we define the target set @xmath80 the minimum time control problem @xmath0 consists of steering the system - from @xmath81 to the final target @xmath82 in minimum time @xmath83 , with controls satisfying the constraint @xmath84 .    for convenience",
    ", the velocity will be defined by polar coordinates , i.e. , @xmath85 , @xmath86 , @xmath87 , where @xmath88 and @xmath89 are  pitch \" and  yaw \" angles of the velocity vector .",
    "according to the pontryagin maximum principle ( pmp ) , the hamiltonian of the optimal control problem @xmath0 is @xmath90 where @xmath91 is the adjoint variable , @xmath92 is the derivative of the state variable @xmath60 , i.e. , @xmath93 and @xmath94 is a real number . here",
    "we assume @xmath95 ( see @xcite ) .",
    "the differential equation of the adjoint variable @xmath96 is given by the partial derivative of the hamiltonian as @xmath97    the maximization condition of the pmp yields , almost everywhere on @xmath98 $ ] ,",
    "@xmath99 whenever @xmath100 .",
    "here we have @xmath101 and @xmath102 .",
    "we call @xmath103 ( as well as its components ) the switching function",
    ".    moreover , we have the transversality condition @xmath104 , where @xmath105 is the tangent space to @xmath82 at the point @xmath106 , i.e. , @xmath107 and , the final time @xmath83 being free and the system being autonomous , we have also @xmath108 $ ] .",
    "the quadruple @xmath109 is called an extremal lift of @xmath110 .",
    "an extremal is said to be normal ( resp . ,",
    "abnormal ) if @xmath111 ( resp . ,",
    "@xmath112 ) .",
    "we say that an arc ( restriction of an extremal to a subinterval @xmath113 ) is _ regular _ if @xmath114 along @xmath113 .",
    "otherwise , the arc is said to be _",
    "singular_.    a _ switching time _ is a time @xmath115 at which @xmath116 , that is , both @xmath117 and @xmath118 vanish at time @xmath115 .",
    "an arc that is a concatenation of an infinite number of regular arcs over a compact time interval is said to be _",
    "the chattering arc is associated with a _ chattering control _ that switches an infinite number of times , over a compact time interval . a junction between a regular arc and a singular arc is said to be a _",
    "singular junction_.    when @xmath119 and @xmath120 , the explicit form of equation is given by @xmath121 we have shown in @xcite that the singular extremals of the problem @xmath0 are normal ones , i.e. , @xmath122 , and that they are of intrinsic order two . in that case",
    "the singular junction can only be realized by chattering , i.e. , if the singular junction happens at time @xmath123 and the control is regular on @xmath124 and is singular on @xmath125 , then the control has to switch an infinite number of times on @xmath126 , @xmath127 such that @xmath128 .    the concatenation of regular arcs are classified in @xcite by their contact with the switching surface ( filled by switching points ) , and we know that if the switching points of the problem @xmath0 are of order one , then the control will turn an angle @xmath129 when passing the switching surface .",
    "we will see this phenomenon in the numerical results .    actually , when @xmath130 and @xmath131 , the derivative of @xmath132 is no longer zero .",
    "however , the terms induced by the air draft and lift do not change the lie bracket configuration of the system , and thus the results obtained in @xcite are still valid .",
    "note again that the chattering causes hard problems when applying numerical methods . in that case",
    ", we can no longer obtain an optimal solution numerically .",
    "however , a sub - optimal solution can be derived by stopping the continuation procedure proposed in section [ indirecte_strategy ] before chattering occurs .",
    "to construct a suitable continuation procedure , we introduce two auxiliary problems .",
    "the first one is the _ problem of order zero _ , denoted by @xmath133 .",
    "the solution of this problem can be easily computed .",
    "then we just need to plug this simple , low - dimensional solution in higher dimension , in order to initialize an indirect method for the more complicated problem @xmath0 .",
    "the second one is the _",
    "regularized problem _ , which is used to overcome the chattering issues . since the solution of problem @xmath133",
    "is contained in the singular surface ( filled by the singular solutions ) for the problem @xmath0 , passing directly from the solution of problem @xmath133 to the problem @xmath0 makes the optimal extremals to contain a singular arc ( and thus chattering arcs ) , and the shooting method will certainly fail due to the numerical integration of discontinuous hamiltonian system .",
    "[ [ problem - of - order - zero . ] ] problem of order zero .",
    "+ + + + + + + + + + + + + + + + + + + + + +    we define the _ problem of order zero _ , as a `` subproblem '' of the complete problem @xmath0 , in the sense that we consider only the trajectory dynamics ( without aerodynamical forces ) and that we assume a perfect control meaning that the attitude angles ( euler angles ) take the desired values instantaneously .",
    "thus , the attitude angles are considered as control inputs in that simpler problem . denoting the rocket axial symmetric axis as @xmath134 and considering it as the control vector (",
    "which is consistent with the attitude angles @xmath11 , @xmath12 ) , we formulate the problem as follows : @xmath135 where @xmath136 is a given vector that refers to the desired target velocity direction .",
    "this problem is easy to solve , and the solution derived by applying the pmp is @xmath137 with @xmath138 , @xmath139 , @xmath140 , and @xmath141 .",
    "since the vector @xmath134 is expressed in the launch frame @xmath142 as @xmath143 , the euler angles @xmath144 can be calculated by assuming @xmath145 as @xmath146 where @xmath147 is the sign function , and @xmath148 the assumption of @xmath145 generally works for the ariane - type rockets since the maneuvers are generally quasi planar and the change in the yaw angle is small .",
    "however , for the pegasus - type rockets , which could make large yaw angle maneuvers , we have to consider also the case @xmath149 leading to @xmath150 both [ sing_angle_2 ] and and are possible solutions",
    ". we will choose the pair @xmath151 minimizing the value @xmath152 .    indeed , when @xmath153 , @xmath154 , the euler angles are not well defined , and if @xmath67 and @xmath74 are given near @xmath155 , we need to  change \" them to a be near @xmath155 .",
    "this is done in section [ precond ] below by transforming of the reference frame @xmath17 to a new reference frame @xmath156 .",
    "the singularities of euler angles are also treated in section [ singulareuler ] by calculating the limit values of the vector field at these singular points .",
    "given a real number @xmath157 , the optimal solution of the problem @xmath133 actually corresponds to a singular solution of @xmath0 with the terminal conditions given by @xmath158 @xmath159 @xmath160 it is worth nothing that this solution is lying in the singular surface of the problem @xmath0 meaning that it is on the  highway \" between two fixed points in the state space .",
    "on this  highway \" , the system goes the most rapidly towards to aimed final point or manifold .",
    "indeed , we observe in the numerical simulations that the singular extremals of the problem @xmath0 acts a role similar to that of the stable points in the  turnpike \" phenomenon as described in @xcite : the optimal trajectories first tend to reach the singular surface ( to have a greater speed in transferring its state ) , then stay in the singular surface for a while until it is sufficiently close to the target submanifold @xmath82 , and finally get off the singular surface to join the target submanifold .",
    "note that the singular arc is not necessary if the state is sufficiently close to the target .    in view of -",
    ", a natural continuation strategy is to simply vary the terminal conditions step by step until they correspond to @xmath82 .",
    "however , as we have mentioned , the chattering phenomenon causes the failure of this simple strategy , and thus we introduce another auxiliary problem , the regularized problem , in which the singular arcs of the problem @xmath0 become regular arcs , and thus the difficulty caused by chattering is bypassed .",
    "[ [ regularized - problem . ] ] regularized problem .",
    "+ + + + + + + + + + + + + + + + + + + +    let @xmath161 be arbitrary .",
    "the regularized problem @xmath162  consists of minimizing the cost functional @xmath163 for the system - , under the control constraints @xmath164 , @xmath165 , with terminal conditions - .",
    "note that , here , we replace the constraint @xmath166 with the constraints @xmath164 .",
    "the advantage , for this intermediate optimal control problem with the cost , is that the extremal controls are continuous .",
    "the hamiltonian is @xmath167 and according to the pmp , the optimal controls are @xmath168 where the saturation operator @xmath169 is defined by @xmath170 if @xmath171 ; @xmath172 if @xmath173 ; and @xmath174 if @xmath175 .",
    "indeed , an extremal of @xmath133 can be embedded into the problem @xmath162  by setting @xmath176 @xmath177 where @xmath178 and @xmath179 are given by and , with terminal conditions given by - .",
    "moreover , it is not a singular extremal for the problem @xmath162  .",
    "the extremal equations for @xmath162  are the same than for @xmath0 , as well as the transversality conditions .",
    "note that the difficulty caused by the chattering still exists when trying to go from the regularized problem back to the problem @xmath0 if there exists a singular arc in the optimal trajectory .",
    "however , in that case , by stopping at some point during the last continuation step ( see below ) , an acceptable sub - optimal trajectory will be found for the problem @xmath0 .",
    "the ultimate objective is to compute the optimal solution of the problem @xmath0 , starting from the explicit solution of @xmath133 .",
    "[ [ numerical - strategy ] ] numerical strategy + + + + + + + + + + + + + + + + + +    we proceed as follows :    * first , we embed the solution of @xmath133 into @xmath162  . for convenience , we still denote by @xmath133 the problem @xmath133 seen in high dimension . *",
    "then , we pass from @xmath133 to @xmath0 by means of a numerical continuation procedure , involving four continuation parameters : the first three parameters @xmath180 , @xmath181 and/or @xmath182 are used to pass continuously from the optimal solution of @xmath133 to the optimal solution of the regularized problem @xmath162  , for some fixed @xmath183 , and the last parameter @xmath184 is then used to pass to the optimal solution of @xmath0 ( see figure [ homotopie ] ) .",
    "the unknowns of the shooting problem are @xmath185 , @xmath186 , @xmath187 , @xmath188 , @xmath189 , @xmath190 , @xmath191 , @xmath192 and @xmath83 .",
    "when @xmath193 and @xmath194 , we have that @xmath195 , @xmath196 and @xmath197 are constants , hence by using the transversality condition , we can easily reduce the number of the unknowns by one . in view of more general cases , we will not do this reduction and we will use the transversality condition as a part of the shooting function . in the following ,",
    "we denote the continuation step corresponding to parameter @xmath198 by @xmath198-continuation .",
    "[ [ lambda_1-continuation - and - lambda_2-continuation ] ] @xmath180-continuation and @xmath181-continuation + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the parameter @xmath180 is used to act , by continuation , on the initial conditions , according to @xmath199 @xmath200 where @xmath201 , @xmath202 , and @xmath203 , @xmath204 are calculated through equation - .",
    "the shooting function @xmath205 for the @xmath180-continuation is defined by @xmath206 where @xmath207 with @xmath95 is calculated from and @xmath208 and @xmath209 are given by .",
    "note that we can use @xmath210 as shooting function owing to @xmath162  .",
    "for the problem @xmath0 , if @xmath211 , then together with @xmath212 and @xmath213 , the final point @xmath214 of the extremal is then lying on the singular surface and this will cause the failure of the shooting .",
    "however , for problem @xmath162  , even when @xmath106 belongs to the singular surface , the shooting problem can still be solved .",
    "initializing with the solution of @xmath133 , we can solve this shooting problem with @xmath215 , and we get a solution of @xmath162  with the terminal conditions - ( the other states at @xmath83 being free ) .",
    "then , by continuation , we make @xmath180 vary from @xmath216 to @xmath172 , and in this way we get the solution of @xmath162  for @xmath217 . with this solution",
    ", we can integrate extremal equations , and to get the values of the state variable at @xmath83 .",
    "we denote @xmath218 , @xmath219 , @xmath220 , @xmath221 and @xmath222 the  natural \" conditions obtained at the final time .    in a second step ,",
    "we use the continuation parameter @xmath181 to act on the final conditions , in order to make them pass from the  natural \" values @xmath223 , @xmath224 , @xmath225 , @xmath226 and @xmath227 , to the desired target values @xmath73 , @xmath74 , @xmath75 , @xmath228 and @xmath229 .",
    "the shooting function is @xmath230 solving this problem by making vary @xmath181 from @xmath216 to @xmath172 , we obtain the solution of @xmath162  with the terminal conditions - .    [ [ lambda_3-continuation ] ] @xmath182-continuation + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the parameter @xmath182 is added to the terms induced by the aerodynamic forces in system - , i.e. , replace @xmath231 and @xmath232 by @xmath233 and @xmath234 .",
    "it is the only parameter that acts on the differential system , and it is used to differ the ariane - type and pegasus - type rockets .",
    "we let @xmath235 during the @xmath180-continuation and the @xmath181-continuation , which means during these first two steps of the continuation procedure , we do not consider the influence of the drag and the lift . then",
    ", if we are dealing with a pegasus - type rocket , we vary @xmath182 from @xmath216 to @xmath172 to derive a solution of problem @xmath162  with drag and lift , and the shooting function remains the same as for the @xmath181-continuation . otherwise ,",
    "for an ariane - type rocket , we skip @xmath182-continuation , i.e. , we keep @xmath236 and go ahead to the @xmath184-continuation . by doing this ,",
    "the program is suitable for both types of rockets .    [ [ lambda_4-continuation ] ] @xmath184-continuation + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    finally , in order to compute the solution of @xmath0 , we use the continuation parameter @xmath184 to pass from @xmath162  to @xmath0 .",
    "we add the parameter @xmath184 to the hamiltonian @xmath237 and to the cost functional as follows : @xmath238 @xmath239 then , according to the pmp , the extremal controls are given by @xmath240 , @xmath165 , where @xmath241 the shooting function @xmath242 is the same as @xmath243 , replacing @xmath207 with @xmath244 .",
    "the solution of @xmath0 is then obtained by making vary @xmath184 continuously from @xmath216 to @xmath172 .",
    "note again that the above continuation procedure fails in case of chattering , and thus can not be successful for any possible choice of terminal conditions .",
    "in particular , if chattering occurs then the @xmath184-continuation is expected to fail for some value @xmath245 .",
    "but in that case , with this value @xmath246 , we have generated a sub - optimal solution of the problem @xmath0 , which appears to be acceptable and very interesting in practice .",
    "moreover , the overall procedure is very fast and accurate .",
    "note that the resulting sub - optimal control is continuous .    as we have mentioned , it is possible that an optimal trajectory meets the singularities of the euler angles , i.e. , @xmath247 , for some @xmath248 $ ]",
    ". a coordinate system transformation can be made to change the set terminal conditions and avoid meeting the singularity .",
    "we will use two numerical tricks as follows .",
    "the first one is to use a new reference frame @xmath156 , instead of @xmath17 , such that the terminal conditions in the new reference frame are easier to solve .",
    "the new frame @xmath156 is set by rotating the initial frame @xmath17 .",
    "this amounts to a nonlinear state transformation , and leads to a preconditioner that makes the proposed continuation procedure more robust .",
    "the second trick is to overcome the singularities of the euler angles by redefining the vector fields at the singular points .",
    "we define a new coordinate @xmath249 which is derived by two single - axis rotations from the frame @xmath250 , i.e. , @xmath251 and so the transfer matrix from @xmath17 to @xmath156 is @xmath252 .",
    "denoting the euler angles of @xmath18 with respect to the new frame @xmath249 as @xmath253 , @xmath254 and @xmath255 , we get the transfer matrix from @xmath156 to @xmath18 as @xmath256 .",
    "therefore , it follows from @xmath257 that the angles @xmath253 , @xmath254 and @xmath255 are functions of the angles @xmath11 , @xmath12 , @xmath13 , @xmath258 , and @xmath259 .",
    "moreover , the velocity @xmath22 in the @xmath260 can also be obtained by @xmath261 .",
    "the angular velocity @xmath262 is expressed in the body frame @xmath18 and it is therefore not altered by this coordinate change .",
    "given fixed @xmath258 and @xmath259 , the change of frame corresponds to a nonlinear invertible change on the state variable as follows @xmath263 where @xmath264 is the mapping from the euler angles in @xmath17 to the euler angles in @xmath260 , and @xmath265 is identity matrix of order 3 .",
    "note that this transformation is invertible .",
    "for every given value of @xmath258 , the value of @xmath259 can be chosen such that @xmath266 . by doing this ,",
    "the terminal values on @xmath12 is  closer \" to the origin and hence  farther \" from the singularities of the euler angles .",
    "indeed , this only reduces the risk of meeting with the singularities of the euler angles , so we will as well use this numerical trick in the next section to improve the robustness of the numerical procedure .",
    "further , we explain why this state transformation can be seen as a preconditioner to our numerical method . in view of the shooting method",
    ", we use a newton - like method to solve the boundary value problem . for simplicity of explanation ,",
    "we use the simplest newton method and denote the variables of the shooting method as @xmath267 . given an initial guess of @xmath268 , the equation @xmath269 is solved iteratively , i.e. , @xmath270 where @xmath271 . define a diffeomorphism @xmath272 such that @xmath273 .",
    "then the original problem becomes solving @xmath274 and the newton method iterative steps become @xmath275 where @xmath276 it is easy to see that the matrix @xmath277 here actually acts as a preconditioner in the shooting method and it can be used to get a jacobian matrix @xmath278 with a smaller condition number . in the numerical experiments , we use a fortran subroutine hybrd.f ( see @xcite ) which uses a modification of the powell hybrid method : the choice of the correction is a convex combination of the newton and scaled gradient directions , and the updating of the jacobian by the rank-1 method of broyden .    note in addition that the differential equations for the new variable @xmath279 keep the same form as the old variable @xmath60 , and by using the pmp , the adjoint vector @xmath280 to the new state @xmath279 can also be derived from @xmath281 , i.e. , @xmath282 and this is also invertible .    to sum up",
    ", the reference frame can be chosen such that the problem @xmath0 can be easier solved numerically . however , a priori",
    ", we do not know which pair of @xmath283 is the most suitable to the problem .",
    "if we take the pair that makes the condition number of the jacobian matrix @xmath278 at the initial time smallest , the value of @xmath284 may become too large ( huge pitch angle maneuver ) leading to the fail of the numerical strategy and it does not ensure that the condition number remains small in all the four continuation steps .",
    "if we choose the pair that makes the value @xmath284 the smallest , it is possible that the jacobian matrix is ill - conditioned . therefore , we propose to do the following :    frame change heuristics    * step1 : fix arbitrary @xmath258 , calculate @xmath259 so that @xmath285 and assess the new terminal conditions ; * step2 : solve the problem @xmath0 using the continuation procedure proposed ; * step3 : if the step2 succeeds , stop . if the step2 fails , repeat step1-step2 with a new @xmath286 ( @xmath287 constant ) .",
    "we will see in the numerical results that this enhances the robustness of our numerical methods though it consumes more time .      as we can see from , when @xmath288 , @xmath289 , the system encounters singularities due to the fact that the euler angle @xmath13 is not well defined at these points . here",
    "we call these points singularities of the euler angles . one way to overcome these singularities is to calculate the limit values of the differential of @xmath290 and @xmath291 at these points .",
    "assume that @xmath292 is bounded , then we have @xmath293 when @xmath294 .",
    "thus we get from @xmath295 that @xmath296 when @xmath294 .",
    "assume that @xmath297 , then it follows from @xmath298 that @xmath299 .",
    "hence , we get @xmath300 summing up , at points @xmath301 , equation become @xmath302 and become @xmath303 when we are close to such a singularity , we use and instead of the original system equations .",
    "we test the proposed numerical method in three typical cases of launchers in order to check its robustness with respect to the terminal conditions .",
    "the first case is the atmospheric ascent phase of the ariane - type rocket , the second one is the flight phase of the ariane - type rocket ( after the first stage separation ) , and the third one is the launch phase of the pegasus - type airborne rocket .",
    "the launcher data ( see equations - ) in these three cases are given in the table [ table_parameters ] .",
    "we also indicate the computer features on which the tests were run .",
    "[ h ]    .launcher data . [ cols=\"<,^,^,^\",options=\"header \" , ]     for each variable , we choose a discretization step and solve all the possible combinations of this discretization ( factorial experiment ) . there will be respectively @xmath304 , @xmath305 , @xmath306 cases for the three launcher configurations .",
    "[ [ results - without - change - of - frame ] ] results without change of frame + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the statistical results without change of frame are given in table [ table_statistic_result1 ] .",
    "we see that the success rate for the ariane launch case ( 85.4% ) is much higher than the ariane flight case ( 50 % ) and the pegasus case ( 24.6 % ) .",
    "the table presents the average time spent for each continuation stage ( @xmath180 to @xmath184 ) and the average number of simulations performed to achieve each stage .",
    "these average performances are assessed on the successful cases .",
    "the main reason for this phenomenon is the singular arc ( which is considered as the  highway \" in our problem ) , which causes chattering .",
    "this can be seen in the following aspects :    * the first one is the ratio of parameters @xmath307 and @xmath308 . by comparing the case of airane launch and the case of pegasus",
    ", we find that when @xmath309 is large ( ariane launch ) , the continuation procedure works better . for a launcher ,",
    "the parameter @xmath307 represents the capacity to reorient its velocity , whereas the parameter @xmath308 represents the capacity to reorient its attitude .",
    "hence , when @xmath309 is small ( pegasus ) , it means that the attitude can be turned quickly to the  highway \" , which is the singular surface , and that there will probably be a singular arc in the optimal trajectory . *",
    "the second one is the velocity . in case of ariane flight , though its ratio @xmath309 is large ( even a bit larger than ariane launch case ) , the velocity is much bigger than in the ariane launch case .",
    "reorienting the velocity by the same angle requires more time than for a small velocity ( see @xcite ) . that is to say , in order to reorient the velocity vector to the right direction , in case of ariane flight",
    ", it needs to stay more time in the  highway \" . *",
    "the third one is the reorientation angle . in the case of pegasus , though the velocity is small , the difference between the initial euler angles and the final euler angles are large compared with the two other cases .",
    "this means that the velocity also has to have a large change in direction , which leads again the optimal trajectory to have high possibility to contain a singular arc .",
    "[ h ]     & ariane launch & ariane flight & pegasus + number of cases & @xmath304 & @xmath305 & @xmath306 + rate of success ( % ) & & & + - total & @xmath310 & @xmath311 & @xmath312 + - before @xmath184-continuation & @xmath310 & @xmath313 & @xmath314 + average execution time ( s ) & & & + - total & @xmath315 & @xmath316 & @xmath317 + - in @xmath180-continuation & @xmath318 & @xmath319 & @xmath320 + - in @xmath181-continuation & @xmath321 & @xmath322 & @xmath323 + - in @xmath182-continuation & @xmath216 & @xmath216 & @xmath324 + - in @xmath184-continuation & @xmath325 & @xmath326 & @xmath327 + average number of simulations & & & + - total & @xmath328 & @xmath329 & @xmath330 + - in @xmath180-continuation & @xmath331 & @xmath332 & @xmath333 + - in @xmath181-continuation & @xmath334 & @xmath335 & @xmath332 + - in @xmath182-continuation & @xmath216 & @xmath216 & @xmath336 + - in @xmath184-continuation & @xmath337 & @xmath338 & @xmath339 +    in term of execution time , it appears that most time is consumed in the @xmath184-continuation ( see ariane flight and pegasus cases ) .",
    "so far , we say that the method is efficient for the ariane launch case , but it is less efficient and robust for the two other cases . now we run the same tests using the change of frame .    [",
    "[ results - with - change - of - frame ] ] results with change of frame + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the statistical result with change of frame are presented in table [ table_statistic_result2 ] .",
    "the change of frame is defined by the angles @xmath340 .",
    "the resolution is restarted with varying @xmath340 values until successful ( see [ precond ] frame change heuristics ) .",
    "the pair @xmath341 is the pair that makes the continuation procedure works . in table [ table_statistic_result2 ] , the total execution time includes the @xmath340 search , while the continuation times account only for the final resolution once @xmath341 have been found .",
    "it is obvious that the proposed continuation procedure is more robust when combined with change of frame . especially in the pegasus case",
    ", the total success rate is improved from @xmath342 to @xmath343 .",
    "again , the success rates of ariane flight and of pegasus are lower than those of the ariane launch , and the @xmath184-continuation consumes more time than the three other continuations .",
    "in fact , when the optimal trajectory does not contain chattering arcs , the total execution time is just about several seconds , however , when the chattering phenomenon tends to appear ( by varying @xmath184 from @xmath216 to @xmath172 ) , the continuation procedure start to take smaller and smaller steps and the execution time becomes much longer .",
    "this is why @xmath184-continuation takes more time .",
    "therefore , if we stop the @xmath184-continuation when chattering occurs , we can obtain a sub - optimal solution within a very short time .",
    "moreover , the success rate for obtaining a sub - optimal solution ( success rate without @xmath184-continuation ) is much higher ( @xmath344 for ariane launch , @xmath345 for ariane flight and @xmath346 for pegasus ) .",
    "this indicates again that most failures happen in the @xmath184-continuation .",
    "we observe that either the solution is obtained very quickly or it can take a long time .",
    "therefore , for a statistical analyses , we define arbitrarily two group of cases , denoted  easy \" and  difficult \" .",
    "the easy cases are those solved in less than @xmath347 , whereas the difficult cases are the other ones .",
    "we see that once the right reference frame is chosen , the time for solving the problem is reasonable even in the difficult cases .",
    "much time is consumed by trying different reference frames . the procedure for searching the best possible values of @xmath258 and @xmath259 , which would ensure convergence , is currently under investigation .",
    "the heuristics used for the tests ( frame change heuristics in section [ precond ] ) may certainly be improved taking into account the physical and geometrical features of the problem instance .",
    "[ h ]     & & & + number of cases & & & + - total & & & + - easy ( total execution time @xmath348 ) & & & + - diffi .",
    "( total execution time @xmath349 ) & & & + rate of success ( % ) & & & + - total & & & + - before @xmath184-continuation & & & + - average execution time ( s ) & easy & diffi . &",
    "easy & diffi . & easy & diffi .",
    "+ - total with change of frame & @xmath350 & @xmath351 & @xmath352 & @xmath353 & @xmath354 & @xmath355 + - total with @xmath341 & @xmath356 & @xmath357 & @xmath358 & @xmath359 & @xmath360 & @xmath361 + - in @xmath180-continuation & @xmath362 & @xmath363 & @xmath325 & @xmath364 & @xmath365 & @xmath366 + - in @xmath181-continuation & @xmath321 & @xmath367 & @xmath368 & @xmath369 & @xmath370 & @xmath371 + - in @xmath182-continuation & @xmath216 & @xmath216 & @xmath216 & @xmath216 & @xmath372 & @xmath373 + - in @xmath184-continuation & @xmath374 & @xmath375 & @xmath376 & @xmath377 & @xmath378 & @xmath379 + average number of simulations & easy & diffi . & easy & diffi . & easy & diffi .",
    "+ - total with @xmath341 & @xmath380 & @xmath381 & @xmath328 & @xmath382 & @xmath383 & @xmath384 + - in the 1st continuation & @xmath385 & @xmath386 & @xmath387 & @xmath388 & @xmath385 & @xmath389 + - in the 2nd continuation & @xmath334 & @xmath390 & @xmath391 & @xmath392 & @xmath391 & @xmath393 + - in the 3rd continuation & @xmath216 & @xmath216 & @xmath216 & @xmath216 & @xmath394 & @xmath395 + - in the 4th continuation & @xmath331 & @xmath389 & @xmath333 & @xmath396 & @xmath328 & @xmath397 + average times of change of frame & @xmath398 & @xmath399 & @xmath400 & @xmath401 & @xmath402 & @xmath403 +    here we test the method with extreme conditions , whereas in real use , only small attitude maneuvers are used for ariane - type launchers . among the tested cases of ariane launch ( resp .",
    "ariane flight ) , there are @xmath404 cases with maneuver time @xmath405 and the average time to solve the problem is @xmath406 ( resp .",
    "@xmath407 ) . for these small maneuvers",
    ", the continuation method provides rapidly an optimal control",
    ".    denote @xmath408 the yaw change .",
    "we observe from the statistical results that , in case of pegasus , the average execution time increases when @xmath409 increases .",
    "when @xmath410 , the average total execution time is @xmath411 , and when @xmath412 the total average execution increases to @xmath413 .",
    "therefore , when applying to quasi - planar maneuvers ( @xmath410 ) for pegasus like airborne launchers , the continuation procedure is also efficient .",
    "the proposed continuation method is much faster and more precise than the direct approaches .",
    "furthermore , the trajectories obtained , even though they are sub - optimal , are physically feasible because the control remains smooth . on the other hand",
    ", the direct methods may produce oscillatory control if chattering . in this section",
    ", we will use the direct method proposed in @xcite . in the direct method , the midpoint rule ( 2nd order method ) is used as discretization method and the number of time steps is set to be 100 .",
    "note that in the indirect method , we use runge - kutta 4th method which is more precise .",
    "[ [ case - without - chattering ] ] case without chattering + + + + + + + + + + + + + + + + + + + + + + +    we report on figures [ state_easy ] and [ control_easy ] an optimal solution of @xmath0 obtained from the proposed continuation procedure .",
    "here we consider the ariane flight configuration in a planar case with @xmath414 , @xmath415 and @xmath416 .",
    "denote also the module of control as @xmath61 , and thus @xmath417 and @xmath418 with @xmath419 defined as the angle of the control .",
    "( continuation method).,width=529,height=132 ]     ( continuation method).,width=377,height=132 ]    for this example , it takes about @xmath420 to solve the problem using the continuation procedure , while it takes about @xmath421 using the direct method initialized with an arbitrary constant commands .",
    "the optimal solution derived from the direct method is the same with the one reported on the figures [ state_easy ] and [ control_easy ] , except for some small oscillations around zero ( namely for the variables @xmath422 , @xmath12 and @xmath13 ) .",
    "moreover , the maneuver time @xmath423 given from the direct method is about the same with the maneuver time @xmath424 obtained from the continuation procedure .    from figure [ control_easy ]",
    "we see that the obtained optimal control has only two switches ( at time @xmath425 and @xmath426 the control angle changes an angle of @xmath129 , and thus @xmath427 changes from @xmath428 to @xmath429 at @xmath425 and changes from @xmath429 to @xmath428 at @xmath426 ) .",
    "it is worth noting that for a real launcher , it is better to have a continuous control , since the acceleration of the control is generally limited . for this aim , it suffices to stop the @xmath184-continuation before @xmath172 to obtain a sub - optimal control .",
    "for example , we stop at @xmath430 and get a control in figure [ control_easy_subopti ] .",
    "this control is feasible on a real launcher and the maneuver time is @xmath431 , five seconds longer than the optimal one .",
    "( continuation method).,width=377,height=132 ]    [ [ case - with - chattering ] ] case with chattering + + + + + + + + + + + + + + + + + + + +    in figures [ state_diffi_bocop ] and [ control_diffi_bocop ] a sub - optimal solution obtained from the direct method is illustrated , while in figures [ state_diffi ] and [ control_diffi ] a sub - optimal solution is given by the continuation procedure ( parameter @xmath184 stops at @xmath432 ) .",
    "here we still consider the ariane flight configuration in a planar case with @xmath433 , @xmath415 and @xmath434 .     and",
    "control @xmath435 ( direct method).,width=529,height=132 ]     ( direct method).,width=377,height=132 ]     and control @xmath435 ( continuation method).,width=529,height=132 ]     ( continuation method).,width=377,height=132 ]    when using the continuation method ( resp .",
    "direct method ) , the maneuver time obtained is @xmath436 ( resp .",
    "@xmath437 ) and the problem is solved within @xmath438 ( resp . within @xmath439 ) .",
    "we observe that though the maneuver time derived from the direct method is less than with the continuation procedure , the sub - optimal control ( see figure [ control_diffi_bocop ] ) given by the direct method oscillates much with a module less than @xmath172 : this indicates that there is a singular arc in the  true \" optimal trajectory , causing chattering at the junction with regular arcs . such solution , with infinitely many control oscillations , can not be used in the practice .    from figure [ control_diffi ]",
    ", we observe that the sub - optimal control obtained from the continuation procedure is continuous and piecewise smooth .",
    "in fact , if we observe the time history of the switching function , we will see that the switching function tends to have more switches because of the chattering , and this cause the fail of the continuation method when @xmath440 .    in practice , the attitude maneuvers remain of limited magnitude for a launcher .",
    "the chattering phenomenon is thus unlikely to occur , excepted in very specific configurations , for example if the available nozzle deflection is very small .",
    "in this paper , we have addressed the problem of the minimum time maneuver coupling attitude and trajectory dynamics for a launcher .",
    "the solution method is based on an indirect approach with a four - stage continuation procedure to solve the optimality conditions derived from the pmp . starting from the explicit solution of a simplified problem of order zero , the successive continuations consists of retrieving the true attitude dynamics and terminal conditions .",
    "a regularization problem is used as an intermediate problem to overcome the problem caused by chattering . with this procedure",
    ", the solution to any problem instance can be obtained from scratch in a quite short time whatever the launcher data and the terminal conditions .",
    "the minimum time problem is fully solved if possible . in case of a failure due to chattering , a very good sub - optimal solution is available using smooth control law suited to practical application .",
    "the method is exemplified on three representative launcher configurations , respectively for a vertical launch phase , an in - flight phase and an airborne launch phase .",
    "statistical tests are run sweeping on the initial and final conditions .",
    "the statistical results show that the developed method is fast and robust .",
    "the current improvement axes deal with the choice of the coordinate frame that could be chosen from a physical and geometrical considerations .",
    "moreover , state constraints on the angular velocity and the attack angle will be considered to provide safer optimal or sub - optimal trajectories for the launchers .            j.t .",
    "betts , practical methods for optimal control and estimation using nonlinear programming , second edition , advances in design and control , 19 , _ society for industrial and applied mathematics ( siam ) _ , philadelphia , pa , 2010 ."
  ],
  "abstract_text": [
    "<S> we study the minimum time control problem of the launchers . </S>",
    "<S> the optimal trajectories of the problem may contain singular arcs , and thus chattering arcs . </S>",
    "<S> the motion of the launcher is described by its attitude kinematics and dynamics and also by its trajectory dynamics . </S>",
    "<S> based on the nature of the system , we implement an efficient indirect numerical method , combined with numerical continuation , to compute numerically the optimal solutions of the problem . </S>",
    "<S> numerical experiments show the efficiency and the robustness of the proposed method .    </S>",
    "<S> * keywords : * coupled attitude orbit problem ; optimal control ; pontryagin maximum principle ; shooting method ; continuation ; chattering arcs . </S>"
  ]
}