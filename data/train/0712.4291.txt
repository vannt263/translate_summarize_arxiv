{
  "article_text": [
    "let @xmath9 be a classical random variable and let @xmath10 be a ( generally quantum - mechanical ) system whose state might be correlated to @xmath9 .",
    "min - entropy of @xmath9 given @xmath10 _ , denoted @xmath11 , is a natural measure for the uncertainty on the value of @xmath9 given access to the _ side information _ @xmath10 .",
    "more precisely , @xmath11 corresponds to the maximum length of a bitstring @xmath12 which is ( a )  uniquely determined by @xmath9 and ( b )  virtually uniform and independent of @xmath10 . of section  [ sec : basicdefinitionsh ] for a mathematically precise statement . ]    here , we study the following question initiated by nisan and zuckerman  @xcite .",
    "is classical . ] given a sequence @xmath0 of @xmath1 classical random variables with min - entropy ( relative to side information @xmath10 ) at least @xmath13 , for some @xmath14 , what is the min - entropy @xmath15 of a randomly selected sample @xmath2 of @xmath4  positions ?",
    "in other words , we are starting with a sequence @xmath0 which contains at least @xmath16 bits of uniform ( relative to @xmath10 ) randomness , and we are interested in the amount of uniform ( again relative to @xmath10 ) randomness of the subsequence @xmath2 .    as a main result",
    ", we show that the min - entropy per position is preserved under sampling , i.e. , @xmath17 ( except with probability exponentially small in @xmath4 ) .",
    "this generalizes a result by vadhan  @xcite who considered the case where @xmath10 is purely classical .",
    "is purely classical , it can generally be omitted in the analysis , as explained in section  [ sec : extracionpriorcinfo ] . ]",
    "a main application of this result is in the context of _ randomness extraction_. it relies on the _ leftover - hash lemma",
    "_  @xcite ( see also  @xcite ) , or , more precisely , its quantum generalization  @xcite ( see also  @xcite ) , saying that the randomness of a classical random variable @xmath9 , measured in terms of the min - entropy , can be extracted by applying a suitable hash function .",
    "that is , @xmath9 can be mapped to a string @xmath18 of size ( roughly ) @xmath11 which is virtually uniform and independent of @xmath10 .",
    "our result now implies that , given a long sequence @xmath0 with sufficient min - entropy , random bits can be obtained by the _ sample - and - hash technique _ , i.e. , first sampling a subsequence @xmath2 and then applying a two - universal hash function .",
    "the sample - and - hash technique is of interest in cryptography , in particular in the context of the _ bounded storage model _  @xcite . here",
    ", the security of cryptographic schemes is based on the assumption that a string of random variables @xmath0 , called _ randomizer _ , is temporarily available for public access , but too long to be stored on a computer , even by a potential adversary .",
    "the idea then is to use this string as a source of secret randomness .",
    "based on the original work by maurer  @xcite , various schemes for _ key expansion _ in the bounded storage model have been proposed  @xcite .",
    "these are mostly based on the sample - and - hash technique described above .",
    "more precisely , a short initial string is used for selecting positions of the randomizer @xmath0 .",
    "then a hash function is applied to extract a key @xmath18 .",
    "because the min - entropy of the randomizer @xmath0 given the information @xmath10 stored by an adversary , @xmath19 , is necessarily large , our result implies that the final key @xmath18 is indeed uniform relative to  @xmath10 and , hence , secret . in other words",
    ", our result proves that key expansion in the bounded storage model is possible in the context of a quantum adversary .",
    "it generalizes previous results  @xcite where security has been proved under the assumption that the adversary is purely classical .",
    "the paper is organized as follows : we first cover some background material on randomness extraction in section  [ sec : basicdefsknownresults ] . in section  [ sec : ourcontribution ] , we discuss our main result and its relation to prior work .",
    "section  [ sec : proofsketch ] provides an informal overview of the central ideas involved in the proof .",
    "the remainder of the paper is devoted to a formal derivation of our main results ; in section  [ sec : rulesandtoolsentropy ] , we establish the required properties of min - entropy .",
    "we subsequently apply these to the problem at hand in section  [ sec : entropysampling ] , where we derive our main result .",
    "we conclude in section  [ sec : bsmapplicationdetailed ] by giving explicit parameters for key expansion in the bounded storage model .",
    "_ randomness extraction _",
    ", i.e. , the process of transforming partially random data @xmath9 into a uniformly distributed string @xmath18 , plays an important role in computer science and , in particular , cryptography .",
    "for example , it is used to generate secure keys , given only partially secret raw data .",
    "one of the most fundamental results in the area of randomness extraction is the _ leftover - hash lemma _",
    "it states that the number of uniform bits that can be extracted from a given random variable @xmath9 by two - universal hashing ( i.e. , by applying a function chosen at random from a two - universal set of hash functions ) is roughly equal to the _ _ min - entropy _ _ is also denoted @xmath20 and called _ rnyi entropy of order @xmath21_. ] of @xmath9 defined by @xmath22 we can express this result more formally by saying that two - universal hashing is an _",
    "extractor_. a @xmath23-extractor is a function @xmath24 with the property that the random variable @xmath25 is @xmath26-close to uniform - norm of a function @xmath27 is defined as @xmath28 .",
    "] , i.e. , @xmath29 whenever @xmath9 is a random variable @xmath9 with min - entropy at least @xmath30 and @xmath31 is an independent and uniform seed , i.e. , @xmath32 .",
    "( here @xmath33 denotes the uniform distribution on @xmath34 . )",
    "a strengthening of this notion is the concept of a _",
    "strong extractor _ , whose output is required to be uniform even conditioned on the seed @xmath31 .",
    "a strong @xmath23-extractor satisfies the inequality @xmath35 for all @xmath36 with @xmath30 .",
    "two - universal hashing corresponds to a strong @xmath23-extractor with @xmath37 bits of output , for any @xmath38 and @xmath39 .",
    "while two - universal hashing is optimal in the number @xmath40 of bits it can extract , it is not usable in certain applications .",
    "for example , computing the output @xmath25 might be infeasible , e.g. , if the initial number @xmath41 of bits is too large to be processed by a limited computational device . also , in cryptographic scenarios",
    ", the seed @xmath31 is sometimes a ( secret ) key of limited size ( e.g. , @xmath42 ) compared to the length of @xmath9 .",
    "thus it is natural to try to find extractors with additional properties , such as efficient computability or limited seed length .",
    "an example of such a requirement which is important for applications in the bounded storage model is _ local computability _ ; in other words , if @xmath43 consists of a large number @xmath1 of blocks ( or bits ) , the output @xmath44 should only depend on a small subset @xmath45 of these values , where @xmath46=\\{1,\\ldots , n\\}$ ] specifies the subset for every @xmath47 .",
    "in other words , these extractors are of the form @xmath48 .      with the aim of finding other constructions of extractors ,",
    "it is natural to consider weaker notions of randomness generation .",
    "one natural way to generalise the concept of a randomness extractor is to require that the output is only close to a random variable with high min - entropy ( instead of being close to a uniform random variable ) .",
    "this leads to the definition of a @xmath49-condenser : this is a function @xmath50 such that for all random variables @xmath9 with @xmath30 , there is a random variable @xmath51 with @xmath52 such that @xmath53 where @xmath31 is a uniform and independent seed on @xmath54 . in terms of the so - called _ smooth min - entropy",
    "_ , that is functions @xmath55 $ ] satisfying @xmath56 . ]",
    "@xmath57 this requirement is simply expressed by @xmath58 the notion of a condenser is a strict generalisation of the notion of an extractor . indeed , a @xmath23-extractor @xmath24 is a @xmath59-condenser and vice versa .",
    "again , a stronger version of condensers is obtained by requiring that @xmath60 has high smooth entropy _ with high probability _ over @xmath61 .",
    "the analog of   defining a strong @xmath49-condenser then is the requirement that for every @xmath9 with @xmath30 , there exists a joint distribution @xmath62 such that @xmath63 where @xmath31 is independent of @xmath9 with uniform distribution @xmath64 on @xmath54 , and @xmath65 . here",
    ", the _ conditional min - entropy _ is defined as @xmath66 as before , this requirement is equivalent to demanding that @xmath67 where @xmath68 is the _ conditional smooth min - entropy_. with this definition , a function @xmath24 is a strong @xmath23-extractor if and only if it is a strong @xmath59-condenser .",
    "condensers can be used as a building block for constructing extractors .",
    "a possible way of obtaining a new construction is by applying an extractor to the output of a condenser .",
    "more precisely , suppose that @xmath69 it is easy to see that in this situation , the function @xmath70 is a @xmath71-extractor .",
    "this is because the condenser @xmath72 generates a random variable with a sufficient amount of min - entropy for @xmath73 .",
    "this conclusion is also true for the strong versions of these notions : if @xmath72 and @xmath73 are a strong condenser and a strong extractor , respectively , then the function @xmath74 is a strong extractor .",
    "let us now return to the problem of constructing locally computable extractors . clearly , if @xmath75 is of the form @xmath76 , where @xmath77 $ ] is a subset of indices for every @xmath47 , then the previous construction results in an extractor of the form @xmath78 .",
    "this extractor is clearly locally computable .",
    "this way of building a locally - computable extractor by first sampling a few indices specified by @xmath79 at random and then applying an extractor is called the _ sample - and - hash approach_. building locally computable extractors is thus reduced to the problem of constructing condensers of the form @xmath76 .",
    "consider a sequence of random variable @xmath80 on @xmath81 and assume that the _ min - entropy rate _",
    "@xmath82 is lower bounded by @xmath83 , i.e. , @xmath84 we will call the quantity @xmath85 on the lhs the _ min - entropy rate _ of @xmath9 . suppose further that we select @xmath4 of these random variables at random , resulting in a subset @xmath86 corresponding to indices @xmath87 .",
    "intuitively , one would expect that with high probability over the choice of @xmath88 , the amount of randomness contained in such a sample is proportional to its size @xmath89 , i.e. , @xmath90 for some small @xmath91 . in other words",
    ", we expect the min - entropy rate to be preserved under sampling .",
    "indeed , as shown by vadhan  @xcite ( improving on previous work by nisan and zuckerman  @xcite ) , inequality   is correct with high probability ( over the choice of the sample @xmath87 ) . in the terminology of condensers , this is saying that the function @xmath92}{r}&\\rightarrow { \\mathcal{x}}^r\\\\ ( ( x_1,\\ldots , x_n),{\\mathcal{s}})&\\mapsto x_{\\mathcal{s}}\\end{aligned}\\ ] ] is a @xmath93-condenser for some small @xmath94 .",
    "we call this function the _ @xmath95}{r}$]-subset condenser_.    neglecting issues related to computational complexity , a condenser of the form @xmath76 is fully specified by the distribution @xmath96 over subsets of @xmath97 $ ] .",
    "the @xmath95}{r}$]-subset condenser is simply represented by the uniform distribution over all subsets @xmath98 $ ] of size @xmath99 .",
    "it is natural to ask which distributions over subsets @xmath88 give rise to good condensers .",
    "intuitively , a necessary condition is that the set of subsets @xmath88 covers @xmath97 $ ] well in some sense .",
    "in fact , vadhan  @xcite showed that it suffices for @xmath88 to be a so - called _ averaging sampler _ ; i.e. , a distribution over subsets of @xmath97 $ ] which can be used to approximate the average of any @xmath1  values .",
    "formally , such a sampler is defined as follows :    [ def : averagingsampler ] an @xmath100-sampler is a probability distribution @xmath101 over subsets @xmath98 $ ] with the property that @xmath102\\leq \\varepsilon\\textrm { for all } ( \\beta_1,\\ldots,\\beta_n)\\in [ 0,1]^n\\ . \\label{eq : averagingsamplerdef}\\end{aligned}\\ ] ] for simplicity , we will assume that @xmath103 is completely supported on subsets of the same size , and refer to this as @xmath104 .",
    "observe that we only consider a one - sided error . of an ( arbitrary ) vector @xmath105^n$ ]",
    "whose entries are accessible in the form of an oracle . here",
    "we restrict our attention to so - called _ averaging _ samplers : these output the value @xmath106 of a ( randomly ) chosen subset @xmath98 $ ] of values . for a more detailed discussion of samplers and their computational aspects ,",
    "see  @xcite . ]",
    "we will call @xmath107 the _ accuracy _ of the sampler , and @xmath26 its _ failure probability_. returning to our example , the uniform distribution over subsets of a fixed size is an averaging sampler with the following parameters .",
    "[ lem : subsetsampler ] let @xmath108 and let @xmath103 be the uniform distribution over subsets @xmath98 $ ] of size @xmath99 .",
    "this defines a @xmath109-sampler for every @xmath110 and @xmath111 $ ] .",
    "this statement is a consequence of the hoeffding - azuma inequality and given as lemma  5.5 of  @xcite .",
    "we call this sampler simply the _ @xmath95}{r}$]-subset sampler_. it will be sufficient for our purposes , but our results hold more generally for arbitrary averaging samplers .    vadhan showed that in the same way as the @xmath95}{r}$]-subset sampler gives rise to the @xmath95}{r}$]-condenser , any averaging sampler defines a corresponding condenser ( with appropriate parameters ) . in other words ,",
    "a probability distribution @xmath103 over subsets of @xmath97 $ ] with the sampler property   preserves the min - entropy rate when picking a random subset , in the sense of  .      in cryptographic settings , it is often desirable to generate randomness which is not only ( close to ) uniform , but also _ independent _ of an adversary s prior information .",
    "we first consider the case where the adversary is classical , such that her information is described by a random variable  @xmath10 .",
    "in other words , the task is to generate a key @xmath18 satisfying @xmath112 , where @xmath113 summarises the adversary s knowledge .",
    "suppose the initial situation is described by a joint distribution @xmath114 , where @xmath9 is held by the honest parties , and the adversary holds @xmath10 .",
    "we will assume that the adversary s information about @xmath9 is limited ; this is expressed by a lower bound on the conditional entropy @xmath11 .",
    "conveniently , a strong @xmath23-extractor achieves key extraction in this setup , when invoked with ( public ) independent randomness @xmath31 .",
    "that is , we have @xmath115 for all @xmath114 with @xmath116 . in other words , if the adversary s initial prior information @xmath10 about @xmath9 is limited , the extracted key @xmath25 will look uniform to the adversary even if he is given the seed of the extractor ( i.e. , @xmath117 ) .",
    "this procedure of using public ( independent ) randomness to generate secret keys from partially secret information is well - known as _ privacy amplification _  @xcite ( usually in conjunction with two - universal hashing as an extractor ) .",
    "inequality   is a trivial application of markov s inequality ; it is obtained by applying the extractor property to the conditional distributions @xmath118 .",
    "a similar conclusion holds more generally for any strong @xmath49-condenser : here we have @xmath119 for all joint distributions @xmath114 with @xmath116 .",
    "this means that the problem of randomness extraction in the context of prior classical information essentially reduces to the randomness generation problem without any side - information .",
    "the mentioned property of extractors and condensers fails to be true in cases where the adversary s prior information @xmath10 is quantum . indeed , in this case , the conditional distributions @xmath118 are no longer defined , and the analysis of randomness extraction has to be done differently .",
    "the relevant concepts in this modified setup are sufficiently straightforward to define : consider a classical random variable @xmath9 and a quantum system @xmath10 which is correlated to this variable .",
    "this situation is completely described by a classical - quantum state @xmath120 ( where @xmath121 is an orthonormal basis ) , or equivalently the ensemble @xmath122 on @xmath10 . for the purpose of randomness extraction , the relevant measure of min - entropy",
    "is the conditional min - entropy @xmath123 introduced in  @xcite ; this quantity is defined by even with non - classical part @xmath9 . ]",
    "@xmath124 the conditional min - entropy generalizes the classical min - entropy  . for classical - quantum states",
    "@xmath125 , the min - entropy @xmath11 characterises the amount of uniform randomness @xmath126 that can be extracted from @xmath9 such that @xmath18 is independent of @xmath10 .    in terms of this measure of prior information , a _",
    "@xmath23-strong quantum extractor _ is a function @xmath24 with the property that ( cf .  )",
    "@xmath127 for all classical - quantum - states @xmath125 with @xmath128 . in this expression",
    ", @xmath31 is an independent and uniform seed on @xmath54 , and @xmath129 denotes the completely mixed state on @xmath34 , i.e. , the state @xmath130 . clearly , a @xmath23-strong quantum extractor is a @xmath23-strong extractor in the original ( classical ) sense .",
    "the converse is not true in general ( see  @xcite for a particularly striking example in the bounded storage model ) .",
    "however , the left - over hash lemma can be generalised to the quantum case : the two - universal hashing construction @xmath131 is a @xmath23-strong quantum extractor for any @xmath39 , as shown by renner  @xcite .",
    "( the optimality of this extractor with respect to the number of extracted bits is shown below in lemma  [ lem : hminextractablekeylength ] . ) as with classical extractors , an important goal is to find constructions which are more randomness - efficient , and satisfy additional properties such as local computability .",
    "similarly , a _ @xmath49-strong quantum condenser _",
    "@xmath132 is defined by the requirement ( cf .  )",
    "@xmath133 for all @xmath125 with @xmath128 . in this expression , the _ smooth min - entropy _",
    "@xmath134 is defined by a maximisation over a set of operators in the vicinity of @xmath125 .",
    "note that there is a certain freedom in these definitions ( the only constraint is the preservation of the desirable composability properties ) . we choose to define the smooth min - entropy as @xmath135 where the maximisation is over all subnormalised nonnegative operators @xmath136 in an @xmath26-ball around @xmath125 , and the quantity on the rhs  is the min - entropy of the corresponding operator ( see below for a formal definition ) .",
    "as shown in  @xcite , if @xmath9 is classical , this supremum is achieved by an operator @xmath136 which is classical on @xmath137 . to guarantee compatibility of quantum condensers and extractors , we require a @xmath23-strong quantum extractor to satisfy   for all subnormalised nonnegative operators @xmath125 with classical part @xmath9 and @xmath128 .",
    "this is true for two - universal hashing , as the analysis in  @xcite shows .",
    "our main result states that samplers can be used to `` condense '' min - entropy even in a quantum context , in the same way as they give rise to randomness condensers for classical distributions ( as discussed in section  [ sec : averagingsamplersclassical ] ) .",
    "more precisely , we consider an @xmath1-tuple @xmath138 of random variables on @xmath81 , where @xmath137 is a ( large ) alphabet .",
    "we show that relative to a quantum system @xmath10 , the _ min - entropy rate _ is preserved when picking a random subset @xmath139 ( using a sampler ) .",
    "to express this in a concise form , we introduce the _ min - entropy rates _",
    "@xmath140 where @xmath141 is the alphabet size of @xmath142 . our main result states that this quantity is approximately preserved under sampling . clearly , when applied to a @xmath100-sampler , such a statement must depend on the accuracy @xmath107 of the sampler and its failure probability  @xmath26 .",
    "for such a sampler and the situation described above , our main result is given by the inequality @xmath143 where the parameters @xmath144 and @xmath145 are equal to @xmath146 ( this result is stated as corollary  [ cor : samplersminentropypreservation ] below . )",
    "this inequality shows that ( for appropriate alphabet sizes ) the min - entropy rate is preserved , up to the accuracy of the sampler .",
    "as expected , the failure probability @xmath26 of the sampler is reflected in the distance ( i.e. , the smoothness parameter @xmath144 ) .",
    "in fact , this distance mainly depends on the failure probability of the sampler , and the term @xmath147 is usually negligible .",
    "observe that the expression @xmath148 on the lhs  of   goes to zero as @xmath149 .",
    "the parameter @xmath145 captures the alphabet sizes in the problem ; our result applies to regions where @xmath145 is small .",
    "as @xmath104 , this is equivalent to demanding that @xmath137 is a large alphabet . thus we will henceforth assume that the random variables @xmath150 are large `` blocks''(instead of individual bits ) .",
    "it is instructive to apply this result to the @xmath95}{r}$]-subset sampler : here the error probability @xmath26 decays exponentially with @xmath4 for any fixed @xmath111 $ ] .",
    "more precisely , the following reformulation of   is obtained by setting @xmath151 .",
    "we then have @xmath152thus ( smooth ) min - entropy - rate is preserved up to a constant , with an exponentially small error  @xmath26 .",
    "we briefly explain how our contribution relates to other known results .",
    "we stress that giving a comprehensive review of all the relevant areas is not the aim of this section . nor do we attempt to provide a complete list of references ; the pointers given here are mainly intended to facilitate access to further literature .",
    "we identify the following broad points of contact with previous work :      our main result is an upper bound on the amount of information a quantum system gives about certain classical values .",
    "as such , it fits into a long line of work , the most prominent example of which is holevo s upper bound on the accessible information  @xcite .    more specifically , our result bounds the information about a ( randomly selected ) substring @xmath153 of a classical string @xmath138 . in this sense",
    ", it is structurally identical to the _ random access encodings _",
    "studied by ambainis , nayak , ta - shma and vazirani  @xcite .",
    "formally , an _",
    "@xmath95}{1}\\overset{p}{\\mapsto}m$ ] random access encoding _ maps @xmath1-bit strings @xmath138 into @xmath154-qubit states @xmath155 in a way that allows to retrieve any ( single ) bit @xmath150 with probability at least @xmath156 by a measurement . strengthening the result of  @xcite",
    ", nayak  @xcite showed that at least @xmath157 qubits are needed for this kind of encoding .",
    "( here @xmath158 is the binary entropy function . )",
    "this can be understood as a precise expression of the qualitative statement that @xmath154  qubits can not be used to store more than @xmath154  classical bits .",
    "recently , this result has been significantly generalized by ben - aroya , regev and de wolf  @xcite .",
    "they studied @xmath95}{r}\\overset{p}{\\mapsto } m$ ] encodings , where the aim is to be able to retrieve _ each substring _ @xmath159 of length @xmath89 with probability at least  @xmath156 from the @xmath154-qubit state .",
    "they showed that the success probability @xmath156 decreases exponentially in @xmath4 when @xmath160 .",
    "the result  @xcite of ben - aroya et al .",
    "is of the same form as ours . indeed , as explained below , in terms of entropies , it expresses the fact that in the studied situation , the _ entropy - rate _ is preserved . however , there are at least three major differences to our work .",
    "firstly , @xcite provides an upper bound on the _ guessing probability _ @xmath161 , i.e. , the probability of retrieving the correct value @xmath139 given quantum information @xmath10 , which is the figure of merit in the context of random access encodings . by virtue of the identity",
    "@xmath162 ( see  @xcite for more details ) , their result implies a lower bound on the min - entropy ( and , hence , also on the smooth min - entropy for any @xmath163 ) .",
    "in contrast , we derive a lower bound on the _ smooth _ min - entropy @xmath164 , which is the relevant quantity in the context of randomness extraction ( e.g. , in the bounded storage model ) . this , in turn , implies an upper bound on the guessing probability @xmath165 .",
    "because our result is not optimized for very small @xmath26 , the upper bound on the guessing probability following from our result might be far below the bound of  @xcite .",
    "on the other hand , the bound on the smooth min - entropy implied by the result of  @xcite is below our bound , which is asymptotically optimal .",
    "a second , apparently insignificant yet important difference between  @xcite and our work is the alphabet size of the random variables @xmath150 in the tuple @xmath166 . while these are single bits in  @xcite , they may be random variables over a large alphabet in our work , i.e.",
    ", every @xmath167 is itself a @xmath168-bit string for some ( usually large does not directly apply to cases where the alphabet of the random variables @xmath150 is too small , e.g. , if they are single bits .",
    "however , our result can be extended to these cases in the following way .",
    "given , for instance , a bitstring @xmath169 , the permuted string , @xmath170 , for any permutation @xmath171 , has the same min - entropy as @xmath172",
    ". we can therefore apply corollary  [ cor : samplersminentropypreservation ] to the permuted string @xmath173 , for a randomly chosen @xmath174 , and appropriately chosen partitioning @xmath175 into @xmath1 blocks , resulting in a substring @xmath176 with high min - entropy . since , after undoing the permutation on @xmath177 , this string is identically distributed as a bitstring chosen at random from @xmath172 , we conclude that the min - entropy rate is essentially conserved under random sampling of bits . ] ) @xmath168 . in the latter case , choosing a random subset @xmath98 $ ] of size @xmath89 effectively generates a substring @xmath153 of length @xmath178 by blockwise sampling . for @xmath179 ,",
    "this procedure consumes only @xmath180 random bits , in contrast to @xmath181 when the individual bits are chosen at random .",
    "when applied to the bounded storage model , this means that we can extract more bits than the number of initial ( shared ) key bits . on the other hand , while the sample - and - hash approach can in principle be applied using the result of  @xcite , the number of extracted bits is much smaller than the number of initial key bits , that is , no significant key expansion can be achieved .",
    "thirdly , the result of  @xcite measures the initial quantum information about the string @xmath9 in terms of the number @xmath154 of qubits used in the encoding .",
    "more precisely , it is assumed that @xmath9 is uniformly distributed and that at most @xmath154 qubits containing information about @xmath9 are stored in a quantum system @xmath10 ( formally , @xmath182 , where @xmath183 denotes the logarithm of the dimension of @xmath10 ) .",
    "in contrast , our result applies more generally to situations where merely a lower bound on the quantity @xmath123 is known , while the quantum system @xmath10 may be arbitrarily large .",
    "the above special case where the dimension of @xmath10 is bounded follows from the general fact that @xmath184 .",
    "the study of key extraction in the presence of a classical adversary is , as argued above , equivalent to the question of constructing randomness extractors ( see  @xcite for a survey of this intensely studied subject ) .",
    "more specifically , two - universal hashing was first applied to privacy amplification in  @xcite .",
    "maurer and dziembowski  @xcite obtained optimal protocols for key extraction in the ( classical ) bounded storage model .",
    "lu  @xcite made the connection to locally ( or on - line ) computable _ strong extractors_. vadhan subsequently gave essentially optimal constructions by showing that sampling preserves min - entropy  @xcite ; the sampling approach for extracting randomness can be traced back to the work of nisan and zuckerman  @xcite and abounds in the randomness extractor literature .",
    "the situation in the presence of an adversary with prior quantum information is more intricate , and much less is known to date . on the negative side , gavinsky , kempe , kerenidis , raz and de",
    "wolf  @xcite gave a surprising example of a classical extractor which fails to extract randomness in the presence of a quantum adversary ( with a similar amount of quantum memory ) .",
    "on the positive side , renner  @xcite showed that two - universal hashing is optimal in the amount of extracted key ( see also  @xcite ) .",
    "knig and terhal  @xcite showed that strong extractors with binary output also extract secure bits against quantum adversaries ; this provides quantum extractors with short seeds , but does not achieve significant key expansion in the bounded storage model .",
    "recently , new constructions of quantum extractors were proposed by fehr and schaffner  @xcite .",
    "while these extractors can be used for privacy amplification , their parameters are not suitable for the bounded storage model .",
    "in this section , we give an informal overview of the main ideas involved in the proof of the result  . in section  [ sec : proofidea ] , we give a simple proof of an analogous statement for the ( classical ) shannon entropy . our proof for ( quantum ) min - entropy mimics this line of argument , but differs in a few major points , as discussed below .",
    "a few of our techniques may be of independent interest .",
    "a central idea is the _ splitting _ of a state into several components based on _ conditional operators _ ; it leads to a modified chain - rule for min - entropies .",
    "we explain this in section  [ sec : towardsmodifiedchainrule ] .",
    "the converse procedure which we call _ recombining _ is especially interesting when only subsets of the split states are used in the recombination .",
    "the outcome of such a partial recombination is a state which approximates the original state . by selecting split states in a systematic fashion , we can single out the high - entropy components of a state . as we explain in section",
    "[ sec : partialrecombination ] , this is a fundamental tool for showing that a given state has a certain amount of ( smooth ) min - entropy",
    ".    we will conclude this part of the paper with an overview of how these two procedures  the splitting and the recombining  can be combined with an argument about samplers to give the result we seek .",
    "we stress that this section is introductory in nature , and the technical details are left to later sections . in particular , we will only argue qualitatively , and the formulas in sections  [ sec : towardsmodifiedchainrule ] and  [ sec : partialrecombination ] are not meant to be taken literally .",
    "however , the basic structure of our arguments will be exactly as sketched here .",
    "we show how to derive a modified statement related to  , where we restrict our attention to probability distributions and where the min - entropy @xmath185 is replaced by the ( conditional ) shannon entropy @xmath186 .",
    "( here @xmath187 denotes the usual shannon entropy . )",
    "this kind of proof is sketched in  @xcite to give an intuition why samplers are good condensers . however",
    ", neither the proofs in  @xcite nor vadhan s proof  @xcite proceed along these lines .    the essential properties of the shannon entropy used are the subadditivity property @xmath188 i.e. , the fact that further conditioning can only reduce the entropy , and the chain - rule @xmath189    consider a probability distribution @xmath190 , where @xmath138 is an @xmath1-tuple of random variables .",
    "our aim is to show that with high probability over a randomly chosen subset @xmath98 $ ] of size @xmath99 , the entropy of @xmath191 is approximately equal to @xmath192 .    to abbreviate the notation",
    ", we will define @xmath193\\\\ { x_{>n}}&=\\emptyset\\ \\end{aligned}\\ ] ] for any such @xmath1-tuple .",
    "the first step is what we call a _ splitting step : _ the chain - rule   implies that the entropy @xmath194 can be decomposed into its constituents , @xmath195\\ .\\end{aligned}\\ ] ] in other words , we have split the entropy into a sum of individual components .",
    "if we now select a subset @xmath98 $ ] of @xmath89 indices at random , then chernoff s inequality implies that the inequality @xmath196 holds except with probability exponentially small in @xmath4 .",
    "note that this holds more generally for any @xmath100-sampler @xmath88 with corresponding adaptations .    by strong subadditivity",
    ", we have @xmath197\\ , \\label{eq : strongsubapp}\\end{aligned}\\ ] ] where @xmath198 is the concatenation of all variables @xmath199 with @xmath200 and @xmath201 . with this inequality we can essentially eliminate all variables @xmath150 with @xmath202 from our inequalities .",
    "the final step is what we call a _ recombination step _ : using the chain rule once again , we obtain with   @xmath203 in other words , we can get a lower bound on the joint entropy @xmath204 by combining the individual contributions @xmath205 .    with",
    ", we conclude that with all but exponentially small probability , the ( shannon)-entropy rate is preserved when selecting a random subset .",
    "the proof of our main result for min - entropy follows the same lines , with a modified chain - rule for min - entropies .",
    "notice that the chain - rule in the form   can be seen as the combination of two inequalities , @xmath206 both of which are used in the proof sketch .",
    "indeed , the first inequality   allows us to divide the joint entropy @xmath194 into a sum of individual contributions , whereas the second inequality   provides a lower bound on the joint entropy @xmath191 in terms of its components .",
    "we refer to the first application as a _ splitting _ and the second application as a _",
    "recombination step_. for the min - entropy , these two steps are more involved ; we do not only split and recombine entropies , but corresponding quantum states , as explained in the next section .",
    "the subadditivity property   is easily shown to hold for the min - entropy .",
    "similarly , a recombination - chain - rule   can be proved for min - entropy",
    ". however , the splitting - chain rule   is no longer true for min - entropies and has to be replaced by a more subtle statement .",
    "this can be seen as a quantum version of the _ entropy splitting lemma _ proposed in  @xcite .",
    "it is a major component of our proof and may be of independent interest .    to state this modified splitting - chain - rule ,",
    "consider a state @xmath207 with purification @xmath208 .",
    "we will construct a decomposition @xmath209 of @xmath208 into mutually orthogonal subnormalised states @xmath210 such that @xmath211 for every @xmath212 .",
    "in contrast to  , this statement splits the entropy into a sum of individual entropies of states which are _ different _ from the original state @xmath208 .",
    "they are , however , directly related to @xmath208 by  ; we call these states _ split states_.    for technical reasons , it will be convenient to have a version of   which decomposes @xmath208 into a fixed number @xmath213 of states .",
    "the indices @xmath212 are then from the set @xmath214:=\\{1,\\ldots , m\\}$ ] , and   is replaced by @xmath215\\ ,   \\end{aligned}\\ ] ] where @xmath216 is function of @xmath208 which can be bounded in situations of interest .",
    "( the exact statement is given as corollary  [ cor : split ] below . ) an important property of the split states is that each @xmath217 is the result of applying a projection @xmath218 to @xmath208 , where @xmath218 only acts non - trivially on systems @xmath142 and @xmath219 .",
    "decomposing a state @xmath220 into a sum of mutually orthogonal states @xmath221}$ ] gives us a convenient way of bounding the ( smooth ) min - entropy of @xmath220 .",
    "the general procedure is as follows : suppose for example that our aim is to bound the quantity @xmath222 from below",
    ". we will show that if the entropy @xmath223 is large for every split state @xmath224 , then the same is true for the quantity @xmath225 ( up to a correction of size @xmath226 , see lemma  [ lem : recombinationbasic ] for a precise statement ) .",
    "we can use this fact to show that a state @xmath220 is close to a state @xmath227 with large min - entropy @xmath228 .",
    "we start from an arbitrary orthogonal decomposition of @xmath220 of the form   into @xmath154 states @xmath229}$ ] .",
    "we then identify a subset @xmath230 $ ] with the property that @xmath231 we define the _ partially recombined state _",
    "@xmath232 we can show that @xmath233 is large .",
    "moreover , since the states @xmath221}$ ] are assumed to be orthogonal , we can bound the distance of @xmath227 to the original state @xmath220 by an expression of the form @xmath234 , where @xmath235 is the weight of @xmath236 under the probability distribution @xmath237 on @xmath214 $ ] . in this way , showing that the smooth min - entropy @xmath238 of @xmath220 is lower bounded by a value @xmath239 reduces to showing that the corresponding set @xmath236 has a large weight under  @xmath240 .",
    "let us now return to our original problem : given a quantum state @xmath241 with purification @xmath242 , we would like to show that @xmath243 is large with high probability over the choice of @xmath98 $ ] . to illustrate the required steps in the proof ,",
    "let us consider a simple example where @xmath244 .",
    "the first step is to apply the splitting rule to @xmath242 , dividing the joint entropy @xmath245 into a contribution from @xmath246 and the remainder .",
    "this gives @xmath154 states @xmath247}$ ] with the property that for all @xmath248 $ ] , @xmath249 ( here @xmath250 denotes the density operator corresponding to @xmath251 . )",
    "we then apply the splitting - chain - rule to each of these states in order to split @xmath252 into the contribution of @xmath253 and the remaining part .",
    "this results , for each @xmath254 $ ] , in a collection of states @xmath255}$ ] satisfying @xmath256 finally , dividing the last term into contributions from @xmath257 and @xmath258 , we get , for each @xmath259 ^ 2 $ ] , a family of states @xmath260}$ ] such that @xmath261 this completes the splitting step . summarising , we have obtained a collection of states starting from @xmath242 : those states @xmath262}$ ] obtained by applying the splitting - chain - rule once , the states @xmath263 ^ 2}$ ] corresponding to states that are the result of splitting twice and so on .    a useful geometric visualisation ( which is , however , not essential for the proof ) is obtained by placing these states at the vertices of an @xmath154-ary tree ( in this case of depth @xmath264 ) . we place @xmath242 at the root , and the descendants of each vertex are the split states obtained by splitting .",
    "thus every @xmath264-tuple @xmath265 ^ 3 $ ] specifies a path with vertex labels @xmath266 from the root to a leaf .",
    "let us combine inequalities   into @xmath267 ^ 3\\ .\\end{aligned}\\ ] ] by attaching the entropies of interest to the edges of the mentioned tree , we can interpret this inequality as expressing the fact that the sum of the values of the edges along each path of the tree from the root to a leaf is lower bounded by @xmath268 .    the next things to consider are the sampling- and recombination step .",
    "our aim is to show that the smooth entropy @xmath269 is large ( with high probability over the choice of the subset @xmath270 $ ] ) .",
    "we follow the procedure outlined in the previous section .",
    "that is , we define the recombined state @xmath271 where @xmath272 is the set of paths @xmath273 ^ 3 $ ] with the property that @xmath274 in other words , we restrict our attention to paths ( and corresponding states ) which ( when restricted to @xmath88 ) , have large entropy .",
    "we then need to show the following :    a.   [ it : samplercorrectness ] with high probability over the choice  @xmath88 , the state @xmath275 is close to @xmath242 b.   [ it : entropypsihat ] the entropy @xmath276 is large .",
    "the proof of   again involves a bound of the form @xmath277 where @xmath278 , @xmath273 ^ 3 $ ] is a ( fixed ) probability distribution on the leaves .",
    "we will show that a sampler has the following property , when applied to the situation described above ( see section  [ sec : averagingsamplersmatrix ] ) : with high probability over the choice of @xmath88 , the weight @xmath279 is large .",
    "more generally , we show how the sampler - property extends from a single sequence of values to the case of a matrix of values ( in our case corresponding to edges of a tree ) .",
    "the proof of   is done inductively using subadditivity , the recombination - chain - rule , and the recombination argument outlined above .",
    "for concreteness , suppose for example that @xmath280",
    ". then we have @xmath281 for all @xmath282 ^ 3 $ ] .",
    "it is convenient to rephrase this as follows , writing @xmath283 .",
    "we then have for all @xmath284 ^ 2 $ ] @xmath285 in particular , when we apply this to the ( intermediate ) partially recombined states @xmath286 we obtain @xmath287 we will also use the fact that the recombined states satisfy @xmath288 ( see lemma  [ lem : subsetgammastates ] ) .",
    "subadditivity gives @xmath289 for all @xmath284 $ ] . with the previous two inequalities ,",
    "we therefore get @xmath290 this in turn implies @xmath291 ^ 2\\end{aligned}\\ ] ] by the recombination - chain - rule .",
    "because @xmath292 can be written as sum of the states  , the recombination - procedure then gives @xmath293 as claimed .",
    "this line of argument can be followed more generally for a general subset @xmath98 $ ] .",
    "we will need intermediate ( partially ) recombined states @xmath294^j } , j\\in [ n]$ ] ; these can again be thought of as being attached to the vertices of a tree .",
    "they are defined recursively , by recombining `` good '' states ( i.e. , those corresponding to prefixes of elements in @xmath272 ) . in other words ,",
    "when recombining , we work our way up the tree ( omitting `` bad '' states , i.e. , those with small entropies . )    this concludes our sketch proof ; it is now time to elaborate on the details .",
    "in this section , we set the ground for our result concerning samplers .",
    "in particular , we formally introduce the conditional min - entropy @xmath295 in section  [ sec : basicdefinitionsh ] .",
    "this will be done via an intermediate quantity @xmath296 .",
    "most of our rules for min - entropy , the most basic of which are stated in section  [ sec : basicrules ] , apply to these intermediate quantities ; they will be our main object of study . in section  [ sec : entropysplitting ]",
    ", we establish our central splitting - chain - rule .      throughout , we consider nonnegative operators acting on finite - dimensional hilbert spaces ( or _ systems _ ) @xmath297 and their tensor products .",
    "we use subscripts to indicate which systems an operator acts on .",
    "we also use subscripts when we trace out systems , but sometimes make use of superscripts to denote `` tracing out everything but '' , in the following sense : for a tripartite state @xmath207 , we write @xmath298 for the reduced density operator on @xmath142 . as explained above , we sometimes abuse notation by omitting identities . for example , we will write operator inequalities such as @xmath299 for a bipartite operator @xmath300 and an operator @xmath301 on @xmath302 . by this inequality ,",
    "we simply mean @xmath303 ( which is defined by the condition that @xmath304 is a nonnegative operator ) . more generally , when writing operators on multipartite systems , we omit identities whenever a unique meaningful statement can be obtained by tensoring corresponding identities to the operators .",
    "to give an example , we will write expressions such as @xmath305 where the operators act on the spaces indicated by subscripts , instead of @xmath306    basic properties of operator inequalities we need are their preservation under partial traces and the application of operators , i.e. , the fact that @xmath307 implies that @xmath308 and @xmath309 for any operator @xmath310 on @xmath311 .    for two operators @xmath300 on @xmath311 and @xmath301 on @xmath302 such that the support of @xmath312 is contained in the support of @xmath301 , the _ conditional operator _",
    "@xmath313 is defined as , definition   coincides with the conditional operator @xmath314 discussed , e.g. , in  @xcite . ]",
    "@xmath315here @xmath316 , where @xmath317 is the _ generalised inverse _ of an operator @xmath318 is defined as the operator which has the same eigenspaces as @xmath318 with zero eigenvalue on the null eigenspace of @xmath318 and eigenvalues @xmath319 on the eigenspace of @xmath318 corresponding to the eigenvalue @xmath320 . ] of @xmath301 .",
    "an important property of conditional operators is that @xmath321 for any tripartite operator @xmath207 .",
    "we will say that a bipartite operator @xmath322 on @xmath323 is _ classical on @xmath142 ( relative to an orthonormal basis @xmath324 of @xmath325 ) _ if it has the form @xmath326 .",
    "clearly , if @xmath322 is classical on @xmath142 relative to @xmath324 , then so is @xmath327 , for any operator of the form @xmath328 .",
    "it is easy to verify that this statement is still true when considering purifications and additional classical systems : if @xmath329 is such that the reduced density operator @xmath330 is classical on both @xmath142 and @xmath172 ( relative to some orthonormal bases ) then the same is true .",
    "classicality of the state @xmath330 on @xmath142 and @xmath172 then implies that @xmath331 whenever @xmath332 .",
    "the claim can then be deduced from the fact that @xmath333 . ] for the state @xmath334 .",
    "as already mentioned , every pair of operators @xmath300 on @xmath311 and @xmath301 on @xmath302 such that the support of @xmath312 is contained in the support of @xmath301 give rise to a conditional operator @xmath313 .",
    "is contained in the support of @xmath301 , such that the conditional operator is well defined .",
    "] we define the quantity @xmath296 as minus the logarithm are binary ; natural logarithms will be denoted by @xmath335 .",
    "] of the maximal eigenvalue of this conditional operator , that is @xmath336 in some sense , this can be read as `` the entropy of @xmath337 when it is conditioned on @xmath301 '' ; in the case where @xmath142 is classical , the operator @xmath301 is related to a measurement on @xmath302 ( which is supposed to reproduce the value on @xmath142 , see  @xcite ) .    maximising this quantity over all nonnegative trace - one operators",
    "@xmath301 whose support contains the support of @xmath312 gives the _ min - entropy of @xmath142 given @xmath172 _ , defined as , the quantity @xmath225 was introduced without explicit reference to the intermediate quantities @xmath296 . ]",
    "@xmath338 this quantity has a simple operational interpretation , as will be shown in a forthcoming publication  @xcite : it is equivalent to the maximal probability of guessing @xmath142 given @xmath172 , in the case where @xmath142 is classical .    while   is ultimately the quantity of interest , the intermediate quantities @xmath296 are easier to manipulate , and satisfy various useful rules .",
    "as we will see below , most of these follow more or less directly from the alternative characterisation @xmath339 in terms of a family of operator inequalities .    for consistency reasons ,",
    "it is convenient to set @xmath340 where @xmath341 .",
    "note that the latter quantity is equal to @xmath296 if the hilbert space @xmath325 corresponding to system @xmath142 is trivial , i.e. , @xmath342 .",
    "we can think of the quantity @xmath343 as a conditional entropy obtained by adjoining a trivial system to @xmath172 using the isomorphism @xmath344 .",
    "informally , this corresponds to a situation where we condition `` nothing '' on @xmath301 ; formally , it will turn out to be convenient to define @xmath345 .",
    "finally , we will also ( formally ) encounter situations where @xmath346 ; in these cases , we formally set @xmath347 , @xmath348 , meaning that an arbitrarily large value can be assigned to these quantities in any identity where they appear .    for a parameter @xmath163 ,",
    "the @xmath26-smooth min - entropy of @xmath142 given @xmath172 is equal to ( cf .",
    "@xcite ) @xmath349 where the supremum is over all nonnegative operators @xmath350 with trace bounded by  @xmath351 in an @xmath26-ball around @xmath300 .",
    "( here @xmath352 is the @xmath353-norm . )",
    "as already mentioned , the ( smooth ) entropy @xmath134 captures the number of secret bits extractable from @xmath9 with respect to an adversary holding  @xmath10 .",
    "the following lemma justifies this operational interpretation .",
    "[ lem : hminextractablekeylength ] consider a state @xmath125 where @xmath9 is classical .",
    "let @xmath354 denote the completely mixed state on @xmath355 .",
    "then    a.   [ it : leftover ] for any @xmath356 , there is a function @xmath357 ( independent of @xmath358 ) which extracts an @xmath37-bit string @xmath359 from @xmath9 , such that @xmath18 is @xmath26-close to uniform and independent of @xmath360 , where @xmath31 is a uniform and independent seed . in formulae",
    ", we have @xmath361 b.   [ it : optimalityleftover ] for any function @xmath362 and @xmath38 , the inequality @xmath363 implies @xmath364    statement   is a reformulation of the fact that the two - universal hashing construction is a quantum extractor , as shown by renner  @xcite .    for the proof of  , let @xmath365 .",
    "then , obviously @xmath366 because @xmath367 , this implies @xmath368 since the min - entropy can only decrease when applying a function ( see  @xcite ) , we conclude that @xmath369 as desired .",
    "we now summarise a few basic rules for the quantities @xmath370 which directly follow from   using standard properties of operator inequalities , as described in section  [ sec : preliminaries ] .",
    "[ lem : hminprop ] the min - entropy satisfies the following .",
    "a.   * ( positivity for classical systems)*[it : classicalcond ] let @xmath371 be classical on @xmath142",
    ". then @xmath372 . b.   * ( dimension bound)*[it : hzerobound ] for any @xmath300 and @xmath301 with @xmath373 , we have @xmath374 , where @xmath375 .",
    "in particular , @xmath376 .",
    "more generally @xmath377 for any @xmath207 and @xmath378 . c.   * ( subadditivity)*[it : simplesubadditivity ] @xmath379 for any @xmath380 and @xmath381 .",
    "d.   * ( recombination - chain - rule)*[it : chainrule ] @xmath382 for any @xmath380 and @xmath383",
    ".    directly follows from @xmath384 for all @xmath385 .    for the proof of the first part of",
    ", we simply take the trace on both sides of the inequality @xmath386 to get @xmath387 , which gives the claim because @xmath388 . for the proof of the second part of  ,",
    "observe that we have @xmath389 by definition .",
    "tracing out the system @xmath142 gives @xmath390 the claim   then follows from the definition of @xmath391 .",
    "similarly ,   directly follows by tracing out @xmath392 from the inequality @xmath393    for the proof of  , observe that @xmath394 the claim follows from the definition of @xmath395 .",
    "we point out that   and   directly translate into the statements @xmath396 for the min - entropy .",
    "an analogous statement can not be made for the recombination - chain - rule  , and we will have to retain the dependence on @xmath383 in our arguments .    having established subadditivity and a recombination - chain - rule , we will address the problem of finding a converse splitting - chain - rule in the next section . before doing so , however , we will mention another property of the min - entropy which will be important for our purposes .",
    "this is the fact the entropy of a state @xmath397 obtained by applying a projection to a state @xmath242 is lower bounded by the entropy of the original state .",
    "we will later see that this allows us to retain information about the entropy when going from a state to its split descendants .",
    "note that this statement is not generally true , but depends crucially on where the projection acts .",
    "[ lem : projectionmonotony ] let @xmath220 be a pure state , let @xmath398 be an operator on  @xmath392 and let @xmath399 .",
    "let @xmath207 and @xmath400 be the corresponding density operators . then @xmath401 furthermore , if @xmath398 is a projector , then @xmath402 for arbitrary @xmath403 .",
    "to prove the first inequality , let @xmath398 be arbitrary .",
    "applying @xmath398 from the left and @xmath404 from the right to both sides of the inequality @xmath405 gives @xmath406 by definition of @xmath407 and the properties of the partial trace .",
    "this proves the first inequality .",
    "let now @xmath398 be a projector , and let @xmath408 be arbitrary .",
    "then @xmath409 by the cyclicity of the trace and the fact that @xmath398 is a projector .",
    "in particular , with @xmath410 denoting the projector onto the orthogonal complement of the image of @xmath398 , we have @xmath411 we conclude that @xmath412 .",
    "in particular , @xmath413 which implies the claim .      to introduce our splitting - chain - rule",
    ", we proceed in two steps : in section  [ sec : warmup ] , we show a simplified version which does not restrict the number of states the original state is split into . as this is irrelevant for the remainder of our proof , this section can be skipped ; however , it nicely illustrates the relevant features .",
    "the case of interest , where we split a given state into a fixed number @xmath154 of states , can be seen as a coarse - graining of the former",
    ". it will be the topic of section  [ sec : coarsegraining ] .",
    "the chain - rule we will prove in this section concerns a tripartite state @xmath207 with purification @xmath414 and an operator @xmath383 .",
    "we will show that we can split @xmath208 into a sum of states @xmath210 as in  , in a way that @xmath415 where @xmath416 .",
    "note that by taking the supremum over @xmath301 , we immediately obtain the inequality @xmath417 from  .",
    "however ,   makes a stronger assertion , and we will generally deal with statements of this form .    for the proof of  , consider the eigendecomposition @xmath418of the conditional operator , where @xmath419 is the projector onto the eigenspace corresponding to the eigenvalue @xmath212 .",
    "we will use the operators @xmath419 to define our split states , which will be labeled by the spectrum of @xmath420 .",
    "clearly , if we apply @xmath419 on both sides of the operator @xmath420 , we end up with an operator which has a single non - zero eigenvalue @xmath212 .",
    "while @xmath421 thus has a very simple form , it is very different in nature from the original `` unconditional '' operator @xmath422 .",
    "intuitively , it therefore makes sense to multiply by @xmath383 .",
    "the appropriate definition of @xmath217 turns out to be just the result of this , i.e. , we can define contains the support of @xmath423 , hence , @xmath383 is invertible on the relevant subspace . ]",
    "@xmath424 it is easy to check that these states decompose @xmath208 as in  .",
    "they also satisfy  , as we will show now .",
    "first observe that @xmath425 by their very definition , and thus @xmath426 in particular , we have @xmath427 which implies that @xmath428 combining   and   gives the statement @xmath429    by definition of the quantity @xmath430 , we also have @xmath431 . applying the projector @xmath419 on both sides of this inequality leads to @xmath432 multiplying this inequality from both sides by @xmath433 immediately gives the desired statement  , since @xmath434 .",
    "this concludes the proof of our simplified statement , where a state @xmath208 is split into a family @xmath210 , each of which obeys the splitting - chain - rule inequality  .",
    "the number of states is determined by the number of different eigenvalues of the operator @xmath420 ; indeed , each state @xmath217 corresponds to an eigenvalue @xmath212 .    before continuing ,",
    "let us show the following useful properties of the states @xmath210 : they are mutually orthogonal , and each state @xmath435 is the result of applying a projection @xmath436 ( which acts non - trivially only on @xmath142 and @xmath219 ) to @xmath208 .",
    "this statement is the result of using the complementarity property that is inherent in quantum states .",
    "first observe that @xmath437 is a purification of the conditional operator @xmath420 .",
    "using the schmidt - decomposition , we can write @xmath438 where @xmath439 and @xmath440 are eigenvectors with eigenvalue @xmath212 of @xmath441 and @xmath420 , respectively ( slightly abusing notation , we omit multiplicities ) . we can define @xmath436 as the projector onto the eigenspace of @xmath441 corresponding to the eigenvalue @xmath212 .",
    "we then clearly have @xmath442 for every @xmath212 . since @xmath433 and @xmath436 act on different systems , they commute , and we obtain @xmath443 as claimed .",
    "the orthogonality of these states is now immediate .      in this section ,",
    "we show that the construction discussed in section  [ sec : warmup ] can be adapted to yield a fixed number @xmath154  of states .",
    "this is quite straightforward : we simply divide the spectrum of the conditional operator @xmath420 into @xmath154 different intervals @xmath444\\mu_{\\alpha-1},\\mu_{\\alpha}]$ ] , for @xmath445 $ ] . instead of projecting onto the eigenspace corresponding to a single eigenvalue , we use projectors @xmath419 onto the direct sum of eigenspaces associated with eigenvalues in the corresponding interval .    [ lem : splitfirst ]",
    "let @xmath414 be a pure state and let @xmath383 be a nonnegative operator .",
    "let @xmath446 be an @xmath447-tuple of monotonically increasing real values with minimum and maximum given by @xmath448 then there are mutually orthogonal projectors @xmath449}$ ] with the property that @xmath450 where @xmath451 is defined as @xmath452 an alternative expression for these states is @xmath453 where @xmath454}$ ] are mutually orthogonal projectors .",
    "they satisfy @xmath455}{|\\psi^{\\alpha}\\rangle}={|\\psi\\rangle}\\end{aligned}\\ ] ]    note that , according to the chain rule ( lemma  [ lem : hminprop ]  ) , @xmath456 , i.e. , there always exists a tuple of reals as defined in the lemma .    the proof of this statement is almost identical to the proof given in section  [ sec : warmup ] , but given here for completeness . for any @xmath457",
    "$ ] , define @xmath458 , and let @xmath459 , @xmath460 .",
    "note that @xmath461 is a monotonically decreasing sequence of values .",
    "consider the schmidt - decomposition @xmath462 of the `` conditional '' state @xmath437 ( the sum may include multiplicities ) .",
    "for every @xmath445 $ ] , we define the projectors @xmath419 and @xmath436 as @xmath463\\mu_\\alpha,\\mu_{\\alpha-1}]}{{|\\lambda\\rangle}{\\langle \\lambda|}}_{bc}\\\\ q^\\alpha_{ad}&=\\sum_{\\lambda\\in    ] \\mu_\\alpha,\\mu_{\\alpha-1}]}{{|\\lambda\\rangle}{\\langle \\lambda|}}_{ad}\\ .\\end{aligned}\\ ] ] by definition , these operators satisfy   and  .",
    "moreover , using the fact that @xmath436 commutes with @xmath464 , we conclude that   and   define the same state @xmath217 .",
    "since @xmath465 is the projector onto the eigenspaces of @xmath420 which belong to the eigenvalues in @xmath444\\mu_\\alpha,\\mu_{\\alpha-1}]$ ] for every @xmath445 $ ] , we have @xmath466    we show that @xmath467\\ .\\label{eq : halphap }    \\end{aligned}\\ ] ] this follows directly from   for @xmath468 since @xmath469 ; for @xmath470 , it is a consequence of the fact that the eigenvalues of @xmath420 are upper bounded by @xmath471 by definition of @xmath472 .",
    "claim   now directly follows from   and the fact that @xmath473 .",
    "next we show that @xmath474\\   .\\label{eq : halphapsecond }    \\end{aligned}\\ ] ] we distinguish two cases : for @xmath475 , identity   is equivalent to @xmath476 because of the definition of @xmath477 . but",
    "this directly follows from @xmath478 by multiplication from both sides with @xmath479 and its adjoint .    for @xmath480",
    ", we use the fact that the first inequality of   is equivalent to @xmath481 since @xmath482 . substituting this into the inequality @xmath483 ( which directly follows from @xmath484 ) immediately gives   for all @xmath480 .",
    "this concludes the proof of the auxiliary statement  .",
    "the proof of   is now straightforward , based on  . multiplying the latter inequality by @xmath433 from both the left and the right yields @xmath485 which implies  .    in the previous lemma",
    ", we did not specify the intervals @xmath444h_{\\alpha-1},h_\\alpha]$ ] that are used to partition the spectrum of the conditional operator @xmath420 .",
    "a simple choice is to partition the spectrum into @xmath154 intervals of equal length .",
    "this results in the following splitting - chain - rule , which will be our basic tool in what follows .",
    "[ cor : split ] let @xmath414 be a pure state and let @xmath383 be a nonnegative operator . then for any @xmath486 @xmath487 where @xmath488 and where @xmath451 is defined by   or   in terms of families of mutually orthogonal projectors @xmath449}$ ] and @xmath454}$ ] , as in lemma  [ lem : splitfirst ] .",
    "we are usually able to obtain a bound on @xmath216 ; for a comparatively large value of @xmath154 , we therefore get an approximation of  , which is a converse to the recombination - chain - rule ( item   of lemma  [ lem : hminprop ] ) .    here",
    "we choose @xmath489 for all @xmath490 .",
    "we point out that the statement of corollary  [ cor : split ] is also valid with @xmath172 removed from all expressions .",
    "this is because we can always adjoin a trivial system  @xmath172 with hilbert space @xmath491 .    ) .",
    "a state @xmath242 can be decomposed into a sum of @xmath154  orthogonal states ; in the figure , @xmath492 .",
    "we illustrate this by a tree ; the original state sits at the root , whereas the split states sit at nodes labeled by @xmath493 $ ] .",
    "the state at the root is the sum of its descendants , which are identical to the leaves in this case .",
    "going from a node to its descendants is achieved by applying corresponding projection operators .",
    "[ fig : basicsplitting ] ]    for later use , we establish a few additional properties of the states @xmath217 .",
    "we first show that the states @xmath217 have the same classicality properties as the original state @xmath208 .",
    "[ rem : classicality ] suppose that @xmath494 is bipartite , and that @xmath495 is classical on @xmath142 , @xmath172 , and @xmath496 ( relative to some orthonormal bases of these subsystems ) .",
    "then @xmath497 is classical on @xmath142 , @xmath172 , and @xmath496 ( relative to the same bases ) , for any @xmath445 $ ] .    according to the discussion at the end of section  [ sec : preliminaries ] about classical states and",
    ", it suffices to show that the operator @xmath498 has the form @xmath499 for some operators @xmath500 on @xmath392 , where @xmath501 is the eigenbasis of @xmath312 .",
    "because @xmath464 acts only on @xmath392 , the state @xmath437 is classical on @xmath172 when tracing out @xmath142 and @xmath219 , i.e. , @xmath502 for some nonnegative operators @xmath503 on @xmath392 , because this is true for the original state @xmath208 by assumption .",
    "in particular , the eigenvectors of @xmath420 are of the form @xmath504 .",
    "since @xmath419 is a projector onto an eigenspace of this operator , this proves that @xmath419 has the form @xmath505 for some operators @xmath506 on @xmath392 .",
    "this immediately gives the claim  .    as explained in section  [ sec : splittingsamplingrecombining ] , we will later apply the splitting - chain - rule recursively . in particular , we will further split up split states .",
    "conveniently , orthogonality properties are preserved under such successive splitting operators , as we now explain .    for concreteness ,",
    "suppose that we split a state @xmath507 into states @xmath508 satisfying @xmath509 assume further that @xmath510 is bipartite .",
    "we can then split each @xmath511 further into a family of states @xmath512 such that @xmath513 for all @xmath514 .",
    "diagrammatically , the grouping / splitting of systems can be drawn as @xmath515 clearly , a desirable property is that these states are orthogonal , such that @xmath516 is a decomposition of @xmath507 into mutually orthogonal states",
    ".    we will prove this statement by considering the corresponding projection operators @xmath517 and @xmath518 ( where @xmath519 ) defined by the splitting - chain - rule ; i.e. , these are operators satisfying @xmath520 by definition , for every @xmath521 , the operators @xmath518 are mutually orthogonal for different @xmath522 .",
    "we will now show that these operators satisfy the inequality @xmath523 for all @xmath514 .",
    "this expresses the fact that the operators @xmath524 are a `` refinement '' of @xmath525 .",
    "in particular , their images are orthogonal for different values of @xmath521 , and we have @xmath526 ( cf . lemma  [ lem : orderingofprojectors ]  ) . in other words , each of the states @xmath527 can be obtained by applying a single projection to @xmath507 .",
    "the proof involves the following property of the projection operators .",
    "[ rem : orthogonalitypreservation ] let @xmath414 , @xmath436 , and @xmath451 be defined as in lemma  [ lem : splitfirst ] .",
    "let @xmath528 denote the projector onto the support of the operator @xmath529 .",
    "then ( see section  [ sec : preliminaries ] for more details ) . ]",
    "@xmath530 for any subsystem @xmath531 .",
    "( by that , we mean that @xmath532 is the product @xmath533 of two systems @xmath534 and @xmath535 , such that @xmath536 . )    indeed , the second inequality of this remark gives @xmath537 because @xmath519 , whereas the first inequality with @xmath538 ( recall that @xmath510 ) leads to @xmath539 this proves the fundamental property  .",
    "it remains to give a proof of the statement made in the remark .    according to lemma  [ lem : orderingofprojectors ]  , it suffices to show that @xmath540 and @xmath541 the first of these inequalities is a direct consequence of the fact that @xmath542 . to prove the second inequality , observe that @xmath436 projects onto an eigenspace of the conditional operator @xmath543 , and thus @xmath544 the inclusion   then follows because the latter set is contained in @xmath545 .",
    "this can be verified for example by using a schmidt decomposition @xmath546 of @xmath208 . in terms of this decomposition , we have @xmath547 and the support of this operator is clearly contained in @xmath548 .      as discussed in section  [ sec : partialrecombination ] , we will need a converse to the splitting rule which shows that the entropy of the original state is large if it is large for each split state . here",
    "we show how this works in detail in the most simple case . again",
    ", this section may be omitted , but it is instructive for the slightly more intricate case we will need below ( cf .  lemma  [ lem : alphamerge ] ) .    remarkably , the statement we will prove is generally true for any system @xmath534 which we do not condition on .",
    "[ lem : recombinationbasic ] let @xmath208 , @xmath549}$ ] and @xmath449}$ ] be as in corollary  [ cor : split ] .",
    "let @xmath550 be an arbitrary subsystem",
    ". then @xmath551}{h(f|c)^{}_{{\\frac{\\rho^\\alpha}{\\sigma}}}}-2\\log m\\leq { h(f|c)^{}_{{\\frac{\\rho}{\\sigma}}}}\\ .\\end{aligned}\\ ] ]    let @xmath552}{h(f|c)^{}_{{\\frac{\\rho^\\alpha}{\\sigma}}}}}$ ] .",
    "we then have @xmath553 for all @xmath554 $ ] , or @xmath555 using the commutativity of @xmath436 and @xmath383 , we can rewrite this as @xmath556\\ .\\end{aligned}\\ ] ] at this point , we use a statement about operators which we state as lemma  [ lem : alphabetmodifiedlem ] in the appendix .",
    "it tells us that the previous inequalities imply that @xmath557 where @xmath558}q^\\alpha_{ad}$ ] .",
    "recall that the operators @xmath559 are defined in terms of the eigenspaces of @xmath560 .",
    "their definition implies that @xmath561 restricted to the support of @xmath562 is equal to the identity .",
    "thus the last inequality simply says @xmath563 multiplying from the left and the right by @xmath433 gives the claim .",
    "we now return to our main problem , i.e. , the analysis of a state @xmath564 with classical part @xmath138 , and the relation of the entropy @xmath269 of a randomly chosen subset @xmath98 $ ] to the entropy @xmath565 of all classical parts .",
    "we proceed as sketched in section  [ sec : splittingsamplingrecombining ] : in section  [ sec : recursivesplitting ] , we describe the recursive splitting of the joint min - entropy @xmath566 into a sum of individual contributions of each random variable . we then discuss how high - entropy components can be recombined to a state with high min - entropy ( section  [ sec : recombiningev ] ) .",
    "in particular , we relate the smooth min - entropy @xmath567 to the probability weight @xmath568 of a certain set @xmath569 under a given distribution @xmath240 .",
    "we then study the behavior of a sampler with respect to this quantity . for this purpose",
    ", we introduce the concept of a parallel sampler  in section  [ sec : averagingsamplersmatrix ] .",
    "we then show that with high probability over the choice of @xmath88 , the probability @xmath568 of interest is large ( section  [ sec : highprobabilityweightsampling ] ) .",
    "we finally combine these components in section  [ sec : samplingandrecombining ] , where we state our main result , i.e. , the preservation of ( smooth ) min - entropy rates under sampling .",
    "we apply the splitting - chain - rule recursively to a state @xmath570 , where @xmath571 are random variables on an alphabet @xmath137 .",
    "let @xmath572 be a purification of @xmath570 ( for simplicity , we will henceforth often omit subscripts denoting systems , where there is no potential for confusion ) .",
    "furthermore , let @xmath573 be a nonnegative operator on @xmath10 . in figure",
    "[ fig : splitstates ] , we visualise the set of states introduced in the following definition by a tree .",
    "[ def : splitstates ] let @xmath574 and let @xmath575 be pure states recursively defined as follows .",
    "set @xmath576 . to obtain @xmath577 for @xmath578",
    "$ ] and @xmath579^j=[m]\\times [ m]^{j-1}$ ] , apply corollary  [ cor : split ] to the state @xmath580 with @xmath581 , @xmath582 , @xmath583 , @xmath584 .",
    "this gives projectors @xmath585 and @xmath586 ; we define @xmath577 as in corollary  [ cor : split ] as @xmath587 .    , for @xmath588 and @xmath492 . as in figure",
    "[ fig : basicsplitting ] , the immediate descendants of every node give an orthogonal decomposition of the state associated with it , and are obtained by applying corresponding projection operators . in lemma  [ lem : rhoalphajexpressions ] , we will show that the states at level @xmath589 are orthogonal , for every level @xmath590 $ ] .",
    "in particular , this means that the leaves form an orthogonal decomposition of the original state .",
    "observe that we label each vertex by the corresponding sequence of splitting operators ; in particular , the leaves carry labels @xmath591^n$].[fig : splitstates ] ]    spelling out this recursive definition , we have @xmath592 where @xmath593",
    ". the following auxiliary result will prove useful .",
    "we will apply it to show that the states on each level of the tree in figure  [ fig : splitstates ] are mutually orthogonal ( by _ level _ , we mean all vertices at a fixed depth of the tree , i.e. , distance from the root ) . in fact ,",
    "any two states in different subtrees are mutually orthogonal , but we will not need this statement here .",
    "the proof of the following lemma relies on the fact that splitting preserves orthogonality .",
    "it is analogous to the derivation of   in section  [ sec : entropysplitting ] .    [",
    "lem : qoperatorsorthogonality ] for all @xmath594 and @xmath595^j$ ] we have @xmath596 moreover , the operators @xmath597^j}$ ] are pairwise orthogonal for a fixed @xmath578 $ ] .",
    "note that the first claim trivially holds for @xmath598 since the operators are projectors .",
    "observe that for any @xmath599 , we have @xmath600 where we used remark  [ rem : orthogonalitypreservation ] twice ( with @xmath601 ) .",
    "inductively , we obtain @xmath602 for any @xmath603 .",
    "the first claim therefore follows from lemma  [ lem : orderingofprojectors ]  .",
    "the orthogonality of the operators @xmath597^j}$ ] immediately follows from the first claim : for @xmath604^j$ ] , let @xmath603 be the minimal index in which they differ , i.e. , @xmath605 and @xmath606 .",
    "we then have by the first claim @xmath607 since the operators @xmath608 and @xmath609 are orthogonal for @xmath605 .",
    "as promised , we now establish a few properties of the split states such as their orthogonality and the fact that they are partly classical as the original state .",
    "[ lem : rhoalphajexpressions ] the states introduced in definition  [ def : splitstates ] have the following properties .",
    "a.   [ it : lempropfirst ] the states @xmath610^j}$ ] are pairwise orthogonal for a fixed  @xmath578 $ ] .",
    "b.   [ it : psialphasum ] the states @xmath611^n}$ ] form an orthogonal resolution of @xmath242 , i.e. , @xmath612^n}{|\\psi^{\\alpha^n}\\rangle}={|\\psi\\rangle}$ ] . in particular , @xmath613 defines a probability distribution on @xmath214^n$ ] . c.   [ it : singleprojectorpsidef ]",
    "the state @xmath577 can be obtained by a single projection on @xmath614 , i.e. , @xmath615 .",
    "d.   [ it : classicalitysplit ] for every @xmath578 $ ] and @xmath595^j$ ] , the state @xmath616 is classical on @xmath617 .",
    "e.   [ it : hnrhosigma ] for all @xmath618 , we have @xmath619 .",
    "the probability distribution @xmath240 ( introduced in  ) on the leaves @xmath214^n$ ] of the tree in figure  [ fig : splitstates ] will play an important role in our recombination step .",
    "inequality   can be seen as an expression of the fact that splitting does not affect the part we condition on .",
    "first observe that   follows inductively from lemma  [ lem : qoperatorsorthogonality ] and expression  .",
    "similarly , the orthogonality   follows from this lemma and  .",
    "statement   follows by induction over @xmath589 from  .",
    "statement   follows inductively from remark  [ rem : classicality ] applied with @xmath620 and @xmath621 .",
    "finally , the claim   directly follows from   and lemma  [ lem : projectionmonotony ] ( with @xmath622 and @xmath623 ) .",
    "the main reason for introducing the split states @xmath624 is the fact that they allow us to split the joint entropy @xmath625 into individual contributions according to the splitting - chain - rule ( corollary  [ cor : split ] ) .",
    "we express this central result as follows .",
    "[ thm : splittoffmain ] the split states satisfy @xmath626 for any @xmath627^n$ ] .    in the following ,",
    "we sometimes refer to the empty set as @xmath628 . by construction and corollary  [ cor : split ] ,",
    "the split states satisfy the inequalities @xmath629\\ , \\ ] ] where @xmath630 . summing these inequalities over all @xmath631 $ ]",
    ", we get @xmath632 } h(x_j|{x_{>j}}e)_{\\rho^{\\alpha^{j } } }    \\geq       \\sum_{j\\in [ n]}\\bigl ( h({x_{>j-1}}|e)_{{\\frac{\\rho^{\\alpha^{j-1}}}{\\sigma } } }       - h({x_{>j}}|e)_{{\\frac{\\rho^{\\alpha^{j}}}{\\sigma } } } \\bigr ) - \\frac{1}{m}\\sum_{j\\in [ n ] } \\delta_j\\ .\\ ] ] because the rhs is a telescoping sum , i.e. , @xmath632}\\bigl ( h({x_{>j-1}}|e)_{{\\frac{\\rho^{\\alpha^{j-1}}}{\\sigma } } }        - h({x_{>j}}|e)_{{\\frac{\\rho^{\\alpha^{j}}}{\\sigma } } } \\bigr )    =       h({x_{>0}}|e)_{{\\frac{\\rho}{\\sigma } } } - h({x_{>n}}|e)_{{\\frac{\\rho^{\\alpha^n}}{\\sigma } } }    \\ , \\ ] ] this gives @xmath633 } h(x_j|{x_{>j}}e)_{\\rho^{\\alpha^{j } } }    \\geq      h({x_{>0}}|e)_{{\\frac{\\rho}{\\sigma } } } - \\frac{1}{m}\\sum_{j\\in [ n]}\\delta_j \\ .\\label{eq : vdvein}\\end{aligned}\\ ] ]    note that @xmath616 is classical on  @xmath617 , according to lemma  [ lem : rhoalphajexpressions ]  .",
    "we can therefore use the dimension bound   of lemma  [ lem : hminprop ] and the positivity of the min - entropy ( lemma  [ lem : hminprop ]  ) for classical systems to get @xmath634\\ .\\end{aligned}\\ ] ] the claim follows from this and  .    to put the statement of theorem  [ thm : splittoffmain ] into a more concise form , it is useful to think of the entropic quantities appearing on the lhs of the inequality   as attached to the tree given in figure  [ fig : splitstates ] .",
    "for convenience , we use a slightly modified tree @xmath635 which has spades attached to the leaves of the original tree ( see figure  [ fig : originaltree ] ) .    , for @xmath492 and @xmath588 .",
    "every path from the root to a leaf / spade is specified by an @xmath1-tuple @xmath636 .",
    "we will attach a weight corresponding to an entropy to every edge in the graph).[fig : originaltree ] ]     of the edges.[fig : treevsimple ] ]    we can then attach weights to the edges of @xmath635 according the rule @xmath637 given in figure  [ fig : treevsimple ] . for a path @xmath591^n$ ] from the root to a spade ( i.e. , leaf ) , we define the weight @xmath638 of the path @xmath639 as the sum of the values on the edges along this path . in particular , for the weighting @xmath637 specified by figure  [ fig : originaltree ] , the weight @xmath638 coincides with the lhs of   in theorem  [ thm : splittoffmain ] .",
    "more generally , we slightly abuse notation and define the _ value _ @xmath640 of a tree @xmath641 with weighting @xmath642 as the minimal value of a path from the root to a leaf . theorem  [ thm : splittoffmain ] can then be reformulated as follows .",
    "let @xmath635 be the tree introduced in figure  [ fig : originaltree ] , and let @xmath637 be the weighting specified by figure  [ fig : originaltree ]",
    ". then @xmath643",
    ".    we will later be interested in different weightings .",
    "we will also show a converse to this statement : if the value of a tree is large , then so is the corresponding entropy .      to show that the original state @xmath570 has a large smooth min - entropy @xmath644 for a randomly selected subset @xmath98 $ ]",
    ", we will now study how the split states can be recombined .",
    "more precisely , we are interested in properties of states @xmath292 that are obtained by summing up states @xmath645 corresponding to a subset @xmath646^n$ ] of leaves of the tree in figure  [ fig : splitstates ] .    in section  [ sec : partiallyrecombinedstatesproperties ] , we discuss how such a recombined state can be defined recursively , starting from the bottom of the tree .",
    "we then use the corresponding intermediate states in section  [ sec : recombininghighentropycomponents ] to analyse how a judicious choice of @xmath569 yields a recombined state @xmath292 with a large min - entropy @xmath647 .",
    "we are interested in properties of the state @xmath648 obtained by summing over a certain subset @xmath646^n$ ] of paths . to analyse such a `` partially recombined '' state , we will consider intermediate states attached to a tree .",
    "the state @xmath292 will sit at the root of the tree",
    ". we will refer to it as @xmath649 in the following definition , which we illustrate in figure  [ fig : recombinedstates ] .",
    "[ def : recombinedstates ] let @xmath650^n$ ] be arbitrary , and let @xmath645 for @xmath591^n$ ] be the split states introduced in definition  [ def : splitstates ] .",
    "we define the recombined states @xmath651 and let @xmath652 for all @xmath595^j$ ] . for simplicity , we omit @xmath569 in the notation .",
    ", for @xmath588 , @xmath492 and @xmath653 .",
    "we again associate every state @xmath654 with the node carrying the label @xmath595^j$ ] .",
    "we start by defining the leaves , i.e. , the states @xmath655 for @xmath591^n$ ] : for @xmath656 ( illustrated by triangles ) , we use the same leaves as in figure  [ fig : splitstates ] , i.e. , we set @xmath657 . on the other hand",
    ", we set @xmath658 for @xmath659 .",
    "we then work our way up the tree , defining the state in each node as the sum of its immediate descendants .",
    "the elements at the dotted nodes are equal to zero , whereas for example @xmath660 . clearly , the state at the root is equal to the sum of the leaves in @xmath569 , i.e. , @xmath661 .",
    "we will show in lemma  [ lem : subsetgammastates ] that the states at any given level are orthogonal , and that movement in this diagram is achieved by the same projection operators as in the tree of figure  [ fig : splitstates ] .",
    "moreover , the entropies of interest corresponding to this modified tree are at least as large as those corresponding to figure  [ fig : splitstates ] . [ fig : recombinedstates ] ]    not surprisingly , the recombined states inherit many properties of the split states .",
    "the following lemma summarises these , and is the analog of lemma  [ lem : rhoalphajexpressions ] .",
    "[ lem : subsetgammastates ] the recombined states have the following properties .",
    "a.   [ it : lemrecombinedorthogonality ] the states @xmath662^j}$ ] are orthogonal for a fixed @xmath578 $ ] .",
    "b.   [ eq : psibsumid ] the states @xmath662^j}$ ] form a resolution of @xmath663 , i.e. , @xmath664}{|{\\widehat{\\psi}}^{\\alpha^j}\\rangle}={|{\\widehat{\\psi}}^{\\alpha^{j-1}}\\rangle}$ ] . c.   [ eq : rhobrecursion ] the states satisfy the recursion relation @xmath665 for all @xmath578 $ ] and @xmath595^j$ ] .",
    "d.   [ it : directbpsiprojections ] for every @xmath666 , there is a projector @xmath667 such that @xmath668 . in particular , for @xmath618 arbitrary , we have @xmath669 .",
    "e.   we have [ eq : rhobentropy ] @xmath670 for all @xmath578 $ ] and @xmath595^j$ ] .",
    "f.   for all @xmath591^n$ ] , we have @xmath671.[it : equalityalphan ]    the recursion relation   will be most important in our analysis .",
    "it provides a means of studying properties of the corresponding states in a recursive manner , moving up the tree in figure  [ fig : recombinedstates ] to the root .",
    "the orthogonality   of the states @xmath672 is a direct consequence of the orthogonality of the states @xmath673 ( cf .",
    "lemma  [ lem : rhoalphajexpressions ]  ) .",
    "identity   also follows from the definition of @xmath674 .    for the proof of  ,",
    "observe that @xmath675 by lemma  [ lem : qoperatorsorthogonality ] . applying this to compute @xmath676",
    "immediately gives the claim  .",
    "defining @xmath677 and using the fact that @xmath678 and @xmath679 proves the first part of   because of lemma  [ lem : qoperatorsorthogonality ] and lemma  [ lem : rhoalphajexpressions ] .",
    "the second part of   follows from lemma  [ lem : projectionmonotony ] .",
    "next we prove  .",
    "note that the statement holds trivially for @xmath680 and @xmath681 , since in this case @xmath682 by definition  [ def : recombinedstates ] .",
    "if @xmath680 and @xmath659 , then @xmath683 and @xmath684 by definition , hence   also holds in this case . assume now that @xmath685 .",
    "we have @xmath686 for the operator @xmath687 , by definition  [ def : recombinedstates ] and  .",
    "the claim   therefore follows from lemma  [ lem : projectionmonotony ] .    for the proof of statement",
    ", we again use the fact that @xmath682 if @xmath681 and @xmath683 otherwise .",
    "in particular , we have @xmath688 in the former and @xmath689 in the latter case .",
    "hence the claim   follows .",
    "we next prove an analog of the basic recombination lemma ( lemma  [ lem : recombinationbasic ] ) for the partially recombined states @xmath690 . in terms of the position of the corresponding states in the described tree , it expresses the fact that the entropies of interest do not decrease significantly when we move from one level up to another level closer to the root .",
    "[ lem : alphamerge ] for all @xmath691 $ ] ( possibly empty ) , @xmath692 $ ] and @xmath693^{i-1}$ ] @xmath694 }     h(x_{\\mathcal{a}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^{i}}}{\\sigma}}}-2\\log m\\leq h(x_{{\\mathcal{a}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^{i-1}}}{\\sigma}}}\\ .\\ ] ]    let @xmath693^{i-1}$ ] be fixed and let @xmath695 }      h(x_{\\mathcal{a}}|e)_{\\frac{{\\widehat{\\rho}}^{\\alpha^{i}}}{\\sigma}}}$ ] , where @xmath696 . by definition @xmath697\\ .",
    "\\end{aligned}\\ ] ]    to relate this to @xmath698 , we use the recursion relation   of lemma  [ lem : subsetgammastates ] to rewrite   as @xmath699\\   .",
    "\\end{aligned}\\ ] ] lemma  [ lem : alphabetmodifiedlem ] thus implies @xmath700 where @xmath701}q^{\\alpha^i}_{{x_{\\leq i}}r}$ ] .",
    "but @xmath702 where we used   and   of lemma  [ lem : subsetgammastates ] . inserting this into   gives @xmath703 which concludes the proof .",
    "we now study the entropies associated with recombined states , in the special case where @xmath646^n$ ] is chosen as the set of `` high - entropy paths '' for a subset @xmath88 .",
    "our main result of this section is theorem  [ thm : recombining ] , which expresses the fact that the corresponding entropy @xmath704 is large .     of the edges of @xmath635 .",
    "the weighting @xmath705 is defined analogously , with @xmath706 replaced by @xmath707.[fig : simplevsweighting ] ]    let us fix a subset @xmath98 $ ]",
    ". we will be interested in the entropies of variables @xmath150 with @xmath201 .",
    "that is , we consider the weighting @xmath708 defined by figure  [ fig : simplevsweighting ] of the tree @xmath635 introduced after theorem  [ thm : splittoffmain ] .",
    "a given path @xmath591^n$ ] in @xmath635 then has weight @xmath709 by definition in @xmath710 , as we will be dealing with several different ( sub)trees . ] .",
    "we can not expect this to be large for all @xmath591^n$ ] ; in particular , the value @xmath711 will in general be small .",
    "we therefore introduce the following sets .",
    "[ def : lambdagoodset ] for @xmath712 and @xmath98 $ ] , let @xmath713^n$ ] be the set of @xmath1-tuples @xmath591^n$ ] with @xmath714 we call @xmath713^n$ ] the set of _ @xmath239-good paths for @xmath88_.    the choice of the normalisation factor @xmath715 will become clearer in the sequel when we relate the quantity @xmath716 to the _ entropy - rate _",
    "@xmath717 .",
    "let us consider states that arise when recombining only @xmath239-good paths .",
    "that is , we fix @xmath712 , a subset @xmath98 $ ] of size @xmath99 , and let @xmath718 be the set of @xmath1-tuples specified by definition  [ def : lambdagoodset ] .",
    "we then define the partially recombined states @xmath719 as in definition  [ def : recombinedstates ] .",
    "note that the recombined states give rise to a weighting @xmath705 of the tree @xmath635 as in figure  [ fig : simplevsweighting ] .",
    "contrary to the original weighting @xmath708 , this weighting assigns a large weight to every path .",
    "that is , we have the statement    [ lem : treevlabelinglowerbound ] @xmath720 .    in other words , when considering the recombined states , all paths are @xmath239-good .",
    "this is not the case for the original split states .",
    "suppose first that @xmath721^n$ ] .",
    "then @xmath722 $ by lemma~\\ref{lem : subsetgammastates}~\\eqref{eq : rhobentropy } and } \\\\   { h(\\emptyset|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^n}}{\\sigma}}}}&\\geq { h(\\emptyset|e)_{{\\frac{\\rho^{\\alpha^n}}{\\sigma } } } } \\qquad & \\textrm{by lemma~\\ref{lem : subsetgammastates}~\\eqref{it : equalityalphan}}\\ .\\end{aligned}\\ ] ] this directly gives @xmath723 for @xmath724 . on the other hand , if @xmath725 , then we have @xmath726 which implies that @xmath689 and thus @xmath727 .",
    "the claim follows by taking the minimum over @xmath591^n$ ] .",
    "next we apply subadditivity , to go from the weighting @xmath728 defined by figure  [ fig : simplevsweighting ] to the weighting @xmath729 introduced in figure  [ fig : subadditivityweighting ] .",
    "this weighting assigns the weight @xmath730 to a path @xmath639 in the tree @xmath635 .",
    "we then have the inequality    [ lem : subadditivitytrees ] @xmath731 .    with subadditivity ( lemma  [ lem : hminprop ]  ) , it is straightforward to show that @xmath732 for all @xmath733 and @xmath595^j$ ] .",
    "the statement follows immediately .",
    ".[fig : subadditivityweighting ] ]    our aim is to show that if every path is @xmath239-good for some @xmath239 , then the entropy @xmath734 is large for the recombined state @xmath735 .",
    "this expression can be seen as the value of the tree @xmath736 which is defined in figure  [ fig : zeroanktree ] , i.e. , we have @xmath737    [ fig : zeroanktree ] ]    to obtain an estimate on this quantity , we use a sequence of intermediate trees and show the following :    there is a sequence @xmath738 of intermediate trees such that @xmath739\\ , \\label{eq : treerecursiontoprove}\\end{aligned}\\ ] ] where @xmath736 is the tree in figure  [ fig : zeroanktree ] , and @xmath635 is the original tree ( see figure  [ fig : originaltree ] ) . in particular , @xmath740 here @xmath741 denotes @xmath742 ( this is equal to @xmath743 if @xmath744 ) . in these expressions ,",
    "the value of the tree @xmath745 is equal to @xmath746^j}{\\mathbf{w}^{{\\mathcal{s}}}_{\\hat{\\rho}}}({\\mathbb{t}_{j}},\\alpha^j)\\ \\textrm { where } \\nonumber\\\\ { \\mathbf{w}^{{\\mathcal{s}}}_{\\hat{\\rho}}}({\\mathbb{t}_{n}},\\alpha^j)&= h(x_{>j\\cap    { \\mathcal{s}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^j}}{\\sigma}}}+\\sum_{\\substack{i\\leq j\\\\      i\\in{\\mathcal{s } } } } h(x_i|x_{>i\\cap { \\mathcal{s}}}e)_{{\\widehat{\\rho}}^{\\alpha^i}}\\ .",
    "\\label{eq : valuetreej}\\end{aligned}\\ ] ]    note that   follows immediately from  .",
    "we first define the sequence of trees @xmath747 .",
    "we do this inductively as shown in figure  [ fig : substitutionrule ] ; that is , we obtain @xmath748 from @xmath745 by substituting subtrees corresponding to vertices @xmath749^{j-1}$ ] .",
    "clearly , @xmath745 is a tree characterised as follows : for every @xmath750 , every vertex at level @xmath751 has @xmath154  immediate descendants , whereas each vertex at level @xmath589 has one descendant which is a spade .     from @xmath745 , @xmath578 $ ] . the tree @xmath745 has depth @xmath752 , with spades sitting on the @xmath752-st level .",
    "[ fig : substitutionrule ] ]    to obtain @xmath748 from @xmath745 , the subtree defined by a vertex @xmath753 at level @xmath589 is substituted as shown , for all @xmath749^{j-1}$ ] .",
    "note that the vertex @xmath753 has ( in general ) @xmath154 direct descendants ; the figure corresponds to @xmath492 .     from @xmath745 ,",
    "@xmath578 $ ] .",
    "the tree @xmath745 has depth @xmath752 , with spades sitting on the @xmath752-st level .",
    "[ fig : substitutionrule ] ]    the tree @xmath754 obtained by applying the substitution rule to the tree @xmath755 of figure  [ fig : originaltree ] .",
    "the tree @xmath736 defined recursively in this way coincides with the definition given above ( figure  [ fig : zeroanktree ] ) . also , it is easy to see that the value of the tree @xmath745 is given by  .",
    "we prove the central inequality  .    by definition",
    ", it suffices to prove that for all @xmath749^{j-1}$ ] , there is an @xmath756 $ ] such that @xmath757 or equivalently @xmath758}{\\mathbf{w}^{{\\mathcal{s}}}_{\\hat{\\rho}}}({\\mathbb{t}_{j}},\\alpha^j)-{\\mathbf{w}^{{\\mathcal{s}}}_{\\hat{\\rho}}}({\\mathbb{t}_{j-1}},\\alpha^{j-1})\\leq 2\\log m\\ .\\end{aligned}\\ ] ] since the two paths to the vertex @xmath753 are identical in @xmath745 and @xmath748 , the expression on the lhs  is equal to @xmath759 where @xmath142 and @xmath172 are the subtrees defined by @xmath753 on the left in figure  [ fig : substitutionrule ] .    by definition",
    ", we have @xmath760 } h(x_{>j\\cap { \\mathcal{s}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^j}}{\\sigma}}}\\qquad&\\textrm{if } j\\not\\in{\\mathcal{s}}\\\\ \\min_{\\alpha_j\\in [ m ] } \\bigl(h(x_{>j\\cap { \\mathcal{s}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^j}}{\\sigma}}}+h(x_j|x_{>j\\cap { \\mathcal{s}}}e)_{{\\widehat{\\rho}}^{\\alpha^j}}\\bigr)\\qquad&\\textrm{if } j\\in{\\mathcal{s}}\\end{cases}\\\\ { \\mathbf{w}^{{\\mathcal{s}}}_{\\hat{\\rho}}}(b)&=h(x_{>j-1\\cap { \\mathcal{s}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^{j-1}}}{\\sigma}}}\\ .\\end{aligned}\\ ] ]    we thus have to consider two cases .",
    "a.   if @xmath761 , then @xmath762 and   follows with   once we show that @xmath763 this was shown in lemma  [ lem : alphamerge ] .",
    "b.   if @xmath733 , we have @xmath764}\\left(h(x_{>j\\cap { \\mathcal{s}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^j}}{\\sigma}}}+h(x_j|x_{>j\\cap { \\mathcal{s}}}e)_{{\\widehat{\\rho}}^{\\alpha^j}}-h(x_{>j-1\\cap { \\mathcal{s}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^{j-1}}}{\\sigma}}}\\right)\\ .\\ ] ] by the chain - rule ( lemma  [ lem : hminprop ]  ) , we have ( observe that @xmath765 ) @xmath766 and thus @xmath767}\\left(h(x_{>j-1\\cap { \\mathcal{s}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^j}}{\\sigma}}}-h(x_{>j-1\\cap { \\mathcal{s}}}|e)_{{\\frac{{\\widehat{\\rho}}^{\\alpha^{j-1}}}{\\sigma}}}\\right)\\ .\\end{aligned}\\ ] ] the claim   again follows from lemma  [ lem : alphamerge ] .    in summary",
    ", we have shown the following :    [ lem : maintreerecombination ] let @xmath98 $ ] be arbitrary and let @xmath713^n$ ] be the set of @xmath239-good paths for @xmath88 as in definition  [ def : lambdagoodset ] .",
    "let @xmath719 be the corresponding partially recombined states as in definition  [ def : recombinedstates ] .",
    "then @xmath768    we have @xmath769    we have shown that when recombining only @xmath239-good paths , one ends up with a state with high entropy on the subset @xmath88 of systems of interest .",
    "the recombined state can , however , be far from the original state , if only a few paths are @xmath239-good ( or more precisely , if the share of the @xmath239-good paths is small ) .",
    "we express this as follows .",
    "[ thm : recombining ] there is a probability distribution @xmath240 on @xmath214^n$ ] such that for any subset @xmath98 $ ] , there is a subnormalised state @xmath770 with @xmath771 at distance @xmath772 from the original state @xmath773 , where @xmath713^n$ ] is the set of paths @xmath591^n$ ] such that @xmath774    let @xmath240 be the probability distribution introduced in lemma  [ lem : rhoalphajexpressions ] .",
    "we set @xmath775 equal to the partially recombined state  .",
    "the first bound was derived in lemma  [ lem : maintreerecombination ] .",
    "the second bound is identical to the claim   of lemma  [ lem : subsetgammastates ] for @xmath776 . for the bound on the distance between @xmath777 and @xmath529",
    ", we use the fact that @xmath778 , where @xmath779 is a projector ( cf .",
    "lemma  [ lem : qoperatorsorthogonality ] ) . applying the gentle measurement lemma",
    "@xcite @xmath780 gives the claim .      to argue that an averaging sampler picks @xmath239-good paths with high probability , it will be necessary to analyse the behavior of a sampler with respect to values attached to a tree .",
    "for simplicity , we consider an even simpler situation ( which is more general and sufficient for our purposes ) : we think of values arranged in a matrix , and introduce the concept of a _ parallel sampler_.    consider a modified sampler situation , where instead of a single vector @xmath781^n$ ] , a family @xmath782^n\\}_{\\alpha\\in [ m]}$ ] of @xmath783  vectors is given .",
    "we would like to approximate the values @xmath784 simultaneously by expressions of the form  @xmath785 .",
    "clearly , a single ( small ) subset @xmath98 $ ] will generally not give a good approximation for each one of the @xmath783  vectors .",
    "however , it is possible to guarantee that it does so for most vectors , in the following sense .",
    "[ def : matrixsampler ] let @xmath786 . for any subset",
    "@xmath98 $ ] , matrix @xmath787,i\\in [ n]}\\in [ 0,1]^{m\\times n}$ ] and @xmath111 $ ] , let @xmath788 $ ] be the set of @xmath789 $ ] such that @xmath790 a _",
    "@xmath791-parallel sampler _ is a distribution @xmath101 over subsets @xmath88 of @xmath97 $ ] with the property that for every fixed probability distribution @xmath240 on @xmath792 $ ] , @xmath793\\leq \\varepsilon   \\textrm { for all } \\beta=(\\beta^\\alpha_i)_{\\alpha\\in [ m],i\\in [ n]}\\in [ 0,1]^{m\\times n}\\ .\\end{aligned}\\ ] ] a _ @xmath794-parallel sampler _ is a @xmath791-parallel sampler  for any @xmath795 .",
    "clearly , a `` standard '' sampler corresponds to @xmath796 . in our application , the matrices @xmath797^{m\\times n}$ ] will not be arbitrary , but have a lot of redundancy .",
    "this could perhaps be exploited to find better constructions ; however , for our purposes , a parallel sampler  is sufficient .",
    "we now use markov s inequality to obtain the following generic construction of a parallel sampler ; again , more optimal constructions may be possible , but the following one is sufficient for our considerations .    [",
    "lem : matrixsampler ] a @xmath100-sampler is a @xmath798-parallel sampler .",
    "let @xmath795 be arbitrary .",
    "fix a probability distribution @xmath240 on @xmath792 $ ] and let @xmath787,i\\in [ n]}\\in [ 0,1]^{m\\times n}$ ] be arbitrary . since the probability on the lhs of   is bounded by  @xmath26 for each vector @xmath799 with @xmath789 $ ] , it is also bounded if we choose @xmath212 independently according to @xmath240 .",
    "that is , we have @xmath800}\\left[\\alpha\\in{\\mathcal{b}}(\\beta,{\\mathcal{s}},\\xi)\\right]={\\mathop{\\mathbb{e}}}_{{\\mathcal{s}}}\\left[\\pr_{\\alpha}[\\alpha\\in{\\mathcal{b}}(\\beta,{\\mathcal{s}},\\xi)]\\right]\\ .\\end{aligned}\\ ] ] markov s inequality @xmath801\\leq { { { { \\mathop{\\mathbb{e}}}[z]}/{c}}}$ ] with @xmath802 applied to the random variable @xmath803 $ ] immediately gives the claim .",
    "we now apply the concept of a parallel sampler  to the situation of interest .",
    "recall definition  [ def : lambdagoodset ] of the set @xmath713^n$ ] of @xmath239-good paths for every @xmath712 and @xmath98 $ ] .",
    "we show that for an appropriate choice of @xmath239 , and a fixed probability distribution @xmath240 on @xmath214^n$ ] , the weight of the @xmath239-good paths for @xmath88 is large with high probability if @xmath98 $ ] is a random subset which is a parallel sampler .",
    "[ thm : sampling ] let @xmath240 be an arbitrary probability distribution on @xmath214^n$ ] .",
    "let @xmath103 be a probability distribution over subsets of @xmath97 $ ] which is a @xmath794-parallel sampler .",
    "then @xmath804&\\geq 1-\\varepsilon\\qquad\\textrm{for } \\\\ \\lambda&:=\\frac{h({x_{>0}}|e)_{{\\frac{\\rho}{\\sigma}}}}{n\\log|{\\mathcal{x}}|}+\\frac{n-|{\\mathcal{s}}|}{|{\\mathcal{s}}|n\\log|{\\mathcal{x}}|}{h(\\emptyset|e)_{{\\frac{\\rho}{\\sigma}}}}- \\bigl(\\frac{1}{m }   + \\xi \\bigr)\\ , \\end{aligned}\\ ] ] where @xmath272 is the set of @xmath239-good paths as in definition  [ def : lambdagoodset ] , i.e. , the set of @xmath591^n$ ] with @xmath805    for every @xmath578 $ ] and @xmath591^n$ ] , we define the quantity @xmath806 ( note that this depends only on the first @xmath589  entries of @xmath639 . ) observe that we have @xmath807 $ ] by the dimension bound ( lemma  [ lem : hminprop ]  ) . by definition  [ def : matrixsampler ] of a parallel sampler",
    ", we therefore get @xmath808\\leq \\varepsilon\\ , \\end{aligned}\\ ] ] where @xmath809^n\\ \\big|\\ \\frac{1}{|{\\mathcal{s}}|}\\sum_{i\\in{\\mathcal{s}}}\\beta^{\\alpha^n}_i\\leq \\frac{1}{n}\\sum_{i\\in[n]}\\beta^{\\alpha^n}_i-\\xi \\big\\}\\ .\\end{aligned}\\ ] ] inequality   can be rewritten as @xmath810\\geq 1-\\varepsilon\\ , \\label{eq : inequalitybadvrewritten}\\end{aligned}\\ ] ] where we write @xmath811^n\\backslash{\\mathcal{b}}(\\beta,{\\mathcal{s}},\\xi)$ ] for the complement of @xmath812 .",
    "note that if @xmath813 , then @xmath814}\\beta^{\\alpha^n}_i -\\xi\\log|{\\mathcal{x}}|\\\\ & \\geq\\frac{1}{n}\\left(h({x_{>0}}|e)_{{\\frac{\\rho}{\\sigma}}}-\\frac{n\\log|{\\mathcal{x}}|}{m}- { h(\\emptyset|e)_{{\\frac{\\rho^{\\alpha^n}}{\\sigma}}}}\\right ) -\\xi\\log|{\\mathcal{x}}|\\ \\end{aligned}\\ ] ] by the definition of @xmath815 and theorem  [ thm : splittoffmain ] .",
    "this is equivalent to @xmath816 where @xmath817 we use lemma  [ lem : rhoalphajexpressions ]   ( with @xmath680 ) to bound the second summand from below , getting @xmath818 for all @xmath591^n$ ] . with  ,",
    "we conclude that @xmath819 in other words , we have @xmath820 , and the claim follows from  .      we will now turn our attention to the smooth min - entropy , as introduced in  @xcite . we will state and prove our main result in this section ; that is , we will show that smooth min - entropy rate is preserved under sampling .    before discussing our main result",
    ", we quickly review an important special case : we will often consider situations where a random variable @xmath359 is the result of applying a function to two random variables @xmath9 and @xmath31 . an example of this is the case where @xmath18 is a randomly chosen substring of @xmath9 . to show that the uncertainty about @xmath821 is large given @xmath31 and a quantum system @xmath10",
    ", it suffices to show that with high probability over @xmath31 , the uncertainty about @xmath822 is large .",
    "this is expressed by the following result .",
    "[ lem : hminclassicalmarkov ] let @xmath823 be such that @xmath824\\geq 1-\\varepsilon\\ .\\end{aligned}\\ ] ] then @xmath825 .",
    "the proof of this lemma is deferred to appendix  [ sec : entropypropertyappendix ] .",
    "recall that the smooth min - entropy - rate @xmath826 is defined as in   as the smooth min - entropy @xmath827 divided by the size @xmath828 of @xmath142 .",
    "our main result is the following    [ thm : mainresultsampling ] let @xmath570 be a quantum state where @xmath138 on @xmath81 is classical .",
    "let @xmath88 be a random variable over subsets of @xmath97 $ ] which is independent of @xmath829 and a @xmath794-parallel sampler .",
    "assume that @xmath830 .",
    "then @xmath831 for all @xmath832 .",
    "we will give concrete parameters below , which show that @xmath833 ( in some security parameter ) , in situations of interest . to put this result into a more convenient form , we choose a certain value of @xmath834 , and show how this result applies to general samplers .",
    "[ cor : samplersminentropypreservation ] let @xmath570 be a quantum state as in theorem  [ thm : mainresultsampling ] and let @xmath88 be a @xmath100-sampler .",
    "assume that @xmath830 .",
    "then @xmath835 for all @xmath836 .",
    "we choose @xmath837 .",
    "we can then bound @xmath216 in theorem  [ thm : mainresultsampling ] by @xmath838 and the claim follows from the fact that a @xmath100-sampler is a @xmath798-parallel sampler(i.e . , lemma  [ lem : matrixsampler ] ) .    in the remainder of this section , we prove theorem  [ thm : mainresultsampling ] .",
    "we do so in two successive steps .",
    "we first show that sampling preserves the entropy rate of a modified ( smooth ) entropy @xmath839 .",
    "we then use the fact that this modified entropy @xmath840 is essentially equivalent to the smooth min - entropy .",
    "more precisely , we introduce the quantities @xmath841 for any bipartite state @xmath300 and @xmath38 . the only difference to the original definition of the ( smooth ) min - entropy @xmath842 ( definition  )",
    "is that the supremum is restricted to states @xmath301 which are bounded from below by @xmath312 .",
    "these quantities give the bounds @xmath843 on the smooth min - entropy , for all states @xmath300 .",
    "note that the second inequality follows trivially from the definition ; we give a proof of the first inequality in appendix  [ sec : entropypropertyappendix ] ( lemma  [ lem : hbmin ] ) .",
    "we are ready to combine the recombination theorem ( theorem  [ thm : recombining ] ) with the sampling theorem ( theorem  [ thm : sampling ] ) .",
    "this gives the following main result , which shows that the min - entropy rate ( for the modified entropy @xmath844 ) is preserved under sampling .",
    "[ lem : mainresultsamplingentropy ] consider a quantum state of the form @xmath570 where @xmath138 on @xmath81 is classical .",
    "let @xmath103 be a probability distribution over subsets of @xmath97 $ ] which is a @xmath794-parallel sampler . then @xmath845&\\geq 1-\\varepsilon\\qquad\\textrm{where } \\label{eq : subsetsamplerfir}\\\\ c & = \\xi+\\frac{1}{m}+\\frac{2n\\log m}{|{\\mathcal{s}}|\\log|{\\mathcal{x}}|}\\ \\nonumber\\end{aligned}\\ ] ] for any @xmath213 .",
    "in particular , inequality   is true for the choice @xmath846 if @xmath830 .",
    "we first show the second part , assuming that the first statement is true .",
    "it is obtained by choosing a specific value of @xmath213 .",
    "consider the function @xmath847 .",
    "we are interested in the minimum value of this function for @xmath213 .",
    "it is easy to see that the function is minimised for @xmath848 , where @xmath335 denotes the natural logarithm .",
    "however , since this is not necessarily an integer , we use the value @xmath849 .",
    "clearly , for @xmath145 small enough ( @xmath850 ) , there is an integer @xmath851 $ ] , and this integer satisfies @xmath852 the second claim immediately follows from this .",
    "we rephrase the first claim more explicitly : we have to show that the following holds with probability at least @xmath853 over the choice of @xmath88 .",
    "there is a subnormalised state @xmath770 ( depending on @xmath88 ) at distance @xmath854 from the original state @xmath773 and a state @xmath855 ( which happens to be independent of @xmath88 ) such that @xmath856 let @xmath573 be a state which achieves the supremum in the definition of @xmath857 , i.e. , we have @xmath858 and @xmath855",
    ". then @xmath859 by definition , and we can bound the quantity @xmath239 in theorem  [ thm : sampling ] by @xmath860 according to theorem  [ thm : sampling ] , the set @xmath272 of @xmath239-good paths has weight at least @xmath861 with respect to the distribution @xmath240 ( defined by theorem  [ thm : recombining ] ) , with probability at least @xmath853 over the choice of @xmath88 . the recombination theorem ( theorem  [ thm : recombining ] ) therefore guarantees the existence of a state @xmath770 with the required properties , except with probability @xmath26 over the choice of @xmath88 .",
    "we can now prove our main result .",
    "first observe that lemma  [ lem : mainresultsamplingentropy ] can be adapted using the triangle inequality to include an additional parameter @xmath862 , thus replacing the probability in question by @xmath863\\geq 1-\\varepsilon\\ .\\ ] ] setting @xmath864 and @xmath865 , this implies that @xmath866\\geq 1-\\varepsilon\\ ] ] because of the relations   between @xmath867 and @xmath868 .",
    "the claim of the theorem follows from this inequality and lemma  [ lem : hminclassicalmarkov ] .",
    "we will now consider the random subset sampler and analyse recursive sampling from a string .",
    "this will result in a concrete protocol for the bounded storage model which achieves significant key expansion .",
    "the basic building block is the subprotocol @xmath869 described in figure  [ prot : sample ] .",
    "this protocol outputs a random substring of a given string @xmath18 .",
    "the effect of protocol @xmath869 is the following .",
    "@xmath870    * input * : @xmath871-bit string @xmath18 , parameter @xmath4 and @xmath872 independent random bits @xmath88 .    *",
    "output * : @xmath873-bit substring of @xmath18 .    * procedure * : partition @xmath18 into @xmath874 blocks @xmath875 of @xmath876 bits each",
    ". use random bits to pick a subset @xmath98 $ ] of size @xmath99 at random . output @xmath159 , i.e. , the concatenation of the corresponding blocks .",
    "[ lem : sampprocedure ] let @xmath4 be fixed , let @xmath877 be a quantum state where @xmath18 is an @xmath871-bitstring with @xmath878 .",
    "let @xmath88 be an independent , uniform @xmath879-bit string .",
    "( in particular , these are less than @xmath880 bits . )",
    "let @xmath881 be the @xmath873-bitstring @xmath882 .",
    "then @xmath883 for all @xmath836 , where @xmath884 .",
    "note that we could have used any @xmath100-sampler in place of the subset sampler .",
    "however , for concreteness and simplicity , we restrict our attention to this sampler ; in practice , more efficient constructions may be used , and the analysis is analogous .",
    "to prove the bound @xmath880 on the number of bits consumed , we use the inequality @xmath885 on the binomial coefficients .",
    "it implies that @xmath886    we express everything in terms of the number @xmath4 of subblocks we sample , and the length @xmath873 of the final string .",
    "that is , we sample @xmath108 subblocks from @xmath887 blocks of size @xmath888 bits each , obtaining a substring of @xmath889 bits .    we know from lemma  [ lem : subsetsampler ] that a randomly chosen subset @xmath88 of size @xmath108 is a @xmath109-sampler , for every @xmath111 $ ]",
    ". we choose @xmath890 such that @xmath891 .",
    "the parameter @xmath144 in corollary  [ cor : samplersminentropypreservation ] then takes the form @xmath892 similarly , we have @xmath893 .",
    "because the function @xmath894 is monotonically increasing for small enough @xmath145 , its value is maximised for small values of @xmath871 ; that is , we can use our lower bound @xmath878 on @xmath871 get @xmath895 we conclude that @xmath896 the claim then follows from corollary  [ cor : samplersminentropypreservation ] .",
    "note that the length @xmath871 is only reduced to @xmath873 by the protocol @xmath869 . to reduce the length of the output even further , we use the protocol recursively .",
    "that is , we randomly sample substrings @xmath897 times , each time sampling a substring of the already obtained string . in each step",
    ", the original string is partitioned into a certain number of blocks , out of which @xmath4 are chosen at random ( throughout , @xmath4 will be a fixed parameter ) .",
    "we call the resulting protocol @xmath898 ; see figure  [ fig : itsampler ] .    to understand the effect of this recursive protocol ,",
    "observe that the quantities in lemma  [ lem : sampprocedure ] describing the effect of @xmath869 are all additive in the following sense : repeated application of @xmath869 simply requires addition of the parameters .",
    "moreover , with the chosen parameters , only the number of bits consumed depends on the length of the involved bitstrings .",
    "the analysis is therefore particularly simple , and the effect of the procedure  @xmath898 is described by the following lemma .",
    "let @xmath877 be such that @xmath18 is an @xmath871-bit string .",
    "let @xmath897 and @xmath871 be such that @xmath899 .",
    "let @xmath88 be independent random bits and let @xmath900 .",
    "then @xmath881 is a @xmath901-bit substring of @xmath18 , with @xmath902 where @xmath903 .",
    "the generation of @xmath881 consumes less than @xmath904 independent random bits from @xmath88 .    in particular , if @xmath905 , then approximately @xmath906 applications of the subprotocol  @xmath869 are sufficient to produce a substring @xmath881 of @xmath18 of length @xmath907 , while preserving the min - entropy - rate ( for large  @xmath4 ) .",
    "this consumes less than @xmath908  independent random bits .",
    "@xmath909    * input * : @xmath871-bit string @xmath18 , parameters @xmath4 and @xmath897 and independent random bits @xmath88 .",
    "* output * : @xmath901-bit substring of @xmath18 .",
    "* procedure * : let @xmath910 .",
    "iterate the following , for @xmath911 :    use independent random bits @xmath912 from @xmath88 to generate @xmath913    output @xmath914 .",
    "let @xmath915 be the length of the string @xmath916 ; by the definition of the protocol @xmath869 , we have @xmath917 and hence @xmath918 , as claimed .",
    "let @xmath912 be the random bits from @xmath88 used to generate @xmath916 . according to lemma  [ lem : sampprocedure ]",
    ", we have for all @xmath911 @xmath919 where @xmath920 and @xmath921 is arbitrary . defining @xmath922 and @xmath923",
    ", this implies the claim  .    to compute the number of random bits consumed in this procedure$ ] into bitstrings .",
    "] , observe that in the @xmath924-th step , a random subset @xmath912 of @xmath925 $ ] of size @xmath4 is chosen , where @xmath926 ; this consumes @xmath927 bits .    the total number of bits we need is bounded by the number @xmath897 of applications times the maximal number of bits @xmath928 consumed in a single step .",
    "( here we used the fact that @xmath929 is a decreasing sequence and the bound on the binomial coefficient shown in lemma  [ lem : sampprocedure ] . )",
    "this gives the upper bound @xmath930 , as claimed .    in summary",
    ", we have found a procedure that generates a random substring of a string of @xmath931 bits , with the following parameters :    [ cols=\"<,^,^,^\",options=\"header \" , ]     with error @xmath932 .",
    "it is computable with @xmath933 bits of storage .",
    "subsequent to this sampling procedure , privacy amplification may be used to extract a secret key from the substring  @xmath881 . in conclusion , this gives a sample - and - hash procedure for key expansion in the bounded storage model , expanding an initial key of @xmath908 bits to approximately @xmath934 bits .",
    "( @xmath935 $ ] is usually assumed to be constant . )",
    "let @xmath936 . let @xmath937 for every @xmath938 , there is a subnormalised state @xmath939 and a state @xmath940 such that @xmath941 by definition . for every @xmath942",
    ", we choose arbitrary states @xmath939 and @xmath940 satisfying @xmath943 it is easy to verify that the two states @xmath944 satisfy @xmath945 the claim follows from this .",
    "we next prove the non - trivial inequality in  .",
    "[ lem : hbmin ] let @xmath300 be a subnormalised state .",
    "we have @xmath946    clearly , it suffices to show that the claim of the lemma is true for @xmath947 .    by definition",
    ", there is a normalised state @xmath301 such that @xmath948 this implies that @xmath949 let @xmath950 denote the projector onto the eigenspaces of @xmath951 corresponding to eigenvalues smaller than or equal to @xmath952 .",
    "applying this on both sides of the previous inequality gives ( with @xmath953 ) @xmath954 multiplying from both sides by @xmath955 , we obtain @xmath956 where we introduced the operator @xmath957 .",
    "we claim that @xmath958 note that   imply the claim   ( for @xmath947 ) .",
    "inequality   directly follows from the fact that @xmath959 . to prove  ,",
    "let @xmath220 be a purification of @xmath300 and consider the purification @xmath960 of @xmath350 .",
    "using the schmidt decomposition @xmath961 , it is straightforward to verify that @xmath962 note that the latter of these inequalities proves  .",
    "the cauchy - schwarz inequality @xmath963 implies that for any two pure states @xmath964,@xmath965 , we have @xmath966 where @xmath967 , since the difference @xmath968 has rank at most  @xmath969 . applying this to @xmath220 and @xmath970 and using   gives @xmath971 here @xmath972 projects onto the orthogonal complement of the image of @xmath950 . in the last inequality ,",
    "we have used the assumption that @xmath300 is subnormalised and thus @xmath973 .",
    "since the trace distance is non - increasing under partial traces , the claim   follows once we show that @xmath974 note that we have @xmath975 by definition .",
    "inserting this into the expression of interest gives @xmath976as claimed .",
    "[ lem : alphabetmodifiedlem ] let @xmath977}$ ] be a family of hermitian operators on a hilbert space @xmath978 and suppose that @xmath979 , for any @xmath980 $ ]",
    ". then @xmath981 for @xmath982 .",
    "in particular , if @xmath977}$ ] resolves the identity on @xmath983 then @xmath984 .",
    "let @xmath985 be arbitrary . by definition",
    ", we have @xmath986 by the cyclicity of the trace and the fact that @xmath987 is a projector , we have @xmath988 with @xmath989 .",
    "the operator - cauchy - schwarz - inequality @xmath990 applied to @xmath991 and @xmath992 therefore gives ( with the cyclicity of the trace ) @xmath993 it is straightforward to verify that @xmath994\\ , \\label{eq : zalphaopineq}\\end{aligned}\\ ] ] where we used the assumption in the last inequality . combining   with and gives @xmath995 since @xmath985 was arbitrary , the claim follows .",
    "both statements follow immediately from the fact that @xmath1002 where @xmath1003 is the orthogonal complement of @xmath1004 in @xmath1005 .",
    "this identity implies @xmath1006 , where @xmath1007 is the projector onto @xmath1003 .",
    "thus @xmath1001 .",
    "a.  ambainis , a.  nayak , a.  ta - shma , and u.  vazirani .",
    "dense quantum coding and a lower bound for 1-way quantum automata . in _ proceedings of the 31th acm symposium on theory of computing _ , 1999 .",
    "arxiv : quant - ph/9804043 .",
    "l.  babai and t.  p. hayes .",
    "near - independence of permutations and an almost sure polynomial bound on the diameter of the symmetric group . in _",
    "soda 05 : proceedings of the sixteenth annual acm - siam symposium on discrete algorithms _ ,",
    "pages 10571066 , philadelphia , pa , usa , 2005 . society for industrial and applied mathematics .",
    "d.  gavinsky , j.  kempe , i.  kerenidis , r.  raz , and ronald de wolf .",
    "exponential separations for one - way quantum communication complexity , with applications to cryptography . in _ to appear in stoc07 _ , pages 369376 , 2007 .",
    "arxiv : quant - ph/0611209 .",
    "r.  impagliazzo , l.  a. levin , and m.  luby .",
    "pseudo - random generation from one - way functions . in _",
    "stoc 89 : proceedings of the twenty - first annual acm symposium on theory of computing _ , pages 1224 , new york , ny , usa , 1989 .",
    "acm .",
    "m.  s. leifer .",
    "conditional density operators and the subjectivity of quantum operations . in g.  adenier , c.  a. fuchs , and a.  yu .",
    "khrennikov , editors , _ foundations of probability and physics-4 , aip conference proceeding _ ,",
    "volume 889 , pages 172186 , 2007 .",
    "arxiv : quant - ph/0611233 .                r.  renner and r.  knig .",
    "universally composable privacy amplification against quantum adversaries . in _",
    "second theory of cryptography conference tcc _ ,",
    "volume 3378 of _ lecture notes in computer science _ , pages 407425 .",
    "springer , 2005 .",
    "arxiv : quant - ph/0403133 ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a sequence of @xmath1 classical random variables and consider a sample @xmath2 of @xmath3 positions selected at random . then , except with ( exponentially in @xmath4 ) small probability , the min - entropy @xmath5 of the sample is not smaller than , roughly , a fraction @xmath6 of the overall entropy @xmath7 , which is optimal .    here </S>",
    "<S> , we show that this statement , originally proved in [ s.  vadhan , lncs  2729 , springer , 2003 ] for the purely classical case , is still true if the min - entropy @xmath8 is measured relative to a quantum system . </S>",
    "<S> because min - entropy quantifies the amount of randomness that can be extracted from a given random variable , our result can be used to prove the soundness of locally computable extractors in a context where side information might be quantum - mechanical . in particular </S>",
    "<S> , it implies that key agreement in the bounded - storage model|using a standard _ sample - and - hash _ protocol|is fully secure against quantum adversaries , thus solving a long - standing open problem . </S>"
  ]
}