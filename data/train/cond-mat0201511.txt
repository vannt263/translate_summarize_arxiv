{
  "article_text": [
    "steadily growing computer power and improvements in numerical algorithms are making more and more materials problems approachable by computer simulations .",
    "first - principles computations , in which properties of materials are derived from quantum mechanics , are particularly interesting as they allow for the exploration of new materials even before a procedure to synthesize them has been devised @xcite . for any new material ,",
    "a determination of its stable structure is of utmost importance .",
    "hence , the determination of phase diagrams from first principles is among the most important steps required to build a `` virtual laboratory '' .    over the last twenty years",
    ", the formalism enabling the calculation of a solid - state phase diagram from quantum mechanical energy calculations has been carefully laid out @xcite .",
    "this formalism establishes that the thermodynamic properties of an alloy can , in principle , be computed as accurately as desired through a technique known as the _ cluster expansion_. in practice , however , the construction of this expansion can be tedious , and relies on the researcher s physical intuition to guide the construction process .",
    "these difficulties have so far limited the use of phase diagram calculations from first - principles to members of the alloy theory community . to make this powerful tool available to a large number of people outside of the alloy theory community",
    ", we have developed a fully automated algorithm to perform such calculations and implemented it in an easy - to - use software package .",
    "our automated algorithm also offers the advantage of removing arbitrary parameters from the computations , ensuring that the results obtained are truly derived from the underlying first - principles calculations , rather than based on the physical intuition of the user .",
    "this paper is organized as follows .",
    "first , a brief description of the formalism to calculate phase diagrams from first principles is presented .",
    "we then propose and motivate an algorithm for the automatic determination of phase diagrams .",
    "finally , various examples of the application of our method are shown .",
    "the computation of an alloy phase diagram from first - principles typically consists of three steps .",
    "first , the partition function of the system is _ coarse grained _ to that of a lattice model representing the possible configurational disorder of the alloy @xcite .",
    "if needed , this process can be accomplished without neglecting the additional entropy arising from  the electronic and vibrational degrees of freedom , even though these degrees of freedom are no longer explicitly present in the lattice model .",
    "the resulting coarse grained partition function consists of a sum over every possible way to place the atoms on a given _",
    "parent lattice_. due to the large number of terms in the sum , it is inconceivable to attempt to compute the energy of every configuration from first principles . hence , in the second step , the dependence of energy on alloy configuration is parametrized with a simpler model using one of alloy theory s most powerful tools , the cluster expansion formalism @xcite .",
    "the cluster expansion provides a compact representation of the configurational dependence of the energy of an alloy , whose accuracy can be systematically  improved by adding a sufficient number of terms in the expansion . in the third step , the system is thermally equilibrated and free energies are obtained from monte carlo simulations . in this paper , we focus on the cluster expansion , as it is the most difficult step .",
    "the cluster expansion is a generalization of the well - known ising hamiltonian . in the common case of a binary alloy system ,",
    "the ising model consists of assigning a spin - like occupation variable @xmath0 to each site @xmath1 of the parent lattice , which takes the value @xmath2 or @xmath3 depending on the type of atom occupying the site . a particular arrangement of spins of the parent lattice",
    "is called a _ configuration _ and can be represented by a vector @xmath4 containing the value of the occupation variable for each site in the parent lattice .",
    "although we focus here on the case of binary alloys , this framework can be extended to arbitrary multicomponent alloys ( the appropriate formalism is presented in @xcite , while examples of applications can be found in @xcite ) .",
    "the cluster expansion parametrizes the energy ( per atom ) as a polynomial in the occupation variables : @xmath5 where @xmath6 is a cluster ( a set of sites @xmath1 ) .",
    "the sum is taken over all clusters @xmath6 that are not equivalent by a symmetry operation of the space group of the parent lattice , while the average is taken over all clusters @xmath7 that are equivalent to @xmath6 by symmetry .",
    "the coefficients @xmath8 in this expansion embody the information regarding the energetics of the alloy and are called the effective cluster interaction ( eci ) .",
    "the _ multiplicities _ @xmath9 indicate the number of clusters that are equivalent by symmetry to @xmath6 ( divided by the number of lattice sites ) .    it can be shown that when _ all _ clusters @xmath6 are considered in the sum , the cluster expansion is able to represent any function @xmath10 of configuration @xmath4 by an appropriate selection of the values of @xmath8 . however , the real advantage of the cluster expansion is that , in practice , it is found to converge rapidly .",
    "an accuracy that is sufficient for phase diagram calculations can be achieved by keeping only clusters @xmath6 that are relatively compact ( _ e.g. _ short - range pairs or small triplets ) .",
    "the unknown parameters of the cluster expansion ( the eci ) can then determined by fitting them to the energy of a relatively small number of configurations obtained , for instance , through first - principles computations .",
    "this approach is known as the structure inversion method ( sim ) or the collony - williams @xcite method .",
    "the cluster expansion thus presents an extremely concise and practical way to model the configurational dependence of an alloy s energy .",
    "how many eci and structures are needed in practice ?",
    "a typical well - converged cluster expansion of the energy of an alloy consists of about 10 to 20 eci and necessitates the calculation of the energy of around 30 to 50 ordered structures ( see , for instance , @xcite ) . once the cluster expansion is known , various statistical mechanical techniques such as monte carlo simulations @xcite , the low temperature expansion ( lte ) @xcite or the cluster variation method ( cvm ) @xcite can be used to obtain phase diagrams .",
    "deciding which eci are retained in the cluster expansion and which structural energies are used in the fit is largely a process of trial and error based on the experience of the researcher , making an automated procedure difficult . in response to this , we have devised an algorithm that constructs an optimal cluster expansion by alternatively answering the following two questions .",
    "given the information obtained at one point in the calculations regarding the alloy system ,    1 .",
    "which cluster @xmath6 should be included in the cluster expansion ( nearest neighbor pair , second nearest neighbor pair , triplets , quadruplets , etc . ) ? 2 .",
    "which atomic arrangements should be used in order to determine the unknown coefficients @xmath8 ?",
    "each question will be treated in turn .",
    "the determination of a cluster expansion differs from standard fitting procedures by the fact that the number of unknown parameters is theoretically infinite , since the true physical system can not be described exactly with a finite number of nonzero eci .",
    "the problem is that we only have access to a finite number of structural energies , implying that we can never determine the exact cluster expansion .",
    "the question is then : what is the best we can do ?",
    "we obviously need to truncate the series to a finite number of terms and our focus is to determine the optimal number of terms to keep , given that a certain number of structural energies are known .",
    "if we keep too few terms , the predicted energies may be imprecise because the truncated cluster expansion can not account for all sources of energy fluctuations .",
    "if too many terms are kept , the more insidious problem of overfitting manifests itself .",
    "the mean squared error of the fit may appear very small , but the true predictive power of the cluster expansion for data that was not included in the fit is in fact much lower .",
    "the source of this problem is that energy variations caused by one eci @xmath11 not included in the fit may be incorrectly attributed to another eci @xmath12 which _ is _ included in the fit , simply because @xmath13 happens to be correlated with @xmath14 in the finite set of structures whose energies are known .",
    "we thus need to find the choice of eci that represents the best compromise between those two unwanted effects .",
    "although it is not widely known , a formal solution to this problem exists ( see for instance , @xcite ) .",
    "it consists in evaluating the predictive power of a cluster expansion using the cross - validation ( cv ) score , defined as : @xmath15 where @xmath16 is the calculated energy of structure @xmath1 , while @xmath17 is the predicted value of the energy of structure @xmath1 obtained from a least - squares fit to the @xmath18 other structural energies .",
    "choosing the number of terms that minimizes the cv score has been shown to be an asymptotically optimal @xcite selection rule . while the formal proof of this result is rather technical , we provide a heuristic proof of its validity in the appendix for the convenience of the reader .",
    "in contrast to the well - known mean squared error , the cv score , is not monotonically decreasing .",
    "as the number of parameters to be fitted increases , the cv score first decreases because an increasing number of degrees of freedom are available to explain the variations in energy .",
    "the cv score then goes through a minimum before increasing , due to a decrease in predictive power caused by an increase in the noise in the fitted eci .",
    "the best compromise between these two effects can then be found .",
    "the idea that a correct measure of the accuracy of the model should involve attempting to predict data points that are not included in the fit is quite intuitive and has been employed in previous first - principles phase - diagram calculations ( see , for instance , @xcite ) .",
    "the optimality property of cross - validation , however , establishes the important fact that there is no need to partition the data in various ways excluding , 1,2,3 , etc .",
    "structures at a time .",
    "simply removing one point at a time is all that is needed .",
    "it is also important to note that , although the calculation of the cv score involves removing points from the fit , the cv score nevertheless gives a measure of the predictive power of the fit obtained with _ all _ structures included @xcite .",
    "the cv criterion thus enables the assessment of the predictive power of the cluster expansion while still using all the structural energies available in order to fit the eci .",
    "there is no need to exclude perfectly valid data points from the fit when obtaining the eci .",
    "it would appear that removing one point at a time involves recomputing @xmath19 distinct regressions , a process exhibiting a computational complexity of order @xmath20 .",
    "however , the cv score can actually be computed in order @xmath19 operations , using the formula @xmath21 which involves only the predicted values @xmath22 obtained from the standard `` all points included '' least - squares regression and the matrix @xmath23containing the values of @xmath24 for each structure @xmath1 .",
    "we let @xmath25 denote row @xmath1 of the matrix @xmath26 .",
    "the order @xmath19 complexity is achieved by noting that the matrix @xmath27 can be computed once and for all .      applying the cross - validation criterion to the problem of eci selection",
    "requires a few additional steps . cross - validation tends to perform better in practice when the number of choices is kept small , not only because this minimizes the computational requirements of the search , but also for a more fundamental reason .",
    "the cross - validation score is a statistical quantity and thus provides an error contaminated measure of the `` true '' quantity we are interested in . while the statistical noise vanishes in the large sample limit , it may still affect finite - sample performances .",
    "as the number of alternative cluster choices increases , the likelihood that _ one _ suboptimal choice happens to give a smaller cross - validation score than the true optimal choice increases . by restricting the search only to `` physically meaningful '' candidate cluster expansions",
    ", we minimize this unwanted phenomenon .",
    "let us now propose a formal definition of what a `` physically meaningful '' cluster choice is . define the diameter of a cluster as the maximum distance between two sites in the cluster .    1 .",
    "a cluster can be included only if all its subclusters have already been included .",
    "an @xmath28-point cluster can be included only if all @xmath28-point clusters of a smaller diameter have already been included .",
    "the first rule formalizes the observation that an @xmath28-point cluster can be interpreted as describing the coupling between an @xmath29-point cluster and an @xmath30-point cluster . under the reasonable assumption that coupling terms are less important than each terms taken separately , we expect a given cluster to be associated with a smaller eci than any of its subclusters , implying that subclusters should always be included in the expansion first .",
    "the second rule summarizes the intuition that large and extended clusters tend to describe weaker interactions than small and compact ones . by using the diameter as a measure of spatial extent",
    ", it assumes that a cluster is associated with an interaction that is weaker than the weakest pair it contains , the weakest being presumably the longest .",
    "while it is possible that the optimal cluster expansion does not satisfy these requirements , the only consequence of imposing them is that the algorithm might choose a cluster expansion containing an unnecessarily large number of terms , with some eci being set close to zero .",
    "these two rules are sufficient to keep the number of possibilities to a finite and reasonable number and lead to a particularly simple algorithm to systematically go through all `` physically meaningful '' cluster choices .",
    "first consider pair clusters in increasing order of length .",
    "for each choice of pair clusters , consider triplets , in increasing order of diameter , up to the diameter of the longest pair . for each choice of triplets ,",
    "consider quadruplets , in increasing order of diameter , up to the diameter of the largest triplet , etc .",
    "note that when ties between the diameters of different clusters occur , all clusters of the same diameter are added at the same time .",
    "the fact that the total number of cluster must be less than the number of structures guarantees that the number of cluster choices to be considered is finite .    for instance , consider the artificially simple case where the pairs have length 1,2,3,  and similarly for larger clusters . if one has access to the energy of 7 structures , the following cluster choices would be considered ( each choice is described by the maximum diameter of the included pairs , triplets , quadruplets , etc . ) : ( 1 ) , ( 1,1 ) , ( 1,1,1 ) , ( 1,1,1,1 ) ,",
    "( 2 ) , ( 2,1 ) , ( 2,1,1 ) , ( 2,2 ) , ( 3 ) , ( 3,1 ) , ( 4 ) . the number of clusters included is at most 4 , because the empty cluster and the point cluster ( assuming there is only one ) are always included , and because cross - validation requires at least one more structure than there are clusters .",
    "it is possible that for a particular class of systems , more specific rules can be derived ( _ e.g. _ in fcc - based transition metal alloys , the fourth nearest neighbor pair is often associated with a larger eci than the third nearest neighbor pair @xcite ) , but as a general system - independent rule , this hierarchy of clusters seems sensible .",
    "the accuracy of a cluster expansion is not solely measured by the error in the predicted energies .",
    "it is particularly important that it is able to predict the correct ground states .",
    "since the mean squared error focuses on optimizing the absolute energy values , while the ground states are determined by the ranking of energies , the lowest mean squared error does not necessarily lead to the most accurate prediction of the ground state line , as discussed in details in @xcite . for this reason ,",
    "the search for the best cluster expansion in our algorithm gives an absolute preference to choices of clusters which yield the same ground states as the calculated energies .",
    "more specifically , a candidate cluster expansion which has a higher cross - validation score but predicts the correct ground states will be preferred to a cluster expansion which has a lower cross - validation score but predicts incorrect ground states .",
    "for a given set of structures , it is possible that no candidate cluster expansion predicts the right ground states . in these cases , a simple way to ensure that the ground states are correctly predicted is to give extra `` weight '' to specifically chosen structures in order to obtain the correct ground states .",
    "although we have already described how to include weights in the standard least - squares setting , we now have to also define an appropriate cross - validation score for the purpose of ranking the quality of weighted least - squares fit .",
    "since a linear regression of @xmath16 on @xmath23 with weights @xmath31 is equivalent to a regression of @xmath32 on @xmath33 , the natural extension of the cross - validation score to weighted fits is :    @xmath34    which , for the purpose of calculations , can written as : @xmath35 where @xmath36 .",
    "the following heuristic rule is used to set the weights .",
    "first , assign a unit weight to all structures .",
    "if the ground states are not correctly predicted , flag the `` problematic '' structures as follows .",
    "let @xmath37 be the concentration of structure @xmath1 .",
    "let @xmath38 be the indices of the true ground states among the calculated structures , sorted in increasing order of concentration . if a structure @xmath1 is such that @xmath39 lies below the line joining @xmath40 and @xmath41 for some @xmath42 , then mark structures @xmath1 , @xmath38 , @xmath43 as `` problematic '' .",
    "increase the weights of all `` problematic '' structures by one and repeat the process until the ground states are correctly predicted or until a specified number of unsuccessful trials has been reached .",
    "the rationale behind this algorithm is that , whenever possible , weights should be avoided . by adjusting weights , one can get a wide variety of results .",
    "when only the weights that are strictly needed to get a qualitatively correct ground state line are adjusted , we minimize the level of arbitrariness of the fitting procedure .      how can we select which structural energy to add to an existing fit in order to improve its accuracy at the least computational cost ? ideally , one would again select the structure that yields , for a given amount of computational time , the largest reduction in the prediction error of least - square fit , as estimated by the cv score .",
    "unfortunately , the cv score requires the knowledge of the energy of the new candidate structure to be added to the fit , which makes this approach unfeasible .",
    "however , as we will now describe , it is still possible to construct a useful estimate of the improvement in the accuracy of a cluster expansion even without the knowledge of the energy of a candidate new structure to be added to the fit .      as discussed in more details in the appendix , the prediction error of a least - square fit",
    "can be separated into two components : the bias and the variance .",
    "these quantities are best described in terms of the following thought experiment .",
    "if you were to choose at random many samples of @xmath19 structures and  were to compute a clusters expansion for each sample , each fit would give slightly different values for the eci .",
    "the eci , averaged over different samples , may give a slightly biased estimate of the true value of the eci ( because a truncated cluster expansion does account for all possible sources of energy fluctuations ) .",
    "in addition to this systematic bias component , the eci fitted to each sample will exhibit fluctuations around the mean whose magnitude can be characterized by a variance component .",
    "of course , since the eci are a multidimensional quantity , a matrix of covariances is needed to fully characterize the fluctuations .",
    "ideally , we would want to add to the fit the structure which most reduces the sum of the bias squared and of the variance .",
    "unfortunately , the reduction in the bias is impossible to predict without the knowledge of the energy of the new candidate structure to be added .",
    "we thus focus solely on the variance component , which can be estimated without the knowledge of the energy of the new structure .",
    "is it well known from the theory of least - square estimation @xcite that the covariance matrix of the eci is given by @xmath44 where @xmath45 is the mean squared error of the fit .",
    "note that @xmath26 , which is the matrix of the @xmath46 for each structure , indeed does not depend on the structural energies .",
    "( in principle , the @xmath45 term does depend on the structural energy , but it is a second order effect . to see this ,",
    "consider @xmath45 as a function of the eci .",
    "since a least - square fit is obtained by minimizing @xmath45 , it follows that @xmath45 is a quadratic function of the eci in the vicinity of the minimum , implying that a first order change in the estimated eci yields a second order change in the estimated @xmath45 . )",
    "we can now use equation ( [ olsvar ] ) to derive the variance of the predicted energies .",
    "the predicted energy @xmath22 of structure @xmath1 is a linear function of the eci @xmath47 where @xmath48 denotes the vector of the eci times their respective multiplicities ( i.e. @xmath49 ) .",
    "the variance of a linear function of a vector @xmath50 with known covariance matrix @xmath51 is given by : @xmath52 = x_{i\\cdot } vx_{i\\cdot } ^{t}.\\ ] ] this expression gives the variance of the predicted energy of only _",
    "one _ structure . to quantify the predictive power of the cluster expansion",
    ", we then need to average this quantity over all structures ( even those not yet included in the fit ) .",
    "the set of the values of the correlations for every possible structure is hard to characterize . while it is known to be a convex polytope embedded in a cube of side 2 , constructing this polytope is computationally intensive @xcite . to keep the calculations tractable ,",
    "we make the simplifying assumption  that the correlations @xmath25 of every possible structures are distributed isotropically in a sphere .",
    "the expected variance of a structure picked at random is then given by an integral over a sphere @xmath53 weighted by some spherically symmetric density @xmath54 : @xmath55 \\right ] & = & \\int_{s}u^{t}vu\\,f\\left ( \\left\\| u\\right\\| \\right ) \\ du \\\\ & = & \\int_{0}^{\\infty } \\left ( \\int_{\\left\\| u\\right\\| = r}u^{t}v\\ u\\,du\\right ) f\\left ( r\\right ) dr \\\\ & = & \\left ( \\int_{\\left\\| u\\right\\| = r}u^{t}vu\\,du\\right ) \\int_{0}^{\\infty } f\\left ( r\\right ) dr \\\\",
    "& \\propto & \\left ( \\int_{\\left\\| u\\right\\| = 1}u^{t}vu\\,du\\right ) \\\\ & = & { \\mbox{tr}}\\left ( v\\right ) .\\end{aligned}\\ ] ] the last step follows from the fact that for any set of orthogonal vectors @xmath56 , tr@xmath57 . in summary , the trace of the covariance matrix of the eci : @xmath58 provides us with a criterion to estimate the expected variance of the energies predicted from a cluster expansion .",
    "the question is now : what happens to the expected variance when a new structure is added to the fit ?",
    "changes in @xmath45 can be shown to be of a second order as follows .",
    "the least square procedure minimizes @xmath45 , implying any first - order change in the eci ( as a result of adding a new point to the fit ) yields no first - order change in @xmath45 .",
    "we can thus focus solely on finding the new structure @xmath1 which maximizes the reduction @xmath59 of the trace of @xmath27 : @xmath60 where @xmath25 are the correlations of the new structure to be added .",
    "since the length of the vector @xmath25 is bounded , there is a limit to how much a single structure can reduce the variance of the fit .",
    "the maximum variance reduction @xmath61 is reached when @xmath62 is the longest possible column vector @xmath63 parallel to the eigenvector of @xmath64 associated with the smallest eigenvalue : @xmath65 where @xmath63 is normalized so that @xmath66 , since correlations can not exceed one in magnitude .    this result can be shown by maximizing tr@xmath67 with respect to @xmath63 while introducing the constraints that @xmath68 through a lagrange multiplier @xmath69 . the first - order condition for this maximization problem",
    "can be found by first calculating the first - order change in tr@xmath70 with respect to changes in @xmath71 : @xmath72 the first - order condition is then given by @xmath73 which is just an eigenvalue problem : @xmath74 since we are looking for a maximum , we seek the largest eigenvalue of @xmath75 or , equivalently , the smallest eigenvalue of @xmath76 .",
    "this establishes that @xmath63 must be parallel with the eigenvector associated with the smallest eigenvalue of @xmath76 .",
    "we now derive an optimality criterion for selecting a new structure to include in the fit that takes both variance reduction and computational requirements into account .",
    "consider the change in variance when one structures is added to a fit already containing @xmath19 structures . then @xmath76 is of order @xmath19 , while the change in @xmath76 due to the new structures , @xmath77 , is of order @xmath78 .",
    "assuming that @xmath79 , a taylor series argument similar to the one of equation ( [ trlin ] ) yields : @xmath80 this shows that when the number @xmath19 of structures included is large , the variance - reducing effect of adding a few structures to the fit is linear .",
    "hence , when faced with the decision to add a structure reducing the variance by @xmath81 at a computational cost @xmath82 or a structure reducing the variance by @xmath83 at a computational cost @xmath84 , we should add the structure which maximizes @xmath85 . indeed , if @xmath86 one can compute about @xmath87 structures similar to structure @xmath78 in the time it takes to compute structure @xmath88 .",
    "the resulting variance reduction using structure @xmath88 is @xmath83 , while the variance reduction using @xmath87 structures similar to structure @xmath78 is @xmath89 .",
    "structure @xmath88 will be preferable if @xmath90 or @xmath91 the computational cost of obtaining the energy of a structure can be estimated in advance from the number of atoms in its unit cell and the known scaling law of the first - principles method used .    the algorithm to choose",
    "the `` best '' structure is thus the following .",
    "we scan through structures in increasing order of computational cost , that is , in increasing order of unit cell size .",
    "this task can be accomplished using well - known structure enumeration algorithms @xcite . for each structure , we compute the potential gains for adding it to the fit @xmath92 where @xmath25 and @xmath93 are , respectively , the correlations and the computational cost of structure @xmath1 .",
    "the search can be aborted when @xmath94 where @xmath95 is the best gain @xmath96 found so far and @xmath97 is the maximum possible variance reduction , given by equation ( [ maxv ] ) .",
    "we have so far solely focused on reducing the variance of the fit .",
    "but a successful cluster expansion must be able to predict the correct ground states and a special effort must be made to reduce the possibility of incorrect ground states . to address this issue , whenever a cluster expansion is constructed , we generate a large number of structures that were not included in the fit and check whether there are new predicted ground states among these structures .",
    "if there are none , then the minimum variance criterion for selecting new structures just presented is appropriate , because the cluster expansion we have is likely to be qualitatively correct and all we want is to obtain more precise eci .",
    "if new ground states _ are _ predicted , verifying their validity has priority over minimizing the variance . in this case , the search for the most variance - reducing structure is thus restricted to the set of newly predicted ground states .      before the refinement procedure described above can be used , a `` minimal '' start - up cluster expansion must be constructed and its eci determined .",
    "the minimal cluster expansion consists of the empty cluster , all the point clusters and all the nearest - neighbor pairs surrounding all atoms . ) in increasing order of distance from the origin .",
    "the `` nearest neighbor shell '' can be defined as the sites @xmath98 where @xmath19 is the largest @xmath19 such that @xmath99 for all @xmath100 .",
    "when there are more than one atom per unit cell , we consider the radius of each nearest neighbor shell , take the maximum @xmath101 , and then take all the pairs shorter @xmath101 . ] to determine the eci , we simply add structures to the fit in increasing order of computational requirements until we have one more structure than there are eci ( so that the cross - validation score can be calculated ) .",
    "at this point , refinement with the procedures outlined above can be started .",
    "after having described the theoretical principles supporting our automated algorithm , we are now ready to discuss its practical implementation .",
    "while designing our automated phase diagram calculation system , we sought to fulfill a number of important requirements .",
    "the system should be able to run over a long period of time without requiring user intervention while still allowing the user to intervene at any time , if desired .",
    "such a feature is useful in the context of _ ab initio _ calculations because the first few structural energy calculations are typically set up manually , in order to determine the values of the various input parameters of the ab initio method that offer the best trade - off between accuracy and computational requirements .",
    "once these parameters are chosen , they can be kept constant for the subsequent runs and the remainder of the process can be entirely automated .",
    "the system should keep the user informed of the best result obtained so far , as the calculation proceeds . in this fashion",
    ", the user can interrupt the process at any time if the currently available results are suitably accurate .",
    "in addition , the user has constant access to preliminary results , which can be used to try out subsequent processing steps ( e.g. monte carlo simulations ) , while the code keeps running , continuously improving the precision of the cluster expansion .",
    "another important requirement is fault - tolerance . as good as modern first - principles codes",
    "are , they sometimes fail and our system should gracefully handle these instances .",
    "the user may also decide at a later time to recalculate some energies more accurately , and the code should keep track of such updates .",
    "we wanted our system to be easily adaptable to any computing environment or energy methods .",
    "many first - principles codes and many computer architectures are currently available .",
    "we can not simply assume that one code or one system will eventually replace all others . finally , we wanted our system to make maximum use of parallelization opportunities .",
    "we achieve the goals described in the previous section through the setup illustrated in figure [ mapsflow ] .",
    "the process of fitting a cluster expansion using the algorithm presented in the previous section is performed by a subsystem called the mit ab - initio phase stability ( maps ) code .",
    "this subsystem is completely independent of both the _ ab initio _ code and the computing environment used .",
    "it implements the algorithms which determine , at any given time , ( i ) the best structure to add to a fit and ( ii ) the best clusters to add to a fit .",
    "the only input this subsystem requires is the geometry of the lattice , which can typically be described by a file less than 10 lines long .",
    "all other information needed for the construction of a cluster expansion , such as the space group of the lattice or a list of candidate clusters and structures , is automatically constructed from the geometrical input .",
    "the remaining subsystems _ are _ dependent on the _ ab initio _ code and the computing environment used .",
    "they consists of various simple `` scripts '' that can be easily adapted to any environment .",
    "a first filter combines a structure s geometric information , generated by maps , with various _ ab initio _ code - specific input parameters to produce input files for the first - principles code . in the case of pseudopotential - based codes , the code - specific parameters include @xmath102-point mesh density , energy cutoff and various switches that indicate the type of calculation to be performed .",
    "less than 10 lines of input are typically needed .",
    "another filter extracts the structure energies from the output files of the first - principles calculations .",
    "a `` job manager '' serves as the interface between maps and an array of processors dedicated to structural energy calculations .",
    "communication takes place through a set of simple signals :    1 .",
    "`` ready '' : processors are available to run first - principles calculations and maps should generate new structures whose energy is to be determined .",
    "2 .   `` energy '' : one first - principles code has successfully terminated and the energy of the structure is available .",
    "`` error '' : an error has occurred and the energy of a given structure is not available at this point .",
    "a specific signal is given by simply creating a file of the corresponding name .",
    "in contrast to more sophisticated communication schemes , such a simple approach is easy to implement and to customize by the end user .",
    "it is also very portable across different computer systems .",
    "these files can either be generated by the user or by simple automated scripts , thus allowing the code to be either controlled manually or automatically .",
    "maps simply monitors the creation of these files and reacts accordingly .",
    "if a new structural energy becomes available ( or a new error is reported ) , a new cluster expansion is fitted .",
    "if a new processor becomes available , a new structure is generated .",
    "since most structural energy calculations can comfortably run on a single processor , it is natural to parallelize the process at the level of the energy calculation . at this level",
    ", there is very little need for inter - process communication , and the parallelization efficiency essentially reaches 100% .",
    "any group of workstation can thus be directly set up to cooperatively construct a cluster expansion without requiring the installation of sophisticated networks or libraries .",
    "this software package can be obtained by contacting the authors at ` avdw@alum.mit.edu ` .",
    "to illustrate the usefulness of our algorithms and associated software package , we have computed the phase diagram of a wide variety of alloy systems : si - ge , cao - mgo , ti - al , cu - au .",
    "our examples include insulating ( cao - mgo ) , semi - conducting ( si - ge ) and metallic systems ( ti - al and cu - au ) .",
    "the crystal structure of our example systems also exhibits a wide variety , including systems whose parent lattice has more than one atom per primitive unit cell ( si - ge ) , systems that have spectator ions ( o in the cao - mgo system ) , or systems with multiple parent lattices ( hcp and fcc in the ti - al system ) .    with a few exceptions discussed below",
    ", our predicted phase diagrams exhibit the same stable phase as the experimentally determined phase diagram .",
    "however , as is commonly the case in phase diagrams calculated from first - principles , the temperature scale of the phase transitions is oftenoverestimated .",
    "the physical origin of this overestimation has not been unambiguously established , but likely candidates are ( i ) the omission of the effect of lattice vibrations @xcite ( ii ) the omission of weak but very long - range elastic interactions due to atomic size mismatch @xcite ( iii ) the limited precision of first - principles calculations based on the local density approximation ( lda ) . on the one hand , the formalisms that account for lattice vibrations and elastic interactions have been developed and would represent a very important addition to our package .",
    "on the other hand , our package can easily be adapted to make use of more accurate first - principles method , as they become available .",
    "our first - principles calculations are performed within the local density approximation ( lda ) using the vasp @xcite package , which implements ultra - soft @xcite pseudopotentials @xcite . in all calculations",
    ", we used the default settings implied by the `` high precision '' option of the code .",
    "the @xmath102-point mesh was constructed using the monkhorst - pack scheme and was chosen such that the number of @xmath102-points times the number of atom in the unit cell was at least @xmath103 for metallic systems and @xmath104 for insulating systems .",
    "this choice keeps the @xmath102-point density constant , despite changes in the unit cell size . to ensure that the @xmath102-point density is as isotropic as possible ,",
    "the number of mesh points along a given reciprocal lattice vector @xmath105 was set proportional to @xmath106 , where @xmath107 and @xmath108 are the two remaining reciprocal lattice vectors .",
    "our calculated phase diagrams were obtained through low temperature expansion ( lte ) @xcite and monte carlo ( mc ) simulations @xcite .",
    "the mc simulation cells used ranged from @xmath109 supercells to a @xmath110 supercells .",
    "the number of equilibration mc passes and the number of averaging mc passes used to obtain thermodynamic quantities were chosen so that the precision of the average concentration of the alloy is less than @xmath111 .",
    "this precision typically required from @xmath112 to @xmath113 equilibration mc passes and from @xmath112 up to @xmath114 averaging mc passes , depending on temperature .",
    "the thermodynamic integration method was used to determine the grand canonical potential @xmath115 of each phase @xmath6 as a function of chemical potential @xmath116 .",
    "the grand canonical potential at the starting point of the integration path was obtained from the lte .",
    "phase boundaries between two phases @xmath6 and @xmath117 are found by locating the intersection of the curves @xmath118 and @xmath119 .",
    "the concentrations of each phase in equilibrium at the phase transition are given by the slope of the curves of the point of intersection .",
    "additional details regarding these calculations will be presented in a separate communication @xcite .",
    "while a summary of the characteristics of the five cluster expansions we constructed can be found in table [ sumce ] , the details specific to each system are discussed below .",
    "first - principles investigation of phase stability in the si - ge system have been performed earlier @xcite .",
    "one of the most thorough studies @xcite relied on the so - called computational alchemy method .",
    "while this ingenious method enables the direct determination of long - range pair interactions , clusters larger than pairs are not included in their full generality .",
    "( computational alchemy does allow the pair interactions to depend on concentration , thereby implicitly accounting , to a limited extent , for multiplet interactions . )",
    "it is thus of interest to verify that such a simplification is appropriate by employing our automated tool , which allows the inclusion of multiplets .",
    "figure [ sige_eci ] shows that the energetic contribution of pairs indeed dominates the contribution of multiplets .",
    "not only are the included multiplets associated with very small eci , but the cross - validation algorithm automatically determines that very few triplets should be included in the cluster expansion .",
    "figure [ sige ] show the calculated phase diagram .",
    "the predicted critical temperature ( 325 k ) lies between the predictions of @xcite ( 375k ) and @xcite ( 170k ) .",
    "a very complete first - principles analysis of the cao - mgo system was undertaken in @xcite .",
    "while a substantial amount of labor was needed to complete this analysis , our software package enabled us to reproduce this study in a fully automatic fashion .",
    "in contrast to the si - ge system , multiplet interactions are important in the cao - mgo system ( as seen in figure [ caomgo_eci ] ) and are responsible for the pronounced asymmetry in the miscibility gap observed both in our calculation and in the experimental measurements ( see figure [ caomgo ] ) .",
    "this feature was not given as an input to the code and it is interesting that the code was able to identify it independently .      our third example seeks to reproduce the very detailed first - principles calculation of the ti - al phase diagram found in  @xcite .",
    "we focus on the ti - rich portion of the phase diagram because the al - rich half of the phase diagram exhibits order - order transitions that would prompt the inclusion of the thermodynamic effects of lattice vibrations , which is beyond the scope of the present study .",
    "for the same reason , we do not investigate the ti ( hcp ) @xmath120 ti ( bcc ) transition .",
    "however , we do model both hcp - based phases ( the ti solid solution and the do@xmath121 ti@xmath122al phase ) and the fcc - based l1@xmath123 nial phase . as shown in figure [ tial_eci ] ,  the cluster expansion on the hcp lattice could easily be pushed to a higher accuracy than in the earlier study @xcite , which only included up to second - nearest neighbor pair interactions and a few multiplets . the cluster expansion on the fcc lattice ( see figure [ tialfcc_eci ] ) does not need to be as accurate because the location of the phase boundaries was found to be insensitive to further improvement in the fcc cluster expansion .",
    "figure [ tial ] shows our calculated phase diagram .",
    "as discussed at the beginning of this section , our calculations overestimate the experimental order - disorder transition temperature of the do@xmath121 ti@xmath122al phase  ( @xmath124k ) .",
    "however , our calculated order - disorder transition temperature of @xmath125k corroborates the first - principles prediction of @xmath126k found by @xcite .",
    "the most accurate first - principles study of the cu - au system is described in a series of articles @xcite .",
    "although our calculations include neither explicit elastic interactions nor the contribution of lattice vibrations , we were able to obtain good quantitative agreement with these earlier calculations as well as experimental measurements , as seen by the transition temperatures reported in table [ cuautc ] .",
    "we focus on the cu - rich half of the phase diagram , because there is well - documented disagreement between the experimentally observed ground state at the cuau@xmath122 composition and the one predicted from lda calculations @xcite . as in earlier lda calculations , we were not able to model the cuau - i @xmath120 cuau - ii transition , which is driven by very small free energy differences that are beyond the accuracy of current lda calculations @xcite .",
    "our calculated eci are plotted in figure [ cuau_eci ] , while the resulting phase diagram is shown in figure [ cuau ] .",
    "we have formalized the decision rules that allow the automatic construction of a cluster expansion .",
    "the development of a fully automated procedure to compute phase diagrams from first principles allows the powerful cluster expansion formalism to be used by anyone who possesses basic material science knowledge . through a variety of examples",
    ", we have shown that earlier first - principles phase diagram calculations , which represented significant contribution to the field of alloy theory at the time of their publication , can now be reproduced in an automated fashion .",
    "a variety of extensions to  our work would prove extremely useful . a module that computes the vibrational free energies at a reasonable computational cost ( for instance",
    ", through the methods presented in @xcite or @xcite ) would allow the modelization of allotropic transitions and improve the precisions of the calculated transition temperatures .",
    "the inclusion of electronic entropy should be straightforward @xcite .",
    "the explicit inclusion of elastic contributions to the energy through a reciprocal space cluster expansion @xcite would also be very helpful .",
    "this work was supported by the u.s .",
    "department of energy , office of basic energy sciences , under contract no .",
    "de - f502 - 96er 45571 .",
    "gerbrand ceder acknowledges support of union minire through a faculty development chair .",
    "axel van de walle acknowledges support of the national science foundation under program dmr-0080766 during his stay at northwestern university .",
    "1998ozob    r.  kikuchi , _ phys .",
    "_ 81 _ , 988 ( 1951 ) .",
    "j.  c. phillips and l.  kleinman , _ phys . rev . _ _ 116 _ , 287 ( 1959 ) .",
    "m.  stone , _",
    "b met . _ _ 36 _ , 111 ( 1974 ) .",
    "j.  w. connolly and a.  r. williams , _ phys .",
    "b _ _ 27 _ , 5169 ( 1983 ) .",
    "j.  m. sanchez , f.  ducastelle , and d.  gratias , _ physica _ _ 128a _ , 334 ( 1984 ) .",
    "li , _ ann .",
    "_ _ 15 _ , 956 ( 1987 ) .",
    "k.  binder and d.  w. heermann , _ monte carlo simulation in statistical physics_. springer - verlag , new york , ( 1988 ) .",
    "v.  l. moruzzi , j.  f. janak , and k.  schwarz , _ phys .",
    "b _ _ 37 _ , 790 ( 1988 ) .    a.  qteish and r.  resta ,",
    "b _ _ 37 _ , 6983 ( 1988 ) .",
    "g.  ceder , m.  asta , w.  c. carter , m.  sluiter , m.  e. mann , m.  kraitchman , and d.  de  fontaine , _ phys .",
    "b _ _ 41 _ , 8698 ( 1990 ) .",
    "d.  vanderbilt , _ phys .",
    "b _ _ 41 _ , 7892 ( 1990 ) .",
    "s.  de  gironcoli and p.  giannozzi , _ phys .",
    "_ 66 _ , 2116 ( 1991 ) .",
    "f.  ducastelle , _ order and phase stability in alloys_. elsevier science , new york , ( 1991 ) .",
    "l.  g. ferreira , s .- h .",
    "wei , and a.  zunger , _ int .",
    "j. supercomput .",
    "_ _ 5 _ , 34 ( 1991 )",
    ".    a.  s. goldberger , _ a course in econometrics_. harvard university press , cambridge , massachusetts , ( 1991 ) .",
    "d.  b. laks , l.  g. ferreira , s.  froyen , and a.  zunger , _ physical review b _ _ 46 _ , 12587 ( 1992 ) .",
    "m.  asta , d.  de  fontaine , and m.  van schilfgaarde , _",
    "j. mater res . _",
    "_ 8 _ , 2554 ( 1993 ) .",
    "g.  ceder , _ comput .",
    "_ 1 _ , 144 ( 1993 ) .",
    "g.  ceder , g.  d. garbulsky , d.  avis , and k.  fukuda , _ phys .",
    "b _ _ 49 _ , 1 ( 1994 ) .    d.  de  fontaine , _ solid state phys .",
    "_ _ 47 _ , 33 ( 1994 ) .",
    "g.  d. garbulsky and g.  ceder , _ phys .",
    "b _ _ 49 _ , 6327 ( 1994 ) .    a.  zunger .",
    "first principles statistical mechanics of semiconductor alloys and intermetallic compounds . in p.  e. turchi and a.  gonis , editors , _ nato asi on statics and dynamics of alloy phase transformation _ ,",
    "volume 319 , page 361 , new york , ( 1994 ) . plenum press .",
    "g.  d. garbulksy and g.  ceder , _ phys .",
    "b _ _ 51 _ , 67 ( 1995 ) .    c.  wolverton and a.  zunger , _ phys . rev .",
    "b _ _ 52 _ , 8813 ( 1995 ) .    g.  d. garbulsky and g.  ceder , _ phys . rev .",
    "b _ _ 53 _ , 8993 ( 1996 ) .",
    "g.  kresse and j.  furthmller , _ comp . mat .",
    "_ 6 _ , 15 ( 1996 ) .",
    "g.  kresse and j.  furthmller , _ phys .",
    "b _ _ 54 _ , 11169 ( 1996 ) .",
    "r.  mccormack and d.  de  fontaine , _ phys .",
    "b _ _ 54 _ , 9746 ( 1996 ) .    p.  d. tepesch , a.  f. kohan , g.  d. garbulsky , and g.  ceder _ et al .",
    "_ , _ j. am . ceram . _",
    "_ 49 _ , 2033 ( 1996 ) .",
    "a.  f. kohan , p.  d. tepesch , g.  ceder , and c.  wolverton , _ comp . mat .",
    "_ 9 _ , 389 ( 1998 ) .",
    "v.  ozolin , c.  wolverton , and a.  zunger , _ phys .",
    "b _ _ 57 _ , 6427 ( 1998 ) .",
    "v.  ozolin , c.  wolverton , and a.  zunger , _ phys .",
    "b _ _ 58 _ , r5897 ( 1998 ) .",
    "v.  ozolin , c.  wolverton , and alex zunger , _ phys .",
    "b _ _ 57 _ , 4816 ( 1998 ) .    a.  van  der ven , m.  k. aydinol , g.  ceder , g.  kresse , and j.  hafner , _ phys . rev .",
    "b _ _ 58 _ , 2975 ( 1998 ) .",
    "a.  van  de walle , g.  ceder , and u.  v. waghmare , _ phys .",
    "_ _ 80 _ , 4911 ( 1998 ) .    c.  wolverton , v.  ozolin , and a.  zunger , _ phys .",
    "b _ _ 57 _ , 4332 ( 1998 ) .    a.  van  de walle and g.ceder , _ phys .",
    "b _ _ 61 _ , 5972 ( 2000 ) .",
    "a.  van  de walle and m.  asta . automating monte carlo simulations for phase diagram calculations .",
    "mimeo , northwestern university , ( 2001 ) .",
    "a.  van  de walle and g.  ceder , _ rev",
    "_ _ 74 _ ( 2002 ) , in press .",
    "this section provides a heuristic proof of the validity of the cross - validation selection rule .",
    "a formal proof , under the assumptions relevant to our application , can be found in @xcite .",
    "the concepts used are described in more detail in  @xcite .",
    "let us first describe the conventions underlying our discussion .",
    "for a given choice of clusters @xmath127 , consider a sample of @xmath128 correlation vectors @xmath129 , for @xmath130 .",
    "each correlation vector @xmath25 is associated with a large set of structures that have the same correlation vector @xmath25 ( although their other correlations , not included in @xmath25 , differ ) .",
    "we then consider the structural energy @xmath16 obtained for a structure with correlation @xmath25 to be a random variable , because fixing @xmath25 does not entirely determine @xmath16 . to handle this randomness ,",
    "we will be concerned with calculating expectation values , denoted @xmath131 , averaged over every possible sample of @xmath19 structures having the given correlation vectors @xmath25 , @xmath130 .",
    "for instance , @xmath132 is the  average energy of all structures with correlation @xmath25 , which is equal to the energy that would be obtained from a cluster expansion that uses the true exact eci for all included clusters @xmath127 but a zero eci for all the other clusters .",
    "let us now define two important quantities , adopting the convention that @xmath133 denotes a structure ( with correlation @xmath134 ) that is not included in the least - squares fit .",
    "* let @xmath22 ( for @xmath135 ) be the energy of structure @xmath1 predicted using a cluster expansion fitted to the @xmath19 structural energies available .",
    "* let @xmath17 ( for @xmath130 ) be the energy of structure @xmath1 predicted using a cluster expansion fitted to all known structural energies except the one of structure @xmath1 , for a total of @xmath136 structures .",
    "we are now ready to compute the predictive power @xmath137 of the cluster expansion , that is , the expected squared error of the prediction of a structural energy not included in the fit : @xmath138 in general , for any structure @xmath1 , the expected squared error can be decomposed as @xmath139 where @xmath140 is the so - called bias term while @xmath141 is the so - called variance term . the covariance term @xmath142 vanishes for a structure not included in the fit ( @xmath143 ) because @xmath144 has no effect on @xmath145 .",
    "however , for a structure included in the fit ( @xmath146 ) , this covariance term is positive .",
    "whenever @xmath16 is large , @xmath22 will tend to be large as well , because the least - square procedure attempts to minimize the distance between @xmath22 and @xmath16 .",
    "this effect worsens as the ratio @xmath147 increases .",
    "for this reason , attempting to estimate the predictive power using the mean squared error of the least - squares fit leads to a biased estimate of the true predictive power .",
    "this problem is corrected by using the cross - validation score , which focuses on the quantity @xmath148 instead of @xmath149 . in equation ( [ biasvar ] ) , the expected value of the bias term is unaffected by this change , while the variance term is changed by an amount that goes to zero as sample size @xmath19 grows .",
    "more importantly , the covariance term @xmath150 now vanishes for @xmath130 because the value of @xmath17 does not depend on @xmath16 .",
    "it follows that @xmath151 is an unbiased measure of the predictive power . by the law of large numbers ,",
    "the abstract quantity @xmath152 can be estimated by the corresponding sample average @xmath153 , the cross - validation score .",
    "figure [ mapsflow ] : organization of the automated cluster expansion package .",
    "figure [ sige_eci ] : calculated eci as a function of cluster diameter for the si - ge system .",
    "figure [ sige ] : calculated phase diagram of si - ge system .",
    "figure [ caomgo_eci ] : calculated eci as a function of cluster diameter for the cao - mgo system .",
    "figure [ caomgo ] : calculated phase diagram of cao - mgo system .",
    "figure [ tial_eci ] : calculated eci as a function of cluster diameter for the hcp phases of the ti - al system .",
    "figure [ tialfcc_eci ] : calculated eci as a function of cluster diameter for the fcc phases of the ti - al system .",
    "figure [ tial ] : calculated phase diagram of ti - al system ( ti - rich portion ) .",
    "figure [ cuau_eci ] : calculated eci as a function of cluster diameter for the cu - au system .    figure [ cuau ] : calculated phase diagram of cu - au system ( cu - rich portion ) .",
    ".characteristics of the calculated cluster expansions .",
    "the number of clusters is given as the number of each type of multiplet : empty and point clusters+pairs+triplets+quadruplets.[sumce ] [ cols= \" < , < , < , < , < , < \" , ]"
  ],
  "abstract_text": [
    "<S> devising a computational tool that assesses the thermodynamic stability of materials is among the most important steps required to build a `` virtual laboratory '' , where materials could be designed from first - principles without relying on experimental input . </S>",
    "<S> although the formalism that allows the calculation of solid state phase diagrams from first principles is well established , its practical implementation remains a tedious process . </S>",
    "<S> the development of a fully automated algorithm to perform such calculations serves two purposes . </S>",
    "<S> first , it will make this powerful tool available to large number of researchers . </S>",
    "<S> second , it frees the calculation process from arbitrary parameters , guaranteeing that the results obtained are truly derived from the underlying first - principles calculations . </S>",
    "<S> the proposed algorithm formalizes the most difficult step of phase diagram calculations , namely the determination of the `` cluster expansion '' , which is a compact representation of the configurational dependence of the alloy s energy . </S>",
    "<S> this is traditionally achieved by a fit of the unknown interaction parameters of the cluster expansion to a set of structural energies calculated from first - principles . </S>",
    "<S> we present a formal statistical basis for the selection of both the interaction parameters to include in the cluster expansion and of the structures to use in order to determine them . </S>",
    "<S> the proposed method relies on the concepts of cross - validation and variance minimization . </S>",
    "<S> an application to the calculation of the phase diagram of the si - ge , cao - mgo , ti - al , and cu - au systems is presented . </S>"
  ]
}