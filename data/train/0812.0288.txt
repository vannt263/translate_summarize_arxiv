{
  "article_text": [
    "when @xcite studied galaxy velocities in clusters , he was the first to notice that there should be about one order of magnitude more matter in the universe than the observed amount of baryonic matter to explain the proper motions of galaxies through gravitational forces .",
    "dark matter ( dm ) was introduced to overcome this problem .",
    "later on , the existence of a dark matter component was confirmed by the analysis of galaxy rotation curves @xcite .",
    "recent studies of gravitational lensing ( e.g. * ? ? ?",
    "* ) and , more generally , multiwavelength observations in e.g. the cosmos project @xcite provide additional proofs for the existence of dm .",
    "other constraints on the non - baryonic nature of dm were also set by the analysis of the cosmic microwave background ( e.g. * ? ? ? * ) .    for the last three decades , the dm paradigm has been studied extensively in the context of cosmological @xmath0-body simulations .",
    "the comparison of structures formed in such simulations to observed ones excluded some of the theoretical models , such as hot dark matter and led to the nowadays commonly accepted @xmath5-cold dark matter ( @xmath5cdm ) model . in the @xmath5cdm model , dark matter is collisionless , with a very small velocity dispersion at high redshift ; structures are built in a hierarchical , bottom - up process , where small structures arise first , seeded from initial fluctuations , and then merge together to build up larger and larger structures , designated commonly as _",
    "haloes_. inside the gravitational wells of these dark matter haloes , baryonic matter forms galaxies @xcite .",
    "recently , the efforts to finally identify the physical nature of dark matter particles , either directly through detecting them in ground - based dark matter particle detectors or indirectly by observing their annihilation radiation , have intensified . at the same time , the ever increasing resolution of n - body simulations ( e.g. * ? ? ?",
    "* ) puts new levels of demand on the field of theoretical study of non - linear halos .",
    "the careful analysis of cosmological structures moves from the study of spherically averaged three - dimensional density profiles @xcite to the study of the full six dimensional phase - space .",
    "for example , this concerns the analyses of the properties of caustics described analytically in e.g. bertschinger s secondary infall model @xcite and recently reviewed in the context of numerical simulations @xcite .",
    "investigations of full phase - space structures include accurate simulations of two dimensional phase - space @xcite and analyses relying on a metric approach to six dimensional phase - space in @xmath0-body simulations @xcite .    a particularly important step in understanding dark matter clustering lies in an analysis of the bound structures found in @xmath0-body simulations .",
    "this is at present usually carried out with structure finders such as subfind @xcite , adaptahop @xcite or psb @xcite . following this path",
    ", we present a new multi - dimensional hierarchical structure finder which complements all the above numerical methods with an effective and robust analysis of phase - space structures in full 6d space .",
    "the paper is organised as follows .",
    "first , we review current structure finders in section  [ sec : structure ]",
    ". we then present our new multi - dimensional hierarchical structure finder ( hsf ) in section  [ sec : hsf ] . in section  [ sec : test ] , we use our algorithm to detect and analyse phase - space structures of a large halo taken from the millennium simulation .",
    "we investigate the space of parameters on which our hsf algorithm depends and try to find the best choice of the parameters according to the application under consideration .",
    "we also introduce the simulation merger tree to follow the evolution of structures in phase - space .",
    "this allows us to analyse in detail a few representative cases .",
    "this is followed by a quantitative analysis of hsf structures in the space and time domain .",
    "we also discuss the bimodal nature of the substructure population , in terms of bound structures versus tidal tails and tidal streams .",
    "finally , in section  [ sec : discussion ] we give a summary and present our conclusions .",
    "an important step in the analysis of cosmological @xmath0-body simulations is to search for virialized dark matter haloes .",
    "these are commonly defined as regions around local density maxima enclosed by a certain isodensity contour .",
    "the exact definition of such a border changes from method to method .",
    "the simplest and the most popular technique for finding virialized haloes is the friends - of - friends ( fof ) method @xcite , which links together particles which are separated by less than a fixed length @xmath6 .",
    "usually @xmath6 is set to @xmath7 times the mean inter - particle separation , which corresponds to finding haloes with overdensity approximately equal to @xmath8 times the mean background density @xmath9 @xcite .",
    "the mass function of haloes identified by the fof method is in good but not perfect agreement with the predictions of the press - schechter theory .",
    "however , the method tends to link together structures across fine bridges ( e.g. * ? ? ? * ) and it is not capable of detecting substructures inside the virialized haloes themselves . a comparable method is the spherical overdensity algorithm ( so , * ? ? ?",
    "* ) which searches for local density peaks and then grows around them spheres out to a radius where the enclosed mean density satisfies a prescribed overdensity criterion . by definition ,",
    "the so method finds only spherical structures .",
    "it does not link structures together with artificial bridges as fof does , but it may count mass twice in certain cases .",
    "however , for current high resolution simulations , one needs to find not only isolated haloes but also their internal substructures .",
    "one of the first methods which made it possible to find such structures is the hierarchical friends - of - friends scheme @xcite , in which a set of different linking parameters , @xmath6 , is used to identify multiple levels of substructures inside haloes .    to distinguish haloes and their substructures in rich environments ,",
    "each detected structure is then usually tested against an additional binding criterion .",
    "this dynamical criterion uses information from velocity space to guarantee that each structure not only exists but will survive for a longer period of time .    in the spirit of the so and fof methods , the bound density maxima ( bdm , * ? ? ?",
    "* ) and denmax @xcite methods were proposed . in bdm , particles are grouped in spheres around local density maxima and are then progressively unbound . in denmax , particles are grouped together when they converge to the same local density maximum if they are moved along local gradients , calculated on a rectangular grid . in a final additional step they are attached to groups identified by the fof method and then their total binding energy is checked .",
    "this method was generalised in the skid algorithm @xcite , in which the local density and its gradient are calculated directly at the particles positions with the sph method .",
    "a similar but simpler method was implemented in the hop algorithm @xcite , in which each particle is connected to the one with the highest density ( found by sph ) among its @xmath10 closest neighbours ( with @xmath10 ranging typically between 10 and 20 ) . in this way",
    ", space is divided into peak - patches that are then combined into the final structures .",
    "the hop method gave rise to new structure finders such as subfind , adaptahop , voboz and psb .",
    "the differences between them are sometimes quite subtle . in subfind @xcite , each particle marks its two closest neighbours with higher density among the @xmath10 closest ones",
    ". then particles are sorted by sph - density in descending order .",
    "particles without higher density neighbour are marked as the centres of new structures ( local density maxima ) .",
    "then the structures grow down in density till they reach border particles , called saddle points , which have two higher density neighbours belonging to two different structures .",
    "the smallest structure is marked as a structure candidate and then both structures are joined together .",
    "structure candidates are arranged in a hierarchical tree and are successively unbound , going from bottom of the tree to the top .",
    "particles which are not bound to a structure are attached to its larger parent structure .",
    "even though adaptahop @xcite constructs the tree of structures in the opposite way to subfind , from bottom to top , the main ideas are very similar .",
    "first , it grows peak - patches around local density maxima as in hop and then finds border particles and saddle points among them .",
    "in addition to subfind , each structure is checked against poisson noise to infer its level of significance . in adaptahop ,",
    "contrary to subfind , only particles above saddle points define structures .",
    "voboz @xcite on the other hand uses delaunay tessellation to define particle densities and neighbourhood relations , and also checks the significance level of structures against a specific poisson noise criterion .",
    "the psb algorithm @xcite uses a grid as in denmax to find local density maxima and saddle points , but then constructs a hierarchical structure tree in the same way as in subfind . in psb",
    ", particles below saddle points are first attached to all structures which are above them and then are assigned to individual structures following the process of unbinding .",
    "in addition to the standard unbinding procedure , psb takes into account tidal force criteria .    even though many of the above structure finders use velocity information for the purpose of a gravitational unbinding procedure , none of them uses the full six dimensional phase - space information .",
    "however , the advantage of such an approach is that structures can be defined in a much more natural way in phase - space . in particular",
    ", they have a higher contrast than in position space .",
    "in fact , many structures such as streams and caustics are well defined only in phase - space .",
    "6d fof @xcite is the first implementation of a structure finder working directly in phase - space .",
    "it is conceptually a simple extension of fof based on a six dimensional distance measure , using a fixed global scaling between position and velocity space .",
    "the proposed method finds only local phase - space density maxima and then grows spheres around them like in bdm algorithm .    in this paper",
    ", we propose a new universal multi - dimensional hierarchical structure finder ( hsf ) which is used here to find phase - space structures in cosmological n - body simulations .",
    "the algorithm employs , in a higher number of dimensions , a similar approach to subfind and adaptahop , but with a new and very effective cut or grow criterion , controlled by a _ connectivity parameter _",
    "@xmath11 , to separate accurately structures from each other .",
    "our goal is to find the hierarchy of dark matter haloes and subhaloes , which are defined by locally overdense regions in phase - space .",
    "the main difference between our approach and previous structure finders is that we focus on all kind of phase - space structures even those which are not self - bound , such as tidal streams . to enable comparisons , we however implement , in addition to our base algorithm , also an unbinding step .",
    "the hsf can be run on a full simulation to detect all the haloes and the subhaloes population , or on standard groups found by a fof algorithm with , e.g. , @xmath12 .",
    "prior to the identification of structures , our hsf algorithm estimates the local phase - space density and the local phase - space neighbourhood of each particle in the sample . following the proposal of @xcite for optimum local phase - space density estimation , we use the sph method with @xmath13 neighbours found in the adaptive metric computed by the enbid algorithmof @xcite .",
    "we performed a small modification of the enbid algorithm to make possible the output for each particle of the phase - space neighbourhood with @xmath10 closest neighbours among the @xmath13 ( in the proper local adaptive metric frame ) .",
    "it is worth mentioning that both phase - space density and neighbourhood estimations by the enbid algorithm are computationally inexpensive and are almost as fast as standard three - dimensional sph estimators .",
    "we define _ phase - space structures _ as the regions grown around local density maxima by following the local density gradient . to find such structures , hsf uses a modified version of subfind , which redistributes particles below saddle points in a new fashion . in the first step ,",
    "the hsf algorithm finds locally overdense regions in phase - space by tracing isodensity contours identified by saddle points .",
    "in addition , we test on each saddle point if structures are statistically significant when compared to poisson noise as in adaptahop . particles below phase - space isodensity contours can in principle be attached to many structures simultaneously but our aim is to attach each of them to only one structure . to do that , we use a simple but robust cut or grow criterion depending on a _ connectivity parameter _",
    "@xmath11 , which allows us to reconstruct a multilevel hierarchy of structures within structures . in our implementation",
    ", each saddle point defines a connecting bridge between two structures .",
    "particles below this saddle point are attached to one of the structures , or are redistributed between both of them according to the structure masses .",
    "we here consider two different cases :    * the two structures have comparable masses : we attach particles below the isodensity contour to both structures in the same manner as above the isocontour .",
    "border particles are attached to the most massive structure ; * one structure is significantly less massive than the other one : we mark it as a structure and attach all particles below it only to the most massive one .    while we apply the cut or grow criterion , we create a hierarchical binary tree of structures by connecting each structure to its more massive partner if one exists . this way of cutting works like a second poisson noise criterion and",
    "it allows one to grow only structures which are significant .    in detail , the hsf algorithm , sketched in figure  [ hsf ] , works as follows :    1 .   for each particle",
    ", we estimate the local phase - space density with sph - am and the local adaptive metric environment using @xmath14 neighbours .",
    "we usually perform the sph interpolation with @xmath15 .",
    "this value represents a good compromise between filtering of poisson noise and identification of faintest significant structures .",
    "we find that the final results are rather insensitive to the choice of @xmath10 .",
    "our favourite value is @xmath16 , similar to what is used with hop , adaptahop and subfind .",
    "then for each particle , we find the set @xmath17 of its neighbours among the @xmath10 which have higher density than the particle .",
    "we sort the set @xmath17 ascendingly according to local neighbourhood distances ( closest particles are in the beginning of the list ) .",
    "then we take the two closest elements of @xmath17 and put them in a second set @xmath18 .",
    "this set can be empty or contain one or two elements",
    "we sort the particles by decreasing phase - space density and , following this ordering , we attach each particle to different structures according to the following rules : 1 .",
    "the set @xmath18 is empty .",
    "this means that the particle does not have any neighbour with higher density : we found a local maximum and we mark the particle as the beginning of a new structure .",
    "2 .   the set @xmath18 contains one or two particles which belong to the same structure : we attach the particle to this structure ; or set @xmath18 contains two particles which belong to different structures @xmath19 and @xmath20 , and the @xmath19 structure",
    "is marked as a more massive partner of @xmath20 : particle is attached to @xmath19 ( this is a border particle ) .",
    "the set @xmath18 contains two particles which belong to different structures @xmath19 and @xmath20 and the structures are not on each other s more massive partner list : it means that we found a saddle point and we perform the marking @xmath21 , @xmath22 , or @xmath23 .",
    "+ the way this marking is performed in detail can be described as follows : 1 .   first",
    ", we check the level of significance of structures @xmath19 and @xmath20 when compared to poisson noise @xcite .",
    "let @xmath24 and @xmath25 be the first and the second structure s average density and @xmath26 be the density of the saddle point connecting them .",
    "each structure is significant if @xmath27,\\ ] ] where @xmath28 is the `` @xmath29 '' level of significance of the structure ( in our tests @xmath28 is set between @xmath30 and @xmath31 ) , and @xmath0 is the number of particles belonging to the structure .",
    "if one of the structures is not significant , then we attach all of its particles to the second structure . in the case where both structures are not significant , we attach all the particles to the structure which has the highest maximum density .",
    "2 .   if both structures are significant compared to poisson noise , we test them against the cut or grow criterion .",
    "let @xmath32 and @xmath33 be the masses of our structures up to this saddle point and @xmath34 , then we mark structure @xmath19 as more massive partner of @xmath20 .",
    "if @xmath35 , with @xmath36 , then structure @xmath20 is more than @xmath37 times less massive than @xmath19 and we attach all the particles below this saddle point to @xmath19 .",
    "if @xmath38 , we consider that both structures have the same order of mass : we attach the saddle point to the most massive structure and all particles below are attached according to the rules we set before .",
    "+ -@xmath39 position space ; _ right panels : _",
    "radius @xmath40 - radial velocity @xmath41 phase - space . from top to bottom , the grey pattern corresponds to the substructure found respectively by ( i ) subfind before unbinding , ( ii ) subfind after unbinding , ( iii ) hsf before unbinding , ( iv ) hsf after unbinding.,width=321,height=642 ] 3 .   finally , a structure containing less than @xmath42 particles is considered insignificant , and all its particles are attached to its more massive partner .",
    "if a structure with less than @xmath42 particles does not have a more massive partner , we put it on the list of _ fuzzy _ particles .",
    "4 .   at the end of this process",
    ", we obtain a hierarchical tree of structures .",
    "each particle belongs only to one structure or to the background ( fuzzy list ) .",
    "in addition , we add to our algorithm a final step in which we check each structure against an unbinding criterion .",
    "once we have marked its more massive partner for each structure , we sort them recursively such that the larger partners ( parents ) are always after the smaller ones ( children ) .",
    "then we unbind structure after structure from children to parents and add unbound particles to the larger partner . for each individual structure , we calculate the gravitational potential .",
    "we set the structure centre as the position of the particle with the minimum potential and the velocity centre as the mean velocity .",
    "we calculate the kinetic energy of each particle relative to the mean velocity of the structure .",
    "all the particles with positive total energy are marked and , in that ensemble , @xmath43 of the ones with positive total energy are removed .",
    "we repeat this process iteratively ( starting with a new gravitational potential calculation ) up to the moment when we stay with bound particles only .",
    "if the structure has less than @xmath42 particles after the unbinding process , then we mark it as not bound and attach all its particles to its more massive partner or put them on the fuzzy particles list . to speed up the calculation of the gravitational potential",
    ", we use the tree algorithm implemented in gadget-2 @xcite .",
    "most halo finders such as denmax , bdm , skid , subfind , adaptahop and voboz use a two step procedure for finding the structures .",
    "first , they assign as many particles as possible to each individual structure in three dimensional space by tracing local overdensities ( figure  [ comp_profile ] , top left panel ) .",
    "when we move to phase - space diagram ( figure  [ comp_profile ] , top right panel ) , we however immediately observe that there are many particles belonging to different velocity structures . the unbinding process ( figure  [ comp_profile ] , second row of panels ) then cleans up all these spurious velocity structures . in the four bottom panels , one can observe the results obtained with the six dimensional hsf algorithm .",
    "this method allows us to attach particles to structures in a more natural way , because it treats both position and velocity space ( figure  [ comp_profile ] , third row of panels ) .",
    "note that , after unbinding , the structures detected by the hsf algorithm are more extended than with standard algorithms working in position space ( figure  [ comp_profile ] , bottom panels ) , an indication that more of the mass belonging to the substructures is recovered .",
    "( eq .  [ eq1 ] ) on the mass profile is tested.,width=321,height=321 ]     and the importance of the unbinding process are tested.,width=321,height=321 ]    to test our algorithm we use a large halo extracted from the millennium simulation @xcite .",
    "the main cosmological parameters of this @xmath5cdm - simulation are : @xmath44 , @xmath45 , @xmath46 and @xmath47 ( @xmath48  km  s@xmath49  mpc@xmath49 ) .",
    "the simulation volume is a periodic box of size @xmath50 and individual particles have a mass @xmath51 . in our analysis",
    "we take the second largest fof halo at redshift @xmath52 , which has @xmath53 particles .",
    "this section is organised as follows . in section  [ sec :",
    "choice ] , we discuss the influence of the main parameters in our algorithm on the results . in section  [ sec : phasespace ] we use the merger tree history to follow both qualitatively and quantitatively the evolution of structures . in particular , the structures identified by hsf are cross - correlated with their counterpart prior to merging with the main halo . finally section  [ sec : bound ] studies the properties of the substructure population obtained with hsf and its bimodality in terms of bound structures versus unbound tidal tails and tidal streams .      in the following ,",
    "we check the influence of the different parameters on the structures found by our hsf algorithm .",
    "a basic parameter setup is given by @xmath15 , @xmath16 , @xmath54 , @xmath55 , @xmath56 .",
    "we adopt the notation @xmath57 to label each set of parameters . when the dimension is set to 3d , we mean the three dimensional position space , whereas 6d means six dimensional phase - space .",
    "unless mentioned otherwise , we use the hsf algorithm without additional unbinding step .",
    "subfind is in fact one of the versions of our algorithm , characterised by the following parameter setup ( @xmath58 , 3d , b ) . in our analysis",
    ", we shall call all the particles in a fof group _ a halo _ , the largest structure of the fof group _ a main halo _ , and all other structures _ substructures_.    figures  [ cutbeta ] and [ cut ] present the number of substructures per logarithmic mass bin scaled to the main halo mass . while testing the different parameter setups , we find that @xmath11 and @xmath28 are the most influential . figure  [ cutbeta ] shows that parameter @xmath28 is important for the smallest structures : visual inspection suggests that a higher @xmath28 helps to preserve small scale connectivity , e.g. between tidal tails and the bound component of the substructures .",
    "the connectivity parameter @xmath11 has a similar effect , but on the whole mass range instead of small structures only , as illustrated by figure  [ cut ] .",
    "because of the partial degeneracy between @xmath11 and @xmath28 , we prefer to use @xmath54 in most of our analyses .",
    "the choice of @xmath11 indeed influences connectivity as follows : when @xmath55 , the main halo always wins the cut or grow criterion and all structures are cut by it ; when @xmath59 , the largest substructures can grow inside the main halo ; when @xmath60 , all small substructures grow more aggressively and the halo is divided into more small parts . in brief , focusing on bound structures calls for a value of @xmath11 of the order of @xmath7 , while if one is interested in all substructures including tidal streams , it is better to set @xmath61 . in the later case ,",
    "tuning up @xmath28 can help to control the small scale connectivity .",
    "-axis , taking into account only bins containing 2 points or more .",
    "the two additional green curves on each side show @xmath62 errors estimated from the variance of points in each bin.,width=321,height=321 ]    using our base parameter setup , we now compare hsf bound structures with those given by subfind .",
    "the hsf algorithm works in six dimensional phase - space , where the distribution of particles shows much more contrast than in position space alone .",
    "because of that , hsf can better trace contours of individual substructures and attach more particles to them . even after the unbinding step , hsf therefore attaches more particles to the substructures than subfind .",
    "this is illustrated by figure  [ comp ] , where the ratio between the mass of hsf bound structures and the mass of their subfind counterparts is plotted : hsf attaches on average @xmath63 more mass to small structures than subfind and up to twice more to the largest ones .",
    "the left panels of figure  [ subfind_mass ] compare bound structures found by both methods in position space .",
    "the area of each circle is proportional to the structure mass .    with the parameters",
    "set up chosen here , hsf finds around @xmath64 more structures , mostly small ones , in the outskirts of the main halo and clearly attaches more mass than subfind to most of them .",
    "nevertheless , the spatial distributions of hsf and subfind substructures are nearly the same , as expected . to complete this visual inspection",
    ", the right panels of figure  [ subfind_mass ] compare the 200 largest bound structures found by both methods .",
    "most of the hsf structures are matched by subfind , except that they are more extended .",
    "as mentioned before , many of these structures have @xmath65 times more mass in hsf than in subfind .",
    "interestingly , this confirms the mass excess found around subfind substructures in a comparison of simulation with gravitational lensing observations by @xcite .",
    "if bound substructures are counted as a function of maximum circular velocity instead of mass , a much closer agreement is found , however .",
    "this is seen in figure  [ velmax ] , where the cumulative velocity functions of bound substructures for hsf and subfind are compared .",
    "hsf tends to find a few more small substructures , but both algorithms essentially identify the same set of more massive structures , confirming the results above .      in the following sections we describe a method to follow back in time the structures detected by our hsf , paying particular attention to the definition of what we use for initial halo",
    ". then we study in detail a set of specific but representative cases .",
    "the goal of this analysis is to physically understand the nature of the structures found by our algorithm , before and after unbinding . in particular , we aim to separate clearly tidal streams from compact bounded subhaloes . with the additional time information , we can also associate tidal streams to objects in the stage they were prior to merging with the main halo",
    ". we can also study quantitatively how in general phase - space structures evolve in time .      to study in detail the nature of phase - space structures found by the hsf algorithm we use the merger tree history to follow their evolution backwards in time .",
    "then we count how many particles are shared between each structure prior to merging with the main halo and its counterpart detected by hsf at @xmath52 .",
    "this process uses pieces of information which are already available for the processed millennium simulation @xcite and it is divided into three steps : ( i ) crosscorrelating the hsf structure catalogue with the subfind one , ( ii ) following the evolution of subfind structures using the already implemented merger tree history and ( iii ) using each particle s universal index to follow structures at different output times .",
    "we now explain each of these steps in turn .",
    "1 .   cross - correlation between hsf and subfind : information about structures in the millennium simulation is organised in terms of two levels : first , particles are attached to different fof groups ( found with @xmath12 ) . then , in each fof group , they are separated into the main halo , the substructures found by subfind , and unbound ` fuzzy ' particles if present . running the hsf algorithm with the base parameter setup @xmath66 6d",
    "ub / b@xmath67 provides a phase - space structure list .",
    "then , for each member of that list , the subfind substructure sharing the largest possible number of particles with it is identified .",
    "if the hsf structure shares less than @xmath68 particles with any subfind substructure , it is put into an unmatched list . in the opposite case , we call this subfind substructure a _ seed _ of the hsf structure",
    ". 2 .   following subfind structures back in time : information about the time evolution of structures is stored in the millennium simulation in a merger tree ( more details in * ? ? ? * ) .",
    "we use the tree information which gives for each halo or substructure its most massive progenitor , if there is any .",
    "once the list of seed subfind substructures is obtained , each of them is traced back in time by following its most massive progenitor recursively up to the moment when this past structure was the main halo of a fof group .",
    "this is the last occurrence of the structure as being distinguishable as an isolated halo .",
    "we store the redshift of this event and all particles belonging to the main halo found in this way are denoted as the _ initial halo_. there is a small number of substructures which do not have a proper progenitor , they are dropped from the analysis .",
    "3 .   using each particle s universal index to follow structures at different times : in the last part of the procedure , we link together the information gathered in the previous two steps . for each hsf structure",
    "identified at the present time , we find its initial halo and , with the help of universal indices , we identify _ shared _ particles , i.e.  particles belonging both to the initial and final structures .",
    "we carry out exactly the same analysis for hsf bound structures and for subfind itself .",
    "in addition , during this process , we gather for each substructure information about the position of its centre and its velocity at various times ( we use the subfind definition for the structure centre ) , and similarly for the position and velocity of the centre of the main halo . with these pieces of information at hand , we can define an orbital count by determining the number of times a substructure s radial velocity with respect to the centre of the halo changes sign , which each time signals completion of what we call an orbit .",
    "this definition requires that there are enough snapshots to catch orbit details .",
    "this is the case for most substructures , probably all , although this statement is not easy to check rigorously .          in our analysis of the time evolution of the structures ,",
    "we adopt the main haloes of the fof groups found by subfind as ` initial haloes ' .",
    "another possibility is to chose for each initial halo all the particles belonging to the fof group . in the first case ,",
    "the analysis is simplified by the fact that we look only for the evolution of one isolated component .",
    "however this component represents only one part of the halo . in the second case",
    ", a fof group can sometimes have a few main halo candidates joined by small artificial bridges ( up to @xmath3 of fof groups show such a feature , e.g. * ? ? ?",
    "* ) but can in fact be tidally disrupted such that its components get away from each other .    to demonstrate the effects described above , we choose one particular structure in our test halo .",
    "the top panel of figure  [ fof ] shows all the particles belonging to the initial halo traced to redshift @xmath52 , while the second row of panels corresponds to the full traced initial fof group .",
    "this structure goes around the main halo one time ( its orbit is shown in the third row of panels of figure  [ halo_profile ] ) .",
    "the initial fof group is tidally disrupted during this process and its various components are clearly separated from each other .",
    "subfind recognises the central part of the bound object ( bottom panels of figure  [ fof ] ) .",
    "the hsf bound structure contains more particles ( fourth row of panels in figure  [ fof ] ) .",
    "these particles belong to tidal tails , but are in fact still gravitationally linked to the structure .",
    "the hsf structure ( prior to unbinding ) contains @xmath69 of the particles of the initial halo , and reproduces perfectly its shape ( on third row of figure  [ fof ] ) .",
    "to better understand all the processes at play during structure evolution , we study in greater detail eight different cases displayed in figure  [ halo_profile ] .",
    "the colours in the figure are coded as follows :    * green and red particles belong to one structure found by the hsf algorithm ( without unbinding ) : green particles belong to the initial halo , while the red particles do not belong to it .",
    "* black particles belong to the subfind seed of the hsf structure . *",
    "blue particles belong to the initial halo , but do not belong to the hsf structure .",
    "* yellow particles belong to the initial halo and belong to any hsf structure , besides the one we take for the current analysis .",
    "we mark particles in yellow only for structures in the last three rows of panels of figure  [ halo_profile ] .",
    "the particles are plotted in the following order : blue , red , green , black , and finally yellow .",
    "various structures parameters are listed in table  [ strpr ] , for each of the 8 cases considered here .",
    "the pink curve shows the orbit of the object inside the main halo .",
    "we now discuss in detail each of these 8 cases .",
    "[ cols=\"^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     [ gaussfit ]    as a final note on the upper - left panel of figure  [ peak_dist ] , we found that the shape of the distribution function of values @xmath70 observed for each component has interesting properties : it is very well fit by a lognormal distribution both for the main halo component found by subfind and hsf , and the unbound substructures found by hsf .",
    "this complements the findings of @xcite , who performed a similar analysis but used a more _ add - hoc _ approach to separate various components contributing to the phase - space distribution function .",
    "the best fitting parameters of a gaussian on the logarithm of @xmath70 are given in table  [ gaussfit ] .",
    "the interpretation of these results did not seam straightforward to us , so we decided to leave it for future work .",
    "certainly , a path to follow is to examine the arguments developed by @xcite to explain the close to lognormal behaviour of the projected 3d density , @xmath71 , relying on the continuity equation and the positivity of the density .    in practice , in observations of ,",
    "e.g. , x - rays clusters or gravitational lensing , the 3d density @xmath71 ( or its projection on the sky ) is usually used to model dark matter haloes instead of the phase - space density @xmath70 . to illustrate how the previous results translate in terms of @xmath71 , figure  [ peak_dist1 ] is similar to figure  [ peak_dist ] , but",
    "the calculations are performed for the normalised density @xmath72 instead of @xmath70 .",
    "the 3d density is measured using enbid s sph kernel with @xmath73 neighbours .",
    "contrary to figure  [ peak_dist ] , the distribution function of values of @xmath74 ( upper right panel ) shows only one peak .",
    "the difference between bound and unbound structures shows much less contrast ( see table  [ strmass ] for numerical estimates of typical values of @xmath74 , @xmath75 and @xmath76 ) . in particular ,",
    "bound structures present a large spread on their 3d local density maxima of about @xmath77 orders of magnitudes , in contrast with what happens with @xmath78 , and they are more difficult to disentangle from their unbound counterpart , even with the peakness , @xmath79 , although this latter quantity seems to have a better separating power than @xmath74 ( lower left panel ) .",
    "interestingly , the particle density distribution diagram ( top - left panel of figure  [ peak_dist1 ] ) is populated in a different way from what happens in phase - space .",
    "in particular , tidal streams occupy the low density region although they still spread over a large dynamic range , while the main halo dominates the high density regime .",
    "bound substructures are rather subdominant and spread over the whole dynamic range .            to complete this section , figure  [ halo_subs ] and figure  [ halo_subs2 ]",
    "show the appearance of bound structures , unbound ones , and of the smooth part of the halo after removal of all hsf structures .",
    "there is a subtle but significant difference between the two figures . in figure",
    "[ halo_subs ] , the top panels show only the bound part of the bound substructures , while the top panels of figure  [ halo_subs2 ] show the bound structures along with their tidal tails . in the middle panels of figure  [ halo_subs ] ,",
    "particles both belonging to unbound structures and particles removed from the bound structures during the unbinding process are shown .",
    "in contrast , the bottom panels of figure  [ halo_subs2 ] show only particles belonging to unbound structures .",
    "this results in an asymmetry in middle right panel of figure  [ halo_subs ] , which reflects the fact that structures passed through ( or nearby ) the centre of the halo one more time in the upper part of the phase - space diagram than in the lower part .",
    "tidal disruption is indeed more significant and thus removes particles with higher value of @xmath70 in the upper part of the phase - space diagram than in the lower part .",
    "not surprisingly , the asymmetry disappears in the bottom right panel of figure  [ halo_subs2 ] .",
    "note that bound structures are absent in the region close to the main halo centre , as expected .",
    "note as well the rather elongated tidal streams , in particular close to the halo centre , in the bottom right panel of figure  [ halo_subs2 ] and the middle right panel of figure  [ halo_subs ] .",
    "these are the left overs of structures disrupted by strong tidal forces . in the bottom right panel of figure",
    "[ halo_subs ] , the main halo still presents , after cleaning , some filamentary structures , which are parts of tidal tails , or less likely , signatures of caustics .",
    "it can be cleaned even more by using a smaller value of the connectivity parameter @xmath11 .",
    "we introduced a new universal multi - dimensional hierarchical structure finder ( hsf ) which was employed here to study dark matter structures in six dimensional phase - space .",
    "the algorithm used , for each particle , the phase - space density and local neighbourhood estimated with the sph method with adaptive metric implemented in the enbid package @xcite . to detect structures , hsf builds on the subfind and adaptahop algorithms , with the introduction of a new simple but robust cut or grow criterion depending on a single connectivity parameter @xmath11 .",
    "the main steps of the algorithm are as follows : ( i ) local phase - space density maxima are detected and structures around them are grown by following local gradients up to saddle points ; ( ii ) at each saddle point level , the density @xmath70 of each structure is compared to poisson noise : the structure is kept if @xmath70 is @xmath28 times more significant than the poisson r.m.s . noise level . at the same time",
    "its mass and the mass of its partner ( connected to it through the saddle point ) are measured and the cut or grow criterion is applied : if one structure is @xmath11 times smaller than its neighbour , then all particles below the saddle point are attached to the neighbour",
    ". when the two structures have comparable mass within a factor @xmath11 , they are both set to grow down as before .",
    "this criterion allows us to better trace substructures in phase - space , with a good control of the effect of poisson noise , which is very important in this rather sparsely sampled space .",
    "we demonstrated the potential of hsf on a large fof dark matter halo taken from the millennium simulation .",
    "our tests show that @xmath28 and especially @xmath11 are important control parameters . to better study the smallest possible structures ,",
    "@xmath28 should be set close to @xmath30 .",
    "the smaller @xmath11 , the more subtle the structures found by the algorithm . in our analysis , we give preference to @xmath55 , which provides a good balance between finding the finest possible substructures and not overgrowing them .",
    "this value of @xmath11 is particularly appropriate when an additional binding step is performed .",
    "in contrast , an analysis of tidal tails is best carried out with small @xmath11 , around @xmath80 , which separates structures into smaller pieces .",
    "it is possible to use it in combination with @xmath81 , which tends to reconnect the structures together in a consistent way , to reconstruct tidal tails rather well .",
    "a more advanced method of reconnecting phase - space structures , by using the topology of the hierarchical tree created by the hsf algorithm is under investigation .",
    "we used the millennium simulation merger tree @xcite to compare the hsf phase - space structures found at the present time with the same structures traced back to the time just before they enter the main halo .",
    "while the best three dimensional algorithms used presently , such as subfind , manage to find only the main part of bound structures , hsf is capable of finding more extended bound components along with their tidal tails .",
    "there is much more information about structure evolution still stored in phase - space than in 3d and this information can be potentially fully recovered from the data by a six dimensional algorithm such as hsf .",
    "the main results of our analysis in time and space domain are the following :    * hsf structures contain on average @xmath82 of the mass inside the initial structures up to a redshift of merging @xmath83 .",
    "this value drops down to @xmath84 for @xmath85 . on the other hand ,",
    "bound hsf structures contain on average @xmath82 of the mass inside the initial halos only up to @xmath86 and @xmath84 up to @xmath87 .",
    "this shift in the mass loss is caused by the existence of tidal tails , which are joined to hsf structures , but do not belong to their bound part .",
    "in other words we can say that hsf is able to reconstruct in most cases the full dynamical structures which enter the halo at redshifts as high as @xmath83 . *",
    "the distribution function of the phase - space density maxima @xmath88 of hsf structures clearly shows a bimodality .",
    "we can explain it by partitioning the structures into two distinct groups .",
    "in the first group , corresponding to the high phase - space density peak regime , @xmath89 , with a small spread around that value , there are mostly bound structures . in the second group ,",
    "corresponding to a @xmath90 orders of magnitude smaller phase - space density regime , @xmath91 , and a larger spread around this value , there are all unbound structures i.e.  tidal tails , streams and possibly some caustics . in terms of `` peakness '' , @xmath92 , where @xmath93 is minimum value of @xmath70 in each substructure , this translates into @xmath94 for bound and unbound structures , respectively .",
    "* we noticed , similarly as @xcite , that the distribution function of the values of @xmath70 around each dark matter particle is close to lognormal for the smooth component of the halo and the unbound part of the substructures ( tidal streams ) .",
    "* we found that there is more mass in bound hsf substructures than in subfind ones .",
    "figure  [ mass_profile ] shows the cumulative mass of substructures divided by the total halo mass as a function of substructure mass . around @xmath95 of halo mass",
    "is stored in bound hsf structures , and this quantity almost does not depend on @xmath11 . in comparison , about @xmath96 of the mass is stored in subfind bound structures .",
    "the additional mass in hsf bound structures comes mainly from the fact that subhaloes are better defined in phase - space and are more extended . however , the set of identified bound substructures is nearly identical in both methods , and hence the cumulative abundance of substructures as a function of maximum circular velocity is the same as well .",
    "+ .,width=321,height=321 ] + we note that in our test halo , @xmath97 of the mass belongs to substructures for @xmath55 , @xmath98 for @xmath60 , and @xmath99 for @xmath100 .",
    "when we substract from these numbers the contribution of bound structures , we find that @xmath101 of halo mass is stored in unbound structures .",
    "this should be taken into account when analytical models of halos with substructures are proposed . * while we would need a larger statistical sample of halos to perform robust measurements , we noticed that at fixed redshift of merging with the main halo , small structures tend to lose less mass than larger ones , in agreement with expectations based on the higher concentration of smaller halos . also , we found a strong correlation between mass loss and the number of orbits a substructure can make inside the main halo .",
    "when we observe our own galaxy , we do not have access to different `` snapshots '' anymore , in stark difference with the world of simulations .",
    "instead , we have to be content with the data at the present time .",
    "however , because we now know that our phase - space structure finder can identify dynamical structures that were bound before tidal disruption , it can provide totally new insights about the past dynamical history of our galaxy . within the hierarchical framework",
    ", we expect that our galaxy should be made through the merging of more than about 100 smaller subcomponents .",
    "comparing structures in observational data and simulations can be one of the best tests for the theory of hierarchical galaxy formation , and provide important constraints on cosmological models such as @xmath5cdm .",
    "up to now , we studied only the evolution of dark matter , but we can also similarly study the evolution of baryons in gas and stars .",
    "galaxies are observed in many different ways , ranging from star distributions , velocity and chemical properties , to hi measurements , etc .",
    "our phase - space structure finder with local metric fitting is in fact implemented in such a way that it can be used in any number of dimensions , where each dimension can have completely different physical units .",
    "so it is in principle straightforward to use it for studying galaxy structure evolution in multi - dimensional space with the appropriate probabilistic weightings to take into account the noise and holes ( missing measurements ) in the data hypercube .",
    "we think that such an approach can yield a deeper understanding of galaxy evolution , and looks especially promising in light of the upcoming gaia mission @xcite which plans to map the positions of around one billion stars in our galaxy .",
    "we thank s.d.m .",
    "white for many important suggestions and g. lavaux , r. mohayaee and d. weinberg for useful discussions .",
    "part of this work was completed during a visit of m.m . and s.c .",
    "at mpa / garching .",
    "this work was completed within the framework of the horizon project ( www.projet-horizon.fr ) .",
    "m. maciejewski was funded by the european program mest - ct-2004 - 504604 and supported by french anr ( otarie ) .",
    "50 angulo r. e. , lacey c. g. , baugh c. m. , frenk c. s. , 2008 , arxiv:0810.2177 alard c. , colombi , s. , 2005 , mnras , 359 , 123 aubert d. , pichon c. , colombi s. , 2004 , mnras , 352 , 376a bertschinger e. , 1985 , apjs , 58 , 39 binney j. , 2004 , mnras , 350 , 939b cole s. , lacey c. , 1996 , mnras , 281 , 716 coles p. , jones b. , 1991 , mnras , 248 , 1 colombi s. , touma j. , 2007 , cnsns , 03 , 012 davis m. , efstathiou g. , frenk c. s. , white s. d. m. , 1985 , apj , 292 , 371 diemand j. , kuhlen m. , madau p. , 2006 ,",
    "apj , 649 , 1 eisenstein d. j. , hut p. , 1998",
    ", apj , 498 , 137 gelb j. , bertschinger e. , 1994 , apj , 436 , 467 gilmore g. f. , perryman m. a. , lindegren l. , favata f. , hoeg e. , et al . , 1998 ,",
    "spie , 3350 , 541 g governato f. , moore b. , cen r. , stadel j. , lake g. , quinn t. , 1997 , newa , 2 , 91 hinshaw g. , weiland j. l. , hill r. s. , odegard n. , larson d. , bennett c. l. et al . , 2008 , arxiv:0803.0732 kim j. & park , c. , 2006 , apj , 639 , 600 klypin a. , gottlober s. , kravtsov a. v. , khokhlov , a. m. , 1999 , apj , 516 , 530 lacey c. , cole s. , 1994 , mnras , 271 , 676 luki z. , reed d. , habib s. , heitmann k. , 2008 , arxiv:0803.3624 maciejewski m. , colombi s. , alard c. , bouchet f. , pichon c. , 2008 , mnras , in press ( arxiv:0810.0504 ) massey r. , rhodes j. , ellis r. , scoville n. , leauthaud a. et al . , 2007 , nature , 445 , 286 m mohayaee r. , salati p. , 2008",
    ", arxiv:0801.3271 natarajan p. , de lucia g. , springel v. , 2007 , mnras , 376 , 180 navarro j. f. , frenk c. s. , white s. d. m. , 1997 , apj , 490 , 493 neyrinck m. c. , gnedin n. y. , hamilton a. j. s. , 2005 , mnras , 356 , 1222 rubin v. c. , ford . w. k. j. , 1970 , apj , 159 , 379 sharma , s. , steinmetz , m. , 2006 , mnras 373 , 1293 springel v. , white s. d. m. , tormen g. , kauffmann g. , 2001 , mnras , 328 , 726 springel v. , white s. d. m. , jenkins a. , frenk , c. s. , et al .",
    ", 2005a , nature , 435 , 629 springel v. , white s. d. m. , jenkins a. , frenk , c. s. , et al . , 2005b , nature , 435 , 629 , supplementary information ( astro - ph/0504097v2 ) springel v. , 2005 , mnras , 364 , 1105 springel v. , white s. d. m. , frenk c. s. , navarro j. f. , jenkins , a. , et al . , 2008 , arxiv:0809.0894 stadel j. , potter d. , moore b. diemand , j. , madau p. et al",
    "astro - ph/0808.2981v2 van waerbeke , l. , mellier y. , erben t. , cuillandre j. c. , bernardeau f. et al . , 2000 ,",
    "a&a , 358 , 30 vass h.m . , valluri m. , kravtsov a.v .",
    ", kazantzidis s. , 2008 , submitted to mnras ( arxiv:0810.0277 ) vogelsberger m. , white s.d.m .",
    ", helmi a. , springel v. , 2008 , mnras , 385 , 236 white s. d. m. , rees m. j. , 1978 , mnras , 183 , 341 white s.d.m . , vogelsberger m. , 2008 , arxiv:0809.0497 zwicky f. , 1933 , helvetica physica acta , 6 , 110"
  ],
  "abstract_text": [
    "<S> a new multi - dimensional hierarchical structure finder ( hsf ) to study the phase - space structure of dark matter in @xmath0-body cosmological simulations is presented . </S>",
    "<S> the algorithm depends mainly on two parameters , which control the level of connectivity of the detected structures and their significance compared to poisson noise . by working in 6d phase - space , where contrasts are much more pronounced than in 3d position space , </S>",
    "<S> our hsf algorithm is capable of detecting subhaloes including their tidal tails , and can recognise other phase - space structures such as pure streams and candidate caustics .    </S>",
    "<S> if an additional unbinding criterion is added , the algorithm can be used as a self - consistent halo and subhalo finder . as a test </S>",
    "<S> , we apply it to a large halo of the millennium simulation , where @xmath1 of the halo mass are found to belong to bound substructures , which is more than what is detected with conventional 3d substructure finders , and an additional @xmath2 of the total mass belongs to unbound hsf structures . </S>",
    "<S> the distribution of identified phase - space density peaks is clearly bimodal : high peaks are dominated by the bound structures and show a small spread in their height distribution ; low peaks belong mostly to tidal streams , as expected . </S>",
    "<S> however , the projected ( 3d ) density distribution of the structures shows that some of the streams can have comparable density to the bound structures in position space .    in order to better understand what hsf provides , </S>",
    "<S> we examine the time evolution of structures , based on the merger tree history . given the resolution limit of the millennium simulation , bound structures typically make only up to 6 orbits inside the main halo . </S>",
    "<S> the number of orbits scales approximately linearly with the redshift corresponding to the moment of merging of the structures with the halo . at fixed redshift , </S>",
    "<S> the larger the initial mass of the structure which enters the main halo , the faster it loses mass . </S>",
    "<S> the difference in the mass loss rate between the largest structures and the smallest ones can reach up to @xmath3 . </S>",
    "<S> still , hsf can identify at the present time at least 80% of the original content of structures with a redshift of infall as high as @xmath4 , which illustrates the significant power of this tool to perform dynamical analyses in phase - space .    </S>",
    "<S> methods : data analysis , methods : numerical , galaxies : haloes , galaxies : structure , cosmology : dark matter </S>"
  ]
}