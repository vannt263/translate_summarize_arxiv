{
  "article_text": [
    "astrophysical hydrodynamics is characterized by a large range in density , temperature and length scales , where strong shocks often play an important role .",
    "this poses a great challenge to attempts at simulating such processes numerically .",
    "traditionally , simulations have either been carried out on a static mesh ( cen _ et al _ 1990 , cen 1992 ) , or using monte - carlo techniques by following particle trajectories in smooth particle hydrodynamic ( sph ) models ( evrard 1988 , hernquist and katz 1989 , navarro and white 1993 , monaghan 1995 ) .",
    "there are two main difficulties in simulating astrophysical fluids numerically .",
    "the first is the fact that often the flows occur at very high mach number , leading to frequent development of strong shock discontinuities .",
    "the second difficulty is the large range in length scales involved when gravitational clustering occurs .",
    "the mesh schemes can often address the first problem very well through the use of the total variation diminishing ( tvd ) paradigm , while the particle methods have been primarily developed to address the second problem . in this paper",
    "we will describe a code which attempts to address both problems .",
    "the advantages of mesh - based tvd approaches ( yee 1989 ) include the implementation of modern hydrodynamic concepts based on the characteristic field decomposition .",
    "the general family includes the piecewise parabolic mesh ( ppm ) ( collella and woodward 1984 ) and harten schemes ( harten 1983 ) which have been successfully applied to cosmological hydrodynamics ( ryu _ et al _ 1993 , bryan _",
    "et al _ 1994 ) .",
    "these provide for high resolution capturing of shock fronts in 12 cells and high order accuracy away from extrema .",
    "a finite difference scheme is difficult to implement across discontinuities , where the differential equation becomes ill - defined , and requires a mathematical treatment in terms of internal boundaries . in order to obtain a meaningful convergent result",
    ", the classical treatments added large amounts of artificial viscosity and diffusion , which prevents the formation of discontinuities on scales shorter than a cell size . at the same time , such a large viscosity severely degrades the resolution of the simulation .",
    "modern shock capturing approaches contain two ingredients .",
    "they express the fluid equations in integral flux conservative form .",
    "this is accomplished by dividing space into a set of control volumes , in the simplest case by a cartesian cubical lattice . on the boundary between volumes ,",
    "one calculates the flux which passes between cells . whatever flux is taken out of one cell",
    "is always added to its neighboring cell . using this approach ,",
    "one automatically satisfies the rankine - hugionot conditions , and is thus guaranteed the correct shock jump conditions and shock propagation speed .",
    "the second ingredient is a flux or slope limiter .",
    "this replaces the traditional artificial viscosity . by analyzing the characteristics of the hyperbolic pde , one obtains constraints on the flux functions , which causes them to remain well behaved in the presence of discontinuities",
    "this prevents instabilities and post shock oscillations .",
    "the characteristic decomposition allows a high resolution capturing of discontinuities , often in two or fewer cells .",
    "an alternate view point is to describe a flux limiter as a strongly nonlinear viscosity scheme , which adds just enough diffusion to prevent numerical instabilities .",
    "the simplest way to implement these flux conservative high resolution tvd schemes is in fixed regular eulerian coordinates which are uniform in space ( ryu et al 1993 ) .",
    "gravitational instability drives fluids to collapse to very dense configurations .",
    "the cores of clusters of galaxies are overdense by @xmath0 of the mean density of the universe .",
    "often one is interested in the physical processes occurring in these dense regions , for example the x - ray properties . in a fixed eulerian mesh",
    "a large fraction of the mass ends up in a small fraction of the grid cells , leading to a degradation in resolution .",
    "the advantage of such eulerian approaches include simplicity of implementation , high computational speed per grid cell , straightforward data parallel implementation on distributed memory computers , and high resolution of shocks .",
    "simulations are usually limited by the amount of available memory .",
    "in many problems of astrophysical interest , the physical processes occur on constant mass scales , which argues in favor of constant mass resolution algorithms .",
    "the simplest way of building a constant mass resolution scheme is by utilizing a lagrangian coordinate system , where the numerical control points are frozen into the fluid .",
    "an additional problem arises in such an approach .",
    "any rotation in the fluid tends to move cells which are initially close to each other to large separations , causing a rearrangement of nearest neighbor relationships .",
    "one popular approach , sph , addresses this problem by resampling the list of nearest neighbors at each time step .",
    "unfortunately , it is then no longer possible to maintain the integral flux - conservative control volume and characteristic tvd approach . in order to conserve mass ,",
    "sph further interprets each numerical grid point to be a fuzzy particle of constant mass .",
    "the density is then defined as a statistical quantity which is estimated by calculating the distance to the nearest 30100 neighbors .",
    "artificial viscosity is used to prevent the formation of discontinuities . in each case",
    ", there is a trade off between accuracy and resolution . by smoothing over more neighbors , one obtains a more accurate estimate of the density field , which is limited by the @xmath1 poisson noise , while also reducing resolution due to the same smoothing .",
    "a similar effect holds for viscosity .",
    "an additional problem arises when the list of nearest neighbors is determined using a spherical search algorithm .",
    "the nearest neighbor distribution could be highly anisotropic , which further degrades the resolution .",
    "this issue has been addressed by martel and shapiro in asph ( shapiro et al 1995 ) .",
    "we conclude that sph is a monte - carlo approach , which is constrained by poisson noise , viscosity , anisotropy , and the cost of searching for nearest neighbors .",
    "its primary advantages include mass based resolution which allows a high range in spatial resolution , and ease of implementation in a very large range of problems , including problems with vacuum regions and complicated equations of state .",
    "its cost is high computational effort and low resolution per particle .",
    "such simulations are usually cpu time limited on current computers",
    ".    an alternate lagrangian mesh approach has been developed by gnedin ( 1995 ) .",
    "it forces the nearest neighbors to remain fixed in time .",
    "if the grid becomes excessively distorted , it reverts to an eulerian scheme in the fixed coordinate system .    significant work on combining the advantages of these approaches has been implemented by several authors .",
    "berger and collela ( 1989 ) developed a technique for local mesh refinement on regular meshes .",
    "lohner ( 1985 ) and xu ( 1996 ) developed an unstructured grid , which dynamically adds and removes nodes as necessary .",
    "r. fiedler and mouschovias ( 1992 hereafter fm ; 1993 ) developed a moving mesh approach for cylindrically symmetric magnetohydrodynamics ( mhd ) .",
    "b. fiedler and trapp ( 1992 hereafter ft , see also trapp and fiedler 1995 ) applied a general curvilinear transform to model two - dimensional tornado dynamics .",
    "a review of many methods classified as node - movement - techniques is given by thompson _",
    "et al _  ( 1985 ) and hawken ( 1991 ) .",
    "the purpose of this paper is to present a method called moving mesh hydro or mmh for short , with primary emphasis on speed and simplicity for application to cosmological hydrodynamics .",
    "it presents a general framework which can be extended and improved in the future .",
    "the essential concept is to formulate a high resolution flux conservative scheme on a general moving curvilinear coordinate system in the spirit of fm and ft . as in their work",
    ", we attempt to follow only the divergence of the fluid flow but not its vorticity .",
    "such a grid would resist any twisting or shearing , and still maintain a constant mass per grid cell . to describe this mathematically , we recall that a general coordinate transformation has three degrees of freedom . by requiring approximately constant mass per control cell ,",
    "we have imposed one constraint .",
    "the remaining two degrees of freedom will be used to prevent the appearance of vorticity in the grid motion .",
    "caustics and discontinuities are treated by applying compression limiters and by smoothing the deformation transformation .",
    "this guarantees the stability and regularity of the grid , and allows us to use the same neighbors , volumes , and flux boundaries throughout the simulation .",
    "the features thus include exact conservation form and resolution proportional to density , which aims to combine the advantages of both eulerian and lagrangian techniques .",
    "( the cosmological energy equation is not exact , but can be split into an exact hyrodynamic form with graviational source term ) .",
    "it features a low computational cost and high resolution per grid cell .",
    "the current implementation is also quite memory efficient and parallelizable , which allows it to make efficient use of present technology .    in the past ,",
    "similar approaches became dominated by the cost of computing the optimal grid configuration , which is a nonlinear global optimization problem , and is often much more complex than the solution of the hydrodynamic equations .",
    "this paper presents the notion that the astrophysically interesting constraint of maintaining constant mass per cell can be achieved from an evolutionary point of view by solving only linear elliptic equations at each time step .",
    "the fast multigrid solvers accomplish this in linear time , with effective speeds which are competitive with fast fourier transforms .",
    "the cost over a fixed eulerian grid are thus the overhead for implementing the curvilinear form of the equations as well as requiring two applications of the poisson solver .",
    "while the mmh algorithm is quite general and could be applied to any three dimensional simulations ( pen 1995 ) , we will examine the case of systems of conservation laws , and in particular the newtonian euler equation in detail .",
    "we will consider only the case of cosmological interest , where resolution will attempt to remain constant in mass .",
    "consider a numerical grid of coordinates @xmath2 . in order to determine the physical position of each lattice point , one needs to specify the cartesian coordinate @xmath3 of each curvilinear coordinate .",
    "we will borrow most of the notation from general relativity , which provides a concise framework to describe general curvilinear coordinate transformations .",
    "we will only consider with three spatial dimensions where the metric is positive definite , and the underlying space is always euclidean , i.e. the riemann tensor vanishes everywhere .",
    "thus covariant derivatives always commute , and all the nice properties of flat space hold .",
    "the flat metric @xmath4 is just the kronecker delta function .",
    "the curvilinear metric is then @xmath5 repeated indices obey the summation convention , which means that they are dummy indices and should be summed from 13 .",
    "latin indices denote cartesian coordinate labels @xmath6 , while greek indices imply curvilinear coordinates @xmath7 .",
    "a dot will imply partial differentiation for time .",
    "a comma will denote a partial derivative .    in cartesian conservation form ,",
    "the euler equations for fluid dynamics are @xmath8   & = & 0 , \\nonumber\\\\ \\frac{\\partial e}{\\partial t } + \\frac{\\partial}{\\partial x^i}\\left [ ( e+\\rho v+p ) v^i + \\frac{1}{8\\pi g}(v \\frac{\\partial \\dot{v}}{\\partial x^i } - \\dot{v } \\frac{\\partial { v}}{\\partial x^i } ) \\right ] & = & 0 , \\label{eqn : euler}\\end{aligned}\\ ] ] where the energy density @xmath9 is the sum of kinetic , thermal and gravitational energies , @xmath10 , and we have assumed an ideal gas equation of state .",
    "@xmath11 is the newtonian gravitational potential determined by poisson s equation @xmath12 , @xmath13 is the matter density , and @xmath14 is the pressure .    in terms of a flux vector @xmath15 ,",
    "we can write ( [ eqn : euler ] ) as @xmath16=0 , \\label{eqn : vec}\\ ] ] where @xmath17 is a five component column vector , and @xmath18 is a @xmath19 matrix function whose components can be read from ( [ eqn : euler ] ) .",
    "we use the abbreviation @xmath20 .",
    "a general time dependent curvilinear coordinate transformation then maps ( [ eqn : vec ] ) into a new flux conservative system of equations @xmath21= 0 , \\label{eqn : moving}\\ ] ] where @xmath22 is the inverse triad ( _ dreibein _ ) .",
    "the detailed derivation is shown in appendix [ app : curvi ] .",
    "it is given as the inverse of the triad @xmath23 .",
    "the volume element @xmath24 is the determinant of the triad .",
    "note that the partial derivative for time in equation ( [ eqn : vec ] ) is performed by holding the cartesian coordinates constant , while the partial derivative for time in equation ( [ eqn : moving ] ) is obtained by keeping the curvilinear coordinates constant .",
    "we now need to specify the differential coordinate transformation @xmath25 to close the system ( [ eqn : moving ] ) .    as in pen ( 1995 )",
    ", we define a coordinate transformation which is a pure gradient @xmath26 where @xmath27 for some _ deformation potential _",
    "@xmath28 to be defined later .",
    "the triad is now explicitly symmetric @xmath29 since partial derivatives commute . in a cosmological scenario ,",
    "the initial conditions are almost smooth , and we can set @xmath30 initially . during subsequent evolution , we will impose a constraint below to require a continuous sequence of non - degenerate triads .",
    "we are then assured that the triad is positive definite , from which it follows that @xmath31 ( no summation ) .",
    "we make several conclusions .",
    "the triad has real eigenvalues , which implies that the local coordinate transformation contains no rotation .",
    "it is a triaxial locally conformal stretching of the curvilinear space onto the cartesian space . from inequality ( [ eqn : pconstraint ] )",
    ", it follows that each cartesian coordinate increases monotonically as a function of its corresponding curvilinear coordinate .",
    "so @xmath32 is always monotonically increasing with @xmath33 . when projected down one axis , the curvilinear maps never overlap themselves , as we indeed observe in real simulations ( see figure [ fig : mesh128 ] ) .",
    "we thus have a mathematically rigorous formulation , where in the continuum limit any triaxial object in the curvilinear coordinate system aligned with the principal axes of the triad undergoes no rotation when mapped into cartesian space .",
    "this is a mathematical formulation of the statement that nearest neighbor relationships are invariant of the deformation potential @xmath28 .",
    "further properties of the curvilinear coordinate system are given in appendix [ app : curvi ] note that these results rely on the implementation of a compression limiter described below .",
    "the goal of astrophysical hydrodynamics has often been to maintain constant resolution in mass coordinates .",
    "the mass per unit curvilinear coordinate volume is given by @xmath34 , and its evolution by the first component of equation ( [ eqn : moving ] ) : @xmath35 = 0 \\label{eqn : ccons}\\ ] ] if we desire the mass per volume element to be constant in time , we set the first term in equation ( [ eqn : ccons ] ) to zero and obtain the linear elliptic evolution equation for the deformation potential as in pen ( 1995 ) @xmath36 we note that ( [ eqn : def ] ) is linear in the deformation potential @xmath37 , which resolves the dilemma that coordinate changes are an inherently costly and nonlinear process .",
    "the additional elliptic equation increases the cost of the simulation by about a factor of two , since we now have to solve two elliptic equations ( the other being for the gravitational potential ) instead of one .",
    "the evolution of the deformation potential does not need to be very accurate because the order of accuracy of the hydrodynamic calculation does not depend on the choice of background geometry .",
    "we solve for the gravitational potential using poisson s equation @xmath38 using the multigrid algorithm described in pen ( 1995 ) .",
    "@xmath39 is the mean comic density .    in a real simulation ,",
    "we need to discretize the continuum equations . in order to maintain the good properties , we require that the local grid is smooth , i.e. that the triad and therefore the deformation potential do not change too much between adjacent cells .",
    "this is achieved through smoothing and compression limiters .",
    "smoothing is implemented by first smoothing the right hand side of equation ( [ eqn : def ] ) and then smoothing the time derivative of the deformation potential before actually updating it .",
    "we solve equation ( [ eqn : def ] ) for a smoothed divergence field , and smooth before generating the deformation potential .",
    "furthermore , the current implementation of the code uses an external multigrid routine , which does not allow for a spatially variable mass function @xmath40 in the laplacian operator of the deformation equation ( [ eqn : def ] ) , so the current code simply drops that term .",
    "this would cause a further violation of the constant mass constraint for non - potential flow once the constraint is violated .",
    "empirically , though , this effect is insignificant , and is typically smaller than the contribution from the limiters . in equation ( [ eqn : limiter ] )",
    "the current implementation of @xmath41 does not contain @xmath40 , either .    to prevent excessive compression and the associated computational cost ,",
    "we add a compression limiter as described in pen ( 1995 ) . in some cases",
    "it is also desirable to introduce an expansion limiter to maintain a minimal length resolution independent of density . to incorporate these crucial requirements , we introduce an auxilliary variable @xmath42 from which @xmath28 will be derived as follows : @xmath43 we define the compression limiter @xmath44 and expansion limiter @xmath45 as @xmath46 where @xmath47 is the heaviside function and @xmath48 is the maximal compression factor and @xmath49 is the minimum eigenvalue of the triad @xmath50 .",
    "we choose a typical expansion volume limit @xmath51 .",
    "the smoothing operator @xmath52 is simplest to implement by smoothing over nearest neighbors in curvilinear coordinates .",
    "we see that the final deformation potential @xmath28 is always smooth on scales which are smoothed by @xmath52 .",
    "we found it empirically sufficient to use a single jacobi relaxation iteration in @xmath53 space for @xmath52 .",
    "equations ( [ eqn : limiter],[eqn : clim ] ) differ from previous implementations ( fm , tf ) by being locally defined .",
    "this completes our description of the analytical formulation .",
    "one of the simplest high resolution tvd schemes to implement is the relaxing tvd method ( xin and jin 1994 ) . for completeness",
    ", the full algorithm is described in appendix [ app : relaxing ] it has the advantage of requiring no non - linear characteristic field decomposition nor complex riemann solvers .",
    "furthermore , it is not dimensionally split , which is a desirable attribute in an algorithm such as ours where the grid can become strongly skewed .",
    "there is no need to explicitly evaluate the flux jacobian eigenvectors .",
    "we note that the flux limiter is applied to the hydrodynamic quantities , but not the gravitational terms which are elliptic source terms .",
    "we now have a complete framework to test the adaptive mesh hydrodynamics .",
    "first , we test the accuracy of the relaxing tvd scheme using the sod shocktube test .",
    "the test is performed as follows : we start with a horizontal tube of gas and a membrane dividing the gas into a chamber on the left and one on the right thereof .",
    "the initial state on the right is labeled using a subscript 1 , and is defined by some density and pressure @xmath54 , and is taken to be at rest with respect to the tube .",
    "the state on the left of the membrane is labeled using the subscript 4 , and is given as @xmath55 .",
    "the solution depends on the ratios of pressures and densities ( landau and lifshitz 1987 page 371 ) , and we consider the case where @xmath56 . at an initial time",
    "@xmath57 , the membrane is destroyed .",
    "this results in a shockwave propagating into the the right side , whose state we will describe using the subscript 2 , and a rarefaction fan penetrating the left side .",
    "the initial discontinuity propagates rightward , and we denote the region between the contact and the rarefaction fan with a subscript 3 .",
    "we define the shock speed to be @xmath58 .",
    "it follows that the velocity and pressure on both sides of the contact are equal and constant @xmath59 , and we solve for the post shock pressure @xmath60 using the assumption of self - similarity and the shock jump conditions @xmath61^{\\frac{2\\gamma}{\\gamma-1}}.\\ ] ] the sound speed @xmath62 .",
    "we can then solve for the remaining quantities @xmath63    we choose the following parameters as initial conditions @xmath64 which are identical to the ones chosen in shapiro et al ( 1995 ) to allow for easy comparison .",
    "figure [ fig : sodfm ] shows the result of the sod shocktube test using the relaxing scheme in a fixed grid .",
    "the plot has been rescaled such that the shock position occurs at @xmath65 . to quantify the resolution",
    ", we note that there are 98.38 cells between the initial contact surface at @xmath66 and the shock front .",
    "the relaxing scheme is indeed well behaved , and provides non - oscillatory shock jump conditions .",
    "we also see that the contact surface has been significantly diffused .",
    "this is inevitable whenever one attempts to advect a contact discontinuity for 70 cells across an eulerian grid .",
    "while some contact steepeners have been proposed in the literature ( harten 1983 ) , they can not restore information which has been inherently lost .",
    "they work well when all contacts are well resolved , but suffer from problems when either the time steps are short or if more dynamical processes occur .",
    "furthermore , since contact discontinuities are not evolutionary and arise only from singular initial data , we should consider it safe to ignore any diffusion across such a surface .",
    "the shock front itself is accurately resolved within two cells , which is comparable to most modern flux conservative hydrodynamic shock capturing schemes . while the classical diffusion schemes trade off shock width against post shock oscillations and stability , the tvd schemes have no free parameters for artificial viscosity .",
    "we also see the correct complete absence of oscillations about the contact discontinuity .",
    "we now examine the moving in mesh one dimension .",
    "figure [ fig : sodmm ] shows the same shock tube problem given by formula ( [ eqn : sodic ] ) run using the full three dimensional moving mesh code with slab symmetry .",
    "the mesh is chosen with approximately constant mass per grid cell , and in this run we have approximately 83 grid cells between the initial membrane @xmath67 and the shock front @xmath68 .",
    "the solution is still well behaved , and the shock front is also resolved in two cells .",
    "we see a little overshoot just after the shock front .",
    "tvd is applied to the curvilinear characteristic fields , and the solution has no overshoot when plotted in curvilinear coordinates . in the cartesian frame",
    "is can appear as if overshoots did form .",
    "this could be circumvented by transforming to a cartesian frame before applying the limiters .",
    "but the motivation behind mmh was the success of sph in tracking physics on constant mass scales , we argue that applying tvd in curvlinear frames might even be physically better motivated than its application in cartesian space .",
    "the moving mesh relaxing tvd indeed appears to be a viable and accurate algorithm at least for these rather trivial test samples .",
    "a much more challenging and comprehensive test of the ( gravity free ) moving mesh hydrodynamic code is a sedov taylor blast solution .",
    "it requires a large dynamic range since the exact solution piles up most of material just behind the shock front .",
    "we set up a box with constant density and a large supply of thermal energy @xmath69 in the center at @xmath70",
    ". as the solution evolves , it tends towards the self - similar sedov taylor solution ( shu 1992 ) .",
    "the evolution of the shock radius is @xmath71 ( landau and lifshitz 1987 page 404 ) , where @xmath72 for a @xmath73 gas . in our test case",
    "we choose the ambient density @xmath74 , and @xmath75 .",
    "the outside pressure is @xmath76 , which is our numerical approximation to @xmath77 .    in figure",
    "[ fig : sedovfm ] we show the full three dimensional solution on a fixed mesh projected onto the radial coordinate .",
    "each grid cell is plotted as one point .",
    "the scatter is due to the anisotropy of the cartesian grid , which occurs since the thin shock layer is not fully resolved , and the resolution is a function of the angular coordinate .",
    "the resolution is necessarily lower along diagonal directions . at this resolution",
    "we see that even the shock jump condition , which would imply a postshock density of 4 , is not well resolved .",
    "this implies that the shock amplitude will be a strong function of resolution .",
    "when we examine the performance on the moving mesh in figure [ fig : sedovmm ] , we see that the mesh just postshock compresses by a factor of 4 , raising the resolution by that amount . in the interior , however , the mesh expands drastically , and we significantly degrade resolution , as can be seen by the scatter at smaller radii .",
    "figure [ fig : sedovmesh ] shows the mesh at the end of the blast wave .",
    "the method is most easily illustrated in 1 + 1 dimensions .",
    "consider a conservation equation of the form @xmath173=0 \\label{eqn : sample}\\ ] ] we replace that equation by another system @xmath174 \\right ) .",
    "\\label{eqn : relaxing}\\end{aligned}\\ ] ] where @xmath175 is a free parameter called the _",
    "freezing speed_. ( [ eqn : relaxing ] ) is a linear advection equation with a non - linear stiff source term .",
    "the essence is to apply strang splitting on these two pieces .",
    "a tvd flux / slope limiter is applied to the linear advection equation , while an implicit backward euler step enforces the source term .",
    "xin and jin ( 1994 ) showed this algorithm to be tvd under the constraint that @xmath104 be greater than the characteristic speed @xmath176 .",
    "one can now take the limit as @xmath177 , which results in a _",
    "relaxed _ algorithm .",
    "time integration is implemented using a second order runge - kutta method .    to solve the linear part of ( [ eqn : relaxing ] )",
    ", we decouple the equations through a change of variables @xmath178 and @xmath179 . the linear equation @xmath180 is discretized in space using a monotone upstream - centered scheme for conservation laws ( muscl ) scheme .",
    "we consider the conserved averaged quantities @xmath181 to be defined at integer grid cells @xmath182 .",
    "then we need to define the fluxes at cell boundaries , @xmath183 at @xmath184 .",
    "we then have @xmath185 .",
    "the remaining trick is to define the flux @xmath186 at half cells .",
    "the first order upwind definition is simply @xmath187 , assuming flow is to the right .",
    "there are two second order choices : 1 .",
    "@xmath188 and 2 .",
    "we generalize the choices as @xmath190 where @xmath191    define the limiter minmod@xmath192sign@xmath193sign@xmath194min@xmath195 .",
    "it chooses the argument with smaller absolute magnitude if the magnitudes have the same sign , and returns zero otherwise .",
    "the choice @xmath196minmod@xmath197 is the simplest of tvd muscl choices , which we use in our code .",
    "near extrema of the flux vector the second order scheme reverts to a first order upwind scheme .",
    "the geometric interpretation is quite simple .",
    "we start with the first order upwind flux , and correct it using either left or right values , choosing the one which demands a smaller correction .",
    "if we are at an extremum , the two corrections have opposite sign , and we do not correct at all .",
    "this approach is called a flux limiter . for a description of the mathematical justification , see for example yee ( 1988 ) .",
    "we have also implemented the whole range of tvd limiters according to hirsch ( 1990 ) , of which the so - called `` superbee '' is the least diffusive .    in the limit of a relaxed scheme",
    "where @xmath198 , we operate with the constraint that @xmath199 $ ] at the beginning of each partial step , and @xmath200 becomes only an auxiliary vector to calculate flux limiters .",
    "the advantage of the relaxed scheme is that it requires no knowledge of the eigenvectors or eigenvalues of the flux function , only an estimate for the lower bound of the maximum eigenvalue .",
    "since the curvilinear equations of motion ( [ eqn : moving ] ) are rather complex , this is of computational advantage .",
    "it is also quite simple to implement .",
    "the time step is limited by the freezing speed @xmath104 , and we obtain simple expressions to compute the correct time step .    in several spatial dimensions , the simplest generalization is to apply the freezing advection to each dimension . to illustrate in two dimensions , we start with @xmath201 which we convert into the relaxing equation @xmath202 \\right ) \\nonumber \\\\ \\dot{w } +   \\partial_y cu & = & -\\frac{1}{\\epsilon } \\left ( w - g[u ] \\right ) .",
    "\\label{eqn : set}\\end{aligned}\\ ] ]    the limiter is then applied to each pair @xmath203 and @xmath204 . by applying the runge - kutta time integrator to the whole system ,",
    "the algorithm is not dimensionally split .",
    "one should note , however , that the slope limiter is in fact dimensionally split .",
    "this could be circumvented by using a local extrema diminishing ( led ) limiter on the whole set of linear advection equations ( [ eqn : set ] ) .",
    "we have not implemented this method , since it has a large operation count and program complexity . in the current numerical experiments , no direct problems with the directional slope limiter has been observed .",
    "while not as rigorous or accurate as the harten or ppm scheme when applied to the full three dimensional system , the relaxed scheme offers simplicity and robustness . for a description of curvilinear tvd schemes ,",
    "see yee ( 1987 ) .",
    "we can preserve the exact time invariant conservation form of the fluid equations in a friedman - robertson - walker ( frw ) expanding background by using the expansion changing to comoving variables @xmath78 and a new time scale ( gnedin 1995 ) @xmath79 using this variable , newton s laws apply directly , and in particular objects travel on straight trajectories unless acted upon by another force .",
    "the cost comes as a time dependence of newton s constant .",
    "we will call the new time coordinate @xmath80 the _ newtonian _ time frame . to further fix our units",
    ", we define the scale factor today @xmath81 .    the scale factor @xmath82 is given in a flat universe as @xmath83 where @xmath84 , and the proper time @xmath85 . in a curved universe , @xmath86 where @xmath87 is related to the curvature scale .",
    "again , we obtain an abrupt end to the newtonian time for a hyperbolic universe , where the gravitational interaction becomes infinitely strong at @xmath88 .",
    "more curious is the fact that in a closed universe , ( [ eqn : curv ] ) the newtonian time extends across the full real number line , and in fact the turnaround occurs at @xmath89 , after which the gravitational interaction weakens again .",
    "unfortunately the case with any cosmological constant has no exact solution for the scale factor @xmath90 , and we integrate the friedman equation @xmath91\\ ] ] to third order in the taylor expansion at each time step .",
    "the various values of @xmath92 are given at today s epoch where @xmath81 .",
    "we can qualitatively understand such a universe with small initial perturbations . initially the perturbations grow , become non - linear , shock heat and form into clusters , pancakes and filaments .",
    "this process stops as one approaches turnaround at @xmath89 . after turnaround ,",
    "the physical processes are dominated by hydrodynamic interactions , with gravity becoming less and less important in the evolution of the gas , which redistributes itself into pressure equilibrium .",
    "the final distribution is determined by the gas entropy distribution at turnaround , with the gas at low entropy condensing into high density regions , and gas at high entropy distributed tenuously spread over a larger volume .",
    "paradoxically , the regions of low entropy are the voids at turnaround , which will become high density regions .",
    "the cluster outskirts have the high entropy , and will fill most of space .",
    "the cluster cores are in between , and will expand from the compressed configuration .    using the newtonian time @xmath80 , equation ( [ eqn : euler ] ) maintains the identical hydrodynamic interaction , but with a time dependent gravitational source term @xmath93   & = & 0",
    "\\nonumber\\\\ \\frac{\\partial e}{\\partial \\tau } + \\frac{\\partial}{\\partial x^i}\\left [ ( e+\\rho v+p ) v^i \\right ] & = & -a\\rho v^i v_{,i } \\nonumber \\\\ \\nabla^2 v & = & 4\\pi g ( \\rho-\\bar{\\rho } ) .",
    "\\label{eqn : cosmo}\\end{aligned}\\ ] ]    in a numerical code , we have several choices about units . in order to keep quantities close to unity , we use units where the grid spacing @xmath94 , which defines the conversion factor for length @xmath95 .",
    "we further simplify our units by choosing @xmath96 . for density , we define the mean density of a fluid to be one , so the average mass per cell for each fluid is @xmath97 .",
    "this fixes the mass unit @xmath98 in terms of the critical density @xmath99 where @xmath100 .",
    "@xmath101 is the gas fraction in units of the critical density .",
    "the time unit has already been completely fixed , and is given by @xmath102 where @xmath103    the comoving quantities ( subscript @xmath104 ) are related to the lab values ( subscript @xmath105 ) by the scaling @xmath106 we note that the exact conservation of energy is lost , while momentum is still conserved .",
    "the latter is retained since frw maintains space translation invariance , but time translation invariance has been explicitly destroyed .      in the presence of gravity in an expanding universe , the hydrodynamic energy @xmath9 in equation ( [ eqn : cosmo ] ) has a gravitational source term . by integrating the energy equation in ( [ eqn : cosmo ] ) over space and time , and applying the continuity equation",
    ", we obtain the layzer - irvine equation ( peebles 1981 ) @xmath107 where @xmath108 is the gravitational binding energy .",
    "we see that the sum of potential and kinetic energies is negative , with the source term being the path dependent quantity under the integral sign in ( [ eqn : li ] ) .",
    "typically this path dependent term contributes 20% of the magnitude of the potential energy .",
    "we define the dimensionless layzer - irvine energy conservation ratio as in ryu et al ( 1993 ) @xmath109 this quantity should be unity if energy is exactly conserved . throughout the run",
    "we can monitor this quantity @xmath110 , which gives us some indication about the errors in the simulation .",
    "for the cdm power spectrum ( bardeen _ et al _  1986 ) , where most of the power is at the grid scale , an evolution of the test case spectrum results in @xmath111 , which implies a substantial energy error .",
    "this error is easily understood since numerical diffusion always smoothes out the density field , thereby lowering the magnitude of the gravitational binding energy .",
    "the error decreases to @xmath112 when we compute on a moving mesh . since the primary contribution of power comes from small scales , and since the grid is smoothed , the moving mesh can not in fact resolve the diffusion problem arising on the small scales where the grid does not follow the fluid at all .    for grid based schemes ,",
    "a significant source of error arises due to artificial diffusion .",
    "even though the tvd schemes in principle have no explicit diffusion or viscosity , the tvd limiter upwind modifies the mass flux ( [ eqn : ccons ] ) .",
    "the moving mesh reduces the mass flux over a cartesian eulerian grid , and in principle the mass flux is identically zero for potential flows . in this case , the limiter introduces no diffusion at all . in practice , though , the grid compression limiter ( [ eqn : clim ] ) causes the grid to break away from the fluid flow .",
    "furthermore , the grid only tracks the fluid to first order accuracy , which leads to some variation in mass ( typically a few percent ) .",
    "another major effect is the generation of vorticity . in a pure vorticity equilibrium with no potential flow ,",
    "the mass in each volume element is constant , but each of the directional fluxes is nonzero .",
    "only the sum is zero . in this case",
    ", the flux limiter will kick in , which attempts to reduce extrema .    since the energy conservation , or in our case the layzer - irvine energy ( [ eqn : lir ] )",
    ", is a global quantity , we need to look for local error estimators in order to assess the uncertainty in the physical observable quantities such as x - ray luminosity , mass functions , etc . for this purpose",
    ", we can add a term in the equation of motion which has the same magnitude as the energy error , from which we can gauge the propagation of errors . instead of funneling all the diffusion error into the gravitational binding energy",
    ", we divert the entirety into thermal energy errors",
    ". the physical interpretation would be as follows : a gravitationally bound object , say a cluster of galaxies , moves through the grid . as a result of the motion , the cluster diffuses , resulting in an increase in its core radius .",
    "this decreases the gravitational binding energy , and thereby violates the virial theorem .",
    "the cluster expands even further to reach a new equilibrium .",
    "the alternative scenario would be to decrease the thermal energy at the same time .",
    "the thermal energy is the only galilean invariant that we can use , since kinetic energy depends on the frame .",
    "furthermore we know that momentum is fundamentally conserved , and since the main purpose of cosmological gas dynamics is to accurately calculate the difference between gas and dark matter , we want to resist touching the momentum equation .",
    "the limiter in the continuity equation ( [ eqn : ccons ] ) can be represented as a diffusive flux vector @xmath113 such that the continuity equation becomes @xmath114 = 0.\\ ] ] when we integrate the energy equation over space , we obtain a source term as a function of @xmath113 @xmath115 d^3\\xi .",
    "\\label{eqn : esource}\\end{aligned}\\ ] ] we can therefore add the ( positive value ) of the second term in ( [ eqn : esource ] ) to the right hand side of the energy equation in ( [ eqn : cosmo ] ) to cancel its effect in ( [ eqn : esource ] ) . with this prescription , the only source for energy errors are due to time discretization , and we indeed observe that @xmath116 for short time steps using a fixed grid . for",
    "the cosmological runs at maximal courant time step , the error in @xmath110 is typically a few percent .",
    "we measured the energy error using each of these two schemes for the pancake test described below .",
    "the result is shown in figure [ fig : penergy ] .",
    "since the parameter @xmath110 in equation ( [ eqn : lir ] ) contains kinetic energy divided by potential energy , we would expect diffusion to always increase @xmath110 , which is indeed observed .",
    "the top line with crosses shows the energy error for the standard fixed mesh code without any corrections .",
    "since the diffusion error is first order in space due to upwind limiting , we expect the error to decrease linearly with resolution , as indeed it does . even when the time step is reduced by a factor of 50 , that error changes by less than 10% .",
    "time discretization does not contribute significantly .",
    "the story changes when we implement the energy compensator ( [ eqn : esource ] ) .",
    "the solid line with open triangles shows an immediate decrease in the energy error .",
    "the error now arises primarily from time discretization , and by reducing the time step by a factor of @xmath117 in the bottom line with open squares , the error also decreases by that amount .",
    "our current energy compensation scheme is first order accurate in time . on a moving mesh",
    ", the energy compensation has little or no effect , as we can see from the dotted lines .",
    "energy is already much better conserved since the mass fluxes and therefore the limiter diffusion terms are significantly smaller .",
    "when we perform a run both with and without the source term in ( [ eqn : esource ] ) , we compare the thermal energies at the end of the run , from which we learn which cells have a large error and which ones do nt .",
    "this is demonstrated in the pancake test described below .",
    "empirically we find that energy conservation is always good whenever the power is well resolved in mass units .",
    "we have three factors which determine the time step , and choose the smallest of the three .",
    "firstly , we have the courant condition , which requires that the maximal characteristic travels less than @xmath118 grid cells in one time step for a three dimensional unsplit code . in practice , we choose @xmath119 as half of that value . for",
    "cold or high mach number flows , the moving coordinate system lowers the characteristic speeds in the curvilinear frame , where at zero temperature and potential flow the characteristics would be stationary in the curvilinear frame .",
    "nevertheless , there is still a time step constraint , which is related to the divergence of the velocity field .",
    "it has dimensions of inverse time , and we define @xmath120 as @xmath121th of the inverse of the smallest eigenvalue of the matrix @xmath122 . the last time scale is determined by the cosmic expansion .",
    "we require that @xmath123 between gravitational time steps , thus setting @xmath124 .    in practice ,",
    "a simulation is always dominated by the cosmological expansion @xmath124 initially , but most of the cpu time is spent in the final non - linear clustering stages where @xmath119 and @xmath120 are typically closely balanced .",
    "the gravitational pancake as described in ryu et al ( 1993 ) was tested .",
    "we set up a convergent wave at @xmath125 which collapses at @xmath126 .",
    "the test was run on a fixed grid of @xmath127 cells , and then using fixed and moving meshes on @xmath128 cells . in figure",
    "[ fig : pfm ] we see an under resolved pancake on the fixed mesh .",
    "for such a structure , the effect of energy compensation is significant , and the discrepancy between the compensated and uncompensated energy solutions gives a good estimate of the mass diffusion and gravitational error .",
    "when we run the simulation on a moving mesh in figure [ fig : pmm ] , we obtain a much better resolution of the pancake core , if we use the central density as an indicator of resolution .",
    "in fact , using the compression limiter @xmath129 , the @xmath128 cell moving mesh outperforms the @xmath127 cell fixed mesh .",
    "we further notice that the energy compensation has only a small effect on the solution , which again is due to the fact that mass diffusion is a lesser problem in our moving coordinates .",
    "an intriguing challenge is to collapse a pancake along a diagonal axis in two dimensions at an angle @xmath130 .",
    "the path of each vertex in the central pancake region is such that it does not intersect its nearest neighbor , nor any of the diagonal neighbors .",
    "this tests the code with a strong shock in a highly distorted and oblique geometry .",
    "note that in this configuration the discretized elliptic equations are no longer diagonally dominant , which is a further test for the potential solvers .",
    "we set up a run using a @xmath131 mesh with a maximal compression limiter @xmath129 . despite these challenges , the code performs optimally for the high density regions as shown in figure [ fig : oblique ] .",
    "we also compare the results from out code to the standard test suite in kang et al ( 1994 ) .",
    "the density field for a @xmath132 mpc box with a @xmath133 cdm normalization is given on an initial @xmath134 grid linearly interpolated to @xmath135 .",
    "it is then evolved to the present @xmath136 using a suite of different codes .",
    "we compare convergence of the final result binned into @xmath137 cells . for the fixed mesh case , we see in figure [ fig : compfm ] that the result agrees very well with the harten tvd scheme implemented by ryu et al ( 1993b ) .",
    "agreement in temperature as a function of density ( the lower right graph ) is poor in the low density regions , which are all unshocked and thus should have very low temperature . since the current tvd scheme does not incorporate any entropy variables , entropy is not conserved , and a gas at very low temperature may experience sporadic heating and cooling . as we compare the moving mesh to the kang _",
    "et al _  ( 1994 ) simulations in figure [ fig : compmm ] , we obtain the expected result : the agreement degrades in the low density regions where the grid expands and the resolution degrades . the increased resolution in the high density regions",
    "is not visible when rebinned to such a course grid .",
    "we loose some additional resolution because the comparison is performed by mapping the moving mesh cells as constant density cloud - in - cell particles on a fixed @xmath134 grid , which introduces additional smoothing in the density field .",
    "a slice of the @xmath135 mesh is shown in figure [ fig : mesh128 ] .",
    "only every other grid line is represented in the graph .",
    "the pancakes are well represented , and the grid regularity is apparent . in the magnified view in figure [ fig : mesh128zoom ]",
    "the highest density region is compression limited at @xmath138 .",
    "the grid reverts to a regular cartesian frame with normal orientation in these regions .",
    "since the grid equations are galilean invariant , the high compression region is allowed to move with a bulk motion to follow the fluid .",
    "possible algorithmic improvement for the future includes the following :    \\1 . implementing isolated ( non - periodic ) boundary conditions , such that the code could be used for non - cosmological applications .",
    "\\2 . incorporating truly three dimensional flux limiters , especially the local extrema diminishing ( led ) scheme , which would reduce the mass diffusion problem .",
    "it might be possible to implement a rigorously mass conserving coordinate system , where the net mass flux is explicitly set to zero .",
    "in such a system no mass diffusion could possibly occur , and the layzer - irvine energy would be explicitly conserved .",
    "the flux limiter would now have to be applied directly to the deformation potential .",
    "it is not entirely clear that this can be performed using only local operators .",
    "\\4 . implementing higher accuracy hydrodynamics solvers , including essentially non - oscillatory ( eno ) and piecewise parabolic mesh ( ppm ) algorithms .",
    "we have presented a simple hydrodynamical algorithm which combines the advantages of grid based finite volume flux conservative schemes with the dynamic range of sph monte - carlo lagrangian schemes .",
    "the essential ingredients are a coordinate grid which tracks the potential flow of the fluid , and a fast multigrid gravity solver . by tracking the potential flow ,",
    "the mass per volume element remains constant , giving an astrophysically desirable resolution which is roughly constant in mass coordinates .",
    "furthermore , by following potential flow and smoothing the grid and using limiters , the grid geometry stays regular .",
    "the curvilinear transformation maintains nearest neighbor relations even for typical cosmological density contrasts of @xmath139 and in the presence of vorticity in the fluid itself .",
    "the full curvilinear eulerian equations of motion are solved on the grid , such that even on a non - optimal or incorrect grid second order accurate computation of hydrodynamic quantities would be assured . on each grid volume ,",
    "the averaged conserved quantities ( density , momenta , energy ) are stored , and at each time step , the flux between these control volumes is computed to second order accuracy using the relaxing tvd algorithm . the equations in explicit flux conservative form guarantee compliance with the rankine - hugionot shock jump conditions .",
    "gravitational force terms lead to energy violation in the presence of numerical diffusion .",
    "we have provided a compensation scheme which nearly conserves the total energy even in the presence of such diffusion . by running a simulation with and without this compensation ,",
    "we can obtain a good estimator of the local errors .",
    "the code runs very efficiently in terms of both memory and floating point operations .",
    "the current code parallelizes on symmetric multiprocessor shared memory and vector machines . in appendix",
    "[ app : perf ] we give accurate estimates of computational effort in terms of floating point operations .",
    "we have performed a large test suite on the code , and have demonstrated the advantages for many cosmological problems . on a fixed grid",
    "the algorithm performance approaches that of other state - of - the - art hydrodynamic schemes , and that accuracy is retained when the mesh deforms strongly .",
    "the coding is relatively short and the algorithms simple .",
    "the code is freely available to anyone for non - profit use .",
    "please contact the author for more details .",
    "we are grateful to j.p .",
    "ostriker for all his support and ideas as well as n. gnedin , g. xu and d. spergel for helpful discussions .",
    "this work was supported in part by the nsf hpcc initiative under grant asc93 - 18185 .",
    "here we review some of the curvilinear transformations used in the paper .      in this section",
    "we derive equation ( [ eqn : moving ] ) . we wish to apply a general coordinate tranformation to an equation of the form @xmath140}{\\partial x^i } = 0\\ ] ] where @xmath141 and the partial derivative with time holds @xmath142 fixed .",
    "we express the time dependent coordinate transformation as @xmath143 . applying the chain rule",
    ", we obtain @xmath144 - \\left .",
    "{ \\sqrt{g}}\\frac{\\partial } { \\partial t }   u\\right|_\\xi + { \\sqrt{g}}u e^\\alpha_i \\dot{e}^i_\\alpha - \\left(f^i - u\\dot{x}^i\\right ) \\frac{\\partial } { \\partial \\xi^\\alpha } ( { \\sqrt{g}}e^\\alpha_i ) = 0 \\label{eqn : expand}\\ ] ] where a dot indicates the partial derivative with respect to time keeping @xmath53 fixed . expanding the determinant by kramer s rule , we recall that @xmath145 , which eliminates the third and fourth term in equation ( [ eqn : expand ] ) .",
    "we note that the triad @xmath22 is a one index contravariant vector .",
    "some algebra shows that the quantity @xmath146 is a scalar under coordinate transformations . in euclidian space , expression ( [ eqn : scalar ] ) vanishes everywhere .",
    "thus this scalar is zero in all coordinates , and the last term in equation ( [ eqn : expand ] ) is also identically zero .",
    "we recall that the triad @xmath147 is symmetric and positive definite .",
    "in the course of the computation , its eigenvalues will be needed , which are computed as follows ( crc 1991 ) :    \\1 .",
    "let @xmath148    \\2 .",
    "let @xmath149trace@xmath150 ,  @xmath151    \\3 .",
    "let @xmath152 , @xmath153    @xmath154 ,    \\4 .",
    "let @xmath155 .",
    "the eigenvalues are given by @xmath156 , which are given in decreasing order .",
    "the eigenvalues are of course real and positive .",
    "the eigenvalues of the inverse triad are the reciprocals of the eigenvalues of the triad .",
    "another set of eigenvalues which are needed to implement the relaxing tvd algorithm are the eigenvalues of the jacobian in equation ( [ eqn : moving ] ) in curvilinear coordinates . as in yee ( 1989 ) the magnitude of the largest eigenvalue",
    "is given as max(@xmath157 ) , where @xmath158 and @xmath159 is the sound speed .",
    "assuming spherical symmetry n @xmath160 dimensions , some exact relations between the metric and the deformation potential exist .",
    "we define a parameter @xmath161 , and let a prime denote differentiation with respect to @xmath162 .",
    "the volume element is given as @xmath163 for an @xmath160-dimensional space .",
    "we see in particular that in one dimension , i.e. planar symmetry of three dimensions , ( [ eqn : sphrg ] ) becomes a linear equation . for the next formulae we will assume that @xmath164 .",
    "if we prescribe the volume element , which corresponds to the grid density , we wish to solve for the deformation potential .",
    "it is given by the following formula : @xmath165 du .",
    "\\label{eqn : sph3}\\ ] ] in the case that @xmath166 is constant , ( [ eqn : sph3 ] ) simplifies to @xmath167 we see that the deformation potential is in general an inverted parabola around density minima and a parabola around density peaks .    for small fluctuations in density ,",
    "let us enforce @xmath168 , and set @xmath169 .",
    "we wish to approximate @xmath170 . for small fluctuations ,",
    "we obtain @xmath171 , and the deformation potential @xmath172 is proportional to the gravitational potential .",
    "we have recovered the zeldovich approximation with our displacement _ ansatz _ in linear theory .    while the decomposition into potential flow and displacement is unique for small density fluctuations ( apart from boundary conditions ) ,",
    "the _ ansatz _ ( [ eqn : ansatz ] ) is a particular choice in strongly curvilinear coordinates .",
    "it generalizes the notion of potential flow by defining a frame through the symmetric triad in which no net rotation of the coordinate system occurs .",
    "the change is described by a displacement and stretching of coordinate space alone .",
    "we call this rotation free moving frame the generalized potential flow for strongly compressed gases .",
    "the code is extremely memory friendly . the minimal required storage count for arrays of size",
    "@xmath205 is 7 : 5 for the hydrodynamic arrays , 1 for the deformation potential @xmath28 , 1 for the time derivative of the deformation potential @xmath37 and 1 for the gravitational potential @xmath11 . in principle the last two",
    "could be stored in the same array since they are not in principle needed simultaneously .",
    "some additional storage of order @xmath206 would be required for the multigrid scheme .    in practice",
    ", we use 10 arrays in the current implementation .",
    "the gravitational potential is stored twice , allowing us to linearly interpolate from the previous two time steps as an initial guess to the multigrid gravity solver .",
    "an extra array is used to store @xmath207 .",
    "the program allocates up to 5 more arrays for special purposes .",
    "an additional array is needed for computing n - body particles to second order accuracy , which is used to store the deformation potential of a previous time step .",
    "four more arrays are needed to implement the gravitational energy conservation scheme .",
    "all operations except for the gravity solver are explicitly performed on a regular grid , and would thus parallelize straightforwardly on any kind of parallel or vector machine with no load imbalance issues .",
    "the parallel multigrid algorithm has been investigated in detail in the literature , and can in principle be performed efficiently on a parallel machine .",
    "the current code runs in parallel on a shared memory sgi power challenge with 150 mhz r8000 processors . in order to maintain simplicity and storage efficiency for the temporary two dimensional arrays ,",
    "most parallelization is done at the second level of loops . on a machine with 8 processors ,",
    "we obtain a speedup of 6 .",
    "the most direct objective measure of computation speed is the floating point count . for the moving mesh , this count is independent of clustering or deformation , and thus an accurate predictor of the execution time .",
    "the actual sustained floating point speed of each machine depends on many parameters , including compiler version and many compiler fine tuning options .",
    "let us define the basic operating cost @xmath44 as the number of floating operations per cell per courant step .",
    "this is an objective measure of any numerical code , and depends only on the physical parameters and grid resolution .",
    "the code currently takes two hydrodynamic and one gravity time step in each courant time interval .",
    "it also calls the multigrid solver four times , twice for the deformation potential and twice for the gravitational potential .",
    "the gravitational solver is called twice in a row to provide a minimal gravitational error .",
    "errors in the deformation potential do not enter directly in any other error estimates , and it is thus not crucial to solve the deformation potential accurately .",
    "we thus have @xmath208 , where @xmath209 is the cost per cell per time step for the curvilinear relaxing tvd hydro , and @xmath210 is the cost per cell of the multigrid solver . in pen ( 1995 )",
    "we computed the asymptotic cost of @xmath211 for a grid of infinite size .",
    "the actual count obtained for a @xmath134 grid using the floating point counter on a cray c90 is @xmath212 .",
    "the discrepancy arises in part because the estimate of @xmath213 was based on computing a metric tensor , and the sum of relaxation sweeps over all subgrid . to test the compiler count on these operations alone ,",
    "we obtain a value of @xmath214 from the hardware counter . while there are certain neglected costs , in particular that of edge effects and other costs which are of @xmath215 , the discrepancy is much larger than they could account for .",
    "we have no explanation for the difference .",
    "when the relaxation routine alone is timed , the hardware counter obtains 52 additions , 33 multiplications and one division , while a direct source statement count yields 41 additions , 26 multiplications and 1 division . on the sgi compiler version 6.0.2 , we have analyzed the generated assembly code , which obtained a 15% higher floating point count than the original source code .",
    "this was possibly due to algebraic rearrangements which may have improved instruction scheduling .",
    "in addition , the cost of prolongation and projection operators , as well as operations which force a volume weighted zero sum was neglected .",
    "these may account for the remaining @xmath216 operations .    for the hydrodynamic calculations",
    ", we only have the hardware count data available . using a @xmath134 run",
    ", we obtain @xmath217 .",
    "this yields a total operation count @xmath218 , of which half arises from the hydrodynamics , and half from the multigrid solver . on a single cpu of a cray c90",
    "the code achieves about 300 mflop on @xmath219 runs out of a theoretical peak of 1gflop , which is 30% of peak .",
    "the vector lengths for the multigrid relaxation are half the box widths , which means we fill the vector length using a @xmath219 mesh . on an sgi power challenge r8000",
    ", the code currently achieves 48 mflop out of a theoretical peak speed of 300 mflop on a @xmath134 run .",
    "cache misses account for about 23% of the computing time on the sgi .",
    "bardeen , j.m . , bond , j.r . ,",
    "kaiser , n. , & szalay , a.s .",
    "1986 , 304 , 15 berger , m.j . , and colella , p. 1989",
    ", j. comp .",
    "82 , 64 bryan , g.l . , norman , m.l . , and ostriker , j.p .",
    "1995 , computer physics communications , 89 , 149 .",
    "cen , r. y. , ostriker , j. p. , jameson , a. 1990 , , 362 , l41 cen , r. 1992 ,   78 , 341 .",
    "colella , p. , and woodward , p.r .",
    "( 1984 ) , j. comp .",
    "courant , r. , and friedrichs , k.o .",
    "1948 , `` supersonic flow and shock waves '' , new york : springer verlag crc standard mathematical tables and formulae , 29th edition , bota raton : crc press .",
    "evrard , a.e .",
    "1988 , 194 , 503 .",
    "fiedler , b.h . and",
    "trapp , r.j .",
    "1993 , mon .",
    "weather rev .",
    ", 121 , 2799 .",
    "fiedler , r.a . and",
    "mouschovias , t.ch .",
    "1992 , 391 , 199 .",
    "fiedler , r.a . and",
    "mouschovias , t.ch .",
    "1993 , 415 , 680 .",
    "gnedin , n.y .",
    "1995 ,  97 , 231 .",
    "harten , a. 1983 , j. of comp .",
    "hawken , d.f . ,",
    "gottlieb , j.j . ,",
    "hansen , j.s .",
    "1991 , j. of comp .",
    "92 , 254 hernquist , l. , and katz , n. , 1989 , , 70 , 419 hirsch , c. 1990 , `` numerical computation of internal and external flows , volume 2 : computational methods for inviscid and viscous flows '' , john wiley .",
    "kang , h. , ostriker , j.p . ,",
    "cen , r. , ryu , d. , hernquist , l. , evrard , a.e . , bryan , g. , and norman , m.l .",
    "1994 , 430 , 83 landau , l.d . , and lifshitz , e.m .",
    "1987 , `` fluid mechanics '' , 2nd ed , oxford : pergamon press .",
    "lohner r. , morgan k. , and zienkiewicz , o.c , computer methods in applied mechanics and engineering , 51 , 441 , 1985 .",
    "monaghan , j.j .",
    "1992 , ann .",
    "navarro , j.f . , and white , s.d.m . , 1993 , , 265 , 271 .",
    "peebles , j.p.e .",
    "1981 , the large scale structure of the universe , princeton university press .",
    "pen , u. 1995 , , 100 , 269 .",
    "ryu , d. , ostriker , j.p . , kang , h. , and cen , r. 1993 , 414 , 1 shapiro , p.r . ,",
    "martel , h. , villumsen , j.v . and owen , j.m .",
    ", `` adaptive smoothed particle hydrodynamics with application to cosmology : methodology '' , university of texas , mcdonald observatory , preprint no .",
    "shu , f. h. 1992 , `` gas dynamics '' , mill valley : university science books .",
    "thompson , j.f .",
    ", warsi u.a . and mastin , c.w .",
    "1985 , `` numerical grid generation foundations and applications '' , north - holland , 483 p. trapp , r.j . and fiedler , b.h .",
    "1995 , j. atmos .",
    "52 , 3757 xin , z. , and jin , s. 1995 , comm .",
    "pure and applied math .",
    ", 48 , 235 .",
    "xu , g. 1996 , astro - ph/9610061 yee , h.c . and harten , a. 1987 , aiaa journal 25 , 266 .",
    "yee , h.c .",
    "1989 , nasa tm 101088 ."
  ],
  "abstract_text": [
    "<S> an algorithm for simulating self - gravitating cosmological astrophysical fluids is presented . </S>",
    "<S> the advantages include a large dynamic range , parallelizability , high resolution per grid element and fast execution speed . </S>",
    "<S> the code is based on a finite volume flux conservative total - variation - diminishing ( tvd ) scheme for the shock capturing hydro , and an iterative multigrid solver for the gravity . </S>",
    "<S> the grid is a time dependent field , whose motion is described by a generalized potential flow . </S>",
    "<S> approximately constant mass per cell can be obtained , providing all the advantages of a lagrangian scheme . </S>",
    "<S> the grid deformation combined with appropriate limiting and smoothing schemes guarantees a regular and well behaved grid geometry , where nearest neighbor relationships remain constant . </S>",
    "<S> the full hydrodynamic fluid equations are implemented in the curvilinear moving grid , allowing for arbitrary fluid flow relative to the grid geometry . </S>",
    "<S> this combination retains all the advantages of the grid based schemes including high speed per fluid element and a rapid gravity solver </S>",
    "<S> .    the current implementation is described , and empirical simulation results are presented . </S>",
    "<S> accurate execution speed calculations are given in terms of floating point operations per time step per grid cell . </S>",
    "<S> this code is freely available to the community . </S>"
  ]
}