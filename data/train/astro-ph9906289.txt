{
  "article_text": [
    "the two point angular correlation function , @xmath4 , has emerged as one of the most powerful measurements in cosmology .",
    "it is constructed from photometric catalogues , bypassing the need to take time - consuming redshifts .",
    "photometric catalogues contain many more galaxies than do redshift surveys .",
    "this advantage in statistics is often enough to offset the extra information about distance conatined in redshift surveys .",
    "in fact , one might argue that the redshift is prone to misinterpretation due to redshift - space distortions caused by peculiar velocities .",
    "angular catalogues which implicitly integrate over all line - of - sight distances avoid these distortions .",
    "these general arguments are backed up by the current state of affairs regarding the three dimensional power spectrum .",
    "the surveys which constrain the power spectrum on the largest scales are the apm ( maddox 1990 ) and edsgc ( collins , nichol , and lumsden 1992 ) surveys , each of which contain angular positions for well over a million galaxies .",
    "extracting the power spectrum from @xmath4 requires an inversion of limber s equation which describes how the angular correlation function probes structure on all scales .",
    "this a classical example of an inverse ( linear ) problem .",
    "schematically , limber s equation reads w_i",
    "= k_i p _ where roman indices label angular bins , while greek indices label bins in @xmath5 . here , we use the same kernel @xmath6 used by baugh & efstathiou ( 1993,1994 ) and gaztaaga & baugh ( 1998 ) .",
    "these groups have successfully extracted the power spectrum from the apm @xmath7 by using lucy s method to invert .",
    "roughly , this entails fitting a function to the observed @xmath7 , and then iterating until one finds the best power spectrum .",
    "we say `` successfully '' because gaztaaga & baugh ( 1998 ) have tested their method on simulations . they show that the power spectrum they obtain by measuring @xmath4 in the simulations and then inverting agrees well with the true power spectrum .    over the coming decade",
    ", a wide variety of galaxy surveys and cosmic microwave background anisotropy experiments will generate a wealth of data for cosmologists to study .",
    "it is conceivable that we will enter the age of precision cosmology , where we strive to determine fundamental physical and cosmological parameters extremely accurately . to be effective in this environment",
    "a given measurement must provide not only a reliable estimator for the quantity under consideration ( e.g. the power spectrum ) but also a reliable error matrix .",
    "the purpose of this paper is to introduce a technique which extracts from @xmath4 not only an estimator for the power spectrum @xmath8 , but also a reliable measure of the error matrix , @xmath9 .",
    "this error matrix provides a quantitative measure of the accuracy of the estimator . the fact that it is a matrix , and not just a vector of diagonal error bars , allows for the very real possibility that the power spectrum estimator in nearby bins will be correlated .",
    "this set of @xmath10 can then be used to constrain cosmological models and parameters .",
    "the question naturally arises as to why one extracts the power spectrum from the angular correlation function ; why not simply constrain models with the angular data ?",
    "section 2 provides an answer to this question .",
    "section 3 describes the technique , which is very similar to that discussed in press ( 1992 ) . since we want to test not only our estimates of @xmath8 but also our estimates of the error matrix , it is not sufficient to compare extracted @xmath11 with the true @xmath11 .",
    "section 4 describes the way we will test the error matrix .",
    "finally , section 5 presents the results for the apm survey . in the process",
    ", we will obtain a set of powerful constraints on cold dark matter ( cdm ) models .",
    "we conclude in section 6 with suggestions for future work .",
    "there are several reasons why an extracted three dimensional power spectrum is more useful than the two point angular correlation function .",
    "the kernel in depends on details of the survey : how deep does it go ? what is its selection function ?",
    "therefore , @xmath4 is very dependent on the survey .",
    "different surveys can and do get different results . the power spectrum , on the other hand , is more closely tied to theories ; in principle the estimators constructed for the power spectrum try to be as unbiased as possible .    the most important consideration , though , has nothing to do with these issues of taste .",
    "rather , the most important issue is that the angular correlation function depends on physics about which we know little : the physics of nonlinearities and hydrodynamics which operate on small scales .",
    "figure 1 illustrates this point .",
    "it shows @xmath4 for several different angles  all thought to be `` large ''  as a function of the maximum value of @xmath12 considered in the sum in .",
    "that is , we perform the integral in up to @xmath13 to find @xmath14 .",
    "we see that even these large angles get non - negligible contributions from relatively large wave numbers ( small scales ) . for example",
    ", even @xmath15 depends somewhat on the power between @xmath16 .",
    "these are scales small enough to be affected by nonlinearities and hydrodynamics .",
    "the other side of the coin is that @xmath17 , while dominated by small scale power , does contain some information about large scales , and it would be a shame to throw this information away .",
    "= 8.truecm    inversion offers an excellent way out of this dilemma . upon inverting",
    ", we will be using all the large scale information and throwing out all the small scale information .",
    "mathematically , this is done in a trivial way :    * perform the inversion and get @xmath11 and its associated error matrix @xmath9 .",
    "* throw away all the small scale bins from step 1 by truncating @xmath11 and @xmath9 .",
    "this is equivalent to marginalizing over these modes .",
    "that is , the resulting smaller error matrix has implicitly integrated over all possible values of @xmath11 on small scales .",
    "it is not contaminated at all by small scale information .",
    "* use these large scale modes to constrain theories .",
    "we now proceed to outline the inversion process .",
    "one s first thought upon encountering is to simply invert the matrix @xmath6 to obtain a estimator for the power spectrum : _",
    "= k^-1_,i _ i where the set of @xmath18 are the estimators for the angular correlation function .",
    "this simple approach does not work .",
    "the inversion is very unstable and typically leads to nonsense .",
    "this is because the solution is degenerate ( or @xmath6 is singular ) as we typically want to obtain more information about @xmath8 than available in @xmath19 . in order to regulate the inversion , we need to introduce a bit of formalism .",
    "we will assume that we are handed a set of @xmath20 estimators for the angular correlation function , @xmath18 , each @xmath21 corresponding to one of the @xmath20 angular bins .",
    "in addition , we assume we are handed the full error matrix for this set of estimators , @xmath22 , an @xmath23 matrix .",
    "this could be computed from first principles , or it could be estimated from a set of simulations .",
    "mathematically , the simplest assumption is that the errors have a gaussian distribution so that the probability that the angular correlation function is equal to @xmath24 is ( \\{w_i } ) \\ { -12 ( w_i - _ i ) ( c_w^-1)_ij ( w_j - _ j ) }    in order to invert , we need to assume more , we need to assume that the power spectrum is `` smooth . ''",
    "this assumption is put in by a second exponential in the probability distribution ( press , 1992 ) : ( \\{p _ } ) & & \\ { -12 ( k_ip_- _ i ) c^-1_ij ( k_jp_- _ j ) } & & \\ { -2 p_h _ p _ } where",
    "now we have explicitly eliminated @xmath7 in favor of @xmath11 using limber s equation .",
    "the second exponential here can be viewed as a _",
    "prior _ distribution .",
    "it is implemented by putting in some matrix @xmath25 ( see press 1992 for some examples ) which makes it costly for @xmath11 to vary too much .",
    "here we use for @xmath25 the first difference matrix , equation 18.5.3 . in press",
    "we have tried other difference matrices with little effect on the results . for historical reasons ,",
    "we have actually taken @xmath26 to be the unknown function .",
    "this means that we are smoothing @xmath26 to be locally flat .",
    "this entire @xmath25 term is weighted by a free parameter @xmath27 , which allows one to tune the relative weights of the first and second exponential .",
    "one of the questions which will occupy us below is , what should @xmath27 be set to ?",
    "if one distrusts priors , @xmath27 should be set very small to have little effect .",
    "this will have to be balanced by the requirement that the inversion is stable .",
    "the argument of the exponential in is quadratic in @xmath11 .",
    "thus it can be rewritten as ( \\{p _ } ) \\",
    "{ -12 ( p_- _ ) ( c_p^-1 ) _",
    "( p_- _ ) } where the estimator for the power spectrum is _ ( c_p^-1 ) _",
    "( k^t)_i ( c_w^-1)_ij _ j and the error matrix is c_p , ^-1 .",
    "note that in the limit that @xmath28 we do indeed recapture our initial guess , @xmath29 . by varying @xmath27",
    "we can now move away from this unstable solution .",
    "also note that while press ( 1992 ) refrain themselves from talking about the @xmath30 term as a prior , this interpretation is essential if we are to obtain an error matrix for @xmath11 .",
    "the simplest test of an inversion technique is to compare the recovered power spectrum with the true , underlying spectrum .",
    "there are several problems with this , though .",
    "first , and foremost , we do not know the true power spectrum .",
    "this difficulty can be surmounted by working with simulations , with which it is possible to generate angular catalogues .",
    "however , even if the true power spectrum is known , there is always the quantitative problem of determining how good the inversion is .",
    "this problem is exascerbated when the estimates of the power spectrum in adjacent bins are correlated .",
    "how do we make sense of the full error matrix for @xmath8 ?",
    "one way to test inversion is to put constraints on the parameters in a cosmological model .",
    "first , the constraints can be placed in the parameter space using the angular data , and then a second set of constraints can be drawn using the inferred power spectrum .",
    "these should agree .",
    "in fact , the method described in  2 is linear : the estimators for @xmath8 are linear in the estimators of @xmath7 .",
    "really , then , the inversion process can be thought of as a new basis for the data , the `` @xmath11 '' basis instead of the `` @xmath7 '' basis . through this prism",
    ", it is clear that the constraints on parameters should be independent of basis .    for our example",
    ", we will choose the apm survey ( maddox 1990 ) , with data points and error bars shown in figure 2 .",
    "errors are from the dispersion in 4 subsamples of the apm pixel maps ( same as in baugh & efstathiou 1994 ) and are assumed to be diagonal .",
    "we have tried several ways of estimating the full covariance matrix for @xmath7 .",
    "first , we have estimated it directly from the four quadrants of the apm survey .",
    "this produced a covariance matrix which was far too noisy .",
    "we then generated ten separate mock apm catalogues and estimated the covariance matrix from these forty sets ( @xmath31 four quadrants for each ) .",
    "this proceedure worked on smaller angular scales but broke down on the largest scales ( probably because the simulations were not large enough ) .",
    "one could also estimate @xmath22 analytically by assuming that the underlaying fluctuations are gaussian .",
    "the results that we have obtained using the full covariance matrix of @xmath22 , but with smaller angular scales ( ie @xmath32 deg ) , give larger errors , but not much different in qualitative terms from the results that will be present here .",
    "this paper is mostly concerned with the inversion process for fixed ( @xmath33 ) so we will simply assume here that @xmath22 is diagonal and leave off - diaginal errors for future work .",
    "the model we choose to constrain is the cdm - like power spectrum with power spectrum p(k ) = a k t^2(k ; ) where @xmath34 is the bbks ( bardeen , 1986 ) transfer function .",
    "there are two free parameters in this model : the amplitude @xmath35 and the shape parameter @xmath36 .",
    "we first determine the constraints on these parameters using the angular correlation data . specifically , we calculate ^2 _ i=1^n_w ( w_i(,a ) - _",
    "i)^2 c_w , ii where we have explicitly indicated that @xmath37 depends on the parameters @xmath38 via limber s equation .",
    "figure 3 shows the allowed one- and two- sigma regions in this parameter space .",
    "these contours will be our basis for judging the efficiency of the inversion .",
    "if we include all @xmath39 modes , we should recover identical contours from the inverted spectrum .",
    "the main advantage of inversion is that once we have performed a successful inversion , we can throw out the small scale @xmath39 modes and generate a new , more reliable allowed region .",
    "we now test the inversion algorithm of  3 on the apm data .",
    "the extracted power is shown in figure 4 .",
    "the error bars are the square roots of the diagonal elements of @xmath9 . for each bin",
    ", this error then includes the uncertainties induced by marginalizing over all other @xmath39 modes .",
    "also shown in figure 4 is the power spectrum obtained by lucy s method ( from table 2 in gaztaaga & baugh 1998 ) .",
    "these agree very well except on small scales . however , most of the disagreement is illusory because we are only using angular scales @xmath40 degree which has limited information about the power on scales @xmath41 .",
    "some of the disagreement between the two methods on small scales results from a more subtle effect .",
    "the estimates of the power spectrum on small scales are highly correlated , as shown in figure 5 .",
    "this means that the overall amplitude in any of these modes is uncertain identity matrix a very large number to each of the matrix elements ( including the off - diagonal ones ) . upon diagonalizing this matrix",
    ", one sees that one eigenmode  the sum of the two original ones  has a huge eigenvalue , while the eigenmode corresponding to the difference has eigenvalue equal to one .",
    "in fact , analysts of cosmic microwave background experiments often add a very large number to every element of the covariance matrix to account for the fact that the average is unknown ( bond , jaffe , & knox , 1998 ) . ]",
    "this uncertainty is reflected in the large diagonal error bars .",
    "one can think of this in terms of linear combinations of the modes .",
    "one linear combination  the sum of power in the all the bins or the average power  is very uncertain .",
    "however , all other linear combinations  and therefore the shape  are known quite accurately .",
    "we now test the inversion to see if it recaptures the constraints on the parameters @xmath36 and @xmath35 that were obtained in figure 3 the angular correlation function itself .",
    "figure 6 shows these two sets of contours ; they agree extremely well , suggesting that the inversion has been successul .",
    "finally , figure 7 shows the contours one obtains by throwing out the small scale data ( @xmath42 ) .",
    "as one might expect , the allowed region gets much larger , but the qualitative statement that small @xmath43 is preferred remains true .",
    "gaztanaga & baugh ( 1998 ) found a higher value of @xmath44 , over the four points in range @xmath45 .",
    "for this narrower range of scales our allowed region does indeed peak closer to @xmath46 as expected from the agreement in both @xmath8 estimations shown in figure 4 .",
    "figures 4 - 7 are for a particular value ( @xmath47 ) of the free parameter @xmath27 which sets the importance of the smoothness prior in . what motivates this choice and how do the results change as @xmath27 gets bigger or smaller ?",
    "first consider reducing @xmath27 thereby trying to eliminate the dependence on the smoothing prior .",
    "figure 8 shows the inferred power spectrum in this case .",
    "although the mean @xmath8 agrees with that using a stronger smoothness prior , the error bars are significantly larger .",
    "the larger errors result from the fact that the power spectrum estimates are much more highly correlated if the prior is weak , due to the degeneracy in the inverse problem solution . to understand this , consider the limit of no smoothness prior . in that case",
    ", it is possible to fit the @xmath4 data with an extremely choppy power spectrum .",
    "one bin might have huge power , while another has negative power .",
    "this choppiness is evident on large scales in figure 8 .",
    "one could still try to use such a choppy power spectrum to fit models .",
    "but the results in each bin do not make much sense by themselves and there are large covariances among the different bins .",
    "so this is not a very useful representation of the data .",
    "the large correlations between different bins also affects the constraints on cdm models , which use only the large scale data .",
    "this is shown in figure 9",
    ". the small @xmath27 constraints ( weak prior ) are much less restrictive than the stronger prior . this reflects the fact that the large scale estimates are highly dependent on the small scale estimates .",
    "hence , marginalizing over the latter leads to constraints which are not very tight .",
    "incidentally , the constraints obtained using all the data are identical to the constraints coming from @xmath4 itself ( the analogue of figure 6 ) .",
    "so the inversion is accurate , but not useful because the modes are so correlated .    introducing a stronger prior leads to an inaccurate power spectrum extraction .",
    "the prior is given too much weight , and the data loses out .",
    "we can see this in figure 10 , which shows the power spectrum using a strong prior as opposed to the moderate one advocated earlier . at intermediate scales",
    "the power estimates differ decidedly . examining the constraints on the cosmological parameters",
    "illustrates that the incorrect inversion is the one using the strong prior .",
    "figure 11 shows that the strong prior leads to incorrect constraints .",
    "the information in the data has not been processed accurately .",
    "very valuable information is contained in the angular correlation function . a useful way to extract",
    "this information is to invert it and obtain an estimator for the three dimensional power spectrum .",
    "we have introduced here a method that is different from the one used previously and have focused intensely on its advantages and its features .",
    "however , it is important not to lose sight of the fact that this inversion technique agrees extremely well with lucy s method , the previous inversion tool .",
    "this agreement suggests that we ( as a community ) are correctly inferring the power spectrum from the angular correlation function .",
    "we worked with the angular apm data ; our results for the three dimensional power spectrum and its error matrix are shown in figures 4 and 5 .",
    "files containing these numbers are available at http://www-astro-theory.fnal.gov/personal/dodelson/inversion/power.html .",
    "having reiterated these successes , we warn that there are a number of issues not explored here that warrant further study :    * the distribution for the angular correlation function is not gaussian , as assumed in . indeed , even if the fluctuations are gaussian  as they are predicted to be in inflationary models on large scales but are certainyl not on small scales  the likelihood function is not gaussian in @xmath7 .",
    "the full likelihood function is hopelessly complicated ( dodelson , hui & jaffe , 1997 ) , but perhaps there are approximations that can be made which account for the non - gaussianity .",
    "indeed , there has recently been some progress along these lines ( meiksin & white , 1999 ; scoccimarro , zaldarriaga & hui , 1999 ; hamilton , 1999 ; hamilton & tegmark , 1999 ) . * in performing the inversion , we assumed that the power spectrum was separable : @xmath48 and assumed a simple form for @xmath49 ( @xmath50 ) .",
    "similarly , we have not explored at all the uncertainties in the selection function .",
    "we have also used the small angle approximation .",
    "all of these fold into the kernel in limber s equation",
    ". they may be sufficient for apm ( e.g. see gaztaaga & baugh , 1998 ) , but need to be revisited for deeper surveys , such as the sloan digital sky survey .",
    "* we assumed that the covariance matrix for the angular correlation function is diagonal .",
    "the exact nature of this matrix depends on the binning proceedure , but clearly it is not diagonal .",
    "our efforts to obtain the full covariance matrix from simulations failed , but perhaps simulations on small scales could be supplemented by linear calculations on large scales to obtain the full covariance matrix . *",
    "related to the first and third points is our assumption that the covariance matrix @xmath22 does not depend on @xmath7 itself .",
    "this again is not true and needs to be accounted for when constraining parameters in a cosmological model . *",
    "although we explored the consequences of varying the smoothness prior , we did not explore how these variations couple to : ( i ) different binning schemes for @xmath4 ; ( ii ) different binning schemes for @xmath8 ; or ( iii ) theoretical models which vary more rapidly than the ones discussed here ( e.g. high baryon models retain signatures of primordial acoustic oscillations ) .",
    "all of these assumptions were implicit in previous inversions , and other ways of obtaining the power spectrum involve a similar number of assumptions . so measuring the angular correlation function still is an excellent way to get at the power spectrum .",
    "clearly , though , more work is needed to enable the extraction to be as powerful and accurate as possible .    *",
    "acknowledgments * we thank carlton baugh for helpful comments .",
    "we thank the referee for his inciteful comments .",
    "his careful reading of the manuscript has really helped us improve the text .",
    "we are especially grateful to him for taking the time to work through our arguments , and for spotting some of the weaknesses in them .",
    "we acknowledge support from nato collaborative research grants programme crg970144 .",
    "sd is supported by nasa grant nag 5 - 7092 and the doe .",
    "eg acknowledges support by spanish dges(mec ) , project pb96 - 0925 .",
    "baugh , c.m . , efstathiou , g. , 1993 , 265 , 145 baugh , c.m . , efstathiou , g. , 1994 , 267 , 323 bardeen , j.  m. , bond , j.  r. , kaiser , n. , & szalay , a.  s. , 1986 , , 304 , 15 bond , j.r . , jaffe , a.  h. , & knox , l. , 1998 , , 57 , 2117 collins , c.  a. nichol , r.  c. , & lumsden , s.  l. 1992 , , 254 , 295 dodelson , s. , hui , l. , jaffe , a.  h. , 1997 , 9712074 gaztaaga , e. & baugh , c.m .",
    ", 1998 , , 294 , 229 hamilton , a.j.s . , 1999 , 9905191 hamilton , a.j.s . & tegmark , m. , 1999 , 9905192 maddox , s.  j. , efstathiou , g. , sutherland , w.  j. , & loveday , l. 1990 , , 242 , 43p meiksin , a. & white , m. , 1998 , 9812129 press , w.h . ,",
    "teukolsky , s.a . , vetterling , w.t . , & flannery , b.p . , 1992 , _ numerical recipes _ ( cambridge ) scoccimarro , r. , zaldarriaga , m. & hui , l. , 1999 , 9901099"
  ],
  "abstract_text": [
    "<S> the two point angular correlation function is an excellent measure of structure in the universe . to extract from it the three dimensional power spectrum , one must invert limber s equation . here </S>",
    "<S> we perform this inversion using a bayesian prior constraining the smoothness of the power spectrum . among other virtues </S>",
    "<S> , this technique allows for the possibility that the estimates of the angular correlation function are correlated from bin to bin . </S>",
    "<S> the output of this technique are estimators for the binned power spectrum and a full covariance matrix . </S>",
    "<S> angular correlations mix small and large scales but after the inversion , small scale data can be trivially eliminated , thereby allowing for realistic constraints on theories of large scale structure . </S>",
    "<S> we analyze the apm catalogue as an example , comparing our results with previous results . as a byproduct of these tests , we find  in rough agreement with previous work  that apm places stringent constraints on cold dark matter inspired models , with the shape parameter constrained to be @xmath0 ( using data with wavenumber @xmath1 ) . </S>",
    "<S> this range of allowed values use the full power spectrum covariance matrix , but assumes negligible covariance in the off - diagonal angular correlation error matrix , which is estimated with a large angular resolution of @xmath2degrees ( in the range @xmath2 and @xmath3 degrees ) .    </S>",
    "<S> # 1[eq:#1 ] # 1[eq:#1 ] # 1eq.[[eq:#1 ] ]    # 1to 0pt#1 1n_hi 1dkp_1d(k )    = cmmib10 scaled 1200    -0.5 truein </S>"
  ]
}