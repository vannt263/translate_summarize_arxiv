{
  "article_text": [
    "the broad - line regions ( blrs ) in active galactic nuclei ( agns ) , with sizes of light days to light weeks ( @xcite ) , are too compact to be spatially resolved with the existing telescopes , except in a few cases in which the blrs are magnified by gravitational lensing ( @xcite ) . the reverberation mapping ( rm ) technique provides a powerful , yet unique way to probe structures and kinematics of blrs through analyzing the temporal variation patterns of emission lines and ionizing continuum ( @xcite ) . over the past four decades",
    ", rm studies have successfully measured blr sizes for @xmath0 nearby seyfert galaxies and quasars ( e.g. , @xcite ) .",
    "particularly influential was the discovery that blr sizes intimately correlate with optical luminosities of ( sub - eddington ) agns , as expected from simple photoionization theory ( e.g. , @xcite ) .",
    "this relationship , in combination with the velocity widths of broad emission lines , opens an economic way for virial mass estimation of supermassive black holes ( e.g. , @xcite ) .",
    "meanwhile , velocity - binned rm analysis for several agns with high - quality spectroscopic data crudely see signatures for diverse kinematics in blrs , including radial inflows / outflows and non - radial , virialized kerplerian rotations ( @xcite ) .    notwithstanding these advances ,",
    "the detailed information for structures and kinematics of blrs remain largely unknown .",
    "the major challenges are from rm datasets reliably inferring the transfer function or velocity - delay map and from which obtaining the structure and kinematic information of blrs .",
    "traditional cross - correlation analysis ( e.g. , @xcite ) or the previous method using a simple specified transfer function ( e.g. , @xcite ) yields no more than the characterized blr sizes .        great effort has gone into developing more sophisticated methods .",
    "there are generally two classes of methods depending on the strategy adopted in solving the integral equation that links the variations of continuum and emission lines in rm .",
    "one class relies on directly inverting the integral equation , including early attempts based on the fourier transform ( @xcite ) and regularized linear inversion ( rli ) methods ( @xcite ) .",
    "the former using the fourier transform was found to require high - fidelity data and thus has not seen much application ( @xcite ) , whereas the latter seeks to discretize the integral equation and employ a differencing operator to suppress the noise .",
    "the downside of this class of methods is that the measurement noises can not be self - consistently incorporated and thus may be very noise sensitive in some cases .",
    "the other class relies on indirectly inferring the `` best '' transfer function that fits the data by supposing prior limits or models on it .",
    "the maximum entropy method ( @xcite ) and blr dynamical modeling method ( @xcite ) belong to this class .",
    "the maximum entropy method finds `` simplest '' solutions for the transfer function by maximizing the entropy on the premise of a reasonable fit to the data .",
    "it , however , does not allow for straightforward uncertainty estimate and model selection ( @xcite ) .",
    "the blr dynamical modeling method presumes a specific , but sufficiently flexible toy model for blrs and directly infer the model parameters , therefore , the transfer function is only an intermediate product ( @xcite ) .",
    "it can not yet satisfactorily assess the systematic errors of the adopted model .    in this paper , we describe an extended , non - parametric method to determine the transfer function from rm data , based on the previous works of @xcite and @xcite .",
    "motivated by the scenario that blrs are composed of a large number of clouds so that a local adjacent collection of these clouds effectively respond to the central ionizing continuum as a gaussian response function , we express the transfer function as a sum of a family of relatively displaced gaussian functions .",
    "as such , we can account for arbitrary shapes of the transfer function , therefore , largely relaxing the need of presuming the transfer function ( e.g. , @xcite ) or blr models ( e.g. , @xcite ) . in this",
    "respect our method is model independent and is particularly able to cope with complicated shape of transfer functions ( e.g. , multimodal ) for diverse blr structures and kinematics .",
    "the paper is organized as follows .",
    "we describe the methodology of our approach in detail in section 2 and perform simulation tests in section  3 .",
    "section  4 presents application to three rm agns to illustrate the fidelity of our approach .",
    "discussions and conclusions are given in section  5 .",
    "all the time delays quoted in the text are given in the observer s frame .",
    "in rm , variations of broad emission lines @xmath1 are blurred echoes of continuum variations @xmath2 through the transfer function @xmath3 as ( @xcite ) @xmath4 where the integral limits are set to account for all possible positively and negatively delayed responses ( e.g , @xcite ) . here , we only show velocity - unresolved rm so that velocity information is not included in the transfer function .",
    "however , it is easy to extend our approach to velocity - resolved rm by applying equation  ( [ eqn_line ] ) to different velocity bins of emission lines ( see below for a discussion ) .",
    "in addition , we also neglect the non - linearity of the response for simplicity ( @xcite )",
    ". we will provide a way to incorporate non - linear response below .",
    "mathematically speaking , it is known that an arbitrary function can be expressed as a sum of many slightly - displaced @xmath5functions , namely , @xmath6 , where @xmath7 is the dirac delta function . in practical calculations ,",
    "one instead uses a set of basic functions with spatial extent to describe a smooth function .",
    "a general adoption is gaussian functions which are often found to be adequate ( @xcite , p.140 ) . in this spirit",
    ", the transfer function in rm is now written as @xmath8 ,   \\label{eqn_tf}\\ ] ] where @xmath9 represents the common width of gaussian responses , @xmath10 and @xmath11 are the mean lag and weight of @xmath12th response , and @xmath13 is the number of responses , which can be regarded as a `` smoothing parameter '' .",
    "the gaussian functions are fixed to a common width for the sake of simplicity .",
    "such a choice also helps to relax the parameter degeneracy and improve the computational efficiency of bayesian inference described below .",
    "the physical interpretation for a such expression is straightforward .",
    "the system ( i.e. , blrs ) under consideration is composed of a large number of clouds .",
    "each cloud responds to the variation of the central source as a @xmath5response function .",
    "a collection of these local adjacent clouds effectively produce a gaussian response function with a width .",
    "this is similar to the principle of local optimally emitting cloud model , widely applied in photon - ionization calculations ( @xcite ) .",
    "figure  [ fig_sch_loc ] shows a schematic illustration of the transfer function of blrs . in figure  [ fig_sch ]",
    ", we show examples for three types of blr geometry : a spherical shell , double disk rings , and an inclined disk ring , in which the transfer function is approximated by a family of gaussian functions .",
    "in particular , there is evidence that h@xmath14 blrs have two distinct components ( e.g. , @xcite and references therein ) , indicating that their transfer functions may be bimodal as illustrated in the middle panels of figure  [ fig_sch ] .      with equation  ( [ eqn_tf ] ) , we can directly use the framework developed by @xcite and @xcite to infer the best transfer function .",
    "we stress that all the formulae presented in this section had been well established by @xcite .",
    "we list them below for the sake of completeness .",
    "the continuum variation can be well described by a damped random walk ( drw ) process ( e.g. , @xcite ) .",
    "a drw process is a stationary process so that its covariance function at any two times @xmath15 and @xmath16 only depends on the time difference @xmath17 , which can be simply prescribed as @xmath18 where angle brackets represent statistical ensemble average , @xmath2 is the continuum driven by the drw process , @xmath19 represents the typical damping timescale , and @xmath20 represents the standard deviation of the process on long timescale ( @xmath21 ) . on short timescale ,",
    "the variation amplitude of the process is @xmath22 . combining with equation  ( [ eqn_line ] ) ,",
    "the covariance between the line and the continuum is written @xmath23 and the covariance of the line is @xmath24 d\\tau d\\tau ' . \\label{eqn_cov_ll}\\end{aligned}\\ ] ] in appendices a and b , we present a detailed derivation for the analytical expressions of these covariances in terms of error function .    the bayesian posterior probability is obtained as follows ( see @xcite and @xcite for a thorough derivation ) .",
    "let @xmath25 be a column vector comprised of both the light curves of continuum and line .",
    "a set of measurements in a campaign is equal to a realization of some underlying signals with measurement noises as @xmath26 where @xmath27 is signal of the variations , of which the portion for continuum is described by a drw process , and @xmath28 is the measurement noises . here",
    "the term @xmath29 is usually used to model general linearly varying trends with time in the light curves ( @xcite ) , where @xmath30 is a matrix of known coefficients and @xmath31 is a column vector of unknown linear fitting parameters .",
    "for example , to remove separate means of the light curves with a total of @xmath32 measurements , one just configure @xmath30 to be a @xmath33 matrix , where @xmath34 and @xmath35 are the number of measurements for the continuum and emission line , respectively .",
    "the matrix @xmath30 has entries of @xmath36 for the continuum data points and @xmath37 for the line data points ( @xcite ) .",
    "if one desires to detrend the light curves with long - term secular variations using one - order polynomials , one needs to configure @xmath30 to be a @xmath38 matrix ( see below for details ) . unless stated otherwise ,",
    "we remove the means of light curves by default in following calculations .",
    "the signal @xmath27 and noise @xmath28 are assumed to be gaussian and independent so that their probabilities are simply written as @xmath39 and @xmath40 respectively , where @xmath41 is the covariance matrix of @xmath27 given by equations  ( [ eqn_cov_cc])-([eqn_cov_ll ] ) , and @xmath42 is the covariance matrix of @xmath28 . there is no prior information for the linear fitting parameters @xmath31 and we assign it a uniform prior probability . now",
    "the probability for a realization @xmath25 is @xmath43 d\\mathbi{s}d\\mathbi{n}d\\mathbi{q},\\ ] ] where @xmath44 represents the parameters set for transfer function in equation  ( [ eqn_tf ] ) and the probability @xmath45 is uniform so that it is neglected in the above integral . with some mathematical implementation",
    ", it can be shown that ( @xcite ) @xmath46 where @xmath47 and @xmath48 .",
    "the best estimate for @xmath27 is ( @xcite ) @xmath49 and for the linear fitting parameter @xmath50 the corresponding variance of the best estimate is , respectively , @xmath51 and @xmath52 the best estimate for the light curves is @xmath53 and the corresponding variance is @xmath54 note that equations  ( [ eqn_s ] ) , ( [ eqn_q ] ) , and ( [ eqn_y ] ) also provide a way to estimate the value of the light curves at some specified time that may not be one of the already measured points .    according to the bayes theorem , the posterior probability distribution for the free parameter set is given by @xmath55 where @xmath56 is the marginal likelihood that serves as a normalization factor to the posterior probability and @xmath57 is the prior probability for the parameters .",
    "we maximize this posterior distribution to obtain the best estimate for the free parameters using a markov - chain monte carlo ( mcmc ) method as described in next section .",
    "long - term secular variability is incidentally detected over the duration of the campaign in some rm objects ( e.g. , @xcite ) .",
    "such long - term trends are uncorrelated with reverberation variations and may bias the reverberation analysis ( @xcite ) .",
    "the linear fitting parameter @xmath31 provides a natural way to remove such trends .",
    "if the long - term trends vary linearly with time ( @xmath58 ) , the matrix @xmath30 has a form of ( @xcite ) @xmath59,\\ ] ] where @xmath60 is the @xmath61-th time of the @xmath34 measurement points of the continuum and @xmath62 of the @xmath35 measurement points of the line . in this case , @xmath31 is a column vector with four entries , which , respectively , represent the coefficients of the linear trends for the continuum and line data . for the long - term trends with high - order polynomial variation ,",
    "one can similarly write out the matrix @xmath30 by just adding extra columns . in our calculations , when the light curves of the emission line and the driven continuum visually show different long - term trends , we switch on the detrending procedure by assuming the trends vary linearly with time ( see below for application to the rm data of mrk 817 ) .",
    "the parameters in our approach include : two parameters ( @xmath63 and @xmath64 ) pertaining to the drw process in equation  ( [ eqn_cov_cc ] ) ; @xmath65 parameters ( @xmath11s , @xmath10s , and @xmath9 ) to the transfer function in equation ( [ eqn_tf ] ) .",
    "to relax parameter degeneracy , we introduce following simplifications .    * the central lags @xmath10 of gaussian responses",
    "is assigned by a uniformly spaced grid of time lag over a range of interests , whereas the amplitude @xmath11 is free to be determined .",
    "specifically , we set @xmath66 for @xmath67 , where @xmath68 is the grid space , and @xmath69 is the range of time lag . given with the range of time lag ,",
    "the value of @xmath68 is determined by the number ( @xmath13 ) of gaussian functions , i.e. , @xmath70 .",
    "the degree of freedom is now reduced to @xmath71 . *",
    "the width of gaussian responses @xmath9 is limited by two facts .",
    "if @xmath9 is too small , unnecessary structures in transfer function will become admissible and hence the reconstructed light curves will appear to be unrealistically noisy ; if @xmath9 is too large ( e.g. , @xmath72 ) , the neighboring gaussian responses are indeed indistinguishable . in practice , we found it is adequate to adopt a prior limit of @xmath73 .",
    "the prior probability @xmath57 in equation ( [ eqn_post ] ) is assigned by assuming that all the free parameters are independent with each other .",
    "the gaussian width has a uniform prior and the rest parameters have a logarithmic prior , which is a usual choice for `` scale '' parameters that involve a wide range of values ( e.g. , @xcite , p. 108 ) .    at last ,",
    "we need to choose the number of gaussian response functions . strictly speaking",
    ", one should employ the bayesian model selection to choose the best parameter @xmath13 , i.e. , the one that maximizes the probability @xmath74 .",
    "however , it is very computationally expensive to calculate @xmath74 since one needs to marginalize all the other free parameters . therefore , we resort to the relatively more economic `` non - bayesian '' approaches based on the maximum - likelihood estimate of the parameters ( e.g. , @xcite ) .",
    "we use the akaike information criteria ( aic ; @xcite ) , a measure of the relative quality of statistical models .",
    "the original form of aic is only valid asymptotically ; @xcite proposed a correction to aic for finite sample sizes ( abbreviated to aicc ) .",
    "the aic is defined by @xmath75 where @xmath76 is the number of parameters in the model and hat symbol denotes the best estimate for the corresponding parameter .",
    "the aicc is defined by @xmath77 where @xmath78 is total number of data points .",
    "the best choice of @xmath13 is the one that minimizes the aicc .",
    "we employ an mcmc method to determine the best estimates and uncertainties of free parameters .",
    "we use the metropolis - hastings algorithm to construct samples of free parameters from the posterior probability distribution .",
    "the markov chain is run 150,000 steps in total .",
    "the best estimates of free parameters are assigned the mean values of the samples and the associated uncertainties are assigned the 68.3% confidence levels ( `` 1@xmath63 '' ) that enclose the mean values .",
    "the uncertainties of the final obtained transfer function in equation  ( [ eqn_tf ] ) are determined by the error propagation formulas , under the best inferred @xmath13 .",
    "therefore , the uncertainty in the best inferred @xmath13 is not included .",
    "in order to test our approach , we generate mock light curves of continuum and broad emission line with an assumption of transfer function , and then implement the above procedures to obtain the most probable estimate for the transfer function and compare it with the input one . as outlined by @xcite , an unconstrained realization of mock light curves is simply a random series that has the covariance matrix @xmath47 with specified parameters @xmath63 and @xmath19 .",
    "we generate random numbers with the covariance matrix @xmath79 using the cholesky decomposition ( see @xcite ) .",
    "the cholesky decomposition of a matrix is @xmath80 , where @xmath81 is a lower triangular matrix with real and positive diagonal entries .",
    "if @xmath82 is a series of gaussian random numbers with a zero mean and unity dispersion , then @xmath83 has the covariance matrix of @xmath79 , since @xmath84 .",
    "we first generate a mock continuum light curve and then convolve it with the adopted transfer function to produce a light curve of emission line .",
    "we run three simulation tests by presuming the transfer functions to be composed of    1 .",
    "two displaced top - hats , 2 .",
    "two moderately mixed gaussians ( so that the transfer function is double - peaked ) , and 3 .",
    "two severely mixed gaussians ,    respectively .",
    "the left panels of figure  [ fig_sim ] plot these three input transfer functions .",
    "specifically , for the first test , the two displaced top - hats are ( arbitrarily ) configured to @xmath85 where 1/15 is the normalization factor . for the other two tests ,",
    "the two gaussians are ( arbitrarily ) configured to center at 10 and 18 days for moderately mixed case and 10 and 15 days for severely mixed case , with the same standard deviation of 2.5 days .",
    "the mean time lags for these three transfer functions are 14.2 , 14.0 , and 12.5 days , respectively , roughly corresponding to a 5100   luminosity of @xmath86 according to the relation between blr sizes and 5100   luminosities of agns ( @xcite ) . for the drw model of all the three tests ,",
    "the parameter of damping timescale is set to @xmath87 days , a typical value for a luminosity of @xmath88 ( @xcite ) ; the parameter of the variation amplitude is set to @xmath89 ( in arbitrary units ) such that the resulting variation amplitude is typically @xmath9030 - 50% .",
    "the time span of continuum monitoring is 150 days and the monitoring of emission line starts 20 days latter .",
    "the cadence is typically one day apart .",
    "the signal - to - noise ratio ( s / n ) is set to @xmath90120 .",
    "it is worth stressing that the choice of these values is only for illustrative purposes and has no special meaning .",
    "the left panels of figure  [ fig_sim ] show the generated mock light curves of continuum and emission line for the three simulation tests .    throughout the calculations , the range of time lag",
    "is set to ( 0 - 30 ) days .",
    "since the best number of gaussians is determined by the aicc , the final transfer function is insensitive to the adopted range of time lag , provided it is broad enough to enclose the time lag of the emission line .",
    "the obtained aiccs with the number of gaussian functions @xmath13 for the three tests are illustrated in figure  [ fig_aic ] .",
    "the resulting optimal @xmath13 is 13 , 10 , and 7 , respectively .",
    "this means that the optimal @xmath13 does not depends on the sampling cadence , but on the shape of the transfer function .",
    "the right panels of figure  [ fig_sim ] show the best recovered transfer functions with the optimal @xmath13 .",
    "as can be seen , the structures in the transfer functions are successfully recovered and all the features in the light curves are also well reconstructed . however , we note that , in the first test , we fail to reproduce the top - hat shape because of the finite sampling and measurement errors of the light curves . meanwhile , in the second test , although the recovered two peaks are marginally equal , the left peak seems slightly stronger than the right one .",
    "these tests suggest that , like all rm methods , the performance of the present approach depends on the data quality and the presence of strong variability features in the light curves , therefore , it may be unable to resolve very fine structures of the transfer function in some circumstances .    in the right panels of figure  [ fig_sim ]",
    ", we also superimpose the interpolation cross - correlation function ( ccf ) of the light curves using the procedure of @xcite .",
    "all the ccfs in the three tests are single peaked , indicating that ccf analysis hardly reveals more than the characteristic time lags of blrs . in particular , the ccf in the first test is wide and peaks at @xmath91 day .",
    "this is an appropriate choice for the time lag if one only concentrates on a single characteristic lag for the blr , but clearly a single lag is not sufficient to describe the blr in this case . in appendix c",
    ", we show the time lag distributions from ` javelin ` method for the above three simulation tests . `",
    "javelin ` presumes a top - hat transfer function and the time lag is assigned the mean lag of the top hat .",
    "we illustrate that while the present approach works fairly well in all the three tests , ` javelin ` can not appropriately recover the characteristic lag for the first test with a multimodal transfer function .",
    "line ( in red ) , and right panel compares the best recovered ( in blue ) with the input ( in black ) transfer function .",
    "shaded area represents the estimated uncertainties for the recovered transfer function.,scaledwidth=50.0% ]     but for different cadences . in the top panel ,",
    "the cadence is 1 day apart . in the middle and bottom panels ,",
    "we randomly remove about 1/3 , and 2/3 points , respectively.,scaledwidth=50.0% ]     but for monitoring periods of 150 , 120 , and 90 days.,scaledwidth=50.0% ]      the above simulations show that our approach can generally well reproduce the input transfer function with optimal data quality . in this section ,",
    "we test dependence of the obtained transfer function on data quality with different s / ns , sampling cadences , and time spans of mock light curves .",
    "we only use the double - peaked transfer function for illustration , namely , the one used for the second simulation test in the preceding section .",
    "we fix the seed for the random number generator so that all the mock light curves in this section have the same variation pattern .",
    "this allows us to only focus on the desired factor that influences the obtained transfer function .    in figure",
    "[ fig_sntest ] , we generate three sets of mock light curves with s / n=120 , 80 , and 40 , respectively . as expected ,",
    "when s / n is low enough , the weak variability signals in the light curves are overwhelmed by noises and the information of small structures in the transfer function is missing .",
    "consequently , for the case of s / n=40 ( bottom panels of figure  [ fig_sntest ] ) , we only obtain a single - peaked transfer function , which , however , has the same mean time lag with that of the input one .    to check how the sampling rate affects the results , we respectively randomly remove about one - third and two - thirds points of the light curves with s / n=120 in figure  [ fig_sntest ] and generate two new sets of mock datasets with degraded sampling rates .",
    "we show the light curves and the corresponding best recovered transfer function in figure  [ fig_cadencetest ] . again , when the sampling cadence is poorer , more information on the fine structure of the transfer function is lost .",
    "the default time span of the light curves is 150 days . in figure",
    "[ fig_spantest ] , we reduce the time span to 120 and 90 days , by subtracting the last 30-day and 60-day section of the light curves with s / n=120 in figure  [ fig_sntest ] , respectively . the mean time lag of the input transfer function is 14 days , so that the overall time spans are still more than 6 times the mean lag ( @xcite ) . there is no surprise that the transfer function is well reproduced in all the three cases in figure  [ fig_spantest ] .    in summary",
    ", provided the time span is more than several times the mean time lag of the emission line , s / n and sampling cadence are more critical to recovering the transfer function .",
    "we stress again that the overall performance of the present approach depends on the presence of strong variation features in light curves and the specific structures of the transfer function one desires to resolve .",
    "we therefore can not specify more details about the data requirements for the present approach to faithfully recover the transfer function .",
    "we select three illustrative rm sources to show the feasibility of our approach : arp 151 , sbs  1116 + 583a , and mrk  817 .",
    "the first two objects were monitored by the lick agn monitoring project ( lamp ; @xcite ) and the last object was by @xcite .",
    "the rm data of arp 151 was previously studied in great details by the maximum entropy method ( @xcite ) , blr dynamical modeling method ( @xcite ) , and rli method ( @xcite ) .",
    "this allows us to further verify the validity of our approach .",
    "the transfer function of sbs 1116 + 583a derived by the rli method of @xcite interestingly showed a bimodal distribution , meriting an analysis using our approach .",
    "the object mrk  817 shows long - term secular trends in its light curves ( @xcite ) , therefore adapted to illustrate the capability of our approach to cope with detrending .    to compare our results with those from ccf analysis ,",
    "we define the mean time delay from the transfer function as ( @xcite ) @xmath92 the uncertainty of @xmath93 is calculated by the error propagation formulas .              for the sake of comparison with the previous results , we use the @xmath94band photometric light curve of arp  151 as a surrogate of the continuum as in @xcite and @xcite .",
    "the magnitudes are first converted into fluxes . since the absolute unit of light curves are no longer important for rm analysis",
    ", we adopt an arbitrary zero - magnitude flux for the conversion .",
    "we set the range of time lag for solving the transfer function to be ( 0 - 10 ) days .",
    "the best number of gaussian function is @xmath95 according the aicc criteria .",
    "the top panels of figure  [ fig_example ] present the reconstruction for the light curves of continuum and h@xmath14 line and the best recovered transfer function for arp  151 .",
    "the mean time lag from equation ( [ eqn_lag ] ) is @xmath96 days , consistent with the previous results from ccf analysis @xmath97 days ( @xcite ) and the ` javelin ` method of @xcite @xmath98 days ( @xcite ) .",
    "the transfer function is mainly contributed by the second gaussian component centered at @xmath99 days .    in the top panel of figure  [ fig_tf ] , we compare the transfer function derived in this work with those from rli method ( @xcite ) and from blr dynamical method ( @xcite ) .",
    "our result well matches that from the dynamical modeling method , but differs from the rli result , which has a plateau from zero to about 7 days .",
    "the shape of our obtained transfer function also coincides with that from the maximum entropy method ( see figure  1 in @xcite ) .",
    "same as for arp  151 , we use the @xmath94band photometric light curve for this object .",
    "the range of time lag in the calculations is set to ( 0 - 10 ) days and the best number of gaussian function is @xmath100 according to the aicc criteria . the results are shown in middle panels of figure  [ fig_example ] . the obtained mean time lag is @xmath101 days , which , again , is well consistent with the results based on ccf analysis @xmath102 days ( @xcite ) and ` javelin ` method @xmath103 days ( @xcite ) .",
    "the middle panel of figure  [ fig_tf ] compares the derived transfer functions from various methods .",
    "the rli method yields a bimodal transfer function with a response component around 2 days and an additional component around 8 days ( @xcite ) .",
    "however , both the transfer functions obtained in this work and from the dynamical modeling do not show the second component .",
    "an inspection of the reconstructed h@xmath14 light curves ( see figure 10 in @xcite ) indicates that our results better match the observations .",
    "mrk  817 was monitored as long as five years in @xcite , but only during the intervening three years the h@xmath14 time lags were detected .",
    "we use the first - year section of the light curves with the h@xmath14 time lags detected ( hjd 24,449,000@xmath10424,449,211 ) .",
    "the ccf analysis by @xcite yielded a time lag of @xmath105 days .",
    "the range of time lag in our calculations is set ( 0 - 50 ) days and the best number of gaussian functions is found to be @xmath95 .",
    "it is apparent from a simple visual inspection that the light curves of continuum and h@xmath14 line show different long - term trends , with that of the continuum fluxes decreasing more steeply .",
    "we therefore include the detrending procedure as described in section  2.4 , in which both the trends of continuum and h@xmath14 line are modeled by a linear polynomial .",
    "the results are plotted in the bottom panels of figure  [ fig_example ] .",
    "the transfer function peaks at around 17 days and bears large uncertainties due to poor data sampling .",
    "the resulting mean time lag also has a fairly large uncertainty @xmath106 days .",
    "nevertheless , all the variation features in the light curves are well reproduced .",
    "this object was not ever analyzed by the rli method or the maximum entropy method .",
    "the bottom panel of figure  [ fig_tf ] only shows a comparison of our result with that of the dynamical modeling method .",
    "both the two results are generally consistent , although our result peaks at a slightly shorter time lag .    in our application to the above three rm objects ,",
    "the transfer functions can be effectively modeled by a single gaussian .",
    "as illustrated in section  3.2 , the time resolution of the obtained transfer function is determined by the data sampling and measurement noises of the observations . in a statistical sense based on the aicc criteria , the present solutions are the best ones that balance the trade - off between the goodness of fit and the complexity of our approach .",
    "refining the sampling and signal - to - noise ratio can certainly provide more constraints on the fine structures in transfer functions ( see figure  [ fig_sch ] ) if they are not intrinsically a simple single gaussian .",
    "by extending the previous work of @xcite and @xcite , we describe a non - parametric approach to determine the transfer function in rm .",
    "the basic principle that the transfer function can be expressed as a sum of a family of relatively displaced gaussian functions enables us to largely obviate the need for the presumption of a specified transfer function or blr model as in previous studies .",
    "thus , this to some extent makes our approach model independent .",
    "in addition , following the framework of @xcite , the inclusion of the statistical modeling of continuum variations as a drw process allows us to naturally take into account the measurement errors and make use of the information in observation datasets as much as possible .",
    "application to rm datasets illustrates the fidelity of our approach and its capability to deal with long - term , secular variations in light curves .",
    "in particular , our approach is apt at solving the multimodal transfer functions associated with multiple - component structures of blrs ( e.g. , @xcite ) . not only of blrs",
    ", our approach can also be applied to rm observations of dusty torus in agns ( e.g. , @xcite ) .",
    "since we relax the presumption of a specified transfer function but let its shape be determined by the data , our approach can be regarded as a useful complementary constraint to the blr dynamical modeling ( @xcite ) .",
    "indeed , interpretation of the obtained transfer functions has to invoke physical blr models .",
    "a combination of these two methods may help to remove the concern over the systematic errors in the dynamical modeling . on the other hand , compared with the rli method and the maximum entropy method",
    ", we incorporate the statistical description for both the light curves of continuum and emission line ; therefore , we take full advantage of the information in data and can estimate uncertainties for the obtained transfer function in a self - consistent manner .",
    "we end with discussions on some improvements to be made for our approach in the future .    * throughout our calculations , we have by default assumed a linear response of emission line to the continuum so that the covariance functions of the light curves can be analytically expressed by error function . to include non - linear response ( @xcite )",
    ", we can introduce a new parameter @xmath107 for the emission line fluxes as @xmath108 so that the new flux series @xmath109 now linearly responds to the continuum . * since our approach is based on the statistical modeling of the temporal variations , it is not straightforward to directly include the velocity information .",
    "we can apply our approach to each velocity bin individually ( e.g. , @xcite ) . in this case ,",
    "any correlation information between velocity bins is neglected , thus , the obtained velocity - resolved transfer function may be sometimes noisy along the velocity direction .",
    "it merits a future development of a feasible scheme to self - consistently take into account the velocity information .",
    "* we use the drw process to describe the continuum variations , which is found to be sufficiently adequate for most of current agn variability datasets ( e.g. , @xcite ) .",
    "however , there is evidence that drw process is no longer appropriate on short time scale of days ( ) .",
    "this impedes application of our approach in recovering very fine structures ( on timescale of days ) in the transfer function .",
    "recently , @xcite developed a flexible method that statistically describes the variability by a general continuous - time autoregressive moving average ( carma ) process .",
    "drw process is a special case of carma process . in principle , our approach can also naturally include carma process , but this will make it highly computationally expensive .",
    "we therefore defer this to a future improvement with the parallelization of our approach on supercomputer clusters .",
    "we thank the two referees ( astronomer and statistician ) for useful suggestions that improved the manuscript .",
    "yrl thanks ying zu for useful discussions and andreas skielboe for providing the data of h@xmath14 light curve and their derived transfer function for sbs  1116 + 583a .",
    "this research is supported in part by the strategic priority research program - the emergence of cosmological structures of the chinese academy of sciences , grant no .",
    "xdb09000000 and by nsfc grants nsfc-11173023 , -11133006 , -11233003 , -11303026 , -11573026 , and -u1431228 .",
    "this work has made use of data from the lick agn monitoring project public data release .",
    "we developed a software package ` mica ` ( abbreviated from multiple and inhomogeneous component analysis ) for the present approach , which is available upon request .",
    "99 akaike , h. 1973 , in proceedings of the second international symposium on information theory , ed .",
    "b. petrov & f. csaki ( budapest : akademiai kiado ) , 267 baldwin , j. , ferland , g. , korista , k. , & verner , d.  1995 , , 455 , l119 bentz , m.  c. , denney , k.  d. , grier , c.  j. , et al .",
    "2013 , , 767 , 149 bentz , m.  c. , horne , k. , barth , a.  j. , et al .",
    "2010 , , 720 , l46 bentz , m.  c. , walsh , j.  l. , barth , a.  j. , et al .",
    "2009 , , 705 , 199 blandford , r.  d. , & mckee , c.  f.  1982 , , 255 , 419 brewer , b.  j. , treu , t. , pancoast , a. , et al .",
    "2011 , , 733 , l33 brotherton , m.  s.  1996 , , 102 , 1 denney , k.  d. , peterson , b.  m. , pogge , r.  w. , et al .",
    "2010 , , 721 , 715 du , p. , hu , c. , lu , k .- x .",
    ", et al .",
    "2015 , , 806 , 22 du , p. , lu , k .- x . , hu , c. , et al .",
    "2016 , , 820 , 27 gaskell , c.  m. , & peterson , b.  m.  1987 , , 65 , 1 grier , c.  j. , martini , p. , watson , l.  c. , et al .  2013a , , 773 , 90 grier , c.  j. , peterson , b.  m. , horne , k. , et al .",
    "2013b , , 764 , 47 guerras , e. , mediavilla , e. , jimenez - vicente , j. , et al .",
    "2013 , , 764 , 160 ho , l.  c. , & kim , m.  2015 , , 809 , 123 hooten , m. b. and hobbs , n. t.  2015 , ecological monographs , 85 , 3 horne , k.  1994 , in asp conf .",
    "69 , reverberation mapping of the broad line region in active galactic nuclei , ed .",
    "p. m. gondhalekar , k. horne , & b. m. peterson ( san francisco , ca : asp ) , 23 horne , k. , korista , k.  t. , & goad , m.  r.  2003 , , 339 , 367 hu , c. , wang , j .-",
    ", ho , l.  c. , et al .",
    "2008 , , 683 , l115 hu , c. , wang , j .- m .",
    ", ho , l.  c. , et al .",
    "2012 , , 760 , 126 hurvich , c. m. & tsai , c .-",
    "1989 , biometrika , 76 , 297 kasliwal , v.  p. , vogeley , m.  s. , & richards , g.  t.  2015 , , 451 , 4328 kaspi , s. , maoz , d. , netzer , h. , et al .",
    "2005 , , 629 , 61 kaspi , s. , smith , p.  s. , netzer , h. , et al .",
    "2000 , , 533 , 631 kelly , b.  c. , bechtold , j. , & siemiginowska , a.  2009 , , 698 , 895 kelly , b.  c. , becker , a.  c. , sobolewska , m. , siemiginowska , a. , & uttley , p.  2014",
    ", , 788 , 33 koshida , s. , minezaki , t. , yoshii , y. , et al .",
    "2014 , , 788 , 159 kozlowski , s.  2016 , , in press ( arxiv:1604.01773 ) krolik , j.  h. , & done , c.  1995 , , 440 , 166 li , y .- r . ,",
    "wang , j .- m .",
    ", ho , l.  c. , du , p. , & bai , j .-",
    "2013 , , 779 , 110 macleod , c.  l. , ivezi ,  . ,",
    "kochanek , c.  s. , et al .",
    "2010 , , 721 , 1014 marshall , k. , ryle , w.  t. , & miller , h.  r.  2008 , , 677 , 880 - 883 maoz , d. , netzer , h. , mazeh , t. , et al .",
    "1991 , , 367 , 493 mushotzky , r.  f. , edelson , r. , baumgartner , w. , & gandhi , p.  2011",
    ", , 743 , l12 pancoast , a. , brewer , b.  j. , & treu , t.  2011 , , 730 , 139 pancoast , a. , brewer , b.  j. , & treu , t.  2014a , , 445 , 3055 pancoast , a. , brewer , b.  j. , treu , t. , et al .",
    "2014b , , 445 , 3073 peterson , b.  m.  1993 , , 105 , 247 peterson , b.  m.  2014 , , 183 , 253 peterson , b.  m. , grier , c.  j. , horne , k. , et al .",
    "2014 , , 795 , 149 peterson , b.  m. , wanders , i. , bertram , r. , et al .",
    "1998 , , 501 , 82 rybicki , g. b. , & kleyna , j. t. 1994 , in asp conf .",
    "69 , reverberation mapping of the broad - line region in active galactic nuclei , ed .",
    "p. m. gondhalekar , k. horne , & b. m. peterson ( san francisco , ca : asp ) , 85 rybicki , g.  b. , & press , w.  h.  1992 , , 398 , 169 shappee , b.  j. , prieto , j.  l. , grupe , d. , et al .  2014 , , 788 , 48 sivia , d. s. & skilling , j. 2006 , data analysis : a bayesian tutorial ( new york : oxford univ .",
    "press ) skielboe , a. , pancoast , a. , treu , t. , et al .",
    "2015 , , 454 , 144 sluse , d. , hutsemkers , d. , courbin , f. , meylan , g. , & wambsganss , j.  2012 , , 544 , a62 suganuma , m. , yoshii , y. , kobayashi , y. , et al .",
    "2006 , , 639 , 46 sulentic , j.  w. , marziani , p. , zwitter , t. , dultzin - hacyan , d. , & calvani , m.  2000 , , 545 , l15 vestergaard , m. , & peterson , b.  m.  2006 , , 641 , 689 walsh , j.  l. , minezaki , t. , bentz , m.  c. , et al .",
    "2009 , , 185 , 156 welsh , w.  f.  1999 , , 111 , 1347 zu , y. , kochanek , c.  s. , kozowski , s. , & peterson , b.  m.  2016 , , 819 , 122 zu , y. , kochanek , c.  s. , kozowski , s. , & udalski , a.  2013 , , 765 , 106 zu , y. , kochanek , c.  s. , & peterson , b.  m.  2011 , , 735 , 80",
    "in this appendix , we derive analytical expressions for @xmath110 and @xmath111 in equations  ( [ eqn_cov_lc ] ) and ( [ eqn_cov_ll ] ) . in deriving @xmath110 , for the sake of clarity ,",
    "we denote @xmath112 where @xmath113 represents the contribution to the covariance from the @xmath12th gaussian component .",
    "it is easy to show @xmath114 e^{-(\\tau-\\tau_k)^2/2\\omega^2-|\\tau-\\delta t|/\\tau_d } d\\tau\\nonumber\\\\ & = & \\sqrt{\\frac{\\pi}{2}}\\sigma^2 \\omega f_k e^{\\omega^2/2\\tau_{\\rm d}^2 }   \\left\\{e^{-\\delta t_1/\\tau_{\\rm d } } { \\rm erfc}\\left[-\\frac{1}{\\sqrt{2}}\\left(\\frac{\\delta t_1}{\\omega}-\\frac{\\omega}{\\tau_{\\rm d}}\\right)\\right ] + e^{\\delta t_1/\\tau_{\\rm d}}{\\rm erfc}\\left[\\frac{1}{\\sqrt{2 } } \\left(\\frac{\\delta t_1}{\\omega}+\\frac{\\omega}{\\tau_{\\rm d}}\\right)\\right ] \\right\\},\\end{aligned}\\ ] ] where @xmath115 and @xmath116 is the complementary error function .",
    "similarly , we denote @xmath117 the covariance component @xmath118 is @xmath119 introducing new variables @xmath120 and @xmath121 , we have @xmath122 note that @xmath123 ^ 2 + 2\\left[v-(\\tau_k-\\tau_m)\\right]^2.\\ ] ] the above integral can be rewritten as @xmath124 ^ 2/4\\omega^2 } \\int_{-\\infty}^{\\infty}dv e^{-[v-(\\tau_k-\\tau_m)]^2/4\\omega^2 - |\\delta t - v|/\\tau_{\\rm d}}.\\end{aligned}\\ ] ] the first integration term is @xmath125 ^ 2/4\\omega^2 } du = 2\\sqrt{\\pi}\\omega,\\ ] ] and the second integration term is @xmath126 e^{-[v-(\\tau_k-\\tau_m)]^2/4\\omega^2 - |\\delta t - v|/\\tau_{\\rm d } } dv   = \\sqrt{\\pi}\\omega e^{\\omega^2/\\tau_{\\rm d}^2 }   \\left\\ {     e^{-\\delta t_2/\\tau_{\\rm d}}{\\rm erfc}\\left[-\\frac{\\delta t_2}{2\\omega}+\\frac{\\omega}{\\tau_{\\rm d}}\\right ] + e^{\\delta t_2/\\tau_{\\rm d}}{\\rm erfc}\\left[\\frac{\\delta t_2}{2\\omega}+\\frac{\\omega}{\\tau_{\\rm d}}\\right ] \\right\\},\\end{aligned}\\ ] ] where @xmath127 . as a result , we arrive at @xmath128 + e^{\\delta t_2/\\tau_{\\rm d}}{\\rm erfc}\\left[\\frac{\\delta t_2}{2\\omega}+\\frac{\\omega}{\\tau_{\\rm d}}\\right ] \\right\\}.\\end{aligned}\\ ] ]",
    "the error function is defined as @xmath129 the complementary error function is defined as @xmath130 it is trivial to show that the integrals @xmath131 and @xmath132",
    "the present approach extends the work of @xcite by adopting a more flexible transfer function rather than a specified top - hat transfer function . as such",
    ", we can obtain more than the characteristic time lag and recover complicated structures in transfer function . in figure  [ fig_javelin ] , we run the public package ` javelin ` developed by @xcite on the simulated light curves of the three tests in section  3.1 and plot the obtained top - hat transfer functions and the distributions of the mean time lag of the top - hat .",
    "the recovered transfer functions from our approach and the input transfer functions are also superimposed for comparison . `",
    "javelin ` also employs an mcmc method ( but with a different algorithm ) to determine the best values of the free parameters .",
    "again , we run the markov chain with 150,000 steps .",
    "the time - lag distribution for the first test is bimodal , with the two peaks at 15.53@xmath1330.04 and 16.5@xmath1330.1 days , respectively , and the overall mean lag of 16.2@xmath1330.5 days . here",
    ", the uncertainties are assigned the standard deviations of the distributions .",
    "the two peaks correspond to neither the mean lags of the input two top hats ( 7.5 and 17.5 days ) , nor the overall mean lag ( 14.2 days ) .",
    "the ` javelin ` time lags for the second and third tests are 14.0@xmath1330.2 and 12.5@xmath1330.1 days , respectively , in agreement with the mean lags of the input transfer functions ( 14.0 and 12.5 days ) .",
    "however , for the second test , the time lag does not show the expected double - peak distribution .",
    "by contrast , the present approach works fairly well in all these three cases ( see figure  [ fig_sim ] ) , in terms of recovering both the shape of the transfer functions and the characteristic time lags .",
    "the present approach yields a mean time lag of 14.1@xmath1330.5 , 14.1@xmath1330.9 , and 12.4@xmath1330.5 days for the three tests , respectively , generally consistent with the input values . here",
    ", the uncertainties are calculated by applying the error propagation formulas on equation ( [ eqn_lag ] ) .",
    "we attribute such discrepancies of ` javelin ` to the too simplified top - hat transfer function adopted in the approach , which may encounter difficulties when the transfer function is multimodal and asymmetric .    .",
    "black lines show the input transfer functions .",
    "the transfer functions are adjusted to a common scale .",
    "the inset panels highlight the histograms of the mean time lags of the top hat from ` javelin ` , along with the mean time lags of the transfer functions from the input and our approach , indicated by black vertical lines and red vertical lines with shaded areas , respectively.,title=\"fig:\",scaledwidth=30.0% ] .",
    "black lines show the input transfer functions .",
    "the transfer functions are adjusted to a common scale .",
    "the inset panels highlight the histograms of the mean time lags of the top hat from ` javelin ` , along with the mean time lags of the transfer functions from the input and our approach , indicated by black vertical lines and red vertical lines with shaded areas , respectively.,title=\"fig:\",scaledwidth=30.0% ] .",
    "black lines show the input transfer functions .",
    "the transfer functions are adjusted to a common scale .",
    "the inset panels highlight the histograms of the mean time lags of the top hat from ` javelin ` , along with the mean time lags of the transfer functions from the input and our approach , indicated by black vertical lines and red vertical lines with shaded areas , respectively.,title=\"fig:\",scaledwidth=29.2% ]"
  ],
  "abstract_text": [
    "<S> broad emission lines of active galactic nuclei stem from a spatially extended region ( broad - line region ; blr ) that are composed of discrete clouds and photoionized by the central ionizing continuum . </S>",
    "<S> the temporal behaviors of these emission lines are blurred echoes of the continuum variations ( i.e. , reverberation mapping ; rm ) and directly reflect structures and kinematics information of blrs through the so - called transfer function ( also known as velocity - delay map ) . based on the previous works of @xcite and @xcite </S>",
    "<S> , we develop an extended , non - parametric approach to determine the transfer function for rm data , in which the transfer function is expressed as a sum of a family of relatively - displaced gaussian response functions . as such , arbitrary shapes of transfer functions associated with complicated blr geometry </S>",
    "<S> can be seamlessly included , enabling us to relax the presumption of a specified transfer function frequently adopted in previous studies and to let it be determined by observation data . </S>",
    "<S> we formulate our approach in the previously well - established framework that incorporates the statistical modeling of the continuum variations as a damped random walk process and takes into account the long - term secular variations which are irrelevant to rm signals . application to reverberation mapping data shows fidelity of our approach . </S>"
  ]
}