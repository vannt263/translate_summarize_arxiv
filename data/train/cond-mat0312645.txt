{
  "article_text": [
    "the monte carlo method for classical and quantum lattice models has been improved dramatically since the proposal of the metropolis method@xcite .",
    "the introduction of the extended ensemble , being one of the ideas that enhanced the monte carlo method , is characterized by a random walker traveling in the energy space .",
    "the most well - known methods among the ones based on the extended ensemble is the multicanonical method @xcite . in this method ,",
    "one can obtain the density of states ( dos ) from the histogram of visiting frequency at each value of the energy . since the random walk in the extended ensemble methods",
    "is typically biased in a complicated way , the scaling property of the the traveled distance of the walker deviates from that of the free random walk , i.e. , @xmath0 .",
    "this means that the random - walk nature of the method does not necessarily guarantee a quick equilibration .",
    "however , in many important application , it turns out that the random walker can still travel the whole range of the energy within a reasonable computational time , i.e. , a computational time bounded by some polynomial in the system size .",
    "therefore , the method is quite useful for models that has a first - order phase transition and/or ones that have local minima in the free energy .",
    "in addition , the direct calculation of the dos makes it possible to calculate the absolute value of the free energy of a given system with high precision .",
    "another advantage of this type of approach is that thermal averages of various quantities can be obtained for the whole range of the temperature from only a single run of simulation . while the early versions of extended ensemble methods still suffered from a slow diffusion , even this problem was removed recently by the acceleration method proposed by wang and landau ( wl ) @xcite , in which the random walker is forced to move away whenever it lingers about a place for a long time .    for many important models , classical or quantum",
    ", it was found that the loop / cluster algorithm @xcite is so efficient that the simulation can be done with no ( or negligible ) difficulty of slowing down at any temperature .",
    "however , since the algorithm is originally designed for a simulation at a fixed temperature , one can not obtain from a single run the whole temperature dependence of various quantities nor can one estimate the free energy .",
    "therefore , it is natural to wonder if the loop / cluster algorithm can be used together with the extended ensemble methods .",
    "an apparent obstacle is that the energy in the quantum case is not defined so that constructing a histogram on it is straightforward and meaningful .",
    "janke and kappler proposed@xcite that in the cluster algorithm for classical spin systems one can use the number of graph elements ( such as bonds in the swendsen - wang algorithm ) instead of the energy for constructing the histogram , showing a way for combining the extended ensemble method and the cluster algorithm for classical spin systems .",
    "furthermore , two of the present authors demonstrated@xcite the enhancement of the efficiency achieved with the use of the wl method , and also suggested that the resulting framework can be generalized to quantum systems .",
    "later , the application to the quantum systems was done with a different formulation by troyer , wessel and alet @xcite , who also showed the efficiency of the resulting algorithm .    in the present paper",
    ", we propose that a further improvement can be achieved for quantum models by using the broad - histogram ( bh ) relation for estimating the dos . the idea has been partially described in our previous paper @xcite for the classical models . for the ising models ,",
    "it was pointed out @xcite that a ratio of the densities of states at two neighboring values of the energy can be expressed in terms of the microcanonical averages of the numbers of distinct potential moves . in the application to the ising model ,",
    "the number of potential moves is nothing but the number of spins such that flipping one of them causes a change in the energy by a given amount . since this is a macroscopic quantity , whereas the number of the visits at each value of the energy is not , we can estimate the dos more precisely by using the relation than we do so directly from the histogram . in the case that we discuss here , our dos is not simply the total number of states .",
    "therefore we have to use the generalized form of the transition matrix monte carlo method @xcite . in what follows ,",
    "we describe the method specialized for quantum systems .",
    "the simulation consists of two stages . in the first stage",
    "we perform short runs using the wl method for obtaining a working estimate of the dos . as explained below , each run in the first stage",
    "is characterized by a parameter called the modification factor , which controls the adoptive change of the fictitious weight of the random walk .",
    "a stronger control is imposed on earlier runs whereas a weaker control for the latter runs . because of this adoptively changing weight , the microcanonical ensemble obtained in each run of the first stage deviates from the correct one .",
    "this leads to some systematic error .",
    "however , we need unbiased estimates of microcanonical averages@xcite because we use them for obtaining the dos from the bh relation .",
    "therefore , in the second stage we perform a single long run with the weight fixed to the one obtained in the first stage .",
    "this is in contrast to the ordinary wl method where the outcome of the first stage is taken as the final estimate of the dos .",
    "the organization of the whole simulation is schematically depicted in fig .  [",
    "fig : simulation ] .",
    "we will show this two - stage procedure gives more precise results for quantum systems than the one - stage procedure of the wl method described in @xcite , within the same amount of the total cpu time .",
    "a little more specifically , the whole simulation can be described as follows .",
    "we construct a histogram of the expansion order or the number of active vertices , which we denote as @xmath1 , instead of the histogram of the energy . accordingly",
    ", the fictitious weight @xmath2 is introduced as a function of @xmath1 , rather than the energy .",
    "the monte carlo dynamics is defined so that the detailed balance holds for this weight .",
    "we start the first run of the first stage by setting the weight @xmath2 to be constant , i.e. , @xmath3 for all @xmath1 . at the beginning of each run , the counter ( or the histogram ) , @xmath4 , of visits to the value @xmath1 is set to be 0 while @xmath2 is not reset except at the beginning of the first run . for the @xmath5-th run we use the modification factor @xmath6 . every time the random walker visit a state with @xmath7 , @xmath2 is replaced by @xmath8 in order to penalize the random walker staying at this value of @xmath1 . at the same time",
    ", @xmath4 is increased by one .",
    "the @xmath5-th run is terminated when the histogram becomes flat . to be specific ,",
    "the flatness condition is @xmath9 for all @xmath1 .",
    "since the first stage is only for obtaining a working estimate of the dos , we stop when @xmath10 whereas in the original wl method @xmath11 was used instead . at the end of the first stage",
    ", @xmath12 is approximately proportional to the generalized dos discussed below . in the second stage",
    ", we do the same as the first stage but with a longer run and with @xmath2 fixed to be the result of the first stage . in this way",
    ", we can compute non - biased microcanonical averages of various quantities in the second stage .    in both the first and the second stages , the update of the configuration",
    "is done using the loop update if the update does not involve a change in @xmath1 .",
    "other similar algorithms such as the directed loop algorithm @xcite can be used as well , and the generalization is straight - forward .",
    "the choice , however , is only of the secondary importance for the applications to the models without the magnetic field as considered in the present paper . for the loop algorithm",
    ", there are two formulations ; one is based on the continuous imaginary time and the other is the discrete imaginary time . although the difference in the efficiencies of two formulations is minor , in the present paper we have used the discrete time formulation following troyer , wessel and alet@xcite . in what follows , we reformulate their algorithm , use it for deriving the bh relation , and describe how the relation is used in the second stage of the simulation .",
    "the systematic error due to the discretization in the discrete time formulation can be removed by starting from the high - temperature series expansion @xcite rather than the path - integral representation .",
    "therefore , we start with expressing the partition function @xmath13 as a high - temperature series expansion truncated at the @xmath14-th order , @xmath15 where @xmath16 is inverse temperature @xmath17 , @xmath18 is boltzmann s constant , and @xmath19 is a variable that takes on @xmath20 or @xmath21 .",
    "the high - temperature expansion coefficient , @xmath22 , is here regarded as the generalized dos for the series order @xmath1 . when the hamiltonian is expressed as a sum of @xmath23 local interaction terms as @xmath24 ,",
    "the generalized dos is given by @xmath25 we can simplify the notation by defining a _",
    "vertex _ , @xmath26 , as a pair of indices @xmath27 and @xmath28 , i.e. , @xmath29 .",
    "several other symbols are also introduced for simplification of the notation : @xmath30 , @xmath31 , @xmath32 , @xmath33 , @xmath34 , and @xmath35 . as a result",
    ", we can rewrite the generalized dos as @xmath36 where @xmath37 here , @xmath38 . by comparing these expressions to those in",
    "@xcite it is natural to identify @xmath1 as the number of graph elements .",
    "here we call a vertex @xmath26 for which @xmath39 an _ active _ vertex .",
    "we then replace the factor @xmath40 in ( [ partition ] ) by an adjustable function @xmath2 , which makes the simulated partition function to be @xmath41 with the weight of the state @xmath42 being @xmath43 in the first stage , the function @xmath2 is adaptively modified so that the probability of having @xmath44 to be independent of @xmath1 .",
    "in other words , in the first stage we try to make @xmath45 constant by adjusting @xmath2 .",
    "this goal is achieved by the use of the wl method . as a result",
    ", we obtain @xmath22 as the inverse of @xmath2 .",
    "the algorithm used for updating @xmath42 can be viewed as the dual monte carlo @xcite .",
    "namely , by regarding the variable @xmath46 as a graph element , analogous to the bond in the swendsen - wang algorithm , one can establish a correspondence between the present algorithm and the swendsen - wang algorithm .",
    "one step in a dual monte carlo simulation consists of two phases ; the `` graph '' @xmath47 is updated in the first phase with `` spin configuration '' @xmath48 being fixed and the @xmath48 is updated in the second phase with fixed @xmath47 . while the first phase changes @xmath1 , the latter does not . in what follows ,",
    "we describe updating of @xmath47 and show how to estimate @xmath22 based on estimates of macroscopic quantities .",
    "the second phase , i.e. , how the update @xmath48 with fixed @xmath1 , is described in the next section .    in order to relate @xmath22 to the microcanonical averages of some macroscopic quantities , we consider an arbitrary function @xmath49 that satisfies @xmath50 while @xmath49 could be the transition probability from @xmath42 to @xmath51 , in which case the above equation is nothing but the detailed balance condition",
    ", it does not have to be so for the derivation of the bh relation .",
    "we sum up each side of the above equation over such @xmath42 and @xmath51 that @xmath7 and @xmath52 , yielding @xmath53 where @xmath54 and @xmath55 is the microcanonical average , i.e. , @xmath56 for the derivation of the bh relation , we only have to consider the case where @xmath51 and @xmath42 have the same spin configuration @xmath48 in common .",
    "then , the procedure for generating @xmath57 from @xmath58 is as follows :    1 . : :    generate an integer @xmath27 ( @xmath59 )    uniform - randomly .",
    "2 . : :    if @xmath60 , generate an integer @xmath28    ( @xmath61 ) uniform - randomly , and change    @xmath47 into    @xmath62 ( i.e. , activate    @xmath26 ) with the probability @xmath63 where    @xmath64 .",
    "2. : :    if @xmath65 , change @xmath47 into    @xmath66 ( i.e. , inactivate    @xmath26 ) with the probability @xmath67 where    @xmath26 is the vertex @xmath68 such that    @xmath69 .",
    "3 . : :    repeat 1 and 2 ( or 2 ) @xmath70 times .    the overall transition probability corresponding to one repetition of 1 and 2 ( or 2 ) can be written in the form of the transition matrix as @xmath71 where some kronecker s delta s have been written as @xmath72 instead of @xmath73 for clarity . in order for this transition probability to satisfy ( [ eq : detailedbalance ] ) with ( [ eq : w ] ) and ( [ eq : u ] )",
    ", @xmath74 must satisfy @xmath75 where @xmath76 and @xmath26 is the vertex at which @xmath42 and @xmath51 differ from each other .",
    "the simplest choice is @xmath77 note here that we do not have to make @xmath74 smaller than 1 if we only need to make @xmath49 satisfy ( [ eq : detailedbalance ] ) and if @xmath78 does not have to be a real transition matrix . since this is the case for obtaining the bh relation , we shall forget about the condition @xmath79 for a time being . with ( [ eq : activationprobability ] ) , @xmath80 and @xmath81 become @xmath82 and @xmath83 where @xmath84 is the number of kinks , i.e. , the vertices at which @xmath85 .",
    "thus we obtain from ( [ eq : generalbhrelation ] ) for @xmath86 , @xmath87 we call this relation the bh relation for quantum systems . when multiplied @xmath88 for @xmath89 , this yields @xmath90 where @xmath91 has been used .",
    "note that the validity of ( [ eq : bhrelation ] ) and ( [ eq : theestimator ] ) does not depend on what transition probability we use in the simulation although we have used a particular form of it in deriving the relation ( [ eq : bhrelation ] ) .",
    "therefore , we can use any algorithm to estimate the dos as long as it produces the correct microcanonical ensemble .",
    "in fact , since we have not guaranteed that @xmath92 above in ( [ eq : activationprobability ] ) , @xmath49 mentioned above may not serve as the transition probability . to obtain the real transition probability , we simply replace ( [ eq : activationprobability ] ) by @xmath93 with @xmath94",
    "this is the transition probability that is actually used in the simulation presented below .",
    "we now turn to the second phase in which the state @xmath95 is updated to @xmath96 with @xmath47 fixed .",
    "this can be done by either of the loop algorithm or the worm - type algorithm .",
    "we here adopt the loop type update @xcite .",
    "the weight with which @xmath48 must be sampled is @xmath97 . following the general framework of the loop algorithm we decompose the weight at every active vertex @xmath26 in @xmath47 as @xmath98 where @xmath99 is a graph and @xmath100 is the function that takes on @xmath20 or @xmath21 depending on the matching between @xmath101 and @xmath99 .",
    "the readers are referred to ref.@xcite for the details of the graphs and the @xmath102-functions .",
    "here we only show an example for the compactness of the description . in the case of the @xmath103 antiferromagnetic heisenberg model ,",
    "the decomposition consists of a single term since the local hamiltonian can be expressed as a single delta function . @xmath104 where @xmath105 is a _ horizontal graph _ that consists of two horizontal lines connecting @xmath106 to @xmath107 and @xmath108 to @xmath109 . the function @xmath110 is defined for @xmath111 as @xmath112 here we have assumed that the state @xmath113 is the simultaneous eigenstate of all the @xmath114-components of spins .",
    "namely , @xmath115 @xmath116 denotes the eigenvalue of @xmath117 of the eigenstate @xmath113 .",
    "therefore , the update is done by placing horizontal graphs on all the vertices in @xmath47 , and connect the end points of horizontal lines by vertical lines to form loops , then finally flip every loop with probability 1/2 .",
    "the generalization to the case where the expansion of the hamiltonian ( [ eq : decomposition ] ) consists of multiple terms is straight - forward .",
    "in such a case , we simply choose a graph from the ones for which @xmath118 with the probability proportional to @xmath119 .",
    "in order to see if the present procedure yields better statistics than previous methods , we calculate the spin-1/2 antiferromagnetic heisenberg chain of ten sites .",
    "we set the initial value of the modification factor to @xmath120 for the whole calculation in the paper .",
    "( for an appropriate initial value of the modification factor , see the discussions in the references@xcite . )",
    "we set the cut off @xmath14 to be 500 .",
    "this limits the accessible temperature range to @xmath121 . in the first stage , it takes approximately @xmath122 monte carlo steps ( mcs ) before the last run with @xmath10 terminates . in the second stage of simulation , we fix @xmath2 and let the random walker travel for @xmath123 mcs . the final estimate of the dos is shown in fig .",
    "[ fig : fig1 ] .    by using the dos in fig .",
    "[ fig : fig1 ] , canonical ( fixed - temperature ) averages of the energy , the specific heat , the free energy , and the entropy are calculated as functions of temperature .    in fig .",
    "[ fig : fig2 ] , we show the relative error in the free energy , @xmath124    the top solid line is the one that is obtained based on the working estimate of @xmath22 resulting from the first stage that takes about @xmath122 sweeps .",
    "the bottom dashed line represent the one based on the final estimate of @xmath22 obtained from the second stage using the estimator ( [ eq : theestimator ] ) .",
    "the middle dotted line also represent the free energy based on the second stage data but without using the estimator ( [ eq : theestimator ] ) .",
    "this corresponds to the standard procedure of the multicanonical simulation @xcite .",
    "namely , the middle curve is based on the naive estimate of the dos using the histogram itself , i.e. , the estimate using the relation @xmath125 where @xmath126 is the trial dos estimated in the first stage and @xmath4 is the number of visits to the value @xmath1 counted during the second stage simulation .",
    "the difference between the middle curve and the bottom one is as much as 1 to 2 orders of magnitude , and it clearly shows the utility of the estimator ( [ eq : theestimator ] ) .",
    "the horizontal dashed line indicates the level of the largest error of the previous simulation by troyer , wessel and alet@xcite for the same system with the same size .",
    "the number of monte carlo sweeps performed in their simulation was the same as the second stage of our simulation .",
    "it is natural that their result is about the same position as the worst ( i.e. , the highest ) point in the middle curve , since the last few runs in the wl method , where the modification factor is very close to one , are almost equivalent to the ordinary multicanonical simulation with fixed weight .    in order to see the system - size dependence of the efficiency , we calculate the standard deviation @xmath127 of the specific heat per site at temperature @xmath128 for various system sizes . again , we compare three results : ( 1 ) the one based on a wl method only with the termination condition @xmath11 ( denoted as `` wang - landau '' in the figure ) , ( 2 ) the one based on the two stage simulation with the termination condition @xmath10 for the first stage and with the naive estimation of the dos using the histogram itself in the second stage ( denoted as `` multicanonical '' ) , and ( 3 ) the same as the above but with the estimator ( [ eq : theestimator ] ) ( denoted as `` broad histogram '' ) . in ( 2 ) and ( 3 ) , the total number of monte carlo sweeps are chosen to be the same as that is spent in ( 1 ) in order to make the comparison fair .",
    "we choose @xmath14 and @xmath23 so that @xmath129 is fixed . with this choice",
    "the accessible temperature range is @xmath121 .",
    "40 independent sets are performed for @xmath130 whereas 12 for @xmath131 .",
    "the results are shown in fig .",
    "[ fig : fig3 ] .",
    "the system size dependence is small .",
    "the results of the wl algorithm and the naive estimate of the dos based on the two - stage simulation are close to each other again .",
    "the proposed method outperforms the other method by more than an order of magnitude in all the cases studied here .",
    "generalizing the histogram methods@xcite based on the graph representation , we have presented a monte carlo method for quantum lattice models that consists of two stages . for the method s performance , the generalized broad histogram relation ( [ eq : bhrelation ] ) , proved for quantum systems , is crucial . in the first stage ,",
    "the wl method is employed as in @xcite for obtaining the working estimate of the dos with a short cpu time . in the second stage ,",
    "microcanonical averages are computed and the final estimate of the dos is obtained from them through the use of the generalized bh relation . in both the stages , the update of the states are performed by loop algorithm .",
    "we have demonstrated that the proposed method yields very accurate estimates of the dos in the case of the @xmath103 antiferromagnetic heisenberg model , which we believe to be a typical case that represents many other cases . in ref .",
    "@xcite , an alternative usage of the extended ensemble method was proposed in which one takes the series expansion not in @xmath16 but in other coupling constants .",
    "this type of extension is also available in the present method .",
    "we thank m.  troyer , s.  wessel and f.  alet for comments and the exact diagonalization results that were useful for the error estimation .",
    "we are also grateful to k.  harada , h.  otsuka , y.  tomita , and t.  surungan for useful comments .",
    "c.y . thanks t.  horiguchi , y.  fukui , k.  tanaka , k.  katayama , n.  yoshiike , and t.  omori for useful comments .",
    "n.k.s work was supported by the grant - in - aid ( program no.14540361 ) from monka - sho , japan .",
    "999 n. metropolis , a. rosenbluth , m. rosenbluth , a. teller , and e. teller , j. chem . phys .",
    "* 21 * , 1087 ( 1953 ) .",
    "b. a. berg and t. neuhaus , phys .",
    "b * 267 * , 249 ( 1991 ) .",
    "j. lee , phys .",
    "lett . * 71 * , 211 ( 1993 ) .",
    "f. wang and d. p. landau , phys .",
    ". lett . * 86 * , 2050 ( 2001 ) ; phys .",
    "e * 64 * , 056101 ( 2001 ) .",
    "h. g. evertz , in _ numerical methods for lattice quantum many - body problems _ , edited by d. j. scalapino ( perseus books , cambridge , 2001 ) .",
    "r.  swendsen and j .- s .",
    "wang , phys .",
    "* 58 * , 86 ( 1987 ) .",
    "w. janke and s. kappler , phys .",
    "* 74 * , 212 ( 1995 ) . c. yamaguchi , n. kawashima , phys .",
    "e * 65 * , 056710 ( 2002 ) .",
    "m. troyer , s. wessel , and f. alet phys .",
    "lett . * 90 * , 120201 ( 2003 ) . c. yamaguchi , n. kawashima , and y. okabe , phys .",
    "e * 66 * , 036704 ( 2002 ) .",
    "m. c. de oliveira , t. j. p. penna , and h. j. herrmann , braz .",
    "* 26 * , 677 ( 1996 ) ; eur .",
    ". j. b * 1 * , 205 ( 1998 ) .",
    "wang , t. k. tay and r. h. swendsen , phys .",
    "* 82 * , 476 ( 1999 ) . throughout this paper",
    ", we refer to the average with a fixed number of graphs as well as the one with a fixed value of the energy as a microcanonical average . o. f. syljusen and a. w. sandvik , phys .",
    "e * 66 * , 046701 ( 2002 ) .",
    "a. w. sandvik and j. kurkijarvi , phys .",
    "b * 43 * , 5950 ( 1991 ) ; a. w. sandvik , j. phys .",
    "a * 25 * , 3667 ( 1992 ) .",
    "d.  kandel and e.  domany , phys .",
    "b , * 43 * , 8539 ( 1991 ) . n.  kawashima and j.  gubernatis , phys .",
    "e * 51 * , 1527 ( 1995 ) .",
    "a. w. sandvik , phys .",
    "b * 59 * , r14157 ( 1999 )",
    ". n.  kawashima and j.  gubernatis , j.  stat .",
    "phys .  * 80 * , 169 ( 1995 ) ; n.  kawashima , j.  stat .",
    "phys .  * 82 * , 131 ( 1996 ) ."
  ],
  "abstract_text": [
    "<S> we propose an efficient method for monte carlo simulation of quantum lattice models . </S>",
    "<S> unlike most other quantum monte carlo methods , a single run of the proposed method yields the free energy and the entropy with high precision for the whole range of temperature . </S>",
    "<S> the method is based on several recent findings in monte carlo techniques , such as the loop algorithm and the transition matrix monte carlo method . in particular , we derive an exact relation between the dos and the expectation value of the transition probability for quantum systems , which turns out to be useful in reducing the statistical errors in various estimates . </S>"
  ]
}