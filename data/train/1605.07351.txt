{
  "article_text": [
    "the @xmath0 approach within many - body perturbation theory ( mbpt ) @xcite has become a standard tool for studying single - particle excitations in condensed - matter physics.@xcite owing to increasing computing power and advances in algorithms , this method has been applied for a wide range of problems that includes band structures of molecules ,  @xcite two-@xcite and three - dimensional  @xcite crystalline materials , and even molecules in aqueous solutions  @xcite and water / semiconductor interfaces .",
    "@xcite    despite the overall success of the @xmath0 approach , there are issues of both theoretical and numerical nature .",
    "these issues begin with the question how to carry out @xmath0 calculations in practice .",
    "the original prescription of hedin@xcite implies a self - consistent calculation of quasiparticle ( qp ) energies , while the modern pragmatic approach known as single - shot @xmath0 , or simply @xmath1 , abandons this self - consistency and is applied as a perturbative correction to kohn - sham ( ks )  @xcite or hartree - fock ( hf ) results .",
    "the @xmath1 approximation is particularly attractive , because it requires a reduced computational effort compared to the self - consistent @xmath0 , yet @xmath1 quasiparticle gaps are in a good agreement with experiment .",
    "@xcite unfortunately , @xmath1 has a dependence on the ks or hf reference  @xcite what is known as the _ starting - point problem_. this ambiguity can be resolved by using the reference that minimizes the @xmath1 correction .",
    "@xcite the @xmath0 approach as such neglects all vertex contributions to the self - energy , and there have been attempts to restore them .",
    "@xcite each conceptual advance is aimed at approaching the exact limit of qp energies . however , a quantitative comparison of different levels of theory is worthless if the numerical procedure is not sufficiently reliable .",
    "numerical issues arise in particular from the unfavorable computational scaling of the @xmath0 method , and the slow convergence of the correlation part of the self - energy with respect to the number of unoccupied states makes it difficult to obtain reliable results .",
    "this slow convergence stems from the short - range electron correlation and is related to similar issues in quantum - chemistry methods highlighted in ref .  .",
    "yet , there are just a few works  @xcite where this fact was explicitly taken into account in order to approach the numerically exact limit of quasiparticle energies or their differences .",
    "several methods to circumvent the slow convergence with respect to the number of unoccupied states have been developed.@xcite all of them introduce new approximations and numerical algorithms , which should be validated on a large test set and confronted to each other .    a recent paper by klime _",
    "et al . _",
    "@xcite contains reference - quality @xmath1 data for a range of semiconductors . however , their calculation relies on the projector - augmented waves ( paw ) method  @xcite which introduces additional numerical uncertainties due to pseudization .",
    "this problem is absent in the all - electron full - potential linearized - augmented planewaves ( flapw ) method , which is regarded as the reference method in condensed - matter physics .",
    "friedrich and coworkers have demonstrated an extrapolation procedure for estimating the exact @xmath1 limit for the band gap in wurtzite zno based on the flapw method ,  @xcite but they have not applied it to other materials . during the preparation of our manuscript , jiang and blaha have published an article  @xcite in the spirit of the latter work .    in this paper , we show how to construct a basis suitable for excited - state flapw calculations and conduct systematic studies on how to reach convergence of quasiparticle energies with respect to the basis size . we provide an interpretation of the exceptional importance of local orbitals in qp calculations utilizing the flapw basis and show @xmath1 quasiparticle energies of benchmark quality for a set of materials .",
    "binding energies of semi - core @xmath2-states are also reported .",
    "all calculations are carried out by the exciting  code .",
    "the paper is organized as follows .",
    "the @xmath1 method is sketched in sec .",
    "[ sec : gw ] . computational details regarding the all - electron basis used in this work and our @xmath1 implementation are described in sec .",
    "[ sec : flapw ] .",
    "the convergence of the qp gap in wurtzite zno , that is considered as a most challenging material , is studied in sec .",
    "[ sec : zno - tests ] .",
    "we reexamine the extrapolation technique suggested by friedrich@xcite and propose an alternative procedure for estimating the exact @xmath1 limit of qp energies . in sec .",
    "[ sec : bandgaps ] , we present @xmath1 qp energies for 16 semiconductors and wide - gap insulators .",
    "we confront results based on _ default _ and _ accurate _ basis sets .",
    "our results are finally compared to corresponding values of ref .",
    "obtained within the paw method .",
    "the quasiparticle energies within the @xmath1 approximation are given as a solution of the linearized qp equation@xcite as @xmath3\\;,\\end{aligned}\\ ] ] where @xmath4 are the kohn - sham ( ks ) eigenvalues , @xmath5 and @xmath6 are the diagonal matrix elements of the self - energy and the exchange - correlation ( xc ) potential that is employed in the single - particle ks hamiltonian .",
    "the qp renormalization factor @xmath7 accounts for the energy dependence of the self - energy .",
    "the non - local and energy - dependent self - energy @xmath8 is given by @xmath9 where @xmath10 is the non - interacting single - particle green function obtained from the kohn - sham states @xmath11 with @xmath12 and @xmath13 being an infinitesimal positive number .",
    "the dynamically screened coulomb potential @xmath14 is determined by @xmath15 where @xmath16 is the bare coulomb potential and @xmath17 is the dielectric function calculated as @xmath18 @xmath19 is the irreducible polarizability evaluated in the random - phase approximation @xmath20 with @xmath21 \\\\\\nonumber & \\left\\{\\frac{1}{\\omega-\\epsilon_{m\\mathbf{k}'}+\\epsilon_{n\\mathbf{k}}+i\\eta } - \\frac{1}{\\omega+\\epsilon_{m\\mathbf{k}'}-\\epsilon_{n\\mathbf{k}}-i\\eta } \\right\\},\\end{aligned}\\ ] ] where @xmath22 is the occupation number of the state @xmath23 and the factor of 2 accounts for spin degeneracy .",
    "our calculations employ the linearized augmented planewaves + local orbitals ( lapw+lo ) basis  @xcite as implemented in the exciting code.@xcite in this method , the unit cell is partitioned into the muffin - tin ( _ mt _ ) and interstitial ( _ i _ ) regions .",
    "the lapw part of the basis is determined as @xmath24 where @xmath25 refers to a sphere with radius @xmath26 that is centered at the position @xmath27 ( @xmath28 ) of atom @xmath29 .",
    "the @xmath30 part of @xmath31 is expanded in terms of spherical harmonics @xmath32 and radial functions @xmath33 .",
    "the latter are solutions of the radial scalar - relativistic schrdinger equation at fixed reference energies @xmath34 ( linearization energies ) inside each @xmath30 employing a spherically averaged kohn - sham effective potential .",
    "the index @xmath35 accounts for different types of radial functions , which are either @xmath36 or @xmath37 .",
    "the augmentation coefficients @xmath38 ( @xmath35=1,2 in the lapw method ) are chosen to make @xmath31 continuous and smooth at the sphere boundary .",
    "the lapw basis set is complemented with functions @xmath39 @xcite , local orbitals , which are strictly zero everywhere , except for a certain @xmath30 sphere : @xmath40 \\;y_{lm}(\\hat{\\mathbf{r}}_\\alpha).\\ ] ] generally , @xmath41 and @xmath42 can be any smooth radial functions , but in the present work , we employ @xmath36 and their energy derivatives . the coefficients @xmath43 and @xmath44 are determined to turn the local orbital to zero at the @xmath30 boundary and to fulfill the normalization condition @xmath45 .    in the present work ,",
    "we construct two setups of local orbitals for each element in every system .",
    "the first one contains a small number of lo s , suitable for ground state calculations ( we will refer to it as `` _ default _ '' thereafter ) .",
    "for example , for computing zno , it contains 4 @xmath46- , 4 @xmath47- and 2 @xmath2-shells of local orbitals for the zink atom and 2 @xmath46- and 2 @xmath47-shells for oxygen .",
    "the second setup ( labeled as `` _ optimized _ '' ) is constructed with the aim of very accurately describing unoccupied states . in practical calculations ,",
    "we use local orbitals with @xmath48 up to 8 and @xmath49  ha . with these limits , zn and o atoms with @xmath30 radii of 1.6  @xmath50 are described with 6 @xmath46- , 7 @xmath47- , 7 @xmath2- , 7 @xmath51- , 6 @xmath52- , 6 @xmath53- , 5 @xmath54- , 5 @xmath55- and 5 @xmath56-shells of local orbitals .",
    "more details on the construction of local orbitals are given in the appendix  [ app : losetups ] .",
    "for comparison , the setup used in ref .",
    "consists of 5 @xmath46- , 5 @xmath47- , 5 @xmath2- , 5 @xmath51- , 3 @xmath52- , 2 @xmath53- and 1 @xmath54-shells for zn and 4 @xmath46- , 4 @xmath47- , 4 @xmath2- , 4 @xmath51- , 2 @xmath52- and 1 @xmath53-shells for o.      our @xmath1 implementation employs an auxiliary mixed product basis@xcite ( mb ) which provides a highly flexible representation of the polarizability , the dielectric function , and other non - local quantities .",
    "moreover , the usage of the mb allows us to convert the expressions eqs .",
    " into a computationally tractable matrix form .",
    "due to the dual nature of the lapw+lo basis , the mb consists of spherical harmonics and planewaves within @xmath30 s and @xmath57 , respectively .",
    "an optimal set of these mb functions , @xmath58 , accurately represents a product of two ks wave functions such as @xmath59 where , @xmath60 are the expansion coefficients and @xmath61 .",
    "the quality of the mixed basis , in analogy to the lapw+lo basis , is controlled by setting the maximal angular momentum for the spherical - harmonics expansion , @xmath62 , and the number of planewaves according to the cutoff parameter @xmath63 . to exclude any effects connected with the representation of the non - local operators",
    ", we have chosen rather high values of @xmath64 and @xmath65 in our calculations .    the number of the empty states , the size of @xmath66 and @xmath67 grids , and the number of frequencies used to represent the correlation self - energy and to calculate the convolution integral ( eq .",
    "[ eq : gw : selfe ] ) are the most important computational parameters . according to previous studies,@xcite the @xmath68-grid convergence",
    "is found to be independent of the convergence w.  r.  t. the number of the empty states . based on our convergence tests ( see appendix  [ app : kqtest ] , for the purpose of computational efficiency , we perform the @xmath1 calculations for a large number of empty states on a coarse grid ( _ e.g. _ , @xmath69 or @xmath70 ) .",
    "the values for denser @xmath68-grids are then extrapolated by applying a constant shift that is devised from @xmath68-grid convergence tests for a small number of empty states ( typically 200 ) .",
    "we find that results obtained with this procedure and a direct calculation employing a dense grid agree within 50 mev .",
    "polarizability , screened coulomb potential , and correlation self - energy are calculated on a non - uniform grid of 32 imaginary frequencies .",
    "as the final step , the qp energies ( eq .  ) are calculated employing the pad - approximant method@xcite for the analytical continuation .",
    "further technical details on our implementation can be found in refs .  .",
    "the calculation of @xmath71 is a computationally demanding process , as it involves two summations over states .",
    "these sums appear in eqs .   and and formally include an infinite number of unoccupied bands . the common practice , however , is to consider a relatively small number of unoccupied bands .",
    "such a simplification makes @xmath1 affordable for a wide range of applications .",
    "however , the truncation inevitably introduces an error as it asymptotically decays as @xmath72 where @xmath73 is the number of unoccupied bands .",
    "the slow decay originates from a two - electron coalescence ; see refs .   for a detailed discussion .    as the behavior of @xmath74",
    "is known , one naturally attempts to estimate the limit of the quasiparticle - energy by extrapolating @xmath75 to infinite @xmath73 .",
    "such an approach was used by friedrich and coworkers in ref .  .",
    "their extrapolation procedure required a calculation of qp gaps @xmath76 for a range of @xmath73 .",
    "the obtained data were then fitted to the expression @xmath77 where @xmath78 , @xmath79 , and @xmath80 are fit parameters .",
    "is consistent with eq .  , and we adopt this procedure in this section .    it was also shown in ref .",
    "that quasiparticle calculations follow eqs .   and only if the unoccupied states in the considered range are described accurately enough .",
    "thus , it is crucially important to employ a sufficiently flexible basis . in order to do so , we expand the basis as described in sec .  [",
    "sec : flapw ] and appendix  [ app : losetups ] . in this work",
    ", all groundstate calculations are performed in the local - density approximation ( lda ) .",
    "@xcite the resulting ks spectrum is shown in fig .",
    "[ fig : ks - lapw - vs - lapwlo ] and compared to the that of the _ default _ settings . while the setups designed for the ground state on the one hand , and unoccupied states on the other hand produce nearly identical ks energies for the first hundred states , the difference is substantial for high - lying states . although , the two curves look qualitatively similar , both behaving roughly as @xmath81 , the energies of the 2000th unoccupied state differ by @xmath82  ha ( @xmath83 ) .",
    "( color online ) wurtzite zno ks eigenenergies at the @xmath84-point .",
    "the black curve corresponds to a calculation with the set of local orbitals defined in table  [ tab : lo ] , while the red one is obtained combining the latter basis with local orbitals for unoccupied states as defined in table  [ tab : xslo ] . ]",
    "despite the seemingly small impact on the ks spectrum , the additional local orbitals introduce a dramatic change in the qp gap of zno as shown in fig .",
    "[ fig : qpgap - lo - sets ] .",
    "( note that all @xmath1 calculations in this section have been performed on coarse @xmath69 * k*/*q*-grids , and the figure does not reflect the final higly - converged values ) .",
    "the _ default _ setup ( table  [ tab : lo ] ) leads to a gap that saturates to @xmath85  ev at a high number of unoccupied bands .    to examine the basis - set quality ,",
    "we perform @xmath1 calculations with different basis sets that are characterized by the maximum angular momentum , @xmath86 , up to which local orbitals have been added .",
    "all details regarding their configurations are specified in table  [ tab : xslo ] . as it follows from fig .",
    "[ fig : qpgap - lo - sets ] , the extensions of the _ default _ configuration produce notable changes in the bahavior of the qp gap . employing the largest basis set with @xmath87 empty bands ,",
    "the gap reaches the value of 2.6 ev but still keeps growing without any sign of saturation .",
    "a qualitatively similar behavior was previously reported by friedrich in refs .  .",
    "convergence of the qp bandgap of wurtzite zno for different configurations of the basis set .",
    "each configuration is characterized by a maximum angular momentum @xmath86 up to which additional local orbitals for representing unoccupied states are added ( see table  [ tab : xslo ] ) . ]    analyzing the behavior of @xmath76 as a function of @xmath86 , one can immediately state the exceptional importance of the basis quality for obtaining reliable ks states . thus , according to fig .",
    "[ fig : qpgap - lo - sets ] , for the treatment of unoccupied states , additional basis functions ( local orbitals ) must be added into all angular momentum channels up to @xmath88 .",
    "as it was shown earlier,@xcite the basis - set incompleteness error is responsible for reaching a spurious convergence of the bandgap in wurtzite zno for a moderate number of empty states .    following all these findings , we generate new basis sets and apply the extrapolation procedure to all studied compounds.technically , we use a set of empty states , typically consisting of independent calculations in the relevant interval concerning the number of unoccupied states as determined by @xmath89 . the corresponding results will be presented in section  [ sec : bandgaps ] .",
    "although this extrapolation procedure is straightforward , it has a major practical drawback .",
    "this concerns the question , which range of unoccupied states @xmath73 is suitable for the fitting .",
    "first , high - energy unoccupied ks states may still contain an error that impacts the extrapolated gap ( cf .",
    "[ fig : ks - lapw - vs - lapwlo ] ) . from this point of view , it is undesirable to include results obtained with too large @xmath73 in the extrapolation procedure , i.e. states that can not be fully trusted .",
    "second , it is not _ a priori _ obvious at which @xmath73 the qp gap starts to follow the asymptotic behavior described by eq .",
    "[ eq : extrapol : gw ] . applied to wurtzite zno , this procedure yields extrapolated gaps in the range of 2.792.89  ev , depending on the fitting range @xmath73 as shown in fig .  [",
    "fig : zno - extrapolation ] .",
    "the lower ( higher ) limit is obtained when we use @xmath90 ( @xmath91 ) for the fit .",
    "( color online ) uncertainty of the extrapolation procedure with respect to the interval of empty bands ( specified in parentheses ) used for fitting eq .  .",
    "the dashed lines on top represent the extrapolated values . ]",
    "since the extrapolation to an infinite number of unoccupied states introduces an uncertainty , as just dicsussed above , we introduce an alternative method for obtaining converged qp energies .",
    "this method involves the entire ks spectrum that can be obtained with a finite yet sufficiently rich lapw+lo basis set .",
    "it is based on our observation that , while it is important to introduce a relatively large number of local orbitals , the quasiparticle energies are only weakly influenced by the number of lapw s . as a consequence ,",
    "such an _ all - states _ calculation is still feasible , while it yields the limit of an infinite number of states without any extrapolation .    in order to justify such an approach , we reexamine the convergence behavior of @xmath92 taking into account the dual nature of lapw+lo basis set . at first , the local basis size is fixed and consists of local orbitals with @xmath93 , while the number of lapw s is varied . as displayed in fig .",
    "[ fig : all - states ] ( top ) , @xmath92 behaves according to eq .",
    "[ eq : asymp ] roughly until the threshold @xmath94 ( dashed vertical lines ) that depends on the total number of lapw functions in the basis ( as determined by @xmath95 ) . at @xmath96 , @xmath92 deviates from the hyperbola and saturates as @xmath73 approaches its maximum .",
    "such a threshold ( @xmath97 ) exists , because an accurate description of high - energy unoccupied states requires lapw s with larger @xmath98 , however , their number is limited in practice . in other words , ks orbitals in the region @xmath96 are described mostly by local orbitals .",
    "this conclusion becomes apparent in fig .",
    "[ fig : all - states ] ( bottom ) , where the ks energies @xmath99 at the @xmath84 point are plotted .",
    "they approximately follow the usual @xmath100-rule up to the threshold that coincides with @xmath97 in fig .  [",
    "fig : all - states ] ( top ) . at @xmath96",
    ", @xmath99 grows much more rapidly than @xmath100 .",
    "( color online ) top : @xmath1 gap as a function of the number of unoccupied bands used in the calculations .",
    "the blue , green , and orange curves correspond to calculations with @xmath101 values of 8 , 10 and 12 , respectively . in all cases , local orbitals up to @xmath102",
    "were employed .",
    "bottom : corresponding ks energies of unoccupied bands at the @xmath84-point .",
    "vertical dashed lines indicate the threshold values , @xmath97 , at which @xmath92 stops following the asymptotic behavior eq .",
    "[ eq : asymp ] . ]",
    "[ fig : all - states ] ( top ) also reveals a striking detail .",
    "all three curves which are obtained by using different numbers of lapw s saturate at the same value of 2.84  ev within 5 mev .",
    "thus , lapw s , in contrast to local orbitals , have a weak impact on the convergence of quasiparticle gaps and , more generally , quasiparticle energies .",
    "in other words , it is much more important to have a rich basis within the mt s than in the interstitial region .",
    "we can understand this by the following considerations .",
    "if all unoccupied bands are used in a quasiparticle calculation , all degrees of freedom provided by this lapw+lo basis contribute to @xmath103 . extending the ks basis",
    "improves the description of @xmath103 , which is difficult to resolve in the limit of short @xmath104 .",
    "as shown is ref .",
    ", a poor description of short - range features of @xmath103 and related quantities has the strongest effect on those states that overlap substantially with high - density regions . based on this observation , we argue that , in order to improve quasiparticle energies , one has to expand the ks basis in high - density regions , thus , better resolving the short - range features of @xmath103 there . since mt s enclose high - density regions , adding local - orbitals has a noticeable effect on the quasiparticle energies , while increasing the number of lapw s has a minor influence as stated above .",
    "further , we explore how well converged the calculations with our local - orbital settings are .",
    "[ fig : gw - lmax ] shows how @xmath86 influences the quasiparticle gap when using all available unoccupied states .",
    "setups with @xmath105 and @xmath106 lead to a value of around 2.3  ev that coincides with the large-@xmath73 limit for the _ default _ setup . for @xmath107 ,",
    "the quasiparticle gap initially increases rapidly , but then it saturates at around @xmath108 . the difference between @xmath109 and 8 is less than 5 mev .",
    "( color online ) @xmath1 gap as a function of @xmath86 as used to construct additional local orbitals for unoccupied states . ]",
    "while the angular degrees of freedom spanned by the local - orbital basis have a significant impact on the quasiparticle energies , the influence of the radial degrees of freedom is not to be overlooked . to test whether the latter ones are sufficiently well represented ,",
    "we have performed a calculation with @xmath110 and an energy - cutoff of @xmath111  ha .",
    "these settings correspond to 8 @xmath46- , 9 @xmath47- , 9 @xmath2- , 9 @xmath51- , 8 @xmath52- , 8 @xmath53- , 7 @xmath54- , 7 @xmath55- , and 6 @xmath56-shells of local orbitals for both zn and o atoms ( 2404 local orbitals in total ) .",
    "the quasiparticle gap increases by 3  mev as the result of the basis adjustments .",
    "thus , we conclude that both the angular and radial degrees of freedom are sufficiently well represented by the basis described in sec .  [",
    "sec : flapw ] and appendix  [ app : losetups ] .",
    "we have calculated the quasiparticle bandstructure for a test set of compounds consisting of 13 small- and wide - gap semiconductors as well as 3 insulators .",
    "the corresponding structures and lattice parameters have been taken from refs .   and are provided in appendix  [ app : crystals ] .",
    "the carefully converged groundstate calculations have been performed within lda .",
    "the resulting ks eigenvalues of the highest valence band ( vb ) and lowest conduction band ( cb ) at the @xmath84 , @xmath112 , and @xmath113 points of the brillouin zone are presented in table  [ tab : qp - lda ] . comparing these values with those of ref .  , we find excellent agreement .",
    "for the valence region , the differences do not exceed 20 mev .",
    "the deviations are somewhat larger for the positions of the @xmath2-states ( @xmath114 mev ) .",
    ".[tab : qp - lda]kohn - sham ( lda ) energies of the valence band ( vb ) at @xmath112 and @xmath113 , and the conduction band ( cb ) at @xmath84 , @xmath112 , and @xmath113 with respect to the vb maximum at @xmath84 , thus @xmath115 reflecting the direct band gap . for ga ,",
    "zn , and cd the averaged position of @xmath2-states at @xmath84 is also indicated . [ cols=\"<,>,>,>,>,>,>\",options=\"header \" , ]",
    "[ fig : kqtest ] presents convergence studies for the quasiparticle bandgap ( top ) and the position of vb ( bottom ) in gaas concerning the @xmath68-point grid . changing the grid size results in an almost rigid shift of both curves , @xmath116 and ip(@xmath73 ) .",
    "this observation suggests that one can perform convergence tests with respect to @xmath68-point size independently from the corresponding test with respect to the number of unoccupied states ."
  ],
  "abstract_text": [
    "<S> the @xmath0 approach of many - body perturbation theory ( mbpt ) has become a common tool for calculating the electronic structure of materials . </S>",
    "<S> however , with increasing number of published results , discrepancies between the values obtained by different methods and codes become more and more apparent . for a test set of small- and wide - gap semiconductors , </S>",
    "<S> we demonstrate how to reach the numerically _ best _ electronic structure within the framework of the full - potential linearized augmented planewave ( flapw ) method . </S>",
    "<S> we first evaluate the impact of local orbitals in the kohn - sham eigenvalue spectrum of the underlying starting point . </S>",
    "<S> the role of the basis - set quality is then further analyzed when calculating the @xmath1 quasiparticle energies . </S>",
    "<S> our results , computed with the exciting code , are compared to those obtained using the projector - augmented planewave ( paw ) formalism , finding overall , good agreement between both methods . </S>",
    "<S> we also provide data produced with a typical flapw basis set as a benchmark for other @xmath1 implementations . </S>"
  ]
}