{
  "article_text": [
    "the field of high contrast imaging has expanded rapidly in the past few years , driven by the prospect of science enabled by the direct detection and characterization of extrasolar planets and faint circumstellar disks .",
    "several observatories have launched studies and development of such projects , e.g. gemini planet imager ( gpi ) @xcite , sphere @xcite , or hiciao @xcite . in the future ,",
    "extremely large telescopes ( elt ) @xcite will provide the higher angular resolution necessary to study more distant planet forming regions , and also faint old giant planets .",
    "the study of earth - like planets will probably have to wait for space - based instruments @xcite .",
    "ground - based imaging requires the association of coronagraphy and extreme adaptive optics ( exao ) , which can be studied both theoretically and numerically @xcite .",
    "in this paper we study the numerical modeling of lyot type coronagraphs @xcite , including apodized pupil lyot coronagraphs ( aplc ) @xcite , or phase masks @xcite .",
    "these coronagraphs consist of the succession of binary filters ( pupil , occulting mask , lyot stop ) .",
    "the method we describe does not provide any significant improvement in the case of infinite - size focal plane masks @xcite , which we do not discuss further here . under the classical approximations of fourier optics @xcite , a fourier transform ( ft ) relationship exists between the field amplitude at two successive planes of the coronagraph .",
    "the pupil , with its finite support , is not band - limited and so can not be perfectly sampled according to the shanon - nyquist sampling theorem @xcite .",
    "the same problem pertains to the occulting mask in the focal plane .",
    "a remedy is to impose very fine sampling both in pupil and focal planes , in order to represent small features ( e.g. segmentation or secondary mirror support structures , occulting spot ) .",
    "note that nyquist sampling of the focal plane with two pixels per resolution element @xmath0 , is not sufficient here .",
    "indeed , the small occulting mask has a typical size of about @xmath1 , and would not be well represented by a disk ten pixels in diameter .",
    "this is even more problematic for phase masks of size @xmath2 @xcite .",
    "significant oversampling of the psf is therefore required for sufficient fidelity in coronagraphic modeling .",
    "this two - fold sampling requirement in two fourier - conjugate planes is not only a severe practical problem , but raises a fundamental problem associated with the uncertainty principle . in order to preserve complete information in the ft",
    ", a fine sampling in one domain means that the corresponding ft must be calculated to a very high frequency in the reciprocal domain .",
    "this is achieved optically when forming successive pupil and focal plane images .",
    "numerically , this can be reproduced using fast fourier transforms ( fft ) , but this can lead to overwhelming demands on memory and computing power . in sec.[sec : classicalmethod ] we show that this fundamental limitation makes classical ffts poorly suited for lyot - type coronagraphic computations . in sec.[sect :",
    "semianal ] we analyze the analytical formalism of coronagraphic propagation , and conclude that a partial ft algorithm providing arbitrary sampling in a limited area is more appropriate for coronagraphy .",
    "several methods can be used for this purpose @xcite , and we detail a matrix - based ft @xcite , which can be implemented easily in any high - level language .",
    "comparisons between classical propagation with ffts and our semi - analytical method show a considerable gain both in speed and memory requirements . this therefore opens new possibilities for coronagraphic studies hitherto impossible without large computer cluster facilities . among them , the study of extremely fine sampling of the pupil plane in the case of elts , of extremely fine sampling of the occulting plane mask , or of end - to - end simulations of an exao coronagraph to simulate a long exposure , are achievable with standard desktop equipment .",
    "in this section we recall the general formalism of lyot - type coronagraphs , following the notation of aime _",
    "_ @xcite and soummer _ et al .",
    "the general layout is given in fig.[fig : layout ] .",
    "the setup consists of an ensemble of apodizers , masks and stops in four successive planes @xmath3,@xmath4,@xmath5,@xmath6 , respectively , where @xmath3 is the entrance aperture , @xmath4 is the focal plane with the occulting mask , @xmath5 is an image of the entrance aperture where a pupil mask called lyot stop is placed and @xmath6 is the final image plane .",
    "we will consider the usual approximations of paraxial optics @xcite , and that the optical layout is properly designed to cancel the quadratic phase terms associated with fresnel propagation , so that a ft relationship exists between two successive planes .    the telescope aperture function with the position vector @xmath7 is denoted by @xmath8 ( index function equal to 1 inside the aperture @xmath9 ) .",
    "this aperture can be apodized by a function @xmath10 .",
    "note that these functions do not have to be radial .",
    "a mask of transmission @xmath11 is placed in the focal plane .",
    "@xmath12 is the index function that describes the mask shape @xmath13 , equal to 1 inside the coronagraphic mask and 0 outside .",
    "@xmath14 is the index function of the lyot stop .",
    "we recall that both the lyot coronagraph ( opaque mask ) and the roddier coronagraph ( @xmath15 phase mask ) can be described by this common formalism , with @xmath16 for lyot and @xmath17 for roddier using that @xmath18 , as detailed in @xcite .",
    "the field amplitude in the four successive planes are : @xmath19 in these equations , @xmath20  denotes the fourier transform , @xmath21 the convolution product , and we assume that the focal lengths of the successive optical systems are identical ( if not , an appropriate change of variables leads to the same result ) . also , we re - orientate the axis in the opposite direction and omit the coordinate reversal for better legibility here .",
    "also , we assumed monochromatic propagation in these equations .",
    "the effect of a finite spectral bandpass can be added easily to this formalism : in the focal plane , the size of the point spread function is proportional to the wavelength , but the mask ( hard - edged or phase ) has a fixed size .",
    "it can be readily shown @xcite that changing the wavelength is formally equivalent to changing the mask size .",
    "in order to compute the coronographic propagation , we are interested in the numerical evaluation of the fourier integral between each plane . without loss of generality",
    "we consider the case of a one - dimensional signal @xmath22 with @xmath23 $ ] and @xmath24 for @xmath25 , where @xmath26 is a padding coefficient that will be later related to the resolution of the ft in the image plane .",
    "we illustrate the relationship between plane a and plane b. we first recall classical results of fourier analysis @xcite ; the sampled continuous fourier transform ( cft ) can be written as a riemann sum : @xmath27 where @xmath28 , @xmath29 $ ] , corresponding to the sampling points of @xmath22 , and @xmath30 , @xmath31 $ ] are the sampled values of the fourier transform .",
    "@xmath32 is the number of pixels along the pupil diameter @xmath6 , and @xmath33 is the number of pixels in the focal plane .",
    "note that under the riemann sum approximation , independent sampling grids can be chosen in both domains .",
    "however , when one chooses the same size @xmath34 for both arrays , and the integration steps as : @xmath35 then eq .  [ eq : riemann ] greatly simplifies to : @xmath36 where the sum is now a discrete fourier transform ( dft ) , which can be computed very efficiently using fft algorithms .",
    "the number of floating point operations ( flops ) in a radix-2 cooley - tukey fft of size @xmath37 is @xmath38 .",
    "it is generally assumed that this is also an approximation for the number of operations in any complex fft @xcite .",
    "it is critical to realize that this possibility of using ffts is obtained at the expense of a fixed relationship between the focal plane sampling and the padding factor , forced by eq .",
    "[ eq : shannon ] : @xmath39 , as illustrated on fig .",
    "[ fig : psfsampling ] . under this condition",
    ", the occulting mask of @xmath40 resolution elements is therefore sampled with @xmath41 pixels . because stellar coronagraphs use very small masks ( typically @xmath42 for an aplc , and @xmath43 for a pm or dzpm )",
    ", decent sampling of these masks ( at the very least a few tens of pixels ) imposes large zero padding factors @xmath26 .",
    "a general consensus for coronagraphic calculation is to use @xmath44 or @xmath45 .",
    "the memory and computational speed problems associated with classical coronographic algorithms stem from the requirement of finely sampling the image plane mask .",
    "this can lead to prohibitively large padding factors for some applications which can benefit for particularly fine sampling , such as tip - tilt tolerancing @xcite , study of atmospheric differential refraction effects , mask ellipticity or roughness studies .",
    "a common method to mitigate these mask sampling problems is to use a gray - pixel approximation , where gray pixels are used at the edge of the mask : their value is defined as the ratio of the area covered by the mask to the total pixel area .",
    "this technique corresponds to a slight numerical apodization of the focal plane mask , akin to the use of an anti - alizing filter .",
    "the same approach can be used for small features in the pupil plane , such as secondary mirror support structures . however , there are cases where the gray approximation can not be used .",
    "for example , the tolerancing of the effects of the small pupil features ( segmentation , spiders @xcite ) , and their mitigation by the lyot stop can not be done with gray pixel approximation .",
    "prolate apodizers for aplcs need to be defined without gray pixels in the pupil @xcite . in the case of phase masks ( roddier @xcite or dual zone @xcite ) , the gray approximation is meaningless for the phase mask , and large padding coefficients have to be used since these masks are very small ( typically one resolution element ) .",
    "as shown in fig .  [ fig : psfsampling ] , fft methods address the image plane sampling requirement by zero padding the pupil , and mimicking the optical propagation , preserving the complete information between planes",
    ". a much better approach can be derived from the analytical expression of the field in the lyot plane , simply re - writing eq .",
    "[ planccart ] as : @xmath46 m(\\textbf{r})\\big ] \\right)\\ , l(\\textbf{r } ) ,   \\label{eq9}\\ ] ] where we can readily identify that the first ft of the pupil field amplitude @xmath47 $ ] is truncated by the occulting spot @xmath48 , and that the second ft is truncated by the lyot stop @xmath49 .",
    "this means that we are only interested in the knowledge of the fts _ inside _ limited areas , viz . , the limited occulting mask area , and the limited lyot stop area .",
    "we can thus completely circumvent the sampling problem by restricting the information of the fts to these two zones : the semi - analytical approach consists of computing these limited - area fts numerically , and subtracting the result from the pupil complex amplitude , according eq .",
    "[ eq9 ] .",
    "in the case of one - dimensional problems ( rectangular apertures @xcite , or perfect circular apertures @xcite ) , the semi - analytical approach can be applied by calculating directly these two limited - area fts ( or hankel transforms for circular apertures ) using a one - dimensional numerical integration algorithm .",
    "this approach presents some advantages for phase masks calculations @xcite , but such direct integrations can not be used efficiently in the two - dimensional case for computation reasons .    in the general two - dimensional case",
    ", the two limited - area fts can be calculated using partial ft methods .",
    "several methods exist to calculate such partial fts , such as the fractional fourier transform or chirp z - transform , @xcite , and we describe a very simple matrix - based method in the next section @xcite .",
    "these partial ft methods are intrinsically slower that a fft if exactly the same computation is performed . however , since we are only interested in a small number of points within limited areas ( occulting mask _ and _ lyot stop ) , we actually replace fast calculations with very large arrays by slow calculations with very small arrays .",
    "note that for @xmath45 , only @xmath50 values of the ft need to be calculated in the first focal plane for a @xmath1 mask , independently of the size of the pupil n pixels .    the semi - analytical propagation from the pupil to the lyot plane is performed as follows :    * define the pupil field amplitude _ without _ zero padding as a @xmath51 array , where @xmath32 is the diameter of the pupil in pixels . *",
    "calculate the ft to an arbitrary fine sampling inside the area _",
    "limited _ to the occulting mask as a @xmath52 array , with e.g. @xmath53 for a @xmath1 mask with @xmath45 .",
    "* calculate the ft of this previous field amplitude inside an area _ limited _ to the pupil ( @xmath51 array ) .",
    "* reverse the spatial axes because two successive fts restore the function while changing the sign of the variable , and subtract the result from the pupil field amplitude ( an inverse fft can also be used between plane b and plane c to avoid reversing the axis ) .",
    "note that for convenience all masks ( pupil and occulter ) are defined with their centers located on the pixel @xmath54 ( or @xmath55 ) , and that the focal plane mask can be defined using the gray pixel approximation , as for the classical fft method .",
    "these computation steps are illustrated in fig.[fig : ilustrationmethod ] and compared to the classical fft approach .",
    "the figure shows the actual arrays that are calculated for both method : note that the semi - analytical method does not use zero - padding in the pupil plane and calculates the focal plane amplitude only _ inside _ the occulting mask , instead of _ outside _ in the case of the classical fft method .    in plane c",
    ", the lyot stop can be equal to the pupil size in the case of an aplc , or more generally undersized to optimize the coronagraphic efficiency according to various possible criteria @xcite .",
    "if the lyot stop size has been previously chosen , the calculated area can be limited to the lyot stop itself to accelerate further the computation , but in practice we usually compute the lyot plane amplitude over the size of the entire pupil . if necessary , it is straightforward to oversize the calculated region , at the expense of computing efficiency , for example to see the light diffracted outside the pupil .",
    "avoiding the typical six - to - eight fold zero - padding enables the use of much smaller arrays , than fft calculations require .",
    "for example , in the case of gpi ( @xmath56 ) , the secondary mirror support structures are about @xmath57 wide .",
    "understanding the effects of spiders on coronagraphic performance is important since they appear bright in the lyot plane and musk be masked out by the lyot stop @xcite .",
    "for example , with 4 pixels per spider , @xmath58 pixels are needed in the pupil .",
    "standard @xmath45 padding would require @xmath59 ffts .",
    "the semi analytical method enables this calculation in a few seconds on a standard desktop computer ( table 2 ) .",
    "it is important to note that the calculations of the partial fts inside the mask do not correspond to an additional approximation , as it may seem that we discard the information _ outside _ the focal plane mask .",
    "in fact , we do not lose any information because the method is based on the analytical formulation of eq .",
    "[ eq9 ] which is equivalent to eq .",
    "[ planccart ] .      in this section",
    "we describe a simple matrix fourier transform ( mft ) , which can be used for the semi - analytical method . in order to restrict the computation of the ft of the pupil to the image plane size @xmath40 expressed in resolution elements units @xmath0 , we choose the sampling step in plane b such that : @xmath60 .",
    "we compute the riemann sum directly using a matrix formulation of eq.[eq : riemann ] : @xmath61 which can be rewritten as : @xmath62 where @xmath63 , @xmath64 , and @xmath65 is the element - wise exponential of a matrix .",
    "two - dimensional fts can be implemented straightforwardly as follows :    * define the four vectors @xmath63 , @xmath64 , @xmath66 , @xmath67 . *",
    "the vector elements are @xmath68 and @xmath69 , for @xmath70 $ ] and @xmath71 $ ] .",
    "* the two - dimension ft is obtained by computing the two matrix products : @xmath72 where the normalization coefficient @xmath73 imposes the conservation of energy according to the parseval theorem @xcite : the energy in the limited - area ft is a fraction of the total energy of the ft , corresponding to the limited area , which was calculated . * with this definition , the fourier transform is centered in a similar fashion to the fft , with the zero frequency at the pixel @xmath55 .    note that when the conditions of eq.[eq : shannon ] are verified , both the fft and the matrix ft give identical results .",
    "this can be used as a numerical check when implementing the technique .",
    "this is not surprising since the matrix method is a direct implementation of the riemann sum , which is also what is computed by a fft ( very efficiently ) , taking advantage of simplifications for particular sampling conditions ( eq.[eq : fftsum ] ) . with the mft , the arbitrary sampling @xmath74 in the focal plane",
    "is obtained at the expense of partial information on the ft . note that in the case of the mft , @xmath26 still corresponds to the sampling of the ft ( number of pixels per resolution element ) ,",
    "but not to the zero - padding coefficient .",
    "the semi - analytical formalism frees the computation from the rigid sampling constraints of fft methods .",
    "this provides increased flexibility in the computation , since the number of pixels in the pupil and focal planes can be chosen independently .    in terms of computation cost ,",
    "the matrix ft involves 2 complex - matrix products of the form : @xmath75 where the respective sizes of the three matrix @xmath76 are : @xmath77 , @xmath51 , and @xmath77 .",
    "we consider the case of a complex ft for generality .",
    "each element of the result in a matrix product is the result of @xmath32 multiplications and @xmath78 additions .",
    "while complex addition requires 2 flops ( floating point operations ) , complex multiplications require 6 flops .",
    "since the two matrices @xmath79 and @xmath80 can be calculated beforehand , in a similar fashion that fft plans are generated , the total number of operations for the product @xmath81 is therefore : @xmath82 , assuming @xmath32 large enough . the number of flops involved in the first complex mft ( pupil to focal ) is therefore : @xmath83 in the particular case where both pupil and image plane have the same array size @xmath37 , it is interesting to note that the number of operations for the matrix method is proportional to @xmath84 and not @xmath85 as for a direct calculation of the dft .",
    "this is because the two successive matrix products take advantage of some redundancy in intermediate calculations .",
    "the fft is as expected more efficient in this case , and the relative number of operations is : @xmath86 for example a @xmath87 ft requires 36 times more operations with a mft than with a fft .",
    "this calculation , which takes about 0.5s with a fft on a on a 2ghz apple g5 ( 1 gflop / s ) , would take 18s with a mft .",
    "the performance comparison between the fft propagation method and the semi - analytical method is given in sec .",
    "[ sec : compcosts ] .",
    "the computation of the ft in a limited area can also be made using a fractional fourier transform .",
    "this method is presented by bailey and swarztrauber @xcite , we refer the reader to this work for a complete description of this algorithm .",
    "consider the riemann sum in eq .",
    "[ eq : riemann ] , and assume that there is no zero padding @xmath88 , @xmath89 $ ] with @xmath90 and @xmath91 , @xmath31 $ ] with @xmath92 and @xmath93 , where @xmath40 is the size of the image plane mask in resolution element units @xmath0 .",
    "note that here again @xmath26 does not correspond to an oversize of the pupil but directly to the number of pixels per unit of angular resolution in the image plane .",
    "the riemann sum can be re - written as : @xmath94 which corresponds to a partial fourier transform of the series @xmath95 .",
    "this sum can be evaluated using bluestein s technique @xcite , which is related to the chirp z - transform . by noticing that @xmath96 the partial fourier transform above can be written as a convolution : @xmath97 consequently",
    ", the computation of the field in the image plane to an arbitrary sampling can be computed using a discrete convolution of sequences of length @xmath32 .",
    "we direct the reader to the aforementioned references for details on these computation schemes . in order to use fast circular convolution algorithms , the incoming sequence needs to be zero - padded by factor of two , and",
    "the computational cost corresponds then to three ffts of size @xmath98 .",
    "when the field in the image plane is computed up to the nyquist limit , the computational cost of the method is @xmath99 . when the size of the final array is @xmath100 , partial convolution algorithms can be used , and they reduce the computational cost to @xmath101 @xcite . in the case of large ft sizes ( @xmath33 large ) the fractional ft method has a lower cost than the mft and the potential gain is of the order of @xmath102 .",
    "we compare the computation costs of coronagraphic propagation from pupil to lyot plane in the case of the fft and semi - analytical methods .",
    "as described before , coronagraphic propagation with ffts requires pupil zero - padding by a coefficient @xmath26 .",
    "the array sizes are therefore @xmath103 , where @xmath32 is the number of pixels across the pupil diameter and the number of flops involved in each fft is @xmath104 .",
    "the total number of operations for a propagation from pupil to lyot plane is : @xmath105 where we also include the multiplication by the focal plane mask ( @xmath106 flops ) , which can be neglected in most cases of interest .    with the semi - analytical method ,",
    "the size of the first ft is limited to the mask area , @xmath107 where @xmath40 is the mask size in resolution elements ( we remind here that typically @xmath108 for a lyot coronagraph and @xmath109 for a roddier or dzpm ) . the number of operations for the first mft ( eq .  [ mftcost ] ) .",
    "the second mft transforms the @xmath52 array into a @xmath51 array and its cost is @xmath110 .",
    "the propagation from pupil to lyot plane includes the two mfts , the multiplication by the focal plane mask ( @xmath111 flops ) and the subtraction of the result from the pupil ( @xmath112 flops ) .",
    "the total cost of a semi - analytical propagation from pupil to lyot plane is therefore : @xmath113 where the last two terms can be neglected in most cases of interest .",
    "the relative computation cost between the classical fft propagation and the semi - analytical method is therefore approximately : @xmath114 neglecting the multiplication by the focal plane mask .",
    "this expression shows that there are always more operations with the fft than with the semi - analytical method , and that the relative cost of the fft increases with the padding factor @xmath26 and the pupil size @xmath32 .    in fig.[fig :",
    "comparisonsamfft ] , fig.[fig : comparisonelt ] , and fig.[fig : comparisonrr ] , we illustrate the gain between the semi - analytical and fft methods , using the ratio of their computation costs given in eq.[eq : costtlpfft ] and eq.[eq : costtlpmft ] .",
    "we first give some results for a typical lyot coronagraph simulation on an 8-meter class telescope , and two cases where the computation gain can be even larger : an elt simulation with fine pupil sampling , or a phase mask coronagraph where very fine sampling is required in the focal plane .      in this section",
    "we discuss briefly the case of direct imaging as a potential application of the mft .",
    "although in most cases the mft requires more computations than a fft , it is possible to identify a few cases where it can be more efficient .",
    "this happens when the calculated area is limited and/or when a fine sampling is needed .",
    "the mft was first used by giveon _",
    "@xcite for the study of wavefront sensing and correction in high - contrast imaging with shaped pupils @xcite .",
    "we illustrate the case of a point spread function ( psf ) calculation with a field of view ( fov ) of 50 resolution elements in fig.[fig : comparisondirectim ] . in this case , both techniques have similar costs with a slight advantage for one or the other depending on pupil size and sampling parameter @xmath26 .",
    "if the psf is only calculated to a fov of 20 resolution elements , the mft provides a gain by a factor of several over the fft ( fig.[fig : compdirectim2 ] ) . in some applications where only the center of the psf is needed ,",
    "gains comparable to that of the coronagraphic cases can be obtained .      in this section",
    "we discuss the actual performance of the semi - analytical method for a specific computer , a 2003 apple g5 dual processor 2ghz computer with 4 gb ram .",
    "we measured the performance of this machine using the package fftw ( version 3 ) @xcite and report the results in fig.[fig : fftwflops ] .",
    "we considered the case of double precision complex 2d arrays , which is appropriate for coronagraphic simulations .",
    "these results are consistent with those given on the fftw website , but we extend them up to @xmath115 fft to verify that the speed does not depend strongly on the array size .",
    "our calculations used the ` fftw_patient ` option , which optimizes the fft plan prior to the calculation of the fft itself .",
    "we used single - threaded ffts although the fftw packages provides the possibility of multi - threaded calculations for further speed improvement on multi - core machines .    in order to evaluate the machine s performance for the mft",
    ", we considered the geekbench benchmark software @xcite which reports 1.4 gflop / s for single - threaded dot products and 2.6 gflop / s for multi - threaded ones .",
    "it seems that dot products are slightly more efficient than the fftw on this hardware ( 1.4 gflop / s vs. 1 gflop / s ) .",
    "this may be due to the easier implementation of the dot - product which takes direct advantage of the processor s vector engine .",
    "an interesting aspect of the mft is that it can take advantage of recent multi - core computers , with easy and efficient multi - threading of linear algebra calculations .",
    "high level languages such at mathematica or matlab are well optimized for vector computations .",
    "for example , we obtain 2.5 gflop / s with mathematica for multi - threaded dot - products on double precision complex arrays of sizes between @xmath116 and @xmath117 .",
    "this result is consistent with the benchmark results this machine ( 2.6 gflop / s ) . in the case of a propagation from pupil to lyot plane , the speed goes down to 1gflop / s with mathematica because the other operations involved in the semi - analytical method are not fully optimized with this language .    in table 1",
    ", we compare the two methods for three pupil sizes ( @xmath118 , @xmath119 , @xmath120 ) . @xmath32 and @xmath33 are the number of pixels used in the calculation , in the pupil and focal planes .",
    "we use the same number of pixels in the lyot plane as in the pupil .",
    "we show the effect of the sampling improvement from @xmath121 to @xmath122 , obtained by zero - padding the pupil with ffts .",
    "note that for the semi - analytical method , the number of pixels @xmath32 corresponds to the pupil size itself , and that @xmath33 corresponds to the focal plane mask size .",
    "for the fft , @xmath32 corresponds to the zero - padded pupil .",
    "the timings given in the table correspond to the time for 2 ffts calculated with fftw3 , neglecting the application of the focal plane mask and zero - padding time . for the semi - analytical method",
    ", we give timings obtained with mathematica as example .",
    "coronagraphic simulations are usually performed with a @xmath123 to @xmath122 sampling , in order to keep the ffts manageable . with the semi - analytical method",
    ", we can increase the precision significantly , and we typically use a @xmath124 or @xmath125 sampling for the focal plane mask , including gray pixel approximation .",
    "this corresponds to a @xmath126 or @xmath127 pixel diameter mask for a @xmath128 resolution element mask .",
    ".performance comparison of fft - based and semi - analytical methods ( sam ) .",
    "@xmath32 is the number of pixels across the pupil diameter , and @xmath33 is the size of the array in the focal plane .",
    "the fft timings correspond to 2 ffts calculated with fftw3 , and the sam timings correspond to an actual propagation from pupil to lyot plane , with mathematica . [ cols=\"^,^,^,^,^,^ \" , ]     [ tab : performancesdesk ]",
    "in this paper we introduced a semi - analytical method to calculate the numerical propagation through a lyot - style coronagraph , without any additional approximation .",
    "we showed that ffts are not appropriate for lyot coronagraphy because of fundamental sampling limitations , and should be avoided for these calculations .",
    "the semi - analytical method is derived straightforwardly from the analysis of the wave propagation , and requires the use of a fourier transform method producing arbitrary sampling in a limited area .",
    "several methods exist to perform such transforms , we suggest a matrix - based fourier propagator that can be implemented efficiently in any language .    for coronagraphic studies for exao on elts and eight meter class telescopes ,",
    "the typical speed improvement based on computation costs is of at least a factor twenty to fifty compared to the classical fft coronagraphic propagation method .",
    "in addition to speed , our semi - analytical method is particularly efficient in terms of memory , as it does not involve any zero padding , and typical memory reequirements are reduced by a factor of about 50 in our usage of the algorithm . in the case of a full propagation from pupil to final focal plane ,",
    "if the final ft is performed using a fft , the semi - analytical method is approximately three times faster than a fft - based propagation , since the propagation time is entirely dominated by the final fft .",
    "if a reduced field of view is calculated in the final image , which is often the case in extreme adaptive optics coronagraphy , an mft can be used in lieu of an fft .",
    "for example a factor of 5 can be gained on the last ft for @xmath129 and @xmath130 , and the overall gain with the semi - analytical method is a factor of 15 .    with the semi - analytical method ,",
    "the pupil and focal plane sampling are completely independent .",
    "this flexibility enables calculations that were hitherto impossible , or only possible on large and expensive computer clusters .",
    "for example , the study of fine occulting mask features and alignment , or fine pupil structures like segmentation , is now achievable on a well - equipped but otherwise standard laptop , or on most commercial workstation sold today .",
    "the mft may also find interesting applications where a ft has to be calculated in a limited area .",
    "this was used by giveon _",
    "_ @xcite and new applications may be found in adaptive optics for anti - aliasing spatial filters @xcite , pyramid wavefront sensing @xcite , etc .",
    "our method also enables fast computation of optimal apodizers for aplcs , which involves an iterative algorithm and makes computing efficiency even more critical @xcite .",
    "aplcs are one of the most promising concepts for high contrast imaging instruments on elts , and their study requires the optimization of the mask size according to various criteria , over broad spectral bandpasses . a complete exploration of the effects of chromaticity , segmentation and spiders on the coronagraph is now made possible with acceptable computing times .",
    "our method could be utilized in several current efforts focussed on ground and spaced based coronagraphy .",
    "rs acknowledges partial support by a michelson postdoctoral fellowship , under contract to the jet propulsion laboratory ( jpl ) funded by nasa .",
    "jpl is managed for nasa by the california institute of technology and by a amnh kalbfleisch fellowship .",
    "this work has also been partially supported by the national science foundation science and technology center for adaptive optics , managed by the university of california at santa cruz under cooperative agreement ast 98 - 76783 .",
    "r. vanderbei acknowledges support from the onr ( n00014 - 05 - 1 - 0206 ) .",
    "the authors thank lisa poyneer , jim fienup for interesting discussions , russell makidon and the reviewers for helpful comments ."
  ],
  "abstract_text": [
    "<S> we present a new method for numerical propagation through lyot - style coronagraphs using finite occulting masks . </S>",
    "<S> standard methods for coronagraphic simulations involve fast fourier transforms ( fft ) of very large arrays , and computing power is an issue for the design and tolerancing of coronagraphs on segmented extremely large telescopes ( elt ) in order to handle both the speed and memory requirements . </S>",
    "<S> our method combines a semi - analytical approach with non - fft based fourier transform algorithms . </S>",
    "<S> it enables both fast and memory - efficient computations without introducing any additional approximations . </S>",
    "<S> typical speed improvements based on computation costs are of about ten to fifty for propagations from pupil to lyot plane , with thirty to sixty times less memory needed . </S>",
    "<S> our method makes it possible to perform numerical coronagraphic studies even in the case of elts using a contemporary commercial laptop computer , or any standard commercial workstation computer . </S>",
    "<S> +    10    url # 1`#1`urlprefix[2][]#2    b.  macintosh , j.  graham , d.  palmer , r.  doyon , d.  gavel , j.  larkin , b.  oppenheimer , l.  saddlemyer , j.  k. wallace , b.  bauman , j.  evans , d.  erikson , k.  morzinski , d.  phillion , l.  poyneer , a.  sivaramakrishnan , r.  soummer , s.  thibault , and j .- </S>",
    "<S> p . </S>",
    "<S> veran , `` the gemini planet imager , '' in _ advances in adaptive optics ii </S>",
    "<S> . edited by ellerbroek , brent l. ; bonaccini calia , domenico . </S>",
    "<S> proceedings of the spie , volume 6272 , pp . </S>",
    "<S> ( 2006 ) . _ ( 2006 ) .    </S>",
    "<S> j.  l. beuzit , d.  mouillet , c.  moutou , k.  dohlen , t.  fusco , p.  puget , s.  udry , r.  gratton , h.  m. schmid , m.  feldt , m.  kasper , and the vlt - pf consortium , `` a  planet finder  </S>",
    "<S> instrument for the vlt , '' in _ tenth anniversary of 51 peg - b : status of and prospects for hot jupiter studies _ , l.  arnold , f.  bouchy , and c.  moutou , eds . , pp . </S>",
    "<S> 353355 ( 2006 ) .    </S>",
    "<S> m.  tamura , k.  hodapp , h.  takami , l.  abe , h.  suto , o.  guyon , s.  jacobson , r.  kandori , j .- i . </S>",
    "<S> morino , n.  murakami , v.  stahlberger , r.  suzuki , a.  tavrov , h.  yamada , j.  nishikawa , n.  ukita , j.  hashimoto , h.  izumiura , m.  hayashi , t.  nakajima , and t.  nishimura , `` concept and science of hiciao : high contrast instrument for the subaru next generation adaptive optics , '' in _ ground - based and airborne instrumentation for astronomy . edited by mclean , ian s. ; iye , masanori . </S>",
    "<S> proceedings of the spie , volume 6269 , pp . </S>",
    "<S> 62690v ( 2006 ) . </S>",
    "<S> _ , vol . </S>",
    "<S> 6269 of _ presented at the society of photo - optical instrumentation engineers ( spie ) conference _ ( 2006 ) .    </S>",
    "<S> b.  macintosh , m.  troy , r.  doyon , j.  graham , k.  baker , b.  bauman , c.  marois , d.  palmer , d.  phillion , l.  poyneer , i.  crossfield , p.  dumont , b.  m. levine , m.  shao , g.  serabyn , c.  shelton , g.  vasisht , j.  k. wallace , j .- f . </S>",
    "<S> lavigne , p.  valee , n.  rowlands , k.  tam , and d.  hackett , `` extreme adaptive optics for the thirty meter telescope , '' in _ advances in adaptive optics ii . edited by ellerbroek , brent l. ; bonaccini calia , domenico . </S>",
    "<S> proceedings of the spie , volume 6272 , pp . </S>",
    "<S> 62720n ( 2006 ) . </S>",
    "<S> _ , vol . </S>",
    "<S> 6272 of _ presented at the society of photo - optical instrumentation engineers ( spie ) conference _ ( 2006 ) .    </S>",
    "<S> l.  close , `` extrasolar planet imaging with the giant magellan telescope , '' in _ proceedings of the conference in the spirit of bernard lyot : the direct detection of planets and circumstellar disks in the 21st century . </S>",
    "<S> june 04 - 08 , 2007 . </S>",
    "<S> university of california , berkeley , ca , usa . edited by paul kalas . _ , p.  kalas , ed . ( 2007 ) .    c.  verinaud , m.  kasper , j .- l . </S>",
    "<S> beuzit , n.  yaitskova , v.  korkiakoski , k.  dohlen , p.  baudoz , t.  fusco , l.  mugnier , and n.  thatte , `` epics performance evaluation through analytical and numerical modeling , '' in _ proceedings of the conference in the spirit of bernard lyot : the direct detection of planets and circumstellar disks in the 21st century . </S>",
    "<S> june 04 - 08 , 2007 . </S>",
    "<S> university of california , berkeley , ca , usa . edited by paul kalas . _ , p.  kalas , ed . </S>",
    "<S> ( 2007 ) .    </S>",
    "<S> o.  guyon , j.  r.  p. angel , c.  bowers , j.  burge , a.  burrows , j.  codona , t.  greene , m.  iye , j.  kasting , h.  martin , d.  w. mccarthy , jr . </S>",
    "<S> , v.  meadows , m.  meyer , e.  a. pluzhnik , n.  sleep , t.  spears , m.  tamura , d.  tenerelli , r.  vanderbei , b.  woodgate , r.  a. woodruff , and n.  j. woolf , `` telescope to observe planetary systems ( tops ) : a high throughput 1.2-m visible telescope with a small inner working angle , '' in _ space telescopes and instrumentation i : optical , infrared , and millimeter . edited by mather , john c. ; macewen , howard a. ; de graauw , mattheus w. m .. proceedings of the spie , volume 6265 , pp . </S>",
    "<S> 62651r ( 2006 ) . </S>",
    "<S> _ , vol . </S>",
    "<S> 6265 of _ presented at the society of photo - optical instrumentation engineers ( spie ) conference _ ( 2006 ) .    </S>",
    "<S> j.  t. trauger and w.  a. traub , `` a laboratory demonstration of the capability to image an earth - like extrasolar planet , '' nature * 446 * , 771773 ( 2007 ) .    </S>",
    "<S> a.  sivaramakrishnan , c.  d. koresko , r.  b. makidon , t.  berkefeld , and m.  j. kuchner , `` ground - based coronagraphy with high - order adaptive optics , '' * 552 * , 397408 ( 2001 ) . .    </S>",
    "<S> c.  aime and r.  soummer , `` the usefulness and limits of coronagraphy in the presence of pinned speckles , '' * 612 * , l85l88 ( 2004 ) .    c.  cavarroc , a.  boccaletti , p.  baudoz , t.  fusco , and d.  rouan , `` fundamental limitations on earth - like planet detection with extremely large telescopes , '' * 447 * , 397403 ( 2006 ) .    </S>",
    "<S> o.  guyon , e.  a. pluzhnik , m.  j. kuchner , b.  collins , and s.  t. ridgway , `` theoretical limits on extrasolar terrestrial planet detection with coronagraphs , '' * 167 * , 8199 ( 2006 ) . .    </S>",
    "<S> r.  soummer , a.  ferrari , c.  aime , and l.  jolissaint , `` speckle noise and dynamic range in coronagraphic images , '' apj * 669 * , 642656 ( 2007 ) . .    </S>",
    "<S> b.  lyot , `` tude de la couronne solaire en dehors des clipses . </S>",
    "<S> avec 16 figures dans le texte . '' </S>",
    "<S> zeitschrift fur astrophysics * 5 * , 73+ ( 1932 ) .    c.  aime , r.  soummer , and a.  ferrari , `` total coronagraphic extinction of rectangular apertures using linear prolate apodizations , '' a&a * 389 * , 334344 ( 2002 ) .    </S>",
    "<S> r.  soummer , c.  aime , and p.  e. falloon , `` stellar coronagraphy with prolate apodized circular apertures , '' * 397 * , 11611172 ( 2003 ) .    </S>",
    "<S> r.  soummer , `` apodized pupil lyot coronagraphs for arbitrary telescope apertures , '' * 618 * , l161l164 ( 2005 ) .    </S>",
    "<S> r.  soummer , l.  pueyo , a.  ferrari , c.  aime , a.  sivaramakrishnan , and n.  yaitskova , `` apodized pupil lyot coronagraphs for arbitrary telescope apertures . </S>",
    "<S> ii . application to extremely large telescopes , '' submitted to apj ( 2007 ) .    </S>",
    "<S> f.  roddier and c.  roddier , `` stellar coronagraph with phase mask , '' pasp * 109 * , 815820 ( 1997 ) .    </S>",
    "<S> r.  soummer , k.  dohlen , and c.  aime , `` achromatic dual - zone phase mask stellar coronagraph , '' * 403 * , 369381 ( 2003 ) .    </S>",
    "<S> d.  rouan , p.  riaud , a.  boccaletti , y.  clnet , and a.  labeyrie , `` the four - quadrant phase - mask coronagraph . i. principle , '' pasp * 112 * , 14791486 ( 2000 ) .    </S>",
    "<S> l.  abe , f.  vakili , and a.  boccaletti , `` the achromatic phase knife coronagraph , '' a&a * 374 * , 11611168 ( 2001 ) .    </S>",
    "<S> m.  j. kuchner and w.  a. traub , `` a coronagraph with a band - limited mask for finding terrestrial planets , '' apj * 570 * , 900908 ( 2002 ) .    </S>",
    "<S> g.  foo , d.  m. palacios , and g.  a. swartzlander , jr . </S>",
    "<S> , `` optical vortex coronagraph , '' opt . lett . * 30 * , 33083310 ( 2005 ) .    </S>",
    "<S> j.  goodman , _ introduction to fourier optics _ ( mac graw hill , 1996 ) .    </S>",
    "<S> r.  n. bracewell , _ the fourier transform & its applications _ , mcgraw - hill series in electrical and computer engineering . , 3rd ed . </S>",
    "<S> ( mcgraw - hill science / engineering / math , boston , 1999 ) .    </S>",
    "<S> a.  ferrari , r.  soummer , and c.  aime , `` an introduction to stellar coronagraphy , '' comptes rendus physique * 8 * , 277287 ( 2007 ) . .    </S>",
    "<S> d.  h. bailey and p.  n. swarztrauber , `` the fractional fourier transform and applications , '' siam review * 33*(3 ) , 389404 ( 1991 ) .    </S>",
    "<S> l.  r. rabiner , r.  w. schafer , and c.  m. rader , `` the chirp z - transform algorithm and its application , '' bell sys . </S>",
    "<S> tech . </S>",
    "<S> j. * 48*(5 ) , 12491291 ( 1969 ) .    </S>",
    "<S> j.  o. smith , _ mathematics of the discrete fourier transform ( dft ) _ </S>",
    "<S> ( w3k publishing , http://www.w3k.org/books/ , 2007 ) .    </S>",
    "<S> c.  aime , `` principle of an achromatic prolate apodized lyot coronagraph , '' * 117 * , 1012+ ( 2005 ) .    </S>",
    "<S> m.  frigo and s.  g. johnson , `` the design and implementation of fftw3 , '' proceedings of the ieee * 93*(2 ) , 216231 ( 2005 ) . special issue on `` program generation , optimization , and platform adaptation '' .    </S>",
    "<S> j.  p. lloyd and a.  sivaramakrishnan , `` tip - tilt error in lyot coronagraphs , '' * 621 * , 11531158 ( 2005 ) . .    </S>",
    "<S> a.  sivaramakrishnan and j.  p. lloyd , `` spiders in lyot coronagraphs , '' * 633 * , 528533 ( 2005 ) . .    </S>",
    "<S> l.  bluestein , `` a linear filtering approach to the computation of discrete fourier transform , '' ieee transactions on audio and electroacoustics * 18 * , 451455 ( 1970 ) .    </S>",
    "<S> a.  giveon , n.  j. kasdin , r.  j. vanderbei , and y.  avitzour , `` amplitude and phase correction for high - contrast imaging using fourier decomposition , '' in _ techniques and instrumentation for detection of exoplanets ii . edited by coulter , daniel r. proceedings of the spie , volume 5905 , pp . </S>",
    "<S> 368 - 378 ( 2005 ) . </S>",
    "<S> _ , d.  r. coulter , ed . , pp . </S>",
    "<S> 368378 ( 2005 ) .    </S>",
    "<S> a.  giveon , n.  j. kasdin , r.  j. vanderbei , and y.  avitzour , `` on representing and correcting wavefront errors in high - contrast imaging systems , '' josa a * 23 * ( 2006 ) .    </S>",
    "<S> n.  j. kasdin , r.  j. vanderbei , d.  n. spergel , and m.  g. littman , `` extrasolar planet finding via optimal apodized - pupil and shaped - pupil coronagraphs , '' * 582 * , 11471161 ( 2003 ) . http://www.journals.uchicago.edu / apj / journal / issues / apj / v582n% 2/56580/56580.web.pdf[http://www.journals.uchicago.edu / apj / journal / issues / apj / v582n% 2/56580/56580.web.pdf ] .    </S>",
    "<S> http://www.primatelabs.ca / geekbench/.    l.  a. poyneer and b.  macintosh , `` spatially filtered wave - front sensor for high - order adaptive optics , '' journal of the optical society of america a , vol .  </S>",
    "<S> 21 , issue 5 , pp.810 - 819 * 21 * , 810819 ( 2004 ) .    </S>",
    "<S> r.  ragazzoni , `` pupil plane wavefront sensing with an oscillating prism , '' journal of modern optics * 43 * , 289293 ( 1996 ) . </S>"
  ]
}