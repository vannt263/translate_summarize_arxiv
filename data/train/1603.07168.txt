{
  "article_text": [
    "we are given a bipartite graph @xmath0 where the vertices in @xmath11 are called applicants and the vertices in @xmath10 are called posts , and each vertex has a preference list ranking its neighbors in an order of preference . here",
    "we assume that vertices in @xmath11 have strict preferences while vertices in @xmath10 are allowed to have ties in their preference lists .",
    "thus each applicant ranks all posts that she finds interesting in a strict order of preference , while each post need not come up with a total order on all interested applicants  here applicants may get grouped together in terms of their suitability , thus equally competent applicants are tied together at the same rank .",
    "our goal is to compute a _",
    "popular _ matching in  @xmath5 .",
    "the definition of popularity uses the notion of each vertex casting a `` vote '' for one matching versus another .",
    "a vertex @xmath12 _ prefers _ matching @xmath3 to matching @xmath4 if either @xmath12 is unmatched in @xmath4 and matched in @xmath3 or @xmath12 is matched in both matchings and @xmath13 ( @xmath12 s partner in @xmath3 ) is ranked better than @xmath14 in @xmath12 s preference list . in an election between matchings @xmath3 and @xmath4 , each vertex @xmath12 votes for the matching that it prefers or it abstains from voting if @xmath3 and @xmath4 are equally preferable to  @xmath12 .",
    "let @xmath15 be the number of vertices that vote for @xmath3 in an election between @xmath3 and  @xmath4 .",
    "a matching @xmath3 is _ popular _ if @xmath16 for every matching  @xmath4 .",
    "if @xmath17 , then we say @xmath4 is _ more popular _ than @xmath3 and denote it by @xmath18 ; else  @xmath19 .",
    "observe that popular matchings need not always exist .",
    "consider an instance where @xmath20 and @xmath21 and for @xmath22 , each @xmath23 has the same preference list which is @xmath24 followed by @xmath25 followed by @xmath26 while each @xmath27 ranks @xmath28 the same , i.e.  @xmath28 are tied together in @xmath27 s preference list ( see bottom left instance in fig .  [",
    "fig : appa ] ) .",
    "it is easy to see that for any matching @xmath3 here , there is another matching @xmath4 such that @xmath18 , thus this instance admits no popular matching .    the popular matching problem is to determine if a given instance @xmath29 admits a popular matching or not , and if so , to compute one .",
    "this problem has been studied in the following two models .    *",
    "_ 1-sided model : _ here it is only vertices in @xmath11 that have preferences and cast votes ; vertices in @xmath10 are objects with no preferences or votes . * _ 2-sided model : _ vertices on both sides have preferences and cast votes .",
    "popular matchings need not always exist in the 1-sided model and the problem of whether a given instance admits one or not can be solved efficiently using the characterization and algorithm from  @xcite . in the 2-sided model",
    "when all preference lists are strict , it can be shown that any stable matching is popular ; thus a popular matching can be found in linear time using the gale - shapley algorithm .",
    "however when ties are allowed in preference lists on both sides , bir , irving , and manlove  @xcite showed that the popular matching problem is @xmath6-complete . in this paper",
    "we focus on the following variant :    1 .",
    "it is only vertices in @xmath11 that have preference lists ranking their neighbors , however vertices on _ both _ sides cast votes .",
    "that is , vertices in @xmath10 have no preference lists ranking their neighbors  however each @xmath2 desires to be matched to any of its neighbors . thus in an election between two matchings , @xmath7 abstains from voting if it is matched in both or unmatched in both , else it votes for the matching where it is matched .",
    "an intuitive understanding of such an instance is that @xmath11 is a set of applicants and @xmath10 is a set of tasks  while each applicant has a preference list over the tasks that she is interested in , each task just cares to be assigned to anyone who is interested in performing it .    for instance , each task is a building that seeks to have some guard assigned to it and it has no preferences over the identity of the guard .",
    "another application is in the _ many - to - one _ popular matching problem where each @xmath2 also has a capacity @xmath30 associated with it . here",
    "we seek a popular matching that can match every @xmath2 to up to @xmath30-many neighbors and we need to devise natural and succinct rules to decide when @xmath7 prefers one subset over another .",
    "a possible model is to say that @xmath7 just cares to have enough partners in the matching and it does not care about the identities of these partners .",
    "that is , we say @xmath7 prefers @xmath31 to @xmath32 if @xmath33 , where @xmath34 is the number of partners of @xmath7 in  @xmath3 .    in this paper",
    "we deal with the one - to - one setting of the above problem , i.e.  @xmath35 for all @xmath2 .",
    "we will see in section  [ sec : prelims ] that this problem is significantly different from the popular matching problem in the 1-sided model where vertices in @xmath10 do not cast votes .",
    "we show the following results here , complementing our polynomial time algorithm in theorem  [ thm : popular ] with our hardness result in theorem  [ thm : nphard ] .",
    "[ thm : popular ] let @xmath29 be a bipartite graph where each @xmath1 has a strict preference list while each @xmath2 puts all its neighbors into a single tie . the popular matching problem in @xmath5 can be solved in @xmath8 time , where @xmath36 .",
    "[ thm : nphard ] let @xmath29 be a bipartite graph where each @xmath1 has a strict preference list while each @xmath2 either has a strict preference list or puts all its neighbors into a single tie .",
    "the popular matching problem in @xmath5 is @xmath6-complete .",
    "theorem  [ thm : nphard ] follows from a simple reduction from the ( 2,2)-e3-sat problem .",
    "the ( 2,2)-e3-sat problem takes as its input a boolean formula @xmath37 in cnf , where each clause contains three literals and every variable appears exactly twice in unnegated form and exactly twice in negated form in the clauses .",
    "the problem is to determine if @xmath37 is satisfiable or not .",
    "this problem is @xmath6-complete  @xcite and our reduction shows that the following version of the 2-sided popular matching problem in @xmath29 with 1-sided ties is @xmath6-complete :    * every vertex in @xmath11 has a strict preference list of length 2 or 4 ; * every vertex in @xmath10 has either a strict preference list of length  2 or a single tie of length  2 or 3 as a preference list .    note that our @xmath6-hardness reduction needs @xmath10 to have @xmath38 vertices with strict preference lists and @xmath38 vertices with single ties as their preference lists .",
    "our algorithm that proves theorem  [ thm : popular ] performs a partition of the set @xmath10 into three sets : the first set @xmath39 is a subset of top posts and , roughly speaking , the second set @xmath40 consists of _ mid - level _ posts , while the third set @xmath41 consists of _ unwanted _ posts ( see fig .",
    "[ fig : next ] ) .",
    "applicants get divided into two sets : the set of those with one or more neighbors in the set @xmath41 ( call this set @xmath42 ) and the rest ( this set is @xmath43 ) .",
    "our algorithm performs the partition of @xmath10 into @xmath44 , and @xmath41 over several iterations .",
    "initially @xmath45 , where @xmath46 is the set of top posts , @xmath47 , and @xmath48 . in each iteration , certain top posts get _ demoted _ from @xmath39 to @xmath40 and certain non - top posts get demoted from @xmath40 to  @xmath41 . with new posts entering @xmath41 , we also have applicants moving from @xmath43 to @xmath42 . using the partition @xmath49 of @xmath10 , we will build a graph @xmath50 where each applicant keeps at most two edges : either to its most preferred post in @xmath39 and also in @xmath40 or to its most preferred post in @xmath41 and also in  @xmath40 .",
    "some dummy posts may be included in  @xmath40 .",
    "we prove that @xmath5 admits a popular matching if and only if @xmath50 admits an @xmath11-complete matching , i.e.  one that matches all vertices in  @xmath11 .",
    "we show that corresponding to any popular matching in @xmath5 , there is a partition @xmath51 of @xmath10 into _ top posts _ , _ mid - level posts _ , and _ unwanted posts _ such that @xmath52 and @xmath53 , where @xmath49 is the partition computed by our algorithm .",
    "this allows us to show that if @xmath50 does not admit an @xmath11-complete matching , then @xmath5 has no popular matching .",
    "in fact , not every popular matching in @xmath5 becomes an @xmath11-complete matching in @xmath50 ( section  [ sec : algo ] has such an example )",
    ". however it will be the case that if @xmath5 admits popular matchings , then at least one of them becomes an @xmath11-complete matching in  @xmath50 .",
    "* background .",
    "* popular matchings have been well - studied in the 1-sided model @xcite where only vertices of @xmath11 have preferences and cast votes .",
    "abraham et al .",
    "@xcite gave efficient algorithms to determine if a given instance admits a popular matching or not  their algorithm also works when preference lists of vertices in @xmath11 admit ties .",
    "the notions of _ least unpopular _ matchings  @xcite and popular _ mixed _ matchings  @xcite were also proposed to deal with instances that had no popular matchings .",
    "grdenfors  @xcite , who introduced the notion of popular matchings , considered this problem in the domain of 2-sided preference lists . in any instance @xmath54 with 2-sided strict preference lists , a stable",
    "matching is actually a minimum size popular matching and efficient algorithms for computing a maximum size popular matching were given in  @xcite .",
    "* organization of the paper .",
    "* section  [ sec : prelims ] has preliminaries .",
    "section  [ sec : algo ] contains our algorithm and its proof of correctness .",
    "section  [ sec : hardness ] shows our @xmath6-hardness result .",
    "we conclude with some open problems .",
    "for any @xmath1 , let @xmath55 denote @xmath56 s most desired , first choice post .",
    "let @xmath57 be the set of these top posts",
    ". we will refer to posts in @xmath46 as @xmath58-posts and to those in @xmath59 as non-@xmath58-posts . for any @xmath1 ,",
    "let @xmath60 be the rank of @xmath56 s most preferred non-@xmath58-post in @xmath56 s preference list ; when all of @xmath56 s neighbors are in @xmath46 , we set @xmath61 .",
    "the following theorem characterizes popular matchings in the 1-sided voting model .",
    "[ thm1 ] let @xmath54 be an instance of the 1-sided popular matching problem , where each @xmath1 has a strict preference list .",
    "let @xmath3 be any matching in  @xmath5 .",
    "@xmath3 is popular if and only if the following two properties are satisfied :    a.   @xmath3 matches every @xmath62 to some applicant @xmath56 such that @xmath63 ; b.   @xmath3 matches each applicant @xmath56 to either @xmath55 or its neighbor of rank  @xmath60 .",
    "thus the only applicants that may be left unmatched in a popular matching here are those @xmath1 that satisfy @xmath61 .",
    "let us consider the following example where @xmath20 and @xmath21 : both @xmath64 and @xmath65 have the same preference list which is @xmath66 ( @xmath24 followed by @xmath25 ) while @xmath67 s preference list is @xmath68 ( see the top left figure in fig .  [",
    "fig : appa ] ) .",
    "assume first that only applicants cast votes .",
    "the only posts that any of @xmath28 can be matched to in a popular matching here are @xmath24 and  @xmath25 .",
    "as there are three applicants and only two possible partners in a popular matching , there is no popular matching here .",
    "however in our 2-sided voting model , where posts also care about being matched and all neighbors are in a single tie , we have a popular matching @xmath69 .",
    "note that @xmath26 is ranked third in @xmath67 s preference list , which is worse than @xmath70 , however such edges are permitted in popular matchings in our 2-sided model .",
    "consider the following example ( see the middle figure in fig .",
    "[ fig : appa ] ) : @xmath71 and @xmath72 ; both @xmath64 and @xmath65 have the same preference list which is @xmath66 while @xmath67 s preference list is @xmath73 and @xmath74 s preference list is @xmath75 .",
    "there is again no popular matching here in the 1-sided model , however in our 2-sided voting model , we have a popular matching @xmath76 .",
    "note that @xmath77 and here it is matched to @xmath67 and @xmath78 ; also @xmath67 is matched to its second ranked post : this is neither its top post nor its @xmath79-th ranked post ( @xmath80 here ) .",
    "thus popular matchings in our 2-sided voting model are quite different from the characterization given in theorem  [ thm1 ] for popular matchings in the 1-sided model .",
    "our algorithm ( presented in section  [ sec : algo ] ) uses the following decomposition .",
    "[ [ dulmage - mendelsohn - decomposition . ] ] dulmage - mendelsohn decomposition  @xcite .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath3 be a maximum matching in a bipartite graph @xmath0 .",
    "using @xmath3 , we can partition @xmath81 into three disjoint sets : a vertex @xmath12 is _ even _ ( similarly , _ odd _ ) if there is an even ( resp . , odd ) length alternating path with respect to @xmath3 from an unmatched vertex to  @xmath12 .",
    "similarly , a vertex @xmath12 is _ unreachable _ if there is no alternating path from an unmatched vertex to  @xmath12 .",
    "denote by @xmath82 , @xmath83 , and @xmath84 the sets of even , odd , and unreachable vertices , respectively .",
    "the following properties ( proved in  @xcite ) will be used in our algorithm and analysis .",
    "* @xmath82 , @xmath83 , and @xmath84 are pairwise disjoint .",
    "let @xmath4 be any maximum matching in @xmath5 and let @xmath85 , @xmath86 , and @xmath87 be the sets of even , odd , and unreachable vertices with respect to @xmath4 , respectively .",
    "then @xmath88 , @xmath89 , and @xmath90 .",
    "* every maximum matching @xmath3 matches all vertices in @xmath91 and has size @xmath92 . in @xmath3 ,",
    "every vertex in @xmath83 is matched with some vertex in @xmath82 , and every vertex in @xmath84 is matched with another vertex in  @xmath84 .",
    "* the graph @xmath5 has no edge in @xmath93 .",
    "the input is @xmath94 where each applicant @xmath1 has a strict preference list while each post @xmath2 has a single tie as its preference list .",
    "our algorithm below builds a graph @xmath50 using a partition @xmath49 of @xmath10 that is constructed in an iterative manner .",
    "initialize @xmath45 , @xmath47 , and @xmath48 .    for",
    "any @xmath1 , recall that @xmath60 is the rank of @xmath56 s most preferred non-@xmath58-post . for any @xmath95 ,",
    "let @xmath96 ( similarly , @xmath97 ) denote the set of neighbors in @xmath5 ( resp .",
    ", in @xmath50 ) of the vertices in  @xmath98 .",
    "note that our algorithm will maintain @xmath99 by ensuring that @xmath100 .",
    "a.   while @xmath101 do 1 .",
    "@xmath50 is the empty graph on @xmath81 .",
    "2 .   for each @xmath102",
    "do : +  if @xmath103 then add the edge @xmath104 to  @xmath50 .",
    "3 .   for every @xmath105",
    "that is isolated in  @xmath50 do : +  delete @xmath7 from @xmath39 and add @xmath7 to  @xmath40 .",
    "4 .   for each @xmath1",
    "do : +  let @xmath7 be @xmath56 s most preferred post in the set @xmath40 ; if the rank of @xmath7 in @xmath56 s preference list is @xmath106 ( i.e.  @xmath60 or better ) , then add @xmath107 to  @xmath50 .",
    "5 .   consider the graph @xmath50 constructed in steps  1 - 3 .",
    "compute a maximum matching in  @xmath50 . _",
    "[ this is to identify `` even '' posts in  @xmath50 . ] _ * if there exist even posts in  @xmath40 then delete all even posts from @xmath40 and add them to  @xmath41 . * else quit the while - loop .",
    "b.   every @xmath108 adds the edge @xmath107 to @xmath50 where @xmath7 is @xmath56 s most preferred post in the set  @xmath41 . c.   add all posts in @xmath109 to @xmath40 , where @xmath110 is the _ dummy _ last resort post of applicant  @xmath56 . for every applicant @xmath56",
    "such that @xmath111 , add the edge @xmath112 to  @xmath50 .",
    "note that introducing dummy posts does not interfere with the voting for popular matchings because dummy posts do not vote  they are only present in the `` helper '' graph @xmath50 constructed above and not in the popular matching instance  @xmath5 . for any applicant @xmath56 , being matched to @xmath110 is equivalent to @xmath56 being left unmatched .",
    "thus any matching @xmath3 in @xmath50 can be projected to a matching in @xmath5 , by deleting all @xmath112 edges from @xmath3 and for convenience , we will refer to the resulting matching also as @xmath3 .",
    "the condition for exiting the while - loop ensures that all posts in @xmath40 , and hence all in @xmath113 , are odd / unreachable in the subgraph of @xmath50 with the set of posts restricted to _ real _ posts in @xmath113 ( i.e.  the non - dummy ones ) .",
    "so starting with a maximum matching in this subgraph and augmenting it after adding the edges on posts in @xmath41 in phase  ( ii ) and the edges on dummy posts in phase  ( iii ) , we get a maximum matching in @xmath50 that matches all real posts in  @xmath113 .",
    "after the construction of @xmath50 , our algorithm for the popular matching problem in @xmath5 is given below .",
    "* if @xmath50 admits an @xmath11-complete matching , then return one that matches all real posts in  @xmath113 ; else output `` @xmath5 has no popular matching '' .",
    "in the rest of this section , we prove the following theorem .",
    "[ thm : correctness ] @xmath5 admits a popular matching if and only if @xmath50 admits an @xmath11-complete matching , i.e.  one that matches all vertices in  @xmath11 .",
    "we present some examples here and describe how our algorithm builds the graph @xmath50 on these examples .",
    "let @xmath114 denote the sets @xmath115 at the end of the @xmath116-th iteration of our algorithm and let @xmath117 denote the graph @xmath50 in step  4 of the @xmath116-th iteration of our algorithm .",
    "= [ circle , draw = black , fill = black , inner sep=0pt , minimum size=5pt ] = [ circle , fill = white , inner sep=0pt , minimum size=15pt ]    ( a1 ) at ( 0,0 ) ; ( a2 ) at ( @xmath118 ) ; ( a3 ) at ( @xmath119 ) ; ( b1 ) at ( , 0 ) ; ( b2 ) at ( @xmath120 ) ; ( b3 ) at ( @xmath121 ) ;    ( a1 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a1 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a2 )  node[edgelabel , near start ] 2 ( b2 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( a3 )  node[edgelabel , near start ] 3 ( b3 ) ;    ( a1 ) at ( @xmath122 ) ; ( a2 ) at ( @xmath123 ) ; ( a3 ) at ( @xmath124 ) ; ( b1 ) at ( , -6 ) ; ( b2 ) at ( @xmath125 ) ; ( b3 ) at ( @xmath126 ) ;    ( a1 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a1 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( a1 ) ",
    "node[edgelabel , near start ] 3 ( b3 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 3 ( b3 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 3 ( b3 ) ;    ( a1 ) at ( 0,0 ) ; ( a2 ) at ( @xmath118 ) ; ( a3 ) at ( @xmath119 ) ; ( a0 ) at ( @xmath127 ) ; ( b1 ) at ( , 0 ) ; ( b2 ) at ( @xmath120 ) ; ( b0 ) at ( @xmath121 ) ; ( b3 ) at ( @xmath128 ) ;    ( a1 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a1 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 3 ( b2 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 2 ( b0 ) ; ( a0 )  node[edgelabel , near start ] 1 ( b0 ) ; ( a0 ) ",
    "node[edgelabel , near start ] 2 ( b3 ) ;    ( a1 ) at ( 0,0 ) ; ( a2 ) at ( @xmath118 ) ; ( a3 ) at ( @xmath119 ) ; ( x1 ) at ( @xmath127 ) ; ( x2 ) at ( @xmath129 ) ; ( b1 ) at ( , 0 ) ; ( b2 ) at ( @xmath120 ) ; ( b3 ) at ( @xmath121 ) ; ( y1 ) at ( @xmath128 ) ; ( y2 ) at ( @xmath130 ) ; ( y3 ) at ( @xmath131 ) ;    ( a1 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a1 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 1 ( b1 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 3 ( b2 ) ; ( a2 ) ",
    "node[edgelabel , very near start ] 2 ( y1 ) ; ( a3 ) ",
    "node[edgelabel , very near start ] 1 ( b1 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 2 ( b2 ) ; ( @xmath132 )  ( @xmath133 ) ; ( a3 ) ",
    "node[edgelabel , near start ] 3 ( b3 ) ; ( x1 ) ",
    "node[edgelabel , near start ] 1 ( y1 ) ; ( x1 ) ",
    "node[edgelabel , near start ] 2 ( y2 ) ; ( x1 ) ",
    "node[edgelabel , near start ] 3 ( y3 ) ; ( x2 ) ",
    "node[edgelabel , near start ] 1 ( y1 ) ; ( x2 ) ",
    "node[edgelabel , near start ] 2 ( y2 ) ;    in the first example ( top left of fig .  [",
    "fig : appa ] ) , we have @xmath20 and @xmath21 and the preferences of applicants are denoted on the edges . by our initialization , we have @xmath134 , @xmath135 , and @xmath136 . in step  4 of our first iteration , we identify @xmath26 as an even post in  @xmath137 .",
    "so @xmath138 and @xmath139 .",
    "in the second iteration , @xmath140 and so it has no edge to @xmath24 in  @xmath141 .",
    "this is the last iteration of our algorithm .",
    "our final graph @xmath50 has the edge set @xmath142 .",
    "while the above example admits a popular matching , consider the graph in the bottom left of fig .",
    "[ fig : appa ] .",
    "the first iteration of our algorithm is exactly the same on this graph as it was with the earlier graph .",
    "we have @xmath143 , @xmath138 , and @xmath139 .",
    "however in the second iteration , all the applicants @xmath28 become elements of @xmath144 and @xmath24 becomes an isolated vertex in step  2 , so @xmath24 becomes an element of  @xmath145 . in step  4 of the second iteration ,",
    "@xmath25 is identified as an even post in @xmath141 as it is isolated in  @xmath141 .",
    "so @xmath146 and @xmath147 .",
    "no demotions happen in the third iteration , which is the last iteration of our algorithm .",
    "our final graph @xmath50 has the edge set @xmath148 . observe that @xmath50 has no @xmath11-complete matching .    in the third example",
    "( middle of fig .",
    "[ fig : appa ] ) , we have @xmath71 and @xmath72 and the preferences of applicants are again denoted on the edges . in step  4 of the first iteration of this algorithm ,",
    "the post @xmath26 is identified as an even vertex in @xmath149 and it becomes an element of  @xmath150 .",
    "so @xmath151 and @xmath152 becomes isolated in step  2 of the second iteration .",
    "so @xmath152 becomes an element of @xmath145 and this is the last iteration of our algorithm .",
    "our final graph @xmath50 has the edge set @xmath153 .",
    "this graph admits an @xmath11-complete matching @xmath154 .    the fourth example here ( the rightmost graph in fig .  [ fig : appa ] )",
    "is that of a graph @xmath5 with several popular matchings .",
    "it is not the case that @xmath50 contains all these matchings . at the end of our entire algorithm , we have @xmath155 , @xmath156 , and @xmath157 .",
    "the graph @xmath50 does not contain the edges @xmath158 and @xmath159 since @xmath67 and @xmath160 belong to  @xmath42 .",
    "the subgraph @xmath50 admits an @xmath11-complete matching @xmath161 and this is a popular matching in  @xmath5 .",
    "however @xmath50 does not contain @xmath162 , @xmath163 , which is another popular matching in  @xmath5 .",
    "in fact , any subgraph that contains both @xmath3 and @xmath4 would also contain the following @xmath11-complete matching @xmath164 , which is _ not _ popular .",
    "we first show that if @xmath50 admits an @xmath11-complete matching , then @xmath5 admits a popular matching .",
    "we have already observed that if @xmath50 admits an @xmath11-complete matching , then @xmath50 has an @xmath11-complete matching @xmath3 that matches all real posts in  @xmath113 .",
    "a useful observation is that @xmath165 .",
    "this is because in step  4 of the while - loop in our algorithm , all @xmath58-posts in @xmath40 are odd / unreachable in @xmath50 as they are the only neighbors in @xmath50 of applicants who regard them as @xmath58-posts .",
    "we now assign edge labels in @xmath166 to all edges in  @xmath167 : for an edge @xmath107 in @xmath167 , if @xmath56 prefers @xmath7 to @xmath168 , then we label this edge @xmath169 , else we label this  @xmath170 .",
    "the label of @xmath107 is basically @xmath56 s vote for @xmath7 vs  @xmath168 .",
    "[ fig : next ] is helpful here .",
    "for any @xmath171 , let @xmath172 be the set of applicants matched in @xmath3 to posts in  @xmath98 .",
    "the following lemma is important .",
    "[ lem : edge - signs ] every edge of @xmath5 in @xmath173 is labeled  @xmath170 ; similarly , every edge in @xmath174 is labeled  @xmath170 . any edge labeled  @xmath169",
    "has to be either in @xmath175 or in @xmath176 .",
    "every edge of @xmath177 that is present in @xmath50 is a top ranked edge .",
    "since @xmath3 belongs to @xmath50 , the edges of @xmath3 from @xmath177 are top ranked edges .",
    "thus it is clear that every edge of @xmath5 in @xmath173 is labeled  @xmath170 .",
    "regarding @xmath174 , every edge of @xmath178 that is present in the graph @xmath50 is an edge @xmath107 where the rank of @xmath7 in @xmath56 s preference list is @xmath106 ( i.e.  @xmath60 or better ) ; on the other hand , every edge of @xmath179 that is present in the graph @xmath50 is an edge @xmath180 where the rank of @xmath181 in @xmath56 s preference list is @xmath182 ( because @xmath183 ) . since @xmath3 belongs to @xmath50 ,",
    "the edges of @xmath3 from @xmath184 are ranked better than the edges of  @xmath179 .",
    "thus every edge of @xmath5 in @xmath174 is labeled  @xmath170 .",
    "we now show that any edge labeled  @xmath169 has to be in either @xmath175 or @xmath176 ( see fig .",
    "[ fig : next ] ) . consider any edge @xmath185 such that @xmath186 and @xmath187 , where @xmath171 .",
    "it follows from the construction of the graph @xmath50 that a vertex in @xmath96 can be adjacent in @xmath50 to only its most preferred post in  @xmath98 .",
    "thus any edge @xmath185 where @xmath186 and @xmath187 is ranked  @xmath170 .",
    "we have already seen that all edges in @xmath173 and in @xmath174 are labeled  @xmath170 .",
    "there are no edges in @xmath188 since @xmath189 .",
    "thus any edge labeled  @xmath169 has to be in either @xmath175 or @xmath176 .",
    "let @xmath4 be any matching in  @xmath5 .",
    "the symmetric difference of @xmath4 and @xmath3 is denoted by @xmath190 : this consists of alternating paths and alternating cycles  note that edges here alternate between @xmath3 and  @xmath4 . recall that last resort posts are not used in  @xmath4 ( which is a matching in @xmath5 ) whereas last resort posts may be present in  @xmath3 ( which is a matching in @xmath50 ) .",
    "[ lem:1 - 3 ] consider @xmath190 .",
    "the following three properties hold :    a.   [ le2i ] in any alternating cycle in @xmath190 , the number of edges that are labeled  @xmath170 is at least the number of edges that are labeled  @xmath169",
    ". b.   [ le2ii ] in any alternating path in @xmath190 , the number of edges that are labeled  @xmath169 is at most _ two plus _ the number of edges that are labeled  @xmath170 ; in case one of the endpoints of this path is a last resort post , then the number of edges labeled  @xmath169 is at most _ one plus _ the number of edges labeled  @xmath170 . c.   [ le2iii ] in any even length alternating path in @xmath190 ,",
    "the number of edges that are labeled  @xmath170 is at least the number of edges that are labeled  @xmath169 ; in case one of the endpoints of this path is a last resort post , then the number of edges labeled  @xmath170 is at least _",
    "one plus _ the number of edges labeled  @xmath169 .    _ property  ( [ le2i ] ) .",
    "_ let @xmath191 be an alternating cycle .",
    "let @xmath192 be @xmath152-@xmath74-@xmath24-@xmath64-@xmath25-@xmath193-@xmath194-@xmath152 , where @xmath195 for @xmath196 . if @xmath192 contains no vertex of @xmath41 , then there can not be two consecutive non - matching edges labeled  @xmath169 in  @xmath192 .",
    "that is , if @xmath197 is labeled  @xmath169 , then @xmath198 and there is no @xmath169 edge incident on @xmath199 , thus the non - matching edge incident on @xmath200 in @xmath192 has to be labeled  @xmath170 .",
    "hence the number of edges that are labeled  @xmath170 is at least the number of edges that are labeled  @xmath169 .",
    "suppose @xmath192 contains a vertex of  @xmath41 : let @xmath27 be such a vertex .",
    "there can be two consecutive non - matching edges labeled  @xmath169 now : let @xmath27-@xmath23-@xmath201-@xmath200-@xmath202 be such an alternating path within @xmath192 , where both @xmath197 and @xmath203 are labeled  @xmath169 .",
    "then @xmath204 , @xmath205 , and @xmath206 .",
    "in the first place , there is no @xmath169 edge incident on @xmath207 and the crucial part is that there is _ no _ edge in @xmath5 between a vertex in @xmath208 and a vertex in  @xmath41 .",
    "thus once we reach a vertex @xmath209 , we have to see an edge labeled @xmath170 and so as to reach a vertex in @xmath41 , we need to see at least _ two _ consecutive non - matching edges labeled  @xmath170 .",
    "thus it again follows that the number of edges that are labeled  @xmath170 is at least the number of edges that are labeled  @xmath169 .",
    "_ property  ( [ le2ii ] ) .",
    "_ let @xmath210 be an alternating path .",
    "let @xmath211 be @xmath152-@xmath74-@xmath24-@xmath64-@xmath25-@xmath193-@xmath194-@xmath212-@xmath213 , where @xmath195 for @xmath214 .",
    "the same argument that was used in the proof of property  ( [ le2i ] ) shows us that there can be at most two consecutive non - matching edges labeled  @xmath169 in @xmath211 and once we traverse such an alternating path @xmath27-@xmath23-@xmath201-@xmath200-@xmath202 in @xmath211 ( where @xmath27 has to be in @xmath41 ) , we are at a vertex  @xmath206 .",
    "thereafter we have to see at least two more non - matching edges labeled  @xmath170 than those labeled  @xmath169 to again reach a vertex in  @xmath41 .",
    "thus it follows that the difference between the number of edges that are labeled  @xmath169 and the number of edges that are labeled  @xmath170 is at most two .",
    "in fact , for the difference between the number of edges that are labeled  @xmath169 and the number of edges that are labeled  @xmath170 to be exactly two , it has to be the case that @xmath152 is in  @xmath41 . for , in case",
    "@xmath152 is in @xmath40 , then it is easy to see that the difference between the number of non - matching edges that are labeled  @xmath169 and the number of non - matching edges that are labeled @xmath170 is at most one .",
    "note that all last resort posts belong to  @xmath40 .",
    "thus when @xmath152 is a last resort post , then the number of edges labeled  @xmath169 in @xmath211 is at most _ one plus _ the number of edges labeled  @xmath170 .    _",
    "property  ( [ le2iii ] ) .",
    "_ let @xmath215-@xmath74-@xmath24-@xmath64-@xmath25-@xmath193-@xmath194-@xmath212 be an even length alternating path where @xmath195 for @xmath196 .",
    "the post @xmath152 is unmatched in @xmath4 and @xmath212 is unmatched in  @xmath3 .",
    "recall that @xmath3 is @xmath11-complete , thus any even length alternating path with respect to @xmath3 has to have vertices in @xmath10 as its endpoints ( since one of them is left unmatched in  @xmath3 ) .",
    "since @xmath212 is a post that is matched in @xmath4 but not in @xmath3 , it follows that @xmath216 ( as all non - dummy posts in @xmath113 are matched in  @xmath3 ) .",
    "now the argument is similar to the proof of property  ( [ le2ii ] ) . in order to maximize the difference between the number of edges labeled  @xmath169 and those labeled  @xmath170",
    ", we assumed that the starting vertex @xmath217 .",
    "for the final vertex @xmath212 to be in @xmath41 , it follows that the number of edges that are labeled  @xmath170 is at least the number of edges that are labeled  @xmath169 .",
    "in particular , when @xmath152 is a last resort post , then the starting vertex is in @xmath40 and so the number of edges that are labeled  @xmath170 is at least _",
    "one plus _ the number of edges that are labeled  @xmath169 .",
    "lemma  [ new - cor ] uses the above lemma to show the popularity of  @xmath3 .",
    "this completes the proof that if @xmath50 admits an @xmath11-complete matching then @xmath5 admits a popular matching .",
    "[ new - cor ] for any matching @xmath4 in @xmath5 , we have @xmath16 .",
    "recall that @xmath3 is @xmath11-complete ( where some of the posts used in @xmath3 can be last resort posts ) . for any @xmath1 and any neighbor @xmath7 of @xmath56 such that @xmath218 , let @xmath219 be the label of the edge @xmath107 , which is @xmath56 s vote for @xmath7 vs  @xmath168 .",
    "consider @xmath220 .",
    "we will now investigate each component of @xmath220  being a cycle , an odd path or an even path  and show @xmath16 for each of them .",
    "* for any alternating cycle @xmath191 , among the vertices of @xmath192 , the difference between those who prefer @xmath4 and those who prefer @xmath3 is equal to @xmath221 .",
    "it follows from property  ( [ le2i ] ) that this sum is at most 0 . *",
    "consider any odd length alternating path @xmath210 : its endpoints are an applicant @xmath222 and a post @xmath181 that are unmatched in  @xmath4 .",
    "assume @xmath181 is a non - dummy post . then among the vertices of @xmath211 that are matched in @xmath4 , the difference between those who prefer @xmath4 and those who prefer @xmath3 is equal to @xmath223 .",
    "it follows from property  ( [ le2ii ] ) that this sum is at most  2 .",
    "the two vertices @xmath222 and @xmath181 prefer @xmath3 to @xmath4 as they are matched in @xmath3 and unmatched in @xmath4 , since @xmath222 is unmatched in  @xmath4 .",
    "thus summed over all vertices of @xmath211 , the difference between those who prefer @xmath4 and those who prefer @xmath3 is again at most 0 .",
    "+ now suppose @xmath181 is a dummy post .",
    "then it follows from property  ( [ le2ii ] ) that among the vertices of @xmath211 that are matched in @xmath4 , the difference between those who prefer @xmath4 and those who prefer @xmath3 is at most 1 .",
    "the vertex @xmath222 prefers @xmath3 to  @xmath4 .",
    "thus summed over all real vertices of @xmath211 , the difference between those who prefer @xmath4 and those who prefer @xmath3 is again at most 0 . *",
    "consider any even length alternating path @xmath210 : its endpoints are a post @xmath152 that is unmatched in @xmath4 and a post @xmath212 that is unmatched in  @xmath3 .",
    "assume @xmath152 is a non - dummy post .",
    "then summed over all vertices of @xmath211 ( this includes @xmath152 who prefers @xmath3 and @xmath212 who prefers @xmath4 ) , the difference between those who prefer @xmath3 and those who prefer @xmath4 is at least 0 ( by property  ( [ le2iii ] ) ) .",
    "+ now suppose @xmath152 is a dummy post .",
    "then summed over all real vertices of @xmath211 that are matched in @xmath3 , the difference between those who prefer @xmath3 and those who prefer @xmath4 is at least 1 ( by property  ( [ le2iii ] ) ) .",
    "thus summed over all real vertices of @xmath211 ( this includes @xmath212 who prefers @xmath4 ) , the difference between those who prefer @xmath3 and those who prefer @xmath4 is at least 0 .",
    "all vertices whose partners in @xmath3 and in @xmath4 are different belong to some alternating path or cycle in  @xmath220 .",
    "hence the difference between the number of vertices that prefer @xmath3 and those that prefer @xmath4 is non - negative .",
    "in other words , @xmath16 .      we now show the other side of theorem  [ thm : correctness ] .",
    "that is , if @xmath5 admits a popular matching , then @xmath50 admits an @xmath11-complete matching .",
    "let @xmath224 be a popular matching in  @xmath5 .",
    "lemma  [ lem : pop - mat ] will be useful to us .",
    "[ lem : pop - mat ] if @xmath225 and @xmath62 , then @xmath7 has rank better than @xmath60 in @xmath56 s preference list .",
    "suppose @xmath225 , where @xmath62 , and @xmath7 has rank worse than @xmath60 in @xmath56 s preference list .",
    "note that the rank of @xmath7 can not be exactly @xmath60 since there is another post @xmath226 that has rank @xmath60 in @xmath56 s preference list .",
    "we know that @xmath227 prefers post @xmath181 to  @xmath7 .",
    "if post @xmath181 is unmatched , then consider @xmath228 where @xmath229-@xmath74-@xmath7-@xmath56-@xmath181 , where @xmath74 is an applicant such that @xmath230 ( there exists such an applicant since @xmath62 ) .",
    "the matching @xmath228 is more popular than  @xmath224 .",
    "so suppose the post @xmath181 is matched and let @xmath231 .",
    "if @xmath232 , then consider the alternating cycle @xmath233-@xmath7-@xmath56-@xmath181-@xmath74 ; the matching @xmath234 makes @xmath74 and @xmath56 swap their partners and both applicants prefer @xmath234 to @xmath224 while nobody prefers @xmath224 to  @xmath234 .",
    "thus @xmath234 is more popular than  @xmath224 .",
    "if @xmath235 , then consider the alternating path @xmath211 that promotes @xmath74 to its top post @xmath7 and then @xmath236 to a more preferred post @xmath181 and finally , @xmath237 to its top post  @xmath238 .",
    "the vertices @xmath239 and @xmath240 become unmatched in @xmath241 and so they prefer @xmath224 to @xmath241 while the three vertices @xmath242 , and @xmath64 prefer @xmath241 to  @xmath224 . every other vertex is indifferent between @xmath241 and  @xmath224 .",
    "so @xmath241 is more popular than  @xmath224 .",
    "thus we have contradicted the popularity of @xmath224 in all the cases .",
    "analogous to section  [ sec : suff ] , we label the edges of @xmath243 by @xmath169 or  @xmath170 : the label of an edge @xmath107 in @xmath243 is the vote of @xmath56 for @xmath7 vs  @xmath244 . in case @xmath56 is not matched in @xmath224 , then @xmath245 for any neighbor @xmath7 of  @xmath56 . due to the popularity of @xmath224 ,",
    "the following two properties hold on these edge labels ( otherwise @xmath246 ) .    1 .",
    "there is no alternating path @xmath211 such that the edge labels in @xmath247 are @xmath248 , i.e.no three consecutive non - matching edges are labeled  @xmath169 .",
    "2 .   there is no alternating path @xmath211 where the edge labels in @xmath247 are @xmath249 , @xmath250 , i.e.no five consecutive non - matching edge labels add up to  4 .",
    "based on the matching @xmath224 and the edge labels on @xmath243 , we partition @xmath10 into @xmath251 .    * roughly speaking , @xmath252 consists of unwanted posts , so all posts that are unmatched in @xmath224 belong to @xmath252 .",
    "similarly , posts like @xmath26 with a length-5 alternating path @xmath253-@xmath24-@xmath254-@xmath25-@xmath255-@xmath26 incident on them , with both the non - matching edges labeled  @xmath169 ( see fig .  [",
    "fig : partition ] ) are in @xmath252 .",
    "* top posts are split across @xmath256 and @xmath257 : property  @xmath258 indicates that applicants matched to posts in @xmath256 should not be adjacent to posts in @xmath252 , hence those top posts whose partners have neighbors in @xmath252 are in  @xmath257 and the top posts whose partners have _ no _ neighbors in @xmath252 are in  @xmath256 .    more formally , we define the partition @xmath259 below .    1 .   initialize @xmath260 and @xmath261 is unmatched in  @xmath262 .",
    "we now add more posts to the sets @xmath263 as described below .",
    "2 .   for each length-5 alternating path @xmath264-@xmath24-@xmath65-@xmath25-@xmath67-@xmath26",
    "where @xmath265 and both @xmath266 and @xmath267 are marked  @xmath169 , add @xmath27 to  @xmath268 , for @xmath22 .",
    "3 .   now consider those @xmath2 that are matched in @xmath224 but @xmath7 is not a part of any length-5 alternating path where both the non - matching edges are labeled  @xmath169 .",
    "we repeat the following two steps till there are no more posts to be added to either @xmath257 or  @xmath252 via these rules : * suppose @xmath269 has no @xmath169 edge incident on it : if @xmath270 , then add @xmath7 to  @xmath257 . *",
    "if @xmath269 has a @xmath169 edge to a vertex in @xmath257 , then add @xmath7 to  @xmath252 .",
    "4 .   for each @xmath7 such that @xmath269 has no @xmath169 edge incident on it : * if @xmath271 , then add @xmath7 to  @xmath256 .",
    "5 .   for each @xmath7 not yet in @xmath272 and @xmath269 has a @xmath169 edge to a vertex in @xmath256 : * add @xmath7 to  @xmath257 .",
    "[ lemma - f ] recall that @xmath46 is the set of top posts .",
    "the above partition @xmath51 satisfies the following properties :    1 .",
    "@xmath273 ; 2 .",
    "@xmath274 .",
    "suppose @xmath275 belongs to  @xmath252 .",
    "the post @xmath24 has to be matched in  @xmath224 .",
    "let @xmath276 and we also know from the construction of the set @xmath252 that there is an edge @xmath277 with @xmath278 that is labeled  @xmath169 .",
    "if the vertex @xmath74 is unmatched in @xmath224 , then by promoting @xmath74 to @xmath24 and @xmath64 to @xmath25 , and leaving @xmath254 unmatched , we obtain a matching that is more popular than  @xmath224 .",
    "hence let us assume that @xmath74 is matched in  @xmath224 .",
    "consider the alternating path @xmath239-@xmath74-@xmath24-@xmath64-@xmath25 with respect to  @xmath224 : this has two consecutive non - matching edges that are labeled  @xmath169 .",
    "thus it follows from our construction of @xmath279 that @xmath280 , @xmath281 , and @xmath282 .",
    "this contradicts our assumption that @xmath283 .",
    "this finishes the proof of ( 1 ) .",
    "we first state the following claim , which will be used in the proof of ( 2 ) .",
    "we will assume claim  [ lem : alt - path ] and finish the proof of ( 2 ) and then prove this claim .",
    "[ lem : alt - path ] if @xmath284 and @xmath285 , then there is an alternating path @xmath286 with respect to @xmath224 with @xmath56 as an endpoint such that either @xmath286 is even and the edge labels on @xmath287 are @xmath288 or @xmath286 is odd and the edge labels on @xmath287 are @xmath289 where the last edge is incident on an unmatched post .",
    "we now use claim  [ lem : alt - path ] to show that @xmath274 .",
    "posts get added to @xmath256 in steps  1 and  3 of the partition scheme .",
    "let @xmath24 be a post that got added to @xmath256 in step  1  then there is an alternating path @xmath290-@xmath25-@xmath65-@xmath24-@xmath64 where both @xmath267 and @xmath266 are labeled  @xmath169 .",
    "we know from property  @xmath291 that @xmath292 ; if @xmath293 , then there is an alternating path @xmath294 as described in claim  [ lem : alt - path ] .",
    "if the posts @xmath65 and @xmath67 do not appear in @xmath294 , then consider the alternating path @xmath295 which consists of @xmath296 followed by  @xmath294 .",
    "it is easy to see that @xmath297 is more popular than @xmath224 : a contradiction to the popularity of  @xmath224 .    in case @xmath65",
    "appears in @xmath294 , then we have an alternating cycle @xmath192 , which is @xmath294 truncated till the vertex @xmath65 followed by @xmath65-@xmath24-@xmath64 .",
    "this cycle has a stretch of alternating @xmath170 and @xmath169 labeled non - matching edges along with two consecutive non - matching edges labeled  @xmath169 : these are the edge @xmath266 and the edge incident on @xmath25 in @xmath294 from a vertex in  @xmath298 . thus @xmath234 is more popular than @xmath224 : a contradiction again .",
    "if @xmath67 appears in @xmath294 , then we can again construct an alternating cycle @xmath299 ( using the @xmath300 subpath of @xmath294 followed by the alternating path @xmath296 ) . the matching @xmath301 is more popular than @xmath224 since @xmath299 has more @xmath169 labeled non - matching edges than @xmath170 labeled non - matching edges .",
    "this again contradicts the popularity of  @xmath224 .",
    "regarding posts added to @xmath256 in step  3 , we add any post @xmath7 to @xmath256 only after checking that @xmath271 .",
    "this completes the proof that @xmath274 .",
    "[ [ proof - of - claimlemalt - path . ] ] proof of claim  [ lem : alt - path ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    posts are added to @xmath252 in steps 1 , 2 and  3 .",
    "we now study each of these cases .",
    "the set @xmath252 was initialized to the set of posts left unmatched in  @xmath224 .",
    "so at the end of step  0 , it is the case that every @xmath284 has an odd alternating path , which is in fact an edge @xmath107 labeled  @xmath170 , whose one endpoint is @xmath56 and the other endpoint is an unmatched post  @xmath7",
    ".    let @xmath26 be a post that got added to @xmath252 in step  1 .",
    "then there is an alternating path @xmath26-@xmath67-@xmath25-@xmath65-@xmath24-@xmath64 such that @xmath302 for @xmath22 , and both @xmath267 and @xmath266 are marked  @xmath169 .",
    "thus every neighbor @xmath303 with @xmath285 has an even length alternating path @xmath304-@xmath26-@xmath67-@xmath25-@xmath65-@xmath24-@xmath64 where the edge labels on @xmath287 are @xmath305 .",
    "note that @xmath306 ",
    "otherwise @xmath286 is an alternating cycle and @xmath307 is more popular than  @xmath224 .",
    "thus the claim that every @xmath284 with @xmath285 has a desired alternating path @xmath286 is true at the end of step  1 .",
    "let @xmath26 be a post that got added to @xmath252 in step  2 and let us assume that till the point @xmath26 gets added to @xmath252 , the claim holds .",
    "since @xmath26 was added to @xmath252 in step  2 , this was due to a @xmath169 edge between @xmath308 and a post @xmath278 whose partner @xmath309 regards @xmath25 as a top post .",
    "the post @xmath278 because its partner @xmath310 .",
    "this means there is a desired alternating path @xmath311 incident on  @xmath65 .",
    "neither @xmath26 nor @xmath25 lies on @xmath311 since all the posts in @xmath311 that belong to @xmath312 were added to @xmath312 prior to @xmath25 joining @xmath257 and @xmath26 joining  @xmath252 .",
    "consider any neighbor @xmath56 of @xmath26 that is in @xmath313 because @xmath314 and @xmath285 .",
    "the desired alternating path @xmath286 is @xmath56-@xmath26-@xmath67-@xmath25-@xmath65 followed by  @xmath311 .",
    "we will use the partition @xmath315 of @xmath10 to build the following subgraph @xmath316 of  @xmath5 . for each @xmath1 , include the following edges in  @xmath317 :    * if @xmath318 , then add the edge @xmath104 to  @xmath317 . * if @xmath56 has a neighbor of rank @xmath106 in @xmath257 , then add the edge @xmath107 to @xmath317 , where @xmath7 is @xmath56 s most preferred neighbor in  @xmath257 . * if @xmath284 , then add the edge @xmath107 to @xmath317 , where @xmath7 is @xmath56 s most preferred neighbor in  @xmath252 .",
    "[ lem : main ] every edge of the matching @xmath224 belongs to the graph  @xmath319 .",
    "the set @xmath10 has been partitioned into @xmath251 .",
    "we will now show that for each post @xmath152 that is matched in @xmath224 , the edge @xmath320 belongs to  @xmath319 .",
    "we distinguish three cases : @xmath321 , @xmath322 and @xmath323 .",
    "_  case  1 . _ the post @xmath321 .",
    "hence there is no @xmath169 edge incident on @xmath324 , in other words , @xmath325 .",
    "lemma  [ lemma - f].2 tells us that @xmath274 ; hence @xmath74 has no neighbor in @xmath252 and by rule  ( i ) above , the edge @xmath326 belongs to the edge set of  @xmath319 .    _",
    " case  2 .",
    "_ next we consider the case when @xmath322 .",
    "it is easy to see that @xmath152 has to be @xmath74 s most preferred post in @xmath257 , where @xmath324 .",
    "otherwise there would have been an edge @xmath327 labeled  @xmath169 with @xmath281 , where @xmath24 is @xmath74 s most preferred post in  @xmath257 . then either @xmath328 or @xmath323 ( from how we construct the sets @xmath263 ) , a contradiction",
    "we now have to show that the rank of @xmath152 in @xmath74 s preference list is @xmath106 , otherwise the edge @xmath329 does not belong to  @xmath319 .",
    "suppose @xmath77 .",
    "since the edge @xmath330 , which is a popular matching , it follows from lemma  [ lem : pop - mat ] that @xmath152 is ranked better than @xmath331 in @xmath74 s preference list ; thus the edge @xmath329 belongs to  @xmath319 .",
    "so the case left is when @xmath332 .",
    "if @xmath152 is not @xmath74 s most preferred post outside @xmath46 , then there is the length-5 alternating path @xmath333-@xmath74-@xmath24-@xmath64-@xmath238-@xmath240 , where @xmath24 is the most preferred post of @xmath74 outside @xmath46 and @xmath276 .",
    "the alternating path @xmath211 has two consecutive non - matching edges @xmath327 and @xmath334 that are labeled  @xmath169 .",
    "this contradicts the presence of @xmath152 in @xmath257 as such a post would have to be in  @xmath252 .",
    "thus if @xmath332 , then @xmath152 has to be @xmath74 s most preferred post outside @xmath46 , i.e.@xmath152 has rank @xmath331 in @xmath74 s preference list .    _  case 3 .",
    "_ we finally consider the case when the post @xmath323 .",
    "we need to show that @xmath152 is the most preferred post of @xmath324 in  @xmath252 .",
    "suppose not .",
    "let @xmath24 be @xmath74 s most preferred post in  @xmath252 . since @xmath283 while @xmath335 ( by lemma  [ lemma - f].1 ) , we know that there is an edge labeled  @xmath169 incident on @xmath276 .",
    "let this edge be  @xmath277 and let @xmath65 be  @xmath254 .",
    "so there is a length-5 alternating path @xmath336-@xmath74-@xmath24-@xmath64-@xmath25-@xmath65 where both the non - matching edges @xmath327 and @xmath277 are labeled  @xmath169 .",
    "this contradicts the presence of @xmath24 in @xmath252 as such a post would have to be in  @xmath257 .",
    "thus @xmath152 is @xmath74 s most preferred post in  @xmath252 .",
    "the following lemma shows the relationship between the partition @xmath51 and the partition @xmath49 constructed by our algorithm that builds the graph  @xmath50 .",
    "[ lem : l1andx ] the set @xmath52 and the set @xmath53 .    in our algorithm that constructs the graph @xmath50 and the partition @xmath337 , the set @xmath39 is initialized to @xmath46 and the set @xmath40 is initialized to  @xmath59 .",
    "as our algorithm progresses , in each iteration of the while - loop , some @xmath58-posts get demoted from @xmath39 to @xmath40 and similarly , some non-@xmath58-posts get demoted from @xmath40 to @xmath41 till there is an iteration ( say , iteration @xmath338 ) where all posts in @xmath40 are odd / unreachable in @xmath50  this is the last iteration of the while - loop .    for any @xmath339 ,",
    "let @xmath340 ( similarly , @xmath341 ) be the set of posts that got demoted from @xmath40 to @xmath41 ( resp .",
    ", @xmath39 to @xmath40 ) in the @xmath342-th iteration of the while - loop in our algorithm .",
    "we have @xmath343 .",
    "note that @xmath344 since @xmath41 is initialized to @xmath345 , so in the first iteration of our algorithm , _ every _",
    "@xmath58-post @xmath7 has a neighbor @xmath346 such that @xmath347 .",
    "thus no post is demoted from @xmath39 to @xmath40 in the first iteration .",
    "the graph @xmath137 is the subgraph of @xmath5 where each @xmath1 has at most two neighbors : its top post and when @xmath348 , its neighbor of rank  @xmath60 .",
    "let @xmath349 be the set of posts in @xmath59 that are odd / unreachable in the graph  @xmath137 .",
    "the set @xmath350 is the set of even non-@xmath58-posts in  @xmath137 , i.e.  @xmath351 .",
    "we will use the following claims and finish the proof of this lemma ( the proofs of claims  [ lemma - t]-[lem : z1 ] are given after the proof of lemma  [ lem : l1andx ] ) .",
    "[ lemma - t ] the set @xmath352 .",
    "[ lem : f1 ] for any @xmath353 , if @xmath354 then @xmath355 .",
    "[ lem : z1 ] for any @xmath356 , if @xmath357 then @xmath358 .",
    "claim  [ lemma - t ] tells us that @xmath352 .",
    "we now use claims  [ lem : f1 ] and [ lem : z1 ] alternately to conclude that for every @xmath353 , we have @xmath359 and @xmath360 .    thus the set @xmath361 is a subset of @xmath252 and the set @xmath362 is a subset of  @xmath257 . since @xmath363 , it follows that @xmath364 .",
    "[ [ proof - of - claimlemma - t . ] ] proof of claim  [ lemma - t ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    any post in @xmath350 that is left unmatched in @xmath224 has to belong to  @xmath252 .",
    "similarly , any @xmath365 that is matched to an applicant @xmath74 that ranks @xmath152 worse than @xmath331 has to belong to  @xmath252 : this is because there is a length-5 alternating path @xmath336-@xmath74-@xmath24-@xmath64-@xmath25-@xmath65 where @xmath24 is a post of rank @xmath331 in @xmath74 s preference list , @xmath276 , and @xmath366 .",
    "the path @xmath296 has two consecutive non - matching edges that are labeled  @xmath169 , so @xmath323 .",
    "now consider any @xmath365 that is matched in @xmath224 to an applicant @xmath74 such that the rank of @xmath329 is  @xmath331 .",
    "so @xmath74 is a neighbor of @xmath152 in  @xmath137 .",
    "since @xmath152 is even in @xmath137 , all the neighbors of @xmath152 in @xmath137 are odd and thus they have to be of degree _ exactly _ 2 in @xmath137 ( recall that all applicants have degree at most 2 in @xmath137 ) .",
    "thus the neighbors of these applicants are again even .",
    "let @xmath192 be the connected component containing @xmath152 in  @xmath137 .",
    "it is easy to see that in @xmath192 , all posts are even , all applicants are odd , and the number of posts is more than the number of applicants .",
    "( in fact , @xmath192 is a tree with @xmath152 as the root and the number of posts in @xmath192 is _ one _ plus the number of applicants in  @xmath192 . )    if @xmath322 , then @xmath74 s other neighbor in @xmath192 , which is @xmath367 , has to be in @xmath256 since there is a @xmath169 edge from @xmath74 to  @xmath367 .",
    "this means @xmath367 is matched to an applicant @xmath368 that ranks it as a top post , so the applicant @xmath368 is a neighbor of @xmath367 in  @xmath192 .",
    "there has to be another neighbor of @xmath368 in @xmath192 , call this  @xmath24 .",
    "the important observation is that @xmath24 can not be in @xmath252 as that would violate lemma  [ lemma - f].2 since @xmath369 .",
    "so @xmath281 and this means @xmath24 is matched to an applicant @xmath64 that ranks it @xmath370 , in other words , @xmath64 is a neighbor of @xmath24 in  @xmath192 .",
    "so @xmath238 has to be in @xmath256 and we continue in this manner marking all @xmath58-posts in @xmath192 as elements of @xmath256 and all non-@xmath58-posts in @xmath192 as elements of  @xmath257 .",
    "this means all posts in @xmath192 are matched to their neighbors in @xmath192 , however this is not possible as there are more posts than applicants in  @xmath192 .",
    "this contradicts our assumption that @xmath322 , in other words , @xmath152 has to be in  @xmath252 .",
    "thus @xmath352 .    [",
    "[ proof - of - claimlemf1 . ] ] proof of claim  [ lem : f1 ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    the set @xmath371 is the set of posts that got demoted from @xmath39 to @xmath40 in the @xmath372-th iteration of the while - loop : this means each post @xmath7 in @xmath371 had no applicant outside @xmath373 that regarded @xmath7 as an @xmath58-post . in other words , every applicant @xmath56 such that @xmath347 belongs to @xmath373 . since @xmath360 , each such applicant",
    "@xmath56 is present in  @xmath313 .",
    "let @xmath374 .",
    "for @xmath375 , let @xmath302 : if @xmath376 , then @xmath377 ( because @xmath378 ) ; else there is an edge @xmath379 that is labeled  @xmath169 incident on @xmath23 and hence @xmath27 can not be in  @xmath256 .",
    "thus @xmath380 , i.e.  @xmath355 ( by lemma  [ lemma - f].1 ) .    [ [ proof - of - claimlemz1 . ] ] proof of claim  [ lem : z1 ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    let us assume that we have proved claim  [ lem : z1 ] for all smaller values of  @xmath342 .",
    "that is , for @xmath381 , we have shown that if @xmath382 then the set @xmath383 .",
    "this is indeed the case for @xmath384 since we know @xmath352 ( by claim  [ lemma - t ] ) .",
    "using claim  [ lem : f1 ] and claim  [ lem : z1 ] ( for @xmath381 ) alternately now , it follows that @xmath383 for @xmath381 .",
    "thus @xmath385 .",
    "we will now show that @xmath340 is a subset of  @xmath252 .",
    "let @xmath386 denote the graph @xmath50 in step  4 in the @xmath342-th iteration of the while - loop in our algorithm .",
    "this is the graph where we determine the even posts that will get demoted from @xmath40 to  @xmath41 . in step  4 of the @xmath342-th iteration of the while - loop ,",
    "the set @xmath387 ( call this set @xmath388 ) , @xmath389 ( call this set @xmath390 ) , and let @xmath391 be the set of posts outside  @xmath392 . the edge set of @xmath386 is as follows :    * for each @xmath1 : if the rank of @xmath56 s most preferred post @xmath7 in @xmath391 is @xmath106 , then the edge @xmath107 belongs to @xmath386 * for @xmath393 : the edge  @xmath104 is also present in  @xmath386 .",
    "let us refer to posts in @xmath349 as _ @xmath394-posts _ : recall that these are odd / unreachable non-@xmath58-posts in the graph  @xmath137 .",
    "we will now show that all @xmath394-posts in @xmath257 are odd / unreachable in @xmath386 ; so every @xmath394-post that is even in @xmath386 has to be in @xmath252 , in other words , @xmath358 .",
    "let @xmath395 be the subgraph of @xmath319 with the set of posts restricted to @xmath396 ( see fig .",
    "[ fig : last - claim ] ) . consider the subgraph @xmath397 of @xmath395 obtained by deleting edges missing in @xmath386 from  @xmath395 .",
    "we now show that @xmath397 contains all edges in @xmath395 incident on @xmath394-posts in  @xmath257 .",
    "this is because any edge @xmath107 incident on an @xmath394-post @xmath398 in @xmath395 is present in @xmath386 also .",
    "since the edge @xmath107 belongs to @xmath395 , the post @xmath7 has to be ranked @xmath60 in @xmath56 s preference list and there is no @xmath58-post in @xmath257 of rank better than @xmath60 in @xmath56 s list .",
    "if the edge @xmath107 does not exist in @xmath386 , then it means there is some @xmath58-post in @xmath391 that @xmath56 prefers to  @xmath7 . all @xmath58-posts in @xmath391 are in @xmath399 and we are given that @xmath400 .",
    "since we know there is no @xmath58-post in @xmath257 that @xmath56 prefers to @xmath7 , it follows that @xmath7 has to be @xmath56 s most preferred post in @xmath391 and so the edge @xmath107 belongs to  @xmath386 .",
    "thus @xmath397 , whose edge set is the intersection of the edge sets of @xmath395 and @xmath386 , contains all edges in @xmath395 incident on @xmath394-posts in  @xmath257 .",
    "every post in @xmath396 is odd / unreachable in @xmath395 since the matching @xmath224 restricted to the edge set of @xmath395 is @xmath401-complete .",
    "we have shown that @xmath397 contains all edges in @xmath395 incident on @xmath394-posts in @xmath257 : thus all @xmath394-posts in @xmath257 are odd / unreachable in  @xmath397 .",
    "it is easy to see that all _ top - ranked _ edges in @xmath395 incident on @xmath58-posts in @xmath402 are also present in @xmath397 : each such post has a degree  1 neighbor in @xmath397 , thus all @xmath58-posts in @xmath402 are also odd / unreachable in  @xmath397 .",
    "we now claim that all posts in @xmath256 are also odd / unreachable in  @xmath397 .",
    "we first show that all edges incident on @xmath256 in @xmath395 are present in  @xmath386 .",
    "this is because each edge @xmath107 in @xmath395 such that @xmath403 is incident on an applicant @xmath404 such that @xmath63 and we know the graph @xmath386 has @xmath104 edges for all @xmath405 since @xmath406 .    in @xmath397 , each vertex @xmath403 either has a degree  1 neighbor ( in which case our claim is true ) or it has a degree  2 neighbor @xmath56 whose other neighbor is in @xmath402 , i.e. it is not in @xmath407 .",
    "this is because @xmath56 can not have 2 neighbors in @xmath388 in the graph @xmath386 and we know @xmath408 since all @xmath58-posts missing in @xmath388 ( these are posts in @xmath409 ) are absent from @xmath256 also .",
    "since all posts in @xmath402 are odd / unreachable in  @xmath397 , it follows that all posts in @xmath256 are also odd / unreachable in  @xmath397 .",
    "let us now compare the graph @xmath386 with the graph  @xmath397 .",
    "the graph @xmath386 has additional vertices : these are the ones in @xmath410 and the new edges in @xmath386 ( new relative to @xmath397 ) belong to the following two classes : ( i )  @xmath411 and ( ii )  @xmath412 .",
    "this is because every edge incident on @xmath407 in @xmath386 ( these are all top - ranked edges ) is present in @xmath395 as well .",
    "consider any new edge @xmath107 in @xmath386 of type  ( i ) , i.e.  @xmath413 .",
    "since @xmath107 belongs to @xmath386 , it must be the case that @xmath56 s most preferred neighbor in @xmath391 is  @xmath7 .",
    "so the post @xmath7 is ranked @xmath60 in @xmath56 s list and @xmath56 has no neighbor of rank better than @xmath60 in  @xmath391 .",
    "recall that @xmath395 has no edge in @xmath414 .",
    "so the only edge that can be incident on @xmath56 in the graph @xmath397 is an edge to @xmath55 in @xmath407 .",
    "consider any connected component @xmath192 in @xmath397 that contains an @xmath394-post in @xmath257 : every post here belongs to either @xmath256 or @xmath402 , in other words , there is no post in @xmath407 here .",
    "this is because there is no applicant @xmath56 in @xmath397 with neighbors in @xmath402 and @xmath407 as this means @xmath56 has two neighbors in @xmath257 , which is forbidden in  @xmath395 .",
    "similarly , there is no applicant @xmath222 in @xmath397 with neighbors in @xmath256 and @xmath407 as this means @xmath56 has two neighbors in @xmath388 , which is forbidden in  @xmath386 .",
    "thus @xmath192 has no post from @xmath407 .",
    "so the new edges in @xmath386 of type  ( i ) do not touch components in @xmath397 that contain @xmath394-posts in  @xmath257 .",
    "all the new edges incident upon these components have their endpoints in @xmath415 .",
    "these posts are already odd / unreachable in  @xmath397 .",
    "so these posts remain odd / unreachable in  @xmath386 .",
    "hence every @xmath394-post in @xmath257 is odd / unreachable in  @xmath386 .",
    "the matching @xmath224 need not be @xmath11-complete .",
    "however it would help us to assume that @xmath224 is @xmath11-complete , so we augment @xmath224 by adding @xmath112 edges for every @xmath1 that is unmatched in  @xmath224 . recall that @xmath110 is the dummy last resort post of  @xmath56 .",
    "however the augmented matching @xmath224 need not belong to the graph @xmath319 any longer  hence we augment @xmath319 also by adding some dummy vertices and some edges as described below .",
    "the augmentation of @xmath319 is analogous to phase  ( iii ) of our algorithm  we augment @xmath319 as follows : let @xmath416 , where @xmath109 ; if @xmath417 , then add @xmath112 to  @xmath319 .",
    "thus when compared to @xmath319 , the augmented @xmath319 has some new vertices ( all these are dummy last resort posts ) and some new edges  each new edge is of the form @xmath112 where @xmath110 is @xmath56 s only neighbor in @xmath272 .",
    "these new edges are enough to show the following lemma .",
    "[ lem : augmented ] the augmented matching @xmath224 belongs to the augmented graph  @xmath319 .    before the augmentations of @xmath319 and @xmath224 , the matching @xmath224 belonged to the graph  @xmath319 ( by lemma  [ lem : main ] ) .",
    "we now need to show that if @xmath56 is left unmatched in @xmath224 ( before augmentation ) , then @xmath61 and all of @xmath56 s neighbors belong to  @xmath256 .",
    "suppose @xmath56 is left unmatched in @xmath224 and @xmath348 .",
    "since @xmath348 , there is a post @xmath418 such that the post @xmath7 has rank @xmath60 in @xmath56 s preference list . consider the alternating path @xmath419-@xmath7-@xmath222-@xmath420-@xmath421 , where @xmath422 and @xmath423 .",
    "the matching @xmath228 matches @xmath56 to @xmath7 and promotes @xmath222 to its top post @xmath420 and leaves @xmath421 unmatched .",
    "thus @xmath228 is more popular than @xmath224 , a contradiction .",
    "so let us assume @xmath61 and @xmath56 was left unmatched in  @xmath224 .",
    "suppose @xmath56 has some neighbor @xmath152 outside  @xmath256 .",
    "the post @xmath152 has to be in @xmath46 because @xmath61 , i.e.  @xmath56 has no neighbors outside  @xmath46 .",
    "since @xmath273 ( by lemma  [ lemma - f].1 ) , it follows that @xmath322 .",
    "let @xmath324 ; if @xmath424 , then we again have an alternating path @xmath419-@xmath152-@xmath74-@xmath367-@xmath64 , where @xmath425 such that @xmath228 is more popular than  @xmath224 .",
    "this contradicts the popularity of  @xmath224 .",
    "so suppose @xmath325 and @xmath322 because @xmath426 .",
    "we know from claim  [ lem : alt - path ] that there is a desired alternating path @xmath427 , where either the last two non - matching edges are labeled  @xmath169 or the last post in @xmath427 is unmatched .",
    "consider the alternating path @xmath211 which is the path @xmath56-@xmath152-@xmath74 followed by the path  @xmath427 .",
    "it is easy to see that @xmath428 is more popular than @xmath224 , a contradiction to the popularity of  @xmath224 .",
    "since the augmented @xmath224 is an @xmath11-complete matching , it follows from lemma  [ lem : augmented ] that the augmented graph @xmath319 admits an @xmath11-complete matching .",
    "theorem  [ last - lemma ] uses lemma  [ lem : l1andx ] to show that if the augmented graph @xmath319 admits an @xmath11-complete matching , then so does the graph @xmath50 constructed by our algorithm .",
    "[ last - lemma ] if @xmath50 does not admit an @xmath11-complete matching , then the augmented graph @xmath319 can not admit an @xmath11-complete matching .",
    "we will use @xmath319 to refer to the _ augmented _ graph @xmath319 in this proof .",
    "the rules for adding edges in @xmath50 and in @xmath319 are exactly the same  the only difference is in the partition @xmath337 on which @xmath50 is based vs the partition @xmath429 on which @xmath319 is based .",
    "if @xmath430 , then the graphs @xmath50 and @xmath319 are exactly the same .",
    "[ fig : last - thm ] denotes how the partition @xmath49 can be modified to the partition @xmath51 .",
    "we know from lemma  [ lem : l1andx ] that @xmath52 and @xmath53 .",
    "consider the subgraph @xmath431 of @xmath319 induced on the vertex set @xmath432 and @xmath433 .",
    "this is the part bounded by the box in fig .",
    "[ fig : last - thm ] . in our analysis , we can essentially separate @xmath319 into @xmath431 and the part outside @xmath431 due to the following claim that says @xmath319 has no edges between @xmath434 and  @xmath41 .",
    "[ claim1 ] @xmath319 has no edge @xmath107 where @xmath435 and @xmath436 .",
    "any applicant @xmath435 has to belong to either @xmath437 or to @xmath438 ( see fig .",
    "[ fig : last - thm ] ) .",
    "there is obviously no edge in @xmath5 between a vertex in @xmath437 and any vertex in  @xmath41 .",
    "so suppose @xmath439 .",
    "for @xmath440 , if the edge @xmath107 is in @xmath319 , then @xmath7 has to be @xmath56 s most preferred post in  @xmath252 .",
    "we will now show that @xmath441 , equivalently @xmath442 .",
    "thus @xmath319 has no edge @xmath107 where @xmath435 and @xmath436 .    since @xmath443 , the graph @xmath50 contains an edge between @xmath56 and some @xmath444 . recall that an element of @xmath445 is a real post in  @xmath40 . by the rules of including edges in @xmath50",
    ", it follows that the rank of @xmath181 in @xmath56 s preference list is @xmath106 .",
    "the entire set @xmath252 can not contain any post of rank better than @xmath60 for any @xmath1 since any post of rank better than @xmath60 in @xmath56 s list belongs to @xmath46 while @xmath446 ( by lemma  [ lemma - f].1 ) .",
    "so @xmath181 has rank @xmath60 in @xmath56 s list .",
    "thus @xmath56 s most preferred neighbor in @xmath252 belongs to @xmath445 .",
    "let @xmath447 be the subgraph of @xmath431 obtained by deleting from @xmath431 the edges that are absent in  @xmath50 .",
    "thus @xmath447 is a subgraph of both @xmath319 and  @xmath50 .",
    "the following claim ( whose proof is given after the proof of theorem  [ last - lemma ] ) will be useful to us .",
    "[ claim2 ] all posts in @xmath448 are odd / unreachable in  @xmath447",
    ". moreover , every edge @xmath107 in @xmath319 that is missing in @xmath50 satisfies @xmath449 .",
    "consider the graph @xmath450 whose edge set is the intersection of the edge sets of @xmath319 and  @xmath50 .",
    "equivalently , @xmath450 can be constructed by adding to the edge set of @xmath447 , the edges incident on @xmath451 that are present in both @xmath319 and @xmath50 ( see fig .  [",
    "fig : last - thm ] ) .",
    "this is due to the fact that @xmath319 has no edge in @xmath452 .",
    "we claim that all posts in @xmath448 are odd / unreachable in  @xmath450 .",
    "this is because claim  [ claim2 ] tells us that each post in this set is odd / unreachable in @xmath447 and due to the absence of @xmath452 edges in @xmath319 , the graph @xmath450 has no _ new _ edge ( new when compared to @xmath447 ) incident on the set @xmath434 of applicants in  @xmath447 .",
    "hence all posts in @xmath448 remain odd / unreachable in  @xmath450 .",
    "claim  [ claim2 ] also tells us that all edges in @xmath319 that are missing in @xmath50 are incident on posts in @xmath448 .",
    "we know that all these posts are odd / unreachable in @xmath450 , hence @xmath319 has no _ new _ edge ( new when compared to @xmath450 ) on posts that are _ even _ in  @xmath450 .",
    "thus the size of a maximum matching in @xmath319 equals the size of a maximum matching in  @xmath450 .",
    "this is at most the size of a maximum matching in @xmath50 , since @xmath450 is a subgraph of  @xmath50 . hence if @xmath50 has no @xmath11-complete matching , then neither does  @xmath319 .",
    "[ [ proof - of - claimclaim2 . ] ] proof of claim  [ claim2 ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    we will now show that all posts in @xmath448 are odd / unreachable in  @xmath447 .",
    "let @xmath56 be an applicant with degree  2 in the graph @xmath447 , let @xmath24 and @xmath25 be the two neighbors of @xmath56 , where @xmath24 is the more preferred neighbor of  @xmath56 .",
    "we claim either ( i )  @xmath453 and @xmath454 or ( ii )  @xmath328 and @xmath455 .",
    "this is because of the following .",
    "* there is no applicant in @xmath447 with edges to both a post in @xmath256 and post in @xmath456 . if there was such an applicant @xmath56 , then @xmath56 would have two neighbors in the set  @xmath39 , which is forbidden in  @xmath50 . recall that any edge in @xmath447 is an edge in @xmath50 as well",
    "* there is no applicant in @xmath447 with edges to both a post in @xmath456 and a post in @xmath457 . if there was such an applicant @xmath56 , then @xmath56 would have two neighbors in the set  @xmath257 , which is forbidden in  @xmath319 . recall that any edge in @xmath447 is an edge in @xmath319 as well",
    "* there is no applicant in @xmath447 with edges to both a post in @xmath457 and a post in @xmath445 . if there was such an applicant @xmath56 , then @xmath56 would have two neighbors in the set  @xmath40 , which is forbidden in  @xmath50 .",
    "* there is no applicant @xmath56 in @xmath447 with edges to both a post in @xmath256 and a post in @xmath445 .",
    "this is because @xmath319 can not contain such a pair of edges as it is only applicants in @xmath458 that are adjacent to posts in  @xmath256 .",
    "thus in the graph @xmath447 , vertices in @xmath448 and those in @xmath459 belong to different connected components .",
    "note that all dummy posts belong to @xmath457 .",
    "so none of these posts belongs to any connected component in @xmath447 that contains vertices in @xmath448 .",
    "consider the subgraph @xmath460 of @xmath50 , obtained by restricting the set of posts in @xmath50 to _ real _ posts in @xmath113 .",
    "all real posts in @xmath113 are odd / unreachable in  @xmath460 .",
    "since @xmath448 consists of real posts , all these posts are odd / unreachable in @xmath460 .",
    "we now claim that all posts in @xmath448 remain odd / unreachable in  @xmath447 . in the first place ,",
    "every edge @xmath329 in @xmath460 incident on any vertex @xmath461 is present in @xmath431 as well .",
    "this is because @xmath462 and if @xmath461 is the most preferred post in @xmath40 for applicant @xmath74 , then the rank of @xmath152 in @xmath74 s preference list is @xmath331 and thus @xmath152 is also @xmath74 s most preferred post in @xmath252 , so the edge @xmath329 belongs to the graph  @xmath431 .",
    "similarly every edge @xmath463 in @xmath460 incident on any post @xmath453 is present in @xmath431 as well  this is because @xmath464 and @xmath24 has to be @xmath238 for the edge @xmath463 to exist in  @xmath460 .",
    "thus @xmath24 is also @xmath64 s most preferred post in  @xmath257 .",
    "hence all edges in @xmath460 incident on posts in @xmath448 are present in  @xmath447 .",
    "let @xmath7 be any post in @xmath448 .",
    "the connected component in @xmath447 that contains @xmath7 can be obtained by taking the connected component containing @xmath7 in @xmath460 and deleting all vertices in @xmath459 from this component . since no edge incident on @xmath7 has been deleted here and because @xmath7 is odd / unreachable in the starting component , it follows that @xmath7 is odd / unreachable in  @xmath447 .",
    "we will now show the second part of claim  [ claim2 ] : every edge @xmath107 in @xmath319 that is missing in @xmath50 satisfies @xmath449 .",
    "we partitioned the set @xmath10 of posts into five sets ( refer to fig .",
    "[ fig : last - thm ] ) .",
    "these are @xmath256 , @xmath456 , @xmath457 , @xmath465 , and  @xmath41 .",
    "we will now show that every edge in @xmath319 that is incident on @xmath466 is present in @xmath50 also .    * any edge @xmath107 in @xmath319 where @xmath403 is such that @xmath347 and @xmath467",
    ". since @xmath468 ( by lemma  [ lem : l1andx ] ) , this means @xmath469 .",
    "thus @xmath50 also contains the edge  @xmath107 . * any edge @xmath107 in @xmath319 where @xmath470 is such that @xmath7 is @xmath56 s most preferred post in @xmath257 and",
    "the rank of @xmath7 in @xmath56 s preference list is @xmath106 .",
    "note that @xmath471 ( by lemma  [ lemma - f].1 ) .",
    "thus the rank of @xmath56 s most preferred post in @xmath472 is @xmath182 and hence no post in @xmath472 can be preferred to  @xmath7 .",
    "so the post @xmath7 is , in fact , @xmath56 s most preferred post in  @xmath40 .",
    "thus the edge @xmath107 belongs to @xmath50 as well . * any edge @xmath107 in @xmath319 where @xmath436 is such that @xmath7 is @xmath56 s most preferred post in  @xmath252 .",
    "since @xmath468 , this means @xmath7 is @xmath56 s most preferred post in  @xmath41 .",
    "thus @xmath50 also contains the edge  @xmath107 .",
    "thus every edge @xmath107 in @xmath319 that is missing in @xmath50 satisfies @xmath449 .",
    "theorem  [ last - lemma ] , along with lemma  [ lem : augmented ] , finishes the proof of the necessary part of theorem  [ thm : correctness ] and this completes the proof of correctness of our algorithm .",
    "we now analyze its running time .    observe that we can maintain the most preferred posts in @xmath44 , and @xmath41 for all applicants over all iterations in @xmath473 time , where @xmath474 is the number of edges in @xmath5 . to begin with",
    ", the most preferred non-@xmath58-post for all applicants can be determined in @xmath473 time .",
    "thereafter , whenever a post @xmath7 moves from @xmath39 to @xmath40 ( similarly , from @xmath40 to @xmath41 ) , we charge @xmath7 a cost of the degree of @xmath7 to pay for checking if any of its neighbors now has @xmath7 as its most preferred post in @xmath40 ( resp . ,",
    "@xmath41 ) .",
    "let @xmath475 be the number of vertices in  @xmath5 .",
    "the number of iterations is @xmath476 and the most expensive step in each iteration is finding a maximum matching in a subgraph where each vertex in @xmath11 has degree at most  2 .",
    "it is easy to see that this step can be performed in @xmath476 time .",
    "thus the running time of our algorithm is  @xmath8 .",
    "hence we can conclude theorem  [ thm : popular ] stated in section  [ sec : intro ] .",
    "there are instances on @xmath476 vertices and @xmath476 edges where our algorithm takes @xmath477 time .",
    "consider the example given in fig .",
    "[ fig : tight ] : here there are @xmath478 applicants and @xmath479 posts and the number of edges is  @xmath480 . for each @xmath481",
    ", we have @xmath482 and @xmath483 is the most preferred non-@xmath58-post for both @xmath23 and  @xmath484 . for @xmath74",
    ", we have @xmath485 and @xmath74 s most preferred non-@xmath58-post is  @xmath486 .    in the starting graph @xmath137 ,",
    "there is exactly one post that is even in @xmath487 : this is @xmath486 and so @xmath486 moves from @xmath487 to  @xmath150 . in the second iteration",
    ", @xmath488 has no applicant in @xmath437 that regards it as a top post and this causes the demotion of @xmath488 from @xmath489 to  @xmath145 .",
    "now the post @xmath488 is the most preferred post in @xmath145 for @xmath64 and this makes @xmath490 even in @xmath145 and causes @xmath490 to move from @xmath145 to  @xmath491 .",
    "this makes both @xmath64 and @xmath492 belong to @xmath42 and hence @xmath493 gets isolated in @xmath494 and so @xmath493 moves from @xmath495 to  @xmath496 .",
    "now @xmath493 becomes the most preferred post in @xmath496 for @xmath65 and this causes @xmath497 to move from @xmath496 to @xmath498 and so on .",
    "thus our algorithm runs for @xmath499 iterations .",
    "this instance admits popular matchings , for instance , @xmath500 is a popular matching here .",
    "given a matching @xmath3 in @xmath54 , it was shown in  @xcite that @xmath3 can be tested for popularity in @xmath501 time ( even in the presence of ties ) , where @xmath502 .",
    "we now show the @xmath6-hardness of the 2-sided popular matching problem in @xmath5 with 1-sided ties using the ( 2,2)-e3-sat problem .",
    "recall that the ( 2,2)-e3-sat problem takes as its input a boolean formula @xmath37 in cnf , where each clause contains three literals and every variable appears exactly twice in unnegated form and exactly twice in negated form in the clauses .",
    "the problem is to determine if @xmath37 is satisfiable or not and this problem is @xmath6-complete  @xcite .    [ [ constructing - a - popular - matching - instance - g - a - cup - be - frommathcali . ] ] constructing a popular matching instance @xmath54 from  @xmath37 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath37 have @xmath474 clauses and @xmath475 variables .",
    "the instance @xmath5 constructed consists of @xmath475 variable gadgets , @xmath474 clause gadgets , and some interconnecting edges between these , see fig .",
    "[ fi : pop_np ] . a _ variable gadget _ representing variable @xmath503 , for @xmath504 , is a 4-cycle on vertices @xmath505 , and  @xmath506 , where @xmath507 and @xmath508 . a _ clause gadget _ representing clause @xmath509 , for @xmath510 , is a subdivision graph of a claw .",
    "its edges are divided into three classes : @xmath511 is at the center , the neighbors of @xmath512 are @xmath513 , and finally , each of @xmath514 is adjacent to its respective copy in  @xmath515 , where @xmath516 .",
    "a vertex in @xmath517 represents an appearance of a variable . for instance",
    ", @xmath518 is the first literal of the third clause .",
    "each of the vertices in @xmath517 is connected to a vertex in the variable gadget via an _ interconnecting edge_. vertex @xmath519 is connected to the gadget standing for variable @xmath520 if the @xmath342-th literal of the @xmath116th clause is either @xmath503 or  @xmath521 .",
    "if it is @xmath503 , then the interconnecting edge ends at @xmath522 , else at  @xmath523 .",
    "the preferences of this instance can be seen in fig .",
    "[ fi : pop_np ] .",
    "the constructed graph trivially satisfies both conditions claimed in section  [ sec : intro ] , i.e.   every vertex in @xmath11 has a strict preference list of length 2 or 4 and every vertex in @xmath10 has either a strict preference list of length  2 or a single tie of length  2 or 3 as a preference list . =",
    "[ circle , draw = black , fill = black , inner sep=0pt , minimum size=5pt ] = [ circle , fill = white , inner sep=0pt , minimum size=15pt ]      ( c1 ) ",
    "node[edgelabel , near start ] 1 node[edgelabel , near end ] 1 ( x11 ) ; ( c1 ) ",
    "node[edgelabel , near start ] 1 node[edgelabel , near end ] 1 ( x12 ) ; ( c1 ) ",
    "node[edgelabel , near start ] 1 node[edgelabel , near end ] 1 ( x13 ) ;    ( x11 ) ",
    "node[edgelabel , near start ] 2 node[edgelabel , near end ] 1 ( y11 ) ; ( x12 )  node[edgelabel , near start ] 2 node[edgelabel , near end ] 1 ( y12 ) ; ( x13 ) ",
    "node[edgelabel , near start ] 2 node[edgelabel , near end ] 1 ( y13 ) ;        ( a1 ) ",
    "node[edgelabel , near start ] 1 node[edgelabel , near end ] 1 ( b1 ) ; ( a1 ) ",
    "node[edgelabel , near start ] 4 node[edgelabel , near end ] 1 ( b2 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 1 node[edgelabel , near end ] 1 ( b1 ) ; ( a2 ) ",
    "node[edgelabel , near start ] 4 node[edgelabel , near end ] 1 ( b2 ) ;                              [ [ constructing - a - truth - assignment - in - mathcali - given - a - popular - matching - m - ing . ] ] constructing a truth assignment in @xmath37 , given a popular matching @xmath3 in  @xmath5 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +        * @xmath3 avoids all interconnecting edges . *",
    "@xmath3 is one of the two perfect matchings on any variable gadget ; i.e.  for each @xmath520 , the edges of @xmath3 , restricted to the gadget corresponding to variable @xmath503 , are either ( i )  @xmath562 and @xmath563 , or ( ii )  @xmath564 and @xmath565 .",
    "* @xmath3 leaves exactly one vertex per clause @xmath116 unmatched and this unmatched vertex @xmath519 is adjacent to an @xmath566 that is matched to  @xmath567 .    label each edge @xmath107 in @xmath568 by the pair @xmath569 , where @xmath570 is @xmath56 s vote for @xmath7 versus @xmath168 and @xmath571 is @xmath7 s vote for @xmath56 versus  @xmath572 .",
    "our first observation is that every @xmath512 , for @xmath573 , and every @xmath567 , for @xmath574 , must be matched in  @xmath3 .",
    "that is because these vertices are the top choices for each of their neighbors , hence if one of them is left unmatched , then there would be an edge labeled @xmath575 incident to an unmatched vertex .",
    "this contradicts the popularity of  @xmath3 .",
    "assume without loss of generality that @xmath576 . also , the edges @xmath577 and @xmath578 must be in @xmath3 , because they are the top - ranked edges of @xmath579 and @xmath580 , respectively .",
    "we now claim that @xmath581 as well .",
    "suppose @xmath582 . since @xmath3 is a maximal matching , @xmath583 for some  @xmath584 . based on the above described structure of the clause gadgets ,",
    "the edges @xmath585 , and @xmath586 are in @xmath3 , where the subscripts are taken modulo  3 .",
    "consider the following augmenting path @xmath296 wrt  @xmath3 : @xmath587 we have @xmath588 , which contradicts the popularity of  @xmath3 .",
    "thus @xmath581 .",
    "an analogous argument proves that if @xmath589 for some @xmath520 , then @xmath590 has to be in  @xmath3 .",
    "the last observation we make is that if @xmath519 is unmatched in @xmath3 , then its interconnecting edge leads to an @xmath566 that is matched to  @xmath567 .",
    "otherwise @xmath591 would be labeled @xmath575 with one vertex unmatched , a contradiction again to the popularity of  @xmath3 .",
    "this finishes the proof of claim  [ clm1:appb ] .",
    "so the truth value of every variable is uniquely defined and all we need to show is that every clause has a true literal .",
    "assume that in clause @xmath509 , all three literals are false .",
    "the clause gadget has an unmatched vertex @xmath519 that is adjacent to an  @xmath566 .",
    "if the literal is false , then @xmath566 prefers @xmath519 to @xmath595 and this becomes an edge labeled @xmath575 with an unmatched end vertex  this contradicts the popularity of  @xmath3 .",
    "hence in every clause , there is at least one true literal and so this is a satisfying assignment .",
    "[ [ constructing - a - popular - matching - in - g - given - a - truth - assignment - inmathcali . ] ] constructing a popular matching in @xmath5 , given a truth assignment in  @xmath37 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    here we first construct a matching @xmath3 in the graph @xmath5 as described below and then show that it is popular .",
    "initially @xmath596 . for each @xmath520 , where @xmath597 , if @xmath598 in the assignment , then add @xmath599 and @xmath600 to @xmath3 , else add @xmath590 and @xmath601 to  @xmath3",
    ". for each @xmath116 , where @xmath602 , in the gadget corresponding to clause @xmath509 , any true literal is chosen ( say ,",
    "the @xmath342-th literal ) and @xmath519 , representing its appearance , is left unmatched .",
    "moreover , @xmath603 and @xmath604 ( where the subscripts are taken modulo 3 ) are added to  @xmath3 .",
    "no interconnecting edge appears in  @xmath3 .",
    "this finishes the description of  @xmath3 .",
    "suppose @xmath3 is not popular .",
    "then there is another matching @xmath4 that is more popular than  @xmath3 .",
    "this can only happen if @xmath220 contains a component @xmath211 such that the number of vertices in @xmath211 that prefer @xmath4 to @xmath3 is more than those that prefer @xmath3 to  @xmath4 . to achieve this",
    ", the matching @xmath4 should contain at least one edge labeled either @xmath575 or @xmath605 , where we use edge labels @xmath569 as described in the proof of claim  [ clm1:appb ] .",
    "we now analyze the cases based on the occurrences of such `` positive '' edges .",
    "since we started with a truth assignment , no interconnecting edge can be labeled @xmath575 .",
    "in fact , it is easy to check that no edge here can be labeled @xmath575 .",
    "we now check for the occurrences of edges labeled @xmath605 .",
    "these can occur at two places : the edge @xmath606 for any @xmath597 and the edge @xmath607 for any @xmath602 .",
    "_ case  1 .",
    "_ suppose @xmath601 is labeled  @xmath605 .",
    "this happens if @xmath503 is @xmath101 in the truth assignment .",
    "we start the augmenting path @xmath211 at  @xmath601 .",
    "augmenting along the 4-cycle is not sufficient to break popularity , therefore , @xmath522 must be matched along one of its interconnecting edges , say @xmath608 .",
    "* if @xmath519 is unmatched , consider the path @xmath609-@xmath523-@xmath567-@xmath522-@xmath519 .",
    "there are two vertices ( @xmath522 and @xmath506 ) that prefer @xmath3 to @xmath610 and two vertices ( @xmath523 and @xmath519 ) that prefer @xmath610 to  @xmath3 . *",
    "if @xmath519 is matched , then extend the path @xmath211 till the unmatched vertex of the @xmath116th variable gadget ( call this @xmath611 ) . the path @xmath211 is described below : @xmath612 so 4 vertices , i.e.  @xmath506 , @xmath522 , @xmath519 , and @xmath613 , prefer @xmath3 to @xmath610 while 3 vertices , i.e.  @xmath523 , @xmath614 , and @xmath611 , prefer @xmath610 to  @xmath3",
    ".    _ case  2 .",
    "_ now suppose @xmath607 is labeled @xmath605 .",
    "let us assume that this edge is @xmath615 and suppose  @xmath616 .",
    "consider the alternating path @xmath617-@xmath618-@xmath512-@xmath619-@xmath620 . in the matching @xmath610 , the vertices @xmath619 and @xmath579 are better - off while @xmath618 and @xmath620 are worse - off , i.e.  they prefer @xmath3 to @xmath610 . in order to collect one more vertex that prefers @xmath610 ,",
    "let us extend this alternating path @xmath211 to include @xmath621 , the interconnecting edge of  @xmath620 .",
    "the vertex @xmath620 still prefers @xmath3 to @xmath622 since @xmath620 was paired in @xmath3 to its top - ranked neighbor .",
    "* in the first case , the path @xmath211 gets extended to @xmath193-@xmath523-@xmath506 .",
    "so @xmath523 prefers @xmath610 to @xmath3 , however @xmath506 is left unmatched in @xmath622 , so @xmath506 prefers @xmath3 to @xmath622 . * in the second case , the path @xmath211 gets extended to @xmath193-@xmath523-@xmath567-@xmath522-@xmath506 .",
    "so @xmath522 prefers @xmath610 to @xmath3 , however both @xmath523 and @xmath506 prefer @xmath3 to @xmath622 .",
    "we have analyzed all the cases where edges can labeled @xmath605 and we showed that there is no alternating cycle or path @xmath211 containing an edge labeled @xmath605 such that @xmath627 .",
    "thus @xmath3 is popular .",
    "we gave an @xmath8 algorithm for the popular matching problem in @xmath54 where vertices in @xmath11 have strict preference lists while each vertex in @xmath10 puts all its neighbors into a single tie and @xmath9 .",
    "our algorithm needs the preference lists of vertices in @xmath11 to be strict and the complexity of the popular matching problem when ties are allowed in the preference lists of vertices in @xmath11 is currently unknown .",
    "when each @xmath2 either has a single tie of length at most  3 or a strict preference list ( and each @xmath1 has a strict preference list ) , we showed that the popular matching problem becomes @xmath6-hard .",
    "the complexity of the same problem with ties of length at most  2 instead of  3 is open .",
    "another open problem is to extend our algorithm to solve the popular matching problem in the many - to - one setting where each post @xmath7 has a capacity @xmath30 and post @xmath7 prefers @xmath31 to @xmath32 if @xmath33 ."
  ],
  "abstract_text": [
    "<S> we are given a bipartite graph @xmath0 where each vertex has a preference list ranking its neighbors : in particular , every @xmath1 ranks its neighbors in a strict order of preference , whereas the preference lists of @xmath2 may contain ties . </S>",
    "<S> a matching @xmath3 is _ popular _ if there is no matching @xmath4 such that the number of vertices that prefer @xmath4 to @xmath3 exceeds the number of vertices that prefer @xmath3 to  @xmath4 . </S>",
    "<S> we show that the problem of deciding whether @xmath5 admits a popular matching or not is @xmath6-hard . </S>",
    "<S> this is the case even when every @xmath2 either has a strict preference list or puts all its neighbors into a single tie . </S>",
    "<S> in contrast , we show that the problem becomes polynomially solvable in the case when each @xmath2 puts all its neighbors into a single tie . </S>",
    "<S> that is , all neighbors of @xmath7 are tied in @xmath7 s list and @xmath7 desires to be matched to any of them . </S>",
    "<S> our main result is an @xmath8 algorithm ( where @xmath9 ) for the popular matching problem in this model . </S>",
    "<S> note that this model is quite different from the model where vertices in @xmath10 have no preferences and do _ not _ care whether they are matched or not . </S>"
  ]
}