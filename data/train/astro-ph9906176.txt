{
  "article_text": [
    "in systems with a single degree of freedom , constancy of the energy allows the momentum variable @xmath1 to be written in terms of the coordinate variable @xmath2 as @xmath3 , and the dependence of both variables on time follows immediately from hamilton s equations . in general systems with @xmath4 degrees of freedom ( dof ) ,",
    "such a solution is generally not possible unless the hamilton - jacobi equation is separable , in which case the separation constants are isolating integrals of the motion .",
    "an isolating integral is a conserved quantity that in some transformed coordinate system makes @xmath5 , thus allowing the motion in @xmath6 to be reduced to quadratures .",
    "each isolating integral restricts the dimensionality of the phase space region accessible to an orbit by one ; if there are @xmath7 such integrals , the orbit moves in a phase space of dimension @xmath8 , and the motion is regular .",
    "the @xmath7-dimensional phase space region to which a regular orbit is confined is topologically a torus ( figure 1 ) .",
    "orbits in time - independent potentials may be either regular or chaotic , respecting a smaller number of integrals  typically only the energy integral @xmath9 .",
    "although chaotic orbits are not , strictly speaking , confined to tori , numerical integrations suggest that many chaotic trajectories are effectively regular , remaining confined for long periods of time to regions of phase space much more restricted than the full energy hypersurface .",
    "the most compact representation of a regular orbit is in terms of the coordinates on the torus ( figure 1 )  the action - angle variables @xmath10 . the process of determining the map @xmath11 is referred to as _",
    "torus construction_. there are a number of contexts in which it is useful to know the @xmath0 .",
    "one example is the response of orbits to slow changes in the potential , which leave the actions ( @xmath12 ) unchanged .",
    "another is the behavior of weakly chaotic orbits , which may be approximated as regular orbits that slowly diffuse from one torus to another .",
    "a third example is galaxy modeling , where regular orbits are most efficiently represented and stored via the coordinates that define their tori .",
    "this article reviews techniques for mapping cartesian coordinates into action - angle variables in non - integrable potentials .",
    "two general approaches to this problem have been developed .",
    "trajectory - following algorithms are based on the quasi - periodicity of regular motion : fourier decomposition of the trajectory yields the fundamental frequencies on the torus as well as the spectral amplitudes , which allow immediate construction of the map @xmath13 .",
    "iterative approaches begin from some initial guess for @xmath14 , which is then refined via hamilton s equations with the requirement that the @xmath15 increase linearly with time .",
    "the two approaches are often complementary , as discussed below .",
    "in certain special potentials , every orbit is regular ; examples are the kepler and stckel potentials .",
    "motion in such potentials can be expressed most simply by finding a canonical transformation to coordinates @xmath16 for which the hamiltonian is independent of @xmath17 , @xmath18 ; among all such coordinates , one particularly simple choice is the action - angle variables @xmath19 , in terms of which the equations of motion are @xmath20 ( landau & lifshitz 1976 ; goldstein 1980 ) .",
    "the trajectory @xmath21 is periodic in each of the angle variables @xmath15 , which may be restricted to the range @xmath22 .",
    "the @xmath23 define the cross - sectional areas of the torus while the @xmath15 define position on the torus ( figure 1 ) .",
    "these tori are sometimes called `` invariant '' since a phase point that lies on a torus at any time will remain on it forever .",
    "most potentials are not integrable , but regular orbits may still exist ; indeed these are the orbits for which torus construction machinery is designed .",
    "one expects that for a regular orbit in a non - integrable potential , a canonical transformation @xmath24 can be found such that @xmath25 however there is no guarantee that the full hamiltonian will be expressible as a continuous function of the @xmath23 . in general , the map @xmath26 will be different for each orbit and will not exist for those trajectories that do not respect @xmath7 isolating integrals ( although approximate maps , valid for some limited span of time , may be derived for weakly chaotic trajectories ) .    the uniform translation of a regular orbit on its torus implies that the motion in any canonical coordinates @xmath27 is quasi - periodic : @xmath28 , \\nonumber \\\\",
    "{ \\bf v}(t ) & = & \\sum_k{\\bf v}_k({\\bf j } ) \\exp\\left [ i\\left(l_k\\omega_1 + m_k\\omega_2 + n_k\\omega_3\\right)t\\right],\\end{aligned}\\ ] ] with @xmath29 integers .",
    "the fourier transform of @xmath30 or @xmath31 will therefore consist of a set of spikes at discrete frequencies @xmath32 that are linear combinations of the @xmath7 fundamental frequencies @xmath33 , with spectral amplitudes @xmath34 and @xmath35 .",
    "the most straightforward , and probably the most robust , approach to torus construction is via fourier analysis of the numerically - integrated trajectories ( percival 1974 ; boozer 1982 ; binney & spergel 1982 , 1984 ; kuo - petravic et al . 1983 ; eaker et al .",
    "1984 ; martens & ezra 1985 ) .",
    "the fourier decomposition of a quasiperiodic orbit ( equation 3 ) yields a discrete frequency spectrum .",
    "the precise form of this spectrum depends on the coordinates in which the orbit is integrated , but certain of its properties are invariant , including the @xmath7 fundamental frequencies @xmath33 from which every line is made up , @xmath36 .",
    "typically the strongest line in a spectrum lies at one of the fundamental frequencies ; once the @xmath33 have been identified , the integer vectors @xmath29 corresponding to every line @xmath37 are uniquely defined , to within computational uncertainties .",
    "approximations to the actions may then be computed using percival s ( 1974 ) formulae ; e.g. the action associated with @xmath38 in a 3 dof system is @xmath39 and similarly for @xmath40 and @xmath41 , upon replacing the first factor in the summation by @xmath42 and @xmath43 respectively .",
    "finally , the maps @xmath44 are obtained by making the substitution @xmath45 in the spectrum , e.g. @xmath46 \\nonumber \\\\ & = & \\sum_kx_k(j ) \\exp\\left [ i\\left(l_k\\theta_1 + m_k\\theta_2 + n_k\\theta_3\\right)\\right ] \\nonumber \\\\ & = & x(\\theta_1 , \\theta_2 , \\theta_3).\\end{aligned}\\ ] ] trajectory following algorithms are easily automated ; for instance , integer programming may be used to recover the vectors @xmath29 ( valluri & merritt 1998 ) .",
    "binney & spergel ( 1982 ) pioneered the use of trajectory - following algorithms for galactic potentials .",
    "they integrated orbits for a time @xmath47 and computed discrete fourier transforms , yielding spectra in which each frequency spike was represented by a peak with finite width @xmath48 centered on @xmath37 .",
    "they then fitted these peaks to the expected functional form @xmath49/(\\omega-\\omega_k)$ ] using a least - squares algorithm .",
    "they were able to recover the fundamental frequencies in a 2 dof potential with an accuracy of @xmath50 after @xmath51 orbital periods .",
    "binney & spergel ( 1984 ) used equation ( 4 ) to construct the `` action map '' for orbits in a principal plane of the triaxial logarithmic potential .",
    "carpintero & aguilar ( 1998 ) and copin , zhao & de zeeuw ( this volume ) applied similar algorithms to motion in 2- and 3 dof potentials .",
    "the accuracy of fourier transform methods can be greatly improved by multiplying the time series with a windowing function before transforming . the result is a reduction in the amplitude of the side lobes of each frequency peak at the expense of a broadening of the peaks ; the amplitude measurements are then effectively decoupled from any errors in the determination of the frequencies .",
    "laskar ( 1988 , 1990 ) developed this idea into a set of tools , the `` numerical analysis of fundamental frequencies '' ( naff ) , which he applied to the analysis of weakly chaotic motion in the solar system .",
    "laskar s algorithm recovers the fundamental frequencies with an error that falls off as @xmath52 ( laskar 1996 ) , compared with @xmath53 in algorithms like binney & spergel s ( 1982 ) . even for modest integration times of @xmath54 orbital periods ,",
    "the naff algorithm is able to recover fundamental frequencies with accuracies of @xmath55 or better in many potentials .",
    "the result is a very precise representation of the torus ( figure 2 ) .",
    "one drawback of trajectory - following algorithms is the need to extract a large number of terms in the frequency spectrum in cases where the time dependence of the integration variables is very different from that of the angles .",
    "this problem may be dealt with by expressing the numerically - integrated orbit in terms of a set of coordinates that are closer to the angle variables before computing the fourier transform ; for instance , tube orbits are most efficiently expressed in the canonically - conjugate poincar variables ( related to cylindrical coordinates , e.g. papaphilippou & laskar 1996 ) .",
    "trajectory - following algorithms also suffer from the fundamental limitation that they must follow the trajectory sufficiently far to see the longest periodicities of the orbit .",
    "in other words , the trajectory must adequately sample the surface of its invariant torus .",
    "near a resonant torus , i.e. a torus for which the @xmath33 satisfy a relation @xmath56 with the @xmath57 integers , trajectories fill their tori very slowly , necessitating long integration intervals . however even for near - resonant orbits",
    ", one can still efficiently recover the terms in the spectrum associated with the `` faster '' angles , as well as a reasonable approximation to the `` slow '' frequency @xmath58 associated with libration around the resonant orbit ( merritt & valluri 1999 ) , and for many applications these are sufficient . if the precise dependence of the map on @xmath59 is also needed , one possible approach ( papaphilippou & laskar 1998 ) is to integrate the equations of motion using as a time step the period associated with one of the fast angles , thus eliminating it from the spectrum .    since fourier techniques focus on the frequency domain , they are particularly well suited to identifying regions of phase space occupied by resonances .",
    "they are also ideal for studying the effect of resonances on the structure of phase space , even in cases where the full tori are difficult to reconstruct .",
    "resonant tori are places where perturbation expansions of integrable systems break down , due to the `` problem of small denominators '' . in perturbed ( non - integrable ) potentials ,",
    "one expects stable resonant tori to generate regions of regular motion and unstable resonant tori to give rise to chaotic regions .",
    "algorithms like naff allow one to construct a `` frequency map '' of the phase space : a plot of the ratios of the fundamental frequencies @xmath60 for a large a set of orbits selected from a uniform grid in initial condition space .",
    "resonances appear on the frequency map as lines , either densely filled lines in the case of stable resonances , or gaps in the case of unstable resonances ; the frequency map is effectively a representation of the arnold web ( laskar 1993 ) .",
    "papaphilippou & laskar ( 1996 , 1998 ) , wachlin & ferraz - mello ( 1998 ) and valluri & merritt ( 1998 ) used frequency maps to study the effect of resonances on the structure of phase space in triaxial potentials .",
    "precisely resonant orbits can be reconstructed using trajectory - following algorithms in a particularly straightforward way .",
    "a resonance has the effect of restricting an orbit to a subset of its torus , reducing the number of independent angle variables by one ; thus a 2 dof trajectory is reduced to a closed curve and a 3 dof trajectory becomes a thin sheet ( born 1960 ; goldstein 1980 ; figure 3 ) .",
    "the two frequencies defining motion on a resonant three - torus may be taken to be @xmath61 in terms of which @xmath62    this definition is not unique since the orbit is not closed .",
    "the motion in cartesian coordinates then becomes @xmath63 t \\nonumber \\\\ &",
    "= & \\sum_k { \\bf x}_k\\exp i \\left({l_k}'\\omega_0^{(1 ) } + { m_k}'\\omega_0^{(2)}\\right)t \\nonumber \\\\ & = & \\sum_k { \\bf x}_k\\exp i \\left({l_k}'\\theta^{(1 ) } + { m_k}'\\theta^{(2)}\\right ) \\nonumber \\\\ & = & { \\bf x}(\\theta^{(1 ) } , \\theta^{(2)}).\\end{aligned}\\ ] ] the result is a set of parametric expressions for the cartesian coordinates @xmath64 in terms of the angles @xmath65 that define position on the two - torus ( figure 4 ) .",
    "iterative approaches to torus construction consist of finding successively better approximations to the map @xmath66 given some initial guess @xmath14 ; canonical perturbation theory is a special case , and in fact iterative schemes often reduce to perturbative methods in appropriate limits .",
    "iterative algorithms were first developed in the context of semi - classical quantization for computing energy levels of bound molecular systems , and they are still best suited to assigning energies to actions , @xmath67 .",
    "most of the other quantities of interest to galactic dynamicists ",
    "e.g. the fundamental frequencies @xmath33  are not recovered with high accuracy by these algorithms .",
    "iterative schemes also tend to be numerically unstable unless the initial guess is close to the true solution . on the other hand",
    ", iterative algorithms can be more efficient than trajectory - following methods for orbits that are near resonance .",
    "ratcliff , chang & schwarzschild ( 1984 ) pioneered iterative schemes in galactic dynamics .",
    "they noted that the equations of motion of a 2 dof regular orbit , @xmath68 can be written in the form @xmath69 if one specifies @xmath70 and @xmath71 and treats @xmath72 and @xmath73 as functions of the @xmath15 , equations ( 11 ) can be viewed as nonlinear differential equations for @xmath74 and @xmath75 .",
    "ratcliff et al .",
    "expressed the coordinates as fourier series in the angle variables , @xmath76 substituting ( 12 ) into ( 11 ) gives @xmath77 where the right hand side is again understood to be a function of the angles .",
    "ratcliff et al .",
    "truncated the fourier series after a finite number of terms and required equations ( 13 ) to be satisfied on a grid of points around the torus .",
    "they then solved for the @xmath78 by iterating from an initial guess .",
    "convergence was found to be possible if the initial guess was close to the exact solution .",
    "a similar algorithm was developed for recovering tori in the case that the actions , rather than the frequencies , are specified a priori .",
    "guerra & ratcliff ( 1990 ) applied these algorithms to motion in the plane of rotation of a nonaxisymmetric potential .",
    "another iterative approach to torus construction was developed by chapman , garrett & miller ( 1976 ) in the context of semiclassical quantum theory .",
    "one begins by dividing the hamiltonian @xmath79 into separable and non - separable parts @xmath80 and @xmath81 , then seeks a generating function @xmath82 that maps the known tori of @xmath80 into tori of @xmath79 . for a generating function of the @xmath83-type ( goldstein 1980 )",
    ", one has @xmath84 where @xmath10 and @xmath85 are the action - angle variables of @xmath80 and @xmath79 respectively .",
    "the generator @xmath82 is determined , for a specified @xmath86 , by substituting the first of equations ( 14 ) into the hamiltonian and requiring the result to be independent of @xmath87 .",
    "one then arrives at @xmath88 .",
    "chapman et al . showed that a sufficiently general form for @xmath82 is @xmath89 where the first term is the identity transformation , and they evaluated a number of iterative schemes for finding the @xmath90 .",
    "one such scheme was found to recover the results of first - order perturbation theory after a single iteration .",
    "mcgill & binney ( 1990 ) refined the chapman et al .",
    "algorithm and applied it to 2 dof motion in the axisymmetric logarithmic potential .",
    "the generating function approach is not naturally suited to deriving the other quantities of interest to galactic dynamicists .",
    "for instance , equation ( 14 ) gives @xmath91 as a derivative of @xmath82 , but since @xmath82 must be computed separately for every @xmath86 its derivative is likely to be ill - conditioned .",
    "binney & kumar ( 1993 ) and kaasalainen & binney ( 1994a ) discussed two schemes for finding @xmath91 ; the first requires the solution of a formally infinite set of equations , while the latter requires multiple integrations of the equations of motion for each torus  effectively a trajectory - following scheme .",
    "kaasalainen & binney ( 1994a ) noted that the success of the generating function method depends strongly on the choice of @xmath80 . for box orbits , which are most naturally described as coupled rectilinear oscillators",
    ", they found that a harmonic - oscillator @xmath80 gave poor results unless an additional point transformation was used to deform the rectangular orbits of @xmath80 into narrow - waisted boxes like those in typical galactic potentials .",
    "kaasalainen ( 1995a ) considered orbits belonging to higher - order resonant families and found that it was generally necessary to define a new coordinate transformation for each family .    warnock ( 1991 ) presented a hybrid scheme in which the generating function @xmath82 was derived by numerically integrating an orbit from appropriate initial conditions , transforming the coordinates to @xmath10 of @xmath80 and interpolating @xmath12 on a regular grid in @xmath87 .",
    "the values of the @xmath90 then follow from the first equation of ( 14 ) after a discrete fourier transform .",
    "kaasalainen & binney ( 1994b ) found that warnock s scheme could be used to substantially refine the solutions found via their iterative algorithm .",
    "another hybrid scheme was discussed by reiman & pomphrey ( 1991 ) .",
    "having computed the energy on a grid of @xmath86 values , one can interpolate to obtain the full hamiltonian @xmath88 . if the system is not in fact completely integrable , this @xmath79 may be rigorously interpreted as smooth approximation to the true @xmath79 ( warnock & ruth 1991 , 1992 ) and can be taken as the starting point for secular perturbation theory . kaasalainen ( 1994 ) developed this idea and showed how to recover accurate surfaces of section in the neighborhood of low - order resonances in the planar logarithmic potential .",
    "percival ( 1977 ) described a variational principle for constructing tori .",
    "his technique has apparently not yet been implemented in the context of galactic dynamics .",
    "torus - construction machinery may be applied to orbits that are approximately , but not precisely , regular ( laskar 1993 ) .",
    "the frequency spectrum of a weakly chaotic orbit will typically be close to that of a regular orbit , with most of the lines well approximated as linear combinations of three `` fundamental frequencies '' @xmath33 .",
    "however these frequencies will change with time as the orbit diffuses from one `` torus '' to another .",
    "the diffusion rate can be measured via quantities like @xmath92 , the change in a `` fundamental frequency '' over two consecutive integration intervals .",
    "papaphilippou & laskar ( 1996 , 1998 ) , valluri & merritt ( 1998 ) and wachlin & ferraz - mello ( 1998 ) used this technique to study chaos and diffusion in triaxial galactic potentials .",
    "kaasalainen ( 1995b ) showed that approximate tori could be constructed even in chaotic phase space via the hybrid scheme of warnock ( 1991 ) .",
    "while such tori clearly do not describe the motion of chaotic orbits over long times , they are useful for understanding the onset of chaos and its relationship to resonances , as well as for studying evolution of the phase - space distribution function in action space via the fokker - plank equation ( lichtenberg & leiberman 1992 ) .",
    "trajectory - following schemes for torus construction are robust and easily automated",
    ". they can recover the fundamental frequencies with great precision and are well suited to studies of weak chaos and for mapping resonances .",
    "however they are inefficient for constructing the full torus of an orbit that lies close to , but slightly off of , a resonance .",
    "iterative techniques are efficient for assigning energies to actions but less suited to recovering the other quantities of interest to galactic dynamicists , such as the fundamental frequencies",
    ". however they can be more efficient than trajectory - following algorithms for constructing nearly - resonant tori .",
    "hybrid schemes that combine features of both approaches show considerable promise ."
  ],
  "abstract_text": [
    "<S> the maximally compact representation of a regular orbit is in terms of its action - angle variables @xmath0 . </S>",
    "<S> computing the map between a trajectory s cartesian coordinates and its action - angle variables is called torus construction . </S>",
    "<S> this article reviews various approaches to torus construction and their application to galactic dynamics . </S>"
  ]
}