{
  "article_text": [
    "an insulator is distinguished from a conductor at zero temperature by its vanishing dc conductivity and its ability to sustain a macroscopic polarization , both with and without an applied electric field@xcite . in the classical theory of electromagnetism in materials",
    "this distinction is often cast in terms of the difference between `` free charges '' that carry the dc current in a conductor and polarizable `` bound charges '' in an insulator@xcite .",
    "such a description conflicts with the fact that , even in highly ionic solids , the electrons are not well localized near the ions , and there is appreciable interpenetration between the ionic charge densities@xcite .",
    "the inadequacy of such a textbook picture is particularly striking in the case of covalent insulators , whose charge density is delocalized , as in metals@xcite .",
    "therefore the qualitative difference between metals and insulators is not apparent from inspection of the charge distribution , and the correct notion of electronic localization in insulators versus delocalization in conductors must be sought elsewhere .",
    "as shown by kohn@xcite , localization is a property of the many - electron wavefunction : insulating behavior arises whenever the ground state wavefunction of an extended system breaks up into a sum of functions @xmath6 which are localized in essentially disconnected regions @xmath7 of the high - dimensional configuration space . when using periodic boundary conditions on a supercell containing @xmath4 electrons , an insulating wavefunction can be written as    @xmath8    where for a large supercell @xmath6 and @xmath9 have an exponentially small overlap for @xmath10 .",
    "hence , electronic localization in insulators does not occur in real space ( charge density ) but in configuration space ( wavefunction ) .",
    "kohn argued that such disconnectedness is in fact the signature of an insulating wavefunction .",
    "the other aspect of insulators , macroscopic polarization , is a subject about which there has been much debate . in a finite system with open boundary conditions , it is simply the dipole moment of the charge distribution divided by the volume@xcite . in the case of an extended system , such as a crystalline solid ,",
    "the situation is far less clear : although there exist well - known expressions for dielectric response functions@xcite , the very definition of macroscopic polarization as a bulk property independent of surface termination remained controversial for a long time . only in recent years",
    "has a theory of polarization emerged - the so - called berry phase formulation@xcite - for the average bulk polarization in terms of the ground state wavefunction of an insulating crystal .",
    "this theory shows that in general the information about the macroscopic polarization of a periodic system is not in the charge density , but in the wavefunction .",
    "this important finding is consistent with the well - known fact that the dipole moment of a periodic , continuous charge distribution is ill - defined@xcite , since the expressions for the first moment of the charge distribution are valid for finite systems but do not have a well - defined thermodynamic limit independent of the surface .",
    "the only instance where a meaningful dipole moment can be assigned to a unit cell of the crystal is when the charge distribution in the unit cell can be resolved into contributions which are localized in non - overlapping regions and can be ascribed to identifiable atoms ( ions , molecules)@xcite ( the so - called `` clausius - mossotti limit '' ) .",
    "however , such a limit is rather unrealistic for most insulators , with the possible exception of some organic and molecular crystals .    in this paper",
    "we present a comprehensive theory of polarization and localization in insulators , which generalizes the berry phase theory and merges with kohn s theory of localization in the insulating state . by introducing the generating function formalism",
    ", we show the rigorous connections between polarization and localization , establish relations to experimentally measureable quantities , and provide formulas for practical calculations .",
    "the paper is organized as follows : in section [ recent_develop ] we summarize some of the recent developments in the field , pointing to some of the open issues which will be addressed in this work , and collect relevant equations for later reference . in section [ moment_gen_fnct ] is introduced the central concept in the present formulation : the generating function applied to the quantum probability distribution of the macroscopic polarization .",
    "the simple case of a finite system is discussed first , and then we show how to generalize the expressions to deal with extended systems . in section [ fdt ]",
    "we establish the fluctuation - dissipation relation between the quadratic quantum fluctuations of the polarization and the absorptive part of the conductivity for an extended system . in section [ fluct_ins_cond ]",
    "we discuss the qualitative differences between the quadratic fluctuations in insulators and in conductors in terms of a properly defined localization length ; for insulators we derive an inequality involving the localization length and the optical gap . in section [ connection_kohn ]",
    "we introduce `` many - body wannier functions '' and establish the connection between the present formalism and kohn s theory of localization in the insulating state .",
    "discretized formulas for the polarization and localization which can be used in numerical many - body calculations are derived in section [ discrete ] .",
    "a discussion of our results is presented in section [ discussion ] .",
    "a meaningful definition of average macroscopic polarization which is generally applicable - to both finite and extended systems - and relates closely to the way polarization is experimentally measured , can be obtained by taking as the more basic concept the _ change _ in polarization induced by a slow change in some parameter @xmath11 in the hamiltonian@xcite .",
    "the resulting expressions for an extended system are in terms of the derivative @xmath12 , and resta@xcite proposed to calculate the finite change in bulk polarization as    @xmath13    considering the variation in @xmath11 as an adiabatic time evolution , @xmath14 is the spatially - averaged adiabatic current flowing through the bulk ; thus this equation gives @xmath15 as an integrated bulk current . according to classical electrodynamics@xcite ,",
    "this adiabatic polarization current is    @xmath16    where @xmath17 is the volume of the system and @xmath18 is the current density in the bulk , where @xmath11 plays the role of time in the usual expression for the current ( for a derivation see for example ref .",
    "@xmath19 can be expressed as the adiabatic limit of a kubo formula for the current@xcite . in its usual form",
    "the kubo formula involves a summation over all eigenstates ( ground state and excited states ) , which not only makes it impractical for actual calculations , but also fails to reflect the fact that bulk polarization is a ground state property .    in the berry phase theory of polarization@xcite , the kubo formula is recast in a form which only depends on the ground state wavefunction",
    "; in order to arrive at such an expression , it is convenient to impose _ twisted boundary conditions _ over the volume @xmath17 on the many - body wavefunction , which becomes labelled by @xmath20 :    @xmath21    where @xmath4 is the number of electrons in the system , @xmath22 , for example , and @xmath23 .",
    "it is convenient to introduce the following wavefunction :    @xmath24    where @xmath25 , so that @xmath26 is the position operator for the center of mass of the @xmath4 electrons in the volume @xmath17 .",
    "@xmath27 can be regarded as the many - body analogue of the cell - periodic part of the bloch function in the single - electron case .",
    "it obeys periodic boundary conditions , and the @xmath20-dependence is transfered from the boundary conditions to the hamiltonian : if @xmath28 is the ground state of an hamiltonian @xmath29 , then @xmath27 is the ground state of the hamiltonian    @xmath30    which , for a non - relativistic hamiltonian without spin - orbit coupling , can be obtained from @xmath29 by performing the gauge transformation @xmath31 on the momentum operator of each particle ( for the single - particle analogue , see ref .",
    "@xcite . ) using the function @xmath27 , the kubo formula for the adiabatic current @xmath32 for a particular choice of twisted boundary conditions can be expressed as@xcite    @xmath33    which indeed only depends on the ground state wavefunction . substituting this expression into eq .",
    "[ current1 ] and using eq .",
    "[ delta_p ] , it can be shown that the net change in polarization along the path parametrized by @xmath11 is    @xmath34,\\ ] ]    where the integral in @xmath20 is over all twisted boundary conditions .    as expected for a measurable quantity , the above expression , as well as eq .",
    "[ adiabatic_current ] , are invariant under gauge transformations of the form    @xmath35    where @xmath36 is a smooth , real function .",
    "the ground state wavefunctions @xmath37 at @xmath20 and @xmath38 , where @xmath39 is a basis vector of the reciprocal lattice of the cell of volume @xmath17 , can differ at most by a global phase factor , since the boundary conditions are the same and the ground state is assumed to be non - degenerate@xcite :    @xmath40    if @xmath41 , which is at our disposal , is chosen to be independent of @xmath11 , then it can be shown that the net change in polarization becomes simply    @xmath42    where    @xmath43    and again the integral in @xmath20 is over all twisted boundary conditions . eqs .",
    "[ delta_p_integral ] , [ two_point ] , and [ delta_p_om94 ] form the central result of ref .",
    "@xcite , which gives the many - body generalization of the berry phase theory of polarization , originally formulated by king - smith and vanderbilt for independent electrons@xcite . in the derivation it is assumed that the ground state is isolated from the excited states by a finite energy gap , and that there are no long - range correlations@xcite . in the independent - electron theory",
    "the berry phase formula in terms of bloch functions can be recast in terms of localized wannier functions@xcite , yielding the intuitive result that the electronic polarization is given by the sum of the centers of charge of the occupied wannier functions@xcite .",
    "unfortunately , wannier functions are only defined in a one - electron framework . in section [ loc_config_space ]",
    "we will introduce functions which are in some sense the many - body counterpart of wannier functions ( we will term them `` many - body wannier functions '' ) , and can be chosen to be localized in configuration space . in terms of those functions ,",
    "a localized description of polarization can be presented for the correlated case .",
    "moreover , they establish the link between the berry phase theory of polarization and kohn s theory of localization@xcite .    the following comments should be made about the above equations : unlike eq .",
    "[ delta_p_integral ] , which involves an integral over @xmath11 , eqs .",
    "[ two_point ] and [ delta_p_om94 ] only depend on the endpoints , @xmath44 and @xmath45 .",
    "the tradeoff is that whereas the former gives the exact change in polarization along the path , the latter give it only modulo a `` quantum''@xcite ( this `` quantum of polarization '' is discussed in appendix [ quantum ] ) .",
    "a related aspect is the behavior of the equations under gauge transformations : unlike eqs .",
    "[ adiabatic_current ] and [ delta_p_integral ] , eqs . [ two_point ] and [ delta_p_om94 ] are not completely gauge - invariant . as mentioned previously , they were obtained by assuming @xmath46 , and therefore the resulting @xmath47 is only invariant ( modulo the quantum ) under transformations which preserve the condition @xmath48 .",
    "moreover , in order to be able to interpret eq .",
    "[ delta_p_om94 ] at a _ single _ @xmath11 as the electronic polarization@xcite , one has to impose the stronger condition @xmath49 , or @xmath50 .",
    "gauges that obey this condition are known as `` periodic gauges''@xcite .",
    "it has been pointed out by aligia@xcite that this analysis needs to be modified in cases where there is a fractional number of electrons per primitive cell .",
    "the idea of a `` periodic gauge '' needs to be extended to relate wavefunctions separated by multiples of the smallest @xmath39 , and the integral in eq .",
    "[ delta_p_om94 ] needs to be extended accordingly . for the sake of simplicity , in the main text we will assume integer filling , and in appendix [ frac_fill ]",
    "we indicate how to modify the formulas in order to deal with fractional filling .",
    "we note that in its present form the berry phase theory of polarization only gives the _ average _ of the quantum distribution of the macroscopic polarization . in sections",
    "[ gen_extended ] and [ gi_cumulant ] we will extended it to deal with the full distribution .",
    "in particular , its quadratic spread will turn out to be a very relevant quantity , since it is intimately related to electronic localization . to our knowledge",
    "this was first discussed by kudinov@xcite , who proposed to measure the degree of localization in insulators precisely in terms of the mean - square quantum fluctuation of the ground state polarization .",
    "kudinov proposed a criterion to differentiate between insulators and conductors based on the scaling with sample volume @xmath17 of the mean square quantum fluctuation of the net dipole moment , @xmath51 ; here @xmath52 is the dipole moment operator , @xmath53 means the expectation value over the ground state , and @xmath54 . using the fluctuation - dissipation theorem@xcite , kudinov related this quantity to the optical conductivity :    @xmath55    where @xmath56 is the electric susceptibility tensor and @xmath57 . using eq .",
    "[ fdt1 ] , kudinov showed that as @xmath58 , @xmath59 remains finite in insulators , whereas it diverges in conductors .",
    "only finite systems with open boundary conditions were considered , and thus the issue of how to deal with the polarization in extended systems was not addressed .",
    "our formulation leads to similar expressions , but with carefully defined bulk quantities which have a well - defined thermodynamic limit .",
    "the ideas from the berry phase theory of polarization have recently been extended in order to address the problem of localization .",
    "this effort was initiated in ref .",
    "@xcite , where non - interacting electron systems with a band gap were considered . for such systems it is natural to attempt to quantify the degree of localization of the electrons in terms of the spread of the occupied wannier functions .",
    "marzari and vanderbilt proposed to measure that spread via the quantity    @xmath60,\\ ] ]    where @xmath61 means the expectation value over the @xmath62 occupied wannier function in the unit cell ( whose total number @xmath63 equals the number of filled bands . ) since the electronic polarization is given by the sum of the centers of charge of the occupied wannier functions@xcite , this expression is very appealing in its interpretation as the spread of the charge distribution of the wannier functions .",
    "it should be noted however , that unlike the sum of the centers of charge , the sum of the quadratic spreads is not invariant under gauge transformations of the wannier functions@xcite , and so @xmath64 can not be used directly as a measure of any physical quantity .",
    "nevertheless , marzari and vanderbilt were able to decompose it into a sum of two positive terms : a gauge - invariant part , @xmath65 , plus a gauge - dependent term , which they minimized to obtain maximally - localized wannier functions .",
    "we will show that @xmath65 gives the mean - square fluctuation of the bulk polarization , thus obeying a relation analogous to eq .",
    "[ fdt1 ] ( see appendix [ omega_i_fluct ] ) .",
    "moreover , in the same way that @xmath64 measures the spread of the wannier functions , @xmath65 measures the spread of kohn s functions @xmath6@xcite , which can be interpreted as maximally - localized `` many - body wannier functions '' ; this is discussed in section [ loc_config_space ] and appendix [ omega_i_many_body ] .    in ref .",
    "@xcite it was shown that @xmath65 be rewritten as    @xmath66    where tr denotes the trace , @xmath67 is the volume of the unit cell , the integral is over the brillouin zone , and @xmath68 is the tensor    @xmath69    where @xmath70 is the cell - periodic part of the bloch function .",
    "this tensor is a metric which can be used to determine the `` quantum distance '' along a given path in in @xmath20-space@xcite . in section [ gi_cumulant ]",
    "we generalize this tensor to the many - body case , and in section [ fdt ] we relate it to the measurable polarization fluctuations via the fluctuation - dissipation relation .",
    "all of the above expressions for the polarization and localization involve integrals over @xmath20 .",
    "more recently , alternative expressions have been proposed which use only periodic boundary conditions ( @xmath71)@xcite .",
    "these are sometimes called `` single - point '' formulas . the basic quantity in this formulation is , in one dimension ( 1d ) ,    @xmath72    where @xmath73 is the ground state many - body wavefunction obeying periodic boundary conditions over a cell of length @xmath74 with @xmath4 electrons , and as before @xmath75 .",
    "resta@xcite showed that in the thermodynamic limit the electronic polarization is given by    @xmath76    however , the nature of the approximations involved at finite @xmath74 , and the precise relation between eqs .",
    "[ delta_p_om94 ] and [ p_resta ] as a function of the size of the system , were not clarified ; this is a matter of crucial importance for the usefulness of the expressions in practical calculations , and is discussed in section [ comparison ] .",
    "resta and sorella@xcite proposed to measure the localization length in 1d insulators as@xcite    @xmath77    where @xmath78 and    @xmath79    they showed that if the electrons are uncorrelated , then for insulators @xmath80 is simply related to the 1d version of @xmath65 defined in eq .",
    "[ omega_i ] ( @xmath81 ) , and therefore @xmath80 is finite , whereas for metals it diverges ( even before taking the limit @xmath82 ) .",
    "then they proposed that a similar behavior should occur when the electrons are correlated ( with the difference that in general @xmath80 diverges for correlated conductors only after taking the limit ) .    in the present work we generalize eq .",
    "[ resta_lambda ] to many dimensions ( see section [ discrete_fix ] ) , and give an explicit many - body derivation that , similarly to @xmath65 in the uncorrelated case , @xmath83 measures the polarization fluctuations in correlated systems .",
    "similarly to the continuum formulas involving an average over twisted boundary conditions@xcite , these formulas require modification when there is a non - integer number of electrons per cell@xcite ( see appendix [ frac_fill ] ) .",
    "generating functions play a central role in the theory of statistics@xcite , and have been applied to many problems in physics@xcite . loosely speaking ,",
    "a generating function of a distribution is some function which yields , upon successive differentiation , the moments of the distribution , or some combination thereof .",
    "two kinds of generating functions will be of interest to us : the _ characteristic function _",
    "@xmath84 , and its logarithm , the _ cumulant generating function_. if @xmath85 is a vector of @xmath86 variables @xmath87 with a normalized joint probability distribution function @xmath88 , the characteristic function is defined as    @xmath89    where @xmath90@xcite .",
    "the @xmath86-dimensional moments can be extracted directly from @xmath84 :    @xmath91    where @xmath92 .",
    "the cumulants are obtained in a similar way from @xmath93 :    @xmath94    where , following the notation of ref .",
    "@xcite , @xmath95 denotes the _ cumulant average _ , which in general is different from the simple average @xmath53 associated with the moments :    @xmath96    an important property of cumulants is that they can be explicitly represented solely in terms of the lower moments , and vice - versa .",
    "more precisely - and this is very relevant for what follows - for @xmath97 they can be expressed in terms of the _ central moments _ @xmath98 , where @xmath99 and @xmath100 , and thus they are independent of the mean @xmath101 . moreover ,",
    "provided that the characteristic function exists , the set of all the moments or cumulants completely determines the distribution .",
    "let us consider a neutral 3d system of finite volume @xmath17 containing @xmath4 electrons and @xmath102 nuclei .",
    "the dipole moment operator is @xmath103 , where @xmath25 and @xmath104 .",
    "the average dipole moment of the system is @xmath105 .",
    "since the center of mass @xmath0 of the electrons is not perfectly localized , @xmath37 is not an eigenstate of @xmath106 .",
    "therefore the cartesian components of the dipole moment undergo quantum fluctuations , having a joint probability distribution @xmath107 dictated by the ground state wavefunction .",
    "for simplicity we will assume that the nuclei can be treated classically as `` clamped '' point charges ; then they only contribute to the average of the distribution , and the quantum fluctuations come solely from the electrons .",
    "hence , in what follows we will neglect the nuclear contribution , focusing on the distribution of the electronic center of mass . if @xmath37 is the many - electron wavefunction ( parametrized by the nuclear coordinates ) with normalization @xmath108 , that distribution is given by    @xmath109    similarly , for a given component , say , @xmath110 , the distribution is    @xmath111    the characteristic function @xmath84 is obtained by substituting eq .",
    "[ x_dist ] into eq .",
    "[ characteristic_function ] :    @xmath112    it is clear that if we define @xmath113 we find , using eq . [ moments ] , @xmath114@xcite .",
    "the electronic polarization operator is @xmath115 , and the moments of its distribution are given by    @xmath116    where @xmath117 .      in the case of a finite system",
    "the characteristic function @xmath84 was introduced as a purely formal device for obtaining the moments of the distribution , since in practice it was completely equivalent to a direct evaluation of the moments . in the case of an extended system",
    "the situation is rather different since , as discussed in the introduction , the very definition of polarization needs to be reexamined , and a naive generalization of the direct method of calculating the moments does not apply .    again let us consider a system with @xmath4 electrons in a volume @xmath17 . as in previous work described in section [ recent_develop ] , it will be convenient to use twisted boundary conditions ( eq . [ twisted ] ) .",
    "the difficulties in defining the macroscopic bulk polarization can be seen from the fact that @xmath118 is not a valid operator in the hilbert space defined by eq .",
    "[ twisted ] : indeed , if @xmath119 is a vector in that space , @xmath120 is not ( it is not even normalizable ) , and thus @xmath121 is ill - defined . we will now show that although the _ operator _ @xmath106 is ill - defined , one can nevertheless define a meaningful joint probability _ distribution _",
    "@xmath122 for the electronic center of mass in an extended insulating system .",
    "this will have the same physical interpretation as eq . [ x_dist ] for a finite system ,",
    "i.e. , the moments of the variables @xmath123 are the moments of the distribution of the electronic polarization :    @xmath124    our main interest will be in the average @xmath101 and in the quadratic spread @xmath125 which , according to ref .",
    "@xcite , measures the electronic localization .",
    "more precisely , we will define the localization length @xmath1 along the @xmath2-th direction as    @xmath126    the desired distribution @xmath122 can be obtained via a proper generalization of the characteristic function @xmath84 , which for a finite system was given by eq .",
    "[ char_fnct_finite ] .",
    "we start by introducing the quantity @xmath127 , which is a _ precursor _ to the characteristic function for the extended system :    @xmath128    where in the last equality we used eq .",
    "[ phi ] . in the first form",
    "the similarity to eq .",
    "[ char_fnct_finite ] is evident@xcite ; notice , however , that this is not an expectation value over a single ground state @xmath129 , since the boundary conditions on the _ bra _ ( @xmath20 ) and on the _ ket _ ( @xmath130 ) are different . that is required in order to compensate for the shift by @xmath131 in the boundary condition on the _ ket _ caused by the operator @xmath132 ; in this way the states @xmath133 and @xmath134 obey the same boundary conditions even for @xmath135 , so that their dotproduct @xmath136 does not vanish and @xmath127 can be chosen to be a differentiable function ( we are assuming that the ground state insulating wavefunction @xmath129 is non - degenerate and is separated in energy from the excited states by a finite gap ) .    that @xmath127 is not yet the characteristic function for the extended system can be seen from the fact that the first `` moment '' that it generates is not gauge - invariant , as required from any physical quantity@xcite . if @xmath127 were the characteristic function , the first moment would be , according to eq .",
    "[ moments ] , @xmath137 . but",
    "this is nothing other than the _ berry connection _ , which is a gauge - dependent quantity ( see , for instance , ref .",
    "@xcite ) .      gauge - invariant moments and cumulants for the extended system can be obtained from the following cumulant generating function , which is the central quantity in this work :    @xmath138    where the average is over all twisted boundary conditions ( for special cases where the number of electrons per primitive cell is not an integer , see appendix [ frac_fill ] ) .",
    "the cumulants are then obtained in the same way as in eq .",
    "[ cumulants ] :    @xmath139    and likewise for the moments .",
    "before we continue , we point out that @xmath140 is in general different from the function    @xmath141    this is also a characteristic function , but of a different , gauge - dependent distribution , whose interpretation and relation to @xmath140 will be discussed in section [ loc_config_space ] .",
    "as mentioned in section [ recent_develop ] , eq .",
    "[ delta_p_om94 ] is most easily interpreted when using a periodic gauge : @xmath142 .",
    "since we will recover that equation starting from @xmath143 , a periodic gauge will be assumed in what follows ; thus what is meant here by gauge - invariance is invariance under transformations which preserve the phase in eq .",
    "[ global_topology ] .",
    "the most general @xmath144 in eq .",
    "[ gauge_trans ] which complies with this requirement is@xcite :    @xmath145    where @xmath146 is an arbitrary lattice vector and @xmath147 .",
    "the gauge - invariance of the cumulants generated by @xmath143 can now be seen as follows : according to eqs .",
    "[ gauge_trans ] , [ cumulants ] , and [ bulk_m ] , the cumulants change under a general gauge transformation as    @xmath148    substitution of eq .",
    "[ varphi ] into eq .",
    "[ cumulant_gauge ] shows that for @xmath149 the cumulants change as @xmath150 , whereas for @xmath97 they remain unchanged .",
    "the change in @xmath151 but not in the higher cumulants ( which do not depend on the mean ) indicates a rigid shift by @xmath146 of the whole distribution @xmath122 , and is related to the quantum of polarization@xcite ( see appendix [ quantum ] ) .",
    "the cumulants are also real , as expected : defining @xmath152 and @xmath153 , we obtain @xmath154 . choosing a gauge such that @xmath155 , which can always be done due to time - reversal symmetry@xcite , leads to @xmath156 , and thus @xmath157}^*$ ] . that completes the proof , since according to eqs .",
    "[ precursor_mgf ] , [ bulk_m ] , and [ cumulants_ext ] , @xmath158 is given by the average over @xmath20 of @xmath159 .",
    "( since gauge - invariance was previously established , the choice @xmath155 can be made without loss of generality . )",
    "let us now look at explicit expressions for the first few cumulants .",
    "combining eqs .",
    "[ precursor_mgf ] and [ bulk_m ] and taking the first derivative , we find    @xmath160    together with eq .",
    "[ cumulants ] , this gives    @xmath161    which , with the help of eq .",
    "[ moments_polarization_bulk ] , is seen to be precisely the berry phase expression for the average electronic polarization ( eq .",
    "[ delta_p_om94 ] ) .",
    "our formulation in terms of @xmath140 therefore agrees with the berry phase theory of polarization@xcite .",
    "it is however more general , since it also provides the higher moments : for @xmath162 , similar steps as before lead to    @xmath163.\\ ] ]    integrating the first term by parts ( using the periodic gauge condition ) and noting that @xmath164 , this becomes @xmath165 , where    @xmath166    is the gauge - invariant _ quantum geometric tensor_@xcite [ see also eq .",
    "c9 of ref .",
    "the real part of @xmath167 is the metric tensor @xmath168 first introduced by provost and vallee@xcite :    @xmath169    where the second term is automatically real .",
    "@xmath168 is the many - body analogue of the tensor @xmath170 defined in eq .",
    "[ metric ] . using eq .",
    "[ first_cumulants ] and the fact that the cumulants are real , @xmath171 can be rewritten as    @xmath172    which becomes , after taking the trace , the many - body counterpart of eq .",
    "[ omega_i ] .",
    "the above equation establishes the physical interpretation of the @xmath20-averaged metric tensor as the mean - square fluctuation of the macroscopic bulk polarization ( see also the next section ) .",
    "the connection between such `` quantum metrics '' and quantum fluctuations was pointed out already in ref.@xcite .",
    "we have seen that the first cumulant agrees with the berry phase expression for the average macroscopic polarization . here",
    "we will show that the expression for the second cumulant , eq .",
    "[ second_cumulant_c ] , is consistent with the fluctuation - dissipation relation@xcite between the bulk polarization fluctuations and the optical conductivity @xmath173 .    for a _ finite _ system with open boundary conditions , which is the case discussed by kudinov@xcite , the kubo - greenwood formula for the conductivity can be written in terms of the off - diagonal position matrix elements , @xmath174 :    @xmath175,\\ ] ]    where @xmath176 .",
    "alternatively , the well - known relation    @xmath177    can be used to rewrite eq .",
    "[ kubo_greenwood_finite ] in terms of momentum matrix elements .",
    "whereas for a finite system the two formulas are interchangeable , for an extended system the position matrix elements become ill - defined , and therefore only the latter form remains valid .    at this point",
    "it is convenient to introduce the notation    @xmath178    the single - body analogue of such quantities is discussed in refs .",
    "our motivation for introducing them is the following : if @xmath179 is the many - body momentum operator for the extended system , and @xmath180 , in the case of a non - relativistic hamiltonian without spin - orbit coupling eqs .",
    "[ phi ] and [ h_k ] lead to    @xmath181 \\right|   \\phi_{m \\bf k } \\right > = \\imath m_e   \\omega_{nm}({\\bf k } ) x^i_{nm,\\bf k } \\hspace{0.1 in } ( m \\not= n),\\ ] ]    which is formally identical to eq .",
    "[ commutation_xp_finite ] .",
    "notice , however , that we are now dealing with an _ extended _ system with twisted boundary conditions , for which the proper position matrix elements , @xmath182 , are ill - defined ; the above relation shows that they should be replaced by the quantities @xmath183 . substituting eq .",
    "[ commutation ] into the kubo - greenwood formula in the form valid for an extended system , we are left with an expression for @xmath184 formally identical to eq .",
    "[ kubo_greenwood_finite ] , with @xmath185 replaced by @xmath183 and @xmath186 replaced by @xmath187 .",
    "let us now specialize to the ground state ( @xmath188 ) , assuming that it is non - degenerate ; then @xmath189 , and we obtain    @xmath190    using the completeness relation to eliminate the excited states on the r.h.s , and comparing with eq . [ geometric_tensor ] , we find @xmath191 . together with @xmath192 ,",
    "this yields    @xmath193    averaging over all twisted boundary conditions and using eqs . [ cumulants_ext ] and [ second_cumulant_c ] , we arrive at the desired relation :    @xmath194 =   \\frac{\\hbar}{\\pi q_e^2 n_0 } \\int_0^{\\infty } \\frac{d \\omega}{\\omega } { \\rm re } \\overline{\\sigma}_{ij}(\\omega),\\ ] ]    where @xmath195 and @xmath196 .",
    "[ fdt_bulk ] is precisely the fluctuation - dissipation relation for more than one variable@xcite at @xmath197 ( compare with eq .",
    "[ fdt1 ] ) .",
    "here we will generalize to extended systems kudinov s analysis of the dipole moment fluctuations as a way to distinghish insulators from conductors@xcite , and discuss it in terms of a localization length .",
    "it is convenient for that purpose to classify solids into three categories , according to the low - frequency behavior of the conductivity at @xmath197 as @xmath58 :    @xmath198    insulators are characterized by a vanishing dc conductivity , in contrast to conductors .",
    "the singular contribution @xmath199 occurs in ideal conductors - those without any scattering mechanism - and @xmath200 is called the `` drude weight '' or `` charge stiffness''@xcite . if there is scattering , the @xmath201 function peak is smeared out to a lorentzian , so that @xmath202 and the dc conductivity of non - ideal conductors , such as disordered metallic alloys , has a finite value @xmath203 ; @xmath204 is the regular finite - frequency part of @xmath205 in perfect conductors .    the only possible divergence of the integral on the r.h.s . of eq .",
    "[ fdt_bulk ] is around @xmath206@xcite , because as @xmath207 @xmath208@xcite . substituting eq .",
    "[ real_cond_low_freq ] into eq .",
    "[ fdt_bulk ] we see that the quantity @xmath1 in eq .",
    "[ loc_length ] is finite for insulators and diverges for conductors . by the same token ,",
    "using the zero - frequency limit of the kramers - krnig relation@xcite , one finds the familiar result that the static susceptibility is finite for insulators and divergent for conductors .",
    "hence , assuming eq .",
    "[ real_cond_low_freq ] , at @xmath209 the following three conditions are equivalent : ( i ) @xmath210 is finite , ( ii ) @xmath211 , and ( iii ) @xmath1 is finite .",
    "the quantity @xmath1 has the dimensions of length .",
    "since it is finite for insulators and infinite for conductors , it is natural to interpret it as an electronic localization length along the @xmath2-th direction . according to eq .",
    "[ fdt_bulk ] , for extended systems it can be written as @xmath212 , where @xmath213 is given in table i in terms of the cumulant generating function .",
    "this formula has a striking similarity to the drude weight formula derived by kohn in terms of the total energy @xmath214@xcite , given also in table i : both are second derivatives of some quantity with respect to the twisted boundary conditions ( in the case of @xmath213 the twisting of the boundary condition @xmath20 is followed by an averaging over all @xmath20 , hence the parameter @xmath215 instead of @xmath20 ) .",
    "it is clear from table i that unlike the localization length , the drude weight does not provide a universal criterion to discern insulators from conductors@xcite .",
    "however , the combination of the two quantities in principle enables us to distinguish between the three categories . in the same way that the drude weight measures the `` degree of conductivity '' of an ideal conductor",
    ", @xmath216 measures the degree of localization of the electrons in an insulator .",
    "insofar as localization - in a properly defined sense - is an essential property of the insulating state@xcite , this can be viewed as a meaningful measure of the `` degree of insulation '' , one which is expected to apply to all types of insulators .",
    "although we have managed to express @xmath1 in terms of the measurable optical conductivity via the fluctuation - dissipation relation , it is not yet clear how it relates to the notion of localization put forward by kohn , in terms of the localization properties of the insulating wavefunction in configuration space .",
    "that will be discussed in section [ loc_config_space ] .      in an insulator optical absorption",
    "starts at a threshold energy @xmath217 , below which @xmath218 ( we are neglecting phonon - assisted transitions , so that the gap @xmath217 is the minimum gap for optical transitions ) . from this",
    "it follows that    @xmath219    with the help of the sum rule for oscillator strengths@xcite @xmath220 ( @xmath221 is the plasma frequency ) , together with eqs .",
    "[ loc_length ] and [ fdt_bulk ] , we conclude that    @xmath222    this inequality shows that the polarization fluctuations are controlled by the optical gap , lending support to the intuitive notion that the larger the gap , the more localized the electrons are .",
    "it strongly resembles an inequality previously derived by kivelson@xcite for non - interacting electrons in 1d , where @xmath5 is replaced by the quadratic spread of properly chosen wannier functions . as discussed in appendix [ omega_i_fluct ] , in fact in 1d @xmath5 equals the average spread of the maximally - localized wannier functions .",
    "the expression for the cumulant generating function , eq . [ bulk_m ] , involves an average over all twisted boundary conditions , which was introduced in a somewhat _ ad hoc _ manner in order to render the resulting distribution gauge - invariant ( modulo a rigid shift by a quantum ) .",
    "we will now shed some light on the physical significance of the averaging procedure , by showing how it can be rationalized in terms of the notion of localization in insulators developed by kohn@xcite .",
    "this will be achieved by introducing `` many - body wannier functions '' , and will allow us to tie together the berry phase theory of polarization and kohn s theory of localization .",
    "it is instructive to start by discussing the case of a finite system of linear dimensions @xmath223 ( e.g. , a molecule with @xmath4 electrons ) . instead of the usual open boundary conditions , we can choose to impose periodic boundary conditions on its wavefunction ( @xmath71 in eq . [ twisted ] ) , choosing @xmath224 .",
    "the resulting @xmath4-electron wavefunction is periodic in configuration space , as depicted schematically in fig . 1 for 1d and @xmath225",
    "; it is a sum of partial wavefunctions which only differ from one another by a translation of the coordinates ,    @xmath226    where the @xmath227 label the partial wavefunctions .",
    "these are localized in geometrically equivalent regions @xmath228 in configuration space ( shaded regions in fig .",
    "1 ) , which for @xmath224 are essentially non - overlapping :    @xmath229    where , using the notation of refs . @xcite",
    ", the symbol @xmath230 denotes equality apart from exponential small corrections which vanish in a manner such as @xmath231 , where @xmath80 is a localization length ( in this example @xmath232 ) .",
    "next we switch from periodic to twisted boundary conditions ( @xmath233 in eq .",
    "[ twisted ] ) . from the localization properties it follows",
    "[ see section 2 of ref .",
    "@xcite and section vi of ref .",
    "@xcite ] that the periodic part of the wavefunction , @xmath234 , can be written with an exponentially small error as    @xmath235    where we have introduced the quantity    @xmath236    where @xmath237 , and @xmath238 is a largely arbitrary , periodic function , which joins smoothly with the values of @xmath239 at the boundaries of the regions @xmath240 .",
    "let us now look at the precursor characteristic function @xmath127 for such a finite system obeying twisted boundary conditions : substituting the previous expressions into eq .",
    "[ precursor_mgf ] , we find    @xmath241    which has the form of eq .",
    "[ char_fnct_finite ] , obtained using open boundary conditions .",
    "it is clear that as a result of localization of the electrons in real space the choice of boundary conditions is immaterial . in particular",
    ", @xmath127 becomes independent of @xmath20 , and thus from eqs .",
    "[ bulk_m ] and [ m_w ] we conclude that    @xmath242    hence , averaging over boundary conditions becomes redundant , and @xmath127 is already the correct , gauge - invariant characteristic function .",
    "finally , it is interesting to note that eqs .",
    "[ twisted_molecule ] and [ precursor_mgf_molecule ] can be viewed as a particular realization of eqs . 2.22 and 2.23 of ref .",
    "@xcite , which were used to relate the quantum metric to the quantum fluctuations .",
    "let us now consider an extended system , such as a crystal with twisted boundary conditions over a large volume @xmath17 .",
    "although in general the charge density will be delocalized in real space , kohn has argued that if the system is insulating the wavefunction is localized in configuration space@xcite .",
    "kohn s notion of localization is weaker than the one implied by eq .",
    "[ loc_molecule ] and fig .",
    "1 ; however , as we will see , it is sufficient to recover eq .",
    "[ clausius_mossotti ] , after making a judicious choice of gauge .",
    "we start by introducing a localized description of the many - electron insulating wavefunction in configuration space . in the non - interacting case , a localized one - electron description ( in real space )",
    "is provided by the wannier functions@xcite . the wannier function @xmath243 associated with band @xmath244 and centered around the unit cell labelled by the lattice vector @xmath146",
    "is related to the bloch functions by the following unitary transformation :    @xmath245    where a periodic gauge is assumed , and the sum is over a uniform grid of @xmath246 points in the brillouin zone@xcite . due to the discretization of the integral over @xmath20 ,",
    "@xmath247 is actually periodic in a large cell of volume @xmath248 ( @xmath67 is the volume of the unit cell ) .",
    "the many - body analogue of a periodic wannier function ( `` many - body wannier function '' ) can be defined in a similar way in terms of the many - body wavefunction @xmath129 ( again assuming a periodic gauge ) :    @xmath249    so that , using eq .",
    "[ phi ] ,    @xmath250    here @xmath251 , where the @xmath252 are integers , and the vectors @xmath253 define the volume @xmath17 containing @xmath4 electrons ( notice that @xmath17 is the volume of a supercell , typically a large multiple of the unit cell volume @xmath67 ) .",
    "@xmath254 is periodic and @xmath129 obeys @xmath20 boundary conditions over the volume @xmath255 in configuration space , and both @xmath129 and @xmath256 are periodic over the volume @xmath257 .",
    "the normalization conventions are the following : @xmath254 is normalized to one over a volume @xmath255 , and @xmath256 is normalized to one over a volume @xmath258 .",
    "similarly to the @xmath247 , the @xmath259 form an orthonormal set .",
    "from the same type of general considerations which are used to show that wannier functions can be chosen localized@xcite , it follows that we can choose @xmath256 localized in the variable @xmath260 , with a distribution    @xmath261    substituting eq .",
    "[ phi_wf ] in eq .",
    "[ precursor_mgf ] , averaging over @xmath20 , and comparing with eq .",
    "[ m_w ] , after discretizing the integral over @xmath20 , yields :    @xmath262    which shows that the function @xmath263 introduced in section [ gi_cumulant ] is the characteristic function of the distribution @xmath264 .",
    "it is straightforward to check that the first moment of this distribution equals the first moment of the gauge - invariant polarization distribution @xmath122 generated by @xmath140 ; this is similar to the independent - electron case , where the average polarization is given by the sum of the centers of charge of the gauge - dependent wannier functions@xcite .",
    "likewise , the `` many - body wannier functions '' @xmath256 are gauge - dependent , and as a result so are the higher cumulants of @xmath264 , in particular the quadratric spread .",
    "notice that the gauge - dependence of the @xmath256 implies that in general they overlap with one another@xcite , and only in certain gauges are they localized to the point of being essentially non - overlapping ( provided that the system is insulating ) .",
    "this is different from the usual single - body wannier functions , which in general remain overlapping in any gauge ( even though they are orthogonal ) ; in the many - body case we are free to choose the volume @xmath17 large enough so that with a judicious choice of gauge the @xmath256 become non - overlapping in the high - dimensional configuration space .",
    "we are now in a position to provide the link between the present formalism ( and , therefore , the berry phase theory of polarization ) and kohn s theory of localization@xcite . a major result of kohn s work is the conjecture that a general many - body insulating wavefunction @xmath73 breaks up into a sum of non - overlapping parts @xmath6 , localized in disconnected regions @xmath7 in configuration space ( eq . [ psi_insulator ] ) .",
    "upon inspection , one finds that the present `` many - body wannier functions '' are nothing other than kohn s functions , @xmath265 [ compare eq .",
    "[ phi_wf ] with eq .",
    "6.1 of ref .",
    "@xcite ] , except that kohn only considered gauges where they are localized in such a way that the overlap becomes exponentially small :    @xmath266    so that the @xmath6 are uniquely defined apart from exponentially small variations and a global phase . transposing the language of ref .",
    "@xcite to a many - body framework , kohn s functions @xmath6 can be viewed as the maximally - localized `` many - body wannier functions '' @xmath256 ( see appendix [ omega_i_many_body ] ) .",
    "in such `` non - overlapping gauges '' , the precusor characteristic function , eq . [ precursor_mgf ] , becomes , using eqs .",
    "[ phi_wf ] and [ loc_insulator ] ,    @xmath267    which is independent of @xmath20 , since the @xmath20-dependence of @xmath127 in a general gauge arises from the cross terms between different @xmath268 .",
    "therefore in such gauges we recover eq . [ clausius_mossotti ] , which for a finite system obeying twisted boundary conditions was valid in any gauge :    @xmath269    finally , from the gauge - invariance of @xmath140 we conclude that _ in any gauge _",
    "@xmath270    which is the desired relation .",
    "it should be stressed that in deriving this equation we _ assumed _ kohn s conjecture regarding the existence of non - overlapping many - body wannier functions in the insulating state .",
    "we interpret eq .",
    "[ characteristic_kohn ] as follows : in each region @xmath7 in the configuration space of the variables @xmath271 ( fig .",
    "2 ) , the variable @xmath272 takes on a range of values with a distribution generated by @xmath140 ,    @xmath273    which , together with eq .",
    "[ moments_polarization_bulk ] , gives the bulk polarization distribution .",
    "the previous equation can therefore be viewed as the generalization for extended insulating systems of eq .",
    "[ x_dist ] , which gives the distribution of the electronic center of mass for finite systems .    in fig . 3",
    "is represented the distribution @xmath274 along the @xmath2-th direction . according to eq .",
    "[ loc_length ] , the width of this distribution is @xmath275 .",
    "the solid lines describe what happens in a 1d insulator , for which the width of each of the peaks @xmath276 labelled by @xmath63 is @xmath277 and the distance between the centers of consecutive peaks is @xmath74 , so that for large @xmath74 they are well - separated . in the case of a 3d insulator where all the linear dimensions are similar ( @xmath278 )",
    ", the peaks @xmath274 overlap for large @xmath74 , since their width is @xmath279 ( dashed lines in fig .",
    "the important observation is that , according to eqs .",
    "[ loc_insulator ] and [ p_x_bulk ] , even if they are _ overlapping _ , the distributions @xmath122 are well - defined `` projections '' into real space of essentially _ disconnected _ distributions @xmath280 in configuration space@xcite .    at this point",
    "we shall reconsider the problem of how to define a meaningful many - body position operator for the electrons in extended systems , an issue which has been recently discussed in ref .",
    "we recall that the source of the problem is that in such systems the usual center - of - mass operator @xmath106 is ill - defined ( see section [ gen_extended ] ) .",
    "kohn@xcite proposed the following operator as the substitute for @xmath106 for taking expectation values over the ground state wavefunction of an extended _ insulator _ :    @xmath281    where @xmath238 is defined in a similar way as in eq .",
    "[ pos_clausius ] .",
    "it is straightforward to check that the moments calculated from @xmath282 coincide with those derived from the characteristic function : with the help of eqs .",
    "[ psi_insulator ] , [ characteristic_kohn ] , and [ pos_kohn ] , we find    @xmath283    the connection with ref .",
    "@xcite will be made in section [ discrete_fix ] .",
    "we now have an adequate framework for discussing the implications of localization for the dependence on boundary conditions of the bulk properties of insulators . as a first example , consider the adiabatic current @xmath32 .",
    "since it is gauge - invariant , we may evaluate it in any gauge , in particular in a `` non - overlapping gauge '' . substituting eq .",
    "[ phi_wf ] into eq .",
    "[ adiabatic_current ] we find , because of the exponential decrease of the overlap as the size @xmath74 is increased :    @xmath284    where for the last equality eqs .",
    "[ cumulants_ext ] and [ characteristic_kohn ] were used .",
    "thus for a large system size @xmath32 is essentially @xmath20-independent ( this was demonstrated in ref .",
    "@xcite using a different reasoning , for insulators with an energy gap ) .    as a second example , let us look at the quantum geometric tensor @xmath167 and its real part , the metric tensor @xmath285 .",
    "evaluating eq .",
    "[ geometric_tensor ] in a `` non - overlapping gauge '' with the help of eq .",
    "[ phi_wf ] , we find @xmath286 , which again is essentially independent of @xmath20 for large systems ( it is also real , so that @xmath287 )",
    ". thus we conclude that the @xmath20-independent metric tensor gives the mean - square fluctuation of the polarization .",
    "this is a stronger statement than the one made at the end of section [ gi_cumulant ] , which pertained to the @xmath20-averaged metric ( by contrast , the single - electron metric tensor @xmath170 given by eq .",
    "[ metric ] is in general @xmath20-dependent , since the one - electron wannier functions remain overlapping even when they are maximally - localized ; as a consequence , the quadratic polarization fluctuations are related to its _ average _ over the brillouin zone , as shown in appendix [ omega_i_fluct ] . )",
    "these two examples illustrate an important point : the physically measurable ground state quantities , such as the polarization current and the polarization fluctuations , are well - defined for any single boundary condition @xmath20 , and the choice of @xmath20 becomes immaterial for large system sizes .",
    "it may therefore seem bizarre that in the generating function formalism one needs to average over all @xmath20 before obtaining gauge - invariant quantities , as shown in section [ gi_cumulant ] .",
    "a concrete example helps to clarify this state of affairs : in the case of the second cumulant , had we taken the second derivative of the _ precursor _ cumulant generating function , @xmath288 , _ without _ afterwards averaging over @xmath20 , we would be left with a quantity ( the integrand of eq .",
    "[ second_cumulant ] ) , which is different from the desired one , @xmath289 , and is gauge - dependent .",
    "however , the @xmath20-average of that gauge - dependent quantity _ is _ gauge - invariant , and equals the @xmath20-average of @xmath290 ( compare eqs .",
    "[ second_cumulant ] and [ second_cumulant_c ] ) .",
    "a similar situation occurs with the adiabatic polarization current .",
    "the insensitivity of the bulk properties of insulators to the choice of boundary conditions on a large system seems to be a very general property . indeed , if @xmath291 is any well - defined operator acting on the ground - state of the extended system ( e.g. , the hamiltonian @xmath292 ) , then from eqs .",
    "[ phi ] , [ phi_wf ] , and [ loc_insulator ] it follows that @xmath293 , which helps to understand why , for instance , in insulators the drude weight ( see table i ) goes to zero exponentially with the system size@xcite .",
    "this has been confirmed by numerical simulations@xcite and calculations on exactly solvable models@xcite .",
    "more precisely , in ref . @xcite it was found that the drude weight for the half - filled hubbard model in 1d scales as @xmath294 , which yields a localization length @xmath295 .",
    "it would be worthwhile to investigate whether @xmath295 is the same as the localization length @xmath80 used in the present work .",
    "until now we have dealt with a continuum formalism , in which the cumulants are obtained by differentiating @xmath143 at @xmath296 .",
    "heuristically , this can be viewed as a measure of the @xmath20-averaged change in @xmath254 as the boundary condition @xmath20 is twisted adiabatically ( see eqs .",
    "[ precursor_mgf ] , [ bulk_m ] , and [ cumulants_ext ] ) . in numerical calculations",
    "it is often more natural to perform _ independent _ calculations on a discrete mesh of @xmath20-points and then use the resulting wavefunctions to estimate the derivatives by finite differences@xcite . since the global phases of the wavefunctions on the grid are unrelated , useful discretized expressions must remain invariant under arbitrary changes of those phases .",
    "the derivation of such discretized formulas becomes particularly transparent in the present formalism , as we will now show .",
    "we will find it convenient to work with scaled coordinates : let the simulation cell be defined by the vectors @xmath297 , to which correspond the reciprocal lattice vectors @xmath298 ( @xmath299 ) .",
    "the scaled coordinates @xmath300 are defined by @xmath301 , where a sum over repeated indices is implied , and similarly we have @xmath302 and @xmath303 ( and thus @xmath304 ) . in terms of these variables ,",
    "[ precursor_mgf ] and [ bulk_m ] become    @xmath305    and    @xmath306    so that @xmath307 is the joint characteristic function for the variables @xmath308 .",
    "the average is    @xmath309    next we discretize the derivative in the integrand as    @xmath310    where we made use of eq .",
    "[ precursor_mgf ] .",
    "this expression is gauge - dependent , just like its continuum counterpart , the berry connection . as in the continuum case , gauge - invariance",
    "is recovered by averaging over @xmath20 ; that is done by choosing a uniform row of @xmath311 @xmath20-points along the direction of @xmath312 such that the endpoints are separated by @xmath312 , @xmath313 with @xmath314 ; then @xmath315 , and we find :    @xmath316    where @xmath317 is some permutation of @xmath318 , and the periodic gauge is enforced by setting @xmath319 .",
    "the average polarization is then given by    @xmath320    which is the many - body analogue of the discretized berry phase formula proposed in ref .",
    "it is straightforward to verify that it is gauge - invariant .",
    "this property hinges upon ( i ) using a uniform row of @xmath20-points , ( ii ) choosing a periodic gauge , and ( iii ) having a logarithm in the expression , which in the present derivation appears quite naturally , coming from the cumulant generating function , eq .",
    "[ bulk_m_scaled]@xcite .    to compute the variance we discretize the second logarithmic derivative :    @xmath321,\\ ] ]    which is gauge - dependent , similarly to eq .",
    "[ first_derivative_discretized]@xcite . after some manipulations we obtain the following gauge - invariant , @xmath20-averaged formula :    @xmath322    the evaluation of the covariance requires taking cross derivatives , which can be discretized as    @xmath323,\\end{aligned}\\ ] ]    leading to    @xmath324,\\end{aligned}\\ ] ]    where @xmath325 .",
    "in order to convert back to cartesian coordinates we use the transformation law for a second - rank contravariant tensor , @xmath326 , where @xmath327 . eqs .",
    "[ polarization_discrete ] , [ variance_scaled ] , and [ covariance_scaled ] are all that is needed to calculate the average polarization and its quadratic fluctuations , as well as the correlations along different cartesian directions ( if the cell symmetry is orthorhombic or higher , eq . [ covariance_scaled ] is not needed for computing the fluctuations . ) in appendix [ frac_fill ] we give the required modifications to deal with fractional filling .",
    "we now turn to a different kind of discretized formulas , the so - called `` single - point '' formulas , such as eq .",
    "[ z_n ] . in the case of localization",
    "they were previously given for 1d only@xcite .",
    "in the present formalism the generalization to higher dimensions becomes straightforward .",
    "we will arrive at the `` single - point '' formulas starting from the expressions derived in the previous section , which involve averages over a uniform grid of @xmath20-points .",
    "the basic idea is to perform the many - body analogue of a `` brillouin zone folding''@xcite .",
    "let us start by discretizing the remaining integrals in eqs .",
    "[ polarization_discrete ] , [ variance_scaled ] , and [ covariance_scaled ] ; the expression for the average polarization , for example , becomes    @xmath328    where we have used a uniform spacing along all the reciprocal lattice directions : @xmath329 and @xmath330 is fixed ( usually @xmath331 . )",
    "next we build an _ ansatz _",
    "wavefunction@xcite @xmath332 contaning @xmath333 electrons as the antisymmetrized product of the @xmath334 separate @xmath4-electron wavefunctions @xmath335 :    @xmath336    where the sum is over all the permutations @xmath337 of the @xmath338 particle coordinates , @xmath339 is the parity of the permutation , and @xmath340 .",
    "it is easy to verify that @xmath332 obeys @xmath330 boundary conditions on the larger cell containing @xmath338 electrons .",
    "it can be shown that for even @xmath4 this leads to ( compare with eq . 16 in ref .",
    "@xcite , which deals with the 1d case ) :",
    "@xmath341    where @xmath342 is a basis vector of the reciprocal of the larger cell , and @xmath343 is the center of mass position operator of the @xmath338-electron system .",
    "comparison with eq .",
    "[ polarization_intermediate ] yields    @xmath344    similarly , discretizing the integrals in eq .",
    "[ variance_scaled ] and using eq .",
    "[ bz_folding_1 ] , we find    @xmath345    the quantity on the l.h.s",
    ". pertains to the @xmath4-particle system , whereas those on the r.h.s .",
    "pertain to the @xmath338-particle system .",
    "however , if we choose @xmath346 and use @xmath347 together with the transformation law between cartesian and scaled coordinates , we find @xmath348 .",
    ". [ variance_single_pt ] then becomes    @xmath349    where all the quantities are now explicitly written for the @xmath338-particle system .",
    "the following relation can be derived along the same lines as eq .",
    "[ bz_folding_1 ] :    @xmath350    discretizing the remaining integral in eq .",
    "[ covariance_scaled ] and again setting @xmath351 , we obtain , using eqs .",
    "[ bz_folding_1 ] and [ bz_folding_2 ] ,    @xmath352.\\ ] ]    eqs .",
    "[ polarization_single_pt ] , [ variance_single_pt_b ] , and [ covariance_single_pt ] are the desired `` single - point '' formulas . in appendix [ frac_fill ]",
    "we modify them for the case of fractional filling .",
    "in 1d the above formulas become particularly simple , and we recover the results of refs . @xcite and @xcite . in cartesian",
    "coordinates ( @xmath353 and @xmath354 ) they are    @xmath355    which is equivalent to eq .",
    "[ p_resta ] , and    @xmath356    which , together with eq .",
    "[ loc_length ] , gives eq .",
    "[ resta_lambda ] .      in the previous section we derived `` single - point '' formulas for the first two moments of the polarization , starting from discrertized expressions involving an average over boundary conditions . in order to switch between the two descriptions , an _",
    "wavefunction @xmath357 given by eq .",
    "[ antisymmetrized ] was used .",
    "however , this is strictly valid only if the @xmath338 particles are not correlated with each other . in that case @xmath357 becomes a slater determinant of one - electron orbitals , and the procedure leading to the `` single - point '' formulas ( `` brillouin zone folding '' ) does not involve any further approximations ( see refs .",
    "@xcite and @xcite ) .    for a correlated state of many particles",
    "the situation is rather different . in that context",
    "the `` single - point '' formulas were originally proposed in 1d for an _ arbitrary _ correlated @xmath338-electron wavefunction @xmath358 with periodic boundary conditions over a cell of size @xmath359@xcite ; such wavefunction in general will not obey eq .",
    "[ antisymmetrized ] , of course .",
    "the derivation of the previous section allows us to assess the approximations involved : these have to do with the extent to which a wavefunction given by eq .",
    "[ antisymmetrized ] differs from the fully correlated wavefunction .",
    "the key quantity to consider is the correlation length @xmath360 , which quantifies the range over which the particles are correlated ( in addition to any long range order which is included in the mean field potentials seen by each particle ) . the fact that the correlations are short - ranged has been termed `` nearsightedness '' by kohn in a recent paper@xcite ; in fact , in an insulator , for example , one expects the longest range correlations to be of the van der waals type , which decay as @xmath361 in the energy and as @xmath362 in the wavefunction@xcite .",
    "the basic assumption underlying eq .",
    "[ antisymmetrized ] , namely that the @xmath338 electrons only correlate in groups of @xmath4 at a time@xcite , is consistent with the principle of nearsightedness .",
    "this is the justification for applying the `` single - point '' formulas to a correlated insulating wavefunction , provided that the cell is large enough .",
    "from this perspective it becomes clear that the two types of formulas derived in sections [ discrete_avg ] and [ discrete_fix ] constitute different approximations to the same continuum expressions , which involve an average over all twisted boundary conditions . in both approaches",
    "one must choose cells with linear dimensions greater than @xmath360 : in the latter approach one must use a single large cell with size @xmath363 in order to have the same level of accuracy as @xmath364 independent calculations each of size @xmath17 using the former approach .    from a practical point of view",
    ", there are two possible ways to proceed : either perform several calculations with different twisted boundary conditions on a smaller cell and then use the formulas of section [ discrete_avg ] , or perform a single calculation on a large cell and then use the formulas of section [ discrete_fix ] .",
    "although the two approaches are comparable in terms of accuracy , the former approach should be more efficient , because the available many - body algorithms do not scale linearly with the number of particles .",
    "on the other hand , the averaging over boundary conditions may be more cumbersome to implement in practice .",
    "we have presented in this work a unified theory of electronic polarization and localization in insulators .",
    "the central quantity in the formalism is the cumulant generating function @xmath143 defined in eq .",
    "[ bulk_m ] ; it provides a systematic procedure for extracting from the ground state wavefunction @xmath129 the moments of a properly defined distribution @xmath122 for the electronic center of mass in an extended insulator . in complete analogy with the case of a finite system",
    ", this distribution is simply related to the quantum distribution of the ground state polarization , via eq .",
    "[ moments_polarization_bulk ] .",
    "several seemingly disparate ideas regarding electronic polarization and localization in insulators@xcite are brought together quite naturally using the generating function approach . in particular , it shows the connection between the berry phase theory of polarization@xcite , as well as the related theory of localization@xcite , and kohn s theory of localization in the insulating state@xcite .",
    "a key quantity is the localization length @xmath1 , which is defined in terms of the experimentally measurable mean - square fluctuation of the polarization ( eq .",
    "[ loc_length ] and table i ) , making contact with the work of kudinov@xcite . in the thermodynamic limit",
    "@xmath1 agrees with the localization length defined in ref .",
    "@xcite for 1d systems ( eq . [ resta_lambda ] ) .",
    "furthermore , the generating function formalism also reveals a very close formal analogy between kohn s localized many - electron functions @xmath6 and the maximally - localized one - electron wannier functions defined by marzari and vanderbilt@xcite : the former can be viewed as maximally - localized `` many - body wannier functions '' ( see section [ loc_config_space ] and appendix [ omega_i_many_body ] ) .",
    "moreover , in the same way that the quadratic spread of the functions @xmath6 is a measure of the mean - square fluctuations of the bulk polarization , the gauge - invariant part of the spread of the wannier functions ( which in 1d systems equals the spread of the maximally - localized wannier functions ) measures the same quantity for uncorrelated insulators . the fluctuation - dissipation relation can be used to derive an inequality ( eq .",
    "[ inequality ] ) between the polarization fluctuations and the minimum energy gap for optical absorption in an insulator .",
    "the present approach also provides some extra insight into the appearence of a `` quantum of polarization '' in periodic insulators@xcite , which is seen to be related to the existence of multiple geometrically equivalent regions @xmath7 , depicted in fig .",
    "2 ( see appendix [ quantum ] ) .    the localization length seems to play a role in the theory of insulators similar to that of the drude weight in the theory of ideal conductors : the latter measures how `` free '' the `` free charges '' in a perfect conductor are , whereas the former measures how localized the `` bound charges '' in an insulator are .",
    "interestingly , both quantities can be expressed as second derivatives with respect to the twisted boundary conditions ( see table i ) , which play a crucial role in the formalism . as discussed in section [ insensitive_bc ] , _ bulk properties _ of insulators are rather insensitive to the boundary conditions , unlike the properties of conductors . nevertheless , the insulating _ wavefunction",
    "_ itself is not insensitive to the boundary conditions@xcite ; on the contrary , the derivatives of @xmath143 , which measure the @xmath20-averaged change with @xmath20 in @xmath365 as the boundary condition on @xmath129 is twisted , contain quantitative information about basic properties of the insulator : in particular , the first derivative gives the average macroscopic polarization , and the second derivative gives its mean - square fluctuation .",
    "both quantities have a geometrical interpretation : the former is a berry phase on a manifold of quantum states parametrized by the twisted boundary conditions@xcite ( eq . [ first_cumulant ] ) , and the latter is a metric on the same manifold ( eq . [ second_cumulant_c ] ) .",
    "the generating function approach also leads naturally to discretized formulas which can be used to compute the polarization and the localization in many - body numerical calculations in any number of dimensions .",
    "two alternative kinds of expressions exist : those involving wavefunctions computed on a uniform grid of @xmath20-points ( eqs .",
    "[ polarization_discrete ] , [ variance_scaled ] , and [ covariance_scaled ] ) , and those involving a single wavefunction with a fixed boundary condition @xmath330 ( eqs . [ polarization_single_pt ] , [ variance_single_pt_b ] , and [ covariance_single_pt ] ) . the present derivation clearly shows how the two types of formulas are related to one another .",
    "we wish to thank david vanderbilt for illuminating comments and suggestions for improvement on an early draft of the paper ; yu .",
    "kagan , jos lus martins , nicola marzari , daniel snchez - portal , and john shumway for stimulating discussions ; j. l. m. for bringing to our attention ref .",
    "@xcite , gerardo ortiz for refs . @xcite and @xcite , and michael stone for ref .",
    "this work was supported by the doe grant no .",
    "defg02 - 96-er45439 and the nsf grant no .",
    "i.s . acknowledges financial support from fct ( portugal ) .",
    "in section [ loc_config_space ] it was shown that the width of the electronic center of mass distribution @xmath274 , arising from the maximally - localized `` many - body wannier function '' @xmath6 , is @xmath366 . in this appendix",
    "we work in the independent - electron framework , in which the usual one - electron wannier functions are defined , and investigate the relation between their width and the localization length @xmath1 ( i.e. , the mean - square fluctuation of the polarization ) .",
    "it is clear that since the spread ( eq . [ omega ] ) is gauge - dependent , it can not relate directly to any measurable quantity .",
    "one might have guessed that , as happens with the `` many - body wannier functions '' , the physically meaningful quantity would be the spread of the maximally - localized wannier functions .",
    "building upon the results of ref .",
    "@xcite , we show here that the gauge - invariant part @xmath65 of the spread of the occupied wannier functions ( eq . [ omega_i ] ) measures the mean - square fluctuation of the bulk polarization .",
    "the proof follows from the fluctuation - dissipation theorem : for a crystalline insulator in the independent - electron approximation , the real part of the optical conductivity due to interband vertical transitions is given by@xcite    @xmath367    where @xmath368 is the occupation number of states in the valence band ( in spin - degenerate systems @xmath369 ) , @xmath370 , and @xmath371 is the difference between single - particle energies . instead of eq .",
    "[ commutation ] we now have @xmath372 , and following similar steps as in section [ fdt ] for the many - body case we find , using eq .",
    "[ metric ] ,    @xmath373    combining with eqs .",
    "[ omega_i ] and [ fdt_bulk ] , using @xmath374 , and taking the trace , we obtain the fluctuation - dissipation relation@xcite :    @xmath375    comparison with eq .",
    "[ loc_length ] shows that @xmath376 , which is the multidimensional generalization of a result obtained in ref .",
    "it has been found that typically @xmath65 accounts for most of the spread @xmath64 ; for instance , in semiconductors it usually accounts for more than 90%@xcite .",
    "thus it is justifiable to view @xmath1 as an estimate of the average width along the @xmath2-th direction of the occupied wannier functions ( in 1d @xmath5 is actually the average spread of the maximally - localized ones@xcite ) .",
    "this conclusion agrees with the analysis in appendix 1 of ref .",
    "@xcite : there , the distribution @xmath276 of the electronic center of mass of a 1d non - interacting insulating system was studied , with the result that @xmath377 is localized in an interval of width @xmath378 , where `` @xmath379 is a length of the order of the range of the wannier function '' .",
    "it is clear from the results of section [ loc_config_space ] and the previous discussion that the gauge - invariant @xmath80 is precisely that length @xmath379 .",
    "it is straightforward to check that for non - interacting crystalline insulators , eq .",
    "[ inequality ] becomes , after summing over all @xmath86 cartesian directions , @xmath380 , where @xmath217 is the minimum direct gap over the brillouin zone .",
    "hence in general the inequality involves the gauge - invariant part of the spread . since in 1d",
    "this equals the average spread of the maximally - localized wannier functions , we recover kivelson s original result@xcite .",
    "in section [ loc_config_space ] we introduced the functions @xmath256 , which play a role in the many - body theory of polarization similar to that of the wannier functions in the independent - electron theory . here",
    "we will show that this formal analogy carries over to considerations about the spread of those functions .",
    "as mentioned in section [ recent_develop ] , in the independent - electron framework the quadratic spread @xmath64 of the occupied wannier functions can be decomposed into a sum of two positive terms , one of them ( @xmath65 ) gauge - invariant@xcite ; hence @xmath381 in any gauge .",
    "following similar steps as in ref .",
    "@xcite , here we will derive the corresponding result for the many - body functions @xmath256 .",
    "first we define their gauge - dependent spread by analogy with eq .",
    "[ omega ] :    @xmath382    where @xmath263 is given by eq .",
    "[ mgf_wf ] .",
    "next we show that the role of @xmath65 is played by @xmath383 : taking this derivative inside the integral in eq .",
    "[ bulk_m ] , discretizing that integral@xcite , and comparing with eq .",
    "[ mgf_wf ] , this becomes    @xmath384    now we use the relation    @xmath385    which is the many - body analogue of eq . 5 of ref .",
    "@xcite and can be derived in the same way . substituting into eq .",
    "[ omega_i_many_body_b ] gives    @xmath386    and comparison with eq .",
    "[ omega_many_body ] yields the desired result : @xmath387 .",
    "there is , however , an important difference with respect to the single - electron wannier functions : in ref . @xcite it was shown that it is only in 1d that the maximally - localized one - electron wannier functions have a spread @xmath388=\\omega_{\\rm i}$ ] , whereas in higher dimensions @xmath388",
    "\\omega_{\\rm i}$ ] , i.e. , @xmath65 is strictly a lower bound to @xmath64 . as discussed in section [ loc_config_space ] , according to kohn@xcite a gauge can be chosen where the functions @xmath256 have an exponentially small overlap with one another in the high - dimensional configuration space , in which case only the term @xmath389 survives in the sum on the r.h.s . of eq .",
    "[ omega_i_many_body_c ] . therefore we conclude that for an insulator in any number of dimensions we have @xmath390 \\doteq \\left < { \\delta { \\bf x}}^2 \\right>$ ] , where for any finite size the corrections due to the exponentially small overlaps make the l.h.s",
    ". slightly larger than the r.h.s .",
    "thus kohn s functions @xmath6 are the maximally - localized `` many - body wannier functions '' @xmath256 , since as @xmath58 the width @xmath391 of the gauge - invariant distribution @xmath122 obtained from @xmath6 ( eq . [ p_x_bulk ] ) becomes the minimum of the width @xmath392 of the gauge - dependent distribution @xmath264 obtained from @xmath256 ( eq . [ p_w ] ) .",
    "here we will discuss the quantum of polarization@xcite in terms of kohn s theory of localization@xcite [ a related discussion , regarding the closely related phenomenom of quantized charge transport in insulators , can be found in ref .",
    "] let us consider a periodic system of volume @xmath393 , which for simplicity we take to be cubic .",
    "if the external potential acting on the electrons is changed adiabatically along an insulating closed path parametrized by @xmath11 @xmath394 , then , since the hamiltonian comes back to itself , the net effect , as far as the wavefunction is concerned , has to be either ( i ) each @xmath6 returns to itself ( modulo a global phase , the same for all @xmath395 ) , or ( ii ) apart from a global phase , there is a rigid translation of all the @xmath6 in configuration space by the same amount , which can be described by a uniform shift of their indices : @xmath396 .",
    "as far as charge transport is concerned , the important observation is that , since the system remains insulating throughout the path , the regions @xmath7 remain disconnected , so that no charge can flow between them during the adiabatic motion .",
    "the resulting integrated current flowing through the system during the cycle ( which , according to eqs .",
    "[ delta_p ] and [ current1 ] , measures the change in polarization ) can then be inferred from figs . 2 and 3 , which show that the regions @xmath7 are labelled by the center of mass of the electrons , and that one can go from one region to the next by moving any one electron across the length @xmath74 of periodic the system .",
    "the smallest non - zero change in the average polarization along the @xmath2-th direction is given by the smallest non - zero shift in the distribution @xmath274 ( @xmath397 ) , and is seen to equal @xmath398 , which is the quantum@xcite .",
    "it should be noted that strictly speaking the exact quantization of charge transport for an insulating system with periodic boundary conditons only occurs in the thermodynamic limit@xcite .",
    "in fact , the quantization was established for a finite size only after averaging over all twisted boundary conditions ; for a finite size and periodic boundary conditions , there are exponentially small corrections@xcite .",
    "this is consistent with kohn s picture that for any finite @xmath17 the regions @xmath7 are not completely disconnected but have an exponentially small overlap , which allows for a correspondingly small charge flow between neighboring regions , thus destroying the exact quantization .",
    "the formulas given in the text need to be generalized in order to deal with correlated systems which have in the ground state a non - integer number of electrons per primitive cell , and yet are insulating .",
    "this can happen in many 1d models@xcite , but it appears that in higher dimensions the mott transition to an insulating state is usually accompanied by a breaking of the symmetry ( e.g. , a charge - density wave ) which restores integer filling@xcite",
    ". therefore we shall restrict the ensuing analysis to 1d , as done in refs .",
    "@xcite .",
    "aligia@xcite has shown that in cases where there is a fractional number of electrons per primitive cell , the limits of integration over @xmath399 in the berry phase formula for the polarization difference ( eq . [ delta_p_om94 ] ) given in ref .",
    "@xcite need to be modified , from which it follows that the `` single - point '' formulas for the polarization and localization derived in refs .",
    "@xcite also need to be changed .",
    "for the purposes of the present paper it is straightforward to modify the integral over @xmath399 in the definition of @xmath400 , and from that derive the required modifications to the discretized numerical formulas .",
    "let us consider a 1d system with a simulation cell of size @xmath74 and @xmath401 electrons per unit cell , where @xmath401 is an irreducible fraction .",
    "following ref .",
    "@xcite , we modify the cumulant generating function , eq . [ bulk_m ] , as follows :      in order to obtain the discretized formulas , we just need to retrace the steps taken in sections [ discrete_avg ] and [ discrete_fix ] , with the above modification . discretizing the interval @xmath403 into a uniform row of @xmath311 points @xmath404",
    ", we find that eq .",
    "[ polarization_discrete ] changes to          as for the modified `` single - point '' formulas@xcite , it is straightforward to verify , applying the approach of section [ discrete_fix ] to the previous two equations , that they are the same as eqs .",
    "[ avg_dscrt_sngl_pt ] and [ variance_sngl_pt ] , except for the substitution @xmath407 .",
    "r. resta , _ berry phases in electronic wavefunctions _ , trosime cycle lecture notes ( cole polytechnique fdrale , lausanne , switzerland , 1996 ) ; also available online at http://ale2ts.ts.infn.it:6163/@xmath408resta/publ/notes_trois.ps.gz",
    "such an interpretation assumes that there exists a centrosymmetric structure which is connected to the structure of interest by an insulating path in @xmath11-space , and that a vanishing bulk polarization can be assigned to the centrosymmetric structure , on the basis of symmetry .",
    "see also p. l. silvestrelli , n. marzari , d. vanderbilt , and m. parrinello , solid state commun . *",
    "107 * , 7 ( 1998 ) , where a similar functional was proposed in an independent - electron framework as a measure of the spread of the wannier functions .",
    "we will distinguish between two somewhat different usages of the notation @xmath53 : @xmath151 denotes the average of the _ distribution _",
    "@xmath122 , whereas @xmath409 denotes the quantum expectation value of the _ operator _ @xmath106 .    the second form of eq . [ precursor_mgf ] will be the most useful in what follows .",
    "we note that it is the many - body analogue of a quantity introduced in the single - particle context in ref . @xcite",
    "25 of ref .",
    "@xcite ] .    the first moment ( average bulk polarization ) is actually somewhat special in this respect , since even the correct expression is gauge - invariant only modulo a quantum , as discussed in section [ recent_develop ] .",
    "hence what is meant here by lack of gauge - invariance is gauge - dependence apart from the quantum .              for a finite @xmath17",
    "the levels of any system are discrete , and therefore absorption becomes impossible as soon as @xmath410 becomes less than the energy spacing between the levels of the system@xcite , so that the fluctuations are in general finite even for a conductor , at any given @xmath20 .",
    "it is also clear that the crossing of low - lying levels at a finite number of @xmath20-points in a conductor at finite @xmath17@xcite does not affect our conclusion regarding the divergence of eq .",
    "[ fdt_bulk ] as @xmath58 .",
    "according to eq .",
    "[ phi_wf ] @xmath412 .",
    "since @xmath73 is gauge - invariant apart from a global phase , if the @xmath256 were non - overlapping , they would also have to be gauge - invariant , apart from the same global phase .    in appendix 1 of ref .",
    "@xcite a definition for the center - of - mass distribution of a periodic system was proposed , which amounts to replacing the @xmath201-function in eq .",
    "[ x_dist ] by a suitably defined `` periodic @xmath201-function '' . for a 1d insulator",
    "such definition yields the same distribution ( for large @xmath74 ) as the characteristic function @xmath413",
    ". however , it does not give an individual peak , since the resulting distribution is periodic by construction ; as a consequence , in 3d it yields a delocalized center of mass even for insulators , because the contributions from different @xmath6 overlap with one another ( this is the `` strange situation '' alluded to in appendix 1 of ref .",
    "@xcite ) ; our definition in terms of the characteristic function , on the other hand , generates one localized distribution @xmath122 from each @xmath6 separately ( see overlapping dotted curves in fig .",
    "3 ) , which retains the desired physical interpretation in any number of dimensions .    notice that eq .",
    "[ first_moment_scaled ] can be rewritten without the logarithm : @xmath414 . however , if we discretize the derivative in the integrand in the straightforward way , the resulting expression will no longer be gauge - invariant .          here",
    "all the filled bands are being treated as a _ composite band _ ( in the terminology of ref .",
    "@xcite ) , to which corresponds a single @xmath65 ; in general different @xmath65 s can be ascribed to each separate group of composite bands@xcite , but then the connection to the polarization fluctuations , which involve all the valence electrons , appears to be lost .    in ref .",
    "@xcite the wannier functions were obtained as the eigenfunctions of the position operator projected into a given band . as shown in ref .",
    "@xcite , in 1d this choice minimizes the quadratic spread .",
    "notice also that kivelson considered disordered insulators ; in that case @xmath217 is the absolute gap .",
    "figure 1 : schematic representation of the regions @xmath228 in the many - electron configuration space where the wavefunction of a finite system obeying periodic boundary conditions is localized .",
    "the system has linear dimensions @xmath223 , and the periodic boundary conditions are over a length @xmath416 , so that the regions @xmath228 are essentially non - overlapping .",
    "+   + figure 2 : schematic representation of the essentially disconnected regions @xmath7 in the many - electron configuration space where the wavefunction of an extended insulator is localized ( adapted from ref .",
    "@xcite ) . for @xmath86 real - space dimensions @xmath417 .",
    "shown is the case of two electrons and @xmath418 , for which the configuration space is @xmath419 .",
    "the system is composed of possibly strongly overlapping units in real space ( e.g. , a covalent insulator ) and yet , because it is insulating , in configuration space the wavefunction @xmath37 breaks up into a sum of partial functions @xmath6 , each localized in a region @xmath7 , which have an exponentially small overlap with one another , if the system is large .",
    "+   + figure 3 : localized distribution @xmath274 along the @xmath2-th direction of @xmath4 times the electronic center of mass ( @xmath420 ) for a @xmath86-dimensional insulator with @xmath4 electrons in a periodic volume @xmath421 ( based on fig .",
    "although each individual electron coordinate @xmath422 , as well as the electronic charge density ( not shown ) , are spread over the whole system , because the system is insulating a localized distribution @xmath274 of width @xmath366 can be uniquely defined in terms of the partial wavefunction @xmath6 in a _ single _",
    "disconnected region @xmath7 in the @xmath423-dimensional configuration space ( fig .",
    "2 ) . choosing a different region @xmath424 simply shifts the center of the distribution , if @xmath425 .",
    "the solid lines correspond to @xmath418 , for which the peaks coming from different @xmath7 do not overlap with one another for large @xmath74 , whereas for @xmath426 ( dotted lines ) they overlap strongly ( but the regions @xmath7 are still essentially disconnected , for large @xmath74 . ) +   +   +    .comparison between the formulas for the drude weight and for the localization length , their relation to the optical conductivity , and their asymptotic values in the thermodynamic limit for insulators and conductors at @xmath197 . [",
    "cols=\"^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> we develop the theory and practical expressions for the full quantum - mechanical distribution of the intrinsic macroscopic polarization of an insulator in terms of the ground state wavefunction . </S>",
    "<S> the central quantity is a cumulant generating function which yields , upon successive differentiation , all the cumulants and moments of the probability distribution of the center of mass @xmath0 of the electrons , defined appropriately to remain valid for extended systems obeying twisted boundary conditions . </S>",
    "<S> the first moment is the average polarization , where we recover the well - known berry phase expression . </S>",
    "<S> the second cumulant gives the mean - square fluctuation of the polarization , which defines an electronic localization length @xmath1 along each direction @xmath2 : @xmath3 . </S>",
    "<S> it follows from the fluctuation - dissipation theorem that in the thermodynamic limit @xmath1 diverges for metals and is a finite , measurable quantity for insulators . </S>",
    "<S> it is possible to define for insulators maximally - localized `` many - body wannier functions '' , which for large @xmath4 become localized in disconnected regions of the high - dimensional configuration space , establishing a direct connection with kohn s theory of the insulating state . </S>",
    "<S> interestingly , the expression for @xmath5 , which involves the second derivative of the wavefunction with respect to the boundary conditions , is directly analogous to kohn s formula for the `` drude weight '' as the second derivative of the energy . </S>"
  ]
}