{
  "article_text": [
    "quantum cryptography , also called quantum key distribution ( qkd ) , allows two remote parties , usually called alice and bob , to establish a secret key that can be used to transmit secret message with a classical one - time pad scheme .",
    "after the pioneering work presented by bennett and brassard in 1984 ( bb84 ) , the unconditional security of the bb84 protocol was proven with the assumption of ideal settings @xcite . in practice ,",
    "the devices of qkd are imperfect , the eavesdropper , called eve , can exploit the imperfections of the devices to gain partial or full information about the key bits @xcite . it has been shown that eve may take advantage of the nonzero multiphoton emission probability of alice s laser source and the loss of quantum channel , by using the photon - number - splitting ( pns ) attack @xcite .",
    "decoy state qkd has been proposed to beat eve s pns attacks , which can substantially increase the secure key distribution distance @xcite .",
    "an important part of qkd system is the measurement devices . in experiments ,",
    "the detection efficiency of the practical single - photon detectors ( spds ) is low and in most cases , the two detectors are asymmetric , which may be exploited by the eve to steal information on the final key .",
    "for example , attacks that exploit the efficiency mismatch between two spds in qkd system have been proposed , demonstrated , and analyzed ; they include the time - shift attack  @xcite , and the faked states attack  @xcite .",
    "also , it has been demonstrated experimentally that eve can tracelessly acquire the full secret key bits using specially tailored bright illumination @xcite .",
    "recently , a measurement - device - independent ( mdi ) qkd scheme was proposed to remove detector side channel attacks @xcite .",
    "the advantage is that security can be guaranteed without regard to the experimental details of the measurement device . in this scheme ,",
    "alice and bob send signal pulses to a bell - state measurement device which may be owned by eve and it is proven that they can distill some secure key bits based on the bell measurement results .",
    "recently , the security of four - state deterministic quantum key distribution ( dqkd ) with a two - way quantum channel against the most general attacks has been proven by us @xcite under the ideal - device setting , while it is widely believed that two - way dqkd is vulnerable under eve s practical attacks because eve can attack the travel photon in both forward and backward lines . in this paper , we prove that two variations of the dqkd protocol are immune to all detector side channel attacks at bob s side in the backward line .",
    "we do not analyze the mdi security of alice s detectors and assume that they are ideal and non - blinded .",
    "in most qkd protocols , after distributing all signal qubits , alice and bob should communicate through public channel for basis reconciliation . in the bb84 protocol , about half of bob s",
    "measurement results are discarded due to the inconsistent bases alice and bob used .",
    "but , in two - way dqkd protocols @xcite , bob can decode alice s key bits after measuring the returned qubits directly , without basis reconciliation .",
    "this means that all measurement results will be used for key distillation .",
    "the two - way dqkd was first proposed by using entanglement @xcite .",
    "later , single - photon two - state protocol @xcite was proposed for improving the experimental performance and then single - photon four - state protocol was proposed independently in refs .",
    "@xcite . after that",
    ", the security of two - way dqkd against some special attacks were studied @xcite .",
    "recently , the security of the four - state protocol against the most general attacks under the ideal - device setting was proved by us @xcite .",
    "let us start with a brief review of the four - state two - way dqkd protocol with two encoding operations [ see fig .  [",
    "fig : protocols](a ) ] .",
    "( 1 ) bob prepares @xmath0 qubits randomly in one of the four states , @xmath1 , @xmath2 , @xmath3 , and @xmath4 , where @xmath5 and sends them to alice . ( 2 ) alice randomly switches the communication to the check mode or the encoding mode .",
    "( 3 ) in check mode , alice randomly measures part of the received states in the @xmath6 basis or @xmath7 basis .",
    "( 4 ) in the encoding mode , alice randomly perform unitary operations @xmath8 to encode bit 0 or @xmath9 to encode bit 1 . ( 5 ) alice sends the encoded qubits back to bob . since alice s encoding operations do not change the bases of bob s states , _",
    "i.e. _ , @xmath10 and @xmath11 , bob measures each qubit in the same basis as the one he used for preparation to get alice s key bit deterministically , without basis reconciliation .",
    "( 6 ) after bob measured all returned qubits , alice announces her measurement results in the check mode to compute the fidelity of the forward states in the b - to - a channel for the consistent - basis measurements .",
    "they can get the fidelity @xmath12 , @xmath13 , @xmath14 , and @xmath15 of @xmath1 , @xmath2 , @xmath3 , and @xmath16 , respectively .",
    "( 7 ) alice announces part of her key bits in encoding mode to compute the error - rate @xmath17 in the a - to - b channel .",
    "( 8) alice and bob perform error - correction ( ec ) and privacy amplification ( pa ) to generate the final key bits . in the asymptotic scenario , after verifying @xmath18 , alice and bob can get the secure final key against general attacks with the generation rate , @xmath19 where @xmath20 is the binary entropy function , and @xmath21 and @xmath22 are the amounts of key bits alice and bob should sacrifice for ec and pa .    with the idea of delaying pa ,",
    "the security of a two - way dqkd protocol that uses four states and four encoding operations was proven @xcite [ see fig .",
    "[ fig : protocols](b ) ] .",
    "it has been shown that the idea of delaying pa can simplify the security proof of two - way dqkd protocols , with the same key generation rate as that derived in @xcite .",
    "the security of two - way dqkd can also be proved against most general attacks with the entropic uncertainty relation , and a higher final key generation rate may be achieved @xcite .",
    "we prove that the four - state dqkd protocols with two encoding operations ( a ) and four encoding operations ( b ) are mdi secure in line a - to - b .",
    "protocol ( b ) was shown to be equivalent to protocol ( c ) where the forward channel runs the bb84 protocol and the backward channel runs a classical one - time pad ( otp )  @xcite . here ,",
    "@xmath23 , @xmath24 , and @xmath25 represent a raw secret key bit in all three protocols randomly chosen by alice . in protocol ( b )",
    ", either @xmath24 or @xmath25 will be used as the key bit depending on the basis chosen by bob which he will inform alice after his measurement . here , @xmath26 represents eigenstate @xmath27 of basis @xmath28 and @xmath29 represents a measurement in basis @xmath28 .",
    ", width=480 ]",
    "we prove in this section the mdi security of line a - to - b for the original four - state protocol with two encoding operations proposed by refs .",
    "@xcite , and the four - state protocol with four encoding operations proposed by ref .",
    "our proof relies on the use of equivalent protocols .      in order to prove the security of the mdi version of the protocol in line a - to - b",
    ", we modify the protocol by moving bob s measurement to the hands of eve in line a - to - b .",
    "the modified protocol is the same as the original protocol in sec .",
    "[ sec - security of the four - state protocol ] except with step ( 5 ) replaced as follows : ( 5 ) alice sends the encoded qubit to eve .",
    "bob tells eve the measurement basis .",
    "eve makes a measurement on alice s qubit using bob s basis , and returns the measurement result to bob .",
    "note that bob tells eve the basis only after the alice has received the qubit on line b - to - a .",
    "this ensures that eve can not determine the initial qubit bob sent out .",
    "intuitively , we can understand the security of the modified protocol as follows .",
    "since bob randomly prepares the signal qubit in one of the four states , eve can not know alice s encoding operations even if she gets bob s measurement result . to know alice s encoding",
    ", eve has to know bob s initial state as well .    to prove security of the modified protocol rigorously , we consider the pa term in the key rate formula .",
    "the secure key rate @xmath30 from pa for secret key generation is given by renner and knig s result  @xcite : @xmath31 , where @xmath32 is the overall state of alice s encoding ( @xmath33 ) , the qubit emitted to line b - to - a ( @xmath34 ) , and eve s ancillas ( @xmath35 ) , and @xmath36 .",
    "note that system @xmath34 is released by bob , encoded by alice , and returned to eve .",
    "this pa formula reflects that eve , in order to learn about the key bit , uses the entire qubit from alice and her own ancillas which include those used in her attack on line b - to - a .",
    "this is consistent with the modified protocol where eve measures @xmath37 .",
    "we now show that @xmath38 , i.e. , the overall state is not changed due to the knowledge of the basis .",
    "bob initially prepares the qubit @xmath39 in one of the four states .",
    "when the basis is @xmath40 or @xmath41 , bob prepares @xmath42 or @xmath43 , respectively . since @xmath44 , further evolution of this state will be independent of the basis .",
    "thus , @xmath45 for completeness , we describe @xmath32 in more detailed as follows .",
    "eve s most general attack on b - to - a channel can be described as a joint unitary operation together with ancilla . after eve s attack on b - to - a channel ,",
    "the joint state of the forward qubit and eve s ancilla becomes @xmath46 , where @xmath47 is the initial state of eve s ancilla .",
    "after alice s encoding operations , the joint state of backward qubit and eve s ancilla becomes @xmath48 , where @xmath49 and @xmath50 .",
    "therefore , eq .   reduces @xmath30 to @xmath51 for the modified protocol ; and also @xmath32 in the modified protocol is the same as in the original protocol because @xmath39 undergoes the same evolution in both protocols .",
    "therefore , we can directly apply the calculation of @xmath30 of the original protocol and its result to the modified protocol here . in summary ,",
    "the modified protocol has the same key rate formula eq .  .",
    "the four - state protocol is secure independent of the measurement and is immune against all detector side channel attacks in line a - to - b .",
    ".key bit value dependence on the basis used by bob ( @xmath41 or @xmath40 ) and alice s encoding operation ( @xmath52 , @xmath6 , @xmath53 , or @xmath7 ) .",
    "for instance , when bob uses basis @xmath41 , bit @xmath54 is encoded by alice if she applies @xmath7 or @xmath53 on the qubit emitted by bob .",
    "[ table - encoded - value ] [ cols=\"^,^,^ \" , ]      here , we also show the mdi security in line a - to - b of the four - state protocol with four encoding operations of ref .",
    "@xcite [ see fig .",
    "[ fig : protocols](b ) ] . in this protocol , the steps are the same as the protocol given in sec .  [ sec - security of the four - state protocol ] except with steps ( 4 ) and ( 5 ) replaced as follows : ( 4 ) in the encoding mode , alice randomly perform unitary operations @xmath8 , @xmath55 , @xmath56 , or @xmath57 .",
    "the actual key bit value is dependent on the basis used ( table  [ table - encoded - value ] ) .",
    "( 5 ) alice sends the encoded qubits back to bob .",
    "bob measures each qubit in the same basis as the one he used for preparation to get alice s key bit deterministically , without basis reconciliation .",
    "bob also tells alice his basis choice so that she knows the key bit value according to table  [ table - encoded - value ] .    we show that this protocol is mdi secure in line a - to - b .",
    "the security proof of this protocol given in ref .",
    "@xcite reduces the protocol to an equivalent protocol where the forward channel b - to - a runs the bb84 protocol and the backward channel a - to - b runs a classical one - time pad ( otp ) [ see fig .",
    "[ fig : protocols](c ) and fig .  3 of ref .",
    "it is argued in ref .",
    "@xcite that the classical otp is equivalent to a quantum otp by encoding classical states onto quantum states in some basis .",
    "the basis used has no bearing on the security since the security originates from that of the classical otp : eve is allowed to know the otp - encrypted bit value in transit on line a - to - b .",
    "it is argued further in ref .",
    "@xcite that this basis is the basis used by bob for his initial state .",
    "thus , it is irrelevant whether bob announces the basis before or after the otp operation on line a - to - b . using the same modification in sec .",
    "[ sec - proof - mdi1 ] for moving the measurement device from bob to eve , this variant of the four - state protocol is mdi secure in line a - to - b .",
    "although the two - way dqkd has higher resistance to pns attack - like attacks @xcite , decoy states are necessary to modify the four - state protocol for long - distance key distribution @xcite .",
    "another problem is that the two - way qkd is vulnerable to eve s trojan horse attacks , such as the invisible photon attack @xcite . in practice",
    ", alice can add a filter to defeat eve s invisible photon attack .",
    "all bob s photon pulses should pass through alice s filter first and only wavelengths close to the operating wavelength are allowed to pass through .",
    "it has been widely believed that , since eve can attack the travel photons both in line b - to - a and in line a - to - b , qkd with a two - way quantum channel is more vulnerable under eve s practical attacks comparing with one - way qkd protocol , such as the bb84 protocol . in this paper , we have shown that two four - state protocols are mdi secure in line a - to - b , i.e. , when eve instead of bob measures alice s qubit using bob s basis , the modified protocols have the same key generation rate as that of the original protocols . since the line a - to - b is mdi secure , measurement device dependent attacks may only work in line b - to - a .",
    "finally , we want to emphasize that we only proved the security of two - way dqkd against detector side channel attacks at bob s side in the backward line a - to - b , while the mdi security of alice s detectors in the check mode should be studied in future work .",
    "financial support from nsfc under grant nos .",
    "11104324 and 11074283 of the prc government and rgc under grant 700712p of the hksar government is gratefully acknowledged .",
    "secondoftwoauthor secondoftwoauthor c .- h .",
    "f. fung , secondoftwoauthor k.  tamaki , secondoftwoauthor b.  qi , secondoftwoauthor h .- k .",
    "lo ,  and  secondoftwoauthor x.  ma ,   secondoftwojournal secondoftwojournal quant .",
    "comput . ,  *",
    "* secondoftwovolume 9 * * ,  secondoftwopages 0131 ( secondoftwoyear 2009 ) v. makarvo , a. anisimov , and j. skaar , phys .",
    "a * 74 * , 022313 ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> in a two - way deterministic quantum key distribution ( dqkd ) protocol , bob randomly prepares qubits in one of four states and sends them to alice . to encode a bit </S>",
    "<S> , alice performs an operation on each received qubit and returns it to bob . </S>",
    "<S> bob then measures the backward qubits to learn about alice s operations and hence the key bits . </S>",
    "<S> recently , we proved the unconditional security of the final key of this protocol in the ideal device setting . in this paper , we prove that two - way dqkd protocols are immune to all detector side channel attacks at bob s side , while we assume ideal detectors at alice s side for error testing . </S>",
    "<S> our result represents a step forward in making dqkd protocols secure against general detector side channel attacks . </S>"
  ]
}