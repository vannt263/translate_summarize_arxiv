{
  "article_text": [
    "metabolic reactions enable cellular function by converting nutrients into energy and by assembling macromolecules that sustain the cellular machinery  @xcite .",
    "cellular metabolism is usually thought of as a collection of pathways comprising enzymatic reactions associated with broad functional categories . yet",
    "metabolic reactions are highly interconnected : enzymes convert multiple reactants into products with other metabolites acting as co - factors ; enzymes can catalyse several reactions , whereas some reactions are catalysed by multiple enzymes , and so on .",
    "this enmeshed web of reactions is thus naturally amenable to network analysis , an approach that has been successfully applied to different aspects of cellular and molecular biology , e.g. , protein - protein interactions  @xcite , transcriptional regulation  @xcite , or protein structure  @xcite .",
    "tools from network theory  @xcite have previously been applied to the analysis of structural properties of metabolic networks , including their degree distribution  @xcite , the presence of metabolic roles  @xcite , and their community structure  @xcite . a central challenge",
    ", however , is that there are multiple ways to construct a ( mathematical ) graph from a metabolic network  @xcite .",
    "for example , one can create a graph with metabolites as nodes and edges representing the reactions that transform one metabolite into another  @xcite ; a graph with reactions as nodes and edges corresponding to the metabolites shared among them  @xcite ; or even a bipartite graph with both reactions and metabolites as nodes  @xcite .",
    "importantly , the conclusions of graph - theoretical analyses are highly dependent on the chosen graph construction  @xcite .",
    "a key feature of metabolic reactions is the directionality of flux : metabolic networks contain both irreversible and reversible reactions , and reversible reactions can change their direction depending on the cellular and environmental contexts  @xcite .",
    "many of the existing graph constructions , however , lead to undirected graphs that disregard such directional information , which is central to metabolic function  @xcite .",
    "furthermore , current graph constructions are usually derived from the whole set of metabolic reactions in an organism , and thus correspond to a generic metabolic ` blueprint ' of the cell .",
    "however , cells switch specific pathways on and off to sustain their energetic budget in different environments  @xcite .",
    "hence , such blueprint graphs might not capture the specific metabolic connectivity in a given environment , thus limiting their ability to provide biological insights in different growth conditions .    in this paper",
    ", we present a flux - based approach to construct metabolic graphs that encapsulate the directional flow of metabolites produced or consumed through enzymatic reactions .",
    "the proposed graphs can be tailored to incorporate flux distributions under different environmental conditions . to introduce our approach",
    ", we proceed in two steps .",
    "we first define the _ probabilistic flux graph _ ( pfg ) , a weighted , directed graph with reactions as nodes , edges that represent supplier - consumer relationships between reactions , and weights given by the probability that a metabolite chosen at random is produced / consumed by the source / target reaction .",
    "this graph can be used to carry out graph - theoretical analyses of metabolic organisation independent of cellular context or environmental conditions .",
    "we then show that this formalism can be adapted seamlessly to construct the _ metabolic flux graph _ ( mfg ) , a directed , environment - dependent , graph with weights computed from flux balance analysis ( fba )  @xcite , the most widespread method to study genome - scale metabolic networks .",
    "our formulation overcomes several drawbacks of current constructions of metabolic graphs .",
    "firstly , in our flux graphs , an edge indicates that metabolites are produced by the source reaction and consumed by the target reaction , thus accounting for metabolic directionality and the natural flow of chemical mass from reactants to products .",
    "secondly , the probabilistic flux graph discounts naturally the over - representation of pool metabolites ( e.g. , adenosine triphosphate ( atp ) , nicotinamide adenine dinucleotide ( nadh ) , protons , water , and other co - factors ) that appear in many reactions and tend to obfuscate the graph connectivity .",
    "our construction avoids the removal of pool metabolites from the network , which can change the graph structure drastically  @xcite .",
    "finally , the metabolic flux graph incorporates additional biological information reflecting the effect of the environmental context into the graph construction .",
    "in particular , since the weights in the mfg correspond directly to fluxes ( in units of mass per time ) , different biological scenarios can be analysed using fluxes from different fba solutions under different carbon sources and other environmental perturbations  @xcite .    after introducing the mathematical framework , we showcase our approach on the core model of _ escherichia coli _",
    "metabolism  @xcite . in absence of environmental context",
    ", our analysis of the pfg reveals the importance of including directionality and appropriate edge weights in the graph to understand the modular organisation of metabolic sub - systems .",
    "we then use fba solutions for several relevant growth conditions , and show that the structure of the mfg changes dramatically in each case , thus capturing the environment - dependent nature of metabolism .",
    "consider a metabolic network composed of @xmath0 metabolites with concentrations @xmath1 ( @xmath2 ) that participate in @xmath3 reactions @xmath4 [ ] } \\sum_{i=1}^n      \\beta_{ij } x_i}\\label{eq : reac},\\quad j=1,2,\\ldots , m,\\ ] ] where @xmath5 and @xmath6 are the stoichiometric coefficients of species @xmath7 in reaction @xmath8 .",
    "each reaction takes place at a time - dependent rate @xmath9 , measured in units of concentration per time  @xcite .",
    "the dynamics of the metabolite concentrations is represented compactly by the system of differential equations @xmath10 where @xmath11 is the @xmath0-dimensional vector of metabolite concentrations , and @xmath12 is the @xmath3-dimensional vector of reaction rates .",
    "the @xmath13 matrix @xmath14 is the stoichiometric matrix with entries @xmath15 , i.e. , the net number of @xmath16 molecules produced ( positive @xmath17 ) or consumed ( negative @xmath17 ) by the @xmath8-th reaction . to illustrate the different schemes and graphs described in this paper",
    ", we use a toy example  @xcite of a metabolic network including nutrient uptake , biosynthesis of metabolic intermediates , secretion of waste products , and biomass production ( figure  [ fig : toymodel_networks]a ) .    .",
    "( b ) bipartite graph associated with the boolean stoichiometric matrix @xmath18 , and the standard reaction adjacency graph ( rag  @xcite ) with adjacency matrix @xmath19 .",
    "the undirected edges of @xmath20 indicate the number of shared metabolites among reactions .",
    "( c ) the probabilistic flux graph ( pfg , @xmath21 ) and two metabolic flux graphs ( mfg , @xmath22 ) are constructed from the unfolded consumption and production stoichiometric matrices  .",
    "note that the reversible reaction @xmath23 is unfolded into two nodes",
    ". the pfg   is a directed graph with weights representing the probability that the source reaction produces a metabolite consumed by the target reaction .",
    "the mfgs   are constructed from two flux balance analysis solutions ( @xmath24 and @xmath25 ) obtained by optimizing a biomass objective function under different flux constraints representing different environmental or cellular contexts ( see sec .  [",
    "sec : toy_model ] for details ) .",
    "the edges of the mfgs represent mass flow from source to target reactions , with weights in units of metabolic flux .",
    "the computed fba solutions translate into different connectivity in the resulting mfgs.,scaledwidth=100.0% ]    starting from the stoichiometry @xmath14 , there are several ways to construct a graph for a given set of metabolic reactions  @xcite .",
    "a common approach  @xcite is to define the _ unipartite graph _ with reactions as nodes and the @xmath26 adjacency matrix @xmath27 where @xmath18 is the boolean version of @xmath14 ( i.e. , @xmath28 when @xmath29 and @xmath30 otherwise ) . in this",
    "_ reaction adjacency graph _ ( rag ) , two reactions ( nodes ) are connected if they share metabolites , either as reactants or products , and self - loops represent the total number of metabolites that participate in a reaction ( fig .",
    "[ fig : toymodel_networks]b ) .",
    "though widely studied  @xcite , the rag has known important limitations , as it overlooks key aspects of the connectivity of metabolic networks . in particular , the rag does not distinguish between forward and backward fluxes , nor does it incorporate information on the irreversibility of reactions ( @xmath31 is a symmetric matrix ) . furthermore , the structure of @xmath31 is dominated by the large number of connections introduced by pool metabolites ( e.g. , water , ions or enzymatic cofactors ) that appear in many reactions . although computational schemes have been designed to ameliorate the pool metabolite bias  @xcite , their justification does not follow from biophysical considerations .",
    "finally , the construction of the graph @xmath31 from rigid topological criteria is not easily extended to incorporate the effect of varying environmental contexts .      to address the limitations of the standard reaction adjacency graph @xmath31 , given in eq .  , and aiming at enhanced biophysical and biological interpretability , we propose a graph formulation that follows from a flux - based perspective . to construct our graph ,",
    "we unfold each reaction into separate forward and reverse directions , and redefine the presence of links between reaction nodes to reflect producer - consumer relationships , i.e. , two reactions are connected if one produces a metabolite that is consumed by the other . as shown below",
    ", this definition leads to graphs that naturally account for the reversibility of reactions and allows for a seamless integration of different biological contexts modelled through fba .    inspired by matrix formulations of chemical reaction network kinetics  @xcite",
    ", we unfold the reactions into forward and backward components .",
    "specifically , let us rewrite the reaction rate vector introduced in   as : @xmath32 where @xmath33 and @xmath34 are non - negative vectors containing the forward and backward reaction rates , respectively , and @xmath35 is the @xmath3-dimensional reversibility vector with components @xmath36 if reaction @xmath37 is reversible and @xmath38 if it is irreversible .",
    "the @xmath39 matrix @xmath40 contains @xmath35 in its main diagonal . with these definitions , we rewrite the metabolic model in eq .   in terms of the unfolded @xmath41-dimensional vector of reaction rates , @xmath42^t$ ] , to obtain : @xmath43 where @xmath44 is the @xmath39 identity matrix , and @xmath45 is an unfolded version of the stoichiometric matrix corresponding to the @xmath41 forward and reverse reactions .",
    "the unfolding into forward and backward fluxes leads us to the definition of _ production _ and _ consumption _ stoichiometric matrices : @xmath46 where @xmath47 is the matrix whose entries are the absolute values of the corresponding entries of @xmath45 .",
    "note that each entry of the matrix @xmath48 , denoted @xmath49 , gives the number of molecules of metabolite @xmath16 produced by reaction @xmath50 .",
    "conversely , the entries of @xmath51 , denoted @xmath52 , correspond to the number of molecules of metabolite @xmath16 consumed by reaction @xmath50 .    within our directional flux framework ,",
    "it is natural to consider a probabilistic description of producer - consumer relationships between reactions , as follows . given a stoichiometric matrix @xmath14 , and in the absence of further biological information , the probability that metabolite @xmath53 is produced by reaction @xmath54 and consumed by reaction @xmath37 is : @xmath55 where @xmath56 and @xmath57 are the total number of molecules of @xmath53 produced and consumed by all reactions .",
    "we thus define the weight of the edge between reaction nodes @xmath54 and @xmath37 as the probability that _ any _ metabolite chosen at random is produced by @xmath54 and consumed by @xmath37 . summing over all metabolites and normalizing ,",
    "the edge weight is defined as @xmath58 these edge weights are the entries of the adjacency matrix of the @xmath59 where @xmath60 , @xmath61 , @xmath62 is a vector of ones , and @xmath63 denotes the moore - penrose pseudoinverse .",
    "the pfg is a weighted , directed graph with a double - stochastic adjacency matrix ( @xmath64 ) .",
    "it provides a directional blueprint of the whole metabolic model , and naturally scales the contribution of pool metabolites to flux transfer . in figure",
    "[ fig : toymodel_networks]c we illustrate the creation of the pfg for a toy network .",
    "note that our pfg is distinct from a directed graph directly comparable to the rag @xmath65 , and with similar shortcomings , which can be constructed from boolean versions of the production and consumption stoichiometric matrices as shown sec .",
    "[ sec : adir_vs_d_si ] .",
    "we now extend the idea behind the construction of the pfg to account for specific environmental context or growth conditions .",
    "cells adjust their metabolic fluxes to respond to the availability of nutrients and environmental requirements .",
    "flux balance analysis ( fba ) is a widely used method to predict environment - specific flux distributions .",
    "fba computes a vector of metabolic fluxes @xmath66 that maximise a cellular objective ( e.g. , biomass , growth or atp production ) .",
    "the fba solution is obtained assuming steady state conditions and subject to constraints that describe the availability of nutrients and other extracellular compounds  @xcite .",
    "the key basic elements of fba are briefly summarised in section  [ sec : fba ] .    to incorporate the biological information afforded by fba solutions into the structure of a metabolic graph",
    ", we again define the graph edges in terms of production and consumptions fluxes . similarly to eq .",
    ", we unfold the fba solution vector @xmath67 into forward and backward components @xmath68 whence we compute the vector of production and consumption fluxes as @xmath69 the @xmath70-th entry of @xmath71 is the flux at which metabolite @xmath53 is produced and consumed . note that production and consumption fluxes are identical because of the steady state condition ( @xmath72 in eq .  ) .",
    "we now construct the flux graph by defining the weight of the edge between reactions @xmath54 and @xmath37 as the _ total flux of metabolites produced by @xmath54 that are consumed by @xmath37_. assuming that the amount of metabolite produced by one reaction is distributed among the reactions that consume it in proportion to their flux , the flux of metabolite @xmath53 from reaction @xmath54 to @xmath37 is given by @xmath73 for example , if the total flux of metabolite @xmath74 is @xmath75 , with reaction @xmath76 producing @xmath53 at a rate @xmath77 and reaction @xmath37 consuming @xmath74 at a rate @xmath78 , then the flux of @xmath53 from @xmath54 to @xmath37 is @xmath79 .",
    "summing eq .   over all metabolites",
    ", we then obtain the edge weight relating reactions @xmath54 and @xmath37 as @xmath80 the edge weights are collected into the adjacency matrix of the @xmath81 where @xmath82 , @xmath83 and @xmath63 denotes the matrix pseudoinverse .",
    "the mfg is a directed graph with weights in units of @xmath84 .",
    "self loops describe the metabolic flux of autocatalytic reactions , i.e. ,  those in which products are also reactants .",
    "the mfg provides a versatile framework to create environment - specific metabolic graphs from fba solutions . in figure",
    "[ fig : toymodel_networks]c we illustrate the creation of mfgs for a toy network . in each case",
    "we compute fba solutions under a fixed uptake flux and constrain the remaining fluxes to account for different biological scenarios . in scenario 1",
    "the fluxes are constrained to be strictly positive and no larger than the nutrient uptake flux , while in scenario 2 we impose a positive lower bound on reaction @xmath85 .",
    "the graph in scenario 2 displays an extra edge between reactions @xmath23 and @xmath85 and distinct edge weights , as compared to scenario 1 ( see sec .  [",
    "sec : toy_model ] ) .",
    "the results thus illustrate how changes in the fba solutions translate into different graph connectivities and edge weights .",
    ", as given by eq .  .",
    "the nodes represent reactions ; two reactions are linked by an undirected edge if they share reactants or products .",
    "the nodes are coloured according to their pagerank score , a measure of their centrality in the graph .",
    "( c ) the directed probabilistic flux graph @xmath21 , as computed from eq .  .",
    "the reversible reactions are unfolded into two overlapping nodes ( one for the forward reaction , one for the backward ) .",
    "the directed links indicate flow of metabolites produced by the source node and consumed by the target node .",
    "the nodes are coloured according to their pagerank score .",
    "( d ) comparison of pagerank percentiles of reactions in @xmath20 and @xmath21 .",
    "reversible reactions are represented by two triangles connected by a line ; both share the same pagerank in @xmath20 , but each has its own pagerank in @xmath21 .",
    "reactions that appear above ( below ) the diagonal have increased ( decreased ) pagerank in @xmath21 as compared to @xmath20 . ]    to illustrate our framework , we construct and analyse flux graphs ( pfg and mfgs ) of the core metabolic model of _ e. coli",
    "_  @xcite .",
    "this model ( fig .",
    "[ fig : model_a_dnorm]a ) contains 72 metabolites and 95 reactions , grouped into 11 pathways , which describe the main biochemical routes in central carbon metabolism  @xcite .      to highlight the effect of flux directionality on the constructed graphs , figure [ fig : model_a_dnorm ]",
    "compares the standard undirected reaction adjacency graph ( @xmath31 ) and our proposed probabilistic flux graph ( @xmath21 ) for the same metabolic model .",
    "the @xmath31 graph has 95 nodes and 1,158 undirected edges , while the @xmath21 graph has 154 nodes and 1,604 directed and weighted edges . the increase in node count is due to the unfolding of forward and backward reactions into separate nodes . unlike the @xmath20 graph ,",
    "where the edges represent shared metabolites between two reactions , the directed edges of the @xmath21 graph represent the flow of metabolites from a source to a target reaction .",
    "a salient feature of both graphs is their high connectivity , which is not apparent from the traditional pathway representation in figure  [ fig : model_a_dnorm]a .",
    "the impact of directionality becomes apparent when comparing the importance of reaction nodes on the overall connectivity of each graph , as measured by the pagerank score introduced in the original google algorithm  @xcite .",
    "figure  [ fig : model_a_dnorm]b  d shows that the pagerank of reactions is substantially different in @xmath20 and @xmath21 .",
    "the overall ordering is maintained : exchange reactions tend to have low pagerank , whereas core metabolic reactions have high pageranks in both graphs  indeed , the biomass reaction has the highest rank in both cases .",
    "however , we observe a dramatic change in the importance of most reactions .",
    "for example , the reactions for atp maintenance ( atpm ) , phosphoenolpyruvate synthase ( pps ) and abc - mediated transport of l - glutamine ( glnabc ) drop from being among the top 10% most important reactions in the @xmath20 graph to the bottom percentiles in the @xmath21 graph .",
    "conversely , other reactions such as aconitase a ( aconta ) , transaldolase ( tala ) and succinyl - coa synthetase ( sucoas ) , and formate transport via diffusion ( forti ) gain substantial importance in the @xmath21 graph .",
    "for instance , forti is the sole consumer of formate , which is produced by pyruvate formate lyase ( pfl ) , a reaction that is highly connected to the rest of the network .",
    "importantly , in most of the reversible reactions , such as atp synthase ( atps4r ) , there is a wide gap between the pagerank of the forward and backward reactions , suggesting a marked asymmetry in the importance of metabolic flows .     and",
    "@xmath21 from fig .",
    "[ fig : model_a_dnorm]b  c partitioned into communities computed with the markov stability method ; for clarity , the graph edges are not shown .",
    "the sankey diagrams  @xcite show the correspondence between biochemical pathways and the communities found in each graph .",
    "the word clouds contain the metabolites that participate in the reactions each community , and the word size is proportional to the number of reactions in which each metabolite participates . ]",
    "community detection is a technique that is frequently used for the analysis of complex graphs : nodes are clustered into tightly - related communities in order to reveal the coarse - grained structure of the graph , potentially at different levels of resolution  @xcite .",
    "indeed , the community structure of graphs derived from metabolic networks has been the subject of several analyses  @xcite .",
    "however , most existing community detection methods are only applicable to undirected graphs and fail to capture the directionality of the edges , a key feature in metabolism . in order to account for directionality",
    ", we use the markov stability community detection framework  @xcite , which employs diffusions on graphs to detect groups of nodes where flows are retained persistently across time scales . due to its use of diffusive dynamics , markov stability is ideally suited to find multi - resolution community structure  @xcite , and naturally incorporates edge directionality , if present  @xcite ( see sec .  [",
    "sec : markov ] ) . when applied to metabolic graphs",
    ", markov stability can thus reveal groups of reactions that are tightly linked by the flow of metabolites they produce and consume .",
    "figure  [ fig : avsd_comms ] highlights the strong differences between the community structure of the undirected rag and the directed pfg of the core metabolism of _",
    "e. coli _ , underscoring the importance of directionality in these graphs .",
    "when applied to the @xmath20 graph , markov stability reveals a robust partition into seven communities ( figure  [ fig : avsd_comms]b , see also sec .",
    "[ sec : avsd_comms_si ] ) .",
    "the reaction communities obtained are largely determined by the edges created by abundant pool metabolites .",
    "for example , community c1@xmath86 is mainly composed of reactions that consume or produce atp and water .",
    "note , however , that the biomass reaction ( the largest consumer of atp ) is not a member of c1@xmath86 because , in the @xmath20 graph construction , any connection involving atp has equal weight .",
    "other communities in @xmath20 are also determined by pool metabolites , e.g. c2@xmath86 is dominated by h@xmath87 , and c3@xmath86 is dominated by nad@xmath87 and nadp@xmath87 , as shown by the word clouds representing the relative frequency of metabolites that appear in the reactions contained in each community .",
    "the community structure in @xmath31 thus reflects the limitations of this graph construction due to the absence of biological context and the large number of uninformative links introduced by pool metabolites .",
    "in contrast , we found a robust partition into five communities for the @xmath21 graph ( figure  [ fig : avsd_comms]c , see also sec .",
    "[ sec : avsd_comms_si ] ) .",
    "these communities comprise reactions related consistently by biochemical pathways .",
    "community c1@xmath88 contains the reactions in the pentose phosphate pathway together with the first steps of glycolysis involving d - fructose , d - glucose , or d - ribulose .",
    "community c2@xmath88 contains the main reactions that produce atp from substrate level as well as oxidative phosphorylation and the biomass reaction .",
    "community c3@xmath88 includes the core of the citric acid cycle , anaplerotic reactions related to malate syntheses , as well as the intake of cofactors such as co@xmath89 .",
    "community c4@xmath88 contains reactions that are secondary sources of carbon ( such as malate and succinate ) , as well as oxidative phosphorilation reactions .",
    "finally , community c5@xmath88 contains reactions that are part of the pyruvate metabolism subsystem , as well as transport reactions for the most common secondary carbon metabolites such as lactate , formate , acetaldehyde and ethanol .",
    "altogether , the communities of the @xmath21 graph reflect metabolite flows associated with specific cellular functions , a key benefit and consequence of including flux directionality in the graph construction . as seen in fig .",
    "[ fig : avsd_comms]c , the communities are no longer exclusively determined by pool metabolites ( e.g. , water is no longer dominant and protons are spread among all communities ) . for a more detailed explanation and comparison of the communities found in the @xmath20 and @xmath21 graphs ,",
    "see section  [ sec : avsd_comms_si ] .",
    "to incorporate the impact of environmental context in our graphs , we construct different metabolic flux graphs  , using flux distributions obtained from flux balance analysis applied to the core model of _",
    "metabolism under several growth conditions : aerobic growth in rich media with glucose or ethanol , aerobic growth in glucose but phosphate- and ammonium - limited , and anaerobic growth in glucose .",
    "the results , summarised in figure  [ fig : networksm ] , reveal how changes in metabolite flows induced by different biological contexts are reflected in our graph construction . in all cases ,",
    "the mfgs have fewer nodes than the blueprint graph @xmath21 because the fba solutions contain numerous reactions with zero flux .",
    "the different environments also affect the graph connectivity and the relative node importance , as measured by their pagerank score .",
    "furthermore , the community structure of the mfgs for the four environmental conditions , as obtained with the markov stability framework , reflect the distinct usage of functional pathways by the cell in response to growth requirements under specific environments .",
    "we briefly describe the salient features of the analysis ; a more detailed discussion can be found in section  [ sec : m_comms_si ] and fig .",
    "[ fig : markov_stability_fba_networks ] in the si .",
    "[ [ aerobic - growth - in - d - glucose - mathbfm_mathrmglc . ] ] aerobic growth in d - glucose ( @xmath90 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we observe a robust partition into three communities with an intuitive biological interpretation ( fig .",
    "[ fig : networksm]a and fig .",
    "[ fig : markov_stability_fba_networks]a ) .",
    "firstly , c1@xmath91 can be thought of as a carbon - processing community , comprising reactions that process carbon from d - glucose to pyruvate including most of the glycolysis and pentose phosphate pathways , together with related transport and exchange reactions .",
    "secondly , c2@xmath91 harbours the bulk of reactions related to oxidative phosphorylation and the production of energy in the cell , including the electron transport chain of nadh dehydrogenase , cytochrome oxidase , and atp synthase , as well as transport reactions for phosphate and oxygen intake and proton balance .",
    "the growth reaction is also included in community c2@xmath91 , consistent with atp being the main substrate for both the atp maintenance ( atpm ) requirement and the biomass reaction in this biological scenario .",
    "finally , c3@xmath91 contains reactions related to the citric acid cycle ( tac ) and the production of nadh and nadph ( i.e. ,  the cell s reductive power ) , as well as routes that take phosphoenolpyruvic acid ( pep ) as a starting point , thus highlighting carbon intake routes that are strongly linked to the tca cycle .",
    "[ [ aerobic - growth - in - ethanol - mathbfm_mathrmetoh . ] ] aerobic growth in ethanol ( @xmath92 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we found a robust partition into three communities that resemble those found in @xmath90 , with subtle yet important differences ( fig .",
    "[ fig : networksm]b and fig .",
    "[ fig : markov_stability_fba_networks]b ) .",
    "the most salient differences are observed in the carbon - processing community c1@xmath93 , which clearly reflects the switch of carbon source from d - glucose to ethanol .",
    "this community contains gluconeogenic reactions ( instead of glycolytic ) , due to the reversal of flux induced by the change of carbon source , as well as anaplerotic reactions and reactions related to glutamate metabolism .",
    "the main role of the reactions in this community is the production of bioprecursors such as pep , pyruvate , 3-phospho - d - glycerate ( 3pg ) , glyceraldehyde-3-phosphate ( g3p ) , d - fructose-6-phosphate ( f6p ) , and d - glucose-6-phosphate , all of which are substrates for growth .",
    "consequently , the biomass reaction is also grouped within c1@xmath93 due the increased metabolic flux of precursors relative to atp production in this biological scenario .",
    "the other two reaction communities ( energy - generation c2@xmath93 and citric acid cycle c3@xmath93 ) display less prominent differences relative to the @xmath90 graph , with additional pyruvate metabolism and anaplerotic reactions as well as subtle ascriptions of reactions involved in nadh / nadph balance and the source for acetyl - coa .    [ [ anaerobic - growth - in - d - glucose - mathbfm_mathrmanaero . ] ] anaerobic growth in d - glucose ( @xmath94 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the absence of oxygen has a profound impact on the metabolic balance of the cell and the mfg captures the drastic changes in this new regime effectively ( fig .",
    "[ fig : networksm]c and fig .",
    "[ fig : markov_stability_fba_networks]c ) . both the connectivity and",
    "the reaction communities in this mfg are different from the aerobic scenarios , with a much diminished presence of oxidative phosphorylation pathways and the absence of the first two steps of the electron transport chain ( cytbd and nadh16 ) .",
    "we found that @xmath94 has a robust partition into four communities .",
    "c1@xmath95 still contains carbon processing ( glucose intake and glycolysis ) , yet these reactions are decoupled from the pentose phosphate pathway , which is now part of community c3@xmath95 grouped with the citric acid cycle ( now incomplete ) and the biomass reaction .",
    "c3@xmath95 includes the growth precursors in this scenario , including alpha - d - ribose-5-phosphate ( r5p ) , d - erythrose-4-phosphate ( e4p ) , 2-oxalacetate and nadph .",
    "the other two communities are specific to the anaerobic context : c2@xmath95 contains the conversion of pep into formate ( more than half of the carbon secreted by the cell becomes formate  @xcite ) ; and c4@xmath95 includes nadh production and consumption via reactions linked to glyceraldehyde-3-phosphate dehydrogenase ( gapd ) .",
    "[ [ aerobic - growth - in - d - glucose - but - limited - phosphate - and - ammonium - mathbfm_mathrmlim . ] ] aerobic growth in d - glucose but limited phosphate and ammonium ( @xmath96 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    under these growth - limiting conditions , we found a robust partition into three communities ( fig .",
    "[ fig : networksm]d and fig .",
    "[ fig : markov_stability_fba_networks]d ) .",
    "the community structure reflects _ overflow metabolism _",
    "@xcite , which occurs when the cell takes in more carbon than it can process . as a consequence",
    ", the excess carbon is secreted from the cell , leading to a strong decrease in growth and a partial shutdown of the citric acid cycle .",
    "this is reflected in the reduced weight of the tca pathway in c3@xmath97 and its grouping with the secretion routes of acetate and formate .",
    "hence , c3@xmath97 comprises reactions that would not be strongly coupled in more favorable growth conditions , yet are linked together by metabolic responses appearing due to the limited availability of ammonium and phosphate .",
    "furthermore , the carbon - processing community c1@xmath97 contains the glycolytic pathway , but detached from the pentose phosphate pathway , as in the @xmath94 graph , highlighting its role in precursor formation .",
    "the bioenergetic machinery is contained in community c2@xmath97 , including the pentose phosphate pathway , with a smaller role for the electron transport chain ( 21.8% of the total atp as compared to 66.5% in @xmath90 ) .",
    "another advantage of flux - based mfgs is the possibility of applying network - theoretic tools to detect natural groupings of reactions at different levels of resolution , as well as their hierarchical relationship across scales .",
    "the markov stability framework  @xcite can be used to detect multi - resolution community structure in directed graphs ( sec .",
    "[ sec : markov ] ) , thus allowing the exploration of the modular multiscale organisation of metabolic reaction networks .    ) across levels of resolution .",
    "the top panel shows the number of communities of the optimal partition ( blue line ) and two measures of its robustness ( @xmath98 ( green line ) and @xmath99 ( colour map ) ) as a function of the markov time @xmath100 ( see text and methods section ) .",
    "the five markov times selected correspond to robust partitions of the graph into 11 , 7 , 5 , 3 , and 2 communities , as signalled by extended low values of @xmath99 and low values ( or pronounced dips ) of @xmath98 .",
    "the sankey diagram ( middle panel ) visualises the multiscale organisation of the communities of the flux graph across markov times , and the relationship of the communities with the biochemical pathways .",
    "the bottom panel shows the five partitions at the selected markov times .",
    "the partition into 3 communities corresponds to that in figure [ fig : networksm]a . ]",
    "figure  [ fig : vi_alluvialdiagrams ] illustrates this multiscale analysis on the metabolic flux graph of _",
    "e. coli _ under aerobic growth in glucose ( @xmath90 ) . by varying the markov time @xmath100 , a parameter in the markov stability method",
    ", we scanned the community structures at different resolutions .",
    "our results show that , as we move from finer to coarser resolutions , the mfg can be partitioned into 11 , 7 , 5 , 3 , and 2 communities which have high robustness across markov time ( extended plateaux of optimality over @xmath100 , as shown by the low values of @xmath99 ) and are highly robust within the optimisation ensemble ( as shown by dips in @xmath98 )",
    ". for further details , see section  [ sec : markov ] and refs .",
    "@xcite .",
    "the sankey diagram in fig .",
    "[ fig : vi_alluvialdiagrams ] allows us to visualise the pathway composition of the graph partitions and their relationships across different resolutions . as we decrease the resolution ( longer markov times ) , the reactions in different pathways assemble and split into different groupings , reflecting both specific relationships and general organisation principles associated with this growth condition .",
    "a general observation is that glycolysis is grouped together with oxidative phosphorylation across most scales , underlining the fact that those two pathways function as cohesive metabolic sub - units in aerobic conditions .",
    "in contrast , the exchange and transport pathways appear spread among multiple partitions across all resolutions .",
    "this is expected , as these are enabling functional pathways in which reactions do not interact amongst themselves but rather feed substrates to other pathways .",
    "other reaction groupings reflect more specific relationships .",
    "for example , the citric acid cycle ( always linked to anaplerotic reactions ) appears as a cohesive unit across most scales , and only splits in two in the very final flux grouping , reflecting the global role of the tca cycle in linking to both glycolysis and oxidative phosphorylation . the pentose phosphate pathway , on the other hand , is split into two groups ( one linked to glutamate metabolism and another one linked to glycolysis ) across early scales , only merging into the same community towards the final groupings .",
    "this suggests a more interconnected flux relationship of the different steps of the penthose phosphate pathway with the rest of metabolism .",
    "figure  [ fig : markov_stability_fba_networks ] contains a multiscale analyses of the communities for the other three growth scenarios .",
    "metabolic reactions are commonly understood in terms of functional pathways that are heavily interconnected to form metabolic networks , i.e. , metabolites linked by arrows representing enzymatic reactions between them  @xcite ( figs .",
    "[ fig : model_a_dnorm ] and [ fig : networksm ] )",
    ". however , such standard representations are not amenable to rigorous graph - theoretic analysis .",
    "importantly , there are fundamentally different graphs that can be constructed from the metabolic reaction information depending on the chosen representation of species / interactions as nodes / edges , e.g. , reactions as nodes ; metabolites as nodes ; or both reaction and metabolites as nodes  @xcite",
    ". each one of these graphs can be directed or undirected , and with weighted links computed according to different rules .",
    "the choices and subtleties in graph construction are crucial both to capture the relevant metabolic information and to interpret their topological properties  @xcite .    here , we have presented a flux - based strategy to build graphs for metabolic networks .",
    "our graphs have reactions as nodes and directed edges representing the flux of metabolites produced by a source reaction and consumed by a target reaction .",
    "this principle can be applied to build both ` blueprint ' graphs ( pfg ) , which summarise the probabilistic fluxes of the whole metabolism of an organism , as well as context - specific graphs ( mfgs ) , which reflect specific environmental conditions .",
    "the blueprint probabilistic flux graph , with edge weights equal to the probability that the source / target reactions produce / consume a molecule of a metabolite chosen at random , naturally tames the over - representation of pool metabolites without the need to remove them from the graph arbitrarily , as is often done in the literature  @xcite . the context - specific metabolic flux graphs ( mfgs )",
    "incorporate the effect of the environment , as edge weights correspond to the total flux of metabolites between reactions as calculated by flux balance analysis ( fba ) .",
    "computing fba solutions for different environments allows us to build metabolic graphs systematically for different growth media .    to exemplify our approach",
    ", we built and analysed pfg and mfgs for the core metabolism of _",
    "e. coli_. through the analysis of topological properties and community structure of these graphs , we highlighted the importance of weighted directionality in metabolic graph construction and revealed the flux - mediated relationships between functional pathways under different environments .",
    "in particular , the mfgs capture specific metabolic adaptations such as the glycolytic - gluconeogenic switch , overflow metabolism , and the effects of anoxia .",
    "we note that although we have illustrated our analysis on the core metabolism of _",
    "e. coli _ , the proposed graph construction can be readily applied to large genome - scale metabolic networks  @xcite .",
    "our flux graphs provide a systematic connection between network theory and constraint - based methods widely employed in metabolic modelling  @xcite , thus opening avenues towards environment - dependent , graph - based analyses of cell metabolism .",
    "an area of interest would be to use mfgs to study how the community structure of flux graphs across scales can help characterise metabolic conditions that maximise the efficacy of drug treatments or disease - related distortions , e.g. , cancer - related metabolic signatures  @xcite .",
    "in particular , mfgs can quantify metabolic robustness via graph statistics upon removal of reaction nodes  @xcite .",
    "the proposed graph construction framework can be extended in different directions .",
    "the core idea behind our framework is the distinction between production and consumption fluxes , and how to encode both in the links of a graph .",
    "this general principle can also be used to build other potentially useful graphs .",
    "for example , two other graphs that describe relationships between reactions are : @xmath101 the competition and synergy graphs are undirected and their edge weights represent the probability that two reactions consume ( @xmath102 ) or produce ( @xmath103 ) metabolites picked at random .",
    "there exist corresponding fba versions of the competition and synergy flux graphs , which follow from  , and the definitions   and .",
    "these graphs could help reveal further relationships between metabolic reactions in the cell and will be the subject of future studies .",
    "our approach could also be extended to include dynamic adaptations of metabolic activity , e.g. , by using dynamic extensions of fba  @xcite or by incorporating static  @xcite and time - varying  @xcite enzyme concentrations .",
    "of particular interest to metabolic modelling , we envision that mfgs could provide a novel route to evaluate the robustness of fba solutions  @xcite by exploiting the non - uniqueness of the mfg from each fba solution in the space of graphs .",
    "such results could enhance the interface between network science and metabolic analysis , allowing for the systematic exploration of the system - level organisation of metabolism in response to environmental constraints and disease states .",
    "flux balance analysis ( fba )  @xcite is a widely - adopted approach to analyse metabolism and cellular growth .",
    "fba calculates the reaction fluxes that optimise growth in specific biological contexts .",
    "the main hypothesis behind fba is that cells adapt their metabolism to maximise growth in different biological conditions .",
    "the conditions are encoded as constraints on the fluxes of certain reactions ; for example , constraints reactions that import nutrients and other necessary compounds from the exterior .    the mathematical formulation of the fba is described in the following constrained optimisation problem : @xmath104 where @xmath14 is the stoichiometry matrix of the model , @xmath105 the vector of fluxes , @xmath106 is an indicator vector ( i.e. ,  @xmath107 when @xmath7 is the biomass reaction and zero everywhere else ) so that @xmath108 is the flux of the biomass reaction .",
    "the constraint @xmath109 enforces mass - conservation at stationarity , and @xmath110 and @xmath111 are the lower and upper bounds of each reaction s flux . through these vectors",
    ", one can encode a variety of different scenarios  @xcite .",
    "the biomass reaction represents the most widely - used flux that is optimised , although there are others can be used as well  @xcite .    in our simulations",
    ", we set the individual carbon intake rate to 18.5  @xmath84 for every source available in each scenario .",
    "we allowed oxygen intake to reach the maximum needed in to consume all the carbon except in the anaerobic condition scenario , in which the upper bound for oxygen intake was @xmath112 . in the scenario with limited phosphate and ammonium intake , the levels of nh@xmath113 and phosphate intake were fixed at @xmath114 and @xmath115 respectively ( a reduction of 50% compared to a glucose - fed aerobic scenario with no restrictions ) .",
    "we extract the communities in each network using the markov stability community detection framework  @xcite .",
    "this framework uses diffusion processes on the network to find groups of nodes ( i.e. , communities ) that retain flows for longer than one would expect on a comparable random network ; in addition , markov stability incorporates directed flows seamlessly into the analysis  @xcite .",
    "the diffusion process we use is a continuous - time markov process on the network . from the adjacency matrix @xmath31",
    "we construct a rate matrix for the process : @xmath116 , where @xmath117 is the diagonal matrix of out - strengths , @xmath118",
    ". when a node has no outgoing edges then we simply let @xmath119 .",
    "in general , a directed network will not be strongly - connected and thus a markov process on @xmath120 will not have a unique steady state . to ensure the uniqueness of the steady state we must add a _ teleportation _ component to the dynamics by which a random walker visiting a node can follow an outgoing edge with probability @xmath121 or jump ( teleport ) uniformly to any other node in the network with probability @xmath122  @xcite .",
    "the rate matrix of a markov process with teleportation is : @xmath123{\\mathbf{1}\\mathbf{1}^t},\\ ] ] where the @xmath124 vector @xmath125 is an indicator for dangling nodes : if node @xmath7 has no outgoing edges then @xmath126 , and @xmath127 otherwise .",
    "here we use @xmath128 .",
    "the markov process is described by the ode : @xmath129 where @xmath130 .",
    "the solution of is @xmath131 and its stationary state ( i.e. , @xmath132 ) is @xmath133 , where @xmath134 is the leading left eigenvector of @xmath135 .",
    "a hard partition of the graph into @xmath136 communities can be encoded into the @xmath137 matrix @xmath138 , where @xmath139 if node @xmath7 belongs to community @xmath140 and zero otherwise .",
    "the @xmath141 _ clustered autocovariance matrix _ of  is @xmath142 and the entry @xmath143 of @xmath144 measures how likely it is that a random walker that started the process in community @xmath140 finds itself in community @xmath145 after time @xmath100 when at stationarity .",
    "the diagonal elements of @xmath144 thus record how good the communities in @xmath138 are at retaining flows .",
    "the _ markov stability of the partition _ is then defined as @xmath146 the optimised communities are obtained by maximising the cost function   over the space of all partitions for every time  @xmath100 to obtain an optimised partition @xmath147 .",
    "this optimisation is np - hard ; hence with no guarantees of optimality . here we use the louvain greedy optimisation heuristic  @xcite , which is known to give high quality solutions @xmath147 in an efficient manner .",
    "the value of the markov time @xmath100 , i.e. the duration of the markov process , can be understood as a resolution parameter for the partition into communities  @xcite . in the limit @xmath148 , markov stability",
    "will assign each node to its own community ; as @xmath100 grows , we obtain larger communities because the random walkers have more time to explore the network  @xcite .",
    "we scan through a range of values of @xmath100 to explore the multiscale community structure of the network .",
    "the code for markov stability can be found at github.com/michaelschaub/partitionstability .    to identify the important partitions across time , we use two criteria of robustness  @xcite .",
    "firstly , we optimise 100 times for each value of @xmath100 and we assess the consistency of the solutions found .",
    "a relevant partition should be a robust outcome of the optimisation , i.e. , the ensemble of optimised solutions should be similar as measured with the normalised variation of information  @xcite : @xmath149 where @xmath150 is a shannon entropy and @xmath151 is the relative frequency of finding a node in community @xmath152 in partition @xmath153 .",
    "we then compute the average variation of information of the ensemble of solutions from the @xmath154 louvain optimisations @xmath155 at each markov time @xmath100 : @xmath156 if all louvain runs return similar partitions , then @xmath157is small , indicating robustness of the partition to the optimisation . hence we select partitions with low values ( or dips ) of @xmath157 .",
    "secondly , relevant partitions should also be optimal across markov time , as indicated by a low values of the cross - time variation of information : @xmath158 therefore , we also search for partitions with extended low value plateaux of @xmath159  @xcite .",
    "m.b.d .  acknowledges support from the james s. mcdonnell foundation postdoctoral program in complexity  science / complex  systems fellowship award ( # 220020349-cs / pd fellow ) , and the oxford - emirates data science lab .",
    "g.b .  acknowledges the support from the spanish ministry of economy fpi program ( bes-2012 - 053772 ) .",
    "d.o .  acknowledges support from an imperial college research fellowship and from the human frontier science program through a young investigator grant ( rgy0076 - 2015 ) .",
    "j.p .  acknowledges the support from the spanish ministry of economy and eu feder through the synbiofactory project ( cicyt dpi2014 - 55276-c5 - 1 ) .",
    "m.b .  acknowledges funding from the epsrc through grants ep / i017267/1 and ep / n014529/1 .",
    "[ [ data - statement ] ] data statement : + + + + + + + + + + + + + + +    no new data was generated during the course of this research .",
    "a directed version of the rag   could in principle be obtained from the boolean production / consumption matrices @xmath160 and @xmath161 as follows .",
    "projecting onto the space of reactions gives the @xmath162 ( asymmetric ) adjacency matrix @xmath163 where the entries @xmath164 represent the total number of metabolites _ produced _ by reaction @xmath76 that are _ consumed _ by reaction @xmath50 .",
    "a directed version of the reaction adjacency graph on @xmath3 nodes ( directly comparable to the standard rag ) is then @xmath165 clearly , when the metabolic model contains only reversible reactions , ( i.e. ,  the reversibility vector is all ones , @xmath166 ) , it follows that @xmath167 .",
    "although @xmath168 does not include spurious edges introduced by non - existent backward reactions , its structure is still obscured by the effect of uninformative connections created by pool metabolites .",
    "as an illustration of the graph construction , the toy metabolic network in fig .  [",
    "fig : toymodel_networks ] was taken from ref .",
    "the graph matrices for this model are as follows :    * reaction adjacency graph , eq .  : @xmath169.\\ ] ] * probabilistic flux graph , eq .  :",
    "@xmath170.\\ ] ] * metabolic flux graph for fba scenario 1 , eq .  : @xmath171.\\ ] ] * metabolic flux graph for fba scenario 2 , , eq .  : @xmath172.\\ ] ]",
    "a robust partition into seven communities in the rag was found at markov time @xmath173 ( fig .  [ fig : markov_stability_template_networks]a ) . the communities at this resolution ( fig .",
    "[ fig : avsd_comms]e ) are :    * community c1@xmath86 contains all the reactions that consume or produce atp and water ( two pool metabolites ) .",
    "production of atp comes mostly from oxidative phosphorylation ( atps4r ) and substrate level phosphorylation reactions such as phosphofructokinase ( pfk ) , phosphoglicerate kinase ( pgk ) and succinil - coa synthase ( sucoas ) .",
    "reactions that consume atp include glutamine synthetase ( glns ) and atp maintenance equivalent reaction ( atpm ) .",
    "the reactions l - glutamine transport via abc system ( glnabc ) , acetate transport in the form of phosphotransacetilase ( ptar ) , and acetate kinase ( ackr ) are also part of this community .",
    "additionally , c1@xmath86 ( green ) contains also reactions that involve h@xmath174o . under normal conditions water",
    "is assumed to be abundant in the cell , thus the biological link that groups these reactions together is tenuous .",
    "* community c2@xmath86 includes the reactions nadh dehydrogenase ( nadh16 ) , cytochrome oxidase ( cytbd ) , and transport and exchange reactions .",
    "these two reactions involve pool metabolites ( such as h@xmath87 ) which create a large number of connection .",
    "other members include fumarate reductase ( fr7 ) and succinate dehydrogenase ( sucdi ) which couple the tca cycle with the electron transport chain ( through ubiquinone-8 reduction and ubiquinol-8 oxidation ) .",
    "reactions that include export and transport of most secondary carbon sources ( such as pyruvate , ethanol , lactate , acetate , malate , fumarate , succinate or glutamate ) are included in the community as well .",
    "these reactions are included in the community because of their influence in the proton balance of the cell .",
    "most of these reactions do not occur under normal circumstances .",
    "this community highlights the fact that in the absence of biological context , many reactions that do not normally interact can be grouped together .",
    "* community c3@xmath86 contains reactions that produce or consume nicotinamide adenine dinucleotide ( nad@xmath87 ) , nicotinamide adenine dinucleotide phosphate ( nadp@xmath175 ) , or their reduced variants nadh and nadph .",
    "the main two reactions of the community are nad(p ) transhydrogenase ( thd2 ) and nad@xmath87 transhydrogenase ( nadtrhd ) .",
    "there are also reactions related to the production of nadh or nadph in the tca cycle such as isocitrate dehydrogenase ( icdhyr ) , 2-oxoglutarate dehydrogenase ( akgdh ) and malate dehydrogenase ( mdh ) .",
    "the community also includes reactions that are not frequently active such as malic enzime nad ( me1 ) and malic enzime nadh ( me2 ) or acetate dehydrogenase ( acald ) and ethanol dehydrogenase ( alcd2x ) .",
    "* community c4@xmath86 contains the main carbon intake of the cell ( glucose ) , the initial steps of glycolysis , and most of the pentose phosphate shunt .",
    "these reactions are found in this community because the metabolites involved in these reactions ( e.g. , alpha - d - ribose-5-phosphate ( r5p ) or d - erythrose-4-phosphate ( e4p ) ) are only found in these reactions .",
    "this community includes the biomass reaction due to the number of connections created by growth precursors .",
    "* communities c5@xmath86 , c6@xmath86 and c7@xmath86 are small communities that contain oxygen intake , ammonium intake and acetaldehyde secretion reactions , respectively .     and @xmath21 . * ( a ) communities in @xmath20 .",
    "top plot : variation of information ( vi ) of the best partition found at markov time @xmath100 with every other partition at time @xmath176 .",
    "bottom plot : number of communities and vi of the ensemble of solutions found at each markov time .",
    "a robust partition into seven communities is found at @xmath173 .",
    "( b ) communities and vi in @xmath21 .",
    "a robust partition into five communities is found at @xmath177 . ]      a robust partition into five communities in the pfg was found at markov time @xmath177 ( fig .",
    "[ fig : markov_stability_template_networks]b ) .",
    "the communities at this resolution ( fig .",
    "[ fig : avsd_comms]c ) are :    * community c1@xmath88 includes the first half of the glycolysis and the complete pentose phosphate pathway .",
    "the metabolites that create the connections among these reactions such as d - fructose , d - glucose , or d - ribulose .",
    "* community c2@xmath88 contains the main reaction that produces atp through substrate level ( pgk , pyk , ackr ) and oxidative phosphorylation ( atps4r ) .",
    "the flow of metabolites among the reactions in this community includes some pool metabolites such as atp , adp , h@xmath1740 , and phosphate .",
    "however , there are connections created by metabolites that only appear in a handful of reactions such as adenosine monophosphate ( amp ) whose sole producer is phosphoenolpyruvate synthase ( pps ) and its sole consumer is atps4r .",
    "this community also contains the biomass reaction . *",
    "community c3@xmath88 includes the core of the citric acid ( tca ) cycle such as citrate synthase ( cs ) , aconitase a / b ( aconta / b ) , and anaplerotic reactions such as malate synthase ( mals ) , malic enzyme nad ( me1 ) , and malic enzyme nadp ( me2 ) .",
    "this community also includes the intake of cofactors such as co@xmath89 .",
    "* community c4@xmath88 contains reactions that are secondary sources of carbon such as malate and succinate , as well as oxidative phosphorilation reactions .",
    "* community c5@xmath88 contains some reactions part of the pyruvate metabolism subsystem such as d - lactate dehydrogenase ( ldh - d ) , pyruvate formate lyase ( pfl ) or acetaldehyde dehydrogenase ( acald ) .",
    "in addition , it also includes the tranport reaction for the most common secondary carbon metabolites such as lactate , formate , acetaldehyde and ethanol .",
    "this graph has 48 reactions with nonzero flux and 227 edges . at markov time",
    "@xmath179 ( fig .",
    "[ fig : markov_stability_fba_networks]a ) this graph has a partition into three communities ( fig .",
    "[ fig : networksm]a ) :    * community c1@xmath91 comprises the intake of glucose and most of the glycolysis and pentose phosphate pathway .",
    "the function of the reactions in this community consists of carbon intake and processing glucose into phosphoenolpyruvate ( pep ) .",
    "this community produces essential biocomponents for the cell such as alpha - d - ribose 5-phosphate ( rp5 ) , d - erythrose 4-phosphate ( e4p ) , d - fructose-6-phosphate ( f6p ) , glyceraldehyde-3-phosphate ( g3p ) or 3-phospho - d - glycerate ( 3pg ) .",
    "other reactions produce energy atp and have reductive capabilities for catabolism .",
    "* community c2@xmath91 contains the electron transport chain which produces the majority of the energy of the cell . in the core _",
    "e coli _ metabolic model the chain is represented by the reactions nadh dehydrogenase ( nadh16 ) , cytochrome oxidase bd ( cytbd ) and atp synthase ( atps4r ) .",
    "this community also contains associated reactions to the electron transport such as phosphate intake ( expi(e ) , pit2 ) , oxygen intake ( exo2(e ) , o2 t ) and proton balance ( exh(e ) ) .",
    "this community also includes the two reactions that represent energy maintenance costs ( atpm ) , and growth ( biomass ) ; this is consistent with the biological scenario because atp is the main substrate for both atpm , and the biomass reaction . *",
    "community c3@xmath91 contains the tca cycle at its core .",
    "the reactions in this community convert pep into atp , nadh and nadph .",
    "in contrast with c1@xmath91 , there is no precursor formation here . beyond the tca cycle , pyruvate kinase ( pyk ) , phosphoenolpyruvate carboxylase",
    "( ppc ) and pyruvate dehydrogenase ( pdh ) appear in this community .",
    "these reactions highlight the two main carbon intake routes in the cycle : oxalacetate from pep through phosphoenol pyruvate carboxylase ( ppc ) , and citrate from acetyl coenzyme a ( acetyl - coa ) via citrate synthase ( cs ) .",
    "furthermore , both routes begin with pep , so it is natural for them to belong to the same community along with the rest of the tca cycle . likewise , the production of l - glutamate from 2-oxoglutarate ( akg ) by glutamate dehydrogenase ( gludy ) is strongly coupled to the tca cycle .",
    "* community c1@xmath93 in this graph is similar to its counterpart in @xmath90 , but with important differences .",
    "for example , the reactions in charge of the glucose intake ( exglc(e ) and glcpts ) are no longer part of the network ( i.e. , they have zero flux ) , and reactions such as malic enzyme napd ( me2 ) and phosphoenolpyruvate caboxykinase ( ppck ) , which now appear in the network , belong to this community .",
    "this change in the network reflect the cell s response to a new biological situation .",
    "the carbon intake through ethanol has changed the direction of glycolysis into gluconeogenesis  @xcite ( the reactions in c1@xmath91 in fig .  [",
    "fig : networksm]a are now operating in the reverse direction in fig .  [",
    "fig : networksm]b ) .",
    "the main role of the reactions in this community is the production of bioprecursors such as pep , pyruvate , 3-phospho - d - glycerate ( 3pg ) glyceraldehyde-3-phosphate ( g3p ) , d - fructose-6-phosphate ( f6p ) , and d - glucose-6-phosphate , all of which are substrates for growth .",
    "reactions me2 and ppck also belong to this community due to their production of pyr and pep .",
    "reactions that were in a different community in @xmath90 , such as gludy and icdhyr which produce precursors l - glutamate and nadph respectively , are now part of c1@xmath93 .",
    "this community also includes the reactions that produce inorganic substrates of growth such as nh@xmath113 , co@xmath174 and h@xmath89o . *",
    "community c2@xmath93 contains the electron transport chain and the bulk of atp production , which is similar to c2@xmath91 .",
    "however , there are subtle differences that reflect changes in this new scenario .",
    "ethanol intake and transport reactions ( exetoh(e ) and etoht2r ) appear in this community due to their influence in the proton balance of the cell .",
    "in addition , c2@xmath93 contains nadp transhydrogenase ( thd2 ) which is in charge of nadh / nadph balance .",
    "this reaction is present here due to the nad consumption involved in the reactions acald and ethanol dehydrogenase ( alcd2x ) , which belong to this community as well .",
    "* community c3@xmath93 contains most of the tca cycle .",
    "the main difference between this community and c1@xmath91 is that here acetyl - coa is extracted from acetaldehyde ( which comes from ethanol ) by the reaction acetaldehyde dehydrogenase reaction ( acald ) , instead of the classical pyruvate from glycolysis .",
    "the glycoxylate cycle reactions isocitrate lyase ( icl ) and malate synthase ( mals ) which now appear in the network , also belong to this community .",
    "these reactions are tightly linked to the tca cycle and appear when the carbon intake is acetate or ethanol to prevent the loss of carbon as co@xmath174 .",
    "* community c1@xmath95 contains the reactions responsible d - glucose intake ( exglc ) and most of the glycolysis . the reaction that represents the cellular maintenance energy cost , atp maintenance requirement ( atpm ) ,",
    "is included in this community because of the increased strength of its connection to the substrate - level phosphorilation reaction phosphoglycerate kinase ( pgk ) .",
    "also note that reactions in the pentose phosphate pathway do not belong to the same community as the glycolysis reactions ( unlike in @xmath90 and @xmath92 ) .",
    "* community c2@xmath95 contains the conversion of pep into formate through the sequence of reactions pyk , pfl , forti and exfor(e ) .",
    "more than half of the carbon secreted by the cell becomes formate .",
    "* community c3@xmath95 includes the biomass reaction and the reactions in charge of supplying it with substrates .",
    "these reactions include the pentose phosphate pathway ( now detached from c1@xmath91 ) , which produce essential growth precursors such as alpha - d - ribose-5-phosphate ( r5p ) or d - erythrose-4-phosphate ( e4p ) . the tca cycle is present as well because its production of two growth precursors : 2-oxalacetate and nadph . finally , the reactions in charge of acetate production ( ackr , act2r and exac(e ) ) are also members of this community through the ability of ackr to produce atp .",
    "glutamate metabolism reaction gludy is also included in this community .",
    "it is worth mentioning that the reverse of atp synthase ( atps4r ) is present in this community because here , unlike in @xmath90 , atps4r consumes atp instead of producing it . when this flux is reversed , then atps4r is in part responsible for ph homeostasis .",
    "* community c4@xmath95 includes the main reactions involved in nadh production and consumption , which occurs via glyceraldehyde-3-phosphate dehydrogenase ( gapd ) .",
    "nadh consumption occurs in two consecutive steps in ethanol production : in acald and alcd2x .",
    "the phosphate intake and transport reactions expi(e ) and pit2r belong to this community because most of the phosphate consumption takes place at gapd .",
    "interestingly , the core reaction around which the community forms ( gapd ) is not present in the community .",
    "it is included in earlier markov times but when communities start to get larger the role of gapd becomes more relevant as a part of the glycolysis than its role as a nadh hub .",
    "this is a good example of how the graph structure and the clustering method are able to capture two different roles in the same metabolite .",
    "has a robust partition into three communities at @xmath179 .",
    "( b ) @xmath180 has a partition into three communities at @xmath177 .",
    "( c ) @xmath181 has four communities at @xmath173 .",
    "( d ) @xmath182 has three communities at @xmath183 . ]        * community c1@xmath97 contains the glycolysis pathway ( detached from the pentose phosphate pathway ) .",
    "this community is involved in precursor formation , atp production , substrate - level phosphorylation and processing of d - glucose into pep .",
    "* community c2@xmath97 contains the bioenergetic machinery of the cell ; the main difference to the previous scenarios is that the electron transport chain has a smaller role in atp production ( atps4r ) , and substrate - level phosphorylation ( pgk , pyk , sucoas , ackr ) becomes more important . in @xmath96",
    "the electron transport chain is responsible for the 21.8% of the total atp produced in the cell while in @xmath90 it produces 66.5% .",
    "the reactions in charge of intake and transport of inorganic ions such as phosphate ( expi(e ) and pit2r ) , o@xmath174 ( exo@xmath174(e ) and o@xmath174t)and h@xmath89o ( exh@xmath174o and h@xmath174ot ) belong to this community as well .",
    "this community includes the reactions in the pentose phosphate pathway that produce precursors for growth : transketolase ( tkt2 ) produces e4p , and ribose-5-phosphate isomerase ( rpi ) produces r5p .",
    "* community c3@xmath97 is the community that differs the most from those in the other aerobic growth networks ( @xmath90 and @xmath92 ) .",
    "this community gathers reactions that under normal circumstances would not be so strongly related but that the limited availability of ammonium and phosphate have forced together ; its members include reactions from the tca cycle , the pentose phosphate pathway , nitrogen metabolism and by - product secretion .",
    "the core feature of the community is carbon secretion as formate and acetate .",
    "reactions ppc , malate dehydrogenase ( mdh ) reverse and me2 channel most of the carbon to the secretion routes in the form of formate and acetate .",
    "the production of l - glutamine seems to be attached to this subsystem through the production of nadph in me2 and its consumption in the glutamate dehydrogenase napd ( gludy ) .                                            ma hw , zhao xm , yuan yj , zeng ap ( 2004 ) decomposition of metabolic network into functional modules based on the global connectivity structure of reaction graph . bioinformatics ( oxford , england ) 20 : 18706 .",
    "sauer u , lasko dr , fiaux j , hochuli m , glaser r , et  al .",
    "( 1999 ) metabolic flux ratio analysis of genetic and environmental modulations of escherichia coli central carbon metabolism .",
    "journal of bacteriology 181 : 6679 - 6688 .                          king za , drger a , ebrahim a , sonnenschein n , lewis ne , et  al . ( 2015 ) escher : a web application for building , sharing , and embedding data - rich visualizations of biological pathways .",
    "plos comput biol 11 : 1 - 13 .",
    "folch - fortuny a , tortajada m , prats - montalbn jm , llaneras f , pic j , et  al .",
    "( 2015 ) mcr  als on metabolic networks : obtaining more meaningful pathways . chemometrics and intelligent laboratory systems 142 : 293303 .",
    "schilling ch , letscher d , palsson bo ( 2000 ) theory for the systemic definition of metabolic pathways and their use in interpreting metabolic function from a pathway - oriented perspective .",
    "j theor biol 203 : 229248 .",
    "page l , brin s , motwani r , winograd t ( 1999 ) the pagerank citation ranking : bringing order to the web .",
    "technical report 1999 - 66 , stanford infolab .",
    "http://ilpubs.stanford.edu:8090/422/. previous number = sidl - wp-1999 - 0120 .",
    "delvenne jc , schaub mt , yaliraki sn , barahona m ( 2013 ) the stability of a graph partition : a dynamics - based framework for community detection . in :",
    "mukherjee a , choudhury m , peruani f , ganguly n , mitra b , editors , dynamics on and of complex networks , volume 2 , springer new york , modeling and simulation in science , engineering and technology .",
    "221 - 242 .",
    "colijn c , brandes a , zucker j , lun ds , weiner b , et  al .",
    "( 2009 ) interpreting expression data with metabolic flux models : predicting _ mycobacterium tuberculosis _",
    "mycolic acid production .",
    "plos comput biol 5 : e1000489 ."
  ],
  "abstract_text": [
    "<S> cells adapt their metabolic fluxes in response to changes in the environment . </S>",
    "<S> we present a systematic flux - based framework for the construction of graphs to represent organism - wide metabolic networks . </S>",
    "<S> our graphs encode the directionality of metabolic fluxes via links that represent the flow of metabolites from source to target reactions . </S>",
    "<S> the methodology can be applied in the absence of a specific biological context by modelling fluxes as probabilities , or tailored to different environmental conditions by incorporating flux distributions computed from constraint - based modelling such as flux balance analysis . </S>",
    "<S> we illustrate our approach on the central carbon metabolism of _ escherichia coli _ and study the derived graphs under various growth conditions . </S>",
    "<S> the results reveal drastic changes in the topological and community structure of the metabolic graphs , which capture the re - routing of metabolic fluxes under each growth condition . by integrating constraint - based models and tools from network science , </S>",
    "<S> our framework allows for the interrogation of environment - specific metabolic responses beyond fixed , standard pathway descriptions . </S>"
  ]
}