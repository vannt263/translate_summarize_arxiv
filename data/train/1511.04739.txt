{
  "article_text": [
    "our aim in this paper is to prove a result that can be viewed in two equivalent ways : as an asymptotic formula for the number of dense connected @xmath5-uniform hypergraphs with a given number of vertices and edges , and as a local limit theorem concerning the numbers of vertices and edges in the largest component of a certain random hypergraph .",
    "this paper is a companion to  @xcite , where we used related ( but much more complicated ) methods to study the sparse case .",
    "here we shall phrase our results in terms of the number of vertices and the number of edges , rather than considering the nullity as in  @xcite .",
    "( the latter is a more natural parameter when it grows slowly , but not here . )    throughout the paper we consider @xmath5-uniform hypergraphs , where @xmath12 is fixed ; much of the time @xmath6 .",
    "a hypergraph is _ connected _ if it can not be written as the vertex disjoint union of two strictly smaller hypergraphs .",
    "( this is not the only possible sense of connectedness when @xmath6 , but it is the most important one , and the only one we consider here . ) a basic problem in enumerative combinatorics is to count the number of ` irreducible ' objects of a certain type according to certain size parameters .",
    "here we study @xmath13 , the number of connected @xmath5-uniform hypergraphs on @xmath14=\\{1,2,\\ldots , s\\}$ ] with precisely @xmath1 edges .",
    "we write @xmath15 rather than @xmath16 for the number of vertices in part for notational consistency with  @xcite , but also because in the bulk of the paper @xmath17 will be the number of vertices in a certain random hypergraph ; see section  [ sec_prob ] .",
    "an asymptotic formula for @xmath18 ( the graph case ) was proved by bender , canfield and mckay  @xcite in 1990 , throughout the range @xmath19 . for @xmath6 , in 1997 karoski and uczak  @xcite proved a result covering the case @xmath20 : this result concerns hypergraphs that are very close to trees .",
    "this was generalized to @xmath21 in an extended abstract of andriamampianina and ravelomanana  @xcite in 2006 .",
    "recently , in  @xcite , we proved a result covering the entire ` sparse case ' @xmath22 .",
    "a formula covering the ` middle range ' @xmath23 was given by behrisch , coja - oghlan and kang  @xcite .",
    "our main result here covers the entire remaining range , the ` dense case ' @xmath24 . as usual in this context",
    ", the statement involves an implicit definition , and so requires a little preparation .    for @xmath25",
    "define @xmath26 it is easy to check that , with @xmath12 fixed , @xmath27 is strictly decreasing , since each of the ratios @xmath28 and @xmath29 is .",
    "moreover , @xmath30 as @xmath31 and @xmath32 as @xmath33 .",
    "it is this latter limit which will be important here .",
    "since @xmath27 is continuous , it defines a bijection from @xmath34 to @xmath35 .",
    "given @xmath36 let @xmath37 and set @xmath38    [ thenum ] let @xmath12 be fixed , and let @xmath39 satisfy @xmath24 as @xmath40 .",
    "let @xmath41 be the average degree of an @xmath1-edge @xmath5-uniform hypergraph on @xmath14 $ ] , and let @xmath42 be such a hypergraph chosen uniformly at random .",
    "then the probability @xmath43 that @xmath42 is connected satisfies @xmath44 as @xmath40 .    furthermore ,",
    "if in addition @xmath45 , then the number @xmath13 of connected @xmath1-edge @xmath5-uniform hypergraphs on @xmath14 $ ] satisfies @xmath46 as @xmath40 , where @xmath47 is the indicator function of @xmath48 .",
    "writing @xmath49 , we have @xmath50 , so the formulae and are equivalent up to a straightforward calculation ; see lemma  [ lpc ] .",
    "( in fact , for @xmath6 , applies for @xmath51 , not just @xmath45 . )",
    "[ rem2 ] we focus on the case @xmath6 , since the case @xmath52 is covered by the result of bender , canfield and mckay  @xcite . for our proof strategy",
    ", there is very little difference between the two situations ; some formulae have extra terms when @xmath52 , since then certain error terms involving factors of @xmath53 are not totally negligible . when convenient , we assume @xmath6 , commenting briefly on these extra terms .",
    "as we shall show later ( in lemma  [ asy ] ) , for @xmath6 we have @xmath54 and @xmath55 as @xmath56 .",
    "( for @xmath52 the first term in the formulae above is the same as for @xmath6 , but the second is different .",
    "the next term in the expansion   is different in the cases @xmath52 , @xmath57 and @xmath58 . )",
    "the probability that a vertex of @xmath42 is isolated is very close to @xmath59 , so the expected number of isolated vertices is approximately @xmath60 , and the poisson intuition suggests that the probability that @xmath42 has no such vertex should be approximately @xmath61 , at least when @xmath62 is bounded or tends to infinity fairly slowly . in turn , in this range we expect the presence of an isolated vertex to be the main obstruction to connectivity . in the light of ,",
    "theorem  [ thenum ] says that when @xmath63 ( corresponding to @xmath64 ) , we have @xmath65 in other words , the intuition just described gives the right asymptotic answer in this ( surprisingly large ) range . as a trivial special case , in the ` very dense ' case where @xmath66 , we have @xmath67 and so @xmath68 where @xmath49 .      the formulae appearing in theorem  [ thenum ] ( the ` dense case ' @xmath24 ) , are superficially rather different from those in theorem 1.1 of  @xcite ( the ` sparse case ' @xmath22 ) and in ( the corrected version of ) theorem 1.1 of behrisch , coja - oghlan and kang  @xcite , covering the ` middle range ' @xmath23 .",
    "however , after a suitable change of notation , they are actually rather similar , despite the different ranges of applicability .    indeed , writing @xmath69 , the definition of @xmath70 and hence of @xmath71 given by is easily seen to coincide with that in @xcite .",
    "there , we set @xmath72 where @xmath73 is the nullity , and @xmath74 was given by a certain formula , ( 1.2 ) in  @xcite .",
    "since @xmath75 in our present notation , and @xmath76 , the quantities @xmath70 and @xmath71 here and in @xcite are defined from the average degree @xmath77 in exactly the same way .",
    "here we work mostly with @xmath70 rather than @xmath71 since in the dense case @xmath33 , which makes the asymptotics more intuitive .",
    "( in the sparse case @xmath78 instead . )    with @xmath79 as above , since @xmath41 we may write @xmath80 equivalently , setting @xmath69 , @xmath81 thus we see that theorem 1.1 of  @xcite says exactly that in the sparse case @xmath82    turning to the middle range , as noted in the appendix to  @xcite , the quantity called @xmath83 in  @xcite is exactly the right - hand side of above , i.e. , simply @xmath84 in our present notation .",
    "behrisch , coja - oghlan and kang  @xcite write @xmath85 for @xmath41 , @xmath86 for the uniformity ( @xmath5 here ) and @xmath5 for what we call @xmath70 . in our notation , their main result says that in the middle range we have @xmath87 with @xmath88 where , for @xmath6 , @xmath89and @xmath90    since @xmath91 as @xmath56 , it is trivial to check that as @xmath56 we have @xmath92 , @xmath93 and @xmath94 .",
    "hence @xmath95 and coincides with our much simpler formula @xmath84 in this case .    finally , we noted in the appendix to  @xcite ( see equations ( a.5 ) and ( a.6 ) ) that as @xmath96 ( corresponding to the nullity @xmath97 satisfying @xmath98 ) then @xmath31 and @xmath99 , corresponding to the pre - factor in .",
    "collecting together these results , we have the following extension of the bender  canfield ",
    "mckay formula  @xcite to hypergraphs .",
    "[ thuniv ] let @xmath12 be fixed , and let @xmath39 satisfy @xmath100 and @xmath101 .",
    "then the proportion @xmath43 of @xmath1-edge @xmath5-uniform hypergraphs on @xmath14 $ ] that are connected satisfies @xmath102 where @xmath41 is the average degree , and @xmath103 and @xmath104 are defined in and , with @xmath105 defined in .    passing to a subsequence",
    "we may assume that the average degree @xmath77 satisfies one of the conditions ( i ) @xmath96 , ( ii ) @xmath106 with @xmath107 , or ( iii ) @xmath56 .",
    "then we apply theorem 1.1 of  @xcite ( in the form above ) , theorem 1.1 of  @xcite , or theorem  [ thenum ] above , recalling  .    in the appendix , we show that the @xmath52 case of the formula does indeed coincide with the ( very different looking ) formula in  @xcite . note that while one _ can _ use the same formula in all cases ( sparse , middle and dense ) , in the sparse and dense cases this does not make much sense in practice , since the formula simplifies greatly in these cases .",
    "note also that while we have shown that the behrisch  coja - oghlan  kang formula applies in the sparse and dense ranges too , so far as we know their _ proof _ does not adapt to these cases .",
    "indeed , the sparse case treated in  @xcite seems to require more complicated arguments despite the relative simplicity of the formula .",
    "we shall prove theorem  [ thenum ] ( which , despite the trivial use of probability in the statement , is a purely enumerative result ) by probabilistic methods .",
    "indeed , as we shall see in section  [ sec_enum ] , up to a ( rather lengthy ) calculation , theorem  [ thenum ] is essentially equivalent to a local limit theorem for the numbers of vertices and edges in the largest component of a certain random hypergraph .",
    "this is a similar situation to that in  @xcite .    turning to the details , given @xmath12 , @xmath108 and @xmath109 ,",
    "let @xmath110 be the random @xmath5-uniform hypergraph on @xmath0 $ ] in which each of the @xmath111 possible edges is included with probability @xmath112 , independently of the others . from now until section  [ sec_enum ] ( where we return to the enumerative viewpoint )",
    "we fix @xmath12 and consider a function @xmath113 satisfying @xmath114 as @xmath2 .",
    "we consider the random hypergraph @xmath110 with @xmath115 noting that the expected degree of a vertex is @xmath116 .",
    "writing @xmath117 then @xmath118 is roughly the expected number of isolated vertices in @xmath110 ; the significance of the second condition in is that it implies @xmath119 as @xmath2 .",
    "given @xmath120 , define @xmath121 by @xmath122 since @xmath123 is strictly decreasing , this uniquely defines @xmath70 .",
    "in fact , @xmath70 is the extinction probability of a certain branching process naturally associated to the neighbourhood exploration process in @xmath110 ; see section  [ sec_bp ] .",
    "it is not hard to see that @xmath33 as @xmath124 . substituting this back into",
    ", it follows that @xmath125 . from this",
    "it follows that @xmath126 and hence , by again , @xmath127 when we come to relate the probabilistic and enumerative viewpoints , the average degree parameters @xmath86 and @xmath77 will not be ( quite ) equal ( and neither will the numbers of vertices , @xmath16 and @xmath15 )",
    ". however , for @xmath86 and @xmath77 related as they will be , @xmath128 as defined in the previous section and @xmath129 as defined above will coincide .    for further background on the phase transition in the component structure of @xmath110 see , for example , section 2 of  @xcite . here",
    ", we are well above the critical edge density .",
    "as is well known ( and we shall show below ) , when @xmath124 then with very high probability @xmath110 has a ( necessarily unique ) ` giant ' component containing almost all the vertices  in fact , all but around @xmath118 vertices .",
    "we say that a sequence @xmath130 of random variables taking values in @xmath131 satisfies a _ local limit theorem _ with parameters @xmath132 and @xmath133 if for any @xmath134 we have @xmath135 where we have partially suppressed the dependence on @xmath16 in the notation .",
    "note that , considering ` almost worst case ' values of @xmath136 and @xmath137 , the @xmath138 term can be taken to be uniform over all @xmath134 .",
    "let @xmath139 and @xmath140 denote the numbers of vertices and edges in the largest component of a hypergraph @xmath141 , where ` largest ' means with the most vertices , and we break ties arbitrarily . here , then , is our local limit theorem for the number of vertices and edges in the giant component of @xmath110 .",
    "[ thllt ] let @xmath12 be fixed , let @xmath142 with @xmath143 , and set @xmath144 .",
    "let @xmath145 and @xmath146 .",
    "then we have @xmath147 = ( 1-\\xi ) n + o(1 ) \\hbox{\\quad and\\quad } { { \\mathbb e}}[m_1 ] = \\frac{d(1-\\xi^r)}{r } n + o(d),\\ ] ] where @xmath148 is defined in , and @xmath149 \\sim \\sigma_l^2 \\hbox{\\quad and\\quad } { { \\mathrm{var}}}[m_1 ] \\sim \\sigma_m^2\\ ] ] where @xmath150 furthermore , the pair @xmath151 satisfies a local limit theorem with parameters @xmath152 , { { \\mathbb e}}[m_1])$ ] and @xmath153 .    in the light of and , it is easy to check that we may replace the parameters for the means in the local limit theorem above by @xmath154 ; see lemma  [ parshift ] below .",
    "a key point is that the error terms @xmath138 and @xmath155 in are ( much ) smaller than @xmath156 and @xmath157 , respectively .",
    "although we are not aware of such accurate estimates for @xmath158 $ ] and @xmath159 $ ] in the literature , these are relatively straightforward .",
    "the main point of theorem  [ thllt ] is the local limit theorem .",
    "analogous results for the sparse regime ( @xmath160 ) and the ` middle range ' @xmath161 were proved in  @xcite and by behrisch , coja - oghlan and kang  @xcite . indeed , recalling that the ` nullity ' @xmath162 studied in  @xcite is defined to be @xmath163 , after a little manipulation it is not hard to check that the quantities @xmath164 and @xmath165 appearing in @xcite as approximations to @xmath158/n$ ] and @xmath159/n$ ] correspond to @xmath166 and @xmath167 here . in other words , the formulae for the means match up ; the asymptotics of the variances are different in the different ranges considered here and in  @xcite .    the rest of the paper is organized as follows . in sections  [ sec_bp][sec_means ]",
    "we prepare the ground for the proof of theorem  [ thllt ] .",
    "these sections contain lemmas concerning , respectively , a certain branching process , basic properties of @xmath110 , and the mean and variance of @xmath168 and @xmath169 .",
    "then , in section  [ sec_pf ] ( the heart of the paper ) , we use ` smoothing ' arguments to prove theorem  [ thllt ] .",
    "finally , in section  [ sec_enum ] we deduce theorem  [ thenum ] via a somewhat involved calculation . in the appendix",
    ", we compare the @xmath52 case of our enumerative formula with that of bender , canfield and mckay .",
    "given an integer @xmath12 and a real number @xmath170 , let @xmath171 be the galton  watson branching process defined as follows",
    ". start in generation @xmath172 with one individual .",
    "each individual in generation @xmath97 has a random number of _ groups _ of @xmath173 children , with the number of groups having a poisson distribution @xmath174 .",
    "these children make up generation @xmath175 .",
    "the numbers of children of all individuals in generation @xmath97 are independent of each other and of the history .",
    "the branching process @xmath171 can be naturally viewed as a ( possibly infinite ) @xmath5-uniform hypergraph , with a vertex for each individual , and a hyperedge for each group of children , consisting of these children together with the parent .",
    "this hypergraph is of course an _ @xmath5-tree _ , by which we simply mean an @xmath5-uniform hypergraph that is a tree .",
    "( often , when there is no danger of confusion , we simply write ` tree ' . ) we write @xmath176 and @xmath177 for the number of vertices and edges in this @xmath5-tree , noting that @xmath178    let @xmath179 be the probability that the branching process @xmath171 _ survives _ forever , and @xmath180 its _",
    "extinction probability_. elementary properties of branching processes ( see , e.g. , athreya and ney  @xcite ) imply that @xmath70 is the smallest solution in @xmath181 $ ] to the equation .",
    "moreover , if the branching factor @xmath182 is strictly greater than @xmath183 , then has a unique solution in @xmath184 , and in particular @xmath185 ; otherwise , @xmath186 .",
    "indeed , @xmath187 is the probability that all @xmath173 children in a given group lead to finite trees , so @xmath188 is the probability that a given group _ survives _ , i.e. , has infinitely many descendants . from thinning properties of poisson distributions ,",
    "the number of such surviving groups of children of the root is poisson with mean @xmath189 , and @xmath70 is exactly the probability that this number is @xmath172 .",
    "hence @xmath70 satisfies ; it is not hard to see that @xmath70 is indeed the smallest solution to this equation .    for comparison with the results in @xcite , in terms of @xmath69",
    "we may write as @xmath190 which , writing @xmath191 for @xmath192 , matches the definition given by ( 2.1 ) and ( 2.2 ) in  @xcite . here , where @xmath86 tends to infinity",
    ", we will have @xmath33 , so @xmath70 is a more natural parameter to work with than @xmath71 .",
    "this contrasts with the situation in @xcite , where @xmath78 .      in the branching process @xmath171",
    ", the _ groups _ of children of the root may be classified into two types as above ; those that survive , and those that do not . by thinning properties of poisson distributions ,",
    "the number of groups that do not survive has a poisson distribution with mean @xmath193 , and is independent of the number that do survive . for @xmath120 ( the supercritical case )",
    "define the _ dual parameter _",
    "@xmath194 by @xmath195 then it follows that the conditional distribution of @xmath171 given @xmath196 is exactly the unconditional distribution of the _ dual process _",
    "it is not hard to check that the dual parameter coincides with that defined in @xcite ; the key point is that and imply @xmath198 .      for @xmath199 define @xmath200",
    "the next lemma is a standard calculation , specialized to the particular offspring distribution we have here . in this lemma , and much of this and the next two sections ,",
    "we adopt the convention of writing @xmath201 for the number of vertices of an @xmath5-tree with @xmath202 edges ; this will make the formulae concerning ` small ' tree components much more concise .",
    "[ pkbd ] for any @xmath12 , @xmath170 and @xmath203 we have @xmath204 where @xmath201 .",
    "consider the following alternative way of generating a random rooted @xmath5-tree .",
    "let @xmath205 be independent and identically distributed , with @xmath206",
    ". start with the root in generation @xmath172 .",
    "construct @xmath207 groups of @xmath173 children of the root . then proceed through these children one - by - one , assigning each child @xmath208 groups of @xmath173 children of its own , for @xmath209 .",
    "continue with the new individuals ( if any ) in generation 2 , and so on . by the definition of @xmath171 this tree has the same distribution as @xmath171",
    ". this construction stops if and only if , for some @xmath210 , the first @xmath210 individuals ` explored ' have between them at most , and hence exactly , @xmath211 children , i.e. , @xmath212 _ groups _ of children .",
    "this can only happen for @xmath213 modulo @xmath173 .",
    "for @xmath203 and @xmath201 , let @xmath214 be the set of sequences @xmath215 of non - negative integers with the properties",
    "\\(i ) @xmath216 and    \\(ii ) for all @xmath217 , @xmath218 .",
    "note that condition ( i ) may be written as @xmath219 . from the construction above , @xmath220",
    "if and only if our random sequence @xmath221 starts with a sequence in @xmath214 . by spitzer s lemma ,",
    "the probability of this is exactly @xmath222 indeed , given any sequence @xmath223 with @xmath224 , there is a unique ` rotation ' giving a sequence that also satisfies ( ii ) above , and since the @xmath208 are i.i.d .",
    ", a sequence and its rotations are equiprobable .",
    "since @xmath225 has a poisson distribution with mean @xmath226 , the result follows .",
    "we state a trivial consequence for later reference .",
    "[ decay ] let @xmath12 be fixed .",
    "there is a constant @xmath227 such that for all @xmath228 and @xmath203 we have @xmath229 where @xmath201 .",
    "for @xmath230 we have @xmath231 , say .",
    "since @xmath232 it follows that @xmath233 choosing @xmath227 so that @xmath228 implies @xmath234 for all @xmath228 . of course , the final bound holds for @xmath235 ( i.e. , @xmath236 ) , since @xmath237 .",
    "the key consequence of corollary  [ decay ] is that the values @xmath238 decrease rapidly to zero starting from @xmath239 .    in the subcritical case",
    ", we have the following simple result .    [ negmo ] for any @xmath12 and @xmath240 with @xmath241 we have @xmath242 = \\sum_{k{\\geqslant}0 } s^{-1}\\pi_k = 1-(r-1)d / r,\\ ] ] where , as usual , @xmath201 .",
    "doubtless there is a direct algebraic proof of this .",
    "we outline a different argument : with @xmath5 and @xmath86 fixed , consider the subcritical random hypergraph @xmath110 , @xmath243 .",
    "it is easy to check that for each fixed @xmath203 , the expected number of @xmath202-edge tree components is @xmath244 .",
    "( either directly calculate the expectation or , using a standard coupling argument , note that @xmath245 approximates the expected number of vertices in components that are @xmath202-edge trees .",
    "the factor @xmath246 arises from counting components rather than vertices . ) since the hypergraph is subcritical , for any @xmath247 tending to infinity , the expected number of components with at least @xmath247 vertices is @xmath11 , as is the expected number of non - tree components .",
    "since @xmath248 converges , it follows that the expectation @xmath249 of the number of components satisfies @xmath250 . on the other hand , adding edges one - by - one , the expected number of edges forming cycles is small , and when an edge does not form a cycle the number of components goes down by @xmath173 .",
    "there are @xmath251 edges , so @xmath252 .",
    "combining these expressions gives the result , noting that the final statement does not involve @xmath16 .",
    "we start with a trivial lower bound on the number @xmath168 of vertices in the largest component of the random hypergraph @xmath110 defined in section  [ sec_prob ] . throughout",
    ", @xmath12 is fixed .",
    "recall that @xmath253 where @xmath142 and @xmath143 . set @xmath254 ignoring the irrelevant rounding to integers .",
    "note for later that @xmath255 since @xmath256 .",
    "[ nocut ] let @xmath142 with @xmath143 , and define @xmath112 as in and @xmath257 as in . then @xmath258    noting that @xmath259 , say , for @xmath16 large enough , it is easy to see that if @xmath260 then there is a vertex cut @xmath0=a\\cup a^{{\\mathrm{c}}}$ ] with @xmath261 such that no hyperedge meets both @xmath48 and @xmath262 . for a given value of @xmath263 , considering only potential hyperedges with one vertex in @xmath48 and the others in @xmath262 ,",
    "the expected number of such cuts is crudely at most @xmath264 now @xmath265 . hence there is a constant @xmath266 such that for @xmath267 we have @xmath268 , say , and thus @xmath269 using @xmath270 and @xmath271 in the last two steps . on the other hand , since @xmath272 , for @xmath273 we still have @xmath274 and so @xmath275 if @xmath16 is large enough , recalling that @xmath142 .",
    "it follows easily that @xmath276 , so the probability that there is a cut as described is @xmath277 .",
    "we have shown that , up to a negligible error probability , the total size of all components with at most @xmath278 vertices is at most @xmath257 . in particular , there are no individual components with more than @xmath257 vertices other than the unique giant component .",
    "we shall now show that with high probability the giant component is the only component containing cycles .",
    "furthermore , it is extremely unlikely that there is a cycle in a component of size between around @xmath279 , say , and @xmath278 .",
    "set @xmath280 recall that we assume that @xmath143 .",
    "since @xmath281 is a decreasing function of @xmath86 for @xmath282 , it follows that @xmath283 hence @xmath284 and in particular , for @xmath16 large enough , @xmath285 .",
    "[ nocyc ] under the assumptions above , the probability that @xmath110 contains a non - tree component with at most @xmath286 vertices is @xmath138 .",
    "furthermore , if @xmath287 is the total number of edges in such components , then @xmath288=o(1)$ ] . finally , the probability that there is a non - tree component with more than @xmath286 but fewer than @xmath278 vertices is @xmath289 .",
    "we start with the second statement , which implies the first .",
    "we aim for simplicity rather than a strong bound . if a non - tree component has @xmath202 edges and @xmath290 vertices , then @xmath291 .",
    "hence @xmath292 .",
    "let @xmath293 be the number of @xmath290-element subsets @xmath294 of @xmath0 $ ] with the following properties : no edge of @xmath110 meets both @xmath294 and @xmath295 , and @xmath294 spans at least @xmath296 edges of @xmath110 .",
    "the vertex set of any non - tree component is such a set for some @xmath297 .",
    "hence the number of non - tree components of @xmath110 with at most @xmath286 vertices is at most @xmath298 suppose that @xmath299 and @xmath300 are ( not necessarily distinct ) edges of @xmath110 both in small non - tree components , with vertex sets @xmath301 and @xmath302 , say",
    ". then @xmath303 spans at least @xmath304 edges so ( since the @xmath303 are equal or disjoint ) , @xmath305 has the properties above . since a set of @xmath290 vertices spans ( very crudely ) at most @xmath306 edges",
    ", we thus have @xmath307    for @xmath308 let @xmath309 .",
    "very crudely , @xmath310 { \\leqslant}\\binom{n}{v } \\binom{\\binom{v}{r}}{k } p^k ( 1-p)^{pv\\binom{n - v}{r-1}},\\ ] ] where the last factor accounts for the fact that there are no edges consisting of one vertex in the component and @xmath173 vertices outside . using the very crude bound @xmath311 , and the slightly more careful bound @xmath312 together with the inequality @xmath313",
    ", it follows that @xmath314 & { \\leqslant}\\left(\\frac{en}{v}\\right)^v \\left(\\frac{e v^r}{k}\\right)^k p^k    \\exp\\left(-\\frac{pvn^{r-1}}{(r-1 ) ! } ( 1+o(v / n))\\right ) \\\\    & = \\frac{e^{v+k } n^v v^{rk}}{v^v k^k } d^k n^{-(r-1)k } ( r-1)!^k \\exp{\\bigl ( -dv + o(dv^2/n ) \\bigr)}.\\end{aligned}\\ ] ] since @xmath5 is constant and @xmath315 , for some constant @xmath316 depending only on @xmath5 we thus have @xmath310 { \\leqslant}b^k \\frac{n^{v-(r-1)k}}{k^{v-(r-1)k } } d^k \\exp(-dv+o(dv^2/n)).\\ ] ] recall ( from ) that @xmath317 . for @xmath16 large enough , in the range @xmath308 we thus have @xmath318 { \\leqslant}b^k \\frac{n^{v-(r-1)k}}{k^{v-(r-1)k } } d^k \\exp(-dv/2).\\ ] ] since @xmath319 ,",
    "if @xmath290 is not a multiple of @xmath173 , then replacing @xmath320 by @xmath321 in the right - hand side of can only increase it , so @xmath310 { \\leqslant}b^{v/(r-1)}d^{v/(r-1 ) } \\exp(-dv/2 ) = ( ( bd)^{1/(r-1 ) } e^{-d/2})^v { \\leqslant}e^{-dv/4}\\ ] ] if @xmath16 is large enough .",
    "then @xmath322   { \\leqslant}\\sum_{v = r}^\\infty v^{2r } e^{-dv/4 } \\sim r^{2r } e^{-dr/4 } \\to 0,\\ ] ] and the bound on @xmath288 $ ] follows .    for the final statement , simply note that @xmath323 { \\leqslant}\\sum_{v = s_0}^\\infty   e^{-dv/4 } \\sim e^{-ds_0/4 } = o(n^{-100})\\ ] ] by choice of @xmath286 , and apply lemma  [ nocut ] to deal with sizes between @xmath257 and @xmath278 .",
    "let @xmath324 denote the number of components of @xmath110 that are trees with @xmath202 edges , and so @xmath201 vertices .",
    "then @xmath325 is the number of vertices in such components .",
    "we already know that with very high probability there are no components with more than @xmath257 vertices other than the giant component ; we shall see that with very high probability there are no tree components with more than @xmath286 vertices .",
    "recalling our convention of writing @xmath201 , set @xmath326 ignoring the rounding to integers .",
    "[ letk ] for @xmath327 we have @xmath328   = n\\frac{\\pi_k}{s}(1+o(d^2s^2/n)),\\ ] ] while the expected number of tree components with between @xmath286 and @xmath278 vertices is @xmath289 .",
    "let @xmath203 and set @xmath201 .",
    "we assume throughout the rather weak bound @xmath329 ; lemma  [ nocut ] implies that the expected number of tree components with between @xmath257 and @xmath278 vertices is @xmath289 . by a result of selivanov  @xcite",
    "( see also  @xcite ) , there are exactly @xmath330 @xmath202-edge @xmath5-trees on a given set of @xmath15 vertices .",
    "clearly , @xmath328",
    "= \\binom{n}{s } n_k p^k ( 1-p)^{\\binom{n}{r}-\\binom{n - s}{r}+k}.\\ ] ] since @xmath331 , we have @xmath332 recalling that @xmath333 , it follows that @xmath334   = \\frac{n^{s-(r-1)k } s^{k-2}}{k ! }",
    "d^k ( 1-p)^{\\binom{n}{r}-\\binom{n - s}{r}+k } \\exp(o(s^2/n)).\\ ] ]    now @xmath335 .",
    "since @xmath336 , we thus have @xmath337 as @xmath338 , we have @xmath339 .",
    "thus @xmath340 where in the second step we used again the definition @xmath333 , and in the last step we bounded @xmath341 by @xmath226 just to keep the formula compact . since @xmath342 , combining and we obtain @xmath343 = n \\frac{s^{k-2}d^k}{k!}\\exp(-ds + o(d^2s^2/n ) ) = n\\frac{\\pi_k}{s } \\exp(o(d^2s^2/n)),\\ ] ] using lemma  [ pkbd ] in the last step .",
    "for @xmath344 we have @xmath345 , so we may write the @xmath346 error term as @xmath347 , giving the result .    for @xmath348 ,",
    "from , corollary  [ decay ] and the bound @xmath349 ( see ) , we have @xmath328 { \\leqslant}n\\exp(-ds/2+o(d^2s^2/n ) ) { \\leqslant}n\\exp(-ds/4)\\ ] ] if @xmath16 is large enough .",
    "since @xmath350 , this completes the proof .",
    "[ csmall ] with probability @xmath351 the hypergraph @xmath110 consists of a ` giant ' component with at least @xmath352 vertices together with ` small ' components , each with at most @xmath286 vertices .",
    "immediate from lemmas  [ nocut ] , [ nocyc ] and [ letk ] .",
    "as in the previous section , fix @xmath12 , let @xmath142 with @xmath143 , as in , and set @xmath353 .",
    "define @xmath148 by , recalling that @xmath354 as @xmath124 .",
    "let @xmath168 and @xmath169 denote the numbers of vertices and edges in the largest component of the random hypergraph @xmath110 , chosen according to any rule if there is tie .",
    "( with high probability there will not be a tie . )",
    "[ el1 ] under the assumptions above we have @xmath355 = n(1-\\xi ) + o(1)\\ ] ] and @xmath356 \\sim \\mu_0 = ne^{-d}.\\ ] ]    recall that @xmath357 is roughly the expected number of isolated vertices in @xmath110 .",
    "since @xmath354 , the lemma says that isolated vertices give the dominant contribution to @xmath358 $ ] , and ( roughly speaking ) that the poisson - type distribution of the number of isolated vertices is the dominant contribution to @xmath359 $ ] .",
    "the bound @xmath158=n-\\mu_0+o(\\mu_0)$ ] will not be precise enough when we come to apply our local limit theorem ; we need a bound with an error that is @xmath360 .",
    "let @xmath361 and @xmath362 denote the number of vertices in small tree and cyclic components , respectively , where ` small ' means with at most @xmath286 vertices . by corollary  [ csmall ] , with probability @xmath351",
    "we have @xmath363 since all relevant quantities are bounded by @xmath16 , it follows easily that @xmath364 = n - { { \\mathbb e}}[v_t ] - { { \\mathbb e}}[v_c ] + o(n^{-97 } ) = n-{{\\mathbb e}}[v_t ] + o(1),\\ ] ] using lemma  [ nocyc ] .",
    "now @xmath365 where @xmath366 is the number of @xmath202-edge tree components , we write @xmath15 for @xmath367 as usual , and @xmath368 .",
    "( we ignore the irrelevant rounding to integers . ) by lemma  [ letk ] , @xmath369 = \\sum_{k=0}^{k_0 } n \\pi_k ( 1+o(d^2s^2/n)).\\ ] ] now @xmath239 and , by corollary  [ decay ] , @xmath370 .",
    "hence @xmath371 also @xmath372 .",
    "it follows that @xmath373 = n \\sum_{k=0}^\\infty \\pi_k + o(d^2e^{-d } ) = n\\xi + o(1),\\ ] ] which , with proves the first statement of the lemma .    turning to the variance , from we have @xmath374 = { { \\mathrm{var}}}[v_t+v_c ] + o(1 ) = { { \\mathrm{var}}}[v_t ] + { { \\mathrm{var}}}[v_c ] + { { \\mathrm{cov}}}[v_c , v_t ] + o(1).\\ ] ]",
    "let @xmath375 denote the number of ordered pairs of distinct tree components where the first has @xmath202 edges and the second @xmath376 . writing @xmath201 and @xmath377 , and considering separately pairs of vertices in the same or distinct tree components , we have @xmath378 = { { \\mathbb e}}\\left[\\left(\\sum_{k=0}^{k_0 } st_k\\right)^2\\right ]   = \\sum_{k{\\leqslant}k_0 } s^2{{\\mathbb e}}[t_k ] + \\sum_{k , k'{\\leqslant}k_0 } ss'{{\\mathbb e}}[t_{k , k'}].\\ ] ] by lemma  [ letk ] again , @xmath379 = n\\sum_{k=0}^{k_0 } s\\pi_k ( 1+o(d^2s^2/n ) ) \\sim n\\pi_0 = \\mu_0,\\ ] ] using the rapid decrease of the @xmath238 for the last approximation . on the other hand , writing @xmath380 for the number of potential hyperedges that meet both a given set of @xmath15 vertices and a given disjoint set of @xmath381 vertices , we have @xmath382 = { { \\mathbb e}}[t_k ] { { \\mathbb e}}[t_k ' ] ( 1-p)^{-m_{s , s'}}.\\ ] ] since @xmath383 , @xmath384 , and @xmath385 for @xmath15 , @xmath386 , it follows that @xmath387 = s { { \\mathbb e}}[t_k]s ' { { \\mathbb e}}[t_k ' ] ( 1+o(dss'/n ) ) = n^2\\pi_k\\pi_{k'}(1+o(d^2(s+s')^2/n)),\\ ] ] by lemma  [ letk ] . arguing as for above , it follows that @xmath388 = n^2 \\sum_{k , k'{\\leqslant}k_0 } \\pi_k\\pi_{k ' } + o(n d^2e^{-2d } )",
    "\\\\   = n^2\\xi^2 + o(ne^{-d } )   = n^2\\xi^2+o(n\\xi).\\end{gathered}\\ ] ] indeed , from the rapid decay of @xmath238 as @xmath202 increases , the dominant contribution to the error term is from the case @xmath389 ; this contribution is @xmath390 .",
    "putting the pieces together , from , , , and the fact that @xmath391 , it follows that @xmath392 = { { \\mathbb e}}[v_t^2 ] - { { \\mathbb e}}[v_t]^2 = ( 1+o(1))\\mu_0 + n^2\\xi^2 + o(n\\xi ) - ( n\\xi+o(1))^2 \\\\   = ( 1+o(1))\\mu_0 . \\end{gathered}\\ ] ] it remains only to note that from lemma  [ nocyc ] we have @xmath393{\\leqslant}{{\\mathbb e}}[v_c^2 ] = o(1)$ ] and hence @xmath394{\\leqslant}({{\\mathrm{var}}}[v_c]{{\\mathrm{var}}}[v_t])^{1/2}=o(\\mu_0)$ ] .",
    "then , recalling , the result follows .",
    "[ em1 ] we have @xmath395 = \\frac{d(1-\\xi^r)}{r } n + o(d).\\ ] ]    calling a component ` small ' if it has at most @xmath286 vertices , let @xmath396 be the number of edges in small tree components and @xmath397 the number in small cyclic components .",
    "by corollary  [ csmall ] , with probability @xmath351 we have @xmath398 since @xmath399=p\\binom{n}{r } = nd / r+o(d)$ ] , it follows that @xmath400 = dn / r - { { \\mathbb e}}[e_t ] - { { \\mathbb e}}[e_c ] + o(d).\\ ] ] now @xmath401{\\leqslant}{{\\mathbb e}}[e_c^2 ] = o(1)\\ ] ] by lemma  [ nocyc ] . on the other hand , writing @xmath201 as usual , and setting @xmath368 , @xmath402 = \\sum_{k=1}^{k_0 } k { { \\mathbb e}}[t_k ] = \\sum_{k=0}^{k_0 } \\frac{kn}{s } \\pi_k(1+o(d^2s^2/n)),\\ ] ] by lemma  [ letk ] . using corollary  [ decay ] as before to bound both the tail of the sum and the contribution from the @xmath403 term ( see  )",
    ", it follows that @xmath404 = n \\sum_{k=0}^\\infty \\frac{(r-1)k}{s } \\pi_k + o(1 ) \\\\",
    "= n \\sum_{k=0}^\\infty \\frac{s-1}{s } \\pi_k + o(1 ) = { \\bigl ( \\xi   -{{\\mathbb e}}[|{\\mathfrak{x}}_{r , d}|^{-1 } ] \\bigr)}n + o(1),\\end{gathered}\\ ] ] since @xmath405 .",
    "recall from section  [ sec_dual ] that the conditional distribution of @xmath176 given that it is finite is exactly the distribution of @xmath406 , where @xmath407 is the dual parameter , as in .",
    "it follows by lemma  [ negmo ] that @xmath408 = { { \\mathbb p}}(|{\\mathfrak{x}}_{r , d}|<\\infty ) { { \\mathbb e}}[|{\\mathfrak{x}}_{r , d^*}^{-1}| ] = \\xi ( 1-(r-1)d^*/r).\\ ] ] thus @xmath409 = \\frac{\\xi - { { \\mathbb e}}[|{\\mathfrak{x}}_{r , d}|^{-1}]}{r-1}n   + o(1 ) = \\frac{\\xi d^*}{r}n + o(1).\\ ] ] from , and we have @xmath395 = \\frac{d-\\xi d^*}{r }",
    "n + o(d ) = \\frac{d(1-\\xi^r)}{r } n + o(d),\\ ] ] completing the proof",
    ".    [ vm1 ] we have @xmath410 \\sim \\frac{dn}{r}.\\ ] ]    clearly , @xmath411",
    "= \\binom{n}{r}p(1-p ) \\sim p\\binom{n}{r } \\sim \\frac{dn}{r}$ ] .",
    "define @xmath396 and @xmath397 as in the proof of lemma  [ em1 ] .",
    "we claim that @xmath412 = o(dn).\\ ] ] let us first show that this implies the result .",
    "indeed , from lemma  [ nocyc ] we have @xmath413{\\leqslant}{{\\mathbb e}}[e_c^2]=o(1)=o(dn)$ ] .",
    "hence @xmath414=o(dn)$ ] , and from it easily follows that @xmath415\\sim \\frac{dn}{r}$ ] . to establish we argue as in the proof of , using @xmath416 in place of @xmath417 .",
    "the argument is essentially identical , leading to the conclusion @xmath418 = { { \\mathbb e}}[e_t ] + o(n\\xi)$ ] .",
    "since @xmath70 and @xmath194 are @xmath138 , from we have @xmath419=o(n)$].hence @xmath418 = o(n)=o(dn)$ ] .",
    "in this section we prove theorem  [ thllt ] . this will require some further preparation .    let @xmath113 satisfy @xmath124 and @xmath143 as @xmath2 . note that by , @xmath420 .",
    "later , in various error terms we shall consider a function @xmath421 tending to zero slowly : pick @xmath422 such that @xmath423 as @xmath2 .",
    "as before , let @xmath424 .",
    "set @xmath425 , and choose @xmath426 so that @xmath427 where @xmath428 .",
    "note that @xmath429 since @xmath430 , we have @xmath431    let @xmath432 and @xmath433 be independent random hypergraphs on the same vertex set @xmath0 $ ] , with @xmath434 having the distribution of @xmath435 .",
    "clearly , @xmath436 has the distribution of @xmath110 .",
    "we shall call the edges of @xmath432 _ red _ and those of @xmath433 _",
    "blue_. note that there may be a red and a blue edge on the same set of @xmath5 vertices .",
    "the idea of the proof is as follows : we shall reveal the graph @xmath432 and some partial information about @xmath433 .",
    "we write the pair @xmath151 as @xmath437 where @xmath438 is determined by the revealed information , and the conditional distribution of @xmath439 is with very high probability a fixed , very simple distribution . the latter distribution ( essentially two independent binomial random variables )",
    "will satisfy a local limit theorem .",
    "we will also have @xmath440\\sim { { \\mathrm{var}}}[l_1]$ ] and @xmath441\\sim { { \\mathrm{var}}}[m_1]$ ] .",
    "this will easily imply that @xmath442 and @xmath443 are concentrated on the relevant scales , allowing us to transfer the local limit theorem to @xmath151 .",
    "related smoothing ideas were used in @xcite , though in a much more complicated way  there , part of the starting point was a central limit theorem .",
    "here we do not need this , since our ` smoothing distribution ' @xmath439 has asymptotically the entire variance of the original distribution .",
    "roughly speaking , the partial information will be as follows : we reveal @xmath432 and find with very high probability a very large connected component .",
    "we reveal all edges of @xmath433 except those of the following form : ones within the giant component of @xmath432 ( ` internal edges ' below ) , and ones consisting of @xmath173 vertices in this giant component and one vertex that is otherwise isolated ( ` peripheral edges ' ) .",
    "then @xmath287 and @xmath444 will be , roughly speaking , the numbers of peripheral and internal edges present . to obtain fixed distributions for @xmath287 and @xmath444 we work with a subset of the giant component of @xmath432 of a fixed size @xmath445 , and a fixed number @xmath210 of vertices outside on which we allow peripheral edges .",
    "we will need to show that with very high probability @xmath446 , and that there are enough of these outside vertices .    turning to the details , note that since @xmath447 we have @xmath448 , so @xmath449 by analogy with , but replacing @xmath86 by @xmath450 , define @xmath451 and set @xmath452 let @xmath453 be the ` good ' event @xmath454 by lemma  [ nocut ] , applied with @xmath450 in place of @xmath86 , we have @xmath455 whenever @xmath453 holds , let @xmath456 be a set of @xmath445 vertices from the largest component of @xmath432 , say the first @xmath445 in numerical order .",
    "when @xmath453 does not hold , we take @xmath457 .",
    "( this is just so that @xmath316 is always defined ; we will never use @xmath316 in this case . )",
    "let @xmath458 be the event that @xmath459 , say . since , crudely , @xmath460=p_1\\binom{n}{r}=o(n\\log n)$ ] , and @xmath461 has a binomial distribution , we certainly have @xmath462 set @xmath463 when @xmath464 holds , we select a set @xmath465 of @xmath5-element subsets of @xmath316 , none of which",
    "is an edge of @xmath432 , with @xmath466 .",
    "when @xmath464 does not hold , set @xmath467 .",
    "we call an edge @xmath299 of @xmath433 _ internal _ if @xmath468 .    as a first step towards defining ` peripheral ' edges ,",
    "let us call a vertex @xmath469 _ peripheral _ if either @xmath290 is isolated in @xmath141 , or @xmath290 is in precisely one edge @xmath299 , and that edge @xmath299 is blue and consists of @xmath290 together with @xmath173 vertices in @xmath316 .",
    "let @xmath470 be the set of peripheral vertices .",
    "let @xmath471 let @xmath472 be the event @xmath473 and set @xmath474 when @xmath475 holds , let @xmath476 consist of the first @xmath210 vertices in @xmath470 in some arbitrary order ; otherwise , set @xmath477 .",
    "we call an edge @xmath299 of @xmath433 _ peripheral _ if it consists of one vertex in @xmath476 and @xmath173 vertices in @xmath316 .",
    "given the pair @xmath478 , let @xmath479 be the set of internal blue edges , and let @xmath480 be the set of peripheral blue edges .",
    "@xmath481    define the _ reduced ( blue ) hypergraph _ to be @xmath482 and let @xmath483 ; see figure  [ figr ] .",
    "note that any @xmath484 is isolated in @xmath485 .",
    "we shall condition on the pair @xmath486 .",
    "[ rreadoff ] a key point is that we can determine @xmath316 , @xmath465 , @xmath470 and @xmath476 , and hence whether @xmath475 holds , knowing only the reduced graph @xmath486 , without knowing the original value of @xmath433 . for @xmath316 and @xmath465",
    "this is immediate ; they are defined in terms of the red graph @xmath432 . with @xmath432 and hence @xmath316 fixed , for any possible value @xmath487 of @xmath433 , let us temporarily write @xmath488 for the set of peripheral vertices in @xmath489 .",
    "thus @xmath490 if and only if @xmath290 is isolated in @xmath432 , is in at most one edge of @xmath487 of the form @xmath491 with @xmath492 , and is in no other edges of @xmath487 .",
    "the key observation is that deleting internal or peripheral blue edges does not change @xmath493 .",
    "thus @xmath494 is a function of @xmath432 and @xmath485 as claimed . since @xmath476 is defined in terms of @xmath470 only , @xmath476 is also a function of @xmath432 and @xmath485 .",
    "[ adds ] if @xmath16 is large enough , then whenever @xmath475 holds we have @xmath495 for some quantities @xmath442 , @xmath443 that are functions of @xmath486 .    recall that @xmath496 .",
    "when @xmath475 holds , then @xmath316 is a set of @xmath445 vertices all within the same component of @xmath432 .",
    "let @xmath497 be the component of @xmath483 containing this component .",
    "then @xmath498 if @xmath16 is large enough , so @xmath497 is certainly a subset of the largest component @xmath499 of @xmath436 .",
    "furthermore , each edge of @xmath479 lies entirely within @xmath497 , and each edge in @xmath480 connects a distinct isolated vertex of @xmath500 to @xmath497 , so we have @xmath501 and @xmath502 .",
    "since @xmath503 , we have @xmath504 this estimate will be useful in the proofs of the next two lemmas .",
    "recall from remark  [ rreadoff ] that knowing the reduced graph @xmath486 determines @xmath316 , @xmath465 , @xmath470 and @xmath476 , and hence also whether or not @xmath475 holds .",
    "[ cdist ] whenever @xmath475 holds , the conditional distributions of @xmath505 and @xmath506 given @xmath486 are independent , with @xmath507 where @xmath508    given @xmath486 it is easy to identify the possible values of the pair @xmath509 . indeed , as noted above the pair @xmath486 determines @xmath316 , @xmath465 and hence @xmath470 and @xmath476 .",
    "when @xmath475 holds , then @xmath510 , @xmath466 , @xmath511 , and @xmath476 and @xmath316 are disjoint .",
    "now @xmath479 must be a subset of @xmath465 , and any subset is possible .",
    "a peripheral blue edge must consist of a vertex of @xmath476 and @xmath173 vertices of @xmath316 , and any set of such edges including each vertex of @xmath476 at most once is a possibility for @xmath480 .",
    "in other words , to obtain a possible value of @xmath433 , given @xmath486 , starting from @xmath485 we must    \\(a ) for each edge @xmath468 , either add it or not , and    \\(b ) for each vertex @xmath484 , either add one of the @xmath512 edges consisting of @xmath290 and @xmath173 vertices from @xmath316 or not .    since all combinations are possible , and the probability of a possible value @xmath141 of @xmath433 is proportional to @xmath513 to the power of the number of edges , we see that in describing the conditional distribution of @xmath433 given @xmath486 , all these choices are independent .",
    "furthermore , in ( a ) each edge is included with probability @xmath514 , and in ( b ) the probability of including an edge is @xmath515 as defined above .",
    "this implies the claimed formulae , with the asymptotic estimate for @xmath515 following from .    our `",
    "smoothing random variables ' will be essentially @xmath506 and @xmath505 .",
    "for later , it will be convenient to ` cook ' these random variables when @xmath475 does not hold , so that they _ always _ have the conditional distribution defined above .",
    "more precisely , let @xmath516 be independent of each other and of @xmath486 .",
    "set @xmath517 where @xmath47 denotes the indicator function of an event @xmath48 .",
    "the only properties of @xmath439 we shall need are the following .",
    "[ xy ] the random variables @xmath486 and @xmath439 are independent , with @xmath439 having the distribution of a pair of independent binomial random variables @xmath518 and @xmath519 . moreover ,",
    "if @xmath16 is large enough , then whenever @xmath475 holds we have @xmath520 for some quantities @xmath442 , @xmath443 that are functions of @xmath486 .",
    "to prove the first statement we must show exactly that the conditional distribution of @xmath439 given @xmath486 is always that of the given independent binomial distributions .",
    "this follows immediately from the definition of @xmath287 and @xmath444 and lemma  [ cdist ] ( applied only when @xmath475 holds ) .",
    "the second statement follows immediately from and lemma  [ adds ] .",
    "we have already shown that the events @xmath453 and @xmath458 are very likely to hold .",
    "we now show the same for the event @xmath521 that there are at least @xmath522 peripheral vertices .",
    "[ lcg3 ] we have @xmath523 .    the probability that a given vertex is isolated in @xmath432 is @xmath524 . recalling that @xmath525 , since @xmath526 and @xmath527 , we have ( crudely ) @xmath528 since @xmath529 , from .",
    "let @xmath530 be the set of isolated vertices of @xmath432 .",
    "then @xmath531=ne^{-d_1}(1+o(\\gamma))$ ] . since @xmath460 = n d_1/r { \\leqslant}n\\log n$ ] , say , it is not hard to see that @xmath532 - n^{0.51 } \\bigr ) } = o(n^{-100}),\\ ] ] say .",
    "for example , one approach is to consider a variant of the model @xmath533 in which we add uniformly random edges one - by - one , and apply the hoeffding  azuma inequality in this model ; we omit the details . recalling",
    ", we see that with probability @xmath534 we have @xmath535 { \\geqslant}n e^{-d_1 } ( 1-o(\\gamma)),\\ ] ] say .    for the rest of the proof we condition on @xmath432 , which determines @xmath530 and @xmath316 ; we assume , as we may , that the event @xmath453 and inequality hold . since @xmath453 holds , the sets @xmath530 and @xmath316 are disjoint .",
    "call a possible ( blue ) edge _ acceptable _ if it consists of one vertex of @xmath530 and @xmath173 vertices of @xmath316 .",
    "we call any other possible edge meeting @xmath530 _ annoying_. it remains to show that with very high probability there are at least @xmath210 vertices @xmath536 such that @xmath290 is in no annoying blue edges and @xmath290 is in at most one acceptable blue edge .",
    "indeed , when @xmath453 holds , then @xmath470 consists precisely of the set of such @xmath536 .",
    "we first consider annoying edges .",
    "there are at most @xmath537 possible edges that are annoying .",
    "each is present in @xmath433 independently with probability @xmath514 . by , @xmath538 ,",
    "so if @xmath16 is large enough we have @xmath539 recalling and , we have @xmath540 .",
    "it follows by a chernoff bound that with probability at least @xmath541 the actual number of annoying blue edges is at most @xmath542 .",
    "we condition on the set of annoying edges present in @xmath433 , assuming there are at most @xmath542 of them .",
    "let @xmath543 be the set of vertices of @xmath530 not in any annoying blue edges , so @xmath544 a vertex @xmath545 is in @xmath470 if and only if it is in at most one acceptable blue edge . noting that we have not yet tested the acceptable edges for their presence in @xmath433 , for a given vertex @xmath545 , this event has probability @xmath546 recall from that @xmath547 .",
    "since @xmath548 , it easily follows that @xmath549 since the sets of potential acceptable edges meeting different vertices in @xmath550 are disjoint , the events @xmath551 are ( conditionally ) independent for different @xmath545 , so the conditional distribution of @xmath552 is binomial @xmath553 .",
    "now by , and we have @xmath554 since @xmath555 is much larger than @xmath556 by , a chernoff bound shows that with ( conditional ) probability at least @xmath557 we have @xmath558 for @xmath16 large enough .",
    "thus @xmath559 , as claimed .",
    "[ ccg ] we have @xmath560 , where @xmath561 .",
    "immediate from , and lemma  [ lcg3 ] .    before turning to the proof of theorem  [ thllt ] we give a simple observation about local limit theorems .",
    "recall that a sequence @xmath130 of @xmath131-valued random variables satisfies a local limit theorem ( an llt ) with parameters @xmath132 and @xmath133 if , suppressing the dependence on @xmath16 , we have @xmath562 where @xmath563 we make some simple observations about such results .    [ parshift ]",
    "if @xmath564 satisfies an llt with parameters @xmath132 and @xmath133 , then it also satisfies an llt with parameters @xmath565 and @xmath566 whenever @xmath567 , @xmath568 , @xmath569 and @xmath570 .",
    "this is a standard result ; we omit the proof which is just calculation .",
    "[ smalloff ] suppose that @xmath564 satisfies an llt with parameters @xmath132 and @xmath133 .",
    "suppose also that @xmath571 is independent of @xmath564 , and that @xmath572 = o(\\sigma_x^2)\\hbox{\\quad and\\quad } { { \\mathrm{var}}}[b_n ] = o(\\sigma_y^2).\\ ] ] then @xmath573 satisfies an llt with parameters @xmath574+\\mu_x(n),{{\\mathbb e}}[b_n]+\\mu_y(n))$ ] and @xmath133 .",
    "this is a simple consequence of the fact that @xmath575 and @xmath576 are concentrated on the relevant scales , namely @xmath577 and @xmath578 , together with the fact that @xmath579 is lipschitz as a function of @xmath580 ( with constant @xmath581 ) .",
    "indeed , we may write @xmath582 \\\\   =   { { \\mathbb e}}_{a_n , b_n}\\bigl[f_n(x - a_n-\\mu_x , y - b_n-\\mu_y)\\bigr ] + o(1/(\\sigma_x\\sigma_y)),\\end{gathered}\\ ] ] where @xmath583 is defined as in and in the second step we applied the llt for @xmath564 . since @xmath584| ] { \\leqslant}\\sqrt{{{\\mathrm{var}}}{a_n } } = o(\\sigma_x)$ ] and similarly @xmath585| ] = o(\\sigma_y)$ ] , the result follows from the lipschitz property of @xmath586 .    as in theorem",
    "[ thllt ] , set @xmath587 most of the time we shall suppress the dependence on @xmath16 in the notation .",
    "the final ingredient in our proof is that the ` cooked ' versions @xmath287 and @xmath444 of the numbers @xmath480 and @xmath479 of peripheral and internal blue edges satisfy an llt .",
    "[ epillt ] the random variables @xmath588 and @xmath589 defined in satisfy a local limit theorem with parameters @xmath590,{{\\mathbb e}}[y])$ ] and @xmath153 .    by lemma",
    "[ xy ] , @xmath287 and @xmath444 are independent of each other , and have binomial distributions @xmath518 and @xmath519 . recalling and we have @xmath591 = i \\pi ( 1-\\pi ) \\sim i ( 1-\\pi ) \\sim i / d_2 \\sim n e^{-d } = \\sigma_l^2.\\ ] ] also , from , @xmath592 = { s}p_2 ( 1-p_2 ) \\sim { s}p_2 \\sim \\frac{n^r}{r ! } d_2 \\frac{(r-1)!}{n^{r-1 } } = \\frac{d_2n}{r }   \\sim \\frac{dn}{r } = \\sigma_m^2.\\ ] ] it is well known ( and easy to verify , for example from the formula for a binomial coefficient ) that a sequence of binomial random variables @xmath593 with @xmath594 satisfies a univariate local limit theorem with parameters @xmath595 and @xmath596 .",
    "this statement extends in an obvious way to a pair of independent binomial random variables ; this extension , and lemma  [ parshift ] , give the result .",
    "we now have all the pieces in place to prove our local limit theorem .",
    "we have already proved the estimates and for the mean and variance of @xmath145 and @xmath146 in lemmas  [ el1 ] , [ em1 ] and  [ vm1 ] .",
    "it remains to prove the local limit theorem .",
    "set @xmath597 where @xmath287 and @xmath444 are defined in and @xmath442 and @xmath443 are as in lemma  [ xy ] . by that lemma",
    "we have @xmath598 and @xmath599 whenever @xmath475 holds . by corollary  [ ccg ]",
    "we have @xmath600 .",
    "it thus suffices to show that @xmath601 satisfies a bivariate local limit theorem with parameters @xmath602,{{\\mathbb e}}[m_1^*])$ ] for the means and @xmath153 for the variances .",
    "furthermore , since @xmath603 , setting @xmath604 , this is equivalent to showing that @xmath605 satisfies a local limit theorem with parameters @xmath602,{{\\mathbb e}}[{\\tilde{m}}_1])$ ] and @xmath153 .    by lemma  [ xy ]",
    ", @xmath439 is independent of @xmath486 .",
    "since @xmath442 and @xmath443 are determined by @xmath432 and @xmath485 , we see that @xmath439 is independent of @xmath438 , and hence of @xmath606 .",
    "now @xmath607 with the summands independent . since @xmath608 with probability @xmath534 , we have @xmath609\\sim { { \\mathrm{var}}}[l_1]\\sim ne^{-d } = \\sigma_l^2,\\ ] ] by lemma  [ el1 ] .",
    "similarly , @xmath610\\sim { { \\mathrm{var}}}[m_1]\\sim dn / r=\\sigma_m^2 $ ] by lemma  [ vm1 ] . since @xmath611 it follows that @xmath612 \\sim \\sigma_m^2.\\ ] ] from and we have @xmath613 \\sim \\sigma_l^2 \\hbox{\\quad and\\quad } { { \\mathrm{var}}}[y]\\sim \\sigma_m^2.\\ ] ] from the independence in , we have @xmath614={{\\mathrm{var}}}[l]+{{\\mathrm{var}}}[x]$ ] , which implies @xmath615=o(\\sigma_l^2)$ ] . similarly , @xmath616=o(\\sigma_m^2)$ ] .",
    "the result now follows from lemma  [ epillt ] , the independence in , and lemma  [ smalloff ] .",
    "our aim in this section is to deduce our enumerative result , theorem  [ thenum ] , from the probabilistic one , theorem  [ thllt ] .",
    "we start with a lemma giving the asymptotic behaviour of the quantity @xmath617 appearing in theorem  [ thenum ] .",
    "recall that for @xmath6 we define a function @xmath27 on @xmath34 by @xmath618 and that @xmath27 is a decreasing bijection between @xmath34 and @xmath35 . if @xmath6 then @xmath619 recall also that @xmath103 is then defined by with @xmath79 .",
    "[ asy ] fix @xmath6 . for @xmath620",
    "let @xmath621 .",
    "then as @xmath56 we have @xmath622 and @xmath623 for @xmath52 , we have @xmath624 and @xmath625 .    since @xmath27 is a decreasing bijection from @xmath34 to @xmath35 , as @xmath56 we have @xmath626 .",
    "hence from we have @xmath627 thus @xmath628 from , for @xmath6 we have @xmath629 since @xmath630 as @xmath56 , we may write the error term as @xmath631 . substituting in",
    ", it follows that @xmath632 substituting in gives . we omit the ( similar ) calculations for @xmath52 .",
    "recall that we write @xmath13 for the number of connected @xmath5-uniform hypergraphs on @xmath14 $ ] , and @xmath43 for the probability that an @xmath1-edge @xmath5-uniform hypergraph on @xmath14 $ ] chosen uniformly at random is connected . clearly , @xmath50 , where @xmath49 . thus the asymptotic formulae and for @xmath43 and @xmath13 are equivalent modulo a calculation , which we now carry out .",
    "[ lpc ] let @xmath12 and let @xmath633 . if @xmath6 then @xmath634 as @xmath40 , where @xmath41 .",
    "if @xmath52 , then @xmath635    let @xmath636 since @xmath637 , we have @xmath638 since @xmath639 , if @xmath6 then @xmath640 .",
    "thus @xmath641 , giving .    for",
    ", suppose that @xmath52",
    ". then @xmath642 and @xmath643 . since @xmath644 and @xmath645 are @xmath138 , and @xmath646 , we have @xmath647 and follows .",
    "we are finally ready to deduce theorem  [ thenum ] from theorem  [ thllt ] .    throughout , we consider a function @xmath39 with @xmath24 ; all asymptotics are as @xmath40 .",
    "much of the time we suppress the dependence on @xmath15 in the notation .",
    "we write @xmath648 for the average degree of an @xmath5-uniform hypergraph with @xmath15 vertices and @xmath1 edges .",
    "let us first deal with a simple case : when @xmath649 is bounded above . passing to a subsequence",
    ", we may assume that either ( i ) @xmath650 for some constant @xmath651 , or ( ii ) @xmath652 . let @xmath42 be a hypergraph on @xmath14 $ ] with @xmath1 edges , chosen uniformly at random from all such hypergraphs .",
    "let @xmath653 denote the number of isolated vertices in @xmath42 . in case ( i ) , a simple calculation shows that @xmath654 = s \\binom{\\binom{s-1}{r}}{m } { \\binom{\\binom{s}{r}}{m}}^{-1 } \\to e^c.\\ ] ] ( this is to be expected , since the probability that a vertex is isolated is asymptotically @xmath59 . ) similarly , for any fixed @xmath202 the @xmath202th factorial moment satisfies @xmath655 = s(s-1)\\cdots ( s - k+1 ) \\binom{\\binom{s - k}{r}}{m } { \\binom{\\binom{s}{r}}{m}}^{-1 } \\to e^{kc}.\\ ] ] now by a standard result ( see , e.g. , theorem 1.22 in  @xcite ) it follows that @xmath653 converges in distribution to a poisson distribution with mean @xmath656 as @xmath40 , and in particular , that @xmath657 .",
    "a very simple argument counting cuts shows that in this range , with high probability @xmath42 has no component of size between @xmath658 and @xmath659 , so the probability @xmath43 that @xmath42 is connected satisfies @xmath660 since @xmath661 , we have @xmath662 , so by lemma  [ asy ] @xmath663 .",
    "thus we have @xmath664 , proving in this case . for case ( ii ) , it follows from the above and monotonicity that @xmath665 , which again agrees with . in both cases ( i ) and",
    "( ii ) , provided @xmath45 ( which assumes ) , relation follows immediately from and lemma  [ lpc ] .    in proving theorem  [ thenum ] , passing to a subsequence",
    ", we may assume either that @xmath649 is bounded above , or that @xmath666 .",
    "we have covered the first case above . from now on we thus assume that @xmath667 as @xmath40 .",
    "then @xmath668 , so by lemma  [ lpc ] either of and implies the other",
    ". we shall prove .",
    "when @xmath15 is large enough , we have @xmath36 ; we assume this from now on . then there is a unique solution @xmath669 to ,",
    "i.e. , to @xmath670 since @xmath56 as @xmath40 we have @xmath33 . set @xmath671 noting that @xmath672 .",
    "then @xmath70 and @xmath86 solve the equation   ( which is just rearranged ) .",
    "also , set @xmath673 the reason for these choices is that then we have @xmath674 and @xmath675 we would like to apply theorem  [ thllt ] with the parameters @xmath676 and @xmath86 just defined ; one trivial but annoying difficulty is that @xmath676 is not an integer .",
    "so set @xmath677 since @xmath678 , from , and the fact that @xmath679 we see that @xmath680    we next verify that @xmath16 and @xmath86 satisfy the assumptions of theorem  [ thllt ] , i.e. , that @xmath2 , and @xmath86 and @xmath143 .",
    "( the theorem assumes @xmath113 is defined for every @xmath16 , but there is no problem considering only a subsequence . ) certainly , @xmath681 as @xmath40 .",
    "we have already noted that @xmath682 . for the last condition , by and lemma  [ asy ] we have @xmath683 in particular ,",
    "@xmath684 since @xmath685 we thus have @xmath686 thus all conditions of theorem  [ thllt ] are satisfied .",
    "as in the statement of theorem  [ thllt ] , set @xmath687 in this section , @xmath86 and @xmath16 are functions of @xmath15 , so this defines a function @xmath688 ; as usual , we suppress the dependence on @xmath15 .",
    "let @xmath689 and @xmath690 , as in . under the assumptions of theorem  [ thllt ] ( which we have just verified ) we have @xmath691 and @xmath692 .",
    "hence , by and , the values @xmath15 and @xmath1 are within @xmath138 standard deviations of the expectations of the numbers @xmath168 and @xmath169 of vertices and edges in the largest component of the ( binomial ) random hypergraph @xmath110 .",
    "thus , by theorem  [ thllt ] , @xmath693    recalling that @xmath694 , for @xmath15 large enough we have @xmath695 , so the hypergraph @xmath110 can have at most one component with @xmath15 or more vertices . writing @xmath696 for the number of components with @xmath15 vertices and @xmath1 edges , we thus have @xmath697.\\ ] ] hence , by linearity of expectation , @xmath698 where @xmath699 is the number of possible hyperedges meeting a given set of @xmath15 vertices .    from and we see that @xmath700 the rest of the proof is ` just ' calculation , but this calculation is not so simple .",
    "a significant hindrance is that we would eventually like to work in terms of @xmath15 , @xmath1 , @xmath41 and the implicitly defined @xmath79 .",
    "the quantity @xmath701 is a simple function of these variables , but @xmath702 is not . morally speaking , rounding to @xmath16",
    "should make no difference , but showing this seems to require some work : because of the large exponents appearing in , the very small relative change of replacing @xmath16 by @xmath676 in the various factors in can change these factors by a large amount even though , as we shall see , it does not significantly change ( a suitably adapted form of ) the whole formula .",
    "the last factor in is perhaps the hardest to deal with ; fortunately , we can use a trick , relating it to a binomial probability . the key point ( established below )",
    "is that @xmath703 is rather close to @xmath1 .",
    "recall that , crudely , @xmath704 and , from lemma  [ asy ] and , that @xmath705 thus , @xmath706 using in the last step . turning to @xmath707 , recalling and that @xmath702 , we have the rather accurate bound @xmath708 we shall need this later , though often the simpler consequence @xmath709 will suffice .    since @xmath710 we have @xmath711 using in the last step .",
    "since @xmath712 and @xmath713 , we have @xmath714 . as the ` cross term '",
    "@xmath715 is of order @xmath716 , we thus have @xmath717    we shall need this accurate estimate later ; for the moment , something simpler suffices . from we",
    "have @xmath718 hence implies the cruder bound @xmath719 recalling the definition of @xmath112 , it follows that @xmath720 where the last step is from .",
    "now @xmath721 , while certainly @xmath722 and @xmath723 ( since @xmath724 and @xmath725 ) .",
    "it follows that the probability that a binomial random variable @xmath726 takes the value @xmath1 is asymptotically @xmath727 in other words , @xmath728 combining this with we see that @xmath729    from we have @xmath730 and @xmath731 . since @xmath694 and @xmath732 , we may simplify slightly to obtain @xmath733 this formula may appear appealingly concise , but unfortunately it still involves @xmath16 , defined in a slightly unpleasant way ( involving rounding ) , both directly and in the definition of @xmath443 .",
    "so we continue with our manipulations .",
    "firstly , note for later that , from , @xmath734 as @xmath40 we certainly have @xmath2 and @xmath735 ( see and ) , so by stirling s formula and the estimate @xmath736 we have @xmath737 since @xmath738 by , it follows from that @xmath739    now @xmath740 , while @xmath741 .",
    "since @xmath742 , for @xmath6 it follows that @xmath743 .",
    "hence @xmath744 for @xmath52 we have @xmath643 and @xmath745 , using and . arguing as for",
    ", it follows that @xmath746 since , in any case , @xmath747 , we have @xmath748 where in the second step we used that @xmath749 ( from ) and @xmath750 . also , since @xmath751 , we have @xmath752 combining these estimates with and , for @xmath6 we find that @xmath753 for @xmath52 we obtain the same formula with an extra factor of @xmath754 .",
    "we write the formulae in the rest of the proof for the case @xmath6 ; the remaining estimates apply just as well when @xmath52 , with the factor @xmath754 inserted where appropriate . from and , we see that @xmath755 we may rewrite this as @xmath756 and hence as @xmath757 where @xmath758 .",
    "we would like to replace @xmath580 by @xmath759 .",
    "first , we substitute @xmath760 , obtaining @xmath761 where @xmath762    set @xmath763 it is straightforward to check that @xmath764 as @xmath765 , and @xmath766 so @xmath767 we wish to compare @xmath768 with @xmath769 .",
    "from we have @xmath770 . hence we need only consider values of @xmath771 with @xmath772 . in this range ,",
    "@xmath773 recalling that @xmath774 . by lemma  [ asy ] , @xmath775 .",
    "hence @xmath776 where in the final step we used that @xmath777 .",
    "since @xmath778 it follows that @xmath779 this is exactly what we need to allow us to replace @xmath758 by @xmath780 in .    in conclusion ,",
    "writing @xmath69 , for @xmath6 we have @xmath781 where the last step is from .",
    "when @xmath52 we obtain the same formula with an extra factor of @xmath754 , from using in place of .",
    "this proves .    as noted above , follows from by lemma  [ lpc ] , so the proof is complete .",
    "in this appendix we briefly show that theorem  [ thuniv ] does indeed extend the asymptotic formula given by bender , canfield and mckay  @xcite .",
    "( it does not quite imply their result , since they have an explicit bound on the @xmath782 error term . )    writing @xmath783 for the probability that a random @xmath1-edge graph on @xmath14 $ ] is connected , bender , canfield and mckay showed that whenever @xmath39 satisfies @xmath784 and @xmath785 , then @xmath786 where @xmath787 , @xmath788 is defined implicitly by @xmath789 and @xmath790 here we have changed the notation to match ours , and have simplified the more precise error term given in  @xcite .",
    "note that in our notation @xmath580 is simply @xmath791 .",
    "similarly , writing @xmath800 ( defined in ) and @xmath801 and hence @xmath802 as a function of @xmath70 , using , for example , maple , one can verify that @xmath803 indeed , it turns out that @xmath804 @xmath805 and @xmath806 these combine to give @xmath807 as claimed . by and the @xmath52 case of the formula in theorem  [ thuniv ] does indeed match .",
    "t.  andriamampianina and v.  ravelomanana , enumeration of connected uniform hypergraphs , proceedings of 17th international conference on formal power series and algebraic combinatorics , taormina ( fpsac 2005 ) , ( 2005 ) pp .",
    "387398 .",
    "m.  behrisch , a.  coja - oghlan and m.  kang , local limit theorems for the giant component of random hypergraphs , _ combin .",
    "* 23 * ( 2014 ) , 331366 .",
    "m.  behrisch , a.  coja - oghlan and m.  kang , the asymptotic number of connected @xmath86-uniform hypergraphs , _ combin .",
    "* 23 * ( 2014 ) , 367385 , with a corrigendum _ combin .",
    "* 24 * ( 2015 ) , 373375 .",
    "bender , e.r .",
    "canfield and b.d .",
    "mckay , the asymptotic number of labeled connected graphs with a given number of vertices and edges , _ random struct .",
    "alg . _ * 1 * , 127169 ( 1990 ) ."
  ],
  "abstract_text": [
    "<S> in 1990 bender , canfield and mckay gave an asymptotic formula for the number of connected graphs on @xmath0=\\{1,2,\\ldots , n\\}$ ] with @xmath1 edges , whenever @xmath2 and @xmath3 . </S>",
    "<S> we give an asymptotic formula for the number @xmath4 of connected @xmath5-uniform hypergraphs on @xmath0 $ ] with @xmath1 edges , whenever @xmath6 is fixed and @xmath7 with @xmath8 , i.e. , the average degree tends to infinity . </S>",
    "<S> this complements recent results of behrisch , coja - oghlan and kang ( the case @xmath9 ) and the present authors ( the case @xmath10 , i.e. , ` nullity ' or ` excess ' @xmath11 ) . the proof is based on probabilistic methods , and in particular on a bivariate local limit theorem for the number of vertices and edges in the largest component of a certain random hypergraph . </S>",
    "<S> the arguments are much simpler than in the sparse case ; in particular , we can use ` smoothing ' techniques to directly prove the local limit theorem , without needing to first prove a central limit theorem . </S>"
  ]
}