{
  "article_text": [
    "it is known that in the fx world skew of the implied volatility of the fx options demonstrates some kind of stochastic behavior . for instance , @xcite report that for two currency pairs ( which are the u.s .",
    "dollar prices of the japanese yen and the british pound ) by analyzing the market implied volatilities of option series they find the slope of the smile to greatly vary over time .",
    "namely , the sign of the slope switches several times in the considered sample .",
    "therefore , although the risk - neutral distribution of the currency return exhibits persistent fat - tail behavior , the risk - neutral skewness of the distribution experiences strong time - variation which can be very positive or very negative on any given date .    to capture this effect when doing option pricing , new models are required because , as mentioned in @xcite , the jump - diffusion stochastic volatility models like that in @xcite , are able to capture the average shape of implied volatility smiles and the time - variation in their levels but can not generate strong time variation in the risk - neutral skewness of currency returns .",
    "we can mention at least two approaches that are used to attack this problem .",
    "the first one is proposed in @xcite where skew is modeled by separate the up jumps and the down jumps in spot .",
    "these jumps are modeled by two processes .",
    "the stochastic volatility and skewness are introduced by a separate time change in each component .",
    "the stochastic variation in the relative proportion of up and down jumps generates stochastic variation in the risk - neutral skewness of currency returns .",
    "the model is analytically tractable for pricing european vanilla options .",
    "however , as per @xcite it often requires jumps in spot that are much larger than those actually experienced .",
    "therefore , it can misprice barrier options if the probability of spot jumping through the barrier is significant also pricing of exotic options requires numerical methods , see e.g. , @xcite .",
    "another approach is to randomize those model parameters that govern the risk - neutral skewness . in jump - diffusion models they are the mean jump size and the correlation coefficient between the currency return and the stochastic variance process .",
    "the first parameter governs the risk - neutral skewness at short maturities , and the second one - at long maturities .",
    "therefore , in a set of papers the correlation between the spot and instantaneous variance is considered to be stochastic and driven by a separate stochastic process , see @xcite and references therein . moreover , in @xcite where a pricing problem is considered for basket equity options , the standard correlation model , which is based on the jacobi process , is extended by adding jumps in the correlation process .",
    "this is done based on the analysis of the market data for basket options which demonstrates that the jump to high level of correlation occurs after several down moves that drag the basket below some comfort zone of normality .",
    "the jumps are modeled in a simplified way by adding to the jacobi process a term proportional to @xmath0 with @xmath1 being a poisson process whose intensity depends on the basket performance and time .",
    "we mention two basic approaches to model the stochastic correlation @xmath2 .",
    "consider first only the diffusion processes . since by definition @xmath2",
    "is bounded in @xmath3 $ ] , the first approach would be to model it as a bounded diffusion .",
    "one of the popular choices is the jacobi process used , e.g. , in @xcite .",
    "however , this requires the process to be mean - reverting , while it is not obvious why the correlation should be mean - reverted .",
    "other bounded diffusions can also be used .",
    "this approach is tractable for european vanilla options , but not for the exotic options . because of that , in @xcite an analytical approximation for barrier and one - touch options",
    "is developed which is based on semi - static vega replication .",
    "it is shown that this approximation works well in markets where the risk neutral drift is modest .",
    "the second approach , @xcite , uses a transformation @xmath4 where @xmath5 is an arbitrary diffusion process ( perhaps driftless ) , and function @xmath6 transforms the support of the @xmath5 outcomes to @xmath3 $ ] .",
    "popular transformations are hyperbolic tangent , @xcite , normal cdf , @xcite , normalized inverse tangent , @xcite , etc . in principle , any continuous map @xmath7 $ ] can be used for this purpose , so the real choice becomes a matter of having some additional properties , e.g. , tractability , to be taken into account .",
    "also , despite this approach is a bit less intuitive , it opens the door to various sophisticated models of the stochastic correlations .",
    "one of such possible extensions would be a natural idea to consider the underlying process @xmath5 to be a jump - diffusion or a process .",
    "to the best of our knowledge , there is the only attempt to model correlation by introducing jumps which is presented in @xcite .",
    "however , this model is very simplistic and empirical .",
    "it is introduced based on the analysis of some market data on baskets of stocks , with an observation that the jump to high level of correlation might happen after several down moves that put the basket below some level of normality .",
    "therefore , when modeling these baskets using the stochastic correlation model , @xcite defines @xmath2 to follow the extended jacobi process @xmath8 hear @xmath9 are some constant model parameters , @xmath10 is the standard brownian motion , @xmath11 is the poisson jump process with the intensity @xmath12 given by the following expression @xmath13 where @xmath14 are constants , @xmath15 is the critical level defined as @xmath16 standard deviations of the basket performance @xmath17 @xmath18 here @xmath19 is the at - the - money volatility of the basket at time @xmath20 , and @xmath21 is the basket forward at time @xmath20 .",
    "so the jumps can occur if the basket performance @xmath17 hits the level @xmath22 at @xmath23 .",
    "otherwise , if @xmath24 is positive the jump does nt occur .",
    "the jump size @xmath25 in is chosen in such a way , that if the jump occurs , @xmath2 always jumps from @xmath26 to 1 ( full correlation ) .",
    "obviously , this model is empirical with a lot of parameters introduced , which financial meaning is not entirely transparent .",
    "therefore , calibration of such a model could be a hard issue .",
    "also the assumption that the jump always results in the full correlation to be reached immediately after the jump occurs , seems to not be justified at all .",
    "therefore , in this paper we utilize a different approach .",
    "we use a general models framework to introduce jumps , see e.g. , @xcite .",
    "since a general process is not bounded , we use a certain transformation as this is described in above , to bound it to @xmath3 $ ] .",
    "once this is done , we consider three stochastic processes : the spot , instantaneous variance and their correlation each driven by some process .",
    "we assume that the brownian components of each process are correlated , and the jump component are correlated similar to how this is done in @xcite .",
    "however , the brownian motions and the jump components remain uncorrelated .",
    "this model has a clear financial meaning , and can be calibrated in few steps .",
    "for instance , idiosyncratic components of jumps can be calibrated separately to the corresponding market ; the local volatility functions can be calibrated to a set of fx european vanilla options ; then stochastic volatility and correlation parameters ( the diffusion part ) of the model can be calibrated to fx exotic options which demonstrate a smile .",
    "finally , the common jumps parameters of the model can be calibrated to the implied volatility skew of the exotic options .",
    "this procedure runs in a loop until it converges .",
    "the main contribution of the paper consists in several results .",
    "first , a slv model for pricing exotic fx options which demonstrate the existence of stochastic skew is proposed which assumes the spot / inv correlation to be stochastic .",
    "moreover , the model also includes correlated jumps in each of the stochastic drivers .",
    "second , a new fully implicit finite - difference splitting scheme is proposed to solve a forward kolmogorov equation which is of second order in both temporal and each spatial dimension , is unconditionally stable and preserves both positivity and norm of the solution while complexity - wise is linear in the number of grid nodes in each spatial dimension .",
    "we also formulate and prove a theorem that the proposed discretization preserves the norm of the solution .",
    "the rest of the paper is organized as follows . in section  [",
    "sect : model ] we formulate the model which considers stochastic correlation of brownian drivers and deterministic correlation of jump processes . section  [ sectpide ] discusses the corresponding backward pide and boundary and initial conditions . in section",
    "[ sect : forward ] same consideration is given to the forward kolmogorov equation . in section  [",
    "sect : fd ] we introduce a new fully - implicit finite - difference scheme for this forward pide and analyze its properties .",
    "results of some numerical experiments obtained by using this scheme are provided in section  [ sect : numerics ] .",
    "an appendix provides a detailed derivation of the forward fd scheme .",
    "we consider an lsv model with stochastic spot / inv correlation and jumps by introducing stochastic dynamics for variables @xmath27 . here",
    "@xmath28 is the spot price , @xmath29 is the instantaneous variance , and @xmath30 in other words , the stochastic correlation @xmath2 is represented as @xmath31 . therefore , since @xmath32 , this map guarantees that @xmath33 $ ] .",
    "similar to @xcite , we consider a model where the stochastic sde for each variable @xmath27 includes both diffusion and jumps components , as follows : @xmath34 dt + \\xi_v v_t^a w_{v , t } + v_t dl_{v , t } , \\nonumber \\\\",
    "d r_t & = \\kappa_r(t)(\\theta_r(t ) - r_t ) dt + \\xi_r w_{r , t } + dl_{r , t } , \\nonumber\\end{aligned}\\ ] ] subject to the following initial conditions @xmath35 here @xmath36 are the domestic and foreign interest rates , @xmath20 is the time , @xmath37 is the local volatility function , @xmath38 are the correlated brownian motions , @xmath39 are the mean - reversion rate , mean - reversion level and volatility of volatility ( vol - of - vol ) for the instantaneous variance @xmath40 are the corresponding parameters for @xmath41 , @xmath42 are some constants ( power constants ) which are introduced to add an additional flexibility to the model as compared with the popular heston ( @xmath43 ) , lognormal ( @xmath44 ) and 3/2 ( @xmath45 ) models .",
    "as mentioned in @xcite , one has to be careful if she wants to determine these parameters by calibration .",
    "this is because having both the vol - of - vol and the power constant in the same diffusion term brings an ambiguity into the calibration procedure .",
    "however , it can be resolved if some additional financial instruments are used in calibration , e.g. , exotic option prices are combined with the variance swaps prices , see @xcite .    in the last equation of the drift term",
    "is introduced to be mean - reverting . however",
    ", this might not be necessary .",
    "therefore , when doing so we rely on calibration of the model to the market data . in other words , if the data exhibits mean - reversion , we expect the mean - reversion level @xmath46 , found by the calibration , to differ from zero . on",
    "contrary , if @xmath47 , there is no mean - reversion , and the sign of the drift term depends on the sign of @xmath48 .",
    "processes @xmath49 are pure discontinuous jump processes with generator @xmath50 @xmath51 with @xmath52 be a lvy measure , and @xmath53 at this stage , the jump measure @xmath54 is left unspecified , so all types of jumps including those with finite and infinite variation , and finite and infinite activity could be considered here .",
    "the last line of is a combination of the hull - white model , @xcite , for the diffusion component with a ( arithmetic ) levy process for the jump component . as such",
    ", this model allows both positive and negative values of @xmath41 .      below for a better transparency",
    "we consider three cases .",
    "[ [ no - jumps ] ] * no jumps * + + + + + + + + + +    consider first the case when there is no jumps in .",
    "then @xmath55 where we use the symbol @xmath56 to mark parameters and variables for a pure diffusion case .",
    "the last line in is explained in detail in @xcite .",
    "it means that @xmath57 = \\e \\left[\\int_0^t \\rhod_s ds\\right ]",
    "\\ne \\rhod_t t\\ ] ] as it would be if @xmath58 is constant .",
    "we assume that @xmath59 is constant , but not @xmath60 .",
    "indeed , the correlation matrix @xmath61 must be positive - semidefinite .",
    "this provides restrictions on , at least , one of the correlation coefficients @xmath62 .",
    "for instance , let us assume that @xmath63 $ ] and then , since also @xmath64 $ ] , the semi - definiteness is defined by the condition @xmath65 which is solved by @xmath66 these allowed values of @xmath59 are depicted in fig .",
    "[ fig1 ] .",
    "so the domain of definition of @xmath59 depends on @xmath58 , and since @xmath58 is stochastic , it also changes stochastically .",
    "therefore , @xmath59 can not be a constant .    to resolve this issue , following the idea of @xcite ,",
    "further we assume that @xmath67 .",
    "thus , the spot / correlation correlation is also stochastic , but driven by the @xmath58 process multiplied by a constant .",
    "this provides @xmath68 ) \\cup ( \\rhod_{vr } \\in [ -1,1]).\\ ] ]    [ [ pure - jump - processes ] ] * pure jump processes * + + + + + + + + + + + + + + + + + + + + +    it is known that models with jumps in the spot price better predict the observed market data , especially at short maturities .",
    "it is also known , that jumps in @xmath29 might also be needed .",
    "for instance , in @xcite exponential and discrete jumps are investigated in both @xmath28 and @xmath29 .",
    "the author concludes that infrequent negative jumps in @xmath29 are necessary to fit the market data on equity options .",
    "definitely , jumps in both spot and the instantaneous variance could be correlated",
    ". then it would be natural to extend this point and introduce the correlation between the jumps in @xmath2 and that in @xmath28 , as well as between jumps in @xmath2 and that in @xmath29 .",
    "for instance , @xcite considered the links between co - jumps within a group of large stocks , the volatility of , and correlation between their returns .",
    "they found that , despite the occurrence of common , or co - jumps between the stocks is unrelated to the level of volatility or correlation , both volatility and correlation are lower subsequent to a co - jump .",
    "therefore , it does make sense to consider jumps in the spot , instantaneous variance and their correlation to be fully correlated .",
    "in this paper we introduce these correlations as this is done in @xcite by following the approach of @xcite .",
    "they construct the jump process as a linear combination of two independent lvy processes representing the systematic factor and the idiosyncratic shock , respectively ( see also @xcite ) .",
    "it has an intuitive economic interpretation and retains nice tractability , as the multivariate characteristic function in this model is available in closed form based on the following proposition of @xcite :    [ propballotta ] let @xmath69 be independent lvy processes on a probability space @xmath70 , with characteristic functions @xmath71 and @xmath72 , for @xmath73 respectively .",
    "then , for @xmath74 @xmath75 is a lvy process on @xmath76 .",
    "the resulting characteristic function is @xmath77    by construction every factor @xmath78 includes a common factor @xmath79 .",
    "therefore , all components @xmath78 could jump together , and loading factors @xmath80 determine the magnitude ( intensity ) of the jump in @xmath81 due to the jump in @xmath79 .",
    "thus , all components of the multivariate lvy process @xmath82 are dependent , and their pairwise correlation is given by ( again see @xcite and references therein ) @xmath83 such a construction has multiple advantages , namely :    1 .   as @xmath84",
    ", both positive and negative correlations can be accommodated 2 .   in the limiting case @xmath85 or @xmath86 or @xmath87 the margins become independent , and @xmath88 .",
    "the other limit @xmath89 or @xmath90 represents a full positive correlation case , so @xmath91 .",
    "accordingly , @xmath92 represents a full negative correlation case as in this limit @xmath93 .",
    "if we want the jump correlations to be constant , then this setting is sufficient .",
    "however , since we want the correlation @xmath94 to be stochastic , this approach has to be modified . in this paper",
    "we do nt elaborate on it , and use the former one , so assuming that the correlation between jumps is constant .",
    "[ [ general - case ] ] * general case * + + + + + + + + + + + + + +    when the underlying processes have both the diffusion and jumps components , the correlation matrix can be build as a combination of two constructions presented in above .",
    "we assume that all brownian motions @xmath95 $ ] are independent of @xmath96 . in this setting the total instantaneous correlations read @xmath97 , \\nonumber\\end{aligned}\\ ] ] where @xmath98 are volatilities of the diffusion processes of @xmath99 , and @xmath100 are the idiosyncratic jump processes .",
    "with such a definition all correlations @xmath101 could take any value within the interval @xmath3 $ ] with no restrictions . as follows from @xmath102 is constant while @xmath103 are stochastic . if the second term in the numerator of @xmath104 in is much bigger that the first one , this correlation also is constant and determined by the correlation of jumps . if , on the contrary , the second term is small as compared with the first one , @xmath104 is stochastic and defined by the correlation of the brownian motions .",
    "a similar argument is valid for @xmath105 as well .",
    "to price contingent claims , e.g. , vanilla or exotic options written on the underlying spot price , a multidimensional ( backward ) pide could be derived by using a standard technique as in @xcite .",
    "it describes the evolution of the option price @xmath106 under risk - neutral measure and reads @xmath107v , \\ ] ] where @xmath108 is the backward time , @xmath109 is the time to the contract expiration , @xmath110 is the risk free interest rate , @xmath111 is the three - dimensional linear convection - diffusion operator of the form @xmath112 \\fp{}{v } + \\dfrac{1}{2 } \\xi_v^2 v^{2 a } \\sop{}{v } , \\nonumber\\end{aligned}\\ ] ] @xmath113 \\fp{}{r } + \\dfrac{1}{2 } \\xi_r^2 \\sop{}{r } , \\nonumber \\\\ f_0 & = \\left[\\tanh(r ) \\sigma(s_t ) \\sigma(v_t ) + b_s b_v \\var(z_1)\\right ] \\cp{}{s}{v } \\nonumber \\\\ & + \\left[\\tanh(r ) \\tilde{\\rho}_{vr } \\sigma(s_t ) \\sigma(r_t ) + b_s b_r \\var(z_1)\\right ] \\cp{}{s}{r } \\nonumber \\\\ & +   \\left [ \\tilde{\\rho}_{vr } \\sigma(v_t ) \\sigma(r_t ) + b_v b_r \\var(z_1)\\right ] \\cp{}{r}{v } \\equiv f_{sv } + f_{sr } + f_{vr}. \\nonumber\\end{aligned}\\ ] ] according to @xmath114    in @xmath115 is the jump operator @xmath116 } ( e^{y_\\chi } - 1)\\fp{v(x_s , x_v , x_r,\\tau)}{x_\\chi } - y_r\\fp{v(x_s , x_v , x_r,\\tau)}{x_r}\\bigg ] \\mu(d y_s d y_v dy_r ) , \\nonumber\\end{aligned}\\ ] ] where @xmath117 is the three - dimensional lvy measure , and @xmath118 , @xmath119 .",
    "this pide has to be solved subject to the boundary and terminal conditions .",
    "consider first a pure diffusion case ( no jumps ) .",
    "for the fx european vanilla options the terminal condition reads @xmath120 where @xmath121 is the vanilla option payoff as defined by the corresponding contract ( call or put ) . for the double barrier options considered in this paper ,",
    "the payoff reads @xmath122 where @xmath123 is the first time the spot price hits the upper barrier @xmath124 , and @xmath125 is the first time the spot price hits the lower barrier @xmath126",
    ". there also exist contracts where some rebate is paid when the spot price hits either the upper or lower barriers .",
    "so can be easily extended to this case .",
    "the boundary conditions also depend on the type of the options under consideration . in this paper",
    "we consider european vanilla and double barrier options .",
    "the boundary conditions for those differ only by the conditions at the boundaries of the spot price domain .",
    "namely , we set @xmath127 for the double barrier options , and @xmath128 for the vanilla call options .    for the instantaneous variance @xmath29 the form of the boundary conditions depends on the exponent @xmath129 in . for instance , when @xmath130 , i.e. the diffusion part of @xmath131 is the cir process , it is known that no boundary condition is required at @xmath132 if the feller condition @xmath133 holds .",
    "so in this case the equation with @xmath132 is used as the boundary condition .",
    "more general , if @xmath134 are chosen in such a way that the process @xmath131 never reaches the origin , no boundary condition is required .",
    "otherwise , either the reflection or absorbing boundary conditions can be set at @xmath132 . at @xmath135",
    "the boundary condition is @xmath136 .",
    "alternatively , it can be written @xmath137 . in more detail ,",
    "see , e.g. , discussions in @xcite .    in the presence of jumps these conditions should be extended as follows .",
    "suppose we want to use finite - difference method to solve the above pide and construct a jump grid , which is a superset of the finite - difference grid used to solve the diffusion equation ( i.e. when @xmath138 , see @xcite ) .",
    "then these boundary conditions should be set on this jump grid as well as at the boundaries of the diffusion domain .",
    "boundary conditions for @xmath41 should be set at @xmath139 which corresponds to @xmath140 and @xmath141 . in the pure diffusion case ( no jumps ) at @xmath142 from we obtain @xmath143 .",
    "thus , in words , this is the case when the spot price is perfectly anti - correlated with the instantaneous variance , while both are independent of their stochastic correlation , which is 1 . as follows from , the spot price dynamics then is defined by a local volatility model , @xcite , with the local volatility function @xmath144 . therefore , no boundary condition is necessary at @xmath145 , since the pde in will itself serves as the boundary condition at this end . at @xmath146",
    ", we have @xmath147 .",
    "again , no boundary condition is necessary at @xmath148 , and the pde in itself serve as the boundary condition with those values of correlations substituted into it .",
    "when the jumps are taken into account , perfect correlation @xmath149 is achieved when the loading factors @xmath150 both tend to infinity .",
    "hence , contributions to from both the diffusion correlation and from the idiosyncratic parts are very small .",
    "it then follows from that @xmath151 in addition , all terms in the definition of @xmath152 in tend to infinity when @xmath153 .",
    "therefore , we must set @xmath154 hence , similar to the pure diffusion case , we can assume that @xmath155 at @xmath148 .",
    "therefore , in this limit again transforms to that for the local volatility model , and this equation is just the boundary condition at @xmath148 .    by a similar argument , @xmath155 at @xmath145 .",
    "therefore , substituting this into the pide , we obtain the equation which is the boundary condition at this end .",
    "it is well - known that the backward pde / pide is helpful for pricing options , e.g. , with the same strike and maturity but various initial spot prices .",
    "however , when calibrating some model to the options market data , we need to simultaneously price multiple options with different strikes and maturities but the same initial spot price .",
    "for doing so , a forward kolmogorov equation can be used .",
    "forward pides can be derived using techniques proposed in @xcite .",
    "alternatively , we can exploit the approach which is discussed in @xcite and for the financial literature is originated by @xcite , see a literature survey in @xcite .",
    "briefly , the idea is as follow .    instead of a continuous forward equation",
    "we consider a discretized kolmogorov equation from the very beginning .",
    "in other words , this is equivalent to the discrete markov chain defined at space states corresponding to some finite - difference grid @xmath156 .",
    "consider first only the stochastic processes with no jumps .",
    "it is known ( see , e.g. , @xcite ) that the forward kolmogorov equation for the density of the underlying process @xmath157 can be written in the form @xmath158 where @xmath159 is a discrete density function ( i.e. , a vector of probabilities that @xmath157 is in the corresponding state @xmath160 at time @xmath20 ) , @xmath109 is the expiration time , and the generator @xmath161 has a discrete representation on @xmath156 as a matrix of transition probabilities between the states .",
    "for a given interval @xmath162 $ ] where the generator @xmath163 does not depend on time , the solution of the forward equation is @xmath164 therefore , to compute the option price @xmath165 $ ] , where @xmath166 is the payoff at time @xmath20 and @xmath167 is an expectation under the risk - neutral measure @xmath168 , we start with a given @xmath169 , evaluate @xmath170 by solving , , we solve in multiple steps in time @xmath171 by using , for instance , a piecewise linear approximation of @xmath161 and the solution in . ] and finally evaluate @xmath172 .    on the other hand",
    ", one can start with a backward kolmogorov equation for the option price @xmath173 which by change of variables @xmath174 could be transformed to @xmath175 it is also well - known that @xmath176 ; see , e.g. , @xcite .",
    "based on that , constructing the transposed discrete operator @xmath177 on a grid @xmath156 is fairly straightforward .",
    "however , extending this idea to modern finite - difference schemes of higher - order approximation ( see , e.g. , @xcite and references therein ) is a greater obstacle .",
    "this obstacle is especially challenging because these schemes by nature do multiple fractional steps to accomplish the final solution , and because an explicit form of the generator @xmath161 , that is obtained by applying all the steps , is not obvious .",
    "finally , including jumps in consideration makes this problem even harder .",
    "this problem is solved in @xcite where a splitting finite - difference scheme for the 2d forward equation is constructed which is fully consistent in the above - mentioned sense with the backward counterpart . for the latter , two popular scheme",
    "are chosen , namely : hundsdorfer and verwer ( hv ) and a modified craig - sneyd scheme , @xcite .",
    "also a consistent forward scheme is proposed in @xcite for solving the corresponding pides .",
    "to solve the forward pide , we again use the approach of @xcite .",
    "it consists of few steps      we use the strang splitting scheme , @xcite which provides the second - order of approximation in a temporal step . for the backward equation it reads",
    "is usually included into the operator @xmath111 by splitting it into three equal parts @xmath178 and adding each part to @xmath179 and @xmath180 , correspondingly . ]",
    "@xmath181 which could be re - written as a set of fractional steps : @xmath182 thus , instead of an unsteady pide , we obtain one pide with no drift and diffusion ( the second equation in ) and two unsteady pdes ( the first and third ones in ) .",
    "to produce a consistent discrete forward equation , we use the transposed evolutionary operator , which results in the scheme @xmath183 assuming that @xmath184 .",
    "the fractional steps representation of this scheme is @xmath185      here we consider the solution of the equation @xmath186 which is required at the first and third steps of . for doing that in @xcite two forward",
    "finite - difference schemes are proposed for the 2d case . the first scheme , which is consistent with the hv scheme is @xmath187 , \\nn\\end{aligned}\\ ] ] where the subindex @xmath16 marks the @xmath16-th step in time , @xmath188 , @xmath189 , and @xmath190 , and @xmath191 is the parameter of the hv scheme .",
    "the forward analog for another popular backward finite - difference scheme  a modified craig - sneyd ( mcs ) scheme , see @xcite , can also be found in @xcite .",
    "despite both these schemes are unconditionally stable , there exists a delicate issue regarding the positivity of the solution . as mentioned in @xcite , for steps 1 , 2 , and 4 in this",
    "is guaranteed if both @xmath192 and @xmath193 are m - matrices ; see @xcite . to achieve this",
    ", an appropriate ( upward ) approximation of the drift ( convection ) term has to be chosen , which is often discussed in the literature ; see @xcite and references therein .    for steps 3 and 5 ,",
    "a possible issue is that the central difference approximation of the second order for the mixed derivatives does nt preserves positivity of the solution .",
    "various attempts are made in the literature to replace this approximation with a reduced scheme which uses a 7 point stencil , again see the discussion in @xcite .",
    "lack of positivity usually gives rise to instability unless a very small spatial step is used which is impractical .",
    "this is less important for the backward scheme because the explicit step is followed by some number of implicit steps which significantly damp possible instabilities ( so the resulting solution is non - negative ) .",
    "but for the forward scheme the explicit step is the last one , and so this could be critical .    to resolve this problem , in @xcite",
    "it is proposed to replace the explicit step for the mixed derivatives with the implicit one .",
    "it was proved there that the scheme proposed for calculating of the mixed derivative terms guarantees the positivity of the solution , while the whole scheme becomes fully implicit .",
    "below we describe this scheme for the backward equation while for the forward one it is exactly same if one changes the notation from @xmath106 to @xmath194 , and from @xmath195 to @xmath20 , and also replaces all matrices with their transposes .",
    "as applied to a 3d case , the idea is to represent the explicit step of the hv scheme as @xmath196 where @xmath197\\cap \\mathbb{z}$ ] .",
    "now observe , that the rhs of is a approximation ( 0,1 ) of the equation @xmath198v(\\tau).\\ ] ] the solution of this equation can be formally written as @xmath199\\right\\}v(\\tau_{n-1 } ) \\\\ & = e^{\\delta \\tau f_0(\\tau_{n-1})}e^{\\delta \\tau f_1(\\tau_{n-1 } ) } e^{\\delta \\tau f_2(\\tau_{n-1})}e^{\\delta \\tau f_3(\\tau_{n-1})}v(\\tau_{n-1 } ) + o(\\delta \\tau ) .",
    "\\nonumber\\end{aligned}\\ ] ]    alternatively , a approximation ( 1,0 ) can also be applied to all exponentials in providing same order of approximation in @xmath200 but making all steps implicit .",
    "namely , this results into the following splitting scheme of the solution of : @xmath201v^1(\\tau_{n-1 } ) & = v^0(\\tau_{n-1 } ) , \\nonumber \\\\ [ 1 - \\delta \\tau f_2(\\tau)]v^2(\\tau_{n-1 } ) & = v^1(\\tau_{n-1 } ) , \\nonumber \\\\ [ 1 - \\delta \\tau f_3(\\tau)]v(\\tau ) & = v^2(\\tau_{n-1 } ) .",
    "\\nonumber\\end{aligned}\\ ] ] steps 2 - 4 in ) are the one - dimensional implicit steps , so we already know how to solve these equations .    by construction of the hv scheme , the first step in has to be solved with the accuracy @xmath202 , again see discussion in @xcite . with this accuracy , the previous equation can be factorized as @xmath203 or using splitting @xmath204 the order of the splitting steps usually does nt matter .    for illustration ,",
    "let us consider a mixed derivative term @xmath205 in .",
    "we start with replacing the explicit step used in the hv and mcs schemes for the mixed derivative term @xmath206 by the implicit representation , which has the same order of approximation ( first order in time ) @xmath207 v(\\tau+\\dtau ) = v(\\tau),\\ ] ] where @xmath208 .",
    "we re - write this equation in the form @xmath209v(\\tau+\\dtau ) , \\nonumber\\end{aligned}\\ ] ] where @xmath210 are some positive numbers which have to be chosen based on some conditions , e.g. , to provide diagonal dominance of the matrices in the parentheses in the lhs of .    as shown in @xcite , can be solved using fixed - point picard iterations .",
    "one can start with setting @xmath211 in the rhs of , then solve sequentially two systems of equations @xmath212v^k , \\nonumber \\\\ \\big(p & - \\sdt \\rho_{s , v } w(s ) \\triangledown_s \\big)v^{k+1 } = v^*.\\end{aligned}\\ ] ] here @xmath213 is the value of @xmath214 at the @xmath215-th iteration .",
    "the following main theorem provides a necessary discretization of the above equation .",
    "[ proppos2 ] let us assume @xmath216 , and approximate the lhs of using the following finite - difference scheme : @xmath217 then this scheme is unconditionally stable in time step @xmath200 , approximates with @xmath218 and preserves positivity of the vector @xmath219 if @xmath220 , where @xmath221 are the grid space steps correspondingly in @xmath131 and @xmath222 directions , and the coefficient @xmath223 must be chosen to obey the condition : @xmath224.\\ ] ] the scheme has a linear complexity in each direction .    for the proof , see appendix  b in @xcite .",
    "here we define a one - sided second order approximations to the first derivatives : _ backward _ approximation @xmath225/(2 h)$ ] , and _ forward _ approximation @xmath226/(2 h)$ ] .",
    "also @xmath227 denotes a unit matrix .",
    "all these definitions assume that we work on a uniform grid with step @xmath228 , however this could be easily generalized for the non - uniform grid as well , see , e.g. , @xcite .",
    "a practical choice of the coefficient @xmath223 is discussed in @xcite .",
    "it is also shown there that in case @xmath229 the same theorem holds , if in the terms containing @xmath230 we replace @xmath231 with @xmath232 and vice versa .      when jumps are taken into account , and hence the loading factors @xmath233 $ ] , according to all mixed derivatives operators will include an extra term .",
    "for instance , will now read @xmath234 } v(\\tau ) \\\\ & =   e^{\\delta \\tau f_{sv}(\\tau ) } e^{\\dtau b_s b_v \\var(z_1 ) } v(\\tau ) = e^{\\delta \\tau f_{sv}(\\tau ) } \\widetilde{v}(\\tau ) , \\nonumber \\\\",
    "\\widetilde{v}(\\tau ) & = e^{\\dtau b_s b_v \\var(z_1 ) } v(\\tau ) , \\nonumber\\end{aligned}\\ ] ] where @xmath235 represents the diffusion part of the covariance .",
    "thus , this case is reduced to the previous one with no jumps , since by assumption , @xmath80 and @xmath236 are deterministic .",
    "using this idea , we derive a forward scheme for the 3d diffusion equation which is an exact adjoint of the backward hv scheme .",
    "this is done similar to the derivation in @xcite for the 2d case .",
    "however , in the present approach we combine it with the fully implicit scheme for the mixed derivative term .",
    "the derivation of the implicit - explicit scheme is given in appendix .",
    "the final result reads @xmath237,\\nonumber \\\\ m_3^{n-1,\\top } \\widetilde{y}_3 & = \\widetilde{y}_0 , \\qquad m_2^{n-1,\\top } \\widetilde{y}_2 = \\widetilde{y}_3 , \\qquad m_1^{n-1,\\top } \\widetilde{y}_1 = \\widetilde{y}_2 , \\nonumber \\\\ z_1 & = \\left(1 + \\delta t f^{n-1,\\top}\\right ) y_1 , \\qquad z_2 = \\left(1 + \\delta t f^{n-1,\\top}\\right ) \\delta y_1 , \\nonumber \\\\ p_n & = \\frac{1}{2}(z_1 + y_1 ) - \\delta t \\theta \\sum_{i=1}^3 ( f_i^{n-1})^\\top \\delta y_i + z_2 . \\nonumber\\end{aligned}\\ ] ] where @xmath238    to apply proposition  [ proppos2 ] , we rewrite the fourth line of in the form @xmath239 since we are constructing a scheme which provides the second order of approximation in @xmath240 , the result of the multiplication @xmath241 is equivalent up to @xmath242 to the solution of the equation @xmath243 see discussions in @xcite about approximations and properties of m - matrices . the is a pure implicit equation , and its solution is a non - negative vector provided that @xmath244 is an m - matrix , and vector @xmath245 is also non - negative .",
    "thus , can be re - written as @xmath246 , \\\\",
    "z_0 & = ( i + \\dtau ( f^{n})^\\top)y_1 . \\nonumber\\end{aligned}\\ ] ] the equation for @xmath247 takes a form of .",
    "therefore , proposition  [ proppos2 ] can be applied to compute the vector @xmath248 in a fully implicit manner which preserves the positivity of the solution , and is of second order of approximation in the spatial steps .    in a similar way we can proceed with the last line of which",
    "can be represented as @xmath249 introduce @xmath250 as the solution of the equation @xmath251 observe , that since the solution of has to be obtained with the accuracy up to @xmath242 , we can replace operators @xmath252 in the second sum of the last line of by @xmath253 , because @xmath254 .",
    "for the same reason @xmath255 .",
    "then @xmath256\\widetilde{y}_1 .",
    "\\nonumber\\end{aligned}\\ ] ] the last term in this equation , again has the form of and can also be computed using the fully implicit scheme described in proposition  [ proppos2 ] , if one replaces @xmath257 by their transposes .",
    "this finalizes the construction of the fully implicit splitting scheme for the 3d advection - diffusion equation which provides second order of approximation in temporal and spatial steps , is unconditionally stable and preserves positivity of the solution .",
    "as shown in @xcite , this fully implicit scheme allows elimination of first few rannacher steps as this is usually done in the literature to provide a better stability ( see survey , e.g. , in @xcite ) , and provides much better stability of the whole scheme which is important when solving multidimensional problems .    for the sake of convenience , below",
    "we collect all the above splitting steps just in one block @xmath258 , \\nonumber \\\\",
    "m_3^{n-1,\\top } \\widetilde{y}_3 & = \\widetilde{y}_0 , \\qquad m_2^{n-1,\\top } \\widetilde{y}_2 = \\widetilde{y}_3 , \\qquad m_1^{n-1,\\top } \\widetilde{y}_1 = \\widetilde{y}_2 , \\nonumber \\\\ z_2 & = \\left(1 + \\delta t f^{n-1,\\top}\\right ) \\widetilde{y}_1 , \\nonumber \\\\ m_i^{n,\\top } \\widehat{y}_i & = \\widetilde{y}_i , \\ i=1,2,3 , \\nonumber \\\\ p_n & = z_2 + \\frac{1}{2}(y_1-z_0 ) + \\sum_{i=1}^3 ( \\widetilde{y}_i - y_i + \\overline{y}_i - \\widehat{y}_i ) .",
    "\\nonumber\\end{aligned}\\ ] ]    complexity - wise , this scheme requires the solution of 12 implicit systems of linear equations , and 2 explicit equations .",
    "the latter steps being treated using the fully - implicit scheme require per one explicit equation : 3 implicit steps for @xmath259 , approximately 2 iterations for each of 3 mixed terms , and for each term solving 2 implicit systems , so totally 15 implicit systems . overall",
    ", the whole solution could be obtained by solving 42 implicit systems .",
    "therefore , the complexity of this approach is about @xmath260 where @xmath261 is the number of the grid nodes in the @xmath262-th direction , @xmath259 .",
    "so this is about 2.3 times slower than the original hv scheme for the backward equation .",
    "since the discrete solution of the forward kolmogorov equation is the discrete probability density , it has to obey two important conditions .",
    "the first one is the positivity of the solution and was considered in the previous section .",
    "the other condition requires that the three - dimensional integral of the density should be equal to 1 . in the discrete case",
    "this can be replaced with the condition that @xmath263.\\ ] ] then the natural question would be : do there exist any conditions that an appropriate finite - difference scheme should obey in order to automatically preserve ? in the one - dimensional case the answer to this question is given by the following proposition :    [ propnorm ] consider a forward scheme .",
    "a typical splitting step of this scheme consists in solving an equation of the type @xmath264 where @xmath265 is a given vector , @xmath266 is the unknown vector to be determined , and @xmath267 is the lhs matrix .",
    "the vector @xmath265 has all positive elements , and its @xmath268 norm is 1 , i.e. @xmath269 in other words , @xmath265 belongs to the probability vectors @xmath270 , @xmath271 , or to the discrete distributions .",
    "then @xmath266 is also a discrete distribution , i.e. @xmath272 , if discretization of @xmath273 is such that the matrix @xmath274 is a valid generator matrix , @xmath275 ( see @xcite and references therein ) , and @xmath276 is an em- ( or an m- ) matrix .",
    "since @xmath275 , it has the following property of the generator matrix , @xcite @xmath277.\\ ] ] if @xmath278 satisfies , then obviously @xmath279.\\ ] ] on the other hand , one can represent @xmath266 as @xmath280 .",
    "therefore , to have @xmath266 with the same @xmath268 norm as that of @xmath265 , the matrix @xmath281 should have its columns to be in @xmath270 , @xmath282 $ ] .",
    "observe , that since @xmath276 is an em - matrix , @xmath283 is also an em - matrix , and @xmath281 is a positive matrix , again see @xcite . now",
    "the result that @xmath282 $ ] follows from the fact that if @xmath271 , @xmath284 is a convex combination of the columns of @xmath281 with coefficients given by the entries of @xmath265 .",
    "each column of @xmath281 must be in @xmath270 , and @xmath270 is a convex set .",
    "further we need the following lemma :    [ lemmanorm ] suppose we are given an invertible matrix @xmath283 with real entries with the sum of every column is 1 .",
    "then , for the matrix @xmath281 the sum of the elements in each column is 1 .",
    "the statement of this lemma is obviously equivalent to the following statement .",
    "given an invertible matrix @xmath276 with real entries with the sum of every row is 1 , for the matrix @xmath285 the sum of the elements in each row is also 1 . to prove this ,",
    "denote @xmath286 .",
    "then we have @xmath287 , \\\\",
    "\\sum_j d_{i , j } m_{j , k }   & = \\delta_{i , k } , \\qquad \\forall k , i \\in [ 1,n],\\end{aligned}\\ ] ] and thus @xmath288    therefore , since by construction @xmath283 is such a matrix that its every column sums to 1 , based on the above lemma it follows that @xmath289 . this proves the statement of the proposition .",
    "@xmath290    in 3d case the splitting scheme in consists of multiple 1d steps .",
    "therefore , intuitively , it is clear that if all discretizations of matrices @xmath291 are chosen according to the proposition  [ propnorm ] , the total scheme preserves the @xmath268 norm of the solution vector .",
    "a rigorous prove of this statement will be given elsewhere .",
    "this is also confirmed by our numerical experiments .      for the second ( jump )",
    "step in a splitting scheme is proposed in @xcite .",
    "if , e.g. , jumps in @xmath222 are described by an exponential process , the jump integral admits representation in the form of a pseudo - differential operator @xmath292 \\nu(dy ) = \\mathcal{j } v(x , t ) , \\\\ \\mathcal{j } & \\equiv \\int_\\mathbb{r}\\left [ \\exp \\left ( y \\dfrac{\\partial } { \\partial x } \\right ) - 1 - ( e^y-1 ) \\fp{}{x } \\right ] \\nu(dy ) ,   \\nonumber\\end{aligned}\\ ] ] which is introduced in @xcite , and where @xmath293 . in the definition of the operator @xmath115 ( which is actually an infinitesimal generator of the jump process ) ,",
    "the integral can be formally computed under some mild assumptions about existence and convergence if one treats the term @xmath294 as a constant .",
    "it is important to emphasize that @xmath295 where @xmath296 is the characteristic exponent of the jump process , and @xmath297 is the moment generation function corresponding to this characteristic exponent .",
    "this directly follows from the lvy - khinchine theorem .",
    "this point of view apparently has been pioneered in @xcite .",
    "see also the detailed state - of - the - art surveys in @xcite .",
    "then , using proposition  [ propballotta ] , the operator @xmath298 in can be represented as , @xcite @xmath299 } b_\\eta \\triangledown_\\eta ) , \\",
    "\\triangledown_\\eta \\equiv \\fp{}{\\eta}. \\nonumber\\end{aligned}\\ ] ] thus , this requires a sequential solution of 7 equations at every time step .    as shown in @xcite , using this method for the forward equation does nt bring any problem , because @xmath300 and there is no issue with computing @xmath301 . indeed , if @xmath115 is the negative of an m - matrix , the transposed matrix preserves the same property .",
    "also if @xmath115 has all negative eigenvalues , the same is true for @xmath301 .",
    "then the unconditional stability of the scheme and its property of preserving the positivity of the solution follow from proposition 4.1 in @xcite .",
    "also , it is easy to show that the jump equation at the central step of @xmath302 can be solved with respect to the unknown vector @xmath303 by using the same adi method as in @xcite , by simply replacing all matrices @xmath304 with @xmath305 $ ] .      as mentioned in @xcite , the boundary conditions for the forward scheme should be consistent with those for the backward scheme .",
    "however , these two sets of conditions are not exactly same because for the forward equation the dependent variable is the density , while for the backward equation the dependent variable is the undiscounted option price .    in section  [ sectpide ]",
    "we have already discussed the boundary and initial ( terminal ) conditions for the backward equation . for the forward equation",
    "the obvious initial condition reads @xmath306 where @xmath307 is the dirac delta - function .",
    "setting the boundary conditions is a more delicate issue . in the @xmath222 domain",
    ", we require the density @xmath308 to vanish at the domain boundaries , i.e. at @xmath309 and @xmath310 .",
    "the boundary conditions in the @xmath131-domain are discussed , e.g. , in @xcite . for the heston model ,",
    "if the feller condition @xmath311 holds , the boundary condition at @xmath132 is @xmath312 .",
    "otherwise , @xmath313 should be used as the boundary condition .",
    "therefore , in this paper we use this approach , i.e. if the point @xmath132 is inaccessible based on given values of the parameters @xmath134 , we use the boundary condition @xmath312 at @xmath132 . at @xmath135",
    "we set @xmath314 .",
    "also , since by construction the @xmath315 domain does nt contain any reflection or absorbing boundaries , the analysis of the option price behavior at @xmath139 given in section  [ sectpide ] can be applied here as well .",
    "based on that , we conclude that similar to the @xmath222 domain , we can require the density @xmath308 to vanish at @xmath139 .",
    "in this section we describe some results of our numerical experiments . here , for the sake of brevity we provide just a single example where jumps are taken into account , all the other examples deal with a pure diffusion case . we will present more detailed results for the model with jumps elsewhere .",
    "fo all experiments we solve the forward kolmogorov equation using the proposed finite - difference fully implicit splitting scheme , and compute the density @xmath316 .",
    "parameters of the model used in these tests are given in tab .",
    "[ tab1 ] , where @xmath317 denote the lower and upper barriers , correspondingly .",
    "the local volatility function @xmath318 in these tests is always set to 1 .",
    "power parameters are taken to be @xmath319 .",
    "thus , this setting is analogous to the heston model , but with the stochastic correlation .",
    "the finite - difference non - uniform grid is constructed similar to how this was done in @xcite and includes 101 nodes in @xmath222 , and 81 nodes in @xmath131 and @xmath315 directions , so the whole grid is @xmath320 .",
    "the fixed temporal step is 0.01 .",
    "no rannacher or any other smoothing scheme is used at the first temporal steps .",
    "parameters @xmath223 for computing each mixed derivatives term by using the fully implicit scheme are taken to be 10 .",
    "parameter @xmath191 of the hv scheme according to @xcite is 0.3 .",
    "we use matlab and run our code at pc with dual quad core intel(r ) core(tm)i7 - 4790 cpu 3.60 ghz .",
    "since the proposed scheme is constructed by using the transposed operators ( matrices ) , and a fully implicit scheme for the mixed derivatives , its convergence analysis coincides with that provided in @xcite .",
    "therefore , in our numerical experiments we are mostly dedicated to the financial interpretation of the results obtained .      in this tests",
    "we applied our model to pricing european vanilla options . as a benchmark",
    "the heston model is chosen which is mimicked by setting @xmath321 in the general setting described in above .",
    "the atm call option value in this test at @xmath322 computed using the forward equation is 10.7533 while the benchmark value computed using fft is 10.7564 .",
    "thus , for this test the relative accuracy is about 0.02% .",
    "an elapsed time for computing one step in time is about 4.8 sec .",
    "[ eurskew ] presents the rr(10 ) skew of the european options computed using the proposed model with parameters as in table  [ tab1 ] ( the ss1 model ) and the heston model .",
    "it can be seen that the heston model also generates stochastic skew .",
    "this is the known fact , because the skew is proportional to the spot / inv covariance .",
    "therefore , even if the correlation coefficient is constant , the skew changes with time if the spot variance , or the vol - of - vol , or both change with time ( so their product changes with time ) .",
    "it is also seen that making the correlation stochastic does nt contribute much to the magnitude of the skew . in fig .",
    "[ eurskewdif ] the difference in skew between the heston and ss1 models is presented together with the third case which displays the difference in skew between the heston model and the stochastic skew model ( ss2 ) where in contrast to table  [ tab1 ] we use @xmath323 . in other words ,",
    "in the ss2 case there is no mean - reversion in the dynamics of the correlation coeffcient @xmath2 .",
    "the relative difference in skew as compared with the heston model could reach + 100% or -250% , however , this is because the absolute value of the skew is small .",
    "[ eur3dxy],[eur3dxz],[eur3dyz ] display the computed density of the european vanilla options at maturity . since the whole picture is 4d , the results are presented in various planes . in other words ,",
    "the third dimension is represented as a sequence of graphs corresponding to some discrete values of the third independent variable .",
    "it can be seen , that the density in various planes could be bimodal , or even quadro - modal .",
    "such type of the solutions for the density function has been already observed , e.g. , in @xcite .",
    "it is known , that when the lower barrier @xmath126 is fixed , for the do barrier call option there always exists a strike corresponding to the option @xmath324 = 0.1 ( 10 delta ) . however , for the put this stops to be true when @xmath109 increases .",
    "so starting from some maturity @xmath109 , the equation @xmath325 has no solution with respect to @xmath326 .",
    "therefore , in practice to trade the skew the barrier options are often set with the barriers being a function of time , @xcite .",
    "in the next test we set a linear time - dependent lower barrier to be @xmath327 , where @xmath126 is given in table  [ tab1 ] .",
    "the corresponding results for the skew of the down - and - out barrier options are presented in fig .",
    "[ doskew],[doskewdif ] . here , we again use a non - uniform grid with 100 x 80 x 80 nodes .",
    "projections of the grid in planes @xmath328 and @xmath329 are presented in fig .",
    "[ griddo ] .",
    "it can be seen that assuming the correlation coefficient @xmath104 to be stochastic bring some changes in the skew value as compared with the pure stochastic volatility heston model . at the short time",
    "scale these changes are within @xmath33050 bps .",
    "therefore , if the market demonstrates larger variations of the skew , adding jumps to the correlation could make the model more flexible .      in this test",
    "we compute prices of double no - touch ( dnt ) options with fixed the lower and upper barriers which values are given in tab .  [ tab1 ] .",
    "again , we use a non - uniform grid 100 x 80 x 80 which projections in planes @xmath328 and @xmath329 are presented in fig .",
    "[ griddnt ] .    in fig .",
    "[ dntiv ] the implied volatility of the dnt options is presented as a function of time to maturity @xmath109 computed for the heston and stochastic correlation models . at the given time scale the difference between two models is about 5 - 10 bps and also changes the sign with time .",
    "this test uses the setting of section  [ dovanilla ] , but now includes jumps into consideration .",
    "we represent all jumps - common and idiosyncratic - by using the kou double exponential model , @xcite , similar to how this was done in @xcite .",
    "the density of the double - exponential jumps is , @xcite : @xmath331 dx,\\ ] ] where @xmath332 is the jumps intensity , @xmath333 , @xmath334 , @xmath335 ; the first condition was imposed to ensure that the underlying asset price has a finite expectation .",
    "accordingly , for this process @xmath336 in in the explicit form reads @xmath337 , \\qquad i \\in [ s , v , r , z].\\ ] ]    parameters of the jumps model for this particular test are presented in table  [ tabjumpparam ]    for the diffusion part we again use a non - uniform grid 101 x 81 x 81 .",
    "the jump non - uniform grid in each direction is a superset of the diffusion grid built using a geometric progression , see @xcite .",
    "so the whole jump grid includes @xmath338 .",
    "the fixed temporal step is 0.01 .",
    "the typical elapsed time obtained at the same computer is : the first diffusion step - 4.7 secs , the jumps steps in @xmath339 - @xmath222 - 0.15 , 0.25 , 0.4 secs , the common jumps step - 5.5 secs to converge to the relative accuracy @xmath340 , the next jump steps in @xmath339 - 0.40 , 0.48 , 0.58 secs , and the last diffusion step - 4.7 secs .",
    "thus , it takes about 3.5 times more to compute the solution at one step in time as compared with the case with no jumps .",
    "this coincides with the theoretical estimation of @xcite .",
    "the adi scheme for computing the common and idiosyncratic jumps for the kou model is described in @xcite . the value of the adi parameter @xmath341 is experimentally chosen to be @xmath342 which is sufficient to provides convergence of the scheme .",
    "the result of simulation are presented in fig .",
    "[ doskewjump ] where ssj stays for the stochastic skew model with jumps .",
    "it can be seen that even jumps with relatively small intensity as in table  [ tabjumpparam ] change the skew by about 10% .",
    "obviously , the proposed model has the capacity to produce lower of higher skews by varying the model parameters .",
    "the paper deals with an advanced model which is build on top of an lsv model by including the following components : i ) the spot / instantaneous variance correlation is stochastic , ii ) all stochastic drives - spot , instantaneous variance and their correlation are modeled by processes , iii ) all diffusion components are correlated as well as all jump components , however there is no correlation between diffusion and jumps .",
    "this model is used to price fx options and replicate stochastic behavior of the options skew which was observed in market data . for the purpose of fast calibration",
    ", we consider a forward pide and propose a new fully implicit splitting finite - difference scheme to solve it which is fully consistent with the corresponding solution of the backward pide .",
    "the scheme is unconditionally stable , of second order of approximation in time and space , and achieves a linear complexity in each spatial direction .",
    "it also preserves the positivity and norm of the density function which is proven by a series of propositions .",
    "all these results are new .",
    "the results of simulation obtained by using this model demonstrate capacity of the presented approach in modeling stochastic skew .",
    "however , it is worth mentioning that despite the proposed model is sufficiently rich , it contains many free parameters .",
    "therefore , calibration of the model , if done at once , could be time - consuming even when using the forward scheme .",
    "however , if various market data is available , it is better to calibrate various pieces of the model separately , as this was discussed , e.g. , in @xcite .",
    "namely , the idiosyncratic jumps first can be calibrated to some marginal distributions using the appropriate instruments .",
    "then the parameters of the common jumps can be calibrated to the option prices , while keeping parameters of the idiosyncratic jumps fixed .",
    "also the lsv part can be calibrated to the vanilla and exotic option prices as this is usually done , @xcite .",
    "i thank peter carr for various useful comments and discussions and igor halperin for some helpful remarks .",
    "i assume full responsibility for any remaining errors .",
    "ahdida , a. and alfonsi , a. ( 2013 ) . a mean - reverting sde on correlation matrices . in _ stochastic processes and their applications _ , volume 123 , pages 14721520 .",
    "elsevier .",
    "andersen , l. and andreasen , j. ( 2000 ) . processes : volatility smile fitting and numerical methods for option pricing . , 4(3):231262 .",
    "ashyraliyev , m. , blom , j. , and verwer , j. ( 2008 ) . on the numerical solution of diffusion ",
    "reaction equations with singular source terms . , 216(1):2038 .",
    "ballotta , l. and bonfiglioli , e. ( 2014 ) .",
    "multivariate asset models using lvy processes and applications .",
    ", ( doi:10.1080/1351847x.2013.870917 ) .",
    "bates , d. ( 1996 ) . jumps and stochastic",
    "volatility : exchange rate processes implicit in options .",
    ", 9(1):69107 .",
    "bergomi , l. ( 2016 ) . .",
    "crc financial mathematics series .",
    "chapman and hall .",
    "berman , a. and plemmons , r. ( 1994 ) . .",
    "bttcher , b. , schilling , r. , and wang , j. ( 2014 ) . .",
    "lecture notes in mathematics , 2009 , lvy matters iii .",
    "springer , berlin .",
    "carr , p. ( 2006 ) .",
    "two new pde s for european options on jump diffusions .",
    "technical report , nyu .    carr , p. ( 2012 ) . .",
    "working paper , nyu .",
    "carr , p. and wu , l. ( 2004 ) .",
    "time - changed lvy processes and option pricing . , 71:113141 .",
    "carr , p. and wu , l. ( 2007 ) .",
    "stochastic skew in currency options .",
    ", 86(1):213247 .",
    "clements , a. and liao , y. ( 2013 ) .",
    "the dynamics of co - jumps , volatility and correlation .",
    "working paper , ncer .",
    "cont , r. and bentata , a. ( 2012 ) .",
    "forward equations for option prices in semimartingale models .",
    "arxiv:1001.1380 .",
    "cont , r. and tankov , p. ( 2004 ) . .",
    "financial matematics series , chapman & hall /crcl .    ,",
    "j. , grasselli , m. , and tebaldi , c. ( 2007 ) .",
    "option pricing when correlations are stochastic : an analytical framework . , 10(2):151180 .",
    "de  graaf , c. ( 2012 ) .",
    "finite difference methods in derivatives pricing under stochastic volatility models .",
    "master s thesis , mathematisch instituut , universiteit leiden .",
    "derman , e. and kani , i. ( 1994 ) . riding on a smile .",
    ", pages 3239 .",
    "dupire , b. ( 1994 ) .",
    "pricing with a smile .",
    ", 7:1820 .",
    "goodman , j. ( 2004 ) .",
    "forward and backward equations for markov chains .",
    "available at http://www.math.nyu.edu/faculty/goodman/teaching/stochcalc2004/notes/stoch_2.pdf .",
    "haentjens , t. and int hout , k.  j. ( 2012 ) . alternating direction implicit finite difference schemes for the heston  hull  white partial differential equation . , 16:83110 .",
    "higgins , m. ( 2014 ) .",
    "stochastic spot / volatility correlation in stochastic volatility models and barrier option pricing .",
    "arxiv 1404.4028v1 .",
    "hull , j. and white , a. ( 1990 ) . pricing interest rate derivative securities .",
    ", 3:573592 .    , k.  j. and foulon , s. ( 2010 ) .",
    "finite difference schemes for option pricing in the heston model with correlation . , 7(2):303320 .",
    ", k.  j. and welfert , b.  d. ( 2007 ) .",
    "stability of adi schemes applied to convection - diffusion equations with mixed derivative terms .",
    ", 57:1935 .",
    "itkin , a. ( 2013 ) .",
    "new solvable stochastic volatility models for pricing volatility derivatives . , 16(2):111134 .",
    "itkin , a. ( 2015 ) . .",
    ", 18(5):15500311 155003124 .",
    "itkin , a. ( 2016a ) .",
    "efficient solution of backward jump - diffusion pides with splitting and matrix exponentials .",
    ", 19:2970 .",
    "itkin , a. ( 2016b ) .",
    "lsv models with stochastic interest rates and correlated jumps . .",
    "http://dx.doi.org/10.1080/00207160.2016.1188923 .",
    "itkin , a. ( 2017 ) . .",
    "pseudo - differential operators .",
    "doi 10.1007/978 - 1 - 4939 - 6792 - 6 .",
    "itkin , a. and carr , p. ( 2011 ) . jumps without tears : a new splitting technology for barrier options . , 8(4):667704 .",
    "itkin , a. and carr , p. ( 2012 ) . using pseudo - parabolic and fractional equations for option pricing in jump diffusion models .",
    ", 40(1):63104 .",
    "itkin , a. and lipton , a. ( 2015 ) .",
    "efficient solution of structural default models with correlated jumps and mutual obligations .",
    ", doi : 10.1080/00207160.2015.1071360 .",
    "jacob , n. ( 1996 ) . ,",
    "volume  94 of _ mathematical research notes_. academie - verlag .",
    "jacob , n. and schilling , r. ( 2001 ) . , chapter lvy - type processes and pseudo - differential operators , pages 139167 .",
    "birkhauser , boston .",
    "kainth , d. and saravanamuttu , n. ( 2016 ) .",
    "modelling the fx skew .",
    "available at http://www.quarchome.org/fxskew2.ppt .",
    "kou , s. and wang , h. ( 2004 ) . option pricing under a double exponential jump diffusion model . , 50(9):11781192 .",
    "kumar , p. and narayanan , s. ( 2006 ) .",
    "solution of fokker ",
    "planck equation by finite element and finite difference methods for nonlinear systems .",
    ", 31:445461 .",
    "lipton , a. ( 2001 ) . .",
    "world scientific .",
    "lipton , a. ( 2002 ) .",
    "the vol smile problem . ,",
    "pages 6165 .",
    "lucic , v. ( 2008 ) .",
    "boundary conditions for computing densities in hybrid models via pde methods .",
    "ssrn 1191962 .",
    "ma , j. ( 2009 ) .",
    "pricing foreign equity options with stochastic correlation and volatility . , 10(2):303327 .",
    "sepp , a. ( 2011a ) .",
    "efficient numerical pde methods to solve calibration and pricing problems in local stochastic volatility models . in _ global derivatives_.    sepp , a. ( 2011b ) .",
    "parametric and non - parametric local volatility models : achieving consistent modeling of vix and equities derivatives . in _ quant congress europe_.    strang , g. ( 1968 ) . on the construction and comparison of difference schemes .",
    ", 5:509517 .",
    "teng , l. , ehrhardt , m. , and gnther , m. ( 2016 ) . modelling stochastic correlation . .",
    "doi : 10.1186/s13362 - 016 - 0018 - 4 .",
    "van emmerich , c. ( 2006 ) .",
    "modelling correlation as a stochastic process .",
    "working paper , university of wuppertal .",
    "zetocha , v. ( 2015a ) .",
    "correlation skew via stochastic correlation and jumps . .",
    "zetocha , v. ( 2015b ) .",
    "jumping off the bandwagon : introducing jumps to equity correlation .",
    "ssrn 2568441 .",
    "in this section we use the hv finite - difference scheme for the three - dimensional case , and derive an explicit representation for the evolutionary backward operator @xmath343 in . since the hv scheme represents the solution in the form of fractional steps , we need to compress it to a single operator , which will be associated with @xmath343 .",
    "the hv scheme in the 3d  case reads , @xcite @xmath344 , \\",
    "j = 1,2,3 , \\nn \\\\ \\widetilde{y}_0 & = y_0 + \\dfrac{1}{2 } \\delta \\tau \\left[f(\\tau_n , y_3 ) - f(\\tau_{n-1},v_{n-1})\\right ] , \\nn \\\\ \\widetilde{y}_j & = \\widetilde{y}_{j-1 } + \\theta \\delta \\tau \\left[f_j(\\tau_n,\\widetilde{y}_j ) - f_j(\\tau_n , y_3)\\right ] , \\",
    "j=1,2,3 , \\nn \\\\ v_n & = \\widetilde{y}_3 , \\nn\\end{aligned}\\ ] ] where @xmath345 .    below for the sake of brevity",
    "we denote @xmath346 .",
    "we can then write the first equation in as @xmath347 where @xmath348 is treated as an operator ( or , given a finite - difference grid @xmath156 , the matrix of the corresponding discrete operator ) .",
    "we also reserve symbol @xmath349 for an identity operator ( matrix ) .",
    "proceeding in the same way , the second line of for @xmath350 is now @xmath351 therefore , @xmath352 \\\\ & = ( m_1^{n-1})^{-1}\\big[i + \\delta \\tau \\big(f^{n-1 } -\\theta f_1^{n-1}\\big)\\big ] v_{n-1 } , \\qquad m_i^n \\equiv i - \\theta\\delta\\tau f^n_i . \\nonumber\\end{aligned}\\ ] ] similarly , for @xmath353 we have @xmath354,\\ ] ] and for @xmath355 @xmath356 = r_3 v_{n-1 } , \\\\",
    "r_3 & = ( m_3^{n-1})^{-1 } \\big [ - \\dtau \\theta f^{n-1}_3 + ( m_2^{n-1})^{-1 } \\big [ - \\dtau \\theta f^{n-1}_2 + ( m_1^{n-1})^{-1 } \\big [ i \\nonumber \\\\ & + \\dtau(f^{n-1 } - \\theta f^n_1 ) \\big ] \\big ] \\big ] . \\nonumber\\end{aligned}\\ ] ] the third line in now reads @xmath357v_{n-1}.\\ ] ] the next line in can be transformed to a chain of expressions @xmath358 collecting all lines - together we obtain @xmath359 \\big ] \\big ] .",
    "\\nonumber\\end{aligned}\\ ] ] thus , we found an explicit representation for the evolutionary operator @xmath360 that follows from the hv finite - difference scheme in . to construct the transposed operator @xmath361",
    ", we use well - known rules of matrix algebra to get @xmath362(m_1^{n , t})^{-1 } \\big ] ( m_2^{n , t})^{-1 } \\big ] ( m_3^{n , t})^{-1 } , \\nonumber \\\\",
    "r_3^\\top & =    \\big[-\\dtau \\theta ( f_3^{n-1})^\\top +    \\big[-\\dtau \\theta ( f_2^{n-1})^\\top +    \\big[i \\nonumber \\\\    & + \\dtau \\big((f^{n-1})^\\top - \\theta ( f_1^{n-1})^\\top    \\big )   \\big](m_1^{n-1,t})^{-1 } \\big ] ( m_2^{n-1,t})^{-1 } \\big ] ( m_3^{n-1,t})^{-1}. \\nonumber\\end{aligned}\\ ] ] where we have assumed @xmath363 .    this scheme can be re - written using a splitting technique , i.e. , in the form of the sequential fractional steps , similar to how this is done for the original hv scheme . omitting an intermediate algebra ,",
    "we provide just the final result @xmath364 , \\nonumber \\\\ m_3^{n-1,\\top } y_3 & = \\widetilde{y}_0 , \\nonumber \\qquad m_2^{n-1,\\top } \\widetilde{y}_2 = \\widetilde{y}_3 , \\qquad m_1^{n-1,\\top } \\widetilde{y}_1 = \\widetilde{y}_2 , \\nonumber \\\\ \\widetilde{y}_4 & = - \\dtau \\theta \\big [ ( f_3^{n-1})^\\top \\widetilde{y}_3 + ( f_2^{n-1})^\\top \\widetilde{y}_2 + ( f_1^{n-1})^\\top \\widetilde{y}_1 \\big ]   \\nonumber \\\\ & + \\big[i + \\dtau ( f^{n-1})^\\top\\big]\\widetilde{y}_1 , \\nonumber \\\\ v_n & = \\big[i + \\dfrac{1}{2 } \\dtau ( f^{n-1})^\\top \\big ] y_1 +     \\widetilde{y}_4 . \\nonumber\\end{aligned}\\ ] ] as mentioned in @xcite , this scheme , however , has two problems .",
    "first , when using splitting ( or fractional steps ) , one usually wants all internal vectors @xmath365 , @xmath366 $ ] and @xmath367 , @xmath368 $ ] to form consistent approximations to @xmath369 .",
    "the scheme in loses this property at step 4 .",
    "second , because at step 4 the norm of the matrix on the right - hand side is small , the solution is sensitive to round - off errors .",
    "this issue can be resolved by using the method ( `` trick '' )  described in @xcite .",
    "we add and subtract @xmath370 to the first line of , and represent the second @xmath370 as @xmath371.\\ ] ] then the final scheme reads @xmath372,\\nonumber \\\\ m_3^{n-1,\\top } \\widetilde{y}_3 & = \\widetilde{y}_0 , \\qquad m_2^{n-1,\\top } \\widetilde{y}_2 = \\widetilde{y}_3 , \\qquad m_1^{n-1,\\top } \\widetilde{y}_1 = \\widetilde{y}_2 , \\nonumber \\\\ z_1 & = \\left(1 + \\frac{1}{2 } \\dtau f^{n-1,\\top}\\right ) y_1 , \\qquad z_2 = \\left(1 + \\dtau f^{n-1,\\top}\\right ) \\delta y_1 , \\nonumber \\\\ p_n & = z_1 - \\dtau \\theta \\sum_{i=1}^3 ( f_i^{n-1})^\\top \\delta y_i + z_2 . \\nonumber\\end{aligned}\\ ] ] where @xmath238 .",
    "the final step is to put @xmath184 ."
  ],
  "abstract_text": [
    "<S> it is known that the implied volatility skew of fx options demonstrates a stochastic behavior which is called _ stochastic skew_. in this paper we create stochastic skew by assuming the spot / instantaneous variance correlation to be stochastic . </S>",
    "<S> accordingly , we consider a class of slv models with stochastic correlation where all drivers - the spot , instantaneous variance and their correlation are modeled by processes . </S>",
    "<S> we assume all diffusion components to be fully correlated as well as all jump components . </S>",
    "<S> a new fully implicit splitting finite - difference scheme is proposed for solving forward pide which is used when calibrating the model to market prices of the fx options with different strikes and maturities . </S>",
    "<S> the scheme is unconditionally stable , of second order of approximation in time and space , and achieves a linear complexity in each spatial direction . </S>",
    "<S> the results of simulation obtained by using this model demonstrate capacity of the presented approach in modeling stochastic skew .    </S>",
    "<S> stochastic correlation , fx options , stochastic skew , slv models , correlated jumps , 3d pide , finite - difference , forward equations , fully implicit splitting scheme , unconditional stability    c6 , c61 , g17 </S>"
  ]
}