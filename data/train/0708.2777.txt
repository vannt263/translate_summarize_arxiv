{
  "article_text": [
    "the two metrics most widely used on the space @xmath2 of finite point measures on a compact metric space @xmath3 are the prohorov metric @xmath4 and the metric @xmath5 that was introduced in @xcite .",
    "we use @xmath6 to stand for the dirac measure at @xmath7 . for @xmath8 , and @xmath9 the metric @xmath5 is given by @xmath10 if @xmath11 and @xmath12 if @xmath13 , where @xmath14 denotes the set of permutations of @xmath15 .",
    "the gap between @xmath16 and @xmath17 can be bridged by metrics @xmath18 where the average in   is replaced by a general @xmath19-th order average ( see * ? ? ?",
    "all of these metrics are good choices from a theoretical point of view , because they metrize the natural vague topology on @xmath2 .",
    "furthermore , especially @xmath20 has been highly successful as an underlying metric for defining a wasserstein metric @xmath21 between point process distributions : letting @xmath22 ; \\ , { \\lvert f(\\xi)-f(\\eta ) \\rvert } \\leq { d_{1}}(\\xi,\\eta ) \\text { for all } \\xi , \\eta \\in   { \\mathfrak{n}}\\bigr\\}$ ] , we set @xmath23 for any two probability measures @xmath24 and @xmath25 on @xmath2 .",
    "numerous useful upper bounds in this metric have been obtained ; included amongst them are the results of @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , and @xcite , which for the most part assume that one of the probability measures involved is a poisson ( or compound poisson ) process distribution .",
    "such estimates can be used to compare the distributions of point pattern statistics @xmath26 , where @xmath27 , for different underlying point process models , since the wasserstein distance @xmath28 ( see pp",
    ".  254255 of  @xcite ) is easily seen to be bounded by @xmath29 . for a concrete example where this was exploited , see ( * ? ? ?",
    "* section  3.2 ) .    however , there are certain limitations with respect to the practical applications of the metric  @xmath5 ( as well as of the other metrics between point measures that were mentioned ) , which are mainly due to the fact that @xmath30 is always set to the maximal distance @xmath31 if the total numbers of points of the point patterns @xmath32 and @xmath33 disagree . such crude treatment results in a metric that does usually not reflect very well our intuitive idea of two point patterns being `` far apart '' from one another if the cardinalities of the point patterns are different , as can be seen from the extreme case illustrated in figure  [ fig : spotthediff ] .",
    "this flaw is , in our opinion , the main reason why such metrics have not been taken up in more application - oriented fields , such as spatial statistics .    in the present article",
    "we introduce a new metric @xmath0 , which refines the metric @xmath5 in the sense that @xmath34 if the cardinalities of the two point patterns @xmath32 and @xmath33 agree , but @xmath35 can take general values in @xmath36 $ ] if the cardinalities disagree . in particular , @xmath0 assigns a large distance if the difference of the numbers of points is large compared to the total number of points in the point pattern with more points and it takes the quality of point matchings into account even if the total numbers are not the same .",
    "while @xmath0 is a slightly weaker metric than @xmath5 , it still metrizes the same topology as @xmath5 , and its induced wasserstein metric @xmath1 still metrizes convergence in distribution of point processes and provides an upper bound for the wasserstein distance @xmath37 for many of the useful point pattern statistics @xmath38 that @xmath21 does .",
    "as far as poisson process approximation is concerned , we are able to obtain better bounds in the @xmath1-metric than in the stronger @xmath21-metric for a wide range of situations .",
    "we furthermore present a simulation study that assesses the powers of certain tests based on @xmath0 and demonstrates its usefulness in spatial statistics .",
    "let @xmath3 be a compact metric space with @xmath9 , on which we always consider the borel @xmath39-algebra @xmath40 . denote the space of all finite point measures on @xmath41 by @xmath2 and",
    "equip it as usual with the vague topology and the @xmath39-algebra @xmath42 generated by this topology , which is the smallest @xmath39-algebra that renders the point counts on measurable sets measurable ( see @xcite , section  1.1 , lemma  4.1 , and section  15.7 ) . recall that a point process is just a random element of @xmath2 .",
    "let @xmath0 be the symmetric map @xmath43 that is given by @xmath44 for @xmath45 with @xmath46 , and @xmath47 .",
    "in essence , we arrange for @xmath32 and @xmath33 to have the same number of points by introducing extra points located at distance @xmath31 from @xmath41 , and then take the average distance between the points under a closest match ( which is the @xmath5-distance ) .",
    "[ prop : donebarismetric ] the map @xmath0 is a metric that is bounded by @xmath31 .    the proof of this proposition , as well as further proofs that are of a more technical nature and would otherwise disrupt the flow of the main text can be found in the appendix .",
    "it is convenient to introduce the `` relative difference metric '' @xmath48 on @xmath49 , which is given by @xmath50 for @xmath51 .",
    "the triangle inequality for @xmath48 follows immediately from the triangle inequality for @xmath0 , because we have @xmath52 .",
    "[ prop : donebarprops ] the following statements about @xmath0 hold .    1",
    ".   @xmath53 for all @xmath54 ; 2 .",
    "@xmath0 metrizes the vague ( = weak ) topology on @xmath2 ; 3 .",
    "the metric space @xmath55 is locally compact , complete , and separable .",
    "we next define the metric @xmath1 on the space @xmath56 of probability distributions on @xmath57 just as the wasserstein metric with respect to @xmath0 .",
    "let @xmath58 \\ , ; \\ ; { \\lvert f(\\xi ) - f(\\eta ) \\rvert } \\leq { \\bar{d}_1}(\\xi,\\eta ) \\text { for all $ \\xi , \\eta \\in { \\mathfrak{n}}$ } \\}$ ]",
    ". set then @xmath59 for @xmath60 .    since this is exactly the wasserstein construction ( the fact that we restrict the functions in @xmath61 to be @xmath62$]-valued has no influence on the supremum , because the underlying @xmath0-metric is bounded by @xmath31 ) , it is clear that @xmath1 is a metric that is obviously bounded by @xmath31 , and we can easily derive basic properties . for two probability distributions @xmath63 and @xmath64 on @xmath49 , write @xmath65 , which is the wasserstein distance with respect to @xmath48 ( compare property  ( i ) below ) .    [",
    "prop : dtwobarprops ] the metric @xmath1 satisfies    1 .",
    "@xmath66 for all @xmath67 ; 2 .",
    "@xmath68 for any point processes @xmath69 and @xmath70 ; 3 .",
    "@xmath1 metrizes the weak topology on @xmath56 , so that @xmath71 iff @xmath72 .",
    "by the definition of @xmath1 , upper bounds for a distance @xmath73 also bound the difference @xmath74 for any @xmath75 .",
    "it is thus of considerable interest for the application of estimates such as those obtained in section  [ sec : dests ] to have a certain supply of `` meaningful '' @xmath0-lipschitz continuous statistics of point patterns ( where we do not worry too much about the lipschitz constant as it will only appear as an additional factor in the upper bound ) .    for the @xmath5-metric , a selection of such statistics",
    "was given in section  10.2 of  @xcite and in subsection  3.3.1 of @xcite .",
    "since @xmath0 is in general strictly smaller than @xmath5 , we can not reasonably expect all of these functions to lie in @xmath61 .",
    "however , we are able to recover many of the most important examples , which is illustrated by the two propositions below .",
    "this is mainly due to the fact that these functions take all the points in the pattern into account without fundamentally distinguishing how many there are , which is a situation where a @xmath5-lipschitz condition typically provides too much room in the upper bound .",
    "our first proposition concerns certain @xmath76-statistics with lipschitz continuous kernels ( the former are usually considered for a fixed number of points , but the extension is obvious ) .",
    "see @xcite for detailed results about such statistics .",
    "[ prop : ftwopfunctions ] suppose that @xmath77 and extend the metric @xmath78 to @xmath79 in such a way that it is still bounded by @xmath31 .",
    "fix @xmath80 and write @xmath81 .",
    "let @xmath82 $ ] be a symmetric function that satisfies    1 .",
    "@xmath83 for all @xmath84 ; 2 .   for every @xmath85",
    "there are @xmath86 such that for any @xmath87 and any selection @xmath88 of @xmath89 indices @xmath90 for all @xmath91 ; 3 .   for every @xmath92 we have @xmath93 for all @xmath91 .",
    "define @xmath94 $ ] by @xmath95 for @xmath96 with @xmath97 .",
    "then there exists an extension @xmath98 of @xmath99 to the whole of @xmath2 such that [ 11pt][0pt]@xmath100 .",
    "one possible choice for the function @xmath101 in the above result is half the interpoint distance , i.e. @xmath102 for all @xmath103 .",
    "if @xmath104 for some @xmath105 and @xmath106 for all @xmath107 , we can consider more generally the diameter of the minimal bounding ball , defining @xmath108 for @xmath109 and @xmath110 , where @xmath111 .",
    "it can be shown that this yields again a function @xmath101 that satisfies ( i)(iii ) .",
    "the second proposition looks at the average nearest neighbor distance in a finite point pattern on @xmath112 .",
    "this statistic gives important information about the amount of clustering in the pattern .",
    "[ prop : nndist ] let @xmath113 , and @xmath114 for all @xmath107 .",
    "define the function @xmath115 $ ] by @xmath116 for @xmath96 with @xmath117 .",
    "then there exists an extension @xmath98 of @xmath99 to the whole of @xmath2 that is @xmath0-lipschitz continuous with constant  @xmath118 , where @xmath119 denotes the kissing number in @xmath120 dimensions ( i.e.  the maximal number of unit balls that can touch a unit ball in @xmath112 without producing any overlaps of the interiors ; see @xcite , section  1.2 , for details ) .",
    "fix a point @xmath121 and define @xmath122 for every @xmath123 .",
    "it suffices to show that @xmath124 for @xmath125 with @xmath126 , because this implies that @xmath127     & \\leq { \\bar{d}_1}(\\xi ' , \\eta ' )   \\end{split}\\ ] ] for every @xmath128 .",
    "let then @xmath129 and @xmath130 , where @xmath131 and without loss of generality @xmath132 ( because of the symmetry of the inequality that we would like to show ) .",
    "we add @xmath133 points @xmath134 to @xmath32 in one of the following two ways depending on whether @xmath135 or @xmath136 , and call the result @xmath137 .",
    "if @xmath135 , let @xmath138 , @xmath139 , for points @xmath140 chosen as in assumption ( ii ) with @xmath141 .",
    "it follows that @xmath142 m+1 \\leq i_{j+1 } < \\ldots < i_l \\leq n } } k(x_{i_1 } , \\ldots ,         x_{i_l } ) \\\\     & \\geq \\frac{1}{{m \\choose l } } \\sum_{1 \\leq i_1 < \\ldots < i_l \\leq m }         k(x_{i_1 } , \\ldots , x_{i_l } ) = f(\\xi ) .",
    "\\end{split}\\ ] ] the inequality is a consequence of the fact that @xmath143 if @xmath144 for every @xmath145 ; and the latter condition holds because for @xmath146 ( since @xmath147 if @xmath148 , these pairs can be ignored altogether ) , @xmath149 m+1 \\leq i_{j+1 } < \\ldots < i_l \\leq n } } k(x_{i_1 } , \\ldots ,         x_{i_l } ) \\\\     & \\hspace*{7 mm } \\geq \\frac{1}{{m \\choose j}{n - m \\choose l - j } } \\sum_{\\substack{1 \\leq         i_1 < \\ldots < i_j \\leq m \\\\[1.5pt ] m+1 \\leq i_{j+1 } < \\ldots < i_l \\leq n } } \\frac{1}{{m - j \\choose        l - j } } \\sum_{\\substack{1 \\leq r_{j+1 } < \\ldots < r_l \\leq m \\\\ \\{r_{j+1},\\ldots , r_l\\ } \\cap         \\{i_1,\\ldots , i_j\\ } = \\emptyset } } k(x_{i_1 } , \\ldots , x_{i_j } , x_{r_{j+1 } } , \\ldots , x_{r_l } ) \\\\     & \\hspace*{7 mm } = \\frac{1}{{m \\choose j } } \\frac{1}{{m - j \\choose l - j } } \\sum_{1 \\leq         i_1 < \\ldots < i_j \\leq m } \\ ; \\sum_{\\substack{1 \\leq r_{j+1 } < \\ldots < r_l \\leq m",
    "\\\\         \\{r_{j+1},\\ldots , r_l\\ } \\cap         \\{i_1,\\ldots , i_j\\ } = \\emptyset } } k(x_{i_1 } , \\ldots , x_{i_j } , x_{r_{j+1 } } , \\ldots , x_{r_l } ) \\\\[-1.5 mm ]     & \\hspace*{7 mm } = \\frac{{l \\choose j}}{{m \\choose j}{m - j \\choose l - j } } \\sum_{1 \\leq i_1 < \\ldots < i_l         \\leq m } k(x_{i_1 } , \\ldots , x_{i_l } ) \\\\[1 mm ]     & \\hspace*{7 mm } = \\frac{1}{{m \\choose l } } \\sum_{1 \\leq i_1 < \\ldots < i_l \\leq m }        k(x_{i_1 } , \\ldots , x_{i_l } ) , \\end{split}\\ ] ] where the inequality follows by assumption ( ii ) and the symmetry of @xmath101 .    if on the other hand @xmath136 , let @xmath150 , @xmath139 .",
    "it follows in exactly the same way as for the first case , only this time with `` @xmath151 '' replaced by `` @xmath152 '' and using assumption  ( iii ) instead of assumption  ( ii ) , that @xmath153 .    in total",
    ", we thus obtain @xmath154 where the second inequality follows from the @xmath5-lipschitz continuity of the functions considered in proposition  2.a of @xcite .",
    "fix arbitrary @xmath155 $ ] and define @xmath156 if @xmath157 and @xmath158 otherwise .",
    "let @xmath159 and @xmath160 , where without loss of generality we assume @xmath132 .",
    "since @xmath161 if @xmath162 and @xmath163 , the lipschitz inequality remains to be shown for @xmath164 only .",
    "as before , we bring the cardinalities to the same level .",
    "let @xmath137 , where the points @xmath165 are chosen in the following way .",
    "if @xmath135 , let @xmath165 be arbitrary pairwise distinct points in @xmath112 that are at @xmath78-distance @xmath31 from each other and from @xmath41 . hence @xmath166 because for each of the added points the distance to its nearest neighbor is one , which is maximal .",
    "if on the other hand @xmath136 , let @xmath167 , whence it is immediately clear that @xmath153 because for each of the added points the distance to its nearest neighbor is zero .    in total , we obtain @xmath168 where the second inequality follows from the @xmath5-lipschitz continuity of the average nearest neighbor distance considered in proposition  2.c of @xcite .",
    "in this section we present upper bounds for some essential @xmath1-distances , which all clearly improve on the bounds that are available for the corresponding @xmath21-distances .",
    "however , the improvement in general results is not always as much as one would hope it to be , and it seems that considerably better bounds can be obtained by a more specialized treatment ( see for example subsection  [ ssec : bepo ] ) .",
    "using the fact that @xmath170\\;{{\\boldsymbol{\\lambda}}}(d\\alpha)+\\int_{\\mathcal{x}}[h(\\xi-\\delta_\\alpha)-h(\\xi)]\\;\\xi(d\\alpha),\\ \\xi\\in{\\mathfrak{n } } , \\label{generator1}\\ ] ] is the generator of the spatial immigration - death process whose steady state distribution is the poisson process with expectation measure @xmath171 , @xcite establish the stein identity for poisson process approximation as @xmath172 for suitable test functions @xmath99 on @xmath2 .",
    "the solution for ( [ steinidentity1 ] ) is given by @xmath173\\;dt , \\label{solution1}\\ ] ] where @xmath174 is an immigration - death process with generator @xmath175 and initial point pattern @xmath176 .",
    "using steinidentity1 and different characteristics of point processes , we can establish various poisson process approximation error bounds ( see @xcite , @xcite , @xcite , and @xcite ) . to keep our text concise ,",
    "we present here a slightly simplified version of the main result in @xcite only ; it is an obvious exercise to apply our estimates bounddelta1 and bounddelta2 to get parallel results in the other articles mentioned above .",
    "we assume that , for each @xmath177 , there is a borel set @xmath178 such that @xmath179 and the mapping @xmath180 is product measurable , where @xmath181 stands for the point pattern of @xmath32 restricted to @xmath182 ( @xcite , section  1.1 ) .",
    "such requirement can be ensured by @xmath183 measurable in @xmath184 ( see @xcite ) .",
    "we define , for any function @xmath185 on @xmath2 , that @xmath186    [ chenxia04thm ] for each bounded measurable function @xmath187 , let @xmath188 be the solution solution1 of equation  steinidentity1 . if @xmath69 is a point process on @xmath41 with expectation measure @xmath171 , then @xmath189 & & \\le{{\\mathbb{e}}}\\int_{{{\\mathcal{x } } } } \\delta^2h_f(\\xi|_{a_\\alpha^c})(\\xi(a_\\alpha)-1)\\ ; \\xi(d\\alpha)\\\\ & & \\ \\ \\ + { { \\mathbb{e}}}\\int_{{{\\mathcal{x}}}}\\left|[h_f(\\xi|_{a_\\alpha^c})-h_f(\\xi|_{a_\\alpha^c}+\\delta_\\alpha ) ] -[h_f(\\xi_\\alpha|_{a_\\alpha^c})-h_f(\\xi_\\alpha|_{a_\\alpha^c}+\\delta_\\alpha)]\\right|\\ ; { { \\boldsymbol{\\lambda}}}(d\\alpha)\\\\ & & \\ \\ \\ + { { \\mathbb{e}}}\\int_{{{\\mathcal{x } } } }           \\delta^2h_f(\\xi|_{a_\\alpha^c})\\xi(a_\\alpha)\\ ; { { \\boldsymbol{\\lambda}}}(d\\alpha),\\end{aligned}\\ ] ] where @xmath190 is the palm process of @xmath69 at location @xmath177 ( @xcite , chapter  10 ) .    the error bounds for poisson process approximation like theorem  [ chenxia04thm ] ( see @xcite , @xcite , @xcite , and @xcite for full details ) pivot on the estimates of @xmath191 and @xmath192 .",
    "the following proposition summarizes these estimates for @xmath1 .",
    "let @xmath193 then for each @xmath0-lipschitz function @xmath99 , we have @xmath194 where @xmath195 and @xmath196 .    for convenience , we write @xmath197 and @xmath198 .",
    "let @xmath199 and @xmath200 be independent exponential random variables with mean @xmath31 which are also independent of @xmath174 ; then one can write @xmath201 hence it follows from solution1 and the @xmath0-lipschitz property of @xmath99 that @xmath202\\;dt\\right|\\label{delta1proof1}\\\\ & { \\hspace*{-0.55em}\\leq\\hspace*{-0.55em}}&\\int_0^\\infty e^{-t}{{\\mathbb{e}}}\\frac{1}{z_\\xi(t)+1}\\;dt\\label{delta1proof2}\\\\ & { \\hspace*{-0.55em}\\leq\\hspace*{-0.55em}}&\\int_0^\\infty e^{-t}\\;dt=1.\\nonumber\\end{aligned}\\ ] ] also , @xmath203\\;dt\\right|\\label{delta2proof1}\\\\ & { \\hspace*{-0.55em}\\leq\\hspace*{-0.55em}}&\\int_0^\\infty e^{-2t}{{\\mathbb{e}}}\\left[\\frac{1}{z_\\xi(t)+2}+\\frac{1}{z_\\xi(t)+1}\\right]\\;dt\\label{delta2proof2}\\\\ & { \\hspace*{-0.55em}\\leq\\hspace*{-0.55em}}&1.5\\int_0^\\infty e^{-2t}dt=0.75.\\label{delta2proof3}\\end{aligned}\\ ] ] however , since @xmath174 has constant immigration rate @xmath171 and unit per capita death rate , it is possible to write @xmath204 where @xmath205 is a pure death process with unit per capita death rate independent of @xmath206 .",
    "direct verification gives that @xmath207 follows the poisson distribution with mean @xmath208 , while @xmath209 follows @xmath210 .",
    "hence @xmath211 @xmath212^ne^{-\\lambda_t(1-x)}\\;dx\\nonumber\\\\ & { \\hspace*{-0.55em}\\leq\\hspace*{-0.55em } } & \\int_0 ^ 1e^{-(ne^{-t}+\\lambda_t)(1-x)}\\;dx\\le \\int_0 ^ 1e^{-(n\\wedge\\lambda)(1-x)}\\;dx=\\frac{1-e^{-n\\wedge\\lambda}}{n\\wedge\\lambda},\\label{delta2proof5}\\end{aligned}\\ ] ] and similarly , @xmath213^ne^{-\\lambda_t(1-x)}\\;dx\\nonumber\\\\ & { \\hspace*{-0.55em}\\leq\\hspace*{-0.55em } } & \\int_0 ^ 1xe^{-(n\\wedge\\lambda)(1-x)}\\;dx=\\frac{1}{n\\wedge \\lambda }      -\\frac{1}{(n\\wedge\\lambda)^2}(1-e^{-n\\wedge\\lambda}).\\label{delta2proof6}\\end{aligned}\\ ] ] the claim @xmath214 is obvious for @xmath215 as the right hand side is already greater than 1 , so it remains to show delta1proof5 for @xmath216 . combining delta1proof2 and delta1proof4 , with @xmath217 , we get @xmath218 where @xmath219 is the euler constant and the last inequality is due to items 5.1.39 and 5.1.19 of @xcite . for @xmath220 , @xmath221 since @xmath222 is increasing for @xmath216 , and for @xmath223 , @xmath224 because the function @xmath225 is decreasing , completing the proof of delta1proof5 .",
    "the last claim in bounddelta1 is easily obtained from delta1proof2 and delta2proof5 .",
    "we then apply delta2proof5 and delta2proof6 in delta2proof2 to obtain @xmath226 now , we show that @xmath227 as a matter of fact , by delta2proof3 and delta2proof7 , delta2proof8 clearly holds for @xmath228 and @xmath229 , hence it remains to show delta2proof8 for @xmath230 .",
    "using delta2proof4 , it suffices to prove that @xmath231 however , for @xmath232 @xmath233 while for @xmath234 , one can verify delta2proof9 for each value of @xmath235 .    finally , we prove @xmath236 the claim delta2proof10 is evident for @xmath237 , so we assume @xmath238 . on the other hand ,",
    "if @xmath239 follows @xmath240 , then @xmath241 therefore , @xmath242 which , together with delta2proof2 , ensures that @xmath243 where the first equality is by the change of variable @xmath217 and the last inequality is from items 5.1.39 and 5.1.19 of @xcite .",
    "now , @xmath244 is decreasing in @xmath245 for @xmath223 and @xmath246 , which implies that @xmath247 for @xmath248 , completing the proof of delta2proof10 .",
    "the following counter - example , adapted from @xcite , shows that the logarithmic factors in bounddelta1 and bounddelta2 can not be removed .",
    "let @xmath249 with metric @xmath250 , let @xmath171 satisfy @xmath251 and @xmath252 , and define a @xmath0-lipschitz function on @xmath2 as @xmath253 using the fact that @xmath254 follows @xmath255 and @xmath256 follows @xmath257 , we have from delta1proof1 and delta2proof1 that , as @xmath258 , @xmath259\\;dt\\\\ & { \\hspace*{-0.55em}=\\hspace*{-0.55em}}&\\int_0^\\infty e^{-t}\\frac{1-e^{-(\\lambda-1)(1-e^{-t})}}{(\\lambda-1)(1-e^{-t})}e^{-(1-e^{-t})}\\;dt\\\\ & { \\hspace*{-0.55em}=\\hspace*{-0.55em}}&\\int_0 ^ 1 \\frac{1-e^{-(\\lambda-1)s}}{(\\lambda-1)s}e^{-s}\\;ds\\ \\ \\ ( \\mbox{where } s=1-e^{-t})\\\\ & { \\hspace*{-0.55em}\\geq\\hspace*{-0.55em}}&\\frac{e^{-1}}{\\lambda-1}\\int_0^{\\lambda-1 } \\frac{1-e^{-u}}{u}\\;du\\,\\asymp\\ , \\frac{\\ln\\lambda}{\\lambda},\\end{aligned}\\ ] ] and @xmath260    as noted before , @xmath0 is the same as @xmath5 when the point patterns have the same number of points while it is smoother than @xmath5 when the point patterns do not have the same number of points . on the other hand , for any two point processes @xmath69 and @xmath70 on @xmath41 , we have @xmath261 + { { \\mathbb{p}}}[|\\xi|\\ne|{\\mathrm{h}}| ] .",
    "\\label{xia : comment1}\\ ] ] when we consider @xmath262 $ ] , which corresponds to the total variation distance between the distributions of the total number of points of the two point processes ( see * ? ? ? * ) , there is no such logarithmic component in stein s factor , which means that the logarithmic component in @xmath5 was brought in only by the discrepancies of locations of points when the point patterns have the same number of points .",
    "however , this problem is shared by @xmath0 , that is , the stein factors for @xmath0 will inevitably have the logarithmic component as well .",
    "it is also worthwhile to note that , since @xmath263 replaces the term @xmath264 $ ] in xia : comment1 with a smaller @xmath265 , we would expect a bigger improvement on bounding @xmath266 when @xmath264 $ ] is `` dominant '' at the right hand side of xia : comment1 under the best coupling .",
    "such an improvement is obtained in the next two subsections .",
    "let @xmath267 $ ] with @xmath250 , and let @xmath268 be independent and identically distributed bernoulli random variables with @xmath269=p$ ] .",
    "then @xmath270 defines a bernoulli process on @xmath41 .",
    "if we let @xmath271 , @xmath272 , @xmath273 , @xmath274 be independent and identically distributed uniform random variables on @xmath41 which are also independent of @xmath275 , then @xmath276 defines a binomial process on @xmath41 @xcite . by @xcite , @xmath277 to estimate @xmath278 with @xmath279",
    ", we employ stein s method for poisson process approximation . as a matter of fact",
    ", it follows from generator1 that @xmath280 where @xmath281 .",
    "define @xmath282 then @xmath283 where @xmath284 denotes the supremum norm and , for any two nonnegative integer - valued random variables @xmath285 and @xmath286 , @xmath287 } { \\bigl| { \\mathbb{e}}{\\tilde{g}}(u_1 ) - { \\mathbb{e}}{\\tilde{g}}(u_2 ) \\bigr|}.\\ ] ]    on the other hand , by lemma  1 in @xcite , @xmath288\\le 1\\wedge\\frac{1}{2\\sqrt{(n-1)p(1-p)}}\\ ] ] and using bounddelta1 , we have , for @xmath289 , that @xmath290 which implies from steinidentity1 that @xmath291 now , collecting zx1 and binomialprocesstopoisoon gives    [ poissonbernoullithm ] with the above setup , we have @xmath292    an immediate message from theorem  [ poissonbernoullithm ] is that , if @xmath235 is large , it is almost impossible to distinguish between the distributions of the two processes",
    ". it is quite a contrast to the conclusion under @xmath5 where it is essential to have a very small @xmath19 as well as a large @xmath235 to ensure a valid poisson process approximation ( see @xcite ) . in practice",
    ", statisticians would use a poisson process rather than a bernoulli process when @xmath235 is large , confirming our conclusion under  @xmath0 .",
    "it is a tantalizing problem to remove the @xmath293 term in the upper bound .",
    "we conjecture that , at the cost of more complexity , the actual bound should be of order @xmath294      let @xmath295 and @xmath296 , where @xmath297 and @xmath298 are integer - valued random variables , @xmath299 is a sequence of i.i.d .  @xmath41-valued random elements that is independent of @xmath297 , and @xmath300 is a sequence of i.i.d .  @xmath41-valued random elements that is independent of @xmath298 .",
    "denote by @xmath301 the wasserstein metric between random elements of @xmath41 with respect to @xmath78 .",
    "[ prop : iidpoints ] we have @xmath302 where @xmath303 ,        { \\mathbb{p}}[n>0 ] \\bigr)}\\ ] ] and @xmath304 , { \\mathbb{p}}[n>0 ] \\bigr)}\\ ] ] for random variables @xmath305 and @xmath306 that are coupled so that @xmath307 .",
    "an interesting special case is given if @xmath69 and @xmath70 are poisson processes .",
    "for finite measures @xmath308 and @xmath309 on @xmath41 , we obtain from proposition  [ prop : iidpoints ] that @xmath310 which is an improvement by a factor of order @xmath311 for @xmath312 in the first summand when compared to a corresponding @xmath21-bound ( see for example @xcite , equation  ( 2.8 ) ) .",
    "estimation of the @xmath313-term was achieved by considering a poisson process @xmath314 on @xmath315 with intensity  @xmath31 and defining a coupling pair by @xmath316)$ ] and @xmath317)$ ] .    _",
    "upper bound : _",
    "let @xmath318 and @xmath319 be coupled according to a @xmath313-coupling , so that @xmath320 , and let @xmath321 and @xmath322 with @xmath323 for every @xmath324 in such a way that the pairs @xmath325 , @xmath326 , @xmath327 are independent .",
    "we then obtain @xmath328 which , by the independence between @xmath325 and @xmath329 , and the assumptions on the distributions of those pairs , yields the upper bound claimed .",
    "the bound for the factor @xmath330 follows from @xmath331 $ ] and @xmath332 = \\min \\bigl ( { \\mathbb{p}}[m=0 ] , { \\mathbb{p}}[n=0 ] \\bigr)$ ] , the proof of which is straightforward .    _",
    "lower bound : _",
    "let @xmath333 ; \\ ,     { \\lvert g(x ) - g(y ) \\rvert } \\leq { d_{0}}(x , y ) \\text { for all } x , y \\in { \\mathcal{x}}\\bigr\\}$ ] , and let @xmath334 be a mapping with @xmath335 .",
    "such a mapping exists by @xmath336 , where the supremum is attained because @xmath337 is a compact subset of @xmath338 by the arzel - ascoli theorem and the mapping @xmath339 $ ] is continuous ( both statements are with respect to the topology of uniform convergence ) .",
    "define @xmath340 $ ] by @xmath341 for @xmath342 and @xmath343 .",
    "we next check that @xmath344 .",
    "it is immediately clear that @xmath345 if @xmath342 .",
    "let then @xmath159 and @xmath346 both be in @xmath347 , where we assume without loss of generality that @xmath132 and @xmath348 ( otherwise interchange @xmath32 and @xmath33 and/or replace  @xmath349 by @xmath350 ) , and that the points are numbered according to a @xmath0-pairing such that @xmath351 .",
    "let @xmath352 , and @xmath353 for @xmath354 , which implies @xmath355 and therefore @xmath344 .",
    "choose pairs @xmath356 in the same way as for the proof of the upper bound ( although the coupling of @xmath357 and @xmath358 in each of the pairs is not important now ) .",
    "we obtain @xmath359        & { \\hspace*{12 mm } { } + { \\mathbb{e}}\\biggl\\ { \\biggl ( \\frac{1}{{\\tilde{m } } } \\sum_{i=1}^{{\\tilde{m } } } { \\tilde{g}}({\\tilde{x}}_i ) - { \\mathbb{e}}{\\tilde{g}}(x_1 )           \\biggr ) { \\bf 1}_{\\{{\\tilde{m } } > 0 , { \\tilde{n}}= 0\\ } } \\biggr\\ } } \\\\[-1.5 mm ]        & { \\hspace*{12 mm } { } + { \\mathbb{e}}\\biggl\\ { \\biggl ( { \\mathbb{e}}{\\tilde{g}}(x_1 ) - \\frac{1}{{\\tilde{n } } } \\sum_{j=1}^{{\\tilde{n } } }               { \\tilde{g}}({\\tilde{y}}_j ) \\biggr ) { \\bf 1}_{\\{{\\tilde{m}}= 0 , { \\tilde{n } } > 0\\ } } \\biggr\\ } }   \\biggr| } \\\\        & = { \\bigl|   { \\bigl({\\mathbb{e}}{\\tilde{g}}(x_1 ) - { \\mathbb{e}}{\\tilde{g}}(y_1 ) \\bigr ) \\ , { \\mathbb{p}}[{\\tilde{m}}>0 , { \\tilde{n}}>0 ] } \\\\[-1.5 mm ]         & { \\hspace*{12 mm } { } + \\bigl({\\mathbb{e}}{\\tilde{g}}(x_1 ) - { \\mathbb{e}}{\\tilde{g}}(y_1 ) \\bigr ) \\ , { \\mathbb{p}}[{\\tilde{m}}=0 , { \\tilde{n}}>0 ] } \\bigr|}\\\\[1 mm ]        & = { d_{w}}\\bigl ( { \\mathscr{l}}(x_1 ) , { \\mathscr{l}}(y_1 ) \\bigr ) \\ , { { \\mathbb{p}}[n > 0]}.     \\end{split}\\ ] ] since the above argument is symmetric in @xmath69 and @xmath70 , we obtain the lower bound when combining it with proposition  [ prop : dtwobarprops](ii ) .",
    "in order to show the potential of @xmath0 and @xmath1 in statistical applications , we propose a test procedure based on these two metrics .",
    "suppose that our data consists of a few i.i.d .",
    "realizations of a point process @xmath69 , and we would like to test if @xmath360 for a certain probability measure @xmath24 on @xmath2 . such multiple point pattern data may arise , among other examples , from recording degenerate cells in tissue samples or plants in a large population that is sampled only via a few comparatively small windows .    in what follows , we restrict our attention to a test for spatial homogeneity under the assumption that @xmath69 is a poisson process on @xmath361 ^ 2 $ ] with unknown expectation measure @xmath171 .",
    "this limits the alternative hypothesis sufficiently to keep our simulation study within the scope of this article .",
    "suppose that @xmath362 are realizations of i.i.d .",
    "copies @xmath363 of @xmath69 and that the total mass @xmath364 ^ 2)$ ] of the expectation measure @xmath171 is known ( otherwise we just take the canonical estimate @xmath365 ) .",
    "our null hypothesis is then @xmath366 .",
    "write @xmath367 for the empirical distribution of our data .",
    "we perform a monte carlo test where the test statistic would ideally be @xmath368 but since this is computationally intractable , we replace it by the randomized test statistic @xmath369 where @xmath370 for realizations @xmath371 of @xmath372-processes @xmath373 that are independent amongst each other and of the @xmath374 .",
    "the null hypothesis is rejected at significance level @xmath375 if @xmath376 ranks among the five highest values when pooled with 99 simulations of @xmath377 , where @xmath378 are all independent @xmath372-realizations .",
    "we choose @xmath379 , @xmath380 for the simulation study , which is both realistic for actual data and keeps computation times at a tolerable level .",
    "one single test of two series of 12 point patterns takes less than three seconds ( given the simulated null hypothesis distribution ) on an ordinary laptop computer using the library spatstat ( see @xcite ) that supplies tools for the analysis of spatial point patterns within the statistical computing environment r ( @xcite ) . increasing either @xmath298 to @xmath381 or @xmath245 to @xmath382 while keeping",
    "the other parameter fixed , still keeps the computation time well under one minute . note that the optimal point assignments needed for computing @xmath0 , and also @xmath1 between empirical measures , can be found efficiently ( in @xmath383 steps , where @xmath384 and @xmath235 are the cardinalities of the point patterns ) by using the so - called hungarian method from linear programming ( see * ? ? ?",
    "* section  11.2 ) .",
    "table  [ tab : powers ] summarizes the results of our simulations .",
    "the first column gives the monte carlo powers of our test against @xmath385-alternatives , where @xmath386 for @xmath387 $ ] and @xmath388 .",
    "see figure  [ fig : alternatives ] to obtain an impression of the corresponding distributions .",
    "by monte carlo power we mean the fraction of the number of rejected tests in 100 independent simulations of the alternative .    for many applications it would be desirable to generalize @xmath0 by introducing an order parameter @xmath389 and a cut - off value @xmath390 , which leads to the definition of @xmath391 for @xmath45 with @xmath46 , where @xmath78 of course no longer needs to be bounded and",
    "is just taken to be the euclidean metric here .",
    "we stick to the case @xmath392 , but give in the second column of table  [ tab : powers ] the corresponding monte carlo powers if the cut - off is chosen to be @xmath393 instead of @xmath31 , so that our test now puts less emphasis on cardinalities and more emphasis on positional differences in the compared point patterns than it did before .",
    "there is no strong reason for choosing exactly @xmath393 ; the value reflects the somewhat vague idea that in an optimal pairing of about @xmath394 points each , the pairing distances are `` usually '' still below 0.3 . as one can see from table  [ tab : powers ] , the power improvement is very noticeable , and especially this second test detects the inhomogeneity quite well even if they are not very clearly visible by eyeball observation of the simulated data .    for comparison",
    "we have also added the results of the corresponding tests if @xmath0 is replaced by @xmath5 . since there is typically a wide range of values for the cardinalities of realizations of a poisson process with @xmath394 expected points , and since differing cardinalities are not appropriately addressed by @xmath5 , these tests perform very poorly ( for @xmath395 , powers seem to lift off from @xmath396 on ) .",
    ".powers of the tests for two different cut - off values @xmath397 against increasingly conspicuous alternatives .",
    "the last two columns give the corresponding results when the test is based on the metric @xmath5 instead of @xmath0 and are listed for comparison only . [",
    "cols=\"^,^,^,^,^ \" , ]     in summary , the above procedure is rather successful for testing spatial homogeneity from multiple point patterns .",
    "we also have obtained promising first results when testing for spatial dependence , but a more extensive further study will be necessary in order to establish the possibilities and limitations of this test procedure and of tests or other statistical analyses based on the @xmath0-metric in general .",
    "from the definition it is clear that @xmath398 , that @xmath399 if and only if @xmath400 and that @xmath401 . to show the triangle inequality let @xmath402 , and add two points @xmath403 and @xmath404 to @xmath41 , extending @xmath78 by @xmath405 for every @xmath406 .",
    "note that for @xmath407 it is straightforward to see that @xmath408 which is the essential step in proving the triangle inequality for @xmath5 .",
    "we now prove that @xmath409 , assuming that at most one of the point patterns is empty ( otherwise the relation is clearly satisfied ) . since this inequality is symmetric in @xmath32 and @xmath33 , we assume without loss of generality that @xmath410 in what follows .",
    "we show two separate cases .",
    "_ case  1 , @xmath132 _ : let @xmath411 for @xmath412 and @xmath413 for @xmath414 , and write @xmath137 and @xmath415 . we then have @xmath416 using that @xmath417 implies @xmath418 for the first inequality , and   for the second inequality .",
    "_ case  2 , @xmath419 _ : let @xmath420 for @xmath421 and @xmath422 , and choose @xmath423 in such a way that [ 12pt][5pt]@xmath424 and @xmath425 .",
    "we have @xmath426     & \\leq { \\bar{d}_1}(\\xi,\\zeta ) + { \\bar{d}_1}(\\zeta,\\eta ) , \\end{split}\\ ] ] where we used for the second inequality .",
    "statement  ( i ) is straightforward from the definitions of @xmath48 , @xmath0 and @xmath5 .",
    "_ statement ( ii ) .",
    "_ proposition  4.2 in @xcite states that @xmath427 vaguely if and only if @xmath428 as @xmath429 ; so all we need to show is that the latter is equivalent to @xmath430 .    if @xmath430 , we have by ( i ) that @xmath431 , from which it is easily seen that @xmath432 , i.e.  there is an @xmath433 such that @xmath434 and hence @xmath435 for every @xmath436 . thus @xmath428 . the converse direction follows immediately from @xmath437 .",
    "_ statement ( iii ) . _",
    "the local compactness and separability properties depend only on the generated topology .",
    "see for example proposition  4.3 in @xcite for the proof .",
    "note that , by the compactness of @xmath41 , the sets @xmath438 are compact for all @xmath439 .    it remains to show the completeness .",
    "let @xmath440 be a @xmath0-cauchy sequence in @xmath2 .",
    "it is straightforward to see that this implies the existence of an @xmath433 such that @xmath441 for every @xmath442 , which means that there is an @xmath439 such that the tail of @xmath440 is a cauchy sequence in @xmath443 . by the compactness of @xmath443 this tail converges .",
    "statement  ( i ) is an immediate consequence of the kantorovich - rubinstein theorem , where the minimum is attained , because @xmath55 is complete .",
    "see @xcite , section 11.8 , for details .",
    "statement  ( ii ) follows by taking expectations and minima in proposition  [ prop : donebarprops](i ) .",
    "the last statement follows from @xcite , theorem  11.3.3 , using proposition  [ prop : donebarprops](ii ) and noting that @xmath1 is an instance of dudley s @xmath444-metric .",
    "this work was supported by the arc centre of excellence for mathematics and statistics of complex systems ( ax ) , the arc discovery grant no .",
    "00530/53001000 ( ds ) , and the schweizerischer nationalfonds fellowship",
    "pbzh2 - 111668 ( ds ) .",
    "+ ds would like to thank adrian baddeley for stimulating discussions about spatial statistics .",
    "xia , a. 2005 .",
    "stein s method and poisson process approximation , _ an introduction to stein s method _ , vol .  4 of _ lect .",
    "notes ser .",
    "_ , singapore univ . press ,",
    "singapore , pp ."
  ],
  "abstract_text": [
    "<S> most metrics between finite point measures currently used in the literature have the flaw that they do not treat differing total masses in an adequate manner for applications . </S>",
    "<S> this paper introduces a new metric @xmath0 that combines positional differences of points under a closest match with the relative difference in total mass in a way that fixes this flaw . </S>",
    "<S> a comprehensive collection of theoretical results about @xmath0 and its induced wasserstein metric @xmath1 for point process distributions are given , including examples of useful @xmath0-lipschitz continuous functions , @xmath1 upper bounds for poisson process approximation , and @xmath1 upper and lower bounds between distributions of point processes of i.i.d .  </S>",
    "<S> points . </S>",
    "<S> furthermore , we present a statistical test for multiple point pattern data that demonstrates the potential of @xmath0 in applications . </S>",
    "<S> + _ keywords : _ wasserstein metric , point process , poisson point process , stein s method , distributional approximation , statistical analysis of point pattern data + _ ams 2000 subject classifications . </S>",
    "<S> _ primary 60g55 ; secondary 60f05 , 62m30 </S>"
  ]
}