{
  "article_text": [
    "let us consider a system consisting of a waveguide connecting 2 ports as illustrated in fig .",
    "a resonator supporting a mode with frequency @xmath21 is coupled to this waveguide at @xmath19 independent coupling points , such that each coupler is spatially separated on the waveguide by an identical length @xmath20 . for simplicity , we assume that these couplers are all connected to the resonator at anti - nodes of equal phase for the resonant mode at @xmath21 . using the framework of temporal coupled mode theory @xcite , we will first derive an effective coupling coefficient for this system , and we will show later that the effective coupling is sensitive to the direction of wave propagation when spatiotemporal modulation is applied to the individual coupling coefficients .",
    "the use of coupled mode theory generalizes the analysis allowing for implementation with electromagnetic , optical , or acoustic waves without changing the underlying systemic principles .",
    "we can describe the complex - valued excitation amplitude @xmath16 of the resonant standing wave mode ( traveling modes are discussed in the supplementary information section s1 ) through equation ( [ eqin ] ) , @xmath22 where @xmath21 and @xmath23 describe the frequency and decay rate of the resonance , and @xmath24 is the analysis frequency of the waves traveling into the ports .",
    "waves incident on port 1 , described by @xmath25 , are coupled to the resonator with effective coupling @xmath26 , which is the sum of contributions from all @xmath19 couplers @xmath27 here @xmath28 describes the coupling strength of the @xmath29 coupler , numbered such that @xmath30 is nearest to port 1 and @xmath31 is nearest to port 2 .",
    "waves incident on port 2 ( @xmath32 ) are likewise coupled to the resonator through the effective coupling strength @xmath33 we here assume that losses in the waveguide can be neglected and propagation is solely described by the waveguide phase constant @xmath34 . in general , the spatial separation of the multiple couplers causes the effective couplings @xmath26 and @xmath35 to be sensitive to the direction of wave propagation . although this directional sensitivity does not in general lead to nonreciprocity , it is a crucial part of the nonreciprocal coupling theory that we develop in this paper . as a practical consideration",
    "we note that the waveguide propagation constant @xmath34 will be a function of frequency due to the waveguide dispersion , and will result in some deviation from this theory .",
    "for simplicity we will ignore the effects of waveguide dispersion .",
    "for a 2-port system to be nonreciprocal it is sufficient that the transmission coefficients @xmath36 and @xmath37 are not equal .",
    "these steady - state transmission coefficients are defined as @xmath38 ( with @xmath39 ) and @xmath40 ( with @xmath41 ) where @xmath42 and @xmath43 ( the outgoing wave amplitudes at port 2 and port 1 ) are defined by equation ( [ eqout ] ) @xmath44 for the simple case where each coupler has the same coupling strength @xmath45 , we can find a compact form of the transmission coefficients @xmath46    ~,\\ ] ] where we have introduced a dimensionless periodic function @xmath47 that describes the squared efficiency of the effective coupling .",
    "@xmath47 is defined as @xmath48 and is described in detail in the supplementary information .",
    "this function is symmetric about @xmath49 and periodic such that @xmath50 for integer @xmath51 , and concisely describes the effective excitation of the resonant mode resulting from interference due to the multiple couplers .",
    "the zeros of @xmath47 arise when the interference is completely destructive ( i.e. the resonator and waveguide are phase mismatched ) and the resonant mode is not excited at all . note that the resonator decay rate @xmath23 can be defined as @xcite @xmath52 where @xmath53 @xmath54 denotes the time - average .",
    "therefore @xmath23 can also be expressed in terms of @xmath55 , making the efficiency function extremely useful in simplifying the system equations . here",
    "@xmath56 describes the intrinsic decay rate of the resonator .",
    "let us now consider the case where the coupling strength at each individual coupling point is sinusoidally modulated with amplitude @xmath57 and frequency @xmath17 around a static value @xmath58 , where @xmath59 .",
    "additionally , we apply a discretely spaced phase shift @xmath60 to the modulation term for the @xmath61 coupler such that @xmath62 .",
    "this phase shift creates a discretized traveling modulation wave , or in other words a ` synthetic phonon ' having a wave - vector controlled by the relative phase @xmath63 .",
    "we can apply this spatiotemporally varying coupling to equations ( [ eqin ] , [ eqout ] ) to find the steady - state transmission coefficients @xmath64 e^{-j \\beta \\ell ( n-1 ) } ~ \\textrm { , and }      \\end{split}\\ ] ] @xmath65 e^{-j \\beta \\ell ( n-1 ) } .",
    "\\end{split}\\ ] ]    equations ( [ eqf ] , [ eqb ] ) define transmission for incident and outgoing waves of the same frequency @xmath24 and do not explicitly describe outgoing waves at other frequencies .",
    "recalling from equation ( [ eqn : gamma ] ) that @xmath23 is dependent on the squared magnitude of the effective coupling we note that resonator decay rate will increase when this type of modulation is applied , which is in fact required for energy conservation .",
    "the above transfer functions reveal distinct transmission dips at the original resonance @xmath21 and at sidebands @xmath66 .",
    "notably , in the sidebands the @xmath47 function is offset by the modulation phase difference @xmath63 , with the sign of this offset determined by the direction of wave propagation in the waveguide . in the general case we have @xmath67 implying that the sideband transmission coefficients @xmath36 and @xmath37 are unequal and the system is nonreciprocal .",
    "this nonreciprocity condition is always satisfied if neither @xmath68 nor @xmath63 is an integer multiple of @xmath69 .",
    "the induced nonreciprocity in this system is clearly of the canonical form @xmath70 , since a transformation of @xmath71 is equivalent to @xmath72 in the equation for @xmath28 .    , [ eqb ] ) ) through the system of fig .",
    "[ fig1]*b * at the upper sideband frequency @xmath73 , where @xmath17 is the frequency of the applied coupler modulation .",
    "rows indicate the case of two ( @xmath74 ) and three ( @xmath75 ) coupling points , corresponding to the simplest possible implementations of nonreciprocal coupling .",
    "for each figure , the x - axis represents the phase - separation ( @xmath68 ) between adjacent couplers , while the y - axis represents the relative phase setting ( @xmath63 ) of the applied modulation at each coupler . in a typical system @xmath76",
    "will correspond to the physical design while @xmath63 is a dynamically adjustable parameter .",
    "low transmission corresponds to stronger coupling , since the incoming waves are absorbed by the resonator .",
    "as anticipated , the effective total coupling differs for forward ( @xmath36 ) and backward ( @xmath37 ) propagating waves .",
    "the transmission coefficients are mirrored about @xmath77 , demonstrating the relationship @xmath78 .",
    "large contrast can be achieved in a system of 3 coupling points designed with @xmath79 having a relative phase setting of @xmath80 .",
    ", scaledwidth=75.0% ]    figure ( [ fig2 ] ) shows theoretically calculated transmission at the upper sideband frequency @xmath73 for systems having two and three couplers ( @xmath81 ) , corresponding to the simplest possible implementations .",
    "the transmission at the lower sideband can be found by simply reversing the sign of @xmath63 , as seen in equations ( [ eqf ] , [ eqb ] ) .",
    "this figure is simplified such that @xmath34 does not vary with frequency , a useful approximation if the variation is small over the desired frequency range .",
    "we find that the largest transmission dips are centered on the zeros of @xmath55 , i.e. the values of @xmath68 where the original resonant mode at @xmath21 is totally uncoupled from the waveguide .",
    "the sidebands can still couple at these points with a coupling efficiency described by @xmath82 , but the overall decay rate of the mode ( @xmath23 ) is minimized because there is no decay at the center frequency .",
    "the minimized decay rate means the quality - factor of the resonance is maximized and the dip is transmission as deep and narrow as possible . by extension of this idea , for a given sideband coupling rate the transmission dip in that sideband will increase in depth and decrease in width as coupling to the original resonance decreases .",
    "figure [ fig2 ] illustrates that for the @xmath74 system the maximum transmission dip occurs at @xmath83 , a symmetry point of @xmath84 that unfortunately exhibits a reciprocal transmission response .",
    "this symmetry problem is easily overcome in a @xmath85 system , since zeros of @xmath84 will then occur away from @xmath83 .",
    "notably , for @xmath75 the transmission is maximally nonreciprocal for @xmath86 and a relative phase setting of @xmath80 .",
    "we additionally note that more couplers will also increase the total effective coupling to the mode as evidenced by the @xmath87 term in equations ( [ eqf ] , [ eqb ] ) , implying greater transmission contrast if implemented .",
    "we note that the derivation presented here describes a standing wave resonator , where incident waves from both ports are coupled to the same resonant mode .",
    "as we discuss in the supplementary information , the method we propose for creating nonreciprocal transmission can also be applied to a traveling wave resonator having intrinsic directionality to its resonant modes .",
    "in fact , since the effective coupling itself is direction sensitive , our approach is generally independent of the type of resonator used .",
    "however , care must be taken when using a standing wave resonator since simultaneous incident waves from both ports can interfere in the resonator .",
    "this problem is automatically resolved if waves in one direction are completely uncoupled from the resonance , which is also necessary for a maximum nonreciprocal response and lossless propagation in the uncoupled direction .",
    "a common goal of nonreciprocal networks is to create a strong directional effect , such as complete isolation or a unidirectional phase - shift . in order to create these effects through nonreciprocal coupling",
    ", it is useful if waves propagating in one direction are strongly coupled to the resonant mode while counter - propagating waves are completely uncoupled .",
    "this special case occurs when @xmath88 and @xmath89 , and when applied to equations ( [ eqf ] , [ eqb ] ) we see that transmission in the uncoupled direction becomes lossless ( @xmath90 ) .",
    "for example , this occurs for @xmath91 when @xmath92 ( see fig .",
    "s2 in the supplementary information ) . when the additional condition that @xmath93 is met the system is critically coupled and behaves as an ideal isolator at the sideband frequency , with unity transmission magnitude in one direction and no transmission in the other .",
    "note that is also applies if the sign of @xmath63 is flipped .",
    "a network that imparts a unidirectional @xmath69 phase - shift , often called a gyrator , is an important nonreciprocal component that can be used to create circulators and more complex nonreciprocal circuits .",
    "our system can behave as a gyrator if certain conditions are met .",
    "specifically , waves from one direction must be uncoupled from the resonance while counter - propagating waves are strongly coupled at one of the sidebands ( @xmath88 and @xmath89 ) .",
    "simultaneously , waves traveling in both directions must be uncoupled at the original resonance and the other sideband .",
    "this can be achieved with a waveguide that is dispersive or has a bandgap . in this configuration",
    "an ideal gyrator can be approached as @xmath94 .",
    "the conditions leading to ideal isolation and gyration are thus fundamentally possible to achieve with careful system engineering , allowing our simple nonreciprocally coupled waveguide - resonator system to be used as a building block for more complex nonreciprocal circuits .",
    "we implemented nonreciprocal waveguide - resonator systems having @xmath74 and @xmath75 couplers using microwave frequency microstrip circuits @xcite , shown in fig .",
    "we also introduce a time - modulated coupling with controllable phase shift at each coupling point in order to generate the requisite ` synthetic phonon ' wave ( see methods ) .     coupling points .",
    "* c , d * photograph and schematic of a system with @xmath75 coupling points .",
    "each microstrip ring resonator is coupled to the waveguide through multiple varactor diodes that are separated on the waveguide by phase @xmath76 , with the dc and time - modulated biased controlled using voltages @xmath95 . for the 3-coupler circuit , biasing to the central varactor is provided through the resonator .",
    ", scaledwidth=75.0% ]     circuit are presented at both sidebands using 100 mhz modulation applied to the couplers .",
    "data for forward transmission ( @xmath36 , red ) and backward transmission ( @xmath37 , blue ) are presented for both @xmath96 ( dashed lines ) and @xmath97 ( solid lines ) . *",
    "b , c * data present the line - center forward ( red , x ) and backward ( blue , o ) transmission coefficients at the lower ( upper ) sideband frequency @xmath98 ghz ( @xmath99 ghz ) for selected values of @xmath63 .",
    "we observe nonreciprocal coupling to the resonance while using coupler phase settings of @xmath100 in both upper and lower sidebands of the resonance .",
    ", scaledwidth=60.0% ]     circuit are presented at both sidebands using 100 mhz modulation applied to the couplers .",
    "data for forward transmission ( @xmath36 , red ) and backward transmission ( @xmath37 , blue ) are presented for both @xmath96 ( dashed lines ) and @xmath101 ( solid lines ) . *",
    "b , c * data present the line - center forward ( red , x ) and backward ( blue , o ) transmission coefficients at the lower ( upper ) sideband frequency @xmath102 ghz ( @xmath103 ghz ) for selected values of @xmath63 .",
    "again we observe nonreciprocal coupling when @xmath100 .",
    ", scaledwidth=60.0% ]    the fabricated resonator system with two couplers ( @xmath74 ) shown in fig .  [ fig3]*a , b * has a loaded resonance frequency @xmath104 ghz .",
    "figure [ fig4]*a * shows the measured lower and upper transmission sidebands in forward and reverse directions when @xmath105 modulation is applied to the couplers , with relative phase setting of @xmath96 ( dashed lines ) and @xmath97 ( solid lines ) . in figure",
    "[ fig4]*b , c * we quantify the measured transmission at the lower sideband resonance ( frequency @xmath106 ) and upper sideband resonance ( @xmath73 ) respectively , as @xmath63 is swept from @xmath107 to @xmath69 .",
    "as predicted , we observe reciprocal transmission at @xmath108 .",
    "however , when @xmath63 is not equal to an integer multiple of @xmath69 the coupling in the sidebands diverges depending on wave directionality , resulting in appreciable nonreciprocal transmission . in the lower sideband",
    "there is minimum forward coupling at @xmath97 and minimum reverse coupling at @xmath109 , confirming that the fabricated circuit has @xmath110 at the lower sideband @xmath111 . on the other hand",
    ", we see that upper sideband coupling is minimized at @xmath112 ( positive sign corresponds to minimized forward coupling ) indicating that @xmath113 at @xmath114 .",
    "the large difference in @xmath68 for these two frequencies can be attributed to the dispersion characteristics of the waveguide which are non - negligible in our experiment .",
    "we additionally note that the upper sideband is much smaller and misshapen compared to the lower sideband , which is due to additional undesired resonant modes and reflections in our circuit implementation . despite these experimental difficulties ,",
    "we observe strong nonreciprocal coupling and over 5 db of directional contrast in this initial experiment .",
    "our test system with three coupling points ( @xmath75 ) has a loaded resonance frequency @xmath115 ghz and is presented in fig .",
    "[ fig3]*c , d*. figure [ fig5]*a * shows the lower and upper sideband measurements for @xmath96 ( dashed lines ) and @xmath101 ( solid lines ) for an applied modulation frequency of @xmath116 . in fig .",
    "[ fig5]*b , c * we present the measured transmission at the lower and upper sideband resonances as @xmath63 is swept from @xmath107 to @xmath69 . as predicted in fig .",
    "[ fig2 ] , this three coupler case yields two distinct dips in transmission ( one large , one small ) as the phase setting @xmath63 is varied .",
    "these two dips in transmission correspond to two local maximums in the coupling efficiency function @xmath117 . in the lower sideband",
    "the large transmission dip occurs at @xmath118 ( minus sign corresponding to minimized forward transmission ) corresponding to @xmath119 .",
    "figure [ fig5]*a * shows simultaneous coupling of both forward and backward waves to the resonance at the lower sideband .",
    "this occurs since forward waves couple to the resonator due to the small local maximum of @xmath120 , while backward waves couple strongly at the large local maximum .",
    "these two local maxima occur for the same modulation phase @xmath63 due to the waveguide dispersion .",
    "the upper sideband exhibits similar behavior with one large local coupling maximum at @xmath121 and a smaller local coupling maximum at @xmath122 , corresponding to @xmath123 . again",
    ", this large difference in @xmath68 between the sidebands can be attributed to non - idealities in the circuit implementation .",
    "figure [ fig5]*c * shows that on the upper sideband we are able to achieve strong coupling for backward waves and essentially zero coupling for forward propagating waves , demonstrating over @xmath124 db of contrast with @xmath125 .",
    "a key advantage of employing generalized nonreciprocal couplers is that the nonreciprocal transfer function is not limited to the response of simple resonator .",
    "this possibility arises since the shape of the transfer functions @xmath36 and @xmath37 are determined by the denominator of equations ( [ eqf ] , [ eqb ] ) , while the nonreciprocity generated by the coupling , is contained within the numerator . to illustrate ,",
    "let us consider an arbitrary shunt impedance that is coupled capacitively to a waveguide and generates an elaborate transfer function , such as that of a multi - band filter .",
    "use of a nonreciprocal coupler instead of the linear coupler between the waveguide and this shunt impedance will cause the transfer function to appear only for reverse propagating waves at the sideband frequencies as illustrated in fig .",
    "[ figpre]*a*. a specific example that can be generated using an impedance composed of only a few coupled resonators is a nonreciprocal band - reject filter , as illustrated in fig .",
    "[ figpre]*b*. this capability has not been demonstrated in other approaches to creating nonreciprocal responses , as many of these approaches rely on exact resonance conditions @xcite and do not allow for arbitrary impedance networks .",
    "that is nonreciprocally coupled to a waveguide can generate an elaborate nonreciprocal transfer function .",
    "the capacitor with an arrow is used here as a symbol representing nonreciprocal coupling which only couples waves traveling in the direction of the arrow . *",
    "b * a flatband nonreciprocal band - pass filter can be easily produced using three resonators and one nonreciprocal capacitive coupler .",
    "the simulated @xmath37 curve is evaluated with @xmath126 , @xmath127 , @xmath128 , @xmath129 . here , @xmath130 is the decay rate associated with the @xmath29 resonator and @xmath131 is the coupling rate between the resonators . , scaledwidth=60.0% ]    [ t ! ]   circuit used to demonstrate nonreciprocal coupling to a split resonance .",
    "the circuit is functionally identical to the previous experiment except for an additional resonator coupled to the first .",
    "an applied voltage @xmath132 is used to tune the center - frequency of the second resonance .",
    "* b * measured nonreciprocal transmission coefficients @xmath36 ( red ) and @xmath37 blue at the upper sideband ( @xmath133 ghz ) when the resonance frequencies of the coupled resonators are far apart , similar to previous experiments .",
    "* c * measured isolation ratio and transmission coefficients ( numbered 1 - 3 ) at the upper sideband when the second resonance ( @xmath134 ) is tuned across the first ( @xmath135 ) .",
    "we observe that backward propagating waves couple effectively to the split resonance in this sideband although both modes are at a much lower frequency , clearly demonstrating that the nonreciprocity is caused by the modulated coupling .",
    "an increase in the directional contrast ( isolation ) bandwidth due to the broadening of the mode is also evident .",
    ", title=\"fig : \" ]    to experimentally verify this concept of nonreciprocal coupling to an arbitrary resonant state , we produced the simple two - resonator circuit shown in fig .",
    "[ fig6]*a*. this microwave circuit is a direct extension of the @xmath91 implementation ( fig .",
    "[ fig3]*c , d * ) in which a second resonator ( @xmath134 ) has been coupled to the first resonator ( @xmath135 ) through a fixed capacitor .",
    "the resonance frequency of this added resonator can be capacitively tuned using a voltage controlled varactor diode at the top of the ring .",
    "the nonreciprocal coupler placed between the waveguide and resonator is modulated using @xmath136 with a phase setting of @xmath101 .",
    "figure [ fig6]*b * presents the measured nonreciprocal coupling occurring between the first resonator and the waveguide at the upper sideband frequency @xmath137 ghz , when the frequencies of the two coupled resonances are far apart . the second resonance at @xmath134 is then tuned across the first resonance at @xmath135 , resulting in an avoided crossing and lifted degeneracy of the hybrid modes of the system .",
    "the avoided crossing is easily observed in our measurements of the @xmath138 isolation contrast in fig .",
    "[ fig6]*c * at the sideband frequency .",
    "this simple example showcases that nonreciprocal transfer functions that are more complex than simple resonances @xcite can be obtained quite readily by this approach .",
    "in this study we have presented a theoretical description and experimental validation of employing multiple spatiotemporally modulated couplers to create nonreciprocal coupling in a very simple 2-port system .",
    "we have also discussed how such a system could theoretically achieve unidirectionally lossless nonreciprocal transmission , as well as how nonreciprocal coupling could be used to create arbitrary nonreciprocal transfer functions .",
    "the methods presented are independent of the type of resonator used and may be applied more broadly to optical and mechanical systems .",
    "presently , we were unable to observe lossless nonreciprocal transmission due to several non - ideal factors in the design .",
    "specifically , in circuit implementation of a waveguide and ring resonator coupled with discrete capacitors there are several effects that are not accounted for in the temporal coupled - mode theory the most important of which are reflections from the capacitive couplers that can significantly distort the resonance shape and the slightly non - linear response of the varactor diodes . due to this effect",
    "we observe scattering from the modulated couplers even far from the resonance , which effectively creates extra loss in the system .",
    "this behavior could be overcome in circuit implementations by lowering the intrinsic losses in the resonator and using a smaller capacitance for coupling .",
    "these modifications will decrease the distortion of the resonance shape as well as the non - linearity introduced by the varactor diodes .",
    "many experiments on nonreciprocal systems created through spatiotemporal modulation @xcite can be seen through the lens of unidirectional inter - modal scattering or a momentum bias applied to the medium @xcite .",
    "it is also possible to relate our work to this concept , with the momentum bias applied to the coupling coefficients instead of the waveguide or resonator components .",
    "however , major features of our demonstrated approach are that it allows the modulated region to be sub - wavelength , and that high - quality conventional ( static ) waveguides and resonators can be employed without the complexities of time - modulation .",
    "further , the addition of a lossy element ( the resonant mode ) enables true signal isolation functionality where waves incident in one direction are dissipated as heat .",
    "most importantly , we have experimentally demonstrated that nonreciprocal coupling enables the synthesis of arbitrary nonreciprocal transfer functions using conventional components and enables the use of well - known impedance networks .",
    "such design capability has not been previously achieved in other approaches since they are often limited to exact resonant responses .",
    "nonreciprocity achieved through nonreciprocal coupling is thus a powerful technique that can offer greater reconfigurability and customization of the system dynamics and signal processing functions .",
    "our microwave circuits are fabricated on rogers 6006 substrate with a 1 oz copper conductor , and consist of a microstrip waveguide coupled to a ring resonator by @xmath19 varactor diodes ( skyworks smv1275 ) that act as variable capacitors .",
    "the coupling strength @xmath28 of each capacitive coupler is an approximately linear function of the applied voltage @xmath95 for small changes in voltage , allowing a modulation of @xmath28 that is proportional to a modulation of @xmath95 .",
    "we first apply a dc bias of 3 volts to each varactor diode with a dc power supply ( agilent e3631a ) .",
    "we modulated this bias using a sine - wave from a signal generator ( hp-8647b ) , which is set at a frequency of 100 mhz and a signal amplitude of 2 volts .",
    "the signal is split ( minicircuits za3cs-400 - 3w - s ) into three lines that each connect to a variable phase shifter ( minicircuits jsphs-150 + ) so that the phase shift between each signal can be independently controlled .",
    "after the splitting and taking into account the loss of the phase shifters and cables , we estimate about 1 volt ac bias at 100 mhz is applied to each varactor diode .",
    "the dc bias and 100 mhz modulation are combined through a bias tee ( minicircuits zfbt-4r2gw - ft+ ) connected directly to the circuit . on each circuit ,",
    "butterfly band - pass filters were incorporated along with a another low - frequency biasing tee ( johanson technology l-14c10n - v4 t 10 nh inductor and johanson technology r14s 12 pf capacitor ) as shown in fig .",
    "[ fig3 ] to isolate the lower frequency bias modulation from the higher frequency resonant circuit .      the applied 3 volt dc bias results in an average varactor capacitance of 1.87 pf , which is then modulated by the 1 volt ac signal from 1.58 pf to 2.32 pf .",
    "this is a slightly nonlinear voltage - capacitance relationship , but the non - linearity is small enough to not drastically impact the results . for large modulation amplitude",
    "we observed a shift in the phase @xmath63 at which the maximum and minimum coupling occur , due to interference between the applied biases and non - linearity in the phase shifters .",
    "we measured the transmission parameters ( @xmath36 , @xmath37 ) of the circuit using a keysight e5063a vector network analyzer .",
    "the network analyzer measurement was calibrated to the ends of the sma cables that connected to the surface - mount sma connectors on the circuit board .",
    "thus , the data presented throughout this paper only reflect the s parameters of the circuits that we have developed , while eliminating any parasitic effects from the cables and supporting systems .",
    "we acknowledge funding support from the us office of naval research ( grant n00014 - 16 - 1 - 2830 ) , the national science foundation emerging frontiers in research and innovation newlaw program ( grant efma-1627184 ) , and a national science foundation graduate research fellowship .",
    "c.w.p . and g.b .",
    "conceived the idea and with s.k . developed the theory .",
    "designed and carried out the experiments .",
    "j.t.b . provided material support and guidance for the experiments .",
    "all authors analyzed the data and co - wrote the paper .",
    "g.b . supervised all aspects of this project .",
    "+    in this supplement we explicitly derive the nonreciprocal scattering parameters for a simple waveguide - resonator system with multiple spatiotemporally modulated couplers .",
    "the system under consideration , shown in figure [ figs1 ] , consists of two ports connected by a waveguide with input and output fields described by @xmath139 and @xmath140 ( where @xmath141 is the port number ) and a resonant mode with angular frequency @xmath21 and amplitude @xmath16 .",
    "the mathematical derivations in this paper are an extension of temporal coupled - mode theory @xcite modified to incorporate time - varying couplers .",
    "we begin with the differential equation describing the resonant field @xmath16 of a standing - wave resonator in the time - domain with inputs @xmath25 and @xmath32 that are time - harmonic with frequency @xmath24 . @xmath142",
    "this equation can be modified for a traveling wave resonator by simply splitting @xmath16 into two orthogonal modes which are each only coupled to a single port .",
    "@xmath143 we can express the output fields @xmath42 , @xmath43 as @xmath144 where the subscript of @xmath16 is used only for the traveling wave resonator case . in these equations @xmath21 is the resonance frequency , @xmath23 is the decay rate of the mode , and @xmath145 is the effective coupling between port @xmath141 and the resonant mode .",
    "we assume the waveguide is matched to the ports and is lossless with a propagation constant @xmath34 .",
    "the couplers are spatially separated in the waveguide by a length @xmath20 , which leads to the term @xmath146 to account for the phase associated with a wave traveling between ports . at steady state",
    "the solution to equation [ s1 ] ( a standing wave resonator ) is     is described by @xmath139 and @xmath140 respectively and the resonant field is described by @xmath16 .",
    "the ports are coupled directly via a waveguide and are also coupled to a resonant modes using a system of @xmath19 spatiotemporally modulated capacitive couplers with coupling rate @xmath28 .",
    "the individual couplers are spatially distributed over the waveguide with subwavelength spacing @xmath20 in order to generate sensitivity to wave propagation direction . ]",
    "@xmath147    we can then rewrite equation [ s2 ] as @xmath148 in the system under consideration , shown in fig .",
    "[ figs1 ] , the effective coupling rates @xmath26 and @xmath35 can be written as @xmath149 where we modulate the coupling rate of each individual coupler @xmath28 with the function @xmath62 . under this modulation",
    "the effective coupling rates @xmath26 and @xmath35 can be expressed as @xmath150    for simplicity we assume a resonant mode with only one input ( @xmath151 , which could be a standing wave or traveling wave resonator .",
    "we later discuss the effects of @xmath32 on the standing wave case and the difference in the decay rate @xmath23 .",
    "the steady - state field in the resonator is thus @xmath152 the time - varying terms here represent sidebands of the resonance created by the modulated coupling , which allow waves with a frequency offset @xmath17 from the resonance frequency to couple into the resonance .",
    "we can now find the steady - state fields @xmath42 and @xmath43 ( also with @xmath39 ) as @xmath153 \\\\",
    "+ a_1 e^{\\omega t } \\bigg [ & - \\frac{d_0 d_m}{2 } \\frac { \\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } e^{- j \\phi ( m-1 ) } } { j ( \\omega - \\omega_0 ) + \\gamma } \\\\      &",
    "- \\frac{d_0 d_m}{2 } \\frac{\\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } e^{-j \\phi ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } } { j ( \\omega + \\omega - \\omega_0 ) + \\gamma } \\bigg ] \\\\      + a_1 e^{-j \\omega t }",
    "\\bigg [ & - \\frac{d_0 d_m}{2 } \\frac { \\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } e^{j \\phi ( m-1 ) } }   { j ( \\omega - \\omega_0 ) + \\gamma } \\\\      &",
    "- \\frac{d_0 d_m}{2 } \\frac{\\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } e^{j \\phi ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } } { j ( \\omega - \\omega - \\omega_0 ) + \\gamma } \\bigg ] \\\\      + a_1 e^{2 \\omega t }",
    "\\bigg [ & - \\frac{d_m^2}{4 } \\frac { \\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } e^{- j \\phi ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } e^{- j \\phi ( m-1 ) } } { j ( \\omega + \\omega - \\omega_0 ) + \\gamma } \\bigg ] \\\\",
    "+ a_1 e^{-j 2 \\omega ) t } \\bigg [ & - \\frac{d_m^2}{4 } \\frac",
    "{ \\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } e^ { j \\phi ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } e^{j \\phi ( m-1 ) } } { j ( \\omega - \\omega - \\omega_0 ) + \\gamma } \\bigg ] ~ .",
    "\\end{aligned}\\ ] ] from the output field @xmath42 we find the transmission coefficient @xmath38 ( with @xmath39 ) .",
    "@xmath154 \\\\",
    "+ e^{j \\omega t } \\bigg [ & - \\frac{d_0 d_m}{2 } \\frac { \\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } e^{- j \\phi ( m-1 ) } } { j ( \\omega - \\omega_0 ) + \\gamma } \\\\      &",
    "- \\frac{d_0 d_m}{2 } \\frac{\\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } e^{-j \\phi ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } } { j ( \\omega + \\omega - \\omega_0 ) + \\gamma } \\bigg ] \\\\",
    "+ e^{-j \\omega t } \\bigg [ & - \\frac{d_0 d_m}{2 } \\frac { \\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } e^{j \\phi ( m-1 ) } }   { j ( \\omega - \\omega_0 ) + \\gamma } \\\\      & - \\frac{d_0 d_m}{2 } \\frac{\\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } e^{j \\phi ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } } { j ( \\omega - \\omega - \\omega_0 ) + \\gamma } \\bigg ] \\\\      + e^{j 2 \\omega t } \\bigg [ & - \\frac{d_m^2}{4 } \\frac",
    "{ \\sum_{n=1}^n e^{-j \\beta \\ell ( n-1 ) } e^{- j \\phi ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } e^{- j \\phi ( m-1 ) } } { j ( \\omega + \\omega - \\omega_0 ) + \\gamma } \\bigg ] \\\\      + e^{-j   2 \\omega t } \\bigg [ & - \\frac{d_m^2}{4 } \\frac { \\sum_{n=1}^n e^{-j",
    "\\beta \\ell ( n-1 ) } e^ { j \\phi ( n-1 ) } \\sum_{m=1}^n e^{j \\beta \\ell ( m - n ) } e^{j \\phi ( m-1 ) } } { j ( \\omega - \\omega - \\omega_0 ) + \\gamma } \\bigg ] ~ .\\end{aligned}\\ ] ] the reverse transmission coefficient @xmath37 can be found as @xmath40 ( with @xmath41 ) .",
    "we can thus understand the system as taking one input and splitting it into five frequencies separated by the modulation frequency @xmath17 .",
    "presently , we wish to only consider the solution where output terms are the same frequency @xmath24 as the input .",
    "these are the terms that are measured on a typical network analyzer , while terms that are frequency offset can be dismissed as noise produced by the system .",
    "we then obtain @xmath155 ~ .",
    "\\end{split}\\ ] ] using this frequency limited output we can rewrite @xmath36 as @xmath156 ~ .",
    "\\end{split}\\ ] ] we have introduced the coupling efficiency function @xmath157     for @xmath158 . ]    the function @xmath47 is a periodic even function that is symmetric about @xmath49 for integer @xmath51 as illustrated in fig .",
    "[ figs2 ] for selected values of @xmath19 .",
    "while the above derivation assumes @xmath39 , this system can be readily solved for simultaneous inputs @xmath25 and @xmath32 as written in equations [ s1 ] and [ s2 ] .",
    "it is clear from equation [ s1s ] that for a standing wave resonator the resonant field @xmath16 is simply a superposition of the contribution from both inputs , therefore in general the outputs @xmath43 and @xmath42 depend on both inputs .",
    "this dependence is obviously undesirable for the functionality of a system but is resolved in the case where waves propagating in one direction are completely uncoupled from the resonance ( completely unidirectional coupling ) . as discussed in the manuscript",
    "this condition is also important to other functions of the system such as lossless functionality and isolation .",
    "the dependence of the outputs on both inputs is automatically resolved for a traveling wave resonator since the orthogonal resonant fields each only depend on one of the inputs .",
    "as previously shown @xcite , the decay rate @xmath23 for a lossless resonator is defined as @xmath159 which can be extended to lossy resonators through the addition of the intrinsic decay rate @xmath56 .",
    "we note that for a traveling wave resonance only the @xmath13 term coupling the resonant field to the output field @xmath15 ( in equation [ s2 ] ) is used .",
    "our system has time - varying @xmath145 , so is it necessary to slightly modify this definition to @xmath160 where @xmath53 @xmath54 represents the time - average .",
    "this approximation is valid because @xmath161 and the field in the resonator decays very slowly compared to the modulation .",
    "the expression for @xmath23 can then be simplified to @xmath162 where the frequency dependence of @xmath34 is explicitly written for clarity .",
    "the decay rate @xmath23 defines the resulting modal linewidth and is present in the denominator of all the s - parameter equations for our nonreciprocal time - varying coupler ."
  ],
  "abstract_text": [
    "<S> breaking reciprocity associated with wave propagation is a fundamental challenge across a wide range of physical systems in electromagnetics , optics , and acoustics . </S>",
    "<S> in contrast to established magneto - optic methods , recent efforts have focused instead on inducing nonreciprocity using time - varying biases such as synchronized spatiotemporal modulation of resonators and waveguides . to date , the elements that couple these time - varying resonator and waveguide modes are always considered to be reciprocal , and the nonreciprocal transfer functions achieved by these systems have been mostly limited to narrow - band resonances . here </S>",
    "<S> we demonstrate that transferring the time - varying bias to the often overlooked coupling between waveguides and resonators can permit the synthesis of arbitrary nonreciprocal transfer functions . using simple microwave circuits </S>",
    "<S> we experimentally demonstrate dynamically reconfigurable nonreciprocal responses , and the possibility of arbitrary function synthesis , through the use of this nonreciprocal coupler . </S>",
    "<S> this unique method of breaking reciprocity is applicable to essentially all wave phenomena , opening the door for the creation of a broad class of nonreciprocal systems .    </S>",
    "<S> reciprocity is a fundamental property of wave propagation in linear time - invariant ( lti ) media @xcite that implies invariance of a system when its inputs and outputs are exchanged and arises due to the symmetry of the medium under time - reversal . in classical systems reciprocity is best captured through network theory , where a reciprocal network is defined by a symmetric scattering matrix @xmath0 @xcite . </S>",
    "<S> the off - diagonal elements of this matrix describe the transmission of waves between any two ports of the network . </S>",
    "<S> since the reciprocity property derives from time - reversal symmetric media , nonreciprocal networks can be created by applying a time - varying bias that generates the property @xmath1 , where @xmath2 is the time variable of the bias . </S>",
    "<S> under such a bias the scattering matrix will become asymmetric and nonreciprocal , but will retain the property that @xmath3 . </S>",
    "<S> historically , linear nonreciprocal networks have been predominantly based on the magneto - optic effect in gyrotropic materials @xcite and can be understood by the relationship @xcite @xmath4 under influence of magnetic field @xmath5 . </S>",
    "<S> magnetically induced nonreciprocity may be also considered a subset of the time - variation approach since magnetic fields are quantifiable by the time parameter of an equivalent current loop .    </S>",
    "<S> recent efforts on achieving linear nonreciprocal effects without magnetic fields have focused on using spatiotemporal biases in optical , rf , and acoustic domains @xcite . </S>",
    "<S> for instance , the scattering of light from a propagating acoustic wave in a medium depends on the relative momentum vectors of the photons and phonons and the available density of states in each domain . </S>",
    "<S> such a traveling acoustic wave bias can thus be exploited to generate nonreciprocal effects @xcite . </S>",
    "<S> most systems of this type can be generalized to a combination of ports , waveguides , and resonances ( fig . </S>",
    "<S> [ fig1]*a * ) . </S>",
    "<S> generally , we can describe these systems using coupled mode theory through the equations @xcite @xmath6 where @xmath7 are complex valued vectors respectively describing the field in the resonances , into the ports , and out of the ports as illustrated . </S>",
    "<S> four matrices , @xmath8 , represent the system parameters : resonance frequencies , resonance decay rates , coupling between the ports and the resonances , and coupling between ports respectively . </S>",
    "<S> the scattering matrix @xmath9 , which is only dependent on the four matrices that describe the system , can be obtained through the relationship @xmath10 . </S>",
    "<S> past research has shown that a nonreciprocal ( asymmetric ) scattering matrix can be obtained by applying a spatiotemporal bias to coupled resonant modes ( @xmath11 matrix ) @xcite or the waveguide ( @xmath12 matrix ) @xcite but the coupling between these waveguides and resonances ( @xmath13 matrix ) is always assumed to be linear time invariant .    in this work </S>",
    "<S> , we invert the situation and demonstrate instead an approach to achieving nonreciprocal propagation in lti waveguides and resonators through the use of spatiotemporally modulated coupling ( @xmath13 matrix ) while keeping resonances and waveguides unchanged . </S>",
    "<S> as we will show , the power of using this approach is that highly tailorable nonreciprocal transfer functions can be arranged without needing sophisticated modulation schemes involving multiple synchronized resonances or waveguides @xcite . </S>",
    "<S> the use of nonreciprocal coupling also opens new and convenient paths to produce a variety of nonreciprocal devices using a single waveguide and resonator . </S>",
    "<S> we discuss how ultra low loss isolators could be created through nonreciprocal critical coupling and gyrators ( nonreciprocal phase - shifters ) could be created nonreciprocal over - coupling to resonators .    , and can also couple to resonant modes via the coupling matrix @xmath13 . </S>",
    "<S> the inputs and outputs at the ports are described by the vectors @xmath14 and @xmath15 respectively . </S>",
    "<S> the resonant field vector @xmath16 is described through the frequency matrix @xmath17 and the decay matrix @xmath18 . * </S>",
    "<S> b * in a simple system with one resonance and two ports , nonreciprocity can be synthesized through the coupling matrix @xmath13 using a system of @xmath19 spatiotemporally modulated capacitive couplers . </S>",
    "<S> the individual couplers are spatially distributed over the waveguide with subwavelength spacing @xmath20 in order to generate sensitivity to wave propagation direction . for mathematical simplicity , we assume that each coupler is connected to an isophase point of the resonant mode . </S>",
    "<S> sinusoidal time - modulation of the individual coupling rates at a relative phase set by their spatial location generates significant nonreciprocal effects that we see in this work . </S>",
    "<S> , scaledwidth=60.0% ]    in this paper we first develop a theory for directly generating a nonreciprocal coupling matrix @xmath13 using spatiotemporally modulated coupling elements . using this approach , </S>",
    "<S> we experimentally demonstrate significant nonreciprocal responses in simple resonant microwave circuits . we discuss how nonreciprocal coupling automatically creates networks that are theoretically lossless in the uncoupled direction and how it can be applied to arbitrary resonant structures and impedance networks . </S>"
  ]
}