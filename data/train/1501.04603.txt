{
  "article_text": [
    "photoacoustic tomography ( pat ) is a recently developed medical imaging paradigm that combines the high spatial resolution of ultrasound imaging with the high contrast of optical imaging @xcite .",
    "suppose a semitransparent sample is illuminated with a short pulse of electromagnetic energy near the visible range",
    ". then parts of the optical energy will be absorbed inside the sample which causes a rapid , non - uniform increase of temperature .",
    "the increase of temperature yields a spatially varying thermoelastic expansion which in turn induces an acoustic pressure wave ( see figure  [ fig : pat ] ) .",
    "the induced acoustic pressure wave is measured outside of the object of interest , and mathematical algorithms are used to recover an image of the interior .",
    "basic principle of pat .",
    "a semitransparent sample is illuminated with a short optical pulse . due to optical absorption and subsequent thermal expansion within the sample",
    "an acoustic pressure wave is induced .",
    "the acoustic pressure wave is measured outside of the sample and used to reconstruct an image of the interior.,scaledwidth=85.0% ]    original ( and also a lot of recent ) work in pat has been concentrated on the problem of reconstructing the initial pressure distribution , which has been considered as final image ( see , for example , @xcite )",
    ". however , the recovered pressure distribution only provides indirect information about the investigated object .",
    "this is due to the fact , that the initial pressure distribution is the product of the optical absorption coefficient and the spatially varying optical intensity which again indirectly depends on the tissue parameters . as a consequence ,",
    "the initial pressure distribution only provides qualitative information about the tissue - relevant parameters .",
    "quantitative photoacoustic tomography ( qpat ) addresses exactly this issue and aims at quantitatively estimating the tissue parameters by supplementing the wave inversion with an inverse problem for the light propagation in tissue ( see , for example , @xcite ) .    to the best of our knowledge ,",
    "apart from the very recent work @xcite , all existing reconstruction algorithms for qpat are currently performed via the following two - stage procedure : first , the measured pressure values are used to recover the initial pressure distribution caused by the thermal heating . in a second step , based on an appropriate light propagation model ,",
    "the spatially varying tissue parameters are estimated from the initial pressure distribution recovered in the first step .",
    "however , any algorithm for solving an inverse problem requires prior knowledge about the parameters to be recovered as well as partial knowledge about the noise .",
    "if one solves qpat via a two - stage approach , appropriate prior information for the acoustic inverse problem is difficult to model , because the initial pressure depends on parameters not yet recovered .",
    "this is particularly relevant for the case that the acoustic data can only be measured on parts of the boundary ( limited - angle scenario ) , in which case the acoustic inverse problems is known to be severely ill - posed .",
    "further , using a two - stage approach , only limited information about the noise for the optical problem is available .    in view of such shortcomings of the two - stage approach , in this paper",
    "we propose to recover the optical parameters directly from the measured acoustical data via a single - stage procedure .",
    "we work with the stationary radiative transfer equation ( rte ) as model for light propagation .",
    "our simulations show improved reconstruction quality of the proposed single - stage algorithm at a computational cost similar to the one of existing two - stage algorithms .",
    "obviously our single - stage strategy can alternatively be combined with the diffusion approximation , which has also frequently been used in qpat . in the present work we use the stationary rte since it is the more realistic model for light propagation in tissue . in combination with the two - stage approach",
    ", the rte has previously been used for qpat , for example , in @xcite .      throughout this paper ,",
    "let @xmath0 denote a convex bounded domain with lipschitz - boundary @xmath1 , where @xmath2 denotes the spatial dimension .",
    "we model the optical radiation by a function @xmath3 , where @xmath4 is the density of photons at location @xmath5 propagating in direction @xmath6 . the photon density is supposed to satisfy the rte , which reads @xmath7 here @xmath8 is the scattering coefficient , @xmath9 is the absorption coefficient , and @xmath10 is the photon source density .",
    "the scattering kernel @xmath11 describes the redistribution of velocity directions of scattered photons due to interaction with the background .",
    "the stationary rte is commonly considered as a very accurate model for light transport in tissue ( see , for example , @xcite ) .    in order to obtain a well - posed problem one has to impose appropriate boundary conditions . for that purpose",
    "it is convenient to split the boundary @xmath12 into inflow and outflow boundaries , @xmath13 with @xmath14 denoting the outward pointing unit normal at @xmath15 .",
    "we then augment by the inflow boundary conditions @xmath16 under physically reasonable assumptions it can be shown that the stationary rte together with the inflow boundary conditions is a well - posed problem . in section  [ sec : transport ]",
    "we apply a recent result of @xcite that guarantees the well - posedness of , even in the presence of voids ( parts of the domain under consideration , where @xmath17 and @xmath18 vanish ) .",
    "the absorption of photons causes a non - uniform heating of the tissue proportional to the total amount of absorbed photons , @xmath19 the heating in turn induces an acoustic pressure wave @xmath20 .",
    "the initial pressure distribution is given by @xmath21 , where @xmath22 is the grneissen parameter describing the efficiency of conversion of heat into acoustic pressure .",
    "for the sake of simplicity we consider the grneissen parameter to be constant , known and rescaled to one .",
    "we further assume the speed of sound to be constant and also rescaled to one .",
    "the photoacoustic pressure then satisfies the following initial value problem for the standard wave equation , @xmath23 the goal of qpat is to reconstruct the parameters @xmath17 and @xmath18 from measurements of the acoustic pressure @xmath24 outside @xmath25 .",
    "pressure measurements are usually taken as a function of time on parts of the boundary @xmath26 .      in the following",
    "we assume that acoustic measurements are available for multiple optical source distributions ( illuminations ) . for that purpose , let @xmath27 for @xmath28 be given pairs of source patterns and boundary light sources .",
    "we use @xmath29 to denote the operator that takes the pair @xmath30 to the solution of the stationary rte , with @xmath31 and @xmath32 in place of @xmath33 and @xmath34 , and denote by @xmath35 the operator describing the corresponding thermal heating .",
    "further , we write @xmath36 for the operator that maps the initial data @xmath37 to the solution @xmath38 of the wave equation restricted to the boundary @xmath1 .",
    "appropriate functional analytic frameworks for @xmath29 , @xmath39 and @xmath40 will be given in section  [ sec : forward ] , where we also study properties of these mapping .",
    "the reconstruction problem of qpat with multiple illuminations can be written in the form of a nonlinear inverse problem , @xmath41 here @xmath42 are the measured noisy data , the operators @xmath43 model the forward problem of qpat , @xmath44 are the noise in the data , and @xmath45 are the true parameters .",
    "the aim is to estimate the parameter pair @xmath46 from given data @xmath42 , and hence solving the inverse problem .      in this paper",
    "we address the inverse problem by tikhonov regularization , @xmath47 where @xmath48 is a convex penalty and @xmath49 is the regularization parameter .",
    "we show that tikhonov regularization applied to single - stage qpat is well - posed and convergent ; see theorem  [ thm : tik ] . for that purpose",
    "we derive regularity results for the heating operators @xmath39 in section [ sec : forward ] . to establish such properties we use results for the stationary rte derived recently in @xcite .    for numerically minimizing the tikhonov functional we apply the proximal gradient algorithm ( also named forward backward splitting ) ; see section  [ sec : min ] .",
    "the proximal gradient algorithm , is an iterative scheme for minimizing functionals that can be written as the sum of a smooth and a convex part @xcite . for the classical two - stage approach in qpat in combination with the diffusion approximation ,",
    "the proximal gradient algorithm has recently been applied in @xcite .",
    "numerical results using the proximal gradient algorithm applied to our single - stage approach are presented in section  [ sec : num ] , where we also include a comparison with the two - stage approach .",
    "of course , our single - stage approach can be combined with classical gradient or newton - type schemes .",
    "the proximal gradient algorithm is our method of choice , since its is very flexible and fast , and can be applied for a large class of smooth or non - smooth penalties .",
    "before actually studying the inverse problem of qpat we first make sure that the forward problem is well - posed in suitable spaces and that the data depend continuously on the parameters we intend to reconstruct .",
    "for that purpose we review a recent existence and uniqueness result for the stationary rte allowing for voids in the domain of interest @xcite .",
    "the use of a - priori estimates will lead to differentiability results for the operators @xmath29 and @xmath39 .",
    "the stationary rte has been studied in various contexts .",
    "the most prominent , apart from the transport of radiation in a scattering media , is reactor physics , where the equation is used in the group velocity approximation of the neutron transport problem .",
    "an extensive collection of results regarding applications as well as existence and uniqueness of solutions can be found in @xcite .",
    "the analysis of the rte becomes considerably more involved if internal voids , i.e. regions where scattering and absorption coefficient become zero , are allowed .",
    "suppose @xmath50 , and denote by @xmath51 the space of all measurable functions @xmath34 defined on @xmath52 for which @xmath53{\\int_{\\gamma_- }    { \\left\\vert\\nu(x ) \\cdot",
    "\\theta\\right\\vert } { \\left\\vertf(x,\\theta)\\right\\vert}^p { \\mathrm d}(x,\\theta ) }    & \\text{if $ p <",
    "\\infty$ }    \\\\    \\operatorname*{ess\\,sup}_{(x,\\theta ) \\in \\gamma_- } { \\left\\{{\\left\\vert\\nu(x ) \\cdot",
    "\\theta\\right\\vert } { \\left\\vertf(x,\\theta)\\right\\vert } \\right\\ } }    & \\text{if   $ p   =   \\infty$ }    \\end{cases}\\ ] ] is finite .",
    "we write @xmath54 for the space of all measurable functions defined on @xmath55 such that @xmath56 is well defined and finite ( with the usual modification for @xmath57 ) .",
    "the subspace of all @xmath58 with @xmath59 will be denoted by @xmath60 .",
    "further , for a given scattering kernel @xmath61 we write @xmath62 for the corresponding scattering operator , @xmath63 throughout this article , the scattering kernel @xmath64 is supposed to be symmetric and nonnegative , and to satisfy @xmath65 for all @xmath6 .",
    "this reflects the fact that @xmath66 is a probability distribution describing the redistributions of velocity directions due to interaction of the photons with the background . under these assumption , the scattering operator @xmath67 is easily seen to be linear and bounded .    using the notation just introduced ,",
    "the stationary rte , can be written in the compact form @xmath68 by definition , a solution of the stationary rte , in @xmath69 is any function @xmath70 satisfying .",
    "the following theorem , which has been derived very recently in @xcite , states that under physically reasonable assumptions there exists exactly one such solution , that further continuously depends on the source pattern and the boundary light source .",
    "[ thm : exist ] let @xmath71 denote positive constants , let @xmath72 be measurable functions satisfying @xmath73 and @xmath74 , and let @xmath75 .",
    "then , for any source pattern @xmath76 and any boundary light source @xmath77 , the stationary rte , admits a unique solution @xmath78 .",
    "moreover , there exists a constant @xmath79 only depending on @xmath24 , @xmath80 and @xmath81 , such that the following a - priori estimate holds @xmath82    see @xcite .      throughout this subsection ,",
    "let @xmath50 , and let @xmath84 and @xmath85 be given source pattern and boundary light source , respectively .",
    "further , for fixed positive numbers @xmath86 we denote @xmath87 then @xmath88 is a closed , bounded and convex subset of @xmath89 , that has empty interior in the case that @xmath90 .",
    "the parameter - to - solution operator for the stationary rte is defined by @xmath91 where @xmath92 denotes the unique solution of , .    according to theorem [ thm : exist ] the operator @xmath83 is well defined .",
    "note further , that @xmath83 depends on @xmath24 , @xmath33 , @xmath34 , @xmath80 and @xmath81 .",
    "since these parameters will be fixed in the following and in order to keep the notation simple we will not indicate the dependence of @xmath83 on these parameter explicitly .",
    "now we are in the position to state continuity properties of @xmath83 derived in @xcite .",
    "we include a short proof of these results as its understanding is very useful for the derivation of similar properties of the operator describing the heating that we investigate in the following subsection .",
    "[ thm : contf ]    1 .",
    "[ it : contf - a ] the operator @xmath83 is lipschitz - continuous .",
    "[ it : contf - b ] if @xmath93 , then @xmath83 is sequentially weakly continuous .    [",
    "it : contf - a ] let @xmath94 be two given pairs of absorption and scattering coefficients and denote by @xmath95 and @xmath96 the corresponding solutions of the stationary rte .",
    "since @xmath97 and @xmath98 , theorem  [ thm : exist ] implies that the difference @xmath99 is an element of @xmath100 .",
    "further , this difference is easily seen to satisfy @xmath101 because @xmath67 is a bounded linear operator on @xmath102 , the right hand side in the above equation is actually contained in @xmath102 .",
    "therefore , a further application of theorem  [ thm : exist ] yields @xmath103 where @xmath104 denotes the identity and @xmath105 the operator norm on @xmath106 .",
    "since @xmath107 is bounded independently of @xmath108 , this implies the lipschitz continuity of @xmath83 .",
    "[ it : contf - b ] let @xmath109 be a sequence in @xmath88 that converges weakly to the pair @xmath110 , and denote by @xmath111 and @xmath112 the corresponding solutions of the stationary rte . as in [ it :",
    "contf - a ] , one argues that the difference @xmath113 is contained in @xmath100 and satisfies @xmath114 now , from theorem  [ thm : exist ] it follows that @xmath115 is invertible as an operator from @xmath116 to @xmath106 .",
    "consequently , the inverse mapping @xmath117 is linear and bounded and in particular weakly continuous .",
    "it therefore remains to show that @xmath118 weakly converges to zero in @xmath106 . to see this ,",
    "denote by @xmath119 the dual index and let @xmath120 be any element in the dual of @xmath121 . by fubini s theorem",
    "we have @xmath122 the averaging lemma ( see , for example , @xcite ) implies that the averaging operator @xmath123 is compact for @xmath124 .",
    "since @xmath125 is bounded in @xmath126 , this implies that @xmath127 converges to @xmath128 with respect to @xmath129 . as @xmath130",
    "we can conclude that @xmath131 converges to zero weakly . in the same manner one",
    "shows @xmath132 .",
    "finally , the equality @xmath133 and the use of similar arguments show that @xmath134 .",
    "for the solution of the inverse problem of qpat we will make use the derivative of @xmath83 that we compute next .",
    "for that purpose we call @xmath135 a feasible direction at @xmath136 if there exists some @xmath137 such that @xmath138 . due to the convexity of @xmath88 we have @xmath139 for all @xmath140",
    ". the set of all feasible directions at @xmath141 will be denoted by @xmath142 .",
    "one immediately sees that @xmath143 for @xmath136 and any feasible direction @xmath144 we denote the one - sided directional derivative of @xmath83 at @xmath145 in direction @xmath37 by @xmath146 provided that the limit on the right hand side of exists .",
    "if both limits @xmath147 and @xmath148 exist and @xmath149 is bounded and linear , we say that @xmath83 is gtaux differentiable at @xmath150 and call @xmath151 the gtaux derivative of @xmath83 at @xmath145 .",
    "[ thm : fdiff ] for any @xmath136 , the one - sided directional derivative of @xmath83 at @xmath145 in direction @xmath152 exists .",
    "further , we have @xmath153 , where @xmath154 is the unique solution of @xmath155 if @xmath156 and @xmath157 , then @xmath83 is gteaux differentiable at @xmath150 .",
    "suppose @xmath158 and let @xmath159 be any feasible direction",
    ". for sufficiently small @xmath160 write @xmath161 and @xmath95 . as in the proof of theorem [ thm : contf ]",
    "one shows that @xmath162 is contained in @xmath163 and solves the equation @xmath164 .",
    "consequently the difference @xmath165 solves @xmath166 application of the a - priori estimate of theorem  [ thm : exist ] shows the inequality @xmath167 together with the continuity of @xmath83 this implies that the one - sided directional derivative @xmath168 exists and is given by @xmath169 . finally , if @xmath156 and @xmath157 , then @xmath170 is bounded and linear and therefore @xmath83 is gteaux differentiable at @xmath150 .",
    "note that for any parameter pair @xmath171 , the solution of depends linearly and continuously on @xmath172 . as a consequence",
    ", the one - sided directional derivative can be extended to a bounded linear operator @xmath173 where @xmath154 is the unique solution of .",
    "we refer to this extension as the derivative of @xmath83 at @xmath145 .      throughout this subsection ,",
    "let @xmath84 and @xmath85 be given source pattern and boundary light source , respectively . as already mentioned in the introduction , photoacoustic signal generation due to the absorption of light",
    "is described by the operator @xmath175 to shorten the notation , in the following we will make use of the averaging operator @xmath176 defined by @xmath177 . by hlders inequality the averaging operator is well defined , linear and bounded . using the averaging operator we can write @xmath178 .    [ thm : heating ]    1 .   [",
    "it : heating - a ] the operator @xmath174 is lipschitz continuous .",
    "[ it : heating - b ] if @xmath179 , then @xmath174 is sequentially weakly continuous .    [",
    "it : heating - a ] suppose that @xmath94 are two pairs of admissible absorption and scattering coefficients .",
    "the decomposition @xmath178 and the triangle inequality imply @xmath180 according to theorem [ thm : contf ] , the operator @xmath83 is lipschitz continuous . because @xmath181 is linear and bounded , also the composition @xmath182 is lipschitz . noting that @xmath183 and @xmath184 are bounded by constants independent of @xmath185 and @xmath186 , this implies the lipschitz continuity of @xmath174 .",
    "[ it : heating - b ] let @xmath109 be a sequence in @xmath88 that converges weakly to @xmath187 .",
    "since @xmath83 is weakly continuous and @xmath181 is linear and bounded , @xmath188 converges weakly to @xmath189 .",
    "further , for any function @xmath190 , the dual space of @xmath191 , we have @xmath192 the weak convergence of @xmath193 and @xmath188 therefore implies the weak convergence of @xmath194 to @xmath195 and shows the weak continuity of @xmath174 .",
    "note that for the case @xmath93 , the averaging operator @xmath181 is even compact ( see @xcite ) which implies the compactness of the composition @xmath182 . as a consequence , for any given @xmath17 ,",
    "the partial mapping @xmath196 is compact .",
    "it seems unlikely , however , that the full operator @xmath174 is compact , too .",
    "[ thm : hdiff ] for any @xmath136 , the one - sided directional derivative of @xmath174 at @xmath145 in any feasible direction @xmath197 exists .",
    "further , we have @xmath198 where @xmath199 denotes the one - sides directional derivative of @xmath83 at @xmath145 in direction @xmath200 and can be computed as the solution of . finally , if @xmath156 and @xmath157 , then @xmath174 is gteaux differentiable at @xmath150 .",
    "let @xmath201 and let @xmath197 be a feasible direction . for sufficiently small @xmath160 , we have @xmath202 according to theorem  [ thm : contf ] , the operator @xmath83 is continuous and therefore the first term converges to @xmath203 as @xmath204 . because @xmath83 is one - sided differentiable , see theorem [ thm : fdiff ] , the second term converges to @xmath205 . finally , if @xmath156 and @xmath157 , then @xmath206 is linear and bounded in the argument @xmath37 which implies the gteaux differentiability of @xmath174 at @xmath150 .",
    "recall that for any @xmath171 , the derivative @xmath207 is bounded and linear .",
    "therefore , the right hand side of depends linearly and continuously on @xmath172 . as a consequence",
    ", the one - sided directional derivative of @xmath174 at @xmath208 can be extended to a bounded linear operator @xmath209 .",
    "we will refer to this extension as the derivative of @xmath174 at @xmath145 .",
    "the derivative of @xmath174 can be written in the form @xmath210 .",
    "let @xmath211 be a bounded and convex domain with smooth boundary .",
    "we assume that @xmath212 and write @xmath213 for the space of all square integrable functions defined on @xmath214 that are supported in @xmath215 .",
    "likewise we denote by @xmath216 the space of all infinitely differentiable functions defined on @xmath214 having support in @xmath217 .",
    "further , let @xmath218 be a relatively open subset of @xmath219 , and denote by @xmath220 the maximal diameter of @xmath221 and by @xmath222 the distance between @xmath223 and the observation surface @xmath224 .",
    "[ def : w ] let @xmath225 be a smooth , nonnegative , compactly supported function with @xmath226 for all @xmath227 .",
    "we then define the wave operator by @xmath228 where @xmath24 denotes the unique solution of .",
    "the operator @xmath40 maps the initial data of the wave equation to its solution restricted to @xmath229 and models the acoustic part of the forward problem of pat .",
    "the cutoff function @xmath230 accounts for the fact , that in the two dimensional case the solution of the wave equation has unbounded support in time but measurements can only be made over a finite time interval .    in the following we use a result from @xcite to show that @xmath40 is a bounded linear and densely defined operator , and therefore can be extended to a bounded linear operator on @xmath213 in a unique manner .",
    "[ thm : wave ] there exists some constant @xmath231 such that @xmath232 for all @xmath233 .",
    "consequently , there exists a unique bounded linear extension @xmath234 with some abuse of notation we again write @xmath40 for @xmath235 in the sequel .",
    "it is sufficient to consider the case when the data are measured on the whole boundary @xmath236 .",
    "the well known explicit formulas for the solution of in two and three spatial dimensions ( see , for example , @xcite ) imply that for every @xmath237 we have @xmath238 we define the spherical mean radon transform @xmath239 by @xmath240 for @xmath241 . with the spherical mean radon transform",
    ", the wave operator can be written as @xmath242 in the case of two spatial dimensions and @xmath243 in the three dimensional case .",
    "next we use a sobolev estimate derived in @xcite , which states that for every @xmath244 there exists a constant @xmath245 such that @xmath246 for any @xmath233 .",
    "application of this identity with @xmath247 and using the smoothing properties of the abel transform by degree @xmath248 for the case of two spatial dimensions yields the continuity of @xmath40 with respect to the @xmath249 topologies .",
    "in particular , @xmath40 has a unique bounded linear extension to @xmath213 .    for solving the inverse problem of qpat we will further utilize an explicit expression for the adjoint of @xmath40 , that we compute next .    for @xmath250 , and every @xmath251",
    ", we have @xmath252    this is a simple application of fubini s theorem and the explicit expression for @xmath253 given in  .",
    "in this section we solve the inverse problem of qpat by a single - stage approach .",
    "our setting allows acoustic measurement for multiple sources .",
    "such a strategy has been called multi - source qpat or multiple illumination qpat ( see @xcite ) . for that purpose , throughout this section @xmath254 and @xmath255 , for @xmath256 , denote given source patterns and boundary light sources , respectively . recall that @xmath0 denotes a bounded convex domain with lipschitz boundary and @xmath52 denotes the inflow boundary consisting of all pairs @xmath257 with @xmath258 .    [ ]     .",
    "the absorption of photons induces an initial pressure wave proportional to the heating @xmath259 .",
    "further , @xmath217 is supposed to be contained in another domain @xmath221 , and the pressure waves are measured with acoustic detectors located on a open subset @xmath229 of the boundary of @xmath221.,title=\"fig:\",scaledwidth=35.0% ]    to indicate the dependence of the solution of the stationary rte on the pair @xmath260 we write @xmath261 for the solution operator of the stationary rte , with sources @xmath260 .",
    "here @xmath262 is the set of all admissible pairs @xmath263 defined in .",
    "further , we use @xmath264 to denote the corresponding operator describing the heating . for the coupling to the acoustic problem , it will be convenient to consider @xmath265 as an element of @xmath266 , by extending it to a function defined on @xmath214 that is equal to zero on @xmath267 .",
    "further , recall the definition [ def : w ] of the wave operator @xmath40 modeling the acoustic problem , that maps the initial pressure @xmath37 in the wave equation to its solution restricted to @xmath229 . here",
    "@xmath221 is a convex domain with smooth boundary that contains the support of @xmath34 . to apply the results of section  [ sec : forward ] , in the following",
    "we assume that @xmath212 .",
    "then , according to the section  [ sec : forward ] , the operators @xmath39 are lipschitz continuous , weakly continuous and one - sided directional differentiable , and @xmath40 is linear and bounded .",
    "a practical representation of these domains is illustrated in figure  [ fig : geometry ] .      in order to apply standard techniques for the solution of inverse problems",
    "we write the reconstruction problem of ( multiple - source ) qpat as a single operator equation . for that",
    "propose we denote by @xmath268 the operator describing the entire forward problem of qpat .",
    "further we denote by @xmath269 the squared norm on @xmath270 .",
    "[ thm : prop ]    1 .",
    "the operator @xmath271 is sequentially weakly continuous .",
    "the operator @xmath271 is lipschitz continuous .",
    "3 .   for any @xmath272",
    ", the one - sided directional derivative in any feasible direction @xmath273 exists .",
    "further , @xmath274 where @xmath275 is given by with @xmath83 replaced by @xmath29 .",
    "4 .   if @xmath276 and @xmath157 , then @xmath271 is gteaux differentiable at @xmath145 .",
    "all claims follow from the corresponding properties of the operators @xmath277 ( see theorems  [ thm : heating ] and   [ thm : hdiff ] ) and the boundedness of @xmath40 discussed in theorem [ thm : wave ] .",
    "the inverse problem of qpat with multiple illuminations consists in solving the nonlinear equation @xmath278 where @xmath279 is the unknown , @xmath280 are the given noisy data , @xmath281 is the forward operator , and @xmath282 is the noise in the data .",
    "our single - stage approach for qpat consists in estimating the parameter pair @xmath279 directly from .",
    "in contrast , existing two - stage approaches for qpat first construct estimates @xmath283 for the heating functions @xmath284 from data @xmath42 by numerically inverting @xmath40 , and subsequently solve @xmath285 for @xmath286 .",
    "there are at least two common methods for tackling an inverse problem of the form : tikhonov type regularization methods on the one and iterative regularization methods on the other hand . in the following we apply tikhonov regularization to the inverse problem of qpat .",
    "we address the inverse problem by tikhonov regularization with general convex penalty . for that purpose ,",
    "let @xmath287 be a convex , and lower semicontinuous functional with domain @xmath288 .",
    "we assume that @xmath48 is chosen such that @xmath289 is non - empty .",
    "tikhonov regularization with penalty @xmath48 consists in computing a minimizer of the generalized tikhonov functional @xmath290 here @xmath49 is the so called regularization parameter which has to be chosen accordingly , to balance between stability with respect to noise and accuracy in the case of exact data .",
    "the data - fidelity term @xmath291 guarantees that any minimizer of predicts the given data sufficiently well .",
    "the regularization term @xmath292 on the other hand avoids over - fitting of the data and makes the reconstruction process well - defined and stable .",
    "note that tikhonov regularization with penalty @xmath48 is designed to stably approximate a solution of the constrained optimization problem @xmath293 here @xmath294 is an element in the range of @xmath271 and is referred to as exact data .",
    "any solution of is called @xmath48-minimizing solution of the equation @xmath295 . under the given assumptions there",
    "exists at least one @xmath48-minimizing solution , which however is not necessarily unique , see @xcite .",
    "the properties of the operator @xmath271 derived above and the use of general results from regularization theory yield the following result .",
    "[ thm : tik ]    1 .   for data @xmath296 and every @xmath297",
    ", the tikhonov functional @xmath298 has at least one minimizer .",
    "2 .   let @xmath297 , @xmath299 , and let @xmath300 be a sequence in @xmath270 with @xmath301 .",
    "then every sequence of minimizers @xmath302 has a weakly convergent subsequence .",
    "further , the limit @xmath303 of every weekly convergent subsequence @xmath304 is a minimizer @xmath145 of @xmath305 and satisfies @xmath306 for @xmath307 .",
    "3 .   let @xmath294 , let @xmath308 be a sequence converging to zero , and let @xmath309 be a sequence of data with @xmath310 .",
    "suppose further that @xmath311 satisfies @xmath312 and @xmath313 as @xmath307 .",
    "then the following hold : * every sequence @xmath314 has a weakly converging subsequence . * the limit of every weakly convergent subsequence @xmath315 of @xmath109 is an @xmath48-minimizing solution @xmath316 of @xmath295 and satisfies @xmath317 . * if the @xmath48-minimizing solution of @xmath295 is unique , then @xmath318 .",
    "since @xmath271 is sequentially weakly continuous ( see theorem  [ thm : prop ] ) and @xmath262 is closed and convex , this follows from general results of tikhonov regularization with convex penalties , see for example , ( * ? ? ?",
    "3.3 , thm .",
    "3.4 , thm .",
    "3.5 ) .      for numerically minimizing the tikhonov functional we will use the gradient of the data - fidelity term @xmath319 recall that @xmath320 are the given data",
    ", @xmath29 is the solution operator for the stationary rte with source patterns @xmath31 and boundary light sources @xmath32 , @xmath181 is the averaging operator , and @xmath40 is the solution operator for the wave equation .    let @xmath321 be some admissible pair of parameters and let @xmath322 denote the one - sided directional derivative of @xmath323 at @xmath263 .",
    "we define the gradient @xmath324 of @xmath323 at @xmath263 to be any element in @xmath325 satisfying @xmath326 from theorem  [ thm : prop ] and the chain rule , it follows that @xmath327 exists for any feasible direction @xmath328 .",
    "further , in the case that @xmath17 and @xmath18 are strictly positive , we have @xmath329 , which implies that @xmath324 is uniquely defined by .    in order to compute the gradient",
    "we derive a more explicit expression for the one - sided directional derivative .",
    "[ prop : gradient ] let @xmath272 be an admissible pair of parameters and let @xmath330 be a feasible direction",
    ". then we have @xmath331- { \\mathbf a}(\\phi_i{\\phi^*}_i),{h_\\mu}\\right\\rangle}_{l^2({\\omega } ) }    \\\\",
    "+   \\sum_{i=1}^n { \\left\\langle- \\phi_i { \\phi^*}_i + ( { \\mathbf k}\\phi_i ) { \\phi^*}_i,{h_\\sigma}\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) } \\,,\\end{gathered}\\ ] ] where @xmath332 , and @xmath333 is the unique solution of the adjoint equation @xmath334 \\quad\\text { in } { \\omega}\\times { \\mathbb s}^{d-1}\\ ] ] satisfying the zero outflow boundary condition @xmath335 .",
    "obviously it is sufficient to consider the case @xmath336 , where we write @xmath337 , @xmath83 , @xmath92 and @xmath338 in place of @xmath42 , @xmath29 , @xmath339 and @xmath333 . by we have @xmath340,{h_\\mu}\\right\\rangle}_{l^2({\\omega } ) }   \\\\   & \\label{eq : term12}\\hspace{3cm}+   { \\left\\langle{\\mathbf a}^\\ast\\mu{\\mathbf w}_{{\\omega},{\\lambda}}^*\\left[{\\mathbf w}_{{\\omega},{\\lambda } }   \\mu{\\mathbf a}\\phi - v\\right],{\\mathbf t}'(\\mu,\\sigma)({h_\\mu},{h_\\sigma})\\right\\rangle}_{l^2({\\omega}\\times { \\mathbb s}^{d-1})}\\,.\\end{aligned}\\ ] ]    recall that @xmath338 is the solution of   with source term @xmath341 $ ] and zero outflow boundary conditions @xmath335",
    ". further , according to theorem  [ thm : fdiff ] , the one - sided directional derivative of @xmath83 is given by @xmath153 , where @xmath154 is the unique solution of @xmath342 with inflow boundary conditions @xmath343 .",
    "the zero outflow and zero inflow boundary conditions of @xmath338 and @xmath154 , respectively , and one integration by parts , show @xmath344 .",
    "further , notice that the averaging operator @xmath181 has adjoint @xmath345 , @xmath346 , and that the scattering operator @xmath67 is self - adjoint .    using these considerations , the second term in",
    "can be written as @xmath347,{\\mathbf t}'(\\mu,\\sigma)({h_\\mu},{h_\\sigma})\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1})}\\\\ \\begin{aligned } & =   { \\left\\langle   { \\left ( -\\theta \\cdot \\nabla_x + { \\left(\\mu + \\sigma - \\sigma{\\mathbf k}\\right ) } \\right ) } { \\phi^*},\\psi\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) }   \\\\&=   { \\left\\langle{\\phi^*},{\\left ( \\theta \\cdot \\nabla_x + { \\left(\\mu + \\sigma - \\sigma{\\mathbf k}\\right ) } \\right ) } \\psi\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) }   \\\\&=   { \\left\\langle{\\phi^*},-\\left({h_\\mu}+{h_\\sigma}-{h_\\sigma}{\\mathbf k}\\right)\\phi\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) }   \\\\&=   -{\\left\\langle\\phi{\\phi^*},{h_\\mu}+{h_\\sigma}\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) }   + { \\left\\langle({\\mathbf k}\\phi ) { \\phi^*},{h_\\sigma}\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) }   \\\\&=     -{\\left\\langle\\phi{\\phi^*},{\\mathbf a}^\\ast({h_\\mu})+{h_\\sigma}\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) }     + { \\left\\langle({\\mathbf k}\\phi ) { \\phi^ * } , { h_\\sigma}\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) }    \\\\&=     { \\left\\langle -{\\mathbf a}(\\phi{\\phi^*}),{h_\\mu}\\right\\rangle}_{l^2({\\omega } ) }      + { \\left\\langle-\\phi{\\phi^*}+ ( { \\mathbf k}\\phi ) { \\phi^*},{h_\\sigma}\\right\\rangle}_{l^2({\\omega}\\times\\mathbb{s}^{d-1 } ) }     \\ , .",
    "\\end{aligned }   \\end{gathered}\\ ] ] together with this yields the desired identity .",
    "let @xmath272 be an admissible pair of absorption and scattering coefficient .",
    "if @xmath185 are both strictly positive , then one concludes from proposition  [ prop : gradient ] that the gradient of @xmath323 at @xmath145 is uniquely defined and given by @xmath348 with @xmath349- { \\mathbf a}(\\phi_i{\\phi^*}_i)\\right ) } \\\\ \\label{eq : gradient3 } \\nabla_\\sigma { \\mathcal f}(\\mu,\\sigma ) & =   \\sum_{i=1}^n   { \\left(- \\phi_i { \\phi^*}_i + ( { \\mathbf k}\\phi_i ) { \\phi^*}_i\\right ) } \\,.\\end{aligned}\\ ] ] here @xmath332 , and @xmath333 is the solution of the adjoint equation with zero outflow boundary condition . in the case that @xmath185 are not both strictly positive , the gradient is not uniquely defined by .",
    "however , proposition  [ prop : gradient ] implies that the vector @xmath324 defined by , still satisfies .",
    "we therefore take , as gradient of @xmath323 at any @xmath272 .      in order to minimize the tikhonov functional we apply the proximal gradient ( or forward backward splitting ) algorithm , which is an iterative algorithm for minimizing functionals that can be written as a sum @xmath350 , where @xmath323 is smooth and @xmath351 is convex @xcite .",
    "the proximal gradient algorithm computes a sequence of iterates by alternating application of explicit gradient steps for the first functional @xmath323 and implicit proximal steps for the second functional @xmath351 .    to apply the proximal gradient algorithm for minimizing the tikhonov functional we take @xmath352 for the first and @xmath353 for the second functional .",
    "the proximal gradient algorithm then generates a sequence @xmath354 of iterates defined by @xmath355 here @xmath356 is an initial guess , @xmath357 is the step size in the @xmath358-th iteration , @xmath348 is the gradient of @xmath323 given by , , and @xmath359 is the proximity operator corresponding to the functional @xmath360 .",
    "note that the gradient @xmath361 of the data - fidelity term is easily shown to be lipschitz continuous .",
    "this either can be deduced from the explicit expressions , or by using @xmath362 . in any case , the lipschitz continuity of @xmath363 follows from similar arguments as in the proofs of the lipschitz - continuity of @xmath83 and @xmath174 , given in section [ sec : f ] and section [ sec : h ] , respectively .",
    "convergence of the proximal gradient algorithm is well known for the case that @xmath323 is convex with @xmath364-lipschitz continuous gradient and step sizes satisfying @xmath365 $ ] for some constant @xmath137 , see @xcite .",
    "these results are also valid for infinite dimensional hilbert spaces . because our forward operator @xmath271 is nonlinear , the data - fidelity term @xmath323 is non - convex and these results are not directly applicable to qpat .",
    "note however recently , the converge analysis of the proximal gradient analysis has been extended to the case of non - convex functionals ; see @xcite .",
    "our numerical simulations are carried out in @xmath366 spatial dimensions .",
    "the stationary rte is solved on a square domain @xmath367 ^ 2}$ ] . for the scattering kernel",
    "we choose the two dimensional version of the henyey - greenstein kernel , @xmath368 where @xmath369 is the anisotropy factor . before we present results of our numerical simulations we first outline how we numerically solve the stationary rte in two spatial dimensions .",
    "this step is required for evaluating both , the forward operator @xmath271 and the gradient @xmath361 of the data - fidelity term .      for the numerical solution of the stationary rte",
    ", we employ a finite element method . for that purpose one",
    "calculates the weak form of equation , by integrating the equation against a test function @xmath370 .",
    "integrating by parts in the transport term yields @xmath371 here we dropped all dependencies on the variables to shorten notation and @xmath372 denotes the usual surface measure on @xmath373 .",
    "the numerical scheme replaces the exact solution by a linear combination in the finite element space @xmath374 where any @xmath375 is the product of a basis function in space and a basis function in velocity and the sum ranges over all possible combinations .",
    "the spatial domain is triangulated uniformly with mesh size @xmath37 as illustrated in figure  [ fig : triangulation ] .",
    "the velocity direction on the circle is divided into @xmath376 equal subintervals .",
    "we use @xmath377 lagrangian elements , i.e. piecewise affine functions , in the two dimensional spatial domain as well as for the angle .",
    "[ ]     ^2}$ ] is divided into @xmath378 triangles . to any of the @xmath379 grid points",
    "@xmath380 a piecewise affine basis function is associated , that takes the value one at one grid point and the value zero on all other grid points , and is affine on every triangle.,title=\"fig:\",scaledwidth=25.0% ]    to increase stability in low scattering areas we add some artificial diffusion in the transport direction .",
    "this is called the streamline diffusion method , see for example @xcite and the references therein . in the streamline diffusion method",
    "the solution @xmath92 is approximated in the usual way by . however , the test functions take the form @xmath381 where the additional term introduces some artificial diffusion . in our experiments ,",
    "the stabilization parameter is taken as @xmath382 for @xmath383 and zero otherwise .",
    "note that the streamline diffusion method provides a fully consistent stabilization of the original problem .",
    "making the ansatz for the numerical solution and using test functions of the form , equation yields a system of linear equations @xmath384 for the coefficient vector of the numerical solution .",
    "the entries of @xmath385 and @xmath386 can be calculated by setting @xmath387 and @xmath388 .",
    "for simplicity we only consider the case @xmath389 corresponding to zero sources of internal illumination .",
    "then , similar to we obtain @xmath390 the entries of the matrix @xmath385 now can be calculated by evaluating the integrals on the left hand side of .",
    "the right hand side of together with the prescribed boundary light sources on @xmath52 yields the entries of @xmath386 .              for the following numerical results ,",
    "the stationary rte is solved by the finite element method outlined in subsection  [ sec : fe ] . for that purpose the domain @xmath391 ^ 2}$ ]",
    "is discretized by a mesh of triangular elements ( compare figure  [ fig : triangulation ] ) .",
    "the angular domain is divided into @xmath376 subintervals of equal length .",
    "the anisotropy factor is taken as @xmath392 and the scattering coefficient is taken as @xmath393 .",
    "we use a single boundary source distribution @xmath34 representing a planar illumination along the lower edge @xmath394 \\times { \\left\\{-1\\right\\}}}$ ] , where all photons enter the domain vertically . for solving the inverse problem we used a mesh containing @xmath395 triangular elements . in order to avoid performing inverse crime , for simulating the data we used a finer mesh containing @xmath396 triangular elements .",
    "the solution of the two - dimensional wave equation is computed by numerically evaluating the solution formula , where the detection curve @xmath397 is a half - circle on the boundary of @xmath398 .",
    "the adjoint @xmath399 is evaluated by numerically implementing .",
    "this can be done efficiently by a filtered backprojection algorithm as described in @xcite .",
    "the geometry of @xmath223 and @xmath224 is similar to the one illustrated in figure  [ fig : geometry ] .         for our initial experiments",
    "we assume the scattering coefficient @xmath18 to be known .",
    "in such a situation , the proximal gradient algorithm outlined in the subsection  [ sec : min ] reads @xmath400 where @xmath357 is the step size , @xmath401 is the gradient of @xmath323 in the first component , given by , and @xmath402 is the proximity operator similar as in . in the presented numerical examples the regularization term is taken as a quadratic functional @xmath403 . in order to speed up the iterative scheme we compute the proximity operator only approximately by projecting the unconstrained minimizer @xmath404 on @xmath262 .",
    "therefore the main numerical cost in the proximal step is the solution of a linear equation , which is relatively cheap compared to the evaluation of the gradient @xmath405 .    in figures  [ fig : sim1 ] and",
    "[ fig : sim ] we present results of our numerical experiments .",
    "figure  [ fig : sim1 ] shows the true absorption coefficient as well as the heating function and the simulated pressure data .",
    "the left image in figure  [ fig : sim ] shows the numerical reconstruction with the proposed single - stage approach using 40 iterations of the proximal gradient algorithm .",
    "we observed empirically , that the proximal gradient algorithm stagnated after 20 to 40 iterations and therefore we used 40 as a stopping index . for comparison purpose ,",
    "the right image in figure  [ fig : sim ] shows reconstruction results using the classical two - stage approach . for that purpose",
    "we apply tikhonov regularization and the proximal gradient algorithm to the inverse problem @xmath406 . again",
    "the iteration has been stopped after 40 iteration , where the iteration has been stagnated .",
    "the approximate heating @xmath37 is computed numerically by applying the two dimensional universal backprojection formula @xcite to the acoustic data @xmath407 .",
    "all computations have been performed in matlab on a notebook with @xmath408{ghz}$ ] intel core i7 processor .",
    "the total computation times have been 26 minutes for the two - stage approach and 38 minutes for the single - stage approach .",
    "one notices that in both reconstructions some boundaries in the upper half are blurred .",
    "such artifacts are expected and arise from the ill - posedness of the acoustical problem when using limited - angle data ; see @xcite",
    ". however these artifacts are less severe for the single - stage algorithm than for the classical two - stage algorithm .",
    "further , in this example , the single - stage algorithm also yields a better quantitative estimation of the values of the absorption coefficient .",
    "added noise ( left ; detector location varies in the horizontal and time in the vertical direction ) , reconstructed absorption coefficient using our single - stage approach ( middle ) the classical two - stage approach ( right).,title=\"fig:\",scaledwidth=31.0% ]   added noise ( left ; detector location varies in the horizontal and time in the vertical direction ) , reconstructed absorption coefficient using our single - stage approach ( middle ) the classical two - stage approach ( right).,title=\"fig:\",scaledwidth=30.0% ]   added noise ( left ; detector location varies in the horizontal and time in the vertical direction ) , reconstructed absorption coefficient using our single - stage approach ( middle ) the classical two - stage approach ( right).,title=\"fig:\",scaledwidth=30.0% ]    finally , in order to investigate the stability of the derived algorithms with respect to noise , we applied the single - stage and the two - stage algorithm after adding gaussian white noise to the data with standard deviation equal to @xmath409 of the maximal absolute data values .",
    "note that for both , the single - stage and the two - stage algorithm , noise has only been added to the acoustic data .",
    "the reconstruction results for noisy data are shown in figure  [ fig : sim - noisy ] . as can be seen",
    "both algorithms are quite stable with respect to data perturbations . however ,",
    "again , the single - stage approach yields better results and less artifacts than the two - stage algorithm .",
    "in this paper we proposed a single - stage approach for quantitative pat .",
    "for that purpose we derive algorithms that directly recover the optical parameters from the measured acoustical data .",
    "this is in contrast to the usual two - stage approach , where the absorbed energy distribution is estimated in a first step , and the optical parameters are reconstructed from the estimated energy distribution in a second step .",
    "our single - stage algorithm is based on generalized tikhonov regularization and minimization of the tikhonov functional by the proximal gradient algorithm . in order to show that tikhonov regularization is well - posed and convergent we analyzed the stationary radiative transfer equation , in a functional analytic framework . for that purpose we used recent results of @xcite that guarantees the well - posedness even in the case of voids .",
    "we presented results of our initial numerical studies using a simple limited angle scenario , where the scattering coefficient is assumed to be known .",
    "in this situation our single - stage algorithms has led to less artifacts than the two - stage procedure .",
    "more detailed numerical studies will be presented in future work . in that context",
    ", we will also investigate the use of multiple illuminations and multiple wavelength , which allows to also reconstruct the in general unknown scattering coefficient and grneissen parameter .",
    "we further plan to investigate the use of more general regularization functionals such as the total variation in combination with the single - stage approach .",
    "this work has been supported by the tyrolean science fund ( tiroler wissenschaftsfonds ) , project number 153722 .",
    "we want to thank the referees for useful comments which helped to improve our manuscript , and for bringing reference @xcite to our attention .",
    "m.  agranovsky , p.  kuchment , and l.  kunyansky . on reconstruction formulas and algorithms for the thermoacoustic tomography . in l.  v. wang , editor , _ photoacoustic imaging and spectroscopy _ , chapter  8 , pages 89101 .",
    "crc press , 2009 .",
    "h.  attouch , j.  bolte , and b.  f. svaiter .",
    "convergence of descent methods for semi - algebraic and tame problems : proximal algorithms , forward ",
    "backward splitting , and regularized gauss  seidel methods .",
    ", 137(1 - 2):91129 , 2013 .",
    "b.  t. cox , s.  r. arridge , p.  kstli , and p.  c. beard .",
    "two - dimensional quantitative photoacoustic image reconstruction of absorption distributions in scattering media by use of a simple iterative method .",
    ", 45(8):18661875 , 2006 .",
    "b.  t. cox , t.  tarvainen , and s.  r. arridge .",
    "multiple illumination quantitative photoacoustic tomography using transport and diffusion models . in g.",
    "bal , d.  finch , p.  kuchment , j.  schotland , p.  stefanov , and g.  uhlmann , editors , _ tomography and inverse transport theory _ ,",
    "volume 559 of _ contemporary mathematics _",
    ", pages 112 .",
    "ams , 2011 ."
  ],
  "abstract_text": [
    "<S> the development of efficient and accurate image reconstruction algorithms is one of the cornerstones of computed tomography . </S>",
    "<S> existing algorithms for quantitative photoacoustic tomography currently operate in a two - stage procedure : first an inverse source problem for the acoustic wave propagation is solved , whereas in a second step the optical parameters are estimated from the result of the first step . </S>",
    "<S> such an approach has several drawbacks . in this paper </S>",
    "<S> we therefore propose the use of single - stage reconstruction algorithms for quantitative photoacoustic tomography , where the optical parameters are directly reconstructed from the observed acoustical data . in that context </S>",
    "<S> we formulate the image reconstruction problem of quantitative photoacoustic tomography as a single nonlinear inverse problem by coupling the radiative transfer equation with the acoustic wave equation . </S>",
    "<S> the inverse problem is approached by tikhonov regularization with a convex penalty in combination with the proximal gradient iteration for minimizing the tikhonov functional . </S>",
    "<S> we present numerical results , where the proposed single - stage algorithm shows an improved reconstruction quality at a similar computational cost .    </S>",
    "<S> * keywords . </S>",
    "<S> * quantitative photoacoustic tomography , stationary radiative transfer equation , wave equation , single - stage algorithm , inverse problem , parameter identification    * ams classification numbers . * </S>",
    "<S> 44a12 , 45q05 , 92c55 . </S>"
  ]
}