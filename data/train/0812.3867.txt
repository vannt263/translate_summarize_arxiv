{
  "article_text": [
    "populations of biological cells frequently show stochastic switching between alternative phenotypic states .",
    "this phenomenon is particularly well - studied in bacteria and bacteriophages , where it is known as phase variation @xcite .",
    "phase variation often affects cell surface features , and its evolutionary advantages are believed to involve evading attack from host defense systems ( e.g. the immune system ) and/or `` bet - hedging '' against sudden catastrophes which may wipe out a particular phenotypic type .",
    "switching between different phenotypic states is controlled by an underlying genetic regulatory network , which randomly flips between alternative patterns of gene expression .",
    "several different types of genetic network are known to control phase variation ",
    "these include dna inversion switches , dna methylation switches and slipped strand mispairing mechanisms @xcite .    in this paper , we study a simple model for a genetic network that allows switching between two alternative states of gene expression .",
    "its key feature is that it includes a linear feedback mechanism between the switch state and the flipping rate .",
    "when the switch is active , an enzyme is produced and the rate of switching is linearly proportional to the copy number of this enzyme .",
    "the statistical properties of this model are made non - trivial by this feedback , leading , among other things , to non - poissonian behaviour that may be of advantage to cells in surviving in certain dynamical environments .",
    "our model is very generic and does not aim to describe any specific molecular mechanism in detail , but rather to determine in a general way the consequences of the linear feedback for the switching statistics .",
    "motivated by the fact that cells often contain multiple copies of a particular genetic regulatory element , due to dna replication or dna duplication events during evolution , we also consider the case of two identical switches in the same cell .",
    "we find that the two copies of the switch are coupled and may exhibit interesting and potentially important correlations or anti - correlations .",
    "our model switch is fundamentally different from bistable gene networks that have been the subject of previous theoretical interest .",
    "in fact , as we shall show , our switch is not bistable but is intrinsically unstable in each of its two states .    before discussing our model in detail , we provide a brief overview of the basic biology of genetic networks and summarise some previously considered models for genetic switches .",
    "genetic networks are interacting , many - component systems of genes , rna and proteins , that control the functions of living cells .",
    "genes are stretches of dna ( @xmath01000 base pairs long in bacteria ) , whose sequences encode particular protein molecules . to produce a protein molecule , the enzyme complex rna polymerase copies the gene sequence into a messenger rna ( mrna ) molecule .",
    "this is known as transcription .",
    "the mrna is then translated ( by a ribosome enzyme complex ) into an amino acid chain which folds to form the functional protein molecule .",
    "the production of a specific set of proteins from their genes ultimately determines the phenotypic behaviour of the cell .",
    "phenotypic behaviour can thus be controlled by turning genes on and off .",
    "regulation of transcription ( production of mrna ) is one important way of achieving this .",
    "transcription is controlled by the binding of proteins known as transcription factors to specific dna sequences , known as operators , usually situated at the beginning of the gene sequence .",
    "these transcription factors may be activators ( which enhance the transcription of the gene they regulate ) or repressors ( which repress transcription , often by preventing rna polymerase binding ) .",
    "a given gene may encode a transcription factor that regulates itself or other genes , leading to complex networks of transcriptional interactions between genes .",
    "there has been much recent interest among both physical scientists and biologists in deconstructing complex genetic networks into modular units @xcite , and in seeking to understand their statistical properties using theory and simulation  @xcite .",
    "of particular interest is the fact that genetic networks are intrinsically stochastic , due to the small numbers of molecules involved in gene expression @xcite",
    ". this can give rise to heterogeneity in populations of genetically and environmentally identical cells @xcite .",
    "for some genetic networks , this heterogeneity is `` all - or - nothing '' : the population splits into two distinct sub - populations , with different states of gene expression .",
    "such networks are known as bistable genetic switches : they have two possible long - time states , corresponding to alternative phenotypic states .",
    "well - known examples are the switch controlling the transition from the lysogenic to lytic states in bacteriophage @xmath1 @xcite , and the lactose utilisation network of the bacterium _ escherichia coli _ @xcite . several simple mechanisms for achieving bistability have been studied , including pairs of mutually repressing genes @xcite , positive feedback loops @xcite and mixed feedback loops @xcite .",
    "such bistable genetic networks can allow long - lived and binary responses to short - lived signals  for example , when a cell is triggered by a transient signal to commit to a particular developmental pathway .",
    "theoretical treatments of bistable genetic networks usually consider the dynamics of the copy number ( or concentration ) of the regulatory proteins involved .",
    "this affects the activation state of the genes , which in turn influences the rate of protein production .",
    "the macroscopic rate equation approach @xcite provides a deterministic ( mean - field ) description of the dynamics that ignores fluctuations in protein copy number or gene expression state .",
    "this approach , applied to a switch with two mutually repressing genes , has shown that co - operative binding of regulatory proteins is an important factor in generating bistability @xcite .",
    "other studies have shown , however , that bistability can be achieved even when the deterministic equations have only one solution , due to stochasticity and fluctuations in protein numbers @xcite .",
    "an alternative approach is to study the dynamics of stochastic flipping between two stable states using stochastic simulations @xcite , by numerically integrating the master equation @xcite , or by path integral - type approaches @xcite .",
    "this dynamical problem bears some resemblance to the kramers problem of escape from a free energy minimum @xcite , and one expects on general grounds that the typical time spent in one of the bistable states should be exponentially large in the typical number of proteins present in the state .",
    "this has been confirmed , at least for cooperative toggle switches formed of mutually repressing genes @xcite . from the perspective of statistical physics ,",
    "interesting questions arise concerning the distribution of escape times and the connection to first passage properties of stochastic processes .    in this paper , however , we are concerned with an intrinsically different situation from these bistable genetic networks .",
    "the molecular mechanisms controlling microbial phase variation typically involve a binary element that can be in either of two states .",
    "for example , this may be a short fragment of dna that can be inserted into the chromosome in either of two orientations , a repeated dna sequence that can be altered in its number of repeats , or a dna sequence that can have two alternative patterns of methylation @xcite .",
    "the flipping of this element between its two states is stochastic , with a flipping rate that is controlled by various regulatory proteins , the activity of which may be influenced by environmental factors .",
    "we shall consider the case where a feedback exists between the switch state and the flipping rate .",
    "this is particularly interesting from a statistical physics point of view because it leads to non - poissonian switching behaviour , as we shall show .",
    "our work has been motivated by several examples .",
    "the _ fim _",
    "system in uropathogenic strains of the bacterium _",
    "e. coli _ controls the production of type 1 fimbriae ( or pili ) , which are `` hairs '' on the surface of the bacterium .",
    "individual cells switch stochastically between `` on '' and `` off '' states of fimbrial production @xcite . the key feature of the _ fim _ switch is a short piece of dna that can be inserted into the bacterial dna in two possible orientations .",
    "because this piece of dna contains the operator sequence for the proteins that make up the fimbriae , in one orientation , the fimbrial genes are transcribed and fimbriae are produced ( the `` on '' state ) and in the other orientation , the fimbrial genes are not active and no fimbriae are produced ( the `` off '' state ) .",
    "the inversion of this dna element is mediated by recombinase enzymes .",
    "feedback between the switch state and the switch flipping rate arises because the fime recombinase ( which flips the switch in the on to off direction ) , is produced more strongly in the on switch state than in the off state .",
    "this phenomenon is known as orientational control @xcite .",
    "the production of a second type of fimbriae in uropathogenic _",
    "e. coli _ , pap pili , also phase varies , and is controlled by a dna methylation switch @xcite . here , the operator region for the genes encoding the pap pili can be in two states , in which the dna is chemically modified ( methylated ) at different sites , and different binding sites are occupied by the regulatory protein lrp . switching in this system",
    "is facilitated by the papi protein , which helps lrp to bind @xcite .",
    "feedback between the switch state and the flipping rate arises because the production of papi itself is activated by the protein papb , which is only produced in the `` on '' state @xcite .",
    "a common feature of the above examples is the existence of a feedback mechanism : in the _ fim _ system this occurs through orientational control , and in the _ pap _ system , through activation of the _ papi _ gene by papb . in this paper",
    ", we aim to study the role of such feedback within a simple , generic model of a binary genetic switch .",
    "we shall assume that the feedback is linear , and we thus term our model a `` linear feedback switch '' . in a recent publication @xcite , we introduced a simple mathematical model of a dna inversion genetic switch with orientational control , which was inspired by the _",
    "fim _ system .",
    "our model reduces to the dynamics of the number of molecules of a `` flipping enzyme '' @xmath2 , which mediates switch flipping , along with a binary switch state .",
    "enzyme @xmath2 is produced only in the on switch state .",
    "as the copy number of @xmath2 increases , the on to off flipping rate of the switch increases and this results in a non - poissonian flipping process with a peak in the lifetime of the on state . the model is linear in the sense that the rate at which the switch is turned off is a linear function of the number of enzymes @xmath2 which it produces . in our previous work @xcite",
    ", we imagined enzyme @xmath2 to be a dna recombinase , and the two switch states to correspond to different dna orientations , in analogy with the _ fim _ system .",
    "however , the same model could be used to describe a range of molecular mechanisms for binary switch flipping with feedback between the switch state and flipping rate , and can thus be considered a generic model of a genetic switch with linear feedback .    in our recent work @xcite , we obtained exact analytical expressions for the steady state enzyme copy number for our model switch with linear feedback , in the particular case where the flipping enzyme switches only in the on to off direction ( this being the relevant case for _ fim _ )",
    ". we also calculated the flip time distribution for this model analytically .",
    "conceptually , such a calculation is reminiscent of the study of persistence in statistical physics @xcite where , for example , one asks about the probability that a spin in an ising system has not flipped up to some time @xcite . for the flip time distribution , we introduced different measurement ensembles according to whether one starts the time measurement from a flip event ( the switch change ensemble ) or from a randomly selected time ( the steady state ensemble ) . in the present paper ,",
    "we extend this work to present the full solution of the general case of the model and extend our study of its persistence properties .",
    "the introduction of a rate for the enzyme mediated off to on flipping ( @xmath3 ) has most significant effects on the flip time distributions @xmath4 , as illustrated in figs .",
    "[ fig : diagram ] and [ fig : diagramk3off0 ] where we show the parameter range over which a peak is found in @xmath4 for zero and non - zero @xmath3 .",
    "we also prove an important relation between the two measurement ensembles defined in @xcite and use it to show that a peak in the flip time distribution only occurs in the switch change ensemble and not in the steady state ensemble .",
    "we find that the non - poissonian behaviour of this model switch leads to interesting two - time autocorrelation functions .",
    "we also study the case where we have two copies of the switch in the same cell and find that these two copies may be correlated or anticorrelated , depending on the parameters of the model , with potentially interesting biological implications .",
    "the paper is structured as follows . in section",
    "ii we define the model , describe its phenomenology , and show that a `` mean - field '' , deterministic version of the model has only one steady state solution . in section",
    "iii we present the general solution for the steady state statistics and in section iv we study first passage - time properties of the switch ; technical calculations are left to the appendices . in section",
    "v we consider two coupled model switches and we present our conclusions in section vi .",
    "we consider a model system with a flipping enzyme @xmath2 and a binary switch @xmath5 , which can be either on or off ( denoted respectively as @xmath6 and @xmath7 ) .",
    "enzyme @xmath2 is produced ( at rate @xmath8 ) only when the switch is in the on state , and is degraded at a constant rate @xmath9 , regardless of the switch state .",
    "this represents protein removal from the cell by dilution on cell growth and division , as well as specific degradation pathways .",
    "switch flipping is assumed to be a single step process , which can either be catalysed by enzyme @xmath2 , with rate constants @xmath10 and @xmath3 and linear dependence on the number of molecules of @xmath2 , or can happen `` spontaneously '' , with rates @xmath11 and @xmath12 .",
    "we imagine that the `` spontaneous '' switching process may in fact be catalysed by some other enzyme whose concentration remains constant and which is therefore not modelled explicitly here . our model , which is shown schematically in fig .",
    "[ fig : sketch ] , is defined by the following set of biochemical reactions :    [ eq : react ] @xmath13{{k^{\\textrm{on}}}_3 } s_{{\\textrm{off } } } + r & s_{{\\textrm{on } } } & \\xrightleftharpoons[{k^{\\textrm{off}}}_4]{{k^{\\textrm{on}}}_4 } s_{{\\textrm{off}}}\\,\\,.\\end{aligned}\\ ] ]    ( colour online ) a schematic illustration of the model dna inversion switch . ]",
    "we notice that there are two physically relevant and coupled timescales for our model switch : the timescale associated with changes in the number of @xmath2 molecules ( dictated by the production and decay rates @xmath9 and @xmath8 ) , and that associated with the flipping of the switch ( dictated by @xmath14 , @xmath15 and the @xmath2 concentration ) .",
    "we first consider the case where the timescale for @xmath2 production / decay is much faster than the switch flipping timescale .",
    "the top left panel of fig .",
    "[ fig : sampletraj_k3 ] shows a typical dynamical trajectory for parameters in this regime . here",
    ", we plot the number @xmath16 of @xmath2 molecules , together with the switch state , against time .",
    "this result was obtained by stochastic simulation of reaction set ( [ eq : react ] ) using the gillespie algorithm  @xcite .",
    "this algorithm generates a continuous time markov process which is exactly described by the master equation ( [ eq : master ] ) . for a given switch state ,",
    "the number @xmath16 of molecules of @xmath2 varies according to reactions ( [ eq : reacta ] ) .",
    "when the switch is in the on state , @xmath16 grows towards a plateau value , and when the switch is in the off state , @xmath16 decreases exponentially towards @xmath17 .",
    "the time evolution of @xmath16 can thus be seen as a sequence of relaxations towards two different asymptotic steady states , which depend on the switch position . to better understand this limiting case",
    ", we can make the assumption that the number of @xmath2 molecules evolves deterministically for a given switch state .",
    "we can then write down deterministic rate equations corresponding to the reaction scheme ( [ eq : react ] ) .",
    "these equations are first order differential equations for @xmath18 , the mean concentration of the enzyme .",
    "when the switch is on , the rate equation reads @xmath19 with solution @xmath20\\;.\\ ] ] thus the plateau density in the on state is given by the ratio @xmath21 and the timescale for relaxation to this density is given by @xmath9 , the rate of degradation of @xmath22 .",
    "when the switch is in the off state , the rate equation for @xmath18 reads instead @xmath23 and one simply has exponential decay to @xmath24 with decay time @xmath9 . in this parameter regime",
    ", switch flipping typically happens when the number of molecules of @xmath2 has already reached the steady state ( as in the top left panel of fig . [",
    "fig : sampletraj_k3 ] ) .",
    "thus , the on to off switching timescale is given by @xmath25 , where @xmath26 is the plateau concentration of flipping enzyme when the switch is in the on state , given by eq.([rhoon ] ) .",
    "since the corresponding plateau concentration in the off switch state is zero , the off to on switch flipping timescale is simply given by @xmath27 .",
    "we now consider the opposite scenario , in which switching occurs on a much shorter timescale than relaxation of the enzyme copy number .",
    "a typical trajectory for this case is shown in the bottom left panel of fig .",
    "[ fig : sampletraj_k3 ] . here ,",
    "switching reactions dominate the dynamics of the model , and the dynamics of the enzyme copy number follows a standard birth - death process , with an effective birth rate given by the enzyme production rate in the on state multiplied by the fraction of time spent in the on state . a more quantitative account for these behaviours",
    "is provided later on , in [ sec : pss ] .    for parameter values between these two extremes , where the timescales for switch flipping and enzyme number relaxation are similar , it is more difficult to provide intuitive insights into the behaviour of the model .",
    "a typical trajectory for this case is given in the middle left panel of fig .",
    "[ fig : sampletraj_k3 ] . here , we have set the on to off and off to on switching rates to be identical : @xmath28 and @xmath29 .",
    "we notice that typically , less time is spent in the on state than in the off state .",
    "as soon as the switch flips into the on state , the number of @xmath2 molecules starts increasing and the on to off flip rate begins to increase .",
    "consequently , the number of @xmath2 molecules rarely reaches its plateau value before the switch flips back into the off state .    to illustrate the effects of including the parameter @xmath3",
    ", we also show trajectories for different values of the ratio @xmath30 in fig .",
    "[ fig : sampletraj_k3off ] , for fixed @xmath10 . for small @xmath31",
    ", the amount of enzyme decays to zero in the off state before the next off - to - on flipping event resulting in bursts of enzyme production .",
    "in contrast , when @xmath31 is @xmath32 , flipping is rapid in both directions so that @xmath33 is peaked at intermediate @xmath16 .          to explore how the switching behaviour of our model arises , we can write down mean - field , deterministic rate equations corresponding to the full reaction scheme ( [ eq : react ] ) .",
    "these equations describe the time evolution of the mean concentration @xmath34 of @xmath2 molecules and the probabilities @xmath35 and @xmath36 of the switch being in the on and off states .",
    "these equations implicitly assume that the mean enzyme concentration @xmath18 is completely decoupled from the state of the switch .",
    "thus correlations between the concentration @xmath18 and the switch state are ignored and the equations furnish a mean - field approximation for the switch . as we now show , this crude type of mean - field description is insufficient to describe the stochastic dynamics of the switch , except in the limit of high flipping rate . noting that @xmath37 , the mean - field equations read :    @xmath38    @xmath39    the above equations have two sets of possible solutions for the steady  state values of @xmath18 and @xmath40 , but only one has a positive value of @xmath18 , and is therefore physically meaningful .",
    "the result is : @xmath41 where @xmath42    and @xmath43 the most interesting conclusion to be drawn from this mean - field analysis is that there is only one physically meaningful solution . in this solution ,",
    "the enzyme concentration @xmath18 is less than the plateau value in the on state [ @xmath26 of eq.([rhoon ] ) ] .",
    "thus reaction scheme ( [ eq : react ] ) does not have an underlying bistability .",
    "the two states of our stochastic switch evident in figures [ fig : sampletraj_k3 ] and [ fig : sampletraj_k4 ] for low values of @xmath14 and @xmath15 are not bistable states but are rather intrinsically unstable and transient states , each of which will inevitably give rise to the other after a certain ( stochastically determined ) period of time . in this sense ,",
    "our model is fundamentally different from the bistable reaction networks which have previously been discussed @xcite . on the other hand , in the limit of rapid switch flipping , where @xmath14 or @xmath15 is large",
    ", the mean - field description holds and the protein number distribution does show a single peak whose position is well approximated by eq .",
    "( [ rho ] ) , as shown in figures [ fig : sampletraj_k3 ] and [ fig : sampletraj_k4 ] for the case @xmath44 .",
    "returning to the fully stochastic version of the reaction scheme ( [ eq : react ] ) , we now present an exact solution for the steady  state statistics of this model . a solution for the case where @xmath45 was sketched in ref .",
    "@xcite . here",
    "we present a complete solution for the general case where @xmath46 , and we discuss the properties of the steady  state as a function of all the parameters of the system .",
    "we first define the probability @xmath47 that the system has exactly @xmath16 enzyme molecules at time @xmath48 and the switch is in the @xmath49 state ( where @xmath50 ) .",
    "the time evolution of @xmath51 is described by the following master equation : @xmath52 where we use the shorthand notations @xmath53 , @xmath54 and @xmath55 . in the steady state ,",
    "the time derivative in eq.([eq : master ] ) vanishes , and the problem reduces to a pair of coupled equations for @xmath56 and @xmath57 :    [ eq : masterp ] @xmath58",
    "@xmath59    to solve the above equations we introduce the generating functions @xmath60 the steady - state equations ( [ eq : masterp ] ) can be now written as a set of linear coupled differential equations for @xmath61 :    [ eq : gz ] @xmath62    where @xmath63 are linear differential operators :    l_1(z ) = & k_1 ( z-1 ) _ z - k_2 ( z-1 ) + k^_3 z _ z + k^_4 , + l_2(z)=&k^_3 z _ z + k^_4 , + l_3(z)= & k_1 ( z-1 ) _ z + k^_3 z _ z + k^_4 , + l_4(z)= & k^_3 z _ z + k^_4 .    in order to solve the two coupled eqs .",
    "( [ eq : gz ] ) it is first useful to take their difference .",
    "after simplification this yields the relation : @xmath64 next , we take the first derivative of ( [ eq : goff ] ) and then replace the derivatives of @xmath65 with the relation ( [ eq : relgon ] ) . after some algebra",
    ", one finds that @xmath66 verifies the following second order differential equation : @xmath67 where the greek letters are combinations of the parameters of the model :    @xmath68    we now introduce the new variable @xmath69 and the new parameter combinations : @xmath70 we can now write @xmath71 ( and @xmath72 ) in terms of the variable @xmath73 ( [ udef ] ) by defining the functions @xmath74 the differential equation ( [ eq : diff ] ) then reads : @xmath75 looking for a regular power series solution of the form @xmath76 one obtains the following solution : @xmath77 where @xmath78 denotes the confluent hypergeometric function of the first kind , @xmath79 and @xmath80 denotes the pochhammer symbol .",
    "the constant @xmath81 will be determined using the boundary conditions , which we discuss later .",
    "we first note that the above result for @xmath82 can be translated into @xmath83 by replacing @xmath73 with the expression of @xmath84 in ( [ gonu ] ) and expanding in powers of @xmath85 : @xmath86^{n - m } \\binom{n}{m}\\\\ = \\sum_{n=0}^{\\infty } z^n \\sum_{m = n}^{\\infty } a_m u_0^{m - n } [ ( u_1-u_0)]^{n } \\binom{m}{n } \\label{gonsol}\\end{gathered}\\ ] ] where we have relabelled the indices @xmath87 and @xmath88 in the last line .",
    "we can identify @xmath89 from ( [ eq : genfun ] ) as the coefficient of @xmath90 in the above expression : @xmath91 from ( [ gonu ] ) and ( [ eq : gonfull ] ) we read off @xmath92 substituting ( [ an ] ) in ( [ eq : ponsol ] ) we deduce , using the definition of the hypergeometric function ( [ hgdef ] ) and noting @xmath93 , that @xmath94 in deriving this expression we have , in fact , established the following identity which will prove useful again later : @xmath95 to compute @xmath72 , we integrate eq.([eq : relgon ] ) , which yields , using the form of @xmath82 ( [ eq : gonfull ] ) : @xmath96 where @xmath97 is our second integration constant .",
    "we then have two constants , @xmath81 and @xmath97 , which still need to be determined .",
    "the constant @xmath97 can be found using the normalisation condition @xmath98 , which is equivalent to @xmath99 . using this condition ,",
    "we obtain @xmath100 in order to compute the remaining constant @xmath81 , we consider the boundary condition at @xmath101 . from the definition ( [ eq : genfun ] ) of the generating function we see that @xmath102 .",
    "our boundary condition thus reads : @xmath103 setting @xmath17 in the master equation eq.([eq : masterpon ] ) [ noting that the term in @xmath104 vanishes ] gives @xmath105 in terms of @xmath106 and @xmath107 : @xmath108 combining eqs.([eq : fastest ] ) [ with @xmath101 ] and ( [ eq : kappa ] ) , substituting in eq.([eq : boundary ] ) , using eq.([eq : ponpoff ] ) to eliminate @xmath105 , and finally substituting in expressions for @xmath106 and @xmath107 from eq.([eq : ponsol ] ) , we determine @xmath81 : @xmath110 \\,\\,.\\end{gathered}\\ ] ] the final step in obtaining our exact solution is to provide an explicit expression for @xmath111 . from ( [ eq : fastest ] ) we have @xmath112 and using the identity ( [ fident ] )",
    "we obtain : @xmath113\\,\\,,\\end{gathered}\\ ] ] where @xmath114 is the kronecker delta .",
    "our exact analytical solution ( [ eq : ponsol ] ) , ( [ eq : a0sol ] ) and ( [ eq : poffsol ] ) is verified by comparison to computer simulation results in the right panels of figs .",
    "[ fig : sampletraj_k3 ] and [ fig : sampletraj_k4 ] . here , we plot the probability distribution function for the total number of enzyme molecules : @xmath115 computer simulations of the reaction set ( [ eq : react ] ) were carried out using gillespie s stochastic simulation algorithm  @xcite .",
    "perfect agreement is obtained between the numerical and analytical solutions , as shown in figs .",
    "[ fig : sampletraj_k3 ] and [ fig : sampletraj_k4 ] .      having derived the steady  state solution for @xmath33 , we now analyse its properties as a function of the parameters of the model .",
    "we choose to fix our units of time by setting @xmath9 , the decay rate of enzyme @xmath2 , to be equal to unity ( so our time units are @xmath116 ) . with these units ,",
    "the plateau value for the number of enzyme molecules in the on switch state is given by @xmath117 . in this section",
    ", we will only analyse the case where @xmath118 . to further simplify our analysis",
    ", we set @xmath119 and @xmath120 ( a discussion of the case where @xmath121 and @xmath122 is provided in ref .",
    "we then analyse the probability distribution @xmath33 as a function of the @xmath2-dependent switching rate @xmath14 and the @xmath2-independent switching rate @xmath15 .",
    "the results are shown in the right - hand panels of fig .",
    "[ fig : sampletraj_k3 ] and fig .",
    "[ fig : sampletraj_k4 ] .",
    "we consider the three regimes discussed in section [ sec : phen ] : that in which enzyme number fluctuations are much faster than switch flipping , that where the opposite is true , and finally the regime where the two timescales are similar .    in the regime where switch flipping is much slower than enzyme production / decay [ @xmath123 ,",
    "the probability distribution @xmath33 is bimodal .",
    "this is easily understandable in the context of the typical trajectories shown in the left top panels in figs .",
    "[ fig : sampletraj_k3 ] and [ fig : sampletraj_k4 ] : in this regime , the number of molecules of @xmath2 always reaches its steady - state value before the next switch flip occurs .",
    "it follows then that @xmath89 is a bell - shaped distribution peaked around @xmath124 , while @xmath111 is highly peaked around zero , so that the total distribution @xmath125 is bimodal .    in contrast , when switching occurs much faster than enzyme number fluctuations the probability distribution @xmath33 is unimodal and bell shaped , as might be expected from the trajectories in the bottom left panels of figs .",
    "[ fig : sampletraj_k3 ] and [ fig : sampletraj_k4 ] . as discussed in section [ sec : phen ] , in this regime the number of @xmath2 molecules behaves as a standard birth - death process with effective birth rate given by @xmath8 multiplied by the average time the switch spends in the on state , and death rate @xmath9 .",
    "for such a birth - death process the steady state probability @xmath33 is a poisson distribution with mean given by the ratio of the birth rate to the death rate . to show that our analytical result reduces to this poisson distribution",
    ", we consider the case where enzyme - mediated switching dominates ( as in fig .",
    "[ fig : sampletraj_k3 ] ) , so that both @xmath3 and @xmath10 are much greater than @xmath9 .",
    "the fraction of time spent in the on state is @xmath126 , thus the effective birth rate is @xmath127 . in the limit @xmath128 and @xmath129 with @xmath30 constant",
    ", one finds that @xmath130 , @xmath131 , and @xmath132 $ ] .",
    "using the fact that @xmath133 , eq.([eq : gonfull ] ) gives , in this limit , @xmath134 which is the generating function of a poisson distribution with mean @xmath135 $ ] . plugging this result into eq.([eq : fastest ] ) and taking again the limit @xmath136 [ and using that @xmath137 finally yields the result that @xmath138 is indeed a poisson distribution .",
    "the same approach can be taken for the case of fig .",
    "[ fig : sampletraj_k4 ] , where @xmath14 is constant , and @xmath11 and @xmath12 become very large .",
    "the probability distribution @xmath33 then becomes a poisson distribution with mean @xmath139 $ ] .",
    "the above result is only valid when @xmath140 .",
    "in fact , as shown in fig . [",
    "fig : sampletraj_k3off ] , when @xmath141 the distribution of @xmath2 is peaked at 0 and does not have a poisson - like shape .    finally , when there is no clear separation of timescales between enzyme number fluctuations and switch flipping , the distribution function for the number of enzyme molecules has a highly non - trivial shape , as shown in the middle panels of figs .",
    "[ fig : sampletraj_k3 ] and [ fig : sampletraj_k4 ] .",
    "we now calculate the first passage time distribution for our model switch .",
    "we define this to be the distribution function for the amount of time that the switch spends in the on or off states before switching .",
    "this distribution is biologically relevant , since it may be advantageous for a cell to spend enough time in the on state to synthesise and assemble the components of the `` on '' phenotype ( for example , fimbriae ) , but not long enough to activate the host immune system , which recognises these components .",
    "the calculation for the case @xmath121 was sketched in @xcite . here",
    "we provide a detailed calculation of the flip time distribution in the more general case @xmath46 .",
    "we find that this dramatically reduces the parameter range over which the flip time distribution has a peak .",
    "we demonstrate an important relation between the flip time distributions for the two relevant choices of initial conditions ( switch change ensemble and steady state ensemble ) . the first passage time distribution is important and interesting from a statistical physics point of view as it is related to `` persistence '' .",
    "generally , persistence is expressed as the probability that the local value of a fluctuating field does not change sign up to time @xmath48 @xcite .",
    "for the particular case of an ising model , persistence is the probability that a given spin does not flip up to time @xmath48 . in our model",
    ", the switch state @xmath5 plays the role of the ising spin . for other problems ,",
    "there has been much interest in the long - time behaviour of the persistence probability , which can often exhibit a power - law tail . in our case , however , we expect an exponential tail for the distribution of time spent in the on state , because linear feedback will cause the switch to flip back to the off state after some characteristic time .",
    "we are therefore interested not only in the tail of the first passage time distribution , but in its shape over the whole time range .",
    "we consider the probability @xmath142 that if we begin monitoring the switch at time @xmath143 when there are @xmath144 molecules of the flipping enzyme @xmath2 , it remains from time @xmath145 in state @xmath146 , and subsequently flips in the time interval @xmath147 .",
    "this probability is averaged over a given ensemble of initial conditions , determined by the experimental protocol for monitoring the switch .",
    "mathematically , the initial condition @xmath144 for switch state @xmath146 is selected according to some probability @xmath148 and we define @xmath149 as the flip time distribution for the ensemble of initial conditions given by @xmath148",
    ".    the most obvious protocol would be to measure the interval @xmath150 from the moment of switch flipping , so that the times @xmath143 correspond to switch flips and the @xmath150 are the durations of the on or off switch states .",
    "we call this the _ switch change ensemble _ ( @xmath151 ) . in this ensemble ,",
    "the probability @xmath152 of having @xmath16 molecules of @xmath2 at the time @xmath143 when the switch flips into the @xmath146 state is : @xmath153 where for notational simplicity , @xmath154 represents @xmath155 .",
    "the numerator of the r.h.s of eq.([eq : w1 ] ) gives the steady state probability that there are @xmath16 molecules present in state @xmath156 , multiplied by the flip rate into state @xmath49 .",
    "the denominator normalises @xmath157 .",
    "we also consider a second choice of initial condition , which we denote the _ steady state ensemble _",
    "( @xmath158 ) . here , the initial time @xmath143 is chosen at random for a cell that is in the @xmath146 state .",
    "this choice is motivated by practical considerations : experimentally , it is much easier to pick a cell which is in the @xmath146 state and to measure the time until it flips out of the @xmath146 state , than to measure the entire length of time a single cell spends in the @xmath146 state .",
    "the probability @xmath159 of having @xmath16 molecules of @xmath2 at time @xmath143 is then the ( normalised ) steady - state distribution for the @xmath146 state : @xmath160    to compute the distribution @xmath4 , we first consider the survival probability @xmath161 , that , given that at time @xmath162 ( chosen according to ensemble @xmath163 ) , the switch was in state @xmath146 , at time @xmath48 it is still in state @xmath146 and has @xmath16 molecules of enzyme @xmath2 . as the ensemble @xmath163 only enters through the initial condition , we may drop the superscript @xmath163 in what follows .",
    "the evolution equation for @xmath164 is the same as for @xmath47 , but without the terms denoting switch flipping into the @xmath49 state .",
    "this removes the coupling between @xmath56 and @xmath57 that was present in the evolution equations ( [ eq : masterp ] ) ) :    [ eq : survn ] @xmath165 @xmath166    introducing the generating function @xmath167 the above equations reduce to :    [ eq : surv ] @xmath168 @xmath169    we can relate @xmath170 to @xmath171 by noting that @xmath172 is the total probability that the switch has not flipped up to time @xmath48 . hence , @xmath173 equations ( [ eq : surv ] ) can be solved using the method of characteristics  @xcite .",
    "the result , detailed in appendix  [ app : char ] , is : @xmath174 where @xmath175 and @xmath176 .",
    "the function @xmath177 is the generating function for the distribution of enzyme numbers @xmath178 at the starting time for the measurement : @xmath179 where @xmath163 refers to @xmath180 or @xmath181 .",
    "the function @xmath182 can be obtained in an analogous way : this produces the same expression as for @xmath183 , but with @xmath8 set to zero and with all `` @xmath184 '' superscripts replaced by `` @xmath185 '' : @xmath186 so that @xmath187 .",
    "we can then obtain the distributions @xmath188 and @xmath189 by differentiating the above expressions , according to eq.([eq : link ] ) : @xmath190 { { \\widetilde w}}\\left ( k_1 \\tau_{\\textrm{on}}+ e^{-t/\\tau_{\\textrm{on } } } ( 1-k_1 \\tau_{\\textrm{on } } ) \\right)\\\\ + \\left(\\frac{1}{\\tau_{\\textrm{on } } } - k_1 \\right ) { { \\widetilde w } } ' \\left ( k_1 \\tau_{\\textrm{on}}+ e^{-t/\\tau_{\\textrm{on } } } ( 1-k_1 \\tau_{\\textrm{on } } ) \\right ) \\bigg\\}\\,\\,,\\end{gathered}\\ ] ] @xmath191    in the above expressions , the function @xmath192 is given for the steady state ensemble ( @xmath158 ) by @xmath193 and for the switch change ensemble ( @xmath151 ) by @xmath194      we now show that a useful and simple relation can be derived between @xmath195 and @xmath196 .",
    "let us imagine that we pick a random time @xmath48 , chosen uniformly from the total time that the system spends in state @xmath146 .",
    "the time @xmath48 will fall into an interval of duration @xmath150 , as illustrated in fig .",
    "[ fig : illustration ] .",
    "we can then split the interval @xmath150 into the time @xmath197 before @xmath48 and the time @xmath198 after @xmath48 , such that @xmath199 .",
    "schematic illustration of a possible time trajectory for the switch ; @xmath48 is a random time falling in an interval of total length @xmath150 and splitting it into two other intervals denoted @xmath197 and @xmath198 , as discussed in section [ sec : relation ] . ]",
    "we first note that the probability that our randomly chosen time @xmath48 falls into an interval of length @xmath150 is : @xmath200 eq.([eq : plength ] ) expresses the fact that the probability distribution for a randomly chosen flip time @xmath150 is @xmath201 , but the probability that our random time @xmath48 falls into a given segment is proportional to the length of that segment .",
    "since the time @xmath150 is chosen uniformly , the probability distribution for @xmath198 , for a given @xmath150 , will also be uniform ( but must be less than @xmath150 ) : @xmath202 one can now obtain @xmath203 from @xmath204 by integrating eq.([eq : cond ] ) over all possible values of @xmath150 , weighted by the relation ( [ eq : plength ] ) .",
    "this leads to the following relation between @xmath205 and @xmath206 : @xmath207 taking the derivative with respect to @xmath198 this can be recast as @xmath208 where @xmath209 is simply the mean duration of a period in the on state .",
    "we have verified numerically that the expressions ( [ eq : font ] ) and ( [ eq : fofft ] ) for @xmath210 and @xmath211 derived above do indeed obey the relation ( [ eq : linkbis2 ] ) .",
    "this relation can also be understood in terms of backward evolution equations as we discuss in appendix [ sec : bev ] .",
    "we now focus on the shape of the flip time distribution @xmath4 , in particular , whether it has a peak .",
    "a peak in @xmath212 could be biologically advantageous for two complementary reasons .",
    "firstly , after the switch enters the on state there may be some start - up period before the phenotypic characteristics of the on state are established , so it would be wasteful for flipping to occur before the on state of the switch has become effective .",
    "secondly , the on state of the switch may elicit a negative environmental response , such as activation of the host immune system , so that it might be advantageous to avoid spending too long a time in the on state .",
    "for example , in the case of the _ fim _ switch , a certain amount of time and energy is required to synthesise fimbriae , and this effort will be wasted if the switch flips back into the off state before fimbrial synthesis is complete .",
    "on the other hand , too large a population of fimbriated cells would trigger an immune response from the host , therefore the length of time each cell is in the fimbriated state needs to be tightly controlled .",
    "we note that for bistable genetic switches and many other rare event processes , waiting time distributions are exponential ( on a suitably coarse - grained timescale ) .",
    "this arises from the fact that the alternative stable states are time invariant in such systems .",
    "the presence of a peak in @xmath212 for our model switch would indicate fundamentally different behaviour , which occurs because the two switch states in our model are time - dependent .    the presence of a peak in the distribution @xmath4 requires the slope of @xmath4 at the origin to be positive . applying this condition to the function @xmath213 ( [ eq : font ] )",
    "we get : @xmath214 eq.([eq : ww ] ) allows us to expressing the derivatives of @xmath215 as functions of the moments of @xmath16 , so that we finally get our condition as a relation between the mean and the variance of the initial ensemble : @xmath216 where @xmath217 denotes an average taken using the weight @xmath218 of eq .",
    "( [ eq : w1 ] ) or ( [ eq : w2 ] ) .",
    "analogous conditions can be found for a peak in the off to on waiting time distribution .",
    "the moments involved in the above inequality can be computed using the exact results of the previous section .",
    "the l.h.s . of ( [ eq : inequality ] )",
    "can then be computed numerically for different values of the parameters , to determine whether or not a peak is present in @xmath4 .    for the sse ,",
    "there is never a peak in the flip time distribution .",
    "this follows directly from the relation ( [ eq : linkbis2 ] ) between the sse and sce , which shows that the slope of @xmath210 at the origin is always negative : @xmath219 thus a peak in the waiting time distribution can not occur when the initial condition is sampled in the steady state ensemble .    for the sce",
    ", we tested inequality ( [ eq : inequality ] ) numerically and found that a peak in the distribution @xmath4 is possible for the time spent in the on state ( @xmath220 ) , but not for the off to on waiting time distribution ( @xmath221 ) .",
    "this is as expected and can be explained by noting that to produce a peak in @xmath222 , the flipping rate must increase with time in state @xmath49 . in the on state the flipping rate typically does increase with time as the enzyme @xmath2 is produced , while in the off state the flipping rate decreases in time as @xmath2 decays .",
    "we now discuss the general conditions for the occurrence of a peak in @xmath220 .",
    "we first recall from section [ sec : pss ] that in the regime where the copy number of the enzyme @xmath2 relaxes much faster than the switch flips [ @xmath223 , the plateau level of @xmath2 is reached rapidly after entering the on state , so that the flipping rate out of the on state is essentially constant .",
    "this leads to effectively exponentially distributed flip times from the on state , so that no peak is expected .",
    "in the opposite regime , where switch flipping is much faster than @xmath2 number relaxation [ @xmath224 , we again expect poissonian statistics and therefore exponentially distributed flip times .",
    "thus it will be in the intermediate range of @xmath14 that a peak in the flip time distribution may occur .",
    "the exact condition for this ( [ eq : inequality ] ) is not particularly transparent as the dependence on the parameters is implicit in the values of the @xmath225 and @xmath226 . in particular , the effects of the parameters @xmath14 and @xmath8 are coupled , since the effective @xmath2-mediated switching rate depends on the copy number of @xmath2 .",
    "however we can make a broadbrush description of what is required .",
    "first the switch should enter the on state with typical values of @xmath227 so that there is an initial rise in the value of @xmath16 and therefore the flipping rate .",
    "second , we expect that the flipping should be predominantly effected by the enzyme @xmath2 rather than spontaneously flipping _",
    "@xmath14 should govern the flipping rather than @xmath15 .",
    "occurrence of a peak in the waiting time distribution sampled in the switch change ensemble .",
    "the shaded area delimits the region where there is a peak ( here the parameters are : @xmath228 , @xmath229 and @xmath230 and @xmath231 ) .",
    "the dashed line delimits the same region for @xmath232 .",
    "the insets show an instance of the distribution both in the sce ( solid red line ) and in the sse ( blue dashed line ) : ( a ) there is a peak ( @xmath229 , @xmath233 , @xmath234 ) ; ( b ) on the transition line , where the slope at the origin vanishes ( @xmath229,@xmath235 , @xmath236 ) ; ( c ) there is no peak ( @xmath229 , @xmath237 , @xmath238 ) . ]",
    "[ fig : diagram ] shows the region in the @xmath14@xmath15 plane where @xmath220 has a peak , for the case where @xmath239 and @xmath240 .",
    "these results are obtained numerically , using the inequality ( [ eq : inequality ] ) .",
    "the distribution @xmath220 is peaked for parameter values inside the shaded region .",
    "the insets show examples of the distributions @xmath241 and @xmath242 for various parameter values . at the boundary in parameter space between peaked and",
    "monotonic distributions ( solid line in fig .",
    "[ fig : diagram ] ) , @xmath241 has zero gradient at @xmath243 ( inset ( b ) ) . the dashed line in fig .",
    "[ fig : diagram ] ) shows the position of the boundary for a larger value of the enzyme production rate @xmath8 . as @xmath8 increases , the range of values of @xmath14 for which there is a peak decreases . increasing @xmath8 increases the number of enzyme present , which will increase both the off to on and on to off switching frequency , since here @xmath119 .",
    "thus it appears that approximately the same qualitative behaviour can be obtained for smaller values of @xmath14 when @xmath8 is increased .",
    "same plot as fig .",
    "[ fig : diagram ] but for @xmath121 .",
    "the shaded area delimits the values of @xmath15 and @xmath10 ( with @xmath229 ) for which there is a peak in the flip time distribution .",
    "the dashed line is the separation line for @xmath232 .",
    "the examples in the insets have as parameters @xmath229 and : ( a ) @xmath244 , @xmath245 ; ( b ) @xmath246 , @xmath247 ; ( c ) @xmath248 , @xmath249 . ]    in our previous paper @xcite , we analysed the case where @xmath121 : _ i.e. _ the flipping enzyme @xmath2 switches only in the on to off direction .",
    "this case applies to the _ fim _ system .",
    "[ fig : diagramk3off0 ] shows the analogous plot , as a function of @xmath10 and @xmath15 , when @xmath121 .",
    "the region of parameter space where a peak occurs in @xmath241 is much wider than for nonzero @xmath3 . in this case",
    "an increase of @xmath8 produces a _",
    "larger _ range of parameter values @xmath10 for which there is a peak ( dotted line in fig . [",
    "fig : diagramk3off0 ] ) . here , the off to on switching process is @xmath2-independent , and is mediated by @xmath15 only ( since @xmath121 ) .",
    "the typical initial amount of @xmath2 present on entering the on state is thus not much affected by @xmath8 , although the plateau level of @xmath2 increases with @xmath8 .",
    "therefore , as @xmath8 increases , the enzyme copy number in the on state becomes more time - dependent , increasing the likelihood of finding a peak .",
    "diagram showing the occurrence of a peak when the ratio @xmath30 is varied . here",
    "@xmath250 and @xmath229 .",
    "the inset shows a zoom of the plot in the vicinity of @xmath251 . ]",
    "the comparison between figs .",
    "[ fig : diagram ] and [ fig : diagramk3off0 ] suggests that the relative magnitudes of the @xmath2-mediated switching rates in the on to off and off to on directions , @xmath10 and @xmath3 , play a major role in determining the parameter range over which @xmath220 is peaked .",
    "this observation is confirmed in fig .",
    "[ fig : diagramk_vary_3off ] , where the boundary between peaked and unpeaked distributions is plotted in the @xmath10@xmath15 plane for various ratios @xmath30 .",
    "the larger the ratio @xmath31 , the smaller the region in parameter space where there is a peak .",
    "an intuitive explanation for this might be that as @xmath31 increases , the the typical initial number of @xmath2 molecules in the on state increases , so that less time is needed for the @xmath2 level to reach a steady state , resulting in a weaker time - dependence of the on to off flipping rate and less likelihood of a peak occurring in @xmath4 .",
    "if the presence of a peak in @xmath220 is indeed an important requirement for such a switch in a biological context , then we would expect that a low value of @xmath3 , as is in fact observed for the _ fim _ system , would be advantageous .",
    "a peaked distribution of waiting times is by no means the only potentially useful characteristic of this type of switch . in this section ,",
    "we investigate two other types of behaviour that may have important biological consequences : correlations between successive flips of a single switch , and correlated flips of multiple switches in the same cell .",
    "we analyse these novel phenomena using numerical methods .",
    "we introduce a new correlation measure which enables us to quantify the extent of the correlation as a function of the parameter space .",
    "our main findings are that a single switch shows time correlations which appear to decay exponentially , and that two switches in the same cell can show correlated or anti  correlated flipping behaviour depending on the values of @xmath3 and @xmath10 .",
    "biological cells often experience sequences of environmental changes : for example , as a bacterium passes through the human digestive system it will experience a series of changes in acidity and temperature .",
    "it is easy to imagine that evolution might select for gene regulatory networks with the potential to `` remember '' sequences of events .",
    "the simple model switch presented here can perform this task , in a very primitive way , because it produces correlated sequences of switch flips : the amount of @xmath2 enzyme present at the start of a particular period in state @xmath146 depends on the recent history of the system .",
    "in contrast , for bistable gene regulatory networks , or other bistable systems , successive flipping events are uncorrelated , as long as the system has enough time to relax to its steady state between flips .    in our recent work @xcite , we demonstrated that successive switch flips can be correlated for our model switch , and that this correlation depends on the parameter @xmath3 : correlation increases as @xmath3 increases . here",
    ", we extend our study and introduce a new measure of these correlations : the two time probability @xmath252 that the switch is in position @xmath49 at time @xmath48 and in position @xmath253 at time @xmath254 . in the steady state",
    "the two - time probability depends only on the time difference @xmath255 . in order to compare different simulations results ,",
    "we define the auto - correlation function : @xmath256 where @xmath257 , @xmath258 , and @xmath259 ( @xmath260 ) is the probability of being in the @xmath184 ( off ) state .",
    "the correlation function ( [ ctau ] ) takes values between @xmath261 and @xmath262 , in such a way that it is positive for positive correlations , negative for negative correlations and vanishes if the system is uncorrelated .",
    "this function allows us to understand whether , given that the switch is in a given position @xmath49 at time @xmath48 , it will be in the same state @xmath49 at a later time @xmath263 .    fig . [",
    "fig : corrone ] shows simulation results for different values of @xmath119 and @xmath120 .",
    "as expected , the correlation function vanishes in the limit of large @xmath264 , meaning that in this limit there are no correlations .",
    "furthermore , we can see that the strength of the correlations decreases when either @xmath14 or @xmath15 are increased .",
    "this is consistent with the previous remark that in the limit of large switching rate ( _ i.e. _ either @xmath14 or @xmath15 ) the distribution of enzyme numbers tends to a poisson distribution .",
    "it is thus not surprising that in this same limit the correlations vanish . in the insets of fig .",
    "[ fig : corrone ] we plot the same correlation function on a semi - logarithmic scale .",
    "the data for the highest values of @xmath14 or @xmath15 ( the dotted green curves ) is not shown since the decrease is too sharp , and does not allow for a clear interpretation .",
    "for the smallest values of @xmath14 and @xmath15 ( blue curves ) , the decay seems to be exponential .",
    "however , for intermediate values of @xmath14 or @xmath15 ( dashed red curves ) the evidence for an exponential decay is less clear and the issue deserves a more extensive numerical investigation . for the sake of completeness",
    "we also show in figure [ fig : corronek3off ] similar data for the case where @xmath121 .",
    "we find that qualitatively the data has a very similar behaviour to the case where @xmath265 .",
    "( colour online ) the two - time auto - correlation function @xmath266 for @xmath250 , @xmath232 .",
    "the insets shows the same data in a semi - log scale .",
    "top : @xmath15 is varied with constant @xmath267 .",
    "bottom : @xmath14 is varied with constant @xmath234 . ]",
    "( colour online ) the correlation function @xmath266 when @xmath121 .",
    "as previously , @xmath250 and @xmath232 .",
    "the data labelled as @xmath268 corresponds to @xmath269 while @xmath270 corresponds to @xmath271 . for",
    "each @xmath268 and @xmath270 the superscripts @xmath262 , @xmath272 and @xmath273 refer to different values of @xmath234 , @xmath262 and @xmath274 respectively .",
    "the inset shows the same plot on a semi - log scale . ]",
    "many bacterial genomes contain multiple phase - varying genetic switches , which may demonstrate correlated flipping .",
    "for example , in uropathogenic _",
    "e. coli _ , the _ fim _ and _ pap _ switches , which control the production of different types of fimbriae , have been shown to be coupled @xcite .",
    "although these two switches operate by different mechanisms , it is also likely that multiple copies of the same switch are often present in a single cell .",
    "this may be a consequence of dna replication before cell division ( in fast - growing _",
    "e. coli _ cells , division may proceed faster than dna replication , resulting in up to @xmath275 copies per cell ) . randomly occurring gene duplication events , which are believed to be an important evolutionary mechanism , might also result in multiple copies of a given switch on the chromosome .",
    "it is therefore important to understand how multiple copies of the same switch would be likely to affect each other s function  @xcite .",
    "let us suppose that there are two copies of our model switch in the same cell .",
    "each copy contributes to and is influenced by a common pool of molecules of enzyme @xmath2 .",
    "our model is still described by the set of reactions ( [ eq : react ] ) , but now the copy number of @xmath6 and @xmath7 can vary between 0 and 2 ( with the constraint that the total number of switches is 2 ) .    to measure correlations between the states of the two switches ( denoted @xmath276 and @xmath277 ) we define the _ two switch _ joint probability @xmath278 as the probability that switch 1 is in state @xmath276 at time @xmath48 and switch @xmath272 is in state @xmath277 at time @xmath254 .",
    "this function is the natural extension of the previously defined two - time probability for a single switch .",
    "thus , in analogy to ( [ ctau ] ) , we can define a two - time correlation function : @xmath279 where @xmath259 ( @xmath260 ) is again the steady  state probability for a single switch to be @xmath184 ( @xmath185 ) .",
    "if the two switches are completely uncorrelated , we expect that @xmath280 and @xmath281 , so that @xmath282 ( given that @xmath283 ) .",
    "in contrast , if the switches are completely correlated , @xmath284 , @xmath285 and @xmath286 . for completely anti - correlated switches , we expect that @xmath287 , and @xmath288 . in fig .",
    "[ fig : twoswitches ] we plot the function @xmath289 for two identical coupled switches , for several parameter sets .",
    "our results show that for small values of @xmath15 , there is correlation between the two switches , over a time period @xmath290 , which is of the same order as the typical time spent in the on state for these parameter values .",
    "our results also show that the nature of these correlations depends strongly on @xmath3 . in the case where @xmath265 ( top panel of fig .",
    "[ fig : twoswitches ] ) , one can see that the correlation is positive , meaning that the two switches are more likely to be in the same state .",
    "in contrast , when @xmath3 is set to zero ( bottom panel of fig . [",
    "fig : twoswitches ] ) , the correlation is negative , meaning that the two switches are more likely to be in different states .    to understand these correlations , consider the extreme situation where both the two switches are off , and the number molecules of @xmath2 has dropped to zero . in this case , the only possible event is a @xmath15 mediated switching which could take place , for instance , for the first switch .",
    "then , once the first switch is on , it will start producing more enzyme , and , if @xmath46 , this will enhance the probability for the second switch to flip on too .",
    "this might explain why , when @xmath265 we see a positive correlation between the two switches . on the other hand , if we consider the opposite situation where both the two switches are on , and the number of molecules of @xmath2 is around its plateau value , then the on to off switching probability for the two switches will be at its maximum .",
    "however , after one of the switches has flipped ( e.g. the first ) , the switching probability will start decreasing , this reducing the flipping rate for the second switch .",
    "this suggests that @xmath10 may have the effect of inducing negative correlations , while @xmath3 induces positive correlations .",
    "we also point out the presence of a small peak in @xmath289 in fig .",
    "[ fig : twoswitches ] ( indicated by the arrow ) which suggests the presence of a time delay : when one switch flips , the other tends to follow a short time later .",
    "we leave the detailed properties of these correlations and their parameter dependence to future work .",
    "( colour online ) normalised two - time correlation function @xmath289 for two identical switches .",
    "the parameter values are : @xmath250 , @xmath232,@xmath269 . in the top panel @xmath265 while in the bottom panel @xmath121 .",
    "the parameter @xmath15 is varied from @xmath291 to @xmath292 in each case . ]",
    "in this paper we have made a detailed study of a generic model of a binary genetic switch with linear feedback .",
    "the model system was defined in section ii by the system of chemical reactions ( [ eq : react ] ) .",
    "linear feedback arises in this switch because the flipping enzyme @xmath2 is produced only when the switch is in the on state , and the rate of flipping to the off state increases linearly with the amount of @xmath2 .",
    "thus , when the switch is in the on state the system dynamics inexorably leads to a flip to the off state .",
    "we have shown that this effect can produce a peaked flip time distribution and a bimodal probability distribution for the copy number of @xmath2 .",
    "a mean field description does not reproduce this phenomenology and so a stochastic analysis is required .",
    "we have studied this model analytically , obtaining exact solutions for the steady state distribution of the number of @xmath2 molecules , as well as for the flip time distributions in the two different measurement ensembles defined in section [ sec : firstpassage ] , the switch change ensemble and the steady state ensemble .",
    "we have shown how these ensembles are related and demonstrated that the flip time distribution in the switch change ensemble may exhibit a peak but the flip time distribution in the steady state ensemble can never do so .",
    "we also provide a generic relationship between the flip time distribution sampled in the two different ensembles . given that in single - cell experiments , measuring the flip time distribution in the sce is much more demanding than in the sse , our result provides a way to access the sce flip time distribution by making measurements only in the sse .",
    "our flip time calculations are reminiscent of persistence problems in non - equilibrium statistical physics where , for example , one is interested in the time an ising spin stays in one state before flipping .",
    "however , because of the linear feedback of our model switch , the flip time distribution is not expected to have a long tail as in usual persistence problems , rather it is the shape of the peak of the distribution which is of interest .    by studying numerically the time correlations of a single switch , using the two time autocorrelator ( [ ctau ] ) , we have shown that our model switch can play the role of a primitive `` memory module '' .",
    "the two time autocorrelator displays nontrivial behaviour including rather slow decay , which would be worthy of further study . we have also investigated the behaviour of two coupled switches within the same cell , and showed that both positive and negative correlations could be produced by choosing the parameters appropriately . in particular for @xmath121 , as is the case for the _ fim _ switch , anti - correlations were observed , implying that if one switch were on at time @xmath48 , the other would tend to be off at that time and for a subsequent time of about one switch period .",
    "many open questions and problems remain . at a technical level one would like to compute correlations of a single switch analytically and be able to treat the multiple switch system .",
    "the model itself could be refined in several ways , for example , by introducing nonlinear feedback@xcite .",
    "it has been shown that such feedback allows nontrivial behaviour even at the level of a piecewise deterministic markov process approximation @xcite , where one assumes a deterministic evolution for the enzyme concentration , but a stochastic description for the switching . at present",
    "our model includes no explicit coupling to the environment , but such coupling could be included in a simple way by adding into the model environmental control of parameters @xmath14 or @xmath15 . to make a closer connection to real biological switches , such as _ fim",
    "_ , one could extend the model to include , for example , multiple and cooperative binding of the enzymes @xcite .",
    "one particularly exciting direction , which we plan to pursue in future work , is to develop models for growing populations of switching cells , in which cell growth is coupled to the switch state .",
    "such models could lead to a better understanding of the role of phase variation in allowing cells to survive and proliferate in fluctuating environments .",
    "+    the authors are grateful to aileen adiciptaningrum , david gally and sander tans for useful discussions .",
    "r. j. a. was funded by the royal society of edinburgh .",
    "this work was supported by epsrc under grant ep / e030173 .",
    "we show here how to solve eq.([eq : survon ] ) using the method of characteristics ( see e.g. @xcite ) . introducing the new variable @xmath293 , we set @xmath294\\frac{{\\partial}}{{\\partial}z } { { \\tilde h}_{\\textrm{on}}}(z , t ) \\,\\,.\\end{gathered}\\ ] ] we can then identify the derivatives of @xmath48 and @xmath85 with respect to @xmath31 as : @xmath295 next , we solve these equations for @xmath296 and @xmath297 using initial conditions @xmath298 and @xmath299 : @xmath300 where @xmath301 . the reduced ordinary differential equation ( ode ) for @xmath183 is : @xmath302 { { \\tilde h}_{\\textrm{on}}}(r)\\,\\,,\\ ] ] substituting in the above relation @xmath297 with its expression given in ( [ eq : charsol ] ) , we get an ordinary differential equation for @xmath303 , which can be solved by separation of variables : @xmath304 solving the above equation using the initial condition @xmath305 , we arrive at @xmath306 { { \\widetilde w}}(z_0)\\,\\,,\\end{gathered}\\ ] ] where @xmath307 . substituting then from ( [ eq : charsol ] ) @xmath308 and @xmath309 one finally recovers ( [ eq : hton ] ) .",
    "in this appendix we show how the result ( [ eq : linkbis ] ) can be obtained by considering the _ backward survival probability _ : @xmath310 which is the probability that the system has survived in the state @xmath49 without flipping and with @xmath16 enzymes at time 0 knowing that it had @xmath144 enzyme molecules at a past time @xmath311 .",
    "the probability @xmath312 will verify the backward master equation @xmath313    in section [ sec : firstpassage ] we used the forward master equation to compute the flip time distribution in two steps .",
    "first , we computed the forward survival probability @xmath314 with two possible initial conditions , to distinguish the two possible scenarios of measurement .",
    "second , we summed this survival probability over all possible final configurations , and took the time derivative in order to enforce a flipping at the end of the sampling .    an analogous calculation ( which we do not detail ) can be carried out considering the backward master equation ( [ eq : backwardme ] ) , and the final result has to be the same .",
    "in fact , we can consider the r.h.s .",
    "of ( [ eq : backwardme ] ) as a generator of the backward dynamics .",
    "thus the solution of the backward evolution equation will have as boundary condition the statistics of the final configuration at time 0 , and will yield the statistics of the possible corresponding initial configurations at @xmath311 ( with the additional constraint that the switch never flipped ) .",
    "since for both sce and sse we condition that on switch flips at @xmath162 , the boundary condition of ( [ eq : backwardme ] ) has to be taken when the switch is flipping from state @xmath49 to state @xmath156 , and thus corresponds to : @xmath315 where @xmath152 is defined in ( [ eq : w1 ] ) .",
    "this is the analogue of the first step described above .",
    "the advantage is that now our boundary condition is the same for both the sce and the sse",
    ".    we can relate @xmath316 to @xmath317 by noting that @xmath318 is the probability that the switch has not flipped going backward for a time @xmath48 .",
    "we now have to made a distinction between the sce and the sse , since what happens at time @xmath311 is precisely the initial ensemble . for the case of the sce ,",
    "we want the switch to flip at time @xmath311 , therefore the flip time distribution is given by : @xmath319 on the other hand , for the case of the sse , there is no flipping at @xmath311 to enforce and the flip time distribution @xmath320 is simply proportional to the survival probability : @xmath321 the denominator in ( [ eq : ssebis ] ) is chosen to ensure normalisation @xmath322 .",
    "furthermore , we can compute the average flip time in the sce using ( [ eq : scebis ] ) : @xmath323 where an integration by parts has been performed .",
    "we can see then that the denominator in eq.([eq : ssebis ] ) is exactly the average flip time . finally ,",
    "integrating eq.([eq : scebis ] ) from @xmath150 to infinity and replacing the result in ( [ eq : furthermore ] ) , we obtain @xmath324 and the result ( [ eq : linkbis ] ) is recovered ."
  ],
  "abstract_text": [
    "<S> we study the statistical properties of a simple genetic regulatory network that provides heterogeneity within a population of cells . </S>",
    "<S> this network consists of a binary genetic switch in which stochastic flipping between the two switch states is mediated by a `` flipping '' enzyme . </S>",
    "<S> feedback between the switch state and the flipping rate is provided by a linear feedback mechanism : the flipping enzyme is only produced in the on switch state and the switching rate depends linearly on the copy number of the enzyme . </S>",
    "<S> this work generalises the model of [ _ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> _ , * 101 * , 118104 ] to a broader class of linear feedback systems . </S>",
    "<S> we present a complete analytical solution for the steady - state statistics of the number of enzyme molecules in the on and off states , for the general case where the enzyme can mediate flipping in either direction . </S>",
    "<S> for this general case we also solve for the flip time distribution , making a connection to first passage and persistence problems in statistical physics . </S>",
    "<S> we show that the statistics of the model are non - poissonian , leading to a peak in the flip time distribution . </S>",
    "<S> the occurrence of such a peak is analysed as a function of the parameter space . </S>",
    "<S> we present a new relation between the flip time distributions measured for two relevant choices of initial condition . </S>",
    "<S> we also introduce a new correlation measure to show that this model can exhibit long - lived temporal correlations , thus providing a primitive form of cellular memory . </S>",
    "<S> motivated by dna replication as well as by evolutionary mechanisms involving gene duplication , we study the case of two switches in the same cell . </S>",
    "<S> this results in correlations between the two switches ; these can either positive or negative depending on the parameter regime . </S>"
  ]
}