{
  "article_text": [
    "the study of statistical and dynamical properties of cities from a complex - systems perspective is increasingly popular  @xcite .",
    "a celebrated result is the scaling between a city specific observation @xmath0 ( e.g. , the number of patents filed in the city ) and the population @xmath1 of the city as  @xcite @xmath7 with a non - trivial ( @xmath4 ) exponent .",
    "super - linear scaling ( @xmath8 ) was observed when @xmath0 quantifies creative or economical outputs and indicates that the concentration of people in large cities leads to an increase in the per - capita production ( @xmath9 ) .",
    "sub - linear scaling ( @xmath10 ) was observed when @xmath0 quantifies resource use and suggests that large cities are more efficient in the per - capita ( @xmath9 ) consumption . since its proposal ,",
    "non - linear scaling has been reported in an impressive variety of different aspects of cities   @xcite .",
    "it has also inspired the proposal of different generative processes to explain its ubiquitous occurrence  @xcite .",
    "scalings similar to the one in eq .",
    "( [ eq.scaling ] ) appear in physical ( e.g. , phase transitions ) and biological ( e.g. , allometric scaling ) systems suggesting that cities share similarities with these and other complex systems ( e.g. , fractals ) .",
    "more recent results cast doubts on the significance of the @xmath4 observations @xcite .",
    "@xcite agrees that economic outputs are faster than linear in @xmath1 , but claims that the population @xmath1 has a limited explanatory factor on the per - capita rate @xmath9 of cities and function  ( [ eq.scaling ] ) is not better than alternative ones ( see refs .",
    "@xcite for opposing arguments ) . ref .",
    "@xcite focus on the case of co2 emissions and show that depending on whether city boundaries or metropolitan areas are used , the value of @xmath3 changes from @xmath8 to @xmath10 .",
    "this point was carefully analyzed in ref .",
    "@xcite for different datasets @xmath0 . through a careful study of different possible choices of city boundaries ,",
    "the authors report that the evidence for @xmath4 virtually vanishes .",
    "these results ask for a more careful statistical analysis that rigorously quantifies the evidence for @xmath4 in different datasets .    in this paper",
    "we propose a statistical framework based on a probabilistic formulation of the scaling law  ( [ eq.scaling ] ) that allow us to perform hypothesis testing and model comparison .",
    "in particular , we quantify the evidence in favor of @xmath11 comparing ( through the bayesian information criterion ) models with @xmath12 to models with @xmath13 .",
    "we apply this approach to @xmath6 datasets of cities from @xmath5 regions and find that the conclusions regarding @xmath3 vary dramatically not only depending on the datasets but also on assumptions of the models that go beyond  ( [ eq.scaling ] ) .",
    "we argue that the estimation of @xmath3 is challenging and depend sensitively on the model because of the following two statistical properties of cities :    * the distribution of city - population has heavy tails ( zipf s law )  @xcite .",
    "* there are large and heterogeneous fluctuations of @xmath0 as a function of @xmath1 ( heteroscedasticity ) .    points ( i ) and ( ii ) are shown , respectively , in panels ( a ) and ( b ) of fig .",
    "[ fig_sim ] .",
    "the paper is divided as follows .",
    "we start by describing the problem and the datasets we use ( in sec .",
    "[ sec.data ] ) and discussing ( in sec .  [ sec.mls ] ) the limitations of the usual statistical approach based on least - squared fitting in log scale .",
    "we then propose a probabilistic formulation together with different statistical models ( in sec .",
    "[ sec.models ] ) and describe ( in sec .",
    "( [ sec.results ] ) ) how they can be compared to each other and to data .",
    "finally , we discuss our main findings ( in sec .",
    "[ sec.discussion ] ) and summarize our conclusions ( in sec .  [ sec.conclusion ] ) .",
    "the general problem we are interested in is to test and estimate the parameters of eq .",
    "( [ eq.scaling ] ) based on observations @xmath14 for @xmath15 cities , where @xmath16 is the population and @xmath17 is the amount of the quantity of interest in city @xmath18 ( as in fig .",
    "[ fig_sim]b ) .",
    "the quantities @xmath19 are estimated within a measurement precision which in principle could also be included in the analysis . however , in most cases this information is not available and only single measurements of @xmath19 exist .",
    "the datasets we choose include a variety of different regions , aggregation methods do define city boundaries , and quantities @xmath0 .",
    "it includes data from @xmath5 different countries and regions : 100 metropolitan areas of the united kingdom ( uk ) , aggregated as in ref .",
    "@xcite ; 381 metropolitan areas of the united states of america ( usa ) , as discussed in ref .",
    "@xcite ; 459 urban areas of the usa ; 472 large cities of the european union ( eu ) ; 275 large cities from the members of the organisation for economic co - operation and development ( oecd ) ; and 5565 municipalities ( administrative units ) from brazil . for each database , we use indexes of economical activity ( weekly income , gdp ) , innovation ( patents filed ) , transportation ( miles traveled , number of train stations ) , access to culture ( number of theaters , number of cinema seats , number of cinema attendances in one year , etc . ) , and health condition ( aids infections , death by external causes ) .",
    "further details are presented in the appendix  [ sec.data ] .",
    "the following three steps summarize the usual approach used to test a non - linear scaling in eq .  [ eq.scaling ]",
    "( see e.g. refs .",
    "@xcite for scalings in cities and e.g. ref .",
    "@xcite for scalings in biology ) :    * the parameters of eq .  ( [ eq.scaling ] ) are chosen based on least - squared fitting in log - transformed data @xmath20 , i.e. , @xmath21 are such that @xmath22 is minimized . * the quality of the fitting is quantified by the coefficient of determination @xmath23 .",
    "@xmath24 close to @xmath25 is taken as evidence of the agreement between the fit and the data . *",
    "the 95% confidence interval @xmath26 $ ] around @xmath3 is computed from the sum of the residuals squared and @xmath27 $ ] is taken as an evidence that @xmath4 .",
    "this usual approach is appealing due to its simplicity and ease of numerical implementation .",
    "however , it contains the following assumptions and limitations that are usually ignored :    * the parameters obtained through least - squared fitting are maximum likelihood estimators if i ) the data points are independent and ii ) the fluctuations around the mean @xmath28 , @xmath29 , are gaussian distributed in @xmath28 with a variance independent of @xmath30 .",
    "the value of @xmath3 obtained in the usual approach is meaningful if these assumptions hold .",
    "* @xmath24 does not quantify the statistical significance of the model , it quantifies the correlation between data and model ( the amount of the variation in the data explained by the model ) .",
    "in particular , @xmath24 close to one is not an evidence that the data is a likely outcome of the model .",
    "below we obtain that datasets are typically not consistent with the model underlying the usual approach . *",
    "the confidence interval @xmath26 $ ] is a range in which the true value of @xmath3 is expected to be found only if the model holds  @xcite .",
    "therefore , in the typical case in which the data is not compatible with the model , one can not conclude that @xmath4 based on the observation that @xmath31 $ ] .",
    "usually , in this case both @xmath13 and @xmath4 are incompatible with the data . * a further limitation of the usual approach is that it requires removing the datapoints with @xmath32 ( because it requires computing @xmath33 ) .",
    "this filtering is arbitrary because @xmath34 is usually a valid observation ( e.g. , cities without any patents filed ) .    in the study of scaling laws in biology , the underlying hypothesis and alternatives to the usual least - squared fitting",
    "have been extensively discussed  @xcite . in city data , statistical analysis beyond the usual approach were performed in refs .",
    "it typically amounts to an analysis of the residuals @xmath35 , e.g. , a ( visual ) comparison of the residuals of the fit to the gaussian distribution predicted by the model underlying the linear fit in log - log scale .",
    "the controversies regarding a non - linear scaling @xmath4 motivate us to search an alternative statistical framework to test the scaling  ( [ eq.scaling ] ) beyond the usual approach with residual analysis .",
    "the statistical analysis we propose is based on the likelihood @xmath36 of the data being generated by different models . following ref .",
    "@xcite , we assume that the index @xmath0 ( e.g. number of patents ) of a city of size @xmath1 is a random variable with probability density @xmath37 .",
    "we interpret eq .",
    "( [ eq.scaling ] ) as the scaling of the expectation of @xmath0 with @xmath1 @xmath38 where @xmath39 is computed over the ensemble of cities with fixed @xmath1 .",
    "this relation does not specify the shape of @xmath37 , e.g. , it does not specify how the fluctuations @xmath40 of @xmath0 around @xmath41 scale with @xmath1 . here",
    "we are interested in models @xmath37 satisfying @xmath42 this choice corresponds to taylor s law  @xcite .",
    "it is motivated by its ubiquitous appearance in complex systems  @xcite , where typically @xmath43 $ ] , and by previous analysis of city data which reported non - trivial fluctuations  @xcite .",
    "the fluctuations in our models aim to effectively describe the combination of different effects , such as the variability in human activity and imprecisions on data gathering . in principle , these effects can be explicitly included in our framework by considering distinct models for each of them .    below",
    "we specify different models @xmath37 compatible with eqs .",
    "( [ eq.scaling2],[eq.scaling3 ] ) .",
    "we consider two classes of models . in the first class , which we call city - models",
    ", we _ a priori _ choose a parametric form for @xmath37 and we use eqs .",
    "( [ eq.scaling2],[eq.scaling3 ] ) to fix the free parameters . in the second class , which we call person - models , we derive @xmath37 from a generative process for the assignment of @xmath0 to people that is compatible with eqs .",
    "( [ eq.scaling2],[eq.scaling3 ] ) . in both cases ,",
    "the likelihood @xmath36 of the model is written as a function of the data @xmath44 and at most four free parameters ( @xmath45 , and @xmath46 ) .      in this class of models",
    "we assume that each data point @xmath17 is an independent realization from the conditional distribution @xmath47 and therefore the log - likelihood can be written as @xmath48 in order to explore how the choice of @xmath49 affects the outcome of the statistical analysis , we consider two different continuous distributions ( gaussian and log - normal ) .      here",
    "we consider that @xmath37 is given by a gaussian distribution with parameters @xmath50 and @xmath51 : @xmath52 the relations  ( [ eq.scaling2],[eq.scaling3 ] ) are fulfilled choosing the parameters as @xmath53 the log - likelihood  ( [ eq.l ] ) is given by @xmath54 this model has @xmath55 and therefore observations with @xmath56 can be accounted for .",
    "for the observables considered here , @xmath34 is a valid observation but @xmath57 is not .",
    "we consider two cases :    [ [ fixed - delta-1 . ] ] fixed @xmath58 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    this is the typical fluctuation scaling found when @xmath17 is the result of a sum of random variables .",
    "@xcite    [ [ free - delta - in-12 . ] ] free @xmath43 $ ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the general functional form that fulfills eq.([eq.scaling3 ] ) .",
    "we exclude @xmath59 because in this case the probability @xmath60 of negative values ( not feasible for most observables y ) remains large for large @xmath1 .      here",
    "we consider that @xmath37 is given by a log - normal distribution with parameters @xmath61 and @xmath62 :    @xmath63    the relations  ( [ eq.scaling2],[eq.scaling3 ] ) are fulfilled choosing the parameters as ( see app .",
    "[ sec.taylor.logn ] ) : @xmath64 . \\end{alignedat}\\ ] ] the log - likelihood  ( [ eq.l ] ) is given by @xmath65 this model has @xmath66 and therefore observations with @xmath56 can not be accounted for .",
    "we again consider two cases :    [ [ fixed - delta-2 . ] ] fixed @xmath67 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    this scaling is obtained when @xmath17 is the product of independent random variables . furthermore , @xmath68 and the fluctuations of @xmath28 are independent of @xmath1 and therefore the maximum likelihood estimation of  @xmath3 coincides with the estimation obtained with minimum least squares for @xmath28 , as discussed in sec .",
    "[ sec.mls ] .",
    "[ [ free - delta - in-13 . ] ] free @xmath69 $ ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the general functional form that fulfills eq .",
    "( [ eq.scaling3 ] ) .      the starting point for this class of models is the natural interpretation of eq .",
    "( [ eq.scaling ] ) that people s efficiency ( or consumption ) scale with the size of the city they are living in .",
    "this motivates us to consider a generative process in which tokens ( e.g. a patent , a dollar of gdp , a mile of road ) are produced or consumed by ( assigned to ) individual persons , in the same spirit as in refs .",
    "specifically , consider @xmath70 persons living in @xmath71 cities , on which the population of the city @xmath18 is given by @xmath16 such that @xmath72 .",
    "consider also that there is a total of @xmath73 tokens that are randomly assigned to the @xmath74 persons .",
    "a super - linear ( sub - linear ) scaling suggests that a token is more likely to be assigned to someone living in a more ( less ) populous city . in this spirit , we assume that the probability that a token is assigned to person @xmath75 depends only on the population @xmath76 of the city where person @xmath75 lives as @xmath77 where @xmath78 is the normalization constant , i.e. @xmath79 . for @xmath80 , @xmath81 and each person is equally likely to be assigned a token ( independently of the population of its city ) .",
    "the above equation is a microscopic model , and we are now interested in the macroscopic behavior of the city : the probability that a city @xmath18 gets @xmath17 tokens , given that its population is @xmath16 . assuming that besides their city , individuals are indistinguishable , the probability @xmath82 that a token is assigned to a city @xmath18 is given by a sum of @xmath83 over persons @xmath75 on city @xmath18 , which contains exactly @xmath16 terms . since @xmath84 when the person @xmath75 lives in city @xmath18 , represented by @xmath85 , we obtain @xmath86 the probability of observing @xmath17 tokens in each city of size @xmath16 is a multinomial distribution @xmath87 thus , the likelihood can be written as a function of the observed quantities @xmath14 as @xmath88 the scaling of the average and variance of @xmath0 , i.e. eqs .",
    "( [ eq.scaling2],[eq.scaling3 ] ) , are recovered as @xmath89 \\approx y p(i ) = { \\mathbb{e}}(y_i|x_i ) \\ \\ . \\end{alignedat}\\ ] ] in which we identify that @xmath90 , @xmath91 , and @xmath58 . for @xmath92 ,",
    "this model coincides with the city - model with normal fluctuations and the latter choice of parameters .",
    "notice that the fluctuations of this model account only to fluctuations of the assignment , and neglects potential fluctuations of measurement imprecisions .",
    "in this section , we compare the models presented above against our 15 datasets . in particular , we address the following questions whose answers are summarized in tab .  [ fig_table ] :          [ [ what - is - the - estimated - value - of - beta ] ] _ 1 .",
    "what is the estimated value of @xmath3 ? _ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for each model we calculate the parameters ( @xmath93 ) that maximize @xmath36 ( see app .  [ sec.ml ] for details ) . in tab .",
    "[ fig_table ] we report @xmath3 .",
    "[ [ what - is - the - error - bar - b - around - the - estimated - beta ] ] _ 2 .",
    "what is the error bar @xmath94 around the estimated @xmath3 ? _ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we estimate @xmath94 using bootstrapping with replacement ( see app .  [ sec.error ] for details ) . in tab .",
    "[ fig_table ] @xmath94 is shown in parenthesis .",
    "the interval @xmath95 $ ] can be interpreted as the @xmath96 confidence interval of @xmath3 when the model is not rejected .",
    "otherwise , it can be interpreted as the robustness of the estimated @xmath3 against fluctuations in the data ( cross validation ) .",
    "[ [ is - the - data - compatible - with - the - model ] ] _ 3 . is the data compatible with the model ? _",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we test the hypothesis that the data was generated by the model .",
    "specifically , for each model we compute a p - value that quantifies i ) whether the fluctuations in the data are compatible with the expected fluctuations from the model ; and ii ) whether the residuals are uncorrelated ( see app .",
    "[ sec.pvalue ] for details ) . in case",
    "the model is not rejected , i.e. @xmath97-value @xmath98 , the corresponding entry in tab .  [ fig_table ] is marked by the symbol @xmath99 .",
    "[ [ what - is - the - statistical - evidence - for - beta - neq-1 ] ] _ 4_. what is the statistical evidence for @xmath4 ? + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we quantify the evidence for @xmath4 by comparing the maximum likelihood @xmath36 of each model with the corresponding model where we fix @xmath13 .",
    "we account for the different number of free parameters ( e.g. to avoid overfitting ) by using the bayesian information criterion ( bic ) , @xmath100 , where @xmath101 is the number of free parameters and @xmath102 the number of observations ( see app .  [ sec.modelselection ] for details ) .",
    "the difference in the @xmath103 , @xmath104 , indicates whether the model with @xmath4 provides a sufficiently better description of the data . from this",
    "we infer that , for i ) @xmath105 the model with fixed @xmath106 ( linear scaling ) is better ; ii ) @xmath107 the evidence for @xmath4 is inconclusive ; and iii ) @xmath108 the model with @xmath4 ( non - linear scaling ) is better . in tab .",
    "[ fig_table ] these results are indicated by the symbols i ) @xmath109 ( linear ) , ii ) @xmath110 ( inconclusive ) ; or iii ) @xmath111 ( sub - linear ) or @xmath112(super - linear ) .",
    "[ [ what - is - the - statistical - evidence - for - fluctuation - scaling - taylors - law ] ] _ 5_. what is the statistical evidence for fluctuation scaling ( taylor s law ) ? + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we quantify the evidence for @xmath113 ( @xmath114 ) , i.e. nontrivial scaling in the fluctuations in eq .",
    "( [ eq.scaling3 ] ) , in the models of cities with gaussian ( log - normal ) noise . within each class",
    ", we calculate @xmath115 , where we compare the @xmath103 s of the model where i ) @xmath46 is fixed ( @xmath116 ) and ii ) where @xmath46 is a free parameter ( @xmath117 ) . in case of @xmath118 , the model with @xmath46 as a free parameter ( non - trivial fluctuation scaling ) provides a better description of the data ( see app .",
    "[ sec.modelselection ] for details ) . in tab .",
    "[ fig_table ] the entry for the selected model is highlighted with a gray background .",
    "[ [ which - model - best - describes - the - data ] ] _ 6_. which model best describes the data ?",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we calculate the @xmath103 of each of the 5 models ( see app .  [ sec.modelselection ] for details ) and select the one with the lowest bic as the one that best describes the data . in tab .",
    "[ fig_table ] the @xmath3 of the selected model is printed in bold face .",
    "in this section we interpret the outcome of the statistical analysis summarized in tab .",
    "[ fig_table ] .",
    "we focus on specific findings and their significance to the problem of scaling in cities .      in almost all cases ,",
    "the data is not a typical outcome of any of the @xmath5 proposed models leading to a rejection of the models ( p - value@xmath1190.05 ) .",
    "the only exceptions ( marked by an @xmath99 in the table ) are the two log - normal models in uk - income and uk - train stations , and the gaussian model with free @xmath46 for oecd - gdp .",
    "there are several possible reasons for the widespread rejection of the models : fluctuations of the data may differ from the fluctuations @xmath49 of the models ( e.g. measurement errors are not correctly accounted for by @xmath49 ) ; the observations are not independent ( e.g. , there are correlations between residuals and city size ) ; different scalings are observed for small and large cities ( as discussed in ref .",
    "@xcite and fig .",
    "[ fig_city_person ] below ) .",
    "the rejections of the models considered here are a consequence of their strong simplifying hypothesis and show that the development of better models is needed in order to understand the observations and clarify the existence of the non - linear scaling  ( [ eq.scaling ] ) .",
    "it shows also that the estimated confidence interval can not be used ( in the rejected models ) to discard a linear scaling @xmath13  @xcite .",
    "still , the widespread rejection of models does not imply that the non - linear scaling  ( [ eq.scaling ] ) is rejected altogether because it is possible that the data is well described by another ( unknown ) model consistent with eq .",
    "( [ eq.scaling2 ] ) but different from the ones considered here , e.g. , having different fluctuations in @xmath49 ) .",
    "these alternative models can have different fluctuation relations or can account for the known ( e.g. , spatial  @xcite ) correlations in the data . in particular , the generative process underlying the person model could be generalized to account for other effects beyond city - size population ( e.g. , individuals could be segmented by income ) .",
    "even if most models are rejected , some models can still describe the data better than others ( in terms of bic ) .",
    "the conclusions drawn from such _ model comparison _",
    "analysis depends on the used set of models and may change by the introduction of a better model in the future .",
    "our investigations of scaling laws in cities in the next sections is mostly based on model comparison : we analyze which model and parameters best describe the data , with particular interest in the parameter @xmath3 .",
    "there is no single model that best describes all databases ( the bold face value in the table appears on different rows ) .",
    "a systematic observation on the @xmath6 datasets is that the person model and the gaussian model with fixed @xmath46 are never the best ones .",
    "this indicates that the fluctuations in the ( large ) cities are much larger than predicted by the scaling @xmath120 used in both models . for the other models ,",
    "there are databases in which they are the best models : the log - normal with fixed @xmath121 is the best model in the three uk cases and for usa gdp ; the log - normal model with free @xmath46 is the best model for usa - roads and eu cinema capacity ; and the gaussian model with free @xmath46 is the best for eu - cinema usage , oecd - gdp , and eu - libraries .",
    "the inclusion of the additional parameter @xmath46 in the log - normal model , related to taylor s law in eq .",
    "( [ eq.scaling3 ] ) , is considered beneficial in 8 out of the fifteen approach ( shaded gray regions in the two first rows of the table ) .",
    "altogether , these results show that the model underlying the usual approach ( log - normal with fixed @xmath46 ) is often not the best model",
    ".      models consistent with the average scaling  ( [ eq.scaling2 ] ) , but that have different assumptions regarding the fluctuations , can lead to different estimations of @xmath3 . consider the case of eu - cinema attendance .",
    "the value estimated from the log - normal model with fixed @xmath46 is @xmath122 .",
    "it coincides with the usual approach ( least square fitting ) and suggests a super - linear relation between the number of cinema visitors and the population of cities .",
    "however , if we allow for a different fluctuation scaling as in the log - normal model with free @xmath46 , a model that is preferred according to our bic test , we obtain that @xmath123 , i.e. , a linear scaling .",
    "conflicting conclusions are observed also in the eu - theaters database . the data and fittings for these two cases are shown in fig .",
    "[ fig_fluct ] .",
    "visual inspection of the graph can be misleading because of the log - scale and the different density of points , and shows the need for more careful ( quantitative ) statistical analysis .",
    "altogether , the variation of @xmath3 across different models shows that conclusions regarding @xmath3 ( e.g. , @xmath12 ) can not be done independently from the analysis of the fluctuations . considering also that different models are preferred for different databases ( previous point ) , this confirms the practical importance of going beyond the usual approach ( least square fitting ) both in terms of methods and models , as proposed in this paper .    , and the person model ( solid lines ) for the data of brazil - aids ( dots ) .",
    "while the city model captures a sub - linear scaling present in small cities @xmath124 , the person model describes the roughly linear scaling @xmath125 of large cities .",
    "shaded areas represent one standard deviation .",
    "the running mean ( red line ) is the average ( @xmath126 , @xmath127 ) over @xmath128 datapoints , @xmath129 , in a sliding window over the data ordered in @xmath1 .",
    "( b ) cumulative distribution of heavy - tailed distribution of city - sizes in terms of cities and persons , i.e. the fraction of i ) cities of size @xmath130 ( city model ) ; and ii ) the population in cities of size @xmath130 . ]",
    "the variation on the estimation of @xmath3 across the different models can be better understood by analyzing how the city size distribution shown in fig .",
    "[ fig_sim](a ) influences the estimation of @xmath3 .",
    "the least - square fitting minimizes the distance between the curve and the points in logarithmic scales ( @xmath28 ) . therefore ,",
    "when data is viewed in the usual double logarithmic plot , the best curve will be the one that passes close to most points , i.e. , it weights a village as much as a million - size city .",
    "the fit will be thus dominated by the large number of small cities .",
    "the disadvantage of this is that , even if the model describes well most cities , it may fail to describe the behavior of most of the population .",
    "our person s model addresses this issue by giving the same weight to each person , leading to the problem of describing most people but potentially not most cities . to see this , consider the example of the 5,565 brazilian cities .",
    "half of the brazilian population lives in the @xmath131 largest cities ( @xmath132 of cities ) ; yet , 50% smallest cities account for only @xmath133 of the total population .",
    "this is a direct consequence of the heavy - tailed distribution of city sizes , which holds in all our databases ( see fig .",
    "[ fig_sim]a ) .",
    "our city models with free @xmath46 in eq .",
    "( [ eq.scaling3 ] ) allows cases beyond the least - squared fitting ( @xmath121 ) and person s model ( @xmath120 ) .",
    "the exponent @xmath46 controls how the variance of @xmath49 grows with @xmath1 .",
    "a small variance for large @xmath1 , obtained for small @xmath46 , will force the fitted curve ( average ) to pass close to the points of large cities .",
    "the weight of the large cities is inversely proportional to @xmath46 .",
    "the general considerations above explain a great extent of the variation of @xmath3 across the models observed in tab .",
    "[ fig_table ] .",
    "the values obtained for the gaussian model with @xmath120 and the person s model are dominated by large cities , in the log - normal @xmath121 case they are dominated by small cities , while for the free @xmath46 models it depend on which best @xmath46 is obtained . in the brazil aids data - set @xmath134 and @xmath3 is dominated by the small cities ( @xmath121 in the gaussian model , and @xmath135 in the log - normal model ) .",
    "accordingly , the value of @xmath3 for these two models in the second to last row of tab .",
    "[ fig_table ] are @xmath136 in agreement with the log - normal with @xmath121 case and in contrast with the gaussian @xmath120 and person model which have @xmath8 and are dominated by the large cities .",
    "figure  [ fig_city_person ] shows the results for this dataset and emphasizes how different models describe different city sizes .",
    "the same reasoning explains also the values of @xmath3 of other databases reported in tab .",
    "[ fig_table ] ( e.g. , all uk cases ) .    in summary ,",
    "the `` weights '' each statistical model attributes to cities have an impact on the estimated value of @xmath3 and , in particular , on the visual agreement between the data and the fit in the usual double - logarithmic plots .",
    "when the scaling relation  ( [ eq.scaling2 ] ) holds for all @xmath1 , the difference between the models will not be significant .",
    "however , as we showed in point ( a ) of this section , data is typically not compatible with models . in the cases in which @xmath3 varies substantially across models ,",
    "generalization beyond the simple scaling  ( [ eq.scaling ] )  @xcite should be considered in order to account for the @xmath1 dependence of @xmath3 . in this case",
    ", the heavy - tailed distribution of city sizes leads many models to be dominated either by the large amount of small cities or by the few cities containing most of the population .",
    "this reasoning provides an explanation for why cutoff in minimum city size and aggregation of cities ( different city borders )  @xcite influence the estimated @xmath3 .",
    "all theses procedures have a strong influence on the small cities , which are the dominant ones in the least - square fitting ( e.g. , aggregation of cities into metropolitan areas reduces the number of small cities ) .",
    "while applying cut - offs for small cities increase the visual agreement between the data and the fit in the log - log plot , this is only justified if the scaling  ( [ eq.scaling ] ) is interpreted as being valid only for large cities . the latter interpretation limits the relevance of the scaling which becomes limited to a small fraction of the total cities .",
    "new answers to this central question emerge from the results of our manuscript ( summarized in tab .",
    "[ fig_table ] ) . in @xmath137 of the @xmath6 cases we found models which are reasonably compatible with the data and we can base our conclusions on these models , i.e. , on the obtained @xmath3 and on the model comparison to the case @xmath13 ( arrows @xmath138 in the table ) .",
    "this leads to the conclusion that the uk - income and uk - train stations show linear and oecd - gdp shows superlinear scaling . in the remaining 12 cases ,",
    "conclusions are based solely on model comparison and we feel more confident to give an answer to this question only when the same conclusion is obtained for models with different fluctuations ( i.e. , we compare the conclusions obtained in the best model with log - normal and gaussian fluctuations ) .",
    "we find such an agreement in 8 of the 12 cases so that the scaling : uk - patents and oecd - patents are linear ; usa - gdp , eu - museum usag , and brazil - gdp are superlinear ; usa - roads , eu - libraries , and brazil - aids are sublinear .",
    "for the remaining @xmath139 cases our analysis is _ inconclusive _ on the question of linear or nonlinear scaling .",
    "two reasons can lead to this conclusion .",
    "the first is that the nonlinear scaling qualitatively changes from @xmath10 to @xmath8 depending on the assumptions of the fluctuations ( e.g. eu n. theaters ) .",
    "the second reason is that in one of the best models there is no sufficient statistical evidence for @xmath12 ( marked by a @xmath110 in the table , eu - cinema capacity , eu - cinema usage , and brazil - external ) .",
    "one interesting case falling in this second reason is eu - cinema usage , for which both the log - normal with fixed @xmath46 and the best model ( gaussian with free @xmath46 ) yield @xmath8 .",
    "we still consider this case inconclusive because the best model , despite showing @xmath140 , only marginally improves ( @xmath141 ) upon the model with @xmath13 . in this case , additional data is required in order to increase the statistical evidence in favor of either situation .",
    "the possibility of reaching an inconclusive answer shows the advantage of the statistical framework proposed here . in summary , in @xmath6 datasets we found @xmath139 linear , @xmath139 super - linear , and @xmath137 sub - linear scalings .",
    "in summary , we investigated the existence of non - trivial @xmath12 scalings in city datasets .",
    "we introduced @xmath5 different models , showed how to compare them and how to estimate @xmath3 , and finally tested our methods and models in @xmath6 different datasets .",
    "we found that in most cases models are rejected by the data and therefore conclusions can only be based on the comparison between the descriptive power of the different models considered here .",
    "moreover , we found that models which differ only in their assumptions on the fluctuations can lead to different estimations of the scaling exponent @xmath3 . in extreme cases , even the conclusion on whether a city index scales linearly @xmath13 or non - linearly @xmath12 with city population depends on the assumptions on the fluctuation .",
    "a further factor contributing to the large variability of @xmath3 is the broad city - size distribution which makes models to be dominated either by small or by large cities . in particular , these results show that the usual approach based on least - square fitting is not sufficient to conclude on the existence of non - linear scaling .",
    "recent works focused on developing generative models of urban formation that explain non - linear scalings   @xcite .",
    "our finding that most models are rejected by the data confirms the need for such improved models .",
    "the significance of our results on models with different fluctuations is that they show that the estimation of @xmath3 and the development of generative models can not be done as separate steps .",
    "instead , it is essential to consider the predicted fluctuations not only in the validation of the model but also in the estimation of @xmath3 .",
    "finally , the methods and models used in our paper can be applied to investigate scaling laws beyond cities  @xcite .",
    "we thank e. arcaute for kindly sharing the uk databases and d. rybski and l. bettencourt for helpful discussions .",
    "we used 15 datasets from 5 different databases . in each database",
    "( uk , usa , eu , oecd , brazil ) , the same cities @xmath16 were used , and the different datasets are different indexes @xmath0",
    ". some of our models can not consider @xmath142 . in order to allow for a comparison across all models",
    ", we ignored @xmath142 in all cases and below we report the number @xmath102 of cases @xmath143 in each dataset .    *",
    "uk : this database corresponds to fig .",
    "5b of ref .",
    "@xcite , was provided by the authors of that paper , include the aggregation of population in cities proposed in that paper , and corresponds to period 2000 - 2011 . * * income : @xmath144 , total income ( weekly ) . * * train stations : @xmath145 , number of train stations . * * patents : @xmath146 , number of patents filed in the period . *",
    "usa : this database corresponds to metropolitan areas of the usa ( gdp ) and urban areas ( roads ) in 2013 .",
    "it was constructed from 3 different sources : the population was provided by u.s .",
    "census bureau  @xcite ; the gdp was provided by the u.s .",
    "bureau of economics analysis of the department of commerce  @xcite , and the miles of roads was provided by the u.s .",
    "federal administration of highways of the department of transportation ( table hm-71 )  @xcite .",
    "similar data was used in ref .",
    "* gdp : @xmath147 , gross domestic product of metropolitan areas . *",
    "* roads : @xmath148 , length ( in miles ) of roads of urban areas . *",
    "eu : this database is provided by eurostat  @xcite .",
    "it contains population and different indexes related to culture in european cities in the year of 2011 . *",
    "* cinema capacity : @xmath149 , total number of seats of cinemas . * * cinema usage : @xmath150 , attendance of cinemas in the year .",
    "* * museums usage : @xmath151 , attendance of museums in the year .",
    "* * theaters : @xmath152 , number of theaters . * * libraries : @xmath153 , number of public libraries .",
    "* oecd : this database contains indexes of cities from the organisation for economic co - operation and development in the years 2000 - 2012  @xcite . * * gdp : @xmath154 , gross domestic product in 2010 . * * patents : @xmath155 , number of patents filed in 2008 . *",
    "brazil : this database contains different indexes of all municipalities of brazil .",
    "the data is from the year 2010 and is provided by brazil s health ministery  @xcite ( population corresponds to census data ) . * * gdp : @xmath156 , gross domestic product . *",
    "* aids : @xmath157 , number of deaths by aids . * * external : @xmath158 , number of deaths by external causes .        here",
    "we express the parameters of the log - normal distribution , @xmath61 and @xmath159 , as a function of the parameters of the scaling laws @xmath160 @xmath161 @xmath45 and @xmath46 .",
    "noting that the expectation and the variance of the log - normal distribution , eq .",
    "( [ eq.p.lognormal ] ) , are given by @xmath162 @xmath163 we find a unique solution for @xmath61 and @xmath159 by comparing with eqs .",
    "( [ eq.scaling2],[eq.scaling3 ] ) : @xmath164 .",
    "\\\\ \\end{alignedat}\\ ] ]      the maximization of the likelihood is performed by minimizing minus the log likelihood , using the algorithm `` l - bfgs - b ''  @xcite , whose implementation can be found on the python package scipy  @xcite , and the details can be found in ref .",
    "given that the minimization algorithm can converge in a local minimum , our procedure repeats the optimization 512 times , each with random initial parameters ; then , we select the among these local minima the lowest , the global minimum . we confirmed that increasing from 256 to 512 samples did not change the computed minimum , a confirmation that the algorithm found the global one .",
    "the error estimates were computed using bootstrap  @xcite .",
    "the method consists in sampling @xmath102 pairs @xmath14 with replacement from the set of @xmath102 available data points , and repeat the maximization procedure outlined in the previous section for each set .",
    "this procedure ( sampling + maximization ) was repeated @xmath165 times for each combination ( model , dataset ) and the error estimates were computed as the standard deviation of the distances from the measured parameters to the estimated parameter from the true data - set .",
    "we confirmed that the bootstrap error estimates for the log - normal fixed-@xmath46 case are within 1% equal to the values of the least square fit .",
    "the computation of the p - value was done by defining a statistic that tests the hypothesis used in each model ; in the case of the log - normal and normal models these are : a ) data is independent ; b ) the data is compatible with the model .",
    "we used a statistic based on the dagostino @xmath166 test  @xcite ( over @xmath28 or @xmath0 respectively ) , that computes the deviations from @xmath167 of the empirical kurtosis and skewness ; the test consist in comparing it with the fluctuations expected from a finite - size sample from the ( null ) model . in detail , the we compute two statistics , @xmath168 and @xmath169 for the kurtosis and skewness respectively .",
    "each of them has a @xmath170 distribution under the null , so the sum , @xmath171 is has a @xmath172 distribution ( with 2 degrees of freedom ) . because this test does not test independence of the samples , we include in the test statistic the spearman s rank - correlation  @xcite of the residuals of the fit , @xmath173 ( also distributed with as a @xmath174 ) because if the residuals are correlated , the data is not independent .",
    "the p - value is thus computed by measuring how extreme @xmath175 is in the @xmath176 distribution ( with 3 degrees of freedom ) .",
    "the implementation of this is available in the supplementary information @xcite .    in the population model",
    "the calculation of the p - value must be different , because the variance is not being left as a free parameter , so and we take a more _ classical _ approach .",
    "the @xmath97-value is computed by measuring how extreme is the difference between the data and its fit with respect to the difference between a sample from the model and its fit . in practice",
    ", we use a @xmath177 statistic to measure the distance between to sets of points @xmath178 ( data ) and @xmath179 ( the model ) , @xmath180 .",
    "then we generate from the model 200 different samples . for each of these samples",
    "we compute the @xmath177 between the sample values and their fits .",
    "finally , we compute the @xmath97-value as the fraction of samples whose @xmath177 is bigger than the one that belongs to the real data .",
    "notice that this statistic is not taking into account independence of the residuals ( if we consider the multinomial distribution as the null model , they should not be independent ) or normality in the strict sense , so this test is more permissive than the previous .",
    "we compare two models @xmath181 by calculating the bayesian information criterion ( bic )  @xcite , @xmath182 , where @xmath102 is the number of data points ( observations ) , @xmath183 is the maximum likelihood of the model , @xmath184 is the number of estimated ( free ) parameters of the model . in this approach",
    ", the model with a lower value for the bic gives a better description of the data .",
    "we can quantify how much better one model compares to the other by looking at the bayes factor  @xcite , @xmath185 , where @xmath186 is the evidence for model @xmath187 , i.e. the probability of the data given the model .",
    "it can be shown  @xcite that this quantity can be approximated by @xmath188 where @xmath189 is the difference of the respective @xmath103 s .",
    "thus , if @xmath190 , it follows that @xmath191 , i.e. that model @xmath25 provides a better description of the data than model @xmath192 . regarding the decision about nonlinear scaling , i.e. @xmath4 , we require that @xmath193 ( see main text ) , in line with ref .",
    "@xcite , where it is suggested that this implies strong or very strong evidence for a model with @xmath4 .",
    "this corresponds to @xmath194 , i.e. it is at least @xmath195 times more likely that the data comes from a model with @xmath4 .",
    "lus m  a bettencourt , jos lobo , dirk helbing , c.  kuhnert , and geoffrey  b west .",
    "growth , innovation , scaling , and the pace of life in cities .",
    "_ proceedings of the national academy of sciences _ , 104(17):73017306 , 4 2007 .",
    "lus m  a bettencourt , jos lobo , deborah strumsky , and geoffrey  b. west .",
    "urban scaling and its deviations : revealing the structure of wealth , innovation and crime across cities .",
    "_ plos one _ , 5(11):e13541 , 11 2010 .",
    "luiz g.  a. alves , haroldo  v. ribeiro , ervin  k. lenzi , and renio  s. mendes .",
    "distance to the scaling law : a useful approach for unveiling relationships between crime and urban metrics .",
    "_ plos one _ , 8(8):e69580 , 08 2013 .",
    "jaegon um , seung - woo son , sung - ik lee , hawoong jeong , and beom  jun kim .",
    "scaling laws between population and facility densities .",
    "_ proceedings of the national academy of sciences _",
    ", 106(34):1423614240 , 2009 .",
    "v.  m. savage , j.  f. gillooly , w.  h. woodruff , g.  b. west , a.  p. allen , b.  j. enquist , and j.  h. brown .",
    "the predominance of quarter - power scaling in biology . _ functional ecology _",
    ", 18(2):257282 , apr 2004 .",
    "quentin  s hanley , dan lewis , and haroldo  v ribeiro , _ rural to urban population density scaling of crime and property transactions in english and welsh parliamentary constituencies .",
    "_ , plos one * 11 * ( 2016 ) , no .  2 , e0149546 .",
    "alastair greig , john dewhurst , and malcolm horner .",
    "an application of taylor s power law to measure overdispersion of the unemployed in english labor markets .",
    "_ geographical analysis _ , 47(2):121133 , 2015"
  ],
  "abstract_text": [
    "<S> one of the most celebrated findings in complex systems in the last decade is that different indexes @xmath0 ( e.g. , patents ) scale nonlinearly with the population  @xmath1 of the cities in which they appear , i.e. , @xmath2 . </S>",
    "<S> more recently , the generality of this finding has been questioned in studies using new databases and different definitions of city boundaries . in this paper </S>",
    "<S> we investigate the existence of nonlinear scaling using a probabilistic framework in which fluctuations are accounted explicitly . </S>",
    "<S> in particular , we show that this allows not only to ( a ) estimate @xmath3 and confidence intervals , but also to ( b ) quantify the evidence in favor of @xmath4 and ( c ) test the hypothesis that the observations are compatible with the nonlinear scaling . </S>",
    "<S> we employ this framework to compare @xmath5 different models to @xmath6 different datasets and we find that the answers to points ( a)-(c ) crucially depend on the fluctuations contained in the data , on how they are modeled , and on the fact that the city sizes are heavy - tailed distributed . </S>"
  ]
}