{
  "article_text": [
    "in this paper we investigate the computational complexity of some problems in three - dimensional topology and geometry .",
    "we show that the problem of determining a bound on the genus of a knot in a 3-manifold , is * np*-complete . using similar ideas ,",
    "we show that deciding whether a curve in a metrized pl 3-manifold bounds a surface of area less than a given constant @xmath1 is * np*-hard .    determining whether a given knot is trivial or not is one of the historically central questions in topology .",
    "the problem of finding an algorithm to determine knot triviality was posed by dehn @xcite .",
    "dehn s investigations into this area led to the formulation of the word and isomorphism problems , which played an important role in the development of the theory of algorithms .",
    "the first algorithm for the unknotting problem was given by haken @xcite .",
    "haken s procedure is based on normal surface theory , a method of representing surfaces introduced by kneser @xcite .",
    "analysis of the computational complexity of this algorithm is more recent .",
    "hass , lagarias and pippenger showed that haken s unknotting algorithm runs in time at most @xmath2 , where the knot @xmath3 is embedded in the 1-skeleton of a triangulated manifold @xmath4 with @xmath5 tetrahedra , and @xmath6 is a constant independent of @xmath4 or @xmath3 @xcite .",
    "it was also shown in @xcite that the unknotting problem is in * np*.    the notion of genus was defined by seifert @xcite in 1935 for knots in the 3-sphere , and extends directly to knots in an arbitrary 3-manifold @xmath4 . given a knot @xmath3 ,",
    "consider the class @xmath7 of all orientable spanning surfaces for @xmath3 .",
    "these are surfaces embedded in @xmath4 with a single boundary component that coincides with @xmath3 .",
    "seifert showed that this class is non - empty for any knot @xmath3 in the 3-sphere . for knots in a general manifold , @xmath7 is non - empty when @xmath3 represents a trivial element in the first integer homology group of @xmath4 .",
    "the genus @xmath8 of a knot @xmath3 is the minimum genus of a surface in @xmath7 , or @xmath9 if @xmath10 .",
    "the genus measures one aspect of the degree of `` knottedness '' of a curve .",
    "the unknotting problem is a special case of the more general problem of determining the genus of a knot in a 3-manifold .",
    "given a knot @xmath3 in an orientable 3-manifold and a positive integer @xmath0 , this problem asks for a procedure to determine whether the _ knot genus _ of @xmath3 , the minimal genus of an orientable spanning surface for @xmath3 in a 3-dimensional manifold , is at most @xmath0 .",
    "a knot is trivial , or unknotted , precisely when its genus is zero .",
    "we will show that the problem of determining the genus of a knot in a 3-manifold is * np*-complete .",
    "previous results on this problem were given in @xcite , where it was shown to lie in * pspace * , roughly the class of problems that run in polynomial space .",
    "no lower bounds on the running time were previously known .",
    "we work with 3-manifolds that are triangulated and orientable , and with orientable embedded surfaces .",
    "this is not a significant restriction , since all compact 3-dimensional manifolds admit unique pl structures @xcite .",
    "knot _ in a triangulated 3-manifold @xmath4 is a connected simple ( non self - intersecting ) closed curve in the 1-skeleton of @xmath4 .",
    "any smooth knot in a smooth manifold , or more generally any tame knot , is equivalent to a knot that lies in the 1-skeleton of some triangulation .",
    "we formulate the problem of computing the genus as a language - recognition problem in the usual way , see @xcite . in 1961",
    "schubert @xcite , in an extension of haken s work , showed the decidability of the problem :    problem : = 3-manifold knot genus + instance :  triangulated 3-dimensional manifold @xmath4 , a knot @xmath3 in the + 1-skeleton of @xmath4 , and a natural number @xmath0 .",
    "+ question : does the knot @xmath3 have @xmath11 ?",
    "the size of an instance is measured by the sum of the number of tetrahedra in @xmath4 . in section  [ sectionnph ]",
    "we establish    [ thmnph ] 3-manifold knot genus is * np*-hard .",
    "it was established in @xcite that 3-manifold knot genus is in * pspace*. we improve this bound in section  [ sectiongnp ] .    [ thmgnp ] 3-manifold knot genus is * np*.    in combination these two results give :    [ 3mkgnpc ] 3-manifold knot genus is * np*-complete .",
    "theorem  [ thmnph ] is proved through a connection to one - in - three sat , a known * np*-complete problem that will be reviewed in section  3 .",
    "the theorem carries out a construction that transforms an instance of one - in - three sat to an instance of 3-manifold knot genus . by",
    "`` transform ''",
    "we mean that an instance of one problem is changed to an instance of the second by a procedure that requires time polynomial in the size of the instance . to a boolean expression representing an instance of",
    "one - in - three sat we associate a positive integer @xmath0 and a certain knot in a triangulated , compact 3-manifold .",
    "this knot bounds a surface of genus at most @xmath0 exactly when there is a truth assignment to the boolean expression satisfying the requirements of one - in - three sat . since",
    "one - in - three sat is * np*-hard , this establishes that 3-manifold knot genus is also * np*-hard .    in section  [ sectiongnp ]",
    "we prove theorem  [ thmgnp ] , giving a certificate which demonstrates in polynomial time that a genus @xmath0 knot @xmath3 bounds a surface of genus at most @xmath0 .",
    "the argument in @xcite established that the unknotting problem is * np * using the existence of a normal disk that lies along an extremal ray in the space of normal solutions , called a vertex surface in jaco - tollefson @xcite .",
    "the existence of such an extremal normal surface of minimal genus spanning a knot is not known , so a new technique is needed ( see @xcite for known results here ) .",
    "this is provided in theorem  [ orbitcount ] , which gives an algorithm to count the number of orbits of a type of pseudogroup action on a set .",
    "theorem  [ orbitcount ] seems likely to have more general applicability . in section  [ pseudogroup ]",
    "we describe this algorithm and in section  [ sectiongnp ] we apply it to a pseudogroup action that arises in the theory of normal surfaces .",
    "this allows us to determine in polynomial time the number of components in a normal surface described by an integer vector in @xmath12 .",
    "in particular we are able to certify that a normal surface is connected , orientable and has connected boundary .",
    "since calculating the euler characteristic of a normal surface can be done efficiently , establishing orientability and connectedness are the key steps in constructing a certificate of its genus .    in section",
    "[ extended ] we extend the orbit counting algorithm to allow the counting of additional integer weight sums associated to each orbit .",
    "this allows for the polynomial time calculation of the genus of all the components of a fundamental normal surface , as well as a count of the number of components .",
    "the genus and the area of a surface are closely connected . in section  [ area ]",
    "we extend the methods developed in studying genus to study the problem of determining the smallest area of a spanning surface for a curve in a 3-manifold .",
    "we show that computing an upper bound on the area of a smallest area spanning surface is * np*-hard .",
    "we refer to @xcite for a discussion of complexity classes such as * np * and * pspace * and for a discussion of complexity problems in low - dimensional topology .    * remarks : *    1 .",
    "knots are often studied in @xmath13 or @xmath14 rather than in a general manifold .",
    "our methods show that determining knot genus in @xmath13 or @xmath14 , or any fixed manifold , is * np*. it is not clear whether the corresponding problem remains * np*-hard if one restricts consideration to knots in @xmath13 or @xmath14 .",
    "casson has shown that a procedure to determine whether a 3-manifold is homeomorphic to the 3-sphere , following the 3-sphere recognition algorithm described in @xcite and @xcite , runs in time less than @xmath15 , where @xmath16 is a polynomial . in the direction of lower bounds ,",
    "it was shown in @xcite that determining certain values of the jones polynomial of alternating links is * # p*-hard .",
    "we are grateful to the referee for numerous suggestions on the exposition of this paper .",
    "general surfaces in 3-manifolds can wind and twist around the manifold in complicated ways .",
    "kneser described a procedure in which surfaces can be `` pulled taut '' , until they take a simple and rigid position @xcite . in this",
    "_ normal _ position , they have very succinct algebraic descriptions .",
    "we use an approach to normal surfaces in triangulated 3-manifolds based on work of jaco - rubinstein @xcite and jaco - tollefson @xcite .",
    "a _ normal surface _",
    "@xmath17 in a triangulated compact 3-manifold @xmath4 is a @xmath18-surface whose intersection with each tetrahedron in @xmath4 consists of a finite number of disjoint _",
    "elementary disks_. these are properly embedded disks that are isotopic to either triangles or quadrilaterals as shown in figure  [ normal ] , by an isotopy preserving each face of the tetrahedron .     elementary disks in a normal surface .",
    "]    within each tetrahedron of @xmath4 there are four possible triangles and three possible quadrilaterals , up to a _",
    "normal isotopy of @xmath4 _ , an isotopy which leaves each cell of the triangulation of @xmath4 invariant .",
    "w. haken observed that a normal surface is determined up to such isotopies by the number of pieces of each of the seven kinds of elementary disks that occur in each tetrahedron , or a vector in @xmath12 . a normal surface @xmath17 is described by a non - negative integer vector @xmath19 , that gives the _ normal coordinates _ of @xmath17 .",
    "there is a homogeneous rational cone @xmath20 in @xmath21 , called the _",
    "haken normal cone _ , that contains the vectors @xmath22 for all normal surfaces @xmath17 in @xmath4 .",
    "if @xmath23 , then the haken normal cone is specified by linear equations and inequalities of the form @xmath24 @xmath25 the first set of equations expresses _ matching conditions , _ which say that the number of edges on a common triangular face of two adjacent tetrahedra , coming from a collection of elementary disks in each of the tetrahedra , must match . for each triangular face",
    "there are three types of edges ( specified by a pair of edges on the triangle ) , which yield 3  matching conditions per face .",
    "triangular faces in the boundary @xmath26 give no matching equations . the second set",
    "are called the _ positivity",
    "_ conditions .",
    "the cone @xmath20 is _ rational , _ because the above equations have integer coefficients .",
    "we let @xmath27 denote the set of integral vectors in the cone @xmath20 .",
    "an additional set of conditions , the _ quadrilateral conditions , _ is required for an integral vector in the cone to correspond to the normal coordinates of an embedded surface .",
    "this condition states that of the three types of quadrilateral found in each tetrahedron , only one can occur in the vector with non - zero coefficient .",
    "the quadrilateral conditions are required because two distinct types of quadrilateral in a single tetrahedron necessarily intersect , and we are interested in embedded , non - self - intersecting surfaces",
    ". a vector in the haken normal cone that satisfies the quadrilateral conditions corresponds to an embedded normal surface .",
    "this surface is unique up to a normal isotopy .",
    "however it is important to note that the surface corresponding to a given vector in the cone @xmath28 may not be connected .",
    "a normal surface meets each edge of a triangulation in a finite number of points .",
    "the sum of these intersection numbers over all the edges of a triangulation is called the _ weight _ of the normal surface .    a _ fundamental normal surface _",
    "is a normal surface @xmath17 such that @xmath29 in the terminology of integer programming , such a vector @xmath22 is an element of the _ minimal hilbert basis _",
    "@xmath30 of @xmath20 , see schrijver ( * ? ? ?",
    "* theorem  16.4 ) . a fundamental normal surface is always connected , but connected normal surfaces need not be fundamental .",
    "vertex minimal solution _ is a special kind of fundamental surface , one that corresponds to a solution of the normal surface equations that lies along an extremal ray of the cone of solutions and is not a multiple of another such extremal solution .",
    "hass , lagarias and pippenger ( * ? ? ?",
    "* lemma 6.1 ) gave a bound for the size of the vectors corresponding to any fundamental surface .",
    "[ bound ] let @xmath4 be a triangulated compact 3-manifold , possibly with boundary , that contains @xmath5 tetrahedra .    *",
    "any vertex minimal solution @xmath31 of the haken normal cone @xmath32 in @xmath21 has @xmath33 * any minimal hilbert basis element @xmath31 of the haken fundamental cone @xmath32 has @xmath34    schubert @xcite showed that a surface of smallest genus spanning @xmath3 can be found among the fundamental surfaces .",
    "[ mingenusfund ] there is a minimal genus spanning surface for @xmath3 which is a fundamental normal surface .",
    "similar to the theory of normal surfaces , though somewhat easier , is the theory of normal curves .",
    "these are curves on a surface that intersect each triangle in a collection of _ normal arcs _ , arcs that have endpoints on distinct edges .",
    "normal curves arise as the boundaries of normal surfaces in a manifold with boundary .",
    "since there are three such arcs in each triangle , normal isotopy classes of normal curves in a surface that contains @xmath5 triangles are described by integer vectors in @xmath35 .",
    "in this section we show how to reduce an instance of one - in - three sat to an instance of 3-manifold knot genus .",
    "since one - in - three sat is known to be * np*-hard , this establishes that 3-manifold knot genus is also * np*-hard .",
    "the problem one - in - three sat concerns logical expressions involving collections of literals ( boolean variables or their negations ) gathered in clauses consisting of three literals connected with @xmath36 s .",
    "the logical expression contains a collection of clauses connected with @xmath37 s .",
    "problem : one - in - three sat + instance : a set @xmath38 of variables and a collection @xmath1 of clauses over @xmath38 + such that each clause @xmath39 contains 3 literals .",
    "+ question : s there a truth assignment for @xmath38 such that each clause in @xmath1 + has exactly one true literal ?",
    "schaefer @xcite established that one - in - three sat is * np*-complete . to prove theorem  [ thmnph ] ,",
    "establishing that 3-manifold knot genus is * np*-hard , we show that an arbitrary problem in one - in - three sat can be reduced in polynomial time to a problem in 3-manifold knot genus .",
    "see garey and johnson @xcite for a discussion and many examples of such reductions .",
    "let @xmath40 be a set of variables and @xmath41 be a set of clauses in an arbitrary instance of one - in - three sat .",
    "we will describe a knot @xmath3 in a compact 3-dimensional manifold ( with no boundary ) and an integer @xmath0 such that @xmath3 bounds a surface of genus smaller or equal to @xmath0 if and only if @xmath1 is satisfiable so that each clause in @xmath1 contains exactly one true literal .",
    "we construct the 3-manifold @xmath4 in stages .",
    "first we construct a 2-dimensional simplicial complex , then we thicken this complex , replacing triangles with subdivided triangular prisms , getting a triangulated , 3-dimensional manifold with boundary , as indicated in figure  [ thicken ] .",
    "finally we use a doubling construction , taking two copies of the manifold with boundary and gluing their boundaries together , to obtain a closed 3-manifold .    , shown in cross - section ,",
    "is `` thickened '' to produce a triangulated 3-manifold with boundary . ]    to begin , we form a type of singular surface @xmath42 , that we call a _ branching _ surface , by identifying boundary curves of a collection of @xmath43 surfaces with boundary , each forming what we refer to as a _ piece _ of the branching surface .",
    "we construct this collection of surfaces as follows .",
    "let @xmath44 be the number of times that the variable @xmath45 appears in the collection of clauses , and @xmath46 be the number of times that the negation @xmath47 of @xmath45 appears . for @xmath48 ,",
    "let @xmath49 and @xmath50 be genus one surfaces with @xmath51 and @xmath52 boundary curves respectively . also set @xmath53 to be a planar surface with @xmath54 boundary curves .",
    "one of these boundary curves will later become the knot @xmath3 .",
    "the branching surface @xmath42 is constructed by identifying these surfaces along appropriate boundary components as indicated in figure  [ branching ] .     corresponding to the boolean expression @xmath55 .",
    "the shaded surface @xmath56 indicates the occurrence of @xmath57 in each of the clauses @xmath58 and @xmath59 . ]",
    "branching occurs when more than two boundary curves are identified along a single curve .",
    "we identify pairs of boundary curves by giving a homeomorphism between them .",
    "up to isotopy , this is determined by specifying an orientation on the curves and setting the homeomorphism to be orientation reversing .",
    "we first fix an orientation on each of @xmath60 and @xmath50 .",
    "this induces an orientation on each boundary curve .",
    "all identifications will involve gluing a boundary component of @xmath49 or @xmath50 to a boundary component of @xmath53 , and we require this gluing to be an orientation reversing homeomorphism .",
    "label by @xmath61 the @xmath62 boundary components of @xmath53 .",
    "the boundary component @xmath3 of @xmath53 , which will become our knot , has nothing identified to it . for each @xmath63 , @xmath64 , one boundary curve from the surface @xmath49",
    "is identified to @xmath45 .",
    "the remaining @xmath44 boundary components of @xmath49 are identified with @xmath44 of the curves @xmath65 on @xmath66 , with one component of @xmath67 identified with @xmath68 for each occurrence of the literal @xmath45 in the @xmath69 clause in @xmath1 .",
    "similarly , one curve of @xmath70 is identified to the component of @xmath53 labeled @xmath45 , and the remaining @xmath46 boundary components are glued to @xmath71 , with a component glued to @xmath68 for each occurrence of the literal @xmath47 in the @xmath69 clause of @xmath1 .",
    "a total of three surface boundaries are identified along each of @xmath72 , and exactly four surface boundaries are identified along each of @xmath73 , as in figure  [ branching ] .",
    "[ branch ] there is a truth assignment for @xmath38 such that each clause in @xmath1 has exactly one true literal if and only if there is a surface @xmath17 with connected boundary and genus at most @xmath74 and a continuous map @xmath75 such that @xmath76 is a homeomorphism onto @xmath3 .",
    "[ [ proof . ] ] * proof . * +",
    "+ + + + + + +    suppose there is a truth assignment for @xmath38 such that each clause in @xmath1 contains exactly one true literal . form a surface @xmath17 inside @xmath42 by taking the union of @xmath53 and either @xmath49 if @xmath45 is true , or @xmath50 if @xmath77 is false .",
    "then exactly two boundary components will be identified along each of the boundary components of @xmath53 other than @xmath3 itself , and @xmath3 becomes the boundary of the resulting embedded surface @xmath17 .",
    "there is a contribution of one to the genus from each of the literals , since @xmath49 and @xmath50 each have genus one , and a contribution of one to the genus from each handle formed when a boundary component of a surface @xmath49 or @xmath50 is glued to @xmath53 along a curve @xmath68 .",
    "the genus of @xmath17 is therefore equal to @xmath74 .",
    "now suppose there is a surface @xmath78 of genus @xmath79 mapped continuously into @xmath42 that has a single boundary component mapped homeomorphically to the boundary curve @xmath3 .",
    "we will show in this case that there is a surface @xmath80 with the same boundary , consisting of certain pieces of @xmath42 identified along their boundaries , having genus precisely @xmath81 , and containing , along each curve @xmath68 , exactly one of the three pieces of surface joining @xmath53 .",
    "the map @xmath82 of @xmath78 into @xmath42 may be quite complicated , winding back and forth across @xmath42 , but by standard transversality arguments we can homotop @xmath82 so that it is a union of homeomorphisms of subsurfaces of @xmath78 mapped homeomorphically to one of the pieces @xmath53 , @xmath49 , @xmath83 forming @xmath42 .",
    "more precisely , we can perturb @xmath78 by a small homotopy so that its intersection with the boundary components of @xmath53 is transverse , and pulls back to a collection of simple closed curves on @xmath78 . if any of these curves bounds a disk in @xmath78 , then the disk is mapped into some subsurface @xmath84 of @xmath42 while the boundary curve is mapped to @xmath85 .",
    "since @xmath84 is not itself a disk , the disk can be homotoped into @xmath85 , and we can therefore homotop @xmath78 in a neighborhood of this disk to remove a component of @xmath86 . after repeating finitely many times , each component of the complement of @xmath87 in @xmath78 has non - positive euler characteristic . the image of @xmath78 in each piece @xmath53 , @xmath49",
    ", @xmath83 has an algebraic degree , which is either even or odd .",
    "this degree equals the number of pre - images in @xmath78 of a generic point in the piece .",
    "the degree of the map from @xmath78 on @xmath53 is odd , since @xmath3 is the boundary of @xmath78 and therefore @xmath78 maps an odd number of times to points near @xmath3 .",
    "the sum of the degrees along each of the pieces meeting a curve @xmath45 or @xmath68 is even , since @xmath78 has no boundary along these curves . in particular , for each @xmath88 , exactly one of @xmath49 , @xmath83 has odd multiplicity in @xmath78 .",
    "form a new surface @xmath89 by taking the union of @xmath53 and each of the pieces @xmath49 , @xmath83 which have odd multiplicity in @xmath78 .",
    "we will show that @xmath90 .",
    "the surface @xmath89 is obtained from @xmath78 by a series of operations that either discard a subsurface with non - positive euler characteristic or replace a subsurface of @xmath78 that maps with odd degree to some piece @xmath91 with a subsurface mapping homeomorphically to @xmath91 .",
    "the euler characteristic of a discarded subsurface of @xmath78 is smaller or equal to that of the subsurface that replaces it , so @xmath92 in either case .",
    "the collection of pieces among @xmath93 , @xmath94 that are in the image of @xmath89 can be attached to @xmath53 along common boundary curves among @xmath95 , forming a connected surface @xmath96 of genus @xmath97 .",
    "finally , a connected surface @xmath80 with boundary @xmath3 is obtained by identifying pairs of curves in @xmath98 that are mapped to the boundary components @xmath71 . each",
    "@xmath99 then has either two or four curves in @xmath98 mapped to it , so there are either one or two identifications made along each @xmath99 .",
    "the choice of which pairs to identify , in case there are four curves mapped to @xmath99 , is not important .",
    "the euler characteristic of @xmath80 is the same as that of @xmath96 and @xmath89 , and therefore greater or equal to that of @xmath78 .",
    "so the genus of @xmath80 is at most that of @xmath78 , genus@xmath100 .",
    "each identification of a pair of surface boundaries along @xmath71 contributes one to the genus of @xmath80 .",
    "there is at least one such identification along each of the @xmath101 curves @xmath102 , though there may be two if each of the three surfaces meeting @xmath53 along @xmath103 has multiplicity one in @xmath89 .",
    "so identification of curves along @xmath71 adds at least @xmath101 to the genus of @xmath80 , and it follows that genus(@xmath104 . since we have seen that genus@xmath100 , equality must hold .",
    "equality holds when exactly one of the three surface pieces meeting @xmath53 along @xmath103 has odd multiplicity for each @xmath105 .",
    "we then assign the value `` true '' to a literal @xmath45 if @xmath49 is used in @xmath80 , and the value `` false '' to @xmath45 if @xmath83 is used in @xmath80 .",
    "this gives a truth assignment to @xmath38 in which each clause in @xmath1 has exactly one true literal .    to show that 3-manifold knot genus is * np*-hard we reduce in polynomial time an instance of the * np*-hard problem one - in - three sat to an instance of 3-manifold knot genus .    *",
    "proof of theorem  [ thmnph ] . * given an instance of one - in - three sat form @xmath42 as in lemma  [ branch ] .",
    "then there is a truth assignment for @xmath38 such that each clause in @xmath1 has exactly one true literal if and only if @xmath3 is the boundary of a surface of genus @xmath74 mapped continuously into @xmath42 .",
    "form a 3-manifold @xmath106 by thickening @xmath42 so that it is embedded inside a triangulated 3-dimensional manifold with boundary .",
    "the thickening process replaces each subsurface forming @xmath42 by a product of a surface with an interval , and then glues these surfaces together along portions of their boundaries , as indicated in figure  [ thicken ] .",
    "the curve @xmath3 remains on the boundary of @xmath106 , and there is a projection map @xmath107 which fixes @xmath3 .",
    "form a closed manifold @xmath4 by doubling @xmath106 along its boundary , namely by taking two copies of @xmath106 and identifying them along their boundaries by the identity map .",
    "then @xmath4 admits an involution @xmath108 that fixes @xmath3 , and has quotient @xmath106 .    to find a triangulation of @xmath106",
    ", we first describe an explicit triangulation of the branching surface @xmath42 . an orientable surface with boundary",
    "has a triangulation with one vertex on each boundary component and no vertices in the interior .",
    "the number of triangles is @xmath109 , where @xmath0 is the genus and @xmath6 is the number of boundary components .",
    "we choose such triangulations for each of the @xmath43 subsurfaces in the branching surface , and we match them together along boundary components to get a triangulation of @xmath42 .",
    "so @xmath42 has a triangulation in which the number of triangles is linearly bounded in @xmath81 .",
    "we thicken the surfaces @xmath49 and @xmath110 , by taking their product with an interval .",
    "we form a cell structure of the thickened surface by dividing the product into prisms , products of a triangle and an interval . for the thickening of @xmath53 , we start by doing the same and then go on to divide each interval into five subintervals .",
    "the top , middle and bottom subintervals are identified with the intervals from the three thickened surfaces meeting each thickened boundary component of @xmath53 corresponding to a curve @xmath99 . only the top and bottom intervals are identified with thickened surfaces from the other boundary components .",
    "we can therefore now glue these thickened surfaces together to get a 3-cell structure on @xmath106 .",
    "each cell in this structure is a prism .",
    "we form a closed 3-manifold @xmath4 by doubling @xmath106 along its boundary , gluing two copies of @xmath106 together along their boundaries to obtain a 3-manifold with no boundary .",
    "finally , we stellar subdivide the cell structure to get a triangulation .",
    "each prism is divided into 14 tetrahedra , by dividing each rectangular face into four triangles by coning to a vertex in the center of each such face , and then coning the 14 triangles of the boundary of the prism to a vertex added to its center .",
    "the number of resulting simplices in @xmath4 is linearly bounded by @xmath81 .",
    "we now check that if @xmath3 bounds a surface of genus @xmath111 with interior in @xmath112 then it bounds a surface of the same genus in @xmath42 .",
    "suppose that @xmath113 is an embedded surface in @xmath4 with boundary @xmath3 . if @xmath113 does not already lie in @xmath106 , then perturb it slightly so that the interior of @xmath113 meets @xmath114 transversely in a finite number of simple closed curves and arcs .",
    "using the involution @xmath108 , reflect the portion of @xmath113 not in @xmath106 into @xmath106 , forming an immersed surface @xmath115 lying in @xmath106 and with the same boundary as @xmath113 .",
    "the interior of @xmath115 remains disjoint from @xmath3 since @xmath3 is fixed by the involution .",
    "the projection @xmath116 is a surface of genus @xmath0 mapped into @xmath42 with boundary @xmath3 .",
    "so if @xmath3 bounds an embedded surface of genus at most @xmath74 in @xmath4 then it bounds a surface of genus at most @xmath74 mapped into @xmath42 .",
    "the converse was shown in the proof of lemma  [ branch ] .",
    "it then follows from lemma  [ branch ] that @xmath3 bounds an embedded surface of genus at most @xmath74 in @xmath4 if and only if @xmath1 is satisfiable with each clause containing exactly one true literal .",
    "the construction of @xmath117 and @xmath4 described above each requires only a linear number of steps in the size of the instance of one - in - three sat with which we started , so that the reduction requires polynomial time .",
    "in this section we develop a combinatorial procedure that will allow us to count the components of a normal surface .",
    "the procedure computes the number of orbits of a collection of @xmath118 isometries between subintervals of an interval @xmath119 \\subset { { \\mathbb{z}}}$ ] in time polynomial in @xmath120 . by lining up the intersections of a normal surface with the edges of a triangulation , we obtain such subintervals .",
    "arcs of the normal surface on the faces of the triangulation give rise to correspondences of these intersection points which are subinterval isometries .",
    "we can then apply the algorithm developed here to count the number of components of a normal surface .",
    "assume that we have a set of integers @xmath121 and a collection of bijections , @xmath122 \\to [ c_i , d_i]$ ] , @xmath123 , either increasing or decreasing , that are called _",
    "pairings_. if a pairing identifies two intervals @xmath124 $ ] and @xmath125 $ ] by sending @xmath126 to @xmath6 and @xmath127 to @xmath128 , we call it an _ orientation preserving _ pairing , and if it sends @xmath126 to @xmath128 and @xmath127 to @xmath6 , we call it _ orientation reversing_. if @xmath129 we refer to @xmath130 $ ] as the _ domain _ and @xmath131 $ ] as the _ range _ of the pairing",
    ". we work only with integers , and use the term `` connected interval '' to refer to the integers in a connected real interval .",
    "the _ width _ of an interval @xmath130 $ ] with integer endpoints is @xmath132 , the number of integers it contains .",
    "the _ width _ of a pairing is the width of its domain or range , @xmath133 . if the pairing preserves orientation , its _ translation distance @xmath5 _ measures how far it moves points , so @xmath134 .",
    "we can compose two pairings if the range of the first lies in the domain or range of the second .",
    "the collection of pairings generates a pseudogroup , under the operations of composition where defined , inverses , and restriction to subintervals .",
    "the interval @xmath135 $ ] is divided into equivalence classes by the action of the pairings , which are called _",
    "orbits_. we are interested in the orbit structure of the collection of pairings , since with appropriate interpretation an orbit corresponds to a connected component of a normal surface .",
    "we introduce several simplification processes on the set of pairings in order to analyze the structure of the set of orbits .",
    "we introduce some terminology to describe the behavior of pairings .",
    "an interval is called _",
    "static _ if it is in neither the domain nor the range of any pairing , so that its points are identified to no other points by pairings . given a collection of pairings acting on the integers",
    "@xmath135 $ ] , a pairing is said to be _ maximal _ if its range contains both @xmath106 and the range of any other pairing containing @xmath106 . more precisely , define a linear order on pairings using the lexicographical order @xmath136 , so that the maximal pairing has the highest upper endpoint , and among those with that endpoint the widest range , and among those with that range the biggest translation distance ( if orientable ) .",
    "finally , we say that a pairing @xmath137 \\to [ c , d]$ ] is _ periodic _ with period @xmath5 if it is orientation preserving with translation distance @xmath5 and @xmath138 , so there is no gap between the domain and range .",
    "the combined interval @xmath139 $ ] is then called a _ periodic interval _ of period @xmath5 .",
    "the following lemma describes the orbits of a periodic pairing .",
    "a periodic pairing has @xmath140 orbits on @xmath139 $ ] .",
    "[ [ proof.-1 ] ] * proof . * + + + + + + + +    each point in @xmath124 $ ] greater or equal to @xmath6 lies in the range of @xmath0 and can be mapped to a smaller point in @xmath124 $ ] by a power of @xmath141 .",
    "so each orbit on @xmath139 $ ] has a representative in @xmath142 $ ] . since the congruence class modulo @xmath5 of a point",
    "is preserved by @xmath0 , each of the @xmath5 integers in @xmath142 $ ] lies in a distinct orbit .",
    "these points uniquely represent the @xmath5 orbits .",
    "we now show how to merge two pairings with sufficient overlap into a single pairing with the same orbits .",
    "[ merge1 ] let @xmath143 be a periodic interval with pairing @xmath144 of period @xmath145 .",
    "suppose that there exists an orientation preserving pairing @xmath146 with translation distance @xmath147 and an interval @xmath148 such that @xmath149 has width @xmath145 and @xmath150 .",
    "then the orbits of @xmath151 on @xmath143 are the same as those of a single periodic action on @xmath143 of period @xmath152 .",
    "[ [ proof.-2 ] ] * proof .",
    "* + + + + + + + +    let @xmath149 be an interval in @xmath143 of width @xmath145 that is in the domain of @xmath146 and which is paired by @xmath146 to an interval in @xmath143 .",
    "each point in @xmath143 has a unique orbit representative in @xmath149 under the action of @xmath144 on @xmath143 .",
    "the interval @xmath153 lies in @xmath143 by assumption . for @xmath154 let @xmath155 be the unique point in @xmath149 obtained by carrying @xmath156 back to a point in @xmath149 by a power of @xmath144 or @xmath157 .",
    "the effect of @xmath155 on @xmath149 is a shift of @xmath158 .",
    "the orbits of @xmath159 on @xmath149 divide the points of @xmath149 into congruence classes modulo @xmath160 .",
    "neither @xmath144 nor @xmath146 change the congruence class of a point mod @xmath161 , so a subinterval of width @xmath152 in @xmath143 contains exactly one representative of each orbit of @xmath143 under the action of @xmath151 .",
    "the same orbits arise from a periodic action of period @xmath152 .",
    "the following is a special case of lemma  [ merge1 ] that applies when both @xmath144 and @xmath146 are periodic pairings .",
    "[ merge2 ] let @xmath143 and @xmath162 be overlapping periodic intervals , associated with pairings @xmath163 having periods @xmath145 and @xmath147 .",
    "suppose that width(@xmath164 .",
    "then the orbits of @xmath151 on @xmath165 are the same as those of a single periodic pairing on @xmath165 of period @xmath152 .",
    "[ [ proof.-3 ] ] * proof . * + + + + + + + +    the leftmost interval @xmath149 of width @xmath145 in @xmath166 is translated by @xmath146 a distance of @xmath147 to the right , to an interval @xmath167 which lies in @xmath166 .",
    "lemma  [ merge1 ] then states that the action of @xmath151 on @xmath143 is the same as those of a single periodic pairing on @xmath143 of period @xmath152 . by symmetry",
    "the same result holds for the action of @xmath151 on @xmath162 .",
    "thus the orbits of @xmath151 on @xmath165 are the same as those of a single periodic pairing on @xmath165 of period @xmath152 .",
    "we state a consequence in a form which will be convenient for our applications .",
    "[ merge3 ] let @xmath163 be periodic pairings with periods @xmath168 and let @xmath169 be intervals with @xmath170 and @xmath171 .",
    "suppose that @xmath172 is contained in the union @xmath173 .",
    "then the hypothesis of lemma  [ merge2 ] is satisfied and the orbits of @xmath174 are the same as those of a single periodic pairing of period @xmath160 , acting on the union of the periodic intervals of @xmath163 .",
    "[ [ proof.-4 ] ] * proof . *",
    "+ + + + + + + +    let @xmath175 , j= [ a , b]$ ] and @xmath176 $ ] .",
    "we have @xmath177 and @xmath178 .",
    "since @xmath179 is a connected interval , we have that @xmath180 .",
    "note that @xmath181 and @xmath182 . then @xmath183 .",
    "the width of @xmath172 is @xmath184 and we have seen above that @xmath185 .",
    "so the width of @xmath172 is at least @xmath186 and lemma  [ merge2 ] implies the conclusion of the lemma .",
    "the orbit counting algorithm applies a series of modifications to a collection of pairings .",
    "we now describe these modifications .",
    "* periodic merger + the _ periodic merger _ operation replaces @xmath144 and @xmath146 by a single periodic action on @xmath165 of period @xmath152 , as in lemma  [ merge2 ] . *",
    "contraction + the operation of _ contraction _ is performed on a static interval @xmath187 $ ] .",
    "we eliminate this interval , replace @xmath119 $ ] by @xmath188 $ ] , and alter each @xmath189 by replacing any point @xmath190 in a domain or range which lies entirely to the right of @xmath191 by @xmath192 .",
    "( this operation will lead to a decrease of @xmath193 in the number of orbits , since the eliminated points are each unique representatives of an orbit . ) * trimming + the _ trimming _ operation simplifies an orientation reversing pairing whose domain and range overlap .",
    "suppose that @xmath137 \\to [ c , d]$ ] is a pairing with @xmath194 and @xmath195 .",
    "define a new pairing @xmath196 $ ] by restricting the domain and range of @xmath0 , and say that @xmath197 is obtained from @xmath0 by _",
    "the domain and range of a trimmed pairing are disjoint .",
    "* truncation + if an interval lies in the domain and range of exactly one pairing , then the interval can be `` peeled off '' without changing the orbit structure , in a way we now describe .",
    "the algorithm applies this operation to strip off points from the right of the interval @xmath119 $ ] .",
    "+ when there is a pairing @xmath137 \\to [ c , n]$ ] and a value @xmath198 with @xmath199 , such that all points in the interval @xmath200 $ ] are in the range of no pairing other than @xmath0 , then we can perform an operation called _ truncation _ of @xmath0 .",
    "truncation shortens the interval @xmath201 $ ] to the interval @xmath202 $ ] , and similarly shortens the domain and range of @xmath0 .",
    "if @xmath0 is orientation preserving , pairings other than @xmath0 are unchanged , while @xmath0 is eliminated entirely if @xmath203 , or replaced by a shortened pairing @xmath204 \\to [ c , n']$ ] if @xmath205 .",
    "we can perform this operation even if the interval @xmath206 $ ] intersects both the range and the domain of @xmath0 .",
    "+ if @xmath0 is orientation reversing , truncation is applied only when @xmath0 has disjoint domain and range ( i.e. after trimming ) , and @xmath200 $ ] is contained in the range .",
    "suppose @xmath207 \\to [ c , n]$ ] is a pairing with @xmath208 and @xmath209 , that @xmath200 $ ] is disjoint from the domains and ranges of all pairings other then @xmath0 and that @xmath210 .",
    "if @xmath211 then we eliminate @xmath0 .",
    "otherwise replace @xmath0 by a shortened orientation reversing pairing , formed by restricting its domain to @xmath212 $ ] and its range to @xmath213 $ ] . *",
    "transmission + transmission is an operation in which two pairings are composed .",
    "a pairing @xmath144 used to shift down the domain and range of a second pairing @xmath146 as much as possible .",
    "this operation will allow us to shift pairings leftwards from the right end of the interval @xmath202 $ ] and subsequently apply truncation .",
    "+ if @xmath144 is orientation reversing and has overlapping domain and range , then as a first step in transmission we trim @xmath144 .",
    "now consider a pairing @xmath144 , either orientation preserving or orientation reversing , and a second pairing @xmath146 whose range is contained in the range of @xmath144 .",
    "if the domain of @xmath146 is not contained in the range of @xmath144 , form the composite map @xmath214 , where @xmath215 if @xmath144 is orientation reversing and otherwise @xmath216 is the largest integer such that @xmath217)$ ] is contained in the range of @xmath144 .",
    "the domain of @xmath218 is the same as that of @xmath146 in this case . if the domain of @xmath146 is also contained in the range of @xmath144 then form the composite map @xmath219 ) \\to g_1^{-r}([c_2 , d_2])$ ] , where @xmath220 is as above , @xmath221 if @xmath144 is orientation reversing , and otherwise @xmath222 is the largest integer such that @xmath223 ) $ ] is contained in the range of @xmath144 .",
    "the domain of @xmath218 is then that of @xmath146 shifted left by @xmath224 .",
    "the process of replacing @xmath146 by @xmath225 is called a _ transmission of @xmath146 by @xmath144_.    we now construct a sequence of pseudogroups of pairings , terminating with the trivial pseudogroup acting on the empty set . at each stage , each orbit is associated to a unique orbit in the previous set of pairings , though the number of orbits may decrease .",
    "a counter is kept at each stage that records the total decrease in the number of orbits .",
    "since the final pseudogroup has no orbits , the final value of this counter gives the initial number of orbits .",
    "[ orbit.same ] a contraction decreases the number of orbits by the width of the contracted interval . altering a collection of pairings by any of the operations of periodic merger , trimming",
    ", truncation and transmission preserves the number of orbits .",
    "[ [ proof.-5 ] ] * proof . *",
    "+ + + + + + + +    we refer to the collection of pairings @xmath226 as @xmath227 and to the new collection of pairings produced by one of the operations as @xmath228 .",
    "the effect of a contraction is to shorten the interval @xmath119 $ ] by removing points which are fixed by the entire collection of pairings .",
    "the number of orbits removed equals to the width of the contracted interval .",
    "a periodic merger joins two periodic intervals @xmath143 and @xmath229 and their pairings into one .",
    "lemma  [ merge2 ] shows that the orbits in @xmath165 of @xmath151 are the same as those produced by a single periodic pairing @xmath197 .",
    "suppose that @xmath190 and @xmath230 are points in @xmath119 $ ] in the same orbit of the action of @xmath231 .",
    "then @xmath232 , where @xmath233 is some finite word in the elements of @xmath227 and their inverses .",
    "wherever a @xmath144 or @xmath146 occurs in this word we can replace it by a power of @xmath197 , since @xmath197 translates by an amount that divides the translation distance of @xmath144 and @xmath146 .",
    "so @xmath190 and @xmath230 are in the same orbit of @xmath234 .",
    "conversely suppose that that @xmath190 and @xmath230 are in the same orbit under @xmath228",
    ". then @xmath235 , where @xmath236 is some finite word in @xmath237 .",
    "lemma  [ merge2 ] implies that wherever a @xmath197 occurs in @xmath236 we can replace it by some word in @xmath144 and @xmath146 , since the orbits of @xmath197 and @xmath151 coincide on the periodic interval of @xmath197 .",
    "so periodic mergers preserve orbits .",
    "suppose next that @xmath238 \\to [ c_i , d_i]$ ] is an orientation reversing pairing with @xmath239 , and that @xmath240 $ ] is obtained by trimming @xmath241 .",
    "if @xmath190 and @xmath230 are in the same orbit of @xmath231 , then there is a sequence of points @xmath242 where each @xmath243 is the image of @xmath244 under a pairing in @xmath227 .",
    "we can replace an occurrence of @xmath241 or @xmath245 by @xmath197 if the point @xmath244 is smaller than @xmath246 and by @xmath247 otherwise .",
    "so @xmath190 and @xmath230 remain in the same orbit under the action of @xmath228 .",
    "conversely if @xmath190 and @xmath230 are in the same orbit under @xmath228 then replacing each occurrence of @xmath197 by @xmath0 and of @xmath247 by @xmath141 gives a word in @xmath227 taking @xmath190 to @xmath230 .",
    "we conclude that trimming preserves orbits .",
    "next consider the effect of a truncation .",
    "suppose that all points in @xmath200 $ ] are in the range of exactly one pairing @xmath137 \\to [ c , n]$ ] , and we truncate , shortening to an interval @xmath248 $ ] and either eliminating @xmath0 or shortening it to @xmath204 \\to [ c , n']$ ] in the orientation preserving case , or to @xmath249 \\to [ c , n']$ ] in the orientation reversing case .",
    "suppose that @xmath250 where @xmath233 is a reduced product of pairings ( a product that does not contain a subproduct of the form @xmath251 ) .",
    "we can assume that @xmath252 , as otherwise we can replace @xmath233 by its inverse .",
    "let @xmath236 be obtained from @xmath233 by replacing all occurrences of @xmath0 with @xmath197 .",
    "the successive images of @xmath190 under the subwords of @xmath233 can never enter and leave the interval @xmath200 $ ] , since they can only enter it under the action of some positive power of @xmath0 , and only leave it under a negative power of @xmath0 .",
    "these do nt occur in succession in a reduced product .",
    "the image of a point @xmath253 under @xmath189 is unchanged unless @xmath254 , and @xmath255 .",
    "so the image of @xmath190 under @xmath233 is the same as its image under @xmath236 unless @xmath256 . in that case",
    "@xmath233 is of the form @xmath257 where @xmath258 , @xmath216 , and @xmath259 .",
    "so two points in @xmath248 $ ] are in the same orbit under @xmath228 if and only if they are in the same orbit under @xmath227 .",
    "but each point in @xmath200 $ ] is in the same @xmath227 orbit as a point in @xmath202 $ ] .",
    "it follows that the number of orbits is unchanged by truncation .",
    "finally suppose that a transmission of @xmath189 by @xmath241 replaces the pairing @xmath189 in @xmath227 by @xmath260 .",
    "if @xmath250 where @xmath233 is a word in @xmath227 , then @xmath261 where @xmath236 is obtained by replacing every occurrence of @xmath189 with @xmath262 . similarly if @xmath263",
    "where @xmath236 is a word in @xmath228 , then @xmath250 where @xmath233 is obtained by replacing every occurrence of @xmath264 with @xmath265 .",
    "so transmissions preserve the collection of orbits and do nt change their number .",
    "we now describe an algorithm which uses these operations to count the number of orbits of a pseudogroup of pairings acting on @xmath119 $ ] .",
    "we initially set a counter for the number of orbits to zero .",
    "a pairing @xmath241 is said to be _ maximal _ if @xmath266 and @xmath267 $ ] contains the range of any other pairing with an endpoint at @xmath106 .",
    "let @xmath268 and let @xmath122 \\to [ c_i , d_i],\\   1 \\le i \\le k$ ] be a collection of pairings between subintervals of @xmath17 .",
    "the algorithm will contract @xmath17 and reduce the number of pairings .",
    "it keeps a running count of the number of orbits detected in an integer referred to as the orbit counter .",
    "denote by @xmath198 the current size of the interval as we proceed .",
    "the algorithm repeats the following steps , reducing @xmath198 and @xmath118 , until there are no points remaining . + * orbit counting algorithm : *    1 .",
    "delete any pairings that are restrictions of the identity .",
    "2 .   make any possible contractions and , if any exist , increment the orbit counter by the sum of the number of points deleted by the contractions .",
    "if the number of pairings remaining is zero , output the number of orbits and stop .",
    "3 .   trim all orientation reversing pairings whose domain and range overlap .",
    "4 .   search for pairs of periodic pairings @xmath241 and @xmath189 whose domains and ranges satisfy the condition of lemma  [ merge2 ] . if any such pair exists then perform a merger as in lemma  [ merge2 ] , replacing @xmath241 and @xmath189 by a single periodic pairing , with translation distance @xmath269 .",
    "the new pairing acts on the union of the domains and ranges of @xmath241 and @xmath189 .",
    "repeat until no mergers can be performed .",
    "find a maximal @xmath241 .",
    "for each @xmath270 whose range is contained in @xmath271 $ ] , transmit @xmath189 by @xmath241 .",
    "6 .   find the smallest value of @xmath6 such that the interval @xmath213 $ ] intersects the range of exactly one pairing .",
    "truncate the pairing whose range contains the interval @xmath213 $ ] .",
    "[ orbitcount ] the orbit counting algorithm gives the number of orbits of the action of the pairings @xmath272 on @xmath273 $ ] in time bounded by a polynomial in @xmath274 .",
    "[ [ proof.-6 ] ] * proof . *",
    "+ + + + + + + +    we first check that the orbit counting algorithm correctly counts the number of orbits . in step",
    "( 1 ) , deleting a pairing which is the identity on its domain does not change the number of orbits . in step ( 2 ) , contracting a static interval removes a number of points that are unique orbit representatives , and the count of these is added to the running total kept in the orbit counter . if all the points have been removed , then there are no more orbits to count and the orbit count is complete .",
    "lemma  [ orbit.same ] shows that the operations of transmission , trimming , truncation and merger occurring in steps ( 3),(5 ) and ( 6 ) do not change the number of orbits of the collection of pairings .",
    "mergers carried out in step ( 4 ) occur when the conditions of lemma  [ merge2 ] are satisfied , and lemma  [ merge2 ] shows that they preserve the orbit structure of the collection of pairings .",
    "a merger reduces the number of pairings by one , replacing two pairings @xmath241 and @xmath189 by a single periodic pairing acting on the union of their periodic intervals .    in each cycle through these steps the interval width decreases by at least one , either in step ( 2 ) or in step(6 ) .",
    "it follows that the algorithm terminates , yielding a count of the number of orbits after a number of steps bounded by the width @xmath106 of the interval .",
    "we will obtain a much better bound .",
    "to do so , we define a complexity which decreases as we iterate the above steps .",
    "recall that @xmath275 and @xmath118 is the number of pairings .",
    "the complexity @xmath84 is defined to be @xmath276 the process of executing steps ( 1)-(7 ) in turn is called a _",
    "cycle_. we will show that when we run through @xmath277 cycles , @xmath84 is reduced by a factor of at least two . see the remark at the end of this section for a geometric interpretation of this complexity .",
    "call an interval @xmath278 $ ] a _ @xmath279-close _",
    "interval if it is the domain or range of a pairing of subintervals of @xmath280 $ ] and if @xmath281 , or equivalently , if @xmath282 . being @xmath279-close corresponds to being relatively close to @xmath279 .",
    "it means that there is no room for another interval of the same size to the right of @xmath230 .",
    "the value of @xmath279 is initially set to @xmath106 , and as the algorithm proceeds it is reset to the current interval width @xmath198 each time the number of pairings @xmath118 is decreased .",
    "the number of pairings decreases when a merger occurs , or when a pairing is truncated to zero width , or when a pairing is transmitted to become trivial ( a restriction of the identity ) and then eliminated .",
    "[ overlap ] the union of two @xmath279-close intervals of equal width is a connected interval .",
    "[ [ proof.-7 ] ] * proof . *",
    "+ + + + + + + +    suppose that @xmath130 $ ] and @xmath131 $ ] are equal width @xmath279-close intervals with @xmath283 .",
    "then @xmath284 , @xmath285 and @xmath286 , so @xmath287 implying that @xmath288 and @xmath130 \\cup [ c , d ] $ ] is connected .",
    "[ transmit ] suppose that the domain @xmath130 \\subset [ 1,z]$ ] of a pairing @xmath0 is not @xmath279-close . then the image @xmath289 $ ] of an interval @xmath278 $ ] under @xmath290 is not @xmath279-close .",
    "[ [ proof.-8 ] ] * proof . *",
    "+ + + + + + + +    suppose that @xmath289 $ ] is the image of @xmath278 $ ] under @xmath290 , where @xmath291 \\to [ c , d]$ ] .",
    "by assumption we have that @xmath292 .",
    "the interval @xmath289 $ ] is contained in @xmath130 $ ] so @xmath293 .",
    "then @xmath294 and @xmath289 $ ] is not @xmath279-close .",
    "[ 5pairs ] after a series of five cycles either the number of @xmath279-close intervals decreases or the number of pairings decreases .    [ [ proof.-9 ] ] * proof .",
    "* + + + + + + + +    in each cycle at least one maximal pairing is truncated .",
    "suppose that during a series of five cycles , five successive maximal pairings @xmath295 occur in turn in the orbit counting algorithm .",
    "the initial maximal pairing @xmath144 is truncated in the first cycle .",
    "eventually @xmath296 stops being maximal , and it is then transmitted by the new maximal pairing @xmath297 in the next cycle .",
    "the cycle @xmath146 is then itself truncated until no longer maximal and it in turn is then transmitted by @xmath298 and so on .",
    "when @xmath299 transmits @xmath300 , the pairing of @xmath301 $ ] with @xmath302 $ ] is replaced by a pairing of @xmath303 $ ] with @xmath304 $ ] and one of the following three cases occurs .    1 .",
    "the range @xmath305 $ ] of @xmath241 is transmitted to a non @xmath279-close interval by @xmath299 .",
    "the range @xmath305 $ ] is transmitted to a @xmath279-close interval @xmath306 $ ] by @xmath299 , and the domain @xmath307 $ ] of the transmitted pairing is @xmath279-close .",
    "the range @xmath305 $ ] is transmitted to a @xmath279-close interval @xmath306 $ ] by @xmath299 , and the domain @xmath307 $ ] of the transmitted pairing is not @xmath279-close .",
    "we first consider the case where each of @xmath308 is orientation preserving .",
    "setting @xmath279 to the initial interval width @xmath198 and noting that @xmath296 is initially maximal , we see that the range of @xmath144 is initially @xmath279-close , with @xmath309 .",
    "truncation reduces the range to of @xmath144 to @xmath310 $ ] , at which point the pairing @xmath297 becomes maximal . we can assume the range @xmath310 $ ] of @xmath144 is still @xmath279-close , or we are done . in the next cycle",
    "the interval @xmath310 $ ] is transmitted by @xmath297 to an interval @xmath311 $ ] .",
    "if case ( 1 ) applies , this new interval is not @xmath279-close and the number of @xmath279-close intervals has decreased .",
    "if case ( 2 ) , the three intervals @xmath312 , [ c_1 ' , d_1']$ ] and @xmath313 $ ] are all @xmath279-close and of equal width , and therefore satisfy the hypothesis of claim  [ overlap ] .",
    "lemma  [ merge3 ] then implies that two pairings can be merged , and the number of pairings decreases during the execution of step ( 4 ) in the next cycle .",
    "if case ( 3 ) occurs , the maximal pairing @xmath297 is truncated in the second cycle .",
    "we can assume its domain remains @xmath279-close , or we are done .",
    "when the next pairing @xmath298 becomes maximal and transmits @xmath146 in the third cycle , we must fall into one of the first two cases .",
    "so the number of @xmath279-close intervals is decreased in the third cycle or the number of pairings decreases in a merger during a subsequent application of step ( 4 ) in the fourth cycle .",
    "now we consider the possibility that one of @xmath308 is orientation reversing .",
    "the domain and range of a trimmed orientation reversing pairing are disjoint , and hence any interval transmitted by an orientation reversing pairing is not @xmath279-close . if any of @xmath314 are orientation reversing then it transmits the previously maximal pairing s range to an interval that is not @xmath279-close and the number of @xmath279-close pairings decreases .",
    "if non is orientation reversing then there is a sequence of three successive orientation preserving pairings and the previous argument applies .",
    "[ div2 ] suppose that @xmath279 is set to the current interval size @xmath198 and that after a series of truncations in which the maximal pairings are successively @xmath315 , no @xmath279-close intervals remain .",
    "then the complexity @xmath84 is reduced by a factor of at least two .",
    "[ [ proof.-10 ] ] * proof . * + + + + + + + +    truncation of a maximal pairing @xmath241 results in its range @xmath316 $ ] , of width @xmath317 , being reduced to a shorter interval @xmath318 $ ] of width @xmath319 .",
    "this reduces the complexity @xmath84 by a factor of @xmath320 the maximal pairing changes after a truncation if the range of @xmath321 has truncated sufficiently so that it is contained in the range of @xmath299 , so that @xmath322 and @xmath323 .",
    "define @xmath324 by @xmath325 and define @xmath326 differentiation shows that the function @xmath327 is increasing with @xmath190 for @xmath328 , since @xmath329 .",
    "so @xmath330    after a series of truncations of the pairings @xmath331 , the complexity @xmath84 is multiplied by a factor of @xmath332 now @xmath333 , since @xmath144 was the first maximal pairing truncated , so @xmath334 . by assumption , there are no @xmath279-close intervals remaining after @xmath335 is truncated , so that @xmath336 $ ] is not @xmath279-close .",
    "we then have by the definition of @xmath279-close that @xmath337 it follows that @xmath84 is multiplied by a factor smaller than 1/2 .",
    "* proof of theorem  [ orbitcount ] : * the operations involved in one cycle consist of comparisons , additions , subtractions and computing greatest common divisors of the @xmath118 pairings of @xmath227 .",
    "the number of these operations occurring in each cycle is linear in @xmath338 .",
    "pairings are described by pairs of intervals , whose boundary points are integers of size at most @xmath106 .",
    "so the running time of each cycle is polynomial in @xmath339 .",
    "if the number of pairings @xmath118 decreases during a cycle , then a pairing has been eliminated because its width has truncated to zero , because it has been transmitted and become the identity on its domain , or because two pairings have merged .",
    "when two pairings @xmath163 merge , the value of @xmath118 decreases by one . the product @xmath340 which occurs in @xmath84",
    "is replaced by the width of the new pairing , which is at most @xmath341 .",
    "therefore @xmath342 decreases by a factor of at least two after a merger .",
    "since each pairing has width at most @xmath106 , the initial complexity is bounded above by @xmath343 . by claim  [ 5pairs ] , each time we run through five cycles either the number of pairings decreases or the number of @xmath279-close intervals decreases .",
    "there are at most @xmath118 @xmath279-close intervals initially , so after @xmath344 cycles either there is a reduction in the number of pairings or there are no @xmath279-close intervals remaining . in the second case",
    "the complexity @xmath84 has decreased by a factor of at least two , by claim  [ div2 ] .",
    "so @xmath84 decreases by a factor of at least two after @xmath344 cycles , and the complexity reduces to zero after at most @xmath345 successive series of @xmath344 cycles , or after at most @xmath346 cycles .",
    "each cycle runs in time polynomial in @xmath120 , so the total running time is also polynomial in @xmath120 .",
    "we now apply theorem  [ orbitcount ] to count the number of components of a normal curve or normal surface .",
    "an obvious algorithm to count components proceeds by marking vertices connected by common edges until all vertices in a component are reached .",
    "this procedure takes time linear in the number of edges of the curve .",
    "this is equal to the sum of the normal coordinates ( called @xmath347 below ) , but we can achieve an exponential improvement .",
    "we first look at normal curves .",
    "[ normalcurvecount ] let @xmath113 be a surface with a triangulation @xmath348 containing @xmath5 triangles and let @xmath349 be a normal curve in @xmath113 with normal coordinates summing to @xmath347 .",
    "there is a procedure for counting the number of components of @xmath349 that runs in time polynomial in @xmath350 .",
    "[ [ proof.-11 ] ] * proof . *",
    "+ + + + + + + +    the 1-skeleton of @xmath348 contains @xmath351 edges , where @xmath352 .",
    "fix once and for all an ordering of these edges .",
    "a normal curve @xmath349 intersects each edge of @xmath348 in a finite number of points .",
    "set @xmath106 to be the weight @xmath347 of @xmath349 , the sum of the number of intersection points of @xmath349 with all the edges of @xmath348 .",
    "label the intersections of @xmath349 and the first edge of the 1-skeleton by the integers @xmath353 , the intersections of @xmath349 and the @xmath354th edge by @xmath355 , and the intersection of @xmath349 and the @xmath356 edge of @xmath348 by @xmath357 . then @xmath358 .",
    "each triangular face of @xmath348 has three sets of arcs pairing points of @xmath119 $ ] , with one set running between each pair of edges of the face .",
    "to each set of arcs we associate a pairing between the intervals at either end of the arcs , as in figure  [ pairings ] .",
    "all the pairings are orientation reversing in this example . in general",
    "some will be orientation preserving , as the edge orientations on any triangle can be arbitrary .",
    "normal arcs on a triangular face give three pairings of ordered intervals : @xmath359 \\to [ n_3 , n_3+r_{12}-1]$ ] , @xmath360 \\to [ n_5 , n_5+r_{23}-1]$ ] , and @xmath361 \\to [ n_1 , n_1+r_{13}-1]$ ] the normal curve coordinates associated to this face are @xmath362 and @xmath363 . in a normal surface , @xmath362 and @xmath363",
    "are each a sum of two normal coordinates . ]",
    "the number of connected components of @xmath349 is the same as the number of orbits of an action of a collection of pairings on @xmath364 , where two points are paired if they are connected by an edge of @xmath365 lying in a triangle .",
    "this is precisely the number returned by the orbit counting algorithm .",
    "the number of pairings is at most @xmath366 and the interval size is @xmath347 . applying theorem  [ orbitcount ]",
    ", we can determine the number of components of the normal curve @xmath349 in time polynomial in @xmath350 .",
    "a similar argument applies to normal surfaces .",
    "[ normalcount ] let @xmath4 be a 3-manifold with a triangulation @xmath348 containing @xmath5 tetrahedra and let @xmath113 be a normal surface in @xmath4 whose normal coordinates sum to @xmath347 .",
    "there is a procedure for counting the number of components of @xmath113 which runs in time polynomial in @xmath350 .",
    "[ [ proof.-12 ] ] * proof . *",
    "+ + + + + + + +    the 2-skeleton of @xmath348 contains at most @xmath367 faces and the 1-skeleton contains @xmath368 edges .",
    "set @xmath106 to equal the weight @xmath347 of @xmath113 , the total number of points in which it intersects the 1-skeleton . order the edges of @xmath369 in an arbitrary way and label the intersections of @xmath113 and the @xmath354th edge of @xmath369 by @xmath355 .",
    "again we have @xmath358 .",
    "to a pair of edges on a triangular face of the 2-skeleton we associate a pairing between the intervals at either end of the corresponding set of arcs .",
    "there are at most three pairings for each face , and the number of faces is at most @xmath367 , so the number of pairings is bounded above by @xmath370 .",
    "these pairings are determined by the normal coordinates of @xmath113 .    for a normal surface ,",
    "the number of connected components of @xmath113 is the same as the number of components of @xmath371 , since every component of @xmath113 intersects the 1-skeleton of @xmath348 , and if two points on @xmath372 can be joined by a path then that path can be homotoped into the 2-skeleton of the triangulation .",
    "so the the number of components equals the number of orbits of @xmath373 under pairings that identify two points connected by an edge of @xmath371 contained in a face of the 2-skeleton .",
    "this number is precisely what is computed by the orbit counting algorithm .",
    "therefore we can determine the number of components of the normal surface @xmath113 in time polynomial in @xmath350 .",
    "* remark : * there is a motivating geometrical construction behind the combinatorics of the orbit counting algorithm which we informally explain",
    ". we can associate to each pairing @xmath122 \\to [ c_i , d_i]$ ] a pair of `` transmission towers '' in the upper half - plane , with one tower being the vertical line segment from @xmath374 to @xmath375 and the other the vertical segment from @xmath376 to @xmath377 .",
    "these towers capture the information contained in the pairings .",
    "points in the domain and range of a pairing beam up to the tower leftward at a 45 degree angle , then beam to the paired tower ( either straight across , if the pairing preserves orientation , or crossing if not ) then down again .",
    "assign a `` cost '' to each transmission tower equal to the hyperbolic length in the upper half space model from @xmath378 to the top of the tower .",
    "this cost equals @xmath379 , and the sum of all these costs is essentially the logarithm of the complexity @xmath84 used above .",
    "the counting algorithm starts with a euclidean line emerging from the right endpoint of a @xmath279-close interval and going upward at a 45 degree angle .",
    "in hyperbolic terms , this is an equidistant curve from the geodesic from the right endpoint to the point at infinity .",
    "initially , we may assume that this sweep line hits the top of at least one transmission tower .",
    "we make the highest of these the @xmath279-close tower , and use it to beam all the other towers to its paired interval .",
    "if the two domains overlap , we use the highest power of the transmission that can be applied .",
    "eventually the triangle between the current tower and the sweep line is vacant .",
    "we sweep leftward with this equidistant curve .",
    "as long as the sweep line hits only one tower , we truncate it .",
    "consider a second equidistant curve @xmath380 through a point @xmath190 on @xmath381 , with slope -1/2 .",
    "the hyperbolic distance between the slope -1 and slope -1/2 lines is a constant equal to about 0.49 .",
    "call the region between these two lines a _",
    "zone_. if two paired towers have their tops in a single zone , their domains overlap . if no towers are completely truncated away between the time when the sweep line hits a point @xmath190 and when there are no towers intersecting the zone above @xmath380 , each equidistant curve between the two given ones hits a transmission tower based at a point that will be removed by truncation .",
    "so in this time either the number of towers has decreased or the sum of all the tower costs has decreased by at least 0.49 .",
    "if we merge transmission towers when possible , a complexity based on the cost decreases sufficiently fast to give a polynomial time algorithm .",
    "the calculations in theorem  [ orbitcount ] implemented this geometric picture .",
    "in this section we establish that 3-manifold knot genus is * np*.    * proof of theorem  [ thmgnp ] : * we begin with a simplicial complex consisting of @xmath5 tetrahedra whose faces are identified in pairs , and a collection @xmath3 of edges in the 1-skeleton of this complex . while there are alternate formats in which a knot and a 3-manifold may be presented , all reasonable ones appear to be transformable to one another in polynomial time .    in time",
    "polynomial in @xmath5 we can check that the link of each vertex is connected and has euler characteristic two , which means that it is a sphere , and that the link of each edge is a connected curve .",
    "these are the necessary conditions to ensure that the underlying space of the complex is a 3-manifold @xmath4 .",
    "similarly we can check in time polynomial in @xmath5 that the edges of @xmath3 form a simple closed curve in @xmath4 , and that this curve represents a trivial element of the first homology group of @xmath4 with integer coefficients .",
    "we then form the second barycentric subdivision of the triangulation of @xmath4 , replacing each tetrahedron by 576 tetrahedra . removing all closed tetrahedra that meet @xmath3 results in a 3-manifold @xmath382 with a single torus boundary component , the `` peripheral torus '' that surrounds the knot @xmath3 .",
    "the knot @xmath3 bounds a surface of genus @xmath0 in @xmath4 if and only if there is a surface in @xmath382 of genus @xmath0 with a single boundary component that is an essential curve on @xmath383 .",
    "we restate our problem in the triangulated manifold @xmath382 as the question of whether there exists in @xmath382 an orientable surface of genus @xmath0 with a single essential boundary component on @xmath383 . by schubert",
    "@xcite , if such a surface exists , then such a surface exists among the fundamental normal surfaces in @xmath382 .",
    "the certificate consists of an integer vector @xmath384 in @xmath385 giving the normal surface coordinates of this surface .",
    "recall that not all vectors in @xmath385 correspond to normal surfaces .",
    "it is necessary that @xmath384 satisfies the matching , positivity and quadrilateral conditions .",
    "these conditions can be checked in time which is linear in @xmath386 .",
    "so we can verify that there is a normal surface @xmath113 with @xmath387 .    to verify that @xmath388 is essential on the peripheral torus , we include in the certificate a non - trivial cycle in the 1-skeleton of @xmath383 that intersects @xmath388 in an odd number of points .",
    "such a cycle can be found in the 1-skeleton of @xmath383 , since curves embedded in the 1-skeleton generate its first homology .",
    "odd intersections with such a cycle implies that @xmath388 is non - separating on @xmath383 , and in particular does not bound a disk on @xmath383 , ensuring that @xmath388 corresponds to a longitude curve parallel to @xmath3 in @xmath389 . using the orbit counting algorithm",
    ", we can count the number of components of the normal surface @xmath113 and verify that @xmath113 is connected in time polynomial in @xmath350 , where @xmath347 is the weight of @xmath113 the number of points in which @xmath113 meets the 1-skeleton of @xmath382 .",
    "we apply corollary  [ normalcount ] to verify that @xmath388 is connected in time bounded by a polynomial in @xmath350 .",
    "( this last step can be avoided .",
    "the number of essential boundary components must be odd , since @xmath388 represents a non - trivial element in @xmath390 , and an even number of them can be removed by joining adjacent pairs of curves with annuli on @xmath383 .",
    "this gives a surface with one boundary component and the same euler characteristic .",
    "inessential boundary curves can be capped while increasing euler characteristic , which gives lower genus . )",
    "to check that @xmath113 is orientable , we take the vector @xmath391 that doubles each coordinate of the normal surface @xmath113 , and apply the orbit counting algorithm to determine if the corresponding normal surface @xmath392 is connected .",
    "since @xmath4 is orientable , @xmath392 is connected if @xmath113 is connected and non - orientable , and has two components if @xmath113 is connected and orientable .",
    "thus we can verify if @xmath113 is orientable in time which is linear in @xmath350 .",
    "the euler characteristic @xmath393 is determined by the number of vertices , edges and faces of @xmath113 , which are computable from its normal coordinates in time which is linear in @xmath5 .",
    "following @xcite , we let @xmath394 be the number of tetrahedra containing edge @xmath395 and set @xmath396 if the edge @xmath395 meets the @xmath69 normal disk . then",
    "the normal surface @xmath113 with coordinates @xmath397 has @xmath398 where @xmath399 and @xmath400 .",
    "the values of @xmath401 are determined by the triangulation and are independent of @xmath113 .",
    "they can be computed in time polynomial in @xmath5 . since @xmath113 is a connected orientable surface with one boundary component the genus of @xmath113",
    "is @xmath402 .",
    "thus we can determine the genus of @xmath113 in time which is linear in @xmath386 .",
    "theorem  [ bound ] implies that the normal coordinates of this surface are at most @xmath403 .",
    "there are @xmath404 normal coordinates , and each represents a triangle or quadrilateral , so that the total number of intersections with the 1-skeleton satisfies @xmath405 .",
    "in particular , @xmath406 is bounded above by a polynomial in @xmath5 . so the fact that @xmath113 is a spanning surface for @xmath3 can be verified in time polynomial in @xmath5 .",
    "in this section we develop a generalized version of the orbit counting algorithm , that counts not only the number of orbits of a collection of isometries between subintervals of an interval , but also more general quantities which are useful in applications .",
    "for example , we can use the extended algorithm to answer the following question : given a normal surface and a triangulation , how many times does each component of the surface intersect a fixed edged of the triangulation ?",
    "the extended algorithm allows one to effectively compute the normal coordinates and the euler characteristic of each connected component of the surface , hence the genus , even when there are exponentially many components . to carry out such computations ,",
    "we extend the previous analysis to pairings of weighted intervals , in which each point of the interval has associated to it a vector in @xmath407 .",
    "we are interested in the sum of these vectors over an orbit , the orbit weights .",
    "consider again a pseudogroup of interval isometries acting on @xmath408 $ ] .",
    "we will assume that there is given as input a nonnegative weight function @xmath409 \\to { { \\mathbb{z}}}_+d $ ] , associating to each element of @xmath408 $ ] a vector in @xmath410 satisfying the following condition : the weight at successive points @xmath354 and @xmath411 changes at most @xmath412 times . in our application , @xmath118 will be the initial number of pairings , and @xmath412 gives an upper bound on how many times an endpoint of a domain or range of a pairing is reached as one moves across @xmath408 $ ] .",
    "the algorithm proceeds as before , while maintaining data on the orbit weights .",
    "we keep track of the orbit weights by maintaining two lists of weighted subintervals .",
    "the first @xmath413,z_1),\\dots,([p_m , q_m],z_m)\\},\\   1 \\le p_i \\le q_i < p_{i+1}\\ ] ] records the current weight values at each point in @xmath119 $ ] , with @xmath414 initially equal to @xmath106 .",
    "this list is updated as the algorithm proceeds .",
    "points in the interval @xmath415 $ ] have constant weight @xmath416 , and there are at most @xmath412 such intervals .",
    "a second list of @xmath5 subintervals @xmath417,v_1),\\dots,([r_t , s_t],v_t)\\ } , \\ 1 \\le r_i \\le s_i < r_{i+1}\\ ] ] consists of a collection of intervals @xmath418 $ ] paired with a vector @xmath419 .",
    "this pair represents @xmath420 orbits , one for each point in the interval @xmath418 $ ] , and to each of these orbits is assigned the orbit weight @xmath421 .",
    "initially empty , at the algorithm s conclusion @xmath422 records the total number of orbits @xmath423 , along with the orbit weight @xmath421 assigned to each of the @xmath420 orbits in the interval @xmath424 $ ] .",
    "we define an additional operation , called _ transferring weights by a pairing @xmath0_. suppose that @xmath137\\to [ c , d]$ ] is a pairing and that @xmath425 $ ] carries @xmath97 different weights , given by the list @xmath426,v_1),\\dots,([r_n , s_n = d],v_n)\\ } , \\",
    "1 \\le r_i \\le s_i < r_{i+1 } .\\ ] ] the weight function can be split into constant functions on @xmath97 subintervals of @xmath425 $ ] , where @xmath427 .",
    "the transfer operation sets the weights on @xmath425 $ ] to zero and keeps the orbit weights the same by translating the weight vectors of @xmath425 $ ] to smaller orbit representatives , as below :    case 1 : @xmath0 is orientation preserving and @xmath209 .",
    "set the weights on @xmath425 $ ] to zero and for each @xmath428 , add @xmath429 to @xmath430)$ ] .",
    "case 2 : @xmath0 is orientation preserving and @xmath431 .",
    "then @xmath137 \\to [ c , d]$ ] is a periodic pairing of period @xmath432 .",
    "we set the weights of points in @xmath433 $ ] to zero and adjust weights in @xmath434 $ ] to preserve the orbit weight .",
    "the points in @xmath433 $ ] have weights given by the intersection of @xmath433 $ ] with intervals in @xmath435 .",
    "these weights are described by @xmath426,v_1),\\dots,([r_n , s_n = d],v_n)\\ } , \\ 1 \\le r_i \\le s_i < r_{i+1 } .\\ ] ] for each interval @xmath436,v_j),\\ 1 \\le j \\le n$ ] , of width @xmath437 and constant weight @xmath429 , add @xmath438v_j $ ] to the weight of each point in @xmath439 $ ] , and add an additional @xmath429 to the weight of each point in @xmath439 $ ] that is congruent mod@xmath440 to a point in @xmath441t , s_j]$ ] , if any such point exists .",
    "case 3 : @xmath0 is orientation reversing .",
    "we first trim @xmath0 .",
    "this does not affect the orbits or the orbit weights .",
    "for a trimmed , orientation reversing pairing @xmath137 \\to [ c , d]$ ] , set the weights on @xmath425 $ ] to zero and for each @xmath428 add @xmath429 to @xmath430)$ ] .",
    "[ orbitweights.same ] the operation of transfer sets the weights on @xmath433 $ ] to zero and preserves the orbit weights of a collection of pairings . the number of distinct weights taken by the weight function on @xmath119 $ ] increases by at most four following a transfer operation .",
    "[ [ proof.-13 ] ] * proof . * + + + + + + + +    in cases ( 1 ) and ( 3 ) , the decrease in the weight function at one point @xmath190 in an orbit is exactly offset by an equal increase at the point @xmath442 in the same orbit .    in case ( 2 ) , each point in @xmath443 $ ] is in the orbit of a unique point in @xmath444 = [ a , c-1]$ ] under the iterates of @xmath0 . the total weight of an orbit within a periodic pairing is transferred to the orbit representative in this initial subinterval by applying powers of @xmath0 .",
    "adding weight @xmath429 to an orbit representative in @xmath439 $ ] of each point in @xmath445 while setting the weight at that point to zero , preserves the orbit weight .",
    "the resulting weights on @xmath439 $ ] are gotten by adding appropriate multiples of @xmath429 , with the factor being the number of orbits of a point in @xmath439 $ ] that lie in @xmath446 $ ] . the number of orbits under @xmath0 of a point in @xmath434 $ ] that lie in @xmath446 $ ] is @xmath447 $ ] or one more than this for points",
    "whose orbit hits the last @xmath448 points of @xmath446 $ ] .",
    "it follows that the transfer operation in case ( 2 ) preserves the number of orbits and the orbit weight .",
    "setting the weights on @xmath131 $ ] to zero can cause at most two new points where a weight change occurs .",
    "the transferred weights from a constant weight interval @xmath449 $ ] result in a net increase of at most two pairs of successive points where the weight changes , at the preimages of its two endpoints . in",
    "cases ( 1 ) and ( 3 ) , transferred weights from an interval with non - constant weights results in an increase in the number of weight changes in the domain of @xmath0 .",
    "the increase in the number of weight changes in the domain is exactly canceled by the decrease in the number of weight changes in the range of @xmath0 , except possibly for two extra weight changes at the boundary points @xmath450 of the domain . in case",
    "( 2 ) the same holds , but with @xmath439 $ ] replacing the domain . in each case",
    "the number of constant weight intervals @xmath451 is increased by at most four during a transfer operation .",
    "we now describe the modified algorithm .",
    "again @xmath198 represents the current interval length , and we set @xmath451 to be the current number of constant weight intervals .",
    "+ * weighted orbit counting algorithm : * let @xmath452 \\to [ c_i , d_i],\\   1 \\le i \\le k \\}$ ] be a collection of pairings between subintervals of @xmath453 , and let @xmath413,z_1),\\dots,([p_m , q_m],z_m)\\ } , \\",
    "1 \\le p_i \\le q_i < p_{i+1 } \\le   n\\ ] ] be a list representing a collection of weights on @xmath119 $ ] , with the weight on @xmath454 $ ] equal to @xmath455 .",
    "initialize a second weight list @xmath422 to be empty .",
    "the algorithm proceeds as before , reducing the interval size @xmath106 until it reaches zero , but this time keeping track of orbit weights by maintaining the lists @xmath456 .    1 .",
    "search through the pairings and delete any pairings which are restrictions of the identity . leave the weight lists @xmath456 unchanged .",
    "2 .   search for and contract static intervals .",
    "if the interval @xmath187 $ ] is contracted , has constant weight @xmath253 , and is not contained in a larger contracted interval with the same weight @xmath253 , add an interval @xmath457 , z)$ ] of width @xmath193 to the end of @xmath422 , with associated weight @xmath253 . alter @xmath435 by replacing @xmath202 $ ] by @xmath458 $ ] , and altering each @xmath241 by replacing any point @xmath190 in the domain or range of @xmath241 with @xmath459 by @xmath192 .",
    "replace the weight function by a new weight function @xmath460 , which at points @xmath459 satisfies @xmath461 and agrees with @xmath462 at points @xmath463 .",
    "3 .   trim all orientation reversing pairings whose domain and range overlap . leave the weight lists @xmath456 unchanged .",
    "4 .   search for pairs of periodic pairings @xmath241 and @xmath189 whose domains and ranges satisfy the condition of lemma  [ merge2 ] . if any such pair exists then perform a merger as in lemma  [ merge2 ] , replacing @xmath241 and @xmath189 by a single periodic pairing , with translation distance @xmath269 , acting on the union of the domains and ranges of @xmath241 and @xmath189 .",
    "leave the weight lists @xmath456 unchanged .",
    "repeat until not mergers can be performed .",
    "5 .   find a maximal @xmath241 .",
    "for each @xmath189 with @xmath464 , if the range of @xmath189 is contained in @xmath271 $ ] , transmit @xmath189 by @xmath241 .",
    "leave the weight lists @xmath456 unchanged .",
    "6 .   find the smallest value of @xmath6 such that the interval @xmath213 $ ] intersects the range of at most one pairing @xmath241 , with @xmath122 \\to [ c_i , n']$ ] .",
    "transfer the weights on @xmath271 $ ] by @xmath241 , and then truncate the pairing @xmath241 .",
    "if the interval size @xmath198 has decreased to zero , output the list @xmath422 and stop .",
    "otherwise start again with step ( 1 ) .    for a @xmath465-valued function on",
    "@xmath466 $ ] whose values are given by the list @xmath467,z_1),\\dots,([p_m , q_m],z_m)\\ } , \\",
    "1 \\le p_i \\le q_i < p_{i+1}$ ] , define the _ total weight _ of @xmath435 to be @xmath468 .",
    "[ weightedcount ] suppose there is a pseudogroup generated by @xmath118 pairings with @xmath465-valued weights , @xmath272 on @xmath119 $ ] such that there is a partition of @xmath119 $ ] into @xmath101 disjoint subintervals in which the weights are constant , and such that the total weight is at most @xmath469 .",
    "then the weighted orbit counting algorithm outputs a list with one point for each orbit and corresponding orbit weights , and runs in time polynomial in @xmath470 .",
    "[ [ proof.-14 ] ] * proof . *",
    "+ + + + + + + +    we will check that the running time of the algorithm is larger than that of the previous unweighted version by a factor which is a polynomial in @xmath471 .",
    "the proof that the algorithm terminates is the same as that given for theorem  [ orbitcount ] .",
    "there is some extra overhead involved in keeping track of weights that modifies the calculation of the running time .",
    "we indicate these additional calculations below .",
    "we now check that at each step in the algorithm the orbit weight is unchanged for any orbit remaining in @xmath435 , and that eliminated orbits have their orbit weights correctly recorded in @xmath422 .    as we run through the steps of the algorithm , steps ( 1),(3),(4),(5 ) and ( 7 )",
    "preserve the orbit structure , the weight function and the interval @xmath202 $ ] , so neither of the lists @xmath456 are changed .",
    "the number of constant weight sub - intervals is also unchanged .",
    "step ( 2 ) , contraction , does change the orbit structure , and also shortens @xmath202 $ ] . in step ( 2 )",
    "the procedure adds the eliminated orbits and their weights to @xmath422 .",
    "the number of constant weight intervals is not increased , and may be decreased .",
    "maintaining the two lists requires at most @xmath472 additional steps .    in step ( 6 ) , truncation",
    ", points are eliminated from the end of the interval @xmath202 $ ] .",
    "however since we first transfer the weights of these points , the eliminated points all have weight zero and the weight of an orbit is unaffected .",
    "the number of steps involved in resetting the weights in @xmath435 for a transfer operation is given by a polynomial in @xmath473 .",
    "since @xmath451 increases by at most four at each of the polynomially many steps of the algorithm , @xmath451 is bounded by a polynomial in @xmath474 .",
    "combining the running time of each of the steps , whose number is given by a polynomial in @xmath475 , gives a polynomial in @xmath470 for the total running time .",
    "[ eulercount ] let @xmath4 be a 3-manifold with a triangulation @xmath348 containing @xmath5 tetrahedra and let @xmath113 be a normal surface in @xmath4 of total weight @xmath347 .",
    "there is a procedure for counting the number of components of @xmath113 and determining the topology of each component which runs in time polynomial in @xmath350 .",
    "[ [ proof.-15 ] ] * proof . *",
    "+ + + + + + + +    we begin as in corollary  [ normalcount ] by assigning an integer in @xmath119 $ ] to each point of intersection between the normal surface and an edge of the triangulation , where @xmath106 is the total number of intersections of @xmath113 with the 1-skeleton , and again associate three pairings to each face of the triangulation , one to each pair of edges in the face .",
    "the number of pairings that results is bounded above by @xmath370 .",
    "we next define a weight function @xmath476 which assigns integer weights @xmath477 to each point in @xmath119 $ ] .",
    "initially @xmath478 is set to zero for all @xmath63 at all points @xmath479 $ ] .",
    "a tetrahedron can have as many as five distinct elementary disk types with non - zero coefficients , four triangles and one quadrilateral .",
    "if the @xmath69 elementary disk type occurs , then fix one of the edges that it meets , and add @xmath480 to the @xmath69 component of the weight vector at each of the indices that the @xmath69 elementary disk meets on that edge .",
    "the orbit weights are then the normal coordinates of the components of the normal surface @xmath113 .",
    "each point in the output list @xmath422 corresponds to a component of the normal surface with normal coordinates given by the corresponding weight in @xmath481 .",
    "theorem  [ weightedcount ] tells us that the list @xmath422 is computed in time polynomial in @xmath470 .",
    "we now bound these constants in terms of @xmath5 .",
    "since each edge of a tetrahedron meets at most three disk types in that tetrahedron , each edge of a tetrahedron can contribute at most six points at which the weight vector changes .",
    "given six edges to each tetrahedron , we have @xmath482 . as before we have a bound for the number of pairings @xmath483 and the number of normal coordinates is given by @xmath484 .",
    "the total weight bounds the normal coordinates , and with @xmath485 we get a bound on the running time that is polynomial in @xmath350 .",
    "let @xmath4 be a 3-manifold with a triangulation @xmath348 containing @xmath5 tetrahedra and let @xmath113 be a fundamental normal surface in @xmath4 .",
    "there is a procedure for counting the number of components of @xmath113 and the topology of each component which runs in time polynomial in @xmath5 .",
    "[ [ proof.-16 ] ] * proof . * + + + + + + + +    theorem  [ bound ] gives a bound for the normal coordinates of @xmath113 of @xmath403 .",
    "recall that there are @xmath404 normal coordinates , and each represents a triangle or quadrilateral , so the total number of intersections with the 1-skeleton satisfies @xmath486 . in particular",
    ", @xmath487 is bounded above by a polynomial in @xmath5 . plugging this in for @xmath347 in corollary  [ eulercount ] we get a bound for the running time which is a polynomial in @xmath5 .",
    "in this section we examine the complexity of the problem of determining the smallest area of a spanning surface for a curve in a 3-dimensional manifold .",
    "such an area calculation problem seems at first to be ill suited to a complexity analysis , since it has real solutions depending on a choice of riemannian metric .",
    "we recast the area calculation problem into a discretized form where its complexity can be analyzed .",
    "given a curve in a suitably discretized riemannian 3-manifold , we ask whether it bounds a surface of area less than @xmath1 , where @xmath1 is an integer . to describe a metric on a 3-manifold with a finite amount of data",
    ", we restrict to piecewise flat metrics , and manifolds constructed from collections of flat tetrahedra and triangular prisms whose faces are identified by isometries .",
    "the curvature of such pl metrics can be defined as a limit of smooth curvatures , and is concentrated along their edges and vertices .",
    "a particular manifold in this class is described by a decomposition into tetrahedra or triangular prisms with a rational ( or integer ) length assigned to each edge .",
    "the metric on this tetrahedron or prism is then taken as the metric on the euclidean tetrahedron or prism with those edge lengths . in the case of a prism",
    "we also set the angles of quadrilateral faces to be right angles .",
    "prisms are allowed in this construction in order to form metrics with rational lengths on spaces that are products . identified 2-dimensional faces",
    "are required to be isometric .",
    "we do not require that the total angle around an edge is @xmath488 , nor do we make any metric conditions at a vertex .",
    "this type of metric is described by a finite set of data , and can be used to approximate riemannian metrics on a manifold . up",
    "to scaling , we can take all the edge lengths to be integers .",
    "we call these objects _ metrized pl 3-manifolds_. a curve is given as a collection of edges in the 1-skeleton of @xmath4",
    ". we will show that given an integer @xmath1 , determining whether the smallest spanning surface for a curve in such a 3-manifold has area less than @xmath1 is * np*-hard .",
    "_ problem : _ minimal - spanning - area + _ instance : _ a 3-dimensional metrized pl manifold @xmath4 , a 1-dimensional + curve @xmath3 in the 1-skeleton of @xmath4 , and a natural number @xmath1 .",
    "+ _ question : _ does the curve bound a surface of area @xmath489 ?",
    "the size of an instance is given by the number of bits needed to describe all the edge lengths and @xmath1 .",
    "[ nphard ] minimal - spanning - area is * np*-hard .",
    "[ [ proof.-17 ] ] * proof . * + + + + + + + +    we reduce in polynomial time an instance of the * np*-hard problem one - in - three sat to an instance of minimal - spanning - area .",
    "this shows that minimal - spanning - area is at least as hard , up to polynomial time reduction , as one - in - three sat .    as a first step",
    ", we set up a 2-dimensional version of minimal - spanning - area .",
    "we then construct a 3-manifold by a thickening process , with the property that a minimizing surface must remain within the 2-complex .",
    "given a boolean expression representing an instance of one - in - three sat , we construct a triangulated metrized 2-complex and an integer @xmath1 .",
    "this complex contains a curve @xmath3 with the property that the expression admits a satisfying assignment if and only if @xmath3 bounds a surface of area less than @xmath1 .",
    "this metrized complex is shown in figure  [ metrized ] for the expression @xmath490 .    .",
    "the picture is not to scale .",
    "the shaded prisms are constructed to each have area one , while the rest of the surface has total area less than 1/2 . ]",
    "the branching surface is similar to the one used in the proof of theorem  [ thmnph ] , but carries the additional structure of a metrized triangulation , whose triangles have flat metrics of prescribed edge length .",
    "the metrized triangles are constructed so that near each of the @xmath101 boundary components corresponding to clauses of the boolean expression there are three triangulated disks of area close to one , one on each of the three handles coming into the punctured sphere near the boundary component .",
    "these disks are shaded in figure  [ metrized ] .",
    "each of these shaded disks is chosen to have area between 1 and @xmath491 .",
    "the surface is constructed so that the union of all triangles in the rest of the surface has total area less than 1/2 .",
    "we saw in theorem  [ thmnph ] that a spanning surface which has minimal genus goes over each of the shaded disks at most once and goes over exactly one shaded disk for each of the @xmath101 clauses .",
    "it follows that such a surface has total area @xmath492 .",
    "furthermore , a satisfying assignment for one - in - three sat leads to an embedded spanning surface , with the satisfying values of the variables selecting branches of the surface , and such a spanning surface has area less than @xmath493 .",
    "so an instance of one - in - three sat can be reduced to an instance of minimal - spanning - area for this 2-complex .    to pass to a 3-manifold , thicken each triangle in the branching surface to a triangular prism , triangulated as in the proof of theorem  [ thmnph ] , and with a product metric .",
    "this produces a 3-manifold @xmath4 which is a thickened up version of the 2-complex .",
    "projection to the branching surface is area non - increasing , and area decreasing for a surface with boundary on the branching surface but not contained in it .",
    "therefore a least area surface spanning @xmath3 must lie on the branching surface .",
    "a closed manifold @xmath494 with a piecewise - smooth metric can be obtained by a doubling construction as in theorem  [ thmnph ] .",
    "the doubling involution is an isometry , so that reflecting a surface meeting @xmath495 into @xmath4 does not increase area .",
    "it follows that the embedded spanning surface on the branching surface is a least area surface in @xmath494 .",
    "among many unresolved questions are :      \\2 . is determining the genus of a knot in a 3-manifold * np * ? this amounts to showing that finding a lower bound to the knot s genus is an * np * problem , in contrast to the upper bound we have investigated .",
    "recall that the genus of a knot is the least possible genus of all spanning surfaces .",
    "we have shown that certifying that the genus is at most @xmath0 is * np * , but left open the possibility that the genus may be smaller than @xmath0 .",
    "if the answer to this question is yes , then we can certify that a non - trivial knot has positive genus , and it would follow that unknotting is both * np * and * conp*.    99 m. dehn , `` uber die topologie des dreidimensional raumes '' , _ math .",
    "annalen _ , 69 ( 1910 ) , 137168 .",
    "garey and d.s .",
    "johnson , `` computers and intractability .",
    "a guide to the theory of * np*-completeness '' , w. h. freeman and co. , san francisco , 1979 .",
    "w. haken , `` theorie der normalflchen : ein isotopiekriterium fr den kreisknoten '' , _ acta math .",
    "_ , 105 ( 1961 ) 245375 . j. hass , `` algorithms for recognizing knots and 3-manifolds '' , _ chaos , solitons and fractals",
    "_ , 9 ( 1998 ) 569581",
    ". j. hass , j. c. lagarias and n. pippenger , `` the computational complexity of knot and link problems '' , _ journal of the acm _ , 46 ( 1999 ) 185211",
    ". j. hass and j. c. lagarias , `` the number of reidemeister moves needed for unknotting '' , _ j. amer",
    "_ 14 ( 2001 ) , no .",
    "2 , 399428 g. hemion , _ the classification of knots and @xmath496-dimensional spaces _ , oxford university press , 1992 . j. hempel , _",
    "3-manifolds _ , princeton university press , princeton , nj 1976 .",
    "w. jaco , _ lectures on three - manifold topology _ , cbms regional conference series in mathematics , 43 ams , providence , ri , 1980 .",
    "w. jaco and u. oertel , `` an algorithm to decide if a @xmath496-manifold is a haken manifold '' , _ topology _ , 23 ( 1984 ) 195209 .",
    "w. jaco and j. l. tollefson , `` algorithms for the complete decomposition of a closed @xmath496-manifold '' , _",
    "illinois j. math .",
    "_ , 39 ( 1995 ) 358406 .",
    "w. jaco and j. h. rubinstein , `` pl equivariant surgery and invariant decompositions of @xmath496-manifolds '' , _ advances in math .",
    "_ , 73 ( 1989 ) 149191 . f. jaeger , d. l. vertigan and d. j. a. welsh , `` on the computational complexity of the jones and tutte polynomials '' , _ math .",
    "cambridge phil .",
    "_ , 108 ( 1990 ) 3553",
    ". h. kneser , `` geschlossene flchen in dreidimensionalen mannigfaltigkeiten '' , _ jahresbericht math .",
    "_ , 28 ( 1929 ) 248260 .",
    "e. e. moise , `` affine structures in @xmath496-manifolds , v : the triangulation theorem and hauptvermutung '' , _ ann .",
    "_ , 56 ( 1952 ) 96114 .",
    "papadimitriou , computational complexity .",
    "addison - wesley publishing company , reading , ma , 1994 .",
    "m. o. rabin , `` recursive unsolvability of group - theoretic problems '' , _ ann .",
    "_ , 67 ( 1958 ) 172194 .",
    "rubinstein , `` an algorithm to recognize the @xmath496-sphere '' , _ proceedings of the international congress of mathematicians _ , vol . 1 , 2 ( zurich , 1994 ) , birkhauser , basel , 601611 .",
    "schaefer , t.j .",
    "`` the complexity of satisfiability problems '' , _ proc 10th ann .",
    "symp . on theory of computing _ ,",
    "acm , ny , ( 1978 ) 216 - 226 .",
    "a. schrijver , _ theory of linear and integer programming _",
    ", john wiley and sons , 1986 .",
    "h. schubert , `` bestimmung der primfaktorzerlegung von verkettungen '' , _ math .",
    "_ , 76 ( 1961 ) 116148 .",
    "a. seb , `` hilbert bases , caratheodory s theorem and combinatorial optimization '' , in : r.  kannan and w.  r. pulleyblank ( eds . ) , _ integer programming and combinatorial optimization _ ,",
    "university of waterloo press , 1990 , pp .",
    ". h. seifert , `` ber das geschlecht von knoten '' , _ math .",
    "annalen _ , 110 ( 1935 ) 571592 .",
    "a. thompson , thin position and the recognition problem for @xmath14 .",
    "lett . 1 ( 1994 )",
    ", 613630 .",
    "d. j. a. welsh , _ complexity : knots , colourings and counting _ , cambridge university press , 1993 .",
    "d. j. a. welsh , `` the complexity of knots '' , _ ann .",
    "discr . math .",
    "_ , 55 ( 1993 ) 159173 .",
    "d. j. a. welsh , `` knots and braids '' , _ contemp .",
    "_ , 147 ( 1993 ) 109123 ."
  ],
  "abstract_text": [
    "<S> we show that the problem of deciding whether a polygonal knot in a closed three - dimensional manifold bounds a surface of genus at most @xmath0 , is * np*-complete . we also show that the problem of deciding whether a curve in a pl manifold bounds a surface of area less than a given constant @xmath1 is * np*-hard . </S>"
  ]
}