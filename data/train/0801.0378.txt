{
  "article_text": [
    "many - electron wave functions may be accurately and compactly approximated by a product of a small number of slater determinants and a positive jastrow correlation factor .",
    "the jastrow factor is an explicit function of the electron ",
    "electron separations , so that expectation values calculated with a slater ",
    "jastrow wave function do not separate in the electron coordinates .",
    "nevertheless , the variational and diffusion quantum monte carlo ( vmc and dmc ) methods permit the use of such explicitly correlated wave functions .    in vmc , expectation values",
    "are calculated using an approximate trial wave function , the integrals being performed by a monte carlo method . in dmc",
    "@xcite the imaginary - time schrdinger equation is used to evolve an ensemble of electronic configurations towards the ground state .",
    "the fermionic symmetry is maintained by the fixed - node approximation,@xcite in which the nodal surface of the wave function is constrained to equal that of a trial wave function .",
    "the dmc method gives the energy that would be obtained in a vmc calculation with the same slater determinants , but using the best possible jastrow factor .",
    "although the dmc energy is in principle independent of the jastrow factor , a poor trial wave function increases the statistical error bars and the time - step and population - control biases .",
    "when non - local pseudopotentials are used within dmc , the locality approximation  @xcite leads to additional errors which are second order in the error in the trial wave function.@xcite the expectation values of operators that do not commute with the hamiltonian are often evaluated using extrapolated estimation,@xcite the accuracy of the extrapolation depending on the quality of the trial wave function . in practice",
    "the efficiency and accuracy of both vmc and dmc calculations are critically dependent on the availability of high - quality jastrow factors .",
    "our jastrow factor is designed for use in atoms , molecules , and solids .",
    "we have used it in a variety of systems , and here we report results on the he , ne@xmath0 , ne , and ni atoms ; the nio and sih@xmath1 molecules ; and crystalline si in the diamond structure .",
    "these systems include all - electron and pseudopotential descriptions of atoms , with the total number of electrons varying from 2 to 216 .",
    "we pay particular attention to the issue of cutting off terms in the jastrow factor at finite ranges , which is desirable because of the local nature of the inhomogeneous correlations in many systems , as well as for reasons of computational efficiency in large systems .",
    "we obtained the values of the free parameters in our jastrow factors by minimizing the variance of the energy.@xcite all of our qmc calculations were performed using the casino package.@xcite we use hartree atomic units , @xmath2 , throughout this article .",
    "the rest of this paper is organized as follows . in sec .",
    "[ section : general_form ] we describe the general form of our jastrow factor , while in sec .",
    "[ section : cusp_conditions ] we show how the electron  electron and electron  nucleus cusp conditions  @xcite apply to this form .",
    "the behavior of the local energy at electron  electron and electron  nucleus coalescence points is discussed in sec .",
    "[ section : e_l_at_coalescence_pts ] .",
    "[ section : new_jastrow ] describes the jastrow factor in detail . in sec .",
    "[ section : further_comments ] we make further comments on the form of our jastrow factor , while in sec .",
    "[ section : specify_accuracy ] we define our notation for specifying the jastrow factor and give our criterion for judging its quality . in secs .",
    "[ section : he_ne][section : si ] we report the results of studies of various systems .",
    "finally , we draw our conclusions in sec .",
    "[ section : conclusions ] .",
    "the slater  jastrow wave function can be written as @xmath3 d(\\{{\\bf r}_i\\})\\;,\\ ] ] where @xmath4 and @xmath5 denote the electron and ion coordinates , respectively , @xmath6 $ ] is the jastrow factor , and @xmath7 denotes the slater part , which depends only implicitly on the @xmath5 .",
    "an accurate and efficient jastrow factor should possess a number of qualities .",
    "the functional form of the jastrow factor should be chosen to reflect the physics of the correlations in the system , and it should be parameterized efficiently .",
    "the trial wave function must be continuous everywhere and its gradient must be continuous wherever the potential is finite , so that the kinetic energy is well - defined .",
    "the kato cusp conditions  @xcite determine the behavior of the many - body wave function when two electrons , or an electron and a nucleus , are coincident .",
    "the cusp conditions derive from the requirement that the divergence in the local kinetic energy at a coalescence point cancels the divergence in the local potential energy .",
    "failure to satisfy the cusp conditions leads to divergences in the local energy @xmath8 , where @xmath9 is the hamiltonian .",
    "these divergences are especially harmful in dmc calculations , where they can lead to population - control problems and significant biases .",
    "it is standard practice to use the jastrow factor to enforce the cusp conditions .",
    "the slater part of the wave function is chosen to satisfy the correct symmetry under exchange of electrons , and therefore the jastrow factor should be symmetric under exchange . indeed the slater part of the wave function is normally chosen to have the correct symmetries of the state , so we should choose a jastrow factor that does not change this symmetry .",
    "finally , the jastrow factor should allow rapid evaluation , as this is one of the more computationally demanding parts of vmc and dmc calculations .",
    "our jastrow factor is the sum of homogeneous , isotropic electron ",
    "electron terms @xmath10 , isotropic electron  nucleus terms @xmath11 centered on the nuclei , isotropic electron  electron ",
    "nucleus terms @xmath12 , also centered on the nuclei and , in periodic systems , plane - wave expansions of electron  electron separation and electron position , @xmath13 and @xmath14 .",
    "the form is @xmath15 where @xmath16 is the number of electrons , @xmath17 is the number of ions , @xmath18 , and @xmath19 . note that @xmath10 , @xmath11 , @xmath12 , @xmath13 , and @xmath14 may also depend on the spins of @xmath20 and @xmath21 .",
    "although we will present results using spin - dependent parameters , for compactness the spin - type has been suppressed in all formulae .",
    "the basic form is not novel , as terms of each type present in eq .",
    "( [ eq : basic_j ] ) have appeared in jastrow factors in the literature,@xcite but our particular forms of @xmath10 , @xmath22 , and @xmath23 are new .",
    "the plane - wave term , @xmath13 , will describe similar sorts of correlation to the @xmath10 term . in periodic systems",
    "the @xmath10 term must be cut off at a distance less than or equal to the wigner ",
    "seitz radius of the simulation cell ( see sec",
    ".  [ section : jastrow_cutoffs ] ) and therefore the @xmath10 function includes electron pairs over less than three quarters of the simulation cell",
    ". the @xmath13 term adds variational freedom in the `` corners '' of the simulation cell , which could be important in small cells .",
    "the @xmath13 term can also describe anisotropic correlations , such as might be encountered in a layered compound .",
    "however , we expect that the @xmath10 term will be considerably more important than the @xmath13 term , which can not describe the electron ",
    "electron cusps and is therefore best limited to describing longer - ranged correlations .",
    "the @xmath14 term will describe similar electron ",
    "nucleus correlations to the @xmath22 terms .",
    "imposing the cusp conditions on the jastrow factor is non - trivial because the variables @xmath24 , @xmath25 , and @xmath26 are not independent .",
    "it is important to understand the meaning of the derivatives considered in this section . in eq .",
    "( [ eqn : par_kato_cusp ] ) , for example , the derivative @xmath27 means the derivative with respect to @xmath24 with all other coordinates held fixed , while in eq .",
    "( [ eqn : delta_psi ] ) the derivative @xmath28 means the derivative with respect to @xmath24 with @xmath29 and @xmath30 fixed .",
    "consider the situation where two electrons of opposite spin , @xmath20 and @xmath21 , approach one another and the wave function is non - zero at the two - particle coalescence point .",
    "this condition holds at almost all coalescence points of antiparallel - spin electrons .",
    "let us omit the coordinates of all the other electrons and write the wave function in terms of the center - of - mass and difference coordinates of electrons @xmath20 and @xmath21 , @xmath31 and @xmath32 .",
    "the cusp condition  @xcite is @xmath33 where @xmath34 is the spherical average of @xmath35 about the coalescence point .    neglecting the cuspless @xmath13 and @xmath14 terms , the slater ",
    "jastrow wave function may be written as @xmath36    d(\\bar{\\bf r}_{ij},{\\bf r}_{ij}),\\ ] ] where for clarity we have assumed there is only one nucleus , which is located at the origin . consider the change in the value of @xmath37 for a small displacement from the coalescence point such that the center of mass remains fixed : @xmath38_{r_{ij}=0 } \\delta r_{i } + \\left (    \\frac{\\partial j}{\\partial r_{ij } } \\right)_{r_{ij}=0 } r_{ij } \\right )    + \\exp[j_{r_{ij}=0 } ] \\left ( \\nabla_{ij } d \\right)_{r_{ij}=0 } \\cdot    { \\bf r}_{ij } + { \\cal o}(r_{ij}^2 ) , \\label{eqn : delta_psi}\\ ] ] where @xmath39 and @xmath40 are the changes in @xmath41 and @xmath42 when the electron separation @xmath43 is increased from zero , and we have used @xmath44 . if the spherical average about the coalescence point is taken then the terms involving @xmath45 and @xmath46 vanish to @xmath47 , so that @xmath48 hence the antiparallel cusp condition is equivalent to the requirement that @xmath49 where @xmath24 , @xmath29 , and @xmath30 are treated as independent variables .",
    "suppose now that the approaching electrons @xmath20 and @xmath21 have parallel spins .",
    "the cusp condition  @xcite is @xmath50 where @xmath51 is the @xmath52 component of @xmath37 , and @xmath53 is the @xmath54th spherical harmonic .",
    "let us expand @xmath37 about @xmath55 .",
    "@xmath7 is an odd function of @xmath46 ; hence we obtain @xmath56 \\left ( 1 + \\left ( \\frac{\\partial j}{\\partial r_{ij } } \\right)_{r_{ij}=0 } r_{ij } + \\left [ \\left ( \\frac{\\partial j}{\\partial r_i } \\right ) - \\left ( \\frac{\\partial j}{\\partial r_j } \\right ) \\right]_{r_{ij}=0 } \\delta r_i + { \\cal o}(r_{ij}^2 ) \\right ) \\times \\left ( \\left ( \\nabla_{ij } d \\right)_{r_{ij}=0 } \\cdot { \\bf r}_{ij } + { \\cal o}(r_{ij}^3 ) \\right).\\ ] ] the change in the electron  nucleus distance when the electron separation @xmath24 is increased from zero is @xmath57 , where @xmath58 is the angle between @xmath46 and @xmath41",
    ". the @xmath59 component of @xmath37 is therefore @xmath60 \\left [ \\left ( \\nabla_{ij } d \\right)_{r_{ij}=0 }",
    "\\cdot { \\bf r}_{ij } \\right]_{1 m } \\times \\left ( 1 + \\left ( \\frac{\\partial j}{\\partial r_{ij } } \\right)_{r_{ij}=0 } r_{ij } + { \\cal o}(r_{ij}^2 ) \\right),\\ ] ] where @xmath61_{1m}$ ] denotes the @xmath59 component of @xmath62 .",
    "so the parallel - spin cusp condition of eq .",
    "( [ eqn : cusp_cond_wf_par ] ) is equivalent to the requirement that @xmath63 where @xmath24 , @xmath29 , and @xmath30 are treated as independent variables .",
    "now consider the cusp condition that must be satisfied as electron @xmath20 approaches a nucleus of atomic number @xmath64 .",
    "the coordinates of all other electrons are omitted .",
    "the spherical average of @xmath65 about the nucleus , @xmath66 , must obey  @xcite @xmath67 by similar arguments to those given for the antiparallel electron ",
    "electron cusp condition , if the slater determinant is continuously differentiable at the nucleus then the jastrow factor must satisfy @xmath68 note that if the slater part of the wave function satisfies the electron ",
    "nucleus cusp condition , or if a non - divergent pseudopotential is used , then the jastrow factor is required to be cuspless at the nuclei : it should satisfy eq .",
    "( [ eqn : nucleus_cusp ] ) with @xmath69 .",
    "the slater  jastrow wave function in the vicinity of an antiparallel - spin coalescence point can be written as @xmath70 s({\\bf r}_{ij } ) , \\label{eqn : wf_fs}\\ ] ] where @xmath71 is the slater wave function multiplied by the terms in the jastrow factor that are analytic at the coalescence point and we have assumed there are no @xmath12 terms in the jastrow factor .    assuming that @xmath10 satisfies the kato cusp condition of eq .",
    "( [ eqn : antipar_ee_jastrow_cusp ] ) , the local energy can be shown to be @xmath72 where the @xmath73 and @xmath74 terms are continuous at the coalescence point .",
    "satisfying the cusp condition removes the divergence in the local energy at the coalescence point , irrespective of the angle at which the electrons approach .",
    "however , the @xmath75 term in eq .",
    "( [ eqn : el_at_antipar_cp ] ) _ does _ depend on the direction of approach .",
    "the local energy therefore has a point discontinuity at antiparallel - spin coalescence points .",
    "this behavior is illustrated in fig .",
    "[ fig : silane_el_antiparallel ] .",
    "there is a similar discontinuity in the local energy at nuclei when the electron  nucleus cusp condition is enforced . if , on the other hand , the no - cusp condition is enforced at the center of a pseudo - atom , there is no discontinuity in the local energy .    .",
    "the dotted line indicates the location of the stationary electron .",
    "[ fig : silane_el_antiparallel ] ]      now consider a parallel - spin coalescence point . again",
    "the wave function may be written in the form of eq .",
    "( [ eqn : wf_fs ] ) in the vicinity of the coalescence point , but this time @xmath71 is an odd function of @xmath46 . if the kato cusp condition of eq .",
    "( [ eqn : par_ee_jastrow_cusp ] ) is satisfied by @xmath10 , the local energy is @xmath76 the @xmath74 term is discontinuous at a parallel - spin coalescence point , giving a point discontinuity in the local energy . in spite of this ,",
    "the local energy is continuous when one electron is moved along a straight line through another of the same spin because of the symmetry of the local energy with respect to exchanges of parallel - spin electrons .",
    "this behavior is illustrated in fig .",
    "[ fig : silane_el_parallel ] .    .",
    "the dotted line indicates the location of the stationary electron .",
    "[ fig : silane_el_parallel ] ]      rassolov and chipman @xcite have demonstrated that , at the coalescence point of two antiparallel - spin electrons @xmath20 and @xmath21 , @xmath77 while for two parallel - spin electrons @xmath78    these cusp conditions are difficult to apply to slater ",
    "jastrow wave functions because eqs .",
    "( [ eqn : rassolov_antiparallel ] ) and ( [ eqn : rassolov_parallel ] ) involve the slater determinant as well as the jastrow factor . if we assume that @xmath79 , where @xmath80 is the spherical average of @xmath71 about an antiparallel - spin coalescence point , then we can derive an approximate condition on the antiparallel - spin @xmath10 term in the jastrow factor.@xcite likewise , if we assume that @xmath81 , where @xmath82 is the @xmath52 component of @xmath71 about a parallel - spin coalescence point , then we can derive an approximate condition on the parallel - spin @xmath10 term . imposing these additional conditions",
    "was not found to be of any benefit in practice .",
    "the rassolov ",
    "chipman conditions can be derived by demanding that @xmath83 and @xmath84 are cuspless at antiparallel- and parallel - spin coalescence points , respectively.@xcite there seems little point in attempting to apply the rassolov ",
    "chipman conditions unless one has already ensured that the local energy itself is continuous at coalescence points . a continuous local energy can be achieved in a two - electron atom by using a trial wave function based upon the fock expansion.@xcite however , it is unlikely that a practical method for eliminating the local - energy discontinuities in larger systems will be found .",
    "for the @xmath10 term we use an expression which is a variation on the form we have used for a number of years  @xcite and consists of a complete power expansion in @xmath24 up to order @xmath85 which satisfies the kato cusp conditions at @xmath86 , goes to zero at the cutoff length , @xmath87 , and has @xmath88 continuous derivatives at @xmath89 : @xmath90 r_{ij } + \\sum_{l=2}^{n_u } \\alpha_l r_{ij}^l \\right ) , \\label{eqn : u_defn}\\ ] ] where @xmath91 is the heaviside function and @xmath92 if electrons @xmath20 and @xmath21 have opposite spins and @xmath93 if @xmath20 and @xmath21 have the same spin . in this expression",
    "@xmath94 determines the behavior at the cutoff length . if @xmath95 , the gradient of @xmath10 is continuous but the second derivative and hence the local energy is discontinuous , and if @xmath96 then both the gradient of @xmath10 and the local energy are continuous .    the form of @xmath11 is similarly related to our earlier work , @xmath97 r_{ii } + \\sum_{m=2}^{n_\\chi } \\beta_{mi } r_{ii}^m \\right ) .",
    "\\label{eqn : chi_defn}\\ ] ] it may be assumed that @xmath98 where @xmath99 and @xmath100 are equivalent ions .",
    "the term involving the ionic charge @xmath101 enforces the electron ",
    "nucleus cusp condition .",
    "the expression for @xmath12 is the most general expansion of a function of @xmath24 , @xmath25 , and @xmath26 that is cuspless at the coalescence point and goes smoothly to zero when either @xmath25 or @xmath26 reach cutoff lengths : @xmath102 various restrictions are placed on @xmath103 . to ensure the jastrow factor is symmetric under electron exchanges we demand that @xmath104 @xmath105 .",
    "if ions @xmath99 and @xmath100 are equivalent then we demand that @xmath106 .",
    "the condition that the @xmath12 term has no electron ",
    "electron cusps is @xmath107 which implies that @xmath108 for all @xmath25 .",
    "hence , @xmath109 , we must have @xmath110 the condition that the @xmath12 term has no electron ",
    "nucleus cusps is @xmath111 which gives @xmath112 for all @xmath26 .",
    "we therefore require that , @xmath113 , @xmath114    the method by which we impose the various constraints is described in detail in appendix  [ appendix : constraints ] .",
    "the @xmath13 term takes the cuspless form @xmath115 where the @xmath116 are the reciprocal lattice vectors of the simulation cell belonging to the @xmath117th star of vectors that are equivalent under the full symmetry group of the bravais lattice , and `` @xmath118 '' means that , if @xmath119 is included in the sum , @xmath120 is excluded .    for systems with inversion symmetry",
    "the @xmath14 term takes the cuspless form @xmath121 where the @xmath122 are the reciprocal lattice vectors of the primitive unit cell belonging to the @xmath123th star of vectors that are equivalent under the space - group symmetry of the crystal , and the `` @xmath118 '' means that , if @xmath124 is included in the sum , @xmath125 is excluded . in this work",
    "@xmath14 has only been used for systems with inversion symmetry .",
    "plane - wave expansions of electron position can also be used for systems without inversion symmetry.@xcite      to avoid unwanted derivative discontinuities in the wave function of a periodic system , the isotropic functions @xmath10 , @xmath22 , and @xmath23 must be cut off at a distance less than or equal to the wigner ",
    "seitz radius of the simulation cell .",
    "furthermore , reasons of efficiency dictate that in particular @xmath23 should be cut off at short distances in both finite and periodic systems .",
    "suppose we wish to evaluate a slater ",
    "jastrow wave function for a number of systems of increasing size , where the number of electrons @xmath16 is assumed to be proportional to the number of ions , @xmath17 .",
    "if the cutoff lengths @xmath89 , @xmath126 , and @xmath127 are chosen to be proportional to the size of the system then the numbers of operations required to update @xmath10 and @xmath22 after each electron move are @xmath128 .",
    "the cost of updating the @xmath23 term is , however , proportional to @xmath129 , which is prohibitive in large systems .",
    "if we choose the cutoff lengths to be independent of the system size then each term can be updated in @xmath130 operations .",
    "the @xmath23 term describes inhomogeneous correlations that are spherically symmetric about atom @xmath99 .",
    "it does not seem likely that @xmath23 could describe the inhomogeneity in correlations at points distant from atom @xmath99 in systems with many atoms .",
    "similarly we argue that the long - ranged part of the spherically symmetric @xmath22 terms will not give useful variational freedom . for a fixed number of variable parameters",
    "we therefore expect that the best results will be obtained by cutting off the @xmath22 and @xmath23 terms at distances of roughly the size of atom @xmath99 , so that the variational freedom in these terms is concentrated at short distances where it is most useful .",
    "the @xmath10 term must describe both long- and short - ranged correlations and therefore we expect it to be long - ranged . in our implementation",
    "we allow the cutoff lengths @xmath89 , @xmath126 , and @xmath127 to be varied , and these degrees of freedom are investigated in secs .",
    "[ section : he_ne][section : si ] .",
    "in many cases the optimal value of @xmath89 is approximately proportional to the system size and the optimal values of @xmath126 and @xmath127 are approximately independent of the system size , so that overall the cost of updating the jastrow factor after each electron move scales as @xmath128 .    as mentioned earlier , the value of @xmath94 in eqs .",
    "( [ eqn : u_defn ] ) ,  ( [ eqn : chi_defn ] ) , and  ( [ eqn : f_defn ] ) determines the behavior of the jastrow factor , and hence the local energy , at the cutoff lengths .",
    "discontinuities in the local energy at the cutoff lengths may be harmful to optimization procedures , but the price paid for having a smoother local energy is a reduction in variational freedom .",
    "we have used power series in the inter - particle distances rather than scaled variables , such as @xmath131 , which have been used by boys and handy@xcite and others.@xcite these scaled variables go to a constant at large @xmath24 , which is useful in finite systems .",
    "however , it is not clear whether scaled variables are helpful when the @xmath10 , @xmath11 , and @xmath12 terms are cut off at finite lengths , as they must be in periodic systems .    in our previous jastrow factors",
    "@xcite we used chebyshev polynomials rather than the powers themselves .",
    "the ideas behind this were that ( i ) the chebyshev series may be calculated to very high accuracy with double - precision arithmetic using recurrence relations and ( ii ) the optimal coefficients tend to be of a more uniform magnitude , which could be helpful within optimization procedures .",
    "however , we have found that the precision offered by a simple power series with double - precision arithmetic is perfectly acceptable up to an order of at least 20 , and we have found no clear benefits from the use of chebyshev polynomials within our current optimization procedures either .",
    "we have therefore chosen to use simple power series , which may be evaluated more rapidly than the corresponding chebyshev series .",
    "our new jastrow factor includes terms such as @xmath132 , and @xmath133 , where @xmath134 and @xmath135 are polynomials , which are absent in the jastrow factors used by schmidt and moskowitz  @xcite and some other researchers .",
    "such terms do not in general satisfy the cusp conditions on their own , but certain linear combinations of them do and therefore they should be allowed to occur in the power series .",
    "the jastrow factors used by umrigar and coworkers  @xcite have included such terms for many years .",
    "we report tests of the importance of the terms neglected in the schmidt ",
    "moskowitz jastrow factor in sec .",
    "[ section : he_ne ] .    as an option within our implementation",
    "we may try to reduce the extent to which @xmath12 duplicates the @xmath10 and @xmath11 terms in the jastrow factor by imposing the conditions @xmath136 for all @xmath137 and @xmath138 for all @xmath139 .",
    "note , however , that the terms of @xmath12 with @xmath140 do not exactly correspond to @xmath10 : they are electron ",
    "electron terms local to ion @xmath99 . this variational freedom , which is investigated in sec .",
    "[ section : he_ne ] , may be used to describe correlations that occur on two different length scales , for example , in the core and valence electrons of an atom or the intra- and inter - atomic electron correlations of weakly interacting atoms .",
    "the terms of @xmath12 with @xmath141 are less likely to give useful variational freedom .",
    "however , the use of duplication of @xmath10 and @xmath11 by @xmath12 does not appear to cause any difficulties within our optimization procedure , even where @xmath142 .",
    "the variable parameters appear linearly in our jastrow factor , with the exception of the cutoff lengths , @xmath89 , @xmath143 , and @xmath144 .",
    "the least - squares function in an unreweighted variance minimization is quartic in the linear parameters;@xcite however the dependence on the cutoff lengths is much more complicated , and they couple strongly to the other parameters .",
    "the use of linear parameters is found to be very advantageous in practice : up to ten times fewer gauss ",
    "newton iterations are required to converge to the minimum of the least - squares function when the cutoff lengths are fixed compared with when they are optimized .",
    "our jastrow factor does not include logarithmic terms such as those motivated by the fock expansion.@xcite although these terms have been used in highly accurate hylleraas - expansion calculations for two - electron atoms  @xcite it should be noted that the most accurate calculations of this type performed to date have not included them.@xcite it can not therefore be necessary to include the logarithmic terms to obtain high accuracy .",
    "our jastrow factor does not include terms involving three or more electrons .",
    "of course the repulsive coulomb interaction and the antisymmetry of the wave function ensures that three or more electrons rarely come close to one another , so that such terms are expected to be small , and explicit tests by huang _",
    "et al . _",
    "@xcite support this view .    in our implementation",
    "it is possible to use different @xmath10 , @xmath12 , and @xmath13 functions for antiparallel , parallel spin - up , and parallel spin - down pairs of electrons , and different @xmath11 and @xmath14 functions for spin - up and spin - down electrons .",
    "we investigate the effect of using the different possible spin - dependences in the jastrow factor for a partially polarized system in sec .",
    "[ section : ni ] .",
    "note that if different @xmath10 functions are used for parallel- and antiparallel - spin pairs of electrons then both of the kato cusp conditions are satisfied , but if the same @xmath10 function is used for all pairs of electrons then only the antiparallel - spin cusp condition is satisfied .",
    "the use of a jastrow factor that is not symmetric with respect to exchanges of electrons of opposite spin generally produces a trial wave function that is not an eigenfunction of the spin operator @xmath145 , even though the ground - state wave function must be an eigenfunction of @xmath145 .",
    "an investigation into this _ spin - contamination _",
    "effect has been carried out by huang _",
    "et al . _",
    "@xcite , who found that highly optimized wave functions suffer from relatively little spin contamination .",
    "in the tests reported here the parameter @xmath94 , which determines the behavior at the cutoff lengths , takes the values @xmath95 or @xmath96 .",
    "the terms included in @xmath10 are specified by @xmath146 , those in @xmath11 by @xmath147 , and those in @xmath12 by @xmath148 and @xmath149 . in each case @xmath147",
    "is the same for all species of atom present , and likewise for @xmath148 and @xmath149 .",
    "spin dependences in @xmath10 , @xmath11 , @xmath12 , @xmath13 , and @xmath14 are specified by @xmath150 , @xmath151 , @xmath152 , @xmath153 , and @xmath154 , where @xmath155 denotes that the same @xmath10 function is used for parallel- and antiparallel - spin pairs , @xmath156 denotes that different functions are used for parallel- and antiparallel - spin pairs , and @xmath157 denotes that different functions are used for parallel spin - up , parallel spin - down and antiparallel - spin pairs .",
    "@xmath158 denotes that the same @xmath11 function is used for spin - up and spin - down electrons while @xmath159 if they are allowed to be different , etc .",
    "duplication of the @xmath24 terms in @xmath10 and the @xmath29 terms in @xmath11 by @xmath12 is denoted by `` d ''  =  true .",
    "the terms included in the plane - wave expansions , @xmath13 and @xmath14 , are determined by the number of stars of @xmath160 vectors included , @xmath161 and @xmath162 .",
    "if `` smj ''  =  true then only the @xmath12 terms contained in the schmidt ",
    "moskowitz jastrow factor are used ( i.e. , the terms proportional to @xmath24 and @xmath29 are omitted ) . in each case",
    "we will specify the relevant descriptors and give the total number of optimized parameters in the jastrow factor , @xmath163 .",
    "the cutoff lengths are included in the count of parameters .",
    "unless otherwise stated , the @xmath22 functions were chosen to be cuspless at the nuclei ( i.e.  @xmath164 in each case ) because non - divergent pseudopotentials were used or , where the full coulomb potential was used , the orbitals satisfied the electron ",
    "nucleus cusp condition .    to initiate the optimization procedure one must select a set of configurations from a suitable probability distribution .",
    "we have found that the distribution obtained from the square of the slater part of the wave function is normally an excellent starting point ; indeed our results suggest that it may be preferable to the `` self - consistent '' approach of updating the distribution to include the latest estimate of the jastrow factor .",
    "it should be noted that if one sets all of the variable parameters in our jastrow factor to zero , the resulting wave function can be very poor , often giving energies which are higher than that obtained using the slater part only .",
    "we measure the accuracy of a jastrow factor by the percentage of the dmc correlation energy retrieved within vmc , i.e. , @xmath165 where @xmath166 is the energy obtained with the slater determinants only , @xmath167 is the vmc energy obtained with the slater ",
    "jastrow wave function , and @xmath168 is the dmc energy .",
    "the dmc method gives the energy corresponding to a perfect jastrow factor : see sec .",
    "[ section : introduction ] . in this work",
    "the orbitals in the slater determinants were kept fixed and we only optimized the jastrow factor . under these conditions @xmath169 is an appropriate measure of the accuracy of jastrow factors .",
    "we also report the variance of the local energy , @xmath170 , for each jastrow factor tested .",
    "the energy variance is the quantity that determines the size of the statistical error bars for a given computational effort in qmc calculations .",
    "furthermore , it is the object that we actually minimize when optimizing the jastrow factor .",
    "extremely accurate energies are available for the two - electron he and ne@xmath0 atoms from variational calculations using hylleraas expansions  @xcite and other methods .",
    "it is straightforward to show that the exact ground - state wave function of a two - electron atom is a nodeless function of @xmath171 , @xmath172 , and @xmath173 .",
    "it should therefore be possible to obtain very accurate results by including @xmath174 terms in the jastrow factor . as the ground - state wave function is nodeless , the dmc energy should equal the exact ( non - relativistic and infinite - nuclear - mass ) energy , apart from statistical errors and biases due to the use of finite time steps and populations .",
    "we used orbitals derived from numerical integrations of the hartree ",
    "fock ( hf ) equations on fine radial grids .",
    ".optimized jastrow factors and vmc energies for he .",
    "the hf energy is @xmath175a.u . , the exact energy is @xmath176a.u . , and",
    "the dmc energy is within error bars of the exact value . in each case @xmath177 , @xmath178 , and @xmath179 .",
    "[ table : varmin_results_he ] [ cols=\"^,^,^,^,^,^,>,<,>,<,>,<\",options=\"header \" , ]      similar calculations to those reported in sec .",
    "[ section : si_2x2x2 ] were carried out using a 54-atom simulation cell .",
    "the hf energy is @xmath180a.u .  per primitive cell and",
    "the dmc energy is @xmath181a.u .  per primitive cell .",
    "the vmc energy obtained using our jastrow factor with @xmath182 , @xmath156 , and @xmath183 ( giving 14 free parameters ) is @xmath184a.u .  per primitive cell , so @xmath185% of the correlation energy is retrieved .",
    "a very similar fraction of the correlation energy is retrieved in the 16-atom cell ( see table [ table : varmin_results_newjas_si ] ) .",
    "the vmc energy variance is @xmath186a.u .",
    ", so the variance per electron is about the same as for the 16-atom simulation cell .",
    "the optimal value of @xmath89 is again equal to the wigner ",
    "seitz radius of the simulation cell ( @xmath187a.u . ) .",
    "the optimal value of @xmath188 remains of order the atomic size , at @xmath189a.u .",
    "these results indicate that cutting off the @xmath11 function at sizes of order the inter - atomic spacing is a valuable improvement to the jastrow factor .",
    "we have developed and tested a form of jastrow factor consisting of electron  electron ( @xmath10 ) , electron  nucleus ( @xmath22 ) , and electron  electron  nucleus ( @xmath23 ) terms , and additional electron - position - dependent ( @xmath14 ) and electron  electron - separation - dependent ( @xmath13 ) terms .",
    "the @xmath10 , @xmath22 , and @xmath23 terms are expanded in polynomials and are forced to go to zero at some cutoff radii .",
    "the @xmath13 and @xmath14 terms are expanded in plane waves .",
    "we have tested our jastrow factor on atoms , molecules , and solids , including both all - electron and pseudopotential atoms . in most cases our vmc calculations",
    "have retrieved over 90% of the fixed - node correlation energy .",
    "the variable parameters appear linearly in our jastrow factor , except for the cutoff radii of @xmath10 , @xmath22 , and @xmath23 .",
    "the linearity in the variable parameters aids the computational efficiency of the optimization algorithm .",
    "we have found that it is often beneficial to make the local energy continuous at the cutoffs when optimizing the cutoff radii , but that a lower variational energy can be achieved in some cases when discontinuities are allowed at the cutoffs .",
    "we have investigated the importance of terms in the jastrow factor that were neglected by schmidt and moskowitz,@xcite but we found them to be unimportant in the systems studied here .",
    "the electron  electron ",
    "nucleus @xmath23 terms were found to be important in all - electron simulations of the he , ne@xmath0 , and ne atoms .",
    "the @xmath23 terms are generally less important for pseudo - atoms than all - electron atoms . for example",
    ", they account for nearly 40% of the correlation energy in all - electron ne , but only about 10% in pseudo - ne .",
    "we found the @xmath23 terms to be significant for pseudo - ni and the nio dimer , but they had little effect in sih@xmath1 or crystalline si .",
    "the plane - wave terms @xmath13 and @xmath14 were found to be unimportant in crystalline si .",
    "we have found that it is preferable to use orbitals which satisfy the electron ",
    "nucleus cusp condition and to require the jastrow factor to be cuspless at nuclei rather than to enforce the electron ",
    "nucleus cusp condition through the jastrow factor .",
    "overall we found that optimizing the cutoff radii is very important . in crystalline si the cutoff for @xmath10 adjusted itself to the largest possible value , which is the wigner ",
    "seitz radius of the simulation cell .",
    "this indicates that there are significant correlations in si extending over many atoms .",
    "we have argued that the long - ranged parts of the @xmath22 and @xmath23 terms do not give useful variational freedom , and in support of this we found that the corresponding cutoffs adjusted themselves to sizes of the order of the inter - atomic spacing .",
    "although we have optimized our jastrow factors by minimizing the variance of the energy , we have measured the accuracy of the jastrow factors in terms of the variational energy itself .",
    "if we were to minimize the variational energy directly then we might get even better results .",
    "recently there has been much interest in developing energy - minimization methods for optimizing trial wave functions,@xcite and we intend to pursue this avenue further .",
    "we thank cyrus umrigar for helpful discussions and john trail for providing the all - electron hf orbitals and the pseudopotentials used in this work . financial support",
    "was provided by the engineering and physical sciences research council ( epsrc ) , uk .",
    "mdt thanks the royal society for a research fellowship .",
    "computational facilities were provided by the high performance computing facility at the university of cambridge .",
    "consider a particular set of ions @xmath99 and a particular spin - pair type . to impose the symmetry of @xmath12 under interchange of electrons we work with @xmath103 , where @xmath191 , and then complete the @xmath190 array by setting @xmath192 for @xmath193 .",
    "let @xmath194 be a vector whose components are each of the @xmath190 coefficients with @xmath191 .",
    "the remaining constraints ( no - cusp conditions and , optionally , no - duplication - of-@xmath10-and-@xmath11 conditions ) may then be written in matrix form as @xmath195 .",
    "the total number of constraints determines the number of rows of @xmath117 :    * there are @xmath196 constraints ( one for each value of @xmath197 ) associated with the imposition of the electron  electron no - cusp condition . using the symmetry of @xmath190 , eq .",
    "( [ equation : gamma_cond_ee ] ) can be rewritten so that only elements of @xmath198 are involved : @xmath199 , @xmath200 for each @xmath201 , this equation defines a row of @xmath117 .",
    "* there are @xmath202 constraints ( one for each value of @xmath203 ) associated with the imposition of the electron ",
    "nucleus no - cusp condition .",
    "( [ equation : gamma_cond_en ] ) can be rewritten so that only elements of @xmath198 are involved : @xmath204 , @xmath205 for each @xmath206 , this equation defines a row of @xmath117 . * if desired , there are @xmath207 constraints imposed to prevent duplication of @xmath10 .",
    "( @xmath136 @xmath208 . )",
    "* if desired , there are @xmath209 constraints imposed to prevent duplication of @xmath11 .",
    "( @xmath138 @xmath210 . )",
    "imposing the constraints reduces the number of independent variable parameters by @xmath211 .",
    "the matrix @xmath117 is transformed into its row - reduced echelon form by gaussian elimination , which allows us to identify a suitable set of independent variable parameters .",
    "m.  j.  frisch , g.  w.  trucks , h.  b.  schlegel , g.  e.  scuseria , m.  a.  robb , j.  r.  cheeseman , v.  g.  zakrzewski , j.  a.  montgomery , r.  e.  stratmann , j.  c.  burant , s.  dapprich , j.  m.  millam , a.  d.  daniels , k.  n.  kudin , m.  c.  strain , o.  farkas , j.  tomasi , v.  barone , m.  cossi , r.  cammi , b.  mennucci , c.  pomelli , c.  adamo , s.  clifford , j.  ochterski , g.  a.  petersson , p.  y.  ayala , q.  cui , k.  morokuma , d.  k.  malick , a.  d.  rabuck , k.  raghavachari , j.  b.  foresman , j.  cioslowski , j.  v.  ortiz , b.  b.  stefanov , g.  liu , a.  liashenko , p.  piskorz , i.  komaromi , r.  gomperts , r.  l.  martin , d.  j.  fox , t.  keith , m.  a.  al - laham , c.  y.  peng , a.  nanayakkara , c.  gonzalez , m.  challacombe , p.  m.  w.  gill , b.  g.  johnson , w.  chen , m.  w.  wong , j.  l.  andres , m.  head - gordon , and j.  a.  pople , gaussian98 , revision a.9 ( gaussian inc . , pittsburgh , pa , 1998 ) ."
  ],
  "abstract_text": [
    "<S> a form of jastrow factor is introduced for use in quantum monte carlo simulations of finite and periodic systems . </S>",
    "<S> test data are presented for atoms , molecules , and solids , including both all - electron and pseudopotential atoms . </S>",
    "<S> we demonstrate that our jastrow factor is able to retrieve a large fraction of the correlation energy . </S>"
  ]
}