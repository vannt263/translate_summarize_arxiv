{
  "article_text": [
    "[ [ section ] ]    the accelerating rate of accumulation of molecular sequences in public databases has triggered the development of a number of sequence comparison algorithms .",
    "the most popular algorithms , such as fasta , blast or blat , rely on sequence alignment , and assume contiguity between homologous segments .",
    "this assumption is , however , often broken in molecular sequences , due to events such as transposition , unequal crossing over or alternative splicing . to address this issue ,",
    "a number of alignment - free sequence comparison methods have been developed . amongst them , the count of words of length @xmath0 letters matching between two sequences , also known as the @xmath1 statistic , has found some successful applications , due to its simplicity and its speed . the algorithm to calculate the @xmath1 statistic between two sequences runs as a linear function of the sequences lengths , whereas alignment - based sequence comparison methods typically have a worst case runtime quadratic in the sequences lengths .",
    "the first applications of the @xmath1 statistic relied on heuristics to decide whether sequences are significantly similar , but did not have any statistical basis .",
    "[ [ section-1 ] ]    a rigorous examination of the distribution of @xmath1 led to the characterisation of asymptotic distributions , but the behaviour of @xmath1 in practical cases remains unknown . in a previous study , we characterized @xmath1 optimal word sizes for a range of sequence sizes .",
    "the goal of the present study is to find approximations of the distribution of @xmath1 for word sizes close to optimal , and for the sequence sizes most frequently encountered in molecular databases .",
    "the @xmath1 statistic is defined to be the number of exact word matches of length @xmath0 between sequences @xmath4 and @xmath5 , with @xmath6 and @xmath7 belonging to a given alphabet @xmath8 . for mathematical convenience",
    "we will impose periodic boundary conditions on both sequences , that is , the letter in the first position in sequence @xmath9 is assumed to follow the letter in the @xmath10th position , and the letter in the first position in sequence @xmath11 is assumed to follow the letter in the @xmath12th position . for @xmath13 we do not expect our results to differ significantly from the usual case of free boundary conditions .",
    "[ [ section-2 ] ]    defining the indicator variables @xmath14 for a word match between the @xmath0-word at position @xmath15 in a and the word at position @xmath16 in b by @xmath17 the @xmath1 statistic is given by @xmath18 where @xmath19 .",
    "for the case of free boundary conditions the index set is replaced by @xmath20 .",
    "[ [ section-3 ] ]    we are interested in the distributional properties of @xmath1 under the null hypothesis that @xmath9 and @xmath11 are bernoulli texts , meaning that each letter , @xmath6 or @xmath7 , is independently and identically ( i.i.d . ) distributed .",
    "let the probability of occurrence of letter @xmath21 be @xmath22 , and define @xmath23 the mean of @xmath1 is then  @xcite : @xmath24 an exact value for the variance of @xmath1 has recently been given for the case of free boundary conditions in @xcite .",
    "in appendix i we derive a similar formula for the variance for the algebraically simpler case of periodic boundary conditions .    from here on , to simplify matters we set @xmath25 .",
    "rigorous results exist for the limiting distribution of @xmath1 as @xmath26 in certain regimes . for pairs of bernoulli texts with non - uniform letter distributions ,",
    "the limiting distribution is compound poisson in the regime @xmath27 @xcite , and normal in the regime @xmath28 @xcite . here",
    "@xmath29 .    [",
    "[ section-4 ] ]    in earlier numerical analyses  @xcite , we tested the accuracy with which @xmath0-word matches are able to measure the relatedness of artificially evolved sequences .",
    "calculations of the optimum word size @xmath0 for a range of sequence lengths @xmath12 , showed that optimum word sizes generally fall between the two parameter regimes for which the asymptotic behaviour of @xmath1 is known .",
    "our purpose here is to perform numerical experiments to fill in the gap in the biologically relevant parameter regime between the asymptotically normal and compound poisson asymptotic behaviours , and to find accurate and practical approximations to the distribution of @xmath1 in this parameter region . in particular , we are concerned with accurately reproducing the region of the tail corresponding to classical significance levels ( 0.001% , 0.01% ,  ) , both for the distribution of @xmath1 , and for its extreme value distribution that is used for determining p - values in database searches .",
    "[ [ section-5 ] ]    the distribution of @xmath1 was simulated for a number of combinations of sequence size @xmath12 , word size @xmath0 , alphabets @xmath8 and sequence composition @xmath22 . for nucleic acid sequences , word sizes close to the optimal word size were chosen , based on computation of the optimal word size of @xmath1 @xcite .",
    "we focused on sequence sizes typical of ests , whole genome shotgun sequencing trace pairs , cdss , and mrnas ( @xmath30 bases ) . for protein",
    "amino acid sequences , the optimal word sizes and a letter composition equal to the average of the proteins encoded by the human genome where determined using the same method . for protein sequences of length up",
    "to @xmath31 the optimum word size was @xmath32 , and for longer sequences up to @xmath33 the optimum word size was @xmath34 .",
    "the sequence sizes for proteins ranged from small peptides to large proteins ( 10 to 2560 residues ) .",
    "sequences were simulated with uniform and non - uniform letter distributions .",
    "[ [ section-6 ] ]    for each combination of parameters , @xmath35 pairs of bernoulli text sequences were generated .",
    "the extreme value distribution was simulated by taking the largest value of 100 comparisons @xmath36 times .",
    "the code for the simulations was written in ansi c and is available from the author s website  @xcite .",
    "[ [ section-7 ] ]    previous studies of the @xmath1 statistic used kolmogorov - smirnov tests  @xcite to compare the empirical distribution of @xmath1 with its theoretical asymptotic distributions ( normal or compound - poisson )  @xcite .",
    "these studies , however , have been in error for the following reason .",
    "care must be taken when using the kolmogorov - smirnov test to pre - specify the parameters of the distribution being compared .",
    "if instead , parameters are estimated from the empirical distribution , the p - values obtained will be overestimated ( see appendix ii ) . given that these earlier studies generally pre - dated the discovery of an analytic formula for the variance of @xmath1 , they relied on means and variances estimated from empirical samples , and therefore led to overly optimistic claims of agreement between the distribution of the @xmath1 statistic for finite length sequences and its theoretical asymptotic limit .",
    "[ [ section-8 ] ]    we have repeated kolmogorov - smirnov tests of our empirically generated data , standardised with the analytically determined mean and variance of @xmath1 , against the standard normal distribution . in general , we find p - values to be smaller than those reported in earlier studies .",
    "similar results were obtained using the shapiro - wilk test , which tests for normality but does not require prior knowledge of the mean or variance .",
    "more importantly , we find that the information provided by such comparison is rather limited , as the p - value of the kolmogorov - smirnov test decreases noticeably with the sample size @xmath36 , since the true distribution of @xmath1 for finite sequence length @xmath12 never exactly matches the hypothesised limiting distribution .",
    "we conclude that this type of measure does not give a panacea for how well ( or how badly ) a given hypothesised distribution will approximate the distribution of @xmath1 .",
    "[ [ section-9 ] ]    most practical uses of the @xmath1 statistic involve the calculation of a p - value resulting from the comparison of two sequences or from the comparison of a query sequence to a sequence database .",
    "our approach therefore is to compare a hypothesised distribution with an empirically generated distribution of @xmath1 based on a direct comparison of the p - values obtained with these two distributions .",
    "if the p - values of a given hypothesised distribution agree well with those of the empirical distribution , this hypothesised distribution could be used to approximate the relevant tail of the real distribution of @xmath1 .",
    "[ [ section-10 ] ]    suppose we wish to compare a postulated distribution function @xmath37 with an empirically generated sample @xmath38 . to evaluate how accurately p - values predicted by @xmath37 would approximate those of the true distribution of @xmath1 , the quantiles @xmath39 are first calculated for to a number of p - values , @xmath40 .",
    "the frequency , in the simulated data , of the occurrences of @xmath1 greater than @xmath41 then provides an empirical p - value , @xmath42 this is compared to @xmath40 : @xmath43 the comparisons focussed on p - values in the range of classical significance levels ( @xmath44 ) .",
    "the theoretical distributions were parameterized using the exact values of @xmath1 s mean and variance .",
    "zero values of @xmath45 were replaced by @xmath46 .",
    "the hypothesised distributions considered were the normal and gamma distributions .",
    "the process is illustrated in fig .",
    "[ fig : empiricalpvalue ] .",
    "[ [ section-11 ] ]    when doing database searches , a query sequence is compared to several sequences , and the p - value of the best score of all these comparisons needs to be estimated .",
    "the relevant statistic in this case is the extreme value , that is , the maximum of a number of i.i.d .  random variables .",
    "in addition to evaluating the tail of the distribution of @xmath1 itself , the tail of the empirical extreme value distribution of @xmath1 was also compared to those of the the normal and the gamma distributions .",
    "these two extreme value distributions belong to the gumbel family and can be easily computed ( see appendix iii ) .",
    "[ [ section-12 ] ]    we first assessed the approximation of the distribution of @xmath1 with the normal distribution .",
    "figure [ fig : normalvsd2dna ] shows the results of the comparison of the p - values in the case of nucleic sequences with a uniform letter distribution .",
    "similar results were obtained with non - uniform letter distributions . for sequences 1600 base pairs long or larger , the p - values from the hypothesised normal distribution were very close to the empirical p - values . for smaller sequences and large p - values ( up to 1% ) ,",
    "the normal and empirical p - values were of the same order of magnitude . for smaller p - values ,",
    "the hypothesised normal distribution greatly overestimated the significance of @xmath1 .",
    "a few other distributions were compared to the simulated distribution of @xmath1 .",
    "the gamma distribution , in particular , approximated the distribution of @xmath1 better than the normal distribution did . in this case , the real p - values tended to be overestimated , and the relative difference increased as the p - values decreased ( figure  [ fig : gammavsd2dna ] ) .    , dna alphabet with uniform letter distribution .",
    "each table compares the two distributions at a given level of the hypothesised distribution , for a number of combinations of sequence lengths @xmath12 and word sizes @xmath0 .",
    "the value in each cell corresponds to the empirical level .",
    "the colour of each cell reflect the value of @xmath47 , as introduced in eq .",
    "[ absolutediffeq ] . ]    , dna alphabet with uniform letter distribution .",
    "see legend of figure  [ fig : normalvsd2dna ] . ]",
    "[ [ section-13 ] ]    the trends were identical for the amino acid alphabet ( figure [ fig : normalvsd2aa ] ) : the normal distribution approximates the p - values relatively well for large sequences and moderate significance levels , but for shorter sequences and further into the tail of the distribution , p - values were strongly overestimated .",
    "the gamma distribution generally underestimated the p - values , but was closer to the simulated distribution of @xmath1 ( figure  [ fig : gammavsd2aa ] ) .    , amino acid alphabet .",
    "see legend of figure  [ fig : normalvsd2dna ] . ]    , amino acid alphabet .",
    "see legend of figure  [ fig : normalvsd2dna ] . ]",
    "[ [ section-14 ] ]    figure  [ fig : d2ev ] shows the results of comparison between the extreme value distribution of @xmath1 , and the extreme values of the gamma and normal distributions in the case of a uniform nucleotide letter distribution for @xmath40 in the range @xmath48 to @xmath49 .",
    "the extreme value distribution of @xmath1 is generally better approximated by the maximum of gamma distributions . since it was noted in the previous section that the relative difference between the distribution of @xmath1 and the normal or the gamma distribution increased as the p - values decreased , it is not surprising that the approximations of the extreme value distribution of @xmath1 are not as good as the approximations to the distribution of @xmath1 .",
    "the same trends were observed for nucleic sequences of non - uniform letters and amino acid sequences .    , dna alphabet with uniform letter distribution .",
    "see legend of figure  [ fig : normalvsd2dna].,title=\"fig : \" ] , dna alphabet with uniform letter distribution .",
    "see legend of figure  [ fig : normalvsd2dna].,title=\"fig : \" ]",
    "[ [ section-15 ] ]    this study introduces practical approximations to the distribution of the @xmath1 statistic and to the extreme value distribution of @xmath1 . for sequences of intermediate length ( around 800 base pairs ,",
    "close to the average size of ests and sequencing traces ) and for p - values between 5% and 0.1% , the gamma distribution closely approximates the distribution of @xmath1 .",
    "the gamma distribution not only outperforms the normal distribution , but unlike the latter , it slightly overestimates the p - values , and thus would result in fewer false positives .",
    "[ [ section-16 ] ]    all the approximations presented here deteriorate as one moves further to the right hand of the tail ( for smaller p - values ) .",
    "this is not , however , a major problem for any practical use of these approximations , where very small p - values would just have an indicative value .",
    "[ [ section-17 ] ]    finally , our results show , that for longer sequences , such as genome assembly contigs , the normal approximation itself would be appropriate , even for very small p - values .",
    "using eq .  [ formulaford2 ] , the variance of @xmath1 is @xmath51 to simplfy the notation from here on we set @xmath52 , @xmath53 .",
    "the first term in eq .  [ vard2 ] depends only on @xmath54 where @xmath55 is defined in eq .",
    "[ ptdefinition ] . thus @xmath56    to calculate the covariances in the second term of eq .",
    "[ vard2 ] , it is convenient to use the notation and terminology of  @xcite , chapter 11 .",
    "let @xmath57 be the dependency neighbourhood of @xmath58 .",
    "it can be decomposed into two parts , _ accordion _ and _ crabgrass _ , @xmath59 , where @xmath60 we compute the cross covariances , @xmath61 , by looking at the following cases .",
    "* case 1 * : @xmath62 .",
    "in this case , @xmath58 and @xmath63 are independent and hence @xmath64 .",
    "* case 2 * : @xmath65 .",
    "let @xmath66 and @xmath65 .",
    "consider first the subcase @xmath67 , where @xmath68 and @xmath69 .",
    "then @xmath70 where we have used the fact that word matches occur simultaneously at @xmath71 and @xmath72 if and only if the first @xmath0 letters of @xmath73 are repeated at @xmath74 and the final @xmath0 letters are repeated at @xmath75 .",
    "this gives @xmath76 extending the argument to all @xmath77 gives @xmath78 by symmetry of the covariance function , the same result applies to the sub - case @xmath79 where @xmath80 and @xmath81 .",
    "the crabgrass contribution to the sum over covariance terms in eq .",
    "[ vard2 ] is then @xmath82 \\nonumber   \\\\       & = & mn(m +",
    "n - 4k + 2 )             \\left [ { p_3}^k + 2{p_2}^2 p_3 \\frac{{p_3}^{k - 1 } - { p_2}^{2(k - 1 ) } } { p_3 - { p_2}^2 }             - ( 2k - 1 ) { p_2}^{2k } \\right ]   \\nonumber \\\\ \\label{case2contrib}\\end{aligned}\\ ] ]    * case 3 * : @xmath72 is on the _ main diagonal _ of @xmath83 . that is , @xmath84 , where @xmath85 and @xmath86 ( see fig .  [",
    "fig : accordion ] ) . in this case ,",
    "@xmath87 and @xmath88 the contribution to the sum over covariance terms in eq .",
    "[ vard2 ] from case 3 is then @xmath89 .",
    "\\label{case3contrib}\\end{aligned}\\ ] ]     referred to in case 3 ( black squares ) , and the sub - regions i to vi referred to in cases 4 and 5.,height=306 ]    * case 4 * : @xmath90 _ one of the subregions i , ii , iii or iv of @xmath83 in fig .",
    "[ fig : accordion]_. that is , @xmath91 , where    * @xmath92 ; * @xmath93 ; * @xmath94 or * @xmath95 .",
    "consider subregion i first .",
    "the word matches corresponding to the event `` @xmath96 '' are illustrated in fig .",
    "[ fig : case4 ] .",
    "for such a situation to occur , the @xmath97 letters @xmath98 , @xmath99 and @xmath100 can be specified independently , and the remaining @xmath101 letters within the four words must be repeats of @xmath102 as shown .",
    "the sequence @xmath100 is repeated @xmath103 complete times in sequence @xmath104 and @xmath105 complete times in sequence @xmath106 , where @xmath107 indicates the integer part . at the right hand end of these repeats",
    ", the sequence @xmath108 occurs once in sequence @xmath106 and once in sequence @xmath104 , where @xmath109 .    then @xmath110 and @xmath111    it is straightforward to check that similar results apply to subregions ii , iii and iv , giving the contribution to the sum over covariances in eq .",
    "[ vard2 ] from case 4 as @xmath112 where @xmath113 is the union of the four subregions of case 4 and @xmath114    , @xmath115 and @xmath100 are specified , the remaining letters within the four words must be repeats of @xmath102 as shown , the final repeat being truncated at the same point in both sequence @xmath106 and sequence @xmath104.,height=377 ]    * case 5 * : @xmath90 _ one of the subregions v or vi of @xmath83 in fig .",
    "[ fig : accordion]_. that is , @xmath91 , where    * @xmath116 , @xmath117 ; * @xmath118 , @xmath119 .",
    ", @xmath120 are specified , the remaining letters within the four words must be repeats of @xmath121 in sequence a and @xmath122 in sequence b , the final repeat being truncated at the @xmath123th or @xmath124th position respectively.,height=377 ]    consider subregion v first .",
    "the word matches corresponding to the event `` @xmath96 '' are illustrated in fig .",
    "[ fig : case5 ] . set @xmath125 . for the event to occur , the affected block of length @xmath126 in sequence a must consist of repeats of a sequence @xmath127 where @xmath128 and @xmath129 are independently specified letters .",
    "the final repeat is truncated at the @xmath123th letter .",
    "the affected block in sequence b must consist of repeats of the sequence @xmath130 , the final repeat being truncated at the @xmath124th letter .",
    "let @xmath131 , @xmath132 be the total number of times the letter @xmath133 occurs and @xmath134 , @xmath135 be the total number of times the letter @xmath136 occurs in the two blocks in fig .",
    "[ fig : case5 ] . by noting that the stretches of length @xmath0 not including the first @xmath137 letters of the a - block or not including the first @xmath138 letters of the b - block each contain @xmath139 complete repeats of all @xmath140 independent letters plus a final @xmath141 remaining letters at the right hand end , we arrive at @xmath142 where @xmath143 then @xmath144 and @xmath145    a similar result holds for subregion vi .",
    "the contribution to the sum over covariances in eq .",
    "[ vard2 ] from case 5 is then @xmath146 , \\label{case5contrib}\\ ] ] where @xmath147 is the union of the two subregions of case 5 and @xmath131 and @xmath134 are given by eq .",
    "[ mndef ] .",
    "finally , by eq .  [ vard2 ] , the variance of @xmath1 is given by the sum of the right hand sides of eqs .",
    "[ varcontrib ] , [ case2contrib ] , [ case3contrib ] , [ case4contrib ] and [ case5contrib ] .",
    "given a random sample of observations @xmath148 , the kolmogorov - smirnov test  @xcite gives p - values for the null hypothesis that the observations are associated with pre - specified distribution function @xmath149 .",
    "the two - sided version of the test considered here uses as a test statistic @xmath150 , where @xmath151 is the empirical cumulative distribution function based on the observations . under the null hypothesis the p - values obtained",
    "are uniformly distributed on the interval @xmath152 $ ] .",
    "importantly , if the hypothesised distribution @xmath149 is not fully pre - specified , but relies on estimates from the sample , the reported p - values will not be uniformly distributed under the null hypothesis . to illustrate this ,",
    "we have generated a set of 10,000 independent samples of @xmath153 random numbers from a standard normal distribution , and applied the two - sided kolmogorov - smirnov test to each sample using the r function ks.test .",
    "histograms of the p - values obtained are shown in fig .",
    "[ fig : ks_normal ] . in the first plot",
    "each sample was tested against the standard normal @xmath154 , whereas in the second plot each sample was tested against a normal distribution whose mean and variance was estimated from the sample .",
    "we see that in this situation , where the null hypothesis is true , but the kolmogorov - smirnov test is applied incorrectly , p - values are skewed heavily towards 1 .        in a second test to see whether incorrect use of the kolmogorov - smirnov test can lead to an overly optimistic indication of agreement with a hypothesised distribution , we generated a set of 10,000 independent samples of @xmath153 random numbers from a gamma distribution with mean 10 and variance 1 .",
    "this distribution is close to , but not identical with , the normal distribution @xmath155 .",
    "the third and fourth histograms in fig .",
    "[ fig : ks_normal ] are of p - values obtained from application of the kolmogorov - smirnov test against a pre - specified @xmath155 , and against a normal distribution with mean and variance estimated from the sample respectively .",
    "the third plot is an indication the distribution of p - values that will result if the kolmogorov - smirnov test for normality is applied correctly to this non - normal data .",
    "again we see that p - values are overestimated in the fourth plot when the test is used incorrectly .",
    "we are interested in the limiting distribution for @xmath156 large of the random variable @xmath157 where @xmath158 are i.i.d",
    ".  random variables with common density function @xmath159 and distribution function @xmath160 the general theory of extreme value distributions is given in the book by gumbel  @xcite , chapter  5.2 .",
    "for distributions of `` type i '' , which includes the normal and gamma distributions , the distribution function of @xmath161 , namely @xmath162 , asymptotes to the double exponential distribution function @xmath163 where the _ reduced largest value _ is defined as @xmath164 here @xmath165 , called the _ characteristic largest value _ , is determined by the condition that in @xmath156 observations of @xmath166 , the expected number of values greater than or equal to @xmath165 is unity .",
    "it is the solution to the equation @xmath167 and for the case of the normal and gamma distribution is easily found using the r function qnorm ( ) and qgamma ( ) respectively .",
    "the parameter @xmath168 is called the _ extremal intensity function _ and is given by @xmath169",
    "we thank professors alan welsh and chris field for inspiring discussions .",
    "this work was funded in part by arc discovery grant dp0559260 .    1    ttp://dayhoff.anu.edu.au/@xmath170sf / k_words .",
    "c.  j. burden , m.  r. kantorovitz , and s.  r. wilson .",
    "approximate word matches between two random sequences .",
    ", 18(1):121 , 2006 .",
    "conover . .",
    "john wiley and sons , 1999 .",
    "s.  fort , m.  r. kantorovitz , and c.  j. burden .",
    "asymptotic behaviour and optimal word size for exact and approximate word matches between random sequences .",
    ", 7 suppl 5:s21 , 2006 .",
    "e.  j. gumbel . .",
    "columbia university press , new york , 1958 .",
    "m.  r. kantorovitz , g.  e. robinson , and s.  sinha . a statistical method for alignment - free comparison of regulatory sequences .",
    ", 23(13):i24955 , 2007 .",
    "r.  a. lippert , h.  huang , and m.  s. waterman .",
    "distributional regimes for the number of k - word matches between two random sequences .",
    ", 99(22):139809 , 2002 .",
    "m.  s. waterman . .",
    "chapman and hall , 1995 .",
    "sylvain fort graduated in invertebrates physiology and computer science at the inap - g and universit pierre et marie currie in paris , france in 1998 .",
    "he received his phd in molecular biology and biochemistry from the australian national university in canberra , australia in 2007 .",
    "susan wilson obtained her b.sc .  from the university of sydney in 1968 , and her ph.d .",
    "from the australian national university in 1972 .",
    "she is an elected member of the international statistical institute , elected fellow of the american statistical association and of the institute of mathematical statistics .",
    "she has been president , international biometric society .",
    "conrad j.  burden received his b.sc .",
    "in applied mathematics from the university of queensland in 1978 , his ph.d .  in theoretical physics from the australian national university in 1983 , and is a fellow of the australian institute of physics .",
    "for the first 16 years of his academic career his research interests centred on subatomic particle physics and quantum field theory . after a brief sojourn in the it industry he made the transition to bioinformation science in 2003 .",
    "he is currently a fellow in the centre for bioinformation science at the australian national university where his research interests include modelling of oligonucleotide microarrays , alignment free sequence comparison methods , gene regulation and protein structure ."
  ],
  "abstract_text": [
    "<S> this study focuses on an alignment - free sequence comparison meth - od : the number of words of length @xmath0 shared between two sequences , also known as the @xmath1 statistic . </S>",
    "<S> the advantages of the use of this statistic over alignment - based methods are firstly that it does not assume that homologous segments are contiguous , and secondly that the algorithm is computationally extremely fast , the runtime being proportional to the size of the sequence under scrutiny . </S>",
    "<S> existing applications of the @xmath1 statistic include the clustering of related sequences in large est databases such as the stack database . </S>",
    "<S> such applications have typically relied on heuristics without any statistical basis . </S>",
    "<S> rigorous statistical characterisations of the distribution of @xmath1 have subsequently been undertaken , but have focussed on the distribution s asymptotic behaviour , leaving the distribution of @xmath1 uncharacterised for most practical cases . </S>",
    "<S> the work presented here bridges these two worlds to give usable approximations of the distribution of @xmath1 for ranges of parameters most frequently encountered in the study of biological sequences .    * sylvain fort@xmath2 , susan r.  wilson@xmath2 , conrad j.  burden@xmath3 * </S>"
  ]
}