{
  "article_text": [
    "the metropolis - hastings ( mh ) algorithm @xcite is a markov chain monte - carlo ( mcmc ) method of profound importance to many fields of mathematics such as bayesian inference and statistical mechanics @xcite .",
    "the applicability of mh to a particular computational problem depends on the efficiency of the markov chain that is generated by the algorithm .",
    "the chains generated by the classical metropolis - hastings algorithm are _",
    "reversible _ , or , in other words , satisfy _ detailed balance _ ; in fact , this reversibility is instrumental in showing that the resulting chains have the right invariant probability distribution .",
    "however , non - reversible markov chains may have better properties in terms of mixing behavior or asymptotic variance .",
    "this can be shown experimentally in special cases @xcite , theoretically in special cases @xcite , and in fact , also in general @xcite , with respect to asymptotic variance .",
    "see also @xcite for improved asymptotic variance of non - reversible diffusion processes on compact manifolds .",
    "there exist two basic approaches to the construction of non - reversible chains from reversible chains : one can ` lift ' the markov chain to a larger state space @xcite , or one can introduce non - reversibility without altering the state space @xcite . in continuous spaces , the _ hybrid _ or _ hamiltonian monte carlo _ @xcite is closely related to the lifting approach in discrete spaces .",
    "other noteworthy publications on non - reversible markov chains are @xcite .",
    "in this paper we consider the second type of creating non - reversibility , i.e. without augmenting the state space . in discrete spaces",
    "this can , in principle , be achieved by changing transition probabilities ( see remark  [ rem : adding_gamma ] ) .",
    "however this may be have computational disadvantages , since it requires access to all transition probabilities .",
    "furthermore , there is no such analogue in continuous spaces ( crudely speaking , because all transition probabilities to specific states are zero ) .    to remedy these issues , in this paper mh",
    "is extended to ` non - reversible metropolis - hastings ' ( nrmh ) which allows for non - reversible transitions .",
    "the main idea of this paper is to modify the acceptance ratio , which is further discussed in section  [ sec : non - reversible - mh ] . for pedagogical purposes ,",
    "the theory is first developed for discrete state spaces .",
    "it is shown how the acceptance probability of mh , can be adjusted so that the resulting chain in nrmh has a specified ` vorticity ' , and therefore , will be non - reversible .",
    "any markov chain satisfying a symmetric structure condition can be constructed by nrmh , which establishes the generality of the algorithm .",
    "theoretical advantages of finite state space non - reversible chains in terms of improved asymptotic variance and large deviations estimates are briefly mentioned in section  [ sec : advantages ] .",
    "in particular we recall a result from @xcite that adding non - reversibility decreases asymptotic variance . also we present a variation on a result by @xcite on large deviations from the invariant distribution .    as mentioned above , for continuous state spaces it was so far",
    "not clear how general non - reversible markov chains ( i.e. discrete time , for arbitrary target density ) could be constructed .",
    "one of the main advantages of nrmh is that it also applies in the setting of continuous state spaces , and thus provides a partial solution to this problem , as will be discussed and verified experimentally in section  [ sec : continuous_spaces ] .",
    "in particular we implement a non - reversible version of the metropolis adjusted langevin algorithm ( mala ) for gaussian multivariate target distributions .",
    "finally , conclusions and directions of further research are discussed in section  [ sec : discussion ] .",
    "we will consider both finite and infinite - dimensional vectors and matrices .",
    "the constant vector with all elements equal to @xmath0 will be denoted by @xmath1 ; the dimensionality of @xmath1 should always be clear from the context .",
    "similarly the identity matrix of any dimension will be denoted by @xmath2 . for sets @xmath3 , with @xmath4 the indicator function of @xmath5",
    "is denoted by @xmath6 .",
    "the transpose of a matrix @xmath7 is denoted by @xmath8 . the euclidean vector norm on @xmath9 , as well as its induced matrix norm ,",
    "will be denoted by @xmath10 . for a matrix @xmath11 ,",
    "the spectrum is denoted by @xmath12 .",
    "the spectral bound and spectral radius of @xmath7 are denoted by @xmath13 and @xmath14 , respectively .",
    "as a preliminary to non - reversible metropolis - hastings , we require the notion of _ vorticity matrix _ , which is introduced in section  [ sec : vorticity ] . the classical metropolis - hastings algorithm , discussed in section  [ sec : mh ] ,",
    "is extended using the notion of vorticity matrix to a non - reversible version in section  [ sec : non - reversible_extension ] .",
    "let @xmath15 denote a matrix of transition probabilities of a markov chain on a finite or countable state space @xmath16 .",
    "a _ distribution _ on @xmath16 is a vector with positive elements in @xmath17 , and is not necessarily normalized , i.e. it is not necessarily the case that @xmath18 . if @xmath19 is a distribution such that @xmath18 , then we call @xmath19 a",
    "_ probability distribution_. we will always assume that @xmath20 for all @xmath21 .",
    "a ( probability ) distribution @xmath19 on @xmath16 is said to be an _ invariant ( probability ) distribution _ of @xmath22 if @xmath23 , i.e. @xmath24 for all @xmath25 .",
    "a distribution @xmath19 on @xmath16 is said to satisfy the _ detailed balance condition _ with respect to @xmath22 if @xmath26 , i.e. @xmath27 for all @xmath28 .",
    "if there exists a distribution @xmath19 on @xmath16 that satisfies detailed balance with respect to @xmath22 , then @xmath22 is said to be _",
    "reversible_. as is well known , and straightforward to check , if @xmath19 satisfies detailed balance with respect to @xmath22 , then @xmath19 is invariant for @xmath22 .",
    "a chain which does not satisfy the detailed balance condition with respect to its invariant distribution is called _ non - reversible_. in a certain sense , this is a misnomer : we may obtain a time reversed markov chain @xmath29 by defining @xmath30 .",
    "in fact , @xmath29 is the adjoint of @xmath22 with respect to the inner product @xmath31 , defined by @xmath32 .",
    "for further background material on markov chains the reader is referred to @xcite .",
    "consider a non - reversible markov chain @xmath22 .",
    ". then @xmath34 is a reversible markov chain with invariant distribution @xmath19 .",
    "we will also define a vorticity matrix @xmath35 as ( essentially ) the skew - symmetric part of @xmath22 : @xmath36 or in matrix notation @xmath37 one can think of @xmath35 as ( a transformation of ) the skew - symmetric part of @xmath22 : @xmath38 .",
    "the following simple observations are fundamental to this paper .",
    "[ lem : vorticity_observations ] let @xmath22 be the transition matrix of a markov chain on @xmath16 and let @xmath19 be a distribution on @xmath16 .",
    "let @xmath35 be defined by  . then :    * @xmath35 is skew - symmetric , i.e. @xmath39 ; * @xmath19 satisfies detailed balance with respect to @xmath22 if and only if @xmath40 ; * @xmath19 is invariant for @xmath22 if and only if @xmath41 .",
    "\\(i ) and ( ii ) are immediate . as for ( iii ) , note that @xmath42 = \\pi(x ) -",
    "\\sum_{y \\in s } \\pi(y ) p(y , x),\\ ] ] which is zero for all @xmath43 if and only if @xmath19 is invariant for @xmath22 .    in light of lemma",
    "[ lem : vorticity_observations ] , a matrix @xmath44 which is skew - symmetric and satisfies @xmath41 is called a _",
    "vorticity matrix_. if @xmath35 is related by   to a markov chain @xmath22 with invariant distribution @xmath19 , it is called the _ vorticity of @xmath22 and @xmath19_. it will be a key ingredient in the construction of a non - reversible version of metropolis - hastings .",
    "[ rem : adding_gamma ] a direct way of constructing a non - reversible chain @xmath22 from a reversible chain @xmath34 and a vorticity matrix @xmath35 , is by letting @xmath45 , provided that @xmath22 is a probability matrix ( i.e. has nonnegative entries ) .",
    "this is discussed in e.g. @xcite . in order to make a transition from a state @xmath43",
    ", one has to compute entries of @xmath46 and @xmath47 to determine the transition probabilities .",
    "this approach has no alternative in uncountable state spaces .",
    "this is the main reason for wishing to develop a method that does not depend on the construction mentioned in this remark .      in the metropolis - hastings ( mh ) algorithm",
    "a reversible markov chain @xmath48 with a given invariant distribution @xmath19 is constructed .",
    "we will assume , mainly for simplicity , throughout this paper that @xmath20 for all @xmath21 .",
    "as an ingredient for the construction of @xmath48 , a markov chain @xmath49 is used , satisfying the _ symmetric structure _",
    "condition @xmath50 in other words , whenever a transition from @xmath43 to @xmath51 has positive probability , the reverse probability also has positive probability .",
    "the _ hastings ratio _ @xmath52 is defined as @xmath53 with this definition of @xmath54 , acceptance probabilities are defined as @xmath55 and transition probabilities @xmath56 are defined by @xmath57 it is a straightforward exercise to show that the chain @xmath48 has @xmath19 as its invariant distribution .",
    "an important step is the observation that @xmath58 if and only if @xmath59 , which will be a recurring phenomenon in the sequel .      we will now discuss how this framework can be extended to construct markov chains that are , in general , non - reversible .",
    "let @xmath44 be a vorticity matrix , and let @xmath49 be the transition matrix of a markov chain , satisfying  .",
    "again , @xmath60 is some distribution that is not necessarily normalized and has only positive entries .",
    "we define for @xmath28 the _ non - reversible hastings ratio _ as @xmath61 and let , analogously to mh , the acceptance probabilities @xmath62 be @xmath63 entries of @xmath35 can be negative . in order to avoid the situation that @xmath62 becomes negative",
    ", we will explicitly constrain vorticity matrix @xmath35 to satisfy @xmath64 note that   implies , by skew - symmetry of @xmath35 , that @xmath65 in particular , by the symmetric structure condition  , @xmath35 should have zeroes wherever @xmath49 has zeroes .",
    "as with metropolis - hastings , the transition probabilities @xmath66 are defined by @xmath67 note that indeed @xmath68 is a matrix of transition probabilities . for @xmath40 , @xmath62 and therefore @xmath68",
    "reduce to @xmath69 and @xmath48 , so that the chosen notation is consistent .    in order to check that the proposed markov chain has @xmath19 as its invariant density , we need to verify that @xmath35 , @xmath19 and @xmath68 are related through  . as a crucial step , we employ the following lemma , in analogy with metropolis - hastings .",
    "[ lem : hastings - ratio ] let @xmath35 be a vorticity matrix , @xmath49 a matrix of transition probabilities satisfying  , @xmath19 a distribution that is nowhere zero , such that   holds .",
    "let @xmath70 be as above .",
    "then @xmath71 if and only if @xmath72 for any @xmath73 for which @xmath74 .",
    "suppose @xmath72 , i.e. @xmath75 . then @xmath76 so that @xmath71 , using that @xmath35 is skew - symmetric .",
    "the converse direction is analogous .    using the previous lemma , it is now straightforward to show that @xmath35 is the vorticity matrix of @xmath77 .",
    "[ lem : p_gamma_has_vorticity_gamma ] let @xmath49 be a markov chain , @xmath35 a vorticity matrix , and @xmath19 a distribution on @xmath16 , such that   and are satisfied .",
    "let @xmath68 be defined through  , and",
    ". then   holds for @xmath78 , i.e. @xmath79    if @xmath43 , @xmath51 are such that @xmath72 .",
    "then @xmath80 , and @xmath81 .",
    "therefore @xmath82 using lemma  [ lem : hastings - ratio ] . so that   is satisfied for such @xmath43 and @xmath51 .",
    "the cases in which @xmath83 or @xmath84 are analogous .",
    "finally , since by the assumption that @xmath35 is a vorticity matrix , @xmath41 , and hence lemma  [ lem : vorticity_observations ] ( iii ) gives that @xmath19 is invariant for @xmath68 .",
    "we have obtained our main result .",
    "let @xmath49 be a markov chain , @xmath35 a vorticity matrix , and @xmath19 a distribution on @xmath16 that is everywhere positive , such that   and are satisfied .",
    "let @xmath68 be defined through  ,   and",
    ". then @xmath68 has @xmath19 as invariant distribution and @xmath35 as its vorticity matrix .",
    "we will refer to a combination @xmath85 which satisfies   and   as a _",
    "compatible combination_. especially verifying condition   requires some knowledge about @xmath19 , but these do not need to be exact : it will suffice to have acces to a lower bound for @xmath19 . in the proof of theorem  [ thm : ornstein_uhlenbeck ] the analogue of this condition for continuous spaces is checked as an example .",
    "once we have access to a compatible combination of proposal chain @xmath49 , vorticity matrix @xmath35 and target distribution @xmath19 , the nrmh algorithm has similar favorable properties as mh , in that only local information is required : @xmath49 , @xmath19 and @xmath35 only need to be evaluated at the current and proposed state , and no normalization of @xmath19 is required . in section  [ sec : continuous_spaces ] this will become even more important when nrmh is applied to a problem in continuous state space .",
    "the following trivial observation serves to indicate the generality of this approach .",
    "it asserts that every markov chain may be build , in a trivial way , by the described procedure .",
    "[ prop : very_general ] let @xmath22 be a markov chain with invariant distribution @xmath19 and corresponding vorticity @xmath35 , satisfying  .",
    "if we use @xmath86 as proposal distribution and @xmath35 as vorticity matrix in the nrmh algorithm with target distribution @xmath19 , then the resulting markov chain @xmath68 is identical to @xmath22 .",
    "it suffices to note , that by @xmath86 and  , @xmath87 for all @xmath28 , @xmath88 .",
    "if , for some pair @xmath89 ,   holds with equality , the transition probability @xmath90 even when @xmath74 . therefore irreducibility of @xmath49 does not imply irreducibility of @xmath68 , unless we impose the stronger condition : @xmath91    as noted in remark  [ rem : adding_gamma ] , one may alternatively construct any non - reversible chain @xmath22 by ` adding ' a vorticity matrix to a reversible chain @xmath34 .",
    "we may translate one approach into the other , as follows :    [ prop : equivalent_approaches ] consider irreducible transition kernels @xmath92 and @xmath93 , related by @xmath94 , both satisfying the symmetric structure condition  .",
    "suppose @xmath49 , @xmath19 and @xmath35 satisfy  .",
    "suppose @xmath95 is the markov kernel obtained from nrmh , using @xmath49 as proposal chain and @xmath35 as vorticity matrix .",
    "suppose @xmath96 is the markov kernel given by @xmath97 , where @xmath34 is the classical metropolis - hastings kernel obtained by using @xmath98 as proposal chain ( and @xmath19 as target distribution ) .",
    "then @xmath99 .",
    "we compute , for @xmath88 , with @xmath74 , @xmath100 both @xmath95 and @xmath96 have zeros on the off - diagonal entries for which @xmath49 has zeros .",
    "since both @xmath95 and @xmath96 represent transition probabilities , this also fixes their diagonal elements , which concludes the proof .",
    "non - reversible markov chains may offer important computational advantages compared to reversible chains .",
    "we will briefly discuss some of these advantages as they apply to finite state space markov chains .",
    "it is to our knowledge an open question how to extend the results of sections  [ sec : asymptotic_variance ] and sections  [ sec : large_deviations ] in a generic way to uncountable and continuous state spaces .      consider a markov chain @xmath22 on @xmath16 with invariant _ probability _ distribution @xmath101 .",
    "let @xmath102 .",
    "we say that @xmath103 satisfies a central limit theorem ( clt ) if there is a @xmath104 such that the normalized sum @xmath105 $ ] converges weakly to a @xmath106 distribution . in this case",
    "@xmath107 is called the asymptotic variance .",
    "we will in this section work under the assumption that @xmath16 is finite . in this case , for any @xmath108 and irreducible @xmath22 ,",
    "a clt is satisfied ( see e.g. @xcite ) .",
    "the following result is obtained in @xcite , for a more extensive argument see @xcite .",
    "[ prop : vorticity_improves_asymptotic_variance ] let @xmath34 be a transition matrix of an irreducible reversible markov chain with invariant probability distribution @xmath101 .",
    "let @xmath35 be a non - zero vorticity matrix and let @xmath109 be the transition matrix of an irreducible markov chain . for any @xmath102 and denote by @xmath110 and @xmath111 the asymptotic variances of @xmath103 with respect to the transition matrices @xmath34 and @xmath22 , respectively .",
    "then for all @xmath102 , we have @xmath112 , and there exists an @xmath103 such that @xmath113 .    in words , adding non - reversibility decreases asymptotic variance .",
    "in @xcite it is noted that non - reversible diffusions on compact manifolds have favorable properties in terms of large deviations of the occupation measure from the invariant distribution .",
    "inspired by their result , we present a simple ( but to our knowledge novel ) result in the same direction for finite state spaces .    as in the previous section ,",
    "assume @xmath16 is finite .",
    "we may transform a discrete time markov chain on @xmath16 into a continuous time chain by making subsequent transitions after random waiting times that have independent @xmath114 distributions .",
    "the discrete chain with transition matrix @xmath22 then transforms into a continuous time chain with generator @xmath115 the occupation measure of the resulting markov process is defined as @xmath116 .",
    "if @xmath117 is irreducible , the occupation measure satisfies for large time a large deviation principle with rate function @xmath118 i.e. informally , for large @xmath119 , for @xmath120 , @xmath121 here @xmath122 is the set of probability distributions on @xmath16 .",
    "the rate function satisfies the properties that ( i ) @xmath123 , ( ii ) @xmath124 is strictly convex , and ( iii ) @xmath125 if and only if @xmath126 , where @xmath19 is the invariant distribution of @xmath117 .",
    "hence @xmath124 quantifies the probability of a large deviation of the occupation measure from the invariant distribution for large @xmath119 .",
    "see @xcite for further details .",
    "the following result shows that deviations for non - reversible continuous time chains from the invariant distribution are asymptotically less likely than for the corresponding reversible chain .",
    "suppose @xmath117 admits a decomposition of the form @xmath127 , where @xmath128 and @xmath129 for all @xmath88 .",
    "then @xmath130 for all @xmath131 , and the inequality is strict if @xmath132 .",
    "assume @xmath133 for all @xmath43 . by writing @xmath134 , @xmath135",
    ", we have @xmath136.\\ ] ] hence it suffices to prove the result for @xmath137 , with @xmath34 symmetric and @xmath35 anti - symmetric .",
    "now take @xmath138 .",
    "then @xmath139 the first term is equal to the the rate function @xmath140 for the empirical measure in the symmetric case , see e.g. ( * ? ? ?",
    "* theorem iv.14 ) . since @xmath35 is skew - symmetric , the second term vanishes .",
    "hence taking the supremum over @xmath141 gives a value larger than or equal to @xmath140 .",
    "let @xmath142 be given by @xmath143 .",
    "then @xmath144 which proves the second statement in the proposition .    if @xmath145 for some @xmath43 , the proof carries over by only summing over indices for which @xmath133 .",
    "non - reversibility in a markov chain can have very favorable effects on mixing time and spectral gap , but we are not aware of general results in this direction .",
    "the reader is referred to @xcite for theoretical results in this direction , and to e.g. @xcite for less rigorous and/or numerical results . in these experimental results",
    ", non - reversibility especially seems to improve sampling in the case of sampling from a multimodal distribution .",
    "in this section we explain how to extend the idea of non - reversible metropolis - hastings algorithm to a euclidean state space . in appendix",
    "[ app : general_state_space ] it is discussed how metropolis - hastings can be applied in the case of a general measurable space , and the discussion in this section is a special case of this .",
    "suppose @xmath49 is a markov transition kernel on @xmath9 which has density @xmath146 with respect to lebesgue measure , i.e. @xmath147",
    ". we will be interested in sampling from a distribution on @xmath9 with lebesgue density @xmath19 .",
    "we do not require that @xmath148 .",
    "let @xmath149 be lebesgue measurable and furthermore suppose @xmath150 satisfies @xmath151 and @xmath152 here @xmath153 denotes the borel @xmath154-algebra generated by open sets in @xmath9 .",
    "furthermore suppose that @xmath155 @xmath156 and @xmath157    define the hastings ratio @xmath158 acceptance probabilities @xmath159 , and transition kernel @xmath160    the proof of the following theorem can be found in appendix  [ app : general_state_space ] .",
    "[ thm : regular_case ] with the above notation and definitions , and assuming conditions  , , , and   are satisfied , @xmath22 is a markov transition kernel with invariant density @xmath19 .    in analogy with the discrete state space setting we call @xmath150 the _ vorticity density _ of @xmath161 .",
    "if @xmath162 on a set of positive lebesgue measure then @xmath22 is non - reversible , i.e. there exist sets @xmath163 such that @xmath164      the application of non - reversible sampling methods in euclidean space is a relatively unexplored area . in this short review section we will discuss the use of langevin diffusions for simulating from a target density , and discuss the potential role of nrmh in within this context .",
    "assume that the target density @xmath19 is continuously differentiable .",
    "it is well known that @xmath19 is invariant for the _ langevin diffusion _",
    "@xmath165 where @xmath166 is a standard brownian motion in @xmath9 . a natural ( discrete time ) markov chain for sampling @xmath19 is then the _ euler - maruyama discretization _ of the langevin diffusion , @xmath167 here @xmath168 is a suitable stepsize .",
    "this discretization is approximately correct if @xmath168 is chosen to be sufficiently small .",
    "however , such a choice of @xmath168 results in slow convergence to equilibrium of the markov chain . when @xmath168 is large , then the discretization results in large discrepancy between   and  . as a result also the respective invariant distributions will be different and in particular the invariant distribution of   will not correspond to the desired distribution with density @xmath19 .",
    "it is customary to correct for this by considering the euler - maruyama discretization as a proposal for metropolis - hastings , resulting in the metropolis adjusted langevin algorithm ( mala , @xcite ) .",
    "any diffusion of the form @xmath169 with @xmath170 skew - symmetric , has @xmath19 as invariant density .",
    "if @xmath171 then the diffusion is non - reversible . in analogy with section  [ sec : advantages ] one may hope that such a non - reversible diffusion has advantages compared to the reversible langevin diffusion .",
    "in fact for multivariate gaussian target distributions these advantages are clear @xcite , as we will discuss below .",
    "more generally the probability of large deviations of the empirical distribution from the invariant distribution are reduced for non - reversible diffusions @xcite .    when discretizing   it is again necessary to correct for discretization error by a mh accept / reject step . however , since mh generates reversible chains , one should expect that also the favourable properties of non - reversibility are destroyed .",
    "instead , an implementation of nrmh should be able to preserve these favourable properties of non - reversible diffusions .",
    "we will illustrate this for multivariate gaussian distributions .",
    "consider as target distribution a centered normal distribution with positive definite covariance matrix @xmath5 . in this case",
    "the langevin diffusion becomes the ornstein - uhlenbeck process @xmath172 where @xmath173 is an @xmath174-dimensional standard brownian motion . in @xcite",
    ", it is shown that adding a ` nonreversible ' component of the form @xmath175 to the drift , with @xmath16 skew - symmetric , can improve convergence of the sample covariance .",
    "therefore we will instead consider the ornstein - uhlenbeck process with modified drift @xmath176 where @xmath177 with @xmath16 skew - symmetric . for any choice of skew - symmetric @xmath16",
    ", this diffusion keeps @xmath19 invariant . the convergence to equilibrium of the diffusion",
    "is governed by the spectral bound , @xmath178 . more specifically , @xmath179 with rate of convergence @xmath180 also , @xmath181 for any choice of @xmath16 . in other words , adding a non - reversible term increases the speed of convergence to equilibrium .",
    "in @xcite , it is established that it is possible to choose @xmath16 optimally , resulting in @xmath182 . by choosing @xmath16 in such a way the convergence of the chain is effectively governed by the average of the eigenvalues , which should be compared to the reversible case in which the ` worst ' eigenvalue determines the speed of convergence .",
    "we will apply the theory developed in section  [ sec : continuous_theory ] to the time discretization of the non - reversible ornstein - uhlenbeck process . to be able to satisfy   later on",
    ", we will require flexibility in the magnitude of the drift multiplier @xmath183 and the diffusivity .",
    "we consider the time discretization of  , with step size @xmath184 , is @xmath185 where @xmath186 are i.i.d .",
    "standard normal and @xmath187 .",
    "for @xmath188 this is the usual euler - maruyama discretization .",
    "the transition kernel of the euler - maruyama discretization will serve as our proposal distribution @xmath189 , and we will first determine the vorticity density @xmath150 of @xmath49 .",
    "let @xmath190 denote the spectral radius of a square matrix @xmath7 .",
    "provided @xmath191 , the invariant probability distribution of @xmath49 is the centered normal distribution with covariance @xmath192 , where @xmath192 is the unique positive definite matrix solution to the _ discrete time lyapunov equation _ ( see e.g. ( * ? ? ?",
    "* theorem 13.2.1 ) ) @xmath193 let @xmath194 denote the density of the invariant probability distribution of @xmath49 .",
    "let @xmath195 .",
    "the vorticity density of the proposal chain is @xmath196 as target density we have @xmath197 it is clear that @xmath150 satisfies   and  . also since @xmath19 and @xmath198 are non - degenerate ,   and   are satisfied .",
    "the same statements hold trivially for scalar multiples of @xmath150 .",
    "verification of   requires more effort .",
    "we provide a sufficient condition .",
    "the proof of this result is provided in appendix  [ app : proof_ornstein_uhlenbeck ] .",
    "[ thm : ornstein_uhlenbeck ] define constants @xmath199 by @xmath200 suppose @xmath201 , @xmath184 and @xmath187 satisfy @xmath202 then @xmath203 , with @xmath150 as constructed above , satisfies  , and is therefore a vorticity density compatible with proposal distribution @xmath204 and invariant distribution @xmath205 .",
    "[ rem : choice_parameters ] how should one choose @xmath206 , @xmath168 and @xmath154 ?",
    "it seems reasonable to choose @xmath207 equal to the maximal allowed value in  , so that the deviation from the euler - maruyama discretization ( which has @xmath188 ) is minimal ; i.e. let @xmath208 to maximize the non - reversibility effects in the acceptance probability one should choose @xmath206 as large as possible , i.e. @xmath209 . a heuristic estimate for the scaling of the expected step size is given by the step size @xmath168 times the multiplicative factor in the vorticity , @xmath209 in the acceptance probability .",
    "note that @xmath210 for @xmath211 and @xmath212 .",
    "maximization of @xmath213 with respect to @xmath168 yields @xmath214 as long as @xmath215 ( which is the case in which @xmath16 and @xmath5 do not commute ) .",
    "this expression satisfies the condition @xmath216 .",
    "a first order taylor approximation around @xmath217 yields the simplified expression @xmath218 .",
    "the corresponding value of @xmath219 is to first order equal to @xmath220 .    in case @xmath221 ,",
    "the optimal value of @xmath168 is given by @xmath222 , with @xmath223 .",
    "to summarize , a general procedure for applying non - reversible metropolis - hastings may be described by the steps listed in figure  [ fig : steps - nrmh ] .",
    "* algorithm for sampling from a gaussian multivariate distribution * + _ given : _    * target distribution @xmath205 , with @xmath5 positive definite .    _",
    "initialization : _    1 .",
    "determine a skew - symmetric @xmath170 such that the magnitude of @xmath224 is large , e.g. using the algorithm of @xcite , and let @xmath177 .",
    "2 .   choose @xmath206 , @xmath168 and @xmath154 satisfying  , e.g. using the choices discussed in remark  [ rem : choice_parameters ] .",
    "3 .   solve the discrete lyapunov equation   to determine the invariant covariance matrix @xmath192 of the discretized scheme .",
    "4 .   let @xmath225 , @xmath103 and @xmath150 be given by  ,   and  .",
    "5 .   let @xmath203 for @xmath226 .",
    "choose a starting point @xmath227 .",
    "_ sampling : _ repeat for @xmath228    1 .",
    "generate proposal @xmath229 2 .",
    "compute @xmath230 according to  , where @xmath231 is taken to be equal to the density function of the proposal distribution @xmath232 3 .",
    "with probability @xmath233 , let @xmath234 ; otherwise let @xmath235 .",
    "below we carry out two experiments illustrating the approach above .",
    "for the obtained markov chain realization @xmath236 , we will obtain an estimate of the decorrelation by considering the _ empirical autocorrelation function ( eacf ) _",
    "@xmath237 defined by @xmath238 where @xmath239 ranges over the coordinates @xmath240 , and where @xmath241 is the empirical average of the @xmath239-th coordinate .",
    "a fast decaying eacf indicates that the samples generated by the markov chain are quickly decorrelating .      in this example , from @xcite",
    ", we take as target covariance structure @xmath5 a diagonal matrix with @xmath242 .",
    "the optimal nonlinear drift is obtained by letting @xmath243 we choose the parameter values in accordance with remark  [ rem : choice_parameters ] , resulting in @xmath244 the performance of nrmh is compared to mh with identical step - size @xmath168 , and reversible proposal distribution @xmath245 . in figure",
    "[ fig : eacf3d ] the eacfs for this 3-dimensional example are plotted . here",
    "we see that nrmh helps to decrease the autocorrelations of the slowly decorrelating components in mh ( here , the first two components ) .",
    "it achieves this without increasing autocorrelations of components that are already quickly decorrelating ( here , the third component ) .    .",
    "the blue curve represents the non - reversible metropolis hastings method .",
    "the green curve represents reversible proposals in conjunction with the usual mh acceptance rule .",
    "the step sizes @xmath168 for all approaches are taken to be the same .",
    "these plots are based on an mcmc trajectory of @xmath246 steps . ]      here we generated a random diagonal matrix @xmath5 , with @xmath247 using the algorithm described in @xcite an optimal non - reversible drift @xmath248 can be computed . for reversible dynamics",
    ", we have @xmath249 , while for the optimal non - reversible dynamics , @xmath250 . in figure",
    "[ fig : eacf9d ] the eacfs for this 9-dimensional example are plotted .",
    "one can clearly see the typical effect of adding non - reversibility : the autocorrelation of the worst coordinates is improved so that it becomes on par with that of the fastest decorrelating coordinates .    .",
    "the blue curve represents the non - reversible metropolis hastings method .",
    "the green curve represents reversible proposals in conjunction with the usual mh acceptance rule .",
    "these plots are based on an mcmc trajectory of @xmath251 steps . ]    in this case , choosing @xmath206 , @xmath168 and @xmath154 as in remark  [ rem : choice_parameters ] results in values @xmath252 in a numerical example with @xmath251 proposed transitions this leads to acceptance ratios displayed in table  [ tab : acceptance_ratios ] . using the batch means method ( by dividing the sample trajectory in @xmath253 trajectories of length @xmath253 and assuming the @xmath253 are independent )",
    ", we can estimate asymptotic variance .",
    "the resulting estimates for asymptotic variance of the different components are given in table  [ tab : asvar ] .",
    "it should be noted that the notion of asymptotic variance is only defined in case a clt holds ( see @xcite ) , which strictly speaking is an open question in this setting .    .estimated asymptotic variances for the 9-dimensional example of section  [ sec:9d ] , based on an mcmc trajectory of @xmath251 steps .",
    "note that nrmh improves the ( estimated ) asymptotic variance for almost all components ( and often significantly ) , except for component # 7 .",
    "[ cols=\"<,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]",
    "the efficiency increase of non - reversible markov chains in mcmc can be significant , in terms of either asymptotic variance or mixing properties , as remarked in this paper .",
    "nrmh extends the mcmc - toolbox with a method to utilize these benefits .",
    "in particular for continuous state spaces it was , to our knowledge , not known how to construct non - reversible markov chains for mcmc sampling ( taking into account the necessity of a correction step when using time discretization of diffusions ) .",
    "using the theory developed in section  [ sec : continuous_spaces ] , nrmh can be applied to general distributions on @xmath9 as follows . for",
    "a target density function @xmath19 , suppose there exists a gaussian distribution @xmath205 with density function @xmath254 on @xmath9 , satisfying @xmath255 on @xmath9 for some @xmath256 . then if @xmath150 is a suitable vorticity density for sampling from @xmath205 , using proposal density @xmath146 , we have for @xmath257 that @xmath258 so that   is satisfied for the combination for this choice of @xmath19 , @xmath259 and @xmath198 , and theorem  [ thm : regular_case ] applies .",
    "such a suitable choice of @xmath150 may be determined as described in section  [ sec : nrmh_gaussian ] .    the approach outlined in section  [ sec : continuous_spaces ] should be considered as a first attempt at implementing the nrmh framework for continuous spaces . as discussed , in order to use the framework one needs to verify the non - negativity condition which leads to technical challenges . in particular",
    "we expect that much progress is possible in weakening the conditions of theorem  [ thm : ornstein_uhlenbeck ] .",
    "the current form of that proposition results in a relatively small step size @xmath168 , which obstructs fast convergence of nrmh . as mentioned before",
    ", it is an open question whether nrmh in continuous spaces can be made competitive with optimally tuned mala .",
    "the theoretical discussion of section  [ sec : advantages ] and the numerical experiment of section  [ sec : experiments_continuous ] illustrate how efficiency can be improved by employing non - reversible metropolis - hastings . in view of these encouraging results",
    "it will hopefully be possible to extend the result to more general settings .",
    "the practical application of nrmh depends on the identification of suitable vorticity structures that are compatible with proposal chains , and establishing these in practical examples provides a promising and challenging direction of research .",
    "analysis of non - reversible markov chains is difficult , essentially because self - adjointness is lost . without self - adjointness , it is much more difficult to connect spectral theory to mixing properties of chains .",
    "it seems that a good way of understanding benefits of non - reversible sampling is by studying cesaro averages ( see @xcite and e.g. the result on large deviations in section  [ sec : large_deviations ] ) .",
    "the results of section  [ sec : advantages ] which establish that non - reversible chains have better asymptotic variance or large deviations properties , are so far qualitative in nature ( i.e. fail to quantify the amount of improvement ) . to obtain quantitative results",
    "is an important challenge that remains to be addressed .",
    "also , it is object of further study how these results carry over to countable and uncountable state spaces . in particular , the question under what conditions the resulting chains are geometrically ergodic and/or satisfy a clt should be considered .",
    "i am grateful to prof .",
    "pavliotis ( imperial college , london ) for making available the code for computing optimal non - reversible drift ( as discussed in @xcite ) .",
    "i also wish to acknowledge valuable discussions with prof .",
    "hilbert j. kappen ( radboud university ) , dr .",
    "kevin sharp ( university of oxford ) and prof .",
    "gareth roberts ( university of warwick ) .",
    "we thank the reviewers and editor for their valuable suggestions which have had a significant impact upon the paper .",
    "let @xmath260 be a measurable space .",
    "let @xmath261 denote a markov transition kernel and @xmath19 an invariant probability distribution of @xmath22 , i.e. @xmath262 for @xmath263 .",
    "define @xmath264 , @xmath265 . here",
    "@xmath266 and @xmath183 in @xmath267 and @xmath268 denote ` forward ' and ` backward ' , respectively .",
    "note that @xmath267 and @xmath268 are probability measures on @xmath269 with marginal distributions @xmath19 .",
    "define @xmath270 then @xmath35 is a signed measure on @xmath269 , satisfying @xmath271 and @xmath272 we will call a signed measure @xmath35 on @xmath269 satisfying  ,   a _ vorticity measure_.",
    "if @xmath35 is related to @xmath19 and @xmath22 by  , it is called the _ vorticity measure of @xmath161_.",
    "let @xmath273 and let @xmath274 and @xmath275 as defined above with @xmath22 replaced by @xmath49 .",
    "let @xmath35 be a vorticity measure .",
    "the markov chain @xmath49 will play the role of proposal chain , and @xmath35 the role of target vorticity .",
    "we can use the jordan decomposition ( * ? ? ?",
    "* section 6.6 ) to decompose @xmath35 into two non - signed measures @xmath276 and @xmath277 , so that @xmath278 .",
    "we say that @xmath35 is _ absolutely continuous _ with respect to some measure @xmath225 on @xmath269 , denoted by @xmath279 , if @xmath280 and @xmath281 .",
    "if @xmath279 , we define the radon - nikodym derivative of @xmath35 with respect to @xmath225 by @xmath282    assuming @xmath283 and @xmath284 , we define the _ non - reversible hastings ratio _ @xmath285 in order for @xmath286 to be nonnegative , we have to impose the condition @xmath287    [ lem : hastings_ratio_symmetric ] suppose @xmath49 and @xmath19 are such that @xmath274 and @xmath275 are equivalent measures on @xmath269 .",
    "suppose that @xmath35 is a vorticity measure such that @xmath35 is absolutely continuous with respect to @xmath274 .",
    "suppose   is satisfied .",
    "then for all @xmath28 , @xmath288 if and only if @xmath289 .",
    "write @xmath278 for the jordan decomposition of @xmath35 , i.e. since @xmath290 , it follows that @xmath291 and @xmath292 for @xmath293 .",
    "suppose for @xmath294 , @xmath289 , so that @xmath295 we compute @xmath296 where   was used to establish the inequality .    define the _ acceptance probability _ by @xmath297 and define a transition kernel @xmath22 by @xmath298    [ lem : p_has_vorticity_gamma ] suppose @xmath49 and @xmath19 are such that @xmath274 and @xmath275 are equivalent measures on @xmath269 .",
    "suppose that @xmath35 is a vorticity measure such that @xmath35 is absolutely continuous with respect to @xmath274 .",
    "suppose   is satisfied .",
    "let @xmath22 be defined by  ,  .",
    "the vorticity measure of @xmath299 is @xmath35 .",
    "we should check that for @xmath293 , @xmath300    note that , for some measurable function @xmath301 , @xmath302 this shows that the measure @xmath303 in   is symmetric with respect to interchanging @xmath43 and @xmath51 , and therefore has no contribution in the verification of  .",
    "using lemma  [ lem : hastings_ratio_symmetric ] there are no conceptual difficulties left in verifying that @xmath304 in a similar way as in the proof of lemma  [ lem : p_gamma_has_vorticity_gamma ] .",
    "[ thm : general_case ] suppose @xmath49 and @xmath19 are such that @xmath274 and @xmath275 are equivalent measures on @xmath269 .",
    "suppose that @xmath35 is a vorticity measure such that @xmath35 is absolutely continuous with respect to @xmath274 .",
    "suppose   is satisfied .",
    "let @xmath22 be defined by  ,  .",
    "then @xmath19 is invariant for @xmath22 and @xmath35 is the vorticity measure of @xmath161 .",
    "lemma  [ lem : p_has_vorticity_gamma ] establishes that @xmath35 is the vorticity measure of @xmath161 . by  [ eq : vorticity_measure_condition_2 ] , for @xmath263 , @xmath305 so that @xmath19 is invariant for @xmath22 .",
    "define the signed measure @xmath35 , and measures @xmath274 and @xmath275 on @xmath269 by @xmath306 then by  ,  , @xmath35 is a vorticity measure , and by assumptions   and  , @xmath274 and @xmath275 are equivalent measures , and @xmath35 is absolutely continuous with respect to @xmath274 .",
    "furthermore @xmath286 is a version of @xmath307 , and by assumption  , we have @xmath308 .",
    "we see that all conditions of theorem  [ thm : general_case ] are satisfied , so that the stated results follow .",
    "define an inner product @xmath309 on @xmath9 by @xmath310 , where @xmath311 is the euclidean inner product .",
    "let @xmath312 denote the induced norm .",
    "let @xmath313 .",
    "suppose @xmath316 and let @xmath317 , @xmath318 , be an eigenvector corresponding to @xmath319",
    ". without loss of generality assume that @xmath320 .",
    "we have @xmath321 by skew - symmetry of @xmath16 , @xmath322 and @xmath323 hence the requirement @xmath324 translates into the inequality @xmath325 or , after some rearranging , @xmath326 looking at the denominator , using cauchy - schwartz , @xmath327 it follows that if @xmath168 satisfies  , then it satisfies  , and therefore @xmath315 .",
    "if   holds , by ( * ? ? ?",
    "* theorem 13.2.1 ) there exists a unique solution @xmath328 to the discrete lyapunov equation  .",
    "recall @xmath195 , where @xmath194 is the density of @xmath329 and @xmath231 the density function of @xmath330 .",
    "hence @xmath103 is a gaussian density function with mean zero and covariance matrix @xmath331            expanding   gives @xmath339 or equivalently @xmath340 where @xmath341 .",
    "it follows that @xmath192 satisfies the continuous time lyapunov equation @xmath342 with solution ( see e.g. ( * ? ? ?",
    "* theorem 13.1.1 ) ) @xmath343 where the last equality follows because @xmath5 satisfies the continuous time lyapunov equation @xmath344 .              * since @xmath16 is skew - symmetric , @xmath354 where @xmath355 .",
    "now @xmath356 , so we conclude @xmath357 * this follows immediately from ( i ) and the fact that a dissipative operator ( here : @xmath358 ) generates a contraction semigroup ( * ? ? ?",
    "* section ix.8 ) . *",
    "first note that @xmath359 therefore if @xmath216 , then   holds , and therefore @xmath192 is well - defined . from the proof of lemma  [",
    "lem : lower_bound_r ] , @xmath360 .",
    "hence , using ( ii ) , @xmath361 the result follows after rearranging , using the following equality ( which holds for any matrix @xmath34 ) to express @xmath362 in terms of the @xmath10-norm : @xmath363 * by ( iii ) , using that @xmath364 for _ any _ matrix - norm @xmath365 , @xmath366 hence @xmath367 which is equivalent to the stated result .    the density @xmath103 is given by @xmath368 using",
    ", it can be verified that @xmath369 we have the following expressions for the target density @xmath19 and the transition density @xmath198 with respect to lebesgue measure : @xmath370 multiplication gives @xmath371 where @xmath372 to satisfy  , we require that @xmath373 for all @xmath374 and some constant @xmath201 . we compute @xmath375 by lemmas  [ lem : det_m ] and  [ lem : lower_bound_r ] , we have @xmath376 so that , for @xmath377 , @xmath378 \\\\ & = k   \\exp \\left ( - { \\mbox{$\\frac 1 2$}}\\xi ' m^{-1 } \\xi",
    "\\right ) \\left [ \\exp \\left ( { \\mbox{$\\frac 1 2$}}\\xi ' m^{-1 } \\xi -{\\mbox{$\\frac 1 2$}}\\xi ' n^{-1 } \\xi   \\right ) - 1 \\right ] , \\end{aligned}\\ ] ] where @xmath379 .",
    "the last factor is nonnegative for all @xmath380 if and only if @xmath381 is positive semidefinite . by   and",
    ", we have @xmath382 using lemma  [ lem : r_estimates ] ( iv ) , we find that for the specified values of @xmath168 and @xmath154 , @xmath383 and therefore ( by ( * ? ? ?",
    "* corollary 7.7.4 ) ) , @xmath384 .                                                  yi  sun , faustino gomez , and juergen schmidhuber . .",
    "in j  lafferty , c  k  i williams , j  shawe - taylor , r  s zemel , and a  culotta , editors , _ advances in neural information processing systems 23 _ , pages 22352243 . 2010 ."
  ],
  "abstract_text": [
    "<S> the classical metropolis - hastings ( mh ) algorithm can be extended to generate non - reversible markov chains . </S>",
    "<S> this is achieved by means of a modification of the acceptance probability , using the notion of vorticity matrix . </S>",
    "<S> the resulting markov chain is non - reversible . </S>",
    "<S> results from the literature on asymptotic variance , large deviations theory and mixing time are mentioned , and in the case of a large deviations result , adapted , to explain how non - reversible markov chains have favorable properties in these respects .    </S>",
    "<S> we provide an application of nrmh in a continuous setting by developing the necessary theory and applying , as first examples , the theory to gaussian distributions in three and nine dimensions . </S>",
    "<S> the empirical autocorrelation and estimated asymptotic variance for nrmh applied to these examples show significant improvement compared to mh with identical stepsize .    </S>",
    "<S> ams subject classification : 65c40 , 60j20    keywords and keyphrases : markov chain monte carlo ; mcmc ; metropolis - hastings ; non - reversible markov processes ; asymptotic variance ; large deviations ; langevin sampling </S>"
  ]
}