{
  "article_text": [
    "magnetic field plays an important role in the various problems of plasma physics and astrophysics .",
    "it is well known , for example , that the density of the magnetic energy in the interstellar clouds is compared with the density of the turbulent energy and can exceed the density of the thermal energy ( see , e.g. , @xcite ) .",
    "there are a wide class of problems dealing with the dynamics of the selfgravitating mhd flows .",
    "note among others the gravitational collapse of the interstellar clouds , protostellar clusters and galaxies ; origin of the molecular bipolar outflows and jets from young stars and galaxy cores ; dynamics of the accretion flows and circumstellar disks .",
    "a variety of finite - difference schemes for the solution of the gasdynamical equations have been developed during last five decades .",
    "corresponding 1d , 2d , and 3d numerical codes have been applied to the simulation of various gasdynamical flows .",
    "the direct extension of the these schemes to the mhd , however , is quite complex problem due to the specific properties of the mhd equations ( anisotropy , vanishing divergence of the magnetic field , etc . ) .    among the non - monotonic generalization of gasdynamical schemes for numerical simulation of the mhd flows the lax - vendroff method ( and its modifications )",
    "is used ( see , e.g. , @xcite ) .",
    "this method is subjected to the non - physical oscillations on strong discontinuities @xcite .",
    "another prevailing method for the simulation of the multidimensional selfgravitating mhd flows is the mhd extension of the sph method @xcite .",
    "a finite - difference scheme should approximate correctly the physical oscillations of the flows containing shock waves , contact discontinuities and rarefaction waves .",
    "the nonlinear monotonic methods of high resolution were suggested for the solution of these problems . historically the first monotonic method was fct method @xcite .",
    "it was developed for of linear advection equation and for gasdynamical equations . at the present time",
    "fct schemes are used for the simulations of the mhd flows as well @xcite .",
    "there are two basic approaches that are applied for the construction of the monotonic finite - difference schemes for the numerical solution of the mhd problems .",
    "nonlinear riemann problem is solved in the original godunov s methods at every mesh interface and every time step by various iteration procedures ( see , e.g. , @xcite ) . on the basis of nonlinear riemann solver , dai and",
    "woodward @xcite extended the ppm method @xcite there .",
    "powell et al .",
    "@xcite constructed an eight - wave eigensystem for the approximate riemann solver .",
    "jiang and wu @xcite applied a high - order weno interpolation scheme to mhd equations .",
    "another approach is splitting the hyperbolicity matrix onto positive and negative parts and following solution of the linear riemann problem @xcite .",
    "we have suggested recently a simple tvd scheme for the numerical solution of the mhd equations that has high resolution in the smooth regions of the solution ( see @xcite ) .",
    "this scheme does not demand the solution of full eigenvalues problem ( i.e. a calculation of all eigenvectors and eigenvalues of the hyperbolicity matrix ) , since it uses only the spectral radius . on the basis of developed tvd scheme we elaborated 2d numerical method for the solution of the selfgravitational mhd equations in cylindrical coordinates",
    ". this method can be used for the simulation of isothermal and adiabatic plasma flows .",
    "we have applied it to simulation of the collapse of magnetized rotating protostellar clouds .    in outline",
    "this paper proceeds as follows . in section  2",
    "we consider the mathematical problem statement for the simulation of selfgravitating mhd flows in the frame of axisymmetrical approximation . in section 3 the tvd scheme for the numerical solution of the 1d mhd system",
    "is constructed . in section 4",
    "the developed 1d tvd scheme is extended to the 2d case and numerical algorithm for simulation of the 2d axisymmetrical selfgravitating mhd flows is described .",
    "section 5 gives the description of 2d mhd numerical code and the results of few test problems .",
    "the results of the numerical simulations of the magnetized protostellar cloud collapse is presented in section 6 . in the conclusion ( section 7 )",
    "we discuss briefly the main properties of the presented numerical code and general perspectives of its development in future .",
    "the system of the gravitational mhd reads :    @xmath0    @xmath1    @xmath2 \\bigr ] ^{i } = 0\\ , , \\label{eq_2002}\\ ] ]    @xmath3 \\bigr ] ^{k } \\biggr \\ } \\nonumber \\\\",
    "\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad = -\\rho v^{k } \\nabla_{k } \\phi\\ , , \\label{eq_2003}\\end{aligned}\\ ] ]    @xmath4    where    @xmath5    is the maxwellian tension tensor , @xmath6 is the metric tensor .",
    "the other variables in this system ( and further ) have its usual physical sense .",
    "the system ( [ eq_2000][eq_2005 ] ) is written in covariant form .",
    "therefore it can be rewritten easy for the case of arbitrary curvilinear coordinates .    to close the system ( [ eq_2000][eq_2005 ] )",
    "we use the equation of state of a perfect gas @xmath7 , where @xmath8 is the adiabatic index .",
    "the equation of energy ( [ eq_2003 ] ) in the case of isothermal plasma should be excluded and the pressure should be determined from the relation @xmath9 , @xmath10 , where @xmath11 is the isothermal sound speed , @xmath12 is the molecular weight .",
    "the collapse of a rotating magnetized protostellar cloud can be studied in the frame of axisymmetric approximation if the initial uniform magnetic field @xmath13 is parallel to the vector of angular velocity @xmath14 . in this case",
    "we can use the cylindrical coordinates @xmath15 , axis @xmath16 being parallel to the vectors @xmath13 and @xmath14 .",
    "the variables in ( [ eq_2000][eq_2005 ] ) do not depend on the azimuthal coordinate @xmath17 , so equations ( [ eq_2000][eq_2003 ] ) can be written then in divergent form as follows :    @xmath18    where the vectors of the conservative variables @xmath19 , fluxes @xmath20 , @xmath21 and sources @xmath22 are determined by expressions :    @xmath23    @xmath24    @xmath25    @xmath26    here index @xmath27 denotes the operation of the transposition .      let us consider the problem of initial and boundary condition on the example of the interstellar ( protostellar ) clouds collapse . under the condition of axial and equatorial symmetries we can considered the 2d computational domain in the cylindrical coordinate system : @xmath28 with the characteristic sizes @xmath29 and @xmath30 .",
    "we suppose that contracting cloud is located inside the computational domain and cloud boundary does not coincide with the grid boundary .",
    "the conditions on the external boundaries of the computational domain are defined by cloud contraction from the given volume . in this case",
    "the normal components of the velocity @xmath31 on the external boundary are equal to zero . for density @xmath32 , internal energy @xmath33 , magnetic field @xmath13 and tangential components of the velocity @xmath34",
    "we can write boundary conditions as @xmath35 , where @xmath36 is the outer normal unit vector .",
    "the internal boundary conditions correspond to the axial and equatorial symmetries ( @xmath37 on the axe and @xmath38 , @xmath39 on the equator ) .",
    "initial conditions for the collapse of the rotating magnetic cloud are determined by values of the mass @xmath40 , temperature @xmath41 and parameters @xmath42 , @xmath43 , @xmath44 .",
    "these parameters are ratios of the internal , magnetic and kinetic energies of rotation to the absolute value of gravitational energy , respectively .",
    "the parameters @xmath42 , @xmath43 , @xmath44 allow us to obtain the following similarity relations for the variables characterizing the initial cloud state :    @xmath45    @xmath46    @xmath47    @xmath48    these similarity relations allow to generalize the results of simulation with the specified values @xmath42 , @xmath43 , @xmath44 on the contracting clouds with other values of mass and temperature .",
    "the minimal initial values of the parameters @xmath42 , @xmath43 , @xmath44 depend on the critical mass @xmath49 .",
    "we can obtain the value of critical mass from virial theorem as follows :    @xmath50",
    "let us construct the finite - difference scheme for adiabatical and isothermal mhd flows using the total variation diminishing ( tvd ) principle .",
    "tvd principle for schemes approximating the linear hyperbolic system is an extension of monotonic principle for the schemes approximating the linear advection equation .",
    "the general idea of this principle consists in the numerical implementation of the total variation diminishing for the finite - difference riemann invariants @xcite . an efficient way of the monotonic schemes construction was proposed by vyaznikov et al .",
    "it consists in the following steps :    1 .",
    "the selection of a monotonic ` base ' scheme of the first order of approximation .",
    "2 .   the transformation of the ` base ' scheme to the high resolution scheme by addition of the antidiffusional terms . 3 .   the construction of the antidiffusional coefficients for monotonicity guarantee .    the constructed tvd scheme should have a high resolution in the smooth regions of the solution but the order of approximation can decrease in the regions of large gradients .      to investigate the general ideology of the tvd scheme construction and its basic properties",
    "let us consider the linear advection equation :    @xmath51    that is defined in the domain @xmath52 , @xmath53 with the initial values @xmath54 .",
    "we introduce an uniform spatial grid @xmath55 , @xmath56 with the fixed stepsize @xmath57 and consider the following class of ` base ' schemes for the equation ( [ eq_3001 ] ) :    @xmath58    the parameter @xmath59 is a coefficient of numerical viscosity , while the coefficients @xmath60 determine the antidiffusional terms .",
    "if all @xmath61 the scheme ( [ eq_3002 ] ) gives the ` base ' scheme of the first order of approximation in space and time .",
    "the condition of monotonicity of this scheme is @xmath62 we have to use the principle of maximum @xcite , that for the scheme ( [ eq_3002 ] ) gives the inequalities :    @xmath63    where    @xmath64 are smoothness analyzers .",
    "note that last inequality ( [ eq_3003_5 ] ) determines also the stability condition for the scheme ( [ eq_3002 ] ) .    to monotonize the scheme ( [ eq_3002 ] ) a number of approaches were suggested ( see , e.g. , @xcite ) .",
    "vyaznikov et al .",
    "@xcite proposed to consider the coefficients @xmath65 as a piecewise - linear functions of the analyzers @xmath29 .",
    "these functions must satisfy to the following conditions : 1 )  @xmath66 , @xmath67 ; 2 )  @xmath68 , @xmath69 .",
    "let us take @xmath70 in the form of two - parametric set of piecewise - linear functions proposed by chakravarthy and osher @xcite :    @xmath71 where    @xmath72 the function @xmath73 equals to zero if @xmath74 and @xmath75 have the different signs and to argument with the minimal modulus otherwise .",
    "the function @xmath70 is linear in the region of the smooth solution : @xmath76 ,    @xmath77    and increases from value @xmath78 to @xmath79 .",
    "the scheme ( [ eq_3002 ] ) has the second or third order of approximation on space in the regions of smooth solution .",
    "this result can be obtained by of expanding of the scheme ( [ eq_3002 ] ) to the taylor series in the neighborhood of point @xmath80 .",
    "the corresponding first difference approximation for the scheme ( [ eq_3002 ] ) is :    @xmath81 therefore at the value @xmath82 in the region of smooth solution the scheme ( [ eq_3002 ] ) attains the third order of approximation in space . for the other values of @xmath83 the scheme ( [ eq_3002 ] )",
    "has the second order of approximation .    the parameters @xmath84 and @xmath85 determine the range of values of the function @xmath70 in the smoothness region ( where @xmath86 ) .",
    "the optimal value of the parameter @xmath87 attains at @xmath88 when @xmath89 . in this case",
    "we can find that @xmath90 , @xmath88 .",
    "the stability condition is determined by last inequality ( [ eq_3003_5 ] ) .",
    "it can be rewritten in the following form :    @xmath91    from this inequality and from the definition of @xmath70 we can obtain the stability condition of courant , friedrichs and lewy ( cfl condition , @xcite ) :    @xmath92    in the case of optimal values of the parameters @xmath82 and @xmath93 we can rewrite ( [ eq_3007a ] ) by the following way :    @xmath94 the developed scheme can be rewritten more briefly in the conservative form :    @xmath95    where    @xmath96    @xmath97    @xmath98 and fluxes @xmath99 .",
    "the developed methodology of difference scheme construction for the linear advection equation can be generalized onto the system of the linear hyperbolic equations :    @xmath100    where @xmath19 is the vector of the unknown variables and @xmath101 is the matrix of the constant coefficients ( hyperbolicity matrix ) .",
    "this system can be rewritten in the conservative form :    @xmath102 with the vector of fluxes : @xmath103 .",
    "the system of equations ( [ eq_3101 ] ) can be represented in the equivalent form of the equations for the riemann invariants    @xmath104    as    @xmath105    where @xmath106 are the left eigenvectors of the matrix @xmath107 and @xmath108 are its eigenvalues .",
    "the original variables @xmath19 can be obtained using the inverse transformation :    @xmath109    where @xmath110 are the right eigenvectors of the matrix @xmath107 .",
    "we approximate each equation in the system ( [ eq_3103 ] ) by the difference scheme ( [ eq_3008 ] ) :    @xmath111    where fluxes    @xmath112    @xmath113    @xmath114    to construct the scheme for the variables @xmath19 we have to perform the transformation ( [ eq_3103xxx ] ) in ( [ eq_3105 ] ) .",
    "finally the scheme reads :    @xmath115    where fluxes are :    @xmath116    @xmath117    @xmath118    @xmath119 where @xmath120 , @xmath121  matrixes of the left and of the right eigenvectors of the matrix @xmath107 respectively .",
    "the difference scheme ( [ eq_3109],[eq_3110new ] ) satisfies to the total variation diminishing ( tvd ) principle @xcite , since it is constructed on the basis of the monotonic schemes for the riemann invariants . in the present paper",
    "we consider the lax  friedrichs schemes with the coefficients @xmath122 .",
    "for this case the fluxes in the base scheme reads @xcite :    @xmath123    during the calculation of fluxes ( [ eq_3110new ] ) the numerical procedure of the @xmath124-evaluation should be called very often . to decrease the computation time we consider a more simple scheme in which the additional fluxes are summed up .",
    "finally the scheme ( [ eq_3109 ] ) is determined by the fluxes :    @xmath125    where    @xmath126 and the fluxes @xmath127 are determined by the expression ( [ eq_3114 ] ) .",
    "this methodology can be generalized easy onto the system of the nonlinear equations :    @xmath128    the finite - difference scheme ( [ eq_3109 ] ) for the system ( [ eq_3117 ] ) is determined by the same fluxes ( [ eq_3114],[eq_3115 ] ) , but the coefficients @xmath59 we should take in the form :    @xmath129    where @xmath108 are the eigenvalues of the hyperbolicity matrix @xmath130 .",
    "we construct now the finite - difference tvd scheme for the isothermal or adiabatical 1d mhd in cartesian coordinates .",
    "we assume that the magnetic field and the velocity have all three components : @xmath131 , @xmath132 .",
    "the mhd equations in the conservative form ,    @xmath102 are determined by the vector of the conservative variables :    @xmath133 and by the vector of the fluxes :    @xmath134    for the adiabatic case the hyperbolicity matrix @xmath107 is    @xmath135    where :    @xmath136 @xmath137 @xmath138 @xmath139 @xmath140 @xmath141 @xmath142 we use here the sound speed , @xmath143 and @xmath144 .",
    "the calculations give the following expressions for the eigenvalues of the hyperbolicity matrix ( [ eq_aaaa ] ) :    @xmath145 @xmath146 the zero value of @xmath147 is the consequence of zero value of the flux @xmath20 component corresponding to @xmath148 .",
    "the value of @xmath149 corresponds to the entropic wave , @xmath150 correspond to the alfvn waves , and @xmath151 correspond to the fast and slow magnetosonic waves . in the isothermal case the entropic wave disappears and instead adiabatical sound speed it should be used the isothermal sound speed @xmath11 .",
    "we should construct now the calculation rule for the coefficients @xmath59 in ( [ eq_3118 ] ) .",
    "the values of these coefficients should be not less than the maximal modulus of all eigenvalues of the hyperbolicity matrix .",
    "it is clear that this condition can be satisfied by the following way :    @xmath152    where    @xmath153 therefore we can keep in the relation ( [ eq_3118 ] ) only eigenvalues corresponding to the fast mhd waves . this",
    "allow us to adapt the scheme ( [ eq_3109],[eq_3114],[eq_3115],[eq_3201 ] ) to the simulation of the 1d mhd flows .",
    "if the magnetic field is absent the fast magnetosonic speed @xmath154 equals the sound speed @xmath155 , therefore the transition to the gasdynamics occurs correctly . with the help of the splitting technique we can construct the scheme for multidimensional ( 2d and 3d ) mhd flows .",
    "one of this scheme for the axisymmetric case we will describe in the next section .",
    "the computational grid is determined by points @xmath156 indexed by integer indexes @xmath157 ; @xmath158 .",
    "these points denote the centers of the grid cells .",
    "the coordinates of the cell boundaries are defined as the arithmetic mean of corresponding coordinates of the cell centers and have half - integer indexes .",
    "the computational variables are related to the centers of the cells and the numerical fluxes are related to the cell boundaries . above we developed the tvd scheme in the frame of 1d mhd approximation .",
    "now we generalize this approach onto the 2d mhd approximation .",
    "the ` base ' difference scheme for equations ( [ eq_2008 ] ) is the following one :    @xmath159 the main problem here is the definition of the calculation rule for the numerical fluxes across the cell boundaries .",
    "let us consider for simplicity only the radial direction because of the expressions of fluxes for the vertical direction can be derived by similar way .",
    "the radial fluxes @xmath160 and @xmath161 should be calculated with the help of the formulae ( [ eq_3114],[eq_3115],[eq_3118 ] ) .",
    "relatively determination of the coefficients @xmath59 we should note the following .    in the definition of the vectors @xmath19 , @xmath20 and @xmath21 in the form ( [ eq_2009a][eq_2009b ] )",
    "the radial coordinate @xmath162 is present .",
    "therefore to calculate eigenvalues of the hyperbolicity matrices we can close formally the system ( [ eq_2008 ] ) by the following obvious equation :    @xmath163 it can be shown that this extension of the original mhd system not changes the standard set of the eigenvalues .    in fact we consider the following system of mhd equations :    @xmath164    with the vector @xmath165 determined as    @xmath166    obviously in cartesian coordinates the eigenvalues of matrices @xmath107 and @xmath167 are determined by the same expressions ( [ eq_3200 ] ) .",
    "let us consider another vector of the variables @xmath19 that consists of @xmath162 and eight components of the vector ( [ eq_2009a ] ) . making the transformation of the equation ( [ eq_4102 ] ) to the new variables @xmath19 we obtain :    @xmath168 where    @xmath169    and matrix @xmath170 is jacobian of transformation .",
    "the determinant of this matrix @xmath171 is not equal to zero . hence the formulae ( [ eq_4103 ] ) describes the similarity transformations of matrices @xmath107 and @xmath167 that does not change their eigenvalues .",
    "this discussion allows us to take the values of the coefficients @xmath172 in ( [ eq_3118 ] ) in the following form :    @xmath173    where @xmath174 these coefficients are determined by eigenvalues that correspond to the fast magnetosonic wave .",
    "the expressions ( [ eq_4104 ] ) can be applied both to the adiabatical and to the isothermal plasma flows .",
    "the energy equation should be excluded in last case and as @xmath155 in ( [ eq_4105 ] ) should be used the isothermal sound speed @xmath11 .",
    "since the fluxes related to the different space directions are constructed independently , the @xmath16-part of the numerical scheme can be developed by similar way .",
    "poisson equation for the gravitational potential is solved by adi - method ( alternating directions implicit method ) of douglas and rachford @xcite :    @xmath175 @xmath176 where @xmath177 is the parameter of scheme implicity , @xmath178 , @xmath179 are second order finite - difference approximations of the corresponding parts of laplacian operator in @xmath162 and @xmath16directions , respectively , @xmath180 is the iteration parameter .",
    "boundary conditions for the gravitational potential on the inner boundaries are regular : @xmath181 .",
    "boundary condition on the external boundary is @xmath182 where @xmath183 is the computing potential , @xmath184 is the external potential of the protostellar cloud .",
    "it can be obtained from poisson integral transformation of equation ( [ eq_2004 ] ) solution :    @xmath185 where @xmath186 , and @xmath187 is the legendre polynomial of @xmath188th order .",
    "all terms with odd @xmath188 are absent in this representation as a result of the axial symmetry .",
    "another difficulty of the numerical simulation of the multidimensional mhd flows is connected with the necessity of the numerical implementation of the vanishing divergence condition for the magnetic field    @xmath190    numerical errors due to discretization and finite - difference differential operator splitting can lead to nonzero divergence over the time .",
    "this problem can be solved by many ways @xcite . in the first approach the 8-wave formulation of the mhd equations",
    "is used ( see also @xcite ) .",
    "another way uses the constrained transport suggested by evans and hawley @xcite . finally , the third approach is the projection scheme @xcite .",
    "our numerical scheme uses the last method ( see @xcite ) .",
    "denote as @xmath191 the magnetic field obtained by the numerical solution of the induction equation ( [ eq_2002 ] ) .",
    "this ` numerical ' magnetic field contains the numerical error @xmath192 , that consist of vortex and potential parts :    @xmath193 + \\nabla \\phi\\,.\\ ] ] therefore exact solution of induction equation is :    @xmath194    vortex part of numerical error @xmath195 $ ] does not contributes to divergence of the magnetic field @xmath13 .",
    "substitution of ( [ eq_4302 ] ) into ( [ eq_4301 ] ) shows that potential @xmath196 must satisfy the poisson equation    @xmath197    resolving this equation numerically for the defined ` numerical ' magnetic field @xmath191 for each time step we calculate the divergence free magnetic field with the help of formula    @xmath198 further we will assume that @xmath199 .",
    "the algorithm is implemented in our numerical code as follows .",
    "denote the central cell with indexes ( @xmath200 , @xmath201 ) by the index @xmath202 for brevity ( see .",
    "fig .  1 ) , the neighbor cells by indexes @xmath203 , @xmath204 , @xmath205 , @xmath206 and intermediate coordinates ( cell boundaries ) by double indexes @xmath207 , @xmath208 etc",
    ".    then we can approximate the divergence of magnetic field by the expression :    @xmath209    where intermediate values are calculated by the formulae    @xmath210 the finite - difference approximation of the laplacian operator is    @xmath211    it is easy to see that if the potential @xmath196 is the exact solution of the finite - difference poisson equation ( [ eq_4303xxx ] ) then the magnetic field @xmath13 ( for which the finite - difference divergence ( [ eq_4303 ] ) is equal to zero exactly ) can be obtained by the formulae :    @xmath212\\,,\\ ] ] @xmath213\\,.\\ ] ]    the poisson equation ( [ eq_4303xxx ] ) for the potential @xmath196 is solved in our scheme by the adi - method that is described in the previous section . as the additional boundary conditions on the inner boundaries ( @xmath214 , @xmath215 ) we use the relations @xmath216 .",
    "on the outer boundaries we use the boundary condition @xmath217 since the external field has identically vanishing divergence .",
    "the numerical code ` moon ' was developed on the basis of the proposed finite - difference scheme .",
    "it can simulate the 1d and 2d selfgravitating mhd flows .",
    "the code is implemented by the programming language c++ and completely object - oriented",
    ". source text of the program uses only standard c++ elements and does not relate to concrete compiler .",
    "the kernel of the code uses intensively the object - oriented library ` numerical tool box ' ( ntb 3.5 ) .",
    "this library was developed by a.g.zhilkin in 1996 for more easy creation of the complex numerical codes . to check the properties of our code we tested it on the number of test problems with known ( exact or approximate ) analytical solutions .",
    "the linear advection of the square density profile was simulated to check the phase - error properties of the numerical scheme .",
    "figure  2 gives the density profile after 100th time step without ( triangles ) and with flux correction ( dots ) .",
    "the computational grid consists of 100 cells .",
    "the analytical solution is drawn by the solid line .",
    "it is seen that the 1st - order of approximation method has a large numerical diffusion .",
    "this diffusion smears the initial profile rapidly , the width of smearing being increased during calculation .",
    "the method of the 3rd - order of approximation produces a profile that is smeared onto 34 cells only and conserves its form during a long time .",
    "we can say therefore that amplitude and phase errors in the scheme of the 3rd - order of approximation are selfconsistent and its order of approximation is not less actually then the approximation order of the so - called lpe - schemes ( little phase error ) ( see @xcite ) . in our opinion",
    "this circumstance is connected with the successful selection of the antidiffusion limiters ( [ eq_3009 ] ) in the scheme ( [ eq_3008 ] ) .",
    "numerical simulation of the arbitrary discontinuity decay ( riemann problem ) allows us to check the scheme properties relating to the resolution of the shock waves , contact discontinuities and rarefaction waves . at the initial time moment the computational domain along the @xmath74-axis was divided on two subdomains @xmath218 and @xmath219 . in the initial state",
    "the pressure and density have the following values : in subdomain @xmath218  @xmath220 , @xmath221 ; in subdomain @xmath219  @xmath222 , @xmath223 . the velocity in both domains @xmath224 and adiabatic index @xmath225 .",
    "figure  3 shows the analytical solution ( solid line ) and the results of the numerical computation ( dots ) at the time moment @xmath226 . as a result of the discontinuity decay the rarefaction wave 1 propagates to the left , contact discontinuity 2 and shock wave",
    "3 propagates to the right .",
    "the figure shows that the scheme resolves the shock wave sufficiently well , but gives the small non - physical oscillations on the contact discontinuity . to smooth it",
    "is necessary to use additional limiters of antidiffusion fluxes .",
    "the numerical simulation of an arbitrary mhd discontinuity decay is the unique possibility to check the mhd properties of the difference scheme .",
    "the problem statement in this test is similar to the problem statement in test 2 .",
    "the initial parameters for this test and its exact analytical solution were taken from paper of ryu and jones @xcite ( variant 1a ) : @xmath227 , @xmath228 , @xmath229 , @xmath230 , @xmath231 , @xmath232 , @xmath233 , @xmath234 , @xmath235 , @xmath236 .",
    "the values of another variables are taken to be zero .",
    "this situation can arise , for example , at the collision of two gaseous masses moving forward each to other at the angle @xmath237 to the direction of the magnetic field .",
    "the results of the numerical computation and the analytical solution of this problem at the time @xmath238 are shown on the fig .",
    "4 . as a result of the discontinuity decay two fast mhd shock waves ( 1 and 5 ) arise and propagate in the opposite directions .",
    "the rotational ( alfvenic ) discontinuity 2 , the contact discontinuity 3 and the slow mhd shock wave 4 are formed between this waves . the slow mhd shock wave propagates immediately after the fast mhd shock wave to the region of the gas with the larger pressure .          in another variant of this test",
    "we consider the riemann problem with the initial state vector @xmath239 ( see @xcite , variant 4c ) : region @xmath218  @xmath240 , region @xmath219  @xmath241 with @xmath242 and @xmath227 . the switch - of slow shock wave is formed in this case .",
    "the results of computations at the time @xmath243 are shown on fig .",
    "5 . a fast mhd shock wave 1 , switch - of slow mhd shock wave 2 , contact discontinuity 3 and",
    "gasdynamical shock wave 4 are formed .",
    "these tests show that the scheme approximation of fast and slow shock waves as well as the rotational ( alfvenic ) discontinuity is good enough . on the contact discontinuities and on the switch - off shock wave small oscillations occur .",
    "the problem of propagation of the finite amplitude alfvn wave ( the simple alfvenic wave ) is interesting because it has the analytical solution ( see @xcite ) .",
    "the comparison of the numerical and the analytical velocity profiles and the magnetic field allows us to make conclusions about behavior of the phase and the amplitude errors in the mhd case .",
    "we solve the following problem . at the initial time moment",
    "the wave is concentrated in the region @xmath244 , where    @xmath245 @xmath246 the wave propagates in the gas with parameters @xmath247 , @xmath248 , @xmath249 , @xmath250 , @xmath251 with velocity @xmath252 without profile distortion . in wave region the tangential component of the magnetic field",
    "rotates with the conservation of its absolute value .",
    "figure  6 . shows the numerical and analytical distributions @xmath253 and @xmath254 at the time moment @xmath255 .",
    "the comparison of these curves with each other allows us to make the conclusion that even in the case of full mhd system the essential smearing of the velocity and the magnetic field profiles is absent during a sufficiently long time of the computation .",
    "hence the phase errors balance the amplitude ones with the high order of accuracy .        to check the diffusion properties of the developed 2d code we obtain the numerical solution of the 2d advection equation ( see similar computations of munz @xcite )    @xmath256 in box domain @xmath257 .",
    "the analytical solution of this equation for the velocity profile    @xmath258 describes the rotation of the density profile around the point ( @xmath259 ) with the angular velocity @xmath260 .",
    "we use in this computation the following values : @xmath261 , @xmath262 . hence to the time @xmath263 the original density profile should carry out one full rotation and return to its initial position .",
    "the computation were done on the uniform grid with the cells number @xmath264 .",
    "we compare the initial state with the profile that obtained after one full rotation .",
    "figure  7a shows the original density profile .",
    "it is split on two regions . in the first region",
    "the density is equal to zero and in the second region the density is equal to @xmath265 .",
    "the boundary of the regions is circle with the cut - out rectangle .",
    "the center of the circle is not coincides with the center of the domain .",
    "figure  7b shows the density profile at the time @xmath263 after one full revolution .",
    "the profile ( as in the 1d case ) is smeared onto 34 cells .",
    "therefore we can conclude that 2d variant of our scheme has the good selfconsistent amplitude - phase properties as well .",
    "the test problem of blast wave expansion in the uniform medium is very crucial for 2d numerical code due to spherical symmetry of the wave .",
    "simulation the blast wave expansion allows us to check how precisely our 2d axisymmetrical numerical code can resolve spherically - symmetrical problems .",
    "we compute , in particular , the expansion of the supernova remnant on the adiabatic stage .",
    "this stage is described by sedov ",
    "taylor solution @xcite , the approximation being true while the radiation cooling is small .",
    "we use the following initial parameters .",
    "the supernovae explosion energy is equal to @xmath266 , the density of the interstellar medium @xmath267 , the spatial scale of the computational domain @xmath268 , the pressure in the central region differs from the pressure in the external medium at the initial time moment approximately by eight order of magnitude .",
    "the scales of the computational values are equal to : for distance  @xmath269 , for velocity  @xmath270 , for pressure  @xmath271 , for time  @xmath272 .",
    "the expansion of the supernova remnant can be followed numerically over the time @xmath273 . the radius of the shock wave increases from @xmath274 to @xmath275 during this time .",
    "figure  8 shows the dependencies of the radius @xmath29 , velocity @xmath276 and the pressure @xmath277 of the shock wave on the time .",
    "all curves correspond to power law : @xmath278 .",
    "we obtained the following exponents : for radius of the shock wave @xmath279 , for velocity @xmath280 , for pressure @xmath281 .",
    "the analytical values are @xmath282 , @xmath283 and @xmath284 .",
    "we see that the numerical values of the exponents are very close to exact sedov ",
    "taylor s values .",
    "the condition of the spherical symmetry over the computations satisfies within the accuracy of 0.3% .      for simulation of free - fall ( pressure - free ) collapse as an initial state",
    "we take the uniform spherically - symmetrical cloud with the mass @xmath285 and with the initial density @xmath286 .",
    "figure  9 shows the evolution of the numerical density ( dots ) of the cloud over the time in comparison with the analytical solution ( solid line ) .",
    "we can see that the numerical points of density coincide with the high accuracy with values of the analytical solution .",
    "the cloud contracts to the point at the free - fall time @xmath287 .",
    "the computation is carried out to time moment when the cloud size decreases to the size of one grid cell .",
    "the difference of numerical and analytical values of density is not greater than 1% at this time and the law of the spherical symmetry conservation satisfies within the accuracy of 0.4% .",
    "the simulation of the selfgravitating polytropic cloud dynamics with the adiabatic index @xmath288 allows us to check the quality and the accuracy of the code in the simulation of the selfgravitating mhd flows .",
    "the hydrostatic equilibrium of polytropic cloud with @xmath288 is indifferent one since the total energy , its first and second variations are equal to zero ( see @xcite ) .",
    "the density distribution of this cloud can be presented by analytical form as @xmath289 , where @xmath290 is the central density , @xmath29 is the cloud radius , @xmath291 ( @xmath292 is the emden function of index 3 and @xmath293 is its first positive zero ) .    to check the accuracy of the conservation of mass , momentum , and energy by our scheme we solve numerically the equations of the gravitational gasdynamics with the initial conditions corresponding to the specified hydrostatic state of the cloud .",
    "we computed several models with different numbers of cells @xmath204 of the spatial grid .",
    "figure  10 shows the density profiles in the case of @xmath264 . from the comparison of numerical ( dots ) and analytical ( solid line ) density profiles on this figure",
    "we conclude that the relative error of the numerical solution compared with the analytical one at the time @xmath294 is less than 2% .",
    "the law of total mass conservation over the computations satisfies within the accuracy of 0.003% and the law of the total energy conservation satisfies within the accuracy of 2% .",
    "this problem was solved on the grids with the number of cells @xmath295 , @xmath296 and @xmath297 as well .",
    "we can say that the relative error of the numerical solution obtained by the time @xmath298 decreases with the increasing of the cells number . in the case of @xmath299",
    "it equals to 20% while in the case of @xmath300  7% , and for @xmath301 it is less than one percent .",
    "we can conclude therefore that the convergence of the numerical solution to the analytical one with the rise of the grid resolution takes place .",
    "in another variant of this test we specified the deviation from the hydrostatic equilibrium at the initial time moment by the velocity distribution @xmath302 .",
    "the cloud radius in this case evolves in time in accordance with the law @xmath303 and the evolution of the density and the velocity in the cloud can be described by the following analytical dependencies :    @xmath304 to the time @xmath305 the cloud will contract to the point .",
    "figure  11 shows the numerical distributions of the density ( circles ) and the velocity ( triangles ) for different times .",
    "the solid lines correspond to analytical curves . from analysis of this figure",
    "we can conclude that the numerical solution with the high accuracy coincides with the analytical one while the grid resolution is sufficient for the adequate spatial approximation of the central region .",
    "for the variant with @xmath264 this corresponds approximately to the time moment @xmath306 ( see fig .",
    "protostellar clouds as the cores of interstellar molecular clouds consist of neutral ( atoms , molecules and cosmic dust particles ) and charged ( electrons , ions and charged dust ) components .",
    "the equations of similar multicomponent mixture are very complex for the numerical simulations .",
    "the more rough ideal mhd approximation can be used as a first approach .",
    "contracting cloud is transparent to infrared self - radiation on the early stages of collapse .",
    "therefore the initial phases of protostellar collapse can be considered as the isothermal ones with the good approximation .",
    "this approximation works while the optical depth of the collapsing cloud core becomes comparable with the unity .",
    "we performed the computation of the isothermal magnetized cloud collapse using the uniform grid with the cells number @xmath307 and courant number @xmath308 .",
    "we use the following values of parameters .",
    "the initial ratio of the thermal and kinetic rotational energies to the absolute value of the gravitational energy @xmath309 , @xmath310 , respectively .",
    "the mass of the protostellar cloud @xmath311 and its temperature @xmath312 .",
    "one the basis of the relations ( [ eq_2014][eq_2017 ] ) we can conclude that these parameters correspond to the cloud with the initial density @xmath313 and radius @xmath314 . as a result of computations we calculate the flatness degree ( ratio of the cloud thikness to its radius ) and the central density up to the free - fall time .      the simplest case of the collapse corresponds to infinitesimally weak magnetic field .",
    "if the initial value @xmath315 then we can neglect the influence of the magnetic field on the collapse dynamics . the magnetic field can be considered as a passive admixture and for the given velocity field and may be determined from the equation of induction ( [ eq_2002 ] ) .    the results of computations show that in this kinematic approach the magnetic field @xmath316 with @xmath317 since of the cloud contraction is practically spherically - symmetrical one . note that in the cloud envelope this law fulfills approximately and in the forming core it satisfies exactly @xcite .",
    "the computations confirm the early obtained conclusion that the magnetic field in the cloud acquires with the time the quasi - radial geometry ( see fig .",
    "12 ) @xcite .",
    "this geometry of the field becomes distinct already to the free - fall time .      in the case of intermediate magnetic fields ( @xmath318 )",
    "the collapse picture drastically differs from the kinematic statement .",
    "the gas particles moving across the magnetic field lines are deviated to the equatorial plane by the electromagnetic forces . as a result",
    "the flat ( disk - like ) structure is formed . figure  13 shows the typical density profiles and geometry of the magnetic field lines at the moment of time equal to the magnetic free - fall time    @xmath319 ( see @xcite ) .",
    "the magnetic field in the disk is almost quasi - uniform and the ratio @xmath320 is small .",
    "numerical simulations show that at the free - fall time the flatness degree of the disk is proportional to @xmath321 and the central density is inversely proportional to @xmath43 .",
    "the growth of the initial magnetic field leads to the increase of the electromagnetic forces that support the cloud from the contraction .",
    "therefore at the large initial values @xmath43 the cloud relaxes to the quasi - steady - state equilibrium .",
    "such a cloud should evolve within the diffusion time scale that is determined by the ambipolar diffusion of the magnetic field .",
    "the cloud loses the magnetic flux by the ambipolar diffusion and slowly contracts retaining the quasi - hydrostatic equilibrium . as a result",
    "this evolution the non - uniform profile of the density is formed .",
    "the lifetime of such molecular cloud cores can reach @xmath322 years .",
    "the explicit conservative finite - difference tvd scheme of high resolution for the solution of various mhd problems is constructed . the numerical mhd code",
    "` moon ' on the basis of this scheme is developed that can simulate the mhd flows in the 1d and 2d approximations .",
    "the results of extensive tests show that the code is well adapted to the simulation of many mhd problems of plasma physics and astrophysics .    to check the dissipative properties of the developed scheme the problems of 1d and 2d advection",
    "are solved .",
    "the results of these tests show that the scheme smears the initial density profile onto 34 cells . in the test computation of the blast wave the condition of the spherical symmetry satisfies within the accuracy of 0.3% .    to analyze the convergence of the numerical solution to the analytical one the problem of the hydrostatic equilibrium of the selfgravitating polytropic cloud with the adiabatic index @xmath288 is computed on the grids with various number of cells .",
    "the obtained results allow us to conclude that the errors of the numerical solution decrease to the permissible values on the grids with the number of cells not less than @xmath323 . in the case",
    "@xmath324 the relative error of the numerical solution at the time moment @xmath325 is less that 1% .",
    "the numerical solution in this case coincides with the good accuracy with the analytical one while the grid resolution in the central region is sufficient for acceptable approximation of the grid values .",
    "the numerical computations of the collapse of the magnetized protostellar cloud confirms the earlier obtained results in the framework of 1.5d approximation ( see @xcite ) .",
    "the magnetic field in the cloud with the initially small intensity acquires the quasi - radial geometry after some time .",
    "the intermediate magnetic field leads to flattening of the collapsing clouds on the late stages of contraction . for the strong initial magnetic field the cloud relaxes to quasi - hydrostatic equilibrium .",
    "such a cloud must evolve within the diffusion time scale .",
    "note that we can not simulate numerically the advanced stages of the collapse because the described code ` moon ' uses the uniform grid only .",
    "but investigation of these stages is very important and interesting problem to understand the physics of the formation and further evolution of young stellar objects .",
    "we are elaborating now the adaptive mesh refinement ( amr ) numerical algorithm for the simulation of advanced stages of rotating magnetized protostellar cloud collapse .",
    "the amr - approach uses the tree - threaded collection of subgrids with the subsequently increasing grid resolution .",
    "we are constructing a new 2d mhd numerical code ` megalion ' that based on the described in this paper high - resolution tvd scheme for the gravitational compressible mhd flows .",
    "this code will allow us to simulate various selfgravitating mhd flows with the large gradients and fast time variations .",
    "new numerical code will take into account also the processes of ambipolar diffusion , non - stationary ionization and heating / cooling .",
    "a.v.koldoba , o.a.kuznetsov , g.v.ustyugova , quasi - monotonic difference schemes of high - order approximation for mhd equations , preprint of keldysh institute of applied mathematics n 69 ( 1992 , in russian ) .",
    "c.v.vyaznikov , v.f.tishkin , a.p.favorsky , construction of quasi - monotonic difference schemes of high - order approximation for hyperbolic type systems of equations , mat .",
    "modelirovanie 1 n5 ( 1989 ) 95120 ( in russian ) ."
  ],
  "abstract_text": [
    "<S> the explicit quasi - monotonic conservative tvd scheme and numerical method for the solution of the gravitational mhd equations are developed . </S>",
    "<S> the 2d numerical code for the simulation of multidimensional selfgravitating mhd flows on the eulerian cylindrical grid is constructed . </S>",
    "<S> the results of test calculations show that the code has a good mathematical and computational properties and can be applied to the solution of a wide class of plasma physics and astrophysics problems . </S>",
    "<S> we have simulated , for example , a collapse of magnetized rotating protostellar clouds .    </S>",
    "<S> # 1*#1 *    # 1#2#1#2    ,    ,    hydrodynamics ; magnetohydrodynamics ; star formation ; molecular clouds + </S>"
  ]
}