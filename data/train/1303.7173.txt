{
  "article_text": [
    "recent technological advances , together with environmental and economic challenges , have been motivating the deployment of small power generators in the low voltage and medium voltage power distribution grid .",
    "the availability of a large number of these generators in the distribution grid can yield relevant benefits to the network operation , which go beyond the availability of clean , inexpensive electrical power .",
    "they can be used to provide a number of ancillary services that are of great interest for the management of the grid @xcite .",
    "we focus in particular on the problem of optimal reactive power compensation for power losses minimization and voltage support . in order to properly command the operation of these devices , the distribution network operator is required to solve an",
    "_ optimal reactive power flow _",
    "( orpf ) problem .",
    "powerful solvers have been designed for the orpf problem , and advanced optimization techniques have been recently specialized for this task @xcite . however , these solvers assume that an accurate model of the grid is available , that all the grid buses are monitored , that loads announce their demand profiles in advance , and that generators and actuators can be dispatched on a day - ahead , hour - ahead , and real - time basis . for this reason ,",
    "these solvers are in general offline and centralized , and they collect all the necessary field data , compute the optimal configuration , and dispatch the reactive power production at the generators .",
    "these tools can not be applied directly to the orpf problem faced in microgrids and , more in general , in low / medium voltage power distribution networks .",
    "the main reasons are that not all the buses of the grid are monitored , individual loads are unlikely to announce they demand profile in advance , the availability of small size generators is hard to predict ( being often correlated with the availability of renewable energy sources ) .",
    "moreover , the grid parameters , and sometimes even the topology of the grid , are only partially known , and generators are expected to connect and disconnect , requiring an automatic reconfiguration of the grid control infrastructure ( the so called _ plug and play _ approach ) .",
    "different strategies have been recently proposed in order to address these issues , ranging from purely local algorithms , in which each generator is operated according to its own measurements @xcite , to distributed approaches that do not require any central controller , but still require measurements at all the buses of the distribution grid @xcite .",
    "only recently , algorithms that are truly scalable in the number of generators and do not require the monitoring of all the buses of the grid , have been proposed for the problem of power loss minimization ( with no voltage constraints ) @xcite .",
    "while these algorithms have been designed by specializing classical nonlinear optimization algorithms to the orpf problem , they can also be considered as _ feedback _ control strategies .",
    "indeed , the key feature of these algorithms is that they require the alternation of measurement and actuation based on the measured data , and therefore they are inherently online algorithms . in particular , the reactive power injection of the generators is adjusted by these algorithms based on the phasorial voltage measurements that are performed at the buses where the generators are connected .",
    "the resulting closed loop system features a tight dynamic interconnection of the _ physical layer _ ( the grid , the generators , the loads ) with the _ cyber layer _ ( where communication , computation , and decision happen ) . in this paper",
    ", we design a distributed feedback algorithm for the orpf problem with voltage constraints , in which the goal is to minimize reactive power flows while ensuring that the voltage magnitude across the network is larger than a given threshold .    in section [ sec : problem_formulation ] , a model for the cyber - physical system of a smart power distribution grid is provided . in section [ sec : orpf ] , the optimal reactive power flow problem with voltage constraints is stated .",
    "an algorithm for its solution is derived in section  [ sec : dual ] , by using the tools of dual decomposition .",
    "a synchronous and an asynchronous version of the algorithm are presented in section  [ sec : synchronous ] and section  [ sec : asynchronous ] , respectively .",
    "the convergence of both the proposed algorithms is studied in section  [ sec : convergence ] .",
    "some simulations are provided in section  [ sec : simulations ] , while section  [ sec : conclusion ] concludes the paper discussing some relevant features of the feedback nature of the proposed strategy .",
    "let @xmath0 be a directed graph , where @xmath1 is the set of nodes , @xmath2 is the set of edges , and @xmath3 are two functions such that edge @xmath4 goes from the source node @xmath5 to the terminal node @xmath6 . given two nodes of the graph @xmath7 , we define the path @xmath8 as the sequence of nodes , without repetitions , such that    * @xmath9 * @xmath10 * for each @xmath11 , the nodes @xmath12 and @xmath13 are connected by an edge .    in the rest of the paper we will often introduce complex - valued functions defined on the nodes and on the edges .",
    "these functions will also be intended as vectors in @xmath14 ( where @xmath15 ) and @xmath16 .",
    "given a vector @xmath17 , we denote by @xmath18 its ( element - wise ) complex conjugate , and by @xmath19 its transpose .",
    "we denote by @xmath20 and by @xmath21 the real and the imaginary part of @xmath17 , respectively .",
    "let moreover @xmath22 be the incidence matrix of the graph @xmath23 , defined via its elements @xmath24_{ev } = \\left\\{\\begin{array}{cl } -1 & \\text{if } v=\\sigma(e ) \\\\ 1 & \\text{if } v=\\tau(e ) \\\\ 0 & \\text{otherwise . }",
    "\\end{array}\\right.\\ ] ]    if the graph @xmath23 is connected ( i.e. for every pair of nodes there is a path connecting them ) , then @xmath25 is the only vector in the null space @xmath26 , @xmath25 being the column vector of all ones .",
    "we define by @xmath27 the vector whose value is @xmath28 in position @xmath29 , and @xmath30 everywhere else .",
    "in this work , we envision a _",
    "smart _ power distribution network as a cyber - physical system , in which    * the * physical layer * consists of the power distribution infrastructure , including power lines , loads , microgenerators , and the point of connection to the transmission grid , while * the * cyber layer * consists of intelligent agents , dispersed in the grid , and provided with actuation , sensing , communication , and computational capabilities .      for the purpose of this paper , we model the physical layer of a smart power distribution network as a directed graph @xmath23 , in which edges represent the power lines , and nodes represent the devices that are connected to the grid ( see figure  [ fig : microgrid_model ] , middle panel ) .",
    "these include loads , microgenerators , and also the point of connection to the transmission grid ( called point of common coupling , or pcc , and indexed as node @xmath30 ) .",
    "we limit our study to the steady state behavior of the system , when all voltages and currents are sinusoidal signals at the same frequency . each signal can therefore be represented via a complex number @xmath31 whose absolute value @xmath32 corresponds to the signal root - mean - square value , and whose phase @xmath33 corresponds to the phase of the signal with respect to an arbitrary global reference .    in this notation ,",
    "the steady state of the grid is described by the following system variables ( see figure  [ fig : microgrid_model ] , lower panel ) :    * @xmath34 , where @xmath35 is the grid voltage at node @xmath29 ; * @xmath36 , where @xmath37 is the current injected by node @xmath29 ; * @xmath38 , where @xmath39 is the current flowing on the edge @xmath40 .    for every edge @xmath40 of the graph ,",
    "we define by @xmath41 the impedance of the corresponding power line .",
    "we assume the following .    [",
    "ass : theta ] all power lines in the grid have the same inductance / resistance ratio , i.e. @xmath42 for any @xmath40 in @xmath2 and for a fixed @xmath43 .",
    "this assumption is satisfied when the grid is relatively homogeneous , and is reasonable in most practical cases ( see for example the ieee standard testbeds @xcite ) .",
    "the following physical constraints are satisfied by @xmath44 and @xmath45 @xmath46 where @xmath47 is the incidence matrix of @xmath23 , and @xmath48 is the diagonal matrix of line impedances .",
    "equation corresponds to kirchhoff s current law ( kcl ) at the nodes , while describes the voltage drop on the edges of the graph . from and we can also obtain @xmath49 where @xmath50 is the weighted laplacian of the graph @xmath51 .",
    "each node @xmath29 of the grid is also characterized by a law relating its injected current @xmath37 with its voltage @xmath35 .",
    "we model the pcc as an ideal sinusoidal voltage generator at the microgrid nominal voltage @xmath52 with arbitrary , but fixed , angle @xmath53 @xmath54 in the power system analysis terminology , node @xmath30 is then a _ slack bus _ with fixed voltage magnitude and angle .",
    "we model loads and microgenerators ( that is , every node @xmath29 of the microgrid except the pcc ) via the following law relating the voltage @xmath35 and the current @xmath37 @xmath55 where @xmath56 is the injected _ complex power_. the quantities @xmath57 are denoted as _ active _ and _ reactive _ power , respectively .",
    "the complex powers @xmath56 corresponding to grid loads are such that @xmath58 , meaning that positive active power is _ supplied _ to the devices .",
    "the complex powers corresponding to microgenerators , on the other hand , are such that @xmath59 , as positive active power is _ injected _ into the grid . in the power system analysis terminology , all nodes but the pcc are being modeled as _ constant power _ or _",
    "p - q buses_. microgenerators fit in this model , as they generally are commanded via a complex power reference and they can inject it independently from the voltage at their point of connection @xcite .",
    "we assume that every microgenerator , and also the pcc , correspond to an _ agent _ in the cyber layer ( see the upper panel of figure  [ fig : microgrid_model ] ) .",
    "we denote by @xmath60 ( with @xmath61 ) this subset of the nodes of @xmath23 .",
    "each agent is provided with some computational capability , and with some sensing capability , in the form of a phasor measurement unit ( i.e. a sensor that can measure voltage amplitude and angle @xcite ) .",
    "agents that corresponds to a microgenerator can also actuate the system , by commanding the amount of reactive power injected by that microgenerator ( see figure  [ fig : agents ] ) .    )",
    ", which is provided with voltage measurement capabilities .",
    "the second panel represents all the other agents , corresponding to microgenerator nodes , which are instead provided with both measurement and actuation capabilities .",
    "all the agent can also communicate via some communication channel , and have some on - board computational power.,title=\"fig:\",width=207 ] + ) , which is provided with voltage measurement capabilities .",
    "the second panel represents all the other agents , corresponding to microgenerator nodes , which are instead provided with both measurement and actuation capabilities .",
    "all the agent can also communicate via some communication channel , and have some on - board computational power.,title=\"fig:\",width=207 ]    finally , agents can communicate , via some communication channel that could possibly be the same power lines ( via power line communication  plc  technology ) . motivated by this possibility",
    ", we define the neighbors in the cyber layer in the following way .",
    "let @xmath62 be an agent of the cyber layer .",
    "the set of agents that are neighbors of @xmath63 in the cyber layer , denoted as @xmath64 , is the subset of @xmath60 defined as @xmath65 [ neighbors ]    figure  [ fig : neighbors ] gives an example of such set .    ) .",
    "nodes circled in black belong to the set @xmath66 .",
    "node circled in gray are agents which do not belong to the set of neighbors of @xmath63 .",
    "for each agent @xmath67 , the path that connects @xmath63 to @xmath68 does not include any other agent besides @xmath63 and @xmath68 themselves.,title=\"fig:\",width=230 ] ( -71,81)@xmath63 ( -120,116)@xmath67 ( -195,47)@xmath69    we assume that every agent @xmath70 knows its set of neighbors @xmath64 , and can communicate with them . notice that this architecture can be constructed by each agent in a distributed way , for example by exploiting the plc channel ( as suggested for example in @xcite ) .",
    "this allows also a plug - and - play reconfiguration of such architecture when new agents are connected to the grid .",
    "we consider the problem of commanding the reactive power injection of the microgenerators in order to minimize power distribution losses on the power lines and to guarantee that the voltage magnitude stays above a given threshold .",
    "the decision variables ( or , equivalently , the inputs of the system ) are therefore the reactive power commands @xmath71 .",
    "power distribution losses can be expressed , by using , as @xmath72 given a lower bound @xmath73 for the voltage magnitudes , we can therefore formulate the following optimization problem ,    @xmath74    [ eq : orpf ]    where voltages @xmath17 are a function of the decision variables @xmath75 via the implicit relation defined by the system of nonlinear equations , , and . while we are not considering upper bounds on the bus voltage magnitudes , in the form @xmath76",
    ", it will be clear in the following that they could be easily incorporated with minor modifications of the algorithm , at the cost of a slightly more complex notation .    in order to adopt a compact notation for the system inputs ,",
    "measured outputs , and state , we introduce the following block decomposition of the vector of voltages @xmath17 @xmath77 where @xmath78 is the voltage at the pcc , @xmath79 are the voltages at the microgenerators , and @xmath80 are the voltages at the loads .    similarly , we also define @xmath81 and @xmath82 .    from a system - wide prospective ,",
    "the control problem that we are considering is therefore characterized by    * the input variables @xmath83 , * the measured output variables @xmath84 , * the unmeasured disturbances @xmath85 , @xmath86 , @xmath87 .    while the decision variables of the orpf problem ( i.e. the input variables @xmath83 ) do not include the reactive power provided to the distribution grid by the pcc ( i.e. @xmath88 ) , this quantity will also change every time the reactive power injections of the generators are updated by the algorithm , because the inherent physical behavior of the slack bus ( the pcc ) ensures that equations , and are automatically satisfied at every time .",
    "in this section , in order to derive a control strategy to solve the orpf problem , we apply the tool of dual decomposition to . while problem might not be convex in general , we rely on the results presented in @xcite which show that zero duality gap holds for the orpf problems , under some conditions that are commonly verified in practice . based on this result , we use an approximate explicit solution of the nonlinear equations , , and , to derive the a _ dual ascent algorithm _ @xcite that can be implemented by the agents .    in order to present the approximate solution , we need the following technical lemma .",
    "let @xmath50 be the weighted laplacian of @xmath23 .",
    "there exists a unique symmetric , positive semidefinite matrix @xmath89 such that @xmath90 [ lemma : x ]    the matrix @xmath91 depends only on the topology of the grid power lines and on their impedance ( compare it with the definition of green matrix in @xcite ) .",
    "the matrix @xmath91 has some notable properties , including the fact that @xmath92 and the fact that @xmath93 where @xmath94 represents the _ effective impedance _ of the power lines between node @xmath63 and @xmath68 . notice that , if the grid is radial ( i.e. @xmath23 is a tree ) then @xmath94 is simply the impedance of the only path from node @xmath63 to node @xmath68 .    by adopting the same block decomposition as before",
    ", we have @xmath95 with @xmath96 , @xmath97 , and @xmath98 .",
    "the following proposition provides the approximate relation between the grid voltages and the power injections at the nodes .",
    "consider the physical model described by the set of nonlinear equations , , , and .",
    "node voltages then satisfy @xmath99 where the little - o notation means that @xmath100 .",
    "[ pro : approximation ]    the proposition descends directly from proposition 1 in @xcite .",
    "the quality of this approximation relies on having large nominal voltage @xmath52 and relatively small currents injected by the inverters ( or supplied to the loads ) .",
    "this assumption is verified in practice , and corresponds to correct design and operation of power distribution networks , where indeed the nominal voltage is chosen sufficiently large ( subject to other functional constraints ) in order to deliver electric power to the loads with relatively small power losses on the power lines . in @xcite , a brief discussion about how this approximation extends the dc power flow model ( * ? ? ?",
    "* chapter 3 ) to the lossy case , has been provided .",
    "given the approximate explicit expression for voltages @xmath17 presented in proposition  [ pro : approximation ] , we proceed by specializing the dual - ascent algorithm to problem .",
    "the lagrangian of the problem is @xmath101 where @xmath102 is the lagrangian multiplier ( i.e. , the dual variables of the problem ) , where @xmath103 , and where @xmath104 are the normalized squared voltage magnitudes at the generators @xmath105 @xmath106 being the operator for element - wise multiplication .",
    "notice that , in order to simplify the derivation of the algorithm , we squared and normalized the left and right hand side of the inequalities , without this having any effect on the optimization problem .",
    "again , @xmath107 and @xmath104 are implicit functions of the decision variables @xmath83 , even if the dependence has been omitted in the notation .",
    "a dual ascent algorithm consists in the iterative execution of the following alternated steps    1 .",
    "minimization of the lagrangian with respect to the primal variables @xmath83 @xmath108 2",
    ".   dual gradient ascent step on the dual variables @xmath109_+ , \\label{eq : step2}\\ ] ] where the @xmath110_+$ ] operator corresponds to the projection on the positive orthant , and where @xmath111 is a suitable positive constant .    in order to derive an expression for the minimizer @xmath112 in",
    ", we need the following lemma .",
    "consider the lagrangian @xmath113 defined in .",
    "the partial derivative with respect to the primal variables @xmath83 is @xmath114 [ lem : primalderivative ]    from we have that @xmath115 in order to derive @xmath116 , we introduce the orthogonal decomposition @xmath117 with @xmath118 .",
    "we then have that , via proposition [ pro : approximation ] , @xmath119 and similarly @xmath120 by using the fact that @xmath121 , we have @xmath122 l u ''   + o\\left(\\frac{1}{u_n^2}\\right)\\\\ & \\quad = \\frac{2}{u_n^2 } \\begin{bmatrix } 0 & m & n \\end{bmatrix } l   \\begin{bmatrix } 0 & 0 & 0 \\\\   0 & m & n \\\\ 0 & n^t & q \\end{bmatrix } \\begin{bmatrix } 0 \\\\   q_g \\\\",
    "q_l \\end{bmatrix } + o\\left(\\frac{1}{u_n^2}\\right)\\\\ & \\quad = \\frac{2}{u_n^2 } \\left(m q_g + n q_l",
    "\\right ) + o\\left(\\frac{1}{u_n^2}\\right ) , \\end{split } \\label{eq : primalderivative2}\\ ] ] where we used the fact that @xmath123 and that , by lemma [ lemma : x ] , @xmath124 .",
    "the same approximate solution , via some algebraic manipulations , allows us to express @xmath104 as @xmath125 we therefore have that @xmath126 and finally , from , , and , @xmath127    given lemma [ lem : primalderivative ] , we propose the following update step for @xmath83 to minimize the lagrangian with respect to the primal variables @xmath128 indeed , by plugging into the expression for the partial derivative of the lagrangian with the respect to @xmath83 , provided in lemma [ lem : primalderivative ] , we obtain @xmath129 which vanishes for large nominal voltage @xmath52 .    in order to derive the dual ascent step for the lagrangian ,",
    "it is enough to evaluate @xmath130 to see that @xmath131 in accordance to the well known result in dual decomposition that the dual ascent direction is given by the constraint violation .",
    "the proposed dual ascent step will therefore simply be @xmath132_+ , \\label{eq : updatelambda}\\ ] ] for some suitable @xmath133 , where we recall that @xmath104 is defined element - wise as @xmath134 .",
    "it is well known that the dual ascent method guarantees primal feasibility of the solution , but does not guarantee primal feasibility of each intermediate step .",
    "therefore , in the scenario that we are considering , voltage constraints will not be satisfied at every time .",
    "this is however acceptable : voltage constraints can be intended as soft constraints , because they do not derive from physical constraints on the system ( like kirchhoff laws ) .",
    "it will be shown via simulations in section  [ sec : simulations ] how the constraint violation is actually quite limited , also in the case of time - varying loads .",
    "in this section , we show how the agents can implement the primal and dual steps and derived in the previous section .",
    "we assume here that the agents are coordinated , i.e. they can update their state variables @xmath135 and @xmath136 , @xmath137 , synchronously .    in order to derive the update law for the agents ,",
    "we need to introduce the following matrix @xmath138 .",
    "there exists a unique symmetric matrix @xmath139 such that @xmath140 [ lem : g ]    the following symmetric matrix @xmath138 satisfies the conditions .",
    "@xmath141 the proof of uniqueness , that we omit here , follows exactly the same steps as in the proof of lemma [ lemma : x ] .",
    "the matrix @xmath138 has also a remarkable sparsity pattern , as the following lemma states .",
    "the matrix @xmath138 has the sparsity pattern induced by the definition [ neighbors ] of neighbor agents in the cyber layer , i.e. @xmath142 [ lem : sparsity ]    the proof is provided in the appendix [ app : g ] , where we also discuss how the elements of @xmath138 can be estimated by the agents , given a local knowledge of the power grid topology and parameters .",
    "we therefore propose the following synchronous algorithm .",
    "+ * synchronous algorithm *    let all agents ( except the pcc ) store an auxiliary scalar variable @xmath136 .",
    "let @xmath111 be a positive scalar parameter , and let @xmath43 be the impedance angle defined in assumption  [ ass : theta ] .",
    "let @xmath143 be the elements of the matrix @xmath138 defined in lemma  [ lem : g ] .",
    "at every synchronous iteration of the algorithm , each agent @xmath144 executes the following operations in order :    * gathers the voltage measurements @xmath145 from its neighbors ; * updates the auxiliary variable @xmath136 as @xmath146_+ ; \\label{eq : lambda - sync}\\ ] ] * based on the new value of @xmath136 , updates the injected reactive power @xmath135 as @xmath147    it can be shown , by using lemma [ lem : sparsity ] and via some algebraic manipulation , that the update can be also rewritten as @xmath148 which , by using the expression for @xmath17 provided by proposition [ pro : approximation ] , is equal to @xmath149    similarly to what has been done in , we have that after the update @xmath150 and therefore the update minimized the lagrangian with respect to the primal variables , up to a term that vanishes for large @xmath52 .",
    "it is important to notice that the proposed synchronous algorithm requires that the agents actuate the system at every iteration , by updating the amount of reactive power that the agent command to the microgenerators . only by doing so",
    ", the subsequent measurement of the voltages will be informative of the new state of the system .",
    "the resulting control strategy is thus a _ feedback strategy _ that necessarily requires the real - time interaction of the controller ( the cyber layer ) with the plant ( the physical layer ) , as depicted in figure  [ fig : feedback ] .",
    "this tight interaction between the cyber layer and the physical layer is the fundamental feature of the proposed approach , and allows to drive the system towards the optimal configuration , which depends also on the reactive power demand of the loads , without collecting this information from them . in a sense ,",
    "the algorithm is inferring this hidden information from the measurement performed on the system during its execution .",
    "in order to avoid the burden of coordination among the agents , we also propose an asynchronous version of the algorithm , in which the agents corresponding to the microgenerators update their state @xmath151 independently one from the other , based on the information that they can measure and that they can gather from their neighbors .",
    "we assume that each agent ( except for the agent located at the pcc ) is provided with an individual timer , by which it is triggered .",
    "timers tick randomly , with exponentially , identically distributed waiting times .",
    "+ * asynchronous algorithm *    let all agents ( except the pcc ) store an auxiliary scalar variable @xmath136 .",
    "let @xmath111 be a positive scalar parameter , and let @xmath43 be the impedance angle defined in assumption  [ ass : theta ] .",
    "let @xmath143 be the elements of the matrix @xmath138 defined in lemma  [ lem : g ] .",
    "when agent @xmath144 is triggered by its own timer , it performs the following actions in order :    * gathers the voltage measurements @xmath152 from its neighbors ; * updates the auxiliary variable @xmath136 as @xmath146_+;\\ ] ] * based on the new value of @xmath136 , updates the injected reactive power @xmath135 as @xmath153    the update equations for the asynchronous algorithm are exactly the same of the synchronous case . here",
    ", however , we update both the primal and the dual variable of the agents independently and asynchronously .",
    "in this section , we study the convergence of both the synchronous algorithm proposed in section [ sec : synchronous ] and of the asynchronous algorithm proposed in section [ sec : asynchronous ] . for the analysis of the stability of both of them ,",
    "we adopt again the approximated model proposed in proposition [ pro : approximation ] , and we neglect the infinitesimal terms .",
    "notice that , by neglecting the infinitesimal terms , both the voltages @xmath17 and the squared voltage magnitudes @xmath104 become affine functions of the decision variables @xmath83 , and therefore the orpf problem becomes a convex quadratic problem with linear inequality constraints , for which strong duality holds .",
    "let us define @xmath154    for the synchronous case we consider the update equations @xmath155_+ , \\label{eq : appl}\\ ] ] for the dual variables , and @xmath156 for the primal variables .",
    "notice that the equilibrium @xmath157 of - is characterized by @xmath158 and therefore , via and via lemma [ lem : primalderivative ] , we have that @xmath159 and @xmath160 which correspond , up to infinitesimal terms , to the necessary conditions for the optimality of @xmath157 according to uzawa s saddle point theorem @xcite .    the following convergence result holds .",
    "[ th : s ] consider the dynamic system described by the update equations and .",
    "the equilibrium @xmath161 is asymptotically stable if @xmath162 where @xmath163 is the number of microgenerators and @xmath164 is the maximum electric distance of a microgenerator from the pcc .    the proof is presented in appendix [ app : convergence ] .    for the asynchronous case , on the other hand , we introduce the following assumption",
    ".    let @xmath165 , @xmath166 , be the time instants in which the agent @xmath63 is triggered by its own timer .",
    "we assume that the timer ticks with exponentially distributed waiting times , identically distributed for all the agents in @xmath167 .",
    "[ ass : timers ]    let us define the random sequence @xmath168 which tells which agent has been triggered at iteration @xmath169 of the algorithm . because of assumption [ ass : timers ] , the random process @xmath170 is an i.i.d .",
    "uniform process on the alphabet @xmath167 .",
    "we therefore consider the following update equations , in which only the component @xmath170 of the vectors @xmath83 and @xmath102 is updated at time @xmath169 :    @xmath171_+ \\\\",
    "\\lambda_k(t+1 ) = \\lambda_k(t+1 ) \\quad \\text{for all } k\\ne h(t ) , \\end{cases } \\label{eq : applasyn}\\ ] ]    and @xmath172    notice that , also in the asynchronous case , uzawa s necessary conditions for optimality are satisfied at the equilibrium of - .",
    "the following convergence result holds .",
    "[ th : a ] consider the dynamic system described by the update equations and .",
    "let assumption [ ass : timers ] hold .",
    "then the evolution @xmath173 converges almost surely to the equilibrium @xmath161 if @xmath162 where @xmath163 is the number of microgenerators and @xmath164 is the maximum electric distance of a microgenerator from the pcc .    the proof is presented in appendix [ app : convergence ] .",
    "the algorithm has been tested on the testbed ieee 37 @xcite , which is an actual portion of 4.8kv power distribution network located in california .",
    "the load buses are a blend of constant - power , constant - current , and constant - impedance loads , with a total power demand of almost 2 mw of active power and 1 mvar of reactive power ( see @xcite for the testbed data ) .",
    "the length of the power lines range from a minimum of 25 meters to a maximum of almost 600 meters .",
    "the impedance of the power lines differs from edge to edge ( for example , resistance ranges from 0.182 @xmath174/km to 1.305 @xmath174/km ) .",
    "however , the inductance / resistance ratio exhibits a smaller variation , ranging from @xmath175 to @xmath176 .",
    "this justifies assumption [ ass : theta ] , in which we claimed that @xmath177 can be considered constant across the network .",
    "we considered the scenario in which @xmath178 microgenerators have been deployed in this portion of the power distribution grid ( see figure  [ fig : ieee37 ] ) .",
    "microgenerators have been deployed.,scaledwidth=30.0% ]    the lower bound for voltage magnitudes has been set to 96% of the nominal voltage .",
    "both the synchronous and the asynchronous algorithm presented in section  [ sec : synchronous ] and [ sec : asynchronous ] have been simulated on a nonlinear exact solver of the grid @xcite .",
    "the approximate model presented in proposition  [ pro : approximation ] has not been used in these simulations , being only a tool for the design of the algorithm and for the study of the algorithm s convergence .",
    "the parameter @xmath111 has been chosen as one half of the bound indicated by theorem  [ th : s ] and theorem  [ th : a ] for convergence .",
    "timers in the asynchronous case have been tuned so that each agent is triggered , in expectation , at the same rate of the synchronous case .",
    "a time - varying profile for the loads has been generated , in order to simulate the effect of slowly varying loads ( e.g. the aggregate demand of a residential neighborhood ) , fast changing demands ( e.g. some industrial loads ) , and intermittent large loads ( e.g. heating ) .",
    "the results of the simulation have been plotted in figure [ fig : timevarying ] .",
    "for both the synchronous and the asynchronous case , the power distribution losses and the lowest voltage magnitude measured by the microgenerators , are reported .",
    "the dashed line represents the case in which no reactive power compensation is performed .",
    "the thick black line represents the best possible strategy that solves the orpf problem ( computed via a numerical centralized solver that have access to all the grid parameters and load data ) .",
    "the thin red line represents the behavior of the proposed algorithm .",
    "it can be seen that the proposed algorithm achieves practically the same performance of the centralized solver , in terms of power distribution losses .",
    "notice however that the proposed algorithm does not have access to the demands of the loads , which are unmonitored .",
    "the agents , located only at the microgenerators , can only access their voltage measurements and share them with their neighbors .",
    "notice moreover that , as expected for duality based methods , the voltage constraint is satisfied only at the steady state",
    ". therefore , in the time varying case simulated in this example , the voltage sometimes falls lightly below the prescribed threshold , when the power demand of the loads present abrupt changes .",
    "this effect is even more noticeable in the asynchronous case , where iteration times are not evenly spaced .",
    "it should be remarked , however , that the extent of this constraint violation depends on the rate at which the algorithms are executed , compared with the rate of variation of loads , and is ultimately a function of the communication resources that are available at the cyber level .",
    "in this paper we proposed a distributed control law for optimal reactive power flow in a smart power distribution grid , based on a _",
    "feedback strategy_. such a strategy requires the _ interleaving of actuation and sensing _ , and therefore the control action ( the reactive power injections @xmath71 ) is a function of the real time measurements ( the voltages @xmath179 ) . according to this interpretation",
    ", the active power injections in the grid ( @xmath180 ) and the reactive power injection of the loads ( @xmath181 ) can be considered as _ disturbances _ for the control system . as it happens in all feedback control systems , these quantities",
    "do not need to be known to the controller : in some sense , the agents are implicitly inferring this information from the voltage measurements performed on the grid .",
    "similarly , it is also well known that the presence of feedback in the control action makes the closed loop behavior of the system less sensitive to model uncertainties .",
    "while we have not elaborated this point , we expect that the proposed strategy exhibits this kind of robustness .",
    "these features differentiate the proposed algorithm from most of the orpf algorithms available in the power system literature , with the exception of some works , like @xcite , where however the feedback is only local , with no communication between the agents , and of @xcite and @xcite . moreover , in the proposed feedback strategy",
    ", the controller ( or optimizer ) does not need to solve any model of the grid in order to find the optimal solution . while some knowledge of the grid parameters are used in the design and tuning of the algorithm",
    ", the online controller does not need to know or solve the nonlinear grid equations that are generally a critical issue in offline orpf solvers . on the contrary ,",
    "the computational effort required for the execution of the proposed algorithm is minimal .",
    "these features are extremely interesting for the scenario of low voltage or medium voltage power distribution networks , where real time measurement of the loads is usually not available , the grid parameters are partially unknown , and many buses are unmonitored .",
    "while a feedback approach to the orpf problem is quite a new contribution , similar methodologies have been used to solve other tasks in the operation of power grids ( see figure [ eq : feedbackinsmartgrids ] ) . in particular , in order to achieve realtime matching of the power demand and power generators , synchronous generators are generally provided with a local feedback control that adjusts the input mechanical power according to frequency measurements , in order to keep frequency sufficiently close to the desired nominal value ( the primary frequency control in @xcite , see also @xcite ) . by adding a communication channel ( a cyber layer ) that enables coordination among the different agents , it is also possible to drive the system to the configuration of minimum generation costs @xcite .",
    "notice that , in this scenario , generators do not have access to the aggregate active power demand of the loads , but infer it from the purely local frequency measurements .",
    "this example share some qualitative similarities with the original approach presented in this paper , where agents do not have access to the individual or aggregated reactive power demand of the loads , but however can use voltage measurements to infer this information and , by coordinating their action , to drive the grid to the configuration of minimum losses .",
    "as suggested in @xcite , a control - theoretic approach to the problem of optimal power flow enables also a number of analyses on the performance of the closed loop system that are generally overlooked when tackling the problem with the tools of nonlinear optimization .",
    "examples are @xmath182-like metrics for the resulting losses in a time - varying scenario ( see for example the preliminary results in @xcite ) , robustness to measurement noise and parametric uncertainty , stability margin against communication delays .",
    "these analyses , still not investigated , are also of interest for the design of the cyber architecture that has to support this and other real time algorithms , because they can provide specifications for the communication channels , the communication protocols , and the computational resources that need to be deployed in a smart distribution grid .",
    "let us define the following parameters @xmath183 , @xmath184 .    for each pair @xmath184 ,",
    "let us define the parameter @xmath185 i.e. the current that would be injected at node @xmath63 if    * node @xmath68 was replaced with a unitary voltage generator ; * all other nodes in @xmath60 ( the other agents ) were replaced by short circuits ; * all nodes not in @xmath60 ( load buses ) were replaced by open circuits .",
    "[ def : g ]    notice that the parameters @xmath183 depend only on the grid electric topology , and that @xmath186    figure  [ fig : gains ] gives a representation of this definition .",
    "notice that , in the special case in which the paths from @xmath63 to its neighbors are all disjoint and unique paths , then @xmath187 , i.e. the inverse of the impedance of the path connecting @xmath63 to @xmath68 .",
    "as suggested in @xcite , these parameters can be estimated in an initialization phase via some ranging technologies over the plc channel .",
    "alternatively , this limited amount of knowledge of the grid topology can be stored in the agents at the deployment time . finally , the same kind of information can be also inferred by specializing the procedures that use the extended capabilities of the generator power inverters for online grid sensing and impedance estimation @xcite .",
    "the following lemma shows that the elements @xmath183 in definition [ def : g ] correspond to the elements @xmath143 of the matrix @xmath138 in lemma [ lem : g ] .",
    "let @xmath138 be the matrix defined in lemma [ lem : g ] .",
    "then , for all @xmath188 , @xmath189 as defined in definition [ def : g ] .",
    "let @xmath190 be the matrix whose elements are the parameters @xmath183 . from definition [ def : g",
    "] , we have that when @xmath191 , @xmath192 from circuit theory considerations , this implies that @xmath193 . from and by using the matrix @xmath91 defined in lemma [ lemma : x ] ,",
    "if @xmath194 , we have @xmath195 therefore , by plugging into , we have that @xmath196\\hat g$ ] .",
    "we first introduce the following technical lemma .",
    "let @xmath197 be the @xmath198 block of @xmath91 as defined in .",
    "let @xmath199 be its spectral radius .",
    "then @xmath200 where @xmath164 is the maximum electric distance of a microgenerator from the pcc .",
    "[ lem : rhom ]              we then consider the update equation for @xmath208 . from",
    "we have @xmath209_+   - \\left[\\lambda^*\\right]\\\\ & \\quad = \\left [ y(t ) + \\lambda^ * + \\gamma \\left(b \\1 -   \\hat v(q^*)\\right ) - \\gamma \\frac{2}{u_n^2 } \\sin \\theta m x(t ) \\right]_+   \\\\ &",
    "\\quad \\phantom{= } - \\left[\\lambda^*\\right]_+,\\end{aligned}\\ ] ] where we used the fact that @xmath210 let us define the constant vector @xmath211 we then have , by using and , @xmath212_+ - \\left[\\alpha \\right]_+\\ ] ] which , by using the update equation for @xmath213 , becomes @xmath214_+ - \\left[\\alpha \\right]_+.\\ ] ] by using the fact that @xmath215 we have that @xmath216 and therefore , as @xmath197 is symmetric and positive definite , @xmath208 converges to zero if @xmath217 where @xmath199 is the spectral radius of @xmath197 .",
    "consider the update equations and for the dual variables @xmath102 and for the primal variables @xmath83 , respectively .",
    "introducing the same variables @xmath219 and @xmath213 as in the proof of theorem [ th : s ] , we can write , assuming , without loss of generality , that node @xmath63 is the node performing the update at the @xmath169-th iteration @xmath220_+ - \\left[\\lambda^*_h\\right]_+\\\\ & \\quad = \\left[y_h(t ) + \\lambda_h^*+\\gamma \\1_h^t \\left ( b\\1 -   \\hat v_g(t)\\right)\\right]_+ - \\left[\\lambda^*_h\\right]_+\\\\ & \\quad = \\left[y_h(t ) + \\lambda_h^*+\\gamma \\left ( b_h -   \\hat v_h(q^*)\\right)-\\gamma \\left (   v_h(t ) -   \\hat v_h(q^ * ) \\right ) \\right]_+ \\\\ & \\quad \\phantom{=}- \\left[\\lambda^*_h\\right]_+\\end{aligned}\\ ] ] let @xmath221 and observe that @xmath222_+=\\left[\\alpha_h\\right]_+$ ] . hence we can write @xmath223_+ - \\left[\\alpha_h\\right]_+\\\\ & \\quad = \\left[y_h(t ) + \\alpha_h -\\gamma \\frac{2}{u_n^2}\\sin \\theta\\1_h^tm\\left(q(t)-q^*\\right ) \\right]_+ - \\left[\\alpha_h\\right]_+\\\\ & \\quad = \\left[y_h(t ) + \\alpha_h -\\gamma \\frac{2}{u_n^2}\\sin \\theta \\1_h^t m x(t ) \\right]_+ - \\left[\\alpha_h\\right]_+\\\\\\end{aligned}\\ ] ] where in the second equality we have used the fact that @xmath224 .",
    "as far as the variable @xmath213 is concerned we have that @xmath225 now from we have that @xmath226 and , in turn , @xmath227 observe that assumption [ ass : timers ] implies there exists almost surely a positive integer @xmath228 such that any node has performed an update within the window @xmath229 $ ] .",
    "it follows that , for @xmath230 , @xmath231 .",
    "accordingly for @xmath230 the update for @xmath219 can be rewritten as @xmath232_+ - \\left[\\alpha_h\\right]_+\\end{aligned}\\ ] ] and , clearly , @xmath233 , for @xmath234 .",
    "consider the evolution of the quantity @xmath238 $ ] . from the above inequality",
    "we get that @xmath239 & \\leq \\mathbb{e}\\left[y(t)^t p_h^t p_h y(t ) \\right]\\nonumber\\\\ & = \\text{trace } \\mathbb{e}\\left[y(t)^t p_h^t p_h y(t ) \\right]\\nonumber\\\\ & = \\text{trace}\\left\\ { \\mathbb{e}\\left[p_h^t p_h y(t)y(t)^t \\right ] \\right\\}\\nonumber\\\\ & \\leq \\left\\|\\mathbb{e}\\left[p_h^t p_h\\right]\\right\\| \\",
    ", \\text{trace } \\left\\ { \\mathbb{e}\\left[y(t)y(t)^t \\right ] \\right\\}\\nonumber\\\\ & \\leq \\left\\|\\mathbb{e}\\left[p_h^t p_h\\right]\\right\\| \\ , \\mathbb{e}\\left[\\|y(t)\\|^2 \\right ] \\end{aligned}\\ ] ] where , given two semidefinite matrices @xmath240 , we used the fact that @xmath241 . let us compute @xmath242 $ ] .",
    "observe that @xmath243 from which we get , by using assumption [ ass : timers ] , @xmath244 & = \\frac{1}{m-1 } \\sum p_h^t p_h \\\\ & =   i -\\gamma\\frac{4}{u_n^2}\\frac{\\sin^2 \\theta}{m-1 } m + \\gamma^2 \\frac{4}{u_n^4 } \\frac{\\sin^4 \\theta}{m-1 } m^2.\\end{aligned}\\ ] ] by straightforward calculations one can see that the spectral radius of the above matrix is smaller than @xmath28 if @xmath245 where we recall that @xmath199 denotes the spectral radius of @xmath197 . then , by lemma  [ lem : rhom ] , we have @xmath246    the proof can be concluded by invoking the supermartingale convergence theorem @xcite . for the sake of the clarity , we recall that this theorem states that , if @xmath247 , @xmath248 , is a nonnegative random variable such that @xmath249 < + \\infty$ ] and if @xmath250 \\leq x_t$ ] with probability one , where @xmath251 denotes the history of the process @xmath247 up to time @xmath169 , then @xmath247 tends to a limit @xmath91 with probability one , and @xmath252=\\mathbb{e}[x]$ ] .",
    "let @xmath253 .",
    "observe that @xmath254 & \\leq \\mathbb{e}\\left[y(t)^t p_h^t p_h y(t)\\,|\\,y(t)\\right]\\\\ & \\leq \\left\\|\\mathbb{e}\\left[p_h^t p_h\\right]\\right\\|\\,\\ , \\|y(t)\\|^2 \\\\ & \\leq \\|y(t)\\|^2 \\end{aligned}\\ ] ] where the last inequality follows from the fact that @xmath255\\right\\|<1 $ ] under condition . moreover inequality together with @xmath255\\right\\|<1 $ ] implies that @xmath256 = 0 $ ] .",
    "hence @xmath238 $ ] converges with probability one to a nonnegative random variable @xmath91 such that @xmath257=0 $ ] , i.e. , @xmath91 is the null random variable .",
    "this concludes the proof ."
  ],
  "abstract_text": [
    "<S> we consider the problem of exploiting the microgenerators dispersed in the power distribution network in order to provide distributed reactive power compensation for power losses minimization and voltage support . </S>",
    "<S> the proposed strategy requires that all the intelligent agents , located at the microgenerator buses , measure their voltage and share these data with the other agents on a cyber layer . </S>",
    "<S> the agents then actuate the physical layer by adjusting the amount of reactive power injected into the grid , according to a feedback control law that descends from duality - based methods applied to the optimal reactive power flow problem subject to voltage constraints . </S>",
    "<S> convergence of the algorithm to the configuration of minimum losses and feasible voltages is proved analytically for both a synchronous and an asynchronous version of the algorithm , where agents update their state independently one from the other . </S>",
    "<S> simulations are provided in order to illustrate the algorithm behavior , and the innovative feedback nature of such strategy is discussed . </S>"
  ]
}