{
  "article_text": [
    "[ cols= \" < , < \" , ]",
    "identifying and understanding the sources of cosmic rays with energies up to @xmath0ev is one of the most important questions in astroparticle physics ( see , for example , @xcite ) . knowing the fraction of photons in the flux of ultra - high energy cosmic rays is of particular importance as photons are unique messengers of particular source processes ( acceleration vs. decay of super - heavy particles or other objects ) .",
    "they are also produced in interactions of charged cosmic ray nuclei of the highest energies with cosmic microwave background radiation , known as the greisen - zatsepin - kuzmin ( gzk ) effect .",
    "if the energy of the cosmic ray particles exceeds the gzk energy threshold at the source , ultra - high energy photons are produced due to well - understood hadronic interactions with microwave photons and can be detected at earth as a unique propagation signature .",
    "so far only upper limits to the photon flux at ultra - high energy exist , which have led to severe constraints on models for uhecr sources .",
    "however , depending on the primary cosmic ray composition , the sensitivity of the latest generation of cosmic ray detectors , i.e.  the pierre auger observatory  @xcite and the telescope array  @xcite , should allow detection of gzk photons for the first time .",
    "the simulation of the propagation of photons before they reach the earth s atmosphere is important because of the preshower effect @xcite that may occur when a photon traverses a region where the geomagnetic field component transverse to the photon trajectory is particularly strong . as described e.g.  in refs .",
    "@xcite , high energy photons in the presence of a magnetic field may convert into e@xmath1e@xmath2 pairs and the newly created leptons emit bremsstrahlung photons , which again may convert into e@xmath1e@xmath2 if their energies are high enough . as a result of these interactions , instead of a single high energy photon",
    ", a shower of particles of lower energies , the so - called preshower , reaches the atmosphere .",
    "the occurrence of the preshower effect has a large impact on the subsequent extensive air shower development and changes the predicted shower observables .    in 2005",
    "the program preshower  @xcite for simulating the showering of photons in the earth s magnetic field was released .",
    "it was shown that this initial version of the monte carlo code is in good general agreement with previous studies @xcite . in this paper",
    "we describe the changes of the preshower code relative to the initial version 1.0 @xcite .",
    "the main feature of the new release is a much faster algorithm for calculating the distance at which a preshower interaction ( gamma conversion or bremsstrahlung ) occurs . in version 1.0 ,",
    "the calculations were done in constant steps along the particle trajectory and the step size was optimized for all possible trajectories . the constant step practically disabled studying the preshower effect along paths longer than several tens of thousands kilometers .",
    "now , in version 2.0 , the distance to the next interaction point is computed with an efficient veto algorithm , decreasing significantly the number of computing steps .",
    "the new method , being independent of the trajectory length , allows computations for arbitrarily long photon paths , e.g.  simulations of preshower creation in the vicinity of a neutron star or active galactic nucleus .",
    "the new algorithm is described in detail in section  [ sec1 ] of this article .",
    "other important changes , i.e.  the update of the geomagnetic field model and a code correction in version 1.0 are discussed in section  [ sec2 ] .",
    "the results of testing preshower  2.0 are presented in section  [ sec3 ] and conclusions are given in section  [ sec4 ] .",
    "following ref .",
    "@xcite , all the results presented in the following are obtained for the magnetic conditions of the pierre auger observatory in malarge , argentina ( 35.2@xmath3s , 69.2@xmath3w ) .",
    "the shower trajectories are given in the local frame where the azimuth increases in the counter - clockwise direction and @xmath4 refers to a shower coming from the geographical north .",
    "in preshower 1.0 the effect of precascading is simulated following the particle trajectories with a fixed step size . in each step",
    "the probability of conversion into e@xmath1e@xmath2 is calculated for photons and the probability of emitting a bremsstrahlung photon is computed for electrons .",
    "the step size has to be optimized for all possible trajectories and magnetic field configurations encountered along the particle trajectories .",
    "it has been found out that a step size of @xmath5 km works well until the primary photon conversion and then the emission of bremsstrahlung photons as well as conversions of secondary photons are simulated in steps of @xmath6 km . in this algorithm",
    "a typical simulation run consists of several thousands of steps .",
    "the number of simulation steps and hence the computing time can be significantly reduced by using a veto algorithm .",
    "the algorithm used in the following is commonly applied in physical situations where a probability of occurring of a certain process varies within a given spatial or temporal interval ( see , e.g.  ref .",
    "@xcite ) . the location or time of the occurrence of a physical process studied",
    "is found in few approximating jumps .",
    "an example of a process that can be treated with the algorithm is a radioactive decay considered in a certain interval of time .",
    "photon conversion and bremsstrahlung probabilities to be found along spatial trajectories can also be computed with this veto algorithm .",
    "the theory behind the veto algorithm is based on a process of discrete events described by @xmath7 then the probability @xmath8 of occurrence of process @xmath9 in the time window @xmath10 is given by @xmath11 together with the probability of not having an occurrence of process @xmath9 in the time from @xmath12 to @xmath13 @xmath14 one obtains for the probability @xmath15 for having an occurrence of @xmath9 in the time window @xmath10 , provided that this process did not occur at an earlier time @xmath16 with @xmath17 @xmath18 if an analytic solution can be found for the integral of @xmath19 @xmath20 one can sample the time @xmath13 of the next occurrence of @xmath9 after the previous occurrence at time @xmath12 using the inversion method @xmath21 with @xmath22 being a random number uniformly distributed in @xmath23 $ ] .    if @xmath24 can not be found or the inverse of it computed sufficiently easily one can use a function @xmath25 such that @xmath26 and apply the following procedure    1 .   set the initial conditions : @xmath27 , @xmath28 ; 2 .",
    "@xmath29 ; 3 .",
    "get a random number @xmath30 ; 4 .",
    "compute @xmath31 , @xmath32 ; 5 .",
    "get another random number @xmath33 ; 6 .   if @xmath34 then @xmath35 is the wanted result , i.e.  the moment when process @xmath9 occurred , otherwise one has to go back to step 2 or , if the end of the interval is reached , end the procedure without occurrence of process @xmath9 .",
    "the algorithm described above was mathematically proven to reproduce exactly the expected distributions  @xcite .",
    "following the general scheme described above , the application of the veto algorithm to simulations of the preshower effect is straightforward . instead of the time variable @xmath13 , the distance @xmath36 along the preshower trajectory is used .",
    "we consider two processes in parallel over an interval starting at @xmath37 and ending at @xmath38 , namely gamma conversion and bremsstrahlung of electrons . following the physics notation introduced in ref .",
    "@xcite ( see also the appendices a and b for all the required physics formulas and symbols ) the probability functions are defined as @xmath39 ( see eqs .  [ npairs]-[pconv2 ] ) for gamma conversion and @xmath40 ( see eqs .",
    "[ daug]-[bremprob ] ) for magnetic bremsstrahlung .",
    "the function @xmath19 is then replaced by @xmath41 or @xmath42 , depending on the process to be simulated .",
    "since finding the antiderivatives of @xmath41 or @xmath42 is not straightforward , simple functions limiting @xmath41 and @xmath42 are used .",
    "we define @xmath43 which replace @xmath25 and for which the antiderivatives are @xmath44 with these substitutions the algorithm of sec .",
    "[ algorithm ] is applied in preshower 2.0 for the two interaction processes .",
    "the determination of @xmath45 is crucial for computing time optimization .",
    "too large @xmath45 increases the total number of steps to be executed in the procedure .      the functions @xmath46 depend on @xmath47 , which is computed with a numerical model .",
    "hence finding the absolute maxima @xmath48 and @xmath49 is done numerically .",
    "moreover , through the dependence on @xmath47 , both @xmath41 and @xmath42 depend on the primary arrival direction and the geographical location of the observatory . as can be seen in figs .",
    "[ alpha_conv ] and [ alpha_brem ] , the values of @xmath48 and @xmath49 may be significantly different for various arrival directions .",
    "functions along different trajectories at the location of the pierre auger observatory in malarge ( argentina ) . a minimum value for one of the curves is related to the small value of @xmath50 for this specific arrival direction and altitude .",
    "see text for further details.,scaledwidth=100.0% ]     functions along different trajectories at the location of the pierre auger observatory in malarge ( argentina ) . a minimum value for one of the curves is related to the small value of @xmath50 for this specific arrival direction and altitude .",
    "see text for further details.,scaledwidth=100.0% ]    this indicates that the computation of @xmath48 and @xmath49 should be performed for each trajectory separately , otherwise one would have to apply upper limits of these values which would be universal but excessively large for most directions . accepting the excessive values of @xmath45 would increase enormously the number of steps in the veto algorithm and might result in an unacceptable increase of the computing time .    typically , the functions @xmath41 and @xmath42 reach their global maximum at the top of the atmosphere , i.e.  at the end of preshower simulations , assumed here to be at the altitude of @xmath51 km .",
    "this is the point closest to the earth s surface and @xmath47 typically reaches the maximum value .",
    "however for certain classes of trajectories @xmath47 might start to decrease with approaching the geomagnetic field source when the trajectory direction approaches a tangent to the local field lines .",
    "if this decrease happens to be close to the earth surface , preshower particles are exposed to the maximum @xmath47 somewhere before reaching the atmosphere .",
    "examples of @xmath48 and @xmath49 with local extrema are plotted in figs .",
    "[ alpha_conv ] and [ alpha_brem ] .",
    "the positions of the minima of @xmath46 are closely correlated with the minima of @xmath47 .    in case of @xmath41",
    ", it has been checked that its global maximum is well reproduced by computing the function value along the trajectory in a simple loop with steps of 1000 km .",
    "this procedure is performed for the primary photon energy and the trajectory of interest .",
    "it has been checked that @xmath41 decreases with energy , so @xmath48 found for the primary photon energy will work also for secondary photons of lower energies . in case of electrons",
    ", @xmath42 may increase with decreasing electron energy , so one has to compute @xmath49 for energies within the entire energy range of the simulated particles . here",
    "@xmath49 is computed in two loops .",
    "the external loop along the trajectory is done in steps of 1000 km and the internal loop over energies decreases the energy by one decade in each step .",
    "the steps in both procedures can be adjusted by the user if necessary .",
    "there is also an alert in the program that gets triggered when the actual values of @xmath46 happen to exceed @xmath45 .",
    "the above method of finding the absolute maxima of @xmath46 is fast and efficient .",
    "however , it is optimized only for specific simulation conditions : preshowering in the geomagnetic field . in other environments , involving more irregular shapes of @xmath52 ,",
    "one has to reconsider the procedure of finding the absolute maxima of @xmath46 .",
    "other modifications and changes applied in the new release of the preshower program are briefly listed below .    1 .",
    "the igrf geomagnetic field model has been updated to the year 2010 and the most recent igrf-11 coefficients have been applied ( ref .",
    "@xcite ) . in the updated model ,",
    "the highest order of spherical harmonics has been increased from 10 to 13 .",
    "the geomagnetic field can be extrapolated up to the year 2015 with the new model .",
    "the differences between the field strength and direction in these two models are not larger than 0.001% .",
    "2 .   procedures to calculate modified bessel functions have been replaced with an open source cern routine dbska .",
    "a minor problem has been found in the auxiliary function ` kappa(x ) ` used for calculation of bremsstrahlung probability .",
    "the interpolation performed in this function failed for the rare case of @xmath53 .",
    "this happened because of a faulty definition of the last interval where the interpolation was done . as a result of this bug",
    "the input value @xmath53 was excluded from the computations .",
    "this bug has been fixed in the new release of the program .",
    "4 .   since for some cases",
    "the number of preshower particles can be very large , the size of the array ` part_out[50000][8 ] ` , which stores the output particle data , has been increased from 50000 to 100000 entries .",
    "the code of the program was reorganized and more clearly structured .",
    "the main change here was moving the auxiliary functions and routines to a separate file .",
    "a list of the new and modified files with basic explanations can be found in the appendix c.",
    "the new release has been intensively tested .",
    "below we show some examples to illustrate the performance .    in fig .",
    "[ maps ] a comparison of conversion probability obtained with preshower 1.0 and preshower 2.0 is presented for different arrival directions and primary energy of @xmath54ev .",
    "conversion for the primary energy of @xmath54ev for different arrival directions as computed by preshower 1.0 ( lines ) and preshower 2.0 ( points ) .",
    "preshower 1.0 values were obtained by numerically integrating the conversion probability in the loop over trajectory .",
    "the points represent the fractions of events with gamma conversion simulated by preshower 2.0 with the new veto algorithm .",
    "each fraction is the average for 10000 primary photons .",
    "computations have been done for magnetic conditions at the pierre auger observatory in argentina .",
    "the azimuth @xmath55 refers to showers arriving from the geographic north.,scaledwidth=100.0% ]    the lines represent conversion probabilities obtained by numerical integrations of the expression ( [ pconv2 ] ) along trajectories a nd with steps as given in preshower  1.0 .",
    "the points are plotted to show fractions of events with gamma conversion simulated by preshower  2.0 .",
    "each fraction was calculated after 10,000 simulation runs .",
    "simulations of gamma conversion probabilities for other primary energies has also been checked and in all cases an excellent agreement between the results of the two preshower versions has been found .",
    "a cross - check of the procedures responsible for simulation of bremsstrahlung is shown in fig .  [",
    "20strong_profiles ] , in which the energy distribution of secondary particles for a primary photon of @xmath0ev and an arrival direction along which the transverse component of the geomagnetic field is particularly strong ( `` strong field direction '' ) are compared .",
    "ev photons arriving at the pierre auger observatory in argentina from the strong field direction .",
    "the spectra weighted by energy are plotted to the right .",
    "the dashed histograms were obtained with preshower  1.0 and the solid ones with preshower  2.0.,scaledwidth=100.0% ]    plotted are the summed distributions of energies of secondary photons and electrons together with the relevant histograms weighted by the energies .",
    "the summations are done for 500 simulation runs .",
    "the results obtained with the two program versions are in very good agreement .",
    "further tests for the same set of simulations are shown in figs .",
    "[ cor20nfpp ] and [ cor20efpp ] .",
    "conversion simulated with preshower  1.0 and preshower  2.0 .",
    "plotted are the preshowers initiated by @xmath0ev photons arriving from the strong field direction .",
    "the two points somewhat higher than those of the general trend are cases where one of the bremsstrahlung photons again converted in the magnetic field to produce an electron - positron pair which emitted the additional photons .",
    "see also fig .",
    "[ cor20efpp].,scaledwidth=100.0% ]     conversion for a primary photon energy of @xmath0  ev in the strong field direction .",
    "the two points in excess of the general trend are two rare cases where the first bremsstrahlung photon converted again into an electron - positron pair which increased the total energy carried by leptons .",
    "see also fig .",
    "[ cor20nfpp].,scaledwidth=100.0% ]    these are the number of preshower particles and the total energy carried by the preshower electrons .",
    "both observables are calculated at the top of the atmosphere and both are plotted versus the altitude of primary photon conversion . in both figures",
    "a comparison is made between the results obtained with preshower  1.0 and preshower  2.0 .",
    "again , the agreement between the results of the two preshower versions is very good .",
    "one of the main aims of the new release of preshower was to reduce the computing time .",
    "the results of the cpu time comparison are summarized in table  [ table - times ] .",
    "rcp2.0cmp1.7cmp1.7 cm @xmath56 [ ev ] & direction & fraction of converted & time old [ sec . ]",
    "& time new [ sec . ]",
    "+ 7@xmath5710@xmath58 & @xmath59 & 0/1000 & 79 & 7 + 7@xmath5710@xmath58 & @xmath60 , @xmath61 & 0/1000 & 76 & 8 + 10@xmath62 & @xmath63 , @xmath64 & 92/100 & 1195 & 209 +    [ table - times ]    the computing time is more than a factor 5 shorter in case of simulations with preshower  2.0 than in the case of preshower  1.0 .",
    "this reduction is seen both in computation of gamma conversion ( speed up by nearly factor 10 ) and in more time consuming bremsstrahlung routines .",
    "the program preshower is a tool designed for simulating magnetically induced particle cascades due to ultra - high energy photons .",
    "it can be linked with air shower simulation packages such as corsika @xcite to calculate complete photon - induced particle cascades as they are searched for with cosmic ray observatories .    a new version of the preshower program , version 2.0 , has been released and its features are presented in this article .",
    "an efficient veto algorithm has been introduced to sample the locations of individual interaction processes .",
    "other modifications include the update of the geomagnetic field model , correcting a rare exception , and reorganizing the program code .",
    "the results obtained with the new release of preshower agree very well with those calculated with the previous version .",
    "the new algorithm not only speeds up the program by more than a factor 5 , but also allows additional applications due to the increased flexibility of the sampling of interaction points .",
    "for example , the preshower effect can now be studied not only in the geomagnetic field , but also close to extended astrophysical objects like neutron stars and active galactic nuclei .",
    "an application of preshower 2.0 in the conditions other than the geomagnetic field require only small changes in the program .",
    "the magnetic field model has to be replaced and start and end points of simulations have to be adequately adjusted .",
    "we thank n.a .  tsyganenko for valuable remarks on the application of the igrf model .",
    "we are also thankful to carla bleve whose update of the igrf coefficients in tsyganenko s subroutine has been used . + this work was partially supported by the polish ministry of science and higher education under grant no .",
    "n  n202  2072  38 and by the daad ( germany ) under grant no .  50725595",
    "the number of pairs created by a high - energy photon in the presence of a magnetic field per path length @xmath66 can be expressed in terms of the attenuation coefficient @xmath67 @xcite : @xmath68\\},\\ ] ] where @xmath69 with @xmath70 being the fine structure constant , @xmath71 , @xmath50 is the magnetic field component transverse to the direction of the photon s motion , @xmath72 g and @xmath73 is the magnetic pair production function .",
    "@xmath73 can be well approximated by : @xmath74 where @xmath75 is the modified bessel function of order @xmath76 . for small or large arguments",
    "@xmath73 can be approximated by    @xmath77    we use eq .",
    "( [ npairs ] ) to calculate the probability of @xmath78 conversion over a small path length @xmath66 : @xmath79\\simeq\\alpha(\\chi(r))dr.\\ ] ]",
    "after photon conversion , the electron - positron pair is propagated .",
    "the energy distribution in an @xmath80 pair is computed according to ref .",
    "@xcite :    @xmath81}{\\varepsilon(1-\\varepsilon ) } k_{2/3}\\left[\\frac{1}{3\\chi\\varepsilon(1-\\varepsilon)}\\right ] , \\label{daug}\\ ] ]    where @xmath82 denotes the fractional energy of an electron and the other symbols were explained in the previous chapter .",
    "the probability of asymmetric energy partition grows with the primary photon energy and with the magnetic field .",
    "beginning from @xmath83 , the asymmetric energy partition is even more favored than the symmetric one .",
    "electrons traveling at relativistic speeds in the presence of a magnetic field emit bremsstrahlung radiation ( synchrotron radiation ) . for electron energies @xmath84 and for @xmath85 , the spectral distribution of radiated energy is given in ref .",
    "@xcite : @xmath86 where @xmath87 , @xmath88 and @xmath89 are electron initial energy and rest mass respectively , @xmath90 and @xmath91 are modified bessel functions , and @xmath92 is related to the emitted photon energy @xmath93 by @xmath94 the total energy emitted per unit distance is ( in cgs units ) @xmath95 with @xmath96 being the classical electron radius . for our purposes we use the spectral distribution of radiated energy defined as @xmath97 where @xmath98 is the number of photons with energy between @xmath93 and @xmath99 emitted over a distance @xmath100 . from eqs .",
    "( [ fy ] ) , ( [ yhv ] ) , ( [ w ] ) , and ( [ idef ] ) we get ) , valid for all values of @xmath93 , is equivalent to eq . (",
    "2.5a ) in ref .",
    "@xcite . a simplified form of distribution ( [ brem ] )",
    "is given by eq .",
    "( 2.10 ) in ref .",
    "@xcite , however it can be used only for @xmath101 . ]",
    "@xmath102 provided @xmath100 is small enough , @xmath98 can be interpreted as a probability of emitting a photon of energy between @xmath93 and @xmath99 by an electron of energy @xmath88 over a distance @xmath100 . in our simulations",
    "we use a small step size of @xmath103 km",
    ". the total probability of emitting a photon in step @xmath100 can then be written as @xmath104 the energy of the emitted photon is simulated according to the probability density distribution @xmath105 obtained from eq .",
    "[ bremprob ] .",
    "the files included in preshower 2.0 package but not existing in the previous release are :    ` igrf-11.f ` : :    an external routine generating the geomagnetic field components    according to the igrf-11 model @xcite .",
    "this file replaces ` igrf.f ` of    the previous release of preshower . `",
    "cernbess.f ` : :    external procedures calculating the sequence of modified bessel    functions @xcite .",
    "these open source procedures replace previously    used functions from numerical recipes . `",
    "veto.c ` : :    this file contains functions and procedures called by the veto    algorithm . `",
    "veto.h ` : :    the header file for ` veto.c ` .",
    "` utils.c ` : :    this file contains auxiliary functions and procedures used within the    program . in the previous version of preshower the auxiliary functions    were placed in ` preshw.c ` , now it is more convenient to have them in a    separate file . `",
    "utils.h ` : :    the header file for ` utils.c ` .",
    "+      ` preshw.c ` : :    contains the main procedure ` preshw_veto ` generating preshowers with    the veto algorithm , ` prog.c ` : :    reads input parameters and calls ` preshw_veto ` , ` makefile ` : :    modified to account for the new files .",
    "c. c. finlay et al .",
    ", geophys .",
    "183 , ( 2010 ) , 1216 , doi : 10.1111/j.1365 - 246x.2010.04804.x , http://www.ngdc.noaa.gov/iaga/vmod/igrf.html n. a. tsyganenko , institute and department of physics , saint - petersburg state university , russia , private communication ; http://geo.phys.spbu.ru/@xmath106tsyganenko/geopack-2008.html http://wwwasdoc.web.cern.ch/wwwasdoc/shortwrupsdir/c341/top.html      j. blmer , r. engel , and j. r. hrandel , prog .",
    "* 63 * ( 2009 ) 293 a. letessier - selvon and t. stanev , rev .",
    "* 83 * ( 2011 ) 907 k. kotera , and a. v. olinto , ann .",
    "49 ( 2011 ) 119 , arxiv:1101.4256                            d. heck , j.  knapp , j. n.  capdevielle , g.  schatz , and t.  thouw , report fzka 6019 , forschungszentrum karlsruhe , 1998 ( available at www-ik.fzk.de/~heck/corsika/ ) t. erber , rev .",
    "* 38 * ( 1966 ) 626 j. k. daugherty , a. k. harding , astrophys",
    ". j. * 273 * ( 1983 ) 761 a. a. sokolov , i. m. ternov , radiation from relativistic electrons , springer verlag , berlin , 1986"
  ],
  "abstract_text": [
    "<S> in this paper we describe a new release of the preshower program , a tool for monte carlo simulation of propagation of ultra - high energy photons in the magnetic field of the earth . </S>",
    "<S> the preshower program is designed to calculate magnetic pair production and bremsstrahlung and should be used together with other programs to simulate extensive air showers induced by photons . </S>",
    "<S> the main new features of the preshower code include a much faster algorithm applied in the procedures of simulating the processes of gamma conversion and bremsstrahlung , update of the geomagnetic field model , and a minor correction . </S>",
    "<S> the new simulation procedure increases the flexibility of the code so that it can also be applied to other magnetic field configurations such as , for example , encountered in the vicinity of the sun or neutron stars .    </S>",
    "<S> ultra - high energy cosmic rays , extensive air showers , geomagnetic cascading , gamma conversion , preshower </S>"
  ]
}