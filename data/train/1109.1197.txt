{
  "article_text": [
    "often described as the optical equivalent of coulomb blockade  @xcite , photon blockade  @xcite , in which the transport of only one photon through a nonlinear system is possible whereas excess photons are rejected , is one of the few photon - photon interactions that have been demonstrated experimentally to date  @xcite .",
    "such nonlinear interactions at the single - photon level are inherently nonclassical , and form the basis for quantum information processing with photonic qubits  @xcite . in particular , the demonstration of the photon blockade is considered a significant step towards the goal of single photon routing  @xcite .",
    "two mechanisms of photon blockade have been demonstrated in recent years .",
    "both mechanisms rely on the coupling of an atom ( or another two - level system such as a quantum dot  @xcite ) to cavity - enhanced electromagnetic modes . in this work",
    "we establish that such an apparatus is inherently insufficient for the task of photon routing , and that a three - level system at least is needed to ensure a deterministic and efficient routing process .",
    "we demonstrate this by analyzing the simplest case of an input pulse containing exactly two photons , and deriving the probability for a successful routing event , namely that the system will respond to one photon differently than to the other .",
    "the underlying conflict that limits the interaction of a two - level system with such a pulse , is the fact that the coupling to the electromagnetic mode dictates both the interaction bandwidth , and the memory time of the system .",
    "thus , a pulse that is short enough to guarantee that the two photons arrive within the memory time of the system will have a bandwidth that exceeds the interaction bandwidth .",
    "conversely , a pulse that is narrow - band enough to be included completely within the interaction bandwidth will be long enough to allow the system to respond to each photon as if it were the only one .",
    "the outline of the paper is as follows . in sec .",
    "[ sec : level2 ] we present both analytical derivations and numerical calculations of the efficiency of two - photon routing based on photon blockade in cavity quantum electrodynamics ( qed ) @xcite .",
    "the temporal behavior of the blockade mechanism is essentially the same in the bad cavity regime as in the strong coupling regime , despite the fact that the underlying nonlinearity is different in the two regimes .",
    "we show that the routing efficiency is inherently limited to  @xmath0 in both cases . in sec .",
    "[ sec : level3 ] we study the possibility of exceeding this limit by using a time - energy entangled photon pair as the input pulse .",
    "this case seems especially relevant in light of the fact that such entanglement can be created by a two - level system coupled to a single electromagnetic mode  @xcite , and so one could think of a two - stage process in which the first interaction creates the entanglement between the photons and the second interaction performs the routing mechanism .",
    "however , our analysis shows that even ideal time - energy entanglement can increase the routing efficiency only up to  @xmath1 .",
    "time - energy entanglement generated by a two - stage interaction with a two - level system is even more limited and increases the efficiency only up to  @xmath2 .",
    "finally , in sec .",
    "[ sec : level4 ] we study the configuration of a three - level atom coupled to a single - sided cavity .",
    "recent studies by koshino _",
    "et al . _",
    "@xcite and gea - banacloche _ et al . _",
    "@xcite have shown that this configuration enables deterministic mapping of a photonic state to the atom .",
    "we utilize this scheme to construct an ideal photon router that does not suffer from the inherent limits of photon blockade with a two - level system , and show that its efficiency can approach  @xmath3 with realistic , experimentally achievable parameters .",
    "the first demonstration of the photon blockade was performed with cs atoms strongly coupled to a fabry - prot cavity  @xcite , and later with quantum dots coupled to a photonic crystal resonator  @xcite . in this strong coupling regime ,",
    "where the coupling rate between the atom and the cavity is larger than all the other rates in the system , the photon blockade relies on the anharmonicity of the energy levels of the coupled atom - cavity system  @xcite , meaning that multi - photon excitations of the coupled system occur at different frequencies than a single - photon excitation .",
    "a similar anharmonicity of the spectrum of semiconductor systems has been used to demonstrate single - photon sources  @xcite .",
    "the second photon blockade mechanism occurs at the bad cavity limit  @xcite , in which the cavity - enhanced coupling of the atom to one electromagnetic mode is faster than its spontaneous emission to all other modes , yet slower than the cavity decay rate .",
    "therefore , although strong coupling is not achieved , the atom interacts mostly with one electromagnetic mode and can thus be perceived as a one - dimensional atom  @xcite .",
    "the blockade effect is then typically described as a dynamical process , equivalent to antibunching in free space resonance fluorescence  @xcite .",
    "this stems from the fact that in the bad cavity regime , the scattered photon escapes the cavity immediately , before the atom , which collapsed to the ground state , can rebuild its polarization and scatter another photon .",
    "nonetheless , one can consider this mechanism in the spectral domain as well , like in the strong coupling regime .",
    "the difference is that in this case the anharmonicity is of the @xmath4 energy levels , where , again , multi - photon excitations occur at different frequencies than a single - photon excitation . in either case , the final result can be described as a `` photon turnstile '' in continuous operation , since photons are transmitted ( or reflected ) one by one , as was demonstrated with cs atoms coupled to a whispering gallery mode of a fiber - coupled microtoroid cavity  @xcite .",
    "we begin by analyzing the blockade mechanism in the bad cavity limit . for this",
    "we consider a system similar to that of ref .",
    "@xcite , namely a single atom interacting with a fiber - coupled microtoroid , as depicted in fig .",
    "[ fig : setup ] .",
    "( color online ) schematic depiction of a microtoroid setup .",
    "note that @xmath5 ( not shown here ) is vacuum.,width=377 ]    the two counterpropagating modes of the microtoroid , @xmath6 and @xmath7 , are evanescently coupled to the atom with coupling strength @xmath8 , and decay to the tapered fiber at a rate @xmath9 .",
    "since we are interested in inherent limits to the routing effect , we shall assume at first that parasitic effects such as scattering between the cavity modes , intrinsic losses of the cavity and the natural decay of the atom are significantly slower than all the other processes in the system .",
    "the dominant parameter in the system is thus the cavity decay rate into the fiber , which brings us into the bad cavity regime .",
    "it is important , however , to make a distinction between this situation , in which the cavity is intentionally made to decay into the fiber , and a truly `` bad '' cavity that decays quickly due high intrinsic losses .",
    "thus , we shall henceforth refer to this regime as the `` fast cavity '' regime , instead of the bad cavity regime .",
    "+ we define the routing efficiency @xmath10 as the probability of detecting one photon in the transmitted mode @xmath11 and one in the reflected mode @xmath12 , given that the input mode @xmath13 initially contains a two - photon pulse . neither the time interval between the two clicks , nor their absolute time of occurrence are of importance , and hence , for calculating the probabilities for the four possible detection events , we integrate over all possible detection times : @xmath14 where @xmath15 stands for reflected and @xmath16 for transmitted , and @xmath17 are the second order correlation functions of the two output modes . note that this definition is already normalized so that @xmath18 . the appropriate expression for the routing efficiency",
    "is thus given by @xmath19 accordingly , @xmath20 and @xmath21 denote the probabilities of the two failure mechanisms of the routing process , namely the probabilities for both photons to be transmitted , or for both photons to be reflected , respectively .",
    "for an ideal router , events where both photons are transmitted or both reflected should not occur : @xmath22 , and thus @xmath23 . in comparison , for a simple @xmath24 beam splitter ,",
    "any of the four possibilities is equally likely , hence @xmath25 .",
    "any useful photon router should thus satisfy @xmath26 , which is also the quantum limit , above which the cauchy - schwartz inequality for classical fields is violated .      in order to analyze the temporal behavior of a pulse interacting with this system and the resulting routing efficiency , we model the fiber by a feeder cavity containing the desired number of excitations ( fig .",
    "[ fig : feeder ] ) .",
    "a schematic of the photon router model .",
    "the input pulse is modeled by introducing a feeder cavity which leaks into the system with rate @xmath27.,width=340 ]    the decay rate of the feeder cavity @xmath27 gives a measure of the inverse of the resulting driving pulse width .",
    "using the input - output formalism  @xcite and eliminating the microtoroid cavity modes adiabatically , which is justified in the fast cavity regime for which @xmath28 , we can write for the output modes    [ operators ] @xmath29    where @xmath30 is the annihilation operator of the feeder cavity field , @xmath31 is the lowering operator for the atom , and @xmath32 is the cavity - enhanced atomic decay rate per output channel . since only normally - ordered moments of the output operators are considered , the vacuum noise input operators @xmath33 and @xmath34 have been discarded .",
    "eq .   reflects the fact that emission of a photon into @xmath11 by the feeder cavity and by the cavity - enhanced atom are indistinguishable .",
    "accordingly , it is the interference between both paths that is detected .",
    "however , since we assumed the scattering between the cavity modes is negligible , only the atom is able to reflect a photon , and hence no interference will be observed in the reflected mode described in eq .",
    "( assuming @xmath34 is vacuum ) .",
    "the non - hermitian effective hamiltonian corresponding to the cascaded system of fig .",
    "[ fig : feeder ] is given by ( @xmath35 )  @xcite @xmath36 note that the interaction between the feeder cavity and the system is unidirectional , and that it produces an exponentially decaying driving pulse .",
    "also , since the atom can decay into two counterpropagating modes , the atomic population decay rate is @xmath37 instead of @xmath38 .        as a simple example , consider a driving pulse containing a single photon .",
    "the initial state is then @xmath39 where the first index in the ket gives the number of photons in the feeder cavity , and the second index describes whether the atom is excited ( @xmath40 ) or in its ground state ( @xmath8 ) .",
    "the state evolves according to the schrdinger equation @xmath41 to @xmath42 with @xmath43 where henceforth the exponential functions are defined to be zero for @xmath44 .",
    "we use eq .   to evaluate the photon flux at the output modes with this state , and integrate over time to define single - photon transmission and reflection probabilities    [ tr ] @xmath45    respectively .",
    "+ as evident from eq .  , for long enough pulses ( @xmath46 ) , @xmath47 and all light is reflected .",
    "this is due to the destructive interference between the atomic dipole radiation and the driving field in the forward direction . for short pulses ( @xmath48 ) ,",
    "however , the atom has no time to build up the necessary dipole , and the photon is transmitted .      for deducing the routing properties of this system",
    ", we need to study the deviation from the linear behavior of eq .   and analyze the case of more than one photon in the pulse .",
    "the source of the nonlinearity is evident already in eq .",
    ", in the presence of the atomic lowering operator in the expressions for the output mode operators . in particular ,",
    "detection of a reflected photon projects the atom to its ground state , preventing the immediate scattering of a second photon and also disrupting the destructive interference in the forward direction , possibly allowing the second photon to slip through and be transmitted  @xcite . in order to derive an analytic description for this effect we follow the evolution of a state in which the feeder cavity initially contains two photons .",
    "this initial state evolves to @xmath49 where @xmath50e^{-\\kappa_s t}.\\nonumber\\end{aligned}\\ ] ] after the detection of one photon , the wave function collapses to a state containing only a single excitation , which can be either in the cavity or in the atom . in the first case the subsequent evolution is again given by eqs .   and  , whereas in the second case , the state evolves to @xmath51 , with @xmath52 substituting these expressions into eq .  , the second order correlation functions become    @xmath53\\right|^2 \\\\",
    "\\gamma^{rt}(t,\\tau ) & = & 4\\left| \\sqrt{\\gamma_c}\\beta(t)\\left[\\sqrt{\\kappa_s}a(\\tau)+\\sqrt{\\gamma_c}b(\\tau)\\right]\\right|^2    \\nonumber\\\\ \\gamma^{rr}(t,\\tau ) & = & 4\\left|\\gamma_c\\beta(t)b(\\tau)\\right|^2 \\nonumber\\\\ \\gamma^{tt}(t,\\tau ) & = & 4\\left| \\left[\\sqrt{2\\kappa_s } \\alpha(t ) + \\sqrt{\\gamma_c}\\beta(t)\\right]\\left[\\sqrt{\\kappa_s}a(\\tau)+\\sqrt{\\gamma_c}b(\\tau)\\right ] + \\sqrt{\\gamma_c \\kappa_s}\\beta(t)c(\\tau )    \\right|^2 \\nonumber.\\end{aligned}\\ ] ]    substituting these correlation functions into eq .   and",
    "performing the integration leads to the following expressions for the various probabilities for transmission or reflection of the photons @xmath54 these probabilities and the corresponding routing efficiency @xmath55 are presented in fig .",
    "[ fig : turnstile ] as a function of the pulse width .",
    "( color online ) two - photon detection probabilities as a function of the pulse width @xmath56.,width=340 ]    as evident , there is no pulse width for which both failure mechanisms @xmath57 are zero , and so the routing efficiency @xmath10 is a compromise , reaching a maximal value of only  @xmath0 .",
    "these results are consistent with previous works by koshino _",
    "et al . _",
    "@xcite and shapiro  @xcite , although our model and derivation are different .",
    "the physical origin of the limited routing efficiency relies on the interplay between two counteracting effects . on one hand , if the pulse is significantly longer than @xmath58 , the atom has time to reestablish its dipole after the first scattering , and therefore will be able to scatter the second photon backward as well when it arrives . on the other hand , due to time - energy uncertainty relations ,",
    "a pulse that is significantly shorter than @xmath58 must have a bandwidth that exceeds @xmath38 , which is also the interaction bandwidth of the atom .",
    "thus , such a pulse will have some spectral components that can not interact with the atom , and consequently there will be a probability for both photons to be transmitted .",
    "since these two effects occur on the same timescale , the efficiency is inherently limited .",
    "( color online ) marginal probability density functions of the various reflection and transmission events , as a function of the interval between the photon detection times @xmath59 , for : ( a ) long pulses ( @xmath60 ) , ( b ) short pulses ( @xmath61 ) and ( c ) intermediate pulses ( @xmath62 ) .",
    "the different curves correspond to events of double reflection ( rr ) , double transmission ( tt ) , a transmission followed by a reflection ( tr ) , and a reflection followed by a transmission ( rt ) .",
    "note that rr is practically zero in ( b).,width=340 ]    in order to gain more insight into the dynamics of this process , we present in fig .  [",
    "fig : gamma ] the correlation functions of eq .   with @xmath16",
    "integrated over the entire pulse for intermediate , long and short pulses .",
    "this integration results in a marginal probability density function , displaying the relative probability for each of the four detection events as a function of the time interval between the two detections @xmath59 . a second integration over @xmath59 would result in the probabilities of eq .  .",
    "+ for all pulse lengths the reflection - reflection component rr is antibunched , corresponding to the projection of the atom to the ground state following the reflection of the first photon .",
    "this is the blockade effect , which implies that photons are reflected on a one - by - one basis .",
    "the antibunching of rr naturally leads to a complementary peak in the reflection - transmission graph rt , since at that timescale a second photon must be transmitted .",
    "the transmission - transmission component tt , however , results from different mechanisms at short and long pulses ; at short pulses it reflects the probability that the ( spectrally broad ) photons did not interact with the atom at all , and so the peak in tt is as narrow as the pulse . for long pulses , tt results from the probability that the atom let one photon ` slip through ' , since it was already excited at that moment by the other photon . in that case the atom can emit the second photon both forward and backward at equal probabilities ;",
    "emission forward is the one that is presented in the tt graph , which is thus as wide as the atomic time scale @xmath58 .",
    "backward emission of the second photon leads to a transmission - reflection event tr , which is perhaps the most interesting process of the four .",
    "in particular , as we see in fig .  [",
    "fig : gamma]c , tr is the component that contributes the most to the routing efficiency @xmath10 at intermediate pulses , and not , as one would have expected naively , the antibunching of the rr process , whose contribution is negligible at intermediate and short pulse lengths .",
    "+ the underlying mechanism of the tr event with intermediate pulses is the simple fact that the photon emission rate from a feeder cavity occupied by two photons is twice as large as the emission rate from a cavity containing only one photon .",
    "consequently , a first photon is very likely to arrive shortly after the beginning of the pulse , before the atom builds its dipole field , and thus it is likely to be transmitted .",
    "the time interval between the first photon and the arrival of the remaining second photon is expected to be longer , giving the atom enough time to reflect it . as in the case of tt , transmission of the first photon",
    "does not necessarily leave the second photon in the feeder cavity , but can also result in the collapse of the atom to its excited state , from which the photon has a 50% probability of being reflected .",
    "these two mechanisms interfere constructively for the case of tr , but destructively for tt , thus considerably enhancing the routing efficiency .      in our calculations",
    "so far , the temporal profile of the pulse is the only free parameter in the problem , and thus the limited efficiency of the photon blockade mechanism is inherent and unavoidable . in order to verify the analytic calculations , and also to check the effect of using various pulse shapes , a wave function approach using a nonunitary hamiltonian was used to provide a fully quantized and complete simulation of the setup , including the microtoroid cavity ( which was adiabatically eliminated in our analytical calculations ) .",
    "the initial two - photon state is specified by @xmath63 where @xmath64 and @xmath65 ( @xmath66 and @xmath67 ) create and annihilate a right ( left ) propagating photon at a location @xmath68 in the fiber .",
    "@xmath69 denotes the vacuum state of the microtoroid cavity , and @xmath70 the ground state of the atom .",
    "@xmath71 is a normalized weight function that describes the probability amplitude of the two photons to be located at @xmath72 and @xmath73 .",
    "the effective hamiltonian is given by  @xcite @xmath74    with @xmath6 and @xmath75 ( @xmath7 and @xmath76 ) the annihilation and creation operators associated with the counterclockwise ( clockwise ) microtoroid cavity modes of frequency @xmath77 .",
    "@xmath78 is the central frequency of the pulse around which the fiber dispersion relation is linearized . @xmath79 and @xmath80 are the bare atom raising and lowering operators of the transition with frequency @xmath81 .",
    "@xmath82 is the group velocity of the pulse as it propagates through the fiber .",
    "@xmath83 is the population decay rate of the bare atom and @xmath84 is the intrinsic microtoroid cavity decay rate .",
    "the coupling strength between the fiber and the cavity is denoted by @xmath85 .",
    "the coupling between the cavity and the fiber is assumed to have a normal distribution @xmath86 , where @xmath87 is the effective interaction length .",
    "figure  [ fig : shapes ] presents the routing efficiency for various input pulse shapes , demonstrating little dependence on the pulse profile .",
    "gaussian pulses have been found to yield the best results , with a routing efficiency of @xmath88 , yet the inherent conflict and the resulting limited efficiency remain .",
    "( color online ) simulated results for the two - photon detection probabilities as a function of the pulse width for square pulses ( dashed curves ) , gaussian pulses ( dash - dotted curves ) and exponential pulses ( solid curves ) . for square and gaussian pulses",
    "the pulse width @xmath56 is defined by their half width half maximum .",
    "the parameters are @xmath89 70  mhz , @xmath90500  mhz , without losses ( @xmath91 ) .",
    "we note that the simulated results for exponential pulses are practically identical to the analytically calculated results presented in fig .",
    "[ fig : turnstile].,width=340 ]      the analysis so far relied on the fact that only one - photon transitions could take place , since atomic two - photon transitions ( such as from @xmath92 to @xmath93 in rb ) occur at a different frequency .",
    "thus , the atom behaves as a two - level system capable of dealing with only one excitation , with a linewidth dictated by the cavity - enhanced coupling to the output modes @xmath94 .",
    "exactly the same results are expected in the case of photon blockade in the strong - coupling regime of cavity qed . in that regime ,",
    "the nonlinear system is not the atom , but rather the coupled atom - cavity system , in which one - photon resonance and two - photon resonance are indeed at different frequencies  @xcite .",
    "the linewidth of each of the vacuum rabi sidebands in that case is @xmath95 , with @xmath96 being the bare cavity linewidth , and @xmath97 the atomic linewidth in free - space .",
    "thus , all our results so far are relevant for the photon blockade in the strong coupling regime as well , in which the interaction involves one of the rabi sidebands , at detuning @xmath8 from the bare - cavity resonance .",
    "the only difference therefore is that the bandwidth @xmath95 replaces @xmath94 in all the preceding expressions .",
    "we verified this by performing fully quantized simulations using the above method in the strong coupling regime , with the photons tuned to one of the rabi sidebands .",
    "indeed , these simulations yield results indistinguishable from those obtained in the fast cavity regime . +",
    "as established in the previous section , time - energy uncertainty relations are the key mechanism that limits the routing efficiency .",
    "therefore , it is interesting to study the possible influence of using time - energy entangled photon pairs as the input two - photon pulse .      in order to obtain analytic expressions ,",
    "the input pulse is now modeled by introducing a two - photon emitting atom with an infinitesimal intermediate state lifetime ( fig .",
    "[ fig : feeder_entangled ] ) driving the feeder cavity .",
    "two photons are thus simultaneously emitted into the feeder cavity at a rate @xmath98 , from which they decay independently at a rate @xmath99 .",
    "the feeder cavity then ` smears out ' the ideal entanglement generated by the three - level atom .",
    "therefore , the ratio @xmath100 sets the amount by which the two - photon pulse that drives the router is temporally squeezed .",
    "the feeder cavity is driven by a three - level atom emitting two photons at once.,width=340 ]    the effective hamiltonian to be used in this case is @xmath101 where @xmath102 , @xmath103 are the raising and lowering operators of the three - level atom for the transition from the upper state @xmath40 to the ground state @xmath8 .",
    "@xmath104 is the linewidth of the left mirror of the feeder cavity , and is taken to be very small but nonzero , to allow the feeder cavity to be driven by the three - level atom .",
    "note that although the quantity of interest is the entangled pulse transmitted to the router , most of the pulse does not enter the feeder cavity , and hence only events whereby both photons enter the feeder cavity are taken into account .",
    "the two - photon state can be expanded as @xmath105 where the first index describes the state of the three - level atom . solving the schrdinger equation we obtain    @xmath106\\nonumber\\\\ \\beta(t ) & = & -4\\sqrt{2\\kappa'_s\\kappa_s\\gamma_s\\gamma_c } \\frac{(2\\gamma_c-\\kappa_s)e^{-2\\gamma_s t } + ( 2\\gamma_s-2\\gamma_c-\\kappa_s)e^{-2\\kappa_s t}+ 2(\\kappa_s-\\gamma_s)e^{-(2\\gamma_c+\\kappa_s )",
    "t}}{(2\\gamma_c-\\kappa_s)(2\\gamma_s-2\\gamma_c-\\kappa_s)(\\kappa_s-\\gamma_s)}.\\nonumber\\end{aligned}\\ ] ]    by substituting these expressions into eq .",
    ", the routing efficiency can be calculated using eqs .",
    "( [ prr]-[definition ] ) , where @xmath107 , @xmath108 and @xmath109 are those of eqs .",
    "( [ solution1],[solution2 ] ) .",
    "this leads to the following expressions for the transmission and reflection probabilities : @xmath110 } { ( 2\\gamma_c+\\kappa_s)^2(2\\gamma_c+3\\kappa_s)(2\\gamma_s+2\\gamma_c+\\kappa_s)}.\\end{aligned}\\ ] ] note that these equations coincide with eqs .   in the limit of an unentangled input pulse ( @xmath111 ) .",
    "we see that the routing efficiency ( fig .",
    "[ fig : gsgc ] ) increases significantly as the entanglement is increased , reaching a 10% improvement at @xmath112 . for even larger values of @xmath100 ,",
    "the increase becomes less pronounced , and the efficiency tends to an asymptotic value of  @xmath1 .",
    "thus , we see that even an entangled state at the input can not completely eliminate the conflict that limits the routing efficiency of a two - level system .",
    "( color online ) the routing efficiency @xmath10 as a function of the pulse length @xmath56 and the ratio @xmath100.,width=340 ]    cascading of a single - sided cavity qed system and a photon router . due to the quarter wave plate ( qwp ) , the pulse is reflected by the polarizing beam splitter ( pbs ) after interaction with the single - sided cavity .",
    "the trajectory of the two - photon pulse is shown by the dashed line.,width=340 ]      although an entangled two - photon input pulse does not enable ideal routing , the increased efficiency obtained in this scenario seems potentially useful , especially since time - energy entanglement can be generated within a two - photon pulse by reflecting it from a single - sided cavity containing a two - level atom  @xcite , as depicted in fig .",
    "[ fig : cascaded ] .",
    "thus , one could imagine performing a two - stage interaction with a cavity qed system , the first for generating the entanglement , and the second for performing the routing .",
    "the underlying physical effect behind the generation of entanglement is the same interference that occurs between the driving field and the atomic dipole , which suppresses the forward transmission in the regular cavity configuration , and leads to the backscattering of the photon .",
    "however , in the case of a single - sided configuration , there is only one cavity mode , and the destructive interference between the atomic dipole and the driving field is only partial , such that the emitted photon flux equals the incoming photon flux .",
    "once a photon is scattered , however , the atomic state flips its phase , and subsequently the destructive interference becomes a constructive one . in more detail , the effective hamiltonian modeling the passage of a pulse through a single - sided cavity qed system in the fast cavity regime",
    "is given by @xmath113 where we assume that the atom is coupled to only one standing wave in the cavity , explaining why the decay rate of the atom is twice as small as in eq .  .",
    "the two - photon state is now expanded as @xmath114 with @xmath115e^{-\\kappa_s t}.\\end{aligned}\\ ] ] note that due to the single - sided configuration of the cavity , these expressions differ from those of eq .  .",
    "it is evident that the driving and the atomic radiation are out of phase .",
    "to illustrate the dynamics more clearly let us assume a long pulse ( @xmath116 ) and neglect transient effects that occur at @xmath117 .",
    "under these approximations the state of the system is @xmath118 \\:.\\ ] ] applying the output operator of eq .",
    "yields @xmath119 \\:,\\ ] ] corresponding to a photon detection probability rate of @xmath120 . as evident ,",
    "the detection of the first photon has led to a sign flip between the driving field and the atom , resulting now in a constructive interference , rather than the previous destructive one .",
    "normalizing the state and applying @xmath11 again shows that this leads to a sudden increase of the photon detection rate by a factor of @xmath121 to @xmath122 .",
    "since after one photon detection there is only one excitation left in the system , naively one could have expected the probability for a second photon detection to drop and not increase ; this increase is therefore in fact by a factor of 9 compared to the expected value at steady state , and thus the output state exhibits strong bunching and consequently time - energy entanglement between the two photons  @xcite .",
    "+ solving the evolution of the two - photon state using eq .   without approximations , we get that the probability amplitude of photon detections at times @xmath16 and @xmath123 is ( fig .  [",
    "fig : single - sided ] ) @xmath124e^{-2\\kappa_s t}e^{-\\kappa_s \\tau}\\\\ & & -2\\left[1 - 3e^{-(\\gamma_{c1}-\\kappa_s)\\tau}\\right]e^{-\\gamma_{c1 } t } e^",
    "{ -\\kappa_s t}e^{-\\kappa_s \\tau}. \\nonumber\\end{aligned}\\ ] ] the terms in the second brackets correspond to the transient behavior of the cavity - enhanced atom , and have influence only for short pulses , as evident from their fast decay by @xmath125 .",
    "the two terms in the first brackets thus demonstrate the main dynamics of the system .",
    "the first term presents the possibility that no interaction occurred with the atom , and the second , nonlinear term is the one that leads to the bunching of the two - photon pulse .",
    "+    ( color online ) probability of detecting two photons at times @xmath126 and @xmath127 for an exponential pulse ( @xmath128 ) after passage through a single - sided cavity qed system.,width=340 ]    the entanglement appearing in fig .",
    "[ fig : single - sided ] indeed suggests that by utilizing this pulse as the input to a routing system , higher efficiency might be obtained . in order to investigate this possibility",
    ", a triply cascaded system needs to be considered ( fig .",
    "[ fig : cascaded ] ) .",
    "the feeder cavity drives a single - sided cavity qed system with effective linewidth @xmath129 , and the resulting bunched light drives the photon router with linewidth @xmath130 .",
    "+ the hamilonian of this system consists of the hamiltonians of its subsystems , given by eq .   and",
    "eq .  , and a term corresponding to the driving of the photon router by the single - sided cavity @xmath131 the analytic solution of the detection probabilities is calculated in the appendix . the resulting routing efficiency is shown in fig .",
    "[ fig : gc1gc2 ] .",
    "+ note that for @xmath132 we recover the result of fig .",
    "[ fig : turnstile ] . by increasing @xmath129",
    "the pulse becomes bunched , and the routing efficiency reaches  @xmath133 .",
    "however , while the bunching ratio increases , the bunching efficiency decreases .",
    "this is due to the decreasing area of the bunched part in fig .",
    "[ fig : single - sided ] as it becomes narrower .",
    "hence , further increase of @xmath129 ceases to improve the routing efficiency .",
    "we conclude that a two - stage interaction with the cavity - enhanced atom , can only improve the routing efficiency by at most  @xmath134 .",
    "( color online ) routing efficiency as a function of the cavity - enhanced decay rates during the first and second passages through the system.,width=340 ]",
    "in the previous sections we have studied the limitations of a two - level system as a photon router .",
    "the situation changes dramatically when another cavity - enhanced atomic transition is introduced , for example by utilizing a three - level atom in the @xmath135-configuration inside the cavity .",
    "we shall consider the behavior of this system in the single - sided cavity setup , as depicted in fig .",
    "[ fig : three ] .    schematic depiction of a three - level atom in the @xmath135-configuration inside a single - sided cavity .",
    "the trajectory of the pulse is shown by the dashed line.,width=340 ]    the two ground states are denoted by @xmath136 and @xmath137 , and the excited state by @xmath138 .",
    "we denote the fields resonant with the @xmath139 transition and with the @xmath140 transition as @xmath141 and @xmath142 fields , respectively , assuming they differ in polarization .",
    "this enables separation of both fields by a polarizing beam - splitter ( pbs ) . in this configuration , therefore , routing to the two different output ports is performed by manipulating the polarization of the photons .",
    "+ taking the feeder cavity to be resonant with the @xmath141-transition , the appropriate hamiltonian is    @xmath143    where @xmath144 and @xmath145 .",
    "@xmath146 , @xmath147 are the cavity - enhanced decay rates from the excited state into ground states @xmath136 and @xmath137 , respectively .    for a long input pulse ( @xmath148 ) containing a single @xmath141-photon , the probability of a full transfer to the right ground state @xmath137 starting with an atom in the left ground state @xmath136 is given by @xmath149 thus , by choosing transitions for which @xmath150 , one can approach @xmath151 , and obtain deterministic transfer of the atom from one ground state to the other .",
    "in that process , the @xmath141-photon is absorbed and released as a @xmath142-photon .",
    "this configuration was studied by koshino _",
    "et al . _ , who demonstrated that it may be used to implement deterministic quantum state transfer and a @xmath152 gate between a photon and an atom  @xcite .",
    "in order to use this apparatus for photon routing , we generalize this result by starting with a fock state @xmath153 of type @xmath141 in the feeder cavity . assuming the atom is initialized in the left ground state @xmath136",
    ", the wave function evolves to @xmath154 by solving the schrdinger equation with the hamiltonian of eq .  , we get @xmath155 t }     \\right)\\nonumber.\\end{aligned}\\ ] ] using the output operators from eq .",
    ", we get that the probability of first detecting a @xmath142-photon is    @xmath156/4\\gamma_{ch}\\gamma_{cv}}.\\ ] ]    once again , by using a long enough pulse and symmetric transitions , the first detected photon will with certainty be a @xmath142-photon .",
    "when that happens , the atom collapses to the ground state @xmath137 , and becomes transparent to all the remaining @xmath141-photons , which are consequently reflected from the cavity unchanged .",
    "the mapping resulting from the passage through the system is thus @xmath157    ( color online ) routing efficiency @xmath10 as a function of the cavity - enhanced decay rates @xmath158 and @xmath159.,width=340 ]    i.e. , it acts as an ideal photon router , which is transparent to all but one photon .",
    "specifically , in the case of @xmath160 , we obtain for the routing efficiency ( fig .",
    "[ fig : gchgcv ] ) @xmath161 where @xmath162 is the probability of detecting an @xmath141-photon after a @xmath142-photon has been detected , and @xmath163 is the probability of first detecting an @xmath141-photon and then a @xmath142-photon . taking into account",
    "that @xmath162 can be made close to unity by itself , we see that this routing process includes an inherent robustness , or error - correction mechanism , since in the unlikely event in which the first photon stays @xmath141 ( for example , due to a slight mismatch between @xmath158 and @xmath159 or due to non - negligible @xmath164 ) , the second photon is likely to be turned into @xmath142 , leading to the desired result nonetheless .",
    "naively , one could expect @xmath163 to be @xmath165 , namely the probability that the first photon was not turned to @xmath142 times the probability of turning the last remaining photon into @xmath142 , however @xmath166 is correct only for an atom that begins at the ground state @xmath136 , whereas after detection of an @xmath141 photon the atom has some probability amplitude to be in the excited state @xmath138 .",
    "the full solution for @xmath163 , following the same procedure as for @xmath167 , is : @xmath168 the overall routing efficiency is presented in fig .",
    "[ fig : gchgcv ] .",
    "the contribution of @xmath163 adds to already - high values of @xmath167 to result in efficiencies that approach unity for reasonable @xmath159,@xmath158 , and thus we see that this process acts as a robust and nearly ideal photon router , free from the limitations discussed in the previous sections .",
    "+ finally , we wish to estimate the robustness of this routing scheme to losses in the system .",
    "we approximate the effect of the coupling to the environment by calculating the probability of a quantum jump in the system , neglecting the change in eq .  .",
    "the effect of spontaneous emission into the vacuum at rate @xmath97 for long pulses and @xmath169 is then given by @xmath170 which is independent of @xmath164 .",
    "the efficiency of the routing is thus not increased by taking longer and longer pulses , as is the case for stimulated raman adiabatic passage , but can be suppressed by increasing the cavity - enhanced atomic decay rate .",
    "the effect of intrinsic losses of the microtoroid cavity can be evaluated by omitting the fast - cavity approximation , and including the microtoroid cavity modes in the system dynamics .",
    "the probability of losing a photon is then calculated to be @xmath171 this effect can be suppressed by increasing the cavity decay rate into the fiber . hence , by taking @xmath172 and @xmath173 , the routing mechanism is made robust against both loss mechanisms . +",
    "in this work we analyzed photon routing in cavity - qed , focusing on the task of separating two incoming indistinguishable photons to different ports . we have shown that using just one cavity - enhanced two - level system is insufficient for this task , since the bandwidth of the system and the timescale of its nonlinearity , namely the temporal duration at which the system will respond differently to two photons than to one photon , are inherently linked by the uncertainty principle .",
    "this inherent conflict limits the efficiency of photon routing to  @xmath0 .",
    "we have shown that even the use of time - energy entangled photons at the input pulse does not circumvent this conflict completely , although it does enable some increase in the efficiency of the process .",
    "finally , we have shown how the use of a three - level system does enable ideal photon routing , free from the limitations of a two - level system .",
    "specifically , we presented a scheme that uses an atom in the @xmath135-configuration with both transitions enhanced by a single - sided cavity , to create a photon routing mechanism in which one and only one photon from the incoming pulse is directed to one port , while the remaining photons are directed to the other port .",
    "this scheme is robust against variations in the pulse width and parasitic losses with realistic parameters , and provides a promising method for efficient routing of single photons . +",
    "this work was partially supported by the israel science foundation , the wolfson foundation and the crown photonics center .",
    "this research was made possible in part by the historic generosity of the harold perlman family .",
    "sp acknowledges support from the marsden fund of the royal society of new zealand .      the two - photon state of the cascaded system depicted in fig .",
    "[ fig : cascaded ] can be decomposed into @xmath174 where the second and third indices describe the atomic states of the single - sided subsystem and the photon router subsystem , respectively . using the schrdinger equation , the coefficients of eq .",
    "are found to be    @xmath175e^{-\\kappa_s t}\\nonumber\\\\ \\delta(t ) & = & 2\\sqrt{2}\\frac{\\gamma_{c1}+\\kappa_s}{\\gamma_{c1}-\\kappa_s}\\frac{\\sqrt{\\gamma_{c2}\\kappa_s}}{2\\gamma_{c2}-\\kappa_s}e^{-2\\kappa_s t } -4\\sqrt{2}\\frac{\\gamma_{c1}}{\\gamma_{c1}-\\kappa_s}\\frac{\\sqrt{\\gamma_{c2}\\kappa_s}}{2\\gamma_{c2}-\\gamma_{c1}}e^{-(\\gamma_{c1}+\\kappa_s)t } + 2\\sqrt{2}\\frac{2\\gamma_{c2}+\\gamma_{c1}}{2\\gamma_{c2}-\\gamma_{c1}}\\frac{\\sqrt{\\gamma_{c2}\\kappa_s}}{2\\gamma_{c2}-\\kappa_s}e^{-(2\\gamma_{c2}+\\kappa_s)t } \\nonumber\\\\ \\eta(t ) & = & 4\\sqrt{2}\\frac{\\kappa_s\\sqrt{\\gamma_{c1}\\gamma_{c2}}}{(\\gamma_{c1}-\\kappa_s)(2\\gamma_{c2}-\\kappa_s ) }   \\left\\ {   \\frac{2\\gamma_{c2}-\\gamma_{c1}-2\\kappa_s}{2\\gamma_{c2}+\\gamma_{c1}-2\\kappa_s }    \\left[e^{-2\\kappa_s t } - e^{-(2\\gamma_{c2}+\\gamma_{c1 } ) t}\\right ]   \\right.\\nonumber\\\\    & & \\left .",
    "+ \\frac{3\\gamma_{c1}-2\\gamma_{c2}}{2\\gamma_{c2}-\\gamma_{c1 } }                     \\left[e^{-(\\gamma_{c1}+\\kappa_s ) t } - e^{-(2\\gamma_{c2}+\\gamma_{c1})t}\\right ]   -\\frac{2\\gamma_{c2}+\\gamma_{c1}}{2\\gamma_{c2}-\\gamma_{c1 } }                       \\left[e^{-(2\\gamma_{c2}+\\kappa_s ) t } - e^{-(2\\gamma_{c2}+\\gamma_{c1})t}\\right ] \\right\\}\\nonumber.\\end{aligned}\\ ] ]        if the system collapses to a state in which the first atom is excited , we have @xmath178 where @xmath179 and finally , if the state collapses to a state in which the second atom is excited , we have @xmath180 , with @xmath181 using eq .  , the correlation functions are given by    @xmath182 +         \\sqrt{\\gamma_{c2}}\\delta(t)\\left[\\sqrt{\\kappa_s}a_1(\\tau)+\\sqrt{\\gamma_{c1}}b_1(\\tau)+\\sqrt{\\gamma_{c2}}c_1(\\tau)\\right ]                                 \\right|^2   \\\\",
    "\\gamma^{rt}(t,\\tau ) & = & 4\\left|        \\sqrt{\\gamma_{c2}}\\left[\\sqrt{2\\kappa_s}\\alpha(t)+\\sqrt{\\gamma_{c1}}\\beta(t)+\\sqrt{\\gamma_{c2}}\\delta(t)\\right]c_1(\\tau)\\right.\\nonumber\\\\        & & \\left.+\\sqrt{\\gamma_{c2}}\\left[\\sqrt{\\gamma_{c2}}\\eta(t)+\\sqrt{\\kappa_s}\\beta(t)\\right]c_2(\\tau )          + \\sqrt{\\gamma_{c2}}\\left[\\sqrt{\\gamma_{c2}}\\eta(t)+\\sqrt{\\kappa_s}\\delta(t)\\right]c_3(\\tau )                                 \\right|^2    \\nonumber\\\\",
    "\\gamma^{rr}(t,\\tau ) & = & 4\\left|\\gamma_{c2 }          \\left",
    "(   \\eta(t)c_2(\\tau)+ \\delta(t)c_1(\\tau ) \\right )                               \\right|^2      \\nonumber\\\\",
    "\\gamma^{tt}(t,\\tau ) & = & 4\\left|          \\left[\\sqrt{2\\kappa_s}\\alpha(t)+\\sqrt{\\gamma_{c1}}\\beta(t)+\\sqrt{\\gamma_{c2}}\\delta(t)\\right]\\left[\\sqrt{\\kappa_s}a_1(\\tau)+\\sqrt{\\gamma_{c1}}b_1(\\tau)+\\sqrt{\\gamma_{c2}}c_1(\\tau)\\right]\\right . \\nonumber\\\\          & & \\left.+\\left[\\sqrt{\\gamma_{c2}}\\eta(t)+\\sqrt{\\kappa_s}\\beta(t)\\right]\\left[\\sqrt{\\gamma_{c1}}b_2(\\tau)+\\sqrt{\\gamma_{c2}}c_2(\\tau)\\right ]           + \\sqrt{\\gamma_{c2}}\\left[\\sqrt{\\gamma_{c2}}\\eta(t)+\\sqrt{\\kappa_s}\\delta(t)\\right]c_3(\\tau )                                \\right|^2.\\nonumber\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> the most simple and seemingly straightforward application of the photon blockade effect , in which the transport of one photon prevents the transport of others , would be to separate two incoming indistinguishable photons to different output ports . </S>",
    "<S> we show that time - energy uncertainty relations inherently prevent this ideal situation when the blockade is implemented by a two - level system . </S>",
    "<S> the fundamental nature of this limit is revealed in the fact that photon blockade in the strong coupling regime of cavity qed , resulting from the nonlinearity of the jaynes - cummings energy level structure , exhibits efficiency and temporal behavior identical to those of photon blockade in the bad cavity regime , where the underlying nonlinearity is that of the atom itself . </S>",
    "<S> we demonstrate that this limit can be exceeded , yet not avoided , by exploiting time - energy entanglement between the incident photons . </S>",
    "<S> finally , we show how this limit can be circumvented completely by using a three - level atom coupled to a single - sided cavity , enabling an ideal and robust photon routing mechanism . </S>"
  ]
}