{
  "article_text": [
    "many large - scale density - functional theory ( dft ) methods make use of localized basis functions , since locality in some form is an essential prerequisite for developing a method that scales linearly with system size  @xcite . in particular , the use of strictly localized orbitals  @xcite results in the hamiltonian being formally sparse , without needing to impose a cutoff tolerance on the matrix elements .",
    "numerical atomic orbitals ( naos ) of finite range  @xcite have been found to be particularly well - suited for dft calculations , due to the fact that they are very flexible , and , therefore , only a small number of them is usually needed to obtain accurate results  @xcite .",
    "the transferability of the nao basis between different systems has also been found to be quite reasonable  @xcite .",
    "the most important drawback of using naos is the lack of a systematic way of improving the basis to arbitrary precision , such as what can easily be achieved in plane - wave ( pw ) methods  @xcite by increasing the kinetic energy cutoff , or in real - space - grid methods  @xcite by decreasing the grid spacing .",
    "this is an important shortcoming of the method , since it means that it is not possible to assess the accuracy of the calculation with respect to the basis set with any degree of certainty .",
    "in contrast , it is standard practice in studies using pw methods to perform preliminary convergence tests for the kinetic energy cutoff on representative samples of the system in question , in order to tune the cutoff to be used in the production calculations to a given degree of accuracy .    in this paper",
    ", we aim to demonstrate best practice in the generation of transferable nao basis sets of increasing accuracy for ordered and disordered bulk material , and to show how it is possible to determine with confidence the level of accuracy of the basis by careful comparison with pw calculations .    as a test case , we focus on water , in the liquid and two solid phases .",
    "water is a material of fundamental importance in many different areas of science , and is currently of great interest to practitioners of _ ab initio _ techniques , since the subtle interplay between different interaction mechanisms that gives rise to its unusual properties ( e.g. , its notoriously complex phase diagram  @xcite , and the large number of anomalies in the liquid phase  @xcite ) is still not well understood ( see , e.g. , refs .",
    "@xcite ) . however , _",
    "ab initio _ molecular dynamics ( aimd ) studies using pw methods have been limited by the small system sizes and simulations times that are accessible due to computational cost , while the accuracy of existing nao basis sets for such systems has never been systematically verified , as we propose here .",
    "using the water monomer as our starting point , we construct double- , triple- , and quadruple-@xmath0 basis sets for hydrogen and oxygen . we make use of a previously - documented confinement potential for the valence orbitals  @xcite , and propose a simple new form for the polarization orbitals .",
    "we find this new confinement scheme to give a good control over the overall shape of the polarization orbitals by varying a single parameter , making it ideal for variational optimization .",
    "we test our basis sets on the water dimer , ice i@xmath2 and viii , and liquid water , showing our most accurate bases to achieve the level of precision of high - quality pw calculations for energies , pressures , and forces , and all bases to be highly transferable between systems .",
    "therefore , our basis sets can be used with confidence for ambitious future studies of aqueous systems , as they enable cost - efficient large - scale simulations of high accuracy .",
    "we use the siesta  @xcite code for generating the nao bases and performing the dft calculations with them , and the abinit  @xcite code for the comparison calculations using pw bases . for both codes",
    "we use the pbe  @xcite semi - local ( gga ) exchange - correlation functional , and the same set of norm - conserving pseudopotentials in troullier - martins form  @xcite .",
    "the pseudopotential core radius is 0.66    for all angular momentum channels of h and 0.61    for all channels of o ; we also employ a small non - linear core correction  @xcite for o. the pseudopotentials are factorized in the separable kleinman - bylander form  @xcite , with the same local and non - local components used in both codes  @xcite .",
    "the naos making up our basis sets are composed of a freely - varying radial function multiplied by a spherical harmonic ; the radial part is defined numerically and is strictly zero beyond a cutoff radius @xmath3 .",
    "the siesta method for generating nao bases has been documented in several previous publications  @xcite .",
    "the main ideas are :    * a soft confinement potential of the form @xmath4 between an inner radius @xmath5 and @xmath3  @xcite ; * a scheme for obtaining multiple-@xmath0 for each orbital  @xcite , inspired by the split valence method used in quantum chemistry for gaussian basis sets  @xcite ; * polarization orbitals obtained either by applying a small electric field within perturbation theory  @xcite , or by adding unoccupied atomic shells of higher @xmath6 with soft confinement  @xcite .    using these schemes",
    ", it is possible to achieve significant optimization of a fixed - size basis by varying the free parameters for each shell : @xmath3 , @xmath5 and @xmath7 , and the matching radii @xmath8 which define the multiple-@xmath0 orbitals . increasing the orbital cutoff radius",
    "generally provides a better quality basis , but also increases its computational cost .",
    "two schemes have been proposed for achieving an optimal balance between accuracy and cost based on a single parameter : the orbital energy shift in the isolated atom caused by confinement  @xcite , and a fictitious ` basis enthalpy ' calculated using the orbital volume and a pressure - like variable  @xcite .    for the valence shells ,",
    "soft confinement has proven to be very satisfactory : not only does it remove the problematic derivative discontinuity introduced by hard - walled confinement , but it also performs better at a given @xmath3 from a variational point of view .",
    "this can be attributed to the fact that it has little effect on the shape of the orbital in the core region , resulting in a good agreement with the free atom orbital .    instead , the choice of polarization orbitals is more problematic , as the free atom orbitals of higher @xmath6 can become quite extended , or even entirely unbound .",
    "the explicit polarization of the pseudoatom by a small electric field provides an elegant and parameter - free solution , as the extent of the polarization orbitals is defined by that of the orbitals they polarize .",
    "practical applications , however , have shown that a better variational estimate is instead usually obtained by including the unoccupied atomic shells of higher @xmath6 with an aggressive soft confinement , in order to control the position of the maximum of the radial part of the orbital  .",
    "it is also important to note that the former method only allows for orbitals up to @xmath9 ( @xmath10 being the highest angular momentum for the valence shells ) , while the latter method can include shells of any @xmath6 .    in this work",
    "we propose a new confinement scheme for obtaining short - range polarization orbitals that exhibit a good agreement with the free atom orbitals in the core region .",
    "we use a yukawa - like screened coulomb potential of the form @xmath11 for which the main parameter for variational optimization is the strength @xmath12   rather than for shaping the orbital .",
    "default values of @xmath13  ry@xmath14a@xmath15 and @xmath16 can generally be used without further optimization . ] .",
    "@xmath17 is introduced to avoid numerical difficulties arising from the singularity at @xmath18 , and after some tests has been fixed to 0.01 a@xmath15 .",
    "@xmath19 can additionally be used for fine tuning of the orbital tail ( the default value is set to 0 , thus making eq .",
    "[ eq : q ] a normal coulomb potential ) .",
    "[ fig : q_conf ] shows the radial part of the orbitals obtained with our new coulomb confinement scheme for the 3d shell of o. its decay is intermediate between those obtained by @xmath20-field polarization and soft confinement , and is similar to that of the free atom orbital . within a double-@xmath0 basis with a single polarization shell ( @xmath21 ) , the coulomb confinement scheme results in a variationally better basis for the water monomer and dimer respect to soft confinement ( by @xmath180  mev / molecule ) , as well as a smaller counterpoise ( cp ) correction  @xcite ( by 5  mev ) .",
    "[ fig : q_confb ] shows a similar behaviour for the 3d shell of si ; in this case , however , the free atom orbital is unbound .",
    "as before , the radial part of the coulomb - confined d orbitals exhibits a slower decay than the soft - confined one , thereby achieving a greater overlap with that of the p orbitals they are polarizing , which gives the latter more flexibility . in bulk silicon , this results in coulomb confinement gaining @xmath14  mev / atom respect to soft confinement .    making use of the coulomb confinement scheme for the polarization orbitals",
    ", we have developed a series of 13 basis sets of increasing accuracy for the water molecule , ranging from 23 to 91 basis orbitals / molecule . following the systematic convergence strategy proposed for correlation - consistent basis sets  @xcite ,",
    "the maximum size of our bases depends on the number of @xmath0 orbitals used for the valence shells , decreasing by one for each additional polarization shell : @xmath21 , @xmath22 , @xmath23 , and so on .",
    "we also provide intermediary bases with various subsets of the full number of polarization orbitals indicated by this scheme .",
    "we limit @xmath24 , and so the largest basis we consider is @xmath25 . for cases in which the number of @xmath0 orbitals in the polarization shells differs between o and h , we adopt the following naming convention :",
    "the highest level of @xmath0 is used , followed in brackets by the element for which it applies ; the other element in such cases has one fewer shell .",
    "for example , @xmath26  includes a double-@xmath0 polarization shell for h , and a single-@xmath0 polarization shell for o.    we do not here consider the optimization of @xmath3 , but simply fix it to 4.5    for the double- and triple-@xmath0 bases , and to 5.3    for the quadruple-@xmath0 bases .",
    "we test the effect of varying the cutoff radius for the @xmath27  basis , by decreasing @xmath3 to 4.5    ( the shorter basis is denoted as @xmath28 ) ; the difference in energy is minimal ( table  [ table : dimer_summary ] ) .",
    "other parameters , including @xmath12 and @xmath19 , are optimized variationally for the water monomer ( see supplementary material for full specifications of all basis sets used ) .",
    "we also include in our results two previously proposed bases  @xcite , obtained using the basis enthalpy optimization procedure  @xcite with a confining pressure of 0.2  gpa ; for these bases ( which we denote as @xmath29  and @xmath30 ) the value of @xmath3 varies between shells , up to a maximum of 3.3    for @xmath29  and 3.7    for @xmath30 .",
    "the many different options for defining the basis orbitals discussed and reviewed above are at the disposal of the user for generating good basis sets .",
    "it must be remembered , however , that there is no unique way of defining a basis , and that , as for pseudopotentials , the responsibility of the choice of basis lies with the person performing the calculations .",
    "methods like siesta are limited to using naos of finite range , but there is absolute freedom in the radial shapes , their range , the number of orbitals , the angular momentum values , and even the location ( which is not restricted to be centred on an atom ) .    here",
    "we present some guidelines for producing reasonable basis sets :    * use as many basis functions as required for the accuracy needed , following the canonical hierarchy described above starting from the minimal single-@xmath0 basis : @xmath31 , @xmath21 , @xmath22 , @xmath23 , and so on . *",
    "avoid too large or too small orbital ranges . some procedures ,",
    "like the one based on an energy shift  @xcite , or blind variational optimization based on a single reference  @xcite can produce very short orbitals for light elements , inner orbitals , or cations .",
    "this severely limits the transferability of the basis .",
    "never use orbitals with radii smaller than 3   . on the other hand ,",
    "some procedures generate extremely large cutoff radii ( e.g. , in loosely bound states , as the 4s shell in transition metals ) .",
    "if they are used for bulk calculations , functions with radii larger than 5    can be quite useless ( there are sufficient other functions in neighbouring atoms ) but make the calculations substantially less efficient .",
    "siesta allows the user to establish both a minimum and a maximum cutoff radius globally .",
    "* use the soft confinement potential for smoothening the radial function close to @xmath3 only , with @xmath32 . * for generating a polarization shell ,",
    "use the coulomb confinement potential described above ( if not using the perturbative @xmath20-field polarization option ) .",
    "@xmath12 ( and , optionally , @xmath19 ) can be defined variationally on a set of representative simple systems , or by maximizing the overlap of the radial part of the polarization orbitals @xmath33 with the one of the shell to be polarized @xmath34 : @xmath35 .",
    "* finally , the matching radii for the multiple-@xmath0 orbitals can be defined variationally .",
    "we first show the convergence of the total energy for a single water molecule in a large box ( @xmath36  @xmath37 ) .",
    "we perform a series of pw calculations of increasing kinetic energy cutoff , up to a maximum of 5000  ev ( by which point the total energy is converged to @xmath38  mev ) . in fig",
    "[ fig : monomer ] , we show how our nao bases compare with the pw bases . since the same pseudopotential is used in both sets of calculations , the total energies can be compared directly .",
    "the nao bases show a smooth convergence with basis size , similar to that of pws ; it is tempting therefore to equate each nao basis with the pw cutoff giving the same total energy , despite the fact that the hilbert space spanned by them is very different .",
    "nevertheless , the nao bases undoubtably achieve a good level of variational convergence , with the @xmath25  basis reducing the error in the total energy to @xmath130  mev , as much as a 1460  ev pw cutoff .",
    "even our smallest basis , @xmath21 , is reasonably well converged : the total energy error is @xmath1380  mev , equivalent to a 1080  ev cutoff .",
    "the error for all nao basis sets is listed in table  [ table : dimer_summary ] .",
    "there is a fairly large energy difference between the @xmath29  and @xmath30  bases and our newly parametrized ones of the same size ( denoted simply @xmath21  and @xmath39 ) .",
    "this we attribute both to the use of coulomb confinement for the first polarization shell and the larger cutoff radii . in general , the convergence with basis size is almost monotomic ; the only exception is the @xmath40  basis , for which we add a set of diffuse orbitals of s and p symmetry onto the o ion in order to capture the swelling due to its anionic character .",
    "this basis adds four new orbitals onto @xmath41 , yet gains 6  mev more energy than @xmath42 , which adds six .",
    "such small energy differences , however , do not significantly alter the overall convergence behaviour .    fig .  [",
    "fig : dimer ] shows the pw convergence and values for three selected nao bases of the binding energy @xmath43 of the water dimer in a fixed geometry ( from supplementary material of ref .",
    "the results for all nao bases are given in table  [ table : dimer_summary ] . in order to ensure that periodic image interactions are negligible",
    ", we use a @xmath44    box . here , the difference between nao and pw bases is clear , as the former converges from above and the latter from below .",
    "all our quadruple-@xmath0 bases give an error in @xmath43 within 23  mev of the converged pw result .",
    "for the double- and triple-@xmath0 bases , basis set superposition error ( bsse ) accounts for most of the total error .",
    "the addition of a cp correction term to @xmath43 brings all bases to within the same level of precision of the quadruple-@xmath0 ones ; only @xmath29  and @xmath30  are somewhat less precise ( with errors of 1013  mev ) , despite having a smaller cp correction due to their shorter range .",
    "@lccccc basis set & basis size & @xmath20 ( mev ) & @xmath43 ( mev ) & @xmath45 ( mev ) & cp corr .",
    "( mev ) + @xmath29 & 23 & 378.61 & 266.38 & 241.16 & @xmath4625.22 + @xmath21 & 23 & 280.02 & 251.51 & 226.52 & @xmath4624.99 + @xmath30 & 29 & 217.98 & 249.42 & 239.89 & @xmath469.53 + @xmath39 & 29 & 142.84 & 241.34 & 229.48 & @xmath4611.86 + @xmath26 & 35 & 102.14 & 232.01 & 226.80 & @xmath465.21 + @xmath47 & 40 & 95.59 & 230.68 & 225.96 & @xmath464.72 + @xmath22 & 57 & 57.64 & 228.68 & 223.65 & @xmath465.03 + @xmath28 & 46 & 84.97 & 231.50 & 229.70 & @xmath461.80 + @xmath27 & 46 & 83.98 & 231.28 & 229.56 & @xmath461.72 + @xmath41 & 63 & 45.37 & 227.99 & 226.25 & @xmath461.74 + @xmath40 & 67 & 38.43 & 229.26 & 227.16 & @xmath462.10 + @xmath42 & 69 & 44.43 & 227.68 & 226.58 & @xmath461.10 + @xmath48 & 79 & 37.71 & 228.01 & 226.54 & @xmath461.47 + @xmath49 & 84 & 36.17 & 228.10 & 226.68 & @xmath461.42 + @xmath25 & 91 & 32.64 & 228.63 & 227.12 & @xmath461.51 + pw & - & 0.00 & 228.62 & - & - +    [ table : dimer_summary ]",
    "we now turn to the first test of our bases in bulk water systems , by focussing on two of the ordered phases of ice : cubic ice i@xmath2 and high - density tetragonal ice viii .",
    "the study of ice by first principles dft methods has progressed considerably in recent years  @xcite , but understanding in detail the relative energetic contributions that give rise to its phase diagram and the properties of the various phases remains a challenging problem of current interest . typically for such studies , it is desirable to calculate energy differences between configurations to within a few mev / molecule . to this end , we test the accuracy of the nao bases both in terms of the relaxation of the ionic positions and the final energy difference between the two phases under consideration .",
    "@lcccccccc & & + phase & basis & @xmath29 & @xmath21 & @xmath30 & @xmath39 & @xmath27 & @xmath25 & pw + & nao & 295.93 & 197.35 & 148.34 & 107.68 & 68.70 & 25.29 & - + & pw & 0.78 & 2.73 & 2.11 & 0.99 & 0.55 & 0.11 & 0.00 + & nao & 259.76 & 166.58 & 161.32 & 111.92 & 73.89 & 26.86 & - + & pw & 1.49 & 2.88 & 1.95 & 1.04 & 0.53 & 0.17 & 0.00 + & nao & @xmath46142.58 & @xmath46147.99 & @xmath46191.73 & @xmath46182.99 & @xmath46183.95 & @xmath46180.32 & - + & pw & @xmath46179.46 & @xmath46178.90 & @xmath46178.59 & @xmath46178.80 & @xmath46178.73 & @xmath46178.82 & @xmath46178.75 + & ref .",
    "@xcite & - & - & - & - & - & - & @xmath46178 .",
    "+    [ table : ice_summary ]    for the calculations , we fix the volume / molecule to 30.51  @xmath37 for ice ic and 20.45  @xmath37 for ice viii , using the equilibrium volumes reported by murray and galli  @xcite for pbe at ambient pressure , and the c / a ratio to 1.44 for ice viii .",
    "we use a @xmath51 monkhorst - pack ( mp ) k - point grid  @xcite for both unit cells .",
    "first , we perform pw cutoff convergence tests for the two ice phases up to a 5000  ev cutoff ; we find that 4500  ev gives extremely accurate results ( within 0.1  mev for total energies , 0.5  mev /   for ionic forces , and 0.05  kbar for pressures ) , and use this value for all pw results given in this section .",
    "we choose four representative nao basis sets for testing from those presented in the previous section ; additionally , the two old parametrizations for double- and triple-@xmath0 are also tested .",
    "the ice unit cells are relaxed with respect to the ionic positions for these six bases , and independently for pws , using a maximum force tolerance of 10  mev /  . finally , we recalculate the energy of the system with pws using the six geometries obtained from the nao bases .",
    "all results are given in table  [ table : ice_summary ] .",
    "the pw results for the different geometries show that all nao bases give sufficiently accurate ionic relaxations .",
    "the errors in the pw energy difference / molecule between the two phases using the nao - relaxed geometries , as compared with the pw - relaxed ones , are less than a mev in all cases , ranging from 0.71  mev for the @xmath29  geometries to only 0.02  mev for the @xmath27  ones .",
    "the errors in total energies are similarly small , less than 3  mev for all geometries .",
    "the accuracy of the relaxations is also confirmed by examining the bond lengths , with the largest errors found for the @xmath29  geometries ( up to 21  m ) , and the smallest for the @xmath25  ones ( up to 3  m ) .",
    "we now consider not only the geometries , but also the energies calculated with the nao bases .",
    "as should be expected , total energies / molecule of the ice phases have errors on the order of those reported in table  [ table : dimer_summary ] for the total energy of the monomer ; however , it is interesting to note that they are systematically smaller , resulting from the fact that we are now considering a condensed phase , thus enabling the naos to represent the charge density everywhere in the unit cell .",
    "the most important results are for the energy differences / molecule between phases given by the nao calculations .",
    "@xmath21  gives a fairly substantial error ( @xmath130  mev ) , while both @xmath39  and @xmath27  are in good agreement with the converged pw result , with errors of @xmath15  mev .",
    "the most accurate basis , @xmath25 , succeeds in reducing the error to less than 2  mev . as with the dimer binding energy",
    ", we find our new bases to give a substantial improvement with respect to the old parametrizations , especially in this case for @xmath39 .",
    "assessing the accuracy of our bases for water in its liquid state is more challenging than for the solid state , as the calculation of any quantity of interest will involve a statistical average over a md trajectory . performing a full aimd simulation using a tightly converged pw cutoff",
    "would be computationally very expensive , and , furthermore , would not allow for a detailed comparison with the results obtained for the same simulation using one of the nao basis sets , as the trajectories would quickly decorrelate .    here",
    "we employ a simple alternative method for testing basis sets for liquid systems , which can be used routinely to obtain accurate estimates of the errors in quantites such as total energies , energy differences , ionic forces and cell pressures , as well as for direct parametrization of the basis set using the same procedures proposed for fitting classical force fields from _ ab initio _ data  @xcite .",
    "we first employ the gromacs  @xcite code to perform two long 1  ns md runs of a box of 32 water molecules using the tip4p force field  @xcite , at equilibrium density ( 1.00  g / cm@xmath37 ) and high density ( 1.20  g / cm@xmath37 ) .",
    "we select 100 random snapshots from each run , which we use as our testing set ; the long md run ensures that they are uncorrelated .",
    "we include the high density run to ensure that we are sampling sufficient configurations with occupied interstitial anti - tetrahedral sites between the first and second coordination shells , as the correct description of these configurations is important for reproducing several key properties of the liquid  @xcite . finally , we perform single - point dft calculations of the 200 snapshots , using the various nao bases in siesta and pws at different cutoffs in abinit . in this case",
    "we choose 2700  ev as our ` converged ' pw cutoff value for comparing to all other bases .",
    "cutoff convergence tests on a few snapshots up to 5000  ev show this value to give total energies to within 1  mev , ionic forces to within 0.6  mev /  , and pressures to within 0.5  kbar .",
    "we perform our tests on five nao bases , @xmath29 , @xmath21 , @xmath30 , @xmath39 , and @xmath27 ; all results are given in table  [ table : water_summary ] .",
    "firstly , we examine the error in total energies / molecule for all the snapshots . as expected , calculating the average shift in total energy for all snapshots gives a similar convergence to that discussed previously for the water monomer and the two ice phases . one point of interest",
    "is that the average shifts calculated for the two densities become closer to each other as the quality of the basis increases , anticipating the fact that pressure values also become more precise .",
    "the best quantitative estimator of overall accuracy for a fixed - volume nve aimd simulation is the energy difference between snapshots . for this , we calculate the root mean square ( rms ) error in our test set ; the results are shown in fig .",
    "[ fig : ed_conv ] , compared to pw calculations of increasing cutoff .",
    "there is a negligible difference between the two densities , with the @xmath21 , @xmath39 , and @xmath27  bases giving rms errors equivalent to pw cutoffs of 820  ev , 910  ev , and 980  ev , respectively .",
    "this is similar to the errors in the dimer binding energy before applying the cp correction .",
    "the scatter plots in figs .  [ fig : ed_scatter ] and [ fig : ed2_scatter ] show these results in more detail , by comparing either a nao or a lower - cutoff pw basis with the converged pw basis , and plotting the energy difference between each pair of snapshots ; both densities are included in the plot .",
    "low - accuracy pw calculations give a large scatter of results , while all the nao bases considered give a tight clustering around the diagonal , as do the higher pw cutoffs .",
    "indeed , the nao bases show no spurious outliers at all , and , equally importantly , no obvious systematic trend away from the diagonal that might cause a significant difference in the region of configuration space explored during a md run .    fig .  [",
    "fig : f_conv ] shows the rms error in ionic forces .",
    "the results are very similar to those already discussed for energy differences , with the three new nao bases giving errors equivalent to pw cutoffs of 830  ev , 960  ev , and 1000  ev , respectively .",
    "differences between o and h ions are negligible ( see table  [ table : water_summary ] ) .",
    "the table also reports results for the rms angle between the forces obtained with the nao basis and the converged pw one ; these range from @xmath114@xmath53 for the @xmath21  basis to @xmath11@xmath53 for the @xmath27  one .",
    "it is noteworthy that the @xmath29  basis performs better than the newly parametrized version in terms of force magnitudes and angles ; this explains the relatively accurate relaxed geometries obtained for ice ( see table  [ table : ice_summary ] ) .",
    "finally , we examine the accuracy of our bases for calculating cell pressures .",
    "it is well - known that pw calculations suffer in this respect from the fact that the kinetic energy cutoff effectively changes with an infinitesimal change in volume ( since the calculation of stresses is implicitly performed at constant pw number ) , leading to a spurious tensile stress . in order to elimate this ,",
    "the correction by meade and vanderbilt  @xcite ( here referred to as mv ) is generally applied .",
    "the mv correction is given by @xmath54 where @xmath20 is the total energy , @xmath55 the cell volume , and @xmath56 the kinetic energy cutoff .",
    "in contrast , the only systematic error introduced by nao basis sets in the calculation of stresses is that from bsse .",
    "[ fig : p_conv ] shows the average shift in pressure with respect to the converged calculations . even after applying the mv correction term ,",
    "the pw calculations give very large shifts , on the order of 10100  kbar .",
    "the nao shifts , instead , are of no more than 4  kbar ( for the @xmath21  basis ) .",
    "the pw convergence also varies significantly with density , which is not the case for the naos .",
    "we can use our results to define a simple and effective correction for cell pressures calculated with naos .",
    "this is illustrated in fig .",
    "[ fig : p_fit ] , showing a scatter plot of nao pressures with respect to the converged pw result ( note that we are plotting the error in the nao value against the absolute value from pws ) .",
    "two trends can be clearly observed : a constant shift to higher pressures ( i.e. , the same result as shown in fig .",
    "[ fig : p_conv ] ) , and an increase in the stiffness of the system ; both of these reduce with basis size , and are eliminated almost completely for the @xmath27  basis . therefore , by performing a linear fit to the data points for a given basis we obtain an expression for correcting pressure values in a large range .",
    "it is important to note that the figure includes data points at both densities , which show the same trend ; the correction can therefore also be used independently of density , at least within the range considered .    the effect of our correction for nao calculations is given in table  [ table : water_summary ] for average pressure shifts and rms errors in pressure differences .",
    "the correction reduces the average shift to very small values ( @xmath10.5  kbar ) for all bases , the remaining error being due to the small discrepancy between the uncorrected shifts at the two different densities shown in fig .",
    "[ fig : p_conv ] .",
    "pressure differences between snapshots are generally of less interest for md simulations than absolute values ; nevertheless , they can be used as an additional measure of the quality of the basis . the comparison with pws",
    "is shown in fig .",
    "[ fig : pd_conv ] , both for the uncorrected and corrected nao results ( the mv correction for pws has no effect on pressure differences ) .",
    "the three uncorrected nao bases give errors equivalent to pw cutoffs of approximately 810  ev , 950  ev , and 1000  ev , respectively , similarly to the values reported previously for other quantities of interest .",
    "after the correction is applied , the error for all bases is reduced to @xmath10.2  kbar . once again",
    ", we note the peculiarity of the @xmath29  basis ( used in ref .",
    "@xcite ) , which features a very small average pressure shift without the need for a correction , while the rms error in pressure differences follows the trend of the other bases .",
    "@lcccccccc & & & & + average shift & & & @xmath57 ( g / cm@xmath37 ) & @xmath29 & @xmath21 & @xmath30 & @xmath39 & @xmath27 + & 1.20 & 0.28 & 0.19 & 0.15 & 0.12 & 0.08 + & & & 1.00 & 0.29 & 0.21 & 0.16 & 0.12 & 0.08 + & & 1.20 & 0.06 & 4.18 & 2.48 & 1.73 & @xmath460.57 + & & & 1.00 & @xmath460.89 & 3.56 & 1.99 & 1.30 & @xmath460.48 + & & 1.20 & @xmath460.27 & @xmath460.55 & @xmath460.43 & @xmath460.37 & @xmath460.43 + & & & 1.00 & @xmath460.48 & @xmath460.65 & @xmath460.53 & @xmath460.50 & @xmath460.32 + rms error + & 1.20 & 1.86 & 1.90 & 1.32 & 0.93 & 0.47 + & & & 1.00 & 1.54 & 1.85 & 1.44 & 0.94 & 0.43 + & & 1.20 & 0.41 & 0.38 & 0.27 & 0.20 & 0.15 + & & & 1.00 & 0.39 & 0.31 & 0.22 & 0.15 & 0.10 + & & 1.20 & 0.33 & 0.21 & 0.14 & 0.16 & 0.13 + & & & 1.00 & 0.24 & 0.18 & 0.14 & 0.14 & 0.09 + & & 1.20 & 0.11 & 0.17 & 0.07 & 0.05 & 0.03 + & & & 1.00 & 0.11 & 0.17 & 0.07 & 0.05 & 0.03 + & & & 1.20 & 0.07 & 0.15 & 0.09 & 0.04 & 0.02 + & & & 1.00 & 0.07 & 0.15 & 0.09 & 0.04 & 0.02 + & & 1.20 & 8.27 & 13.83 & 5.41 & 4.33 & 0.98 + & & & 1.00 & 7.56 & 13.40 & 5.00 & 4.33 & 1.04 + & & & 1.20 & 7.57 & 15.11 & 8.91 & 3.88 & 1.77 + & & & 1.00 & 7.34 & 15.01 & 8.77 & 4.07 & 1.67 +    [ table : water_summary ]",
    "in this paper , we have described the development and testing of finite - range nao basis sets for water - based systems .",
    "we have discussed the general strategy employed for creating basis sets of increasing size and accuracy , and have proposed the use of a screened coulomb confinement potential for shaping the polarization orbitals , in order to achieve a good agreement with the higher angular momentum shells of the free atom without needing to extend the confinement radius beyond what is physically useful for condensed matter systems .",
    "we have presented 13 new bases for the water molecule , ranging from @xmath21  to @xmath25 .",
    "the full list of parameters needed to recreate and use them are given in the supplementary material ( we provide these instead of the numerical radial functions themselves so as to minimize the dependence on specific pseudopotentials ) .    in order to perform rigorous tests of the accuracy of our bases , we use auxiliary pw calculations at different kinetic energy cutoffs .",
    "we can therefore compare the results obtained with naos with the pw ones at a very large ( essentially fully converged ) cutoff , and also equate the accuracy of the various nao bases with pw bases at specific cutoffs .",
    "this is done using two different dft codes ( siesta for naos , abinit for pws ) with the same pseudopotentials and kleinman - bylander factorization ; even so , small algorithmic differences between the codes will affect the comparison with the nao bases of highest accuracy , slightly underestimating their performance with respect to pws for quantities such as energy differences .",
    "the results for our tests on a variety of molecular and condensed systems show the transferability and accuracy of the bases . in particular , there is a good level of consistency both between different systems and different properties of the same system when comparing to the performance of pw calculations at finite cutoff :",
    "errors in total energies for the @xmath21 , @xmath39 , and @xmath27  bases are on the order of those for cutoffs of 1100  ev , 1200  ev , and 1300  ev , respectively , while errors in energy differences , ionic forces , and pressure differences are on the order of those for cutoffs of 800  ev , 900  ev , and 1000  ev .",
    "however , it is important to remember that the two types of bases are not at all equivalent : this is clearly demonstrated by calculations of absolute pressure , which show naos to naturally give much smaller errors for this quantity than pws .",
    "we have also proposed a simple correction for further reducing errors in absolute pressures and pressure differences for nao calculations , based on a linear fit to the data obtained from 200 liquid water snapshots at two densities ; this can be used , e.g. , to correct average pressures obtained from nve aimd simulations .",
    "this work was partly funded by grants fis2009 - 12721 and fis2012 - 37549 from the spanish ministry of science .",
    "mvfs acknowledges a doe early career award no",
    ". de - sc0003871 .",
    "we thank javier junquera for support with the translation of pseudopotentials between siesta and abinit .",
    "the calculations were performed on the following hpc clusters : kroketa ( cic nanogune , spain ) , arina ( universidad del pas vasco / euskal herriko unibertsitatea , spain ) , magerit ( cesvima , universidad politcnica de madrid , spain ) .",
    "we thank the res  red espaola de supercomputacin for access to magerit .",
    "sgiker ( upv / ehu , micinn , gv / ej , erdf and esf ) support is gratefully acknowledged ."
  ],
  "abstract_text": [
    "<S> finite - range numerical atomic orbitals are the basis functions of choice for several first principles methods , due to their flexibility and scalability . generating and testing such basis sets , however , remains a significant challenge for the end user . </S>",
    "<S> we discuss these issues and present a new scheme for generating improved polarization orbitals of finite range . </S>",
    "<S> we then develop a series of high - accuracy basis sets for the water molecule , and report on their performance in describing the monomer and dimer , two phases of ice , and liquid water at ambient and high density . </S>",
    "<S> the tests are performed by comparison with plane - wave calculations , and show the atomic orbital basis sets to exhibit an excellent level of transferability and consistency . </S>",
    "<S> the highest - order bases ( quadruple-@xmath0 ) are shown to give accuracies comparable to a plane - wave kinetic energy cutoff of at least @xmath11000  ev for quantities such as energy differences and ionic forces , as well as achieving significantly greater accuracies for total energies and absolute pressures . </S>"
  ]
}