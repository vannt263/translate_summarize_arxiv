{
  "article_text": [
    "bayesian estimation strategies are the most general class of solutions to the state estimation problem , and apply readily to nonlinear systems where information about the state is represented by a probability density function ( pdf ) of general form . in this paper",
    "we introduce a novel , computationally cheap method for implementing grid - based bayesian estimation that exploits the fact that the pdf is usually negligible in most of phase space , while avoiding many of the disadvantages of other methods . the idea of grid - based bayesian estimation dates back at least to stratonovich ( 1959,1960 ) .",
    "the equations underlying the algorithm are laid out clearly in jazwinski ( 1970 , p.  164 ) , and are summarised below .",
    "however , numerical implementation of these equations has only been attempted sporadically in the half century since , for instance by kramer et al .",
    "( 1988 ) , terwiesch & agarwal ( 1994 ) and ungarala et al .",
    "grid - based bayesian methods typically suffer from the twin burdens of high computational cost and a finite domain size ; indeed , arulampalam et al .",
    "( 2002 ) , in their otherwise insightful review of particle filter methods , all but dismiss grid - based methods in  iv.b .",
    "we believe that this level of pessimism on this class of methods is unwarranted .",
    "the algorithm developed , dubbed gbees ( grid - based bayesian estimation exploiting sparsity ) , provides a means of efficient computation by building on an accurate integration scheme for hyperbolic systems , and a novel gridding scheme over _ all _ of phase space .",
    "consider the state estimation of the nonlinear system @xmath1 the grid - based bayesian estimation method is best visualized as an evolution of the pdf of the state estimate @xmath2 discretized on a fixed grid over all of phase space @xmath3 ; assuming the state @xmath4 develops according to the nonlinear equation , the method consists of two relatively straightforward steps ( for details , see jazwinski 1970 , p.  164 ) : + ( i ) between measurement times , the pdf itself , @xmath0 , is marched via discretization of the _ kolmogorov forward equation _ ( also called the _ fokker - planck equation _ ) @xmath5 where summation over repeated indices is implied and @xmath6 is the @xmath7th element of the spectral density , @xmath8 , of the state disturbances ( note that , in the special case that @xmath8 is diagonal and the state disturbance is independent of @xmath4 , this is just a diffusion term ) .",
    "risken ( 2002 ) reviews a number of methods for solving this equation , including analytic methods for special cases and eigenfunction expansions ( focusing on the stationary solution ) , however state - space and time discretisation for a non - stationary solution ( as performed here ) is only mentioned briefly , and assumed to apply only to finite domains .",
    "an accurate numerical method for marching this equation in time in the case that @xmath9 is outlined in  [ sec : nummeth ] ; adding an appropriate term to this discretization to apply diffusion to the pdf ( to account for gaussian state disturbances ) is straightforward , as discussed in ",
    "[ sec : nummethdiff ] .",
    "+ ( ii ) at the measurement times @xmath10 , the pdf is updated via bayes theorem ( bayes , 1763 ) , @xmath11 where @xmath12 denotes the _ a posteriori _ pdf ( after accounting for the measurement @xmath13 ) , @xmath14 denotes the uncertainty associated with the measurement ( which may or may not be gaussian in @xmath15 ) , @xmath16 denotes the _ a priori _ pdf ( before accounting for the measurement @xmath13 ) , and @xmath17 is an appropriate normalization constant , which is selected for every measurement update to normalize the discretization of @xmath12 such that its integral over phase space is unity .    to understand how the continuous state - space is discretized ,",
    "recall that the cumulative distribution function ( cdf ) of a random real vector @xmath4 , denoted @xmath18 , maps @xmath19 to the real interval @xmath20 $ ] that monotonically increases in each of the components of @xmath21 , and is defined @xmath22 where @xmath23 is some particular value of the random vector @xmath4 and @xmath24 denotes a probability measure that the conditions stated in @xmath25 are true . for any random vector @xmath4",
    "whose cdf is differentiable everywhere , the probability density function ( pdf ) @xmath26 is a scalar function of @xmath15 defined such that @xmath27 for small @xmath28 , the quantity @xmath29 represents the probability that the random vector @xmath4 takes some value within a small rectangular region centered at the particular value @xmath15 and of width @xmath30 in each coordinate direction @xmath31 .",
    "the method we have developed maintains a list of active cells on the grid over all of phase space in order to limit both the computational effort and the memory storage required in the numerical simulation .",
    "this list includes all cells in the discretization for which the pdf is greater than a given threshold , as well as all cells which , though they may or may not themselves exceed this threshold , are either one of the two immediate neighbor cells , in each of the @xmath32 coordinate directions , of those cells which exceed the threshold , or are one of the four neighbor cells , in each of the @xmath33 pairs of coordinate directions , which touch a corner of the cells which exceed the threshold . at each time step , cells are added to and removed from this list as appropriate , and the fluxes initialized and updated on every interior boundary between adjacent cells in the list .",
    "when performing a computation restricted to an evolving list of active grid cells of this sort , the relative position of the various cells in the list is needed frequently .",
    "this may be determined efficiently by keeping in each list record a pointer to the two immediate neighbor cells in each coordinate direction in the list , if these neighbor cells are present in the list , or to a null record if not , and updating these pointers appropriately as records are added to and removed from the list .",
    "these pointers interconnecting the list facilitate rapid computation of the numerical discretization given in in the next section .",
    "the most expensive step in maintaining this list of neighbor cells is making the appropriate connections when a new record is added to the list .",
    "though this may be accomplished by scanning the entire list , this approach becomes prohibitively expensive as the length of the list grows to thousands of cells .",
    "instead , we keep the list ordered by its indices ( e.g. , in a phase space with @xmath34 , ordered first by @xmath35 , then by @xmath36 , then by @xmath37 ) , and store the elements of the list as a binary tree .",
    "this allows the time - limiting search step to proceed at @xmath38 operations , where @xmath39 is the number of list elements .",
    "conveniently , this list ordering and searching can be handled using the c++ standard template library map container .",
    "the pde governing the evolution of the pdf in the present problem is given by .",
    "if @xmath9 , the equation is hyperbolic ; if @xmath40 , the equation , strictly speaking , changes type to elliptic . in practice , however , @xmath8 is usually relatively small .",
    "it is thus fitting to design a numerical method for accurate simulation of based on a proven algorithm for accurate simulation of hyperbolic pdes .",
    "fortunately , the fluid mechanics community has focused on the development of high performance computing techniques for numerical simulation of such `` convection - dominated '' problems for over 40 years , and these techniques are now quite refined and well understood .",
    "the numerical method best suited to the present problem is somewhat involved ; a comprehensive review of this class of methods is given in leveque ( 2002 ) . to focus this discussion ,",
    "consider first the two - dimensional , linear , hyperbolic pde in conservation form @xmath41 noticing that higher - dimensional cases follow as an obvious extension .",
    "following chapters 4 , 6 , 9 , 19 , and 20 of leveque ( 2002 ) , we implement a godunov - type finite volume method by writing on a uniform cartesian 2d mesh ( with constant @xmath42 and @xmath43 ) in the form @xmath44 where the fluxes @xmath45 and @xmath46 are determined , for all @xmath35 and @xmath36 , by first initializing @xmath47 where @xmath48 ,   @xmath49 , etc , then applying the _ corner transport upwind _ ( ctu ) terms by updating , for all @xmath35 and @xmath36 , @xmath50 where @xmath51 ,   @xmath52 ,   then applying the _ high - resolution correction terms _ by updating , for all @xmath35 and @xmath36 , @xmath53 where @xmath54 and the _ flux limiter _",
    "function @xmath55 $ ] is selected as one of several possible choices , including the _ monotonized central - difference _",
    "( _ mc _ ) limiter and the _ van leer",
    "_ limiter : @xmath56\\ } ,   \\\\ & \\textrm{{\\it van leer}:}\\quad & & \\phi(\\theta)=(\\theta + |\\theta|)/(1+|\\theta| ) .",
    "\\end{aligned}\\ ] ] note that exact conservation of the discrete approximation of the integral of @xmath57 over phase space , as implied by the continuous formulation in , follows immediately from .      in regions characterized by smooth variation of @xmath57 , @xmath58 and @xmath59 , and the algorithm described in ",
    "[ sec : nummeth ] is amenable to straightforward numerical analysis . for simplicity , consider here the 1d test problem @xmath60 where @xmath61 is a positive or negative constant . in this case , the discretization described above reduces to @xmath62 where @xmath63 and thus @xmath64 now applying to this equation the multidimensional taylor series expansion , @xmath65 and rearranging appropriately , gives @xmath66 differentiating with respect to @xmath67 and inserting into the rhs of the result , it is seen that the second and third terms on the rhs of the above expression cancel .",
    "thus , in regions of smooth variation of @xmath57 , the proposed scheme is _ second - order accurate in both space and time_. in space and @xmath68 in time , giving convergence of @xmath69 . ]",
    "a similar analysis follows for problems in higher dimensions .      a diffusion term is easily added to the discretization given in in a second - order central finite difference fashion simply by updating the fluxes such that , for all @xmath35 and @xmath36 , @xmath70 where @xmath71 is the coefficient of the diffusion term that is applied numerically .",
    "the flux limiter functions mentioned at the end of  [ sec : nummeth ] are designed to reduce the algorithm , locally , to a first - order spatial behavior while applying sufficient numerical diffusion in regions of large local curvature of @xmath57 on the grid , to provide a total variation diminishing ( tvd ) solution ( that is , preventing spurious oscillations with new local minima and maxima ) .",
    "we may compensate for the diffusion introduced by the numerical discretization of the convective terms simply by appropriately reducing the diffusion @xmath72 applied in the numerical simulation of .       and @xmath73 )",
    ", using the method in  [ sec : nummeth ] , taking @xmath9 , @xmath74 , @xmath75 , and a threshold of @xmath76 ( that is , tracking numerically only those cells with @xmath77 and their immediate neighbors ) .",
    "the distributions are compared in cross section in the plane @xmath78 , with the black solid line denoting the exact solution at @xmath79 for @xmath9 , the blue dashed line denoting the numerical solution at @xmath79 using @xmath9 , @xmath74 , @xmath75 and the red dot - dashed line denoting the exact solution at @xmath79 for @xmath80 .",
    "the leading - order error in the numerical solution at @xmath79 is a small amount of diffusion of @xmath57.,scaledwidth=45.0% ]    a simple yet sensitive numerical test of the algorithm is given in figure [ fig : sparsity ] ; this numerical test was taken with @xmath81 and @xmath82 in order to give simple solid body rotation about the origin , as suggested by leveque ( 2002 ) .",
    "if @xmath9 , the exact solution of the test problem considered in figure [ fig : sparsity ] at @xmath79 , after a single rotation of the system about the origin , is simply the initial condition . for the case where @xmath83 is constant and positive , the exact solution of this problem at @xmath79 may be obtained analytically by means of fourier transforms .",
    "as seen by comparing figure [ fig : sparsity ] to figure 20.5 of leveque ( 2002 ) , the result obtained via the gbees approach is essentially identical to that obtained using the complete grid when sufficiently small threshold , time step and state - space discretization is used .",
    "the information loss due to the discretization scheme may be quantified via the kullback - liebler divergence ( kullback & liebler , 1951 ) , @xmath84 , where a distribution @xmath85 is used to approximate the true distribution @xmath86 .",
    "the kullback - liebler divergence using the simulation in figure [ fig : sparsity ] when compared to the true analytic solution is @xmath87 bits ( with the distributions normalised to integrate to unity ) , whereas the divergence from the true case to the diffusion case calculated analytically for @xmath80 is @xmath88 bits was chosen so that the divergence from the true case to the diffusion case was close to that of the true case to the numerical solution . ] .",
    "the divergence from the true solution to a simulation using a truncation threshold of @xmath89 ( not shown ) is almost the same as the more aggressively truncated example and is visually indistinguishable . as evident by comparing the numerical solution at @xmath79 in figure [ fig : sparsity ] to the initial condition , the discretization described in ",
    "[ sec : nummeth ] introduces a small numerical error in regions of high curvature .",
    "however , by comparing the numerical solution , for @xmath90 , @xmath91 and @xmath74 , to the exact solution , for @xmath92 , it is evident that the leading - order error of the numerical discretization is just a bit of additional diffusion , the level of which may be determined by a suitable minimisation process .",
    ", @xmath93 , and @xmath94 isosurfaces of the pdf in phase space at @xmath95 ( in the upper - right ) , @xmath96 , @xmath97 , @xmath98 , @xmath99 , and @xmath100 .",
    "the simulation was performed with a variable time step @xmath101 , a grid spacing of @xmath102 , and a threshold of @xmath103 .",
    "this simulation required less than 40 seconds of computation on a 2009 vintage apple laptop computer ( 2.4 ghz intel core 2 duo ) using a single - threaded c++ implementation of the present algorithm tracking about 50,000 active cells ( of @xmath104 total cells in the domain shown ) at @xmath100 .",
    "the modest memory requirements are proportional to the number of cells . , scaledwidth=45.0% ]",
    "but with measurements of @xmath105 ( vertical axis ) , with gaussian uncertainty , at every time step . the black line is the ` true ' state which generates the measurements .",
    "note that , by @xmath100 , the pdf splits into two concentrated regions .",
    "this simulation required about 4 seconds of computation with the same hardware , tracking about 4,000 active cells ( of @xmath104 total cells in the domain shown ) at @xmath100.,scaledwidth=45.0% ]    a bayesian approach is justified when the uncertainty of the estimate is significantly non - gaussian , such as in the estimation of a nonlinear system with relatively large uncertainty , leaving us with particle filtering or grid - based methods ; what is perhaps still uncertain is the numerical tractability of a grid - based approach when one exploits the sparsity of the pdf in the manner described in ",
    "[ sec : nummethsparse ] .",
    "thus , in order to test the efficiency of the gbees algorithm , as well as to demonstrate how it can capture with unprecedented accuracy the evolution of a non - gaussian pdf , we have applied the gbees algorithm to the estimation of the three - state lorenz system @xmath106 with @xmath107 , @xmath108 , and @xmath109 . for these parameter values , the system is chaotic , and the attractor takes the familiar form indicated by the green line in figure [ fig : transformation ] .",
    "also illustrated in this figure [ fig : transformation ] is the evolution of an initially ( at @xmath95 ) gaussian pdf @xmath0 , the evolution of which is governed by the kolmogorov equation , with no measurement updates applied and no added process noise ( diffusion ) .",
    "the distribution narrows significantly in the direction normal to the attractor , and spreads out rapidly in the direction of the maximum local lyapunov exponent along the attractor ; by @xmath100 , the pdf is highly non - gaussian .",
    "note also in the @xmath99 and @xmath100 isosurfaces the remarkable division of the pdf into two distinct lobes in the vicinity of the @xmath105 axis ( the vertical coordinate axis in the figures ) , which is invariant and unstable in the lorenz system .",
    "figure [ fig : measurements ] represents the evolution of the pdf when measurements ( with gaussian uncertainty ) of @xmath105 are taken at every time step .",
    "computationally , the problem addressed in the figure is significantly easier than the `` open - loop '' problem illustrated in figure [ fig : transformation ] , as the number of active cells by @xmath100 is reduced from 50,000 to only 4,000 ; the computation time for this simulation is also reduced accordingly , from 40 to 4 seconds for the time interval shown .",
    "the pdf at time @xmath100 splits into two concentrated regions on the left and right sides of the figure .",
    "future measurements might reveal in which region the state really is ; until such measurements are received , the gbees algorithm is perfectly capable of following both",
    ". a plain kalman filter , which assumes a central estimate , would necessarily fail to model such a splitting .",
    "a novel algorithm is introduced in this paper to exploit the remarkable sparsity of the evolving pdf in phase space , thereby , for the first time , making high - resolution grid - based bayesian estimation computationally tractable for nontrivial systems .",
    "the method generalises straightforwardly to any number dimensions , with computational cost expected to be a trade - off between the curse of dimensionality and the increased sparseness of the pdf . in application ,",
    "the algorithm developed is shown to track , with unprecedented fidelity , the completely non - gaussian pdf of the estimate of a lorenz system , both with and without measurement updates .",
    "the simulation exhibits a competition between information loss due to the random state disturbances and stretching of the pdf in the unstable directions of the system , and information gain from measurements .",
    "grid - based bayesian estimation algorithms are sometimes referred to as _ approximate _ grid - based methods .",
    "we point out that the numerical analysis of  [ sec : accuracy ] establishes that the numerical method used to propagate the kolmogorov equation in the present grid - based estimation algorithm is _ second - order accurate in both space and time _ ; this compares favorably to the ( _ slower than linear ) _",
    "@xmath110 convergence rate of particle methods applied to the kolmogorov equation ( see bernard , talay , & tubaro 1994 ) .",
    "finally , lagrangian ( that is , particle - based ) simulation techniques have been explored for decades in the field of fluid mechanics , but for @xmath111 remain mostly a research novelty . on the other hand , grid - based methods ( often with adaptive grids to focus the computational effort where it is needed ) have proven immensely successful in a variety of complex situations in fluid mechanics , such as in the characterization of fluid turbulence and in the design of commercial airliners , where computational methods have largely supplanted repetitive wind - tunnel testing .",
    "there appears to be no reason why the same success of grid - based methods will not also be realized in bayesian estimation approaches , once the community working on such problems fully appreciate how the remarkable sparsity of the pdf in such problems may be exploited ."
  ],
  "abstract_text": [
    "<S> bayesian estimation strategies represent the most fundamental formulation of the state estimation problem available , and apply readily to nonlinear systems with non - gaussian uncertainties . </S>",
    "<S> the present paper introduces a novel method for implementing grid - based bayesian estimation which largely sidesteps the severe computational expense that has prevented the widespread use of such methods . </S>",
    "<S> the method represents the evolution of the probability density function ( pdf ) in phase space , @xmath0 , discretized on a fixed cartesian grid over _ all _ of phase space , and consists of two main steps : ( i ) between measurement times , @xmath0 is evolved via numerical discretization of the kolmogorov forward equation , using a godunov method with second - order corner transport upwind correction and a total variation diminishing flux limiter ; ( ii ) at measurement times , @xmath0 is updated via bayes theorem . </S>",
    "<S> computational economy is achieved by exploiting the localised nature of @xmath0 . </S>",
    "<S> an ordered list of cells with non - negligible probability , as well as their immediate neighbours , is created and updated , and the pdf evolution is tracked _ only _ on these active cells .    </S>",
    "<S> nonlinear / non - gaussian observer design ; grid - based bayesian estimation </S>"
  ]
}