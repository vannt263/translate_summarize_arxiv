{
  "article_text": [
    "motion blur is one of the most commonly arising artifact types when taking photos . camera shaking and fast object motions",
    "degrade image quality to undesired blurry images .",
    "furthermore , various causes such as depth variation , occlusion in motion boundaries make blurs even more complex . single image deblurring problem is to estimate the unknown sharp image given a blurry image .",
    "earlier studies focused on removing blurs caused by simple translational or rotational camera motions .",
    "more recent works try to handle removing general non - uniform blurs caused by depth variation , camera shakes and object motions in dynamic environments .",
    "most of these approaches are based on following blur model  @xcite .",
    "@xmath0    where *",
    "b * , * s * and * n * are vectorizd blurry image , latent sharp image , and noise , respectively .",
    "* k * is a large sparse matrix whose rows each contain a local blur kernel acting on * s * to generate a blurry pixel . in practice , blur kernel is unknown .",
    "thus , blind deblurring methods try to estimate latent sharp image @xmath1 and blur kernel @xmath2 simultaneously , given a blurry image * b*.    finding blur kernel for every pixel is severely ill - posed problem .",
    "thus , some approaches tried to parametrize blur models with simple assumptions on the sources of blurs . in",
    "@xcite , they assumed that blur is caused by 3d camera motion only .",
    "however , in dynamic scenes , the kernel estimation is more challenging as there are multiple moving objects as well as camera motion .",
    "thus , kim et al .",
    "@xcite proposed a dynamic scene deblurring method that jointly segments and deblurs a non - uniformly blurred image , allowing the estimation of complex ( non - linear ) kernel within a segment .",
    "in addition , kim and lee  @xcite approximated the blur kernel as locally linear and proposed an approach that estimates both the latent image and the local linear motions jointly .",
    "however , these blur kernel approximations are still inaccurate , especially in the cases of abrupt motion discontinuities and occlusions .",
    "note that such erroneous kernel estimation directly affects to the quality of the latent image , resulting undesired ringing artifacts .",
    "recently , cnns ( convolutional neural networks ) have been applied in numerous computer vision problems and showed promising results including deblurring problem  @xcite . since no pairs of real blurry image and",
    "ground truth sharp image are available for supervised learning , they commonly used blurry images generated by convolving synthetic blur kernels . in  @xcite ,",
    "synthesized blur images with uniform blur kernel are used for training . and , in  @xcite , classification cnn is trained to estimate locally linear blur kernels .",
    "thus , still , cnn based models are only suitable for several specific types of blurs and have limits against more general spatially varying blurs .",
    "therefore , all the existing methods still have many problems before they could be generalized and used in practice .",
    "these are mainly due to the use of simple and unrealistic blur kernel models . thus , to solve those problems , in this work , we propose a novel end - to - end learning approach for dynamic scene deblurring .",
    "first , we propose a multi - scale cnn that directly restores latent images without assuming any restricted blur kernel model .",
    "unlike other approaches , our method does not estimate explicit blur kernels .",
    "accordingly , our method is free from artifacts that arise from kernel estimation errors .",
    "especially , the multi - scale architecture is designed to mimic conventional coarse - to - fine optimization methods .",
    "second , we train the proposed model with multi - scale loss that is appropriate for coarse - to - fine architecture , and enhances convergence greatly . in addition , we further improve the results by employing adversarial loss  @xcite .",
    "third , we propose a new realistic blurry image dataset with ground truth sharp images . to obtain kernel model - free dataset for training",
    ", we employ the dataset acquisition method introduced in  @xcite .",
    "as the blurring process can be modeled by the integration of sharp images during shutter time  @xcite , we captured a sequence of sharp frames of a dynamic scene with a high - speed camera , and averaged them to generate blurry image by considering gamma correction .    by training with the proposed dataset and adding proper augmentation",
    ", our model can handle general local blur kernel implicitly . as the loss term optimizes the result to resemble the ground truth",
    ", it even restores occluded regions where blur kernel is extremely complex as shown in fig .",
    "[ fig_intro ] .",
    "we trained our model with millions of pairs of image patches , and achieved significant improvements in dynamic scene deblurring .",
    "extensive experimental results demonstrate that the performance of the proposed method is far superior to those of the state - of - the - art dynamic scene deblurring methods in both qualitative and quantitative evaluations .",
    "there are several approaches that employed learning cnn for deblurring  @xcite .",
    "xu et al .",
    "@xcite proposed an image deconvolution cnn to deblur a blurry image in a non - blind setting .",
    "they built a network based on the separable kernel property that the ( inverse ) blur kernel can be decomposed into a small number of significant filters .",
    "additionally , they incorporated the denoising network  @xcite to reduce visual artifacts such as noise and color saturation by concatenating the module at the end of their proposed network .    on the other hand , schuler et al .",
    "@xcite proposed a blind deblurring method with cnn .",
    "the proposed network mimics conventional optimization - based deblurring methods and iterates the feature extraction , kernel estimation , and the latent image estimation steps in a coarse - to - fine manner . to obtain pairs of sharp and blurry images for network training",
    ", they generated uniform blur kernels using a gaussian process and synthesized lots of blurry images by convolving them to the sharp images collected from the imagenet dataset  @xcite .",
    "however , they reported performance limits for large blurs due to their suboptimal architecture .    similarly to the work of couzinie - devy et al .",
    "@xcite , sun et al .",
    "@xcite proposed a sequential deblurring approach .",
    "first , they generated pairs of blurry and sharp patches with 73 candidate blur kernels .",
    "next , they trained classification cnn to measure the local likelihood of a specific blur kernel of local patch .",
    "and then smoothly varying blur kernel is obtained by optimizing an energy model that is composed of the cnn likelihoods and smoothness priors .",
    "final latent image estimation is performed with conventional optimization method  @xcite .",
    "note that all these methods require an accurate kernel estimation step for restoring the latent sharp image .",
    "in contrast , our proposed system is learned to produce the latent image directly without estimating blur kernels .        in other computer vision tasks ,",
    "several forms of coarse - to - fine architecture or multi - scale architecture were applied  @xcite .",
    "however , not all multi - scale cnns are designed to produce optimal results similarly to  @xcite . in depth",
    "estimation , optical flow estimation , etc .",
    ", networks usually produce outputs having smaller resolution compared to input image resolution  @xcite .",
    "these methods have difficulties in handling long - range dependency even if multi - scale architecture is used .",
    "therefore , we make a multi - scale architecture that preserves fine - grained detail information as well as long - range dependency from coarser scales .",
    "furthermore , we make sure intermediate level networks help the final stage in an explicit way by training network with multi - scale losses .",
    "conventionally , it was essential to find blur kernel before estimating latent image .",
    "cnn based approaches are not exception  @xcite . however , estimating kernel involves several problems .",
    "first , assuming simple kernel convolution can not model several challenging cases such as occluded regions or depth variations .",
    "second , kernel estimation process is subtle and sensitive to noise and saturations , unless blur model is carefully designed .",
    "furthermore , incorrectly estimated kernels give rise to artifacts in latent images .",
    "third , finding spatially varying kernel for every pixel in dynamic scene requires huge amount of memory and computation .",
    "therefore , we adopt kernel - free methods in both blur dataset generation and latent image estimation . in blur image generation , we follow to approximate camera imaging process , rather than assuming specific motions , instead of finding or designing complex blur kernel .",
    "we capture successive sharp frames and integrate to simulate blurring process .",
    "the detailed procedure is described in section  [ sec : section_dataset ] .",
    "note that our dataset is composed of blurry and sharp image pairs only , and that the local kernel information is implicitly embedded in it . in fig .",
    "[ fig_blur_comp ] , our kernel - free blurry image is compared with a conventional synthesized image with uniform blur kernel .",
    "notably , the blur image generated by our method exhibits realistic and spatially varying blurs caused by the moving person and the static background , while the blur image synthesized by conventional method does not . for latent image estimation",
    ", we do not assume blur sources , and train the model solely on our blurry and sharp image pairs .",
    "thus , our proposed method does not suffer from kernel - related problems in deblurring .",
    "instead of modeling a kernel to convolve on a sharp image , we choose to record the sharp information to be integrated over time for blur image generation . as camera sensor receives light during exposure , sharp image stimulation at every time",
    "is accumulated , generating blurry image  @xcite .",
    "the integrated signal is then transformed into pixel value by nonlinear crf ( camera response function ) .",
    "thus , the process could be approximated by accumulating signals from high - speed video frames .",
    "blur accumulation process can be modeled as follows .",
    "@xmath3\\right ) ,          \\label{equ_blur_generation}\\ ] ]    where @xmath4 and @xmath5 denote the exposure time and the sensor signal of a sharp image at time @xmath6 , respectively .",
    "similarly , @xmath7 , @xmath8 $ ] are the number of sampled frames and the @xmath9-th sharp frame captured during the exposure time , respectively .",
    "@xmath10 is the crf that maps a sharp latent image @xmath5 into an observed image @xmath11 such that @xmath12 , or @xmath13 = g(s[i])$ ] in practice , we only have observed video frames while the original signal and the crf is unknown .",
    "it is known that non - uniform deblurring becomes significantly difficult when nonlinear crf is involved , and nonlinearity should be taken into account",
    ". however , currently , there are no crf estimation techniques available for an image with spatially varying blur  @xcite .",
    "when the ground truth crf is not given , a common practical method is to approximate crf as a gamma curve with @xmath14 as follows , since it is known as an aproximated average of known crfs  @xcite .",
    "@xmath15    thus , by correcting the gamma function , we obtain the sharp latent frame @xmath8 $ ] from the observed image @xmath13 $ ] by @xmath8 = g^{-1}(\\hat{s}[i])$ ] , and then synthesize the corresponding blur image @xmath16 by using ( [ equ_blur_generation ] ) .",
    "we used gopro4 hero black camera to generate our dataset .",
    "we took 240 fps videos with gopro camera and then averaged varying number ( 7 - 13 ) of successive latent frames to produce blurs of different strengths .",
    "for example , averaging 15 frames simulates a photo taken at 1/16 shutter speed , while corresponding sharp image shutter speed is 1/240 .",
    "notably , the sharp latent image corresponding to each blurry one is defined as the mid - frame among the sharp frames that are used to make the blurry image . finally , our dataset is composed of 3214 pairs of blurry and sharp images at 1280x720 resolution .",
    "the proposed gopro dataset is publicly available on our website  .",
    "in our model , finer scale image deblurring is aided by coarser scale features . to exploit coarse and middle level information while preserving fine level information at the same time , input and output to our network take form of gaussian pyramids .",
    "note that most other coarse - to - fine networks takes single input and single output .",
    "in addition to the multi - scale architecture , we employ slightly modified version of residual network structure  @xcite as a building block of our model .",
    "using residual network structure enables deeper architecture compared to a plain cnn .",
    "also , as blurry and sharp image pairs are similar in values , it is efficient to let parameters learn the difference only .",
    "we found that removing the rectified linear unit after the shortcut connection of the original residual building block boosts the convergence speed at training time .",
    "we denote the modified building block as resblock .",
    "the original and our modified building block is compared in fig .  [ fig_resblock ] .    by stacking enough number of convolution layers with resblocks , the receptive field at each scale",
    "is expanded .",
    "details are described in the following paragraphs . for sake of consistency , we define scale levels in the order of decreasing resolution ( i.e. level 1 for finest scale ) . unless denoted otherwise , we use total @xmath17 scales . at training time",
    ", we set the resolution of the input and output gaussian pyramid patches to be @xmath18 .",
    "the scale ratio between consecutive scales is 0.5 . for all convolution layers",
    ", we set the filter size to be @xmath19 .",
    "as our model is fully convolutional , at test time , the patch size may vary as the gpu memory allows . the overall architecture",
    "is shown in fig .",
    "[ fig_architecture ] .          at the front of the network locates the coarsest level network .",
    "the first convolution layer transforms 1/4 resolution , @xmath20 size input to 64 feature maps .",
    "then , 19 resblocks are stacked followed by last convolution layer that transforms the feature map into input dimension .",
    "every convolution layer preserves dimensions with zero padding . in total",
    ", there are 40 convolution layers .",
    "the number of convolution layer at each scale level is determined so that total model should have 120 convolution layers .",
    "thus , the coarsest - scale network has receptive field large enough to ` see ' the whole patch . at the end of the stage ,",
    "a coarsest level latent sharp image is generated .",
    "moreover , information from the coarsest level output is delivered to the next stage where finer scale network is . to convert a coarsest output to fit the input size of the next finer scale ,",
    "the output patch passes an upconvolution  @xcite layer , while other multi - scale methods uses reshaping  @xcite or upsampling  @xcite .",
    "since the sharp and blurry patches share low frequency information , learning suitable feature with upconvolution helps to remove redundancy . in our experiment , using upconvolution showed better performance than upsampling .",
    "then , the upconvolution feature is concatenated with the finer scale blurry patch as an input .",
    "finer level networks basically have the same structure as in the coarsest scale network .",
    "however , the first convolution layer takes sharp feature from previous stage as well as its own blurry input image , in a concatenated form . every convolution filter size is @xmath19 with the same number of feature maps as in the coarsest scale .",
    "except for the last finest scale , there is an upconvolution layer before the next stage . at the finest scale ,",
    "the original resolution sharp image is restored .",
    "our model is trained on the proposed gopro dataset . among 3214 pairs ,",
    "2103 pairs were used for training and remainings were used for the test . to prevent our network from overfitting ,",
    "several data augmentation techniques are involved . in terms of geometric transformations ,",
    "patches are flipped horizontally / vertically , rotated at random degrees .",
    "for color , rgb channels are randomly permuted . to take image degradations into account , saturation in hsv colorspace",
    "is multiplied by random number within @xmath21 $ ] .",
    "also , gaussian random noise is added to blurry images . to make our network be robust against different strengths of noise , standard deviation of noise",
    "is also randomly sampled from gaussian distribution , @xmath22 . finally , augmented image values are clipped in range of @xmath23 $ ] .",
    "basically , the coarse - to - fine approach desires that every mid - level outputs are the sharp images of the corresponding scales .",
    "thus , we train our network so that every intermediate latent images should form gaussian pyramid of sharp image .",
    "mse criterion is applied to every level of pyramids .",
    "hence , the loss function is defined as follows :      where @xmath25 denote the model output and ground truth image at scale level @xmath26 , respectively .",
    "the loss at each scale is normalized by the number of channels @xmath27 , width @xmath28 , and the height @xmath29 ( i.e. the total number of elements ) .",
    "recently , adversarial networks are reported to generate sharp realistic images  @xcite . following the architecture introduced in  @xcite",
    ", we build discriminator as in table  [ table_discriminator ] .",
    "discriminator takes the output of the finest scale or the ground truth sharp image as input and classifies whether it is network output or not .",
    "we provide qualitative results on the dataset of lai et al . @xcite .",
    "the lai et al .",
    "dataset is composed of synthetic and real blurry images , and we showed the deblurring result of a synthetically generated blurry image in section [ experiment_lai ] .",
    "we present the qualitative deblurring results of competing methods on real images in fig .",
    "[ lai_comp1 ] and [ lai_comp2 ] .              finally , we further present deblurring results on real dynamic scenes .",
    "the blurry scenes are captured by a sony rx100 m4 camera .",
    "the qualitative deblurring results of kim and lee  @xcite , sun et al .",
    "@xcite and ours are compared in fig .",
    "[ dynamic_comp1 ] and [ dynamic_comp2 ] ."
  ],
  "abstract_text": [
    "<S> non - uniform blind deblurring for general dynamic scenes is a challenging computer vision problem since blurs are caused by camera shake , scene depth as well as multiple object motions . to remove these complicated motion blurs , conventional energy optimization based methods rely on simple assumptions such that blur kernel is partially uniform or locally linear . </S>",
    "<S> moreover , recent machine learning based methods also depend on synthetic blur datasets generated under these assumptions . </S>",
    "<S> this makes conventional deblurring methods fail to remove blurs where blur kernel is difficult to approximate or parameterize ( e.g. object motion boundaries ) . in this work </S>",
    "<S> , we propose a multi - scale convolutional neural network that restores blurred images caused by various sources in an end - to - end manner . </S>",
    "<S> furthermore , we present multi - scale loss function that mimics conventional coarse - to - fine approaches . </S>",
    "<S> moreover , we propose a new large scale dataset that provides pairs of realistic blurry image and the corresponding ground truth sharp image that are obtained by a high - speed camera . with the proposed model trained on this dataset </S>",
    "<S> , we demonstrate empirically that our method achieves the state - of - the - art performance in dynamic scene deblurring not only qualitatively , but also quantitatively . </S>"
  ]
}