{
  "article_text": [
    "over a span of several years , from 1997 through 2003 , the wide field and planetary camera 2 ( wfpc2 ) on board the hubble space telescope ( hst ) carried out an archival parallel program under the auspices of the parallels working group chaired by jay frogel . the archival parallel program consisted of a large number of parallel images ,",
    "i.e. , images of the area in the sky towards which the camera was pointed while another instrument on hst was executing planned observations . such pointings are constrained to be random , in the sense that they are not expected to contain any special sources except by reason of proximity to the primary target which is 5 to 12 arcmin away depending on the instrument used .",
    "the program was designed to provide a set of observations that would provide a valuable data base for the hst archive with the potential to impact a range of scientific programs that the community at large could carry out .",
    "the parallel working group identified three areas of special interest : young stars and star forming regions in our galaxy and other nearby galaxies ; the stellar content of galaxies in the local universe ( including our own ) ; and large scale structure in the universe and the distribution and evolution of galaxies .",
    "for wfpc2 , the observations recommended by the parallels working group were implemented in three different programs : galactic , extragalactic , and special objects .",
    "the galactic and extragalactic programs were used for generic pointings , i.e. , those not in the special objects category ; galactic pointings are those at galactic latitude @xmath1 , extragalactic those at higher latitudes .",
    "special objects pointings are those that fall close to objects of interest ; the most common category for the wfpc2 parallels is that of pointings within a specified distance 10 arcmin , except for a few of very large galaxies such as m31 of galaxies less than about 3 mpc away .",
    "the parallel working group specified the observing strategy for each type of pointing .",
    "in general , observations were obtained in one or more of the four hubble deep field filters , f300w , f450w , f606w , and f814w , depending on the available time i.e. , the length of the primary observation ; other filters were used for some of the programs . in almost all cases ,",
    "the emphasis was on breadth of the survey , taking advantage of the expected large area coverage , rather than depth , which could not match that of dedicated observations .",
    "two features were common to all programs : exposures were always obtained in pairs for each filter , in order to facilitate data processing and especially rejection of cosmic rays ; and regardless of the program , the most sensitive filter , f606w , was always used first , although possibly for brief ( 300s ) exposures .",
    "thereafter , the observing strategy varied depending on the type of pointing . for extragalactic pointings ,",
    "most observations were obtained as part of the broad band survey , which aimed at obtaining multicolor data in the four hubble deep field filters for relatively bright ( @xmath2 mag ) , and therefore uncommon , galaxies .",
    "the four filters contribute depth ( f606w ) , uv morphology and u dropouts ( f300w ) , b morphology and dropouts ( f450w ) , and photometric redshift information ( f814w ) , and were generally obtained in that order of priority .",
    "a small fraction of observations were obtained in a special program targeting the medium - width filters f410 m and f467 m , which could identify star - forming galaxies at redshift 2.36 and 2.85 , respectively .    for galactic pointings , a selection of narrow - band filters ( f502n , f656n )",
    "was added to the extragalactic filters in order to study the properties of diffuse line emission in objects such as distant star - forming regions and planetary nebulae , which could expect to be observed relatively often in random fields at low galactic latitude .",
    "the special pointings in the vicinity of bright , nearby galaxies were chosen so that wfpc2 could resolve the stellar population into individual stars , thus permitting a study of their resolved stellar populations .",
    "for local group galaxies , the sensitivity achieved in a typical 1000 sec observation is sufficient to detect young stars in h-@xmath3 emission , and thus f656n was added to the complement of filters . in a few cases ,",
    "this has resulted in spectacular observations of diffuse line emission in the magellanic clouds . for galaxies beyond the local group ,",
    "the sensitivity is insufficient to take full advantage of f656n or of f300w , and thus only f606w , f450w , and f814w were used .    as of july 2002 ,",
    "the wfpc2 archival parallels had accumulated over 14,000 separate exposures with a total exposure time of 11.77 msec . of this , the primary broadband filters f300w , f450w , f606w , and f814w had exposure times of 2.39 , 1.42 , 6.67 and 0.65 msec respectively .",
    "the distribution of these observations over the sky is shown in figure  [ fig : skydistribution ] .",
    "however , the enormous scientific potential of the archival parallels has remained largely untapped .",
    "the primary reason is accessibility : the wfpc2 images are generally not available in a readily usable form .",
    "the wfpc2 images in the archive need reliable rejection of image artifacts such as cosmic rays and hot pixels ; the combination of co - aligned and non - coaligned exposures , and source catalog information .",
    "some of these services are available for a subset of wfpc2 observations from the wfpc2 associations effort .",
    "the archival pure parallels project ( hereafter appp ) is an ongoing hst archival legacy program that aims at processing , combining , and delivering a large fraction of the parallel images taken by the wfpc2 archival parallels program .",
    "the project will prioritize the available pointings on the basis of number of filters available , length of integration , and pointing characteristics . among the special classes of observations that will receive a high priority are fields in the magellanic clouds , which will permit a much wider study of star formation in different regions of the clouds ; fields close to known radio and x - ray sources about 40 sources in the first catalog fall into areas observed for the wfpc2 archival parallels fields that overlap with chandra and xmm observations ; and fields that have data in more than two filtersyogesh / appp/ ] .",
    "overall , the project will make available to the community a total of 2500 images in 1500 pointings , encompassing about 7000 separate exposures , or about half of the archival parallels images .",
    "about 600 images in 150 pointings have been released to date through the multimission archive at the space telescope ( mast ) ; the images can be obtained through the appp page at the mast .",
    "we expect that about 3 years ( fte ) of labor will be expended for the completion of this project .",
    "the appp is in many ways complementary to the wfpc2 associations effort ( micol et al .",
    "its scope is more limited , since it specializes to images taken as part of the archival pure parallels programs , while the wfpc2 associations project extends to all wfpc2 images . on the other hand ,",
    "the appp images are in a single frame , while those produced by the wfpc2 associations effort are separated by chip ; the appp images are corrected for geometric distortion ; and the appp combines images taken as part of different visits , even when taken at different orientations . for regions of the sky observed repeatedly , this approach results in deeper delivered images that can also cover seamlessly a larger area of the sky ; cross - registration between filters also allows source colors to be measured directly even for non - point sources .",
    "a more detailed comparison of the final products of the wfpc2 associations and the appp is presented in section  4 .    in this paper",
    "we describe in detail the methodology and procedures used to produce the combined images that have been released and that will be used for all upcoming images . in section  2 , we describe the techniques that we have developed for accurate image registration , background equalization and cosmic ray rejection . in section  3",
    ", we explain the data processing steps in procedural form .",
    "section  4 summarizes the quality control procedures that we use , before the data is publicly released .",
    "the aim of the data processing pipeline is to produce astrometrically registered , drizzled images with background equalization and reliable rejection of artifacts such as cosmic rays and hot pixels , for all of the four wfpc2 chips .",
    "our techniques have been optimized to exploit the strengths of the wfpc2 instrument while simultaneously trying to mitigate its deficiencies .",
    "it is known from from science data of rich stellar fields as well as from kelsall spot data that the four wfpc2 detectors move with respect to each other over time , presumably as a consequence of physical changes in the wfpc2 optical bench .",
    "casertano & wiggs ( 2001 ) used the positions of 43 kelsall spots in 173 images taken throughout the life of wfpc2 , approximately one every two weeks .",
    "they found that the shift in relative positions of the spots ( and therefore the chips ) with time could be effective modeled using a fourth degree polynomial .",
    "we use the coefficients for the fourth degree polynomial from casertano & wiggs ( 2001 ) to determine the relative position of the chips as the time of observation .",
    "the nominal world coordinate system ( wcs ) values for the wfpc2 are subject to small errors of typically 0.1 arcsec or smaller . in a few instances , where different guide stars are used to obtain wcs",
    "coordinates for two overlapping images , the relative errors in position may be as high as 2 - 3 arcsec .",
    "we have developed a procedure to correct for these astrometric errors that is described below .",
    "the image registration is best performed using individual images wherein all four chips have been drizzled to the output frame .",
    "we first construct a sequence of images such that each successive image in the sequence has the maximum possible overlap with one or more of the preceding images in the sequence .",
    "thus if there are @xmath4 datasets , a set of @xmath5 pairs with optimal overlap are determined .",
    "relative shifts and rotations between images are determined pairwise and then propagated as described below .",
    "the motivation for choosing a maximum overlap sequence is to maximize the number of matched sources during image registration .",
    "we have developed and tested two distinct approaches to image registration :    approach 1 : we first determine the centroid position for all sources in the reference image and the image to be shifted using sextractor ( bertin & arnouts 1996 ) . during source extraction ,",
    "it is critical to use the output weight data from drizzle as the weight_image in sextractor , to reduce the number of spurious source detections .",
    "we then filter the source lists to exclude sources with possibly incorrect positions ( e.g. saturated sources ) and pass the source centroid positions to a triangle matching program that attempts to find matching sources in the reference and shifted images .",
    "this algorithm uses the principle that similarity properties of triangles hold for any transformation that involves a shift and/or a rotation .",
    "once a matched source list is obtained , this list is passed to the iraf _ geomap _ program with fitgeometry = rotate , which determines the relative shift and offset between the two images .",
    "this approach works well when the number of real sources detected in the image is comparable to ( or exceeds ) the number of cosmic rays .",
    "such a situation exists only for the minority of low galactic latitude and magellanic cloud pointings in our data .",
    "pointings , where there are few real sources and many more cosmic rays , are predominant . in such situations ,",
    "the triangle matching method fails to find a sufficient number of matched triangles and sources for nearly 50% of pointing / filter combinations .",
    "we therefore explored an alternative approach to image registration .",
    "approach 2 : centroid positions for sources in the reference and the shifted image are obtained and filtered as in approach 1 . for each source in the reference image , we search for sources that lie within 25 pixels ( 2.5 arcsec ) in the shifted image .",
    "these sources are plotted as deviations in @xmath6 and @xmath7 coordinates with respect to the source in the reference image .",
    "a sample deviation plot is shown in figure  [ fig : deviations ] .",
    "we expect that the distribution of real sources in this deviation plot will cluster , while the cosmic rays will tend to be distributed randomly .",
    "an inherent assumption in using this approach , is that relative rotations between images are small .",
    "this is a valid assumption because the orientation angle of the telescope ( orient ) is known to a precision of 0.1 degrees or better .",
    "note that we still fit for a shift and a rotation , although the rotation is quite small .",
    "we construct a 2-d histogram of deviations with a binsize of 1x1 pixel and find the peak .",
    "if no unique peak exists , or there are too few points in the peak , we increase the binsize to 2x2 pixels ( and 3x3 pixels if required ) .",
    "we find that over 95% image registrations are successfully obtained with a binsize of 1x1 pixel .",
    "once the appropriate peak is identified , all sources with deviations lying within the peak are designated matched sources and supplied to _",
    "again with fitgeometry = rotate .",
    "_ geomap _ is set to reject outliers in its fit , with maxiter=5 and reject=2.0 .",
    "this approach is successful in registering @xmath8% images in f450w or redder broadband filters , and about 75% of images in the f300w filter .",
    "the somewhat lower success rate in registering images in the f300w filter is primarily due to the dramatically lower throughput of wpfc2 in this filter , relative to redder filters .",
    "overall , there is a dramatic increase in registration success rate as compared to the triangle matching approach .",
    "we therefore settled on using this image registration approach in our pipeline .",
    "the image registration is then repeated pairwise e.g. given a set of say 4 images , the two images with the highest overlap , say images a and b are identified and image b is registered relative to image a. then , amongst the remaining 2 images the image with the highest overlap with either a or b is chosen e.g. we may find that image d has the highest overlap with image a. then image d is registered to image a. the remaining image c is registered to one of images a , b , d with which it has the highest overlap .",
    "pairwise shifts and rotations obtained from _",
    "geomap _ are adjusted such that they are relative to the one image that does not undergo a shift or rotation ( image a in our example ) .",
    "these shifts and rotations are transformed to a corresponding change in the wcs of the 4 chips . in the above example",
    ", all chips of all images except those of image a , would receive revised wcs values .      the observed sky background at a particular location on the sky can change due to light scattered into the aperture from the bright earth limb . due to this phenomenon",
    ", two images of the same part of the sky taken at different times may have different values of the sky background .",
    "it is important to correct for such differences to ensure a uniform sky in the drizzled output image and to accurately reject cosmic rays .",
    "we correct for relative offsets between sky values by matching the sky pairwise in the maximum overlap sequence as obtained above .",
    "the sky offsets between images is the median of the difference between valid pixels in the two images in the region of overlap .",
    "sky offsets are determined relative to the overall reference image ( image a in our example ) and corrected for .",
    "we illustrate the background equalization process in figure  [ fig : backequal ] .",
    "we plot the counts in a particular row of a reference image ( black solid line ) and the counts in the same row of the comparison image ( dashed line ) that has a higher value of the sky background .",
    "the higher average counts at lower column values is due to extended nebular emission in that part of the image .",
    "after the sky background offset has been corrected for , the counts in the comparison image substantially match those in the reference image ( red solid line ) .",
    "the figure only illustrates this process for one row of binned data , but in the pipeline , this procedure is carried out using all pixels in the region of overlap .",
    "note that only relative sky offsets are corrected by our procedure .",
    "no attempt is made at subtracting the sky background from the reference image .",
    "drizzle is a method for the linear reconstruction of an image from undersampled , dithered data ( fruchter & hook 2002 ) . the algorithm , known as variable - pixel linear reconstruction , or informally as `` drizzle , '' preserves photometry and resolution , can weight input images according to the statistical significance of each pixel , and removes the effects of geometric distortion on both image shape and photometry .",
    "in addition it provides a method for robust cosmic ray rejection .",
    "drizzle was first used in the analysis of the hubble deep field north data ( williams et .",
    "al 1996 ) .",
    "it has since been included as a part of the stsdas software package .",
    "drizzle takes the input data and transfers each pixel to the output frame .",
    "this typically involves a shift ( in x and y direction ) , a rotation and a scaling .",
    "in addition , each input data pixel may be shrunk before it is drizzled . during drizzling ,",
    "the user needs to specify the shifts , rotations and scaling needed to go from the input frame to the output frame .",
    "a version of drizzle that simplifies this process by working directly with wcs parameters has recently been developed .",
    "this code is called _ wdrizzle_. while using _ wdrizzle _ , the user needs to only specify the wcs keywords of the input frame ( available in the image header ) and the wcs keywords of the output frame .",
    "we ran _ wdrizzle _ on all 4 chips of each input dataset to its own output image ( as determined by the output wcs ) and weighted by the inverse variance map .",
    "a scale and pixfrac value of 1.0 was used throughout , along with a square kernel .",
    "kozhurina - platais et al .",
    "( 2003 ) used the inner calibration field of @xmath9 cen exposed through filters f300w , f555w and f814w to determine the geometric distortion of wfpc2 as a function of wavelength .",
    "they incorporated the improved psf - fitting technique of anderson and king ( 2002 ) to fit a bicubic polynomial model to derive geometric distortion coefficients in the f300w and f814w filters relative to the distortion - free coordinates in the f555w filter .",
    "we supply these distortion coefficients to _",
    "wdrizzle_. if coefficients are unavailable for a particular filter , those from the nearest available filter are used .",
    "we adopt the procedure proposed by fruchter & hook ( 2002 ) for cosmic ray rejection .",
    "we construct the median image by performing the median operation on the sky offset corrected images .",
    "the medianmask allows us to exclude invalid pixels from the median image .",
    "the median image is relatively free of cosmic rays .",
    "we back propagate the median image to the input frame of each chip of each of the individual input images , taking into account the image shifts / rotation and geometric distortion .",
    "this is done by interpolating the values of the median image using a program called _ wblot _ ( which is a wcs aware version of the _ blot _ program in the dither package ) .",
    "we take the spatial derivative of each of the blotted images .",
    "the derivative image is useful for estimating the extent to which errors in the computed image shift or the blurring effect of the median operation , have modified the counts in the blotted image .",
    "we compare counts in each original image with those in the corresponding blotted image . if the difference is larger than that expected by a combination of the expected noise , the blurring effect of taking the median , or an error in the shift , the pixel is flagged as cosmic - ray affected .",
    "we repeat this step on pixels adjacent to pixels already flagged , using a more stringent comparison criterion .",
    "all the techniques described above were implemented as a fully automated data reduction pipeline which can be applied to the calibrated data obtained from the stsci archive .",
    "the pipeline consists of two segments : a database management unit , developed in python , which identifies datasets that are proximate on the sky and arranges the appropriate data location and a data processing unit , written primarily in idl , which performs the data alignment and combination .",
    "the latter uses callable versions of the _ wdrizzle _ and _ wblot _ programs , identical in function to the stsdas versions .",
    "most of the pipeline processing is straightforward and sequential ; however , as described above in section  [ sect : alignment ] , the image registration step is fragile , and can fail for a variety of reasons ( poor initial positions , lack of sources , insufficient exposure time , insufficient image overlap ) .",
    "automatic checks verify whether registration was successful ; if not , the affected images  in some cases a full pointing / filter combination  are excluded from further processing . with current procedures ,",
    "about 10% of all images fail the automatic registration check .",
    "the majority of registration failures are in the f300w filter .",
    "an additional 5% fail the subsequent manual quality check ( see section  4 ) .",
    "there are no failures in any of the other steps .",
    "while future changes in our procedures could slightly improve our success rate , our experience to date suggests that a fully automated alignment procedure is unlikely to work under all possible circumstances .",
    "we now proceed to describe the individual steps taken as part of the image processing pipeline .",
    "the first step in the processing is the definition of the relevant pointings and of the images associated with each .",
    "we started by extracting from the mast archive the data files associated with all images obtained as part of the archival pure parallels , including both the data files ( suffix _ c0f.fits ) and the data quality files ( suffix _ c1f.fits ) .",
    "we also obtained all the flat field files used in processing these images .",
    "all images were retrieved from mast during a brief period in july 2003 .",
    "this ensured that the on - the - fly reprocessing ( otfr ) performed automatically by the mast archive was identical for all datasets .",
    "after retrieving all images , we extracted all header parameters , including both primary and group parameters , and captured them into a relational database using mysql .",
    "the datasets were then partitioned into groups using a simple proximity relation .",
    "first , two datasets are related if their reference point , the position of the wfall reference point on the sky , is less than @xmath10 apart .",
    "second , two datasets related to a third are considered related . this proximity relation is symmetric and transitive , and therefore it is an equivalence relation  thus defining a partition in the set of all images under consideration .",
    "each of these equivalence groups is called a _",
    "pointing_. in practical terms , pointings are defined by starting with datasets less than @xmath10 apart , and then extending the rule by the friend - of - friends algorithm i.e a dataset belongs to a pointing if and only if it is less that @xmath10 apart from at least one other dataset in that pointing .    for the purpose of pointing definition , all datasets are considered together , regardless of the filter used or the length of exposure .",
    "this could result in some anomalies , where combined images in each filters are disjoined , non - overlapping , or could contain only one dataset .",
    "we find that such anomalies are exceedingly rare , and thus the definition of pointing we adopt is useful .",
    "each pointing is assigned a unique 9-character i d based on the name of the dataset in that pointing with the earliest observation date .    with our criteria , the 14965 datasets in our database",
    "are grouped into 2460 pointings , with an average of about 6 datasets per pointing .",
    "the largest pointing contains 161 datasets and spans a diameter of 12 arcmin on the sky .    of these , 2305 pointings have at least one filter with two or more datasets each longer than 100s in that filter .",
    "all these pointings may be processed by our pipeline .",
    "however , we are prioritizing the processing based on the science drivers , total exposure time and the number of filters available .",
    "a total of 573 images in 149 pointings have already been released to the mast archive .",
    "we anticipate that a total of about 2500 images in 1500 pointings will be released before the completion of this project .",
    "once a pointing is chosen for pipeline processing , several steps need to be undertaken in order to simplify the processing itself and to obtain uniform output products .",
    "these steps consist of collecting together the relevant data , defining the output images , and preprocessing the data to the extent needed .",
    "we have developed a number of python scripts to carry out these steps automatically and efficiently .",
    "data collection is directory - based .",
    "each pointing is assigned a directory , with a separate subdirectory for each filter .",
    "the subdirectory contains the relevant science , data quality , and inverse flat field images in iraf group format ( suffixes c0h , c1h , and r4h respectively ) .    in each subdirectory ,",
    "subsets of images which are nominally coaligned ( shifts of less than @xmath11 in roll angle and @xmath12 in position ) are considered suitable for cr - rejection , which is then performed using the standard stsdas _",
    "crrej _ task . using the coaligned cosmic ray rejection",
    "reduces significantly the number of images that fail the alignment step , and therefore increases significantly the quality of the resulting combined images .",
    "finally , the output image needs to be defined .",
    "the output image is rectangular , with pixel size equal to the average pixel size in chip 3 , and is oriented with north up and east to the left .",
    "the output image for each filter is large enough to accommodate all of the input images , with sufficient margin to account for possible alignment refinements ( see section  [ sect : alignment ] ) .",
    "output image sizes range from 1600 to 7200 pixels on a side .",
    "the main steps of the stage 1 pipeline are summarized as a data flow diagram in figure  [ fig : pipeline ] .",
    "the stage 1 pipeline includes three separate drizzle operations and one inverse drizzle operation ( blot ) .",
    "the various steps of the procedure are described below .",
    "bad pixels in an image are those that satisfy at least one of the following conditions :    1 .   have been flagged as bad in the data quality files .",
    "these include transmission and other failures , blocked columns , saturated pixels and bad pixels listed in calibration reference files .",
    "2 .   lie within 30 pixels of the inner edges for the wfc chips and within 50 pixels of the edge for the pc chip 3 .",
    "exhibit a inverse flatfield value higher than 1.7 , indicating that nearly half of the total flux is lost because of proximity to the pyramid edge 4 .",
    "are adjacent to a pixel marked as saturated in the data quality file    for such bad pixels , we set the weight to zero .",
    "for the remaining pixels , the weight is computed as the inverse of the variance , according to the method of casertano et al .",
    "this computation of the variance takes into account contributions to the noise from the sky background , dark current , read noise and flatfield .",
    "contributions to shot noise from sources are not included .",
    "these weight images are used as the input weights for drizzle .      for each input image",
    ", a separate four - chip mosaic is generated using the drizzle algorithm on an image that has the same frame as the predefined output image . at this stage",
    ", the image position and orientation is defined using the header values for chip 2 ; the positions of the other three chips are adjusted according to the time - dependent chip separation correction described in section  [ sect : alignment ] .",
    "each image thus retains the imperfections ( cosmic rays , interchip gaps , etc . ) of the input images , and",
    "the registration between the images is based solely on the header parameters .      in order to improve the registration between images taken in the same filter ,",
    "sources are identified using sextractor in the single mosaiced images obtained form each dataset , using the weights obtained in the first pass combination .",
    "the algorithms described in section  [ sect : alignment ] are then used to determine relative shifts and rotations needed to optimize the relative registration among images taken in the same filter .",
    "the alignment quality is assessed using the r.m.s .",
    "scatter of the position residuals after outlier rejection .",
    "we show in figures  5 and 6 , typical vector plots of residual offsets between the reference image and a second image whose coordinates have been transformed using the best - fit transformation provided by _",
    "geomap_. the residuals are random and small .",
    "there are no systematic chip - to - chip variations which would indicate an error in the relative positioning of the 4 chips .",
    "there are no systematic variations within each chip either which would indicate errors in the distortion correction . for images that have a large number of sources such as those shown in the figures the r.m.s . of the residual offset",
    "is typically 10 milliarcsec or smaller in each coordinate .",
    "the improved alignment information is propagated back to the input images , and their wcs parameters are updated accordingly . the shift and rotation required for each image and the r.m.s . of the residuals",
    "are recorded in the log file .",
    "once the images have been correctly registered to each other , the images are drizzled through for the second time , again with all 4 chips of a dataset drizzled to the output frame . the sky level in each image",
    "is adjusted to ensure that the relative backgrounds match , using the sky background equalization technique described in section  [ sect : backequal ] .",
    "the goal of this step is not to zero out the sky , which would lead to incorrect results whenever diffuse emission is present , but simply to remove time - dependent background variations which can adversely affect the quality of the combined images .",
    "an overall sky background consistent with one of the input images is retained . as a result ,",
    "all images produced by our pipeline include a contribution from the sky background as observed .",
    "the single , aligned , sky - equalized images obtained as a result of the second drizzle pass are median - combined to remove the impact of cosmic rays .",
    "the median combined image is blotted back to each input image , generating a reference image for each detector . this reference image and the original image data",
    "are compared , taking into account the possibility of a net offset due to sky equalization .",
    "cosmic rays are identified as described in section  [ sect : crrej ] , and the corresponding pixels recorded in the cosmic ray masks .",
    "once the cosmic ray rejection is complete , the third pass drizzle pass is performed , using the same inputs as in the second pass , but with the input weights modified to zero the weight of pixels identified as cosmic rays . unlike the previous drizzle passes , all input images for each filter are now drizzled onto a common output image .",
    "this image , which is a weighted combination of all data for the relevant filter , is written to disk with a header that records the basic information of the images that have been included in the combination . besides the combined ( science ) image and the corresponding weight image , the input weight file to the third drizzle pass",
    "is also recorded ; this file will be needed as input for the stage 2 pipeline .",
    "the updated wcs values for each input image , after image registration , are written as a fits extension table of the science image .",
    "in addition , many intermediate files  such as the median combined image , the blotted medians , and the cosmic ray flags  can be written to disk if the debug flag is set .      once all filters in a particular pointing have been processed through the stage 1 pipeline , a science image and weight image for each filter",
    "are obtained .",
    "however , these images may not be properly aligned across filters , since the registration process is carried out independently for each filter .",
    "cross - filter registration is performed by the stage 2 pipeline .      in the current pipeline implementation",
    ", we treat the f606w science image to be the reference image for registration across filters .",
    "all final science images are registered to the f606w image using the technique described in section  [ sect : alignment ] .",
    "we determine a list of sources for each filter using sextractor with the weight file from the stage 1 pipeline , determine the relative shifts and rotations needed to align each filter with the f606w image , and propagate these shifts and rotations back to the original images , updating the wcs information separately for each chip .",
    "note that absolute astrometry of the resulting image will still suffer from any inaccuracies present in the original images , which are derived from guide star position information through the knowledge of the hst focal plane solution at that time . in principle",
    ", the absolute astrometry could be improved by matching sources in our images with those listed in the the guide star catalog ii ; this step has not been implemented yet .      when all image headers have been updated , the final _ wdrizzle _ pass is performed for all filters except f606w , using the updated alignment information .",
    "a new drizzle pass is preferable to shifting the previously obtained image because it introduces less image degradation and noise correlation ; since the final pass adopts the weight information previously determined , including the identification of cosmic ray events , it can be carried out efficiently with a modest impact on computing resources .",
    "the images resulting from this final pass , together with updated header information and a table extension containing the updated wcs parameters for all input images , are the versions that are made available to the community through the mast site ( see section  [ subsect : delivery ] ) .",
    "each image went through an extensive set of automated and human eye based checks before delivery to the archive .",
    "automated checks included numerous flags for poor astrometric registrations ( too few sources , extremely large image shifts , high r.m.s .",
    "residuals after _ geomap _ transformations etc . ) , anomalous background offsets and over - rejection of cosmic rays .",
    "these automated checks were supplemented by human checks . a typical quality control process for a pointing would include the following human check procedure :    1 .",
    "display the final science images in each filter .",
    "verify that each science images is of acceptable quality .",
    "any image anomalies such as bias jump , ota earth reflection pattern , pc1 stray light patterns etc .",
    "( biretta , ritchie & rudloff 1995 ) seen in the science image are noted in a log file .",
    "2 .   register and blink through the final science images in each filter to verify accurate cross - filter registration .",
    "3 .   display each weight image and examine for data quality .",
    "issues to look for : excessive coincidence between bright sources and low weight ( may indicate rejection of source cores ) ; large areas of low weight not coinciding with image overlap ( may indicate background problems , such as earth cross pattern ) ; excessively high or low values ; gridding ( should not occur with pixfrac=1 ) .",
    "4 .   if the science or weight images show some anomaly : e.g. incorrect cr rejection , poor registration etc . ,",
    "look at the skycube image to diagnose the problem . diagnosis or suspicion is noted in the log file for subsequent analysis .",
    "examine the log files for the registration process to confirm that all images in the alignment sequence were registered with low r.m.s residuals in the _ geomap _ alignment process .",
    "we re - examine images that fail the quality control processes .",
    "if the issue is fixable with reprocessing , this is done . for approximately 5% of the final images ,",
    "quality issues remain unresolved ; these images are not delivered to the archive .",
    "the most common cause of failure in quality control is when most ( all ) datasets contributing to the final drizzled image show the earth cross pattern .",
    "a significant contributor to the remaining uncertainty in astrometric registration is the random error in source centroid positions computed by sextractor .",
    "the most recent version of that software ( version 2.4.3 ) claims to greatly reduce such errors by allowing for centroid computation using a window function .",
    "the sextractor documentation claims that the accuracy offered by the window function based computation is comparable to that obtained from psf fitting software .",
    "we are currently in the process of testing the new version of sextractor and its centroiding algorithm .",
    "if found appropriate , we will use to it to replace the version of the software currently in use in our image registration procedure .",
    "we tested a small number of images produced by our pipeline for photometric accuracy .",
    "our test consisted of comparing the instrumental magnitudes of objects in the combined image with individual images that contributed to it .",
    "the source detection and measurement parameters in sextractor were mostly set to default values , e.g. , 3-sigma thresholds for detection .",
    "varying these parameters somewhat did not change the basic result of the test .",
    "we used sextractor in dual image mode for the photometry .",
    "we detected objects in the combined image and aperture magnitudes were measured in the combined image and in each of the individual images obtained after the second drizzle operation .",
    "we show in figure  [ fig : phototest ] the plot of the difference in aperture magnitude as measured on the combined image and a clipped mean of the individual frames , as a function of aperture magnitude in the combined image .",
    "a circular aperture with radius of 4 pixels was used .",
    "the relative brightness of some objects in the individual images is almost certainly due to cosmic ray contamination , since the combined images are largely free of cosmic rays while the individual images are not .",
    "for all the images we tested , we found no systematic offsets in photometry between the combined and individual images that would indicate a problem in our procedure .",
    "we believe the combined images are photometrically accurate and suitable for scientific analysis .",
    "however , it should be noted that we have tested only a very small fraction of the hundreds of images that we have produced .",
    "photometric errors in untested images may be present and may indicate problems with our procedure ; users discovering any such errors are urged to contact us .      the canadian astronomy data center ( cadc ) , the space telescope european coordination facility ( st - ecf ) and the multimission archive at stsci ( mast ) have made available a large number of combined wfpc2 images .",
    "these combined images are the products of the basic registration and averaging of related sets of wfpc2 images , referred to as associations . as of november 2002 , over",
    "15,000 combined images had been created from associations of nearly 50,000 individual wfpc2 images .",
    "the wfpc2 associations are a much stricter grouping of datasets compared to the _ pointings _ in our project .",
    "two ( or more ) exposures in a given filter are grouped into an association if they belong to the same program ( same proposal",
    "i d ) , their sky projected distance is not greater than 10 arcsec ( 100 wf4 pixels ) and their position angle does not differ by more than 0.03 degrees",
    ". the appp places no restrictions on proposal i d and position angle .",
    "the separation in sky projected distance needs to be less than 80 arcsec for the appp . with our considerably looser criteria for",
    "grouping images , in general , more datasets are grouped together in a pointing .",
    "this implies a higher s / n in the final image . also , by our definition , any position on the sky produces only a single image in each filter . for the wfpc2 associations , that is not necessarily true .",
    "there are also significant differences in the data processing approach taken by the two teams .",
    "the processing for the wfpc2 associations does not include drizzling of the images or accounting for shifts in chip positions with time .",
    "they also do not include distortion corrections .",
    "their procedures for image registration and cosmic - ray rejection are also different . with our more ambitious approach , there are more avenues for failure during the image combination process . to compensate for this ,",
    "we have included human eye checks as an integral part of our quality control procedures .    given the differences in grouping datasets together and the data processing procedures between the two projects , a comparison of the final images produced by the two projects is not straightforward .",
    "nevertheless , we have tried to compare our images with those from the wfpc2 associations for a few representative pointings .",
    "we find that both the images have s / n that is consistent with the detector and sky background characteristics and the effective exposure time .    comparing the psf s of starlike sources , we find that the fwhm of sources in our images is not systematically different from the corresponding sources in the wfpc2 associations .",
    "this is particularly encouraging , because in principle our psf may be broadened relative to the wfpc2 associations by a combination of factors : resampling during drizzling , errors in interchip registration , and in source - centroiding in our image registration procedure .",
    "we deliver final science images , weight images and a log file containing a brief summary of the properties of the images being drizzled and their registration , as high level science products ( hlsp ) to the mast science archive .",
    "in addition , we also provide a feature rich , web based , front end to the data for easy browsing .",
    "this includes a dss image of an 18x18 arcmin area centered on the pointing , a three color composite wfpc2 image made using f450w",
    "/ f606w / f814w data in the blue / green / red channels respectively , header information for each image and a preview image in each filter . for each pointing",
    ", we also provide a coverage map in the 4 principal broadband filters .",
    "we provide a link for each pointing to the nasa extragalactic database ( ned ) which searches it for objects within 10 arcmin of the pointing center .",
    "no source catalogs have been released yet , although we aim to add them in future .",
    "delivered data are grouped together by the science questions that they are useful in addressing .",
    "metadata from our delivered images have been incorporated into the mast database and is searchable through the the mast search interface .",
    "image header keywords ( and other metadata ) will be updated on an ongoing basis to make the data more accessible through the virtual observatory .",
    "any modifications to the procedures described in this paper , will be fully documented in the readme files accompanying data released through the mast archive .",
    "we are grateful to the anonymous referee whose insightful comments greatly improved this paper .",
    "support for program ar 9540 was provided by nasa through a grant from the space telescope science institute , which is operated by the association of universities for research in astronomy , inc .",
    ", under nasa contract nas 5 - 26555 .",
    "anderson , j. , & king , i.  r.  2003 , , 115 , 113 bertin , e. , & arnouts , s.  1996 , , 117 , 393 biretta , j. , ritchie , c. , & rudloff , k.  1995 , a field guide to wfpc2 image anomalies ( wfpc2 instrum .",
    "sci . rep .",
    "1995 - 06 ) ( baltimore : stsci ) casertano , s. , et al .",
    "2000 , , 120 , 2747 casertano , s. , & wiggs , m. s.  2001 , an improved geometric solution for wfpc2 ( wfpc2 instrum .",
    "sci . rep .",
    "2001 - 10 ) ( baltimore : stsci ) fruchter , a.  s. , & hook , r.  n.  2002 , , 114 , 144 kozhurina - platais , v , anderson , j , & koekemoer , a. m.   2003 , toward a multi - wavelength geometric distortion solution for wfpc2 ( wfpc2 instrum .",
    "2003 - 02 ) ( baltimore : stsci ) micol , a. , et al .",
    "2000 , asp conf .",
    "216 : astronomical data analysis software and systems ix , 216 , 223 williams , r.  e. , et al .",
    "1996 , , 112 , 1335"
  ],
  "abstract_text": [
    "<S> we describe the methods and procedures developed to obtain a near - automatic combination of wfpc2 images obtained as part of the wfpc2 archival pure parallels program . </S>",
    "<S> several techniques have been developed or refined to ensure proper alignment , registration , and combination of overlapping images that can be obtained at different times and with different orientations . </S>",
    "<S> we quantify the success rate and the accuracy of the registration of images of different types , and we develop techniques suitable to equalize the sky background without unduly affecting extended emission . </S>",
    "<S> about 600 combined images of the 1,500 eventually planned have already been publicly released through the stsci archive . </S>",
    "<S> the images released to date are especially suited to study star formation in the magellanic clouds , the stellar population in the halo of nearby galaxies , and the properties of star - forming galaxies at @xmath0 . </S>"
  ]
}