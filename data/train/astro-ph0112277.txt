{
  "article_text": [
    "the cosmic microwave background ( cmb ) represents the single most powerful probe of the early universe available to modern astronomy .",
    "the pioneering results of the _ cosmic background explorer _ ( _ cobe _ ; smoot et al .",
    "1992 ) are being extended by the current generation of ground - based and balloon - borne experiments ( e.g.  scott et al .",
    "1996 ; tanaka et al .  1996 ; netterfield et al .",
    "1997 ; de oliveira - costa et al .",
    "1998 ; coble et al .  1999 ; de bernardis et al .",
    "2000 ; hanany et al .",
    "2000 ; wilson et al .",
    "2000 ; padin et al .  2001 ) , but it is the upcoming satellite experiments that are set to revolutionise the field . by the end of 2002 the _ _ microwave anisotropy probe _ _ ( _ map _ ) will have observed the entire sky with a resolution of @xmath0 and _ _ planck _ _ , scheduled for launch in 2007 , should have the capacity to produce high sensitivity , all - sky maps to a resolution of @xmath1 01 in four of its ten frequency channels .",
    "however , it is not sufficient merely to obtain such extraordinary measurements ; careful analysis of the data - sets is critical if these missions are to fulfill their promised scientific goals .",
    "most present techniques for cmb data analysis employ pixelised maps of the sky . both bond et al .   and borrill   describe methods to create maximum - likelihood maps from time - ordered data and telescope pointing information , and these techniques have been successfully applied in the analysis of the boomerang  @xcite and maxima  @xcite observations . from the maps and their uncertainties ,",
    "the power spectrum of the microwave sky can be estimated in a number of different ways ( bond , jaffe & knox 1998 ; borrill 1999 ; oh , spergel & hinshaw 1999 ; wandelt , hivon & grski 2001 ) , again employing maximum - likelihood techniques .",
    "these methods have a number of useful features : a map represents vast data compression relative to the time - ordered data ( e.g.  borrill 1999 ) , but is still a sufficient statistic for cosmological parameter estimation ; there are usually negligible pixel - pixel noise correlations in the beam - smoothed map ; maps provide important ` reality checks ' , and can be inspected by eye ; and unobserved or contaminated regions of the sky can be simply removed from subsequent analysis by excluding the associated pixels ( e.g.  oh et al .",
    "1999 ) . from a more practical point of view",
    ", the conventional map - making method is ` tried and tested ' now .",
    "however , the use of pixelised maps during the data analysis also involves some compromises : the real microwave sky does not consist of a number of regions of uniform temperature ( the prior hypothesis used to make a map ) , and so information is lost in map - making ; subsequent steps in the analysis pipeline , such as component separation , can not easily be performed efficiently in real space  @xcite ; there is no single optimal or obvious choice of pixelisation scheme ; and deconvolution of the ( asymmetric ) beam profile and temporal response of instrument , and removal of scan - synchronous instrument effects require awkward additional processing during map - making  @xcite .",
    "another potential problem that has received only limited attention thus - far ( e.g. tegmark & de oliveira - costa 2001 ) is how to create maps from polarization data ( i.e.  a map for each of the stokes parameters , or their gradient and curl components )  there is currently no robust algorithm for the treatment of several polarization - specific systematic effects that plague cmb polarimetry experiments .",
    "it is with these points in mind that a complementary , harmonic method of data analysis is presented here . for full - sky surveys",
    "the data analysis process would proceed from the time - ordered data directly to the set of spherical multipole moments , which would take the place of a real - space map . for band - limited observations ( effectively ensured by the finite experimental beam ) ,",
    "this harmonic reconstruction of the sky involves essentially no loss of information .",
    "the separation of the various astrophysical components of the microwave sky could then be performed quite naturally in multipole space ( e.g.  hobson et al .",
    "1998 ) , and , if necessary , the galactic plane could be removed while retaining orthonormality of the basis set ( grski 1994 ; mortlock , challinor & hobson 2001 ; see also section  [ subsec : power ] ) .",
    "power spectrum estimation could then proceed naturally from this point ; for instance the efficient method presented by oh et al .",
    "could be used , although some generalisation would be required to remove the dependence on forward and inverse fast spherical transforms , which oh et al .  use to apply the inverse noise matrix efficiently in the space of multipoles and to reduce memory requirements .",
    "the multipole moments of the polarized components could be obtained using an almost identical formalism ; obviously it would incur an additional overhead for each component to be reconstructed , but no further conceptual development would be required .",
    "we have endeavoured to present the harmonic method as an end - to - end solution for the processing of time - ordered data into power spectra .",
    "for such an analysis pipeline the benefits of clear error propagation from timelines to power spectra afforded by our harmonic methods are maximised .",
    "however , we do not pretend that all aspects of cmb analysis are best performed in the harmonic domain ; instead we view harmonic methods as being complementary to standard map - based techniques .",
    "an obvious example where map - based processing is clearly desirable is the analysis of localised foregrounds ( or cmb features ) .",
    "in addition , the inversion from observations over only a fraction of the sky to the spherical multipoles rapidly becomes singular as the resolution of the observations is increased .",
    "although it may be possible to regularise the inversion in such cases ( e.g.  with prior information on the power spectrum ) , or to adopt a basis set adapted to the observed patch , the processing we describe in this paper is best considered in the context of full - sky observations .",
    "even then , some aspects of the processing , such as cutting out contaminated regions close to the galactic plane for power spectrum estimation , require rather cumbersome operations if we insist on working directly with the full sky spherical multipoles rather than a map synthesised from them .",
    "the principles of harmonic data analysis as described above are quite general , and could be applied to any full - sky cmb observations .",
    "however , it is particularly suited to experiments with a circular scanning strategy , such as the _ planck _ mission .",
    "the data are obtained by a combination of rotations ( i.e.  the motion of the detector across the sky ) and convolutions ( of the beam with the true microwave sky , and this subsequent signal with the temporal response of the instrument ) , and these operations are most simply expressed in the harmonic basis ( delabrouille , grski & hivon 1998a ; challinor et al .",
    "2000 ; wandelt & grski 2001 ) .",
    "hence we propose that the time - ordered data be transformed to the fourier basis at the earliest opportunity : van leeuwen et al .",
    "describe how to construct point source catalogues and calibrated ring - sets simultaneously , in which the data around each ring is represented in fourier space .",
    "some aspects of this process are necessarily mission - specific , and , for the sake of generality , it is assumed here that it is possible to obtain calibrated ring - sets ( and their errors ) in this form .",
    "the focus of this paper is on the subsequent ` map'-making : combining the ring - sets to obtain an estimate of the spherical multipoles for the temperature anisotropies and polarization . in this respect ,",
    "we build on earlier work by delabrouille et al .  , who analysed the statistics of the power spectrum of the fourier modes on a single ring , and the relation with the power spectrum of the underlying temperature field on the sphere .",
    "more recently , wandelt & hansen   have proposed the ` ring - torus ' method for estimating the temperature power spectrum from the two - dimensional fourier transform of data obtained on a set of rings with centres equally spaced on a small circle . while the general philosophy of the ` ring - torus ' method coincides with that advocated here , the methodology presented here is somewhat more general . by only making use of one - dimensional fourier data , we are able to deal with arbitrary ring - sets and to include instrument effects such as the inevitable variations in the scanning properties of the telescope  @xcite . furthermore ,",
    "since we do not proceed directly to the power spectrum , we can make full use of fourier - based component separation algorithms ( e.g.  hobson et al .",
    "1998 ) to deal carefully with foreground contamination .",
    "the cost of maintaining this generality is the increased computational requirements of our methods over those that exploit special symmetries of the survey .",
    "the general formalism is described in section  [ sec : hdm ] , which proceeds from a model of the instrument to the maximum - likelihood solution for the spherical multipoles of the temperature anisotropy and polarization , and their associated errors .",
    "the structure of the error covariance matrix , including polarization , is studied for some simple scan strategies in section  [ sec : scan ] . making use of some results given in appendix b , we are able to make contact with several well - known analytic results for idealised experiments , previously obtained from arguments at the level of the map . in section  [ sec : disc ]",
    "we discuss a number of important issues that arise during the map - making phase , including correcting for scan - synchronous instrument effects , the overall calibration of the instrument to external standards , and the treatment of low frequency noise .",
    "the latter discussion includes a novel method for dealing with uncertainties in the low frequency noise power spectrum or insensitivity of the experiment to the monopole .",
    "section  [ sec : sub ] reviews the subsequent processing of the frequency maps , including component separation and power spectrum estimation , within the context of the harmonic data model .",
    "finally , we conclude in section  [ sec : conc ] by reviewing the relative merits of the harmonic method , and suggest directions for future development .",
    "the basis of the harmonic data model is the relationship between the one - dimensional fourier representation of the ring data and the spherical multipole coefficients of the underlying sky . in the absence of instrument noise and",
    "reconstruction errors in the estimation of the fourier ring data , the relation between the data and the sky is determined by the scanning strategy , the point - spread function or beam of the telescope , and the impulse response of the instrument in the time domain . in this section",
    ", we set up a detailed , but general , model of the instrument and scanning strategy which defines the contribution to the data coming from the sky .",
    "we then include instrument noise and reconstruction errors to give the maximum - likelihood solution for the spherical multipoles of the sky , and the covariance of their errors .",
    "we describe the microwave sky in terms of spherical multipoles on some fixed basis .",
    "the brightness in total intensity @xmath2 from the sky when observed along direction @xmath3 at frequency @xmath4 is represented as @xmath5 where the sum is over integers @xmath6 , and @xmath7 .",
    "the ( partial ) polarization of the sky is described by stokes ( brightness ) parameters @xmath8 , @xmath9 , and @xmath10 .",
    "we define the @xmath11 and @xmath12 stokes parameters on a basis which forms a right - handed triad with the incoming radiation direction @xmath13 : in a spherical polar coordinate system , we use the basis @xmath14 with @xmath15 .",
    "the @xmath16 brightness is a scalar function , so can be expanded in multipoles as @xmath17 it is convenient to combine the @xmath11 and @xmath12 brightnesses into a symmetric , trace - free second - rank tensor : @xmath18 , \\label{eq:3}\\end{aligned}\\ ] ] which can then be expanded in the transverse , trace - free tensor harmonics ( kamionkowski , kosowsky & stebbins 1997 ) as @xmath19 . \\label{eq:4}\\ ] ] here , the sum is over @xmath20 , and @xmath7 .",
    "the superscripts @xmath21 ( for gradient , often called electric ) and @xmath22 ( for curl , often called magnetic ) refer to the two types of transverse , trace - free harmonics .",
    "all multipoles satisfy @xmath23 since the brightnesses are real and we have adopted the condon - shortley phase for the spherical harmonics .    in this paper",
    "we assume that the @xmath24 contain all astrophysical components .",
    "in particular , we include the contribution of unresolved extra - galactic radio sources ( point sources ) .",
    "the point source catalogue is an important deliverable product of the _ planck _ mission ; an algorithm for simultaneously constructing the bright point source catalogue and calibrating the instrument from data ordered by phase on rings is described by van leeuwen et al .  . here",
    ", we assume that the contribution of those bright point sources identifiable on individual rings has not been removed from the data , although we leave open the question of whether this assumption is optimal in the context of the harmonic data model .",
    "the steps described in this paper for reconstructing the multipoles of the sky from the fourier modes of the ring data are largely independent of whether the data includes the bright point source contribution or not .",
    "of course , if the bright point sources are removed from the data prior to reconstructing the sky , our solution excludes the contribution from those identified point sources .",
    "one practical problem with leaving bright point sources in the ring - sets is that the sky must be represented by a larger number of multipoles to avoid biasing the estimates of the lower multipoles .",
    "furthermore , it is then essential that the point sources are removed during the component separation phase , before any cosmological analysis of the maps ( e.g.  vielva et al .",
    "2001 ) . removing the brightest point sources at the level of the ring - sets",
    "leads to a modest increase in the complexity of the pipeline leading from time - ordered data to calibrated ring - sets .",
    "in particular , although a given source will only give rise to a prominent feature on a small subset of rings , the source s contribution must be removed consistently from every ring to ensure that the remaining data on each ring is derived from the same underlying sky .",
    "point sources that are too faint to be identifiable on any single ring may still be detectable statistically when the rings are combined into the best - fitting set of multipoles ( or map ) .",
    "statistical detection of faint point sources is easily implemented during the component separation phase  @xcite , and does not require the same pre - processing steps as removal of bright point sources  @xcite .",
    "a cmb mission with a circular scanning strategy can be described in terms of @xmath25 sets of @xmath26 rings on the sky , each set referring to a given detector ( see fig .",
    "[ fig : ring ] ) .",
    "for all detectors , each ring is covered @xmath27 times by spinning the instrument about the axis of the ring . in the case of the _ planck _ mission , the satellite will rotate @xmath28 times about it axis before moving on to a new pointing .",
    "the @xmath29th ring is specified by its axis pointing , @xmath30 , which coincides with the average pointing of the spin axis during the @xmath27 revolutions .",
    "the axis pointing of a ring is the same for all detectors on the instrument .",
    "note that the concept of a ring only makes sense if any precession of the spin axis ( due to initial misalignment of the spin axis with the principal directions of the inertial tensor , or external torques ) can be engineered to be insignificant compared to the smallest beam width .",
    "the opening angle of the @xmath29th ring for the @xmath31th detector is denoted by @xmath32 .",
    "it is defined as the average ( over the @xmath27 revolutions ) angle between the spin axis and the nominal main beam direction on the sky of the appropriate horn in the focal plane .",
    "not only does @xmath32 depend on the detector , but it also differs between rings for a given detector .",
    "the dependence on the detector is determined by the focal plane geometry . for low frequency ,",
    "polarization - sensitive instruments ( e.g. hemt receivers ) there will typically be two detectors ( measuring nearly orthogonal polarization states ) on a given horn .",
    "in such an arrangement , the ring opening angle will be the same for the two detectors , but will differ between horns .",
    "similar comments apply to the current state of the art designs for high frequency bolometer instruments , where two orthogonal polarization sensitive bolometers are placed on a single horn .",
    "the dependence of @xmath32 within a given detector s ring - set arises from slow drifts of the spin axis relative to the instrument optics as consumables are depleted during the mission ( thus changing the inertia tensor of the instrument ) .",
    "the position around a given ring is specified by @xmath33 , and is measured so that @xmath34 is the most southerly intersection of the ring and the great circle contaning the @xmath35-direction and the spin axis [ see fig .",
    "[ fig : ring ] ; for @xmath36 ( @xmath37 ) we take @xmath34 to lie in the @xmath38-@xmath35 plane with positive ( negative ) @xmath38 ] . the times at which different detectors pass through @xmath34 is dependent on the focal plane geometry .",
    "for each horn in the focal plane we define a constant reference configuration where the nominal main beam direction is aligned with the @xmath40 direction of the cartesian frame used to define the spherical multipoles for the sky , and the @xmath35-axis of the instrument reference system  @xcite lies in the plane normal to @xmath41 , with a negative projection onto @xmath42 .",
    "( the instrument reference system , which is fixed relative to the instrument optics , can be chosen so that its @xmath35-axis almost coincides with the nutation - averaged spin axis .",
    "variations in the inertia tensor during the mission prevent a constant alignment of the spin and @xmath35-axes . ) the instrument configuration when the @xmath31th detector takes data at angle @xmath33 on the @xmath29th ring is obtained by rotating the instrument from the appropriate horn reference configuration .",
    "the appropriate rotation is given by the composition , @xmath43 and @xmath44 are such that the rotation @xmath45 actively rotates by @xmath44 about @xmath40 , followed by @xmath43 about @xmath41 , and finally by @xmath46 about @xmath40 again .",
    "all rotations are right - handed . see brink & satchler  , whose conventions we follow , for a discussion of the several alternatives that appear in the literature . ]",
    "the rotation @xmath48 accounts for focal plane rotation ( which arises from misalignment of the spin axis and the @xmath35-axis of the instrument ) by : ( i ) first rotating the spin axis into the @xmath38-@xmath35 plane of the sky coordinate system while leaving the main beam direction along the @xmath35-direction on the sky ; and ( ii ) taking the spin axis onto the @xmath35-direction on the sky by rotating in the plane contaning the spin axis and the main beam direction .",
    "the angle @xmath49 thus measures the angle between two planes , both containing the main beam direction , with one including the spin axis and the other including the @xmath35-axis of the instrument reference system .",
    "the rotation @xmath50 takes the spin axis onto the axis of the @xmath29th ring , and the main beam to the position @xmath33 around the ring .",
    "note that the horn reference configuration is defined by the instrument reference system rather then the spin axis .",
    "this ensures that the beam patterns in the given horn reference configuration are independent of variations in the inertia tensor .",
    "the contribution of the ( time - independent ) sky signal to the time - ordered data from a given detector will be periodic in @xmath33 , so the data can be co - added in bins of @xmath33 with essentially no loss of useful information . producing this phase - ordered data from the time streams is a non - trivial task , since typically the scan velocity drifts during the @xmath27 scans of the circle : van leeuwen et al .",
    "detail one possible scheme for reconstructing the phase - ordered data and associated errors . from the phase - ordered data @xmath51",
    ", one can estimate the fourier coefficients in the expansion @xmath52 and the covariance of their errors @xmath53 . here",
    ", angle brackets denote the expectation value and @xmath54 .",
    "the @xmath55 are the primary data objects in the harmonic reconstruction of the microwave sky .",
    "we assume that the detector responses are linear functionals of the sky in the absence of instrument noise . at any instant ,",
    "the power seen by a given detector ( due to the sky ) is given by convolving the sky with the appropriate beam and spectral transmission .",
    "a single time - ordered data point is then obtained by convolving this power with the detector s temporal response .",
    "it is convenient to define the beam profile when the instrument is in the appropriate horn reference configuration , so that the beams can be assumed not to vary through the mission .",
    "a method for describing arbitrary , polarized beam patterns in terms of multipoles @xmath56 was introduced by challinor et al .  .",
    "the beam pattern is first described in terms of effective stokes parameters @xmath57 , which are defined on the same @xmath58 basis as the sky .",
    "these effective stokes parameters can be expressed in terms of the far - field radiation pattern of the detector  @xcite .",
    "the @xmath59 and @xmath60 can be combined into a linear polarization tensor for the beam , @xmath61 , as in equation  ( [ eq:3 ] ) .",
    "the resultant power per unit frequency interval , @xmath62 , can then be written in basis - independent form as the integral @xmath63\\ , { { { \\mathrm{d}}}}\\omega , \\label{eq:6}\\end{aligned}\\ ] ] where @xmath64 is the effective area ( assumed independent of frequency ) .",
    "the directivity @xmath65 is a scalar field on the sphere , so can be expanded in terms of multipoles @xmath66 , as in equation  ( [ eq:3 ] ) .",
    "we impose the constraint @xmath67 so that @xmath65 integrates to unity over the sphere . in a similar manner ,",
    "@xmath68 can be represented by multipoles @xmath69 .",
    "finally , @xmath70 can be expanded in the transverse , trace - free tensor harmonics with multipoles @xmath71 and @xmath72 .    to obtain the power per unit frequency interval incident on the spectral filter chain for the @xmath31th detector ,",
    "when the nominal main beam is at angle @xmath33 on the @xmath29th ring , we must rotate the beam pattern by @xmath47 before performing the convolution in equation  ( [ eq:6 ] ) .",
    "this rotation is easily performed in multipole space to give the result  @xcite @xmath73 , \\label{eq:7}\\end{aligned}\\ ] ] where , for later convenience , we have defined @xmath74 with @xmath75 for @xmath76 .",
    "the @xmath77 appearing in equation  ( [ eq:7 ] ) are wigner s @xmath78-matrices ; our conventions follow brink & satchler  .",
    "the dependence of @xmath77 on @xmath46 and @xmath44 goes as @xmath79 where the @xmath80 are the reduced rotation matrices .",
    "the power available at the detection element ( e.g. bolometers for high frequency instruments ) is given by integrating @xmath81 against the spectral transmission @xmath82 of the filter chain .",
    "we shall assume that the filters on all detectors in a given frequency band are identical , and have transmission properties that are accurately known from calibrations on the ground .",
    "map - making from multi - frequency data is usually performed on a band - by - band basis ( although it is essential to use all the frequency bands to calibrate the pointing , e.g. van leeuwen et al .",
    "given that fourier data from only detectors in the same frequency band are combined in such an analysis , we need only consider a single band , and henceforth assume that @xmath82 has no dependence on the detector , i.e. @xmath83 .    on integrating equation  ( [ eq:7 ] ) against @xmath84 , the dependence on the sky enters through the integral @xmath85 .",
    "for the subsequent analysis , it is important that this integral can be factored into a part describing the sky carrying only @xmath86 and @xmath87 indices , and a part describing the beam which has only @xmath86 and @xmath88 indices .",
    "here we assume that the approximate factorisation @xmath89 where @xmath90 is the central frequency in the band , is accurate to better than the noise level , so that we can describe the sky by the frequency integrated multipoles",
    "@xmath91 the largest source of error resulting from this factorisation is expected to be due to the variation of the width of the main beam across the band . in appendix",
    "[ app : beam ] we compute the systematic error on the recovered power spectrum of the cmb temperature anisotropies resulting from this variation , assuming an axisymmetric , diffraction - limited gaussian beam , uniform sky coverage , and no foreground contaminants .",
    "for the _ planck _ high frequency instrument ( hfi ) , the bias may be non - negligible in the 100 ghz channel between @xmath92 and @xmath93 , in which case refinements to equation  ( [ eq:10 ] ) will be required . here",
    ", we adopt the factorisation in equation  ( [ eq:10 ] ) , in which case the power available at the detection element , @xmath94 , can be written as @xmath95 .",
    "\\label{eq:12}\\end{aligned}\\ ] ] for later convenience , we have introduced the notation @xmath96 for the multipoles of the @xmath31th beam after rotation by @xmath48 .",
    "note that the @xmath29-dependence of @xmath97 derives only from the ( slow ) variation of opening angle @xmath32 and focal plane rotation @xmath49 through the mission .      the available power , @xmath98 $ ] , is convolved with the temporal response function of the detector , @xmath99 , to generate a single time - ordered datum at time @xmath100 .",
    "we decompose @xmath99 into a stationary part , @xmath101 , and a stochastic part , @xmath102 , which we assume to have stationary statistical properties . the stochastic part , which derives from e.g.random fluctuations in amplifier gains , will be considered as part of the instrument noise in section  [ subsec : noise ] . here , we concentrate on the stationary impulse response function @xmath103 .",
    "typically , this will contain several instrument artifacts , such as the effect of finite sampling and non - zero detector time constants , which are convolved together to form the total impulse response .",
    "for example , if the detector time constant is @xmath104 , and samples are taken by integrating over time intervals @xmath105 and are assigned to the midpoint of the interval , then @xmath106 , where the detector impulse response @xmath107 and the sampling impulse response @xmath108 here , @xmath109 is the heaviside unit step function , and @xmath110 is the average gain over the mission , which includes both amplifier gain and the quantum efficiency of the detectors .",
    "one of the advantages of describing the data on rings in the fourier domain is that the convolution with the temporal response of the instrument reduces to a simple product  @xcite .",
    "denoting the contribution of the signal to the phase - ordered data by @xmath111 , we have @xmath112 where @xmath113 is the ( average ) spin rate on the @xmath29th ring .",
    "we have assumed that the support of @xmath103 is sufficiently compact that the only contribution to @xmath111 is from the available power @xmath114 on the same ring .",
    "we have further assumed that any variation of the spin rate about the average is negligible for the purpose of performing the convolution , so that the convolution of the available power with the impulse response is periodic in @xmath33 . inserting equation  ( [ eq:12 ] ) into equation  ( [ eq:16 ] ) , and expanding @xmath115 as in equation  ( [ eq:9 ] ) , we find @xmath116 , \\label{eq:17}\\end{aligned}\\ ] ] where @xmath117 is the fourier transform of the impulse response : @xmath118 for the impulse responses in equations  ( [ eq:14 ] ) and  ( [ eq:15 ] ) , we have @xmath119 finally , we can extract from equation  ( [ eq:17 ] ) the contribution of the signal to the @xmath120th fourier coefficient of the phase - ordered data .",
    "complex conjugating and using equation  ( [ eq:9 ] ) , we find @xmath121 , \\label{eq:20}\\ ] ] where the sum is over @xmath122 and @xmath7 .",
    "note that the effect of the impulse response can also be described in terms of an effective ( ring - dependent ) beam with multipoles @xmath123 .",
    "\\label{eq:21}\\end{aligned}\\ ] ] the effective beam will be generally not be axisymmetric as a consequence of the smearing along the scan direction induced by the impulse response of the instrument .",
    "the concept of an effective beam becomes particularly significant if the beam has to be calibrated from the observations of e.g.  bright point source transits , as described by van leeuwen et al .  .",
    "in such cases , it is the effective beam that can be reconstructed most directly . a potential difficulty that would need to be addressed in such an approach is the ( slow ) variation of effective beam with ring due to variations in the angles @xmath32 and @xmath49 . in practice",
    ", it may be simpler to deconvolve the temporal response of the instrument prior to construction of the phase - ordered data . in this case , @xmath124 can be omitted from equation  ( [ eq:20 ] ) .",
    "the fourier modes , @xmath55 , that we construct from the phase - ordered data differ from the @xmath125 of equation  ( [ eq:20 ] ) because of a number of sources of error .",
    "for example , stochasticity in the instrument temporal response , such as that due to thermal noise in the detectors and amplifiers , has not been included in equation  ( [ eq:20 ] ) .",
    "neither have we included the effects of photon ( shot ) noise , or any detector offsets .",
    "furthermore , we have replaced the spin axis pointing by its average over the @xmath27 spin periods , ignoring the ( albeit small ) effects of the nutation of the instrument .",
    "these random errors tend to be suppressed in the phase - ordered data due to the averaging over @xmath27 periods , except for fluctuations at temporal frequencies synchronous with the spin frequency .",
    "fluctuations below the spin frequency remain in the phase - ordered data predominantly as an offset on the ring . in the usual map - making paradigm",
    "@xcite , low frequency ( @xmath126 ) noise must be carefully accounted for ; failure to do so leads to highly correlated errors in the reconstructed map which typically appear as stripes ( e.g.  delabrouille 1998 ; revenu et al .",
    "it is difficult to accommodate low frequency noise power in map - making from the time - ordered data since its inclusion spoils the sparse nature of the time - time noise correlation matrix .",
    "approximate methods to circumvent this problem for experiments that scan on rings already exist  @xcite ; these ` destriping ' methods will be discussed further in section  [ subsec : stripes ] .",
    "there are also a number of potential systematic errors which contaminate the @xmath55 , and , if left unaccounted for , will lead to bias in the reconstructed multipoles of the sky .",
    "keeping the numerous systematics under control is essential to maintaining the integrity of the final data products .",
    "a significant merit of the harmonic data model is that the model of the instrument , equation  ( [ eq:20 ] ) , is sufficiently complete to include a number of systematic effects which are not so naturally included in the standard map - making techniques .",
    "for example , the harmonic model can seamlessly accommodate any prior knowledge we have of asymmetries in the beam profiles , cross - polar contamination for the polarized detectors , sidelobe features leading to ` straylight ' entering the instrument , and detector time constants and data sampling rate .",
    "for some systematics there will be incomplete ( or even no ) prior knowledge of essential parameters , in which case these parameters must be estimated from the data themselves during the reconstruction of the sky .",
    "the harmonic model also appears well - suited to handling such systematics iteratively ; see section  [ subsec : sync ] .    to include the effect of gaussian random noise with a known ( or estimated ) power spectrum in the reconstruction of the sky from the fourier data on rings , @xmath55",
    ", we require the covariance matrix @xmath127 .",
    "this matrix was calculated by delabrouille at al .   for a single detector and ring ( @xmath128 and @xmath129 ) . here",
    "we extend their result to include the effects of a finite sampling rate ( see also janssen et al .",
    "1996 ) , and to allow for @xmath130 .",
    "assuming instrument noise dominates the random errors @xmath131 , there will be negligible correlation between the errors on different detectors , so we need only consider @xmath128 .",
    "we assume that the noise contribution , @xmath132 , to the time stream of the @xmath31th detector is a real , stationary random process with zero mean , and power spectrum @xmath133 .",
    "the power spectrum is the fourier transform of the noise auto - correlation function @xmath134 : @xmath135 the propagation of the noise @xmath132 to the errors @xmath131 depends on the exact procedure for estimating the fourier modes @xmath55 from the time - ordered data  @xcite . however , to a first approximation , the errors @xmath131 are obtained by convolving @xmath132 with the impulse response of the sampler , @xmath136 , mapping the portion of this function covering the observation interval for the @xmath29th ring onto the angle @xmath33 around the ring , and finally extracting the fourier coefficients of the resultant signal : @xmath137 \\ , { { { \\mathrm{d}}}}t .",
    "\\label{eq:23}\\ ] ] here , @xmath138 is the time when the @xmath31th detector is first pointing to @xmath34 on the @xmath29th ring , @xmath139 is the end of the observation interval for that ring : @xmath140 , and we have ignored any variation of the spin rate during the @xmath27 revolutions .",
    "it is now straightforward to write the covariance of the errors in terms of the noise power spectrum . for the case of scanning missions such as _ planck _ , the number of revolutions @xmath141 is sufficiently large that negligible correlations remain between different fourier modes . in this case",
    "we find @xmath142 \\nonumber \\\\ & & \\mbox { } \\times \\exp[i2\\pi n_{{\\mathrm{s } } } ( r - r')\\omega/\\omega_r ] \\ } \\ , { { { \\mathrm{d}}}}\\omega , \\label{eq:24}\\end{aligned}\\ ] ] where we have further ignored any variation of the average spin rate , @xmath143 , between rings . provided that @xmath144 varies slowly compared to the rest of the integrand in equation  ( [ eq:24 ] ) around @xmath145 , we can replace it by its value there . the remaining integral vanishes",
    "unless @xmath129 , so that for slowly varying power spectra the covariance matrix is fully diagonal : @xmath146 in the presence of a significant low frequency noise component ( such as @xmath126 noise in the electronics ) joining onto white noise at a knee frequency @xmath147 ( e.g. delabrouille 1998 ) , the assumption of a slowly varying noise power spectrum may not hold for small @xmath148 .",
    "typically the spin rate will be chosen so that @xmath149 , in which case equation  ( [ eq:25 ] ) will be valid for @xmath150 . however , for @xmath151 we can expect correlations between rings unless @xmath152 .",
    "( for the _ planck _ hfi , the nominal @xmath153 , and @xmath154 , so these conditions are likely to be satisfied . ) even in the presence of such correlations , the noise covariance matrix is still block diagonal in the harmonic representation , in contrast to the time - time covariance matrix which has significant off - diagonal terms due to the extended support of the noise auto - correlation function , @xmath155 .",
    "our model for the ring fourier data @xmath55 is now @xmath156 , where the signal @xmath125 is modelled by equation  ( [ eq:20 ] ) .",
    "it is convenient to write this relation in the form @xmath157 where the coupling matrix is @xmath158 we define @xmath159 to be zero for @xmath160 , since the @xmath55 only depend on the @xmath161 with @xmath122 .",
    "this structure can be exploited to derive an unbiased ( although not minimal variance ) estimator for the @xmath161 , which can be computed in @xmath162 operations . here",
    ", @xmath163 is the maximum @xmath86 that we retain during the inversion .",
    "( the experimental beam limits @xmath163 even if the underlying sky is not band - limited . )",
    "the estimate is derived by working down from the maximum fourier mode , @xmath164 , and performing a regularised inversion of a subset of the data to solve for those @xmath161 on which the data subset depends but which have not been determined at a previous step .",
    "full details of this estimator will be given in a future paper ( mortlock et al .  in preparation ) .",
    "in this paper we shall just give the formal maximum - likelihood solution to equation  ( [ eq:26 ] ) .",
    "we assume that we are attempting to solve only for the @xmath161 which form the components of a vector @xmath165 . in practice",
    ", it may also be desirable to attempt to solve for several instrument parameters which are unknown from earlier calibrations , but which represent significant systematic effects .",
    "such parameters are easily included in the maximum - likelihood formalism , but unless they influence the data linearly their inclusion would prevent us from being able to locate the maximum - likelihood multipoles analytically .",
    "given the size of the problem , having to locate the maximum of the likelihood by a numerical search in model space is clearly undesirable .",
    "the treatment of systematics with unknown parameters is probably best performed iteratively ( e.g. delabrouille , gispert & puget 1998b ; see also section  [ subsec : sync ] ) .",
    "assuming gaussian noise , the maximum - likelihood estimate , @xmath166 , for the true sky , @xmath165 , is @xmath167 where @xmath168 is the vector of fourier modes @xmath55 , @xmath169 is the matrix of coupling coefficients @xmath170 , and @xmath171 is the noise covariance matrix with components @xmath127 . the @xmath172 operation in equation  ( [ eq:28 ] )",
    "denotes hermitian conjugation .",
    "the maximum - likelihood solution is the optimal , unbiased estimate of the sky .",
    "its covariance matrix is @xmath173 where the average is over noise realisations .",
    "a brute force evaluation of @xmath166 requires @xmath174 operations and @xmath162 storage which is impossible at the moment for high resolution experiments .",
    "conjugate gradient techniques ( e.g. press et al .",
    "1992 ) would reduce the operations count to @xmath175 , where @xmath176 is the number of iterations required , by removing the matrix multiplies and inversion .",
    "note that the block - diagonal structure of @xmath171 ( equation  [ eq:24 ] ) reduces the cost of computing @xmath177 to @xmath162 operations , or fewer if correlations between rings are confined to the @xmath151 modes .",
    "keeping @xmath176 small requires a careful choice of preconditioner , i.e.  a hermitian , positive - definite matrix which is both a good approximation to the inverse covariance matrix @xmath178 and is easy to invert .",
    "we demonstrate in section  [ sec : scan ] that for simple scan strategies such matrices can easily be found ( see also oh et al .",
    "for the case where all rings are at similar latitude , an approximation to @xmath178 can be computed in @xmath162 operations and requires only @xmath179 storage .",
    "this preconditioner is block - diagonal and can be inverted in @xmath162 operations .",
    "note , however , that the conjugate gradient evaluation of equation  ( [ eq:29 ] ) still requires @xmath162 storage for the non - sparse matrix @xmath169 .",
    "the application of the conjugate gradient method , as well other iterative techniques , to equation  ( [ eq:29 ] ) will be explored numerically in mortlock et al .",
    "( in preparation ) .    in writing down the maximum - likelihood solution we have assumed that @xmath180 is invertible , so that the solution is unique . for some scan strategies and instrument geometries , @xmath181 may become numerically singular due to incomplete coverage of the sky . with incomplete coverage , and",
    "@xmath163 sufficiently large , there may exist sets of multipoles which produce a temperature or polarization field which is localised to machine precision in the regions of the sky that are not covered  @xcite .",
    "in such cases , solving for the multipoles must proceed via singular value techniques , and we obtain no constraint on the part of @xmath165 which lies in the null space of the coupling matrix @xmath169 . if map - making were performed in pixel space , similar problems would arise when attempting to estimate the multipoles from the pixelised map . as an alternative to singular - value techniques",
    ", we could further regularise the inversion by wiener filtering . with a gaussian prior for the signal @xmath165 , with covariance @xmath182",
    ", the maximum of the posterior probability gives the wiener - filtered reconstruction @xmath183 in this manner , the inversion of the singular matrix @xmath184 is regularised by the inverse signal covariance matrix @xmath185 . in practice ,",
    "the microwave sky is only poorly approximated as a gaussian random process , particularly in those frequency channels where the cmb is not dominant .",
    "in addition , we will only have limited knowledge of the signal covariance matrix @xmath186 either from other observations , or a preliminary , approximate analysis of the data .",
    "however , wiener filtering has proved to be a useful technique in component separation where similar objections to the use of gaussian priors hold ( see e.g. hobson et al .",
    "1998 and references therein ) , and the same should be true for harmonic ` map'-making . note that wiener filtering produces a biased estimate of the sky ; other linear filters have been proposed to cirumvent this problem , but generally produce noisier , though unbiased , maps ( e.g.  tegmark & efstathiou 1996 ) . equation  ( [ eq:29a ] ) can also be solved with conjugate gradient techniques ; in this case the preconditioner should include some simplified form of the signal covariance in addition to an approximation to @xmath184 .    in our discussion",
    "so far we have assumed that full beam deconvolution is performed during the ` map'-making stage . in practice , deconvolving the beam completely may be undesirable for several reasons .",
    "firstly , the matrix @xmath184 is likely to be more ill - conditioned since the errors on the reconstructed multipoles must grow large as @xmath86 approaches the ( inverse ) beam scale .",
    "( in a conjugate gradients solution , the preconditioner can partly take this effect into account . ) secondly , as discussed in section  [ subsubsec : spectra ] and appendix  [ app : beam ] , variation of the width of the main beam across the spectral band of a channel is a potential source of systematic error . for an asymmetric beam",
    ", one could make the optimistic assumption beam multipoles in a given frequency channel could be written as the product of a frequency - dependent , symmetric part @xmath187 which is assumed to be the same for all detectors in the band , and a frequency - independent , asymmetric part which may depend on the detector : @xmath188,\\ ] ] where @xmath90 is the central frequency in the band .",
    "we could then solve for the multipoles of the sky convolved with an effective symmetric beam with multipoles @xmath189 and integrated across the frequency band with filter @xmath84 . by factoring the beam in this way",
    ", we can simultaneously improve the condition number of @xmath190 and remove most of the bias due to variation of the main beam width with frequency .",
    "in this section we investigate the structure of the inverse covariance matrix , @xmath191 , of the recovered multipoles for two simple scanning strategies . the first is a random pointing of the spin axis for each ring , which ensures uniform coverage of the entire sky .",
    "the second is constant latitude scanning , where all rings have the same polar angle , @xmath192 .",
    "constant latitude scanning is a useful approximation to the scan strategy of the _ planck _ satellite , where the spin axis stays close to the plane of the ecliptic . by adopting coarse restrictions on the behaviour of the instrument",
    ", we are able to demonstrate that , under these restrictions , the harmonic estimate of the sky , equation  ( [ eq:28 ] ) , is statistically equivalent to that obtained via conventional map - making and spherical analysis . by relaxing some restrictions on the behaviour of the instrument ,",
    "we obtain some useful extensions of the known results .    throughout this section",
    "we impose a number of limits on the instrument response : ( i ) the spin axis position is always aligned with the @xmath35-axis of the instrument reference system ( see section  [ subsec : ring ] ) , so that the ring opening angles , @xmath32 , are independent of @xmath29 , and the focal plane rotations @xmath193 ; ( ii ) there is no variation in average spin rate between rings , so we can drop the subscript from @xmath143 ; ( iii ) the band width of the spectral filters is sufficiently narrow that @xmath194 where @xmath90 is the central frequency of the band ; ( iv ) bolometer time constants , @xmath104 , and the sampling period , @xmath105 , are such that @xmath195 and @xmath196 , in which case the effect of the instrument response can be approximated by simply a gain at zero lag ; ( v ) the noise power spectrum is white so that @xmath197 where @xmath198 is a constant for each detector , which can be related to the detector sensitivity , @xmath199 . with a single pointing ,",
    "the excess signal to noise is unity when the instrument is illuminated with an unpolarized black - body sky with a temperature excess @xmath200 over the average cmb temperature , @xmath201 .",
    "if the units of the gain @xmath110 are e.g.  @xmath202 , so that @xmath111 is a readout voltage , @xmath203 will also have the dimensions of a voltage , and @xmath199 will have units of e.g.  @xmath204 . ] with the restrictions above , @xmath205^{-1 } \\nonumber \\\\ & & \\mbox { } \\times \\sqrt{\\frac{2\\pi n_{{\\mathrm{s}}}}{\\omega_r } } \\sigma_d ,   \\label{eq:33}\\end{aligned}\\ ] ] where @xmath206 is the planck function and the average cmb temperature is @xmath201 . note that a consequence of restriction ( i ) is that @xmath207 is independent of ring , @xmath208 .",
    "if we define dimensionless multipoles by @xmath209^{-1 } a^p_{(lm)}(\\nu_0 ) ,   \\label{eq:34}\\ ] ] the inverse of the dimensionless error covariance matrix , @xmath210 , has components @xmath211^\\ast \\ } , \\label{eq:35}\\end{aligned}\\ ] ] where the sum is over detectors , rings , and @xmath212 .",
    "we now proceed to analyse @xmath210 for randomly - positioned rings and constant latitude scanning .",
    "we consider the limit of equation  ( [ eq:35 ] ) as the number of rings @xmath213 while keeping the survey length finite , in which case we can replace the sum over rings by an appropriate integral .",
    "in practice , for finite @xmath26 the continuum limit should hold for scales with @xmath214 .",
    "placing the rings at random is equivalent to enforcing uniform coverage of the full sky , which will allow us to make contact with existing analytic results obtained from the map - based formalism .",
    "the sum over randomly - positioned rings in equation  ( [ eq:35 ] ) can be replaced by @xmath215\\int \\ , { { { \\mathrm{d}}}}\\omega_r$ ] , where @xmath216 .",
    "making use of the orthogonality of the @xmath77 over the @xmath217 group manifold  @xcite , we find @xmath218^\\ast \\,{{{\\mathrm{d}}}}\\omega_r = \\frac{4\\pi}{2l+1 } \\delta_{ll ' } \\delta_{mm ' } , \\label{eq:36}\\ ] ] so that @xmath210 simplifies to @xmath219 where the total mission time is @xmath220 .",
    "equation  ( [ eq:37 ] ) can be further simplified by using equation  ( [ eq:13 ] ) to substitute for @xmath221 and then performing the sum over @xmath120 noting that @xmath222^\\ast = d^l_{nm}(-\\gamma,-\\beta,-\\alpha)$ ] .",
    "the result is @xmath223 note that there is now no dependence on the opening angles of the detectors , @xmath224 .",
    "this is a consequence of assuming white noise .",
    "if the noise had a characteristic timescale , this would combine with the spin velocity and opening angle to define a characteristic angular scale for the projected noise , and @xmath225 would then depend on @xmath226 .    to make further progress , we consider initially the case where the beams are axisymmetric , and have no cross - polar contamination . in this limit , the intensity multipoles can be written in terms of a window function , @xmath227 : @xmath228 and the linear polarization multipoles in terms of spin - weight 2 window functions , @xmath229 , ( challinor et al .  2000 ; see also ng & liu 1999 ) : @xmath230 here , @xmath231 is the angle between the polarization direction on axis and the normal to the plane containing the main beam direction and the spin axis . ( the unit normal to this plane is @xmath41 when the detector is in its horn s reference configuration ) . by assumption ,",
    "the circular polarization multipoles for the beam vanish . substituting into equation  ( [ eq:38 ] ) ,",
    "we find @xmath232 , \\label{eq:42}\\end{aligned}\\ ] ] where we have introduced the weight per solid angle  @xcite , which for uniform coverage of the sky is @xmath233 .",
    "note that the covariance matrix is diagonal , and that it does not depend on the relative orientations of the polarization directions of the various detectors .",
    "this is not surprising since for randomly - positioned rings , every point on the sky is traversed by every detector in every possible orientation , and we have assumed the instrument noise to be uncorrelated between detectors .",
    "it is straightforward to show that the covariance matrix in equation  ( [ eq:42 ] ) is equal to that obtained by constructing optimal ( minimum variance ) , beam - smoothed maps of the stokes parameters for each detector , and then optimally extracting the @xmath234 from a joint analysis of the maps .",
    "if the main beam of the @xmath31th detector lies in the @xmath235th pixel when the ring phase is @xmath33 on the @xmath29th ring , the signal contribution to the phase - ordered data , equation  ( [ eq:17 ] ) , can be written as ( see e.g.  challinor et al .",
    "2000 ) @xmath236 . \\label{eq:43}\\end{aligned}\\ ] ] under the restrictions described above . in equation  ( [ eq:43 ] )",
    ", @xmath237 is in the direction of the @xmath235th pixel , and has polar angle @xmath238 and azimuth @xmath239 , and the angle @xmath240 is the angle between the polarization direction ( on the sky ) along the beam axis and the plane containing @xmath237 and the @xmath35-axis of the fixed reference system .",
    "the beam - smoothed fields are @xmath241 , \\label{eq:45}\\end{aligned}\\ ] ] where the @xmath242 are examples of the spin - weight harmonics , defined for integer @xmath243 by  @xcite @xmath244 for randomly - positioned rings in the limit @xmath213 , the angles @xmath33 are uniformly covered in any given pixel . given our assumptions , the optimal , unbiased estimate for @xmath245 in the @xmath235th pixel is given by direct averaging of the appropriate @xmath51 .",
    "for @xmath246 the @xmath51 are averaged with weight @xmath247 , and for @xmath248 the weight is @xmath249 .",
    "the errors on the smoothed maps are uncorrelated between stokes parameters , and between pixels .",
    "the errors on these maps have weights per solid angle @xmath250 for @xmath245 , and @xmath251 for @xmath246 and @xmath248 .    for uncorrelated noise between stokes parameters , pixels , and detectors , the maximum - likelihood estimate of the @xmath234 from the smoothed maps",
    "reduces to minimising the ( absolute ) squared residuals between the left and right - hand sides of equations  ( [ eq:44 ] ) and  ( [ eq:45 ] ) , with each pixel for each detector entering with the appropriate weight per solid angle . in the case of uniform coverage considered in this subsection ,",
    "the maximum - likelihood estimates of the @xmath234 are equivalent to performing a spherical transform of the smoothed maps and then averaging these across the detectors , with each detector carrying statistical weight @xmath252 .",
    "however , it will be useful for the next subsection to note the form that the error covariance matrix takes when we relax the assumption of uniform coverage , while retaining the assumptions of uncorrelated errors between stokes parameters , detectors and pixels .",
    "the weights per solid angle for @xmath245 are then pixel - dependent , @xmath253 , and the weights for @xmath246 and @xmath248 are @xmath254 .",
    "the non - vanishing entries of the inverse of the ( hermitian ) error covariance matrix are then : @xmath255 , \\label{eq:48 } \\\\",
    "\\tilde{c}^{-1}_{(glm)(cl'm ' ) } & = & i\\sum_{pd } [ { } _ 2w_{l , d}\\ , { } _ 2w_{l',d}w_{d , p } { \\textstyle{\\frac{1}{2}}}({}_2y_{(lm)}^\\ast { } _ 2y_{(l'm ' ) } \\nonumber \\\\ & & \\phantom{\\sum_{pd } } - { } _ { -2}y_{(lm)}^\\ast{}_{-2}y_{(l'm ' ) } ) \\delta \\omega_p ] , \\label{eq:49}\\end{aligned}\\ ] ] and @xmath256 . here",
    ", @xmath257 is the solid angle subtended by the @xmath235th pixel . for the case of uniform coverage , @xmath258",
    ", the orthonormality of the spin - weight harmonics reduces equations  ( [ eq:47])([eq:49 ] ) to the result derived from the harmonic model , equation  ( [ eq:42 ] ) , if we ignore pixelisation effects . for this simple example ,",
    "the estimates of the @xmath259 from the harmonic model and the map - making route are both unbiased and have the same error covariance .",
    "it follows that they are statistically equivalent at the level of second - order correlations ( and at all orders for gaussian noise ) .",
    "we now consider the effect of a known beam asymmetry on the covariance matrices obtained via the harmonic and map - based routes . for simplicity , we shall only consider unpolarized detectors with bivariate gaussian profiles , with eccentricity @xmath260 .",
    "consider initially a detector in its horn s reference configuration , with the major axis of the iso - directivity ellipse aligned with @xmath42 .",
    "for beam widths @xmath261 , we have @xmath262/(2\\sigma_d^2)\\ } } { 2\\pi\\sigma_d^2\\sqrt{1-e_d^2 } } , \\label{eq:50}\\ ] ] which has non - zero multipoles , in the limit of large @xmath86 , @xmath263 for @xmath87 even , where @xmath264 are modified bessel functions .",
    "note that beam asymmetry is only significant for @xmath265 .",
    "the multipoles for a detector whose iso - directivity ellipse has major axis at angle @xmath266 to @xmath42 pick up an additional phase @xmath267 .",
    "the expression for @xmath268 ( equation  [ eq:38 ] ) involves the sum @xmath269 . for large @xmath86 ,",
    "this is easily evaluated by substituting the integral representation of the modified bessel functions ( or , equivalently , azimuthally averaging the absolute square of the flat - space fourier transform of the directivity ) .",
    "the result is @xmath270 so that @xmath271 .",
    "\\label{eq:53}\\end{aligned}\\ ] ] if a known beam asymmetry is to be accounted for with pixel - based map - making techniques , it is necessary to include the asymmetry in the real - space pointing matrix .",
    "a simpler procedure suggests itself for the case of randomly positioned rings , where we can exploit the fact that every pixel is sampled with each detector in every orientation . averaging the data in each pixel from a given detector gives an unbiased estimate of the pixelised sky smoothed with an effective window function .",
    "this window function follows from azimuthally averaging the beam , so that @xmath272 the analysis of the smoothed maps proceeds as in section  [ subsec : random ] , so that the inverse covariance matrix evaluates to @xmath273 . \\label{eq:55}\\end{aligned}\\ ] ] clearly there is some information loss on averaging the data in the manner described . for a single detector ,",
    "the ratios of the diagonal elements of the covariance matrices obtained from equations  ( [ eq:53 ] ) and ( [ eq:55 ] ) are @xmath274 this information loss is only significant on scales below that of the beam asymmetry ( @xmath275 ) . for more general",
    "scanning , averaging data in a pixel will necessarily produce a biased estimate of the sky in the presence of a beam asymmetry . this will be most acute for scanning strategies where a large number of pixels are sampled with the detectors in only a narrow range of orientations .",
    "such strategies include constant latitude scanning , to which we now turn .",
    "to analyse constant latitude scanning , we consider equation  ( [ eq:35 ] ) under the restriction @xmath276 . following the discussion at the start of section  [ subsec : random ] ,",
    "we consider the continuum limit . for constant latitude scans we replace the sum over rings by @xmath277 \\int { { { \\mathrm{d}}}}\\phi_r$ ] .",
    "expanding the @xmath78-matrices as in equation  ( [ eq:9 ] ) and performing the integral over @xmath278 , the expression for @xmath210 reduces to @xmath279 @xmath280 where the sum is over detectors and @xmath212 .",
    "we obtain uncorrelated errors between modes with different @xmath87 due to the azimuthal symmetry of the sky coverage  @xcite .",
    "since @xmath210 is block - diagonal , it can be inverted in @xmath281 operations . in practice , variations in the instrument parameters through the mission will spoil this exact block - diagonal structure , as will any precession in the latitude @xmath282 .",
    "however , approximating @xmath210 by its diagonal blocks may still provide an adequate preconditioner for e.g.  a conjugate gradient reconstruction of the sky .    in equation  ( [ eq:56 ] )",
    ", @xmath283 refers to the weight per solid angle for uniform coverage of the whole sky , which differs from the pixel - dependent @xmath253 due to the variation in time spent per solid angle . by differentiating the geometric relation @xmath284 which relates the polar angle @xmath238 of the pixel containing the main beam to the ring phase @xmath33 , it is straightforward to show that @xmath285 where @xmath109 is the heaviside unit step function , and we have introduced the quantity @xmath286 for later convenience .    to proceed further , we make the assumption that the detector sensitivities and ring opening angles are all equal , so that @xmath287 , @xmath288 , and @xmath289 .",
    "it follows that the pixel - dependent weight per solid angle is also independent of detector : @xmath290 .",
    "the sum over detectors in equation  ( [ eq:56 ] ) then reduces to @xmath291 .",
    "\\label{eq:60}\\end{aligned}\\ ] ] we further assume that all detectors have axisymmetric , co - polar beams which are equivalent up to rotations about the beam axis . in this case , the multipoles are given by equations  ( [ eq:39])([eq:41 ] ) with the angles @xmath231 determining the relative polarization orientations .",
    "the choice of angles @xmath231 has a strong impact on the covariance structure of the estimated multipoles . designing the focal plane so that @xmath292 ensures that the errors are uncorrelated between the total intensity and the linear polarization .",
    "the correlation between the @xmath21 and @xmath22 multipoles is controlled in part by the sum @xmath293 , although demanding that this sum vanish is not a sufficient condition to ensure uncorrelated errors between @xmath21 and @xmath22 .",
    "however , the condition @xmath294 does ensure uncorrelated errors between the smoothed stokes fields ) and ( [ eq:45 ] ) .",
    "we have dropped the subscript @xmath31 since we are assuming that the beam window functions are the same for all detectors . ]",
    "@xmath295 and @xmath296 which , under the stringent restrictions adopted in this section , can be estimated in an optimal manner by a @xmath297 fitting of the data from all detectors obtained when the main beam of each lies in the given pixel  @xcite .",
    "the smoothed maps estimated in this manner have uncorrelated errors between pixels with weights per solid angle @xmath298 for @xmath299 , and @xmath300 for @xmath301 and @xmath302 , where , recall , @xmath303 is the number of detectors . following couchot et al .",
    ", we denote arrangements of polarimeters with @xmath304 and @xmath305 as optimal configurations .",
    "in such a configuration , the non - vanishing components of the inverse covariance matrix evaluate to @xmath306\\ } , \\label{eq:62 } \\\\",
    "\\tilde{c}^{-1}_{(lmg)(l'm'c ) } & = & -i \\delta_{mm ' } w n_{{{\\mathrm{d } } } } \\ , { } _ 2w_l \\ , { } _ 2w_{l ' } \\sqrt{(2l+1)(2l'+1 ) } \\nonumber \\\\ & & \\times \\sum_n \\{d^l_{mn}(\\theta ) d^{l'}_{m'n}(\\theta ) { \\textstyle{\\frac{1}{2 } } } [ d^l_{n2}(\\alpha ) d^{l'}_{n2}(\\alpha ) \\nonumber \\\\ & & \\mbox{}\\phantom{\\sum_n \\{}-",
    "d^l_{n\\ , -2}(\\alpha ) d^{l'}_{n\\ , -2}(\\alpha)]\\ } , \\label{eq:63}\\end{aligned}\\ ] ] with @xmath307 . in equations  ( [ eq:61])([eq:63 ] ) ,",
    "the sums are over @xmath212 .",
    "we show in appendix  [ app : map ] that the sum over @xmath120 on the right - hand sides of equations  ( [ eq:61])([eq:63 ] ) can be reduced to matrix elements of the time spent per solid angle with the appropriate spin weight basis : @xmath308 for integer @xmath243 . using this result in equations  ( [ eq:61])([eq:63 ] ) , and recalling equation  ( [ eq:58 ] )",
    ", the components of the inverse covariance matrix can be reduced to @xmath309 , \\label{eq:66 } \\\\",
    "\\tilde{c}^{-1}_{(glm)(cl'm ' ) } & = & i\\ , { } _ 2w_{l}\\ , { } _ 2w_{l ' } \\int [ w_{p } { \\textstyle{\\frac{1}{2}}}({}_2y_{(lm)}^\\ast { } _ 2y_{(l'm ' ) } \\nonumber \\\\ & & \\phantom{{}_2w_{l}\\ , { } _ 2w_{l ' } } - { } _ { -2}y_{(lm)}^\\ast{}_{-2}y_{(l'm ' ) } ) \\ , { { { \\mathrm{d}}}}\\omega_p ] .\\label{eq:67}\\end{aligned}\\ ] ] note that these results automatically take account of incomplete sky coverage , through the presence of @xmath310 . the function @xmath311 in pixels that are not sampled by the main beam during the mission ,",
    "so such pixels make no contribution to the covariance matrix .",
    "as noted in section  [ subsec : ml ] , the presence of unsampled regions can render @xmath210 numerically singular .",
    "for the _ planck _ mission the nominal ring opening angle @xmath312 , which would leave @xmath313 holes at the ecliptic poles for constant latitude scanning in the ecliptic .",
    "however , a proposal to precess the spin axis out of the ecliptic plane with an amplitude of @xmath314 has the benefit of providing complete sky coverage , which would render @xmath210 invertible ( although no longer block - diagonal ) .    to compare equations  ( [ eq:65])([eq:67 ] ) with the results obtained from a pixelised map",
    ", we can make use of equations  ( [ eq:47])([eq:49 ] ) which , it will be recalled , give the errors on the maximum - likelihood solution for the multipoles obtained from @xmath303 sets of smoothed maps . here , we have only one map ( estimated using data from all detectors as described above ) , with weights per pixel @xmath315 for @xmath299 and @xmath316 for @xmath301 and @xmath302 . with these conditions , it is straightforward to verify that equations  ( [ eq:47])([eq:49 ] ) reduce to pixelised versions of equations  ( [ eq:65])([eq:67 ] ) .",
    "this observation confirms the statistical equivalence of the map - based and harmonic routes through to the multipoles of the sky for constant latitude scanning , under the strong restrictions adopted in this section .",
    "more generally , since the maps and their multipoles contain the same information ( disregarding pixelisation errors ) , it will always be the case that the optimal map - making and map - to - multipole algorithms are statistically equivalent to the optimal harmonic estimate of the multipoles .",
    "however , as demonstrated in section  [ sec : hdm ] , the harmonic model provides a more natural framework for the inclusion of a number of systematic effects in the instrument modelling and data analysis pipeline .",
    "the inclusion of some such effects is essential to maintain the integrity of the final data products .",
    "in this section we discuss a number of important issues that arise during the map - making stage .",
    "the treatment of low frequency noise ( ` destriping ' ) in the harmonic model is described in section  [ subsec : stripes ] . in section  [ subsec :",
    "sync ] we comment on the control of scan - synchronous instrument effects , focusing on straylight from bright sources picked up through the sidelobes of the telescope , and the modulation of the dipole in the rest - frame of the experiment .",
    "finally , the overall calibration of the experiment to external standards is described in section  [ subsec : gain ] .      in section  [ subsec : noise ]",
    "we established that for large @xmath317 , the main impact of noise power at frequencies below the spin frequency is concentrated at the @xmath151 fourier modes of the phase - ordered data ( see also , e.g.  delabrouille 1998 ) .",
    "if the noise power varies sufficiently rapidly in the range @xmath318 these offsets may be correlated between rings .",
    "careful treatment of low frequency noise is essential to avoid undesirable long range noise correlations ( ` stripes ' ) in the maps . given the difficulty of inverting the time - time noise covariance matrix in the presence of low frequency noise , additional pre - processing steps are usually performed prior to map - making . pre",
    "- whitening the time- or phase - ordered data ( e.g.  tegmark 1997 ) uses a prior knowledge of the noise power spectrum , @xmath133 , to represent the data in a basis where there are no noise correlations . in essence , this involves the subtraction of an optimal offset from each ring of data .",
    "natoli et al .",
    "have successfully applied this method to the 30 ghz channel of the _ planck _ low frequency instrument under the assumption of a symmetric beam profile .",
    "other destriping methods advocated for the _ planck _ mission , e.g.  delabrouille   and revenu et al .  , also involve the subtraction of offsets from the rings , but these offsets are obtained directly from the data by exploiting the intersections of rings .    the harmonic model represents the phase - ordered data in the fourier basis on rings which ensures that the noise covariance matrix , @xmath171 , is very sparse , even in the presence of significant low frequency power .",
    "this removes the need for any additional pre - whitening .",
    "a potential problem arises if the noise power spectrum is not known accurately at low frequencies , since this may compromise the quality of the sky reconstruction .",
    "the harmonic model suggests a simple solution to this problem : remove the @xmath151 fourier modes from the analysis . from a bayesian viewpoint",
    ", we must now infer the @xmath161 from a knowledge of @xmath55 with @xmath319 .",
    "this inversion requires the probability density function ( pdf ) for @xmath320 with @xmath319 , which is obtained from the full pdf by integrating over the @xmath151 modes .",
    "however , for gaussian noise , the pdf factors into products of pdfs for the individual fourier modes as a consequence of equation  ( [ eq:24 ] ) , so that integrating over the @xmath151 modes is trivial . note also that since the @xmath151 modes of the data are the only ones that depend on the @xmath321 modes of the total intensity and circular polarization , these monopole modes can no longer be reconstructed . to implement the scheme one can either reformulate the problem with the @xmath151 data modes removed at the outset , or , equivalently ,",
    "let @xmath322 , and perform the inversion in the subspace orthogonal to @xmath323 and @xmath324 .",
    "removing the @xmath151 modes does not bias the solution , but it is no longer optimal given all the data , since @xmath325 receives a contribution from all multipoles .",
    "however , for large @xmath163 the information loss should be small for the @xmath326 multipoles . excluding the @xmath151 modes",
    "provides a very robust , simple way of removing undesirable long range correlations in the maps that might arise if the low frequency noise were estimated inaccurately .",
    "note also that this ` destriping ' method handles the polarization signal seamlessly , avoiding the technicalities involved in estimating offsets from ring intersections for polarized detectors  @xcite . removing the @xmath151 and @xmath321 modes from the analysis",
    "also neatly solves the problem of degeneracy that arises if the experiment is insensitive to the monopole  this situation may arise for the _ planck _ hfi since the favoured readout electronic system is insensitive to very low frequencies  @xcite .",
    "instrument effects that produce signals synchronous with the rotation of the instrument will not be suppressed by co - adding the time - ordered data to form the phase - ordered data .",
    "given complete knowledge of the instrument response , these potential sources of systematic error can be controlled by adopting a more refined model of the instrument response during the reconstruction of the sky . in this subsection",
    "we discuss the removal of two potential systematic effects within the context of the harmonic data model .      an important source of systematic error is straylight from e.g.  the galaxy and the cmb dipole entering the instrument through the sidelobes of the telescope .",
    "here , the difficulty lies not in the inclusion of the sidelobes in the reconstruction process , since the harmonic model allows for a complete description of the beams , but rather in the limited knowledge of the sidelobes that will be available from simulations and from in - flight calibrations  @xcite .",
    "although the sidelobes can be expected to be highly polarized , the direction should be sufficiently random that it is adequate to model only the directivity @xmath327 in the sidelobes .",
    "delabrouille et al .   have proposed an iterative scheme for estimating sidelobe corrections . in their method ,",
    "an estimate of the sky is obtained from a first pass of the map - making algorithm ignoring sidelobe corrections , and this is then used to compute the difference between the observed time - ordered data and the contribution of the sky coming through the main beam .",
    "this difference is attributable to instrument noise and the sidelobe signal , and can be inverted ( with suitable regularisation ) to estimate the values of the directivity in the sidelobe pixels . with this improved knowledge of the beam , and the original estimate of the sky , an estimate of the sidelobe contribution",
    "can be subtracted from the time - ordered data , and an improved estimate of the sky obtained from a further pass of the original map - making algorithm ( again with sidelobes ignored ) .",
    "this process can be iterated to give consistent estimates of the sky and the directivity in the sidelobe .",
    "it should be possible to implement a similar scheme in the harmonic model , with the sidelobes parameterised by a modest number of multipoles and the sidelobe contribution estimated from the @xmath55 , although we have not attempted this yet .",
    "one potential problem with such a scheme is that the sidelobes may contain rather sharp features due to geometrical effects , in which case a parameterisation of the sidelobes with spherical multipoles may not be ideal .",
    "the monopole @xmath328 should not be varied during sidelobe reconstruction since its value is fixed at @xmath329 by definition .",
    "the iterative reconstruction of the sidelobes does not require an absolute calibration of the detector gains , and should be performed prior to the calibration procedures described in section  [ subsec : gain ] .",
    "one subtlety that we have overlooked so far , which is significant for survey missions from space , is the variation of satellites ( linear ) velocity during the year .",
    "the orbital velocity of the earth about the sun @xmath330 , which induces a yearly modulation in the multipoles seen in the satellite s rest frame . for sensitivities equivalent to the _ planck _",
    "mission ( a few @xmath331 in @xmath332 pixels at 100 ghz , for twelve months of observation ) , the most significant effect is the modulation of the intensity dipole due to the monopole with amplitude @xmath333 .",
    "if we denote the multipoles in the frame of the satellite by @xmath334 , and continue to denote the multipoles on the @xmath335 basis fixed relative to the solar system by @xmath336 , we have @xmath337 \\nonumber \\\\ & & \\mbox{}\\times\\int { \\bmath{v}}\\cdot \\bmath{e } y_{(lm)}^\\ast(\\bmath{e } ) \\ , { { { \\mathrm{d}}}}\\omega , \\label{eq:68}\\end{aligned}\\ ] ] where @xmath338 is the ( time - dependent ) velocity of the earth relative to the sun , and @xmath339 is a unit vector .",
    "the @xmath334 are defined relative to a basis obtained by lorentz boosting the @xmath335 basis .",
    "aberration effects on the high @xmath86 multipoles may also be significant for _ planck _ ( challinor & van leeuwen , in preparation ) .",
    "it is the time - dependent multipoles @xmath340 ( obtained by averaging @xmath334 across the spectral filter ) which should now appear in equation  ( [ eq:20 ] ) , relating the signal to the sky .",
    "however , we must still solve for the time - independent multipoles @xmath161 .",
    "if the monopole @xmath341 were available at the start of the analysis for all frequency channels , the contribution of the time - dependent part of @xmath334 to the signal could be subtracted from the @xmath55 prior to solving for the multipoles .",
    "note that this process only affects the @xmath151 and @xmath342 fourier modes , @xmath55 , but these influence all multipoles of the reconstructed sky .",
    "more realistically , the monopole @xmath341 may only be poorly determined prior to the analysis , in which case it will be necessary to iterate the estimation of the multipoles , using the monopole determined in the previous iteration to correct the @xmath55 .",
    "this process is clearly not possible if the @xmath151 modes are ignored in the analysis , as may be necessary for the reasons discussed in section  [ subsec : stripes ] .",
    "a radical way to circumvent the problems of poorly determined low frequency noise and dipole modulation is to remove the @xmath342 modes from the analysis also .",
    "however , an internally reconstructed dipole appears to be essential for establishing an absolute normalisation of the experiment ( see next subsection ) .",
    "the methods described by van leeuwen et al .   for producing internally consistent ring - sets do not provide an absolute gain calibration for each detector . by forgoing the introduction of any external flux calibrator during the reconstruction of the ring - sets ,",
    "only the ratios of the gains of all detectors in a given frequency band will be known ; the absolute gains will only be determined up to an overall factor , @xmath343 .",
    "this factor is defined to be the ratio of the true gains , @xmath344 , to those assumed in the model of the instrument , @xmath110 ( e.g.  equation  [ eq:19 ] ) .",
    "an external calibrator provides prior information on the sky , @xmath345 , which can be used to constrain @xmath343 . for simplicity ,",
    "we assume a gaussian prior : @xmath346 , \\label{eq:69}\\ ] ] where @xmath347 is the most likely prior sky , and @xmath348 is the associated error .",
    "the sky and normalisation can be now estimated directly from the ( fourier ) ring data , @xmath168 , by maximising @xmath349 ( assuming a uniform prior on @xmath343 ) . in the usual limit where the experiment determines the sky to much better precision than the calibrator ,",
    "the best estimate of the sky is @xmath350 , where @xmath166 is the maximum - likelihood estimate for the sky given in equation  ( [ eq:28 ] ) , obtained with gains @xmath110 , and the best estimate of the normalisation is given by @xmath351 in practice , @xmath352 and @xmath353 may have to be estimated from existing observations on patches of the sky .",
    "in such cases , equation  ( [ eq:70 ] ) reduces to the solution obtained by minimising the ( error - weighted ) residuals between the reconstructed map , @xmath354 , and the calibration map .",
    "the requirement that the calibration maps be at the same frequencies as the instrument channels can be removed by selecting a large patch , at high galactic latitude , where the large - scale signal is dominated by the cmb dipole .",
    "although the main focus of this paper is the reconstruction of frequency maps of the sky in multipole space , in this section we offer some comments on the subsequent analysis of these maps into their astrophysical components , and estimated power spectra .",
    "the frequency maps contain contributions from a number of astrophysical components which must be separated on the basis of their assumed frequency spectra ( and possibly power spectra ) .",
    "unresolved radio sources require separate processing since they can not be accurately modelled as a population with a single frequency spectrum .",
    "if bright point sources were not removed from the ring - sets prior to map - making , their contribution should be filtered from the multipoles before attempting component separation  @xcite . within the timescale of _ planck _",
    ", the majority of point sources expected to be visible in the 857 ghz channel of the hfi should already have been catalogued prior to launch by the _ astro - f _",
    "such catalogues will be valuable for the geometrical calibration of the ring - sets using the positions of identified point - sources  @xcite , and also for the removal of point sources from the reconstructed frequency maps .",
    "if bright point sources have already been removed from the ring - sets prior to map - making , component separation can proceed directly from the reconstructed multipoles .",
    "however , statistical reconstruction of faint point sources may still be desirable , in which case the faint point sources can be included as a generalised noise in the separation algorithm for the other astrophysical components  @xcite .    the full - sky , maximum - entropy component separation algorithm developed recently by stolyarov et al",
    ".   performs the separation in the spherical multipole basis , so that it can use the outputs of the multipole estimation process described here directly .",
    "although the algorithm of hobson et al .  does not handle polarization in its current form , the extension to polarized components should be straightforward .",
    "( the wiener separation of polarized components has been implemented successfully by bouchet , prunet & sethi 1999 for small patches of sky . ) a more demanding problem for high resolution , all - sky separation algorithms is the inclusion of non - isotropic noise , since then the separation can not be performed multipole by multipole due to the correlated errors ( e.g.  prunet et al .",
    "2001 ) .",
    "power spectrum estimation can also be performed efficiently in multipole space .",
    "the simplest , unbiased estimator which is quadratic in the estimated dimensionless multipoles @xmath234 is of the form @xmath355 the variance of this estimator is calculated in kamionkowski et al .   under the assumptions of full sky coverage and isotropic pixel noise which is uncorrelated between stokes parameters .",
    "in this case , the quadratic estimator in equation  ( [ eq:71 ] ) is equivalent to the maximum - likelihood estimator .    for more general noise properties and scan strategies the estimator in equation  ( [ eq:71 ] )",
    "is sub - optimal .",
    "maximum - likelihood techniques have been developed which allow accurate computation of the temperature power spectrum in @xmath281 operations for scanning strategies with ( near ) azimuthal symmetry  @xcite .",
    "this method can not be directly in the context of the harmonic model since oh et al .",
    "store the inverse ( noise ) covariance matrix , @xmath178 , in the pixel basis only , where they assume it is diagonal .",
    "forward and inverse fast spherical transforms are then employed to apply @xmath178 efficiently in multipole space . applying @xmath178 directly in multipole space",
    "would not increase the overall operations count significantly , but would increase the memory requirements to @xmath281 in general .",
    "one potential issue in power spectrum estimation is the treatment of regions near to the galactic plane . although component separation algorithms can reconstruct the cmb very well even at low galactic latitude ( stolyarov et al .",
    "2001 ) , it may still be necessary to remove traces of the galaxy by brute force . given a pixelised map , the pixels near the plane can be excised from the analysis before estimating the multipoles and their error covariance , and subsequent power spectrum estimation .",
    "( alternatively , power spectrum estimation can be performed directly in real space away from the galactic plane , although the lack of a sparse signal covariance matrix in the pixel representation is problematic for high resolution data - sets . )    within the context of the harmonic model , the galactic plane can be dealt with by projecting the reconstructed multipoles , @xmath356 , into a subspace which is ( almost ) free from galactic contamination . for simplicity",
    ", we shall only describe the procedure for a total power measurement ; the extension to polarized data is straightforward .",
    "we define the hermitian matrix @xmath357 to have components @xmath358 where the integral is over the region of the sky that we wish to retain in the analysis . in the limit",
    "@xmath359 , @xmath360 are the matrix elements of a projection operator ( i.e.  @xmath361 ) which projects functions into the region @xmath362 . for finite @xmath363",
    ", @xmath357 is almost a projection operator since the distribution of its eigenvalues is almost bimodal with values clustered close to zero and one  @xcite .",
    "the fraction of eigenvalues close to unity is approximately the fraction of the sky retained ; the remainder are nearly all zero . performing ( maximum - likelihood ) power spectrum estimation with the data object @xmath364 would not remove the galactic contamination since @xmath357 is ( formally ) invertible . to enforce rejection of the galaxy ,",
    "we introduce a projection operator @xmath365 which is obtained from @xmath357 by retaining the eigenvectors but setting those eigenvalues greater then @xmath366 to unity , and to zero otherwise .",
    "the choice of threshold , @xmath367 , must be determined from simulations to ensure good rejection of the galaxy while minimising the number of modes lost from the analysis . working with @xmath368",
    "ensures that we have projected out those modes of @xmath166 which are ( nearly ) localised in the region external to @xmath362 .",
    "this procedure is similar to power spectrum estimation from the cut map , since projecting pixelised data into @xmath362 in real space has the effect of greatly amplifying the noise on the multipoles estimated from the cut map along those directions in multipole space which correspond to functions nearly localised in the cut . in practice",
    ", it is likely to be more efficient to represent the projected data vector @xmath368 on a basis adapted to the region @xmath362 , so that we work with the object @xmath369 , where @xmath370 is the ( non - square ) matrix whose columns are the eigenvectors of @xmath365 with unit eigenvalue .",
    "the matrix @xmath370 can easily be obtained from a singular value decomposition of @xmath365  @xcite .",
    "most current techniques for analysing cmb data on the sphere are based on the use of pixelised maps .",
    "the basis for a complementary approach , based on spherical harmonic coefficients of the intensity and polarization , has been derived here for the case of experiments that scan the full sky in circles .",
    "our method offers a number of advantages , most notably the refined treatment of non - ideal beam effects , the ability to handle correlated ( low frequency ) noise in an optimal , but efficient , manner , and the seamless way in which polarized data can be analysed alongside total intensity data . in principle",
    ", harmonic methods can be used to develop an end - to - end pipeline for the analysis of full - sky survey data , allowing the clean propagation of noise and other errors from the time - ordered data to the cmb power spectra . in practice ,",
    "the methods described here are best regarded as being complementary to more standard map - based techniques rather than a replacement .",
    "undoubtly , there are analysis projects that are better suited to map - based techniques  typically those concerned with the science of local features in the maps , such as foregrounds . in addition",
    ", power spectrum estimation becomes cumbersome with purely harmonic methods if we have reason to question the foreground contamination of certain linear combinations of the spherical multipoles ( e.g.  those corresponding to features localised in the galactic plane ) .",
    "the biggest hurdle facing a practical implementation of the harmonic ` map'-making method at the resolution demanded by the upcoming satellite missions , is the need to solve the @xmath371 linear system in equation  ( [ eq:28 ] ) . unlike conventional map - making in the presence of noise correlations ,",
    "the problem lies not in the inversion of the noise covariance matrix , since we are working in a representation where this matrix is already very sparse .",
    "the inversion of @xmath372 can be avoided by adopting iterative techniques with a block - diagonal preconditioner .",
    "the main computational overhead arises from computing and storing the large , non - sparse matrix @xmath169 and applying it to the sky multipoles and its transpose to the fourier ring data .",
    "these operations can be performed very efficiently using fast fourier transform techniques for the rather idealised case of constant latitude scanning , with rings uniformally spaced in azimuth and no variations in instrument properties during the mission  @xcite .",
    "unfortunately , it does not appear that such techniques can be easily extended to more realistic scan strategies .",
    "an assessment of some of these numerical problems , together with a number of potential solutions , will be given in mortlock et al .",
    "( in preparation ) .",
    "this work benefited from useful discussions with several members of the cambridge planck analysis centre , in particular martin bucher , rob crittenden , and neil turok .",
    "adc acknowledges a pparc postdoctoral fellowship ; djm and maja are funded by pparc",
    ".    99    bond j.  r. , jaffe a.  h. , knox l. , 1998 , phys .",
    "d , 57 , 2117    bond j.  r. , crittenden r.  g. , jaffe a.  h. , knox l. , 1999 , computing in science and engineering , 1(2 ) , 21    borrill j. , 1999 , in maiani l. , melchiorri f. , vittorio n. , eds , 3k cosmology : ec - tmr conference .",
    "american institute of physics , new york , p.  277",
    "bouchet f.  r. , prunet s. , sethi s.  k. , 1999 , mnras , 302 , 663    brink d.  m. , satchler g.  r. , 1993 , angular momentum , 3rd edn .",
    "clarendon press , oxford    burigana c. , natoli p. , vittorio n. , mandolesi n. , bersanelli m. , 2001 , a&a , submitted ( astro - ph/0012273 )    challinor a. , fosalba p. , mortlock d. , ashdown m. , wandelt b. , grski k. , 2000 , phys .",
    "d , 62 , 123002    coble k.  et al .",
    ", 1999 , apj , 519 , l5    de bernardis p.",
    "et al . , 2000 , nature , 404 , 955    couchot f. , delabrouille j. , kaplan j. , revenu b. , 1999 , a&as , 135 , 579    delabrouille j. , 1998 , a&as , 127 , 555    delabrouille j. , grski k.  m. , hivon e. , 1998a , mnras , 298 , 445    delabrouille j. , gispert r. , puget j .-",
    ", 1998b , in trn thanh vn t. , giraud - hraud y. , bouchet f. , damour t. , mellier y.  eds , fundamental parameters in cosmology .",
    "editions frontieres , paris , p.  263",
    "de oliveira - costa a. , kogut a. , devline m.  j. , netterfield c.  b. , page l.  a. , wollack e.  j. , 1997 , apj , 482 , l17    gaertner s.  et al . , 1997 ,",
    "a&as , 126 , 151    goldberg j.  n. , macfarlane a.  j. , newman e.  t. , rohrlich f. , sudarshan e.  c.  g. , 1967 , j. math .",
    ", 8 , 2155    grski k.  m. , 1994 , apj , 430 , l85    hanany s.  et al . ,",
    "2000 , apj , 545 , l5    hobson m.  p. , jones a.  w. , lasenby a.  n. , bouchet f.  r. , 1998 , mnras , 300 , 1    hobson m.  p. , barreiro r.  b. , toffolatti l. , lasenby a.  n. , sanz j.  l. , jones a.  w. , bouchet f.  r. , 1999 , mnras , 306 , 232    janssen m.  a.  et al . , 1996 ,",
    "preprint ( astro - ph/9602009 )    knox l. , 1995 , phys .",
    "d , 52 , 4307    kamionkowski m. , kosowsky a. , stebbins a. , 1997 , phys .",
    "d , 44 , 7368    lee a.  t.  et al .",
    ", 2001 , apj , submitted ( astro - ph/0104459 )    leitch e.  m.  et al . , 2001 , apj , submitted ( astro - ph/0104488 )    mortlock d.  j. , challinor a.  d. , hobson m.  p. , 2001",
    ", mnras , submitted ( astro - ph/0008082 )    natoli p. , de gasperis g. , gheller c. , vittorio n. , 2001 , a&a , 372 , 346    netterfield c.  b. , devlin m.  j. , jarosik n. , page l. , wollack e.  j. , 1997 , apj , 474 , 47    netterfield c.  b.  et al . , 2001 ,",
    "apj , submitted ( astro - ph/0104460 )    ng k. , liu g. , 1999 , int . j. mod .",
    "d , 8 , 61    oh s.  p. , spergel d.  n. , hinshaw g. , 1999 , apj , 510 , 551    padin s.  et al .",
    ", 2001 , apj , 549 , l1    press w.  h. , teukolsky s.  a. , vetterling w.  t. , flannery b. p. , 1992",
    ", numerical recipes : the art of scientific computing , 2nd edn .",
    "cambridge univ .",
    "press , cambridge    prunet s. , teyssier , r. , scully s.  t. , bouchet f.  r. , gispert r. , 2001 , a&a , 373 , l13    revenu b. , kim a. , ansari r. , couchot f. , delabrouille j. , kaplan j. , 2000 , a&as , 142 , 499    scott p.  f.  et al . , 1996 , apj , 461 , l1    smoot g.  f.  et al . , 1992 ,",
    "apj , 396 , l1    stolyarov v. , hobson m.  p. , ashdown m.  a.  j. , lasenby a.  n. , 2001 , mnras , submitted ( astro - ph/0105432 )    tanaka s.  t.  et al . , 1996 , apj , 468 , l81    tegmark m. , efstathiou g. , 1996 , mnras , 281 , 1297    tegmark m. , 1997 , phys .",
    "d , 56 , 4514    tegmark m. , de oliveira - costa a. , 2001 , phys .",
    "d , 64 , 063001    van leeuwen f.  et al .",
    ", 2001 , mnras , in press ( astro - ph/0112276 )    varshalovich d.  a. , moskalev a.  n. , khersonskii v.  k. , 1988 , quantum theory of angular momentum .",
    "world scientific , singapore    vielva p. , barreiro r.  b. , hobson m.  p. , martinez - gonzalez e. , lasenby a.  n. , sanz j.  l. , toffolatti l. , 2001 , mnras , submitted ( astro - ph/0105387 )    wandelt b.  d. , hansen f.  k. , 2001 , phys .",
    "d , submitted ( astro - ph/0106515 )    wandelt b.  d. , grski k.  m. , 2001 , phys .",
    "d , 63 , 123002    wandelt b.  d. , hivon e. , grski k.  m. , 2001 , phys . rev .",
    "d , 64 , 083003    wilson g.  w.  et al . , 2000 , apj , 532 , 57    wu j.  h.  p.  et al .",
    ", 2001 , apjs , 132 , 1",
    "in this appendix we discuss the systematic error that arises from ignoring the variation of the beam multipoles with frequency across a spectral band when analysing microwave data . this question does not appear to have received much attention so far in the cmb literature .",
    "for simplicity , we consider a single detector which is only sensitive to the total intensity .",
    "we take the beam profile to be an axisymmetric gaussian , with frequency - dependent beam width @xmath373 , so that for @xmath374 we have @xmath375 where the scalar window function is @xmath376 .",
    "\\label{eq : a2}\\ ] ] assuming that the beam is diffraction limited , we expect the frequency dependence of the beam width to go like @xmath377 , where @xmath378 is the beam width at the central frequency of the band . for @xmath379",
    "this gives @xmath380 which also holds more generally for arbitrary beams which scale inversely with frequency along longitudes .    if the cmb is the dominant physical component in the frequency band under consideration , the frequency spectrum of the brightness anisotropies in linear theory is @xmath381 for @xmath326 , where @xmath206 is the planck function and @xmath201 is the average cmb temperature over the sky .",
    "the @xmath382 , which describe the dimensionless anisotropy in the thermodynamic temperature of the sky , are independent of frequency for the cmb .",
    "we further restrict attention to white noise , assume uniform coverage of the spin axis pointing over the entire sky , and ignore any systematic variation in focal plane geometry . then , if we attempt to solve for the @xmath382 , but ignore the variation of @xmath383 with frequency , the maximum - likelihood solution returns a biased estimate @xmath384 which has the form @xmath385 where the fractional bias @xmath386 and the dimensionless random errors @xmath387 have zero mean , and covariance @xmath388 here , @xmath389 is the dimensionless weight per solid angle  ( knox 1995 ; see also section  [ sec : scan ] ) .",
    "we can use the @xmath384 to estimate the cmb power spectrum @xmath390 with the estimator @xmath391 which would be unbiased if @xmath392 were zero . the fractional systematic error in our estimate of @xmath390",
    "is therefore @xmath393 while there is a fractional random error @xmath394 .",
    "\\label{eq : a10}\\ ] ] the first term in brackets on the right - hand side of equation  ( [ eq : a10 ] ) is cosmic variance . if instead we asked how well we could reconstruct the rotational - invariant @xmath395 for our given realisation of the sky , the cosmic variance term would not be present .",
    "the latter situation is the more relevant for mapping other astrophysical foreground components .    in fig .",
    "[ fig : beam ] we plot the systematic and random errors on the cmb power spectrum for the 100 , 143 , and 217 ghz channels of the _ planck _ hfi , using the predicted instrument specifications .",
    "the spectral filter @xmath84 is assumed to be a top hat with fractional width @xmath396 .",
    "it is clear that in the 100 ghz channel , the systematic error due to our neglect of the variation of beam width across the spectral band is non - negligible compared to the random error due to instrument noise over a broad range of @xmath86 . for an axisymmetric beam",
    "the effect can be easily accounted for by including the frequency - dependent window function @xmath383 in the integral over frequency , since the integral @xmath397 would still factor into a part depending on the sky with indices @xmath86 and @xmath87 only , as required for subsequent analysis .",
    "however , for a non - axisymmetric beam where the variation of @xmath398 can not be reduced to a frequency - dependent factor with only an @xmath86 index , and a constant part with @xmath86 and @xmath88 indices , we can no longer integrate the variation of beam with frequency and still preserve the factorisation of the sky .",
    "note that if there is only an effective beam asymmetry , arising from skewing a symmetric beam with the temporal response of the instrument , the above comments do not apply since the frequency dependence of the effective beam will factor .",
    "in this appendix we establish the result given as equation  ( [ eq:64 ] ) in the main text , which relates the geometry of the ring - set to the observing time per solid angle on the sky .",
    "the first step is to replace the single summation @xmath399 on the left - hand side of equation  ( [ eq:64 ] ) with the double summation @xmath400 , and to replace the labels @xmath401 by @xmath402 in the argument of the summation . denoting the left - hand side of equation  ( [ eq:64 ] ) by @xmath403",
    ", we now have @xmath404 , \\label{eq : b1}\\end{aligned}\\ ] ] where we have suppressed the limits on the summations .",
    "we now use the orthonormality of the spin - weighted harmonics , @xmath405 to replace the kronecker deltas in equation  ( [ eq : b1 ] ) with the integral of spin - weight @xmath406 harmonics over the sphere .",
    "the term @xmath407 can be expressed in terms of @xmath78-matrices using equation  ( [ eq:46 ] ) : @xmath408 where we have also used @xmath409 ( e.g.  brink & satchler 1993 ) , so that @xmath410 \\nonumber \\\\ & & \\mbox{}\\times d^l_{mn}(\\theta)d^l_{ns}(\\alpha)\\}\\ , { { { \\mathrm{d}}}}\\omega_p .",
    "\\label{eq : b4}\\end{aligned}\\ ] ] if we now reverse the order of summation in equation  ( [ eq : b4 ] ) using @xmath411 the summation over @xmath402 can be performed with the ponzano - regge sum rule ( e.g.  varshalovich , moskalev & khersonskii 1988 ; equation 21 , p.  89 ) : @xmath412 where @xmath413 is given by equation  ( [ eq:59 ] ) , and the angles @xmath414 , @xmath415 , and @xmath416 are defined by the @xmath217 composition @xmath417 ( the angles are given explicitly by varshalovich et al .",
    "1988 , but it is straightforward to show that their definitions are equivalent to the implicit definition given here . ) finally , we can perform the remaining sum over @xmath120 in equation  ( [ eq : b4 ] ) by writing @xmath418 as the real part of @xmath419 $ ] , and combining the complex exponentials with the remaining @xmath31-functions to get @xmath420 where we have used equation  ( [ eq : b7 ] ) in the last equality .",
    "the remaining terms in equation  ( [ eq : b4 ] ) combine with @xmath421 to give @xmath422 on using equation  ( [ eq : b3 ] ) .",
    "our final result is @xmath423 which establishes equation  ( [ eq:64 ] ) ."
  ],
  "abstract_text": [
    "<S> despite the fact that the physics of the cosmic microwave background anisotropies is most naturally expressed in fourier space , pixelised maps are almost always used in the analysis and simulation of microwave data . </S>",
    "<S> a complementary approach is investigated here , in which maps are used only in the visualisation of the data , and the temperature anisotropies and polarization are only ever expressed in terms of their spherical multipoles . </S>",
    "<S> this approach has a number of advantages : there is no information loss ( assuming a band - limited observation ) ; deconvolution of asymmetric beam profiles and the temporal response of the instrument are naturally included ; correlated noise can easily be taken into account , removing the need for additional ` destriping ' ; polarization is also analysed in the same framework ; and reliable estimates of the spherical multipoles of the sky and their errors are obtained directly for subsequent component separation and power spectrum estimation . the formalism required to analyse experiments which survey the full sky by scanning on circles </S>",
    "<S> is derived here , with particular emphasis on the _ planck _ mission . </S>",
    "<S> a number of analytical results are obtained in the limit of simple scanning strategies . </S>",
    "<S> although there are non - trivial computational obstacles to be overcome before the techniques described here can be implemented at high resolution , if these can be overcome the method should allow for a more robust return from the next generation of full - sky microwave background experiments .    </S>",
    "<S> = = = = = = = =    # 1 # 1 # 1 # 1 @mathgroup@group @mathgroup@normal@groupeurmn @mathgroup@bold@groupeurbn @mathgroup@group @mathgroup@normal@groupmsamn @mathgroup@bold@groupmsamn = `` 019 = ' ' 016 = `` 040 = ' ' 336 = \" 33e = = = = = = = =    # 1 # 1 # 1 # 1 = = = = = = = =    [ firstpage ]    cosmic microwave background  </S>",
    "<S> methods : analytical :  methods : numerical . </S>"
  ]
}