{
  "article_text": [
    "the local stability of periodic structures , such as those formed by block copolymer melts , may be characterized by a linear response function that describes the nonlocal response of the monomer concentrations to a hypothetical external chemical potential field .",
    "this response function is closely related to the correlation function that is probed by small angle x - ray and neutron scattering .",
    "the use of a self - consistent field ( scf ) approximation to calculate the linear susceptibility of a homogeneous polymer blend or disordered diblock copolymer melt is often referred as a  random phase approximation \" ( rpa ) for the correlation function.@xcite this usage has become entrenched in the polymer literature , despite its somewhat obscure origin @xcite as one of several names for the use of a time - dependent scf theory ( _ i.e. _ , time - dependent hartree theory ) to calculate the dynamic linear response of a free electron gas @xcite .    in this paper , we present an efficient numerical method to calculate the scf linear susceptibility of ordered phases of block copolymers .",
    "the scf susceptibility of the disordered phase of a diblock copolymer melt was first calculated by leibler @xcite .",
    "leibler used this both to describe diffuse scattering from the disordered phase , and as one building block in his theory of weak microphase segregation .",
    "shi , laradji and coworkers @xcite were the first to calculate the scf susceptibility of ordered phases of diblock copolymer melts , which they used to examine the limits of local stability of various ordered structures .",
    "the calculation of the full linear response for an ordered structure is a numerically intensive task .",
    "@xcite used a spectral method to complete this calculation that was closely analogous to the algorithm used by matsen and schick @xcite to study equilibrium structures . when applied to three dimensionally periodic structures such as the bcc and gyroid phases ,",
    "this algorithm was able to accurately describe only very weakly segregated structures .",
    "this limitation was a result of a rapid increase in computational cost with increases in the number @xmath2 of spatial degrees of freedom required to resolve the structure : the computational cost of a spectral calculation of the response to a single perturbation ( _ e.g. _ , the response to a single plane wave ) is of @xmath3 , while the cost of a calculation of the full rpa response function ( _ i.e. _ , the response to an arbitrary small perturbation ) is @xmath4 .",
    "the earlier use of a spectral method by matsen and schick@xcite to calculate the equilibrium phase diagram for diblock copolymer melts relied heavily upon the use of space group symmetry to decrease the number of basis function needed to describe a structure .",
    "matsen and schick introduced the use of basis functions with the space group symmetry of each structure of interest .",
    "use of these symmetry - adapted basis functions functions reduces the number of degrees of freedom @xmath2 needed to obtain a given spatial resolution by a factor roughly equal to the number of point group symmetries in the relevant space group . for the bcc and gyroid cubic phases ,",
    "this reduces @xmath2 by almost a factor of 48 , and thus reduced the cost of solution a single iteration of the scf equations by a factor of almost @xmath5 .",
    "the calculation of the full linear susceptibility , however , requires the calculation of the response to arbitrary infinitesimal perturbations , which generally do not preserve the space group symmetry of the crystal . in general",
    ", it thus requires the use of either a plane wave basis or a spatial discretization that does not impose any symmetry upon the perturbation . primarily as a result of this loss of the advantages of symmetry , laradji _",
    "et al._@xcite were able to obtain results for the gyroid phase only for @xmath6 .",
    "matsen has been able to carry out linear response calculations for the bcc and gyroid phases at significantly larger values of @xmath7 by considering only the response to perturbations that preserve the periodicity of the cubic lattice , and that preserve a subgroup of the space group of the unperturbed structure @xcite .",
    "matsen s method and results are discussed in more detail in sec .",
    "[ sec : diblock ] .",
    "more recent work on numerical methods for solving the equilibrium scft by rasmussen and kalosakas @xcite , and by fredrickson and co - workers @xcite has made use of pseudo - spectral methods for which the cost of a single iteration of the scft equations scales as @xmath8 , rather than @xmath3 . here , we present a derivation of a perturbation theory for the linear response to an arbitrary disturbance in a form that we can evaluate numerically using a pseudo - spectral algorithm .",
    "the remainder of the paper is organized as follows : in section  [ sec : bloch ] , we discuss the basic formalism of the scf linear response theory for perturbations of a periodic microstructure , and review the consequences of bloch s theorem . in section  [ sec : perturbation ] , we present a perturbation theory for the underlying modified diffusion equation , which is used to calculate the linear susceptibility of a reference system of non - interacting polymers in a periodic potential . in section  [ sec : matrixform ] , we discuss the use of linearized scft to calculate the corresponding susceptibility of an incompressible system of interacting chains . in section  [ eff ] , we discuss the implementation and efficiency of our algorithm .",
    "section  [ sec : diblock ] presents selected results regarding the stability of the hex , bcc , and ( particularly ) the gyroid phases of diblock copolymer melts .",
    "in self - consistent field theory , we calculate the average concentration @xmath9 for monomers of type @xmath10 by considering a hypothetical system of non - interacting polymers in which monomers of type @xmath10 are subjected to a self - consistently determined field @xmath11 .",
    "we consider incompressible systems in which each monomer occupies a volume @xmath12 , and define a volume fraction field @xmath13 .    in",
    "what follows , we consider the response of an unperturbed state in which @xmath11 satisfies the self - consistent field ( scf ) equation @xmath14 here , @xmath15 is a flory - huggins parameter for binary interactions between monomers of types @xmath10 and @xmath16 , and @xmath17 is a lagrange multiplier field that must be chosen so as to satisfy an incompressibility constraint . to calculate the scf linear susceptibility",
    ", we consider the perturbation caused by an additional infinitesimal external potential @xmath18 .",
    "the resulting deviation @xmath19 must satisfy @xmath20 where @xmath21 is the corresponding deviation in the monomer concentration , and @xmath22 is the deviation in @xmath17 required to satisfy the incompressibility constraint @xmath23    the deviation @xmath21 may be described by either of two related linear response functions : it may be expressed either as an integral @xmath24 in which @xmath25 is nonlocal susceptibility of an inhomogeneous gas of non - interacting polymers to a change in the total self - consistent field @xmath26 , or by a corresponding relation @xmath27 in which @xmath28 is the scf susceptibility of the interacting liquid of interest to the external potential @xmath29 .",
    "it is convenient to introduce a fourier representation of the problem . as an example",
    ", we consider the ideal gas response function @xmath30 in what follows , but identical arguments apply to @xmath31 .",
    "the linear response to a perturbation @xmath32 may be expressed in fourier space , for a system of finite volume , as a sum @xmath33 in which @xmath34 where @xmath35 is the volume of a system containing many unit cells of the original structure , with born - von karmann boundary conditions .",
    "we are interested here in the response of an unperturbed structure that is invariant under translations @xmath36 , where @xmath37 is any vector in the bravais lattice of the unperturbed crystal . as a result",
    ", we expect any linear response function to exhibit the symmetry @xmath38 for any lattice vector @xmath37 . by fourier transforming both sides of this equality , using definition ( [ sidk_def ] ) for the transform , we find that @xmath39 can be nonzero only for values of @xmath1 and @xmath40 for which @xmath41 for any lattice vector @xmath37 .",
    "the reciprocal lattice is the set of all wavevectors @xmath42 such that @xmath43 for any bravais lattice vector @xmath37 .",
    "this implies that @xmath39 can be nonzero only for values of @xmath1 and @xmath40 for which @xmath44 for some reciprocal lattice vector @xmath42 .",
    "this is the content of bloch s theorem , as applied to a linear response function .",
    "it is thus convenient to represent the nonzero elements of @xmath30 by a matrix @xmath45 where @xmath1 is a crystal wavevector in the first brillouin zone .",
    "a similar notation will be used for the scf response function @xmath31 .",
    "consider the response to perturbation that has the form of a bloch function , @xmath46 in which @xmath1 is a crystal wavevector in the first brillouin zone , and @xmath47 is a periodic function with the periodicity of the unperturbed lattice , @xmath48 in which @xmath49 denotes a sum over reciprocal lattice vectors .",
    "bloch s theorem guarantees that the resulting density perturbation will assume the same form @xmath50 where @xmath51 is also a periodic function .",
    "the relationship between the fourier components @xmath52 and @xmath53 may be expressed as a matrix product @xmath54 with a matrix @xmath55 whose elements depend parametrically upon @xmath1 .",
    "it also follows from the block - diagonal form of @xmath56 that the eigenmodes of @xmath30 and @xmath31 must be bloch functions . as emphasized by shi @xcite ,",
    "these conclusions about the consequences of periodicity are quite general , and are independent of the self - consistent field approximation .    the scf response function is related to the scft free energy functional @xmath57 $ ] by the standard identity @xmath58 }       { \\delta{\\phi}_{\\amon}(\\kv+{\\bf g } )        \\delta{\\phi}_{\\bmon}(-\\kv-{\\bf g}')}\\ ] ] here , the inverse of @xmath31 is defined in reciprocal space by requiring @xmath59 the condition for local stability of a periodic structure is thus that the matrix @xmath60 be positive definite for every @xmath1 in the first brillouin zone .",
    "the onset of instability occurs when one of the eigenvalues of @xmath60 passes through zero at some @xmath1 .",
    "in scft , the monomer concentration fields are obtained by calculating the concentrations in a reference system of non - interacting chains in which monomers of type @xmath10 are subjected to a field @xmath11 .",
    "this reference system is treated by considering a pair of constrained partition functions @xmath61 and @xmath62 for chains of species @xmath63 , which satisfy the modified diffusion equations @xmath64 in which @xmath65 these quantities satisfy initial conditions @xmath66 and @xmath67 , respectively , where @xmath68 is the length of chains of type @xmath63 . here ,",
    "@xmath69 and @xmath70 are a statistical segment length and a chemical potential field for monomers of the type @xmath10 found at point @xmath71 along the chains of type @xmath72 .",
    "the volume fraction of monomers of type @xmath10 on chains of type @xmath72 is given by an integral @xmath73 where the integral with respect to @xmath71 is taken only over those blocks that contain monomers of type @xmath10 .",
    "here , @xmath74 is the volume fraction of chains of type @xmath63 , and @xmath75 the chemical potential @xmath76 for species @xmath77 and @xmath78 are connected ( for a particular choice of standard state ) by a relation @xmath79 the scft can be applied in either the canonical or grand - canonical ensemble by simply regarding either @xmath80 or @xmath76 as a specified input parameter , respectively .    here",
    ", we consider a perturbation theory for the variation in @xmath81 that results from a variation in @xmath70 .",
    "the chemical potential field can be written as a sum @xmath82 of an unperturbed part @xmath83 and a small perturbation @xmath84 .",
    "similarly @xmath61 can be expressed as a sum @xmath85 where @xmath86 is the solution to the scf equations for the unperturbed periodic structure . substituting equations",
    "[ delomega ] and [ delq ] in [ diffeq ] yields the perturbation equation : @xmath87 where @xmath88 is the unperturbed",
    " hamiltonian \" .",
    "this must be be solved subject to an initial condition @xmath89 .",
    "the unperturbed fields @xmath90 and @xmath86 have the periodicity and space group symmetry of the unperturbed crystal .    to take advantage of bloch s theorem",
    ", we consider a perturbation of the form of a bloch function @xmath91 , which will produce a corresponding deviation @xmath92 here , @xmath1 is a wavevector in the first brillouin zone , and @xmath93 and @xmath94 are periodic functions . substituting these expressions into the modified diffusion equation and keeping terms that are linear in the perturbation yields an inhomogeneous pde : @xmath95 in which @xmath96 a closely analogous pde may be obtained for @xmath97 .",
    "the resulting deviations must satisfy boundary conditions @xmath98 and @xmath99 where @xmath100 is the number of monomers in a chain of type @xmath72 . to calculate the ideal gas linear response ,",
    "we numerically solve this pair of pdes using a pseudo - spectral algorithm that is presented in the appendix .",
    "the perturbation in the periodic part of the monomer concentration field may be expressed , in grand - canonical ensemble , as an integral @xmath101\\ ] ] here , @xmath74 , @xmath78 , @xmath61 and @xmath102 all represent values evaluated in the unperturbed state . the integral with respect to @xmath71 in the above",
    "must be taken only over the block or blocks that contain monomers of type @xmath10 .",
    "the expression for @xmath103 in canonical ensemble is the same as that obtained for grand canonical ensemble for any crystal wavevector @xmath1 _ except _ @xmath0 .",
    "it may be shown that only perturbations with @xmath0 ( _ i.e. _ , perturbations with the same periodicity as the unperturbed crystal ) can induce changes in @xmath78 to linear order in the strength of the applied potential . in grand - canonical ensemble ,",
    "any change @xmath104 in @xmath78 will cause a change @xmath105 in the molecular volume fraction @xmath74 obtained from eq .",
    "( [ phi_mu ] ) , but the prefactor to @xmath106 in eq .",
    "( [ rhochain ] ) remains constant .",
    "in canonical ensemble , where @xmath74 is regarded as an fixed input parameter , a change in @xmath78 instead induces a change in the denominator of eq .",
    "( [ rhochain ] ) for @xmath107 .",
    "this yields a slightly modified expression @xmath108 for perturbations in canonical ensemble at exactly @xmath0 , in which  gce \" represents the grand - canonical ensemble response given by the right hand side of eq .",
    "( [ delrho ] ) .",
    "it may be shown that this expression yields a perturbation in which @xmath109 for all @xmath63 and @xmath10 .    by using the above perturbation theory to calculate the fourier components of the perturbation @xmath110 caused by a particular plane wave perturbation @xmath111",
    ", we may obtain one row of the matrix @xmath112 at a specified value of @xmath1 .",
    "the elements of this reciprocal - space matrix are generally complex numbers , but may be shown to be real when the unperturbed crystal has inversion symmetry .",
    "we now discuss how the scf susceptibility @xmath113 can be calculated from the response function @xmath114 of an ideal gas .",
    "consider the response to an external perturbation of the bloch form @xmath115 .",
    "substituting the self - consistency condition into definition [ sdef1 ] of the ideal gas response function , and expressing the result in fourier space , yields the linear self - consistency condition @xmath116 where @xmath117 summation over repeated reciprocal wavevectors and monomer type indices is implicit . here",
    "we have introduced the notation @xmath118 for a vector for which @xmath119 for all @xmath16 , and @xmath120 for a fourier component of the periodic part @xmath121 of a deviation @xmath122 eq .",
    "( [ rpa0 ] ) can be expressed more compactly , in a matrix notation , as @xmath123\\end{aligned}\\ ] ] here and hereafter , we use boldfaced greek letters with a single latin monomer index @xmath124 to represent column vectors in the space of reciprocal lattice vectors ( or periodic functions of @xmath125 ) , so that @xmath126 and @xmath127 , and boldfaced capital roman letter with two monomer type indices to represent matrices in this space , so that @xmath128 . in this notation , matrix - vector and matrix - matrix multiplication",
    "is thus used to represent summation over repeated reciprocal lattice vector arguments . when monomer types indices are displayed explicitly , summation over repeated indices",
    "is implied .    imposing the incompressibility constraint @xmath129 yields a condition @xmath130\\ ] ] solving eq .",
    "( [ inc_mat ] ) for @xmath131 yields @xmath132      \\quad,\\ ] ] here , we have introduced the quantities @xmath133 these are represented in matrix notation by @xmath134 , @xmath135 , and @xmath136 , respectively . substituting equation ( [ dxivec ] ) for @xmath131 back into equation ( [ rpa1 ] ) yields @xmath137      \\label{drho_wo_dxi}\\ ] ] where @xmath138 the quantity @xmath139 is the scft response function of incompressible system with @xmath140 .    by solving eq .",
    "( [ drho_wo_dxi ] ) , we find that @xmath141 where @xmath142^{-1}_{\\cmon\\bmon}\\ ] ] is the desired scf response function . here",
    "@xmath143 denotes the identity in the space of reciprocal lattice vectors and monomer type indices , with elements @xmath144 , @xmath145 denotes a matrix in this space with elements @xmath146 , and inversion is defined in this expanded space .    in order for the incompressibility condition ( [ incompressible_g ] ) to be satisfied for the response to an arbitrary infinitesimal perturbation , the response function @xmath31 for any incompressible liquid must satisfy @xmath147 for any @xmath1 , @xmath42 , and @xmath148 .",
    "the second equality in the above follows from onsager reciprocity .",
    ". [ sincompb ] also implies that @xmath149 .",
    "the same conditions apply to @xmath150 , which is a special case of @xmath151 for @xmath152 .",
    "it is straightforward to confirm that eq .",
    "( [ sincmat_def ] ) satisfies these conditions for @xmath150 , and that they are preserved by eq .",
    "( [ rpagen ] ) for @xmath151 .",
    "( [ sincompb ] ) implies that @xmath151 is singular , if viewed as a matrix in the space of reciprocal lattice vectors and monomer types , since it implies that @xmath153 for any vector of the form @xmath154 , for which the elements are functions of @xmath155 alone , independent of the value of the monomer index @xmath16 .",
    "the matrix @xmath156 thus has a null space spanned by the space of all such vectors . in any numerical calculation for a system of @xmath157 monomer types in which we use a truncated fourier representation of @xmath2 reciprocal lattice vectors",
    ", @xmath151 is a matrix in a @xmath158 dimensional space that contains an @xmath2 dimensional null space ( or kernel ) .",
    "thus , though it is tempting for us to rewrite equation  ( [ rpagen ] ) as @xmath159 , this would be meaningless , because neither @xmath151 nor @xmath150 are invertible . the non - null space of the symmetric matrix @xmath151 ( i.e. , the space spanned by all eigenvectors of @xmath151 with non - zero eigenvalues ) is spanned by all functions for which @xmath160 , since this is the condition of orthogonality with any vector in the null space .",
    "the non - null space is thus the same as the space of monomer concentration fluctuations that respect incompressibility constraint ( [ incompressible_g ] ) .",
    "consider a system containing only two types of monomer , with a single interaction parameter @xmath161 . in this case , it is straightforward to project the problem onto the space of physically allowable fluctuations , which respect the incompressibility constraint .",
    "we define the two component vectors @xmath162 = ( @xmath163 ) , where @xmath164 or 2 for the two monomer types , and introduce the following transformation for any @xmath165 dimensional correlation function matrix @xmath166 : @xmath167 in which @xmath168 and @xmath169 belong to the set @xmath170 . the quantity @xmath171 defined in eq .",
    "( [ sid_pm ] ) is an example of this notation .",
    "as already noted , the incompressibility constraint requires that @xmath172 . by evaluating the remaining @xmath173 element of eq .",
    "( [ sincmat_def ] ) for @xmath139 , we find that @xmath174 it is straightforward to show that @xmath175 and @xmath176 are related by @xmath177^{-1 }      \\label{smatmm}\\ ] ] where @xmath178 is the conventional scalar flory - huggins parameter .",
    "this result is equivalent to eqs .",
    "( 17 ) and ( 18 ) of laradji et _ al .",
    "the matrix @xmath176 in a system described by a truncated basis of @xmath2 reciprocal lattice vectors and @xmath179 monomer types is an @xmath180 matrix , which is generally non - singular .",
    "it therefore _ is _ legitimate to rewrite eq .",
    "( [ smatmm ] ) as @xmath181 in close analogy to the rpa equation for an incompressible disordered system .",
    "the limits of stability of an ordered structure may be identified by examining the eigenvalues of the rpa response function @xmath175 . at each @xmath1 in the first brillouin zone , we consider the eigenvalue equation @xmath182 with eigenvectors @xmath183 .",
    "the vector @xmath184 contains the fourier components of a periodic function @xmath185 that is the periodic part of an eigenvector of the bloch form @xmath186 .",
    "it follows from eq .",
    "( [ smminv ] ) that @xmath175 and @xmath176 have the same eigenvectors , and that their eigenvalues are related by @xmath187 where @xmath188 is a corresponding eigenvalue of the response function matrix @xmath176 .",
    "the problem of calculating the eigenvalues of @xmath151 thus reduces to that of calculating and diagonalizing @xmath150 .      when examining limits of stability we will often be particularly interested in instabilities at @xmath0 . in the cases of interest ,",
    "these correspond to instabilities toward structures that have an epitaxial relationship with the original structure , but in which some of the reciprocal lattice vectors of the original structure are absent in the final structure . in diblock",
    "copolymer melts , the instabilities of the bcc phase towards hexagonally packed cylinders , and of the cylinder phase towards a lamellar phase are found to be epitaxial instabilities of this type .",
    "the linear response at exactly @xmath189 , however , has some special features that are important to understand when constructing a numerical algorithm .",
    "the response @xmath190 to a perturbation at @xmath191 corresponds to a response to a spatially homogeneous shift in monomer chemical potentials .",
    "the change in potential energy associated with any spatially homogeneous perturbation @xmath192 in the external fields that couple to monomer concentration depends only upon the total number of monomers of each type in the system , which can change only as a result in the change in the number of molecules of each species .",
    "such a homogeneous perturbation is thus equivalent to the response to a shift @xmath193 in the set of macroscopic chemical potential fields for molecules of different species , where @xmath194 is the number of @xmath10 monomers per molecule of type @xmath63 .",
    "such a homogeneous perturbation can have no effect upon monomer concentration fields in canonical ensemble , because the number of molecules of each type is constrained .",
    "it also can have no effects in either ensemble in an incompressible liquid with only one molecular species , such as a diblock copolymer melt , because the number of molecules per volume is then constrained by incompressibility .    in either ensemble",
    ", we thus expect the matrix @xmath195 in an incompressible diblock copolymer melt to have one vanishing eigenvalue , for which the only nonzero element of the corresponding eigenvector @xmath196 is the @xmath197 element , corresponding to a homogeneous perturbation .",
    "this has long been known to be the case in the homogeneous phase of an incompressible diblock copolymer melt , for which the matrix @xmath195 is diagonal , with a diagonal element @xmath198 at @xmath199 .",
    "we have confirmed that our numerical results for both @xmath176 and @xmath175 for ordered phases of diblock melts have this property . as in the disordered phase",
    ", we also find that the eigenvalue @xmath200 associated with one branch of the spectrum continuously approaches zero as @xmath201 .",
    "to apply eq .",
    "( [ evalinv ] ) to a diblock copolymer melt at @xmath189 , one must thus identify and exclude this trivial zero mode .",
    "the spectrum of @xmath202 for a three dimensional structure generally also has three divergent eigenvalues , as a result of translational invariance .",
    "the corresponding eigenvectors are generators of rigid translations , which all have the form @xmath203 where @xmath204 is an infinitesimal rigid translation .",
    "basis vectors for the subspace of rigid translations may be obtained considering infinitesimal translations along three orthogonal directions .",
    "the inverse eigenvalue @xmath205 associated with these modes vanish because there is no free energy cost for rigid translation of a crystal . in a band structure of @xmath205",
    "vs. @xmath1 for a three dimensional structures , we thus find three  phonon - like \" bands ( one longitudinal and two transverse ) in which the values of @xmath206 approach zero as @xmath207 in the limit @xmath201 .    the fact that these  phonon - like \" eigenvalues of @xmath208 diverge as @xmath201 does not cause any numerical problems for diblock copolymer melts if we use eq .",
    "( [ evalinv ] ) to calculate the eigenvalues of @xmath175 . in this procedure , we numerically diagonalize the matrix @xmath176 , for which the corresponding eigenvalues have finite values of @xmath209 .",
    "we find , however , that the our numerical results for @xmath210 for these modes are very small only when the linear response is calculated for a well converged solution to the equilibrium scft , and only when the calculation is carried out with adequate spatial resolution .",
    "the behavior of these phonon - like modes thus provides a useful , and quite stringent , test of numerical accuracy .",
    "when calculating particular eigenvalues of the linear response matrix @xmath211 at @xmath189 or other special points in the brillouin zone , it is sometimes possible to substantially reduce the cost of the eigenvalue calculation by making use of space group symmetry . as a simple example , if we know that the instability of a centrosymmetric structure is a result of an epitaxial instability towards another centrosymmetric structure , we expect the corresponding eigenvector of @xmath211 at @xmath0 to be even under inversion . to calculate the eigenvalue associated with such an instability",
    ", we may thus calculate a matrix representation of @xmath211 in the subspace of even functions by using a basis of cosine functions , rather than plane waves , and thereby reduce the number of basis functions by a factor of @xmath179 at a given spatial resolution .",
    "more generally , group theory can be used in the calculation of eigenvalues of @xmath211 at special points in the brillouin zone in a manner very similar to what has long been used in the calculation of eigenvalues of the schroedinger equation in band structure calculations.@xcite the starting point of the general analysis , in the present context , is the observation that the linear response operator @xmath212 of a periodic structure is invariant under the symmetry elements of the so - called  little group \" @xmath213 associated with crystal wavevector @xmath1 . in the case of eigenvectors at @xmath0",
    ", @xmath213 is the same as the space group @xmath214 of the unperturbed crystal .",
    "more generally , @xmath213 is the subgroup of the full space group @xmath214 containing symmetry elements that leave a plane wave @xmath215 of wavevector @xmath1 invariant . by arguments similar to those used to characterize the symmetry of eigenvectors of the schroedinger equation at special @xmath1 points",
    ", it may be shown that ( in the absence of accidental degeneracies ) each eigenvalue of @xmath212 may be associated with a specific irreducible representation of group @xmath213 .",
    "each such irreducible representation is associated with a subspace of functions that transform in a specified way under the action of the symmetry elements of @xmath213 .",
    "eigenvectors with the symmetry properties characteristic of a particular irreducible representation may be expanded using basis of functions that span the associated subspace .    as a trivial example , consider a one dimensional problem involving perturbations at @xmath189 of a periodic structure that is symmetric under inversion ( i.e. , a centrosymmetric lamellar phase ) .",
    "the space group @xmath214 of the unperturbed crystal is the group @xmath216 , which contains only the identity element , @xmath217 , and the inversion element , @xmath218 . at @xmath0 ,",
    "the relevant little group is the same as this full group .",
    "there are two possible irreducible representations of this group , for which the associated subspaces contain all functions @xmath219 that are even under inversion , @xmath220 , or odd under inversion , @xmath221 , respectively .",
    "each eigenvector @xmath222 must lie within one of these two subspaces , i.e. , must be either even or odd . to calculate eigenvalues associated with the subset of eigenfunctions at @xmath0 that are even under inversion , we can use a cosine basis . to obtain eigenvalues associated with the remaining odd eigenfunctions ,",
    "we can use a sine basis .",
    "even if we require all of the eigenvalues , the size of the required secular matrices is reduced by considering even and odd subspaces separately , thereby block diagonalizing @xmath31 .    in general , to calculate an eigenvector or set of eigenvectors with a known symmetry",
    ", we may introduce a set of basis function with the desired symmetry .",
    "let @xmath223 be a set of @xmath2 orthonormal basis functions that lie within the subspace of periodic functions associated with a given irreducible representation of the relevant little group @xmath213 .",
    "each of these basis functions is generally a superposition of plane waves with reciprocal lattice wavevectors that are related to one another by the symmetry elements of group @xmath213 .",
    "the phase relationships among the coefficients of different plane waves within such a basis function are different in different irreducible representations .",
    "the symmetrized basis functions that we use to represent the solution of the unperturbed crystal , which are required to be invariant under all elements of the full space group @xmath214 , are a special case of such basis functions , as are cosine and sine functions .    to calculate the response within a subspace spanned by any such set of symmetry - adapted basis functions , we consider the response of an ideal gas to a perturbation of the form @xmath224 such a perturbation is expected to yield a concentration perturbation @xmath225 with a periodic factor that can be expanded in terms of the same basis functions , with coefficients @xmath226 .",
    "the linear response of the ideal gas in the subspace of interest may thus be characterized by a matrix @xmath227 where @xmath228 is a matrix representation of the ideal gas response @xmath229 within the chosen subspace .",
    "the corresponding rpa response can be represented in this subspace by a matrix @xmath230 of the same form , using the same basis functions .",
    "the matrix equations that relate the ideal gas and rpa response matrices in this representation are identical to those obtained above for the special case of a plane wave basis , except for the replacement of summation over reciprocal vectors by summation over basis function indices @xmath231 and @xmath232 .",
    "our implementation of the linear response calculation allows for the introduction of an arbitrary set of such basis functions .",
    "we have thus far automated the generation of symmetry - adapted basis functions , however , only for cases in which the required basis functions are invariant under all elements of @xmath213 , or of a specified subgroup of @xmath213 . in these cases ,",
    "the required basis functions may be generated by the same algorithm as that used to generate symmetry adapted basis functions for the solution of the unperturbed problem .",
    "we have thus far actually used symmetry adapted basis functions , rather than plane waves , only for the purpose of refining our results for the eigenvalues of specific eigenvectors of @xmath31 in the gyroid phase , as discussed below .",
    "when calculating eigenvalues for body - centered crystals using a simple cubic cubic computational unit cell , we encountered a subtlety that is a result of the translational symmetry that relates the two equivalent sublattices of the bcc structure .",
    "this is discussed in appendix [ app : centering ] .",
    "to calculate the eigenvalues of @xmath151 for an equilibrium structure of a diblock copolymer melt at a specific crystal wavevector @xmath1 , we first calculate the equilibrium structure , and store the converged @xmath26 field .",
    "if the calculation will use symmetry adapted basis functions , rather than a full plane wave basis , we next generate these functions . to calculate the spectrum of @xmath31 in the invariant space spanned by the chosen set of basis functions ( which may be plane waves ) we must then :    1 .",
    "use the perturbation theory of sec .",
    "( [ sec : perturbation ] ) to calculate the ideal - gas response matrix @xmath55 , in a plane wave basis , or @xmath228 , in a basis of symmetry adapted functions . 2 .",
    "solve matrix eq .",
    "( [ smm ] ) to obtain @xmath176 .",
    "3 .   diagonalize @xmath176 .",
    "once the eigenvalues of @xmath176 are known , eq . ( [ smminv ] ) may be used to obtain the corresponding eigenvalues of @xmath175 .    in step 1 , we calculate @xmath233 using a truncated set of @xmath2 basis function , which may be either plane waves or symmetry - adapted functions . to do so , we calculate the perturbation @xmath234 in monomer concentration produced by perturbations of the form @xmath235 , for every basis function @xmath236 in our basis set , for perturbations in both @xmath237 and @xmath238 .",
    "this requires us to solve the perturbation theory for the ideal gas @xmath239 times .",
    "each such solution , which requires a calculation @xmath240 and @xmath241 , provides one row of the @xmath242 matrix @xmath233 .    in the spectral method employed by shi _",
    "et al._@xcite , @xmath3 floating point operations are required to calculate the response of an ideal gas to a single plane wave perturbation .",
    "the cost of a calculation of the entire matrix @xmath243 for a single @xmath1 vector is thus @xmath4 .",
    "the matrix operations required in steps ( 2 ) and ( 3 ) each require @xmath3 operations . in the spectral method , the @xmath4 cost of the calculation of the ideal gas susceptibility @xmath30 thus dominates the cost for large values of @xmath2 . with this algorithm , shi _ et al .",
    "_ @xcite were limited to values of @xmath244 .    in our pseudo - spectral implementation , the calculation of the response to a single perturbation requires @xmath245 operations , where @xmath246 is the number of grid points , or plane waves , and @xmath247 is the number of discretized `` time - like '' steps along the chain .",
    "the cost of the calculation of the entire matrix @xmath243 is thus @xmath248 . for plane wave calculations , @xmath249 , and",
    "the cost of the calculation is @xmath250 .",
    "we have used a time stepping algorithm , described in the appendix , that yields global errors of @xmath251 , where @xmath252 is the contour length step size . with this algorithm ,",
    "very high accuracy can be obtained with @xmath253 .",
    "the pseudo - spectral algorithm for calculation of the ideal gas response function thus becomes much more efficient than the spectral method for large values of @xmath2 . as a result , however , the @xmath3 cost of the matrix inversion and diagonalization required in steps ( 2 ) and ( 3 ) will become the bottleneck for large @xmath2 in our algorithm .",
    "a comparison of cpu times for the different parts of the calculation is given in table [ table : cost ] .",
    "the cpu time required for steps 2 and 3 remains less than that of step 1 over the range grids reported here , but would begin to dominate for slightly larger values of @xmath254 .    on a commodity personal computer , the calculation",
    "is also limited by the memory required in steps 2 and 3 . in our implementation ,",
    "in which we have taken care to minimize memory usage , these matrix manipulations require storage of @xmath255 double precision real numbers for calculations involving centrosymmetric unperturbed crystals .",
    ".cpu time and memory costs for the calculation of @xmath211 and its eigenvalues for a gyroid phase at a given crystal wavevector @xmath1 , using a plane wave basis set on an @xmath256 grid , where @xmath257 .",
    "times are in minutes and memory in megabytes . the time and memory required to calculate the ideal gas perturbation ( step 1 ) are labeled time i.g . and memory i.g .",
    ", respectively , while the costs of the linear algebra operations in steps 2 and 3 are labeled time l.a . and memory l.a .",
    "each calculation was carried out on a single athlon 2200 mp processor running at 1.7 ghz . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     we next considered the limits of stability of the gyroid phase with respect to the epitaxial instability that was considered previously by matsen .",
    "to do so , we calculated eigenvalues at @xmath0 over a range of values of @xmath258 for several values of @xmath7 .",
    "the three - fold degenerate inverse eigenvalue @xmath259 associated with the epitaxial @xmath260 instability was found to decrease and pass through zero with decreasing @xmath258 , at each value of @xmath7 , and to be the first inverse eigenvalue at @xmath0 to become unstable .",
    "the resulting limit of stability with respect to this eigenmode is shown in figure  [ stgyr ] by the dashed line with open circles .",
    "our results for this line of instabilities , which lies very close to the equilibrium order - order transition between bcc spheres and hexagonal cylinders , agrees very well with matsen s result for the same eigenmode @xcite .    to check whether this instability at @xmath189 is preempted by another instability at some @xmath261",
    ", we then calculated another band diagram at a point @xmath262 , @xmath263 along the proposed limit of stability line , at which the value of @xmath210 corresponding to the epitaxial @xmath264 instability exactly vanishes .",
    "the results are shown in figure  [ gf3745 ] . at these conditions",
    ", 6 eigenvectors have nearly vanishing eigenvalues at @xmath0 ( the @xmath265 point ) , corresponding to the 3 rigid translation modes and the three @xmath260 modes .",
    "for this pair of parameters , however , we also found very small negative values of @xmath266 at several points near the @xmath267 and @xmath254 points : unstable modes were found along the @xmath268(1 ) , @xmath269(2 ) , @xmath270(1 ) and @xmath271 ( 2 ) directions .",
    "( the numbers in parentheses indicate the degree of degeneracy of the relevant bands along these high - symmetry lines . )",
    "the most negative eigenmode in this diagram , which we assume to correspond to the true limit of stability , lies along the @xmath268 direction . by calculating eigenvalues at several nearby points along two lines constructed through this point along directions perpendicular to the @xmath268 line ,",
    "we have confirmed that this is a local minimum of @xmath266 for the lowest band in the three - dimensional band diagram .    to investigate further , we thus ran a series of calculations of the band diagram along the @xmath268 line for several of values of @xmath272 near the previously calculated limit of stability of the epitaxial mode , for integer values of @xmath7 = 11 - 16 . at each value of @xmath7",
    ", we found a minimum value of @xmath273 vs @xmath1 at approximately the same wavevector @xmath1 , which is displaced from the @xmath267 point by a fraction @xmath274 of the distance between @xmath267 and @xmath275 for @xmath263 and which becomes closer to the @xmath275 point as the value of @xmath7 increases . at each value of @xmath7",
    ", we found that this minimum value of @xmath273 at @xmath261 passed through zero at a value of @xmath272 that is within approximately @xmath276 of that at which the epitaxial @xmath0 modes become unstable .",
    "for example , at @xmath263 , we find an instability at @xmath261 at @xmath277 , vs. @xmath262 for the instability at @xmath189 .",
    "differences in the two critical values of @xmath272 are equally small for the other values of @xmath7 .",
    "we are not confident of our ability to accurately resolve such small differences in the critical values of @xmath272 with the @xmath278 grid used in these calculations .",
    "we thus conclude only that this unexpected incommensurate instability competes extremely closely with the epitaxial instability considered by matsen , and may well preempt it .",
    "we do not have a physical interpretation of the nature of this incommensurate instability , or toward what type of structure it might lead .",
    "we note , however , that the identification of such an instability at @xmath261 could not have been accomplished by matsen s approach , which allowed him to consider only stability with respect to @xmath0 eigenmodes with a specified residual symmetry : it required the development of an efficient method of calculating the full linear response at arbitrary @xmath1 .    in figure  [ stgyr ]",
    "we have also shown three other limits of stability of this gyroid structure at larger values of @xmath272 . the branch labeled with @xmath279",
    "is obtained by tracing the equilibrium unit cell size @xmath72 of the gyroid structure , and is characterized by a rapid contraction of the unit cell with increasing @xmath272 : as this line is approached from the left , the derivative @xmath280 appears to diverge to @xmath281 .",
    "the branch labeled with @xmath282 is obtained from perturbation calculation at @xmath0 and is doubly degenerate , with even eigenfunctions .",
    "it is often found to be accompanied by one of the other two unstable modes not shown in the figure , also occurring at @xmath0 .",
    "one of these two modes is non - degenerate , for which the eigenfunction is odd under inversion , and has three fold rotational symmetry along @xmath283 directions .",
    "another one is triply degenerate , with eigenfunctions that are even . the branch labeled with @xmath284",
    "is also obtained from perturbation calculation at @xmath0 and is the result of a triply degenerate instability that appears to cross the @xmath285 instability in the vicinity of the critical point . along this high-@xmath272 boundary of the gyroid phase , where one might expect a transition to a lamellar phase",
    ", we made no attempt to look for yet more instabilities at @xmath261 .",
    "we have developed a pseudo - spectral algorithm for calculating the linear susceptibility of the ordered phases in block copolymeric melts that is significantly more efficient than that employed in earlier work by shi and coworkers .",
    "we have used the new algorithm to re - examine the limits of stability of several ordered phases in diblock copolymers , and have resolved a controversy regarding the local stability of the gyroid phase .",
    "we have also identified an unexpected instability of the gyroid phase at a nonzero @xmath1 vector along the zone edge , which competes very closely with the epitaxial @xmath260 transition considered previously by matsen .",
    "_ acknowledgments _ : this work was supported primarily by the mrsec program of the national science foundation under award number dmr-0212302 , using computer resources provided by mrsec and by the university of minnesota supercomputer institute .",
    "we are also grateful for helpful conversations with both an - chang shi and mark matsen .",
    "to calculate response of an ideal gas to a specified perturbation , we must numerically solve equation ( [ per_de ] ) for @xmath286 .",
    "we do so by discretizing the  time - like \" variable @xmath71 into steps of equal size @xmath252 and numerically integrating the partial differential equation . to carry out the integration",
    ", we use a pseudo - spectral algorithm closely analogous to one that was introduced by rasmussen and kalosakas @xcite as an algorithm for solving the unperturbed mde that is solved to describe unperturbed equilibriums state .",
    "we have combined a pseudo - spectral algorithm with richardson extrapolation to obtain solutions with errors of @xmath251 .      in this subsection",
    ", we review the rasmussen - kalosakas ( rk ) algorithm for the solution of the unperturbed for @xmath287 , and present an extrapolation method that we use to improve the accuracy of this algorithm .",
    "the rk algorithm is based upon a representation of @xmath287 at each value of @xmath71 on a regular spatial grid , and the use of a fast fourier transform ( fft ) to transform between real- and fourier - space representations .",
    "given a solution @xmath288 at @xmath289 , the value at @xmath290 may be expressed formally as a product @xmath291 where @xmath292 represents the function @xmath288 , and where @xmath293 is an exponential operator . in the rk algorithm ,",
    "the propagator is approximated by @xmath294 the product @xmath295 is then evaluated by :    1 .",
    "evaluating a product @xmath296 at regularly spaced grid points , 2 .   applying a fft to obtain @xmath297 and using the fourier representation to evaluate @xmath298 3 .   applying an inverse fft to obtain @xmath299 and again evaluating a product @xmath300 on the real - space grid .",
    "this algorithm yields a solution with local errors of @xmath301 , or global errors of @xmath302    to improve the accuracy of the solution we have used an extrapolation scheme in which we calculate each time step using two different values of @xmath252 , which differ by a factor of 2 , and then extrapolating to @xmath303 to obtain the next value . given @xmath292 , we first calculate a function @xmath304 by applying the rk algorithm once with a time step @xmath252 .",
    "we then calculate a function @xmath305 by applying the above algorithm twice , using a step size @xmath306 .",
    "the final value of @xmath307 , which is used as the starting point for the next step , is obtained from the extrapolation @xmath308/3",
    "\\quad,\\ ] ] which is designed to cancel the accumulating errors of order @xmath309 .",
    "this extrapolation scheme for the unperturbed mde was originally implemented in the pseudo - spectral version of our scft code .",
    "when designed , it was expected to remove global errors of order @xmath302 , and to leave errors of @xmath310 .",
    "when the algorithm was tested , however , it was found to yield a global error that decreased with @xmath252 as @xmath311 .",
    "we now believe that this behavior is a result of a special property of reversible integration algorithms @xcite .",
    "an algorithm is said to be reversible if one forward propagation of the solution @xmath292 , followed by a backward propagation with the same step size , can exactly recover the starting point @xmath312 .",
    "the rk algorithm is reversible in this sense .",
    "it is known @xcite that the taylor series expansion of the global error produced by a reversible discrete integrator for any system of first order differential equations contains only even powers of @xmath252 . as a result",
    ", reversible integration algorithms always exhibit the behavior we observed for the extrapolated rk algorithm : an extrapolation that is designed to decrease the global errors from @xmath313 to order @xmath314 generally yields a solution with global errors of order @xmath315 .",
    "we now describe the algorithm used to solve eq .",
    "( [ per_de ] ) , and the conjugate equation for @xmath241 .",
    "a formal solution of the equation  [ per_de ] over a single step of length @xmath252 can be written as an integral : @xmath316 where @xmath317 is the inhomogeneous term in this linear pde , and where @xmath318 is the propagator for perturbations of crystal wavevector @xmath1 .    our integration scheme ( prior to richardson extrapolation )",
    "is to take @xmath319 where @xmath320 / 2\\ ] ] while using the rk approximation for propagation by both @xmath321 and @xmath322 .",
    "this algorithm , like the rk algorithm , yields global errors of @xmath302 .",
    "also , like the rk algorithm , it is reversible .",
    "we thus use the same extrapolation scheme for this algorithm as that given in eq .",
    "( [ rk - extrap ] ) for the rk algorithm .",
    "after @xmath240 and @xmath241 are obtained by this method , the integral with respect to @xmath71 in eq .",
    "( [ delrho ] ) is evaluated using simpson s method .",
    "the extrapolated solution for @xmath323 , and thus for the matrix @xmath151 , have errors of @xmath251 , as demonstrated in fig .",
    "here , we explain an issue that we encountered when calculating band diagrams for bcc and gyroid phases using a non - primitive cubic unit cell .",
    "analogous issues can arise whenever a body- or face - centered crystal is treated with a non - primitive computational unit cell .",
    "band diagrams for the bcc and gyroid phases , can be calculated using either a cubic unit cell with orthogonal axes , or a primitive unit cell with non - orthogonal axes , which has half the volume of the cubic unit cell .",
    "( the gyroid structure is based on a bcc lattice ) .",
    "we have used a simple cubic computational unit cell with cell size @xmath72 , and discretized this with a simple cubic fft grid .",
    "the reciprocal lattice associated with this computational unit cell thus includes wavevectors that are not part of the reciprocal lattice of the bcc bravais lattice , which is an fcc lattice in @xmath324-space .",
    "the first brillouin zone ( fbz ) associated with the simple cubic unit cell ( @xmath325 ) has half the volume in @xmath324-space as the fbz for the bcc unit cell .    if the algorithm described in this paper",
    "is applied to a bcc structure using a simple cubic cell , without explicitly accounting for the centering symmetry of the unperturbed structure , the list of eigenvalues obtained at a specified @xmath1 in the fbz of the simple cubic cell include both those associated with @xmath1 and those associated with another wavevector @xmath326 that differs from @xmath1 by a lattice vector @xmath327 , @xmath328 , or @xmath329 that is part of the simple cubic reciprocal lattice , but not part of the reciprocal lattice of bcc . the vectors @xmath1 and @xmath40 are thus equivalent from the point of view of the simple cubic lattice but inequivalent from the point of view of the bcc lattice .",
    "correspondingly , if @xmath1 lies in the fbz of the simple cubic cell , then @xmath40 generally lies within the fbz of the bcc unit cell but the outside the smaller fbz of the simple cubic unit cell .",
    "the result is a `` folding '' of the fbz of the bcc unit cell into the smaller fbz of the simple cubic computational unit cell .",
    "the problem could be avoided either by using a primitive bcc unit cell from the outset , or by using only the reciprocal vectors of the bcc unit cell in the calculation of @xmath330 .",
    "what we have actually done is to use our machinery for generating symmetrized basis functions to generate basis functions that are invariant under a subgroup of @xmath213 group that , at a minimum , includes the identity @xmath217 and the body - centering translational symmetry @xmath331 .",
    "this guarantees that we will only obtain eigenfunctions of the bloch form @xmath186 in which @xmath332 has the periodicity of the bcc lattice , and not just the periodicity of the larger cubic cell .",
    "if only these two symmetry elements are included , the algorithm automatically generates basis functions that are simply plane waves with wavevectors that belong to the reciprocal lattice for bcc , while discarding the remaining `` extinct '' reciprocal lattice vectors of the simple cubic lattice .",
    "the advantage of this approach is its generality : it allows the use of either primitive or non - primitive unit cells , generalizes immediately to the treatment of other kinds of body- and face - centered crystals , and does not require the explicit addition of special extinction conditions to our algorithm ."
  ],
  "abstract_text": [
    "<S> an efficient pseudo - spectral numerical method is introduced for calculating a self - consistent field ( scf ) approximation for the linear susceptibility of ordered phases in block copolymer melts ( sometimes referred to as the random phase approximation ) . </S>",
    "<S> our method is significantly more efficient than that used in the first calculations of this quantity by shi , laradji and coworkers , allowing for the study of more strongly segregated structures . </S>",
    "<S> we have re - examined the stability of several phases of diblock copolymer melts , and find that some conclusions of laradji _ et al . _ regarding the stability of the gyroid phase </S>",
    "<S> were the result of insufficient spatial resolution . </S>",
    "<S> we find that an epitaxial ( @xmath0 ) instability of the gyroid phase with respect to the hexagonal phase that was considered previously by matsen competes extremely closely with an instability that occurs at a nonzero crystal wavevector @xmath1 . </S>"
  ]
}