{
  "article_text": [
    "recently a wide variety of different kinds of words have been studied in the combinatorics on words literature , including the six flavors of the title : closed , palindromic , rich , privileged , trapezoidal , and balanced words . in this paper",
    "we show that , for @xmath2-automatic sequences @xmath1 ( and some analogs , such as the so - called `` fibonacci - automatic '' sequences ) , the property of a factor belonging to each class is expressible in first - order logic ; more precisely , in the theory @xmath3)$ ] .",
    "previously we did this for unbordered factors .",
    "as a consequence , we get that ( for example ) the characteristic sequence of those lengths for which a factor of that length belongs to each class is @xmath2-automatic , and the number of such factors of each length forms a @xmath2-regular sequence .",
    "( for definitions , see , for example , . )",
    "using an implementation of a decision procedure for first - order expressible properties , we can give explicit expressions for the lengths of factors in each class for some famous sequences , such as the thue - morse sequence , the rudin - shapiro sequence , the period - doubling sequence , and the ordinary paperfolding sequence .",
    "for some of the properties , these expressions are surprisingly complicated .",
    "as usual , if @xmath4 , we say that @xmath5 is a prefix of @xmath6 , that @xmath7 is a suffix of @xmath6 , and @xmath8 is a factor of @xmath6 .",
    "by @xmath9 we mean the number of ( possibly overlapping ) occurrences of @xmath6 as a factor of @xmath5 .",
    "for example , @xmath10 .",
    "by @xmath11 we mean the reversal ( sometimes called mirror image ) of the word @xmath5 .",
    "thus , for example , @xmath12 .",
    "by @xmath13 we mean the alphabet @xmath14 of cardinality @xmath2 .    a factor @xmath6 of @xmath5 is said to be _ right - special _ if both @xmath15 and @xmath16 are factors of @xmath5 , for two distinct letters @xmath17 and @xmath18 .",
    "a word @xmath5 is a _ palindrome _ if @xmath19 .",
    "examples of palindromes in english include radar and redivider .",
    "droubay , justin , and pirillo proved that every word of length @xmath0 contains at most @xmath20 distinct palindromic factors ( including the empty word ) .",
    "a word is called _ rich _ if it contains exactly this many .",
    "for example , the english words logology and mississippi are both rich .",
    "for example , mississippi has the following distinct nonempty palindromic factors : @xmath21 for more about rich words , see .    a nonempty word @xmath6 is a _ border _ of a word @xmath5 if @xmath6 is both a prefix and a suffix of @xmath5 .",
    "a word @xmath5 is called _ closed _ (",
    "aka `` complete first return '' ) if it is of length @xmath22 , or if it has a border @xmath6 with @xmath23 .",
    "for example , abracadabra is closed because of the border abra , while alfalfa is closed because of the border alfa .",
    "the latter example shows that , in the definition , the prefix and suffix are allowed to overlap . for more about closed words ,",
    "a word @xmath5 is called _ privileged _ if it is of length @xmath22 , or it has a border @xmath6 with @xmath23 that is itself privileged . clearly every privileged word is closed , but mama is an example of an english word that is closed but not privileged . for more about privileged words , see .",
    "a word @xmath5 is called _ trapezoidal _ if it has , for each @xmath24 , at most @xmath20 distinct factors of length @xmath0 . since for @xmath25",
    "the definition requires at most @xmath26 distinct factors , this means that every trapezoidal word can be defined over an alphabet of at most @xmath26 letters .",
    "an example in english is the word deeded .",
    "see , for example , .",
    "a word @xmath5 is called _ balanced _ if , for all factors @xmath27 of the same length of @xmath5 and all letters @xmath17 of the alphabet , the inequality @xmath28 holds .",
    "otherwise it is _",
    "unbalanced_. an example of a balanced word in english is banana .",
    "we use the terms `` infinite sequence '' and `` infinite word '' as synonyms . in this paper ,",
    "names of infinite words are given in the * bold * font .",
    "all infinite words are indexed starting at position @xmath29 . if @xmath30 is an infinite word , with each @xmath31 a single letter , then by @xmath32 $ ] for @xmath33 we mean the finite word @xmath34 . by @xmath35",
    "$ ] we mean the set @xmath36 .",
    "in this section we define the five sequences we will study . for more information about these sequences , see , for example , .    the _ thue - morse sequence _",
    "@xmath37 is defined by the relations @xmath38 , @xmath39 , and @xmath40 .",
    "it is also expressible as the fixed point , starting with @xmath29 , of the morphism @xmath41 , @xmath42 .    the _ rudin - shapiro sequence _",
    "@xmath43 is defined by the relations @xmath44 , @xmath45 , @xmath46 , @xmath47 , @xmath48 , @xmath49 .",
    "it is also expressible as the image , under the coding @xmath50 , of the fixed point , starting with @xmath29 , of the morphism @xmath51 , @xmath52 , @xmath53 , @xmath54 .    the _ ordinary paperfolding sequence _",
    "@xmath55 is defined by the relations @xmath56 , @xmath57 , @xmath58 , @xmath59 .",
    "it is also expressible as the image , under the coding @xmath60 above , of the fixed point , starting with @xmath29 , of the morphism @xmath61 , @xmath62 , @xmath63 , @xmath64 .    the _ period - doubling sequence _",
    "@xmath65 is defined by the relations @xmath66 , @xmath67 , @xmath68 , and @xmath69 .",
    "it is also expressible as the fixed point , starting with @xmath70 , of the morphism @xmath71 , @xmath72 .    the _ fibonacci sequence _",
    "@xmath73 is the fixed point , starting with @xmath29 , of the morphism @xmath74 , @xmath75 .",
    "before we see how rich words , privileged words , closed words , etc . can be phrased as first - order predicates , let us define a few basic predicates .",
    "first , we have the two basic predicates @xmath76 , which is true iff @xmath77 $ ] : @xmath78 and @xmath79 , which is true iff @xmath80 \\subseteq [ j .. j+n-1]$ ] : @xmath81    next , we have the predicate @xmath82 = { \\bf x}[j+k]),\\ ] ] which checks whether @xmath83 $ ] and @xmath84 $ ] are equal by comparing them at corresponding positions , @xmath85 $ ] and @xmath86 $ ] , for @xmath87 . by a similar principle",
    ", we can compare @xmath83 $ ] with @xmath84^{r}$ ] , but in this paper we only need the special case @xmath88 , i.e. , palindromes : @xmath89 = { \\bf x}[i+n-1-k]).\\ ] ]    from @xmath90 , we derive other useful predicates .",
    "for instance , the predicate @xmath91 tests whether @xmath92 $ ] is a factor of @xmath84 $ ] .",
    "we also define @xmath93 which is true iff @xmath92 $ ] is a border of @xmath83 $ ] .    in the next five sections ,",
    "we obtain our results using the implementation of a decision procedure for the corresponding properties , written by hamoon mousavi , and called walnut , to prove theorems by machine computation .",
    "the software is available for download at    https://cs.uwaterloo.ca/~shallit/papers.html  .",
    "all of the predicates in this paper can easily be translated into hamoon mousavi s walnut program .",
    "files for the examples in this paper are available at the same url as above , so the reader can easily run and verify the results .",
    "we can create a predicate @xmath94 that asserts that @xmath83 $ ] is closed as follows :    @xmath95    a.   there is a closed factor of thue - morse of every length .",
    "b.   there is a 15-state automaton accepting the base-@xmath26 representation of those @xmath0 for which there is a closed factor of rudin - shapiro of length @xmath0 . c.   there is an 11-state automaton accepting the base-@xmath26 representation of those @xmath0",
    "for which there is a closed factor of the paperfolding sequence of length @xmath0 .",
    "it is depicted below in figure  [ pclosed ] .",
    "d.   there is a closed factor of the period - doubling sequence of every length .",
    "e.   there is a closed factor of the fibonacci sequence of every length .",
    "# 1#20.6#1    [ pclosed ]    as we have seen above , the thue - morse sequence contains a closed factor of every length .",
    "we now turn to enumerating @xmath96 , the number of such factors of length @xmath0 . here",
    "are the first few values of @xmath96 :    [ cols=\"^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     we omit the details and just present the computed relations :    @xmath97",
    "trapezoidal words have many different characterizations .",
    "the characterization that proves useful to us is the following : a word @xmath6 is trapezoidal iff @xmath98 . here",
    "@xmath99 is the minimal length @xmath100 for which @xmath6 contains no right - special factor of length @xmath100 , and @xmath101 is the minimal length @xmath100 for which there is a length-@xmath100 suffix of @xmath6 that appears nowhere else in @xmath6 .",
    "this can be translated into @xmath3)$ ] as follows : @xmath102 is true iff @xmath84 $ ] has a right special factor of length @xmath103 , and false otherwise : @xmath104 \\not= { \\bf x}[r+p]).\\end{gathered}\\ ] ]    @xmath105 is true iff @xmath103 is the smallest integer such that @xmath84 $ ] has no right special factor of length @xmath103 : @xmath106    @xmath107 is true iff the suffix of length @xmath108 of @xmath84 $ ] is unrepeated in @xmath84 $ ] : @xmath109    @xmath110 is true iff @xmath103 is the length of the shortest unrepeated suffix of @xmath84 $ ] : @xmath111    @xmath112 is true iff @xmath84 $ ] is trapezoidal : @xmath113    finally , we can determine those @xmath0 for which @xmath1 has a trapezoidal factor of length @xmath0 as follows : @xmath114    a.   there are exactly 43 trapezoidal factors of the thue - morse sequence .",
    "the longest is of length @xmath115 .",
    "b.   there are exactly 185 trapezoidal factors of the rudin - shapiro sequence .",
    "the longest is of length @xmath116 .",
    "c.   there are exactly 57 trapezoidal factors of the ordinary paperfolding sequence .",
    "the longest is of length @xmath115 .",
    "d.   there are exactly 77 trapezoidal factors of the period - doubling sequence .",
    "the longest is of length @xmath117 .",
    "e.   every factor of the fibonacci word is trapezoidal .    for parts ( b ) and ( c ) above",
    ", we used the least - significant - digit first representation in order to have the computation terminate .",
    "our definition of balanced word above does not obviously lend itself to a definition in first - order arithmetic .",
    "however , for binary words , there is an alternative characterization ( due to coven and hedlund ) that we can use : a binary word @xmath6 is unbalanced if and only if there exists a palindrome @xmath118 such that both @xmath119 and @xmath120 are factors of @xmath6 .",
    "thus we can write define @xmath121 , a predicate which is true iff @xmath83 $ ] is unbalanced , as follows : @xmath122 \\not= { \\bf x}[k ] ) ) \\end{gathered}\\ ] ]    a.   the thue - morse word has exactly 41 balanced factors .",
    "the longest is of length 8 .",
    "the thue - morse word has unbalanced factors of length @xmath0 exactly when @xmath123 .",
    "b.   the rudin - shapiro word has exactly 157 balanced factors .",
    "the longest is of length 12 .",
    "the rudin - shapiro word has unbalanced factors of length @xmath0 exactly when @xmath123 . c.   the ordinary paperfolding word has exactly 51 balanced factors .",
    "the longest is of length 8 .",
    "the ordinary paperfolding word has unbalanced factors of length @xmath0 exactly when @xmath123 .",
    "d.   the period - doubling word has exactly 69 balanced factors .",
    "the longest is of length 15 .",
    "the period - doubling word has unbalanced factors of length @xmath0 exactly when @xmath124 .",
    "e.   all factors of the fibonacci word are balanced .    of course",
    ", ( e ) was already well known .",
    "as a consequence we get      a.   the characteristic sequence of those @xmath0 for which @xmath125 has a closed ( resp . , palindromic , maximal palindromic , privileged , rich , trapezoidal , balanced ) factor of length @xmath0 is @xmath2-automatic .",
    "b.   the sequence counting the number of closed ( resp . ,",
    "palindromic , maximal palindromic , privileged , rich , trapezoidal , balanced ) factors of length @xmath0 is @xmath2-regular .",
    "c.   it is decidable , given a @xmath2-automatic sequence , whether it contains arbitrarily long closed ( resp .",
    ", palindromic , maximal palindromic , privileged , rich , trapezoidal , balanced ) factors .",
    "d.   there exists a function @xmath126 such that if a @xmath2-automatic sequence @xmath127 taking values over an alphabet of size @xmath100 , generated by an @xmath0-state automaton , has at least one closed ( resp . , palindromic , maximal palindromic , privileged , rich , trapezoidal , balanced ) factor , then it has a factor of length @xmath128 .",
    "the function @xmath129 does not depend on @xmath127 .",
    "e.   there exists a function @xmath130 such that if a @xmath2-automatic sequence @xmath127 taking values over an alphabet of size @xmath100 , generated by an @xmath0-state automaton , has a closed ( resp .",
    ", palindromic , maximal palindromic , privileged , rich , trapezoidal , balanced ) factor of length @xmath131 , then it has arbitrarily large such factors . the function @xmath132 does not depend on @xmath127 .",
    "g.  badkobeh , g.  fici , and z.  liptk . on the number of closed factors in a word . in a .-",
    "dediu , e.  formenti , c.  martn - vide , and b.  truthe , editors , _ language and automata theory and applications , lata 2015 _ , vol .",
    "8977 of _ lecture notes in computer science _ , pp . 381390 .",
    "springer - verlag , 2015 .",
    "m.  bucci , a.  de  luca , and a.  de luca .",
    "rich and periodic - like words . in v.",
    "diekert and d.  nowotka , editors , _ developments in language theory , dlt 2009 _ , vol .",
    "5583 of _ lecture notes in computer science _ , pp . 145155 .",
    "springer - verlag , 2009 .                          c.  f. du , h.  mousavi , l.  schaeffer , and j.  shallit .",
    "decision algorithms for fibonacci - automatic words , with applications to pattern avoidance . presented at @xmath133 journes montoises",
    "dinformatique thorique , 23 - 26 september 2014 , nancy , france .",
    "preprint available at http://arxiv.org/abs/1406.0670 .",
    "d.  go , h.  mousavi , and j.  shallit . on the number of unbordered factors . in a .-",
    "dediu , c.  martn - vide , and b.  truthe , editors , _ language and automata theory , lata 2013 _ , vol .",
    "7810 of _ lecture notes in computer science _ , pp . 299310 .",
    "springer - verlag , 2013 .",
    "d.  go , l.  schaeffer , and j.  shallit .",
    "subword complexity and @xmath2-synchronization . in m.",
    "p. bal and o.  carton , editors , _ developments in language theory , 17th international conference , dlt 2013 _ , vol .",
    "7907 of _ lecture notes in computer science _ , pp . 252263 .",
    "springer - verlag , 2013 .",
    "tomohiro i , shunsuke inenaga , hideo bannai , and masayuki takeda . counting and verifying maximal palindromes . in e.",
    "chavez and s.  lonardi , editors , _ string processing and information retrieval  17th international symposium , spire 2010 _ , vol .",
    "6393 of _ lecture notes in computer science _ , pp . 135146 .",
    "springer - verlag , 2010 .",
    "j.  shallit .",
    "decidability and enumeration for automatic sequences : a survey . in a.",
    "a. bulatov and a.  m. shur , editors , _ csr 2013 _ , vol .",
    "7913 of _ lecture notes in computer science _ , pp .",
    "springer - verlag , 2013 ."
  ],
  "abstract_text": [
    "<S> we prove that the property of being closed ( resp . , palindromic , rich , privileged trapezoidal , balanced ) is expressible in first - order logic for automatic ( and some related ) sequences . </S>",
    "<S> it therefore follows that the characteristic function of those @xmath0 for which an automatic sequence @xmath1 has a closed ( resp . , palindromic , privileged , rich , trapezoidal , balanced ) factor of length @xmath0 is automatic . for privileged words </S>",
    "<S> this requires a new characterization of the privileged property . </S>",
    "<S> we compute the corresponding characteristic functions for various famous sequences , such as the thue - morse sequence , the rudin - shapiro sequence , the ordinary paperfolding sequence , the period - doubling sequence , and the fibonacci sequence . </S>",
    "<S> finally , we also show that the function counting the total number of palindromic factors in a prefix of length @xmath0 of a @xmath2-automatic sequence is not @xmath2-synchronized .    </S>",
    "<S> [ theorem]corollary [ theorem]lemma [ theorem]proposition    [ theorem]definition [ theorem]example [ theorem]conjecture    [ theorem]remark </S>"
  ]
}