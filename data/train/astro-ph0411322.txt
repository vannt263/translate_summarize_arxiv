{
  "article_text": [
    "the need to register or co - align images in astronomy to an accuracy better than the nyquist sampling density of a detector s point response function is pivotal if one wants to maximize the resolution and signal - to - noise attainable in a mosaic of co - added images .",
    "the absolute accuracy is inhibited by instabilities in telescope pointing control , tracking sensors , and how these behave in the science instrument frame in the presence of thermo - mechanical disturbances .",
    "for instance , imaging detectors on both the _ hubble _ and _ spitzer _ space telescopes provide an _ absolute _ pointing accuracy of @xmath5 0.5 - 1 arcsec ( 1-@xmath6 radial ) . for comparison ,",
    "the highest attainable resolutions are @xmath5 0.02 and 1 arcsec for these telescopes resepectively . without further refinement ,",
    "the current pointing accuracies are insufficient to exploit the near - diffraction limited resolution capabilities the detectors can provide .",
    "factors of 10 - 20 improvement in pointing are required for optimal image registration .",
    "good image registration enables extraction and position determination of sources to fainter flux levels for a given signal - to - noise ratio .",
    "comparison or registration with astrometric sources whose positions are known to better than a few percent of the observed image pointing uncertainty also allows refinement of image frame pointings in the international coordinate reference system ( icrs ) .",
    "absolute pointing refinement can be achieved to an accuracy approaching that of the astrometric catalog used or better given good match statistics .",
    "this alleviates possible ambiguities when performing cross - identification / correlation of extracted sources across wavelength dependent catalogs .",
    "furthermore , the accurate placement of slits for follow - up spectroscopic studies requires source positions known to better than a few tenths of an arcsecond in the icrs , or until the desired positional accuracy is limited by centroiding error in the array frame .    broadly speaking",
    ", image registration methods can be loosely divided into three classes : algorithms which use information in pixel space directly , e.g. , by correlating common objects @xcite ; algorithms which attempt to match features or identified parts of objects known as `` graph - theoretic '' methods @xcite ; and algorithms which use the frequency domain e.g. , methods based on computing cross - correlation power spectra via the fast fourier transform @xcite .",
    "the two conventional methods for registering images in _ astronomy _ involve either interactively identifying common point sources in overlapping image fields ( i.e. , object correlation ) , or , using actual detector acquired pointings ( with inherent uncertainties ) directly and estimating relative image offsets therefrom .",
    "these methods are available in most data reduction packages ( e.g. iraf - @xcite ; starlink - @xcite ) and are mostly limited by accuracies in point source centroids , sufficient match statistics , telescope pointing control , or , subject to random - walk ( cumulative ) uncertainties .",
    "a number of robust methods for astrometric calibration of single images have also been implemented in the commonly used data reduction packages @xcite , although an automated , self - consistent means for simultaneous registration and refinement of multiple astronomical images comprising a mosaicked region is generally lacking .",
    "the single image methods assume one has sufficient numbers of astrometric matches to mitigate against uncertainties in the centroids of extracted sources .",
    "we have gone a step further by using the available point - source content to obtain a global refined solution for all frames such that all matched point - source positional discrepancies in all frame - to - frame and frame - to - absolute overlaps are minimized . combining the relative and absolute source information",
    "reduces the demand on having sufficient astrometric matches .",
    "this becomes important for mid to far - infrared imagery where cross - wavelength astrometric calibration is often unreliable due to differing sensitivities , source populations and detector point spread function sizes .",
    "we have developed an algorithm to register and refine simultaneously the pointing of an ensemble of astronomical images to accuracies better than that inherent in point source centroid uncertainties ( and dictated by point source match statistics ) .",
    "this paper describes the global minimization algorithm and presents a case study using data from _",
    "spitzer s _ infrared array camera ( irac ) .",
    "the outline is as follows .",
    "section  [ algor ] describes the algorithm and pointing refinement accuracies expected therefrom .",
    "section  [ sim ] validates the algorithm using a monte carlo simulation of irac data .",
    "section  [ iracobs ] compares these results to real observations acquired with irac .",
    "discussion and conclusions are given in section  [ conc ] .",
    "the algorithm has been implemented into a stand - alone software package called _ pointingrefine_. the main inputs to _",
    "pointingrefine _ are a fits image list , with each fits image containing the standard world coordinate system ( wcs ) keywords @xcite , an accompanying list of flux - calibrated point - source extraction tables , optional astrometric source list , and configuration parameters .",
    "the software expects point source extraction tables adhering to the format generated by the _",
    "spitzer science center _ ( ssc )",
    "source extractor .",
    "the complete _ pointingrefine _ package is available at _ http://ssc.spitzer.caltech.edu / postbcd/_. this includes programs to perform point source extraction as well , although these will not be described here .",
    "a general overview of the processing steps involved in the global minimization algorithm ( the heart of _ pointingrefine _ ) is shown in figure  [ fig1 ] . in the following sections , we expand on some of the more important computational steps of this algorithm .      prior to source matching , we first compute the total number of image - pairs expected to be overlapping ( which could potentially contain correlated / common sources ) in the input ensemble of images .",
    "this is used for efficient a - priori memory allocation .",
    "given a number of images , @xmath7 , the maximum number of distict frame pairs that can mutually overlap is    @xmath8    this maximum occurs when all images are stacked more - or - less on top of each other . for a sparse mosaic ,",
    "this number is smaller and thus puts less of a burden on the required memory .",
    "the total number of potential overlapping frame pairs is found by computing the distances between the centers of every image pair and finding whether the distance is less than the typical radius of a circle enscribing an image .",
    "source positions from all extraction tables ( including absolute astrometric references if specified ) are sorted in declination .",
    "this preconditioning speeds up the source matching procedure , converting it from an @xmath9 to an approximate @xmath10 linear process .",
    "every possible overlapping image pair is scanned for common point sources in the ra , dec coordinate system .",
    "both position and flux matching is performed .",
    "the position match step attempts to find sources falling within a nominal search radius ( typically several times the root sum squares of prior image pointing uncertainty and extraction centroid error ) .",
    "if more than one match is found within the search radius , no match is declared , due to possible ambiguity . in other words , only singly matched sources within the search radius are used .",
    "sources are also simultaneously matched in flux .",
    "a flux match is satisfied if two fluxes fall within a maximum tolerable relative flux difference threshold .",
    "the software includes options to re - scale the input fluxes of astrometric references to be commensurate with those of actual extractions .",
    "a minimum of two matches per image is enforced to declare a correlated image pair , since this is the minimum required to estimate a rotational offset between the pair unambiguously .    in preparation for the global minimization step ( see below ) , all point source match positions and uncertainties are mapped into the pixel coordinates of a cartesian reference image frame .",
    "the definition of this reference depends on whether absolute or relative refinement is desired .",
    "the _ pointingrefine _ software distinguishes between these options from its given inputs .",
    "two inputs are required for absolute refinement .",
    "first , the software expects a fiducial image frame ( fif ) .",
    "this is a file listing various wcs parameters that define the tangent point and boundary of a `` fiducial image '' encompassing all images .",
    "second , a list of astrometric ( absolute ) sources that fall within the fif boundary is required .",
    "the fif acts as an effective input image whose sources are the astrometric references .",
    "refinement with respect to such a fif ensures both absolute and relative refinement amongst images . in relative refinement mode ,",
    "all input images can be registered and refined with respect to a single input image . in this mode , either the software selects an image from the input list which is maximally correlated ( has most overlaps ) with other images , or the user can specify their own .      consider the simple three - image mosaic in figure  [ fig2 ] .",
    "image `` 1 '' defines the `` fiducial '' reference frame .",
    "the circles represent point sources detected from each overlapping image pair transformed into the reference frame of image 1 .",
    "the filled circles are sources extracted from image _",
    "n _ and the open circles are sources extracted from either image 1 or _",
    "m_. the matched source pairs are shown offset from each other to mimic the presence of random pointing uncertainty in each input image .",
    "these are the offsets we wish to compute and use to correct each frame pointing .",
    "a one - dimensional representation of the projection geometry in the reference image frame is depicted in figure  [ fig3 ] .",
    "all input images have sizes in the reference frame that depend on their distance from the reference image tangent point . the projected linear size scales with angular distance @xmath11 as @xmath12 .",
    "the _ pointingrefine _ algorithm appropriately accounts for the inflation of centroid uncertainties and separations of correlated sources when projected into the reference frame .",
    "a potential problem for the algorithm is if image sizes and mosaic extents are large enough to cause a non - uniform dependence in scale over the region in which an input image is projected .",
    "the dependence of this effect with @xmath11 , however , is weak .",
    "for instance , the projected scale varies by @xmath13 across an image @xmath14 in size at angular distances @xmath15 .",
    "the main assumption of the algorithm is that the random uncertainty in measured twist angle of an individual image frame ( @xmath16 in figure  [ fig2 ] ) is small enough to ensure @xmath17 ( see below ) .",
    "@xmath18 is a good working measure for the purposes of this algorithm .",
    "this is justified for the _ spitzer _ science instruments where the absolute twist angle uncertainty is typically @xmath19 ( 1-@xmath6 ) .    in a rectilinear coordinate system (",
    "say that defined by the frame of image 1 in figure  [ fig2 ] ) , the positions of a point source _ i _ detected from images _",
    "m _ and _ n _ are related via the transformation :    @xmath20    where @xmath16 is a rotational offset , @xmath21 , @xmath22 orthogonal translations , and ( @xmath23 , @xmath24 ) the center coordinates of image _ m _ in the reference image frame .",
    "the rotation @xmath16 is measured in a counterclockwise sense so that a rotation followed by orthogonal translations in _ x _ and _ y _ of image _ m _ will align the sources ( open circles ) detected therein with those detected in image _",
    "n_.    the assumption of small twist angle uncertainty ( see above ) implies @xmath17 and @xmath25 and thus , the pair of equations defined by ( [ fulltran ] ) can be linearized in @xmath16 as follows .    @xmath26    where ( @xmath27 , @xmath28 ) represents a position , corrected for unknown image rotation and orthogonal translations .",
    "we define a cost function @xmath29 , representing an inverse - variance weighted sum of squares of all matched point - source positional differences from all overlapping image pairs ( @xmath30 , @xmath31 ) :    @xmath32 ^ 2 + \\frac{1}{\\delta y_i^{m , n}}[\\tilde{y}^n_i - \\tilde{y}^m_i]^2\\right\\}\\:\\:+\\:\\:l_{apriori}\\:\\:,\\ ] ]    where @xmath33    and the @xmath34 represent variances in extracted point source centroids .",
    "the summations in equation  [ cost ] are over all matched point - sources from all image overlaps , including sources matched to any astrometric references present in the fif if available .",
    "the fif or absolute reference frame ( as defined in section  [ setup ] ) is treated as an effective input image when source matching is performed .",
    "the additive term @xmath35 in equation  [ cost ] represents an `` a - priori '' weighting function which makes use of actual measured pointing uncertainties of the images .",
    "this function is defined as :    @xmath36    where the @xmath37 , @xmath38 ( @xmath39 ) represent _ measured _ pointing variances ( in the icrs ) transformed into the reference image frame .",
    "the purpose of including @xmath35 is to avoid over - refining or biasing those images whose inherent measured pointing uncertainties are already small ( within nominal requirements ) . in other words , those images whose",
    "uncertainties are known to be small a - priori , will have have a larger contribution to @xmath35 relative to the correlated source term ( double sum in equation  [ cost ] ) .",
    "consequently , the solution will be biased towards minimizing @xmath35 and not the correlated source term which could potentially degrade expected image offsets ( and final refined pointings ) . in the limit @xmath40",
    ", the global minimum will be closer to @xmath41 .",
    "vice - versa , large pointing uncertainties will bias the solution towards the correlated source term where refinement via point - source matches is obviously needed .",
    "equation  [ cost ] can be rewritten in terms of physical image offsets @xmath42 , @xmath21 and @xmath22 for an arbitrary image _ m _ via use of equations  [ xytran ] and [ apriori ] :    @xmath43 ^ 2\\:\\:+\\\\ & \\:&\\frac{1}{\\delta y_i^{m , n}}\\nonumber \\left[y^m_i + ( x^m_i - x^m_c)\\delta \\theta^m + \\delta y^m - y^n_i - ( x^n_i - x^n_c)\\delta \\theta^n + \\delta y^n\\right]^2\\biggr\\}\\:\\:+\\\\ & \\:&\\frac{(\\delta x^m)^2}{\\sigma^2_{xm}}+ \\frac{(\\delta y^m)^2}{\\sigma^2_{ym}}+ \\frac{(\\delta \\theta^m)^2}{\\sigma^2_{\\theta m}}+ \\frac{(\\delta x^n)^2}{\\sigma^2_{xn}}+ \\frac{(\\delta y^n)^2}{\\sigma^2_{yn}}+ \\frac{(\\delta \\theta^n)^2}{\\sigma^2_{\\theta n}}\\:\\biggr].\\end{aligned}\\ ] ]    the cost function defined by equation  [ bigcost ] can be treated as a standard @xmath44 statistic to the extent that point source centroid uncertainties are independently random and gaussian , a good approximation in this case . the probability density function for @xmath29 about its global minimum is therefore the @xmath44 distribution for @xmath45 degrees of freedom where @xmath46 @xmath47 is the total number of point - source matches in all image overlap regions and @xmath7 the total number of images containing the detected matches ( including the reference image ) .",
    "the total number of parameters to solve is actually @xmath48 since we have three offsets ( @xmath42 , @xmath21 and @xmath22 ) for every image _ m _ and we exclude the reference image which by definition is constrained to have @xmath49 , @xmath50 and @xmath51 .    our aim is to minimize @xmath29 with respect to all image offsets @xmath16 , @xmath21 and @xmath22 for every correlated image _",
    "m_. at the global minimum of @xmath29 , partial derivatives with respect to these three offsets for each image _ m _ are required to vanish :    @xmath52    evaluating these partial derivatives leads to a set of three simultaneous equations for each image in the ensemble . for @xmath7",
    ", we therefore have @xmath53 simultaneous equations in @xmath53 unknowns .",
    "each image _ m _ of an ensemble @xmath54 could be potentially correlated ( contain sources in common ) with any other image _ n _ where @xmath55 and @xmath56 . from the conditions defined in equation  [ partials ] , the simultaneous system of equations used to solve for the offsets of all images _ m",
    "_ , can be represented as the matrix equation :    @xmath57    equation  [ matrixeq ] is of the form @xmath58 .",
    "elements of the coefficient matrix @xmath59 and the right - hand - side column vector @xmath60 are given in appendix  [ appi ] .",
    "the solution for the column vector @xmath61 with @xmath53 unknowns can be obtained using linear sparse matrix methods since , depending on the mosaic geometry , a large number of the matrix elements can be zero . in general , the fraction of zeros will be @xmath62 ( @xmath63 ) .",
    "the @xmath64 minimum will occur when _ every _ image of the ensemble is correlated with every other , such as in a coadded stack .",
    "the level of sparsity in @xmath59 will increase with non - zero elements along a block diagonal if one desires to tie and refine images with respect to astrometric absolute references _ alone_. in this specialized case , _",
    "n = the reference image _ and all elements with superscript _",
    "n _ in @xmath59 will be zero .",
    "in general , the minimum and maximum possible _ number _ of zeros in the matrix @xmath59 are    @xmath65    respectively .",
    "we use the umfpack library to solve the matrix equation  [ matrixeq ] .",
    "this is adapted for solving large nonsymmetric matrix systems .",
    "the library includes an iterative scheme to correct solutions for the inevitable accumulation in round - off error during the lu - factorization stage .",
    "we also compute the full error - covariance matrix for all image offsets ( @xmath16 , @xmath21 , @xmath22 ) , which is given by the inverse of the coefficient matrix : @xmath66 ( e.g. , @xcite ) .",
    "variances in each offset are along the diagonal of @xmath67 and covariances are given by off - diagonal elements .",
    "the covariance matrix @xmath67 is computed using the same matrix solver as above by repeatedly solving for each unknown column @xmath68 in @xmath69 such that @xmath70 where @xmath71 is the corresponding column in the identity matrix .",
    "an analysis of the covariance matrix using real data is presented in appendix  [ appii ] .",
    "images which are _ not _ correlated ( lack point source matches ) with any others in the input ensemble can not contribute to the globally minimized cost function @xmath29 . for these images ,",
    "the _ pointingrefine _ software explicitly sets their reference frame offsets to zero and no refinement of their pointing is possible . as a further detail",
    ", the inclusion of the a - priori weighting function @xmath35 ( equation  [ apriori ] ) guarantees that the matrix in equation  [ matrixeq ] will be non - singular .",
    "the priors provide at least one measurement per image .",
    "if these are omitted from the cost function ( equation  [ cost ] ) , then there are cases where the matrix could be singular .",
    "this can occur if the input image ensemble contains clusters of correlated images disjoint from each other with a non - contiguous / broken path existing between the clusters .",
    "this situation leads to an under - represention of images across the full simultaneous system of equations and the determinant will be zero . as indicated in the processing flow of figure  [ fig1 ] ,",
    "if this occurs in _ absolute refinement mode _ , a second pass computation is attempted and only those frames which contain absolute astrometric matches are used . no relative frame - to - frame information is used and images are refined based on their absolute source content alone .",
    "the matrix effectively becomes block diagonal and a non - zero determinant is guaranteed . in _ relative refinement mode _",
    ", no attempt is made to perform registration within each disjoint sub - ensemble .",
    "instead , the software will abort with a message indicating that disjoint clusters exist .    once image offset corrections",
    "( @xmath16 , @xmath21 , @xmath22 ) and associated uncertainties have been determined in the reference image frame , the final step involves refining the celestial pointing and orientation of each image _ m_. this is performed by correcting the pointing centers ( @xmath23 , @xmath24 ) of each image in the reference image frame via equation  [ xytran ] , i.e. ,    @xmath72    and then transforming back to the sky to yield refined pointings in the icrs .",
    "image orientations are refined in a similar manner .",
    "for these , we correct and transform two fiducial points per image to determine uniquely the refined position angle . the main outputs of the _ pointingrefine _ software are additional wcs keywords written to fits image headers representing refined pointings and orientations on the sky ( see processing flow in figure  [ fig1 ] ) .",
    "the accuracy in pointing refinement or registration can be severely limited by possible systematics .",
    "for example , inaccurately calibrated image scale and/or distortions known a - priori to be position dependent will bias extraction centroids and have adverse affects on the separations of bonafide source matches and hence final globally minimized solutions .",
    "a method to test for possible contamination from systematics involves examining distributions of matched source separations after refinement and comparing these with that contributed by ( random ) centroid uncertainties .",
    "this will be performed using real data in section  [ iracobs ] .",
    "the presence of absolute - astrometric point sources are an important ingredient for refinement and registration in general .",
    "these reduce the potential for a biased random walk in refined pointing with distance of an image from a fiducial reference .",
    "such effects are also alleviated by using appropriate prior pointing uncertainty information in the global minimization cost function ( see equation  [ cost ] ) .",
    "absolute astrometric references provide a set of `` anchor points '' to which all extractions will be attracted . if one desires to perform _ absolute _ refinement with little or no astrometric references , then sufficient numbers of images",
    "are needed to increase the number of potential matches in frame overlap regions for a single point source .",
    "this is needed in order to approach a normal distribution about the expected _ absolute _ source position . in other words ,",
    "large numbers of correlated source positions will ensure that the mean position of a correlated source cluster is close to the `` truth '' , or that which will result after refinement ( assuming no systematics as discussed above ) . due to the rarity of cases with numerous image overlaps providing good normally - distributed sampling ,",
    "it is advised to use astrometric references wherever possible .",
    "the accuracy to which we can refine the pointings of an ensemble of mutually correlated images predominately depends on the number of point source matches available ( both relative and absolute ) .",
    "with randomly distributed uncertainties in point source centroids , it is expected that the mean separation between matched source positions is approximately gaussian after refinement , by virtue of the central limit theorem . in this limit ,",
    "the ( radial ) uncertainty in refinement of a single image will scale as    @xmath73 + n_{abs}}},\\ ] ]    where @xmath74 and @xmath75 represent respectively the number of frame - to - frame and frame - to - absolute source match pairs in _ all _ overlap regions associated with the image , @xmath76 is a typical source extraction centroid uncertainty , and @xmath77 is an astrometric source position uncertainty .",
    "this approximation assumes that @xmath78 or @xmath79 when either @xmath80 or @xmath81 respectively . for no astrometric matches ,",
    "we set @xmath82 and @xmath83 , and equation  [ approx ] reduces to @xmath84 .",
    "we expect to measure source extraction centroids to better than @xmath85 pixel , ( @xmath86 for _ spitzer s _ irac focal plane arrays ) . if we assume for example astrometric positional errors of @xmath87 ( conservatively speaking ) , then to refine image pointings to an accuracy better than @xmath88 will require at least five _ astrometric _ point - source matches per frame if @xmath89 , or less , if @xmath80 .",
    "one can see that with more point - source matches , the better the refinement .",
    "this assumes the observational setup allows for sufficient frame - to - frame overlap to ensure good numbers of relative matches @xmath74 .",
    "if this is not the case , one will have to resort to using pure astrometric ( absolute source ) matches alone .    to summarize , corrections for optimal refinement will effectively be given by the _",
    "magnitude _ of frame pointing uncertainties with errors approximated by equation  [ approx ] .",
    "the latter assumes that in the limit of increasing number of matches , the mean source separation per image overlap region is approximately normally distributed with an uncertainty determined exclusively by point source centroid uncertainties .",
    "any position - dependent systematic offset between source matches such as nonuniform pixel scale or inaccurately calibrated distortion will limit the refinement accuracy to the size of systematic error involved .",
    "we quantitatively assess the performance of the above algorithm using a simulation of 1000 mosaicked images , with each image s coordinates modeled with an uncertainty drawn from a gaussian distribution .",
    "the simulation is generic in that it represents a good overall representation of the type of data that could be acquired with modern optical / near - infrared detectors to moderately faint magnitudes ( @xmath90 or @xmath91 ) . to facilitate a comparison with real observations in section  [ iracobs ] , we have chosen to model the source count distribution and detector properties with that expected ( and more or less observed ) in the @xmath92 band of _",
    "spitzer s _ irac instrument .",
    "a more detailed description will be given in section  [ iracobs ] .",
    "the `` truth '' source flux - density distribution was simulated using the models of @xcite .",
    "these assume a high galactic latitude stellar model , several galaxy luminosity functions depending on galaxy morphological type , and exploit a large library of spectral energy distributions .",
    "this simulation was used extensively for predicting _ spitzer _ source populations @xcite and for validating processing pipelines .",
    "the simulation steps are as follows .    1 .",
    "a `` truth '' list of random source flux densities was generated using the models of @xcite covering an area of  0.45 square degrees down to a flux density of @xmath93 jy at @xmath92 ( equivalent to @xmath94 magnitudes in the vega system ) .",
    "truth sources were assigned both random and correlated positions within the area to be mosaicked .",
    "galaxies were assumed to have a weak correlated component with amplitude ( excess above random ) based on an empirical @xmath95-band 2-point angular correlation function : @xmath96 .",
    "a pixel scale of @xmath97 ( characteristic of the irac arrays ) was used when mapping sources to the pixel frame of the mosaic .",
    "truth sources were convolved with a point spread function ( psf ) and @xmath98 central pixel flux . ] scaled by the appropriate source flux .",
    "psf - convolved truth sources were mapped into the mosaic frame with no pixel resampling .",
    "4 .   1000 ( @xmath99 pixel ) `` truth image '' frames were generated from the full mosaic area using a dither and mapping strategy which assumed @xmath100 adjacent image overlap .",
    "the optimal map geometry for this 1000-image set was generated by d. shupe ( 2002 , _ ssc _ , private communication ) .",
    "ra , dec , and twist angle information is also attached to each image at this stage .",
    "5 .   a new set of 1000 images",
    "was generated ( our simulated control sample ) with uncertainties added to image pointings and position angles .",
    "pointing offsets ( prior uncertainties ) were modeled as gaussian random deviates along each independent orthogonal image axis .",
    "these were drawn from a zero - mean gaussian distribution with @xmath101 per axis .",
    "this choice for @xmath6 is based on a pre - launch pointing knowledge of @xmath102 ( 1-@xmath6 radial ) for _ spitzer _ in the science instrument frame . even though _ spitzer _ can now actually do better than this by a factor of @xmath103 ( section  [ iracobs ] ) , the ultimately refined pointings are independent of the magnitude of reasonable simulated prior uncertainty assumed ( see below ) .",
    "twist angle uncertainties were modeled as gaussian with @xmath104 . a smoothly varying background adjusted with the expected poisson and ( irac band-1 ) read - noise per pixel",
    "was added to each image .",
    "6 .   an absolute source list ( representing astrometric references ) was generated by taking the brightest _ truth _ sources which gave a mean density of @xmath105 sources per @xmath106 image region .",
    "this resulted in 3030 _ truth _ sources . to imitate an astrometric catalog ,",
    "the sources were assigned with positions modeled as @xmath107 along each axis with @xmath108 drawn from a gaussian distribution with @xmath109 .",
    "this is typical for sources in the _",
    "2mass _ point source catalog to @xmath110 ( see section  [ iracobs ] for details regarding the _ 2mass _ catalog )",
    "the _ ssc _ point source extractor was used on each simulated ( control ) image to extract sources above a threshold of @xmath111 .",
    "this resulted in @xmath112 extractions per frame .",
    "the _ pointingrefine _ software was executed on the 1000 image control sample .",
    "a source match radius of @xmath113 was used to comfortably accomodate prior image pointing errors and extraction centroid errors ( typically @xmath114 1-@xmath6 per axis ) .",
    "simultaneous flux matching was also applied between frame - to - frame and frame - to - absolute ( astrometric ) matches with maximum flux difference thresholds of 5 and 10% respectively .",
    "a zoomed - in ( @xmath115 ) section of our 1000-image simulation ( with image pointing errors ) is shown in the left panel of figure  [ fig4 ] .",
    "on the right is the same section after pointing refinement .",
    "the increase in resolution is dramatic .",
    "there is a factor of @xmath116 decrease in mean source match separation leading to more localized point source flux distributions and detectability to fainter levels . in this test",
    ", the surface brightness is increased by factors of @xmath117 for detected sources after refinement .",
    "this is as expected given that the 1-@xmath6 radial image pointing uncertainty is of the order the input pixel size , and the instrinsic psf has fwhm @xmath118 .    to get a more quantitative assessment of the performance of _ pointingrefine",
    "_ , we compare the distribution of separations between image center pointings of `` truth '' and simulated ( control sample ) images before and after refinement .",
    "this is shown in the top panel of figure  [ fig5 ] .",
    "two different runs of _ pointingrefine _ were performed based on the number of ( brightest ) extractions used per image .",
    "one gave an average of @xmath119 relative ( frame - to - frame ) and @xmath120 absolute - astromeric source matches per image ( the `` 10/20-match '' case ) , and the second resulted in an average of @xmath121 relative and @xmath122 absolute matches per image ( the `` 2/3-match '' case ) .",
    "it should be noted that two matches per image is the absolute minimum to determine unambiguously two orthogonal shifts and an orientation per frame ( i.e. the number of degrees of freedom ( # dof ) @xmath123 ) .",
    "the dispersion in image separation relative to truth _ after refinement _ for the `` 10/20-match '' case is @xmath124 mas1 milli - arcsecond ] ( 1-@xmath6 radial ) .",
    "for the `` 2/3-match '' case , this is @xmath125 mas . for the given match statistics , these numbers are more or less consistent with the simple scaling relation given by equation  [ approx ] .",
    "offset distributions along each axis are shown in the lower panel of figure  [ fig5 ] where the open circle represents the 2-@xmath6 contour for the `` 2/3-match '' case .    by comparing differences in image radial separations before and after refinement",
    ", we find that over 890 images have their pointing refined to better than 95% relative to `` truth '' ( for the `` 10/20-match '' case ) .",
    "the top panel in figure  [ fig6 ] shows the distribution in fractional refinement .",
    "this quantity is defined as the ratio of separations : @xmath126 . for the `` 2/3-match '' case , slightly less than half",
    "have the same amount of refinement , although most images are refined to better than 80% , corresponding to a discrepancy of @xmath127 mas within truth image positions .",
    "thus the refinement is very good , even with minimal matches .",
    "the bottom panel in figure  [ fig6 ] shows distributions in matched source radial separations before and after refinement .",
    "uncertainties in both image pointing and source extraction centroids ( or radial separation ) contribute to the dispersion in the _ unrefined _ distribution .",
    "image pointing uncertainties dominate , with a @xmath128 contribution compared to @xmath129 for extraction centroids ( both 1-@xmath6 radial ) . after pointing refinement",
    ", the dispersion in radial source separation is expected to be dominated exclusively by extraction centroid errors and indeed , the distributions confirm this for both the `` 2/3 '' and `` 10/20-match '' case ( figure  [ fig6 ] bottom left ) .",
    "the distribution for the `` 2/3-match '' case is narrower since such matches were performed using the brightest extractions per image , and these inherently have better determined centroids .",
    "the separation between two source extraction centroids ( @xmath130 ) and ( @xmath131 ) is given by @xmath132^{1/2}.\\ ] ] since a majority of extractions are unresolved point sources with very circular error - ellipses , we can ignore any correlations between uncertainties along each axis . to a good approximation",
    ", the uncertainty in radial separation between any two centroids can therefore be written : @xmath133    where ( @xmath134 ) and ( @xmath135 ) are centroid variances in each axis for sources @xmath136 and @xmath137 respectively . a comparison between uncertainties in matched source radial separation ( equation  [ radunc ] ) and actual separations ( equation  [ euclid ] ) after refinement is shown in the top panel of figure  [ fig7 ] ( for `` 10/20-match '' case )",
    "they are both mutually consistent , although the spread is greater at separations @xmath138 .",
    "after refinement and in the absence of systematics , any residual separation in a matched source pair must be due to intrinsic centroiding error alone .",
    "since separations between matched sources along each axis are to a good approximation independently random and normally distributed with zero mean ( @xmath139 ) , the quantity @xmath140 ( equation  [ euclid ] ) can be shown to follow a @xmath141 distribution with two degrees of freedom ( e.g. , @xcite ) .",
    "this special case is also known as the rayleigh distribution : @xmath142},\\ ] ] where @xmath143 is a parameter characterizing the width .",
    "this can be written in terms of the second moment ( variance ) of @xmath144 as follows @xmath145    for a given uncertainty @xmath146 as computed from equation  [ radunc ] , the variation in the density of points with @xmath140 along any horizontal cut in figure  [ fig7 ] is qualitatively consistent with that predicted by equations  [ rayleigh ] and  [ beta2 ] .",
    "the bottom panel of figure  [ fig7 ] shows the dependence of the reduced @xmath44 ( effectively the cost function in equation  [ bigcost ] divided by number of degrees of freedom defined by equation  [ dof ] . ) as a function of increasing number of images @xmath147 in our 1000-image simulation .",
    "it s important to note that image offsets are not re - computed using repeated global minimizations for each new set of images @xmath147 .",
    "instead , the original full 1000-image solution of image offsets is used throughout to re - compute @xmath44 from equation  [ bigcost ] as @xmath147 is increased for all image pairs ( @xmath148 ) such that @xmath149 . as one approaches the full image set of @xmath150 , one expects the reduced @xmath44 to converge to unity if , on average , residuals in source separations after refinement are purely consistent with extraction centroid uncertainties .",
    "the lower reduced @xmath44 values for smaller image numbers ( and particularly for all image numbers in the `` 2/3-match '' case ) is due to the nonlinear behavior in @xmath44 when the number of degrees of freedom is small .",
    "better fits ( smaller @xmath44 ) can be obtained for very low numbers of degrees of freedom . in figure  [ fig7 ] ( bottom panel ) , only the `` 10/20-match '' case ( with absolute refinement as studied above ) shows approximate covergence to one , and the other curves are not far from it .",
    "also shown is a case where only relative frame - to - frame matches and no astrometric references are used .",
    "this case tends to show a slightly higher reduced @xmath44 ( @xmath151 ) , which is significant since it is almost 20 standard deviations from the expected value in reduced @xmath44 ( @xmath152 , where # dof@xmath153 ) .",
    "this was traced as being due to slightly under - estimated undertainties in extraction centroids .",
    "this is not seen in the absolute refinement case ( solid curve ) since absolute astrometric uncertainties are themselves over - estimated and their ( almost equal ) contribution tends to lower the effective @xmath44 when combined with relative frame - to - frame matches .    to summarize ,",
    "we have presented a simulation to ascertain the performance of the _ pointingrefine _ algorithm .",
    "the model - dependent parameters entering our simulation can be isolated to properties of @xmath92 source populations , specifics of the irac band-1 array , such as psf and pixelization , and a - priori telescope pointing knowledge .",
    "these can be appropriately rescaled to model other wavelengths and detectors .",
    "however , in the absence of systematics in the locations of potential matches between frames ( both absolute and relative ) , and regardless of instrumental setup or detecter properties , the accuracy in refined pointing is purely dictated by the accuracy of point source centroids and match statistics .",
    "our simulation ( figures  [ fig5 ] and  [ fig6 ] ) indeed shows that the refined pointing will typically never be worse off than the ( combined ) centroid uncertainties of matched pairs of sources .",
    "a well sampled and characterized psf is expected to give centroiding accuracies to better than one - tenth of a resolution element .",
    "if errors are independently random , good match statistics can then only work in our favor to give the desired @xmath154 improvement in pointing accuracy .",
    "the infrared array camera ( irac ) is one of three focal plane instruments on the _ spitzer space telescope _",
    "irac provides simultaneous @xmath155 images at 3.6 , 4.5 , 5.8 and @xmath4 ( bands 1 - 4 ) .",
    "all four detector arrays in the camera are @xmath156 pixels in size , with a pixel size @xmath157 .",
    "we present here the results of a case study of observations acquired with irac during the in - orbit checkout period ( oct . 2003 ) . in this section ,",
    "we validate the pointing performance of irac and estimate the accuracy of refinement that can be achieved using a standard astrometric catalog and comparisons with our simulation of the @xmath92 band from section  [ sim ] .    the observational request used for our case study",
    "consists of 105 regularly spaced images arranged in a rectangular raster pattern .",
    "the coverage map and geometry is shown in figure  [ fig8 ] .",
    "adjacent images have @xmath158 overlap in each axis , with a coverage of 6 and 12 pixels at the edges and ( inner ) corners respectively .",
    "the mapping was performed in repetitive horizontal scans as shown by arrows in figure  [ fig8 ] .",
    "the first image is at top right and the last at bottom left .",
    "all images across all bands were preprocessed for removal of instrumental signatures using the _ ssc s _ irac pipeline and raw pointing information was attached to fits headers .",
    "source extraction was then performed using the _ ssc _ source extractor with psfs characterized from in - flight data .",
    "sources were extracted to a uniform signal - to - noise ratio of @xmath111 in each band , resulting in an average of @xmath159 , 24 , 13 and 6 extractions per image for bands 1 , 2 , 3 and 4 respectively .",
    "errors in flux - weighted centroids were on average @xmath160 , 0.22 , 0.26 and @xmath161 ( 1-@xmath6 radial ) for each band respectively .",
    "we used data from the two - micron all sky survey ( _ 2mass _ ) to define a standard astrometric catalog for all irac bands .",
    "@xcite used the usno ccd astrograph catalog ( ucac ) ( which is accurate to @xmath120 mas ) to perform an assessment of the accuracy of _",
    "2mass _ astrometry .",
    "they found random errors of _ 2mass _ positions of @xmath162 to 140 mas radial to a limiting @xmath163 magnitude of 15 .",
    "we use astrometric sources detected in the _ 2mass _ @xmath163 band ( @xmath164 ) which is well suited to irac , and as a good working measure , we impose a magnitude limit of @xmath165 . to this limit and at the highest galactic latitudes ( @xmath166 ) , one expects to find at least two astrometric sources per @xmath155 irac field @xmath167 of the time . in the galactic plane anti - center , this increases to at least 30 sources 80% of the time ( j. surace 2000 , _ ssc _ , private communication ) .    using source extractions and astrometric references , the _ pointingrefine _ software was executed on each of the four , band - dependent 105-image ensembles .",
    "guided by a post - facto analysis of typical source separations and flux differences , point - source matching was performed using a nominal search radius of @xmath168 and simultaneous flux matching performed with relative ( frame - to - frame ) and astrometric ( frame - to - absolute ) flux difference thresholds of 4% and 50% respectively across all bands .",
    "flux matching thresholds were set conservatively high to account for relative and absolute photometric calibration errors and instrinsic scatter between source populations detected in the _",
    "2mass _ and irac bands .",
    "relative and astrometric match statistics are summarized in table  [ tab1 ] .",
    "figure  [ fig9 ] shows distributions in matched source radial separations before and after refinement for all bands .",
    "relative and astrometric matches have been separated .",
    "these distributions provide a powerful diagnostic with which to assess the in - flight pointing performance in the irac science instrument frame .",
    "the end - to - end pointing accuracy is a function of the inherent star - tracker accuracy , the spacecraft control system , how well the star - tracker bore - sight is known in the telescope pointing frame and focal plane array ( science instrument ) frame , and variations in these due to thermo - mechanical deflections . _",
    "spitzer s _ star - tracker assembly alone provides pointing and control to better than @xmath169 absolute accuracy .",
    "the in - orbit - checkout ( ioc ) dataset analyzed here may have additional error sources because the images were obtained while the _ spitzer _ pointing and data - acquisition systems were still being tuned and because the image integration times were very short ( 1.2 seconds ) .",
    "for example , if the estimate of the time needed for the spacecraft pointing system to `` settle '' were slightly too short ( i.e. , underestimated ) , then the images would have been taken while the spacecraft pointing was changing slightly , providing an additional error term in the pointing transfer .",
    "more standard images with relatively long integration times would be much less affected by this source ( as long as the settle time is small relative to the integration time ) .",
    "therefore , the pointing accuracy we derive for this dataset may not be typical for _ spitzer _ , but it still provides a valid test of the pointingrefine algorithm .",
    "we can get an estimate of both the relative and absolute raw pointing for this irac dataset from the `` before refinement '' ( dotted and thick lined ) histograms in figure  [ fig9 ] .",
    "the main difference between bands is in the number of point source matches .",
    "other than that , ranges in radial distributions are more or less consistent . across all bands ,",
    "the 1-@xmath6 radial separation between frame - to - absolute matches is @xmath170 to @xmath171 , while for relative ( frame - to - frame ) matches , this is @xmath172 to @xmath173 ( see table  [ tab1 ] ) .",
    "in addition to actual pointing dispersion , these estimates include a dispersion component from point source centroid errors .",
    "the contribution from centroiding error to the `` before refinement '' distributions however is negligible .",
    "taking for instance the band-1 average centroiding error of @xmath174 and @xmath175 for _ 2mass _ ( 1-@xmath6 radial ) , this translates to effective match separation uncertainties of @xmath176 and @xmath174 for frame - to - absolute and frame - to - frame ( relative ) matches respectively , assuming errors in each axis are _ uncorrelated _ ( see equation  [ radunc ] ) .",
    "this implies that the actual absolute and relative pointing for the frames in this observation is typically @xmath177 and @xmath178 ( 1-@xmath6 radial ) respectively .",
    "similar results are found using other bands .",
    "we should emphasize that these estimates are strictly valid for this dataset alone .",
    "they are not representative of the actual pointing performance of irac where the absolute pointing is typically @xmath179-@xmath180 ( 1-@xmath6 radial ) . for an in - depth study ,",
    "see @xcite .    the source separation distributions _ after _ refinement in figure  [ fig9 ] allow us to validate how well ( or whether ) images were refined to within accuracies determined by source extraction centroids .",
    "as found in our simulation ( figure  [ fig5 ] ) , images were refined to better than @xmath124 mas ( 1-@xmath6 radial ) within truth pointings , with a corresponding @xmath181 mas dispersion in source separations after refinement ( figure  [ fig6 ] ) .",
    "the top panel in figure  [ fig10 ] shows the distribution of uncertainties in radial match separation ( from equation  [ radunc ] ) as a function of separation @xmath140 for band-1 _",
    "after refinement_. these are broadly consistent above the minimum cut - off uncertainty of @xmath182 mas imposed by the finite size of the psf .",
    "the distribution in @xmath140 at any given uncertainty cut @xmath146 can also be described by a rayleigh distribution ( see equations  [ rayleigh ] and  [ beta2 ] ) .",
    "furthermore , figure  [ fig10 ] shows that typical systematic uncertainties due to inaccurately calibrated distortion are minimal , and if present , are expected to be much less than the centroiding errors .",
    "guided by the simulation in section  [ sim ] and figure  [ fig9 ] , we conservatively conclude that the majority of image pointings must be refined to better @xmath181 mas .",
    "in fact , we can predict the absolute dispersion in image pointings about truth using equation  [ approx ] . given the typical match statistics listed in table  [ tab1 ] and centroiding errors of @xmath183 and @xmath161 for bands 1 and 4 respectively",
    ", we expect dispersions of @xmath184 and @xmath185 mas ( 1-@xmath6 radial ) about truth for these bands respectively .",
    "we expect these dispersions to be smaller once centroiding errors are brought down using better characterized psfs .    in this case study ,",
    "the number of astrometric ( frame - to - absolute ) matches are factors 1.5 to 2 times greater than relative ( frame - to - frame ) matches ( see table  [ tab1 ] ) .",
    "this is due to the specific flux difference thresholds used in source matching ( 4% and 50% for relative and absolute matches respectively ; see above ) .",
    "the results of figure  [ fig9 ] assumed _ 2mass _ point sources with @xmath186 . to ascertain the degree to which the number of absolute matches control the level of refinement , we repeated the source matching and refinement for band-1 using a _",
    "2mass _ magnitude cut of @xmath187 .",
    "the bottom panel of figure  [ fig10 ] shows source separations before and after refinement .",
    "the number of absolutes per frame was randomly distributed between 0 and 4 ( compared to @xmath120 relative matches / frame ) . when frame - to - absolute separations after refinement are considered alone ( open histogram at bottom left ) , the mean separation is smaller by a factor of @xmath121 compared to the @xmath186 case ( top left panel of figure  [ fig9 ] ) .",
    "this is due to inherently lower positional uncertainties for the brighter ( @xmath188 ) sources .",
    "when combined with relative matches however , the mean source separation and hence level of refinement is essentially unchanged compared to our results above .",
    "we have presented a generic algorithm to perform astronomical image registration and pointing refinement .",
    "it is generic in the sense that it can be used on any set of astronomical images which recognize the fits and wcs pointing standards @xcite .",
    "either relative ( self - consistent frame - to - frame registration ) , single image absolute - astrometric , or simultaneous ( relative and absolute ) refinement is supported .",
    "the crux of the method involves matching point source positions between overlapping image frames and using this information to compute image offset corrections by globally minimizing a weighted sum of matched point - source positional differences .    to ensure robust registration and refinement , the algorithm is best optimized with the following criteria .    1 .   the random uncertainty in measured twist angle of an individual image frame ( @xmath189 ) is assumed to be small such as to ensure @xmath190 .",
    "@xmath191 is a good working measure for the intended applications of this algorithm ( where @xmath192 ) .",
    "input images have been accurately calibrated for distortion and possible nonuniform pixel scale .",
    "any position - dependent systematic offset between source matches will limit the refinement accuracy to the size of the systematic error involved .",
    "sufficient area overlap between adjacent image frames is needed to ensure good match statistics .",
    "availablity of _ point _ sources with well defined flux distribution profiles approaching that of the instrument / detector s psf .",
    "extended sources will lead to larger centroiding errors .",
    "well characterized psf(s ) for the image(s ) at hand",
    ". these are crucial for accurate determination of source extraction centroids .",
    "if the inherent telescope pointing uncertainty is of order a third or larger than the detector pixel size , centroiding accuracies to better than one - tenth of a pixel or resolution element are recommended . for pointing uncertainties",
    "much less than the pixel size , there is little to be gained in resolution by improving the registration.[step ] 6 .   with the suggested centroiding accuracy from step  [ step ] ,",
    "at least five relative ( frame - to - frame ) and five absolute source matches per frame will give pointings refined to better than three - hundreths of a pixel ( rms ) .",
    "the greater the number of matches , the better the refinement .",
    "a minimum of two source matches per image frame , either relative , absolute , or both is required to determine all offset parameters per image unambiguously .",
    "astrometric ( absolute ) reference sources should be used wherever possible .",
    "these provide a baseline to counteract any systematic deviations from `` truth '' , or expected pointing in the icrs , especially if absolute refinement is desired .",
    "it is assumed that uncertainties in image pointing and point source extraction centroids are random and independent .",
    "prior image pointing uncertainties should be used if available .",
    "these will prevent from erroneously over - correcting the pointing for cases in which it is well known a - priori .",
    "our simulations show that potentially good refinement can be obtained with minimal requirements . for a large fraction of images in an ensemble",
    ", refinements of better than @xmath124 mas ( 1-@xmath6 radial from truth ) can be obtained with an average of @xmath119 relative and @xmath120 absolute matches per frame with extraction centroids @xmath193 .",
    "this amounts to an improvement of 95% relative to truth for a majority of images .",
    "this could be better with higher match statistics and/or more accurate centroids , since typically the 1-@xmath6 dispersion about truth scales as @xmath194 for a given centroiding uncertainty @xmath76 and number of matches @xmath74 .",
    "analysis of observations from _",
    "spitzer s _ irac instrument shows that the dispersion in source separations after refinement is entirely consistent with the inherent dispersion in extraction centroid uncertainties .",
    "this implies that systematic uncertainties such as inaccurately calibrated distortions are negligible , since otherwise dispersions in matched source separations after refinement would be larger relative to centroiding errors . comparing dispersions of refined pointings about _ truth _ with matched source separations as found in our simulation , and rescaling to the appropriate numbers of matches using @xmath195 scaling , we predict ( at the @xmath2 level ) refinements to better than @xmath0 mas and @xmath1 mas for irac bands 1 and 4 respectively .",
    "these bands bracket two extremes in available source matches , and these refinement estimates correspond to @xmath196 and @xmath197 ( astrometric and relative ) matches per band - dependent frame respectively .",
    "the goal of astronomical image registration is to exploit the resolution capabilities of existing and upcoming detectors whose pointing control and stability may not evolve at the same rate .",
    "the aim is to optimize the achievable signal - to - noise and science return therein .",
    "the algorithm presented herein is just the tip of the iceberg at exploring one of many optimization techniques used in the diverse fields of image and signal processing and computer vision science .",
    "fjm is indebted to john fowler and john stauffer for proofreading the manuscript and providing useful suggestions .",
    "we thank howard mccallon for illuminating discussions and david shupe for assistance with simulations .",
    "this work is based in part on archival data obtained with the _",
    "spitzer space telescope _ , which is operated by the jet propulsion laboratory , california institute of technology under nasa contract 1407 .",
    "support for this work was provided by nasa through an award issued by jpl / caltech .",
    "this publication makes use of data products from the two micron all sky survey , which is a joint project of the university of massachusetts and the infrared processing and analysis center / california institute of technology , funded by the national aeronautics and space administration and the national science foundation .",
    "in this section , we provide general analytic expressions for elements of the coefficient matrix @xmath59 ( equation  [ matrixeq ] ) .",
    "these elements are obtained by applying the minimization conditions ( equation  [ partials ] ) to the cost function defined by equation  [ bigcost ] .",
    "the `` base '' coefficent labels @xmath198 , @xmath199 and @xmath200 correspond to the three equations obtained by evaluating the partial derivatives in equation  [ partials ] ( labelled equations @xmath198 , @xmath199 and @xmath200 from left to right respectively ) . position and uncertainty variables appearing in the expressions below were defined in section  [ gm ] .",
    "the full error - covariance matrix is one of the by - products of the _ pointingrefine _ software .",
    "this reports all variances and covariances for and between all ( inter and intra ) image offsets necessary for refinement from the global minimization .",
    "it can be used to explore the strength of long - distance correlations between images in a mosaic and the presence of any undue systematic walks after refinement .",
    "the latter could arise if one lacks the desired number of absolute astrometric sources , or correct magnitude of prior image pointing uncertainties as was discussed in section  [ expectme ] .    for a given pair of images ( @xmath202 ) and three computed offsets per image ( @xmath203 )",
    ", we have a total of six possible ( correlated ) offset pairs or covariance matrices . the possible covariances ( or variances",
    "if @xmath204 for the same offsets ) for any two images are therefore @xmath205 if we define any of these covariances generically as @xmath206 then the format for the error - covariance matrix for all possible image pair combinations ( @xmath202 ) where ( @xmath207 ) is as follows : @xmath208    figure  [ fig11 ] shows greyscale representations of covariance matrices for all combinations of offset parameters ( equation  [ allcovs ] ) for the 105-image irac test case assuming _ both relative and absolute _ astrometric source matches in the refinement . with 105 images , each covariance matrix has @xmath209 elements ( or pixels in this representation ) .",
    "it is important to note that the cross - correlation between different offset types is not symmetric .",
    "for instance , the correlation between @xmath210 and @xmath211 is not the same as @xmath212 and @xmath213 .",
    "figure  [ fig12 ] shows the same set but with _ only relative _",
    "( frame - to - frame ) matches used for the refinement . comparing figures  [ fig11 ] and  [ fig12 ] , we draw",
    "the following conclusions : first , for the case including astrometric matches , `` long - distance '' correlations in image offsets are greatly reduced .",
    "this is due to astrometric sources anchoring each image to the fiducial reference frame , making them more independent of each other .",
    "the covariance matrices become essentially block - diagonal .",
    "second , uncertainties ( variances along the diagonal for the same offset pair combination ) are greatly attenuated when astrometric matches are used compared to the relative - only match case .",
    "there are greater numbers of degrees of freedom per image when astrometrics are included , and this reduces the relative uncertainty .",
    "the relative - only case exhibits greater long - distance correlations ( larger off - diagonal values ) since image positions are dictated solely by frame - to - frame matches in image overlap regions .",
    "this makes each successive image position dependent on it s nearest neighbor positions , which depend on their own neighbours and so on throughout the system of linked images .",
    "apart from astrometric matches reducing long distance correlations , this can also happen if prior image pointing uncertainties are intrinsically smaller .",
    "small priors will pull refinement offsets from the global minimization towards zero , which minimizes the @xmath35 term in equation  [ cost ] .",
    "the priors force a constraint on each individual image to prevent `` over - refinement '' , regardless of the number of source matches present .",
    "each image therefore becomes more independent of its neighbors , and long - distance correlations are reduced .",
    "we also note the rich and diverse patterns in the covariance matrices for this observation , especially the relative - only case ( figure  [ fig12 ] ) .",
    "these are characteristic of the image layout and mosaic map geometry ( see figure  [ fig8 ] ) .",
    "for instance , take the @xmath214 matrix in figure  [ fig12 ] .",
    "the checker - board pattern arises from the relative image numbering in the map and how this translates to the numbering of elements in the covariance matrix ( equation  [ covdef ] ) . in the mosaic ,",
    "the images repeat from right to left to create a leg , then left to right and down again , for a total of seven legs .",
    "adjacent image pairs ( @xmath202 ) along vertical sections in the map are strongly correlated in their ( @xmath215 ) offsets , while widely separated images are less correlated .",
    "for instance , image number one at top right has its @xmath216 offset strongly correlated with the @xmath216 offsets of images directly below it ( i.e. , image numbers 30 , 31 , 60 , 61 , 90 and 91 ) .",
    "the high correlations are therefore with every @xmath21730th image giving bright regions in the greyscale covariance image .",
    "also , the @xmath216 offset of image number one is least correlated with that of images in the far left vertical strip ( image numbers 15 , 16 , 45 , 46 , 75 , 76 and 105 ) , resulting in dark regions in the covariance image .    in the end , one purpose of the covariance matrix is to visualize the degree of correlation between image positions in the ensemble as a whole .",
    "this allows one to ascertain whether refinement solutions are driven by any particular invalid input assumptions ( e.g. , priors ) , or insufficient astrometric reference source information if robust absolute refinement is desired .",
    "bly , m. j. , chipperfield , a. j. , giaretta , d. l. , graffagnino , v. g. et al .",
    "2002 , in asp conf .",
    "281 , astronomical data analysis software and systems xi , ed .",
    "d. a. bohlender , d. durand , & t. h. handley ( san francisco : asp ) 513                              zacharias , n. , mccallon , h. l. , kopan , e. , cutri , r. m. 2003 , the international celestial reference system : maintenance and future realization , 25th meeting of the iau , joint discussion 16 , 22 july 2003 , sydney , australia      @xmath3 & 34.7 & 20.5 & 0.847 & 0.605 & 0.151 & 8580.84 & 10821 & 0.792@xmath218 & 20.7 & 13.7 & 0.883 & 0.622 & 0.152 & 3843.93 & 5645 & 0.681@xmath219 & 9.4 & 7.6 & 0.933 & 0.603 & 0.142 & 1250.31 & 2443 & 0.511@xmath220 & 5.3 & 2.1 & 0.913 & 0.651 & 0.203 & 1240.50 & 1249 & 0.993"
  ],
  "abstract_text": [
    "<S> we present a generic algorithm for performing astronomical image registration and pointing refinement . </S>",
    "<S> the method is based on matching the positions and fluxes of available point sources in image overlap regions . </S>",
    "<S> this information is used to compute a set of image offset corrections by globally minimizing a weighted sum of all matched point - source positional differences in a pre - specified reference image frame . </S>",
    "<S> a fast linear sparse matrix solver is used for the minimization . from these corrections , the pointings and orientations of images </S>",
    "<S> can be refined in either a relative sense where pointings become fixed ( registered ) relative to a single input image , or , in an absolute sense ( in the icrs ) if absolute point source information is known . </S>",
    "<S> the latter provides absolute pointing refinement to an accuracy depending on the robustness of point source extractions , match statistics , and accuracy of the astrometric catalog used . </S>",
    "<S> the software is currently used in the _ spitzer _ image processing pipelines , although it is adaptable to any astronomical imaging system which uses the fits image format and wcs pointing standard .    </S>",
    "<S> we test the algorithm using monte carlo simulations and compare them to image data acquired with the infrared array camera ( irac ) on board the _ spitzer space telescope_. we find that dispersions in matched source separations after refinement are entirely consistent with centroiding errors in source extractions , implying that systematic uncertainties due to inaccurately calibrated distortions are negligible . for these data , we predict refinements to better than @xmath0 and @xmath1 mas ( @xmath2 radial ) for the irac @xmath3 and @xmath4 bands respectively . </S>",
    "<S> these bands bracket two extremes in available source matches and , for the data under study , correspond to an average of about 55 and 8 matches per image in these two bands respectively . </S>"
  ]
}