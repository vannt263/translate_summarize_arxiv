{
  "article_text": [
    "weak gravitational lensing by large - scale structure has become an indispensable tool for modern cosmology , used already to set constraints on the mass density ( @xmath0 , in units of the critical density ) and the fluctuation amplitude @xmath1 ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* for the current status ) and touted for its potential to constrain cluster scaling relations @xcite and dark energy @xcite . like the anisotropies in the cosmic microwave background ( cmb ) , the theory of weak gravitational lensing is well understood @xcite . unlike the cmb however the calculation involves modeling the non - linear evolution of the mass in the universe .",
    "this makes the predictions of weak lensing very rich , but also means that an accurate treatment requires numerical simulations .",
    "in this paper we give some details of a pilot program designed to provide weak lensing ray - tracing simulations of a small grid of cosmological models in the currently favored region of parameter space .",
    "these models can be used by observers wishing to test their algorithms or fit to their data and by theorists wishing to test or calibrate fast and flexible , but approximate , methods of calculation .",
    "the initial grid is small , but the process of its creation is almost entirely automatic allowing it to be expanded simply as the need arises .",
    "this paper focuses on the creation of the model grid .",
    "we describe the choice of cosmological parameters in  [ sec : param ] , the n - body simulations in  [ sec : nbody ] and the ray tracing and numerical issues in  [ sec : lensing ] and  [ sec : numerics ] .",
    "we give some representative results in  [ sec : results ] before concluding in  [ sec : conclusions ] .",
    "we choose a small number of cosmological models which provide good fits to the current cmb and large - scale structure data .",
    "for simplicity all of the models in the pilot program are variants of the cold dark matter model with a dark energy component , and their parameters are shown in table [ tab : model ] . the parameter variations around a base model are designed to keep the cmb fluctuations almost invariant , in anticipation of increasingly precise data from wmap and planck , and the entire process is automated using perl scripts and c code .",
    "we begin with a relatively small number of models to demonstrate the cost and feasibility of making such grids . as we gain experience in using these data products and",
    "understand the drivers better we can extend the model grid and/or increase the fidelity of the simulations .",
    "are our priorities to have larger maps ?",
    "higher resolution ?",
    "more redshift range ?",
    "more ` sky ' ? etc .",
    ".parameters for the models run . for each cosmological model",
    "two independent sets of initial conditions are generated .",
    "all models are spatially flat , so @xmath2 . for all models",
    "the matter density is @xmath3 and the baryon density @xmath4 was fixed at @xmath5 .",
    "our results are very insensitive to this latter choice .",
    "all models have power - law spectra ( no running ) with index @xmath6 and the dark energy has a constant equation of state @xmath7 .",
    "the normalization , @xmath8 , is from a fit to the wmap tt power spectrum data and the @xmath9 is for this fit with 893 degrees of freedom . [",
    "cols=\"^,^,^,^,^,^,^,^\",options=\"header \" , ]     we first pick the physical matter density @xmath10 , the ( comoving ) distance to last scattering , @xmath11 , and a ( constant ) equation of state of the dark energy , @xmath7 .",
    "we approximate the redshift of last scattering as @xmath12 , ignoring the slight matter and baryon density dependence .",
    "this then allows us to solve for the hubble constant , @xmath13 , and thus @xmath0 and @xmath14 assuming spatial flatness . because they are reasonably well known , compared to some other parameters , we fix @xmath3 and @xmath15gpc for all of the models in our grid .",
    "these numbers are close to the best fit for a recent analysis of wmap and sdss data @xcite .",
    "the next step is to specify the other model parameters , for example the optical depth to thomson scattering , @xmath16 , the spectral index , @xmath6 and the baryon density @xmath17 .",
    "( the optical depth enters primarily through its effect on the normalization of the power spectrum when we fit to wmap . )",
    "we currently hold the number of light neutrinos fixed , and include no massive neutrinos",
    ". we deal with pure power - law spectra with no running spectral index .",
    "our primary variations are in the optical depth , the spectral index and the equation of state of the dark energy ( see table [ tab : model ] ) .",
    "the first two affect the amplitude and shape of the density or potential fluctuations at late times while @xmath7 is a parameter of great interest to the cosmology community .",
    "we use a fixed equation of state in this initial survey , though it is easy to include any known functional form in the future .    for a specified model",
    "we compute the cmb anisotropy spectrum using v4.5 of _ cmbfast _ @xcite . the likelihood software provided by the wmap team @xcite and the known anisotropy spectrum",
    "are then used to find the best fitting normalization of the power spectrum , @xmath8 , which is then converted into internal code units for the n - body simulations .",
    "in this way a file of model parameters , shown in table [ tab : model ] , is built up .",
    "the lensing convergence angular power spectra for our 4 models , assuming the born and limber approximations , are shown in fig .",
    "[ fig : lcl ] .",
    "note that the spectra for each pair of models have similar shapes , differing primarily in amplitude . in each case the model with the most distant sources has the highest amplitude , even though it has a slightly lower matter power spectrum amplitude , @xmath8 .",
    "there will also be differences in the higher order moments and the source redshift dependence of the power spectra .",
    "another perl program reads this cosmological parameter file and generates a directory structure containing the requisite auxiliary files for the n - body simulation , plus scripts for generating the initial conditions and running the n - body code on the ibm - sp _ seaborg _ at nersc .",
    "all simulations require choices to be made about box size , resolution and sampling . to minimize numerical artifacts we want to run the largest box with the highest dynamic range consistent with the computational resources . since this is a pilot program we have chosen simulations which use @xmath18 particles in a @xmath19mpc box . as we shall discuss in  [ sec : numerics ] , this is expected to be sufficient for our purposes now , but will need to be improved upon in the future . as further resources become available we can increase the volume simulated and/or decrease the force softening .",
    "the initial conditions are generated by displacing equal mass particles from a `` fuzzy '' cartesian grid at @xmath20 using the zeldovich approximation .",
    "the initial fluctuations are gaussian , however we choose from a larger number of initial conditions those whose low few @xmath21-modes are close to the mean .",
    "this avoids running any simulations which are significant outliers and may skew statistics for a small number of runs . for each cosmological model",
    "we choose two independent initial conditions .",
    "ideally we would run more realizations of each model to increase the volume simulated , but with two runs we will be able to simulate several hundred square degrees which is enough for now .",
    "the _ treepm _ code , described in @xcite , is used to evolve the particles to @xmath22 with the phase space information output at selected times after @xmath23 .",
    "the outputs are spaced equally in conformal time , with a spacing equal to the time taken for light to travel @xmath24mpc ( comoving ) .",
    "this spacing is small enough to obtain good lensing maps  a halo with `` typical '' velocity @xmath25km / s will move only @xmath24kpc between outputs , and its departure from straight line motion will be small .",
    "each simulation gives between 80 and 90 phase space dumps , depending on the cosmology , each of @xmath26 mb .",
    "the gravitational force softening is of a spline form , with a `` plummer equivalent '' softening length of about @xmath27kpc , again small enough for our purposes .",
    "since the box size is only @xmath19mpc , leading to a relatively coarse sampling in @xmath21 , we generate the initial conditions from a fit to the transfer function which has the baryon oscillations `` smoothed out '' .",
    "for now we use the fit published by @xcite .",
    "this fit was made to an older version of _ cmbfast _ , and since that time improvements in the code and the physics @xcite have changed the predictions for @xmath28 slightly .",
    "the differences are small , and for the purposes of testing and calibrating algorithms it is enough to know the input @xmath28 precisely , but in the future we will improve this aspect .",
    "we make two sets of maps .",
    "the first , which we shall call the born series , assumes that the convergence field , @xmath29 , is simply the integral along the line of sight of the density field weighted by a simple kernel @xmath30 where @xmath31 is the overdensity , @xmath32 is the scale - factor , @xmath33 is the comoving distance and @xmath34 is the lensing weight @xmath35 for sources with distribution @xmath36 normalized to @xmath37 .",
    "this set of maps has the advantage of not requiring a fourier transform in its construction , providing higher resolution for a given pixelization .",
    "its principal disadvantage is the approximate nature of the calculation .",
    "we make several sets of 16 quasi - independent @xmath38 maps with @xmath39 pixels .",
    "the first set of maps has sources fixed at @xmath40 , while the second set uses a source distribution of the form @xcite",
    "@xmath41 \\label{eqn : dpdz}\\ ] ] for @xmath42 and @xmath43 . for this distribution @xmath44 , but because there is more of the lensing weight at higher @xmath45 the lensing signal is smaller for this distribution than a @xmath31-function distribution with @xmath46 .",
    "the second set of maps comes from a full multi - plane ray tracing algorithm as described in @xcite .",
    "we make maps of the shear components , @xmath47 , and the convergence , @xmath29 , at a range of source redshifts from @xmath48 to @xmath49 in steps of @xmath24mpc .",
    "again we make 16 maps per simulation , choosing different positions and orientations for the ` observer ' . in each case a @xmath50 grid of rays subtending a field of view of @xmath51 is traced through the simulation , with the required fourier transforms being done on a @xmath50 grid .",
    "all assignments to and from the fourier grid are done with cloud - in - cell ( cic ) assignment @xcite .",
    "the two shear components and the convergence are output at each source plane . from this a map of the ( measurable ) reduced shear , @xmath52 , for any source distribution",
    "can be computed . for a distribution",
    "@xmath53 the weight given to source plane @xmath54 is @xmath55 where @xmath56mpc is the spacing between outputs .",
    "the final shear at each point is then @xmath57 with @xmath58 the @xmath59th component of the shear measured on plane @xmath54 .",
    "we show an example of the weighting factors for @xmath60 in fig .",
    "[ fig : lenswt ] , along with the ( trivial ) weight for a @xmath31-function source distribution at @xmath61 .",
    "the integral over @xmath62 is extremely well approximated by a sum over the output planes .",
    "these maps can thus be combined to produce lensing maps for a wide range of source distributions , allowing source tomography to be used .",
    "it is straightforward to introduce mock ` galaxies ' , with an appropriate distribution of intrinsic ellipticities , at this stage and produce mock catalogues . on each @xmath62 slice",
    ", the angular positions of the galaxies can be made to trace the dark matter with some fidelity , giving rise to source clustering effects .",
    "reasonable choices produce angular correlations and redshift distributions for the ` galaxies ' which match current data well .",
    "however the parameter space of such catalogues is large , so we have chosen instead to make available simple co - added shear maps which can be post - processed with a wide variety of simulated galaxy properties to make shear maps . to save space we provide the maps downsampled from @xmath50 to @xmath39 .      to understand the fidelity of the map making procedure we need to account for the finite volume , force and mass resolution of the n - body simulation and the effect of the finite sampling during ray tracing .",
    "the comoving distance to our furthest sources is @xmath63gpc , at which distance our box subtends @xmath64 .",
    "the volume of space probed by a lensing field is @xmath65 , comparable to the volume simulated in each run .    in @xcite",
    ", we developed an analytic model to estimate the effects of finite force and mass resolution and the fourier grid used in the ray tracing .",
    "this model was based on modifying the 3d dark matter power spectrum that appears in the limber integral for @xmath66 in a way designed to fit the effects seen in a series of n - body simulations .",
    "this allows us to compare a given numerical configuration to a `` perfect '' model .",
    "[ fig : numerics ] illustrates these effects individually for model 1 of table [ tab : model ] with sources at @xmath40 .",
    "for simplicity we use the power spectrum fit of @xcite in computing these ratios .",
    "note that the suppression of power by the finite force resolution and ft grid is partly countered by the artificial increase in power due to shot - noise .",
    "based on fig .",
    "[ fig : numerics ] we expect our maps to be accurate to several percent , in the 2-point function , for @xmath67 and even higher in some situations where the cancellation is accurate .    while the 16 maps per model are not fully independent , they do sample different regions of the box in different stages of evolution and with different projection effects .",
    "the fraction of the volume traced by the rays in the field of view , weighted by the contribution to the variance of the convergence from each box , is between 10 - 20% ( for @xmath68 ) .",
    "this forms a rough upper limit to the degree of correlation between the maps . including the two independent boxes per model we have simulated several hundred square degrees of sky per cosmology , which is close to the amount of observational data currently existing .",
    "extending this to more sky is a straightforward exercise that simply requires more computing resources .",
    "these simulations and lensing maps can be used for a variety of purposes . here",
    "we simply show some preliminary analysis to orient the reader .",
    "the real uses of these maps will be in testing analysis algorithms and new ideas .    before turning to the lensing maps",
    "let us consider the underlying mass distribution .",
    "[ fig : pk ] shows the 3d matter power spectrum from our 8 boxes at @xmath69 and @xmath22 compared to the semi - analytic model of @xcite .",
    "the agreement is good for both the @xmath70cdm models and the models with equation of state @xmath71 , as expected . on the scales",
    "simulated the dark energy only enters through the hubble parameter in the drag term , slowing the growth of large - scale fluctuations when the dark energy comes to dominate the expansion .",
    "since the fit of @xcite has been tested for open and @xmath70cdm models it is no surprise that it works equally well for @xmath71 .",
    "the disagreement at the highest @xmath21 might be due to numerical artifacts in the n - body simulation or in the computation of the power spectrum , however these points are significantly above both the shot - noise and force smoothing limits .",
    "we find similar behavior in a number of higher resolution simulations we have analyzed , and a similar level of disagreement can be found in some of the figures of @xcite for cdm models and may reflect inherent inaccuracy in the fitting function",
    ". a qualitatively similar level of agreement was also found between particle - mesh simulations and the semi - analytic model by @xcite , though they were unable to probe very high @xmath21-modes due to limited force resolution .    as a further check on the n - body code we investigated the scaling of the power spectrum of an @xmath72 self - similar model with the same numerical parameters as the models described .",
    "this suggests that the power spectrum should be accurate to a few percent on the range of scales of interest .",
    "the @xmath29 angular power spectrum produced from 16 maps each for models 1 & 2 is shown in fig .",
    "[ fig : lcl12 ] . for this comparison",
    "we show maps made assuming the born approximation and with full ray - tracing , both for sources fixed at @xmath40 .",
    "the agreement is generally good , with the variance at low-@xmath73 expected from sampling 16 @xmath38 fields .",
    "the open circles , corresponding to model 2 , are slightly higher than the semi - analytic model at intermediate @xmath73 , as expected from the excess power seen in the top panel of fig .",
    "[ fig : pk ] ( the triangles ) at intermediate @xmath21 . at the highest @xmath73",
    "the ` born ' maps show a slight excess power which could be due to shot - noise in the simulations or to a breakdown in some of the approximations we have made . alternatively the semi - analytic model and the ray tracing could be underestimating the power on these scales , as suggested by figs .",
    "[ fig : numerics ] and [ fig : pk ] . in measurements these scales would be significantly affected by finite galaxy ellipticities and densities , so this disagreement is likely unimportant .",
    "[ fig : lcl34 ] shows the same comparison for models 3 and 4 .",
    "the power spectra for the remaining four models are very similar and we do not show them explicitly here .",
    "the maps are non - gaussian , as expected , and we provide the skewness @xmath74 for each of the models in fig .  [ fig : s3 ] .",
    "the @xmath29 field is smoothed by a boxcar of side length @xmath75 before the moments are computed .",
    "the plot shows the average and the variance across the 16 maps as before .",
    "as noted previously @xcite the skewness suffers from a large sample variance .",
    "we also show the shear 3-point function for isoceles triangles of side length @xmath76 in fig .",
    "[ fig : tpt ] . here",
    "we plot @xmath77 as a function of the cosine of the included angle for the 32 fields , each @xmath38 , simulated for each cosmology assuming the sources are at @xmath40 .",
    "the points are the mean of the 32 fields , and the error bars represent the variance .",
    "the highest 3-point function is for models 1 & 2 , which have the highest normalization ( @xmath8 ) of all of the models .",
    "models 3 & 4 have the next largest amplitude , and the second highest normalization . for models 5 & 6 the effect of a higher normalization",
    "is nt enough to overcome the less negative @xmath7 of models 7 & 8 , which have a slightly higher amplitude .",
    "notice the large scatter from field to field , but the familiar shape @xcite .",
    "apart from an amplitude change the shapes of the curves are extremely similar , as shown in fig .",
    "[ fig : tpt_scaled ] .",
    "we find a similar behavior for other configurations we have checked , which has interesting implications for the signal encoded in the non - gaussianity of the maps and how best to extract it .",
    "we also note that the peak of @xmath78 appears to be shifted slightly from the equilateral configuration , due to the asphericity and substructure of the dark matter halos @xcite .",
    "gravitational lensing has made rapid advances in recent years , and observations are now pushing the limits of existing theoretical models . if lensing is to fulfill its promise as a precision tool , theorists need to improve the predictions of cosmological models for the @xmath6-point correlation functions .",
    "an important step in this program is the creation of grids of n - body models of sufficient resolution and sampling to enable accurate simulation of weak lensing .",
    "this paper describes a first step in this direction .",
    "based on analytic arguments developed in @xcite we believe that simulations with @xmath18 particles in boxes of side @xmath19mpc are sufficient to produce lensing maps accurate to @xmath79 or scales of a few arcminutes .",
    "to achieve good convergence in the multi - plane ray - tracing algorithm that we use requires time dumps spaced equally in conformal time with a spacing close to @xmath24mpc .",
    "the total computational cost of this project was very modest .",
    "the major human cost is the time spent managing the disk space , archiving and retrieving the data to ensure that the total usage stays below quota .",
    "the simulations each took 2000 - 3000 time steps , requiring slightly under one day each on 32 processors of the ibm - sp _ seaborg _ at nersc , i.e.  between 640 and 720 cpu hours .",
    "the phase space data required @xmath80 gb per model while the ray tracing simulations required around @xmath81 gb of intermediate storage and 100 cpu hours per model .",
    "the disk usage is driven by the need for all the phase space data and the @xmath82 high resolution source planes for each of 16 maps . the final stacked and downsampled maps",
    "are @xmath83 gb per model and source distribution . the entire process was monitored and controlled by scripts , making it easy to extend the grid as more resources become available .",
    "thanks tzu - ching chang , dragan huterer , bhuvnesh jain , jason rhodes and masahiro takada for helpful comments on an earlier draft .",
    "the simulations used here were performed on the ibm - sp at the national energy research scientific computing center .",
    "this research was supported by the nsf and nasa .",
    "abazajian k. , dodelson s. , 2003 , prl , 91 , 041301 bartelmann m. , schneider p. , 2001",
    ", phys . rep .",
    ", 340 , 291 benabed k. , bernardeau f. , 2001 , prd , 64 , 3501 bernstei , g. , jain b. , 2004 , astrophys . j. , 600 , 17 [ astro - ph/0309332 ] brainerd t. , blandford r.d . , smail i. , 1996 , astrophys . j. , 466 , 623 dolney d. , jain b. , takada m. , 2004 , submitted to mnras [ astro - ph/0401089 ] eisenstein d. , hu w. , 1999 , astrophys . j. , 511 , 5 heavens a. , 2003 , mon.not.roy.astron.soc . , 343 , 1327 [ astro - ph/0304151 ] hinshaw g. et al . , 2003 ,",
    "j. supp . , 148 , 63 ho s. , white m. , 2003 , astrophys . j. , in press [ astro - ph/0312253 ] hockney r.w . , eastwood j.w . ,",
    "`` computer simulation using particles '' , new york , mcgraw hill ( 1980 ) .",
    "hoekstra h. , yee h.k.c . , gladders m.d .",
    ", 2002 , new astronomy reviews , 46 , 767 hu , w. , 2002 , prd 65 , 023003 _ ibid _ , 66 , 083515 huterer d. , white m. , 2002 , astrophys . j. , 578 , l95 [ astro - ph/0206292 ] huterer d. , 2002 , prd , 65 , 3001 ishak m. , hirata c.m . , mcdonald p. , seljak u. , 2003 , preprint [ astro - ph/0308446 ] jain b. , taylor a. , 2003 , prl , 91 , 141302 kogut a. et al . , 2003 ,",
    "j. supp . , 148 , 161 mellier y. , 1999 , ann .",
    "astrophys . , 37 , 127 refregier a. et al . , 2003 ,",
    "astrophys . j. , in press [ astro - ph/0304419 ] seljak u. , zaldarriaga m. , 1996 , astrophys .",
    "j. , 469 , 437 takada m. , jain b. , 2002 , mnras , 344 , 857 [ astro - ph/0209167 ] takada m. , jain b. , 2004 , mnras 348 , 897 [ astro - ph/0310125 ] takada , m. , white m. , 2004 , astrophys .",
    "j. , 601 , l1 [ astro - ph/0311104 ] tegmark m. et al . , 2003 ,",
    "preprint [ astro - ph/0310723 ] seljak u. , sugiyama n. , white m. , zaldarriaga m. , 2003 , prd 68 , 083507 [ astro - ph/0306052 ] smith r.e .",
    "et al . , 2003 ,",
    "mnras , 341 , 1311 [ astro - ph/0207664 ] vale c. , white m. , 2003 , astrophys .",
    "j. , 592 , 699 [ astro - ph/0303555 ] verde l. et al .",
    ", 2003 , astrophys .",
    "j. supp . ,",
    "148 , 195 van waerbeke l. , mellier y. , 2003 , preprint [ astro - ph/0305089 ] white m. , hu w. , 2000 , astrophys . j. , 537 , 1 [ astro - ph/9909165 ] white m. , 2002 , astrophys . j. supp . , 143 , 241 [ astro - ph/0207185 ]"
  ],
  "abstract_text": [
    "<S> we describe the simulation data produced by a pilot programme to compute mock weak gravitational lensing maps for a range of currently popular cosmological models by ray tracing through high - resolution n - body simulations . </S>",
    "<S> the programme required only a modest investment in computer time to produce maps accurate to arcminute scales covering hundreds of square degrees of sky for 4 cosmological models .    ,    </S>",
    "<S> cosmology , lensing , large - scale structures 98.65.dx , 98.80.es , 98.70.vc </S>"
  ]
}