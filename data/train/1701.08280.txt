{
  "article_text": [
    "we consider the standard problem of denoising grayscale images that are corrupted with additive white gaussian noise .",
    "the setting here is that we are given a _ noisy _",
    "image @xmath1 where @xmath2 is some finite rectangular domain of @xmath3 , @xmath4 is the unknown _ clean _ image , and @xmath5 are i.i.d .",
    "@xmath6 where @xmath7 is the standard deviation of the gaussian noise .",
    "the focus of this work is the non - local means ( nlm ) algorithm that was introduced by buades , coll , and morel in @xcite .",
    "nlm denoises each pixel by taking a weighted average of the neighboring pixels .",
    "a key innovation in nlm is that the weights are computed using patches ( blocks of neighboring pixels ) instead of pixels .",
    "more specifically , the _ denoised _",
    "image @xmath8 is computed using the formula @xmath9 where @xmath10 denotes the _ neighborhood _ around pixel @xmath11 .",
    "the original proposal in @xcite was to set @xmath10 to be the whole image . in practice",
    ", one restricts @xmath10 to a sufficiently large window of size @xmath12 centered at @xmath11 , that is , @xmath13 ^ 2 $ ] .",
    "the weights @xmath14 are set to be @xmath15 where @xmath16 is a smoothing parameter , and _ patch _",
    "@xmath17 ^ 2 $ ] is a square neighborhood of the origin of size @xmath18 .    since its introduction",
    ", several variations of nlm have been proposed which can further improve the denoising .",
    "for example , various weighting schemes for the center pixel have been proposed in @xcite .",
    "a weighting scheme based on quadratic programming was proposed in @xcite , which exploits the overlapping information between adjacent patches .",
    "further , optimization framework based approaches have been proposed in @xcite to improve the performance of nlm . in @xcite ,",
    "the weighting was performed based on the structural similarity indices between patches . in a different direction , it was demonstrated in @xcite that the performance ( and the speed ) of nlm can be improved by computing the weights from low - dimensional projections of the patches .     the primary application of nlm is noise reduction @xcite . however , since the inception of nlm , more sophisticated algorithms with superior denoising performances have been proposed @xcite . while nlm and its variants are no longer the state - of - the - art in image denoising , they nevertheless continue to be of interest due to their simplicity , decent denoising performance , and the availability of fast implementations .",
    "we also note that several researchers have used nlm ( either directly or via post - processing ) in image restoration applications such as deblurring @xcite , inpainting @xcite , demosaicking @xcite , and super - resolution @xcite .",
    "the investigation in this paper was particularly motivated by the work on shape - adaptive patches @xcite and robust @xmath19 regression @xcite . in either case",
    ", it was demonstrated that the denoising quality of nlm can be improved by adapting the averaging neighborhood at every pixel .",
    "while this was done explicitly in @xcite in terms of the patch shape , the adaptation was achieved implicitly in @xcite via an optimization . in this paper",
    ", we propose to perform the adaptation by explicitly pruning those neighboring pixels whose weights are below a certain global threshold @xmath0 .",
    "we use stein s unbiased estimator of the mean - squared error to optimally tune @xmath0 . in other words , we optimize the denoising quality by performing a simple one - dimensional optimization for the whole image . as a result ,",
    "the overall implementation is much faster than those implementations in @xcite , where one is required to perform an adaptation at every pixel .",
    "the rest of the paper is organized as follows . in section",
    "[ s2 ] , we motivate the main idea using a simple experiment , and then present the proposed denoising algorithm and the implementation details .",
    "the denoising results are reported in section [ s3 ] , where we also compare the proposed method with nlm and its variants .",
    "we now perform some numerical experiments to reflect the motivation that pruning can improve the denoising performance .",
    "we consider a scenario where the pixel of interest ( poi ) is situated closed to a edge , as shown in the example in figure 1(a ) .",
    "we compute the nlm weights around the poi ( marked with a solid black circle ) using .",
    "we expect the weights of neighboring pixels that are on the same side of the edge as the poi to be generally higher than the weights of pixels that are on the other side of the edge . as shown in figure 1(b ) this is indeed the case if the weights are computed from the ( unknown ) clean edge .",
    "unfortunately , this is not the case if the weights are computed from the noisy edge . as seen in figure 1(b ) , the weights of some of the pixels on the left of the edge ( same side of the edge as the poi ) are smaller than the weights of some of the pixels on the right .",
    "this leads to a poor averaging in  pixels from both sides of the edge are mixed .",
    "for example , in figure 1(a ) , the intensities at the poi before and after adding noise are @xmath20 and @xmath21 . using nlm",
    ", the denoised output is @xmath22 ( as a reference , the nlm output using the weights computed from the clean patches is 73.09 ) . on the other hand ,",
    "notice that if we sort the noisy weights in figure 1(b ) , then the majority of the pixels on the left of the edge would have the largest weights .",
    "indeed , if we use the top @xmath23 neighbors ( neighbors with largest weights ) for the averaging , then the output comes down to @xmath24 ( which is even better than that obtained using the clean weights ) .",
    "this suggests a means of improving the quality of denoising , namely , by restricting the averaging in to those neighboring pixels that are assigned top weights .",
    "based on the above observation , we propose to perform _ pruning _ as follows .",
    "we fix a threshold @xmath25 , and consider the step function @xmath26 \\rightarrow [ 0,1]$ ] given by @xmath27 the process of nullifying the weights that are smaller than @xmath0 can be achieved by modifying as : @xmath28 to avoid introducing unnecessary symbols , we continue to use the same notation for the denoised image as in .",
    "notice that the weights defined in take values in @xmath29 $ ] ; therefore , the variable @xmath30 $ ] in .",
    "when @xmath31 , none of the weights are pruned , and when @xmath0 is close to unity , a large fraction of the weights are pruned .",
    "the optimal setting would be somewhere in between .",
    "we can ideally tune @xmath0 by minimizing the mean - squared - error ( mse ) given by @xmath32 where @xmath33 is the size of the image , i.e. , the number of pixels in the image .",
    "however , since we do not have access to the clean image @xmath34 , we can not compute the mse in practice .    .",
    "at large values of @xmath35 , we obtain a close approximation of the unit step function.,scaledwidth=40.0% ]    this is precisely where stein s unbiased risk estimator ( sure ) proves to be useful .",
    "this is given by @xmath36 where we recall that @xmath7 is the standard deviation of the additive gaussian noise in .",
    "sure has the remarkable property that its expected value equals that of the mse for the noise model in @xcite .",
    "this makes it an useful surrogate for the mse  it can be computed without the knowledge of the clean image . the difficulty in applying",
    "sure directly to the transformation in is that is not differentiable and therefore we can not compute the partial derivatives in .",
    "this is , however , not a fundamental problem and we can approximate by a differentiable function . for example , we propose to use the following sigmoid function : @xmath37 where @xmath38 is the slope of the sigmoid at @xmath39 .",
    "it can be verified that converges pointwise to as @xmath35 get large , namely , for fixed @xmath40 , @xmath41 in figure [ plotsigmoid ] , we plot for different values of @xmath35 and compare it with for the same @xmath0 .",
    "ideally , we should use a large @xmath35 to obtain a good approximation .",
    "however , as will be evident shortly , the partial derivatives in explode as @xmath35 increases .",
    "following exhaustive simulations , we decided to set @xmath42 .",
    "the approximation is reasonable in this case and the derivatives can be computed stably . in other words ,",
    "we consider the following formula @xmath43 where @xmath42 .",
    "we will refer to as pruned non - local means ( pnlm ) .",
    "we note that the sure for was originally derived in @xcite , and was shown to be close to the mse .",
    "similarly , we can derive the sure for .",
    "in particular , the partial derivative of is given by ( cf .",
    "appendix ) : @xmath44,\\end{aligned}\\ ] ] where @xmath45 the expression of @xmath46 is given in for completeness .",
    "a comparison of the mse and sure is provided in figure [ msevssure ] when @xmath42 .",
    "we notice that the gap between mse and sure decreases with the increase in image size .",
    "importantly , we note that the minima of mse and sure are attained at almost the same @xmath0 .     versus noise level for various natural images @xcite .",
    "the parameters used are @xmath47 , @xmath48 , and @xmath49.,scaledwidth=60.0% ]",
    "the denoising performance of pnlm clearly depends on the choice of @xmath0 . in particular",
    ", the optimal @xmath50 ( minimizer of mse ) depends on the noise level and the image characteristics . in order to obtain a noise - based rule for setting @xmath50",
    ", we took a large collection of natural images @xcite and computed the optimal @xmath0 at various noise levels using exhaustive search .",
    "the scatter plot of @xmath7 and the corresponding @xmath50 for some of the images is shown in figure [ fig5 ] .",
    "also shown is the cubic polynomial that we obtained using least - square fitting : @xmath51 we note that the above fitting pertains to the parameter setting @xmath52 and @xmath49 . in this case , we can directly use to predict @xmath50 .",
    "of course , will not provide a good estimate of @xmath50 for other parameter settings .",
    "one option is to maintain a lookup table of the optimal rules for selected parameter settings , and then interpolate between them .",
    "instead , we propose to use to initialize a one - dimensional search , irrespective of the parameter setting . starting from a coarse estimate of @xmath50",
    ", we then use golden section search @xcite to refine the estimate .",
    "the complete process is summarized in algorithm [ algo ] .",
    "note that , compared to nlm , we have to perform an additional search in pnlm .",
    "each step of this search requires us to compute and twice .",
    "however , the weights in and are computed using the patch distances used in nlm .",
    "therefore , we have to compute the patch distances just once , which happens to be the computation - intensive part of nlm .",
    "the iterations in algorithm [ algo ] are terminated when the change in @xmath50 between successive iterations is within @xmath53 .",
    "the whole process is quite fast once the patch distances have been computed .",
    "we note that the optimal selection of nlm parameters is an altogether different line of work . in this paper",
    ", the focus is on post - processing of weights to enhance the robustness of nlm .",
    "the idea of pruning remain relevant irrespective of the choice of nlm parameters . for the present discussion",
    ", we choose the nlm parameters to be @xmath54 and @xmath49 , as was originally suggested in @xcite .",
    "as far as the additional parameters @xmath35 and @xmath0 in pnlm are concerned , we set @xmath55 to ensure a reasonable approximation of the step function @xmath56 , and the crucial parameter @xmath0 is set using the process described above .    [ cols=\"^,^,^,^\",options=\"header \" , ]     [ psnr_ssim2 ]     +     +   +   +     +   +   +    for completeness ,",
    "we have also compared pnlm with the state - of - the - art denoising methods ksvd @xcite and bm3d @xcite .",
    "a couple of representative results are provided in figures [ visual_2 ] and [ visual ] .",
    "notice that the pnlm has successfully reduced the gap in psnr / ssim between nlm and k - svd .",
    "this is interesting given that k - svd is much more complex compared to pnlm .",
    "however , there is still a significant margin in the denoising performance with respect to bm3d . in this regard ,",
    "we wish to make a couple of remarks .",
    "first , notice that the denoising using pnlm appears to be somewhat better in homogeneous regions compared to both k - svd and bm3d .",
    "in particular , we see `` ripples '' and `` blocking '' artifacts in the homogeneous regions for the k - svd and bm3d outputs .",
    "in fact , the overall visual quality of the pnlm output appears to be better than the k - svd output for both _",
    "lena _ and _ barbara _ , though this fact is not quite captured by the quality metrics .",
    "the other remark is that the bm3d algorithm uses block - matching and aggregation in its processing pipeline .",
    "therefore , the present idea of pruning can in principle be incorporated into bm3d .",
    "we wish to investigate this in future work .",
    "we demonstrated that the denoising capability of nlm can be significantly improved using pruning , where the pruning is controlled using a single global threshold .",
    "the added cost of optimizing the threshold was marginal in comparison to the run - time of nlm .",
    "moreover , we provided several denoising results to demonstrate that pruned nlm outperforms several variants of nlm in terms of psnr and ssim .",
    "the surprising observation is that , by optimizing a single parameter @xmath0 , we could obtain denoising results that are consistently better than that obtained using sophisticated optimization in @xcite",
    ". it would be interesting to see if the present ideas can be extended to the recently - proposed vector nonlocal euclidean median @xcite .",
    "the authors wish to thank the reviewers for their useful comments and suggestions .",
    "this work was supported by a startup grant from the indian institute of science and emr grant serb / f/6047/2016 - 2017 from the department of science and technology , government of india .",
    "in this section , we provide the main steps in the derivation of .",
    "first , we write as @xmath57 where @xmath58 is given by .",
    "then , by the quotient rule for derivatives and after some simplification , we obtain @xmath59 where @xmath60 is given by . applying chain rule , we have @xmath61 where @xmath62 and @xmath63 substituting and in , @xmath64                wu , y. , tracey , b. , natarajan , p. , and noonan , j. p. : ` james - stein type center pixel weights for non - local means image denoising , ' _ ieee signal processing letters , _ 2013 , * 20 * , ( 4 ) , pp .",
    "411 - 414 .",
    "feng , j. , li song , _",
    "et al . _ : ` an optimized pixel - wise weighting approach for patch - based image denoising , ' _ ieee signal processing letters _ , 2015 , * 22 * , ( 1 ) , 115 - 119 .",
    "zhang , x. , feng , x. , and wang , w. : ` two - direction nonlocal model for image denoising , ' _ ieee transactions on image processing , _ 2013 , * 22 * , ( 1 ) , pp .",
    "408 - 412 .",
    "liu , g. , zhong , h. , and jiao , l. : ` comparing noisy patches for image denoising : a double noise similarity model , ' _ ieee transactions on image processing , _ 2015 , * 24 * , ( 3 ) , pp .",
    "862 - 872 .",
    "van de ville , d. , and kocher , m. : ` non - local means with dimensionality reduction and sure - based parameter selection , ' _ ieee transactions on image processing _ , 2011 ,",
    "* 20 * , ( 9 ) , pp . 2683 - 2690 .",
    "zuo , chenglin , et al .",
    ": ` image denoising using quadtree - based nonlocal means with locally adaptive principal component analysis , ' _ ieee signal processing letters _ , 2016 , * 23 * , ( 4 ) , pp .",
    "434 - 438 .",
    "tracey , b. h. , and miller , e. l. : ` nonlocal means denoising of ecg signals , ' _ ieee transactions on biomedical engineering , _ 2012 , * 59 * , ( 9 ) , pp .",
    "2383 - 2386 .",
    "yadav , s. k. , sinha , r. , and bora , p. k. : ` electrocardiogram signal denoising using non - local wavelet transform domain filtering , ' _ iet signal processing , _ 2015 , * 9 * , ( 1 ) , pp . 88 - 96 .",
    "elad , m. , and aharon , m. : ` image denoising via sparse and redundant representations over learned dictionaries , ' _ ieee transactions on image processing , _ 2006 , * 15 * , ( 12 ) , pp .",
    "3736 - 3745 .",
    "dabov , k. , et al . : ` image denoising by sparse 3d transform - domain collaborative filtering , ' _ ieee transactions on image processing , _ 2007 , * 16 * , ( 8) , pp . 2080 - 2095 .",
    "hossein , t. , and milanfar , p. : ` global image denoising , ' _ ieee transactions on image processing _",
    ", 2014 , * 23 * , ( 2 ) , pp .",
    "755 - 768 .",
    "duan , j. , et al . : ` second order mumford - shah model for image denoising , ' _ proc .",
    "ieee international conference on image processing _ , 2015 .",
    "yue , h. , et al . : ` image denoising by exploring external and internal correlations , ' _ ieee transactions on image processing _ , 2015 , * 24 * , ( 6 ) , pp .",
    "1967 - 1982 .",
    "romano , y. , and elad , m. : ` boosting of image denoising algorithms , ' _ siam journal on imaging sciences , _ 2015 , * 8 * , ( 2 ) , pp . 1187 - 1219 .",
    "dinh , k. q. , canh , t. n. , and byeungwoo , j. : ` color image denoising via cross - channel texture transferring , ' _ ieee transactions on image processing , _ , 2016 , * 23 * , ( 8) , pp . 1071 - 1075 .",
    "chen , f. , xiaojun h. , and chen , w. : ` texture - preserving image deblurring , ' _ ieee signal processing letters , _ 2010 , * 17 * , ( 12 ) , pp .",
    "1018 - 1021 .",
    "jung , m. , et al . : ` nonlocal mumford - shah regularizers for color image restoration , ' _ ieee transactions on image processing , _ 2011 , * 20 * , ( 6 ) , pp . 1583 - 1598 .",
    "wong , a. , and orchard , j. : ` a nonlocal - means approach to exemplar - based inpainting , ' _ proc .",
    "ieee international conference on image processing , _ 2008 .",
    "buades , a. , et al . : ` self - similarity driven color demosaicking , ' _ ieee transactions on image processing , _ 2009 , * 18 * , ( 6 ) , pp .",
    "1192 - 1202 .",
    "protter , m. , et al . : ` generalizing the nonlocal - means to super - resolution reconstruction , ' _ ieee transactions on image processing , _ 2009 , * 18 * , ( 1 ) , pp",
    ". 36 - 51 .",
    "zhang , k. , et al . : ` single image super - resolution with non - local means and steering kernel regression , ' _ ieee transactions on image processing , _ 2012 , * 21 * , ( 11 ) , pp .",
    "4544 - 4556 .",
    "zhang , k. , et al . : ` learning multiple linear mappings for efficient single image super - resolution , ' _ ieee transactions on image processing , _ 2015 , * 24 * , ( 3 ) , pp .",
    "846 - 861 .",
    "deledalle , c .- a . ,",
    "duval , v. , and salmon , j. : ` non - local methods with shape - adaptive patches ( nlm - sap ) , ' _ journal of mathematical imaging vision , _ 2012 , * 43 * , ( 2 ) , pp .",
    "103 - 120 .",
    "chaudhury , k. n. , and singer , a. : ` non - local patch regression : robust image denoising in patch space , ' _ proc .",
    "ieee international conference on acoustics , speech , and signal processing _ , 2013 , pp .",
    "1345 - 1349 .",
    "stein , c. : ` estimation of the mean of a multivariate normal distribution , ' _ the annals of statistics , _ 1981 , * 9 * , pp . 1135 - 1151 .",
    "wang , z. , bovik , a. c. , sheikh , h. r. , and simoncelli , e. p. : ` image quality assessment : from error visibility to structural similarity , ' _ ieee transactions on image processing _ , 2004 ,",
    "* 13 * , ( 4 ) , pp .",
    "600 - 612 ."
  ],
  "abstract_text": [
    "<S> in non - local means ( nlm ) , each pixel is denoised by performing a weighted averaging of its neighboring pixels , where the weights are computed using image patches . </S>",
    "<S> we demonstrate that the denoising performance of nlm can be improved by pruning the neighboring pixels , namely , by rejecting neighboring pixels whose weights are below a certain threshold @xmath0 . </S>",
    "<S> while pruning can potentially reduce pixel averaging in uniform - intensity regions , we demonstrate that there is generally an overall improvement in the denoising performance . in particular </S>",
    "<S> , the improvement comes from pixels situated close to edges and corners . </S>",
    "<S> the success of the proposed method strongly depends on the choice of the global threshold @xmath0 , which in turn depends on the noise level and the image characteristics . </S>",
    "<S> we show how stein s unbiased estimator of the mean - squared error can be used to optimally tune @xmath0 , at a marginal computational overhead . </S>",
    "<S> we present some representative denoising results to demonstrate the superior performance of the proposed method over nlm and its variants . </S>"
  ]
}