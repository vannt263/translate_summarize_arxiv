{
  "article_text": [
    "in recent years wang - landau sampling ( _ wls_)@xcite has been applied to many systems and has become a well - established monte carlo algorithm .",
    "the heuristic idea of the method is based on the fact that if one performs a random walk in energy space with a probability proportional to the reciprocal of the density of states , a flat histogram is generated for the energy distribution . since the density of states produces huge numbers , instead of estimating @xmath2 , the simulation is performed for @xmath3 , and a histogram @xmath4 is accumulated during the simulations to control the frequency of visits to the energy levels . at the beginning of the simulation we set @xmath5 for all energy levels .",
    "the random walk in the energy space runs through all energy levels from @xmath6 to @xmath7 with a probability    @xmath8},1 ) , \\ ] ]    where @xmath9 and @xmath10 are the energies of the current and the new possible configurations .",
    "whenever a configuration is accepted we update @xmath11 and @xmath12 , where @xmath13,(@xmath14 is the so - called modification factor ) .",
    "the initial modification factor is taken as @xmath15 .",
    "if the trial configuration is not accepted , then the current @xmath4 and @xmath16 are updated again .",
    "the flatness of the histogram is checked after a number of monte carlo ( mc ) steps and usually the histogram is considered flat if @xmath17 , for all energies , where @xmath18 is an average over the energies . if the flatness condition is fulfilled we update the modification factor to a finer one by setting @xmath19 and reset the histogram @xmath20 .",
    "simulations are in general halted when @xmath21 .",
    "having in hand the density of states , one can calculate the canonical average of any thermodynamic variable as    @xmath22    where @xmath23 is the microcanonical average accumulated during the simulations and @xmath24 , @xmath25 is the boltzmann constant and @xmath26 is the temperature .",
    "one of the interesting features of the method is that it can also access some quantities , such as the free energy and entropy , which are not directly available from conventional monte carlo simulations .",
    "as described above , the convergence of the method depends on both the flatness criterion and the final _ f _ when the simulation is interrupted , but the best choice of each is not obvious for each model to be studied .",
    "recently some authors have asserted that although achieving a flat histogram is the initial motivation of the _ wls _ , the flatness is not a necessary criterion to reach convergence @xcite .",
    "they argue that in conventional _ wls _ the error saturates to a constant , while if @xmath27 decreases as @xmath0 , where @xmath28 is a normalized monte carlo time , the error would decrease monotonically as well . the @xmath0 algorithm is divided into two steps , initially the conventional _ wls _ is followed , starting from @xmath5 and then constructing @xmath16 using a histogram updated in every new accepted configuration .",
    "@xmath16 is updated as in the conventional _ wls _ , @xmath29 , with the initial value @xmath30 .",
    "after a number of moves ( e.g. @xmath31 mc sweeps ) , we check @xmath4 to verify whether all the levels were visited by the random walker at least once and then update @xmath32 and reset @xmath20 .",
    "( the flatness criterion is not required , even in this first stage . )",
    "simulation is performed while @xmath33 , where @xmath34 is the number of trial moves and @xmath35 is the number of energy levels . in the remainder of the simulation @xmath36",
    "is updated every new configuration as @xmath37 up to a final chosen precision @xmath38 .",
    "the efficiency , convergence and limitations of the _ wls _ has been quantitatively studied @xcite . in the present work",
    "we perform a practical , computational study on the convergence and the accuracy of the method .    in this paper",
    "we investigate the behavior of the maxima of the specific heat @xmath39 and the susceptibility @xmath40 where @xmath9 is the energy of the configurations and @xmath41 is the corresponding magnetization per spin during the conventional _ wls _ and the @xmath0 algorithm simulations for the ising model on a square lattice @xcite . we observe ( as in @xcite ) that a considerable part of the conventional wang - landau simulation is not very useful because the error saturates .",
    "we propose some strategies to improve the efficiency of _ wls _ and compare our results with exact calculations @xcite .",
    "our findings lead to a new way of performing the _ wls _ simulations .",
    "in order to test how far the simulations should go , during the _ wls _ , beginning from @xmath42 , we calculate the specific heat and the susceptibility defined in eqs . and , as well as the energy and the magnetization at some fixed temperatures .",
    "we use the current @xmath2 and from this time on this mean values are updated whenever we check the flatness of the histogram .",
    "fig.[medcan_cv_conv ] shows the evolution of the temperature of the maximum of the specific heat calculated for @xmath43 for eight independent runs as a function of the monte carlo sweeps ( mcs ) @xcite and compare these results with the value obtained using the exact data of ref .",
    "@xcite ( @xmath44 ) .",
    "the dots label the mcs when the modification factor was updated , the leftmost in each run corresponding to @xmath42 .",
    "one can see that around @xmath45 all the curves become stabilized in values displaced close to the exact value .",
    "any further computational effort for @xmath46 does not lead to a better convergence .    in order to investigate how these results are displaced around the exact value",
    ", we performed @xmath47 independent runs of _ wls _ for @xmath48 using the @xmath49 and the @xmath50 flatness criterions and built up histograms using bins of width 0.001 . in fig.[histograms_80_90 ] we show that the histograms form nice gaussians centered close , but not precisely in the exact value . in fig.[medcan_khi_conv ] we show the same evolution for the temperature of the maximum of the susceptibility .",
    "one can see that in this case the curves do not flow to steady values .    a strategy to improve",
    "the precision of the _ wls _ is to update the density of states periodically ( i.e. , after every @xmath51 trial configurations ) , instead of updating @xmath16 every spin - flip trial . in order to investigate how this change affects the final result , we performed @xmath47 independent runs ( @xmath48 ) using the @xmath49 flatness criterion and constructed again histograms of the locations of the peak of the specific heat .",
    "we tested the _ wls _ with different values for @xmath51 .",
    "[ gaussians_p ] shows the gaussian best - fits for @xmath52 ( conventional _ wls _ ) , @xmath53 and @xmath54 .",
    "the vertical line indicates the exact value using ref .",
    "one can see that the higher the values of @xmath51 , the narrower the gaussian curves . defining the relative error @xmath55 for any quantity @xmath56 by    @xmath57    we obtain the relative errors of the simulated mean values with respect to the result using ref .",
    "@xcite for @xmath52 , @xmath58 and @xmath1 as @xmath59 , @xmath60 and @xmath61 , respectively .",
    "therefore , we see that updating the density of states only after @xmath1 trial moves leads to more accurate results @xcite . in other words",
    ", adopting the monte carlo step ( @xmath1 trial moves ) , as it is conventional in the metropolis algorithm , is also convenient in the wang - landau algorithm .    .",
    "[ gaussians_p ]    in fig.[medcan_cv_l2 ] we show the evolution of the location of the maximum of the heat capacity during @xmath62 in which the density of states was updated only after every @xmath1 spin - flip trials , beginning from @xmath63 .",
    "we see that now the curves flow to steady values around @xmath64 and simulations with higher orders of the modification factor are unnecessary .",
    "one can see that , if on one hand the simulations adopting the monte carlo step becomes longer , on the other hand , the canonical averages converge to constant values much earlier .",
    "we now turn our attention to another important detail . what is the behavior of the microcanonical averages @xmath65 and @xmath66 during the sampling process ? we have also evaluated the microcanonical averages during the simulations . in order to estimate the mean value of the magnetization during each flatness stage we carried out @xmath31 independent runs and calculated @xmath65 for each @xmath67 with @xmath68 . in fig.[micro ] we show these results for two energy levels and see that they flow to relatively stable values around @xmath69 .",
    "we therefore conclude that the microcanonical averages should not be accumulated before @xmath70 .     at @xmath71 and @xmath72 during the simulations over @xmath31 independent runs for each flatness stage . ]    in fig.[medcan_khi_l2_comum ] we show the evolution of the maximum of the susceptibility during the simulations beginning from @xmath63 , updating the density of states after every @xmath1 spin - flip trials and accumulating the microcanonical averages only for @xmath73 .",
    "we observe that even for @xmath74 we do not obtain stable values like those of fig.[medcan_cv_l2 ] .",
    "however , if one takes the mean value of the microcanonical averages in @xmath75 independent runs and uses this result for calculating the canonical averages during the simulations the averages do flow to stable values , as shown in fig.[medcan_khi_l2_restrito ] .",
    "this result shows that even for quantities that involve the magnetization the simulations can be carried out only up to @xmath76 .",
    "the evolution of the canonical averages of the energy and the magnetization at a given temperature yields evidently patterns similar to those of fig.[medcan_cv_l2 ] and fig.[medcan_khi_l2_restrito ] with the same limit modification factors .",
    "we would like to stress that all modification factors defined above using the canonical e microcanonical averages during the simulations apply to the 2d ising model and it is important to perform studies similar to those of figures [ medcan_cv_l2 ] , [ micro ] and [ medcan_khi_l2_restrito ] before adopting this new procedure to other models to be sure on where to halt the simulations and where to begin accumulating the microcanonical averages .    in view of the above observations ,",
    "we propose the following new procedure for simulations :    * instead of updating the density of states after every spin - flip , we ought to update it after each monte carlo sweep ; * _ wls _ should be carried out only up to a @xmath77 defined by the canonical averages during the simulations ; * the microcanonical averages should not be accumulated before @xmath78 defined by the microcanonical averages during the simulation .",
    "fig.[medcan_1_t ] shows the evolution of the maxima of the specific heat during the simulations using the @xmath0 scheme , beginning from the second stage and halting the simulations when the cpu time matched up the mean time of the simulations of fig.[medcan_cv_l2 ] .    in order to compare these results we performed @xmath47 independent runs of _ wls _ for @xmath48 up to @xmath76 using @xmath49 and @xmath50 flatness criterions ( @xmath79 and @xmath80 ) and built up the histograms .",
    "next we carried out similar simulations using the @xmath0 algorithm , halting the simulation when the cpu time matched up those of @xmath81 ( @xmath82 and @xmath83 ) . in fig.[histograms ] we show the best - fit gaussians of the histograms .",
    "one can see that they are not really centered around the exact value .",
    "the relative errors of the simulated mean values with respect to the result using ref .",
    "@xcite yield @xmath84 and @xmath85 , respectively , for @xmath79 and @xmath80 , and @xmath86 and @xmath87 for @xmath82 and @xmath83 , with final @xmath88 reaching @xmath89 and @xmath90 .",
    "we see that although the widths of the @xmath0-curves are smaller , their centers are farther apart from the exact value than those of @xmath62 revealing a biased estimation effect in the @xmath0 method .",
    "according to finite - size scaling theory @xcite from the definition of the free energy one can obtain the zero field scaling expressions for the magnetization and the susceptibility , respectively by    @xmath91    @xmath92    we see that the locations of the maxima of these functions scale asymptotically as @xmath93 where @xmath94 is a quantity - dependent constant , allowing then the determination of @xmath95 .    in order to compare the efficiency of the conventional _ wls _ , the _ 1/t_-scheme and our procedure , we performed simulations with @xmath96 and @xmath97 taking @xmath98 and @xmath99 independent runs for each size , respectively .    . ]",
    "c c c c c case & @xmath95 & @xmath100 & @xmath101 & cpu time + [ 0.5ex ] exact & 2.2691853 ... & 0.125 & 1.75 & +   + @xmath102 & 2.2621(11 ) & 0.197(14 ) & 1.943(35 ) & 0.15 + @xmath103 & 2.2642(11 ) & 0.1479(84 ) & 1.846(18 ) & 0.30 + @xmath104 & 2.26848(35 ) & 0.1297(31 ) & 1.7833(46 ) & 1.51 + @xmath105 & 2.26904(25 ) & 0.1259(21 ) & 1.7708(23 ) & 3.03 + @xmath106 & 2.26944(11 ) & 0.12647(94 ) & 1.7616(17 ) & 15.13 +   + @xmath49 & 2.26699(55 ) & 0.1295(45 ) & 1.7812(63 ) & 1.00 + @xmath50 & 2.26829(33 ) & 0.1386(51 ) & 1.7899(87 ) & 1.75 + [ 1ex ] + @xmath49 & 2.26934(23 ) & 0.1270(16 ) & 1.7631(27 ) & 9.78 + @xmath50 & 2.26916(12 ) & 0.12494(68 ) & 1.7555(32 ) & 22.21 + [ 1ex ]     with @xmath49 flatness criterion for conventional _ wls _ ( top ) and using our procedure ( bottom ) . ]     flatness criterion for conventional _ wls _ at @xmath107 ( top ) and using our procedure at @xmath108 ( bottom ) . ]    using these scaling functions we estimated the critical temperature and the critical exponents @xmath100 and @xmath101 . taking",
    "a microcanonical average including all independent runs was important to reveal in fig.[medcan_khi_l2_restrito ] that for quantities that involve the magnetization the simulations can also be carried out only up to @xmath76 , but such a procedure does not lead to better results for the estimation of the canonical averages .    assuming @xmath109 we can use eq . to determine @xmath95 as the extrapolation to @xmath110 ( @xmath111 ) of the linear fits given by the locations of the maxima of the specific heat and the susceptibility defined by eqs.- . in fig.[tc ] we show the linear fits that converge to @xmath95 at @xmath111 for conventional _ wls _ and the new procedure , both using the @xmath49 flatness criterion . the final estimate for @xmath95",
    "was taken as the mean value obtained from both fits .",
    "since @xmath95 is now estimated , we can calculate the critical exponents @xmath100 and @xmath101 . according to eq . , the maximum of the finite - lattice susceptibility defined by eq .",
    "is asymptotically proportional to @xmath112 . in fig.[gamma ] we show these results for the conventional _ wls _ and our procedure , both using the @xmath49-criterion of flatness . in the vicinity of the critical temperature",
    "the magnetization scales as @xmath113 .",
    "we can use eq . at the critical point to calculate the exponent @xmath100 directly from the slope of the log - log graph and find @xmath100 . in fig.[beta ] we show again the results for conventional _ wls _ and our procedure for this exponent .",
    "one can see that in all cases our procedure is more accurate than the conventional _",
    "wls_.    for the conventional _ wls _ and the new procedure proposed here , simulations were carried out using @xmath49 and @xmath50 flatness criterions and for _ 1/t _ scheme the simulations were halted for @xmath114 and @xmath115 . in table [ table ] we show the results for the @xmath0 simulations , the conventional _ wls _ and our procedure along with the exact values .",
    "the @xmath0 results become accurate only when @xmath116 , and for lower values of @xmath27 they become worse , giving the impression that they are already fluctuating around the true value .",
    "the conventional _ wls _ , displays problems of accuracy , while our results are adequately accurate for both 80% and 90% flatness criterions .",
    "it is worthwhile mentioning that we have obtained high - resolution values using the 90% flatness criterion , which should be compared with the erratic behavior of the @xmath0 simulations for @xmath117 , but such stringent level of flatness is difficult to apply to other systems @xcite , resulting sometimes in non - convergence or even more inaccurate values .",
    "moreover the 90% flatness criterion simulations are very time consuming .",
    "we conclude therefore that the widely adopted 80% flatness criterion is indeed the best guess , since it is applicable to all systems .",
    "in this section , we apply to a homopolymer the initial tests to determine up to which modification factor one should continue the @xmath62 and from which @xmath118 the microcanonical averages should be accumulated .",
    "we consider a homopolymer consisting of @xmath35 monomers which may assume any self avoiding walk ( saw ) configuration on a two - dimenstional lattice .     at @xmath119 and @xmath120 during the simulations over @xmath121 independent runs for each flatness stage . ]    assuming that the polymer is in a bad solvent , there is an effective monomer - monomer attraction in addition to the self - avoidance constraint representing excluded volume .",
    "for every pair of non - bonded nearest - neighbor monomers the energy of the polymer is reduced by @xmath122 .",
    "the hamiltonian for the model can be written as @xmath123 where @xmath124 if the site @xmath125 is occupied(vacant ) , and the sum is over nearest - neighbor pairs@xcite .",
    "( the sum is understood to exclude pairs of bonded segments along the chain . )",
    "we used the so - called reptation or _",
    "`` slithering snake '' _ move which consists of randomly adding a monomer from one end of the chain and removing a monomer from the other end , mantaining the size of the polymer constant.we define one monte carlo step as @xmath35 attempted moves .    in this model",
    ", besides the energy , another quantity of interest is the mean square end - to - end distance given by @xmath126\\rangle\\ ] ]    as prescribed in section ii , we updated the density of states and the histogram only after each monte carlo step . in order",
    "define from which modification factor to begin accumulating the microcanonical averages we estimated @xmath127 for each @xmath67 during the simulations for several energy levels . in fig.[micro_pol ] we show these results for @xmath119 and @xmath120 ( the ground state of the @xmath128 homopolymer is @xmath129 ) .",
    "one can see that the microcanonical averages should be accumulated from @xmath130 . on the other hand , to estimate @xmath131 for halting the simulations , we calculated the canonical average of the energy and the mean square end - to - end distance during the simulations for five fixed temperatures , namely , @xmath132 and @xmath133 . in fig.[medpol ]",
    "we show the behavior of the energy at @xmath134 and in fig.[end_to_end ] the behavior of the mean square end - to - end distance at @xmath135 .",
    "all the graphs we have constructed for these quantities for the temperatures mentioned above have similar performance .",
    "we see therefore that for this model the simulations should be carried out up to @xmath136 .",
    "other more elaborate models , such as the hp model of protein folding @xcite or continuous ( off - lattice ) models of polymers @xcite will require a test similar to the one made in this section that may point to different values for @xmath118 and @xmath131 .",
    "notwithstanding that , our results suggest that this final modification factor will occur far before @xmath137 , leading to considerable cpu time savings .",
    "we have demonstrated that the conventional _ wls _ presents problems of accuracy , but with very few changes in the implementation of the method , namely , updating the density of states only after each monte carlo step , halting the simulations for @xmath138 , with @xmath131 determined by the canonical averages during the simulations and accumulating the microcanonical averages only for @xmath139 , where @xmath118 is found from the behavior of the microcanonical averages in each modification factor , it becomes quite accurate .",
    "adopting the monte carlo step to update the density of states and delaying the start of the microcanonical averaging are changes that lead to a improved accuracy of the algorithm , while the proper definition of when to stop the simulation ( @xmath131 ) saves a lot of cpu time .",
    "it should be pointed out that a direct comparison of the density of states with exact calculations , although pictorially very impressive , is not a good test for algorithms that estimate the density of states .",
    "the canonical and microcanonical averages during the simulations are a more adequate checking parameter for convergence .",
    "another important conclusion is that no single simulation in particular tends to the exact value .",
    "one can obtain results as close as possible to the exact value by increasing the number of independent runs .",
    "the great advantage of our findings is that all existing codes using _ wls _ can be promptly adapted to this new procedure just adding a few lines to the computer program .",
    "this work was supported by brazilian agencies cnpq and funape - ufg .",
    "the study performed in @xcite was carried out updating the density of states after every @xmath1 trial moves .",
    "thanks to a fortunate misunderstanding , the authors have adopted the monte carlo sweep by analogy with the metropolis algorithm ."
  ],
  "abstract_text": [
    "<S> in this work we investigate the behavior of the microcanonical and canonical averages of the two - dimensional ising model during the wang - landau simulation . </S>",
    "<S> the simulations were carried out using conventional wang - landau sampling and the @xmath0 scheme . </S>",
    "<S> our findings reveal that the microcanonical average should not be accumulated during the initial modification factors _ f _ and outline a criterion to define this limit . </S>",
    "<S> we show that updating the density of states only after every @xmath1 spin - flip trials leads to a much better precision . </S>",
    "<S> we present a mechanism to determine for the given model up to what final modification factor the simulations should be carried out . </S>",
    "<S> altogether these small adjustments lead to an improved procedure for simulations with much more reliable results . </S>",
    "<S> we compare our results with @xmath0 simulations . </S>",
    "<S> we also present an application of the procedure to a self - avoiding homopolymer . </S>"
  ]
}