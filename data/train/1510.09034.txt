{
  "article_text": [
    "determining 3d velocity fields from flow experiments is difficult especially if a high spatial resolution is desired . for optical particle - based measurement techniques , a high spatial resolution implies a high density of tracer particles that need follow the flow and have to be observed using multiple cameras .    instead of identifying and matching particles separately between different views , which is nontrivial at high particle densities ,",
    "a tomographic approach has been successfully applied in the past to the particle distribution reconstruction problem .",
    "this method is called _ tomopiv _ for tomographic particle image velocimetry . in tomopiv",
    "the measurement volume is discretized and reconstructed as the solution to a large but sparse and constrained linear equation system resulting in a discrete volume of light intensities .",
    "one way of deriving flow fields from these volumes is to apply a cross correlation between two subvolumes of reconstructions from neighbouring points of time to detect the average flow velocity within such a subvolume .",
    "this is a robust method to compute flow velocities but results in a spatially lowpass filtered representation of the velocity depending on the size of the subvolumes used for cross - correlation usually called window size .    with recent advances in particle tracking techniques the density of particles that can be reconstructed directly without discretizing the volume is approaching densities that are typically used in tomopiv measurements .",
    "the advantage of methods for reconstructing particle locations directly instead of a discretized volume has several benefits over a tomographic reconstruction : it typically requires a only small fraction of cpu and ram resources compared to what is needed for tomopiv to solve the large constrained equation system .",
    "also , such a direct particle reconstruction method avoids an additional layer of spatial discretization which can be expected to improve the accuracy of particle location measurements .",
    "given a sequence of time - resolved measurement images of a flow with tracer particles , particle tracks can be reconstructed with these new techniques .    in this publication , we will describe a method for reconstructing velocity and acceleration fields from scattered and noisy particle tracks which we developed with the goal of preserving much of the information present in the particle tracks and avoiding any unwanted spatial lowpass filtering effect such as the one that is inherent in correlation - based methods .",
    "in addition , it s possible to exploit prior knowledge to improve the spatial resolution of the reconstructed field such as as freedom of divergence of the velocity field for cases with incompressible flow .",
    "our approach to compute velocity and acceleration fields based on noisy particle tracks can be split into two parts :    * _ trackfit _ takes the noisy particle location data of a particle track and computes a b - spline curve for the track .",
    "this step includes noise reduction and allows computing 1st and 2nd order derivatives for velocity and acceleration at any position in time within the time interval of the observed particle track . *",
    "_ flowfit _ takes particle locations and any other physical quantity for each such location such as velocity or acceleration for one particular point in time and computes a 3d b - spline curve that optionally satisfies other constraints such as freedom of divergence or curl .",
    "this step involves solving a linear weighted least squares problem .",
    "these steps share many similarities .",
    "both make use of b - splines to represent the result as a continuous function and both employ a similar form of noise reduction via penalization like it was introduced in @xcite .",
    "the difference is that _ trackfit _ deals with data that is already equidistantly sampled and one - dimensional while _",
    "deals with scattered data in three dimensions .",
    "_ flowfit _ is also able to compute vector fields that are free of divergence or curl by extending the equation system that is used for computing the b - spline weighting coefficients with appropriate equations penalizing divergence or curl .",
    "this is useful for incompressible flows and improves the spatial resolution to some extent .",
    "instead of restricting ourselves to time and space discrete signals for a particle track or a velocity field we can try to reconstruct a _ continuous _",
    "function with a finite number of degrees of freedom .",
    "building a function such as a particle track that maps time to particle location or velocity field that maps location to flow speed as a weighted sum of b - splines is one option to model a continuous function and has several benefits : the function will automatically be as smooth as one desires and function evaluation including temporal or spatial derivatives is fast .",
    "for example , a cubic b - spline is twice continuously differentiable and so is every linear combination of cubic b - splines .",
    "also , such a representation allows us to express the function s value or any derivative at any point exactly as a linear combination of weights without the need to numerically approximate derivatives .    throughout this paper",
    "the @xmath0-th order cardinal b - spline function centered at zero will be referred to as @xmath1 .",
    "this family of functions can be defined recursively in the following way :    @xmath2    in the special case @xmath3 for a quadratic b - spline , this can be written as    @xmath4    and for the special case @xmath5 , a cubic b - spline , we get    @xmath6",
    "a time - discrete 3d particle track can be viewed as three digital signals that represent how the particle s x- , y- and z coordinates change over time .",
    "a simple but reasonable model of the measured particle locations is that they are the sum of the particle s real locations and a measurement error signal . typically , the high frequency portion of these measured location signals are dominated by measurement noise while in the low frequency portion the measurement noise will be negligible compared to the signal .",
    "one way of dealing with this is to use a corresponding wiener filter that has the goal of minimizing the sum of squared errors .        under the assumption that the measurement noise is not correlated with the true particle s locations",
    "the optimal wiener filter simplifies to a filter with a phase response of constant zero and an amplitude response that is completely determined by the signal - to - noise ratio in the following way where @xmath7 refers to the frequency and @xmath8 refers to the power spectral density ratio between the noise - free signal and the noise :    @xmath9    after performing a spectral analysis of particle track data of different flow experiments we observed the following : the square root of the true particle locations power spectral density had a shape roughly proportional to @xmath10 near the the frequency where the signal - to - noise ratio equals one .",
    "the noise floor was flat which is expected when location measurement errors of different points in time do nt correlate with each other .",
    "this leads to our simple model of the signal and noise spectra for which a specific wiener filter follows using equation [ eq : snr2ampresponse ] , see figure [ fig : wienerspectrum ] .    after experimenting with different kinds of filter design methods and implementations we noticed that such a wiener filter can be approximated well using a b - spline fit with the appropriate choice of penalization .",
    "the input to _",
    "are @xmath11 measured values @xmath12 for @xmath13 , representing for example all the y - components of a particle that was tracked for @xmath11 equidistantly spaced points in time . without loss of generality we can assume a time step of one . with knots at locations @xmath14 , a cubic spline function for the interval @xmath15",
    "$ ] can be represented as the following weighted sum of @xmath16 b - splines    @xmath17    where @xmath18 are the unknown weighting coefficients and @xmath19 refers to the cubic cardinal b - spline defined in the previous section .",
    "we compute these coefficients by minimizing the cost function    @xmath20    where the parameter @xmath21 controls how strongly the third order finite differences are penalized in relation to the error between measurement and the fitted curve . a very large value for @xmath21 approaching infinity will result in a spline curve that approaches a quadratic polynomial for the whole particle track .",
    "smaller values will lead to a spline curve that will follow the measurement data more closely .",
    "we can also interpret this approach as a kalman - like filter : the measured particle locations are combined with a physical model in which the change in acceleration is assumed to be white noise and the parameter @xmath21 is chosen as ratio between the standard deviation of the location measuement noise and the standard deviation of the unpredictable change in acceleration in order to estimate the most likely particle track under this model .    the resulting mathematical problem is weighted linear least squares problem with a sparse matrix .",
    "the matrix of the corresponding normal equation system , see equation [ eq : trackfitnormaleqs ] , will be a symmetric positive definite 7-band matrix for which efficient factorizations can be computed in - place to solve for the b - spline weights @xmath18 directly .",
    "the condition of the normal equation system is acceptible for typical machine accuracies and choices of @xmath21 .",
    "@xmath22    we refer to the frequency at which the power spectral density of the signal and noise cross each other the cutoff frequency .",
    "the optimal wiener filter would have an amplitude response of @xmath23 at this frequency which follows from equation [ eq : snr2ampresponse ] .",
    "for a normalized cutoff frequency @xmath24 between @xmath25 and @xmath26 where @xmath27 represents the nyquist frequency choosing @xmath21 according to equation [ eq : trackfitlambda ]        @xmath28    will result in a a b - spline fit that approximates the optimal wiener filter quite well , compare figures [ fig : wienerspectrum ] and [ fig : trackfit_filters ] .",
    "the cutoff frequency is in the denominator so that a lower frequency will lead to a stronger penalization of the third order derivative .",
    "the third power is due to the fact that we are penalizing the third oder derivative which scales with the third power of a frequency .    to determine the magnitude response of the filter we compute the fourier transform of an impulse response . to compute the impulse response we set @xmath11 to 201 , @xmath12 to zero for all @xmath29 and @xmath30 to one .",
    "figure [ fig : trackfit_filters ] shows five examples with different values for @xmath21 for different cutoff frequencies .    after computing the b - spline weighting coefficients @xmath31 for a specific particle track , the track curve can be evaluated at any point in time along with its first and second derivatives .",
    "this allows temporal super sampling of the curve with consistent particle locations , velocities and accelerations for later processing .",
    "it is worth pointing out that under the assumption our particle track model holds and the @xmath21 parameter was chosen correctly , variances of the b - spline coefficient errors due to the measurement noise will be larger at the borders of the track than at center of the track .",
    "this can be verified by inspecting the diagonal of the inverse of @xmath32 from equation [ eq : trackfitnormaleqs ] which represents all the variances of @xmath31 multiplied by @xmath33 times the variance of the particle location measurement noise .",
    "this means that one should not put equal trust in the computed locations , velocities and accelerations over the complete time interval .",
    "for the spatial reconstruction of a vector field given scattered data for a particular point in time , it is possible to extend the method of penalized b - splines to multiple dimensions on a cartesian lattice with a point distance @xmath34 . for every lattice point within a certain cube we would have @xmath35 degrees of freedom , for example , @xmath36 for a velocity or material acceleration field , that are the weighting factors for the corresponding 3d b - spline functions of order @xmath0 .",
    "suppose @xmath37 is the coordinate of the lower corner lattice point of the volume and @xmath38 describes the number of grid points in each dimension .",
    "then , we can assign each grid point an index between @xmath27 and @xmath39 along with a world coordinate @xmath40 for the @xmath41-th lattice point derived from @xmath42 and @xmath34 and represent the vector field as the function shown in [ eq : flowfit_curve_model ]          with this model of the vector field each given data point results in @xmath35 linear equations involving @xmath46 unknown b - spline weighting coefficients because for any such point there are @xmath47 lattice points for each spatial dimension that contribute to the value of the resulting function and we have @xmath35 separate variables for each lattice point .",
    "in addition to equations for the data points it is possible to add regularizations for overall smoothness ( similar to how a higher order derivative is penalized in the _ trackfit _ approach ) but also to penalize other physical properties such as the divergence of a velocity field or the rotation of a material acceleration field assuming that acceleration is dominated by the pressure gradient .",
    "both the divergence and rotation of the vector field at an arbitrary point in the domain of @xmath48 can be expressed as a linear combination of the unknown variables @xmath49 so that resulting optimization problem is still a linear least squares problem ."
  ],
  "abstract_text": [
    "<S> in this work a method for reconstructing velocity and acceleration fields is described which uses scattered particle tracking data from flow experiments as input . the goal is to reconstruct these fields faithfully with a limited amount of compute time and </S>",
    "<S> exploit known flow properties such as a divergence - free velocity field for incompressible flows and a rotation - free acceleration in case it is known to be dominated by the pressure gradient in order to improve the spatial resolution of the reconstruction . </S>"
  ]
}