{
  "article_text": [
    "a basic concept in time - dependent density functional theory @xcite is a reference system of noninteracting electrons of the same density @xmath6 as the interacting electrons under study and which move in an appropriately adjusted potential @xmath7 .",
    "therefore , an important element of this theory is the density response function @xmath8 that describes the variation in density @xmath9 of such reference electrons upon a change @xmath10 of the kohn  sham potential @xmath11 the kohn ",
    "sham density response is needed for implementing hedin s gw approximation @xcite , for electronic excitation spectra grosspetersilka , casida , for treating excitons in molecular systems @xcite , and in other contexts , such as the inclusion of the van der waals interaction in dft @xcite .",
    "various methods have been developed for constructing this response function in solids @xcite , but for molecules no computationally efficient method has emerged . therefore , the kohn  sham density response remains an important bottleneck in applications of electronic structure methods to molecular physics . in the present paper",
    "we describe a solution to this long standing technical problem .",
    "the difficulty of dealing with the noninteracting density response is somewhat surprising , since it can be written down very compactly in terms of molecular orbitals    @xmath12    here @xmath13 represents a stationary ( real valued ) molecular orbital of energy @xmath14 measured relative to the fermi energy ( set to zero ) , @xmath15 are occupation factors and the energies @xmath16 of a particle ",
    "hole pair must be of opposite signs , @xmath17 .",
    "although this form of the density response was used very effectively in casida s equations for molecular spectra @xcite , it is less useful , for example , in computing the screening of the coulomb interaction . in this context",
    ", we must integrate over the arguments @xmath18 , @xmath19 of @xmath20 which requires a summation over @xmath21 pairs of points @xmath18 , @xmath19 and over @xmath22 energies @xmath23 where @xmath2 is the number of atoms .",
    "therefore , a straightforward application of the conventional expression requires a total of @xmath24 operations .",
    "the strong growth of cpu ( central processing unit ) effort with the number of atoms limits the usefulness of expression ( [ conventional ] ) to molecules or clusters containing very few atoms .",
    "( [ conventional ] ) shows that @xmath0 acts in the space of products of molecular orbitals @xmath25 , a space that has no obvious basis .",
    "chemists have long recognized that both the space of products of molecular orbitals and the related space of products of atomic orbitals contain many linearly dependent elements @xcite . to eliminate such redundant elements , products of orbitals",
    "are usually parametrized in terms of sets of auxiliary functions @xcite,@xcite .    in a better controlled and more systematic approach @xcite ( for a similar method in the context of the gw approach see @xcite )",
    ", one identifies the dominant elements in the space of all products of a given pair of atoms . as a result of this construction , any product of atomic orbitals @xmath26",
    ", @xmath27 can be expanded in a basis of @xmath28 `` dominant functions '' @xmath29 . in this basis ,",
    "the density response acts as a frequency dependent matrix @xmath30 @xmath31 the present paper describes an efficient construction of this matrix by green s function type methods that require @xmath32 operations for a molecule of @xmath2 atoms and in a spectroscopic window of @xmath3 frequency points .    to test this construction ,",
    "we apply it to electronic excitation spectra of molecules , where many results are known .",
    "we consider two approaches for excitation spectra : the petersilka  gossmann ",
    "gross equations @xcite and casida s equations @xcite .",
    "the test of @xmath0 on molecular spectra turns out to be successful as our spectra agree indeed with those found from casida s equation .",
    "our paper is organized as follows : in section [ s:2 ] we derive a spectral representation of @xmath0 and discuss its locality properties . in section [ s:3 ] , we formulate and test an algorithm that exploits the spectral representation of @xmath0 . in section [ s:4 ] , we further test @xmath0 by applying it to the computation of electronic excitation spectra . to accelerate the computation",
    ", we develop an iterative lanczos - like procedure .",
    "section [ s:5 ] gives our conclusions .",
    "our approach is based on green s functions and their spectral functions .",
    "so let us recall some of their basic definitions @xcite and establish our notation . in the framework of second quantization ,",
    "the electronic propagator reads    @xmath33    where @xmath34 and @xmath35 are annihilation and creation operators of electrons , respectively .",
    "the symbol @xmath36 represents time ordering of operators and @xmath37 is the unit step function .    according to general principles @xcite , the density response function ( [ density_response_definition ] ) coincides with the density  density correlator of the unperturbed system @xmath38 where @xmath39 is the electronic density operator . for simplicity",
    ", we mostly use the time ordered form of correlators , the fourier transform of which coincides with that of the causal one at positive frequencies . for noninteracting electrons ,",
    "the density response can be expressed in terms of electron propagators @xmath40 . applying wick s theorem @xcite on eq .",
    "( [ chi_product_green ] ) , we find    @xmath41    where we ignore the time - independent ( disconnected ) part of the correlator that contributes to the response only at zero frequency .    to confirm the conventional expression for @xmath42 in terms of molecular orbitals ( [ conventional ] ) , we expand the operators @xmath43 in terms of kohn  sham orbitals @xmath44 and their associated fermion operators @xmath45 @xmath46 we use the last expression to rewrite the green s function ( green_definition ) in terms of molecular orbitals",
    "@xmath47where we took into account the anticommutator @xmath48_{+}=\\delta_{e , e^{\\prime}}$ ] , the time evolution @xmath49 and the nature of the ground state .",
    "regularizing the above expression with a damping factor @xmath50 , using ( [ traditional_green ] ) in eq .",
    "( [ chi0-gf - gf ] ) and doing a fourier transform on the result , we easily confirm the textbook expression eq .",
    "( [ conventional ] ) for @xmath42 .",
    "our approach emphasizes locality and it is better to use a localized basis of atomic orbitals @xmath26 .",
    "therefore , we write the molecular orbitals as linear combinations of atomic orbitals ( lcao ) @xmath51 here @xmath52 are ( generalized ) eigenvectors of the kohn - sham hamiltonian labelled by their eigenvalues @xmath14 . inserting the latter expression in equation ( [ traditional_green ] )",
    ", we obtain the propagator in the localized basis . for later convenience , we write this result in terms of spectral functions of particles and holes @xmath53 here",
    ", we introduced the spectral densities of particles and holes @xmath54      let us also write the operators @xmath43 in terms of localized atomic orbitals with localized fermion operators @xmath55 as coefficients @xcite .",
    "we have @xmath56 with @xmath57 . because we use local orbital fermions ( [ localfermions-1 ] )",
    ", the electron density @xmath6 is given by a sum over products of orbitals multiplied by bilinears of fermion operators @xmath58it is well known that the set of products of orbitals contains collinear or nearly collinear elements , a fact nicely illustrated by taking products of the eigenfunctions of the harmonic oscillator @xcite .",
    "traditionally , this difficulty is treated by expanding products of orbitals in auxiliary functions .    in a recent and more systematic approach @xcite",
    ", one identifies a set of `` dominant products '' @xmath59 as special linear combinations in the space of products of orbitals .",
    "a similar method was previously developed in the context of the gw method @xcite .",
    "the main collinearity of the set of orbital products occurs at the level of a fixed pair of atoms .",
    "therefore all the products @xmath60 belonging to such a fixed pair were formed .",
    "a matrix of overlaps between these products was computed and the dominant products were found among the linear combinations of the original products that diagonalize this matrix . as a result , any nonzero product of orbitals belonging to a given pair of atoms can be expressed in terms of a much smaller set of dominant products with respect to the same pair of atoms @xmath61the notation @xmath62 alludes to the eigenvalues @xmath63 that are related to the norm of these functions and which are centered at a midpoint between the atoms . in lcao one",
    "enumerates the atomic orbitals @xmath26 with a global index @xmath64 .",
    "here we also enumerate the set of dominant functions of all pairs with a single index @xmath65 .",
    "with such an enumeration , the relation ( [ basis ] ) then becomes true for arbitrary products of orbitals and with a vertex @xmath66 which is sparse .",
    "indeed , for arbitrary orbitals @xmath67 the vertex @xmath66 is non zero only for those products @xmath68 that belong to that pair of atoms which is associated with the orbitals @xmath67 .",
    "the reduction in the number of functions occurs by ignoring the ( many ) functions @xmath69 that belong to eigenvalues that are below a chosen threshold @xmath70 .",
    "empirically , the norm of the omitted products vanishes exponentially with respect to the number of basis functions retained .",
    "although the convergence of the physical results with respect to the cutoff @xmath70 must be checked , this convergence poses no problem .",
    "combining eqs .",
    "( [ bilinear ] , [ basis ] ) , we may express the density operator as @xmath71inserting this representation of the density into eq .",
    "( [ chi_product_green ] ) , we find a representation of the density correlator as a sum of products of dominant functions @xmath72the entries of the matrix @xmath73 are correlators of bilinears of local fermions    @xmath74    in this equation , the explicit expression in terms of green s functions was found again with the help of wick s theorem .",
    "equation ( tensor_of_correlators ) describes the creation , propagation and subsequent annihilation of a particle hole pair , see figure [ f : particle  hole ] .",
    "the figure shows why the construction of @xmath73 requires @xmath32 operations .",
    "there are @xmath28 dominant products for the entire molecule , and there are a total of @xmath22 pairs of such products . due to the locality of the vertex @xmath75 , there are , for each pair , of order @xmath76 electron propagators to be summed over .",
    "finally , the calculation must be done for @xmath77 frequencies .     in a basis of dominant products .",
    "the vertex @xmath78 connects pairs of orbitals @xmath67 to a dominant product @xmath79 .",
    "the propagators connect the orbitals within the orbital quadruplet . for a given pair of dominant products @xmath80 , there are @xmath81 orbitals to be summed over . therefore , the total computational effort scales as @xmath82.,width=340 ]      it would be a mistake to determine @xmath84 directly , on the basis of eq .",
    "( [ tensor_of_correlators ] ) , by brute force computation . at equal times",
    ", the electron propagator has a discontinuity which hampers such an approach .",
    "instead , it is better to relate the density response @xmath84 and the electron propagators @xmath85 indirectly via their spectral functions and to construct @xmath86 from its spectral density at the end .",
    "the fourier transform of the causal ( rather than the time ordered ) form of @xmath86 is analytic in the cut complex plane .",
    "therefore , it should have the following cauchy type spectral representation    @xmath87    once we know that such a representation should exist , it is easy to identify the spectral density by combining eqs .",
    "( [ gf],[sf],[tensor_of_correlators ] ) .",
    "after a brief calculation , we obtain the following result @xmath88 \\delta ( \\sigma + \\tau-\\lambda ) \\text { for } \\lambda>0 .",
    "\\label{convolution}\\end{aligned}\\ ] ] the first line shows that the response matrix @xmath89 can be computed from the spectral function @xmath90 by taking a convolution which requires @xmath91 operations when done by fast fourier methods .",
    "the second line shows that this spectral function is a weighted convolution of particle like ( @xmath92 ) and hole like ( @xmath93 ) spectral densities ( [ sf ] ) . as explained above after equation (",
    "17 ) and in figure 1 , the internal indices involved in the trace of the second equation run only over @xmath81 indices because the vertex @xmath94 is sparse .",
    "computationally , it is convenient to form new spectral functions @xmath95 and @xmath96 which , thanks to the sparsity of @xmath97 , costs @xmath32 operations .",
    "to compute the convolutions in eq .",
    "( [ convolution ] ) efficiently , we make extensive use of the fast fourier transform that does such convolutions in @xmath99 operations for @xmath77 frequency points @xcite . in this section",
    ", we will explain ( i )  how to discretise the electronic spectral density on a frequency lattice and ( ii )  how to evaluate the spectral integral over the infinite frequency interval in eq .",
    "( [ starting_point ] ) .",
    "we will discretize the electronic spectral densities in eq .",
    "( [ sf ] ) in a window @xmath100 and on a grid with spacing @xmath101 . to hide the effect this might have on @xmath89",
    "we will later broaden the spectral resolution by adding a small imaginary part @xmath102 to the frequency .",
    "let the grid points be defined as follows @xmath103        consider an eigenenergy @xmath14 that belongs to the frequency window @xmath104 @xmath105 and which is located between two successive mesh points @xmath106 .",
    "we distribute the spectral weight @xmath107 to the neighboring frequencies @xmath108 in a way that conserves ( i )  the total spectral weight and ( ii )  it s center of mass by using the following weight factors @xmath109 @xmath110alternatively , one may also minimize the norm of the difference @xmath111 between the pole at @xmath112 and its representation by poles at the two neighboring frequencies on the lattice @xmath113there is a simple expression for the norm of this error that can be obtained by contour integration @xmath114with @xmath115 , the coefficient @xmath116 , that minimizes the error norm , varies almost linearly between @xmath117 and @xmath118 as a function of @xmath119 and differs little from eq .",
    "( [ weights ] ) .",
    "as the errors are of the same order in both cases , we use the first and simpler method according to eq .",
    "( [ weights ] ) .",
    "this part of the calculation actually requires @xmath5 operations , but the prefactor is very small  the discretization of the spectral data of benzene takes about a second on a current personal computer .    to judge the quality of this discretisation",
    ", we compute the density of states @xmath120 in the case of benzene , within a window of frequencies ( i )  by direct calculation from the exact green s function and ( ii )  after redistributing the spectral weights .",
    "figure [ f : dos ] shows that the two densities of states differ very little .",
    "the good agreement between the two densities vindicates our discretization procedure .",
    "is computed with eigenvalues @xmath14 obtained using the siesta package siesta .",
    "default settings were used in the siesta run .",
    "the discretized dos is computed in the frequency window @xmath121 , @xmath122 rydberg with @xmath123 data points .",
    "@xmath124 is chosen to be @xmath125 , where the discretisation spacing is @xmath126 .",
    ", title=\"fig:\",width=340 ]   is computed with eigenvalues @xmath14 obtained using the siesta package siesta .",
    "default settings were used in the siesta run .",
    "the discretized dos is computed in the frequency window @xmath121 , @xmath122 rydberg with @xmath123 data points .",
    "@xmath124 is chosen to be @xmath125 , where the discretisation spacing is @xmath126 .",
    ", title=\"fig:\",width=340 ]      according to eq .",
    "( [ starting_point ] ) we must find an integral over the full spectral range @xmath127 even if we want spectroscopic results only for low frequencies @xmath128 .",
    "we resolve this difficulty by decomposing the integral in eq .",
    "( [ starting_point ] ) as follows @xmath129the first term @xmath130  in this decomposition has resonant structure because @xmath131 and @xmath63 may coincide in the denominator of its integrand .",
    "by contrast , the integrand in the expression for @xmath132 is regular and therefore this function has much less structure . in the resonant part , we must allow for sufficiently many grid points to capture the features of the spectral density .",
    "in the nonresonant part , we determine the spectral density for the full range of kohn  sham eigenvalues , and for simplicity , we use the same number of gridpoints @xmath3 .",
    "however , we need the resulting response function @xmath133 only in the frequency interval @xmath134 where we find its values on the corresponding grid points ( [ fine - grid ] ) by interpolation .    to judge the quality of @xmath89 constructed in this way , we make use of the exact expression ( [ conventional ] ) for the response function .",
    "the corresponding response matrix @xmath135 can be obtained by expressing @xmath136 in eq .",
    "( [ conventional ] ) in terms of dominant functions . using eqs .",
    "( [ conventional],[lcao],[basis ] ) we obtain @xmath137actually , the exact response matrix @xmath138 requires @xmath139 operations and it takes too long to compute for other than very small molecules .",
    "nonetheless , the exact expression ( [ exact_response_matrix ] ) is well suited as a test provided we use it only for fixed entries @xmath140 .",
    "figure  [ f : chi0_11 ] indicates that the error is well controlled and vindicates our `` two windows technique '' for constructing @xmath141 .     of benzene .",
    "the exact response is computed according to eq .",
    "( [ exact_response_matrix ] ) . the kohn ",
    "sham eigenstates were generated using the siesta package @xcite with default settings .",
    "the discretized response function is computed in the frequency window @xmath142 , @xmath122 rydberg with @xmath123 data points .",
    "@xmath124 is chosen to be @xmath125 , where the discretisation spacing is @xmath126.,title=\"fig:\",width=302 ]   of benzene .",
    "the exact response is computed according to eq .",
    "( [ exact_response_matrix ] ) . the kohn ",
    "sham eigenstates were generated using the siesta package @xcite with default settings .",
    "the discretized response function is computed in the frequency window @xmath142 , @xmath122 rydberg with @xmath123 data points .",
    "@xmath124 is chosen to be @xmath125 , where the discretisation spacing is @xmath126.,title=\"fig:\",width=302 ]    we argued before that the total computational cost of our method scales as @xmath32 and we believe that this scaling is the best that can be achieved for the noninteracting response function @xmath143 . in order to confirm this scaling",
    ", we computed the noninteracting response @xmath143 for a number of carbon chains , measured the wall clock time and represented it in figure [ f : scaling - sqr - natoms - time ] .",
    "the scaling law is slightly disturbed , probably due to the high memory requirement of our algorithm in the case of the @xmath144 chain .     as a function of the number of atoms @xmath2 in the case of carbon chains.,width=302 ]",
    "in the previous section , we gave a first test of our construction of @xmath145 by comparing with an exact result .",
    "here we will further test @xmath145 by using it to compute molecular spectra from the petersilka  gossmann  gross equations of tddft linear response @xcite @xmath146 the results will be compared with spectra obtained using casida s equations @xcite .",
    "the petersilka  gossmann  gross equations are a consequence of a generalisation of the kohn",
    " sham equations of the electron gas  @xcite to time dependent electron densities    @xmath147    here @xmath7 is the potential that assures a prescribed density @xmath6 of the noninteracting kohn  sham reference electrons , @xmath148 ( the factor 2 is from spin ) and @xmath149 is the exchange correlation potential .",
    "all quantities in this equation depend on the electronic density @xmath6 .",
    "we differentiate both sides with respect to this density and , upon using @xmath150 , @xmath151 , we obtain equation  ( [ grosspolarisation ] ) with the following kernels @xmath152we make the conventional `` adiabatic '' assumption that @xmath153 has no memory and that it depends only on the instantaneous electron density .",
    "therefore , both @xmath154 and @xmath155 are local in time and their fourier transforms are frequency independent .",
    "to write the petersilka - gossmann - gross equations in our basis of dominant functions , we start with the integral form of this equation @xcite : @xmath156 in our basis of products and with the parametrizations @xmath157 and @xmath158 , this dyson equation takes the following form@xmath159 in the last section , we computed @xmath160 . in the next subsections we will compute the kernels @xmath161 , @xmath155 and the polarizability @xmath162 .      in the basis of dominant products ,",
    "the hartree part of the kernel reads @xmath163for the present discussion to be reasonably self contained , we must give more details on the structure of the dominant products @xcite .",
    "as seen previously in section  [ s:2 ] , the dominant products were constructed in the context of the lcao method where molecular orbitals are expanded as in eq .",
    "( [ lcao ] ) . therefore",
    ", orbital products and the dominant products constructed from them have either spherical or only axial symmetry depending on whether the two atoms that give rise to them coincide or not .",
    "technically , the products are represented as expansions in spherical harmonics ( in appropriate local coordinates , in the case of bilocal products ) about a midpoint between the two atoms that form the pair .",
    "the hartree kernel @xmath164 involves two products @xmath165 , @xmath166 that belong , generally , to two distinct pairs of atoms with their own axial or spherical symmetry and local coordinates . with the help of wigner s rotation matrices",
    "@xmath167 @xcite the two distinct products can be referred to a single reference frame . in the end",
    ", the hartree kernel is reduced to a sum of conventional two center integrals @xmath168where the elementary functions @xmath169 are explicitly of spherical symmetry . in our calculation to improve the performance . ]    the calculation of such conventional two center integrals is conveniently done in momentum space and using talman s fast bessel transform @xcite to relate real space orbitals to their fourier images .    due to the finite support of the dominant products ,",
    "the hartree kernel must be integrated explicitly only for a subset of @xmath28 pairs of mutually overlappinging dominant products .",
    "the coulomb interaction of the remaining nonoverlapping pairs of products can be calculated exactly and cheaply as an interaction between their multipoles .    by contrast , the remaining kernel @xmath155 is a 3-dimensional integral in the local density approximation@xmath170there are only @xmath28 such matrix elements to calculate because the basis functions @xmath171 have finite support . in the general case ,",
    "the integration domain is an overlap of two distinct lenses because the support of each dominant product is an overlap of two spheres . in spite of this , we used a simple numerical integration in spherical coordinates as an easy alternative to more elaborate integration techniques , with the center of spherical coordinates on the midpoint between the two centers , each associated with a dominant product .",
    "the integration over solid angle is done via lebedev s method @xcite and integration over the radial coordinates is done by the gauss  legendre method . by default",
    ", we use 86 grid points in lebedev integration and 24 grid points in gauss ",
    "legendre integration .      using the matrix form of the density response @xmath172 from eq .",
    "( [ matrix_dyson ] ) , we find the interacting polarizability @xmath162 @xmath173here @xmath174 is a vector of dipole moments that is associated with the dominant products @xmath165 .",
    "we may compute the polarizability ( [ polarizability ] ) by matrix inversion or , alternatively , by solving @xmath2 linear equations in @xmath2 variables to find @xmath175 .",
    "either method requires @xmath176 operations which is worse than the @xmath32 scaling in the computation of @xmath143 . on the other hand , equation ( [ polarizability ] )",
    "shows that the polarizability does not see the full matrix @xmath177 but only its ( low rank ) projection onto the dipole moments @xmath178 .",
    "fortunately , iterative lanczos  krylov methods @xcite are capable of finding such projections of the inverse of a matrix in @xmath21 operations .    to find the inverse of a matrix @xmath179 contracted with two vectors @xmath180 and @xmath181",
    ", we use a biorthogonal lanczos construction based on the two sets of krylov spaces @xmath182 .",
    "this construction provides us with ( i ) a set of orthonormal states @xmath183 , with ( ii ) a tridiagonal representation of @xmath184 and ( iii ) with an easily calculable inverse of @xmath184 within the krylov spaces @xmath185    @xmath186    ( we wrote @xmath187  because the construction is at most asymptotic ) .",
    "we find the following representation of the trace of the polarizability ( relevant when averaging over directions ) @xmath188the relation @xmath189 is a simple normalization condition that follows also from the biorthogonality of the lanczos vectors .",
    "equation ( [ scalar_lanczos ] ) shows that the interaction causes the kohn ",
    "sham polarizability to be multiplied by a factor that is the @xmath190 component of the inverse of the matrix @xmath191 . with a small krylov dimension of @xmath76 , the calculational effort scales as @xmath21 . and @xmath192 consecutively on vectors , rather than forming the matrix @xmath193 which would require @xmath5 operations .",
    "we assumed the dimension of the krylov space to be of order @xmath76 , but we have not checked this in detail . ]",
    "if the full polarization tensor @xmath194 is wanted , then it is better to use a block lanczos procedure @xcite .",
    "we then consider the following krylov spaces and biorthogonalize them @xmath195where @xmath196 and @xmath197  represent , respectively , @xmath198 and @xmath199 . the scalar representation ( [ scalar_lanczos ] ) is now replaced by the following block representations of @xmath200    @xmath201    applying this to @xmath162  we found @xmath202we chose to keep the left vectors at the lowest krylov level unchanged and obtain @xmath203 as a normalization condition .",
    "we therefore find the following simple matrix relation between @xmath204 and @xmath205 @xmath206the details of the block lanczos algorithm @xcite are not given here .",
    "they are standard and may be obtained from the authors upon request .      in the previous section , we described a numerical procedure for calculating the dynamical polarizability @xmath162 in @xmath207 ) operations .",
    "our implementation of this algorithm contains a number of computational parameters that have to be adjusted properly . for instance , the precision of our lanczos method depends on the dimension of its krylov space . in the examples below ,",
    "a very small krylov dimension @xmath208 gave a polarization @xmath209 with a relative error of @xmath210 .",
    "other computational parameters were carefully cross checked and the results of some of these calculations are given in the figures [ f : dos ] and f : chi0_11 .         in order to test the method as a whole",
    ", we compared our polarizabilities with those computed from casida s equations @xcite with the help of the demon2k package @xcite .",
    "casida s equations allow the determination of excitation energies @xmath211 and corresponding oscillator strengths @xmath212 and provide a dynamical polarizability that is parametrized as @xmath213 we successfully compared results for several small molecules : hydrogen , methane , methane dimer , benzene and diborane .",
    "the results of the two methods for methane are presented in figure [ f : spectrum - methane - demon ] where we see a reasonable agreement . to achieve this agreement we had to discretize the basis orbitals ( contracted gaussians in demon2k ) on our numerical grid and",
    "import them into our code . in all cases ,",
    "our results converge to those of casida when we enlarge our basis of dominant products .",
    "however , a large number of dominant products is needed in order to achieve convergence .",
    "for instance , we had to take about 360 dominant products for methane and more than 1800 for benzene .",
    "this is due to the comparatively large support of the gaussian basis in demon2k .",
    "therefore , in the next example , we used a basis of numerical atomic orbitals which is far more natural for our method .",
    "numerical orbitals of compact support were taken from the siesta package @xcite .",
    "their default support is 4  6 bohr which is about two to three times smaller than the effective limit chosen for the support of demon2k s orbitals .",
    "such a small support still allows to reproduce basic features of electronic excitation spectra .",
    "a basis of larger support would certainly improve the quality of spectra . in the lcao technique , the choice of basis is critical already for the ground state dft calculation , and one must check the basis again for the convergence of spectra of excited states . since this section is about testing our method of computing spectra with our construction of @xmath0 , we make no effort to investigate errors related to the small support of this basis .",
    "there is a substantial reduction in the number of dominant products when using the default siesta orbitals ( of small spatial extent ) .",
    "for instance , figure [ f : spectrum - benzene - siesta ] shows a converged spectrum of benzene in which the basis of dominant products is kept 7 times smaller than original basis of localized products . to judge the completeness of the basis of dominant products and the discretization errors , we provide a reference spectrum , computed with the original products of molecular orbitals @xmath136 @xcite . due to unfavourable scaling behavior ,",
    "such a reference calculation is only possible for sufficiently small molecules like benzene or naphthalene .",
    "in this paper we have given an efficient construction of the kohn ",
    "sham response function for molecular systems . to find @xmath0",
    ", we made use of a previously found basis in the space of orbital products where @xmath0 acts as a frequency dependent matrix .",
    "our construction makes extensive use of fast fourier techniques and it requires @xmath214  operations for @xmath2 atoms on a lattice of @xmath77 frequencies .",
    "two approximations were made : a basis was chosen in the space of orbital products with an error that vanishes exponentially in its size and the electronic spectral densities were discretized .",
    "we tested our construction directly on exact results for @xmath0 and by calculating electronic excitation spectra .",
    "the comparison with the exact but slow representation of @xmath0 showed good accuracy of our construction .",
    "the excitation spectra from the petersilka  gossmann ",
    "gross equations agreed with those of casida s equations .",
    "moreover , an iterative lanczos procedure allowed us to maintain @xmath32 scaling also for electronic excitation spectra . in this approach , the cpu time grows less steeply than in the solution of casida s equations that requires @xmath5 operations .",
    "the scaling of the quantum espresso method remains unpublished , but it is likely to be @xmath21 , according to one of its authors @xcite .",
    "our construction of @xmath0 should have applications to excitons in polymers or organic semiconductors where the coulomb interaction is poorly screened , and for implementing the gw approximation in molecular physics in a straightforward way .",
    "it is also planned to use our algorithm for the spectroscopy of surface adsorbed dyes .",
    "it is a pleasure to thank james talman ( university of western ontario , london ) for contributing two crucial algorithms to this project , for making unpublished computer codes of these algorithms available to us , and for many fruitful discussions .",
    "is grateful to peter fulde for extensive and continued support and for inspiring visits at mpipks , dresden that provided perspective for the present work .",
    "part of the collaboration with james talman was done in the pleasant environment of mpipks .",
    "olivier coulaud of the nossi project and ( inria , bordeaux ) helped with the lanczos algorithm and by reading the manuscript .",
    "our colleagues in this project , ross brown and isabelle baraille ( both at iprem , pau ) , nguyen ky and pierre gay ( both at drimm , bordeaux ) , and alain marbeuf ( cpmoh , bordeaux ) have contributed with many useful discussions .",
    "we thank mark  e.  casida and bhaarathi natarajan ( joseph fourier university , grenoble ) and their colleagues at centro de investigacion , mexico for letting us use their demon2k code and for much help with it .",
    "our special thanks go to mark  e.  casida for his pertinent comments on our manuscript .",
    "this work was financed by the french anr project `` nossi '' ( nouveaux outils pour la simulation de solides et interfaces ) . financial support and encouragement by `` groupement de recherche gdr - dft++ '' is gratefully acknowledged .",
    "m.  rohlfing and s.  g.  louie , phys .",
    "81 * , 2312 ( 1998 ) ; for recent work , see l.  tiago and j.  r.  chelikowsky , phys . rev . *",
    "b 73 * , 205334 ( 2006 ) .",
    "we thank brice arnaud ( university of rennes ) for calling the latter paper to our attention .",
    "w.  kohn , y.  meir , and d.  e.  makarov , phys .",
    "lett . * 80 * , 4153 ( 1998 ) ; for recent work , see for example j.  grfenstein and d.  cremer , j.  chem .  phys . *",
    "130 * , 124105 ( 2009 ) ; j.  toulouse , i.  c.  gerber , g.  jansen , a.  savin , and j.  g.  ngyn , phys .",
    "lett . * 102 * , 096404 ( 2009 ) .",
    "boys  s.  f. , shavitt  i. , university of wisconsin naval research laboratory report wis - af-13 , 1959 ; p.l .",
    "de boeij , in _ time - dependent density functional theory _ , edited by m.  a.  l.  marques , c.  a.  ullrich , f.  nogueira , a.  rubio , k.  burke , e.  k.  u.  gross ( springer , berlin , 2008 ) ; g.  te  velde , f.  m.  bickelhaupt , e.  j.  baerends , c.  fonseca  guerra , s.  j.  a.  van  gisbergen , j.  g.  snijders , t.  ziegler , j.  comput .",
    "* 22 * 931 ( 2001 ) .",
    "d.  foerster , j. chem . phys . * 128 * , 034108 ( 2008 ) . the implementation of the method proposed in this paper has been improved thanks to a new algorithm : j.  d.  talman , int .",
    ".  chem . * 107 * , 1578 ( 2007 ) .",
    "a.  l.  fetter , j.  d.  walecka , _ quantum theory of many - particle systems _ ( mcgraw - hill , new york , 1971 ) ; h.  bruss and k.  flensberg , _ many - body quantum theory in condensed matter physics : an introduction _",
    "( oxford university press , oxford , 2004 ) ; i.  ye .",
    "abrikosov , a.  a.  gorkov , l.  p.  dzyaloshinskii , _ quantum field theoretical methods in statistical physics _",
    "( oxford , pergamon , 1965 ) .                  the grenoble development version of demon2k which is based upon demon2k , version 2.2 , a.  m.  kster , p.  calaminici , m.  e.  casida , r.  flores - moreno , g.  geudtner , a.  goursot , t.  heine , a.  ipatov , f.  janetzko , j.  m.  del  campo , s.  patchovskii , j.  u.  reveles , d.  r.  salahub , a.  vela , the demon developers , cinvestav , mexico ( 2006 ) ; http://dcm.ujf-grenoble.fr/personnel/ct/casida/demonagrenoble .",
    "p.  ordejn , e.  artacho and j.  m.  soler , phys . rev .",
    "* b 53 * , r10441 ( 1996 ) ; j.  m.  soler , e.  artacho , j.  d.  gale , a.  garca , j.  junquera , p.  ordejn , d.  snchez - portal , j. phys .",
    "* c 14 * , 2745 ( 2002 ) .",
    "we used siesta version 2.0.1 in this paper ."
  ],
  "abstract_text": [
    "<S> we construct the kohn  </S>",
    "<S> sham density response function @xmath0 in a previously described basis of the space of orbital products . </S>",
    "<S> the calculational complexity of our construction is @xmath1 for a molecule of @xmath2 atoms and in a spectroscopic window of @xmath3 frequency points . as a first application </S>",
    "<S> , we use @xmath0 to calculate molecular spectra from the petersilka  gossmann  gross equation . with @xmath0 as input , we obtain correct spectra with an extra computational effort that grows also as @xmath4 and , therefore , less steeply in @xmath2 than the @xmath5 complexity of solving casida s equations </S>",
    "<S> . our construction should be useful for the study of excitons in molecular physics and in related areas where @xmath0 is a crucial ingredient . * published in : * d.  foerster and p.  koval , j.  chem .  </S>",
    "<S> phys . * 131 * , 044103 ( 2009).http://link.aip.org / link/?jcp/131/044103`doi : 10.1063/1.3179755 ` ` pacs : 33.20.-t , 31.15.ee ` ` kohn  sham density response , petersilka  gossmann  gross equation , iterative lanczos method ` </S>"
  ]
}