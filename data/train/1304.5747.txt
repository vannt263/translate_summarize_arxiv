{
  "article_text": [
    "this paper develops a semiparametric two - stage estimator of preference parameters in the binary choice model where the agent s decision rule is affected by conditional expectations of outcomes which are uncertain at the choice - making stage and the preference shocks are nonparametrically distributed with unknown form of heteroskedasticity .",
    "the pioneering papers of manski(1991,1993 ) established nonparametric identification of agents expectations in the discrete choice model under uncertainty when the expectations are fulfilled and conditioned only on observable variables . utilizing this result , ahn and manski(1993 ) proposed a two - stage estimator for a binary choice model under uncertainty where agent s utility was linear in parameter and the unobserved preference shock had a known distribution .",
    "specifically , they estimated the agent s expectations nonparametrically in the first stage and then the preference parameters in the second stage by maximum likelihood estimation using the choice data and the expectation estimates .",
    "ahn(1995,1997 ) extended the two - step approach further . on one hand , ahn ( 1995 ) considered nonparametric estimation of conditional choice probabilities in the second stage . on the other hand , ahn ( 1997 ) retained the linear index structure of the ahn - manski model but estimated the preference parameters in the second stage using average derivative method hence allowing for unknown distribution of the unobservable . in principle , alternative approaches accounting for nonparametric unobserved preference shock can also be applied in the second step estimation of this framework .",
    "well known methods include cosslett ( 1983 ) , powell et al.(1989 ) , ichimura ( 1993 ) , klein and spady ( 1993 ) , and coppejans ( 2001 ) , among many others .",
    "the aforementioned papers allow for nonparametric setting of the distribution of the preference shock .",
    "but the unobserved shock is assumed either to be independent of or to have specific dependence structure with the covariates .",
    "by contrast , manski(1975,1985 ) considered a binary choice model under the conditional median restriction and thus allowed for general form of heteroskedasticity for the unobserved shock .",
    "it is particularly important , as shown in brown and walker ( 1989 ) , to account for heteroskedasticity in random utility models .",
    "therefore , this paper develops the semiparametric two - stage estimation method for the ahn - manski model where the second stage is based on manski ( 1975,1985 ) s maximum score estimator and thus can accommodate nonparametric preference shock with unknown form of heteroskedasticity .    from a methodological perspective",
    ", this paper also contributes to the literature on two - stage m - estimation method with non - smooth criterion functions .",
    "when the true parameter value can be formulated as the unique root of certain population moment equations , the problem of m - estimation can be reduced to that of z - estimation .",
    "chen et al.(2003 ) considered semiparametric non - smooth z - estimation problem with estimated nuisance parameter , while allowing for over - identifying restrictions . chen and pouzo ( 2009,2012 ) developed general estimation methods for semiparametric and nonparametric conditional moment models with possibly non - smooth generalized residuals .",
    "for the general m - estimation problem , ichimura and lee ( 2010 ) assumed some degree of second - order expansion of the underlying objective function and established conditions under which one can obtain a @xmath0-consistent estimator of the finite dimensional parameter where @xmath1 is the sample size when the nuisance parameter at the first stage is estimated at a slower rate .",
    "for more recent papers on two - step semiparametric estimation , see ackerberg et al .",
    "( 2012 ) , chen et al .",
    "( 2013 ) , escanciano et al . ( 2012 , 2013 ) , hahn and ridder ( 2013 ) , and mammen et al .",
    "( 2013 ) , among others . none of the aforementioned papers include the maximum score estimation in the second stage estimation .    for this paper ,",
    "the second stage maximum score estimation problem can not be reformulated as a z - estimation problem .",
    "furthermore , even in the absence of nuisance parameter , kim and pollard ( 1990 ) demonstrated that the maximum score estimator can only have the cube root rate of convergence and its asymptotic distribution is non - standard .",
    "the most closely related paper is lee and pun ( 2006 ) who showed that @xmath2 out of @xmath3 bootstrapping can be used to consistently estimate sampling distributions of nonstandard m - estimators with nuisance parameters .",
    "their general framework includes the maximum score estimator as a special case , but allowing for only parametric nuisance parameters .",
    "therefore , established results in the two - stage estimation literature are not immediately applicable and the asymptotic theory developed in this paper may also be of independent interest for non - smooth m - estimation with nonparametrically generated covariates .",
    "the rest of the paper is organized as follows .",
    "section 2 sets up the binary choice model under uncertainty and presents the two - stage maximum score estimation procedure of the preference parameters .",
    "section 3 states regularity assumptions and derives consistency and rate of convergence of the estimator .",
    "in addition , section 3 gives conditions under which the two - stage maximum score estimator is asymptotically equivalent to the infeasible single - stage maximum score estimator with a known first stage input .",
    "section 4 presents monte carlo studies assessing finite sample performance of the estimator .",
    "section 5 gives further applications of maximum score estimation with nonparametrically generated regressors .",
    "section 6 concludes this paper .",
    "proofs of technical results along with some preliminary lemmas are given in the appendices .",
    "suppose an agent must choose between two actions denoted by 0 and 1 .",
    "the utility from choosing action @xmath4 is @xmath5realization of the random vector @xmath6 is known to the agent before the action is chosen and the random vector @xmath7  is realized only after the action is chosen .",
    "random vectors @xmath8 and @xmath9 are not necessarily identical .",
    "distribution of @xmath10 depends on the chosen action and realization of a random vector @xmath11 .",
    "let @xmath12  denote the agent s subjective conditional expectation .",
    "given the realization of @xmath13 , the agent chooses the action @xmath14 that maximizes the expected utility : @xmath15thus the decision rule has the form @xmath16{}^{\\prime } \\beta { } _ { 2}>\\varepsilon \\right\\ } ,   \\label{e1}\\]]where @xmath17 , and @xmath18 is an indicator function whose value is one if the argument is true and zero otherwise .    as in ahn and manski ( 1993 )",
    ", suppose that expectations are fulfilled : @xmath19we assume that the researcher does not observe realization of @xmath20  and @xmath21 , but that of @xmath22 .",
    "let @xmath23 and let @xmath24 , where @xmath25 denotes the support of the distribution of @xmath26 .",
    "then , equation ( [ e1 ] ) can be written as @xmath27where @xmath28 is a vector of unknown preference parameters .",
    "the set of assumptions leading to the binary choice model in ( [ eq ] ) is equivalent to that of ahn and manski ( 1993 , equations ( 1)-(3 ) ) .",
    "note that @xmath29 affects the agent s decision only through @xmath30 , and therefore , @xmath29 and @xmath31 can have common elements , as long as the support of the distribution of @xmath26 is not contained in any proper linear subspace of @xmath32 .    in this paper , we consider an important deviation from ahn and manski ( 1993 ) s setup where the unobserved preference shock @xmath20 is independent of @xmath33 with a known distribution function .",
    "instead , we consider inference under a flexible specification of the unobserved model component . following manski ( 1985 ) , we impose the restriction : @xmath34the conditional median independence assumption in ( [ m ] ) allows for heteroskedasticity of unknown form , and hence , is substantially weaker than the assumption imposed in ahn and manski ( 1993 ) . given ( [ m ] ) , the model ( [ e1 ] ) then satisfies @xmath35    we may consider sufficient conditions for in terms of the original structural errors @xmath36 and @xmath37 . recall that",
    ". suppose that ( i ) the distribution of @xmath39 is the same as that of @xmath40 conditional on @xmath29 and @xmath31 , and ( ii ) the support of this common conditional distribution is @xmath41 .",
    "this type of condition is called conditional exchangeability assumption .",
    "then this implies that @xmath20 is symmetrically distributed around zero , thereby implying equation ( 2.3 ) . for further discussions regarding conditional exchangeability assumption ,",
    "see fox ( 2007 ) in the context of multinomial discrete - choice models and arellano and honor ( 2001 ) for applications in panel data models , among others .",
    "also , note that the conditional exchangeability assumption is a sufficient ( but not necessary ) condition for equation ( [ m ] ) .",
    "let @xmath42 denote the space of preference parameters , and let @xmath43 , @xmath44 , denote the function space of difference of conditional expectations @xmath45 .",
    "moreover , let @xmath46 and @xmath47 , @xmath44 , denote generic elements of @xmath42 and @xmath48 , respectively .",
    "let @xmath49 and @xmath50 be the space of @xmath51 .",
    "we refer to @xmath52 and @xmath30 as the true finite - dimensional and infinite - dimensional parameters .",
    "suppose that data consist of random samples @xmath53 .",
    "we estimate in the first stage the conditional expectations which are not observed .",
    "let @xmath54  denote an estimate of the difference in conditional expectations . using the estimate @xmath55",
    ", we estimate the preference parameters @xmath56 in the second stage  by the method of maximum score estimation of manski ( 1975,1985 ) . for any @xmath57 and @xmath58 ,",
    "define the sample score function@xmath59where @xmath60 is a predetermined weight function to avoid unduly influences from estimated @xmath61 at data points carrying low density .",
    "the two - stage estimator of @xmath56 is now defined as @xmath62    we end this section by commenting on inherent features of the maximum score estimation approach .",
    "the zero conditional median assumption does not require the existence of any error moments and allows heteroskedastic errors of an unknown form . however , the maximum score approach has its drawbacks , mainly due to its weak assumption .",
    "first , in terms of prediction power , it can identify unknown parameters up to scale and also only identify whether the conditional probability of @xmath63 is above or below one half ; hence , the partial effects of covariates are not identified .",
    "second , lack of smoothness in the objective function makes computation of the estimator difficult and lets the estimator converge in probability to the true parameter at a rate of @xmath64 .",
    "let @xmath66 and @xmath67 , respectively , denote the distribution and density of @xmath68 . to simplify the analysis",
    ", we consider fixed trimming such that @xmath69 , where @xmath70 is a predetermined , compact , and convex subset of the support of @xmath29 . for any real vector @xmath57 ,",
    "let @xmath71 denote the euclidean norm of @xmath57 .",
    "for any @xmath72-dimensional vector of functions @xmath73 , let @xmath74 where @xmath75 and @xmath76 denote the @xmath77th component of @xmath78 .",
    "let @xmath79 be the subvector of @xmath31 excluding the first component , say @xmath80 of @xmath31 .",
    "write @xmath81 and @xmath82 .",
    "we assume the following regularity conditions .",
    "[ assumption - consist ] assume that :    * @xmath83 , where @xmath84 is a compact subspace of @xmath85and @xmath86 is an interior point of @xmath84 . *",
    "\\(a ) the support of the distribution of @xmath26 is not contained in any proper linear subspace of @xmath32 .",
    "( b ) @xmath87 for almost every @xmath26 .",
    "( c ) for almost every @xmath88 , the distribution of @xmath80 conditional on @xmath88 has everywhere positive density with respect to lebesgue measure .",
    "* @xmath89 for almost every @xmath33 .",
    "* there is a positive constant @xmath90 such that @xmath91 for all @xmath92 uniformly over @xmath93 .",
    "* @xmath94 .    because the scale of @xmath56 for the model characterized by ( [ e2 ] ) can not be identified ,",
    "assumption c1 imposes scale normalization by requiring that the absolute value of the first coefficient is unity .",
    "assumption c2 implies that @xmath66 is absolutely continuous and has density @xmath67 for each @xmath95 .",
    "assumptions c1 - c3 are standard in the maximum score estimation literature ( see e.g. , manski ( 1985 ) , horowitz ( 1992 ) , and florios and skouras ( 2008 ) ) .",
    "assumption c4 is a mild condition on the distribution of the index variable @xmath68 .",
    "assumption c5 requires uniform consistency of the first stage estimation .",
    "this assumption can be easily verified for standard nonparametric estimators such as series estimators ( newey ( 1997 , theorem 1 ) ) and the kernel regression estimator ( bierens ( 1983 , theorem 1 ) , bierens ( 1987 , theorem 2.3.1 ) and andrews ( 1995 , theorem 1 ) ) .    given these regularity conditions , we have the following result .",
    "[ thm - consist ] let assumption [ assumption - consist ] ( * c1 * - * c5 * ) hold .",
    "then the two - stage estimator given by ( [ beta_hat ] ) converges to @xmath56 in probability as @xmath96 .",
    "in addition to consistency , we also study rate of convergence of the estimator @xmath97 . let @xmath98 @xmath99 and @xmath100 .",
    "let @xmath101 and @xmath102 denote the density function of @xmath103 conditional on @xmath88 .",
    "let @xmath104 denote the partial derivative of @xmath105 with respect to @xmath80 .",
    "define the following matrix@xmath106 .\\ ] ]    since the objective function of ( [ score ] ) is non - smooth , we require the nonparametric parameter of the estimation problem should possess certain degree of smoothness to facilitate derivation of the rate of convergence result .",
    "in particular , we consider the following well known class of smooth functions ( see , e.g. , van der vaart and wellner ( 1996 , section 2.7.1 ) ) : for @xmath107 , let @xmath108 denote the class of functions @xmath109:@xmath110 with @xmath111 where for any @xmath112 dimensional vector of non - negative integers @xmath113,@xmath114where @xmath115 , denotes the greatest integer smaller than @xmath116 , and @xmath117 is the differential operator @xmath118given the norm @xmath119 , for any @xmath72-dimensional vector of functions @xmath73 , let @xmath120 where @xmath121 denote the @xmath77th component of @xmath78 .",
    "note that @xmath122 is a stronger norm than @xmath123 used in condition c5 for the uniform consistency of the first stage estimator .",
    "the regularity conditions imposed for the convergence rate result are stated as follows .",
    "[ assumption - rate]assume that :    * the support of @xmath79 is bounded .",
    "* there is a positive constant @xmath124 such that ( i ) for every @xmath80 and for almost every @xmath125 , @xmath126and ( ii ) for non - negative integers @xmath127 and @xmath77 satisfying @xmath128 , @xmath129for every @xmath130 and @xmath80 and for almost every @xmath125 .",
    "* all elements of the vector @xmath131 have finite third absolute moments . *",
    "the matrix @xmath132 is positive definite .",
    "* for each @xmath44 , @xmath133 for some @xmath134 and @xmath135 .",
    "* @xmath136 where @xmath137  is a non - stochastic positive real sequence such that @xmath138 for each @xmath1 .",
    "assumption c6 is standard in deriving asymptotic properties of manski s maximum score estimator ( see , e.g. kim and pollard ( 1990 ) , pp.213 - 216 ) .",
    "assumption c7 requires some smoothness of the density @xmath139 and the distribution @xmath140 .",
    "assumption c8 is mild .",
    "since @xmath141 corresponds to the second order derivative of @xmath142 $ ] with respect to @xmath143 evaluated at true parameter values , assumption c9 is analogous to the classic condition of hessian matrix being non - singular in the m - estimation framework .",
    "assumption c10 imposes smoothness for the nonparametric parameter @xmath51 and hence helps to control complexity of the space @xmath144 .",
    "the requirement @xmath145 is in line with the literature of two - stage semiparametric estimation with non - smooth objective functions ( see , e.g. , chen et.al.(2003 , example 2 , pp.1601 - 1603 ) and ichimura and lee ( 2010 , section 4.1 , pp.258 - 259 ) ) .",
    "assumption c11 requires that the first stage estimator should converge under the norm @xmath146 at a rate no slower than @xmath64 .",
    "note that convergence of @xmath55 to @xmath147 in the norm @xmath146 also implies uniform convergence of derivatives of @xmath55 to those of @xmath147 .",
    "for integer - valued @xmath148 , assumption c11 is fulfilled provided that for vector of non - negative integers @xmath149 that satisfies @xmath150 , @xmath151where @xmath152 denotes the estimate of @xmath153 for @xmath154 .",
    "the condition ( [ der ] ) can also be verified for series estimators ( newey ( 1997 , theorem 1 ) ) and the kernel regression estimator ( andrews ( 1995 , theorem 1 ) ) .",
    "[ thm - rate]in addition to assumption [ assumption - consist ] ( * c1 * - * c5 * ) , let assumption [ assumption - rate ] ( * c6 * - * c11 * ) also hold",
    ". then @xmath155 .",
    "if @xmath147 were priorly known to the researcher , the preference parameters @xmath156 could be estimated by the single stage maximum score estimator @xmath157 , defined as @xmath158kim and pollard(1990 ) showed that @xmath159 converges to @xmath56 at cube root rate and established its asymptotic distribution . in the case of unknown @xmath147 , theorem [ thm - rate ] implies that the two - stage estimator @xmath97 retains the same convergence rate as the infeasible estimator @xmath159 . indeed",
    "if condition c11 is strengthened for faster convergence of first stage estimates , we can establish the oracle property that @xmath160 and @xmath161 have the same limiting distribution .",
    "therefore , the inference on @xmath56 can be carried out by subsampling ( delgado et al.(2001 ) ) since the standard bootstrap can not be used to estimate the distribution of the maximum score estimator consistently ( abrevaya and huang ( 2005 ) ) .",
    "we now state the asymptotic distributional equivalence result in the next theorem .",
    "[ thm - distribution]suppose all assumptions stated in theorem thm - rate hold with the additional restriction that the sequence @xmath162 stated in * c11 * further satisfies @xmath163 .",
    "then @xmath160 is asymptotically equivalent in distribution to @xmath164 .",
    "we employ the following data generating process ( dgp ) in simulation study of the two - stage maximum score estimator:@xmath165where @xmath166 , @xmath167 , @xmath168 and @xmath169 with @xmath170",
    ". the scalar random variable @xmath10 is generated according to @xmath171where @xmath172 are independent of @xmath173 and are jointly normally distributed with @xmath174 , @xmath175 , and @xmath176 . given ( [ y ] ) ,  @xmath177we consider the following two types of the @xmath178 function:@xmath179the true parameter values are specified as follows : @xmath180 , @xmath181 , @xmath182 , @xmath183 , @xmath184 , @xmath185 , @xmath186 , and @xmath187 .    we compare infeasible single - stage estimator using @xmath188 as regressors and also the feasible two - stage estimator using @xmath189 as regressors .",
    "we consider both parametric and nonparametric first stage estimators .",
    "for the former , we estimate @xmath21 by running ols of @xmath10 on @xmath29 with an intercept term using @xmath190 subsamples . for the latter , we implement nadaraya - watson kernel regression estimators .",
    "the nonparametric estimators of @xmath21 , @xmath4 are constructed as @xmath191where @xmath192 is the estimated standard deviation of @xmath193 conditional on @xmath194 , @xmath195 is a univariate kernel function and @xmath196 is a deterministic bandwidth sequence .",
    "we use two types of kernel and bandwidth configurations .    for the first type , we use the second - order gaussian kernel and set @xmath196 to be @xmath197 for various values of the bandwidth scale @xmath198 . for the second type ,",
    "we use the following 8th order kernel function ( see , e.g. , bierens ( 1987 , p. 112 ) and andrews ( 1995 , p.567 ) ) : @xmath199 ,   \\label{k}\\]]where the constants @xmath200 @xmath201 satisfy @xmath202we specify @xmath203 and then solve @xmath204 as solution of the system of linear equations ( [ ab ] ) . associated with this kernel , the bandwidth @xmath205 is set to be @xmath206 for various values of the scale @xmath198 . for the kernel function is less crucial since its effect on asymptotic variance of the conditional mean estimator can be captured via the bandwidth scale @xmath198 . ] by theorem 1(b ) of andrews ( 1995 ) , kernel regression estimator of @xmath30 based on the second type configuration has convergence property required in ( [ der ] ) with @xmath207 and @xmath208 , thus fulfilling regularity conditions c5 and c11 of section [ main results ] . the first stage estimation with the second - order kernels satisfies condition c5 but may not satisfy c11 ; however , we experiment with the second - order kernels as well since kernel estimates with the second - order kernels often outperform those with the higher - order kernels in small samples .    to implement the second - stage estimator using nonparametric first stage estimators , we trim the data by setting @xmath209 where @xmath210 is the weight introduced in ( [ score ] ) . the estimates of @xmath211 and @xmath212 are obtained using grid search method .  we report simulation results of @xmath213 for the parameter capturing the agent s uncertainty .",
    "let @xmath214 , @xmath215 , @xmath216 and @xmath217 respectively denote the estimators @xmath218 that are constructed based on the infeasible single - stage , two - stage ( ols first stage ) and two - stage ( kernel regression first stage implemented with the 2nd and 8th order kernels ) maximum score estimators .",
    "we compute bias , median , root mean squared error ( rmse ) , mean absolute deviation ( mean ad ) and median absolute deviation ( median ad ) of these estimators based on 1000 simulation repetitions for sample size @xmath219 .",
    "tables 1 - 6 present simulation results for the four types of estimators of @xmath220 under linear and nonlinear designs of the @xmath30 function . tables 7 and 8 graph the simulated empirical distribution functions ( edf ) for @xmath221 , @xmath222 , @xmath223 and @xmath224 .",
    "as expected , for linear setup of @xmath147 the estimator @xmath215 enjoys the best overall finite - sample performance among all two - stage estimators .",
    "however , this estimator also incurs huge bias when agent s conditional expectation is nonlinear . for the estimators @xmath225 and @xmath226 , the function @xmath147 is nonparametrically estimated at the first stage .",
    "hence regardless of nonlinearity of @xmath147 , we see that the simulated bias , rmse , mean ad and median ad of these estimators generally decrease as sample size grows .",
    "we note that the edf curves of tables 7 and 8 for the ( kernel first - stage ) two - stage estimators broadly match shapes of those for the infeasible estimators .",
    "interestingly , finite sample behavior of the estimator @xmath227 fits that of @xmath228 better than its counterpart implemented with the 8th order kernel .",
    "use of higher order kernels allows for verification of convergence of @xmath229 to @xmath147 in the strong norm @xmath146 .",
    "however , as well known in the literature , the estimates with the higher - order kernels seem to perform poorly in simulations relative to those with the second - order kernels .",
    "the superb performance of @xmath216 suggests that the asymptotic distributional equivalence result in theorem 3 may not give us sharp asymptotics and there is scope to develop further asymptotic theory .",
    "this is an interesting future research topic .",
    "our paper has been motivated by estimation problem in the binary choice model under uncertainty . however , the resulting estimator has wider applicability than just this model . to further motivate our two - step estimation procedure",
    ", this section gives a couple of additional econometric models for which unknown parameters can be estimated by maximum score with nonparametrically generated regressors .    we first consider maximum score estimation of an incomplete information games .",
    "aradillas - lopez ( 2012 ) developed a two - step procedure for estimation of incomplete information games with nash equilibrium behavior .",
    "equation ( 2 ) of aradillas - lopez ( 2012 , p.123 ) gives a description of players behavior in a @xmath230 game : @xmath231-\\zeta _ { 1}\\geq 0\\ } , \\\\",
    "y_{2 } & = 1\\{x_{2}^{\\prime } \\beta _ { 2}+\\delta _ { 2}\\text{pr}[y_{1}=1|x]-\\zeta _ { 2}\\geq",
    "0\\},\\end{aligned}\\]]where @xmath232 is the binary action for player @xmath233 , @xmath234 and @xmath235 are observable and unobservable payoff covariates , @xmath236 , and @xmath237 are unknown parameters .    aradillas - lopez ( 2012 , assumption a0 , p.122 ) assumed that players behavior corresponds to a bayesian - nash equilibrium with a degenerate selection mechanism .",
    "he further assumed that @xmath238 and @xmath239 are independent of each other , independent of @xmath240 , and of the selection mechanism .",
    "we can make the same assumptions as in aradillas - lopez ( 2012 ) , with one exception .",
    "as in the previous section , we consider @xmath241 almost surely , instead of assuming the full independence between @xmath242 and @xmath240 , where @xmath233 . allowing for dependence between @xmath243 and @xmath240 might be important in applications when we suspect possible interactions between observed covariates and unobserved components that affect players payoffs . then for each @xmath233 , we can estimate @xmath244 by running maximum score regression of @xmath245 on @xmath234 and @xmath246 $ ] with the nonparametric first stage estimation of @xmath247 .",
    "therefore , methodology of the present paper can be applied to extension of aradillas - lopez ( 2012 ) s context allowing unobserved payoffs to exhibit unknown form of heteroskedasticity .",
    "our second application , which is based on fox ( 2007 ) , is maximum score estimation of multinomial discrete - choice models using a subset of choices under endogeneity . fox ( 2007 )",
    "proposed pairwise maximum score estimation of multinomial discrete - choice models using a subset of choices . for simplicity , assume that a researcher has data on only two choice , say @xmath248 and @xmath249 , among @xmath250 alternatives , and also assume that there exists an endogenous covariate . fox ( 2007 , p.1013 ) solved the endogeneity problem by including , instead of the endogenous covariate , fitted values from the ols regression of the endogenous covariate , say price , on a vector of instruments .",
    "we can extend fox ( 2007 ) to allow for nonparametric fitted values .",
    "then this extension again can be accommodated in the framework of maximum score estimation with nonparametrically generated regressors .",
    "this paper has developed maximum score estimation of preference parameters in the binary choice model under uncertainty in which the decision rule is affected by conditional expectations .",
    "the estimation procedure is implemented in two stages : we estimate conditional expectations nonparametrically in the first stage and obtain the maximum score estimate of the preference parameters in the second stage using choice data and the first stage estimates .",
    "the paper has shown consistency and convergence rate of the two - stage maximum score estimator . moreover",
    ", we also establish the oracle property in terms of asymptotic equivalence in distribution of the two - stage estimator and its corresponding infeasible single - stage version .",
    "these results are of independent interest for maximum score estimation with nonparametrically generated regressors .",
    "it would be an alternative approach to develop the second stage estimator using horowitz ( 1992 ) s smoothed maximum score estimator or using a laplace estimator proposed in jun , pinkse , and wan ( 2013 ) .",
    "these alternative methods would produce faster convergence rates but require extra tuning parameters .",
    "alternatively , we might build the second stage estimator based on lewbel ( 2000 ) , who introduced the idea of a special regressor satisfying certain conditional independence restriction .",
    "these are interesting future research topics .",
    "recall that @xmath251 and @xmath252 is the sample score function defined by ( [ score ] ) .",
    "we first state and prove a preliminary lemma that will be invoked in proving theorem [ thm - consist ] of the paper .",
    "[ l1 ] under assumptions c1 , c4 and c5 , @xmath253    note that @xmath254by assumption c1 , @xmath255 for some finite positive constant @xmath256 .",
    "therefore , the right - hand side of the inequality ( [ s ] ) is bounded above by@xmath257where @xmath258 denotes the empirical probability .",
    "note that the term ( [ b ] ) is further bounded above by@xmath259let @xmath260 denote the event @xmath261 for some @xmath262 .",
    "then given @xmath263,@xmath264 + p(e^c_{\\eta } ) .\\end{aligned}\\]]by assumption c5 , @xmath265 as @xmath266 .",
    "hence , to show ( [ s1 ] ) , it remains to establish that as @xmath267,@xmath268 \\longrightarrow 0 .",
    "\\label{delta}\\]]note that by assumption c4 , @xmath269 .",
    "therefore , we have that @xmath270   \\notag \\\\ & \\leq & p \\left [ \\sup\\nolimits_{b\\in \\theta } \\left\\vert p_{n}\\left ( b_{2}\\eta \\geq \\left\\vert w^{\\prime } b\\right\\vert \\right ) -p\\left ( b_{2}\\eta \\geq \\left\\vert w^{\\prime } b\\right\\vert \\right ) \\right\\vert > \\epsilon -2lb_{2}\\eta \\right ] ,   \\label{s2}\\end{aligned}\\]]where @xmath271 is taken to be sufficiently small such that @xmath272 for the given @xmath273 . by lemma 9.6 , 9.7 ( ii ) and 9.12 ( i ) of kosorok ( 2008 ) , the family of sets @xmath274 for @xmath275 forms a vapnik - ervonenkis class .",
    "therefore , by glivenko - cantelli theorem ( see , e.g. theorem 2.4.3 of van der vaart and wellner ( 1996 ) ) , the right - hand side of ( [ s2 ] ) tends to zero as @xmath96 .",
    "hence , the convergence result in ( [ delta ] ) holds and lemma [ l1 ] thus follows .",
    "we now prove theorem [ thm - consist ] for consistency of @xmath97 .    for any @xmath276 ,",
    "define @xmath277 .\\]]given assumptions c1 - c3 and by manski ( 1985 , lemma 3 , p.321 ) , @xmath156 uniquely satisfies @xmath278 .",
    "we now look at the difference@xmath279where by lemma [ l1 ] , the first term of the right - hand side of ( [ d ] ) converges to zero in probability uniformly over @xmath275 , whilst by manski ( 1985 , lemma 4 , p.321 ) , the second term converges to zero almost surely uniformly over @xmath275 .",
    "therefore , we have that @xmath280by lemma 5 of manski ( 1985 , p.322 ) , @xmath281 is continuous in @xmath57 . given these results , theorem 1 thus follows by application of the consistency theorem in newey and mcfadden ( 1994 , theorem 2.1 ) .",
    "we first present and prove a general lemma establishing the rates of convergence of a general two - stage m - estimator under high level assumptions . in next section ,",
    "we prove theorem [ assumption - rate ] by verifying these assumptions for the particular estimator given by ( [ beta_hat ] ) under the regularity conditions of c1 - c11 .    to present a general result , let @xmath282 be measurable functions indexed by parameters @xmath283 .",
    "let @xmath42 and @xmath284 be the space of parameters @xmath285 and @xmath78 , respectively .",
    "let @xmath286 denote the true parameter value .",
    "we assume @xmath287 .",
    "let @xmath288 be the empirical criterion of the m - estimation problem where @xmath289 are i.i.d .",
    "random vectors . suppressing the individual index ,",
    "let @xmath290 $ ] be the population criterion . for a given first stage estimate @xmath291 ,",
    "let the estimator @xmath292 be constructed as @xmath293    let @xmath294 and @xmath295 be non - negative functions measuring discrepancies between @xmath285 and @xmath296 , and @xmath78 and @xmath297 , respectively .",
    "note that @xmath298 and @xmath299 are usually related to but not necessarily the same as the metrics specified for the spaces @xmath42 and @xmath284 . given a non - stochastic positive real sequence @xmath137 ,",
    "define @xmath300 . to simplify the presentation",
    ", we use the notation @xmath301 to denote being bounded above up to a universal constant .",
    "define the recentered criterion @xmath302the following lemma modifies the rate of convergence results developed by van der vaart ( 1998 , theorem 5.55 ) and provides sufficient conditions ensuring that @xmath292 retains the same convergence rate as it would have if @xmath297 were known .",
    "[ rate of convergence lemma ] for any fixed and sufficiently large @xmath303 , assume that for all sufficiently large @xmath1 , @xmath304and there is a sequence of non - stochastic functions @xmath305 such that for all sufficiently small @xmath306 and for every @xmath307 satisfying @xmath308 , @xmath309and @xmath310 \\lesssim \\frac{\\phi _ { n}(\\delta ) } { \\sqrt{n } } , \\label{maximal inequality}\\]]where @xmath311 is a sequence of functions defined on @xmath312 and satisfies that @xmath313 is decreasing for some @xmath314 .",
    "suppose @xmath315 , @xmath316 and there is a non - stochastic positive real sequence @xmath317 which tends to zero as @xmath96 and satisfies that @xmath318 and @xmath319 for every @xmath1",
    ". then @xmath320 .    based on the peeling technique of van der vaart ( 1998 , theorem 5.55 ) , for each natural number @xmath1",
    ", integer @xmath77 and positive real @xmath321 , construct the set @xmath322then we have that for any @xmath263,@xmath323 \\geq 0\\right )   \\label{b5_2}\\end{aligned}\\]]where the last inequality follows from the definition of @xmath292 given by ( [ thetahat ] ) .",
    "since @xmath324 , the term @xmath325 tends to zero as @xmath96 .",
    "hence the remaining part of the proof is to bound the terms in the sum ( [ b5_2 ] ) .",
    "let @xmath1 be large enough such that holds and choose @xmath326 to be small enough such that assumptions ( [ quadratic expansion ] ) , ( [ inequality 1 ] ) and ( [ maximal inequality ] ) hold for every @xmath327 .",
    "note that for every sufficiently large @xmath321 , if @xmath328 , then @xmath329 so that by ( [ quadratic",
    "expansion]),@xmath330and thus @xmath331 -\\delta _ { n}^{2}2^{2j}.\\]]therefore , by markov inequality , each term in the sum ( [ b5_2 ] ) can be bounded above by @xmath332 .",
    "\\label{b3}\\]]by ( [ inequality 2 ] ) , ( [ inequality 1 ] ) , ( [ maximal inequality ] ) and applying triangular inequality , the term ( [ b3 ] ) is bounded above by@xmath333 .",
    "\\label{b4}\\]]by the monotonicity property of the mapping @xmath334 , we have that @xmath335 . furthermore , since @xmath336 , the first term in the bracket of ( b4 )",
    "can thus be bounded by @xmath337 . given that @xmath318 , the term ( [ b4 ] ) can be further bounded above by @xmath338 .",
    "using this fact and the condition @xmath314 , it follows that the sum ( [ b5_2 ] ) tends to zero as @xmath339 .    since @xmath340",
    ", @xmath341 can be made arbitrarily close to @xmath248 by choosing a sufficiently large value of @xmath342 for every sufficiently large @xmath1 .",
    "therefore , lemma [ rate of convergence lemma ] follows by putting together all these results and noting that @xmath343 .",
    "to establish the convergence rate of @xmath97 , we apply lemma rate of convergence lemma by setting @xmath345 , @xmath346 , @xmath83 , @xmath347 , @xmath348 and @xmath349assumptions ( [ inequality 2 ] ) , ( [ quadratic expansion ] ) , ( inequality 1 ) and ( [ maximal inequality ] ) of lemma [ rate of convergence lemma ] are non - trivial and will be verified using primitive conditions c1 - c11 of the model . assumption ( [ quadratic expansion ] ) is concerned with the quadratic expansion of @xmath350 around @xmath351 by which we obtain the functional form of @xmath352 . recall that @xmath251 , @xmath353 , @xmath354 , @xmath355 , @xmath356 , @xmath357 and @xmath358 .",
    "the following lemma will be used to establish expansion of the population criterion @xmath350 .",
    "[ lemma for sign of partial derivative]under conditions c3 and c7 , the sign of @xmath359 is the same as that of @xmath360 for almost every @xmath361 .",
    "note that the model ( [ eq ] ) implies that@xmath362thus , by c7(ii ) , @xmath105 is differentiable with respect to @xmath80 and @xmath363consider the mapping @xmath364 . by c3 , @xmath365 for almost every @xmath366 .",
    "therefore , lemma [ lemma for sign of partial derivative ] follows from this fact and the monotonicity of @xmath367 in the argument @xmath130 .    by assumption c1 ,",
    "the space of the coefficient @xmath368 is @xmath369 and thus @xmath370 when @xmath371 for @xmath372 small enough .",
    "let @xmath373 @xmath374 and @xmath375 .",
    "\\label{s1}\\]]we now derive the quadratic expansion of @xmath376 around @xmath377 .",
    "[ quadratic expansion of s(b , r)]for sufficiently small @xmath378 and @xmath379 and under conditions c3 , c7 , c8 and c9 , we have that @xmath380and there are constants @xmath381 and @xmath382 such that @xmath383for some function @xmath384 that satisfies @xmath385    we prove lemma [ quadratic expansion of s(b , r ) ] explicitly for the case @xmath386 . proof for the case @xmath387 can be done by similar arguments .",
    "suppose now @xmath388 .",
    "then@xmath389 \\right ) .\\end{aligned}\\]]let @xmath390the first - order and second - order derivatives of @xmath391 are derived as follows:@xmath392 \\right\\ } \\\\ & & + e\\left ( 2\\tau \\left [ \\left ( 2p(-\\lambda ( t),\\widetilde{z},x)-1\\right ) % \\right ] g_{1}(-\\lambda ( t)|\\widetilde{z},x)(\\gamma ( x)-g(x))^{\\prime } ( b_{2}-\\beta _ { 2})\\right ) .\\end{aligned}\\]]then the second order expansion of @xmath393 takes the form @xmath394where by c7 and c8 , the remainder term has the stated order uniformly over @xmath395 and @xmath51 . given assumption c3 , it follows that @xmath396 for almost every @xmath397 .",
    "let @xmath398then we have that @xmath399where @xmath400under condition c9 , @xmath401 is positive definite , so that @xmath402 for some positive real constant @xmath403 . by lemma [ lemma for sign of partial derivative ] ,",
    "@xmath404 and thus @xmath405 . by cauchy - schwarz inequality , @xmath406 , where @xmath407 , and the function @xmath408 satisfies",
    "that@xmath409hence lemma [ quadratic expansion of s(b , r ) ] follows by noting that when @xmath410 and @xmath411 are sufficiently small , @xmath412and @xmath413    we now verify assumption ( [ maximal inequality ] ) of lemma [ rate of convergence lemma ] .",
    "note that for @xmath372 sufficiently small , assumption c1 implies that @xmath370 when @xmath414 .",
    "therefore we can focus on analyzing ( [ maximal inequality ] ) for the case of @xmath370 and @xmath415 . for any @xmath416 ,",
    "consider the following recentered function @xmath417 \\label{recentered m(b , r)}\\]]and the class of functions@xmath418let @xmath419 denote the @xmath420 norm such that @xmath421 ^{1/r}$ ] for any measurable function @xmath422 .",
    "for any @xmath263 , let @xmath423}(\\epsilon , \\digamma , l_{r}(p))$ ] denote the @xmath420 - bracketing number for a given function space @xmath424 .",
    "namely , @xmath423}(\\epsilon , \\digamma , l_{r}(p))$ ] is the minimum number of @xmath420 - brackets of length @xmath425 required to cover @xmath424 ( see e.g. , van der vaart ( 1998 , p.270 ) ) .",
    "the logarithm of bracketing number for @xmath426 is referred to as the bracketing entropy for @xmath426 .",
    "assumption ( [ maximal inequality ] ) is a stochastic equicontinuity condition concerning the complexity of the function space @xmath427 in terms of its envelope function and bracketing entropy .",
    "let @xmath428 denote an envelope for @xmath427 such that @xmath429 @xmath430 for all @xmath431 and for all @xmath432 .",
    "the next lemma derives the envelope function @xmath428 .",
    "[ envelope]let @xmath372 and @xmath20 be sufficiently small .",
    "then under conditions c1 , c4 , c6 and c10 , for some real constants @xmath433 and @xmath434 , we can take @xmath435and furthermore , @xmath436    note that@xmath437under condition c6 , there is a positive real constant @xmath438 such that @xmath439 with probability 1 .",
    "hence if @xmath440 and @xmath441 , then we have that@xmath442 \\geq 0 \\\\ & \\longrightarrow & \\delta \\left [ \\left\\vert \\widetilde{z}\\right\\vert _ { e}+\\left\\vert \\gamma \\right\\vert _ { \\infty } \\right ] \\geq -\\left [ z^{\\prime } \\beta { } _ { 1}+\\gamma ( x){}^{\\prime } \\beta _ { 2}\\right ] \\text { and } 0\\geq w^{\\prime } \\beta { } + ( \\gamma ( x)-g(x)){}^{\\prime } \\beta _ { 2 } \\\\ & \\longrightarrow & w^{\\prime } \\beta + ( \\gamma ( x)-g(x{}))^{\\prime } \\beta _ { 2}\\geq -\\delta \\left [ \\left\\vert \\widetilde{z}\\right\\vert _ { e}+\\varepsilon + \\left\\vert g\\right\\vert _ { \\infty } \\right ] \\text { and } \\varepsilon \\left\\vert \\beta _ { 2}\\right\\vert _ { e}\\geq w^{\\prime } \\beta { } \\\\ & \\longrightarrow & \\delta \\left [ b+\\varepsilon + \\left\\vert g\\right\\vert _ { \\infty } \\right ] + \\varepsilon \\left\\vert \\beta _ { 2}\\right\\vert _ { e}\\geq w^{\\prime } \\beta \\geq -\\delta \\left [ b+\\varepsilon + \\left\\vert g\\right\\vert",
    "_ { \\infty } \\right ] -\\varepsilon \\left\\vert \\beta",
    "_ { 2}\\right\\vert _ { e}\\end{aligned}\\]]based on similar arguments , it also follows that @xmath443 + \\varepsilon \\left\\vert \\beta _ { 2}\\right\\vert _ { e}\\geq w^{\\prime } \\beta \\geq -\\delta \\left [ b+\\varepsilon + \\left\\vert g\\right\\vert _ { \\infty } \\right ] -\\varepsilon \\left\\vert \\beta _",
    "{ 2}\\right\\vert _ { e}\\end{aligned}\\]]therefore , lemma [ envelope ] follows by noting that for @xmath20 sufficiently small ( e.g. , @xmath444 ) , we can take @xmath435where @xmath445 . by c1 and c10 , @xmath446 and hence by c4 , @xmath447 with @xmath448 where @xmath449 is the positive constant stated in condition c4 .",
    "the following lemma establishes the bound for the bracketing entropy for @xmath450 .",
    "[ entropy bound]given conditions c1 , c4 , c6 , c7 , c8 and c10 , we have that for sufficiently small @xmath372 and @xmath20 , @xmath451}(\\epsilon , \\digamma _ { \\delta , \\varepsilon } ,",
    "l_{2}(p))\\lesssim ( \\max \\{\\delta , \\varepsilon \\})^{q/\\alpha } \\epsilon ^{-2q/\\alpha } .\\ ] ]    for @xmath44 , let @xmath452 and @xmath453 be classes of functions defined as@xmath454assumption c10 implies that both @xmath452 and @xmath455 are @xmath456 .",
    "by corollary 2.7.2 of van der vaart and wellner ( 1996 , p.157 ) , we have that for @xmath44 , @xmath451}(\\epsilon ^{2},\\widetilde{\\lambda } _ { j}(\\varepsilon ) , l_{1}(p))\\lesssim \\epsilon ^{-2q/\\alpha } \\text { and } \\log n_{[]}(\\epsilon ^{2},\\widetilde{\\lambda } _ { j}\\mathbf{b}_{j}(\\delta , \\varepsilon ) , l_{1}(p))\\lesssim \\epsilon ^{-2q/\\alpha } . \\label{entropy bound c(alpha,1)}\\ ] ]    note that for @xmath457 , @xmath458 defined by ( [ recentered m(b , r ) ] ) can be rewritten as @xmath459 + \\tau ( 1-d)\\left [ 1\\{h(s;% \\widetilde{b})\\leq 0\\}-1\\{h(s;\\widetilde{\\beta } ) \\leq 0\\}\\right]\\]]where @xmath460consider the following spaces:@xmath461let @xmath462}(\\epsilon , \\theta _ { i},l_{1}(p))$ ] for @xmath463 and @xmath464}(\\epsilon , \\theta _ { k , j},l_{1}(p))$ ] for @xmath465 .",
    "let @xmath466.@xmath467    since @xmath468 is a pointwise lipschitz class of functions with envelope @xmath469 . by condition c8",
    ", @xmath470 is finite . thus applying theorem 2.7.11 of van der vaart and wellner ( 1996 , p.164 )",
    ", we have that@xmath471note that for any norm @xmath472 , any fixed real valued @xmath198 , any class of functions @xmath426 , it is straightforward to verify that @xmath473}(\\epsilon , c\\digamma , \\left\\vert \\cdot \\right\\vert ) = 1\\text { for } c=0 \\notag \\\\ & & n_{[]}(\\epsilon , c\\digamma , \\left\\vert \\cdot \\right\\vert ) \\leq n_{[]}(\\epsilon /\\left\\vert",
    "c\\right\\vert , \\digamma , \\left\\vert \\cdot \\right\\vert ) \\text { for } c\\neq 0   \\notag\\end{aligned}\\]]where @xmath474 .",
    "using this fact , we have that @xmath475}(\\epsilon ^{2}/(\\varepsilon \\delta ) , \\widetilde{\\lambda } _ { j}\\mathbf{b}_{j}(\\delta , \\varepsilon ) , l_{1}(p))$ ] and @xmath476 for @xmath477 and @xmath478}(\\epsilon ^{2}/(\\varepsilon \\left\\vert \\beta _ { 2,j}\\right\\vert ) , \\widetilde{\\lambda } _ { j}(\\varepsilon ) , l_{1}(p))$ ] for @xmath479 .",
    "hence for sufficiently small @xmath372 and @xmath20 ( e.g. , @xmath480 and @xmath444 ) and by ( entropy bound c(alpha,1 ) ) , it follows that @xmath481}(\\epsilon ^{2}\\psi ^{-2},\\widetilde{% \\lambda } _ { j}\\mathbf{b}_{j}(\\delta , \\varepsilon ) , l_{1}(p))\\lesssim \\psi ^{2q/\\alpha } \\epsilon ^{-2q/\\alpha } .\\]]using similar arguments , we can also deduce that @xmath482 .    by preservation of bracketing metric entropy ( see , e.g. , lemma 9.25 of kosorok ( 2008 , p.169 ) )",
    ", we have that for @xmath483 , @xmath484and @xmath485 .",
    "therefore by the bounds derived above , it follows that @xmath486 , @xmath487 and also @xmath488 .",
    "now let @xmath489}(\\epsilon ^{2},\\theta _ { 3},l_{1}(p))}^{l}\\leq f_{n_{[]}(\\epsilon ^{2},\\theta _ { 3},l_{1}(p))}^{u}$ ] and @xmath490}(\\epsilon ^{2},\\theta _ { 4},l_{1}(p))}^{l}\\leq g_{n_{[]}(\\epsilon ^{2},\\theta _ { 4},l_{1}(p))}^{u}$ ] be the @xmath491-brackets with bracket length defined by @xmath492 for the spaces @xmath493 and @xmath494 , respectively . for @xmath495}(\\epsilon ^{2},\\theta",
    "_ { 3},l_{1}(p))$ ] and @xmath496}(\\epsilon ^{2},\\theta _ { 4},l_{1}(p))$ ] , define@xmath497 \\\\ & & + \\tau ( 1-d)\\left [ 1\\{w^{\\prime } \\beta + g_{j}^{u}(z , x)\\leq 0\\}-1\\{w^{\\prime } \\beta + f_{k}^{l}(z , x){}\\leq 0\\}\\right ] , \\\\ m_{jk}^{u}(\\tau , d , z , x ) & \\equiv & \\tau d\\left [ 1\\{w^{\\prime } \\beta + g_{j}^{u}(z , x)>0\\}-1\\{w^{\\prime } \\beta + f_{k}^{l}(z , x){}>0\\}\\right ] \\\\ & & + \\tau ( 1-d)\\left [ 1\\{w^{\\prime } \\beta + g_{j}^{l}(z , x)\\leq 0\\}-1\\{w^{\\prime } \\beta + f_{k}^{u}(z , x){}\\leq 0\\}\\right ] .\\end{aligned}\\]]note",
    "that@xmath498 \\text{.}\\]]thus@xmath499by condition c1 and given @xmath88 , the mapping @xmath500 is one - to - one .",
    "hence by condition c7 , the density of @xmath501 conditional on @xmath88 is bounded and by ( m_bound ) , it then follows that @xmath502 .",
    "moreover for each @xmath503 , there is a bracket @xmath504 $ ] in which it lies .",
    "therefore , @xmath451}(\\epsilon , \\digamma _",
    "{ \\delta , \\varepsilon _ { n}},l_{2}(p))\\lesssim n_{3}(\\epsilon ^{2})+n_{4}(\\epsilon ^{2})\\lesssim \\psi ^{2q/\\alpha } \\epsilon ^{-2q/\\alpha } \\text{.}\\ ] ]    replacing @xmath283 and @xmath505 with @xmath506 and @xmath507 , respectively in the definition of @xmath508 given by ( recentered criterion ) , we now verify assumption ( [ maximal inequality ] ) in the next lemma .",
    "[ verify maximal inequality]for sufficiently small @xmath372 and @xmath509 , under conditions c1 , c4 , c6 , c7 , c8 and c10 , @xmath510 \\lesssim \\frac{\\sqrt{\\max \\{\\delta , \\varepsilon \\}}}{\\sqrt{n}}.\\ ] ]    let @xmath466 . by lemmas envelope and [ entropy bound ]",
    ", we have that @xmath511}(\\epsilon , \\digamma _ { \\delta , \\varepsilon } , l_{2}(p))}d\\epsilon \\lesssim \\psi ^{q/\\alpha } \\int\\nolimits_{0}^{a_{2}\\psi } \\epsilon ^{-q/\\alpha } d\\epsilon \\lesssim \\psi\\]]where the last inequality follows since @xmath134 .",
    "lemma [ verify maximal inequality ] hence follows by applying corollary 19.35 of van der vaart ( 1998 , p.288 ) .",
    "we now prove theorem [ thm - rate ] .",
    "we take @xmath512 , @xmath513 and @xmath514 in the application of lemma [ rate of convergence lemma ] , where @xmath403 and @xmath515 are real constants stated in lemma [ quadratic expansion of s(b , r ) ] .    since @xmath381 ,",
    "the norm by the metric @xmath516 is equivalent to the euclidean norm and thus by theorem [ thm - consist ] , @xmath517 .",
    "moreover since @xmath382 , assumption c11 implies that @xmath518 .",
    "given assumption c1 , for sufficiently small @xmath372 , we have that @xmath519 when @xmath520 .",
    "hence for sufficiently small @xmath372 and @xmath137 , by lemma [ quadratic expansion of s(b , r ) ] and noting that @xmath521 is stronger than @xmath522 , assumptions ( [ inequality 2 ] ) , ( [ quadratic expansion ] ) and ( [ inequality 1 ] ) hold .",
    "by lemma [ verify maximal inequality ] and by taking @xmath342 sufficiently large in the definition of @xmath523 of lemma [ rate of convergence lemma ] , assumption ( [ maximal inequality ] ) also holds with @xmath524 .",
    "clearly , @xmath525 is decreasing for some @xmath314 . by assumption",
    "c11 , @xmath526 and thus @xmath527 for every @xmath1 .",
    "therefore , all conditions stated in lemma [ rate of convergence lemma ] are fulfilled and the result of theorem [ thm - rate ] hence follows .",
    "for @xmath303 , define the sets @xmath529where @xmath137 is the sequence stated in the assumptions of theorem [ thm - distribution ] . for each @xmath530 , define the following recentered empirical and population criterion functions @xmath531clearly , @xmath97 and @xmath97 @xmath532 , defined by ( beta_hat ) and ( [ beta_hat_g ] ) , are still maximizers of the objective functions @xmath533 and @xmath534 , respectively",
    ". decompose @xmath535 as follows.@xmath536 + \\left [ \\overline{s}(b,% \\widehat{g})-\\overline{s}(b , g)\\right ]   \\label{decomposition}\\]]where@xmath537we shall need the following results .    for @xmath306 and @xmath538 ,",
    "consider the local neighborhoods @xmath539 and @xmath540 defined as@xmath541recall that @xmath542 , @xmath543 , @xmath544 , @xmath545 and @xmath546 . note that for @xmath372 sufficiently small , assumption c1 implies that @xmath370 when @xmath547 .",
    "therefore we may assume that @xmath548 @xmath370 and @xmath549 where @xmath550 .",
    "for any @xmath551 , consider the following function@xmath552let@xmath553 .\\]]define the class of functions@xmath554let @xmath555 denote an envelope for @xmath556 such that @xmath557 @xmath558 for all @xmath431 and for all @xmath559 .",
    "[ envelope copy(1)]let @xmath372 and @xmath20 be sufficiently small .",
    "given conditions c1 , c4 , c6 and c10 , for some positive real constants @xmath403 and @xmath515 , we can take @xmath560and furthermore , @xmath561    note that@xmath562 \\text { or } \\left [ \\overline{m}_{% \\widetilde{b},\\gamma } ( s)=-1\\text { and } \\overline{m}_{\\widetilde{b},g}(s)=1% \\right ] \\right\\ } .\\]]given c1 , c6 and c10 , there is positive real constant @xmath438 such that @xmath563 with probability 1 .",
    "hence if @xmath564 , we have that @xmath565on the other hand,@xmath566therefore , the condition @xmath567 and @xmath568 implies @xmath569,@xmath570 .",
    "based on similar arguments , we can verify that the condition @xmath571 and @xmath572 also implies @xmath573,@xmath574 .",
    "therefore , lemma [ envelope copy(1 ) ] follows by taking @xmath575 and noting that given c4 , inequality ( m_delta_epsilon ) holds for @xmath576 .",
    "[ entropy bound copy(1)]given conditions c1 , c4 , c6 , c7 , c8 and c10 , we have that for sufficiently small @xmath372 and @xmath20 , @xmath577 \\lesssim n^{-1/2}(\\max \\{\\delta , \\varepsilon \\})^{\\frac{q}{2\\alpha } } ( \\min \\{\\delta , \\varepsilon \\})^{\\frac{\\alpha -q}{% 2\\alpha } } .\\ ] ]    define the following two classes of functions @xmath578using lemma 9.25 of kosorok ( 2008 , p.169 ) ) , we have that @xmath451}(\\epsilon , \\digamma _ { \\delta , \\varepsilon } , l_{2}(p))\\leq \\log n_{[]}(\\epsilon /2,a_{\\delta , \\varepsilon } , l_{2}(p))+\\log n_{[]}(\\epsilon /2,b_{\\delta , \\varepsilon } , l_{2}(p)).\\]]let @xmath466 . by lemma entropy bound , we have that for sufficiently small @xmath372 and @xmath509 , @xmath451}(\\epsilon , a_{\\delta , \\varepsilon } , l_{2}(p))\\lesssim \\psi ^{2q/\\alpha } \\epsilon ^{-2q/\\alpha } .\\]]furthermore by simplifying proof of lemma [ entropy bound ] , it is straightforward to verify that @xmath451}(\\epsilon , b_{\\delta , \\varepsilon } , l_{2}(p))\\lesssim \\psi ^{2q/\\alpha } \\epsilon ^{-2q/\\alpha } \\]]and thus @xmath451}(\\epsilon , \\digamma _ { \\delta , \\varepsilon } , l_{2}(p))\\lesssim \\psi ^{2q/\\alpha } \\epsilon ^{-2q/\\alpha } .",
    "\\label{entropy}\\]]using inequality ( [ entropy ] ) and lemmas [ envelope copy(1 ) ] , we have that @xmath511}(\\epsilon , \\digamma _ { \\delta , \\varepsilon } , l_{2}(p))}d\\epsilon \\lesssim \\psi ^{\\frac{q}{\\alpha } } \\int% \\nolimits_{0}^{c_{2}\\sqrt{\\min \\{\\delta , \\varepsilon \\}}}\\epsilon ^{-\\frac{q% } { \\alpha } } d\\epsilon \\lesssim \\psi ^{\\frac{q}{\\alpha } } ( \\min \\{\\delta , \\varepsilon \\})^{\\frac{\\alpha -q}{2\\alpha } } \\]]where the last inequality follows from the assumption @xmath134 .",
    "lemma entropy bound copy(1 ) hence follows by applying corollary 19.35 of van der vaart ( 1998 , p.288 ) .      by kim and pollard(1990 ) , @xmath579 .",
    "hence , by condition c11 and theorem thm - rate , for sufficiently large @xmath303 , probability of the event that @xmath580 @xmath581 and @xmath582 can be made arbitrarily close to @xmath248 .",
    "thus to show the theorem , it suffices to establish that for any fixed sufficiently large @xmath303 , @xmath583given ( [ rate of difference of sn ] ) , we have that @xmath584where the first and third inequalities follow from ( [ rate of difference of sn ] ) and the second inequality follows from the definition of @xmath585 .",
    "therefore by theorem 1.1 of kim and pollard(1990 ) , @xmath586 and @xmath164 are asymptotically equivalent in distribution .",
    "we now verify equation ( [ rate of difference of sn ] ) . given the decomposition ( [ decomposition ] ) , it suffices to show that@xmath587 = o(n^{-2/3 } ) ,   \\label{e11 } \\\\ & & \\sup\\limits_{b\\in \\theta _ { n}(c)}\\left\\vert \\overline{s}(b,\\widehat{g})-% \\overline{s}(b , g)\\right\\vert = o_{p}(n^{-2/3 } ) .",
    "\\label{e21}\\end{aligned}\\]]equation ( [ e11 ] ) concerns stochastic equicontinuity of the local recentered process @xmath588 indexed by @xmath589 .",
    "it is satisfied by setting @xmath590 and @xmath591 in the definition of sets @xmath592 and @xmath540 given by ( [ theta_delta ] ) and ( [ h_epsilon ] ) and by invoking lemma entropy bound copy(1 ) with the assumptions @xmath593 and @xmath134 .",
    "we now verify equation ( [ e21 ] ) .",
    "note that for @xmath1 sufficiently large , if @xmath594 , then @xmath370 under condition c1 .",
    "let @xmath595where @xmath376 is defined by ( [ s1 ] ) . hence it suffices to verify @xmath596where @xmath597 @xmath598 .",
    "note that the term @xmath599 is bounded above by @xmath600-[s_{1}(\\widetilde{b},g)-s_{1}(\\widetilde{\\beta } % , g)]\\right\\vert .",
    "\\label{ineq terms}\\]]since @xmath593 , by c11 we have that @xmath601 because the norm @xmath602 is stronger than the sup norm @xmath603 .",
    "hence by lemma [ quadratic expansion of s(b , r ) ] , the first term of the sum ( [ ineq terms ] ) is @xmath604 and@xmath605where the terms @xmath606 , @xmath607 and @xmath608 are given by ( [ a1 ] ) , ( [ a2 ] ) and ( e(b , r ) ) , respectively . using",
    "the proof of lemma [ quadratic expansion of s(b , r ) ] , it is also straightforward to verify that @xmath609since @xmath610 and @xmath611 , we have that @xmath612 and @xmath613 .",
    "putting together ( [ t1 ] ) and ( [ t2 ] ) , it follows that the second term of the sum ( [ ineq terms ] ) is also @xmath604 and therefore equation ( [ e21 ] ) holds .",
    "delgado , m.a .",
    ", rodriguez - poo , j.m.,and wolf , m. ( 2001 ) , `` subsampling inference in cube root asymptotics with an application to manski s maximum score estimator '' , _ economics letters _ , 73 ( 2 ) , 241250 .",
    "jun , s. j. , pinkse , j. and wan , y. ( 2013 ) , `` classical laplace estimation for @xmath614{n}$]-consistent estimators : improved convergence rates and rate - adaptive inference '' , working paper , department of economics , pennsylvania state university .",
    "cccccc + @xmath1 & bias & rmse & median & mean ad & median ad +   + 300 & -0.112 & 0.410 & 0.894 & 0.329 & 0.288 + 500 & -0.061 & 0.352 & 0.916 & 0.285 & 0.247 + 1000 & -0.031 & 0.264 & 0.961 & 0.211 & 0.182 +   + 300 & -0.122 & 0.478 & 0.856 & 0.381 & 0.326 + 500 & -0.070 & 0.376 & 0.908 & 0.304 & 0.259 + 1000 & -0.033 & 0.301 & 0.952 & 0.240 & 0.211    cccccc + @xmath1 & bias & rmse & median & mean ad & median ad +   + 300 & -0.056 & 0.330 & 0.918 & 0.262 & 0.216 + 500 & -0.044 & 0.277 & 0.942 & 0.220 & 0.184 + 1000 & -0.020 & 0.212 & 0.966 & 0.169 & 0.139 +   + 300 & -0.394 & 0.489 & 0.577 & 0.431 & 0.432 + 500 & -0.413 & 0.469 & 0.568 & 0.424 & 0.432 + 1000 &",
    "-0.400 & 0.435 & 0.587 & 0.402 & 0.412    cccccc + @xmath198 & bias & rmse & median & mean ad & median ad +   + 5.4 & -0.063 & 0.639 & 0.868 & 0.502 & 0.417 + 5.6 & 0.041 & 0.653 & 0.966 & 0.500 & 0.400 + 5.8 & 0.138 & 0.718 & 1.067 & 0.544 & 0.427 +   + 5.4 & -0.046 & 0.501 & 0.908 & 0.388 & 0.314 + 5.6 & 0.056 & 0.518 & 0.992 & 0.393 & 0.307 + 5.8 & 0.171 & 0.584 & 1.096 & 0.435 & 0.331 +   + 5.4 & -0.087 & 0.389 & 0.887 & 0.311 & 0.266 + 5.6 & 0.008 & 0.380 & 0.992 & 0.307 & 0.264 + 5.8 & 0.111 & 0.424 & 1.086 & 0.334 & 0.278    cccccc + @xmath198 & bias & rmse & median & mean ad & median ad +   + 5.8 & -0.071 & 0.480 & 0.918 & 0.380 & 0.328 + 6 & 0.053 & 0.523 & 1.028 & 0.408 & 0.340 + 6.2 & 0.147 & 0.577 & 1.132 & 0.448 & 0.372 +   + 5.8 & -0.066 & 0.400 & 0.906 & 0.316 & 0.264 + 6 & 0.030 & 0.408 & 1.004 & 0.323 & 0.268 + 6.2 & 0.103 & 0.457 & 1.062 & 0.355 & 0.288 +   + 5.8 & -0.125 & 0.298 & 0.865 & 0.243 & 0.211 + 6 & -0.028 & 0.286 & 0.956 & 0.230 & 0.192 + 6.2 & 0.059 & 0.320 & 1.038 & 0.251 & 0.211    cccccc + @xmath198 & bias & rmse & median & mean ad & median ad +   + 0.6 & -0.172 & 0.483 & 0.803 & 0.392 & 0.345 + 0.8 & -0.122 & 0.502 & 0.865 & 0.395 & 0.328 + 1 & -0.088 & 0.510 & 0.896 & 0.401 & 0.333 +   + 0.6 & -0.111 & 0.391 & 0.880 & 0.315 & 0.276 + 0.8 & -0.073 & 0.394 & 0.913 & 0.316 & 0.268 + 1 & -0.037 & 0.408 & 0.937 & 0.326 & 0.280 +   + 0.6 & -0.054 & 0.305 & 0.923 & 0.247 & 0.216 + 0.8 & -0.028 & 0.301 & 0.956 & 0.242 & 0.211 + 1 & 0.002 & 0.313 & 0.980 & 0.250 & 0.216    cccccc + @xmath198 & bias & rmse & median & mean ad & median ad +   + 0.6 & -0.112 & 0.440 & 0.865 & 0.347 & 0.297 + 0.8 & -0.057 & 0.443 & 0.918 & 0.351 & 0.302 + 1 & -0.009 & 0.469 & 0.968 & 0.370 & 0.316 +   + 0.6 & -0.077 & 0.366 & 0.918 & 0.291 & 0.244 + 0.8 & -0.040 & 0.382 & 0.932 & 0.302 & 0.254 + 1 & -0.010 & 0.397 & 0.966 & 0.313 & 0.264 +   + 0.6 & -0.037 & 0.272 & 0.952 & 0.218 & 0.182 + 0.8 & -0.012 & 0.272 & 0.980 & 0.218 & 0.192 + 1 & 0.036 & 0.286 & 1.028 & 0.230 & 0.201"
  ],
  "abstract_text": [
    "<S> this paper develops maximum score estimation of preference parameters in the binary choice model under uncertainty in which the decision rule is affected by conditional expectations . </S>",
    "<S> the preference parameters are estimated in two stages : we estimate conditional expectations nonparametrically in the first stage and then the preference parameters in the second stage based on manski ( 1975,1985 ) s maximum score estimator using the choice data and first stage estimates . the paper establishes consistency and derives rate of convergence of the two - stage maximum score estimator . </S>",
    "<S> moreover , the paper also provides sufficient conditions under which the two - stage estimator is asymptotically equivalent in distribution to the corresponding single - stage estimator that assumes the first stage input is known . </S>",
    "<S> these results are of independent interest for maximum score estimation with nonparametrically generated regressors . </S>",
    "<S> the paper also presents some monte carlo simulation results for finite - sample behavior of the two - stage estimator . </S>",
    "<S> * keywords : * _ discrete choice , maximum score estimation , generated regressor , preference parameters , m - estimation , cube root asymptotics _ * jel codes : * c12 , c13 , c14 . </S>"
  ]
}