{
  "article_text": [
    "with rapidly growing urbanization and mobility needs of people across the world , existing transportation systems are in critical need of transformation .",
    "apart from increased travel times , current burdened transportation systems have the side effects of increased pollution , increased energy consumption , and degradation of people s health , all of which have an immeasurable cost on society .",
    "the complexity of the challenge requires a multi - pronged approach , one of which is the development of new technologies . emerging technologies such as vehicle - to - vehicle ( v2v ) and vehicle - to - infrastructure ( v2i ) communication , and computer - controlled vehicles offer the opportunity to radically redesign our transportation systems , eliminating road accidents and traffic collisions and positively impacting safety , traveling ease , travel time , and energy consumption .",
    "a particularly useful application of these technologies is the coordination of traffic at and near intersections for a smoother ( with reduced stop - and - go ) and fuel - efficient traffic flow .",
    "an intersection manager with knowledge of the state of the traffic could schedule the intersection crossings of the vehicles . with the assigned schedule , individual vehicles",
    "could further optimize their travel to the intersection in a fuel - efficient way .",
    "in contrast to traditional intersection management , networked vehicle technologies allow us to coordinate the traffic not just _ within the intersection _ , but also by controlling the vehicles behavior much before they arrive at the intersection .",
    "such a paradigm offers the possibility of significantly reduced stop times and increased fuel efficiency , and is the subject of this paper .",
    "much of the literature in the area of coordination - based intersection management focuses on collision avoidance of vehicles _ within the intersection_. supervisory intersection management ( intervention only when required to maintain safety by avoiding collisions ) is explored using discrete event abstractions in  @xcite and reachable set computations in  @xcite .",
    "the works  @xcite and references therein describe a multiagent simulation approach in which , upon a reservation request from a vehicle , an intersection manager accepts or rejects the reservation based on a simulation .",
    "each vehicle attempts to conform to its assigned reservation and , if this is predicted not to be possible at any time , the reservation is canceled .",
    "@xcite also uses a reservation - based system to schedule intersection crossing times and provides provably safe maneuvers for vehicle following in a lane as well as for crossing the intersection . @xcite",
    "use a method based on model predictive control to coordinate the intersection crossing by vehicles and obtain suboptimal solutions to a linear quadratic optimal control problem .",
    "@xcite also proposes a model predictive control approach in which collision - free intersection crossing by vehicles is achieved through a combination of hard no - collision constraints as well as a soft constraint in the form of a term measuring collision risk in the cost function . in  @xcite , a heuristic policy assigns priorities to the vehicles , while each vehicle applies a priority - preserving control and legacy vehicles platoon behind a computer - controlled car .",
    "in this context , we note that the ability to efficiently coordinate diminishes as the vehicles get closer to the intersection .",
    "this is why here we take an expanded view of intersection management that looks at the coordinated control of the vehicles much before they arrive at the intersection .",
    "the methods above are not suited for this setup or would prove to be too computationally costly in such scenarios .",
    "an example of the expanded view of intersection management is  @xcite , in which a polling - systems approach is adopted to assign schedules , and then optimal trajectories for all vehicles are computed sequentially in order .",
    "such optimal trajectory computations are costly and depend on other vehicles detailed plans , and hence the system is not robust .",
    "closer to this paper , the works @xcite describe a hierarchical setup , with a central coordinator verifying and assigning reservations , and with vehicles planning their trajectories locally to platoon and to meet the assigned schedule .",
    "the proposed solution is based on multiagent simulations and a reservation - based scheduling ( with the evolution of the vehicles possibly forcing revisions to the schedule ) , both important differences with respect to our approach .",
    "@xcite is a recent survey of traffic control with vehicular networks and provides other related references .",
    "we propose a provably safe intersection management system aimed at optimizing a combination of cumulative travel time and fuel usage for all the vehicles .",
    "our first contribution is the idea of coordinating the traffic at the intersection and on the branches leading to it in a unified , holistic way .",
    "the basic observation is that planning and controlling the vehicles from much before they arrive at the intersection should lead to better overall coordination and efficiency .",
    "our second set of contributions is a multi - layered design that combines hierarchical and distributed control and is applicable to a wide range of traffic conditions .",
    "our hierarchical - distributed approach offers a good balance between computational complexity of the solution and optimal operation .",
    "the proposed system is composed of three main aspects , each a contribution on its own : ( i ) clustering to identify vehicles that platoon before arriving at the intersection .",
    "we refer to such clusters of vehicles as _",
    "bubbles_. we use the term bubble , rather than platoon , to emphasize the dynamic , time - varing nature of the cohesiveness of the group of vehicles as they travel towards the intersection . with this terminology , the bubble becomes a rigid and cohesive group ( i.e. , a platoon ) by the time they cross the intersection ; ( ii ) a branch - and - bound scheduling algorithm that , using aggregate information about the bubbles , allows a central intersection manager to find the optimal schedule of bubble passage ; and ( iii ) a distributed control algorithm for the vehicles at the local level .",
    "this control policy ensures that the vehicles of each bubble platoon into a cohesive group when they cross the intersection and that each bubble conforms to the schedule prescribed by the intersection manager , while guaranteeing system - wide safety subject to speed limits and acceleration saturation . additionally , each vehicle seeks to optimally control its trajectory whenever safety is not immediately threatened .",
    "our third and final contribution is the technical analysis leading to the provable safety of our design .",
    "in contrast to computationally intensive multiagent simulation - based methods , we provide analytical guarantees on correctness , safety , and performance .",
    "further , the results provide good intuition and fundamental and reliable principles for future designs .",
    "we do acknowledge that the development of analytical guarantees comes at the cost of some conservatism in the design .",
    "we have performed a suite of simulations comparing our approach to traditional signal - based coordination that show a significant improvement in the cumulative energy consumption for a wide range of traffic densities and a more socially equitable distribution of cost . however , the throughput of the intersection is significantly less in our approach than that of signal - based coordination except for low densities of traffic . as a final note for the reader s sake",
    ", we have made every effort in the presentation to make the components of the paper understandable even if the proofs of the technical results are skipped in a first reading .",
    "we present here some basic notation and concepts on graph theory used throughout the paper .",
    "we let @xmath0 , @xmath1 , @xmath2 , @xmath3 , and @xmath4 denote the set of real , nonnegative real , integer , positive integer , and nonnegative integer numbers , respectively . for a non - empty ordered list @xmath5 , we let @xmath6 denote the cardinality of @xmath7 .",
    "further , @xmath8 denotes the @xmath9 element @xmath10 of @xmath7 .",
    "thus , @xmath11 denotes the last element of  @xmath7 . for convenience",
    ", we also use the notation @xmath12 ( @xmath13 ) to denote that @xmath14 is ( is not ) an element of  @xmath7 . for two",
    "ordered lists @xmath15 and @xmath16 , we let @xmath17 denote the ordered list of elements that belong to @xmath15 but not to @xmath16 , while preserving the same order of  @xmath15 . given @xmath18 , @xmath19_{u_m}^{u_m}}$ ] denotes the number @xmath20 lower and upper saturated by @xmath21 and @xmath22 respectively , i.e. , @xmath23_{u_m}^{u_m } } \\triangleq    \\begin{cases }      u_m , \\quad \\text{if } u \\leq u_m ,      \\\\",
    "u , \\quad \\text{if } u \\in [ u_m , u_m ] ,      \\\\",
    "u_m , \\quad \\text{if } u \\geq u_m .    \\end{cases}\\ ] ]      we review basic notions following the exposition in  @xcite .",
    "a digraph of order @xmath24 is a pair @xmath25 , where @xmath26 is a set with @xmath24 elements called nodes and @xmath27 is a set of ordered pair of nodes called edges .",
    "a directed path is an ordered sequence of nodes such that any ordered pair of nodes appearing consecutively is an edge .",
    "a cycle is a directed path that starts and ends at the same node and contains no repeated node except for the initial and the final one .",
    "a digraph is acyclic if it has no cycles .",
    "a directed ( or rooted ) tree is an acyclic digraph with a node , called root , such that any other node can be reached by one and only one directed path starting at the root .",
    "if @xmath28 is an edge of a tree , @xmath29 is the parent of @xmath14 , and @xmath14 is the child of  @xmath29 .",
    "a node  @xmath14 is called a descendant of a node  @xmath29 if there is a directed path from  @xmath29 to  @xmath14 .",
    "given a tree , a subtree rooted at @xmath29 is the tree that has @xmath29 as its root and is composed by all its descendants in the original tree .",
    "consider an intersection of length @xmath30 with four incoming traffic branches labeled by @xmath31 , cf .",
    "figure  [ fig : intersect ] .     is the length of the intersection and the numbers @xmath31 are labels for the incoming branches . ]    for simplicity , we assume that ( i ) there is a single lane in each direction , ( ii ) all vehicles are identical with length @xmath32 , ( iii ) vehicles do not turn at the intersection , ( iv ) the intersection at any time may be used by vehicles from a single branch ( v ) there are no sources or sinks for vehicles along the branches - all new traffic appears at the beginning of the branches and must cross the intersection .",
    "we discuss later in remark  [ re : assumptions ] the extent to which these assumptions can be relaxed in our algorithmic solution .",
    "the dynamics of vehicle @xmath14 is a fully actuated second - order system ,    [ eq : vehicle - dyn ] @xmath33    where @xmath34 , @xmath35 are the position ( negative of the distance from the front of the vehicle to the beginning of the intersection ) and velocity of the vehicle , respectively and @xmath36 $ ] , with @xmath37 , is the input acceleration .",
    "we use the superscript @xmath38 to emphasize that the state and control variables refer to individual vehicles .",
    "we assume that each branch has a maximum speed limit that the vehicles must respect .",
    "for the sake of easing the notation , we assume that the speed limit on all branches is the same and equals @xmath39 .",
    "thus , for each vehicle @xmath14 , @xmath40 must belong to the interval @xmath41 $ ] for all time @xmath42 that the vehicle is in the system .",
    "each vehicle is equipped with vehicle - to - vehicle ( v2v ) and vehicle - to - infrastructure ( v2i ) communication capabilities . with v2i communication ,",
    "the vehicles inform a central _ intersection manager _",
    "( i m ) about their positions and velocities and receive from it commands such as prescribed time of arrival at the intersection .",
    "we assume the i m has the necessary communication and computing capabilities .",
    "we seek a design solution that aims to minimize a cost function  @xmath43 that models a combination of cumulative travel time and cumulative fuel cost of the form @xmath44 where @xmath14 is the vehicle index , @xmath45 is the time at which vehicle  @xmath14 ` spawns ' into the problem domain and @xmath46 is the time at which the vehicle exits the intersection , i.e. , @xmath47 .",
    "the weight @xmath48 sets the relative importance of travel time versus fuel cost .",
    "the vehicles over which the cost is summed may be chosen in different ways - for example it may be over all vehicles that cross the intersection in a time period or it may be over a fixed number of vehicles .",
    "the constraints in the problem arise from the speed limit , bounds on vehicle acceleration and deceleration , and the safety requirements - which require scheduling the intersection crossing of the vehicles and maintenance of safe distance between the vehicles .",
    "solving this problem at the level of individual vehicles is computationally expensive and not scalable .",
    "thus , we aim to synthesize a solution that makes this problem tractable to solve in real time and is applicable to a wide range of traffic scenarios .",
    "this section gives an outline of our hierarchical distributed solution to the problem stated in section  [ sec : problem - statement ] .",
    "our algorithmic solution combines optimized planning and scheduling of groups of vehicles with local distributed control to ensure safety and execute the plans .",
    "its three distinct aspects are :    1 .",
    "grouping the vehicles into clusters , 2 .   scheduling the passage of the clusters through the intersection , 3 .   local vehicular control to achieve and maintain cluster cohesion , to avoid collisions , and to ensure the clusters meet the prescribed schedule .",
    "each of these aspects is coupled with the other two .",
    "moreover , an overarching theme is the dynamic nature of the problem due to the arrival and departure of vehicles .",
    "any complete or partial solution has to be computed as new vehicles come in ( event based ) or at regular time intervals ( time based ) .",
    "in what follows , we provide a general description of the main ingredients of each aspect . at any given time @xmath42",
    ", we let @xmath49 be the latest time prior to @xmath42 at which the i m samples the state of traffic and solves the corresponding static scheduling problem .",
    "the primary motivation to cluster vehicles is to reduce the number of independent entities that need to be considered in the ( computationally expensive ) schedule optimization problem .",
    "for instance , the maximum number of clusters can be fixed according to the available computational resources so that the scheduling problem remains tractable . at time @xmath49 , the vehicles present in the four branches are grouped into @xmath50 clusters .",
    "we let @xmath51 denote the number of clusters on branch  @xmath52 .",
    "given the position information of the vehicles at @xmath49 , we use @xmath52-means clustering on each branch individually to identify the clusters",
    ". the relative positions of the vehicles of a cluster may vary significantly over the course of their travel and the vehicles may not be in the form of a well - defined platoon at all times .",
    "hence , we refer to a cluster of vehicles as a _ bubble _ ( shown as grey boxes in figure  [ fig : intersect ] ) .",
    "the defining characteristic of a bubble is that all the vehicles of a bubble cross the intersection together .",
    "the state of the @xmath9 bubble is given by the tuple @xmath53 where @xmath54 , @xmath55 and @xmath56 are , respectively , the position of the lead vehicle in the bubble , the velocity of the lead vehicle in the bubble , and the number of vehicles in the bubble .",
    "we denote by @xmath57 , the _ occupancy time _ of bubble @xmath29 , which is the time duration for which the intersection is occupied by bubble @xmath29 .",
    "the quantity @xmath58 is an upper bound that can be guaranteed _ a priori _ , and is a function of the bubble size @xmath56 and various other system parameters . the quantity  @xmath59 denotes which of the four incoming branches the bubble is on . within each branch",
    ", we require the order of the bubbles to remain constant during the bubbles travel ( i.e. , there is no passing allowed ) . to capture the order of the bubbles on a branch",
    ", we define the function  @xmath60 , @xmath61 according to this definition , @xmath62 if and only if bubbles @xmath29 and @xmath63 are on the same branch and bubble @xmath63 is the immediate follower of bubble  @xmath29 .",
    "we describe in detail the generation of bubbles and the algorithm to select the bubbles to schedule in section  [ sec : cluster - dyn ] below .",
    "we impose a limit on the number of bubbles that are scheduled at any given time to @xmath64 , even if the actual number of bubbles in the system were greater , so as to keep the computational cost manageable .",
    "however , in the algorithm we describe in the sequel , each bubble is scheduled at least once and some bubbles may be scheduled more than once .",
    "we let @xmath65 denote the latest time prior to @xmath42 at which bubble @xmath29 was scheduled .",
    "we index the vehicles in bubble @xmath29 as @xmath66 , where @xmath67 refers to the lead vehicle in bubble @xmath29 and so on until @xmath68 , the last vehicle in the bubble .",
    "we also find it convenient for the label @xmath69 to represent the last vehicle @xmath70 of the bubble @xmath71 that precedes bubble @xmath29 on the same branch or , if such bubble does not exist , we let @xmath69 be an imaginary vehicle located at @xmath72 .",
    "we drop the index  @xmath29 whenever there is no ambiguity with regard to the bubble .",
    "the job of the scheduler is to prescribe to each bubble an _ approach time _ @xmath73 - the time at which the @xmath9 bubble is to reach the beginning of the intersection , i.e. , @xmath74 , so that no two different bubbles collide . in solving this problem",
    ", the scheduler has to respect the order of bubbles on the same branch and take into account no - collision constraints between bubbles on two different branches .",
    "the preservation of the order of intersection crossing by the bubbles on the same branch takes the form ,    [ eq : tau - constraints ] @xmath75 for @xmath76 .",
    "note that these constraints only ensure that the passage of bubbles on a branch through the intersection occurs in the same order as they have arrived , but they do not necessarily exclude collisions for the entire travel time .",
    "the intra - branch collisions are avoided at a local level and we accept the resulting sub - optimality . on the other hand , the no - collision constraint between bubbles on two different branches takes the form , @xmath77    for @xmath76 .",
    "the constraints   make the scheduling problem combinatorial in nature because of the need to determine whether @xmath29 or @xmath63 goes first . since the order on each branch is to be preserved ,",
    "the number of sub - problems is the number of permutations of the multiset @xmath78 , i.e. , @xmath79 where recall that @xmath51 is the number of bubbles on branch @xmath52 and @xmath50 is the total number of bubbles .",
    "we describe in detail the algorithm for optimal scheduling of bubbles in section  [ sec : schedule ] .",
    "the local vehicular control has various equally relevant goals .",
    "the first goal is to avoid collisions within each bubble and among different bubbles in the same branch .",
    "the second goal is for the local vehicular control to ensure that the bubble approaches the intersection at the prescribed time @xmath73 and that the occupancy time of the bubble , @xmath57 , is no more than @xmath58 .",
    "the scheduler requires the quantity @xmath58 and other quantities such as earliest and latest times of approach at the intersection for the bubble that are functions of the initial conditions .",
    "all these quantities may be computed by the bubble and passed on to the i m or , instead , the state of each car may be passed to the i m .",
    "we assume that the control law at the vehicle level ensures that a vehicle does not change bubbles during the course of its travel time .",
    "thus , as far as the scheduling aspect is concerned , @xmath56 may be assumed constant in time .",
    "we describe in detail the local vehicular control component in section  [ sec : vehicle - control ] below .    _",
    "( relaxation of assumptions)._[re : assumptions ] we discuss here to what extent the assumptions made in section  [ sec : problem - statement ] can be relaxed in our proposed design .",
    "we make assumptions ( ii ) and ( iv ) only for the sake of simpler notation and ease of exposition .",
    "our algorithm can handle non - identical vehicles with differing dimensions and differing acceleration limits , though those quantities need to be known .",
    "simultaneous use of the intersection by vehicles on compatible branches / directions is definitely possible in our framework and indeed makes the scheduling problem easier",
    ". we can relax assumption ( v ) if the sources or sinks are not close to the intersection with minor changes in our algorithm for bubble generation .",
    "we can avoid assumption ( iii ) and allow turning within our framework .",
    "however , the differing travel speeds when turning and going straight affects the computation of the intersection occupancy time , which might make the design conservative .",
    "we believe this conservativeness could be addressed by relaxing assumption ( i ) and incorporating multiple lanes into the design .",
    "the primary motivation for clustering vehicles into bubbles is to reduce the computational burden on the scheduler .",
    "consequently , we impose the upper bound @xmath64 on the number of bubbles that the scheduler needs to consider at any given instance .",
    "further , as new vehicles arrive , they need to be assigned to new bubbles . in order to balance both requirements",
    ", we divide each branch into three zones , as shown in figure  [ fig : zones ] : staging zone ( of length @xmath80 ) , mid zone ( of length @xmath81 ) and exit zone ( of length @xmath82 ) . for each branch",
    "@xmath83 , we let @xmath84 , @xmath85 and @xmath86 be the set of positions on the branch @xmath52 corresponding to the staging , mid and exit zones , respectively .",
    "the ` clustering into bubbles`algorithm is executed every @xmath87 units of time . at each clustering instance @xmath88 , @xmath89 , the vehicles in the staging zone that do not already belong to a bubble are clustered .",
    "thus , the choice @xmath90 , where recall that @xmath39 is the max speed limit , ensures that every vehicle belongs to a bubble before it leaves the staging zone and enters the mid zone .",
    "we impose an upper bound @xmath91 on the number of new bubbles that may be created on branch @xmath52 at any clustering instance . at a clustering instance @xmath92 ,",
    "let @xmath93 denote the number of vehicles to be clustered in the staging zone of branch  @xmath52 .",
    "then , the @xmath93 vehicles are clustered based on their position using the @xmath94-means algorithm , with @xmath95 .",
    "thus , the @xmath93 on branch @xmath52 are partitioned into @xmath94 number of clusters or bubbles such that the sum of squares of the distances from each car to the center of its bubble is minimized , see e.g. ,  @xcite .",
    "the clustering component in our design is modular and hence any clustering algorithm that is well suited may be used .",
    "the algorithm also makes sure that no more than  @xmath64 bubbles are passed to the i m manager for scheduling at any instance .",
    "this is achieved using two observations .",
    "first , previously scheduled bubbles that have already entered the exit zone of their branch are no longer fed to the i m for scheduling ( i.e. , its schedule is not modified any further ) .",
    "second , if the number of newly created bubbles and the previously created bubbles yet to enter the exit zone exceeds @xmath64 , then the algorithm pops out the required number of bubbles from the top of the list of bubbles previously scheduled ( corresponding to the ones closer to their respective exit zones ) .",
    "we present the precise description of the ` clustering into bubbles`algorithm in algorithm  [ algo : dyn - cs ] .",
    "@xmath96 + @xmath97 + @xmath91 @xmath98 cluster new vehicles on branch @xmath52 using @xmath94-means algorithm [ step : k - means ] @xmath99 remove first @xmath100 bubbles from @xmath101 append new bubbles to @xmath101 @xmath102 + @xmath101 , @xmath103    the algorithm takes in the list of bubbles @xmath104 scheduled on the last iteration and an earliest approach time @xmath105 used when scheduling  it .",
    "the output is a list of bubbles @xmath101 to be scheduled and the earliest approach time @xmath103 for them .",
    "note from step 12 of algorithm  [ algo : dyn - cs ] that @xmath103 is an upper bound on the time by which all the bubbles not in the @xmath101 list are guaranteed to cross the intersection .",
    "thus , when scheduling @xmath101 , the scheduler imposes the constraint that the bubbles in @xmath101 approach the intersection no earlier than  @xmath103 .    _",
    "( effect of zone lengths on clustering and scheduling ) . _",
    "the lengths of the three zones illustrated in figure  [ fig : zones ] directly affect the resulting traffic coordination .",
    "although we do not pursue here a systematic design of these zone lengths , we can identify some basic observations of their effect on clustering and scheduling .",
    "we envision these zone lengths to be of the order of several tens of meters .",
    "the length @xmath80 of the staging zone has a direct effect on the time step of the periodic execution of clustering and scheduling as well as on the number of vehicles per bubble .",
    "the length @xmath81 of the mid zone has an effect on the likelihood of revising a bubble s schedule on the next iteration .",
    "finally , the length @xmath82 of the exit zone has an effect on the feasibility of the scheduling problem , which we guarantee by assuming that @xmath82 is large enough for a vehicle to come to a complete stop from a maximum speed of @xmath39 in under a distance  @xmath82 .    _",
    "( re - clustering ) . _",
    "the ` clustering into bubbles`algorithm is just one method of defining bubbles and selecting which ones to select . in this algorithm ,",
    "a vehicle is assigned to a bubble only once and the vehicle is part of that bubble through out its travel .",
    "however , one could implement a strategy which re - clusters all vehicles in the staging and mid zones so that vehicles may be reassigned to a different bubble , bubbles may be merged or split as needed , and so on .",
    "such an algorithm would also allow sources and sinks on the branch such as smaller streets , homes , and retail .",
    "this section describes the scheduling algorithm employed by the intersection manager ( i m ) to decide the order of passage through the intersection of the bubbles in @xmath101 provided by the clustering algorithm .",
    "the scheduling algorithm is also executed every  @xmath87 units of time . in this section ,",
    "we let @xmath101 be the set @xmath106 , where @xmath107 , without loss of generality .      in our approach , the i m schedules bubbles as a whole using an abstraction of the vehicle dynamics and the cost function .",
    "first , regarding the vehicle dynamics , we note that the inter - vehicle approach times at the intersection and the resulting occupancy time of a bubble is a degree of freedom .",
    "however , we have made the alternative choice of not considering it as such in the scheduling algorithm , and instead only use an upper bound on the occupancy time @xmath58 ( that the local vehicular control component can guarantee ) appearing in the constraints  .",
    "second , regarding the cost function , we abstract the fuel cost for the vehicles in a bubble @xmath29 into a single function @xmath108 that depends only on the average velocity of the bubble @xmath29 ( lead vehicle in the bubble ) for @xmath109 $ ] , where @xmath88 is the time at which the scheduling algorithm is executed .",
    "thus , the scheduling algorithm minimizes the following simplified cost function  @xmath110 where @xmath111 for a given list of bubbles @xmath112 is @xmath113 where @xmath114 is the average velocity of the lead vehicle in bubble @xmath29 for @xmath115 $ ] , i.e. , @xmath116 , where @xmath117 . the optimization variables are @xmath114 for each bubble  @xmath118 .    note that in the cost function @xmath119 , the functions @xmath108 could , in general , depend on initial conditions modeled as parameters - such as the distance @xmath120 to reach the intersection .",
    "the cost function   models a combination of cumulative travel time and total fuel usage .",
    "motivated by the fact that fuel efficiency is typically an increasing function of vehicle speed for speeds under the limits enforced on most roads with intersections , we make the assumption that , for each @xmath118 , @xmath121 \\mapsto { \\ensuremath{\\mathbb{r}_{>0}}}$ ] is monotonically decreasing .",
    "regarding the constraints , conditions on the travel times can be re - expressed as conditions on average velocities as @xmath122 thus , we re - express the no - collision constraints   as    [ eq : v - constraints ] @xmath123 in addition , we also need to ensure that the scheduling at instance @xmath124 of the bubbles in @xmath101 does not conflict with the ones that have been previously scheduled .",
    "formally , this corresponds to having the time @xmath73 to reach the intersection for bubble @xmath29 be no less than @xmath103 ( cf .",
    "step 12 of algorithm  [ algo : dyn - cs ] ) .",
    "equivalently , we require @xmath125    note that the scheduling problem is combinatorial in nature due to the no - collision constraints  .",
    "thus , even though the cost function @xmath119 is simple and the optimization variables are the average velocities @xmath114 , we believe this formulation provides a good balance between usefulness and computational tractability .",
    "further , the local vehicular control we present in section  [ sec : vehicle - control ] seeks an optimal control profile to achieve the prescribed average velocity for the bubble , which justifies the restriction to @xmath114 as the optimization variables in the scheduling aspect .",
    "thus our proposed solution , although sub - optimal , is still principled .",
    "we next describe our solution to the scheduling problem consisting of minimizing  @xmath126 in   under the constraints   and @xmath127 $ ] . the lower @xmath128 and upper @xmath129 limits on the average velocity depend on the initial conditions of the vehicles and desired speed limits .",
    "the quantities @xmath130 and @xmath131 are inversely related to the _ latest time of approach _ and the _ earliest time of approach _ at the intersection for bubble @xmath29 , respectively .",
    "the computation of these quantities is described in section  [ sec : hivel - lowvel ] .",
    "similarly , the upper bound @xmath58 on the occupancy times may be computed as in section  [ sec : bartauocc ] . in the first part of our solution to the scheduling problem",
    ", we determine the optimal schedule and optimal cost given a fixed order of bubble passage through the intersection . in the second part , we use a branch - and - bound algorithm to find the optimal order and schedule .      here",
    "we address the problem of determining , given a desired order of bubble passage through the intersection , the optimal average velocities of the bubbles and the associated optimal cost .",
    "for this purpose , define an _ order _ of the approach times of the bubbles as a permutation , @xmath132 , of the integers from @xmath133 to @xmath134 .",
    "we use @xmath135 to denote the @xmath9 element in the order , with the bubble @xmath136 passing through the intersection first and so on .",
    "we use @xmath137 to denote the position of bubble @xmath29 in the order  @xmath132 . clearly , for a permutation to respect the intra - branch orders , @xmath138 if @xmath62 . given  @xmath132 respecting the intra - branch orders , the ` bubble velocity optimization`algorithm ,",
    "formally described in algorithm  [ algo : optim - given - p ] , finds a solution to the optimization of @xmath139 under the constraints  , @xmath127 $ ] , and with order  @xmath132 .",
    "order @xmath132 @xmath140 @xmath141 @xmath142 @xmath143 @xmath144 @xmath145    the following result shows that , for an order that respects the intra - branch order , the algorithm finds the average velocities that optimize the cost function @xmath139 .    _",
    "( ` bubble velocity optimization`algorithm optimizes the schedule given an overall order that respects the intra - branch orders ) .",
    "_ for each @xmath146 , assume the fuel cost function @xmath108 is monotonically decreasing .",
    "let @xmath132 , with @xmath147 , be an order respecting the intra - branch orders and denote by @xmath148 and @xmath43 the output of algorithm  [ algo : optim - given - p ] . then , @xmath149 and @xmath43 are , respectively , the minimizer and the minimum cost of the optimization problem with the cost function as @xmath139   under the constraints  , @xmath150 $ ] .",
    "given the order @xmath132 , the constraints   reduce to @xmath151 where @xmath152 , @xmath153 and @xmath154 .",
    "the left - hand side of the inequality is an increasing function of @xmath155 .",
    "further since @xmath108 is a monotonically decreasing function for each @xmath29 , @xmath156 takes the maximum possible value .",
    "the algorithm computes the components of @xmath149 iteratively and the result follows .",
    "we propose a branch - and - bound algorithm to solve the optimal scheduling problem .",
    "we start by providing an informal description .    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ informal description : _ a branch - and - bound algorithm consists of a systematic enumeration of the set of candidate solutions as a rooted tree , with the full set at the root .",
    "the algorithm explores branches of the tree , which represent subsets of the set of candidate solutions . before enumerating the candidate solutions of a branch ,",
    "the branch is checked against upper bounds on the optimal solution , and is discarded if it is determined that it can not produce a better solution than the best one found so far . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    we formally specify each of the components in this description next , starting with the rooted tree .",
    "we let @xmath112 denote any ordered list of up to length @xmath50 , with non - repeating numbers drawn from @xmath157 , and preserving the individual branch orders . with this notation ,",
    "the empty list @xmath158 denotes the root of the tree , representing all feasible orders .",
    "similarly , @xmath159 denotes the subtree of all the feasible orders in which bubble @xmath160 crosses the intersection first , @xmath161 second , and so on , until bubble @xmath162 is the @xmath163 to cross , with the order of the remaining bubbles undetermined .",
    "our next step is to provide a way to determine a lower bound on the achievable optimal value of any given branch .",
    "this follows from the observation that ( i ) the execution of the ` bubble velocity optimization`algorithm finds the optimal value of the average velocity a bubble given the order of _ all _ the bubbles preceding it , but ( ii ) one can compute an upper bound for the optimal value even if only part of the order of bubbles preceding it is known . the description in algorithm  [ algo : update - hilim ] of this procedure , termed ` bounding optimal bubble velocity`algorithm , relies on four ordered lists , termed queues , one for each branch .",
    "@xmath164 compute @xmath165 using ` bubble velocity optimization`with input @xmath112 @xmath166 @xmath167 @xmath168 @xmath169 @xmath170 @xmath171    the queue for branch @xmath52 , @xmath172 , is initialized to the list of all the bubbles on branch @xmath52 in their order of arrival ( thus @xmath173 for all @xmath174 ) .",
    "we denote by @xmath175 the upper bound on the average velocity @xmath114 of bubble @xmath29 obtained by algorithm  [ algo : update - hilim ] given that a non - empty @xmath112 precedes it .",
    "this allows us to lower bound the optimal cost for any order in the subtree @xmath112 in terms of @xmath176 and @xmath175 as follows , @xmath177 this lower bound is precisely what is required to implement a branch - and - bound algorithm to find the optimal schedule for the bubbles .",
    "specifically , the branch - and - bound algorithm starts by picking an arbitrary candidate order and computing the cost for it , using the ` bubble velocity optimization`algorithm , and storing the two as the current best solution and cost .",
    "then , starting at the root node of the tree of all feasible orders , the algorithm searches ( e.g. , using depth - first or breadth - first search ) for an optimal solution .",
    "if at any time a leaf node , which corresponds to a fully determined order , is reached and its cost is better than the current best , then the current best solution and cost are updated . for any other node @xmath112 in the tree ,",
    "provides a lower bound @xmath178 on the cost of all the orders represented by the node @xmath112 .",
    "if @xmath178 is greater than the current best known cost , then the subtree @xmath112 is discarded .",
    "this process continues until the algorithm finds the optimal solution .",
    "we refer to this process as the ` schedule optimization`algorithm .",
    "the local vehicular control component of our hierarchical - distributed coordination approach involves two main tasks : ( i ) compute , for each bubble @xmath29 , the lower @xmath130 and upper @xmath131 average velocity bounds , and the upper bound on the intersection occupancy time @xmath58 that are provided to the scheduler ; and ( ii ) control the vehicles ensuring no collisions and that all the vehicles of bubble @xmath29 cross the intersection within the time interval @xmath179 $ ] prescribed by the scheduler . the successful execution of each of these tasks requires an understanding of the vehicle dynamics and the desired safety constraints and the effect of each on the other .",
    "the following notion of safe - following distance is particularly useful in our forthcoming developments .    _",
    "( safe - following distance)._[dfn : sfd ] the maximum braking maneuver ( mbm ) of a vehicle is a control action that sets its acceleration to @xmath21 until the vehicle comes to a stop , at which point its acceleration is set to @xmath180 thereafter .",
    "let @xmath181 and @xmath14 be the indices of two vehicles on the same branch , with vehicle @xmath14 immediately following @xmath181 .",
    "we say a quantity @xmath182 is _ a safe - following distance _ at time  @xmath42 for the pair of vehicles @xmath181 and @xmath14 if @xmath183 and , if each of the two vehicles were to perform the mbm , then the two vehicles would be safely separated , @xmath184 ( recall that @xmath32 is the vehicle length ) until they come to a complete stop .    according to this definition , a safe - following distance is not uniquely defined , which in fact provides a certain leeway in designing the local vehicle control .",
    "the following result identifies a specific safe - following distance .    _",
    "( safe - following distance as a function of vehicle velocities)._[lem : sf - dist ] let @xmath181 and @xmath14 be a pair of vehicles , with @xmath14 following @xmath181 . then , the continuous function  @xmath185 defined by @xmath186 provides a safe - following distance at time  @xmath42 for the pair of vehicles @xmath181 and  @xmath14 .    if a vehicle @xmath14 with dynamics   were to decelerate at the maximum rate possible ( acceleration equal to @xmath187 ) from current time @xmath42 until it comes to a complete stop at @xmath188 , then @xmath189 if @xmath190 , then the safe - following distance is found by setting @xmath191 if on the other hand @xmath192 , then the vehicles are in fact closest at time @xmath42 and the condition @xmath193 is sufficient to ensure subsequent safety .",
    "hence   provides a safe following distance .    _",
    "( monotonicity properties of @xmath185 ) .",
    "_ if the first argument of the function @xmath185 is fixed , then it is monotonically non - decreasing . on the other hand ,",
    "if the second argument is fixed then the function is monotonically non - increasing .",
    "recall that @xmath114 is the average velocity of the lead vehicle of bubble @xmath29 from @xmath49 and until the lead vehicle is supposed to reach the beginning of the intersection at @xmath73 .",
    "thus , it would seem that computing lower and upper bounds on the achievable average velocity of the lead vehicle in the bubble is sufficient to determine @xmath131 and @xmath130 .",
    "however , ignoring the initial conditions of the other vehicles in the bubble in the computation of @xmath131 and @xmath130 poses the risk of lengthening the guaranteed upper bound @xmath58 on the occupancy time .",
    "the reasoning for this is better explained in terms of earliest times of approach at the intersection of the vehicles .    in bubble @xmath29",
    ", we let @xmath194 be the earliest time vehicle @xmath28 can reach the intersection ignoring the other vehicles on the branch . letting @xmath195",
    "be the time at which bubble @xmath29 was last scheduled , the quantity @xmath196 is then the time it takes @xmath197 to reach @xmath180 from @xmath198 for the trajectory with maximum acceleration until @xmath199 and zero acceleration thereafter .",
    "thus , we see that if @xmath194 for some @xmath200 is significantly greater than @xmath201 then the vehicle @xmath67 has to slow down to approach the intersection at a time later than @xmath201 so that the guaranteed upper bound @xmath58 on the occupancy time is small enough .",
    "thus , we propose the following alternative solution . assuming a nominal speed @xmath202 for vehicles when entering the intersection , we set @xmath203 , which has the connotation of a safe inter - vehicle distance given a vehicle is traveling at the maximum allowed speed @xmath39 and the vehicle preceding it traveling at a speed greater than or equal to @xmath202 .",
    "then , we also define @xmath204 as the _ nominal inter - vehicle approach time_. with this nominal inter - vehicle approach times of vehicles in a bubble we see that the earliest time of approach for vehicle @xmath28 forces the earliest time of approach of bubble @xmath29 , i.e. vehicle @xmath67 , is no less than @xmath205 . hence , we define _ earliest time of approach _ for the bubble @xmath29 , @xmath206 as @xmath207 and let @xmath208 .",
    "analogous computations with maximum deceleration yield the _ latest time of approach _",
    "@xmath209 of bubble @xmath29 , possibly with @xmath210 , and the corresponding lower bound @xmath211 for the average velocity .",
    "hence , the values we obtain in this way for @xmath130 and @xmath131 are , respectively , larger and smaller than the ones we would have obtained if we only took into account the lead vehicle of the bubble .    for a given upper bound on the occupancy time and the sets of @xmath130 and @xmath131 for @xmath118 ,",
    "a feasible schedule might not always exist .",
    "thus , to guarantee the feasibility of the scheduling problem in a simple fashion , we assume that the exit zone length @xmath82 is large enough .",
    "specifically , we make the following observation .    _ ( existence of a feasible schedule)._[lem : zone - length - assump ] if the exit zone length , @xmath212 , then there always exists a feasible schedule with which each vehicle is able to enter the intersection with a speed of at least @xmath202 .",
    "recall , that a schedule to a bubble is assigned when all the vehicles in the bubble are still in the staging or the mid zones .",
    "clearly , the condition on @xmath82 implies that any vehicle in the staging zone or the mid zone ( @xmath213 ) can come to a complete stop and then accelerate to a speed of at least @xmath202 before arriving at the beginning of the intersection ( @xmath214 ) .",
    "the scheduler prescribes for each bubble a time at which the vehicles in the bubble may start to cross the intersection .",
    "the local vehicular control must ensure that the vehicles of bubble @xmath29 start and finish crossing the intersection within the time interval @xmath215 $ ] while respecting the safety constraints  . in this section",
    ", we describe an algorithm to achieve this task .",
    "the algorithm has three main parts : ( i ) an uncoupled controller ensuring that the vehicle arrives at the intersection at a designated time if the presence of all other vehicles is ignored .",
    "this controller is applied when the preceding vehicle is sufficiently far in front , ( ii ) a safe - following controller ensuring that the vehicle follows the preceding vehicle safely when the latter is not sufficiently far in front ; and ( iii ) a rule to switch between the two controllers .      for each vehicle @xmath216 in bubble @xmath29 , we define , @xmath217 given the constraints that the scheduler takes into account , we have @xmath218 $ ] .",
    "this , together with  , implies that @xmath219 $ ] .",
    "now , let @xmath220 be a feedback controller that ensures @xmath221 for the dynamics   starting from the current state @xmath222 at time @xmath42 ( assuming feasibility ) , respecting the control and velocity constraints , but not necessarily the inter - vehicle safety constraints .",
    "we refer to it as the _ uncoupled _ controller .",
    "such a controller exists for each vehicle at least at @xmath223 , where @xmath195 is the time at which bubble @xmath29 was scheduled , due to the fact that @xmath224 $ ] . here",
    ", we take as @xmath225 the optimal feedback controller that generates velocity profiles as shown in figure  [ fig : pwc - control ] obtained by optimizing @xmath226 with optimization variables @xmath227 , @xmath228 ( the areas of the indicated triangles ) , @xmath229 , @xmath230 and @xmath231 , where we have dropped the bubble index @xmath29 .",
    "the constraints are @xmath232 $ ] , @xmath233 $ ] , @xmath234 $ ] , @xmath235 and that the total area under the curve must be equal to @xmath236 . the feedback controller may be found by tabulating the optimal control solution .    _",
    "( optimality of the controller)._[rem : optim - pwc ] assuming there exists a feasible controller that ensures the vehicle @xmath28 approaches the intersection at @xmath237 with a minimum velocity of @xmath202 , ignoring any other vehicles on the branch and given the current time @xmath42 and the vehicle state @xmath222 , then there exists an optimal solution with piecewise - constant - rate velocity profiles as shown in figure  [ fig : pwc - control ] .",
    "we can see this statement to be true by observing that in a given time @xmath238 , the minimum and maximum travel distances are obtained with velocity profiles belonging to the family depicted in figure  [ fig : pwc - control ] , and that every other intermediate travel distance is obtained by a continuous variation of the velocity profiles within the family .",
    "note that the control @xmath225 assumes the presence of no other vehicles on the branch .",
    "thus , the actual approach time , @xmath239 , of the vehicle @xmath28 may be later than @xmath237 . at time",
    "@xmath65 , when the bubble is scheduled , an optimal control @xmath225 does exist for each of its vehicles because of the way the times @xmath237 are defined in  . however , at a future time @xmath42 , such a feasible @xmath225 might not exist because the vehicle is slowed down by preceding vehicles and no control exists to ensure @xmath240 along with the other constraints .",
    "additionally , for @xmath241 , i.e. , after the vehicle enters the intersection , the optimal controller is not well defined and does not exist . as a shorthand notation , we use @xmath242 ( respectively @xmath243 ) to denote the existence ( respectively , lack thereof ) of an optimal control @xmath225 . in order for the control @xmath225 to be well defined at all times",
    ", we let @xmath244      as mentioned earlier , this controller is applied only when a vehicle is sufficiently close to the vehicle preceding it . besides maintaining a safe - following distance , the controller must also ensure that the resulting evolution of the vehicles in the bubble @xmath29 is such that the occupancy time is no more than @xmath58 . here",
    ", we present a design to achieve these goals . for a pair of vehicles @xmath181 and",
    "@xmath14 , with @xmath14 following @xmath181 , we define the _ safety ratio _ as @xmath245 which is the ratio of the actual inter - vehicle distance to the safe - following distance . hence",
    ", we would like to maintain this quantity above @xmath133 at all times .",
    "notice from   that if @xmath246 , then @xmath247 increases and safety is guaranteed .",
    "thus , it is sufficient to design a controller that ensures safe following when @xmath248 . for vehicle @xmath14 ,",
    "we denote @xmath249 .",
    "define the _ unsaturated _ controller  @xmath250 by @xmath251 the rationale behind this definition is as follows . as mentioned above , it is sufficient to design a controller that ensures safe following when @xmath248 . thus , if @xmath252 then we need to consider only the case of @xmath253 . in this case , the definition of @xmath250 ensures that the vehicle @xmath14 stays at rest as long as vehicle @xmath181 is at rest and starts moving only when @xmath181 starts moving again .",
    "further , since the relative velocity and acceleration in this case would be zero , we see that @xmath247 stays constant . as we see more thoroughly in the sequel ,",
    "if the vehicle is moving , @xmath254 , then @xmath225 ensures that @xmath247 stays constant and thus ensuring safety .",
    "however , in the second case , @xmath250 might cause @xmath255 to exceed @xmath39 .",
    "further , we would like the vehicle to continue using the optimal uncoupled controller if it does not affect the safety by decreasing @xmath247 .",
    "these considerations motivate our definition of the _ safe - following _ controller as @xmath256      here , we design the local vehicle controller by specifying a rule to switch between the uncoupled controller @xmath225 and the safe - following controller  @xmath257 . to make precise whether two vehicles are sufficiently far from each other , we introduce the _ coupling set _",
    "@xmath258 defined by @xmath259 \\",
    "} , \\ ] ] with @xmath260 a design parameter . intuitively , if @xmath261 , then vehicle @xmath14 is going at least as fast as the vehicle in front of it , and their safety ratio is close to @xmath133",
    ". with this in mind",
    ", we define the ` local vehicular`controller for vehicle @xmath14 , @xmath262_{u_m}^0 , & \\text{if } \\zeta_j \\notin { \\mathcal{c}}_s , \\ { v^v}_j = v^m ,      \\\\      { g_{sf } } , & \\text{if } \\zeta_j \\in { \\mathcal{c}}_s , \\ { v^v}_j < v^m ,      \\\\      [ { g_{sf}}]_{u_m}^0 , & \\text{if } \\zeta_j \\in { \\mathcal{c}}_s , \\ { v^v}_j = v^m .",
    "\\end{cases}\\end{aligned}\\ ] ] note that @xmath263_{u_m}^0 \\neq { g_{uc}}$ ] only if @xmath264 .",
    "this controller has the vehicle use the safe - following controller when in the coupling set , and the uncoupled controller otherwise .",
    "the following result describes some features of the dynamical behavior of vehicles under   when in the coupling set .    _",
    "( vehicle behavior in the coupling set)._[lem : coupling - set ] for some @xmath42 , let @xmath265 and @xmath266 $ ] .",
    "then , the following hold :    1 .   @xmath267 $ ] , 2 .   if @xmath268 and @xmath269 or if @xmath270 and @xmath271_{u_m}^0 =      { g_{us}}(\\zeta_j , { u^v}_{j-1})$ ] , then @xmath272 , 3 .   if @xmath273 and @xmath274 , then @xmath272 and @xmath275 , 4 .   if @xmath270 , then @xmath276_{u_m}^0 = 0 $ ] only if @xmath277    for the sake of conciseness , we drop the arguments of the functions wherever it causes no confusion .",
    "\\(i ) for @xmath252 , the claim readily follows from the definition of @xmath250 . for fixed @xmath278 , @xmath279 and @xmath254",
    ", we see that @xmath250 is maximized and minimized when @xmath280 and @xmath281 , respectively .",
    "the result then follows by observing , after some computations , that @xmath282 and @xmath283 .",
    "\\(ii ) and ( iii ) from   observe that @xmath284 where we have used the fact that @xmath285 in the coupling set  @xmath258 . claim  ( ii ) now follows by substituting @xmath286 and using the definition of @xmath250 .",
    "a similar argument can be used to show claim  ( iii ) .",
    "\\(iv ) setting @xmath270 in the definition of @xmath250 and using the fact that @xmath287 , we have @xmath288 to obtain the necessary condition on @xmath289 , we set @xmath290 and @xmath291 , the maximum values for each",
    ".    in lemma  [ lem : coupling - set ] , claim ( i ) states that @xmath250 respects the control constraints .",
    "claims ( ii ) and ( iii ) give some sufficient conditions for ensuring the safety ratio @xmath247 is constant . claim ( iii ) also states that the relative acceleration , and hence also the relative velocity , stays zero .",
    "finally , claim ( iv ) is a necessary condition on the velocity of vehicle @xmath181 for @xmath250 and the saturated @xmath292_{u_m}^0 $ ] to differ .",
    "the following result states that if at any instant in time the optimal controller does not exist ( because the vehicle has been slowed down by preceding vehicles ) , then a vehicle not in the coupling set moves at the maximum speed .",
    "_ ( vehicle exits the coupling set at maximum speed if the optimal controller does not exist)._[lem : not - in - coupling - set ] let @xmath293 be any time such that @xmath294 and @xmath295 for @xmath296 for some @xmath297 . if @xmath264 at time  @xmath293 , then @xmath298 for all @xmath299 .    under the hypotheses of the result , and as a consequence of lemma  [ lem : coupling - set](iii ) , the only way @xmath300 is possible is if @xmath301 at @xmath293 , i.e. , @xmath302 . however , by assumption @xmath264 at time @xmath293 .",
    "thus , it follows that @xmath303 . by definition of @xmath293",
    ", we then conclude that @xmath304 .",
    "next , at @xmath293 , since @xmath264 it means @xmath305 and thus @xmath306",
    ". then , from ( ii ) , we see that @xmath307 is not possible and that in fact @xmath308 and @xmath309_{u_m}^0 = 0 $ ] . during the interval @xmath310 , we see from the second case of   that @xmath311_{u_m}^0 = [ u_m    ] _ { u_m}^0 = 0 $ ] , which proves the result .",
    "the last element of the design is the upper bound on the guaranteed occupancy time for a bubble . to obtain this , we first upper bound the inter - approach times of vehicles in a given bubble at the beginning of the intersection .    _",
    "( upper bound on the inter - approach times of vehicles in a bubble at the intersection ) .",
    "_ [ prop : int - app - times ] for any bubble @xmath29 and any vehicle @xmath312 , if @xmath313 , then @xmath314 and @xmath315 is upper bounded by @xmath316 where @xmath317 is defined in lemma  [ lem : coupling - set](iv ) and @xmath318    first notice from   that @xmath319 , for all @xmath42 such that @xmath320",
    ". further notice that if at some time @xmath293 , @xmath321 then it remains @xmath321 for all @xmath322 for otherwise it means there exists some control policy starting from @xmath323 such that @xmath324 and @xmath325 and remark  [ rem : optim - pwc ] guarantees @xmath320 at @xmath326 .",
    "thus , for each vehicle @xmath28 , @xmath327 .",
    "now , there are two cases - ether the optimal controller exists until the vehicle reaches the intersection or it becomes infeasible earlier .",
    "we consider each of these cases separately . in the first case ,",
    "notice that for any vehicle @xmath28 , for @xmath328 , if @xmath320 at @xmath329 , then it follows from the definition of @xmath239 that @xmath324 and @xmath330 and from  , we have that @xmath331 .",
    "now , we only need to be concerned about the case @xmath332 first occurring at some time @xmath333 . from now",
    ", we also drop the bubble index @xmath29 . clearly , at time @xmath334 , @xmath335 .",
    "now , there are two sub - cases - either @xmath336 or @xmath337 . in the first sub - case",
    ", we have by definition that @xmath338 and @xmath339 .",
    "then , the fact that @xmath340 for all @xmath341 implies @xmath342 where we have used the definition of @xmath343 and the monotonicity properties of the safe - following distance function @xmath185 in arriving at the inequality .",
    "now , imagine a virtual particle rigidly fixed to vehicle @xmath181 at a distance of @xmath344 behind it .",
    "since @xmath340 for all @xmath341 , we can then conclude that @xmath345 .",
    "finally , we are left with the sub - case when @xmath346 . thus ,",
    "suppose that there exists @xmath347 such that @xmath295 for all @xmath348 $ ] , and @xmath349 .",
    "from lemma  [ lem : not - in - coupling - set ] , it follows that @xmath350 for all @xmath351 $ ] .",
    "next , by the definition of @xmath352 , note that @xmath353 and @xmath354 for all @xmath348 $ ] .",
    "also , notice from lemma  [ lem : coupling - set](ii)-(iv ) that @xmath355 .",
    "thus , @xmath356 where the first inequality follows from the fact that @xmath357 for all @xmath351 $ ] . consequently ,",
    "if @xmath358 , then @xmath359 and hence we deduce @xmath360 .",
    "if on the other hand @xmath361 , then the bound on @xmath362 can be further improved by the following argument . since by design @xmath363 , for @xmath364 it takes a non - zero time for vehicle @xmath181 to reach the intersection during which the relative distance @xmath365 decreases by at least @xmath366 .",
    "thus , we see that @xmath367 .",
    "the result now follows by noting that @xmath368 attains its maximum at @xmath369 , and hence , @xmath370 .    as a consequence of proposition  [ prop : int - app - times ]",
    ", we can guarantee an upper bound on the intersection occupancy time of a bubble .    _",
    "( guaranteed upper bound on occupancy time of a bubble)._[cor : occ - time ] for any bubble  @xmath29 , its occupancy time  @xmath57 is upper bounded as @xmath371 , where @xmath372    from proposition  [ prop : int - app - times ] , we see that the last vehicle @xmath56 in bubble @xmath29 approaches the intersection at time @xmath373 satisfying @xmath374 . since each vehicle travels with a velocity of at least @xmath202 after approaching the intersection , the vehicle @xmath68 ( and thus the bubble @xmath29 ) exits the intersection no later than @xmath375 .",
    "the reasoning for the inclusion of @xmath376 in the second term of   is as follows .",
    "if the bubble @xmath71 that uses the intersection immediately after bubble @xmath29 is from the same branch as @xmath29 , then we would like to have a safe - following distance between the last vehicle @xmath68 of bubble @xmath29 and the first vehicle @xmath377 of bubble @xmath71 at the time the vehicle @xmath377 approaches the intersection at its assigned time , @xmath378 .",
    "this section brings together the discussion above on the individual aspects ( dynamic vehicle clustering into bubbles , optimized planning and scheduling of the bubbles , and local distributed control for safety and execution of plans ) of our hierarchical - distributed coordination approach to intersection traffic .",
    "the following result shows that the design ensures vehicle safety and satisfies the prescribed schedule .    _",
    "( provably safe optimized traffic coordination)._[thm : sf - control ] consider a traffic intersection with four incoming branches operating under assumptions ( i)-(v ) in section  [ sec : problem - statement ] , where the vehicle dynamics are given by   under the ` local vehicular ` controller  .",
    "assume the exit zone length satisfies @xmath379 and that , at initial time @xmath380 , vehicles on each branch @xmath381 are within the staging zone . furthermore , suppose that at each @xmath88 for each @xmath382 , the vehicles in the staging zone that are clustered by the ` clustering into bubbles`algorithm are in a safe configuration ( @xmath383 for each new vehicle @xmath14 ) .",
    "then ,    1 .",
    "each vehicle belongs to some cluster , each bubble is scheduled by the ` schedule optimization`algorithm at least once . moreover , at each @xmath49 , this strategy optimizes the schedule of the bubbles @xmath101 given by the ` clustering into bubbles`algorithm by minimizing the simplified cost function @xmath384 , 2 .",
    "the schedule assigned to the bubbles respects the non - collision constraints  , with the occupancy time of each bubble @xmath29 upper bounded by @xmath58 as given in  , 3 .",
    "inter - vehicle safety is ensured ( @xmath278 ) for all vehicles and for all time subsequent to @xmath385 , and 4 .",
    "the first vehicle @xmath67 of each bubble @xmath29 approaches the intersection at @xmath73 , the bubble uses the intersection only within its allotted time interval @xmath386 $ ] , and each vehicle travels with a velocity of at least @xmath202 after approaching the intersection .",
    "\\(i ) this claim follows from the ` clustering into bubbles`and the ` schedule optimization ` algorithms . claim ( ii ) is ensured by the inclusion of the non - collision constraints   in the ` schedule optimization`algorithm and the feasibility of the scheduling problem guaranteed by lemma  [ lem : zone - length - assump ] .",
    "\\(iii ) inter - vehicular safety is a direct consequence of lemma  [ lem : coupling - set ] - for @xmath387 $ ] , if @xmath388 , then @xmath247 either stays constant or increases ; if on the other hand @xmath389 , then it means @xmath390 and @xmath365 increases while @xmath391 stays constant at @xmath32 and thus @xmath247 increases .",
    "thus @xmath392 is guaranteed for all vehicles @xmath14 and for all @xmath393 .",
    "\\(iv ) if no bubble precedes bubble @xmath29 on its branch , then the vehicle @xmath67 approaches the intersection at its designated time @xmath394 , with at least a velocity of @xmath202 .",
    "then , by applying proposition  [ prop : int - app - times ] inductively , we see that the last vehicle @xmath68 of bubble @xmath29 approaches the intersection with a velocity of at least @xmath202 and @xmath395 and it takes at most @xmath396 amount of time to go past the intersection .",
    "thus from  , we see that claim ( iv ) is satisfied in this case .",
    "now suppose bubble @xmath63 precedes bubble @xmath29 on its branch and suppose claim ( iv ) is true for bubble @xmath63 . from our reasoning above , @xmath397 .",
    "now , using arguments analogous to those in proposition  [ prop : int - app - times ] , we see that if @xmath398 at any time @xmath399 $ ] , then we have @xmath400 .",
    "however , note from   and   that @xmath401 where in obtaining the second inequality we have used  .",
    "recall from the first paragraph of the proof of proposition  [ prop : int - app - times ] that for any vehicle @xmath28 , @xmath327 and in particular @xmath402 .",
    "thus , we conclude that @xmath403 for all time @xmath399 = [ t_s , \\tau_i]$ ] and that vehicle @xmath67 approaches the intersection at its assigned time @xmath73 with a velocity of at least @xmath202 .",
    "hence , by using induction over all vehicles in bubble @xmath29 and over all bubbles @xmath29 themselves we conclude that claim ( ii ) holds .",
    "theorem  [ thm : sf - control ] does not guarantee the optimal operation of the system at the level of individual vehicles under the proposed hierarchical - distributed coordination approach .",
    "however , this result guarantees the optimality at the level of bubbles , on each time @xmath92 , for the bubbles scheduled at  @xmath49 .",
    "we believe this is a good compromise in balancing the trade - off between optimal vehicle operation and complexity of planning and control .",
    "this section presents simulations of our proposed hierarchical - distributed design and comparisons with a signal - based traffic coordination approach under varying traffic conditions .",
    "table  [ tab : sys - par ] specifies the system parameters that we keep fixed across all the simulations presented here .",
    "l l l parameter & symbol & value +   + car length & @xmath32 & @xmath404 m + intersection length & @xmath30 & @xmath405 m + zone lengths & @xmath406 & @xmath407 m + max .",
    "speed limit & @xmath39 & @xmath408 km/h + max .",
    "@xmath22 & @xmath409m / s@xmath410 + min .",
    "& @xmath21 & @xmath411m / s@xmath410 +   + nominal speed of crossing & @xmath202 & @xmath412 km/h + parameter in   & @xmath413 & 1.2 + nominal inter - vehicle approach time & @xmath414 & @xmath415s + upper - bound on inter - vehicle approach time & @xmath376 & @xmath416s + time period for execution of algorithm  [ algo : dyn - cs ] & @xmath87 & @xmath417s + max . # new bubbles on branch @xmath52 & @xmath91 & 2 + max .",
    "# bubbles scheduled & @xmath64 & 8 +   + green - time & & 10s    the parameters @xmath414 and @xmath376 are computed parameters , while the remaining ones in the table are design choices .      in order to simulate dynamically",
    "generated traffic , new vehicles are spawned every @xmath87 units of time anywhere in the staging zone of each branch as a poisson arrival process  @xcite . in order to ensure safe following at the moment vehicle @xmath14 is spawned , we define the arrival process on @xmath247 rather than on vehicle distances . to be precise , let @xmath88 be the time at which vehicle @xmath14 is spawned .",
    "then , we let @xmath418 , with @xmath419 drawn from the distribution with probability density function @xmath420 so that @xmath383 and the distribution has a mean of @xmath421 .",
    "thus , the smaller the value of @xmath422 the greater is the density of the generated traffic .",
    "the velocity of vehicle @xmath14 at @xmath49 , @xmath423 , takes a random value uniformly chosen from the interval @xmath41 $ ] .",
    "then , the position of vehicle @xmath14 at @xmath49 , @xmath424 is obtained from   as @xmath425 where @xmath426 and @xmath427 are the position and the velocity of the last vehicle previously defined on the same branch as that of vehicle @xmath14 . if there is no previously defined vehicle on the branch , then @xmath428 .",
    "recall from section  [ sec : cluster - dyn ] that if @xmath429 , then vehicles entering the problem domain during the time interval @xmath430 $ ] are within the staging zone at  @xmath49 .",
    "this explains the imposition of the upper bound @xmath431 on @xmath424 .",
    "finally , the number of vehicles spawned on a branch at @xmath49 is determined as follows .",
    "the procedure to spawn new vehicles described above is repeated as long as the spawned vehicle is in the staging zone , i.e. , @xmath432 $ ] .",
    "the vehicle control policy in the simulations with signal - based traffic coordination is given by   with @xmath257 given by   and with @xmath433 .",
    "the traffic signaling policy is as follows - at any given time only one of the four branches has the right of way ( green or yellow signal ) .",
    "the other branches do not have a right of way ( red light ) .",
    "when the signal changes to green from red for a branch , it stays green for a period of time we call _ green - time _ and then it turns to yellow .",
    "when the signal for a branch is yellow the vehicles on that branch , which are yet to cross the intersection , are divided into two groups - those that can come to a stop before the beginning of the intersection and those that can not .",
    "for the first group of vehicles , a virtual vehicle is introduced at position @xmath32 and having a velocity of @xmath180 so that the control policy   with the added virtual vehicle ensures that the second group of vehicles comes to a stop before the intersection .",
    "the second group of vehicles continue with the usual control policy .",
    "the signal changes from yellow to red when the first group of vehicles all cross the intersection . the virtual vehicle for the branch is retained as long as the branch has yellow or red signals .",
    "the branches get the right of way in a round - robin manner .      in the first set of simulations we simulated the signal - based algorithm and",
    "the proposed hierarchical - distributed ( hd ) algorithm for different values of @xmath422 and with @xmath434 in the cost function  . for each @xmath422 ,",
    "10 trials were conducted , each for 1 minute of simulation time .",
    "the results are summarized in figure  [ fig : sim - time - compare ] .",
    "note that as per   the inter - approach times of vehicles is lower bounded by @xmath376 in our simulations , which sets a uniform upper bound on the intersection throughput of around 38 cars per minute ( cpm ) .",
    "this is the limiting factor , which explains the nearly constant throughput across @xmath422 and across different trials in figure  [ fig : hd - cpm ] .",
    "as can be seen from figure  [ fig : sig - cpm ] , the throughput in the signal - based coordination is significantly higher , at the expense of higher cost .",
    "for this reason , to have a fairer comparison , we have performed simulations with the simulation time in each trial determined by the time it takes 50 cars ( tcc ) to cross the intersection , summarized in figure  [ fig : sim - carcap - compare ] . in a loose sense",
    ", figures  [ fig : sig - cpm ] and  [ fig : sig - tcc ] on the one hand and figures  [ fig : hd - cpm ] and  [ fig : hd - tcc ] on other hand are inverted .",
    "note that both in figures  [ fig : sim - time - compare ] and  [ fig : sim - carcap - compare ] the hd algorithm performs better in terms of cost .",
    "also note the lesser dispersion in the case of the hd algorithm , which points to a more socially equitable distribution of the cost .",
    "also note that nearly steady throughput is a valuable feature for traffic management for a network of intersections , such as a city grid .",
    "figures  [ fig : tcap - comp1 ] and  [ fig : cost - comp1 ] summarize the results of simulations performed for different values of @xmath422 and @xmath48 in the cost function  , varied from @xmath435 to  @xmath436 .",
    "the throughput is consistently better in the signal - based control except for low - density traffic ( high @xmath422 ) . in terms of cost , except in the cases with very high density traffic ( low @xmath422 ) and high weightage to travel time in the cost function , the hd algorithm does better than the signal - based control . _",
    "computational expense : _ simulations presented here were performed on an intel core i3 - 3227u processor in matlab r2014a running on the linux mint 17.2 operating system . the most computationally expensive component of our design is the branch - and - bound algorithm for scheduling the bubbles . for scheduling 8 bubbles",
    ", this typically took about 1 second .",
    "next most expensive is the @xmath437means algorithm , which took about 13ms per instance .",
    "the controller @xmath225 was implemented based on an explicit solution to the optimal control problem . on average ,",
    "an instance of @xmath225 was executed in about @xmath438ms when the optimal control problem was feasible .",
    "we have studied the problem of coordinating traffic at an intersection in order to reduce travel time and improve vehicle energy efficiency while avoiding collisions .",
    "our provably correct intersection management solution relies on communication among vehicles and the infrastructure , and combines hierarchical and distributed control to optimally schedule the passage of vehicle bubbles through the intersection .",
    "our dynamic bubble - based approach has the advantage of reducing the complexity of the computationally intensive scheduling problem and making the solution applicable for different traffic conditions .",
    "simultaneously , the modular nature of the major aspects of our design make it easier to make improvements in the future .",
    "finally , since the central traffic manager at the intersection requires only aggregate data of a bubble , this decomposition provides a certain amount of privacy .",
    "we have performed simulations to illustrate the performance of our design and compared it against a traditional , signal - based intersection management approach .",
    "our hierarchical - distributed algorithm performs better than signal - based control in terms of cost except for high traffic densities and high weightage to travel time in the cost function .",
    "the guaranteed throughput is , however , worse due to the conservativeness of the upper bound on inter - approach times of the vehicles .",
    "we believe further analysis would improve this component and yield better throughput .",
    "other future work will study the computational complexity of the proposed algorithm , the characterization of the expected size of the generated bubbles , the incorporation of information about incoming traffic density to improve throughput , the inclusion of privacy preservation requirements , and the extension to coordinated management for networks of intersections .",
    "the research was supported by nsf award cns-1446891 .",
    "pavankumar tallapragada received the b.e .",
    "degree in instrumentation engineering from sggs institute of engineering @xmath439 technology , nanded , india in 2005 , m.sc .",
    "degree in instrumentation from the indian institute of science , bangalore , india in 2007 and the ph.d .",
    "degree in mechanical engineering from the university of maryland , college park in 2013 .",
    "he is currently a postdoctoral scholar in the department of mechanical and aerospace engineering at the university of california , san diego .",
    "his research interests include event - triggered control , networked control systems , distributed control and transportation and traffic systems .",
    "jorge corts received the licenciatura degree in mathematics from universidad de zaragoza , zaragoza , spain , in 1997 , and the ph.d .",
    "degree in engineering mathematics from universidad carlos iii de madrid , madrid , spain , in 2001 .",
    "he held post - doctoral positions with the university of twente , twente , the netherlands , and the university of illinois at urbana - champaign , urbana , il , usa . he was an assistant professor with the department of applied mathematics and statistics , university of california , santa cruz , ca , usa , from 2004 to 2007 .",
    "he is currently a professor in the department of mechanical and aerospace engineering , university of california , san diego , ca , usa .",
    "he is the author of geometric , control and numerical aspects of nonholonomic systems ( springer - verlag , 2002 ) and co - author ( together with f. bullo and s. martnez ) of distributed control of robotic networks ( princeton university press , 2009 ) .",
    "he is an ieee fellow and an ieee control systems society distinguished lecturer .",
    "his current research interests include distributed control , networked games , power networks , distributed optimization , spatial estimation , and geometric mechanics ."
  ],
  "abstract_text": [
    "<S> this paper considers the problem of coordinating the vehicular traffic at an intersection and on the branches leading to it for minimizing a combination of total travel time and energy consumption . </S>",
    "<S> we propose a provably safe hierarchical - distributed solution to balance computational complexity and optimality of the system operation . in our design </S>",
    "<S> , a central intersection manager communicates with vehicles heading towards the intersection , groups them into clusters ( termed bubbles ) as they appear , and determines an optimal schedule of passage through the intersection for each bubble . </S>",
    "<S> the vehicles in each bubble receive their schedule and implement local distributed control to ensure system - wide inter - vehicular safety while respecting speed and acceleration limits , conforming to the assigned schedule , and seeking to optimize their individual trajectories . </S>",
    "<S> our analysis rigorously establishes that the different aspects of the hierarchical design operate in concert and that the safety guarantees provided by the proposed design are satisfied . </S>",
    "<S> we illustrate its execution in a suite of simulations and compare its performance to traditional signal - based coordination over a wide range of system parameters .    </S>",
    "<S> intelligent transportation systems , hierarchical and distributed control , optimized operation and scheduling , state - based intersection management , networked vehicles </S>"
  ]
}