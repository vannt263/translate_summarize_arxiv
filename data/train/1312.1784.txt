{
  "article_text": [
    "the molecular dynamics simulation method based on first principles electronic structure theory is rapidly emerging as a powerful and almost universal tool in materials science , chemistry and molecular biology @xcite .",
    "a few early applications of born - oppenheimer molecular dynamics date back four decades ago @xcite and highly efficient density functional methods @xcite using plane - wave pseudopotential techniques and the fast fourier transform @xcite appeared already in the mid 80 s and early 90 s @xcite    one of the major computational obstacles in first principles born - oppenheimer molecular dynamics simulations is the iterative , non - linear , self - consistent field optimization that is required prior to the force calculations @xcite .",
    "many methods have been proposed to overcome this fundamental problem @xcite .",
    "one of the more recent approaches is based on an extended lagrangian formulation of a time - reversible born - oppenheimer molecular dynamics @xcite , which reduces the computational cost of the self - consistent field optimization while keeping the dynamics stable with respect to long - term energy conservation .",
    "extended lagrangian born - oppenheimer molecular dynamics can be used both for metallic and non - metallic materials @xcite , the integration time step is governed by the slower nuclear degrees of freedom , and it can be used in combination with fast ( non - variational ) linear scaling electronic structure solvers without causing a systematic drift in the energy @xcite . it has further been argued that extended lagrangian born - oppenheimer molecular dynamics provides a general theoretical framework for alternative forms of first principles molecular dynamics methods @xcite .",
    "the purpose of this paper is to explore some limits of the extended lagrangian formulation of born - oppenheimer molecular dynamics .",
    "our main focus is a generalization in the limit of vanishing self - consistent field optimization .",
    "this generalization has previously been investigated within self - consistent - charge tight - binding and hartree - fock theory @xcite . in this paper",
    "we further extend and explore the optimization - free limit to free - energy potential surfaces valid also at finite electronic temperatures within a general hybrid density functional theory .",
    "our proposed optimization - free dynamics requires only one diagonalization and in contrast to previous hartree - fock simulations @xcite also only one single effective hamiltonian construction per time step .",
    "this is a significant improvement over the previous hartree - fock calculations , which is made possible by using a particular linearized expression for the potential free energy .",
    "this formulation also provides a computationally simple force expression that is fully compatible with the potential energy . for normal simulations that do not encounter irregular ( non - convex ) behavior in the functional form around the self - consistent ground state ,",
    "the optimization - free dynamics yields trajectories that are practically indistinguishable from an `` exact '' born - oppenheimer molecular dynamics simulation .",
    "however , in the event of anomalous behavior that may cause numerical instabilities , the optimization - free limit nevertheless also represents a natural and efficient starting guess for more elaborate force calculations that require an iterative and improved accuracy in the electronic ground state optimization or reduced integration time steps to recover stability @xcite .",
    "the proposed optimization - free limit of extended lagrangian born - oppenheimer molecular dynamics therefore represents a flexible theoretical framework for a very broad and general class of materials simulations .",
    "extended lagrangian born - oppenheimer molecular dynamics @xcite enables a time - reversible integration of the equations of motion that improves the long - term stability of a molecular dynamics simulation , while keeping the computational cost low by reducing the number of required self - consistent field iterations . in our presentation below we will use density matrices for the electronic degrees of freedom , which is a natural choice for hybrid functionals , i.e. that is easily applicable both in hartree - fock @xcite and density functional theory @xcite .",
    "however , the approach is quite general and should be straightforward to apply also to wavefunctions and the electron density @xcite .    in our discussion we will use the term `` ground state '' density matrix and `` born - oppenheimer '' molecular dynamics also for finite temperature ensembles with thermally excited states @xcite .",
    "we use these terms since the self - consistent , fractionally occupied , ( i.e. non - idempotent ) density matrix minimizes a free energy functional that represents a straightforward generalization of regular born - oppenheimer molecular dynamics that is valid both at zero and finite electronic temperatures @xcite .",
    "the finite temperature generalization provides a useful tool for simulations of , for example , metals and warm dense matter , or simply as an ad hoc tool to avoid self - consistent field instabilities .      in time - reversible extended lagrangian born - oppenheimer",
    "molecular dynamics the regular dynamical variables for the nuclear degrees of freedom are extended with an auxiliary dynamical variable for the electronic degrees of freedom , @xmath0 , that evolves close to the optimized self - consistent electronic ground state density matrix , @xmath1 . the extended lagrangian equations of motion for the nuclear coordinates , @xmath2 , for a general free energy potential surface , @xmath3 , that are valid also at finite electronic temperatures are given by @xmath4}{\\partial r_i}},\\ ] ] where the dots denote time derivatives .",
    "the equations of motion can be integrated , for example , with the regular velocity verlet algorithm using hellmann - feynamn and pulay forces @xcite .",
    "the extended lagrangian equation of motion for the extended auxiliary electronic dynamical variable , @xmath0 , is given by a harmonic oscillator centered around the self - consistent electronic ground state density matrix , @xmath1 , where @xmath5 since @xmath6 evolves in a harmonic well that follows the ground state , @xmath7 , the dynamical variable @xmath6 will stay close to the ground state for sufficiently large values of the frequency parameter @xmath8 or small integration time steps @xmath9 .",
    "moreover , since @xmath6 is a dynamical variable it can be integrated with a time - reversible or symplectic integration scheme @xcite . in this way we can use @xmath10 as an accurate initial guess to the self - consistent - field ( scf ) optimization procedure of the ground state density matrix , where @xmath11,\\ ] ] without breaking time reversibility in the underlying electronic degrees of freedom",
    "it is thanks to this time - reversibility that the long - term conservation of the total energy is stabilized in extended lagrangian born - oppenheimer molecular dynamics even under approximate and incomplete self - consistent field convergence .    the free energy potential , @xmath3 in eq .  ( [ xl - bomd - r ] ) , is here given by @xmath12 = e[d ] -t_e { \\cal s}[d ] + u^{\\rm pair}({\\bf r}),\\ ] ] where @xmath13 is the electronic free energy at electronic temperature @xmath14 with an electronic energy , @xmath15 , and an entropy term , @xmath16 .",
    "@xmath17 is a pair potential term including ion - ion repulsions and , for example , van der waals corrections .",
    "the electronic energy term , @xmath15 , is here assumed to be described by a ( restricted ) general hybrid density functional expression , with @xmath18 = 2tr[hd ] + tr[dg^\\alpha ( d ) ] + e^{xc}[2d].\\ ] ] the matrix @xmath19 corresponds to the one - electron integrals and @xmath20 are the regular coulomb , @xmath21 , and exchange , @xmath22 , matrices in hartree - fock theory @xcite , with the exchange matrix @xmath22 scaled by a factor @xmath23 to account for hybrid functionals , i.e. @xmath24 the exchange correlation term @xmath25 $ ] can be a gradient corrected expression @xcite , a local density approximation @xcite , or other mixed functional expressions @xcite , with the electron density given by the ( doubly occupied ) density matrix , i.e. @xmath26 . the ground state density matrix , @xmath1 , which determines the potential energy surfaces for the inverse temperature @xmath27 ) , is given by the self - consistent condition @xmath28^{-1},\\ ] ] where the effective single particle hamiltonian ( or fockian ) , @xmath29 , is given by @xmath30 the orthogonalized representation of the hamiltonian , @xmath31 , in eq .",
    "( [ fermi ] ) above , is calculated through the congruence transformation , @xmath32 where @xmath33 and its transpose @xmath34 are the inverse factors of the basis set overlap matrix @xmath35 , i.e. @xmath36 and the density matrix in its non - orthogonal form is @xmath37 the chemical potential , @xmath38 , is determined to give @xmath1 the correct occupation of electrons @xmath39 , i.e.  @xmath38 is set such that @xmath40=2tr[ds]$ ] .",
    "@xmath41 in eq .",
    "( [ heff ] ) is the regular exchange correlation potential given through the functional derivative of the exchange correlation energy .",
    "@xmath41 is a functional of the electron density given by the doubly occupied density matrix .",
    "the electronic entropy term @xmath16 in eq .",
    "( [ free_es ] ) for the spin restricted case , i.e. with double occupation of each orbital , is @xmath42 = -2k_b tr\\left[d^\\perp \\ln(d^\\perp ) \\right . \\\\ ~\\\\ ~~ + \\left .",
    "( i - d^\\perp ) \\ln ( i - d^\\perp ) \\right ] , \\end{array}\\ ] ] which makes the free energy functional variationally correct at the ground state @xcite .",
    "the major computational cost of a first principles born - oppenheimer molecular dynamics simulation is the iterative self - consistent field optimization that is required prior to the force calculations .",
    "if a sufficient degree of optimization is not fulfilled , the hellmann - feynman forces are no longer accurate @xcite , which in regular born - oppenheimer molecular dynamics typically leads to a systematic drift in the total energy @xcite . only by a computationally expensive increase in the number of self - consistent field iterations",
    "is it possible to reduce this drift , though it never fully disappears .",
    "this systematic error accumulation is very unfortunate since the error in each individual force calculation often is small compared to the local truncation error caused by the finite integration time step @xmath9 .",
    "the underlying time - reversibility enabled by the extended lagrangian formulation in eqs .",
    "( [ xl - bomd - r ] ) and ( [ xl - bomd - p ] ) eliminates this problem with respect to the systematic long - term energy drift even for fairly approximate degrees of self - consistent field optimization .    in a regular leap - frog or verlet based integration of the equations of motion , eqs .",
    "( [ xl - bomd - r ] ) and ( [ xl - bomd - p ] ) , the local truncations error as measured by the amplitude of the oscillations in the total energy ( kinetic + potential ) , scales with the square of the integration time step , i.e. as @xmath43 . without a global systematic error accumulation ,",
    "the error in time - reversible extended lagrangian based born - oppenheimer molecular dynamics is thus governed only by the local truncation error @xmath43 .",
    "this gives us the opportunity to further relax the accuracy in the individual force calculations as long as any additional error is of the same order as the local truncation error .",
    "this would allow a reduction of the computational cost without any significant change in the level of accuracy .",
    "as in classical molecular dynamics simulations , the effect on the molecular trajectories should be no different than using a slightly longer ( or shorter ) integration time step .",
    "what we will demonstrate here , is that this is possible to achieve , at least under normal simulation conditions , even without any self - consistent field optimization at all prior to the force calculations .",
    "this optimization - free approach keeps the computational cost to a minimum . only one single diagonalization and hamiltonian construction per time step is required .",
    "the equations of motion , eqs .",
    "( [ xl - bomd - r ] ) and ( [ xl - bomd - p ] ) , provide the exact born - oppenheimer molecular dynamics only for the exact ground state ( gs ) density matrix , @xmath44 .",
    "since the exact self - consistent ground state in practice never can be reached , even after multiple self - consistent field iterations , we always have some small deviation , @xmath45 , from the exact solution , i.e. in real calculations @xmath46^{-1 } z^t.\\ ] ] fortunately , the variational property of the electronic free energy leads to only a minor error and @xmath47 - t_e{\\cal s}[d ] = \\\\",
    "~~\\\\ ~~ e[d_{\\rm gs } ] - t_e{\\cal s}[d_{\\rm gs } ] + { \\cal o}((d - d_{\\rm gs})^2 ) .",
    "\\end{array}\\ ] ] nevertheless , because of the broken commutation between the approximate ground state density matrix @xmath1 and @xmath48 , the hellmann - feynman force expression is not valid , which in regular born - oppenheimer molecular dynamics leads to small but systematic errors in the forces and eventually to a significant loss of long - term accuracy . within time - reversible extended lagrangian born - oppenheimer molecular dynamic , it is possible to avoid this shortcoming , even without any self - consistent field optimization at all prior to the force calculations .",
    "we achieve this by using a particular linearized approximation of the electronic free energy , @xmath49 .",
    "this linearization provides two important advantages compared to our previous hartree - fock simulations @xcite : ( a ) only one single hamiltonian ( or fockian ) construction is needed in each time step , and ( b ) the nuclear forces are computationally simple yet fully compatible with the linearlized energy expression .",
    "the linearized expression of the general hybrid free - energy functional in eq .  ( [ freee ] ) and the corresponding forces in eq .  ( [ freeforce ] ) represent the underlying theory of this paper . a detailed derivation starting with eq .  ( [ freee ] ) of the force expression in eq .",
    "( [ freeforce ] ) , which is valid to second order @xmath58 $ ] , is given in the appendix .",
    "in comparison to exact born - oppenheimer molecular dynamics , the error in both the forces and the total energy in eqs .",
    "( [ freee ] ) and ( [ freeforce ] ) should be no worse than of order @xmath59 = { \\cal o}[(d_{\\rm gs } -d)^2 ] + { \\cal o}[(d - p)^2]$ ] , assuming @xmath60 \\le { \\cal o}[(d - p)^2]$ ] .",
    "the accuracy of the optimization - free dynamics above is thus governed by an error term @xmath61 .",
    "it is therefore important to keep the auxiliary dynamical variable @xmath0 as close as possible to the ground state .",
    "since @xmath0 only moves towards the exact ground state , @xmath62 , through the harmonic oscillator centered around the approximate ground state @xmath1 , the equation of motion for the electronic degrees of freedom , eq .",
    "( [ xl - bomd - p ] ) , which formally is derived within the extended lagrangian framework for @xmath44 , will in general be unstable unless @xmath63 to enable stability in our pursued limit of only one single diagonalization per time step , we may use an approximate equations of motion for the electronic degrees of freedom , @xmath64 where @xmath65 is some improved approximation , compared to @xmath1 , of the exact ground state , i.e. @xmath66 possibly the simplest choice is a linear mixing where @xmath67 this choice leads to the same form for the equations of motion as in ( scf - optimized ) extended lagrangian born - oppenheimer molecular dynamics , @xmath68 but now with @xmath69 scaled by a constant @xmath70 . in this case",
    ", stability can be achieved whenever the functional form of @xmath71 $ ] is convex in the sense that there exist a constant @xmath72 $ ] such that @xmath73 < \\gamma { \\cal f}(d ) + ( 1-\\gamma ) { \\cal f}(p).\\ ] ] in this simple case of linear mixing , which we have used throughout all our calculations , we can therefore use the regular unoptimized equation of motion in eq .",
    "( [ xl - bomd - p ] ) , with @xmath3 defined through @xmath71 $ ] in eq .",
    "( [ freee ] ) and with @xmath69 rescaled by a factor @xmath72 $ ] .",
    "this approach is simple and straightforward and works for normal convex functional forms . in the ( rare ) event of functional anomalies , for example ,",
    "due to broken functional convexity with a self - consistent field instability , we may have to adjust the scaling factor @xmath70 , reduce the integration time step @xmath9 , use more advanced ( preconditioned ) approximations for @xmath74 , introducing an ad hoc electronic thermal smearing or revert to a more costly iterative self - consistent field optimization procedure .",
    "the automatic `` on - the - fly '' detection and development of such adaptive integration methods is an area for future research .",
    "an interesting analysis of stability and accuracy conditions of the equations of motion derived from extended lagrangian born - oppenheimer molecular dynamics can be found in a recent paper by lin et al .",
    "this paper also includes a detailed comparison between time - reversible extended lagrangian born - oppenheimer molecular dynamics and the more well - known method by car and parrinello @xcite . a key difference is their sensitivity to the electronic gap and thus the ability to simulate metallic systems , which is straightforward with extended lagrangian born - oppenheimer molecular dynamics @xcite .",
    "another difference is that the constant of motion in car - parrinello molecular dynamics includes the electronic kinetic energy .",
    "this is not the case in extended lagrangian born - oppenheimer molecular dynamics , which is formally derived in the adiabatic limit of vanishing ( zero ) electron mass .",
    "a generalized presentation of both car - parrinello and extended lagrangian born - oppenheimer molecular dynamics is also given in a recent paper by hutter @xcite .",
    "as a summary of the discussion above we have derived , based on extended lagrangian born - oppenheimer molecular dynamics , a fast quantum mechanical molecular dynamics ( fast - qmmd ) scheme that requires only one single diagonalization and hamiltonian construction per time step .",
    "the nuclear degrees of freedom is governed by @xmath75}{\\partial r_i}\\right|_p},\\ ] ] and the electronic evolution by @xmath76 the nuclear forces in eq .",
    "( [ fast - qmmd - r ] ) are given for the partial derivatives of @xmath3 with respect to nuclear coordinates @xmath57 under the condition of constant @xmath0 .",
    "the potential energy is @xmath77 = 2tr[hd ] + tr[(2d - p)g^\\alpha ( p)]\\\\ ~~\\\\ ~~ + e^{xc}[2d ] - t_e{\\cal s}[d ] + u^{\\rm pair}({\\bf r } ) , \\end{array}\\ ] ] with the corresponding forces @xmath78 = 2tr[h_rd ] +",
    "tr[(2d - p)g^\\alpha_r ( p)]\\\\ ~~\\\\ ~~+ e^{xc}_r[2d ] + 2tr[s^{-1}h(p)ds_r ] + u^{\\rm pair}_r({\\bf r } ) .",
    "\\end{array}\\ ] ] the density matrix @xmath1 at @xmath79 is @xmath80^{-1}z^t,\\ ] ] where @xmath81 as above , the congruence factor @xmath33 and its transpose @xmath34 are determined by @xmath82 , where @xmath35 is the basis - set overlap matrix .",
    "we integrate the nuclear degrees of freedom with a regular velocity - verlet scheme .",
    "the electronic equation of motion , eq .",
    "( [ fast - qmmd - p ] ) , is integrated with a modified verlet scheme @xcite that removes a possible accumulation numerical noise through a weak dissipation . for the linear mixing approximation of @xmath65 in eq .",
    "( [ linmix ] ) , this modified verlet integration is @xmath83 where the dimensionless variable @xmath84 is rescaled by the constant @xmath85 $ ] .",
    "three material independent sets of optimized coefficients for @xmath23 and @xmath86 are given in tab .",
    "[ tab_coef ] .",
    "alternative higher - order symplectic integration schemes can also be applied @xcite , but have not been used in the present study .",
    ".coefficients for the verlet integration scheme with the external dissipative force term in eq .",
    "( [ vrl_damp ] ) .",
    "the coefficients are derived in ref .",
    "@xcite , which contains a more complete set of coefficients .",
    "[ cols=\"<,<,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]",
    "the proposed fast - qmmd scheme , eqs .",
    "( [ fast - qmmd - r ] - [ vrl_damp ] ) , has been implemented in the uppsala quantum chemistry code ( uquantchem ) @xcite , which is a freely available program package for ab initio electronic structure calculations using gaussian basis set representations that can be obtained from the code s homepage @xcite .",
    "the uquantchem program includes hartree - fock theory , diffusion and variational monte carlo , configuration interaction , moller - plesset perturbation theory , density functional theory and hybrid functionals , finite temperature calculations , structural optimization and first principles molecular dynamics simulations .",
    "our fast - qmmd implementation in the uquantchem package has been carefully commented in reference to this paper in order to facilitate the implementation of the fast - qmmd scheme into a broader variety of electronic structure software .",
    "notice , that details of the implementation are very important and it may not always be straightforward to implement the fast - qmmd scheme in a regular first principles electronic structure code .",
    "all our `` exact '' born - oppenheimer molecular dynamics ( bomd ) simulations were performed based on extended lagrangian born - oppenheimer molecular dynamics , eqs .",
    "( [ xl - bomd - r ] ) and ( [ xl - bomd - p ] ) , using 5 self - consistent - field optimization cycles per time step prior to the force calculations .",
    "this choice provides a convergence in the potential free energy of about @xmath87 hartree , which is 2 - 3 orders of magnitude smaller than the oscillations in the total energy that are used in the comparisons .      in fig .",
    "[ figure_1 ] we show a comparison between our fast - qmmd , eqs .",
    "( [ fast - qmmd - r]-[vrl_damp ] ) , and self - consistent born - oppenheimer molecular dynamics with respect to the fluctuations in the total energy ( kinetic + potential ) , i.e. the local truncation error , for simulations of a single water molecule .",
    "we have used three different levels of density functional theory : a ) the local density approximation ( lda ) @xcite , b ) the gradient corrected approximation ( pbe ) @xcite , and c ) a hybrid functional ( b3lyp ) @xcite . in all cases",
    "we find that the total energy fluctuations , @xmath88 behave in a very similar way .",
    "for the fast - qmmd simulations we used the potential energy expression of @xmath89 in eq .",
    "( [ fast - qmmd - freee ] ) to estimate the total energy .",
    "total energy fluctuations ( kinetic + potential ) for water using self - consistent born - oppenheimer molecular dynamics ( bomd ) , and the first principles fast - qmmd , eq .  (",
    "[ fast - qmmd - r]-[vrl_damp ] ) . for the fast - qmmd simulation we used the electronic free energy expression in eq .",
    "( [ fast - qmmd - freee ] ) in the total energy estimates .",
    "all calculations were performed with the modified verlet integration ( @xmath22 = 7 in table [ tab_coef ] ) and rescaling of @xmath84 with a factor @xmath70 = 0.7 .",
    "the time step used was 10 a.u . ]    in the next figure , fig .",
    "[ figure_2 ] ( a ) , we show interatomic distances between self - consistent born - oppenheimer molecular dynamics and our proposed fast - qmmd scheme for a c@xmath90h@xmath91 molecule using the local density approximation .",
    "the upper panel shows virtually no difference between the fast optimization - free scheme and the optimized `` exact '' born - oppenheimer simulation .",
    "the curves are essentially on top of each other even after 500 fs of simulation time . for any chaotic dynamical system like this",
    ", the curves will eventually diverge due to any infinitesimal perturbation .",
    "the lower panel , fig .",
    "[ figure_2 ] ( b ) , shows an example of the interatomic c - f distance in a cf@xmath92 molecule .",
    "here we use a four times longer integration time step , @xmath9 = 40 a.u . , and we find a small shift in the frequency that is visible after a few hundred time step . for the first 100 - 200 fs of simulation time the curves are very close .    interatomic distances calculated using self - consistent born - oppenheimer molecular dynamics ( bomd ) , and the first principles fast - qmmd , eq .",
    "( [ fast - qmmd - r]-[vrl_damp ] ) . in ( a )",
    ", the interatomic distance between the carbon atoms , r@xmath93 , in a c@xmath94h@xmath95 molecule is displayed . in ( b ) , the interatomic distance between the carbon atom and one of the fluorine atoms , r@xmath96 , in a cf@xmath97 molecule is displayed . in ( a ) the lda density functional @xcite together with a sto-3 g basis - set and a 10 a.u .",
    "time step was used . in",
    "( b ) the pbe density functional @xcite together with a 6 - 31g@xmath98 basis - set and a 40 a.u .",
    "time step was used .",
    "the ethan calculations were performed with a modified verlet integration ( @xmath22 = 7 in table [ tab_coef ] ) and rescaling of @xmath84 with a factor @xmath70 = 0.7 .",
    "the cf@xmath97 calculations were performed with a modified verlet integration ( @xmath22 = 7 in table [ tab_coef ] ) and rescaling of @xmath84 with a factor @xmath70 = 0.54 . ]    total energy including internal energy ( @xmath15 ) and free energy ( @xmath99 ) for water using self - consistent born - oppenheimer molecular dynamics ( bomd ) , and the first principles fast - qmmd , eq .",
    "( [ fast - qmmd - r]-[fast - qmmd - p ] ) . in ( a )",
    "the lda density functional @xcite was used , in ( b ) the pbe @xcite density functional was used and in ( c ) the hybrid b3lyp @xcite density functional was used . all the calculation was performed with the modified verlet integration ( using @xmath22 = 7 in table [ tab_coef ] ) and a rescaling of @xmath84 using a factor @xmath70 = 0.7 . ]    in ( a ) the total internal and free energy of a fast - qmmd calculation of a small lithium cluster ( li@xmath100 ) with a 0.62 ev energy band - gap using the lda density functional @xcite , here compared to the corresponding self - consistent born - oppenheimer molecular dynamics ( bomd ) calculation . in ( b ) , the distance between two lithium atoms calculated with the fast - qmmd scheme is compared to the same distances obtained with the born - oppenheimer molecular dynamics ( bomd ) calculation . the the integrations were performed with a time step of 10 a.u . using a modified verlet scheme ( with @xmath22 = 5 in table [ tab_coef ] ) and rescaling of a @xmath84 with a factor @xmath70 = 0.27 . ]",
    "total energy fluctuations for c@xmath94h@xmath95 for rotational and vibrational dynamics in ( a ) and pure vibrational dynamics in ( b ) , using self - consistent born - oppenheimer molecular dynamics ( bomd ) , and the first principles fast - qmmd , eq .",
    "( [ fast - qmmd - r]-[fast - qmmd - p ] ) utilizing the lda density functional @xcite .",
    "all calculations were the integrations were performed with a time step of 10 a.u . using the modified verlet algorithm ( with @xmath22 = 7 in table [ tab_coef ] ) , and a rescaling of @xmath84 with a factor @xmath70 = 0.7 . ]",
    "the local truncation error in a fast - qmmd calculation utilizing the linearized energy expression , eq .",
    "( [ fast - qmmd - freee ] ) , and force expression , eq .",
    "( [ fast - qmmd - force ] ) , for vibrational motion of methane for different time - steps . in ( a )",
    "compared to the corresponding `` exact '' ( 5 scf / step ) born - oppenheimer molecular dynamics ( bomd ) calculations , and in ( b ) compared to a fast - qmmd calculation using the corresponding `` non - linearized '' optimization - free energy and force expressions used in the previous study @xcite . here",
    "the pbe functional @xcite was used together with a sto-3 g basis - set .",
    "all calculations were performed with a modified verlet scheme ( using @xmath22 = 7 in table [ tab_coef ] ) and a rescaling of @xmath84 with a factor @xmath70 = 0.7 . ]",
    "figure [ figure_3 ] illustrates the total energy conservation with ( @xmath101 ) and without ( @xmath15 ) the electronic entropy contribution . at an electronic temperature of 10,000",
    "k the fluctuations in total energy decrease by 1 - 2 orders of magnitude when the electronic entropy contribution is included .",
    "this high resolution could be critical in order to resolve small differences in the free energy between competing phases .",
    "here it mainly illustrates that the constant of motion behaves as expected .    because of the large homo - lumo gap of the water system in fig .",
    "[ figure_3 ] , a fairly high temperature is needed to illustrate the electronic temperature effect . in fig .",
    "[ figure_4 ] we show the corresponding finite temperature result for a small lithium cluster ( li@xmath102 ) . in the restricted calculation of a system with an odd number of electrons , the highest occupied state has an occupation factor of @xmath103 and the entropy contribution is thus significant even at a fairly low electronic temperature ( @xmath104 k ) , as is seen in the upper panel ( a ) .",
    "this example also illustrated the ability of the fast - qmmd scheme to simulate systems that may have significant problems to reach the self - consistent ground state .",
    "the lower panel shows the interatomic distance between two li atoms .",
    "the fast - qmmd scheme provides molecular trajectories that are virtually on top of the born - oppenheimer result for over 4 ps of simulation time .",
    "it may appear that the fast - qmmd scheme is almost identical to an `` exact '' fully converged born - oppenheimer simulation .",
    "however , there is a subtle difference in the behavior of the local truncation error .",
    "consider a pure translational motion of a molecular system . in this case",
    "there will be no transfer of energy from the kinetic to the potential energy .",
    "given an atom centered basis set , the electronic ground state density matrix will remain constant and the local truncation error , i.e. the error in the ability to account for the correct energy transfer between kinetic and potential energy , will effectively be zero , both for a fast - qmmd and a born - oppenheimer simulation .",
    "this is not the case for a vibrational motion , where both fast - qmmd and born - oppenheimer simulations will have local truncation errors due to the finite integration time step and fail to exactly account for the balance in energy transfer between kinetic and potential energy .",
    "however , for rotational motion a difference appears between fast - qmmd and born - oppenheimer molecular dynamics simulations . as for a pure translational motion ,",
    "a pure rotational mode has no energy transfer of kinetic energy . nevertheless , since the matrix representation of the ground state density matrix change between time steps for a rotational motion",
    ", the fast - qmmd will show some small changes in the total energy due to the rotation , which will be absent in an `` exact '' born - oppenheimer simulation .",
    "figure [ figure_5 ] illustrates this behavior . in the upper panel ( a ) , which has a superposed vibrational and rotational motion",
    ", we find an additional oscillatory motion in the total energy of the fast - qmmd simulation compared to the born - oppenheimer simulation .",
    "this qualitative difference is not found in the lower panel ( b ) , which only has a pure vibrational motion .",
    "for the general case of composite motion , we therefore expect fast - qmmd simulations to have a slightly increased local truncation error compared to an `` exact '' fully converged born - oppenheimer simulation",
    ".      the sensitivity to the integration time step @xmath9 could potentially be a limiting factor for the fast - qmmd scheme .",
    "figure [ figure_6 ] ( a ) shows the local truncation error ( measured by the amplitude of the oscillations of the total energy ) as a function of the length of the time step @xmath9 for fast - qmmd and born - oppenheimer simulations of a single methane molecule at room temperature .",
    "the two curves both scale as @xmath43 , where the fast - qmmd truncation errors are slightly smaller than the bomd errors all the way up to @xmath105 a.u .",
    "( about 1 fs ) , where a small shift appears .",
    "just as in a classical molecular dynamics simulation , the local truncation error is governed by the size of a _ tunable _ integration time step and not by the number of self - consistent field iterations .",
    "the general validity of this result is hard to judge , but the behavior in fig .",
    "[ figure_6 ] ( a ) is consistent with what we have found so far in our simulations and can be expected to hold as long as there are no inherent self - consistent field instabilities or anomalous ( non - convex ) functional behavior .      in fig .",
    "[ figure_6 ] ( b ) we show a comparison of the local truncation error as a function of the integration time step , @xmath9 , between our fast - qmmd using the linearized energy and force expression , eqs .",
    "( [ fast - qmmd - r]-[vrl_damp ] ) , and the corresponding fast - qmmd based on a `` non - linearized '' potential energy that was used in our previous hartree - fock simulations @xcite .",
    "both methods require only one diagonalization per time step , but in contrast to the new linearized scheme , the previous method requires two full constructions of the effective hamiltonian in each time step and the forces are approximate . the linearized version of the fast - qmmd scheme yields slightly smaller local truncation errors compared to the non - linearized version all the way up to a time - step , @xmath106 40 a.u .",
    "( @xmath107 fs ) above which the linearized formulation starts to diverge .",
    "we believe this improved behavior can be explained by the consistency between the forces and the potential energy for the linearized expression , which is valid as long as the linearization is sufficiently accurate , i.e. for @xmath108 40 a.u . for normal simulations , with time steps of about 10 - 30 a.u .",
    ", the stability and accuracy of the two approaches are comparable , but thanks to the lower complexity of the linearized approach , with only one hamiltonian construction per time step , our new scheme represents a significant improvement .",
    "the fast - qmmd scheme is robust to sudden perturbations .",
    "figure [ figure_7 ] shows the total energy of a simulated water molecule . after about 2.4 ps of simulation time",
    "an abrupt significant change in the density matrix @xmath109 is introduced . despite this sudden large perturbation the energy relaxes and returns to a stable average value that is slightly shifted but close to the initial total energy . however , a fairly short integration temp step is required to account for the rapid change in density matrix .",
    "we believe this response to a sudden perturbation illustrates a key feature of the fast - qmmd scheme . instead of optimizing the electronic structure in each individual time step prior to the force calculation , the electronic degrees of freedom is optimized dynamically as the trajectories propagate .",
    "the speed of the relaxation is slightly different for different choices of the scaling parameter @xmath70 .",
    "this difference indicates an interesting opportunity . it should be possible to dynamically update an optimal value of @xmath70 in each time step .",
    "a time - dependent scaling factor , @xmath110 , that is updated one - the - fly in a time - reversible way is an interesting opportunity for future developments .",
    "total energy of a fast - qmmd calculation of a single water molecule using the lda density functional @xcite .",
    "after @xmath111 2400 fs the dynamics is perturbed by replacing the density matrix , @xmath1 , with the initial density matrix , @xmath112 , calculated at the time , t = 0 s. the perturbation calculation was performed for three different @xmath113-parameters ( eq .",
    "( [ vrl_damp ] ) ) .",
    "all calculations were performed with the modified verlet integration ( @xmath22 = 7 in table [ tab_coef ] ) .",
    "here rescaling of a @xmath84 with a factor @xmath70 = 0.7 was employed for the black curve , and @xmath70 = 0.6 for the red curve . ]",
    "the goal of this paper was to explore the extended lagrangian formulation of born - oppenheimer molecular dynamics in the limit of vanishing self - consistent field optimization .",
    "in contrast to the most recent studies , refs .",
    "@xcite , we have generalized the first principles theory beyond the ground state hartree - fock method to include also free energy potential surfaces valid at finite electronic temperatures , density functional theory with hybrid functionals , as well as the requirement of only one single hamiltonian construction per time step .",
    "this provides a very efficient and computational fast approach to first principles simulations that should be applicable to a broad class of materials . under normal conditions the proposed fast - qmmd scheme yields trajectories that are practically indistinguishable from an `` exact '' born - oppenheimer molecular dynamics simulation",
    "however , even in the event of anomalous behavior that may cause numerical instabilities , the optimization - free limit represents an ideal framework for more elaborate force calculations that require an improved accuracy in the electronic ground state optimization or a reduced length of the integration time step to recover stability or to improve accuracy .",
    "the optimization - free limit of extended lagrangian born - oppenheimer molecular dynamics demonstrates some of the opportunities in the development of a new generation first principles molecular dynamics that avoids current problems and shortcomings and allows a wider range of applications . our work presented in this article is a step in this direction .",
    "p. s. wants to thank l. c. for her eternal patience . a.m.n.n acknowledge support by the united states department of energy ( u.s .",
    "doe ) office of basic energy sciences , discussions with m. cawkwell , e. chisolm , c.j .",
    "tymczak , g. zheng and stimulating contributions by t. peery at the t - division ten bar java group .",
    "lanl is operated by los alamos national security , llc , for the nnsa of the u.s .",
    "doe under contract no .",
    "de - ac52- 06na25396 .",
    "support by the gran gustafsson research foundation is also gratefully acknowledged .",
    "to derive the force expression in eq .",
    "( [ freeforce ] ) , which together with the energy expression in eq .",
    "( [ freee ] ) is one of our key results , we start by noting that @xmath114 = e^{xc}[2p ] + 2tr[(d - p)v^{xc}[2p ] ] \\\\ ~\\\\ + { \\cal o}[(d - p)^2 ] .",
    "\\end{array}\\ ] ] within the same order of accuracy , @xmath115 , we can replace the expression in eq .",
    "( [ freee ] ) by @xmath116 = 2tr[hd ] + tr[(2d - p)g^\\alpha ( p ) ] \\\\ ~\\\\ + e^{xc}[2p ] + 2tr[(d - p)v_{xc}[2p ] ] \\\\ ~\\\\ - t_e{\\cal s}[d ] .",
    "\\end{array}\\ ] ] taking the partial derivative with respect to the nuclear coordinates ( keeping @xmath0 constant ) of the resulting free energy we get @xmath117/\\partial r_i\\right|_p   = { \\cal f}_r = 2tr[h_rd+hd_r ] \\\\ ~\\\\ ~ + 2tr[d_rg^\\alpha ( p ) ] + tr[(2d - p)g^\\alpha_r(p ) ] \\\\ ~   \\\\ ~ + e^{xc}_r[2p ] + 2tr[(d - p)v^{xc}_r(2p ) ] \\\\ ~\\\\ ~ + 2tr[d_rv^{xc}(2p ) ] - t_e\\partial { \\cal s}/\\partial r_i \\\\ ~~   \\\\ = 2tr[h_rd ] + tr[(2d - p)g^\\alpha_r(p ) ] \\\\    \\\\",
    "~ + e^{xc}_r[2p ] + 2tr[(d - p)v^{xc}_r(2p ) ] \\\\ ~\\\\ ~ + 2tr[(h+g^\\alpha ( p ) + v^{xc}(2p))d_r ]   - t_e{\\cal s}_r \\\\ ~   \\\\ = 2tr[h_rd ] + tr[(2d - p)g^\\alpha_r(p ) ] \\\\ ~   \\\\ ~ + e^{xc}_r[2p ] + 2tr[(d - p)v^{xc}_r(2p ) ] \\\\ ~\\\\ ~   + 2tr[h(p)d_r ] - t_e{\\cal s}_r \\\\    \\\\",
    "= 2tr[h_rd ] + tr[(2d - p)g^\\alpha_r(p ) ] \\\\",
    "~\\\\ ~ + e^{xc}_r[2d ] + 2tr[h(p)d_r ] - t_e{\\cal s}_r \\\\ ~\\\\ ~ + { \\cal o}[(d - p)^2 ] . \\end{array}\\ ] ] in the last step we used a second order approximation of @xmath56 $ ] expanded around @xmath118 , i.e. as in eq .",
    "( [ taylor_1 ] ) , where @xmath119 = e^{xc}_r[2p ] + 2tr[(d - p)v^{xc}_r[2p ] ] \\\\ ~~\\\\   + { \\cal o}[(d - p)^2 ] . \\end{array}\\ ] ] here the subscript @xmath54 in @xmath120 , @xmath121 $ ] , @xmath56 $ ] and @xmath122 denotes a derivative with respect only to the underlying atom centered basis .",
    "we now need to simplify the last two terms of the derivative above .",
    "we start with @xmath123 = 2tr[h(\\partial d/\\partial r ) ] \\\\ ~\\\\ = 2tr[h\\partial(zd^\\perp z^t)/\\partial r]\\\\   ~ \\\\",
    "= 2tr[h(z_rd^\\perp z^t + z d^\\perp_r z^t + zd^\\perp z^t_r ) ] . \\end{array}\\ ] ] by using the relation @xmath124 proposed in ref .",
    "@xcite we get @xmath125 = -tr[hs^{-1}s_rd + hds_rs^{-1}]\\\\ ~\\\\ ~ + 2tr[h^\\perp d^\\perp_r ]   \\\\   ~ \\\\",
    "= -2tr[s^{-1}hds_r ] + 2tr[h^\\perp d^\\perp_r ] , \\\\ \\end{array}\\ ] ] where we in the first step used the cyclic invariance under the trace , and in the next step the commutation relation , @xmath126 .",
    "the last term above , @xmath127 $ ] , vanish only for idempotent solutions at zero electronic temperatures . at finite temperatures , however ,",
    "the @xmath127 $ ] term is exactly cancelled by the entropy contribution , since @xmath128   \\\\   ~",
    "\\\\    = -2\\beta^{-1}tr[d^\\perp _ r\\ln(d^\\perp / ( i - d^\\perp ) ] \\\\ ~\\\\ = -2 \\beta^{-1}tr[d^\\perp _ r\\ln\\left(e^{-\\beta ( h^\\perp ( p ) - \\mu i)}\\right ) ]   \\\\   ~ \\\\    = 2tr[d^\\perp_r h^\\perp ] .",
    "\\end{array}\\ ] ] in the last equation above we used the fact that @xmath129 = 0 $ ] , since we assume canonical , charge conserving , partial derivatives . going back to the force derivation in eq .",
    "( [ forcederiv ] ) we now have that @xmath130 = 2tr[h_r ] + tr[(2d - p)g^\\alpha_r(p ) ] + e^{xc}_r[2d ] \\\\ ~\\\\ ~ -2tr[s^{-1}hds_r ] + { \\cal o}[(d - p)^2 ] \\end{array}\\ ] ] which completes our derivation of eq .",
    "( [ freeforce ] ) ."
  ],
  "abstract_text": [
    "<S> we present a first principles molecular dynamics approach that is based on time - reversible extended lagrangian born - oppenheimer molecular dynamics [ phys . </S>",
    "<S> rev . lett . * 100 * , 123004 ( 2008 ) ] in the limit of vanishing self - consistent field optimization . </S>",
    "<S> the optimization - free dynamics keeps the computational cost to a minimum and typically provides molecular trajectories that closely follow the exact born - oppenheimer potential energy surface . only one single diagonalization and hamiltonian ( or fockian ) construction </S>",
    "<S> are required in each integration time step . </S>",
    "<S> the proposed dynamics is derived for a general free - energy potential surface valid at finite electronic temperatures within hybrid density functional theory . even in the event of irregular functional behavior that may cause a dynamical instability , the optimization - free limit represents a natural starting guess for force calculations that may require a more elaborate iterative electronic ground state optimization . </S>",
    "<S> our optimization - free dynamics thus represents a flexible theoretical framework for a broad and general class of ab initio molecular dynamics simulations . </S>"
  ]
}