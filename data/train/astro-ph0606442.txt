{
  "article_text": [
    "the determination of the primary composition of cosmic rays with energies higher than @xmath1  ev is a real challenge .",
    "the lack of knowledge of the types of primary ultra - high - energy particles which induce extensive air showers makes it difficult to study their origin and in some cases even to determine their energy spectrum .",
    "more precise and less model - dependent determination of the cosmic - ray primary composition , especially in the highest - energy domain , is one of the most important tasks in contemporary astroparticle physics ( for a review and discussions see e.g.  ref .",
    "@xcite ) .",
    "ultra - high - energy cosmic rays are observed through air showers , and to extract information about the primary particle , selected observables of real air showers are compared to those of simulated ones for different primaries . because of large shower - to - shower fluctuations , one can not determine the primary - particle type of an individual air shower .",
    "that is why traditional approaches to the composition studies are based on the determination of average characteristics of a large sample of cosmic - ray events .",
    "this approach has obvious advantages : for a homogeneous composition , averaging smoothens out the fluctuations , and large statistics results in higher precision .",
    "furthermore , the computational time required to perform reliable simulations of an observable averaged over a large sample is much smaller than that necessary for detailed simulations of all events in the data set .",
    "however , for mixed composition , averaging might become a problem because fluctuations of the discriminating observables over their central values are larger when air showers from different arrival directions are combined in one sample .",
    "different zenith angles correspond to different atmospheric depths , and air showers detected by surface arrays have different stages of development and hence may have quite different observable parameters even for the same energies and primaries .",
    "moreover , the geomagnetic field introduces the azimuthal dependence for photon  @xcite and very inclined hadron  @xcite showers .",
    "even fluorescent detectors , which observe the shower development on its way through the atmosphere , respond to showers from different arrival directions in different ways , notably with different accuracies . for gamma - ray primaries at @xmath2  ev",
    ", the entire shower development is direction - dependent .",
    "we suggest to improve considerably the precision of the composition studies by performing individual simulations for each observed high - energy event . in the case of a large number of events in a data sample , averaging in bins of arrival directions",
    "may be used .",
    "if one is not interested in the study of possible gamma - ray primaries with @xmath2  ev , binning in zenith angle only is often sufficient .",
    "this method , in its simplest form with one observable , has been successfully implemented to obtain a limit on the gamma - ray fraction in the primary flux at @xmath3  ev using the data of the agasa and yakutsk experiments  @xcite .",
    "event - by - event simulations ( without selection by reconstructed parameters ) were previously used for the composition studies in refs .",
    "@xcite .",
    "the rest of the paper is organized as follows . in sec .",
    "[ sec : general ] , we present the sketch of the event - by - event approach to the composition studies , discuss the choice of the air - shower observables ( sec .  [",
    "sec : eandc ] ) , give a general idea of how to constrain the probable primary - particle type of an individual air shower ( sec .",
    "[ sec : general - event ] ) and how to use these shower - by - shower constraints to gain information about the chemical composition of the primary cosmic - ray flux using a sample of events ( sec .",
    "[ sec : general - ensemble ] ) .",
    "[ sec : integrals ] contains the detailed description of the procedure outlined in sec .",
    "[ sec : general ] and ready - to - use formulae implementing this procedure .",
    "[ sec : example ] presents several examples which illustrate the method by the analysis of small ( and hence statistically insignificant ) samples of events .",
    "there , we consider only one composition - related observable , the muon density , and use samples of highest - energy agasa and yakutsk events as examples . in sec .",
    "[ sec : example - event ] , we analyse in detail a single event ( the highest energy air shower reported by agasa ) . the procedure for estimating the limit on the fraction of particular primaries in a given energy range is illustrated in sec .",
    "[ sec : example - gamma - limit ] with the sample of six agasa showers with reported energies higher than @xmath4  ev and known muon content , while the algorithm to determine the best - fit composition assuming two possible primaries is illustrated in sec .",
    "[ sec : example - p - fe ] with a sample of four events with reported energies above @xmath5  ev detected by the agasa and yakutsk experiments .",
    "both samples are small and the analysis of sec .",
    "[ sec : example ] serves for illustrative purposes only .",
    "we briefly summarize and discuss novelties of our method in sec .",
    "[ sec : concl ] .",
    "some of our notations are summarized in appendix  [ app : notations ] .",
    "appendices  [ app : events ] and [ app : reconstruction ] contain technical information related to the examples presented in sec .",
    "[ sec : example ] .",
    "in this section , we sketch the main elements of our approach to study individual air - shower events and their ensembles . an operational algorithm is given in sec .",
    "[ sec : integrals ] and illustrated in sec .",
    "[ sec : example ] .      on the basis of detector readings ,",
    "several air - shower observables can be determined experimentally ; many of them are not independent of each other . for our purposes",
    ", we separate them into two groups which we will treat differently .",
    "this class contains the parameters related to the energy estimation and the arrival direction . for ground arrays ,",
    "e - observables usually include the signal density at a given distance from the shower core ( known as @xmath6 or @xmath7 ) ; for fluorescent telescopes the e - observable is the total amount of the fluorescent light ( corrected for atmospheric conditions ) .",
    "the arrival direction may be fixed because the pointing accuracy at high energies is often relatively high and variations of the arrival direction within the error bars have a negligible , compared to shower - to - shower fluctuations , effect on both energy estimation and measurement of the composition - related parameters . in the case of poor angular resolution , for example for fluorescent detectors in the monocular mode",
    ", the arrival direction should be treated on the same footing as other e - parameters .    in what follows ,",
    "we ignore , for simplicity , the errors in the determination of the arrival direction and consider a single e - observable  the reconstructed energy of a shower , @xmath8 . for a fixed arrival direction , @xmath8 is in one - to - one correspondence with the energy estimator used by a given experiment .",
    "we note that e - observables are primary - dependent but this dependence is naturally accounted for in the method , see sec .",
    "[ sec : general - event ] .",
    "we call the parameters used to distinguish various types of primary particles c - observables . depending on the experiment , they may include muon density or muon richness , the slope of the lateral distribution function of the total signal or of muons only , shower front curvature , rise time etc . for a more efficient separation of different primaries , simultaneous use of several such parameters",
    "is justified , and we hereafter denote the set of these parameters as @xmath9 .      from the sample of air showers of interest , each event is to be studied separately .",
    "one simulates a number of artificial showers whose e - observables are consistent with the real event and which are initiated by different primaries . to this end",
    ", showers with different primary energies are simulated ; for each of them , e - observables are reconstructed and compared to their observed values for the real shower .",
    "simulated events are then selected for further study by assigning weights proportional to the estimate of how well their e - observables match the data .",
    "it is important to use the same reconstruction procedure as in the analysis of the real data ; detailed information about the detector is needed at this point .    any simplified treatment of the detector ( unless quantified to be of negligible effect ) would weaken the improvements of the proposed method over previous ones .    for each simulated shower ,",
    "c - observables are reconstructed , again by the same method as used for processing the real data . for each type of primary particle of interest , the distribution of c - observables of simulated showers selected by e - observables is obtained .    finally , the c - observables measured for the real event are compared with these simulated distributions to determine the probabilities that the event was initiated by various primaries , given the measured e- and c - observables .",
    "one is usually interested in a certain range of real primary energies @xmath10 ( see appendix  [ app : notations ] for the summary of our notations ) .",
    "we will refer to this range as @xmath11 ; it may be an interval ( @xmath12 ) or a half - line ( @xmath13 ) ; in general , the restrictions on the energy may be supplemented by those on the arrival directions if a particular region of the sky is studied .",
    "one then selects the data set to be analyzed .",
    "while it should more or less correspond to the energy range of interest in terms of the reconstructed energies , the possibility of incorrect energy reconstruction has to be taken into account and the range of reconstructed energies should preferrably be extended . in an ideal case , all events recorded by an experiment should enter the sample , but most of them would contribute to the quantities of interest with almost zero weight .",
    "each of the individual events in the real sample is to be analyzed as described in sec .",
    "[ sec : general - event ] but keeping track of the original energy @xmath10 .",
    "namely , for each event and each primary particle , two distributions are to be obtained for the c - parameters of the simulated events : ( i )  consistent with the observed one by e - parameters and having thrown energies in the domain of interest , @xmath14 ; and ( ii )  consistent with the real event by e - parameters and having thrown energies outside the domain of interest , @xmath15 .",
    "separate probabilities are to be obtained for the cases ( i ) and ( ii ) .",
    "this is necessary because we want to constrain primary composition in the given domain of physical energies @xmath11 , and contamination by showers with energies outside @xmath11 should be properly taken into account .",
    "then , the ensemble of these probablities obtained for all real events in the sample is subject to combinatoric analysis . as a result , either limits or best - fit parameters of the chemical composition of the primary cosmic - ray flux in the energy domain @xmath11 are determined . at this last stage of the procedure",
    "one takes into account corrections for the `` lost events '' .",
    "these are possible events with thrown energies @xmath14 which however would escape from the sample either because their reconstructed energies differ strongly from @xmath10 , or because of the event quality cuts .",
    "in this section , we present a detailed algorithm which can be directly used in the analysis of the real data .",
    "let us consider a single real event with the reported observed parameters @xmath16 and the arrival direction @xmath17 in horizonthal coordinates .",
    "hereafter , @xmath18 denotes possible primary - particle type ( for example , @xmath19 refers to primary protons , @xmath20fe to iron nuclei and @xmath21 to photons ) . for each @xmath18 one",
    "is interested in , one generates a library of simulated showers which have :    0.3 cm _",
    "( i ) _ primary particle @xmath18 ;    0.3 cm _",
    "( ii ) _ arrival direction @xmath17 ( or various arrival directions consistent with @xmath17 within the experimental errors , as discussed in sec .  [",
    "sec : eandc ] ) ;    0.3 cm _ ( iii ) _ energies @xmath10 in a relatively wide range around @xmath22 .",
    "the thrown energies @xmath10 of the simulated showers may be chosen randomly from , e.g. , the interval @xmath23 according to @xmath24 spectrum .",
    "this choice of the spectrum for the library enables one to control shower - to - shower fluctuations at high energies but saves computational time ; as we will see below , it is * not * the spectrum of real particles which we assume to be realized in nature .",
    "the interval we quote is indicative and should be adapted for particular events , especially at large zenith angles .",
    "the measurement of e - parameters is subject to statistical errors which are studied by experimental groups in detail .",
    "the probability distribution that the primary particle which produced an actual shower with the observed e - parameters equal to @xmath22 would rather produce a shower with these parameters equal to @xmath8 is denoted by @xmath25 .",
    "this function is usually determined and published by experimental groups .",
    "for instance , for the agasa experiment @xmath26 is gaussian in @xmath27 and the standard deviation of @xmath8 is @xmath28 @xcite .",
    "hence , in a library of simulated showers to be used in the analysis of a real shower with e - parameters equal to @xmath22 , we assign to each simulated shower a weight @xmath29 in principle , this function may depend on the type of a primary , but at this stage we use one and the same @xmath30 for all particles .",
    "we emphasise that the function @xmath30 has nothing to do with physical fluctuations in the shower development , nor with primary- and direction - dependent systematics in the energy reconstruction , but describes instead the resolution power of the installation .",
    "additionally , one may be interested in studying the energy spectrum different from the one used in the simulations of shower library ( it may happen , for instance , that the library was simulated with the @xmath31 spectrum with @xmath32 while one is interested in say @xmath33 or @xmath34 ) . to reproduce the required thrown energy spectrum ,",
    "an additional weight @xmath35 is introduced ( instead of @xmath22 in the denominator , any other typical energy scale may be used ) .",
    "the c - parameters are also reconstructed with some statistical errors . in exactly the same way",
    "a shower with measured c - parameters equal to @xmath36 could produce detector readings corresponding to @xmath37 .",
    "we denote the corresponding probability distribution as @xmath38 let us enumerate the showers in the library simulated for a given real event and for a given primary @xmath18 by @xmath39 .",
    "the distribution of the parameters @xmath40 for the showers consistent with the real one by e - parameters is given by @xmath41 where we denoted by @xmath42 , @xmath43 and @xmath44 the values of the weights and the vector of c - parameters calculated for the simulated shower number @xmath45 with the primary @xmath18 , respectively .",
    "@xmath46 is the normalization factor determined by the condition @xmath47    by definition , @xmath48 is the probability to have observed c - parameters in the region @xmath49 centered at @xmath40 given the primary particle @xmath18 and observed e - parameters .",
    "this probability assumes that a specific shower - development model used in the simulation code is valid .    to compare the simulated distributions @xmath50 with the observed c - parameters @xmath51 of the real event",
    ", one has to formulate a conjecture about the nature of its primary particle .",
    "one possible question is , how bad the event is described by the primary @xmath18  without fixing and studying other possibilities ( only the shower library for @xmath18 primaries is required in this case ) . given the observed values of @xmath22 and @xmath51 , the event is consistent with the primary @xmath18 with the probability density @xmath52 in the case of practical interest , when the event is unlikely being initiated by the primary @xmath18 , the estimate of the probability that a given event could be initiated by the primary @xmath18 is given by @xmath53 the use of this estimate is justified if @xmath54 .",
    "another conjecture to be studied might be that the primary was either @xmath55 or @xmath56 . in this case ,",
    "@xmath57 and @xmath58 clearly , it may happen that the event is poorly described by both @xmath55 and @xmath56 , that is @xmath59 and @xmath60 are not stable .",
    "this indicates that the conjecture that the primary was either @xmath55 or @xmath56 works poorly for this event .    in case one wishes to distinguish between several possible primaries @xmath61 , eq .",
    "( [ p_a1,a2 ] ) should be replaced by @xmath62      let us fix the physical energy range @xmath11 and consider a sample of @xmath63 observed events enumerated by @xmath64 , selected as described in sec .",
    "[ sec : general - ensemble ] .      to constrain the fraction of the primaries @xmath18 in the total flux of cosmic - ray particles within the energy domain @xmath11 ,",
    "one simulates libraries of @xmath18-induced showers described in sec .",
    "[ sec : integrals - event ] for each observed event in the sample .",
    "when determining the distribution @xmath50 , one has to distinguish its two constituents , @xmath65 where @xmath66 is the distribution built with only those showers from the library whose thrown energies @xmath10 belong to the domain @xmath11 ; the rest of showers contribute to @xmath67 .",
    "consequently , one obtains for each observed event @xmath68 , two probabilities :    * @xmath69 , the probability that the event @xmath68 was initiated by the primary @xmath18 with energy @xmath14 ; in the case when the event @xmath68 is unlikely to be induced by primary @xmath18 , @xmath69 is given by eq .   with @xmath70 , otherwise , to get the conservative bound",
    ", one can set @xmath71 .",
    "* @xmath72 , the probability that the event @xmath68 was initiated by the primary @xmath18 with energy @xmath15 ; in the case when the event @xmath68 is unlikely to be induced by primary @xmath18 , @xmath72 is given by eq .   with @xmath73 , otherwise , to get the conservative bound , one can set @xmath74 .",
    "generally , these two probabilities do not sum up to unity , @xmath75 . to proceed further , one needs a conjecture about other possibilities .",
    "namely , we should distinguish between two other probabilities ,    * @xmath76 , the probability that the event @xmath68 was initiated by any other primary than @xmath18 with energy @xmath14 ; * @xmath77 , the probability that the event @xmath68 was initiated by any other primary than @xmath18 with energy @xmath15 ;    without assumptions about possible primaries other than @xmath18 , the two cases @xmath76 and @xmath77 can not be distinguished by simulations . a reasonable solution is to assume loosely that the energy was determined correctly by an experiment , @xmath78 , and the probability to have the primary energy @xmath10 follows the distribution @xmath79 . then , @xmath80 where the normalisation factor @xmath81 is determined from the condition @xmath82    given the probabilities @xmath83 for each real event @xmath68 in the sample , one can determine the probability @xmath84 to have , among @xmath63 observed events , @xmath85 initiated by primaries @xmath18 with energies @xmath14 and @xmath86 initiated by any other primaries with energies @xmath14 .",
    "we are not interested in what happens outside the domain @xmath11 , so in what follows we do not distinguish @xmath72 and @xmath77 and use @xmath87    the probability @xmath84 can be calculated as follows .",
    "makes use of the monte - carlo simulations .",
    "one generates a large number of sets of @xmath63 elements , each element marked either `` @xmath88 '' , or `` @xmath89 '' , or `` @xmath90 '' with the probabilities @xmath91 , @xmath92 and @xmath93 , respectively ( these probabilities are different for different elements @xmath94 ) . to get @xmath84 ,",
    "one simply counts the number of sets with @xmath85 elements marked `` @xmath88 '' and @xmath86 elements marked `` @xmath89 '' and divides this number by the total number of simulated sets . ]",
    "the probability to have @xmath95-th ,  , @xmath96-th observed events ( to distinguish them , let us put them in order , @xmath97 ) induced by primaries @xmath18 with @xmath98 and @xmath99-th ,  , @xmath100-th events ( @xmath101 , @xmath102 ) induced by any other primaries with @xmath103 is given simply by the product @xmath104 to calculate @xmath84 one sums over all possible ordered subsets @xmath105 @xmath106\\ ; , \\label{p}\\end{aligned}\\ ] ] where @xmath107 .",
    "let us suppose now that the fraction of primaries @xmath18 in the total flux of particles with energies @xmath108 is @xmath109 . by definition , @xmath110 is the probability for a single shower with @xmath108 to be induced by @xmath18 , while @xmath111 is a probability for a single shower with @xmath112 to be induced by any other primary .",
    "hence @xmath113 , the probability that the observed results are reproduced for a given @xmath109 , can be expressed via @xmath114 by making use of the formula for a conditional probability , @xmath115 ( cf .",
    "@xcite for a particular case @xmath116 ) .",
    "the cases @xmath117 reflect the possibility that @xmath118 events may correspond to primaries with @xmath90 .    making use of the function @xmath119",
    ", one can constrain the fraction @xmath109 at a given confidence level @xmath120 . indeed , the allowed region of @xmath109 corresponds to @xmath121 for sufficiently small values of @xmath91 , the function @xmath113 is a monotonically decreasing function and the allowed region corresponds to @xmath122 , where @xmath123 is determined by @xmath124 ; we obtain an upper limit on @xmath110 .",
    "alternatively , @xmath119 may be non - monotonic , and the condition  ( [ l * ] ) may determine one or several intervals allowed for @xmath109 at the confidence level @xmath120 .",
    "the most probable value of @xmath109 corresponds to the maximal value of @xmath119 over @xmath125 .",
    "let us remind at this point that if the allowed interval for @xmath126 does not include @xmath127 at a given c.l .",
    ", this does not mean we can be sure that there are @xmath18-primaries in nature : this latter statement is true only in the frameworks of the studied hypothesis ( primary @xmath18 versus any other primary with correct energy determination ) .",
    "the limit one obtains in this way is however biased because some particles with @xmath108 may have reconstructed energies so different from @xmath10 that the corresponding events would not enter the experimental sample chosen for the study . to correct the final result for these `` lost '' particles , another simulation is required .",
    "one should simulate sufficiently large number @xmath128 of air showers initiated by the primaries @xmath18 with arrival directions distributed randomly according to the experimental acceptance and energies randomly chosen from the domain @xmath108 , this time with the realistic spectrum @xmath129 .",
    "some @xmath130 of these showers will have reconstructed energies @xmath8 ( or some other parameters ) such that they would escape from the sample chosen for the study ; the fraction of these `` lost '' events is thus @xmath131 .",
    "the true fraction of @xmath18-primaries @xmath132 is given by the ratio of the number of @xmath18-induced events @xmath133 and the sum of the number of these events and the number of events initiated by other particles @xmath134 , @xmath135 similarly , the accessible to our study fraction of @xmath18-particles @xmath136 is given by the ratio of accessible to our study fraction of @xmath18-induced events @xmath137 and the sum of the number of these events and the number of events initiated by other particles @xmath134 , @xmath138 here we assume that other particles do not escape from the sample chosen for the study . equations and enable one to place a bound on @xmath139 from previously obtained limit on @xmath109 .",
    "in the energy region to be studied , the expected spectra of different primaries may be different .",
    "corresponding spectral indices may be probed within our approach .",
    "indeed , in the example considered above , @xmath140 depends also on the spectral index @xmath141 , eq.([w2 ] ) .",
    "the search for the maximum of @xmath140 could be performed with account of this new variable thus revealing , in general , the excluded ( or most probable , see sections below ) region(s ) of ( @xmath110 , @xmath141 ) parameter space .",
    "the extension to several primaries @xmath142 is straightforward .",
    "let us turn now to the study of the conjecture that all primary particles in the energy domain @xmath11 were either @xmath55 or @xmath56 .",
    "this requires simulation and processing of the libraries of @xmath55- and @xmath56-induced showers and no additional assumptions .",
    "the distributions @xmath143 are obtained for each event @xmath68 and four probabilities are obtained :    * @xmath144  event @xmath68 initiated by the primary @xmath55 with @xmath145 ; * @xmath146  event @xmath68 initiated by the primary @xmath55 with @xmath147 ; * @xmath148  event @xmath68 initiated by the primary @xmath56 with @xmath145 ; * @xmath149  event @xmath68 initiated by the primary @xmath56 with @xmath147    these probabilities are determined as follows , @xmath150 now @xmath151 corresponds to the primaries with @xmath147 .",
    "the probability @xmath84 corresponds now to the case when in the set , @xmath85 primaries @xmath55 with @xmath152 , @xmath86 primaries @xmath56 with @xmath152 and @xmath118 primaries @xmath55 or @xmath56 with @xmath147 are present .",
    "it is determined by the same eq .",
    "( [ p ] ) with the replacements @xmath153 , @xmath154 , where @xmath155 and @xmath93 are now given by eqs .",
    "( [ n * ] ) , ( [ n * * ] ) . it also can be determined by the monte - carlo simulation described above .",
    "if the fraction of primaries @xmath55 in the energy domain @xmath11 is @xmath156 , then , within the conjecture we study , the rest @xmath157 correspond to @xmath56 .",
    "thus @xmath158 is given by the same eq .",
    "( [ 8 * ] ) and the region of @xmath156 allowed at the confidence level @xmath120 is again determined by @xmath159 .    the most probable value of @xmath156 may be determined by maximization of @xmath158 .",
    "account of the `` lost '' events requires , in this case , determination of two `` lost '' fractions , @xmath160 and @xmath161 .",
    "from the relation @xmath162 one obtains @xmath163    generalization of the procedure and equations to the case of more than two primary types @xmath164 , @xmath165 , @xmath166 , is straightforward . in particular , one defines the probability to have a set of fractions @xmath167 , @xmath168 , among the primaries with @xmath169 .",
    "the probability @xmath84 is now replaced by @xmath170 which can be calculated using a similar method .",
    "the function @xmath171 can be again expressed via @xmath170 by making use of the formulae for conditional probability , @xmath172 determination of the best - fit composition would require , in this case , maximization of @xmath173 with respect to @xmath174 fractions @xmath175 ( note that @xmath176 ) .",
    "in this section , we illustrate the method with several simple ( toy ) examples . for the data , we choose the highest - energy cosmic - ray events reported by the agasa  @xcite and yakutsk  @xcite experiments ( see table  [ tab : events ] for the list of events we use and ref .",
    "@xcite for more details ) .",
    "the e - observable used by the both experiments is @xmath6 , the signal density at 600  m from the shower core . for a given zenith angle @xmath177 ,",
    "it is in one - to - one correspondence with @xmath8 . here , we use only one c - observable , @xmath178 , the muon density at 1000  m from the core .",
    "observed arrival directions , @xmath22 and @xmath178 are given in table  [ tab : events ] in appendix  [ app : events ] , where we also present technical details of the simulation procedure .",
    "the procedure used to reconstruct @xmath8 and @xmath178 is described in appendix  [ app : reconstruction ] .",
    "we do not discuss many experimental details and the model dependence of the results , so all three examples in this section should be considered as toy ones serving the only purpose to illustrate the method .      the procedure described in this section has to be performed for each real event in the dataset .",
    "shower libraries for different primaries are generated as described in appendix  [ app : events ] , and @xmath8 and @xmath178 are determined for each simulated shower using the procedure presented in appendix  [ app : reconstruction ] . in this example , we consider the highest - energy agasa event ( event 1 from table  [ tab : events ] ) .",
    "simulations of the agasa detector and the reconstruction procedure  @xcite indicate that the function @xmath30 is gaussian in @xmath179 with the width corresponding to the standard deviation of 25% of the central value in terms of energy .",
    "this corresponds to @xmath180 for @xmath179 , @xmath181    though the detector errors in determination of @xmath182 and fitting the muon ldf may vary with the muon density and number of detectors hit , in our toy example we use for the function @xmath183 the approximation  @xcite of the gaussian distribution with the width of 40% of the central value . in our case , there is only one c - observable , @xmath184 , and we thus have @xmath185 if we are interested in the primary particle of this particular event only , we should use eq .",
    "( [ f_a(c ) ] ) to determine @xmath186 , @xmath187 and @xmath188 .",
    "these functions are plotted in fig .",
    "[ fig : f_a ] .     of simulated events",
    "consistent with event  1 by the arrival direction and the reconstructed energy : thin dark line , @xmath189 ; thick gray line , @xmath19 ; dashed line , @xmath20fe .",
    "the arrow indicates the observed value of @xmath178 for event  1 .",
    "[ fig : f_a ] , width=423 ]    these three functions allow to quantify , in particular , the answers to the questions :    * how bad this event is described by a photon ( of any energy ) , without fixing other possibilities ? with the help of eqs .",
    "( [ p_a - tilde ] ) , ( [ estimate - bound ] ) , one finds for this case @xmath190 * suppose that the event may be initiated either by a photon or by a proton ( of any energy ) . which primary is prefered ?",
    "application of eq .",
    "( [ p_a1,a2 ] ) results in @xmath191 * suppose that the event may be initiated either by a proton or by an iron nuclei ( of any energy ) . which primary is prefered ?",
    "application of eq .",
    "( [ p_a1,a2 ] ) results in @xmath192    we emphasise once again that the probability @xmath193 in the @xmath194-@xmath195 comparison does not mean it was surely a proton : this is true only for the hypothesis that either protons or photons can be the primaries . indeed , @xmath196 for the @xmath194-fe comparison .",
    "the difference between protons and iron nuclei is not significant for a single event(cf .",
    "[ w2 ] ) . nevertheless , this difference becomes more pronounced for samples of several events .",
    "we note that the two - primary comparison is complementary to the one - primary analyses because the latters assume correct energy determination for a part of showers ( this or any other hypothesis is necessary for obtaining quantitative results ) .    in the following examples ( sec .",
    "[ sec : example - gamma - limit ] , [ sec : example - p - fe ] ) , we will study ensembles of events containing this event  1 .",
    "hence we will need the functions @xmath197 determined in eq .",
    "( [ f+- ] ) for the energy domains @xmath11 to be used in these examples : @xmath198  ev for example  2 ( sec .",
    "[ sec : example - gamma - limit ] ) and @xmath199  ev for example  3 ( sec .",
    "[ sec : example - p - fe ] ) . for the latter case , we plot in fig .",
    "[ fig : f_p+- ] functions @xmath200 ; the function @xmath201 corresponds to lower energies and hence lower muon densities .     of simulated proton - induced events consistent with event  1 by the arrival direction and the reconstructed energy : dotted line",
    ", @xmath201 ( corresponds to @xmath202  ev ) ; dashed line , @xmath203 ( corresponds to @xmath204  ev ) .",
    "[ fig : f_p+- ] , width=423 ]    the probabilities @xmath205 and @xmath206 for the limit on the gamma - ray primaries , @xmath207 , calculated as discussed in sec .",
    "[ sec : ensemble-1-primary ] , and probabilities @xmath208 and @xmath209 , @xmath210 , calculated with the help of eq .",
    "( [ n * ] ) for the proton - iron discrimination , are presented both for the event  1 discussed here and for other events in the samples in tables  [ tab : p_gamma ] and [ tab : p_p - fe ] in sec .",
    "[ sec : example - gamma - limit ] and [ sec : example - p - fe ] , respectively .",
    "we concentrate here on obtaining the limit on the gamma - ray primaries with energies @xmath211  ev based on the agasa data .",
    "the energy domain of interest is thus @xmath207 .",
    "for the experimental sample we take all agasa events with known muon data and energies @xmath212  ev : this widening of the energy range ( cf .",
    "[ sec : general - ensemble ] ) compared to the domain @xmath11 is justified because photon energies may be estimated incorrectly by the experiment .",
    "there are six events in the sample ( events 16 in table  [ tab : events ] ) ; see ref .",
    "@xcite for the application of the same procedure to a larger dataset supplemented by yakutsk events . for each of the real events we determine the probabilities @xmath213 in the same way as described in sec .",
    "[ sec : example - event ] for the event  1 .",
    "the probabilities are given in table  [ tab : p_gamma ] .    .",
    "probabilities @xmath214 ( see text for notations ) for individual events 16 entering the sample for example 2 ( the limit on the gamma - ray primary fraction with @xmath207 ) .",
    "[ tab : p_gamma ] [ cols=\"^,^,^,^,^\",options=\"header \" , ]     for each of the eight events , we generated libraries of simulated showers induced by primaries required for the particular examples ( see column  ( 8) of table  [ tab : events ] ) .",
    "for each observed event and each primary , 1000 showers were generated .",
    "thrown energies @xmath10 of the simulated showers were randomly selected between @xmath215  ev and @xmath216  ev following the spectrum @xmath217 , as discussed in sec .  [ sec : integrals - event ] .",
    "the arrival directions of the simulated showers were the same as those of the corresponding real events .",
    "the simulations were performed with corsika  v6.204  @xcite , choosing qgsjet  01c  @xcite as high - energy and fluka  2003.1b  @xcite as low - energy hadronic interaction model .",
    "electromagnetic showering was implemented with egs4  @xcite incorporated into corsika .",
    "possible interactions of the primary photons with the geomagnetic field were simulated with the preshower option of corsika  @xcite . as suggested in ref .",
    "@xcite , all simulations were performed with thinning level @xmath218 , maximal weight @xmath219 for electrons and photons , and @xmath220 for hadrons .    for each simulated shower",
    ", we determined @xmath6 and @xmath221 .",
    "the plane orthogonal to the arrival direction has been divided into concentrical rings of the width of 100  m ; contributions of all particles were averaged over these rings to reconstruct the lateral distribution function . for the calculation of the signal density , we used the detector response functions from refs .",
    "@xcite . the reconstructed energy ",
    "the e - observable which we compared to the experimental values  was obtained by making use of exactly the same procedure as used in processing the real data ; see appendix  [ app : reconstruction ] .",
    "it is important to process the simulated events in a way as close as possible to the procedure with which the observables we use were obtained for the real events . for completeness",
    ", we recall here the relevant procedures for agasa and yakutsk .      for the primary energy estimation ,",
    "agasa used the following procedure ( the takeda method , ref .",
    "@xcite ) . the lateral distribution function ( ldf ) of the signal",
    "is obtained by fitting the scincillator detectors readings by the empirical formula  @xcite , @xmath222 where @xmath223 and @xmath224 denotes the distance to the shower core . only detectors with 300  m@xmath225 1000  m",
    "are used for the fit .",
    "@xmath6 is the value of the fitted ldf at @xmath226  m.    due to the 10% one - side systematic error reported in ref .",
    "@xcite , the value of @xmath6 observed by agasa is larger than the real one by a factor of 1.1 which should be taken into account for the simulated events : @xmath227 the energy estimation formula is @xcite @xmath228 where @xmath229 is the signal density for a vertical shower related to the real density of an inclined shower @xmath230 by the attenuation formula  @xcite @xmath231 where @xmath232 the simulations should be performed for the agasa atmospheric depth , @xmath233 ( note that @xmath234 ) .        to determine the muon density at 1000 m from the core ,",
    "the densities measured by the detectors between 800 m and 1600 m from the core are fitted by the empirical ldf  @xcite @xmath237 where @xmath238 the value of the fitted ldf at @xmath239  m , @xmath178 , is used as the primary composition estimator .",
    "the energy estimation in the yakutsk array  @xcite is quite similar to that of agasa .",
    "the value of @xmath240 is determined by fitting the scincillator detectors readings by the following empirical formula , @xmath241 where   which varies usually within @xmath242  m. the detector responses then are adjusted in order to get the same energy estimate with @xmath243 , that allows to treat the data uniformly . since this procedure adopted by yakutsk collaboration is unambigiuos , our simple method is justified . ]",
    "@xmath244 the attenuation formula is @xmath245 the energy conversion formula is @xmath246^{0.98},\\ ] ] where @xmath247^{-0.12}.\\ ] ] the simulations are to be performed for the yakutsk atmospheric depth , @xmath248 .",
    "to apply one and the same procedure to both agasa and yakutsk results , we use the muon density at 1000 m as the parameter to be compared with simulations .",
    "the yakutsk muon detectors have larger area and significantly higher saturation threshold than agasa s , so the detector readings in a wider region , 400  m to 2000  m , are used in the ldf fit by the following empirical formula  @xcite @xmath250 where @xmath251 , @xmath252 , @xmath253 and @xmath254 , together with the overall proportionality coefficient , is a free fitting parameter .",
    "m.  t.  dova , a.  g.  mariazzi and a.  a.  watson , arxiv : astro - ph/0512408 . b.  mcbreen and c.  j.  lambert , phys .",
    "d * 24 * ( 1981 ) 2536 .",
    "e.  e.  antonov _ et al .",
    "_ , jetp lett .",
    "* 68 * , 185 ( 1998 ) [ pisma zh .",
    "fiz .   * 68 * , 177 ( 1998 ) ] ; m.  ave , r.  a.  vazquez and e.  zas , astropart .  phys .",
    "* 14 * , 91 ( 2000 ) .",
    "g.  i.  rubtsov _ et al .",
    "_ , phys .  rev .",
    "d * 73 * ( 2006 ) 063009 [ arxiv : astro - ph/0601449 ] .",
    "f.  halzen , r.  a.  vazquez , t.  stanev and h.  p.  vankov , astropart .",
    "phys .  * 3 * ( 1995 ) 151 .",
    "p.  homola _ et al .",
    "b ( proc . suppl . )",
    "* 151 * ( 2006 ) 116 ; m.  risse _ et al .",
    "_ , phys .",
    "* 95 * ( 2005 ) 171102 .",
    "m.  risse _ et al .",
    "_ , nucl .",
    "suppl .   * 151 * , 96 ( 2006 ) ; m.  risse _ et al .",
    "_ , astropart .",
    "* 21 * , 479 ( 2004 ) .",
    "m.  takeda _ et al .",
    "_ , astropart .",
    "* 19 * , 447 ( 2003 ) .",
    "n.  hayashida _ et al .",
    "_ , astro - ph/0008102 , see also http://www - akeno.icrr.u - tokyo.ac.jp / agasa/. v.  egorova _ et al .",
    "_ , nucl .",
    "suppl .   * 136 * , 3 ( 2004 ) ; m.i .",
    "pravdin , proc .",
    "29th icrc ( pune ) , 2005 ; s.  p.  knurenko _ et al .",
    "astro - ph/0411683 .",
    "k.  shinozaki _ et al .",
    "_ , astrophys .  j.   * 571 * , l117 ( 2002 ) .",
    "d.  heck _ et al .",
    "_ , report fzka-6019 ( 1998 ) , forschungszentrum karlsruhe n.  n.  kalmykov , s.  s.  ostapchenko and a.  i.  pavlov , nucl .  phys .  proc",
    ".  suppl .",
    "* 52b * , 17 ( 1997 ) .",
    "a.  fass , a.  ferrari , p.  r.  sala , in proc .  of the montecarlo 2000",
    "conference , a.  kling _ el . _ ( eds . ) , p. 159 - 164 ( springer berlin 2001 ) ; a. fass _",
    "et al . _ ,",
    "w.  r.  nelson , h.  hirayama , d.w.o .",
    "rogers , slac-0265 p.  homola _ et al .",
    "_ , comp . phys . comm .",
    "* 173 * ( 2005 ) 71 .",
    "m.  kobal _ et al .",
    "_ , astropart .",
    "* 15 * , 259 ( 2001 ) .",
    "n.  sakaki _ et al .",
    "_ , proc .",
    "icrc 2001 , * 1 * , 333 .",
    "l.  g.  dedenko _ et al .",
    "_ , nucl .",
    "suppl .   * 136 * , 12 ( 2004 )",
    ". s.  yoshida _ et al .",
    "_ , j.  phys .",
    "g * 20 * ( 1994 ) 651 .",
    "h.  y.  dai _ et al .",
    "_ , j.  phys .",
    "g * 14 * ( 1988 ) 793 .",
    "n.  hayashida _ et al .",
    "_ , j.  phys .",
    "g * 21 * ( 1995 ) 1101 .",
    "a.  v.  glushkov _ et al .",
    "_ , phys .  atom",
    ".  nucl .   * 63 * , 1477 ( 2000 ) [ yad .",
    "* 63 * ( 2000 ) 1557 ] .",
    "m.  pravdin _ et al .",
    "_ in proc . of 29th icrc , pune , india ( 2005 ) v.7 , 243 - 246",
    ". n.  n. efimov _",
    ", in catalogue of hecr n3 , world data center c2 , japan ( 1988 ) .",
    "a.  v.  glushkov _ et al .",
    "_ , jetp lett .   * 71 * , 97 ( 2000 ) [ pisma zh .",
    "* 71 * ( 2000 ) 141 ] ."
  ],
  "abstract_text": [
    "<S> we suggest a method which improves the precision of studies of the primary composition of ultra - high - energy cosmic rays . </S>",
    "<S> two principal ingredients of the method are ( 1 )  comparison of the observed and simulated parameters for _ individual _ showers , without averaging over arrival directions and ( 2 )  event - by - event selection of simulated showers by the physical observables and not by the reconstructed primary parameters . </S>",
    "<S> a detailed description of the algorithm is presented and illustrated by several examples .    </S>",
    "<S> @xmath0    98.70.sa ultra - high - energy cosmic rays , primary composition </S>"
  ]
}