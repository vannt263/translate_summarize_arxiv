{
  "article_text": [
    "trimolecular reactions are important components of biochemical models which include oscillations  @xcite , multistable states  @xcite and pattern formation  @xcite . considering their reactant complexes ,",
    "trimolecular reactions can be subdivided into the following three forms @xmath0 where @xmath1 , @xmath2 and @xmath3 are distinct chemical species ( reactants ) and symbol @xmath4 denotes products . in what follows",
    ", we will assume that product complexes @xmath4 do not include @xmath1 , @xmath2 and @xmath3 .",
    "let us denote by @xmath5 the concentration of @xmath1 .",
    "then the conventional reaction - rate equation for trimolecular reaction  ( [ basic3 ] ) can be written as @xmath6 where @xmath7 denotes ( in general , time - dependent ) reaction rate constant  @xcite . using mass - action kinetics , rate @xmath7",
    "is assumed to be constant and equation ( [ basicode ] ) becomes an autonomous ordinary differential equation ( ode ) with a cubic nonlinearity on its right - hand side .",
    "cubic nonlinearities significantly enrich the dynamics of odes .",
    "for example , odes describing chemical systems with two chemical species which do not include cubic or higher nonlinearites can not have any limit cycles  @xcite . on the other hand ,",
    "it has been reported that , by adding cubic nonlinearities to such systems , one can obtain chemical systems undergoing homoclinic  @xcite and snic bifurcations  @xcite , i.e. oscillating solutions are present for some parameter regimes .",
    "motivated by the developments in systems biology  @xcite , there has been an increased interest in recent years in stochastic methods for simulating chemical reaction networks .",
    "such approaches provide detailed information about individual reaction events .",
    "considering well - mixed reactors , this problem is well understood .",
    "the method of choice is the gillespie algorithm  @xcite or its equivalent formulations  @xcite .",
    "these methods describe stochastic chemical reaction networks as continous - time discrete - space markov chains .",
    "they are applicable to modelling intracellular reaction networks in relatively small domains which can be considered well - mixed by diffusion .",
    "if this assumption is not satisfied , then stochastic simulation algorithms for spatially distributed reaction - diffusion systems have to be applied  @xcite .",
    "the most common algorithms for spatial stochastic modelling in systems biology can be classified as either brownian dynamics ( molecular - based )  @xcite or compartment - based ( lattice - based ) approaches  @xcite .",
    "molecular - based models describe a trajectory of each molecule involved in a reaction network as a standard brownian motion .",
    "this can be justified as an approximation of interactions ( non - reactive collisions ) with surrounding molecules ( heat bath ) on sufficiently long time scales  @xcite .",
    "it is then often postulated that bimolecular or trimolecular reactions occur ( with some probability ) if the reactant molecules are sufficiently close  @xcite .",
    "brownian dynamics treatment of bimolecular reactions is based on the theory of diffusion - limited reactions , which postulates that a bimolecular reaction occurs if two reactants are within distance @xmath8 ( reaction radius ) from each other .",
    "the properties of this model depend on the physical dimension of the reactor .",
    "considering one - dimensional  @xcite and two - dimensional problems  @xcite , diffusion - limited reactions lead to mean - field models with time - dependent rate constants which converge to zero for large times .",
    "this qualitative property is in one spatial dimension shared by trimolecular reactions .",
    "it has been shown that the mean - field model  ( [ basicode ] ) can be obtained with time - dependent rate constant @xmath7 satisfying for large times @xmath9 where @xmath10 is a constant  @xcite .",
    "considering three - dimensional problems , the reaction radius of a diffusion - limited bimolecular reaction can be related with a ( time - independent ) reaction rate of the corresponding mean - field model  @xcite .",
    "trimolecular reaction ( [ basic3 ] ) can then be incorporated into three - dimensional brownian dynamics simulations either directly  @xcite or as a pair of bimolecular reactions @xmath11 and @xmath12 , where @xmath13 denotes a dimer of @xmath1  @xcite .",
    "compartment - based models divide the simulation domain into compartments ( voxels ) and describe the state of the system by numbers of molecules in each compartment .",
    "compartments can be both regular ( cubic lattice ) or irregular ( unstructured meshes )  @xcite .",
    "considering that the simulation domain is divided into cubes of side @xmath14 , the diffusive movement of molecules of @xmath1 is then modelled as jumps between neighbouring compartments with rate @xmath15 , where @xmath16 is the diffusion constant of the chemical species @xmath1 . in this paper , we will consider compartment - based stochatic reaction - diffusion models of the trimolecular reactions ( [ basic3])([basic1 ] ) in a narrow domain @xmath17 \\times [ 0,h ] \\times [ 0,h]$ ] where @xmath18 .",
    "such domains are useful for modelling filopodia  @xcite , but they can also be viewed as a simplification of a real three - dimensional geometry when there is no variation in @xmath19 and @xmath20 directions .",
    "then the mean - field model of trimolecular reaction  ( [ basic3 ] ) can be formulated in terms of spatially varying concentration @xmath21 , where @xmath22 $ ] and @xmath23 , which satisfies partial differential equation ( pde ) @xmath24 where @xmath25 is the macroscopic rate constant of the trimolecular reaction . to formulate the compartment - based stochastic reaction - diffusion model",
    ", we divide the domain @xmath17 \\times [ 0,h ] \\times [ 0,h]$ ] into @xmath26 cubic compartments @xmath27 \\times [ 0,h ] \\times [ 0,h ] $ ] , @xmath28 . denoting @xmath29 the number of molecules of @xmath1 in the @xmath30-th compartment",
    ", the diffusion of @xmath1 can be written as the chain of  chemical reactions \"  @xcite @xmath31 diffusion of @xmath2 and @xmath3 , which appear in trimolecular reactions ( [ basic2 ] ) or ( [ basic1 ] ) , is described using the chains of  chemical reactions \" of the form  ( [ diffgillu ] ) with the jump rates given by @xmath32 and @xmath33 , where @xmath34 and @xmath35 are the diffusion constant of the chemical species @xmath2 and @xmath3 , respectively .",
    "trimolecular chemical reactions are localized in compartments , i.e. each of trimolecular reactions   is replaced by @xmath36 reactions : @xmath37 where @xmath28 , and @xmath25 denotes the macroscopic reaction rate constant with units [ m@xmath38 s@xmath39 .",
    "compartment - based modelling postulates that each compartment is well - mixed .",
    "in particular , chemical reactions ( [ diffgillu])([basic1d ] ) can be all simulated using the gillespie algorithm  @xcite ( or other algorithms for well - mixed chemical systems  @xcite ) and the system can be equivalently described using the reaction - diffusion master equation ( rdme )  @xcite . in particular , the probability that a trimolecular reaction occurs in time interval @xmath40 in a compartment containing one triplet of reactants is equal to @xmath41 where @xmath42 and @xmath43 is chosen sufficiently small , so that @xmath44 .",
    "the standard scaling of reaction rates ( [ comprate ] ) is considered in this paper when we investigate the dependence of trimolecular reactions on @xmath14 .",
    "it has been previously reported for bimolecular reactions that the standard rdme scaling leads to large errors of bimolecular reactions  @xcite .",
    "one of the goals of the presented manuscript is to investigate the effect of @xmath14 on trimolecular reactions .",
    "diffusive chain of reactions  ( [ diffgillu ] ) is formulated using a narrow three - dimensional domain @xmath17 \\times [ 0,h ] \\times [ 0,h]$ ] .",
    "it can also be interpretted as a purely one - dimensional simulation . in this case , the simulated domain is one - dimensional interval @xmath17 $ ] , divided into @xmath26 intervals @xmath27 $ ] , @xmath28 , where @xmath29 is the number of molecules of @xmath1 in the @xmath30-th interval .",
    "trimolecular reactions ( [ basic3d])([basic1d ] ) are then written with one - dimensional rate constant @xmath45 which have physical units [ m@xmath46 s@xmath39 .",
    "then the probability that a trimolecular reaction occurs in time interval @xmath40 in an interval containing one triplet of reactants is equal to @xmath47 where @xmath48 and @xmath43 is chosen sufficiently small , so that @xmath49 . in particular ,",
    "two interpretations of the simulated diffusive reaction chain  ( [ diffgillu ] ) considered in this paper differ by physical units of @xmath25 and @xmath50 , and by the corresponding scaling of reaction rate with @xmath14 : compare  ( [ comprate ] ) and ( [ comprate2 ] ) .",
    "the simulated model can also be used to verify the corresponding brownian dynamics result  ( [ asymptoticsofk ] ) , provided that we appropriately relate @xmath14 and @xmath8 , and postulate that the trimolecular reaction occurs ( for sure ) whenever a compartment contains one triplet of reactants  @xcite .",
    "the rest of the paper is organized as follows . in section [ secbimol ] , we summarize recent results for bimolecular reactions in two spatial dimensions for periodic boundary conditions and generalize them to reflective ( no - flux ) boundary conditions .",
    "these results are useful for investigating compartment - based stochastic reaction - diffusion modelling of trimolecular reactions  ( [ basic3])([basic1 ] ) as we will show in section [ sectrimol ] . computational experiments illustrating the presented results are given in section  [ numer ] .",
    "in this paper , we will focus on a special case where there is only one combination of reactants present in the system and we study the times for trimolecular reactions ( [ basic3])([basic1 ] ) to fire . a similar problem for a bimolecular reaction @xmath51 with one @xmath1 molecule and one @xmath2 molecule is investigated in hellander et .",
    "@xcite for both two - dimensional and three - dimensional compartment - based models . dividing two - dimensional domain @xmath52 \\times [ 0 , l]$ ] into square compartments of size",
    "@xmath14 , the mean time until the two molecules react is  @xcite @xmath53 where @xmath54 is the bimolecular reaction rate with units [ m@xmath46 s@xmath39 , and @xmath55 is the mean number of diffusive jumps until @xmath1 and @xmath2 are in the same compartment , given that they are initially one compartment apart .",
    "@xmath56 is the mean number of steps , until @xmath1 diffuses to @xmath2 s location for the first time .",
    "the quantities @xmath56 and @xmath55 can be estimated using the theorem in montroll  @xcite :    [ theorem1 ] assume that the molecule @xmath1 has a uniformly distributed random starting position on a finite two - dimensional square lattice with periodic boundary conditions . then the following holds : @xmath57 where @xmath58 is the number of lattice points ( compartments ) in the domain .",
    "furthermore , @xmath59 .",
    "using theorem  [ theorem1 ] and ( [ taubimo ] ) , we have @xcite @xmath60 where @xmath61 is the mean time for the first collision of molecules @xmath1 and @xmath2 , which can be approximated by @xmath62 as @xmath63 . using ( [ taubimo2])([taucoll2per ] )",
    ", we see that the reaction time for the bimolecular reaction @xmath51 tends to infinity when the compartment size @xmath14 tends to zero  @xcite .",
    "in particular , equations ( [ taubimo2])([taucoll2per ] ) imply that the bimolecular reaction is lost from simulation when @xmath14 tends to zero .",
    "thus there has to be a lower bound for the compartment size .",
    "this has also been shown using different methods in three - dimensional systems and improvements of algorithms for @xmath14 close to the lower bound have been derived  @xcite .",
    "equations  ( [ taubimo2])([taucoll2per ] ) give a good approximation to the mean reaction time of bimolecular reaction for two - dimensional domains , provided that the periodic boundary conditions assumed in theorem  [ theorem1 ] are used .",
    "however , the chain of chemical reactions  ( [ diffgillu ] ) implicitly assumes reflective boundary conditions .",
    "such boundary conditions ( together with reactive boundary conditions ) are commonly used in biological systems whenever the boundary of the computational domain corresponds to a physical boundary ( e.g. cell membrane ) in the modelled system  @xcite . in figure",
    "[ fig1 ] , we show that formula  ( [ taucoll2per ] ) is not an accurate approximation to the mean collision time for reflective boundary conditions .",
    "reflective boundary conditions mean that a molecule remains in the same lattice point when it hits the boundary .",
    "we plot results for @xmath64 , for @xmath65 and for @xmath66 in figure  [ fig1 ] . in each case",
    ", we see that formula  ( [ taucoll2per ] ) matches well with numerical results for periodic boundary conditions . in order to find a formula that matches with numerical experiment results for reflective boundary conditions , we fix the coefficient of the first term in  ( [ taucoll2per ] ) and perform data fitting on the second coefficient .",
    "we obtain the following formula for the reflective boundary condition : @xmath67 the average times for the first collision of @xmath1 and @xmath2 given by ( 18 ) are plotted in figure  [ fig1 ] corresponding to different sets of diffusion rates .",
    "it can be seen that formula  ( [ 2dcollisioncasea ] ) matches well with numerical experiment results with reflective boundary conditions . in figure",
    "[ fig2:casea ] , we show another comparison between formula  ( [ 2dcollisioncasea ] ) and numerical experiment data with reflective boundary conditions .    , @xmath68 ; ( b ) @xmath69 , @xmath68 ; ( c ) @xmath70 , @xmath71.__,width=288 ]     values when @xmath72 is fixed .",
    "we use @xmath73 and @xmath74 .",
    "_ , width=288 ]",
    "in this paper , we will first consider periodic boundary conditions and generalize formula  ( [ taubimo2 ] ) to all cases of trimolecular reactions ( [ basic3])([basic1 ] ) in one spatial dimension , using both scalings  ( [ comprate ] ) and ( [ comprate2 ] ) of reaction rates .",
    "both trimolecular reactions and are special cases of  . since we will focus on the simplified situation where there is only one molecule for each reactant of  , we may consider   as the special case of   where diffusion rates for all three molecules are the same , and   as the special case where at least two of the three molecules have the same diffusion rates .",
    "we will denote the value of mean reaction time by @xmath75 .",
    "we will decompose @xmath75 into two parts : @xmath76 where @xmath77 gives the mean time for reaction given that the molecules are initially located in the same compartment , and @xmath61 is the mean time for the first collision , i.e. the average time to the state of the system which has all molecules in the same compartment , given that they were initially uniformly distributed .",
    "note that the bimolecular formula ( [ taubimo ] ) was written in the form of a similar decomposition like  ( [ trimolformula ] ) .",
    "we will call @xmath61 a collision time .",
    "we will start with a simple case with @xmath78 and @xmath79 .",
    "then the only @xmath3 molecule will be fixed at its initial location . under the periodic boundary condition assumption , without loss of generality , we assume that this @xmath3 molecule is located at the center of the interval @xmath17 $ ] , or specifically , in the compartment @xmath80 $ ] , where @xmath81 $ ] represents the largest integer that is smaller than @xmath82 .",
    "the @xmath1 and @xmath2 molecules diffuse according to ( [ diffgillu ] ) from their initial compartments .",
    "the reaction can fire only when both @xmath1 and @xmath2 molecules jump to the center since the only @xmath3 molecule is at the center .",
    "let @xmath61 be the mean time for these two molecules ( @xmath1 and @xmath2 ) to be both at the center for the first time , which requires that their compartment number is equal to @xmath80 $ ] .    instead of trying to develop a formula for the collision time of two molecules diffusing to a fixed compartment in the one - dimensional lattice , we consider an equivalent problem",
    ": imagine a @xmath13 molecule jumps with a diffusion rate @xmath16 within an @xmath83 grid in the two - dimensional space and let its compartment index be @xmath84 .",
    "then the two independent random walks by the two @xmath1 and @xmath2 molecules in one - dimensional lattice can be viewed equivalently as the random walk of the @xmath13 molecule in the two - dimensional square lattice with diffusion rate @xmath16 .",
    "collision time @xmath61 is then equal to the mean time for the pseudo molecule @xmath13 to jump to the center for the first time , which is the case discussed in section ii .",
    "therefore , the formula   can also be applied to the trimolecular reaction   when @xmath79 and @xmath64 and periodic boundary conditions are considered .",
    "formula can not be directly applied to if @xmath86 even if @xmath79 .",
    "we can still assume @xmath3 is in the center and consider the equivalent problem of a @xmath13 molecule jumps with a diffusion rate @xmath16 in the @xmath82 axis and @xmath34 in the @xmath19 axis within an @xmath83 grid in the 2d space .",
    "the two independent random walks by the two @xmath1 and @xmath2 molecules in 1d space can be viewed equivalently as the random walk of the @xmath13 molecule in the 2d space with diffusion rate @xmath16 and @xmath34 .",
    "we thus introduce the following theorem .",
    "the proof can be found in appendix [ new2d ] .",
    "[ theorem2 ] assume that the molecule @xmath13 has a uniformly distributed random starting position in a 2d lattice and that the molecules can move to nearest neighbours only .",
    "assume @xmath13 diffuses with diffusion rate @xmath16 in the @xmath82 direction , @xmath34 in the @xmath19 direction , and @xmath87 .",
    "then the following holds : @xmath88 ,   \\end{array}\\ ] ] where @xmath89      in this subsection we consider the trimolecular reaction with corresponding diffusion rates @xmath16 , @xmath34 and @xmath35 . without loss of generality , we assume @xmath90 .",
    "we consider one pseudo molecule @xmath91 , where @xmath92 and @xmath93 are expressed in terms of locations @xmath94 , @xmath95 and @xmath96 of three molecules by @xmath97 when @xmath1 , @xmath2 and @xmath3 diffuses with rates @xmath16 , @xmath34 and @xmath35 , the pseudo molecule @xmath13 jumps on the 2d lattice corresponding to .",
    "when @xmath13 jumps to the origin , @xmath1 , @xmath2 and @xmath3 will be in the same grid , and vice versa .",
    "thus the collision time of the trimolecular reaction in 1d is again converted to the corresponding collision time of the bimolecular problem in 2d .",
    "the actual grid and jumps are illustrated in figure [ 2dillustrate2 ] .",
    "based on . when @xmath1 molecule jumps , the corresponding @xmath13 jumps ( shown in red ) the direction @xmath98 .",
    "when @xmath2 molecule jumps , the corresponding @xmath13 jumps ( shown in green ) the direction @xmath99 ; when @xmath3 molecule jumps , the corresponding @xmath13 jumps ( shown in blue ) the direction @xmath100 .",
    "the whole domain has a similar shape and is not square . _ ]    the difficulty of the mapping is that the resulted domain is not square .",
    "so we can not apply the theoretical results presented in the appendix . in order to apply an estimation on a square lattice",
    ", we need to further modify the mapping .",
    "we will take @xmath101 then the molecule @xmath13 with coordinates @xmath102 will jump in an @xmath83 2d square lattice , where @xmath103 . of course , the jumps at the boundary will be different from the illustration in figure [ 2dillustrate2 ] , but that is just symmetric reflection .",
    "it does not change the validity of the formula derived in the appendix , which is based on the assumption of periodic lattices .",
    "the domain resulted from the mapping is shown in figure [ square ] .",
    "we have the following approximation formula for the mean jump time .",
    "@xmath104 .",
    "\\end{array } \\ ] ] where @xmath105 and @xmath106    * remark : * formula also implies an estimation of the collision time of bimolecular reaction in a 1d domain . in , if we let @xmath107 , the formula leads to an estimation of the mean collision time of a bimolecular reaction @xmath108 in a 1d domain @xmath109 $ ] , which is independent of @xmath14 @xmath110      as shown in section [ numer ] , formula matches with the result computed by stochastic simulations for periodic boundary condition very well .",
    "however , when we consider a reflective boundary condition , we see a mismatch . in order to find a formula that matches with the reflective boundary condition results , we performed numerical experiments and collected the mean collision time with reflective boundary conditions .",
    "then with data fitting , we managed to find the formula that matches with numerical results corresponding to reflective boundary conditions .",
    "( see appendix  [ specialcase ] for derivation of the coefficient of @xmath111 . )",
    "equation   gives an estimation of the mean first collision time of 1d trimolecular reaction @xmath112 , \\end{array}\\ ] ] where @xmath113 is defined in equation and @xmath114 is defined in equation .",
    "* remark : * when we let @xmath115 , we have @xmath116      formula gives the estimation for the mean collision time @xmath61 of trimolecular reactions . for the first reaction time @xmath75 , since our derivation is based on corresponding analysis on 2d grids , an estimation similar to the equation can be applied",
    ". we have @xmath117 as @xmath63 , where @xmath50 is the reaction rate for the trimolecular reaction as defined in and .    for biochemical reactions with reflective boundary conditions",
    ", we have the formula for the corresponding mean reaction time : @xmath118 .",
    "\\end{array}\\ ] ]    correspondingly , if we use the scaling in , takes the form @xmath119 .",
    "\\end{array}\\ ] ] we can see that as @xmath120 , the reaction time will be dominated by the collision time in either case .",
    "we test the collision time of the general trimolecular reaction . figure  [ collisiontime:1 ] shows the comparison of the numerical results of the mean first collision time with periodic and reflective boundary conditions with the two formulas and .",
    "figure  [ collisiontime:1 ] demonstrates that formula matches well with computational results obtained by stochastic simulations corresponding to periodic boundary conditions , justifying our analysis .",
    "it also shows that formula matches well with experimental results corresponding to reflective boundary conditions .",
    "figure  [ collision time:2 ] shows the plot of numerical results of the mean first collision time with periodic and reflective boundary conditions corresponding to different @xmath16 when we fix @xmath121 , @xmath34 and @xmath35 .",
    "we can see that the two formulas match with the numerical results very well .",
    "we also present another comparison and analysis for the special case when @xmath115 in appendix [ specialcase ] .    for the mean reaction time comparison , we focus only on reflective boundary condition .",
    "in figure [ reactiontime ] , we show the comparison of mean reaction time with formula corresponding to a fix set of diffusion rates and different reaction rates @xmath50 .",
    "the important consequence of formula and formula is that when @xmath63 , @xmath122 . since trimolecular reaction time @xmath123",
    ", the reaction time also tends to infinity . in particular , our analysis confirms the observations made in  @xcite that the diffusion - limited three - body reactions do not recover mean - field mass - action results in 1d .",
    "the rate constant in for such problems is time dependent , given by , and converges to zero as @xmath124 . in the limit @xmath125 , the average collision time goes to infinity and the rate constant k(t ) in converges to zero for any finite time .",
    "it is given by , where @xmath126 converges to zero as @xmath125 . in recent years , this topic has been discussed for the bimolecular reaction in the 2d and 3d cases as well . this limitation is a great challenge for spatial stochastic simulation .",
    "* acknowledgments . *",
    "the research leading to these results has received funding from the european research council under the _",
    "european community _ s seventh framework programme ( _ fp7/2007 - 2013_)/erc _ grant agreement _",
    "n@xmath127 239870 .",
    "radek erban would like to thank the royal society for a university research fellowship and the leverhulme trust for a philip leverhulme prize .",
    "this work was carried out during the visit of radek erban to the isaac newton institute .",
    "this work was partially supported by a grant from the simons foundation .",
    "10    j.  schnakenberg .",
    "simple chemical reaction systems with limit cycle behaviour . , 81:389400 , 1979 .",
    "f.  schlgl .",
    "chemical reaction models for non - equilibrium phase transitions .",
    ", 253(2):147161 , 1972 .",
    "l.  qiao , r.  erban , c.  kelley , and i.  kevrekidis .",
    "spatially distributed stochastic systems : equation - free and equation - assisted preconditioned computation .",
    ", 125:204108 , 2006 .",
    "g.  oshanin , a.  stemmer , s.  luding , and a.  blumen .",
    "smoluchowski approach for three - body reactions in one dimension .",
    ", 52(6):58005805 , 1995 .",
    "t.  plesa , t.  vejchodsk , and r.  erban .",
    "chemical reaction systems with a homoclinic bifurcation : an inverse problem .",
    "submitted to _ mathematical models and methods in applied sciences _ , available as http://arxiv.org/abs/1510.07205 , 2015 .",
    "r.  erban , s.  j. chapman , i.  kevrekidis , and t.  vejchodsky .",
    "analysis of a stochastic chemical system close to a sniper bifurcation of its mean - field model .",
    ", 70(3):9841016 , 2009 .",
    "j.  paulsson , o.  berg , and m.  ehrenberg .",
    "stochastic focusing : fluctuation - enhanced sensitivity of intracellular regulation .",
    ", 97(13):71487153 , 2000 .",
    "m.  elowitz , a.  levine , e.  siggia , and p.  swain .",
    "stochastic gene expression in a single cell .",
    ", 297:11831186 , 2002 .",
    "d.  gillespie .",
    "exact stochastic simulation of coupled chemical reactions .",
    "81(25):23402361 , 1977 .    m.  gibson and j.  bruck .",
    "efficient exact stochastic simulation of chemical systems with many species and many channels .",
    ", 104:18761889 , 2000 .",
    "y.  cao , h.  li , and l.  petzold .",
    "efficient formulation of the stochastic simulation algorithm for chemically reacting systems .",
    ", 121(9):40594067 , 2004 .",
    "r.  erban , s.  j. chapman , and p.  maini .",
    "a practical guide to stochastic simulations of reaction - diffusion processes .",
    "35 pages , available as http://arxiv.org/abs/0704.1908 , 2007 .",
    "r.  erban and s.  j. chapman .",
    "reactive boundary conditions for stochastic simulations of reaction - diffusion processes . , 4(1):1628 , 2007 .",
    "s.  andrews and d.  bray .",
    "stochastic simulation of chemical reactions with spatial resolution and single molecule detail .",
    ", 1:137151 , 2004 .",
    "k.  takahashi , s.  tanase - nicola , and p.  ten",
    "spatio - temporal correlations can drastically change the response of a mapk pathway .",
    ", 107:1982019825 , 2010 .",
    "j.  hattne , d.  fange , and j.  elf .",
    "stochastic reaction - diffusion simulation with mesord .",
    ", 21(12):29232924 , 2005 .",
    "s.  engblom , l.  ferm , a.  hellander , and p.  ltstedt .",
    "simulation of stochastic reaction - diffusion processes on unstructured meshes .",
    ", 31:17741797 , 2009 .    r.  erban . from molecular dynamics to brownian dynamics . , 470:20140036 , 2014 .",
    "r.  erban . coupling all - atom",
    "molecular dynamics simulations of ions in water with brownian dynamics .",
    "proceedings of the royal society a , volume 472 , number 2186 , 20150556 ( 2016 ) .",
    "r.  erban and s.  j. chapman .",
    "stochastic modelling of reaction - diffusion processes : algorithms for bimolecular reactions .",
    ", 6(4):046001 , 2009 .",
    "i.  agbanusi and s.  isaacson . a comparison of bimolecular reaction models for stochastic reaction - diffusion systems . ,",
    "volume 76 , number 4 , pp .",
    "922 - 946 ( 2014 ) .",
    "m.  flegg .",
    "smoluchowski reaction kinetics for reactions of any order .",
    "submitted , available as http://arxiv.org/abs/1511.04786 , 2015 .",
    "d.  torney and h.  mcconnell . diffusion - limited reactions in one dimension .",
    ", 87(11):19411951 , 1983 .",
    "d.  torney and h.  mcconnell . diffusion - limited reaction rate theory for two - dimensional systems .",
    ", 387:147170 , 1983 .",
    "d.  ben avraham .",
    "diffusion - limited three - body reactions in one dimension . , 71(24):37333735 , 1993 .",
    "d.  gillespie . .",
    "academic press , inc .",
    ", harcourt brace jovanowich , 1992 .",
    "r.  erban , m.  flegg , and g.  papoian .",
    "multiscale stochastic reaction - diffusion modelling : application to actin dynamics in filopodia .",
    ", 76(4):799818 , 2014 .",
    "s.  hellander , a.  hellander , and l.  petzold .",
    "reaction - diffusion master equation in the microscopic limit . , 85:042901 , 2012 .",
    "e.  montroll .",
    "random walks on lattices .",
    "calculation of first - passage times with application to exciton trapping on photosynthetic units .",
    ", 10(4):753765 , 1969 .",
    "we consider the random walk problem on a square 2d lattice .",
    "the estimation procedure we present here is generalized from the original idea in montroll  @xcite . following the notations in montroll  @xcite ,",
    "let @xmath128 be the probability that a lattice walker which starts at the origin arrives at a lattice point @xmath129 for the first time after @xmath130 steps and @xmath131 be the generating function of the set @xmath132 .",
    "montroll showed that @xmath133/p(0,z),\\ ] ] where @xmath134 is the generating function @xmath135 where @xmath136 is the probability that a walker starting from the origin attires at @xmath129 for the first time after @xmath130 steps , no matter how many previous visits he already had at @xmath129 .",
    "the generating function for the probability that a walker will be trapped at the origin in a given number of steps is @xmath137 where @xmath138 ( with @xmath139 ) is the total number of grids in the square 2d lattice .",
    "the average number  @xcite of steps required to reach the origin for the first time is @xmath140 in order to find the formula for @xmath141 , the structure function is defined as @xmath142 where @xmath143 is the probability that at any step a random walker makes a displacement @xmath129 .",
    "@xmath144 . in this 2d square lattice",
    ", we consider a general problem .",
    "suppose the random walk can jump to left and right with rate @xmath145 , to up and down with rate @xmath146 , and to the diagonal directions with rate @xmath147 .",
    "let @xmath148 , @xmath149 , and @xmath150 , we thus have @xmath151 there are some special cases . in a uniform diffusion case , @xmath152 . in the case",
    "@xmath79 , @xmath153 and then when @xmath154 , that will be the simple case discussed in montroll  @xcite . here",
    "we will simply derive the general formula and then discuss different special cases . for the probability @xmath143 we have @xmath155/2 and @xmath156 , @xmath157 and @xmath158 where @xmath159 , @xmath160 and @xmath161",
    ". then @xmath162^{-1}.\\ ] ] in order to obtain @xmath163 , we need to estimate @xmath164 . following montroll s work  @xcite , @xmath165^{-1 } f(z , \\theta_1 ) , \\ ] ] where @xmath166 ^{-1},\\ ] ] with @xmath167 and @xmath168 following appendix a of montroll  @xcite , we define @xmath169 . thus @xmath170 then ( equation ( a7 ) in montroll  @xcite ) @xmath171 where @xmath82 is the smaller root of the equation @xmath172 now we estimate @xmath164 as @xmath173 first , when @xmath174 , @xmath175 , @xmath176 , @xmath177 and @xmath178 . then @xmath179 the corresponding term in @xmath164 is given by @xmath180^{-\\frac{1}{2 } } ,       \\end{array}\\ ] ] where @xmath181 and @xmath182",
    ". now we estimate @xmath82 defined as in equation . @xmath183/\\rho \\\\      & = & \\frac{1 - z\\sigma_1 ^ 2 - \\sqrt{1 - z } \\sqrt{1 + z - 2\\sigma_1 ^ 2z } }      { z ( 1 - \\sigma_1 ^ 2)}\\\\      & = & 1 - 2\\beta + 2\\sigma_1 ^ 2 \\beta^2 -       ( 2\\sigma_1 ^ 2 - 3)\\beta^3 + \\cdots .",
    "\\end{array}\\ ] ] when @xmath184 is large , we have estimate @xmath185 thus @xmath186 then the @xmath174 term is given by @xmath187^{-1 } + \\frac{1}{6(1 - \\sigma_1 ^ 2 ) } + o(1-z)^{1/2}.\\ ] ] for other values of @xmath188 as @xmath189 , @xmath190^{1/2 } \\\\ & = &   \\sqrt{1- c_1 } \\left ( 1 - \\sigma_2 ^ 4 - \\sigma_3 ^ 4 - c_1 \\sigma_1 ^ 4 \\right ) ^{1/2 }   \\\\ & = & \\sqrt{1- c_1 } \\sqrt{2(\\sigma_1 ^ 2\\sigma_2 ^ 2 + \\sigma_1 ^ 2\\sigma_3 ^ 2 + \\sigma_2 ^ 2\\sigma_3 ^ 2 ) + \\sigma_1 ^ 4 ( 1 - c_1 ) } \\\\ & = & 2 \\sqrt{\\sigma_1 ^ 2\\sigma_2 ^ 2 + \\sigma_1 ^",
    "2\\sigma_3 ^ 2 + \\sigma_2 ^ 2\\sigma_3 ^ 2 }   \\sin ( \\pi k_1/m ) \\\\ & & \\times \\left[1 + \\eta \\sin^2 ( \\pi k_1/m ) \\right ] ^{1/2 } ,   \\end{array}\\ ] ] where @xmath191 thus @xmath192^{-1 } + \\frac{1}{2(1 - \\sigma_1 ^ 2 ) } \\left [ \\frac{1}{3 } +       \\frac{\\phi(0,1)}{r}\\right ] + o(1-z)^{1/2},\\ ] ] where @xmath193 and @xmath194 with @xmath195^{-1/2 } - 1 } { \\sin(\\pi k / m ) } , \\\\",
    "s_3 & = & \\frac{1}{m } \\sum_{k=1}^{m-1 } \\frac{1}{\\sin(\\pi k / m ) } \\left\\ { \\frac{2x^m(\\cos \\phi m - x^m)}{1 - 2x^m \\cos \\phi m +   x^{2 m } } \\right \\ } \\\\ & & \\times   [ 1 + \\eta \\sin^2 ( \\pi k / m)]^{-1/2}. \\end{aligned}\\ ] ] following the appendix a in montroll  @xcite , there are estimates for @xmath196 , @xmath197 .",
    "@xmath198 - \\frac{\\pi^2}{72 m^2 } + \\cdots \\right\\}.\\ ] ] @xmath199 the estimation for @xmath200 is complicated . but fortunately @xmath200 s contribution to @xmath201 can be considered small @xmath202 , defined in , is not too small .",
    "note that we can obtain an estimation ( see appendix in montroll  @xcite ) @xmath203/\\rho \\approx 1 - 2rs + 2r^2s^2 + \\cdots,\\ ] ] where @xmath204 and @xmath202 is given in .",
    "thus @xmath205 if @xmath202 is close to zero , @xmath206 will be close to one",
    ". then @xmath207 will be very large , and so will @xmath200 .",
    "but if @xmath202 is large , @xmath206 will be close to zero ( except for the term @xmath208 ) and @xmath200 will be small . in order to control the error from the @xmath200 term , we always choose @xmath16 , @xmath34 and @xmath35 such that @xmath209 . in this way",
    "@xmath210 ^{1/2 } \\geq \\frac{\\sqrt{2}}{2}$ ] and @xmath200 will remains relatively small , when @xmath184 is large .",
    "thus we will simply disregard the @xmath200 term in our formula .    to sum it up ,",
    "when we choose @xmath211 and considering @xmath138 , we disregard @xmath200 and have an estimate of @xmath201 as @xmath212^{-1 } + \\ { c_1 \\log n + c_2 + c_3/n \\ }       \\\\ & & + o(n^{-2 } ) + o((1-z)^{1/2 } ) ,   \\end{array}\\ ] ] where @xmath213,\\\\   c_3 & = & \\frac{\\pi}{24   \\hat \\sigma } ( \\eta - 1/3 ) , \\end{aligned}\\ ] ] with @xmath214 @xmath215 and @xmath216 . according to ,",
    "we have @xmath217    now consider the special case @xmath79 .",
    "then @xmath153 and the domain is really a square lattice . in this case , we have @xmath218 @xmath219 and @xmath220 if we select @xmath87 ( thus @xmath221 ) , @xmath222 , the @xmath200 term will be relatively small . then multiply with the average time for each jump @xmath223 , where @xmath224 , apply @xmath225 , and disregard lower order terms , we obtain @xmath226 .",
    "\\end{array}\\ ] ] if we assume further that @xmath64 , the equation is close to except a small difference due to the @xmath200 term .",
    "note that in this case , the formula is a rigorous estimate .",
    "if @xmath227 , and assume the 2d lattice is square , we let @xmath228 and multiply with @xmath229 , we end up with a similar estimation @xmath230 .",
    "\\end{array } \\ ] ] where @xmath231 and @xmath232",
    "when the diffusion rate of @xmath1 approaches to infinity , the trimolecular system becomes a bimolecular collision model of @xmath2 and @xmath3 .",
    "the formula   gives the mean time for bi - molecular collisions , when @xmath233 : @xmath234 in this subsection , we investigate the mean bi - molecular collision time and derive the formula for bi - molecular collision time when the other two molecules have a same diffusion rate @xmath235 .",
    "assume a 1d domain of length @xmath236 , two molecules @xmath2 and @xmath3 diffuse freely with the rate @xmath34 and @xmath35 respectively .",
    "the 1d diffusion model of two molecules is equivalent to the 2d model in which one molecule diffuses freely with diffusion rates @xmath34 and @xmath35 in the two directions , independently .",
    "the first time for the two molecules to collide in the same position is equivalent to the fist time when the molecule in the 2d domain comes across the diagonal line . with the reflective boundary condition ,",
    "the triangle domain divided by the diagonal line can be extended into a square domain with the length @xmath237 .",
    "the first encounter time of two molecules on the 1d domain of size @xmath236 is now converted to a first exit time of on molecule on a 2d domain of size @xmath238 .    in the following , we derive the formula for the first exit time on the 2d domain . for simplicity",
    ", we assume the diffusion rate in the two directions are the same @xmath239 .",
    "the plank - fokker equation for the diffusion in the 2d domain is given by @xmath240 with @xmath241 being the state density function , defined as the probability density that the molecule stays in position @xmath242 at time @xmath243 given it starts from @xmath244 at time @xmath245 .",
    "next , we define a probability function @xmath246 which describes the probability that the molecule stays in the domain @xmath247 at time @xmath243 , given it starts from @xmath244 at time @xmath248 . then , we integrate the plank - fokker equation   over the 2d interval @xmath249 and we have the equation for @xmath250 : @xmath251 the initial condition for the pde   is given as @xmath252 the four boundaries of the square domain @xmath249 are all absorbing .",
    "hence , we have the boundary conditions for pde   as @xmath253    following the definition of @xmath254  , @xmath255 gives the probability that the molecule exits @xmath249 before time @xmath243 , which is exactly the distribution function of the first exit time @xmath256 .",
    "in addition , the density function of @xmath256 is given by @xmath257      = -\\frac{\\partial}{\\partial t}g(\\mathbf{x_0 } , t ; \\omega ) ,      \\label{fpt : pdf}\\ ] ] and the @xmath130-th moment @xmath258 of the random variable @xmath256 is therefore given by @xmath259      dt , ( n \\ge 0 ) .",
    "\\label{fpt : moment}\\ ] ] for @xmath260 , the formula gives @xmath261 integrating   by parts , we get the formula @xmath262 with equation   and we can formulate the moments of @xmath258 as coupled ordinary differential equations .",
    "multiply the plank - fokker equation   through by @xmath263 , integrating the result over all @xmath243 and substitute from equation   and , we have the equation @xmath264 the boundary conditions for these differential equations follows the simple derivation from   and we have @xmath265    with the equations ready , we can solve for the moments of the first passage time .",
    "here we are only interested in the first moment and the solution to the pde of the first moment equation yields @xmath266 if initially the molecule is homogeneously presented in the square domain , we can calculate the mean first exit time as @xmath267    therefore , the mean first time when the first two molecules encounter in the 1d domain of size @xmath268 is exactly the same as the mean first exit time above and the mean first encounter time is given by @xmath269    figure  [ bmetime ] and figure  [ bmetime2 ] show the numerical results of the mean first collision time for two molecules with the same diffusion rates and for the general situations . the linear data fitting shows the excellent match with the formula  .",
    "furthermore , although our derivation is only for the case @xmath235 , the numerical results show that the first collision time for the general situation , where @xmath270 , follows the similar formula . this formula is given as @xmath271    for comparison purpose , figure [ periodbme ]",
    "gives the numerical results of the mean first collision time , under periodic boundary condition , for two molecules with different diffusion rates @xmath270 .",
    "we can see that the numerical results match with very well ."
  ],
  "abstract_text": [
    "<S> trimolecular reaction models are investigated in the compartment - based ( lattice - based ) framework for stochastic reaction - diffusion modelling . </S>",
    "<S> the formulae for the first collision time and the mean reaction time are derived for the case where three molecules are present in the solution . </S>"
  ]
}