{
  "article_text": [
    "a large number of numerical methods have been developed to simulate interactions between fluid flows and immersed bodies . for rigid bodies or bodies with prescribed kinematics , many of these approaches @xcite are based on the immersed boundary ( ib ) method of peskin @xcite .",
    "the simplicity , flexibility , and power of the ib method for handling a broad range of fluid - structure interaction problems was demonstrated by bhalla _",
    "_ @xcite . in that study",
    ", the authors showed that the ib method can be used to model complex flows around rigid bodies moving with specified kinematics ( e.g. , swimming fish or beating flagella ) as well as to compute the motion of freely moving bodies driven by flow . in the approach of bhalla _",
    ", as well as those of others @xcite , the rigidity constraint enforcing that the fluid follows the motions of the rigid bodies is imposed only _ approximately . _ here and throughout this manuscript , when we refer to the _ no slip condition _ , we mean the requirement that the interpolated fluid velocity exactly match the rigid body velocity at the positions of the ib marker points__. _ _ in this work , we develop an effective solution approach to an ib formulation of this problem that _ exactly _ enforces both the incompressibility and no - slip constraints , thus substantially improving upon a large number of existing techniques .",
    "a simple approach to implementing rigid bodies using the traditional ib method is to use stiff springs to attach markers that discretize the body to tether points constrained to move as a rigid body @xcite .",
    "this penalty - spring approach leads to numerical stiffness and , when the forces are handled explicitly , requires very small time steps .",
    "for this reason , a number of _ direct forcing _ ib methods @xcite have been developed that aim to constrain the flow inside the rigid body by treating the fluid - body force as a lagrange multiplier @xmath0 enforcing a no - slip constraint at the locations of the ib markers .",
    "however , to our knowledge , all existing direct forcing ib methods use some form of time step splitting to separate the coupled fluid - body problem into more manageable pieces .",
    "the basic idea behind these approaches is first to solve a simpler system in which a number of the constraints ( e.g. , incompressibility , or no - slip along the fluid - body interface ) are ignored .",
    "the solution of the unconstrained problem is then _ projected _ onto the constraints , which yields _ estimates _ of the true lagrange multipliers . in most existing methods ,",
    "the fluid solver uses a fractional time stepping scheme , such as a version of chorin s projection method , to separate the velocity update from the pressure update @xcite .",
    "taira and colonius also use a fractional time - stepping approach in which they split the velocity from the lagrange multipliers @xmath1 .",
    "they obtain approximations to @xmath1 in a manner similar to that in a standard projection method for the incompressible navier - stokes equations .",
    "a modified poisson - type problem ( see ( 26 ) in @xcite ) determines the lagrange multipliers and is solved using an unpreconditioned conjugate gradient method .",
    "the method developed in ref .",
    "@xcite avoids the pressure - velocity splitting and instead uses a combined iterative stokes solver , and in ref .",
    "@xcite ( see supplementary material ) , periodic boundary conditions are applied , which allows for the use of a pseudo - spectral method . in both works , however , time step splitting is still used to separate the computation of the rigidity constraint forces from the updates to the fluid variables . in the approach described in the supplementary material to ref .",
    "@xcite , the projection step of the solution onto the rigidity constraint is performed twice in a predictor - corrector framework , which improves the imposition of the constraint ; however , this approach does not control the accuracy of the approximation of the constraint forces .",
    "curet et al .",
    "@xcite and ardekani et al .",
    "@xcite go a step closer in the direction of exactly enforcing the rigidity constraint by iterating the correction until the relative slip between the desired and imposed kinematics inside the rigid body reaches a relatively loose tolerance of 1% . the scheme used in ref .",
    "@xcite is essentially a fixed - point ( richardson ) iteration for the constrained fluid problem , which uses splitting to separate the update of the lagrange multipliers from a fluid update based on the simpler scheme @xcite . unlike the approach developed here , fixed point iterations based on splitting",
    "are not guaranteed to converge , yet alone converge rapidly , especially in the steady stokes regime for tight solver tolerances .",
    "an alternative view of direct forcing methods that use time step splitting is that they are penalty methods for the unsplit problem , in which the penalty parameter is related to the time step size .",
    "such approaches inherently rely on inertia and implicitly assume that fluid velocity has memory . consequently , _ all _ such splitting methods fail in the steady stokes limit .",
    "furthermore , even at finite reynolds numbers , methods based on splitting can not exactly satisfy the no - slip constraint at fluid - body interfaces .",
    "such methods can thereby produce undesirable artifacts in the solution , such as penetration of the flow through a rigid obstacle .",
    "it is therefore desirable to develop a numerical method that solves for velocity , pressure , and fluid - body forces in a single step with controlled accuracy and reasonable computational complexity .",
    "the goal of this work is to develop an effective ib method for rigid bodies that does not rely on any splitting .",
    "our method is thus applicable over a broad range of reynolds numbers , including steady stokes flow , and is able to impose rigidity constraints exactly .",
    "this approach requires us to solve large linear systems for velocity , pressure , and fluid - body interaction forces .",
    "this linear system is not new .",
    "for example , ( 13 ) in ref .",
    "@xcite is essentially the same system of equations that we study here .",
    "the primary contributions of this work are that we do not rely on any approximations when solving this linear system , and that we develop an effective preconditioner based on an approximation of the schur complement that allows us to solve ( [ eq : constrained_stokes ] ) .",
    "the resulting method has a computational complexity that is only a few times larger than the corresponding problem in the absence of rigid bodies . in the context of steady stokes",
    "flows , a rigid - body ib formulation very similar to the one we use here has been developed by bringley and peskin @xcite ; however , that formulation relies on periodic boundary conditions , and uses a very different spatial discretization and solution methodology from the approach we describe here .",
    "our approach can readily handle a broad range of specified boundary conditions . in both refs .",
    "@xcite and a very recent work by stein _",
    "et al_. on a higher - order ib smooth extension method for scalar ( e.g. , poisson ) equations @xcite , the schur complement is formed densely in an expensive pre - computation stage . by contrast , in the method proposed here we build a simple _ physics - based _ approximation of the schur complement that can be computed `` on the fly '' in a scalable and efficient manner .",
    "our basic solution approach is to use a preconditioned krylov solver for the fully constrained fluid problem , as has been done for some time in the context of finite element methods for fluid flows interacting with elastic bodies @xcite .",
    "a key difficulty that we address in this work is the development of an efficient preconditioner for the constrained formulation .",
    "to do so , we construct an _ analytical _ approximation of the schur complement ( i.e. , the mobility matrix ) corresponding to lagrangian rigidity forces ( i.e. , lagrange multipliers ) enforcing the no - slip condition at the positions of the ib markers .",
    "we rely on the near translational and rotational invariance of peskin s ib method to approximate the schur complement , following techniques commonly used for suspensions of rigid spheres in steady stokes flow such as stokesian dynamics @xcite , bead methods for rigid macromolecules @xcite and the method of regularized stokeslets @xcite .",
    "in fact , as we explain herein , many of the techniques developed in the context of steady stokes flow can be used with the ib method both at zero and also , perhaps more surprisingly , finite reynolds numbers .",
    "the method we develop offers an attractive alternative to existing techniques in the context of steady or nearly - steady stokes flow of suspensions of rigid particles . to our knowledge , most other approaches tailored to the steady stokes limit rely on green s functions for stokes flow to eliminate the ( eulerian ) fluid degrees of freedom and solve only for the ( lagrangian ) degrees of freedom associated to the surface of the body . because these approaches rely on the availability of analytical solutions",
    ", handling non - trivial boundary conditions ( e.g. , bounded systems ) is complicated @xcite and has to be done on a case - by - case basis @xcite .",
    "by contrast , in the method developed here , analytical green s functions are replaced by an `` on the fly '' computation that may be carried out by a standard finite - volume , finite - difference , or finite - element fluid solver .",
    "such solvers can readily handle nontrivial boundary conditions .",
    "furthermore , suspensions at small but nonzero reynolds numbers can be handled without any extra work .",
    "additionally , we avoid uncontrolled approximations relying on truncations of multipole expansions to a fixed order @xcite , and we can seamlessly handle arbitrary body shapes and deformation kinematics . for problems involving active @xcite particles , it is straightforward to add osmo- or electro - phoretic coupling between the fluid flow and additional fluid variables such as the electric potential or the concentration of charged ions or chemical reactants .",
    "lastly , in the spirit of fluctuating hydrodynamics @xcite , it is straightforward to generate the stochastic increments required to simulate the brownian motion of small rigid particles suspended in a fluid by including a fluctuating stress in the fluid equations .",
    "we also point out that our method also has some disadvantages compared to methods such as boundary integral or boundary element methods .",
    "notably , it requires filling the domain with a dense uniform fluid grid , which is expensive at low densities .",
    "it is also a low - order method that can not compute solutions as accurately as spectral boundary integral formulations .",
    "we do believe , nevertheless , that the method developed here offers a good compromise between accuracy , efficiency , scalabilty , flexibility and extensibility , compared to other more specialized formulations .",
    "our notation uses the following conventions where possible .",
    "vectors ( including multi - vectors ) , matrices , and operators are bolded , but when fully indexed down to a scalar quantity we no longer bold the symbol ; matrices and operators are also scripted .",
    "we denote eulerian quantities with lowercase letters , and the corresponding lagrangian quantity with the same capital letter .",
    "we use the latin indexes @xmath2 to denote a specific fluid grid point or ib marker ( i.e. , physical location with which degrees of freedom are associated ) , the indices @xmath3 to denote a specific body in the multibody context , and greek superscripts @xmath4 to denote specific cartesian components .",
    "for example , @xmath5 denotes fluid velocity ( either continuum or discrete ) , with @xmath6 being the fluid velocity in direction @xmath7 associated with the face center @xmath8 , and @xmath9 denotes the velocity of all ib markers , with @xmath10 being the velocity of marker @xmath11 along direction @xmath7 . our formulation is easily extended to a collection of rigid bodies , but for simplicity of presentation , we focus on the case of a single body .",
    "we consider a region @xmath12 ( @xmath13 or @xmath14 ) that contains a single rigid body @xmath15 immersed in a fluid of density @xmath16 and shear viscosity @xmath17 .",
    "the computational domain @xmath18 could be a periodic region ( topological torus ) , a finite box , an infinite domain , or some combination thereof , and we will implicitly assume that some consistent set of boundary conditions are prescribed on its boundary @xmath19 even though we will not explicitly write this in the formulation .",
    "we require that the linear velocity of a given reference point ( e.g. , the center of mass of the body ) @xmath20 and the angular velocity @xmath21 of the body are specified functions of time , and without loss of generality , we assume that the rigid body is at rest .",
    "in addition to features of the fluid flow , typical quantities of interest are the total drag force @xmath22 and total drag torque @xmath23 between the fluid and the body .",
    "another closely related problem to which ib methods can be extended is the case when the motion of the rigid body ( i.e. , @xmath20 and @xmath21 ) is not known but the body is subject to specified external force @xmath22 and torque @xmath23 .",
    "for example , in the sedimentation of rigid particles in suspension , the external force is gravity and the external torque is zero .",
    "handling this _ free kinematics _",
    "problem @xcite requires a nontrivial extension of our formulation and numerical algorithm .    in the immersed boundary ( ib )",
    "method @xcite , the velocity field @xmath24 is extended over the whole domain @xmath18 , _ including _ the body interior .",
    "the body is discretized using a collection of _ markers _ , which is a set of @xmath25 points that cover the interior of the body and at which the interaction between the body and the fluid is localized .",
    "for example , the markers could be the nodes of a triangular ( @xmath13 ) or tetrahedral ( @xmath26 ) mesh used to discretize @xmath27 ; an illustration of such a _ volume _ grid of markers discretizing a rigid disk immersed in steady stokes flow is shown in the left panel of fig .",
    "[ fig:2dwake_stokes ] . in the case of stokes flow ,",
    "the specification of a no slip condition on the boundary of a rigid body is sufficient to ensure rigidity of the fluid inside the body @xcite .",
    "therefore , for stokes flow , the grid of markers does not need to extend over the volume of the body and can instead be limited to the surface of the rigid body , thus substantially reducing the number of markers required to represent the body . in this case",
    ", the markers could be the nodes of a triangulation ( @xmath26 ) of the surface of the body ; an illustration of such a _ surface _ grid of markers is shown in the right panel of fig .",
    "[ fig:2dwake_stokes ] .",
    "we discuss the differences between a volume and a surface grid of markers in section [ sec : results ] .",
    "the traditional ib method is concerned with the motion of elastic ( flexible ) bodies in fluid flow , and the collection of markers can be viewed as a set of quadrature points used to discretize integrals over the moving body .",
    "the elastic body forces are most easily computed in a lagrangian coordinate system attached to the deforming body , and the relative positions of the markers in the fixed eulerian frame of reference generally vary in time . for a rigid body ,",
    "however , the relative positions of the markers do not change , and it is not necessary to introduce two distinct coordinate frames .",
    "instead , we use the same cartesian coordinate system to describe points in the fluid domain and in the body ; the positions of the @xmath25 markers in this fixed frame of reference will be denoted with @xmath28 , where @xmath29 for volume meshes or @xmath30 for surface meshes .",
    "two - dimensional steady stokes flow past a periodic column of circular cylinders ( disks ) at zero reynolds number obtained using our rigid - body ib method ( the same setup is also studied at finite reynolds numbers in section [ sub : unsteadycylinders ] ) . the markers used to mediate the fluid - body interaction are shown as small colored circles .",
    "the lagrangian constraint forces @xmath0 that keep the markers at their fixed locations are shown as colored vectors ; the color of the vectors and the corresponding marker @xmath11 are based on the magnitude of the constraint force @xmath31 ( see color bar ) .",
    "the fluid velocity field is shown as a vector field ( black arrows ) in the vicinity and the interior of the body ; further from the body , flow streamlines are shown as solid blue lines .",
    "the magnitude of the eulerian constraint force @xmath32 is shown as a gray color plot ( see greyscale bar ) .",
    "( left panel ) a volume marker grid of 121 markers is used to discretize the disk .",
    "the majority of the constraint forces are seen to act near the surface of the body , but nontrivial constraint forces are seen also in the interior of the body .",
    "( right panel ) a surface grid of 39 markers is used to discretize the disk , which strictly localizes the constraint forces to the surface of the body.,title=\"fig:\",scaledwidth=49.0%]two - dimensional steady stokes flow past a periodic column of circular cylinders ( disks ) at zero reynolds number obtained using our rigid - body ib method ( the same setup is also studied at finite reynolds numbers in section [ sub : unsteadycylinders ] ) .",
    "the markers used to mediate the fluid - body interaction are shown as small colored circles .",
    "the lagrangian constraint forces @xmath0 that keep the markers at their fixed locations are shown as colored vectors ; the color of the vectors and the corresponding marker @xmath11 are based on the magnitude of the constraint force @xmath31 ( see color bar ) .",
    "the fluid velocity field is shown as a vector field ( black arrows ) in the vicinity and the interior of the body ; further from the body , flow streamlines are shown as solid blue lines .",
    "the magnitude of the eulerian constraint force @xmath32 is shown as a gray color plot ( see greyscale bar ) .",
    "( left panel ) a volume marker grid of 121 markers is used to discretize the disk .",
    "the majority of the constraint forces are seen to act near the surface of the body , but nontrivial constraint forces are seen also in the interior of the body .",
    "( right panel ) a surface grid of 39 markers is used to discretize the disk , which strictly localizes the constraint forces to the surface of the body.,title=\"fig:\",scaledwidth=49.0% ]    in the standard ib method for flexible immersed bodies , elastic forces are computed in the lagrangian frame and then _ spread _ to the fluid in the neighborhood of the markers using a regularized delta function @xmath33 that integrates to unity and converges to a dirac delta function as the regularization width @xmath34 . the regularization length scale @xmath35 is typically chosen to be on the order of the spacing between the markers ( as well as the lattice spacing of the grid used to discretize the fluid equations ) , as we discuss in more detail later . in turn , the motion of the markers is specified to follow the velocity of the fluid _ interpolated _ at the positions of the markers .",
    "the key difference between an elastic and a rigid body is that , for a rigid object , the motion of the markers is known ( e.g , they are fixed in place or move with a specified velocity ) and the body forces are unknown and must be determined within each time step . to obtain the fluid - marker interaction forces @xmath36 that constrain the motion of the @xmath25 markers , we solve for the eulerian velocity field @xmath37 , the eulerian pressure field @xmath38 , and the lagrangian constraint forces @xmath39 the system @xmath40 along with suitable boundary conditions .",
    "in the case of steady stokes flow , we set @xmath41 .",
    "the first two equations are the incompressible navier - stokes equations with an eulerian constraint force @xmath42 the last condition is the _ rigidity constraint _ that requires that the eulerian velocity averaged around the position of marker @xmath11 must match the known marker velocity @xmath43 .",
    "this constraint enforces a regularized no - slip condition at the locations of the ib markers , which is a numerical approximation of the true no - slip condition on the surface ( or interior ) of the body .",
    "observe that flow may still penetrate the body in - between the markers and this leads to a well - known small but nonzero `` leak '' in the traditional peskin ib method .",
    "this leak can be greatly reduced by adopting a staggered - grid formulation @xcite , as done in the present work . other more specialized approaches to reducing spurious fluxes in the ib method",
    "have been developed @xcite , but will not be considered in this work .",
    "notice that for zero reynolds number , the semi - continuum formulation is closely related to the popular method of regularized stokeslets , which solves a similar system of equations for @xmath0@xcite .",
    "the key difference is that in the method of regularized stokeslets , the fluid equations are eliminated using analytic green s functions ; this necessitates that nontrivial pre - computations of these green s functions be performed for each type of boundary condition @xcite .    in this work ,",
    "we treat as the primary continuum formulation of the problem .",
    "this is a semi - continuum formulation in which the rigid body is represented as a discrete collection of markers but the fluid description is kept as a continuum , which implies that different discretizations of the fluid equations are possible .",
    "one can , in principle , try to write a fully continuum formulation in which the discrete set of rigidity forces @xmath0 are replaced by a continuum force density field @xmath44 .",
    "the well - posedness and stability of such a fully continuum formulation is mathematically delicate , however , and there can be subtle differences between weak and strong interpretations of the equations . to appreciate this ,",
    "observe that if each component of the velocity is discretized with @xmath45 degrees of freedom , it can not in general be possible to constrain the velocity strongly at more than @xmath45 points ( markers ) .",
    "by contrast , in our strong formulation , the velocity is infinite dimensional but it is only constrained in the vicinity of a finite number of markers .",
    "therefore , the problem is always well posed and is directly amenable to numerical discretization and solution , at least when it is well - conditioned .",
    "as we show in this work , the conditioning of the fully discrete problem is controlled by the relationship between the regularization length @xmath35 and the marker spacing .",
    "the physical interpretation of the constraint forces @xmath31 depends on details of the marker grid and the type of the problem under consideration .",
    "for fully continuum formulations , in which the fluid - body interaction is represented solely as a surface force density , the force @xmath31 can be interpreted as the integral of the traction ( normal component of the fluid stress tensor ) over a surface area associated with marker @xmath11 . such a formulation is appropriate , for example , for steady stokes flow . in particular , for steady stokes flow our method can be seen as a discretized and regularized first - kind integral formulation in which green s functions are computed by the fluid solver .",
    "this approach is different from the method of regularized stokeslets , in which regularized green s functions must be computed analytically @xcite .    for cases in which markers are placed on both the surface and the interior of a rigid body ,",
    "the precise physical interpretation of the volume force density , and thus of @xmath0 , is delicate even for steady stokes flow .",
    "notably , observe that the splitting between a volume constraint force density and the gradient of the pressure is not unique because the pressure inside a rigid body can not be determined uniquely .",
    "specifically , only the component of the constraint force density projected onto the space of divergence - free vector fields is uniquely determined . in the presence of finite inertia and a density mismatch between the fluid and the _ moving _ rigid bodies , the inertial terms in need to be modified in the interior of the body @xcite .",
    "furthermore , sufficiently many markers in the interior of the body are required to prevent spurious angular momentum being generated by motions of the fluid inside the body @xcite .",
    "we do not discuss these physical issues in this work because they do not affect the numerical algorithm , and because we restrict our numerical studies to flow past _ stationary _ rigid bodies , for which the fluid - body interaction force is localized to the surface of the body in the continuum limit .",
    "the spatial discretization of the fluid equation uses a uniform cartesian grid with grid spacing @xmath46 and is based on a second - order accurate staggered - grid finite - difference discretization , in which vector - valued quantities , including velocities and forces , are represented on the faces of the cartesian grid cells , and scalar - valued quantities , including the pressure , are represented at the centers of the grid cells @xcite .",
    "our implicit - explicit temporal discretization of the navier - stokes equation is standard and summarized in prior work ; see for example the work of griffith @xcite .",
    "the key features are that we treat advection explicitly using a predictor - corrector approach , and that we treat viscosity implicitly , using either the backward euler or the implicit midpoint method . for steady stokes flow ,",
    "no temporal discretization required , although one can also think of this case as corresponding to a backward euler discretization of the time - dependent problem with a very large time step size @xmath47 .",
    "a key dimensionless quantity is the viscous cfl number @xmath48 , where the kinematic viscosity is @xmath49 . if @xmath50 is small ,",
    "the pressure and velocity are weakly coupled , but for large @xmath50 , and in particular for the steady stokes limit @xmath51 , the coupling between the velocity and pressure equations is strong .",
    "we do _ not _ use a fractional time - stepping scheme ( i.e. , a projection method ) to split the pressure and velocity updates ; instead , the pressure is treated as a lagrange multiplier that enforces the incompressibility and must be determined together with the velocity at the end of the time step @xcite ; except in special cases , this is _ necessary _ for small reynolds number flows .",
    "this approach also greatly aids with imposing stress boundary conditions @xcite .",
    "the constraint force @xmath52 is treated analogously to the pressure , i.e. , as a lagrange multiplier . whereas the role of the pressure is to enforce the incompressibility constraint",
    ", @xmath53 enforces the rigidity constraint . like the pressure",
    ", @xmath53 is an unknown that must be solved for in this formulation .      in the fully discrete formulation of the fluid - body coupling ,",
    "we replace spatial integrals by sums over fluid or body grid points in the semi - continuum formulation .",
    "the regularized delta function is discretized using a tensor product in @xmath54-dimensional space ( see @xcite for more details ) , @xmath55 where @xmath56 is the volume of a grid cell .",
    "the one - dimensional kernel function @xmath57 is chosen based on numerical considerations of efficiency and maximized approximate translational invariance @xcite . in this work , for reasons that will become clear in section [ sec : approxmob ] , we prefer to use a kernel that maximizes translational and rotational invariance ( i.e. , improves grid - invariance ) .",
    "we therefore use the smooth ( three - times differentiable ) six - point kernel recently described by bao _",
    "this kernel is more expensive than the traditional four - point kernel @xcite because it increases the support of the kernel to @xmath58 grid points in two dimensions and @xmath59 grid points in three dimensions ; however , this cost is justified because the new six - point kernel improves the translational invariance by orders of magnitude compared to other standard ib kernel functions @xcite .",
    "the interaction between the fluid and the rigid body is mediated through two crucial operations . the discrete velocity - interpolation operator @xmath60 averages velocities on the staggered grid in the neighborhood of marker @xmath11 via @xmath61 where the sum is taken over faces @xmath8 of the grid , @xmath7 indexes coordinate directions ( @xmath62 ) as a superscript , and @xmath63 is the position of the center of the grid face @xmath8 in the direction @xmath7 .",
    "the discrete force - spreading operator @xmath64 spreads forces from the markers to the faces of the staggered grid via @xmath65 where now the sum is over the markers that define the configuration of the rigid body .",
    "these operators are adjoint with respect to a suitably - defined inner product , @xmath66 , which ensures conservation of energy @xcite",
    ". extensions of the basic interpolation and spreading operators to account for the presence of physical boundary conditions are described in appendix [ appendixphysicalbcs ] .      at every stage of the temporal integrator ,",
    "we need to solve a linear system of the form @xmath67\\left[\\begin{array}{c } \\v\\\\ \\pi\\\\ \\lamb \\end{array}\\right]=\\left[\\begin{array}{c } \\v g\\\\ \\v h=\\v 0\\\\ \\w=\\v 0 \\end{array}\\right],\\label{eq : constrained_stokes}\\ ] ] which is the focus of this work .",
    "the right - hand side @xmath68 includes all remaining fluid forcing terms , explicit contributions from previous time steps or stages , boundary conditions , etc .",
    "here , @xmath69 is the discrete gradient operator , @xmath70 is the discrete divergence operator , and @xmath71 is the vector equivalent of the familiar screened poisson ( or helmholtz ) operator @xmath72 with @xmath73 for the backward euler method or for steady stokes , and @xmath74 for the implicit midpoint rule .",
    "here @xmath75 is the dimensionless vector laplacian operator , which takes into account boundary conditions for velocity such as no - slip boundaries .",
    "since the viscosity appears multiplied by the coefficient @xmath76 , we will henceforth absorb this coefficient into the viscosity , @xmath77 , which allows us to assume , without loss of generality , that @xmath78 and to write the fluid operator in the form @xmath79    we remark that making the @xmath80 block in the matrix in ( [ eq : constrained_stokes ] ) non - zero ( i.e. , regularizing the saddle - point system ) is closely related to solving the brinkman equations @xcite for flow through a permeable or porous body suspended in fluid @xcite . in particular , by making the @xmath80 block a diagonal matrix with suitable diagonal elements , one can consistently discretize the brinkman equations .",
    "such regularization greatly simplifies the numerical linear algebra except , of course , when the permeability of the body is so small that it effectively acts as an impermeable body . in this work , we focus on developing a solver for ( [ eq : constrained_stokes ] ) that is effective even when there is no regularization ( permeability ) , and even when the matrix @xmath71 is the discretization of an elliptic operator , as is the case in the steady stokes regime .",
    "this is the hardest case to consider , and a solver that is robust in this case will be able to handle the easier cases of finite reynolds number or permeable bodies with ease .",
    "it is worth noticing the structure of the linear system ( [ eq : constrained_stokes ] ) .",
    "first , observe that the system is symmetric , at least if only simple boundary conditions such as periodic or no - slip boundaries are present @xcite . in the top @xmath81 block",
    ", @xmath82 is a symmetric positive - semidefinite ( spd ) matrix .",
    "the top left @xmath83 block represents the familiar saddle - point problem arising when solving the navier - stokes or stokes equations in the absence of a rigid body @xcite .",
    "the whole system is a saddle - point problem for the fluid variables and for @xmath0 , in which the top - left block is the stokes saddle - point matrix .",
    "...      we can formally solve ( [ eq : constrained_stokes ] ) through a schur complement approach , as described in more detail in section [ sec : solver ] . for increased generality , which will be useful when discussing preconditioners , we allow the right hand side to be general and ,",
    "in particular , do not assume that @xmath84 and @xmath85 are zero .",
    "first , we solve the unconstrained fluid equation for pressure and velocity @xmath86\\left[\\begin{array}{c } \\v\\\\ \\p \\end{array}\\right]=\\left[\\begin{array}{c } \\s\\lamb+\\v g\\\\ \\v h \\end{array}\\right],\\label{eq : stokes_sub}\\ ] ] where we recall that @xmath87 .",
    "the solution can be written as @xmath88 , where @xmath89 is the standard stokes solution operator for divergence - free flow ( @xmath90 ) , given by @xmath91 where we have assumed for now that @xmath92 is invertible . for a periodic system ,",
    "the discrete operators commute , and we can write @xmath93 where @xmath94 is the helmholtz projection onto the space of divergence - free vector fields . we never explicitly compute or form @xmath89 ; rather , we solve the stokes velocity - pressure subsystems using the projection - method based preconditioner developed by griffith @xcite .",
    "let us define @xmath95 to be the solution of the _ unconstrained _ stokes problem @xmath86\\left[\\begin{array}{c } \\tilde{\\v}\\\\ \\tilde{\\p } \\end{array}\\right]=\\left[\\begin{array}{c } \\v f\\\\ \\v h \\end{array}\\right],\\label{eq : stokes_saddle}\\ ] ] giving @xmath96 .",
    "next , we plug the velocity @xmath5 into the rigidity constraint , @xmath97 , to obtain @xmath98 where the schur complement or _ marker mobility matrix _ is @xmath99 the mobility matrix @xmath100 is spd and has dimensions @xmath101 , and the @xmath102 block @xmath103 relates the force applied at marker @xmath104 to the velocity induced at marker @xmath11 .",
    "our approach to obtaining an efficient algorithm for the constraind",
    "fluid - solid system is to develop a method for approximating the marker mobility matrix @xmath105 in a simple and efficient way that leads to robust preconditioners for solving the mobility subproblem ( [ eq : lambda_sol ] ) ; see section [ sec : approxmob ] .",
    "observe that the conditioning of the saddle - point system ( [ eq : constrained_stokes ] ) is controlled by the conditioning of @xmath105 .",
    "in particular , if the ( non - negative ) eigenvalues of @xmath105 are bounded away from zero , then there will be a unique solution to the saddle - point system .",
    "if this bound is uniform as the grid is refined , then the problem is well - posed and will satisfy a stability criterion similar to the well - known ladyzenskaja - babuska - brezzi ( lbb ) condition for the stokes saddle - point problem ( [ eq : stokes_saddle ] ) .",
    "we investigate the spectrum of the the marker mobility matrix numerically in section [ sec : solver ] . in practice",
    ", there may be some nearly zero eigenvalues of the matrix @xmath105 corresponding to physical ( rather than numerical ) null modes .",
    "an example is a sphere discretized with markers on the surface : we know that a uniform compression of the sphere will not cause any effect because of the incompressibility of the fluid filling the sphere .",
    "this compression mode corresponds to a null - vector for the constraint forces @xmath0 ; it poses no difficulties in principle because the right - hand side in ( [ eq : lambda_sol ] ) is always in the range of @xmath105 .",
    "of course , when a discrete set of markers is placed on the sphere , the rotational symmetry will be broken and the corresponding mode will have a small but nonzero eigenvalue , which can lead to numerical difficulties if not handled with care .      in the time - dependent context , @xmath50 is finite , and it is easy to see that @xmath106 is invertible .",
    "the same happens even for steady stokes flow if at least one of the boundaries is a no - slip boundary . in the case of periodic steady stokes",
    "flow , however , @xmath107 has in its range vectors that sum to zero , because no nonzero total force can be applied on a periodic domain .",
    "this means that a solvability condition is @xmath108 where @xmath109 denotes an average over the whole system , @xmath110 is a vector of ones , and @xmath111 is the volume of the domain .",
    "this is an additional constraint that must be added to the constrained stokes system ( [ eq : constrained_stokes ] ) for a periodic domain the steady stokes case . in this approach",
    ", the solution has an indeterminate mean velocity @xmath112 because momentum is not conserved .",
    "this sort of approach is followed for a scalar ( reaction - diffusion ) equivalent of ( [ eq : constrained_stokes ] ) in the appendix of ref .",
    "@xcite , for the traditional peskin ib method in ref .",
    "@xcite , and for a higher - order ib method in @xcite .    here",
    ", we instead impose the mean velocity @xmath113 and ensure that the total force applied to the fluid sums to zero , i.e. , we enforce momentum conservation . specifically , for the special case of periodic steady stokes , we solve the system @xmath114\\left[\\begin{array}{c } \\v\\\\ \\p\\\\ \\lamb \\end{array}\\right]=\\left[\\begin{array}{c } \\v g\\\\ \\v h\\\\ \\w \\end{array}\\right],\\label{eq : constrained_periodic}\\ ] ] together with the constraint @xmath113 , where we assume that @xmath115 for consistency .",
    "this change amounts to simply redefining the spreading operator to subtract the total applied force on the markers as a uniform force density , @xmath116 .",
    "this can be justified by considering the unit cell to be part of an infinite periodic system in which there is an externally applied constant pressure gradient , which is balanced by the drag forces on the bodies so as to ensure that the domain as a whole is in force balance @xcite .",
    "a key element in the preconditioned krylov solver for ( [ eq : constrained_stokes ] ) that we describe in section [ sec : solver ] is an approximate solver for the mobility subproblem ( [ eq : lambda_sol ] ) .",
    "the success of this approximate solver , i.e. , the accuracy with which we can approximate the schur complement of the saddle - point problem ( [ eq : constrained_stokes ] ) , is crucial to an effective linear solver and one of the key contributions of this work .",
    "because it involves the inverse stokes operator @xmath89 , the actual schur complement @xmath117 can not be formed efficiently .",
    "instead of forming the true mobility matrix , we instead approximate @xmath118 by a _ dense _ but low - rank _ approximate mobility matrix _ @xmath119 given by simple _ analytical _ approximations . to achieve this",
    ", we use two key ideas :    1 .",
    "we ignore the specifics of the boundary conditions and assume that the structure is immersed in an infinite domain at rest at infinity ( in three dimensions ) or in a finite periodic domain ( in two dimensions ) .",
    "this implies that the krylov solver for ( [ eq : constrained_stokes ] ) must handle the boundary conditions .",
    "we assume that the ib spatial discretization is translationally and rotationally invariant ; that is , @xmath105 does not depend on the exact position and orientation of the body relative to the underlying fluid grid .",
    "this implies that the krylov solver must handle any grid - dependence in the solution .",
    "the first idea , to ignore the boundary conditions in the preconditioner , has worked well in the context of solving the stokes system ( [ eq : stokes_saddle ] ) .",
    "namely , a simple but effective approximation of the inverse of the schur complement for ( [ eq : stokes_saddle ] ) , @xmath120 , can be constructed by assuming that the domain is periodic so that the finite difference operators commute , and thus the schur complement degenerates to a diagonal or nearly - diagonal mass matrix @xcite .",
    "the second idea , to make use of the near grid invariance of peskin s regularized kernel functions , has previously been used successfully in implicit immersed - boundary methods by ceniceros _",
    "note that for certain choices of the kernel function , the assumption of grid invariance can be a very good approximation to reality ; here , we rely on the recently - developed six - point kernel @xcite , which has excellent grid invariance and relatively compact support .    in the remainder of this section ,",
    "we explain how we compute the entries in @xmath119 in three dimensions , assuming an unbounded fluid at rest at infinity .",
    "the details for two dimensions are given in appendix [ appendixmob2d ] and are similar in nature , except for complications for two - dimensional steady stokes flow resulting from the well - known stokes paradox .",
    "the mobility matrix @xmath105 is a symmetric block matrix built from @xmath121 blocks of size @xmath102 .",
    "the block @xmath103 corresponding to markers @xmath11 and @xmath104 relates a force applied at marker @xmath104 to the velocity induced at marker @xmath11 .",
    "our basic assumption is that @xmath103 does not depend on the actual position of the markers relative to the fluid grid , but rather only depends on the distance between the two markers and on the viscous cfl number @xmath50 in the form @xmath122 where @xmath123 and @xmath124 is the distance between the two markers , and hat denotes a unit vector",
    ". the functions of distance @xmath125 and @xmath126 depend on the specific kernel chosen , the specific discretization of the fluid equations ( in our case the staggered - grid scheme ) , and the the viscous cfl number @xmath50 . to obtain a specific form for these two functions , we empirically fit numerical data with functions with the proper asymptotic behavior at short and large distances between the markers .",
    "for this purpose , we first discuss the asymptotic properties of @xmath125 and @xmath126 from a physical perspective .    it is important to note that the true mobility matrix @xmath105 is guaranteed to be spd because of its structure and the adjointness of the spreading and interpolation operators .",
    "this can be ensured for the approximation @xmath119 by placing positivity constraints on suitable linear combinations of the fourier transforms of @xmath127 and @xmath126 , which ensure that the kernel @xmath128 given by ( [ eq : m_tilde_ij ] ) is spd in the sense of integral operators .",
    "it is , however , very difficult to place such constraints on empirical fits in practice , and in this work , we do not attempt to ensure @xmath119 is spd for all marker configurations .",
    "let us temporarily focus on the semi - continuum formulation and ignore eulerian discretization artifacts .",
    "the pairwise mobility between markers @xmath11 and @xmath104 for a continuum fluid is @xmath129 where @xmath130 is the the green s function for the fluid equation , i.e. , @xmath131 , where @xmath132 it is well - known that @xmath133 has the same form as ( [ eq : m_tilde_ij ] ) , @xmath134    for steady stokes flow ( @xmath51 ) , @xmath135 is the well - known oseen tensor or stokeslet , ) but contains only one regularized delta function in the integrand ; this makes the resulting mobility matrix asymmetric , which is unphysical . ] and corresponds to @xmath136 . for inviscid flow , @xmath137 , and we have that @xmath138 and ( [ eq : l_inv_periodic ] ) applies , and therefore @xmath139 is a multiple of the projection operator . for finite nonzero values of @xmath50 , we can obtain @xmath133 from the solution of the screened stokes ( i.e. , brinkman ) equations ( [ eq : brinkman_greens ] ) @xcite , and corresponds to the `` brinkmanlet '' @xcite @xmath140 where @xmath141 .",
    "note that in the steady stokes limit , @xmath142 and the brinkmanlet becomes the stokeslet .",
    "we can use ( [ eq : brinkmanlet_3d ] ) to construct @xmath143 when the markers are far apart .",
    "namely , if @xmath144 , then we may approximate the ib kernel function by a true delta function , and thus @xmath125 and @xmath126 are well - approximated by ( [ eq : brinkmanlet_3d ] ) . for steady stokes flow ,",
    "the interaction between markers decays like @xmath145 . for finite @xmath50",
    ", however , the viscous contribution decays exponentially fast as @xmath146 , which is consistent with the fact that markers interact via viscous forces only if they are at a distance not much larger than @xmath147 , the typical distance that momentum diffuses during a time step . for nonzero reynolds numbers , the leading order asymptotic @xmath148 decay of @xmath125 and @xmath126",
    "is given by the last terms on the right hand side of ( [ eq : brinkmanlet_3d ] ) and corresponds to the electric field of an electric dipole ; its physical origin is in the incompressibility constraint , which instantaneously propagates hydrodynamic information between the markers .    for steady stokes flow , we can say even more about the approximate form of @xmath125 and @xmath126 . as discussed in more detail by delong et al .",
    "@xcite , for distances between the markers that are not too small compared to the regularization length @xmath35 , we can approximate ( [ eq : m_ij_stokes ] ) with ( [ eq : m_tilde_ij ] ) using the well - known rotne - prager - yamakawa ( rpy ) @xcite tensor for the functions @xmath125 and @xmath126 ,    @xmath149    where @xmath35 is the effective _ hydrodynamic radius _ of the specific kernel @xmath150 , defined by @xmath151 note that for @xmath152 the rpy tensor approaches the oseen tensor and decays like @xmath145 .",
    "a key advantage of the rpy tensor is that it _",
    "guarantees _ that the mobility matrix ( [ eq : m_tilde_ij ] ) is spd for _ all _ configurations of the markers , which is a rather nontrivial requirement @xcite .",
    "the actual discrete pairwise mobility @xmath103 obtained from the spatially - discrete ib method is well - described by the rpy tensor @xcite ( see fig . [",
    "fig : fg_3d_asympt ] ) .",
    "the only fitting parameter in the rpy approximation is the effective hydrodynamic radius @xmath35 averaged over many positions of the marker relative to the underlying grid @xcite ; for the six - point kernel used here , for the widely used four - point kernel @xcite , and @xmath153 for the three - point kernel @xcite . ]",
    "for the brinkman equation , the equivalent of the rpy tensor can be computed for @xmath155 by applying a faxen - like operator from the left and right on the brinkmanlet ( see eq .",
    "( 26 ) in ref .",
    "@xcite ) ; the resulting analytical expressions are complex and are not used in our empirical fitting .      in this work ,",
    "we use empirical fits to approximate the mobility .",
    "this is because the analytical approximations , such as those offered by the rpy tensor , are most appropriate for unbounded domains and assume the markers are far apart compared to the width of the regularized delta function . in numerical computations , we use a finite periodic domain , and this requires corrections to the analytic expressions that are difficult to model . for example , for finite @xmath50 , we find that the periodic corrections to the inviscid ( dipole ) @xmath148 contribution dominate over the exponentially decaying viscous contribution , which makes the precise form of the viscous terms in ( [ eq : brinkmanlet_3d ] ) irrelevant in practice . for @xmath156 ,",
    "only the asymptotically - dominant far - field terms survive , and we make an effort to preserve those in our fitting because the numerical results are obtained using finite systems and thus not reliable at large marker distances . at shorter distances , however , the discrete nature of the fluid solver and the ib kernel functions becomes important , and empirical fitting seems to be a simple yet flexible alternative to analytical computations . at the same time",
    ", we feel that is important to _ constrain _ the empirical fits based on known behavior at short and large distances .",
    "firstly , for @xmath157 , the pairwise mobility can be well - approximated by the self - mobility ( @xmath158 , corresponding to the diagonal elements @xmath159 ) , for which we know the following facts :    * for the steady stokes regime ( @xmath51 ) , the diagonal elements are given by stokes s drag formula , yielding @xmath160 where we recall that @xmath35 is the effective hydrodynamic radius of a marker for the particular spatial discretization ( kernel and fluid solver ) . * for the inviscid case ( @xmath137 ) , it is not hard to show that @xcite @xmath161 where @xmath26 is the dimensionality , and @xmath162 is the `` volume '' of the marker , where the constant @xmath163 is straightforward to calculate . * the above indicates that @xmath164 goes from @xmath165 for small @xmath50 to @xmath166 for large @xmath50 . at intermediate viscous cfl numbers",
    "@xmath50 , we can set @xmath167 where @xmath168 is linear for small @xmath50 and then becomes @xmath169 for large @xmath50 . we will obtain the actual form of @xmath170 from empirical fitting .    secondly , for @xmath156 , we know the asymptotic decay of the hydrodynamic interactions from ( [ eq : brinkmanlet_3d ] ) :    * for the steady stokes regime ( @xmath51 ) , we have the oseen tensor given by @xmath171 * for the inviscid case ( @xmath137 ) , we get the electric field of an electric dipole , @xmath172 which is also the asymptotic decay for @xmath173 for @xmath174 .",
    "we obtain the actual form of the functions @xmath125 and @xmath126 empirically by fitting numerical data for the parallel and perpendicular mobilities @xmath175 where @xmath176 .",
    "to do so , we placed a large number of markers @xmath25 in a cube of length @xmath177 inside a periodic domain of length @xmath178 . for each marker",
    "@xmath11 , we applied a unit force @xmath179 with random direction while leaving @xmath180 for @xmath181 , solved ( [ eq : stokes_saddle ] ) , and then interpolated the fluid velocity @xmath5 at the position of each of the markers .",
    "the resulting parallel and perpendicular relative velocity for each of the @xmath182 pairs of particles allows us to estimate @xmath183 and @xmath184 . by making the number of markers @xmath25",
    "sufficiently large , we sample the mobility over essentially all relative positions of the pair of markers . for the self - mobility @xmath159 ( @xmath185 ) , we take @xmath186 and compute @xmath164 from the numerical data .",
    "normalized mobility functions @xmath187 ( left ) and @xmath188 ( right ) defined similarly to ( [ eq : fg_tilde_stokes ] ) as a function of marker - marker distance @xmath189 , in three dimensions for the six - point kernel of bao et al .",
    "@xcite , over a range of viscous cfl numbers ( different colors , see legend ) .",
    "numerical data is shown with symbols and obtained using a @xmath190 periodic fluid grid , while dashed lines show our empirical fit of the form ( [ eq : f_stokes_3d_fit ] ) for steady stokes ( @xmath51 ) and ( [ eq : f_beta_3d_fit ] ) for finite @xmath50 . for steady stokes flow ,",
    "the numerical data is in reasonable agreement with the rpy tensor ( [ eq : rpytensor ] ) ( dashed red line ) .",
    ", title=\"fig:\",scaledwidth=49.0%]normalized mobility functions @xmath187 ( left ) and @xmath188 ( right ) defined similarly to ( [ eq : fg_tilde_stokes ] ) as a function of marker - marker distance @xmath189 , in three dimensions for the six - point kernel of bao et al .",
    "@xcite , over a range of viscous cfl numbers ( different colors , see legend ) .",
    "numerical data is shown with symbols and obtained using a @xmath190 periodic fluid grid , while dashed lines show our empirical fit of the form ( [ eq : f_stokes_3d_fit ] ) for steady stokes ( @xmath51 ) and ( [ eq : f_beta_3d_fit ] ) for finite @xmath50 . for steady stokes flow ,",
    "the numerical data is in reasonable agreement with the rpy tensor ( [ eq : rpytensor ] ) ( dashed red line ) .",
    ", title=\"fig:\",scaledwidth=49.0% ]    if the spatial discretization were perfectly translationally and rotationally invariant and the domain were infinite , all of the numerical data points for @xmath127 and @xmath191 would lie on a smooth curve and would not depend on the actual position of the pair of markers relative to the underlying grid .",
    "in reality , it is not possible to achieve perfect translational invariance with a kernel of finite support @xcite , and so we expect some ( hopefully small ) scatter of the points around a smooth fit . normalized numerical data for @xmath125 and @xmath126 are shown in fig .",
    "[ fig : fg_3d_asympt ] , and we indeed see that the data can be fit well by smooth functions over the whole range of distances . to maximize the quality of the fit , we perform separate fits for @xmath51 ( steady stokes flow ) and finite @xmath50 .",
    "we also make an effort to make the fits change smoothly as @xmath50 grows towards infinity , as we explain in more detail in appendix [ appendixmob3d ] .",
    "code to evaluate the empirical fits described in appendices [ appendixmob3d ] and [ appendixmob2d ] is publicly available to others for a number of kernels constructed by peskin and coworkers ( three- , four- , and six - point ) in both two and three dimensions at http://cims.nyu.edu/~donev/src/mobilityfunctions.c .",
    "to solve the constrained stokes problem ( [ eq : constrained_stokes ] ) , we use the preconditioned flexible gmres ( fgmres ) method , which is a krylov solver .",
    "we will refer to this as the `` outer '' krylov solver , as it must be distinguished from `` inner '' krylov solvers used in the preconditioner .",
    "because we use krylov solvers in our preconditioner and because krylov solvers generally can not be expressed as linear operators , it is crucial to use a flexible krylov method such as fgmres for the outer solver . the overall method is implemented in the open - source immersed - boundary adaptive mesh refinement ( ibamr ) software infrastructure @xcite ; in this work we focus on uniform grids and do not use the amr capabilities of ibamr ( but see @xcite ) .",
    "ibamr uses krylov solvers that are provided by the petsc library @xcite .      in the preconditioner used by the outer krylov solver",
    ", we want to _ approximately _ solve the nested saddle - point linear system @xmath67\\left[\\begin{array}{c } \\v\\\\ \\p\\\\ \\lamb \\end{array}\\right]=\\left[\\begin{array}{c } \\v g\\\\ \\v h\\\\ \\w \\end{array}\\right],\\ ] ] where we recall that @xmath192 .",
    "let us set @xmath193 if @xmath71 has a null - space , ( e.g. , for a fully periodic domain for steady stokes flow ) and we set @xmath194 if @xmath71 is invertible .",
    "when @xmath193 , let us define the restricted inverse @xmath92 to only act on vectors of mean value zero , and to return a vector of mean zero .    applying our schur complement based preconditioner for solving ( [ eq : constrained_stokes ] ) consists of the following steps :    1 .",
    "solve the ( unconstrained ) fluid sub - problem , @xmath86\\left[\\begin{array}{c } \\v\\\\ \\p \\end{array}\\right]=\\left[\\begin{array}{c } \\v g\\\\ \\v h \\end{array}\\right].\\ ] ] to control the accuracy of the solution one can either use a relative tolerance based stopping criterion or fix the number of iterations @xmath195 in the inner solver .",
    "2 .   calculate the slip velocity on the set of markers , @xmath196 .",
    "3 .   approximately solve the schur complement system , @xmath197 where the mobility approximation @xmath119 is constructed as described in section [ sec : approxmob ] .",
    "optionally , re - solve the corrected fluid sub - problem , @xmath86\\left[\\begin{array}{c } \\v\\\\ \\p \\end{array}\\right]=\\left[\\begin{array}{c } \\v g+\\s\\lamb-\\alpha\\text{\\ensuremath{\\dv}}^{-1}\\v 1^{t}\\lamb\\\\ \\v h \\end{array}\\right].\\ ] ]    all linear solvers used in the preconditioner can be approximate , and this is in fact the key to the efficiency of the overall solver approach .",
    "notably , the inner krylov solvers used to solve the unconstrained stokes sub - problems in steps 1 and 4 above can be done by using a small number @xmath195 of iterations using a method briefly described in the next section .",
    "if the fluid sub - problem is approximately solved in both steps 1 and 4 , which we term the _ full _ schur complement preconditioner , each application of the preconditioner requires @xmath198 applications of the stokes preconditioner ( [ p1_practical ] ) .",
    "it is also possible to omit step 4 above to obtain a block _ lower triangular _ schur preconditioner @xcite , which requires only @xmath195 applications of the unconstrained stokes preconditioner ( [ p1_practical ] ) .",
    "we will numerically compare these two preconditioners and study the effect of @xmath195 on the convergence of the fgmres outer solver in section [ sub : gmres ] .",
    "a key component we rely on is an approximate solver for the unconstrained stokes sub - problem , @xmath86\\left[\\begin{array}{c } \\v\\\\ \\p \\end{array}\\right]=\\left[\\begin{array}{c } \\v g\\\\ \\v h \\end{array}\\right],\\ ] ] for which a number of techniques have been developed in the finite - element context @xcite . to solve this system",
    ", we use gmres with a preconditioner @xmath199 based on the projection method , as proposed by griffith @xcite and improved to some extent by cai et al .",
    "@xcite . specifically , the preconditioner for the stokes system that we use in this work is @xmath200 where @xmath201 is the dimensionless pressure ( scalar ) laplacian , and @xmath202 and @xmath203 denote approximate solvers obtained by a _ single _",
    "v - cycle of a geometric multigrid solver for the vector helmholtz and scalar poisson problems , respectively . in the time - dependent case ,",
    "the approximate schur complement for the unconstrained stokes sub - problem is @xmath204 and for steady stokes flow , @xmath205 .",
    "further discussion of the relation of these preconditioners to the those described in the book @xcite can be found in @xcite .",
    "observe that one application of @xmath199 is relatively inexpensive and involves only a few scalar multigrid v - cycles . indeed , solving the stokes system using gmres with this preconditioner is only a few times more expensive than solving a scalar poisson problem , even in the steady stokes regime @xcite .",
    "note that it is possible to omit the upper right off - diagonal block in the first matrix on the right hand side of ( [ p1_practical ] ) to obtain a block lower triangular preconditioner that is also effective , and may in fact be preferred at zero reynolds number since it allows one to skip a sweep of the pressure multigrid solver @xcite .",
    "we empirically find that including the poisson solve ( velocity projection ) improves the overall performance of the outer solver .      from a computational perspective ,",
    "one of the most challenging steps in our preconditioner is solving the mobility sub - problem ( [ eq : mob_subproblem ] ) . since this is done inside a preconditioner , and",
    "because @xmath119 is itself an approximation of the true mobility matrix @xmath105 , it is not necessary to solve ( [ eq : mob_subproblem ] ) exactly . in the majority of the examples presented herein",
    ", we solve ( [ eq : mob_subproblem ] ) using direct solvers provided by lapack .",
    "this is feasible on present hardware for up to around @xmath206 markers and allows us to focus on the design of the approximation @xmath119 and to study the accuracy of the overall method .",
    "let us denote with @xmath207 the smallest marker - marker spacing .",
    "for well - spaced markers , @xmath208 , our approximate mobility @xmath119 is typically spd even for large numbers of markers , and in these cases , we can use the cholesky factorization to solve ( [ eq : mob_subproblem ] ) . in some cases , however , there may be a few small or even negative eigenvalues of @xmath119 that have to be handled with care .",
    "we have found that the most robust ( albeit expensive ) alternative is to perform an svd of @xmath119 , and to use a pseudoinverse of @xmath119 ( keeping only eigenvalues larger than some tolerance @xmath209 ) to solve ( [ eq : mob_subproblem ] ) .",
    "this effectively filters out the spuriously small or negative eigenvalues .",
    "note that the factorization of @xmath119 needs to be performed only once per constrained stokes solve since the body is kept fixed during a time step . in cases where there is a single body",
    ", the factorization needs to be performed only once per simulation and can be reused ; if the body is translating or rotating , one ought to perform appropriate rotations of the right hand side and solution of ( [ eq : mob_subproblem ] ) . in some cases of practical interest where the number of markers is not too large ,",
    "it is possible to precompute the true mobility @xmath210 with periodic boundary conditions ( for a sufficienly large domain ) and to store its factorization . even if the structure moves relative to the underlying grid , such a precomputed ( reference ) mobility @xmath210 is typically a much better approximation to the true mobility than our empirical approximation @xmath119 , and",
    "can effectively be used in the preconditioner .",
    "determining effective approaches to solving the mobility sub - problem in the presence of multiple moving rigid bodies remains future work , as discussed further in the conclusions .",
    "the conditioning of the constrained stokes problem ( [ eq : constrained_stokes ] ) is directly related to the conditioning of the schur complement mobility matrix @xmath211 , which is intimately connected to the relation between the fluid solver grid spacing @xmath46 and the smallest inter - marker spacing @xmath207 .",
    "firstly , it is obvious that if two markers @xmath11 and @xmath104 are very close to each other , then the fluid solver can not really distinguish between @xmath179 and @xmath212 and will instead effectively see only their sum .",
    "we also know that using too many markers for a fixed fluid grid will ultimately lead to a rank - deficient @xmath105 , because it is not possible to constrain a finite - dimensional discrete fluid velocity at too many points .",
    "this physical intuition tells us that the condition number of @xmath105 should increase as the marker spacing becomes small compared to the grid spacing .",
    "this well - known intuition , however , does not tell us how closely the markers can or must be placed in practice .",
    "standard wisdom for the immersed boundary method , which is based on the behavior of models of elastic bodies , is to make the marker spacing on the order of half a grid spacing .",
    "as we show , this leads to extremely ill - conditioned mobility matrices for rigid bodies .",
    "we note that the specific results depend on the dimensionality , the details of the fluid solver , and the specific kernel used ; however , the qualitative features we report appear to be rather general .    to determine the condition number of the mobility matrix",
    ", we consider `` open '' and `` filled '' sphere models .",
    "we discretize the surface of a sphere as a shell of markers constructed by a recursive procedure suggested to us by charles peskin ( private communication ) .",
    "we start with 12 markers placed at the vertices of an icosahedron , which gives a uniform triangulation of a sphere by 20 triangular faces .",
    "then , we place a new marker at the center of each edge and recursively subdivide each triangle into four smaller triangles , projecting the vertices back to the surface of the sphere along the way . each subdivision",
    "approximately quadruples the number of vertices , with the @xmath8-th subdivision producing a model with @xmath213 markers . to create filled sphere models , we place additional markers at the vertices of a tetrahedral grid filling the sphere that is constructed using the tetgen library , starting from the surface triangulation described above .",
    "the constructed tetrahedral grids are close to uniform , but it is not possible to control the precise marker distances in the resulting irregular grid of markers .",
    "we use models with approximately equal edges ( distances between nearest - neighbor markers ) of length @xmath214 , which we take as a measure of the typical marker spacing .",
    "we numerically computed the mobility matrix @xmath105 for an isolated spherical shell in a large periodic domain for various numbers of markers @xmath25 . here",
    "we keep the ratio @xmath215 fixed and keep the marker spacing fixed at @xmath216 ; one can alternatively keep the radius of the sphere fixed .",
    "fixed , is more natural for examining the small eigenvalues of @xmath105 , which are dominated by discretization effects , as opposed to the large eigenvalues , which correspond to physical modes of the stokes problem posed on a sphere and are insensitive to the discretization details . ] in fig .",
    "[ fig : eigenvalues ] , we show the spectrum of @xmath105 for varying levels of resolution for three different spacings of the markers , @xmath217 , @xmath218 , and @xmath219 .",
    "similar spectra , but with somewhat improved condition number ( i.e. , fewer smaller eigenvalues ) , are seen for nonzero reynolds numbers ( finite @xmath50 ) .    the results in fig .",
    "[ fig : eigenvalues ] strongly suggest that as the number of markers increases , the low - lying ( small eigenvalue ) spectrum of the mobility matrix approaches a limiting shape .",
    "therefore , the nontrivial eigenvalues remain bounded away from zero even as the resolution is increased , which implies that for @xmath220 the system ( [ eq : constrained_stokes ] ) is uniformly solvable or `` stable '' under grid refinement .",
    "note that in the case of a sphere , there is a trivial zero eigenvalue in the continuum limit , which corresponds to uniform compression of the sphere ; this is reflected in the existence of one eigenvalue much smaller than the rest in the discrete models . ignoring the trivial eigenvalue ,",
    "the condition number of @xmath105 is @xmath221 for this example because the largest eigenvalue in this case increases like the number of markers @xmath25 , in agreement with the fact that the stokes drag on a sphere scales linearly with its radius .",
    "this is as close to optimal as possible , because for the continuum equations for stokes flow around a sphere , the eigenvalues corresponding to spherical harmonic modes scale like the index of the spherical harmonic .",
    "however , what we are concerned here is not so much how the condition number scales with @xmath25 , but with the size of the prefactor , which is determined by the smallest nontrivial eigenvalues of @xmath105 .",
    "eigenvalue spectrum of the mobility matrix for steady stokes flow around a spherical shell covered with different numbers of markers ( 42 , 162 , 642 , or 2562 , see legend ) embedded in a periodic domain .",
    "solid lines are for marker spacing of @xmath222 , dashed - dotted lines for spacing @xmath223 , and dashed lines for spacing of @xmath224 .",
    "the marker spacing is @xmath216 in all cases ; for @xmath222 , the fluid grid size is @xmath225 for 2562 markers and @xmath226 for smaller number of markers , and scaled accordingly for other spacings . for comparison",
    ", we show the spectrum of @xmath227 for the most resolved model ( @xmath228 markers ) at @xmath229 .",
    "also shown is the spectrum of the empirical ( fit ) approximation to the mobility @xmath119 for the two larger spacings ; for @xmath230 our empirical approximation is very poor and includes many spurious negative eigenvalues ( not shown).,scaledwidth=90.0% ]    figure [ fig : eigenvalues ] clearly shows that the number of very small eigenvalues increases as we bring the markers closer to each other , as expected .",
    "the increase in the conditioning number is quite rapid , and the condition number becomes @xmath231 for marker spacings of about one per fluid grid cell .",
    "for the conventional choice @xmath232 , the mobility matrix is so poorly conditioned that we can not solve the constrained stokes problem in double - precision floating point arithmetic . of course",
    ", if the markers are too far apart then fluid will leak through the wall of the structure .",
    "we have performed a number of heuristic studies of leak through flat and curved rigid walls and concluded that @xmath229 yields both small leak and a good conditioning of the mobillity , at least for the six - point kernel used here @xcite . therefore , unless indicated otherwise , in the remainder of this work , we keep the markers about _ two grid cells apart _ in both two and three dimensions .",
    "it is important to emphasize that this is just a heuristic recommendation and not a precise estimate .",
    "we remark that taira and colonius , who solve a different schur complement `` modified poisson equation '' , recommend @xmath233 to `` achieve a reasonable condition number and to prevent penetration of streamlines caused by a lack of lagrangian points . ''",
    "it is important to observe that putting the markers further than the traditional wisdom will increase the `` leak '' between the markers . for rigid structures ,",
    "the exact positioning of the markers can be controlled since they do not move relative to one another as they do for an elastic bodies ; this freedom can be used to reduce penetration of the flow into the body by a careful construction of the marker grid . in the conclusions ,",
    "we discuss alternatives to the traditional marker - based ib method @xcite that can be used to control the conditioning number of the schur complement and allow for more tightly - spaced markers .",
    "it is worthwhile to examine the underlying cause of the ill - conditioning as the markers are brought close together .",
    "one source of ill - conditioning comes from the _ discrete _ ( finite - dimensional ) nature of the fluid solver , which necessarily limits the rank of the mobility matrix . but",
    "another contributor to the worsening of the conditioning is the _ regularization _ of the delta function .",
    "observe that for a true delta function ( @xmath34 ) in stokes flow , the pairwise mobility is the length - scale - free oseen tensor @xmath234 , and the shape of the spectrum of the mobility matrix has to be _ independent _ of the spacing among the markers . in the standard immersed boundary method , @xmath235 , so the fluid grid scale @xmath46 and the regularization scale @xmath35 are difficult to distinguish .    to try to separate @xmath46 from @xmath35 , we can take a continuum model of the fluid , but keep the discrete marker representation of the body ; see ( [ eq : semi_continuum ] ) . in this case the pairwise mobility would be given by ( [ eq : m_ij_stokes ] ) , which leads to the rpy tensor ( [ eq : rpytensor ] ) for a kernel that is a surface delta function over a sphere of radius @xmath35 ( see ( 4.1 ) in @xcite ) . in fig . [",
    "fig : eigenvalues ] we compare the spectra of the discrete mobility @xmath105 with those of the analytical mobility approximation @xmath227 constructed by using ( [ eq : rpytensor ] ) for the pairwise mobility .",
    "we observe that the two are very similar for @xmath222 , however , for smaller spacings @xmath227 does not have very small eigenvalues and is much better conditioned than @xmath105 ( data not shown ) . in fig .",
    "[ fig : eigenvalues ] we also show the spectrum of our approximate mobility @xmath119 constructed using the empirical fits described in section [ sec : approxmob ] . the resulting spectra show a worsening conditioning for spacing @xmath236 consistent with the spectrum of @xmath105 .",
    "these observations suggest that both the regularization of the kernel and the discretization artifacts contribute to the ill - conditioning , and suggest that it is worthwhile to explore alternative discrete delta function kernels in the context of rigid - body ib methods .",
    "we also note that we see a severe worsening of the conditioning of @xmath105 , independent of @xmath50 , when we switch from a spherical shell to a filled sphere model .",
    "some of this may be due to the fact that the tetrahedral volume mesh used to construct the marker mesh is not as uniform as the surface triangular mesh .",
    "we suspect , however , that this ill - conditioning is primarily _ physical _ rather than numerical , and comes from the fact that the present marker model can not properly distinguish between surface tractions and body ( volume ) stresses . therefore , @xmath0 remains physically ill - defined even if one gets rid of all discretization artifacts .",
    "lastly , it is important to emphasize that in the presence of ill - conditioning , what matters in practice are not only the smallest eigenvalues but also their associated eigenvectors .",
    "specifically , we expect to see signatures of these eigenvectors ( modes ) in @xmath0 , since they will appear with large coefficients in the solution of ( [ eq : lambda_sol ] ) if the right hand side has a nonzero projection onto the corresponding mode .",
    "as expected , the small - eigenvalue eigenvectors of the mobility correspond to high - frequency ( in the spatial sense ) modes for the forces @xmath0 .",
    "therefore , if the markers are too closely spaced the solutions for the forces @xmath0 will develop unphysical high - frequency oscillations or jitter , even for smooth flows , especially in time - dependent flows , as observed in practice @xcite .",
    "we have observed that for _ smooth _ flows ( i.e. , smooth right hand - side of ( [ eq : lambda_sol ] ) ) , the improved translational invariance of the 6-point kernel reduces the magnitude of this jitter compared to the traditional peskin four - point kernel .",
    "in this section we apply our rigid - body ib method to a number of benchmark problems .",
    "we first present tests of the preconditioned fgmres solver , and then demonstrate the advantage of our method over splitting - based direct forcing methods .",
    "we further consider a simple test problem at zero reynolds number , involving the flow around a fixed sphere , and study the accuracy of both the fluid ( eulerian ) variables @xmath5 and @xmath237 , as well as of the body ( lagrangian ) surface tractions represented by @xmath0 , as a function of the grid resolution .",
    "we finally study flows around arrays of cylinders in two dimensions and spheres in three dimensions over a range of reynolds numbers , and compare our results to those obtained by ladd using the lattice - boltzmann method @xcite .",
    "here we consider the model problem of flow past a sphere in a cubic domain that is either periodic or with no - slip boundaries .",
    "except for the largest resolutions studied here , the number of markers is relatively small , and dense linear algebra can be used to solve the mobility subproblem ( [ eq : mob_subproblem ] ) robustly and efficiently , so that the cost of the solver is dominated by the fluid solver .",
    "we therefore use the number of total applications of the stokes preconditioner ( [ p1_practical ] ) as a proxy for the cpu effort , instead of relying on elapsed time , which is both hardware and software dependent .",
    "a key parameter in our preconditioner is the number of iterations @xmath195 used in the iterative unconstrained stokes solver .",
    "we recall that in the full preconditioner , there are two unconstrained inexact stokes solves per iteration , giving a total of @xmath198 applications of @xmath199 per outer fgmres iteration . if the lower triangular preconditioner is used , then the second inexact stokes solve is omitted , and we perform only @xmath195 applications of @xmath199 per outer fgmres iteration .",
    "fgmres convergence for the constrained problem ( [ eq : constrained_stokes ] ) for different numbers of iterations @xmath195 in the unconstrained stokes solver used in the preconditioner .",
    "the specific problem is a rigid sphere of hydrodynamic radius @xmath238 moving through a stationary domain of length @xmath239 , with the marker spacing fixed at @xmath229 and the gmres restart frequency set to 100 iterations .",
    "( top left panel ) steady stokes ( @xmath240 ) flow for an empty 162-marker shell and a filled 239-marker sphere moving through a periodic domain of @xmath241 fluid grid cells .",
    "( top right panel ) same as top left but for @xmath242 .",
    "( bottom left panel ) as top left panel but now in domain with no slip boundary conditions applied on all sides of the domain .",
    "( bottom right panel ) a spherical shell moving in a non - periodic domain ( as in bottom left panel ) for different resolutions of the shell ( 162 , 642 , 2562 , and 10242 markers , respectively ) and the fluid solver grid ( @xmath241 , @xmath226 , @xmath225 , and @xmath190 grid cells , respectively ) , fixing @xmath243 , for both the full schur complement preconditioner and the lower triangular approximate schur complement preconditioner.,title=\"fig:\",scaledwidth=49.0%]fgmres convergence for the constrained problem ( [ eq : constrained_stokes ] ) for different numbers of iterations @xmath195 in the unconstrained stokes solver used in the preconditioner .",
    "the specific problem is a rigid sphere of hydrodynamic radius @xmath238 moving through a stationary domain of length @xmath239 , with the marker spacing fixed at @xmath229 and the gmres restart frequency set to 100 iterations .",
    "( top left panel ) steady stokes ( @xmath240 ) flow for an empty 162-marker shell and a filled 239-marker sphere moving through a periodic domain of @xmath241 fluid grid cells .",
    "( top right panel ) same as top left but for @xmath242 .",
    "( bottom left panel ) as top left panel but now in domain with no slip boundary conditions applied on all sides of the domain .",
    "( bottom right panel ) a spherical shell moving in a non - periodic domain ( as in bottom left panel ) for different resolutions of the shell ( 162 , 642 , 2562 , and 10242 markers , respectively ) and the fluid solver grid ( @xmath241 , @xmath226 , @xmath225 , and @xmath190 grid cells , respectively ) , fixing @xmath243 , for both the full schur complement preconditioner and the lower triangular approximate schur complement preconditioner.,title=\"fig:\",scaledwidth=49.0% ]    fgmres convergence for the constrained problem ( [ eq : constrained_stokes ] ) for different numbers of iterations @xmath195 in the unconstrained stokes solver used in the preconditioner .",
    "the specific problem is a rigid sphere of hydrodynamic radius @xmath238 moving through a stationary domain of length @xmath239 , with the marker spacing fixed at @xmath229 and the gmres restart frequency set to 100 iterations .",
    "( top left panel ) steady stokes ( @xmath240 ) flow for an empty 162-marker shell and a filled 239-marker sphere moving through a periodic domain of @xmath241 fluid grid cells .",
    "( top right panel ) same as top left but for @xmath242 .",
    "( bottom left panel ) as top left panel but now in domain with no slip boundary conditions applied on all sides of the domain .",
    "( bottom right panel ) a spherical shell moving in a non - periodic domain ( as in bottom left panel ) for different resolutions of the shell ( 162 , 642 , 2562 , and 10242 markers , respectively ) and the fluid solver grid ( @xmath241 , @xmath226 , @xmath225 , and @xmath190 grid cells , respectively ) , fixing @xmath243 , for both the full schur complement preconditioner and the lower triangular approximate schur complement preconditioner.,title=\"fig:\",scaledwidth=49.0%]fgmres convergence for the constrained problem ( [ eq : constrained_stokes ] ) for different numbers of iterations @xmath195 in the unconstrained stokes solver used in the preconditioner .",
    "the specific problem is a rigid sphere of hydrodynamic radius @xmath238 moving through a stationary domain of length @xmath239 , with the marker spacing fixed at @xmath229 and the gmres restart frequency set to 100 iterations .",
    "( top left panel ) steady stokes ( @xmath240 ) flow for an empty 162-marker shell and a filled 239-marker sphere moving through a periodic domain of @xmath241 fluid grid cells .",
    "( top right panel ) same as top left but for @xmath242 .",
    "( bottom left panel ) as top left panel but now in domain with no slip boundary conditions applied on all sides of the domain .",
    "( bottom right panel ) a spherical shell moving in a non - periodic domain ( as in bottom left panel ) for different resolutions of the shell ( 162 , 642 , 2562 , and 10242 markers , respectively ) and the fluid solver grid ( @xmath241 , @xmath226 , @xmath225 , and @xmath190 grid cells , respectively ) , fixing @xmath243 , for both the full schur complement preconditioner and the lower triangular approximate schur complement preconditioner.,title=\"fig:\",scaledwidth=49.0% ]    in the first set of experiments , we use the full preconditioner and periodic boundary conditions .",
    "we represent the sphere by a spherical shell of markers that is either empty ( 162 markers ) or is filled with additional markers in the interior ( 239 markers ) .",
    "the top panels of fig .",
    "[ fig : gmres_3d ] show the relative fgmres residual as a function of the total number of applications of @xmath199 for several different choices of @xmath195 , for both steady stokes flow ( left panel ) and a flow at reynolds number @xmath244 ( right panel ) .",
    "we see that for spherical shells with well - conditioned @xmath105 and @xmath119 , the exact value of @xmath195 does not have a large effect on solver performance . however , making @xmath195 very large leads to wasted computational effort by `` over - solving '' the stokes system .",
    "this degrades the overall performance , especially for tight solver tolerance . for the ill - conditioned case of a filled sphere model in steady stokes flow",
    ", the exact value of @xmath195 strongly affects the performance , and the optimal value is empirically determined to be @xmath245 .",
    "as expected , the linear system ( [ eq : constrained_stokes ] ) is substantially easier to solve at higher reynolds numbers , especially for the filled - sphere models .    in the bottom left panel of fig .",
    "[ fig : gmres_3d ] we show the fgmres convergence for a non - periodic system . in this case",
    ", we know that the stokes preconditioner @xmath199 itself does not perform as well as in the periodic case @xcite , and we expect slower overall convergence . in this case",
    ", we see that @xmath245 and @xmath243 are good choices . investigations ( data not shown )",
    "show that @xmath243 is more robust for problems with a larger number of markers . also ,",
    "note that increasing @xmath195 decreases the total number of fgmres iterations for a fixed number of applications of @xmath199 , and therefore reduces the overall memory usage and the number of times the mobility subproblem ( [ eq : mob_subproblem ] ) needs to be solved ; however , note that each of these solves is just a backward / forward substitution if a direct factorization of @xmath119 has been precomputed .    the bottom right panel of fig . [ fig : gmres_3d ] shows the fgmres convergence for a non - periodic system as the resolution of the grid and the spherical shell is refined in unison , keeping @xmath243 .",
    "the results in fig . [ fig : gmres_3d ] demonstrate that our linear solver is able to cope with the increased number of degrees of freedom under refinement relatively robustly , although a slow increase of the total number of fgmres iterations is observed . comparing the full preconditioner with the lower triangular preconditioner",
    ", we see that the latter is computationally more efficient overall ; this is in agreement with experience for the unconstrained stokes system @xcite . in some sense",
    ", what this shows is that it is best to let the fgmres solver correct the initial unconstrained solution for the velocity and pressure in the _ next _ fgmres iteration , rather than to re - solve the fluid problem in the preconditioner itself .",
    "however , if very tight solver tolerance is required , we find that it is necessary to perform some corrections of the velocity and pressure inside the preconditioner . in principle , the second unconstrained stokes solve in the preconditioner can use a different number of iterations @xmath246 from the first , but we do not explore this option further here . also note that if @xmath247 ( for example , if it was computed numerically rather than approximated ) , then the full schur complement preconditioner will converge in one or two iterations and there is no advantage to using the lower triangular preconditioner .",
    "in this section we demonstrate the strengths of our method on a test problem involving steady - state flow through a nozzle in two dimensions .",
    "we compare the steady state flow through the nozzle obtained using our rigid - body ib method to the flow obtained by using a splitting - based direct forcing approach @xcite . specifically , we contrast our monolithic fluid - solid solver to a split solver based on performing the following operations at time step @xmath248:solve the fluid sub - problem as if the body were not present , @xmath86\\left[\\begin{array}{c } \\tilde{\\v}^{n+1}\\\\ \\tilde{\\p}^{n+\\half } \\end{array}\\right]=\\left[\\begin{array}{c } \\v g^{n+\\half}\\\\ \\v 0 \\end{array}\\right].\\ ] ]    1 .",
    "calculate the slip velocity on the set of markers , @xmath249 , giving the fluid - solid force estimate @xmath250 .",
    "2 .   correct the fluid velocity to approximately enforce the no - slip condition , @xmath251    note that in the original method of @xcite in the last step the fluid velocity is projected onto the space of divergence - free vector fields by re - solving the fluid problem with the approximation @xmath252 ( i.e. , ignoring viscosity ) .",
    "we simplify this step here because we have found the projection to make a small difference in practice for steady state flows , since the same projection is carried out in the subsequent time step .    two - dimensional flow through a nozzle ( top panel ) in a slit channel computed by our rigid ib method ( left panels ) and a simplified version of the splitting - based method of bhalla _ et al .",
    "@xcite ( right panels ) .",
    "( top panel ) the geometry of the channel along with the ( approximately ) steady state flow at @xmath253 , as obtained using our method .",
    "the color plot shows the pressure and the velocity is shown as a vector field .",
    "( middle panels ) flow at @xmath254 , computed at time @xmath255 . for our method ( left )",
    "we use a time step size of @xmath256 ( corresponding to advective cfl number of @xmath257 ) , while for the splitting method ( right ) we use @xmath258 .",
    "the streamlines are traced from the entrance to the channel for a time of @xmath259 and shown as black lines .",
    "( bottom panels ) same as the middle row but now for @xmath260 , final time @xmath261 and streamlines followed up to @xmath262 , with @xmath263 for our method ( left ) , and @xmath258 for the splitting method ( right).,scaledwidth=90.0% ]    two - dimensional flow through a nozzle ( top panel ) in a slit channel computed by our rigid ib method ( left panels ) and a simplified version of the splitting - based method of bhalla _ et al . _",
    "@xcite ( right panels ) .",
    "( top panel ) the geometry of the channel along with the ( approximately ) steady state flow at @xmath253 , as obtained using our method .",
    "the color plot shows the pressure and the velocity is shown as a vector field .",
    "( middle panels ) flow at @xmath254 , computed at time @xmath255 . for our method ( left )",
    "we use a time step size of @xmath256 ( corresponding to advective cfl number of @xmath257 ) , while for the splitting method ( right ) we use @xmath258 .",
    "the streamlines are traced from the entrance to the channel for a time of @xmath259 and shown as black lines .",
    "( bottom panels ) same as the middle row but now for @xmath260 , final time @xmath261 and streamlines followed up to @xmath262 , with @xmath263 for our method ( left ) , and @xmath258 for the splitting method ( right).,title=\"fig:\",scaledwidth=49.0%]two - dimensional flow through a nozzle ( top panel ) in a slit channel computed by our rigid ib method ( left panels ) and a simplified version of the splitting - based method of bhalla _ et al . _",
    "@xcite ( right panels ) .",
    "( top panel ) the geometry of the channel along with the ( approximately ) steady state flow at @xmath253 , as obtained using our method .",
    "the color plot shows the pressure and the velocity is shown as a vector field .",
    "( middle panels ) flow at @xmath254 , computed at time @xmath255 . for our method ( left )",
    "we use a time step size of @xmath256 ( corresponding to advective cfl number of @xmath257 ) , while for the splitting method ( right ) we use @xmath258 .",
    "the streamlines are traced from the entrance to the channel for a time of @xmath259 and shown as black lines .",
    "( bottom panels ) same as the middle row but now for @xmath260 , final time @xmath261 and streamlines followed up to @xmath262 , with @xmath263 for our method ( left ) , and @xmath258 for the splitting method ( right).,title=\"fig:\",scaledwidth=49.0% ]    two - dimensional flow through a nozzle ( top panel ) in a slit channel computed by our rigid ib method ( left panels ) and a simplified version of the splitting - based method of bhalla _ et al . _",
    "@xcite ( right panels ) .",
    "( top panel ) the geometry of the channel along with the ( approximately ) steady state flow at @xmath253 , as obtained using our method .",
    "the color plot shows the pressure and the velocity is shown as a vector field .",
    "( middle panels ) flow at @xmath254 , computed at time @xmath255 . for our method ( left )",
    "we use a time step size of @xmath256 ( corresponding to advective cfl number of @xmath257 ) , while for the splitting method ( right ) we use @xmath258 .",
    "the streamlines are traced from the entrance to the channel for a time of @xmath259 and shown as black lines .",
    "( bottom panels ) same as the middle row but now for @xmath260 , final time @xmath261 and streamlines followed up to @xmath262 , with @xmath263 for our method ( left ) , and @xmath258 for the splitting method ( right).,title=\"fig:\",scaledwidth=49.0%]two - dimensional flow through a nozzle ( top panel ) in a slit channel computed by our rigid ib method ( left panels ) and a simplified version of the splitting - based method of bhalla _ et al . _",
    "@xcite ( right panels ) .",
    "( top panel ) the geometry of the channel along with the ( approximately ) steady state flow at @xmath253 , as obtained using our method .",
    "the color plot shows the pressure and the velocity is shown as a vector field .",
    "( middle panels ) flow at @xmath254 , computed at time @xmath255 . for our method ( left )",
    "we use a time step size of @xmath256 ( corresponding to advective cfl number of @xmath257 ) , while for the splitting method ( right ) we use @xmath258 .",
    "the streamlines are traced from the entrance to the channel for a time of @xmath259 and shown as black lines .",
    "( bottom panels ) same as the middle row but now for @xmath260 , final time @xmath261 and streamlines followed up to @xmath262 , with @xmath263 for our method ( left ) , and @xmath258 for the splitting method ( right).,title=\"fig:\",scaledwidth=49.0% ]    we discretize a nozzle constriction in a slit channel using ib marker points about 2 grid spacings apart .",
    "the geometry of the problem is illustrated in the top panel of fig .",
    "[ fig : nozzle ] ; parameters are @xmath264 , grid spacing @xmath265 , nozzle length @xmath266 , nozzle opening width @xmath267 , and @xmath17 variable ( other parameters are given in the figure caption ) .",
    "no slip boundary conditions are specified on the top and bottom channel walls , and on the side walls the tangential velocity is set to zero and the normal stress is specified to give a desired pressure jump across the channel of @xmath268 . the domain is discretized using a grid of @xmath269 cells and the problem evolved for some time until the flow becomes essentially steady .",
    "the reynolds number is estimated based on the maximum velocity through the nozzle opening and the width of the opening .    in the bottom four panels in fig .",
    "[ fig : nozzle ] we compare the flow computed using our method ( left panels ) to that obtained using the splitting - based direct forcing algorithm summarized above ( right panels ) .",
    "our method is considerably slower ( by at least an order of magnitude ) for this specific example because the gmres convergence is slow for this challenging choice of boundary conditions at small reynolds numbers in two dimensional ( recall that steady stokes flow in two dimensions has a diverging green s function ) . to make the comparison fairer",
    ", we use a considerably smaller time step size for the splitting method , so that we approximately matched the total execution time between the two methods . note that for steady - state problems like this one with fixed boundaries",
    ", it is much more efficient to precompute the _ actual _ mobility matrix ( schur complement ) once at the beginning , instead of approximating it with our empirical fits .",
    "however , for a more fair and general comparison we instead use our preconditioner to solve the constrained fluid problem in each time step anew to a tight gmres tolerance of @xmath270 . for this test",
    "we use @xmath245 iterations in the fluid solves inside our preconditioner .",
    "the visual results in the right panels of fig . [ fig : nozzle ] clearly show that the splitting errors in the enforcement of the no - slip boundary condition lead to a notable `` leak '' through the boundary , especially at small reynolds numbers . to quantify the amount of leak we compute the ratio of the total flow through the opening of the nozzle to the total inflow ; if there is no leak this ratio should be unity . indeed , this ratio is larger than @xmath271 for our method at all reynolds numbers , as seen in the lack of penetration of the flow inside the body in the left panels in fig .",
    "[ fig : nozzle ] . for @xmath254 , we find that even after reducing the time step by a factor of 50 , the splitting method gives a ratio of @xmath272 ( i.e. , 6.5% leak ) , which can be seen as a mild penetration of the flow into the body in the middle right panel in fig .",
    "[ fig : nozzle ] . for @xmath260",
    ", we find that we need to reduce @xmath47 by a factor of 1250 to get a flow ratio of @xmath273 for the splitting method ; for a time step reduced by a factor of 125 there is a strong penetration of the flow through the nozzle , as seen in the bottom right panel of fig .",
    "[ fig : nozzle ] .",
    "steady stokes flow around a fixed sphere of radius @xmath274 in an unbounded domain ( with fluid at rest at infinity ) is one of the fundamental problems in fluid mechanics , and analytical solutions are well known .",
    "our numerical method uses a regular grid for the fluid solver , however , and thus requires a finite truncation of the domain .",
    "inspired by the work of balboa - usabiaga et al .",
    "@xcite , we enclose the sphere inside a rigid spherical shell of radius @xmath275 .",
    "this naturally provides a truncation of the domain because the flow exterior to the outer shell does not affect the flow inside the shell .",
    "analytical solutions remain simple to compute and are given in appendix [ appendixconcentric ] .",
    "marker configuration for computing stokes flow between two concentric spherical shells .",
    "markers are shown as spheres with size on the order of their effective hydrodynamic radius .",
    "the inner shell of markers is shown in red , and the outer shell of markers is shown in gray .",
    "( left ) intermediate resolution , inner shell of 162 markers and outside shell of 2562 markers .",
    "( right ) highest resolution studied here , inner shell of 642 markers and outside shell of 10242 markers.,title=\"fig:\",scaledwidth=49.0%]marker configuration for computing stokes flow between two concentric spherical shells .",
    "markers are shown as spheres with size on the order of their effective hydrodynamic radius .",
    "the inner shell of markers is shown in red , and the outer shell of markers is shown in gray .",
    "( left ) intermediate resolution , inner shell of 162 markers and outside shell of 2562 markers .",
    "( right ) highest resolution studied here , inner shell of 642 markers and outside shell of 10242 markers.,title=\"fig:\",scaledwidth=49.0% ]    we discretize the inner sphere using a spherical shell of markers , since for steady stokes flow imposing a rigid body motion on the surface of the inner sphere guarantees a stress - free rigid body motion for the fluid filling the inner sphere @xcite .",
    "we use the same recursive triangulation of the sphere , described in section [ sec : solver ] , to construct the marker grid for both the inner and outer shells .",
    "the ratio of the number of markers on the outer and inner spheres is approximately @xmath276 ( i.e. , there are two levels of recursive refinement between the inner and outer shells ) , consistent with keeping the marker spacing similar for the two shells and a fixed ratio @xmath277 .",
    "the fluid grid size is set to keep the markers about two grid cells apart , @xmath222 .",
    "the rigid - body velocity is set to @xmath278 for all markers on the outer shell , and to @xmath279 on all markers on the inner shell .",
    "the outer sphere is placed in a cubic box of length @xmath280 with specified velocity @xmath281 on all of the boundaries ; this choice ensures that the flow outside of the outer shell is nearly uniform and equal to @xmath281 . in the continuum setting , this exterior flow does not affect the flow of interest ( which is the flow in - between the two shells ) , but this is not the case for the ib discretization since the regularized delta function extends a few grid cells on _ both _ sides of the spherical shell .    a spherical shell of _ geometric _ radius @xmath282 covered by markers acts hydrodynamically as a rigid sphere of effective _ hydrodynamic _ radius @xmath283 @xcite , where @xmath35 is the hydrodynamic radius of a single marker @xcite ( we recall that for the six - point kernel used here , @xmath284 )",
    ". a similar effect appears in the lattice - boltzmann simulations of ladd , with @xmath35 being related to the lattice spacing @xcite . when comparing to theoretical expressions , we use the effective hydrodynamic radii of the spherical shells ( computed as explained below ) and _ not _ the geometric radii .",
    "of course , the enhancement of the effective hydrodynamic radius over the geometric one is a numerical discretization artifact , and one could choose not to correct the geometric radius .",
    "however , this comparison makes immersed boundary models of steady stokes flow appear much less accurate than they actually are in practice .",
    "for example , one should not treat a line of markers as a zero - thickness object of zero geometric radius ; rather , such a line of rigidly - connected markers should be considered to model a rigid cylinder with finite thickness proportional to @xmath35 @xcite .    we can measure the effective hydrodynamic radius @xmath285 of a spherical shell of markers from the drag force on a periodic cubic lattice of such objects moving with velocity @xmath286 . specifically , we place a single shell of @xmath25 markers in a triply - periodic domain with cubic unit cell of length @xmath178 , set @xmath278 on all markers , solve ( [ eq : constrained_stokes ] ) , and measure the total drag force as @xmath287 . the periodic correction to the stokes drag formula is well - known @xcite , @xmath288 and allows us to obtain a very accurate estimate of @xmath285 from the drag for @xmath289 .",
    "the results are given in the left half of table [ tab : r_h_3d ] in the form of the dimensionless ratio @xmath290 ; we see that as the resolution is increased @xmath291 with an approximately linear rate of convergence , as expected .",
    "since this computation refers to flow outside of the shell of markers , we can call the computed @xmath285 the effective _ outer _",
    "hydrodynamic radius and use it to set the value of @xmath274 in the theory .",
    "we use a similar procedure to measure an effective _ inner _ hydrodynamic radius @xmath292 for the outer spherical shell .",
    "specifically , we obtain @xmath292 from the drag on the inner sphere based on the theoretical formula ( [ eq : drag_inner ] ) , where we use the previously - determined value of @xmath274 for the effective radius of the inner sphere .",
    "the results are given in the right half of table [ tab : r_h_3d ] and again show that as the grid is refined the hydrodynamic radii converge to the geometric ones .",
    ".[tab : r_h_3d]ratio of the effective hydrodynamic and geometric radii of the inner ( left half ) and outer ( right half ) spherical shells for simulations of steady stokes flow around a fixed sphere embedded within a moving spherical cavity , at different resolutions . [ cols=\"<,<,^,^,^,^\",options=\"header \" , ]     numerical results for the dimensionless drag coefficient @xmath8 near the close - packed density @xmath293 are shown in fig .",
    "[ fig : drag3d_array ] . because our discrete models of spheres do not have the same symmetry as a perfect sphere , we numerically observe a small @xmath294 correction that can dominate the true correction @xmath295 for @xmath296",
    "; this is especially evident in the right panel of fig .",
    "[ fig : drag3d_array ] for coarsely - resolved models ( e.g. , a 56-marker sphere ) .",
    "does not show deviations from the expected quadratic behavior even at rather small @xmath297 . ]",
    "empirical fits to literature data for @xmath298 , @xmath299 , @xmath300 , and the range of @xmath297 values over which the various fits are valid are tabulated in ref .",
    "[ fig : drag3d_array ] compares our results to these fits , as well as to reference results obtained using the lattice boltzmann method @xcite at close packing .",
    "we observe the expected switch from linear to quadratic dependence on @xmath297 and also a reasonable agreement with the literature data , and the agreement appears to improve with increasing resolution .",
    "numerical values ( symbols ) for the drag coefficient of a periodic array of spheres close packed in a cubic lattice of volume fraction @xmath301 , for several resolutions ( see legend ) , using a linear ( left ) or log scaling ( right ) .",
    "comparison is made to empirical formulas given in @xcite ( lines ) , as well as lattice boltzmann results for close - packed cubic arrays given in table 6 in @xcite ( crosses).,title=\"fig:\",scaledwidth=49.0%]numerical values ( symbols ) for the drag coefficient of a periodic array of spheres close packed in a cubic lattice of volume fraction @xmath301 , for several resolutions ( see legend ) , using a linear ( left ) or log scaling ( right ) .",
    "comparison is made to empirical formulas given in @xcite ( lines ) , as well as lattice boltzmann results for close - packed cubic arrays given in table 6 in @xcite ( crosses).,title=\"fig:\",scaledwidth=49.0% ]",
    "this paper develops an immersed boundary method that enforces strict rigidity of immersed bodies at both zero and finite reynolds numbers . unlike existing approaches",
    ", we do not rely on penalty or splitting approaches , and we instead directly solve a saddle - point system that couples the fluid velocity and pressure to the unknown rigidity forces .",
    "we developed a physics - inspired approximation @xmath119 to the schur complement ( mobility matrix ) @xmath105 of the constrained system , based on analytical considerations for a continuum fluid model , and demonstrated that this leads to a robust preconditioner so long as the immersed boundary markers are kept sufficiently far to ensure a well - conditioned mobility matrix .",
    "contrary to common practice , we found that the markers should be kept approximately two fluid grid cells apart in rigid - body models in order to obtain accurate and stable pointwise estimates for the traction .",
    "we tested our method on a number of standard test problems in both two and three spatial dimensions , and at both zero and finite reynolds number , and we observed good agreement with theory and literature values .",
    "although in this work we focused on rigid bodies , our method can directly be applied to study fluid flow around bodies with specified kinematics .",
    "for example , it can be used to model the flow around a swimming body deforming with a specified gait .",
    "we have implemented the method described here in the open - source ibamr software infrastructure @xcite in the hope it will be useful to other users of the ib method .",
    "another challenge that we did not explore here is the efficient computation of the action of @xmath302 when there are many markers present ; there are many approximate solvers and emerging fast solvers we plan to explore in the future . of course , using dense linear algebra to solve ( [ eq : mob_subproblem ] ) is likely to be suboptimal , as these solves have @xmath303 memory complexity and @xmath304 time complexity .",
    "the problem of solving a linear systems similar in structure to ( [ eq : mob_subproblem ] ) appears in many other methods for hydrodynamics of suspensions , including brownian @xcite and stokesian @xcite dynamics , the method of regularized stokeslets @xcite , computations based on bead models of rigid bodies @xcite , and first - kind boundary integral formulations of stokes flow @xcite .",
    "similar matrices appear in static poisson problems such as electrostatics or reaction - diffusion models @xcite , and there is a substantial ongoing work that can be applied to our problem .",
    "notably , the approximate mobility matrix @xmath119 is dense but has a well - understood low - rank structure that can be exploited .",
    "specifically , matrix - vector products @xmath305 can be performed in almost linear time using the fast multipole method @xcite .",
    "if the condition number of @xmath119 is not too large , one can solve linear systems involving @xmath119 efficiently using an unpreconditioned krylov solver .",
    "for poorly conditioned cases , however , a good preconditioner based on an approximate factorization of @xmath119 is required . in recent years",
    ", several approximate low - rank factorizations of matrices of this type have been developed @xcite , and can be used as preconditioners in krylov methods .",
    "we have had reasonable success using a fast hierarchically off - diagonal low - rank ( hodlr ) factorization code developed by ambikasaran and darve @xcite , with significant improvement offered by a recently - developed boundary distance low - rank approximation @xcite .",
    "preliminary results indicate great promise for the inverse fast multipole ( ifmm ) method @xcite ; we have been able to use ifmm to solve the system ( [ eq : mob_subproblem ] ) for as many as @xmath306 markers to a relative tolerance of @xmath307 .",
    "these methods are , however , still under active development , and a significant amount of investigation is necessary to integrate them into the method described here .",
    "notably , we only require an approximate solver for ( [ eq : mob_subproblem ] ) and the impact of the innacuracy in solving ( [ eq : mob_subproblem ] ) on the overall convergence of the outer krylov solver needs to be assessed .",
    "the type of linear system we solve here is closely connected to those appearing in implicit immersed boundary methods @xcite .",
    "it is in fact possible to recast the saddle - point problem we consider here into a form closely - related to that appearing in implicit ib methods ; the schur complement for this system is in eulerian rather than lagrangian variables as it was for this work , and involves the matrix @xmath308 for some constant @xmath76 that does _ not _ need to go to infinity .",
    "it may be that geometric multigrid methods @xcite developed for implicit ib methods can be applied to the eulerian schur complement ( [ eq : schur_eulerian ] ) . at the same time",
    ", techniques developed herein may be useful in the development of more efficient implicit ib methods for nearly - rigid bodies .",
    "our work is only the first step toward the ultimate goal of developing methods able to handle large numbers of rigid bodies in flow .",
    "several computational challenges need to be tackled to realize this goal .",
    "firstly , and most importantly , it is crucial to develop a preconditioner for the enlarged linear system ( [ eq : free_kinematics_stokes ] ) that appears in the context of freely - moving rigid bodies .",
    "an additional schur complement appears when solving this saddle - point problem , and the challenge for future work is approximating the body mobility matrix @xmath309 initial investigations have shown great promise in block - diagonal preconditioners with one block per body . in this approach ,",
    "we neglect the hydrodynamic interactions between bodies , but use the mobility approximation developed in this work together with dense linear algebra for each body .    in the marker - based method described in this work",
    ", one must adjust the marker spacing to be `` neither too small nor too large '' .",
    "the sensitivity of the solver performance and the numerical results to the exact spacing of the markers , which comes from the ill - conditioning of the mobility matrix , is one of the key deficiencies of the marker - based representation inherent to the traditional ib method .",
    "recently , griffith and luo have proposed an alternative ib approach that models the deformations and stresses of immersed elastic body using a finite element ( fe ) representation @xcite . in their ib",
    "/ fe approach , the degrees of freedom associated with @xmath0 are represented on an fe mesh that may be coarser than the fluid grid , and the interaction between the fluid grid and body mesh is handled by placing ib markers at the numerical quadrature points of the fe mesh .",
    "when such an approach is generalized to rigid bodies , the conditioning of the mobility becomes much less sensitive to the marker spacing . using a finite - element basis to represent the unknown fluid - body interaction force amounts to applying a",
    "_ filter @xmath310 _ to the marker - based mobility matrix , which is a well - known and robust technique to regularize ill - conditioned systems .",
    "specifically , in the context of the ib / fe approach , the mobility operator becomes @xmath311 where @xmath310 is a matrix that contains quadrature weights as well as geometric information about the relation between the nodes and quadrature points of the fe mesh . the fe mobility matix @xmath312 is still symmetric , but now can be much smaller because the number of unknowns is equal to the number of fe degrees of freedom rather than the number of markers .",
    "even if markers are closely spaced , the filtering of the high - frequency modes performed by representing forces in a smooth fe basis makes the mobility much better conditioned than for marker - based schemes .",
    "furthermore , the mobility matrix , or approximations of it used for preconditioning , will be smaller and thus easier to fit in memory .",
    "we also expect the resulting method to be more accurate because the tractions are represented in a smoother basis .",
    "we will explore this promising extension of our rigid - body ib methods in future work .",
    "we thank john brady , bob guy , anthony ladd , neelesh patankar , and charles peskin for numerous stimulating and informative discussions .",
    "we thank sivaram ambikasaran , pieter coulier , amirhossein aminfar , and eric darve for their help with low - rank approximate factorizations of mobility matrices .",
    "a. donev and b. kallemov were supported in part by the air force office of scientific research under grant number fa9550 - 12 - 1 - 0356 , as well as by the national science foundation under award dms-1418706 .",
    "b. e. griffith and a. p. s. bhalla were supported in part by the national science foundation under awards dms-1016554 and aci-1047734 ( to new york university school of medicine ) and awards dms-1460368 and aci-1460334 ( to the university of north carolina at chapel hill ) .",
    "in this appendix we give the details of our empirical fits for the approximations to the functions @xmath125 and @xmath126 in ( [ eq : m_tilde_ij ] ) in three spatial dimensions , following the physics - based constraints discussed in section [ sec : approxmob ] . to maximize the quality of the fit",
    ", we perform separate fits for @xmath51 ( steady stokes flow ) and finite @xmath50 .",
    "we also make an effort to make the fits change smoothly as @xmath50 grows towards infinity .",
    "because our numerical computations are done in a periodic domain of length @xmath178 rather than an unbounded domain , we need to apply a well - known correction to the oseen tensor @xcite , @xmath313 from the numerical data , we calculated the normalized functions @xmath314 where @xmath189 is the normalized distance between the markers . as explained previously , we know that @xmath315 for @xmath316 ( in practice , markers are never too close to each other so we only need the self - mobility , i.e. , @xmath317 ) , and that @xmath318 grows at least quadratically for small @xmath319 ( since @xmath320 ) .",
    "we also know that @xmath321 and @xmath322 for large @xmath156 .",
    "the numerical data for the normalized functions @xmath187 and @xmath188 are shown in fig .",
    "[ fig : fg_3d_asympt ] along with fits to the following semi - empirical rational functions , @xmath323 as the figure shows , the numerical data are well described by these formulas , and there is only small scatter of the numerical data around the fit , indicating approximate discrete translational and rotational invariance .",
    "we also obtain a reasonable agreement with the rpy tensor ( [ eq : rpytensor ] ) approximation ; however , as expected , the empirical fits yield a better match to the data .      for finite @xmath50 ,",
    "we consider separately the case @xmath158 ( giving the diagonal elements @xmath159 ) and @xmath324 ( giving the off - diagonal elements ) .",
    "for @xmath158 we use an empirical fit designed to conform to ( [ eq : f_beta_r_0 ] ) , @xmath325 where @xmath326 are coefficients obtained by fitting the numerical data for the self mobility for different @xmath50 . note that @xmath327 is fixed by the inviscid condition ( [ eq : f_0_inviscid ] ) . also note that as @xmath51 , our fit obeys the correct stokes limit , @xmath328 we show the empirical fit for @xmath329 in fig .",
    "[ fig : f_0_3d ] in appendix [ appendixmob2d ] .    for nonzero @xmath330",
    ", we introduce normalized functions @xmath331 and @xmath332 via @xmath333 where @xmath189 is the normalized distance , and @xmath334 . for finite @xmath50 , we know that @xmath335 according to ( [ eq : fg_inv_3d ] ) . as @xmath51 , we want to reach the stokes limit @xmath336 and for finite @xmath50 , we want the viscous contribution to decay as @xmath337 for some constant @xmath338 that should be close to unity .",
    "furthermore , we would like to ensure continuity near the origin with the fit for @xmath158 , @xmath339    a fitting formula that obeys these conditions that we find to work well for @xmath324 is @xmath340}{1+a_{0}x+a_{1}x^{2}+a_{2}x^{3}+a_{4}x^{5}\\varphi_{0}(\\beta)}+\\nonumber \\\\   &   & + \\frac{a_{5}x^{4}e^{-a_{6}x}+a_{7}x^{4}}{1+a_{8}x^{3}+a_{9}x^{5}},\\label{eq : f_beta_3d_fit}\\\\ \\tilde{g}_{\\beta}(x ) & = & \\varphi_{0}(\\beta)\\frac{b_{5}\\left[x^{5}+x^{7}e^{(-b_{0}x/\\sqrt{\\beta})}/(6\\beta)\\right]}{1+b_{1}x+b_{2}x^{2}+b_{3}x^{3}+b_{4}x^{4}+b_{5}\\varphi_{0}(\\beta)x^{5}},\\nonumber \\end{aligned}\\ ] ] where @xmath341-@xmath342 and @xmath343-@xmath344 are empirical coefficients .",
    "it is important to emphasize that ( [ eq : f_beta_3d_fit ] ) was chosen in large part based on empirical trial and error .",
    "many other alternatives exist .",
    "for example , one could use the analytical brinkmanlet ( [ eq : brinkmanlet_3d ] ) for sufficiently large distances and then add short - ranged corrections for nearby markers .",
    "alternatively , one could first subtract the inviscid part @xmath345 and @xmath346 and then fit the viscous contribution only . as discussed above ,",
    "ideally the fits would be constrained to guarantee an spd approximate mobility matrix , but this seems difficult to accomplish in practice .    normalized fitting functions @xmath347 ( left ) and @xmath348 ( right ) at finite @xmath50 in three dimensions for the 6-point kernel , for different values of the viscous cfl number ( see legend ) .",
    "symbols are numerical data obtained by using a @xmath190 periodic fluid grid , and dashed lines show the best fit of the form ( [ eq : f_beta_3d_fit]).,title=\"fig:\",scaledwidth=49.0%]normalized fitting functions @xmath347 ( left ) and @xmath348 ( right ) at finite @xmath50 in three dimensions for the 6-point kernel , for different values of the viscous cfl number ( see legend ) .",
    "symbols are numerical data obtained by using a @xmath190 periodic fluid grid , and dashed lines show the best fit of the form ( [ eq : f_beta_3d_fit]).,title=\"fig:\",scaledwidth=49.0% ]    we computed the fitting coefficients in ( [ eq : f_beta_3d_fit ] ) for @xmath349 ; the coefficients for other values in the range @xmath350 are interpolated using linear interpolation , and @xmath351 is treated using the steady stokes fitting .",
    "we see a good match between the numerical data and our empirical fits in fig .",
    "[ fig : fg_3d_fit ] , with good translational and rotational invariance ( i.e. , relatively small scatter of the numerical points around the fits ) .",
    "to construct empirical approximations to the functions @xmath125 and @xmath126 in ( [ eq : m_tilde_ij ] ) in two spatial dimensions , we follow the same approach as we did for three dimensions in appendix [ appendixmob3d ] .",
    "specifically , we first discuss the known asymptotic behavior of these functions at short and large distances , and use this to guide the construction of empirical fitting formulas .      in two dimensions ,",
    "we need to modify ( [ eq : f_beta_r_0 ] ) to agree with ( [ eq : f_0_inviscid ] ) for small @xmath50 . for @xmath13 , @xmath352 and @xmath353 so that we use the fit @xmath354 where @xmath355 has the same asymptotic scaling as in three dimensions and is obtained from empirical fits ( see fig .",
    "[ fig : f_0_2d ] ) .",
    "a key difference exists between two and three spatial dimensions in the limit @xmath356 . for steady stokes flow in a square two dimensional periodic domain ,",
    "the green s function diverges logarithmically with the system size @xmath178 .",
    "therefore , it is not possible to write a formula for the asymptotic behavior at large distances for an infinite system .",
    "instead , we must subtract the divergent piece to get a well - defined answer .",
    "the standard green s function for stokes flow in two dimensions has logarithmic growth at infinity , which suggests that ( [ eq : fg_asympt_3d ] ) should be replaced by @xmath357 for inviscid flow we should replace ( [ eq : fg_inv_3d ] ) by the field of a dipole in two dimensions , @xmath358 in two dimensions the solutions of the brinkmann equation ( [ eq : brinkman_greens ] ) are analytically complicated and involve special functions . even without solving these equations",
    ", however , physical scaling suggests that the same physical length scale @xmath359 should enter , in particular , the viscous corrections should decay to zero exponentially fast with @xmath359 .",
    "we have used the analytical results above to construct empirical fitting formulas that have the correct asymptotic behavior , as we now explain in more detail .      in two dimensions , steady stokes flow ( @xmath51 )",
    "is not well behaved because the green s function does not decay sufficiently rapidly ( stokes paradox ) .",
    "this makes the mobility an essentially dense matrix that is sensitive to boundary conditions and difficult to approximate .",
    "nevertheless , we have used a periodic system to fit empirical data based on the theory ( [ eq : fg_asympt_2d ] ) .",
    "the diagonal value @xmath360 diverges logarithmically with the system size @xmath361 for periodic boundaries .",
    "specifically , for a square unit cell of length @xmath362 , it is known that @xcite @xmath363 and this relation defines the effective hydrodynamic radius of a marker @xmath35 ( note that @xmath364 is a universal value for a given spatial discretization , as it is in three dimensions ) .",
    "since the precise form depends on boundary conditions and is not known in general , we treat @xmath360 as an _ input _ parameter .    from the numerical data , we calculated the normalized functions @xmath365 where @xmath189 is the normalized distance between the markers .",
    "observe that from ( [ eq : fg_asympt_2d ] ) we know that @xmath366 and @xmath367 .",
    "for the normalized functions , we use the fits @xmath368 numerical results and empirical fits for @xmath187 and @xmath188 are shown in fig . [",
    "fig : fg_steady_2d ] . while the numerical data do conform to the theoretical asymptotic behavior ,",
    "there is substantial scatter for larger distances because of the strong sensitivity to the boundaries .",
    "empirical fits ( lines ) to numerical data ( symbols ) for @xmath187 ( left ) and @xmath188 ( right ) , for the 6-point kernel in two dimensions , obtained using a periodic system of either @xmath369 or @xmath370 grid cells .",
    "observe that both follow the correct asymptotic behavior at large distances , with scatter dominated by boundary effects.,title=\"fig:\",scaledwidth=49.0%]empirical fits ( lines ) to numerical data ( symbols ) for @xmath187 ( left ) and @xmath188 ( right ) , for the 6-point kernel in two dimensions , obtained using a periodic system of either @xmath369 or @xmath370 grid cells .",
    "observe that both follow the correct asymptotic behavior at large distances , with scatter dominated by boundary effects.,title=\"fig:\",scaledwidth=49.0% ]      for @xmath158 , we use a fitting formula in agreement with ( [ eq : f_beta_r_0_2d ] ) , @xmath371 where @xmath372 are coefficients ( obtained by fitting for each kernel data over a range of @xmath50 s ) and @xmath373 is fixed from the inviscid condition ( [ eq : f_0_inviscid ] ) . * * the empirical fit for @xmath329 is shown in fig .",
    "[ fig : f_0_2d ] .",
    "note that for finite @xmath50 , one must ensure that the system size used to tabulate the values of @xmath374 and @xmath375 is sufficiently large , @xmath376 .",
    "empirical fit for @xmath329 as a function of @xmath50 for different vaues of @xmath50 .",
    "( left ) three dimensions , @xmath190 grid .",
    "( right ) [ fig : f_0_2d ] * * two dimensions , @xmath370 grid.,title=\"fig:\",scaledwidth=49.0%]empirical fit for @xmath329 as a function of @xmath50 for different vaues of @xmath50 .",
    "( left ) three dimensions , @xmath190 grid .",
    "( right ) [ fig : f_0_2d ] * * two dimensions , @xmath370 grid.,title=\"fig:\",scaledwidth=49.0% ]    for @xmath324 we introduce normalized functions @xmath331 and @xmath332 via @xmath377 where in the inviscid case we take @xmath334 , and @xmath189 is the normalized distance . for finite @xmath50 , we know that @xmath335 according to ( [ eq : fg_inv_2d ] ) . the numerical data is fitted with the empirical fitting functions @xmath378 as shown in fig .",
    "[ fig : fg_6pt_2d ] . here",
    "@xmath379 are empirical coefficients , computed by fitting numerical dats for @xmath50 in @xmath380 .",
    "intermediate values in the range @xmath381 are interpolated using linear interpolation , and larger @xmath382 s are handled using the steady stokes fit ( [ eq : fg_steady_2d ] ) .",
    "empirical fitting of @xmath383 and @xmath384 in two dimensions for different values of @xmath50 for the 6-point kernel , @xmath370 grid.,title=\"fig:\",scaledwidth=49.0%]empirical fitting of @xmath383 and @xmath384 in two dimensions for different values of @xmath50 for the 6-point kernel , @xmath370 grid.,title=\"fig:\",scaledwidth=49.0% ]",
    "consider steady stokes flow around a rigid shell or sphere of radius @xmath35 , placed in a centered position inside another spherical shell or cavity of radius @xmath385 .",
    "we consider the case when the outer shell is moving with velocity @xmath286 and the inner shell is at rest , and for simplicity set the viscosity to unity , @xmath386 .",
    "brenner @xcite gives the drag force on the inner sphere for no slip boundary conditions as @xmath387 where @xmath388 let us denote the constants @xmath389 the velocity in the region between the two spherical shells can be obtained from the expressions given by brenner as @xmath390    @xmath391    @xmath392 and the pressure is    @xmath393 where @xmath394 since we impose that the pressure have mean zero to remove the null mode for pressure .",
    "in spherical coordinates , with the symmetry axes aligned with the direction of the flow , the traction on the surface of the inner sphere , which is the jump in the stress across the inner shell , is @xmath395 where @xmath396 and @xmath397 .",
    "the local averaging and spreading operators have to be modified near physical boundaries , specifically , when the support of the kernel @xmath150 overlaps with a boundary . a proposal for how to do that has been developed by yeo and maxey @xcite , and an alternative proposal has been developed in the context of the immersed boundary method by griffith _",
    "_ @xcite . here",
    "we have chosen to use the former approach because of its simplicity and the fact that it is independent of the kernel , as well as the fact that it ensures that the interpolated velocity strictly vanishes at a no - slip boundary ; this ensures that the mobility of a marker is a monotonically decreasing function as it approaches a no - slip boundary .",
    "since the description in @xcite is limited to steady stokes flow and a single no - slip boundary , we give here an algebraic formulation that extends to a variety of boundary conditions ; this formulation is implemented in the ibamr library and used in the examples in this paper in non - periodic domains .",
    "the basic idea in the handling spreading and interpolation near boundaries is to use the standard ib kernel functions in a domain extended with sufficiently many ghost cells so that the support of all kernels is strictly within the extended domain . for interpolation , we first fill ghost cells and then interpolate as usual using the ghost cell values . for spreading ,",
    "we take the adjoint operator , which basically means that we first spread to the extended domain including ghost cells in the usual manner , and then we accumulate the value spread to the ghost cell in the corresponding interior grid point , using the _ same _ weight ( coefficient ) that was used when filling ghost cells for the purposes of interpolation .",
    "this process requires a consistent method for filling ghost cells , that is , for extending a ( cell - centered or staggered ) field @xmath398 from the interior to the extended domain . in general",
    ", this will be an affine linear mapping of the form @xmath399 where @xmath400 is an extension matrix and @xmath401 encodes inhomogeneous boundary conditions .",
    "let us denote with @xmath402 the standard ib interpolation operator that interpolates an _ extended _ field at a position inside the interior of the domain .",
    "the interpolated value in the presence of physical boundary conditions is then given by the affine linear mapping @xmath403 the corresponding spreading operation is defined to be the adjoint of @xmath404 for homogeneous boundary conditions , as this ensures energy conservation in the absence of boundary forcing . specifically , we use @xmath405    the specific form of the extension operator @xmath400 used in our implementation is based on linear extrapolation to a given ghost point based on the corresponding value in the interior _ and _ the values at the boundary as specified in the boundary conditions .",
    "specifically , for homogeneous neumann conditions we do a mirror image @xmath406 , while for homogeneous dirichlet boundary conditions , such as no slip boundaries , we simply do a mirror inversion @xmath406 .",
    "this makes our implementation exactly identical to that proposed by yeo and maxey @xcite in the context of the fcm method .",
    "one can think of this approach to no - slip boundaries as taking an inverted mirror image of the portion of the kernel outside of the domain @xcite .",
    "note that the same @xmath400 is used to implement boundary conditions both in the fluid solver and when interpolating / spreading near boundaries ; this greatly simplifies the implementation without lowering the second - order accuracy of the fluid solver @xcite . in our implementation , we use simple transpose for spreading which is the adjoint @xmath407 with respect to the standard inner product .",
    "david  b stein , robert  d guy , and becca thomases . immersed boundary smooth extension :",
    "a high - order method for solving pde on arbitrary smooth domains using fourier spectral methods .",
    ", 304:252274 , 2016 .                        a  ortega , d  amors , and j  garca  de la  torre . prediction of hydrodynamic and other solution properties of rigid proteins from atomic - and residue - level models .",
    ", 101(4):892898 , 2011 .",
    "code available at http://leonardo.inf.um.es/macromol/programs/hydropro/hydropro.htm .",
    "yu  zhang , juan  j de  pablo , and michael  d graham .",
    "an immersed boundary method for brownian dynamics simulation of polymers in complex geometries : application to dna flowing through a nanoslit with embedded nanopits .",
    ", 136:014901 , 2012 .",
    "amneet pal  singh bhalla , rahul bale , boyce  e. griffith , and neelesh  a. patankar .",
    "fully resolved immersed electrohydrodynamics for particle motion , electrolocation , and self - propulsion .",
    ", 256:88  108 , 2014 .",
    "satish balay , william  d. gropp , lois  curfman mcinnes , and barry  f. smith .",
    "efficient management of parallelism in object oriented numerical software libraries . in e.",
    "arge , a.  m. bruaset , and h.  p. langtangen , editors , _ modern software tools in scientific computing _ , pages 163202 .",
    "birkhuser press , 1997 .",
    "software available at http://www.mcs.anl.gov/petsc .",
    "xiaolei yang , xing zhang , zhilin li , and guo - wei he . a smoothing technique for discrete delta functions with application to immersed boundary method in moving boundary simulations . ,",
    "228(20):78217836 , 2009 ."
  ],
  "abstract_text": [
    "<S> we develop an immersed boundary ( ib ) method for modeling flows around fixed or moving rigid bodies that is suitable for a broad range of reynolds numbers , including steady stokes flow . </S>",
    "<S> the spatio - temporal discretization of the fluid equations is based on a standard staggered - grid approach . </S>",
    "<S> fluid - body interaction is handled using peskin s ib method ; however , unlike existing ib approaches to such problems , we do not rely on penalty or fractional - step formulations . </S>",
    "<S> instead , we use an unsplit scheme that ensures the no - slip constraint is enforced exactly in terms of the lagrangian velocity field evaluated at the ib markers . </S>",
    "<S> fractional - step approaches , by contrast , can impose such constraints only approximately , which can lead to penetration of the flow into the body , and are inconsistent for steady stokes flow . imposing no - slip constraints </S>",
    "<S> exactly requires the solution of a large linear system that includes the fluid velocity and pressure as well as lagrange multiplier forces that impose the motion of the body . </S>",
    "<S> the principal contribution of this paper is that it develops an efficient preconditioner for this exactly constrained ib formulation which is based on an analytical approximation to the schur complement . </S>",
    "<S> this approach is enabled by the near translational and rotational invariance of peskin s ib method . </S>",
    "<S> we demonstrate that only a few cycles of a geometric multigrid method for the fluid equations are required in each application of the preconditioner , and we demonstrate robust convergence of the overall krylov solver despite the approximations made in the preconditioner . </S>",
    "<S> we empirically observe that to control the condition number of the coupled linear system while also keeping the rigid structure impermeable to fluid , we need to place the immersed boundary markers at a distance of about two grid spacings , which is significantly larger from what has been recommended in the literature for elastic bodies . </S>",
    "<S> we demonstrate the advantage of our monolithic solver over split solvers by computing the steady state flow through a two - dimensional nozzle at several reynolds numbers . </S>",
    "<S> we apply the method to a number of benchmark problems at zero and finite reynolds numbers , and we demonstrate first - order convergence of the method to several analytical solutions and benchmark computations .    # 1 # 1 # 1    # 1#1 # 1#1    # 1#1 # 1|#1|    # 1#1    v    v    # 1    </S>",
    "<S>  s    l    * * </S>"
  ]
}