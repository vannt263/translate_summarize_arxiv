{
  "article_text": [
    "for an important class of multi - scale problems , a separation of scales exists between the ( microscopic , detailed ) level of description of the available model , and the ( macroscopic , continuum ) level at which one would like to observe the system . consider , for example , a kinetic monte carlo model of bacterial growth @xcite .",
    "a stochastic model describes the probability of an individual bacterium to run or  tumble \" , based on the rotation of its flagellae . technically , it would be possible to evolve the detailed model for all space and time , and observe the macroscopic variables of interest , but this would be prohibitively expensive",
    "it is known , however , that , under certain conditions , one can write a closed deterministic equation for the evolution of the macroscopic observable ( here _ bacteria concentration _ , the zeroth moment of the evolving distribution ) as a function of macroscopic space and time .    the recently proposed _ equation - free framework _",
    "@xcite can then be used instead of stochastic time integration in the entire space - time domain .",
    "this framework is built around the central idea of a _ coarse time - stepper _ , which is a time-@xmath0 map from coarse variables to coarse variables .",
    "it consists of the following steps : ( 1 ) _ lifting _ , i.e.  the creation of _ appropriate _ initial conditions for the microscopic model ; ( 2 ) _ evolution _ , using the microscopic model and ( possibly ) some constraints ; and ( 3 ) _ restriction _ , i.e.  the projection of the detailed solution to the macroscopic  observation \" variables .",
    "this coarse time - stepper can subsequently be used as  input \" for a host time - stepper based algorithms performing macroscopic numerical analysis tasks .",
    "these incude , for example , time - stepper based bifurcation code to perform bifurcation analysis for the _ unavailable _ macroscopic equation @xcite .",
    "a coarse timestepper can also be used in conjunction with a _ projective integration method _ to increase efficiency of time - integration @xcite .",
    "this approach has already been used in several applications @xcite , and also allows to do other system level tasks , such as control and optimzization @xcite .    when dealing with systems that would be described by ( in our case , unavailable )",
    "_ partial _ differential equations , one can also reduce the _ spatial _ complexity . for systems with one space dimension , the _ gap - tooth scheme _",
    "@xcite was proposed ; it can be directly generalized in several space dimensions . a number of small intervals , separated by large gaps ,",
    "are introduced ; they qualitatively correspond to mesh points for a traditional , continuum solution of the unavailable equation . in higher space dimensions",
    ", these intervals would become _ boxes _ around the coarse mesh points , a term that we will also use throughout this paper .",
    "we construct a coarse time-@xmath0 map as follows .",
    "we first choose a number of macroscopic grid points .",
    "then , we choose a small interval around each grid point ; initialize the fine scale , microscopic solver within each interval consistently with the macroscopic initial condition profiles ; and provide each box with appropriate ( as we will see , to some extent artificial ) boundary conditions . here",
    ", we constrain the macroscopic gradient to a value that is determined by the macroscopic solution field .",
    "subsequently , we use the microscopic model in each interval to simulate until time @xmath0 , and obtain macroscopic information ( e.g.  by computing the average density in each box ) at time @xmath0",
    ". this amounts to a coarse time-@xmath0 map ; this procedure is then repeated .",
    "this  coarse \" scheme has been used with lattice - boltzmann simulations of the fitzhugh - nagumo dynamics @xcite and with particle - based simulations of the viscous burgers equation @xcite .",
    "it was analyzed in the case where both the microscopic and the macroscopic model are pure diffusion @xcite , where it was shown to be equivalent to a standard finite difference scheme of order @xmath1 in space , combined with an explicit euler step in time .",
    "here , we extend the analysis for the gap - tooth scheme in several ways . we derive a formulation which approximates difference schemes that have higher order accuracy in space ; and we analyze the convergence of this generalized scheme for a one - dimensional parabolic homogenization problem with non - linear reaction . in this case , the microscopic model is a partial differential equation with rapidly oscillating coefficients .",
    "the macroscopic model is the _ effective _ equation that describes the evolution of the average behaviour . in the limit , when the period of the oscillations becomes zero , this effective equation is the classical homogenized equation .",
    "the goal of the gap - tooth scheme is to approximate the effective equation by using only the microscopic problem inside the small boxes .",
    "we analyze the accuracy of the method analytically for the case where the homogenized solution is close to the effective solution .",
    "this analysis is important , because it shows that the gap - tooth scheme approximates the correct effective equation in the presence of microscopic scales .",
    "it is worth mentioning that many numerical schemes have been devised for the homogenization problem .",
    "hou and wu developed the multi - scale finite element method that uses special basis functions to capture the correct microscopic behaviour @xcite .",
    "schwab , matache and babuska have devised a generalized fem method based on a two - scale finite element space @xcite .",
    "runborg et al .",
    "@xcite proposed a time - stepper based method that obtains the effective behaviour through short bursts of detailed simulations appropriately averaged over many shifted initial conditions .",
    "the simulations were performed over the whole domain , but the notion of effective behaviour is identical .",
    "the guiding principle in equation - free timestepper - based computation is to perform numerical tasks on an _ unavailable _ equation .",
    "the time derivative for the evolution of the field is not obtained from a formula , but estimated from observations of short , appropriately initialized and processed detailed dynamic simulations in ( portions of ) space . when more information about the structure of the unavailable equation is known ( e.g. that it is a conservation law for a known observable )",
    ", it makes sense to modify the general time - stepper based procedure appropriately ; one can , for example , estimate the time derivative based on flux computations using an available microscopic simulator in ( portions of ) space .",
    "this modification of equation - free computations for the case of conservation laws forms the basis of the generalized godunov scheme of e and enguist @xcite and of the finite difference heterogeneous multiscale method of abdulle and e @xcite .",
    "our approach has focused on the general case where the structure of the unavailable equation is not known .",
    "it is interesting to pose the question about how one might know whether a system is effectively a conservation law ( and additional questions , such as whether a system is hamiltonian , or , possibly , integrable ) .",
    "a computer - assisted methodology for the equation - free exploration of such questions is introduced in @xcite .    in the gap - tooth scheme discussed here ,",
    "the microscopic computations are performed without assuming such a form for the `` right - hand - side '' of the unavailable macroscopic equation ; we evolve the detailed model in a subset of the domain , and try to recover macroscopic information by interpolation in space and extrapolation in time .",
    "we note again that the gap - tooth scheme as it is presented here , is only a part of the equation - free solution framework . in this paper",
    "we examine the properties of this coarse time - stepper _ per se _ ; yet one should keep in mind that the coarse time-@xmath0 map will eventually be used inside a projective integration code , or a bifurcation / continuation code .",
    "the combination of gap - tooth timestepping with projective integration has been termed _",
    "patch dynamics _ @xcite .",
    "this paper is organized as follows . in section [ sec : gaptooth ] , we discuss a general order formulation of the gap - tooth scheme . subsequently , in section [ sec:3 ] , we discuss some basic theoretical results on mathematical homogenization , and we give a relation between the averaged solution and the homogenized solution . in section [ sec : convergence ] , we analyze the convergence of our method for the model homogenization problem .",
    "numerical results confirming the theorem are shown in section [ sec : numerical_results ] .",
    "this section also contains some examples for which the theory is strictly speaking not valid .",
    "we discuss a modified version of the gap - tooth scheme in section [ sec : dispersion ] that avoids constraining the macroscopic gradient during simulation .",
    "we introduce so - called _ buffer _ regions that shield the dynamics inside each box from boundary effects . at the outer boundary of the buffer box",
    ", one can subsequently apply _ whatever boundary conditions the microscopic code allows_. we propose to study the resulting scheme by the ( equation - free ) numerical computation of its damping factors .",
    "we show how this can be done for a diffusion problem with dirichlet boundary conditions .",
    "we conclude in section [ sec : conclusions ] , where we also point out some next steps of this research .",
    "we consider a general reaction - convection - diffusion equation with a dependence on a small parameter @xmath2 , @xmath3 with initial condition @xmath4 and dirichlet boundary conditions @xmath5 and @xmath6 .",
    "we further assume that @xmath7 is @xmath8-periodic in @xmath9 .",
    "we are only interested in the macroscopic ( averaged ) behavior @xmath10 , which is a `` filtered '' version of @xmath11 . to this end",
    ", we define an averaging operator for @xmath11 as follows , @xmath12 this operator replaces the unknown function by its local average in a small box of size @xmath13 around each point .",
    "if @xmath14 is sufficiently small , @xmath15 should be a reasonable approximation to @xmath10 .    the averaged solution @xmath15 satisfies an ( unknown ) evolution law , which we assume also diffusive , @xmath16 note that this equation depends on the box width @xmath14 .",
    "the goal of the gap - tooth scheme is to approximate the solution @xmath15 , while only making use of the detailed model ( [ eq : general_homogenization_problem ] ) .",
    "suppose we want to obtain the solution of the _ unknown _ equation on the interval @xmath17 $ ] , using an equidistant macroscopic mesh @xmath18 .",
    "we construct a time @xmath0-map for @xmath15 in the following way .",
    "we consider a small box ( _ tooth _ ) of length @xmath19 centered around each mesh point , and solve the original problem in each box . to determine the simulation within each box completely , we impose boundary constraints and an initial condition as follows .",
    "[ [ boundary - constraints . ] ] boundary constraints .",
    "+ + + + + + + + + + + + + + + + + + + + +    each box should provide information on the evolution of the global problem at that location in space .",
    "it is therefore crucial that the ( artificially imposed ) boundary conditions are chosen to emulate the correct behaviour in a larger domain . since the microscopic model ( [ eq : general_homogenization_problem ] ) is diffusive , it makes sense ( thinking of traditional explicit numerical schemes ) to impose a fixed macroscopic concentration gradient at the boundary of each small box during a time interval of length @xmath0 .",
    "we determine the value of this gradient by an approximation of the macroscopic concentration profile @xmath10 by a polynomial , based on the ( given ) box averages @xmath20 , @xmath21 .",
    "@xmath22,\\ ] ] where @xmath23 denotes a polynomial of ( even ) degree @xmath24 .",
    "we require that the approximating polynomial has the same box averages as the initial condition in box @xmath25 and in @xmath26 boxes to the left and to the right .",
    "this gives us @xmath27 one can easily check that @xmath28 where @xmath29 denotes a lagrange polynomial of degree @xmath24 .",
    "the derivative of this approximating polynomial is subsequently used to obtain the value of the gradient at the boundary of the box .",
    "@xmath30    if we did have an equation for the macroscopic behaviour , we would use these slopes as neumann boundary conditions . here",
    ", we use these derivatives to constrain the _ average _ gradient of the detailed solution @xmath10 in box @xmath25 over one small - scale period around the end points , @xmath31    note that we approximate a box average in a box of macroscopic size @xmath32 , while we average for boundary condition purposes over a length scale @xmath2 that is characteristic for the microscopic model .",
    "hence , we replace each boundary condition and its effect on the simulation by an algebraic constraint .",
    "[ [ initial - conditions . ] ] initial conditions .",
    "+ + + + + + + + + + + + + + + + + + +    for the time integration , we must impose an initial condition @xmath33 in each box @xmath34 $ ] , at time @xmath35 .",
    "we require @xmath33 to satisfy the boundary conditions and the given box average .",
    "we choose a quadratic polynomial @xmath36 , centered around the coarse mesh point @xmath37 , @xmath38 using the constraints in the limit for @xmath39 and requiring @xmath40 we obtain @xmath41    [ [ the - algorithm . ] ] the algorithm . + + + + + + + + + + + + + +    the complete _ gap - tooth _",
    "algorithm to proceed from @xmath42 to @xmath43 is given below ( see also figure [ fig : schematic ] ) :    1",
    ".   * lifting . * at time @xmath35 , construct the initial condition @xmath33 , @xmath44 , using the box averages @xmath45 ( @xmath46 ) as defined in ( [ eq : lifting ] ) .",
    "* evolution .",
    "* compute @xmath47 by solving the equation ( [ eq : general_homogenization_problem ] ) until time @xmath48 with the boundary constraints ( [ eq : bc ] ) .",
    "* restriction . *",
    "compute the box average @xmath49 at time @xmath50 .     a schematic representation of a gap - tooth time - step .",
    "we choose a number of boxes of size @xmath14 around each macroscopic mesh point @xmath37 and interpolate the initial averages ( dots ) in a number of boxes around @xmath37 ( dashed profile ) .",
    "the derivatives at the boundary and the average are used to create an initial profile in box @xmath25 ( full line ) . ]",
    "it is clear that this amounts to a `` coarse - to - coarse '' time-@xmath51 map .",
    "we write this map as follows , @xmath52 where @xmath53 represents the numerical time - stepping scheme for the macroscopic ( coarse ) variables and @xmath24 denotes the degree of interpolation .",
    "[ [ microscopic - simulators . ] ] microscopic simulators .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    it is possible that the microscopic model is not a partial differential equation , but some microscopic simulator , e.g.  kinetic monte carlo or molecular dynamics code .",
    "in fact , this is the case where our method would be most useful . in this case ,",
    "several complications arise .",
    "first of all , the choice of the box width @xmath14 becomes important , since there will generally exist a trade - off between statistical accuracy ( e.g.  enough sampled particles ) and spatial resolution .",
    "second , the _ lifting _ step , i.e.  the construction of box initial conditions , also becomes more involved .",
    "in general , the microscopic model will have many more degrees of freedom , the _ higher order moments _ of the evolving distribution .",
    "these will quickly become slaved to the governing moments ( the ones where the lifting is conditioned upon ) , see e.g.  @xcite , but it might be better to do a constrained run before initialization to create mature initial conditions @xcite .",
    "third , as already mentioned , imposing macroscopically inspired boundary conditions is non - trivial @xcite . moreover",
    "a given microscopic code may come with one of several _  standard \" _ microscopic boundary conditions .",
    "we will therefore examine the effect of incorporating simulations with such standard boundary conditions in a gap - tooth context , provided we extend the simulation in a buffer region surrounding the computational  tooth \" .",
    "the solution in the buffer is not used in the restriction step .",
    "this variant is examined more closely in section [ sec : dispersion ] .",
    "finally , even determining which and how many macroscopically inspired boundary conditions are needed , is a delicate issue .",
    "this is related with the order of the partial differential equation , i.e.  the order of the highest spatial derivative . a systematic way to estimate this , without having the macroscopic equation , is given in @xcite .",
    "here , we review some basic results from homogenization theory .",
    "we note that we are interested in finding the _ effective _ behaviour of the solution . in our setup , we know that for sufficiently small @xmath2 the effective behaviour is close to the _ homogenized _ behaviour , which is the limit of the solution for @xmath54 . since in some cases , the homogenized equation can be found analytically , we use this equation as our reference for the effective behaviour .      as a model problem",
    ", we consider the following parabolic partial differential equation , @xmath55 with initial condition @xmath56 and suitable boundary conditions . in this equation",
    ", @xmath57 is periodic in @xmath58 and @xmath2 is a small parameter .",
    "consider equation with dirichlet boundary conditions @xmath59 and @xmath6 . according to classical homogenization theory @xcite , the solution to",
    "can be written as an asymptotic expansion in @xmath2 , @xmath60 where the functions @xmath61 , @xmath62 are periodic in @xmath58 . here , @xmath63 is the solution of the _ homogenized equation _",
    "@xmath64 with initial condition @xmath65 and dirichlet boundary conditions @xmath66 and @xmath67 ; @xmath68 is the constant effective coefficient , given by @xmath69 and @xmath70 is the periodic solution of @xmath71 the so - called _",
    "cell problem_. the solution of is only defined up to an additive constant , so we impose the extra condition @xmath72 from this cell problem , we can derive @xmath73 .",
    "these asymptotic expansions have been rigorously justified in the classical book @xcite . under appropriate smoothness assumptions ,",
    "one can obtain pointwise convergence of @xmath74 to @xmath75 as @xmath39 .",
    "therefore , we can write @xmath76 where @xmath77 denotes the @xmath78-norm of @xmath7 . throughout this text , whenever we use @xmath79 , we mean the @xmath78-norm .    it is important to note that the gradient of @xmath10 is given by @xmath80 from which it is clear that the micro - scale fluctuations have a strong effect on the local detailed gradient . nevertheless , since @xmath81 are periodic in @xmath58 , the gradient of the homogenized solution can be approximated by the averaged gradient over one period @xmath2 of the medium .",
    "the error is bounded by @xmath82      the gap - tooth scheme introduces an approximation on two levels .",
    "the scheme computes an approximation to the evolution of the averaged macroscopic quantities instead of an approximation to the solution of the true homogenized solution . before considering",
    "how well the gap - tooth scheme approximates this averaged behaviour , it might be of interest to show how the averaged behaviour approximates the homogenized solution .",
    "[ lem : asymptotic_expansion_of_averages ] for @xmath10 sufficiently smooth , the averaged function @xmath83 can be asymptotically expanded in @xmath14 as follows , @xmath84    we omit the proof , but this can easily be checked using maple .    using this lemma",
    ", we consider the homogenization problem of section [ sec : homogenization ] , @xmath85 in this case , we can bound the difference between the averaged solution @xmath15 and the homogenized solution @xmath63 in the following way .",
    "[ lem : averaging_error ] the difference between the homogenized solution @xmath63 and the averaged solution @xmath86 is bounded by @xmath87    we first make use of the asymptotic expansion for @xmath10 and the triangle inequality , and subsequently of lemma [ lem : asymptotic_expansion_of_averages ] .",
    "@xmath88}\\left|\\frac{\\partial^2}{\\partial   x^2}u_0(x , t)\\right|+c_2\\epsilon\\end{aligned}\\ ] ] this concludes the proof .",
    "this shows that the averaged solution is a good approximation of the homogenized solution for sufficiently small box width @xmath14 .",
    "to analyze the convergence of the gap - tooth scheme , we solve the detailed problem approximately in each box . because @xmath13 , we can resort to the homogenized solution , and bound the error using equation .",
    "it is important to note that we only use the homogenized equation for analysis purposes .",
    "we never make use of the homogenized equation in the implementation .",
    "we first relate the gap - tooth time - stepper as constructed in section [ sec : gaptooth ] with a gap - tooth time - stepper for which the box problem is the homogenized equation with neumann boundary conditions .",
    "[ lem : equivalent_box_problem ] consider the model equation , @xmath89 where @xmath57 is periodic in @xmath58 and @xmath2 is a small parameter , with initial condition @xmath56 and boundary constraints @xmath90 for @xmath54 , this problem converges to the homogenized problem @xmath91 with initial condition @xmath65 and neumann boundary conditions @xmath92 and the solution of - converges pointwise to the solution of - , with the following error estimate @xmath93    this lemma can be checked using the two - scale convergence method @xcite or formally by making use of asymptotic expansions @xcite .    using this lemma",
    ", we now estimate the difference between a gap - tooth time - step using ( [ eq : model_eq_repeated]-[eq : bc_r ] ) and a gap - tooth time - step using the homogenized box problem ( [ eq : h_r]-[eq : h_bc_r ] ) .",
    "define @xmath94 as one gap - tooth time - step on the full problem with the box constraints , and @xmath95 as one gap - tooth time - step on the homogenized problem with boundary conditions .",
    "when @xmath96 , we have @xmath97    denote the solutions of - and - , with the initial condition @xmath98 determined by the lifting step , - as @xmath99 resp .  @xmath100 .",
    "we can then write @xmath101 } \\left\\|\\tilde{u}_{\\epsilon}(\\xi , t_{n+1})-\\tilde{u}_0^i(\\xi , t_{n+1})\\right\\| \\\\ & \\le&c_3 \\epsilon\\end{aligned}\\ ] ] here , we bounded the average over the interval @xmath34 $ ] by the maximum , and subsequently used lemma [ lem : equivalent_box_problem ] .",
    "this is valid since we assumed @xmath96 .",
    "therefore , the initial condition for both box problems is the same .",
    "this proves the lemma .    the averaged solution @xmath15 satisfies a reaction - diffusion - like equation @xmath102 we denote a forward euler / spatial finite difference approximation for ( [ eq : avg_eq ] ) as @xmath103 with @xmath24 the order of accuracy of the spatial finite differences .",
    "the following theorem compares a gap - tooth time - step @xmath95 with a finite difference time - step .",
    "[ thm : gaptooth_timestep ] we denote a finite difference approximation of order @xmath24 for the evolution of @xmath15 as @xmath103 and one gap - tooth time - step with homogenized box problems ( [ eq : h_r]-[eq : h_bc_r ] ) as @xmath95 .",
    "the exact solution of the homogenized equation is denoted by @xmath10 .",
    "when @xmath104 , we have the following estimate @xmath105    denote the solution - with the initial condition @xmath106 , determined by the lifting step - , as @xmath100 .",
    "* we write an expansion for the solution of - using the method of separation of variables .",
    "the solution can be decomposed as follows @xmath107 where @xmath108 is the solution of @xmath109 with homogeneous initial condition and homogeneous neumann boundary conditions .",
    "the last term is due to the spatial derivatives of the initial profile .",
    "we write @xmath108 as a fourier series with time - dependent coefficients , @xmath110 with @xmath111 and @xmath112 .",
    "the fourier modes satisfy the homogeneous neumann boundary conditions , and form a set of spatial basis functions for the solution .",
    "the time - dependent coefficients are given by @xmath113 each coefficient can be found by solving an ordinary differential equation that is obtained by taking the time derivative and replacing the time derivative of the solution by the right - hand side of the partial differential equation . *",
    "we use this analytical solution to obtain an explicit formula for one time - step of the gap - tooth scheme .",
    "we write @xmath114 where the last step is due to the definition of @xmath115 and the zero averages of sine and cosine .",
    "thus , we only need to consider the coefficient @xmath116 in what follows . * for @xmath117 , we get the following ordinary differential equation @xmath118 with initial condition @xmath119 .",
    "this yields @xmath120 where we could discard the first term because of the boundary conditions .",
    "+ the resulting formula for a gap - tooth time - step is @xmath121 * we now wish to connect one time - step of the gap - tooth scheme with one finite difference time - step for the equation for the averaged solution @xmath15 .",
    "we first notice that @xmath122 therefore , the second derivative of the @xmath24-th order polynomial that interpolates the box averages is equal to @xmath123 . due to symmetry , the first and second derivatives of this polynomial in @xmath37 are the standard finite difference approximation of order @xmath24 of the function @xmath124 .",
    "this can easily be verified with maple .",
    "this leads to the following formula for one finite difference time - step of the equation for the averages @xmath125 where @xmath126 with @xmath10 the exact solution of ( [ eq : hom_eq ] ) .",
    "* we now estimate @xmath127 the first term can be written as @xmath128 where we used a taylor expansion for @xmath129 and the chain rule .",
    "the second term is estimated as @xmath130 where we used lipschitz continuity of @xmath129 and the fact that ( due to lifting ) @xmath131 this proves the lemma .",
    "we now have the following result .",
    "[ thm : truncation_error ] define @xmath132 as the result of one gap - tooth time - step for ( [ eq : model_equation ] ) , and @xmath133 as a finite difference time - step for ( [ eq : avg_eq ] ) .",
    "when @xmath134 ( the exact solution at @xmath135 ) , the difference is bounded by @xmath136    this follows immediately by combining lemmas [ lem : equivalent_box_problem ] and [ thm : gaptooth_timestep ] .",
    "therefore , we obtain the following error bound .    if @xmath133 is a stable finite difference scheme for ( [ eq : avg_eq ] ) , then @xmath132 .",
    "moreover , if @xmath137 , the error with respect to the homogenized solution @xmath63 of ( [ eq : hom_eq ] ) is bounded by @xmath138    we start by splitting the error , based on the origin of the error contributions , @xmath139 the last two terms follow from standard finite difference theory and from lemma [ lem : asymptotic_expansion_of_averages ] .",
    "the first term merits further investigation , @xmath140 where the last line is due to lemma [ thm : truncation_error ] and @xmath141 is the error amplification matrix for the forward euler / spatial finite difference scheme .",
    "therefore , stability of the finite difference scheme is necessary and sufficient to bound the errors from previous steps . by induction , we obtain @xmath142 we prove the theorem by combining all terms .",
    "the result clearly shows the interplay between the different approximations ; we have an error due to the ( macroscopic ) finite difference scheme , an error that arises because we consider box averages , and an extra error due to the setup of the box problems in each time - step .",
    "the introduction of averaged neumann boundary conditions generates an error which is independent of the time - step .",
    "we therefore have to make a trade - off between the accuracy that is gained by taking shorter time - steps and the accuracy that is lost because of more frequent reinitializations .",
    "this will also be shown in the numerical experiments .",
    "projective integration @xcite can help in reducing this error , since then less re - initializations are needed .",
    "we show convergence of the gap - tooth method for a diffusion problem with a rapidly oscillating diffusion coefficient ( section [ sec:5.1 ] ) , a reaction - diffusion system ( section [ sec:5.2 ] ) , and a system with a rough non - periodic ( random ) diffusion coefficient ( section [ sec:5.3 ] ) .      consider the following model problem , @xmath143 with @xmath144 , @xmath145 $ ] , initial conditions @xmath146 , and dirichlet boundary conditions @xmath147 . to solve the microscopic problem",
    ", we use a standard finite difference discretization in space and an implicit euler time - step , with parameters @xmath148 and @xmath149 .",
    "the corresponding homogenized equation is given by @xmath150 with respect to the theoretical setup of section [ sec : convergence ] , two additional approximations are made during the computations : the time integration inside each box is not exact ; and we have to use numerical quadrature formulas to obtain the box average at each restriction .",
    "the resolution of the internal time - stepper is such that these effects are negligible with respect to the other sources of error that we wish to study . in our code , we used the trapezoidal rule as quadrature formula .",
    "figure [ fig : solution_diff ] shows the solution of ( [ eq : ex1_fine ] ) and the gap - tooth solution with @xmath151 , @xmath152 and @xmath153 at time @xmath154 .    [ [ difference - with - respect - to - finite - differences . ] ] difference with respect to finite differences .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we first compare the results of the gap - tooth scheme for ( [ eq : ex1_fine ] ) with those of a finite difference scheme for ( [ eq : ex1_coarse ] ) with the same coarse parameters .",
    "we use a spatial interpolation / finite differences of order @xmath155 , with a coarse mesh of @xmath151 , resp .",
    "@xmath156 , for decreasing box sizes @xmath157 , @xmath158 , @xmath159 , @xmath160 , and for time - steps @xmath161 , with @xmath162 , @xmath163 , @xmath164 .",
    "the results are shown in table [ tab : diff - fd - gt-1 ] for @xmath151 and in table [ tab : diff - fd - gt-2 ] for @xmath165 .",
    "they clearly show an @xmath166 decrease of the error initially , with a slow - down for smaller @xmath14 , due to the additional @xmath167 term .",
    "we also see that the decrease of convergence speed is affected by the time - step .",
    "the error decreases less rapidly for smaller @xmath168 , due to the additional error in each restriction step . also note a smaller decrease for @xmath156 , because in this case @xmath0 is also smaller .",
    "note that the difference with respect to finite differences does not depend dramatically on @xmath0 for this example , due to the absence of a reaction term ( see theorem [ thm : truncation_error ] ) . by comparing tables [ tab : diff - fd - gt-1 ] and [ tab : diff - fd - gt-2 ]",
    ", we also see that the difference between the gap - tooth scheme and the finite difference scheme is independent of @xmath169 , for fixed @xmath14 and @xmath168 .",
    ".difference between the gap - tooth scheme for ( [ eq : ex1_fine ] ) and a finite difference scheme for ( [ eq : ex1_coarse ] ) for order @xmath155 and @xmath151 at time @xmath170.[tab : diff - fd - gt-1 ] [ cols= \" < , > , > , > , > , > , > \" , ]     we see that the error decreases when more boxes are inserted .",
    "note that , due to the roughness of the signal , it is difficult to draw conclusions on the convergence rate , and to determine good parameter values for the gap - tooth scheme .",
    "e.g.  the length over which the gradient is averaged at the end points of each box is no longer uniquely defined , since the small scale @xmath2 is only a correlation length .",
    "we recall that the gap - tooth scheme , as presented above , performs the simulations inside each box using an algebraic constraint , ensuring that the initial macroscopic gradient is preserved at the boundary of each box over the time - step @xmath0 .",
    "if our goal is to accelerate time - integration using an existing microscopic code , this constraint may require us to alter this code , so as to impose this macroscopically - inspired constraint .",
    "this may be impractical ( e.g.  if the macroscopic gradient has to be estimated ) , undesirable ( e.g.  if the development of the code is expensive and time - consuming ) or even impossible ( e.g.  if the microscopic code is a _ legacy code _ ) .",
    "generally , a given microscopic code allows us to run with a set of pre - defined boundary conditions .",
    "it is highly non - trivial to impose macroscopically inspired boundary conditions on such microscopic codes , see e.g.  @xcite for a control - based strategy .",
    "this can be circumvented by introducing buffer regions at the boundary of each small box , which shield the dynamics within the computational domain of interest from boundary effects during a short time interval .",
    "one then uses the microscopic code with its _ built - in _ boundary conditions @xcite .",
    "we note that , for a correct simulation , the only crucial issue is that the detailed system in each box should evolve _ as if it were embedded in a larger domain_. this can be effectively accomplished by introducing a larger box of size @xmath171 around each macroscopic mesh point , but still only use ( for macro - purposes ) the evolution over the smaller ,  inner \" box .",
    "this is illustrated in figure [ fig : schematic_buffer ] .",
    "lifting and evolution ( using _ arbitrary _ outer boundary conditions ) are performed in the larger box ; yet the restriction is done by taking the average of the solution over the inner , small box .",
    "the goal of the additional computational domains , the _ buffers _ , is to buffer the solution inside the small box from outer boundary effects . this can be accomplished over _ short enough _ times , provided the buffers are _ large enough _ ; analyzing the method is tantamount to making these statements quantitative .",
    "the idea of using a buffer region was also used in the multi - scale finite element method ( oversampling ) of hou @xcite to eliminate the boundary layer effect ; also hadjiconstantinou makes use of overlap regions to couple a particle simulator with a continuum code @xcite . if the microscopic code allows a choice of different types of ",
    "outer \" microscopic boundary conditions , selecting the size of the buffer may also depend on this choice .    a schematic representation of the gap - tooth scheme with buffer boxes .",
    "the simulation is done in the box of size @xmath172 , whereas for restriction , only information inside the inner box of size @xmath14 is used . ]      here , we show that we can study the gap - tooth scheme ( with buffers ) through its numerically obtained damping factors , i.e.  by estimating the eigenvalues of its linearization .",
    "integration with nearby coarse initial conditions is used to estimate matrix - vector products of the linearization of the coarse time-@xmath0 map with known perturbation vectors ; these are integrated in matrix - free iterative methods such as arnoldi eigensolvers . for the diffusion homogenization problem ( [ eq : ex1_fine ] ) , we show that the eigenvalues of the gap - tooth scheme are approximately the same as those of the corresponding finite difference scheme for ( [ eq : ex1_coarse ] ) . when we impose dirichlet boundary conditions at the boundary of the buffers , we show that the scheme converges to the standard gap - tooth scheme for increasing buffer size .",
    "convergence results are typically established by proving consistency and stability .",
    "if one can prove that the error in each time step can be made arbitrarily small by refining the spatial and temporal mesh size , and that an error made at time @xmath35 does not get amplified in future time - steps , one has proved convergence .",
    "this requires the solution operator to be stable as well . in the absence of explicit formulas",
    ", one can examine the damping factors of the time - stepper .",
    "if , for decreasing mesh sizes , all ( finitely many ) eigenvalues and eigenfunctions of the time - stepper converge to the dominant eigenvalues and eigenfunctions of the time evolution operator , one expects the solution of the scheme to converge to the true solution of the evolution problem .",
    "consider equation ( [ eq : ex1_coarse ] ) with dirichlet boundary conditions @xmath173 and @xmath174 , and denote its solution at time @xmath175 by the time evolution operator @xmath176 we know that @xmath177 therefore , if we consider the time evolution operator over a fixed time @xmath178 , @xmath179 , then this operator has eigenfunctions @xmath180 , with resp .",
    "eigenvalues @xmath181 a good ( finite difference ) scheme approximates well all eigenvalues whose eigenfunctions can be represented on the given mesh .",
    "we choose @xmath178 as a multiple of @xmath0 for convenience .",
    "since the operator defined in ( [ eq : evolution_operator ] ) is linear , the numerical time integration is equivalent to a matrix - vector product .",
    "therefore , we can compute the eigenvalues using matrix - free linear algebra techniques , even for the gap - tooth scheme , for which it might not even be possible to obtain a closed expression for the matrix . note",
    "that this idea is general ; here we use it as a tool to study the effect of the buffer size on convergence of the gap - tooth scheme .",
    "however , although this analysis gives us an indication about the quality of the scheme , it is by no means a proof of convergence .",
    "we illustrate this idea by computing the eigenvalues of the gap - tooth scheme of order @xmath155 , applied to ( [ eq : ex1_fine ] ) . in this case , we know from section [ sec : convergence ] that these eigenvalues should approximate the eigenvalues of a finite difference scheme on the same mesh . as method parameters , we choose @xmath156 , @xmath182 , @xmath183 for a time horizon @xmath184 , which corresponds to 16 gap - tooth steps . inside each box",
    ", we use a finite difference scheme of order @xmath1 with @xmath148 and an implicit euler time - step of @xmath185 .",
    "we compare these eigenvalues to those of the finite difference scheme with @xmath156 and @xmath183 , and with the dominant eigenvalues of the reference solution ( a finite difference approximation with @xmath186 , @xmath187 and implicit euler time - stepping ) .",
    "the result is shown in figure [ fig : eigval_neu ] .",
    "we now introduce a buffer region of size @xmath172 , and we impose dirichlet boundary conditions at the outer boundary of the buffer region . lifting is done in identically the same way as for the gap - tooth scheme without buffers ; we only use ( [ eq : lifting ] ) as the initial condition in the larger box @xmath188 $ ] .",
    "we compare the eigenvalues again with the equivalent finite difference scheme and the exact solution , for increasing sizes of the buffer box @xmath172 .",
    "figure [ fig : eigval_dir ] shows that , as @xmath172 increases , the eigenvalues of the scheme converge to those of the original gap - tooth scheme .",
    "we see that , in this case , we would need a buffer of size @xmath189 , i.e.  80% of the original domain , for a good approximation of the damping factors .",
    "it is possible to decrease the buffer size by decreasing @xmath0 , which results in more re - initializations .",
    "we described the gap - tooth scheme for the numerical simulation of multi - scale problems .",
    "this scheme simulates the macroscopic behaviour over a macroscopic domain when only a microscopic model is explicitly available .",
    "we analyzed the convergence of this scheme for a parabolic homogenization problem with non - linear reaction .",
    "we showed that our method approximates a finite difference scheme of arbitrary ( even ) order for the homogenized equation when we appropriately constrain the microscopic problem in the boxes , and illustrated this theoretical result with numerical tests on several model problems .",
    "our analysis revealed that the presence of microscopic scales , combined with the requirement that the macroscopic gradient does not change over one gap - tooth time - step @xmath0 , introduces an error term that grows with decreasing @xmath0 , which is not optimal .",
    "we also demonstrated that it is possible to obtain a convergent scheme without constraining the microscopic code , by introducing buffers that _ shield _ over relatively short time intervals the dynamics inside each box from boundary effects .",
    "it is possible , even without analytic formulas , to study the properties of the gap - tooth scheme and generalizations through the damping factors of the resulting coarse time-@xmath0 map . in a forthcoming paper",
    ", we will use these damping factors to study the the trade - off between the effort required to impose a particular type of boundary conditions and the efficiency gain due to smaller buffer sizes and/or longer possible time - steps before reinitialization .",
    "the time - stepper as constructed in this paper will allow us to perform simulations of the effective behaviour of a microscopic system over macroscopic space and macroscopic time ( when combined with projective integration ) , or to perform tasks as bifurcation analysis or coarse control ( when coupled to time - stepper based bifurcation codes ) .",
    "the authors thank sabine attinger and petros koumoutsakos for organizing the summer school in multi - scale modeling and simulation in lugano , and the participants for many fruitful discussions .",
    "giovanni samaey is a research assistant of the fund for scientific research - flanders .",
    "this work has been partially supported by grant iuap / v/22 and by the fund of scientific research through research project g.0130.03 ( gs , dr ) , and an nsf / itr grant and afosr dynamics and control , dr . b. king ( igk ) .                  c.w .",
    "gear and i.g .",
    "projective methods for stiff differential equations : problems with gaps in their eigenvalue spectrum . , 24(4):10911106 , 2003 . can be obtained as nec report 2001 - 029 , ` http://www.neci.nj.nec.com/homepages/cwg/projective.pdf ` .",
    "g.  hummer and i.g .",
    "coarse molecular dynamics of a peptide fragment : free energy , kinetics and long - time dynamics computations . , 118(23):1076210773 , 2003 . can be obtained as physics/0212108 at arxiv.org .",
    "i.g . kevrekidis .",
    "coarse bifurcation studies of alternative microscopic / hybrid simulators . plenary lecture , cast division , aiche annual meeting , los angeles , 2000 .",
    "slides can be obtained from ` http://arnold.princeton.edu/~yannis/ ` .",
    "kevrekidis , c.w .",
    "gear , j.m .",
    "hyman , p.g .",
    "kevrekidis , o.  runborg , and c.  theodoropoulos .",
    "equation - free multiscale computation : enabling microscopic simulators to perform system - level tasks . , 2002 . in press . can be obtained as physics/0209043 from arxiv.org .",
    "makeev , d.  maroudas , a.z .",
    "panagiotopoulos , and i.g . kevrekidis .",
    "coarse bifurcation analysis of kinetic monte carlo simulations : a lattice - gas model with lateral interactions .",
    "117(18):82298240 , 2002 .              c.i .",
    "siettos , a.  armaou , a.g .",
    "makeev , and i.g .",
    "microscopic / stochastic timesteppers and coarse control : a kinetic monte carlo example . , 49(7):19221926 , 2003 . can be obtained as nlin.cg/0207017 at arxiv.org .",
    "siettos , m.d .",
    "graham , and i.g . kevrekidis .",
    "coarse brownian dynamics for nematic liquid crystals : bifurcation , projective integration and control via stochastic simulation . can be obtained as cond - mat/0211455 at arxiv.org , 2003 .      c.  theodoropoulos , k.  sankaranarayanan , s.  sundaresan , and i.g .",
    "coarse bifurcation studies of bubble flow lattice - boltzmann simulations . , 2003 .",
    "can be obtained as nlin.ps/0111040 from arxiv.org ."
  ],
  "abstract_text": [
    "<S> an important class of problems exhibits smooth behaviour in space and time on a macroscopic scale , while only a microscopic evolution law is known . for such time - dependent multi - scale problems , </S>",
    "<S> an `` equation - free framework '' has been proposed , of which the gap - tooth scheme is an essential component . </S>",
    "<S> the gap - tooth scheme is designed to approximate a time - stepper for an unavailable macroscopic equation in a macroscopic domain ; it uses appropriately initialized simulations of the available microscopic model in a number of small boxes , which cover only a fraction of the domain . </S>",
    "<S> we analyze the convergence of this scheme for a parabolic homogenization problem with non - linear reaction . in this case , the microscopic model is a partial differential equation with rapidly oscillating coefficients , while the unknown macroscopic model is approximated by the homogenized equation . we show that our method approximates a finite difference scheme of arbitrary ( even ) order for the homogenized equation when we appropriately constrain the microscopic problem in the boxes . </S>",
    "<S> we illustrate this theoretical result with numerical tests on several model problems . </S>",
    "<S> we also demonstrate that it is possible to obtain a convergent scheme without constraining the microscopic code , by introducing buffer regions around the computational boxes . </S>"
  ]
}