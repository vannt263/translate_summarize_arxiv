{
  "article_text": [
    "the pierre auger southern observatory in the province of mendoza , argentina in the vicinity of malarge measures ultra - high energy cosmic rays by an array of 1600 water - cherenkov tanks ( sd ) and 24 fluorescence telescopes ( fd ) .",
    "it combines the surface and the fluorescence detection techniques in a hybrid design for minimal systematic errors and optimum energy and angular resolution .    already during construction",
    "the auger collaboration measured the energy spectrum , the arrival direction , and the mass composition of cosmic rays above @xmath0ev with high statistical significance .",
    "recently published results @xcite shed first light on the astrophysical important questions of possible sources , the energy spectrum and gzk - cutoff .    in the following sections the trigger system of the fluorescence telescopes is described in general with a particular focus on the software - implemented third level trigger ( tlt ) as part of a multi - level trigger system .",
    "we specify the selection criteria ( cuts ) for efficient background rejection and measure the figure of merit of this new implementation .",
    "the 24 fd telescopes are located in four fd stations around the perimeter of the 3000km@xmath1 large sd array .",
    "they are designed to measure the fluorescence produced by secondary cosmic ray particles due to their interaction with @xmath2 molecules in the air .",
    "each fd station comprises 6 telescopes with a schmidt optical system that covers a @xmath3 azimuth times @xmath4 elevation field of view .",
    "fluorescence light falls through a 2.2 m wide aperture with an uv transmitting filter and a corrector lens annulus on a spherical mirror and is focused on a photomultiplier camera @xcite .",
    "the 440 camera pixels consist of hexagonal pmts ( type xp3062 ) arranged in a matrix of 22 rows and 20 columns .",
    "the required high sensitivity of the pmt to single photons constrains the telescope operation to clear nights with dim moonlight . for safety reasons",
    "the stations are therefore equipped with a sophisticated slow control system which allows remote operation of all fd buildings from the central campus ( cdas ) in malarge via a telecommunication network .",
    "the pmt signals are fed to 20 front - end boards hosted in a 19  sub - rack .",
    "each board processes the signals of 22 pixels of a single camera column . after analogue filtering and",
    "gain control at the first level trigger ( flt ) board the signals are digitized with 12-bit resolution and 10 mhz sampling rate .",
    "the digital data are continuously stored in a @xmath5 16-bit memory per pixel , which is organized in 64 ring - buffers of 1000 words each .",
    "if the following trigger stage finds a fluorescence light track in the camera image , the data recording continues after a post - trigger delay of @xmath6 with the next available ring - buffer .",
    "otherwise , the current ring - buffer data is overwritten after @xmath7 .",
    "while adc values are stored in memory , the running sum of the last 10 samples is calculated to smooth the random fluctuations of the sky background .",
    "if the running sum exceeds an adjustable threshold the corresponding pixel is marked as triggered for a @xmath8 coincidence time .",
    "the rate of triggered pixels is measured and kept constant around 100hz by regulating the individual thresholds . with this robust regulation scheme",
    "we prevent increasing random trigger rates despite slowly changing background light intensities during the night .",
    "while the flt trigger selects pixels seeing light levels above the common night sky background , we have implemented a further stage in hardware identifying tracks of triggered pixels in the camera image . for that purpose and for the readout of the data the sub - rack",
    "is equipped with one second level trigger ( slt ) board .",
    "it reads the triggered pixels from the flt to construct an image of the camera in its memory . within this image",
    "the slt logic scans for small track segments of 5 adjacent pixels showing the patterns in fig .",
    "[ fig : pattern ] by using highly parallel , pipelined pattern recognition logic @xcite . in total , 37163 different combinations of pixels are checked every microsecond .",
    "if at least 4 out of 5 pixels forming a pattern have triggered within a @xmath9 long coincidence time , the recorded data are kept as event .",
    "different event types pass the first two hardware trigger levels .",
    "on the one hand there are extensive air showers we want to measure ( s.  fig .",
    "[ fig : example_shower]a ) , on the other hand different types of background events .",
    "a small fraction of the background consists of random triggers of few noisy pixels without temporal sequence ( s.  fig .",
    "[ fig : example_shower]b ) .",
    "another type of background are direct hits of muons in the pmts , that result in tracks of synchronously triggered pixels ( s.  fig .",
    "[ fig : example_shower]c ) .",
    "but the main problem is distant lightning causing large areas of the camera to trigger in fast bursts ( s.  fig .",
    "[ fig : example_shower]d ) .",
    "the software implemented third level trigger has to distinguish between background and extensive air showers , varying from dim and short tracks for distant showers up to an illumination of the whole camera for very close events .",
    "the key to the trigger decision lies in the timing information of the pixels : real shower events always show a temporal development along their track .",
    "the prototype tlt identifies background by analyzing the adc data and checking for a temporal sequence inside the 5-pixel slt - pattern .",
    "the major disadvantage of this approach was the very time consuming readout of adc traces , needed to determine the pixel time . especially during lightning ,",
    "bursts of events with many pixels were rejected too slowly , all flt buffers were filled and dead time was introduced .    in this paper",
    "we will describe a new two - stage tlt . in a first step lightning events are fast and efficiently rejected by cuts on the hardware multiplicity data . in the second step the time sequence of the pixels data is analyzed using their adc data .    in the daq chain the tlt",
    "is followed by the event builder , which merges concurrent events in neighboring telescopes together .",
    "a subsequent algorithm tries to calculate the preliminary shower direction to form a hybrid trigger ( t3 ) for the suface detector .",
    "finally the event is stored on hard disk and transmitted later on to the central campus via microwave uplink .      for the developement of the new trigger",
    "we need a set of background events and extensive air showers .",
    "therefore we randomly selected 8839 events from one year of data taking and manually separated them into 2425 shower and 6414 background events .",
    "this classification was done very conservative to prevent the misinterpretation of potential showers as background .",
    "the separation was successfully cross - checked by a reconstruction with the detector simulation and analysis framework offline@xcite .",
    "none of our events classified as background , but 25% of our shower candidates can be reconstructed .",
    "this confirms the conservative character of our manual classification .    after using this data sample for the trigger developement",
    ", we determine the background rejection efficiency with a second batch of background events independentely from the training data .",
    "the acceptance of shower events , especially at high primary energies , is checked with monte - carlo - simulated showers .",
    "in order to speed up the trigger decision , the new tlt has to abstain from reading out adc traces until the data load is sufficiently reduced . as the digital electronics of flt and slt",
    "is based on flexible re - programmable fpga logic it was easy to update the firmware to provide a hardware calculated multiplicity .",
    "the multiplicity is the number of simultaneously ( i.e. within 100ns ) triggered camera pixels .",
    "a pixel contributes to the calculation of the multiplicity as long as its running adc - sum exeeds the flt threshold . contributing pixels of one column",
    "are counted at the flt , the total sum for the full camera is evaluated at the slt .",
    "the hardware implementation limits the multiplicity to a maximum value of 63 .",
    "the chronological sequence of the multiplicity values with full 100ns time resolution describes the temporal development of the overall camera picture .",
    "multiplicity signal _ is directly accessible from the hardware and therefore particular suitable for effective and fast background discrimination .      in order to capture the characteristics of the multiplicity signal ,",
    "the following 5 parameters were selected , distinguishing well between background and shower events :    number of gaps in the multiplicity signal , i.e. the number of periods without triggered pixels .",
    "sum of steps in the multiplicity signal ; the absolute values of steps both up and down are added .",
    "integral of the multiplicity signal over the full event window of 1000 values .",
    "it is equal to the number of triggered pixels times their trigger duration .",
    "number of triggered pixels .",
    "this is not a multiplicity parameter , but an overall characterization of the event .",
    "number of pixels , which trigger in the first 5 @xmath10s of an event .",
    "this value is no real multiplicity parameter either .",
    "we developed 5 independent cuts on these parameters using the sample of manually classified events mentioned in sec .",
    "[ sec : data_sample ] as training data set .",
    "the slt divides the readout window in a @xmath11s pre - trigger and a @xmath12s post trigger window .",
    "only few pixels should trigger in the first microseconds of each event .",
    "however during lightning the general variance of the adc - traces is such high , that the random pixel trigger rate increases strongly .",
    "hence we keep only events with less than 6 pixels triggering within the first @xmath13s of the event : @xmath14 this constraint already rejects 51.7% of the background in our data sample without rejecting any showers .      far away",
    "showers cause long pulses in the adc traces , as it takes them longer to pass the field of view of a single pixel .",
    "e.g. a vertical shower at 10 km distance illuminates each pixel for about @xmath15s .",
    "in contrast close showers have shorter , but much higher pulses .",
    "as the flt uses a boxcar sum over 10 values for the trigger , a short and high peak leads also to a trigger lasting 10 clock cycles .",
    "therefore showers provide independently of their distance a minimum pixel trigger duration of about 1 @xmath10s while background events frequently consist of many short pixel triggers .",
    "the integral of the multiplicity signal @xmath16 is the sum of all pixels times their trigger duration .",
    "the cut @xmath17 rejects all events where a lot of pixels trigger for less than @xmath18s .",
    "28.3% of the background is rejected by this cut without losing any shower event      in shower events pixels trigger one after the other , while lightning causes rather independent pixel triggers .",
    "for this reason the multiplicity signal of showers usually consists of continuous areas , while the signal of background events is interrupted by gaps .    by accepting only events with @xmath19",
    "we reject 27.7% of the background .",
    "sometimes strong lightning events have so many pixel triggers , that they form a continuous area in the multiplicity signal by chance .",
    "these events will not be rejected by cut  ( [ eq : cut3 ] ) . however , as the fluctuation of the multiplicity signal is higher than for shower events , a cut on @xmath20 can identify such events . @xmath21",
    "this constraint rejects all events , where more than 25 pixels trigger twice , which affects 33.1% of the background events .",
    "only one noisy shower candidate is rejected .      during",
    "very intense lightning the multiplicity signal gets saturated at its maximum value of 63 . in the saturated region",
    "the multiplicity is constant and the evaluated value of @xmath20 is getting lower .",
    "thus cut  ( [ eq : cut4 ] ) does not work .",
    "such events are identified by a cut on large values of @xmath16 : @xmath22 9.5% of the background is rejected , no additional shower event is lost .",
    "the 5 cuts widely overlap each other reducing their combined rejection efficiency . in total 58.2% of the background in our data sample",
    "is rejected .",
    "the cuts reject background independently from each other , so their order does not matter in terms of rejection efficiency .",
    "so the fastest and most efficient cuts are performed first in order to reduce data load for the next steps .",
    "the fraction of background event rejected by the multiplicity cuts strongly depends on the number of triggered pixels @xmath23 : while 99% of the large background events with @xmath24 are rejected , only 7% of the smaller events are caught ( s.  fig .",
    "[ fig : rejection_mcuts ] ) .    although cut  ( [ eq : cut2])-([eq : cut5 ] ) contribute only by a few percentage points to the overall rejection efficiency , they play an important role to increase rejection of large background events up to 99% .",
    "unfortunately it is not possible to enhance the efficiency at low pixel numbers with additional multiplicity cuts , the multiplicity information is not detailed enough .",
    "for example the signature of a muon hit ( short and high adc - pulses at the same time ) fades out in the multiplicity signal , as the trigger time is extended to 1 @xmath10s by the boxcar sum of the flt , and only the sum of all pixels is displayed .",
    "however , the critically high data load from bursts of events with high pixel numbers during lightning is eliminated in a fast and efficient way .",
    "for the reduced data stream of events with few pixels it is now feasible to readout complete adc traces in order to improve rejection of muon hits and random triggers without deadtime . for this purpose",
    "we developed an algorithm that analyses the temporal sequence of the triggered pixels with full 100ns time resolution in 4 steps :      at first we have to remove disturbing pixels aside from the real shower track . scanning the matrix of triggered pixels row by row , the algorithm finds groups of connected pixels ( allowing maximal 1 gap ) .",
    "the group with the largest number of pixels is regarded as forming the `` shower center '' which is used in the subsequent analysis .",
    "a straight line parameterized in the form ( [ eq : straightline ] ) is fitted to the pixels of the shower center using the least square method ( s. fig .",
    "[ fig : showercore1 ] ) . for each pixel",
    "its line position @xmath25 is calculated and the pixels are sorted by rising @xmath25-values . @xmath26      the pixel times must be determined by analyzing the adc data . the flt - pixel time is not suitable , as the time of threshold crossing is blurred by the 10 entry running sum .",
    "good results are achieved by a simple maximum search of a running 2-bin adc - average . as we can easily access the second level trigger time with a low resolution of @xmath27s ,",
    "the time assignment can be accelerated by constraining the maximum scan to a @xmath28s window around the slt time .",
    "the number of entries in the moving average is a compromise between best noise suppression and acceptable time - blurring .",
    "another compromise is the width of the search window : a wider window around the slt time might find a higher adc pulse , but increases the danger of finding wrong pulses .",
    "both values were varied and tested , above listed values are used .",
    "randomly triggered pixels are removed from the shower center group , if their pixel time differs by more than 2 rms deviation from the average shower center time .",
    "finally the algorithm runs through the list of @xmath25-sorted pixels to count how often the time difference is positive ( increment of @xmath29 ) or negative ( increment of @xmath30 ) . if the time of adjacent pixels is equal , that pixel is not taken into account .",
    "the defined temporal propagation of showers requires either always increasing or always decreasing pixel times .",
    "thus the absolute value @xmath31 is a good criteria for shower events independent from their direction .",
    "a single randomly triggered pixel has big influence on the temporal sequence of showers with few pixels .",
    "therefore shower centers with less than 7 pixels are checked again to verify , if their value of @xmath31 increases when one pixel is left out of the @xmath29 , @xmath30 calculation .",
    "figure  [ fig : stc - cut ] displays the distribution of the parameter @xmath31 for shower and background events . the cut @xmath32 rejects events with only a weak temporal sequence .",
    "this last cut increases the background rejection up to 93.6% , but it also rejects 2.4% of our shower candidates .",
    "those 56 falsely rejected shower events were checked in detail : the majority of them could not be reconstructed , their manual classification as shower is questionable .",
    "only 6 of the rejected events could be sucessfully reconstructed , always yielding an energy below @xmath33 , which is close to lower energy limit of the detector .    because the background rejection of our multiplicity trigger is already good enough at high pixel numbers ,",
    "the space time correlation cut is only applied for events with less than 25 pixels in order to increase processing speed .",
    "after the cuts and algorithm of the new trigger had been optimized , we performed several tests in order to benchmark our trigger and compare its performance with the prototype setup .      to verify the high background rejection efficiency , we used 24306 events from randomly selected background files as an independent data set .",
    "these background files are recorded during normal data taking for monitoring purposes .",
    "1% of the events rejected by the prototype tlt , and 10% of the events rejected by the last trigger stage ( t3 ) are stored . to get a realistic composition of background events each prototype tlt rejected event has to be weighted statistically with the factor 10 .",
    "taking into account this weight factor we determine a background rejection of 95% for the new tlt implementation ( to be compared to 74% for the prototype tlt ) .",
    "as expected , the efficiency rises with the number of pixels , 99% of the background events with more than 25 pixels ( e.g. lightning ) are rejected .",
    "the extreme rareness of ultra high energetic cosmic rays , limits their statistics in measured data . in order to check the trigger acceptance to showers in the full primary energy range we used simulated events .",
    "the simulation was done with offline @xcite using conex - showers @xcite with energies between @xmath34 and @xmath35 .",
    "proton- and iron - induced showers were generated in equal parts , their positions were randomly distributed over the measuring field .",
    "the simulation took into account the fluorescence yield , light propagation and absorption , the properties of the telescope hardware , readout , flt and slt .",
    "the fraction of falsely rejected showers ( called * frs * in the following ) for the new tlt and the prototype are compared in table  [ tab : comparision_sim ] .",
    "as some simulated showers are close to immanent detection limits due to large simulated distance and low primary energy , we also checked the events for reconstructability .",
    "events with sufficient data quality for reconstruction are accepted much better by our tlt .",
    ".comparison of frs with simulated showers for the prototype and new tlt . [ cols=\"<,^,^\",options=\"header \" , ]",
    "we have developed a new tlt software on the basis of the existing fluorescence telescope hardware .",
    "the main goals of the development were an improved background rejection and fast trigger decision in order to handle bursts of background events during bad weather conditions .",
    "these aims are achieved by using a two stage algorithm : in a first step we use the temporal developement of the number of triggered pixels in an event .",
    "this multiplicity signal is calculated in hardware .",
    "five independent cuts on multiplicity parameters are used to reject background events .",
    "although the multiplicity trigger works fine for the main data load of events with many illuminated pixels , it fails in distinguishing short shower traces from background events with less than 25 pixels . for these events",
    "we need a more detailed analysis of the temporal appearance of the triggered pixels along the shower track .",
    "the acceptance of extensive air showers was determined to be better than 99% using simulated events in the energy range from @xmath36 to @xmath35 . at the same time 95% of the background",
    "is rejected , during bad weather conditions the rejection efficiency of events with more than 25 pixels rises above 99% . as the algorithm abstains from single pixel analysis for these events ,",
    "the decision is done fast enough to reject background in almost real - time .",
    "the new tlt was installed into the trigger chain in september 2007 .",
    "this enhancement improves the data quality of the fluorescence detector and noticeably simplifies data taking especially during the rainy season .    00 the pierre auger collaboration , correlation of the highest - energy cosmic rays with nearby extragalactic objects , science 318 ( 5852):938942 , 2007 .",
    "the pierre auger collaboration , properties and performance of the prototype instrument for the pierre auger observatory , nucl .",
    "instrum . meth .",
    "a523:5095 , 2004 .",
    "m. kleifges for the auger collaboration , the fluorescence detector electronics of the pierre auger observatory , nucl .",
    "instrum . meth .",
    "a518:180182 , 2004 .",
    "s. argir et al . , the offline software framework of the pierre auger observatory .",
    "instrum . meth . , a580:14851496 , 2007 .",
    "t. bergmann et al . ,",
    "one - dimensional hybrid approach to extensive air shower simulation , astropart .",
    "phys . , 26:420432 , 2007 ."
  ],
  "abstract_text": [
    "<S> the trigger system for the auger fluorescence telescopes is implemented in hard- and software for an efficient selection of fluorescence light tracks induced by high - energy extensive air showers . </S>",
    "<S> the algorithm of the third stage uses the multiplicity signal of the hardware for fast rejection of lightning events with above 99% efficiency . in a second step </S>",
    "<S> direct muon hits in the camera and random triggers are rejected by analyzing the space - time correlation of the pixels . </S>",
    "<S> the trigger algorithm was tested with measured and simulated showers and implemented in the electronics of the fluorescence telescopes . </S>",
    "<S> a comparison to a prototype trigger without multiplicity shows the superiority of this approach , e.g. the false rejection rate is a factor 10 lower .    </S>",
    "<S> ultrahigh energy cosmic rays , air fluorescence detectors , software trigger </S>"
  ]
}