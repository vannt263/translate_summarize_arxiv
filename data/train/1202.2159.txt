{
  "article_text": [
    "electronic structure calculations based on solving the kohn - sham density functional theory ( ksdft ) play an important role in the analysis of electronic , structural and optical properties of molecules , solids and other nano structures .",
    "the efficiency of such a calculation depends largely on the computational cost associated with the evaluation of the electron charge density for a given potential within a self - consistent field ( scf ) iteration .",
    "the most straightforward way to perform such an evaluation is to partially diagonalize the kohn - sham hamiltonian by computing a set of eigenvectors corresponding to the algebraically smallest eigenvalues of the hamiltonian .",
    "the complexity of this approach is @xmath0 , where @xmath1 is the number of electrons in the atomistic system of interest . as the number of atoms or electrons in the system increases , the cost of diagonalization becomes prohibitively expensive .",
    "linear scaling algorithms ( or @xmath2 scaling methods , see for example  @xcite , and review articles  @xcite ) are attractive alternatives for solving ksdft .",
    "the traditional linear scaling methods use the nearsightedness principle , which asserts that the density perturbation induced by a local change in the external potential decays exponentially away from where the perturbation is applied .",
    "consequently , the off - diagonal elements of the density matrix decay exponentially away from the diagonal  @xcite . strictly speaking ,",
    "the nearsightedness property is valid for insulating systems but not for metallic systems .    in order to design a fast algorithm that is accurate for both insulating and metallic systems",
    ", we use an equivalent formulation of ksdft , in which the charge density is evaluated as the diagonal of the fermi - dirac function evaluated at a fixed kohn - sham hamiltonian . by approximating the fermi - dirac function through a pole expansion technique  @xcite",
    ", we can reduce the problem of computing the charge density to that of computing the diagonal of the inverses of a number of shifted kohn - sham hamiltonians .",
    "this approach was pursued by a number of researchers in the past .",
    "the cost of this approach depends on the number of poles required to expand the fermi - dirac function and the cost for computing the diagonal of the inverse of a shifted kohn - sham hamiltonian .    the recent work by lin et al .",
    "@xcite provides an accurate and efficient pole - expansion scheme for approximating the fermi - dirac function .",
    "the number of poles required in this approach is proportional to @xmath3 , where @xmath4 is proportional to the inverse of the temperature , and @xmath5 is the spectral width of the kohn - sham hamiltonian .",
    "( i.e. the difference between the largest and the smallest eigenvalues ) .",
    "this number of expansion terms , or the pole count here is significantly lower than those given in the previous approaches  @xcite .",
    "furthermore , an efficient selected inversion algorithm for computing the inverse of the diagonal of a shifted kohn - sham hamiltonian without computing the full inverse of the hamiltonian has been developed  @xcite .",
    "the complexity of this algorithm is @xmath2 for quasi-1d systems such as nanorods , nanotubes and nanowires , @xmath6 for quasi-2d systems such as graphene and surfaces , and @xmath7 for 3d bulk systems . in exact arithmetic",
    ", the selected inversion algorithm gives the exact diagonal of the inverse , i.e. , the algorithm does not rely on any type of localization or truncation scheme . for insulating systems",
    ", the use of localization and truncation can be combined with selected inversion to reduce the complexity of the algorithm further to @xmath2 even for general 3d systems .    in the previous work  @xcite",
    ", we used the pole expansion and selected inversion ( pexsi ) technique to solve the kohn - sham problem discretized by a finite difference scheme .",
    "however , it is worth pointing out that pexsi is a general technique that is not limited to discretized problems obtained from finite difference .",
    "in particular , it can be readily applied to discretized kohn - sham problems obtained from any localized basis expansion technique . in this paper , we describe how pexsi can be used to speed up the solution of a discretized kohn - sham problem obtained from an atomic orbital basis expansion . we show that electron charge density , total energy , helmholtz free energy and atomic forces can all be efficiently calculated by using pexsi .",
    "we demonstrate the performance gain we can achieve by comparing pexsi with the lapack diagonalization subroutine dsygv on two types of nanotubes .",
    "we show that by using the pexsi technique , it is possible to perform electronic structure calculations accurately for a nanotube that contains 10,000 atoms on a single processor within a reasonable amount of time .",
    "the crossover point beyond which the computational complexity of pexsi exhibits linear scaling with respect to the number of atoms is around a few hundred atoms .",
    "this paper is organized as follows . in section  [ sec : theory ] , we show how the pexsi technique previously developed in  @xcite can be extended to solve discretized kohn - sham problems obtained from an atomic orbital expansion scheme . in particular",
    ", we will show how charge density , total energy , free energy and force can be calculated in this formalism .",
    "we will also discuss how to update the chemical potential . in section  [ sec :",
    "examples ] , we report the performance of pexsi on two quasi-1d test problems .    throughout the paper , we use @xmath8 to denote the imaginary part of a complex matrix @xmath9 . a properly defined inner product between two functions @xmath10 and @xmath11 is sometimes denoted by @xmath12 .",
    "the diagonal of a matrix @xmath9 is sometimes denoted by @xmath13 .",
    "we use @xmath14 to denote the hamiltonian operator , and @xmath15 to denote the discretized hamiltonian matrix and the corresponding overlap matrix obtained from a basis set @xmath16 .",
    "similarly @xmath17 denotes the single particle density matrix operator , and the corresponding electron density is denoted by @xmath18 .",
    "the matrix @xmath19 denotes the reduced single particle density matrix represented under a basis set @xmath16 .",
    "it will be used to define the electron density @xmath20 and the total energy @xmath21 . in a finite temperature _ ab initio _ molecular dynamics simulation",
    ", we also need the helmholtz free energy @xmath22 , and the atomic forces on the nuclei @xmath23 . to compute these quantities , we need the reduced free energy density matrix @xmath24 and the reduced energy density matrix @xmath25 . in pexsi , these matrices are approximated by a finite @xmath26-term pole expansion , denoted by @xmath27 respectively .",
    "however , to simplify notation , we will drop the subscript @xmath26 and simply use @xmath28 to denote the approximated matrices unless otherwise noted .",
    "the ground - state electron charge density @xmath18 of an atomistic system can be obtained from the self - consistent solution to the kohn - sham equations @xmath29 \\psi_i(x ) = \\psi_i(x ) \\varepsilon_i , \\label{kseqs}\\ ] ] where @xmath30 is the kohn - sham hamiltonian that depends on @xmath18 , @xmath31 are the kohn - sham orbitals that satisfy the orthonormality constraints @xmath32 and the eigenvalue @xmath33 is often known as the @xmath34th kohn - sham quasi - particle energy . using the kohn - sham orbitals , we can define the charge density by @xmath35 with occupation numbers @xmath36 , @xmath37 . at finite temperature @xmath38 , the occupation numbers in ( [ rhodef ] )",
    "can be chosen according to the fermi - dirac distribution function @xmath39 and @xmath40 is the chemical potential chosen to ensure that @xmath41    note that @xmath18 is simply the diagonal of the single particle density matrix defined by @xmath42 and the charge sum rule in ( [ chargesum1 ] ) can be expressed alternatively by @xmath43 = n_e , \\label{chargesum2}\\ ] ] where tr denotes the trace of an operator .",
    "it follows from ( [ kseqs ] ) and ( [ gammaeq ] ) that the electron density @xmath18 is a fixed point of the kohn - sham map defined by @xmath44 - \\mu \\delta(x , x'))\\right ) , \\label{ksmap}\\ ] ] where @xmath40 is chosen to satisfy ( [ chargesum2 ] ) .",
    "the most widely used algorithm for finding the solution to ( [ chargesum2 ] ) and ( [ ksmap ] ) is a broyden type of quasi - newton algorithm . in the physics literature",
    ", this is often referred to as the self - consistent field ( scf ) iteration .",
    "the most time consuming part of this algorithm is the evaluation of @xmath45 in ( [ ksmap ] ) .",
    "an infinite - dimensional kohn - sham problem can be discretized in a number of ways ( e.g. , planewave expansion , finite difference , finite element etc . ) in this paper , we focus on a discretization scheme in which a kohn - sham orbital @xmath46 is expanded by a linear combination of a finite number of basis functions @xmath47 , i.e. , @xmath48 we should note that the total number of basis functions @xmath49 is generally proportional to the number of electrons @xmath1 or atoms in the system to be studied .",
    "these basis functions @xmath50 can be constructed to have local nonzero support .",
    "but they may not necessarily be orthonormal to each other",
    ". examples of these basis functions include gaussian type orbitals  @xcite and local atomic orbitals  @xcite , adaptive curvilinear coordinates  @xcite , optimized nonorthogonal orbitals  @xcite and adaptive local basis functions  @xcite . in numerical examples presented in section  [ sec : examples ] , we use a set of nonorthogonal local atomic orbitals .    substituting ( [ eqn : psiphi ] ) into ( [ kseqs ] ) yields a generalized eigenvalue problem @xmath51 where @xmath52 is an @xmath53 matrix with @xmath54 being its @xmath55th entry , @xmath56 is a diagonal matrix with @xmath57 on its diagonal , @xmath58 , and @xmath59 . for orthogonal basis functions ,",
    "the overlap matrix @xmath60 is an identity matrix , and eq .",
    "reduces to a standard eigenvalue problem .",
    "when local atomic orbitals are used as the basis , @xmath60 is generally not an identity matrix , but both @xmath61 and @xmath60 are sparse .    without loss of generality , we assume the basis functions and the kohn - sham orbitals to be real in the following discussion . let @xmath62 $ ] and @xmath63 $ ] , then eq .   can be written in a compact form @xmath64 consequently , the single - particle density matrix ( [ gammaeq ] ) becomes  @xcite @xmath65      the most straightforward way to evaluate @xmath17 is to follow the right hand side of ( [ eqn : compactgamma ] ) , which requires solving the generalized eigenvalue problem ( [ eqn : nonortho ] ) .",
    "the computational complexity of this approach is @xmath66 .",
    "this approach becomes prohibitively expensive when the number of electrons or atoms in the system increases .",
    "an alternative way to evaluate @xmath17 , which circumvents the cubic scaling of the diagonalization process , is to approximate @xmath17 by a fermi operator expansion ( foe ) method  @xcite . in an foe scheme ,",
    "the function @xmath67 is approximated by a linear combination of a number of simpler functions , each of which can be evaluated directly without diagonalizing the matrix pencil @xmath68 .",
    "a variety of foe schemes have been developed .",
    "they include polynomial expansion  @xcite , rational expansion  @xcite , and a hybrid scheme in which both polynomials and rational functions are used  @xcite . in all these schemes ,",
    "the number of simple functions used in the expansion is asymptotically determined by @xmath69 , where @xmath70 is the spectrum width for the discrete problem .",
    "an upper bound of @xmath5 can be obtained inexpensively by a very small number of lanczos steps  @xcite .",
    "while most of the foe schemes require as many as @xmath71 or @xmath72 terms of simple functions , the recently developed pole expansion  @xcite is particularly promising since it requires only @xmath73 terms of simple rational functions .",
    "the pole expansion takes the form @xmath74 where @xmath75 are complex shifts and weights respectively .",
    "we will refer to @xmath76 as _ poles _ in the following discussions .",
    "the construction of pole expansion is based on the observation that the non - analytic part of the fermi - dirac function lies only on the imaginary axis within @xmath77\\bigcup \\left [ -i\\infty , -\\frac{i\\pi}{\\beta } \\right]$ ] . a dumbbell - shaped cauchy contour ( see fig .  [ fig : pole ] )",
    "is carefully chosen and discretized to circle the eigenvalues @xmath78 on the real axis , while avoiding the intersection with the non - analytic region .",
    "the pole expansion does not require a band gap between the occupied and unoccupied states .",
    "therefore , it is applicable to both insulating and metallic systems",
    ". furthermore , the construction of the pole expansion relies only on the analytical structure of the fermi - dirac function rather than its detailed shape .",
    "this is a key property that is crucial for constructing pole expansions for other functions , including the reduced free energy density matrix and the reduced energy density matrix which are discussed in section  [ subsec : energy ] for the purpose of computing helmholtz free energy and atomic forces .    .",
    "the thick black line on the real axis indicates the range of @xmath79 , and the thin blue line on the imaginary axis indicates the non - analytic part of @xmath80 .",
    "the yellow dumbbell shaped contour is chosen to exclude the non - analytic part of the complex plane .",
    "each block dot on the contour corresponds to a pole used in the pole expansion approximation.,scaledwidth=70.0% ]    following the derivation in the appendix , we can use ( [ eqn : polerho ] ) to approximate the single particle density matrix @xmath81 by its @xmath26-term pole expansion , denoted by @xmath82 as    @xmath83    in the above expression , @xmath19 is an @xmath84 matrix represented in terms of the atomic orbitals @xmath16 , and is referred to as the reduced single particle density matrix . to simplify our notation",
    ", we will drop the subscript @xmath26 from the @xmath26-term pole expansion approximation of single - particle density matrix @xmath81 unless otherwise noted .",
    "similar treatment will be made for the electron density @xmath20 , the total energy @xmath21 , the helmholtz free energy @xmath22 , and the atomic force on the @xmath85-th nuclei @xmath86 . using eq .",
    ", we can evaluate the electron density in the real space as the diagonal elements of @xmath81 , i.e. , @xmath87 we assume that each basis function @xmath88 is compactly supported in the real space . in order to evaluate @xmath18 for any particular @xmath89",
    ", we only need @xmath90 such that @xmath91 , or @xmath92 .",
    "this set of @xmath90 s is a subset of @xmath93 . to obtain these _ selected elements _ , we need to compute the corresponding elements of @xmath94 for all @xmath95 .",
    "the recently developed selected inversion method  @xcite provides an efficient way of computing the selected elements of an inverse matrix . for a symmetric matrix of the form @xmath96",
    ", the selected inversion algorithm first constructs an @xmath97 factorization of @xmath9 , where @xmath98 is a block lower diagonal matrix called the cholesky factor , and @xmath99 is a block diagonal matrix . in the second step , the selected inversion algorithm computes all the elements @xmath100 such that @xmath101 . since @xmath101 implies that @xmath102 , all the selected elements of @xmath103 required in are computed . as a result ,",
    "the computational scaling of the selected inversion algorithm is only proportional to the number of nonzero elements in the cholesky factor @xmath98 . in particular",
    ", the selected inversion algorithm has a complexity of @xmath104 for quasi-1d systems , @xmath105 for quasi-2d systems , and @xmath106 for 3d bulk systems .",
    "the selected inversion algorithm achieves universal improvement over the diagonalization method for systems of all dimensions .",
    "it should be noted that selected inversion algorithm is an _ exact _",
    "method for computing selected elements of @xmath103 if exact arithmetic is to be employed , and in practice the only source of error is the roundoff error . in particular , the selected inversion algorithm does not rely on any localization property of @xmath103 .",
    "however , it can be combined with localization properties of insulating systems to further reduce the computational cost .",
    "we will pursue this approach in future work .",
    "we also remark that the pexsi technique can be applied whenever @xmath61 and @xmath60 are sparse matrices .",
    "however , since the selected inversion method relies on an @xmath97 factorization of @xmath107 , the preconstant of the selected inversion method asymptotically scales cubically with respect to the number of basis functions per atom .",
    "the number of basis functions or degrees of freedom per atom associated with the finite difference method  @xcite and the finite element method  @xcite is usually much larger than that associated with methods based on contracted basis functions such as local atomic orbitals .",
    "therefore the finite difference method and the finite element method do not benefit as much from the pexsi technique as methods that are based on local atomic orbitals .",
    "in addition to reducing the computational complexity of the charge density calculation in each scf iteration , the pexsi technique can also be used to compute the total energy , the helmholtz free energy as well as the atomic forces efficiently without diagonalizing the kohn - sham hamiltonian .    when kohn - sham orbitals @xmath108 are available , the total energy associated with an insulating system can be evaluated as @xmath109    - \\int v_{{{\\mathrm{xc}}}}[\\hat{\\rho}](x )",
    "\\hat{\\rho}(x ) { \\,\\mathrm{d}}x .    \\end{split}\\ ] ]    an alternative expression for @xmath21 is @xmath110 - \\frac12 \\iint \\frac{\\hat{\\rho}(x )    \\hat{\\rho}(y)}{{\\left\\lvertx - y\\right\\rvert } } { \\,\\mathrm{d}}x { \\,\\mathrm{d}}y \\\\    & + e_{{{\\mathrm{xc}}}}[\\hat{\\rho } ]    - \\int v_{{{\\mathrm{xc}}}}[\\hat{\\rho}](x ) \\hat{\\rho}(x ) { \\,\\mathrm{d}}x ,    \\end{split }    \\label{eqn : energyformula}\\ ] ] where @xmath19 is the reduced density matrix defined in .",
    "note that in this expression , the first term depends on the trace of the product of @xmath19 and @xmath61 .",
    "the computation of this term requires only the @xmath55th entry of @xmath19 for @xmath55 satisfying @xmath111 .",
    "these entries are already available from the charge density calculation , thus using them for total energy evaluation does not introduce additional complexity .",
    "all other terms in the total energy expression depends on the electron density @xmath18 , which we already know how to compute by the pexsi technique .",
    "here we assume lda  @xcite or gga  @xcite exchange - correlation functional is used for the kohn - sham total energy expression .    for metallic systems at finite temperature ,",
    "the helmholtz free energy @xmath22 takes into account both energy and entropy , and is the quantity of interest  @xcite .",
    "the helmholtz free energy can be written as  @xcite @xmath112\\\\    &    - \\int v_{{{\\mathrm{xc}}}}[\\hat{\\rho}](x ) \\hat{\\rho}(x ) { \\,\\mathrm{d}}x .",
    "\\end{split }    \\label{eqn : helmholtz}\\ ] ] it is straightforward to show that as @xmath113 , @xmath114 . again , in eq .  , only the first term requires special treatment .",
    "note that the function @xmath115 is analytic everywhere in the complex plane , except for segments of the imaginary axis within @xmath77\\bigcup \\left [ -i\\infty , -\\frac{i\\pi}{\\beta } \\right]$ ] . in this sense",
    ", @xmath116 shares the same analytic structure as that of the fermi - dirac function @xmath117 .",
    "the pole expansion technique can be applied with the same choice of poles @xmath118 but different weights , denoted by @xmath119 , _ i.e._@xmath120 following the derivation in the appendix , we can rewrite the helmholtz free energy as @xmath121 + \\mu n_e    - \\frac12 \\iint \\frac{\\hat{\\rho}(x )    \\hat{\\rho}(y)}{{\\left\\lvertx - y\\right\\rvert } } { \\,\\mathrm{d}}x { \\,\\mathrm{d}}y\\\\    &    + e_{{{\\mathrm{xc}}}}[\\hat{\\rho } ]    - \\int v_{{{\\mathrm{xc}}}}[\\hat{\\rho } ] \\hat{\\rho}(x ) { \\,\\mathrm{d}}x ,    \\end{split }    \\label{eqn : helmholtzpole}\\ ] ] where the reduced free energy density matrix @xmath24 is given by @xmath122 again , the selected elements of @xmath123^{-1}$ ] required for evaluation the first terms of are already available from the charge density calculation .",
    "no additional computation is required to obtain these elements .    to perform geometric optimization or ab initio molecular dynamics , we need to compute atomic forces associated with different atoms .",
    "atomic force is the derivative of the helmholtz free energy with respect to the position of an atom . following the derivation in the appendix",
    ", we can express the atomic force associated with the @xmath85-th atom as @xmath124        + \\operatorname{tr}\\left [ \\gamma^e \\frac{\\partial s}{\\partial r_i } \\right ] .",
    "\\label{eqn : forcepole}\\ ] ] where @xmath25 is the reduced energy density matrix defined by @xmath125 it is clear that the function @xmath126 shares the same analytic structure as that of the fermi - dirac function @xmath117 .",
    "thus , the reduced energy density matrix can be approximated by the same pole expansion used to approximate the reduced density matrix .",
    "in particular , there is no difference in the choice of poles @xmath95 .",
    "but the weights of the expansion , which we denote by @xmath127 , for the reduced energy density matrix approximation , are different . to be specific",
    ", the reduced energy density matrix can be written using the pole expansion as @xmath128 again the selected elements of @xmath129 required in can be easily computed from the selected elements of @xmath123^{-1}$ ] which are available from the charge density calculation .      the true chemical potential @xmath40 required in the pole expansions , and is not known a priori .",
    "it must be solved iteratively as part of the solution to and . for a fixed hamiltonian @xmath61 associated with a fixed charge density , it is easy to show that the left hand side , which can be expressed as , @xmath130 = \\operatorname{tr}[\\gamma \\phi^t \\phi ] = \\operatorname{tr}[\\gamma s ]    \\label{eqn : nmu}\\ ] ] is a monotonic function with respect @xmath40 .",
    "hence the root of is unique .",
    "it can be obtained by either the newton raphson or the bisection method .    in an scf iteration , @xmath20 and @xmath40",
    "are often updated in an alternating fashion .",
    "when the kohn - sham quasi - particle energies @xmath131 associated with a fixed charge density are available , both @xmath132 and its derivative can be easily evaluated in the newton s method . however ,",
    "if @xmath81 is approximated via a pole expansion , a new expansion is needed whenever @xmath40 is updated .",
    "furthermore , the derivative of @xmath132 can be approximated by finite difference . in practice , one or two newton s iterations are sufficient to produce a reasonably accurate @xmath40 after the first scf iteration .",
    "when @xmath133 is sufficiently close to the true chemical potential , the derivative of @xmath134 can be approximated by @xmath135 thus each newton s iteration requires only one more selected inversion calculation .",
    "this type of iterative strategy for updating the chemical potential has also been discussed in literature  @xcite .      in alg .",
    "[ alg : pexsi ] we summarize the main steps of the pexsi technique for accelerating atomic orbital - based electronic structure calculation with the scf iteration .",
    "we see that pexsi replaces the diagonalization procedure in solving ksdft , and obtains the electron density , the total energy , the helmholtz free energy and the atomic force accurately without computing eigenvalues and eigenfunctions of the hamiltonian operator .",
    "[ cols= \" < , < \" , ]              the pexsi scheme with atomic orbitals can also be used for accurate geometry relaxation of large - scale atomic systems .",
    "we use a truncated boron - nitride nanotube ( 8,0 ) with 1024 atoms , shown in fig .",
    "[ fig:1024tube ] , as an example to illustrate the efficiency of pexsi in this type of calculation .",
    "the nanotube contains 504 boron atoms ( b ) and 504 nitride atoms ( n ) .",
    "each end of the nanotube is passivated by @xmath136 hydrogen atoms ( h ) .",
    "we used dzp orbitals for all three atomic elements .",
    "the cutoff radius for b and n is set to 8.0 bohr .",
    "the cutoff radius for h is set to 6.0 bohr .",
    "we used 96 poles in the pole expansion for both energy and force calculations .",
    "convergence is reached after 105 steps of ionic relaxation steps are taken in the bfgs method .",
    "the maximum atomic force associated with the converged structure is less than 0.04 ev / angstrom .",
    "the mean absolute error ( mae ) of atomic forces , which is measured by the mean absolute value of the difference between the force calculated by the pexsi scheme and that calculated by the lapack diagonalization subroutine dsygv , is shown in fig .",
    "[ fig : forcediff ] .",
    "this difference is within 5@xmath137 ev / angstrom for all atoms .",
    "this observation shows that the pexsi scheme is accurate for evaluating the forces for this system .",
    "the convergence history of energy per atom and the convergence history of the maximum force with respect to the iteration number in the geometry optimization procedure are plotted in fig .",
    "[ fig : energyforce ] ( a ) and ( b ) , respectively . in fig .",
    "[ fig : energyforce ] ( a ) , the energy per atom at the last iteration step is set to zero .",
    "the energy per atom converges rapidly from 0.05 ev to 0.005 ev during the first 16 steps .",
    "correspondingly , in fig .  [ fig : energyforce ] ( b ) , the maximum force converges rapidly during the first few steps .",
    "this is mainly because the initial positions of the hydrogen and boron atoms near the end of the nanotube are not far from the equilibrium value .",
    "after the hydrogen and boron atoms at the boundary are relaxed to more reasonable positions , the maximum force begin to decrease slowly but with some oscillations . in order to illustrate more clearly the origin of the oscillation",
    ", we show the forces of boron atoms in fig .",
    "[ fig : boronforce ] . fig .",
    "[ fig : boronforce](a ) and fig .",
    "[ fig : boronforce](b ) show the forces of the boron atoms near the center of the nanotube and near the boundary of the nanotube , respectively .",
    "we find that the forces acting on the boron atoms near the center of the nanotube are much smaller than those near the boundary .",
    "this is mainly due to the fact that the atomic configuration near the center of the nanotube is close to the bulk configuration .",
    "the magnitude of the force acting on the atoms near the boundary is much larger , and is more difficult to convergence in the numerical optimization .",
    "in this paper , we generalized the recently developed pole expansion and selected inversion technique ( pexsi ) for solving finite dimensional kohn - sham equations obtained from an atomic orbital expansion .",
    "we gave expressions for evaluating the electron density , the total energy , the helmholtz free energy and the atomic forces without using eigenvalues and eigenvectors of a kohn - sham hamiltonian .",
    "these expressions are derived from an foe approximation to the fermi - dirac function using an efficient and accurate pole expansion technique .",
    "they only use selected elements of the reduced density matrix , reduced energy density matrix and reduced free energy density matrix .",
    "these selected elements can be obtained from computing the selected elements of the inverse of a shifted kohn - sham hamiltonian through the selected inversion technique .",
    "the complexity of the selected inversion is @xmath2 for quasi-1d systems such as nanorods , nanotubes and nanowires , @xmath6 for quasi-2d systems such as graphene and surfaces , and @xmath7 for 3d bulk systems .",
    "it compares favorably to the complexity of diagonalization , which is @xmath0 .",
    "we reported the performance gain we can achieve by comparing the efficiency of pexsi with that of diagonalization on two types of nanotubes .",
    "the linear scaling behavior of pexsi with respect to the number of atoms is clear when the number of atoms in these quasi-1d systems is larger than a few hundreds .",
    "even when these nanotubes contain fewer than a hundred atoms , pexsi still appears to outperform a diagonalization based dft calculation . for quasi-2d and quasi-3d systems",
    ", we expect the crossover point over which pexsi exhibits @xmath6 and @xmath7 scaling to be much larger",
    ". however , based on the experiments presented here , pexsi may still be more efficient than diagonalization ( before the crossover point is reached ) as long as the cholesky factors of the shifted kohn - sham hamiltonian are not completely dense .",
    "the computational experiments we presented above were performed on a single processor . for quasi-1d systems such as nanotubes ,",
    "the use pexsi allows us to tackle problems that contain as many as 10,000 atoms .",
    "this can not be done by using a diagonalization based approach .",
    "we further demonstrate the applicability of the pexsi scheme by performing the geometry optimization of a truncated boron nitride nanotube with 1024 atoms . for quasi-2d and 3d systems , a parallel implementation of the pexsi , which we are currently working on ,",
    "is required to solve problems with that many atoms .",
    "we will report the performance for these large - scale calculations in a future publication .",
    "* acknowledgment : * this work was supported by the laboratory directed research and development program of lawrence berkeley national laboratory under the u.s .",
    "department of energy contract number de - ac02 - 05ch11231 ( l. l. and c. y. ) , and by the chinese national natural science funds for distinguished young scholars ( l. h. ) .",
    "@xmath56 is a diagonal matrix , and the pole expansion can be applied to each component of @xmath56 as @xmath138 where @xmath85 is an @xmath84 identity matrix . using eq .  , the approximation of the single particle density matrix using @xmath26 terms of the pole expansion ( still denoted by @xmath81 to simplify the notation ) can be written as @xmath139 since the generalized eigenvalue problem   implies the identity @xmath140 the single particle density matrix takes the form @xmath141 which is eq .  .",
    "the first term in the helmholtz free energy functional is @xmath142      & = \\operatorname{tr}[cf_{\\beta}^{{\\mathcal{f}}}(\\xi-\\mu)c^t c^{-t}c^{-1 } ] \\\\      & \\equiv      \\operatorname{tr}[\\gamma^{{\\mathcal{f}}}s ] .",
    "\\end{split }    \\label{eqn : introgammaf}\\ ] ] the second equal sign in eq .   defines the reduced free energy density matrix @xmath24 , which can be evaluated using the pole expansion   as @xmath143 which is eq .  .",
    "the atomic force is in general given by the derivative of the helmholtz free energy with respect to the atomic positions .",
    "using the representation of the helmholtz free energy in eq .  , and",
    "the fact that @xmath144 ,    \\label{}\\ ] ] it can be derived that @xmath145      -\\mu n_e\\right)\\\\    & = -\\operatorname{tr}\\left[(f_{\\beta}^{{\\mathcal{f}}})'(\\xi-\\mu ) \\left(\\frac{\\partial    \\xi}{\\partial r_i}-\\frac{\\partial \\mu}{\\partial r_i}\\right)\\right ] +    n_e \\frac{\\partial \\mu}{\\partial r_i}\\\\     & = -\\operatorname{tr}\\left[f_{\\beta}(\\xi-\\mu ) \\frac{\\partial \\xi}{\\partial r_i}\\right ]     +   \\frac{\\partial \\mu}{\\partial r_i}\\left ( n_e - \\operatorname{tr}\\left [     f_{\\beta}(\\xi-\\mu )     \\right ] \\right )     \\\\    & = -\\operatorname{tr}\\left[f_{\\beta}(\\xi-\\mu ) c^t \\frac{\\partial h}{\\partial r_i } c \\right ]    -\\operatorname{tr}\\left[f_{\\beta}(\\xi-\\mu ) \\frac{\\partial c^t}{\\partial r_i } h c    \\right ]    \\\\    & \\quad -\\operatorname{tr}\\left[f_{\\beta}(\\xi-\\mu ) c^t h \\frac{\\partial c}{\\partial r_i}\\right ] \\\\    & = -\\operatorname{tr}\\left[\\gamma \\frac{\\partial h}{\\partial r_i } \\right ]    -\\operatorname{tr}\\left[f_{\\beta}(\\xi-\\mu ) \\frac{\\partial c^t}{\\partial r_i } h c    \\right]\\\\    & \\quad -\\operatorname{tr}\\left[f_{\\beta}(\\xi-\\mu ) c^t h \\frac{\\partial c}{\\partial r_i}\\right ] \\\\    \\end{split }    \\label{eqn : forcederive}\\ ] ] the second and the third terms in eq .   come from the nonorthogonality of the basis functions and should be further simplified .",
    "we have @xmath146      + \\operatorname{tr}\\left[f_{\\beta}(\\xi-\\mu ) c^t h \\frac{\\partial c}{\\partial r_i}\\right ] \\\\      = & \\operatorname{tr}\\left [ ( c^{-t } c^{-1 } ) [ c ( c^t h c ) f_{\\beta}(\\xi-\\mu ) c^t ] ( c^{-t }    c^{-1 } )    c \\frac{\\partial c^t}{\\partial r_i } \\right ] \\\\",
    "& + \\operatorname{tr}\\left [   c^{-t } c^{-1 } [ c f_{\\beta}(\\xi-\\mu ) ( c^t h c ) c^t ] c^{-t }    c^{-1}\\frac{\\partial c}{\\partial r_i } c^t\\right ] \\\\",
    "\\equiv &    \\operatorname{tr}\\left [ ( c \\xi f_{\\beta}(\\xi-\\mu ) c^t ) \\left(s c \\frac{\\partial    c^t}{\\partial r_i } s + s \\frac{\\partial c}{\\partial r_i } c^t",
    "s\\right )    \\right ] .",
    "\\end{split }    \\label{eqn : gammaederive}\\ ] ] define the reduced energy density matrix as in eq .  , and",
    "eq .   can be simplified as @xmath147\\\\    = &      \\operatorname{tr}\\left [ \\gamma^e s \\frac{\\partial s^{-1}}{\\partial r_i } s    \\right ] =   -\\operatorname{tr}\\left [ \\gamma^e \\frac{\\partial s}{\\partial r_i } \\right ]    \\end{split }    \\label{eqn : gammaederive1}\\ ] ] combining eq .",
    "and eq .  , we have @xmath124        + \\operatorname{tr}\\left [ \\gamma^e \\frac{\\partial s}{\\partial r_i } \\right ] .    \\label{}\\ ] ] which proves eq .  .",
    "n.  d. hine , p.  d. haynes , a.  a. mostofi , c.  k. skylaris , m.  c. payne , linear - scaling density - functional theory with tens of thousands of atoms : expanding the scope and scale of calculations with onetep , comput .",
    "commun . 180",
    "( 2009 ) 10411053 .",
    "l.  lin , j.  lu , l.  ying , r.  car , w.  e , fast algorithm for extracting the diagonal of the inverse matrix with application to the electronic structure analysis of metallic systems , comm .",
    "( 2009 ) 755 .",
    "l.  lin , c.  yang , j.  lu , l.  ying , w.  e , a fast parallel algorithm for selected inversion of structured sparse matrices with application to 2d electronic structure calculations , siam j. sci .",
    "33 ( 2011 ) 1329 .",
    "j.  vandevondele , m.  krack , f.  mohamed , m.  parrinello , t.  chassaing , j.  hutter , quickstep : fast and accurate density functional calculations using a mixed gaussian and plane waves approach , comput .",
    "commun . 167",
    "( 2005 ) 103 ."
  ],
  "abstract_text": [
    "<S> we describe how to apply the recently developed pole expansion and selected inversion ( pexsi ) technique to kohn - sham density function theory ( dft ) electronic structure calculations that are based on atomic orbital discretization . </S>",
    "<S> we give analytic expressions for evaluating the charge density , the total energy , the helmholtz free energy and the atomic forces without using the eigenvalues and eigenvectors of the kohn - sham hamiltonian . </S>",
    "<S> we also show how to update the chemical potential without using kohn - sham eigenvalues . </S>",
    "<S> the advantage of using pexsi is that it has a much lower computational complexity than that associated with the matrix diagonalization procedure . </S>",
    "<S> we demonstrate the performance gain by comparing the timing of pexsi with that of diagonalization on insulating and metallic nanotubes . for these quasi-1d systems , </S>",
    "<S> the complexity of pexsi is linear with respect to the number of atoms . </S>",
    "<S> this linear scaling can be observed in our computational experiments when the number of atoms in a nanotube is larger than a few hundreds . both the wall clock time and </S>",
    "<S> the memory requirement of pexsi is modest . </S>",
    "<S> this makes it even possible to perform kohn - sham dft calculations for 10,000-atom nanotubes on a single processor . </S>",
    "<S> we also perform an accurate geometry optimization calculation on a truncated ( 8,0 ) boron - nitride nanotube system containing 1024 atoms . </S>",
    "<S> numerical results indicate that the use of pexsi does not lead to loss of accuracy required in a practical dft calculation .    kohn - sham density functional theory , pole expansion , selected inversion , atomic orbital , nonorthogonal basis function , fast algorithm , large scale computation    71.15.dx , 71.15.ap </S>"
  ]
}