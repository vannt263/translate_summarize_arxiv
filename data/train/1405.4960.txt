{
  "article_text": [
    "by a _ ( semi)metric _ @xmath2 on a finite set @xmath3 we mean a nonnegative symmetric function on @xmath13 satisfying @xmath14 for all @xmath5 and the triangle inequalities @xmath15 for all @xmath16 .",
    "an _ extension _ of a metric space @xmath17 is a metric space @xmath18 with @xmath19 and @xmath20 for @xmath21 .",
    "an extension @xmath18 of @xmath22 is called a _ @xmath0-extension _ if for all @xmath5 there exists @xmath23 with @xmath24 .",
    "let @xmath1 be a simple connected undirected graph with vertex set @xmath4 .",
    "let @xmath25 denote the shortest path metric on @xmath26 with respect to the uniform unit edge - length of @xmath1 .",
    "the _ minimum @xmath0-extension problem _ * 0-ext*@xmath8 $ ] on @xmath1 is formulated as :    * 0-ext*@xmath27}$ ] : : :    given @xmath9 and    @xmath28 , : :    minimize    @xmath29    over all @xmath0-extensions @xmath18 of    @xmath30 .",
    "here @xmath31 denotes the set of all pairs of @xmath3 .",
    "the minimum @xmath0-extension problem is formulated by karzanov  @xcite , and is equivalent to the following classical facility location problem , known as _ multifacility location problem _",
    "@xcite , where we let @xmath32 : @xmath33 \\mbox{s.t . } & & \\rho = ( \\rho_1,\\rho_2,\\ldots , \\rho_n ) \\in v_{\\mgamma } \\times v_{\\mgamma } \\times \\cdots \\times v_{\\mgamma}. \\nonumber\\end{aligned}\\ ] ] this problem can be interpreted as follows : we are going to locate @xmath34 new facilities @xmath35 on graph @xmath1 , where the facilities communicate each other and communicate existing facilities on @xmath1 .",
    "the cost of the communication is propositional to the distance .",
    "our goal is to find a location of minimum total communication cost .",
    "this classic facility location problem arises in many practical situations such as the image segmentation in computer vision , and related clustering problems in machine learning ; see @xcite . also *",
    "0-ext*@xmath8 $ ] includes a number of basic combinatorial optimization problems .",
    "for example , take as @xmath1 the graph @xmath36 consisting of a single edge @xmath37 .",
    "then * 0-ext*@xmath38 $ ] is the minimum @xmath12-cut problem .",
    "more generally , * 0-ext*@xmath39 $ ] is the multiway cut problem on @xmath40 terminals .",
    "therefore * 0-ext*@xmath41 $ ] is solvable in polynomial time if @xmath42 and is np - hard if @xmath43  @xcite .",
    "this paper addresses the following problem considered by karzanov  @xcite .    _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ what are the graphs @xmath1 for which * 0-ext*@xmath8 $ ] is solvable in polynomial time ?",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    here such a graph is simply called _",
    "tractable_.    a classical result in location theory in the 1970 s is :    [ thm : tree ] if @xmath1 is a tree , then * 0-ext*@xmath8 $ ] is solvable in polynomial time .",
    "the tractability of graphs @xmath1 is preserved under taking cartesian products",
    ". therefore , cubes , grid graphs , and the cartesian product of trees are tractable .",
    "chepoi  @xcite extended this classical result to median graphs as follows .",
    "have two medians @xmath44 , and ( c ) @xmath45 have no median ]    a _ median _ of a triple @xmath46 of vertices is a vertex @xmath40 satisfying @xmath47 for @xmath48 .",
    "median graph _ is a graph in which every triple of vertices has a _",
    "unique _ median .",
    "trees and their products are median graphs",
    ". see figure  [ fig : median_graph ] for illustration of the median concept .",
    "[ thm : median ] if @xmath1 is a median graph , then * 0-ext*@xmath8 $ ] is solvable in polynomial time .",
    "karzanov  @xcite introduced the following lp - relaxation of * 0-ext*@xmath8 $ ] .",
    "* ext*@xmath27}$ ] : : :    given @xmath9 and    @xmath49 , + : :    minimize    @xmath29    over all extensions @xmath18 of    @xmath30 .",
    "this relaxation * ext*@xmath8 $ ] is a linear program with size polynomial in the input size .",
    "therefore , if for every input @xmath50 , * ext*@xmath8 $ ] has an optimal solution that is a @xmath0-extension , then * 0-ext*@xmath8 $ ] is solvable in polynomial time . in this case",
    "we say that _ * ext*@xmath8 $ ] is exact_. in the same paper , karzanov gave a combinatorial characterization of graphs @xmath1 for which * ext*@xmath8 $ ] is exact .",
    "a graph @xmath1 is called a _ frame _",
    "if    @xmath1 is bipartite ,    @xmath1 has no isometric cycle of length greater than @xmath51 , and    @xmath1 has an orientation @xmath52 with the property that for every 4-cycle @xmath53 , one has @xmath54 if and only if @xmath55 .",
    "[ eqn : frame ]    here an _ isometric cycle _ in @xmath1 means a cycle @xmath56 such that every pair of vertices in @xmath56 has a shortest path for @xmath1 in this cycle @xmath56 , and @xmath57 means that edge @xmath58 is oriented from @xmath59 to @xmath60 by @xmath52 .",
    "[ thm : minimizable ] * ext*@xmath8 $ ] is exact if and only if @xmath1 is a frame .",
    "[ thm : frame ] if @xmath1 is a frame , then * 0-ext*@xmath8 $ ] is solvable in polynomial time .",
    "it is noted that the class of frames is _ not _ closed under taking cartesian products , whereas the tractability of graphs is preserved under taking cartesian products .",
    "also it should be noted that * ext*@xmath8 $ ] is the lp - dual to the @xmath61-weighted maximum _ multiflow _ problem , and * 0-ext*@xmath8 $ ] describes a combinatorial dual problem  @xcite ; see also  @xcite for further elaboration of this duality .",
    "karzanov  @xcite also proved the following hardness result .",
    "for an undirected graph @xmath1 , an orientation with the property ( [ eqn : frame ] )  ( 3 ) is said to be _",
    "@xmath1 is said to be _",
    "orientable _ if it has an admissible orientation .",
    "@xmath1 is said to be _ modular _ if every triple of vertices has a ( not necessarily unique ) median .",
    "[ thm : hard ] if @xmath1 is not orientable or not modular , then * 0-ext*@xmath8 $ ] is np - hard .    in fact",
    ", a frame is precisely an orientable modular graph with the hereditary property that every isometric subgraph is modular ; see @xcite .",
    "a median graph is an orientable modular graph but the converse is not true .",
    "moreover , a median graph is not necessarily a frame , and a frame is not necessarily a median graph . in @xcite , karzanov proved a tractability theorem extending theorem  [ thm : median ] .",
    "he conjectured that * 0-ext*@xmath8 $ ] is tractable for a certain _ proper _ subclass of orientable modular graphs including frames and median graphs .",
    "he also conjectured that * 0-ext*@xmath8 $ ] is np - hard for any graph @xmath1 not in this class .",
    "the main result of this paper is the tractability theorem for _ all _ orientable modular graphs .",
    "thus the class of tractable graphs is larger than his expectation .",
    "[ thm : main ] if @xmath1 is orientable modular , then * 0-ext*@xmath8 $ ] is solvable in polynomial time .    combining this result with theorem  [ thm : hard ]",
    ", we obtain a complete classification of the graphs @xmath1 for which * 0-ext*@xmath8 $ ] is solvable in polynomial time .",
    "[ [ overview . ] ] overview .",
    "+ + + + + + + + +    in proving theorem  [ thm : main ] , we employ an axiomatic approach to optimization in orientable modular graphs .",
    "this approach is inspired by the theory of discrete convex analysis developed by murota and his collaborators ( including fujishige , shioura , and tamura ) ; see @xcite and also ( * ? ? ? *",
    "chapter vii ) .",
    "discrete convex analysis is a theory of convex functions on integer lattice @xmath62 , with the goal of providing a unified framework for polynomially solvable combinatorial optimization problems including network flows , matroids , and submodular functions .",
    "the theory that we are going to develop here is , in a sense , _ a theory of discrete convex functions on orientable modular graphs _",
    ", with the goal of providing a unified framework for polynomially solvable 0-extension problems and related multiflow problems .",
    "we believe that our theory establishes a new link between previously unrelated fields , broadens the scope of discrete convex analysis , and opens a new perspective and new research directions .",
    "let us start with a simple observation to illustrate our basic idea .",
    "consider a path @xmath63 of length @xmath40 , and consider * 0-ext*@xmath64 $ ] , where @xmath63 is trivially an orientable modular graph .",
    "then * 0-ext*@xmath64 $ ] for input @xmath65 can be regarded as an optimization problem on the integer lattice @xmath62 as follows .",
    "suppose that @xmath66 , and @xmath6 and @xmath67 are adjacent for @xmath68 .",
    "then @xmath69 , and * 0-ext*@xmath64 $ ] is equivalent to the minimization of the function @xmath70 over all @xmath71^n \\cap \\zz^n$ ] .",
    "this function is a simple instance of _ l@xmath72-convex functions _",
    ", one of the fundamental classes of discrete convex functions .",
    "we do not give a formal definition of l@xmath72-convex functions here .",
    "the only important facts for us are the following properties of l@xmath72-convex functions in optimization :    * local optimality implies global optimality .",
    "* the local optimality can be checked by _",
    "submodular function minimization_. * an efficient descent algorithm can be designed based on successive application of submodular function minimization .    as is well - known",
    ", submodular functions can be minimized in polynomial time  @xcite . actually the function ( [ eqn : typical ] ) can be minimized by successive application of minimum - cut computation  @xcite , a special case of submodular function minimization .    motivated by this observation , we regard * 0-ext*@xmath8 $ ] as a minimization of a function defined on the vertex set of a product of @xmath1 , which is also orientable modular .",
    "we will introduce a class of functions , called _ l - convex functions _",
    ", on an orientable modular graph .",
    "we show that our l - convex function satisfies analogues of ( a ) , ( b ) and ( c ) above , and also that a multifacility location function , the objective function of * 0-ext*@xmath8 $ ] , is an l - convex function , in our sense , on the product of @xmath1 .",
    "theorem  [ thm : main ] is a consequence of these properties .",
    "let us briefly mention how to define l - convex functions , which constitutes the main body of this paper .",
    "our definition is based on the _ lovsz extension _",
    "@xcite , a well - known concept in submodular function theory  @xcite , and a kind of construction of polyhedral complexes , due to karzanov  @xcite and chepoi  @xcite , from a class of modular graphs .",
    "let @xmath1 be an orientable modular graph with admissible orientation @xmath52 .",
    "we call a pair @xmath73 a _ modular complex_. it turns out that @xmath73 can be viewed as a structure glued together from modular lattices , and gives rise to a simplicial complex as follows . consider a cube subgraph @xmath74 of @xmath1 . the digraph @xmath75 oriented by @xmath52 coincides with the hasse diagram of a boolean lattice .",
    "consider the simplicial complex @xmath76 whose simplices are sets of vertices forming a chain of the boolean lattice corresponding to some cube subgraph of @xmath1 ; see figure  [ fig : modular_complex ] .    ]",
    "each ( abstract ) simplex is naturally regarded as a simplex in the euclidean space .",
    "@xmath76 is naturally regarded as a metrized simplicial complex .",
    "then any function @xmath77 is extended to @xmath78 by interpolating @xmath79 on each simplex linearly ; this is an analogue of the lovsz extension .",
    "the simplicial complex @xmath76 enables us to consider the _ neighborhood _",
    "@xmath80 around each vertex @xmath81 , as well as the local behavior of @xmath82 in @xmath83 .        as in figure",
    "[ fig : neighborhood ] , neighborhood @xmath84 can be described as a partially ordered set with the unique minimal element @xmath60 .",
    "then , by restricting @xmath82 to @xmath84 , we obtain a function on @xmath84 associated with each vertex @xmath60 . in fact , the poset @xmath84 is a _ modular semilattice _ , a semilattice analogue of a modular lattice introduced by bandelt , van de vel , and verheul  @xcite .",
    "we first define _ submodular functions on modular semilattices _ , and next define _",
    "l - convex functions on modular complex @xmath85 _ as functions @xmath79 on @xmath4 such that @xmath82 is submodular on neighborhood semilattice @xmath84 for each vertex @xmath60 .",
    "then the multifacility location function , the objective of * 0-ext*@xmath8 $ ] ( see ( [ eqn : multifac ] ) ) , is indeed an l - convex function on the @xmath34-fold product of @xmath1 , and the optimal solution of * 0-ext*@xmath8 $ ] can be obtained by successive application of submodular function minimization on the product of @xmath34 modular semilattices .",
    "thus our problem reduces to the problem of minimizing submodular function @xmath86 on the product of modular semilattices @xmath87 , where the input of the problem is @xmath88 , and an evaluating oracle of @xmath86 .",
    "we do not know whether this problem in general is tractable in the oracle model , but the submodular functions arising from * 0-ext*@xmath8 $ ] take a special form ; they are _ the sum of submodular functions with arity @xmath89_. here the _ arity _ of a function @xmath86 is the number of variables of @xmath86 .",
    "namely , if a function @xmath86 on @xmath90 is represented as @xmath91 for some function @xmath92 on @xmath93 with @xmath94 , then the arity of @xmath86 is ( at most ) @xmath95 .",
    "see ( [ eqn : multifac ] ) ; our objective function is a weighted sum of distance functions , which have arity @xmath89 .",
    "this type of optimization problem with bounded arity is well - studied in the literature of _ valued csp _ ( _ valued constraint satisfaction problem _ )  @xcite .",
    "valued csp deals with minimization of a sum of functions @xmath96 @xmath97 , where the arity @xmath98 of each @xmath96 is a part of the input ; namely the input consists of all values of all functions @xmath96 .",
    "valued csp admits an integer programming formulation , and its natural lp relaxation is called the _",
    "basic lp - relaxation_. recently , thapper and ivn  @xcite discovered a surprising criterion for the basic lp - relaxation of valued csp to exactly solve the original valued csp instance .",
    "they proved that if the class of valued csp ( the class of input objective functions ) has a certain nice _ fractional polymorphism _ ( a certain set of linear inequalities which any input function satisfies ) , then the basic lp - relaxation is exact .",
    "we prove that the class of submodular functions on modular semilattice admits such a fractional polymorphism .",
    "then the sum of submodular functions with bounded arity can be minimized in polynomial time .",
    "consequently we can solve * 0-ext*@xmath8 $ ] in polynomial time .",
    "we believe that our classes of functions deserve to be called submodular and l - convex .",
    "indeed , they include not only ( ordinary ) submodular / l - convex functions but also other submodular / l - convex - type functions .",
    "examples are _ bisubmodular functions _",
    "@xcite ( see ( * ? ? ?",
    "* section 3.5 ) ) , _ multimatroid rank functions _ by bouchet  @xcite , _ submodular functions on trees _ by kolmogorov  @xcite , _ @xmath95-submodular functions _ by huber and kolmogorov  @xcite ( also see  @xcite ) , and _ skew - bisubmodular functions _ by huber , krokhin and powell  @xcite ( also see  @xcite ) .",
    "moreover , combinatorial dual problems arising from a large class of ( well - behaved ) multicommodity flow problems , discussed in  @xcite , fall into submodular / l - convex function minimization in our sense .",
    "this can be understood as a multiflow analogue of a fundamental fact in network flow theory : the minimum cut problem , the dual of maxflow problem , is a submodular function minimization . the detailed discussion on these topics will be given in a separate paper  @xcite ; some of the results were announced by  @xcite .",
    "[ [ organization . ] ] organization .",
    "+ + + + + + + + + + + + +    in section  [ sec : preliminaries ] , we first explain basic notions of valued csp and the thapper - ivn criterion ( theorem  [ thm : tz ] ) on the exactness of the basic lp relaxation .",
    "we then describe basic facts on modular graphs and modular lattices . in section  [ sec : submo ] , we develop a theory of submodular functions on modular semilattices .",
    "we show that our submodular function satisfies the thapper - ivn criterion , and that a sum of submodular functions with bounded arity can be minimized in polynomial time . in section  [ sec : l - convex ] , we first explore several structural properties of orientable modular graphs . based on the above mentioned idea ,",
    "we define l - convex functions , and prove that our l - convex functions indeed have properties analogous to ( a ) , ( b ) and ( c ) above . in section  [ sec:0extension ] , we formulate * 0-ext*@xmath8 $ ] as an optimization problem on a modular complex .",
    "we show that a multifacility location function , the objective function of * 0-ext*@xmath8 $ ] , is indeed an l - convex function , and we prove theorem  [ thm : main ] .",
    "our framework is applicable to a certain weighted version of * 0-ext*@xmath8 $ ] . as a corollary",
    ", we give a generalization of theorem  [ thm : main ] to general metrics , which completes classification of metrics @xmath99 for which the 0-extension problem on @xmath99 is polynomial time solvable ( theorem  [ thm : main_mu ] ) . in the last section ( section  [ sec : concluding ] )",
    ", we discuss a connection to a dichotomy theorem of finite - valued csp obtained by thapper and ivn  @xcite after the first submission of this paper .",
    "in fact , the complexity dichotomy ( of form  either p or np - hard \" ) of * 0-ext * , established in this paper , can be viewed as a special case of their dichotomy theorem of finite - valued csp .    [ [ notation . ] ]",
    "+ + + + + + + + +    let @xmath100 , and @xmath101 denote the sets of integers , rationals , and reals , respectively .",
    "let @xmath102 and @xmath103 , where @xmath104 is an infinity element and is treated as : @xmath105 , @xmath106 @xmath107 , @xmath108 @xmath109 , @xmath110 @xmath111 . let @xmath112 , and @xmath113 denote the sets of nonnegative integers , nonnegative rationals , and nonnegative reals , respectively .",
    "for a function @xmath114 on a set @xmath115 , let @xmath116 denote the set of elements @xmath117 with @xmath118 .    for a graph @xmath1 , the vertex set and the edge set",
    "are denoted by @xmath4 and @xmath119 , respectively . for a vertex subset @xmath115 , @xmath120 $ ]",
    "denotes the subgraph of @xmath1 induced by @xmath115 . for a nonnegative edge - length @xmath121",
    ", @xmath122 denotes the shortest path metric on @xmath4 with respect to the edge - length @xmath92 .",
    "when @xmath123 for every edge @xmath124 , @xmath125 is denoted by @xmath61 .",
    "a path is represented by a chain @xmath126 of vertices with @xmath127 .",
    "the _ cartesian product _ @xmath128 of graphs @xmath1 and @xmath129 is the graph with vertex set @xmath130 and edge set given as : @xmath131 and @xmath132 are connected by an edge if and only if @xmath133 and @xmath134 or @xmath135 and @xmath136 . the @xmath34-fold cartesian product @xmath137 of @xmath1 is denoted by @xmath138 . in this paper , graphs and posets ( partially ordered sets ) are supposed to be finite .",
    "in this section , we give preliminary arguments for valued csp , and modular graphs and modular ( semi)lattices .",
    "our references are @xcite for valued csp and @xcite for modular graphs and lattices . a further discussion on valued csp is given in section  [ sec : concluding ] .",
    "let @xmath139 be finite sets , and let @xmath140 .",
    "a _ constraint _ on @xmath141 is a function @xmath142 for some @xmath94 , where @xmath143 is called the _ scope _ of @xmath86 , and @xmath144",
    "is called the _ arity _ of @xmath86 .",
    "let @xmath145 , and for @xmath146 , let @xmath147 .",
    "the _ valued csp _ ( _ valued constraint satisfaction problem _ ) is :    vcsp : : :    given a set @xmath148 of constraints on @xmath141 , : :    minimize @xmath149    over all @xmath146 .",
    "the input of vcsp is the set of all values of all constraints in @xmath148 , and hence its size is estimated by @xmath150 , where @xmath151 , @xmath152 , and @xmath74 is the bit size to represent constraints in @xmath148 . by a _ constraint language _ we mean a ( possibly infinite ) set @xmath153 of constraints . a constraint in @xmath153",
    "is called a _",
    "@xmath153-constraint_. let * vcsp*@xmath154 $ ] denote the subclass of * vcsp * such that the input is restricted to a set of @xmath153-constraints .",
    "the minimum 0-extension problem * 0-ext*@xmath8 $ ] is formulated as an instance of * vcsp*. let @xmath155 for @xmath156 .",
    "define constraints @xmath157 and @xmath158 by @xmath159 define the input @xmath148 of * vcsp * by @xmath160 notice that the size of @xmath148 is polynomial in @xmath34 , @xmath1 , and the bit size representing @xmath10 .",
    "hence * 0-ext*@xmath8 $ ] is a particular subclass of * vcsp*.    * vcsp * admits the following integer programming formulation : @xmath161 indeed , for each @xmath162 there uniquely exists @xmath163 with @xmath164 . also for @xmath165 there uniquely exists @xmath166 such that @xmath167 and @xmath168 for @xmath169 .",
    "define @xmath170 by @xmath171 .",
    "then @xmath167 if and only if @xmath172 .",
    "therefore we obtain a solution @xmath170 of * vcsp * with the same objective value .",
    "conversely , for a solution @xmath170 of * vcsp * , define @xmath173 if @xmath174 , and @xmath175 if @xmath172 .",
    "the other variables are defined as zero .",
    "then we obtain a solution of ( [ eqn : ip ] ) with the same objective value .",
    "observe that there are @xmath176 variables and @xmath177 constraints .",
    "therefore the size of this ip is bounded by a polynomial of the input size .",
    "the _ basic lp relaxation _ ( blp ) is the linear problem obtained by relaxing the 0 - 1 constraints @xmath178 and @xmath179 into @xmath180 and @xmath181 , respectively . in particular blp",
    "can be solved in ( strongly ) polynomial time .",
    "recently thapper and ivn  @xcite discovered a surprisingly powerful criterion for which blp solves * vcsp*. to describe their result , let us introduce some notions . for a constraint language @xmath153 , blp is said be _ exact _ for @xmath182 if for every input @xmath183 , the optimal value of blp coincides with the optimal value of * vcsp*@xmath154 $ ] . an _ operation _ on @xmath184 is a function @xmath185 .",
    "a ( separable ) operation @xmath186 on @xmath141 is a function @xmath187 such that @xmath186 is represented as @xmath188 for some operations @xmath189 on @xmath184 for @xmath156 .",
    "a _ fractional operation _",
    "@xmath190 is a function from the set of all operations to @xmath191 such that the total sum @xmath192 over all operations @xmath186 is @xmath193 .",
    "we denote a fractional operation @xmath190 by the form of a _ formal convex combination _ @xmath194 of operations @xmath186 .",
    "the _ support _ of @xmath190 is the set of operations @xmath186 with @xmath195 . for a constraint language @xmath153 , a _",
    "fractional polymorphism _ is a fractional operation @xmath196 on @xmath141 such that it satisfies @xmath197 where @xmath186 is regarded an operation on @xmath198 by @xmath199 for @xmath169 .",
    "for example , if @xmath184 is a lattice for each @xmath162 , then @xmath200 is nothing but a fractional polymorphism for submodular functions , i.e. , functions @xmath86 satisfying @xmath201 for @xmath202 .",
    "[ thm : tz ] if a constraint language @xmath153 admits a fractional polymorphism @xmath190 such that the support of @xmath190 contains a semilattice operation , then blp is exact for @xmath153 , and hence * vcsp*@xmath154 $ ] can be solved in polynomial time .    here",
    "semilattice operation _ is an operation @xmath186 satisfying @xmath203 , @xmath204 , and @xmath205 for @xmath206 .",
    "although the feasible region of blp is not necessarily an integral polytope , we can check whether there exists an optimal solution @xmath207 with @xmath208 by comparing the optimal values of blp for the input @xmath148 and for @xmath209 , which is the set of cost functions obtained by fixing variable @xmath210 to @xmath211 for each cost function on @xmath148 .",
    "necessarily blp is exact for @xmath209 if there is an optimal solution @xmath207 with @xmath174 .",
    "hence , after @xmath34 fixing procedures , we obtain an optimal solution @xmath207 .    in the setting in  @xcite",
    ", @xmath184 is the same set @xmath212 for all @xmath162 .",
    "our setting reduces to this case by taking the disjoint union of @xmath184 as @xmath212 , and extending each cost function @xmath213 to @xmath214 by @xmath215 for @xmath216 . without such a reduction",
    ", their proof also works for our setting in a straightforward way .      for a metric space @xmath217 , the _ ( metric )",
    "interval _ @xmath218 of @xmath219 is defined as @xmath220 for two subsets @xmath221 , @xmath222 denotes the infimum of distances between @xmath223 and @xmath74 , i.e. , @xmath224 for @xmath225 , an element @xmath40 in @xmath226 is called _ a median _ of @xmath227 , @xmath228 , and @xmath229 . a metric space @xmath217",
    "is said to be _ modular _ if every triple of elements in @xmath115 has a median .",
    "in particular , a graph @xmath1 is modular if and only if the shortest path metric space @xmath230 is modular .",
    "we will often use the following characterization of modular graphs .",
    "[ lem : quadrangle ] a connected graph @xmath231 is modular if and only if    * @xmath231 is bipartite , and * for vertices @xmath232 and neighbors @xmath233 of @xmath60 with @xmath234 , there exists a common neighbor @xmath235 of @xmath233 with @xmath236 .",
    "the condition ( 2 ) is called the _ quadrangle condition _",
    "@xcite ( or the _ semimodularity condition _ in @xcite ) .    [ lem : acyclic ] for a modular graph , every admissible orientation is acyclic .",
    "suppose indirectly that the statement is false .",
    "take a vertex @xmath60 belonging to a directed cycle , and take a directed cycle @xmath56 containing @xmath60 with @xmath237 minimum .",
    "the length @xmath95 of @xmath56 is at least four",
    "( by simpleness and bipartiteness ) . by the definition of admissible orientation , @xmath238 is impossible .",
    "hence @xmath239 .",
    "take a vertex @xmath59 in @xmath56 with @xmath240 maximum .",
    "take two neighbors @xmath241 of @xmath59 in @xmath56 .",
    "then @xmath242 ( by the maximality of @xmath59 and the bipartiteness of @xmath1 ) . by the quadrangle condition",
    ", there is a common neighbor @xmath243 of @xmath241 with @xmath244 . here",
    "the cycle @xmath245 obtained from @xmath56 by replacing @xmath59 by @xmath243 is a directed cycle , since the orientation is admissible .",
    "then we have @xmath246 .",
    "this contradicts the minimality of @xmath56 .",
    "[ subsec : orbits ] let @xmath1 be a modular graph .",
    "edges @xmath124 and @xmath247 are said to be _ projective _ if there is a sequence @xmath248 of edges such that @xmath249 and @xmath250 belong to a common 4-cycle and share no common vertex .",
    "we will use the following criterion for two edges to belong to a common orbit .",
    "[ lem : commonorbit ] let @xmath1 be a modular graph . for edges",
    "@xmath58 and @xmath251 , suppose that @xmath252 and @xmath253 .",
    "* @xmath58 and @xmath251 are projective . * in addition , if @xmath1 has an admissible orientation @xmath52 , then @xmath254 implies @xmath255 .",
    "we use the induction on @xmath256 .",
    "the case of @xmath257 is obvious .",
    "take a neighbor @xmath235 of @xmath60 with @xmath258 .",
    "then @xmath259 . by the quadrangle condition for @xmath260",
    ", there is a common neighbor @xmath261 of @xmath262 with @xmath263 .",
    "also @xmath264 .",
    "obviously @xmath58 and @xmath265 are projective , and @xmath254 implies @xmath266 .",
    "apply the induction for @xmath265 and @xmath251 .",
    "an _ orbit _ is an equivalence class of the projectivity relation .",
    "the ( disjoint ) union of several orbits is called an _ orbit - union_. for an orbit - union @xmath267 , @xmath268 is the graph obtained by contracting all edges _ not _ in @xmath267 and by identifying multiple edges .",
    "the vertex in @xmath269 corresponding to @xmath81 is denoted by @xmath270 .",
    "the graph @xmath269 is also modular , and any shortest path in @xmath1 induces a shortest path in @xmath269 as follows .",
    "[ lem : orbits ] let @xmath1 be a modular graph , and @xmath267 an orbit - union .",
    "* @xmath271 is a modular graph .",
    "* for every @xmath272 , every shortest @xmath273-path @xmath274 , and every @xmath273-path @xmath275 , we have @xmath276 . * for every @xmath272 and every shortest @xmath273-path @xmath274 ,",
    "the image @xmath277 of @xmath274 is a shortest @xmath278-path in @xmath269 .",
    "in particular , for any partition @xmath279 of @xmath119 into orbit - unions , we have @xmath280 a function @xmath92 on edge set",
    "@xmath119 is called _ orbit - invariant _ if @xmath281 provided @xmath124 and @xmath247 belong to the same orbit . for an orbit @xmath282 ,",
    "let @xmath283 denote the value of @xmath92 on @xmath282 .",
    "an orbit - invariant function @xmath92 is said to be _ nonnegative _ if @xmath284 for @xmath285 , and is said to be _ positive _ if @xmath286 for @xmath285 . for a constant @xmath287 ,",
    "if @xmath288 for all edges @xmath124 , then @xmath92 is simply denoted by @xmath10 ; in particular @xmath289 . by taking the value of @xmath92 of the preimage , we can define a function on the edge set of @xmath269 for any orbit - union @xmath267 , which is also orbit - invariant in @xmath269 and is denoted by @xmath92 . by lemma  [ lem : orbits ]  ( 2 ) , the shortest path structures of @xmath230 and @xmath290 are the same in the following sense :    [ lem : shortest ] if an orbit - invariant function @xmath92 is nonnegative , then @xmath291 implies @xmath292 , where    * @xmath274 is a shortest @xmath273-path with respect to @xmath193 , * @xmath274 is a shortest @xmath273-path with respect to @xmath92 .",
    "if @xmath92 is positive , then the converse also holds .    as a consequence of lemmas  [ lem : orbits ] and [ lem : shortest ] , for any partition @xmath279 of @xmath119 into orbit - unions , we have @xmath293      let @xmath217 be a metric space .",
    "a subset @xmath294 is called _ convex _ if @xmath295 for every @xmath296 .",
    "a subset @xmath294 is called _ gated _ if for every @xmath297 there is @xmath298 , called a _ gate _ of @xmath60 at @xmath299 , such that @xmath300 holds for every @xmath301 .",
    "one can easily see that gate @xmath302 is uniquely determined for each @xmath60  @xcite .",
    "therefore we obtain a map @xmath303 by defining @xmath304 to be the gate of @xmath60 at @xmath299 .",
    "[ thm : gatedset ] let @xmath223 and @xmath305 be gated subsets of @xmath217 and let @xmath306 and @xmath307 .    * @xmath308 and @xmath309 induce isometries , inverse to each other , between @xmath310 and @xmath74 . * for @xmath311 and @xmath312 , the following conditions are equivalent : * * @xmath313 .",
    "* * @xmath314 and @xmath315 . * @xmath74 and @xmath310 are gated , and @xmath316 and @xmath317 .",
    "as remarked in @xcite , every gated set is convex ( see the proof of lemma  [ lem:2convexity ] below ) .",
    "the converse is not true in general , but is true for modular graphs .",
    "the following useful characterization of convex ( gated ) sets in a modular graph is due to chepoi  @xcite . here , for a graph @xmath1 , a subset @xmath299 of vertices",
    "is said to be convex ( resp .",
    "gated ) if @xmath299 is convex ( resp .",
    "gated ) in @xmath230 .",
    "[ lem:2convexity ] let @xmath231 be a modular graph .",
    "for @xmath318 , the following conditions are equivalent :    * @xmath299 is convex .",
    "* @xmath299 is gated . *",
    "@xmath319 $ ] is connected and @xmath295 holds for every @xmath296 with @xmath320 .",
    "we give a proof for the convenience of readers as the original paper is in russian .",
    "@xmath61 is denoted by @xmath2 .",
    "( 1 ) @xmath321 ( 3 ) is obvious .",
    "we show ( 3 ) @xmath321 ( 1 ) .",
    "take @xmath296 , and take @xmath322 .",
    "we are going to show @xmath323 . since @xmath324 $ ]",
    "is connected , we can take a path @xmath325 with @xmath326 .",
    "take such a path @xmath274 with @xmath327 minimum .",
    "if @xmath328 for some @xmath162 , then , by the quadrangle condition in lemma  [ lem : quadrangle ] , there is a common neighbor @xmath235 of @xmath329 with @xmath330 .",
    "since @xmath331 by ( 3 ) , @xmath235 belongs to @xmath299 .",
    "then we can replace @xmath332 by @xmath235 in @xmath274 to obtain another path @xmath275 connecting @xmath232 with @xmath333 ; a contradiction to the minimality .",
    "therefore there is no index @xmath334 with @xmath335 .",
    "thus there is a unique index @xmath162 with @xmath336 minimum .",
    "then we have @xmath337 and @xmath338 . by @xmath322",
    ", we have @xmath339 .",
    "hence we must have @xmath340 , implying @xmath341 .",
    "we show ( 2 ) @xmath321 ( 1 ) .",
    "as already mentioned , any gated set is convex . indeed , suppose that @xmath299 is gated .",
    "take @xmath296 , and take @xmath322 .",
    "consider the gate @xmath342 of @xmath211 in @xmath299 . then @xmath343 and @xmath344 . since @xmath322 , we have @xmath345 , implying @xmath346 and @xmath347 .",
    "thus we get ( 2 ) @xmath321 ( 1 ) .",
    "finally we show ( 1 ) @xmath321 ( 2 ) .",
    "suppose that @xmath299 is convex .",
    "let @xmath60 be an arbitrary vertex .",
    "let @xmath235 be a point in @xmath299 satisfying @xmath348 .",
    "we show that @xmath302 is a gate of @xmath60 at @xmath299 .",
    "take arbitrary @xmath301 .",
    "consider a median @xmath40 of @xmath349 . by convexity",
    ", @xmath40 belongs to @xmath299 , and also @xmath350 . by definition of @xmath235 , it must hold @xmath351 . thus @xmath352 holds for every @xmath301 .",
    "this means that @xmath302 is the gate of @xmath60 , and therefore @xmath299 is gated .",
    "let @xmath353 be a partially ordered set ( poset ) with partial order @xmath354 . for @xmath355 , the ( unique ) minimum common upper bound ,",
    "if it exists , is denoted by @xmath356 , and the ( unique ) maximum common lower bound , if it exists , is denoted by @xmath357 .",
    "@xmath353 is said to be a _ lattice _ if both @xmath356 and @xmath357 exist for every @xmath355 , and said to be a _",
    "( meet-)semilattice _ if @xmath357 exists for every @xmath355 . in a semilattice , if @xmath211 and @xmath358 have a common upper bound , then @xmath356 exists .",
    "such @xmath359 is said to be _",
    "bounded_. by the expression@xmath360 \" we mean that @xmath356 exists .",
    "a pair @xmath359 is said to be _ comparable _ if @xmath361 or @xmath362 , and _",
    "incomparable _ otherwise .",
    "we say `` _ @xmath358 covers @xmath211 _ '' if @xmath363 and there is no @xmath364 with @xmath365 , where @xmath363 means @xmath361 and @xmath366 .",
    "the maximum element ( universal upper bound ) and the minimum element ( universal lower bound ) , if they exist , are denoted by @xmath367 and @xmath368 , respectively . for @xmath361 , the interval @xmath369",
    "is denoted by @xmath370 $ ] . a _ chain _ from @xmath211 to @xmath358 is a sequence @xmath371 with @xmath372 for @xmath373 ; the number @xmath95 is the length of the chain .",
    "the length @xmath374 $ ] of the interval @xmath370 $ ] is defined as the maximum length of a chain from @xmath211 to @xmath358 .",
    "the rank @xmath375 of an element @xmath211 is defined by @xmath376 $ ] .",
    "atom _ is an element of rank @xmath193 .",
    "the _ covering graph _ of a poset @xmath353 is the underlying undirected graph of the hasse diagram of @xmath353 .",
    "a lattice @xmath353 is called _ modular _ if @xmath377 for every @xmath378 with @xmath379 .",
    "modular lattices are also characterized by the modular equality of the rank function .",
    "[ lem : modular ] a lattice @xmath353 is modular if and only if @xmath380    a lattice @xmath353 is called _ complemented _ if for every @xmath381 there is an element @xmath59 , called a _",
    "complement _ of @xmath60 , such that @xmath382 and @xmath383 , and _ relatively complemented _ if @xmath370 $ ] is complemented for every @xmath355 with @xmath361 .",
    "[ thm : complemented ] let @xmath353 be a modular lattice .",
    "the following conditions are equivalent :    * @xmath353 is complemented .",
    "* @xmath353 is relatively complemented . *",
    "every element is the join of atoms .",
    "* @xmath367 is the join of atoms .",
    "[ [ modular - semilattice . ] ] modular semilattice .",
    "+ + + + + + + + + + + + + + + + + + + +    the modularity concept has been extended for semilattices by bandelt , van de vel , and verheul  @xcite .",
    "a semilattice @xmath353 is said to be _ modular _ if @xmath384 $ ] is a modular lattice for every @xmath381 , and @xmath385 provided @xmath386 .",
    "a modular semilattice is said to be _ complemented _ if @xmath387 $ ] is a complemented modular lattice for every @xmath381 .",
    "it is known that a lattice is modular if and only if its covering graph is modular ; see ( * ? ? ?",
    "* proposition 6.2.1 ) .",
    "a modular semilattice is characterized by an analogous property as follows .",
    "[ thm : bvv ] a semilattice is modular if and only if its covering graph is modular .    the hasse diagram of @xmath353 is admissibly oriented since every 4-cycle is a form of @xmath388 .    the covering graph of a modular semilattice is orientable modular .",
    "let @xmath353 be a modular semilattice and let @xmath1 be the covering graph of @xmath353 , which is orientable modular .",
    "an immediate consequence of the jordan - dedekind chain condition for modular lattices is :    for @xmath389 with @xmath390 , we have @xmath391 $ ] and @xmath392 $ ] .",
    "[ eqn : i(pq)=[pq ] ]    a ( positive ) _ valuation _ of @xmath353 is is a function on @xmath353 satisfying @xmath393 this is a natural extension of a valuation of a modular lattice ; see ( * ? ? ?",
    "* chapter iii , 50 ) ( we follow the terminology in the third edition of this book ) . in particular",
    ", the rank function @xmath394 is a valuation .",
    "for @xmath232 with @xmath390 , let @xmath395 $ ] denote @xmath396 .",
    "valuations and orbit - invariant functions are related in the following way .",
    "[ lem : valuation ]    * for a valuation @xmath397 on @xmath353 , the edge - length @xmath92 on @xmath1 defined by @xmath398 is a positive orbit - invariant function , and satisfies @xmath399 = d_{\\mgamma , h}(p , q ) \\quad ( p , q \\in { \\cal l } : p \\preceq q).\\ ] ] * for a positive orbit - invariant function @xmath92 on @xmath1 , a function @xmath397 on @xmath353 defined by @xmath400 is a valuation .",
    "the positivity of @xmath92 follows from ( [ eqn : valuation1 ] ) .",
    "the orbit invariance of @xmath92 follows from ( [ eqn : valuation2 ] ) and the observation that every 4-cycle of @xmath1 is the form of @xmath401 , where @xmath402 covers @xmath60 and @xmath59 , and @xmath403 is covered by @xmath60 and @xmath59 .",
    "we show the latter part by induction on @xmath404 $ ] ; the case @xmath404 = 1 $ ] is obvious .",
    "take @xmath405 = i(p , q)$ ] such that @xmath406 covers @xmath60 . by induction",
    ", we have @xmath407 $ ] . by lemma  [ lem : shortest ] and ( [ eqn : i(pq)=[pq ] ] )",
    ", we have @xmath408 $ ] .",
    "( 2 ) . by lemma",
    "[ lem : shortest ] and ( [ eqn : i(pq)=[pq ] ] ) , if @xmath59 covers @xmath60 , then @xmath409 , implying ( [ eqn : valuation1 ] ) . for a bounded pair @xmath273 ,",
    "take maximal chains @xmath410 and @xmath411 .",
    "let @xmath412 .",
    "by modularity , we see that @xmath413 covers @xmath414 and @xmath415 , and @xmath416 is covered by @xmath414 and @xmath415 ; in particular @xmath417 and @xmath418 . therefore @xmath419 . by the orbit invariance of @xmath92 , all summands are zero , implying ( [ eqn : valuation2 ] ) .",
    "consider the case where @xmath353 is the product @xmath420 of two modular semilattices @xmath421 .",
    "for a valuation @xmath397 on @xmath353 , define @xmath422 @xmath423 by @xmath424 then @xmath425 is a valuation on @xmath426 for @xmath427 , and satisfies @xmath428 conversely , for a valuation @xmath425 on @xmath426 @xmath423 , define @xmath429 by @xmath430 then @xmath397 is a valuation on @xmath353 .    in the sequel ,",
    "a modular semilattice @xmath353 is supposed to be endowed with some valuation @xmath397 .",
    "if @xmath353 is the product of modular semilattices @xmath426 , then the valuation of each @xmath426 is defined by ( [ eqn : valuation_summand ] ) , and is also denoted by @xmath397 . for modular semilattices @xmath431 and @xmath432 , the valuation @xmath397 of @xmath420 is defined to be the sum of valuations of @xmath431 and @xmath432 according to ( [ eqn : valuation_sum ] ) . also a modular semilattice @xmath353 is regarded as a metric space by the shortest path metric of its covering graph @xmath1 with respect to a positive orbit - invariant function in lemma  [ lem : valuation ]  ( 1 ) .",
    "the corresponding metric function is denoted by @xmath433 .",
    "we give basic properties of metric intervals of @xmath353 .",
    "[ lem : i(p , q ) ] for @xmath389 , we have the following .",
    "* @xmath434 + v[p \\wedge q , q]$ ] . * @xmath435 , b \\in [ p \\wedge q , q ] : \\mbox{$a \\vee b$ exists } \\}$ ] . *",
    "if @xmath436 for @xmath437 , b \\in [ p \\wedge q , q]$ ] , then @xmath438 and @xmath439 . * for @xmath440 , it holds @xmath441 ; in particular @xmath442 .    the properties ( 1 ) , ( 2 ) , and ( 3 ) appeared ( implicitly ) in @xcite .",
    "by lemmas  [ lem : shortest ] and [ lem : valuation ] , we can assume that valuation @xmath397 is equal to the rank function @xmath394 .",
    "( 3 ) . necessarily",
    "@xmath443 and @xmath444 , implying @xmath445 .",
    "hence @xmath446 . also @xmath447 ( since @xmath448 ) . by the modularity equality",
    ", we have @xmath449 , which implies @xmath450 = r[b , q \\wedge c ] = 0 $ ] .",
    "thus @xmath451 and @xmath452 must hold .",
    "we use the induction on @xmath453 . take a neighbor @xmath454 of @xmath59 in @xmath455 . by induction @xmath456 + r[p \\wedge q',q']$ ] , and either ( i ) @xmath59 covers @xmath454 or ( ii )",
    "@xmath454 covers @xmath59 . in the first case ( i )",
    ", we must have @xmath457 .",
    "suppose not .",
    "then @xmath458 , and @xmath459 .",
    "the modularity equality yields @xmath460 = r[p \\wedge q',q']$ ] , which means that there is a @xmath273-path passing through @xmath403 with the length shorter than @xmath461 , contradicting @xmath462 .",
    "it follows from @xmath457 that @xmath463 , and the claim follows . in the second case ( ii ) where @xmath454 covers @xmath59 , @xmath464 covers @xmath403 ; since otherwise @xmath465 which leads to a contradiction @xmath466 . by the modularity equality @xmath467 = r[p \\wedge q , q]$ ] and",
    "the claim follows .",
    "( 2 ) . by ( 1 ) , @xmath468 . by the modularity equality we have @xmath469 .",
    "we show the reverse inclusion .",
    "take @xmath470 .",
    "let @xmath471 and @xmath472 . by ( 1 ) ,",
    "necessarily @xmath474 , and @xmath475 + r[b , u]$ ] . since @xmath476 + r[a \\wedge b , b ]   = r[a , a \\vee b ] + r[b , a \\vee b ] = d(a , b ) - 2 r[a \\vee b , u]$ ] , we have @xmath477 = 0 $ ] , implying @xmath478",
    ". also @xmath479 must hold . hence @xmath480",
    "+ r[a \\wedge b , q ] = d(p , q ) + 2 r[a \\wedge b , p \\wedge q]$ ] .",
    "this implies @xmath481 , and @xmath482 $ ] and @xmath483 $ ] .    ( 4 ) .",
    "first we note that @xmath455 is an isometric subspace ( with respect to @xmath394 ) . indeed , for @xmath484 , by theorem",
    "[ thm : bvv ] , there is a median @xmath40 of @xmath485 .",
    "in particular @xmath486 .",
    "so @xmath487 .",
    "this means that @xmath488 and @xmath489 are joined by a path in @xmath455 of length @xmath490 . by ( 2 ) and ( 3 )",
    ", if @xmath488 covers @xmath489 , then @xmath491 covers @xmath492 and @xmath493 , or @xmath494 covers @xmath495 and @xmath496 .",
    "thus a shortest path @xmath274 between @xmath497 and @xmath498 in @xmath455 induces a path @xmath275 between @xmath471 and @xmath499 ( by map @xmath500 ) and a path @xmath501 between @xmath472 and @xmath502 ( by map @xmath503 ) .",
    "the length of @xmath274 is the sum of lengths of @xmath275 and of @xmath501 .",
    "this implies that @xmath504,\\end{aligned}\\ ] ] where the second equality follows from the modularity equality with @xmath505 and the third follows from ( 1 ) .",
    "hence @xmath506 , as required .    a subset @xmath115 of @xmath353",
    "is called a _ subsemilattice _ if @xmath507 for any @xmath508 , and is called _ convex _ if @xmath115 is a convex set in @xmath1 . for an edge - set @xmath267 , define @xmath509 by @xmath510    [ lem : interval ]    * any convex set in @xmath353 is a modular subsemilattice of @xmath353 . *",
    "suppose that @xmath353 is a lattice .",
    "then a subset @xmath56 is convex if and only if @xmath511 $ ] for some @xmath355 with @xmath361 . *",
    "suppose that @xmath353 is complemented .",
    "for an orbit - union @xmath267 , @xmath512 is convex , and is a complemented modular subsemilattice of @xmath353 . for @xmath381 , define @xmath513 by @xmath514 then @xmath515 , and any shortest path between @xmath60 and @xmath516 does not meet @xmath267 .",
    "\\(1 ) follows from lemma  [ lem : i(p , q ) ] .",
    "the if part of ( 2 ) also follows from lemma  [ lem : i(p , q ) ] . to see the only if part of ( 2 ) , consider @xmath517 and @xmath518 . then @xmath519 $ ] . from @xmath520",
    ", we have @xmath370   = i(a , b ) \\subseteq c$ ] .    ( 3 ) . for @xmath521",
    ", there is a shortest path from @xmath368 to @xmath60 ( or @xmath59 ) passing through @xmath403 .",
    "this means @xmath522 , [ p \\wedge q , q ] \\subseteq { \\cal l}|u$ ] . by lemma  [ lem : i(p , q ) ] and lemma  [ lem : orbits ]  ( 2 )",
    ", it holds that @xmath523 .",
    "hence @xmath512 is convex , and is a modular subsemilattice by ( 1 ) . since @xmath524 = i(p ,",
    "q ) \\subseteq { \\cal l}|u$ ] for @xmath521 with @xmath390 , every interval of @xmath512 is complemented . by @xmath525 and the definition of gates",
    ", we have @xmath526 $ ] .",
    "hence @xmath515 .",
    "suppose that there is a shortest path from @xmath516 to @xmath60 having an edge @xmath37 in @xmath267 .",
    "suppose that @xmath6 is covered by @xmath527 . by the relative complementarity of @xmath528 $ ] , there is @xmath529 such that @xmath530 and @xmath531",
    ". then @xmath529 covers @xmath516 .",
    "so @xmath532 and @xmath533 hold . in particular , edges @xmath37 and @xmath534 are projective ( lemma  [ lem : commonorbit ] ) .",
    "thus @xmath535 , and @xmath536 .",
    "by definition of gates , we have @xmath537 , contradicting @xmath533 .",
    "in this section , we develop a theory of submodular functions on modular semilattices .",
    "a modular semilattice @xmath353 is not necessarily a lattice .",
    "join @xmath402 of elements @xmath538 may or may not exist .",
    "interestingly , we can define a certain kind of a join , called a _ fractional join _ , which is a formal convex combination of elements of a set @xmath539 determined by @xmath540 : @xmath541 if @xmath538 have the join @xmath402 , then the fractional join is equal to @xmath542 . in section  [ subsec : frac_join ] , the set @xmath543 and the coefficient @xmath544 are introduced .",
    "then , in section  [ subsec : submodular ] , a function @xmath545 is defined to be a _",
    "submodular function _",
    "if it satisfies @xmath546 the main properties of our submodular functions are :    * the distance function @xmath433 on @xmath353 is submodular on @xmath547 ( theorem  [ thm : d_is_submodular ] ) . *",
    "submodular functions admit a fractional polymorphism containing semilattice operation @xmath548 , and hence * vcsp*@xmath154 $ ] for submodular language @xmath153 can be solved in polynomial time by the basic lp relaxation ( theorem  [ thm : minimized ] ) .    for readability ,",
    "less obvious theorems will be proved in section  [ subsec : submo_proof ] .",
    "although our framework for submodularity was motivated by its application to 0-extension problems , it turned out that several other submodular - type functions , mentioned in the introduction , fall into our framework ; see @xcite for detail .",
    "let @xmath353 be a modular semilattice , where its valuation is denoted by @xmath397 .",
    "we begin by sketching the construction of the fractional join of @xmath232 ; see figure  [ fig : convi(p , q ) ] . by valuation @xmath397 and the expression in lemma  [ lem : i(p , q ) ]  ( 3 ) , the metric interval @xmath455 is naturally mapped to the plane @xmath549 . consider the convex hull @xmath550 of the image of @xmath455 .",
    "then the fractional join is a formal sum of elements @xmath470 mapped to maximal extreme points of @xmath550 ; the set of such elements is called the _ @xmath273-envelope_. the coefficient of @xmath497 is determined by the normal cone @xmath551 at ( the image of ) @xmath497 .        [ [ pq - envelope . ] ] @xmath273-envelope .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    first we introduce the concept of the @xmath273-envelope .",
    "let @xmath273 be a pair of elements in @xmath353 .",
    "define vector @xmath552 in @xmath553 by @xmath554 , v[p \\wedge q , u \\wedge q]).\\ ] ] let @xmath550 denote the convex hull of @xmath555 in @xmath553 .",
    "the polygon @xmath550 contains @xmath556 , @xmath557 , 0)$ ] , and @xmath558)$ ] as extreme points , and contains horizontal segment @xmath559 $ ] and vertical segment @xmath560 $ ] as edges .",
    "also @xmath550 is contained in the rectangle of four vertices @xmath561 , 0 ) ,   ( v[p \\wedge q , p ] , 0 ) ,   ( v[p \\wedge q , p ] , v[p \\wedge q , q]).\\ ] ] the _ @xmath273-envelope _",
    "@xmath562 is the set of elements @xmath470 such that @xmath563 is a maximal extreme point of @xmath550 , where a _",
    "maximal _ extreme point is an extreme point @xmath564 in @xmath550 such that for every positive vector @xmath565 it holds @xmath566 . observe that @xmath562 always contains @xmath60 and @xmath59 .",
    "[ lem : unique ] the map @xmath567 is injective on @xmath543 .",
    "this lemma will be proved in section  [ subsub : unique ] .",
    "hence the map @xmath567 is a bijection between @xmath562 and the set of maximal extreme points of @xmath550 .",
    "[ [ valuation - of - convex - cones - in - rr2_. ] ] valuation of convex cones in @xmath553 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    to define the coefficient , we consider a valuation of convex cones in @xmath553 .",
    "every closed convex cone @xmath568 in @xmath569 is uniquely represented as @xmath570 for some @xmath571 .",
    "define @xmath572 $ ] by @xmath573 : =   \\frac{\\sin \\alpha } { \\cos \\alpha + \\sin \\alpha }   - \\frac{\\sin \\beta } { \\cos \\beta + \\sin \\beta } .\\ ] ] for convention , we let @xmath574 : = 0 .",
    "$ ] the following property is easily verified , where @xmath575 are closed convex cones in @xmath553 :    @xmath572 \\geq 0 $ ] , and @xmath572 > 0 $ ] if and only if @xmath56 is full dimensional .",
    "@xmath572 + [ c ' ] = [ c \\cap c ' ] + [ c \\cup c']$ ] for @xmath576 .",
    "@xmath577 = 1 $ ] .",
    "[ eqn : valuation ]    we are now ready to define the fractional join .",
    "[ [ fractional - join . ] ] fractional join .",
    "+ + + + + + + + + + + + + + + +    for @xmath470 , let @xmath551 denote the set of nonnegative vectors @xmath578 with @xmath579 , where @xmath580 is the standard inner product .",
    "namely @xmath551 is the intersection of @xmath553 and the normal cone of @xmath550 at extreme point @xmath581 . in particular , @xmath551 forms a closed convex cone in @xmath569 . the _",
    "fractional join _ of @xmath273 is the formal convex combination of @xmath582 with coefficient @xmath583 $ ] : @xmath584 u.\\ ] ] obviously it holds @xmath583 = 0 $ ] for @xmath585 since @xmath586 .",
    "so the fractional join is also equal to @xmath587 u$ ] .",
    "note that the set @xmath543 and the coefficient @xmath588 $ ] depend on valuation @xmath397 .",
    "since the set of cones @xmath551 @xmath589 forms the intersection of @xmath553 and the normal fan of @xmath550 , we have    @xmath590 .    for distinct @xmath591",
    ", the intersection @xmath592 has no interior point , and hence @xmath593 = 0 $ ] .",
    "@xmath594 = 1 $ ] .",
    "[ eqn : normal_fan ]    therefore the fractional join of @xmath232 is a formal convex combination of elements in @xmath543 .",
    "an explicit formula of @xmath583 $ ] is given as follows .",
    "[ lem:[c ] ] suppose that @xmath595 , and @xmath596 and @xmath597 are adjacent extreme points in @xmath550",
    ". then we have @xmath598 = \\delta_i - \\delta_{i-1 } \\quad ( i=0,1,2,\\ldots , m),\\ ] ] where @xmath599 is defined by @xmath600 , @xmath601 , and @xmath602}{v[u_i \\wedge u_{i+1 } , u_i ] + v[u_i \\wedge u_{i+1 } , u_{i+1 } ] } \\quad ( i=1,2,\\ldots , m-1).\\ ] ]    this lemma will be proved in section  [ subsub : unique ] .",
    "we next define the _ fractional join operation_. let @xmath603 denote the set of all binary operations @xmath604 .",
    "regard @xmath603 as a poset by the order : @xmath605 if @xmath606 for all @xmath232",
    ". then @xmath603 is isomorphic to the product @xmath607 of @xmath353 by the correspondence : @xmath608 in particular @xmath603 is also a modular semilattice , where the meet @xmath548 is given by @xmath609 .",
    "the valuation of @xmath603 is given according to ( [ eqn : valuation_sum ] ) , and is also denoted by @xmath397 .",
    "let @xmath610 be the _ projection operations _",
    "defined by @xmath611 let @xmath612 , and let @xmath613 denote the @xmath614-envelope @xmath615 in @xmath603 . an operation in @xmath613",
    "is called _",
    "extremal_. for an operation @xmath186 in @xmath616 , the cone @xmath617 is denoted simply by @xmath618 .",
    "fractional join operation _ is the formal sum of extremal operations @xmath186 with coefficient @xmath619 $ ] : @xmath620 \\vartheta.\\ ] ] the fractional join operation is nothing but the fractional join of @xmath621 in @xmath603 , and indeed gives fractional joins in @xmath353 .    [ prop : frac_join ] @xmath622 u = \\sum_{\\vartheta \\in { \\cal e}({\\cal l } ) } [ c(\\vartheta ) ] \\vartheta ( p , q ) \\quad ( p , q \\in { \\cal l } ) .",
    "$ ]    the proof is given in section  [ subsub : frac_join ] . consider the case where @xmath353 is the product of modular semilattices @xmath426 for @xmath156 .",
    "for operations @xmath189 on @xmath426 @xmath623 , the _ componentwise extension _",
    "@xmath624 is an operation on @xmath353 defined by @xmath625    [ prop : frac_join_prod ] @xmath620 \\vartheta = \\sum_{\\vartheta_1,\\vartheta_2,\\ldots,\\vartheta_n }   [ c(\\vartheta_1 ) \\cap c(\\vartheta_2 ) \\cap \\cdots \\cap c(\\vartheta_n ) ] ( \\vartheta_1,\\vartheta_2,\\ldots , \\vartheta_n),\\ ] ] where @xmath189 is taken over all extremal operations in @xmath426 @xmath623 .",
    "moreover , if @xmath626 and @xmath627 for some @xmath628 , then @xmath629 = 0 $ ] .    the proof is given in section  [ subsub : frac_join_prod ] .",
    "in particular , any extremal operation @xmath186 in @xmath353 is the componentwise extension of extremal operations @xmath630 in @xmath426 for @xmath156 .",
    "let @xmath353 be a modular semilattice with valuation @xmath397 .",
    "a function @xmath631 is called _ submodular _ on @xmath353 ( with respect to @xmath397 ) if it satisfies @xmath632 f(u ) \\quad ( p , q \\in { \\cal l}).\\ ] ] by proposition  [ prop : frac_join ] , a submodular function may also be characterized as a function @xmath86 satisfying @xmath633 f(\\vartheta(p , q ) )   \\quad ( p , q \\in { \\cal l}).\\ ] ] in the case where a pair @xmath273 is bounded , the join @xmath273 exists , @xmath550 is a square of vertices @xmath634 ) , ( v[p \\wedge q , p ] , 0 ) ,   ( v[p \\wedge q , p ] , v[p \\wedge q , q])$ ] , @xmath635 , and the fractional join is equal to @xmath636 .",
    "see figure  [ fig : bounded_antipodal ] .     for a bounded pair ( left ) and an antipodal pair ( right ) ]",
    "hence the corresponding inequality in ( [ eqn : gsubmo ] ) is equal to the usual submodularity inequality : @xmath637 another extremal case is the case of @xmath638 , which implies that @xmath550 is the triangle with vertices @xmath639,0 ) , ( 0 , v[p \\wedge q , q])$ ] .",
    "such a pair @xmath273 is called _ antipodal_. by definition , a pair @xmath273 is antipodal",
    "if and only if every bounded pair @xmath359 with @xmath640 satisfies @xmath641v[b , q ] \\geq v[p \\wedge q , a]v[p \\wedge q , b].\\ ] ] this condition rephrases that the point @xmath642 is lower than the line through the points @xmath643 and @xmath644 . in this case , the fractional join of @xmath273 is equal to @xmath645}{v[p \\wedge q , p ] + v[p \\wedge q , q ] } p +   \\frac{v[p \\wedge q , q]}{v[p \\wedge q , p ] + v[p \\wedge q , q ] } q.\\ ] ] the inequality in ( [ eqn : gsubmo ] ) corresponds to @xmath646 f(p ) +   v[p \\wedge q , p ] f(q ) \\geq   ( v[p \\wedge q , p ] + v[p \\wedge q , q])f(p \\wedge q).\\ ] ] we call this inequality the _ @xmath548-convexity inequality_. then inequalities ( [ eqn : submodular ] ) and ( [ eqn:^-convexity ] ) suffice to characterize the submodularity :    [ thm : submo ] @xmath545 is submodular if and only if it satisfies    * @xmath647 for @xmath648 , * the submodularity inequality for every bounded pair @xmath273 , and * the @xmath548-convexity inequality for every antipodal pair @xmath273 .    the proof is given in section  [ subsub : unique ] .",
    "one of the main properties of our submodularity is the following :    [ thm : d_is_submodular ]",
    "let @xmath353 be a modular semilattice .",
    "the distance function @xmath649 on @xmath353 is submodular on @xmath547 .",
    "we will prove this theorem and a more general version ( theorem  [ thm : d_is_l - convex ] ) in section  [ subsub : d_is_l - convex ] .",
    "we note some basic properties of our submodular functions concerning addition and restriction .",
    "[ lem : properties_submo ] let @xmath650 and @xmath651 be modular semilattices , and let @xmath86 and @xmath652 be submodular functions on @xmath353 .",
    "* for @xmath653 and @xmath654 , @xmath655 is a submodular function on @xmath353 . *",
    "a function @xmath656 defined by @xmath657 is a submodular function on @xmath658 .",
    "* suppose @xmath659 .",
    "for any @xmath660 , a function @xmath661 defined by @xmath662 is a submodular function on @xmath663 .",
    "* for a convex set @xmath664 of @xmath353 , the restriction of @xmath86 to @xmath664 is a submodular function on  @xmath664 ( regarded as a modular semilattice ) .",
    "\\(1 ) follows from the facts that the submodularity is closed under nonnegative sum , and that any constant function is submodular ( by ( [ eqn : normal_fan ] )  ( 3 ) ) .",
    "\\(2 ) follows from ( [ eqn : polymor ] ) , proposition  [ prop : frac_join_prod ] , and @xmath665 f(\\vartheta(p , q ) ) \\\\ & & = \\tilde f(p \\wedge q , p ' \\wedge q ' ) + \\sum_{\\vartheta \\in { \\cal e}({\\cal l } ) }   \\sum_{\\vartheta ' \\in { \\cal e}({\\cal l } ' ) } [ c(\\vartheta ) \\cap c(\\vartheta ' ) ] \\tilde f(\\vartheta(p , q ) , \\vartheta'(p',q')),\\end{aligned}\\ ] ] where we use @xmath619 = \\sum_{\\vartheta ' \\in { \\cal e}({\\cal l}')}[c(\\vartheta ) \\cap c(\\vartheta')]$ ] ( obtained from ( [ eqn : normal_fan ] ) ) .",
    "notice that the @xmath666-envelope is @xmath667 , and any extremal operation @xmath186 is idempotent , i.e. , @xmath668 .",
    "thus , by proposition  [ prop : frac_join_prod ] , we have @xmath669 f(\\vartheta(p , q ) , \\vartheta'(p',p ' ) ) \\\\ & & = f(p \\wedge q , p ' ) + \\sum_{\\vartheta \\in { \\cal e}({\\cal m } ) } \\sum_{\\vartheta ' \\in { \\cal e}({\\cal m ' } ) } [ c(\\vartheta ) \\cap c(\\vartheta ' ) ]   f(\\vartheta(p , q ) , p ' ) \\\\ & & = f_{p ' } ( p \\wedge q ) + \\sum_{\\vartheta \\in { \\cal e}({\\cal m } ) } [ c(\\vartheta ) ] f_{p'}(\\vartheta(p , q ) ) .",
    "\\end{aligned}\\ ] ] ( 4 ) follows from the fact that for @xmath670 the metric interval @xmath455 is the same on @xmath353 and on @xmath664 .",
    "we finally give a useful criterion of the submodularity .",
    "a bounded pair @xmath273 in @xmath353 is said to be _ @xmath89-bounded _ if @xmath402 covers @xmath60 and @xmath59 ( in which case both @xmath60 and @xmath59 cover @xmath403 ) .",
    "[ prop:2section ] suppose that @xmath353 is the product of two modular semilattices @xmath420 .",
    "@xmath671 is submodular if and only if it satisfies    * the submodularity inequality for every @xmath89-bounded pair @xmath232 , and * the @xmath548-convexity inequality for every pair @xmath672 such that @xmath673 and @xmath674 is antipodal in @xmath432 or @xmath675 and @xmath676 is antipodal in @xmath431 .    the proof is given in section  [ subsub:2section ] .",
    "notice that this criterion does not work when @xmath86 has infinite values .",
    "[ [ minimizing - a - sum - of - submodular - functions - with - bounded - arity . ] ] minimizing a sum of submodular functions with bounded arity .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    here we consider the problem of minimizing submodular function @xmath86 on the product of modular semilattices @xmath677 , where the input of the problem is @xmath677 and an evaluating oracle of @xmath86 . in the case",
    "where each @xmath426 is a lattice of rank @xmath193 , this problem is the submodular set function minimization in the ordinary sense , and can be solved in polynomial time  @xcite .",
    "however , we do not know whether this problem in general is polynomial time solvable or not .",
    "one notable result in this direction , due to kuivinen  @xcite , is that if each @xmath426 is a complemented modular lattice of rank @xmath89 ( a _ diamond lattice _ ) , then this problem has a _ good characterization .",
    "_ so we restrict our investigation to the problem of minimizing a sum of submodular functions with bounded arity , i.e. , valued csp for submodular functions . see section  [ subsec : vcsp ] for notions in valued csp",
    "let @xmath678 .",
    "a constraint @xmath86 on @xmath353 is called _ submodular _ if @xmath86 is a submodular function on @xmath679 .",
    "the _ submodular language _",
    "@xmath680 is the set of all submodular constraints on @xmath353 .",
    "[ thm : minimized ] let @xmath353 be the product of modular semilattices @xmath677 . then * vcsp*@xmath681 $ ] can be solved in polynomial time .    indeed , the submodular language @xmath680 satisfies the thapper - ivn criterion ( theorem  [ thm : tz ] ) .",
    "define a fractional operation @xmath190 on @xmath353 by @xmath682 \\vartheta.\\ ] ] by proposition  [ prop : frac_join_prod ] , an extremal operation is the componentwise extension of operations in @xmath426 , and is separable . also , by ( [ eqn : normal_fan ] )  ( 3 ) , the total sum of coefficients @xmath619 $ ] is equal to @xmath193",
    ". therefore @xmath190 is a fractional polymorphism for the submodular language @xmath680 .",
    "obviously @xmath548 is a semilattice operation .",
    "hence theorem  [ thm : minimized ] follows from theorem  [ thm : tz ] .",
    "[ rem : nonsemilattice ] suppose that @xmath1 is the covering graph of a modular semilattice @xmath353 . by theorem  [ thm : d_is_submodular ] and",
    "lemma  [ lem : properties_submo ] , @xmath683 and @xmath684 ( defined in ( [ eqn : g_jf_ij ] ) ) are submodular constraints on @xmath685 .",
    "then * 0-ext*@xmath8 $ ] is a subclass of * vcsp*@xmath686 $ ] .",
    "therefore , by theorem  [ thm : minimized ] , * 0-ext*@xmath8 $ ] can be solved by the basic lp relaxation .",
    "this observation , however , does not get us to the main result ( theorem  [ thm : main ] ) since there is an orientable modular graph that can not be represented as the covering graph of a modular semilattice . see the graph of figure  [ fig : nonsemilattice ] , where there are exactly two admissible orientations : one is the reverse of the other , and both orientations have two sinks and two sources .",
    "nevertheless , the basic lp is expected to solve * 0-ext*@xmath8 $ ] for an arbitrary orientable modular graph @xmath1 ; see section  [ sec : concluding ] .",
    "let @xmath273 be a pair of elements in modular semilattice @xmath353 .",
    "first we prove a general version of lemma  [ lem : unique ] .",
    "[ lem : extreme ] for @xmath687 , if @xmath688 and @xmath689 , then @xmath690 and @xmath691 .",
    "in particular , @xmath692 implies @xmath693 .",
    "we can assume that @xmath694 by adding a constant to @xmath397 ( for notational simplicity ) .",
    "it suffices to consider the case where @xmath695 or @xmath696 and @xmath697 are adjacent extreme points in @xmath550 .",
    "let @xmath698 and @xmath699 .",
    "all pairs @xmath700 , @xmath701 , and @xmath702 from among the triple @xmath703 are bounded . by definition of modular semilattices ,",
    "their join @xmath704 exists and belongs to @xmath455 ( see lemma  [ lem : i(p , q ) ] ) .",
    "similarly the join @xmath705 of triple @xmath706 exists and belongs to @xmath455 .",
    "therefore @xmath707 and @xmath708 . by modularity equality ( [ eqn : valuation2 ] ) for @xmath397 , we have @xmath709 then both @xmath710 and @xmath711 must belong to @xmath712 $ ] since it is an edge ( or an extreme point ) of @xmath550 . necessarily @xmath713 and @xmath714 .",
    "this means that @xmath715 and @xmath716 .",
    "hence the claim follows .",
    "[ lem : antipodal_u_i - u_j ] for @xmath717 with @xmath718 ( and @xmath719 ) , the following hold :    * @xmath720 ; in particular @xmath721 .",
    "* @xmath722 for @xmath723 . * if @xmath724 and @xmath725 are adjacent extreme points , then @xmath12 is antipodal .",
    "( 1 ) . by lemma  [ lem : i(p , q ) ]  ( 4 )",
    ", we have @xmath726 .",
    "this means @xmath727 .",
    "hence @xmath728 .    ( 2 ) .",
    "by @xmath729 ( lemma  [ lem : i(p , q ) ]  ( 4 ) for @xmath730 ) , we have @xmath731 = v[s \\wedge t , u \\wedge s]$ ] , and @xmath732 =   v[p \\wedge q , t \\wedge p ] + v[t \\wedge p , p \\wedge u ]    =   v[p \\wedge q , s \\wedge t \\wedge p ] + v[s \\wedge t , u \\wedge s].\\ ] ] similarly ( for @xmath733 ) , we have @xmath734 = v[p \\wedge q , s \\wedge t \\wedge q ] + v[s \\wedge t , u \\wedge t]$ ] .    ( 3 ) .",
    "if @xmath12 is not antipodal , then there is @xmath735 such that @xmath736 goes beyond the line segment between @xmath737 and @xmath738 .",
    "then , by ( 2 ) , @xmath563 is in the outside of @xmath550 .",
    "this is a contradiction .",
    "suppose that @xmath739 , and @xmath740 and @xmath597 are adjacent extreme points .",
    "let @xmath630 be the angle of the line normal to the line segment connecting @xmath741 and @xmath742 .",
    "by lemma  [ lem : antipodal_u_i - u_j ]  ( 2 ) , @xmath630 is equal to the angle of the line normal to the line segment connecting @xmath743 and @xmath744 . therefore @xmath745}{v[u_i",
    "\\wedge u_{i-1},u_{i-1 } ]   + v[u_i \\wedge u_{i-1},u_i ] } = \\delta_{i-1}.\\ ] ] therefore we obtain the formula of lemma  [ lem:[c ] ] .    next we prove theorem  [ thm : submo ] .",
    "it suffices to prove the if part .",
    "let @xmath273 be a pair of ( incomparable ) elements in @xmath353 .",
    "suppose that @xmath739 is given as above .",
    "let @xmath746 and @xmath747 for @xmath748 .",
    "by lemma  [ lem : extreme ] , it holds @xmath749 and @xmath750 for @xmath751 .     and",
    "@xmath543 ]    let @xmath753 for @xmath754 ; see figure  [ fig : envelope ]",
    ". then we have @xmath755 also , by lemma  [ lem : i(p , q ) ]  ( 3 ) and ( 4 ) , we have @xmath756 let @xmath86 be a function on @xmath353 satisfying the conditions ( 1 ) , ( 2 ) , and ( 3 ) in theorem  [ thm : submo ] .",
    "we show that @xmath86 satisfies the inequality ( [ eqn : gsubmo ] ) for @xmath232 .",
    "we may assume that @xmath648 .",
    "by condition ( 1 ) , @xmath647 .",
    "namely @xmath757 . by ( 3 )",
    ", we have @xmath758 . by ( 2 )",
    ", we have @xmath759 .",
    "consequently all @xmath760 belong to @xmath116 . by ( [ eqn : wedge ] ) , ( [ eqn : vee ] ) , and the condition ( 2 ) ( submodularity )",
    ", we have @xmath761 by adding ( [ eqn : adding ] ) for @xmath762 and @xmath763 ( recall @xmath764 ) , we obtain @xmath765 by lemma  [ lem : antipodal_u_i - u_j ]  ( 3 ) , pair @xmath766 is antipodal . by condition ( 3 ) , @xmath86 satisfies the @xmath548-convexity inequality ( [ eqn:^-convexity ] ) for @xmath766 , which is rewritten as @xmath767 substituting ( ) to ( [ eqn : ba ] ) for @xmath768 , we obtain @xmath769 f(u_i).\\ ] ]      we start with preliminary arguments .",
    "suppose that @xmath353 is the product @xmath420 of modular semilattices @xmath431 and @xmath432 .",
    "the valuations of @xmath431 and @xmath432 are given as ( [ eqn : valuation_summand ] ) .",
    "they are also denoted by @xmath397 .",
    "let @xmath672 be a pair of elements in @xmath353 . by ( [ eqn : valuation_summand1 ] ) , we have @xmath770 by this equation together with @xmath771 , we have @xmath772 where the sum means the minkowski sum .    in general ,",
    "if a polytope @xmath274 is the minkowski sum of two polytopes @xmath282 and @xmath773 , then every extreme point of @xmath274 is uniquely represented as the sum of extreme points of @xmath282 and of @xmath773 . by this fact and the injectivity of @xmath774 ( lemma  [ lem : unique ] ) on @xmath543",
    ", we obtain :    for @xmath775 , there uniquely exist maximal extreme points @xmath776 for @xmath427 such that @xmath777 for @xmath427 , and @xmath778 .",
    "in particular , @xmath779 belongs to @xmath780 for @xmath427 .",
    "[ eqn : x1+x2 ]    moreover , @xmath563 maximizes @xmath781 over @xmath782 if and only if @xmath783 maximizes @xmath781 over @xmath784 for @xmath427 .",
    "therefore we have @xmath785 we are ready to prove proposition  [ prop : frac_join ] .",
    "regard @xmath603 as a modular semilattice @xmath607 .",
    "then @xmath616 is the product of @xmath786 over all @xmath787 . by ( [ eqn : minkowski ]",
    ") we have @xmath788 by ( [ eqn : x1+x2 ] ) , for every extremal operation @xmath186 , each @xmath789 belongs to @xmath543 .",
    "also , by ( [ eqn : c1^c2 ] ) , we have @xmath790 from ( [ eqn : normal_fan ] ) , @xmath791 if and only if @xmath792 , and @xmath793 where any two of the cones in the union have no common interior points .",
    "therefore @xmath620 \\vartheta(p , q ) =   \\sum_{u \\in { \\cal e}(p , q ) } \\left ( \\sum_{\\vartheta \\in { \\cal e}({\\cal l } ) :   \\vartheta(p , q ) = u } [ c(\\vartheta ) ]   \\right ) u    =   \\sum_{u \\in { \\cal e}(p , q ) } [ c(u ; p , q ) ] u.\\ ] ] this proves proposition  [ prop : frac_join ] .",
    "it suffices to consider the case where @xmath794 . if @xmath795 is the componentwise extension of @xmath796 for @xmath427 , then @xmath797 therefore it holds latexmath:[\\[\\label{eqn : convl1+convl2 } { \\mathop{\\rm conv } } i ( { \\cal l } ) \\supseteq     we are going to show that every extremal operation in @xmath353 is the componentwise extension of operations in @xmath426 for @xmath427 , and the equality holds in ( [ eqn : convl1+convl2 ] ) .",
    "take an extremal operation @xmath186 on @xmath353 .",
    "there are @xmath799 for @xmath427 such that @xmath800 for @xmath787 . by proposition  [ prop : frac_join ]",
    ", @xmath789 belongs to @xmath543 . by ( [ eqn : x1+x2 ] ) ,",
    "@xmath801 and @xmath802 belong to @xmath803 and @xmath804 , respectively . for @xmath805 with @xmath806 , suppose ( indirectly ) that @xmath807 .",
    "let @xmath808 be the operation in @xmath616 obtained from @xmath186 by replacing @xmath809 with @xmath801 , and let @xmath810 be the operation in @xmath616 obtained from @xmath186 by replacing @xmath801 with @xmath809 .",
    "then we have @xmath811 by lemma  [ lem : unique ] , @xmath812 and @xmath813 are distinct , and consequently @xmath814 is the midpoint of segment between distinct points @xmath815 and @xmath816 , contradicting the fact that @xmath186 is extremal",
    ". therefore @xmath817 must hold .",
    "this means that @xmath801 does not depend on the second component of each of @xmath232 .",
    "so we can regard @xmath818 .",
    "similarly @xmath819 , and @xmath186 is equal to the componentwise extension of @xmath820 and @xmath821 .",
    "hence the equality holds in ( [ eqn : convl1+convl2 ] ) , both @xmath820 and @xmath821 must be extremal , and @xmath822 = [ c(\\vartheta_1 ) \\cap c(\\vartheta_2)]$ ] .",
    "thus we have @xmath620 \\vartheta = \\sum_{\\vartheta_1 \\in { \\cal e}({\\cal l}_1 ) , \\vartheta_2 \\in { \\cal e}({\\cal l}_2 ) } [ c(\\vartheta_1 ) \\cap c(\\vartheta_2 ) ] ( \\vartheta_1,\\vartheta_2).\\ ] ]    suppose that @xmath823 holds .",
    "suppose that @xmath820 and @xmath821 are different .",
    "we see from ( [ eqn : v(theta;l , r ) ] ) that @xmath824 is the midpoint of the segment between distinct points @xmath825 and @xmath826 .",
    "hence @xmath827 is never extremal .",
    "the proof of proposition  [ prop : frac_join_prod ] is now complete .",
    "we use the characterization of theorem  [ thm : submo ] .",
    "so the only if part is obvious .",
    "we prove the if part .",
    "we first show that the submodularity inequality for an arbitrary bounded pair is implied by submodularity inequalities for @xmath89-bounded pairs . for a bounded pair @xmath273 , take maximal chains @xmath410 and @xmath411 .",
    "let @xmath412 . then @xmath828 .",
    "here we use the fact seen from modularity that @xmath829 is a @xmath89-bounded pair with @xmath417 and @xmath418 .",
    "next we show the @xmath548-convexity inequality .",
    "take an ( incomparable ) antipodal pair @xmath672 in @xmath353 . then @xmath830 .",
    "then @xmath550 is a triangle . by ( [ eqn : minkowski ] ) , it holds @xmath831 . therefore both @xmath832 and @xmath833 are triangles congruent to a dilation of @xmath550 .",
    "hence @xmath834 is antipodal in @xmath426 , and @xmath835 and @xmath836 for @xmath427 . in particular , both @xmath837 and @xmath838 are antipodal pairs in @xmath794 . letting @xmath839 and @xmath840",
    ", we have @xmath841 ) f(q_1,q_2 ) + ( 1 - [ c_p ] ) f(q_1,p_2 ) \\geq f(q_1 ,",
    "p_2 \\wedge q_2 ) , \\\\ & & ( 1 - [ c_q ] ) f(q_1,p_2 ) + ( 1 - [ c_p ] ) f(p_1,p_2 ) \\geq f(p_1 \\wedge q_1 , p_2 ) .",
    "\\end{aligned}\\ ] ] also , by submodularity inequality ( shown above ) , we have @xmath842 from the three inequalities , we obtain @xmath841 ) f(q_1,q_2 ) + ( 2 - [ c_p ] - [ c_q ] ) f(q_1,p_2 ) + ( 1 - [ c_p])f(p_1,p_2 )   \\\\ & & \\quad \\quad \\geq f(p_1 \\wedge",
    "q_1,p_2 \\wedge q_2 ) + f(q_1,p_2).\\end{aligned}\\ ] ] by using @xmath843 + [ c_q ] = 1 $ ] , we obtain the @xmath548-convexity inequality for @xmath273 .",
    "a _ modular complex _ @xmath844 is a triple @xmath845 of an orientable modular graph @xmath1 , its admissible orientation @xmath52 , and its positive orbit - invariant function @xmath92 .",
    "the goal of this section is to introduce a class of discrete convex functions , called _ l - convex functions _ , on @xmath844 , and show that l - convex functions have several nice properties for optimization , analogous to l@xmath72-convex functions in discrete convex analysis .",
    "the main properties of our l - convex functions are :    * the distance function @xmath846 is an l - convex function on @xmath847 ( theorem  [ thm : d_is_l - convex ] ) .",
    "* in the minimization of an l - convex function , checking optimality and finding a descent direction can be done by submodular function minimization on modular semilattices ( theorem  [ thm : l - optimality ] ) .    in section  [ subsec : complex ] , we explore several structural properties of modular complexes .",
    "in particular , a modular complex can be regarded as a structure obtained by gluing modular semilattices ( theorem  [ thm : lattice ] ) , and admits a subdivision operation ( theorem  [ thm:2subdivision ] ) .",
    "this operation produces a fine modular complex @xmath848 into which the original modular complex @xmath844 is embedded , and also enables us to define the _ neighborhood semilattice _",
    "@xmath80 around each vertex @xmath60 , which is also a modular semilattice . based on this investigation as well as the idea mentioned in the introduction , in section  [ subsec : l - convex",
    "] , we introduce l - convex functions on @xmath844 , and present their properties .",
    "again less obvious theorems will be proved in section  [ subsec : l - convex_proof ] . a further geometric study on orientable modular graphs",
    "is given in @xcite .",
    "let @xmath849 be a modular complex , where a modular complex is denoted by the bold style @xmath844 of the underlying graph @xmath1 .",
    "[ [ boolean - pairs . ] ] boolean pairs .",
    "+ + + + + + + + + + + + + +    consider a cube subgraph @xmath74 of @xmath850 , and consider the digraph @xmath851 of @xmath74 oriented by @xmath52 .",
    "one can easily see from the definition of an admissible orientation that @xmath851 is isomorphic to the hasse diagram of a boolean lattice .",
    "hence @xmath851 determines the maximum element and the minimum element of the corresponding boolean lattice .",
    "a pair @xmath273 of vertices is called _",
    "@xmath52-boolean _ , or simply , _ boolean _ if @xmath60 and @xmath59 are the minimum element and the maximum element , respectively , of the boolean lattice associated with some cube subgraph of @xmath850 . by convention",
    ", @xmath666 is defined to be boolean .",
    "the set of boolean pairs is denoted by @xmath852 . in figure",
    "[ fig : modular_complex ] in the introduction , for example , @xmath853 , @xmath854 , @xmath855 are boolean , and @xmath856 is not boolean .",
    "recall that any admissible orientation is acyclic ( lemma  [ lem : acyclic ] ) .",
    "let @xmath857 be the transitive closure of relation @xmath858 on @xmath4 .",
    "then @xmath4 is regarded as a partially ordered set according to this relation ; so @xmath859 implies @xmath860 . for any boolean pair @xmath273 ,",
    "necessarily @xmath390 holds .",
    "[ prop : modularlattice ] let @xmath844 be a modular complex . for @xmath272 with @xmath390 , we have the following :    * @xmath524 $ ] is a modular lattice ,",
    "is convex in @xmath1 , and is equal to @xmath455 .",
    "* @xmath273 is boolean if and only if @xmath524 $ ] is a complemented modular lattice .    in particular we can check whether a given pair is boolean in time polynomial in @xmath861 .",
    "we prove this proposition in section  [ subsub : proof_of_lattice ] .",
    "we define the relation @xmath862 as : @xmath863 if @xmath273 is a boolean pair .",
    "this relation @xmath864 coarsens @xmath354 , and is not transitive in general .",
    "since a complemented modular lattice is relatively complemented ( theorem  [ thm : complemented ] ) , we have :    if @xmath863 and @xmath865 , then @xmath866 .",
    "[ eqn : v ]    for a vertex @xmath60 , define subsets @xmath867 and @xmath868 of vertices by @xmath869 in the sequel , @xmath867 and @xmath868 are often denoted by @xmath870 and @xmath871 , respectively .",
    "regard @xmath870 as a poset by the partial order @xmath354 , and regard @xmath871 as a poset by the reverse of @xmath354 .",
    "[ thm : lattice ] let @xmath844 be a modular complex .",
    "for every vertex @xmath60 , both @xmath870 and @xmath871 are complemented modular semilattices , and convex in @xmath1 .",
    "theorem  [ thm : lattice ] will be proved in section  [ subsub : proof_of_lattice ] .",
    "therefore @xmath844 is a structure obtained by gluing modular lattices and semilattices .",
    "moreover @xmath844 gives rise to a simplicial complex @xmath872 as follows .",
    "for each boolean pair @xmath273 and each ascending path @xmath873 from @xmath60 to @xmath59 , fill a @xmath95-dimensional simplex as in figure  [ fig : modular_complex ] .",
    "then we obtain a simplicial complex @xmath872 , and we can define an analogue of lovsz extension for any function on @xmath4 .",
    "we however do not use this complex @xmath872 in the sequel , although our argument is based on this geometric view . instead of dealing with @xmath872",
    ", we use a graph - theoretic operation , the @xmath89-subdivision @xmath848 of @xmath844 , which comes from the barycentric subdivision of @xmath872 .",
    "[ [ subdivision - and - neighborhood - semilattices . ] ] 2-subdivision and neighborhood semilattices .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the @xmath89-subdivision @xmath848 of @xmath844 is constructed as follows . a boolean pair @xmath874 is denoted by @xmath875 .",
    "the _ @xmath89-subdivision _",
    "@xmath876 of @xmath850 is a simple undirected graph on the set @xmath852 of all boolean pairs with edges given as : @xmath877 and @xmath878 are adjacent if and only if @xmath879 and @xmath880 or @xmath881 and @xmath882 . the orientation @xmath883 for @xmath884 is given as : @xmath885 if @xmath879 and @xmath886 or if @xmath881 and @xmath887 .",
    "see figure  [ fig : orientation ] .     and",
    "@xmath883 ]    in fact , @xmath884 does not depend on the choice of an admissible orientation ; see @xcite .    an edge joining @xmath877 and @xmath889 ( resp . @xmath877 and @xmath890 ) is denoted by @xmath891 ( resp .",
    "@xmath892 ) .",
    "a function @xmath893 on @xmath894 is defined as @xmath895 and @xmath896 .",
    "let @xmath897 , which is called the _",
    "@xmath89-subdivision _ of @xmath844 .",
    "[ thm:2subdivision ] for a modular complex @xmath898 , the @xmath89-subdivision @xmath899 is also a modular complex .",
    "this theorem will be proved in section  [ subsub : proof_2subdivision ] .",
    "figure  [ fig : neighborhood1 ] illustrates the @xmath89-subdivision of @xmath844 in figure  [ fig : modular_complex ] .     and neighborhood semilattices ]    by embedding @xmath900",
    ", we can regard @xmath901 .",
    "the admissible orientation @xmath883 is oriented so that the vertices in @xmath4 are all sinks .",
    "the partial order @xmath902 on @xmath903 induced by @xmath883 is denoted by @xmath904 , and @xmath905 is also denoted by @xmath906 . in fact , one can show that two relations @xmath904 and @xmath906 are the same . here",
    "we only note the following obvious relation : @xmath907    for each vertex @xmath81 , define the _ neighborhood semilattice _ @xmath908 . by theorems  [ thm : lattice ] and [ thm:2subdivision ]",
    ", we obtain :    let @xmath844 be a modular complex . for each vertex @xmath60 , the neighborhood semilattice @xmath84 is a complemented modular semilattice with the minimum element @xmath60 .",
    "see figure  [ fig : neighborhood1 ] .",
    "neighborhood semilattice @xmath84 has more information about the local property of @xmath60 than @xmath870 and @xmath871 have .",
    "[ [ valuation - of - local - semilattices . ] ] valuation of local semilattices .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a positive orbit - invariant function @xmath92 naturally gives valuation @xmath909 on @xmath910 for @xmath911 , and valuation @xmath912 on @xmath80 by @xmath913 see lemma  [ lem : valuation ] . in the sequel , semilattices @xmath914 , @xmath915 , and @xmath80",
    "are supposed to be endowed with these valuations .",
    "[ [ embedding - of - pmbmgamma - into - pmbmgamma . ] ] embedding of @xmath844 into @xmath848 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the distances on @xmath1 and @xmath884 are related as follows .",
    "[ prop:1/2 ] let @xmath849 be a modular complex , and @xmath848 the @xmath89-subdivision of @xmath844 .",
    "then we have @xmath916 in particular , @xmath917 is isometrically embedded into @xmath918 by @xmath900 .",
    "this proposition will be proved in section  [ subsub : proof_2subdivision ] .",
    "[ [ product - of - modular - complexes . ] ] product of modular complexes .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    suppose that we are given two modular complexes @xmath849 and @xmath919 .",
    "then the cartesian product @xmath128 is also modular .",
    "furthermore , define the orientation @xmath920 of @xmath128 as : @xmath921 if @xmath922 and @xmath923 if @xmath924 .",
    "then @xmath920 is an admissible orientation .",
    "similarly define @xmath925 by @xmath926 and @xmath927 , which is orbit - invariant in @xmath128 .",
    "thus we obtain a new modular complex @xmath928 , which is called the _ product _ of @xmath844 and @xmath929 .",
    "@xmath930 if and only if @xmath931 and @xmath932 .",
    "since @xmath933 \\simeq [ p , q ] \\times [ p',q']$ ] , @xmath933 $ ] is complemented modular if and only if both @xmath524 $ ] and @xmath934 $ ] are complemented modular .",
    "thus , by proposition  [ prop : modularlattice ] , we have the claim .    in particular the correspondence @xmath935 is bijective , and we can regard @xmath936 under this correspondence , the product operation and the 2-subdivision operation commute in the following sense .",
    "[ lem : product ]    * @xmath937 for @xmath911 .",
    "* @xmath938 . * @xmath939 .",
    "\\(1 ) follows from the previous lemma .",
    "( 2 ) follows from the fact that @xmath940 and @xmath941 have an edge in @xmath942 if and only if @xmath943 , which is equivalent to the condition that @xmath944 and @xmath945 have an edge in @xmath946 .",
    "( 3 ) follows from ( 2 ) .",
    "we are ready to introduce the concept of an l - convex function on a modular complex @xmath947 .",
    "consider the @xmath89-subdivision @xmath948 of @xmath844 .",
    "for a function @xmath949 , define @xmath950 by @xmath951 this is the restriction of the lovsz extension of @xmath79 ; see the introduction for the lovsz extension . by restricting @xmath952 to neighborhood semilattices",
    ", we obtain functions on ( complemented ) modular semilattices @xmath84 for each vertex @xmath60 .",
    "l - convex function _ on @xmath844 is a function @xmath949 such that for each vertex @xmath81 the restriction of @xmath952 to @xmath84 is submodular on @xmath953 ( with respect to the valuation @xmath954 ) .",
    "corresponding to theorem  [ thm : d_is_submodular ] , the distance function @xmath122 is l - convex on @xmath847 , which is one of the most important properties for our application to 0-extension problem .",
    "[ thm : d_is_l - convex ] for a modular complex @xmath849 , the distance function @xmath122 is an l - convex function on @xmath847 .",
    "the proof of this theorem is given in section  [ subsub : d_is_l - convex ] .",
    "corresponding to lemma  [ lem : properties_submo ] , we obtain :    [ lem : properties_l - convex ] let @xmath955 , and @xmath956 be modular complexes , and let @xmath79 and @xmath957 be l - convex functions on @xmath844 .",
    "* for @xmath653 and @xmath654 , @xmath958 is an l - convex function on @xmath844 . *",
    "a function @xmath959 defined by @xmath960 is an l - convex function on @xmath961 .",
    "* suppose that @xmath962",
    ". for @xmath963 , a function @xmath964 defined by @xmath965 is an l - convex function on @xmath966 .",
    "\\(1 ) follows from lemma  [ lem : properties_submo ]  ( 1 ) .",
    "@xmath967 . therefore , by lemma  [ lem : properties_submo ]  ( 2 ) , function @xmath968 is submodular on @xmath969 .",
    "@xmath970 . since @xmath952 is submodular on @xmath971 , by lemma  [ lem : properties_submo ]  ( 3 ) , @xmath972 is submodular on @xmath973",
    ".    the restrictions of an l - convex function to @xmath974 and to @xmath975 are submodular .",
    "[ lem : submo_l_p ] an l - convex function @xmath79 on @xmath844 is submodular on @xmath870 and on @xmath915 for each vertex @xmath60 .",
    "consider the set @xmath976 of elements in @xmath80 of the form @xmath877 . by proposition  [ prop:1/2 ] ,",
    "any vertex in any shortest path between @xmath877 and @xmath889 is of the form @xmath977 .",
    "hence @xmath976 is convex in @xmath1 and in @xmath978 . by lemma  [ lem : properties_submo ]  ( 4 ) , @xmath952 is submodular on @xmath976 .",
    "obviously @xmath976 is isomorphic to @xmath914 by @xmath979 . by using relation @xmath980 @xmath981",
    ", we see the submodularity of @xmath79 on @xmath870 .",
    "[ [ l - optimality - criterion . ] ] l - optimality criterion .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    consider minimization of l - convex functions on a modular complex @xmath844 .",
    "there is an optimality criterion that extends the l - optimality criterion of l@xmath982-convex function in discrete convex analysis ; see ( * ? ? ?",
    "* theorem 7.14 ) .",
    "[ thm : l - optimality ]",
    "let @xmath79 be an l - convex function on a modular complex @xmath844 .",
    "for a vertex @xmath983 , the following conditions are equivalent :    * @xmath984 holds for every @xmath985 .",
    "* @xmath984 holds for every @xmath985 with @xmath863 or @xmath986 .",
    "that is @xmath987    we prove this theorem in section  [ subsub : l - optimality ] .",
    "the condition ( 2 ) implies that @xmath79 can be minimized by tracing the 1-skeleton graph of @xmath872 . by lemma  [ lem : submo_l_p ] , checking the condition ( @xmath89 ) reduces to the submodular function minimization on modular semilattices , analogous to the case of l@xmath982-convex function in discrete convex analysis  ( * ? ? ?",
    "* section 10.3 ) .",
    "suppose that @xmath844 is the product of modular complexes @xmath988 for @xmath156 .",
    "again we say nothing about the complexity of the minimization under the oracle model .",
    "so we consider the vscp situation .",
    "recall section  [ subsec : vcsp ] . by an _",
    "l - convex constraint _",
    "on @xmath844 we mean an l - convex function @xmath79 on @xmath989 for some @xmath94 . by lemma  [ lem : properties_l - convex ] , the sum of l - convex constraints",
    "@xmath990 is an l - convex function on @xmath844 . by l - optimality criterion",
    ", the optimality check of given vertex @xmath60 reduces to the minimization of the sum of submodular constraints over modular semilattices @xmath991 for @xmath911 . by theorem  [ thm : minimized ] , we obtain :    let @xmath844 be the product of modular complexes @xmath988 @xmath623 , and let @xmath990 be a set of l - convex constraints on @xmath844 .",
    "define @xmath949 by @xmath992 for a given vertex @xmath60 , there exists an algorithm , in time polynomial in @xmath34 and @xmath993 , to find @xmath994 with @xmath995 or conclude that @xmath60 is a global minimizer of @xmath79 , where @xmath996 and @xmath997 .",
    "[ [ steepest - descent - algorithm . ] ] steepest descent algorithm .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    theorem  [ thm : l - optimality ] , lemma  [ lem : submo_l_p ] , and theorem  [ thm : minimized ] naturally lead us to a descent algorithm for l - convex functions on modular complexes , analogous to the steepest descent algorithm for l - convex function minimization in discrete convex analysis . starting from an arbitrary point @xmath60 ,",
    "each descent step is to find , for @xmath998 , an optimal solution @xmath999 of the problem :    minimize @xmath1000 over @xmath1001 .",
    "[ eqn : sigma ]    as mentioned already , this is a submodular function minimization . if @xmath1002 , then @xmath60 is optimal",
    ". otherwise , take @xmath911 with @xmath1003 , let @xmath1004 ( _ steepest direction _ ) , and repeat the descent step .",
    "after a finite number of descent steps , we can obtain an optimal solution ( a minimizer of @xmath79 ) .    in the case where @xmath86 is an l@xmath72-convex function on a box subset @xmath74 of @xmath62",
    ", murota  @xcite proved that , by appropriate choices of steepest directions , the number of the descent steps is bounded by @xmath1005-diameter of @xmath74 ; later kolmogorov and shioura  @xcite improved this bound .",
    "we do not know whether a similar upper bound exists for l - convex function minimizations on general modular complexes .",
    "this issue will be studied in  @xcite .",
    "we can assume that @xmath92 is the uniform unit edge weight , and @xmath1006 is denoted by @xmath2 .",
    "a path @xmath1007 is said to be _ ascending _ if @xmath1008 for @xmath1009 .",
    "[ lem : ascending ] for @xmath1010 with @xmath390 , a @xmath273-path @xmath274 is shortest if and only if @xmath274 is an ascending path from @xmath60 to @xmath59 .",
    "in particular , @xmath391 $ ] , any maximal chain in @xmath524 $ ] has the same length , and the rank @xmath394 of @xmath524 $ ] is given by @xmath1011 .",
    "suppose @xmath390 .",
    "take an ascending path @xmath1012 .",
    "we use the induction on length @xmath95 ; the statement for @xmath257 is obvious .",
    "( if part ) .",
    "we show @xmath1013 .",
    "suppose for contradiction that @xmath1014 . by induction and bipartiteness",
    ", we have @xmath1015 and @xmath1016 . by the quadrangle condition ( lemma  [ lem : quadrangle ]  ( 2 ) ) for @xmath1017",
    ", there is a common neighbor @xmath261 of @xmath1018 with @xmath1019 .",
    "consider the 4-cycle of @xmath1020 . by orientability @xmath1021",
    "must hold .",
    "hence we obtain an ascending path @xmath1022 of length @xmath1023 with @xmath1024 . a contradiction .",
    "( only if part ) .",
    "take any shortest path @xmath1025 between @xmath60 and @xmath59 .",
    "we show that @xmath282 is ascending . by the if part , necessarily @xmath1026 .",
    "it suffices to show that @xmath1027 ; by induction @xmath1028 is ascending , and hence @xmath282 is ascending .",
    "we can assume that @xmath1029 . by the quadrangle condition for @xmath1030",
    ", there is a common neighbor @xmath261 of @xmath1031 with @xmath1032 . then @xmath1033 $ ] ( by induction )",
    "this means @xmath1034 , which in turn implies @xmath1035 by the orientation of 4-cycle @xmath1036 .",
    "thus @xmath1027 , as required .",
    "let @xmath1037 and @xmath1038 denote the principal filter @xmath1039 and the principal ideal @xmath1040 of @xmath60 , respectively .",
    "[ lem : filter ] for @xmath1041 , there uniquely exists a median @xmath40 of @xmath1042 , which coincides with @xmath357 .",
    "similarly , for @xmath1043 there uniquely exists a median @xmath40 of @xmath1044 , which coincides with @xmath356 . both @xmath1037 and @xmath1038",
    "are convex , and modular semilattices .",
    "it suffices to prove the claim for @xmath1037 .",
    "suppose that @xmath1045 have two distinct medians @xmath1046 .",
    "take a median @xmath40 of @xmath1047 .",
    "let @xmath1048 .",
    "we can take an ascending path @xmath1049 from @xmath40 to @xmath10 , and also can take a neighbor @xmath1050 of @xmath40 with @xmath1051 ; necessarily @xmath1052 . by the quadrangle condition for @xmath1053 ,",
    "there is a common neighbor @xmath1054 of @xmath1055 such that @xmath1056 . also by the quadrangle condition for @xmath1057",
    "there is a common neighbor @xmath1058 of @xmath1055 such that @xmath1059 .",
    "by @xmath1060 and the orientability , we have @xmath1061 and @xmath1062",
    ". hence @xmath1063 must hold . similarly , by the quadrangle condition for @xmath1064 and for @xmath1065 , we can find a common neighbor @xmath1066 of @xmath1067 such that @xmath1068 and @xmath1069 .",
    "necessarily @xmath1070 .",
    "repeat this process to obtain a neighbor @xmath1071 of @xmath1072 such that @xmath1073 and @xmath1074 .",
    "this implies that @xmath1075 ; a contradiction .",
    "we show @xmath1076 in the poset @xmath1037 .",
    "indeed , take an arbitrary @xmath1077 with @xmath1078 .",
    "consider a median @xmath1050 of @xmath1079 . since there is an ascending path from @xmath60 to @xmath1050 using @xmath406",
    ", @xmath1050 is also a median of @xmath1045 , and @xmath1080 by the uniqueness .",
    "hence @xmath1081 .",
    "we next show the convexity of @xmath1037 by verifying ( 3 ) in lemma  [ lem:2convexity ] . clearly the subgraph of @xmath1 induced by @xmath1037 is connected .",
    "take @xmath1041 with @xmath1082 .",
    "we show that @xmath1083 . from lemma",
    "[ lem : ascending ] , this is obvious when @xmath361 or @xmath362 .",
    "thus we may assume @xmath1084 and @xmath1085 .",
    "consider @xmath357 in @xmath1037 ( the existence of @xmath357 is guaranteed as above ) .",
    "by @xmath1082 , @xmath211 and @xmath358 cover @xmath357 . by the admissibility of the orientation",
    "@xmath52 , if @xmath211 and @xmath358 have another common neighbor @xmath1086 , then @xmath10 covers @xmath211 and @xmath358 , i.e. , @xmath1087 .",
    "hence @xmath1083 , and @xmath1037 is convex .    for arbitrary @xmath1041 ,",
    "every maximal common lower bound @xmath1050 of @xmath1088 ( not necessarily in @xmath1037 ) belong to @xmath1089 ; consider a median @xmath1090 , which is equal to @xmath1050 by the above argument . by the convexity , @xmath1050 belongs to @xmath1037 , and is equal to @xmath357 in @xmath1037 .",
    "this means that @xmath1088 have the meet in the poset @xmath1091 .",
    "now @xmath1037 is a semilattice , and convex in @xmath1 .",
    "the covering graph of @xmath1037 is equal to the subgraph @xmath1092 $ ] induced by @xmath1037 , which is modular ( by convexity ) . by theorem  [ thm : bvv ]",
    ", @xmath1037 is a modular semilattice .",
    "[ [ proof - of - propositionpropmodularlattice . ] ] proof of proposition  [ prop : modularlattice ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    ( 1 ) .",
    "notice that the convexity is closed under the intersection .",
    "by @xmath524 = ( p)^{\\uparrow } \\cap ( q)^{\\downarrow}$ ] and by the previous lemma , we have the convexity of @xmath524 $ ] .",
    "also @xmath524 $ ] is an interval of a modular semilattice , and hence a modular lattice .",
    "if @xmath273 is boolean , then @xmath59 is the join of atoms in @xmath524 $ ] , and @xmath524 $ ] is a complemented modular lattice ( theorem  [ thm : complemented ] ) .",
    "conversely , if @xmath524 $ ] is a complemented modular lattice , then there is a boolean sublattice of full rank ( generated by a base ) , and @xmath273 is boolean .",
    "we can check whether a pair @xmath273 is boolean by the following procedure .",
    "first construct the partial order @xmath354 , and the poset @xmath1091 . if @xmath1093 , then @xmath273 is not boolean .",
    ". construct ( or enumerate ) @xmath524 $ ] .",
    "for each @xmath1094 $ ] , check the existence of an element ( complement ) @xmath1095 $ ] with @xmath1096 and @xmath1097 .",
    "if every element has a complement , then @xmath524 $ ] is complemented modular , and @xmath273 is boolean .",
    "otherwise , @xmath273 is not boolean .",
    "this procedure can be done in time polynomial in @xmath861 .",
    "@xmath1098    [ [ proof - of - theoremthmlattice . ] ] proof of theorem  [ thm : lattice ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    it suffices to consider only @xmath914 .",
    "the statement that @xmath914 is a semilattice immediately follows from lemma  [ lem : filter ] and ( [ eqn : v ] ) .",
    "next we show the convexity . in view of lemma  [ lem:2convexity ] , take @xmath1099 with @xmath1082 , and take any common neighbor @xmath10 of @xmath1088 .",
    "we show @xmath1100 .",
    "this is obvious if @xmath1101 or @xmath1102 .",
    "also , if @xmath1103 , then @xmath1104 ( if @xmath1086 , then 4-cycle @xmath1105 violates the admissibility of the orientation @xmath52 ) .",
    "so suppose that @xmath1106 . by lemma  [ lem : ascending ] , both @xmath1107 $ ] and @xmath1108 $ ] belong to @xmath1109 $ ] .",
    "in particular , @xmath10 is the join of @xmath211 and @xmath358 in @xmath1109 $ ] . here",
    "@xmath211 is the join of atoms in @xmath1107 $ ] and @xmath358 is the join of atoms in @xmath1108 $ ] .",
    "this means that @xmath10 is the join of atoms in @xmath1109 $ ] .",
    "hence modular lattice @xmath1109 $ ] is complemented ( theorem  [ thm : complemented ] ) , and hence @xmath1110 is boolean .",
    "the subgraph of @xmath1 induced by any convex set is again a modular graph .",
    "therefore the covering graph of @xmath1111 is modular . by theorem",
    "[ thm : bvv ] , @xmath1111 is a modular semilattice . in particular , each @xmath524 $ ] for each @xmath1112 is a complemented modular lattice , and @xmath1111 is a complemented modular semilattice .",
    "we start with preliminary results . by proposition",
    "[ prop : modularlattice ] , interval @xmath524 $ ] is a modular lattice , and is convex in @xmath1 .",
    "so we can consider the projection @xmath1113 } : v_{\\mgamma } \\to [ p , q]$ ] ( see section  [ subsec : gated ] ) .",
    "[ lem:[p , q][p,q ] ] for @xmath1114 with @xmath390 and @xmath1115 , let @xmath1116 be defined by @xmath1117 } ( p ' ) , \\   v : = { \\rm pr}_{[p , q ] } ( q ' ) , u ' : = { \\rm pr}_{[p',q ' ] } ( p ) , \\ v ' : = { \\rm pr}_{[p',q ' ] } ( q).\\ ] ] then we have :    * @xmath1118 , @xmath1119 , @xmath1120}([p , q ] ) = [ u ' , v']$ ] , and @xmath1113}([p',q ' ] ) = [ u , v]$ ] .",
    "* @xmath1121 $ ] is isomorphic to @xmath1122 $ ] by map @xmath1123}(w)$ ] . in particular",
    ", @xmath863 implies @xmath1124 .",
    "the image of a convex set by the projection is again convex ( theorem  [ thm : gatedset ] ) , and a convex set in a modular lattice is exactly an interval ( lemma  [ lem : interval ]  ( 2 ) ) .",
    "hence @xmath1120}([p , q])$ ] is equal to a subinterval @xmath1125 $ ] of @xmath934 $ ] , and @xmath1113}([p',q'])$ ] is equal to a subinterval @xmath370 $ ] of @xmath524 $ ] . by theorem  [ thm : gatedset ] ,",
    "@xmath1126}$ ] is an isometry between @xmath370 $ ] and @xmath1125 $ ] , and consequently this induces a graph isomorphism between the subgraphs induced by @xmath370 $ ] and @xmath1125 $ ] . by lemma  [ lem : commonorbit ] , for @xmath1127 $ ] , if @xmath1128 then @xmath1120}(g ) \\swarrow { \\mathop{\\rm pr } } _ { [ p',q']}(h)$ ] .",
    "therefore , a poset @xmath370 $ ] is isomorphic to @xmath1125 $ ] by @xmath1129}$ ] .",
    "necessarily @xmath1113}(a ' ) = a$ ] .",
    "notice that @xmath211 is the gate of @xmath60 at @xmath370 $ ] ( by lemma  [ lem : ascending ] ) . by theorem  [ thm : gatedset ]  ( 3 ) ,",
    "@xmath1130 } ( p ) = { \\mathop{\\rm pr } } _ { [ p , q ] } \\circ { \\mathop{\\rm pr } } _ { [ p',q']}(p ) = { \\mathop{\\rm pr } } _ { [ p , q]}(u')$ ] . then @xmath1113}(u ' ) = a = { \\mathop{\\rm pr } } _ { [ p , q]}(a')$ ] implies @xmath1131 ( by theorem  [ thm : gatedset ]  ( 1 ) ) .",
    "similarly @xmath1132 , @xmath1133 , and @xmath1134 .",
    "thus we obtain ( 1 ) and ( 2 ) .",
    "we use the same notation @xmath2 for @xmath61 and @xmath1135 ( since they can be distinguished by the arguments ) .",
    "[ lem : atleast ] @xmath1136 for @xmath1137 .",
    "take a path @xmath1138 between @xmath877 and @xmath878 in @xmath884 .",
    "the length of @xmath274 is equal to @xmath1139 ; hence @xmath1140 holds .",
    "we show the equality by the induction on @xmath1141 .",
    "define @xmath1116 by  ( [ eqn : uvuv ] ) .",
    "then @xmath1142 and @xmath1143 hold .",
    "suppose @xmath1144 .",
    "take an atom @xmath211 of @xmath1145 $ ]",
    ". then @xmath1146 is boolean by ( [ eqn : v ] ) , and @xmath1147 is adjacent to @xmath877 in @xmath884 .",
    "also @xmath1148 ( lemma  [ lem : ascending ] ) , implying @xmath1149 .",
    "by induction , @xmath1150 , and hence @xmath1151 , as required .",
    "consequently we can assume @xmath1152 .",
    "in particular , @xmath1153 , @xmath1154 , and @xmath1155 must hold .",
    "take a neighbor @xmath211 of @xmath60 in @xmath1156 ; then @xmath1157 $ ] .",
    "take a median @xmath358 of @xmath1158 .",
    "then @xmath358 must be a neighbor of @xmath59 and satisfies @xmath1159 .",
    "if @xmath1160 , then @xmath1161 ( lemma  [ lem : ascending ] ) , and the join @xmath1162 in @xmath1108 $ ] is equal to @xmath358 ; this means that @xmath1163 $ ] is a complemented modular lattice , @xmath1164 is boolean , and @xmath1165 is adjacent to @xmath877 .",
    "applying the induction to @xmath1165 and @xmath878 , we obtain the equality ( @xmath1166 ) .",
    "similarly , if @xmath1167 , then @xmath1146 is boolean and apply the induction to @xmath1147 and @xmath878 .",
    "[ [ proof - of - theoremthm2subdivision . ] ] proof of theorem  [ thm:2subdivision ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    any 4-cycle in @xmath884 is represented as @xmath1168 for some edges @xmath1169 in @xmath1 , or @xmath1170 or @xmath1171 for 4-cycle @xmath1172 and vertex @xmath60 in @xmath1 .",
    "this immediately implies that @xmath883 is an admissible orientation and @xmath893 is orbit - invariant .    to show that @xmath884 is modular , we are going to verify that @xmath884 satisfies the two conditions of lemma  [ lem : quadrangle ] .",
    "if @xmath877 and @xmath1173 are joined by an edge , then @xmath240 and @xmath1174 have different parity .",
    "this implies that @xmath884 is bipartite .",
    "we next verify the quadrangle condition ( lemma  [ lem : quadrangle ]  ( 2 ) ) .",
    "take boolean pairs @xmath877 and @xmath878 .",
    "suppose further that we are given two neighbors @xmath1175 and @xmath1176 of @xmath877 with @xmath1177 .",
    "our goal is to show the existence of a common neighbor @xmath1178 of @xmath1179 with @xmath1180 .",
    "it suffices to consider the following three cases :    * @xmath1181 .",
    "* @xmath1182 , @xmath1183 , and @xmath1184 . * @xmath1185 and @xmath1186 .",
    "* case ( i ) .",
    "* by lemma  [ lem : atleast ] , we have @xmath1187 for @xmath427 . by lemma  [ lem : quadrangle ]  ( 2 ) for @xmath1",
    ", there is a common neighbor @xmath243 of @xmath1188 with @xmath1189 .",
    "here @xmath1190 @xmath423 , and hence @xmath1191 . by the convexity of @xmath1111 ( theorem  [ thm : lattice ] )",
    ", we have @xmath1192 , implying @xmath1193 . again , by lemma  [ lem : atleast ] , we have @xmath1194 , as required . + * case ( ii ) .",
    "* we show @xmath1195 , which implies that @xmath1196 is a required common neighbor ( by lemma  [ lem : atleast ] ) .",
    "if @xmath1197 , then @xmath1198 and @xmath1199 imply @xmath1195 ( by ( [ eqn : v ] ) ) .",
    "suppose @xmath1200 .",
    "by lemma  [ lem:[p , q][p,q ] ] , @xmath1113}([p',q'])$ ] is equal to interval @xmath370 $ ] for @xmath1201}(p')$ ] and @xmath1202}(q')$ ]",
    ". then @xmath1203 implies @xmath1204 . similarly @xmath1205 .",
    "thus @xmath1206 and @xmath863 imply @xmath1195 ( by ( [ eqn : v ] ) ) , as required . + * case ( iii ) .",
    "* we show @xmath1207 ; then @xmath1208 is a common neighbor as required .",
    "we use the induction on @xmath1209 ; in the case of @xmath1210 the subsequent argument shows that @xmath1211 $ ] contains an element different from @xmath1212 , and hence @xmath1213 is boolean . since @xmath1214 $ ] is a convex set",
    ", we can consider @xmath1215}([p',q'])$ ] , which is equal to @xmath1121 $ ] for @xmath1216}(p')$ ] , @xmath1217}(q')$ ] ( lemma  [ lem:[p , q][p,q ] ] ) .",
    "then necessarily @xmath1218 ; otherwise @xmath1219 , contradicting the first assumption @xmath1220 .",
    "suppose @xmath1221 .",
    "take an atom @xmath1222 $ ] .",
    "if @xmath1223 , then @xmath1224 is equal to the join @xmath1225 , and consequently the join of atoms in @xmath1214 $ ] . thus @xmath1214 $ ] is complemented , and @xmath1207 ( proposition  [ prop : modularlattice ] ) .",
    "suppose that @xmath1226 .",
    "consider the join @xmath1227 in @xmath1214 $ ] , which belongs to @xmath524 $ ] .",
    "then @xmath1228 ( by @xmath1229 and lemma  [ lem : ascending ] ) . by ( [ eqn : v ] ) ,",
    "both @xmath1230 and @xmath1231 are boolean .",
    "by induction , @xmath1232 , and @xmath1233 $ ] is complemented modular .",
    "thus we can take an atom @xmath1234 of @xmath1235 $ ] with @xmath1236 .",
    "necessarily @xmath1237 ( otherwise both @xmath211 and @xmath60 are covered by @xmath10 and @xmath1227 ; contradicting the fact that @xmath1214 $ ] is a lattice ) . by modularity equality with @xmath1238 , the join @xmath1239 has rank @xmath1240 in @xmath1214 $ ] .",
    "we can take @xmath10 with @xmath1241 .",
    "then @xmath1242 , and @xmath1243 . by the quadrangle condition",
    ", there is a common neighbor @xmath488 of @xmath1244 , which is an atom of @xmath1245 $ ] .",
    "then @xmath1246 , and @xmath1247 .",
    "this means that @xmath1224 is the join of atoms of @xmath1214 $ ] ; thus @xmath1207 . by the same argument ( for @xmath1248 )",
    ", we can assume that @xmath1249 and @xmath1250 .",
    "since @xmath1121 $ ] is isomorphic to a subinterval of complemented modular lattice @xmath934 $ ] ( lemma  [ lem:[p , q][p,q ] ] ) , @xmath1251 (= [ u , v])$ ] is also a complemented modular lattice , implying @xmath1207",
    ". @xmath1098    [ [ proof - of - propositionprop12 . ] ] proof of proposition  [ prop:1/2 ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we have proved ( [ eqn : isometric_embedding ] ) for the case @xmath1252 in lemma  [ lem : atleast ] . by theorem  [ thm:2subdivision ]",
    "shown above , @xmath884 is now a modular graph .",
    "let @xmath274 be a shortest path with respect to @xmath893 .",
    "by lemma  [ lem : shortest ] , this is also shortest with respect to uniform edge - length @xmath1253 .",
    "necessarily the paths obtained from @xmath1254 and @xmath1255 ( by identifying repetitions ) are both shortest in @xmath1 with respect to uniform edge - length @xmath193 .",
    "again , by lemma  [ lem : shortest ] , they are shortest relative to @xmath92 , and have the lengths @xmath1256 and @xmath1257 , respectively . thus ( [ eqn : isometric_embedding ] ) holds .",
    "@xmath1098      consider the 2-subdivision @xmath1258 , which is identified with @xmath1259 by correspondence @xmath1260 ( lemma  [ lem : product ] ) .",
    "consider @xmath1261 .",
    "then we have @xmath1262 where the first equality is the definition ( [ eqn : lovasz ] ) and the second follows from proposition  [ prop:1/2 ] .",
    "hence it suffices to show that @xmath1263 is submodular on @xmath1264 for every @xmath1265 .",
    "therefore , by taking @xmath848 as @xmath844 , theorem  [ thm : d_is_l - convex ] follows from the following .",
    "the distance function @xmath125 is submodular on @xmath1266 for every @xmath1267 .    by proposition  [ prop:2section ]",
    ", it suffices to show the following , where we denote @xmath122 by @xmath2 , and denote the valuation on @xmath1268 ( defined in ( [ eqn : valuations ] ) ) by @xmath397 .    * for every @xmath1269 and every antipodal pair @xmath273 in @xmath1268 , we have @xmath1270 d ( p , u ) + v[p \\wedge q , p ] d(q , u ) \\geq",
    "( v[p \\wedge q , p ] + v[p \\wedge q , q ] ) d(p \\wedge q , u).\\ ] ] * for every @xmath1271 and every @xmath89-bounded pair @xmath273 in @xmath1272 , we have @xmath1273 * for every @xmath1274 with @xmath859 and every @xmath1275 with @xmath1276 , we have @xmath1277    note that ( 2 ) and @xmath1278 correspond to the submodularity condition for @xmath89-bounded pairs .    ( 1 ) .",
    "we may assume that @xmath1279 ( by considering @xmath1280 ) and @xmath1281 .",
    "take a median @xmath40 of @xmath1282 .",
    "by @xmath486 and lemma  [ lem : i(p , q ) ] , there are @xmath1283 $ ] and @xmath1284 $ ] with @xmath1285 .",
    "let @xmath1286 .",
    "then we have @xmath1287 + v(q ' ) + d$ ] , @xmath1288 + v(p ' ) + d$ ] , and @xmath1289 .",
    "hence we get @xmath1290 + v(q ' ) + d\\ }   + v(p ) \\ { v[q',q ] + v(p ' ) + d\\ }   \\\\   & & \\quad \\quad \\quad - \\{v(p ) + v(q)\\ } \\{v(p ' ) + v(q ' ) + d\\ } \\\\ & & = v(q ) v[p',p ] +   v(p ) v[q',q ] - v(p)v(q ' ) - v(q)v(p ' ) \\\\ & & = 2 v[q',q ] v[p',p ] - 2 v(p')v(q ' ) , \\end{aligned}\\ ] ] where we use @xmath1291 $ ] and @xmath1292 $ ] for the last equality",
    ". this must be nonnegative since @xmath273 is antipodal ; see ( [ eqn : antipodal ] )    ( 2 ) . recall the notion of gated sets",
    "( section  [ subsec : gated ] ) ; @xmath1293 $ ] is convex , and is gated ( lemmas  [ lem:2convexity ] and [ lem : interval ] ) .",
    "let @xmath1294}(u)$ ] , and @xmath1286",
    ". then we have @xmath1295 for @xmath1296 .",
    "there are three cases : ( i ) @xmath1297 , ( ii ) @xmath1298 , and ( iii ) @xmath1299 .",
    "note that @xmath1300 forms a 4-cycle since @xmath273 is @xmath89-bounded .",
    "let @xmath1301 = v[p \\wedge q , q]$ ] and @xmath1302 = v[q , p \\vee q]$ ] .",
    "consider the case ( i ) . then @xmath1303 and @xmath1304 . hence @xmath1305 .",
    "consider the case ( ii ) .",
    "then @xmath1306 , and @xmath1307 .",
    "hence @xmath1305 .",
    "consider the case ( iii ) .",
    "then @xmath40 is a common neighbor of @xmath1308 different from @xmath232 .",
    "hence all edges in @xmath1293 $ ] belong to the same orbit .",
    "thus @xmath1309 , @xmath1310 , @xmath1311 , and @xmath1312 .",
    "consider @xmath1313 .",
    "let @xmath1314 .",
    "there are two cases : ( i ) @xmath1315 and ( ii ) @xmath1316 . consider the case ( i ) . for @xmath1116 with @xmath1317 and @xmath1318 , we have @xmath1319 , @xmath1320 , @xmath1321 , and @xmath1322 .",
    "thus @xmath1323 , and the equality holds in @xmath1278 .",
    "consider the case ( ii ) . by theorem  [ thm : gatedset ] and",
    "lemma  [ lem : commonorbit ] , we have @xmath1324 , @xmath1325 , @xmath1326 , and that @xmath58 and @xmath251 must belong to the same orbit @xmath282",
    ". then @xmath1327 .",
    "therefore @xmath1278 holds .",
    "the above proof works even when @xmath1328 and @xmath1329 are replaced by the principal filters @xmath1330 and @xmath1331 , respectively , since they are convex and are ( not necessarily complemented ) modular semilattices ( lemma  [ lem : filter ] )",
    ". therefore theorem  [ thm : d_is_submodular ] follows from theorem  [ thm : bvv ] and :    the distance function @xmath122 is submodular on @xmath1332 for every @xmath1333 .",
    "let @xmath849 be a modular complex and let @xmath79 be a function on @xmath26 .",
    "let @xmath1334 denote the graph obtained from @xmath1 by joining all boolean pairs @xmath273 ( with @xmath1335 ) .",
    "namely @xmath1334 is the 1-skeleton graph of the complex @xmath1336 . for @xmath1337 , the _ level - set subgraph _",
    "@xmath1338 is the subgraph of @xmath1334 induced by the set of vertices @xmath60 with @xmath1339 .",
    "the following connectivity property of @xmath1338 rephrases the l - optimality criterion ( theorem  [ thm : l - optimality ] ) .",
    "[ prop : connected ] let @xmath79 be an l - convex function on @xmath844 , and let @xmath1340 . for every @xmath1341 , the level - set graph @xmath1342 is connected .",
    "in addition , if @xmath1343 , then every vertex in @xmath1344 is adjacent to a vertex of @xmath1345 in @xmath1342 .    in a crucial step of the proof ,",
    "we use the following general property of submodular functions on a modular semilattice , where a sequence @xmath1346 of elements in a poset is said to be _ comparable _ if @xmath1347 or @xmath1348 for @xmath1349 .",
    "[ lem:2term ] let @xmath86 be a submodular function on a modular semilattice @xmath353 .",
    "for @xmath389 and @xmath1337 , if @xmath1350 and @xmath1351 , there exists a comparable sequence @xmath1352 such that @xmath1353 for @xmath762 .",
    "we can assume that @xmath1354 by letting @xmath1355 .",
    "also we may assume that @xmath60 and @xmath59 are incomparable ; @xmath550 is a polygon , and hence @xmath1356 < 1 $ ] and @xmath1357 < 1 $ ] .",
    "consider inequality ( [ eqn : gsubmo ] ) : @xmath1358 ) f(p ) + ( 1 - [ c(q;p , q ) ] ) f(q )   \\geq f(p \\wedge q ) + \\sum_{u \\in { \\cal e}({p , q } ) \\setminus \\{p , q\\ } } [ c(u;p , q ) ] f(u).\\ ] ] then the left hand side is negative , and hence the right hand side is negative . if @xmath1359 , then @xmath1360 is a required sequence .",
    "otherwise there exists @xmath1361 with @xmath1362 ( since @xmath583 $ ] is nonnegative ) . by an inductive argument ( on distance between @xmath60 and @xmath59 ) , there are comparable sequences @xmath1363 and @xmath1364 with @xmath1365 and @xmath1366 .",
    "concatenating them , we obtain a required sequence .    [ [ proof - of - propositionpropconnected . ] ] proof of proposition  [ prop : connected ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    suppose ( indirectly ) that @xmath1367 is disconnected for some @xmath1368 .",
    "for a sufficiently large @xmath1369 , the graph @xmath1338 is equal to @xmath1334 , and is connected ( since @xmath1 is finite and @xmath79 has no infinite value ) . also , for a sufficiently small @xmath1370 , it holds @xmath1371 .",
    "this implies that there exists @xmath1341 such that @xmath1338 is connected , and @xmath1372 is disconnected .",
    "then there exists a pair of vertices @xmath1373 belonging to different components in @xmath1372 ; in particular @xmath1374 and @xmath1375 .",
    "take such a pair @xmath131 with @xmath1376 minimum .",
    "there exists a path @xmath1377 in @xmath1338 with @xmath1378 for @xmath1379 .",
    "we first show @xmath1380 .",
    "consider @xmath1381 and @xmath1382 on @xmath1381 .",
    "we may assume that @xmath1383 .",
    "let @xmath1384 if @xmath1385 and @xmath1386 if @xmath1387",
    ". then @xmath1388 and @xmath1389 .",
    "therefore , by lemma  [ lem:2term ] , there exists a comparable sequence @xmath1390 in @xmath1381 such that @xmath1391 for @xmath1392 .",
    "consider @xmath1393 , which is equal to @xmath1394 for some @xmath1395 with @xmath1396 .",
    "then ( i ) @xmath1397 or ( ii ) @xmath1398 .",
    "consider case ( i ) . by ( [ eqn : ppqq ] )",
    ", we have @xmath1399 . by ( [ eqn : v ] ) ,",
    "we have @xmath1400 for @xmath427 . thus both @xmath59 and @xmath454 are adjacent to each of @xmath1401 and @xmath1402 ( in @xmath1334 ) .",
    "by @xmath1403 , we have @xmath1404 or @xmath1405 .",
    "say @xmath1404 ; @xmath59 is adjacent to @xmath1401 and @xmath1402 in @xmath1342 .",
    "if @xmath59 and @xmath406 belongs different components in @xmath1406 , then path @xmath1407 violates the minimality assumption .",
    "this means that @xmath59 and @xmath406 belong to the same component , which is different from the component that @xmath60 belongs to .",
    "thus we could have chosen path @xmath1408 of length @xmath89 .",
    "this implies that @xmath1380 and @xmath1409 .",
    "consider case ( ii ) . by ( [ eqn : ppqq ] ) and @xmath1410 , we have @xmath1411 and @xmath1412 .",
    "hence @xmath1413 , and @xmath1414 ( by ( [ eqn : v ] ) ) .",
    "also , we have @xmath1415 , and @xmath454 is adjacent to each of @xmath1401 and @xmath1402 . as above , by the minimality , we must have @xmath1416 and @xmath1409 .",
    "suppose that @xmath779 is represented by @xmath1417 for @xmath1418 with @xmath1419 ( @xmath1349 )",
    ". then @xmath1420 or @xmath1421 .",
    "again by ( [ eqn : v ] ) , both @xmath1422 and @xmath1423 are adjacent to each of @xmath1424 and @xmath1425 in @xmath1334 . also , by @xmath1426 , at least one of @xmath1427 and @xmath1428 is less than @xmath1369 .",
    "this means that there is a path in @xmath1372 connecting @xmath60 and @xmath406 .",
    "this is a contradiction to the initial assumption that @xmath60 and @xmath406 belong to distinct components in @xmath1372 .",
    "we show the latter part .",
    "take @xmath1429 .",
    "then there is a pair of @xmath985 and a path @xmath1430 in @xmath1334 such that @xmath1404 and @xmath1378 for @xmath373 .",
    "take such a pair with the minimum length @xmath95 .",
    "we show @xmath257 .",
    "suppose that @xmath1431 .",
    "as above , by considering @xmath1382 on @xmath1381 , we can find a neighbor @xmath454 of @xmath1402 with @xmath1432 .",
    "this is a contradiction to the minimality of @xmath95 .",
    "hence @xmath257 , implying the latter statement . @xmath1098",
    "in this section , we study , from the viewpoint developed in the previous sections , the minimum @xmath0-extension problem * 0-ext*@xmath8 $ ] on an orientable modular graph @xmath1 . in section  [ subsec :",
    "location ] , we verify that * 0-ext*@xmath8 $ ] can be formulated as an l - convex function minimization on a modular complex @xmath1433 . in section  [ subsec : criterion ] , we present a powerful optimality criterion ( theorem  [ thm : optimality ] ) for * 0-ext*@xmath8 $ ] by specializing the l - optimality criterion ( theorem  [ thm : l - optimality ] ) . in section  [ subsec : proof_main ]",
    "we prove the main theorem ( theorem  [ thm : main ] ) of this paper . in section  [ subsec : nongraphical ] we consider the minimum 0-extension problem for metrics , not necessarily graph metrics , and extend theorem  [ thm : main ] to metrics .",
    "let @xmath1 be an orientable modular graph with an orbit - invariant function @xmath92 .",
    "we are given a finite set @xmath3 with @xmath1434 .",
    "suppose that @xmath1435 .",
    "for a nonnegative cost @xmath1436 , let @xmath1437 be a function on @xmath1438 defined by @xmath1439 such a function is called a _ multifacility location function _ on @xmath1 .",
    "a point @xmath1440 in @xmath1441 is called _ a location_. consider the following natural weighted version of * 0-ext*@xmath8 $ ] :    * multifac*@xmath1442 $ ] : : :    minimize @xmath1443 over all    locations @xmath1444 ,    where the unweighted version corresponds to @xmath1445 .",
    "fix an admissible orientation @xmath52 of @xmath1 . by a natural identification @xmath1446",
    ", a location is regarded as a vertex in @xmath1447 . in particular , @xmath1437 is regarded as a function on @xmath1447 . by theorem  [ thm : d_is_l - convex ] and",
    "lemma  [ lem : properties_l - convex ] , we have :    [ thm : l - convex ] multifacility location function @xmath1448 is an l - convex function on modular complex @xmath1449 .",
    "therefore * multifac*@xmath1450 $ ] is an l - convex function minimization on modular complex @xmath1449 .",
    "so we can apply the results in the previous section to * multifac*@xmath1450 $ ] .",
    "let @xmath1451 be a location .",
    "a location @xmath1452 is said to be a _",
    "forward neighbor _ of @xmath1440 if @xmath1453 for all @xmath162 , and is said to be a _ backward neighbor _ of @xmath1440 if @xmath1454 for all @xmath162 . a forward or backward neighbor is simply called a _ neighbor_.",
    "this terminology is due to @xcite . by lemma  [ lem : product ] , the set of forward ( resp .",
    "backward ) neighbors of @xmath1440 is equal to @xmath1455 ( resp .",
    "@xmath1456 ) .",
    "we introduce a sharper concept of a neighbor using orbits .",
    "recall ( [ eqn : l|u ] ) in section  [ subsec : lattice ] for definition of @xmath1457 .",
    "let @xmath282 be an orbit of @xmath1 ; consider @xmath1458 . a forward neighbor @xmath1459 of @xmath1440 is called a _ forward @xmath282-neighbor _ of @xmath1440 if @xmath1460 for all @xmath162 , and is called a _",
    "backward @xmath282-neighbor _ of @xmath1440 if @xmath1461 for all @xmath162 .",
    "the set of all forward ( reps .",
    "backward ) @xmath282-neighbors of @xmath1440 is denoted by @xmath1462 ( resp .",
    "@xmath1463 ) .",
    "a forward or backward @xmath282-neighbor is simply called a _",
    "@xmath282-neighbor_.    the main result in this section is the following optimality criterion , which has been shown for some special cases of orientable modular graphs : trees by kolen  ( * ? ? ?",
    "* chapter 3 ) , median graphs by chepoi  @xcite , and frames by hirai  ( * ? ? ?",
    "* section 4.1 ) .",
    "[ thm : optimality ] let @xmath1 be an orientable modular graph with an admissible orientation @xmath52 and a positive orbit - invariant function @xmath92 . for a location @xmath1440 , the following conditions are equivalent :    * @xmath1440 is optimal to * multifac*@xmath1464 $ ] .",
    "* @xmath1440 is optimal to * multifac*@xmath1465 $ ] . * for every neighbor @xmath1459 of @xmath1440 , we have @xmath1466 .",
    "that is @xmath1467 * for every neighbor @xmath1459 of @xmath1440 , we have @xmath1468 .",
    "that is @xmath1469 * for every orbit @xmath282 and every @xmath282-neighbor @xmath1459 of @xmath1440 , we have @xmath1468 . that is , for every orbit @xmath282 , we have @xmath1470    any orbit @xmath282 in @xmath1 forms an orbit - union in the covering graph of each @xmath870 . by lemma  [ lem : interval ]  ( 3 ) ,",
    "@xmath1471 is a complemented modular lattice , and convex in @xmath870 .",
    "thus all conditions ( 3),(4 ) , and ( 5 ) are checked by submodular function minimization on modular semilattice .    before the proof , we explain consequences of theorem  [ thm : optimality ] .",
    "the first consequence is that in solving * multifac*@xmath1472 $ ] , we may replace @xmath92 with the unit function , even when @xmath92 is not positive .",
    "[ thm : suffice ] for every nonnegative orbit - invariant function @xmath92 , every optimal location in * multifac*@xmath1473 $ ] is optimal to * multifac*@xmath1472 $ ] .",
    "let @xmath1440 be an optimal location for * multifac*@xmath1473 $ ] .",
    "take an arbitrary positive @xmath1370 .",
    "consider the positive orbit invariant function @xmath1474 . by theorem  [ thm : optimality ]",
    ", @xmath1440 is optimal to @xmath1475 $ ] .",
    "hence , for an arbitrary location @xmath1459 , we have @xmath1476 since @xmath1370 was arbitrary , we have @xmath1477 .",
    "the second consequence is a decomposition property of * multifac*@xmath1478 $ ] . for an orbit @xmath282 ,",
    "define @xmath1479 by @xmath1480 see section  [ subsec : orbits ] for the definition of @xmath1481 .",
    "consider the following problem on @xmath1481 : @xmath1482 the optimal value of ( [ eqn : gamma / q ] ) is denoted by @xmath1483 , whereas the optimal value of the original problem * multifac*@xmath1472 $ ] is denoted by @xmath1484 .",
    "then we have @xmath1485 indeed , for any optimal location @xmath1440 in * multifac*@xmath1472 $ ] , define a location @xmath1486 for @xmath1481 by @xmath1487 . by ( [ eqn : into ] ) we have @xmath1488 note that problems * multifac*@xmath1478 $ ] and ( [ eqn : gamma / q ] ) can be considered for a possibly nonorientable modular graph , and the inequality relation ( [ eqn : additive ] ) still holds ; see @xcite . a modular graph @xmath1",
    "is said to be _ orbit - additive _ if ( [ eqn : additive ] ) holds in equality .",
    "karzanov  ( * ? ? ?",
    "* section 6 ) conjectured that every orientable modular graph is orbit - additive .",
    "we can solve this conjecture affirmatively .",
    "[ thm : additive ] every orientable modular graph is orbit - additive .",
    "take an optimal solution @xmath1440 in @xmath1489 $ ] . by theorem  [ thm :",
    "suffice ] , @xmath1440 is also optimal to @xmath1490 $ ] for every orbit @xmath282 , where @xmath1491 is the orbit - invariant function taking @xmath193 on @xmath282 and @xmath0 on @xmath1492 . here",
    "$ ] is equivalent to ( [ eqn : gamma / q ] ) .",
    "hence the inequality in ( [ eqn : additive2 ] ) holds in equality .    if problem ( [ eqn : gamma / q ] ) is solvable in ( strongly ) polynomial time for each orbit , then by theorem  [ thm : additive ] we can evaluate @xmath1493 in ( strongly ) polynomial time , and hence * 0-ext*@xmath8 $ ] is solvable in ( strongly ) polynomial time by the variable - fixing technique ( see the augment after theorem  [ thm : tz ] ) .",
    "as was suggested by karzanov  @xcite , this approach is applicable to the case where each orbit graph of @xmath1 is a frame . then ( [ eqn : gamma / q ] ) is a 0-extension problem on a frame , is solvable in strongly polynomial time , and hence * 0-ext*@xmath8 $ ] is solvable in strongly polynomial time ; the ( strong polytime ) tractability of this class of orientable modular graphs was conjectured by  @xcite .",
    "it should be noted that our proof of the main theorem gives only a weakly polynomial time algorithm .",
    "[ [ proof - of - theoremthmoptimality . ] ] proof of theorem  [ thm : optimality ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    \\(1 ) @xmath1494 ( 3 ) and ( 2 ) @xmath1494 ( 4 ) follow from theorems  [ thm : l - optimality ] and [ thm : l - convex ] .",
    "( 4 ) @xmath321 ( 5 ) is obvious .",
    "\\(3 ) @xmath321 ( 5 ) .",
    "suppose that @xmath1459 is a @xmath282-neighbor of @xmath1440 .",
    "then @xmath1495 for orbit @xmath1496 different from @xmath282 , and @xmath1497 .",
    "by ( [ eqn : into ] ) we have @xmath1498 ( 5 ) @xmath321 ( 3 ) and ( 5 ) @xmath321 ( 4 ) . by lemma  [ lem : interval ]  ( 3 ) ,",
    "@xmath1499 is convex in @xmath914 , and we can define @xmath1500 for @xmath1501 .    for @xmath272 , @xmath1502 , and @xmath1503 , we have @xmath1504    first we remark @xmath1505 indeed , if @xmath1506 , then @xmath1507 and @xmath60 are joined by edges in @xmath1508 , and hence @xmath1509 . if @xmath1510 , then @xmath406 and @xmath1507 are joined by @xmath1492 ( lemma  [ lem : interval ]  ( 3 ) ) , and hence @xmath1511 .",
    "thus we have @xmath1512    let @xmath1440 be a location , and let @xmath1459 be a forward neighbor of @xmath1440 .",
    "for each orbit @xmath282 , define the forward @xmath282-neighbor @xmath1513 by @xmath1514 for @xmath156 . by the above lemma",
    ", we have @xmath1515 from this , we have ( 5 ) @xmath321 ( 3 ) and ( 5 ) @xmath321 ( 4 ) .      in this section",
    ", we complete the proof of the main theorem ( theorem  [ thm : main ] ) stating that * 0-ext*@xmath8 $ ] for every orientable modular graph @xmath1 can be solved in polynomial time . by theorem  [ thm : l - convex ] , an instance * multifac*@xmath1516 $ ] of * 0-ext*@xmath8 $ ] is the problem of minimizing the sum @xmath1517 of l - convex constraints on @xmath1449 , where the arity of each constraint is @xmath89 .",
    "hence , every location @xmath1518 , and sign @xmath911 , @xmath1517 is the sum of arity-2 submodular constraints on @xmath1519 , where each semilattice @xmath1520 is constructed in polynomial time ( proposition  [ prop : modularlattice ] ) . by theorem  [ thm : minimized ] , we can minimize @xmath1517 over @xmath1521 in polynomial time .",
    "therefore we can assume that we have a _ descent oracle _",
    ", an oracle that returns an optimal solution of this ( local ) problem .    by theorem  [ thm : l - optimality ] and the steepest descent algorithm , we can obtain a global optimal solution . as mentioned already",
    ", we do not know whether the number of descent steps is polynomially bounded . fortunately , in the case of multifacility location functions , a cost - scaling approach gives a _ weakly _ polynomial bound on the number of descent steps .",
    "now the main theorem ( theorem  [ thm : main ] ) follows from the following .",
    "suppose that @xmath10 is integer - valued .",
    "$ ] can be solved with @xmath1523 calls of the descent oracle , where @xmath1524 and @xmath1525 denotes the diameter of @xmath1 .",
    "let @xmath1526 be defined by @xmath1527 ( the largest integer not exceeding @xmath1528 ) .",
    "let @xmath1440 be an optimal location in @xmath1529 $ ] , and let @xmath1530 be an optimal location in @xmath1531 $ ] .",
    "we show @xmath1532 if ( [ eqn : steps ] ) is true , then the number of the descent steps from an initial starting point @xmath1440 is bounded by @xmath1533 .",
    "consequently , by recursive scaling , we obtain an optimal solution for @xmath1522 $ ] in @xmath1523 descent steps .",
    "let @xmath565 be a @xmath1534-valued cost defined by @xmath1535 .",
    "then we have @xmath1536 where we use the facts that @xmath1440 is also an optimal location in @xmath1537 $ ] and that each term in @xmath1538 ( for any location @xmath1459 ) is at most @xmath1525 .",
    "let @xmath99 be a metric on a finite set @xmath1539 ( not necessarily a graph metric ) .",
    "we can naturally consider the minimum @xmath0-extension problem * 0-ext*@xmath1540 $ ] for a general @xmath99 formulated as : _ given a set @xmath19 and @xmath1541 , find a @xmath0-extension @xmath18 of @xmath22 with @xmath1542 minimum_. metric @xmath99 is said to be _ modular _ if @xmath22 is a modular metric space ( see section  [ sec : preliminaries ] ) .",
    "let @xmath1543 be the graph on the vertex set @xmath1539 with edge set @xmath1544 given as : @xmath1545 @xmath1494 there is no @xmath1546 with @xmath1547 .",
    "@xmath1543 is called the _ support graph _ of @xmath99 .",
    "karzanov  @xcite extended the hardness result ( theorem  [ thm : hard ] ) to the following .",
    "[ thm : mu_hard ] if @xmath99 is not modular or @xmath1543 is not orientable , then * 0-ext*@xmath1540 $ ] is np - hard .    we can also consider lp - relaxation * ext*@xmath1540 $ ] obtained by relaxing @xmath0-extensions into extensions in * 0-ext*@xmath1540 $ ] . extending theorem",
    "[ thm : minimizable ] , bandelt , chepoi , and karzanov  @xcite proved that * ext*@xmath1540 $ ] is exact if and only if @xmath99 is modular and @xmath1543 is frame .",
    "our framework covers * 0-ext*@xmath1540 $ ] for a metric @xmath99 such that @xmath99 is modular and @xmath1548 is orientable .",
    "indeed @xmath99 induces the edge - length @xmath1549 on @xmath1548 by @xmath1550 @xmath1551 . from the definition of the support graph @xmath1548",
    ", we have @xmath1552 .",
    "moreover , it was shown in @xcite ( see ( * ? ? ?",
    "* section 2 ) ) that    if @xmath99 is modular , then @xmath1548 is a modular graph , and @xmath1549 is orbit - invariant .",
    "hence we can apply the argument in section  [ sec:0extension ] to * multifac*@xmath1553 $ ] to obtain results for * 0-ext*@xmath1540 $ ] . by theorems  [ thm : main ] and [ thm :",
    "optimality ] , we obtain the converse of theorem  [ thm : mu_hard ] , which completes the classification of those metrics for which * 0-ext*@xmath1540 $ ] is tractable .",
    "[ thm : main_mu ] if @xmath99 is modular and @xmath1543 is orientable , then * 0-ext*@xmath1540 $ ] is solvable in polynomial time .",
    "in this paper , we established the  p or np - hard \" classification of the minimum 0-extension problem .",
    "this dichotomy result is related to a special case of a dichotomy theorem for _ finite - valued csp _ due to thapper and ivn  @xcite . here",
    "we briefly explain their result and its relation to our result .    to describe their result , we formulate valued csp in a setting slightly different from that in section  [ subsec : vcsp ] .",
    "let @xmath141 be a finite set .",
    "a ( finite - valued ) _ cost function _ on @xmath141 is a function @xmath1554 for some @xmath1555 . a ( finite - valued ) _ constraint language _ , or simply , _ language _ on @xmath141 is a set @xmath153 of cost functions on @xmath141 .",
    "let @xmath1556 be a set of variables . by a _ @xmath153-constraint _ , we here mean a triple @xmath1557 of a nonnegative weight @xmath1558 , a cost function @xmath86 in @xmath153 , and a map @xmath1559 .",
    "for a constraint language @xmath153 , the problem @xmath1560 $ ] is formulated as :    @xmath1560 $ ] : : :    given a set @xmath1561 of    @xmath153-constraints , +    minimize    @xmath1562    over all @xmath1563 .",
    "this is also a subclass of * vcsp * studied in section  [ subsec : vcsp ] .",
    "therefore we can consider the basic lp relaxation ( blp ) .",
    "@xmath40-ary fractional polymorphism _ for @xmath153 is a formal convex combination @xmath1564 of @xmath40-ary operations @xmath1565 such that @xmath1566 where an operation @xmath1567 is extended to an operation @xmath1568 by @xmath1569 .",
    "if @xmath1570 , then @xmath190 is said to be _ unary _ , and if @xmath42 , then @xmath190 is said to be _",
    "binary_. a binary fractional polymorphism @xmath190",
    "is said to be _ symmetric _ if its support consists of symmetric operations , i.e. , operations @xmath186 satisfy @xmath1571 for @xmath1572 , and @xmath190 is said to be _ idempotent _ if its support consists of idempotent operations , i.e. , operations @xmath186 satisfy @xmath1573 for @xmath1574 . just after the developments @xcite ( see @xcite ) , thapper and ivn  @xcite established the following dichotomy theorem for finite - valued csp . here",
    "a language @xmath153 is said be a _ core _ if for every unary fractional polymorphism ,",
    "its support consists of injective operations ; it is shown in @xcite that @xmath1560 $ ] is polynomial time reducible to @xmath1575 $ ] for a core language @xmath1576 .",
    "[ thm : tz13 ] let @xmath153 be a finite - valued core language on @xmath141 .",
    "if @xmath153 admits a binary symmetric and idempotent fractional polymorphism , then blp is exact for @xmath153 , and @xmath1560 $ ] can be solved in polynomial time . otherwise @xmath1560",
    "$ ] is np - hard .",
    "the minimum 0-extension problem can naturally be formulated as @xmath1560 $ ] .",
    "let @xmath99 be a ( rational - valued ) metric on @xmath141 ; we can assume that @xmath1577 whenever @xmath1578 .",
    "the metric @xmath1579 itself is regarded as a binary cost function on @xmath141 . for @xmath1580 ,",
    "let @xmath1581 be a unary cost function on @xmath141 defined by @xmath1582 let @xmath1583 be a ( finite - valued ) constraint language defined by @xmath1584 by definition , we have :    @xmath1585 $ ] @xmath1166 * 0-ext*@xmath1540 $ ] .",
    "moreover we have :    @xmath1583 is a core language .",
    "take a unary fractional polymorphism @xmath1564 for @xmath1583",
    ". then it holds @xmath1586 therefore @xmath1587 must hold .",
    "this means that the support of @xmath190 consists of the identity map on @xmath141 , which is trivially injective .",
    "therefore theorem  [ thm : tz13 ] is applicable to * 0-ext*@xmath1540 $ ] .",
    "in particular , theorems  [ thm : mu_hard ] and [ thm : main_mu ] can be viewed as a sharpening of theorem  [ thm : tz13 ] for constraint languages @xmath1588 .",
    "for those metrics @xmath99 in theorem  [ thm : main_mu ] , core language @xmath1583 must have a binary symmetric and idempotent fractional polymorphism , and * 0-ext*@xmath1540 $ ] must be solved directly by blp ( under the assumption p @xmath1589 np ) . in remark",
    "[ rem : nonsemilattice ] , we have verified this fact for the case where @xmath99 is the metric on a modular semilattice @xmath353 ; it is a good exercise to construct a binary symmetric and idempotent fractional polymorphism from ( [ eqn : polymorphism_submo ] ) .",
    "we however could not find such a fractional polymorphism for the general case .",
    "as seen in section  [ sec : submo ] , a fractional polymorphism can rather be complicated and consist of a large number of operations . to construct a fractional polymorphism as required , it might need a further thorough investigation on orientable modular graphs .",
    "we thank the referee for helpful comments , and thank kazuo murota for careful reading and numerous helpful comments , kei kimura for discussion on valued - csp , satoru iwata for communicating the paper  @xcite of kuivinen , akiyoshi shioura for the paper  @xcite of kolmogorov , and satoru fujishige for the paper  @xcite of huber - kolmogorov .",
    "this research is partially supported by the aihara project , the first program from jsps , by global coe program `` the research and training center for new development in mathematics '' from mext , and by a grant - in - aid for scientific research from the ministry of education , culture , sports , science and technology of japan .",
    "bandelt and v. chepoi , metric graph theory and geometry : a survey , in : j.e .",
    "goodman , j. pach , and r. pollack eds . , _",
    "surveys on discrete and computational geometry : twenty years later _ , 4986 , american mathematical society , providence , 2008 .",
    "g. birkhoff , _ lattice theory _ , american mathematical society , new york , 1940 ; 3rd edn .",
    ", american mathematical society , providence , ri , 1967 .",
    "s. bistarelli , u. montanari , and f. rossi , semiring - based constraint satisfaction and optimization , _ journal of the acm _ * 44 * ( 1997 ) , 201236 .                                          a. huber and v. kolmogorov , towards minimizing @xmath95-submodular functions , in : _ proceedings of the 2nd international symposium on combinatorial optimization ( isco12 ) _ , lncs 7422 , springer , berlin , 2012 , pp .",
    "451462 .",
    "v. kolmogorov , submodularity on a tree : unifying l@xmath72-convex and bisubmodular functions , in : _ proceedings of the 36th international symposium on mathematical foundations of computer science ( mfcs11 ) _ , lncs 6907 , springer , berlin , 2011 , pp .",
    "400411    v. kolmogorov , the power of linear programming for finite - valued csps : a constructive characterization , in : _ proceedings of the 40th international colloquium , icalp 2013 _ , lncs 7965 , 2013 , pp . 625636 .",
    "t. schiex , h. fargier , and g. verfaillie , valued constraint satisfaction problems : hard and easy problems , in _ proceedings of the 14th international joint conference on artificial intelligence ( ijcai95 ) _ , 1995 ."
  ],
  "abstract_text": [
    "<S> a @xmath0-extension of graph @xmath1 is a metric @xmath2 on a set @xmath3 containing the vertex set @xmath4 of @xmath1 such that @xmath2 extends the shortest path metric of @xmath1 and for all @xmath5 there exists a vertex @xmath6 in @xmath1 with @xmath7 . </S>",
    "<S> the minimum @xmath0-extension problem * 0-ext*@xmath8 $ ] on @xmath1 is : given a set @xmath9 and a nonnegative cost function @xmath10 defined on the set of all pairs of @xmath3 , find a @xmath0-extension @xmath2 of @xmath1 with @xmath11 minimum . </S>",
    "<S> the @xmath0-extension problem generalizes a number of basic combinatorial optimization problems , such as minimum @xmath12-cut problem and multiway cut problem .    </S>",
    "<S> karzanov proved the polynomial solvability of * 0-ext*@xmath8 $ ] for a certain large class of modular graphs @xmath1 , and raised the question : what are the graphs @xmath1 for which * 0-ext*@xmath8 $ ] can be solved in polynomial time ? </S>",
    "<S> he also proved that * 0-ext*@xmath8 $ ] is np - hard if @xmath1 is not modular or not orientable ( in a certain sense ) .    in this paper , </S>",
    "<S> we prove the converse : if @xmath1 is orientable and modular , then * 0-ext*@xmath8 $ ] can be solved in polynomial time . </S>",
    "<S> this completes the classification of graphs @xmath1 for which * 0-ext*@xmath8 $ ] is tractable . to prove our main result </S>",
    "<S> , we develop a theory of discrete convex functions on orientable modular graphs , analogous to discrete convex analysis by murota , and utilize a recent result of thapper and ivn on valued csp . </S>"
  ]
}