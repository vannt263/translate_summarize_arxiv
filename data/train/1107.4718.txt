{
  "article_text": [
    "* notation and conventions . *",
    "a virtual string , or flat virtual knot , is a combinatorial generalization of a curve on a surface .",
    "virtual knots were introduced by kauffman @xcite . in this paper",
    "we use turaev s terminology , and refer to flat virtual knots as virtual strings @xcite .",
    "we represent virtual strings with gauss diagrams , following the conventions in @xcite .",
    "the _ minimal self - intersection number _ of a virtual string @xmath1 is the minimum number of arrows of a string in the virtual homotopy class of @xmath1 .",
    "we refer the reader to section [ sec : strings ] for precise definitions of virtual strings and their homotopy classes . for a ( reduced ) finite linear combination @xmath3 in the free @xmath4-module",
    "@xmath5 $ ] , where @xmath6 and @xmath7 , we put @xmath8 and call it the _ number of terms of @xmath9_. +   + turaev @xcite defined a lie cobracket @xmath10 on the free @xmath11-module generated by the set of nontrivial homotopy classes of virtual strings .",
    "we define an operation @xmath0 on the same @xmath11-module .",
    "turaev s cobracket factors through @xmath0 , so we view @xmath0 as a generalization of @xmath10 .",
    "both operations give lower bounds on the minimal self - intersection number of a virtual string @xmath1 .",
    "let @xmath12 $ ] denote the homotopy class of the virtual string @xmath1 .",
    "let @xmath13)$ ] denote the minimal self - intersection number of @xmath1 .",
    "the bounds on @xmath13)$ ] given by @xmath0 and @xmath10 are @xmath14)\\geq t(\\mu([\\alpha]))/2 + n-1,\\ ] ] and @xmath15)\\geq t(\\nu([\\alpha]))/2 + n-1,\\ ] ] where @xmath16 is the largest integer such that a representative @xmath17 $ ] with minimal self - intersection in @xmath12 $ ] can be realized as a curve @xmath18 on a surface @xmath19 , and @xmath20 for some @xmath21 in @xmath22 .",
    "( recall that a virtual string @xmath1 is _ realized _ as a curve @xmath23 on an oriented surface @xmath19 if the gauss diagram of @xmath23 is @xmath1 . )",
    "these bounds follow easily from the definitions of @xmath0 and @xmath10 ; see section [ sec : bounds ] .",
    "the operation @xmath0 @xcite and turaev s cobracket @xmath10 @xcite were previously defined on the free @xmath11-module generated by the set of nontrivial free homotopy classes of loops on a surface . in @xcite , we proved that , when formulated for curves on an orientable surface @xmath19 , inequality is an equality . in other words",
    ", we have @xmath24 where @xmath25 denotes the minimum number of self - intersection points of a curve in the free homotopy class @xmath26 , and @xmath16 is the largest integer such that @xmath27 for some @xmath28 . on the other hand ,",
    "chas @xcite showed that , when formulated for curves on surfaces , inequality is not an equality in general .",
    "we ask whether the above bounds are equalities in the virtual category .",
    "we suspect that @xmath13)= t(\\mu([\\alpha]))/2 + n-1 $ ] is true in the virtual category for all classes @xmath12 $ ] ; theorem [ primitiveformulaintro ] allows us to construct examples of classes @xmath12 $ ] such that this equality holds . on the other hand",
    ", there are strings such that @xmath13)\\neq t(\\nu([\\alpha]))/2 + n-1 $ ] in the virtual category ; see section [ sec : bounds ] and corollary [ primitiveformulaintrocor ] .",
    "turaev s primitive based matrices @xcite , which appear in the statement of theorem [ primitiveformulaintro ] , are reviewed in section [ sec : matrices ] .",
    "self - complementary elements are defined in subsection [ sec : compositemoves ] .",
    "+   +    [ primitiveformulaintro ] let @xmath1 be a virtual string , whose based matrix @xmath29 is primitive and does not contain a self - complementary element . then @xmath13)=t(\\mu([\\alpha]))/2 $ ] . if @xmath29 is primitive and does contain a self - complementary element , then either @xmath13)=t(\\mu([\\alpha]))/2 $ ] or @xmath13)=t(\\mu([\\alpha]))/2 + 1 $ ] .",
    "( note that for the strings where @xmath13)=t(\\mu([\\alpha]))/2 $ ] , we must have @xmath30 , and for strings where @xmath13)=t(\\mu([\\alpha]))/2 + 1 $ ] , we must have @xmath30 or @xmath31 . )",
    "it follows from this result that , as is the case for curves on surfaces , the bound on the minimal self - intersection number given by @xmath0 is stronger than the bound given by @xmath10 .",
    "[ primitiveformulaintrocor ] the bound on @xmath13)$ ] given by @xmath0 is stronger than the bound given by turaev s cobracket @xmath10 .",
    "namely , the number of terms of @xmath32)$ ] is greater than or equal to the number of terms of @xmath33 $ ] , and there are virtual homotopy classes @xmath12 $ ] such that this inequality is strict .",
    "theorem [ main2 ] compares the bound on @xmath13)$ ] given by @xmath0 to a lower bound @xmath2 given by turaev s based matrix invariant .",
    "the integer - valued invariant @xmath2 is introduced in @xcite , and we discuss it in section [ sec : matrices ] .",
    "for now we just note that @xmath13)\\geq \\rho([\\alpha])$ ] .",
    "the quantity @xmath34 is an even integer that counts certain elements of the based matrix of @xmath1 and is defined in section [ sec.boundcomparison ] .",
    "[ main2 ] let @xmath1 be any virtual string .",
    "then @xmath35)\\geq t(\\mu(\\alpha))/2\\geq \\rho([\\alpha])-1+o/2.\\ ] ] if the primitive based matrix associated to @xmath12 $ ] does not contain a self - complementary element , then @xmath35)\\geq t(\\mu(\\alpha))/2\\geq \\rho([\\alpha])+o/2.\\ ] ]    while we can only prove that @xmath36))/2\\geq\\rho([\\alpha])-1 $ ] in general , and hence that @xmath36))/2+n-1\\geq\\rho([\\alpha])-1 $ ] , we do not know of any examples where @xmath36))/2+n-1=\\rho([\\alpha])-1 $ ] , and we suspect that @xmath36))/2+n-1\\geq\\rho([\\alpha])$ ] .    in fact , we construct a string @xmath1 that shows that the bound given by @xmath0 is sometimes stronger than the bound @xmath37)$ ] .",
    "the same string also illustrates that the bound given by @xmath0 is stronger than the bound given by @xmath10 .",
    "[ mainexample]the string @xmath1 in figure [ gibsonex.fig ] satisfies the following inequality : @xmath36))/2 > \\rho([\\alpha])$ ] .",
    "more precisely , @xmath36))/2=5 $ ] and @xmath37)=4 $ ] .",
    "it is also easy to check that @xmath38)=0 $ ] , so @xmath36))/2>t(\\nu([\\alpha]))/2 $ ] , illustrating corollary [ primitiveformulaintrocor ] .     such that the bound on @xmath13)$ ] given by @xmath32)$ ] is greater than @xmath37)$].,width=226 ]    _ remark : _ we do not focus on algorithmic methods of computing @xmath13)$ ] in this paper .",
    "the results of ilyutko , manturov , and nikonov in @xcite imply that an algorithm described in @xcite compues the minimal self - intersection number .",
    "we use these results to show that the string in example [ mainexample ] has the desired properties .",
    "in this section , we recall turaev s definition of virtual strings and their homotopy classes , and we use the notation found in @xcite .",
    "we then define signed singular virtual strings and their homotopy classes , which are closely related to the singular virtual strings studied by henrich @xcite .",
    "once we have these definitions , we will be able to define turaev s cobracket and the operation @xmath0 .",
    "turaev s cobracket takes values in the free @xmath11-module generated by nontrivial homotopy classes of virtual strings , tensored with itself over @xmath11 . the operation",
    "@xmath0 takes values in the free @xmath11-module generated by homotopy classes of signed singular virtual strings .",
    "a _ virtual string @xmath1 of rank @xmath39 _ is an oriented copy of @xmath40 , called the core circle of @xmath1 , with @xmath39 arrows @xmath41 whose tail and head are attached to the points @xmath42 and @xmath43 of @xmath40 , respectively .",
    "we require that the endpoints of the arrows be distinct .",
    "the set of arrows of @xmath1 is denoted @xmath44 .    a _ singular virtual string _",
    "@xmath45 is a virtual string with a choice of distinguished arrow @xmath46 .",
    "a _ signed singular virtual string _",
    "@xmath47 is a singular virutal string with a distinguished arrow @xmath48 , where the distinguished arrow is equipped with a sign @xmath49 .",
    "a _ curve _ on an oriented surface @xmath19 is a generic immersion @xmath50 , where generic means that its self - intersection points are transverse double points .",
    "every curve on an oriented surface has an _ underlying virtual string _ , which is also known as its gauss diagram .",
    "this string @xmath51 is obtained as follows .",
    "there is one arrow @xmath41 corresponding to each self - intersection point @xmath52 of @xmath23 .",
    "the tail @xmath42 and head @xmath43 are chosen so that the ordered pair of tangent vectors @xmath53 gives a positive orientation of @xmath54 .",
    "the string @xmath51 depends on the choice of orientation of @xmath19 ; changing the orientation of @xmath19 would reverse the direction of each arrow in @xmath51 .",
    "we say that the curve @xmath23 _ realizes _ the string @xmath1 if @xmath1 is the underlying string of @xmath23 , i.e. , @xmath55 .",
    "conversely , every string @xmath1 realizes some curve @xmath23 on an oriented surface @xmath19 , and this can be done canonically ; this construction can be found in @xcite .",
    "let @xmath56 be a copy of @xmath40 with an interval @xmath57 $ ] ( called a chord ) attached to @xmath40 at its endpoints .",
    "a _ singular curve _ on an oriented surface @xmath19 is a map @xmath58 such that @xmath23 maps the chord of @xmath56 to a single point , and such that @xmath59 is a curve on @xmath19 .",
    "when we draw @xmath23 , we draw a thick dot on top of the self - intersection point of @xmath23 whose preimage is the chord of @xmath56 , and we call this the _ distinguished _ self - intersection point of @xmath23 .",
    "a singular curve is a special case of a _",
    "geometrical chord diagram _ , defined by andersen , mattes , and reshetikhin @xcite .",
    "a _ signed singular curve _ on an oriented surface @xmath19 is a singular curve @xmath23 on @xmath19 whose distinguished self - intersection point is equipped with a sign @xmath49 .",
    "the _ underlying ( signed ) singular virtual string _",
    "@xmath51 of a ( signed ) singular curve @xmath23 is the underlying virtual string of @xmath59 , whose distinguished arrow is the arrow corresponding to the distinguished self - intersection point of @xmath23 ( and is equipped with the sign of the distinguished self - intersection point of @xmath23 if @xmath23 is signed ) .",
    "two curves on @xmath19 are in the same free homotopy class if and only if they are related by a sequence of flat reidemeister moves .",
    "we say two signed singular strings are homotopic if and only if they are related by flat reidemeister moves which do * not * involve the distinguished self - intersection point , along with the moves in figures [ type2movewithdot.fig ] and [ type3movewithdot.fig ] .            every signed singular curve @xmath23 can be regarded as a map @xmath60 , such that the two copies of @xmath40 are ordered ; i.e. , labeled with a ` 1 ' and a ` 2 ' .",
    "it is clear how to view @xmath23 as a map from an unordered wedge of two circles to @xmath19 , since if we collapse the chord of @xmath56 to a point , we get @xmath61 .",
    "it remains to explain how to order the two copies of @xmath40 . since @xmath19 is oriented and @xmath23 is generic , we order the pair tangent vectors to @xmath23 at the distinguished self - intersection point @xmath52 of @xmath23 according to the orientation of @xmath19 .",
    "this gives us an order on the two outgoing branches of @xmath23 at @xmath52 .",
    "if the sign @xmath62 of @xmath52 is @xmath63 ( respectively , @xmath64 ) , we label the loop starting on the first ( respectively second ) outgoing branch with a ` 1 ' , and the loop starting on the second ( respectively first ) outgoing branch with a ` 2 ' .",
    "let @xmath65 denote the restriction of @xmath66 to the loop labeled @xmath67 , @xmath68 .",
    "later , we will use the following proposition , whose proof is straightforward :    [ figure8s ] two signed singular curves @xmath23 and @xmath18 are homotopic as signed singular curves if and only if @xmath66 and @xmath69 are free homotopic as maps from an ordered wedge of circles @xmath61 to @xmath19 ; i.e. , if and only if there exists @xmath70 such that @xmath71 for @xmath68 .      by performing a flat reidemeister move on a curve , and recording the effect on its underlying virtual string , one can derive the definition of a reidemeister move for a virtual strings .",
    "this allows one to define a homotopy of virtual strings .",
    "two strings are in the same virtual homotopy class if they can be related by a sequence of the following moves and their inverses @xcite .",
    "we use turaev s notation for consistency .",
    "+   + type 1 : given an arc @xmath72 of @xmath40 containing no endpoints of @xmath1 , add an arrow @xmath73 or an arrow @xmath74 .",
    "+   + type 2 : let @xmath42 and @xmath75 , and @xmath43 and @xmath76 , be the endpoints of two disjoint arcs of @xmath40 , such that neither arc contains an endpoint of an arrow of @xmath1 .",
    "add two arrows @xmath73 and @xmath77 to @xmath1 .",
    "there are four forms of this move depending on the order in which @xmath42 and @xmath75 appear , and the order in which @xmath43 and @xmath76 appear , as one traverses @xmath40 counterclockwise .",
    "note that the new arrows point in opposite directions in all forms of this move .",
    "+   + type 3a : let @xmath78 , @xmath79 , and @xmath80 be three disjoint arcs of @xmath40 , containing no endpoints of @xmath1 .",
    "suppose also that @xmath81 , @xmath82 , and @xmath83 are arrows of @xmath1 .",
    "replace these arrows with the arrows @xmath84 , @xmath85 , and @xmath86 .",
    "+   + type 3b : let @xmath78 , @xmath79 , and @xmath80 be three disjoint arcs of @xmath40 , containing no endpoints of @xmath1 .",
    "suppose also that @xmath41 , @xmath87 and @xmath88 are three arrows of @xmath1 .",
    "replace these arrows with the arrows @xmath89 , @xmath90 , and @xmath91 .",
    "turaev notes this move is not necessary because it can be expressed as a composition of a type 2 and type 3a move .",
    "+   + the virtual homotopy class of @xmath1 is denoted by @xmath12 $ ] .    _ remark : _ one can view a virtual string as a curve on a surface up to free homotopy and stable homeomorphism @xcite ( the case for ordinary virtual knots appeared in @xcite ) , but we do not use this equivalence relation in this paper",
    ". +   +      two singular virtual strings are homotopic if they can be related by a sequence of type 1 - 3 moves for virtual strings , that do * not * affect the distinguished arrow , along with the following moves , and their inverses : +   + signed singular type 2 : let @xmath42 and @xmath75 , and @xmath43 and @xmath76 , be the endpoints of two disjoint arcs of @xmath40 that contain no endpoints of arrows of @xmath1 .",
    "suppose @xmath73 and @xmath77 are arrows of @xmath1 , and suppose furthermore that one of these is the distinguished arrow .",
    "this move changes which of @xmath92 and @xmath93 is the distinguished arrow , and changes the sign of the distinguished arrow .",
    "note there are four forms of this move . also note that no arrows are removed ( in contrast to the ordinary type 2 move )",
    ".    signed singular type 3a and 3b : this is the same as the type 3a or 3b move for ordinary virtual strings , but where one of the three arrows , and the arrow which replaces it , is the distinguished arrow , and the sign on the distinguished arrow is the same before and after the move .",
    "+   + the virtual homotopy class of a signed singular string @xmath94 is denoted @xmath95 $ ] .",
    "if one forgets the signs on these moves , one recovers the moves for singular virtual strings defined in @xcite .",
    "it is easy to see that the underlying signed singular virtual strings of two homotopic signed singular curves on @xmath19 are virtually homotopic , and that the underlying virtual strings of two homotopic curves on @xmath19 are virtually homotopic .",
    "we call a signed singular virtual string @xmath96 if the endpoints @xmath42 and @xmath43 of the distinguished arrow form an arc @xmath72 or @xmath97 of @xmath40 containing no endpoints in its interior .",
    "we call a homotopy class of a signed singular virtual string @xmath96 if it contains a semi - trivial signed singular string . +   +",
    "let @xmath73 be an arrow of the virtual string @xmath1 .",
    "let @xmath98 ( respectively , @xmath99 ) be the virtual string obtained from @xmath1 by deleting all arrows except those with tail and head in the interior of the oriented arc @xmath72 ( respectively , @xmath97 ) .",
    "let @xmath100 be the set of nontrivial homotopy classes of virtual strings .",
    "cobracket @xmath101\\rightarrow\\z[\\mathcal{s}_0]\\otimes\\z[\\mathcal{s}_0]$ ] is a linear map , defined on a single class by @xmath102)=\\sum_{e\\in \\arr(\\alpha)}[\\alpha^1_e]\\otimes[\\alpha^2_e]-[\\alpha^2_e]\\otimes[\\alpha^1_e],\\ ] ] where we set @xmath103=0 $ ] if @xmath104 is trivial .",
    "this map can be extended by linearity to all of @xmath105 $ ] .",
    "one can verify that this definition is independent of the choice of @xmath106 $ ] .",
    "furthermore , the operation @xmath10 is a lie cobracket @xcite .",
    "let @xmath107 denote the set of homotopy classes of singular virtual strings which are not semi - trivial",
    ". set @xmath103=0 $ ] if @xmath104 is semi - trivial .",
    "we define @xmath108)=\\sum_{e\\in \\arr(\\alpha ) } [ \\alpha_e^+]-[\\alpha_e^-].\\ ] ] we extend the definition of @xmath0 by linearity to obtain a map @xmath109\\rightarrow \\mathbb{z}[\\mathcal{s}^\\theta_0]$ ] .",
    "suppose we compute @xmath0 before and after the type 1 move .",
    "after the move , the signed singular virtual strings which come from the new arrow will be semi - trivial , so they do not contribute anything to the sum . +   +",
    "figure [ muinvarr2.fig ] shows the four terms which one form of the type 2 move contributes to @xmath0 .",
    "the first and last terms cancel after an application of the signed singular type 2 move , as do the second and third terms .",
    "the arguments for the other forms of this move are similar .",
    "is invariant under the type 2 move.,width=302 ]    similarly the singular type 3 move allows us to show that @xmath0 is invariant under the ordinary type 3 move .",
    "let @xmath110 be the following  smoothing \" map : +   + given a signed singular virtual string @xmath1 with distinguished arrow @xmath111 and sign @xmath112 ( respectively @xmath113 ) , form the string @xmath114 by deleting the distinguished arrow as well as all arrows except those with head and tail in @xmath115 ( respectively @xmath116 ) , and form the string @xmath117 by deleting the distinguished arrow as well as all arrows except those with head and tail in @xmath116 ( respectively @xmath115 ) .",
    "let @xmath118 , and extend @xmath110 by linearity to @xmath119 $ ]",
    ". then @xmath120",
    "in this section we show why @xmath0 and @xmath10 give the bounds on @xmath13)$ ] stated in the introduction .",
    "[ powers ] let @xmath1 be a virtual string",
    ". then @xmath35)\\geq t(\\mu([\\alpha]))/2 + n-1\\ ] ] and @xmath35)\\geq t(\\nu([\\alpha]))/2 + n-1,\\ ] ] where @xmath16 is the largest integer such that , for some @xmath121 $ ] with minimal self - intersection , @xmath104 can be realized as a curve @xmath18 on an orientable surface @xmath19 with @xmath122 for some @xmath21 in @xmath22 .",
    "suppose that @xmath16 is the largest integer such that , for some @xmath121 $ ] with minimal self - intersection , @xmath104 can be realized as a curve @xmath18 on a surface @xmath19 with @xmath122 for some @xmath21 in @xmath22 .",
    "we will prove that @xmath13)\\geq t(\\mu([\\alpha]))/2 + n-1 $ ] ; the argument for @xmath10 is slightly simpler .",
    "let @xmath123 be a geodesic representative of @xmath21 .",
    "if @xmath123 is not generic ( i.e. , if it has self - intersection points which are not double points ) , perturb @xmath123 slightly to get a generic loop @xmath124 and put @xmath125 .",
    "let @xmath126 be the composition of the following maps : @xmath127 , the degree @xmath128 map of @xmath40 to the annulus @xmath23 such that the image of @xmath129 has @xmath130 double points ; and @xmath131 , an immersion of the annulus into a thin neighborhood of the loop @xmath123 .",
    "see figure [ power.fig ] for an illustration of this composition when @xmath132 .",
    "hass and scott @xcite show this loop @xmath126 has the fewest number of self intersection points of any loop in its free homotopy class on @xmath19 . since @xmath104 has minimal self - intersection in its virtual homotopy class , the loop @xmath18 on @xmath19 realizing @xmath104 has minimal self - intersection in its free homotopy class .",
    "so the number of self intersection points of @xmath18 is equal to the number of self intersection points of @xmath126 , and hence we may assume @xmath104 is the underlying virtual string of @xmath126 , i.e. , we assume @xmath133 .",
    "the number of self intersection points of @xmath126 is @xmath134 , where @xmath52 is the number of self - intersection points of @xmath123 .",
    "now we compute @xmath32)$ ] using the representative @xmath135 .",
    "there are two terms of @xmath0 for each self intersection point @xmath48 of @xmath126 .",
    "these two terms are @xmath136 $ ] and @xmath137 $ ] .",
    "the signed singular virtual strings @xmath138 and @xmath139 are realized by the signed singular virtual curves @xmath140 and @xmath141 on @xmath19 . now suppose @xmath48 is one of the @xmath130 self - intersection points of @xmath126 that comes from the map @xmath127 ; these self - intersection points are labeled with a ` 2 ' in figure [ power.fig ] .",
    "starting on the inside of the annulus , we label these @xmath130 points @xmath142 .",
    "it is straightforward to check that the signed singular curve @xmath143 is free homotopic to the singular virtual string @xmath144 , and the singular curve @xmath145 is free homotopic to the singular virtual curve @xmath146 , using proposition [ figure8s ] .",
    "therefore their underlying signed singular virtual strings are virtually homotopic .",
    "thus the @xmath147 terms corresponding to the self intersection points @xmath148 cancel .",
    "now @xmath149))/2 $ ] , so @xmath13)=n^2p+n-1\\geq t(\\mu([\\alpha]))/2+n-1 $ ] .",
    "in this section , we introduce signed singular based matrices",
    ". these will be our main tools in the proofs of theorems 1.1 and 1.3 . signed singular based matrices are closely related to turaev",
    "s based matrices @xcite and henrich s singular based matrices @xcite .",
    "first we recall turaev s definition of a based matrix .",
    "a _ based matrix _ over an abelian group @xmath150 is a triple @xmath151 where @xmath152 is a finite set , @xmath153 , and @xmath154 is a skew - symmetric map .",
    "that is , @xmath155 for all @xmath156 and @xmath157 for all @xmath158 .",
    "certain elements of @xmath152 allow us to perform moves on based matrices that are analogous to flat reidemeister moves .",
    "these elements are : + 1 ) annihilating elements : an element @xmath159 is _ annihilating _ if @xmath160 for all @xmath161 .",
    "+ 2 ) core elements : an element @xmath159 is _ core _ if @xmath162 for all @xmath161 .",
    "+ 3 ) complementary elements : two elements @xmath163 are _ complementary _ if @xmath164 for all @xmath161 . +",
    "a signed singular based matrix is a quadruple @xmath165 where @xmath151 is a based matrix , @xmath166 , and @xmath167 .",
    "in addition to annihilating , core , and complementary elements , all of which are required to be elements other than @xmath168 and @xmath48 , we also have the following : + 1 ) annihilating - like elements : the distinguished element @xmath48 is _ annihilating - like _ if @xmath169 for all @xmath161 .",
    "similarly , @xmath168 is annihilating - like if @xmath170 for all @xmath161 .",
    "+ 2 ) core - like elements : the distinguished element @xmath48 is _ core - like _ if @xmath171 for all @xmath161 .",
    "if one forgets the sign in the definitions above , one recovers henrich s singular based matrices @xcite .",
    "turaev defined the following moves , called _ elementary extensions _",
    ", on based matrices @xcite : +   + @xmath172 adds an annihilating element to @xmath151 : given @xmath151 , form the based matrix @xmath173 where @xmath174 , @xmath175 agrees with @xmath43 on @xmath176 , and @xmath177 for all @xmath161 .",
    "+   + @xmath178 adds a core element to @xmath151 : given @xmath151 , form the based matrix @xmath173 where @xmath179 , @xmath175 agrees with @xmath43 on @xmath176 , and @xmath180 for all @xmath161 .",
    "+   + @xmath181 adds a pair of complementary elements to @xmath151 : given @xmath151 , form the based matrix @xmath173 , where @xmath182 , @xmath175 agrees with @xmath43 on @xmath152 , and @xmath183 for all @xmath161 .",
    "+   + the inverses of these moves are called _",
    "inverse extensions_.      for signed singular based matrices , we define the following elementary extensions , plus an additional move which changes which element is the distinguished element and changes the sign of the matrix : +   + @xmath184 adds an annihilating element to @xmath185 : given @xmath165 , form the signed singular based matrix @xmath186 where @xmath174 , @xmath175 agrees with @xmath43 on @xmath176 , and @xmath177 for all @xmath161 .",
    "+   + @xmath187 adds a core element to @xmath165 : given @xmath165 , form the signed singular based matrix @xmath186 where @xmath179 , @xmath175 agrees with @xmath43 on @xmath176 , and @xmath180 for all @xmath161 .",
    "+   + @xmath188 adds a pair of complementary elements to @xmath165 : given @xmath165 , form the singular based matrix @xmath186 , where @xmath182 , @xmath175 agrees with @xmath43 on @xmath152 , and @xmath183 for all @xmath161 .",
    "+   + @xmath189 changes which element is the distinguished element , as well as the sign of the matrix : given @xmath165 such that @xmath158 and @xmath48 are complementary , form the singular based matrix @xmath190 .",
    "+   + by forgetting the signs on the matrices , one obtains the moves @xmath191 and @xmath192 for singular based matrices in @xcite .",
    "+   +      two based matrices are _ homologous _ if one can be obtained from the other by a finite number of the @xmath193 moves and their inverses @xcite .",
    "two signed singular based matrices are homologous if one can be obtained from the other by a finite number of @xmath194 moves , @xmath189 moves , and their inverses .",
    "a based matrix is _ primitive _ if it can not be obtained from another based matrix by a sequence of @xmath193 moves @xcite .",
    "a signed singular based matrix is _ primitive _ if it can not be obtained from another singular based matrix by applying an @xmath194 move , possibly preceded by an @xmath189 move .",
    "two based matrices @xmath151 and @xmath195 are _ isomorphic _ if there is a bijection @xmath196 such that @xmath197 , and @xmath198 for all @xmath156 .",
    "two signed singular based matrices @xmath165 and @xmath199 are _ isomorphic _ if there is a bijection @xmath196 such that @xmath197 , @xmath200 , @xmath201 , and @xmath198 for all @xmath156 .    by forgetting signs , one recovers the definitions of homologous , primitive , and isomorphic singular based matrices in @xcite .",
    "we will recall how to associate a based matrix to a virtual string @xcite , and define a method of associating a signed singular based matrix to a signed singular virtual string . by forgetting signs , one recovers the definitions of @xcite .",
    "turaev gives a combinatorial formula for the based matrix of a virtual string @xcite .",
    "the based matrix @xmath202 of the string @xmath1 is given as follows : put @xmath203 .",
    "suppose @xmath73 and @xmath204 are arrows of @xmath1 .",
    "we say @xmath205 links @xmath92 _ positively _ if @xmath206 lies in the arc @xmath72 and @xmath48 lies in the arc @xmath97 .",
    "we say @xmath205 links @xmath92 _ negatively _ if @xmath206 lies in the arc @xmath97 and @xmath48 lies in the arc @xmath72 .",
    "otherwise , @xmath92 and @xmath205 are _",
    "unlinked_. ( see figure [ linkingdefn.fig ] . )     is the horizontal arrow and @xmath205 is the vertical arrow . on the right ,",
    "@xmath205 links @xmath92 positively . on the left , @xmath205 links @xmath92 negatively.,width=188 ]",
    "let @xmath207 then put @xmath208 .",
    "( this defines the first row and column of the matrix . )",
    "now let @xmath209 denote the interior of the arc @xmath72 , and for two arcs @xmath72 and @xmath210 , and let @xmath211 @xmath212 set @xmath213 if @xmath92 and @xmath205 are unlinked , set @xmath214 if @xmath205 links @xmath92 positively , and set @xmath215 if @xmath205 links @xmath92 negatively .",
    "then put @xmath216 .",
    "+   +      let @xmath94 be a signed singular virtual string , with underlying virtual string @xmath1 , distinguished arrow @xmath48 and sign @xmath62 .",
    "the signed singular based matrix @xmath217 associated to @xmath94 is @xmath218 , where @xmath219 .",
    "when writing @xmath217 in matrix form , we will display the row and column corresponding to @xmath48 in bold , and display the sign @xmath62 to the upper right of the matrix .",
    "we compute the based matrix of the virtual string @xmath220 in figure [ gibsonex.fig ] .",
    "columns one through six correspond to @xmath221 and @xmath222 respectively .",
    "we will compute two entries explicitly : @xmath223 , so the matrix entry @xmath224 .",
    "for an entry not in the first row or column , we use the formula @xmath216 to get @xmath225 .",
    "notice that @xmath226 is annihilating .",
    "gibson @xcite computes this based matrix , but it seems we have opposite sign conventions , so his matrix is the transpose of ours .",
    "below , we display the entire matrix @xmath227 , as well as the signed singular matrix of the signed singular string @xmath228 : @xmath229",
    "in this section we find analogues of turaev s results for based matrices and henrich s results for singular based matrices :    [ turaev , p. 2487 ] homotopic virtual strings have homologous based matrices.[homotopicimplieshomologous ]    homotopic singular virtual strings have homologous singular based matrices .",
    "[ homotopicimplieshomologoussignedsingular ] homotopic signed singular strings have homologous signed singular based matrices .",
    "_ we need to check that applying the ordinary type 1 - 3 moves and the signed singular type 2 and 3 moves to a signed singular virtual string does not change the homology class of the corresponding signed singular based matrix . for the ordinary type 1 - 3 moves ,",
    "the proof is identical to henrich s or turaev s proof . applying a type 1",
    "move changes the corresponding matrix by adding a core or annihilating element ; i.e. , by applying the elementary extension @xmath184 or @xmath187 , depending on the direction of the arrow . applying",
    "the type 2 move adds a pair of complementary elements to the corresponding matrix ; i.e. , we apply the elementary extension @xmath188 .",
    "one can check that the ordinary and signed singular type 3 moves do not change the corresponding matrix or its sign . finally , the signed singular type 2 move changes the matrix by the move @xmath189 ; i.e. , one must change the sign of the matrix , and swap the distinguished element with an element complementary to it .    [ primitive]if the based matrix @xmath29 is primitive , then the signed singular based matrix @xmath230 is primitive .",
    "clear .      our main tool for deciding when terms of @xmath0 cancel is an analogue of the following theorem of turaev @xcite :    [ uniqueprim ] there is a unique primitive based matrix in each homology class , up to an isomorphism .",
    "turaev s theorem has two important applications which we will use throughout this paper .",
    "first , it gives rise to an invariant of virtual strings . to see why , recall that by proposition [ homotopicimplieshomologous ] , homotopic strings @xmath1 and @xmath104 have homologous based matrices @xmath29 and @xmath231 .",
    "each can be reduced to a primitive matrix using inverse elementary extensions .",
    "therefore if we apply as many inverse extensions as possible to these two matrices , we get the same matrix .",
    "turaev denotes the unique primitive matrix associated to the homotopy class of @xmath1 by @xmath232)$ ] , which we may abbreviate to @xmath233 .",
    "the second application of this theorem is that it gives a lower bound on the minimal self - intersection number .",
    "namely , put @xmath37)=|t_\\bullet(\\alpha)|-1 $ ] .",
    "then it is clear that @xmath13)\\geq \\rho([\\alpha])$ ] .",
    "( this is the invariant @xmath2 mentioned in the introduction . )",
    "the unique primitive matrix associated to the homotopy class of the string @xmath220 in figure [ gibsonex.fig ] is @xmath234)=\\left(\\begin{matrix } 0 & -2 & -1   & 1 & 2\\\\ 2 & 0 & 0   & 1 & 3\\\\ 1 & 0 & 0   & 0 & 1\\\\ -1 & -1 &   0 & 0 & 0\\\\ -2 & -3 & -1 &   0 & 0\\end{matrix}\\right).\\ ] ] we obtained this matrix from @xmath227 by deleting the center row and column , which corresponded to the annihilating element @xmath226 .",
    "thus @xmath235)=5 - 1=4 $ ] .",
    "later we will see that @xmath236)=5 $ ] , so the bound @xmath13)\\geq \\rho([\\alpha])$ ] is not an equality in this case .",
    "we will also see that half the number of terms of @xmath237)$ ] is in fact 5 , so the bound given by @xmath0 is an equality .",
    "now we seek an analogue of theorem [ uniqueprim ] for signed singular based matrices .",
    "there is not a unique primitive representative in the homology class of a signed singular matrix , but there are at most two primitive representatives in each class , and furthermore , if there are two such representatives , we can describe how they are related .",
    "we will prove that two primitive , homologous , signed singular based matrices either differ by an @xmath189 move , or by certain composite moves which we call @xmath238 , @xmath239 , and @xmath240 .",
    "the first two are just signed versions of moves in @xcite . however the move @xmath240 does not appear in the unsigned case .",
    "let @xmath238 denote the composition @xmath241 in the case where the @xmath189 move interacts with both the extension and the inverse extension .",
    "that is , first @xmath187 adds a core element @xmath206 . in order for @xmath189 to affect this element , it must exchange the current distinguished element @xmath48 with @xmath206 .",
    "this requires @xmath48 and @xmath206 to be complementary , so @xmath48 must be annihilating .",
    "then @xmath242 removes this annihilating element . _",
    "the net effect of @xmath238 is that it replaces an annihilating - like distinguished element with a core - like distinguished element and changes the sign of the matrix . _    similarly , we let @xmath239 denote the composition @xmath243 in the case where the @xmath189 move interacts with both the extension and the inverse extension . _ the net effect of @xmath239 is that it replaces a core - like distinguished element with an annihilating - like distinguished element and changes the sign of the matrix . _ +   + before introducing the final move , we need the following definition :    an element @xmath158 of the based matrix @xmath151 is _ self - complementary _ if @xmath244 for all @xmath161 .",
    "let @xmath240 denote the following special case of the composition @xmath245 : suppose the distinguished element @xmath48 is self - complementary , the move @xmath188 adds a pair of self - complementary elements , and @xmath189 switches the distinguished element with one of these two new elements",
    ". then the @xmath246 move removes the old distinguished element and the non - distinguished self - complementary element added by the @xmath188 move . _ the net effect of @xmath240 is that it switches the sign of a matrix whose distinguished element is self - complementary_. the move @xmath240 is equivalent to an isomorphism for unsigned matrices .",
    "+   + it is helpful to note the following :    [ annihilatinglike]a core or annihilating element is self - complementary if and only if @xmath168 is annihilating - like ( in which case core and annihilating elements are the same ) .    if @xmath247 for all @xmath161 and @xmath248 , then @xmath170 . if @xmath247 for all @xmath161 and @xmath249 , then @xmath170 .",
    "the reverse direction is similar . +   + we will use an analogue of the following theorem to understand when certain terms of @xmath0 can cancel .",
    "[ allison ] two homologous primitive ( unsigned ) singular based matrices differ either by an isomorphism or by a composition of an isomorphism with a single @xmath250 , @xmath251 , or @xmath192 move",
    ".      we will need to understand whether the isomorphisms in the statement of henrich s theorem can change the sign of a signed singular based matrix .",
    "define an operation @xmath252 which switches the sign of a signed singular based matrix . that is ,",
    "if @xmath253 , then @xmath254 . note that @xmath110 is an isomorphism of the underlying singular based matrices , but @xmath110 is not an isomorphism of signed singular based matrices .",
    "in general @xmath255 and @xmath252 need not be homologous .",
    "+   + _ remark : _ it follows immediately from theorem [ allison ] that two signed singular primitive based matrices differ by an isomorphism , a composition of an isomorphism with a single @xmath238 , @xmath239 , or @xmath189 move , or a composition of one of those moves with a move that changes the sign @xmath62 of the matrix .",
    "this is because an isomorphism of unsigned based matrices is either an isomorphism of signed based matrices , or is equivalent to a composition of an isomorphism with a sign - switching move .",
    "but in general , applying a sign switch to a signed based matrix might not produce a matrix homologous to the original matrix .",
    "this is why we need to prove a version of theorem [ allison ] for signed matrices , rather than use theorem [ allison ] directly .",
    "[ primitivesignedtheorem ] two homologous primitive signed singular based matrices differ by an isomorphism , or by a composition of an isomorphism with a single @xmath238 , @xmath239 , @xmath240 , or @xmath189 move .    before giving the rather technical proof of theorem [ primitivesignedtheorem ] , which we postpone until the next section",
    ", we give an example .    as in the case of ordinary based matrices , we let @xmath233 denote a primitive matrix in the class of @xmath29 . if there is more than one such matrix , the choice of matrix will be specified .",
    "let us consider a signed singular string whose underlying ordinary string is the string @xmath220 in figure [ gibsonex.fig ] .",
    "let @xmath256 be the signed singular string with distinguished arrow @xmath23 and sign @xmath63 .",
    "first we compute the signed singular based matrix associated to @xmath256 : @xmath257 note that this signed singular matrix is * not * primitive .",
    "a primitive representative of its homology class is : @xmath258 this matrix happens to be the * unique * primitive representative of its homology class . indeed , by theorem [ primitivesignedtheorem ] ,",
    "any other primitive signed singular matrix homologous to this matrix ( which is not isomorphic to it ) would differ from this one by a @xmath259 , @xmath260 , @xmath189 , or @xmath261 move .",
    "but in order to apply these moves , the distinguished element must be either core , annihilating , part of a complementary pair , or self - complementary , and it is easy to check that this is not the case .    on the other hand , the matrix @xmath262 computed in example [ sec : matrixofastring ] is primitive ( unlike @xmath263 ) , and is * not * the unique primitive matrix in its class because its distinguished element is annihilating . the other primitive matrix in the class of @xmath262 is @xmath264 .",
    "this example illustrates that there is sometimes a unique primitive matrix in the homology class of a signed singular matrix .",
    "we summarize this in corollary [ uniquematrix ] of theorem [ primitivesignedtheorem ] below .",
    "let @xmath1 be a virtual string",
    ". there may be more than one possible sequence of inverse extensions which reduces the based matrix @xmath29 to the primitive based matrix @xmath233 .",
    "we fix one such sequence @xmath265 , and we let @xmath266 be the set of arrows of @xmath1 which are not removed by the reduction @xmath265 .",
    "the set @xmath266 forms a primitive submatrix of @xmath29 , and we can identify its elements with those of @xmath233 .",
    "[ uniquematrix ] for any fixed reduction @xmath265 of @xmath29 , and any @xmath267 , one can construct a primitive signed singular based matrix @xmath268 in the homology class of @xmath269 by using @xmath29 as the underlying ordinary based matrix , with distinguished element @xmath92 and sign @xmath62 .",
    "furthermore , if @xmath92 is not a self - complementary element of @xmath266 , then @xmath268 is the unique primitive signed singular based matrix in its homology class .",
    "form the matrix @xmath269 . since @xmath267 , no move in @xmath265 removes @xmath92 .",
    "thus we can apply the entire sequence of moves @xmath265 to @xmath269 to obtain a matrix we call @xmath268 .",
    "the signed singular based matrix @xmath268 has underlying ordinary based matrix @xmath29 , distinguished element @xmath92 , and sign @xmath62 . by proposition [ primitive ] , this signed singular based matrix is primitive . because @xmath267 , @xmath92 is not core , annihilating , or part of a complementary pair",
    "thus one can not apply the moves @xmath238 , @xmath239 , or @xmath189 to @xmath268 .",
    "hence if @xmath92 is not a self - complementary element of @xmath266 , then @xmath268 is the unique primitive matrix in its homology class .",
    "we will follow henrich s proof of theorem [ allison ] .",
    "let @xmath270 and @xmath271 be two homologous primitive signed singular based matrices .",
    "we will show that the sequence of @xmath194 , @xmath272 , and @xmath189 moves relating two primitive singular based matrices can be replaced by a sequence of moves of the form @xmath273 , where @xmath23 is a composition of extensions and @xmath189 moves , @xmath18 is a single @xmath274 or @xmath189 move , @xmath275 is an isomorphism , and @xmath226 is a composition of inverse extensions and @xmath189 moves . since one can not apply inverse extensions to a primitive matrix or obtain a primitive matrix by applying extensions to another matrix",
    ", the sequence must be of the form @xmath276 , and the theorem follows .",
    "+   + as in henrich s proof , we will show :    * the @xmath274 moves commute with inverse extensions and extensions , * a sequence of @xmath274 and @xmath189 moves can be replaced with a sequence containing at most one @xmath274 or @xmath189 move ( and possibly an isomorphism ) , and * a sequence of extensions , inverse extensions , and @xmath189 moves can be rewritten so that all inverse extensions occur before all extensions .",
    "these three claims allow us to put our sequence in the form @xmath273 above . to see why , consider the leftmost @xmath274 move ( if such a move exists ) . by the first bullet above",
    ", we slide this move past extensions and inverse extensions until it is adjacent to a sequence of @xmath189 and @xmath274 moves .",
    "now by the second bullet , replace this sequence of our leftmost @xmath274 move and other @xmath274 and @xmath189 moves by a sequence containing a single @xmath274 or @xmath189 move .",
    "now find the new leftmost @xmath274 move , and repeat this process . in the end we will have a sequence of extensions , inverse extensions , and @xmath189 moves possibly followed by a @xmath274 move . by the third bullet , we can reorder this sequence so that it is of the form : @xmath277 .",
    "if there is a @xmath274 move at the end , we can move it between the inverse and ordinary extensions by sliding it past inverse extensions , and whenever it becomes adjacent to an @xmath189 move , replace the result by a sequence containing a single @xmath189 move or @xmath274 move as necessary .",
    "our first step is to show that the @xmath274 moves commute with inverse extensions and extensions . for @xmath238 and @xmath239 ,",
    "the proof is the same as henrich s , so we only consider @xmath240 .",
    "but this is clear because @xmath240 just changes the sign of the matrix when the distinguished element is self - complementary , and a sign switch certainly commutes with inverse extensions and extensions .",
    "+   + next we show that any sequence of @xmath274 and @xmath189 moves can be replaced by a single @xmath274 or @xmath189 move , or an isomorphism .",
    "henrich shows that this is true for compositions of @xmath238 , @xmath239 and @xmath189 .",
    "so we consider the compositions @xmath278 , @xmath279 , @xmath280 , and @xmath281 .",
    "if the composition @xmath278 occurs , then the distinguished element must be self - complementary , implying that @xmath189 is equivalent to a sign switch composed with an isomorphism .",
    "therefore the composition @xmath278 is an isomorphism .",
    "this holds for @xmath279 as well .",
    "the composition @xmath282 is also an isomorphism .",
    "the compositions @xmath283 , @xmath284 , @xmath285 , and @xmath286 can only occur if the core or annihilating - like distinguished element is also self - complementary .",
    "suppose that a core element @xmath48 is self - complementary .",
    "then @xmath287 for all @xmath161 , but @xmath288 , so @xmath169 .",
    "therefore @xmath168 is annihilating - like . similarly ,",
    "if an annihilating element is self - complementry , @xmath168 is annihilating like .",
    "if @xmath168 is annihilating like , the moves @xmath238 , @xmath239 , and @xmath240 are all sign switches , so the composition of any two of them is an isomorphism .",
    "+   + finally we must show that a sequence containing extensions , inverse extensions , and @xmath189 moves , but no @xmath274 moves , can be rewritten so that inverse extensions occur before extensions .",
    "turaev @xcite showed that sequences containing only extensions and inverse extensions can be rewritten so that inverse extensions occur before extensions . like henrich",
    ", we must consider sequences of the form @xmath289 which are not equivalent to @xmath274 moves or isomorphisms .",
    "in her case , such a sequence could be equivalent to an isomorphism , but in our case , this can not happen because all of these sequences change the sign of the matrix exactly once .",
    "in each case , we only need to consider the case where the @xmath189 move interacts with both the extension and inverse extension , because if it does not , then the @xmath189 move commutes with at least one of those moves , and then turaev s results imply the sequence can be rewritten in the desired form . +   + * case 1 : i = j=1 .",
    "* henrich shows that this is equivalent to @xmath290 , where @xmath168 is annihilating - like . + * case 2 : i = j=2 .",
    "* this is also equivalent to @xmath290 , where @xmath168 is annihilating - like . +",
    "* case 3 : i=1 , j=2 .",
    "* this is @xmath239 . + * case 4 : i=2 , j=1 . *",
    "this is @xmath238 . + * case 5 : i=1 , j=3 . *",
    "henrich shows this is equivalent to @xmath291 . + * case 6 : i=2 , j=3 .",
    "* this is equivalent to @xmath292 . + * case 7 : i=3 , j=1 . *",
    "henrich shows this is equivalent to @xmath293 . + * case 8 : i=3 , j=2 .",
    "* this is equivalent to @xmath294 . + * case 9 : i=3 , j=3 .",
    "* this is the case which differs from that of henrich .",
    "first @xmath188 adds a pair of complementary elements @xmath295 and @xmath296 .",
    "the distinguished element @xmath48 must be complementary to one of these in order to apply @xmath189 .",
    "so suppose @xmath48 and @xmath295 are complementary , so that @xmath48 and @xmath296 are the same with respect to @xmath43 .",
    "then @xmath189 makes @xmath295 the new distinguished element . at the final stage ,",
    "when we apply @xmath297 , we have two options .",
    "the first is that @xmath48 ( and also both @xmath298 ) is self - complementary , so that @xmath297 removes @xmath48 and @xmath296 . in this case , the composition is a @xmath240 move .",
    "( henrich did not need to consider this case because it is an isomorphism of unsigned matrices ) .",
    "the other possibility is that @xmath297 only removes one of @xmath48 or @xmath296 .",
    "since @xmath43 agrees on these elements , it does not matter which is removed .",
    "henrich shows that in this case , the composition is equivalent to an @xmath189 move .",
    "in this section , we prove theorem [ primitiveformulaintro ] and corollary [ primitiveformulaintrocor ] .",
    "recall that theorem [ primitiveformulaintro ] describes cases when the operation @xmath0 gives a formula for the minimal self - intersection number .",
    "corollary [ primitiveformulaintrocor ] states that the bound on the minimal self - intersection number given by @xmath0 is stronger than the bound given by turaev s cobracket @xmath10 .",
    "we are interested in describing strings @xmath1 such that @xmath13)=t(\\mu([\\alpha]))/2 + n-1 $ ] , where @xmath16 is the largest integer such that a minimal representative @xmath104 of @xmath12 $ ] can be realized as a curve @xmath18 on an oriented surface @xmath19 , and @xmath299 .",
    "recall that by proposition [ powers ] , we always have @xmath13)\\geq t(\\mu([\\alpha]))/2 + n-1 $ ] .",
    "theorem [ primitiveformulaintro ] gives examples of strings @xmath1 such that @xmath13)=t(\\mu(\\alpha))/2 $ ] .",
    "hence for these strings , @xmath31 .    [ semitrivial ] suppose the term @xmath300 $ ] of @xmath0 is semi - trivial .",
    "then the distinguished element of any primitive matrix in the homology class of @xmath269 is core or annihilating .",
    "if @xmath300 $ ] is semi - trivial , then there exists some signed singular string @xmath301 in its class such that one of the arcs bounded by the endpoints @xmath42 and @xmath43 of @xmath48 contains no endpoints on its interior .",
    "if we form the matrix @xmath302 , the distinguished element will be core or annihilating .",
    "when the matrix @xmath302 is reduced to a primitive matrix , the distinguished element can only change during an @xmath189 move , so the distinguished element of the primitive matrix will be core or annihilating .",
    "[ primitiveformulaintro ] * theorem . *",
    "_ let @xmath1 be a virtual string , whose based matrix @xmath29 is primitive and does not contain a self - complementary element . then @xmath13)=t(\\mu([\\alpha]))/2 $ ] .",
    "if @xmath29 is primitive and does contain a self - complementary element , then either @xmath13)=t(\\mu([\\alpha]))/2 $ ] or @xmath13)=t(\\mu([\\alpha]))/2 + 1 $ ] . _    by proposition [ semitrivial ] , and the fact that @xmath29 is primitive , no term of @xmath0 is semitrivial .",
    "hence every term is nonzero .",
    "since @xmath29 is primitive ( i.e. , @xmath303 ) , every @xmath92 in @xmath29 is an element of @xmath266 , where @xmath265 is an empty sequence of moves ( see corollary [ uniquematrix ] for the definition of @xmath266 ) .",
    "first we suppose @xmath92 is not self - complementary .",
    "we will show that the term @xmath304 $ ] can not cancel with any other term @xmath305 $ ] of @xmath0 ( and then , by symmetry , @xmath306 $ ] can not cancel with @xmath307 $ ] ) .",
    "suppose that these terms cancel .",
    "then the signed singular based matrices @xmath308 and @xmath309 are homologous by proposition [ homotopicimplieshomologoussignedsingular ] . by corollary [ uniquematrix ]",
    ", there is a unique primitive matrix @xmath310 in the homology class of @xmath308 , which is just the signed singular matrix with @xmath29 as the underlying based matrix , distinguished element @xmath92 and sign @xmath63 .",
    "similarly , if @xmath205 is not self - complementary , we can find the unique primitive matrix @xmath311 in the homology class of @xmath309 by using @xmath29 as the underlying based matrix , with distinguished element @xmath205 and sign @xmath64 .",
    "the matrices @xmath310 and @xmath311 have opposite signs , so they are not isomorphic . if @xmath205 is not self - complementary , then we have reached a contradiction , so these terms can not cancel .",
    "if @xmath205 is self - complementary , the terms still can not cancel . by theorem [ primitivesignedtheorem ] , and because @xmath92 is not self - complementary and @xmath205 is , the matrices @xmath311 and @xmath310 are not related by the moves @xmath189 or @xmath274 .",
    "so the only way that two terms @xmath304 $ ] and @xmath305 $ ] can cancel is if both @xmath92 and @xmath205 are self - complementary .",
    "there is at most one self - complementary element in @xmath29 , so @xmath312 , and @xmath304 $ ] might cancel with @xmath306 $ ] , reducing the total number of terms by 2 .",
    "+   +      the purpose of theorem [ primitiveformulaintro ] is to find examples of classes such that @xmath13)=t(\\mu(\\alpha))/2+n-1 $ ] , in the case where @xmath31 .",
    "we now show that such classes exist .",
    "consider the string @xmath313 defined in @xcite .",
    "this string is a copy of @xmath40 oriented counterclockwise , with @xmath52 vertical arrows pointing upward and @xmath314 horizontal arrows pointing from right to left , so that the copy of @xmath40 can be partitioned into four disjoint arcs containing the heads of the vertical arrows , the heads of the horizontal arrows , the tails of the vertical arrows , and the tails of the horizontal arrows , respectively .",
    "turaev finds a formula for the based matrix @xmath315 ( part of the formula is given in the next paragraph ) , and shows that if @xmath316 and one of @xmath52 or @xmath314 is at least 2 , then this matrix is primitive @xcite .",
    "we will use this formula to check that @xmath317)$ ] does not contain a self - complementary element .",
    "it will follow that for @xmath318 and one of @xmath52 or @xmath319 , we have @xmath320)=t(\\mu([\\alpha_{p , q}]))/2=p+q$ ] .",
    "now we check that @xmath315 does not contain a self - complementary element .",
    "label the vertical arrows @xmath321 from left to right , and label the horizontal arrows @xmath322 from bottom to top .",
    "then @xmath323 for @xmath324 and @xmath325 for @xmath326 . also ,",
    "@xmath43 vanishes on any pair of vertical arrows and @xmath43 vanishes on any pair of horizontal arrows .",
    "we do not need to compute the rest of the matrix .",
    "suppose @xmath206 is a self - complementary element of @xmath315 .",
    "then @xmath327 for all arrows @xmath123 of @xmath313 .",
    "suppose @xmath206 is horizontal .",
    "then choose some other horizontal arrow @xmath328 .",
    "we have @xmath329 , but @xmath330 .",
    "hence @xmath206 can not be horizontal .",
    "similarly it is easy to check @xmath206 can not be vertical .",
    "thus @xmath315 does not contain a self - complementary element , so by theorem [ primitiveformulaintro ] , we have @xmath320)=t(\\mu([\\alpha_{p , q}]))/2=p+q$ ] .",
    "[ primitiveformulaintrocor ] * corollary .",
    "* _ the bound on @xmath13)$ ] given by @xmath0 is stronger than the bound given by turaev s cobracket @xmath10 .",
    "namely , the number of terms of @xmath32)$ ] is greater than or equal to the number of terms of @xmath33 $ ] , and there are virtual homotopy classes @xmath12 $ ] such that this inequality is strict . _    by subsection [ sec.smoothingmap ] , we have @xmath331 .",
    "it follows that @xmath36))\\geq t(\\nu([\\alpha]))$ ] .",
    "it is easy to check that @xmath332)=0 $ ] for any @xmath333 . on the other hand",
    ", we just saw that @xmath320)=t(\\mu([\\alpha_{p , q}]))/2=p+q$ ] .",
    "hence @xmath334 ) ) > t(\\nu([\\alpha_{p , q}]))$ ] .",
    "in this section we prove that the string @xmath220 in figure 1 satisfies @xmath236)=|\\arr(m)|=5 $ ] .",
    "then we show that @xmath236)=t(\\mu([m]))/2=5,$ ] while @xmath235)=4.$ ]      we call a string @xmath1 _ crossing - reducible _ if there is a string @xmath335 such that @xmath1 and @xmath335 are related by a ( possibly empty ) sequence of type 3 moves , and if an inverse ( i.e. , crossing - reducing ) type 1 or type 2 move can be applied to @xmath335 . a string which is not crossing - reducible is called _ crossing - irreducible_.",
    "a string @xmath1 is _ crossing - minimal _ if @xmath13)=|\\arr(\\alpha)|$ ] .",
    "the notation @xmath336 denotes an orientable surface @xmath19 with a curve ( i.e. , flat knot diagram ) @xmath1 on it .",
    "recall that any virtual string @xmath1 can be realized as a curve ( also called @xmath1 ) on a surface @xmath19 .",
    "there is a canonical realization of @xmath1 on a surface , which can be obtained by gluing disks to the boundary components of the surface described in @xcite ( see also @xcite ) .",
    "we call a pair @xmath336 _ genus - reducible _ if there is a string @xmath335 homotopic to @xmath1 on @xmath19 , and a simple closed curve @xmath337 such that if one cuts along @xmath338 and glues a disk to the resulting boundary component , the genus of the resulting surface is less than the genus of @xmath19 .",
    "a pair which is not genus - reducible is called _ genus - irreducible_. we call a pair @xmath336 _ genus - minimal _ if @xmath19 is the surface of smallest genus on which a representative of the class @xmath12 $ ] can be realized .",
    "gibson showed , with the aid of a computer , that the string @xmath220 in figure [ gibsonex.fig ] is crossing - irreducible ( * ? ? ? * , table 6 ) .",
    "( gibson refers to this string by its nanoword @xmath339 ) .",
    "kadokami stated that two crossing - irreducible strings are related by a ( possibly empty ) sequence of type 3 moves ( * ? ? ? * theorem 3.8 ) .",
    "it would follow from that statement that crossing - irreducible strings are crossing - minimal .",
    "kadokami proved this statement for flat virtual links , but gibson unfortunately found a counterexample in the case where there is more than one component @xcite .",
    "however , the statement is true for virtual strings ; it follows from the work of ilyutko , manturov and nikonov @xcite . therefore the string @xmath220 is crossing - minimal .",
    "we now explain why kadokami s statement follows from @xcite .",
    "the results of ilyutko , manturov and nikonov that we use are theorem 3.2 and corollary 3.1 in @xcite .",
    "we state theorem 3.2 in two ways .",
    "the first statement ( theorem [ flatkup ] below ) is the same as the statement given in their work ( but paraphrased using our terminology and notation ) .",
    "then second statement ( theorem [ flatkupstrong ] ) appears to be a stronger version , but it turns out to be the same as the first , because genus - irreducible pairs are genus - minimal .",
    "they prove the second version of theorem 3.2 during their proof of theorem 3.2 .",
    "[ flatkup ] let @xmath336 and @xmath340 be two genus - minimal pairs .",
    "then there is a homeomorphism @xmath341 such that @xmath342 is homotopic to @xmath335 on @xmath343 .",
    "[ flatkupstrong ] let @xmath336 and @xmath340 be two genus - irreducible pairs .",
    "then there is a homeomorphism @xmath341 such that @xmath342 is homotopic to @xmath335 on @xmath343 .",
    "[ flatkupcor ] let @xmath1 and @xmath335 be two crossing - minimal strings .",
    "then there is a ( possibly empty ) sequence of type 3 moves taking @xmath1 to @xmath335 .",
    "[ flatkupcorstrong ] let @xmath1 and @xmath335 be two crossing - irreducible strings .",
    "then there is a ( possibly empty ) sequence of type 3 moves taking @xmath1 to @xmath335 .",
    "_ proof of corollary [ flatkupcorstrong]_. suppose @xmath1 and @xmath335 are crossing - irreducible .",
    "realize @xmath1 and @xmath335 on their canonical surfaces @xmath19 and @xmath343 .",
    "hass and scott @xcite showed that any curve on a surface can be homotoped to a geodesic without increasing the number of self - intersection points of the curve at any time during the homotopy . using the result of hass and scott , it is straightforward to check",
    "that the pairs @xmath336 and @xmath344 are genus - irreducible ; this argument is similar to an argument in the proof of theorem [ flatkup ] .",
    "hence by theorem [ flatkupstrong ] there is a homeomorphism @xmath341 such that @xmath342 is homotopic to @xmath335 on @xmath343 .",
    "since @xmath342 and @xmath335 are crossing - irreducible as virtual strings , they must both have the fewest number of self - intersection points of any curve in their free homotopy class @xmath343 .",
    "therefore either @xmath342 and @xmath335 are related by a regular isotopy , or there is a sequence of flat third reidemeister moves taking @xmath342 to @xmath335 on @xmath343 . hence @xmath1 and @xmath335 are related by a ( possibly empty ) sequence of type 3 moves .      in lemma [ minimalnotsemitrivial ] , we will show that since @xmath220 is crossing - minimal , no term of @xmath237)$ ] is semi - trivial .",
    "now in order to show that @xmath345))/2=5 $ ] , we just need to show that no two terms of @xmath237)$ ] cancel with each other .",
    "the signed singular matrices @xmath263 ,",
    "@xmath346 , @xmath347 , @xmath348 , @xmath349 , @xmath350 , @xmath351 , and @xmath352 become primitive after the annihlating element @xmath226 is removed .",
    "the resulting primitive matrices are the unique primitive matrices in their homology classes , and they are all distinct . the matrices @xmath262 and @xmath353 are primitive , and are different than those mentioned above because they contain 6 elements rather than 5 .",
    "they are also not homologous to each other because they do not differ by a @xmath238 , @xmath239 , @xmath240 or @xmath189 move .",
    "hence the five signed singular homology classes corresponding to the five positive terms of @xmath237)$ ] are different from the five signed singular homology classes corresponding to the five negative terms of @xmath237)$ ] , so no two terms of @xmath237)$ ] cancel .    in the proof of lemma [ minimalnotsemitrivial ] , it will be useful to view singular virtual strings as flat singular virtual knot diagrams in the plane , up to the virtual diagram moves in @xcite .",
    "these moves are flat versions of the usual virtual reidemeister moves in @xcite , plus the moves in figures [ type2movewithdot.fig ] and [ type3movewithdot.fig ] ( ignoring signs ) and the move in figure [ type3movewithdotvirtual.fig ] .",
    "[ minimalnotsemitrivial]suppose @xmath1 is a virtual string such that @xmath354)$ ]",
    ". then none of the singular strings @xmath355 , @xmath356 , are semi - trivial .",
    "let @xmath1 be a virtual string such that @xmath357)$ ] , and suppose @xmath355 is semi - trivial for some @xmath356 .",
    "then @xmath355 is homotopic to a singular string @xmath358 where @xmath359 and either the arc @xmath72 or the arc @xmath97 contains no endpoints of arrows of @xmath360 .     with and against the orientation of @xmath1.,width=132 ]",
    "we will see that we can smooth @xmath1 at the crossing corresponding to the arrow @xmath92 in such a way that the resulting virtual string @xmath335 is in the same virtual homotopy class as @xmath1 .",
    "this string has one less crossing than @xmath1 , contradicting the assumption that @xmath357)$ ] .",
    "now we construct @xmath335 and show why it is homotopic to @xmath1 .",
    "first smooth @xmath1 at its distinguished crossing @xmath92 against the orientation of @xmath1 ( see figure [ smoothings.fig ] ) .",
    "this is the virtual string @xmath335 , though we have not yet specified its orientation .",
    "the string @xmath335 is homotopic to the string @xmath360 , where @xmath360 is the ordinary string underlying the singular string @xmath358 .",
    "the homotopy from @xmath335 to @xmath360 is given by using the sequence of moves for singular strings taking @xmath355 to @xmath358 , but where the moves involving the distinguished crossing in figures [ type3movewithdot.fig ] , [ type2movewithdot.fig ] , and [ type3movewithdotvirtual.fig ] are replaced with moves in figures [ type3smoothed.fig ] , [ type2smoothed.fig ] , and [ type3smoothedvirtual.fig ] respectively , followed by a single type 1 move , which adds the arrow @xmath205 .",
    "we pick an orientation of @xmath335 so that this resulting virtual string is the string @xmath360 .",
    "now @xmath335 is homotopic to @xmath360 , and @xmath360 is homotopic to @xmath1 , so @xmath335 must be homotopic to @xmath1 .",
    "in this section we prove theorem [ main2 ] . unlike theorem [ primitiveformulaintro ] , which only considers virtual classes that contain a representative @xmath1 whose based matrix is primitive , theorem [ main2 ] describes the bound on @xmath13)$ ] given by @xmath0 for an arbitrary class @xmath12 $ ] , and compares this bound to @xmath2 .",
    "[ main2 ] * theorem . *",
    "_ let @xmath1 be any virtual string .",
    "then @xmath35)\\geq t(\\mu([\\alpha]))/2\\geq \\rho([\\alpha])-1+o/2.\\ ] ] if the primitive based matrix associated to @xmath12 $ ] does not contain a self - complementary element , then @xmath35)\\geq t(\\mu([\\alpha]))/2\\geq \\rho([\\alpha])+o/2.\\ ] ] _    [ [ definitions - of - o - ordinary - elements - positive - and - negative - terms - and - the - standard - primitive - matrix ] ] definitions of @xmath34 , ordinary elements , positive and negative terms , and the standard primitive matrix ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    .",
    "we call a term @xmath361 $ ] in the sum @xmath32)$ ] _ positive _ if its coefficient @xmath62 is positive and _ negative _ if its coefficient @xmath62 is negative .",
    "if a term is semi - trivial , we put @xmath362 and do not consider the term to be positive or negative .",
    "note that the coefficient can be different from the sign of a primitive matrix in the homology class of @xmath269 .",
    "we call a core or annihilating element @xmath363 of a based matrix @xmath364 _ ordinary _ if @xmath168 is not annihilating - like in @xmath255 ( or equivalently , if the element @xmath92 is not self complementary , by proposition [ annihilatinglike ] ) .",
    "if a signed singular homology class contains a primitive matrix with an ordinary core or annihilating distinguished element , then there are exactly two primitive matrices in its homology class which differ by a @xmath238 or @xmath239 move , by theorem [ primitivesignedtheorem ] . since these moves change the sign of the matrix , there is a _",
    "unique _ primitive matrix in the homology class of @xmath269 with a _ given sign _ @xmath62 .",
    "we call this choice of primitive matrix the _ standard _ choice",
    ".    let @xmath226 ( respectively , @xmath23 ) be the total number of positive terms @xmath365 $ ] such that the distinguished element in the standard primitive matrix in the homology class of @xmath308 is an ordinary core ( respectively , annihilating ) element .",
    "now put @xmath366 .",
    "[ extra ] let @xmath267 for some fixed reduction @xmath265 of @xmath29 , and assume @xmath92 is not self - complementary .",
    "suppose that there exists @xmath367 so that the ( unique ) primitive signed singular based matrix corresponding to @xmath304 $ ] is isomorphic to the ( unique ) primitive signed singular based matrix corresponding to @xmath368 $ ] . then there exists some @xmath369 such that @xmath370 and",
    "the primitive signed singular based matrix corresponding to @xmath371 $ ] is isomorphic to those corresponding to @xmath304 $ ] and @xmath368 $ ] .",
    "suppose @xmath92 and @xmath205 satisfy the hypotheses in the statement of lemma [ extra ] .",
    "form the matrices @xmath308 and @xmath309 .",
    "these matrices have @xmath29 as their underlying nonsingular based matrix .",
    "@xmath265 is a sequence of inverse extensions which can be applied to @xmath29 , so the extensions in this sequence can be applied to @xmath308 and @xmath309 as long as they do not remove the distinguished element .",
    "so begin reducing @xmath308 and @xmath309 according to the moves in @xmath265 until this is no longer possible , i.e. , until just before a move in @xmath265 would remove the distinguished element .",
    "since @xmath267 , the reduction @xmath265 will reduce @xmath308 completely , giving us a primitive matrix . since @xmath367",
    ", the reduction @xmath265 of @xmath309 will at some point require the removal of @xmath205 , so we stop the reduction .",
    "let @xmath372 be the signed singular based matrix at this stage .",
    "at this point , the distinguished element @xmath205 is core , annihilating , or part of a complementary pair .",
    "notice that @xmath205 can not be core or annihilating , because we are assuming that the primitive matrix obtained by reducing @xmath309 is isomorphic to that obtained by reducing @xmath308 ; if at some point during the reduction @xmath205 becomes core or annihilating , then the distinguished element in the primitive matrix must also be core or annihilating , and that is impossible .",
    "so @xmath205 is part of at least one complementary pair .",
    "the reduction @xmath265 is about to remove @xmath205 with some specific choice of element @xmath373 complementary to @xmath205 .",
    "now consider the term @xmath371 $ ] .",
    "form its matrix @xmath374 .",
    "begin reducing @xmath374 according to the sequence @xmath265 of inverse extensions . at some point",
    ", @xmath265 removes @xmath373 , but we already know this happens at the same point when @xmath265 removes @xmath205 , i.e. , they are removed together as part of a complementary pair .",
    "so at this point , we can apply an @xmath189 move to switch the distinguished element from @xmath373 to @xmath205 .",
    "after we apply @xmath189 we obtain the matrix @xmath372 .",
    "thus we have partial reductions of the matrices @xmath309 and @xmath374 such that at some stage in the reduction , the matrices are identical . thus the primitive signed singular based matrices in the homology classes of @xmath309 and @xmath374 are isomorphic .        _",
    "the number of terms of @xmath32)$ ] is at least @xmath375 .",
    "if no element of @xmath266 is self - complementary for some fixed reduction @xmath265 of @xmath29 , then the number of terms of @xmath32)$ ] is at least @xmath376)$ ] .",
    "_    proof of step 1 : we will show that the arrows @xmath267 which are not self - complementary in @xmath233 each contribute two terms to @xmath32)$ ] that do not cancel with any other terms . by proposition [ semitrivial ] ,",
    "if @xmath267 , then the terms @xmath304 $ ] and @xmath306 $ ] are not semi - trivial .",
    "+   + to prove the theorem , we will partition the terms of @xmath0 into sets such that two terms of @xmath0 are in the same set if and only if they have same primitive signed singular matrix , and count the number of positive and negative terms in each set .",
    "+   + we first consider all of the positive terms of @xmath0 of the form @xmath304 $ ] where @xmath267 is not self - complementary .",
    "let @xmath377 be sets containing these terms , such that two terms are in the same set if and only if they have isomorphic primitive signed singular based matrices .",
    "( recall that the primitive matrix is unique when @xmath267 and is not self - complementary by corollary [ uniquematrix ] ) .",
    "similarly let @xmath378 be sets containing the negative terms @xmath306 $ ] where @xmath267 is not self - complementary , such that two terms are in the same set if and only if they have isomorphic primitive signed singular based matrices .",
    "by corollary [ uniquematrix ] , the terms @xmath304 $ ] and @xmath305 $ ] corresponding to non - self - complementary elements @xmath379 can not cancel with other such terms .",
    "this implies that the sets @xmath380 are disjoint from the sets @xmath381 .",
    "now we assign the terms @xmath382 $ ] for all @xmath367 to the sets @xmath383 as follows : consider a primitive signed singular matrix @xmath384 homologous to @xmath385 if @xmath384 is isomorphic to the primitive matrix of the term @xmath386 $ ] in some @xmath387 , then add @xmath382 $ ] to @xmath387 .",
    "by lemma [ extra ] , if @xmath384 is isomorphic to the primitive matrix of some term @xmath386 $ ] , then there is some unique @xmath369 determined by @xmath265 such that @xmath384 is also isomorphic to the primitive matrix of a term @xmath388 $ ] .",
    "so both @xmath382 $ ] and @xmath388 $ ] are in the set @xmath387 , and one is a positive term while the other is a negative term .",
    "+   + now each @xmath387 contains an equal number of positive and negative terms corresponding to arrows not in @xmath266 , as well as a certain number @xmath389 of terms corresponding to arrows in @xmath266 .",
    "this means that there are at least @xmath389 terms in @xmath387 which do not cancel with any other terms of @xmath0 .",
    "note that the sum of all the @xmath389 is either @xmath390 if there are no self - complementary elements in @xmath266 or @xmath375 if there is a self - complementary element in @xmath266 , which concludes the proof of step 1 .",
    "proof of step 2 : the number of positive and negative terms with ordinary core ( respectively , annihilating ) distinguished elements in their standard primitive matrices are equal . a positive (",
    "respectively , negative ) term with an ordinary core distinguished element in its standard primitive matrix can only cancel with a negative ( respectively , positive ) term with an ordinary annihilating distinguished element in its standard primitive matrix .",
    "even if all terms satisfying the condition in the previous sentence cancel with each other , there will still be @xmath393 such terms leftover that do not cancel with any terms of @xmath0 .",
    "+   + * acknowledgements : * i am very grateful to my advisor , v. chernov , for many helpful discussions , for providing translations of some of the references , and for commenting on drafts of this paper .",
    "i would also like to thank v. manturov for many helpful discussions concerning algorithms for finding minimal representatives of virtual homotopy classes , and to v. manturov and d. ilyutko for helpful discussions about their proof of the kuperberg theorem for flat virtual knots in @xcite .",
    "finally i would like to thank m. chas for informing me about the results of hass and scott ."
  ],
  "abstract_text": [
    "<S> in a previous paper , we defined an operation @xmath0 that generalizes turaev s cobracket for loops on a surface . </S>",
    "<S> we showed that , in contrast to the cobracket , this operation gives a formula for the minimum number of self - intersections of a loop in a given free homotopy class . in this paper </S>",
    "<S> we consider the corresponding question for virtual strings . </S>",
    "<S> we show that @xmath0 gives a bound on the minimal self - intersection number of a virtual string which is stronger than a bound given by turaev s virtual string cobracket . </S>",
    "<S> we use turaev s based matrices to describe strings @xmath1 such that @xmath0 gives a formula for the minimal self - intersection number @xmath1 . </S>",
    "<S> we also construct an example that shows the bound on the minimal self - intersection number given by @xmath0 is sometimes stronger than the bound @xmath2 given by turaev s based matrix invariant . </S>"
  ]
}