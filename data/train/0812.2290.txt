{
  "article_text": [
    "dynamic data driven application systems ( dddas ) @xcite aim to integrate data acquisition , modeling , and measurement steering into one dynamic system .",
    "data assimilation is a statistical technique to modify model state in response to data and an important component of the dddas approach .",
    "models are generally discretizations of partial differential equations and they may have easily millions of degrees of freedom .",
    "the model equations themselves are posed in functional spaces , which are infinitely dimensional . because of nonlinearities , the probability distribution of the state is usually non - gaussian .",
    "a number of methods for data assimilation exist @xcite .",
    "filters attempt to find the best estimate from the model state and the data up to the present .",
    "we present a combination of the ensemble kalman filter ( enkf ) @xcite and the sequential importal sampling ( sis ) particle filter ( pf ) @xcite .",
    "the enkf is a monte - carlo implementation of the kalman filter ( kf ) .",
    "the kf is an exact method for gaussian distributions .",
    "however , it needs to maintain the state covariance matrix , which is not possible for large state dimension .",
    "the enkf and its variants @xcite replace the covariance by the sample covariance computed from an ensemble of simulations .",
    "each ensemble member is advanced in time by the model independently until analysis time , when the data is injected , resulting in changes in the states of the ensemble members .",
    "particle filters also evolve a ensemble of simulations , but they assign to each ensemble member a weight and the analysis step updates the weights .",
    "the kf and the enkf represent the probability distributions by the mean and the covariance , and so they assume that the distributions are gaussian .",
    "this shows in the tendency of enkf to smear distributions towards unimodal , as illustrated in sec .",
    "[ sec : numerical ] below .",
    "so , while the enkf has the advantage that it can make large charges in the state and the ensemble can represent an arbitrary distribution , the enkf is still essentialy limited to gaussian distributions . on the other hand ,",
    "the pf can represent non - gaussian distributions faithfully , but it only updates the weights and can not move ensemble members in the state space . thus",
    "a method that combines the advantages of both without the disadvantages of either is of interest .",
    "the design of more efficient non - gaussian filters for large - scale problems has been the subject of significant interest , often using gaussian mixtures and related approaches @xcite .",
    "the predictor - corrector filter presented here uses an enkf  as a predictor to move the state distribution towards the correct region and then a pf as corrector to adjust for a non - gaussian character of the distribution .",
    "nonparametric density estimation is used to compute the weights in the pf .",
    "the combined predictor - corrector method appears to work well on problems where either enkf  of pf fails , and it does not degrade the performace of the enkf for gaussian distributions .",
    "predictor - corrector filters were first formulated in @xcite . related results and some probabilistic background can be found in @xcite .",
    "a  common procedure to construct an initial ensemble is as a sum with random coefficients @xcite , @xmath0 where @xmath1 is an orthonormal basis in the space state @xmath2 equipped with the euclidean norm @xmath3 .",
    "the elements of @xmath4 are column vectors of values of functions on a mesh in the spatial domain .",
    "the basis functions @xmath5 are smooth for small @xmath6 and more oscillatory for large @xmath6 .",
    "if the the coefficients @xmath7 sufficiently fast , the series ( [ eq : random - smooth ] ) converges and @xmath8 is a random smooth function in the limit as @xmath9 .",
    "the sum ( [ eq : random - smooth ] ) defines a gaussian random variable with the eigenvalues of its covariance matrix equal to @xmath10 .",
    "possible choices of @xmath11 include a fourier basis , such as the sine or cosine functions , or bred vectors @xcite . on the state space @xmath4",
    ", we define another norm by @xmath12 note that if @xmath13 , @xmath14 is just the original norm @xmath15 on @xmath4 .",
    "we generally use @xmath16 adapted to the smoothness of the functions in the initial ensemble , @xmath17 as @xmath18 .",
    "a weighted ensemble of @xmath19 simulations @xmath20 is initialized according to ( [ eq : random - smooth ] ) , with equal weights @xmath21 .",
    "the ensemble members are advanced by the model and at given points in time , new data is injected by an _",
    "analysis step_. the data consists of vector @xmath22 of measurements , observation function @xmath23 , also called forward operator , here assumed to be linear , which links the model state space with the data space , and data error distribution , here assumed to be gaussian with zero mean and known covariance @xmath24 .",
    "the value of the observation function @xmath25 is what the data vector would be in the absence of model and data errors .",
    "the value of the probability density of the data error distribution at the data vector @xmath22 for a given value of the observation function @xmath25 is called _ data likelihood _ and denoted by @xmath26 .",
    "the probability distribution of the model state before the data is injected is called the _ prior _ or the _ forecast _ , and the distribution after the data is injected is called the _ posterior _ or the _ analysis_. assuming the forecast probability distribution has the density @xmath27 , the density @xmath28 of the analysis is found from the bayes theorem , @xmath29 where @xmath30 means proportional .    instead of working with densities ,",
    "the probability distributions are approximated by weighted ensembles .",
    "we will call the following analysis step algorithm _",
    "enkf - sis_.    * predictor . * given a forecast ensemble @xmath31 the members @xmath32 of the analysis ensemble are found from the enkf , @xmath33 where @xmath34 are randomly sampled from the data distribution , and @xmath35 is the forecast ensemble covariance,@xmath36 this is the enkf from @xcite , extended to weighted ensembles by the use of the weighted sample covariance ( [ eq : wc ] ) .",
    "* corrector . * the analysis members @xmath32",
    "are thought of as a sample from some _ proposal distribution _",
    ", with density @xmath37 .",
    "ideally , the analysis weights @xmath38 should be computed from the sis update as @xcite @xmath39 however , the ratio of the densities is not known , so it is replaced by a noparametric estimate inspired by @xcite , giving @xmath40 the bandwidth @xmath41 is the distance from @xmath32 to the @xmath42-th nearest member @xmath43 , measured in the @xmath44 norm .",
    "[ c]cc &   + ( a ) prior and data likelihood densities & ( b ) posterior from enkf +   &   + ( c ) posterior from sis & ( d ) posterior from enkf - sis    ) .",
    "enkf - sis was able to approximate the optimal solution better than either sis or enkf alone .",
    ", width=288 ]    fig .",
    "[ fig : bimodal ] demonstrates a failure of enkf for non - gaussian distributions , while sis and enkf - sis do fine .",
    "we construct a bimodal prior in 1d by first sampling from @xmath45 and assigning the weights by @xmath46 the data likelihood is gaussian .",
    "the ensemble size was @xmath47 .",
    "the next 1d problem demonstrates that enkf - sis is doing better that either enkf or sis alone in filtering for the stochastic differential equation  @xcite @xmath48 where @xmath49 is white noise .",
    "the parameter @xmath50 controls the magnitude of the stochastic term .",
    "the deterministic part of this differential equation is of the form @xmath51 where the potential @xmath52 .",
    "the equilibria are given by @xmath53 ; there are two stable equilibria at @xmath54 and an unstable equilibrium at @xmath55 .",
    "the stochastic term of the differential equation makes it possible for the state to flip from one stable equilibrium point to another ; however , a sufficiently small @xmath50 insures that such an event is rare .    a suitable test for an ensemble filter will be to determine if it can properly track the model as it transitions from one stable fixed point to the other .",
    "from fig .",
    "[ fig : bimodal ] , it is clear that enkf will not be capable of describing the bimodal nature of the state distribution so it will not perform well when tracking the transition . also , when the ensemble is centered around one stable point , it is unlikely that some ensemble members would be close to the other stable point .",
    "it is known that sis can be very slow in tracking the transition and enkf can do better @xcite .",
    "[ fig : rsode_results ] demonstrates that enkf can outperform both .",
    "the solution @xmath8 of ( [ eq : rsode ] ) is a random variable dependent on time , with density @xmath56 .",
    "the evolution of the density in time is given by the fokker - planck equation , which was solved numerically on a uniform mesh from @xmath57 to @xmath58 with the step @xmath59 .",
    "at the analysis time , the optimal posterior density was computed by multiplying the probability density of @xmath8 by the data likelihood following ( [ eq : bayes - dens ] ) and then scaling so that again @xmath60 , using numerical quadrature by the trapezoidal rule .",
    "the data points were taken from one solution of this model , called a reference solution , which exhibits a switch at time @xmath61 .",
    "the data error distribution was normal with the variance taken to be @xmath62 at each point . to advance the ensemble members and the reference solution , we have solved ( [ eq : rsode ] ) by the explicit euler method with a random perturbation from @xmath63 added to the right hand side in every step @xcite .",
    "the simulation was run for each method with ensemble size @xmath64 , and assimilation performed for each data point .",
    "[ sec : hd ]    [ c]cc$ ] .",
    "the vertical axis is the value of function @xmath8 .",
    "the level of shading on each vertical line is the marginal density of @xmath8 at a fixed @xmath65 , computed from a histogram with 50 bins .",
    "while enkf completely ignores the non - gaussian character of the posterior and centers the distribution around @xmath55 , enkf - sis shows darker bands at the edges .",
    ", title=\"fig:\",width=201 ] & $ ] .",
    "the vertical axis is the value of function @xmath8 .",
    "the level of shading on each vertical line is the marginal density of @xmath8 at a fixed @xmath65 , computed from a histogram with 50 bins .",
    "while enkf completely ignores the non - gaussian character of the posterior and centers the distribution around @xmath55 , enkf - sis shows darker bands at the edges .",
    ", title=\"fig:\",width=201 ] + ( a ) & ( b ) + $ ] .",
    "the vertical axis is the value of function @xmath8 .",
    "the level of shading on each vertical line is the marginal density of @xmath8 at a fixed @xmath65 , computed from a histogram with 50 bins .",
    "while enkf completely ignores the non - gaussian character of the posterior and centers the distribution around @xmath55 , enkf - sis shows darker bands at the edges .",
    ", title=\"fig:\",width=201 ] & $ ] .",
    "the vertical axis is the value of function @xmath8 .",
    "the level of shading on each vertical line is the marginal density of @xmath8 at a fixed @xmath65 , computed from a histogram with 50 bins .",
    "while enkf completely ignores the non - gaussian character of the posterior and centers the distribution around @xmath55 , enkf - sis shows darker bands at the edges .",
    ", title=\"fig:\",width=201 ] + ( c ) & ( d )    [ c]cc$ ] .",
    "the vertical axis is the value of function @xmath8 .",
    "the level of shading on each vertical line is the marginal density of @xmath8 at a fixed @xmath65 , computed from a histogram with 50 bins .",
    "while enkf and enkf - sis create ensembles that are attracted to the data value @xmath66 , sis can not reach so far because there are no such members in this relatively small ensemble of size @xmath47 .",
    ", title=\"fig:\",width=201 ] & $ ] .",
    "the vertical axis is the value of function @xmath8 .",
    "the level of shading on each vertical line is the marginal density of @xmath8 at a fixed @xmath65 , computed from a histogram with 50 bins .",
    "while enkf and enkf - sis create ensembles that are attracted to the data value @xmath66 , sis can not reach so far because there are no such members in this relatively small ensemble of size @xmath47 .",
    ", title=\"fig:\",width=201 ] + ( a ) & ( b ) + $ ] .",
    "the vertical axis is the value of function @xmath8 .",
    "the level of shading on each vertical line is the marginal density of @xmath8 at a fixed @xmath65 , computed from a histogram with 50 bins .",
    "while enkf and enkf - sis create ensembles that are attracted to the data value @xmath66 , sis can not reach so far because there are no such members in this relatively small ensemble of size @xmath47 .",
    ", title=\"fig:\",width=201 ] & $ ] .",
    "the vertical axis is the value of function @xmath8 .",
    "the level of shading on each vertical line is the marginal density of @xmath8 at a fixed @xmath65 , computed from a histogram with 50 bins .",
    "while enkf and enkf - sis create ensembles that are attracted to the data value @xmath66 , sis can not reach so far because there are no such members in this relatively small ensemble of size @xmath47 .",
    ", title=\"fig:\",width=201 ] + ( c ) & ( d )    finally , typical results for filtering in the space of functions on @xmath67 $ ] of the form@xmath68 are in figs .  [",
    "fig : b - enkf ] and [ fig : sis - fail ] .",
    "the ensemble size was @xmath47 and the dimension of the state space was @xmath69 .",
    "the fourier coefficients were chosen @xmath70 to generate the initial ensemble from ( [ eq : random - smooth ] ) , and @xmath71 for the norm in the density estimation .",
    "[ fig : b - enkf ] again shows that enkf can not handle bimodal distribution .",
    "the prior was constructed by assimilating the data likelihood@xmath72{l}% 1/2\\mbox { if } u(\\pi/4)\\mbox { and }",
    "\\\\ \\quad\\quad u\\left (   3\\pi/4\\right )   \\in\\left (   -2,-1\\right )   \\cup(1,2)\\\\ 0\\mbox { otherwise } \\end{array } \\right.\\ ] ] into a large initial ensemble ( size 50000 ) and resampling to the obtain the forecast ensemble size @xmath47 with a non - gaussian density .",
    "then the data likelihood @xmath73 was assimilated to obtain the analysis ensemble .",
    "[ fig : sis - fail ] shows a failure of sis .",
    "the prior ensemble sampled from gaussian distribution with coefficients @xmath70 using ( [ eq : random - smooth ] ) and ( [ eq : sin ] ) , and the data likelihood was @xmath74 .",
    "we have demonstrated the potential of a predictor - corrector filter to perform a successful bayesian update in the presence of non - gaussian distributions , large number of degrees of freedom , and large change of the state distribution .",
    "open questions include convergence of the filter in high dimension when applied to multiple updates over time , mathematical convergence proofs for the density estimation and for the bayesian update , and performance of the filters when applied to systems with a large number of different physical variables and modes , as is common in atmospheric models .",
    "darema , f. : dynamic data driven applications systems : a new paradigm for application simulations and measurements . in : bubak , m. , van albada , g.d . ,",
    "sloot , p.m.a . ,",
    "dongarra , j.j .",
    "iccs 2004 , lncs , vol . 3038 , pp .",
    "springer ( 2004 )                    mandel , j. , beezley , j.d . : predictor - corrector and morphing ensemble filters for the assimilation of sparse data into high dimensional nonlinear systems . in : 11th symposium on integrated observing and assimilation systems for the atmosphere , oceans , and land surface ( ioas - aols ) , cd - rom , paper 4.12 , 87th american meteorological society annual meeting , san antonio , tx , http://ams.confex.com/ams/87annual/techprogram/paper_119633.htm ( 2007 )"
  ],
  "abstract_text": [
    "<S> an ensemble kalman filter ( enkf , the predictor ) is used make a large change in the state , followed by a particle filer ( pf , the corrector ) , which assigns importance weights to describe a non - gaussian distribution . </S>",
    "<S> the importance weights are obtained by nonparametric density estimation . </S>",
    "<S> it is demonstrated on several numerical examples that the new predictor - corrector filter combines the advantages of the enkf and the pf and that it is suitable for high dimensional states which are discretizations of solutions of partial differential equations .    </S>",
    "<S> * key words : * dynamic data driven application systems , data assimilation , ensemble kalman filter , particle filter , tracking , non - parametric density estimation , bayesian statistics </S>"
  ]
}