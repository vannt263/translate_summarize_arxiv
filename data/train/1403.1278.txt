{
  "article_text": [
    "most images in the real world suffer from noise . in photography noisy images",
    "occur when taking a photograph under bad lighting conditions , for instance .",
    "medical imaging applications , such as magnetic resonance imaging ( mri ) and positron electron tomography ( pet ) , produce under - sampled and noisy image data . in general ,",
    "the quality of images obtained from imaging devices in the real world , in the sciences and medicine , is limited by the hardware and the limited time available to measure the image data .",
    "hence , one of the most important tasks in image processing is the reduction of noise in images , called image denoising .",
    "a common challenge in image denoising is the setup of a suitable denoising model .",
    "the model depends on the noise distribution and the class of images the denoised solution should belong to . in @xcite",
    "a bilevel optimisation approach to learn the correct setup for a tv denoising model from a set of noisy and clean test images is proposed . there , optimal parameters @xmath0 are determined by solving the following optimisation problem : @xmath1 subject to the set of nonsmooth constraints : @xmath2    in - @xmath3 is the image domain , @xmath4 is the total variation ( tv ) @xmath5 in @xmath6 and @xmath7 is the space of functions of bounded variation ( see @xcite ) . for each @xmath8 ,",
    "the pair @xmath9 is an element of a set of @xmath10 pairs of clean and noisy test images , respectively , whereas @xmath11 is the tv - denoised version of @xmath12 . for @xmath13 the terms",
    "@xmath14 represent the different data fidelities , each one modelling one particular type of noise weighted by a parameter @xmath15 .",
    "examples of @xmath16 are @xmath17 for noise with gaussian distribution and @xmath18 for the case of impulse noise .",
    "the set @xmath19 is the set of admissible functions such that the data fidelity terms are well defined .    in this paper",
    ", we use a simulated database of clean and noisy images .",
    "this is not uncommon . even in real world applications such as mri , simulated databases",
    "are used to tune image retrieval systems , see for instance @xcite .",
    "alternatively , we can imagine the retrieval of such a test set for a specific application using phantoms and their noisy acquisitions .",
    "ideally , we would like to consider a very rich database ( i.e. @xmath20 ) in order to get a more robust estimation of the parameters , thus dealing with a very large set of constraints that would need to be solved in each iteration of an optimisation algorithm applied to - .",
    "the computational solution of such an optimisation problem renders expensive and therefore challenging due to the large - scale nature of the problem - and due to the nonsmooth nature of each constraint .    in order to deal with such large - scale problems",
    "various stochastic optimisation approaches have been presented in literature .",
    "they are based on the common idea of solving not _ all _ the pde constraints , but just a sample of them , whose size varies according to the approach one intends to use . in this paper",
    "we focus on a stochastic approximation method proposed by byrd et al .",
    "@xcite called _ dynamic sample size _ method .",
    "the main idea of this method is to consider an initial , small , training sample of the dictionary to start the algorithm with and _ dynamically _ increasing its size , if needed , throughout the different steps of the optimisation process .",
    "the criterion to decide whether or not the sample size has to be increased is a check on the sample variance estimates on the batch gradient .",
    "the desired trade - off between efficiency and accuracy is then obtained by starting with a small sample and gradually increasing its size till reaching the requested level of accuracy .",
    "let us mention that the method of byrd et al .",
    "is one among various stochastic optimisation methods , compare for instance @xcite .",
    "our work extends the work of @xcite in two directions : firstly , in @xcite the linearity of the solution map is required which is not fulfilled for our problem - .",
    "we are going to show that the strategy of byrd et al .",
    "can be modified for nonlinear solution maps as the one we are considering .",
    "secondly , in @xcite the optimization algorithm is of gradient - descent type . using a bfgs method to solve - we extend their approach incorporating also",
    "_ second order _ information in form of an approximation of the hessian by evaluations of the sample gradient in the iterations of the optimisation algorithm .",
    "* organisation of the paper . * in the following section [ sec : dynscheme ] we present the dynamic sampling algorithm adapted to the nonlinear framework of problem - , specifying the variance condition on the batch gradient used in our optimisation algorithm . in section",
    "[ sec : numres ] we present the numerical results obtained for the estimation of the optimal parameters in the case of single and mixed noise estimation for the model - showing significant improvements in efficiency .",
    "* preliminaries . *",
    "we denote the vector of parameters we aim to estimate by @xmath21 .",
    "we also define by @xmath22 the solution map that , for each constraint @xmath23 of , associates to @xmath24 and to the noisy image @xmath12 the corresponding total variation denoised solution @xmath11 , that is @xmath25 .",
    "let us then define the reduced cost functional @xmath26 as @xmath27 we also define : @xmath28 as the _ loss functions _ of the functional @xmath29 defined in for each @xmath23 . for every sample @xmath30 of the database , we introduce the batch objective function : @xmath31",
    "to design the optimisation algorithm solving - we follow the approach used in @xcite . there , a quasi - newton method ( namely , the broyden - fletcher -goldfarb - shanno algorithm bfgs ) is considered together with an armijo backtracking linesearch rule .",
    "we combine such algorithm with a modified version of the dynamic sampling algorithm presented in ( * ? ? ?",
    "* section 3 ) . in order to compare our algorithm with the newton - conjugate gradient method presented in (",
    "* ? ? ? * section 5 ) , we highlight that in our optimisation algorithm the hessian matrix is never computed , but approximated efficiently by the bfgs matrix .",
    "our algorithm starts by selecting from the whole dataset a sample @xmath32 whose size @xmath33 is small compared to the original size @xmath10 . in the following iterations ,",
    "if the approximation computed produces an improvement in the cost functional @xmath29 , then the sample size is kept unchanged and the optimisation process continues selecting in the next iteration a new sample of the same size .",
    "otherwise , if the approximation computed is not a good one , a new , larger , sample size is selected and a new sample @xmath32 of this new size is used to compute the new step . by starting with small sample sizes it is hoped that in the early stages of the algorithm the solution can be computed efficiently in each iteration .",
    "the key point in this procedure is clearly the rule that checks throughout the progression of the algorithm , whether the approximation we are performing is good enough , i.e. the sample size is big enough , or has to be increased . because of this systematic check on the quality of approximation in each step of the algorithm ,",
    "such sampling strategy is called _",
    "dynamic_.    as in @xcite , we consider a condition on the batch gradient @xmath34 which imposes in every stage of the optimisation that the direction @xmath35 is a descent direction for @xmath29 at @xmath24 if the following condition holds : @xmath36    the computation of @xmath37 may be very expensive for applications involving large databases and nonlinear constraints , so we rewrite as an estimate of the variance of the random vector @xmath38 . in order to do that ,",
    "recalling definitions and we observe that @xmath39 we can compute in correspondence to an optimal solution @xmath40 by using ( * ? ? ?",
    "* remark 3.4 ) where a characterisation of @xmath37 is given in terms of the adjoint states @xmath41 ( see section 3 for details ) . by linearity and extending to the multiple - constrained case , we get : @xmath42 thanks to this characterisation , we now extend the dynamic sampling algorithm in @xcite to the case where the solution map @xmath22 is nonlinear : by taking into account and following ( * ? ? ?",
    "* section 3 ) we can rewrite as a condition on the variance of the batch gradient that reads as @xmath43 for a detailed derivation of , see @xcite .",
    "condition is the responsible for possible changes in the sample size in the optimisation algorithm and has to be checked in every iteration .",
    "if inequality is not satisfied , a larger sample @xmath44 whose size satisfies the descent condition needs to be considered . by assuming that the change in the sample size is gradual enough such that , for any given @xmath24 : @xmath45 we see that condition is satisfied whenever we choose @xmath46 such that latexmath:[\\[\\label{samplesize }    conditions and are the key points in the optimisation algorithm we are going to present : by checking the former , one can control whether the sampling approximation is accurate enough and if this is not the case at any stage of the algorithm , by imposing the latter a new larger sample size is determined .",
    "we remark that these two conditions force the direction @xmath35 to be a descent direction .",
    "steepest descent methods are known to be slowly convergent .",
    "algorithms incorporating information coming from the hessian are generally more efficient . however , normally the computation of the hessian is very expensive , so hessian - approximating methods are commonly used . in @xcite a newton - cg method is employed . there , an approximation of the hessian matrix @xmath48 is computed only on a subsample @xmath49 of @xmath32 such that @xmath50 . as the sample @xmath32 is dynamically changing , the subsample @xmath49 will change as well ( with a fixed , constant ratio ) and the computation of the new conjugate gradient direction can be performed efficiently . in this work , in order to compute an approximation of the hessian we consider the well - known bfgs method which has been extensively used in the last years because of its efficiency and low computational costs . before giving a full description of the resulting algorithm solving - , we briefly comment on the linesearch rule that is employed in the update of the bfgs matrix .",
    "we choose an armijo backtracking line search rule with curvature verification : the bfgs matrix is updated only if the curvature condition is satisfied .",
    "the amijo criterion is : @xmath51 where the value @xmath52 will be specified in section [ sec : numres ] , @xmath53 is the descent direction of the quasi - newton step , @xmath54 is the length of the quasi - newton step and @xmath55 is defined in .",
    "the positivity of the parameters is always preserved along the iterations .",
    "we present now the bfgs optimisation with dynamic sampling for solving - : compared to ( * ? ? ?",
    "* algorithm 5.2 ) we stress once more that the gain in efficiency is obtained thanks to the use of bfgs instead of the newton - cg sampling method .",
    "initialize : @xmath56 , sample @xmath57 with @xmath58 and model parameter @xmath59 , @xmath60 .",
    "* while * bfgs not converging , @xmath61 ; ;",
    "in this section we present the numerical results of the dynamic sampling algorithm 1 applied to compute the numerical solution of - . in our numerical computations",
    "we fix the parameter values as follows :    * we consider images of size @xmath62 .",
    "we approximate the differential operators by discretising with finite difference schemes with mesh step size @xmath63(number of pixels in the @xmath64-direction ) .",
    "we use forward difference for the discretisation of the divergence operator and backward differences for the gradient .",
    "the laplace operator is discretised by using the usual five point formula . *",
    "the tv constraints in are solved by means of semismooth newton ( ssn ) algorithms whose form depends on the @xmath16 s in ( cf .",
    "* section 4 ) ) solving regularised problems which stop if either the difference between two consecutive iterates is small enough or if the maximum number of iterations @xmath65 is reached .",
    "* in the armijo condition the value @xmath52 is chosen to be @xmath66 .      as a toy example",
    ", we start by considering the case when the noise in the images is normally distributed . in - , this reflects in the estimation of just one parameter @xmath67 that weights the fidelity term @xmath17 in each constraint . considering the training database @xmath68 of clean and noisy images , the problem reduces to : @xmath69 where , for each @xmath8 , @xmath11 is the solution of the regularised pde @xmath70 in @xmath71 arises from a huber - type regularisation of the subdifferential of @xmath72 with parameter @xmath73 and the @xmath74 term is an artificial diffusion term that sets up the problem in the hilbert space @xmath75 ( see ( * ? ? ?",
    "* section 3 ) for details ) .    as shown in (",
    "* theorem 3.5 ) the adjoint states @xmath41 can be computed for each constraint as the solution of the following equation @xmath76 recalling also equations - needed for the computation of the gradient , we can now apply algorithm 1 to solve - .    for the following numerical tests ,",
    "the parameters of this model are chosen as follows : @xmath77 .",
    "the noise in the images has distribution @xmath78 .",
    "the parameter @xmath59 of the algorithm 1 , is chosen to be @xmath79 .",
    "we will comment on the sensitivity of the method to @xmath59 later on .",
    "table [ tablegauss ] shows the numerical value of the optimal parameter @xmath80 when varying the size of the dictionary .",
    "we measure the efficiency of the algorithms used in terms of the number of nonlinear pdes solved during the bfgs optimisation and we compare the efficiency of solving - without and with the dynamic sampling strategy . we observe a clear improvement in efficiency when using dynamic sampling : the number of pdes solved in the optimisation process is very much reduced .",
    "we note that this corresponds to an increasing number of bfgs iterations which does not appear to be an issue as bfgs iterations are themselves very fast . for the sake of computational efficiency , what really matters is the number of pdes that need to be solved in _ each _ iteration of bfgs .",
    "moreover , thanks to modern parallel computing methods and to the decoupled nature of the constraints in each bfgs iteration , solving such a reduced amount of pdes makes the computational efforts very reasonable .",
    "in fact , we note that the size of the sample is generally maintained very small in comparison to @xmath10 or just slightly increased .",
    "computing also the relative error between the optimal parameter computed by solving all the pdes and the one computed with dynamic sampling method , we note a good level of accuracy : the difference between the two values remains below @xmath81 .",
    "in this paper , we propose an efficient and competitive technique to solve numerically the constrained optimisation problem - designed for learning the noise model in a tv denoising framework accounting for different types of noise .",
    "the set of nonsmooth pde constraints resembles a large - size training database of clean and noisy images that allows a more robust estimation of parameters . to solve the problem , we use _ dynamic sampling _ methods , proposed in @xcite for _ linear _ constrained problems",
    "the idea consists in selecting just a small sample of the pdes that need to be solved over the whole database and then , during the progression of the algorithm , verify whether such a size produces approximations that are accurate enough .",
    "extended to our nonlinear framework , the results show a remarkable improvement in efficiency , which reflects in reduced computational times for both single noise estimations as well as for mixed ones .",
    "further directions for future research are an accurate analysis of convergence properties of such a scheme as well as the design of a similar algorithm for the case of a @xmath82-regularisation on the parameter vector .",
    "mantle m.d . ,",
    "sederman a.j .",
    ", gladden l.f . : _",
    "single- and two- phase flow in fixed - bed reactors : mri flow visualisation and lattice - boltzmann simulations _ , chemical engineering science , 56 , 523 - 529 ( 2001 ) ."
  ],
  "abstract_text": [
    "<S> we consider the bilevel optimisation approach proposed in @xcite for learning the optimal parameters in a total variation ( tv ) denoising model featuring for multiple noise distributions . in applications </S>",
    "<S> , the use of databases ( dictionaries ) allows an accurate estimation of the parameters , but reflects in high computational costs due to the size of the databases and to the nonsmooth nature of the pde constraints . to overcome this computational barrier we propose an optimisation algorithm that </S>",
    "<S> , by sampling _ dynamically _ from the set of constraints and using a quasi - newton method , solves the problem accurately and in an efficient way . </S>"
  ]
}