{
  "article_text": [
    "let @xmath1 be the potential energy function of a classical model for a molecular system .",
    "a fundamental challenge is to sample the configurational gibbs - boltzmann ( canonical ) distribution with density @xmath2 where @xmath3 where @xmath4 is boltzmann s constant , @xmath5 is temperature , and @xmath6 is a normalization constant so that @xmath7 has unit integral over the entire configuration space .",
    "a wide variety of methods are available to calculate averages with respect to @xmath7 ; among these , some of the most popular are based on brownian dynamics or langevin dynamics ( defined in the phase space of positions and momenta ) @xcite .",
    "( in this article we focus exclusively on molecular dynamics techniques ; molecular models can also be sampled using monte - carlo methods , and , more generally , using hybrid algorithms which combine molecular dynamics with a metropolis - hastings test in order to correct averages .",
    "for a recent review of such schemes see @xcite . )",
    "recall that brownian dynamics ( overdamped langevin dynamics ) is a system of it - type stochastic differential equations of the form @xmath8 where @xmath9 is the infinitesimal increment of a vector of stochastic wiener processes @xmath10 , and @xmath11 is a positive ( we assume here diagonal ) mass matrix .",
    "a simple and popular method for numerical solution of eq .",
    "[ bd ] is the euler - maruyama method @xmath12 where @xmath13 is a vector of random variables with standard normal distribution .",
    "this produces a sequence of points @xmath14 , which , following a certain relaxation period , are approximately distributed according to the canonical invariant distribution .",
    "euler - maruyama has the property that the time averages along discrete trajectories , in the limit of large time ( under appropriate conditions on the potential @xmath15 and assuming no effects from floating point rounding error ) , have error proportional to @xmath16 .",
    "one of the observations of this article is that the simple modification @xmath17 provides a second order approximation of stationary averages .",
    "we arrive at this scheme by considering the large friction limit in a particular numerical method for langevin dynamics .",
    "recall that langevin dynamics is a stochastic - dynamical system involving both positions and momenta @xmath18 of the form @xmath19{\\rm d}t + \\sigma m^{1/2}{\\rm d}w , \\label{lang}\\ ] ] where @xmath20 is again a vector of @xmath0 independent wiener processes , and @xmath21 is a free parameter , the friction coefficient .",
    "the methods that are in fact the primary focus of this paper are splitting integrators that decompose the stochastic vector field of langevin dynamics into simpler vector fields which can be solved exactly .",
    "the composition method that results can not be directly related to a stochastic differential equation , so the analogy with backward error analysis for deterministic problems @xcite is incomplete , but nonetheless the invariant measure associated to the numerical method can be derived , using the baker - campbell - hausdorff ( bch ) expansion , as an asymptotic series in two parameters : the stepsize and the reciprocal of the friction coefficient .",
    "the superconvergence result alluded to above is then obtained in the high friction limit .",
    "the langevin stepsize must be understood to be proportional to the square root of the stepsize that appears in eq .",
    "[ bd - mod ] , so in langevin dynamics an effective 4th order approximation is obtained , but only for the marginal configurational invariant distribution , eq .",
    "[ configdist ] .",
    "our approach also provides a simple method for comparative assessment of the invariant measure of a class of langevin integrators .",
    "molecular dynamics is a large family of modelling techniques which is widely used in different application areas and for different purposes @xcite .",
    "this article is addressed specifically to the topic of calculating averages with respect to an invariant distribution , and will probably be of highest interest for applications in molecular sampling , in particular the calculation of averages with respect to the configurational density eq .",
    "[ configdist ] .",
    "the high friction limit renders langevin dynamics unsuitable for dynamical modelling ( except as a method for generating starting configurations for dynamical exploration ) .",
    "it is worth noting that invariant measure computations arise frequently in applications other than molecular modelling , and the techniques described here would be of potential use in many of these .    in large scale simulations",
    ", it should be understood that the statistical error ( dependent on the number of samples used ) is typically the dominant concern .",
    "our approach focuses on the truncation error of the invariant distribution , thus the greatest benefit would be seen only when the statistical error is well controlled .",
    "nonetheless we observe in our numerical experiments that the least biased scheme from the point of view of the error introduced in configurational sampling is also as efficient as the alternatives and the most robust with respect to variation of the parameters ( stepsize , friction coefficient ) , thus there is effectively no price for the improvement in accuracy .",
    "moreover , it would be possible to complement the methods proposed here by procedures such as importance sampling @xcite to further reduce the statistical error . with regard to the approximation of canonical averages ,",
    "methods have previously been constructed for brownian dynamics with order @xmath22 and for langevin dynamics with order @xmath23 @xcite , but these require multiple evaluations of the force ; for this reason they are not normally viewed as competitive alternatives for molecular sampling @xcite .",
    "by contrast all of the methods described in this article use a single force evaluation at each timestep .",
    "the approach used here may be compared to other recent works on stochastic numerical methods , and , in particular @xcite .",
    "our technique differs from these in ( i ) the direct focus on the stationary configurational distribution , and ( ii ) the use of the bch expansion .",
    "other articles ( see e.g. @xcite ) which address the invariant measure in langevin - type stochastic differential equations do not use the backward error analysis ( and do not find the superconvergent scheme ) .",
    "the rest of this article is as follows . in section 2",
    "we review necessary background on stochastic differential equations for sampling from the gibbs measure .",
    "section 3 presents our expansion of the associated perturbed invariant measure and calculations involving the use of the baker - campbell - hausdorff theorem .",
    "section 4 describes the reduction of the methods in the case of overdamped langevin dynamics .",
    "section 5 demonstrates the theory obtained using numerical experiments to verify the results .",
    "the ornstein - uhlenbeck ( ou ) stochastic differential equation is an it equation of the form @xmath24 where @xmath25 is a random variable defined for each time @xmath26 , @xmath27 and @xmath28 are positive parameters and @xmath29 represents the infinitesimal increment of a wiener process .",
    "langevin dynamics ( eq . [ lang ] ) combines the ornstein - uhlenbeck stochastic vector field with conservative dynamics . for stochastic differential equations",
    ", the density evolves according to an evolution equation ( the fokker - planck or forward kolmogorov equation ) of the form @xmath30 where @xmath31 is a second order differential operator . in the case of langevin dynamics",
    ", the relevant kolmogorov operator is defined by its action on a function @xmath32 of the variables of the system by @xmath33 where @xmath34 is the mass - weighted laplacian in the momenta : @xmath35 . by choosing @xmath36 one",
    "easily checks that the gibbs distribution with density @xmath37 is a steady state of the kolmogorov equation , where @xmath38 is a normalising constant and @xmath39 represents the hamiltonian energy function . for later reference",
    ", we define averages with respect to the gibbs distribution by @xmath40 assuming @xmath41 is @xmath42 it is possible to demonstrate that the operator @xmath43 is hypoelliptic by using hrmander s criterion @xcite based on iterated commutators , and this implies that the gibbs measure is the unique steady state ( up to normalization ) .",
    "even stronger is the result of @xcite which demonstrates the existence of a spectral gap for the operator @xmath44 .",
    "many of the challenges related to obtaining formal analytical results for stochastic differential equations relate to singularities of the potential and/or the assumption of an unbounded solution domain .",
    "however , with periodic boundary conditions and strong repulsive potentials ( e.g. lennard - jones potentials ) we observe that configurations typically evolve in a bounded set and remain far from singular points ( the radial distribution vanishes in a large interval around the origin ) .",
    "indeed it is a simple calculation to demonstrate that for a lennard - jones system with potentials @xmath45 the expected number of samples required to observe @xmath46 at unit temperature would involve a simulation of duration far greater than the age of the universe , due to the steepness of the potential close to the origin . in our simulations of a small lennard - jones cluster in section 5 , we did not observe a separation of two atoms beneath @xmath47 in all of the nearly @xmath48 timesteps performed to gather statistics ; a separation less than @xmath49 could only be seen at very large stepsizes , when instabilities due to other components of model , e.g. harmonic bonds , would have anyway rendered a typical molecular simulation useless .",
    "thus it is somewhat of a moot point whether we simply assume that configurations stay well away from singular points ( domain restriction ) or that the potential has been smoothly cut off to remove the singularity ; in no case will we encounter the atomic collision singularity in a simulation of the type envisioned here .    for the purpose of deriving practical methods",
    "we assume that ( i ) the positions are confined to a periodic simulation box @xmath50 , where is the one - dimensional torus , and ( ii ) @xmath41 is @xmath42 on @xmath51 .",
    "these assumptions , which are realistic in most molecular dynamics applications for the reasons mentioned above , allow us to use recent results in hypocoercivity @xcite to establish the regularity properties of @xmath44 .",
    "specifically , we have as a consequence of these articles , that    * @xmath52 has a unique solution in @xmath53 , i.e. , the gibbs density @xmath54 , * @xmath43 has a compact resolvent @xcite , and the gibbs state is therefore exponentially attracting .",
    "note that , if , for some given @xmath55 , there are two solutions of @xmath56 then , using the linearity of the operator these may differ only in a constant scaling of the gibbs density .      in a splitting method for a deterministic system @xmath57 ,",
    "one divides the vector field @xmath58 into exactly solvable parts , i.e. @xmath59 , which are treated sequentially within a timestep .",
    "an example of such a splitting method for the hamiltonian system with energy @xmath60 is the `` symplectic euler '' method defined by @xmath61 , @xmath62 . by dividing the vector field as @xmath63 , solving each vector field in turn",
    ", we obtain the so - called position verlet method , and by switching the roles of @xmath64 and @xmath65 we obtain the velocity verlet method .",
    "splitting methods like these are explicit and this feature is of particular importance in molecular dynamics , where the force calculation is the usual measure of per - timestep computational complexity .    in a similar way",
    ", langevin dynamics may be treated by splitting @xcite .",
    "for example , one may divide the langevin system ( eq .",
    "[ lang ] ) into three parts @xmath66= \\underbrace{\\left [ \\!\\!\\begin{array}{c } m^{-1 } p \\\\0\\end{array}\\!\\",
    "! \\right ] { \\rm d}t}_{\\rm a } + \\underbrace{\\left [ \\!\\ ! \\begin{array}{c } 0 \\\\-\\nabla u\\end{array}\\!\\ ! \\right ] { \\rm d}t}_{\\rm b } + \\underbrace{\\left [ \\!\\ ! \\begin{array}{c } 0\\\\ -\\gamma",
    "p{\\rm d}t + \\sigma m^{1/2}{\\rm d } w \\end{array } \\!\\!\\right ] , } _ { \\rm o } \\label{gla2}\\ ] ] and each of the three parts may be solved ` exactly ' . in the case of the ou part ( labelled here simply as o )",
    "we mean by this that we realize the stochastic process by the equivalent formula @xmath67 where @xmath68 is a vector of uncorrelated independent standard normal random processes ( white noise ) .",
    "one method based on the splitting in eq .",
    "[ gla2 ] is defined by the composition @xmath69 where @xmath70 represents the phase space propagator associated to the ( deterministic or stochastic ) vector field @xmath58 , and we use @xmath71 as the timestep in langevin dynamics ( later we use @xmath16 for the timestep of an associated brownian dynamics ) .",
    "the deterministic part is approximated by the position verlet method .",
    "this is referred to as a geometric langevin algorithm of order two ( gla-2 ) following @xcite ; an alternative is to use velocity verlet for the hamiltonian part ( @xmath72 ) .",
    "a simple generalization of gla methods is obtained by interspersing integrators associated to parts of the hamiltonian vector field with exact ou solves , thus we have @xmath73 and @xmath74 defined in an analogous way .",
    "recent work in @xcite similarly uses exact ou solves to give an integrator equivalent to @xmath75 ( in our notation ) , though with a reparameterised timestep .",
    "the analysis technique we use can employed to study many such integrators , though for brevity we will limit this article to discussion only on a select few interesting cases .",
    "an alternative integrator termed the stochastic position verlet ( spv ) method @xcite , relies on the splitting @xmath76 = \\left [ \\begin{array}{c } m^{-1 } p \\\\0\\end{array } \\right ] { \\rm d}t + \\left [ \\begin{array}{c } 0 \\\\-\\nabla u{\\rm d}t -\\gamma p{\\rm d}t + \\sigma m^{1/2 } { \\rm d } w \\end{array } \\right ] .\\ ] ] spv is not a ( generalized ) gla - type method , although it , as each of the generalized gla schemes , is _",
    "quasisymplectic _ in the language of @xcite .",
    "likewise the commonly used method of brunger , brooks and karplus ( bbk ) @xcite is not of the ( generalized ) gla family .",
    "details of all methods examined are given in the appendix .    to slightly simplify the presentation that follows",
    ", we make the change of variables @xmath77 , @xmath78 , with a corresponding adjustment of the potential ; this is equivalent to assuming @xmath79 .",
    "we shall work here with formal series expansions , however we expect that our derivation could be rigorously founded using techniques found in @xcite and @xcite",
    ". associated to any given splitting - based method for langevin dynamics , we define the operator @xmath80 that characterises the propagation of density by an expansion of the form : @xmath81 for example , for the method labelled by the string abao , we have @xmath82 the perturbation series may be found by successive applications of the bch expansion @xcite and linearity properties of the kolmogorov operator .",
    "however , unlike in the deterministic case , the terms that appear in the series can not be associated to modified vector fields or even sdes @xcite .",
    "note that , when iterated @xmath83 times , the method abao produces a sequence of the form @xmath84^n",
    "e^{\\frac{\\delta t}{2 } { \\cal l}_{\\rm b}}e^{\\frac{\\delta t}{2 } { \\cal l}_{\\rm a } } e^ { { \\delta t } { \\cal l}_{\\rm o } } \\ ] ] thus , with a minor coordinate transformation , the dynamics sample the same invariant density as baoab .",
    "similarly babo and obab are essentially the same method as aboba . for this reason we concentrate in the remainder of this article on aboba and baoab .",
    "for these two methods , the symmetry implies that the odd order terms in eq .",
    "[ opexp ] vanish identically using the jacobi identity in the bch expansions .    after deriving @xmath80 in this way",
    ", we seek the invariant distribution which satisfies @xmath85 . for the baoab and aboba methods",
    ", we make the ansatz that the invariant measure of the numerical method has the simple form @xmath86).\\ ] ] although some technical issues might be encountered , we believe that the existence of such an expansion can be made rigorous using techniques found in @xcite , based on the regularity of the operator @xmath87",
    ". we may rewrite this as @xmath88 this means that the equation @xmath89 becomes @xmath90 equating second order terms in @xmath71 gives @xmath91    the equation @xmath92 has unique solution @xmath93 , up to a constant multiple .",
    "hence the homogeneous solution to the above pde is @xmath94 , for some constant @xmath95 ; we therefore require a particular solution @xmath65 of eq .",
    "[ eqn::pde ] . according to the fredholm alternative",
    ", the equation has a solution provided that , for any solution of @xmath96 we have @xmath97 as the only solutions of @xmath98 are the constants , we require @xmath99      for a symmetric splitting method such as the baoab method , recall that we can use the baker - campbell - hausdorff @xcite formula to find the overall one - step perturbation operator for the scheme . for linear operators @xmath100 , @xmath101 and @xmath6 , we have the relation @xmath102 where @xmath103 \\right ] \\right .",
    "+ \\left[y , \\left [ y , x \\right ] \\right ] + \\left[z , \\left [ y , x \\right ] \\right]+ \\left[y , \\left [ z , x \\right ] \\right ]   \\right .",
    "\\\\ & \\left .",
    "- \\tfrac{1}{2 } \\left[y , \\left [ y , z \\right ] \\right ] - \\tfrac{1}{2 } \\left[x , \\left [ x , z \\right ] \\right ] - \\tfrac{1}{2 } \\left[x , \\left [ x , y \\right ] \\right ]   \\right ) + { \\cal o}(\\delta t^4).\\end{aligned}\\ ] ] here @xmath104 = xy - yx$ ] is the commutator of @xmath101 and @xmath100 .    in the case of the baoab method",
    ", we take @xmath105 and @xmath106 to compute the perturbed operator for the method .",
    "a similar analysis can be conducted for the other generalised gla - type methods considered in this paper .    to compute @xmath80",
    "we simply plug in our choices into the bch formula to obtain : @xmath107 \\right ]   + \\left[{\\cal l}^*_{\\rm a } , \\left [ { \\cal l}^*_{\\rm a } , { \\cal l}^*_{\\rm b } \\right ] \\right ] \\right .",
    "\\\\ & & \\left .",
    "+ \\left[{\\cal l}^*_{\\rm o } , \\left [ { \\cal l}^*_{\\rm a } , { \\cal l}^*_{\\rm b } \\right ] \\right ] + \\left[{\\cal l}^*_{\\rm a } , \\left [ { \\cal l}^*_{\\rm o } , { \\cal l}^*_{\\rm b } \\right ] \\right ]   - \\tfrac{1}{2 } \\left[{\\cal l}^*_{\\rm a } , \\left [ { \\cal l}^*_{\\rm a } , { \\cal l}^*_{\\rm o } \\right ] \\right ]   \\right . \\\\ & & \\left .",
    "- \\tfrac{1}{2 } \\left[{\\cal l}^*_{\\rm b } , \\left [ { \\cal l}^*_{\\rm b } , { \\cal l}^*_{\\rm o } \\right ] \\right ] - \\tfrac{1}{2 } \\left[{\\cal l}^*_{\\rm b } , \\left [ { \\cal l}^*_{\\rm b } , { \\cal l}^*_{\\rm a } \\right ] \\right ]   \\right ) + { o}(\\delta t^4),\\end{aligned}\\ ] ] where recall that @xmath108 and @xmath109 the calculation of the inhomogeneity in ( 8) then amounts to a straightforward computation of the commutator series applied to @xmath110 .",
    "the commutators needed are : @xmath111 \\right ] \\rho_\\beta = & 2 \\beta p^t u''(x ) \\nabla u(x ) \\rho_\\beta - \\rho_\\beta \\beta \\ , p \\cdot \\nabla_x p^t u''(x ) p , \\\\",
    "\\left[{\\cal l}^*_{\\rm b } , \\left [ { \\cal l}^*_{\\rm b } , { \\cal l}^*_{\\rm a } \\right ] \\right ] \\rho_\\beta = & -2 \\beta p^t",
    "u''(x ) \\nabla u(x ) \\rho_\\beta , \\\\",
    "\\left[{\\cal l}^*_{\\rm o } , \\left [ { \\cal l}^*_{\\rm a } , { \\cal l}^*_{\\rm b } \\right ] \\right ] \\rho_\\beta = & 2 \\gamma \\left(\\delta_x u(x ) - \\beta p^t u''(x ) p \\right ) \\rho_\\beta , \\\\",
    "\\left[{\\cal l}^*_{\\rm a } , \\left [ { \\cal l}^*_{\\rm o } , { \\cal l}^*_{\\rm b } \\right ] \\right ] \\rho_\\beta = & \\gamma \\beta \\left (   |\\nabla u(x ) |^2 -   p^t u''(x ) p \\right ) \\rho_\\beta , \\\\ \\left[{\\cal l}^*_{\\rm a } , \\left [ { \\cal l}^*_{\\rm a } , { \\cal l}^*_{\\rm o } \\right ] \\right ] \\rho_\\beta = & 2 \\gamma \\left ( \\beta |\\nabla u(x ) |^2 - \\delta_x u(x ) \\right ) \\rho_\\beta , \\\\",
    "\\left[{\\cal l}^*_{\\rm b } , \\left [ { \\cal l}^*_{\\rm b } , { \\cal l}^*_{\\rm o } \\right ] \\right ] \\rho_\\beta = & 0",
    "\\\\ \\left[{\\cal l}^*_{\\rm o } , \\left [ { \\cal l}^*_{\\rm o } , { \\cal l}^*_{\\rm det } \\right ] \\right ] \\rho_\\beta = & 0,\\end{aligned}\\ ] ] where we have abbreviated the hessian @xmath112    hence we see directly that @xmath113 giving @xmath114 . \\label{fredalt}\\end{aligned}\\ ] ] observe that eq .",
    "[ fa ] is satisfied since the average of the first term is equivalent to a canonical average which vanishes @xmath115 whereas the other terms in eq .",
    "[ fredalt ] , being canonical averages of terms which are odd - order in @xmath18 , necessarily also average to zero .",
    "an analogous computation can be performed for the aboba method , giving a slightly ( but crucially ) different perturbation operator @xmath116 , where @xmath117\\ ] ] here @xmath118 is the hessian matrix of @xmath41 and @xmath119 is the partial laplacian in @xmath120 .",
    "equation [ fa ] is again seen to be satisfied .",
    "although we are not able to give the general analytical solution to the partial differential equation of eq .  [ eqn::pde ] , we can find a solution in an important limiting case : the high friction regime .",
    "to do this , we expand the invariant density of the numerical method further , viewing both @xmath71 and @xmath122 as small parameters : @xmath123 ) .",
    "\\label{densityexpansion}\\ ] ] dividing by @xmath27 , we may reduce eq .",
    "[ eqn::pde ] to @xmath124(f_{2,0 } + \\varepsilon f_{2,1 } + o(\\varepsilon^2 ) ) = g_{0 } + \\varepsilon g_{1},\\ ] ] where @xmath125 and , for baoab , @xmath126 note that this is a singularly perturbed system as @xmath127 is degenerate and it is only the combined operator that has the necessary regularity to define a unique solution . nonetheless , as explained below it is possible to find the leading term @xmath128 by substituting a truncated expansion of fixed degree and solving the resulting equations .",
    "equating powers of @xmath129 , we find @xmath130 and @xmath131    truncating at @xmath132 , for example , we find the following solution of these equations : @xmath133    for aboba , @xmath128 the solution would change to @xmath134      we now turn out attention to the configurational marginal distribution obtained by integrating the density expansion eq .",
    "[ densityexpansion ] with respect to the momenta .",
    "our interest is only in the leading term of this expansion , which defines the sampling behavior for large @xmath27 . ignoring higher order terms in @xmath71 and @xmath129",
    ", we would have the distribution @xmath135 where , for baoab ,",
    "@xmath136   \\right ) $ ] , and @xmath137 .    noting that the leading term in the exponent of @xmath138 is quadratic in momenta",
    ", we integrate out with respect to @xmath18 to obtain @xmath139 \\right )   { \\rm d}^n p\\\\ & = \\sqrt{2 \\pi k_b t /\\det\\left ( i + \\frac{\\delta t^2}{4}u '' \\right ) } \\exp \\left ( -\\beta \\left [   u - \\beta^{-1 } \\frac{\\delta t^2}{8 } \\delta u \\right ] \\right ) \\end{aligned}\\ ] ] using the identity @xmath140 , we find @xmath141 \\right ) .\\ ] ] we then taylor expand the logarithm of @xmath142 and take the trace to obtain a cancellation of the @xmath143 terms , giving @xmath144 the contribution to the configurational distribution error due to @xmath138 is @xmath145 .",
    "this means that the overall error in the marginal distribution of @xmath146 ( which includes the neglected factor @xmath147 ) will be @xmath148 .",
    "if @xmath129 is small ( or @xmath71 is relatively large ) , the error will be dominated by the quartic term in @xmath71 and we will observe 4th order accuracy in configurational averages . for small @xmath71",
    "the method is always eventually second order .    in the case of the aboba method",
    ", the remarkable cancellation of the second order errors does not occur and the method always exhibits 2nd order configuration distribution error .",
    "we now consider the limit @xmath149 , where the exact solution of the vector ou process reduces to @xmath150 , where @xmath151 is a vector whose components have a standard normal distribution ( gaussian white noise ) . alternatively",
    ", we could consider the limit of the particle mass going to @xmath152 , although this requires a reformulation of eq .",
    "[ lang ] so that the friction is proportional to the velocity instead of the momentum @xcite .",
    "whichever limit is taken , we would expect the ultimate result to be the same .",
    "( here we have reintroduced the masses in order to present the method , since they may be useful scaling parameters in simulation . ) in the configurations it is straightforward to show that the baoab method therefore becomes @xmath153 where the @xmath13 are vectors of i.i.d .",
    "standard normal random variables . replacing @xmath154 by @xmath16",
    "we arrive at eq .",
    "[ bd - mod ] .",
    "since the langevin scheme gives 4th order accurate configurational averages in this limit , we expect the method of eq .",
    "[ bd - mod ] to be second order accurate in modified timestep @xmath16 .",
    "moreover , since we completely remove the second order term in the langevin dynamics configurational density expansion , we expect to observe this behaviour across all values of @xmath16 .",
    "by contrast the aboba scheme gives a much more complicated limit method as @xmath149 which is not in one - step form .    in the euler - maruyama method ,",
    "the random perturbations introduced at each step are independent . in the method of eq .",
    "2 , the random perturbation is a scaling of @xmath155 ; the components @xmath156 of these are independent of each other and decay linearly with timestep : @xmath157 thus , in this new method , we use a colored noise which has characteristics that directly depend on the stepsize , although the noise decorrelates in just a couple of timesteps .",
    "this is therefore no longer a markov process , however it can be reformulated as such if one considers the appropriate extended space ( eg . @xmath158 $ ] ) .",
    "we implemented the methods aboba , baoab , spv and bbk and compared the accuracy of configurational sampling for different values of @xmath27 and a range of timesteps .",
    "a brief analysis shows that the use of the harmonic oscillator leads to special cancellations in the bch series of the splitting schemes , making it a poor test subject .",
    "hence , in order to compare the order of accuracy of the different schemes , we first considered an oscillator model in 1d with potential @xmath159 .",
    "this was accomplished by introducing @xmath11 intervals ( ` bins ' ) of equal length , and computing the mean error in the observed probability frequency compared to the exact expected frequency ( obtained by integration of the probability density ) .",
    "if the observed frequency in bin @xmath160 is @xmath161 , and the exact expected frequency is @xmath162 , then the error calculated is @xmath163 in this one - dimensional example , we used @xmath164 bins to cover the interval from @xmath165 to @xmath166 .",
    "the configurational density error is plotted against stepsize in log - log scale .",
    "if @xmath167 then we expect this graph to be a line of slope @xmath168 .",
    "due to the relative simplicity of this model , we were able to perform highly resolved simulations to calculate accurate error estimates for the configurational distribution .",
    "the exact expected value that we compare experimental results against can be computed to arbitrary prescision , and we are able to run as many simulations as needed in order to drive the variance of results to a minimum . the variance in our results , in cases where the stepsize was less than @xmath169 , was consistently below @xmath170 . above a stepsize of @xmath169 some of the methods",
    "were found to be unstable .",
    "the results of our simulations are summarized in figure [ quartic ] .    .",
    "the simulation time was fixed for all runs at @xmath171 , and five runs were averaged to further reduce sampling errors . at left , @xmath172 , at right @xmath173 .",
    "the graphs are entirely in keeping with the theory presented in the article .",
    "[ quartic],title=\"fig:\",width=288 ] .",
    "the simulation time was fixed for all runs at @xmath171 , and five runs were averaged to further reduce sampling errors . at left , @xmath172 , at right @xmath173 .",
    "the graphs are entirely in keeping with the theory presented in the article .",
    "[ quartic],title=\"fig:\",width=288 ]    as we can see , when @xmath27 is small , the methods perform somewhat similarly , at least in the qualitative sense , with all showing a 2nd order error in configurational sampling , and the aboba and spv methods essentially identical . as @xmath27",
    "is increased , the substantial difference between baoab and the other methods becomes apparent . in the limit of large",
    "@xmath27 the spv method effectively annihilates the force which results in poor sampling . in the graph for @xmath172",
    ", we can see that for larger values of the stepsize , the graph steepens ( indicating that the fourth order term is dominant ) ; as the stepsize is decreased the method exhibits a 2nd order asymptotic decay .",
    "with @xmath173 the fourth order behavior is seen for for all indicated data points , although , again , this becomes second order for smaller values of @xmath71 .",
    "note that the limit method eq .  2 ( with the substitution @xmath174 )",
    "gives an essentially identical behavior to the @xmath173 case .",
    "we also give a comparison of the actual computed configurational distributions , at different stepsizes using each method , for @xmath175 in figure [ 1ddist ] .    .",
    "the three curves for each of the four methods show the results for three different stepsizes : @xmath176 ( circles ) , @xmath177 ( crosses ) , @xmath178 ( dashed ) , compared to the dark , solid curve representing the exact distribution .",
    "the graph shows that the generalized gla methods are superior to spv and bbk in the moderate @xmath27 regime .",
    "[ 1ddist],width=576 ]    , for morse ( left ) and lennard - jones ( right ) clusters .",
    "they also show the choice of bins used in calculating the numerical distributions .",
    "[ pic::gofr],title=\"fig:\",width=288 ] , for morse ( left ) and lennard - jones ( right ) clusters .",
    "they also show the choice of bins used in calculating the numerical distributions .",
    "[ pic::gofr],title=\"fig:\",width=288 ]    to examine the performance of the limit method in more detail , we next considered small molecular clusters consisting of seven atoms ( motion restricted to the plane ) , with both morse ( @xmath179 ) and lennard - jones ( @xmath180 ) potentials , given by @xmath181 where we use @xmath182 and @xmath183 .",
    "the overall potentials are hence @xmath184 where @xmath185 is the distance between particles @xmath160 and @xmath186 , @xmath187 is the distance between particle @xmath188 and the origin , and a mild harmonic term is included in the case of the lennard - jones system in order to prevent particles being ejected from the cluster .",
    "the morse potential gives a smoother dynamics compared to lennard - jones ( the morse forces were on average three times smaller than those for lennard - jones ) and allows a more satisfying determination of the error scaling behavior with stepsize . to quantify the error in configurational sampling , we calculated the radial density @xmath189 by binning the instantaneous interatomic distances at each step into 20 compartments and compared to a calculated reference value ( figure [ pic::gofr ] ) .",
    "though not exact , the errors in the reference will be negligible compared with configurational distribution errors at higher stepsizes . for the morse cluster the reference stepsize we used was @xmath190 , whereas for the lennard - jones cluster , we used @xmath191 both with the same integration time that was used in their respective test runs . in both cases",
    "the cluster was initialized with 6 particles placed on a regular hexagon with unit side - length and with the remaining particle in the centre , and initial velocities randomly drawn from the canonical distribution .",
    "considerable computation is required to achieve the level of accuracy required , due to the dominance of sampling error and the complexity of the system compared to the earlier 1d example .",
    "we ran a large number of independent simulations at each stepsize and computed the average radial density plot for both examples , and compared this to the reference result .",
    "our results , presented in figure [ morse ] , are entirely consistent with our analysis and show the second order dependence of the configurational sampling error on @xmath16 ( equivalent to fourth order in @xmath71 ) , as compared to the euler - maruyama s first order behavior .",
    "these results demonstrate a good agreement with our theoretical results , however even using extensive computation the variances in each experiment were still quite high .",
    "if @xmath192 is the density of bin @xmath193 in simulation @xmath194 at stepsize @xmath16 , we calculate the variance as @xmath195 where we used @xmath196 bins for each experiment , @xmath197 for the morse experiment and @xmath198 for the lennard - jones experiment .",
    "the variances for the morse experiment were around @xmath170 while the lennard jones experiment had variances around @xmath199 .",
    "we expect that completing more simulations ( increasing @xmath0 ) would reduce the variance and give smoother results in figure [ morse ] .",
    "nonetheless , in both cases , we observe a significant reduction in the error compared to euler - maruyama .    ) . left : morse potential ; right : lennard - jones . for morse we used a temperature of @xmath200 , a fixed time interval of @xmath201 , with stepsizes ranging from @xmath202 to @xmath203 . for lennard - jones",
    "the temperature was @xmath204 , @xmath205 and stepsizes ranged from @xmath206 to @xmath207 . in order to drive the variance of the results down , a large number of runs were necessary : for the morse simulation the error is computed using the average histogram computed from 200 independent runs , while the lennard - jones simulation used 1000 independent runs . around two orders of magnitude of improvement are observed in the accurate regime , but , perhaps even more important , the baoab limit method is usable at substantially larger stepsizes than euler - maruyama .",
    "[ morse],title=\"fig:\",width=288 ] ) . left : morse potential ; right : lennard - jones .",
    "for morse we used a temperature of @xmath200 , a fixed time interval of @xmath201 , with stepsizes ranging from @xmath202 to @xmath203 . for lennard - jones",
    "the temperature was @xmath204 , @xmath205 and stepsizes ranged from @xmath206 to @xmath207 . in order to drive the variance of the results down , a large number of runs were necessary : for the morse simulation the error is computed using the average histogram computed from 200 independent runs , while the lennard - jones simulation used 1000 independent runs . around two orders of magnitude of improvement are observed in the accurate regime , but , perhaps even more important , the baoab limit method is usable at substantially larger stepsizes than euler - maruyama .",
    "[ morse],title=\"fig:\",width=288 ]    it might be a suggested that the improved accuracy seen in the high @xmath27 regime could potentially come at the price of a slower convergence to equilibrium due to a reduced rate of transition between metastable states , hence overall sampling of the configurational distribution might be impaired in favour of local sampling . to address this point ,",
    "we have plotted in figure [ rateofconv ] the error computed in our lennard - jones simulation as a function of the number of force evaluations ( vertical ) against the friction value @xmath27 used for the simulation ( horizontal ) .",
    "gridpoints in the plot are coloured according to the configurational error , computed using eq .",
    "[ errorformula ] .",
    "the results indicate that the convergence rate for the baoab method is not diminished for large friction coefficient , so it does not appear that we are sacrificing sampling accuracy using this scheme .",
    "note that the performance of aboba is also robust in the limit of large @xmath27 , but the achievable accuracy is reduced as it is only second order , consistent with what we have presented in this article .",
    "our results confirm the theoretical results of sections 3 and 4 , in particular showing the higher order configurational sampling of the baoab method .",
    "the order in its langevin formulation is effectively four in the large @xmath27 limit and large values of @xmath27 do not impair its stability due to the use of exact ornstein - uhlenbeck solves . not only is the order of the method high , the constant multiplying the leading term must be , in the cases looked at here , of modest magnitude , since the errors are relatively small also at the large stepsize stability threshold .",
    "since , in the context of molecular dynamics , baoab is a ` cheap ' and easy to implement scheme using only a single force vector per timestep , we stress that there is no price to pay for its improved accuracy .    in molecular modelling",
    ", there are other errors that play important roles , most importantly errors in the force fields ( or , more fundamentally , the errors due to not modelling quantum mechanics properly ) and sampling errors . obviously these errors may dominate the overall method error and limit the relative benefit to be gained by using one integrator as compared to another , but it is also clear that both of the other types of errors are constantly being reduced through the design of better models and the use of more powerful computers .",
    "more important , one can ask the question : how can a practitioner know which part of the error in a given complicated simulation is due to sampling error and which part due to the truncation errors addressed here ? in our experiments with molecular models , even where there was substantial sampling error still present , we nonetheless found the accuracy to be noticeably higher for the baoab method ; it is likely that this improvement in sampling accuracy would be of direct benefit in many real world simulations .",
    "finally we point out that the baoab scheme and its limit method ( eq .",
    "2 ) was , in each case studied , stable at a larger stepsize than the alternatives , meaning that longer time intervals are made accessible .",
    "this was particularly dramatic in the case of the lennard - jones system .",
    "* acknowledgements . *",
    "the first author acknowledges the support of a jto fellowship from the institute for computational engineering and sciences at the university of texas .",
    "the second author was supported by the centre for numerical algorithms and intelligent software ( funded by epsrc grant ep / g036136/1 and the scottish funding council ) .",
    "a. stuart , h. owhadi , and especially g. stoltz made helpful suggestions regarding the presentation of the results .",
    "we further acknowledge the comments received from a. abdulle and m. tretyakov which have improved the article and its relation to other works .",
    "computations were performed on the university of edinburgh s ecdf compute facility .",
    "99    brnger , a , brooks  iii , c , & karplus , m. ( 1982 ) stochastic boundary- conditions for molecular - dynamics simulations of st2 water .",
    "letters _ * 105 * : 495500 .",
    "talay , d.(1995 ) simulation and numerical analysis of stochastic differential systems : a review . in _",
    "probabilistic methods in applied physics _ , p. kree and w. wedig ( eds . ) , vol .",
    "451 of lecture notes in physics , pp .",
    "springer - verlag .",
    "mishra , b.  and schlick , s.(1996 ) the notion of error in langevin dynamics .",
    "i. linear analysis _ j. chem .",
    "* 105*:299318 .",
    "milstein , g.   and tretyakov , m. ( 2004 ) _ stochastic numerics for mathematical physics _",
    ", springer .",
    "burrage , k.  and lythe , g.(2009 ) accurate stationary densities with partitioned numerical methods for stochastic differential equations .",
    "_ siam j. numer .",
    "* 47*:16011618 .",
    "lelivre , t. , rousset , m. , & stoltz , g. ( 2010 ) _ free energy computations . a mathematical perspective .",
    "_ imperial college press .",
    "liu , j. ( 2001 ) _ monte carlo strategies in scientific computing .",
    "_ springer series in statistics .",
    "larini , l. mannella r. , & leporini , d. ( 2007 ) langevin stabilization of molecular - dynamics simulations of polymers by means of quasisymplectic algorithms .",
    "_ j. chem .",
    "phys . _ * 126*:104101 .",
    "skeel , r and izaguirre , j. ( 2002 ) an impulse integrator for langevin dynamics _ mol .",
    "phys . _ * 100*:38853891",
    ".    milstein , g.   and tretyakov , m. ( 2003 ) quasi - symplectic methods for langevin - type equations _",
    "i m a j. num .",
    "_ * 23 * : 593626 .",
    "shardlow , t. , ( 2006 ) modified equations for stochastic differential equations .",
    "_ bit _ * 46 * , 111125 melchionna , s.(2007 ) design of quasi - symplectic propagators for langevin dynamics .",
    "_ j. chem .",
    "_ * 127*:044108 .",
    "bou - rabee , n. and owhadi , h. ( 2010 ) long - run accuracy of variational integrators in the stochastic context .",
    "_ siam j. num .",
    "* 48 * : 278297 .",
    "davidchack , r.l.(2010 ) discretization errors in molecular dynamics simulations with deterministic and stochastic thermostats .",
    "_ j. comput .",
    "phys . _ * 229 * : 9323  9346 .",
    "zygalakis , k. ( 2011 ) on the existence and applications of modified equations for stochastic differential equations .",
    "_ siam j. sci .",
    "* 33*:102130 .",
    "hairer , e. lubich , c. & wanner , g. ( 2006 ) _ geometric numerical integration_. springer ( new york ) , second edition .",
    "leimkuhler , b. and reich , s. ( 2005 ) _ simulating hamiltonian dynamics _ , cambridge university press .",
    "frenkel , d. and smit , b. ( 2001 ) _ understanding molecular simulation _",
    ", 2nd edition , academic press .",
    "hrmander , l. ( 1967 ) hypoelliptic second order differential equations . _ acta math . _ * 119 * : 147171 .",
    "mattingly , j.c .",
    "stuart , a.m. & higham , d.j.(2002 ) ergodicity for sdes and approximations : locally lipschitz vector fields and degenerate noise .",
    "appls . _ * 101*:185232 .",
    "villani , c. ( 2009 ) hypocoercivity .",
    "soc . _ * 202 *    pavliotis , g. and hairer , m. ( 2008 ) from ballistic to diffusive behavior in periodic potentials .",
    "_ j. stat .",
    "phys . _ * 131 * 175202    joubaud , r. and stoltz , g. ( 2012 ) nonequilibrium shear viscosity computations with langevin dynamics .",
    "_ siam mms _ * 10 * : 191216    sivak , d. chodera , j. and crooks , g.    talay , d. ( 2002 ) stochastic hamiltonian dissipative systems : exponential convergence to the invariant measure , and discretization by the implicit euler scheme .",
    "_ markov processes and related fields _ * 8*(2 ) 163198 .",
    "mattingly , j.c .",
    "stuart , a.m. & tretyakov , m. ( 2010 ) convergence of numerical time - averaging and stationary measures via poisson equations .",
    "_ siam j. num .",
    "* 48 * : 552577 .",
    "debussche , a. and faou , e.",
    "the langevin dynamics methods used for the numerical experiments in this paper are given here .",
    "@xmath208 is an @xmath209vector of i.i.d .",
    "normal random numbers , with mean @xmath152 and variance @xmath210 .",
    "the diagonal mass matrix is denoted @xmath11 , and we assume a timestep @xmath71 is provided . given the parameter @xmath27 , we define useful constants @xmath211 and @xmath212"
  ],
  "abstract_text": [
    "<S> in this article , we focus on the sampling of the configurational gibbs - boltzmann distribution , that is , the calculation of averages of functions of the position coordinates of a molecular @xmath0-body system modelled at constant temperature . </S>",
    "<S> we show how a formal series expansion of the invariant measure of a langevin dynamics numerical method can be obtained in a straightforward way using the baker - campbell - hausdorff lemma . </S>",
    "<S> we then compare langevin dynamics integrators in terms of their invariant distributions and demonstrate a superconvergence property ( 4th order accuracy where only 2nd order would be expected ) of one method in the high friction limit ; this method , moreover , can be reduced to a simple modification of the euler - maruyama method for brownian dynamics involving a non - markovian ( coloured noise ) random process . in the brownian dynamics case </S>",
    "<S> , 2nd order accuracy of the invariant density is achieved . </S>",
    "<S> all methods considered are efficient for molecular applications ( requiring one force evaluation per timestep ) and of a simple form . </S>",
    "<S> in fully resolved ( long run ) molecular dynamics simulations , for our favoured method , we observe up to two orders of magnitude improvement in configurational sampling accuracy for given stepsize with no evident reduction in the size of the largest usable timestep compared to common alternative methods .    </S>",
    "<S> * keywords : * molecular dynamics ; sampling ; langevin dynamics ; brownian dynamics ; stochastic dynamics . </S>"
  ]
}