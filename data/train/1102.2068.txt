{
  "article_text": [
    "extracting information about the magnetic field vector from spectro - polarimetric observations is not devoid of difficulties .",
    "the main one is that , practically always , one has to go through a modeling phase .",
    "this modeling typically consists of setting an atmospheric model that depends on some parameters which one wants to infer .",
    "such a procedure , usually known as spectro - polarimetric inversion , has allowed to extract extremely valuable information about the behavior of the magnetic field in the solar photosphere and chromosphere ( see e.g. , * ? ? ? * and references therein ) .",
    "it is hard to summarize in a few lines the history of spectro - polarimetric inversions from the first steps back in the 1970s .",
    "the initially proposed models were of low complexity because the quality of the observations and the computing power did not allow the use of more elaborate models ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "although the assumptions on which these models are based may not be exactly fulfilled in the solar atmosphere , their simplicity allowed to put the cornerstone for quantitative spectropolarimetry .",
    "in fact , these models are still in use for interpreting high - quality observations from the most advanced instruments @xcite .",
    "later on , inversion codes based on the concept of response functions @xcite have facilitated the inversion of high - quality stokes profiles making it possible to infer vertical stratifications of the magnetic properties of the atmosphere @xcite .",
    "after the enormous success of standard inversion methods based on least - squares optimization , it is time to study in depth the inversion process itself and introduce more powerful techniques .",
    "this is what has been done recently by @xcite , who treated the inversion process as a bayesian probabilistic inference problem .",
    "these techniques , which allow to fully exploit the information encoded in the stokes profiles once a model has been proposed to explain them , have been used recently by @xcite to infer that fields in the quietest regions of the solar internetwork appear to be quasi - isotropically distributed , reinforcing the previous results of @xcite .",
    "we consider that the bayesian approach is the best choice , specially in those cases in which the spectro - polarimetric signal is at the noise level or the wavelength covering is very sparse ( like in filter - polarimeters ) .",
    "additionally , it gives the opportunity to quantitatively compare different models and use different models as a committee to gain insight on a common physical parameter @xcite .",
    "the approach followed by @xcite based on a markov chain montecarlo sampler is completely general so that it can cope with very complex radiative transfer forward problems .",
    "the main drawback is that it can become costly in terms of computational time , although not prohibitive , as already shown by @xcite .",
    "obviously , bayesian inference can not be compared to standard inversion methods just by the computing cost , because the amount of information obtained is much richer . in order to motivate the application of bayesian inference , we consider in this paper the assumption of weak field @xcite for the inference of magnetic fields from the observation of stokes profiles .",
    "this is one of the most straightforward approximations one can consider to relate the stokes profiles and the magnetic field vector . in spite of its simplicity , its range of applicability is very broad and it is systematically applied in different fields , from solar to stellar physics , as shown in the next section . as we show , the simplicity of the model allows us to obtain analytical expression for some of the posterior distributions of the model parameters .",
    "we consider that the weak - field approximation is of practical application while simultaneously being simple enough to demonstrate the power of bayesian inference and show their fundamental points .",
    "section 2 describes the model .",
    "section 3 shows the simple non - hierarchical approach and also sets the notation used throughout the paper .",
    "section 4 presents the robust hierarchical model for the case in which the noise standard deviation is known and when it is inferred from the data .",
    "finally , the method is demonstrated with some examples in section 5 .",
    "when the splitting produced in a given spectral line via the zeeman effect by the presence of a deterministic magnetic field ( @xmath0 , with @xmath1 the effective land factor ) is smaller than the line broadening ( @xmath2 ) , the line is said to be well modeled in the weak - field regime @xcite .",
    "writing the expressions for @xmath3 and @xmath2 ( e.g. , * ? ? ?",
    "* ) , a line is in the weak - field approximation when the magnetic field strength fulfills : @xmath4 where @xmath5 and @xmath6 are the electron mass and charge , respectively , @xmath7 is the speed of light , @xmath8 is the boltzmann constant , @xmath9 is the mass of the species , @xmath10 is the central wavelength of the spectral line under consideration and @xmath11 is the microturbulent velocity . for an iron line at @xmath12  , using @xmath13 km s@xmath14 and @xmath15 k , we end up with : @xmath16 in principle , this is more than enough to deal with photospheric magnetic fields outside from active regions in the solar atmosphere observed with magnetically sensitive lines in the optical ( with @xmath17 ) or even active regions observed in lines with a weak magnetic sensitivity . since the thermal width is enhanced in the chromosphere due to the increased temperature and the field strength is known to be smaller , the weak - field approximation is especially interesting for inferring magnetic fields at chromospheric heights .    in this approximation ,",
    "a straightforward relation between the magnetic properties of the plasma and the emergent stokes parameters exist . in present day observations of the weakly magnetized regions of the solar atmosphere we can not state that we are resolving all magnetic structures . in case that our resolution element is not filled with an unidirectional magnetic field vector",
    ", we can mimic the loss of signal by assuming that the observed signal in the pixel is obtained as the average of a magnetic component with a relative weight @xmath18 and a non - magnetic component with the weight @xmath19 .",
    "the following equations hold for stokes @xmath20 at first order in the field strength and for stokes @xmath21 , @xmath22 at second order in the field strength ( e.g. , * ? ? ?",
    "* ) : @xmath23 as functions of @xmath24 , the projection of the magnetic field vector along the line - of - sight ( los ) , @xmath25 , the component of the vector perpendicular to the los , @xmath26 , the field azimuth and @xmath27 , the wavelength variation of the intensity across the spectral line .",
    "the proportionality constants @xmath28 and @xmath29 have the values : @xmath30 with the wavelength @xmath31 in   and the components of the magnetic field measured in g. the factor @xmath32 is the effective land factor and @xmath33 is the equivalent for linear polarization ( e.g. , * ? ? ?",
    "both factors measure the sensitivity of the spectral line to the presence of a magnetic field .",
    "the previous expressions are only valid when @xmath24 , @xmath25 , the field azimuth @xmath26 , the line - of - sight velocity , the doppler width , and any broadening mechanism are constant with height in the line formation region . additionally , the expression for stokes @xmath21 and @xmath22 can only be applied for non - saturated lines .",
    "since the field azimuth is constant with height in the atmosphere , it is possible to define the total linear polarization @xmath34 which can be written as : @xmath35 where the absolute value is a consequence of the definition of @xmath36 . from this point",
    ", we assume that @xmath37 , @xmath38 and @xmath39 , the observed wavelength variation of the linear and circular polarization profiles , respectively , can be correctly modeled with the aid of eqs .",
    "( [ eq : circ_lin_pol ] ) .    in spite of and",
    "thanks to its simplicity , the weak - field approximation is broadly applied for the inference of solar and stellar magnetic fields from the observation of stokes profiles .",
    "a limited selection includes the detection and diagnostic of magnetic fields in : central stars of planetary nebulae @xcite , white dwarfs @xcite pulsating stars @xcite , hot subdwarfs @xcite , ap and bp stars @xcite and chemically peculiar stars @xcite .",
    "the least - squares deconvolution ( lsd ) technique that is widely used for the detection of magnetic fields in solar - type stars @xcite is also fundamentally based on the weak - field approximation .",
    "many synoptic magnetographs like those of big bear @xcite are calibrated using this formalism or equivalent .",
    "the circular polarization observed in chromospheric lines like the 10830   multiplet of is very well modeled under the weak - field approximation @xcite .",
    "it is even used to produce modern vector magnetograms like those obtained with the imax instrument @xcite onboard the sunrise balloon @xcite .",
    "the weak - field approximation is a model for the interpretation of observed stokes profiles that depends on the four - vector of parameters @xmath40 . under the bayesian approach",
    "( see * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) , all knowledge gained about the parameters when some dataset @xmath41 is presented to the model is encoded on the posterior probability distribution function @xmath42 . using the bayes theorem ,",
    "this posterior distribution can be written as : @xmath43 where @xmath44 is the likelihood distribution that takes into account the influence of data on our knowledge of the model parameters and @xmath45 is the prior distribution that accounts for all information about the parameters known in advance .",
    "the term @xmath46 is the evidence or marginal posterior ( the area below the multidimensional posterior ) that , for parameter inference , is just an unimportant multiplicative constant that we neglect in the following .",
    "we analyze now the analytical form of all quantities present in eq .",
    "( [ eq : bayes_theorem ] ) .",
    "when stokes profiles are observed with a spectro - polarimeter or a filter - polarimeter we measure the circular and linear polarization at @xmath47 discrete wavelength points .",
    "consequently , the observables are @xmath48 , @xmath49 , where @xmath50 , @xmath51 and @xmath52 represent the value of the circular and linear polarization at wavelength @xmath53 , respectively . assuming that the observations are corrupted with uncorrelated gaussian noise with zero mean and variance @xmath54 , the likelihood function is given by the following expression : @xmath55 \\right\\}\\end{aligned}\\ ] ] where we have assumed that the total likelihood is given by the product of the likelihood for each wavelength point and stokes parameter .",
    "note that we have assumed the same noise variance for stokes @xmath21 , @xmath22 and @xmath20 .",
    "if this is not the case , the likelihood can be modified accordingly and the following calculations are modified accordingly .",
    "note also that we have assumed that the uncertainty in the first and second intensity derivatives are negligible .",
    "if this is not the case , its effect can be introduced by substituting @xmath54 by the variance of the terms inside the parenthesis , which might also include correlations between @xmath56 and @xmath57 or @xmath58 .",
    "it is important to point out that the likelihood is only a gaussian distribution if we deal with the observables @xmath37 and @xmath38 , and not for @xmath59 . in this case , it would follow a rayleigh distribution . due to the simplicity of the weak - field model , the exponent of the likelihood can be easily factorized so that quantities related to observables are isolated from the model parameters .",
    "after some algebra , we end up with : @xmath60 , \\label{eq : likelihood}\\ ] ] where the quantities @xmath61 are the only ones that depend on the observations and are given by : @xmath62 more intuition can be gained if we complete the squares in the likelihood function , so that : @xmath63 \\right\\ } \\nonumber \\\\ & \\times & \\exp \\left\\ { -\\left[a_1 - \\frac{a_4 ^ 2}{a_2 } - \\frac{(a_5 { \\cos 2 \\chi}+ a_6 { \\sin 2 \\chi})^2}{a_3}\\right ] \\right\\ } , \\label{eq : likelihood_completesquare}\\end{aligned}\\ ] ]      one of the advantages of the bayesian approach is that all a - priori information about model parameters is made explicit in the formalism .",
    "this is made through the probability distribution @xmath45 . for simplicity , we assume that the prior distribution factorizes , so that : @xmath64 correlations between model parameters will then be obtained from the observed data through the likelihood .",
    "we do not have any preference for any specific value or the filling factor and the field azimuth , so we set uniform flat priors in the interval @xmath65 $ ] and @xmath66 $ ] , respectively . as a consequence , @xmath67 and @xmath68 , where @xmath69 is the standard rectangular function . if one wants to carry out the inference assuming @xmath70 , it is enough to set @xmath71 and the following formulae are still valid .",
    "concerning the components of the magnetic field , it is interesting to use priors that give low preference to very large values .",
    "we know that values above a few thousand g are not realistic . instead of using",
    "a truncated flat prior , for computational purposes and inspired on physical considerations , we use different functional forms trying to be as non - informative as possible while maintaining physical constraints .",
    "for @xmath24 we propose a gaussian distribution with a large variance @xmath72 , while for @xmath25 we propose a rayleigh distribution with large variance @xmath73 , a consequence of the assumption of gaussianity for the two components of the magnetic field perpendicular to the line - of - sight ( los ) .",
    "if @xmath74 , we end up with an isotropic distribution for the magnetic field vector .",
    "the two parameters @xmath75 and @xmath76 are known as hyperparameters because they parametrize the priors .",
    "the complete prior distribution is given by : @xmath77 \\left [ \\sigma_\\perp^{-2 } { b_\\perp}\\exp \\left(-\\frac{{b_\\perp}^2}{2\\sigma_\\perp^2}\\right ) \\right ] .",
    "\\label{eq : prior}\\ ] ] we note that any other functional form for the prior can be used if they are based on sensible physical intuition , although some of the following integrals may require more numerical work for their evaluation . as a rule ,",
    "if data contains sufficient information about the model parameters , the results should be almost insensitive to the election of the prior as long as the prior gives non - negligible probability to the regions of high likelihood .",
    "for this reason , it is fundamental to compare the posterior with the chosen prior to know if data has added information to the inference problem . if they are very similar , the results depend on the specific election of the prior and should , in principle , be discarded .      the full posterior distribution results from the application of eq .",
    "( [ eq : bayes_theorem ] ) : @xmath78 { b_\\perp}^2 \\right ] \\right\\}. \\label{eq : posterior}\\end{aligned}\\ ] ] since in the non - hierarchical model that we are dealing with in this section the normalizing constants are just a scale , they can be dropped without effect .",
    "they will be however important in the following section when marginalizing out the prior parameters .",
    "the following rewriting is also convenient for evaluating some of the marginal posterior for the components of the magnetic field vector : @xmath79,\\ ] ] where @xmath80 the joint posterior distribution contains all information about the parameters of the weak - field approximation for a set of observed stokes profiles . different versions of the posterior can be built if different priors are assigned .",
    "the maximum a - posteriori ( map ) solution to the problem ( the one producing the largest posterior inside the prior volume ) can be obtained by finding the value of @xmath81 that maximizes eq . ( [ eq : posterior ] ) , which is equivalent to minimizing @xmath82 . the map solution is , therefore , the one minimizing : @xmath83 { b_\\perp}^2 + \\mathrm{cte}.\\end{aligned}\\ ] ] the solution can be found by solving the following non - linear system of equations : @xmath84 & = & 0 .",
    "\\nonumber \\\\ 4f{b_\\perp}^2 a_5 { \\sin 2 \\chi}- 4f{b_\\perp}^2 a_6 { \\cos 2 \\chi}&=&0 .",
    "\\label{eq : log_posterior}\\end{aligned}\\ ] ] the last equation is the standard estimation of the field azimuth which , provided that @xmath85 and @xmath86 , results in : @xmath87 which can then be understood as the maximum - a - posteriori estimation of the field azimuth . additionally , particularizing to the case of a longitudinal magnetograph ( i.e. , if we do not measure linear polarization ) , we find the obvious solution @xmath88 , that has been already found by @xcite .",
    "note also that the standard maximum - likelihood solution ( also known as least - squares solution ) is obtained following the same scheme after setting @xmath89 and @xmath90 and dropping the term @xmath91 from eq .",
    "( [ eq : log_posterior ] ) .      to fully take into account the presence of degeneracies among the model parameters in the bayesian approach",
    ", we have to compute the marginal posterior distributions for every parameters individually .",
    "the marginal posterior is obtained by integrating out all parameters but the one of interest .",
    "for instance , the posterior for @xmath24 is computed as : @xmath92 this integration will introduce into the probability distribution of a given parameter all possible values of the rest of model parameters weigthed by their associated probabilities .",
    "the advantage of the weak - field model is that some of these integrals can be obtained analytically in closed form . due to the complexity of the integrals",
    ", we have been unable to find closed analytical expressions for the one - dimensional marginal distributions . however , we present in app . [",
    "sec : appendix_posteriors ] the expressions for the 2-dimensional marginal posteriori @xmath93 and for the 3-dimensional marginal posteriors @xmath94 , @xmath95 , @xmath96 and @xmath97 .",
    "the shape of the marginal posterior is fundamental to decide whether a parameter is constrained or not by the observations .",
    "although the solution to the problem would be to give the full marginal posteriors , it is sometimes interesting for presentation purposes to give a summary of the distribution . if there is a clear peak with tails falling to zero ( like a gaussian , but can often be asymmetric ) , the value of the parameter at the peak ( the most probable ) is the so - called marginal maximum - a - posteriori ( mmap ) solution or mode .",
    "a confidence interval can be put by just integrating the posterior until a given fraction of the total area is obtained .",
    "another possibility to summarize the distribution is to give the median value ( where the cumulative probability distribution equals @xmath98 ) , together with a confidence region .",
    "finally , it is possible to compute moments of the quantity @xmath99 using the standard definition : @xmath100 and the confidence interval is obtained like in the mmap .",
    "since all the information about the model parameters is contained in the posterior probability distribution function , information about any derived quantity can be computed from it using the machinery presented in app .",
    "[ sec : appendix ] .",
    "one of the quantities of interest is the magnetic flux density , defined as @xmath101 . following the change of variables formulae ,",
    "we can write the probability distribution function of the magnetic flux density as : @xmath102 where the joint distribution @xmath103 is obtained by marginalizing @xmath25 and @xmath26 from the full posterior . since @xmath104 , @xmath105 has to be fulfilled , which produces the separation of the integral in two different cases depending on the sign of @xmath106 .",
    "the integration on @xmath24 has to be carried out numerically since it is not possible to obtain a closed expression .",
    "the previous approach is unnecessarily complex for such a simple quantity like the magnetic flux density . in this special case",
    ", it can be computed following a different path , noting that the posterior for @xmath106 can also be obtained directly because : @xmath107 and neither @xmath37 nor @xmath38 do depend on @xmath106 .",
    "in such a case , it is easy to write a posterior for this variable : @xmath108 \\right\\}. \\label{eq : posterior_fparallel_nonhierarchical}\\ ] ] the only remaining ingredient is the prior distribution @xmath109 . since",
    "@xmath110 and the priors for @xmath18 and @xmath24 have been discussed in sec .",
    "[ sec : priors ] , the prior for @xmath106 can be obtained following app .",
    "[ sec : appendix ] , thus resulting in : @xmath111 where @xmath112 is the first exponential integral ( e.g. , * ? ? ?",
    "when data is sufficiently informative so that the prior distribution becomes unimportant , the posterior for the magnetic flux density is gaussian with mean and variance given by @xcite : @xmath113      a similar approach can be followed to compute the marginal posterior for the field inclination from the joint distribution of @xmath24 and @xmath25 . to this end , we apply again the rules of app .",
    "[ sec : appendix ] to the change of variables @xmath114 and obtain : @xmath115 where the joint distribution is computed by marginalizing @xmath18 and @xmath26 from the posterior and the limits of integration have been adapted to fulfill @xmath116 .    using the same procedure ,",
    "the prior distribution for the inclination can be obtained by plugging eq .",
    "( [ eq : prior ] ) into eq . ( [ eq : posterior_inclination ] ) .",
    "the results is , after some algebra , that @xmath117 , an obvious result because the prior we are using assumes that the field is isotropically distributed .",
    "exactly the same procedure can be applied to obtain the posterior for the magnetic field strength , @xmath118 , and to the magnetic field energy , @xmath119 , obtaining : @xmath120 where the joint probability distribution is computed by marginalizing @xmath18 and @xmath26 from the posterior .",
    "in principle , the values of @xmath75 and @xmath76 in the previous formalism are understood to be fixed and given a - priori .",
    "one of the disadvantages of this approach is that , if there is not sufficient information about the model parameters encoded in the observations , the results will surely be sensitive to the election of these numbers ( see  [ sec : results ] for an example ) .",
    "however , we can take advantage of the fact that , in the bayesian formalism , every unknown can be considered a random variable .",
    "we can put an appropriate prior on them and extend the formalism in a hierarchical way and let data determine their values .",
    "since the priors are put over hyperparameters ( parameters of the prior distributions ) , they are known as hyperpriors . in principle",
    ", nothing avoids us to make hyperpriors depend on additional hyperparameters over which appropriate priors are assigned and continue the hierarchical structure ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* for more details on hierarchical models ) .",
    "the immediate effect of the hierarchical approach is that results are much less dependent on the specific choice of hyperparameters and we make the problem essentially free of parameters . in some sense , this happens because we allow priors adapt to data .",
    "it can be demonstrated that some standard regularization schemes applied to least - squares techniques are indeed particular cases of hierarchical models",
    ".      using trivial probability calculus , the full posterior can be expressed by marginalizing out the hyperparameters , thus : @xmath121 where we have used the fact that the likelihood does not depend on the parameters @xmath75 and @xmath76 .",
    "note that this marginalization takes into account _ all _ possible values of the hyperparameters weighted by their probability .",
    "the term @xmath122 is the prior defined in eq .",
    "( [ eq : prior ] ) and the new distribution @xmath123 gives prior information about the hyperparameters .",
    "since they behave as scale parameters ( they can take values spanning several decades ) , a good option is to use a uniform prior on logarithmic scale , so that : @xmath124 this prior , also known as jeffreys prior @xcite , has the remarkable property of being the only non - informative prior for scale - invariant quantities .",
    "this complicates the analytical solution of the problem requiring more purely numerical integrations but also introduces additional stabilization .",
    "although the jeffreys prior is improper ( its integral is not finite ) , the integral of the priors over @xmath75 and @xmath76 are finite but also improper .",
    "the integral of eq .",
    "( [ eq : prior_marginal ] ) can be finally carried out for all possible values of @xmath75 and @xmath76 to give : @xmath125 where the likelihood @xmath126 is given by eq .",
    "( [ eq : likelihood ] ) .",
    "the marginalization process demonstrates that the jeffreys prior is a natural election for @xmath24 and @xmath25 . in other words ,",
    "we could have started our calculation by selecting a jeffreys prior in eq .",
    "( [ eq : prior ] ) without considering the hierarchical approach .    in case",
    "no information is present in the data ( flat likelihood ) , the prior for @xmath106 can be obtained by substitution of the previous expression in eq .",
    "( [ eq : posterior_fparallel ] ) : @xmath127 so the posterior is given by eq .",
    "( [ eq : posterior_fparallel_nonhierarchical ] ) .",
    "it is also possible to introduce new free hyperparameters @xmath128 and @xmath129 that define a lower and upper estimation of the width of the prior distributions , respectively .",
    "although they constitute a new set of free parameters , the hierarchical character offers the advantage that results are much less sensitive to their exact values .",
    "because we do not expect magnetic fields in the solar atmosphere larger than @xmath130 g or we do not expect to detect fields below @xmath131 g , it is sensible to choose @xmath132 g and @xmath133 g. these values can be adapted for specific cases ( inverting stokes profiles observed in active regions or the quiet sun ) but the results are really insensitive to the specific values , as shown in  [ sec : results ] .",
    "the following prior is the resulting one after marginalizing out @xmath75 and @xmath76 : @xmath134   \\nonumber \\\\ & \\times & \\left [   \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{max}^2 } \\right ) - \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{min}^2 } \\right)\\right ] , \\label{eq : prior_hierarchical_known_noise}\\end{aligned}\\ ] ] which converges to eq .",
    "( [ eq : posterior_hierarchical1 ] ) when @xmath135 and @xmath136 .",
    "the function @xmath137 is the error function ( e.g. , * ? ? ?",
    "this yields the following general expression for the posterior that we use when the noise variance is known : @xmath138 \\nonumber \\\\ &",
    "\\times & \\frac{1}{{b_\\parallel}{b_\\perp } } \\left [   \\mathrm{erf } \\left ( \\frac{{b_\\parallel}}{\\sqrt{2}\\sigma_\\mathrm{min } } \\right ) - \\mathrm{erf } \\left ( \\frac{{b_\\parallel}}{\\sqrt{2}\\sigma_\\mathrm{max } } \\right)\\right ]   \\left [   \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{max}^2 } \\right ) - \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{min}^2 } \\right)\\right ] .",
    "\\label{eq : posterior_hierarchical_known_noise}\\end{aligned}\\ ] ] again , we have been unable to obtain the 1-dimensional marginal distributions , but app . [ sec : appendix_posteriors ] presents the 3-dimensional marginal posteriors @xmath94 and @xmath95 . in this generalized case , under non - informative data , the prior for @xmath106 results in : @xmath139 + \\frac{1}{\\sqrt{2 \\pi } \\sigma_\\mathrm{min } } e_1 \\left(\\frac{f_\\parallel^2}{2\\sigma_\\mathrm{min}^2}\\right)- \\frac{1}{\\sqrt{2 \\pi } \\sigma_\\mathrm{max } } e_1 \\left(\\frac{f_\\parallel^2}{2\\sigma_\\mathrm{max}^2 } \\right ) \\label{eq : prior_fparallel_knownnoise}\\ ] ] which reduces to eq .",
    "( [ eq : prior_fparallel_hierarchical1 ] ) when @xmath135 and @xmath136 . substitution in eq .",
    "( [ eq : posterior_fparallel_nonhierarchical ] ) gives the posterior for @xmath106 .",
    "another step forward in the hierarchical model can be given if the noise standard deviation is not known with precision .",
    "sometimes the peculiarities of the observation induce that estimating the observational uncertainty is not an easy task .",
    "it is typically estimated assuming ergodicity and calculating the variance of the signal on a continuum window , where the polarimetric signal is assumed to be zero .",
    "this might be flawed if , for instance , the polarimetric signal is very broad and the assumption of zero signal in the continuum window is not correct . likewise , when there is a large velocity field producing a large doppler shift , neighboring spectral lines can enter into the continuum window and give wrong estimation of the observational uncertainty .",
    "this is especially relevant when when observing with filter - polarimeters , where the information of the continuum is usually contained in one or two spectral samples . in such a case , it is possible to consider @xmath140 as a random variable which is marginalized at the end .",
    "although we assume that the variance of the observational uncertainty is unknown , we postulate that the noise follows a gaussian distribution .",
    "this distribution , in the absence of detailed information about the correct distribution apart from the finite variance , is the one suggested by the principle of maximum entropy . therefore : @xmath141 using a jeffreys prior over @xmath140 , so that @xmath142 , integrating over the full domain in @xmath140 , @xmath75 and @xmath76 , we obtain the following posterior : @xmath143 where @xmath144 the @xmath145 are obtained from the @xmath61 defined in eq .",
    "( [ eq : a_values ] ) but dropping the terms @xmath146 and @xmath47 is the number of wavelength points in the profiles .",
    "if we limit the integration to the range @xmath147 $ ] because we know that noise can not be too small or too large , but keep the integration on the full space for @xmath75 and @xmath76 we end up with the following posterior : @xmath148 , \\label{eq : posterior_hierarchical_unknown_noise2}\\end{aligned}\\ ] ] which reduces to eq .",
    "( [ eq : posterior_hierarchical_unknown_noise ] ) when @xmath149 and @xmath150 due to the properties of the incomplete gamma function @xmath151 ( e.g. , * ? ? ? * ) .",
    "it is also possible to limit the integration volume in @xmath140 , @xmath75 and @xmath76 , arriving at the most general hierarchical model we consider that can be applied when the noise variance is unknown : @xmath152 \\nonumber \\\\ &",
    "\\times&\\frac{1}{{b_\\parallel}{b_\\perp } } \\left [   \\mathrm{erf } \\left ( \\frac{{b_\\parallel}}{\\sqrt{2}\\sigma_\\mathrm{min } } \\right ) - \\mathrm{erf } \\left ( \\frac{{b_\\parallel}}{\\sqrt{2}\\sigma_\\mathrm{max } } \\right)\\right ]   \\left [   \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{max}^2 } \\right ) - \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{min}^2 } \\right)\\right ] .",
    "\\label{eq : posterior_hierarchical_unknown_noise_final}\\end{aligned}\\ ] ]    concerning the posterior for the magnetic flux density , marginalizing eq .",
    "( [ eq : posterior_fparallel_nonhierarchical ] ) over @xmath140 with the jeffreys prior , we find : @xmath153,\\ ] ] where @xmath154 the prior distribution @xmath109 can be that of eq .",
    "( [ eq : prior_fparallel_hierarchical1 ] ) or the most general one of eq .",
    "( [ eq : prior_fparallel_knownnoise ] ) .",
    "in order to illustrate the behavior of the non - hierarchical and hierarchical models that we have developed , let us consider extracting information under the weak - field approximation from the wavelength variation of a selected stokes profile observed with imax @xcite onboard sunrise @xcite in a quiet region of the solar atmosphere .",
    "the observed profile is shown in fig .",
    "[ fig : imax_profiles ] .",
    "the reason for choosing this instrument is to show the power of bayesian methods to deal with cases in which there is reduced information in the observables .",
    "the number of sampled points is just 5 which makes the typical shape of the polarization profiles hardly indistinguishable . in order to apply the previous formulation we need to have an estimation of the first and second derivative of the stokes @xmath155 profile .",
    "the poor spectral sampling makes this operation delicate .",
    "however , we have decided to apply a numerical derivative based on a standard 3-point lagrange interpolation of the profile .",
    "this could have been improved by , for instance , fitting the intensity profile to a gaussian and using this fitted profile to carry out the derivative .",
    "we have verified that differences are negligible with both approaches .",
    "figure [ fig : joint_imax ] shows the joint posterior marginal distributions @xmath156 in the first column , @xmath103 in the second one and @xmath157 in the third .",
    "these marginal distributions help us distinguish which parameters are degenerate and help us understand the behavior of the full posterior . for comparison , the first two rows ( labeled _ a _ ) present cases obtained by marginalization of the non - hierarchical posterior of eq .",
    "( [ eq : posterior ] ) .",
    "specifically , these panels were obtained by numerical integration of eq .",
    "( [ eq : marginal_3d_nonhier ] ) . the middle two rows ( labeled _ b _ )",
    "are obtained marginalizing the hierarchical posterior of eq .",
    "( [ eq : posterior_hierarchical_known_noise ] ) assuming gaussian noise with a standard deviation of @xmath158 in units of the continuum intensity .",
    "specifically , they are computed by numerical integration of eq .",
    "( [ eq : posterior_hierarchical_known_noise_marginalchi ] ) .",
    "finally , the last two rows ( labeled _ c _ ) are obtained applying a numerical quadrature to the full hierarchical posterior of eq .",
    "( [ eq : posterior_hierarchical_unknown_noise_final ] ) that marginalizes the noise .",
    "two typical values of the hyperparameters are considered in each one of the posteriors .",
    "the values of the relevant parameters are indicated in each plot and in the caption . as a general rule",
    ", the non - hierarchical model has a stronger sensitivity to the prior hyperparameters than the hierarchical models ( e.g. , * ? ? ?",
    "* ) . in our case ,",
    "the hierarchical models are almost insensitive to the exact values of the hyperparameters , even though we have used two extreme values .",
    "the joint marginal posteriors clearly indicate the presence of strong degeneracies between the @xmath18 and @xmath24 and @xmath25 , as widely known . however , there is still some information available in the observations about each parameter individually , at least sufficient to discard regions of the space of parameters .",
    "although part of this information is encoded in the priors , it is transparently introduced and can be controlled at will .",
    "furthermore , this information is based on very general considerations about the behavior of the magnetic field ( like typical maximum values present in the solar atmosphere ) .    when extracting information for a given parameter , it is necessary to marginalize out the rest of parameters .",
    "this marginalization carries out error propagation correctly and degeneracies are evidenced as long tails in the marginal posteriors .",
    "figure [ fig : marginal_imax ] presents these posteriors .",
    "the first column corresponds to the non - hierarchical model , while the second and third columns are the results of the two hierarchical models .",
    "they were obtained numerically by integrating the distributions shown in fig .",
    "[ fig : joint_imax ] .",
    "the first row is the marginal posterior for @xmath18 , the second for @xmath24 , the third for @xmath25 and the fourth for @xmath106 .",
    "the dashed lines are the priors considered for each parameter . in the non - hierarchical model",
    ", the mmap value for @xmath24 seems to be relatively robust to the election of the prior , while it has a larger dependence on the prior for @xmath25 and @xmath18 .",
    "according to the shapes of the marginal posterior distributions , it is possible to give the most probable value together with asymmetric error bars which contain 68% or 95% of the total mass of the distribution . in this particular example , the lower limit of @xmath24 will be much larger in magnitude than the upper limit .",
    "the reason is that the sign of @xmath24 controls the sign of the stokes @xmath20 profile , and positive fields are strongly discarded by data because the polarity is not the correct one .",
    "the same applies to @xmath18 and @xmath25 , which have a very asymmetric confidence interval .",
    "interestingly , since @xmath106 is a quantity directly proportional to the amplitude of stokes @xmath20 in the weak - field regime , its marginal posterior distribution is very well determined and its width is fundamentally characterized by the noise standard deviation .    given the sensitivity to the election of the prior of the non - hierarchical model , we also consider the two hierarchical models .",
    "the results are very robust to the election of the hyperparameters ( the red and black curves overlap ) .",
    "the filling factor is not constrained at all by the observations , as expected in the weak - field regime . in spite of that",
    ", the posterior for the component of the field along the line - of - sight is constrained and one can define a mmap value and a confidence interval . in any case , the analysis discards positive values and very large negative values of @xmath24 .",
    "concerning @xmath25 , the posterior is very similar to the prior .",
    "since the prior is based on physical considerations , we can safely give an upper limit to @xmath25 , but always taking into account that this comes essentially from a - priori knowledge .",
    "the posterior for @xmath106 is again very close to a gaussian with mean and variance given by eq .",
    "( [ eq : mean_variance_fparallel ] ) in the case of the hierarchical model with known noise .",
    "note also that there is an additional peak at zero magnetic flux density .",
    "this peak is produced by the marginalization over the priors , which opens the possibility that the observed stokes @xmath20 signal is compatible with the absence of magnetic field .",
    "concerning the hierarchical model with unknown noise standard deviation , the posterior is slightly narrower , induced by the jeffreys prior .    finally , fig .",
    "[ fig : derived_quantities ] presents the marginal posteriors for the derived quantities @xmath159 , @xmath160 and @xmath161 , that were obtained numerically by integrating the distributions shown in fig . [ fig : joint_imax ] using the appropriate change of variables .",
    "the results indicate that we can put upper limits to the field strength and to the magnetic energy , and that data contains some information on these two variables , with posterior clearly different from the priors . concerning the field inclination ,",
    "the marginal posterior looks like the prior distribution , so that we can only discard positive inclinations because they are not compatible with the stokes @xmath20 profile polarity .",
    "there are two important ingredients that differentiate a standard maximum - likelihood ( or least - squares ) approach and a bayesian approach .",
    "the first one is that the solution to the inference problem is given in terms of marginal posterior distributions that already encode error propagation .",
    "the second is that , thanks to the effect of the priors , when noise is too large , the marginal posteriors resemble the prior .",
    "this way , one can clearly state when a parameter is constrained by data and avoid biased estimators . to show this effect , we have analyzed how the influence of noise modifies the marginal posteriors .",
    "we consider the stokes profiles of the fe i line at 6302.4904   synthesized using the milne - eddington approximation with @xmath162 g , @xmath163 and @xmath164 .",
    "this line has a large magnetic sensitivity , with @xmath165 and @xmath166 .",
    "considering @xmath70 , the amplitude of stokes @xmath20 is of the order of 2% in units of the continuum intensity , @xmath167 , while that of stokes @xmath21 and @xmath20 is of the order of 0.03% in the same units .",
    "we corrupt these profiles with gaussian noise with zero mean and standard deviations @xmath168 , @xmath169 , @xmath170 , @xmath171 in units @xmath167 .",
    "the case with the smallest @xmath140 results in a noise amplitude of roughly the same amplitude of the linear polarization signal .",
    "we use the hierarchical model with known noise variance of eq .",
    "( [ eq : posterior_hierarchical_known_noise ] ) and numerically calculate the marginal posteriors .",
    "the results are shown in fig .",
    "[ fig : degradation_noise ] for all physical parameters of relevance .",
    "each color corresponds to a different value of @xmath140 .",
    "the vertical dotted lines indicate the maximum - likelihood values that maximize eq .",
    "( [ eq : likelihood ] ) .",
    "the curves are slightly dependent on the actual noise realization because the @xmath61 coefficients change .",
    "we plot the results for only one noise realization .    as a consequence of the selected values for the magnetic field vector and @xmath18",
    ", the original synthetic profile corresponds to @xmath172 g and @xmath173 g. the marginal posterior for @xmath24 indicates that the mmap value is compatible with the correct value only when the noise is not too large so that the stokes @xmath20 signal is not too perturbed .",
    "as soon as the noise increases , there is a shift towards smaller @xmath24 .",
    "an interesting property of the solution is that the confidence intervals are extremely asymmetric , with small values of @xmath24 absolutely discarded and a very large upper limit .",
    "this is produced , among other things , by the marginalization of the filling factor .",
    "something similar happens for the field strength .",
    "concerning @xmath25 , the marginal posterior is different from the prior only for @xmath174 , with a bump roughly close to the correct value although displaced towards smaller values .",
    "as soon as the noise increases , there is no remaining information about this component of the field on the profiles and one can only put an upper limit .",
    "a consequence of this is the fact that the marginal posterior for the azimuth is essentially flat .",
    "some peaks of larger probability are located close to the correct value but without statistical relevance .",
    "since the field inclination depends on @xmath24 and @xmath25 , the marginal posterior for the inclination indicates that a reliable inclination is only inferred when noise is sufficiently small . for large noises ,",
    "only upper limits can be correctly defined . finally , the marginal posteriors for the magnetic flux density are gaussian with a variance proportional to the noise standard deviation ( in g ) , as shown in eq .",
    "( [ eq : mean_variance_fparallel ] ) .",
    "we have considered the complete bayesian inference of the parameters of a model based on the weak - field approximation to explain observed stokes profiles .",
    "the simplicity of the approximation has allowed us to obtain a closed analytical expression for the posterior distribution function and for some of the ensuing marginal posteriors .",
    "thanks to the bayesian approach , prior information is transparently introduced into the problem . we have verified that results are sensitive to the hyperparameters of the prior and we have developed a hierarchical approach based on physical arguments that introduce regularization into the problem . as a consequence , marginal posteriors are almost insensitive to the exact value of the hyperparameters . using the bayesian approach we are able to extract not only most probable values but also confidence intervals for the model parameters .",
    "this bayesian approach can be of interest for filter - polarimetric data in which the line profiles are only sampled in a reduced number of wavelengths .",
    "likewise , signals very close to the noise can be treated under this formalism avoiding biased estimations that plague least - squares solutions .",
    "it is left for the future to carry out a profound analysis of the biases introduced by least - squares solutions using the expressions introduced in this paper .",
    "i thank r. manso sainz for fruitful discussions that led to improvements on the original manuscript .",
    "i also thank c. beck and m. j. martnez gonzlez for useful suggestions and v. martnez pillet for providing the imax data used in section [ sec : results ] .",
    "financial support by the spanish ministry of science and innovation through projects aya2010 - 18029 ( solar magnetism and astrophysical spectropolarimetry ) is gratefully acknowledged .",
    "given two random variables @xmath99 and @xmath175 with joint distribution @xmath176 , the probability distribution @xmath177 for the derived quantity @xmath178 with @xmath179 invertible can be obtained following the standard chain of variables rule .",
    "if we define the auxiliar variable @xmath180 , we can write the following direct and inverse relations : @xmath181 as a consequence , the joint probability distribution of @xmath182 and @xmath183 can be written as : @xmath184 where @xmath185 is the jacobian of the transformation equation given by eq .",
    "( [ eq : transformation ] ) : @xmath186 were the last two steps assumes @xmath187 to simplify computations .",
    "the probability distribution @xmath177 is obtained by marginalizing @xmath182 from eq .",
    "( [ eq : transformation_prob ] ) : @xmath188 for instance , if we want to carry out the transformation @xmath189 , then @xmath190 , so that @xmath191",
    "this appendix presents some of the analytical posteriors that can be obtained from eqs .",
    "( [ eq : posterior ] ) and ( [ eq : posterior_hierarchical_known_noise ] ) .",
    "if we integrate the field azimuth from the posterior of the non - hierarchical model , we obtain : @xmath192 \\right\\ } \\label{eq : marginal_3d_nonhier}\\end{aligned}\\ ] ] where @xmath193 is the modified bessel function of the first kind @xcite .",
    "it might be useful to apply the following series expansion of @xmath193 to further integrate out the filling factor : @xmath194 likewise , marginalizing @xmath24 and @xmath25 , we obtain : @xmath195^{1/2 } } \\nonumber \\\\ & \\times & \\exp \\left[-a_1+\\frac{\\left(({2\\sigma_\\perp^2})^{-1}-2(a_5 { \\cos 2 \\chi}+ a_6 { \\sin 2 \\chi } ) f \\right)^2}{4a_3 f^2 } +   \\frac{a_4 ^ 2 f^2}{({2\\sigma_\\parallel^2})^{-1 } + a_2f^2 } \\right ] \\nonumber \\\\ & \\times & \\left [ 1+\\mathrm{erf } \\left ( \\frac{-({2\\sigma_\\perp^2})^{-1}+2(a_5 { \\cos 2 \\chi}+ a_6 { \\sin 2 \\chi})f}{2\\sqrt{a_3}f } \\right ) \\right].\\end{aligned}\\ ] ]    concerning the marginal posterior for the field components , we have been unable to find a close analytical expression for the probability distributions @xmath196 and @xmath197 because @xmath24 and @xmath25 appear very intricately .",
    "however , the marginal posteriors can be obtained using adequate numerical quadrature methods on any of the following joint posteriors : @xmath198 \\label{eq : joint_bpar_bperp } \\\\",
    "p(f,{b_\\perp},\\chi|d ) & = & \\frac{1}{\\sqrt{2 } } \\pi(f-1/2 ) \\pi\\left(\\frac{\\chi-\\pi}{2\\pi } \\right ) ( 2\\pi)^{-(3n+2)/2 } \\sigma_n^{-3n }   \\frac{1}{\\sigma_\\parallel \\sigma_\\perp^2 } \\frac{{b_\\perp}}{\\sqrt{({2\\sigma_\\parallel^2})^{-1}+a_2f^2 } } \\nonumber \\\\ & \\times & \\exp \\left\\ { \\frac{a_4 ^ 2 f^2}{({2\\sigma_\\parallel^2})^{-1}+a_2f^2 } - a_1 +   \\left[2(a_5 { \\cos 2 \\chi}+ a_6 { \\sin 2 \\chi})f-\\frac{1}{2\\sigma_\\perp^2 } \\right]{b_\\perp}^2 -a_3f^2 { b_\\perp}^4 \\right\\ } \\\\",
    "p(f,{b_\\parallel},\\chi|d ) & = & \\frac{1}{4\\sqrt{2 } } \\pi(f-1/2 ) \\pi\\left(\\frac{\\chi-\\pi}{2\\pi } \\right ) ( 2\\pi)^{-(3n+2)/2 } \\sigma_n^{-3n }   \\frac{1}{\\sigma_\\parallel \\sigma_\\perp^2 } \\frac{1}{\\sqrt{a_3}f } \\nonumber \\\\ & \\times&\\exp\\left [ \\frac{({4\\sigma_\\perp^2})^{-2}-(a_5 { \\cos 2 \\chi}+ a_6 { \\sin 2 \\chi})({2\\sigma_\\perp^2})^{-1 } -   ( a_1 a_3+a_5 ^ 2-\\frac{a_3 { b_\\parallel}^2}{8\\sigma_\\parallel^2 } ) f^2 + 2a_4 f^3- a_2 { b_\\parallel}f^4}{a_3 f^2}\\right ] \\nonumber \\\\ & \\times & \\left [ 1+\\mathrm{erf } \\left ( \\frac{-({2\\sigma_\\perp^2})^{-1}+2(a_5 { \\cos 2 \\chi}+ a_6 { \\sin 2 \\chi})f}{2\\sqrt{a_3}f } \\right ) \\right ] .",
    "\\label{eq : p_f_bpar}\\end{aligned}\\ ] ] the previous expressions can be particularized to the specific case of a longitudinal magnetograph , in which only circular polarization is observed .",
    "we obtain such a case making @xmath199 , dropping @xmath51 and @xmath52 from @xmath200 and making @xmath90 .      starting from eq .",
    "( [ eq : posterior_hierarchical_known_noise ] ) , we have integrated out the field azimuth , yielding : @xmath201 i_0\\left(2f{b_\\perp}^2\\sqrt{a_5 ^ 2+a_6 ^ 2}\\right)\\nonumber \\\\ & \\times & \\frac{1}{{b_\\parallel}{b_\\perp } } \\left [   \\mathrm{erf } \\left ( \\frac{{b_\\parallel}}{\\sqrt{2}\\sigma_\\mathrm{min } } \\right ) - \\mathrm{erf } \\left ( \\frac{{b_\\parallel}}{\\sqrt{2}\\sigma_\\mathrm{max } } \\right)\\right ]   \\left [   \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{max}^2 } \\right ) - \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{min}^2 } \\right)\\right ] \\label{eq : posterior_hierarchical_known_noise_marginalchi}\\end{aligned}\\ ] ] finally , it is possible to analytically integrate out @xmath18 : @xmath202 \\nonumber \\\\ & \\times & \\frac{1}{{b_\\parallel}{b_\\perp } } \\left [   \\mathrm{erf } \\left ( \\frac{{b_\\parallel}}{\\sqrt{2}\\sigma_\\mathrm{min } } \\right ) - \\mathrm{erf } \\left ( \\frac{{b_\\parallel}}{\\sqrt{2}\\sigma_\\mathrm{max } } \\right)\\right ]   \\left [   \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{max}^2 } \\right ) - \\exp \\left ( -\\frac{{b_\\perp}^2}{2\\sigma_\\mathrm{min}^2 } \\right)\\right ] .",
    "\\label{eq : marginal_bpar_bperp_knownnoise}\\end{aligned}\\ ] ]                                                                                                                                                , v. , bonet , j.  a. , collados , m.  v. , jochum , l. , mathew , s. , medina trujillo , j.  l. , ruiz cobo , b. , del toro iniesta , j.  c. , lopez jimenez , a.  c. , castillo lorenzo , j. , herranz , m. , jeronimo , j.  m. , mellado , p. , morales , r. , rodriguez , j. , alvarez - herrero , a. , belenguer , t. , heredero , r.  l. , menendez , m. , ramos , g. , reina , m. , pastor , c. , sanchez , a. , villanueva , j. , domingo , v. , gasent , j.  l. , & rodriguez , p. 2004 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "5487 , society of photo - optical instrumentation engineers ( spie ) conference series , ed .",
    "j.  c.  mather , 11521164    , v. , del toro iniesta , j.  c. , lvarez - herrero , a. , domingo , v. , bonet , j.  a. , gonzlez fernndez , l. , lpez jimnez , a. , pastor , c. , gasent blesa , j.  l. , mellado , p. , piqueras , j. , aparicio , b. , balaguer , m. , ballesteros , e. , belenguer , t. , bellot rubio , l.  r. , berkefeld , t. , collados , m. , deutsch , w. , feller , a. , girela , f. , grauf , b. , heredero , r.  l. , herranz , m. , jernimo , j.  m. , laguna , h. , meller , r. , menndez , m. , morales , r. , orozco surez , d. , ramos , g. , reina , m. , ramos , j.  l. , rodrguez , p. , snchez , a. , uribe - patarroyo , n. , barthol , p. , gandorfer , a. , knoelker , m. , schmidt , w. , solanki , s.  k. , & vargas domnguez , s. 2011 , , 268 , 57      , d. , bellot rubio , l.  r. , del toro iniesta , j.  c. , tsuneta , s. , lites , b.  w. , ichimoto , k. , katsukawa , y. , nagata , s. , shimizu , t. , shine , r.  a. , suematsu , y. , tarbell , t.  d. , & title , a.  m. 2007 , , 670 , l61              , s.  k. , barthol , p. , danilovic , s. , feller , a. , gandorfer , a. , hirzberger , j. , riethmller , t.  l. , schssler , m. , bonet , j.  a. , martnez pillet , v. , del toro iniesta , j.  c. , domingo , v. , palacios , j. , knlker , m. , bello gonzlez , n. , berkefeld , t. , franz , m. , schmidt , w. , & title , a.  m. 2010 , , 723 , l127"
  ],
  "abstract_text": [
    "<S> the weak - field approximation is one of the simplest models that allows us to relate the observed polarization induced by the zeeman effect with the magnetic field vector present on the plasma of interest . </S>",
    "<S> it is usually applied for diagnosing magnetic fields in the solar and stellar atmospheres . a fully bayesian approach to the inference of magnetic properties in unresolved structures is presented . the analytical expression for the marginal posterior distribution </S>",
    "<S> is obtained , from which we can obtain statistically relevant information about the model parameters . </S>",
    "<S> the role of a - priori information is discussed and a hierarchical procedure is presented that gives robust results that are almost insensitive to the precise election of the prior . </S>",
    "<S> the strength of the formalism is demonstrated through an application to imax data . </S>",
    "<S> bayesian methods can optimally exploit data from filter - polarimeters given the scarcity of spectral information as compared with spectro - polarimeters . </S>",
    "<S> the effect of noise and how it degrades our ability to extract information from the stokes profiles is analyzed in detail . </S>"
  ]
}