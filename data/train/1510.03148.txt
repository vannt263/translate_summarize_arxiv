{
  "article_text": [
    "in our experiment , we damaged d@xmath2 during qkd operation , trying not to interrupt it .",
    "the system was allowed to start up and produce a secret key for several qkd cycles , using bb84 protocol @xcite . to perform laser damage , we disconnected the channel for @xmath33@xmath34 , giving us enough time to apply high power to alice , and then reconnected the channel .",
    "we tried this at different points in the qkd operation cycle .",
    "sometimes the software recovered and resumed qkd , and sometimes it got stuck in recalibration routines . in the latter case ,",
    "a manual software restart resumed qkd .",
    "owing to a limited number of trials , we did not perfect this timing aspect .",
    "we tested a total of 6 photodiode samples .",
    "we damaged each of them by applying high power laser light at alice s entrance .",
    "we then used the manufacturer s factory - calibration software to measure how much extra signal power ( compared to the pre - calibrated power level ) could be injected without triggering the alarm @xcite .",
    "this quantified the reduction in sensitivity due to the damage .",
    "three samples were exposed twice to a progressively higher power .",
    "for example , one sample was first exposed to @xmath35 power at alice s entrance that reduced its photosensitivity by @xmath36 , then to @xmath37 power that reduced its photosensitivity by @xmath8 . for the other two samples",
    "these numbers were @xmath37 with no change in sensitivity then @xmath38 , @xmath39 ( shown in 2nd microphotograph in [ fig : fiber - optic - setup]b ) ; @xmath38 , @xmath40 then @xmath10 , @xmath41 ( shown in 3rd microphotograph in [ fig : fiber - optic - setup]b ) . for the remaining three samples ,",
    "@xmath27 was applied at alice s entrance , and d@xmath2 completely lost photosensitivity , becoming electrically either a large resistor ( shown in 4th microphotograph in [ fig : fiber - optic - setup]b ) or an open circuit .",
    "after we were done with each sample , we used the same manufacturer s factory - calibration software to pre - calibrate the sensitivity of the next undamaged d@xmath2 sample , following the factory procedure .",
    "no other component in alice was damaged during these trials .",
    "we also tested some components separately .",
    "fc / pc and fc / apc optical connectors used in alice and in the channel withstood @xmath42 c.w . , while copies of alice s 10:90 fiber beamsplitters ( afw technologies fosc-1 - 15 - 10-l-1-s-2 ) withstood up to @xmath43 c.w .  with no damage .",
    "laser power , resulting in d@xmath2 becoming an open circuit with no photosensitivity .",
    "]    summarizes a system operation log when it recovered automatically after the damage that made the photodiode an open - circuit with no photosensitivity . in the current system implementation",
    ", this represents an ideal outcome for an attacker .    for damaging and component tests ,",
    "eve used an erbium - doped fiber amplifier seeded from a @xmath44 laser source ( edfa ; ipg photonics elr-70 - 1550-lp ) .",
    "she injected @xmath45@xmath46 c.w .",
    "power at alice s entrance .",
    "the injected power was monitored with a 1:99 fiber beamsplitter tap and a power meter ( [ fig : fiber - optic - setup]a ) . a manually operated shutter at the output of edfa allowed to ramp the power up and down smoothly between 0 and the target level , with tens of milliseconds transition time .",
    "the spectral characteristics of edfa s built - in seed laser did not precisely match the passband of the bpf at alice s entrance ( @xmath47@xmath48 passband at @xmath49 level , @xmath50 insertion loss ; afw technologies bpf-1551.72 - 2-b-1 - 1 ) .",
    "we therefore removed the bpf for the duration of experiment .",
    "the bpf was separately tested in - passband using a different edfa ( pritel lnhpfa-37 ) with a narrowband seed laser , and passed more than @xmath51 c.w .  with no damage .    the system qkd software ( ` qkd sequence ' application @xcite ) set the variable attenuator voa2 at @xmath52 .",
    "thus , @xmath6 of alice s incoming light impinged d@xmath2 , while smaller fractions impinged d@xmath53 and d@xmath54 .",
    "the alarm threshold of d@xmath2 is calibrated when the system is assembled at the factory , and is not changed after that @xcite .",
    "voa3 introduced channel loss of @xmath55 , to simulate the effect of @xmath56 long fiber line alice  bob .",
    "the qkd system clavis2 normally operates automatically in cycles consisting of sending and receiving quantum states until either the memory buffer is full or photon detection efficiency has dropped significantly .",
    "it then uses the classical link alice ",
    "bob to post - process the detected data and distill the secret key @xcite .",
    "each cycle takes several minutes . if the last qkd cycle was interrupted because the detection efficiency was too low , or the key distillation failed , the system returns to start - up routines such as timing recalibration @xcite before it resumes sending quantum states .",
    "this happens often in normal operation , because of naturally occurring drift of hardware and channel parameters .",
    "the software generally tries to recover automatically from various error conditions , to provide long - term unattended operation @xcite .",
    "* predicted attacks on fiber - optic system with damaged pulse - energy - monitoring photodiode . * as modeled in ref .",
    ", for bb84 qkd protocol eve can eavesdrop partial or full key information using today s best photonics technologies when the sensitivity of d@xmath2 has dropped by @xmath57@xmath12 , given that communication channel loss alice ",
    "bob is in a @xmath7@xmath58 range .",
    "( this corresponds to a multiplication factor @xmath59 in the range of @xmath60@xmath61 , see fig .",
    "11 in ref .  .",
    ") if we assume that eve s equipment is only limited by the laws of quantum mechanics , then she can extract the full key information after only @xmath62@xmath63 reduction in sensitivity ( @xmath59 of @xmath64@xmath65 ) . similarly , for qct with a dishonest bob only limited by the quantum mechanics , all the quantum advantages of the protocol are eliminated if sensitivity reduction of @xmath13 is obtained in alice ( @xmath66 ) , for a @xmath67 long communication channel . for a @xmath68 sensitivity reduction ,",
    "bob s cheating probability approaches unity @xcite .",
    "since we have surpassed the above sensitivity reduction thresholds in our laser damage experiment , we consider the security of both qkd and qct implementation compromised .",
    "in order to neutralize the effect of the pinhole and reproduce the side - channel of spatial - mode detector - efficiency mismatch , our experiment consisted of three steps .",
    "firstly , we performed scanning to certify that the system is secure against this side - channel . secondly , we laser - damaged the pinhole to open the side - channel . finally , we performed scanning again to demonstrate that the system s security has been compromised . in all three steps ,",
    "eve was placed at a distance of @xmath19 away from bob and the steps were performed in sequence without making any interactions with bob .    the first step involved changing the outgoing beam s angle @xmath17 emitted from eve s scanning setup shown in [ fig : free - space - setup]a , then recording the corresponding count rate at all four detectors in bob .",
    "this step is identical to that in ref .  .",
    "the scanning result is shown in [ fig : free - space - mismatch - plots]a , where a pair of 3d2d plots shows the normalized photon detection efficiency in one receiver channel versus the illuminating beam angles @xmath69 and @xmath70 . with the pinhole in place ,",
    "the angular dependence of efficiency is essentially identical between the four channels , hence only a plot for channel v is shown .",
    "no measurable amount of efficiency mismatch was found and no attack angles existed @xcite .",
    "then as the second step , eve s scanning setup was replaced with the damaging setup .",
    "the latter contained a @xmath20 laser diode ( jenoptik jold-30-fc-12 ) pumped by a current - stabilized power supply and connected to @xmath71 core diameter multimode fiber .",
    "it provided continuously adjustable @xmath45 to @xmath72 c.w .",
    "power into the fiber .",
    "an almost - collimated free - space beam was subsequently formed by a plano - convex lens l5 ( thorlabs la1131-b ; [ fig : free - space - setup]a ) .",
    "the beam s intensity was nearly uniformly distributed across bob s l1 ( @xmath73 diameter achromatic doublet , thorlabs ac508 - 250-a ) , with less than @xmath74 intensity fluctuation across bob s input aperture .",
    "transmission of l1 was about @xmath75 , owing to its antireflection coating being designed for a different wavelength band . in the test detailed here , the power delivered at the pinhole plane was @xmath22 , sufficient to reliably produce a hole of @xmath24 diameter in less than @xmath21 in a standard stainless - steel foil pinhole ( thorlabs p25s ) .",
    "we tested several pinholes and found that this power always made the hole .",
    "we also tested that power decreased to @xmath76 still produced a hole .",
    "no other component in bob was damaged during the tests .",
    "bob s lenses l3 received @xmath77 power each , and single - photon detectors only received on the order of a few @xmath78 each , mainly owing to the presence of bpf after the pinhole .",
    "the bpf was used by bob to increase the signal - to - noise ratio during qkd by heavily attenuating all light outside the @xmath79@xmath80 passband ( it consisted of two stacked filters , thorlabs fesh0700 followed by semrock ll01 - 532 - 12 - 5 ) @xcite . while the damaging beam was on , the detectors counted at their saturation rate of @xmath81 , which did not look abnormal to bob as this sometimes occurs naturally owing to atmospheric conditions ( during sunset , sunrise , fog ) .",
    "we remark that this type of detector usually survives tens of @xmath82 for a short time @xcite .",
    "even if we had to use a wavelength within the bpf s passband , detector exposure to higher power could likely be avoided by shaping eve s damaging beam .    after the damage , as the third step we replaced the damaging setup with the scanning setup again , and performed the final scanning of bob s receiver with the damaged pinhole .",
    "the results are shown in [ fig : free - space - mismatch - plots]b .",
    "now , the four receiver channels h , v , d , a exhibited unequal sensitivity to photons outside the middle area around @xmath83 .",
    "these efficiency plots were different from those measured in ref .   without the pinhole , because of extra scattering at the edges of our laser - enlarged pinhole .",
    "* predicted attack on free - space qkd system with damaged pinhole .",
    "* we model a practical faked - state attack as described in ref .  .",
    "we assume a part of eve is situated outside alice and measures the quantum states coming out .",
    "then , another part of her regenerates the measured quantum states as attenuated coherent pulses and sends them to bob , tilting her beam at an angle such that it has a relatively higher probability of being detected by the desired detector .",
    "eve has information about bob s receiver characteristics after the laser damage , and only uses devices available in today s technology @xcite .",
    "for example , let s assume eve sends a horizontally polarized light pulse . in this case , she should choose her tilt angle @xmath84 from a subset @xmath85 selected in such a way that the efficiency @xmath86 of bob s horizontal channel in @xmath85 is as high as possible , in order to maximize mutual information eve  bob .",
    "on the other hand , if bob measures in the opposite ( da ) basis , the detection probabilities in the d and a channels @xmath87 and @xmath88 should be as low as possible , to minimize qber .",
    "thus , to find attack angles for the horizontally polarized light , we choose @xmath85 that satisfies @xmath89 and @xmath90 .",
    "similarly , for v , d and a polarized pulses , we choose attack angles that satisfy @xmath91 , @xmath92 ; @xmath93 , @xmath94 ; @xmath95 , @xmath96 .",
    "these subsets of angles are shown in the rightmost plot in [ fig : free - space - mismatch - plots]b .",
    "note that the thresholds @xmath97 and @xmath98 used here are not optimal and have been picked manually .",
    "however , they satisfy the required conditions to successfully perform the faked - state attack with a resultant qber @xmath99 in @xmath7@xmath25 channel loss range , as shown in [ fig : free - space - qber - vs - loss ] . in the simulation , we assumed that alice ",
    "bob and alice  eve fidelity @xmath100 @xcite , while eve ",
    "bob experimentally measured @xmath101 .",
    "all other assumptions were the same as in ref .",
    "alice s setup in clavis2 ( [ fig : fiber - optic - setup]a ) consists of more than 20 discrete optical components : over 10 fiber connectors , 3 beamsplitters , 3 detectors , 2 variable attenuators , a bandpass filter , phase modulator , and faraday mirror . as discussed in main text , certain deviations in any of these components lead to the denial - of - service , while other deviations result in opening different security loopholes .",
    "attacker s goal , and the goal of a thorough security tester , is to do one s best to avoid the former and demonstrate the latter",
    ". parameters of the damaging laser illumination can and should be varied to reach this goal .    when we began testing the system components for laser damage , the synchronization detector d@xmath53 initially presented an obstacle .",
    "this detector was based on an optical receiver module ( fujitsu frm5w232bs ) incorporating an avalanche photodiode biased below breakdown at @xmath102 , providing an avalanche multiplication factor @xmath103 .",
    "it only took about @xmath104 of optical power at the photodiode ( translating to about @xmath105 at alice s entrance ) to die .",
    "it stopped providing the synchronization signal for alice and thus broke the system , i.e. ,  led to the denial - of - service . after an investigation , it turned out that the energy that killed it was chiefly provided by its high - voltage electrical bias circuit and not the optical signal .",
    "the bias circuit was based on a specialised integrated circuit with overcurrent protection ( maxim integrated max1932etc ) followed by an lc low - pass filter with inductor @xmath106 and capacitor @xmath107 .",
    "if the optical power is applied suddenly , with sub - nanosecond rise time , it momentarily induces a large photocurrent supplied from c that destroys the avalanche photodiode . if , however , the optical power is applied gradually , with millisecond rise time , c discharges slowly and then the relatively slow overcurrent protection reacts in the integrated circuit , lowers the bias voltage and saves the photodiode .",
    "we thus added a manual shutter to the edfa to make the damaging power rise from zero slowly , allowing d@xmath53 to easily withstand the optical power used in our attack while being electrically powered up .",
    "another solution could be to damage the system when it is without electrical power .",
    "it can also be said that we could choose to selectively damage one of two components in alice , albeit one of them bricking the system .",
    "we ran our damage tests with voa2 ( oz  optics dd-600 - 11 - 1300/1550 - 9/125-s-40 - 3s3s-1 - 1 - 485:1 - 5-mc / iic ) set at @xmath52 , because this is what the manufacturer s qkd software available for the research system clavis2 set it at .",
    "the support of the pulse - energy - monitoring countermeasure was not implemented in this software @xcite .",
    "in contrast , the manufacturer s factory - calibration software supported it fully and set voa2 between @xmath33 and @xmath108 , complementary to the channel loss , in order to maintain constant power at the three alice s detectors d@xmath2 , d@xmath53 , and d@xmath54 . the higher settings of voa2 would require more laser power to damage d@xmath2 .",
    "however , d@xmath2 could also be damaged during the system start - up time , when it sends the homing command to voa2 .",
    "the homing command causes it to traverse its lowest attenuation values for a few seconds , likely being sufficient for eve to do the damage at already demonstrated power levels .",
    "download the video at http://vad1.com/pinhole-laser-damage-20140825.wmv ( windows media video , 14.4  mib ) or http://vad1.com/pinhole-laser-damage-20140825.ppsx ( powerpoint show , 17.0  mib ) .",
    "the video shows the spatial filter ( thorlabs p20s ) illuminated by @xmath22 c.w .",
    "@xmath20 laser beam for @xmath21 , focused in a spot much wider than the original pinhole diameter of @xmath109 .",
    "this is a filter sample with a slightly smaller original pinhole diameter than the one used to obtain efficiency mismatch data in this article and shown in [ fig : free - space - setup]b .",
    "the samples were otherwise of the same type and damaged under the same conditions .",
    "the video was taken via a mirror lowered inside bob s setup .",
    "the pinhole plane was imaged from the front side at an angle slightly off normal , in order for the mirror not to obstruct the damaging beam .",
    "canon mp - e @xmath110 lens was used at @xmath111 magnification and f/16 lens aperture ( f/60 effective aperture ) , with canon eos  7d camera body .",
    "the pinhole was brightly lit sideways with a fiber - optic illuminator bundle , in order to bring up detail . during the laser exposure",
    ", the steel foil can be seen deforming from heat , popping out of focus and apparently shifting laterally in the image ; however the lateral shift is an artefact of the camera s angle of view being off - normal .",
    "after the laser is switched off , the foil cools and returns to the original position , now with about @xmath112 diameter hole in it .",
    "sound was added later for an artistic effect .",
    "46ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _",
    "( ,  ) link:\\doibase 10.1137/s0097539795293172 [ * * , ( ) ] in  @noop _ _  ( ,  ,  )  pp",
    ".   link:\\doibase 10.1126/science.283.5410.2050 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1126/science.1214707 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.113.040502 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.111.180504 [ * * ,   ( ) ] link:\\doibase 10.1364/oe.23.007300 [ * * ,   ( ) ] link:\\doibase    10.1007/bf00191318 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.74.022313 [ * * ,   ( ) ] ,   @noop * * ,   ( ) link:\\doibase    10.1038/nphoton.2010.214 [ * * ,   ( ) ] link:\\doibase 10.1088/1367 - 2630/12/11/113026 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.83.062331 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.91.062301 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase    10.1088/1367 - 2630/4/1/341 [ * * ,   ( ) ] @noop link:\\doibase    10.1103/physreva.92.052339 [ * * ,   ( ) ] link:\\doibase    10.1088/1367 - 2630/16/1/013047 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.113.190501 [ * * ,   ( ) ] link:\\doibase 10.1038/nphoton.2013.63 [ * * ,   ( ) ] link:\\doibase    10.1038/ncomms4717 [ * * ,   ( ) ] link:\\doibase 10.1080/09500340108240903 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.91.032326 [ * * ,   ( ) ] link:\\doibase 10.1080/09500340108240904 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.84.062308 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.92.032305 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.112.070503 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.97.120405 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.110.010503 [ * * ,   ( ) ] link:\\doibase    10.1080/09500340108240905 [ * * ,   ( ) ] @noop @noop   @noop _ _  ( ,  )   link:\\doibase 10.1080/09500340410001730986 [ * * ,   ( ) ] link:\\doibase    10.1038/ncomms1348 [ * * ,   ( ) ] @noop * * ,   ( ) @noop _ _  ( ,  ) link:\\doibase 10.1016/0079 - 6727(93)90004-s [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.83.032306 [ * * ,   ( ) ] @noop _ _ ,  ed .",
    "( ,  ) link:\\doibase    10.1103/physrevlett.107.110501 [ * * ,   ( ) ] link:\\doibase    10.1088/1367 - 2630/13/12/123001 [ * * ,   ( ) ] link:\\doibase    10.1364/oe.19.023590 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> practical quantum communication ( qc ) protocols are assumed to be secure provided implemented devices are properly characterized and all known side channels are closed . </S>",
    "<S> we show that this is not always true . </S>",
    "<S> we demonstrate a laser - damage attack capable of modifying device behaviour on - demand . </S>",
    "<S> we test it on two practical qc systems for key distribution and coin - tossing , and show that newly created deviations lead to side channels . </S>",
    "<S> this reveals that laser damage is a potential security risk to existing qc systems , and necessitates their testing to guarantee security .    </S>",
    "<S> cryptography , an art of secure communication , has traditionally relied on either algorithmic or computational complexity @xcite . </S>",
    "<S> even the most state - of - the - art classical cryptographic schemes do not have a strict mathematical proof to ascertain their security . with the advance of quantum computing , it may be a matter of time before the security of the most widely used public - key cryptography protocols is broken @xcite . quantum communication ( qc ) </S>",
    "<S> protocols , on the other hand , have theoretical proofs of being unconditionally secure @xcite . in theory , </S>",
    "<S> their security is based on the assumption of modeled behaviour of implemented equipment . in practice </S>",
    "<S> , the actual behaviour often deviates from the modeled one , leading to a compromise of security as has been seen so far in case of quantum key distribution ( qkd ) @xcite . </S>",
    "<S> however , it is widely assumed that as long as these deviations are properly characterized and security proofs are updated accordingly @xcite , implementations are unconditionally secure . in this work </S>",
    "<S> we show that satisfying this during the initial installation only is not enough to guarantee security . </S>",
    "<S> even if a system is perfectly characterized and deviations are included into the security proofs , an adversary can still create a new deviation on - demand and make the system insecure .        before going into details on how the adversary may do it , </S>",
    "<S> let s consider a few examples of deviations and their consequences . </S>",
    "<S> for example , a calibrated optical attenuator is required to set a precise value of the outgoing mean photon number @xmath0 in the implementations of ordinary qkd @xcite , decoy - state qkd @xcite , coherent - one - way qkd @xcite , measurement - device - independent qkd @xcite , continuous - variable qkd @xcite , digital signature @xcite , relativistic bit commitment @xcite , coin - tossing @xcite and secret - sharing @xcite protocols . </S>",
    "<S> an unexpected increase of this optical component s attenuation may cause a denial - of - service . </S>",
    "<S> however , a reduction in attenuation will increase @xmath0 , leading to a compromise of security via attacks that rely on measurement of multi - photon pulses @xcite . e.g. ,  in qkd and secret - sharing this will allow eavesdropping of the key , and in bit commitment cheating the committed bit value . </S>",
    "<S> some implementations use a detector for time synchronization @xcite . desensitizing it may result in the denial - of - service . </S>",
    "<S> however , several implementations require a calibrated monitoring detector for security purposes @xcite . </S>",
    "<S> a reduction in its sensitivity may lead to security vulnerabilities such as a trojan - horse attack that reads the state preparation @xcite . </S>",
    "<S> this leaks the key in qkd , increases the cheating probability in coin - tossing @xcite , leaks the program and client s data in quantum cloud computing @xcite and allows forging of digital signatures @xcite . </S>",
    "<S> many implementations use beamsplitters and rely on their pre - characterized splitting ratio ( e.g. ,  @xcite ) . a shift in the splitting ratio may lead to either the denial - of - service or security vulnerabilities ( e.g. ,  @xcite or one of the above - mentioned attacks ) . a shift in characteristics of a phase modulator or a faraday mirror </S>",
    "<S> may create imperfect qubits that will result in the denial - of - service or a breach in security @xcite . if the dark count rate of single - photon detectors is increased , it may lead to the denial - of - service @xcite . even in device - independent qkd ( di - qkd ) @xcite , the absence of information - leakage channels and memory </S>",
    "<S> is assumed @xcite . </S>",
    "<S> thus , there is a risk these assumptions may be compromised by deviations in device characteristics . to give a speculative illustration , </S>",
    "<S> let s suppose detectors in di - qkd emit light on detection @xcite , and to prevent this leaking information about detection results , spectral filters and optical isolators are added to the devices . </S>",
    "<S> then , unexpected deviations in characteristics of the latter components become important for security . in summary , </S>",
    "<S> quantum communication systems rely on multiple characteristics of many components for their correct operation , and a deviation might lead to severe security consequences .        in classical communications , there is no real concern about the possibility of a shift in device characteristics . </S>",
    "<S> classical devices security - critical parts can be physically separated from the communication channel and isolated from physical access by the adversary @xcite . </S>",
    "<S> however the front - end of a quantum communication system is essentially an analog optical system connected to the channel ( at least , at our present level of the technology ) , and is easily accessible by the adversary . </S>",
    "<S> the latter can shoot a high - power laser from the communication channel to alter system component characteristics via laser damage @xcite . </S>",
    "<S> the question is what will this achieve ? </S>",
    "<S> will the adversary break some component needed for operation and cause the denial - of - service ( which is not a useful outcome for her ) , or will she change some component in such a way as to facilitate a compromise of security ? further , will the security compromise be only possible in theory or be practical with today s technology ? </S>",
    "<S> this can not be predicted in advance , because system implementations contain many components and their laser damage thresholds and failure behavior are generally not precisely known . to assess the risk for quantum communications </S>",
    "<S> , we have performed tests on two extensively characterized , completely different and widely used implementations : a commercial fiber - optic system for qkd and coin - tossing with phase - encoded qubits @xcite , and a free - space system for qkd with polarization - encoded qubits @xcite . in both systems , we have unfortunately observed the best possible outcome for the adversary . after the laser damage , </S>",
    "<S> the systems security has become compromisable with today s technology .    as a representative of a fiber - optic quantum communication implementation , we chose a plug - and - play qkd @xcite and loss - tolerant quantum coin tossing ( qct ) @xcite . both were implemented using a commercial system clavis2 from i d  quantique @xcite . in both cases , bob sends bright light pulses to alice . </S>",
    "<S> alice randomly encodes her secret bits by applying one out of four phases ( @xmath1 ) , attenuates the pulses and reflects them back to bob ( [ fig : fiber - optic - setup]a ) . </S>",
    "<S> the security of both protocols requires an upper bound on the mean photon number @xmath0 coming out of alice . </S>",
    "<S> otherwise , an eavesdropper eve can perform a trojan - horse attack @xcite by superimposing extra light to the bright pulses on their way to alice from bob . </S>",
    "<S> if alice is unaware of this and applies the same attenuation , then light coming out of her has a higher @xmath0 than allowed by the security proofs @xcite , making the implementations insecure . </S>",
    "<S> it is thus crucial for the security of both protocols that alice monitors the incoming pulse energy . </S>",
    "<S> this is achieved by employing a pulse - energy - monitoring detector ( d@xmath2 in [ fig : fiber - optic - setup]a ) . </S>",
    "<S> a portion of the incoming light is fed to d@xmath2 such that whenever extra energy is injected , an alarm is produced @xcite . </S>",
    "<S> the sensitivity of d@xmath2 is factory - calibrated , thus closing the side - channel associated with the trojan - horse attack .    </S>",
    "<S> our testing showed that this countermeasure is vulnerable to laser damage . during normal qkd operation , we disconnected the fiber channel alice  </S>",
    "<S> bob temporarily and connected eve ( [ fig : fiber - optic - setup]a ) . </S>",
    "<S> she then injected @xmath3 laser light from an erbium - doped fiber amplifier for @xmath4@xmath5 , delivering continuous - wave ( c.w . )  high power into alice s entrance . </S>",
    "<S> @xmath6 of this power reached the fiber - pigtailed ingaas photodiode d@xmath2 ( jdsu epm 605ll ) , and damaged it partially or fully . </S>",
    "<S> it became either less sensitive to incoming light ( by @xmath7@xmath8 after @xmath9@xmath10 illumination at alice s entrance ) or completely insensitive ( after @xmath11 ) . </S>",
    "<S> the physical damage is shown in [ fig : fiber - optic - setup]b . </S>",
    "<S> no other optical component was damaged at this power level . </S>",
    "<S> we repeated the experiment with 6 photodiode samples . in half of these trials , qkd continued uninterrupted and kept producing more key after we reconnected the channel back to bob , as if nothing has happened . in the other half , a manual software restart was needed . however , in all the trials the damage was sufficient to permanently open the system up to the trojan - horse attack . as modeled in ref .  </S>",
    "<S> , in the qkd protocol , eve can eavesdrop partial or full key using today s best technology if the sensitivity of d@xmath2 drops by more than @xmath12 . in the qct implementation , </S>",
    "<S> a sensitivity reduction by @xmath13 can increase bob s cheating probability above a classical level , removing any quantum advantage of coin - tossing . </S>",
    "<S> laser damage thus compromises both the qkd and qct implementations . </S>",
    "<S> see [ sec : experiment - details - fiber - optic ] for details .        as a representative of free - space quantum communication </S>",
    "<S> , we chose a long - distance satellite qkd prototype operating at @xmath14 wavelength @xcite employing bennett - brassard 1984 ( bb84 ) protocol @xcite . at each time slot </S>",
    "<S> , alice randomly sends one out of four polarizations : horizontal ( h ) , vertical ( v ) , @xmath15 ( d ) , or @xmath16 ( a ) using a phase - randomized attenuated laser . </S>",
    "<S> bob randomly measures in either horizontal - vertical ( hv ) or diagonal - antidiagonal ( da ) basis , using a polarization - beamsplitter receiver ( [ fig : free - space - setup]a ) . </S>",
    "<S> it has been shown in ref .   that an eavesdropper can , in practice , tilt the beam going towards bob by an angle @xmath17 such that the beam misses , partially or fully , the cores of fibers leading to three detectors while being relatively well coupled into the core leading to the fourth detector , as illustrated in [ fig : free - space - setup]a . </S>",
    "<S> this happens because real - world optical alignments are inherently imperfect and manufacturing precision is finite . by sending light at different spatial angles , </S>",
    "<S> the eavesdropper can have control over bob s basis and measurement outcome and steal the key unnoticed @xcite . </S>",
    "<S> this attack can be prevented by placing a spatial filter or ` pinhole ' at the focal plane of lenses l1 and l2 , as shown in [ fig : free - space - setup]a @xcite . since the pinhole limits the field of view , </S>",
    "<S> any light entering at a higher spatial angle is blocked and eve no longer has access to the target angles required to have control over bob . as was demonstrated in ref .  </S>",
    "<S> , a pinhole of @xmath18 diameter eliminates this side - channel by making the angular efficiency dependence identical between the four detectors ( [ fig : free - space - mismatch - plots]a ) .    </S>",
    "<S> our testing showed that this countermeasure is destroyed by laser damage . from a distance of @xmath19 </S>",
    "<S> , we shot an @xmath20 collimated laser beam delivering a @xmath21 pulse of @xmath22 c.w .  </S>",
    "<S> power at the pinhole inside bob s setup . </S>",
    "<S> the intensity there was sufficient to melt the material ( @xmath23 thick stainless steel ) and enlarge the hole diameter to @xmath24 . </S>",
    "<S> the state of the pinhole before and after damage is shown in [ fig : free - space - setup]b , and a real - time video of the damage process is shown in [ sec : video - pinhole - damage ] . </S>",
    "<S> although bob was up and running in photon counting mode during the test , none of his other components were damaged . with this larger pinhole opening </S>",
    "<S> , it was again possible to send light at angles that had relatively higher mismatches in efficiency , as shown in [ fig : free - space - mismatch - plots]b . </S>",
    "<S> this enabled a faked - state attack under realistic conditions of channel loss in @xmath7@xmath25 range with quantum bit error ratio ( qber ) @xmath26 . </S>",
    "<S> thus laser damage completely neutralizes this countermeasure , and makes this free - space qkd system insecure . </S>",
    "<S> see [ sec : experiment - details - free - space ] for details .    </S>",
    "<S> the crucial step of the attack , creating the deviation in device characteristics , has thus been experimentally demonstrated for both systems tested . </S>",
    "<S> we repeated this step several times and confirmed that laser power above a certain value ( @xmath27 in fiber - optic system and @xmath22 in free - space one ) always destroys the security - critical component , without inflicting any collateral damage that could result in the denial - of - service . </S>",
    "<S> after this , building a complete eavesdropper would be a realistic if time - consuming task @xcite .    in our testing , </S>",
    "<S> we havent done anything that eve could not do in the real world . </S>",
    "<S> she could buy a copy of each system , rehearse her attacks , then attack an installed system of the same model . by kerckhoffs principle @xcite </S>",
    "<S> , eve is assumed to know the system characteristics and results of damage precisely . in practice </S>",
    "<S> when attacking installed devices , if she needs to measure their characteristics , she may probe them remotely by imaging , reflectometry @xcite , and watching public communication alice  </S>",
    "<S> bob @xcite .    </S>",
    "<S> at present , no quantum communication system has countermeasures specifically designed to stop laser - damage attack , neither do they have a mechanism to check all possible deviations in device characteristics from the modeled values . </S>",
    "<S> countermeasures to other attacks do not prevent this attack , in fact they become weak points as our experimental study shows . </S>",
    "<S> development of necessary countermeasures is complicated by the fact that eve can use a laser with different characteristics : power , timing ( e.g. , short - pulsed laser induces different damage mechanisms than c.w .  </S>",
    "<S> thermal damage we have observed @xcite ) , wavelength , polarization . </S>",
    "<S> eve can attack the systems in different phases of their operation including powered - off state , which can control what component is damaged . </S>",
    "<S> we have experimentally observed dependence of damage on the laser timing profile , as detailed in [ sec : damage - control - fiber - optic ] , where we show that some profiles have resulted in the denial - of - service but some in a successful attack . </S>",
    "<S> we stress that eve will select the illumination regime that results in the successful attack , if such regime exists at all . </S>",
    "<S> any countermeasure must thus be tested in all possible illumination regimes . </S>",
    "<S> possible directions of development include a passive optical power limiter @xcite , a single - use ` fuse ' that permanently breaks the optical connection if a certain power is exceeded , battery - powered active monitoring supplemented with wavelength filtering , or an optical isolator ( for alice that uses one - way light propagation @xcite ) . </S>",
    "<S> hardware self - characterization may be promising @xcite , however to protect from an arbitrary damage it must monitor a potentially large number of hardware parameters .    </S>",
    "<S> it is an interesting question if risk for untested system designs can be estimated . </S>",
    "<S> as we have discussed , any given system design contains many optical components with unknown damage characteristics . </S>",
    "<S> the outcome of damage ( denial - of - service or successful attack ) is thus impossible to predict prior to testing . </S>",
    "<S> then , if some of the system designs chosen at random were tested , the risk for the remaining untested designs could be calculated by bayesian statistics @xcite . unfortunately </S>",
    "<S> , truly random choice is impractical to implement with the current state of quantum communications research and limited sample availability . </S>",
    "<S> we have instead tested the two system designs that were available in our lab . </S>",
    "<S> this biased the choice towards more mature and older designs . </S>",
    "<S> although this unknown bias makes the bayesian analysis inapplicable , we find it illustrative to consider the risk figure that would have applied if the choice were random . with zero systems tested , </S>",
    "<S> the bayesian probability that at least @xmath28 of the untested system designs ( assuming at least 50 of them exist ) are vulnerable to this attack is @xmath29 ( @xmath30 ) , assuming a jeffreys ( uniform ) prior . </S>",
    "<S> if two randomly chosen system designs were tested with two positive outcomes , this probability would have increased greatly to @xmath31 ( @xmath32 ) . </S>",
    "<S> note that the security risk is generally high , which is in stark contrast with the very low expected theoretical risk @xcite .    </S>",
    "<S> we have experimentally demonstrated laser damage as a new eavesdropping tool that alters parameters of a well - characterized quantum communication system . </S>",
    "<S> any modification of system characteristics might compromise the security either directly by leading to an attack as we have demonstrated , or indirectly by shifting some parameter in the security proof so it would no longer apply . </S>",
    "<S> existing security proofs do not accommodate this , neither do existing systems have any countermeasure implemented against this . </S>",
    "<S> our results thus reveal the potential security risk for other existing systems , which should be tested against this attack .    </S>",
    "<S> * acknowledgements*. we thank q.  liu , e.  anisimova and o.  di  matteo for early experimental efforts , s.  todoroki , n.  l \" utkenhaus , m.  mosca , y.  zhang , l.  lydersen and s.  lydersen for discussions . </S>",
    "<S> this work was supported by the us office of naval research , industry canada , cfi , ontario mri , nserc , canadian space agency , i d  quantique , european commission s fet qict siqs project , empir 14ind05 miqc2 project , and cryptoworks21 . </S>",
    "<S> we acknowledge using university of waterloo s quantum nanofab . </S>",
    "<S> p.c .  was supported from thai dpst scholarship . </S>",
    "<S> j .- p.b .  was supported by fed  dev .    </S>",
    "<S> * conflicts of interest . * </S>",
    "<S> a part of this study was supported and m.l .  </S>",
    "<S> was employed by i d  quantique . </S>",
    "<S> the company has been informed prior to this publication , and is developing countermeasures for their affected qkd system . </S>",
    "<S> the other authors declare no competing financial interests .    </S>",
    "<S> * author contributions . * </S>",
    "<S> v.m .  conceived and led the study . </S>",
    "<S> s.k .  implemented the fiber - optic experiment . s.s .  </S>",
    "<S> implemented the free - space experiment and contributed to the fiber - optic experiment . </S>",
    "<S> p.c .  </S>",
    "<S> contributed to the free - space experiment . m.g </S>",
    "<S> .  contributed to the fiber - optic experiment . </S>",
    "<S> c.m .  </S>",
    "<S> made minor contributions to the free - space experiment . m.l .  provided and supported the fiber - optic qkd system under test . t.j .  and </S>",
    "<S> j .- p.b .  provided the free - space qkd receiver under test and contributed to the free - space experiment . r.k .  </S>",
    "<S> provided the fiber laser facility and co - supervised the fiber - optic experiment . s.s .  and </S>",
    "<S> v.m .  wrote the article , with contributions from all authors . </S>"
  ]
}