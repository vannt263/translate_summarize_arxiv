{
  "article_text": [
    "obtaining the hamiltonian of a system by the extraction of its parameters from experimentally measured data is an inverse problem , one of the fundamental problems in physics . in order to control a system , as in quantum information processing @xcite",
    ", this task is critically important , because current optimal control algorithms , such as gradient ascent pulse engineering @xcite and strongly modulating pulse @xcite algorithms , depend on the full information of the hamiltonian .",
    "moreover , the hamiltonian of spin systems provides valuable information for molecular structure analysis @xcite .    in dipolar coupled spin systems , such as molecules dissolved in liquid crystal solvents in nuclear magnetic resonance ( nmr ) experiments @xcite ,",
    "the hamiltonian is not naturally diagonal due to the interaction terms with dipolar couplings , which are usually too strong for the weakly coupling approximation to be satisfied .",
    "consequently , the spectra are usually very complex in multiple - spin systems , where the number of peaks corresponding to single coherence increases rapidly with the number of interacting spins . furthermore , in liquid crystal solvents ,",
    "the dipolar couplings depend on the solute s size and shape , and are scaled by the order parameters , which are sensitive to multiple factors , such as the characteristics of the solvents , magnetic fields , temperature , etc , making almost impossible the theoretical calculation for obtaining the dipolar couplings . first - order analysis of dipolar coupled spectra are usually not possible and the hamiltonian has to be diagonalized numerically .    measuring the parameters of dipolar coupled spin systems from nmr spectra is currently a hard problem .",
    "one approach , called pure frequency fitting , is to minimize by least squares the difference between the observable peak frequencies and the simulated transition frequencies @xcite .",
    "the major drawback of this approach is the requirement of spectral assignment , a manual procedure to determine which experimental peak corresponds to which simulated transition . to avoid spectral assignment ,",
    "the straightforward strategy is to fit the spectrum , directly obtained from the thermal state via nonselective pulses , using a least squares algorithm @xcite .",
    "this approach , called line shape fitting , is associated with immense computational resources and is seriously limited by the huge number of local minima .",
    "for this reason , evolutionary algorithms , which are able to search through many local minima , have been proposed and used for line shape fitting @xcite , with impressive but still limited success .",
    "these methods are unable to cope with a large search space , making them suitable mainly for molecules with high symmetry and accurately known geometrical structure @xcite . for both pure frequency",
    "fitting and line shape fitting methods , proper initial guess and bounds of the parameters are thus required to approach the desired solution .",
    "additional spectra are necessary for this purpose , where z - cosy @xcite and homonuclear decoupling @xcite techniques are helpful for obtaining crucial clues to estimate certain parameters .",
    "strategies based on multiple quantum coherence nmr @xcite have been developed to reduce the number of local minima , exploiting the fact that the number of higher order transitions is much less than the number of single order transitions .",
    "the high order transitions can be easily observed with 2d experiments .",
    "these experiments require the optimization of the delay during the preparation period and therefore usually consumes long measuring times .",
    "recently , theoretical strategies based on local control techniques were proposed through accessing the system partially and an experimental demonstration was implemented in three spins with well known hamiltonian using nmr @xcite .    in this article , we present nafons ( non - assigned frequency optimization of nmr spectra ) , a pure frequency fit program in which the spectral assignment problem is incorporated into a standard numerical optimization problem that can be addressed by a computer .",
    "our global optimization strategy is based on the injection of random perturbations designed to enable the solver to escape local minima .",
    "the spectra to be fitted are obtained by standard 1d experiments .",
    "experimentally nafons was applied to solve a 6-spin system with low symmetry , without prior knowledge of the interspin distances or order parameters and even without a first - order estimation of the parameters .",
    "the parameters of the hamiltonian are well estimated in a few minutes and with no operator intervention .",
    "molecules dissolved in liquid crystal solvents usually present vanishingly small intermolecular interactions and can be ignored .",
    "nevertheless , the intramolecular dipolar couplings are present and scaled down by the order parameters .",
    "the hamiltonian of the spin system can be represented as @xcite @xmath0 where @xmath1    @xmath2 , @xmath3 , @xmath4 denote the pauli matrices with @xmath5 indicating the spin location , @xmath6 denotes the chemical shift of spin @xmath5 , @xmath7 denotes the scalar coupling between spins @xmath5 and @xmath8 , and @xmath9 denotes the dipolar coupling .",
    "in nafons , the transition assignment is encoded in an objective function and each evaluation of this objective function will automatically determine a group of simulated transitions to those of the experimental group .",
    "then , nafons choose for the individual transitions within the two groups .",
    "spectral assignment can be modified at any step of the optimization of the parameters .    in practice ,",
    "the experimental frequencies of the @xmath10 peaks with largest integrals ( where @xmath10 is a suitable and sufficiently large number ) are extracted and stored in a vector @xmath11 .",
    "the optimization procedure has its start in an arbitrary hamiltonian parameters vector , @xmath12 and follows the next steps :    1 .",
    "find a minimizer @xmath13 of @xmath14 , where @xmath15 is the vector containing the frequencies , in increasing order , of the @xmath10 simulated transitions with largest integrals .",
    "2 .   update the initial guess : @xmath16 .",
    "3 .   do 1 to 2 again , but with a perturbation @xmath17 such that @xmath18 .",
    "4 .   do 1 to 3 until the global minimum is reached .    the way in which the objective function encodes the assignmet of the transitions considers that for each point of the parameter space , the group of simulated transitions is selected using their integrals and the assignment is done by sorting the frequencies in increasing order .",
    "this is a natural way of optimizing both the parameters and the assignment of the transitions .",
    "the problem to solve is represented as @xmath19 where @xmath20 is the vector of parameters , @xmath21 is the search domain , @xmath11 is the vector of sorted experimental frequencies , @xmath15 is the vector of sorted simulated frequencies and @xmath17 is a vector of random weights .",
    "the goal is to find a @xmath13 that is a solution to problem ( [ problem ] ) for any value of @xmath17 . in principle",
    ", this is possible only for the optimal solution , in which case all of the experimental and simulated peaks are in quasi - exact agreement , _",
    "i.e. _ @xmath22 . in this case",
    ", we have @xmath23 , such that for all @xmath24 , we have @xmath25 .    in a sense , this formulation of the problem is a way of avoiding suboptimal solutions by considering that the number of objective functions that we could globally minimize to get the hamiltonian is infinite .",
    "a large number of objective functions which do not share the same suboptimal solutions but that do share a same optimal solution were considered as was the fact that overlap , mainly for low error suboptimal solutions , may ocurr .",
    "this approach also took into consideration that the problem is greatly overdetermined , due to the redundancy of single order quantum coherence spectra and that only a few elements of @xmath17 are non - zero and still have a valid objective function @xmath26 . finding a solution to ( [ problem ] ) through the search of an @xmath13 that minimizes",
    "@xmath27 is the fist step .",
    "the second step includes the use of this @xmath13 as the initial guess for minimizing a randomly modified objective function of the form @xmath28 , where the elements of @xmath17 are chosen randomly to be either 0 or 1 .",
    "if the solution @xmath13 is a global minimizer of @xmath29 , then the solver will not modify the solution , otherwise the solver continues the optimization with the modified objective function @xmath26 .",
    "these last two steps can be done repeatedly in a @xmath30 times loop , where the loop has the form shown in the next equation @xmath31 the equilibrium state of this process is the commonly shared optimal solution .    the final step considers the use of an interior - point approach @xcite and the inclusion of pattern search @xcite to locate the optimum .",
    "once the solution is found , a least squares fit @xcite of the spectrum line shape is finally done to adjust the decoherence rates of each spin and the scalar couplings . as an altenative , a random walk approach in which the loop ( [ loop ] ) was replaced by a single step taken into the direction that minimizes @xmath29 followed by an other single step in the direction that minimizes a randomly chosen @xmath26 can also be used .",
    "a bruker 600 mhz avance spectrometer with a 5 mm dual @xmath32 probe was used to analyze the 6 spin system ( @xmath33 fluorine and @xmath34 protons ) of the 2,3 difluorobenzaldehide ( 23dfba , c@xmath35h@xmath36f@xmath37o ) , figure [ 2,3-dfba ] , dissolved in the liquid crystal zli-1132 .",
    "the temperature was controlled at @xmath38k .",
    "the full internal hamiltonian was obtained through the fitting different spectra : * 1 ) * fluorine spectrum with proton decoupling , * 2 ) * proton spectrum with fluorine decoupling , * 3 ) * spectra obtained by selective transition pulses based on spectrum 2 ) , * 4 ) * fluorine spectrum without proton decoupling , and * 5 ) * proton spectrum without fluorine decoupling .",
    "standard composite decoupling pulses , _",
    "i.e. _ garp @xcite were used to decouple fluorine spins and spinal-64 @xcite to decouple proton nuclei .",
    "the selective transition pulses were guassian shaped pulses with duration of @xmath39 ms .",
    "nafons approach was tested in a highly simplified configuration : the search was done directly on the chemical shifts and dipolar couplings ( without assuming or guessing the molecular geometry and order parameters ) , the optimization was done without a proper initial guess ( 0 hz for each parameter ) and without proper bounds ( @xmath402500 hz for each parameter ) , the diagonalizations of the hamiltonian were done with a general qz algorithm @xcite and the program was implemented in matlab .    the full internal hamiltonian parameters ( chemical shifts , @xmath41 and @xmath42 couplings ) are listed in table [ fulltable ] .",
    "the errors , shown in parenthesis , were estimated by comparing the values obtained from the different fitted spectra and by using the standard deviation considering gaussian noise .",
    "the fluorine spectrum is shown in figure [ fu ] , where the four transitions are present and used for optimization .",
    "convergence was reached within a second .",
    "the agreement between the simulation and the experiment present in figure [ fu]b , indicates a reliable estimation of the parameters .",
    "an extra  junk \" peak in the experimental spectrum at @xmath43hz was possibly due to the imperfection of the decoupling .",
    "the results for the chemical shifts ( in hz ) of f@xmath44 and f@xmath45 are : @xmath46 and @xmath47 with respect to a transmitter frequency .",
    "the result for the dipolar coupling ( in hz ) is : @xmath48 .",
    "the chemical shifts ( up to a scaling factor ) were further verified by a 2d experiment using lee goldburg decoupling technique @xcite . in this technique a radio frequency off resonance is applied according to @xmath49 causing an effective magnetic field in the rotating frame inclined at the magic angle ( in relation to the static magnetic field ) @xmath50 and therefore , the dipolar coupling is refocused and only the chemical shift evolves during @xmath51 . the values obtained using this technique were @xmath52 and @xmath53 hz for f(5 ) and f(6 ) respectively .",
    "the dipolar coupling obtained was @xmath54hz .",
    "the 1d proton spectrum of 23dfba is shown in figure [ pu ] .",
    "the 26 transitions with largest integrals were selected for optimization . for several trials ,",
    "convergence was usually reached within 10 minutes .",
    "the mean frequency error was 0.25 hz , probably due to line - overlap , which was not taken into consideration .",
    "the chemical shifts ( in hz ) for h@xmath55 , h@xmath56 , h@xmath57 and h@xmath58 are @xmath59 , @xmath60 , @xmath61 and @xmath62 respectively .",
    "the agreement between the simulation and the experiment is present in figure [ pu]b and indicates a reliable estimation of the couplings shown in table [ fulltable ] .",
    "some small differences in the relative heights of the transitions are present and might be explained as an imperfection in our way of modelling decoherence .    around -2000 hz , the cluster of transitions with strong decoherence corresponds to h@xmath55 .",
    "these transitions are closely distributed around its chemical shift value ( @xmath63hz ) whose dipolar coupling involving h@xmath55 are relatively small ( @xmath64 450 hz ) .",
    "the two sets of 4 transitions with high amplitudes on the extreme left and extreme right of the spectrum both correspond to a mix of h@xmath56 and h@xmath57 transitions .",
    "they are at the extremes of the spectrum due to the large coupling ( -2166 hz ) between h@xmath56 and h@xmath57 .",
    "the transitions corresponding to h@xmath58 are distributed on a width of @xmath65 hz around the centre of the spectrum .",
    "this is mainly due to the coupling between h@xmath57 and h@xmath58 ( -931 hz ) . in this case",
    "the experimental chemical shifts ( up to a scaling factor ) obtained by a 2d experiment using lee goldburg gave results quite different from those expected , h@xmath66 = @xmath67,h@xmath33 = @xmath68 , h@xmath69 = @xmath70 and h@xmath34 = @xmath71 .",
    "nevertheless , the results from table [ fulltable ] are consistent with the experimental data and were used in further experiments .      with the proton chemical shifts and proton homonuclear dipolar couplings sumarized in table [ fulltable ]",
    ", the proton hamiltonian can be diagonalized .",
    "each eigenvector can be expressed in the computational basis , _",
    "i.e. _ @xmath72 , @xmath73 and a map between transitions and energy levels can be built .",
    "there are about 10 well resolved peaks in figure [ pu](a ) that can be excited individually with transition selective pulses ( gaussian shaped , 20 ms ) .",
    "five experimental spectra obtained through transition selective pulses of certain lines are shown in figures [ tslec](b)-(f ) .",
    "figure [ tslec](a ) is the 1d proton decoupled from fluorine formerly used in figure [ pu](a ) and is at the top of figure [ tslec ] as a reference for figures [ tslec](b)-(f ) .",
    "figure [ tslec](g ) shows the full proton spectrum without fluorine decoupling .",
    "each of these 5 transitions corresponds to a density matrix , that can be written as the external product of the eigenstates involved in the transition , represented as @xmath74 where @xmath75 denotes one eigenstate of the proton hamiltonian .",
    "then , the decoupling channel is switched off so a proton coupled to fluorine spectrum is acquired and the heteronuclear coupling is evident .",
    "the resulting spectra is shown in figures [ tslec](h)-(l ) in the same order as in figures [ tslec](b)-(f ) for comparison .",
    "the corresponding states are @xmath76 where @xmath77 denotes a 4@xmath784 identity matrix , representing the state of the two fluorine spins .",
    "we use the @xmath79 as the input states to simultaneously analyze the spectra shown in figures [ tslec](h)-(l ) and extract all the heteronuclear dipolar couplings .",
    "the chemical shifts are allowed to vary @xmath80 from their values obtained with decoupling pulses . for several trials",
    ", convergence is usually reached within 10 minutes .",
    "once the full internal hamiltonian is obtained , these parameters were used to fit the complete fluorine and proton spectra using least squares on the spectral line shape , mainly to adjust the decoherence rate of the spins and the scalar couplings . during this fit",
    ", the hamiltonian parameters changed less than 1% from the values previously obtained .",
    "these changes were probably due to line - overlap , which was not taken into account during the pure frequency fit .",
    "these results for the fluorine and proton spectra are shown in figures [ fc ] and [ pc ] respectively and the parameters are listed in table [ fulltable ] . the @xmath81 ( in ms ) for h@xmath55 , h@xmath56 , h@xmath57 , h@xmath58 , f@xmath44 and f@xmath45 are respectively : @xmath82 , @xmath83 , @xmath84 @xmath85 , @xmath86 and @xmath87 .",
    "the selection of specific transitions helps to minimize the complexity of the spectrum with strong coupling as in molecules dissolved in liquid crystals .",
    "not only the number of transitions is much less , but the number of possible assignments for these remaining transitions is also reduced . for these experiments ,",
    "only 21 transitions are used to extract the heteronuclear dipolar couplings and 4!@xmath885!@xmath884!@xmath884!@xmath884 !",
    "assignments were possible instead of 21!. this experiment also made possible to identify which transitions should be used for the analysis , otherwise , the presence of overlap becomes an obstacle to this step .",
    "in the approach introduced by castellano and bothner - by @xcite , the differences between the observable peak frequencies and the simulated transition frequencies are minimized using a least squares algorithm .",
    "the well - known major drawback of this method is the requirement of spectral assignment , to establish which experimental peak correspond to which simulated transition . in traditional programs such as laocoonor @xcite , panic @xcite and lequor @xcite , both the parameters and the spectral assignment have to be adjusted by the operator before each trial fitting .",
    "successful attempts of automating the assignment procedure have been reported in programs such as paremus @xcite and mimer @xcite , but these are limited to simple solutes in isotropic solvents .",
    "thus , in traditional pure frequency fitting algorithms , the procedure of spectral assignment is still the most decisive and difficult step , rapidly rendering them impossible to apply , especially when the molecular geometry and orientational parameters are unknown or difficult to guess .",
    "automatic methods which do not require spectral assignment have been developed as an alternative .",
    "these approaches , called integral transform ( it ) and total line shape ( tls ) , use the full spectral line shape . in the it approach , introduced by diehl , skora and vogt @xcite ,",
    "the spectrum is transformed into a small set of coefficients by means of linear integral transforms using orthogonal bases .",
    "the differences between the coefficients obtained from the experimental spectrum and those obtained from the simulated one are minimized with a standard optimization routine . in the tls approach ,",
    "the total line shape of the nmr spectrum is fitted .",
    "the idea was first demonstrated by glidewell , rankin and sheldrick @xcite , and also studied by heinzer @xcite . a matrix method derived from a general formulation of the least squares problem",
    "was then developed by stephenson and binsch @xcite .",
    "the originality in their method was the use of cross - correlation functions to smooth the landscape , other techniques such as spectrum broadening @xcite and integral curves @xcite have also been proposed for this purpose .",
    "this method , and its subsequent modifications - daisy @xcite and win - daisy @xcite , were later improved by the use of genetic algorithms ( ga s ) @xcite , which are able to search through many basin of attractions .",
    "it is known that for ga s , when the search ranges become too large , there is insufficient coverage of the parameter space to locate the global minimum @xcite .",
    "some improvements can be obtained by the use of evolutionary strategies ( es s ) , which usually converge faster than ga s @xcite .",
    "evolutionary algorithms such as ga s and es s are thus suitable only for molecules with high symmetry and with accurately known geometrical structure @xcite . in general , both the it and tls approaches suffer from severe limitations : they are computationally much slower than frequency fitting @xcite ; their global optimization strategy is either absent or operational only in small search spaces ; the operator has hardly any means of interacting with the program to increase its efficiency . due to these limitations , automatic analysis",
    "is not routinely employed @xcite , and the castellano - bothner - by approach is still by far the most widely used @xcite , despite the requirement of spectral assignment .",
    "the originality of our approach can now be seen : it is a pure frequency fit program which incorporates the spectral assignment problem into a standard numerical optimization problem that can be addressed by a computer .",
    "in contrast with traditional automatic methods , evaluation of the objective function does not require the expensive computation of the spectral line shape .",
    "moreover , our global optimization strategy , based on the injection of randomness , is able to cover a large search space without getting trapped in local minima .",
    "the most interesting feature of our approach is perhaps its compatibility with operator interventions .",
    "in fact , at any moment , the operator could pause the program , so as to visually compare the spectra and possibly choose to impose constraints on the spectral assignment , gradually removing the suboptimal attractors from the landscape .",
    "nafons new approach successfully addresses the fundamental problems usually encountered in spectral analysis .",
    "a new method for solving nmr spectra of solutes dissolved in liquid - crystals is shown as well as an experiemental application to solve a 6-spin system with very low symmetry .",
    "this was done without prior knowledge or assumptions on the interspin distances or order parameters , which contrasts with previous results in @xcite .",
    "this method includes a new spectral analysis program - nafons , and experimental techniques to simplify spectral analysis for extracting the dipolar couplings between heteronuclear spins .",
    "in contrast with traditional pure frequency fitting methods @xcite , nafons does not require spectral assignment and is fully automatic .",
    "as for line shape fitting methods @xcite , evaluation of an objective function does not involve the expensive computation of the spectral line shape and the global optimization strategy can cope with a large search space .",
    "these results should be helpful to implement spectral analysis of dipolar coupled systems and can be extended to larger systems . using these methods ,",
    "it is now possible to create a library of molecules for chemical structure analysis that can be used as well in other fields such as quantum information processing and quantum computing .",
    "the authors acknowledge professor d. g. cory , professor d. suter , dr .",
    "o. moussa and dr .",
    "d. burgarth for helpful discussions .",
    "+ nafons program can be obtained upon request at trottier.denis.alexandre@gmail.com .",
    "p. diehl , and c. l. khetrapal , _ nmr basic principles and progress _ vol . 1 , ( springer - verlag , berlin , 1969 ) ; j. w. emsley , and j. c. lindon , _ nmr spectroscopy using liquid crystal solvents _",
    "( pergamon press , oxford , 1975 ) .",
    "e. e. burnell , c. a. de lange , and w. leo meerts , ",
    "novel strategies for solving highly complex nmr spectra of solutes in liquid crystals \" , in _ nuclear magnetic resonance spectroscopy of liquid crystals _ edited by ronald y. dong .",
    ".full internal hamiltonian of 2,3-difluorobenzaldehyde measured in the liquid crystal solvent zli-1132 .",
    "the chemical shifts ( in hz ) are shown in the diagonal and are with respect to transmitter frequency at 600.13hz and 564.62 mhz for proton and fluorine spins respectively .",
    "the scalar couplings ( @xmath41 ) are shown in the lower part of the diagonal and were obtained by the conventional 2d nmr experiments , e.g. j - resolved , cosy , etc .",
    "and the dipolar couplings ( @xmath42 ) are in the higher part of the diagonal and were obtained through the nafons method .",
    "the numbers in parenthesis are the errors obtained . [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> measuring the hamiltonian of dipolar coupled spin systems is usually a difficult task due to the high complexity of their spectra . </S>",
    "<S> currently , molecules with unknown geometrical structure and low symmetry are extremely tedious or impossible to analyze by sheer spectral fitting . </S>",
    "<S> we present a novel method that addresses the problem of spectral analysis , and report experimental results of extracting , by spectral fitting , the parameters of an oriented 6-spin system with very low symmetry in structure , without using _ a priori _ knowledge or assumptions on the molecular geometry or order parameters . </S>",
    "<S> the advantages of our method are achieved with the use of a new spectral analysis algorithm - nafons ( non - assigned frequency optimization of nmr spectra ) , and by the use of simplified spectra obtained by transition selective pulses . </S>",
    "<S> this new method goes beyond the limit of spectral analysis for dipolar coupled spin systems and is helpful for related fields , such as quantum computation and molecular structure analysis . </S>"
  ]
}