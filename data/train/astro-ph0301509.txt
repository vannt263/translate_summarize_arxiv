{
  "article_text": [
    "quasars , active galactic nuclei ( agn ) , x - ray binaries , gamma - ray bursts , and core - collapse supernovae are all likely powered by a central engine subject to strong gravity , strong electromagnetic fields , and rotation . for convenience",
    ", we will refer to this class of objects as _ relativistic magneto - rotators _ ( rmrs ) .",
    "rmrs are among the most luminous objects in the universe and are therefore the center of considerable theoretical attention .",
    "unfortunately the governing physical laws for rmrs , while well known , are nonlinear , time - dependent , and intrinsically multidimensional .",
    "this has stymied development of a first - principles theory for their evolution and observational appearance and strongly motivates a numerical approach .    to fully understand rmr structure , one must be able to follow the interaction of a non - maxwellian plasma with a relativistic gravitational field , a strong electromagnetic field , and possibly a strong radiation field as well .",
    "this general problem remains beyond the reach of today s algorithms and computers .",
    "a useful first step , however , might be to study these objects in a nonradiating magnetohydrodynamic ( mhd ) model . in this case",
    "the plasma can be treated as a fluid , greatly reducing the number of degrees of freedom , and the radiation field can be ignored .",
    "the relevance of this approximation must be evaluated in astrophysical context and will not be considered here .",
    "we were motivated , therefore , to develop a method for integrating the equations of ideal , general relativistic mhd ( grmhd ) , and that method is described in this paper .",
    "this is in a sense well - trodden ground : many schemes have already been developed for relativistic fluid dynamics . what has not existed until recently is a scheme that : ( 1 ) includes magnetic fields ; ( 2 ) has been fully verified and convergence tested ; ( 3 ) is stable and capable of integrating a flow over many dynamical times .",
    "a pioneering grmhd code has been developed by koide and collaborators ( e.g. @xcite , @xcite , @xcite , @xcite ) .",
    "our code code differs in that we have subjected it to a fuller series of tests ( described in this paper ) , we can perform longer integrations than the rather brief simulations described in the published work of koide s group , and our code explicitly maintains the divergence - free constraint on the magnetic field . a grmhd godunov scheme based on a roe - type approximate",
    "riemann solver has been developed by komissarov and described in a conference proceeding @xcite .",
    "a rather complete review of numerical approaches to relativistic fluid dynamics is given by @xcite and @xcite .",
    "the first numerical grmhd scheme that we are aware of is by @xcite , who integrated the grmhd equations in axisymmetry near a kerr black hole .",
    "while it was recognized throughout the 1970s that relativistic mhd would be relevant to problems related to black hole accretion ( particularly following the seminal work of @xcite and @xcite ; see also @xcite ) , no further work appeared until @xcite .",
    "the discovery by @xcite that magnetic fields play a crucial role in regulating accretion disk evolution ( reviewed in @xcite ) and the absence of purely hydrodynamic means for driving accretion in disks @xcite further motivated the development of relativistic mhd schemes .",
    "more recently there have been several efforts to develop grmhd codes , including the already - mentioned work by koide and collaborators and by komissarov .",
    "a zeus - like scheme for grmhd has also been developed and is described in a companion paper @xcite .",
    "special relativistic mhd ( srmhd ) is the foundation for any grmhd scheme , although there are nontrivial problems in making the transition to full general relativity .",
    "srmhd schemes have been developed by @xcite and @xcite .",
    "we were particularly influenced by the clear development of the fundamental equations in @xcite for his godunov srmhd scheme based on a roe - type approximate riemann solver , and by the work of @xcite and @xcite who chose to use the simple approximate riemann solver of @xcite in their special relativistic hydrodynamics and srmhd schemes , respectively .",
    "our numerical scheme is called harm , for high accuracy relativistic magnetohydrodynamics . in the next section",
    "we develop the basic equations in the form used for numerical integration in harm (  2 ) . in  3 we describe the basic algorithm . in ",
    "4 we describe the performance of the code on a series of test problems . in  5",
    "we describe a sample evolution of a magnetized torus near a rotating black hole .",
    "the equations of general relativistic mhd are well known , but for clarity we will develop them here in the same form used in numerical integration . unless otherwise noted @xmath0 and we follow the notational conventions of @xcite , hereafter mtw .",
    "the reader may also find it useful to consult @xcite .",
    "the first governing equation describes the conservation of particle number : @xmath1 here @xmath2 is the particle number density and @xmath3 is the four - velocity . for numerical purposes we rewrite this in a coordinate basis , replacing @xmath2 with the `` rest - mass density '' @xmath4 , where @xmath5 is the mean rest - mass per particle : @xmath6 here @xmath7 .",
    "the next four equations express conservation of energy - momentum : @xmath8 where @xmath9 is the stress - energy tensor . in a",
    "coordinate basis , @xmath10 where @xmath11 denotes a spatial index and @xmath12 is the connection .",
    "the energy - momentum equations have been written with the free index down for a reason .",
    "symmetries of the metric give rise to conserved currents . in the kerr metric , for example ,",
    "the axisymmetry and stationary nature of the metric give rise to conserved angular momentum and energy currents .",
    "in general , for metrics with an ignorable coordinate @xmath13 the source term on the right hand side of the evolution equation for @xmath14 vanish .",
    "these source terms do not vanish when the equation is written with both indices up .",
    "the stress - energy tensor for a system containing only a perfect fluid and an electromagnetic field is the sum of a fluid part , @xmath15 ( here @xmath16 internal energy and @xmath17 pressure ) and an electromagnetic part , @xmath18 here @xmath19 is the electromagnetic field tensor ( mtw : `` faraday '' ) , and for convenience we have absorbed a factor of @xmath20 into the definition of @xmath21 .",
    "the electromagnetic portion of the stress - energy tensor simplifies if we adopt the ideal mhd approximation , in which the electric field vanishes in the fluid rest frame due to the high conductivity of the plasma ( `` @xmath22 '' ) .",
    "equivalently the lorentz force on a charged particle vanishes in the fluid frame : @xmath23 it is convenient to define the magnetic field four - vector @xmath24 where @xmath25 is the levi - civita _ tensor_. recall that ( following the notation of mtw ) @xmath26 $ ] , where @xmath27 $ ] is the completely antisymmetric symbol and @xmath28 or @xmath29 .",
    "these can be combined ( with the aid of identity 3.50h of mtw ) : @xmath30 substitution and some manipulation ( using identities 3.50 of mtw and @xmath31 ; the latter follows from the definition of @xmath32 and the antisymmetry of @xmath21 ) yields @xmath33 notice that the last two terms are nearly identical to the nonrelativistic mhd stress tensor , while the first term is higher order in @xmath34 . to sum up , @xmath35 is the mhd stress - energy tensor .",
    "the electromagnetic field evolution is given by the source - free part of maxwell s equations @xmath36 the rest of maxwell s equations determine the current @xmath37 and are not needed for the evolution , as in nonrelativistic mhd .",
    "maxwell s equations can be written in conservative form by taking the dual of eq.([maxa ] ) : @xmath38 here @xmath39 is the dual of the electromagnetic field tensor ( mtw : `` maxwell '' ) . in ideal mhd @xmath40 which can be proved by taking the dual of eq.([fdef ] ) .",
    "the components of @xmath41 are not independent , since @xmath42 . following , e.g. , @xcite , it is useful to define the magnetic field three - vector @xmath43 . in terms of @xmath44 , @xmath45 @xmath46 the space components of the induction equation then reduce to @xmath47 and the time component reduces to @xmath48 which is the no - monopoles constraint .",
    "the appearance of @xmath44 in these last two equations are what motivates the introduction of the field three - vector in the first place .",
    "to sum up , the fundamental equations as used in harm are : the particle number conservation equation ( [ partnocons ] ) ; the four energy - momentum equations ( [ ener_mom ] ) , written in a coordinate basis and using the mhd stress - energy tensor of equation ( [ tmunumhd ] ) ; and the induction equation ( [ induction ] ) , subject to the constraint ( [ divb ] ) .",
    "these hyperbolic equations are written in conservation form , and so can be solved numerically by well - known techniques .",
    "there are many possible ways to numerically integrate the grmhd equations .",
    "a first , zeroth - order choice is between conservative and nonconservative schemes . nonconservative schemes such as zeus @xcite have enjoyed wide use in numerical astrophysics .",
    "they permit the integration of an internal energy equation rather than a total energy equation .",
    "this can be advantageous in regions of a flow where the internal energy is small compared to the total energy ( highly supersonic flows ) , which is a common situation in astrophysics .",
    "a nonconservative scheme for grmhd following a zeus - like approach has been developed and is described in a companion paper @xcite .",
    "we have decided to write a conservative scheme .",
    "one advantage of this choice is that in one dimension , total variation stable schemes are guaranteed to converge to a weak solution of the equations by the lax - wendroff theorem @xcite and by a theorem due to @xcite . while no such guarantee is available for multidimensional flows ,",
    "this is a reassuring starting point .",
    "furthermore , one is guaranteed that a conservative scheme in any number of dimensions will satisfy the jump conditions at discontinuities .",
    "this is not true in artificial viscosity based nonconservative schemes , which are also known to have trouble in relativistic shocks @xcite .",
    "conservative schemes for grmhd have also been developed by @xcite and by @xcite .",
    "a conservative scheme updates a set of `` conserved '' variables at each timestep .",
    "our vector of conserved variables is @xmath49 these are updated using fluxes @xmath50 .",
    "we must also choose a set of `` primitive '' variables , which are interpolated to model the flow within zones .",
    "we use variables with a simple physical interpretation : @xmath51 here @xmath52 is the 3-velocity . as primitive variables , but the inversion @xmath53 is not always single - valued , e.g. inside the ergosphere of a black hole .",
    "that is , there are physical flows with the same value of @xmath54 but different values of @xmath55 . ]",
    "the functions @xmath56 and @xmath57 are analytic , but the inverse operations ( so far as we can determine ) are not .",
    "can be reduced analytically to the solution of a single , nonlinear equation .",
    "] there is also no simple expression for @xmath58 .    to evaluate @xmath56 and",
    "@xmath57 one must find @xmath55 and @xmath41 from @xmath59 and @xmath44 . to find @xmath55 , solve the quadratic equation @xmath60 .",
    "next use equations ( [ btsol ] ) and ( [ bisol ] ) to find @xmath41 ; these require only multiplications and additions .",
    "the remainder of the calculation of @xmath56 and @xmath57 requires raising and lowering of indices followed by direct substitution in equation ( [ tmunumhd ] ) to find the components of the mhd stress - energy tensor .",
    "since we update @xmath61 rather than @xmath62 , we must solve for @xmath63 at the end of each timestep .",
    "we use a multidimensional newton - raphson routine with the value of @xmath62 from the last timestep as an initial guess .",
    "since @xmath44 can be obtained analytically , only 5 equations need to be solved .",
    "the newton - raphson method requires an expensive evaluation of the jacobian @xmath64 . in practice",
    "we evaluate the jacobian analytically .",
    "it is possible to evaluate the jacobian by numerical derivatives , but this is both expensive and a source of numerical noise .",
    "the evaluation of @xmath63 is at the heart of our numerical scheme ; the procedure must be robust .",
    "we have found that it is crucial that the errors ( differences between the current and target values of @xmath61 ) used to evaluate convergence in the newton - raphson scheme be properly normalized .",
    "we normalized the errors with @xmath65 .",
    "to evaluate @xmath50 we use a muscl type scheme with `` hll '' fluxes @xcite .",
    "the fluxes are defined at zone faces .",
    "a slope - limited linear extrapolation from the zone center gives @xmath66 and @xmath67 , the primitive variables at the right and left side of each zone interface .",
    "we have implemented the monotonized central ( `` woodward '' , or `` mc '' ) limiter , the van leer limiter , and the minmod limiter ; unless otherwise stated , the tests described here use the mc limiter , which is the least diffusive of the three .    from @xmath68",
    ", calculate the maximum left and rightgoing wave speeds @xmath69 , and the fluxes @xmath70 and @xmath71 . defining @xmath72 and @xmath73 , the hll flux is then @xmath74 if @xmath75 , the hll flux becomes the so - called local lax - friedrichs flux .",
    "the pure hll scheme will not preserve any numerical representation of @xmath76 .",
    "an incomplete list of options for handling this constraint numerically includes : ( 1 ) ignore the production of monopoles by truncation error and hope for the best ( in our experience this causes the scheme to fail in any complex flow ) ; ( 2 ) introduce a divergence - cleaning step ( this entails solving an elliptic equation at each timestep ) ; ( 3 ) use an @xcite type constrained transport scheme ( this requires a staggered mesh , so that the magnetic field components are zone face centered ) ; ( 4 ) introduce a diffusion term that causes numerically generated monopoles to diffuse away ( @xcite ; this typically leaves a monopole field with rms value somewhat larger than the truncation error ) .",
    "we have chosen a fifth option , a version of constrained transport that can be used with a zone - centered scheme .",
    "this idea was introduced by one of us in @xcite , where it is called the flux - interpolated constrained transport ( or `` flux - ct '' ) scheme .. this appears to be slightly less robust .",
    "it also has a larger effective stencil .",
    "] it preserves a numerical representation of @xmath76 by smoothing the fluxes with a special operator .",
    "the disadvantage of this method is that it is more diffusive than the `` bare '' , unconstrained scheme .",
    "the advantage is that it is extremely simple .    to clarify",
    "how zone - centered constrained transport works we now give a specific example for a special relativistic problem in cartesian coordinates @xmath77 . to fix notation , write the induction equation as @xmath78 where we have used @xmath79 and the fluxes @xmath80 are @xmath81 notice that the fluxes are centered at different locations on the grid : @xmath82 fluxes live on the @xmath83 face of each zone at grid location @xmath84 ( we use @xmath85 to denote the center of each zone ) , while @xmath86 fluxes live on the @xmath87 face at @xmath88 .",
    "the smoothing operator replaces the numerical ( hll - derived ) @xmath89 with @xmath90 , defined by @xmath91 \\\\",
    "\\tilde{f}^x_y(i-1/2,j ) & = & { 1\\over{8 } } \\bigl [ 2 f^x_y(i-1/2 , j ) \\\\   & & + f^x_y(i-1/2 , j+1 ) + f^x_y(i-1/2 , j-1 ) \\\\   & & - f^y_x(i , j-1/2 ) - f^y_x(i , j+1/2 ) \\\\   & & - f^y_x(i-1 , j-1/2 ) - f^y_x(i-1 , j+1/2 ) \\bigr ] \\end{array}\\ ] ] it is a straightforward but tedious exercise to verify that this preserves the following corner - centered numerical representation of @xmath92 : @xmath93 where @xmath94 and @xmath95 are the grid spacing .",
    "the hll approximate riemann solver does not require eigenvectors of the characteristic matrix ( as would a roe - type scheme ) , but it does require the maximum and minimum wave speed ( eigenvalues ) .",
    "these wave speeds are also required to fix the timestep via the courant conditions .",
    "the relevant speed is the phase speed `` @xmath96 '' of the wave , and it turns out that only speeds for waves with wavevectors aligned along coordinate axes are required .",
    "suppose , for example , that one needs to know how rapidly signals propagate in the fluid along the @xmath97 direction .",
    "first , find a wavevector @xmath98 , that satisfies the dispersion relation for the mode in question : @xmath99 .",
    "then the wave speed is simply @xmath100 .",
    "the dispersion relation @xmath101 for mhd waves has a simple form in a comoving frame . in terms of the relativistic sound speed @xmath102 , ( the last holds only if @xmath103 ) and the relativistic alfvn velocity @xmath104 , where @xmath105 and @xmath106 , the dispersion relation is @xmath107 here @xmath108 is the ( temporarily reintroduced ) speed of light .",
    "the first term is the zero frequency entropy mode , the second is the alfvn mode , and the third contains the fast and slow modes .",
    "the eighth mode is eliminated by the no - monopoles constraint .",
    "the relativistic sound speed asymptotes to @xmath109 for @xmath110 , and the alfvn speed asymptotes to @xmath108 . in the limit that @xmath111 and @xmath112 , the grmhd equations are a superset of the time - dependent , force - free electrodynamics equations recently discussed by @xcite ; these contain fast modes and alfvn modes that move with the speed of light .",
    "they are indistinguishable from vacuum electromagnetic modes only when their wavevector is oriented along the magnetic field .    to find the maximum wave speeds we need to evaluate the comoving - frame dispersion relation for the fast wave branch from coordinate frame quantities .",
    "this is straightforward because the dispersion relation depends on scalars , which can be evaluated in any frame : @xmath113 ; @xmath114 , where @xmath115 is the part of the wavevector normal to the fluid 4-velocity ; @xmath116 ; @xmath117 .",
    "the relevant portion of the dispersion relation ( for fast and slow modes ) is thus a fourth order polynomial in the components of @xmath118 .",
    "this can be solved either analytically or by standard numerical methods .",
    "the two fast mode speeds are then used as @xmath119 and @xmath120 in the hll fluxes .",
    "we have found it convenient to replace the full dispersion relation by an approximation : @xmath121 this overestimates the maximum wavespeed by a factor @xmath122 in the comoving frame .",
    "the maximum error occurs for @xmath123 and @xmath124 , and it is usually much less , particularly if the fluid is moving super - alfvnically with respect to the grid .",
    "this approximation is convenient because it is quadratic in @xmath118 , and so can be solved more easily .      for completeness",
    "we now give some details of the implementation of the algorithm .",
    "* time stepping . * our scheme is made second order in time by taking a half - step from @xmath125 to @xmath126 , evaluating @xmath127 , and using that to update @xmath128 to @xmath129 .",
    "* modification of energy equation .",
    "* a direct implementation of the energy equation can be inaccurate because the magnetic and internal energy density can be orders of magnitude smaller than the rest mass density . to avoid this we subtract the particle number conservation equation from the energy equation , i.e. , we evolve @xmath130 in the nonrelativistic limit , this procedure subtracts the rest mass energy density from the total energy density .",
    "* specification of geometric quantities . * in two dimensions we need to evaluate @xmath131 and @xmath132 at four points in every grid zone ( the center , two faces , and one corner ) and @xmath133 at the zone center .",
    "it would be difficult to accurately encode analytic expressions for all these quantities .",
    "harm is coded so that an analytic expression need only be provided for @xmath134 ; all other geometric quantities are calculated numerically .",
    "the connection , for example , is obtained to sufficient accuracy by numerical differentiation of the metric .",
    "this minimizes the risk of coding errors in specifying the geometry .",
    "it also minimizes coordinate dependent code , making it relatively easy to change coordinate systems .",
    "minimal coordinate dependence , besides following the spirit of general relativity , enables one to perform a sort of fixed mesh refinement by adapting the coordinates to the problem at hand .",
    "for example , near a kerr black hole we use @xmath135 as the radial coordinate instead of the usual boyer - lindquist @xmath136 , and this concentrates numerical resolution toward the horizon , where it is needed .    * density and internal energy floors . * negative densities and internal energies are forbidden by the grmhd equations , but numerically nothing prevents their appearance .",
    "in fact , negative internal energies are common in numerical integrations with large density or pressure contrast . following common practice , we prevent this by introducing `` floor '' values for the density and internal energy .",
    "these floors are enforced after the half - step and the full step .",
    "they preserve velocity but do not conserve rest mass or energy - momentum",
    ".    * outflow boundary conditions . * in the rotating black hole calculations described below we use outflow boundary conditions at the inner and outer radial boundaries .",
    "the usual implementation of outflow boundary conditions is to simply copy the primitive variables from the boundary zones into the ghost zones .",
    "this can result in unphysical values of the primitive variables in the ghost zones for example , velocities that lie outside the light cone because of variations in the metric between the boundary and ghost zones .",
    "we have experimented with a variety of schemes for projecting variables into the ghost zones in the context of black hole accretion flow calculations ( described in  5 ) .",
    "we find that some are more robust than others .",
    "the most robust extrapolates the density , internal energy , and radial magnetic field according to @xmath137 the @xmath138 and @xmath139 components of the velocity and magnetic field according to @xmath140 and the radial velocity according to @xmath141 the extrapolation of @xmath138 and @xmath139 components of magnetic field and velocity results in weak damping of these components near the boundary .",
    "slightly different choices of the extrapolation coefficients ( i.e. @xmath142 ) are much less robust .    * performance . * we have implemented both serial and parallel versions of the code . in serial mode the code integrates the black hole accretion problem ( described in  5 ) at @xmath143 zone cycles per second on a 2.4 ghz intel pentium 4 , when compiled using the intel c compiler .",
    "the parallel code was implemented using mpi .",
    "here we present a test suite for verifying a grmhd code .",
    "the tests are nonrelativistic , special and general relativistic , and one and two dimensional .",
    "the list of problems for which there are known , exact solution is short , since exact solutions of multidimensional grmhd problems are algebraically complicated .",
    "this list of test problems was developed in collaboration with j. hawley and j .- p .",
    "de villiers . unless otherwise stated we set @xmath110 and @xmath0 .",
    "this first test considers the evolution of a small amplitude wave in two dimensions .",
    "the unperturbed state is @xmath144 , @xmath145 , @xmath146 , @xmath147 , @xmath148 . the basic state is parametrized by @xmath149 ; our fiducial test runs have @xmath150 . onto this basic state",
    "we introduce a perturbation of the form @xmath151 , where @xmath152 , and the amplitude is fixed by @xmath153 .",
    "the computational domain is @xmath154 , and the boundary conditions are periodic .",
    "the wave is either slow , alfvnic , or fast .",
    "this test exercises almost all terms in the governing equations .",
    "the numerical resolution is @xmath155 zones , and the integration runs for a single wave period @xmath156 , so that a perfect scheme would return the simulation to its original state .",
    "we measure the @xmath157 norm of the difference between the final state and the initial state for each primitive variable .",
    "for example , we measure @xmath158 for the density .",
    "all primitive variables exhibit similar convergence properties ( as they must , since with the exception of the magnetic field , they are tightly coupled together ) . in figures",
    "[ fig - b ] , [ fig - c ] , and [ fig - d ] we present the @xmath157 norm of the error for runs using the monotonized central limiter and a courant number of @xmath159 , in addition to the results for the minmod limiter . these runs have @xmath160 . figure [ fig - b ] shows the results for the slow wave , figure [ fig - c ] for the wave , and figure [ fig - d ] for the fast wave .",
    "evidently the convergence rate asymptotes to second order , although more slowly for the minmod limiter .",
    "the code performs similarly well over a range of @xmath161 , provided only that @xmath162 , which is necessary for the wave to be in the linear regime .",
    "we have been unable to find a value of @xmath163 where the code fails completely for a linear amplitude disturbance , although for very large values of @xmath163 the evolution becomes inaccurate because of numerical noise in the evaluation of @xmath63 .",
    "@xcite has proposed a suite of one - dimensional nonlinear tests for special relativistic mhd .",
    "komissarov presents a total of 9 tests ( see his table 1 ) .",
    "the nonlinear alfvn wave ( test 5 ) , and the compound wave ( test 6 ) can not be reconstructed without a separate derivation of the exact analytic solution , and we will not provide that here . for the remaining tests",
    "komissarov s table 1 contains several misprints that are corrected in @xcite .",
    "our code is able to integrate each of komissarov s remaining 7 tests , although in some cases we must reduce the courant number ( usually @xmath159 ) or resort to the slightly more robust van leer slope limiter .",
    "tests that required special treatment are : fast shock ( courant number @xmath164 ) ; shock tube 1 ( courant number @xmath165 , van leer limiter ) ; shock tube 2 ( courant number @xmath164 ) ; collision ( courant number @xmath166 ; van leer limiter ) .",
    "figures [ fig - e ] and [ fig - f ] show the run of @xmath167 and @xmath168 , respectively , for all 7 tests .",
    "these may be compared with komissarov s figures .",
    "notice that , unlike komissarov , we have in all cases set @xmath169 and @xmath170 .",
    "we have not obtained the exact solutions used by komissarov , but the solutions can still be checked quantitatively . for example , the slow shock wave speed is @xmath171 ; since the calculation ends at @xmath172 the slow shock front should be , and is , located at @xmath173 .",
    "the fast shock speed is @xmath174 , so at @xmath175 the fast shock wave front should be , and is , located at @xmath176 .",
    "there are artifacts evident in the figures .",
    "in particular there is ringing near the base of the switch - on and switch - off rarefaction waves .",
    "this is common and is seen in komissarov s results as well .",
    "in addition the narrow , lorentz - contracted shell of material behind the shock in shock tube 1 is poorly resolved ; the correct shell density is @xmath177 but a resolution of @xmath178 is required to find this result to an accuracy of a few percent .",
    "there is also a transient associated with the fast shock that propagates off the grid and so is not visible in figures [ fig - e ] and [ fig - f ] .    a complete set of nonlinear wave tests for one dimensional _ nonrelativistic _",
    "mhd was developed by @xcite ( hereafter rj ) .",
    "we can run these under harm by rescaling the speed of light to @xmath179 in code units , where all velocities in the tests are @xmath180 .",
    "this should lead to results that agree with rj to @xmath181 .",
    "the results can be checked quantitatively by comparison to the tables provided by rj .",
    "figure [ fig - g ] shows our results for rj test 5a , which is a version of the familiar @xcite magnetized shock tube test . like",
    "rj we use @xmath182 zones between @xmath183 and @xmath184 , and we measure the results at @xmath185 . to compare to rj quantitatively , consider @xmath186 in the region behind the fast rarefaction wave , near @xmath187 .",
    "rj report @xmath188 here , while we measure @xmath189 , which differs by @xmath190 , as expected .",
    "similar agreement is found for the other variables .",
    "the most unsatisfactory feature of the solution is the visible post - shock oscillations .",
    "the amplitude of these features varies , depending on the courant number ( here @xmath191 ) and the choice of slope limiter ( here mc ) .",
    "figure [ fig - h ] shows our results for rj test 2a . in the region near @xmath192 ,",
    "rj report that @xmath193 , and we find essentially exact agreement ( @xmath194 ) after averaging over a small region near @xmath192 .",
    "this test has two pairs of closely spaced slow shocks and rotational discontinuities that are difficult to resolve , and our scheme barely obtains the correct peak values of @xmath195 and @xmath196 , even though there are about @xmath197 zones inside the `` horns '' visible in the @xmath196 panel of the figure .",
    "this special relativistic test evolves a disk of enhanced density moving at an angle to the grid until it returns to its original position .",
    "the computation is carried out in a domain @xmath198 and the boundary conditions are periodic .",
    "the initial state has @xmath199 , or @xmath200 , corresponding to @xmath201 . the initial density @xmath144 except in a disk at @xmath202 , where @xmath203 . the initial pressure @xmath204 , and the initial magnetic field is zero .",
    "the test is run until @xmath205 , when the system should return exactly to its initial state .",
    "numerically , we use the monotonized central limiter and set the courant number to @xmath159 . the resolution is fixed so that @xmath206 . figure [ fig - a ] shows the @xmath207 norm of the error in @xmath167 as a function of @xmath83 resolution .",
    "the convergence rate asymptotes to second order .",
    "the orszag - tang vortex ( otv ) is a classic nonlinear mhd problem @xcite .",
    "here we compare our code , with the speed of light set to @xmath208 so that that it is effectively nonrelativistic , to the output of vac @xcite , an independent nonrelativistic code developed by one of us .",
    "the version of vac used here is tvd - muscl using the monotonized central limiter .",
    "it is dimensionally unsplit and uses a scheme similar to harm to control @xmath209 .",
    "the problem is integrated in the periodic domain @xmath210 $ ] , @xmath211 $ ] from @xmath212 to @xmath213 .",
    "our version of the otv has @xmath110 , but is otherwise identical to the standard problem .",
    "results are shown in figure [ fig - n ] , which shows @xmath167 along a cut through the model at @xmath214 and @xmath213 .",
    "the resolution is @xmath215 .",
    "the solid line shows the results from harm ; the dashed line shows the results from vac .",
    "the lower solid line shows the difference between the two multiplied by @xmath216 .",
    "evidently our code behaves similarly to vac on this problem .",
    "we can quantify this by asking how the difference between the harm and vac solutions changes as a function of resolution .",
    "figure [ fig - p ] shows the variation in the @xmath157 norm of the difference between the two solutions .",
    "thus the line marked @xmath167 shows @xmath217 evaluated at @xmath213 .",
    "the codes converge to one another approximately linearly , as expected for a flow containing discontinuities .",
    "if this study were extended to higher resolution convergence would eventually cease because the harm solution would differ from the vac solution due to finite relativistic corrections .",
    "spherically symmetric accretion ( bondi flow ) in the schwarzschild geometry has an analytic solution ( see , e.g. , @xcite ) that can be compared with the output of our code .",
    "this appears to be a one - dimensional test , but for harm it is actually two dimensional .",
    "although the pressure is independent of the boyer - lindquist coordinate @xmath138 , the @xmath138 acceleration does not vanish identically .",
    "this is because pressure enters the momentum equations through a flux ( @xmath218 in the newtonian limit ) and a source term ( @xmath219 in the newtonian limit ) .",
    "analytically these terms cancel ; numerically they produce an acceleration that is of order the truncation error .",
    "our test problem follows that set out in @xcite : we fix the sonic point @xmath220 , @xmath221 , and @xmath110 .",
    "the problem is integrated in the domain @xmath222 for @xmath223 .",
    "we use coordinates based on the kerr - schild system , whose line element is @xmath224 where we have set @xmath225 . in ( [ ksline ] ) only @xmath226 ; elsewhere @xmath167 is density . in this test , @xmath227 .",
    "we modify these coordinates by replacing @xmath136 by @xmath228 .",
    "the new coordinates are implemented by changing the metric rather than changing the spacing of grid zones .",
    "we measure the @xmath157 norm of the difference between the initial conditions ( exact analytic solution ) and the final state .",
    "the difference is taken over the inner @xmath229 of the grid in each direction , thus excluding boundary zones where errors may scale differently .",
    "this test exercises many terms in the code because in kerr - schild coordinates only three of the ten independent components of the metric are zero .",
    "the @xmath157 norm of the error in internal energy for the bondi test is shown in figure [ fig - i ] .",
    "similar results obtain for the other independent variables .",
    "the solution converges at second order .",
    "the next test considers a bondi flow containing a spherically symmetric , radial magnetic field .",
    "the solution to this problem is identical to the bondi flow described above because the flow is along the magnetic field , so all magnetic forces cancel exactly .",
    "this is a difficult test , however , because numerically the magnetic terms cancel only to truncation error .",
    "this causes problems at high magnetic field strength .",
    "we use the same bondi solution as in the last subsection and parameterize the magnetic field strength by @xmath230 at the inner boundary .",
    "our fiducial run has @xmath231 .",
    "the @xmath157 norm of the error in the internal energy is shown in figure [ fig - j ] .",
    "similar results obtain for the other independent variables .",
    "the solution converges at second order .",
    "we have considered models with a range of @xmath232 .",
    "lowering @xmath232 produces results similar to those in our fiducial test run . raising @xmath232",
    "first causes the code to produce inaccurate results ( at @xmath233 , where the radial velocity profile is smoothly distorted from the true solution ) and then to fail ( at @xmath234 ) .",
    "this is an example of a general problem with conservative schemes when the basic energy density scales ( rest mass , magnetic , and internal ) differ by many orders of magnitude .",
    "this test considers the steady - state , magnetized inflow solutions found by @xcite , as specialized to the case of inflow inside the marginally stable orbit by @xcite .",
    "this solution exercises many of the important terms in the governing equations , in particular the interaction of the magnetized fluid with the kerr geometry .",
    "we use boyer - lindquist coordinates to specify this problem , but the solution is integrated in the modified kerr - schild coordinates described above .",
    "the flow is assumed to lie in the neighborhood of the black hole s equatorial plane and is thus one dimensional , much like the weber - davis model for the solar wind . as above , we set @xmath225 .",
    "the particular inflow solution we consider is for a black hole with spin parameter @xmath235 .",
    "the model has an accretion rate @xmath236 ( adopting the notation of gammie 1999 ) .",
    "the magnetization parameter @xmath237 .",
    "the flow is constrained to match to a circular orbit at the marginally stable orbit .",
    "this is enough to uniquely specify the flow .",
    "it follows that ( see gammie 1999 ) @xmath238 , where @xmath239 is the orbital frequency at the marginally stable orbit . for @xmath240 .",
    "the solution that is regular at the fast point has angular momentum flux @xmath241 and energy flux @xmath242 .",
    "the fast point is located at @xmath243 , and the radial component of the four - velocity there is @xmath244 .",
    "figure [ fig - q ] shows the radial run of the solution .",
    "we initialize the flow with a numerical solution that is subject to roundoff error .",
    "the near - equatorial nature of the solution is mimicked by using a single zone in the @xmath138 direction centered on @xmath245 .",
    "the computational domain runs from @xmath246 the horizon radius @xmath247 to @xmath248 the radius of the marginally stable orbit @xmath249 . for @xmath235 , @xmath250 , and @xmath251 .",
    "the analytic flow model is cold ( zero temperature ) but we set the initial internal energy in the code equal to a small value instead .",
    "the model is run for @xmath252 .",
    "figure [ fig - k ] shows the @xmath157 norm of the error in @xmath253 and @xmath254 and a function of the total number of radial gridpoints @xmath255 .",
    "the straight line shows the slope expected for second order convergence .",
    "the small deviation from second order convergence at high @xmath255 in several of the variables is due to numerical errors in the initial solution , which relies on numerical derivatives @xcite .",
    "our next test concerns an equilibrium torus .",
    "this class of equilibria , found originally by @xcite and @xcite , consist of a `` donut '' of plasma surrounding a black hole .",
    "the donut is supported by both centrifugal forces and pressure and is embedded in a vacuum .",
    "here we consider a particular instance of the fishbone & moncrief solution .",
    "a practical problem with this test is that harm abhors a vacuum .",
    "we have therefore introduced floors on the density and internal energy that limit how small these quantities can be .",
    "the floors are dependent on radius , with @xmath256 and @xmath257 .",
    "this means that the torus is surrounded by an insubstantial , but dynamic , accreting atmosphere that interacts with the torus surface . to minimize the influence of the atmosphere on our convergence test , we take the @xmath157 norm of the change in variables only over that region where @xmath258 .",
    "the problem is integrated in modified kerr - schild coordinates .",
    "the kerr - schild radius @xmath136 has been replaced by the logarithmic radial coordinate @xmath259 , and the kerr - schild latitude @xmath138 has been replaced by @xmath260 such that @xmath261 .",
    "clearly @xmath262 maps to @xmath263 .",
    "this coordinate transformation has a single adjustable parameter @xmath264 ; for @xmath265 we recover the original coordinate system ( the @xmath138 coordinate is simply rescaled by @xmath266 ) .",
    "as @xmath267 numerical resolution is concentrated near the midplane .",
    "we have integrated a fishbone - moncrief disk around a black hole with @xmath268 , to maximize general relativistic effects .",
    "we set @xmath269 ( this is the defining feature of the fishbone - moncrief equilibria ) and @xmath270 .",
    "the grid extends radially from @xmath271 to @xmath272 .",
    "the coordinate parameter @xmath264 described in the last paragraph is set to @xmath174 .",
    "the numerical resolution is @xmath273 , where @xmath274 , and the solution is integrated for @xmath275 .",
    "figure [ fig - l ] shows the @xmath157 norm of the error for each variable as a function of @xmath255 .",
    "second order convergence is obtained .",
    "the sum of the evidence presented in this section strongly suggests that we are solving the equations of grmhd without significant , compromising errors .",
    "finally we offer an example of how harm can be applied to a real astrophysical problem : the evolution of a magnetized torus near a rotating black hole .",
    "again we set @xmath225 .",
    "the initial conditions contain a fishbone - moncrief torus with @xmath276 , @xmath277 , and @xmath278 .",
    "superposed on this equilibrium is a purely poloidal magnetic field with vector potential @xmath279 , where @xmath280 is the peak density in the torus .",
    "the field is normalized so that the minimum value of @xmath281 .",
    "the orbital period at the pressure maximum ( @xmath282 ) , is @xmath283 as measured by an observer at infinity .",
    "the integration extends for @xmath284 , or about @xmath285 orbital periods at the pressure maximum .",
    "figure [ fig - m ] shows the initial and final density states projected on the @xmath286 , @xmath287 plane .",
    "color represents @xmath288 .",
    "the coordinate parameter @xmath264 , which concentrates zones toward the midplane , is set to @xmath174 .",
    "the torus atmosphere is set to the floor values ( see above ) , and the mc limiter is used .",
    "the numerical resolution is @xmath289 .",
    "the flux of mass , energy , and angular momentum through the inner boundary are described in figure [ fig - o ] .",
    "initially the fluxes are small because the initial conditions are near an ( unstable ) equilibrium .",
    "the magnetorotational instability @xcite e - folds for just over an orbital period , after which the magnetic field has reached sufficient strength to distort the original torus and drop material into the black hole . later , the torus is turbulent and accretion occurs at a more or less steady rate .",
    "like all hydrodynamics codes , harm has failure modes",
    ". we will discuss one that is likely to be relevant to future astrophysical simulations .",
    "when @xmath111 and @xmath290 , the magnetic energy is the dominant term in the total energy equation .",
    "because the fields are evolved separately , truncation error in the field evolution can lead to large fractional errors in the velocity and internal energy .",
    "an example of this was discussed in  [ mbf ] , where the magnetized bondi flow test fails for large values of @xmath291 .",
    "another example can be found in the strong cylindrical explosion problem of @xcite , where an overpressured region embedded in a uniform magnetic field produces a relativistic blast wave .",
    "harm fails on the strong - field version of this problem unless we turn the courant number down to @xmath292 , use the minmod limiter , and sharply increase the accuracy parameter used in the @xmath63 inverter .",
    "this is a particularly difficult problem , with @xmath291 as large as @xmath293 .",
    "the problems caused by magnetically dominated regions appears to be generic to conservative relativistic mhd schemes , where small errors in magnetic energy density lead to fractionally large errors in other components of the total energy . at present",
    "this is unavoidable , and has motivated the development of schemes for the evolution of the electromagnetic field in the force - free limit @xcite .",
    "finally , to sum up : we have described and tested a code that evolves the equations of general relativistic magnetohydrodynamics .",
    "this code , together with the code described in a companion paper by @xcite , are the first that stably evolve a relativistic plasma in a kerr spacetime for many light crossing times .",
    "the advent of practical , stable grmhd codes opens the door for the study of many problems in the theory of rmrs .",
    "for example , it may be possible to directly evaluate the importance of magnetic energy extraction from rotating black holes and the importance of black hole spin in determining jet parameters .",
    "it may also be possible to couple these schemes to numerical relativity codes and use them to study dynamical spacetimes with electromagnetic sources .",
    "we are grateful to our collaborators john hawley and jean - pierre de villiers for extensive discussions .",
    "we are also grateful to ramesh narayan , who supplied the initial inspiration for this project some years ago .",
    "stu shapiro s advice has greatly improved this paper .",
    "serguei komissarov and the referee , luca del zanna , made valuable comments on the manuscript .",
    "this work was supported by nsf itr grant phy 02 - 05155 , by nsf pecase grant ast 00 - 93091 , by a nasa gsrp fellowship to jcm , and by a national center for supercomputing applications ( ncsa ) faculty fellowship to cfg .",
    "gt is supported by the hungarian science foundation ( otka , grant no .",
    "t037548 ) and the education ministry of hungary ( grant no .",
    "fkfp-0242 - 2000 ) .",
    "some of the numerical development work for this project was performed at ncsa ."
  ],
  "abstract_text": [
    "<S> we describe a conservative , shock - capturing scheme for evolving the equations of general relativistic magnetohydrodynamics . </S>",
    "<S> the fluxes are calculated using the harten , lax , and van leer scheme . </S>",
    "<S> a variant of constrained transport , proposed earlier by tth , is used to maintain a divergence free magnetic field . </S>",
    "<S> only the covariant form of the metric in a coordinate basis is required to specify the geometry . </S>",
    "<S> we describe code performance on a full suite of test problems in both special and general relativity . on smooth flows </S>",
    "<S> we show that it converges at second order . </S>",
    "<S> we conclude by showing some results from the evolution of a magnetized torus near a rotating black hole . </S>"
  ]
}