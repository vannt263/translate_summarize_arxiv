{
  "article_text": [
    "a spanning tree @xmath1 in some graph @xmath2 is a connected acyclic subgraph of @xmath2 that includes all vertices in @xmath3 .",
    "calculating the number @xmath4 of spanning trees for some graph @xmath2 is one of the typical questions we will ask . for example , when @xmath2 is a complete graph @xmath5 , @xmath6",
    ". there are several methods to calculate @xmath4 , such as the matrix - tree theorem and prfer coding .    in this paper , we study some graph polynomial @xmath0 that records the spanning trees of the extended graph @xmath7 of graph @xmath2 .",
    "this polynomial can be used to compute the spanning tree of some complex graphs easily .",
    "for example , let @xmath8 be the graph that is obtained by substitution of graphs @xmath9 instead of a vertices of a graph @xmath2 .",
    "then we can easily obtain @xmath10 by @xmath0 and @xmath11 , for @xmath12 .",
    "in fact , the polynomial @xmath0 possess the remarkable property of reciprocity .",
    "a. renyi [ 9 ] gives an inductive proof for this reciprocity theorem .",
    "i. pak and a. postnikov [ 1 ] also give an inductive proof . throughout this paper",
    ", we present a new bijective proof for the reciprocity theorem .",
    "one interesting fact is that the map we used in the bijection is prfer coding when @xmath2 is a complete graph .",
    "this paper is organized as follows : in section 2 , we define the graph polynomial @xmath0 to enumerate spanning trees in @xmath7 . in section 3",
    ", we show the reciprocity theorem for @xmath0 and defined some tools for the future bijective proof . in section 4 , we define two maps @xmath13 and @xmath14 to show the bijection between @xmath15 and @xmath16 . finally , in section 5 , we use this bijective coorespondence to prove the reciprocity theorem of @xmath0 .",
    "suppose that @xmath17 is a graph with vertices @xmath18 , where @xmath19 .",
    "let @xmath20 and @xmath21 .",
    "we say the _ extended graph _",
    "@xmath22 of @xmath2 is a graph on the set @xmath23 obtained by adding edges @xmath24 to @xmath2 for all vertices @xmath25 .",
    "clearly , if @xmath2 is a complete graph @xmath5 with @xmath26 vertices , then @xmath22 is a complete graph @xmath27 with @xmath28 vertices .",
    "we denote the set of all _ spanning trees _ in @xmath2 as @xmath29 , i.e. all acyclic connected subgraphs in @xmath2 which contain all the vertices of @xmath2 .",
    "first of all , we assign variables @xmath30 to @xmath31 , for all @xmath32 . for any spanning tree @xmath1 in @xmath29 , define a function @xmath33 associated to @xmath1 : @xmath34 where @xmath35 denotes _ degree _ of the vertex @xmath36 in the tree @xmath1 , i.e. the number of edges adjacent to the vertex @xmath36 .",
    "now , we set the graph polynomial @xmath37 to be , @xmath38 let us associate the variable @xmath39 to vertex @xmath40 .",
    "then , the graph polynomial @xmath0 of variables @xmath39 and @xmath41 , for all @xmath25 is defined as follows : @xmath42 we denote @xmath43 and @xmath44 .",
    "it is easy to see that the spanning trees in @xmath45 correspond to _ spanning rooted forests _ in @xmath2 , i.e. acyclic subgraphs in @xmath2 containing all vertices in @xmath46 , with a root chosen in each component .",
    "in particular , the two polynomials @xmath37 and @xmath0 possess the following identity : @xmath47 an short proof for eq .",
    "is provided in igor pak and a. postnikov [ 1 ] .",
    "the graph polynomial @xmath0 has two important properties that allow us to compute the number of spanning rooted forests for certain graph .",
    "the first property is the composition of graphs .",
    "let @xmath48 and @xmath49 be two graphs on disjoint sets of vertices , and @xmath50 be the disjoint union of the graphs .",
    "we associate variable @xmath39 to the root @xmath40 , variables @xmath51 to the vertices of @xmath48 , and variables @xmath52 to the vertices of @xmath49 .",
    "then the following formula holds : @xmath53 one can prove the above equation by some simple arguments .",
    "a graph @xmath54 is called the _ compliment _ of some graph @xmath17 if @xmath55 . that is to say , @xmath56 iff @xmath57 .",
    "the graph polynomials @xmath0 possess the following _ reciprocity property _ : @xmath58 the case that @xmath59 for was found by s. d. bedrosian [ 2 ] and a. kelmans .    before we give the bijective proof for eq .",
    ", we first introduce some notation .",
    "first of all , let @xmath60 be a spanning tree of some extended graph @xmath7 with root @xmath40 and vertices @xmath18 so that @xmath61 is a spanning rooted forest of @xmath2 .",
    "it is easy to show that for any vertex @xmath62 of @xmath2 , there is a unique path from @xmath62 to root @xmath40 .",
    "therefore , we can assign a direction to every edge in @xmath60 such that each arrow points toward the root @xmath40 .",
    "this implies that every vertex @xmath63 has outdegree 1 . for convention , in this paper ,",
    "when we say graphs @xmath64 or @xmath65 , we always consider it as a directed graph , and thus for every @xmath63 , there is a unique directed edge @xmath66 .",
    "in addition , a vertex @xmath62 is the _ child _ of vertex @xmath67 if there is a directed path from @xmath62 to @xmath67 in @xmath45 .",
    "secondly , we say that a _ valid pair _ of some tree @xmath68 is a pair @xmath69 , and @xmath70 is a subset of valid pairs of @xmath68 such that @xmath71 now , given a subset @xmath72 of all valid pairs not in @xmath70 , we define an _ operational set _ @xmath73 as follows : @xmath74 one can see that for a spanning tree @xmath68 and graph @xmath75 , there could be many possible operational sets .",
    "an example is in figure [ fig:1 ] .     and @xmath76 as above , we have two possible operational sets for @xmath68 .",
    "( the green marks are the graph after we apply all the pair in the operation sets to @xmath68 . ) , width=359 ]    now , for any @xmath77 , suppose its induced subgraph @xmath78 in @xmath5 has @xmath79 connected components .",
    "we say a _ weight sequence _",
    "@xmath80 of @xmath77 is @xmath81 where @xmath82 . by convention , if @xmath83 , we set @xmath84 to be empty . therefore , there are @xmath85 possible weight sequences for spanning tree @xmath77 that has @xmath79 connected compoenents in @xmath78 .    given a graph @xmath86 ,",
    "let @xmath15 be the set of all possible pairs @xmath87 and @xmath16 be the set of all possible pairs @xmath88 . in the following section ,",
    "we show a bijection between @xmath15 and @xmath16 .",
    "suppose that @xmath2 is a graph with @xmath26 vertices labeled @xmath18 where each vertex @xmath31 is associated to a variable @xmath30 , for @xmath89 .",
    "for the root in the extended graph , we assign variable @xmath39 to root @xmath40 .",
    "we first construct a map @xmath13 from @xmath15 to @xmath16 .    given a pair @xmath90 , the map @xmath13 outputs a pair @xmath91 and is defined as follows :    let @xmath92 be the set of vertices @xmath62 in @xmath68 , where the directed edge @xmath93 is a pair in @xmath94 or @xmath95 . construct an empty sequence @xmath96 and a graph @xmath97 which is a duplicate of @xmath68 .",
    "while @xmath98 ,    1 : :    suppose there is a leaf @xmath99 in    @xmath68 such that the edge    @xmath100 is not in    @xmath92 .",
    "we remove @xmath101 and    @xmath102 from @xmath68 .",
    "2 : :    repeat step 1 until every leaf @xmath63 in    @xmath68 is also in @xmath92 . let    @xmath103 to be the set of all these vertices . 3 : :    delete the largest vertex @xmath104 in @xmath103 and    the directed edge @xmath105 in    @xmath68 .",
    "we set @xmath92 to be    @xmath106 , and add @xmath107 to    the end of the sequence @xmath96 .",
    "4 : :    remove edge @xmath105 and add edge    @xmath108 to @xmath97 .",
    "return @xmath109 .",
    "an example of this algorithm is in figure [ fig:2 ] . in the following proposition",
    ", we prove that @xmath13 is well - defined .     and",
    "@xmath110 , output : @xmath111 and @xmath112,width=359 ]    the map @xmath13 is a well - defined map from @xmath15 to @xmath16 .",
    "it is easy to see that all the steps in while loop work .",
    "now , we show that @xmath97 is a spanning tree of @xmath113 after each step 4 .",
    "we proceed this by induction .",
    "initially , @xmath114 is a tree .",
    "suppose that at some step 4 , we delete edge @xmath115 and add edge @xmath116 to the spanning tree @xmath117 .",
    "furthermore , since for any vertex @xmath118 , @xmath62 and root @xmath40 is connected in graph @xmath97 , it remains connected after we change some edge @xmath115 to edge @xmath116 .",
    "since @xmath119 , @xmath97 is always a spanning tree of @xmath113 after any step 4 .",
    "now , from , we know that @xmath120 and all the edges @xmath121 in the operational set @xmath94 became @xmath122 in the output graph @xmath97 . thus , every edge in @xmath123 is also in @xmath124 , and @xmath97 is a spanning tree of @xmath125 .    finally , we show that @xmath126 is a weight sequence of @xmath97 . clearly , @xmath92 is the set of all roots in the spanning rooted forest @xmath127 .",
    "since the while loop ends when @xmath128 , there are totally @xmath129 elements added to the sequence @xmath126 . consequently , @xmath126 satisfies the length requirement in eq ..    the above arguments tell us that @xmath130 as desired .",
    "we now give a map @xmath14 from @xmath16 to @xmath15 .    given a pair @xmath131 , the map @xmath14 outputs @xmath132 and is defined as follows :    assume that the forest @xmath78 has @xmath79 connected components and the associated weight sequence @xmath133 . create a tree @xmath134 , sequence @xmath135 , and an empty set @xmath136 .",
    "let @xmath137 be the set of roots in @xmath78 .    while the length of @xmath138 is larger than 0 .    1 : :    we choose the first element @xmath139 in the sequence    @xmath138 .",
    "let @xmath62 be    the largest vertex in @xmath137 such that @xmath140 is    not @xmath62 nor a child of @xmath62 in    @xmath141 , for any @xmath140 in    @xmath138 .",
    "delete the element    @xmath139 from the sequence    @xmath138 and @xmath62 from    the set @xmath137 .",
    "2 : :    remove the edge @xmath142 and add the edge    @xmath143 to the graph @xmath141 . if    @xmath144 , we add pair @xmath143 to the set    @xmath136 , i.e.    @xmath145 .",
    "return @xmath146 .",
    "an example of this mapping @xmath14 is in figure [ fig:3 ] . in the following lemma",
    ", we prove that @xmath14 is well - defined .     and",
    "@xmath147 , output : @xmath148 and operational set @xmath149 .",
    "( r is the set of current roots . ) , width=359 ]    the map @xmath14 is a well - defined map from @xmath16 to @xmath15 .    we first show that at any stage , the set @xmath137 and graph @xmath141 satisfy the following properties :    1 .",
    "@xmath141 is a spanning tree of @xmath113 , i.e. @xmath150 is a sapnning rooted forest of @xmath5 .",
    "@xmath137 is the sets of roots of forest @xmath150 .",
    "we proceed by induction on the number of loops .",
    "initially , @xmath137 is the set of all the roots in forest @xmath78 , and @xmath138 is a sequence of length @xmath151 .",
    "moreover , at each step 1 , we remove an element in @xmath138 and an element in @xmath137 .",
    "thus , the length of sequence @xmath138 is always @xmath152 .",
    "now , suppose at some stage , we have that properties ( 1 ) and ( 2 ) hold and sequence @xmath153 , where @xmath154 . during step 1 , since there are @xmath155 connected components in @xmath150 , there exists at least one connected component that contains no elements in @xmath138 .",
    "consider the compoenent with the largest root @xmath62 that meets this condition .",
    "it is not hard to see that for any @xmath156 , @xmath157 is not @xmath62 nor a child of @xmath62",
    ". consequently , step 1 works .    for step 2 , by the choice of vertex @xmath62",
    ", we have @xmath157 and @xmath62 are not connected in @xmath150 .",
    "suppose @xmath141 becomes cyclic after we delete edge @xmath158 and add edge @xmath159 to this graph .",
    "this implies that there is a cycle containing edge @xmath159 .",
    "it is not possible since vertices @xmath62 and @xmath160 would be connected in @xmath150 before we add edge @xmath159 .",
    "the above arguments show that after step 1 and 2 , @xmath141 remains acyclic , and is a spanning tree of @xmath113 .",
    "futhermore , after step 2 , since @xmath62 is no longer a root , @xmath137 remains as the set of all roots in @xmath150 . as a result",
    ", properties ( 1 ) and ( 2 ) always hold .",
    "finally , we need to show that @xmath161 , for every directed edge @xmath162 and @xmath163 .",
    "clearly , @xmath141 is obtained from @xmath77 by a series of removing and adding edges in step 2 .",
    "if edge @xmath162 , then @xmath164 . therefore , edge @xmath165 is added to graph @xmath141 in some step 2 , and @xmath161 .",
    "this implies that @xmath166 as desired .",
    "the two maps @xmath13 and @xmath14 define a bijective correspondence between sets @xmath15 and @xmath16 .",
    "we have shown that @xmath13 and @xmath14 are well - defined .",
    "the remaining task is to prove that @xmath13 is the inverse map of @xmath14 .    given a pair @xmath167 , we apply the map @xmath13 and obtain an output @xmath168 .",
    "suppose that during the map @xmath13 , we record the largest vertex @xmath104 in every step 3 into a sequence @xmath169 in order .",
    "it is easy to see that @xmath170 , where @xmath92 is the original set before the while loop in map @xmath13 .",
    "let @xmath171 , and we set @xmath172 and @xmath173 .",
    "thus , for any @xmath174 , @xmath175 is the directed edge removed from @xmath77 in step 3 in the @xmath176-th while loop .",
    "now , let us apply the map @xmath14 on pair @xmath177 , and denote the output pair by @xmath178 . therefore , initially",
    ", @xmath179 is the set of roots of forest @xmath127 .",
    "our goal is to prove that @xmath180 we record the vertex @xmath62 we picked in every step 1 in the map @xmath14 and get a sequence @xmath181 in order .",
    "clearly , if @xmath169 and @xmath182 are the same sequence , eq . holds since every move in step 2 in @xmath14 will be the reverse move in step 4 in @xmath13 .",
    "before we show that @xmath183 , we first prove the following property :    1 .   in the @xmath31-th while loop of the map @xmath13 , where @xmath184 , consider the graph @xmath68 after step 2 . then for any @xmath62 in that current set @xmath92 , it is not a leaf in @xmath68 iff there exists some @xmath185 , where @xmath186 , such that @xmath185 is @xmath62 or a child of @xmath62 .",
    "if @xmath62 is not a leaf in @xmath68 , then there must be a vertex @xmath101 in current set @xmath92 that is child of @xmath62 .",
    "consider the vertex @xmath187 which edge @xmath188 is in @xmath189 .",
    "consequently , @xmath190 is vertex @xmath62 or child or @xmath62 . by some easy arguments",
    ", one can see that the reverse statement is true , and thus prove property ( 1 ) .",
    "we now show @xmath191 by induction on the index @xmath31 , where @xmath192 .",
    "when @xmath193 , clearly , from ( 1 ) , we know that @xmath194 is a leaf in @xmath68 . by the choice of @xmath67 , we have @xmath195 . on the other hand , since @xmath194 is the largest element in @xmath92 that no element in @xmath96 is @xmath194 or child of @xmath194 , we have @xmath196 . as a result , @xmath197 .    secondly ,",
    "suppose for @xmath31 from 1 to @xmath198 , where @xmath199 , we have @xmath200 .",
    "that is to say , the set @xmath92 and @xmath137 in the @xmath201-th while loop of map @xmath13 and @xmath14 are the same . when @xmath202 , from ( 1 ) and the choice of @xmath203 , we have that both @xmath204 and @xmath205 are the largest vertex @xmath206 such that no element @xmath207 is @xmath206 or child of @xmath206 .",
    "consequently , @xmath208 .    by induction",
    ", we can prove that @xmath169 and @xmath182 are the same sequence .",
    "therefore , eq . holds and @xmath14 is the inverse map of @xmath13 . finally , this shows us that the two maps @xmath13 and @xmath14 define a coorespondence relation between sets @xmath15 and @xmath16 .",
    "in particular , consider the case that @xmath209 . since @xmath76 is empty , we have that every valid pair @xmath210 in @xmath68 is not in @xmath76 .",
    "therefore , for every spanning tree @xmath68 in @xmath113 , there is only one possible operational set @xmath211 .",
    "in addition , there is only one spanning tree @xmath77 which is the graph with every vertex connected to root 0 .",
    "consequently , for every pair @xmath212 , we have that @xmath213 .",
    "that is to say , every element in @xmath16 is associated to a sequence of length @xmath214 .",
    "one can easily see that the map @xmath13 now is a prufer coding for spanning trees in @xmath27 and therefore , prufer coding is a special case for this bijection .",
    "in this section , we show how to use this bijection to prove the reciprocity theorem .",
    "first of all , we show that @xmath217 if we can show that the degree of every monomial in @xmath218 is @xmath214 , then eq",
    ". will be true .",
    "note that each monomial in @xmath218 corresponds to some spanning tree @xmath219 of @xmath113 , and we have @xmath220 this implies that eq .",
    "is true .",
    "now , we show that @xmath221 consider some spanning tree @xmath68 of @xmath113 associated to a monomial @xmath222 in polynomial @xmath0 and an operational set @xmath94 for @xmath68 .",
    "let us apply the map @xmath13 on @xmath223 . denote the output pair by @xmath224 , where sequence @xmath225 , and @xmath79 is the number of connected components in @xmath78 .",
    "moreover , the contribution of graph @xmath77 in the polynomial @xmath226 is @xmath227 where @xmath228 is the degree of vertex @xmath229 in @xmath77 .",
    "we associate the pair @xmath230 to the monomial @xmath231 in , where @xmath232 and @xmath233 is the variable corresponding to vertex @xmath234 , for @xmath174 . clearly , @xmath235 is a monomial in @xmath236 . by the choice of @xmath80 shown in section 3",
    ", we have that the set @xmath16 and set of all monomials in @xmath237 have a bijective coorespondence .",
    "it is easy to show that the monomial for the pair @xmath238 is the monomial associated to the pair @xmath230 with several sign changes , where the number of sign changes is @xmath239 .",
    "that is to say , we have @xmath240 where @xmath241 .    now",
    ", suppose that @xmath242 .",
    "since every valid pair in @xmath68 is not in graph @xmath76 , the only operational set for @xmath68 is @xmath70 .",
    "in addition , the output spanning tree @xmath77 is the extended graph of empty graph .",
    "therefore , the only pair @xmath243 for @xmath68 is mapped to a monomial in @xmath244 .",
    "this implies that the coefficient of the monomial associated to @xmath68 is @xmath245 in @xmath246 .    secondly ,",
    "if @xmath247 , then there is an edge @xmath248 such that @xmath249 . for every operational set @xmath250 for @xmath68",
    ", we consider the two operational sets : @xmath251 clearly , @xmath252 and @xmath253 are both operational sets for @xmath68 .",
    "denote the output pair for @xmath254 as @xmath255 and the output pair for @xmath256 as @xmath257 in the map @xmath13 . from eq .",
    ", one can see that the monomials associated to the two pairs @xmath255 and @xmath258 are the same .",
    "moreover , the degrees of root @xmath40 in @xmath259 and @xmath260 are differ by 1 .",
    "consequently , by , the summation of the coefficients of the monomial associated to @xmath255 and @xmath258 is 0 . finally ,",
    "because we can pair up all the operational sets for @xmath68 by , the contribution of the monomial for @xmath68 in @xmath246 is 0 .    from the above argument",
    ", we conclude that the only monomials left in @xmath261 after cancellation of coefficients are the monomials in @xmath262 . moreover , each monomial in @xmath263 has coefficient 1 in @xmath246 . as a result",
    ", we have that @xmath264 , and eq .",
    "holds as desired ."
  ],
  "abstract_text": [
    "<S> in this paper , we study the graph polynomial that records spanning rooted forests @xmath0 of a given graph . </S>",
    "<S> this polynomial has a remarkable reciprocity property . </S>",
    "<S> we give a new bijective proof for this theorem which has prfer coding as a special case . </S>"
  ]
}