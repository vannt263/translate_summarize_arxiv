{
  "article_text": [
    "spin glass is a paradigm for basic research on physics of collective behaviors induced by disorder and/or frustration @xcite .",
    "it is also a tool box for applied research on hard problems originated from fields outside the conventional domain of physics .",
    "the mean - field theory of spin glasses was originally developed through the replica trick and by assuming the property of replica - symmetry - breaking ( rsb ) @xcite .",
    "it was later re - derived using the cavity method @xcite without introducing replicas .",
    "another advantage of the cavity method is its applicability to single problem instances with fixed disorder parameters .",
    "the cavity method was successfully extended to spin glass models defined on finite - connectivity random graphs @xcite , confirming and extending the earlier theoretical results obtained by the replica method @xcite .",
    "these theoretical advances paved the way for the fruitful applications of spin glass theory to interdisciplinary problems in computer science , information theory , and biological sciences @xcite ; for example , constraint satisfaction and combinatorial optimization @xcite , perceptual learning with discrete synapses @xcite , signal transmission and processing @xcite , network structure inference @xcite , compressive sensing @xcite .",
    "the most crucial simplification made in the mean - field rsb cavity method is the bethe - peierls approximation @xcite . roughly speaking",
    ", this approximation ignores all the possible correlations among the set of vertices that are nearest - neighbors to a specified central vertex .",
    "there have been several theoretical attempts to include the effects of correlations to the cavity method @xcite .",
    "a simple and general scheme of partition function expansion was introduced in @xcite along this research line , following the initial work of chertkov and chernyak @xcite on ising spin glasses . by this expansion scheme",
    ", the mean - field free energy expression at each level of replica - symmetry - breaking can be formally derived without imposing any physical assumptions , and the correction contributions to these mean - field free energies are expressed as a sum over looped subgraphs .",
    "the strong constraint that the subgraphs with dangling edges all have completely zero correction contribution to the free energies leads to a set of message - passing equations , such as the belief - propagation equation and the survey - propagation equation , that must be satisfied by the auxiliary probability distribution functions introduced in the expansion scheme .    for readers not familiar with spin glass theories , the partition function expansion scheme @xcite can serve as a straightforward mathematical approach to the essentials of the rsb mean field theory .",
    "finite - dimensional spin glass models are still very challenging for theoretical studies .",
    "one of the major reasons is the abundance of short loops and the associated ( possibly strong ) local correlations .",
    "short loops are also presented in numerous graphical models derived from real - world applications in optimization , inference , and constraint satisfaction problems . for such spin glass systems ,",
    "the free energy correction contributions from loopy subgraphs may be comparable to the mean - field free energy values .",
    "as a consequence , the prediction power of the the mean - field theory can be severely damaged .",
    "a powerful conceptual framework for finite - dimensional lattice models is the cluster variation method , which was invented by kikuchi @xcite and later further developed by many authors ( reviewed in @xcite).the key insight behind the cluster variation method is that , in a finite - dimensional system , the correlation between two vertices decays exponentially with the distance ( as long as the system is not approaching a continuous phase transition ) , and therefore short - range correlations dominate the statistical property of the system .",
    "short - range correlations among clusters of neighboring vertices are considered in a variational way in the cluster variation method @xcite . as an extension of the cluster variation method , yedidia and",
    "coworkers proposed a region graph method @xcite to tackle local correlations in finite - dimensional graphical models with more computational flexibility .",
    "a set of regions is specified in the region graph representation of a spin glass model @xcite .",
    "each region contains a subset of vertices and some ( or all ) of the interactions within these vertices .",
    "a partial order can be defined among these regions , which is represented by a set of directed edges between pairs of regions .",
    "a variational free energy is defined on the region graph , the minimization of this free energy leads to a set of generalized belief - propagation equations @xcite .",
    "recently , the generalized belief - propagation was applied to the two - dimensional ( 2d ) edwards - anderson model by ricci - tersenghi , mulet and co - workers @xcite .",
    "as demonstrated in a very recent paper @xcite , the partition function expansion scheme of @xcite can also be applied to spin glasses in the region graph representation . in the present work",
    "we give a detailed discussion on how to construct a region graph rsb mean - field theory for spin glass models and also to obtain the correction expressions to such a theory .",
    "two sets of message - passing equation , namely the region graph belief - propagation equation and region graph survey - propagation equation , are derived through the partition function expansion .",
    "we also prove that , for non - redundant region graphs , the region graph bethe - peierls free energy as derived through the partition function expansion is equivalent to the variational free energy functional used in @xcite .",
    "the region graph belief - propagation ( rgbp ) equation is applied to the 2d square - lattice ising model and the 2d square - lattice edwards - anderson ( ea ) spin glass model , and our numerical results are compared with the results obtained by the conventional belief - propagation ( bp ) procedure .",
    "the prediction on the ising model s curie temperature by the rgbp is better than the prediction of the conventional bp .",
    "the exactly known transition temperature can be approached if region graphs with sufficiently large maximal regions are used in the rgbp . when applying the rgbp to the square - lattice ea model at sufficiently low temperature ,",
    "a most interesting numerical observation for us is that , the rgbp identifies many small collective domains of vertices in the square lattice ( see figure  [ fig : magevolution ] ) .",
    "vertices in each of these collective domains are strongly correlated ( and probably change states collectively ) , while the remaining vertices outside of all these small localized domains serve as paramagnetic background .",
    "such highly heterogeneous patterns are in some respect similar to the patterns of dynamical heterogeneity in dense liquid when approaching the glass transition ( reviewed in @xcite ) .",
    "a key difference is the collective domains in the square lattice do not move in space , only their areas increase as temperature decreases .",
    "these collective domains bring in many new time scales to the system s low - temperature dynamics , they should be essential to understand many of the fascinating low - temperature glass - like behaviors of this system .    for the square - lattice ea model",
    ", the existence of many localized collective domains above the paramagnetic background naturally points to a way of improving the power of the rgbp .",
    "the basic idea is to use larger maximal regions for the identified collective domains , while the sizes of the maximal regions in the remaining parts of the lattice keep to be as small as possible .",
    "this hybrid adaptive strategy will be explored in a future work .",
    "we hope it will be helpful in achieving deeper insights on the heterogeneous ( but globally still paramagnetic ) behaviors of this and other 2d spin glass systems .",
    "the next section introduces the general graphical model and its factor graph and region graph representations , and briefly reviews the cluster variation method . section [ sec : rs ] derived the region graph replica - symmetric ( rs ) mean - field theory as well as the region graph belief - propagation equation ; the connection with the generalized belief - propagation of @xcite is also discussed here .",
    "section [ sec : rsb ] derived the region graph first - replica - symmetry - breaking ( 1rsb ) mean - field theory and the associated region graph survey - propagation equation .",
    "the rs mean - field theory ( rgbp ) is then applied to the 2d ising model and the 2d edwards - anderson model in sec .",
    "[ sec:2d ] .",
    "we conclude this work and list some possible future projects in sec .",
    "[ sec : conclude ] .",
    "the paper have four appendices .",
    "consider a very general model system of @xmath0 particles ( @xmath1 ) interacting with each other and with the environment .",
    "each particle @xmath2 is fixed in space and therefore has no translational degrees of freedom , it is fully characterized by an internal state variable @xmath3 .",
    "for example , in ising models , the state variable is binary , @xmath4 ; in potts models , the internal state can choose among @xmath5 different values , @xmath6 ; in heisenberg models , @xmath3 is a three - dimensional continuous vector of unit length . in this paper we assume , for notational simplicity , that the state variables @xmath3 are discrete and can take only a finite number of different values .",
    "the microscopic configuration ( state ) @xmath7 of the whole system is defined by the states of all its particles , @xmath8 .",
    "the configuration energy @xmath9 is supposed to have the following additive form @xmath10 on the right side of ( [ eq : totalenergy ] ) , the first term is contributed by external forces ( fields ) , with each energy @xmath11 depending only on a single particle @xmath2 ( if @xmath2 is free of external forces , then @xmath12 ) .",
    "the second term is contributed by @xmath13 internal interactions ( @xmath14 ) , each having an energy @xmath15 .",
    "let us denote by @xmath16 the set of particles that are involved in interaction @xmath17 and by @xmath18 a joint state of the particles in this set .",
    "the internal interaction energy @xmath15 is a function only of @xmath19 .",
    "for example , in a two - body ising model an internal energy has the form @xmath20 with @xmath21 being a coupling constant , then @xmath22 and @xmath23 .",
    "after equilibrium is reached in an environment of temperature @xmath24 , the probability of the system being in a configuration @xmath7 obeys the boltzmann distribution @xmath25 where @xmath26 is the inverse temperature , @xmath27 being the boltzmann constant .",
    "the partition function @xmath28 is expressed as @xmath29 where @xmath30 and @xmath31 are , respectively , the boltzmann factor for the external field on particle @xmath2 and the internal interaction @xmath17 , @xmath32 from @xmath28 we can define the equilibrium free energy @xmath33 as @xmath34 the expression ( [ eq : freeenergy2 ] ) for the equilibrium free energy can be extended to a general non - equilibrium situation .",
    "given an arbitrary probability distribution @xmath35 on the configurations of the model ( [ eq : totalenergy ] ) , the shannon entropy functional is defined as @xcite @xmath36 \\equiv   - k_b \\sum_{\\underline{x } } \\rho(\\underline{x } )      \\ln \\rho(\\underline{x } ) , \\ ] ] and the free energy functional @xmath37 $ ] is @xmath38 \\equiv \\sum_{\\underline{x } } \\rho(\\underline{x } ) h(\\underline{x } ) - t s[\\rho ] .\\ ] ] it is easy to check that the absolute minimum of @xmath37 $ ] is equal to the equilibrium free energy @xmath33 and this minimum is achieved only when @xmath39 .",
    "the model defined by ( [ eq : totalenergy ] ) can be represented conveniently by a factor graph @xmath40 of variable nodes ( shown as circles , denoting the @xmath0 particles @xmath41 ) , function nodes ( shown as squares , denoting the @xmath13 _ internal _ interactions @xmath42 ) , and edges between pairs of variable and function nodes @xmath43 . to denote variable nodes and letters @xmath44 to denote function nodes . ]",
    "the factor graph @xmath40 is a bipartite graph : all the edges are between a variable node and a function node , and an edge @xmath43 exists between a variable node @xmath2 and a function node @xmath17 if and only if variable @xmath2 is involved in the internal interaction represented by @xmath17 .",
    "a comprehensive review on factor graphs can be found in @xcite .    as a simple illustration",
    ", we show in fig .",
    "[ fig : factorgraph ] part of the factor graph for the two - dimensional edwards - anderson spin glass model @xcite on a square lattice .",
    "the energy function of the ea model is defined as @xmath45 where the internal energies are due to ferromagnetic ( @xmath46 ) or anti - ferromagnetic ( @xmath47 ) spin couplings along the edges @xmath48 of the square lattice , and @xmath49 is the external magnetic field on particle @xmath2 .",
    "we use @xmath50 instead of @xmath3 to denote the binary spin state of particle @xmath2 .",
    "the spin configuration of the whole system is @xmath51 .",
    "the factor graph for the two - dimensional edwards - anderson model .",
    "each variable node @xmath2 ( circle ) represents a lattice site @xmath2 , it has a spin state @xmath52 and an energy @xmath53 caused by an external field @xmath49 ; each function node @xmath17 ( square ) between two variable nodes @xmath2 and @xmath54 represents a spin coupling with energy @xmath55 . ]      the cluster variation method ( cvm ) , as originally proposed by kikuchi @xcite , is an approximate method to calculate the shannon entropy ( [ eq : shannonentropy ] ) .",
    "it decomposes @xmath56 $ ] into contributions from different clusters of variable nodes ( see @xcite for an easy - to - access introduction to cvm ) . a cluster in the cvm is defined as a non - empty subset of the @xmath0 variable nodes .",
    "the total number of possible clusters is @xmath57 . for two clusters @xmath58 and @xmath59 , we say that @xmath60 ( and @xmath61 ) if and only if @xmath58 is a subset of @xmath59 ( in cases that @xmath62 and also @xmath63 , then @xmath64 ) .",
    "if @xmath58 is a strict subset of @xmath59 , we denote as @xmath65 ( and @xmath66 ) .",
    "this partial ordering corresponds to the following function @xmath67 @xmath68 this function can be regarded as a matrix , and it is invertible : @xmath69 where @xmath70 is the kronecker delta such that @xmath71 if @xmath64 and @xmath72 otherwise . the function @xmath73 is the mbius inversion function @xcite defined as @xmath74 in the above equation , @xmath75 denotes the number of elements in cluster @xmath76 .",
    "the configuration of a cluster @xmath76 is defined as the collection of states of all its elements and is denoted as @xmath77 . given a probability distribution @xmath35 for all the @xmath0 variable nodes , the marginal distribution for the configuration @xmath78 is @xmath79 following ( [ eq : shannonentropy ] ) , we can define for each cluster @xmath76 its shannon entropy functional as @xmath80 \\equiv - k_b \\sum\\limits_{\\underline{x}_c } \\rho_c ( \\underline{x}_c ) \\ln \\rho_c ( \\underline{x}_c ) .\\ ] ] let us define an entropy increment @xmath81 for each cluster @xmath76 as ( see , for example , @xcite ) @xmath82 then from ( [ eq : entropydelta ] ) and ( [ eq : inverse ] ) we obtain that @xmath83 in other words , the entropy @xmath84 of each cluster @xmath76 is the sum of the entropy increments of all its sub - clusters ( including @xmath76 itself ) .",
    "if we take @xmath76 as the set of all the variable nodes in @xmath40 , the above equation ( [ eq : ecluster ] ) then states that , the entropy functional @xmath56 $ ] of the whole system is the sum of the entropy increments of all the @xmath85 different clusters , i.e. , @xmath56=\\sum_{c } \\delta s_c[\\rho_c]$ ] .",
    "there are an exponential terms in this summation .",
    "the insight of kikuchi @xcite was that , the entropy increment @xmath86 often decays quickly with the size @xmath75 of the clusters , therefore a good approximation of @xmath56 $ ] can be obtained by summing over only a subset of small clusters .",
    "let us choose a set of maximal clusters @xmath87 .",
    "these @xmath88 clusters are maximal in the sense that any of them is not a sub - cluster of any another cluster in this chosen set .",
    "these @xmath88 maximal clusters and all their sub - clusters form a set , denoted as @xmath89 .",
    "we then have the following approximate expression for the entropy functional : @xmath90 \\approx \\sum\\limits_{c \\in p } \\delta s_c\\bigl[\\rho_c \\bigr ] .\\ ]",
    "] this is the cvm approximation .    inserting ( [ eq : entropydelta ] ) into the above expression",
    ", we get @xmath91 \\approx   \\sum\\limits_{c\\in p } a_c s_c\\bigl [ \\rho_c \\bigr ] , \\ ] ] where the coefficient @xmath92 of a cluster @xmath76 is expressed as @xmath93 it is easy to check that each of the @xmath88 maximal clusters ( say @xmath94 ) has the coefficient @xmath95 . for other clusters of @xmath89 , their coefficients can be calculated iteratively as @xmath96 the applications of the cvm method were reviewed in @xcite .",
    "this method can be combined with suzuki s coherent anomaly method @xcite to compute the critical exponents of a given finite - dimensional system .      in the cvm approximation ( [ eq : s - cvm ] ) , for each maximal cluster , all its sub - clusters are included into the cluster set @xmath89 .",
    "this requirement was relaxed in the work of yedidia and co - authors , who proposed a more flexible region graph representation @xcite .",
    "a region graph @xmath97 is formed by regions to denote the regions of a region graph @xmath97 . ] and a set of directed edges between the regions .",
    "a region @xmath98 of a factor graph @xmath40 includes a set of variable nodes and a set of function nodes , with the condition that , if a function node @xmath17 belongs to a region @xmath98 , then all the variable nodes in the set @xmath16 also belong to the region @xmath98 .",
    "a configuration of a region @xmath98 is defined by the states of all the variable nodes in this region , @xmath99 .",
    "if there is a directed edge pointing from a region @xmath100 to @xmath101 in the region graph @xmath97 , then it must be the case that @xmath101 is a sub - region of @xmath100 ( that is , all the variable nodes and function nodes of region @xmath101 also belong to region @xmath100 ) .",
    "we use @xmath102 to emphasize the directness of the edge ; sometimes if the direction of an edge is unimportant for the discussion , the notion @xmath103 is also used .",
    "it should be emphasized that , a region @xmath101 being a sub - region of another region @xmath100 does not necessarily indicate the existence of a directed edge from @xmath100 to @xmath101 .",
    "if there is a directed edge from region @xmath100 to @xmath101 , then @xmath100 is regarded as a parent of @xmath101 and @xmath101 a child of @xmath100 .",
    "if there is a directed path from region @xmath98 to region @xmath101 , we say that @xmath98 is an ancestor of @xmath101 and @xmath101 is a descendant of @xmath98 .",
    "the ancestor - descendant relationship between two regions @xmath98 and @xmath101 is denoted by @xmath104 and @xmath105 .",
    "( if @xmath101 is not a descendant of @xmath98 , such a relationship does not exist even if @xmath101 is a sub - region of @xmath98 . )",
    "a non - redundant region graph @xmath97 for the factor graph shown in fig .",
    "[ fig : factorgraph ] .",
    "only a part of the full region graph is shown .",
    "there are three types of regions : each ` square ' region ( e.g. , region @xmath98 ) contains @xmath106 variable nodes and @xmath107 function nodes ( in this example , @xmath108 ) , its counting number is @xmath109 ; each ` rod ' region contains @xmath110 variable nodes and @xmath111 function nodes , its counting number is @xmath112 ; and each ` stripe ' region ( e.g. , region @xmath100 ) contains @xmath113 variable nodes and @xmath110 function nodes , with counting number @xmath109 .",
    "each stripe region is connected to two rod regions , and each rod region connects to one stripe region and one square region .",
    "the short red lines between two regions indicate the parent - child relationship ( the directions of these edges are not shown , as they are obvious ) . in this region graph",
    ", variable node @xmath2 appears in @xmath114 different regions , and function node @xmath17 appears in @xmath115 different regions . ]",
    "each region @xmath116 is assigned a counting number @xmath117 , which is determined recursively by @xmath118 notice the similarity between ( [ eq : rgcn ] ) and ( [ eq : partialsum ] ) . in the region graph @xmath97 , the subgraph @xmath119 induced by a variable node",
    "@xmath2 is defined as the subgraph that include all the regions containing @xmath2 and all the directed edges between these regions .",
    "similarly , @xmath120 denotes the region graph induced by function node @xmath17 , it includes all the regions containing @xmath17 and all the directed edges between these regions . the region graph @xmath97 and its associated counting numbers @xmath121 are required to satisfy the following region graph conditions @xcite :    1 .",
    "for any variable node @xmath2 , the induced subgraph @xmath119 is connected , and the sum of counting numbers within this subgraph is unity : @xmath122 2 .   for any function node @xmath17 , the induced subgraph @xmath120 is connected , and the sum of counting numbers within @xmath120 is unity : @xmath123    given a factor graph @xmath40 , one may construct many different region graphs @xmath97 , all of them satisfying the region graph conditions . a region graph @xmath97",
    "is considered as being _ non - redundant _ if it satisfies the following additional condition : the region subgraph @xmath119 induced by any variable node @xmath2 contains no loops ( it is a tree of regions ) .",
    "region graphs which do not satisfy this tree condition are referred to as being redundant . as we will discuss in detail ,",
    "non - redundant region graphs have some nice properties for partition function expansion .    a simple region graph @xmath97 is shown in fig .  [ fig : rgfig ] for the two - dimensional ea model .",
    "although this region graph contains many loops at the region level , it is non - redundant as can be easily checked .",
    "given a region graph @xmath97 for a factor graph @xmath40 , we now expand the equilibrium partition function ( [ eq : partitionfunction ] ) as a sum over the contributions of region subgraphs of @xmath97 .",
    "the mathematical framework of @xcite will be followed .",
    "first of all , because of the constraints ( [ eq : cni ] ) and ( [ eq : cna ] ) , the partition function can be expressed as @xmath124^{c_\\alpha } .\\ ] ] the microscopic configuration of each region @xmath98 is denoted as @xmath125 , where @xmath126 is the state of variable node @xmath2 in region @xmath98 . for a function node @xmath17 in region @xmath98 , the variable states at its neighborhood",
    "are denoted as @xmath127 .",
    "a boltzmann factor @xmath128 is defined for region @xmath98 as @xmath129 a variable node @xmath2 may belong to two or more regions ( say @xmath130 ) . if this is the case , we regard the states of node @xmath2 in the different regions , @xmath131 , as different variables . with the introduction of these new variables , the partition function expression ( [ eq : z - exp-1 ] )",
    "is re - written as @xmath132 .",
    "\\label{eq : z - exp-2b}\\ ] ] the kronecker delta functions @xmath133 guarantee that , the partition function is contributed only by those region configurations @xmath134 for which the states @xmath131 of each variable node @xmath2 in different regions are equal to the same value .",
    "let us for the moment focus on the region subgraph @xmath119 induced by variable node @xmath2 .",
    "assume @xmath119 contains @xmath135 regions .",
    "the expression within the square brackets in ( [ eq : z - exp-2b ] ) requires that the states of variable node @xmath2 take the same value among the @xmath135 regions , which is equivalent to @xmath136 constraints",
    ". these @xmath136 constraints of each variable node @xmath2 can be conveniently implemented in the following way : ( 1 ) attach on each edge @xmath137 of region graph @xmath97 a variable node set , the cross - linker set @xmath138 , which is initially empty .",
    "( 2 ) for each variable node @xmath139 , choose @xmath136 different edges of the induced region graph @xmath119 in such a way that the @xmath135 regions of @xmath119 form a connected tree with these edges ; then for each of these @xmath136 chosen edges @xmath103 , add @xmath2 to its cross - linker set @xmath138 . ( 3 ) after all the cross - linker sets are constructed , for each variable node @xmath54 in any cross - linker set @xmath138 , a constraint @xmath140 is applied , forcing the states of @xmath54 to be the same in the two connected regions @xmath100 and @xmath101 .",
    "the region graph shown in figure [ fig : rgfig ] is non - redundant , and there is no need to remove redundancy .",
    "the left panel of figure [ fig : reduntrgfig ] shows a redundant region graph @xmath97 for the 2d edwards - anderson model .",
    "this region graph has three types of regions , and each variable node ( such as node @xmath2 ) appears in @xmath141 different regions .",
    "the region subgraph @xmath119 induced by variable node @xmath2 contains @xmath142 directed edges .",
    "one particular way of removing redundancy is indicated by the x and xx symbols on the directed edges of @xmath97 . after removing redundancy , the resulting graph @xmath143 is shown in the right panel of figure  [ fig : reduntrgfig ] .",
    "this graph @xmath143 is actually equivalent to the region graph shown in figure  [ fig : rgfig ] ( we will return to this point later ) .",
    "removing redundancy from a region graph .",
    "( left panel ) a redundant region graph @xmath97 for the factor graph shown in fig .",
    "[ fig : factorgraph ] .",
    "there are three types of regions in this region graph , as indicated by the three different colors .",
    "each variable node ( e.g. , @xmath144 ) appears in @xmath141 different regions . a x symbol on a directed edge @xmath102 ( between a parent region @xmath100 and a child region @xmath101 )",
    "means that the single common variable node ( say @xmath2 ) of @xmath100 and @xmath101 is not included into the cross - linker set @xmath138 ( that is , @xmath145 ) .",
    "a xx symbol on the edge @xmath146 means that the two common variable nodes ( say @xmath147 ) of @xmath100 and @xmath101 are not included into the set @xmath138 ( again , @xmath145 ) .",
    "( right panel ) the resulting non - redundant graph @xmath143 after all the redundancy in @xmath97 has been removed .",
    ", title=\"fig : \" ]   removing redundancy from a region graph .",
    "( left panel ) a redundant region graph @xmath97 for the factor graph shown in fig .",
    "[ fig : factorgraph ] .",
    "there are three types of regions in this region graph , as indicated by the three different colors .",
    "each variable node ( e.g. , @xmath144 ) appears in @xmath141 different regions .",
    "a x symbol on a directed edge @xmath102 ( between a parent region @xmath100 and a child region @xmath101 ) means that the single common variable node ( say @xmath2 ) of @xmath100 and @xmath101 is not included into the cross - linker set @xmath138 ( that is , @xmath145 ) .",
    "a xx symbol on the edge @xmath146 means that the two common variable nodes ( say @xmath147 ) of @xmath100 and @xmath101 are not included into the set @xmath138 ( again , @xmath145 ) .",
    "( right panel ) the resulting non - redundant graph @xmath143 after all the redundancy in @xmath97 has been removed .",
    ", title=\"fig : \" ]    by this construction , it is easy to check that the states of each variable node @xmath2 is associated with @xmath136 constraints .",
    "for some edges @xmath137 of the region graph @xmath97 , the cross - linker set might be empty , @xmath148 .",
    "we can remove all such edges from the region graph @xmath97 , and the resulting graph is denoted as @xmath143 ( see the right panel of figure [ fig : reduntrgfig ] for an example ) . the partition function ( [ eq : z - exp-2b ] )",
    "is re - expressed as @xmath149 .",
    "\\label{eq : z - exp-2c}\\ ] ] we should emphasize that the above - mentioned procedure of removing redundancy does not change the counting numbers , it only assigns a cross - linker set @xmath138 ( might be empty ) on each directed edge @xmath103 of the region graph @xmath97 .      for each edge @xmath103 of the region graph @xmath143",
    "we now introduce two auxiliary probability distribution functions , @xmath150 and @xmath151 .",
    "they are non - negative and normalized but otherwise arbitrary . the microscopic configuration @xmath152 denotes the states of variable nodes of set @xmath138 _ in region @xmath100 _ ,",
    "i.e. , @xmath153 ; similarly , @xmath154 .",
    "we further rewrite ( [ eq : z - exp-2c ] ) as @xmath155 \\prod_{(\\mu , \\nu)\\in r^{\\ # } } \\biggl [      \\frac{\\prod_{i\\in \\mu\\#\\nu } \\delta(x_i^\\mu , x_i^\\nu ) }      { p_{\\mu\\rightarrow \\nu}(\\underline{x}_{\\nu\\#\\mu}^\\nu )      p_{\\nu\\rightarrow \\mu}(\\underline{x}_{\\mu\\#\\nu}^\\mu)}\\biggr ] ,        \\label{eq : z - exp-3}\\ ] ] where @xmath156 denotes the set of nearest neighboring regions of region @xmath98 in region graph @xmath143 .",
    "it is helpful to define two partition function factors as follows : @xmath157 then ( [ eq : z - exp-3 ] ) is written as the following simple form @xmath158   , \\label{eq : z - exp-4}\\ ] ] where the coefficient @xmath159 is equal to @xmath160 and @xmath161 is expressed as @xmath162 and @xmath163 is a probability distribution defined as @xmath164 we regard @xmath165 as small quantities and expand the edge - product of ( [ eq : z - exp-4 ] ) , and finally obtain @xmath166   , \\ ] ] where @xmath167 denotes any subgraph of the region graph @xmath143 , which contains a subset of the edges of @xmath143 and the associated regions .",
    "the correction contribution @xmath168 of a region subgraph @xmath167 is expressed as @xmath169      many of the subgraphs of the region graph @xmath143 contain dangling edges .",
    "a dangling edge @xmath103 in a subgraph @xmath167 is such an edge that if it is cut off from subgraph @xmath167 , either region @xmath100 or region @xmath101 ( or both ) will be an isolated region of @xmath167 . for a dangling edge @xmath137 of subgraph",
    "@xmath167 , suppose the region @xmath100 has only this edge attached to it .",
    "the correction contribution @xmath168 of subgraph @xmath167 is calculated to be @xmath170 where @xmath171 is a probability distribution function determined by @xmath172 in the above expressions , @xmath173 denotes the set of nearest - neighboring regions of @xmath100 in the region graph @xmath143 , but with @xmath101 being removed from this set .    from ( [ eq : cdangle ] ) we know that , if the auxiliary probability distributions @xmath174 are chosen as a fixed - point of the following equation , @xmath175 then all the subgraphs @xmath167 of the region graph @xmath143 with at least one dangling edges will have zero correction contribution .",
    "then the free energy of the system is expressed as @xmath176 , \\ ] ] where @xmath177 denotes a subgraph of @xmath143 that is free of dangling edges ( in @xmath177 , each region has at least two edges attached ) .",
    "equation ( [ eq : rgbp ] ) is referred to as the region graph belief - propagation ( rgbp ) equation .",
    "it ensures that all the subgraphs of @xmath143 with one or more dangling edges have zero correction contribution to the partition function @xmath28 , therefore greatly reduces the number of terms in the free energy correction expression .",
    "it is not difficult to check that , the expression of the rgbp equation ( [ eq : rgbp ] ) for the region graph @xmath143 shown in the right panel of figure  [ fig : reduntrgfig ] is equivalent to that of the rgbp equation for the non - redundant region graph shown in figure  [ fig : rgfig ] . in this sense , @xmath143 of figure  [ fig : reduntrgfig ] ( right panel )",
    "is equivalent to @xmath97 of figure  [ fig : rgfig ] .",
    "when all the loop correction contributions in ( [ eq : feexpan ] ) are neglected , the remaining term @xmath178 is an approximation to the true free energy @xmath33 .",
    "we refer to @xmath178 as the _ region graph bethe - peierls free energy _ , its expression is @xmath179 with @xmath180 , \\quad f_{(\\mu,\\nu ) }   =   -\\frac{1}{\\beta } \\ln \\biggl[\\sum\\limits_{\\underline{x}_{\\mu\\#\\nu}^\\mu }       p_{\\mu\\rightarrow \\nu}(\\underline{x}_{\\mu\\#\\nu}^\\mu )       p_{\\nu \\rightarrow \\mu}(\\underline{x}_{\\mu\\#\\nu}^\\mu ) \\biggr ] .\\ ] ] the free energy @xmath178 can also be regarded as a functional of the probability functions @xmath174 .",
    "a nice property of this functional is that , the partial derivative of @xmath178 with respective to any probability function @xmath181 vanishes at a fixed point of the rgbp equation ( [ eq : rgbp ] ) .",
    "this can easily be checked by showing that @xmath182 where the probability function @xmath183 has been defined through ( [ eq : hatrho ] ) .    from the variational property of @xmath178 ,",
    "we know that each fixed point of the rgbp equation ( [ eq : rgbp ] ) locates a stationary point of the functional @xmath178 and _ vice versa _ , namely there is a one - to - one correspondence between the stationary points of the @xmath178 functional and the fixed points of the rgbp equation . a stationary point of @xmath178",
    "could be a minimum , it could also be a maximum , or be a saddle point .",
    "using the set of probability functions @xmath174 as order parameters , the functional @xmath178 gives an approximate description of the free energy landscape of model ( [ eq : totalenergy ] ) .",
    "if @xmath178 has only one stationary point ( expected to be a minimum ) , then the rgbp equation has only one fixed point ( solution ) .",
    "this simple situation can be referred to as the ` replica - symmetric ' ( rs ) case , in connection to the physics approaches based on the replica method and the cavity method @xcite . in many non - trivial problems ,",
    "however , the @xmath178 functional may turn out to be very rugged in shape and have many stationary points , then ( [ eq : rgbp ] ) has multiple solutions .",
    "this later complex situation can be referred to as the ` replica - symmetry - broken ' ( rsb ) case .",
    "we will discuss this rsb case in the next section [ sec : rsb ] .",
    "a schematic illustration of the qualitative change in shape of @xmath178 is shown in fig .",
    "[ fig : freelandscape ] .     the region graph bethe - peierls free energy @xmath178 as a functional of probability functions may have only a single stationary point ( left panel ) , or it may have multiple stationary points including minima , maxima , and saddles ( right panel ) .",
    "this qualitative change in functional shape is induced by variation in environmental temperature or other control parameters .",
    ", scaledwidth=70.0% ]    the free energy @xmath178 can be expressed as a sum over the contributions of all the regions . for any region @xmath98 of the region graph @xmath97",
    ", we have the identity @xmath184 .",
    "then @xmath178 can be re - written as @xmath185 f_\\alpha -\\sum\\limits_{(\\mu\\rightarrow \\nu ) \\in r^\\ # } \\bigl[c_\\mu + \\sum_{\\alpha>\\mu } c_\\alpha \\bigr ] f_{(\\mu,\\nu ) } \\nonumber \\\\ & = & \\sum\\limits_{\\alpha } c_\\alpha \\tilde{f}_\\alpha .",
    "\\label{eq : f0cluster}\\end{aligned}\\ ] ] each region @xmath98 contributes a term @xmath186 to @xmath178 .",
    "the expression of @xmath187 is @xmath188 .\\ ] ] notice that ( [ eq : fa3 ] ) has the same expression as ( [ eq : f0 ] ) , the only difference is that the summations are restricted to the subgraph containing region @xmath98 and all its descendants .",
    "therefore , @xmath187 can be regarded as the region graph bethe - peierls free energy of this subgraph @xmath98 .",
    "it has been demonstrated in @xcite that the conventional belief - propagation ( bp ) equation can be derived from the framework of partition function expansion .",
    "actually bp is just a limiting case of the more general rgbp equation .",
    "given a factor graph @xmath40 , let us consider the following simplest region graph @xmath97 : there are @xmath0 ` variable ' regions denoted by @xmath189 , each of which contains a single variable node @xmath2 , with counting number @xmath190 ( @xmath191 being the degree of node @xmath2 in @xmath40 ) ; and there are @xmath13 ` function ' regions denoted by @xmath192 , each of which contains a function node @xmath17 and the set @xmath16 of all the nearest - neighboring variable nodes of node @xmath17 , with counting number @xmath193 .",
    "such a simple region graph is non - redundant , although it in general contains many loops .",
    "let us define two new probability functions @xmath194 and @xmath195 as @xmath196 using the rgbp equation ( [ eq : rgbp ] ) , one can easily check that the newly defined probability functions satisfy the conventional bp equation : @xmath197 the probability @xmath194 can be interpreted as the state distribution of variable node @xmath2 in the absence its interaction with function node @xmath17 ; while the probability @xmath195 can be interpreted as the state distribution of @xmath2 if it only interacts with function node @xmath17 .",
    "the free energy @xmath178 for this simplest region graph reduces to the conventional bethe - peierls free energy .",
    "its expression is @xmath198 .",
    "the free energies @xmath199 ( for a variable node @xmath2 ) and @xmath200 ( for a function node @xmath17 ) are expressed as @xmath201 , \\quad   \\tilde{f}_a   = -\\frac{1}{\\beta}\\ln \\biggl [ \\sum_{\\underline{x}_{\\partial a } } \\psi_a(\\underline{x}_{\\partial a } ) \\prod_{i\\in \\partial a } \\bigl [ \\psi_i(x_i )   \\prod_{c\\in \\partial i\\backslash a } b_{c\\rightarrow i}(x_i ) \\bigr ] \\biggr ] .\\end{aligned}\\ ] ] only the messages @xmath195 from the function regions ( parents ) to the variable regions ( children ) appear in the above two expressions .",
    "we now proceed to demonstrate that , such a property holds for a general non - redundant region graph .      in a non - redundant region graph @xmath97 ,",
    "the subgraph @xmath119 induced by any variable node @xmath2 is a connected tree .",
    "because of this property , @xmath143 is identical to @xmath97 and the cross - linker set for each directed edge @xmath102 contains all the variable nodes in @xmath101 ( @xmath202 ) .",
    "it is easy to see that , if there is a directed path pointing from a region @xmath98 to another region @xmath116 , then such a path must be unique in @xmath97 ; furthermore , the subgraph @xmath120 induced by any function node @xmath17 is also a connected tree .",
    "when we approximate the free energy @xmath33 by the region graph bethe - peierls free energy @xmath178 , the corresponding approximate expression for the marginal configuration distribution of a region @xmath116 is @xmath203 this marginal distribution has the following consistency property : if @xmath103 is an edge of the region graph @xmath97 ,",
    "then @xmath204 where @xmath205 is the configuration of the variables in the cross - linker set @xmath138 . equation ( [ eq : mncons ] ) ensures that the marginal configuration distribution of the cross - linker set @xmath138 is the same whether it is inferred from @xmath206 or from @xmath207 .",
    "when @xmath97 is non - redundant , we have @xmath208 in ( [ eq : pgamma ] ) , where @xmath209 is just the set of nearest - neighboring regions of region @xmath116 . then , with the help of ( [ eq : rgbp ] ) , the expression ( [ eq : pgamma ] ) is rewritten as @xmath210 in this expression , the region set @xmath211 contains @xmath116 and all its descendants , i.e. , @xmath212 ; @xmath213 is another region set with the property that any region in @xmath213 does not belong to @xmath211 but is parental to at least one region in @xmath211 , see figure  [ fig : rgptoc ] .",
    "the configuration @xmath214 for any region @xmath215 should be understood as @xmath216 .    for a non - redundant region graph @xmath97 , we can prove ( see the appendix  [ app : proof ] ) that , the marginal probability distribution ( [ eq : pgamma2 ] ) is equivalent to @xmath217 \\prod\\limits_{\\{(\\mu\\rightarrow \\nu ) | \\mu\\in b_\\gamma , \\nu\\in i_\\gamma\\ } }   m_{\\mu\\rightarrow \\nu}(\\underline{x}_\\nu ) , \\ ] ] where @xmath218 is a probability distribution that satisfies the self - consistent equation ( [ eq : miteration ] ) . the message @xmath218 is interpreted as the ( cavity ) probability that the variable set @xmath219 takes configuration @xmath214 in region @xmath100 when all the interactions that also appear in region @xmath101 are not considered ( namely , setting @xmath220 for any @xmath221 and @xmath222 for any @xmath223 , while all the other interactions of region @xmath100 are not modified ) . the marginal probability expression ( [ eq : pgamma4 ] )",
    "has the nice property that only the parent - to - child messages @xmath224 are needed , but not the messages from children to parents .    the self - consistent equation for @xmath225 , derived from ( [ eq : rgbp ] )",
    "after a lengthy process ( see appendix [ app : proof ] ) , is intuitively simple : @xmath226 \\prod\\limits_{\\{(\\alpha\\rightarrow \\eta ) | \\alpha\\in b_\\mu , \\eta   \\in i_\\mu\\backslash i_\\nu\\ } } m_{\\alpha\\rightarrow \\eta}(\\underline{x}_\\eta ) .",
    "\\label{eq : miteration}\\ ] ]     for any region @xmath116 in a non - redundant region graph @xmath97 , the set @xmath211 is formed by @xmath116 and all its descendant regions , and the set @xmath213 is formed by all the other regions that do not belong to @xmath211 but are pointing to regions of @xmath211 by one or more edges . each white disk in this figure represents a region . , scaledwidth=35.0% ]    for a non - redundant region graph @xmath97 , the marginal probability distributions @xmath227 should satisfy the following edge - consistency condition , namely @xmath228 to check this consistency , plug ( [ eq : pgamma4 ] ) into the two sides of the above equation , we get the follow equation that must be satisfied by @xmath224 : @xmath229 where the normalization constant @xmath76 is determined by @xmath230 . for a non - redundant graph @xmath97 ,",
    "the set @xmath231 is empty , and hence the denominator of the expression on the right side of ( [ eq : ptoceq ] ) is equal to @xmath232 . since ( [ eq : ptoceq ] ) is equivalent to ( [ eq : miteration ] ) , the edge - consistency condition ( [ eq : rgconsistency2 ] ) holds .",
    "if the region graph @xmath97 is redundant , the marginal probability distribution of each region @xmath116 can no longer be written in the form of ( [ eq : pgamma4 ] ) , and the edge - consistency condition ( [ eq : rgconsistency2 ] ) is no longer valid ( but the weaker condition ( [ eq : mncons ] ) is still valid ) . in @xcite , however , yedidia and co - authors _ defined _ that a region @xmath116 has a marginal probability distribution ( [ eq : pgamma4 ] ) , and then they required that this marginal probability distribution should satisfy the edge - consistency condition ( [ eq : rgconsistency2 ] ) , which leads to the self - consistent equation ( [ eq : ptoceq ] ) for @xmath218",
    ". such a treatment might be able to get good results for some problems , but in our opinion it lacks a solid theoretical foundation .    for a non - redundant graph @xmath97 , the free energy @xmath187 ( [ eq : fa3 ] ) can also be expressed by parent - to - child messages ( see appendix [ app : fgbp ] for details ) .",
    "the final expression is @xmath233 .",
    "\\label{eq : frgbp}\\ ] ]    the free energy expression ( [ eq : frgbp ] ) also appeared in @xcite as a basic assumption ( both for redundant and non - redundant region graphs ) .",
    "a theoretical challenge for redundant region graphs , worth to be explored in future work , is to derive from the framework of partition function expansion an expression for @xmath187 using only parent - to - child messages .",
    "if the region graph bethe - peierls free energy functional ( [ eq : f0 ] ) has only a single stationary point , a global minimum , then the rgbp equation ( [ eq : rgbp ] ) has only a single solution ( fixed point ) . reaching this unique fixed point is computationally not hard",
    ". one may perform message - passing iteration along the edges of the region graph @xmath97 , or one may work on the functional @xmath178 and find its unique minimum by gradient descend methods .",
    "the situation is a little bit more complicated , for example , if the @xmath178 functional has a single minimum and one or more saddle points . in this situation",
    ", we expect that the rgbp equation still has only one stable fixed point , which can be reached by direct iteration ( with some damping to accelerate convergence ) or by minimizing @xmath178 .",
    "the real non - trivial situation occurs when the @xmath178 functional has multiple minimal points ( see the right panel of figure [ fig : freelandscape ] ) , and consequently the rgbp equation ( [ eq : rgbp ] ) has multiple stable fixed points .",
    "we take @xmath178 as an approximate free energy landscape for the system under study .",
    "then each minimal point of @xmath178 can be regarded as a metastable state @xmath234 of the system , it describes approximately the system s collective behavior within certain timescale @xmath235 .",
    "the timescale @xmath235 is determined by the shape of the free energy landscape surrounding metastable state @xmath234 , especially the relative height of the closest free energy saddle point .",
    "for some mean - field models ( such as spin glasses on random graphs @xcite ) @xmath235 is expected to approach infinity in the thermodynamic limit @xmath236 ( see , e.g. , @xcite ) , then a metastable state @xmath234 is a true thermodynamic gibbs state ( i.e. , ergodicity is broken at @xmath237 ) . for finite - dimensional systems ,",
    "the timescale @xmath235 of a metastable state @xmath234 may be finite even in the thermodynamic limit .    in this section ,",
    "we regard each fixed point of the rgbp equation ( [ eq : rgbp ] ) as a _ macrostate _ , no matter whether it is a minimum of @xmath178 or a maximum or saddle point . viewing each macrostate as an energy level",
    ", it is natural to define a grand partition function @xmath238 as @xcite @xmath239 , \\ ] ] where @xmath240 is the value of @xmath241 at the rgbp fixed point @xmath234 ; the parameter @xmath242 is the inverse temperature at the level of macrostates . ) sums over all the stationary points of @xmath178 , we expect that at sufficiently large values of @xmath242 the grand partition function will be dominantly contributed by the free energy minimal points . ]",
    "the grand partition function @xmath243 is associated with a grand free energy @xmath244 through @xmath245 at a given inverse temperature @xmath242 , the statistical weight of a macrostate @xmath234 is @xmath246 } { \\sum\\limits_{s } \\exp\\bigl[-y f_0^{(s)}(\\beta)\\bigr ] } .\\ ] ] from @xmath247 the mean value of free energy is expressed as @xmath248 . and the entropy density @xmath249 of macrostates is expressed as @xmath250 @xmath249 is also called the complexity in the spin glass literature @xcite .",
    "it is easy to verify that @xmath251 .",
    "we are interested in obtaining an approximate expression for the grand free energy @xmath244 . for this purpose",
    "we follow again the framework of partition function expansion @xcite .",
    "first notice that @xmath252 where @xmath253 means integrating over all possible probability measures @xmath254 on the edge @xmath137 of the region graph @xmath143 .",
    "because of the dirac function @xmath255 , only the fixed points of ( [ eq : rgbp ] ) contribute to the grand partition function .",
    "we then introduce on each edge @xmath103 of the region graph @xmath143 two probability measures @xmath256 and @xmath257 . using the expression ( [ eq : f0 ] ) for the free energy @xmath178 ,",
    "the grand partition function is re - written as @xmath258 .",
    "\\label{eq : xi - exp-2}\\end{aligned}\\ ] ] this expression is very similar in form to ( [ eq : z - exp-3 ] ) , therefore the method of partition function expansion can be directly applied to ( [ eq : xi - exp-2 ] ) . as a result",
    "we obtain that @xmath259 .\\ ] ]    the first term on the right of ( [ eq : gfeexpan ] ) is expressed as @xmath260 where    @xmath261 ,   \\\\",
    "g_{(\\mu,\\nu ) } & = & - \\frac{1}{y}\\ln\\biggl [ \\int \\int { \\rm d } p_{\\mu\\rightarrow \\nu } { \\rm d } p_{\\nu\\rightarrow \\mu } p_{\\mu\\rightarrow \\nu}(p_{\\mu\\rightarrow \\nu } ) p_{\\nu\\rightarrow \\mu}(p_{\\nu\\rightarrow \\mu } ) e^{-y f_{(\\mu , \\nu ) } } \\biggr ] .\\end{aligned}\\ ] ]    the grand free energy @xmath262 as expressed by ( [ eq : gsp ] ) can also be regarded as a functional of the probability functionals @xmath263 .",
    "the correction contribution @xmath264 of a subgraph to the grand free energy has a similar expression as ( [ eq : correction ] ) @xcite . to ensure that any subgraph with at least one dangling edge has vanishing correction contribution to the grand free energy , each probability function @xmath265 needs to satisfy the following equation @xmath266 where @xmath267 .\\ ] ] equation ( [ eq : spfix ] ) is called the region graph survey - propagation equation , in correspondence to the 1rsb mean - field theory of spin glasses @xcite .",
    "if we neglect the loop correction contributions to @xmath244 , then the grand free energy functional @xmath262 gives an approximate description of the system s free energy landscape at the level of macrostates .",
    "it can again be verified that , the first variation of @xmath262 with respect to any of its arguments @xmath256 is identically zero at a fixed point of ( [ eq : spfix ] ) .    if we neglected all the loop correction contributions to @xmath244 and approximate it with @xmath262 , then an approximate expression for the mean free energy of macrostates is @xmath268 and the complexity @xmath249 is expressed as @xmath269 it is particularly interesting to determine the complexity value at @xmath270 , and to determine the maximal value of @xmath242 at which the complexity becomes negative @xcite .",
    "it is not a simple task to solve numerically the region graph survey - propagation equation ( [ eq : spfix ] ) .",
    "a direct approach is to iterate ( [ eq : spfix ] ) on the region graph , with each probability functional @xmath256 represented by a sample set of probability functions @xmath254 .",
    "a major complication is the reweighting factor @xmath271 in ( [ eq : spfix ] ) . in the special situation of @xmath270 ,",
    "the reweighting can be replaced by introducing new auxiliary probability functions @xcite .",
    "several reweighting tricks were discussed in the thesis of zdeborov @xcite , which may be helpful for solving the region - graph survey - propagation equation for general @xmath242 values .",
    "the region - graph survey - propagation equation ( [ eq : spfix ] ) applies to a general redundant or non - redundant region graph @xmath97 .",
    "rizzo and co - authors @xcite derived a set of generalized survey - propagation equations using the replica cluster variation method , which are different from the region - graph survey - propagation equation ( [ eq : spfix ] ) . the connection between these two approaches needs to be further studied .",
    "we now apply the region graph belief - propagation equation to the 2d ising and edwards - anderson models , mainly for the purpose of testing its performance .",
    "both models are described by the energy function ( [ eq:2dea ] ) . for the ising model , all edge coupling constants @xmath272 are equal to a positive value @xmath273 ; for the ea model , @xmath272 are independent and identically distributed random variables , taking value @xmath273 and @xmath274 with equal probability .",
    "all the external fields @xmath49 in ( [ eq:2dea ] ) are set to be zero for simplicity . in the numerical calculations , @xmath273 and the boltzmann constant @xmath27",
    "are both set to be unity , so the energy unit is @xmath273 and the temperature unit is @xmath275 .",
    "we consider @xmath276 square lattices with @xmath277 coupling interactions in each dimension .",
    "if we assume periodic boundary condition on both dimensions , the total number of vertices ( variable nodes ) in the lattice is @xmath278 ; if open boundary condition is used on both directions , the total number of vertices is @xmath279 .",
    "the region graph for the square lattice is constructed to be non - redundant .",
    "it has three types of regions , the ` square ' regions , the ` stripe ' regions , and the ` rod ' regions .",
    "each square region contains @xmath280 vertices , each stripe region contains @xmath113 vertices , and each rod region contains @xmath281 vertices .",
    "all the coupling interactions between the vertices of a given region are also included into this region .",
    "each square region is connected to four rod regions , each stripe region is connected to two rod regions , and each rod region is connected to a square region and a stripe region .",
    "the region graph @xmath97 at @xmath108 is shown in figure  [ fig : rgfig ] , where a square region and a stripe region have the same shape .",
    "for the general case of @xmath282 , if we regard each square region as a ` giant vertex ' and each stripe region plus its two connected rod regions as a ` giant bond ' , then the region graph is again a square lattice of giant vertices and giant bonds . in this sense ,",
    "our region graph representation is a coarse - graining of the original lattice that keeps its topology unchanged .",
    "the partition function of the 2d edwards - anderson can be calculated exactly by polynomial algorithms ( see , for example , ref .",
    "@xcite and references therein ) .",
    "although the heuristic rgbp message - passing approach can only obtain an approximate value for the free energy , it is very efficient in estimating all the @xmath0 single - variable marginal probabilities simultaneously .",
    "a subgraph of the region graph @xmath97 at @xmath108 is plotted in figure [ fig : rgbp2d ] . for notational simplicity",
    "we denote the square regions and the stripe regions by greek symbols ( such as @xmath98 and @xmath100 ) and denote a rod region just by the index of its function node ( such as @xmath17 and @xmath283 ) .",
    "consider a square region @xmath98 and a rod region @xmath17 in figure [ fig : rgbp2d ] .",
    "the two probability distributions between these regions can be parameterized as    @xmath284    similarly the two probability distributions between a stripe region @xmath100 and a rod region @xmath17 are expressed as    @xmath285    the self - consistent equations for these set of parameters are derived from the rgbp equation ( [ eq : rgbp ] ) and listed in appendix [ app : rg ] .     a local part of the region graph @xmath97 shown in figure [ fig : rgfig ] .",
    "the counting numbers for a square region @xmath98 , a stripe region @xmath100 , and a rod region @xmath17 are , respectively , @xmath286 , @xmath287 , @xmath288.,scaledwidth=60.0% ]    a trivial solution of the rgbp equation is the paramagnetic one with the fields in the expressions ( [ eq : p11])([eq : p22 ] ) all being identically zero , @xmath289 the stability of the paramagnetic solution is analyzed through a set of linearized rgbp iterative equations listed in appendix [ app : stab ] .",
    "all the fields such as @xmath290 and @xmath291 are randomly initialized , and their values then evolve according to the linearized rgbp equations .",
    "if all the fields finally decay to zero , the paramagnetic solution is stable , otherwise it is unstable and the original rgbp equation has other stable fixed points .    the number ( @xmath292 ) of parameters needed to completely characterize a probability distribution of the rgbp equation grows quickly with the number @xmath110 of vertices on a boundary line of the square region . the paramagnetic solution and its stability analysis have been worked out up to @xmath293 for the ising model . for the ea model we have only considered the simplest case of @xmath108 .      at sufficiently high temperatures @xmath24 the paramagnetic solution ( [ eq : rg2para ] )",
    "is the only solution for the rgbp equation at @xmath108 .",
    "this trivial solution becomes unstable at the critical temperature @xmath294 ( periodic boundary conditions ) .",
    "this value is higher than the exact transition temperature @xmath295 @xcite , but a little bit lower than the value of @xmath296 as obtained through the conventional belief - propagation equation ( i.e. , @xmath297 ) @xcite",
    ".     the critical temperature @xmath24 at which the paramagnetic fixed - point of the rgbp equation becomes unstable ( periodic boundary conditions ) .",
    "the integer @xmath110 is the number of vertices on a boundary line of a square region .",
    "the exactly known phase - transition temperature @xmath298 is indicated by the horizontal dashed line .",
    "the red solid curve is a fitting function @xmath299 to the data with @xmath282.,scaledwidth=60.0% ]    the paramagnet - ferromagnet transition temperature as predicted by the rgbp equations decreases if larger square regions are used .",
    "figure  [ fig:2disingtc ] demonstrates that the predicted critical temperature @xmath300 can be fitted by the following curve @xmath301 with @xmath302 , @xmath303 , and @xmath304 .",
    "the fitted value @xmath305 is slightly lower than the exact critical point @xmath306 .",
    "the data can also be fitted well by @xmath307 , with @xmath308 and @xmath309 .",
    "the free energy density , mean energy density , entropy density , and magnetization as a function of temperature @xmath24 are shown in figure  [ fig:2dising ] and compared with the exactly known results of onsager @xcite .",
    "as @xmath110 increases , the results are closer to the exact value .",
    "the free energy as obtained by the rgbp equations is an upper bound to the true free energy value of the system , but the difference is small at @xmath282 . both the energy density and the entropy density have a kink at the rgbp critical point @xmath300 , but this kink becomes more and more weaker as @xmath110 increases ( in the limit of @xmath310 the exact onsager solution should be reached ) . using the theoretical framework of coherent anomaly method @xcite , the results obtained at different values of @xmath110 can be used to predict the critical exponents of the 2d ising model .",
    "the results of such an exercise ( to be carried out ) will be reported elsewhere .",
    "results obtained on the ferromagnetic ising model ( periodic boundary conditions ) using the conventional bp and the rgbp at various values of @xmath110 .",
    "the results of onsager s exact solution are also shown for comparison .",
    "( upper left ) free energy density ; ( upper right ) mean energy density ; ( lower left ) entropy density ; ( lower right ) magnetization .",
    ", title=\"fig:\",scaledwidth=49.5% ]   results obtained on the ferromagnetic ising model ( periodic boundary conditions ) using the conventional bp and the rgbp at various values of @xmath110 .",
    "the results of onsager s exact solution are also shown for comparison .",
    "( upper left ) free energy density ; ( upper right ) mean energy density ; ( lower left ) entropy density ; ( lower right ) magnetization .",
    ", title=\"fig:\",scaledwidth=49.5% ] 0.02 results obtained on the ferromagnetic ising model ( periodic boundary conditions ) using the conventional bp and the rgbp at various values of @xmath110 .",
    "the results of onsager s exact solution are also shown for comparison .",
    "( upper left ) free energy density ; ( upper right ) mean energy density ; ( lower left ) entropy density ; ( lower right ) magnetization .",
    ", title=\"fig:\",scaledwidth=49.5% ]   results obtained on the ferromagnetic ising model ( periodic boundary conditions ) using the conventional bp and the rgbp at various values of @xmath110 .",
    "the results of onsager s exact solution are also shown for comparison .",
    "( upper left ) free energy density ; ( upper right ) mean energy density ; ( lower left ) entropy density ; ( lower right ) magnetization .",
    ", title=\"fig:\",scaledwidth=49.5% ]    under the periodic boundary condition , the instability temperature of the paramagnetic solution shown in figure  [ fig:2disingtc ] is independent of lattice side length @xmath277 .",
    "but this is not the case for the open boundary condition . under the open boundary condition , the shorter the lattice side length @xmath277 , the more stable the paramagnetic solution is ( see figure  [ fig:2disingopen ] ) .",
    "however , this difference in threshold temperature between the periodic and the open boundary conditions becomes very small for @xmath311 .",
    "the rgbp equation at @xmath108 have two stable ferromagnetic fixed points even for a very small @xmath312 square lattice ( open boundary conditions ) if the temperature is lower than @xmath313 ( see figure  [ fig:2disingopen ] ) . for larger open square lattices ,",
    "the ferromagnetic solutions are stable at higher temperatures .",
    "of course for finite lattices there is no real phase transition .",
    "the two low - temperature ferromagnetic solutions are interpreted as describing the two metastable states of the square lattice .",
    "they are stable because the correlation length in the system exceeds the length scale of the maximal square region of the region graph .",
    "if @xmath110 exceeds the correlation length of the system , the paramagnetic fixed point of the rgbp equation will again be stable .",
    "threshold instability temperature of the paramagnetic solution for the ising model on a @xmath276 square lattice with open boundary condition .",
    "circular points are obtained by the bp approximation , square points by the rgbp at @xmath108 . at each value of @xmath277 ,",
    "the threshold temperature as predicted by rgbp at @xmath108 is lower than that predicted by the conventional bp .",
    ", scaledwidth=60.0% ]      a set of single instances of the 2d ea model with @xmath314 coupling constants are randomly generated .",
    "for each instance the threshold stability temperature @xmath315 of the paramagnetic solution of the rgbp equation at @xmath108 is determined numerically , and this value is compared with the threshold value as obtained by the conventional bp approximation . as shown in figure  [ fig : stabea ] ,",
    "the performance of rgbp ( @xmath108 ) is better than that of bp , but @xmath316 is still positive , and it increases with the side length @xmath277 of the periodic square lattice .",
    "figure  [ fig : stabea ] also suggests that the finite - size corrections to the critical temperature @xmath316 decrease as @xmath317 .",
    "this finite - size scaling behavior is different from the observation of @xcite .",
    "the ea model on a square lattice has no real spin glass phase at finite temperatures ( see , for example , @xcite ) . at any positive temperature @xmath24",
    "the system has only a paramagnetic phase , and the magnetization on each vertex is equal to zero in the long time limit .",
    "apparently , the results of figure  [ fig : stabea ] with the paramagnetic solution being unstable at positive temperatures are in contradiction with the absence of finite - temperature spin glass phase .",
    "this apparent discrepancy can actually be removed .",
    "the instability of the paramagnetic rgbp solution does not mean the system is in a spin glass phase .",
    "it just signifies the emergence of some collective domains in the square lattice , the length scales of these collective domains exceed the length scale ( @xmath318 ) of the region graph s maximal square region .",
    "the detailed arguments go as follows .",
    "an elementary square ( including four coupling interactions ) of the square lattice is called a plaquette .",
    "there are two types of plaquettes , frustrated or non - frustrated .",
    "a plaquette is said to be frustrated ( non - frustrated ) if the product of the four edge coupling constants on its boundary is negative ( positive ) @xcite .",
    "it is an obvious fact that the four edge coupling energies of a frustrated plaquette can not be _ simultaneously _ minimized . for the ea model studied in this paper , on average one - half of the plaquettes in each problem instance are frustrated , and these frustrated plaquettes are randomly distributed on the 2d lattice ( see the upper left panel of figure  [ fig : magevolution ] for a concrete example ) .",
    "the abundance of frustrated plaquettes destroys the long - range ferromagnetic correlations in the system .",
    "however , the local density of frustrated plaquettes fluctuates considerably at different parts of the lattice .",
    "there are some small patches of the lattice that are mainly formed by non - frustrated plaquettes .",
    "for example , in the @xmath319 periodic square lattice of figure [ fig : magevolution ] ( upper left panel ) , there is a @xmath320 patch centered at position @xmath321 in which only @xmath322 of its @xmath323 plaquettes are frustrated .",
    "the spin coupling interactions in such small patches are essentially ferromagnetic in nature ( under a gauge transformation of the spin variables and the coupling constants @xcite ) . some of these ferromagnetic small patches may considerably exceed the maximal @xmath280 square region in size , and at low enough temperatures , the ferromagnetic correlation length will exceed @xmath110 , making the rgbp fixed point to be locally ferromagnetic ( after the gauge transform ) in these patches but paramagnetic in the remaining parts of the square lattice .",
    "given a patch with a specified contour shape and a specified density of unfrustrated plaquettes , the probability to discover such a patch is higher in a square lattice with longer side length @xmath277 .",
    "therefore , the observation that @xmath316 increases with lattice size @xmath277 ( figure  [ fig : stabea ] ) is consistent with figure  [ fig:2disingopen ] .",
    "the marginal probability distribution of the two spins @xmath52 and @xmath324 of a rod region @xmath17 ( see figure  [ fig : rgbp2d ] ) is calculated as @xmath325 .\\end{aligned}\\ ] ] then we get the magnetization of vertex @xmath2 as @xmath326 + \\tanh\\bigl[\\beta ( h_{\\alpha\\rightarrow a}^{(j ) } + h_{\\mu\\rightarrow a}^{(j ) } ) \\bigr ] \\tanh\\bigl[\\beta ( j_{\\alpha\\rightarrow a}^{(i j ) } + j_{\\mu\\rightarrow a}^{(i j ) } - j_{i j } ) \\bigr ] } { 1 + \\tanh\\bigl[\\beta ( h_{\\alpha\\rightarrow a}^{(i ) } + h_{\\mu\\rightarrow a}^{(i)})\\bigr ] \\tanh\\bigl[\\beta ( h_{\\alpha\\rightarrow a}^{(j ) } + h_{\\mu\\rightarrow a}^{(j ) } ) \\bigr ] \\tanh\\bigl[\\beta ( j_{\\alpha\\rightarrow a}^{(i j ) } + j_{\\mu\\rightarrow a}^{(i j ) } - j_{i j } ) \\bigr ] } .\\ ] ] the magnetizations of all the vertices in the square lattice can be obtained in a similar way .",
    "we define the mean absolute magnetization of a plaquette as the average of the absolute magnetizations of its four vertices .     the threshold instability temperature of the paramagnetic solution of the conventional bp and the the rgbp equation at @xmath108 for @xmath327 periodic square lattices .",
    "each data point is obtained by averaging over @xmath328 single instances of the edwards - anderson model .",
    "the dashed lines are two fitting curves of the form @xmath329 , the two fitting parameters @xmath330 are shown in the figure .",
    ", scaledwidth=60.0% ]    figure  [ fig : magevolution ] shows the pattern of mean absolute plaquette magnetizations at a given temperature @xmath24 , for a single instances of the ea model on a @xmath331 periodic square lattice . for @xmath332",
    "the rgbp equation has only the paramagnetic solution , and all the plaquette mean magnetizations are zero . at @xmath333 ,",
    "the mean absolute magnetizations of a small domain of the square lattice are nonzero ( figure  [ fig : magevolution ] , upper right panel ) . as temperature further decreases",
    ", this collective domain enlarges in area , and also other collective domains start to form ( figure  [ fig : magevolution ] , lower right panel , @xmath334 ) . as temperature further decreases ,",
    "different collective domains start to get into contact and they compete for the boundary vertices ( figure  [ fig : magevolution ] , lower left panel , @xmath335 ) .",
    "the heterogeneous patterns and its evolution shown in figure  [ fig : magevolution ] in some respect are similar to the phenomenon of dynamical heterogeneity in structural glasses @xcite .",
    "this link deserves to be explored more deeply .",
    "the existence of many collective domains and the frustration effects between these domains very probably are responsible for the glassy - like low - temperature dynamics of the 2d edwards - anderson model .",
    "figure  [ fig : magevolution ] also suggests a way to improve the rgbp prediction power .",
    "we infer that different local regions of the square lattice have different correlation lengths . to consider more precisely the correlations in the collective domains , a conceptually easy way is to construct region graphs with larger regions for these collective domains , while small regions are used for the remaining parts to lower computational complexity .",
    "this adaptive strategy needs to be implemented in future work .",
    "emergence of domains with collective dynamics .",
    "( upper left ) distribution of frustrated plaquettes in a single instance of the 2d edwards - anderson model with periodic boundary conditions .",
    "each frustrated plaquette is shown as black , while each non - frustrated plaquette is shown as white .",
    "for this instance , the paramagnetic solution of the rgbp equation at @xmath108 becomes unstable at @xmath336 ( @xmath337 ) .",
    "( upper right ) at temperature @xmath338 ( @xmath339 ) , which is just slightly below @xmath316 , one small collective domain begins to emerge , as demonstrated by non - zero magnetizations for some plaquettes in a connected cluster of plaquettes .",
    "the color of each plaquette encodes the mean value of absolute magnetizations as averaged over its four vertices .",
    "( lower right ) at a further decreased temperature @xmath340 ( @xmath341 ) , another collective domain becomes quite evident .",
    "as the temperature further decreases , more collective domains form , and the formed collective domains enlarge in size and their boundaries start to be in contact . as an example , the mean absolute magnetization of each plaquette is shown at @xmath342 ( @xmath343 ) at the lower left panel .",
    ", title=\"fig:\",scaledwidth=40.5% ]   emergence of domains with collective dynamics .",
    "( upper left ) distribution of frustrated plaquettes in a single instance of the 2d edwards - anderson model with periodic boundary conditions .",
    "each frustrated plaquette is shown as black , while each non - frustrated plaquette is shown as white .",
    "for this instance , the paramagnetic solution of the rgbp equation at @xmath108 becomes unstable at @xmath336 ( @xmath337 ) .",
    "( upper right ) at temperature @xmath338 ( @xmath339 ) , which is just slightly below @xmath316 , one small collective domain begins to emerge , as demonstrated by non - zero magnetizations for some plaquettes in a connected cluster of plaquettes .",
    "the color of each plaquette encodes the mean value of absolute magnetizations as averaged over its four vertices .",
    "( lower right ) at a further decreased temperature @xmath340 ( @xmath341 ) , another collective domain becomes quite evident .",
    "as the temperature further decreases , more collective domains form , and the formed collective domains enlarge in size and their boundaries start to be in contact . as an example , the mean absolute magnetization of each plaquette is shown at @xmath342 ( @xmath343 ) at the lower left panel .",
    ", title=\"fig:\",scaledwidth=40.5% ] 0.02   emergence of domains with collective dynamics .",
    "( upper left ) distribution of frustrated plaquettes in a single instance of the 2d edwards - anderson model with periodic boundary conditions .",
    "each frustrated plaquette is shown as black , while each non - frustrated plaquette is shown as white .",
    "for this instance , the paramagnetic solution of the rgbp equation at @xmath108 becomes unstable at @xmath336 ( @xmath337 ) .",
    "( upper right ) at temperature @xmath338 ( @xmath339 ) , which is just slightly below @xmath316 , one small collective domain begins to emerge , as demonstrated by non - zero magnetizations for some plaquettes in a connected cluster of plaquettes .",
    "the color of each plaquette encodes the mean value of absolute magnetizations as averaged over its four vertices .",
    "( lower right ) at a further decreased temperature @xmath340 ( @xmath341 ) , another collective domain becomes quite evident .",
    "as the temperature further decreases , more collective domains form , and the formed collective domains enlarge in size and their boundaries start to be in contact . as an example , the mean absolute magnetization of each plaquette is shown at @xmath342 ( @xmath343 ) at the lower left panel . ,",
    "title=\"fig:\",scaledwidth=40.5% ]   emergence of domains with collective dynamics .",
    "( upper left ) distribution of frustrated plaquettes in a single instance of the 2d edwards - anderson model with periodic boundary conditions .",
    "each frustrated plaquette is shown as black , while each non - frustrated plaquette is shown as white .",
    "for this instance , the paramagnetic solution of the rgbp equation at @xmath108 becomes unstable at @xmath336 ( @xmath337 ) .",
    "( upper right ) at temperature @xmath338 ( @xmath339 ) , which is just slightly below @xmath316 , one small collective domain begins to emerge , as demonstrated by non - zero magnetizations for some plaquettes in a connected cluster of plaquettes .",
    "the color of each plaquette encodes the mean value of absolute magnetizations as averaged over its four vertices .",
    "( lower right ) at a further decreased temperature @xmath340 ( @xmath341 ) , another collective domain becomes quite evident .",
    "as the temperature further decreases , more collective domains form , and the formed collective domains enlarge in size and their boundaries start to be in contact . as an example , the mean absolute magnetization of each plaquette is shown at @xmath342 ( @xmath343 ) at the lower left panel .",
    ", title=\"fig:\",scaledwidth=40.5% ]    we end this section by emphasizing that , the bp and the rgbp iterative process are still able to converge when the paramagnetic fixed point becomes unstable . for the 2d square - lattice edwards - anderson model ( periodic boundary conditions ) , we found that bp converges as long as @xmath344 , in agreement with earlier simulation results @xcite .",
    "the rgbp at @xmath108 converges at even lower temperatures .",
    "in this paper we gave a detailed description of the region graph partition function expansion approach ( first introduced in @xcite ) , and obtained approximate expresses for the free energy and generalized free energies of a general graphical system with an abundant number of short loops .",
    "a series of message - passing equations ( such as region graph belief - propagation and region graph survey - propagation ) were derived in the expansion process .",
    "we have applied the rgbp equation to the square lattice ising model and edwards - anderson model and found that it outperforms the conventional belief - propagation equation .",
    "we also demonstrated that the fixed points of the rgbp equation reveal the heterogeneous pattern of collective domains in the square lattice .",
    "an adaptive strategy of improving the rgbp performance was also suggested .    as discussed in the previous sections ,",
    "there are many issues remain to be explored .",
    "the adaptive rgbp scheme for the 2d edwards - anderson model needs to be implemented .",
    "another very interesting issue is the effect of adding redundancy to the region - graph .",
    "a redundant region - graph have been used for the 2d ising model and edwards - anderson model in various papers within the framework of cluster variation method @xcite .",
    "the performance of rgbp needs to be tested on such a redundant region - graph .",
    "we have performed some preliminary computations and found that the results of rgbp depend on the particular way of removing redundancy .",
    "for example , the region graph @xmath143 shown in the right panel of figure  [ fig : reduntrgfig ] actually is equivalent to the non - redundant region graph @xmath97 of figure  [ fig : rgfig ] .",
    "some other ways of removing redundancy are able to make the paramagnetic rgbp fixed point to be stable at even lower temperatures .    for a general redundant region graph @xmath97 ,",
    "the rgbp equation ( [ eq : rgbp ] ) is not equivalent to the generalized belief - propagation equation ( [ eq : ptoceq ] ) of @xcite .",
    "we are working on the issue of deriving the generalized belief - propagation equation from the approach of partition function expansion .",
    "the three - dimensional edwards - anderson model is believed to have a true spin glass phase .",
    "this system will be studied using rgbp and the region - graph survey - propagation equation in a future work .",
    "particles in a dense liquid have translational degrees of freedom .",
    "it remains to be seen whether a similar partition function expansion scheme can be worked out for systems with mobile particles .",
    "if approximate free energy landscapes can also be built for such systems with the help of message - passing equations , it should be very helpful for understanding structural glasses and supercooled liquids .",
    "a different theoretical approach ( the replica cluster variation method ) of studying finite - dimensional spin glasses has been explored in @xcite .",
    "the message - passing process of this replica cluster variation method appears to be much more complicated than the simple rgbp process .",
    "here we give a detailed derivation of equations ( [ eq : pgamma4 ] ) and ( [ eq : miteration ] ) .",
    "these equations are valid for a non - redundant region graph @xmath97 .",
    "we assume @xmath97 to be non - redundant in this whole section .",
    "first , the region subgraph formed by region @xmath116 and all its descendants is a connected tree ( see the blue - shaded area of figure  [ fig : rgptoc ] ) .",
    "this property ensures the equivalence of ( [ eq : pgamma2 ] ) with ( [ eq : pgamma ] ) .",
    "notice that a region @xmath345 may point to two or more regions of the set @xmath211 .",
    "applying the definition ( [ eq : psialpha ] ) and then the two identities ( [ eq : cni ] ) and ( [ eq : cna ] ) , we obtain that @xmath346^{\\sum\\limits_{\\eta \\in i_\\gamma \\cap r_a } c_\\eta } \\prod\\limits_{i\\in \\gamma } \\bigl[\\psi_i(x_i ) \\bigr]^{\\sum\\limits_{\\eta \\in   i_\\gamma \\cap r_i } c_\\eta } \\nonumber \\\\ & = & \\biggl [ \\prod\\limits_{a\\in \\gamma } \\psi_a(\\underline{x}_{\\partial a } ) \\prod\\limits_{i\\in \\gamma } \\psi_i(x_i ) \\biggr ] \\prod\\limits_{b\\in \\gamma } \\bigl [ \\psi_b(\\underline{x}_{\\partial b } ) \\bigr]^{-\\sum\\limits_{\\eta \\in r_b \\backslash i_\\gamma } c_\\eta } \\prod\\limits_{j\\in \\gamma } \\bigl [ \\psi_j(x_j ) \\bigr]^{-\\sum\\limits_{\\eta \\in   r_j \\backslash i_\\gamma } c_\\eta } .",
    "\\label{eq : weight3}\\end{aligned}\\ ] ] the set @xmath347 contains regions of subgraph @xmath348 except those also belonging to set @xmath211 , and similarly for @xmath349 .    because @xmath348 and @xmath350 are two connected tree subgraphs , we have @xmath351 in the above equation , @xmath352 denotes the branch of the tree @xmath348 that is still connected with @xmath100 if the directed edge @xmath102 is removed ; and @xmath353 has the same definition , i.e. , it is the branch of the tree @xmath350 that contains region @xmath100 but not @xmath101 .",
    "the possibility that a region @xmath345 might point to two ore more regions in @xmath211 does not affect the validity of ( [ eq : identity4 ] ) .",
    "the reason is simple : if @xmath354 and @xmath355 are two children of @xmath100 in @xmath211 , then @xmath354 and @xmath355 do not share any function node nor any variable node in common .",
    "based on ( [ eq : identity4 ] ) , ( [ eq : weight3 ] ) and ( [ eq : pgamma2 ] ) , we obtain the important expression ( [ eq : pgamma4 ] ) . in that equation , the parent - to - message @xmath218",
    "is defined as @xmath356^{-\\sum\\limits_{\\alpha\\in r_b^{\\mu\\rightarrow \\nu } } c_\\alpha } \\prod\\limits_{j\\in \\nu } \\bigl[\\psi_j(x_j ) \\bigr]^{-\\sum\\limits_{\\alpha\\in r_j^{\\mu\\rightarrow \\nu } }   c_\\alpha}\\ ] ] up to a normalization constant ( to be fixed by @xmath357 ) .    using the expression ( [ eq : rgbp ] ) for the probability distribution @xmath358 , it is easy to show that @xmath359^{-\\sum\\limits_{\\alpha \\in r_b^{\\mu\\rightarrow \\nu } } c_\\alpha } \\prod\\limits_{j\\in \\nu } \\bigl[\\psi_j(x_j ) \\bigr]^{-\\sum\\limits_{\\alpha \\in r_j^{\\mu\\rightarrow \\nu } } c_\\alpha } \\nonumber \\\\ & & \\times \\sum\\limits_{\\underline{x}_{\\mu}\\backslash \\underline{x}_{\\nu } } \\biggl [ \\prod\\limits_{\\eta\\in i_\\mu \\backslash i_\\nu } \\psi_\\eta ( \\underline{x}_{\\eta } ) \\biggr ] \\prod\\limits_{\\{(\\alpha\\rightarrow \\lambda ) |",
    "\\alpha \\in b_\\mu , \\lambda \\in i_\\mu \\backslash i_\\nu\\ } } p_{\\alpha\\rightarrow \\lambda}(\\underline{x}_\\lambda ) .\\end{aligned}\\ ] ] notice that @xmath360^{\\sum\\limits_{\\eta \\in r_a\\cap ( i_\\mu \\backslash i_\\nu ) } c_\\eta } \\prod\\limits_{i\\in \\mu } \\bigl [ \\psi_i(x_i)\\bigr]^{\\sum\\limits_{\\eta \\in r_i\\cap ( i_\\mu \\backslash i_\\nu ) }   c_\\eta }   \\\\ & \\quad = \\prod\\limits_{a\\in \\mu\\backslash \\nu } \\bigl[\\psi_a \\bigr]^{1-\\sum\\limits_{\\alpha\\in r_a \\backslash i_\\mu } c_\\alpha } \\prod\\limits_{i\\in \\mu\\backslash \\nu }   \\bigl[\\psi_i \\bigr]^{1-\\sum\\limits_{\\alpha\\in r_i \\backslash i_\\mu } c_\\alpha } \\prod\\limits_{b\\in\\nu } \\bigl[\\psi_b\\bigr]^{\\sum\\limits_{\\eta\\in r_b \\cap ( i_\\mu \\backslash i_\\nu ) } c_\\eta } \\prod\\limits_{j\\in \\nu}\\bigl[\\psi_j\\bigr]^{\\sum\\limits_{\\eta\\in r_j \\cap ( i_\\mu\\backslash i_\\nu ) } c_\\eta } .",
    "\\nonumber\\end{aligned}\\ ] ] then we have @xmath361^{- \\sum\\limits_{\\alpha\\in r_b^{\\mu\\rightarrow \\nu } } c_\\alpha } \\prod\\limits_{j\\in \\nu }",
    "\\bigl[\\psi_j\\bigr]^{- \\sum\\limits_{\\alpha\\in r_j^{\\mu\\rightarrow \\nu } } c_\\alpha } \\prod\\limits_{\\eta\\in i_\\mu\\backslash i_\\nu } \\psi_\\eta ( \\underline{x}_\\eta ) \\nonumber \\\\ & = \\biggl [ \\prod\\limits_{a\\in \\mu\\backslash \\nu } \\psi_a \\prod\\limits_{i\\in \\mu\\backslash \\nu } \\psi_i \\biggr ] \\prod\\limits_{b\\in \\mu\\backslash \\nu } \\bigl[\\psi_b\\bigr]^{-\\sum\\limits_{\\alpha\\in r_b\\backslash i_\\mu } c_\\alpha } \\prod\\limits_{c\\in \\nu } \\bigl[\\psi_c\\bigr]^{- \\sum\\limits_{\\alpha\\in r_c^{\\mu\\rightarrow \\nu } } c_\\alpha+ \\sum\\limits_{\\eta\\in   r_c\\cap ( i_\\mu\\backslash i_\\nu ) } c_\\eta } \\times \\nonumber \\\\ & \\prod\\limits_{j\\in \\mu\\backslash \\nu } \\bigl[\\psi_j\\bigr]^{- \\sum\\limits_{\\alpha\\in r_j\\backslash i_\\mu } c_\\alpha } \\prod\\limits_{k\\in \\nu } \\bigl[\\psi_k\\bigr]^{- \\sum\\limits_{\\alpha\\in r_k^{\\mu\\rightarrow \\nu } } c_\\alpha + \\sum\\limits_{\\eta\\in r_k \\cap ( i_\\mu \\backslash i_\\nu ) } c_\\eta } .",
    "\\label{eq : product1}\\end{aligned}\\ ] ] it is easy to check that , for a function node @xmath362 , @xmath363 where @xmath364 denotes the set formed by all the regions in the region subtree @xmath365 except those which are also members of the region set @xmath366 .",
    "similarly , for a variable node @xmath367 , we have @xmath368 with @xmath369 being the the set formed by all the regions in the region subtree @xmath370 except those which are also members of the region set @xmath366 . with these two equalities , ( [ eq : product1 ] )",
    "is re - written as @xmath361^{- \\sum\\limits_{\\alpha\\in r_b^{\\mu\\rightarrow \\nu } } c_\\alpha } \\prod\\limits_{j\\in \\nu } \\bigl[\\psi_j\\bigr]^{- \\sum\\limits_{\\alpha\\in r_j^{\\mu\\rightarrow \\nu } } c_\\alpha } \\prod\\limits_{\\eta\\in i_\\mu\\backslash i_\\nu } \\psi_\\eta ( \\underline{x}_\\eta ) =   \\biggl [ \\prod\\limits_{a\\in \\mu\\backslash \\nu } \\psi_a \\prod\\limits_{i\\in \\mu\\backslash \\nu } \\psi_i \\biggr ] \\nonumber \\\\ & \\times \\prod\\limits_{b\\in \\mu\\backslash \\nu } \\bigl[\\psi_b\\bigr]^{-\\sum\\limits_{\\alpha\\in r_b\\backslash i_\\mu } c_\\alpha } \\prod\\limits_{c\\in \\nu } \\bigl[\\psi_c\\bigr]^{- \\sum\\limits_{\\alpha \\in r_c^{\\mu\\rightarrow \\nu } \\backslash i_\\mu } c_\\alpha } \\prod\\limits_{j\\in \\mu\\backslash \\nu } \\bigl[\\psi_j\\bigr]^{- \\sum\\limits_{\\alpha\\in r_j\\backslash i_\\mu } c_\\alpha } \\prod\\limits_{k\\in \\nu } \\bigl[\\psi_k\\bigr]^{- \\sum\\limits_{\\alpha \\in r_k^{\\mu\\rightarrow \\nu } \\backslash i_\\mu } c_\\alpha } .",
    "\\label{eq : product2}\\end{aligned}\\ ] ]    combining the above equation with ( [ eq : mmutonu ] ) leads to @xmath371^{- \\sum\\limits_{\\eta\\in r_b\\backslash i_\\mu } c_\\eta } \\prod\\limits_{c\\in \\nu } \\bigl[\\psi_c\\bigr]^{- \\sum\\limits_{\\alpha\\in r_c^{\\mu\\rightarrow \\nu}\\backslash i_\\mu } c_\\alpha } \\prod\\limits_{\\{(\\alpha\\rightarrow \\lambda ) | \\alpha\\in b_\\mu , \\lambda \\in i_\\mu\\backslash i_\\nu\\ } } \\prod\\limits_{d\\in \\lambda } \\bigl[\\psi_d\\bigr]^ { \\sum\\limits_{\\eta \\in r_d^{\\alpha\\rightarrow \\lambda } } c_\\eta } \\nonumber \\\\   & \\prod\\limits_{j\\in \\mu\\backslash \\nu } \\bigl[\\psi_j\\bigr]^{- \\sum\\limits_{\\eta\\in r_j\\backslash i_\\mu } c_\\eta } \\prod\\limits_{k\\in \\nu } \\bigl[\\psi_k\\bigr]^{- \\sum\\limits_{\\alpha\\in r_k^{\\mu\\rightarrow \\nu}\\backslash i_\\mu } c_\\alpha } \\prod\\limits_{\\{(\\alpha\\rightarrow \\lambda ) | \\alpha\\in b_\\mu , \\lambda",
    "\\in i_\\mu\\backslash i_\\nu\\ } } \\prod\\limits_{l\\in \\lambda } \\bigl[\\psi_l\\bigr]^{\\sum\\limits_{\\eta   \\in r_l^{\\alpha\\rightarrow \\lambda } } c_\\eta } \\biggr\\ } .\\end{aligned}\\ ] ] using the the properties ( [ eq : identity4 ] ) for the region trees @xmath348 ( induced by each function node @xmath372 ) and @xmath373 ( induced by each variable node @xmath374 ) , it is not difficult to verify that the expression in the curly brackets of the above equation is equal to @xmath232",
    ". therefore we arrive at the message - passing equation ( [ eq : miteration ] ) for @xmath218 .",
    "we demonstrate that , for a non - redundant region graph @xmath97 , the region graph free energy @xmath178 can be expressed as @xmath375 , with @xmath187 given by ( [ eq : frgbp ] ) .",
    "first , we notice that @xmath376 as defined by ( [ eq : fvande ] ) can be expressed as @xmath377 = f_\\nu - f_{\\nu\\rightarrow \\mu } , \\label{eq : fmunu2}\\ ] ] where @xmath378 is defined through ( [ eq : fmutonu ] ) . in writing down this equation ,",
    "we have assumed that @xmath100 is a parent of @xmath101 . from equation ( [ eq : fa3 ] )",
    "we then obtain that @xmath379 on the other hand , based on the definition ( [ eq : fvande ] ) for @xmath380 we derive that @xmath381 - \\sum\\limits_{\\{(\\mu \\rightarrow \\nu ) | \\mu \\in i_\\alpha\\ } }   f_{\\nu\\rightarrow \\mu } .\\ ] ] from the last two expressions we then get the following simple formula for @xmath187 : @xmath382.\\ ] ] this formula is very similar to ( [ eq : frgbp ] ) , but not yet identical .",
    "now we replace @xmath358 of ( [ eq : talpha2 ] ) by @xmath218 through the relation ( [ eq : mmutonu ] ) , and obtain that @xmath383 \\nonumber \\\\ & & -\\sum\\limits_{\\{(\\mu\\rightarrow \\nu ) | \\mu \\in b_\\alpha , \\nu \\in i_\\alpha\\ } } \\frac{1}{\\beta } \\ln \\biggl [ \\sum\\limits_{\\underline{x}_\\nu }   \\prod\\limits_{b\\in \\nu } \\bigl [ \\psi_b(\\underline{x}_{\\partial b } )   \\bigr]^{-\\sum\\limits_{\\eta\\in r_b^{\\mu\\rightarrow \\nu } } c_\\eta } \\prod\\limits_{j\\in \\nu } \\bigl[\\psi_j(x_j ) \\bigr]^{-\\sum\\limits_{\\eta \\in r_j^{\\mu\\rightarrow \\nu } }   c_\\eta } p_{\\mu\\rightarrow \\nu}(\\underline{x}_\\nu ) \\biggr].\\end{aligned}\\ ] ] we need to prove that @xmath384^{-\\sum\\limits_{\\eta \\in r_b^{\\mu\\rightarrow \\nu } } c_\\eta } \\prod\\limits_{j\\in \\nu } \\bigl[\\psi_j(x_j ) \\bigr]^{-\\sum\\limits_{\\eta \\in r_j^{\\mu\\rightarrow \\nu } }   c_\\eta } p_{\\mu\\rightarrow \\nu}(\\underline{x}_\\nu ) \\biggr ]   = 0 .",
    "\\label{eq : talpha3}\\ ] ] to prove this , it is first noticed that the left side of ( [ eq : talpha3 ] ) is equivalent to @xmath385^{-\\sum\\limits_{\\eta \\in r_b^{\\mu\\rightarrow \\nu } } c_\\eta } \\prod\\limits_{j\\in \\nu } \\bigl[\\psi_j(x_j ) \\bigr]^{-\\sum\\limits_{\\eta \\in r_j^{\\mu\\rightarrow \\nu } }   c_\\eta } p_{\\mu\\rightarrow \\nu}(\\underline{x}_\\nu ) \\biggr ] .\\ ] ] for a non - redundant region graph @xmath97 , the sum in the curly brackets of the above expression is identical to zero , i.e. , for each directed edge @xmath102 : @xmath386 combining equations ( [ eq : f0cluster ] ) , ( [ eq : talpha2 ] ) and ( [ eq : talpha3 ] ) , we obtain the objective equation : @xmath387 \\right\\ } .\\ ] ]",
    "for the local structure shown in figure [ fig : rgbp2d ] , the square - to - rod messages between the regions @xmath98 and @xmath17 are :    @xmath388 } { \\cosh[\\beta ( \\tilde{h}_l-\\tilde{j}_d)]}\\biggr ] + \\frac{1}{4 \\beta } \\ln\\biggl [ \\frac{1+\\tanh [ \\beta \\tilde{j}_c]\\tanh[\\beta ( \\tilde{h}_l+ \\tilde{j}_d ) ] \\tanh [ \\beta ( \\tilde{h}_k+\\tilde{j}_b ) ] } { 1+\\tanh [ \\beta \\tilde{j}_c]\\tanh[\\beta ( \\tilde{h}_l-\\tilde{j}_d ) ] \\tanh[\\beta ( \\tilde{h}_k -\\tilde{j}_b ) ] } \\biggr ] \\nonumber \\\\   & & \\quad\\quad\\quad\\quad\\quad    + \\frac{1}{4 \\beta}\\ln\\biggl [ \\frac{1+\\tanh [ \\beta \\tilde{j}_c]\\tanh[\\beta ( \\tilde{h}_l+\\tilde{j}_d ) ]   \\tanh [ \\beta ( \\tilde{h}_k-\\tilde{j}_b ) ] } { 1+\\tanh [ \\beta \\tilde{j}_c ] \\tanh[\\beta ( \\tilde{h}_l-\\tilde{j}_d ) ]   \\tanh[\\beta ( \\tilde{h}_k + \\tilde{j}_b ) ] } \\biggr ] ,     \\\\ h_{\\alpha\\rightarrow",
    "a}^{(j ) } & = &   h_{b\\rightarrow \\alpha}^{(j ) } + \\frac{1}{2 \\beta}\\ln \\biggl [ \\frac{\\cosh[\\beta ( \\tilde{h}_{k}+\\tilde{j}_{b } ) ] } { \\cosh[\\beta ( \\tilde{h}_k-\\tilde{j}_b)]}\\biggr ] + \\frac{1}{4 \\beta } \\ln\\biggl [ \\frac{1+\\tanh [ \\beta \\tilde{j}_c ] \\tanh[\\beta ( \\tilde{h}_k+ \\tilde{j}_b ) ] \\tanh [ \\beta ( \\tilde{h}_l+\\tilde{j}_d)]}{1+\\tanh [ \\beta \\tilde{j}_c ] \\tanh[\\beta ( \\tilde{h}_k-\\tilde{j}_b ) ] \\tanh[\\beta ( \\tilde{h}_l -\\tilde{j}_d ) ] } \\biggr ] \\nonumber \\\\ & & \\quad\\quad\\quad\\quad\\quad + \\frac{1}{4 \\beta}\\ln\\biggl [ \\frac{1+\\tanh [ \\beta \\tilde{j}_c ] \\tanh[\\beta ( \\tilde{h}_k+\\tilde{j}_b ) ]   \\tanh [ \\beta ( \\tilde{h}_l-\\tilde{j}_d)]}{1+\\tanh [ \\beta \\tilde{j}_c ] \\tanh[\\beta ( \\tilde{h}_k-\\tilde{j}_b ) ] \\tanh[\\beta ( \\tilde{h}_l + \\tilde{j}_d ) ] } \\biggr ] , \\\\",
    "j_{\\alpha\\rightarrow a}^{(i j ) } & = &   j_{i j } + \\frac{1}{4 \\beta}\\ln\\biggl [ \\frac{1+\\tanh [ \\beta \\tilde{j}_c ] \\tanh[\\beta ( \\tilde{h}_l+\\tilde{j}_d ) ]   \\tanh [ \\beta ( \\tilde{h}_k +   \\tilde{j}_b)]}{1+\\tanh [ \\beta \\tilde{j}_c ] \\tanh[\\beta ( \\tilde{h}_l+\\tilde{j}_d ) ] \\tanh[\\beta ( \\tilde{h}_k- \\tilde{j}_b ) ] } \\biggr ] \\nonumber \\\\ & & \\quad\\quad\\quad\\quad\\quad + \\frac{1}{4 \\beta}\\ln\\biggl [ \\frac{1+\\tanh [ \\beta \\tilde{j}_c ]   \\tanh[\\beta ( \\tilde{h}_l-\\tilde{j}_d ) ]   \\tanh [ \\beta ( \\tilde{h}_k-\\tilde{j}_b)]}{1+\\tanh [ \\beta \\tilde{j}_c ] \\tanh[\\beta ( \\tilde{h}_l-\\tilde{j}_d ) ] \\tanh[\\beta ( \\tilde{h}_k+ \\tilde{j}_b ) ] } \\biggr ] , \\label{eq : jalpha_a}\\end{aligned}\\ ] ]    where we have introduced several shorthand notations @xmath389 similarly , the stripe - to - rod messages between the regions @xmath100 and @xmath17 are :    [ eq : storms ] @xmath390 } { \\cosh[\\beta ( h_{f\\rightarrow \\mu}^{(m ) } -j_{i m})]}\\biggr ] \\nonumber \\\\ & & \\quad\\quad + \\frac{1}{4 \\beta } \\ln\\biggl [ \\frac{1+\\tanh [ \\beta ( j_{m",
    "n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m ) } + j_{i m } ) ] \\tanh [ \\beta ( h_{f\\rightarrow \\mu}^{(n)}+j_{j n } ) ] } { 1+\\tanh [ \\beta ( j_{m n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m ) } -j_{i m } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(n)}-j_{j",
    "n } ) ] } \\biggr ] \\nonumber \\\\ & & \\quad\\quad + \\frac{1}{4 \\beta}\\ln\\biggl [ \\frac{1+\\tanh [ \\beta ( j_{m n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m ) } + j_{i m } ) ] \\tanh [ \\beta ( h_{f\\rightarrow \\mu}^{(n)}-j_{j n})]}{1 + \\tanh [ \\beta ( j_{m",
    "n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m ) } -j_{i m } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(n)}+j_{j n } ) ] } \\biggr ] , \\\\ h_{\\mu \\rightarrow a}^{(j ) } & = &   \\frac{1}{2 \\beta}\\ln \\biggl [ \\frac{\\cosh[\\beta ( h_{f\\rightarrow \\mu}^{(n ) } + j_{j n } ) ] } { \\cosh[\\beta ( h_{f\\rightarrow \\mu}^{(n ) } -j_{j n})]}\\biggr ] \\nonumber \\\\ & & \\quad\\quad + \\frac{1}{4 \\beta } \\ln\\biggl [ \\frac{1+\\tanh [ \\beta ( j_{m n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(n ) } + j_{j n } ) ] \\tanh [ \\beta ( h_{f\\rightarrow \\mu}^{(m)}+j_{i m } ) ] } { 1+\\tanh [ \\beta ( j_{m",
    "n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(n ) } -j_{j n } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m)}-j_{i m } ) ] } \\biggr ] \\nonumber \\\\ & & \\quad\\quad + \\frac{1}{4 \\beta}\\ln\\biggl [ \\frac{1+\\tanh [ \\beta ( j_{m",
    "n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(n ) } + j_{j n } ) ] \\tanh [ \\beta ( h_{f\\rightarrow \\mu}^{(m)}-j_{i m})]}{1 + \\tanh [ \\beta ( j_{m n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(n ) } -j_{j n } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m)}+j_{i m } ) ] } \\biggr ] , \\\\",
    "j_{\\mu \\rightarrow a}^{(i j ) } & = &   j_{i j } + \\frac{1}{4 \\beta } \\ln\\biggl [ \\frac{1+\\tanh [ \\beta ( j_{m n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m)}+j_{i m } ) ] \\tanh [ \\beta ( h_{f\\rightarrow \\mu}^{(n ) } + j_{j n})]}{1 + \\tanh [ \\beta ( j_{m n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m)}+j_{i m } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(n ) } -j_{j n } ) ] } \\biggr ]   \\nonumber \\\\ & & \\quad\\quad + \\frac{1}{4 \\beta } \\ln\\biggl [ \\frac{1+\\tanh [ \\beta ( j_{m n } +   j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m)}-j_{i m } ) ] \\tanh [ \\beta ( h_{f\\rightarrow \\mu}^{(n ) } - j_{j n})]}{1 + \\tanh [ \\beta ( j_{m n } + j_{f\\rightarrow \\mu}^{(m n ) } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(m)}-j_{i m } ) ] \\tanh[\\beta ( h_{f\\rightarrow \\mu}^{(n ) } + j_{j n } ) ] } \\biggr ] , \\label{eq : jmu_a}\\end{aligned}\\ ] ]    on the same edges @xmath391 and @xmath392 , the rod - to - square and rod - to - stripe messages are much simpler and are expressed as    @xmath393",
    "at the paramagnetic fixed point ( [ eq : rg2para ] ) , the effective couplings such as @xmath394 and @xmath395 are determined self - consistently through ( [ eq : jalpha_a ] ) and ( [ eq : jmu_a ] ) .",
    "then the rgbp iteration equations for the fields are linearized .",
    "the coefficients of the linearized equations are obtained by the following expressions :    @xmath396 \\bigl ( 1- \\tanh^2 [ \\beta j_{\\alpha\\rightarrow a}^{(i j ) } ] \\tanh^2 [ \\beta j_{j n } ] \\bigr ) } { 1-\\tanh^2 [ \\beta j_{\\alpha\\rightarrow a}^{(i j ) } ] \\tanh^2 [ \\beta j _ { i m } ] \\tanh^2 [ \\beta j_{j n } ] } , \\\\",
    "\\frac{\\partial h_{\\mu\\rightarrow f}^{(m ) } } { \\partial h_{\\alpha\\rightarrow a}^{(j ) } } & = & \\frac{\\tanh[\\beta j_{i m } ] \\tanh[\\beta j_{\\alpha\\rightarrow a}^{(i j ) } ]   \\bigl ( 1- \\tanh^2 [ \\beta j_{j n } ] \\bigr ) } { 1-\\tanh^2 [ \\beta j_{\\alpha\\rightarrow a}^{(i j ) } ] \\tanh^2 [ \\beta j _ { i m } ] \\tanh^2 [ \\beta j_{j n } ] } ; \\\\",
    "\\frac{\\partial h_{\\alpha\\rightarrow d}^{(i ) } } { \\partial h_{\\mu\\rightarrow a}^{(i ) } } & = & 1 , \\\\",
    "\\frac{\\partial h_{\\alpha\\rightarrow d}^{(i ) } } { \\partial h_{\\mu\\rightarrow a}^{(j ) } } & = & \\frac{\\tanh[\\beta \\tilde{j}_a ] \\bigl ( 1-   \\tanh^2 [ \\beta \\tilde{j}_b ] \\tanh^2 [ \\beta \\tilde{j}_c ] \\bigr ) } { 1-\\tanh^2 [ \\beta \\tilde{j}_{b } ] \\tanh^2 [ \\beta \\tilde{j}_{a } ] \\tanh^2 [ \\beta \\tilde{j}_{c } ] } , \\\\",
    "\\frac{\\partial h_{\\alpha\\rightarrow d}^{(l ) } } { \\partial h_{\\mu\\rightarrow a}^{(i ) } } & = & 0 , \\\\",
    "\\frac{\\partial h_{\\alpha\\rightarrow d}^{(l ) } } { \\partial h_{\\mu\\rightarrow a}^{(j ) } } & = & \\frac{\\tanh[\\beta \\tilde{j}_c ] \\tanh [ \\beta \\tilde{j}_b ]   \\bigl ( 1- \\tanh^2 [ \\beta \\tilde{j}_a ] \\bigr ) } { 1-\\tanh^2 [ \\beta \\tilde{j}_{b } ] \\tanh^2 [ \\beta \\tilde{j}_{a } ]   \\tanh^2 [ \\beta \\tilde{j}_{c } ] } , \\\\",
    "\\frac{\\partial h_{\\alpha\\rightarrow c}^{(l ) } } { \\partial h_{\\mu\\rightarrow a}^{(i ) } } & = & \\frac{\\tanh[\\beta \\tilde{j}_a ] \\bigl ( 1- \\tanh^2 [ \\beta \\tilde{j}_b ] \\tanh^2 [ \\beta \\tilde{j}_c ] \\bigr ) } { 1-\\tanh^2 [ \\beta \\tilde{j}_{b } ] \\tanh^2 [ \\beta \\tilde{j}_{a } ] \\tanh^2 [ \\beta \\tilde{j}_{c } ] } , \\\\",
    "\\frac{\\partial h_{\\alpha\\rightarrow d}^{(l ) } } { \\partial h_{\\mu\\rightarrow a}^{(j ) } } & = & \\frac{\\tanh[\\beta \\tilde{j}_a ] \\bigl ( 1- \\tanh^2 [ \\beta \\tilde{j}_b ] \\tanh^2 [ \\beta \\tilde{j}_c ] \\bigr ) } { 1-\\tanh^2 [ \\beta \\tilde{j}_{b } ] \\tanh^2 [ \\beta \\tilde{j}_{a } ] \\tanh^2 [ \\beta \\tilde{j}_{c } ] } .\\end{aligned}\\ ] ]",
    "the linearized rgbp equations for the fields are iterated on a given region graph . during each sweep of the iteration ,",
    "the output field messages of each square region of the region graph are updated once , and the maximum among the absolute values of all the updated fields is recorded . if this maximum decays to zero with the iteration sweeps , the paramagnetic fixed point is then declared as stable .",
    "when the paramagnetic solution is unstable , this maximum value will eventually increase with iteration sweeps ( after a transient decreasing stage ) .",
    "domnguez , e. , lage - catellanos , a. , mulet , r. , ricci - tersenghi , f. , rizzo , t. : characterizing and improving generalized belief propagation algorithms on the 2d edwards - anderson model .",
    "p. p12007 ( 2011 )                      krzakala , f. , montanari , a. , ricci - tersenghi , f. , semerjian , g. , zdeborova , l. : gibbs states and the set of solutions of random constraint satisfaction problems .",
    "usa * 104 * , 10,31810,323 ( 2007 )"
  ],
  "abstract_text": [
    "<S> graphical models for finite - dimensional spin glasses and real - world combinatorial optimization and satisfaction problems usually have an abundant number of short loops . </S>",
    "<S> the cluster variation method and its extension , the region graph method , are theoretical approaches for treating the complicated short - loop - induced local correlations . for graphical models represented by non - redundant or redundant region graphs , </S>",
    "<S> approximate free energy landscapes are constructed in this paper through the mathematical framework of region graph partition function expansion . </S>",
    "<S> several free energy functionals are obtained , each of which use a set of probability distribution functions or functionals as order parameters . these probability distribution function </S>",
    "<S> / functionals are required to satisfy the region graph belief - propagation equation or the region graph survey - propagation equation to ensure vanishing correction contributions of region subgraphs with dangling edges . as a simple application of the general theory , </S>",
    "<S> we perform region graph belief - propagation simulations on the square - lattice ferromagnetic ising model and the edwards - anderson model . considerable improvements over the conventional bethe - peierls approximation are achieved . </S>",
    "<S> collective domains of different sizes in the disordered and frustrated square lattice are identified by the message - passing procedure . </S>",
    "<S> such collective domains and the frustrations among them are responsible for the low - temperature glass - like dynamical behaviors of the system . </S>"
  ]
}