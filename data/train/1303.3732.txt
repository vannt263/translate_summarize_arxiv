{
  "article_text": [
    "in a bidirectional relay network , two users share information via a relay node @xcite .",
    "several protocols have been proposed for such a network under the practical half - duplex constraint , i.e. , a node can not transmit and receive at the same time and in the same frequency band .",
    "the simplest protocol is the traditional two - way protocol in which the transmission is accomplished in four successive point - to - point phases : user 1-to - relay , relay - to - user 2 , user 2-to - relay , and relay - to - user 1 .",
    "in contrast , the time division broadcast ( tdbc ) protocol exploits the broadcasting capability of the wireless medium and combines the relay - to - user 1 and relay - to - user 2 phases into one phase , the broadcast phase @xcite .",
    "thereby , the relay broadcasts a superimposed codeword , carrying information for both user 1 and user 2 , such that each user is able to recover its intended information by self - interference cancellation . to further increase the spectral efficiency",
    ", the multiple access broadcast ( mabc ) protocol was proposed in which the user 1-to - relay and user 2-to - relay phases are also combined into one phase , the multiple - access phase @xcite . in the multiple - access phase , user 1 and",
    "user 2 simultaneously transmit to the relay , which decodes both messages .",
    "for the bidirectional relay network without a direct link between user 1 and user 2 , the capacity regions of all six possible transmission modes , i.e. , the four point - to - point modes , the multiple access mode , and the broadcast mode , are known @xcite,@xcite . using this knowledge ,",
    "a significant research effort has been dedicated to obtaining the achievable rate region and the capacity of the bidirectional relay network with and without fading @xcite-@xcite . using this knowledge ,",
    "a significant research effort has been dedicated to obtaining the achievable rate region of the bidirectional relay network @xcite-@xcite . specifically , the achievable rates of most existing protocols for two - hop relay transmission are limited by the instantaneous capacity of the weakest link associated with the relay .",
    "the reason for this is the fixed schedule of using the transmission modes which is adoped in all existing protocols , and does not exploit the instantaneous channel state information ( csi ) of the involved links . for one - way relaying ,",
    "an adaptive link selection protocol was proposed in @xcite where based on the instantaneous csi , in each time slot , either the source - relay link or the relay - destination link is selected for transmission . to this end",
    ", the relay has to have a buffer for data storage .",
    "this strategy was shown to achieve the capacity of the one - way relay channel with fading @xcite .    motivated by the protocols in @xcite and @xcite , our goal is to utilize all available degrees of freedom in the three - node half - duplex bidirectional relay network with fading , via a buffer - aided and adaptive mode selection protocol . in particular , given the fixed transmit powers of all three nodes in the bidirectional relay network",
    ", we find a policy which selects the optimal transmission mode from the six available modes in each time slot such that the sum rate is maximized .",
    "a similar problem was considered in @xcite .",
    "however , the selection policy in @xcite does not use all possible modes , i.e. , it only selects between two point - to - point modes and the broadcast mode , and assumes that the transmit powers of all three nodes are identical .",
    "we will show that considering only the three modes in @xcite is not optimal .",
    "in fact , the multiple access mode is selected with non - zero probability in the proposed optimal selection policy .",
    "finally , we note that the advantages of buffering come at the expense of an increased end - to - end delay .",
    "therefore , the proposed protocol is suitable for applications that are not sensitive to delay .",
    "the delay analysis of the proposed protocol is beyond the scope of the current work and is left for future research .",
    "the remainder of the paper is organized as follows . in section",
    "[ sysmod ] , the system model is presented . in section [ adapmod ] ,",
    "the average sum rate is investigated and the optimal mode selection policy is provided .",
    "simulation results are presented in section [ simres ] .",
    "finally , section [ conclusion ] concludes the paper .",
    "in this section , we first describe the channel model and review the achievable rates for the six possible transmission modes .",
    "[ c][c][0.75]@xmath0 [ c][c][0.75]@xmath1 [ c][c][0.75]@xmath2 [ c][c][0.75]@xmath3 [ c][c][0.75]@xmath4 [ c][c][0.75]@xmath5 [ c][c][0.75]@xmath6 [ c][c][0.75]@xmath7 [ c][c][0.75]@xmath8 [ c][c][0.75]@xmath9     [ c][c][0.5]@xmath0 [ c][c][0.5]@xmath1 [ c][c][0.5]@xmath2 [ c][c][0.75]@xmath10 [ c][c][0.75]@xmath11 [ c][c][0.75]@xmath12 [ c][c][0.75]@xmath13 [ c][c][0.75]@xmath14 [ c][c][0.75]@xmath15     we consider a simple network in which users 1 and 2 exchange information with the help of a relay node , as shown in fig .",
    "[ figsysmod ] .",
    "we assume that there is no direct link between user 1 and user 2 , and thus , user 1 and user 2 communicate with each other only through the relay node .",
    "we assume that all three nodes in the network are half - duplex .",
    "furthermore , we assume that time is divided into slots of equal length and each node transmits codewords which span one time slot except in the multiple access mode in which the nodes may transmit codewords which span a fraction of the time slot .",
    "the duration of one time slot is normalized to one .",
    "we assume that the users - to - relay and relay - to - users channels are all impaired by awgn having zero mean and unit variance , and block fading , i.e. , the channel coefficients are constant during one time slot and change from one time slot to the next .",
    "moreover , the channel coefficients are assumed to be reciprocal such that the user 1-to - relay and user 2-to - relay channels are identical to the relay - to - user 1 and relay - to - user 2 channels in each time slot , respectively .",
    "let @xmath3 and @xmath4 denote the channel coefficients between user 1 and the relay and between user 2 and the relay in the @xmath16-th time slot , respectively .",
    "furthermore , let @xmath17 and @xmath18 denote the squares of the channel coefficient amplitudes in the @xmath16-th time slot .",
    "@xmath19 and @xmath20 are assumed to be ergodic and stationary random processes with means @xmath21 and @xmath22 in expectations for notational simplicity . ] , respectively , where @xmath23 denotes expectation . since the noise is awgn , in order to achieve the capacity in each mode",
    ", each node has to transmit codewords which are gaussian distributed .",
    "therefore , the transmitted codewords of user 1 , user 2 , and the relay are composed of symbols which are modeled as gaussian random variables with variances @xmath24 , and @xmath25 , respectively , where @xmath26 is the transmit power of node @xmath27 . for ease of notation , we define @xmath28 . in the following ,",
    "we introduce the transmission modes and their achievable rates .      in the considered bidirectional relay network",
    "only six transmission modes are possible , cf . fig .",
    "[ figmodes ] .",
    "the six possible transmission modes are denoted by @xmath29 , and @xmath30 , denotes the transmission rate from node @xmath31 to node @xmath32 in the @xmath16-th time slot .",
    "let @xmath8 and @xmath9 denote two infinite - size buffers at the relay in which the received information from user 1 and user 2 is stored , respectively .",
    "moreover , @xmath33 denotes as the amount of normalized information in bits / symbol available in buffer @xmath34 in the @xmath16-th time slot . using this notation ,",
    "the transmission modes and their respective rates are presented in the following :    @xmath35 : user 1 transmits to the relay and user 2 is silent . in this mode ,",
    "the maximum rate from user 1 to the relay in the @xmath16-th time slot is given by @xmath36 , where @xmath37 .",
    "the relay decodes this information and stores it in buffer @xmath8 .",
    "therefore , the amount of information in buffer @xmath8 increases to @xmath38 .",
    "@xmath39 : user 2 transmits to the relay and user 1 is silent . in this mode , the maximum rate from user 2 to the relay in the @xmath16-th time slot is given by @xmath40 , where @xmath41 .",
    "the relay decodes this information and stores it in buffer @xmath9 .",
    "therefore , the amount of information in buffer @xmath9 increases to @xmath42 .",
    "@xmath43 : both users 1 and 2 transmit to the relay simultaneously . for this mode",
    ", we assume that multiple access transmission is used , see @xcite .",
    "thereby , the maximum achievable sum rate in the @xmath16-th time slot is given by @xmath44 , where @xmath45 . since",
    "user 1 and user 2 transmit independent messages , the sum rate , @xmath46 , can be decomposed into two rates , one from user 1 to the relay and the other one from user 2 to the relay .",
    "moreover , these two capacity rates can be achieved via time sharing and successive interference cancellation .",
    "thereby , in the first @xmath47 fraction of the @xmath16-th time slot , the relay first decodes the codeword received from user 2 and considers the signal from user 1 as noise .",
    "then , the relay subtracts the signal component of user 2 from the received signal and decodes the codeword received from user 1 .",
    "a similar procedure is performed in the remaining @xmath48 fraction of the @xmath16-th time slot but now the relay first decodes the codeword from user 1 and treats the signal of user 2 as noise , and then decodes the codeword received from user 2 .",
    "therefore , for a given @xmath49 , we decompose @xmath46 as @xmath50 and the maximum rates from users 1 and 2 to the relay in the @xmath16-th time slot are @xmath51 and @xmath52 , respectively . @xmath53 and @xmath54 are given by    ll[cr ] c_12r(i)=t(i ) c(p_1s_1(i ) ) + ( 1-t(i ) ) c ( ) + c_21r(i)=(1-t(i ) ) c(p_2s_2(i ) ) + t(i ) c ( )    the relay decodes the information received from user 1 and user 2 and stores it in its buffers @xmath8 and @xmath9 , respectively .",
    "therefore , the amount of information in buffers @xmath8 and @xmath9 increase to @xmath38 and @xmath42 , respectively .",
    "@xmath55 : the relay transmits the information received from user 2 to user 1 .",
    "specifically , the relay extracts the information from buffer @xmath9 , encodes it into a codeword , and transmits it to user 1 .",
    "therefore , the transmission rate from the relay to user 1 in the @xmath16-th time slot is limited by both the capacity of the relay - to - user 1 channel and the amount of information stored in buffer @xmath9 .",
    "thus , the maximum transmission rate from the relay to user 1 is given by @xmath56 , where @xmath57 .",
    "therefore , the amount of information in buffer @xmath9 decreases to @xmath58 .",
    "@xmath59 : this mode is identical to @xmath55 with user 1 and 2 switching places . the maximum transmission rate from the relay to user 2 is given by @xmath60 , where @xmath61 and the amount of information in buffer @xmath8 decreases to @xmath62 .",
    "@xmath63 : the relay broadcasts to both user 1 and user 2 the information received from user 2 and user 1 , respectively .",
    "specifically , the relay extracts the information intended for user 2 from buffer @xmath8 and the information intended for user 1 from buffer @xmath9 .",
    "then , based on the scheme in @xcite , it constructs a superimposed codeword which contains the information from both users and broadcasts it to both users .",
    "thus , in the @xmath16-th time slot , the maximum rates from the relay to users 1 and 2 are given by @xmath64 and @xmath65 , respectively .",
    "therefore , the amount of information in buffer @xmath8 and @xmath9 decrease to @xmath62 and @xmath58 , respectively .",
    "our aim is to develop an optimal selection policy which selects one of the six possible transmission modes in each time slot such that , given @xmath66 , @xmath67 , and @xmath25 , the average sum rate of both users is maximized . to this end",
    ", we introduce six binary variables @xmath68 , where @xmath69 indicates whether or not transmission mode @xmath70 is selected in the @xmath16-th time slot .",
    "in particular , @xmath71 if mode @xmath70 is selected and @xmath72 if it is not selected in the @xmath16-th time slot .",
    "moreover , since in each time slot only one of the six transmission modes can be selected , only one of the mode selection variables is equal to one and the others are zero , i.e. , @xmath73 holds .    in the proposed framework",
    ", we assume that one node ( e.g. the relay node ) is responsible for deciding which transmission mode is selected based on the full csi of both links and the proposed protocol , cf .",
    "theorem  [ fixprot ] .",
    "then , it sends its decision to the other nodes and transmission in time slot @xmath16 begins .",
    "furthermore , for each node to be able to decode their intended messages and adapt their transmission rates , all three nodes have to have full csi of both links .",
    "in this section , we first investigate the achievable average sum rate of the network . then , we formulate a maximization problem whose solution yields the maximum average sum rate .",
    "we assume that user 1 and user 2 always have enough information to send in all time slots and that the number of time slots , @xmath74 , satisfies @xmath75 .",
    "therefore , using @xmath69 , the user 1-to - relay , user 2-to - relay , relay - to - user 1 , and relay - to - user 2 average transmission rates , denoted by @xmath76 , @xmath77 , @xmath78 , and @xmath79 , respectively , are obtained as    cll[ratreg123 ] |r_1r & = _",
    "i = 1^n +         the average rate from user 1 to user 2 is the average rate that user 2 receives from the relay , i.e. , @xmath79 .",
    "similarly , the average rate from user 2 to user 1 is the average rate that user 1 receives from the relay , i.e. , @xmath78 . in the following theorem",
    ", we introduce a useful condition for the queues in the buffers of the relay leading to the optimal mode selection policy .",
    "[ queue ] @xmath80 sum rate , @xmath81 , for the considered bidirectional relay network is obtained when the queues in buffers @xmath8 and @xmath9 are at the edge of non - absorbtion .",
    "more precisely , the following conditions must hold for the maximum sum rate :    lll[ratregapp456-buffer ] |r_1r=|r_r2 = _",
    "i = 1^n c_r2(i ) +     where @xmath76 and @xmath77 are given by ( [ ratreg123]a ) and ( [ ratreg123]b ) , respectively",
    ".    please refer to appendix [ appqueue ] .    using this theorem",
    ", we now derive the optimal transmission mode selection policy .",
    "the available degrees of freedom in the considered network are the mode selection variables @xmath82 , @xmath83 and the time sharing variable in the multiple access mode , @xmath49 , @xmath84 . in the following , we formulate a problem for optimization of @xmath85 and @xmath86 such that the average sum rate , @xmath81 , is maximized :    cll[fixprob ] & |r_1r+|r_2r + & : |r_1r=|r_r2 + & : |r_2r=|r_r1 + & : _ k = 1 ^ 6 q_k ( i ) = 1 , i + & : q_k(i ) [ 1-q_k(i ) ] = 0 , i , k + & : 0t(i)1 , i.    where @xmath87 and @xmath88 are due to theorem  [ queue ] , @xmath89 and @xmath90 guarantee that only one of the transmission modes is selected in each time slot , and @xmath91 specifies the interval of the time sharing variable .",
    "considering constraints @xmath87 and @xmath88 , the sum rate , @xmath81 , is also given by @xmath92 .",
    "as will be seen later , the solution of ( [ fixprob ] ) , i.e. , the optimal mode selection policy may require coin flips .",
    "therefore , we define @xmath93 as the outcomes of the @xmath94-th coin flip in the @xmath16-th time slot .",
    "the probabilities of the possible outcomes of the @xmath94-th coin flip are @xmath95 and @xmath96 . in the following theorem",
    ", we provide the solution to the maximization problem in ( [ fixprob ] ) . to this end",
    ", we define three mutually exclusive signal - to - noise ratio ( snr ) regions and each region requires a different optimal selection policy . for given @xmath97 , @xmath98 , @xmath66 , @xmath67 , and @xmath25 , exactly one of the snr regions is applicable .",
    "[ fixprot ] the optimal mode selection policy which maximizes the average sum rate of the considered three - node half - duplex bidirectional relay network with awgn and block fading is given by    lll q_k^*(i)=    1 , & k^*= \\{_k(i)_k(i ) } + 0 , &    where @xmath99 is referred to as the selection metric , given by    lll[selecmet ] _",
    "1(i ) = ( 1-_1)c_1r(i ) + _ 2(i ) = ( 1-_2)c_2r(i ) + _ 3(i ) = ( 1-_1)c_12r(i)+(1-_2)c_21r(i ) + _ 4(i ) = _ 2 c_r1(i ) + _",
    "5(i ) = _ 1 c_r2(i ) + _ 6(i ) = _ 1 c_r2(i)+_2 c_r1(i )    and @xmath100 is a binary indicator variable which determines whether @xmath70 is a _ possible candidate _ for selection in the @xmath16-th time slot ,",
    "i.e. , mode @xmath70 can not be selected if @xmath101 , and @xmath102 and @xmath103 are decision thresholds .",
    "for the values of @xmath104 , the optimal values of @xmath102 and @xmath103 in ( [ selecmet ] ) , and the optimal value of @xmath49 in @xmath53 and @xmath54 in ( [ selecmet]c ) , we distinguish three mutually exclusive snr regions :    * snr region @xmath105 : * snr region @xmath105 is chractarized by @xmath106 with @xmath107\\right\\ } } , \\omega_2=\\frac{e\\{qc_{2r}\\}}{e\\left\\{(1-q)c_{r1}\\right\\ } } , \\omega_3^{l } = \\frac{e\\{c_{r2}\\}}{e\\{c_{r}\\}}$ ] , and @xmath108 , where @xmath109 is defined as    rl[q1 ] q(i)=    1 , &",
    "\\ { p_2>p_r _ 3 _ 6|__1=1,_2=_2^*^t(i)=0,i } + & \\ { p_2<p_r _ 3 _ 6|__1=_1^*,_2=0^t(i)=0,i } + 0 , &    .    in ( [ q1 ] ) , if @xmath110 , @xmath111 is chosen such that @xmath112 holds , whereas if @xmath113 , @xmath114 is chosen such that @xmath115\\}=e\\{(1-q)c_{r2}\\}$ ] holds .    for this snr region , @xmath116 , @xmath117 , and @xmath101 , for @xmath118 , @xmath117 ,",
    "whereas @xmath104 for @xmath119 , and the thresholds @xmath102 and @xmath103 are as follows    llll p_2>p_r    _ 1=1 + _ 2=_2^ *    _ 5(i)=0 + _",
    "3(i)=1-_2(i)=x_1(i ) + _",
    "6(i)=1     + p_2<p_r    _ 1=_1^ * + _ 2=0    _ 2(i)=0 , + _",
    "6(i)=1-_5(i)=x_2(i ) + _",
    "3(i)=1     + p_2=p_r    _ 1=1 + _ 2=0    _",
    "2(i)=x_3(i ) [ 1-x_4(i ) ] + _ 3(i)=x_3(i ) x_4(i ) + _ 5(i)=[1-x_3(i)][1-x_5(i ) ] + _ 6(i)=[1-x_3(i)]x_5(i )    where the coin flip probabilities are @xmath120 , and for @xmath121 , we have the freedom to choose any value in the interval @xmath122 $ ] .",
    "* snr region @xmath123 : * snr region @xmath123 is charactarized by @xmath124 with @xmath125\\right\\ } } , \\omega_2\\hspace{-0.8mm}=\\hspace{-0.8mm}\\frac{e\\{qc_{1r}\\}}{e\\left\\{(1-q)c_{r2}\\right\\ } } , \\omega_3^{l } = \\frac{e\\{c_{r1}\\}}{e\\{c_{r}\\}}$ ] , and @xmath126 , where @xmath109 is defined as    rl[q2 ] q(i)=    1 , & \\ { p_1>p_r _ _ 1=_1^*,_2=1^t(i)=1,i } + & \\ { p_1<p_r _ _ 1=0,_2=_2^*^t(i)=1,i } + 0 , &    .    in ( [ q2 ] ) ,",
    "if @xmath127 , the threshold @xmath114 is chosen such that @xmath128 holds , whereas if @xmath129 , the threshold @xmath111 is chosen such that @xmath130\\}{\\hspace{-0.7mm}=\\hspace{-0.7mm}}e\\{(1{\\hspace{-0.7mm}<\\hspace{-0.7mm}}q)c_{r1}\\}$ ] holds .    for this snr region , @xmath131 , @xmath117 , and @xmath101 , for @xmath132 , @xmath117 , whereas @xmath104 for @xmath133 , and the thresholds @xmath102 and @xmath103 are as follows    llll p_1>p_r    _ 1=_1^ * + _ 2=1    _ 4(i)=0 + _",
    "3(i)=1-_1(i)=x_1(i ) + _",
    "6(i)=1     + p_1<p_r    _",
    "1=0 + _ 2=_2^ *    _ 1(i)=0 , + _",
    "6(i)=1-_4(i)=x_2(i ) + _",
    "3(i)=1     + p_1=p_r    _ 1=0 + _ 2=1    _",
    "1(i)=x_3(i ) [ 1-x_4(i ) ] + _ 3(i)=x_3(i ) x_4(i ) + _ 4(i)=[1-x_3(i)][1-x_5(i ) ] + _ 6(i)=[1-x_3(i)]x_5(i )    where the coin flip probabilities are @xmath120 , and for @xmath121 , we have the freedom to choose any value in the interval @xmath122 $ ] .",
    "* snr region @xmath134 : * the snr region is @xmath134 if and only if it is not @xmath105 or @xmath123 . for snr region @xmath134 , @xmath101 for @xmath135 and @xmath136 for @xmath137 , @xmath117 , and @xmath49 is given by    c[flip ] t(i ) =    0 , t 0 + t , 0",
    "< t < 1 + 1 , t 1    where @xmath138 and @xmath109 is given by    c[q0 ] q(i ) =    1 , + 0 ,    where @xmath139 is chosen such that @xmath140 holds . moreover , if @xmath141 , we obtain @xmath142 .",
    "otherwise , if @xmath143 or @xmath144 , we obtain @xmath145 and @xmath146 , respectively , and @xmath102 and @xmath103 are chosen such that @xmath87 and @xmath88 in ( [ fixprob ] ) hold",
    ".    please refer to appendix [ appkkt ] .",
    "we note that in the proposed optimal policy , regardless of the snr region , the multiple access and broadcast modes are always selected with non - zero probability . only in the extreme case ,",
    "when the average snr of one of the links is much larger than the average snr of the other link , some of the point - to - point modes are also selected in the optimal policy .",
    "also , the mode selection metric @xmath99 includes two parts .",
    "the first part is the capacity of mode @xmath70 , and the second part are the decision thresholds @xmath102 and/or @xmath103 .",
    "the capacity is a function of the instantaneous csi , but the decision thresholds @xmath102 and @xmath103 depend only on the statistics of the channels .",
    "hence , the decision thresholds , @xmath102 and @xmath103 , can be obtained offline and used as long as the channel statistics remain unchanged .    to find the optimal values of @xmath102 and @xmath103",
    ", we need one / two - dimensional searches over @xmath147 $ ] .",
    "specifically , in snr regions @xmath105 and @xmath123 , at least one of the thresholds @xmath102 and @xmath103 is given .",
    "therefore , at most one one - dimensional search is required . in snr region",
    "@xmath134 , if @xmath148 , we obtain @xmath142 , therefore , a one - dimensional search is required to determine @xmath139 . however ,",
    "if @xmath149 or @xmath150 , we need a two - dimensional search to find @xmath102 and @xmath103 .",
    "in this section , we evaluate the maximum average sum rate in the considered bidirectional relay network for rayleigh fading . thus , channel gains @xmath19 and @xmath20 follow exponential distributions with averages @xmath97 and @xmath98 , respectively .",
    "furthermore , the transmit powers of user 1 and user 2 are identical and set to @xmath151 db , and @xmath152 db .",
    "the number of time slots used in the simulations is @xmath153 .",
    "[ comparison ] illustrates the maximum achievable sum rate versus @xmath97 . in order to simulate all possible cases introduced in theorem  [ fixprot ] , we consider @xmath154 , which yields the solid lines in fig .",
    "[ comparison ] . as the value of @xmath97 varies from @xmath155 db to @xmath156 db in fig .",
    "[ comparison ] , the snr region changes from @xmath123 to @xmath134 and then from @xmath134 to @xmath105 . since in snr region @xmath123",
    "the bottleneck is the relay - to - user 1 link , reducing @xmath97 reduces the sum rate . on the other hand , in snr region @xmath105 ,",
    "the bottleneck link is the relay - to - user 2 link , and therefore , for large @xmath97 , the maximum average sum rate saturates .",
    "[ c][c][0.75]@xmath157 [ c][c][0.75]@xmath158 [ l][c][0.45]@xmath159 [ l][c][0.45]@xmath160 [ l][c][0.45]@xmath161 [ l][c][0.45]@xmath162}\\,(p_r=10\\,\\text{db})$ ] [ l][c][0.45]@xmath163 [ l][c][0.45]@xmath164 [ l][c][0.45]@xmath165 [ c][c][0.65]@xmath155 [ c][c][0.65]@xmath166 [ c][c][0.65]@xmath167 [ c][c][0.65]@xmath168 [ c][c][0.65]@xmath169 [ c][c][0.65]@xmath170 [ c][c][0.65]@xmath171 [ c][c][0.65]@xmath172 [ c][c][0.65]@xmath173 [ c][c][0.65]@xmath174 [ c][c][0.65]@xmath156 [ c][c][0.65]@xmath170 [ c][c][0.65]@xmath175 [ c][c][0.65]@xmath176 [ c][c][0.65]@xmath177 [ c][c][0.65]@xmath171 [ c][c][0.65]@xmath178 [ c][c][0.65]@xmath179 [ c][c][0.65]@xmath180 [ c][c][0.65]@xmath172 .,title=\"fig:\",width=3 ]    as performance benchmarks , we consider the traditional two - way , the tdbc @xcite , the mabc @xcite , and the buffer - aided protocol in @xcite .",
    "since in @xcite , the protocol is derived for @xmath181 , in fig .  3 , we only show the sum rates of the benchmark schemes for @xmath182 . from the comparison in fig .  3",
    ", we observe that a considerable gain is obtained by adaptive mode selection compared to the traditional two - way , tdbc , and mabc protocols .",
    "furthermore , a small gain is obtained compared to the buffer - aided protocol in @xcite which selects only the user 1-to - relay , user 2-to - relay , and broadcast modes adaptively .",
    "finally , we note that our protocol is derived for given @xmath97 , @xmath98 , @xmath66 , @xmath67 , and @xmath25 , and without a constraint on the total average power consumed by all nodes .",
    "the problem with a total average power constraint would lead to a different solution .",
    "we have derived the optimal transmission mode selection policy for sum rate maximization of the three - node half - duplex bidirectional buffer - aided relay network with fading links and fixed transmit powers at the nodes .",
    "the proposed selection policy determines the optimal transmission mode based on the instantaneous csi of the involved links in each time slot and their long - term statistics .",
    "simulation results confirmed that the proposed selection policy outperforms the existing protocols from the literature in terms of average sum rate .",
    "let @xmath183 and @xmath184 denote the average rates achieved by the relay assuming that buffers @xmath8 and @xmath9 always have enough information to supply .",
    "then , @xmath183 and @xmath184 are given by    lll [ capacity ] |c_r1= _ i = 1^n c_r1(i ) +     if we assume that @xmath185 holds , i.e. , the average rate flowing into the buffer is larger than or equal to the average capacity that can flow out of the buffer , then the buffer always has enough information to supply and @xmath78 in ( [ ratreg123 ] ) becomes @xmath186 , where @xmath183 is given in ( [ capacity]a ) . for a proof of this property , we refer to the proof of theorem 1 in ( * ? ? ?",
    "* appendix a ) . on the other hand ,",
    "if we assume that @xmath187 holds , i.e. , the average information flowing into the buffer is less than the average capacity that can flow out of the buffer , then by the law of conservation of flow , we obtain @xmath188 .",
    "similar results hold for @xmath79 , @xmath76 , and @xmath184 .",
    "hence , @xmath78 and @xmath79 can be written as    lll[eq_1 ] |r_r1 =          +            on the other hand , ( [ eq_1 ] ) can also be written as    lll[eq_2 ] |r_r1 = \\{|r_2r,|c_r1}[eq_2b ] +     i.e. , the average rate flowing out of buffer @xmath8 ( @xmath9 ) is limited by the minimum of the average rate flowing into the buffer and the capacity rate that can flow out of the buffer . we will show that , in the optimal selection policy , @xmath189 and @xmath190 must hold , and as a result from ( [ eq_2]a ) and ( [ eq_2]b ) , we obtain @xmath191 and @xmath192 . to show this , we denote by @xmath193 the set comprising the time slots @xmath16 in which @xmath71 , i.e.",
    ", the elements in @xmath193 represent the time slots in which transmission mode @xmath70 is selected in the optimal solution .",
    "note that @xmath194 , where @xmath195 denotes the cardinality of a set and @xmath196 denotes an empty set with zero cardinality . we will show that , except for the case when both arguments of the @xmath197 functions in ( [ eq_2]a ) and ( [ eq_2]b ) are equal , all other cases result in suboptimal sum rate or can be safely replaced with the case when both arguments of the @xmath197 function are equal without reducing the sum rate .",
    "for the two @xmath197 functions , we have to consider the following nine cases : + * case 1 : * if @xmath198 and @xmath199 , then we can move any indices @xmath16 from @xmath200 , or @xmath201 to @xmath202 and thereby increase both @xmath183 and @xmath184 , and thus improve the sum rate .",
    "hence , @xmath198 and @xmath199 can not hold since the resulting sum rate is suboptimal . + * case 2 : * if @xmath203 and @xmath199 , then if @xmath204 , one can move some indices from @xmath205 to @xmath206 which maintains @xmath203 and increases @xmath183 , and consequently increases the sum rate , thereby contradicting optimality . on the other hand , if @xmath207 , we have @xmath208 since otherwise , @xmath209 and because we have assumed @xmath199 , we obtain @xmath210 . hence , assume @xmath207 and @xmath211 , then there are two possibilities .",
    "the first is when @xmath212 , @xmath213 for which @xmath214 .",
    "then , since @xmath53 becomes @xmath215 , we can move some indices from @xmath201 to @xmath216 , which maintains @xmath203 and decreases @xmath77 until we obtain @xmath217 , thereby contradicting @xmath199 .",
    "however , if @xmath218 for some time slots @xmath16 for which @xmath214 , then since @xmath219 holds , we can move some indices from @xmath201 to @xmath216 and @xmath206 such that @xmath203 is maintained and @xmath183 is increased and thereby the sum rate is increased , which results in a contradiction of the optimal sum rate assumption . +",
    "* case 3 : * if @xmath203 and @xmath220 , then if @xmath221 , we can move some indices of @xmath206 to @xmath205 which maintains @xmath203 and increases @xmath77 and consequently increases the sum rate and thus contradicts optimality . on the other hand , if @xmath222 , we must have @xmath223 , otherwise , @xmath224 , and since we have assumed @xmath220 , we obtain @xmath210 . however , if @xmath225 , we can move some of the indices in @xmath202 to @xmath226 which maintains @xmath203 and decreases @xmath183 until we obtain @xmath217 , thereby contradicting @xmath220 . + * case 4 : * if @xmath198 and @xmath220 , then if @xmath221 , we can move some indices of @xmath206 to @xmath226 , which increases @xmath184 and consequently the sum rate and thereby contradicting optimality",
    ". however , if @xmath222 , then we must have @xmath225 otherwise @xmath227 leading to @xmath210 and the rest of the conclusions are similar to that in case 2 . then ,",
    "if @xmath225 , one can move some of the indices from @xmath202 to @xmath226 which maintains @xmath198 but decreases @xmath183 until we obtain @xmath217 and the rest of conclusions are similar to those in case 2 .    the conclusions for the four remaining cases , ( @xmath228 and @xmath220 ) , ( @xmath198 and @xmath217 ) , ( @xmath228 and @xmath217 ) , and ( @xmath228 and @xmath199 ) are similar to those in case 1 , case 2 , case 3 and case 4 , respectively .",
    "therefore , the final case remaining for the optimal solution is @xmath229 and @xmath230 .",
    "this completes the proof .",
    "in this appendix , we solve the optimization problem given by ( [ fixprob ] ) .",
    "we first relax the binary condition for @xmath69 , i.e. , @xmath231=0 $ ] , to @xmath232 , and later in appendix [ appbinrelax ] , we prove that the binary relaxation does not affect the maximum average sum rate . in the following ,",
    "we investigate the karush - kuhn - tucker ( kkt ) necessary conditions of the relaxed optimization problem and then show that the necessary conditions result in a unique sum rate and thus the solution is optimal .    to simplify the usage of the kkt conditions , we formulated a minimization problem equivalent to the relaxed maximization problem in ( [ fixprob ] ) as follows    cll[fixprobmin ] & -(|r_1r+|r_2r ) + & : |r_1r-|r_r2=0 + & : |r_2r-|r_r1=0 + & : _ k = 1 ^ 6 q_k ( i ) - 1 = 0 , i + & : q_k(i)-1 0 , i , k + & : -q_k(i ) 0 , i , k + & : t(i)-1 0 , i + & : -t(i ) 0 , i.    the lagrangian function for the above optimization problem is provided in ( [ kkt function ] ) at the top of the next page where @xmath233 and @xmath234 are the lagrange multipliers corresponding to constraints @xmath235 and @xmath236 , respectively .",
    "the kkt conditions include the following :    l[kkt function ] = + - ( |r_1r+|r_2r ) + _ 1(|r_1r-|r_r2 ) + _ 2(|r_2r-|r_r1 ) + _ i = 1^n ( i ) ( _ k = 1 ^ 6 q_k ( i ) - 1 ) + + _ i = 1^n _ k = 1 ^ 6 _ k ( i ) ( q_k ( i ) - 1 ) - _ i = 1^n _ k = 1 ^ 6 _ k ( i ) q_k ( i ) + _ i = 1^n _ 1(i ) ( t(i)-1 ) - _ i = 1^n _ 0(i ) t(i )    * 1 ) * stationary condition : the differentiation of the lagrangian function with respect to the primal variables , @xmath69 and @xmath49 for @xmath237 , is equal to zero for the optimal solution , i.e. ,    cccl[stationary condition ] & = & 0 & i , k + & = & 0 & i.    * 2 ) * primal feasibility condition : the optimal solution has to satisfy the constraints of the primal problem in ( [ fixprobmin ] ) .    * 3 ) * dual feasibility condition : the lagrange multipliers for the inequality constraints have to be non - negative , i.e. ,    lll[dual feasibility condition ] _",
    "k(i)0 , & i , k +",
    "_ k(i)0 , & i , k + _ l(i ) 0 , & i , l    have to hold .    * 4 ) * complementary slackness : if an inequality is inactive , i.e. , the optimal solution is in the interior of the corresponding set , the corresponding lagrange multipliers are zero .",
    "thus , we obtain    lll[complementary slackness ] _ k ( i ) ( q_k ( i ) - 1 ) = 0,&i , k + _ k ( i ) q_k ( i ) = 0 , & i , k + _ 1(i ) ( t(i)-1 ) = 0 , & i + _ 0(i ) t(i ) = 0 , & i.    a common approach to find a set of primal variables , i.e. , @xmath238 and lagrange multipliers , i.e. , @xmath239 , which satisfy the kkt conditions is to start with the complementarity slackness conditions and see if the inequalities are active or not . combining these results with the primal feasibility and dual feasibility conditions , we obtain various possibilities .",
    "then , from these possibilities , we obtain one or more candidate solutions from the stationary conditions and the optimal solution is surely one of these candidates . in the following subsections , we first pursue this procedure in order to find optimal @xmath240 and @xmath241 for @xmath237 , and then , we construct the protocol introduced in theorem [ fixprot ] based on three exclusive snr regions .      in order to determine the optimal selection policy , we differentiate the lagrangian function in ( [ kkt function ] ) with respect to @xmath69 , for @xmath242 , equate the result to zero , and obtain the corresponding @xmath69 .",
    "this leads to    lll[stationary mode ] q_1^*(i ) : & -(1-_1)c_1r(i)+(i)+_1(i)-_1(i)=0 + q_2^*(i ) : & -(1-_2)c_2r(i)+(i)+_2(i)-_2(i)=0 + q_3^*(i ) : & -[(1-_1)c_12r(i)+(1-_2)c_21r(i ) ] + ( i)+_3(i)-_3(i)=0 + q_4^*(i ) : & -_2 c_r1(i)+(i)+_4(i)-_4(i)=0 + q_5^*(i ) : & -_1 c_r2(i)+(i)+_5(i)-_5(i))=0 + q_6^*(i ) : & -[_1 c_r2(i)+_2 c_r1(i)]+(i ) + _ 6(i)-_6(i)=0 .    without loss of generality",
    ", we obtain the necessary condition for @xmath243 and then generalize the result to @xmath244 for @xmath245 . from constraint @xmath89 in ( [ fixprobmin ] ) , the other selection variables are zero , i.e. , @xmath246 , for @xmath247 . furthermore , from ( [ complementary slackness]a ) ,",
    "we obtain @xmath248 , for @xmath249 and from ( [ complementary slackness]b ) , we obtain @xmath250 .",
    "then , by substituting these values into ( [ stationary mode ] ) , we obtain    lll[met ] ( i)+_1(i ) = ( 1-_1)c_1r(i ) _",
    "1(i ) + ( i)-_2(i ) = ( 1-_2)c_2r(i ) _",
    "2(i ) + ( i)-_3(i ) = ( 1-_1)c_12r(i)+(1-_2)c_21r(i ) _",
    "3(i ) + ( i)-_4(i ) = _ 2 c_r1(i ) _",
    "4(i ) + ( i)-_5(i ) = _ 1 c_r2(i ) _",
    "5(i ) + ( i)-_6(i ) = _ 1 c_r2(i)+_2 c_r1(i ) _",
    "6(i )    where @xmath99 is referred to as selection metric . by subtracting ( [ met]a ) from the rest of the equations in ( [ met ] ) , we obtain    rcl[eq_2_1 ] _",
    "1(i ) - _ k(i ) = _ 1(i)+_k(i ) , k=2,3,4,5,6 .    from the dual feasibility conditions given in ( [ dual feasibility condition]a ) and ( [ dual feasibility condition]b )",
    ", we have @xmath251 . by inserting @xmath251 in ( [ eq_2_1 ] ) , we obtain the necessary condition for @xmath243 as    lll _",
    "1(i ) \\ { _ 2(i ) , _",
    "3(i ) , _ 4(i ) , _",
    "5(i ) , _ 6(i ) } .    repeating the same procedure for @xmath252",
    ", we obtain the necessary condition for selecting transmission mode @xmath253 in the @xmath16-th time slot as    lll[optmet ] _",
    "k^*(i ) \\{_k(i ) } ,    where the lagrange multipliers @xmath102 and @xmath103 are chosen such that @xmath87 and @xmath88 in ( [ fixprobmin ] ) hold and the optimal value of @xmath49 in @xmath53 and @xmath54 is obtained in the next subsection .",
    "we note that @xmath102 and @xmath103 are long - term thresholds ( lagrange multipliers ) which only depend on the statistics of the channels .",
    "moreover , we prove in appendix [ appmuregion ] that the optimal values of @xmath102 and @xmath103 are in the interval @xmath254 $ ] . moreover , for @xmath255 and @xmath256 , the probability that two selection metrics in ( [ met ] ) are equal is zero due to the randomness of the time - continuous channel gains .",
    "therefore , the necessary condition for selecting transmission mode @xmath70 in ( [ optmet ] ) is in fact sufficient and is the optimal selection policy .",
    "however , if @xmath257 or @xmath258 , then some of the selection metrics in ( [ met ] ) are equal for all time slots . in this case",
    ", we have the freedom to choose between the modes which have the same value of the selection metric in ( [ met ] ) as long as the long - term constraints @xmath87 and @xmath88 in ( [ fixprobmin ] ) hold .",
    "one way of selecting between the modes for which the selection metrics @xmath259 are identical is to use a probabilistic approach via coin flips .",
    "therefore , let @xmath93 be the outcomes of the @xmath94-th coin flip in the @xmath16-th time slot with the probabilities of the possible outcomes defined as @xmath95 and @xmath96 .",
    "in order to include the coin flip in ( [ optmet ] ) , we write the necessary and sufficient condition for the selection of mode @xmath260 in the @xmath16-th time slot as    lll[optmet2 ] _",
    "k(i ) > \\{_k(i)_k(i ) }    where @xmath261 is a binary indicator variable which is equal to zero for the modes that can not be selected in the @xmath16-th time slot and one otherwise .",
    "as will be seen , the value of @xmath262 , depending on the average snrs , is either deterministic or obtained as a function of the outcome of the coin flip(s ) .      to obtain the optimal @xmath241 for the multiple access mode",
    ", we assume @xmath263 and calculate the derivative in ( [ stationary condition]b ) which leads to    lll [ stationary t ] t^*(i ) : -(_1-_2 ) [ c_r(i ) - c_1r(i ) - c_2r(i ) ] + _ 1(i)-_0(i)=0 .",
    "now , we investigate the following possible cases for @xmath241 :    * case 1 : * if @xmath264 , then from ( [ complementary slackness]c ) and ( [ complementary slackness]d ) , we obtain @xmath265 for @xmath266 . from ( [ stationary t ] ) and by considering @xmath267 , we also obtain @xmath268 . combining these results into ( [ optmet ] ) ,",
    "leads to    lll [ mu12 ] _",
    "3(i ) = ( 1-)c_r(i ) \\{_1(i),_2(i ) } + _ 6(i ) = c_r1(i ) + c_r2(i ) \\{_4(i),_5(i)}.    the inequalities in ( [ mu12]a ) and ( [ mu12]b ) hold with equality with non - zero probability if and only if @xmath269 and @xmath270 , respectively , however , this leads to a contradiction as shown in appendix [ appmuregion ] .",
    "therefore , only @xmath12 and @xmath15 are selected for the optimal strategy .",
    "hence , we can use the notation in ( [ optmet2 ] ) , by setting @xmath271 and @xmath272 , @xmath117 .    in this case ,",
    "the values of @xmath49 , @xmath117 , and the value of @xmath273 are found such that constraints @xmath87 and @xmath88 in ( [ fixprobmin ] ) hold .",
    "note that when @xmath87 and @xmath88 hold , the following also holds    rcl[equcons ] |r_1r+|r_2r&=&|r_r1+|r_r2 .",
    "now , since @xmath274 and @xmath275 are the only selection metrics for which @xmath276 , for @xmath137 , @xmath117 , we observe that both @xmath274 and @xmath275 , and both the left and right hand side in ( [ equcons ] ) are independent of the value of @xmath49 , @xmath117 .",
    "thus , we can set @xmath273 independently from @xmath49 such that ( [ equcons ] ) is satisfied .",
    "we note that the optimal @xmath273 is unique since increasing @xmath273 increases the right hand side of ( [ equcons ] ) and decreases the left hand side , simultaneously .",
    "since the sum rate does not depend on @xmath49 , i.e. , @xmath277 , any choice of @xmath49 , @xmath117 , that satisfies @xmath87 in ( [ fixprobmin ] ) is optimal .",
    "then , if @xmath87 in ( [ fixprobmin ] ) and ( [ equcons ] ) hold , @xmath88 in ( [ fixprobmin ] ) also holds . as a result , we have satisfied both @xmath87 and @xmath88 by satisfying @xmath87 in ( [ fixprobmin ] ) and ( [ equcons ] ) .",
    "therefore , we assume @xmath278 , and @xmath279 is given by    rcl[timevar ] t=    where    c q(i ) =    1 , + 0 ,    .",
    "we note that the necessary condition for the optimality of this case is that @xmath141 . for the cases which lead to @xmath280 or @xmath281 , we can not have @xmath282 , and therefore , we obtain either @xmath131 or @xmath116 . in these cases , we need different selection policies which are investigated in the following .",
    "* case 2 : * if @xmath116 , then from ( [ complementary slackness]c ) , we obtain @xmath283 and from ( [ dual feasibility condition]c ) , we obtain @xmath284 . combining these results with ( [ stationary t ] ) , we obtain @xmath285 .",
    "then , by substituting these results in ( [ met ] ) , we obtain    rll[m25 ] _",
    "3(i ) & = & ( 1-_1)[c_r(i)-c_2r(i)]+(1-_2)c_2r(i ) + & = & ( 1-_1)c_r(i)+ ( _ 1-_2)c_2r(i ) + & & \\{_1(i),_2(i ) } + _ 6(i ) & = & _ 2 c_r1(i ) + _ 1 c_r2(i)\\{_4(i),_5(i)}.    the expressions in ( [ m25]a ) and ( [ m25]b ) hold with equality with non - zero probability if and only if @xmath286 and @xmath287 , respectively , otherwise only the inequality holds , respectively .",
    "therefore , we consider the following four possibilities for the thresholds @xmath102 and @xmath103 .    *",
    "a ) * if @xmath288 and @xmath289 , then , ( [ m25 ] ) holds with inequality and therefore , only @xmath12 and @xmath15 are selected .",
    "hence , for this case , we can set @xmath290 and @xmath272 for @xmath117 . since by simultaneously increasing @xmath102 and @xmath103 , the left hand side of ( [ equcons ] ) decreases and the right hand side increases , we can always find a pair @xmath291 which satisfies this constraint .",
    "therefore , the necessary condition for the optimality in this case is that among the candidates @xmath291 that satisfy ( [ equcons ] ) , there exists a point which satisfies either @xmath87 or @xmath88 in ( [ fixprobmin ] ) ( we note that since we assume ( [ equcons ] ) holds , if @xmath87 holds , @xmath88 must hold too and vice versa ) . moreover ,",
    "if there exists such a point then it is unique . to prove this , note that the candidates @xmath291 that satisfy ( [ equcons ] ) form a monotonically decreasing curve in the plain of @xmath291 , since by increasing both @xmath102 and @xmath103",
    ", we simultaneously decrease the left hand side and increase the right hand side of ( [ equcons ] ) .",
    "moreover , increasing @xmath102 and decreasing @xmath103 results in decreasing @xmath76 and @xmath78 , and increasing @xmath77 and @xmath79 .",
    "therefore , there exists a unique @xmath291 which satisfies @xmath87 or @xmath88 in ( [ fixprobmin ] ) , otherwise , either @xmath102 or @xmath103 reaches a boundary value , i.e. , zero or one , which is discussed in the following .    *",
    "b ) * if @xmath292 and @xmath293 , then from ( [ met ] ) , we obtain    rll _ 2(i ) & = & _ 3(i ) = ( 1-_2)c_2r(i ) _",
    "1(i ) + _ 6(i ) & = & _ 2 c_r1(i)+c_r2(i)\\{_4(i),_5(i)}.    the probability that the above expressions hold with equality is zero . therefore , we can set @xmath294 and @xmath295 , @xmath117 .",
    "moreover , we observe that constraint @xmath88 in ( [ fixprobmin ] ) , i.e. , @xmath296 , only depends on @xmath103 , and as @xmath103 decreases , @xmath77 increases and @xmath78 decreases . since if @xmath297 , we obtain @xmath298 , a sufficient and necessary condition for the existence of a @xmath103 such that constraint @xmath88 in ( [ fixprobmin ] ) holds is @xmath299 .",
    "since both thresholds are obtained , we could determine when to select mode @xmath15 or @xmath300 .",
    "next , we need to determine the optimal policy to select between @xmath11 and @xmath12 if for some channel realizations , we obtain @xmath301 such that constraint @xmath87 in ( [ fixprobmin ] ) holds and the maximum sum rate is achieved .",
    "since the maximum sum rate is fixed to @xmath302 and it is only a function of @xmath103 , different strategies of satisfying @xmath87 in ( [ fixprobmin ] ) yield the same sum rate .",
    "thus , we consider a simple probabilistic approach for choosing @xmath43 with probability @xmath303 and @xmath39 with probability @xmath304 . to implement the probabilistic strategy , we set @xmath305 where @xmath306 is the outcome of a coin flip with probability @xmath307\\right\\}}$ ] where @xmath303 is chosen such that constraint @xmath87 in ( [ fixprobmin ] )",
    "is satisfied .",
    "* c ) * if @xmath308 and @xmath287 , then from ( [ met ] ) , we obtain    rll _",
    "3(i ) & = & ( 1-_1)[c_r(i)-c_2r(i)]+c_2r(i ) + & & \\{_1(i),_2(i ) } + _ 5(i ) & = & _ 6(i ) = _ 1 c_r2(i ) _",
    "similar to case b , the probability that the above expressions hold with equality is zero .",
    "therefore , we set @xmath309 , and @xmath310 with @xmath311 for @xmath117 .",
    "moreover , the necessary condition for this case is that @xmath312 and the sum rate is @xmath313 .    * d ) * if @xmath292 and @xmath287 , then from ( [ met ] ) , we obtain    rll _ 2(i ) & = & _ 3(i ) = c_2r(i ) _",
    "1(i ) + _ 5(i ) & = & _ 6(i ) = c_r2(i ) _ 4(i ) .",
    "the probability that the above expressions hold with equality is zero and therefore , we can set @xmath314 .",
    "moreover , one can easily conclude that the necessary condition for this case is @xmath315 , otherwise , only one of @xmath316 or @xmath317 is selected in all time slots which violates constraints @xmath87 and @xmath88 in ( [ fixprobmin ] ) .",
    "thus , we obtain @xmath318 . moreover , considering that @xmath87 and @xmath88 in ( [ fixprobmin ] ) hold , the sum rate is @xmath319",
    ". moreover , the maximum sum rate is achieved by a probabilistic approach as follows    rll    _",
    "2(i)= x_3(i ) [ 1-x_4(i ) ] + _ 3(i)= x_3(i ) x_4(i ) + _ 5(i)=[1-x_3(i ) ] [ 1-x_5(i ) ] + _ 6(i)=[1-x_3(i ) ] x_5(i )    where the coin flip probabilities @xmath320 and @xmath321 are chosen such that constraints @xmath87 or @xmath88 in ( [ fixprobmin ] ) are satisfied , respectively , and probability @xmath121 is chosen to achieve the optimal sum rate . however , for the assumed values of @xmath322 and @xmath323 , the sum rate is @xmath324 which is indeed the maximum sum rate .",
    "therefore , any value of @xmath121 which results in an acceptable value of @xmath322 and @xmath323 , i.e. , @xmath325 , is optimal . from this condition ,",
    "we obtain @xmath326 , where @xmath327 and @xmath328 lead to @xmath329 and @xmath330 , respectively .",
    "* case 3 : * if @xmath131 , then considering ( [ complementary slackness]d ) , we obtain @xmath331 and from ( [ dual feasibility condition]c ) , we obtain @xmath332 . combining these results with ( [ stationary t ] ) , we obtained @xmath333 . following a similar procedure as for case 2 ,",
    "we obtain similar results .",
    "we obtained different selection policies and the necessary conditions of optimality for each of them .",
    "now , we determine which of the derived selection policies will be used based on the statistics of the channels and the powers of the nodes . to this end",
    ", we define three mutually exclusive snr regions @xmath334 and @xmath134 .",
    "each of the necessary conditions is realized only in one of these snr regions and since the snr regions are mutually exclusive and the necessary conditions are mutually exclusive too , the selection policy for each necessary condition is optimal for the corresponding snr region .",
    "first , we observe that the multiple access and broadcast modes are selected with non - zero probability in all the discussed cases .",
    "however , the point - to - point modes are selected only when thresholds @xmath102 and @xmath103 have a boundary value , i.e. , zero or one . by this observation",
    ", we define the snr regions @xmath335 and @xmath134 based on the utilization of point - to - point modes as follows :    * snr region @xmath134 : * in this snr region , none of the point - to - point modes are selected . moreover , the necessary conditions for the thresholds are @xmath336 and @xmath293 .",
    "* snr region @xmath105 : * in this snr region , one or both of point - to - point modes @xmath11 and @xmath14 are selected . moreover , the necessary condition for the thresholds is @xmath337 where at least one of the thresholds has a boundary value .",
    "specifically , in this snr region , if @xmath110 , we obtain @xmath286 and @xmath293 and mode @xmath11 is selected in some time slots , whereas if @xmath113 , we obtain @xmath336 and @xmath287 and mode @xmath14 is selected in some time slots , and finally if @xmath315 , we obtain @xmath286 and @xmath287 and both modes @xmath11 and @xmath14 can be selected in some time slots .",
    "* snr region @xmath123 : * in this snr region , one or both of the point - to - point modes @xmath10 and @xmath13 is selected .",
    "moreover , the necessary condition for the thresholds is @xmath338 where at least one of the thresholds has a boundary value .",
    "similar to snr region @xmath105 , in this snr region , if @xmath339 , we obtain @xmath336 and @xmath340 and mode @xmath10 is selected in some time slots , whereas if @xmath341 , we obtain @xmath342 and @xmath293 and mode @xmath13 is selected in some time slots , and finally if @xmath315 , we obtain @xmath342 and @xmath340 and both modes @xmath10 and @xmath13 can be selected in some time slots .    roughly speaking , in snr region @xmath105 , the user 1-to - relay link is much stronger than the user 2-to - relay link , and one or both of the point - to - point modes between the relay and user 2 are selected .",
    "similarly , in snr region @xmath123 , the user 2-to - relay link is much stronger than the user 1-to - relay link , and one or both of the point - to - point modes between the relay and user 1 are selected .",
    "however , in snr @xmath134 , the quality of user 1-to - relay link is similar to that of the user 2-to - relay link , and none of the point - to - point modes is selected . to easily distinguish the snr regions based on the channel statistics , we investigate the transition conditions between the regions .",
    "we note that as the quality of the user 1-to - relay link improves compared to the user 2-to - relay link , the snr region changes from @xmath123 to @xmath134 and then from @xmath134 to @xmath105 .",
    "therefore , the transition condition between snr regions @xmath105 and @xmath134 occurs when the coin flip probabilities are equal to one , i.e. , @xmath343 .",
    "then , based on whether @xmath25 is larger , smaller or equal to @xmath67 , we use the optimal strategy introduced in case b , c , and d , respectively .",
    "therefore , the snr region is @xmath105 if and only if    lll[region1 ] & \\ { p_2>p_r _ 1<1 } + & \\ { p_2<p_r _ 2<1 } + & \\{p_2=p_r _",
    "3^l < _ 3^u }    where @xmath344\\right\\ } } , \\omega_2=\\frac{e\\{qc_{2r}\\}}{e\\left\\{(1-q)c_{r1}\\right\\ } } , \\omega_3^{l } = \\frac{e\\{c_{r2}\\}}{e\\{c_{r}\\}}$ ] , and @xmath108 and @xmath109 is defined as    rl q(i)=    1 , & \\ { p_2>p_r _ _ 1=1,_2=_2^*^t(i)=0,i } + & \\ { p_2<p_r _ _ 1=_1^*,_2=0^t(i)=0,i } + 0 , &    where if @xmath110 , the threshold @xmath111 is chosen such that @xmath112 holds , whereas , if @xmath113 , the threshold @xmath114 is chosen such that @xmath115\\}=e\\{(1-q)c_{r2}\\}$ ] holds . in a similar manner , one can distinguish between snr region @xmath123 and @xmath134 .",
    "we note that all conditions of optimality for these three exclusive snr regions are obtained in this section and the thresholds @xmath102 and @xmath103 which resulted in the maximum sum rate are shown to be unique .",
    "thus the proposed solution is optimal .",
    "this completes the proof .",
    "in this appendix , we prove that the optimal solution of the problem with the relaxed constraints , @xmath345 , can also be achieved if the values of @xmath69 are binary , i.e. , if @xmath346 . therefore , the binary relaxation does not change the maximum sum rate .",
    "we start with noting that if one of the @xmath347 , adopts a non - binary value in the optimal solution , then in order for constraint @xmath89 in ( [ fixprob ] ) to be satisfied , there has to be at least one other non - binary selection variable in that time slot .",
    "assuming that the mode indices of the non - binary selection variables are @xmath348 and @xmath349 in the @xmath16-th time slot , we obtain @xmath350 from ( [ complementary slackness]a ) , @xmath351 and @xmath352 from ( [ complementary slackness]b ) .",
    "then , by substituting these values into ( [ stationary mode ] ) , we obtain    lll[binrelax ] ( i ) = _ k(i ) + ( i)= _ k(i ) + ( i)-_3(i ) = _ k(i ) , kk , k  .    from ( [ binrelax]a ) and ( [ binrelax]b ) , we obtain @xmath353 and by subtracting ( [ binrelax]a ) and ( [ binrelax]b ) from ( [ binrelax]c ) , we obtain    rcl _",
    "k(i ) - _ k(i ) & = & _ k(i ) , kk , k ",
    "+ _ k(i ) - _ k(i ) & = & _ k(i ) , kk , k  .    from the dual feasibility condition given in ( [ dual feasibility condition]b ) , we have @xmath354 which leads to @xmath355 .",
    "however , as a result of the randomness of the time - continuous channel gains , @xmath356 holds for some transmission modes @xmath357 and @xmath358 if and only if the optimal value of either @xmath102 or @xmath103 is at a boundary , i.e. , @xmath359 or @xmath360 . in these cases , we observe that @xmath353 , @xmath117 , and we have shown in appendix [ appkkt ] that for @xmath359 and @xmath360 , we can obtain the optimal sum rate by using a probabilistic approach to choose @xmath361 with probability @xmath362 and @xmath363 with probability @xmath364 , which results in a binary value for the selection variables @xmath365 and @xmath366 .",
    "this completes the proof .",
    "in this appendix , we determine the interval which contains the optimal values of @xmath367 .",
    "[ figmuregion ] represents the set of candidate selection modes for all channel realizations in the space of @xmath291 .",
    "these candidate modes are obtained based on the necessary selection condition introduced in ( [ optmet ] ) as :    [ c][c][0.75]@xmath102 [ c][c][0.75]@xmath103 [ c][c][0.75]@xmath292 [ c][c][0.75]@xmath368 [ c][c][0.75]@xmath369 [ c][c][0.75]@xmath370 [ c][c][0.75]@xmath371 [ c][c][0.75]@xmath372 [ c][c][0.75]@xmath373 [ c][c][0.75]@xmath374 [ c][c][0.75]@xmath375 [ c][c][0.75]@xmath376 [ c][c][0.75]@xmath377 .,title=\"fig:\",width=3 ]                it is straightforward to see that all sets in fig .",
    "[ figmuregion ] contradict one or both constraints @xmath87 and @xmath88 in ( [ fixprob ] ) , except @xmath392 , which corresponds to @xmath393 and @xmath394 .",
    "note that if @xmath102 and @xmath103 are at the boundaries , i.e. , @xmath359 and @xmath360 , then the neighbor modes are also candidates for selection .",
    "we note that @xmath102 and @xmath103 can not be simultaneously equal to zero since this results in @xmath395 , @xmath117 , and thus only the transmission from the users to the relay will be adopted and this contradicts constraints @xmath87 and @xmath88 in ( [ fixprob ] ) . similarly , @xmath102 and @xmath103 can not be simultaneously equal to one since it also contradicts constraints @xmath87 and @xmath88 in ( [ fixprob ] ) .",
    "s.  j. kim , n.  devroye , p.  mitran , and v.  tarokh , `` achievable rate regions and performance comparison of half duplex bi - directional relaying protocols , '' _ ieee trans .",
    "inf . theory _ ,",
    "57 , no .  10 , pp . 6405 6418 , oct .",
    "2011 .",
    "n.  zlatanov and r.  schober , `` capacity of the state - dependent half - duplex relay channel without source - destination link , '' _ submitted ieee transactions on information theory _ , 2013 .",
    "[ online ] .",
    "available : http://arxiv.org/abs/1302.3777"
  ],
  "abstract_text": [
    "<S> we consider a bidirectional network in which two users exchange information with the help of a buffer - aided relay . </S>",
    "<S> in such a network without direct link between user 1 and user 2 , there exist six possible transmission modes , i.e. , four point - to - point modes ( user 1-to - relay , user 2-to - relay , relay - to - user 1 , relay - to - user 2 ) , a multiple access mode ( both users to the relay ) , and a broadcast mode ( the relay to both users ) . </S>",
    "<S> because of the buffering capability at the relay , the transmissions in the network are not restricted to adhere to a predefined schedule , and therefore , all the transmission modes in the bidirectional relay network can be used adaptively based on the instantaneous channel state information ( csi ) of the involved links . for the considered network , assuming fixed transmit powers for both the users and the relay , we derive the optimal transmission mode selection policy which maximizes the sum rate . </S>",
    "<S> the proposed policy selects one out of the six possible transmission modes in each time slot based on the instantaneous csi . </S>",
    "<S> simulation results confirm the effectiveness of the proposed protocol compared to existing protocols . </S>"
  ]
}