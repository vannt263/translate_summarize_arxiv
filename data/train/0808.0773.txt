{
  "article_text": [
    "hierarchical ( individual ) time - step method ( e.g. , * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) is widely used in simulations of galaxy formation and star formation based on smoothed particle hydrodynamics ( sph ) method @xcite .",
    "this method allows particles to have different time - steps , and can significantly reduce the total calculation cost when there is a large variation in the timescales of particles .",
    "almost all implementations of the individual time - steps method used for particle systems violates newton s third law ( see @xcite @xcite for one of exception ) . as long as physical quantities are integrated with sufficient accuracy ,",
    "this violation is not a severe problem .",
    "however , it is not always possible to maintain the accuracy . to our knowledge , all existing implementations of individual time - step for sph",
    "rely on the determination of the time - step at the end of previous time - steps .",
    "therefore , if something unforeseen occurs during the time - step of one particle , the particle might fail to catch that event , resulting in a large integration error .",
    "a supernova ( sn ) explosion is an example of such an event .",
    "a sn generates a small amount of very hot gas ( @xmath1 ) in a large clump of cold gas ( @xmath2 ) .",
    "the difference in the time - steps of the hot gas and surrounding cold gas particles becomes quite large ( typically the difference reaches @xmath3 ) .",
    "thus , hot gas particles step forward @xmath3 or more time - steps before neighboring cold gas particles respond to the sn event .",
    "this means that the evolution of both hot and cold gas particles is completely wrong , since the surrounding cold gas particles do not react the explosion for a duration much longer than the timescale in which the blast wave would propagate the inter - particle distance .",
    "this problem is not severe for ordinary sph simulations of galaxy formation because of the temperature cutoff in cooling functions at @xmath0 , while it becomes very serious for simulations involving the multiphase nature of the interstellar medium under @xmath4 , because the mach number can be very high .",
    "this problem of sudden change occurs in any dynamical simulation with individual time - steps , as long as the time - steps are determined with the usual explicit method . in principle , a fully implicit method in which the time - step itself is also determined implicitly @xcite or a method which satisfies newton s third law @xcite can solve this problem , but there are no implementations of such methods for sph simulations yet .    in simulation of star clusters , the sn and",
    "its kick introduces a sudden change in the orbit ( and mass ) of the exploded star . here , a rather simple prescription in which either all stars or at least nearby stars are synchronized to the time of explosion and restart",
    "the integration has been used .",
    "this prescription , at least the version which synchronizes all particles in the system , is impractical for @xmath5-body / sph simulations of galaxies , because the number of sn events and therefore the increase in the calculation cost is too great .",
    "we propose a simple limiter for hydrodynamical time - steps in the individual time - step method which mitigates this problem . with this limiter",
    "the behavior of an explosion integrated by individual time - steps becomes essentially the same as that integrated by global time - steps . in  2 , we describe this limiter , and in  3 we report the result of numerical experiments .",
    "we denote the time - step of an @xmath6-th particle as @xmath7 and that of a neighbor particle , with index @xmath8 , as @xmath9 .",
    "the basic idea of our limiter is to enforce the following conditions : @xmath10 where @xmath11 is an adjustable parameter .",
    "we found @xmath12 to give good results , from the perspective of the total energy and linear momenta conservations , without significant increase in the calculation cost ( see table [ tab : conservation ] in  [ sec : results ] ) .",
    "note that too large values of @xmath11 , say @xmath13 , lead to the violation of the courant condition .",
    "it is essential that the time - step of a particle @xmath8 shrinks when the time - step of its neighbor particle @xmath6 suddenly shrinks by a large factor .",
    "thus particle @xmath6 should let particle @xmath8 respond to the change of its time - step .",
    "the key point of the limiter is to reduce effects of the violation of newton s third law .",
    "although our approach does not guarantee the third law , we can achieve sufficient accuracy by controlling the violation via the control parameter , @xmath11 .",
    "we implement this limiter in the following way : when integrated , particle @xmath6 sends its new @xmath7 to its neighbor ( @xmath8-th ) particles .",
    "the particles receiving the time - step of particle @xmath6 compare it with their time - steps , @xmath9 .",
    "when @xmath14 they shorten their time - steps so that they satisfy the relation @xmath15 .",
    "note that this reduction of the time - step of particle @xmath8 is only possible if the times of two particles @xmath16 and @xmath17 satisfy the condition @xmath18 if the above condition is not satisfied , the reduction of time - step results in the new time of particle @xmath8 before the current time of particle @xmath6 , requiring the backward integration of the entire system .    in this case , the new time of particle @xmath8 is set to a value that is consistent with the current system time ( @xmath16 ) , and the time - step is set to the difference between particle current time and new time . in figure",
    "[ fig : schematic ] , we show schematic pictures of the traditional individual time - steps method and our implementation of the individual time - steps method .",
    "in order to verify the effect of the limiter , we performed two explosion tests . the first test deals with hydrodynamics only while the second one treats both hydrodynamics and self - gravity .",
    "for each test , we performed three runs : ( a ) integrated with global time - steps ( hereafter run a ) , ( b ) traditional individual time - steps ( case 1 . in fig .",
    "[ fig : schematic ] ; run b ) , and ( c ) individual time - steps with the limiter ( case 2 . in fig . [",
    "fig : schematic ] ; run c ) .    for the first test we adopted the sedov problem , which is a pure hydrodynamical evolution of the point - like explosion in the cold and homogeneous ambient medium @xcite .",
    "we prepared a glass distribution with @xmath19 sph particles .",
    "we enhanced the thermal energy of the central 32 particles in an sph manner .",
    "the total thermal energy of the explosion is set to be unity .",
    "the internal energy of the ambient gas particle is set to be @xmath20 of that for the hottest gas particle , although the original sedov problem adopted a zero - energy background .",
    "hence , the energy ratio is comparable with sn explosion , which generates a small amount of very hot gas ( @xmath21 ) , in cold ( @xmath22 ) ambient gas . in this configuration ,",
    "the position of the shock front at the time @xmath23 is @xmath24 , when we assume the adiabatic index @xmath25 .    in figure",
    "[ fig : init_dt ] , we show the initial distribution of time - steps for the sedov problem with individual time - steps as a function of the radius .",
    "the difference in time - steps between the hottest particle and the ambient particles is @xmath3 .",
    "note that time - steps of particles in the contact region surrounding the hot region are smaller than those of distant ambient particles ( @xmath26 ) , since we estimate these time - steps after the internal energy of particles are specified .",
    "this distribution of time - steps is quite moderate compared to that in practical simulations just after sn explosions , in which only the particles which receive the energy have small time - steps .",
    "we then perform an explosion test of a cold cloud including the self - gravity . for this test",
    ", we used the particle distribution of the three - dimensional collapse test ( e.g. , * ? ? ?",
    "* ) at @xmath27 where the system becomes the state of virial equilibrium with the total energy of @xmath28 .",
    "we added the thermal energy to the central 32 particles in an sph manner in order to drive the explosion of the system .",
    "the total energy of the system was set to be @xmath29 .",
    "we designed this test to mimic the sn energy input in high - density star - forming molecular cloud .",
    "the total binding energy of a cloud with the total mass of @xmath30 and the size of @xmath31 ( see table 1 in * ? ? ?",
    "* ) is around @xmath32 , while the energy input of a type ii sn is @xmath33 .",
    "therefore , if we scale the energy accordingly , the energy input should be @xmath34 .",
    "we used a much smaller value , so that the breakdown of the traditional method is less severe .",
    "we reset @xmath35 at the initial state .",
    "the number of sph particles used here is 30976 .",
    "the gravitational softening , @xmath36 , is set to be @xmath37 .",
    "we use the standard sph method ( e.g. , * ? ? ?",
    ". the asymmetric form is adopted for the derivation of the internal energy .",
    "the signal velocity based artificial viscosity term @xcite is used .",
    "the viscous coefficient , @xmath38 , is set to be two for the first test and unity for the second test .",
    "we determine the interaction ( kernel ) size of each sph particle to keep the neighbor number to @xmath39 .",
    "gravity is solved by the tree with grape method @xcite with an opening angle of 0.5 .",
    "the time - integrator uses the leap - frog method . in runs of pure hydrodynamics ,",
    "the time - step for individual particles is calculated as the smaller of the ones calculated using the signal velocity based method @xcite and the acceleration time - step ; @xmath40 @xcite . here",
    "@xmath41 and @xmath42 are the kernel size and the acceleration caused by the pressure gradient , respectively .",
    "the coefficient for the courant condition , which is estimated by the signal velocity based method , is set to be 0.3 .",
    "when we consider self - gravity , we modify the acceleration time - step taking into account the gravitational acceleration , @xmath43 , and @xmath36 ; @xmath44 .      figure [ fig : sedov ] shows the result of the sedov problem . in the top row ,",
    "particle distributions of sliced regions ( @xmath45 ) are shown , and in the bottom row radial density profiles are shown .",
    "run ( a ) ( the left panels in fig .",
    "[ fig : sedov ] ) shows a clear spherical structure and its density profile traces the analytic solution very well .",
    "run ( b ) ( the middle panels ) , however , displays penetrations of the hot gas particles into the ambient medium and fails to reproduce the analytic solution .",
    "this is because the time - steps of the gas particles composing the ambient medium are very long ( @xmath46 ) compared with those of the initially heated particles ( the minimum value is @xmath47 ) and therefore the ambient medium has had only two time - steps before the time of the snapshot ( @xmath48 ) .",
    "they could not respond correctly to the expansion of the central hot region .",
    "run ( c ) ( the right panels ) does not show this problem . in this run ,",
    "the penetration of the hot gas particle occurring with the traditional method is suppressed perfectly and the analytic solution of the sedov problem is reproduced very well .",
    "this is because the short time - steps propagate to surrounding particles quickly enough . as a result",
    ", cold gas particles can respond to the pressure of the hot gas particles .",
    "consequently this run can reproduce the analytic solution of the sedov problem , like run ( a ) .",
    "we can conclude that this limiter or a similar criterion is necessary for the simulations of sph with individual time - steps involving strong explosions .",
    "the total ( kinetic + thermal ) energy and linear momenta of the system at the final phase ( @xmath49 ) are shown in table [ tab : conservation ] .",
    "run ( a ) conserves the total energy to @xmath50 and the linear momentum with a very high precision . while run ( b ) shows violations of conservation of both the total energy and the linear momentum because the time - steps of cold gas particles are far too long to resolve the propagation of the blast wave .",
    "introduction of the time - step limiter greatly reduces these errors .",
    "runs ( c ) conserve the total energy to a level similar to that of run ( a ) .",
    "in addition , the conservations of the linear momentum in these runs are improved by four orders of magnitudes compared with that in run ( b ) .",
    "when we compare runs with @xmath51 and @xmath52 , we found the run with @xmath51 shows results slightly better in conservations .",
    "the distribution of particles and radial profiles are indistinguishable .",
    "therefore we conclude that the time - step limiter with @xmath53 is acceptable .",
    "the calculation cost directly relates with the value of @xmath11 ; smaller @xmath11 leads to larger calculation cost . indeed ,",
    "run ( c ) with @xmath51 takes @xmath54 for integration until @xmath55 whereas run ( c ) with @xmath12 requires only @xmath56 .",
    "interestingly , calculation costs for runs ( c ) are smaller than that for run ( b ) .",
    "this is because the hot bubble does not expand correctly unless we introduce the limiter .        note . @xmath57 and @xmath58 are the total energy at @xmath59 ( initial phase ) and @xmath60 ( final phase ) , respectively .",
    "@xmath61 , @xmath62 , and @xmath63 indicate the absolute values of linear momenta for @xmath64 , @xmath65 , and @xmath66 directions , respectively .",
    "figure [ fig : slice ] shows sliced ( @xmath67 ) particle distributions for runs ( a ) , ( b ) , and ( c ) ( top to bottom ) at selected epochs , for the second model with self - gravity . since the total ( kinetic + thermal + potential ) energy of the system is positive and sufficiently large , the strong shock propagates outward against the self - gravity resulting in an expanding shell .",
    "run ( a ) ( top panels ) shows this behaviors clearly .",
    "the behavior of the expansion for run ( b ) ( middle panels ) surprisingly differs from that for run ( a ) .",
    "again , the penetrations of the initial hot gas particles into the cold region are observed , and defects of the shell are shown in the middle - center and right panels .",
    "the introduction of the time - step limiter drastically improves the results as can be seen in the bottom panels of figure [ fig : slice ] .",
    "there are no penetrations or defects of the spherical shell - like shock which are visible in middle panels .",
    "these results clearly indicate that the use of individual time - steps without a time - step limiter is very dangerous for sph simulations involving strong explosion problems , such as high - resolution sph simulations of galaxy formation with a multiphase interstellar medium under @xmath0 . on the other hand , for traditional simulations of galaxy formation , the problem might not be too severe since these simulations adopt the cut off temperature of @xmath0 for cooling function , and temperature difference is at most around @xmath68 .",
    "we strongly recommend that users of sph who investigate systems in which `` strong '' explosions take place with individual time - steps implement some form of time - step limiter similar to what we introduced here .",
    "we thank the anonymous referee for his / her insightful comments and suggestions , which helped us to greatly improve our manuscript .",
    "we also thank takashi okamoto for helpful discussion and kohji yoshikawa for providing us with a custom version of phantom - grape library .",
    "numerical computations were carried out on xt-4/grape systems ( project id : g08a19 ) at the center for computational astrophysics , cfca , of the national astronomical observatory of japan ."
  ],
  "abstract_text": [
    "<S> we show that the smoothed particle hydrodynamics ( sph ) method , used with individual time - steps in the way described in the literature , can not handle strong explosion problems correctly . in the individual time - step scheme , </S>",
    "<S> particles determine their time - steps essentially from a local courant condition . </S>",
    "<S> thus they can not respond to a strong shock , if the pre - shock timescale is too long compared to the shock timescale . </S>",
    "<S> this problem is not severe in sph simulations of galaxy formation with a temperature cutoff in the cooling function at @xmath0 , while it is very dangerous for simulations in which the multiphase nature of the interstellar medium under @xmath0 is taken into account . </S>",
    "<S> a solution for this problem is to introduce a time - step limiter which reduces the time - step of a particle if it is too long compared to the time - steps of its neighbor particles . </S>",
    "<S> thus this kind of time - step constraint is essential for the correct treatment of explosions in high - resolution sph simulations with individual time - steps . </S>"
  ]
}