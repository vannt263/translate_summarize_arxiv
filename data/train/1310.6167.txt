{
  "article_text": [
    "the monge - ampre equation is a fully nonlinear degenerate elliptic equation which arises in several problems from analysis and geometry . in its classical form",
    "this equation is given by @xmath0 where @xmath1 is some open set , @xmath2 is a convex function , and @xmath3 is given .",
    "in other words , the monge - ampre equation prescribes the product of the eigenvalues of the hessian of @xmath4 , in contrast with the `` model '' elliptic equation @xmath5 which prescribes their sum .",
    "as we shall explain later , the convexity of the solution @xmath4 is a necessary condition to make the equation degenerate elliptic , and so to hope for regularity results .",
    "+ the prototype equation where the monge - ampre equation appears is the  prescribed gaussian curvature equation \" : if we take @xmath6 then corresponds to imposing that the gaussian curvature of the graph of @xmath4 at the point @xmath7 is equal to @xmath8 .",
    "another classical instance where the monge - ampre equation arises is affine geometry , more precisely in the `` affine sphere problem '' and the `` affine maximal surfaces '' problem ( see for instance @xcite ) .",
    "the monge - ampre equation also arises in meteorology and fluid mechanics : for instance , in the semi - geostrophic equations it is coupled with a transport equation ( see section [ semigeo ] below ) .",
    "as we shall see later , in the optimal transportation problem the study of monge - ampre type equation of the form @xmath9 plays a key role in understanding the regularity ( or singularity ) of optimal transport maps .",
    "more in general , monge - ampre type equations of the form @xmath10 have found applications in several other problems , such as isometric embeddings , reflector shape design , and in the study of special lagrangian sub - manifolds , prescribing weingarten curvature , and in complex geometry on toric manifolds ( see for instance the survey paper @xcite for more details on these geometric applications ) .",
    "+ the aim of this article is to describe the general regularity theory for the monge - ampre equation , show its connections with the optimal transport problem with quadratic cost , introduce the more general class of monge - ampre type equations which arise when the cost is not quadratic , and show some regularity results for this class of equations .",
    "the monge - ampre equation draws its name from its initial formulation in two dimensions , by the french mathematicians monge @xcite and ampre @xcite , about two hundred years ago . as we mentioned above ,",
    "this equation is degenerate elliptic on convex functions . before describing some history of the regularity theory for this equation ,",
    "let us first explain this point .",
    "[ rmk : degen ] let @xmath2 be a smooth solution of with @xmath11 smooth , and let us try to understand if we can prove some regularity estimates . a standard technique consists in differentiating the equation solved by @xmath4 to obtain an equation for its first derivatives .",
    "hence we fix a direction @xmath12 and we differentiate in the direction @xmath13 to obtain @xmath14 where @xmath15 denotes the inverse matrix of @xmath16 , lower indices denotes partial derivatives ( thus @xmath17 , and we are summing over repeated indices . recalling that @xmath18 by assumption , we can rewrite the above equation as @xmath19 hence , to obtain some regularity estimates on @xmath20 we would like the matrix @xmath15 to be nonnegative definite ( and if possible even positive definite ) to apply elliptic regularity theory .",
    "but for the matrix @xmath15 to be nonnegative definite we need @xmath21 to be nonnegative definite , which is exactly the convexity assumption on @xmath4 .",
    "we now observe that , without any a priori bound on @xmath21 , then @xmath15 may have arbitrarily small eigenvalues and this is why we say that the equation is `` degenerate elliptic '' .",
    "however , if one can show that @xmath22 inside @xmath23 for some constant @xmath24 , then @xmath25 and the linearized equation becomes uniformly elliptic .",
    "for this reason the bound @xmath22 is one of the key steps for the regularity of solutions to . in this",
    "regard we notice that , if we assume that @xmath26 is uniformly bounded away from zero , then the product of the eigenvalues of @xmath21 is bounded away from zero and to obtain the estimate @xmath22 it is actually enough to prove only the upper bound @xmath27 for some constant @xmath28 .",
    "we now give a brief overview on the existence and regularity theory for the monge - ampre equation .",
    "the first notable results are by minkowski @xcite who proved the existence of a weak solution to the  prescribed gaussian curvature equation \" ( now called `` minkowski problem '' ) by approximation by convex polyhedra with given face areas . using convex polyhedra with given generalized curvatures at the vertices ,",
    "alexandrov also proved the existence of a weak solution in all dimensions , as well as the @xmath29 smoothness of solutions in two dimensions @xcite .    in high dimensions , based on his earlier works ,",
    "alexandrov @xcite ( and also bakelman @xcite in two dimensions ) introduced a notion of generalized solution to the monge - ampre equation and proved the existence and uniqueness of solutions to the dirichlet problem ( see section [ sect : alex sol ] ) .",
    "the treatment also lead to the alexandrov - bakelman maximum principle which plays a fundamental role in the study of non - divergence elliptic equations ( see for instance ( * ? ? ?",
    "* section 9.8 ) ) .",
    "as we shall see in section [ sect : alex sol ] , the notion of weak solutions introduced by alexandrov ( now called `` alexandrov solutions '' ) has continued to be frequently used in recent years , and a lot of attention has been drawn to prove smoothness of alexandrov solutions under suitable assumptions on the right hand side and the boundary data .    the regularity of generalized solutions in high dimensions is a very delicate problem .",
    "pogorelov found a convex function which is not of class @xmath30 but satisfies the monge - ampre equation inside @xmath31 with positive analytic right hand side ( see below ) . as we shall describe in section [ sect : caff alex ] , the main issue in the lack of regularity is the presence of a line segment in the graph of @xmath4 .",
    "indeed , calabi @xcite and pogorelov @xcite were able to prove a priori interior second derivative estimate for strictly convex solutions , or for solutions which do not contain a line segment with both endpoints on boundary . by the interior regularity theory for fully nonlinear uniformly elliptic equations established by evans @xcite and krylov @xcite in the 80 s , pogorelov",
    "s second derivative estimate implies the smoothness of strictly convex alexandrov s generalized solutions .    by the regularity theory developed by ivochkina @xcite , krylov @xcite , and caffarelli - nirenberg - spruck @xcite ,",
    "using the continuity method ( see section [ sect : continuity ] for a description of this method ) one obtains globally smooth solutions to the dirichlet problem .",
    "in particular , alexandrov s solutions are smooth up to the boundary provided all given data are smooth .    in all the situations mentioned above , one assumes that @xmath32 is positive and sufficiently smooth .",
    "when @xmath32 is merely bounded away from zero and infinity , caffarelli proved the @xmath33 regularity of strictly convex solutions @xcite .",
    "furthermore , when @xmath32 is continuous ( resp .",
    "@xmath34 ) , caffarelli proved by a perturbation argument interior @xmath35-estimate for any @xmath36 ( resp .",
    "@xmath37 interior estimates ) @xcite .",
    "more recently , the authors proved interior @xmath38 estimates on @xmath21 when @xmath32 is merely bounded away from zero and infinity @xcite , and together with savin they improved this result showing that @xmath39 @xcite .    in the next sections",
    "we will give a description of these results .      in his study of the minkowski problem",
    ", alexandrov introduced a notion of weak solutions to the monge - ampre equation allowing him to give a meaning to the gaussian curvature of non - smooth convex sets .",
    "let us first recall that , given an open convex domain @xmath23 , the subdifferential of a convex function @xmath2 is given by @xmath40 then , one defines the _ monge - ampre measure _ of @xmath4 as follows : @xmath41 where @xmath42 and @xmath43 denotes the lebesgue measure .",
    "it is possible to show that the restriction of @xmath44 to the borel @xmath45-algebra is actually a measure ( see ( * ? ? ?",
    "* theorem 1.1.13 ) ) .",
    "note that , in case @xmath46 , the change of variable formula gives @xmath47 therefore @xmath48    [ ex : disc]let @xmath49 , then ( writing @xmath50 ) @xmath51 thus @xmath52 , where @xmath53 denotes the @xmath54-dimensional hausdorff measure .",
    "[ ch1:def : alesol]given an open convex set @xmath23 and a borel measure @xmath55 on @xmath23 , a convex function @xmath2 is called an _ alexandrov solution _ to the monge - ampre equation @xmath56 if @xmath57 as borel measures .    when @xmath58 we will simply say that @xmath4 solves @xmath59 in the same way , when we write @xmath60 we mean that @xmath61 .",
    "one nice property of the monge - ampre measure is that it is stable under uniform convergence ( see ( * ? ? ?",
    "* lemma 1.2.3 ) ) :    [ uni ] let @xmath62 be a sequence of convex functions converging locally uniformly to @xmath4 .",
    "then the associated monge - ampre measures @xmath63 weakly@xmath64 converge to @xmath65 ( i.e. , in duality with the space of continuous functions compactly supported in @xmath23 ) .",
    "we now describe how to prove existence / uniqueness / stability of alexandrov solutions for the dirichlet problem .",
    "as we shall see , the existence of weak solution is proved by an approximation and perron - type argument , and for this it is actually useful to know a priori that solutions , if they exist , are unique and stable .",
    "we begin with the following simple lemma :    [ ch2:lem : inclsottdiff]let @xmath4 and @xmath66 be convex functions in @xmath67 . if @xmath68 is an open and bounded set such that @xmath69 on @xmath70 and @xmath71 in @xmath68 , then @xmath72 in particular @xmath73 .",
    "let @xmath74 for some @xmath75 .",
    "geometrically , this means that the plane @xmath76 is a supporting plane to @xmath66 at @xmath77 , that is , it touches from below the graph of @xmath66 at the point @xmath78 . moving this plane down until it lies below @xmath4 and then lifting it up until it touches the graph of @xmath4 for the first time , we see that , for some constant @xmath79 , @xmath80 is a supporting plane to @xmath4 at some point @xmath81 , see figure [ touching ] .     until it lies below the graph of @xmath4 , and then lifting it up until it touches @xmath4",
    ", we obtain a supporting place to @xmath4 at some point inside @xmath82 . ]    since @xmath69 on @xmath70 we see that , if @xmath83 , then @xmath84 and thus @xmath85 and the plane is also supporting @xmath4 at @xmath86 . in conclusion @xmath87 , proving the inclusion .    a first corollary is the celebrated alexandrov s maximum principle :    [ ch2:tim : alemax]let @xmath2 be a convex function defined on an open , bounded and convex domain @xmath23 . if @xmath88 on @xmath89 , then @xmath90 where @xmath91 is a geometric constant depending only on the dimension .",
    "let @xmath7 be a point on the graph of @xmath4 and let us consider the cone @xmath92 with vertex on @xmath7 and base @xmath23 , that is , the graph of one - homogeneous function ( with respect to dilatation with center @xmath77 ) which is @xmath93 on @xmath89 and equal to @xmath94 at @xmath77 .",
    "since by convexity @xmath95 , lemma [ ch2:lem : inclsottdiff ] implies @xmath96 ( actually , as a consequence of the argument below , one sees that @xmath97 . ) to conclude the proof we have only to show that @xmath98 for some dimensional constant @xmath99 .",
    "take @xmath100 with @xmath101 , and consider a plane with slope @xmath100 . by first moving it down and lifting it up until it touches the graph of @xmath102",
    ", we see that it has to be supporting at some point @xmath103 .",
    "since @xmath102 is a cone it also has to be supporting at @xmath77 .",
    "this means @xmath104 let now @xmath105 be such that @xmath106 and let @xmath107 be a vector with the same direction of @xmath108 and with modulus less than @xmath109",
    ". then the plane @xmath110 will be supporting @xmath102 at @xmath77 ( see figure [ ale2 ] ) , that is @xmath111            by the convexity of @xmath112 we have that it contains the cone @xmath113 generated by @xmath107 and @xmath114 . since @xmath115 this concludes the proof .",
    "another consequence of lemma [ ch2:lem : inclsottdiff ] is the following comparison principle :    [ ch2:lem : comparison ] let @xmath116 be convex functions defined on an open bounded convex set @xmath23 . if @xmath117 on @xmath89 and ( in the sense of monge - ampre measures ) @xmath118 then @xmath117 in @xmath23 .",
    "up to replacing @xmath66 by @xmath119 where @xmath120 is an arbitrary point in @xmath23 and then letting @xmath121 , we can assume that @xmath122 .",
    "the idea of the proof is simple : if @xmath123 is nonempty , then we can apply lemma [ ch2:lem : inclsottdiff ] to obtain @xmath124 this is in contradiction with @xmath122 and concludes the proof .",
    "a immediate corollary of the comparison principle is the uniqueness for alexandrov solutions of the dirichlet problem .",
    "we now actually state a stronger result concerning the stability of solutions , and we refer to ( * ? ? ?",
    "* lemma 5.3.1 ) for a proof .",
    "[ thm : stability ] let @xmath125 be a family of convex domains , and let @xmath126 be convex alexandrov solutions of @xmath127 where @xmath128 converge to some convex domain @xmath23 in the hausdorff distance , and @xmath129 is a sequence of nonnegative borel measures with @xmath130 and which converge weakly@xmath64 to a borel measure @xmath55 .",
    "then @xmath131 converge uniformly to the alexandrov solution of @xmath132    thanks to the above stability result , we can now prove the existence of solutions by first approximating the right hand side with atomic measures , and then solving the latter problem via a perron - type argument , see ( * ? ? ?",
    "* theorem 1.6.2 ) for more details .",
    "let @xmath23 be a bounded open convex domain , and let @xmath55 be a nonnegative borel measure in @xmath23 .",
    "then there exists an alexandrov solution of @xmath133    let @xmath134 , @xmath135 , be a family of atomic measures which converge weakly to @xmath55 . by the stability result from theorem [ thm : stability ] it suffices to construct a solution for @xmath129 .",
    "for this , we consider the family of all subsolutions . indeed , if @xmath136 $ ] and @xmath4 solves with @xmath137 then @xmath138 . ]",
    "@xmath139:= \\ { v:\\omega \\to { \\mathbb{r}}\\,:\\ , v \\text { convex},\\ ,   v = 0 \\text { on \\({\\partial}\\omega\\)},\\ ,   { \\operatorname{det}}d^2 v \\geq \\mu_k\\}.\\ ] ] first of all we notice that @xmath140 $ ] is nonempty : indeed , it is not difficult to check that a function in this set is given by @xmath141 where @xmath142 is the `` conical '' one - homogeneous function which takes value @xmath143 at @xmath77 and vanishes on @xmath89 , and @xmath144 is a sufficiently large constant .",
    "then , by a variant of the argument used in the proof of lemma [ ch2:lem : comparison ] one shows that @xmath145\\quad \\rightarrow \\quad \\max\\{v_1,v_2\\ } \\in s[\\mu_k],\\ ] ] and using proposition [ uni ] one sees that the set @xmath140 $ ] is also closed under suprema .",
    "hence the function @xmath146}v$ ] belongs to @xmath140 $ ] , and one wants to show that @xmath131 is actually a solution ( that is , it satisfies @xmath147 ) .            to prove this fact ,",
    "one first shows that @xmath148 is a measure concentrated on the set of points @xmath149 .",
    "indeed , if not , there would be at least a point @xmath150 and a vector @xmath151 such that @xmath152 .",
    "this means that @xmath153 hence we can define @xmath154 for some @xmath155 sufficiently small to find a larger subsolution ( see figure [ msri ] ) , contradiction .",
    "then one proves that @xmath147 . indeed , if this was not the case , we would get that @xmath156 with @xmath157 , and @xmath158 for some @xmath159 .",
    "consider @xmath100 in the interior of @xmath160 ( notice that @xmath161 is a convex set of volume @xmath162 , hence it has nonempty interior ) and assume without loss of generality that @xmath163 ( otherwise simply subtract @xmath164 from @xmath131 ) .",
    "then we define the function @xmath165 & \\text{if $ u_k \\leq u_k(x_j)+\\delta$ , } \\end{array }     \\right.\\ ] ] for some @xmath155 sufficiently small ( see figure [ msri ] ) and observe that this is a larger subsolution , again a contradiction .    finally , the fact that @xmath166 on @xmath89 follows form the bound @xmath167 which is a consequence of theorem [ ch2:tim : alemax ] .",
    "existence of smooth solutions to the monge - ampre equation dates back to the work of pogorelov .",
    "the way they are obtained ( together with nice and useful regularity estimates ) is through the well - celebrated _ method of continuity _ which now we briefly describe ( see ( * ? ? ?",
    "* chapter 17 ) for a more detailed exposition ) .",
    "let us assume that we know how to find a smooth ( convex ) solution @xmath168 to @xmath169 and that we want to find a solution to and @xmath170 , i.e. , there is no dependence on the right hand side from the `` lower order '' terms @xmath4 and @xmath171 .",
    "the case @xmath172 is just more tedious but the ideas / techniques are essentially the same .",
    "note however that , in this case , one has to assume @xmath173 in order to apply the classical elliptic theory ( in particular , the maximum principle ) to the linearized operator , see for instance ( * ? ? ?",
    "* chapter 17 ) . ]",
    "@xmath174    let us define @xmath175 , @xmath176 $ ] , and consider the @xmath177-parameter family of problems @xmath178 the method of continuity consists in showing that the set of @xmath179 $ ] such that is solvable is both open and closed , which implies the existence of a solution to our original problem .",
    "more precisely , let us assume that @xmath180 are smooth and consider the set @xmath181 consider the non - linear map @xmath182&\\longrightarrow c^{0,\\alpha}(\\overline \\omega)\\\\ ( u , t)&\\mapsto   { \\operatorname{det}}d^2 u - f_t . \\end{split}\\ ] ] we would like to show that @xmath183 : \\text { there exists a \\(u_t \\in \\mathcal c\\ ) such that \\(\\mathcal f(u_t , t)=0\\)}\\},\\ ] ] is both open and closed inside @xmath184 $ ] ( recall that , by assumption , @xmath185 ) . openness follows from the implicit function theorem in banach spaces ( see ( * ? ? ?",
    "* theorem 17.6 ) ) .",
    "indeed , the frecht differential of @xmath186 with respect to @xmath4 is given by the linearized monge - ampre operator : @xmath187={\\operatorname{det } } ( d^2 u ) u^{ij } h_{ij}\\,,\\qquad h=0\\text { on \\({\\partial}\\omega\\),}\\ ] ] where we have set @xmath188 , @xmath15 is the inverse of @xmath189 , and we are summing over repeated indices . notice that if @xmath4 is bounded in @xmath37 and @xmath32 is bounded from below by @xmath190 , then the smallest eigenvalue of @xmath191 is bounded uniformly away from zero and the linearized operator becomes uniformly elliptic and with @xmath34 coefficients ( see also remark [ rmk : degen ] ) .",
    "therefore , classical schauder s theory gives the invertibility of @xmath192 ( * ? ? ?",
    "* chapter 6 ) .",
    "the task is now to prove closedness of @xmath193 .",
    "this is done through _ a priori estimates _ both at the interior and at the boundary . as we already noticed in remark",
    "[ rmk : degen ] , the monge - ampre equation becomes uniformly elliptic on uniformly convex functions .",
    "since @xmath194 is bounded away from zero , the main task is to establish an a priori bound on the @xmath30 norm of @xmath4 in @xmath195 since this will imply that the smallest eigenvalue of @xmath191 is bounded away from zero . once the equation becomes uniformly elliptic , evans - krylov theorem ( * ? ? ?",
    "* theorem 17.26 ' ) will provide a -priori @xmath37 estimates up to the boundary , from which the closedness of @xmath193 follows by the ascoli - arzel theorem .",
    "[ po2]let @xmath23 be a uniformly convex domain such that @xmath196 where @xmath197 is the interior normal to @xmath23 at @xmath120 .",
    "note that for a smooth domain this is equivalent to ask the second fundamental form of @xmath89 to be ( uniformly ) positive definite .",
    "] of class @xmath198 , and let @xmath4 be a solution of with @xmath199 and @xmath200 . then there exists a constant @xmath201 , depending only on @xmath23 , @xmath190 , @xmath202 , such that @xmath203    notice that the uniform convexity of @xmath23 is necessary to obtain regularity up to the boundary : indeed , if @xmath21 is uniformly bounded then ( as we mentioned above ) @xmath4 is uniformly convex on @xmath195 and hence by the implicit function theorem @xmath204 is uniformly convex as well .",
    "theorem [ po2 ] together with an approximation procedure allows us to run the strategy described above to obtain the following existence result .",
    "[ existencesmooth]let @xmath23 be a uniformly convex domain of class @xmath198 .",
    "then for all @xmath205 with @xmath206 there exists a ( unique ) @xmath207 solution to .",
    "the proof of theorem [ po2 ] is classical .",
    "however , since the ideas involved are at the basis of many other theorems in elliptic regularity , we give a sketch of the proof for the interested readers .",
    "we begin by noticing that , because the linearized operator in is degenerate elliptic ( in the sense that , since we do not know yet that the eigenvalues of @xmath191 are bounded away from zero and infinity , we can not use any quantity involving its ellipticity constants ) , the maximum principle is essentially the only tool at our disposal .",
    "+ _ step 1 : @xmath208 and @xmath29 estimates_. @xmath208 estimates can be obtained by a simple barrier construction .",
    "indeed , it suffices to use lemma [ ch2:lem : comparison ] with @xmath209 ( where @xmath210 and @xmath211 are chosen so that @xmath212 ) to obtain a uniform lower bound on @xmath4 .    to estimate the gradient we note that , by convexity , @xmath213 so we need to estimate it only on the boundary .",
    "since @xmath88 on @xmath89 , any tangential derivative is zero , hence we only have to estimate the normal derivative .",
    "this can be done again with a simple barrier argument as above choosing , for any point @xmath214 , @xmath215 where @xmath216 and @xmath217 are chosen so that @xmath218 in this way we get @xmath219 , therefore @xmath220 + _ step 2 : @xmath30 estimates_. this is the most delicate step .",
    "given a unit vector @xmath13 we differentiate the equation @xmath221 once and two times in the direction of @xmath13 to get , respectively , @xmath222 and @xmath223 ( recall that @xmath15 denotes the inverse of @xmath224 and that lower indices denotes partial derivatives ) . by the convexity of @xmath4 , @xmath225 , hence @xmath226 for some constant @xmath201 depending only on @xmath32 . since @xmath227 , we see that @xmath228 for a suitable large constant @xmath229 depending on @xmath32 . hence , by the maximum principle , @xmath230 since @xmath4 is bounded , to get an estimate @xmath21 we only have to estimate it on the boundary .",
    "let us assume that @xmath231 and that locally @xmath232 for some constants @xmath233 .",
    "notice that , by the smoothness and uniform convexity of @xmath23 , we have @xmath234 . in this way @xmath235",
    "thanks to this gives @xmath236 noticing that @xmath237 with @xmath238 the cofactor of @xmath239 , this identity and will give an upper bound on @xmath240 once one has an upper bound on the mixed derivative @xmath241 for @xmath242 . hence , to conclude",
    ", we only have to provide an upper bound on @xmath241 .    for this ,",
    "let us consider the `` rotational '' derivative operator @xmath243 by the invariance of the determinant with respect to rotations , differentiating we get @xmath244 hence , multiplying the above equation by @xmath245 and using , we get ( recall that @xmath245 is a constant ) @xmath246 since @xmath88 on @xmath89 , thanks to , the uniform convexity of @xmath23 , and the bound on @xmath247 , one easily computes that @xmath248 for a suitable choice of constants @xmath249 depending only on @xmath23 .",
    "moreover , @xmath250 where we have used the arithmetic - geometric mean inequality . hence ,",
    "choosing @xmath251 large enough , , , and , together with the comparison principle , imply @xmath252 dividing by @xmath253 and letting @xmath254 we finally get @xmath255 for a constant @xmath201 depending only on @xmath23 and @xmath32 , as desired .      in the previous sections we have shown existence and uniqueness of weak solutions in general convex domains , and the existence of smooth solutions in smooth uniformly convex domains . to obtain smoothness of weak solutions",
    "we need the following interior estimate , due to pogorelov .",
    "[ po1 ] let @xmath256 be a solution of with @xmath257 and @xmath200 .",
    "then there exist a constant @xmath201 , depending only on @xmath190 and @xmath258 , such that @xmath259 in @xmath23 , let us define @xmath260 let @xmath120 a maximum point of @xmath261 in @xmath195 and notice that @xmath262 thanks to the boundary condition @xmath88 .",
    "first we make a change of coordinate @xmath263 with @xmath264 which leaves the direction @xmath210 invariant and such that @xmath224 is diagonal at @xmath120 ( see for instance ( * ? ? ?",
    "* chapter 4 ) ) .",
    "then we compute @xmath265 since @xmath120 is a maximum point for @xmath266 , we have @xmath267 and @xmath268 where again @xmath269 and all functions are evaluated at @xmath120 . using and with @xmath270 and",
    "that @xmath271 we get @xmath272 now , recalling that @xmath224 and @xmath15 are diagonal at @xmath120 , thanks to we obtain @xmath273 plugging the above equation in and taking again into account that @xmath224 is diagonal , we get @xmath274 multiplying by @xmath275 and recalling the definition of @xmath261 we finally obtain @xmath276 for a suitable constant @xmath201 depending only on @xmath32 , proving .    combining the theorem above with the stability of weak solutions and the existence of smooth solutions , we obtain the following result :    [ thm : pogsmooth ] let @xmath277 be a convex alexandrov solution of with @xmath257 and @xmath200 .",
    "assume that @xmath4 is strictly convex inside @xmath278",
    ". then @xmath279 .",
    "fix @xmath280 , @xmath281 , and consider the _ section _ of @xmath4 at height @xmath282 defined as @xmath283 since @xmath4 is strictly convex we can choose @xmath284 small enough so that @xmath285",
    ". then we consider @xmath286 a sequence of smooth uniformly convex sets converging to @xmath287 and apply theorem [ existencesmooth ] to find a function @xmath288 solving @xmath289 by schauder s theory @xmath290 are of class @xmath291 inside @xmath286 , so we can apply theorem [ po1 ] to deduce that @xmath292 for @xmath293 sufficiently small . since @xmath294 and @xmath295 on @xmath296 , by uniqueness of weak solutions we deduce that @xmath297 uniformly as @xmath121 ,",
    "hence @xmath298 in @xmath299 .",
    "this makes the equation uniformly elliptic , so @xmath300 . by the arbitrariness of @xmath120 we obtain that @xmath279 , as desired .      in the 90 s caffarelli",
    "developed a regularity theory for alexandrov solutions , showing that strictly convex solutions of are locally @xmath33 provided @xmath301 for some @xmath302 @xcite .",
    "[ thm : calfa]let @xmath2 be a strictly convex solution of with @xmath206 .",
    "then @xmath303 for some universal @xmath304 .",
    "more precisely for every @xmath305 there exists a constant @xmath201 , depending on @xmath190 , @xmath306 , and the modulus of strict convexity of @xmath4 , such that @xmath307    to explain the ideas behind the proof of the above theorem let us point out the following simple properties of solutions to the monge - ampre equation ( which are just another manifestation of its degenerate ellipticity ) : if @xmath251 is a linear transformation with @xmath264 and @xmath4 is a solution of the monge - ampre equation with right hand side @xmath32 , then @xmath308 is a solution to the monge - ampre equation with right hand side @xmath309 .",
    "this affine invariance creates serious obstructions to obtain a local regularity theory . indeed , for instance , the functions @xmath310 are solutions to @xmath311 on @xmath312 .",
    "thus , unless the level set @xmath313 is sufficiently `` round '' , there is no hope to obtain a priori estimates on @xmath4 .",
    "the intuition of caffarelli was to use the so - called john s lemma @xcite :    [ lem : john ] let @xmath314 be a bounded convex set with non - empty interior .",
    "then there exists a unique ellipsoid @xmath68 of maximal volume contained in @xmath315 .",
    "moreover this ellipsoid satisfies @xmath316 where @xmath317 denotes the dilation of @xmath68 by a factor @xmath318 with respect to its center .    in particular , if we define a convex set @xmath23 to be",
    "_ normalized _",
    "if @xmath319 then lemma [ lem : john ] says that , for every bounded open convex set @xmath23 , there is an affine transformation @xmath251 such that @xmath320 is normalized .",
    "note that if @xmath4 solves @xmath321 and @xmath251 normalizes @xmath23 , then @xmath322 solves @xmath323 thanks to the above discussion and a suitable localization argument based on the strict convexity of @xmath4 as in the proof of theorem [ thm : pogsmooth ] , theorem [ thm : calfa ] is a consequence of the following :    [ calpfanorm]let @xmath23 be a normalized convex set and @xmath4 be a solution of with @xmath324 .",
    "then there exist positive constants @xmath325 and @xmath326 such that @xmath327    in the proof of the above theorem , a key step consists in showing that solutions of on normalized domains have a _",
    "universal _ modulus of strict convexity . a fundamental ingredient to prove this fact is the following important result of caffarelli @xcite :    [ ch2:thm : contact]let @xmath4 be a solution of @xmath328 inside a convex set @xmath23 and let @xmath329 be a linear function supporting @xmath4 at some point @xmath330 .",
    "if the convex set @xmath331 contains more than one point , then it can not have extremal points in @xmath23 .",
    "this statement says that , if a solution coincides with one of its supporting plane on more than one point ( that is , it is not strictly convex ) then the contact set has to cross the domain .",
    "hence , if the boundary conditions are such that @xmath4 can not coincide with an affine function along a segment crossing @xmath23 , one deduce that @xmath4 must be strictly convex . in particular by noticing that , when @xmath23 is normalized , the class of solutions is compact with respect to the uniform convergence ( this is a consequence of proposition [ uni ] and the fact that the family of normalized convex domains is a compact ) , a simple contradiction argument based on compactness shows the modulus of strict convexity must be universal . from this one deduces the following estimate :    [ lemma hk ] let @xmath23 be a normalized convex domain and let @xmath66 be a solution of with @xmath324 .",
    "let @xmath120 be a minimum point for @xmath4 in @xmath23 , and for any @xmath332 $ ] denote by @xmath333 the cone with vertex @xmath334 and base @xmath335 .",
    "then , if @xmath336 is the function whose graph is given by @xmath337 ( see figure [ fig : c1alpha ] ) , there exists a universal constant @xmath338 such that @xmath339    now the proof of theorem [ calpfanorm ] goes as follows :     looks flatter and flatter near its minimum @xmath120 . ]    for any @xmath340 we can consider the convex set @xmath341 .",
    "then , if we renormalize @xmath128 through an affine map @xmath342 , we can apply lemma [ lemma hk ] to the function @xmath343 ( see ) and transfer the information back to @xmath4 to deduce that @xmath344 .",
    "therefore , by iterating this estimate we obtain @xmath345 from this fact it follows that @xmath66 is @xmath33 at the minimum , in the sense that @xmath346 see figure [ fig : c1alpha ] .",
    "now , given any point @xmath347 and @xmath348 , we can repeat the same argument with the function @xmath349 in place of @xmath4 , replacing @xmath23 with the section @xmath350 ( see ) for some @xmath282 small but fixed chosen such that @xmath351 . becomes a normalized convex set .",
    "] then the above estimate gives @xmath352 by the arbitrariness of @xmath353 , it is well known that the above estimate implies the desired @xmath354 regularity of @xmath4 ( see for instance ( * ? ? ? * lemma 3.1 ) ) .",
    "+ let us notice that a direct proof of theorem [ calpfanorm ] ( which avoids any compactness argument ) has been given by forzani and maldonado @xcite , allowing one to compute the explicit dependence of @xmath304 on @xmath190 .",
    "it is important to point out that strict convexity is not just a technical assumption but it is necessary to obtain regularity . indeed , as we already mentioned at the beginning of section [ sect : classical ma ] , there are alexandrov solutions to the monge - ampre equation with smooth right - hand side which are not @xmath30 . for instance , the function @xmath355 is @xmath356 and solves @xmath357 inside @xmath31 .",
    "furthermore , having only the bound @xmath358 is not even enough for @xmath29 regularity : the function @xmath359 is merely lipschitz and solves @xmath358 in a small convex neighborhood of the origin .",
    "alexandrov showed in @xcite that , in contrast with the above counterexamples , in two dimension every solution of @xmath360 is strictly convex ( see also @xcite ) .",
    "recently , in @xcite , mooney established that , in every dimension , the set of points where an alexandrov solution of @xmath360 coincides with one of its supporting plane has vanishing @xmath53 measure .",
    "in the case when @xmath32 is hlder continuous , caffarelli proved that @xmath4 is locally @xmath37 @xcite , improving theorem [ thm : pogsmooth ] :    let @xmath23 be a normalized convex set and @xmath4 be an alexandrov solution of with @xmath324 and @xmath361 .",
    "then @xmath362 for some constant @xmath201 depending only on @xmath318 , @xmath190 , and @xmath363 .",
    "the proof of the above theorem is based on showing that , under the assumption that @xmath32 is almost a constant ( say very close to @xmath177 ) , @xmath4 is very close to the solution of with right hand side @xmath177 . since this latter function has interior a priori estimates ( by theorem [ po1 ] ) , an approximation / interpolation argument permits to show that the @xmath30 norm of @xmath4 remains bounded . with this line of reasoning one",
    "can also prove the following theorem of caffarelli @xcite :    let @xmath23 be a normalized convex set and @xmath4 be a solution of .",
    "then , for every @xmath364 , there exist positive constants @xmath365 and @xmath366 such that if @xmath367 , then @xmath368    we notice that , by localizing the above result on small sections one deduces that if @xmath4 is a strictly convex solutions of with @xmath32 continuous then @xmath369 for all @xmath370 ( see @xcite or ( * ? ? ?",
    "* chapter 6 ) ) .",
    "wang @xcite showed that for any @xmath364 there exists a function @xmath32 satisfying @xmath371 such that @xmath372 .",
    "this counterexample shows that the results of caffarelli are more or less optimal .",
    "however , an important question which remained open for a long time was whether solutions of with @xmath301 could be at least @xmath373 , or even @xmath374 for some @xmath375",
    ". the question of @xmath376 regularity has been recently solved by the authors in @xcite . following the ideas introduced there , later in @xcite",
    "the result has been refined to @xmath377 for some @xmath378 .",
    "[ w21eps]let @xmath23 be a normalized convex set and @xmath4 be be an alexandrov solution of with @xmath324 . then there exist positive constants @xmath379 and @xmath326 such that @xmath380    note that all the previous results hold for strictly convex solutions of . indeed , it suffices to pick a section @xmath351 , choose an affine transformation @xmath251 so that @xmath381 is normalized ( see ) , and then apply the results above with @xmath381 in place of @xmath23 .",
    "+ we now briefly sketch the ideas behind the proof of the @xmath382 regularity in @xcite . to prove that the distributional hessian @xmath383 of an alexandrov solution is a @xmath384 function , it is enough to prove an a priori equi - integrability estimate on smooth solutions",
    "however , since an equi - bounded sequence of @xmath384 functions can converge to a singular measure , this is not enough to prevent concentration of the hessians in the limit , and this is why we need an equi - integrability estimate on @xmath21 which is independent of @xmath4 . ] to do this , a key observation is that any domain @xmath23 endowed with the lebesgue measure and the family of `` balls '' given by the sections @xmath385 of solutions of as defined in is a space homogenous type in the sense of coifman and weiss , see @xcite . in particular",
    "stein s theorem implies that if @xmath386 then @xmath387 , that is @xmath388 .",
    "hence one wants to prove that @xmath389 , and the key estimate in @xcite consists in showing that @xmath390 for some constant @xmath326 , which proves the result .",
    "+ a more careful applications of these ideas then gives a priori @xmath391 estimates . as shown for instance in @xcite , the approach in @xcite can be also used to give a very direct and short proof of the @xmath35 estimates of caffarelli in @xcite .    using theorem [ w21eps ]",
    ", the authors could show in @xcite the following stability property of solutions of in the _ strong _ sobolev topology .",
    "due the highly non - linear character of the monge - ampre equation , the result is nontrivial .",
    "[ conv ] let @xmath125 be a family of bounded convex domains , and let @xmath126 be convex alexandrov solutions of @xmath392 with @xmath393 .",
    "assume that @xmath128 converge to some bounded convex domain @xmath23 in the hausdorff distance , and @xmath394 converge to @xmath32 in @xmath395 .",
    "then , if @xmath4 denotes the unique alexandrov solution of @xmath396 for any @xmath397 we have @xmath398    let us conclude this section mentioning that savin recently introduced new techniques to obtain global versions of all the above regularity results under suitable regularity assumptions on the boundary @xcite .",
    "let us conclude this discussion on the regularity of weak solutions by showing an application of theorem [ w21eps ] to prove the existence of distributional solutions for the semigeostrophic system .",
    "the semigeostrophic equations are a simple model used in meteorology to describe large scale atmospheric flows . as explained for instance in ( * ? ? ?",
    "* section 2.2 ) ( see also @xcite for a more complete exposition ) , these equations can be derived from the 3-d euler equations , with boussinesq and hydrostatic approximations , subject to a strong coriolis force . since for large scale",
    "atmospheric flows the coriolis force dominates the advection term , the flow is mostly bi - dimensional . for this reason ,",
    "the study of the semigeostrophic equations in 2-d or 3-d is pretty similar , and in order to simplify our presentation we focus here on the 2-dimentional periodic case .",
    "the semigeostrophic system can be written as @xmath399 where @xmath400 and @xmath401 are periodic functions corresponding respectively to the velocity and the pressure , and @xmath402 is the @xmath403 counterclockwise rotation of @xmath404 .    as shown in @xcite ,",
    "energetic considerations show that it is natural to assume that @xmath405 is ( @xmath143)-convex , i.e. , the function @xmath406 is convex on @xmath407 . if we denote with @xmath408 the lebesgue measure on the 2-dimensional torus , then formally . ]",
    "@xmath409 satisfies the following _ dual problem _ ( see for instance ( * ? ? ?",
    "* appendix ) ) :    @xmath410    where @xmath411 is the convex conjugate of @xmath412 , namely @xmath413 the dual problem is nowadays pretty well understood .",
    "in particular , benamou and brenier proved in @xcite existence of weak solutions to . on the contrary , much less is known about the original system .",
    "formally , given a solution @xmath414 of , the pair @xmath415 given by @xmath416 solves .",
    "being @xmath411 just a convex function , _ a priori _ @xmath417 is a matrix - valued measure , thus it is not clear the meaning to give to the previous formula .",
    "however , since @xmath418 solves a continuity equation with a divergence free vector field ( notice that @xmath419 is the rotated gradient of the function @xmath420 , see ) , the only available bound on @xmath418 is @xmath421 provided this bound holds at @xmath422 .    in addition , the relation @xmath423 implies that @xmath424 ( since @xmath425 is the inverse of @xmath426 ) , from which it follows that @xmath427 solves in the alexandrov sense the monge - ampre equation @xmath428 ( see section [ sect : alex sol ] for the definition of alexandrov solution and theorem [ thm : regularity transport ] below ) .",
    "hence , by theorem [ w21eps ] @xmath429 , which allows us to give a meaning to the velocity field @xmath430 defined in , and prove that @xmath415 solve .",
    "this has been recently done in @xcite , where the following result has been proved ( see @xcite for an extension of this result to three dimensions ) :    [ thm : mainsg ] let @xmath431 be a @xmath432-periodic function such that @xmath433 is convex , and assume that the measure @xmath434 is absolutely continuous with respect to the lebesgue measure with density @xmath435 , namely @xmath436 moreover , let us assume @xmath437 for some @xmath438 .",
    "let @xmath418 be a solution of starting from @xmath435 , and let @xmath439 be the ( unique up to an additive constant ) convex function such that @xmath440 and @xmath441 is @xmath432-periodic  , see ( * ? ? ?",
    "* theorem 2.1 ) ] .",
    "denote by @xmath442 its convex conjugate .",
    "then the couple @xmath415 defined in is a distributional solution of .",
    "let us point out that is essentially the only regularity property for solutions of that is stable in time . indeed , even if we start from a smooth initial datum @xmath435 , due to the non - linear coupling between the density @xmath443 and the velocity field @xmath444 , any `` simple '' higher order estimate blows up in finite time ( it is however possible to prove _ short time _",
    "existence for smooth solutions , see @xcite ) . in view of these considerations , it is clear that understanding the regularity of solutions of the monge - ampre equation with right hand side just bounded away from zero and infinity it is a key step for the proof of theorem [ thm : mainsg ] .",
    "the monge transportation problem is more than 200 years old @xcite , and it has generated in the last years a huge amount of work .    originally monge wanted to move , in the euclidean space @xmath445 , a rubble ( _ dblais _ ) to build up a mound or fortification ( _ remblais _ ) minimizing the transportation cost . in monge s original formulation , the cost to transport some mass @xmath446 from @xmath77 to @xmath447 was given by @xmath448 .",
    "however , it makes sense to consider more general cost functions @xmath449 , where @xmath450 represents the cost to move a unit mass from @xmath77 to @xmath447 .",
    "hence , nowadays , the optimal transport problem is formulated in the following general form : given two probability measures @xmath55 and @xmath451 ( representing respectively the rubble and the mound ) defined on the measurable spaces @xmath452 and @xmath453 , find a measurable map @xmath454 with @xmath455 , i.e. , @xmath456 in such a way that @xmath457 minimizes the transportation cost . this means @xmath458 where @xmath459 is some given cost function , and the minimum is taken over all measurable maps @xmath460 such that @xmath461 .",
    "when the transport condition @xmath462 is satisfied , we say that @xmath457 is a _ transport map _ , and if @xmath457 also minimizes the cost we call it an _ optimal transport map_. + even in euclidean spaces with the cost @xmath449 equal to the euclidean distance or its square , the problem of the existence of an optimal transport map is far from being trivial .",
    "moreover , it is easy to build examples where the monge problem is ill - posed simply because there is no transport map : this happens for instance when @xmath55 is a dirac mass while @xmath451 is not .",
    "this means that one needs some restrictions on the measures @xmath55 and @xmath451 .",
    "we notice that , if @xmath463 , @xmath464 , and @xmath465 , if @xmath460 is a sufficiently smooth transport map one can rewrite the transport condition @xmath466 as a jacobian equation . indeed , if @xmath467 denotes a test function , the condition @xmath466 gives @xmath468 now , assuming in addition that @xmath469 is a diffeomorphism , we can set @xmath470 and use the change of variable formula to obtain that the second integral is equal to @xmath471 by the arbitrariness of @xmath472 , this gives the jacobian equation @xmath473 as desired .      in @xcite , brenier considered the case @xmath474 and @xmath475 , and proved the following theorem ( which was also obtained independently by cuesta - albertos and matrn @xcite and by rachev and rschendorf @xcite ) .",
    "for an idea of the proof , see the sketch of the proof of theorem [ cbrenier ] below , which includes this result as a special case .",
    "[ thm : brenier ] let @xmath55 and @xmath451 be two compactly supported probability measures on @xmath67 .",
    "if @xmath55 is absolutely continuous with respect to the lebesgue measure , then :    1 .   there exists a unique solution @xmath457 to the optimal transport problem with cost @xmath475 .",
    "2 .   the optimal map @xmath457 is characterized by the structure @xmath476 for some convex function @xmath477 .    furthermore , if @xmath464 and @xmath465 , then @xmath457 is differentiable @xmath55-a.e . and",
    "@xmath478    a remark which will be useful later is the following : the cost @xmath479 is equivalent to the cost @xmath480 .",
    "indeed , for any transport map @xmath469 we have @xmath481 ( this is a direct consequence of the condition @xmath461 ) , hence @xmath482 and since the first two integrals in the right hand side are independent of @xmath469 we see that the two minimization problems @xmath483 are equivalent .      before starting the discussion of the regularity of optimal transport maps ,",
    "let us recall some fact about second order properties of convex functions ( see for instance ( * ? ? ?",
    "* theorem 14.25 ) ) .",
    "[ thm : alex convex ] let @xmath23 be a convex open set and let @xmath2 be a convex function .",
    "then , for a.e",
    ". @xmath77 in @xmath23 , @xmath4 is differentiable at @xmath77 and there exists symmetric matrix @xmath484 such that @xmath485 in addition , at such points @xmath486 is differentiable with gradient given by @xmath21 , that is @xmath487 where @xmath488 is the set of differentiability points of @xmath4 .",
    "clearly any convex function admits also a distributional hessian @xmath383 . recalling that a positive distribution is a measure",
    ", it is simple to show that @xmath489 is a matrix valued measure ( * ? ? ?",
    "* chapter 6 ) . then one can show that the `` pointwise '' hessian @xmath191 defined in the alexandrov theorem is actually the density of the absolutely continuous part of @xmath489 with respect to the lebesgue measure , i.e. , @xmath490    let @xmath452 and @xmath453 be two bounded smooth open sets in @xmath67 , and let @xmath464 and @xmath491 be two probability measures with @xmath32 and @xmath492 such that @xmath493 in @xmath494 and @xmath495 in @xmath496 .",
    "we assume that @xmath32 and @xmath492 are bounded away from zero and infinity on @xmath452 and @xmath453 , respectively . by brenier s theorem ,",
    "when the cost is given by @xmath479 then the optimal transport map @xmath457 is the gradient of a convex function @xmath4 .",
    "hence , the jacobian equation combined with the fact that @xmath486 is differentiable a.e .",
    "( see theorem [ thm : alex convex ] ) gives that @xmath4 solves the monge - ampre equation @xmath497 coupled with the `` boundary condition '' @xmath498 ( which corresponds to the fact that @xmath457 transports @xmath499 onto @xmath500 ) .",
    "we will say that the function @xmath4 is a _ brenier solution _ of the monge - ampre equation . +",
    "as observed by caffarelli @xcite , even for smooth densities one can not expect any general regularity result for @xmath4 without making some geometric assumptions on the support of the target measure .",
    "indeed , let @xmath501 and suppose that @xmath502 is the unit ball centered at the origin and @xmath503 is the union of two half - balls ( here @xmath504 denote the canonical basis of @xmath407 ) , where @xmath505 then , if @xmath506 and @xmath507 , it is easily seen that the optimal map @xmath457 is given by @xmath508 which corresponds to the gradient of the convex function @xmath509 .",
    "thus , as one could also show by an easy topological argument , in order to hope for a regularity result for @xmath4 we need at least to assume the connectedness of @xmath453 .",
    "but , starting from the above construction and considering a sequence of domains @xmath510 where one adds a small strip of width @xmath378 to glue together @xmath511 , one can also show that for @xmath378 small enough the optimal map will still be discontinuous ( see @xcite ) .",
    "+ the reason for this lack of regularity is the following : for alexandrov solutions the multivalued map @xmath512 preserves the lebesgue measure up to multiplicative constants , that is , the volumes of @xmath68 and @xmath513 are comparable for any borel set @xmath514 .",
    "on the other hand , for brenier solutions , gives the same kind of information but only at points where @xmath4 is twice differentiable , so may miss some singular part in the monge - ampre measure .",
    "this comes from the fact that the optimal map can only see the regions where @xmath32 and @xmath492 live : roughly speaking , for brenier solutions we only have @xmath515 ( and not @xmath516 as in the alexandrov case ) , which means that we do not have a full control on the monge - ampre measure of @xmath4 .    in the counterexample above",
    "what happens is the following : when @xmath517 then @xmath518\\times \\{x_2\\}$ ] , hence @xmath519 maps the segment @xmath520 $ ] onto the square @xmath521 ^ 2 $ ] , but in the latter square @xmath492 has no mass .",
    "notice that in this case the determinant of @xmath21 is equal to @xmath177 a.e .",
    "inside @xmath522 ( so @xmath4 is a brenier solution with right hand side @xmath177 ) but the monge - ampre measure of @xmath4 is equal to @xmath523 ( compare with example [ ex : disc ] ) .",
    "hence , in order to avoid this kind of counterexample one should make sure that the target mass always cover the image of @xmath524 , and a way to ensure this is that @xmath453 is convex . indeed , as shown by caffarelli @xcite , if @xmath453 is convex then @xmath525 ( see the proof of theorem [ thm : regularity transport ] below ) and any brenier solution is an alexandrov solution .",
    "in particular the regularity results from section [ sect : caff alex ] apply whenever @xmath32 and @xmath492 are strictly positive on their respective support ( since , in that case , the right hand side in is bounded away from zero and infinity ) and we have the following ( see also @xcite ) :    [ thm : regularity transport ] let @xmath463 be two bounded open sets , let @xmath526 and @xmath527 be two probability densities , respectively bounded away from zero and infinity on @xmath452 and @xmath453 , and denote by @xmath528 the unique optimal transport map sending @xmath32 onto @xmath492 for the cost @xmath479 .",
    "assume that @xmath453 is convex .",
    "then :    1 .   @xmath529 .",
    "if in addition @xmath530 and @xmath531 for some @xmath532 , then @xmath533 .",
    "3 .   furthermore",
    ", if @xmath534 , @xmath535 , and both @xmath452 and @xmath453 are smooth and uniformly convex , then @xmath536 is a global diffeomorphism of class @xmath537 .",
    "as we explained , at least for the interior regularity , the key step in the proof is to show that when @xmath453 is convex brenier solution are alexandrov solutions .",
    "let us briefly sketch the proof of this fact .",
    "+ _ step 1 : for any set @xmath538 it holds @xmath539 _ this is a general fact that does not need the convexity of @xmath453 . indeed , for any set @xmath538 , @xmath540 then , since by alexandrov theorem @xmath486 is differentiable almost everywhere , by the area formula ( * ? ?",
    "* corollary 3.2.20 ) and we get @xmath541 + _ step 2 : if @xmath542 up to a set of measure zero , then @xmath543 _ to see this notice that , for all @xmath538 , @xmath544 and @xmath545 where @xmath546 is the convex conjugate of @xmath4 , see for instance ( * ? ? ?",
    "* lemma 1.1.12 ) .",
    "since any convex function is differentiable almost everywhere , by our assumptions on the densities and the transport relation @xmath547 we infer that @xmath548 since @xmath549 a.e .",
    "and @xmath32 vanishes outside @xmath452 , using again that @xmath547 we get @xmath550 + _ step 3 : @xmath551 .",
    "_ recall that , as a general fact for convex functions , @xmath552 see ( * ? ? ?",
    "* theorem 3.3.6 ) . since @xmath553 , the set of @xmath554 such that @xmath555 is of full measure in @xmath452 , in particular it is dense . from this , , and the convexity of @xmath453 , one immediately deduces that @xmath556 since the measure of @xmath557 is zero , using the previous step we conclude that @xmath4 is an alexandrov solution of @xmath558 finally , to apply the results from section [ sect : caff alex ] one has then to show that @xmath4 is strictly convex inside @xmath452 , see @xcite for more details .",
    "a natural question is what happens when one removes the convexity assumption on the target . as shown in @xcite",
    "( see also @xcite for a more precise description of the singular set in two dimensions ) , in this case one can prove that the optimal trasport map is smooth outside a closed set of measure zero .",
    "more precisely , the following holds :    [ thm : partialma ] let @xmath463 be two bounded open sets , let @xmath526 and @xmath527 be two probability densities , respectively bounded away from zero and infinity on @xmath452 and @xmath453 , and denote by @xmath528 the unique optimal transport map sending @xmath32 onto @xmath492 for the cost @xmath479 . then there exist two relatively closed sets @xmath559 of measure zero such that @xmath560 is a homeomorphism of class @xmath561 for some @xmath562 .",
    "in addition , if @xmath563 , @xmath564 , and @xmath565 for some @xmath566 and @xmath567 , then @xmath568 is a diffeomorphism of class @xmath569 .    as explained above , when @xmath453 is not convex there could points @xmath570 such that @xmath571 and on these points we have no control on the monge - ampre measure of @xmath4 .",
    "let us define @xmath572 by the continuity property of the subdifferential ( * ? ? ?",
    "* proposition 3.3.4 ) , it is immediate to see that @xmath573 is open .",
    "moreover it follows from the condition @xmath574 that @xmath575 for a.e .",
    "@xmath570 , hence @xmath576 .",
    "thus , arguing as in step 2 in the proof of theorem [ thm : regularity transport ] one can show that @xmath4 is a strictly convex alexandrov solution on @xmath573 , so one can apply the regularity results of section [ sect : classical ma ] .",
    "let us remark that , in addition to the situation described in section [ semigeo ] , the regularity theory for optimal transport maps with right hand side only bounded away from zero and infinity appears in other situations .",
    "an important example is provided by the `` partial transport problem '' described here .",
    "+ given two densities @xmath32 and @xmath492 , one wants to transport a fraction @xmath577 $ ] of the mass of @xmath32 onto @xmath492 minimizing the transportation cost @xmath475 . the existence and uniqueness of minimizers it is a very nontrivial problem .",
    "in particular , one can notice that in general uniqueness of minimizers does not holds : if @xmath578 , the family of minimizers is simply given by choosing any fraction of mass of @xmath579 with total volume @xmath446 and just send this mass to itself with zero cost .",
    "+ to ensure uniqueness , in @xcite the authors assumed @xmath32 and @xmath492 to have disjoint supports . under this assumption",
    "they were able to prove ( as in the classical optimal transport problem ) that there exists a convex function @xmath4 such that the unique minimizer is given by @xmath486 .",
    "this function @xmath4 is also shown to solve in a weak sense a `` monge - ampre double obstacle problem '' .",
    "then , strengthening the disjointness assumption into the hypothesis on the existence of a hyperplane separating the supports of the two measures , the authors prove a semiconvexity result on the free boundaries .",
    "furthermore , under some classical regularity assumptions on the measures and on their supports , local @xmath33 regularity of @xmath4 and on the free boundaries of the active regions is shown .",
    "+ in @xcite the second author studied what happens if one removes the disjointness assumption . although minimizers are non - unique for @xmath580 ( but in this case the set of minimizers can be trivially described , as mentioned above ) , uniqueness holds for any @xmath581 .",
    "moreover , exactly as in @xcite , the unique minimizer is given gradient of a convex function .",
    "an important fact proved in @xcite is that both the source and the target mass dominate the common mass @xmath582 ( that is , the common mass is both source and target ) .",
    "this property , which has an interest on its own , implies that the free boundaries never enter inside the intersection of the supports of @xmath32 and @xmath492 , a fact which plays a crucial role in the regularity of the free boundaries .",
    "indeed , it is shown that the free boundaries have zero lebesgue measure ( under some mild assumptions on the supports of the two densities ) . as a consequence of this fact , whenever the support of @xmath492 is assumed to be convex and @xmath32 and @xmath492 are bounded away from zero and infinity on their respective support , theorem [ thm : regularity transport ] allows one to deduce local @xmath34 regularity of the transport map , and to show that it extends to an homeomorphism up to the boundary if both supports are assumed to be strictly convex .",
    "further regularity results on the free boundaries were later obtained in @xcite and @xcite .    on the other hand , in this situation where the supports of @xmath32 and @xmath492 can intersect , something new happens : in the classical optimal transport problem , by assuming @xmath291 regularity on the density of @xmath32 and @xmath492 ( together with some convexity assumption on their supports ) theorem [ thm : regularity transport ] ensures that the transport map is @xmath291 too .",
    "in contrast with this , in @xcite the author showed that @xmath583 regularity is optimal : one can find two @xmath291 densities on @xmath584 , supported on two bounded intervals and bounded away from zero on their supports , such that the transport map is not @xmath29 .",
    "after theorem [ thm : brenier ] , many researchers started to work on the problem of showing existence of optimal maps in the case of more general costs , both in an euclidean setting and in the case of riemannian manifolds .",
    "since at least locally any riemannian manifold looks like @xmath67 , here we shall focus on the case of @xmath67 and then in section [ sect : riem ] we will discuss some of the nontrivial issues that may arise on manifolds ( for instance , due to the presence of the cut - locus ) .",
    "+ we introduce first some conditions on the cost . here and in the sequel , @xmath452 and",
    "@xmath453 denote two open subsets of @xmath67 .    1",
    ".   the cost function @xmath585 is of class @xmath586 with @xmath587 .",
    "2 .   for any @xmath570",
    ", the map @xmath588 is injective .",
    "3 .   for any @xmath589",
    ", the map @xmath590 is injective .",
    "@xmath591 for all @xmath592 .",
    "we now introduce the notion of _ @xmath449-convexity _ , which will play an important role in all our discussion .    a function @xmath593 is _",
    "@xmath449-convex _ if ( which is equivalent to @xmath479 , see section [ sect : quadratic ] ) , @xmath449-convexity corresponds to the classical notion of convexity ( since in that case @xmath594 is a supremum of linear functions ) .",
    "analogously , the @xmath449-subdifferential defined in corresponds to the classical subdifferential for convex functions . ]",
    "@xmath595\\qquad \\forall\\,x \\in x,\\ ] ] where @xmath596 is given by @xmath597\\qquad \\forall \\,y \\in y.\\ ] ] for a @xmath449-convex function @xmath594 , we define its _ @xmath449-subdifferential _ at @xmath77 as @xmath598 or , equivalently , @xmath599 we also define the _ frchet subdifferential _ of @xmath594 at @xmath77 as @xmath600 it is easy to check that , if @xmath449 is of class @xmath29 , then the following inclusion holds : @xmath601 in addition , if @xmath449 satisfies * ( c0)*-*(c2 ) * , then we can define the _",
    "@xmath449-exponential map_:-exponential '' is motivated by the fact that , when @xmath449 is given by the squared riemannian distance on a manifold , the @xmath449-exponential map coincides with the classical exponential map in riemannian geometry . ]",
    "@xmath602 using , we can rewrite as @xmath603 let us point out that , when @xmath604 , @xmath594 is convex and @xmath605 , hence the above inclusion is an equality ( since any local supporting hyperplane is a global support )",
    ". however , for a general cost function @xmath449 , the above inclusion may be strict when @xmath594 is non - differentiable . as we will discuss in section [ mtwsec ] , equality in for every @xmath449-convex function",
    "is necessary for regularity of optimal maps between smooth densities .",
    "notice that , if @xmath606 and @xmath453 is bounded , it follows immediately from that @xmath449-convex functions are lipschitz , so in particular they are differentiable a.e .",
    "[ rmk : semiconv ] if @xmath449 satisfies * ( c0 ) * and @xmath453 is bounded , then it follows from that @xmath594 is semiconvex ( i.e. , there exists a constant @xmath24 such that @xmath607 is convex , see for instance @xcite ) . in particular , by theorem [ thm : alex convex ] , @xmath449-convex functions are twice differentiable a.e .    the following is a basic result in optimal transport theory .",
    "[ cbrenier ] let @xmath608 satisfy * ( c0)*-*(c1)*. given two probability densities @xmath32 and @xmath492 supported on @xmath452 and @xmath453 respectively , there exists a @xmath449-convex function @xmath609 such that the map @xmath610 defined by @xmath611 is the unique optimal transport map sending @xmath32 onto @xmath492 .",
    "if in addition * ( c2 ) * holds , then @xmath612 is injective @xmath613-a.e .",
    ", @xmath614 and its inverse is given by the optimal transport map sending @xmath492 onto @xmath32 .",
    "notice that , in the particular case @xmath604 ( which is equivalent to the quadratic cost @xmath479 , see section [ sect : quadratic ] ) , @xmath449-convex functions are convex and the above result corresponds to theorem [ thm : brenier ] .",
    "we give here a sketch of the proof of theorem [ cbrenier ] , referring to ( * ? ? ?",
    "* chapter 10 ) for more details .",
    "there are several ways to establish this result .",
    "one possibility is to go through the following steps : + _ step 1 : solve the kantorovich problem . _",
    "following kantorovich @xcite , we consider the following relaxed problem : instead of minimizing the transportation cost among all transport maps ( see ) , we consider instead the problem @xmath615 where @xmath616 denotes the set of all probability measures @xmath617 on @xmath618 whose marginals are @xmath613 and @xmath619 , i.e. , @xmath620 for all @xmath621 bounded continuous .    the connection between the formulation of kantorovich and that of monge is the following : any transport map @xmath457 induces the plan defined by @xmath622 which is concentrated on the graph of @xmath457 .",
    "conversely , if a transport plan is concentrated on the graph of a measurable function @xmath457 , then it is induced by this map .    by weak compactness of the set @xmath616 and continuity of the function @xmath623",
    ", it is simple to show the existence of a minimizer @xmath624 for ; so to prove the existence of a solution to the monge problem it suffices to show that @xmath624 is concentrated on the graph of a measurable map @xmath457 , i.e. , @xmath625 once this fact is proved , the uniqueness of optimal maps will follow from the observation that , if @xmath626 and @xmath627 are optimal , then @xmath628 and @xmath629 are both optimal plans , so by linearity @xmath630 is optimal . if it is concentrated on a graph , this implies that @xmath626 and @xmath627 must coincide @xmath613-a.e . ,",
    "proving the desired uniqueness .",
    "+ _ step 2 : the support of @xmath624 is @xmath449-cyclically monotone . _",
    "a set @xmath631 is called _",
    "@xmath449-cyclically monotone _ if , for all @xmath632 , for all @xmath633 , one has @xmath634 where by convention @xmath635 .",
    "the above definition heuristically means that , sending the point @xmath636 to the point @xmath637 for @xmath638 is globally less expensive than sending the point @xmath639 to the point @xmath640 .",
    "it is therefore intuitive that , since @xmath624 is optimal , its support is @xmath449-cyclically monotone ( see @xcite or ( * ? ? ? * chapter 5 ) for a proof ) .",
    "+ _ step 3 : any @xmath449-cyclically monotone set is contained in the @xmath449-subdifferential of a @xmath449-convex function . _ a proof of this fact ( which is due to rockafellar for @xmath604 , and rschendorf for the general case ) consists in constructing explicitly a @xmath449-convex function which does the work : given @xmath469 @xmath449-cyclically monotone , we define @xmath641+\\bigl[c(x_1,y_1)-c(x_2,y_1)\\bigr]\\\\ + \\ldots+\\bigl[c(x_n , y_n)-c(x , y_n)\\bigr ] \\bigr\\},\\end{gathered}\\ ] ] where @xmath642 is arbitrarily chosen in @xmath469 . it can be easily checked that , with this definition , @xmath4 is @xmath449-convex and @xmath643 ( see for instance ( * ? ? ?",
    "* proof of theorem 5.10 ) ) .",
    "+ _ step 4 : @xmath644 is concentrated on a graph . _ applying steps 2 and 3 , we know that the support of @xmath624 is contained in the @xmath449-subdifferential of a @xmath449-convex function @xmath645 . moreover , being @xmath4 the supremum of the family of uniformly lipschitz functions @xmath646 ( see ) , it is lipschitz , hence differentiable a.e .",
    "being the first marginal of @xmath624 absolutely continuous with respect to the lebesgue measure , we deduce that , for @xmath644-almost every @xmath647 , @xmath645 is differentiable at @xmath77 .",
    "now , let us fix a point @xmath648 such that @xmath645 is differentiable at @xmath649 . to prove that @xmath624 is concentrated on a graph , it suffices to prove that @xmath650 is uniquely determined as a function of @xmath649 . to this aim ,",
    "we observe that , since the support of @xmath644 is contained in the @xmath449-subdifferential of @xmath4 , we have @xmath651 , and this implies that the function @xmath652 attains a minimum at @xmath649 . hence",
    ", being @xmath645 is differentiable at @xmath649 we obtain @xmath653 recalling this implies that @xmath654 this proves that @xmath644 is concentrated on the graph of the map @xmath612 , as desired .",
    "+ this concludes the first part of the theorem .",
    "the invertibility of @xmath612 under @xmath655 follows by a simple argument based on the uniqueness of the minimizer of , see ( * ? ? ?",
    "* remark 6.2.11 ) for more details .    in the case when @xmath656 is a compact riemannian manifold one has to face the additional difficulty that the cost function @xmath657 is not smooth everywhere .",
    "however , by exploring the superdifferentiability properties of the squared riemannian distance function ( i.e. , the fact that , for any @xmath658 , the frchet subdifferential of @xmath659 is nonempty at every point ) mccann was able to extend the theorem above the the case of compact riemannian manifolds @xcite ( see also @xcite for a more general result ) :    [ thm : mccann ] let @xmath229 be a smooth compact riemannian manifold , and consider the cost @xmath657 , @xmath660 being the riemannian distance . given two probability densities @xmath32 and @xmath492 supported on @xmath229 , there exists a @xmath449-convex function @xmath661 such that @xmath662 is the unique optimal transport map sending @xmath32 onto @xmath492 .",
    "as shown in theorem [ cbrenier ] , whenever the cost function satisfies * ( c0)*-*(c1 ) * then the unique optimal transport map sending @xmath32 onto @xmath492 is given by @xmath663 .",
    "furthermore , if @xmath449 satisfies * ( c2 ) * , then @xmath664 at every differentiability point ( see ) , it follows that @xmath665 attains a minimum at @xmath666 .",
    "hence , whenever @xmath4 is twice differentiable at @xmath77 ( that is at almost every point , see remark [ rmk : semiconv ] ) we get @xmath667 hence , rewriting the relation @xmath663 as @xmath668 and differentiating the above equation with respect to @xmath77 , using and we obtain @xmath669 at every point @xmath77 where @xmath4 it is twice differentiable .    hence @xmath4 solves a monge - ampre type equation of the form with @xmath670 notice that , if * ( c3 ) * holds and @xmath32 and @xmath492 are bounded away from zero and infinity on their respective supports , then the right hand side in is bounded away from zero and infinity on the support of @xmath32 . as we will see below , some structural conditions on @xmath671 ( or equivalently on the cost @xmath449 ) must be imposed to obtain regularity results .",
    "+ the breakthrough in the study of regularity of optimal transport maps came with the paper of ma , trudinger , and wang @xcite ( whose roots lie in an earlier work of wang on the reflector antenna problem @xcite ) , where the authors found a mysterious fourth - order condition on the cost functions , which turned out to be sufficient to prove the regularity of @xmath4 .",
    "the idea was to differentiate twice equation in order to get a linear pde for the second derivatives of @xmath4 , and then to try to show an a priori estimate on the second derivatives of @xmath4 , compare with theorem [ po1 ] . in this computationone",
    "obtains at a certain moment with a term which needs to have a sign in order to conclude the desired a priori estimate .",
    "this term is what is now called the `` ma  trudinger ",
    "wang tensor '' ( in short @xmath672 tensor ) : @xmath673\\\\ & = \\sum_{i , j , k , l , p , q , r , s}\\left(c_{ij , p}c^{p , q}c_{q , rs } -c_{ij , rs } \\right)c^{r , k}c^{s , l}\\xi^i\\xi^j \\eta^k\\eta^l , \\qquad\\xi , \\eta \\in { \\mathbb{r}}^n .",
    "\\end{split}\\ ] ] in the above formula the cost function is evaluated at @xmath674 , and we used the notation @xmath675 , @xmath676 , @xmath677 , @xmath678 .",
    "the condition to impose on @xmath679 is @xmath680 ( this is called the @xmath672 condition ) .",
    "actually , it is convenient to introduce a more general definition :    given @xmath681 we say that @xmath449 satisfies the @xmath682 condition if , for all @xmath683 and for all @xmath684 , @xmath685    under this hypothesis , and a geometric condition on the supports of the measures ( which is the analogous of the convexity assumption of caffarelli ) , ma , trudinger , and wang could prove the following result @xcite ( see also @xcite ) :    [ thm : mtw ] let @xmath608 satisfy * ( c0)*-*(c3)*. assume that @xmath686 holds , that @xmath32 and @xmath492 are smooth and bounded away from zero and infinity on their respective supports @xmath452 and @xmath453 . also , suppose that :    1 .",
    "@xmath452 and @xmath453 are smooth ; 2 .",
    "@xmath687 is uniformly convex for all @xmath688 ; 3 .",
    "@xmath689 is uniformly convex for all @xmath589 .",
    "then @xmath690 and @xmath691 is a smooth diffeomorphism , where @xmath692 .    for simplicity here we treat the simpler case when @xmath682 holds for some @xmath693 .",
    "this stronger @xmath672 condition is actually the one originally used in @xcite .",
    "the general case @xmath694 is treated in @xcite , where the authors relax the stronger assumption by applying a barrier argument . as we pointed out in remark",
    "[ rmk : degen ] for the classical monge - ampre equation the key point to obtain existence of smooth solutions was to show an a priori estimate on second derivatives of solutions .",
    "the same is true in the case of .",
    "indeed , once we know an a priori @xmath30 bound on smooth solutions of , this equation becomes uniformly elliptic ( in the sense that the linearized operator is uniformly elliptic , see remark [ rmk : degen ] ) and one can run a parallel strategy to the one described in section [ sect : continuity ] to get the existence of smooth solutions ( see @xcite for more details ) .    let us start from a smooth ( say @xmath695 ) solution of , coupled with the boundary condition @xmath696 , where @xmath692 .",
    "our goal here is to show an interior universal bound for the second derivatives of @xmath4 .",
    "we observe that , since @xmath692 , we have @xmath697 hence @xmath4 is globally lipschitz , with a uniform lipschitz bound .",
    "define @xmath698 ( recall that , by the @xmath449-convexity of @xmath4 and , @xmath699 is positive definite . )",
    "then can be written as @xmath700 or equivalently @xmath701 with @xmath702 . by differentiating the above equation and using the convention of summation over repeated indices ,",
    "we get @xmath703 @xmath704 where @xmath705 denotes the inverse of @xmath699 and we use the notation @xmath706 , @xmath707 , @xmath708 , and so on .",
    "then the above equations become @xmath709={\\varphi}_k,\\ ] ] @xmath710 \\geq { \\varphi}_{kk}.\\ ] ] we fix now @xmath711 , we take @xmath712 a cut - off function around @xmath649 , and define the function @xmath713 , @xmath714 we want to show that @xmath715 is uniformly bounded by a universal constant @xmath201 , depending only on @xmath716 , @xmath318 , the cost function , and the function @xmath717 .",
    "( observe that @xmath718 , since @xmath699 is positive definite . ) in fact , this will imply that @xmath719 and since @xmath720 is bounded and @xmath449 is smooth , the above equation gives that @xmath721 is locally uniformly bounded by a universal constant , which is the desired a priori estimate .    to prove the bound on @xmath715 ,",
    "the strategy is the same of theorem [ po1 ] : let @xmath722 and @xmath723 be a point where @xmath715 attains its maximum . by a rotation of",
    "coordinates one can assume @xmath724 .",
    "then at @xmath120 we have @xmath725 @xmath726 since the above matrix is non - positive , we get @xmath727 we further observe that , differentiating the relation @xmath728 , we obtain the relation @xmath729 this gives in particular @xmath730 ( which implies @xmath731 ) , and allows us to write derivatives of @xmath457 in terms of that of @xmath261 and @xmath449 .",
    "the idea is now to start from , and to combine the information coming from , , , , to end up with a inequality of the form @xmath732c^{s , p}c^{t , q}w_{p1}w_{q1}- c,\\ ] ] for some universal constant @xmath201 .",
    "( when doing the computations , one has to remember that the derivatives of @xmath733 depend on derivatives of @xmath171 , or equivalently on derivatives of @xmath457 . ) by a rotation of coordinates that leaves the @xmath734 direction invariant , is a maximum point for the map @xmath735 , therefore ( except in the trivial case @xmath736 ) @xmath737 for every @xmath738 . ]",
    "one can further assume that @xmath699 is diagonal at @xmath120 .",
    "we then obtain @xmath739c^{s,1}c^{t,1}w_{11}w_{11 } \\leq c.\\ ] ] up to now , the @xmath672 condition has not been used .",
    "we now apply @xmath682 to the vectors @xmath740 and @xmath741 to get @xmath742c^{s,1}c^{t,1}w_{11}w_{11},\\ ] ] which gives ( using * ( c0 ) * and the fact that @xmath743 ) @xmath744 recalling that @xmath745 , by the arithmetic - geometric inequality and we have @xmath746 where @xmath747 . hence , combining the above estimate with we finally obtain @xmath748^{2 + 1/(n-1 ) } \\leq c\\bigl(1+w_{11}(x_0)\\bigr ) , \\ ] ] which proves that @xmath749 for all @xmath750 , as desired .    apart from having its own interest ,",
    "this general theory of monge - ampre type equations satisfying the mtw condition turns out to be useful also in the classical case .",
    "indeed the mtw condition can be proven to be coordinate invariant @xcite .",
    "this implies that , if @xmath4 solves an equation of the form with @xmath671 satisfying the mtw condition ( see ) and @xmath751 is a smooth diffeomorphism , then @xmath752 satisfies an equation of the same form with a new matrix @xmath753 which still satisfies the mtw condition .",
    "this means for instance that , if one wants to prove some boundary regularity result , through a smooth diffeomorphism one can reduce himself to a nicer situation . in particular this remark",
    "applies to the classical monge - ampre equation ( which trivially satisfies mtw(0 ) ) : if @xmath4 solves then @xmath752 satisfies for some matrix @xmath671 for which mtw(0 ) holds .",
    "this observation is extremely natural in relation to the optimal transport problem : consider for instance the optimal transport problem with cost @xmath480 between two smooth densities supported on smooth uniformly convex domains . by theorem [ thm : regularity transport ] we know that the optimal map @xmath457 is smooth .",
    "however , if one performs smooth change of coordinates @xmath754 and @xmath755 , under these transformations the cost function becomes @xmath756 and the optimal transport map is given by @xmath757 , which is still smooth . however this regularity of the optimal map can not be deduced anymore from theorem [ thm : regularity transport ] , while theorem [ thm : mtw ] still applies providing the expected regularity .",
    "although the @xmath672 condition seemed the right assumption to obtain regularity of optimal maps , it was only after loeper s work @xcite that people started to have a good understanding of this condition , and a more geometric insight .",
    "the idea of loeper was the following : for the classical monge - ampre equation , a key property to prove regularity of convex solutions is that the subdifferential of a convex function is convex , and so in particular connected . roughly speaking ,",
    "this has the following consequence : whenever a convex function @xmath4 is not @xmath29 at a point @xmath120 , there is at least a whole segment contained in the subdifferential of @xmath4 at @xmath120 , and this fact combined with the monge - ampre equation provides a contradiction .",
    "( see also theorem [ thm : c1a ] below . ) hence , loeper wanted to understand whether the @xmath449-subdifferential of a @xmath449-convex function is at least connected ( recall ) , believing that this fact had a link with the regularity .",
    "+ we wish to find some simple enough conditions implying the connectedness of sets @xmath758 .",
    "of course if @xmath759 is a singleton the connectedness is automatic , so we should look for non - smooth functions .",
    "the easiest example is provided by the maximum of two cost functions : fix @xmath760 , @xmath761 , and define @xmath762 take a point @xmath763 , and let @xmath764 .",
    "since @xmath765 attains its minimum at @xmath766 , we get ( recall for the definition of the frchet subdifferential ) @xmath767 or equivalently @xmath768 from the above inclusion , one can easily deduce that @xmath769 .",
    "moreover , it is not difficult to see that @xmath770\\ } , \\qquad v_i:={\\nabla}_x c(\\bar x , y_i)=(\\operatorname{c - exp}_{\\bar x})^{-1}(y_i ) , \\quad i=0,1.\\ ] ] therefore , denoting by @xmath771 $ ] the segment joining @xmath772 and @xmath773 , we obtain @xmath774\\bigr).\\ ] ]    the above formula suggests the following definition :    let @xmath711 , @xmath760 .",
    "then we define the _",
    "@xmath449-segment _ from @xmath775 to @xmath776 with base @xmath777 as @xmath778_{\\bar x}:=\\bigl\\ { y_t=\\operatorname{c - exp}_{\\bar x}\\bigl((1-t ) ( \\operatorname{c - exp}_{\\bar x})^{-1}(y_0 ) + t ( \\operatorname{c - exp}_{\\bar x})^{-1}(y_1)\\bigr ) \\ ,     in @xcite ,",
    "ma , trudinger , and wang showed that , in analogy with the quadratic case ( see section [ sect : bre alex ] ) , the convexity of @xmath687 for all @xmath570 is necessary for regularity . by slightly modifying their argument",
    ", loeper @xcite showed that the connectedness of the @xmath449-subdifferential is a necessary condition for the smoothness of optimal transport ( see also ( * ? ? ? * theorem 12.7 ) ) :    [ thm : no connect counterexample ] assume that there exist @xmath711 and @xmath779 @xmath449-convex such that @xmath759 is not connected",
    ". then one can construct smooth positive probability densities @xmath32 and @xmath492 such that the optimal map is discontinuous .",
    "while the above result was essentially contained in @xcite , loeper s major contribution was to link the connectedness of the @xmath449-subdifferential to a differential condition on the cost function , which actually coincides with the @xmath672 condition ( see section [ subsect : mtw ] ) .",
    "in @xcite he proved ( a slightly weaker version of ) the following result ( see ( * ? ? ? * chapter 12 ) for a more general statement ) :    [ thm : regular cost ] the following conditions are equivalent :    1 .   for any @xmath594 @xmath449-convex , for all @xmath711 , @xmath759 is connected .",
    "2 .   for any @xmath594 @xmath449-convex , for all @xmath711",
    ", @xmath780 is convex , and it coincides with @xmath781 .",
    "3 .   for all @xmath711 , for all @xmath760 , if @xmath782_{\\bar x}=(y_t)_{t \\in [ 0,1]}\\subset y$ ] then @xmath783\\ ] ] for all @xmath570 , @xmath179 $ ] .",
    "4 .   for all @xmath784 , @xmath589 , @xmath785 with @xmath786 , @xmath787 where @xmath788",
    "moreover , if any of these conditions is not satisfied , @xmath29 @xmath449-convex functions are not dense in the set of lipschitz @xmath449-convex functions .",
    "we give here only some elements of the proof . + _",
    "( ii ) @xmath789 ( i ) . _",
    "since @xmath780 is convex , it is connected , and so its image by @xmath790 is connected too . + _ ( i ) @xmath789 ( ii ) . _ for @xmath791",
    "we have @xmath792,\\ ] ] which is a segment .",
    "since in this case connectedness is equivalent to convexity , if ( i ) holds we obtain @xmath793_{\\bar x}=\\operatorname{c - exp}_{\\bar x}\\bigl({\\partial}^-\\psi_{\\bar x , y_0,y_1}(\\bar x ) \\bigr)$ ] .",
    "in the general case , we fix @xmath794 .",
    "then it is simple to see that @xmath795_{\\bar x},\\ ] ] and the result follows easily .",
    "+ _ ( ii ) @xmath796 ( iii ) .",
    "_ condition is equivalent to @xmath797_{\\bar x}$ ] .",
    "then the equivalence between ( ii ) and ( iii ) follows arguing as above . + _",
    "( iii ) @xmath789 ( iv ) . _ fix @xmath711 and @xmath589 with @xmath798 .",
    "take @xmath799 orthogonal and with unit norm , and define @xmath800 moreover , let @xmath801 we now define a curve @xmath802 contained in the set @xmath803 such that @xmath804 , @xmath805 .",
    "since @xmath806_{\\bar x}$ ] , by ( iii ) we get @xmath807 , so @xmath808+c(\\bar x , y)&=\\psi(\\bar x)+c(\\bar x , y)\\leq \\psi({\\gamma}(t))+c({\\gamma}(t),y)\\\\&=\\frac{1}{2}\\bigl[h_0({\\gamma}(t))+h_1({\\gamma}(t ) ) \\bigr]+c({\\gamma}(t),y),\\end{aligned}\\ ] ] where we used that @xmath809 along @xmath810 . recalling the definition of @xmath811 and @xmath812 we deduce that @xmath813-c({\\gamma}(t),y ) \\leq \\frac{1}{2}\\bigl[c(\\bar x , y_0)+c(\\bar x , y_1 ) \\bigr]-c(\\bar x , y),\\ ] ] so the function @xmath814-c({\\gamma}(t),y)$ ] achieves its maximum at @xmath422 .",
    "this implies @xmath815 \\leq 0,\\ ] ] i.e. , @xmath816\\cdot \\xi,\\xi\\bigr{\\rangle}\\leq 0\\ ] ] ( here we used that @xmath817 $ ] ) .",
    "thus the function @xmath818 is concave , proving ( iv ) .    to understand why the above properties are related to smoothness , consider theorem [ thm : regular cost](iii ) .",
    "it says that if we take the function @xmath819 , then we are able to touch the graph of this function from below at @xmath649 with the family of functions @xmath820}$ ] .",
    "this suggests that we could use this family to regularize the cusp of @xmath821 at the point @xmath777 , by slightly moving above the graphs of the functions @xmath822 . on the other hand ,",
    "if does not hold , it is not clear how to regularize the cusp preserving the condition of being @xmath449-convex .    by what we said above",
    ", the regularity property seems mandatory to develop a theory of smoothness of optimal transport .",
    "indeed , if it is not satisfied , we can construct @xmath823 strictly positive densities @xmath824 such that the optimal map is not continuous .",
    "hence the natural question is when it is satisfied , and what is the link with the @xmath672 condition .",
    "note also that the failure of the connectedness of @xmath825 is a local obstruction to the regularity of optimal transport maps to be compared to the case of the quadratic cost where the obstruction to the regularity is the failure of the convexity of @xmath453 , a global condition .",
    "as we have seen in theorem [ thm : regular cost ] , roughly speaking the connectedness of the @xmath449-subdifferential of @xmath449-convex functions is equivalent to @xmath826 for all @xmath827 , with @xmath828 and @xmath712 orthogonal , @xmath829 .",
    "( this equivalence is not exact , since to show that implies the connectedness of the @xmath449-subdifferential of @xmath449-convex functions one needs to know that the target is @xmath449-convex to ensure that it contains the @xmath449-segment @xmath782_{\\bar x}$ ] , see ( iii ) in theorem [ thm : regular cost ] above . )    by some standard but tedious computations it is not difficult to check that the above expression _ coincides _ up to the sign with the @xmath672 tensor .",
    "hence @xmath830 and by theorems [ thm : mtw ] and [ thm : no connect counterexample ] the mtw condition is necessary and sufficient for the smoothness of the optimal transport map .",
    "+ by exploiting ( a variant of ) theorem [ thm : regular cost ] , loeper @xcite proved the following regularity result ( recall the notation in theorem [ cbrenier ] ) :    [ thm : c1a ] let @xmath608 satisfy * ( c0)*-*(c3)*. assume that the @xmath682 holds for some @xmath693 , @xmath32 is bounded from above on @xmath452 , @xmath492 is bounded away from zero on @xmath453 , and denote by @xmath457 the optimal transport map sending @xmath32 onto @xmath492 .",
    "finally , suppose that @xmath687 is convex for any @xmath570 .",
    "then @xmath831 , with @xmath832 ( hence @xmath833 ) .    in a subsequent paper ,",
    "liu @xcite proved the above result with @xmath834 and showed that such exponent is optimal .",
    "we notice however that this result does not include caffarelli s result since the cost @xmath480 satisfies @xmath686 .",
    "hence , it would be nice to have a hlder regularity theorem which includes at the same time caffarelli s and loeper s results .",
    "as proved by the second author together with kim and mccann @xcite , such a result is indeed true ( see also @xcite ) :    [ thm : c1a mtw0 ] let @xmath608 satisfy * ( c0)*-*(c3)*. assume that the @xmath686 holds , @xmath32 is bounded from above on @xmath452 , and @xmath492 is bounded away both from zero and infinity on @xmath453 . also , suppose that @xmath687 and @xmath835 are uniformly convex for any @xmath570 and @xmath589 .",
    "then @xmath836 for any open set @xmath837 where @xmath32 is uniformly bounded away from zero .",
    "let us mention that further extensions of theorem [ thm : regularity transport ] to this general setting have been obtained in @xcite .",
    "note that theorem [ thm : c1a mtw0 ] as well as the other results in @xcite only deal with the interior regularity for optimal transport maps .",
    "it would be interesting to develop a boundary regularity theory , in the spirit of @xcite , for the class of equations arising in optimal transport .",
    "+ we conclude this section providing some examples of cost functions satisfying the mtw condition ( where defined ) and referring to @xcite for more example .",
    "* @xmath838 ; * @xmath839 ; * @xmath840 ; * @xmath841 with @xmath842 .    note that the last two costs provide ( respectively as @xmath843 and @xmath844 ) an approximation of the monge cost @xmath845 . in spite of the fact that this latter cost does not satisfy",
    "any of the conditions @xmath846-@xmath847 , still existence of optimal transport maps can be proved ( see for instance @xcite for an account of the theory ) and some regularity results have been obtained in @xcite . very recently , the strategy to approximate the monge cost with @xmath848 has been used in @xcite to deduce some estimates for the monge problem by proving a priori bounds on the transport maps which are uniform as @xmath849 .",
    "let us consider the case when @xmath657 on @xmath656 a compact riemannian manifold without boundary . as we have seen in the previous section , the mtw condition and some suitable convexity of the domains are necessary to obtain regularity of optimal maps . here",
    "we have also to face an additional problem : indeed , while before the cost function was assumed to be smooth on @xmath618 , in the case of a compact riemannian manifold without boundary the function @xmath850 is never smooth on the whole @xmath851 due to the presence of the cut - locus ( see section [ sect : cut ] below for a more precise description ) . before focusing on all these issues ,",
    "let us start with the following example which will allow us to look at the mtw condition from a different perspective .",
    "we want to show how negative sectional curvature is an obstruction to regularity ( indeed even to continuity ) of optimal maps when @xmath657 .",
    "( we refer to ( * ? ? ?",
    "* theorem 12.4 ) for more details on the construction given below . )",
    "let @xmath852 be the hyperbolic plane ( or a compact quotient thereof ) .",
    "fix a point @xmath853 as the origin , and fix a local system of coordinates in a neighborhood of @xmath853 such that the maps @xmath854 are local isometries ( it suffices for instance to consider the model of the poincar disk , with @xmath853 equal to the origin in @xmath407 ) . then define the points @xmath855 take a measure @xmath55 symmetric with respect to @xmath93 and concentrated near @xmath856 ( say @xmath857 of the total mass belongs to a small neighborhood of @xmath856 ) , and a measure @xmath451 symmetric with respect to @xmath93 and concentrated near @xmath858 .",
    "moreover assume that @xmath55 and @xmath451 are absolutely continuous , and have positive smooth densities .",
    "we denote by @xmath457 the unique optimal transport map , and we assume by contradiction that @xmath457 is continuous . by symmetry we deduce that @xmath859 , and by counting the total mass there exists a point @xmath860 close to @xmath861 which is sent to a point @xmath862 near , say , @xmath863 .",
    "but , by negative curvature ( if @xmath860 and @xmath862 are close enough to @xmath251 and @xmath864 respectively ) , pythagoras theorem becomes an inequality : @xmath865 , and this contradicts the optimality of the transport map , as transporting @xmath860 onto @xmath853 and @xmath853 onto @xmath862 would be more convenient than transporting @xmath860 onto @xmath862 and letting @xmath853 stay at rest .",
    "now , the natural question is : how does the above example fit into ma , trudinger and wang and loeper s results ?",
    "the answer was given by loeper @xcite where he noticed that , when @xmath657 on a riemannian manifold @xmath229 , the @xmath672 tensor satisfies the following remarkable identity : @xmath866),\\ ] ] where @xmath867 are two orthogonal unit vectors , and @xmath868)$ ] denotes the sectional curvature of the plane generated by @xmath828 and @xmath712 .",
    "combining with theorems [ thm : no connect counterexample ] and [ thm : regular cost ] , we get the following important negative result :    [ thm : negativ curv counterexample ] let @xmath869 be a ( compact ) riemannian manifold , and assume there exist @xmath870 and a plane @xmath871 such that @xmath872 . then there exist smooth positive probability densities @xmath32 and @xmath492 such that the optimal map for the cost @xmath657 is discontinuous .",
    "after this negative result , one could still hope to develop a regularity theory on any manifold with nonnegative sectional curvature .",
    "but this is not the case : as shown by kim @xcite ( see also @xcite ) the regularity condition is strictly stronger than the condition of nonnegativity of sectional curvatures . in conclusion , except for some special cases , the optimal map is non - smooth .",
    "some examples of manifolds satisfying the @xmath672 condition have been found in @xcite :    1 .   @xmath67 and @xmath873 satisfy @xmath686 .",
    "2 .   @xmath874 , its quotients ( like @xmath875 ) , and its submersions ( like @xmath876 or @xmath877 ) , satisfy @xmath878 .",
    "products of any of the examples listed above ( for instance , @xmath879 or @xmath880 ) satisfy @xmath686 .",
    "smooth perturbations of @xmath874 satisfy @xmath682 for some @xmath693 .",
    "+    now , in order to prove regularity of optimal transport maps on manifolds satisfying mtw one would like to localize theorems [ thm : c1a ] and [ thm : c1a mtw0 ] .",
    "however , as we already mentioned above , one has to face a very nontrivial issue : the cost function @xmath850 is not everywhere smooth due to the presence of the cut - locus , hence to localize that theorems one would like to know the validity of the so - called `` stay - away property '' : @xmath881 ( see the next section for a precise definition of @xmath882 . ) while this property has been proven to hold true in some special cases @xcite , it is still unknown in general and this creates several difficulties in the proof of regularity of optimal maps . in particular",
    "this is one of the reasons why , on perturbations of @xmath874 , only continuity ( and not higher regularity ) of optimal maps is currently known @xcite .",
    "another issue is the convexity of the target : in the case of compact manifolds without boundary , the assumption that @xmath883 is convex for every @xmath570 ( see for instance theorem [ thm : c1a ] ) corresponds to the convexity of the cut - locus of the manifold when seen from any tangent space .",
    "this shows that regularity of solutions is strongly related to the convexity of the cut - locus . actually , as we shall describe now , the mtw condition has even much stronger links with the cut - locus .      to explain the connection between the mtw condition and the convexity of the cut - locus ,",
    "we start by recalling some basic definitions .    [ subsect : cut ] given a tangent vector @xmath884 , the curve @xmath885 is a geodesic defined for all times , but in general is not minimizing for large times .",
    "on the other hand , it is possible to prove that @xmath886 is always minimizing between @xmath77 and @xmath887 for @xmath378 sufficiently small .",
    "we define the _ cut - time _ @xmath888 as @xmath889 given @xmath870 , we define the _ cut - locus _ of @xmath77 @xmath890 and the _ injectivity domain _ of the exponential map at @xmath77 @xmath891 for instance , on the sphere @xmath874 , @xmath892 , @xmath893 , @xmath894 , and @xmath895 .",
    "it is possible to prove that , if @xmath896 , then @xmath77 and @xmath447 are joined by a unique minimizing geodesic .",
    "the converse is close to be true : @xmath897 if and only if there are neighborhoods @xmath898 of @xmath77 and @xmath899 of @xmath447 such that any two points @xmath900 and @xmath901 are joined by a unique minimizing geodesic . in particular @xmath897 if and only if @xmath902 .",
    "+ the fact that a point @xmath658 belongs to @xmath882 is a phenomenon which is captured by the regularity of the distance function .",
    "indeed , it can be proven that the following holds ( see for instance ( * ? ? ?",
    "* proposition 2.5 ) ) :    1 .",
    "the function @xmath903 is smooth in a neighborhood of @xmath447 if and only if @xmath896 .",
    "the function @xmath903 has an upward lipschitz cusp at @xmath447 if and only if @xmath904 and there are at least two minimizing geodesics between @xmath77 and @xmath447 .",
    "3 .   the function @xmath903 is @xmath29 at @xmath447 and its hessian has an eigenvalue @xmath905 if and only if @xmath904 and there is a unique minimizing geodesics between @xmath77 and @xmath447 .    in the above statement , having an `` upward cusp '' means that there exist two vectors @xmath906 both belonging to the supergradient of @xmath907 at @xmath447 : writing everything in charts , we have @xmath908 that is @xmath32 is locally below the function @xmath909 near @xmath447 .",
    "hence ( b ) corresponds to roughly say that the second derivative ( along the direction @xmath910 ) of @xmath903 at @xmath447 is @xmath905 .",
    "( the fact that there is an upward cusp means that one of the second directional derivatives is a negative delta measure . )    furthermore , saying that `` hessian has an eigenvalue @xmath905 '' means that ( always working in charts ) @xmath911 thus , the above description of the cut - locus in terms of the squared distance can be informally summarized as follows : @xmath912 + based on this observation , in @xcite loeper and villani noticed the existence of a deep connection between the @xmath672 condition and the geometry of the cut - locus .",
    "the idea is the following : fix @xmath870 , and let @xmath913 . consider the segment @xmath914}$ ] , with @xmath915 .",
    "set further @xmath916 .",
    "since @xmath917 we have @xmath918 in particular @xmath919 is smooth in a neighborhood of @xmath775 and @xmath776 .",
    "assume now that @xmath686 holds .",
    "thanks to theorem [ thm : regular cost](iv ) , we know that the function @xmath920 is concave for all @xmath921 .",
    "( this is just a formal argument , as the theorem applies a priori only if @xmath922 . )",
    "applying this fact along the segment @xmath914}$ ] and exploiting the smoothness of @xmath903 near @xmath775 and @xmath776 , for @xmath923 we obtain @xmath924 } \\bigl{\\langle}d_{xx } d^2(x , y_t)\\cdot \\xi,\\xi\\bigr{\\rangle}\\geq \\min\\bigl\\{\\bigl{\\langle}d_{xx } d^2(x , y_0)\\cdot \\xi,\\xi\\bigr{\\rangle},\\,\\bigl{\\langle}d_{xx } d^2(x , y_1)\\cdot \\xi,\\xi\\bigr{\\rangle}\\bigr\\ } \\geq c_0,\\ ] ] for some constant @xmath925 . hence ,",
    "if we forget for a moment about the orthogonality assumption between @xmath926 and @xmath828 , we see that the above equation implies that @xmath927 for all @xmath179 $ ] ( compare with ) , which by symmetry gives @xmath928,\\ ] ] or equivalently @xmath929.\\ ] ] since @xmath913 , we have obtained @xmath930,\\ ] ] that is @xmath931 is convex . in conclusion , this formal argument suggests that the @xmath672 condition ( or a variant of it ) should imply that all tangent injectivity domains @xmath931 are convex , for every @xmath870 .",
    "+ this would be a remarkable property .",
    "indeed , usually the only regularity results available for @xmath931 say that @xmath932 is just lipschitz @xcite .",
    "moreover , such a result would be of a global nature , and not just local like a semi - convexity property .",
    "unfortunately the argument described above is just formal and up to now there is no complete result in that direction .",
    "still , one can prove some rigorous results in some special cases @xcite .    as we already mentioned before",
    ", the convexity of the tangent cut loci is not only an interesting geometric property but it is also important for the regularity of optimal transport maps , since it corresponds to the assumption that @xmath883 is convex for every @xmath570 . indeed , as shown in @xcite , both the mtw condition and the convexity of the tangent cut - loci are necessary ( and in some cases sufficient ) conditions for the continuity of optimal transport maps on manifolds .      in the case of the classical monge - ampre equation we saw",
    "that convexity of the target is a necessary condition for the regularity of brenier solutions to the monge - ampre equation .",
    "now , in the case of a general cost , in addition to some suitable convexity of the target one needs to assume the validity of the mtw condition . this condition is however known to be true only for few examples of costs ( for instance , all costs of the form @xmath933 with @xmath934 do not satisfy the mtw condition , see however @xcite for some `` perturbative '' result in this case ) .",
    "moreover only few manifolds are known to satisfy it ( essentially just the ones listed in section [ sect : riem ] ) , and for instance it is known to fail on sufficiently flat ellipsoids @xcite .",
    "+ let us also recall that , in the case of a riemannian manifold , the mtw condition implies that the sectional curvature is nonnegative at every point ( see ) . therefore ,",
    "if we consider a compact manifold @xmath869 with negative sectional curvature we have that the mtw condition fails _ at every point_. this fact could make one suspect that the transport map could be extremely irregular",
    ". however , as shown by the authors in @xcite , this negative picture can not happen :    [ thm : c ] let @xmath463 be two bounded open sets , and let @xmath526 and @xmath527 be two continuous probability densities , respectively bounded away from zero and infinity on @xmath452 and @xmath453 .",
    "assume that the cost @xmath608 satisfies * ( c0)*-*(c3 ) * , and denote by @xmath935 the unique optimal transport map sending @xmath32 onto @xmath492 .",
    "then there exist two relatively closed sets @xmath559 of measure zero such that @xmath560 is a homeomorphism of class @xmath936 for any @xmath937 .",
    "in addition , if @xmath563 , @xmath564 , and @xmath565 for some @xmath566 and @xmath567 , then @xmath568 is a diffeomorphism of class @xmath569 .    by suitably localizing this result , in @xcite we could also prove the following :    [ cor : m ] let @xmath229 be a smooth riemannian manifold , and let @xmath938 be two continuous probability densities , locally bounded away from zero and infinity on @xmath229 .",
    "let @xmath939 denote the optimal transport map for the cost @xmath657 sending @xmath32 onto @xmath492 .",
    "then there exist two closed sets @xmath940 of measure zero such that @xmath941 is a homeomorphism of class @xmath936 for any @xmath937 .",
    "in addition , if both @xmath32 and @xmath492 are of class @xmath942 , then @xmath941 is a diffeomorphism of class @xmath569 .    as discussed before ,",
    "when the mtw condition fails the obstruction to the regularity of optimal maps is local , while in the quadratic case it was a global obstruction ( namely the non - convexity of the target which do not allow to have a good control on the monge - ampre measure of @xmath4 ) . in the quadatic cost case , in @xcite",
    "it was shown that on a big set there is still a good control on the monge - ampre measure of the potential @xmath4 allowing to apply the local theory of classical monge - ampre equation , see the sketch of the proof of theorem [ thm : partialma ] . however , the failure of the mtw condition does not allow us to use any local regularity estimate for the pde , therefore a completely new strategy with respect to @xcite has to be used .",
    "+ the rough idea is the following : first of all recall that , thanks to theorem [ cbrenier ] , the optimal transport map @xmath457 is of the form @xmath943 for some @xmath449-convex function @xmath4 .",
    "then , if @xmath649 is a point where @xmath4 is twice differentiable ( see remark [ rmk : semiconv ] ) , around that point @xmath4 looks like a parabola .",
    "in addition , by looking close enough to @xmath649 , the cost function @xmath449 will be very close to the linear one and the densities will be almost constant there . hence @xmath4 is close to a convex function @xmath66 solving an optimal transport problem with linear cost and constant densities .",
    "in addition , since @xmath4 is close to a parabola , so is @xmath66 .",
    "hence , by caffarelli s regularity theory , @xmath66 is smooth and we can use this information to deduce that @xmath4 is even closer to a second parabola ( given by the second order taylor expansion of @xmath66 at @xmath649 ) inside a small neighborhood . by rescaling back this neighborhood at scale @xmath177 and iterating this construction , we obtain that @xmath4 is @xmath944 at @xmath649 for every @xmath532 .",
    "since this argument can be applied at every point in a neighborhood of @xmath649 , we deduce that @xmath4 is @xmath944 there .",
    "this is summarized in the following :    [ c1alpha]let @xmath945 and @xmath946 be two closed sets satisfying @xmath947 let @xmath948 be two densities supported in @xmath949 and @xmath950 respectively , and let @xmath951 be a @xmath449-convex function such that @xmath952 and @xmath953 .",
    "then , for every @xmath954 there exists a constant @xmath955 such that the following holds : if @xmath956 then @xmath957 .",
    "once this result is proved , we know that @xmath958 is a singleton at every point , so it follows from that @xmath959 ( the above identity is exactly what in general may fail for general @xmath449-convex functions , unless the mtw condition holds . ) thanks to this fact we obtain that @xmath4 enjoys a comparison principle , and this allows us to use a second approximation argument with solutions of the classical monge - ampre equation ( in the spirit of @xcite ) to conclude that @xmath4 is @xmath960 in a smaller neighborhood , for some @xmath961 .",
    "then higher regularity follows from standard elliptic estimates .",
    "[ c2alpha ] let @xmath962 be as in proposition [ c1alpha ] , and assume in addition that @xmath963 and @xmath964 for some @xmath566 and @xmath567 .",
    "there exists a small constant @xmath965 such that if @xmath966 then @xmath967 .",
    "these results imply that @xmath612 is of class @xmath968 in neighborhood of @xmath649 ( resp .",
    "@xmath612 is of class @xmath969 if @xmath970 and @xmath971 ) .",
    "being our assumptions completely symmetric in @xmath77 and @xmath447 , we can apply the same argument to the optimal map @xmath972 sending @xmath492 onto @xmath32 . since @xmath973 , it follows that @xmath612 is a global homeomorphism of class @xmath936 ( resp .",
    "@xmath612 is a global diffeomorphism of class @xmath569 ) outside a closed set of measure zero .",
    "in this last section we briefly describe some further material related to monge - ampre type equations and state some open problems .      equations and can be seen has particular cases of _ prescribed jacobian equations _ of the following form : @xmath974\\bigr)=\\psi ( x , u , { \\nabla}u),\\ ] ] where @xmath975 . in case @xmath976 , arguing as in section [ mtwsec ] one sees that becomes @xmath977 let us notice that the classical monge - ampre equation corresponds to the case @xmath978 , and more generally the optimal transport case described in this note corresponds to the case @xmath979 that is @xmath980 ( compare with section [ gcsect ] ) .    motivated by problems arising in geometric optics , trudinger began in @xcite a systematic study of equations of the form - in the particular when @xmath457 is obtained through a generating function @xmath981 .",
    "let us briefly present this theory , referring to @xcite for more details .",
    "given @xmath715 as above , a function @xmath4 is said @xmath715-convex on @xmath23 if for every @xmath262 there exist @xmath775 and @xmath982 such that @xmath983 then , under suitable assumptions on @xmath715 one can define the maps @xmath984 and @xmath985 through the relations @xmath986 with this choice one gets from that @xmath987 whenever @xmath988 .",
    "note that the optimal transportation case corresponds to the choice @xmath989 .    then , under some necessary structural conditions on @xmath715 ( which are the analogous of the mtw condition in this context ) , in @xcite trudinger started developing a theory parallel to the one described in section [ mtwsec ]",
    ". it would be interesting to extend all the results valid in the optimal transportation case to this general setting .",
    "also , in case @xmath715 does not satisfy such necessary structural conditions , it would be nice to check whether an analogue of theorem [ thm : c ] still holds .        1 .",
    "as we already mentioned , in dimension @xmath990 stronger regularity results for solutions of are available @xcite .",
    "in particular , alexandrov showed in @xcite that @xmath4 is continuous differentiable assuming only the upper bound @xmath991 .",
    "hence , in relation to theorem [ w21eps ] a natural question becomes : is it possible to prove @xmath373 ( or even @xmath992 ) regularity of @xmath4 in the @xmath990-d case assuming only an upper bound on @xmath993 ?",
    "apart from its own interest , such a result would have applications in relation to extend theorem [ thm : mainsg ] outside of the periodic setting .",
    "+ 2 .   in @xmath407",
    "there is a link between the classical monge - ampre equation and the theory of _ quasi - conformal _ maps . indeed ,",
    "if @xmath4 is a smooth solution of we can consider consider the maps @xmath994 defined as @xmath995 then , if @xmath996 , a simple computation shows that @xmath997 is @xmath998-quasiconformal , that is @xmath999 where @xmath1000 is the hilbert - schmidt norm . in view of the known higher - integrability theory for quasi - conformal maps (",
    "* theorem 13.2.1 ) , one is led to conjecture that in dimension @xmath990 the sharp version of theorem [ w21eps ] should be @xmath1001 that is @xmath1002 in particular one would get that @xmath1003 for all @xmath1004 .",
    "as we explained at the end of section [ semigeo ] , in the case of smooth initial data existence of _ smooth _ solutions to the semigeostrophic equations is known only for short time . in analogy with the 2-d incompressible euler equations",
    "( see for instance @xcite for a discussion on the analogy between these two equations ) , it would be extremely interesting to understand if , at least in the two dimensional periodic case , there are conditions on the initial data which ensure global in time existence of smooth solutions .",
    "the proof of the fact that the mtw condition holds on perturbations of the round sphere is extremely delicate and relies on the fact that , in the expression of the mtw tensor , 15 terms `` magically '' combine to form a `` perfect square '' ( see @xcite ) , allowing the authors to prove that the mtw tensor satisfies the right inequality .",
    "it seems unlikely to us that this is just a coincidence , and we believe that this fact should be a sign of the presence of an underlying and deeper structure which has not been yet found .",
    "as mentioned in section [ sect : riem ] , the stay - away property is crucial to be able to localize theorems [ thm : c1a ] and [ thm : c1a mtw0 ] to the setting of riemannian manifolds .",
    "in addition , apart from this application , proving ( or disproving ) the validity of this property would represent an important step in the understanding of the geometry of optimal transportation .",
    "as explained in section [ sect : cut ] , there is a formal argument which suggests that the @xmath672 condition should imply that all injectivity domains @xmath931 are convex for every @xmath870 . proving this result in full generality would be interesting both for the regularity of optimal transport maps and as a purely geometric result .",
    "another natural step in understanding the relation between the mtw condition and the regularity of optimal map would be to prove that the mtw condition and the convexity of the tangent cut - loci are both necessary and sufficient conditions for the continuity of optimal transport maps on riemannian manifolds ( with the cost given by the squared distance ) .",
    "as mentioned at the end of section [ sect : cut ] , only the necessity is currently known in general , while the sufficiency is known only in dimension @xmath990 . a nice problem would be to prove the sufficiency in every dimension .",
    "notice that , if one could also prove ( 4 ) above , then as a corollary one would obtain that mtw is necessary and sufficient for regularity of optimal maps on any riemannian manifold .",
    "it would be very interesting to give estimates on the hausdorff dimension of the singular sets @xmath1005 and @xmath1006 appearing in the partial regularity theorems [ thm : c ] and [ cor : m ] . in view of all known example , one is led to conjecture that @xmath1007 .",
    "this is not known even in the case of the quadratic cost when the target is not convex , although some partial results in this directions have been obtained in @xcite .",
    "a even more difficult problem would be to prove that the singular sets are always rectifiable or even , under suitable assumption on the densities , smooth .",
    "parabolic versions of the monge - ampre equation naturally appear in geometric evolution problems ( see for instance @xcite and the references therein ) .",
    "more recently , in @xcite the authors studied the parabolic version of in the context of optimal transport and they showed that , if the mtw condition holds , then under suitable conditions on the initial and target domains the solution exists globally in time and converges exponentially fast , as @xmath1008 to the solution of the original mass transport problem .",
    "apart from its own interest , this result provides a potential way to numerically solve the optimal transport problem by taking a smooth initial condition and running the parabolic flow for sufficiently long time .",
    "it would be extremely interesting to understand if some similar results may hold ( in some weak sense ) even without assuming the validity of the mtw condition , and then obtain partial regularity results in the spirit of theorem [ thm : c ] .",
    "the assumption of the existence of a generating function @xmath715 ensures that the matrix @xmath1009 appearing in is symmetric .",
    "however , for the general class of equations arising from the prescribed jacobian equations , there is no reason why the matrix @xmath671 should be symmetric .",
    "it would be very interesting to understand under which structural assumptions on @xmath671 one can develop a regularity theory ( see ( * ? ? ?",
    "* corollary 1.2 ) for a result in dimension 2 ) .    _ acknowledgments : _ we wish to thank neil trudinger for several useful comments on a preliminary version of this paper .",
    "the second author is partially supported by nsf grant dms-1262411 .",
    "both authors acknowledge the support of the erc adg grant gemethnes .",
    "alexandrov , a. d.  existence and uniqueness of a convex surface with a given integral curvature . existence and uniqueness of a convex surface with a given integral curvature . _ c. r. ( doklady ) acad .",
    "urss ( n. s. ) _ 35 ( 1942 ) , 131134 .",
    "alexandrov , a. d.  _ convex polyhedra .",
    "_ translated from the 1950 russian edition by n. s. dairbekov , s. s. kutateladze and a. b. sossinsky . with comments and bibliography by v. a. zalgaller and appendices by l. a. shor and yu .",
    "springer monographs in mathematics .",
    "springer - verlag , berlin , 2005 .",
    "ambrosio , l. ; colombo , m. ; de philippis , g. ; figalli , a.  existence of eulerian solutions to the semigeostrophic equations in physical space : the 2-dimensional periodic case .",
    "partial differential equations _",
    ", 37 ( 2012 ) , no . 12 , 22092227 .",
    "astala , k. ; iwaniec , t. ; martin , g. _ elliptic partial differential equations and quasiconformal mappings in the plane .",
    "_ princeton mathematical series , 48 .",
    "princeton university press , princeton , nj , 2009 .",
    "xviii+677 pp .",
    "isbn : 978 - 0 - 691 - 13777 - 3 bakelman , i. ya .",
    " generalized solutions of monge - ampre equations .",
    "( russian ) _ dokl .",
    "nauk sssr ( n. s. ) _ 114 ( 1957 ) , 11431145 .",
    "figalli , a.  sobolev regularity for the monge - ampre equation , with application to the semigeostrophic equations .",
    "nauchn . sem .",
    "otdel . mat .",
    "inst . steklov .",
    "( pomi ) 411 ( 2013 ) , teoriya predstavleni , dinamicheskie sistemy , kombinatornye metody .",
    "xxii _ , 103118 , 242 .",
    "ivochkina , n. m.  classical solvability of the dirichlet problem for the monge - ampre equation .",
    "( russian ) questions in quantum field theory and statistical physics , 4 .",
    "otdel . mat .",
    "inst . steklov .",
    "( lomi ) _ 131 ( 1983 ) , 7279 .",
    "john f.  _ extremum problems with inequalities as subsidiary conditions .",
    "_ in studies and essays presented to r. courant on his 60th birthday , january 8 , 1948 , pages 187204 .",
    "interscience , new york , 1948 .",
    "krylov , n.v .  boundedly inhomogeneous elliptic and parabolic equations in a domain ( russian ) . _ izv .",
    "nauk sssr ser .",
    "_ 47 ( 1983 ) , 75108 .",
    "english translation in _ math .",
    "_ 20 ( 1983 ) , 459492 .",
    "trudinger , n. s.  on the prescribed jacobian equation .",
    "proceedings of international conference for the 25th anniversary of viscosity solutions , 243255 , _ gakuto internat .",
    "_ 30 , gakkotosho , tokyo , 2008 ."
  ],
  "abstract_text": [
    "<S> we survey the ( old and new ) regularity theory for the monge - ampre equation , show its connection to optimal transportation , and describe the regularity properties of a general class of monge - ampre type equations arising in that context . </S>"
  ]
}