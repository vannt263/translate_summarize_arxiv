{
  "article_text": [
    "capturing and summarizing the global shape of a cloud of points is at the heart of many data processing applications such as novelty detection , outlier detection as well as related unsupervised learning tasks such as clustering and density estimation .",
    "one of the main difficulties is to account for potentially complicated shapes in multidimensional spaces , or equivalently to account for non standard dependence relations between variables .",
    "such relations become critical in applications , for example in fraud detection where a fraudulent action may be the dishonest combination of several actions , each of them being reasonable when considered on their own .",
    "accounting for complicated shapes is also related to computational geometry and nonlinear algebra applications , for example integral computation @xcite and reconstruction of sets from moments data @xcite .",
    "some of these problems have connections and potential applications in machine learning .",
    "the work presented in this paper brings together ideas from both disciplines , leading to a method which allows to encode in a simple manner the global shape and spatial concentration of points within a cloud .",
    "we start with a surprising ( and apparently unnoticed ) empirical observation . given a collection of points ,",
    "one may build up a distinguished sum - of - squares ( sos ) polynomial whose coefficients ( or gram matrix ) is the inverse of the empirical moment matrix ( see section [ sec : empirical ] ) .",
    "its degree depends on how many moments are considered , a choice left to the user .",
    "remarkably its sublevel sets capture much of the global shape of the cloud as illustrated in figure [ fig : examples ] .",
    "this phenomenon is _ not _ incidental as illustrated in many additional examples in appendix a. to the best of our knowledge , this observation has remained unnoticed and the purpose of this paper is to report this empirical finding to the machine learning community and provide first elements toward a mathematical understanding as well as potential machine learning applications .",
    "the proposed method is based on the computation of the coefficients of a very specific polynomial which depends solely on the empirical moments associated with the data points . from a practical perspective , this can be done via a single pass through the data , or even in an _ online _ fashion via a sequence of efficient woodbury updates .",
    "furthermore the computational cost of evaluating the polynomial does _ not _ depend on the number of data points which is a crucial difference with existing nonparametric methods such as nearest neighbors or kernel based methods @xcite . on the other hand ,",
    "this computation requires the inversion of a matrix whose size depends on the dimension of the problem ( see section [ sec : empirical ] ) .",
    "therefore , the proposed framework is suited for moderate dimensions and potentially very large number of observations .    in section [ sec : interpretation ]",
    "we first describe an affine invariance result which suggests that the distinguished sos polynomial captures very intrinsic properties of clouds of points . in a second step ,",
    "we provide a mathematical interpretation that supports our empirical findings based on connections with orthogonal polynomials @xcite .",
    "we propose a generalization of a well known extremality result for orthogonal univariate polynomials on the real line ( or the complex plane ) ( * ? ? ?",
    "* theorem 3.1.2 ) . as a consequence",
    ", the distinguished sos polynomial of interest in this paper is understood as the unique optimal solution of a convex optimization problem : minimizing an average value over a structured set of positive polynomials .",
    "in addition , we revisit ( * ? ? ? * theorem 3.5.6 ) about the _ christoffel _ function .",
    "the mathematics behind provide a simple and intuitive explanation for the phenomenon that we empirically observed .    finally , in section [ sec : experiments ] we perform numerical experiments on kdd cup network intrusion dataset @xcite .",
    "evaluation of the distinguished sos polynomial provides a score that we use as a measure of outlyingness to detect network intrusions ( assuming that they correspond to outlier observations ) .",
    "we refer the reader to @xcite for a discussion of available methods for this task . for the sake of a fair comparison we have reproduced the experiments performed in @xcite for the same dataset .",
    "we report results similar to ( and sometimes better than ) those described in @xcite which suggests that the method is comparable to other dedicated approaches for network intrusion detection , including robust estimation and mahalanobis distance @xcite , mixture models @xcite and recurrent neural networks @xcite .     and",
    "the level sets of the corresponding inverse moment matrix sos polynomial @xmath0 ( @xmath1 ) .",
    "the level set @xmath2 , which corresponds to the average value of @xmath0 , is represented in red .",
    "right : 1040 points in @xmath3 with size and color proportional to the value of inverse moment matrix sos polynomial @xmath0 ( @xmath4).,title=\"fig : \" ]   and the level sets of the corresponding inverse moment matrix sos polynomial @xmath0 ( @xmath1 ) .",
    "the level set @xmath2 , which corresponds to the average value of @xmath0 , is represented in red .",
    "right : 1040 points in @xmath3 with size and color proportional to the value of inverse moment matrix sos polynomial @xmath0 ( @xmath4).,title=\"fig : \" ]",
    "we fix the ambient dimension to be @xmath5 throughout the text . for example",
    ", we will manipulate vectors in @xmath6 as well as @xmath5-variate polynomials with real coefficients .",
    "we denote by @xmath7 a set of @xmath5 variables @xmath8 which we will use in mathematical expressions defining polynomials .",
    "we identify monomials from the canonical basis of @xmath5-variate polynomials with their exponents in @xmath9 : we associate to @xmath10 the monomial @xmath11 which degree is @xmath12 .",
    "we use the expressions @xmath13 and @xmath14 to denote the graded lexicographic order , a well ordering over @xmath5-variate monomials .",
    "this amounts to , first , use the canonical order on the degree and , second , break ties in monomials with the same degree using the lexicographic order with @xmath15 for example , the monomials in two variables @xmath16 , of degree less or equal to @xmath17 listed in this order are given by : @xmath18 .",
    "we denote by @xmath19 , the set @xmath20 ordered by @xmath14 .",
    "@xmath21 $ ] denotes the set of @xmath5-variate polynomials : linear combinations of monomials with real coefficients .",
    "the degree of a polynomial is the highest of the degrees of its monomials with nonzero coefficients and it is @xmath14 smaller than all other monomials . ] .",
    "we use the same notation , @xmath22 , to denote the degree of a polynomial or of an element of @xmath9 . for @xmath23 , @xmath24 $ ] denotes the set of @xmath5-variate polynomials of degree less or equal to @xmath25 .",
    "we set @xmath26 , the number of monomials of degree less or equal to @xmath25 .",
    "we will denote by @xmath27 the vector of monomials of degree less or equal to @xmath25 sorted by @xmath14 .",
    "we let @xmath28^{s(d)}$ ] . with this notation",
    ", we can write a polynomial @xmath29 $ ] as follows @xmath30 for some real vector of coefficients @xmath31 ordered using @xmath14 .",
    "given @xmath32 , @xmath33 denotes the evaluation of @xmath34 with the assignments @xmath35 .",
    "given a borel probability measure @xmath36 and @xmath37 , @xmath38 denotes the moment @xmath39 of @xmath36 : @xmath40 . throughout the paper",
    ", we will only consider measures of which all moments are finite",
    ".      given a borel probability measure @xmath36 on @xmath6 , the moment matrix of @xmath36 , @xmath41 , is a matrix indexed by monomials of degree at most @xmath25 ordered by @xmath14 . for @xmath42 , the corresponding entry in @xmath41",
    "is defined by @xmath43 , the moment @xmath44 of @xmath36 . when @xmath45 , letting @xmath46 for @xmath47 , we have @xmath48 @xmath41 is positive semidefinite for all @xmath23 .",
    "indeed , for any @xmath49 , let @xmath50 $ ] be the polynomial with vector of coefficients @xmath51 , we have @xmath52 .",
    "furthermore , we have the identity @xmath53 where the integral is understood elementwise .",
    "we denote by @xmath54 \\subset { \\mathbb{r}}[x]$ ] ( resp .",
    "@xmath55 \\subset { \\mathbb{r}}_d[x]$ ] ) , the set of polynomials ( resp .",
    "polynomials of degree at most @xmath25 ) which can be written as a sum of squares of polynomials .",
    "let @xmath56 $ ] for some @xmath57 , then @xmath34 belongs to @xmath58 $ ] if there exists a finite @xmath59 and a family of polynomials @xmath60 $ ] , @xmath61 , such that @xmath62 .",
    "it is obvious that sum of squares polynomials are always nonnegative .",
    "a further interesting property is that this class of polynomials is connected with positive semidefiniteness .",
    "indeed , @xmath34 belongs to @xmath58 $ ] if and only if @xmath63 as a consequence , every positive semidefinite matrix @xmath64 defines a polynomial in @xmath58 $ ] by using the representation in ( [ eq : equivsos ] ) .",
    "the _ inverse moment - matrix sos polynomial _ is associated to a measure @xmath36 which satisfies the following .    [",
    "ass : mainassumption ] @xmath36 is a borel probability measure on @xmath6 with all its moments finite and @xmath41 is positive definite for a given @xmath23 .",
    "[ def : sospoly ] let @xmath65 satisfy assumption [ ass : mainassumption ] .",
    "we call the sos polynomial @xmath66 $ ] defined by the application : @xmath67 the inverse moment - matrix sos polynomial of degree @xmath68 associated to @xmath36 .",
    "actually , connection to orthogonal polynomials will show that the inverse function @xmath69 is called the _ christoffel _",
    "function in the literature @xcite ( see also section [ sec : interpretation ] ) . in the remainder of this section , we focus on the situation when @xmath36 corresponds to an empirical measure over @xmath70 points in @xmath6 which are fixed .",
    "so let @xmath71 be a fixed set of points and let @xmath72 where @xmath73 corresponds to the dirac measure at @xmath74 .",
    "in such a case the polynomial @xmath0 in ( [ pol - def ] ) is determined only by the empirical moments up to degree @xmath68 of our collection of points .",
    "note that we also require that @xmath75 .",
    "in other words , the points @xmath76 do not belong to an algebraic set defined by a polynomial of degree less or equal to @xmath25 .",
    "we first describe empirical properties of inverse moment matrix sos polynomial in this context of empirical measures .",
    "a mathematical intuition and further properties behind these observations are developped in section [ sec : interpretation ] .",
    "the starting point of our investigations is the following phenomenon which to the best of our knowledge has remained unnoticed in the literature . for the sake of clarity and simplicity we provide an illustration in the plane .",
    "consider the following experiment in @xmath3 for a fixed @xmath23 : represent on the same graphic , the cloud of points @xmath77 and the sublevel sets of sos polynomial @xmath0 in @xmath3 ( equivalently , the superlevel sets of the christoffel function ) .",
    "this is illustrated in the left panel of figure [ fig : examples ] .",
    "the collection of points consists of @xmath78 simulations of two different gaussians and the value of @xmath25 is @xmath79 .",
    "the striking feature of this plot is that the level sets capture the global shape of the cloud of points quite accurately .",
    "in particular , the level set @xmath80 captures most of the points .",
    "we could reproduce very similar observations on different shapes with various number of points in @xmath3 and degree @xmath25 ( see appendix a ) .",
    "an additional remark in a similar line is that @xmath81 tends to take higher values on points which are isolated from other points . indeed in the left panel of figure [ fig : examples ]",
    ", the value of the polynomial tends to be smaller on the boundary of the cloud .",
    "this extends to situations where the collection of points correspond to shape with a high density of points with a few additional outliers .",
    "we reproduce a similar experiment on the right panel of figure [ fig : examples ] . in this example , @xmath82 points are sampled close to a ring shape and 40 additional points are sampled uniformly on a larger square .",
    "we do not represent the sublevel sets of @xmath0 here .",
    "instead , the color and shape of the points are taken proportionally to the value of @xmath0 , with @xmath83 .",
    "first , the results confirm the observation of the previous paragraph , points that fall close to the ring shape tend to be smaller and points on the boundary of the ring shape are larger .",
    "second , there is a clear increase in the size of the points that are relatively far away from the ring shape .",
    "this highlight the fact that @xmath0 tends to take higher value in less populated areas of the space .",
    "if we fix @xmath84 , we recover the maximum likelihood estimation for the gaussian , up to a constant additive factor . to see this , set @xmath85 and @xmath86 . with this notation",
    ", we have the following block representation of the moment matrix , @xmath87 where @xmath88 is the empirical covariance matrix and the expression for the inverse is given by schur complement . in this case , we have @xmath89 for all @xmath90 .",
    "we recognize the quadratic form that appears in the density function of the multivariate gaussian with parameters estimated by maximum likelihood .",
    "this suggests a connection between the inverse sos moment polynomial and maximum likelihood estimation .",
    "unfortunately , this connection is difficult to generalize for higher values of @xmath25 and we do not pursue the idea of interpreting the empirical observations of this section through the prism of maximum likelihood estimation and leave it for further research . instead , we propose an alternative view in section [ sec : interpretation ] .",
    "recall that @xmath26 is the number of @xmath5-variate monomials of degree up to @xmath25 .",
    "the computation of @xmath0 requires @xmath91 operations for the computation of the moment matrix and @xmath92 operations for the matrix inversion .",
    "the evaluation of @xmath0 requires @xmath93 operations .    estimating the coefficients of @xmath0 has a computational cost that depends only linearly in the number of points @xmath70",
    "the cost of evaluating @xmath0 is constant with respect to the number of points @xmath70 .",
    "this is an important contrast with kernel based or distance based methods ( such as nearest neighbors and one class svm ) for density estimation or outlier detection since they usually require at least @xmath94 operations for the evaluation of the model @xcite .",
    "moreover , this is well suited for online settings where inverse moment matrix computation can be done using woodbury updates .",
    "the dependence in the dimension @xmath5 is of the order of @xmath95 for a fixed @xmath25 .",
    "similarly , the dependence in @xmath25 is of the order of @xmath96 for a fixed dimension @xmath5 and the joint dependence is exponential .",
    "this suggests that the computation and evaluation of @xmath0 will mostly make sense for moderate dimensions and degree @xmath25 .",
    "the purpose of this section is to provide a mathematical rationale that _ explains _ the empirical observations made in section [ sec : empirical ] .",
    "all the proofs are postponed to appendix b. we fix a borel probability measure @xmath36 on @xmath6 which satisfies assumption [ ass : mainassumption ] . note that @xmath41 is always positive definite if @xmath36 is not supported on the zero set of a polynomial of degree at most @xmath25 . under assumption",
    "[ ass : mainassumption ] , @xmath41 induces an inner product on @xmath97 and by extension on @xmath24 $ ] ( see section [ sec : notations ] ) .",
    "this inner product is denoted by @xmath98 and satisfies for any polynomials @xmath99 $ ] with coefficients @xmath100 , @xmath101 we will also use the canonical inner product over @xmath24 $ ] which we write @xmath102 } : = \\left\\langle{\\mathbf{p } } , { \\mathbf{q}}\\right\\rangle_{{\\mathbb{r}}^{s(d)}}$ ] for any polynomials @xmath99 $ ] with coefficients @xmath100 . we will omit the subscripts for this canonical inner product and use @xmath103 for both products .",
    "it is worth noticing that the mapping @xmath104 does not depend on the particular choice of @xmath27 as a basis of @xmath24 $ ] , any other basis would lead to the same mapping .",
    "this leads to the result that @xmath0 captures affine invariant properties of @xmath36 .",
    "[ lem : affineinvariance ] let @xmath36 satisfy assumption [ ass : mainassumption ] and @xmath105 define an invertible affine mapping on @xmath6 , @xmath106 .",
    "then , the push foward measure , defined by @xmath107 for all borel sets @xmath108 , satisfies assumption [ ass : mainassumption ] ( with the same @xmath25 as @xmath36 ) and for all @xmath90 , @xmath109 .",
    "lemma [ lem : affineinvariance ] is probably better understood when @xmath110 as in section [ sec : empirical ] . in this case",
    ", we have @xmath111 and lemma [ lem : affineinvariance ] asserts that the level sets of @xmath112 are simply the images of those of @xmath0 under the affine transformation @xmath113 .",
    "this is illustrated in appendix d.      we define a classical @xcite family of orthonormal polynomials , @xmath114 ordered according to @xmath14 which satisfies for all @xmath115 @xmath116 it follows from ( [ eq : orthodef ] ) that @xmath117 if @xmath118 .",
    "existence and uniqueness of such a family is guaranteed by the gram - schmidt orthonormalization process following the @xmath14 order on the monomials , and by the positivity of the moment matrix , see for instance ( * ? ? ?",
    "* theorem 3.1.11 ) .",
    "let @xmath119 be the lower triangular matrix which rows are the coefficients of the polynomials @xmath120 defined in ( [ eq : orthodef ] ) ordered by @xmath14 .",
    "it can be shown that @xmath121 , where @xmath122 is the cholesky factorization of @xmath41 .",
    "furthermore , there is a direct relation with the inverse moment matrix as @xmath123 ( * ? ?",
    "* proof of theorem 3.1 ) .",
    "this has the following consequence .",
    "[ lem : connectionortho ] let @xmath36 satisfy assumption [ ass : mainassumption ] , then @xmath124 , where the family @xmath125 is defined by ( [ eq : orthodef ] ) and @xmath126 .",
    "that is , @xmath0 is a very specific and distinguished sos polynomial , the sum of squares of the orthonormal basis elements @xmath127 of @xmath128 ( w.r.t .",
    "@xmath36 ) . furthermore",
    ", the average value of @xmath0 with respect to @xmath36 is @xmath129 which corresponds to the red level set in left panel of figure [ fig : examples ] .      in this section ,",
    "we show that the family of polynomials @xmath130 defined in ( [ eq : orthodef ] ) is the unique solution ( up to a multiplicative constant ) of a convex optimization problem over polynomials .",
    "this fact combined with lemma [ lem : connectionortho ] provides a mathematical rationale for the empirical observations outlined in section [ sec : empirical ] .",
    "consider the following optimization problem .",
    "@xmath131 where @xmath132 , @xmath133 .",
    "we first comment on problem ( [ eq : optpoly ] ) .",
    "let @xmath134 be the sos polynomial appearing in the objective function of ( [ eq : optpoly ] ) . the constraints of problem ( [ eq : optpoly ] ) restrict @xmath34 to be in a certain set @xmath135 $ ] . with this notation , problem ( [ eq : optpoly ] )",
    "is reformulated as @xmath136",
    ". therefore problem ( [ eq : optpoly ] ) balances two antagonist targets , on one hand the minimization of the average value of the sos polynomial @xmath34 with respect to @xmath36 , on the other hand the avoidance of the trivial polynomial , enforced by the constraint that @xmath137 .",
    "the constraints on @xmath34 are simple and natural , they ensure that @xmath34 is a sum of squares of polynomials @xmath138 , where the leading term of @xmath139 ( according to the ordering @xmath14 ) is @xmath140 with @xmath141 ( and hence does not vanish ) .",
    "inversely , using cholesky factorization , for any sos polynomial @xmath142 of degree @xmath68 which coefficient matrix ( see equation ( [ eq : equivsos ] ) ) is positive definite , there exists @xmath143 such that @xmath144 .",
    "this suggests that @xmath145 is a quite general class of nonvanishing sos polynomials .",
    "the following result , which gives a relation between @xmath0 and solutions of ( [ eq : optpoly ] ) , uses a generalization of ( * ? ? ?",
    "* theorem 3.1.2 ) to several orthogonal polynomials of several variables .",
    "[ prop : mainres ] : under assumption [ ass : mainassumption ] , problem ( [ eq : optpoly ] ) is a convex optimization problem with a unique optimal solution @xmath146 , which satisfies @xmath147 , @xmath133 , for some @xmath148 . in particular ,",
    "the distinguished sos polynomial @xmath149 is ( part of ) the unique optimal solution of ( [ eq : optpoly ] ) .",
    "theorem [ prop : mainres ] states that up to the scaling factor @xmath150 , the distinguished sos polynomial @xmath0 is _ the unique optimal solution of problem ( [ eq : optpoly ] ) . _ a detailed proof is provided in the appendix b and we only sketch the main ideas here .",
    "first , it is remarkable that for each fixed @xmath133 ( and again up to a scaling factor ) the polynomial @xmath120 is the unique optimal solution of the problem : @xmath151,\\,q({\\mathbf{x}})={\\mathbf{x}}^\\alpha+\\sum_{\\beta { < _ { gl}}\\alpha}{\\mathbf{q}}_\\beta\\,{\\mathbf{x}}^\\beta\\ :   \\right\\}$ ] .",
    "this fact is well - known in the univariate case ( * ? ? ?",
    "* theorem 3.1.2 ) and does not seem to have been exploited in the literature , at least for purposes similar to ours",
    ". so intuitively , @xmath152 should be as close to @xmath153 as possible on the support of @xmath36 .",
    "problem ( [ eq : optpoly ] ) has similar properties and the constraint on the vector of weights @xmath154 enforces that , at an optimal solution , the contribution @xmath155 to the overall sum in the criterion is the same for all @xmath156 . using lemma [ lem : connectionortho ] yields ( up to a multiplicative constant ) the polynomial @xmath0 .",
    "other constraints on @xmath154 would yield different weighted sum of the squares @xmath152 .",
    "this will be a subject of further investigations .    to sum up",
    ", theorem [ prop : mainres ] provides a rationale for our observations .",
    "indeed when solving ( [ eq : optpoly ] ) , intuitively , @xmath0 should be as close to @xmath153 as possible on average while remaining in a large class of nonvanishing sos polynomials .      the following result from ( * ? ?",
    "* theorem 3.5.6 ) draws a direct connection between @xmath0 and the _ chritoffel _ function ( the right hand side of ( [ eq : christoffel ] ) ) .",
    "[ th : christoffel ] let assumption [ ass : mainassumption ] hold and let @xmath157 be fixed , arbitrary",
    ". then @xmath158}\\:\\left\\{\\int_{{\\mathbb{r}}^p } p({\\mathbf{x}})^2\\,d\\mu({\\mathbf{x } } ) : p(\\bar{{\\mathbf{x}}})\\,=\\,1 \\right\\}.\\ ] ]    theorem [ th : christoffel ] provides a mathematical rationale for the use of @xmath0 for outlier or novelty detection purposes .",
    "indeed , from lemma [ lem : connectionortho ] and equation ( [ eq : orthodef ] ) , we have @xmath159 on @xmath6 . furthermore , the solution of the minimization problem in ( [ eq : christoffel ] ) satisfies @xmath160 and @xmath161 ( by markov s inequality ) .",
    "hence , for high values of @xmath162 , the sublevel set @xmath163 contains most of the mass of @xmath36 while @xmath160 . again",
    "the result of theorem [ th : christoffel ] does not seem to have been interpreted for purposes similar to ours .",
    "in addition to having its own mathematical interest , theorem [ prop : mainres ] can be exploited for various purposes .",
    "for instance , the sub - level sets of @xmath0 , and in particular @xmath164 , can be used to encode a cloud of points in a simple and compact form .",
    "however in this section we focus on another potential application in anomaly detection .",
    "empirical findings described in section [ sec : empirical ] suggest that the polynomial @xmath0 can be used to detect outliers in a collection of real vectors by taking @xmath36 to be the corresponding empirical measure .",
    "this is backed up by the results presented in section [ sec : interpretation ] . in this section",
    "we illustrate these properties on a real world example .",
    "we choose the kdd cup 99 network intrusion dataset ( available at @xcite ) which consists of network connection data with labels describing whether they correspond to normal traffic or network intrusions .",
    "we follow @xcite and @xcite and construct five datasets consisting of labeled vectors in @xmath165 , the label indicating normal traffic or network attack .",
    "the content of these datasets is summarized in the following table .    [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     the details on how these datasets are constructed are available in @xcite and are reproduced in appendix c. the main idea is to give to each datapoint an outlyingness score solely based on its position in @xmath165 and then compare outliers predicted by the score with the label indicating network intrusion .",
    "the underlying assumption is that network intrusion corresponds to infrequent abnormal behaviors and could thus be considered as outliers .",
    "we reproduce the exact same experiment that was described in ( * ? ? ?",
    "* section 5.4 ) using the value of the inverse moment matrix sos polynomial from definition [ def : sospoly ] as an outlyingness score ( with @xmath166 ) .",
    "the authors of @xcite have compared different types of methods for outlier detection in the same experimental setting : methods based on robust estimation and mahalanobis distance @xcite , mixture model based methods @xcite and recurrent neural network based methods .",
    "these results are gathered in ( * ? ? ?",
    "* figure 7 ) . in the left panel of figure",
    "[ fig : kdd ] we represent the same performance measure for our approach .",
    "we first compute the value of the inverse moment sos polynomial for each datapoint and use it as an outlyingness score .",
    "we then display the proportion of correctly identified outliers , with score above a given threshold , as a function of the proportion of examples with score above the threshold ( for different values of the threshold ) .",
    "the main comments are as follows .",
    "@xmath167 the inverse moment matrix sos polynomial does detect network intrusions with varying performances on the five datasets .",
    "@xmath167 except for the `` ftp - data dataset '' , the global shape of these curves are very similar to results reported in ( * ? ? ?",
    "* figure 7 ) indicating that the proposed approach is comparable to other dedicated methods for intrusion detection in these four datasets .    in a second experiment",
    ", we investigate the effect of changing the value of @xmath25 in @xmath0 on the performances in terms of outlier detection .",
    "we focus on the `` others '' dataset because it is the most heterogeneous in term of data and outliers .",
    "we adopt a slightly different measure of performance and use precision recall curves ( see for example @xcite ) to measure performances in identifying network intrusions ( the higher the curve , the better ) .",
    "we call the area under such curves the aupr",
    ". the right panel of figure [ fig : kdd ] represents these results .",
    "first , the case @xmath168 , which corresponds to vanilla mahalanobis distance as outlined in section [ sec : maxlikelihood ] , gives poor performances .",
    "second , the global performances rapidly increase with @xmath25 and then decrease and stabilize .",
    "this suggests that @xmath25 can be used as a tuning parameter which controls the `` complexity '' of @xmath0 .",
    "indeed , @xmath68 is the degree of the polynomial @xmath0 and it is expected that more complex models will potentially identify more diverse classes of examples of points as outliers . in our case , this means identifying regular traffic as outliers while it actually does not correspond to intrusions .    ) .",
    "right : precision - recall curves for different values of @xmath25 for the dataset `` others''.,title=\"fig : \" ] ) .",
    "right : precision - recall curves for different values of @xmath25 for the dataset `` others''.,title=\"fig : \" ]",
    "we presented empirical findings with a mathematical intuition regarding the sublevel sets of the inverse moment matrix sos polynomial .",
    "this opens many potential subjects of investigations .    *",
    "similarities with maximum likelihood .",
    "* statistics in the context of empirical processes .",
    "* relation between a density and its inverse moment matrix sos polynomial .",
    "assymptotics when the degree increases .",
    "* connections with computational geometry and non gaussian integrals . * computationally tractable extensions in higher dimensions .",
    "this work was partly supported by project erc - adg taming 666981,erc - advanced grant of the _",
    "european research council _ and grant number fa9550 - 15 - 1 - 0500 from the _ air force office of scientific research , air force material command_.    10    v.  chandola and a.  banerjee and v.  kumar ( 2009 ) .",
    "anomaly detection : a survey .",
    "acm computing surveys ( csur ) 41(3):15 .",
    "j.  davis and m.  goadrich ( 2006 ) .",
    "the relationship between precision - recall and roc curves .",
    "proceedings of the 23rd international conference on machine learning ( pp .",
    "233 - 240 ) .",
    "dunkl and y.  xu ( 2001 ) .",
    "orthogonal polynomials of several variables .",
    "cambridge university press .",
    "mr1827871 .",
    "g.h  golub , p.  milanfar and j.  varah ( 1999 ) .",
    "a stable numerical method for inverting shape from moments .",
    "siam journal on scientific computating 21(4):12221243 ( 1999 ) .",
    "b.  gustafsson , m.  putinar , e.  saff and n.  stylianopoulos ( 2009 ) .",
    "bergman polynomials on an archipelago : estimates , zeros and shape reconstruction .",
    "advances in mathematics 222(4):14051460 .",
    "hadi ( 1994 ) .",
    "a modification of a method for the detection of outliers in multivariate samples . journal of the royal statistical society .",
    "series b ( methodological ) , 56(2):393 - 396 .",
    "j.w .  helton and j.b .",
    "lasserre and m.  putinar ( 2008 ) .",
    "measures with zeros in the inverse of their moment matrix .",
    "the annals of probability , 36(4):1453 - 1471 .",
    "knorr and r.t .",
    "ng and r.h.zamar ( 2001 ) .",
    "robust space transformations for distance - based operations .",
    "proceedings of the international conference on knowledge discovery and data mining ( pp .",
    "126 - 135 ) .",
    "lasserre ( 2015 ) .",
    "level sets and nongaussian integrals of positively homogeneous functions . international game theory review , 17(01):1540001 .    j.b .",
    "lasserre and m.putinar ( 2015 ) . algebraic - exponential data recovery from moments .",
    "discrete & computational geometry , 54(4):993 - 1012 .",
    "m.  lichman ( 2013 ) .",
    "machine learning repository , http://archive.ics.uci.edu/ml university of california , irvine , school of information and computer sciences .",
    "oliver and r.a.baxter and c.s .",
    "wallace ( 1996 ) .",
    "unsupervised learning using mml .",
    "proceedings of the international conference on machine learning ( pp .",
    "364 - 372 ) .",
    "g.  szeg ( 1974 ) .",
    "orthogonal polynomials . in colloquium publications , ams , ( 23 ) ,",
    "fourth edition .",
    "g.  williams and r.  baxter and h.  he and s.  hawkins and l.  gu ( 2002 ) . a comparative study of rnn for outlier detection in data mining .",
    "ieee international conference on data mining ( p. 709 ) .",
    "ieee computer society .",
    "k.  yamanishi and j.i .  takeuchi and g.",
    "williams and p.  milne ( 2004 ) . on - line",
    "unsupervised outlier detection using finite mixtures with discounting learning algorithms .",
    "data mining and knowledge discovery , 8(3):275 - 300 .",
    "for various values of @xmath25 and various configurations and numbers of points @xmath70 .",
    "the level set @xmath2 , which corresponds to the average value of @xmath0 , is represented in red . ]",
    "we use the same notation as in the main text .",
    "we recall that assumption 1 .    [",
    "ass : mainassumptionappendix ] @xmath36 is a borel probability measure on @xmath6 with all its moments finite and @xmath41 is positive definite for a given @xmath23 .",
    "lemma 2 and theorem 2 are taken from the literature and we provide a proof for completeness .      first we show that the mapping @xmath104 does not depend on the choice of a specific basis of @xmath24 $ ]",
    ". then we will deduce the affine invariance property .",
    "[ lem : auxlemma1appendix ] let @xmath169 be an arbitrary basis of @xmath24 $ ] and let @xmath170 $ ] be derived in the same way as @xmath0 ( see definition 1 ) , with @xmath171 in place of @xmath172 .",
    "then @xmath173 for all @xmath90 .",
    "since @xmath171 is a basis of @xmath24 $ ] , there exists an invertible matrix @xmath174 such that @xmath175 .",
    "we reproduce the computation of definition 1 with this new basis .",
    "we write @xmath176 the moment matrix computed with the polynomial basis @xmath171 .",
    "we have @xmath177 which leads to @xmath178 . using definition 1 , for all @xmath90",
    ", we have @xmath179 which concludes the proof .",
    "[ lem : affineinvarianceappendix ] let @xmath36 satisfy assumption [ ass : mainassumptionappendix ] and @xmath105 define an invertible affine mapping on @xmath6 , @xmath106 .",
    "then , the push foward measure , defined by @xmath107 for all borel sets @xmath108 , satisfies assumption [ ass : mainassumptionappendix ] ( with the same @xmath25 as @xmath36 ) and for all @xmath90 , @xmath109 .",
    "let us first compute @xmath180 .",
    "for the push forward measure @xmath181 , it holds that for any @xmath36 integrable function @xmath182 , @xmath183 by considering polynomial @xmath184 , we have that @xmath181 has all its moments finite and satisfies assumption [ ass : mainassumptionappendix ] with the same @xmath25 as @xmath36 .",
    "furthermore , we have @xmath185 we can deduce the following identity for all @xmath90 , @xmath186 it remains to notice that mappings defined by @xmath187 for all @xmath90 form a basis of the polynomials of degree up to @xmath25 on @xmath6 ( by invertibility of the affine mapping ) . combining ( [ eq : affineinv1 ] ) and ( [ eq : affineinv2 ] )",
    ", we see that @xmath188 simply corresponds to the use of a different basis of @xmath24 $ ] .",
    "the result follows by applying lemma [ lem : auxlemma1appendix ] and the proof is complete .",
    "recall that the orthogonal polynomials satisfy for all @xmath189 @xmath190    [ lem : connectionorthoappendix ] let @xmath36 satisfy assumption [ ass : mainassumptionappendix ] , then @xmath124 , where the family @xmath125 is defined by ( [ eq : orthodefappendix ] ) and @xmath126 .",
    "let @xmath119 be the lower triangular matrix which rows are the coefficients of the polynomials @xmath120 defined in ( [ eq : orthodefappendix ] ) ordered by @xmath14 . from properties in ( [ eq : orthodefappendix ] )",
    ", @xmath119 is lower triangular with positive coefficients on its diagonal and therefore invertible .",
    "we have @xmath191 , the identity .",
    "it follows that @xmath192 and @xmath123 .",
    "plugging this in definition 1 and using equation ( 1 ) leads to the desired identity .",
    "the average value result follows because we manipulate an orthonormal basis of @xmath129 polymials , each of which has a square average value ( with respect to @xmath36 ) equal to @xmath193 .",
    "we recall the the optimization problem .",
    "@xmath194 where @xmath195 , @xmath133 . the statement of theorem 1 goes as follows .",
    "[ prop : mainres ] : problem ( [ eq : optpolyappendix ] ) is a convex optimization problem with a unique optimal solution @xmath146 , which satisfies @xmath147 , @xmath133 , for some @xmath148 . in particular ,",
    "the distinguished sos polynomial @xmath196 is ( part of ) the unique optimal solution of ( [ eq : optpolyappendix ] ) .",
    "[ [ general - remarks . ] ] general remarks .",
    "+ + + + + + + + + + + + + + + +    observe that ( [ eq : optpolyappendix ] ) is a convex optimization problem as we have @xmath197 , which is strictly convex in @xmath198 .",
    "the proof is based on kkt optimality conditions for problem ( [ eq : optpolyappendix ] ) .",
    "we first prove that any optimal solution should be of the form @xmath147 , @xmath133 , for some @xmath148 .",
    "then we show that there exists a solution of the kkt system which has this form and finally that this solution is unique .",
    "the conclusion of theorem 1 will then follow from lemma 1 .",
    "we begin with some notations that we will use throughout the proof .    [ [ notation . ] ] notation .",
    "+ + + + + + + + +    let @xmath199 denote the canonical basis of @xmath97 indexed by @xmath189 according to @xmath14 order .",
    "the orthonormal polynomials @xmath200 ( with respect to @xmath36 ) are uniquely defined . for each @xmath189 ,",
    "we write @xmath201 the coefficients of the polynomial @xmath120 . by construction of @xmath120 , for every @xmath202 , @xmath203 , @xmath204 and @xmath205 .",
    "[ [ optimality - conditions ] ] optimality conditions + + + + + + + + + + + + + + + + + + + + +    problem ( [ eq : optpolyappendix ] ) is strictly feasible , we can choose any @xmath154 such that @xmath206 and for every @xmath133 , set @xmath207 for some sufficiently large @xmath208",
    ". therefore the kkt optimality conditions are necessary and sufficient for global optimality .",
    "we introduce lagrange multipliers for problem ( [ eq : optpolyappendix ] ) : @xmath209 for each inequality constraint , @xmath210 for each linear equality constraint on polynomials with @xmath203 and @xmath211 for the last linear equality constraint on @xmath212 .",
    "the kkt optimality conditions for problem ( [ eq : optpolyappendix ] ) can be written as follows @xmath213 for optimal variables @xmath214 , polynomials @xmath215 with coefficients @xmath216 , for each @xmath189 .",
    "we next show that the part @xmath217 of an optimal solution is necessarily a family of orthogonal polynomials .",
    "[ [ any - optimal - solution - has - the - form - q_alpha - sqrtlambdap_alpha - alphainmathbbnp_d - for - some - lambda0 . ] ] any optimal solution has the form @xmath147 , @xmath133 , for some @xmath148 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    since kkt conditions are necessary and sufficient for optimality , we only focus on them . for each @xmath218 and @xmath219 , multiplying ( [ eq : kkt4 ] ) by @xmath220 , we obtain @xmath221 similarly , multiplying ( [ eq : kkt4 ] ) by @xmath222 yields for all @xmath189 , @xmath223 where we have used ( [ eq : kkt5 ] ) for the last identity . in particular , with @xmath224 , @xmath225 ( @xmath226 ) for all @xmath74 and so @xmath227 which shows that @xmath148 .",
    "next , combining ( [ eq : orthocondit1 ] ) , ( [ eq : orthocondit2 ] ) and the condition ( [ eq : kkt2 ] ) , we immediately deduce @xmath228 finally , for every @xmath189 , multiplying ( [ eq : kkt4 ] ) by @xmath229 yields @xmath230 the last inequality follows from ( [ eq : kkt5 ] ) . indeed , suppose @xmath231 for some @xmath232 , this would yield @xmath233 . since we have shown that @xmath234 , it must also hold that @xmath235 for all @xmath156 .",
    "combining relations ( [ eq : kkt2 ] ) , ( [ eq : orthocondit1 ] ) , ( [ eq : orthocondit3 ] ) and ( [ eq : orthocondit4 ] ) , we have shown that the @xmath236 form a family of orthogonal polynomials with respect to @xmath36 .",
    "in addition , by the uniqueness of the orthonormal basis @xmath237 , it follows from ( [ eq : orthocondit3 ] ) that @xmath238 for every @xmath133 .",
    "[ [ there - exists - a - solution - of - this - form . ] ] there exists a solution of this form .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    recall that , for each @xmath189 , @xmath201 is the vector of coefficients of the polynomial @xmath239 which satisfies by construction @xmath205 and @xmath204 for all @xmath240 , @xmath203 .",
    "we use the following assignment for the primal and dual variables .",
    "@xmath241 using orthonormality of the polynomials @xmath200 , it can be check that the assignment ( [ eq : optassignment ] ) satisfies kkt optimality conditions ( [ eq : kkt1 ] ) , ( [ eq : kkt2 ] ) , ( [ eq : kkt3 ] ) , ( [ eq : kkt4 ] ) and ( [ eq : kkt5 ] ) .",
    "we have therefore constructed an optimal solution of ( [ eq : optpolyappendix ] ) with the desired form .",
    "[ [ the - optimal - solution - is - unique . ] ] the optimal solution is unique .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    from what precedes any optimal solution of ( [ eq : optpolyappendix ] ) is necessarily such that @xmath242 , for every @xmath243 , for some @xmath244 . in addition the optimal value of ( [ eq : optpolyappendix ] )",
    "is @xmath245 .",
    "suppose that there exists two different optimal solutions @xmath246 and @xmath247 with associated dual variables @xmath248 and @xmath249 .",
    "then necessarily @xmath250 , @xmath251 and @xmath252 for all @xmath189 .",
    "but then from ( [ eq : kkt5 ] ) , @xmath253 and so @xmath254 for every @xmath133 .",
    "therefore the solution is unique and this concludes the proof of theorem 1 .",
    "[ th : christoffelappendix ] let assumption [ ass : mainassumptionappendix ] hold and let @xmath157 be fixed , arbitrary .",
    "then @xmath255}\\:\\left\\{\\int p({\\mathbf{x}})^2\\,d\\mu : p(\\bar{{\\mathbf{x}}})\\,=\\,1 \\right\\}.\\ ] ]    fix an arbitrary @xmath50 $ ] and @xmath256 .",
    "assume that @xmath257 .",
    "letting for all @xmath189 , @xmath258 , by orthonormality , we have @xmath259 the assumption that @xmath257 can be used in conjonction with cauchy - schwartz inequality to obtain @xmath260 where the last equality comes from the definition of @xmath261 and lemma 2 .",
    "there is equality in equation [ eq : affineortho2 ] if and only if @xmath262 which always leads to @xmath257 .",
    "this shows that the infimum is attained and concludes the proof .",
    "we reproduce the exact same manipulations as in the references . we downloaded the ` kddcup.data ` from the following repository    https://archive.ics.uci.edu/ml/machine-learning-databases/kddcup99-mld/",
    "this file contains @xmath263 instances of network connections described by 42 features including the type of connection ( attack or normal ) .",
    "we filter the records by keeping only those for which the variable _ logged in _ is positive .",
    "we kept the labels ( type of connection ) together with the four most important features : _ service , duration , src_bytes , dst_bytes_. we applied to the three last variables ( numerical ) the function @xmath264 .",
    "we build four datasets with the four most frequent instances of _ service _ and group all the remaining records in the dataset _",
    "others _ to get our five datasets .",
    "the following figure illustrate the affine invariance property described in lemma 1 .     for three configurations of the same cloud of points ( @xmath1 ) .",
    "the cloud in the middle is rotation of the original one and the cloud on the right is the same after centering and scaling .",
    "we observe that the level sets follow the same transformations . ]"
  ],
  "abstract_text": [
    "<S> we study a surprising phenomenon related to the representation of a cloud of data points using polynomials . </S>",
    "<S> we start with the previously unnoticed empirical observation that , given a collection ( a cloud ) of data points , the sublevel sets of a certain distinguished polynomial capture the shape of the cloud very accurately . </S>",
    "<S> this distinguished polynomial is a sum - of - squares ( sos ) derived in a simple manner from the inverse of the empirical moment matrix . </S>",
    "<S> in fact , this sos polynomial is directly related to orthogonal polynomials and the _ christoffel _ function . </S>",
    "<S> this allows to generalize and interpret extremality properties of orthogonal polynomials and to provide a mathematical rationale for the observed phenomenon . among diverse potential applications , </S>",
    "<S> we illustrate the relevance of our results on a network intrusion detection task for which we obtain performances similar to existing dedicated methods reported in the literature . </S>"
  ]
}