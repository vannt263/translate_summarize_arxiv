{
  "article_text": [
    "the accurate theoretical calculation of geometrical parameters at minima and of the corresponding vibrational properties are of great importance in chemistry and materials science since they can help the interpretation of vibrational spectroscopy experiments such as infrared and raman .",
    "the general computational approach is to calculate relaxed geometries and vibrational frequencies from energies and derivatives of the potential energy surface ( pes ) obtained , within the born - oppenheimer approximation , via different quantum mechanical techniques such as hartree - fock , density functional theory ( dft ) , complete active space self - consistent field ( casscf ) , meller - plesset perturbation theory ( pt ) , and coupled - cluster ( cc ) .",
    "two different issues may currently limit the capability of quantum chemistry tools to quantitative predict vibrational properties of large molecules where electron correlation plays an important role : the accuracy of the computational method used and the complications introduced by the anharmonicity of the pes . in the harmonic approximation , vibrational frequencies are calculated at the pes local minima by diagonalization of the mass - weighted hessian matrix through normal mode analysis . an empirical way to consider the effects of anharmonicity consists in the introduction of `` ad hoc '' scaling factors @xcite to match the experimental frequencies .",
    "more accurate results are obtained going beyond the harmonic approximation .",
    "fully variational methods exists@xcite , but they are computationally affordable only for small molecules , while already for medium size molecules some approximations are necessary , still giving very accurate results . among these approximative methods , it is successfully widely used , an approach based on second order vibrational perturbation theory ( pt2)@xcite , which takes the force fields of the pes around the configurational minimum up to the fourth order expansion to predict most of the spectroscopic parameters .",
    "an alternative approach , which directly includes finite temperature nuclear motions , is represented by ab - initio molecular dynamics simulations@xcite , where ir and raman spectra can be directly obtained from the fourier transform of dipole and polarizability autocorrelation functions .",
    "provided that we can proficiently account for the anharmonicity of the pes within a pt2 approach , at least for not too large - amplitude motions , the accuracy of the adopted electronic structure calculations becomes the leading ingredient for obtaining accurate results . a convenient balance between accuracy and computational cost is given by dft , that scale as @xmath2 , being @xmath3 the number of electrons in the system .",
    "however , well known drawbacks of the available exchange - correlation functionals @xcite limit the application of dft to molecules where electronic correlation does not play a crucial role , leaving the correct treatment of such cases to more accurate post - hartree - fock methods .",
    "unfortunately , the latter methods are computationally highly demanding as the number of electrons @xmath3 increases , since they scale as @xmath4 .",
    "an alternative to the most traditional quantum chemical approaches is represented by quantum monte carlo ( qmc)@xcite , a name that stands for a collection of wave - function - based methods for the stochastic solution of the electronic many - body schrdinger equation . the simplest qmc approach is the variational monte carlo ( vmc ) , which relies on the evaluation of the expectation value of the molecular hamiltonian on a given parametrized wave function @xmath5 .",
    "the parameters are chosen to minimize the variational energy which is calculated through stochastic integration .",
    "the choice of the wave function is crucial and is generally composed by an antisymmetrical determinantal part , aimed to describe static correlation effects , and a bosonic part , the jastrow factor @xcite , which recovers most of the dynamical correlation effects .",
    "recent wave function developments include the jastrow- antisymmetrized geminal power ( j - agp)@xcite , the pfaffian@xcite , the backflow@xcite , and others multi - determinant - jastrow functions@xcite .",
    "other qmc schemes beyond the variational ansatz are often based on projection methods .",
    "although they are usually more accurate they are computationally more demanding . for instance , the diffusion monte carlo ( dmc ) @xcite consists in an imaginary time evolution of a trial wave function that in this way is projected onto the ground state .    within qmc",
    "the energy of correlated molecular systems can be calculated with an accuracy in line with experimental data and with the most accurate traditional quantum chemistry methods @xcite but with a computational cost scaling with the size of the system as @xmath6 @xcite .",
    "this favorable scaling properties , the high accuracy of the results , and the fact that qmc algorithms are intrinsically parallel ( demonstrated by an almost perfect scalability up to tens of thousands of processors on recent high performance computing facilities @xcite ) should make qmc an optimal choice for accurate calculations of molecular geometries and vibrational properties . on the other side , the underlying stochastic nature of the monte carlo algorithms",
    "is reflected into the fact that qmc energies and forces are affected by a stochastic error , which slowly decreases as the square root of the computational time . due to this major drawback",
    "structural optimizations of molecules using qmc methods have been efficiently implemented only in the very last years@xcite . to tackle this problem in a recent work sorella and coworkers",
    "@xcite proposed a combination of the reweighting method@xcite , the correlated sampling technique @xcite and the space warp coordinate transformation@xcite . with the help of the algorithmic adjoint differentiation",
    "all the components of the ionic vmc forces can be calculated with and without pseudopotentials in a computational time that is only about four times that of an ordinary energy calculation@xcite .",
    "vibrational properties , which require the calculation of second derivatives of the energy , to the best of our knowledge have never been calculated at full qmc level for systems larger than diatomic molecules@xcite .",
    "the accurate evaluation of relaxed molecular geometries using error affected potential energy surfaces is therefore still a challenge for computational chemistry and the establishment of an efficient procedure can be a breakthrough for the calculation based on qmc methods .    in this work",
    "we have developed a framework to estimate optimized geometrical parameters , harmonic frequencies and anharmonic constants of molecules where the potential energy surface is affected by a statistical uncertainty such as in the case of qmc calculations .",
    "the goal has been achieved using a multi - dimensional fitting procedure of the pes and its first derivatives with respect to the ionic positions in the neighborhood of the minimum . a crucial role in the fitting procedure",
    "is represented by the choice of the number and positions of grid points around the expected configurational minimum .",
    "the effects of the grid and of the mesh size have been investigated with the help of preliminary dft calculations where an uncertainty of the order of magnitude of typical qmc measures has been introduced . in the first section of the present paper we review the calculation of vibrational properties from pt2 , and in the second section we address the problem of fitting the pes using error affected measures .",
    "finally we illustrate how to proceed in the choice of the grid points for the specific case of the water molecule demonstrating the feasibility of the method for qmc calculations .",
    "we assume , as usual , to separate the electronic and nuclear part of the coulomb hamiltonian following the born - oppenheimer approximation .",
    "we considere a set of configurations of the nuclear coordinates close to the equilibrium structure , and for each configuration we obtain the ground state energy and nuclear forces using a dft or qmc calculation .",
    "the energy values can be fitted with a parametric function , in order to obtain the potential energy surface ( pes ) of the molecule in the neighborhood of the equilibrium structure .",
    "this parametric pes enters into the nuclear hamiltonian , which describes the quantum mechanical motion of the nuclei , _",
    "i.e. _ translations , rotations and vibrations of the molecule .    in the following section we will provide a short overview of the well established theory for the description of molecular vibrational properties , considering firstly the formulation of the nuclear problem in cartesian and internal coordinates , followed by the harmonic approximation , and secondly the second order perturbation theory ( pt2 ) for the calculation of the anharmonic corrections . in the next section we will consider the problem of fitting the pes from qmc calculations , that differently from most quantum chemical methods for electronic structure calculation is affected by stochastic errors .",
    "the nuclear hamiltonian @xmath7 is the summation of the kinetic @xmath8 and potential @xmath9 energy operators , the latter operator being given by the fitted pes .",
    "given a molecule with @xmath10 atoms , the two terms can be easily written in terms of the @xmath11-dimensional cartesian coordinates @xmath12 : @xmath13 where @xmath14 is the mass of the atom @xmath15 and @xmath16 is its cartesian coordinate along the @xmath17-axis .",
    "the use of atomic units is always implicitly assumed hereafter .",
    "the potential energy is generally assumed to be invariant under rotations and translations of the molecule as a whole ( hypothesis of homogeneous and isotropic space ) , therefore it is independent on the position of the center of mass and on the orientation of the molecule ( _ i.e. _ the 6 _ external _ degrees of freedom for a non - linear molecule , or 5 in case of a linear one ) , and the potential energy is often conveniently written in terms of @xmath18 ( or @xmath19 for a linear molecule ) _ internal _ coordinates .",
    "for simplicity of notation , hereafter we will consider always the case of a non - linear molecule , so we will have 3n-6 internal degrees of freedom and 6 external ones .",
    "the internal coordinates describe the vibrational motion of the molecule , and the external coordinates the rotational and translational motion .",
    "the separation between an intramolecular term and a roto - translational term of motion , that is straightforward for the potential , is more complex for the kinetic part . in 1935 carl eckart showed , considering a body - fixed reference frame which rotates and translates with the molecule , that the factorization of the nuclear wave function in a vibrational and rotranslational one is never exact , as there are always non - vanishing vibration - rotation coupling terms@xcite .",
    "however there are some conditions , known as eckart conditions , or sayvetz conditions@xcite , which minimize these coupling terms . a nuclear kinetic operator that includes these coupling term was obtained by wilson and howard@xcite in 1936 , and refined by darling and dennison@xcite in 1940 , until in 1968",
    "watson@xcite simplified it to obtain the form generally used nowadays , which is referred as watson kinetic operator . in the following sections we first review the harmonic approximation , where the coupling terms are completely neglected , and later a second order perturbation theory calculation , where coupling terms appears , coming from the simplified watson form of the kinetic energy operator .",
    "a molecule can usually be assumed semi - rigid , therefore its potential energy is proficiently written in terms of displacements from the equilibrium structure , corresponding to the ( local ) minimum of the pes . given the equilibrium structure in cartesian coordinates @xmath20 ; the cartesian displacement is @xmath21 .",
    "often it is more convenient to use internal coordinates @xmath22 ( _ e.g. _ valence coordinates : bond lengths , angles and dihedral angles ) in place of the cartesian ones . indicating with @xmath23 the internal coordinates for the equilibrium structure that correspond to @xmath24 , a generic displacement from equilibrium in internal coordinates is @xmath25 . a mapping between the cartesian displacements @xmath26 and the internal coordinates @xmath27 exists , but in general this relation is linear only in first approximation , since generally internal coordinates are curvilinear .",
    "close to the equilibrium structure we can taylor expand @xmath27 : @xmath28 where @xmath29 indexes the internal coordinates ; @xmath30 index the cartesian coordinates ( _ i.e. _ components @xmath31 for each atom ) .",
    "the einstein summation notation of repeated indices is assumed hereafter , unless otherwise indicated or if in an expression summation terms are explicitly written .",
    "the coefficients in the series are the derivatives with respect to the cartesian displacements : @xmath32 , @xmath33 , and so on .",
    "the coefficients @xmath34 appearing in the linear term coincide with the well known wilson @xmath35 matrix @xcite .",
    "the potential energy function for the nuclei in the proximity of the equilibrium structure is well described as a taylor expansion in terms of the internal displacements coordinates : @xmath36 where the coefficients in the expansion are defined as @xmath37 , @xmath38 , @xmath39 ,  all calculated in @xmath40 .",
    "clearly , if the configuration corresponding to @xmath40 , _",
    "i.e. _ the reference structure , is a minimum for the potential energy , the coefficients @xmath41 are all zero for the euler conditions .",
    "the coefficient @xmath42 represents the ( local ) minimum value of the potential energy , and it is an irrelevant offset for any vibrational calculation .",
    "for this reason it is usually ignored , considering implicitly @xmath43 in place of @xmath44 .",
    "the vibrational normal modes calculation in harmonic approximation is a standard approach , well known in literature@xcite and implemented in most quantum chemistry codes . here",
    "we will summarize the main results , that we will use below .    if it is assumed that the reference structure is a minimum for the pes , the linear term in the taylor expansion of @xmath45 is zero .",
    "the main approximation in the harmonic approach is that only the leading terms , _",
    "i.e. _ the quadratic ( harmonic ) ones , are considered in both the potential and kinetic energy , indicated hereafter by @xmath46 and @xmath47 , and all remaining terms are neglected . in internal coordinates the approximated potential and kinetic energy are respectively given by : @xmath48 @xmath49 where @xmath50 is the time derivative of @xmath51 , and the @xmath52 matrix @xmath53 is calculated , according to wilson@xcite , as : @xmath54 being the coefficients @xmath55 the same that appear in the linear term of ( [ eq_sx ] ) , upon remapping of the indexes from @xmath56 to @xmath57 .    introducing the @xmath58 normal coordinates @xmath59 it is possible to express both the potential and kinetic energies in diagonal form : @xmath60 @xmath61 where the coefficients @xmath62 are the harmonic force constants , that provide the harmonic frequencies of vibration @xmath63 . once written in terms of",
    "the normal coordinates the problem is straightforward both in the classical and in the quantum case , since it factorizes in @xmath58 independent harmonic oscillators ( at least in case of nondegenerate frequencies , that we will not consider in this work ) .    assuming that normal coordinates @xmath64 are linearly related with internal coordinates @xmath27 by the relation @xmath65 , substituting in ( [ eq_vh(s ) ] ) and ( [ eq_th(s ) ] ) and comparing with ( [ eq_vh(q ) ] ) and ( [ eq_th(q ) ] ) yields the relations for the transformation @xmath66 , that written in matrix form are : @xmath67 where @xmath68 is a diagonal matrix with elements the harmonic force constants @xmath69",
    ", @xmath70 is the @xmath58 dimensional unit matrix , and symbol @xmath71 indicates the transpose matrix .",
    "the second equation implies that @xmath72 , which substituted in the first condition yields : @xmath73 . clearly , if we are only interested in the harmonic frequencies , it is enough to solve the secular equation : @xmath74 .      using second order perturbation theory (",
    "pt2)@xcite it is possible to go beyond the harmonic approximation and to take into account anharmonic effects , expanding the pes to the third and forth order terms .",
    "the first point in the approach is to consider the forth order potential energy expansion written in terms of normal coordinates @xmath64 : @xmath75 where we recognize in @xmath76 the harmonic force constants already introduced in the previous section .",
    "the coefficients @xmath77 and @xmath78 are the anharmonic force constants , respectively of third and forth order .",
    "assuming that we have fitted the pes in terms of the internal displacement coordinates @xmath27 around the minimum structure , obtaining the values of the tensors @xmath42 that appear in ( [ eq_v(s ) ] ) ( the zeroth and first order terms are clearly irrelevant ) , we need to map this values into the tensors @xmath68 that appear in ( [ eq_v(q ) ] ) .",
    "to do this we need to consider the transformation from internal curvilinear coordinates @xmath27 to normal rectilinear @xmath64 . differently from what we did in the harmonic approach",
    ", here we must consider that this relation is not linear , since the internal coordinates are curvilinear .",
    "we can consider the following taylor expansion of @xmath27 in terms of @xmath64 : @xmath79 where the transformation elements are called @xmath80 tensor elements@xcite .",
    "the linear terms @xmath66 coincide with the matrix @xmath81 in ( [ eqs_lh ] ) which solves the secular equation in the harmonic calculation .",
    "substitution of ( [ eq_sq ] ) in ( [ eq_v(s ) ] ) and comparison with ( [ eq_v(q ) ] ) provides the relation between the @xmath68 coefficients and the @xmath42 ones : @xmath82 in agreement with @xcite .",
    "the @xmath80 tensor elements can be determined using the following relations : @xmath83 where the coefficients @xmath84 can be calculated , using a matrix notation , as @xmath85 , and the tensors @xmath86 and @xmath87 can be obtained from @xmath35 by numerical differentiation .",
    "once all the coefficients of the expansion ( [ eq_v(q ) ] ) are determined , we consider the watson hamilton operator up to the fourth order of expansion in normal coordinates @xmath88 , that is@xcite ( the einstein convention is not used from here to the rest of the section ) : @xmath89 in which : @xmath90 in these expressions @xmath91 is the operator relative to @xmath92 normal coordinate , and @xmath93 is the corresponding momentum operator , conjugate to @xmath91 ; @xmath94 represents the three rotational axes in eckart frame , @xmath95 the corresponding equilibrium rotational constants , being @xmath96 the principal moments of inertia ; @xmath97 represents the coriolis coupling constants",
    ".    the second order perturbative calculation provides the coefficients in the expansion for the molecular vibrational energy : @xmath98 where @xmath99 are the @xmath58 quantum numbers associated to corresponding vibrational modes .",
    "in particular the anharmonic coefficients @xmath100 are calculated as@xcite : @xmath101 and for @xmath102 : @xmath103 where the first term in @xmath104 and in @xmath100 comes from the first order perturbation , and all others come from the second order perturbation . the last term in @xmath100 accounts for the contribution of the coriolis coupling .",
    "these formulae are valid in the case of no degenerate harmonic frequencies and no quantum - mechanical resonances ; for details on these specific cases see for instance references .",
    "equation ( [ eq_gn ] ) yields the expressions for the fundamental frequency @xmath105 : @xmath106 overtones : @xmath107 = 2 \\omega_r + 6 \\chi_{rr } + \\sum_{s\\ne r } \\chi_{rs }           = 2 \\nu_r + 2 \\chi_{rr}\\ ] ] combination bands : @xmath108 = \\omega_r + \\omega_s + 2 \\chi_{rr } + 2 \\chi_{ss } + 2 \\chi_{rs }                   + \\frac{1}{2 } \\sum_{k\\ne r , s } ( \\chi_{rk}+\\chi_{sk } )           = \\nu_r + \\nu_s + \\chi_{rs}\\ ] ]",
    "the methodology introduced in the previous sections for the calculation of vibrational frequencies requires tight ( for the harmonic approach ) or very tight ( for pt2 ) geometry optimization criteria@xcite , namely the configuration at minimum should have a residual gradient smaller than @xmath109 or @xmath110  a.u , respectively .",
    "the consequence of an inaccurate knowledge of the structural minimum would indeed propagate on the frequencies , yielding to unreliable results , especially for pt2 calculations .",
    "these tight optimization criteria are easily achieved using most common electronic structure methods like the self consistent field ( scf ) cycles used in dft and post - hartree - fock methods .",
    "unfortunately in qmc calculations the situation is drastically different , because every qmc measure is affected by a stochastic error @xmath111 that is inversely proportional to the square root of the number of sampling @xmath112 , that in turn is proportional to the computational time required for the calculation .",
    "this means that to reduce the error of a factor 10 it would be necessary a computational effort 100 times larger . at opposite , in a scf calculation",
    "this would just cost few additional scf iterations . for this reasons",
    "qmc stochastic errors on energies are typically much larger then what desirable for vibrational frequencies calculations , being of the order or @xmath113  a.u . for the energy evaluation and , @xmath114  a.u . for each force component .",
    "it is important to point out that , thanks to recent developments in qmc obtained by sorella and capriotti @xcite , the calculation of all force components is only four times more computationally demanding then a single energy calculation .    before introducing the formalism of the proposed fitting procedure we discuss some general issues about the localization of a minimum using an error affected pes .",
    "let s suppose we would like to locate the minimum of the pes having information on energies affected by a stochastic error . from a structural point of view , if we want to find the distance @xmath115 from the minimum in a potential that is approximatively @xmath116 using a single point estimation of the energy @xmath117 affected by an error @xmath118 , it yields that @xmath119 is affected by an error @xmath120 .",
    "as example , considering the oh bond stretching force constant @xmath121a.u . , with an error on the energy of @xmath113a.u .",
    ", it is clear that it is not possible to estimate @xmath115 with an accuracy larger than @xmath122a.u .",
    "the situation is even worst for angles , since the bond bending force constants are typically one order of magnitude lower than the stretching constants .",
    "the computational effort to resolve the position difference @xmath115 is therefore proportional to @xmath123 , which clearly becomes prohibitive for a tight ( small @xmath115 ) structural optimization .",
    "a different situation comes out if the information on forces , and not only on energies , is known .",
    "close to the minimum the force is approximatively @xmath124 , therefore @xmath115 can be calculated from a single point evaluation of the force as @xmath125 , and the associated error is @xmath126 .",
    "considering again the previous example of the oh bond stretching , with a typical @xmath114a.u .",
    "we have an accuracy on @xmath115 of the order @xmath127a.u .",
    ", not enough for a tight optimization but much better than the previous energy - based estimation . in this case",
    "the computational effort to resolve a difference @xmath115 using forces is therefore proportional to @xmath128 , much more convenient than the case of energy .",
    "taking into account the previous considerations , in our approach the equilibrium position and the other parameters of the pes near a minimum are calculated using a multidimensional fit of independent data points ( energies or forces ) calculated on a grid around an initial guess of the structural minimum of the molecule .",
    "the chosen parametric function @xmath129 that describes the pes in the proximity of the minimum @xmath23 is the taylor expansion of the potential , see ( [ eq_v(s ) ] ) , cut to the fourth order term .",
    "therefore the parameters to fit are @xmath130 , where the first order coefficients @xmath41 are not included as they have to be zero in the minimum . as a result of the fitting procedure we will have an estimate of the minimum position @xmath131 , the hessian matrix @xmath132 , and the 3rd and 4th order coefficients for the pt2 calculation of the anharmonic corrections .",
    "the fitting function @xmath129 presents a nonlinear dependence on the parameters of the structural minimum @xmath131 . as will appear clear later on , for technical reasons , it would be more convenient to use a linearized form of this function instead of all its parameters . in the following",
    "we therefore introduce a self - consistent approach , which is easier to implement but is completely equivalent .",
    "let s consider a different fitting function @xmath133 that represents the 4th order expansion of the pes around a structure @xmath134 and is only a guess of the exact minimum . as a consequence of this , the linear coefficients @xmath41 in the expansion can not be assumed equal to zero any more , in fact they will be as small as @xmath134 is close to @xmath131 .",
    "therefore we obtain the equation : @xmath135 that is linearly parametrized by @xmath136 and functionally depends on the displacement @xmath137 from the guess configuration .",
    "the fitted coefficients @xmath138 are relative to the guess structure @xmath139 , and can not be used directly for the harmonic and pt2 calculation .",
    "however , once we have fitted the function , it is easy to obtain a new guess @xmath140 of the minimum configuration , just finding the configuration that has the gradient of the fitted potential equal to zero , and then to repeat the fitting process of @xmath141 with respect to this new guess structure @xmath140 , obtaining a new set of coefficients @xmath142 .",
    "since the fitting process is computationally very fast , we can easily iterate this procedure a sufficiently large number of times , converging at the end to the equilibrium configuration @xmath143 and obtaining the fitting parameters @xmath144 that represents the coefficients around the real minimum .    at each iteration",
    "@xmath145 we have to identify the configuration that minimize the gradient , in order to obtain the new guess structure @xmath146 .",
    "the exact solution is not so straightforward , since the gradient of the potential has terms of 2nd and 3rd order in the displacement , however within the described iterative scheme the solution to the leading linear order is enough to ensure the over mentioned convergence . indicating with @xmath147 the matrix formed by the elements of @xmath148 , and with @xmath149 the vector given by @xmath150 , the approximated condition of zero gradient is written as : @xmath151 that yields : @xmath152 being @xmath153 the moore - penrose pseudoinverse of @xmath154 . in our calculations",
    "we have seen that a few ( @xmath155 ) iterations are enough to obtain a tight convergence ( _ i.e. _ residual forces @xmath156a.u . ) . in agreement with ( [ eq_iter_s_g ] ) ,",
    "zero residual forces means that we can confidently take @xmath157 as the minimum structure .    in this work",
    "we report several results , namely the coefficients of the pes , the harmonic frequencies and the anharmonic corrections , that depend on the error affected measurements of energies and forces .",
    "the error propagation on the results have been obtained using a standard resampling method , namely the jackknife variance estimator@xcite . in the following two subsections",
    "we will see how the values of the fitting parameters are inferred using respectively error affected energy or force measures .",
    "for simplicity of notation the subscript @xmath158 will not be reported , as it is clear that the explanation concerns a single step in the iteration , with displacements @xmath27 and fitting values @xmath159 relative to a particular guess structure .",
    "we want to show here how to determine the values of the parameters @xmath159 of the function @xmath160 that fits the error affected energy measures around the minimum .",
    "consider a set of @xmath161 configurations @xmath162 , for @xmath163 .",
    "for each configuration @xmath164 the calculations provide a measure of the potential energy @xmath165 and a corresponding stochastic error@xcite @xmath166 .",
    "the likelihood that a particular @xmath167 fits the qmc energy measures @xmath168 is given by the function@xcite : @xmath169 ^ 2                    \\over 2 { \\sigma_\\alpha}^2 } \\right\\}\\ ] ] where we have assumed that independent estimations of the energy at each configuration are normally distributed .",
    "actually for vmc energy estimations , using the vmc standard sampling technique , this is true only in the limit of infinite sampling , while for finite sampling heavy - tails coming from the local energy singularities are observable as reported by j.r .",
    "the estimation of these leptokurtotic tails has unknown bias and should be evaluated for each individual case , and their magnitude can be reduced increasing the vmc sampling .",
    "we have explicitly verified that in our particular system the sampling we have used is enough to make negligible the deviations from a normal distribution . for the sake of completeness",
    "it should be addressed that neither when reweighting sampling techniques are used the probability density distribution for the estimated energy is normal@xcite .",
    "it is not necessary for our purposes to obtain the complete distribution of the likelihood function in terms of @xmath159 , but it is enough to find the particular value of @xmath170 that maximizes the likelihood .",
    "it is convenient to consider the logarithm of ( [ eq_l(k|e ) ] ) , using the fact that the logarithm is a monotone transformation , and after dropping out some irrelevant terms it yields that @xmath170 is the minimum of the chi - squared function : @xmath171    a remarkable property of the used fitting parameters @xmath172 is that the fitting function depends linearly on them , therefore : @xmath173 where @xmath174 is an index running over all the @xmath175 parameters @xmath159 , and @xmath176 is not functionally dependent on @xmath159 .    by substituting ( [ eq_linv(sk ) ] ) in ( [ eq_l(k|e ) ] ) it can be seen that the stationary condition @xmath177 is equivalent to solve : @xmath178 , where the elements of the @xmath175 dimensional square matrix @xmath179 are : @xmath180 and the @xmath175 dimensional vector @xmath35 is : @xmath181 it follows that the fitting parameters are @xmath182 , where @xmath183 is the moore - penrose pseudo - inverse of matrix @xmath179 .",
    "the methodology used for fitting the pes using force measures is very similar to the one used for the energy , but there is a little complication due to the fact that the forces come from the derivative of the potential with respect to the cartesian coordinates @xmath184 , not the curvilinear coordinates @xmath185 used for the fitting function @xmath160 .",
    "there is a many - to - one mapping between the cartesian coordinates @xmath184 and the corresponding curvilinear coordinates @xmath186 , because whereas given @xmath184 the internal coordinates @xmath187 are univocally defined , the opposite is not true due to the arbitrariness in the choice for @xmath188 of the global orientation of the molecule .",
    "since our qmc code works in cartesian coordinates , we have decided to use @xmath184 also for this fitting .",
    "it follows that the cartesian force fitting function of component @xmath57 , with @xmath189 , is : @xmath190 where @xmath191 is given by the wilson @xmath35 matrix , calculated for the reference position @xmath184 .",
    "the fitting parameters @xmath192 differ from the set @xmath159 in the energy fitting only for the absence of the @xmath42 , that has been dropped out in the derivative , see equation  ( [ eq_fa(rk ) ] ) .",
    "the number of parameters @xmath193 in the fit with the force are therefore @xmath194 , indexed with @xmath195 .",
    "it is clear from ( [ eq_linv(sk ) ] ) and ( [ eq_fa(rk ) ] ) that @xmath196 is a linear function of @xmath193 , therefore we can write : @xmath197 where the terms @xmath198 are all independent from the parameters @xmath159 , and by substituting in ( [ eq_fa(rk ) ] ) , these terms can be easily calculated as : @xmath199 .    for the fitting we consider a set of @xmath161 configurations @xmath200 , for @xmath163 , and for each configuration we have an associated force measure @xmath201 with an associated stochastic error @xmath202 , being @xmath189 the component index .",
    "when the force components come from a qmc calculations , they are usually correlated since they are derived by the same stochastic random walk . in this case",
    "also their @xmath11-dimensional variance - covariance matrix @xmath203 , which has on the @xmath57th diagonal elements the square of @xmath204 , can be calculated .",
    "the likelihood function for the parameters @xmath205 to fit the qmc measures @xmath206 is given by the function : @xmath207            \\left [ { \\cal f}^b(\\textbf{r}^\\alpha,\\tilde{\\bf k } ) - \\tilde f^b_\\alpha   \\right ]         }       \\right\\}\\ ] ] as follows from definition of likelihood , having assumed a normal distribution for the qmc force estimates . in some cases",
    "this assumption could be not exact , depending on the method adopted for the calculation of the forces and the finite vmc sampling@xcite .",
    "in particular for the calculations reported in this paper we have verified that the deviations of the force estimations from a normal distribution are negligible in the present work we did not estimated the full variance - covariance matrix , but only the diagonal part , therefore afterwords we will neglect the correlation between the force components , and we will use only the standard deviations @xmath204 of each force component .    as in the case of the energy fitting , we only need to maximize the likelihood function , that is equivalent to finding the @xmath208 that minimize the @xmath209 function : @xmath210 again the stationary configuration is given by the condition @xmath211 , that is equivalent to solve @xmath212 , where the elements of the @xmath194 dimensional square matrix @xmath213 are : @xmath214 and the @xmath194 dimensional vector @xmath215 is : @xmath216 for @xmath217 .",
    "it follows that @xmath218 , where @xmath219 is the moore - penrose pseudo - inverse of matrix @xmath213 .",
    "the choice of the grid points where energies and forces are evaluated is a crucial aspect for the proposed approach .",
    "clearly the larger is the region of the pes explored by energy or force measurements , the lower is the influence of the stochastic errors on the parameters of the function fitting the pes , and ultimately on the equilibrium structure and the vibrational frequencies . on the other side , the parametric fitting function is an expansion where we are neglecting all the terms beyond the fourth order expansion , therefore the larger the region of the pes expansion , the lower the accuracy of the fitting function and the larger the systematic error .",
    "this implies that from one side we want to consider the larger mesh size in order to reduce the effect of the stochastic errors on the fitted parameters , but on the other side the mesh can not be too large , otherwise we would introduce a systematic error due to an inaccurate fitting function in the range where the qmc measures were obtained . to study this effects for typical values of stochastic errors we studied the behavior of the systematic and stochastic errors using grid of different sizes and shapes .",
    "we considered as model system for these tests the dft pes of the water molecule where stochastic errors were introduced artificially on forces and energies . in this way we can directly compare the parameters obtained with the fitting procedure with the exact parameters of the pes to directly evaluate the effect of different grids . in the specific case of the water molecule , the grid points are chosen as follows : @xmath220 where the center of the grid , given by @xmath221 and @xmath222 , is our initial guess of the equilibrium structure .",
    "the integers @xmath223 are so that @xmath224 ; @xmath225 ; and if @xmath226 then @xmath227 , otherwise @xmath228 . therefore",
    "each mesh is specified by the parameters @xmath229 .",
    "the set of meshes considered in this paper are reported in table  [ table : grid ] .    .",
    "mesh types used in this paper , that are univocally defined by the values of @xmath229 . for a description of the construction method see section  [ section_grid ] . [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]",
    "in the present work we proposed a theoretical framework for the calculation of equilibrium structures and vibrational properties through a potential energy surface affected by stochastic noise .",
    "the proposed procedure has as natural application the qmc electronic structure calculations , although it is not limited to these methods .",
    "we demonstrated that applying a multidimensional fitting procedure to the qmc energies or forces around the minimum , we can obtain accurate results on the structural parameters at the minimum and on the vibrational frequencies , despite the presence of the intrinsic stochastic error of the method .",
    "the theoretical developments in this work , as well as the numerical results , are aimed to minimize the computational time and mitigating the impact of the stochastic errors on the accuracy of the computed harmonic frequencies .",
    "as qmc example , we applied our technique to the calculation of the equilibrium structure , harmonic frequencies and anharmonic constants of the water molecule .",
    "the obtained results demonstrated how using information of forces instead of energies it is possible to reduce the statistical error on the vibrational frequencies of at least one order of magnitude , leading to an average error lower than 0.07% for the geometrical parameters and 0.7% for the harmonic frequencies .",
    "these results open the possibility to apply quantum monte carlo methods for the evaluation of vibrational spectroscopic parameters of molecules , although the scaling of the method with the number of atoms in the system limits the approach to relatively small molecules .",
    "we thank sandro sorella and matteo barborini for the support provided on the turborvb qmc code @xcite .",
    "computational resources were provided by cineca ( award n. hp10aow1fu ) and by the caliban - hpc center of universit dellaquila .",
    "the authors also acknowledge funding provided by the european research council project n. 240624 within the vii framework program of the european union ."
  ],
  "abstract_text": [
    "<S> the precise theoretical determination of the geometrical parameters of molecules at the minima of their potential energy surface and of the corresponding vibrational properties are of fundamental importance for the interpretation of vibrational spectroscopy experiments . </S>",
    "<S> quantum monte carlo techniques are correlated electronic structure methods promising for large molecules , which are intrinsically affected by stochastic errors on both energy and force calculations , making the mentioned calculations more challenging with respect to other more traditional quantum chemistry tools . to circumvent this drawback in the present work we formulate the general problem of evaluating the molecular equilibrium structures , the harmonic frequencies and the anharmonic coefficients of an error affected potential energy surface . </S>",
    "<S> the proposed approach , based on a multidimensional fitting procedure , is illustrated together with a critical evaluation of systematic and statistical errors . </S>",
    "<S> we observe that the use of forces instead of energies in the fitting procedure reduces the the statistical uncertainty of the vibrational parameters by one order of magnitude . </S>",
    "<S> preliminary results based on variational monte carlo calculations on the water molecule demonstrate the possibility to evaluate geometrical parameters , harmonic and anharmonic coefficients at this level of theory with an affordable computational cost and a small stochastic uncertainty ( @xmath0 for geometries and @xmath1 for vibrational properties ) . </S>"
  ]
}