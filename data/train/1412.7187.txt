{
  "article_text": [
    "in this supplemental material , we clarify and expand some of the statements made in the main text . specifically",
    ", we include a detailed discussion of the length scales in population dynamics and nutrient diffusion , illustrations of our arguments for the renormalization of fitness and the effects of fitness nonlinearities , description of the transition to mutualism on a global scale , discussion of alternative models of public good production and consumption , comparison of mutualism to balancing frequency - dependent selection , and the details of our computer simulations .",
    "+ * four length scales : @xmath89 , @xmath90 , @xmath91 , and  @xmath92 * +    in two - way cross feeding , species fractions and nutrient concentrations change on four key length scales that we describe below .",
    "these are the system size  @xmath93 , the length on which species fractions remain constant  @xmath52 , the length scales over which species fractions change  @xmath53 , and the length scale on which the concentration of public goods change  @xmath49 .",
    "+ the first length scale is the system size  @xmath93 , which is the number of islands in our simulations or the circumference of a microbial colony in the experiments .",
    "the manuscript assumes that this length scale is much larger than any other length scale we consider .",
    "when that is not the case , population dynamics can change either because species can easily migrate across the whole population making it effectively well - mixed rather than spatially structured or nutrients can easily diffuse across the whole population making nutrient concentrations homogeneous rather than constrained by the diffusive transport .",
    "the latter situation is carefully discussed later in this supplemental material .",
    "+ the second length scale is the size of the spatial regions occupied exclusively by one of the species .",
    "we term these regions domains and denote the corresponding length scale as the size of the domains  @xmath52 . in fig .",
    "[ cartoon]a , domains are represented by patches of the same color and , in fig .  [ cartoon]b , as regions where  @xmath20 equals either  @xmath42 or  @xmath7 .",
    "note that the different domains have different sizes , i.e. the size of the domains is stochastic .",
    "therefore ,  @xmath52 represents the average size of the domains .",
    "also , we define  @xmath52 only when the domain size distribution has reached equilibrium .",
    "when no equilibrium exists , e.g. , when complete demixing occurs ,  @xmath52 is time dependent , and its equilibrium value can not be defined .",
    "+ the third length scale is the boundary width @xmath53 , which describes the size of the regions that separate the domains .",
    "this length scale is distinct from  @xmath52 because domains are much larger than the transitions between them .",
    "moreover , the boundaries between the species are not infinitely sharp , but have a certain width  ( fig .",
    "[ cartoon ] ) .",
    "finite boundary width does not require any selection or mutualism and is observed even in neutral models .",
    "the two processes that determine the boundary width @xmath53 are migration and genetic drift .",
    "migration makes the boundaries wider since more migrant exchange between the domains ( when migration is zero the boundaries are infinitely sharp ) .",
    "genetic drift is also important . without drift ,",
    "population dynamics are purely diffusive , which leads to a spatially homogeneous state without domains . very loosely speaking ,",
    "the survival time of an individual of species b in the domain of species a is  @xmath2 because of genetic drift and the maximal distance that that individual can travel in that time is  @xmath3  times  @xmath2 , i.e.  @xmath94 .",
    "this argument is not rigorous , and the actual dynamics is much more intricate as explained in ref .",
    "+ the fourth length scale  @xmath49 is the distance that public goods diffuse before being absorbed . since the life time of public goods is  @xmath51 , they typically spread over a distance  @xmath95 .",
    "this nutrient length scale can also be immediately obtained from eq .",
    "( 4 ) in the main text , where it appears in the exponent .",
    "another interpretation of  @xmath49 is the distance over which changes in the species fractions cause changes in the concentrations of the public goods . for small diffusivities , nutrients are absorbed where they are produced , and nutrient concentrations closely follow species fractions . for large diffusivities , the concentrations of public goods",
    "change more gradually . as a result , public goods produced by species a diffuse well into the domain occupied by species b ( fig .",
    "[ cartoon]c ) . +",
    "* expansion of eq .",
    "( 5 ) to the first order * + one way to see that nutrient diffusion inhibits mutualism in to consider the expansion of eq .",
    "( 5 ) for small  @xmath23 .",
    "the first order of the expansion contributes a term  @xmath96 in addition to the term that we obtained by setting  @xmath71 .",
    "biologically , this new term implies that species  a is at a disadvantage in the locations where its density has a local minima because species  b receives extra public goods from the nearby regions with larger concentration of species  a. mathematically , this term has a similar form to the second - derivative term describing species migration in  eq .",
    "( 1 ) , but contributes with the opposite sign . in the language of field theory , public good diffusion renormalizes species migration to a lower value .",
    "since the strength of mutualism  @xmath36 increases with the migration rate  @xmath3 , we expect that public good diffusion should favor species demixing .",
    "+ * public goods diffusion renormalizes the selection for coexistence * +    .",
    "selection occurs only in the region of size  @xmath53 , where the differences in nutrient concentrations are small .",
    "this leads to a reduced difference in species fitness  @xmath97 compared to the maximally possible fitness difference  @xmath75 .",
    "[ fig : renormalization ] ]      our arguments for the dynamics near the boundary between the two species are illustrated in fig .",
    "[ fig : renormalization ] for the reduction in the selection for coexistence due to public good diffusion and in fig .",
    "[ fig : nonlinear ] for the effects of fitness nonlinearities . note that reduced selection due to public good diffusion might also explain the residual species demixing observed even for obligate mutualists ; see figure 2c in ref .",
    "[ 3 ] of the main text . +",
    "* mean fitness is an alternative order parameter * +     decreases with nutrient diffusivity  @xmath23 .",
    "the data is the same as in fig .  1 of the main text .",
    "as we discuss in the main text , @xmath98 for @xmath99 , and @xmath100 for @xmath101 .",
    "( b )  the fitness gain due to mutualism @xmath102 is shown . here",
    ", @xmath41 is the arithmetic mean of the fitnesses of all organisms in the population .",
    "the fitness gain equals  @xmath7 when species take maximally possible advantage of the mutualism and  @xmath42 when mutualism is lost .",
    "both local heterozygosity and fitness gain show similar trends for nutrient diffusivities that are not too large .",
    "in particular , mutualism is lost above the critical diffusivity . however , when  @xmath23 becomes so large that the nutrient length scale  @xmath49 becomes comparable to the system size  @xmath93 , mutualism recovers even though  @xmath46 remains zero .",
    "this mutualism occurs on a global rather than on a local scale . here , the simulation parameters are the same as in fig",
    ".  1 of the main text.[fig : mean_fitness ] ]    local heterozygosity  @xmath46 has been previously used as an order parameter describing the mutualistic phase  @xcite .",
    "the connection between  @xmath46 and mutualism is easy to understand in the standard game theory because only species present in the same location can interact .",
    "indeed , there are no species interactions in a demixed state , and , therefore , populations with  @xmath47 can not support mutualism .",
    "this connection between  @xmath46 and mutualism is less clear when public goods can diffuse because , even in the demixed state , species can benefit from each other if they can exchange public goods through diffusion .",
    "since both the domain size  @xmath52 and the nutrient exchange length scale  @xmath53 increase with  @xmath23 , it is important to demonstrate that the loss of local heterozygosity indeed implies the loss of mutualism .",
    "+ the degree of mutualism is directly linked to the mean fitness of the population  @xmath41 .",
    "when mutualism is successful , the mean fitness will be larger than one  ( about  @xmath103 ) , but , when the mutualism fails due to demixing ,  @xmath41 will be close to one .",
    "unlike  @xmath46 , which quantifies species coexistence , mean fitness quantifies the affect of mutualism on cell growth .",
    "thus  @xmath41 is a more robust measure of mutualism than  @xmath46 because it is directly applicable for all values of  @xmath23 . for convenience , we normalize  @xmath41 by its maximal possible value and define the fitness gain due to mutualism as @xmath40 , which varies between 0 and 1 .",
    "+ figure  [ fig : mean_fitness ] shows how both local heterozygosity and the fitness gain due to mutualism change with nutrient diffusivity  @xmath23 for the same parameters as fig .  1 in the main text .",
    "for  @xmath23 that is not too large , both measures of mutualism show similar trends .",
    "in particular , one can clearly see that both  @xmath46 and the fitness gain vanish at  @xmath24 .",
    "thus , the phase transition described in the main text is the loss of both mutualism and coexistence . the behavior for very large  @xmath23 is discussed in the next section .",
    "+ * transition to global mutualism * + throughout the main text we assume that the system size ( e.g. the number of islands in our simulations ) is much greater than the typical distance that the nutrients diffuse before being consumed .",
    "this separation of length scales is indeed observed in microbial experiments .",
    "typically , the circumference of a microbial colony is between  5 mm and 10 cm , while the nutrient diffusion length was estimated to be between 30@xmath104 and  700@xmath104  @xcite .",
    "the large system size limit is also necessary to properly study phase transitions in our simulations .",
    "+ the behavior in the other limit , when  @xmath105 is also interesting . in this limit ,",
    "nutrient concentrations are spatially homogeneous and nutrient exchange occurs on a global rather than on a local scale .",
    "although such fast nutrient transport can not typically occur through diffusion , fluid flow driven by convection , mixing , or turbulence can in principle create a regime of global nutrient exchange .",
    "dynamics in this regime are very different from what we describe in the main text because the strength of frequency - dependent selection depends on the mean fractions of the species in the entire population .",
    "thus , there is a strong selection for species coexistence on a global scale even though they demix locally .",
    "+ simulation results shown in fig .",
    "[ fig : mean_fitness ] support this intuition and illustrate the transition from local to global mutualism . for  @xmath23 that is not too large ,  @xmath106 is satisfied .",
    "therefore , both  @xmath46 and the fitness gain due to mutualism decrease with  @xmath23 until they vanish at  @xmath24 .",
    "the local heterozygosity remains zero as  @xmath23 increases by orders of magnitude  ( beyond what is physically possible ) .",
    "the fitness gain , however , remains zero only while @xmath106 .",
    "when the diffusion is fast enough to make nutrient concentrations homogeneous across the population , the regime of global mutualism starts , and the fitness gain becomes nonzero .",
    "+ in the regime of global mutualism one finds that species demix locally until there are just two domains left : one of species a and the other of species b. the relative size of these domains fluctuates around  @xmath107 , i.e. the mutualism is preserved even though , the coexistence is lost locally . because nutrients are shared globally , population dynamics in this regime are similar to those of a well - mixed population of size  @xmath108 .",
    "the only difference is that the competition between the species is restricted to the boundary between the two domains .",
    "this spatial localization of competition results in quantitative but not qualitative differences in the population dynamics between spatial and well - mixed populations .",
    "+ when  @xmath109 and  @xmath48 , local demixing will also eventually leave only two domains : one of species a and one of species b just like in the regime of global mutualism . unlike that regime",
    "however , the frequency - dependent selection will be strongly suppressed .",
    "indeed , the concentration of nutrients at the boundary where the competition occurs will be the same regardless of the global fraction of species a and b as long as the domains occupied by the species are larger than  @xmath49 .",
    "only when the domain of one of the species shrinks below  @xmath49 , the balancing frequency - dependent selection becomes nonzero due to the lack of the public goods produced by the shrinking species .",
    "to put this another way , there is no pressure for the boundary between the species to separate them in equally sized domains because the species at the boundaries get their public goods from a region of size  @xmath49 , not  @xmath93 , and , within the distance of  @xmath49 from the boundary , the species are about equally abundant . as a result , mutualism in this regime",
    "is not global and is not stable .",
    "+ the effect of the system size  @xmath93 on the transition to global mutualism is illustrated in fig .",
    "[ system_size ] . for all system sizes ,",
    "we observe the loss of mutualism at  @xmath72 followed by a region of no mutualism at higher diffusivities .",
    "however , when  @xmath50 becomes comparable to the system size , there is a transition to global mutualism . as we expect",
    ", this second transition occurs at larger  @xmath23 for larger system sizes . in consequence ,",
    "the region of no mutualism increases with the system size , and becomes infinitely large as  @xmath110 indicating that the loss of mutualism at  @xmath24 is a true phase transition .",
    "+    , the loss of mutualism due to local demixing occurs at  @xmath24 for all four system sizes .",
    "the fitness gain remains zero as diffusivity increases until  @xmath50 becomes comparable to  @xmath93 , and global mutualism sets in .",
    "as expected , the diffusivity , at which the transition to global mutualism occurs , increases with the system size .",
    "note that the value of fitness gain at  @xmath111 approaches  @xmath7 as  @xmath93 increases because genetic drift is suppressed in large populations .",
    "here , @xmath112 , @xmath113 , @xmath114 , and  @xmath115 .",
    "[ system_size ] ]    note that the transition from local to global mutualism that we discussed here is quite different from the often observed effect that spatial structure promotes coexistence .",
    "for example , ref .",
    "@xcite found that bacteria playing an equivalent of rock - paper - scissors game can not coexist in a well - mixed population , but maintained global coexistence in a spatially structured population even though local diversity was lost .",
    "although fast nutrient transport also leads to global coexistence at the expense of local diversity , the mechanism of coexistence is very different .",
    "indeed , global nutrient exchange makes a spatially structured population of two - way cross - feeders behave essentially the same as a well - mixed population . + * alternative models of public goods dynamics * + in the main text , we used the following model of public goods production , consumption , and decay      this is perhaps the simplest model that assumes that public good  @xmath0 is constantly produced by species  a at a constant rate and either both species consume the public good at the same rate or nutrient decay is primarily caused by external factors other than the consumption by the species ; for example , due to diffusion outside the layer of actively growing cells or degradation .",
    "deviations from these assumptions will make  @xmath18 and  @xmath19 depend on  @xmath14 ,  @xmath15 , and  @xmath117 .",
    "additional dependence on  @xmath20 is not necessary since  @xmath118 .",
    "next , we consider three different models that incorporate such dependencies and show that our results are robust to these changes .",
    "+ in this model , public good production saturates when the producing species is very abundant . biologically , model  1 reflects cellular regulation that allows the production of public goods only when they are needed .",
    "note that the last term in both models  2 and  3 introduces a nonlinearity because it is a product of species fractions and public good concentrations .",
    "+ in simulations , we observe the loss of coexistence with increasing public goods diffusivity for all of these models ; see fig .  [ models ] . except for the fact that nonlinearities affect competition between species with different public goods diffusivities",
    ", we did not find any qualitative difference in the behavior of these models and the model studied in the main text .",
    "+    * effects of asymmetries in public goods dynamics * + we now turn to the effects of species asymmetries on the population dynamics",
    ". when  @xmath71 and the model reduces to that of local frequency - dependent selection , the asymmetries in nutrient production and decay rates result in the selection term of the form  @xmath122 , where the preferred fraction  @xmath123 no longer equals  @xmath45 .",
    "population dynamics in this limit have been previously analyzed in ref .",
    "@xcite with the main conclusion that species asymmetry substantially weakens mutualism and species  a is favored if  @xmath124 while species",
    "b is favored otherwise .",
    "we find that  @xmath39 does not alter these results . + * frequency - dependent selection in population genetics * + in the main text , we focused on mutualism as the force maintaining coexistence between different species .",
    "coexistence among genotypes has been extensively studied in population genetics , and , in this section , we draw some parallels to that field .",
    "most of the population genetics literature focuses on the maintenance of polymorphism due to site - specific or local adaptation . in the context of our model",
    ", this would correspond to different islands always favoring either species a or species b. this situation however is quite different from mutualism , and we do not think that a simple analogy can be made between these two alternative mechanisms to maintain polymorphisms , i.e. local adaptation vs. local frequency - dependent selection",
    ". indeed , local adaptation fails at high migration rates , while the stability of coexistence always increases with migration for local frequency - dependent selection .",
    "+ without public good diffusion , mutualism between two species is however analogous to frequency - dependent selection in population genetics because these two phenomena are described by the same mathematical model .",
    "an example of frequency - dependent selection especially relevant to our discussion of mutualism is the @xmath5-allele in house mice .",
    "this allele is under balancing selection , but is observed at frequencies much smaller than predicted by a deterministic model .",
    "lewontin  _ et al .",
    "_ first proposed that the reduced prevalence could be due to stochastic effects  @xcite .",
    "this idea was further refined to account for migration in ref .",
    "@xcite , and a very definitive treatment was presented by durand  _ et al .",
    "_  @xcite .",
    "this last paper found that there is a critical migration below which the @xmath5-haplotype becomes extinct ( for much higher migration the deterministic approximation works well ) .",
    "this result parallels that of ref .",
    "@xcite because  @xmath125 and the phase transition leading to the loss of coexistence can occur by reducing selection , population size , or migration .",
    "the analysis by durand  _ et al .",
    "_ was however done for an island model , not a stepping - stone model . +",
    "* details of simulations * + simulations were implemented based on the wright - fisher model of population genetics . concretely , we first computed the expected species fractions in the next generation and then obtained the actual number of species in each deme via binomial sampling with  @xmath2 trials .",
    "we considered spatial structure of a quasi - one - dimensional population because the growth of cells in a microbial colony is confined to a very narrow region  ( a few cell widths ) at the colony edge  @xcite .",
    "+ in fig .  3 of the main text",
    ", we obtain  @xmath52 as follows .",
    "first , we compute  @xmath126 , a two point correlation function that estimates the probability of sampling two different species a distance @xmath6 apart :      when population reaches a steady state ,  @xmath126 becomes independent of time , and we denote this equilibrium heterozygosity as  @xmath128 .",
    "the domain length is then obtained by fitting the exponential decay of  @xmath128 at large  @xmath6 , i.e.  @xmath129 , which is expected for all  @xmath23 other than  @xmath72  @xcite . + data in all figures is averaged over  @xmath130-@xmath131 replicates . in figs .  1 , 3 , and  4 of the main text , @xmath132 , @xmath133 , @xmath134 , @xmath135 , and @xmath136 . in fig .  2 of the main text ,  @xmath137 while other parameters are given in the figure panels .",
    "in figs .  1 , 2 , and  3 of the main text , the habitat consisted of  @xmath138 islands and was observed after  @xmath139 generations starting from a well - mixed state . in fig .  4 of the main text ,",
    "the habitat consisted of  @xmath140 islands and was observed after  @xmath141 generations starting from a well - mixed state ."
  ],
  "abstract_text": [
    "<S> standard game theory can not describe microbial interactions mediated by diffusible molecules . </S>",
    "<S> nevertheless , we show that one can still model microbial dynamics using game theory with parameters renormalized by diffusion . </S>",
    "<S> contrary to expectations , greater sharing of metabolites reduces the strength of cooperation and leads to species extinction via a nonequilibrium phase transition . </S>",
    "<S> we report analytic results for the critical diffusivity and the length scale of species intermixing . </S>",
    "<S> species producing slower public good is favored by selection when fitness saturates with nutrient concentration .    </S>",
    "<S> complex microbial communities are essential for the environment and human health . </S>",
    "<S> microbial functions range from the production of biofuels and the release of powerful greenhouse gasses to the production of cheese and the digestion of food inside our guts . </S>",
    "<S> most of these functions are orchestrated by complex microbial consortia rather than single species  @xcite . to create and control such multispecies ecosystems , we need to understand the mechanisms that govern microbial coexistence and cooperation .    </S>",
    "<S> heterotrophic cooperation is a common and perhaps the simplest element of complex microbial communities  @xcite . in this two - way cross feeding </S>",
    "<S> , each species produces an amino acid or other metabolite necessary for the other species . </S>",
    "<S> heterotrophic cooperation has been previously described by the evolutionary game theory  @xcite , which assumes that microbes interact only with their closest neighbors . however , unlike human societies or bee colonies , microbial communities rarely rely on direct contact . </S>",
    "<S> instead , microbes primarily communicate though diffusible molecules , which rapidly spread in the environment  @xcite . because of this diffusive sharing within or between species , such molecules </S>",
    "<S> are often termed public goods . </S>",
    "<S> broad understanding of how public good diffusion affects heterotrophic cooperation is still lacking .    in this letter </S>",
    "<S> , we explicitly account for the production , consumption , and diffusion of public goods in a model of heterotrophic cooperation . </S>",
    "<S> we find that unequal diffusivities of the public goods can significantly favor one of the species and even destroy their cooperation . </S>",
    "<S> more importantly , the diffusion of public goods has the opposite effect compared to species migration . </S>",
    "<S> higher migration improves mutualism and stabilizes species coexistence . </S>",
    "<S> in contrast , cooperation is lost above a critical diffusivity of public goods , for which we obtain an analytical expression . </S>",
    "<S> we also describe the effect of public good diffusion on the spatial distribution of species , which is often used to quantify microbial experiments  @xcite . </S>",
    "<S> our analytical approach is based on computing how public good diffusion renormalizes the strength of selection and thus should be applicable to other models .    motivated by the experiments on cross - feeding mutualists  @xcite , we consider two species ( or strains )  a and  b producing public goods of type  @xmath0 and  @xmath1 , respectively , and consuming public goods of the opposite type . </S>",
    "<S> these species live in a one - dimensional habitat , which corresponds to the quasi - one - dimensional edge of microbial colonies , where cells actively divide  @xcite . in simulations , </S>",
    "<S> the habitat is an array of islands populated by  @xmath2 cells each . </S>",
    "<S> this finite carrying capacity sets the magnitude of demographic fluctuations typically termed genetic drift  @xcite . </S>",
    "<S> nearest - neighbor islands exchange migrants at a rate  @xmath3 , which specifies the degree of movement within a microbial colony . in the continuum limit </S>",
    "<S> , the evolutionary dynamics of the species is described by    @xmath4    where  @xmath5 and  @xmath6 are time and position measured in such units that generation time and island spacing are set to  @xmath7 ; @xmath8 and  @xmath9 are the relative abundances of species  a and  b ;  @xmath10 and  @xmath11 are the fitnesses of species  a and  b , respectively , that depend on the local concentration of the public goods ; and  @xmath12 is a delta - correlated gaussian white noise . </S>",
    "<S> equation  ( [ eq : ssm ] ) represents the classical stepping - stone model of population genetics  @xcite and accurately describes population dynamics in microbial colonies  @xcite .    </S>",
    "<S> standard game - theory treatments of microbes assume that the fitnesses  @xmath10 and  @xmath11 depend on the local abundances of the species rather than the public goods concentrations  @xcite . here </S>",
    "<S> , we relax this assumption and consider    @xmath13    where  @xmath14 and  @xmath15 are the concentrations of the public goods measured in the units of fitness .    in the simplest model , the dynamics of the public goods concentrations </S>",
    "<S> are given by the following reaction - diffusion equation :    @xmath16    and an analogous equation for  @xmath15 . here , for the public good of type  a </S>",
    "<S> , @xmath17 is the diffusivity ,  @xmath18 is the production rate , and  @xmath19 is the rate of loss comprised of consumption by both species , spontaneous decay or degradation , and transport outside the region of microbial growth  @xcite . </S>",
    "<S> both  @xmath18 and  @xmath19 can depend on  @xmath14 ,  @xmath15 and  @xmath20 in a more realistic model , but our simulations suggest that all important aspects of population dynamics are already captured by eq .  </S>",
    "<S> ( [ eq : pg ] )  @xcite . </S>",
    "<S> since public good dynamics occurs much faster than cell migration and growth , public good concentrations equilibrate rapidly , i.e.  @xmath21 . </S>",
    "<S> this results in    @xmath22    and similarly for  @xmath15 . equations  ( [ eq : ssm])([eq : pg_sol ] ) </S>",
    "<S> have been previously used to simulate cooperatively growing microbial communities  @xcite , but analytical results and broad understanding of the effect of public good diffusion on population dynamics is still lacking .    . </S>",
    "<S> fitness gain due to mutualism also decreases with  @xmath23 and vanishes at  @xmath24 until the diffusion becomes so large that nutrients can spread through the entire population and mutualism emerges on a global scale . </S>",
    "<S> the two insets show how the distribution of species labeled by different colors varies with position  ( x - axis ) and time  ( y - axis ) for small diffusivities  ( left ) and just below the critical diffusivity  ( right ) . </S>",
    "<S> note that the loss of mutualism observed here is triggered by changing  @xmath23 rather than the strength of selection or exogenous public goods concentrations as was done previously  @xcite . </S>",
    "<S> [ fig1 ] ]    . </S>",
    "<S> [ fig2 ] ]    to understand the overall effect of public good diffusion on microbial mutualism , it is sufficient to consider a simple symmetric case :  @xmath25 , @xmath26 , @xmath27 , and @xmath28 , which we proceed to analyze by combining eqs .  </S>",
    "<S> ( [ eq : ssm ] ) , ( [ eq : fitness ] ) , and  ( [ eq : pg_sol ] ) :    @xmath29 e^{-\\sqrt{\\frac{d}{d}}|x ' - x|}dx ' \\\\ & + \\frac{m}{2}\\frac{\\partial^{2 } f_{\\rm{a}}}{\\partial x^{2 } } + \\sqrt{\\frac{f_{\\rm{a}}(1-f_{\\rm{a}})}{n } } \\eta ( t , x ) . </S>",
    "<S> \\label{eq : fmodel } \\end{aligned}\\ ] ]    for small  @xmath23 , the integrand in the first term of eq .  </S>",
    "<S> ( [ eq : fmodel ] ) is peaked around  @xmath30 , so one can expand  @xmath31 in taylor series around  @xmath6 ; see  @xcite . to the zeroth order , </S>",
    "<S> the selection term becomes  @xmath32 , where  @xmath33 is the strength of local frequency - dependent selection . </S>",
    "<S> thus , in the limit  @xmath34 , our model of mutualism reduces to the standard game theory formulation with frequency - dependent selection  @xcite . </S>",
    "<S> population dynamics in this limit are controlled by a dimensionless quantity  @xmath35 , which we refer to as the strength of the mutualism . when  @xmath36 exceeds  @xmath37 , a critical value of order  @xmath7 , the mutualism is stable , and the two species coexist  @xcite . </S>",
    "<S> in contrast , when  @xmath38 , selection for coexistence is not strong enough to overcome local species extinctions due to genetic drift , and the population becomes partitioned into domains exclusively occupied by one of the two species . with the loss of the coexistence , the mutualism also ceases because spatially segregated species can not cooperate when public goods do not diffuse .    since public good diffusion facilitates nutrient exchange between the segregated domains , one might naively expect that increasing  @xmath23 would rescue mutualism . </S>",
    "<S> we , however , find that higher nutrient diffusivities promote species demixing , and the separation between the domains grows with  @xmath23 much more rapidly than the distance over which public goods are exchanged . as a result , increasing the diffusion of public goods destroys mutualism .    because mutualism and coexistence are not equivalent when  @xmath39 , we considered them separately . </S>",
    "<S> the benefit that species derive from the mutualism was quantified with the fitness gain  @xmath40 , where  @xmath41 is the mean fitness of the population . </S>",
    "<S> when mutualism is lost , the mean fitness equals  @xmath7 , and the fitness gain is  @xmath42 , while successful mutualism results in  @xmath43 and the fitness gain of  @xmath7 . </S>",
    "<S> species intermixing was quantified by the average local heterozygosity  @xmath44 , which equals  @xmath45 for strongly intermixed species and  @xmath42 for species that are spatially segregated .    in simulations , we found that both fitness gain and local heterozygosity  @xmath46 decrease with  @xmath23 , and mutualism is lost for diffusivities above a certain value  @xmath24 ( fig .  </S>",
    "<S> [ fig1 ] ) . while  @xmath47 for all  @xmath48 , the fitness gain becomes nonzero for extremely large nutrient diffusivities , when the nutrient diffusion length scale becomes comparable to the system size . in this regime , </S>",
    "<S> nutrients concentrations are homogeneous across the entire population and species cooperate on a global rather than local scale . </S>",
    "<S> we discuss the transition to global mutualism further in the supplemental material  @xcite and show that global mutualism can not occur in microbial populations because it requires nutrient diffusivities that are unrealistically high .    </S>",
    "<S> note that the loss of mutualism in our model is due to genetic drift rather than the proliferation of nonproducers  ( cheaters ) . in intraspecific cooperation </S>",
    "<S> , public good diffusion allows cheaters to consume nutrients that they do not produce and thus inhibits cooperation by a mechanism distinct from the one described here  @xcite .    to show how the interplay between population demixing and nutrient exchange leads to the loss of the mutualism </S>",
    "<S> , we introduce three length scales that control population dynamics . </S>",
    "<S> the first length scale appears in eq .  </S>",
    "<S> ( [ eq : pg_sol ] ) and relates the spatial variation in species abundances to the distribution of nutrients . </S>",
    "<S> this nutrient length scale ,  @xmath49 , is the typical distance that nutrients diffuse before being consumed , and is given by @xmath50 since  @xmath51 is the typical nutrient lifetime . </S>",
    "<S> the second length scale describes species segregation . </S>",
    "<S> we define it as the size of the domains occupied by a single species  ( insets in fig .  </S>",
    "<S> [ fig1 ] ) and denote it as  @xmath52 . </S>",
    "<S> below , we show that  @xmath52 increases with  @xmath23 much more rapidly than @xmath49 . </S>",
    "<S> the final length scale describes the size of the regions where both species are present and , therefore , natural selection can act . </S>",
    "<S> these regions occur at the boundaries between the domains , so we refer to this length scale as the boundary width ,  @xmath53 . </S>",
    "<S> domain boundaries have finite size because the constant exchange of migrants across the boundary is balanced by their extinction due to genetic drift ; @xmath54 from ref .  </S>",
    "<S> @xcite . </S>",
    "<S> the intuition behind these results and the relationships among the length scales are discussed in the supplemental material  @xcite .    </S>",
    "<S> we will now assume that the population is sufficiently close to the demixing phase transition so that the distance between domain boundaries  @xmath52 is much greater than  @xmath49 , as it is commonly observed experimentally  @xcite . </S>",
    "<S> when  @xmath55 , one can solve eq .  </S>",
    "<S> ( [ eq : fmodel ] ) near the domain boundary located at  @xmath56 by assuming that  @xmath57 is a step function , i.e.  @xmath58 for  @xmath59 and  @xmath60 for  @xmath61 . </S>",
    "<S> the solution yields    @xmath62    for  @xmath63 , where  @xmath64 is the sign function .    since the selection term in eq .  </S>",
    "<S> ( [ eq : fmodel ] ) vanishes when  @xmath65 , only the fitness differences at the domain boundary  ( when  @xmath66 ) affect population dynamics . near the boundary  @xmath67 . </S>",
    "<S> hence , by eliminating  @xmath6 from eq .  </S>",
    "<S> ( [ eq : pg_boundary ] ) , we can again recast the selection term in the form  @xmath68 , where the effective strength of selection  @xmath69 is reduced by a factor of  @xmath70 compared to the model with  @xmath71 .    . </S>",
    "<S> the theory and simulations agree close to the phase transition when domains are large . for small  @xmath23 </S>",
    "<S> ,  the size of the domains is determined by the dynamics studied in ref .  </S>",
    "<S> @xcite . </S>",
    "<S> [ fig3 ] ]    our finding that higher diffusivities of the public goods reduce the effective strength of selection explains the decrease of  @xmath46 with  @xmath23 in fig .  </S>",
    "<S> [ fig1 ] and provides a way to estimate the critical diffusivity  @xmath24 above which mutualism is lost . indeed , when  @xmath72 , we expect that the strength of mutualism  @xmath36 approaches its critical value as well . </S>",
    "<S> thus ,  @xmath73 , and  @xmath74 , where  @xmath33 is the strength of selection in the model without public good diffusion . </S>",
    "<S> surprisingly , we find that population density and migration have a much stronger effect on the critical nutrient diffusivity than natural selection . </S>",
    "<S> our simulation results are in excellent agreement with these predictions ( fig .  </S>",
    "<S> [ fig2 ] ) . </S>",
    "<S> since the model with  @xmath39 is equivalent to that with  @xmath71 provided the strength of selection  @xmath75 is renormalized , many of the results from the evolutionary game theory can be generalized for microbial communities with diffusible public goods . </S>",
    "<S> the size of the domains formed by the species  @xmath52 is of particular interest because it is used in the experiments to quantify the degree to which the two species benefit from their mutualistic interactions . </S>",
    "<S> previous studies suggested that  @xmath76  @xcite or  @xmath77  @xcite ; however , we find that such scalings are unlikely because  @xmath52 becomes large only close to the underlying phase transition , where  @xmath78 for  @xmath79 ; see fig .  </S>",
    "<S> [ fig3 ] . </S>",
    "<S> the exponent  @xmath80 is that of a correlation length and is determined by the universality class of the phase transition . in our model , any species asymmetry results in dp universality class and the extinction of one of the two species when </S>",
    "<S> mutualism is lost . </S>",
    "<S> if all model parameters are the same for the two species , the dynamics is in dp2 universality class and the loss of mutualism results in spatial demixing  @xcite . </S>",
    "<S> the nature of this phase transition does not depend on whether one varies the diffusivities of the public goods , their external concentrations  @xcite , or any other model parameters .    </S>",
    "<S> , the model is linear and the differences in the nutrient diffusivities have no affect on the relative species abundances  ( magenta dots ) . for lower  @xmath81 , fitness nonlinearity increases , and the species with the lower diffusivity dominates  ( green triangles ) . </S>",
    "<S> this trend continues as  @xmath81 is decreased further , but , in addition , species coexistence and mutualism are lost when public goods diffusivities become too unequal  ( blue squares ) . </S>",
    "<S> [ fig4 ] ]    finally , we investigated whether species can take advantage of each other by changing the diffusion constant of their public goods . upon repeating the steps leading to eq .  </S>",
    "<S> ( [ eq : fmodel ] ) but for  @xmath82 one still finds that the resulting equation is invariant under the exchange of species labels , i.e.  @xmath83 . hence , </S>",
    "<S> if only the public good diffusivities are different between the species , then none of the species is expected to dominate the other . </S>",
    "<S> this conclusion however holds only when the fitnesses are linear functions of the nutrient concentrations , i.e.  @xmath84 . for lower values of  @xmath81 </S>",
    "<S> , we find that the species producing public goods that diffuse more slowly dominates the other species ( fig .  </S>",
    "<S> [ fig4 ] ) . as  @xmath81 </S>",
    "<S> is decreased further , the population undergoes the demixing phase transition described above , and one of the species becomes extinct .    </S>",
    "<S> the effects of fitness nonlinearities and public good diffusivities can be easily understood by considering the population dynamics close to the domain boundary . </S>",
    "<S> the dominant species is determined by whether species a is more likely to invade the space occupied by species b or species b is more likely to invade the space occupied by species a. to make the argument more clear let us assume that  @xmath85 and  @xmath86 , then the concentration of public good b is the same everywhere while the concentration of public good a is high inside the domain comprised of species a and zero outside . as a result , </S>",
    "<S> the fitness of species a is the same everywhere , while the fitness of species b is low in its own domain and high in the domain occupied by species a. the nonlinearity in eq .  </S>",
    "<S> ( [ eq : fitness ] ) makes fitness changes at low nutrient concentrations much more pronounced than at high nutrient concentrations . </S>",
    "<S> thus , the advantage that the species b has over a in the domain occupied by species a ( where  @xmath87 is high ) is smaller than the advantage that species a has over b in the domain occupied by species b  ( where  @xmath88 ) . as a result , species a with lower public good diffusivity dominates species b in agreement with the simulations  ( fig .  </S>",
    "<S> [ fig4 ] ) .    in summary , we demonstrated that the main effect of public good diffusion is the reduction of the effective strength of natural selection , which can lead to the loss of mutualism via a nonequilibrium phase transition . </S>",
    "<S> the distance to this phase transition controls the size of the domains formed by the species , a quantity of prime interest in empirical studies . </S>",
    "<S> in addition , differences in the diffusivities of the public goods could have a profound effect on the population dynamics . </S>",
    "<S> the effect of these differences depends on the fitness and other nonlinearities and results in the selective advantage for one of the species . </S>",
    "<S> our work together with ref .  </S>",
    "<S> @xcite provides a theory for the phenomena observed in recent experimental studies  @xcite and could potentially explain why cooperatively growing microbes modulate the diffusivities of their public goods  @xcite .    </S>",
    "<S> this work was supported by the startup fund from boston university to kk . </S>",
    "<S> simulations were carried out on shared computing cluster at bu . </S>"
  ]
}