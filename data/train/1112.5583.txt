{
  "article_text": [
    "a common computational approach for scrape off layer plasmas of fusion experiments are combined packages which consist of two coupled codes : a fluid solver for the main plasma ( deuterium and tritium ) and a kinetic solver for neutrals ( deuterium , tritium , tungsten , carbon ... ) , see e.g. @xcite .",
    "in addition a kinetic code for impurity ions ( tungsten , carbon , beryllium ... ) can be added , e.g. @xcite .",
    "this approach avoids improper assumptions of the fluid modeling of impurity ions , which are instantaneous thermalization of the impurity particles and the lack of kinetic effects as a whole .",
    "many standalone kinetic monte carlo impurity transport codes have been developed in the past , e.g. @xcite . in general coupling of codes",
    "requires averaging of involved exchanged quantities due to different coordinate systems and grids used by the codes resulting in additional inaccuracies which degrade the output .",
    "thus direct integration and streamlining of codes is favorable .",
    "the present approach combines kinetic treatment of neutrals with the kinetic treatment of impurity ions in linear approximation , where the plasma background is fixed .",
    "the kinetic neutral transport code eirene is supplemented by a _ trace ion module _ ( tim ) , which comprises the numerical methods for solving a linear drift kinetic equation with monte carlo approach .",
    "the main difference of the tim to other impurity codes is that it is fully part of eirene and many routines for describing the neutral particle dynamics are reused for treating charged particles .",
    "thus eirene is now capable of solving three types of equations in one single code : the boltzmann equation for the neutrals , @xcite , a boltzmann like equation describing photon gas transport problems , @xcite , and tim , which now allows solving the linear drift kinetic equation for impurity ions .",
    "this paper is organized as follows : the current status of the monte carlo transport code eirene is summarized in the next chapter .",
    "then the basic idea of the trace ion module is given in chapter 3 .",
    "the linear drift kinetic model is shortly summarized in chapter 4 and its numerical implementation in the eirene code is described in chapter 5 .",
    "the scope of application of the present trajectory integration method is analyzed in chapter 6 and the collision operator is verified in chapter 7 . finally the extended code is applied to a realistic modeling scenario for the mast tokamak , where basic physics features of the trace ion module are verified .",
    "in addition the simulation results have been compared with ccd camera images for two different wave lengths .",
    "the summary is given in chapter 7 .",
    "technical details are described in the appendix .",
    "a brief overview of the current status of the monte carlo transport code eirene @xcite is given .",
    "this code package has been developed for modeling neutral gas and radiation transport problems in magnetically confined plasmas .",
    "it is a multi - species code solving simultaneously a system of time dependent or stationary linear kinetic transport equations of almost arbitrary complexity .",
    "linear kinetic transport problems are characterized by a given background plasma distribution function @xmath0 , which is usually reconstructed from fluid quantities .",
    "there are no restrictions concerning the geometric complexity of the problem , in general any discretization from 0 - 3 dimensional computational domains is possible .",
    "it has been mostly used together with fluid transport codes , where it supplies the necessary particle , momentum and energy sources from the neutral particle dynamics to the fluid codes . in return",
    "these fluid codes provide the plasma background for eirene .",
    "surface processes ( physical and chemical sputtering as well as reflection ) are treated by eirene with sputter models and reflection data bases , see @xcite . atomic and molecular data is obtained from external data bases , most notably adas @xcite .",
    "eirene further has access to the hydkin cross section data base for hydrocarbon molecules , refs .",
    "@xcite , for simulation of the complicated catabolism mechanisms of these hydrocarbons in the fusion plasma .",
    "since eirene solves a general kinetic equation radiation transport problems ( photon gas simulations ) can be treated as well , one such example is modeling of high - intensity discharge ( hid ) lamps with eirene @xcite .",
    "the code structure of the eirene code and possibly other monte carlo codes for solving linear transport problems is outlined in figure [ fig_flowchart ] .",
    "( 11 , 15 )    ( 5,0.85)(8.5,1 ) ( 1.1,0.5 )    ( 2.5,0.7 )    sources    ( 3.75,0.5 )    ( 2.5,0.7 )    diagnostics    ( 6.4,0.5 )    ( 2.5,0.7 )    data output    ( 5,2.4)(0,-1)1    ( 3.5,2.4 )    ( 3,0.6 )    post processing    ( 5,3.9)(0,-1)0.9    ( 5,5.7)(5.2,3.5 ) ( 3,5.8 )    ( 4,0.7 )    source sampling    ( 3,5 )    ( 4,0.7 )    particle tracing    ( 3,4.2 )    ( 4,0.7 )    collisions    ( 2.5,6.6 )    ( 5,0.7 )    transport core    ( 8,5.35)(-1,0)1 ( 8,4.55)(-1,0)1    ( 7.9,4.1)(3.2,3.0 ) ( 8,5)(3,0.7 )    ( 8,5.35 )    ( 3,0.3 )    guiding center    ( 8,5 )    ( 3,0.3 )    motion    ( 8,4.2)(3,0.7 )    ( 8,4.55 )    ( 3,0.3 )    fokker - planck    ( 8,4.2 )    ( 3,0.3 )    coll .",
    "operator    ( 8,6.4 )    ( 3,0.7 )    trace ion    ( 8,5.9 )    ( 3,0.7 )    module    ( 5,9.9)(0,-1)0.7    ( 3.5,8.6 )    ( 3,0.6 )    pre processing    ( 5,8.6)(0,-1)1.1    ( 5,11.95)(6,4 ) ( 2.2,10.4 )    ( 5.6,0.7 )    atomic , molecular physics    ( 2.2,11.2 )    ( 5.6,0.7 )    plasma background    ( 2.2,12.0 )    ( 5.6,0.7 )    surface model    ( 2.2,12.8 )    ( 5.6,0.7 )    grid , magnetic field    ( 0.7,0.85)(-1,0)0.3 ( 0.4,0.85)(0,1)1.1    ( 0.4,5.5)(0,1)1.4 ( 0.4,10.6)(0,1)1.0 ( 0.4,12.0)(0,-1)0.5 ( 0.4,11.6)(1,0)1.8    ( 0.1,2 ) ( 0.1,6.9 ) ( 0.1,12 )    an approximate model for transport of ionized particles along magnetic field lines has previously also been part of the eirene code . this model is now expanded by the _ trace ion module _ , which treats kinetic transport physics of ions with less simplifications .",
    "the _ trace ion module _ is an extension of the eirene code for solving a linear drift kinetic equation , see e.g. @xcite , for describing transport of charged particles in the existing code framework .",
    "the idea was to just add new orbit following routines for ions as well as a fokker - planck collision operator .",
    "in contrast to the neutral particle dynamics which is governed by the boltzmann equation the drift kinetic equation is of fokker - planck type .",
    "boltzmann equations describe discontinuous jump processes , where short range interactions between particles are dominant . on the other hand",
    "fokker - planck equations describe diffusion processes .",
    "the sample paths are described by stochastic ordinary differential equations , referred to as langevin equations .",
    "random sampling as well as time discretization is required for numerically solving stochastic ordinary differential equations . for more details on stochastic ordinary differential equations",
    "see e.g. @xcite .",
    "a combination of discontinuous jump processes and time discrete integration of stochastic ordinary differential equations is possible whenever the time discrete integration algorithm can be formulated as a jump process . in this case the langevin equations which correspond to the drift kinetic equation have been solved by splitting the particle motion into a deterministic part which is interrupted by an artificial collision event .",
    "this collision event takes into account the effective action of the coulomb force on the particle trajectory during one time step as well as the change of the velocity vector due to the electromagnetic forces in guiding center approximation .",
    "the major problem is that eirene is working with distances rather than time steps for calculating trajectories of the neutrals .",
    "in fact eirene determines the flight distance of a neutral particle from an effective mean free path and samples the type of collision at the point of collision from a discrete distribution of probabilities of the involved collision processes .",
    "only once this distance and the point of collision is known a time step can be calculated , which is simply the amount of time necessary to reach the point of collision at the current particle speed .",
    "+ the natural coordinate system for following of guiding center orbits is aligned with the magnetic field , which decouples parallel and perpendicular motion and significantly simplifies trajectory integration .",
    "this is conflicting with the neutral particle dynamics which is treated in cartesian coordinates . in practice",
    "the eirene code is working with unstructured grids in a cartesian coordinate system and the integration of the guiding center equations has to fit into this scheme . an obvious choice for orbit integration are runge kutta methods , which are frequently used in many kinetic plasma transport codes . in principle",
    "such methods could be incorporated into eirene under the expense of additional particle tracking on the grid .",
    "if such methods are applicable in eirene without a significant performance loss is to be investigated .",
    "computationally less demanding but highly accurate methods for orbit integration are adams bashforth backward methods .",
    "currently a 4-step adams - bashforth backward formula has been incorporated into eirene , which makes the calculation of the effective guiding center velocity simple and efficient .",
    "moreover numerical errors due to cartesian coordinates have been mitigated by significantly improving the interpolation and differentiation techniques on the numerical grid .",
    "interpolation methods from finite element theory have been applied , where grid cells possess shape functions allowing to interpolate and differentiate electric and magnetic field vectors locally in each grid cell .",
    "currently three types of cells are supported : 3-node triangles , 4-node quadrangles and 4-node tetrahedrons .",
    "coulomb collisions are treated as field collisions , where test particles interaction with the background plasma is described by evaluating trubnikov / rosenbluth potentials @xcite .",
    "this is done one the fly for non - maxwellian distribution functions , which enables thermal force effects on a kinetic level . since this collision operator in guiding center coordinates is singular",
    "an implicit method has been developed , which handles the singularity occurring in the perpendicular drift coefficient .",
    "the present approach , the details of which are summarized in [ a_impl_meth ] , shows a solution for overcoming this problem in the framework of a monte carlo approach , while solutions for the same problem in context with finite difference methods have already been reported in e.g. @xcite .",
    "the location of the new orbit integration and collision routines of the _ trace ion module _ in the code structure of eirene is sketched in figure [ fig_flowchart ] .",
    "a summary of the drift kinetic model is given .",
    "drift kinetic theory applies whenever the larmor radius of the considered ion is much smaller than the gradient length of the external magnetic fields , @xmath1 .",
    "the larmor radius for ions with mass @xmath2 and charge number @xmath3 is defined by @xmath4 , where @xmath5 is the perpendicular velocity component and the cyclotron frequency is given by @xmath6 .",
    "the magnetic field vector is denoted by @xmath7 , its absolute value by @xmath8 and the unit vector by @xmath9 .",
    "the charge of the electron is @xmath10 .",
    "the following notations are applied , @xmath11 where the velocity component parallel to the magnetic field is denoted with @xmath12 . the drift kinetic equation for stationary magnetic and electric fields and a fixed plasma background ( linear approximation )",
    "can then be written as @xmath13v_2f\\right)\\nonumber\\\\   + \\frac{1}{2}\\sum_{k , l=1}^2\\partial_k\\partial_l\\left(d_{kl}v_2f\\right)+s , \\label{drift_kin_equation}\\end{aligned}\\ ] ] which governs the time evolution of the distribution function @xmath14 . for a detailed derivation of this equation",
    "see e.g. @xcite .",
    "this equation is already written in fokker - planck form which allows straight forward construction of appropriate monte carlo methods .",
    "therein the guiding center velocity @xmath15 and the time derivatives of the reduced phase space velocities @xmath16 are defined by @xmath17 this approach covers the drifts due to radial electric field and magnetic field inhomogeneities as well as the mirror effect and the electrostatic force .",
    "coulomb collisions are represented by the drift and diffusion coefficients , @xmath18 and @xmath19 respectively .",
    "a comprehensive report on evaluating these coefficients for non - maxwellian plasmas can be found in @xcite . therein appropriate",
    "drift and diffusion coefficients in the reduced @xmath20 phase space are given , @xmath21 + the trubnikov / rosenbluth potentials @xmath22 and @xmath23 are specialized for taking into account friction as well as the thermal force effect .",
    "the derivation of the explicit form of these potentials is given in [ a_13mint ] , which differs from the derivation given in @xcite in the following respects : a different method has been used for integration of the potential functions and the differentials required for calculating the thermal force effect have been expanded to cover the perpendicular direction , which will enable thermal force effects in radial direction in the future .",
    "it is noted that the notations and definitions of the potentials derived in @xcite have been reused in this work .",
    "the standard monte carlo approach for diffusion in real space with a constant diffusion coefficient is used , where the diffusion matrix is of the form @xmath24 therein the vector @xmath25 is defined to be perpendicular to the magnetic field in radial direction lying in the poloidal plane .",
    "the factor @xmath26 is given by @xmath27 where @xmath28 and @xmath29 denotes particle density and charge of the background particles .",
    "the coulomb logarithm @xmath30 replaces a singular integral which results from the infinite range of the electrostatic potential .",
    "this integral is usually cut off at a certain impact parameter which is of the order of the debye radius .",
    "the coulomb logarithm has been taken constant through out the whole work . as a typical value for fusion",
    "relevant plasmas @xmath31 has been used . since impurities in the sol plasma consist of many different species and",
    "each of these species can have more than one charge state additional sources / sinks represented by @xmath32 in equation [ drift_kin_equation ] account for ionization , recombination @xmath33 and external particle creation and annihilation processes @xmath34 .",
    "the complete source / sink term reads @xmath35",
    "random walks of neutral particles in the eirene code are constructed by evaluating the distance @xmath36 to the next collision according to the effective local mean free path of the involved collision processes .",
    "once this distance is known eirene updates the position of a particle according to @xmath37 where particle positions are denoted by @xmath38 and the unit velocity vector is @xmath39 . at the new position",
    "the next collisional event is executed and the velocity vector @xmath40 of the particle is instantaneously changed .",
    "this process is continued until a time limit is reached or the particle is absorbed at a surface .",
    "macroscopic quantities are estimated from the random walks of the particles on the computational grid by applying a track length estimator .",
    "random walks of this type , referred to as markov chains , solve the boltzmann equation for the neutrals in terms of distribution functions . in the present approach the dynamics of ionized particles",
    "is governed by stochastic ordinary differential equations corresponding to [ drift_kin_equation ] .",
    "the first order euler - maruyama method for discretization of these equations is given by @xmath41 where @xmath42 is the state vector of the system , which is represented in this case by the position of the particle @xmath38 and the reduced @xmath43 velocity phase space .",
    "local drift coefficients are denoted by @xmath44 , diffusion coefficients by @xmath8 and @xmath45 is a normal distributed random number with mean @xmath46 and variance @xmath47 .",
    "diffusion coefficients @xmath8 can be constructed from the corresponding diffusion matrix ( @xmath48 ) in [ drift_kin_equation ] , which in principal is a five dimensional matrix covering diffusion in real space as well as in velocity space .",
    "an appropriate method for constructing @xmath8 in velocity space is given in [ a_driftdiffcoeff ] .",
    "the initial state of a new born particle , due to e.g. a surface process , is the initial position and the parallel and perpendicular velocity components of the 3d velocity vector , which eirene assigns to newly created particles . for incorporating the discretized langevin equations into the monte carlo framework of the eirene code the actual algorithm has to be formulated as a jump process .",
    "in particular the position of the ionized particle has to be updated in the same way as for the neutrals according to eq .",
    "( [ advance_position ] ) , but with an effective guiding center velocity @xmath49 this effective guiding center velocity vector is constructed at each point of collision and takes into account the effect of the electromagnetic force as well as the coulomb force both acting on the particle over a time period @xmath50 . currently a 4-step adams bashforth backward formula is used for evaluating @xmath15 , the details of which are given in [ a_adams_bashforth ] .",
    "for calculating a distance to the next coulomb collision event , @xmath51 an appropriate time step @xmath52 has to be supplied .",
    "this is not necessarily the time step used for the actual collision process , but it allows eirene to determine the shortest distance for the next type of collision .",
    "coulomb collisions have to be executed in any case , no matter what other collision event is executed . in practice",
    "the time step for coulomb collisions and furthermore the distance to the next coulomb collision has to be much smaller than the mean free path of the other involved collision processes for proper resolving the thermalization of the test particles with the plasma background .",
    "in fact @xmath52 is just the upper limit for the actual time step .",
    "the actual time step for updating the guiding center position can be calculated after the flight distance @xmath36 has been determined by eirene from @xmath53 for resolving thermalization processes @xmath52 can be adjusted as a fraction , e.g. @xmath54 , of the local equilibration time .",
    "the actual algorithm works in the following manner : after the distance to the next collision has been determined by eirene and the time step @xmath50 is known the particle position is updated according to equation [ advance_position ] , where @xmath55 is replaced with @xmath56 . in the next step post collision phase space velocities are calculated by @xmath57 where normalized quantities are used , @xmath58 with the inverse thermal velocity @xmath59 .",
    "this is an effective collision where in addition to the coulomb interaction , @xmath60 , also the acceleration due to the electric field and the mirror force , @xmath61 , is accounted for .",
    "the latter are calculated at the current particle position @xmath62 and are given by @xmath63 it is noted that consistency requires to evaluate the deterministic velocity increments @xmath64 in the same way as @xmath15 .",
    "the stochastic velocity increments are evaluated in any case according to @xmath65 with two random numbers @xmath66 .",
    "the singularity of this collision operator is expressed in the perpendicular drift coefficient @xmath67 , which is singular for @xmath68 .",
    "if friction forces only are considered a different set of coordinates might have allowed to get around this difficulty , but for a numerical implementation of the thermal force effect in the kinetic monte carlo approach the present coordinates @xmath43 are the most simple and computationally the most efficient ones .",
    "the present algorithm has been supplemented by an implicit part , which treats slow particles ( with respect to @xmath5 ) below a certain threshold .",
    "the additional computational expense is about @xmath69 , where it is noted that without this implicit part the energy of the test particles is overestimated and conservation of energy of the collision operator is severely violated .",
    "details are described in [ a_impl_meth ] .",
    "the next step of this algorithm is finding interpolated values and derivatives of the magnetic and electric fields at the point of collision @xmath62 , @xmath70 and evaluating the new effective guiding center velocity by applying an appropriate integration method .",
    "finally the particle position is advanced to the next point of collision . in this approach @xmath71 and @xmath72",
    "are actually dummy variables which are only required for constructing the guiding center velocity .",
    "in fact an ionized particle is described in eirene by the position @xmath38 and the velocity @xmath15 in the six dimensional 3d in real and 3d in ( guiding center ) velocity space .",
    "it is noted that in 2d simulations the toroidal contribution of the curvature drift can not be resolved .",
    "the magnetic field is given on the poloidal plane only , which is in fact a cylindrical approximation .",
    "a possible axis symmetric toroidal magnetic field component has the form @xmath73 , where @xmath74 is the unit vector in toroidal direction .",
    "the toroidal part of the curvature drift is then recovered as @xmath75 where @xmath76 is a unit vector pointing upward in the direction of the axis of the tokamak ( the plane in which the torus is located is the @xmath77-plane ) . the direction of this drift is aligned with the @xmath78 drift , which is assumed to point downwards here . especially for spherical tokamaks , e.g. mast , the toroidal curvature is one order of magnitude higher as for other tokamaks and the effect of the toroidal curvature has a big impact on modeling results .",
    "the quality of orbit integration in the presented algorithm is determined by the evaluation of the effective guiding center velocity at each time step . if @xmath15 is calculated from the local plasma and magnetic field parameters at the current simulation time the resulting jump process is identical to the first order euler method and fits perfectly to eirene by lowest computational costs .",
    "the drawback of applying the euler method for guiding center orbit integration in fusion plasmas is the accumulating numerical error , which leads to an artificial outward drift of the ions .",
    "this is only tolerable for short living particles where closed orbits are not to be expected .",
    "for example the life time of @xmath79 in the divertor region of the mast tokamak is @xmath80 according to ionization rates of adas , @xcite .",
    "this is long enough to fully thermalize . on the other hand",
    "the bounce time estimated for a circular magnetic field ( major radius @xmath81 chosen for mast edge plasma ) and a particle at a thermal speed of @xmath82 is @xmath83 .",
    "the lifetime of @xmath79 is two orders of magnitude lower than the time for passing at least a single orbit , which justifies to use the simple euler orbit integrator in this case . + for treating particle motion of particles with longer life times more accurate orbit integration methods have been sought . in fusion research runge kutta methods",
    "are frequently used for guiding center orbit following codes .",
    "one such example is ascot , @xcite .",
    "implementing an @xmath84 order runge kutta methods into eirene requires the evaluation of @xmath85 intermediate steps , for which each time the whole geometry module ( locate particle on grid , interpolate value inside grid cell ) has to be called . since the geometry module is the most demanding part of eirene with respect to computing power such methods are not suitable .",
    "promising methods , which allows to improve the orbit integration of eirene while keeping the additional computational effort low , are adams bashforth backward formulas .",
    "the effective velocity vector needed for advancing the particle position is constructed from previous velocity values rather than from calculating intermediate steps , which requires almost no additional computing power just a negligible increase of storage .",
    "the details of the 4-step backward method which has been incorporated into the eirene code is described in [ a_adams_bashforth ] .",
    "the reason why a 4-step backward method has been used is because backward formulas taking two and three steps were observed to be unstable .",
    "nevertheless these formulas are required to start the particle orbit .",
    "this unstable behavior might be due to extreme time step differences , which can occur in eirene .",
    "in particular in front of surfaces the time step can change e.g. from @xmath86 to @xmath87 , because eirene is moving a particle from one cell to the cell face of the next one for keeping track of the particles on the grid .",
    "this method can be easily extended to 5 or more step method , but this has not been considered yet .",
    "+ as an illustrative example of the performance of the backward orbit integrator is shown in figure [ fig_adams - bashforth ] .",
    "the evolution of the radial coordinate at the mid plane ( @xmath88 positive , outer zero crossing of the orbit ) of a closed collision less orbit is plotted vs. time .",
    "the orbit , which has been calculated with the euler method , continuously drifts outward while the radial coordinate of the orbit obtained with the 4 step adams - bashforth keeps constant ( 300 orbits transits are shown ) .",
    "the outward drift per orbit is not completely removed with the adams - bashforth method , but compared to the euler integrator it is considerably lower . for this particular orbit , which has been integrated with a step size of @xmath89 , the radial outward drift per orbit has been found to be @xmath90 , where @xmath91 denotes the amount of time to pass one full orbit .",
    "whereas the steady state behavior of the present cou- lomb collision operator has been well tested in ref .",
    "@xcite , verification of the dynamics of the collision operator is missing .",
    "for this reason the time evolution of corresponding moments of the kinetic distribution function have been estimated and the results have been confronted to available analytical relaxation time approximations . in particular , slowing down of particles , temperature equilibration and temperature isotropization have been checked .",
    "the most simple estimator has been used for calculating moments of the distribution function , @xmath92 , which is given @xmath93 , where @xmath94 is any function of @xmath95 , e.g. particle energy @xmath96 .",
    "a slab case for the eirene code has been set up existing of one cell with periodic boundary conditions and uniform magnetic field in z direction .",
    "typical plasma parameters for fusion edge plasmas have been adjusted in these simulations , @xmath97ev , @xmath98m@xmath99 and @xmath100 .",
    "a point source of test particles in the cell center has been placed , where @xmath101 ions with isotropic , monoenergetic velocity distribution have been released at an initial energy of @xmath47ev .",
    "the time interval for the simulations was @xmath102ms , where @xmath103 and @xmath104 and the time step has been fixed to @xmath105 .",
    "an analytic expression for the equilibration of plasmas at different temperatures but no relative drift velocity is given by @xmath106 where the characteristic frequency is @xmath107 temperature isotropization of a plasma with constant overall temperature but different @xmath108 and @xmath109 is described by @xmath110 where @xmath111 and the characteristic frequency @xmath112 where @xmath113 and @xmath114 . in this case particles",
    "have to be sampled from a bi - maxwellian distribution function .",
    "the overall temperature , @xmath115 , is constant in this case and energy is solely transferred from parallel to perpendicular direction . slowing down",
    "means that the macroscopic flow velocity of the test particles adjusts to the flow velocity of the plasma background , described by a shifted maxwellian .",
    "the governing relaxation equation is @xmath116 where the slowing down frequency is    @xmath117    the slowing down of test particles has been checked for a beam of particles aligned with the magnetic field .",
    "results of the monte carlo simulations as well as the solutions of the ordinary differential equations for slowing down , thermalization and isotropization have been plotted in figure [ fig_relaxation_and_grid_dependence ] .",
    "( slowing down , blue line ) and @xmath118 ( thermalization , black line ) and the right ordinate corresponds to @xmath119 ( isotropization , green line),width=283 ]    therein the time evolution of t and u , normalized to background plasma temperature as well as flow velocity , and the time evolution of @xmath119 is shown .",
    "analytical results and simulation are in good agreement for all three processes .",
    "moreover the present collision operator includes the thermal force effect , the numerical implementation of which has been adapted for the eirene code but the net effect has already been described in @xcite .",
    "the main features are shortly summarized : the thermo effect is described in the present case on a kinetic level by taking into account a non equilibrium distribution function for the plasma background , denoted by @xmath120 , in the derivation of appropriate trubnikov / rosenbluth potentials . in particular",
    "@xmath120 has been constructed from a maxwellian distribution , which is perturbed by a series of hermitian polynomials ( see [ a_13mint ] ) .",
    "the coefficients in the perturbation series mainly depends on the temperature gradient and the ratio @xmath121 . for high densities , @xmath122 ,",
    "the influence of the temperature gradient is small , because the collisionality is high and the plasma is always close to local equilibrium . at low densities , e.g. closer to the target plates of a fusion device ,",
    "even small temperature gradients lead to a significant temperature gradient force .",
    "nevertheless the perturbation from equilibrium may not exceed the limit where @xmath123 .",
    ", title=\"fig:\",width=264 ] +     +   +   +     the extended eirene code supplemented by the _ trace ion module _ has been tested for a realistic modeling case for the mast tokamak @xcite . due to the low aspect ratio of this tokamak @xmath124 neoclassical transport effects",
    "are enhanced , which makes mast particularly well suited for testing the _ trace ion module_. the main purpose of the simulations was to see how different impurity transport processes affect impurity profiles , which has been supplemented by an at least qualitative comparison of the simulation results with ccd camera images .",
    "the present case is based on discharge # @xmath125 , during which the ccd system recorded cii and ciii emission .",
    "the plasma background for this discharge has been provided by the osm code @xcite .",
    "the quality of the osm background plasma calculation is important because the emission of cii and ciii is strongly dependent on the local plasma conditions .",
    "the @xmath78 drift is acting downward for positive ions .",
    "a toroidally symmetric methane gas puff has been simulated , thus a 2d simulation is sufficient .",
    "the puff location was lower inboard at @xmath126 .",
    "the fragmentation of the methane in the divertor plasma of mast , where temperatures are about @xmath127 , is characterized by a walk through of neutral as well as ionized molecules , which result into the final fragmentation products c and h ( and their ions ) .",
    "the single code concept for both types of particles avoids rapid data transfer between codes , which would occur in the standard treatment where two kinetic codes are used .",
    "moreover it is intrinsically ensured that atomic and molecular data is used consistently . in the present case",
    "the methane fragmentation has been described with the data obtained in @xcite .",
    "ionization and recombination of carbon atoms / ions has been described with adas data @xcite , in particular _",
    "adf11/scd94 _ and _ adf11/acd94_. the highest charge state of carbon included in the simulations was @xmath101 , because the recombination rate of @xmath128 is too small for being a significant source of @xmath101 under the plasma conditions at hand .",
    "moreover the life time of @xmath128 in the mast divertor is already long enough for being completely thermalized and a fluid description is the better and more efficient choice .",
    "the grid which has been used is shown in figure [ pic_mast_13949_grid ] , the boundary of which has been specified as carbon .",
    "physical and chemical sputtering has been turned off .",
    "physics effects studied with the _ trace ion module _ are friction force and thermalization , thermal force , mirror force , parallel electric field force and drift effects .",
    "available drifts are @xmath78-drift , curvature drift including a quasi 3d correction term for 2d simulations and @xmath129 drift , which requires an appropriate electric field model .",
    "if no effects for ions are activated particles simply follow magnetic field lines .",
    "radial and field aligned emission profiles with different effects active are shown in figure [ pic_mast_13949_ciii_profiles_psi ] and have to be understood as indicated in the 2d emission pattern shown in figure [ pic_mast_13949_ciii ] ( two radial profiles 1,2 and one field aligned 3 ) .",
    "five different cases are shown : 1 . )",
    "parallel motion along field lines and friction force @xmath130 thermalization ( cc ) , 2 . ) mirror force added ( m ) , 3 . )",
    "@xmath78 drift added ( gb ) , 4 . )",
    "curvature drift added including quasi 3d correction ( cd ) , 5 . ) @xmath129 ( ft ) added .",
    "profiles obtained from ccd camera data are denoted by ccd in the figures .",
    "the electric field has been obtained from the model described in ref .",
    "@xcite , the calculation of which only involves background plasma quantities . because temperature gradients in the region of the radiated @xmath131 emission ( inside the closed flux surface region ) are small , the thermal force effect is negligible in this case and such simulations are not shown .",
    "temperature profiles have been normalized to the background plasma temperature @xmath132 , thus complete thermalization is reached at a value of @xmath47 .",
    "the general behavior of these emission profiles is a maximum near the separatrix and a decrease in opposite radial direction further in the plasma .",
    "considering friction force and thermalization of @xmath101 the profile is relatively flat along the field lines and falls off radially inward , following almost the inverse of the temperature profile ( which mainly governs the lifetime and hence the density of the particles ) .",
    "the mirror force does not affect the radial profiles but particles are shifted further upstream to the inboard side along the field lines .",
    "the @xmath78 drift is acting in downward direction in this case and yields a decrease in density because particles are pushed to the bottom across the separatrix or in other words the probability for particles crossing the separatrix is lower .",
    "the major part of the curvature drift is due to toroidal curvature ( for which a correction term has been introduced , see equ .",
    "[ cd_quasi3d_correction ] ) and is acting in direction of the @xmath78-drift .",
    "thus it has a similar effect and further decreases the particle density .",
    "the last effect which has been added is an electric field model which slightly alters the density profiles to lower values .",
    "it has been observed that outside the separatrix the density profiles are practically zero , where it is noted that densities and temperatures are considered only in regions where standard deviation is below @xmath69 . whereas the emission profile is significantly influenced by the drifts the effect of the drifts on the temperature profile is small , see figure [ pic_mast_13949_ciii_profiles_psi ] . in all cases",
    "@xmath101 is nearly thermalized near the separatrix and the degree of thermalization decreases further into the plasma to @xmath133 .",
    "close to the separatrix the lifetime of @xmath101 is about @xmath134 , which is just long enough to fully thermalize .",
    "further inside the plasma the lifetime is decreasing and full thermalization can not be reached anymore .",
    "the observation from the simulation point of view is that the temperature behavior is exclusively governed by the coulomb collision operator and the drift effects mainly act on the density profiles .",
    "finally the simulation results have been compared at least qualitatively with uncalibrated ccd camera images for carbon emission at two wave length ( @xmath135 , ciii and @xmath136 , cii ) from mast discharge 13949 , which have been kindly provided by s. lisgo .",
    "it is noted that raw images of the ccd system ( resolution @xmath137 ) have been converted into 2d poloidal emissivity profiles via tomographic inversion and emission from intrinsic carbon due to sputtering has been subtracted .",
    "simulated carbon density profiles have been converted into emission profiles using photon emissivity coefficients ( pec ) according to @xmath138 where @xmath139 is the particle density of the particular species , @xmath140 and @xmath141 are the electron density and temperature and @xmath30 is the specific wave length .",
    "the particular pec s have been taken from the adas database ( @xmath142 and @xmath143 , metastable states are not resolved ) .",
    "results are shown for cii emission in figure [ pic_mast_13949_cii ] and for ciii in [ pic_mast_13949_ciii ] .",
    "the general behavior of the simulated cii profile corresponds to the experimental one , but especially the density extends much further into the plasma as experimental seen .",
    "the cii emission has been calculated from the simulated @xmath144 density profile , which is governed mainly by the source of @xmath144 . in this case",
    "the source of @xmath144 is determined by the break up process of methane , where finally the dissociation of @xmath145 is the only channel to produce @xmath146 and subsequently @xmath144 . in the present simulation",
    "the langer database has been used to describe the break up of the methane , which might allow to penetrate @xmath145 or @xmath146 too far into the plasma before being ionized to @xmath144 .",
    "the influence of the present break up model has not been fully understood yet and will be further investigated .",
    "in contrast the lifetime of @xmath101 is much longer than for @xmath144 and the density profile is more affected by the transport rather than the source profile .",
    "the radiation close to the x point is overestimated by the simulation , but the radiation pattern itself is close to the ccd image .",
    "this is explained by the low aspect ratio of mast where the strong magnetic field curvature is significantly enhancing the drift effects , which govern the deposition of the particles .",
    "the comparison of the ccd images and the trace ion transport simulations with the extended eirene code show at least that the overall model is consistent with the experimental observations .",
    "finally a comment on the computational demands of the performed simulations is given .",
    "it has been observed that approximately @xmath147 particle histories are required for the present mast case to obtain a reasonably small standard deviation in regions of interest ( @xmath148 ) .",
    "might be different for other cases .",
    "tracing @xmath147 particles on the grid shown in figure [ pic_mast_13949_grid ] , which consists of @xmath149 triangles , took approximately @xmath150 minutes on an intel core2 quad at 2,83 ghz . the maximum allowed time step for the tracing ions was @xmath151 and the maximum life time of a particle has been limited to @xmath152 . on the opteron cluster",
    "leo i of innsbruck university an eirene run where exactly @xmath153 particle histories have been calculated on 96 cpu s took less than one minute .",
    "leo i is a mixture of opteron barcelona at 2,3 ghz and opteron shanghai at 2,5 ghz .",
    "a linear kinetic monte carlo particle transport algorithm for neutral ( force - free ) particles and linear boltzmann collision integrals has been supplemented by numerical orbit integration modules as well as diffusive ( fokker - planck ) velocity space collision integrals .",
    "the main motivation for this development was to combine neutral atom transport with drift ( guiding center ) kinetic impurity ion transport in magnetized fusion edge plasmas into a single algorithm .",
    "the unified procedure allows to simulate both neutral and charged particles within a single source code and hence to avoid any numerical dissipation which would otherwise be caused by frequent transfer of information between neutral particle to charged particle modules .",
    "in particular the extended code seems to be well suited to deal with the rich chemistry of e.g. hydrocarbons in fusion edge plasmas , when a fragmentation of a single molecule proceeds via a sequence of neutral and charged states with quite distinct transport characteristics .",
    "also in other circumstances , often in those relevant for cool dense fusion divertor plasmas , such as transport of weakly ionized trace impurities near target surfaces , a strictly consistent transport description of neutral and charged states of an atom can be important .",
    "clearly the optimal coordinate systems for solving transport problems for magnetized ions and for neutrals are at odds with each other , with the former necessarily being related to ( inhomogeneous ) magnetic field properties , and the latter being simply cartesian coordinates ( in which also solid surfaces and hence boundary conditions for the ion transport are naturally formulated ) .",
    "we have shown that a computationally affordable orbit integration scheme , which can be readily implemented into cartesian grid based monte carlo solvers , can be constructed and is sufficiently accurate for a number of relevant applications including those mentioned above .",
    "the boundaries of the validity range , for acceptable time steps ( and hence acceptable cpu costs of the entire package ) are specified and found to accommodate in particular typical fusion edge plasma and divertor plasma conditions .",
    "the linear guiding center fokker - planck collision integral is integrated into the monte carlo procedure by utilizing rosenbluth potentials , evaluated `` on the fly '' on non - maxwellian background velocity distributions to accommodate kinetic thermal force effects .",
    "we have shown that this is economically possible and that the unavoidable singularity in these potentials at the zero of perpendicular velocity can be properly dealt with by an implicit procedure of monte carlo sampling of the post - collision ion velocities .",
    "a series of test cases based on semi - analytic solutions to strongly simplified problems has been developed to verify both the implementation of the new collision kernel and the explicit orbit integrator .",
    "as an illustrative sample of the essential capabilities we apply the extended code to physical and configurational model parameters chosen to simulate a methane gas puff experiment carried out in the compact spherical tokamak mast ( uk ) . in this magnetic configuration and plasma density",
    "range kinetic ion drift orbit effects can be expected to be particularly pronounced .",
    "experimental results on weakly ionized carbon ion emission patterns are discussed with respect to relative importance of some of the new features in the extended code .",
    "this work was partially funded by fwf ( austrian science fund ) under project p21061 .",
    "the author thanks prof .",
    "d. reiter , forschungszentrum jlich ( germany ) , for his support and for numerous of fruitful discussions on kinetic monte carlo methods .",
    "moreover s. lisgo , formerly at mast ( culham science center uk ) is acknowledged for supplying osm plasma backgrounds and ccd camera data for mast .",
    "felix rei- mold , forschungszentrum garching ( germany ) , is acknowledged for extensive testing of the trace ion module for eirene .",
    "finally the author thanks assoc .- prof .",
    "siegbert kuhn for his kind support during this work .",
    "this work was supported by the austrian ministry of science bmwf as part of the uni infrastrukturprogramm of the forschungsplattform scientific computing at lfu innsbruck .",
    "this work , supported by the european communities under the contract of association between euratom and the austrian academy of sciences , was carried out within the framework of the european fusion development agreement .",
    "the views and opinions expressed herein do not necessarily reflect those of the european commission .",
    "the algorithm for advancing particle positions in the eirene code is given by @xmath154 where @xmath38 is the guiding center position in case of ionized particles and @xmath15 is an effective guiding center velocity .",
    "computationally affordable methods for evaluating @xmath15 , which fit to the monte carlo framework of eirene , are adams bashforth backward methods .",
    "the backward formula for an effective guiding center velocity for different numbers of backward steps @xmath155 is given by @xmath156 where @xmath157 contains coefficients corresponding to the number of backward steps required .",
    "if @xmath158 the first order euler method is restored , where the effective guiding center velocity is calculated solely from the current plasma and magnetic field parameters at the current location as is described in detail in chapter [ subsection_langevin ] .",
    "it is noted that @xmath159 have to be integrated in the same manner as @xmath15 . for a 4 step backward method the following coefficients",
    "have been calculated : @xmath160\\nonumber \\end{aligned}\\ ] ] guiding center orbits are started with the euler method and take each following time step on more precedent guiding center velocity , until four values are available .",
    "these backward methods require no additional computational effort , just one more array has to defined which stores the values of @xmath15 and @xmath159 for @xmath155 successive steps .",
    "in the test particle approach the treatment of collisions with the background plasma ( denoted by index @xmath161 ) , given by fluid quantities , requires the construction of a kinetic distribution function @xmath120 .",
    "one approach , taking into account both the friction force as well as the thermo effect , is to describe the local plasma equilibrium by a maxwellian like reference state , perturbed by a distortion function accounting for inhomogeneities .",
    "the distortion function can be a series of laguerre polynomials , e.g. @xcite , or hermite polynomials , e.g. @xcite . in the present work",
    "the 13 moment approximation is considered , where the deviation from equilibrium @xmath162 is given by a truncated series of hermitian polynomials .",
    "this approach has been developed in @xcite and applied to plasma transport codes in @xcite .",
    "the calculation of a kinetic distribution function with this method requires in addition to the five fluid moments number density , @xmath163 , temperature , @xmath164 and flow velocity , @xmath165 , three components of the heat flux @xmath166 and five independent components of the pressure tensor @xmath167 , hence 13 moments are used .",
    "the space coordinate is denoted by @xmath168 . for deriving appropriate drift and diffusion coefficients in the standard trubnikov / rosenbluth formalism",
    "it is convent to use the inverse thermal velocity , @xmath169 , as a normalization parameter , @xmath170 and furthermore to introduce the following normalized velocities @xmath171 where @xmath172 is the single particle velocity of background particles and @xmath173 denotes the test particle velocity .",
    "then the perturbed maxwellian distribution function is given by @xmath174 the distortion function in the 13 moment approximation reads ( summation over i and j ) @xmath175 with the definition of the hermitian polynomials in terms of normalized velocities , @xmath176 the corresponding coefficients are related to the heat flux @xmath166 and the pressure tensor @xmath167 by @xmath177 by substitution of @xmath178 the perturbed maxwellian can be written as @xmath179 and the trubnikov / rosenbluth potentials can be written as convolution integrals of the form @xmath180 the potential functions can then be written as a sum of integrals depending on the normalized test particle velocity @xmath181 , @xmath182 the integrals @xmath183 and the details of the evaluation as well as the corresponding results are given in [ potential_functions_integrals ] . by introducing a generalized heat flux @xmath184 and a generalized pressure @xmath185 tensor with @xmath186 and skipping @xmath187 the trubnikov / rosenbluth potentials can be written as @xmath188 where it is noted that the potential functions @xmath189 and @xmath190 , which are defined in [ potentials ] , depend only on the absolute value of @xmath191 and are ab initio independent of the gyro angle .",
    "for obtaining the trubnikov / rosenbluth potentials for a perturbed maxwellian velocity distribution function the following integrals have to be calculated @xmath192 with the hermitian polynomials defined as in [ hermit_poly ] .",
    "the integration can be performed by switching to a spherical coordinate system @xmath193 with @xmath194 parallel to the vector @xmath195 , then @xmath195 and @xmath38 have the form @xmath196 and the squared absolute value of the sum of these two vectors reads @xmath197 in such a coordinate system integrals of the following form arise @xmath198 the integration of which is straight forward . since the solutions of the integrals consist of combination of the error function and it s derivative we introduce @xmath199 and define the following potential functions in the same way as in @xcite @xmath200 using these definitions one can write the solutions of the integrals in a convenient way @xmath201",
    "@xmath202 @xmath203 these results have been calculated for a coordinate system with @xmath194 parallel to @xmath204 one has to transform it back into the coordinate system of the laboratory , which can be done by a rotation defined by two matrices @xmath205 a vector in the coordinate system @xmath193 can be transformed to the laboratory system @xmath206 denoted by @xmath207 via @xmath208 and a matrix @xmath209 using the following relations of the angles and the coordinates in the laboratory system @xmath210 the final results of the integrals can be written as @xmath211 these results coincide with the ones obtained by reiser in @xcite and @xcite .",
    "the explicit form of the drift and diffusion coefficients [ diff_coeff_1 ] and the derivatives of the potential functions [ pot_13m_full ] is given .",
    "in contrast to @xcite , where derivatives have been calculated for the parallel direction only , also the perpendicular direction is considered in the present case , thus allowing to extend the thermo effect in perpendicular direction .",
    "this extension is planned in a future project .",
    "the following helpful quantities have been used , @xmath212 then it follows for the first derivative with respect to @xmath213 @xmath214\\nonumber\\\\          & \\,+\\,\\alpha\\sum_{ij}\\pi_{ij}\\left[-3 m_{ikj}\\phi_2+\\left(\\delta_{ij}-3\\frac{\\chi_i\\chi_j}{\\chi^2}\\right)\\frac{\\chi_k}{\\chi}\\phi_2'\\right ] \\label{first_deriv_pot } \\end{aligned}\\ ] ] where @xmath215 the second derivative reads @xmath216\\nonumber\\\\          & \\,\\,+\\,\\alpha^2\\sum_i q_i\\bigg[\\partial_l n_{ik}\\phi_1+m_{ilk}\\phi_1'\\\\          & \\hspace{1cm}+\\frac{\\chi_l}{\\chi}\\left(n_{ik}\\phi_1'+\\frac{\\chi_i\\chi_k}{\\chi^2}\\phi_1''\\right)\\bigg]\\nonumber\\\\          & \\,\\,+\\,\\alpha^2\\sum_{ij}\\pi_{ij}\\bigg[-3\\partial_l m_{ikj}\\phi_2\\\\          & \\hspace{1cm}-3\\left(\\frac{\\chi_l}{\\chi}m_{ikj}+m_{ilj}\\frac{\\chi_k}{\\chi}\\right)\\phi_2'\\nonumber\\\\          & \\hspace{1cm}+\\left(\\delta_{ij}-3\\frac{\\chi_i\\chi_j}{\\chi^2}\\right)\\left(n_{lk}\\phi_2'+\\frac{\\chi_k\\chi_l}{\\chi^2}\\phi_2''\\right ) \\bigg ] \\label{second_deriv_pot}\\end{aligned}\\ ] ] where the following tensors have been introduced as @xmath217 @xmath218 in addition to the derivatives of the potential functions [ pot_13m_full ] the scalar product @xmath219 and the sum over all elements of the matrix @xmath220 have to be evaluated for obtaining the explicit form of the drift and diffusion coefficients .",
    "the resulting scalar quantities @xmath221 and @xmath222 are not independent of the gyro angle ab initio .",
    "hence they do not fit into the drift kinetic model which is the aim of the present work . neglecting perpendicular heat fluxes ( same approach as in @xcite ) the scalar product [ c1_dotprod ] is gyro angle free and can be evaluated by @xmath223 where the parallel heat flux is defined as @xmath224",
    "the value of the transport coefficient @xmath225 is @xmath226 according to @xcite . with this approach at least the thermo effect in parallel direction",
    "can be studied .",
    "according to @xcite this viscosity tensor is invariant under rotations around @xmath9 and it is assumed that the scalar quantity @xmath222 is ab initio independent of the gyro angle for magnetized plasmas .",
    "the reduced form of the viscosity tensor is given by @xmath227 where @xmath228 here the x direction coincides with the direction of the magnetic field vector .",
    "the explicit form of the components @xmath229 is @xmath230 with the factor @xmath231 .",
    "the langevin approach for solving fokker - planck equations requires a decomposition of the diffusion tensor according to @xmath48 .",
    "the choice of @xmath8 is not unique which reflects somehow the fact that there is more information in a random walk trajectory than needed to solve the fokker - planck equation @xcite . in this chapter",
    "a reasonable method is given which treats the case at hand where the diffusion tensor is a positive definite symmetric 2x2 matrix .",
    "it can be decomposed as @xmath232 where @xmath233 is an orthogonal matrix .",
    "then the diagonal matrix @xmath26 contains the eigenvalues of @xmath234 . introducing another matrix @xmath32 with @xmath235 it follows @xmath236 thus a choice for the matrix @xmath8 is given by @xmath237 , where @xmath32 contains the square roots of the eigenvalues of @xmath234 , which explicitly calculated read @xmath238 the matrix @xmath233 can be calculated as @xmath239 where the norm of the eigenvectors is @xmath240 the explicit form of the matrix @xmath8",
    "is then given by @xmath241 this method has been implemented into the eirene code for determination of the elements of @xmath8 at each time step .",
    "evaluating drift and diffusion coefficients [ diff_coeff_1 ] for purely maxwellian distribution functions of the plasma background in the cylindrical coordinate system at hand yields a singularity in the perpendicular drift coefficient .",
    "thus the present monte carlo procedure has to be supplemented by an implicit method for properly advancing discrete perpendicular velocity increments in time .",
    "the explicit form of the perpendicular drift coefficient written in terms of the potential function @xmath22 only reads @xmath242 , \\label{kper_optimised}\\ ] ] where @xmath243 and @xmath244 without loss of generality , thus @xmath245 .",
    "its singular behavior near @xmath46 is obvious from the taylor series expansion , @xmath246 the normalized perpendicular velocity is formally advanced in one time according to @xmath247 which has been solved implicitly with the first order euler method given by @xmath248 for performing the iterations the derivative of @xmath249 with respect to @xmath250 is required , @xmath251 where the coefficients @xmath252 and @xmath253 are defined as follows @xmath254 the second order newton raphson method is sufficient to solve the actual system which is given by @xmath255 and the well known iteration formulae : @xmath256 the implicitly obtained result for @xmath257 is used to calculate an effective @xmath258 which then overwrites @xmath249 from the explicit scheme .    in practice",
    "it is sufficient to activate the presented implicit method only in case of small values @xmath259 , because the extremely stiff behavior of @xmath67 near @xmath46 changes into a slightly increasing function for more positive values of @xmath260 .",
    "a threshold for @xmath260 can be specified in the input of the code .",
    "this parameter has been set to @xmath261 ( dimensionless ) for performing trace carbon simulations in the mast divertor region .",
    "actually this number depends strongly on the mass difference of the collision partners .",
    "if the test particle is much heavier as the field particle this number should be increased and vice versa .",
    "moreover @xmath262 is a monotonically increasing function without minima and maxima and less than @xmath150 iterations are required in almost any case to reach a sufficient accuracy .",
    "the iteration is currently stopped if the error of the normalized quantity @xmath72 , which is of the order unity , drops below @xmath263 .",
    "the additional computational costs are raised by @xmath69 once the implicit method is activated , but only in this case coulomb collisions are properly treated .",
    "99 r schneider , contrib .",
    "plasma phys .",
    "46 , 2006 s. wiesen , http://www.eirene.de/e2deir_report_30jun06.pdf , 2006 t rognlien et al , contrib .",
    "plasma phys .",
    "34 , 1994 d stotler , c karney , contrib .",
    "plasma phys .",
    "34 , 1994 k shimizu et al , nuclear fusion , vol .",
    "49 , 2009 p stangeby , the plasma boundary of magnetic fusion devices ( institute of physics publishing , 2000 ) s sipila , monte carlo simulation of charged particle orbits in the presence of radio frequency waves in tokamak plasmas ( phd thesis , helsinki university of technology , finland , 1997 ) s sipila et al , contrib .",
    "plasma phys .",
    "42 , 2002 d reiser , berichte des forschungszentrums jlich 3508 , 1998 d reiser , nuclear fusion , vol .",
    "38 , 1998 d reiter , fusion science and technology , vol .",
    "47 , 2005 eirene user manual at www.eirene.de s wiesen , nichtlineare simulation von photonentransport in plasmen ( phd thesis , ruhr universitt bochum , 2005 ) r behrisch and w eckstein , sputtering by particle bombardment : experiments and computer calculations from threshold to mev energies ( springer 2007 ) h summers et al , plasma phys .",
    "fusion 44 , 2002 p brner et al , light sources 2004 , iop conf .",
    "series * 182 , * 407 , 2004 h fehske et al , computational many - particle physics ( lecture notes in physics , springer 2008 ) p helander and d j sigmar , collisional transport in magnetized plasmas ( cambridge university press 2002 ) p e kloeden and e platen , numerical solution of stochastic differential equations ( springer 1992 ) r balescu , transport processes in plasmas ( elvesier science publishers 1988 ) w langer , nuclear fusion , vol . 22 , 1982 s lisgo et al , journal of nucl . mat . ,",
    "vol . 337 , 2005 r k janev , d reiter , phys .",
    "plasmas 9 , 4071 , 2002 r k janev , d reiter , phys .",
    "plasmas 11 , 780 , 2004 b a trubnikov , reviews of plasma physics , vol . 1 , 1965 f s zaitsev , aktualnye voprosky prikladnoi metamatiki , pp . 80 - 87 , 1989 . translated 1991 plenum publishing coorporation b lloyd et al , plasma phys .",
    "fusion , vol ."
  ],
  "abstract_text": [
    "<S> linear kinetic monte carlo particle transport models are frequently employed in fusion plasma simulations to quantify atomic and surface effects on the main plasma flow dynamics . </S>",
    "<S> separate codes are used for transport of neutral particles ( incl . </S>",
    "<S> radiation ) and charged particles ( trace impurity ions ) . </S>",
    "<S> integration of both modules into main plasma fluid solvers provides then self consistent solutions , in principle . </S>",
    "<S> the required interfaces are far from trivial , because rapid atomic processes in particular in the edge region of fusion plasmas require either smoothing and resampling , or frequent transfer of particles from one into the other monte carlo code . </S>",
    "<S> we propose a different scheme here , in which despite the inherently different mathematical form of kinetic equations for ions and neutrals ( e.g. fokker - planck vs. boltzmann collision integrals ) both types of particle orbits can be integrated into one single code . </S>",
    "<S> we show that the approximations and shortcomings of this `` single sourcing '' concept ( e.g. , restriction to explicit ion drift orbit integration ) can be fully tolerable in a wide range of typical fusion edge plasma conditions , and be overcompensated by the code - system simplicity , as well as by inherently ensured consistency in geometry ( one single numerical grid only ) and ( the common ) atomic and surface process modules . + this is a pre peer reviewed version which has been submitted to computer physics communications </S>"
  ]
}