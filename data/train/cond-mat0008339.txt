{
  "article_text": [
    "many macroscopic material properties can only be understood by a thorough investigation of the microscopic details . to obtain information on a macroscopic level from microscopic input",
    ", computer simulation is , in principle , a proper way .",
    "the approach is illustrated in fig .",
    "[ comp - path - all ] . taking all available information ( e.g.  quantum chemistry calculations or experimental data )",
    "one builds a force field : a mathematical function playing the role of an effective potential energy which is the basis of all molecular simulations . depending on the specific question",
    "one is interested in ( e.g.  structural or thermodynamic properties , statics or dynamics ) , one chooses the appropriate method ( e.g.  monte carlo ( mc ) or molecular dynamics ( md )  @xcite ) to get meaningful results .",
    "this paper discusses nonbonded interaction parameters and how to obtain them in an efficient way , which represents one important step in the multiscale modeling of materials .",
    "the new idea is to optimize the simulation parameters with respect to structural distribution functions .",
    "our main interest are macromolecular materials where computer simulations encounter two general problems : on the one hand , to cover a wide range of length and time scales , and on the other hand the force field development .",
    "firstly , it is almost always necessary to span a wide range of length and time scales in polymer simulations .",
    "atomic bonds on the ngstrom - scale are of interest as well as the diffusion of whole chains of typical extensions of the order of some 100  .",
    "bond vibration times are of the order of @xmath0 s while the decorrelation time of end - to - end vectors in entangled polymer melts is of the order of microseconds .",
    "it is therefore not feasible to perform full - detail atomistic molecular dynamics simulations to obtain macroscopic bulk properties of polymers .",
    "the detailed treatment of the fast modes would slow down the run time so strongly that the slow modes can not reach equilibrium .",
    "in addition , the atomistic details sometimes obscure the interesting properties . secondly , it is not trivial to find an appropriate force field for the investigation of specific properties , no matter if we deal with the atomistic or mesoscopic level .",
    "it was not until recently , that the brute force `` trial - and - error '' approach was the only choice : repeatedly guessing a set of parameters , one tries to reproduce some well - known properties of the system.@xcite modeling the intermolecular interactions by lennard - jones ( lj ) potentials , thermodynamic properties like the density ( mostly influenced by the lj @xmath1 ) or the heat of vaporization ( mostly influenced by the lj @xmath2 ) are common test observables .",
    "since it is _ a priori _ unknown how physical properties depend on some model parameters , much nursing and human intuition is required to generate a force field by hand . in this contribution",
    ", we try to tackle both problems .",
    "the development of coarse - grained potentials as well as the automatic force field refinement procedure proper .",
    "targeting the first problem , some coarse graining ( cg ) approaches have recently been developed to side - step the scaling problem.@xcite they are all similar in spirit : by some method , a polymer will be mapped onto a less detailed ( ` coarser ' ) level .",
    "thus , by integrating out the fast degrees of freedom on the atomistic scale , the computational task of relaxing the slow degrees of freedom becomes feasible .",
    "greater time and length scale properties become accessible and , hence , more information of the entropy - dominated mesoscale regime can be obtained to derive macroscopic physical effects . technically , the various cg methods are very different .",
    "some examples are the ` time coarse graining',@xcite lattice approaches like the bond fluctuation model@xcite or the high coordination lattice.@xcite on a larger length scale , dissipative particle dynamics ( dpd ) and smoothed particle dynamics ( sps ) are frequently used to tackle hydrodynamic problems.@xcite for our purposes , an ideal cg method would have the following features : first , it would start from an atomistic , full - detail polymer model ( typical length scale of bond lengths : a few ngstroms ) .",
    "second , a suitable mapping procedure to a meso - level ( typical length scale of one or a few monomers : some 10  ) in continuous space would be needed .",
    "it would take away some atomistic details of the polymer but not its identity .",
    "therefore , third , it would allow for a unique remapping to the full - detail level at any stage of the simulation .",
    "the whole procedure would have the advantage that the entropy - driven modes on larger scales and the energy - driven modes on very local scales are treated separately , reducing cpu time and loads of disk space filled with unwanted data on the local structure .",
    "such a procedure was successfully implemented for polycarbonate ( pc ) melts.@xcite it was tested for three different pc modifications and the resulting microscopic structure compared well to neutron scattering data.@xcite    targeting the second problem of force field development , automatic methods have recently been developed to reduce the human effort during the optimization procedure .",
    "norrby and liljefors  @xcite applied numerical newton - raphson and simplex algorithms to fit simultaneously experimental and quantum chemical data for ethane in the macromodel software package .",
    "a combination of genetic algorithms and neural networks was successfully used to construct a force field for tripod metal templates ( ` tripodm').@xcite the network is trained on a data base containing experimental structural information .",
    "another early idea was to use a modified berendsen weak - coupling method for automatic parameter adjustment:@xcite by coupling the time derivative of a force field parameter to the deviation of the actual value of the target observable , the method could be successfully established in the case of liquid mercury and spc water .",
    "however , its applicability is limited to cases in which there is a monotonic relationship between force field parameter and observable .",
    "della  valle et al .",
    "@xcite use a simplex method to optimize the intermolecular potential of md simulations automatically from ab initio computer simulations of hydrogen fluoride in the liquid phase .",
    "the fit is made against the ab initio potential energy of the dimer .",
    "we also applied a simplex optimization scheme in md simulations : ref .",
    "used thermodynamic properties ( density and heat of vaporization ) to derive force fields for atomistic simulations . in the context of scattering experiments ,",
    "some ideas similar to those developed in this work are applied for interpreting experimental data , e.g. structure functions from neutron scattering , from which one aims to derive the atomic distributions ( so - called reverse mc@xcite and empirical potential mc@xcite ) .",
    "historically , force fields have rarely been constructed by automatic methods so as to reproduce larger - scale structural properties .",
    "typically , parameters are chosen by fitting to details such as bond lengths or angles . in this work ,",
    "we select an observable property which characterises the overall structure and then to automatically optimize a set of parameters .",
    "we concentrate on the problem of finding an inter - particle potential energy function which yields a desired radial distribution function ( rdf ) over the course of a simulation .",
    "the desired rdf is one that is deemed more reliable , typically from experiment or a higher level calculation such as an atomistic simulation .",
    "furthermore , we are particularly interested in exploring the limits of spherical , non - directional interaction functions since these are fastest to calculate .",
    "fits are performed using a simplex method , previously used to develop atomistic force field parameters.@xcite it turns out that much thought has to be given to the functional form of the inter - particle potential .",
    "these technical details are explained in section ii . as a test case ,",
    "we attempt to reproduce the rdf of a lennard - jones liquid with various functional forms of the test potential ( section iii ) . in section iv",
    ", we discuss the application of the method to several real complex liquids which show some variation in chemical structure .",
    "note that in this paper , we restrict ourselves to the nonbonded part of force fields and its optimization procedure using low molecular weight liquids as test systems .",
    "additional aspects which arise due to the connectivity of large macromolecules will be addressed in a separate publication.@xcite",
    "we are dealing with a so - called inverse problem : search for an inter - particle potential which reproduces a given radial distribution function used as the target function . to do this automatically",
    ", we need three technical ingredients : ( i ) specification of the functional form of the potential and the parameters to be optimized , ( ii ) evaluation of the quality of the test potential , i.e.  description of a merit function defining a hyper surface in the parameter space which has to be minimized , and ( iii ) rules to modify the test potential to obtain a better fit of the target function .",
    "while the latter two points are rather technical and easy to implement , the specification of the functional form of the inter - particle potential turns out to be of utmost importance . before going into details , we want to note some practical constraints : the evaluation of each test potential is quite expensive , since it requires the simulation of a test system ensuring equilibration and sufficient statistics for the evaluation of the target quantities .",
    "we have to avoid scanning all parameter space to locate the optimum potential and instead use an automatic optimization algorithm .",
    "it is practically impossible to have analytical or reliable numerical derivatives of our merit function .",
    "this excludes many optimization methods leaving us with the simplex algorithm as one of the most basic algorithms , which is robust and easy to implement .",
    "a first brute - force approach would be to give a general expansion of the nonbonded interaction potential .",
    "the coefficients would then be found by the optimization algorithm",
    ". however , this straight - forward approach fails in practice , since there are often too many parameters to optimize .",
    "in addition , there is usually no easy functional dependence between parameters and target function ; the optimization algorithm will often be trapped in local minima .",
    "this means that one needs physical intuition for specifying an inter - particle potential in such a way that the parameters control the potential in a meaningful way .",
    "besides this physical aspect , there are some more technical points determining the choice of a potential in computer simulations .",
    "first , it should be easy and fast to evaluate , second , it should have a simple analytical form , being continuous and differentiable .",
    "finally , it is also desirable that it has a physical interpretation with some theoretical understanding .",
    "because of technical simplicity , we chose a spherically symmetric potential . using non - spherical , directional potentials ( like ellipsoids ) leads to an unwanted increase in computer time and program complexity without major improvements .",
    "if the molecule under consideration is actually aspherical , it is often cheaper to model it by two or three spheres than to introduce one ellipsoid .",
    "the experience with the systems reported in this work shows that spheres can manage most problems .",
    "in addition , a case study for polycarbonates comparing spherical versus ellipsoidal beads shows that some results are even better reproduced with spheres.@xcite    standard spherical potentials used in computer simulations are the lennard - jones 612 potential @xmath3 or the buckingham exp6 potential : @xmath4 the only term with a physical justification is the attractive dispersion term in @xmath5 resulting from the interaction of induced dipoles . there is also some justification for the exponential repulsion coming from the limiting behavior of atomic wave functions at large distances . in general , the repulsive part has no physical justification except that the potential has to be strongly repulsive at short distances due to the pauli exclusion principle . for modeling larger molecules or monomers of polymer chains one needs , in most cases , a potential whose repulsive part is softer than the standard lj612 potential .",
    "for example , one might replace the exponent 12 in the lj potential by a smaller integer ( still greater than 6 ) to model a softer core .",
    "however , such a simple two - term potential appears to be not sufficient if one wants to reproduce more refined structures of rdfs as we found in our studies .",
    "we therefore turn to the following general ansatz for the nonbonded potential : @xmath6 this form includes the standard model potentials ( [ e : potlj ] ) and ( [ e : potexp6 ] ) , but one has more degrees of freedom allowing to create softer potentials while keeping the @xmath5 term as the longest - range interaction .",
    "note that in none of the problems studied here , we use all of eq.([e : potraw ] ) simultaneously .    for our kind of problem",
    ", it is difficult to adjust more than 45 free parameters at once in reasonable computer time because each set of parameters needs a full md simulation run.@xcite hence , a choice of some parameters is necessary .",
    "it turns out that the form of eq .",
    "( [ e : potraw ] ) is not suitable for optimization by varying directly the parameters @xmath7 .",
    "it is advantageous to rewrite the potential @xmath8 with parameters varying it in a defined way , with meaning attributed to at least some of them .",
    "the lj6 - 12 potential , for example , is usually written in the form ( [ e : potlj ] ) with @xmath1 being the approximate diameter of the excluded volume and @xmath9 the depth of the potential minimum .",
    "a similar interpretation can be found with other two - term potentials .",
    "it is not so straight - forward to rewrite expansions with more terms into a useful form .",
    "we propose here a four term potential 6 - 8 - 10 - 12 which was quite successful for the description of very broad rdfs : @xmath10 where the coefficients @xmath11 and @xmath12 of eq .",
    "( [ e : potraw ] ) have been rewritten in terms of new variables @xmath13 , and @xmath14 .",
    "this parameterization was constructed such that for @xmath15 the three parameters @xmath16 give the location of the maxima and minima of the potential ( see the appendix for the details of the derivation ) . for @xmath17 and @xmath18 , @xmath19 and @xmath20",
    "are the locations of minima and @xmath21 is the location of the maximum in - between . for @xmath22 or @xmath23",
    ", there is a saddle point at @xmath24 .",
    "some examples are sketched in fig .",
    "[ f : potmm ] . in most cases",
    ", one does not want to have two minima in the potential but only one minimum which is broader than in the lj6 - 12 case .",
    "this can be achieved by increasing the coefficient @xmath14 of the repulsive @xmath25 term .",
    "a value slightly above 0.5 is usually sufficient as one can see in the discussion of the results . with this approach ,",
    "one can obtain two different repulsive regimes : a strongly repulsive part below @xmath26 which marks the hard core and a weakly repulsive regime representing a softer shell ( see for example fig .",
    "[ f : rdfiso ] in sec .",
    "iv a ) .    at first sight , the analytical form ( [ e : potraw ] ) seems to fulfill all needs .",
    "unfortunately , this is not always the case as we will show during the application to real molecules . for systems where the first shell peak of the rdf has some complicated structure ,",
    "a potential constructed of piecewise different functions is more useful ( see fig .  [",
    "f : potpiece ] ) : @xmath27 the first part is a repulsive lj68 potential up to @xmath28 to model the core of excluded volume of the particle . the second and the third part are again repulsive , with force minima at @xmath29 and @xmath30 .",
    "this yields an rdf with a first peak or a shoulder at @xmath29 and a second one above @xmath30 .",
    "one might omit the second part by setting @xmath31 and @xmath32 . whether there appear two peaks or one peak and a shoulder depends on @xmath33 and the size of the interval @xmath34 $ ] .",
    "the fourth term is optional and provides an attractive part .",
    "this influences usually the width of the first - shell peak of the rdf .",
    "the whole potential was shifted such that @xmath35 .",
    "the cosine potentials have the nice property that their derivative ( the force ) vanishes at @xmath36 and @xmath37 .",
    "this ensures that the forces are continuous at the cutoff distance .",
    "however , the force is discontinuous at @xmath28 .      for the automatic optimization , a prescription is needed to get a number measuring the quality of the radial distribution function ( rdf ) of a test potential .",
    "we use the squared difference between the simulated rdf @xmath38 and the target rdf @xmath39 integrated over an appropriately chosen interval @xmath40 $ ] , optionally weighted with some weighting function @xmath41 @xmath42 this merit function @xmath43 is zero for perfect agreement and the more positive the worse the agreement .",
    "( [ e : fi ] ) defines the hypersurface in the parameter space which has to be minimized .",
    "( in optimization theory one often speaks of a potential surface ",
    "we avoid this term since the name ` potential ' is used for the input parameter . ) the weighting function @xmath41 in eq .",
    "( [ e : fi ] ) was chosen to be a decaying exponential @xmath44 to penalize stronger deviations at small separation ( @xmath1 being the typical unit length of the system ) . however , after the experience of this work we expect that this weighting is not so important since contributions in the excluded volume region are naturally large if the first shell peak is at the wrong position",
    ". note also , that this merit function can not give an absolute quality value since there is no unique way of normalization .",
    "it depends always on the given problem what threshold value separates `` good '' from `` bad '' quality .",
    "one can include other quantities as the deviation from a target pressure or other thermodynamic quantities as additional terms in ( [ e : fi ] ) . in principle",
    ", the rdf contains all information about the system .",
    "however , there are many reasons like finite size , truncation of potentials , or simply convergence behavior which make it useful to enforce thermodynamic properties independently .",
    "the simplex algorithm is a multi - dimensional optimization procedure.@xcite it allows for maximum generality in the merit function as it does not use derivatives . in our case",
    "this is useful , since the actual function is not even known . as there",
    "exist many descriptions of this algorithm , we present only a brief review .",
    "a simplex is a set of @xmath45 points in a @xmath46-dimensional parameter space .",
    "any subset with @xmath46 of these points must be linearly independent .",
    "one has to set up a starting simplex which should cover approximately the region where the optimum is expected .",
    "after evaluation of these initial points , the actual simplex algorithm starts ( see fig .  [",
    "f : simplexmoves ] for a two - dimensional illustration ) .",
    "all but the worst point ( largest merit function value @xmath43 ) define a hyper - plane through which the worst point is reflected .",
    "depending on the evaluation of this new point a further expansion into the promising direction , nothing or a ( one - dimensional ) contraction to the `` safe '' hyper - plane is performed .",
    "if none of these leads to an improvement , a @xmath46-dimensional contraction is performed by moving all but the best point towards the best .",
    "this procedure is iterated until the merit function of the best point falls below a given threshold value .",
    "the iteration might also be stopped if the simplex becomes too small or after a user defined maximum of iteration steps is exceeded . in these two cases",
    "the optimization has failed .",
    "one might restart it with different starting points .",
    "one function evaluation step consists of an entire md simulation with the potential defined by the simplex point in parameter space .",
    "this is quite expensive since one needs some time to reach an equilibrium configuration with respect to the given potential and a certain time of simulation in equilibrium to have a sufficiently large statistical basis for the evaluation of the target quantities .",
    "the examples presented in this paper were run on dec - alpha workstations where one simplex step with 400 cg beads typically needs one hour of cpu time .",
    "let us finally mention a technical difficulty appearing in the first equilibration stage .",
    "one has to give a start configuration of particle positions . for this",
    ", we chose the final configuration of a run whose potential parameters are closest to the new ones . in most cases ,",
    "this reduces the simulation time needed for equilibration .",
    "however , if the repulsive part of the new potential is stiffer than for the potential with which the start configuration was produced , there can be some particles which are so close to each other that they are deeply in the excluded volume region with respect to the new potential .",
    "this can lead to numerical problems which manifest themselves usually by divergence of the md integrator .",
    "therefore we introduced short pre - equilibration runs with a much shorter time step and an upper bound for the inter - particle forces to circumvent program failures due to floating point errors .",
    "as a first test case , we performed simulations of a standard lj6 - 12 potential with @xmath47 , i.e.  @xmath8 of eq .",
    "( [ e : potraw ] ) with @xmath48 and @xmath49 , all other parameters being zero",
    ". a cutoff distance of @xmath50 was imposed for the potential interaction .",
    "the system contained 400 particles at constant density @xmath51 in a cubic box with periodic boundary conditions .",
    "the temperature @xmath52 @xmath53 was maintained by a langevin - thermostat with friction constant @xmath54 . from this simulation",
    "we get an rdf which is used as target function in the following .",
    "the simulations for the optimization process are run under the same conditions except , of course , that the potential is modified .",
    "the purpose of this section is to find parameters of the buckingham exp-6 potential which reproduce best the rdf of a lj6 - 12 potential with @xmath47 . the buckingham exp-6 potential ( [ e : potexp6 ] ) is obtained from the general form eq .",
    "( [ e : potraw ] ) by setting @xmath55 . using the remaining three parameters @xmath56 as simplex parameters may lead to problems because the potential is extremely sensitive to these parameters .",
    "small changes yield a potential which is completely unphysical or give problems with equilibrating the simulation .",
    "( note that the exp-6 potential has an unphysical asymptotic behavior for @xmath57 . during simulation ,",
    "this regime is usually never reached since it is separated by an energy barrier high of many @xmath58 . during optimization",
    ", however , a set of parameters might be chosen for which the repulsive barrier is not large enough . )",
    "one can rewrite the exp-6 potential in the form @xmath59 ) + [ r/\\sigma]^{-6 } \\right)\\ ] ] to have global scaling parameters @xmath9 and @xmath1 for the energy and the distance respectively .",
    "of course , this yields a redundant fourth parameter , and in the following , we always set @xmath60",
    ".    a start simplex is constructed by least - squares fitting @xmath8 to the lj6 - 12 potential in different regions .",
    "this yields already points with a very good agreement of the rdfs , see first block in table [ t : exp6 ] .",
    "note that this way of obtaining start parameters is only feasible if one already has a functional form of the potential and one only searches for a different parameterization .",
    "the integral in the merit function @xmath43 was evaluated on 70 equidistant bins up to @xmath61 , we chose as a convergence threshold 0.001 .",
    "there are some jumps during the first 10 optimization steps , afterwards the algorithm converges very quickly to merit function values between 0.0015 and 0.0025 and very small variation in the parameters optimized by the simplex algorithm .",
    "in fact , the statistical precision of our target rdf as well as of the simulated optimization steps was not sufficient for so small differences .",
    "the best value appeared already after 28 steps ( out of 100 ) .",
    "the corresponding rdf can not be distinguished from the target rdf by visual inspection .",
    "interestingly , the potential coincides only in the repulsive part , being slightly different in the attractive region ( see fig .",
    "[ f : rdflj ] ) .",
    "this reflects the well - known fact , that for dense liquids , the repulsive part of the potential is the most important for determining the structure.@xcite the pressure is positive and about 30% higher than in the lj6 - 12 reference system .    to test the capabilities of the simplex algorithm with less perfect starting points",
    ", we chose starting values which fitted the buckingham - potential to a lj6 - 12 potential with @xmath62 ( see block ( b ) in table [ t : exp6 ] ) .",
    "after about 20 optimization steps , the optimized parameters showed very little variation and the optimization was stopped after 45 steps .",
    "the best values according to the merit function are also given in table [ t : exp6 ] .",
    "in this case , the simplex algorithm is trapped in a local minimum which is not as good as before . nevertheless , if one keeps in mind that the starting values were completely off , the agreement of the rdfs is already quite good ( see circles in fig .  [",
    "f : rdflj ] ) . in contrast , the corresponding potential is completely different with a less pronounced minimum .",
    "this means , that the rdf is more a result of the constant volume constraint than of the specific form of the potential .",
    "this would probably be different if one performed simulations in the npt ensemble . in this case",
    "one should include the density as a target value in the merit function similarly to ref .  . here",
    ", the nvt ensemble was chosen to impose the correct density so that the optimization has only to deal with the structure .",
    "next we try to find out how good one can approach the rdf of the lj6 - 12 potential with @xmath47 if we set the repulsive exponent to 9 ( see fig .  [",
    "f : lj69 ] ) .",
    "table [ t : lj69 ] shows the parameters and the merit function value of a rather bad start guess .",
    "the quality does not significantly change after 20 steps .",
    "after 3 restarts an acceptable parameter set is found in a quite different region of parameter space .",
    "note that the pressure for the system with this potential is much lower than in the lj6 - 12 reference system .",
    "the curves marked 6 - 9 in fig .",
    "[ f : lj69 ] correspond to it .",
    "[ f : path69 ] shows the points in the parameter space which were visited during the simplex optimization process during the 4 runs .",
    "( run1 ) has the largest jumps whereas the following runs show less variation .",
    "the figure allows us another interesting observation : the simplex often ends up on a line .",
    "this can happen easily for 2-dimensional optimization runs , when no new point can be found which is better than the best two points .",
    "it means that the best two points are on the bottom of a valley and the worst point is reflected from one side to the other with respect to this valley .",
    "this effect will increase when the differences in the merit function are more due to statistical variations than to systematic dependence on the test potential .",
    "we now propose a potential with more free parameters in which the original potential is contained to see if the automatic optimization finds back the correct form .",
    "we use the four coefficients @xmath63 ( @xmath64 ) as parameter of the simplex optimization , starting with an arbitrary guess of a very bad simplex : after about 30 steps , the simplex is trapped in a local minimum .",
    "the potential parameters as well as the quality of the rdf do not vary substantially . in fig .",
    "[ f : rdflj ] , the rdf and the potential # 99 are plotted .",
    "the pressure of this system is about twice as high than in the lj6 - 12 reference system .",
    "the lj6 - 8 - 10 - 12 potential has a much shallower minimum than the original lj6 - 12 potential .",
    "this means that the rdf must be due in part to the constant - volume condition , just like in the case of the buckingham potential .",
    "when one restarts the optimization with starting values closer to the lj6 - 12 values , the success is much better , which is not so surprising ( see block ( b ) in table [ t : lj681012 ] ) . in this case , the simplex algorithm did not start because points 1 and 3 were already below the threshold of 0.01 ; the corresponding rdf is indistinguishable from the target rdf .      in this section",
    ", we reported the first experiences of optimizing an inter - particle potential to fit structural distribution functions .",
    "these test runs show that our implementation of the automatic simplex optimization works well and that the optimization with respect to distribution functions is possible .",
    "nevertheless , some pitfalls already appeared : the simplex algorithm works best when the optimum value is inside the starting simplex . in our implementation ,",
    "the algorithm is able to find an optimum outside .",
    "however , if the simplex becomes too large , it is not very efficient and it becomes likely to fall into a local minimum which is not the best one .",
    "one has to be careful with 2-dimensional simplices .    on the physical side",
    ", we observe that one can get the rdf approximately right with completely different potentials . to some extent",
    ", this is due to the fact that most of the rdf is determined by the repulsive part of the potential .",
    "this effect is enforced by the constant - volume constraint .",
    "the success of the preceding section is not too surprising since the original system , the lennard - jones 6 - 12 liquid , is more or less contained in the fitting potential .",
    "we discuss now three real molecular liquids with increasing complexity ; their chemical structures are shown in fig .",
    "[ f : mols ] .",
    "the target function is always the center - of - mass rdf ( cm - rdf ) obtained from atomistic simulation data .",
    "the first approach is always to model the whole molecules by one bead with a spherically symmetric potential . in the third case of dpc which is very aspherical ,",
    "we report results with alternative models comprising two or three beads per molecule .",
    "the systems were chosen because they are important in ongoing research projects in our laboratory .",
    "they also represent some variation in chemical structure .      as the first `` real '' system we discuss a liquid of isoprene pseudo monomers .",
    "the ultimate aim is to study trans - poly(isoprene ) with one bead per monomer . in order to develop a coarse - grained potential for these monomers",
    ", we performed atomistic simulations with 200 monomers at room temperature ( @xmath65 k , @xmath66 hpa ) .",
    "the force - field parameters of these all - atom simulations were the same as derived for the simulation of trans - poly(isoprene ) in ref .   where the internal rotation parameters have been obtained by quantum chemistry calculations .",
    "the pseudo monomers are obtained by cutting the polymeric backbone at the double bonds ( dashed bond in fig .",
    "[ f : mols ] ) .",
    "the dangling bonds where the polymeric backbone would go on are not considered in the simulation .",
    "the cut was placed at the double bond because the distribution of bond lengths and bond angles of the resulting cg - chain are sharper and exhibit less correlation than for a cut at the ch@xmath67ch@xmath67 bond .",
    "this is advantageous for the construction of cg force fields of a polymer chain which is not further discussed in this paper . from the simulation of the atomistic monomer liquid we obtain a target cm - rdf which is used in the following optimization ( see thick continuous line in fig .",
    "[ f : rdfiso ] ) .",
    "it clearly shows a liquid structure with the first peak much softer than that of a lj liquid .",
    "the cg - simulations were performed with 400 spherical particles at constant volume using the same program as in sec .",
    "the particle number density was fixed to match the density of the atomistic simulations ( 817 kg / m@xmath68 ) .",
    "the cutoff radius for the nonbonded interactions was 1.26 nm .",
    "in this case the 6 - 8 - 10 - 12 potential proved to be successful ( see fig .",
    "[ f : rdfiso ] ) .",
    "the final potential exhibits two repulsive regimes : a very large slope below 0.35 nm marking the hard core and a much smaller slope above this value which leads to the broad first peak . the successful potential was found with the parameterization ( [ e : potmm ] ) and has the parameters @xmath69 kt , @xmath70 nm , @xmath71 nm , and @xmath72 . the simplex algorithm was restarted twice and altogether about 200 simplex steps have been performed . the pressure of the system with the best fitting rdf is positive and about twice the pressure of the lj6 - 12 reference system of the preceding section .",
    "this example demonstrates the technical capability of the algorithm to generate a coarse - grained potential for a complex molecular fluid .",
    "physically , however , the obtained potential might be not very useful for the simulation of polymers because of different densities of the polymer melt and the pseudo - monomer melt due to overlap or end effects .",
    "one should also note that in the atomistic model the appearance of two different repulsive regimes ( which causes the broad first peak of the rdf ) is due to the oblate geometry of the molecule .",
    "it allows two molecules to approach each other from different directions which have different effective exclusion radii .",
    "this information is not contained in the coarse - grained potential which is spherically symmetric .",
    "hence , even though the coarse - grained potential reproduces the rdf , it may be inappropriate when the anisometry of the molecule is important .",
    "similar caveats hold for e.g.  the model of thf discussed in the next paragraph .      the common solvent tetrahydrofurane ( thf ) , for which an atomistic force field was developed in ref .  ,",
    "is proposed as a second example of a molecular liquid .",
    "the target rdf was obtained with the final force field from the simulation of that reference ( ambient conditions : @xmath73 k , @xmath66 hpa ; density @xmath74 kg / m@xmath68 ) .",
    "this cm - rdf has almost the form of a simple fluid s rdf except the small tip on the first shell peak ( see the thick line in fig .",
    "[ f : rdfthf2 ] ) .",
    "careful examination of the atomistic data shows that this tip can be attributed to some fraction of t - shaped configurations of two neighboring thf molecules in contrast to a parallel alignment .",
    "however , the center of mass distances for different relative orientations are only slightly larger and do not result in a detached second peak .",
    "our question was again if one can design a coarse - grained model with simple spheres which reproduces this cm - rdf .",
    "obviously , a standard lj6 - 12 potential will not work since there is no structure in the potential minimum .",
    "so we started with the 6 - 8 - 10 - 12 potential which can yield some structure on the first shell peak .",
    "however , the produced peaks are too far away of each other to reproduce the tiny feature at @xmath75 nm on the cm - rdf of thf ( not shown ) .",
    "after lengthy trials , it turned out that potential ( [ e : potmm ] ) is not adapted to this problem .",
    "we next tried to model the thf molecule by three lj6 - 12 beads to account for its slightly disk - like structure .",
    "the beads are connected by harmonic bonds with a quite stiff spring constant , a harmonic angle potential with the equilibrium angle 120@xmath76 , and their excluded volume is strongly overlapping ( inset in fig .",
    "[ f : rdfthf2 ] ) .",
    "two beads are supposed to be identical , the third one might have different parameters ( @xmath1 and @xmath9 ) .",
    "we chose the following four parameters for the simplex optimization : @xmath77 , @xmath78 , @xmath79 , and @xmath80 .",
    "[ f : rdfthf2 ] shows some typical rdfs obtained during this cg - optimization which are not much better than the rdfs from the 6 - 8 - 10 - 12-potential .",
    "they always reproduce only some feature of the target rdf , e.g.  the starting slope of the rdf , the position of the first sharp peak , the position of the second half of the first peak , or an average of the first peak .",
    "often , the simplex optimization is stuck with a purely repulsive potential .",
    "some sharper structure could be obtained on the first peak , but the corresponding samples were frozen in an amorphous state with enormous pressure ( about 10 times the pressure of the lj6 - 12 reference system ) .    in principle , the 6 - 8 - 10 - 12 potential for one - bead models is able to have a saddle point or a second minimum which should lead to at least a shoulder in the rdf .",
    "however , this potential is still not of sufficient generality to account for the location of the extrema and the potential value as well as of the width of the extrema .",
    "this is not only a problem of our parameterization but of the potential form in general where the first minimum is always much narrower than the second one due to the @xmath5 factor dominating at small distances .",
    "this led us to developing a piecewise defined potential by modeling the potential minimum by a sequence of different cosine terms .",
    "( [ e : potpiece ] ) gives the form which was finally successful with the following parameters for thf : @xmath81 kt , @xmath82 nm , @xmath31 , @xmath83 kt , @xmath84 nm , @xmath85 nm . the potential and the corresponding rdf are shown in fig .",
    "[ f : rdfthf5 ] . with this potential , thf could be described by one single bead .",
    "the pressure of this system is positive and only slightly larger than in the lj6 - 12 reference system .",
    "diphenyl carbonate ( dpc ) is a test case for a complex liquid of highly anisotropic molecules .",
    "its cm - rdf is taken from atomistic simulations of ref .   at 393 k. in all optimization steps",
    ", we fixed the particle number density to the value of the atomistic simulations which is 3.04 molecules per nm@xmath68 .",
    "the simplest approximation is to model the dpc molecule by one spherical bead .",
    "one might think that this can not work at all , since the molecule is really not spherical , but , using the 6 - 8 - 10 - 12 potential in the parameterization ( [ e : potmm ] ) , one can at least reproduce the qualitative features as shown in fig .",
    "[ f : rdfdpc1 ] ( squares ) .",
    "the corresponding potential is also shown as dotted line : it exhibits a shoulder for the first small peak .",
    "the parameters of the shown potential are @xmath86 kt , @xmath87 nm , @xmath88 nm , @xmath89 nm , and @xmath15 . in this optimization run , we fixed @xmath90 and @xmath14 .",
    "we performed about 20 restarts of the simplex algorithm with different start values and different sets of parameters fixed but we could not get a result with more than only qualitative coincidence of the rdfs .",
    "this leads us to the conclusion that the parameterization ( [ e : potmm ] ) is not suited for producing a larger spacing between the first two peaks . trying potentials with the second minimum at larger distances , the particles stay where they are because they are pushed into the repulsive regime due to the fixed volume",
    "this problem arises because the 6 - 8 - 10 - 12 potential is not flexible enough .",
    "as one can see already in fig .",
    "[ f : rdfdpc1 ] , a solution is found with the piecewise potential already used in the preceding section .",
    "it allows a much softer core .",
    "this makes it possible to reproduce the cm - rdf with only one spherical bead much better . in this case",
    ", we defined a purely repulsive potential with the parameters @xmath91 kt , @xmath92 nm , @xmath93 , @xmath94 kt , @xmath95 nm .",
    "the pressure in this system is about 50%  larger than for the 6 - 8 - 10 - 12 potential plotted in the same figure . to improve the model",
    ", we used a two - bead molecule which seems to be a more natural attempt for modeling dpc .",
    "the two beads are connected by a harmonic bond with a force constant allowing 10%  variation of bond length .",
    "we performed optimization of the lj-@xmath1 with different bond lengths .",
    "this yields the qualitative features of the pre - peak shoulder , but , again , the distance of the two peaks is too small as one can see in fig .  [",
    "f : rdfdpc2 ] ( squares ) . to get a larger spacing of the two peaks",
    ", we needed to increase the bond length between the two cg beads .",
    "however , the bond length had to be so long that molecules could pass through each other .",
    "this yields an unwanted and unphysical peak in the center of mass rdf at @xmath96 ( circles in fig .",
    "[ f : rdfdpc2 ] ) . to avoid this",
    ", we inserted a third particle to enforce some excluded volume in the center of the molecule . during optimization , the lj-@xmath1 of the inner bead was allowed to have another value than for the two outer beads . for the bond between an outer and an inner bead lengths from 0.33 to 0.43 nm were tried . to keep the three beads aligned",
    "we added a stiffening potential with its equilibrium at 170@xmath76 and force constant @xmath97 kt / rad which corresponds approximately to the angle distribution found in the atomistic simulations .",
    "this , eventually , yields a good correspondence of the rdfs as shown in fig .",
    "[ f : rdfdpc3 ] .",
    "the pressure in the shown multi - bead systems is about twice as high as in the one - bead models of dpc .",
    "we started several optimization runs with different bond length .",
    "the free parameters during these optimization runs were the lj-@xmath9 and the lj-@xmath1 for the inner and the outer beads .",
    "the best fit was found for bond length of 0.43 nm and almost the same lj - sigma for all three beads .",
    "looking directly at the molecular dimensions , one gets some different values : the distance from the phenyl ring centers to the central carbon is 0.36 nm and the diameter of a phenyl ring is approximately 0.6 nm .",
    "this difference is not surprising since the phenyl rings are not spherical but more oblate objects .",
    "the optimization shows that this effect on the cm - rdf is best reproduced by smaller spheres at a larger distance .",
    "the perfect agreement of the rdfs in fig .",
    "[ f : rdfdpc3 ] therefore shows that the peculiar features of the cm - rdf of dpc simply follow from its shape .",
    "we reported in this work the construction of coarse - grained models of molecules which are optimized with respect to their radial distribution function .",
    "we implemented an automatic optimization scheme using the simplex algorithm which was applied to several complex liquids .",
    "several conclusions can be drawn .",
    "the simplex algorithm is a useful tool for finding and optimizing coarse - grained models against certain target quantities .",
    "not only single numbers but whole distribution functions can be used as target quantity .",
    "however , the automatic procedure still needs a lot of supervision .",
    "a good first guess of the adjustable parameters is needed , otherwise the algorithm is trapped in local minima which often are not of acceptable quality .",
    "the method works best if one has good start parameters .",
    "if there is no reasonable guess from the construction of the coarse - grained geometry , one possibility to obtain such start parameters is to fit the test potential to the potential of mean force @xmath98 .",
    "however , this works only for sufficiently simple liquids .",
    "in fact , the potential of mean force is the result of pair interactions as well as of many - particle interactions of higher order . as the latter are not negligible , the potential of mean force used as approximation of a pair potential will not lead to satisfying results .",
    "this is especially the case for aspherical molecules as thf and dpc where the structure of the cm - rdf is due to some directional interactions which are intentionally omitted in the coarse - grained model .",
    "some interesting aspects to this context can also be found in refs .   and where soper developed an empirical potential mc method to derive the atomic positions from neutron scattering data .",
    "it is based on a self - consistent iteration starting from the potential of mean force resulting in an empirical numerical potential .",
    "this approach might be also useful for deriving coarse - grained simulation potentials . in this work",
    ", we still stuck to analytical potentials .",
    "however , with the piecewise potential of eq .",
    "( [ e : potpiece ] ) we gave up any theoretical interpretation which could not also be found in a purely numerical potential .",
    "to avoid being trapped in local minima one could use global optimizers like simulated annealing or genetic algorithms with tabulated potentials .",
    "this , however , is computationally much more demanding . on the other hand , it is often possible to come up with reasonable guesses of the starting values based on knowledge of the system s physics . rewriting the potential expansion in terms of meaningful parameters like in eq .",
    "( [ e : potmm ] ) has already helped much in this respect .",
    "there are also more sophisticated forms or extensions of the simplex optimization algorithm , e.g.  parabolic extrapolation .",
    "these algorithms speed up the final convergence if one is already sufficiently close to the optimum . for our problem",
    ", they are not so useful because , usually , the error bars on the rdf or other target quantities are larger than the precision which could be gained by further optimization steps where these algorithms become faster .    concerning the physical problem addressed in this paper we conclude that one can fit almost any molecular rdf with one particle and an appropriate spherically symmetric potential .",
    "once one has abandoned conditions about differentiability or certain `` nice '' functional forms , there are no limits to the invention of potentials as eq .",
    "( [ e : potpiece ] ) to reproduce funny rdfs . however , restriction to spherically averaged distributions might not be useful for the prediction of other properties .",
    "hence , for molecules with high asymmetry , the combination of two or three spheres might be preferable to model structural properties .",
    "the method could also be used to fit experimental rdfs similar to the spirit of the ` reverse mc ' method .",
    "the cg simulations of our examples where performed in the nvt ensemble .",
    "the constant volume constraint imposes the correct density . for the transferability of the derived potentials ,",
    "however , it will often be useful to apply the pressure as an additional target observable .",
    "this yields an additional term in the merit function similar to ref .  .",
    "we have described a tool for optimizing nonbonded simulation parameters , which , when used carefully , is very useful in force field development .",
    "several examples of complex liquids demonstrate how the method works . for the simulation of polymeric materials discussed in the introduction , we are now working on optimizing polymer force fields where nonbonded parameters are optimized by using oligomers instead of single ( pseudo)monomers . for polymers ,",
    "the connectivity is another important aspect .",
    "it is possible to adjust bonded parameters as bond angle distributions of coarse - grained models by the present approach .",
    "all this will be presented in a separate publication.@xcite",
    "we thank markus deserno , kurt kremer , and heiko schmitz for many discussions and oliver hahn for contributing an md program .",
    "here we sketch a way of rewriting potentials such that the parameters have an obvious interpretation .",
    "the interesting points of a potential are usually the locations of extrema or inflection points and the function values at these points .",
    "the locations are given by the zeros of the derivative of the potential .",
    "we show here the derivation of the example of the 6 - 8 - 10 - 12 potential used in this paper .",
    "it has nice symmetry since only even powers appear , but the idea is also applicable to different expansions .    rewrite the potential in the following way : @xmath99 the derivative of @xmath8 reads @xmath100 we want to know the zeros of the polynomial in the parentheses . since it is complicated to solve a polynomial with degree greater than two and in general impossible for degree greater than four , we choose a constructive way : be @xmath16 the zeros , then @xmath101 is a polynomial having these zeros . in our case",
    ", this gives @xmath102 comparing the coefficients of the polynomial ( [ e : polex ] ) with eq .",
    "( [ e : potderiv ] ) one ends up with @xmath103 which yields the potential form given in equation ( [ e : potmm ] ) .",
    "@xmath104 are the locations of the extrema of @xmath8 , whereof only the positive locations are of physical relevance . in this parameterization ,",
    "the relative height of the extrema and the location of the minima are mutually dependent . to have some more freedom , we chose the coefficient 0.5 of @xmath105 to be a supplementary variable @xmath14 .",
    "f.  mller - plathe , molecular simulation - a primer , in _ problem solving in computational molecular science : molecules in different environments _ , edited by s.  wilson and g.  h.  f. diercksen , volume 500 of _ nato asi series c _ , pages 389412 , dordrecht , 1997 , nato , kluwer academic publishers .",
    "ldddddc @xmath106 & @xmath9 & @xmath1 & @xmath107 & @xmath108 & @xmath109 & interval of fit +   + # 1 & 668.0 & 0.4 & 13700.0 & 6.03 & 0.0082 & 0.8 - 1.5 + # 2 & 794.0 & 0.4 & 3404.0 & 5.45 & 0.0160 & 0.9 - 1.3 + # 3 & 840.0 & 0.4 & 1470.0 & 5.10 & 0.0401 & 1.0 - 1.2 + # 4 & 730.0 & 0.4 & 5635.0 & 5.60 & 0.1124 & 0.9 - 1.1 + # 5 & 624.0 & 0.4 & 17000.0 & 6.10 & 0.0065 & 0.8 - 1.2 +   + # 28 & 656.26 & 0.4 & 14214.5 & 6.026 & 0.0011 +   + # 1 & 163.0 & 0.4 & 14000.0 & 6.00 & 2.2401 & 0.8 - 1.5 + # 2 & 180.0 & 0.4 & 14000.0 & 6.04 & 2.3178 & 0.9 - 1.3 + # 3 & 182.0 & 0.4 & 15000.0 & 5.97 & 1.4783 & 1.0 - 1.2 + # 4 & 170.0 & 0.4 & 15500.0 & 6.10 & 2.6004 & 0.9 - 1.1 + # 5 & 200.0 & 0.4 & 16000.0 & 6.00 & 1.2725 & 0.8 - 1.2 +   + # 35 & 238.73 & 0.4 & 15576.98 & 5.756 & 0.0359 +    ldddd @xmath106 & @xmath110 & @xmath111 & @xmath109 & @xmath112 +   + # 1 & -4.00 & 5.00 & 0.1371 & 2.4 + # 2 & -4.60 & 4.00 & 1.2887 & 0.4 + # 3 & -5.00 & 6.00 & 0.0792 & 2.2 +   + # 12 & -5.125 & 6.125 & 0.0775 & 2.3 +   + # 10 & -5.137 & 6.080 & 0.0700 & 2.2 +   + # 16 & -7.390 & 7.219 & 0.0315 & 0.68 +   + # 17 & -8.260 & 8.100 & 0.0283 & 0.55 +    ldddddc @xmath106 & @xmath110 & @xmath113 & @xmath114 & @xmath12 & @xmath109 & +   + # 1 & @xmath1154.0 & 0.0 & 1.0 & 4.0 & 0.2384 + # 2 & 0.0 & @xmath1154.0 & 4.0 & 0.0 & 1.6349 + # 3 & @xmath1150.5 & 0.0 & 0.0 & 0.1 & 11.8609 + # 4 & @xmath1150.4 & 0.0 & 0.1 & 0.0 & 13.5487 + # 5 & @xmath1150.4 & 0.0 & 0.1 & 0.1 & 7.8224 +   + # 26 & @xmath1153.064 & @xmath1150.119 & 0.859 & 3.002 & 0.0156 + # 51 & @xmath1153.053 & 0.104 & 0.637 & 2.970 & 0.0123 + # 99 & @xmath1153.044 & 0.046 & 0.646 & 2.971 & 0.0128 +   + # 1 & @xmath1154.0 & 0.0 & 0.10 & 4.0 & 0.0040 & * * already perfect + # 2 & @xmath1154.5 & 0.1 & 0.01 & 4.4 & 0.0227 + # 3 & @xmath1153.5 & @xmath1150.2 & 0.00 & 3.9 & 0.0018 & * * already perfect + # 4 & @xmath1154.1 & 0.1 & 0.20 & 4.1 & 0.0322 + # 5 & @xmath1154.2 & 0.2 & 0.05 & 4.2 & 0.0320 +"
  ],
  "abstract_text": [
    "<S> we implemented a coarse - graining procedure to construct mesoscopic models of complex molecules . </S>",
    "<S> the final aim is to obtain better results on properties depending on slow modes of the molecules . </S>",
    "<S> therefore the number of particles considered in molecular dynamics simulations is reduced while conserving as many properties of the original substance as possible . </S>",
    "<S> we address the problem of finding nonbonded interaction parameters which reproduce structural properties from experiment or atomistic simulations . </S>",
    "<S> the approach consists of optimizing automatically nonbonded parameters using the simplex algorithm to fit structural properties like the radial distribution function as target functions . </S>",
    "<S> moreover , any mix of structural and thermodynamic properties can be included in the target function . </S>",
    "<S> different spherically symmetric inter - particle potentials are discussed . </S>",
    "<S> besides demonstrating the method for lennard  jones liquids , it is applied to several more complex molecular liquids such as diphenyl carbonate , tetrahydrofurane , and monomers of poly(isoprene ) . </S>"
  ]
}