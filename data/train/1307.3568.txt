{
  "article_text": [
    "optimal control theory ( oct ) is a versatile mathematical tool to find external fields that drive the dynamics of a quantum system toward a desired outcome  @xcite .",
    "the controls are , e.g. , the electric field of a laser pulse or the magnetic field amplitude of radio - frequency ( rf ) pulses .",
    "the underlying mechanism enabling the control are quantum interferences of light and matter  @xcite .",
    "oct consists in formulating the physical target as a functional of the field which is then optimized . typically , many solutions to the control problem exist  @xcite , and it depends on additional constraints which of these solutions is found by an oct algorithm .",
    "such additional costs can be used to identify solutions that are feasible in control experiments , for example in feedback loops with shaped femtosecond laser pulses  @xcite or sequences of rf pulses in high - resolution nuclear magnetic resonance  @xcite .",
    "the constraints ensure , for example , a maximally allowed amplitude or smoothly switching the pulses on and off  @xcite . in principle , a constraint to ensure a given spectral width of the pulse can be formulated analogously  @xcite .",
    "it is highly desirable to include such a constraint since the spectral width is fixed in a given experiment . in order to compare",
    "theoretically calculated and experimentally obtained pulses , it is necessary to restrict the bandwidth of the calculated pulses to the experimental value .",
    "however , so far it has been impossible to impose spectral constraints while strictly guaranteeing monotonic convergence of the optimization algorithm . without a spectral constraint ,",
    "the optimized pulses often possess extremely broad spectra with frequency components that are physically not necessary and can not be realised experimentally , see , e.g. , ref .",
    "@xcite .    to obtain control over the frequency components of the optimal pulse , two alternatives to imposing spectral constraints as part of the optimization functional",
    "have recently been discussed : ( i ) the field can be expanded into frequency components , and the expansion coefficients , not the field itself , are optimized  @xcite .",
    "this approach requires a concurrent update of the field @xmath0 for all @xmath1 at once and can not be combined with a sequential update .",
    "( ii ) the optimized field can be filtered at the end of each iteration step to eliminate undesired frequency components  @xcite .",
    "the challenge consists in implementing the filtering in a way that does not destroy convergence of the algorithm .",
    "formally , a filter can be obtained from a cost functional .",
    "however , the corresponding lagrange multiplier which is decisive for the convergence of the algorithm , remains indetermined  @xcite .",
    "an educated guess for the lagrange multiplier was shown to work under certain assumptions on the pulse and for sufficiently slow increase of the undesired frequency components  @xcite .",
    "it is nonetheless dissatisfying that monotonic convergence can not be ensured in general .",
    "an alternative filtering approach that strictly enforces convergence interpolates between the unfiltered field obeying monotonic convergence and the completely filtered field destroying convergence .",
    "the strength of the filter is then chosen in such a way that the filter barely avoids breaking the convergence  @xcite .",
    "this approach comes with considerable extra numerical effort since the interpolation requires additional optimization runs for each value of the interpolation parameter .    here , we demonstrate that spectral constraints can be included in the optimization functional without perturbing monotonic convergence using krotov s method @xcite .",
    "the spectral constraint is expressed via its fourier transform as an integral over time .",
    "the corresponding integral kernel must be written as a positive semi - definite quadratic form .",
    "we show that this is the only requirement that needs to be met to ensure monotonic convergence .",
    "the modified update formula for the field corresponds to a fredholm integral equation of the second kind which can be solved efficiently using the method of degenerate kernels .",
    "we apply krotov s method including spectral constraints to the optimal control of non - resonant two - photon absorption .",
    "in optimal control theory , the optimization problem is formulated by stating the target and additional constraints in functional form , @xmath2 = j_t[\\{\\psi_k(t)\\ } ]    + j_a[\\epsilon ]    + j_b[\\{\\psi_k\\ } ] \\,,\\ ] ] where @xmath3 denotes the target at final time @xmath4 and @xmath5 a set of state vectors describing the time evolution of the system .",
    "@xmath6 is a real function representing the control variable , e.g. , the electric field amplitude of a laser pulse .",
    "all additional constraints are assumed to depend either on the control or on the states , @xmath7 a common choice for @xmath8 minimizes the pulse intensity or change in pulse intensity @xcite , @xmath9 ^ 2     = \\frac{\\lambda_0}{s(t)}\\left[\\delta \\epsilon(t)\\right]^2 \\,,\\ ] ] with @xmath10 a weight to favor solutions with lower pulse amplitude and @xmath11 a shape function to smoothly switch the pulse on and off .",
    "@xmath12 can be used to restrict the time evolution to a subspace of the hilbert space or to optimize a time - dependent target , see ref . @xcite and references therein .",
    "minimization of the functional   yields a set of coupled equations for the states and the control .",
    "the non - linear optimization method developed by konnov and krotov  @xcite provides a general , monotonically convergent algorithm .",
    "given eq .",
    "for @xmath13 , it updates the control at iteration step @xmath14 according to  @xcite @xmath15 where @xmath16 and @xmath17 the hamiltonian of the system .",
    "the adjoint states @xmath18 are propagated backwards in time with the boundary condition @xmath19 determined by the final - time target @xmath3 .",
    "the choice of the function @xmath20 allows for ensuring monotonic convergence  @xcite . the specific form of @xmath20 depends on the optimization functional and the equations of motion .",
    "it can be estimated analytically or determined numerically , based on the optimization history  @xcite .",
    "constraints on the spectrum of the control have to be included in the cost functional @xmath21 .",
    "monotonic convergence requires a well - defined sign of @xmath21  @xcite .",
    "a general expression that fulfills this requirement is obtained by writing @xmath21 as a quadratic form . in frequency domain , necessary to formulate spectral constraints ,",
    "the cost functional thus becomes @xmath22 where a real kernel function @xmath23 in frequency domain and its fourier transform @xmath24 in time domain have been introduced .",
    "the desired spectral constraints are thus implemented by the kernel function . given eq .   for @xmath21 , the function @xmath25 , defined in eq .  , takes the form @xmath26 since the field and thus the change in the field are zero outside of the interval @xmath27 $ ] , integration can be restricted to @xmath27 $ ] . in krotov",
    "s method , monotonic convergence can be ensured if the kernel @xmath28 is positive semi - definite  @xcite .",
    "this follows directly from the condition for the change of the functional due to changes in the control to be positive @xcite which in turn translates into @xmath13 being a convex function .",
    "equivalently in frequency domain , @xmath29 has to be positive semi - definite .",
    "monotonic convergence is therefore guaranteed if @xmath30    since derivation of the update equation requires evaluation of @xmath31 as a function of time @xcite , the fourier transform of @xmath29 should have a closed form in addition to being positive semi - definite . for numerical stability , it is furthermore desirable to use smooth kernels . a suitable choice fulfilling these requirements are gaussian kernels , @xmath32 \\,,\\nonumber\\\\      \\label{eq : kernel }      k(t - t ' ) & = &   2 \\pi \\lambda_a \\delta(t - t ' )       - \\sum_i \\lambda_b^i \\sqrt{2\\pi \\sigma_i^2 }       \\cos[\\omega_i ( t - t ' ) ] e^{-\\frac{\\sigma_i^2 ( t - t')^2}{2 } } \\,.\\end{aligned}\\ ] ] note that we choose symmetric gaussian kernels since we consider here real fields .",
    "an extension to complex controls is straightforward . for ( approximately )",
    "non - overlapping gaussians in frequency domain , monotonic convergence is obtained if @xmath33 the first term in eq .",
    "reproduces eq .   with @xmath34 and @xmath35 . for @xmath36 ,",
    "the kernel   implements a frequency pass for @xmath37 around the frequencies @xmath38 .",
    "for @xmath39 , a frequency filter for @xmath37 around the frequencies @xmath38 is obtained .",
    "due to the condition  , frequency passes are not guaranteed to be effective , i.e. , the @xmath40 might be too small for the spectral constraint to gain sufficient weight . for frequency filters , no such restriction exists .",
    "a work - around to create effective frequency passes consists therefore in adding up sufficiently many frequency filters .",
    "moreover , an amplitude constraint with non - constant shape function can be reintroduced additively in time domain for @xmath41 , setting @xmath42 .",
    "this does not perturb monotonic convergence since both amplitude and frequency constraint preserve monotonic convergence individually .    following the prescription of ref .",
    "@xcite , the update equation for gaussian band filters around frequencies @xmath38 and an additional amplitude constraint imposed by a shape function @xmath43 is obtained as @xmath44\\ , e^{-\\frac{\\sigma_i^2          ( t - t')^2}{2 } } \\left({\\epsilon^{(i+1)}(t ' ) } -        \\epsilon^{(i)}(t')\\right ) ~ dt ' } \\nonumber \\\\     & & + \\frac{s(t)}{\\lambda_0 } \\mathfrak{im } \\left\\{\\sum_k      \\braket{\\chi_k^{(i)}(t)|\\frac{\\partial { \\boldsymbol{\\mathsf{\\hat{h}}}}}{\\partial          \\epsilon}|\\psi_k^{(i+1)}(t ) }        + \\frac{1}{2 } \\sigma(t ) \\sum_k      \\braket{\\delta\\psi_k(t)|\\frac{\\partial { \\boldsymbol{\\mathsf{\\hat{h}}}}}{\\partial          \\epsilon}|\\psi^{(i+1)}_k(t ) } \\right\\ } .\\",
    "\\label{eq : newupdate}\\end{aligned}\\ ] ] this is an implicit equation for @xmath45 .",
    "it is possible to rewrite eq .   as a fredholm integral equation of the second kind for @xmath46 , @xmath47 the inhomogeneity",
    "@xmath48 depends on the unknown states @xmath49 .",
    "they can be approximated by calculating @xmath37 according to eq .",
    ", i.e. , without frequency constraints .",
    "propagating the states under that field yields an approximation of @xmath48 . in our applications",
    "this turned out to be sufficient .",
    "however , if the quality of the resulting approximation of @xmath48 is not good enough , the field obtained from a first solution of the fredholm equation can be used to propagate the states and obtain an improved approximation of @xmath48 .",
    "this procedure can be repeated iteratively until the desired accuracy is reached .",
    "the remaining question is then how to solve the integral equation  .",
    "often , fredholm equations of the second kind are solved numerically  @xcite by quadrature of the integral , @xmath50 such that @xmath51 or collocation , i.e. , expanding @xmath37 into orthonormal basis functions @xmath52 on @xmath27 $ ] , @xmath53 in both cases , solution of the integral equation is reduced to solving a system of linear equations .",
    "alternatively , a fredholm equation of the second kind can be solved by approximating @xmath54 by a degenerate kernel , @xmath55 @xcite .",
    "solution of a fredholm degenerate integral equation again reduces to solving a system of linear equations . for our purposes , an approach based on degenerate kernels  @xcite turns out to be the best option .",
    "it is more stable than collocation and similar to the quadrature of the integral but more direct since the kernel rather than the integral is approximated .",
    "the solution to eq .",
    "is then given by @xmath56 with @xmath57 defined in eq .   and",
    "@xmath58 the solution of the system of linear equations  .",
    "we apply krotov s method including spectral constraints , eq .  , to non - resonant two - photon absorption in sodium atoms .",
    "the goal is to transfer population from level @xmath59 to @xmath60 . due to selection rules ,",
    "this is possible only by absorption of two photons with the transition dipoles provided by the off - resonant @xmath61 levels with the main contribution coming from @xmath62 .",
    "we do not invoke an adiabatic elimination of all off - resonant levels , i.e. , our hamiltonian includes @xmath63 with @xmath64 and the corresponding @xmath65 transition dipole moments , taken from ref .",
    "@xcite . within this model ,",
    "two control strategies are available to transfer population from @xmath59 to @xmath60  resonant two - color one - photon transitions with frequencies @xmath66 and @xmath67 or an off - resonant two - photon transition with frequency close to @xmath68 .",
    "non - resonant two - photon absorption has been studied experimentally for @xmath69 to @xmath70 transitions in alkali atoms in the weak  @xcite , strong  @xcite and intermediate field regime  @xcite . to date ,",
    "optimal control calculations of non - resonant two - photon absorption have been hampered by a spectral spread of the field .",
    "the resulting spectral widths by far exceed experimentally realistic values . as a result",
    ", only solutions using one - photon transitions are found while the experimental result of _ non - resonant _ two - photon control  @xcite could not be reproduced .",
    "here we employ optimal control theory with spectral constraints to enforce a non - resonant two - photon solution .",
    "we use gaussian frequency filters around the one - photon frequencies to suppress resonant dipole transitions .",
    "figure  [ fig : tpa ] compares the optimal pulses and their spectra obtained by krotov s method with ( bottom panel ) and without ( top panel ) spectral constraint , cf .",
    "eqs .   and .",
    "the frequency filters around the one - photon transition frequencies are indicated in red in fig .",
    "[ fig : tpa](d ) .",
    "the central frequency of the guess pulse is taken to be exactly the two - photon transition frequency .",
    "its peak amplitude is about a fourth of that of a two - photon @xmath71-pulse . despite the guess pulse being fairly close to a non - resonant two - photon solution",
    ", the optimization algorithm yields a pulse that uses the resonant one - photon transitions , cf .",
    "the three small peaks in fig .",
    "[ fig : tpa](b ) .",
    "the use of one - photon transitions is also reflected in the dynamics under the optimized pulse which shows a significant population of the @xmath72 level , cf . the green line in fig .",
    "[ fig : conv_tpa](b )",
    ". it is rationalized in terms of the intensity which should increase as little as possible according to the constraint   and resonant transitions requiring a lot less intensity than non - resonant ones .",
    "increasing the spectral width comes at no cost for the optimization algorithm when no spectral constraint is present . thus solutions that use resonant one - photon transitions and have a broad spectral width are the natural ones for optimization without spectral constraint .",
    "once the spectral constraint is included , the optimization algorithm increases the pulse amplitude until a two - photon rabi frequency of @xmath71 is hit .",
    "the spectrum of the optimal pulse is hardly modified compared to that of the guess pulse .    imposing an additional constraint results in a more difficult optimization problem .",
    "this is illustrated by fig .",
    "[ fig : conv_tpa](a ) which compares the convergence toward the optimum for optimization with and without the spectral constraint . in order to reach the optimum within an error , @xmath73 , of @xmath74",
    "the number of iterations is increased from 71 to 87 . the slower convergence of the algorithm with spectral constraint is attributed to optimization under two conflicting costs  keeping the intensity as low as possible while avoiding certain spectral regions . the algorithm needs to balance the two conflicting costs , which results in a more difficult optimization problem .        while the increase in the number of iterations , when adding the spectral constraint , is comparatively moderate , a cpu time of about 370@xmath75s is needed for 10 iterations , compared to only 6@xmath75s for the algorithm without spectral constraint",
    "this is due to the additional numerical effort required in order to solve the fredholm equation .",
    "this effort scales with the number of time grid points but is independent of the complexity of the system .",
    "the comparison of the cpu time required with and without the spectral constraint will be much more favorable for more complex systems .",
    "then most of the cpu time will be spent for the time propagation whereas the solution of the fredholm equation represents a comparatively small add - on .",
    "moreover , the numerical effort for solving the fredholm equation can be further reduced by exploiting the bandedness of the matrix in eq .  .",
    "we have derived an extension of krotov s method for quantum optimal control that allows for including constraints on the control in frequency and time domain at the same time .",
    "the key is to ensure a well - defined sign of the integral over the constraint which we have achieved by expressing the constraint as a quadratic form .",
    "gaussian kernels , to be used either as frequency passes or as frequency filters , turn out to be the most practical choice .",
    "frequency passes may be inefficient due to a limit on the weight of the constraint , whereas frequency filters can be employed without restriction .",
    "the update equation that we obtain for gaussian frequency filters is an implicit equation in the control which takes the form of a fredholm integral equation of the second kind .",
    "it can be solved accurately and efficiently using the method of degenerate kernels  @xcite .",
    "our results for non - resonant two - photon absorption in sodium atoms show an excellent restriction on the spectrum of the optimized pulse .",
    "the new algorithm thus allows for reproducing experimentally known control strategies for strong - field non - resonant two - photon absorption  @xcite .",
    "it can also be used in conjunction with quasi - newton methods in order to achieve faster convergence  @xcite . in future work",
    ", we will discuss in detail how the spectral constraint allows for steering the optimization pathway in the control landscape  @xcite .",
    "we would like to thank ronnie kosloff for many valuable discussions . financial support from the deutsche forschungsgemeinschaft ( grant no .",
    "ko 2301/2 ) and by the spanish micinn ( grant no .",
    "fis2010 - 19998 ) is gratefully acknowledged .",
    "to simplify notation , we map the time interval from @xmath27 $ ] to @xmath76 $ ] . a degenerate kernel is obtained by a tensor product ansatz for the true kernel , @xmath77 with @xmath78 , taking the basis functions to be  @xcite @xmath79 @xmath80 is the order of the approximation . at the grid points @xmath81 , @xmath82 , @xmath83 the choice of basis functions suggests for the coefficients @xmath84 such that @xmath85 reasonably approximates @xmath54 on a time grid of size @xmath86 .",
    "it can be shown that the solution to eq .",
    "is given by eq .",
    "with @xmath58 the solution of the following system of linear equations , @xmath87   \\vec{x } = \\gamma \\vec{b } \\,,\\ ] ] with matrix elements @xmath88 where @xmath89 and @xmath90\\ dt   \\,.\\ ] ]"
  ],
  "abstract_text": [
    "<S> shaped pulses obtained by optimal control theory often possess unphysically broad spectra . in principle , the spectral width of a pulse can be restricted by an additional constraint in the optimization functional . </S>",
    "<S> however , it has so far been impossible to impose spectral constraints while strictly guaranteeing monotonic convergence . here </S>",
    "<S> , we show that krotov s method allows for simultaneously imposing temporal and spectral constraints without perturbing monotonic convergence , provided the constraints can be expressed as positive semi - definite quadratic forms . </S>",
    "<S> the optimized field is given by an integral equation which can be solved efficiently using the method of degenerate kernels . </S>",
    "<S> we demonstrate that gaussian filters suppress undesired frequency components in the control of non - resonant two - photon absorption . </S>"
  ]
}