{
  "article_text": [
    "the study of _ domino tilings _ is incredibly rich in its history , applications , and connections to other fields .",
    "a geometric version of the _ perfect matching _ problem in grid graphs , the problem is a special case of a general study of tilings of finite regions , with its own set of problems and generalization directions , very different from graph theory . in this paper",
    "we study the decision and the counting problems for the tilings of a given region .",
    "both problems have a large literature and long history in combinatorics and computational complexity , as well as in the recreational literature , but much of the work concentrated on tilings in the plane .",
    "significantly less is known in three and higher dimensions , where much of the intuition and many tools specific to two dimensions break down .    to summarize the results of this paper in one sentence ,",
    "we show that the classical domino tiling problems become computationally hard already in three dimension , even when the topology of regions is restricted .",
    "this further underscores the fundamental difficulty of obtaining even the most basic ( positive ) tiling results in higher dimensions . we should mention that dimension three is critically important for applications ranging from enumerative combinatorics to probability , to statistical physics , and to solid - state chemistry ( see _ e.g. _",
    "@xcite ) .",
    "the ( single tile ) _ tileability problem _ can be stated as follows .",
    "given a tile  @xmath0 , decide whether a region  @xmath1 is tileable with copies of  @xmath0 ( rotations and reflections are allowed ) .",
    "when @xmath0 is a domino @xmath2 $ ] , the tileability problem can be solved in polynomial time , via the reduction to perfect matching  @xcite , and the result generalizes to any  @xmath3 . on the other hand , when @xmath0 is a bar @xmath4 $ ] , the tileability problem is -complete  @xcite in the plane .",
    "our first result is on the tileability with a brick @xmath5 $ ] , which we call a _",
    "slab_. viewed as half - cubes , slabs can be thought of as a natural generalization of 2-dimensional dominoes .",
    "[ thm : slab ] tileability of @xmath6-dimensional regions with slabs is -complete .    now , when the region @xmath7 is simply connected ( s.c . ) , the tileability problem is simpler in many cases .",
    "for example , when @xmath0 is a domino , the s.c .",
    "tileability problem can be solved in linear time in the area  @xmath8 , while quadratic for general regions  @xcite ( see also  @xcite ) . moreover , when  @xmath0 is any rectangle , the s.c .",
    "tileability problem is polynomial  @xcite ( see also  @xcite ) , as opposed to -complete for general regions .",
    "interestingly , this phenomenon does not extend to higher dimensions .",
    "[ thm : slab - c ] tileability of _ contractible _ @xmath6-dimensional regions with slabs is -complete .    for the definition of contractible regions in higher dimension , generalizing s.c .",
    "regions in the plane , see section  [ s : def ] .",
    "note that in the plane , finding a tile such that the tileability problem of simply connected regions is -complete remains an open problem ( see section  [ s : fin ] ) .",
    "the next set of results concerns _ counting problems _ : given @xmath9 , compute the number of tilings of @xmath9 with copies of tile  @xmath0 ( again , rotations and reflections are allowed ) .",
    "it is well known that in the plane , the number of domino tilings of  @xmath9 can be computed in polynomial time ( see _ e.g. _",
    "this is perhaps surprising , since computing the number of perfect matchings is classically -complete  @xcite .",
    "the following result is one of the historically first applications of -completeness .",
    "[ thm : domino ] number of domino tilings of @xmath6-dimensional regions is -complete .    let us note that valiant s result is strongly related , but slightly different ( see subsection  [ ss : fin - val ] ) .",
    "we re - prove valiant s theorem both for completeness and as a stepping stone towards stronger results .",
    "the proof uses a reduction from the perfect matching problem in cubic bipartite graphs .",
    "this construction allows us to prove the following far - reaching extension of theorem  [ thm : domino ] .",
    "[ thm : domino - c ] number of domino tilings of _ contractible _ @xmath6-dimensional regions is -complete .",
    "we conclude with the following counting version of theorems  [ thm : slab ] and  [ thm : slab - c ] .",
    "this is obtained essentially for free by using the same construction as in the proof of the theorems .",
    "[ thm : slab - s ] number of slab tilings of @xmath6-dimensional regions is -complete .",
    "moreover , the result holds when considering only contractible regions .",
    "much of the rest of the paper consists of proofs of these results . in section  [ s : gen ] , we present generalizations to dimensions  @xmath10 .",
    "we conclude with final remarks and open problems in section  [ s : fin ] , where we also continue a historical discussion of these and related tiling results .",
    "consider @xmath11 as the union of closed unit cubes in  @xmath12 centered at the integer lattice points .",
    "we will suggestively refer to the elements of  @xmath11 as _",
    "cubes_. a _ region _",
    "@xmath9 is a finite subset of  @xmath11 , and is naturally identified with @xmath13 , the union of the corresponding closed unit cubes .",
    "we say that a region @xmath14 is _ contractible _ if @xmath13 is contractible and has contractible interior .    .",
    "]    neither of the requirements is redundant .",
    "for example , the set on the left in figure  [ fig:0contract ] consisting of six closed cubes is contractible but its interior is not , since the center becomes a hole .",
    "the region on the right with seven closed cubes is not contractible but its interior is .",
    "we wish to be strict and consider these as non - contractible .",
    "let @xmath0 be a _ tile _ , which is simply a contractible region .",
    "a _ @xmath0-tiling _ of a region @xmath9 is a partition of @xmath9 into pairwise disjoint ( as subsets of @xmath11 ) isomorphic copies of  @xmath0 .",
    "here we allow @xmath0 to be rotated and reflected  though all the tiles we will consider are bricks , which have mirror symmetries . when the tile @xmath0 is understood , we simply call it a tiling",
    ". this leads us to the following two decision problems :    ll + * instance : * & a region  @xmath9 . +",
    "* decide : * & does the region @xmath9 admit a @xmath0-tiling ?    ll + * instance : * & a contractible region  @xmath9 .",
    "+ * decide : * & does the region @xmath9 admit a @xmath0-tiling ?    to analyze the complexities of these problems , we will follow the usual line of attack by embedding known problems as tiling problems . as such ,",
    "let us define two more decision problems we will use .",
    "a graph is _ cubic _ if each vertex has degree  @xmath6 .",
    "a _ perfect matching _ is a collection of pairwise - disjoint edges that cover all the vertices .",
    "ll + * instance : * & a cubic bipartite graph  @xmath15 .",
    "+ * decide : * & does the graph @xmath15 admit a perfect matching ?",
    "suppose we are given a set of boolean variables .",
    "literal _ is a variable or the negation thereof .",
    "a _ @xmath6-sat expression  @xmath16 _ is a conjunction of clauses , each a disjunction of three literals .",
    "we will write @xmath17 as a set of triples @xmath18 of literals , where the negation of a variable @xmath19 is denoted  @xmath20 .",
    "an assignment of boolean values to the variables is _",
    "@xmath21-in-@xmath6 satisfying _ if each clause @xmath18 has precisely one true literal .",
    "this leads to the following natural decision problem :    ll + * instance : * & a @xmath6-sat expression  @xmath16 .",
    "+ * decide : * & does the expression @xmath16 admit a @xmath21-in-@xmath6 satisfying assignment ?    for each decision problem , we also have an associated counting problem , where we count the number of witnesses .",
    "in particular , for the problems above , we need to count the number of tilings , perfect matchings , and satisfying assignments , respectively . by abuse of language",
    ", we say a decision problem is -complete if its associated counting problem is -complete .",
    "we reduce the tiling problems from the following two well - known problems .",
    "cubic bipartite perfect matching is -complete .",
    "[ thm:1-in-3 ] @xmath21-in-@xmath6 sat is -complete and -complete .    for convenience and without loss of generality",
    ", we will assume that each variable  @xmath22 appears unnegated somewhere in the boolean expression .",
    "indeed , if a variable occurs only negated , we may simply replace it by its negation .",
    "if @xmath22 does not occur , add the clause @xmath23 , where @xmath24 is a new variable . the number of satisfying assignments is obviously preserved .",
    "we will reduce the counting of perfect matchings in cubic bipartite graphs to the counting of tilings with dominoes . given a cubic bipartite graph ,",
    "we want to create a region , such that the number of tilings of the region is the number of perfect matchings of the given graph",
    ".    given two cubes @xmath25 , a _ wire _ is a sequence of distinct cubes @xmath26 in @xmath11 , such that @xmath27 and @xmath28 are adjacent if and only if @xmath29 .",
    "we call @xmath30 and @xmath31 the _ endpoints _ of the wire , @xmath32 the _ interior _ , and @xmath33 the _ length_. a collection of wires is _ proper _ if no wires intersect the interior of other wires , and any two cubes in the union of the wires are adjacent if and only if they are consecutive elements in ( precisely ) one such wire .",
    "let @xmath15 be a connected graph .",
    "we will create a region @xmath14 representing this graph @xmath15 as follows .",
    "let @xmath34 be an injective map , and identify each vertex with its image .",
    "for each edge @xmath35 , we connect @xmath36 and @xmath37 by a wire , which is identified with the edge .",
    "let @xmath9 be the union of these wires ( and thus contains the vertices ) .",
    "if the collection of the wires is proper , we call @xmath9 a _ lattice drawing _ of  @xmath15",
    ".    color the space @xmath38 in a checkerboard fashion , and call @xmath39 the _ parity _ of @xmath40 .",
    "every connected simple graph @xmath15 with maximum degree at most  @xmath41 has a lattice drawing .",
    "moreover , if @xmath15 is bipartite , it can be drawn with each edge having endpoints of opposite parity .",
    "it is obvious that if we pick @xmath24 so that the images are sufficiently spaced out , we can connect the vertices with proper wires .",
    "the maximum degree condition is due to the limitation that a cube has only @xmath41 neighbors .",
    "the second part of the lemma is immediate .",
    "fix a lattice drawing @xmath9 constructed above , and consider a tiling by dominoes .",
    "the neighborhood of a vertex is shown in figure  [ fig:1vertex ] .",
    "the solid blue square represents the vertex , with three emanating wires representing its incident edges .",
    "consider a wire corresponding to some edge . since the collection of wires is proper ,",
    "there are no other cubes adjacent to the interior of this wire .",
    "thus in any domino tiling , the dominoes must tile the wire along its length .",
    "since the endpoints have opposite parity , this wire has even number of cubes .",
    "hence either it is partitioned into dominoes under the tiling , or the dominoes it contains are all in its interior , in which case its endpoints are covered by dominoes that are contained in other wires .    if @xmath42 is the collection of edges in @xmath9 that are partitioned into dominoes , then @xmath42 is a perfect matching of  @xmath15 .",
    "pick a vertex and consider the domino covering it : that domino is contained in precisely one of the incident edges .",
    "thus for every vertex precisely one incident edge is in @xmath42 , implying that @xmath42 is a perfect matching .",
    "we just extracted a perfect matching of @xmath15 from a tiling of  @xmath9 .",
    "notice that this map is bijective , that is , every perfect matching induces a unique tiling .",
    "indeed , for each edge in the matching , tile the corresponding wires by dominoes covering the endpoints , then finish the tiling in the obvious manner .",
    "this means that the number of tilings is exactly the number of perfect matchings , concluding the proof of theorem  [ thm : domino ] .",
    "the main idea is to create a large contractible `` plate '' that admits a unique domino tiling , and then place the construction from the proof of theorem  [ thm : domino ] adjacent to this plate , while being careful as to not introduce new tilings for the plate . given a region @xmath9 , a subregion @xmath43 is called _ frozen _ if it is tiled the same way in all possible tilings of  @xmath9 .",
    "we will call the @xmath44 plane _ layer  @xmath45_. the entire construction of @xmath9 will lie in four layers , from layer  @xmath46 to layer  @xmath47 . when considering cubes on a layer , we will employ the usual convention of referring to the @xmath48 , @xmath49 , @xmath50 , @xmath51 directions as right , left , above , and below . when referring to an adjacent cube in a different layer , we will specify the layer specifically , as to avoid confusion .",
    "let us start with a _ plate _ that lies in layer  @xmath52 , which is a region whose columns have even lengths and are offset with each other , causing _",
    "jagged _ borders .",
    "it is obvious that it admits a unique tiling , which is shown in figure  [ fig:2plate ] .",
    "we will modify this plate carefully as to introduce only local changes in the tilings while preserving the unique global tiling .",
    "suppose we are given a cubic bipartite graph @xmath15 with bipartition @xmath53 and  @xmath54 .",
    "we will place the vertices in @xmath53 on the left side of a plate , and vertices in @xmath54 on the right side .",
    "now we must connect the corresponding vertices with wires .",
    "we can achieve the desired connections by interchanging adjacent wires in steps .",
    "indeed , think of the correspondence as a permutation and write it as a product of transpositions .",
    "the resulting schematic is known as a _ wiring diagram_. these wires will , for the most part , stay in layer  @xmath21 . in between each pair of wires",
    ", we will add a _",
    "we then modify the region locally with a _",
    "crossover -gadget _ at each location indicated in the wiring diagram .",
    "as an example , we see the general picture in figure  [ fig:2overview ] .",
    "there is a big plate , with offset columns causing jagged borders on the top and bottom of the region , indicated by the short dashes .",
    "there are four vertices , each one with three wires coming out of it , indicated by the solid lines .",
    "the tension lines between the wires are indicated by the long dashed lines .",
    "the red boxes are the -gadgets .",
    "the wire and the tension line are shown in figure  [ fig:2wiretension ] .",
    "the schematic is drawn in layer  @xmath52 .",
    "the unique tiling of the frozen region in layer  @xmath52 is shown : dominoes that are entirely in this layer are drawn as @xmath55 rectangles in the plane . when a @xmath56 ( resp .",
    "@xmath57 ) sign is present , it means the region includes the adjacent cube in layer  @xmath58 ( resp .",
    "@xmath46 ) .    here",
    "we show half of a vertex -gadget in figure  [ fig:2vertex ] .",
    "a single square in the schematic denotes that the cube in layer  @xmath52 is always tiled with a domino sticking out to layer  @xmath21 or  @xmath46 .",
    "the symbol @xmath59 signifies that the adjacent cubes in both layers @xmath60 are included .",
    "the blue circle is the center of the -gadget , and needs to satisfy positional parity as defined in the proof of the previous theorem .",
    "besides some isolated cubes , layer  @xmath21 contains the wires .",
    "notice that there are three wires coming out of the center of the -gadget .",
    "the third wire that is not drawn completely in the figure should mirror the other wire in the obvious way , including the initialization of the tension line .",
    "the wires ( sequences of @xmath56 ) extend towards the right . between each pair",
    ", we have a tension line ( the sequence of jagged @xmath56 and  @xmath57 ) .",
    "notice that we can easily make the -gadgets taller as to have more separation between the wires and tension lines exiting to the right .",
    "this will be used to align all these things together correctly .",
    "we use the mirror image when putting the -gadget on the right side of the plate . between pairs of -gadgets",
    ", we also add tension lines running horizontally across the entire plate .",
    "to make the crossover -gadget , we combine the hole -gadget ( figure  [ fig:2hole ] ) and the splitter -gadget ( figure  [ fig:2splitter ] ) .",
    "we use the same schematic convention as above in these figures . here",
    "the symbol  @xmath61 denotes that there is a cube in layer  @xmath21 , but not in layer  @xmath52 .",
    "similarly , symbol  @xmath62 signifies the inclusion of the cubes on layers  @xmath21 and  @xmath47 ( in addition to layer  @xmath52 ) .",
    "first use the -gadget to guide the lower wire to layer  @xmath46 , and use the -gadget to merge and align them together .",
    "then we reverse the process using a rotated copy of the splitter , as to make the wires crossover each other .",
    "finally , bring the wire back to layer  @xmath21 with another -gadget .",
    "this completes the construction of the crossover -gadget .",
    "it is clear that the -gadget takes two wires on the left , separated by a tension line , and outputs two wires on the right , again separated by a tension line .",
    "notice that in the construction of the -gadget , we could make the output wires further away from each other , which is also the case for the -gadget , as mentioned above . as such",
    ", we could align all these wires and tension lines so they feed into each other perfectly across the entire construction .",
    "thus using -gadgets , we are able to correctly connect the wires coming from -gadgets .",
    "this complete the construction of the region , which we shall call  @xmath9 .",
    "it remains to check that @xmath9 is contractible , and its domino tilings are in bijection with perfect matchings in graph  @xmath15 .",
    "the region @xmath9 is contractible .",
    "consider layer  @xmath52 .",
    "it has a hole for each -gadget . however , the adjacent cube in layer  @xmath21 is present , and is contained in a @xmath63 region .",
    "furthermore , the adjacent cube in layer  @xmath46 is not present . as such , filling in the hole in layer  @xmath52 does not alter contractibility . now that there are no holes in layer  @xmath52 , we may deformation retract everything in other layers to layer  @xmath52 , and then contract it to a point .",
    "it remains to find a frozen subregion @xmath64 such that @xmath65 is a lattice drawing of the given graph .",
    "let us start with @xmath66 ( thus @xmath67 ) and alter @xmath68 inductively .",
    "a cube in a region is _ isolated _ if it has precisely one neighbor ( out of the six adjacent possibilities ) .",
    "notice that an isolated cube must be tiled by a domino covering its unique neighbor .",
    "remove _ the isolated cubes of @xmath69 by moving them from @xmath69 to  @xmath68 .",
    "we repeat this process inductively until there are no more isolated cubes .    at any step , @xmath68 is a frozen subregion of  @xmath9 . when the process finishes , @xmath69 is a lattice drawing of the given graph .",
    "it follows immediately by construction that @xmath68 is frozen .",
    "the rest of this proof is devoted to the second part of the lemma .",
    "let us perform another induction on the number of -gadgets .",
    "for the base case , suppose we did not have any -gadgets .",
    "that is , we start with the boring cubic graph where disjoint pairs of vertices are joined by three edges each .",
    "consider each -gadget .",
    "after the first step , everything in layers  @xmath52 and @xmath46 on the two left - most columns in figure  [ fig:2vertex ] are removed , leaving the wire in layer  @xmath21 .",
    "the tension lines are all removed as well .",
    "it is clear that in the next step , the remaining horizontal domino will also be removed , along with the domino above it .",
    "thus after two steps , what we are left with in layer  @xmath52 is a collection of disconnected plates , each of which has a wire across it horizontally in layer  @xmath21 .",
    "these wires protrude to the left and right .",
    "each of these plates have jagged columns thanks to the initial boundary and the tension lines . as such , in each step , the top- and bottom - most cubes",
    "are isolated , hence removed with their neighbors , creating another jagged boundary .",
    "this process continues until all cubes in layer  @xmath52 are removed , including the ones adjacent to the wire in layer  @xmath21 .",
    "note that half of the cubes adjacent to said wire are removed from above , and the other from below .",
    "thus it is important that both sides were jagged , which is the motivation for introducing the tension lines .",
    "we are left with the lattice drawing of the aforementioned contrived cubic graph .",
    "now for the inductive step , suppose we add an extra -gadget .",
    "we want to show that the global situation is not altered , and that the local situation is what we wanted . indeed , the -gadget consists of two -gadgets and two -gadgets .",
    "having analyzed the -gadget , one should be able to inspect the -gadget construction in figure  [ fig:2hole ] , and easily see that after finitely many steps , we will be left with the wires in layers  @xmath60 , plus the connecting cube between them in layer  @xmath52 .",
    "the -gadget is a bit more complicated , but can be carefully analyzed in the same manner . indeed , after the first step , all the cubes in layer  @xmath46 are removed except for the wire .",
    "similarly , the layers  @xmath21 and @xmath47 cubes for @xmath62 are removed , so are all the cubes in layer  @xmath21 , save the wire .",
    "as for layer  @xmath52 , we get a small island of six vertical dominoes in the middle , and a giant plate with enough tension lines such that a similar inductive removal process as above will remove it completely .",
    "hence we are left with precisely the wires , thus completing the proof of the lemma .",
    "here we reduce @xmath21-in-@xmath6 sat to a tiling problem .",
    "the reduction will be parsimonious , thus proving both -completeness and -completeness .    consider a sequence of cubes in the @xmath70 plane , where two cubes are adjacent if and only if they are consecutive elements in the sequence ( this is called a wire in the proof of theorem  [ thm : domino ] ) .",
    "consider the sequence as a region and duplicate it also in the @xmath71 plane .",
    "we now call a _ wire _ the union of these two copies . in a wire , a pair of adjacent cubes , one with @xmath70 and one with @xmath71 , is called a _ cube pair_. in any tiling by slabs , each cube pair must be covered by the same slab .",
    "if we translate the wire to the @xmath44 and the @xmath72 planes , we say the wire _ lives _ in the @xmath44 _",
    "biplane_. color the biplane @xmath73 in a checkerboard fashion , ignoring the @xmath74-coordinate .",
    "we call the color of a cube ( pair ) its _ parity _ , which can be _ even _ or _",
    "odd_. similarly , we may rotate and consider wires living in @xmath75 or @xmath76 biplanes . in those cases , the biplane coloring would ignore the @xmath77- or the @xmath78-coordinate , respectively . notice that a cube @xmath40 might have different parities depending on the biplane being considered . however",
    ", each cube pair lives in a unique biplane : thus the parity of a cube pair is unambiguous .",
    "when we draw diagrams consisting of wires in each biplane , we simply draw the two - dimensional regions used to form the wires .",
    "the variable -gadget , shown in figure  [ fig:3variable ] , is made by removing two diagonal cubes of a @xmath79 region , and then attaching six wires .",
    "notice that the wires come in pairs , and each pair lives in a biplane .",
    "we label the wires with their initial coordinate directions .",
    "each wire has an endpoint in the -gadget , called the _",
    "variable endpoint _ ; the other one is called the _",
    "free endpoint_. we now describe where to place the -gadgets and how to join these free endpoints together .",
    "suppose we are given a @xmath6-sat expression @xmath17 on the variable set @xmath80 , where each clause @xmath81 consists of three literals , each either a variable @xmath22 or a negation @xmath82 , for some @xmath83=\\{1,\\ldots , n\\}$ ] .",
    "we now construct a region  @xmath9 .    if @xmath84 is @xmath22 or its negation @xmath82 , place a -gadget at @xmath85 .",
    "that is , the wires live in the @xmath86 , @xmath87 , and @xmath70 biplanes , respectively .",
    "moreover , the variable endpoint of each wire has odd parity with respect to the coloring of the biplane in which the wire lives .",
    "consider the @xmath86 plane for each @xmath83 $ ] , which is drawn schematically in figure  [ fig:3sync ] .",
    "( bi)plane .",
    "the squares represent the -gadgets and the lines represent the wires . ]    notice that all the @xmath88 wires corresponding to the variable @xmath22 are on this biplane . for each -gadget",
    ", we will bend the @xmath89 wire to the left and down as shown .",
    "we link up the first wire with the last , and also the remaining adjacent pairs .",
    "figure  [ fig:3clause ] shows a clause -gadget , which is simply a joining of three wires .",
    "the parity of the gadget is the parity of the blue cube pair at the center where the three wires meet .",
    "now let us work in the @xmath70 biplane , schematically shown in figure  [ fig:3link ] .",
    "( bi)plane . the circles , where the lines meet , indicate the -gadgets , which are at two different parities . ]    for each clause , there are three corresponding -gadgets . from each -gadget , take the @xmath50 ( resp .",
    "@xmath51 ) wire if the corresponding variable appears in the clause unnegated ( resp .  negated ) .",
    "extend these three wires to @xmath90 and join them together at a -gadget with even parity .",
    "similarly , extend the three remaining @xmath91 wires to @xmath92 and join together at a -gadget with odd parity .",
    "we call these the even and odd -gadgets corresponding to each clause , respectively .    finally , for each -gadget",
    ", let us join the remaining @xmath48 wire and the @xmath49 wire together to form a loop .",
    "the wires can be joined together such that no cubes are adjacent unless they are in fact adjacent cubes from a single wire .    as the -gadgets are sufficiently spaced out ,",
    "it is very obvious that we can make the wires avoid each other , besides when they meet at the - and -gadgets .",
    "this finishes the construction .",
    "fix a region @xmath9 constructed above from a @xmath6-sat expression  @xmath16 .",
    "it remains to show that the tilings of  @xmath9 and the @xmath21-in-@xmath6 satisfying assignments of  @xmath16 are in bijective correspondence .",
    "first , consider a tiling of  @xmath9 .",
    "we say that the _ phase _ of an endpoint of a wire is _ positive _ if the wire contains the tile that covers that endpoint , and _ negative _ otherwise .",
    "[ lem : wire ] a wire of even length has the same phase at both endpoints , while a wire of odd length has opposite phases at its two endpoints .    as in the proof of theorem  [ thm : domino ] , the slabs must line up along the length of the wire , since the various wires do not intersect or come near each other ( except at the endpoints ) .",
    "the following is immediate by observing the way slabs can come together to tile the -gadget :    [ lem : variable ] there are two ways to tile each -gadget locally . in either tiling , the three @xmath56  wires have the same phase at their variable endpoints , and the three @xmath57  wires have the opposite phase at their variable endpoints as the @xmath56  wires .",
    "let the _ phase _ of the -gadget be the common phase of the @xmath56  wires at their variable endpoints .",
    "the -gadgets corresponding to @xmath22 ( or its negation @xmath82 ) all have the same phase .",
    "consider two adjacent -gadgets in the construction shown in figure  [ fig:3sync ] .",
    "suppose the gadget on the left has positive phase ( the opposite situation is similar ) .",
    "then by lemma  [ lem : variable ] , its @xmath93 wire has negative phase at the variable end .",
    "this wire is linked with the @xmath89 wire of the gadget on the right .",
    "since both endpoints have odd parity , the wire has odd length , thus by lemma  [ lem : wire ] , the variable endpoint of the @xmath89 wire of the gadget on the right ( hence the gadget ) has positive phase .",
    "this allows us to assign a truth value to the variable  @xmath22 :    let the boolean assignment of @xmath22 be the common phase of the -gadgets corresponding to  @xmath22 .",
    "this defines a @xmath21-in-@xmath6 satisfying assignment .",
    "fix a clause @xmath94 and consider the corresponding even -gadget .",
    "there are three wires connecting the corresponding -gadgets to the center of the -gadget .",
    "the variable endpoints of the wires have odd parity , and the free endpoints are all at the center of the -gadget , which has even parity .",
    "as such , the wires have even lengths ; thus by lemma  [ lem : wire ] , each wire has the same phase on both its endpoints .",
    "the center of the -gadget is tiled by some slab , which is contained in precisely one of its three wires . without loss of generality ,",
    "suppose only the wire corresponding to @xmath30 is of positive phase ( at both of its endpoints ) .",
    "recall that the phase of a -gadget is the phase of its @xmath56  wires at their variable endpoints .",
    "if @xmath95 is an unnegated variable , then the @xmath50 wire was used , and thus  @xmath22 ( and hence  @xmath27 ) is positive if and only if  @xmath96 . on the other hand ,",
    "if @xmath97 is a negated variable , then the @xmath51 wire was used .",
    "thus @xmath22 is _ negative _ if and only if @xmath96 , but then @xmath27 is again positive if and only if  @xmath96 .",
    "this shows that the assignment is indeed @xmath21-in-@xmath6 satisfying .",
    "we thus have a map from the tilings of @xmath9 to the satisfying assignments of  @xmath16 .",
    "for the inverse , suppose we have a @xmath21-in-@xmath6 satisfying assignment .",
    "simply tile each -gadget according to the assignment in the obvious way .",
    "it only remain to tile the wires . however , by construction , once we choose the phase of a -gadget , the tiling of all six wires emanating from that region is forced .",
    "the @xmath88 wires fit together because the phases of the -gadgets are consistently assigned , in accordance to the truth value of the variable in the given satisfying assignment .    recall that for each -gadget , its @xmath48 and @xmath49 wires form a loop .",
    "since the two endpoints both have odd parity , the length of the wire is odd . by lemma  [ lem : wire ] ,",
    "the two endpoints have opposite phases in a tiling , which is precisely what the -gadget would produce as in lemma  [ lem : variable ] .",
    "it is obvious that the @xmath91 wires fill up the even -gadgets perfectly because the boolean assignment was @xmath21-in-@xmath6 satisfying . for the odd -gadgets ,",
    "notice that since we take the leftover wires , precisely one of the three is _ negative _ at its variable endpoint .",
    "however , since we join them at a cube pair with odd parity , the wires are of odd lengths , thus precisely one of the three is positive on the free endpoint at the -gadget , as needed .",
    "this establishes the desired bijective correspondence , and implies that the construction is indeed a parsimonious reduction from @xmath21-in-@xmath6 sat to the slab tiling problem , concluding the proof of theorem  [ thm : slab ] .",
    "note that this also implies that the associated counting problem is -complete , yielding the first part of theorem  [ thm : slab - s ] ; in the next section we prove a stronger result .",
    "given a region @xmath69 as constructed from the previous section , we will enlarge it to a contractible region @xmath98 , such that @xmath99 is a frozen subregion of  @xmath9 .",
    "first we modify the variable -gadget .",
    "the following description is relative to a -gadget placed at @xmath100 .",
    "we must make these adjustments to each -gadget used . recall that in the proof of theorem  [ thm : slab ] , each @xmath89 wire was bent as in figure  [ fig:3sync ] .",
    "let us make this precise by making it bend towards the @xmath51 direction when it hits @xmath101 , and bend towards @xmath93 when it hits @xmath102 ( see figure  [ fig:4var ] ) .",
    "we define a region @xmath103 , shown in figure  [ fig:4x ] , that will fill the hole this loop makes .",
    "indeed , let @xmath104\\times[0,3]\\cup\\{(0,-1,0),(0,-1,1)\\}{\\backslash}\\{(-1,0,0),(-1,0,1)\\}$ ] .",
    "the unique tiling is indicated in the figure ; the labels will be used in the proof of lemma  [ lem:4frozen ] .",
    "similarly , the @xmath105 wires are linked together to form a loop .",
    "let us bend them towards the @xmath89 direction when they hit @xmath106 and @xmath107 , respectively , and bend towards each other when they hit @xmath108 .",
    "define a region that will fill this hole , shown in figure  [ fig:4y ] : take @xmath109\\times\\{2\\}\\times[0,5],\\ ] ] add the following six cubes @xmath110 and remove these two cubes @xmath111 call this region  @xmath112 .",
    "note that the slab labeled  @xmath106 in the figure extends behind and is hidden from view .",
    "we will add regions @xmath103 and @xmath112 to the -gadget .",
    "this makes the -gadget contractible .",
    "let @xmath113\\times[0,30(t+1)+1]\\times\\{-1\\}\\subset\\z^3 $ ] , where @xmath114 and @xmath33 are the number of variables and clauses , respectively .",
    "we then modify @xmath115 with a _ hole -gadget _ around each -gadget to allow its @xmath88 wires to pass through .",
    "indeed , figure  [ fig:4hole ] shows the construction in the @xmath116 plane viewed from below .",
    "the surrounding slabs on the boundary match that of the unique tiling of  @xmath115 .",
    "the two cube pairs missing allow the @xmath88 wires to pass through ( spaced out according to the precise construction of the -gadget in figure  [ fig:4var ] ) .",
    "the cube pairs in @xmath117 plane are necessarily tiled with its unique neighbor in the @xmath116 plane .",
    "let @xmath118\\times[-9,-2]$ ] for each @xmath83 $ ] .",
    "here we assume that the linking of the @xmath88 wires ( see figure  [ fig:3sync ] ) are done at @xmath74-coordinates , say , @xmath119 and @xmath120 , which are in @xmath121 $ ] .",
    "let @xmath68 be the disjoint union of the @xmath103 and @xmath112 for each -gadget , the region @xmath115 , and the @xmath122 for each  @xmath45 .",
    "this finishes the construction .",
    "it remains to check that that the construction works .",
    "the following two lemmas easily imply the result .",
    "the region @xmath9 constructed above is contractible .",
    "notice that there are no holes in the @xmath116 plane . in @xmath123",
    ", we may deformation retract the wires onto the @xmath122 plates , and then deformation retract these plates onto the @xmath116 plane .",
    "we now check that the modified -gadget is contractible .",
    "the center of an original -gadget was an example of a non - contractible region shown in figure  [ fig:0contract ] .",
    "indeed , the interior will leave a point hole in the middle ; however , it is filled by the slab labeled  @xmath106 in figure  [ fig:4y ] . the loop formed by the @xmath89 wire bending down",
    "is filled by  @xmath103 , while the loop formed by joining the @xmath105 wires is filled by  @xmath112 .",
    "moreover , the @xmath91 wires are all lying along @xmath115 so we may deformation retract everything to the @xmath116 plane .",
    "we omit the ( easy ) details .",
    "[ lem:4frozen ] the subregion @xmath64 is frozen .",
    "consider a cube @xmath124 .",
    "if it forms a @xmath125 region with a cube pair , then no slab containing this cube may contain its neighbor that is part of the cube pair .",
    "not counting such cube pairs , if @xmath126 only has two neighbors left , then @xmath126 must be tiled by a slab covering both these neighbors . if this happens , we call @xmath126 _ isolated _ and say that it _",
    "forces _ the unique slab containing  @xmath126 .",
    "just like in the proof of theorem  [ thm : domino - c ] , we may inductively remove these forced slabs , which are obviously frozen .",
    "consider region  @xmath122 .",
    "notice that the cube at the corner @xmath127 is isolated . after removing the slab forced by it",
    ", we may consider the new corner next to it at @xmath128 .",
    "inductively , we may remove the cubes with @xmath129 or @xmath130 .",
    "now when looking at @xmath131 , we may run into cubes that neighbor @xmath88 wires .",
    "however , these wires are made of cube pairs that form @xmath125 regions with the cubes in question .",
    "as such , we may continue the removal process unhindered .",
    "it is clear that in this manner , we may remove all cubes from  @xmath122 .    similarly , we remove most slabs from @xmath115 , starting from the boundary and working our way in .",
    "the ones sticking down out of the @xmath116 plane can also be removed , leaving us with precisely two slabs around the hole for the @xmath93 wire from the -gadget ( labeled with @xmath21 in figure  [ fig:4hole ] ) . as for each -gadget , we remove all the cubes from @xmath103 and  @xmath112 . in figure",
    "[ fig:4xy ] , the forced slabs are labeled with a sample removal order , where each number is positioned on the isolated cube used at each step . finally , we may remove the leftover slabs from  @xmath115 .",
    "now , given a @xmath21-in-@xmath6 sat expression  @xmath16 , we may take a region @xmath69 constructed in the proof of theorem  [ thm : slab ] and enlarge it to a contractible region @xmath9 as described above .",
    "since @xmath99 is frozen , @xmath9 is tileable if and only if @xmath69 is tileable .",
    "these are tileable if and only if @xmath16 is @xmath21-in-@xmath6 satisfiable , thus theorem  [ thm : slab - c ] is proved .",
    "moreover , since both reductions are parsimonious , we conclude the second counting result in theorem  [ thm : slab - s ] as well .",
    "let @xmath132 be a @xmath133 region with @xmath134 number of @xmath47 s and @xmath135 number of  @xmath21 s .",
    "we call this a _ generalized domino _ in @xmath136 dimensions of rank  @xmath134",
    ". call the @xmath134 coordinate directions that are @xmath47 cubes wide _",
    "fat_. previously we were concerned with tiling by dominoes @xmath137 and slabs @xmath138 in three dimensions .",
    "[ t : gen ] for @xmath139 , tiling ( contractible ) @xmath136-dimensional regions with @xmath140 is -complete .",
    "similarly , for @xmath141 and @xmath142 , tiling ( contractible ) @xmath136-dimensional regions with @xmath140 is -complete .",
    "note that in other cases of @xmath134 and  @xmath136 , these problems are in  ",
    "( see next section ) .",
    "we reduce specific tiling problems in @xmath11 to higher dimensions .",
    "let us first prove the statements without the contractibility constraint .",
    "suppose @xmath139 .",
    "let @xmath14 be a region as afforded by the proof of theorem  [ thm : slab ] .",
    "let @xmath143 , that is , @xmath144 . consider a tiling of @xmath68 by @xmath140 .",
    "notice that there are no @xmath79 subregion in @xmath9 , thus each tile must be oriented with two of its fat directions in the first three coordinates , the remaining @xmath145 fat directions in the next @xmath145 coordinates .",
    "this means that any @xmath140-tiling of @xmath68 induces a @xmath138-tiling of @xmath9 .",
    "it is easy to see that this correspondence is actually a bijection , finishing the proof of -completeness , and also -completeness when @xmath146 .",
    "the case of @xmath147 is straightforward .",
    "take @xmath9 from the proof of theorem  [ thm : domino ] .",
    "define @xmath148 , and follow the argument above .    to prove the result for contractible regions , proceed in the same manner , and take the regions constructed in the proof of the corresponding theorems . for @xmath139 ,",
    "take the region @xmath9 from the proof of theorem  [ thm : slab - c ] , and define @xmath68 in the same way as above .",
    "notice , however , that the above strategy does not yield a reduction from @xmath138-tilings to @xmath140-tilings in general .",
    "indeed , we used the fact that the specific @xmath14 did not contain @xmath79 subregions , which is no longer the case .",
    "the outlined argument actually still works , but more care must be taken .",
    "a tile might now be oriented with three of its fat directions in the first three coordinates .",
    "this means a @xmath140-tiling of @xmath68 will , _ a priori _ , induce a tiling of @xmath9 with slabs and the @xmath149 $ ] cube .",
    "however , in the proof of theorem  [ thm : slab - c ] , we see that no tilings of @xmath9 by slabs contain a @xmath79 subregion tiled by two slabs . as such , all @xmath140 tiles in @xmath68",
    "are still constrained to be oriented as before , with precisely two fat directions in the first three coordinates .",
    "this implies the result in this case .",
    "the same approach works for the @xmath147 case as well .",
    "take @xmath9 as in the proof of theorem  [ thm : domino - c ] , and define @xmath68 as above .",
    "now notice that in any tiling of  @xmath9 , there is no @xmath150 subregion of @xmath9 that is tiled by two dominoes , which proves the result .",
    "[ [ section ] ]    historically , the tiling problems played a crucial role in the developments of modern theoretical computer science .",
    "the tileability of the whole plane with a set of tiles was shown to be undecidable  @xcite . a version of the finite tileability problem was stated to be -complete in levin s original paper  @xcite , where he ( independently ) defined -completeness .",
    "finally , theorem  [ thm : domino ] is one of the first few applications of -completeness , developed by valiant  @xcite .      in the context of statistical physics ,",
    "the domino tiling problem is called the _ dimer problem _ , and has a long history .",
    "the classical results of fisher  @xcite and kasteleyn  @xcite express the number of domino tilings of finite regions in the plane as a certain pfaffian , equal to a square root of a determinant . a closely related _ monomer - dimer model _",
    "is -complete already in the plane  @xcite ( see also  @xcite ) .",
    "let us mention that both models can be polynomially approximated ( see  @xcite ) .",
    "we refer to  @xcite for graph - theoretic reasons precluding the pfaffian method in higher dimensions , and to  @xcite ( see also  @xcite ) for the general hardness results on _ graph homomorphisms _ , a concept generalizing perfect matchings .      in the _ general tileability problem _",
    ", a set @xmath151 of tiles is fixed , and one considers tilings with parallel translations of copies of tiles @xmath152 . for a single tile  @xmath0 ,",
    "the tileability problem is a special case , where @xmath151 consists of all reflections and rotations of  @xmath0 .",
    "let us briefly elaborate on the state of art of these tiling problems as they pertain to our results .    in the plane , when @xmath153 , _",
    "i.e. _ , when translates of a single tile are used , the tileability problem is linear in the area .",
    "however , already for @xmath154 , the tileability is -complete  @xcite .",
    "it is not known whether the corresponding counting problem is -complete .",
    "the smallest set  @xmath151 for which -completeness is known is the set of four rotations of the @xmath155-tromino and a @xmath156 $ ] square  @xcite .",
    "for simply connected regions in the plane , the authors recently found a set of @xmath157 wang tiles , which they showed to be -complete and -complete  @xcite .",
    "this construction can be further decreased to @xmath158 tiles  @xcite , and the authors conjecture that only three rectangles suffices ( see  @xcite ) .",
    "in contrast to the decision problem , it is still unclear how much the simple connectivity of regions helps counting the number of tilings , other than making the reductions harder and more technical .      in  @xcite ,",
    "valiant s goal is to show the hardness of the number of perfect matchings of grid graphs , defined as subgraphs ( of the unit distance graph ) of  @xmath159 .",
    "this is slightly weaker than the hardness of domino tilings of @xmath6-dim regions , since the latter problem corresponds to _ induced _ subgraphs of  @xmath159 .",
    "however , valiant s proof can be slightly modified , from subgraphs of @xmath160 $ ] to induced subgraphs of @xmath161 $ ] , to achieve the same goal .",
    "the proof we present in section  [ sec - domino ] is in fact a variation of the argument in  @xcite .      for tiling in three dimensions",
    ", we consider the domino and the slab . here",
    "each tile has three distinct orientations .",
    "if we only allow two out of the three orientations in either case , each problem becomes equivalent to the ordinary domino tiling problem in two dimensions , and hence is in  . of course , two orientations suffices for the tromino tile @xmath162 $ ] ( or the @xmath163 $ ] tile ) to guarantee -completeness , since we have -completeness for the @xmath164 $ ] tile .",
    "note that the _ augmentation approach _",
    ", mentioned in the introduction , allows us to show the -completeness of the tileability problem with  @xmath165 of contractible regions in  @xmath12 . to see this , start with a flat region and color the holes in a checkerboard fashion .",
    "now fill each unit cube with an up or down vertical tromino , depending on the color ( see figure  [ fig : tro ] ) .",
    "the contractible region thus obtained is tileable with  @xmath165 if and only if the starting region is tileable by @xmath164 $ ] .",
    "the conditions in theorem  [ t : gen ] are best possible .",
    "indeed , if @xmath166 or @xmath167 , we are tiling with cubes of side length @xmath21 or  @xmath47 , respectively , both of which are linear in the volume .",
    "the only remaining cases are the decision problem with @xmath168 , and the counting problem of ordinary dominoes in dimension @xmath169 , both of which are in  ",
    "( see _ e.g. _",
    "@xcite ) .",
    "the idea of graph embedding into a grid is quite standard . in this context of domino tilings",
    "it was used in  @xcite , and for other small sets of tiles in  @xcite .",
    "of course , the technical details are somewhat different in each case",
    ".      it would be interesting to see if theorem  [ thm : domino - c ] holds for contractible regions inside a @xmath160 $ ] brick , as they have a rather simple geometric structure .",
    "our proof gives only a width  @xmath106 bound , but we believe that a width  @xmath6 modification can be made without difficulty .",
    "we should mention that for every fixed  @xmath126 , the counting problem is polynomial for regions inside a @xmath170 $ ] brick .      in the plane",
    ", there are several other generalizations of domino tilings .",
    "notably , the first author introduced and studied _ ribbon tilings _ ( see  @xcite ) .",
    "another interesting set of generalized dominoes @xmath171 was studied in  @xcite .",
    "both sets satisfy the _ local move _ property : every two tilings of a s.c .",
    "region  @xmath9 can be obtained by a sequence of _ flips _ , each involving a fixed number of tiles ( @xmath47  in both cases , see  @xcite ) .",
    "for the ( usual ) domino tilings this is a classical property going back to kasteleyn and famously proved by thurston via the _ height functions _  @xcite .    of course",
    ", for the domino tilings of general regions there is no local move property , as large cycles can involve an unboundedly many tiles .",
    "however , for contractible regions , one would naturally assume that domino tilings and slab tilings are connected by flips corresponding to different tilings of @xmath172 $ ] .",
    "this is , in fact , false .",
    "as an early prequel to the constructions in the proofs of theorems  [ thm : slab - c ] and  [ thm : domino - c ] , we state the following easy result .",
    "the proof is apparent from figure  [ fig : move ] ( cf .",
    "figure  [ fig : tro ] ) . in the first case , the middle dominoes alternate between up and down . in the second case ,",
    "slabs are all vertical , with the middle slabs all one layer below",
    ".        * acknowledgements .",
    "* we are very grateful to cris moore for helpful conversations ; in particular , theorem  [ thm : slab ] arose as a question in our discussions . the first author is partially supported by the nsf and bsf grants .",
    "the second author is supported by the nsf under grant no .",
    "dge-0707424 .",
    "b. de tilire , _ the dimer model in statistical mechanics _ , lecture notes at swiss doctoral program in mathematics and",
    "the epfl doctoral school , university of neuchtel , september 2008 ; available at http://proba.jussieu.fr/~detiliere/cours/polycop_dimeres.pdf"
  ],
  "abstract_text": [
    "<S> tiling planar regions with dominoes is a classical problem in which the decision and counting problems are polynomial . we prove a variety of hardness results ( both - and -completeness ) for different generalizations of dominoes in three and higher dimensions </S>"
  ]
}