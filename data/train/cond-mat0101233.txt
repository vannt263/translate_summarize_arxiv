{
  "article_text": [
    "one of the goals of computational materials science is to calculate from first principles the various physical and chemical properties .",
    "this requires the solution of the electronic and ionic structures of the materials system in question . the density - functional theory ( dft ) makes a huge step towards this goal by casting the untractable problem of many interacting electrons to that of noninteracting particles under the influence of an effective potential @xcite .",
    "the adiabatic approximation allows one to separate the ionic degrees of freedom from those of the electrons .",
    "however , in order to apply dft in practice one has to resort to approximations for electron exchange and correlation such as the local - density approximation ( lda ) or the generalized - gradient approximation ( gga ) .",
    "moreover , in the case of systems consisting of hundreds or more atoms it is still a challenge to solve numerically efficiently for the ensuing kohn - sham equations .",
    "the numerical solution of the kohn - sham equations is the concern of our present work .",
    "it deals with real - space ( rs ) methods , in which the values of the different functions are presented using three - dimensional point grids , and the partial differential equations are discretized using finite differences @xcite .",
    "the rs methods , as suggested by the name chosen , are contrasted with the popular plane - wave ( pw ) schemes @xcite .",
    "there are several aspects favouring the rs methods over the pw methods .",
    "both of the methods are used in the context of pseudopotentials describing the electron - ion interactions , but only the rs can easily be used in all - electron calculations or with hard pseudopotentials of , _",
    "i.e. _ first - row or transition metal atoms , because the rs grid can be refined in a natural way in the ion core regions ( composite grids @xcite , adaptive coordinates @xcite ) .",
    "systems , such as surfaces , containing different length scales are more economically described in the rs than in the pw scheme because one needs not waste many grid points in the vacuum regions to describe the slowly varying tails of wave functions . in the rs methods periodic boundary conditions are not necessary .",
    "this leads to ease and accuracy in describing charged atomic clusters in contrast to pw methods requiring an artificial neutralizing background charge . besides the above `` physical arguments '' there are also methodological and computational aspects favouring the rs methods .",
    "the rs methods allow a systematic convergence control by increasing the grid ( or basis function ) density .",
    "( the pw methods do also so by adjusting the cutoff energy of the plane wave expansions . )",
    "the so - called `` order - n '' methods @xcite , the computational cost of which scales linearly with the number of electrons , require localized real - space wave functions leading naturally to the employment of rs methods @xcite .",
    "the discretizations in the real - space grid can be made local and therefore parallelization can effectively use data decomposition in which different real - space regions are handled with different processing units and the communications between processing units will be mainly short - ranged @xcite .",
    "more specifically , our choice for the numerical method is a multigrid scheme@xcite .",
    "several approaches employing the multigrid idea within electronic structure calculations have appeared during recent years @xcite .",
    "the main idea of multigrid methods is that they avoid the critical slowing - down ( csd ) phenomenon occuring when a partial differential equation discretized on a real space grid is solved with a simple relaxation method such as the gauss - seidel method .",
    "the discretization operators typically use information from a rather localized region of the grid at a time . therefore the high frequency error of the length scale of the grid spacing is reduced very rapidly in the relaxation . however , once the high frequency error has effectively been removed , the very slow convergence of the low frequency components dominates the overall error reduction rate  @xcite , _ i.e. _ csd occurs . in multigrid methods one stops the relaxation on",
    "a given ( fine ) grid before csd sets in and transfers the equation to a coarser grid ( the so - called restriction operation ) where the low - frequency components can be solved more efficiently .",
    "on the coarsest grid the problem is solved exactly or as accurately as possible , after which one interpolates ( the so - called prolongation operation ) the correction to finer grids , performing simultaneously relaxations in order to remove the high - frequency errors introduced in the interpolation .",
    "the solution of the poisson equation by multigrid methods is straightworward @xcite .",
    "this is because the error ( or the correction needed ) also obeys a poisson equation and thus will be a smooth function to be presented and solved on the repeatedly coarser grids optimal to handle the lower frequencies . the solution of an eigenvalue problem , such as the schrdinger equation , is a much more complicated task than that of the poisson equation .",
    "the problem is no more linear because both the eigenfunction and the eigenvalue have to be solved simultaneously .",
    "then the error no longer obeys the same equation as the solution .",
    "also one has to solve for several eigenpairs ( eigenvalues and corresponding eigenvectors ) .",
    "moreover , the existence of both negative and positive eigenvalues makes the problem indefinite .",
    "this implies severe difficulties for many simple iterative methods which converge only in the case of a positive definite iteration matrix .",
    "in particular , it can easily be shown that using gauss - seidel relaxation for the schrdinger equation the high frequency components typically converge as in the case of the poisson equation , but the low frequency components may diverge , although the divergence may be slow  @xcite .",
    "more complicated methods such as kaczmarz relaxation are guaranteed to converge , but may have clearly inferior high frequency reduction rates , which are essential for the overall speed of multigrid methods .",
    "other possible convergent methods include gmres  @xcite which is considerably more complex than gauss - seidel relaxation .",
    "a standard recipe for dealing with eigenproblems with multigrids is the full - approximation - storage ( fas ) method originally described by brandt  @xcite . in fas one solves for the entire problem on the coarse grids also and ends up in solving for a properly modified problem so that its solution can be used in correcting the fine grid solution .",
    "the fas method may not be very straighworward to implement for the schrdinger equation .",
    "it is also difficult to present some actual potential on the coarse levels accurately enough .",
    "however , some succesful applications of fas have appeared in the context of electronic structure calculations by beck _",
    "et al . _ @xcite and",
    "advanced strategies for fas have been proposed  @xcite .",
    "briggs _ et al . _",
    "@xcite employ a multigrid method in electronic structure calculations by linearizing the schrdinger problem and presenting the potential contribution on the coarse levels by an error term ( residual ) only . then",
    "on the coarse levels they solve effectively for the poisson problem .",
    "_ @xcite modified the method by briggs _",
    "et al . _ by shifting to a full multigrid ( fmg ) scheme and by solving on the coarse grids a problem including a local potential term .",
    "the idea of fmg is to start the smoothing iterations from a coarse grid .",
    "then the interpolation to a finer grid provides a good initial guess of the solution .",
    "the fmg scheme can accelerate the convergence remarkably with respect to the ( above - described ) v - cycle scheme in which one starts from the finest level .",
    "fattebert  @xcite used a multigrid method with a block galerkin inverse iteration ( bgii ) and gmres in the relaxations . in the method",
    ", the current approximation is kept orthogonal against all the nearby states during the multigrid cycle .",
    "the inverse iteration converges for a given guess for the energy eigenvalue towards the nearest eigenvalue . in order to solve all the desired lowest eigenstates a good guess for the eigenvalue spectrum",
    "is needed in the beginning of iterations , but thereafter large computational savings may be expected because explicit orthogonalizations are not needed ( at least between well - separated states ) .",
    "a severe problem in the existing multigrid schemes for the schrdinger equation is often that the coarse grids can not well approximate the solutions of the coarse grid equations themselves . as a consequence",
    "the correction from coarse grids , no matter how accurately the equation is solved , may be ineffective in correcting the fine grid solution and as a result the overall process converges slowly .",
    "therefore one has to restrict to the use of rather fine grids only and the convergence speed of the scheme is drastically lowered . in those multigrid methods , which use the potential also on the coarse grids",
    "the size of the coarsest grid has been typically of the order of 31x31x31 @xcite . using the fas method coarser grids are possible at least for systems with a small number of eigenstates solved @xcite .",
    "if a large number of eigenstates have to be solved problems may arise because the coarse grids may not be able to represent eigenstates with many nodes or the ordering of the states may change between the successive grids . to bypass these problems in fas ,",
    "rather complicated strategies are needed @xcite .    in order to avoid the coarse grid representation problems we utilize the so - called rayleigh quotient multigrid ( rqmg ) method introduced by mandel and mccormick @xcite . in this method",
    "the coarse grid relaxation passes are performed so that the rayleigh quotient calculated on the _ fine _ grid will be minimized . in this way",
    "there is no requirement for the solution to be well represented on a coarse grid and the coarse grid representation problem is avoided .",
    "mandel and mccormick@xcite introduced the method for the solution of the eigenpair corresponding to the lowest eigenvalue .",
    "we have generalized it to the simultaneous solution of a desired number of lowest eigenenergy states by developing a scheme which keeps the eigenstates separated by the use of a penalty functional , gramm - schmidt orthogonalization , and subspace rotations .",
    "our generalization of the rqmg method is an attractive alternative for large - scale electronic structure calculations .",
    "the kohn - sham equations have to be solved self - consistently , _",
    "i.e. _ the wave functions solved from the single - particle equation determine via the density ( solution of the poisson equation and the calculation of the exchange - correlation potential ) the effective potential for which they should again be solved . to approach this self - consistency",
    "requires an optimized strategy so that numerical accuracy of the wave functions and the potential increase in balance , enabling the most efficient convergence @xcite . in order to avoid the divergence of the self - consistency iterations , the mixing of the input and output solutions is needed . for this feedback procedure",
    "sophisticated schemes @xcite and control strategies @xcite have been presented .",
    "the outline of the present paper is as follows . in section",
    "ii we represent shortly the most important ideas of the density functional theory .",
    "section iii is devoted for numerical methods , the most important of which is the schrdinger equation solver developed .",
    "also the strategy for the self - consistency iterations is discussed . in section",
    "iv we demonstrate by the help of a couple of examples the performance of our scheme in calculating the electronic structures of small molecules and solid - state systems described by pseudopotentials .",
    "section v summarises the work and gives outlines for the future developments .",
    "in the kohn - sham method for electronic structure calculations one solves for a set of equations self - consistently @xcite . in the following ,",
    "we present the equations in the spin - compensated form . in practice",
    ", we have made the straightforward generalization using the spin - density functional theory .",
    "the set of equations reads as ( atomic units with @xmath0 are used ) : @xmath1 @xmath2 @xmath3 @xmath4 @xmath5 }        { \\delta n({\\bf r})}.\\ ] ] the first equation ( [ kohnshameq ] ) is a schrdinger equation for non - interacting particles in an effective potential @xmath6 . for finite systems",
    "the wave functions are required to vanish at the boundaries of the computation volume . in the case of infinite periodic systems",
    "the complex wave functions have to obey the bloch theorem at the cell boundaries . the electron density @xmath7 is obtained from a sum over the @xmath8 occupied states .",
    "the effective potential consists of an external potential @xmath9 due to ions ( or nuclei in all - electron calculations ) , the hartree potential @xmath10 calculated from the electron density distribution , and the exchange - correlation potential @xmath11 . in the examples of the present work we use the norm - conserving non - local pseudopotentials for the electron - ion interactions and the local - density approximation ( lda ) for the exchange - correlation energy @xmath12 = \\int \\epsilon_{\\rm xc}(n({\\bf r } ) ) n({\\bf r } )                   d{\\bf r},\\ ] ] and for the exchange - correlation potential @xmath13    the hartree potential is solved from the poisson equation @xmath14 in practice , the electron density @xmath7 is substituted by the total charge density @xmath15 , which includes the positive ionic ( nuclear ) charge neutralizing the system . in the case of finite systems , dirichlet boundary conditions are used with the coulomb potential values calculated using a multipole expansion . for periodic systems we fix the average coulomb potential to zero and allow the periodic boundary conditions to result in",
    "the corresponding converged potential .",
    "the self - consistent solution of the above kohn - sham equations leads to the ground state electronic structure minimizing the total energy [ kohnshamenergy ] @xmath16 where @xmath17 is the repulsive interaction between the ions ( nuclei ) of the system . instead of the self - consistency iterations",
    "the solution of the kohn - sham problem can be found by minimizing directly the total energy with respect to the wave function parameters , _",
    "e.g. _ plane - wave coefficients @xcite .",
    "however , kresse and furthmller @xcite have found this scheme less efficient than the self - consistency iterations .",
    "in our real space method we start from an initial guess for the effective potential and initial wave functions generated by random numbers in grid points .",
    "the wave functions and the hartree potential are updated alternatingly towards self - consistency .",
    "the solution of the poisson equation is a standard task for the multigrid scheme .",
    "if a reasonable guess for the coulomb potential is not available , the fmg method will produce the solution starting from random numbers and requiring the work which scales linearly as a function of the size of the system ( @xmath18 ) . during the kohn - sham iterations one can start from the present approximation of coulomb potential and",
    "update it with respect to the new charge density by performing only a few v - cycles .",
    "the solution of the wave functions is a much more complicated task than that of the poisson equation because one has to solve an eigenvalue problem which in the state - of - the - art electronic structure calculations means the determination of several hundreds of eigenpairs . for this purpose",
    "we have developed a scheme based on rqmg method introduced by mandel and mccormick@xcite for the solution of the eigenpair corresponding to the lowest eigenvalue .",
    "we begin by reviewing the basic principles of rqmg .",
    "this is most easily done in the framework of the so - called coordinate relaxation method .",
    "thereafter we go through the modifications made in order to simultaneously solve for several eigenpairs .",
    "coordinate relaxation is a method of solving the discretized eigenproblem @xmath19 by minimizing the rayleigh quotient @xmath20 above , @xmath21 and @xmath22 are matrix operators chosen so that the schrdinger equation discretized on a real - space point grid with spacing @xmath23 is satisfied to a chosen order @xmath24 . in eq .",
    "( [ ray ] ) @xmath25 is a vector containing the wave function values at the grid points . in the relaxation method ,",
    "the current estimate @xmath25 is replaced by itself plus a multiple of some search vector @xmath26 @xmath27 and @xmath28 is chosen to minimize the rayleigh quotient .",
    "this leads to a simple quadratic equation for @xmath28 .",
    "( find the minimum of the expression ( [ rqmgeq ] ) below with respect to @xmath28 .",
    "in the case of a complex wave function one has to solve for the real and imaginary parts of @xmath28 from a coupled pair of quadratic equations . )",
    "moreover , the search vector @xmath26 is simply chosen to be unity in one grid point and to vanish in all other points .",
    "a complete coordinate relaxation pass is then obtained by performing the minimization at each point in turn and these passes can be repeated until the lowest state is found with desired accuracy .    naturally , also the coordinate relaxation suffers from csd because of the use of local information only in updating @xmath25 in a certain point . in order to avoid",
    "it one applies the multigrid idea . in the multigrid scheme by mandel and mccormick@xcite",
    "the crucial point is that _ coarse _ grid coordinate relaxation passes are performed so that the rayleigh quotient calculated on the _ fine _ grid will be minimized . in this way",
    "there is no requirement for the solution to be well represented on a coarse grid . in practice",
    ", a coarse grid search substitutes the fine grid solution by @xmath29 where the subscripts @xmath30 and @xmath31 stand for the fine and coarse grids , respectively , and @xmath32 a prolongation operator interpolating the coarse grid vector to the fine grid .",
    "the rayleigh quotient to be minimized is then @xmath33 the second form is obtained by relating the coarse grid operators , @xmath34 and @xmath35 , with the fine grid ones , @xmath36 and @xmath37 , by the galerkin condition @xmath38 and the restriction operator @xmath39 has to be the transpose of the prolongation operator @xmath40 the key point to note is that when @xmath41 and @xmath42 are provided from the fine grid to the coarse grid , the remaining integrals can be calculated on the coarse grid itself .",
    "thus one really applies coordinate relaxation on the coarse grids to minimize the _ fine level _",
    "rayleigh quotient .",
    "this is a major departure from the earlier methods , which to some extent rely on the ability to represent the solution of some coarse grid equation on the coarse grid itself . here ,",
    "on the other hand , one can calculate the _ exact _ change in the rayleigh quotient due to _ any _ coarse grid change , no matter how coarse the grid itself is .",
    "there is no equation whose solution would have to be representable .",
    "thus , in the rayleigh quotient minimization multigrid ( rqmg ) algorithm the coordinate relaxation passes on each level keep track of the integrals in eq .",
    "( [ rqmgeq ] ) .",
    "actually , on the finest level we use gauss - seidel relaxation , which very effectively smoothens the errors of the wavelength corresponding to the grid spacing . when calculating several eigenpairs gauss - seidel relaxation may also work as a _",
    "residual minimization _ method .",
    "the idea is that the coarse grid - iterations with gramm - schmidt orthogonalization can provide the separation of the eigenstates so well that the subsequent finest level relaxations converge to the correct ( nearest ) eigenstates without orhogonalization .",
    "this requires that the effect of the coarse - level smoothings on the low - frequency components of the solutions overcomes the possible divergence tendency of these components caused by the gauss - seidel relaxation on the finest level .    moreover , we discretize the original equation separately on each grid ( discretization coarse grid approximation ( dca ) ) instead of using the galerkin conditions of eq .",
    "( [ galerkincond ] ) this may in principle decrease the convergence rate and force a limit to the coarsest possible grid in order to avoid instability or divergence .",
    "however , we have observed this dca implementation of rqmg to be quite stable and efficient . to avoid possible coarse - level instabilities occuring especially during the first few iteration cycles we may recalculate the rayleigh quotient whenever coarse grid corrections are interpolated to a finer grid . later when approaching the convergence the recalculation can be omitted .    for the matrix operators",
    "@xmath21 and @xmath22 we have used either high - order ( @xmath43 or higher ) mehrstellen or central difference stencils ( cds ) @xcite .",
    "the use of high - order stencils reduces remarkably the density of grid points needed .",
    "the benefit of the mehrstellen scheme is that more local information is used .",
    "the scheme leads to controlled accuracy and convergence properties and to more isotropic smoothing of the error in comparison with the use of cds s .",
    "the local nature enables also a more efficient parallel coding . as the prolongation operator @xmath32 we usually use trilinear interpolation and as the restriction operator @xmath39 its transpose , the so - called full - weighting operator , in which the coarse - grid values are chosen to be the averaged values of the surrounding fine grid points .",
    "the integrations are performed by the trapezoidal rule .",
    "next we consider the generalization of the rqmg method to the simultaneous solution of several ( @xmath8 ) mutually orthogonal eigenpairs .",
    "the separation of the different states is divided into two or three subtasks .",
    "first , in order to make the coarse grid relaxations converge towards the desired state we apply a penalty functional scheme . given the @xmath44 lowest eigenfunctions , the next lowest , @xmath45th state is searched for by minimizing the functional @xmath46 the overlap integral in the penalty term is squared to make the penalty positive definite .",
    "the denominator is required to make the functional independent of the norms of @xmath47 .",
    "the minimization of this functional is equivalent to imposing the orthonormality constraints against the lower @xmath44 states , when @xmath48 . by increasing the shifts",
    "@xmath49 any desired accuracy can be obtained , but in order to obtain a computationally efficient algorithm a reasonable finite value should be used , for example @xmath50 where @xmath51 is a sufficiently large positive constant . in our test calculations",
    "@xmath51 is of the order of @xmath52 ha .",
    "we minimize the expression  ( [ rqmgneq ] ) _ simultaneously _ for all @xmath8 states .",
    "this simplifies the algorithm and enables a future parallelization over the eigenstates .",
    "thus the current approximations are used for @xmath53 . moreover ,",
    "changes in the @xmath54 during a given relaxation sweep are not used to update the penalty term in eq .",
    "( [ rqmgneq ] ) .",
    "this is sufficient , when the states are always ordered in the same way , in the order of increasing eigenvalue . in order to reduce computations ,",
    "the @xmath22-innerproduct is actually used in calculating the penalty term integrals because the values of @xmath55 are readily available from the finer level .",
    "the substitution ( [ rqmgchgeq ] ) is introduced in the functional  ( [ rqmgneq ] ) and the minimization with respect to @xmath28 leads again to a quadratic equation .",
    "this time the coefficients contain terms due to the penalty part .    on the finest level",
    ", we do not apply the minimization of the penalty functional .",
    "the ideal situation would be if a residual minimization method , such as the gauss - seidel method , would keep the states calculated on the coarse levels separated .",
    "we found out in practical calculations that this is not true at least when the states are far from convergence .",
    "therefore we have developed for the finest level a scheme which by employing gramm - schmidt orthogonalization and subspace rotation keeps the eigenstates orthogonal .",
    "the subspace rotation is a method to find the most optimally separated eigenvectors from the approximative ones .",
    "the major steps of the rotation are :    \\(i ) calculation of the hamiltonian matrix elements between the current states : @xmath56    \\(ii ) calculation of the overlap matrix : @xmath57 the use of matrix elements of eqs .",
    "( [ rot1 ] ) and ( [ rot2 ] ) leads to eigenvectors orthogonal in the desired euclidian sense ( @xmath58-orthogonal ) and not in the sense of the @xmath22-innerproduct .",
    "\\(iii ) diagonalization to find the optimal eigenvectors ( @xmath59 ) and corresponding eigenvalues ( @xmath60 ) : @xmath61 in practice , we apply the approximation @xmath62    the gramm - schmidt orthogonalization and the subspace rotations are organized so that the space of the eigenvectors is first divided to small clusters corresponding to close eigenvalues .",
    "the gramm - schmidt orthogonalization is then performed for each cluster at a time so that its eigenvectors become orthogonal against the eigenvectors of the clusters of lower eigenvalues .",
    "then a subspace rotation is performed within the states belonging to the present cluster .",
    "the division to clusters reduces remarkably the cost of the subspace rotation .",
    "this is because the cost is proportional to @xmath63 ) , where @xmath8 is the number of states rotated .",
    "moreover , the subspace rotation requires the calculation of matrix elements which are more complicated than those for the simple gramm - schmidt orthogonalization .    according to our test calculations this subspace rotation scheme leads quite effectively to @xmath58-orthogonal eigenstates .",
    "this is seen as a convergence of the eigenvalue problem within the numerical accuracy , _",
    "i.e. _ the residuals of different eigenstates vanish . in order to prove this one has , in practice , to introduce potential shifts which reduce the number of significant digits in the eigenvalues so that the numerical accuracy of the eigenvalue does not prevent to reach the numerical accuracy of the wavefunction , _",
    "i.e. _ the vanishing residual .",
    "the error in the eigenvalue scales as the square of the residual .",
    "when applying the subspace rotation it is important to complete the highest eigenvalue cluster ; otherwise the rotation may become inefficient .",
    "the orthogonalization needed scales as @xmath64 . for small systems of several tens of eigenpairs",
    "this is not yet a problem .",
    "the algorithm is effective and the number of fine grid orthogonalizations remains quite plausible , for example , in comparison with the conjugate gradient search of eigenpairs employing only the finest grid @xcite .",
    "but for larger systems with hundreds of states it will be the bottleneck .",
    "one solution could be to rely on the finest level only on a residual minimization method when the initial stages of the iteration process have been performed and the solution is clearly on a stable track towards convergence .",
    "the kohn - sham problem has to be solved self - consistently .",
    "this means that an optimal strategy is needed so that computing time is not wasted in the beginning of the self - consistency iterations to obtain unnecessarily accurate wave functions , because these will change during the later iterations due to the changes in the potential .",
    "updating the potential , including the solution of the poisson equation , is a much less time - consuming task than the update of all the wavefunctions .",
    "therefore the potential update can be performed frequently @xcite .",
    "the examples of this paper are small - molecule and bulk - solid systems described by pseudopotentials .",
    "the strategy used is schematically presented in fig .",
    "[ fig : strategy ] .",
    "similar strategies can certainly be applied in other kind of kohn - sham calculations , for example in those employing all - electron or jellium - type models . in the examples of this work",
    "the initial electron density is the superposition of the pseudoatom densities centered around given nuclear positions .",
    "from the superposition we calculate the initial effective potential , where the wavefunctions are solved accurately enough using the full - multigrid method .",
    "the fmg process is started from random numbers for the wavefunctions on the coarsest level .",
    "the accuracy of the wavefunctions is controlled by calculating the norms of the residuals of the eigenstates and it is finally improved by adding more v - cycles starting from the finest level . a certain accuracy is needed in order to initiate self - consistency iterations which converge without large density oscillations . then the new electron density and the ensuing effective potential are calculated .",
    "the new potential is not directly fed into the next iteration but it is mixed in this place , as well as later between the self - consistency iterations , with the input potential of the iteration .",
    "we monitor the accuracy of the wave functions by calculating their residuals and require that the accuracy has improved from the previous iteration .",
    "usually one v - cycle is sufficient for this , because the changes in the potential are small .",
    "an important point is also to find a proper balance with respect to the pre- and postsmoothening sweeps on the different grid levels . typically , on the finest level we made two pre- and postsmoothening sweeps whereas on the coarser grids their number is four",
    "actually , this means that on the finest level four successive sweeps are done if the potential is not updated .",
    "a potential update is always preceded and followed by two immediate smoothening sweeps .",
    "we test the performance of our scheme by calculating the self - consistent electronic structures of a co@xmath65 molecule as well as that of perfect bulk si lattice with a supercell of 64 si atoms .",
    "the former system is an example of the employment of dirichlet boundary conditions and the use of `` hard '' pseudopotentials whereas the latter system represents the use of periodic boundary conditions and a supercell size typical in electronic structure calculations for point defects in solids .",
    "the ions are described by pseudopotentials of the kleinman - bylander form @xcite , @xmath66 where @xmath67 is a normalization factor , @xmath68 and @xmath69 , @xmath70 are the atomic pseudopotential wave functions of angular and azimuthal momentum quantum numbers @xmath71 , from which the @xmath72-dependent ionic pseudopotentials @xmath73 are generated using the troullier - martins scheme @xcite .",
    "the ion core is assumed to be spherically symmetric .",
    "@xmath74 is the difference between the @xmath72-component of the ionic pseudopotential and the local ionic potential .",
    "we have chosen the s - component of the pseudopotential as the local component .    because the functions @xmath75 are short - ranged , operating on the wave - function by the nonlocal parts of the pseudopotential is in practice a multiplication by a sparse matrix . the numerical work required to compute this scales as the square of the number of atoms in the system , whereas in the conventional reciprocal - space formulation",
    "the work scales as the cube of the system size .",
    "the advantage of implementing the nonlocal pseudopotentials in real space has been noted also in the context of plane - wave methods @xcite .    in the previous multigrid implementations of the pseudopotential method @xcite ,",
    "the nonlocal parts have only been employed on the finest grid .",
    "it is , however , straightforward to implement them also on the coarse levels , and we have found that this may increase the convergence rate and stability of the method .    the co@xmath65 molecule is placed diagonically in the center of a cubic computation volume of the size of ( 12.6 a@xmath76 .",
    "experimental bond lengths are used .",
    "dirichlet boundary conditions are used so that the potential values outside the cube are obtained from a multipole expansion of the charge density .",
    "the point mesh used is 63@xmath77 , giving the grid spacing @xmath23 = 0.20 a@xmath78 .",
    "the mehrstellen discretization by briggs _",
    "@xcite is used . in this calculation",
    "we used a mixing scheme , where the new effective potential @xmath79 is obtained from the input and output potentials according to @xmath80    the convergence of the self - consistency iterations employing the strategy described above ( fig .",
    "[ fig : strategy ] ) is shown in fig . [ co2 ] .",
    "the deviation of the total energy from the converged value is given as a function of self - consistency iteration steps performed .",
    "the zeroth iteration is a full - multigrid solution for the wavefunctions in the initial potential .",
    "two v - cycles are performed on the finest level at this point .",
    "the effective potential obtained from the output electron density was mixed with the initial potential using the feedback @xmath81 .",
    "next , at iteration one , the wave - functions are relaxed in this new potential using one v - cycle . from this point on",
    ", the four curves in the figure give the convergence with different values of the feedback parameter @xmath82 .",
    "one v - cycle per one self - consistency iteration step is done .",
    "a wide range of values for @xmath82 gives satisfactory convergence indicating a robust behaviour for the scheme .",
    "the accuracy of 1 mev , which is sufficient in practical calculations , is reached after three or four v - cycles .",
    "the implementation of the non - local parts of the pseudopotential on the coarse levels is found to speed up the convergence especially in this region . from fig .",
    "[ co2 ] we obtain an average convergence rate of approximately one decade per self - consistency iteration .",
    "this is of the same order as those reported by wang and beck @xcite in their fas scheme or by kresse and furthmller @xcite in their pseudopotential scheme employing self - consistency iterations .",
    "the convergence rate of one decade per self - consistency iteration is better than that obtained by ancilotto _",
    "@xcite in the fmg scheme and much better than the rate reached in the linearized multigrid scheme by briggs _ et al .",
    "_ @xcite .",
    "we have solved for the electronic structure of perfect si lattice described by a supercell of 64 si ions .",
    "the lattice constant of 20.38 a@xmath78 used is the equilibrium value obtained in a plane - wave calculation , with which we have compared our real - space results .",
    "the first brillouin zone is sampled in this test using the @xmath83-point only .",
    "the point mesh used for the wave - functions is 64@xmath77 , giving the grid spacing @xmath23 = 0.32 a@xmath78 . for the densities and potentials we use a finer grid of 128@xmath77 points .",
    "the other numerical parameters and the iteration strategy are the same as in the co@xmath65 test . the resulting valence electron density on the ( 110)-plane is given in fig .",
    "[ si110 ] .",
    "the area of the figure corresponds to the extent of the supercell .",
    "one notes that exactly the same features are reproduced at the equivalent points in different regions of the supercell .",
    "this means that a fully converged result has been found .",
    "we have compared the results of our real - space code to those obtained using the plane - wave method .",
    "the energy cutoff , 18 ry , of the plane - wave expansion was chosen so that it results in a real - space point mesh of 64@xmath77 , _",
    "i.e. _ it is the same as in our real - space calculation .",
    "the widths of the valence band and band gaps obtained by the two methods agree with an accuracy of 3 mev . in the case of degenerate",
    "eigenstates the real - space code results in degenerate eigenenergies with an accuracy better than 1 mev .",
    "the convergence towards to the self - consistent solution occurs similarly as for the co@xmath65 molecule in fig .",
    "thus , the convergence process seems to be independent of the size of the system .",
    "in this work we have generalized the rqmg method introduced by mandel and mccormick @xcite for the simultaneous solution of a desired number of lowest eigenenergy states .",
    "this approach can be viewed as belonging to a third group of multigrid methods , in addition to fas and the techniques where the eigenproblem is linearized ( _ e.g .",
    "inverse iteration_. in principle , one can use arbitrarily coarse grids in rqmg , whereas in the other multigrid methods one has to be able to represent all the states on the coarsest grid .",
    "we have demonstrated the feasibility of the method by electronic structure calculations for the co@xmath65 molecule and bulk si described by pseudopotentials .",
    "our strategy for the self - consistent solution consists of a full - multigrid solution for the wave - functions in the initial potential , and subsequent self - consistency iterations .",
    "less than five v - cycles are generally sufficient for practically sufficient accuracy .",
    "the cpu - times required for the fmg and scf steps are roughly equal .",
    "we have applied the method also in two - dimensional problems for quantum dots employing the current - spin - density functional theory , in three - dimensional cylindrically symmetric systems , and also for calculation of positron states in solids .",
    "we believe that our method will eventually compete with the standard plane - wave methods for electronic structure calculations .",
    "however , some straightforward programming is still required . for calculations , where the optimization of the ionic structure is necessary ,",
    "the hellmann - feynman forces will be implemented . in order to remove the spurious dependence of the total energy on the position of the atoms with respect to the grid points , fourier - filtering of the pseudopotentials is required .",
    "complex wave functions for any k - point are easily implemented , and are already in use in two - dimensional geometries .",
    "parallelization over k - points can be done easily .",
    "one only needs to communicate the electron density and effective potential at the end of each v - cycle . during the rqmg v - cycle ,",
    "the states are all relaxed simultaneously and independently of each other .",
    "therefore parallelization over states is natural and easy to implement .",
    "however , for larger systems the gramm - schmidt orthogonalization becomes very inefficient in a state - parellel code .",
    "the most efficient and yet straightforward choice is real - space data decomposition , where each processor is mapped to a specific region of space .",
    "m.h . acknowledges stimulating discussions with prof .",
    "s. f. mccormick and prof . t. l. beck . t.t . acknowledges financial support by the vilho , yrj and kalle visl foundation .",
    "this research has been supported by the academy of finland through its centre of excellence programme ( 2000 - 2005 ) .    for a review ,",
    "see r. o. jones and o. gunnarsson , rev .",
    "phys . * 61 * , 689 ( 1989 ) .",
    "t. l. beck , rev .",
    "phys . * 72 * , 1041 ( 2000 ) .",
    "t. a. arias , rev .",
    "phys . * 71 * , 267 ( 1999 ) .",
    "m. c. payne , m. p. teter , d. c. allan , t. a. arias , and j. d. joannopoulos , rev .",
    "64 * , 1045 ( 1992 ) .",
    "g. kresse and j. furthmller , phys .",
    "b , * 54 * , 11169 ( 1996 ) .",
    "d. bai and a. brandt , siam j. sci .",
    "* 8 * , 109 ( 1987 ) .",
    "e. j. bylaska , s. r. kohn , s. b. baden , a. edelman , r. kawai , m. e. g. ong , and j. h. weare , in _ proc . of the 7th siam conference on parallel processing for scientific computation _",
    "( san francisco , 1995 ) p. r5471 .",
    "fattebert , j. comput . phys . * 149 * , 75 ( 1999 ) . f. gygi and g. galli , phys .",
    "b , * 52 * , 2229 ( 1995 ) .",
    "n. a. modine and g. zumbach and e. kaxiras , phys . rev .",
    "b , * 55 * , 10289 ( 1997 ) .",
    "u. v. waghmare , h. kim , i. j. park , m. modine , p. maragakis , e. kaxiras , modelling and simulation in materials science and engineering , in print ( cond - mat/0006183 ) . s. goedecker , rev .",
    "phys . * 71 * , 1085 ( 1999 ) .",
    "fattebert and j. bernholc , phys .",
    "b , * 62 * , 1713 ( 2000 ) . e. l. briggs and d. j. sullivan and j. bernholc , phys .",
    "b , * 54 * , 14362 ( 1996 ) .",
    "a. brandt , math .",
    "comp . * 31 * , 333 ( 1977 ) .",
    "e. l. briggs and d. j. sullivan and j. bernholc , phys .",
    "b , * 52 * , 5471 ( 1995 ) .",
    "f. ancilotto , p. blandin , and f. toigo , phys .",
    "b , * 59 * , 7868 ( 1999 ) .",
    "j. wang and t. l. beck j. chem . phys . *",
    "112 * , 9223 ( 2000 ) .",
    "f. f. grinstein and h. rabitz and a. askar , j. comput .",
    ", * 49 * , 4423 ( 1983 ) . y. saad and m. h. schultz , siam j. sci . stat . comput . , * 7 * , 856 ( 1986 ) .",
    "a. brandt , s. f. mccormick and j. w. ruge , siam j. sci .",
    "comput . * 4",
    "* , 244 ( 1983 ) .",
    "t. l. beck and k. a. iyer and m. p. merrick , int .",
    "j. quantum chem . * 61 * , 341 ( 1997 ) .",
    "s. costiner and s. taasan , phys .",
    "e , * 52 * , 1181 ( 1995 ) .",
    "j. mandel and s. mccormick , j. comput .",
    "* 80 * ( 1989 ) 442 .",
    "g. kresse and j. furthmller , comput . mat .",
    "* 6 * , 15 ( 1996 ) .",
    "a. p. seitsonen and m. j. puska and r. m. nieminen , phys . rev .",
    "b , * 51 * , 14057 ( 1995 ) .",
    "l. kleinman and d. m. bylander , phys .",
    "lett . , * 48 * , 1425 ( 1982 ) .",
    "n. troullier and j. l. martins , phys .",
    "b * 43 * , 1993 ( 1991 ) .",
    "r. d. king - smith , m. c. payne and j. s. lin , phys . rev .",
    "b * 44 * , 13063 ( 1991 ) ."
  ],
  "abstract_text": [
    "<S> a general real - space multigrid algorithm for the self - consistent solution of the kohn - sham equations appearing in the state - of - the - art electronic - structure calculations is described . </S>",
    "<S> the most important part of the method is the multigrid solver for the schrdinger equation . </S>",
    "<S> our choice is the rayleigh quotient multigrid method ( rqmg ) , which applies directly to the minimization of the rayleigh quotient on the finest level . </S>",
    "<S> very coarse correction grids can be used , because there is no need to be able to represent the states on the coarse levels . </S>",
    "<S> the rqmg method is generalized for the simultaneous solution of all the states of the system using a penalty functional to keep the states orthogonal . </S>",
    "<S> the performance of the scheme is demonstrated by applying it in a few molecular and solid - state systems described by non - local norm - conserving pseudopotentials .    </S>",
    "<S> = 10000    2 </S>"
  ]
}