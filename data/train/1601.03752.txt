{
  "article_text": [
    "inspired by the @xmath0-adic deformation theory of modular forms , mazur developed a deformation theory for galois representations that has played a central role in modern algebraic number theory . if the fixed mod @xmath0 galois representation arises from a modular eigenform , the @xmath0-adic deformation theory of its hecke eigensystem can naturally be viewed as part of the @xmath0-adic deformation theory of the galois representation . a natural ( but vague ) question is : are these two deformation theories _ the same _ ?",
    "one way to make this precise is to ask whether or not the universal deformation ring for the mod @xmath0 galois representation is isomorphic to an appropriate  big \" @xmath0-adic hecke algebra .",
    "such a result is know as a ",
    "big @xmath2 \" theorem , and implies that the theories of galois representations and automorphic forms are intimately connected even when one leaves the geometric world .",
    "this is further illustrated by emerton s strategy for proving the fontaine ",
    "mazur conjecture , which is to start with a big @xmath2 theorem , and then identify the geometric locus inside deformation space with the classical modular points @xcite .",
    "the theory of pseudo - representations often allows one to deduce the existence of a surjection from a universal deformation ring @xmath3 to a big @xmath0-adic hecke algebra @xmath4 . in these situations ,",
    "a big @xmath2 theorem follows from knowing that the classical automorphic points in @xmath5 are zariski dense ( at least up to reduced quotients ) .",
    "the first such result was proved by gouva and mazur @xcite in the context of @xmath6 over @xmath7 , under the assumption that the universal deformation ring is formally smooth , i.e. a power series over @xmath8 , of the expected dimension .",
    "they constructed a sort - of fractal in the rigid analytic generic fibre of @xmath5 that they called the _",
    "infinite fern_. the infinite fern shows that the zariski closure of the modular points has large dimension , and adding the assumption that @xmath3 is a power series over @xmath8 of the correct dimension implies the zariski density .",
    "bckle improved on this @xcite using a novel idea .",
    "he used explicit computations of local deformation rings @xcite together with small @xmath9 equals @xmath4 theorems ( of the type proved by taylor and wiles ) to show that every irreducible component of universal deformation space contains a smooth modular point , under certain conditions on the residual representation .",
    "the smoothness of the point allows one to deduce that the component has the correct dimension , then the infinite fern implies the modular points are zariski dense in that component .    in higher dimensions or for more general number fields ,",
    "the situation is more subtle ( see @xcite*1.1 ) , and the naive generalization of the zariski density statement in the rigid analytic generic fibre is false in general ( see @xcite and @xcite*5 ) .",
    "however , if one restricts to _ polarized _ representations of the galois group of cm or totally real fields , then the situation is much more hopeful , and a precise conjecture was made by chenevier @xcite*conjecture  1.15 .",
    "chenevier @xcite expanded and refined the construction of gouva and mazur to three dimensional galois representations for cm fields @xmath10 in which @xmath0 is totally split and to two dimensional galois representations for totally real fields @xmath10 of even degree over @xmath7 in which @xmath0 is totally split .",
    "chenevier thus proves his conjecture , which is a higher dimensional analogue of the gouva ",
    "mazur conjecture , in these situations under the additional assumption that the universal deformation ring is formally smooth of the correct dimension .    in this paper",
    "we give a new and more geometric interpretation of bckle s strategy , which affords strong generalization . in principal ,",
    "our methods apply any time the  numerical coincidence \" discussed in @xcite*1 holds .",
    "we focus on the case of polarized representations of galois groups of cm fields ( in arbitrary dimension ) , and two dimensional representations of totally real fields . in order to state some of our main results , we set up some notation .",
    "let @xmath10 be a cm field with maximal totally real subfield @xmath11 .",
    "let @xmath12 be a finite set of finite places of @xmath11 containing all those that ramify in @xmath10 , let @xmath13 be the maximal extension of @xmath10 unramified outside of the places above those in @xmath12 , and set @xmath14 .",
    "let @xmath15 be a finite extension of @xmath16 with ring of integers @xmath8 and residue field @xmath17 .",
    "assume we are given a continuous absolutely irreducible @xmath18 such that @xmath19 , where @xmath20 is some choice of complex conjugation , @xmath21 is the conjugate representation given by @xmath22 for all @xmath23 , @xmath24 is the @xmath17-linear dual of @xmath25 , and @xmath26 is the mod @xmath0 cyclotomic character .",
    "letting @xmath3 denote the universal deformation ring for @xmath25 on the category of complete noetherian local @xmath8-algebras with residue field @xmath17 , there is a quotient @xmath27 of @xmath3 that is universal for deformations @xmath28 such that @xmath29 ( see  [ sec : polardefring ] ) .",
    "the galois representations associated to regular algebraic conjugate self dual cuspidal automorphic representations of @xmath30 that lift @xmath25 naturally yield @xmath31-points of @xmath32 .    [ thm : intromain ] fix @xmath33 .",
    "assume @xmath34 and that every place above @xmath0 in @xmath11 splits in @xmath10 .",
    "assume there is a regular algebraic conjugate self dual cuspidal automorphic representation @xmath35 of @xmath30 such that @xmath36 is isomorphic to the mod @xmath0 galois representation attached to @xmath35 and @xmath37 .",
    "assume further :    either    * @xmath38 is potentially diagonalizable for each @xmath39 in @xmath10 , or * @xmath35 is @xmath37-ordinary .",
    "@xmath40 is adequate and @xmath41 .    for each @xmath39 in @xmath10",
    ", there is no nonzero @xmath42$]-equivariant map @xmath43 .    then for any irreducible component @xmath44 of @xmath32 , there is a regular algebraic conjugate self dual cuspidal automorphic representation whose associated galois representation determines a @xmath31-point of @xmath44 .",
    "we refer the reader to [ thm : mainpd , thm : mainord ] below for slightly more general and refined statements , to  [ sec : local ] for the definition of a potentially diagonalizable representation , to  [ sec : autgalrep ] for a discussion of regular algebraic polarizable cuspidal automorphic representations and their associated galois representations , and to [ def : gladequate ] for the definition of an adequate subgroup of @xmath45 .",
    "the characteristic zero points on universal polarized deformation rings arising from regular algebraic polarized cuspidal automorphic representation are know to be formally smooth in a great deal of generality , see @xcite*theorem  c and @xcite*corollaire  4.13 . combining this with our main theorems and chenevier s infinite fern ,",
    "we obtain new cases of chenevier s conjecture ( [ thm : dim3dense ] below ) :    [ thm : introdense ] fix @xmath33 .",
    "assume that @xmath46 , and that @xmath47 .",
    "assume there is a regular algebraic conjugate self dual cuspidal automorphic representation @xmath35 of @xmath48 such that @xmath25 is isomorphic to the mod @xmath0 galois representation attached to @xmath35 and @xmath37 .",
    "assume further :    @xmath0 is totally split in @xmath10 .    for each @xmath39 in @xmath10",
    ", @xmath49 is unramified and @xmath38 is potentially diagonalizable .",
    "if @xmath50 , then we further assume that @xmath35 is @xmath37-ordinary .",
    "@xmath40 is adequate and @xmath41 .    for each @xmath39 in @xmath10",
    ", there is no nonzero @xmath42$]-equivariant map @xmath43 .",
    "then , letting @xmath51 denote the rigid analytic generic fibre of @xmath52 , the set of points in @xmath51 induced by galois representations associated to regular algebraic conjugate self dual cuspidal automorphic representation of level prime to @xmath0 is zariski dense .",
    "we refer the reader to ",
    "[ sec : genfib ] for an overview of the rigid analytic generic fibre . along the way to proving [ thm : introdense ]",
    "we deduce nice ring theoretic properties for @xmath27 ( [ thm : cmgeom ] below ) .",
    "however , using potentially automorphy theorems , we can prove these nice ring theoretic properties in many cases without assuming residual automorphy .",
    "for example :    [ mainthm : cmgeom ] assume that @xmath53 and that every @xmath39 in @xmath11 splits in @xmath10 .",
    "assume further :    @xmath54 is absolutely irreducible .    for each @xmath39 , if we write the semisimplification of @xmath55 as @xmath56 with each @xmath57 irreducible , then @xmath58 for any @xmath59 .",
    "then @xmath27 is an @xmath8-flat , reduced , complete intersection ring of dimension @xmath60 $ ] .",
    "we refer the reader to [ thm : potcmgeom ] for a more general statement ( see [ rmk : pdlift ] ) .",
    "this can be seen as answering a polarized version of a question of mazur @xcite*1.10 in many cases .",
    "we also prove similar theorems in the context of @xmath6 over a totally real field , [ thm : mainhilbdet , thm : mainhilb , thm : hilbgeom , thm : hilbdense ] below , and our results even yield new cases over @xmath7 ( see [ rmk : overq ] ) . most of the assumptions in the above theorems , and in any of the main theorems below , are used to invoke results in the literature . in particular , improvements in ( small ) @xmath61 theorems or improvements in the infinite fern would immediately yield improvements in [ thm : intromain , thm : introdense ] , respectively .",
    "the only additional assumption imposed in this paper is the assumption that there are no nonzero @xmath42$]-equivariant maps @xmath43 .",
    "this is used to guarantee that the universal lifting rings of the local representations @xmath55 are regular for each @xmath39 .",
    "we explain how this is used below .      as in bckle",
    "s work , we use a small @xmath61 theorem to show that every irreducible component of the universal deformation ring contains an automorphic point . under appropriate assumptions , including one that implies the universal local lifting ring at @xmath0 is regular , bckle shows that a suitable locus ( i.e. finite flat or ordinary ) inside the universal local deformation space is cut out by the  right number \" of equations . in order to do this , he uses explicit computations of local deformation rings , due to ramakrishna @xcite in the finite flat case , and due to himself @xcite in the ordinary case . in arbitrary dimensions , the local fontaine ",
    "laffaille deformation rings are known to be power series in the correct number of variables , so one could proceed as in @xcite .",
    "however , explicitly computing ordinary deformation rings in arbitrary dimensions seems intractable ( even dimension two is hard ) .",
    "more importantly , in higher dimensions there are many types of mod @xmath0 galois representations that have neither fontaine  laffaille nor ordinary lifts , so one would like a strategy that works for more general local conditions .",
    "the main idea of this paper is that using the _ finiteness _ of the universal global polarized deformation ring @xmath27 over the universal local lifting ring @xmath62 at places dividing @xmath0 ( a principle the author first learned from frank calegari s blog persiflage @xcite , see also @xcite ) we can turn our problem into one of intersections in @xmath63 .",
    "this has the effect of allowing us to weaken a _ global _ unobstructedness assumption to a _",
    "unobstructedness assumption .",
    "more specifically , armed with a small @xmath61 theorem , we can deduce the existence of an automorphic point on any irreducible component @xmath44 of @xmath32 if we prove that the intersection of @xmath44 and the generic fibre of our small deformation ring @xmath9 inside @xmath32 is nonempty . using the finiteness of @xmath27 over @xmath62",
    ", we first turn this into a problem of an intersection in @xmath63 .",
    "since @xmath62 is regular , we can use intersection theory in regular local rings and the lower bound for @xmath64 arising from galois cohomology to prove that the intersection of the image of @xmath44 in @xmath63 with the appropriate fixed weight @xmath0-adic hodge theoretic locus @xmath65 has dimension @xmath66 .",
    "one then uses the finiteness of @xmath27 over @xmath62 again to show there is a dimension @xmath67 point on the intersection of @xmath44 and our small deformation ring @xmath9 .",
    "but the small @xmath61 theorem implies @xmath9 is finite over @xmath68 , hence this point must be in the generic fibre .",
    "let us make a few remarks .",
    "firstly , it is crucial for our method that we know our small deformation ring is finite over @xmath68 .",
    "hence , it is not just the automorphy of @xmath0-adic galois representations that we need , but the underlying @xmath61 ( or @xmath69 ) theorems .",
    "secondly , the author thinks it is interesting to compare the above with one heuristic justification for the fontaine  mazur conjecture .",
    "namely , since the conjectural dimension of @xmath70 $ ] plus the dimension of our fixed weight @xmath0-adic hodge theoretic locus @xmath65 in @xmath71 $ ] equals the dimension of @xmath71 $ ] ( in favourable situations ) , one might imagine they intersect at finitely many points , and maybe even transversely .",
    "the assumption of residual automorphy guarantees that this intersection is nonempty , and a small @xmath61 theorem implies that this intersection is a finite set of points .",
    "the main theorems in this article and their method of proof ( under the appropriate assumptions ) imply that if @xmath70 $ ] intersects @xmath65 , then every irreducible component of @xmath70 $ ] intersects @xmath65 .    finally , since the argument above uses only the dimension of @xmath65 and that a small @xmath2 theorem is known for the @xmath0-adic hodge theoretic conditions defined by @xmath65 , this allows us flexibility in the choice of @xmath65 , provided it is nonzero and has the correct dimension .",
    "for example , we can use this to conclude existence of automorphic points on each irreducible component of @xmath32 whose local representations at places dividing @xmath0 have certain pre - prescribed local properties .",
    "it is natural to wonder what happens when @xmath62 is not regular .",
    "we discuss an example in ",
    "[ sec : eg ] that illustrates the subtleties in this case .",
    "more specifically , we use an example of serre to show that the conclusion of our main lemma , [ thm : thelemma ] , may not hold when @xmath62 is not regular .",
    "in particular , one no longer has the flexibility in the choice of @xmath65 as discussed above , and proving the main theorems of this paper in this case seems to require a better understanding of the irreducible components of the universal deformation rings in question .",
    "in  [ sec : mainlem ] we first recall a fact from intersection theory in regular local rings and prove our main lemma .",
    "we then recall the rigid analytic generic fibre of a affine formal scheme , and gather some facts regarding the relationship between the irreducible components of the generic fibre with those in underlying affine scheme . in  [ sec : gendef ] we recall some basics in deformation theory , in particular presentations and polarized deformation rings .",
    "we gather results from the literature on local deformation rings in  [ sec : local ] . in  [ sec : autgalrep ] we recall the notion of regular algebraic polarized cuspidal automorphic representations and their associated galois representations . in  [ sec : cm ] we prove our main theorems for polarized galois representations of cm fields .",
    "we do this after first recalling the small @xmath61 theorems that we use in the proofs of our main theorems .",
    "finally ,  [ sec : hilb ] treats the case of @xmath6 over totally real fields .",
    "i would like to thank frank calegari for many helpful discussions ; the main idea used in this article had its genesis in our joint work @xcite .",
    "i would like to thank gebhard bckle for comments on a previous version of this article .",
    "i would like to thank toby gee for questions and correspondence that led to an improvement of the main results , namely replacing ",
    "fontaine  laffaille \" with  potentially diagonalizable . \"",
    "we fix a prime @xmath0 and an algebraic closure @xmath31 of @xmath16 .",
    "we let @xmath72 and @xmath73 denote the ring of integers and residue field , respectively , of @xmath74 , and let @xmath75 be the maximal ideal of @xmath72 . throughout @xmath15",
    "will denote a finite extension of @xmath16 inside @xmath31 .",
    "we let @xmath8 and @xmath17 denote the ring of integers and residue field , respectively , of @xmath15 .    we denote the maximal ideal of a commutative local ring @xmath76 by @xmath77 .",
    "we let @xmath78 be the category of complete local commutative noetherian @xmath8-algebras @xmath76 such that the structure map @xmath79 induces an isomorphism @xmath80 , and whose morphisms are local @xmath8-algebra morphisms",
    ". we will refer to an object , resp .",
    "a morphism , in @xmath78 as a @xmath78-algebra , resp .",
    "a @xmath78-morphism .",
    "let @xmath9 be a commutative ring equipped with a canonical map @xmath81 , resp .",
    "@xmath82 , with @xmath83 a universal lifting ring , resp .",
    "@xmath3 a universal deformation ring ( see  [ sec : gendef ] ) .",
    "then for any homomorphism @xmath84 , with @xmath76 a commutative ring , we denote by @xmath85 the pushforward of the universal lift , resp .",
    "universal deformation , via @xmath86 , resp . via @xmath87 .    throughout @xmath10",
    "will denote a number field . a cm field",
    "is always assumed to be imaginary .",
    "if @xmath10 is cm , its maximal totally real subfield of will be denoted by @xmath11 , and @xmath88 will denote the nontrivial @xmath89-valued character of @xmath90 .",
    "we fix an algebraic closure @xmath91 of @xmath10 and set @xmath92 .",
    "we will assume that all finite extensions @xmath93 are taken in @xmath91 .",
    "if @xmath93 is a finite galois extension and @xmath12 is a finite set of finite places of @xmath10 , we let @xmath94 denote the maximal extension of @xmath95 that is unramified outside of any of the places in @xmath95 above those in @xmath12 and the archimedean places . throughout @xmath96",
    "will denote a primitive @xmath0th root of unity in @xmath91 .    for a finite place @xmath97 of @xmath10 ,",
    "we denote by @xmath98 its completion at @xmath97 , and @xmath99 its ring of integers .",
    "we fix an algebraic closure @xmath100 of @xmath98 and let @xmath101 , and denote by @xmath102 the inertia subgroup of @xmath103 .",
    "we will assume that all finite extensions of @xmath98 are taken inside of @xmath100 .",
    "we let @xmath104 be the artin reciprocity map normalized so that uniformizers are sent to geometric frobenius elements . we denote the adeles of @xmath10 by @xmath105 , and let @xmath106 be @xmath107 .",
    "let @xmath108 be the set of tuples of integers @xmath109 such that @xmath110 . for any @xmath39 in @xmath10",
    ", we write @xmath111 for the set of continuous field embeddings @xmath112 . if @xmath113 , we again write @xmath114 for the induced embedding @xmath115 .",
    "conversely , given a field embedding @xmath116 , we again write @xmath114 for the continuous embedding @xmath112 induced by @xmath114 . if we are given an isomorphism @xmath117 of fields , and @xmath118 is an embedding of fields , we write @xmath119 for @xmath120 . if @xmath121 is a representation of a group @xmath122 on a @xmath31-vector space @xmath123 , then we will denote by @xmath124 the representation of @xmath122 on the @xmath125-vector space @xmath126 .",
    "if @xmath127 is a continuous character whose restriction to the connected component of @xmath128 is given by @xmath129 for some integers @xmath130 , and @xmath33 is an isomorphism , we let @xmath131 be the continuous character given by @xmath132    we denote by @xmath133 the @xmath0-adic cyclotomic character .",
    "we use covariant @xmath0-adic hodge theory , and normalize our hodge ",
    "tate weights so that the hodge  tate weight of @xmath133 is @xmath134 .",
    "let @xmath97 be a place above @xmath0 in @xmath10 , and let @xmath135 a potentially semistable representation on an @xmath136-dimensional vector space over @xmath31 . for @xmath137",
    ", we will write @xmath138 for the multiset of @xmath136 hodge  tate weights with respect to @xmath114 . specifically , an integer @xmath139 appears in @xmath138 with multiplicity equal to the @xmath95-dimension of the @xmath139th graded piece of the @xmath136-dimensional filtered @xmath31-vector space @xmath140 , where @xmath141 , @xmath142 is fontaine s ring of de  rham periods , and we view @xmath31 as a @xmath143-algebra via @xmath144 .",
    "we say that @xmath28 has _ regular weight _ if @xmath138 consists of @xmath136 distinct integers for each @xmath137 .",
    "if this is the case , then there is @xmath145 such that @xmath146 for each @xmath113 , and we call @xmath147 the _ weight _ of @xmath28 .    for a finite place @xmath97 of @xmath10 , an @xmath136-dimensional _",
    "inertial type _ is a representation @xmath148 of @xmath102 with open kernel that extends to a representation of the weil group of @xmath98 .",
    "we say @xmath149 is _ defined over _ @xmath15 if it is the extension of scalars to @xmath31 of a representation valued in @xmath150 .",
    "if @xmath135 is a a potentially semistable representation of @xmath103 on an @xmath136-dimensional vector space over @xmath31 , we say that @xmath28 has _ inertial type _",
    "@xmath149 if the restriction to @xmath102 of the weil  deligne representation associated to @xmath28 is isomorphic to @xmath149 .",
    "if @xmath39 , this is equivalent to demanding that for every @xmath151 , the action of @xmath102 on @xmath152 equals @xmath153 , where @xmath154 denotes fontaine s ring of semistable periods .",
    "in this section , we first prove our main lemma , [ thm : thelemma ] , that will allow us to deduce the existence of automorphic point in every irreducible component of a ( polarized ) universal deformation ring from a small @xmath61 theorem .",
    "we then recall berthelot s rigid analytic generic fibre and record a lemma that allows us to deduce zariski density statements in the generic fibre when there are multiple components .",
    "the following lemma is an easy consequence of the intersection theory in regular local rings .",
    "[ thm : intersection ] let @xmath155 be a regular local commutative ring and let @xmath9 be a finite commutative @xmath155-algebra . for @xmath156 , @xmath157 we have @xmath158    let @xmath159 be the pullback of @xmath160 to @xmath155 .",
    "if @xmath161 is minimal containing @xmath162 , then @xcite*chapter v , theorem 3 implies @xmath163 since @xmath155 is catenary , this implies @xmath164 since @xmath9 is finite over @xmath155 , this in turn implies @xmath165 again using that @xmath9 is finite over @xmath155 , we can find @xmath166 containing @xmath160 and lying over @xmath167 , hence also containing @xmath168 .",
    "then @xmath169    we easily derive from this the following lemma , which is the linchpin in the proofs of our main theorems .",
    "we will use notation suggestive of our intended application to automorphic points in deformation rings . recall that @xmath15 is a finite extension of @xmath16 with ring of integers @xmath8 .",
    "[ thm : thelemma ] let @xmath62 be a local commutative @xmath8-algebra and let @xmath170 be a closed subscheme .",
    "let @xmath9 be a commutative @xmath62-algebra and let @xmath171 be the scheme theoretic image of @xmath65 in @xmath5 .",
    "let @xmath44 be an irreducible component of @xmath5 .",
    "assume that    @xmath62 is a regular local ring ;    @xmath171 is finite over @xmath8 ;    @xmath172 .",
    "then the intersection of @xmath44 with @xmath173 in @xmath5 is nonempty .",
    "choose @xmath174 such that @xmath175 .",
    "then @xmath176 is finite over @xmath8 , which implies that @xmath177 is finite over @xmath178 , hence @xmath9 is finite over @xmath62 .",
    "then [ thm : intersection ] implies that @xmath179 so there is @xmath180 with @xmath181 .",
    "since @xmath176 is finite over @xmath8 , @xmath182 , and @xmath183 is in the intersection of @xmath44 and @xmath184 $ ] .",
    "we recall the rigid analytic generic fibre of berthelot @xcite*0.2 , for which we use @xcite*7 as a reference .",
    "let @xmath185 be an noetherian adic affine formal @xmath8-scheme such that @xmath186 is a finite type @xmath17-algebra , where @xmath187 is the largest ideal defining the topology on @xmath9 .",
    "there is a rigid analytic space @xmath188 , called the _ rigid analytic generic fibre _ of @xmath189 , that represents the functor that sends and @xmath15-affinoid algebra @xmath76 to the set of continuous @xmath8-algebra morphisms @xmath190 ( see @xcite*7.1 ) .",
    "moreover , @xmath191 is functorial , and there is a canonical @xmath8-algebra morphism @xmath192 . if @xmath9 is a @xmath78-algebra ( which is the case of interest for us ) , then @xmath193 has the following concrete description : if @xmath194/(f_1,\\ldots , f_k)$ ] is a presentation for @xmath8-flat quotient of @xmath9 , then @xmath193 is isomorphic to the locus in the open rigid analytic unit @xmath136-ball over @xmath15 cut out by the equations @xmath195 .",
    "the following is @xcite*lemma  7.1.9 .",
    "[ thm : genfibprop ] let @xmath185 be an affine formal @xmath8-scheme as above .    1 .",
    "[ genfibprop : pts ] there is a bijection between the points of @xmath188 and the set of maximal ideals of @xmath196 $ ] .",
    "this bijection is functorial in @xmath9 .",
    "[ genfibprop : locring ] let @xmath197 correspond to the maximal ideal @xmath198 $ ] under the bijection of [ genfibprop : pts ] .",
    "there is a canonical morphism of local rings @xmath196_{{\\mathfrak{m } } } \\rightarrow { \\mathcal{o}}_{x^{{\\mathrm{rig}}},x}$ ] .",
    "this map is compatible with @xmath192 , and induces an isomorphism on completions .",
    "[ thm : speczardense ] let @xmath9 be an @xmath8-flat @xmath78-algebra , and let @xmath185 .",
    "let @xmath199 be a set of maximal ideals in @xmath196 $ ] , and let @xmath200 be the set of points corresponding to @xmath199 under [ genfibprop : pts ] of [ thm : genfibprop ] . if @xmath201 is zariski dense in @xmath188 , then @xmath199 is zariski dense in @xmath5 .    take @xmath202 that vanishes at all @xmath203 .",
    "since @xmath9 is @xmath8-flat , it suffices to prove @xmath204 is nilpotent in @xmath196 $ ] .",
    "since @xmath196 $ ] is jacobson ( see @xcite*corollaire  10.5.8 ) , it further suffices to prove that @xmath204 belongs to every maximal ideal of @xmath196 $ ] .",
    "the zariski density of @xmath201 implies that the image of @xmath204 under @xmath192 vanishes at all points in @xmath188 , which implies @xmath204 belongs to every maximal ideal of @xmath196 $ ] by [ thm : genfibprop ] .",
    "the converse is not true in general .",
    "for example , let @xmath205 $ ] is the formal multiplicative group over @xmath8 , and let @xmath199 be the set the maximal ideals in @xmath206[1/p]$ ] corresponding to @xmath0-power roots of unity in @xmath31 .",
    "then @xmath199 is zariski dense in @xmath207 $ ] , but @xmath208 is the open rigid analytic unit ball over @xmath15 with coordinate @xmath209 , and every point in @xmath201 is a zero of the analytic function @xmath210 .",
    "loeffler @xcite has shown that this observation has interesting consequences for universal deformation rings for one dimensional galois representations .",
    "to apply the principal theorems in this paper to chenevier s conjecture , we will need understand the relationship between irreducible components of universal deformation rings and irreducible components of their rigid analytic generic fibre .",
    "the following lemma follows from a result of conrad @xcite*theorem  2.3.1 .",
    "[ thm : genfibcomps ] let @xmath9 be an @xmath8-flat , reduced @xmath78-algebra , and let @xmath185 .",
    "the maps that sends a minimal prime ideal @xmath211 of @xmath9 to @xmath212 induces a bijection between the irreducible components of @xmath5 and the irreducible components of @xmath188 .",
    "let @xmath213 be the minimal prime ideals of @xmath9 . since @xmath214 takes closed immersions to closed immersions ( see @xcite*proposition  7.2.4 ) , @xmath215 is a closed analytic subvariety of @xmath188 .",
    "we wish to show that @xmath216 is the set of irreducible components of @xmath188 .",
    "let @xmath217 be the normalization of @xmath9 , and let @xmath218 denote the canonical map .",
    "since @xmath9 is excellent , the map that sends a maximal ideal @xmath219 in @xmath217 to the minimal prime ideal in @xmath9 containing @xmath220 induces a bijection between connected components of @xmath221 and @xmath213 ( see @xcite*scholie  7.8.3(vii ) ) .",
    "let @xmath222 denote the the connected component of @xmath221 corresponding to the minimal prime @xmath223 of @xmath9 , hence @xmath224 .",
    "by @xcite*theorem  2.3.1 , the irreducible components of @xmath188 are @xmath225 , and the functoriality of @xmath214 implies @xmath226 .",
    "in   [ sec : cm ] and [ sec : hilb ] , we will use the above via the following lemma .",
    "[ thm : genfiblem ] let @xmath9 be an @xmath8-flat , reduced , equidimensional @xmath78-algebra , and let @xmath185 .",
    "let @xmath199 be a set of maximal ideals in @xmath196 $ ] , and let @xmath200 be the set of points corresponding to @xmath199 under [ thm : genfibprop ]",
    ". assume :    [ genfiblem : dim ] every irreducible component of the zariski closure of @xmath201 has dimension equal to @xmath227 $ ] .",
    "[ genfiblem : comps ] for every irreducible component @xmath44 of @xmath5 , there is @xmath228 such that @xmath196_{{\\mathfrak{m}}}$ ] is regular .",
    "then @xmath201 is zariski dense in @xmath188 .",
    "since @xmath196 $ ] is equidimensional , @xmath188 is equidimensional of dimension @xmath227 $ ] by [ thm : genfibprop ] . by [ genfiblem : comps ] and [ thm : genfibcomps ] , for every irreducible component @xmath229 of @xmath188",
    ", there is a point @xmath230 that lies on no other irreducible component of @xmath188 .",
    "the lemma now follows from [ genfiblem : dim ] and @xcite*corollary  2.2.7 .",
    "we recall some generalities in the deformation theory of group representations , and fix some notation that will be used in the rest of this article .",
    "let @xmath231 be a profinite group satisfying the @xmath0-_finiteness condition _ : for any open subgroup @xmath232 of @xmath231 , there are only finitely many continuous homomorphisms @xmath233 .",
    "this implies that for any @xmath17-vector space @xmath234 with continuous @xmath17-linear action of @xmath231 , the cohomology groups @xmath235 are all finite dimensional , as is the group of continuous @xmath67-cocyles @xmath236 .",
    "fix a continuous homomorphism @xmath237 let @xmath76 be a @xmath78-algebra .",
    "a _ lift _ of @xmath25 to a @xmath78-algebra @xmath76 is a continuous homomorphism @xmath238 such that @xmath239 .",
    "a _ deformation _ of @xmath25 to @xmath76 a @xmath240-conjugacy class of lifts .",
    "we will often abuse notation and denote a deformation by a lift in its conjugacy class .",
    "we let @xmath241 , resp .",
    "@xmath242 , denote the set valued functor on @xmath78 that sends a @xmath78-algebra @xmath76 to the set of lifts , resp .",
    "deformations , of @xmath25 to @xmath76 .",
    "if we wish to emphasize @xmath25 , we will write @xmath243 and @xmath244 , respectively . the functor @xmath241 is representable , and so is @xmath242 if @xmath245}({\\overline{\\rho } } ) = { \\mathbb{f}}$ ] ( see @xcite*proposition  1.3 ) .",
    "the representing object for @xmath241 , denoted @xmath83 , is called the _ universal lifting ring _ for @xmath25 .",
    "we denote by @xmath246 the universal lift to @xmath83 .",
    "if @xmath245}({\\overline{\\rho } } ) = { \\mathbb{f}}$ ] , the object representing @xmath242 , denoted @xmath3 , is called the _ universal deformation ring _ for @xmath25 .",
    "we denote by @xmath247 the universal deformation to @xmath3 . if we wish to emphasize @xmath25 , we will write @xmath248 and @xmath249 , respectively .    the following well known lemma ( see @xcite*12 and @xcite*lemma  1.2.1 ) allows us to enlarge our coefficient field @xmath15 , and we will sometimes invoke it without comment .    [",
    "thm : coefchange ] let @xmath250 be a finite extension with ring of integers @xmath251 and residue field @xmath252 .",
    "let @xmath253 .    1 .",
    "the universal @xmath254-lifting ring @xmath255 is canonically isomorphic to @xmath256 .",
    "if @xmath245}({\\overline{\\rho } } ) = { \\mathbb{f}}$ ] , the universal @xmath254-deformation ring @xmath257 is canonically isomorphic to @xmath258 .",
    "this lemma has the following consequence that we will use bellow .",
    "let @xmath259 be a continuous representation such that @xmath260 .",
    "the compactness of @xmath231 implies there is a finite extension @xmath250 inside @xmath95 , with ring of integers @xmath251 , such that @xmath28 takes image in @xmath261 .",
    "then [ thm : coefchange ] implies there is a unique local @xmath8-algebra morphism @xmath262 such that @xmath263 .",
    "let @xmath264 denote the adjoint action of @xmath265 on it s lie algebra @xmath266 .",
    "let @xmath267 and @xmath268 , denote @xmath269 and its trace zero subspace @xmath270 , respectively , each equipped with the adjoint action @xmath271 of @xmath231 .",
    "[ thm : genunivpres ]    1 .",
    "there is a presentation @xmath272/(f_1,\\ldots , f_k)\\ ] ] with @xmath273 and @xmath274 . in particular , every irreducible component of @xmath275 has dimension at least @xmath276 and @xmath83 is formally smooth over @xmath8 if @xmath277 .",
    "2 .   assume @xmath245}({\\overline{\\rho } } ) = { \\mathbb{f}}$ ] .",
    "there is a presentation @xmath278/(f_1,\\ldots , f_k)\\ ] ] with @xmath279 and @xmath274 .",
    "in particular , every irreducible component of @xmath280 has dimension at least @xmath281 and @xmath3 is formally smooth over @xmath8 if @xmath277 .",
    "the second part is @xcite*theorem  2.4 .",
    "the first part is proved in the same way , since the tangent space of @xmath241 is isomorphic to @xmath282 via the map @xmath283)$ ] given by @xmath284 , where @xmath285 = { \\mathbb{f}}[\\varepsilon]/(\\varepsilon^2)$ ] is the ring of dual numbers over @xmath17 .",
    "now let @xmath286 be a continuous character such that @xmath287 .",
    "define subfunctors @xmath288 and @xmath289 , that send a @xmath78-algebra to the set of lifts and deformations , respectively , @xmath28 to @xmath76 such that @xmath290 .",
    "these subfunctors are easily seen to be represented by the quotient of @xmath83 , resp . of @xmath9",
    "( assuming @xmath245}({\\overline{\\rho } } ) = { \\mathbb{f}}$ ] ) , by the ideal generated by @xmath291 , resp .",
    "generated by @xmath292 .",
    "the representing object for @xmath293 , denoted @xmath294 , is called the _ universal determinant _",
    "@xmath295 _ lifting ring _ for @xmath25 .",
    "if @xmath245}({\\overline{\\rho } } ) = { \\mathbb{f}}$ ] , the object representing @xmath296 , denoted @xmath297 , is called the _ universal determinant _ @xmath295 _ deformation ring _ for @xmath25 .",
    "[ thm : gendetpres ] assume @xmath298 .    1 .",
    "there is a presentation @xmath299/(f_1,\\ldots , f_k)\\ ] ] with @xmath300 and @xmath301 . in particular , every irreducible component of @xmath302 has dimension at least @xmath303 and @xmath294 is formally smooth over @xmath8 if @xmath304 .",
    "2 .   assume @xmath245}({\\overline{\\rho } } ) = { \\mathbb{f}}$ ] .",
    "there is a presentation @xmath305/(f_1,\\ldots , f_k)\\ ] ] with @xmath306 and @xmath301 . in particular , every irreducible component of @xmath307 has dimension at least @xmath308 and @xmath309 is formally smooth over @xmath8 if @xmath304 .",
    "this is similar to [ thm : genunivpres ] above .",
    "for example , see @xcite*lemma  4.1.1 ( since we have assumed @xmath298 , @xmath310 is @xmath231-equivariant , so the groups denoted @xmath311 in @xcite*4.1 are just @xmath312 in our case ) .",
    "we now assume that @xmath231 is an open index two subgroup of a profinite group @xmath313 , and that there is @xmath314 of order @xmath315 .",
    "so @xmath313 is the semidirect product of @xmath231 and @xmath316 . for any commutative ring @xmath76 and homomorphism @xmath317 , we let @xmath318 denote the conjugate homomorphism , i.e. @xmath319 for all @xmath320 , and let @xmath321 denote the @xmath76-linear dual of @xmath28 , i.e. @xmath322 for all @xmath320 .",
    "let @xmath323 be a continuous character , and let @xmath324 be its reduction mod @xmath325 .",
    "we assume that @xmath326 we then define a subfunctor @xmath327 by letting @xmath328 , for a @xmath78-algebra @xmath76 , to be the subset of deformations @xmath28 of @xmath25 to @xmath76 such that @xmath329 .",
    "[ thm : poldefrep ] assume @xmath25 is absolutely irreducible .",
    "then @xmath330 is representable by a quotient @xmath27 of @xmath3 .",
    "let @xmath27 be the quotient of @xmath3 by the ideal generated by @xmath331 the result now follows from @xcite*thorme  1 .",
    "if @xmath25 is absolutely irreducible , we call the object @xmath27 representing @xmath330 the _ universal _ @xmath295-_polarized deformation ring _ of @xmath25 .",
    "if we wish to emphasize the role of @xmath295 , we will write @xmath332 for @xmath27 .",
    "we recall the clozel  harris ",
    "taylor group scheme @xmath333 , which is the group scheme over @xmath334 defined as the semidirect product @xmath335 where @xmath336 , and the homomorphism @xmath337 given by @xmath338 and @xmath339 .",
    "if @xmath76 is any commutative ring and @xmath340 is a homomorphism such that @xmath341 , we will write @xmath342 for the composite of the restriction of @xmath343 to @xmath231 with the projection @xmath344 . in particular , we view @xmath345 as an @xmath346$]-module via @xmath347 .",
    "the following is ( part of ) @xcite*lemma  2.1.1    [ thm : gdhoms ] let @xmath76 be a topological ring .",
    "there is a natural bijection between the following two sets .    1",
    ".   continuous homomorphisms @xmath340 inducing an isomorphism @xmath348 .",
    "triples @xmath349 , where @xmath317 and @xmath350 are continuous homomorphisms and @xmath351 is a perfect @xmath76-linear pairing on @xmath345 satisfying @xmath352 for all @xmath353 and @xmath354 .    under this bijection , @xmath355 , @xmath356 , and @xmath357 for @xmath358 .",
    "in particular , our fixed @xmath25 extends to a continuous homomorphism @xmath359 such that @xmath360 , which we fix . for a @xmath78-algebra @xmath76 , a _ lift _ of @xmath361 to @xmath76 is a continuous homomorphism @xmath362 such that @xmath363 .",
    "a _ deformation _ of @xmath361 to @xmath76 is a @xmath240-conjugacy class of lifts . by [ thm : gdhoms ] ,",
    "if @xmath343 is a deformation of @xmath361 to a @xmath78-algebra @xmath76 , then @xmath342 is a deformation of @xmath25 to @xmath76 .",
    "we say a lift or a deformation @xmath343 of @xmath361 _ has multiplier _",
    "@xmath295 if @xmath364 .",
    "we let @xmath365 be the set valued functor on @xmath78 that sends a @xmath78-algebra @xmath76 to the set of deformations of @xmath361 to @xmath76 with multiplier @xmath295 .",
    "[ thm : polisofunctors ] assume @xmath47 and @xmath25 is absolutely irreducible .",
    "the map @xmath366 given by @xmath367 is an isomorphism of functors .",
    "this is exactly as in @xcite*lemma  1.5 . as the proof is short",
    ", we reproduce it for completeness .",
    "let @xmath76 be a @xmath78-algebra .",
    "the map @xmath368 is surjective by [ thm : gdhoms ] .",
    "assume that @xmath369 are two lifts of @xmath361 to @xmath76 such that @xmath370 are @xmath240-conjugate .",
    "then replacing @xmath371 with a lift in its deformation class , we can assume @xmath372 .",
    "letting @xmath373 be given by @xmath374 as in [ thm : gdhoms ] , @xmath375 commutes with @xmath372 . since @xmath25 is absolutely irreducible , @xmath376 ;",
    "since @xmath377 and @xmath371 both lift @xmath361 , @xmath378 ; and since @xmath47 , there is @xmath379 such that @xmath380 .",
    "then @xmath381 , so @xmath377 and @xmath371 define the same deformation .",
    "in particular , when @xmath47 and @xmath25 is absolutely irreducible , we view @xmath27 as the universal ( @xmath295-polarized ) deformation ring for @xmath361 .",
    "since @xmath382 , the adjoint action of @xmath265 on @xmath266 extends to @xmath383 by @xmath384 if @xmath76 is a commutative ring , and @xmath385 is a homomorphism , we write @xmath386 for @xmath387 with the adjoint action @xmath388 of @xmath313 .    [ thm : genpolpres ] assume @xmath47 and @xmath25 is absolutely irreducible .",
    "there is a presentation @xmath389/(f_1,\\ldots , f_k)\\ ] ] with @xmath390 and @xmath391 .",
    "in particular , every irreducible component of @xmath32 has dimension at least @xmath392 and @xmath27 is formally smooth over @xmath8 if @xmath393 .",
    "this is a special case of @xcite*lemma  2.2.11 and corollary  2.2.12 .",
    "( in our case , the sets denoted @xmath12 and @xmath394 in @xcite*lemma  2.2.11 and corollary  2.2.12 are both empty .",
    "so in the notation of @xcite , @xmath395 and @xmath396 ) .",
    "[ rmk : gl2pol ] we could also define polarized deformation functor in the case that @xmath397 , which amounts to @xmath398 or @xmath399-valued deformation theory with fixed multiplier character @xmath295 . in particular , when @xmath400 , @xmath47 , and @xmath295 lifts @xmath401 , the universal @xmath295-polarized deformation functor equals the universal determinant @xmath295 deformation functor .",
    "it is useful to keep this in mind when comparing the results of  [ sec : cm ] and  [ sec : hilb ] .",
    "in this section we recall some results from the literature on local deformation rings that we will need later .",
    "let @xmath97 be a finite place of @xmath10 .",
    "fix a continuous representation @xmath402 and a continuous character @xmath403 with @xmath404 .",
    "denote by @xmath405 the universal lifting ring for @xmath406 , and @xmath407 the universal lift .",
    "let @xmath408 be the universal determinant @xmath295 lifting ring , and @xmath409 the universal @xmath408-valued lift .",
    "we refer the reader to @xcite*definition  2.2.2 for the notion of a _ local deformation problem_. we will primarily use the following characterization ( @xcite*lemma  2.2.3 ) :    * any local deformation problem is representable by a quotient of @xmath405 . *",
    "a quotient @xmath9 of @xmath405 represents a local deformation problem if and only if it satisfies the following : for any @xmath78-algebra @xmath76 , lift @xmath28 of @xmath406 to @xmath76 , and @xmath410 , the @xmath78-algebra morphism @xmath411 induced by @xmath28 factors through @xmath9 if and only if the @xmath78-algebra map @xmath411 induced by @xmath412 factors through @xmath9 .",
    "[ thm : defquolem ] let @xmath9 be an @xmath8-flat reduced quotient of @xmath405 .    1 .",
    "[ defquolem : flat ] @xmath9 represents a local deformation problem if and only if for every finite totally ramified extension @xmath250 with ring of integers @xmath251 , lift @xmath28 of @xmath25 to @xmath251 , and @xmath413 , the @xmath78-algebra morphism @xmath414 induced by @xmath28 factors through @xmath9 if and only if the @xmath78-algebra map @xmath414 induced by @xmath412 factors through @xmath9 .",
    "[ defquolem : irred ] @xmath9 represents a local deformation problem if and only if @xmath415 represents a local deformation problem for each minimal prime @xmath211 of @xmath9 .",
    "let @xmath416 .",
    "then the lift @xmath417 induces a @xmath78-algebra morphism @xmath418 .",
    "it is easy to see that a quotient @xmath419 represents a local deformation problem if and only if @xmath420 for every @xmath421 .    using this reformulation ,",
    "[ defquolem : flat ] follows from the fact that the maximal ideals in @xmath422 $ ] are zariski dense ( @xcite*proposition  10.5.3 ) , since @xmath9 is @xmath8-flat and reduced and the residue field for any maximal ideal of @xmath422 $ ] is a finite totally ramified extension of @xmath15 , ( @xcite*proposition  2.2 ) .",
    "it similarly follows that @xmath9 represents a local deformation problem if @xmath415 does for each minimal prime @xmath211 of @xmath9 , and the converse follows from the argument of @xcite*lemma  1.2.2 .",
    "we first assume that @xmath424 .",
    "we recall a quotient of @xmath405 studied by taylor @xcite*proposition  3.1 ( where it is denoted @xmath425 ) and @xcite*proposition  3.12 , that will appear when recalling results from the literature in  [ sec : cmsmallrt ] .",
    "[ thm : r1 ] assume @xmath406 is trivial .",
    "there is a quotient @xmath426 of @xmath405 representing the following local deformation problem : for a lift @xmath28 of @xmath25 to a @xmath78-algebra @xmath76 , the induced @xmath78-algebra morphism @xmath411 factors through @xmath426 if and only if for every @xmath427 , the characteristic polynomial of @xmath428 is @xmath429 .",
    "the @xmath78-algebra @xmath426 is equidimensional of dimension @xmath430 and every generic point of @xmath431 has characteristic @xmath432 .",
    "the construction of @xmath426 can be seen easily .",
    "indeed , if @xmath406 is trivial then @xmath433 must factor through tame inertia .",
    "letting @xmath434 denote the characteristic polynomial for a generator of tame inertia , we let @xmath426 be the quotient of @xmath405 by the ideal generated by @xmath435 .",
    "the following seems to be well known , but for lack of a concrete reference we include a proof .",
    "[ thm : r1factor ] let @xmath76 be a reduced @xmath78-algebra and let @xmath436 be a lift of @xmath406 .",
    "there is a finite extension @xmath437 such that @xmath428 has characteristic polynomial @xmath429 for all @xmath438 .",
    "in particular , the @xmath78-algebra morphism @xmath439 induced by @xmath440 factors through @xmath441 .",
    "assume first that @xmath76 in an integral domain .",
    "there is a finite extension @xmath442 such that the image of the wild ramification under @xmath443 is trivial .",
    "letting @xmath209 denote a generator of the tame inertia of @xmath444 , @xmath445 a lift of frobenius to @xmath444 , and @xmath446 the order of the residue field of @xmath95 , the relation @xmath447 implies that the eigenvalues of @xmath448 , in an algebraic closure of the fraction field of @xmath76 , are stable under the taking @xmath446th powers , hence are roots of unity . passing to another finite extension @xmath449 to trivialize these eigenvalues ,",
    "the image of inertia under @xmath440 is unipotent .",
    "now assume @xmath76 is only reduced . by the above discussion , for each minimal prime ideal @xmath211 of @xmath76",
    ", there is a a finite extension @xmath450 such that @xmath451 is unipotent .",
    "since @xmath76 is reduced , there is an injection @xmath452 the product the product being taken over all minimal prime ideals of @xmath76 .",
    "we can then take @xmath453 to be the composite of the @xmath454 .      for the remainder of this section",
    "we assume that @xmath39 .",
    "[ thm : localsmooth ]    1 .   if @xmath455 , then @xmath405 is isomorphic to a power series over @xmath8 in @xmath456)$ ] variables .",
    "[ localsmooth : det ] if @xmath298 and @xmath457 , then @xmath408 is isomorphic to a power series over @xmath8 in @xmath458)$ ] variables .",
    "the trace pairing on @xmath459 is perfect , and induces a perfect pairing on @xmath268 if @xmath298 . by tate local duality , @xmath460 , and",
    "@xmath461 if @xmath298 .",
    "the result then follows from part 1 of [ thm : genunivpres , thm : gendetpres ] , and the local euler  poincar characteristic formula .",
    "the following fundamental result is due to kisin @xcite*corollary  2.7.7 and theorem  3.3.8    [ thm : crdefring ] fix @xmath145 and an inertial type @xmath149 defined over @xmath15 . there is a ( possibly zero ) @xmath8-flat reduced quotient @xmath462 of @xmath405 such that an @xmath15-algebra morphism @xmath463 \\rightarrow { \\overline{\\mathbb{q}}}_p$ ] factors through @xmath464 $ ] , if and only if @xmath85 is potentially crystalline of weight @xmath147 inertial type @xmath149 .",
    "if nonzero , then @xmath465 $ ] is equidimensional of dimension @xmath466 $ ] , and is formally smooth over @xmath15 .    if @xmath467 , then we omit it from the notation , and just write @xmath468 for @xmath469 .",
    "this theorem yields the following corollary , using the argument @xcite*4.3 .",
    "[ thm : crdefringdet ] assume @xmath298 .",
    "fix @xmath145 and an inertial type @xmath149 defined over @xmath15 .",
    "there is a ( possibly zero ) @xmath8-flat reduced quotient @xmath470 of @xmath408 such that an @xmath15-algebra morphism @xmath471 \\rightarrow { \\overline{\\mathbb{q}}}_p$ ] factors through @xmath472 $ ] if and only if @xmath85 is potentially crystalline of weight @xmath147 and inertial type @xmath149 .",
    "if nonzero , then @xmath473 $ ] is equidimensional of dimension @xmath474 $ ] and is formally smooth over @xmath15 .    in @xcite*lemma  4.3.1",
    "it is assumed @xmath475 , but this is only used to guarantee that a character , denoted @xmath476 there , has an @xmath136th root .",
    "for this it suffices that for any positive integer @xmath477 , the binomial coefficient @xmath478 is a @xmath0-adic integer , which holds whenever @xmath298 .",
    "note that knowing whether or not the above rings are nonzero amounts to showing there is a potentially semistable or potentially crystalline lift with the required weight and inertial type ( and determinant ) . in general , this seems to be a difficult problem .",
    "we recall the notion of a potentially diagonalizable representation from @xcite .",
    "we say a lift @xmath479 of @xmath480 is _ potentially diagonalizable of weight _",
    "@xmath145 if there is a finite extension @xmath437 and continuous characters @xmath481 , such that the following hold :    * @xmath440 and @xmath482 are both crystalline of weight @xmath483 , where @xmath484 is given by @xmath485 if @xmath486 extends @xmath487 ; * the @xmath72-points of @xmath488 determined by @xmath440 and @xmath489 lie on the same irreducible component .",
    "we say @xmath28 is _ potentially diagonalizable of regular weight _ if there is @xmath145 such that @xmath28 is potentially diagonalizable of weight @xmath147 .",
    "one can also define potentially diagonalizable lifts in the nonregular weight case , but we will not have use for them here .",
    "we also note that in @xcite , potentially diagonalizable is defined using irreducible components of @xmath490 , but it is equivalent to use irreducible components of @xmath488 , postcomposing @xmath491 by an element of @xmath492 if necessary",
    ".    for given @xmath145 and inertial type @xmath149 defined over @xmath15 , we ll call an @xmath72-point @xmath493 of @xmath494 , or of @xmath495 , _ potentially diagonalizable _ if @xmath85 is .",
    "we will call an irreducible component of @xmath494 , or of @xmath495 , _ potentially diagonalizable _ if it contains a potentially diagonalizable point .",
    "finally , we note that by @xcite*lemma  1.4.1 , the notion of being potentially diagonalizable depends only on @xmath496 .",
    "hence , it makes sense to talk about a @xmath31-valued representations as being potentially diagonalizable without specifying an invariant lattice .",
    "this in particular applies to the restrictions to @xmath103 of the automorphic galois representations of  [ sec : autgalrep ] .",
    "it is not currently known whether or not every potentially crystalline representation is potentially diagonalizable , nor whether or not any residual representation has a potentially diagonalizable lift of regular weight",
    ". the latter question has been investigated by gee  herzig ",
    "savitt @xcite .",
    "in particular , in two dimensions it is always possible , and we will use the following lemma in ",
    "[ sec : hilb ] .",
    "[ thm : btlift ] assume that @xmath497 , and that @xmath295 is de  rham .",
    "then @xmath406 admits a regular weight potentially diagonalizable lift with determinant @xmath295 .",
    "first assume @xmath406 is peu ramifie , in the sense of @xcite*definition  2.1.3 .",
    "fix @xmath498 such that @xmath499 for each @xmath137 .",
    "by @xcite*corollary  2.1.11 , @xmath406 had a potentially diagonalizable lift @xmath500 of weight @xmath147 . enlarging @xmath15 if necessary",
    ", we can assume @xmath501 takes values in @xmath502 , and @xmath503 is finitely ramified by choice of @xmath147 .",
    "since @xmath47 , there is a continuous finitely ramified character @xmath504 such that @xmath505 .",
    "then @xmath506 is a potentially diagonalizable lift of @xmath25 of weight @xmath147 and determinant @xmath295 .",
    "it only remains to treat that case ( see @xcite*examples  2.1.4 ) @xmath507 with @xmath508 , and trs ramifie cocycle @xmath509 .",
    "the result the follows from the argument of @xcite*lemma  6.1.6 .",
    "we sketch the details .",
    "twisting , we may assume that @xmath510 for each @xmath511 .",
    "then any lift of the form @xmath512 with @xmath513 a finitely ramified character lifting @xmath514 is potentially crystalline , hence potentially diagonalizable by @xcite*lemma  1.4.3 .",
    "choose some finitely ramified lift @xmath513 of @xmath515 and set @xmath516 .",
    "let @xmath95 be the line in @xmath517 spanned by the cohomology class generated by @xmath509 , and let @xmath232 be the hyperplane in @xmath518 annihilated by @xmath95 under local tate duality . fix a uniformizer @xmath519 in @xmath8 .",
    "then there is @xmath520 such that @xmath521 with @xmath522 a nontrivial homomorphism .",
    "an argument using local tate duality , as in see case  2 in the proof of @xcite*lemma  6.1.6 , shows it that is suffices to prove @xmath523 .",
    "we assume otherwise .",
    "since @xmath25 is trs ramifie , @xmath232 does not contain the unramfied line , and we can find @xmath524 such that @xmath525 , where @xmath526 is the unramified homomorphism that sends @xmath527 to @xmath528 . choosing some @xmath529 such that @xmath530 , and replacing @xmath513 by @xmath513 times the unramified character that sends @xmath527 to @xmath531 yields @xmath523 , finishing the proof .",
    "let @xmath532 be a continuous representation .",
    "we say @xmath28 is _ ordinary of weight _",
    "@xmath145 if there is a @xmath103-stable decreasing filtration @xmath533 with one dimensional graded pieces and an open subgroup @xmath534 of @xmath535 such that for each @xmath536 , letting @xmath537 denote the character giving the @xmath103-action on @xmath538 , we have @xmath539 for all @xmath540 .",
    "we say @xmath28 is _ ordinary _ of _ regular weight _ if there is @xmath541 such that it is ordinary of weight @xmath147 . the following is a result of geraghty @xcite*lemma  3.3.3 .",
    "[ thm : ordring ] let @xmath145 and let @xmath149 be an inertial type defined over @xmath15 .",
    "there is a ( possibly zero ) @xmath8-flat reduced quotient @xmath542 of @xmath405 such that an @xmath15-algebra morphism @xmath463 \\rightarrow { \\overline{\\mathbb{q}}}_p$ ] factors through @xmath543 $ ] if and only if @xmath85 is ordinary of weight @xmath147 .",
    "if nonzero , then @xmath544 $ ] is equidimensional of dimension @xmath545 $ ] and admits an open dense subscheme that is formally smooth over @xmath15 .",
    "note that in order for @xmath542 to be nonzero , @xmath149 must be a direct sum of finite order characters of @xmath102 .",
    "we recall the notion of regular algebraic polarized cuspidal automorphic representations and their associated galois representations . throughout this section",
    ", @xmath10 is assumed to be either a cm or totally real number field , with maximal totally real subfield @xmath11 .",
    "let @xmath546 be a choice of complex conjugation .",
    "following @xcite*2.1 , we say that a pair @xmath547 is a _ polarized automorphic representation _ of @xmath30",
    "if    * @xmath35 is an automorphic representation of @xmath30 ; * @xmath548 is a continuous character ; * @xmath549 ; * if @xmath10 is cm , letting @xmath550 be the unique integer such that @xmath551 is finite order , we require @xmath552 for each @xmath553 in @xmath11 .",
    "this differs from the definition given in @xcite*2.1 in two ways .",
    "firstly , the requirement that @xmath554 be independent of @xmath553 when @xmath10 is totally real has been shown to be redundant by patrikis @xcite*theorem  2.1 . secondly , we have chosen a different normalization for @xmath554 in the case that @xmath10 is cm .",
    "we do this because with the normalization here , the character @xmath555 of @xmath556 in [ thm : autgalrep ] below is totally odd , which is more convenient for us ( see [ thm : gdhoms , thm : polringdim ] ) .",
    "we say that an automorphic representation @xmath35 of @xmath30 is _ polarizable _ if there is a character @xmath513 such that @xmath547 is a polarized automorphic representation .",
    "if @xmath10 is cm and @xmath557 is polarized , then we say that @xmath35 is _ conjugate self - dual_. an automorphic representation @xmath35 of @xmath30 is called _ regular algebraic _ if @xmath558 has the same infinitesimal character as an irreducible algebraic representation of @xmath559 . if @xmath560 , then we let @xmath561 denote the irreducible algebraic representation of @xmath562 which is the tensor product over @xmath563 of the irreducible algebraic representations with highest weight @xmath130 .",
    "we say a regular algebraic automorphic representation @xmath35 of @xmath30 has _ weight _",
    "@xmath564 if @xmath558 has the same infinitesimal character as @xmath565 .",
    "we will say a polarized automorphic representation @xmath547 of @xmath30 is cuspidal if @xmath35 is .",
    "we will say a polarized automorphic representation @xmath547 of @xmath30 is regular algebraic if @xmath35 is . in this case",
    "@xmath513 is necessarily an algebraic character .",
    "let @xmath35 be a regular algebraic polarizable cuspidal automorphic representation of @xmath30 of weight @xmath147 , and let @xmath33 be an isomorphism .",
    "let @xmath39 in @xmath10 and let @xmath566 be a choice of uniformizer for @xmath98",
    ". for any integer @xmath567 , let @xmath568 denote the subgroup of @xmath569 of matrices that reduce to an upper triangular matrix modulo @xmath570 . for each @xmath536 ,",
    "the space @xmath571 has an action of the hecke operator @xmath572,\\ ] ] and they commute with one another .",
    "we define modified hecke operators @xmath573 for each @xmath536 .",
    "we say that @xmath35 is @xmath37-_ordinary _ if for each @xmath39 , there is an integer @xmath574 and a nonzero vector in @xmath571 that is an eigenvector for each @xmath575 with eigenvalues that are @xmath0-adic units .",
    "this definition does not depend on the choice of @xmath566 .",
    "we say a polarized regular algebraic cuspidal automorphic representation @xmath547 of @xmath30 is @xmath37-_ordinary _ if @xmath35 is .",
    "the following theorem is due to the work of many people .",
    "we refer the reader to @xcite*theorem  2.1.1 and the references contained there for [ autgalrep : pol , autgalrep : pss , autgalrep : locglob ] ( noting that the assumption of an iwahori fixed vector in part ( 4 ) of @xcite*theorem  2.1.1 can be removed by the main result of @xcite ) , and to @xcite*theorem  2.4 for [ autgalrep : ord ] .",
    "[ thm : autgalrep ] let @xmath547 be a regular algebraic , polarized , cuspidal automorphic representation of @xmath30 , of weight @xmath564 . fix an isomorphism @xmath33 , and for each @xmath39 in @xmath10 , let @xmath576 be given by @xmath577 .",
    "there is a continuous semisimple representation @xmath578 satisfying the following properties .    1 .",
    "[ autgalrep : pol ] there is a perfect symmetric pairing @xmath351 on @xmath579 such that for any @xmath580 and @xmath581 , @xmath582 2 .",
    "[ autgalrep : pss ] for all @xmath39 , @xmath38 is potentially semistable of weight @xmath583 .",
    "[ autgalrep : locglob ] for any finite place @xmath97 , @xmath584 4 .",
    "[ autgalrep : ord ] if @xmath547 is @xmath37-ordinary , then for each @xmath39 , @xmath585 is ordinary of weight @xmath583 .    in [ autgalrep : locglob ] , @xmath586 is the local langlands reciprocity map that takes irreducible admissible representations of @xmath587 to frobenius semi - simple weil ",
    "deligne representations , normalized as in @xcite and @xcite , and @xmath588 is the @xmath31-weil  deligne representation associated to @xmath38 .    since @xmath589 is compact , @xmath590 stabilizes a lattice .",
    "so conjugating @xmath585 if necessary , we may assume it takes valued in @xmath591 , and denote by @xmath592 the semisimplification of its reduction modulo @xmath75 , which is independent of the choice of lattice .",
    "if @xmath497 and @xmath10 is totally real , then any automorphic representation @xmath35 of @xmath593 is polarizable .",
    "more specifically , if @xmath513 denotes the central character of @xmath35 , then @xmath547 is polarized .",
    "if @xmath35 is regular algebraic and cuspidal , then @xmath35 is a twist of the automorphic representation generated by a hilbert modular cusp form ( see @xcite*1.2.3 ) .",
    "in this section , we prove our main theorems on polarized deformation rings for galois representations of cm fields . before proceeding , we fix the assumptions and notation that will be used throughout this section .",
    "we assume @xmath47 , and fix an isomorphism @xmath33 .",
    "we assume that our fixed number field @xmath10 is cm , and denote by @xmath11 its maximal totally real subfield .",
    "fix a finite set of places @xmath12 of @xmath11 containing all places above @xmath0 , and let @xmath13 be the maximal extension of @xmath10 unramified outside of the places in @xmath10 above @xmath12 .",
    "note that @xmath594 is galois , and we set @xmath595 and @xmath14 .",
    "we fix a choice of complex conjugation @xmath20 .",
    "we fix a continuous absolutely irreducible @xmath18 and a continuous totally odd character @xmath596 and assume there is a perfect symmetric pairing @xmath351 on @xmath597 such that @xmath598 for all @xmath23 and @xmath599 , where @xmath600 is the reduction of @xmath295 modulo @xmath325 .",
    "let @xmath27 be the universal @xmath295-polarized deformation ring for @xmath25 as in ",
    "[ sec : polardefring ] . since the pairing @xmath351 is symmetric , we can and do fix a lift @xmath601 of @xmath25 with @xmath602 as in [ thm : gdhoms ] .",
    "we also view @xmath27 as the universal @xmath295-polarized deformation ring of @xmath361 .",
    "[ thm : polringdim ] there is a presentation @xmath389/(f_1,\\ldots , f_k)\\ ] ] with @xmath603 $ ] . in particular , every irreducible component of @xmath32 has dimension at least @xmath604 $ ] .",
    "the result then follows from [ thm : genpolpres ] and the global euler ",
    "poincar characteristic formula , using that @xmath605 since @xmath25 is absolutely irreducible , and that @xmath606 for each @xmath553 since @xmath295 is totally odd ( see @xcite*lemma  2.1.3 ) .",
    "[ def : autpoint ] let @xmath9 be a quotient of @xmath27 , let @xmath607 , and let @xmath85 be the pushforward of the universal @xmath295-polarized deformation via @xmath608 .",
    "we call @xmath493 an _ automorphic point _ if there is a regular algebraic polarized cuspidal automorphic representation @xmath547 of @xmath30 such that @xmath609 and @xmath610 .",
    "given a finite extension @xmath93 of cm fields , we say @xmath493 is an @xmath95-_potentially automorphic point _ if there is a regular algebraic polarized cuspidal automorphic representation @xmath547 of @xmath611 such that @xmath612 and @xmath613 .    in either case , we say @xmath493 is @xmath37-_ordinary _ if @xmath35 is , and that @xmath493 has _",
    "level prime to _ @xmath0 , resp .",
    "_ potentially prime to _ @xmath0 , if for all @xmath39 the local representation @xmath49 is unramified , resp .",
    "becomes unramified after a finite base change .",
    "if @xmath188 is the rigid analytic generic fibre of @xmath189 , and @xmath614 is the point corresponding to @xmath615 $ ] , then we say @xmath616 is an _ automorhpic point _ if @xmath493 is , and if this is the case we further say @xmath616 has _ level prime to _",
    "@xmath0 if @xmath493 does .",
    "in this subsection we recall the small @xmath61 theorems that are used in the proofs of our main theorems . before stating them , we recall some terminology of @xcite for the deformation theory of @xmath361 .",
    "let @xmath617 be a finite set of finite places of @xmath10 such that every @xmath618 is split over some @xmath619 , and @xmath617 contains at most one place above any @xmath619 . for each @xmath618 ,",
    "let @xmath620 be a quotient of @xmath621 that represents a local deformation problem . by [ thm : defquolem ] , the rings @xmath620 in [ thm",
    ": pdsmallrt , thm : ordsmallrt , thm : potsmallrt ] below represent local deformation problems .",
    "we refer to the tuple @xmath622 as a _",
    "@xmath383-_deformation datum_. this differs from the definition in @xcite*2.3 in that our ramification set @xmath12 may contain places that do not split in @xmath623 , and @xmath617 is not required to contain a place above every @xmath619 . as the results in @xcite make no assumption on the splitting behaviour in @xmath10 of the places in @xmath624",
    ", we also wish to make no such assumption .",
    "a _ type _ @xmath625 deformation of @xmath361 is a deformation @xmath626 with @xmath76 a @xmath78-algebra such that for any ( equivalently for one ) lift @xmath343 in its deformation class    * @xmath364 , and * for each @xmath618 , the @xmath78-morphism @xmath627 induced by the lift @xmath628 of @xmath629 , factors through @xmath620",
    ".    we let @xmath630 be the set valued functor on @xmath78 that takes a @xmath78-algebra @xmath76 to the set of deformations of type @xmath625 .",
    "it is easy to see that @xmath630 is represented by a quotient @xmath631 of @xmath27 .",
    "indeed , let @xmath632 and @xmath633 , where the completed tensor products are taken over @xmath8 .",
    "a choice of lift @xmath343 in the equivalence class of the universal @xmath295-polarized deformation of @xmath361 determines a @xmath78 algebra morphism @xmath634 by @xmath635 .",
    "this @xmath636-algebra structure on @xmath27 may depend on the choice of lift @xmath343 , but it is canonical up to @xmath78-automorphisms of @xmath636 .",
    "we can then define @xmath637 we call @xmath631 the _ universal type _",
    "@xmath625 _ deformation ring _ , and note that it has an @xmath638-algebra structure that is canonical up to @xmath78-automorphisms of @xmath638 .",
    "the following lemma follows immediately from the construction of @xmath631 .",
    "[ thm : typesquotient ] let @xmath639 , and let @xmath640 be the global @xmath383-deformation datum @xmath641 let @xmath642 .",
    "there is a canonical isomorphism @xmath643 in particular , if @xmath644 for all @xmath645 , then there is a canonical isomorphism @xmath646 .    before proceeding , we introduce the conditions on the residual representation that appear as assumptions in the small @xmath61 theorems we quote .",
    "we first recall the definition of an adequate subgroup of @xmath45 in @xcite*1 .",
    "[ def : gladequate ] a subgroup @xmath313 of @xmath647 is _ adequate _ if the following hold :    1 .   @xmath648 and @xmath649 , where @xmath650 is the centre of @xmath651 ; 2 .",
    "[ gladequate : end ] @xmath652 is spanned by the semisimple elements in @xmath313 .",
    "this is slightly more general than @xcite*definition  2.3 , as it allows @xmath653 .",
    "however , if @xmath298 then the two definitions are equivalent .",
    "we note that [ gladequate : end ] implies that @xmath313 acts irreducibly on @xmath654 .",
    "the following partial converse is a theorem of guralnick  herzig  taylor ",
    "thorne @xcite*theorem  a.9 .",
    "[ thm : adequate ] let @xmath313 be a subgroup of @xmath647 that acts absolutely irreducibly on @xmath654 .",
    "let @xmath655 be the subgroup of @xmath313 generated by elements of @xmath0-power order .",
    "let @xmath656 be the maximal dimension of an irreducible @xmath655-submodule of @xmath654 .",
    "if @xmath657 , then @xmath313 is adequate and @xmath298 .",
    "we now state the small @xmath61 theorems that we use .",
    "the first of which is due to barnet - lamb  gee  geraghty ",
    "taylor @xcite , with improvements by barnet - lamb  gee ",
    "geraghty @xcite*appendix  a and dieulefait ",
    "gee @xcite*appendix  b.    [ thm : pdsmallrt ] assume that @xmath34 and that every @xmath39 in @xmath11 splits in @xmath10 . for each @xmath39 in @xmath11 , fix a choice of place @xmath658 of @xmath10 above @xmath97 , and set @xmath659 .",
    "assume further :    @xmath295 is de  rham .",
    "[ pdsmallrt : pd ] @xmath660 and @xmath661 , where @xmath547 is a regular algebraic polarized cuspidal automorphic representation of @xmath30 such that @xmath662 is potentially diagonalizable for each @xmath663 .",
    "[ pdsmallrt : adequate ] @xmath40 is adequate and @xmath41 .    for each @xmath663 , fix @xmath664 and an inertial type @xmath665 defined over @xmath15 , and we let @xmath666 be a quotient of @xmath667 corresponding to a union of potentially diagonalizable irreducible components of @xmath668 .",
    "let @xmath625 be the global @xmath383-deformation datum @xmath669 then the following hold :    1 .",
    "[ pdsmallrt : finite ] the universal type @xmath625 deformation ring @xmath631 is finite over @xmath8 .",
    "[ pdsmallrt : autpt ] every @xmath670 is automorphic of level potentially prime to @xmath0",
    ".    follows from @xcite*theorem  9 . to show [ pdsmallrt : finite ]",
    ", we will apply @xcite*theorem  10.1 .",
    "however , we have not fixed irreducible components at the finite places @xmath671 .",
    "we now explain how we can reduce to this case using base change and @xcite*theorem  6.8 .",
    "note that both @xcite*appendix  b and @xcite*theorem  6.8 use the stronger definition of adequate that implies @xmath298 .    to prove that @xmath631 is finite over @xmath8 , it suffices to prove that @xmath672 is finite over @xmath8 . for this",
    ", it suffices to prove that @xmath673 is finite over @xmath8 for any minimal prime @xmath211 of @xmath631 , since @xmath672 injects into @xmath674 .",
    "fix a minimal prime @xmath211 of @xmath631 , and let @xmath675 be the induced deformation .",
    "we now choose a finite solvable extension @xmath93 of cm fields , with maximal totally real subfield @xmath676 , satisfying the following :    * @xmath95 is disjoint from the the subfield of @xmath91 fixed by @xmath677 .",
    "* letting @xmath678 denote the set of places in @xmath676 above those in @xmath12 , each @xmath679 splits in @xmath95 . for each @xmath680",
    "we fix a choice of place @xmath681 in @xmath95 above @xmath682 such that if @xmath683 , then @xmath681 lies above some @xmath663 .",
    "we let @xmath684 . * for each @xmath685 with @xmath686 , the @xmath78-algebra map @xmath687 induced by @xmath688 factors through the quotient @xmath689 of [ thm : r1 ] ( here we use [ thm : r1factor ] ) . * for each @xmath685 , @xmath690 , where @xmath663 is the place in @xmath691 below @xmath681 .    we define a global @xmath383-deformation datum @xmath692 where    * for @xmath693",
    ", @xmath694 is a quotient of @xmath689 by a minimal prime through which the @xmath78-algebra morphism @xmath695 induced by @xmath688 factors ; * for @xmath696 , @xmath694 is a quotient of @xmath697 through which the @xmath78-algebra morphism @xmath698 induced by @xmath688 factors . here",
    "@xmath699 if @xmath700 extends @xmath701 .",
    "the deformation @xmath702 is of type @xmath703 , so there is an induced @xmath78-algebra map @xmath704 , and it is finite by @xcite*lemma  1.2.3 .",
    "so we are reduced to showing @xmath705 is finite over @xmath8 .    for @xmath686",
    ", @xmath694 has characteristic zero by [ thm : r1 ] , so contains a @xmath31-point . for each @xmath663 , @xmath694 contains a potentially diagonalizable point by choice of @xmath694 and @xmath666 , where @xmath658 is the place of @xmath10 below @xmath681 .",
    "we now apply @xcite*theorem  6.8 , and we have a lift @xmath706 that defines a type @xmath703-deformation of @xmath707 .",
    "then @xcite*appendix  b implies there is a regular algebraic polarized cuspidal automorphic representation @xmath708 of @xmath611 such that @xmath709 and @xmath710 .",
    "take @xmath685 .",
    "if @xmath711 , then @xmath712 $ ] is the unique irreducible component of @xmath713 $ ] containing the point determined by @xmath714 , as @xmath715 $ ] is formally smooth .",
    "if @xmath686 , then @xmath712 $ ] is the unique irreducible component of @xmath716 $ ] containing @xmath714 by @xcite*lemma  1.3.2 , using local - global compatibility , i.e. [ autgalrep : locglob ] of [ thm : autgalrep ] , and the fact that @xmath717 being cuspidal implies that @xmath718 is generic for all finite @xmath682",
    ". we can now apply @xcite*theorem  10.1 , using @xcite*proposition  7.1 in place of @xcite*proposition  4.4 ( see @xcite*7 ) .",
    "this completes the proof .",
    "for our purposes below , it would suffice to fix irreducible components at places dividing @xmath0 in [ thm : pdsmallrt ] above , but we do not want to fix irreducible components at places not dividing @xmath0 ( see [ rmk : minimal ] below ) .",
    "we have a similar theorem in the ordinary case , due to geraghty @xcite and thorne @xcite .",
    "[ thm : ordsmallrt ] assume @xmath47 and that every @xmath39 in @xmath11 splits in @xmath10 . for each @xmath39 in @xmath11 , fix a choice of place @xmath658 of @xmath10 above @xmath97 , and set @xmath659 .",
    "assume further :    @xmath295 is de  rham .",
    "[ ordsmallrt : ord ] @xmath660 and @xmath661 , where @xmath547 is an @xmath37-ordinary regular algebraic polarized cuspidal automorphic representation of @xmath30 .",
    "@xmath40 is adequate and @xmath41 .    for each @xmath663 ,",
    "fix @xmath664 and an inertial type @xmath665 defined over @xmath15 , and let @xmath666 be a quotient of @xmath719 corresponding to a union of irreducible components of @xmath720 .",
    "let @xmath625 be the global @xmath383-deformation datum @xmath669 then the following hold :    1 .",
    "the universal type @xmath625 deformation ring @xmath631 is finite over @xmath8 .",
    "every @xmath670 is @xmath37-ordinary automorphic .",
    "it suffices to consider the case @xmath721 for each @xmath663 . as with [ thm : pdsmallrt ] , we are free to replace @xmath10 with a finite solvable extension disjoint from the subfield of @xmath91 fixed by @xmath677 .",
    "after such an extension , we may assume that    * every @xmath619 splits in @xmath10 ; * for every @xmath722 above @xmath0 , @xmath723 .    by [ thm : typesquotient ] , we may also enlarge @xmath617 to ensure that it contains exactly one place @xmath682 above any @xmath724 , setting @xmath644 for each @xmath725 with @xmath726 .",
    "we are now in the setting of @xcite and our stated theorem is simply the combination of @xcite*theorem  9.1 and theorem  10.1 , again using @xcite*proposition  7.1 in place of @xcite*proposition  4.4 .    finally , using the potential automorphy results of barnet - lamb  gee  geraghty ",
    "taylor @xcite , we also have a potential version of the above two theorems .",
    "[ thm : potsmallrt ] assume @xmath47 and that every @xmath39 in @xmath11 splits in @xmath10 . for each @xmath39 in @xmath11 , fix a choice of place @xmath658 of @xmath10 above @xmath97 , and set @xmath659 .",
    "assume further :    @xmath295 is de  rham .",
    "[ potsmallrt : adequate ] @xmath54 is absolutely irreducible and @xmath41 .",
    "moreover , letting @xmath727 denote the maximal dimension of an irreducible subrepresentation of the restriction of @xmath25 to the closed subgroup of @xmath728 generated by all sylow pro-@xmath0 subgroups , we assume @xmath729 .    for each @xmath663 ,",
    "fix @xmath664 and an inertial type @xmath665 defined over @xmath15 , and we choose @xmath666 such that one of the following hold :    [ potsmallrt : pd ] for each @xmath663 , @xmath666 is a quotient of @xmath667 corresponding to a union of potentially diagonalizable irreducible components of @xmath668 .",
    "[ potsmallrt : ord ] for each @xmath663 , @xmath666 is a quotient of @xmath719 corresponding to a union of irreducible components of @xmath720 .",
    "let @xmath625 be the global @xmath383-deformation datum @xmath669 then the following hold :    1 .",
    "[ potpdsmallrt : finite ] the universal type @xmath625 deformation ring @xmath631 is finite over @xmath8 .",
    "[ potpdsmallrt : autpt ] given any finite extension @xmath730 , there is a finite extension of cm fields @xmath93 , disjoint from @xmath731 , such that every @xmath670 is @xmath95-potentially automorphic .",
    "we can and do assume that @xmath731 contains the fixed field of @xmath677 .",
    "we first take a cm extension @xmath732 , disjoint from @xmath731 , such that for any finite place @xmath682 of @xmath234 lying over a place in @xmath12 , @xmath733 is trivial .",
    "in particular , for any finite place @xmath682 of @xmath234 lying above a place in @xmath12 , @xmath733 admits a characteristic zero lift @xmath734 , which we may assume satisfy @xmath735 .",
    "then , using [ potsmallrt : adequate ] , we can apply @xcite*proposition  3.3.1 to deduce the existence of a finite extension @xmath736 of cm fields , with maximal totally real subfield @xmath676 , and a regular algebraic polarized cuspidal automorphic representation @xmath547 of @xmath611 such that    * @xmath95 is disjoint from @xmath731 ; * @xmath737 and @xmath738 ; * @xmath35 is unramified at @xmath0 and outside of @xmath12 ; * @xmath35 is @xmath37-ordinary .",
    "let @xmath678 be the set of places of @xmath676 above @xmath12 , @xmath739 be the set of places in @xmath95 above @xmath617 , and @xmath740 be the set places in @xmath739 dividing @xmath0 .",
    "for each @xmath741 , let @xmath742 be given by @xmath699 if @xmath700 extends @xmath701 , and let @xmath743 .",
    "we then consider the global @xmath383-deformation datum @xmath744 where    * if we are in [ potsmallrt : pd ] , then for each @xmath745 , @xmath694 is the quotient of @xmath746 corresponding the the union of all potentially diagonalizable irreducible components ; * if we are in [ potsmallrt : ord ] , then for each @xmath745 , @xmath747 .",
    "there is then a canonical @xmath78-algebra map @xmath748 which is finite by @xcite*lemma  1.2.3 .",
    "the theorem now follows from [ thm : pdsmallrt ] if we are in [ potsmallrt : pd ] , and from [ thm : ordsmallrt ] if we are in [ potsmallrt : ord ] .",
    "we first prove our main theorem in the potentially diagonalizable case .",
    "[ thm : mainpd ] assume that @xmath34 and that every @xmath39 in @xmath11 splits in @xmath10 . for each @xmath39 in @xmath11 , fix a choice of place @xmath658 of @xmath10 above @xmath97 , and set @xmath659 .",
    "assume further :    @xmath295 is de  rham .",
    "[ mainpd : aut ] @xmath660 and @xmath661 , where @xmath547 is a regular algebraic polarized cuspidal automorphic representation of @xmath30 such that @xmath662 is potentially diagonalizable for each @xmath663 .",
    "@xmath54 is adequate and @xmath41 .",
    "[ mainpd : smooth ] @xmath749 for every @xmath750",
    ".    then any irreducible component of @xmath32 contains an automorphic point @xmath493 of level potentially prime to @xmath0 .",
    "moreover , assume that for every @xmath663 , we are given @xmath664 , an inertial type @xmath665 defined over @xmath15 , and a nonzero potentially diagonalizable irreducible component @xmath751 of @xmath668",
    ". then we may assume the @xmath31-point of @xmath752 determined by @xmath753 lies in @xmath751 for each @xmath754 .",
    "we first note that our [ mainpd : aut ] implies that for each @xmath750 , there is a choice of @xmath664 , inertial type @xmath665 defined over @xmath15 , and nonzero irreducible component @xmath751 of @xmath668 ( enlarging @xmath15 if necessary using [ thm : coefchange ] ) .",
    "we fix such a choice for each @xmath663 .",
    "fix an irreducible component @xmath44 of @xmath32 .",
    "set @xmath755 , and let @xmath756 where @xmath666 is the quotient of @xmath667 corresponding to @xmath751 . choosing a lift @xmath757 in the class of the universal @xmath295-polarized deformation",
    "gives a local @xmath78-algebra morphism @xmath758 , and we let @xmath171 be the image of @xmath65 in @xmath32 under this map",
    ". then @xmath759 , where @xmath625 is the global @xmath383-deformation datum @xmath760 of [ thm : pdsmallrt ] implies that @xmath171 is finite over @xmath8",
    ". we also have    * @xmath62 is isomorphic to a power series over @xmath8 in @xmath761$]-variables by [ mainpd : smooth ] and [ thm : localsmooth ] ; * @xmath762 = 1+n^2\\lvert { \\widetilde{s}}_p\\rvert + \\frac{n(n-1)}{2}[f^+:{\\mathbb{q}}]$ ] by [ thm : crdefring ] ; * @xmath763 $ ] by [ thm : polringdim ]",
    ".    we can now apply [ thm : thelemma ] to conclude that @xmath764 \\ne \\emptyset.\\ ] ] applying [ pdsmallrt : autpt ] of [ thm : pdsmallrt ] finishes the proof .    using the polarization , the condition @xmath749 for all @xmath663 appearing in [ thm : mainpd ] and [ thm : mainord , thm : cmgeom ] below",
    "is equivalent to @xmath765 for all @xmath683 in @xmath10 , which is the condition in [ thm : dim3dense ] below .",
    "this is also equivalent to there being no nonzero @xmath766$]-equivariant map @xmath767 , which is how this condition was stated in the introduction .",
    "our main theorem in the ordinary case is the following .",
    "[ thm : mainord ] assume @xmath47 and that every @xmath39 in @xmath11 splits in @xmath10 . for each @xmath39 in @xmath11 , fix a choice of place @xmath658 of @xmath10 above @xmath97 , and set @xmath659 .",
    "assume further :    @xmath295 is de  rham .",
    "[ mainord : ord ] @xmath660 and @xmath661 , where @xmath547 is an @xmath37-ordinary regular algebraic polarized cuspidal automorphic representation of @xmath30 .",
    "@xmath40 is adequate and @xmath41 .",
    "@xmath768 for every @xmath750 .",
    "then any irreducible component @xmath44 of @xmath32 contains an @xmath37-ordinary automorphic point @xmath493 .",
    "moreover , assume that for every @xmath663 , we are given @xmath664 , an inertial type @xmath665 defined over @xmath15 , and a nonzero irreducible component @xmath751 of @xmath720",
    ". then we may assume the @xmath31-point of @xmath752 determined by @xmath753 lies in @xmath751 for each @xmath754 .",
    "we first note that [ thm : autgalrep ] and our [ mainord : ord ] implies that for each @xmath750 , there is a choice of @xmath664 and inertial type @xmath665 defined over @xmath15 , such that @xmath769 ( enlarging @xmath15 if necessary using [ thm : coefchange ] ) .",
    "the proof is then almost identical to the proof of [ thm : mainpd ] , taking @xmath770 , with @xmath666 the quotient of @xmath719 by the minimal prime corresponding to @xmath751 , and using [ thm : ordsmallrt ] instead of [ thm : pdsmallrt ] and [ thm : ordring ] instead of [ thm : crdefring ] .",
    "[ thm : cmgeom ] let the assumptions be as in either [ thm : mainpd ] or [ thm : mainord ] .",
    "then @xmath27 is an @xmath8-flat , reduced , complete intersection ring of dimension @xmath60 $ ] .    and [ thm : mainord ]",
    "imply that for any minimal prime ideal @xmath771 of @xmath27 there is an automorphic point @xmath772 .",
    "in particular , this shows @xmath773 is @xmath8-flat , and it has dimension @xmath60 $ ] by @xcite*theorem  c. so @xmath27 is equidimensional of dimension @xmath604 $ ] .",
    "this together with [ thm : polringdim ] implies that @xmath27 is a complete intersection .",
    "this in turn implies that @xmath27 has no embedded prime ideals , and since @xmath0 does not belong to any minimal prime ideal , it is not a zero divisor and @xmath27 is @xmath8-flat .",
    "applying @xcite*theorem  b again , we see that @xmath27 is generically regular .",
    "since @xmath27 is generically regular and contains no embedded prime ideals , it is reduced .    strengthening the assumption on the residual representation slightly , we can apply potential automorphy theorems to deduce the conclusion of [ thm : cmgeom ] without assuming residual automorphy .",
    "[ thm : potcmgeom ] assume that @xmath47 and that every @xmath39 in @xmath11 splits in @xmath10 .",
    "assume further :    @xmath295 is de  rham .",
    "@xmath54 is absolutely irreducible and @xmath41 .",
    "moreover , letting @xmath727 denote the maximal dimension of an irreducible subrepresentation of the restriction of @xmath25 to the closed subgroup of @xmath728 generated by all sylow pro-@xmath0 subgroups , we assume @xmath729 .",
    "[ potcmgeom : smooth ] @xmath749 for every @xmath750 .",
    "[ potcmgeom : loc ] one of the following hold :    [ potcmgeom : pd ] for each @xmath663 , @xmath774 admits a regular weight potentially diagonalizable lift ;    [ potcmgeom : ord ] for each @xmath663 , @xmath774 admits a regular weight ordinary lift",
    ".    then the following hold .    1 .",
    "[ potcmgeom : pot ] for any given finite extension @xmath731 of @xmath10 , there is a finite extension @xmath93 of cm fields , disjoint from @xmath731 , such that any irreducible component @xmath32 contains an @xmath95-potentially automorphic point .",
    "[ potcmgeom : geom ] @xmath27 is an @xmath8-flat , reduced , complete intersection ring of dimension @xmath60 $ ] .    by [ potcmgeom : loc ] , for each @xmath775",
    ", there is a choice of @xmath776 and an inertial type @xmath665 defined over @xmath15 ( extending @xmath15 if necessary ) , such that    * @xmath667 has a potentially diagonalizable point if we are in [ potcmgeom : pd ] , in which case we fix a potentially diagonalizable irreducible component @xmath751 of @xmath668 ; * @xmath769 if we are in [ potcmgeom : ord ] , in which case we fix an irreducible component @xmath751 of @xmath720 .",
    "the proof of [ potcmgeom : pot ] is then exactly as in [ thm : mainpd ] , using [ thm : potsmallrt ] instead of [ thm : pdsmallrt ] , and the proof of [ potcmgeom : geom ] is exactly as in [ thm : potcmgeom ] , using [ potcmgeom : pot ] instead of [ thm : mainpd , thm : mainord ] ( note @xcite*theorem",
    "c only requires potential automorphy ) .",
    "[ rmk : pdlift ] it is expected that [ potcmgeom : pd ] of [ potcmgeom : loc ] in [ thm : potcmgeom ] always holds @xcite*conjecture  a.3 , and it is known in many cases by work of gee  herzig  liu  savitt @xcite . for example , assume that there is a @xmath777-stable filtration @xmath778 whose graded pieces @xmath779 are irreducible , such that there is no nonzero @xmath780$]-morphism @xmath781 for any @xmath782 .",
    "then @xcite*corollary  2.1.11 implies that @xmath783 admits a potentially diagonalizable lift of regular weight ( see @xcite*examples  2.1.4 ) .",
    "[ rmk : minimal ] we note that it is possible to prove versions of the main theorems here without the potentially diagonalizable or ordinary hypothesis at the expense of a stronger assumption on the residual image .",
    "in particular , that each @xmath619 splits in @xmath10 and that @xmath765 for _ all _ places @xmath682 above a place in @xmath12 , as opposed to just the ones above @xmath0 .",
    "this is because the only general @xmath1 theorem at our disposal , without a potentially diagonalizable or ordinary assumption , is the minimal @xmath1 theorem @xcite*theorem  7.1 . to apply [ thm : thelemma ] in this situation",
    ", it would be necessary to include all places in @xmath12 when defining @xmath62 and @xmath65 .",
    "this would then force us to require that the unrestricted local deformation rings are regular at all places in @xmath12 .",
    "we now combine our main theorems with @xcite and the work of chenevier @xcite to prove new cases of chenevier s conjecture @xcite*conjecture  1.15 .",
    "recall @xmath10 is a cm field with maximal totally real subfield @xmath11 , and we have a fixed isomorphism @xmath784 .",
    "we now assume that our finite set of finite places @xmath12 of @xmath11 contains all finite places that ramify in @xmath10 ( as well as all those above @xmath0 ) .",
    "we restrict ourselves to dimension @xmath785 , i.e. @xmath786 is continuous and absolutely irreducible .",
    "we also restrict ourselves to the conjugate self dual case , i.e. we assume @xmath787    [ thm : dim3dense ] let the assumptions and notation be as above  [ sec : dim3dense ] .",
    "let @xmath27 be the universal @xmath788-polarized deformation ring for @xmath25 , and let @xmath51 be its rigid analytic generic fibre .",
    "assume further :    @xmath789 and is totally split in @xmath10 .",
    "@xmath660 , where @xmath35 is a regular algebraic conjugate self dual cuspidal automorphic representation of @xmath48 such that for each @xmath683 in @xmath10 , @xmath718 is unramified and @xmath790 is potentially diagonalizable .",
    "if @xmath50 , then we further assume that @xmath35 is @xmath37-ordinary .",
    "@xmath40 is adequate and @xmath41 .",
    "@xmath765 for every @xmath683 in @xmath10 .",
    "then the set of automorphic points of level prime to @xmath0 in @xmath51 is zariski dense .    by @xcite*theorem  a , the zariski closure in @xmath51 of the set of automorphic points of level prime to @xmath0 has dimension at least @xmath791 $ ] .",
    "( chenevier actually works with the universal @xmath88-polarized deformation ring , but this is simply because of a difference in normalization : in @xcite , the @xmath585 are normalized so that @xmath792 , whereas our normalization yields @xmath793 . ) by [ thm : cmgeom ] , @xmath27 is @xmath8-flat , reduced , and equidimensional of dimension @xmath794 $ ] .",
    "imply that every irreducible component of @xmath32 contains an automorphic point of level prime to @xmath0 , and @xcite*theorem  c implies that @xmath795 is formally smooth over @xmath15 for any such point @xmath493 . applying [ thm : genfiblem ] finishes the proof .    and",
    "[ thm : speczardense ] immediately imply :    [ thm : specdim3dense ] let the assumptions and notation be as in [ thm : dim3dense ] .",
    "then the set of automorphic points of level prime to @xmath0 in @xmath32 is zariski dense .",
    "we now investigate the hilbert modular case , i.e. the case of two dimensional representations of the absolute galois group of a totally real field .",
    "we first fix some assumptions and notation that will be used throughout this section .      throughout this section",
    "we assume @xmath47 and fix an isomorphism @xmath33 .",
    "we assume that our number field @xmath10 is totally real , and we fix a finite set of finite places @xmath12 of @xmath10 containing all places above @xmath0 .",
    "let @xmath13 be the maximal extension of @xmath10 unramified outside of the places in @xmath12 and the infinite places , and we set @xmath14 .",
    "we fix a continuous absolutely irreducible @xmath796 such that @xmath401 is totally odd .",
    "we also fix a continuous character character @xmath797 such that @xmath798 , where @xmath799 denotes the reduction of @xmath295 modulo @xmath325 .",
    "we let @xmath3 be the universal deformation ring for @xmath25 , and let @xmath309 be the universal determinant @xmath295 deformation ring for @xmath25 .",
    "we say @xmath493 is an _ automorphic point _ if there is a regular algebraic cuspidal automorphic representation @xmath35 of @xmath593 such that @xmath609 .",
    "we say @xmath493 has _",
    "level prime to _",
    "@xmath0 if @xmath49 is unramified for each @xmath39 in @xmath10 .    given a finite extension @xmath93 of totally real fields , we say @xmath493 is an @xmath95-_potentially automorphic point _ if there is a regular algebraic cuspidal automorphic representation @xmath35 of @xmath801 such that @xmath612    we say @xmath493 is an _ essentially automorphic point _ if there is a regular algebraic cuspidal automorphic representation @xmath35 of @xmath593 and a continuous character @xmath802 , such @xmath803 .",
    "if @xmath49 is unramified for each @xmath39 , then we say @xmath493 has _",
    "level essentially prime to _ @xmath0 .",
    "if @xmath188 is the rigid analytic generic fibre of @xmath189 , and @xmath614 is the point corresponding to @xmath615 $ ] , then we say @xmath616 is an _ automorhpic point _ ,",
    "an _ essentially automorphic point _ , if @xmath493 is , and if this is the case we further say @xmath616 has _ level essentially prime to _",
    "@xmath0 if @xmath493 does .",
    "[ thm : det ] let @xmath313 be the maximal pro-@xmath0 abelian quotient of @xmath589 , and let @xmath804^\\times$ ] be the tautological character .",
    "let @xmath805 be the teichmller lift of @xmath401 , and let @xmath806 be the unique character such that @xmath807 ( here we use that @xmath47 ) .",
    "this has the following immediate corollary that will allow us to deduce the existence of automorphic points in the irreducible components of the nonfixed determinant deformation ring from the existence of automorphic points in the irreducible components of fixed determinant deformation rings .",
    "[ thm : comps ] let @xmath44 be an irreducible component of @xmath280 .",
    "after possibly enlarging @xmath8 , there is a finite @xmath0-power order character @xmath810 such that some irreducible component of @xmath811 is contained in @xmath44 , where @xmath812 is the universal determinant @xmath813 deformation ring for @xmath25 .",
    "[ thm : dimnodet ] there is a presentation @xmath278/(f_1,\\ldots , f_k)\\ ] ] with @xmath817 $ ] , where @xmath818 is the leopoldt defect for @xmath10 and @xmath0 . in particular , every irreducible component of @xmath280 has dimension at least @xmath819 $ ] .    let @xmath313 be the maximal pro-@xmath0 abelian quotient of @xmath589 .",
    "then @xmath820 with @xmath821 a product of finite cyclic groups of @xmath0-power order . from this",
    "it follows that @xmath822 $ ] has a presentation @xmath823 \\cong { \\mathcal{o}}[[y_1,\\ldots , y_r]]/(g_1,\\ldots , g_s)\\ ] ] with @xmath824 . the corollary then follows from [ thm : dimdet ] and [ thm : det ] .",
    "[ thm : smoothhilb ] let @xmath93 be a finite extension of totally real fields , and let @xmath825 be an @xmath95-potentially automorphic point .",
    "let @xmath826 and @xmath827 denote the respective localizations and completions at @xmath493 .",
    "let @xmath313 be the maximal pro-@xmath0 abelian quotient of @xmath313 , and fix a splitting @xmath831 with @xmath832 and @xmath821 finite .",
    "using [ thm : coefchange ] , we can assume that @xmath15 contains the values of any @xmath31-character of @xmath821 as well as the values of @xmath833 .",
    "using [ thm : det ] and choosing appropriate topological generators for @xmath834 , we have @xmath835[\\gamma_{{\\mathrm{tor}}}]$ ] , and we can assume @xmath836 lie in the kernel of @xmath493 .",
    "this implies @xmath837 $ ] , and the the result for @xmath3 follows from that for @xmath309 .",
    "the result for @xmath309 follows from @xcite*theorem  b using an argument as in @xcite*8 .",
    "we give a sketch .",
    "let @xmath838/\\ker(x)$ ] , and let @xmath839 be the pushforward of the universal @xmath309-valued deformation via @xmath840 \\twoheadrightarrow k$ ] .",
    "we let @xmath841 denote the trace zero subspace of the lie algebra of @xmath842 , equipped with the adjoint @xmath589-action @xmath843 . by @xcite*theorem",
    "b , the geometric bloch ",
    "kato selmer group @xmath844 is trivial . using this ,",
    "the argument of @xcite*theorem  8.2 shows that @xmath845 injects into @xmath846 and this space has @xmath477-dimension @xmath847 = 2[f:{\\mathbb{q}}]$ ] , since the hodge ",
    "tate weights for @xmath848 are distinct for each @xmath39 and each embedding @xmath487 . on the other hand , using the argument of @xcite*proposition  9.5 , @xmath845 is isomorphic to the tangent space of @xmath826 and @xmath849 $ ] by [ thm : dimdet ] .",
    "let @xmath850 , and for each @xmath851 , let @xmath852 be a quotient of @xmath853 that represents a local deformation problem . by [ thm : defquolem ] , the rings @xmath852 in [ thm :",
    "smallhilb , thm : potsmallhilb ] below represent local deformation problems .",
    "we refer to the tuple @xmath854 as a _",
    "@xmath6-_deformation datum_. a _ type _ @xmath625 deformation of @xmath25 is a deformation @xmath855 with @xmath76 a @xmath78-algebra such that for any ( equivalently for one ) lift @xmath28 in its deformation class      the set valued functor @xmath630 on @xmath78 that takes a @xmath78-algebra @xmath76 to the set of deformations of type @xmath625 is representable .",
    "indeed a choice of lift @xmath856 in the universal @xmath309-valued deformation determines a @xmath78-algebra morphism @xmath857 , which is canonical up to automorphisms of @xmath858 .",
    "then @xmath630 is represented by @xmath859 we call @xmath631 the _ universal type _",
    "deformation ring_.    we will deduce the following small @xmath1 theorem from [ thm : pdsmallrt ] , using an input due to barnet - lamb  gee  geraghty @xcite . as in ",
    "[ sec : cm ] , both [ smallhilb : finite , smallhilb : modular ] are crucial for our main theorems in this section .",
    "for each @xmath39 , let @xmath861 and @xmath862 be an inertial type defined over @xmath15 , and let @xmath852 be a quotient @xmath863 corresponding to a union of potentially diagonalizable irreducible components .",
    "let @xmath625 be the global @xmath6-deformation datum @xmath864 and let @xmath631 be the universal type @xmath625 deformation ring . then      by @xcite*theorem  2.1.2 ( and it s proof ) , there is a finite solvable totally real extension @xmath93 , disjoint from the fixed field of @xmath54 , and a regular algebraic cuspidal automorphic representation @xmath717 of @xmath801 such that @xmath866 and such that @xmath867 is potentially diagonalizable for any @xmath683 in @xmath95 .",
    "let @xmath513 denote the central character of @xmath717 , and let @xmath868 denote the set of places in @xmath95 above those in @xmath12 .",
    "now choose a quadratic cm extension @xmath869 , disjoint from @xmath870 , such that each @xmath683 in @xmath95 splits in @xmath234 . using the standard symplectic pairing for @xmath6 and [ thm : gdhoms ]",
    ", @xmath871 extends to a continuous homomorphism @xmath872 with @xmath873 . using @xcite*lemma  2.2.2",
    ", there is a regular algebraic cuspidal automorphic representation @xmath874 of @xmath875 such that @xmath876 is polarized and such that @xmath877 . in particular , @xmath878 , @xmath879 , and @xmath880",
    "is potentially diagonalizable for each @xmath683 in @xmath234 .",
    "note also that @xmath881 is adequate and @xmath882 , by choice of @xmath234 .    for each @xmath683 in @xmath95 ,",
    "fix a choice of @xmath681 above @xmath682 in @xmath234 , and set @xmath883 . for each @xmath884 ,",
    "if @xmath97 is the place below it in @xmath10 , we let @xmath885 and @xmath886 be given by @xmath887 if @xmath888 extends @xmath487 . for each @xmath884 , we then let @xmath694 be the quotient of @xmath746 corresponding to the union of all potentially diagonalizable irreducible components .",
    "we then have a global @xmath889-deformation datum @xmath890 and we let @xmath891 be the universal type @xmath892 deformation ring .",
    "for any type @xmath625 deformation @xmath28 of @xmath25 to a @xmath78-algebra @xmath76 , again using the standard symplectic pairing for @xmath6 and [ thm : gdhoms ] , we obtain a type @xmath892 deformation @xmath893 we deduce the existence of a @xmath78-algebra map @xmath894 . a standard argument using nakayama s lemma and",
    "@xcite*lemma  3.6 shows that this map is finite .",
    "now follows from [ pdsmallrt : finite ] of [ thm : pdsmallrt ] , and [ smallhilb : modular ] follows from [ pdsmallrt : autpt ] of [ thm : pdsmallrt ] and @xcite*lemma  2.2.2 .            for each @xmath39",
    ", let @xmath861 and @xmath862 be an inertial type defined over @xmath15 , and let @xmath852 be a quotient @xmath863 corresponding to a union of potentially diagonalizable irreducible components .",
    "let @xmath625 be the global @xmath6-deformation datum @xmath864 and let @xmath631 be the universal type @xmath625 deformation ring",
    ". then    1 .",
    "[ potsmallhilb : finite ] @xmath631 is finite over @xmath8 .",
    "[ potsmallhilb : modular ] given any finite extension @xmath730 , there is a finite extension of totally real fields @xmath93 , disjoint from @xmath731 , such that every @xmath31-point of @xmath865 is @xmath95-potentially automorphic .",
    "we can and do assume that @xmath731 contains the fixed field of @xmath54 .",
    "by @xcite*corollary  1.7 , we can find a finite totally real extension @xmath93 and a regular algebraic cuspidal automorphic representation @xmath35 of @xmath801 such that @xmath895 .",
    "further , by using the refinement @xcite*proposition  2.1 of moret - bailly s theorem in place of @xcite*theorem  g , we may assume @xmath95 is disjoint from @xmath731 ( see also @xcite*theorem  3.1.2 ) .",
    "let @xmath868 , resp .",
    "@xmath896 , denotes the set of places of @xmath95 above @xmath12 , resp . above @xmath0 . for each @xmath897 , if @xmath97 is the place below it in @xmath10 , we let @xmath898 and @xmath899 be given by @xmath900 if @xmath901 extends @xmath487 . for each @xmath902 , we then let @xmath620 be the quotient of @xmath903 corresponding the the union of all potentially diagonalizable irreducible components .",
    "we have the global @xmath6-deformation datum @xmath904 and the universal type @xmath703-deformation ring @xmath705 .",
    "there is a natural map @xmath894 , which is finite ( @xcite*lemma  3.6 ) .",
    "the theorem now follows from applying [ thm : smallhilb ] to @xmath705 .",
    "moreover , assume that for every @xmath39 in @xmath10 , we are given @xmath861 , an inertial type @xmath862 defined over @xmath15 , and a nonzero potentially diagonalizable irreducible component @xmath906 of @xmath907 .",
    "then we can assume that the @xmath31-point of @xmath908 determined by @xmath909 lies in @xmath906 for each @xmath39 .",
    "we first note that by [ thm : btlift ] , for each @xmath39 there is a choice of @xmath861 , inertial type @xmath862 defined over @xmath15 , and nonzero potentially diagonalizable irreducible component @xmath906 of @xmath907 , which we fix .",
    "the proof now is similar to [ thm : mainpd ] ; we give the details .",
    "fix an irreducible component @xmath44 of @xmath307 .",
    "set @xmath910 , and let @xmath911 where @xmath852 is the quotient of @xmath863 corresponding to @xmath906 . choosing a lift @xmath912 in the class of the universal determinant @xmath295 deformation gives a local @xmath78-algebra morphism @xmath913 , and we let @xmath171 be the image of @xmath65 in @xmath307 under this map",
    ". then @xmath759 , where @xmath625 is the global @xmath6-deformation datum @xmath914 of [ thm : smallhilb ] implies that @xmath171 is finite over @xmath8",
    ". we also have    * @xmath62 is isomorphic to a power series over @xmath8 in @xmath915$]-variables by [ mainhilbdet : smooth ] and [ thm : localsmooth ] ; * @xmath916 = 1 + 3\\lvert s_p \\rvert + [ f:{\\mathbb{q}}]$ ] by [ thm : crdefringdet ] ; * @xmath917 $ ] by [ thm : dimdet ] .",
    "[ rmk : comppss ] an analogue of [ thm : mainhilbdet ] can be proved with  potentially diagonalizable \" replaced with ",
    "semistable with distinct hodge  tate weights \" , at the cost of assuming @xmath0",
    "is totally split in @xmath10 by using the @xmath2 theorem of kisin @xcite and the subsequent improvements on the breuil ",
    "mzard conjecture due to paknas @xcite and hu ",
    "tan @xcite .",
    "we leave the precise statements to the reader .              then given any finite extension @xmath730",
    ", there is a finite extension @xmath93 of totally real fields , disjoint @xmath731 , such that every irreducible component @xmath44 of @xmath307 contains an @xmath95-potentially automorphic point @xmath493 .",
    "moreover , assume that for every @xmath39 in @xmath10 , we are given @xmath861 , an inertial type @xmath862 defined over @xmath15 , and a nonzero potentially diagonalizable irreducible component @xmath906 of @xmath907 .",
    "then we can assume that the @xmath31-point of @xmath908 determined by @xmath909 lies in @xmath906 for each @xmath39 .",
    "[ mainhilb : aut ] let the assumptions be as in [ thm : mainhilbdet ] .",
    "then any irreducible component of @xmath280 contains an automorphic point .",
    "[ mainhilb : pot ] let the assumptions be as in [ thm : mainpothilb ] .",
    "then for any given finite extension @xmath731 , there is a finite extension @xmath93 of totally real fields , disjoint form @xmath731 , such that every irreducible component of @xmath280 contains an @xmath95-potentially automorphic point",
    ".                of [ thm : mainhilb ] implies that there is a finite extension @xmath93 of totally real fields , disjoint form the fixed field of @xmath54 , such that for any minimal prime ideal @xmath771 of @xmath3 there is an @xmath95-potentially automorphic point @xmath919 .",
    "in particular , this shows @xmath920 is @xmath8-flat , and it has dimension @xmath921 $ ] by [ thm : smoothhilb ] .",
    "so @xmath3 is equidimensional of dimension @xmath819 $ ] .",
    "this together with [ thm : dimnodet ] implies that @xmath3 is a complete intersection .",
    "this in turn implies that @xmath3 has no embedded prime ideals , and since @xmath0 does not belong to any minimal prime ideal , it is not a zero divisor and @xmath3 is @xmath8-flat .",
    "applying [ thm : smoothhilb ] again , we see that @xmath3 is generically regular . since @xmath3 is generically regular and contains no embedded prime ideals , it is reduced .",
    "when @xmath295 is de  rham , the proof for @xmath309 is the same , using [ thm : mainpothilb ] instead of [ mainhilb : pot ] of [ thm : mainhilb ] , and [ thm : dimdet ] instead of [ thm : dimnodet ] .",
    "when @xmath797 is an arbitrary character lifting @xmath401 , we choose a character @xmath922 lifting @xmath401 such that @xmath923 is de  rham .",
    "since @xmath47 , there is a character @xmath924 such that @xmath925 .",
    "twisting the universal determinant @xmath295-deformation of @xmath25 by @xmath926 induces a @xmath78-algebra isomorphism @xmath927 .",
    "this completes the proof .",
    "[ hilbdense : aut ] @xmath860 , where @xmath35 is a regular algebraic cuspidal automorphic representation of @xmath593 such that for all @xmath39 , @xmath49 is unramified and @xmath38 is potentially diagonalizable .",
    "then the set of essentially automorphic points of level essentially prime to @xmath0 in @xmath51 is zariski dense .",
    "if leopoldt s conjecture holds for @xmath10 and @xmath0 , then the set of automorphic points of level essentially prime to @xmath0 in @xmath51 is zariski dense .",
    "note that if if leopoldt s conjecture holds for @xmath10 and @xmath0 , then the set of essentially automorphic points of level essentially prime to @xmath0 and the set of automorphic points of level essentially prime to @xmath0 coincide , so the second claim follows from the first .",
    "work of gouvea and mazur when @xmath931 ( see @xcite*corollary  2.28 ) and chenevier @xcite*theorem  5.9 when @xmath930 $ ] is even , implies that the zariski closure in @xmath51 of the set of essentially automorphic points of level essentially prime to @xmath0 has dimension at least @xmath932 $ ] . by [ thm : hilbgeom ] ,",
    "@xmath3 is @xmath8-flat , reduced , and equidimensional of dimension @xmath819 $ ] . then by [ thm : smoothhilb ] and [ thm : genfiblem ] , it suffices to prove that every irreducible component of @xmath280 contains an automorphic point of level essentially prime to @xmath0 .",
    "fix an irreducible component @xmath44 of @xmath280 , and let @xmath933 . by [ thm : comps ]",
    ", there is a finite @xmath0-power order character @xmath934 ( extending @xmath15 if necessary ) and an irreducible component @xmath935 of @xmath936 such that @xmath937 .",
    "since @xmath47 , there is a finite @xmath0-power order character @xmath938 such that @xmath939 .",
    "twisting by @xmath940 gives an isomorphism @xmath941 , so there is an irreducible component @xmath942 of @xmath307 such that twisting by @xmath940 yields an isomorphism @xmath943 . by our assumption on @xmath35",
    ", for each @xmath39 there is a choice of @xmath861 such that @xmath944 and has a potentially diagonalizable irreducible component @xmath906 . applying [ thm : mainhilbdet ]",
    ", we deduce there is an automorphic point @xmath493 on @xmath942 whose image in @xmath908 lies on @xmath906 for each @xmath39 . in particular , @xmath909 is crystalline for each @xmath39 . by local global compatibility",
    ", we deduce that @xmath493 has level prime to @xmath0 .",
    "then @xmath945 is an automorphic point on @xmath946 of level essentially prime to @xmath0 , which completes the proof .",
    "[ thm : spechilbdense ] let the assumptions and notation be as in [ thm : hilbdense ] .",
    "then the set of automorphic points of level essentially prime to @xmath0 in @xmath280 is zariski dense .",
    "if leopoldt s conjecture holds for @xmath10 and @xmath0 , then the set of automorphic points of level essentially prime to @xmath0 in @xmath280 is zariski dense .",
    "[ rmk : primetop ] even if leopoldt s conjecture holds for @xmath10 and @xmath0 , it is necessary to use automorphic points of level essentially prime to @xmath0 , i.e. it is not in general true that the automorphic points of pime to @xmath0 level are zariski dense in @xmath280 .",
    "indeed , let @xmath313 be the maximal pro-@xmath0 abelian quotient of @xmath589 , and let @xmath821 denote its torsion subgroup .",
    "then @xmath822 $ ] is the universal deformation ring for lifts of @xmath401 , and taking determinants yields a @xmath78-algebra map @xmath822 \\rightarrow r^{{\\mathrm{univ}}}$ ] that takes crystalline points of @xmath280 to crystalline points of @xmath947 $ ] . applying [ thm : det ] with @xmath295 equal to the teichmller lift of @xmath401",
    ", we see that @xmath948 is the universal deformation of @xmath401 , from which it follows that the map @xmath949 $ ] is surjective .",
    "hence , if the crystalline points are dense in @xmath280 , they will be dense in @xmath947 $ ] , which is nt true in general . for example , say there are two places @xmath97 and @xmath682 above @xmath0 in @xmath10 such that @xmath98 and @xmath950 both contain a primitive @xmath0th root of unity .",
    "the natural map @xmath951 coming from class field theory is injective ( @xmath10 is totally real and @xmath47 ) , so we can find a character @xmath952 ( extending @xmath8 if necessary ) that is trivial on @xmath953 but not on @xmath954 .",
    "this character @xmath476 determines an irreducible component of @xmath947 $ ] , and any point on this component yields a character whose restriction to @xmath821 equals @xmath476 .",
    "but since @xmath10 is totally real , any crystalline character of @xmath589 is of the form @xmath955 for some @xmath956 and a finite order character @xmath957 that is unramified at all places above @xmath0 . in particular",
    "a crystalline character of @xmath589 is trivial on @xmath953 if and only if it is trivial on @xmath954 .",
    "[ rmk : overq ] we now compare [ thm : hilbdense ] with the previous results @xcite and @xcite*theorem  1.2.3 for @xmath931 .",
    "we will temporarily use homological normalizations ( i.e. uniformizers correspond to arithmetic frobenii and hodge  tate weights are normalized so that @xmath133 has hodge  tate weight @xmath67 ) for the galois representations associated to modular forms , as this is more common in the literature we quote .    first , we claim that [ hilbdense : aut ] always holds for absolutely irreducible odd @xmath25 when @xmath931 . indeed , there is @xmath956 such that @xmath958 has serre weight @xmath959 $ ] . by the strong form of serre s conjecture ,",
    "there is cuspform @xmath204 of level prime to @xmath0 and ( classical ) weight @xmath477 such that @xmath960 .",
    "if @xmath961 , then @xmath962 is potentially diagonalizable by @xcite*theorem  3.0.3 .",
    "if @xmath963 , then @xmath964 is an extension of the trivial character by the cyclotomic character , and @xcite*lemma  3.5 implies that @xmath965 is ordinary crystalline , hence potentially diagonalizable by @xcite*lemma  1.4.3 .",
    "applying the twist @xmath966 to the regular algebraic cuspidal automorphic representation of @xmath967 generated by @xmath204 yields a regular algebraic cuspidal automorphic representation @xmath35 satisfying [ hilbdense : aut ] of [ thm : hilbdense ] .",
    "however there is one situation covered by @xcite and @xcite*theorem  1.2.3 that we do not treat here , namely if @xmath974 and the projective image of @xmath975 is conjugate to @xmath976 . by @xcite*proposition  6.5 ,",
    "if @xmath47 and @xmath54 acts absolutely irreducibly but does not have adequate image , then either      the latter case does not occur when @xmath401 is totally odd and @xmath980 is unramified in @xmath10",
    ". it would be possible to treat the former case using the main ideas in this article and @xmath6-automorphy lifting theorems , but this would also require proving [ thm : smoothhilb ] using @xmath6-patching , instead of quoting @xcite*theorem  b , so we do not pursue it here .",
    "we finish by using an example due to serre ( see @xcite*2 ) to illustrate the subtleties , in particular the failure of [ thm : thelemma ] , that can occur when @xmath62 is not regular .",
    "we again use homological normalizations ( i.e. uniformizers correspond to arithmetic frobenii and hodge  tate weights are normalized so that @xmath133 has hodge  tate weight @xmath67 ) for the galois representations associated to modular forms , to be consistent with the literature we quote .",
    "there is a newform @xmath204 of weight @xmath315 and level @xmath981 , with @xmath446-expansion ( see @xcite ) @xmath982 where @xmath983 .",
    "the coefficient field of @xmath204 is @xmath984 , and the nebentypus of @xmath204 is the character @xmath985 given by @xmath986 .",
    "further , @xmath204 and its conjugate are a basis for @xmath987 .",
    "we take @xmath988 , and let @xmath989 denote the @xmath990-adic representation attached to @xmath204 , and let @xmath991 be the residual representation . the residual representation",
    "@xmath25 is absolutely irreducible , however its restriction to @xmath992 has abelian image . in particular , @xmath993 .",
    "let @xmath994 be the continuous character such that @xmath995 is the quadratic character of @xmath996 .",
    "then @xmath997 , the reduction of @xmath295 modulo @xmath325 .",
    "let @xmath309 be the universal determinant @xmath295 deformation ring for @xmath25 .",
    "every irreducible component of @xmath307 has dimension at least @xmath785 by [ thm : dimdet ] .",
    "let @xmath998 . by [ thm : gendetpres ] and the local euler ",
    "poincar characteristic formula , @xmath999 .",
    "we fix a lift in the class of the universal determinant @xmath295 deformation of @xmath25 , hence a @xmath78-algebra morphism @xmath913 .",
    "note that @xmath1000 is crystalline with hodge  tate weights @xmath1001 , and @xmath1002 .",
    "so twisting @xmath1000 by an unramified character , if necessary , we see that @xmath1003 .",
    "we let @xmath1004 , so @xmath1005 by [ thm : crdefringdet ] . in particular , for any irreducible component @xmath44 of @xmath307 , we have @xmath1006 but , letting @xmath171 denote the scheme theoretic image of @xmath65 in @xmath307 , we claim there is an irreducible component @xmath44 of @xmath307 such that @xmath1007 ( however , the justification below does show that a different choice of @xmath65 yields a nontrivial intersection with @xmath44 . )    to see this , first note that by a version of carayol s lemma @xcite*lemma  2.1 , there is a modular lift @xmath1008 of @xmath1009 with @xmath1010 and @xmath1011 . by local global compatibility",
    ", we have @xmath1012 .",
    "let @xmath44 be an irreducible component of @xmath307 containing the point induced by @xmath1008 . under the map @xmath1013 , the image of @xmath44 in @xmath1014 is contained in some characteristic @xmath432 irreducible component of @xmath1014 .",
    "inertial types are locally constant on @xmath1015 $ ] ( see @xcite*2 ) , so we deduce that for any @xmath31-point @xmath493 on @xmath44 , the semisimplification of @xmath1016 is isomorphic to @xmath1017 . since @xmath1018 , we further conclude that @xmath1019 .",
    "now assume that @xmath1020 , and choose a @xmath31-point @xmath493 in this intersection .",
    "then @xmath85 is unramfied outside of @xmath1021 , is crystalline at @xmath785 with hodge  tate weights @xmath1001 , and @xmath1019 .",
    "the @xmath446-expansion shows @xmath204 is @xmath785-ordinary , so @xmath1022 with @xmath1023 unramified and @xmath1024 . using @xcite*lemma  3.5",
    ", we see that @xmath85 is also ordinary , and since @xmath1009 is @xmath785-distinguished , we can apply @xcite*theorem in  1 to conclude that @xmath85 is modular .",
    "but by local global compatibility , it must arrise from an eigenform in @xmath987 with a quadratic nebentypus .",
    "this is a contradiction as @xmath987 is spanned by @xmath204 and its conjugate , and the nebentypus of @xmath204 has order @xmath1025 ."
  ],
  "abstract_text": [
    "<S> for a fixed mod @xmath0 automorphic galois representation , @xmath0-adic automorphic galois representations lifting it determine points in universal deformation space . </S>",
    "<S> in the case of modular forms and under some technical conditions , bckle showed that every component of deformation space contains a smooth modular point , which then implies their zariski density when coupled with the infinite fern of gouva  mazur . </S>",
    "<S> we generalize bckle s result to the context of polarized galois representations for cm fields , and to two dimensional galois representations for totally real fields . more specifically , under assumptions necessary to apply a small @xmath1 theorem and an assumption on the local mod @xmath0 representation , we prove that every irreducible component of the universal polarized deformation space contains an automorphic point . </S>",
    "<S> when combined with work of chenevier , this implies new results on the zariski density of automorphic points in polarized deformation space in dimension three . </S>"
  ]
}