{
  "article_text": [
    "zoonotic diseases are a major source of human morbidity world wide . in 2010 , there were an estimated 600 million cases globally @xcite , of which 96 million were _ campylobacter spp . _ ( resulting in 21 thousand deaths @xcite ) . attributing cases of food - borne disease to putative sources of infection is crucial to identify and prioritise food safety interventions .",
    "traditional approaches to source attribution include full risk assessments , analysis and extrapolation of surveillance or outbreak data , and analytical epidemiological studies @xcite",
    ". however , their results can be highly uncertain due to long and variable disease incubation times , and many and various exposures of an individual to potential sources of infection . given this difficulty , quantitative methods using pathogen strain type frequency have shown promise for statistically identifying important sources of food - borne illness @xcite .",
    "for a given disease , quantitative source attribution uses typing of pathogen isolates from human cases and suspected sources of infection ( food and environmental ) .",
    "samples are screened for the presence of the pathogen , with isolates then categorised using a typing methodology .",
    "multilocus sequence typing ( mlst ) is a commonly used genotyping method providing a relatively coarse characterisation of isolates of bacterial species @xcite .",
    "an mlst sequence type is defined as a unique combination of alleles at several gene loci , typically located in conserved regions of the genome @xcite .",
    "routine surveillance for food - borne pathogens is now commonplace in many countries and is performed by national authorities , for example foodnet in the us @xcite , the danish zoonosis centre ( food.dtu.dk ) , and the ministry for primary industries in new zealand ( foodsafety.govt.nz ) . despite this availability of data we are unaware of any previous implementations in standard statistical software for source attribution modelling , with past analyses being performed using a variety of _ ad hoc _ methodologies .",
    "moreover , current statistical source attribution models have strong assumptions , computational approximations or inherent identifiability problems ( discussed further in the ` review of models and notation ' section ) .",
    "this paper presents an ` r ` package ` sourcer ` , which implements a flexible bayesian non - parametric model , designed for use by epidemiologists and public health decision makers to attribute cases of zoonotic infection to putative sources of infection .",
    "we first describe a motivating example and review previous source attribution models before describing our model innovations , demonstrating the software , and discussing results and future directions .      in 2006 ,",
    "new zealand had one of the highest incidences of campylobacteriosis in the developed world , with an annual incidence in excess of 400 cases per 100,000 people @xcite .",
    "the data set was first published in @xcite , with a detailed description of the data ( and data collection methods ) available in @xcite and @xcite .",
    "a campaign to change poultry processing procedures , supported in part by results from previous quantitative source attribution approaches , was successful in leading to a sharp decline in campylobacteriosis incidence after 2007 @xcite .",
    "the data consists of mlst - genotyped _",
    "campylobacter _ isolates ( from both human cases of campylobacteriosis and potential food and environmental sources ) collected between 2005 and 2008 in the manawatu region of new zealand .",
    "these data are included in our ` sourcer ` package ( named ` campy ` ) .",
    "we use this data set as a case study , and compare our results with previously published statistical approaches .      in this section we define our notation , and briefly review the approaches that have been used previously to analyse ` campy ` . for a given time period ,",
    "we denote by @xmath0 the number of human cases of a disease caused by pathogen type @xmath1 . for the same time period ,",
    "we let @xmath2 denote the total number of source samples collected from source @xmath3 , for which @xmath4 are positive for pathogen type @xmath5 .",
    "the approach of hald _ et al . _",
    "@xcite was to compare the number of human cases caused by different pathogen types with their prevalence in different food sources ( whilst accounting for type and source specific effects ) .",
    "this requires a heterogenous distribution of pathogen types among the food sources .",
    "the number of human cases for each type @xmath0 is modelled as a poisson random variable with mean given by a linear combination of source specific effects , type specific effects and source sample _",
    "contamination prevalences .    @xmath6    where for source @xmath7 @xmath8 is the annual exposure , @xmath9 is the absolute prevalence of each pathogen type with @xmath10 the prevalence of positive samples and @xmath11 the relative prevalence of each pathogen type .",
    "the unknown parameters in the model are the vectors @xmath12 and @xmath13 .",
    "here , @xmath12 represents the characteristics that determine a type s capacity to cause an infection ( such as survivability during food processing , pathogenicity and virulence ) , and @xmath13 accounts for the ability of a particular source to act as a vehicle of infection .",
    "these parameters are interpreted further in .",
    "inference is performed in a bayesian framework allowing the model to explicitly include and quantify the uncertainty surrounding each of the parameters .",
    "equation [ eq : haldmodel ] over - specifies the model , with @xmath14 parameters ( the source and type effects ) but only @xmath15 independent observations ( the observed human case totals @xmath16 ) . in the original approach @xcite",
    ", identifiability was obtained by _ a priori _ clustering of the elements of @xmath13 and @xmath12 . in constrast ,",
    "the modified hald model @xcite prefers to reduce the effective number of parameters by treating @xmath12 as a log normal@xmath17 distributed random effect .",
    "however , a strong prior is needed on @xmath18 to shrink @xmath12 towards 0 sufficiently to avoid overfitting the model , the choice of which is arbitrary .",
    "the modified hald model introduces uncertainty into the relative prevalence matrix by modelling the source sampling process .",
    "this model was fitted in winbugs using an approximate two stage process @xcite .",
    "first , a posterior distribution was estimated for the absolute prevalence of source types @xmath19 , using the model specified in eqs [ eq : mhrij ] and [ eq : mhpij ] : @xmath20    the marginal posterior for each element of @xmath21 was then approximated by a beta distribution @xmath22 using the method of moments to calculate @xmath23 and @xmath24 .",
    "these were used as independent priors for each @xmath25 which removes the constraint that they sum to @xmath26 over each type @xmath5 .",
    "thus , the absolute prevalence for source @xmath7 ( @xmath27 ) is no longer constrained to be a probability ( as it may be larger than 1 ) .",
    "the asymmetric island model @xcite takes a different approach to the models described above . here , the evolutionary processes ( mutation , migration and recombination ) of the sequence types are modelled to infer probabilistically the source of each human infection using genetic data from each subtype .",
    "the extra information in the genetic typing allows the model to attribute human cases from a type not observed in any sources to a likely source of infection by comparing the genetic similarity to other types that are observed in the sources .",
    "this is not possible with the hald or modified hald models , however , they are much simpler with fewer assumptions and a wider range of suitable data ( for example , phenotypic typing can be used ) .",
    "we include results from this model as a comparison in the ` results ' section .",
    "our approach addresses the problems inherent in both the hald and modified hald models .",
    "we introduce a fully joint model for both source and human case sampling allowing us to integrate over uncertainty in the source sampling process , estimating both the prevalence of contaminated source samples and the relative prevalence of each identified type ( without resorting to an approximate marginal probability distribution on @xmath21 ) .",
    "furthermore , we introduce non - parametric clustering of pathogen types using a dirichlet process ( dp ) model on the type effect vector @xmath12 , providing an automatic data - driven way of reducing the effective number of parameters to aid model identifiability .",
    "we are able , therefore , to circumvent the hald model requirement for heuristically grouping pathogen types , as well as avoiding an arbitrary prior distribution specification for the random effect precision parameter ( @xmath18 ) required by the modified hald model .",
    "often , human case data is associated with location such as urban / rural , or even gps coordinates . on the other hand ,",
    "food samples are likely to be less spatially constrained due to distances between production and sale locations . also , both human and source data may exist for multiple time - periods .",
    "we therefore denote the number of human cases of time @xmath5 occurring in time - period @xmath28 at location @xmath29 by @xmath30 , the number of samples of source @xmath7 in time - period @xmath28 by @xmath31 , with the type counts @xmath32 .",
    "we allow for different exposures of humans to sources in different locations , by allowing the source effects to vary between times and locations , @xmath33 .      as with the hald model",
    ", we assume the number of human cases @xmath30 identified by isolation of subtype @xmath5 in time - period @xmath28 at location @xmath29 is poisson distributed @xmath34    for each source @xmath7 , we model the number of positive source samples @xmath35 where @xmath36 denotes the vector of type - counts in source @xmath7 in time - period @xmath28 , @xmath37 denotes the number of positive samples obtained , and @xmath38 denotes a vector of relative prevalences @xmath39 .",
    "the advantage of this model is that it automatically places the constraint @xmath40 , avoiding the approximation made in @xcite where independent beta - distributed priors were assigned marginally to components of @xmath38 .",
    "the source case model is then coupled to the human case model through the simple relationship @xmath41 where @xmath42 is the prevalence of any isolate in source @xmath7 in time - period @xmath28 .    in principle , a beta distribution could be used to model @xmath42 , arising as the conjugate posterior distribution of a binomial sampling model for @xmath43 positive samples from @xmath31 tested , and a beta prior on @xmath42 .",
    "we instead choose to fix the source prevalences at their empirical estimates ( @xmath44 ) because the number of source samples is typically high .",
    "the type effects @xmath12 , which are assumed invariant across time or location , are drawn from a dp with base distribution @xmath45 and a concentration parameter @xmath46 @xmath47 the dp groups the elements of @xmath12 into a finite set of clusters @xmath48 ( unknown _ a priori _ ) with values @xmath49 meaning bacterial types are clustered into groups with similar epidemiological behaviour .",
    "heterogeneity in the source matrix @xmath50 is absolutely required to identify clusters from sources , which may not be guaranteed _ a priori _ due to the observational nature of the data collection .",
    "this section describes how the model is fitted in a bayesian context by first describing the mcmc algorithm used to fit this model , then developing the prior model .      the joint model over all unobserved and observed quantities",
    "is fitted using markov chain monte carlo ( mcmc , full details in ) .",
    "the source effects and relative prevalence parameters are updated using independent adaptive metropolis - hastings updates @xcite .",
    "the type effects @xmath12 are modelled using a dp ( eq [ eq : qdp ] ) with a gamma base distribution @xmath51 . as the gamma distribution is conjugate with respect to the poisson likelihood ( eq [ eq : likelihood ] ) , it is possible to use a marginal gibbs sampler within a polya urn , or `` chinese restaurant process '' construction @xcite ( see ) .",
    "this was chosen over the more general `` stick breaking process '' because it allows sampling from the conditional posterior of @xmath52 .",
    "this is particularly important when the elements of @xmath52 values are highly dispersed : a base distribution with little mass near the locations of some of the true values for the groups results in poor mixing for the group allocations using the stick breaking algorithm ( as it is difficult for a type to change group when no other groups have a suitable @xmath53 value ) .",
    "in contrast , the marginal scheme allows an element of @xmath12 to move into a new cluster , then samples a @xmath53 value directly from the conditional posterior for that group , improving group mixing dramatically .",
    "the source and type parameters ( @xmath54 for all @xmath28 and @xmath29 , and @xmath12 respectively ) account for a multitude of source and type specific factors which are difficult to quantify _ a priori_. therefore , with no single real - world interpretation , the distributional form of the priors were chosen for their flexibility . a dirichlet prior is placed on each @xmath55 which suitably constrains its l1 norm , i.e. @xmath56 . a dirichlet prior is also placed on each @xmath54 , with the constrained l1 norm aiding identifiability between the mean of the source and type effect parameters . for more detail on specifying parameters for the dirichlet process and priors see the .",
    "standard mcmc packages ( e.g. winbugs , stan , pymc3 ) all lack the capability to implement marginal gibbs sampling for dirichlet processes , necessitating a custom mcmc framework ( see section ` extensibility ' ) .",
    "we chose r as a platform because of its ubiquity in epidemiology , and advanced support for post - processing of mcmc samples .",
    "minimal dependencies on other r packages are required , and are installed automatically .    `",
    "sourcer ` uses an object - oriented design , which allows separation of the model from the mcmc algorithm .",
    "internally , the model is represented as a directed acyclic graph ( dag , see ) in which nodes are represented by an r6 class hierarchy .",
    "generic adaptive metropolis hastings algorithms are attached to each parameter node , with the conditional independence properties of the dag allowing automatic computation of the required ( log ) conditional posterior densities .",
    "a difficulty with the dag setup is the representation of the dirichlet process model on the type effects @xmath12 , since each update of the marginal gibbs sampler requires structural alterations .",
    "therefore , we subsume the entire dirichlet process into a single node , with a bespoke marginal gibbs sampling algorithm written for our gamma base - distribution and poisson likelihood model .",
    "the case study below ( using the ` campy ` ( campylobacteriosis ) data set described in the ` motivation ' section ) illustrates how the ` sourcer ` package is used in practice to identify important sources of infection .",
    "we compare the results of our bayesian non - parametric approach with results from the modified hald and asymmetric island models , and additionally the historical ` dutch ' model ( see and @xcite ) .",
    "the priors for our model were selected to be non - informative .    the prevalence @xmath57 is calculated by dividing the number of positive samples by the total number of samples for each source . in the data below",
    ", we note that for several samples the mlst typing failed , with the number of positive samples exceeding the apparent total number of mlst - typed isolates .",
    "however , assuming mlst typing fails independently of pathogen type , this does not bias our results .",
    "the work flow for fitting the model begins with removing types with no source cases and calculating the prevalences @xmath58 .    ....",
    "data(campy ) zero_rows < - which(apply(campy [ , c(2 : 7 ) ] , 1 , sum ) = = 0 ) campy < - campy[-zero_rows , ] total_samples = c(239 , 196 , 127 , 595 , 552 , 524 ) positive_samples = c(181 , 113 , 109 , 97 , 165 , 86 ) k < - data.frame(value = positive_samples / total_samples ,                  source = colnames(campy [ , 2:7 ] ) ,                  time = rep(\"1 \" , 6 ) ,                  location = rep(\"a \" , 6 ) ) ....    the data and model parameters are set using the ` halddp$new ( ) ` constructor .",
    "starting values are selected automatically unless provided via a list named ` init ` to the constructor .    ....",
    "priors < - list(a_theta = 0.01 , b_theta = 0.00001 ,                  a_alpha = 1 , a_r = 0.1 ) my_model < - halddp$new(data = campy , k = k , priors = priors , a_q = 0.1 ) ....",
    "mcmc control parameters are be passed via ` fit_params `    ....",
    "my_model$fit_params(n_iter = 1000 , burn_in = 10000 , thin = 500 ) ....    the model is run using the ` update ` function .",
    "additional iterations may be appended using ` append = true ` .    ....",
    "set.seed(59623 ) my_model$update ( ) # my_model$update(n_iter = 10000 , append = t ) ....    we provide the ` extract ` method for ease of access to the complex posterior .",
    ".... # # returns the posterior for the r , alpha , q , c ,   # # lambda_i , lambda_j and lambda_j_prop parameters my_model$extract ( ) ....    the ` extract ` function returns the posterior for the selected parameters as a list with a multidimensional array for each of ` alpha ` , ` r ` , ` q ` , ` s ` , ` lambda_j ` and ` lambda_i ` .",
    "trace and autocorrelation plots for the parameters indicate that the markov chain is mixing well and has converged , and that thinning by 500 is adequate ( figure   [ fig : trace_params_real ] ) .",
    "the residual plots for the @xmath59s ( figure  [ fig : lambda_i_residuals_real ] ) show that the model fits well .",
    ".... # # plot the marginal posteriors for the following parameters # # source effect for chicken supplier c plot(my_model$extract(params=\"alpha \" , sources=\"chickenc\")$alpha , type=\"l \" ) # # type effect 25 plot(my_model$extract(params=\"q \" , types=\"25\")$q , type=\"l \" ) # # relative prevalence for source effect ovine , type 354 plot(my_model$extract(params=\"r \" , sources=\"ovine \" , types=\"354\")$r ,        type=\"l \" ) # # number of cases attributed to chicken supplier b plot(my_model$extract(params=\"lambda_j \" , sources=\"chickenb\")$lambda_j ,        type=\"l \" ) # # number of cases attributed to sub type 42 plot(my_model$extract(params=\"lambda_i \" , types=\"42\")$lambda_i , type=\"l \" ) ....    the ` summary ( ) ` function calculates medians and credible intervals calculated with three possible methods ( percentile , spin @xcite , or chen - shao @xcite ) .    ....",
    "my_model$summary(alpha = 0.05 , ci_type = \" percentiles \" ) ....",
    "these can be used to plot an observation versus fitted plot as follows    .... # # the summary for lambda i is a 4d array with # # [ type , time , location , ( median/ ci_lower/ ci_upper ) ] med_li_vals < - my_model$summary(alpha = 0.05 , params = \" lambda_i \" ,                   time = \" 1 \" , location = \" a\")$lambda_i [ , , , \" median \" ] human_cases < - my_model$print_data()$y plot(med_li_vals , human_cases ) ....    see and for more details on using the package .      to visualise how the dp has clustered the type effects",
    ", we use gower s distance @xcite to compute a dissimilarity matrix between all possible pairs of types . to aid interpretation of the posterior clustering of the type effects under the dp , we provide a method ` plot_heatmap ( ) ` that plots the clustering as a heatmap with a dendrogram .",
    "figure  [ fig : type_effect_heatmap_real ] shows that the dp identified four main pathogen type clusters .    ....",
    "my_model$plot_heatmap ( ) ....    the violin plots of the marginal posterior distributions for each type effect ( figure  [ fig : type_effect_violinplots_real ] ) show the largest group of types has very small type effects .",
    "these correspond to types observed in few source samples and no human cases .",
    "consequently , there is very little information for their type effects which results in very wide credible intervals .",
    "the other three groups have much larger type effects .",
    "the clustering results identify clusters of strains having particular traits that could be explored using further genotyping or phenotyping assays .",
    "figure  [ fig : lambda_j_real ] shows the proportion of cases attributed to each source for the halddp model and three commonly used source attribution models .",
    "the median values are similar between all models except the dutch method @xcite .",
    "the dutch model confidence intervals are very narrow because there are far fewer parameters in the model ; however , the lack of source and type effects in the model biases the results .",
    "the credible intervals produced by the island model may be narrow due to more accuracy ( as additional genetic information is used ) .",
    "the wide credible intervals for the the halddp and modified hald models may be due to c. jejuni s complex epidemiology resulting in relatively large uncertainty for the disease origin @xcite , and posterior correlations between some parameters . in particular , the new model shows that the proportion of cases attributed to poultry supplier a is negatively correlated with the proportion of cases attributed to both ovine and poultry supplier b sources ( pearson correlation coefficients of -0.60 and -0.65 respectively , see fig [ fig : cor_plots ] in ) .",
    "the halddp model gives a more accurate representation of the uncertainty inherent in source attribution .",
    "some of this non - identifiability is not fully explored in the modified hald model @xcite as fitting the model in two stages does not allow full propagation of the uncertainty .",
    "in particular , when calculating the hyper - parameters for the beta priors for each @xmath25 from the first stage model , the authors imposed a minimum @xmath60 of 1 .",
    "this prevents bath tub shaped beta priors for any @xmath25s which makes the model easier to fit at the expense of discouraging full exploration of the marginal posteriors for @xmath25s that truly have a bath - tub shape .",
    "the stable release version of ` sourcer ` is available from the comprehensive r archive network , released under a gpl-3 licence .",
    "the development version is available at http://fhm-chicas-code.lancs.ac.uk/millerp/sourcer .",
    "as this package develops , we intend ` sourcer ` to become a platform for new source attribution model development , providing a central analytic resource for public health professionals .",
    "the establishment of a standard package with a familiar interface will therefore lead to improved repeatability and reusability of source attribution analyses , supporting national public health and hygiene policy decisions .      with increased interest in source attribution models for both food - borne pathogens , and `",
    "sourcer ` has been written with extensibility in mind , with the dag representation allowing for rapid construction of modified or new models .",
    "the package routines are written in r ( as opposed to c or c++ ) to aid readability , with the node class hierarchy and three stage workflow designed to aid the addition of new model classes .",
    "all internal classes and methods are documented to enable prospective developers to familiarise themselves with the source code quickly .",
    "we note that the dag framework is not limited solely to source attribution models and may used for other bayesian applications , particularly those for which a dirichlet process is required",
    ".      the main focus of extending ` sourcer ` will be on modelling spatiotemporal correlation in the time- and location- dependent parameters . with the trend in collecting precise geolocation data with human cases , and improved traceability of food , a spatiotemporal correlation model on @xmath54",
    "could be used to identify particular foci of source contamination , therefore enabling targeted investigation of particular food supply regions .",
    "implementation of time varying type effects may be appropriate , particularly in the face of evidence that _ campylobacter _ can evolve quickly , with genetic variation conferring virulence not apparent from course - scale mlst typing @xcite .",
    "interaction terms between some sources and types would allow for the biologically plausible possibility that certain types are more or less likely to survive and cause disease , dependent on the food source they appear in .",
    "this would occur if a specific type was particularly well adapted to a certain food source .",
    "however , including interaction terms would significantly increase the number of parameters and reduce identifiability of the model .",
    "testing has revealed that the current metropolis - hastings based fitting algorithm suffers a loss of efficiency if the source matrix is sparse or highly unbalanced , imbuing negative correlations between certain type / source effect combinations .",
    "gradient - based fitting algorithms such as hamiltonian monte carlo ( hmc ) @xcite are designed to converge to high - dimensional , non - orthogonal target distributions much more quickly , and are a target of future development . in particular , the no u - turn sample ( nuts ) presents an attractive method for tuning hmc adaptively , a quality which we consider necessary to minimise user intervention and maximise research productivity @xcite .",
    "we have presented a novel source attribution model which builds upon , and unites , the hald and modified hald approaches .",
    "it is widely applicable , fully joint , and does not require approximations or a large number of assumptions . mixing and _ a posteriori _ correlations are significantly decreased in comparison to the modified hald model .",
    "furthermore , it allows the data to inform type effect clustering using a bayesian non - parametric model which identifies groups of bacterial sub types with similar putative virulence , pathogenicity and survivability .",
    "this is a significant improvement over the previous attempts to improve model identifiability ( fixing some source and type effects , or modelling the type effects as random using a 2 stage model ) . like the modified hald model",
    ", the new model incorporates uncertainty in the prevalence matrix into the model , however , it does this by fitting a fully joint model rather than a 2 step model .",
    "this has the advantage of allowing the human cases to influence the uncertainty in the source cases and preserves the restriction on the sum of the prevalences for each source .",
    "the ` sourcer ` package implements this model to enable straightforward attribution of cases of zoonotic infection to putative sources of infection by epidemiologists and public health decision makers .",
    "[ [ s1_dutch ] ] s1 appendix .",
    "+ + + + + + + + + + + +    * dutch model overview *    the dutch method @xcite is one of the simplest models for source attribution .",
    "it compares the number of reported human cases caused by a particular bacterial subtype with the relative occurrence of that subtype in each source .",
    "the number of reported cases per subtype and reservoir is estimated by : @xmath61 where @xmath62 is the relative occurrence of bacterial subtype @xmath5 in source @xmath7 , @xmath0 is the estimated number of human cases of type @xmath5 per year , @xmath63 is the expected number of cases per year of type @xmath5 from source @xmath7 .",
    "a summation across types gives the total number of cases attributed to source @xmath7 , denoted by @xmath64 : @xmath65 as the dutch model has no inherent statistical noise model , confidence intervals for the estimated total attributed cases @xmath66 by bootstrap sampling over the data set .",
    "this model implicitly assumes that there are no source or type specific effects ( such as differing virulence of types , or differing consumption of food sources ) which is not plausible for most zoonoses .",
    "[ [ s1_table ] ] s1 table .",
    "+ + + + + + + + +    * summary of model parameters .",
    "*    the following table gives a list of the model parameters for easy reference .",
    "[ table : haldmodelparams ]    .description and definition of the model parameters .",
    "[ cols= \" < , < , < \" , ]      +    [ [ s2_dp ] ] s2 appendix .",
    "+ + + + + + + + + + + +    * dirichlet priors and process details *    the dirichlet process is a random probability measure defined by a base distribution @xmath45 and a concentration parameter @xmath46 @xcite .",
    "the base distribution constitutes a prior distribution in the values of each element of the type effects @xmath67 whilst the concentration parameter encodes prior information on the number of groups @xmath68 to which the pathogen types are assigned .",
    "for small values of @xmath46 , samples from the dp are likely to have a small number of atomic measures with large weights . for large values , most samples are likely to be distinct , and hence , concentrated on @xmath69 .",
    "a value of 1 implies that , _ a priori _ , two randomly selected types have probability 0.5 of belonging to the same cluster @xcite .",
    "[ [ specifying - the - dirichlet - process - base - distribution - and - concentration - parameters ] ] specifying the dirichlet process base distribution and concentration parameters : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the concentration parameter of the dp is specified by the analyst as a modelling decision .",
    "the concentration parameter specifies how strong the prior grouping is . in the limit @xmath70 ,",
    "all types will be assigned to one group , increasing @xmath71 makes a larger number of groups increasingly likely .",
    "the gamma base distribution @xmath69 induces a prior for the cluster locations .",
    "this prior should not be too diffuse because if these locations are too spread out , the penalty in the marginal likelihood for allocating individuals to different clusters will be large , hence the tendency will be to overly favour allocation to a single cluster . however , the prior parameters may have a stronger effect than anticipated due to the small size of the relative prevalence and source effect parameters .",
    "this can been seen by considering the marginal posterior for @xmath72 @xmath73 the term @xmath74 is very small ( due to the dirichlet priors on @xmath75 and @xmath76 ) , which can result in even a fairly small rate parameter ( @xmath77 ) dominating .",
    "[ [ specifying - dirichlet - priors ] ] specifying dirichlet priors : + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the simplest dirichlet priors for the source effects and relative prevalences are symmetric ( meaning all of the elements making up the parameter vector @xmath78 have the same value @xmath71 , called the concentration parameter ) .",
    "symmetric dirichlet distributions are used as priors when there is no prior knowledge favouring one component over another .",
    "when @xmath71 is equal to one , the symmetric dirichlet distribution is uniform over all points in its support .",
    "values of the concentration parameter above one prefer variates that are dense , evenly distributed distributions , whilst values of the concentration parameter below 1 prefer sparse distributions .",
    "note , a prior of 1 for the relative prevalences is too strong ( if a relatively non - informative prior is preferred ) when there are many observed zero s in the source data ; a prior value of 0.1 is more suitable .",
    "a more informative prior can be specified by using a non - symmetric dirichlet distribution .",
    "the magnitude of the vector of @xmath78 parameters corresponds to the strength of the prior .",
    "the relative values of the @xmath78 vector corresponds to prior information on the comparative sizes of the parameters .",
    "[ [ s3_dag ] ] s3 appendix .",
    "+ + + + + + + + + + + +    * directed acyclic graph of the model *     for a concise description of the parameters . ]    [ [ s4_type_source_effects ] ] s4 appendix .",
    "+ + + + + + + + + + + +    * further details about the interpretation of the source and type effects .",
    "*    the interpretation of source and type effects depends on the quality and type of data collected , the model specification , and the characteristics of the organism of interest .",
    "source effects account for factors such as the amount of the food source consumed , the physical properties of the source and the environment provided for the bacteria through storage and preparation .",
    "including an environmental source in the model can be thought of as grouping the ( individually ) unmeasured wildlife sources into one .",
    "it may also be a transmission pathway for pathogens present in livestock sources ( for example , through the contamination of waterways ) which complicates the interpretation meaning the source effects no longer directly summarise the ability of the source to act as a vehicle for food - borne infections @xcite .",
    "future work could involve attributing the water/ environmental samples to the other sources of infection ( such as contamination from bovine , ovine , poultry , or other animal sources ) .",
    "therefore , it would be possible to estimate the proportion of cases attributed to a sample directly , and via the environement .    [",
    "[ s5_running_package ] ] s5 appendix .",
    "+ + + + + + + + + + + +    * helpful details regarding use of ` sourcer ` *    the ` sourcer ` package currently allows the relative prevalence matrix to be fixed at the maximum likelihood estimates , which includes zero values where a particular type was not detected in any samples from a source . fixing the relative prevalence matrix increases the posterior precision ( and significantly reduces run time ) , but the results may be biased if the source data is not of high quality .",
    "reducing the number of elements in the relative prevalence matrix @xmath79 that get updated at each iteration can significantly reduce computation time , however , the chains will converge more slowly .",
    "care must be taken in performing marginal interpretations of the number of type parameters .",
    "it is much easier to split a group into two ( with similar group means ) than it is to merge two groups with clearly different means .",
    "hence , a histogram of the number of groups per iteration is positively skewed compared to the true number of groups . when fitting the model with simulated data , visually assessing the dendrogram and heatmap to determine the number of groups usually provides a closer value to the true number of groups than looking at a histogram , particularly when the group means are well separated .",
    "[ [ s6_mcmc_alg ] ] s6 appendix",
    ". + + + + + + + + + + + +    * full mcmc algorithm . *",
    "this section gives the full details of the algorithm used to fit our fully joint non - parametric source attribution model .",
    "the outline mcmc is shown in algorithm [ alg : mcmc ] .",
    "the dirichlet distributed source effects @xmath54 across times @xmath28 and locations @xmath29 ( step 1 ) , and the relative prevalences @xmath38 across sources @xmath7 and times @xmath28 ( step 2 ) are updated using a constrained adaptive multisite logarithmic metropolis - hastings update step for 95% of proposals , and a constrained adaptive multisite metropolis - hastings update step for the remainder to prevent the chain getting stuck at very low values @xcite .",
    "the adaptive algorithm updates the tuning value every 50 updates of the parameter .",
    "this is further explained in algorithm [ alg : constrainedmrw ] .",
    "initialize all parameters    let @xmath80    for the dirichlet process prior on @xmath12 , a marginal gibbs sampler is constructed , as described in algorithm [ alg : dpmarginalgibbs ] .",
    "let @xmath81 denote a set of cluster identifiers , with the @xmath15-dimensional group assignment vector @xmath82 associating elements of @xmath12 with clusters , such that @xmath83 assigns @xmath84 to cluster @xmath85 .",
    "furthermore , each cluster @xmath85 assumes a value @xmath86 such that @xmath87 .    in step 1 of algorithm",
    "[ alg : dpmarginalgibbs ] , conjugacy between the gamma - distributed base distribution @xmath88 and the poisson data likelihood permits the calculation of multinomial conditional posteriors for elements of @xmath82 arising from the chinese restaurant process construction . here",
    ", the conditional posterior probability of type @xmath5 being assigned to group @xmath85 is as shown in algorithm [ alg : dpmarginalgibbs ] , with conjugacy permitting marginalisation with respect to the base distribution in order to calculate the probability of being assigned to a new group @xmath89 @xmath90 with @xmath91 and @xmath92    if a type is assigned to a new group , the set @xmath81 is augmented and a corresponding cluster value is drawn from the posterior of @xmath93 .",
    "conversely , @xmath81 is shrunk if a particular group becomes empty .    in step 2 ,",
    "the group values are drawn from the posterior , conditional on @xmath82 .",
    "the algorithm therefore alternates between updating group assignments @xmath82 and group values @xmath52 .",
    "hence , it explores the number of groups present , the type effects assigned to each group , and the values of each group .",
    "[ [ s7_cor_plot ] ] s7 appendix .",
    "+ + + + + + + + + + + +    * posterior correlations and non - identifiability of source attribution .",
    "*    [ [ s8_sim_study ] ] s8 appendix .",
    "+ + + + + + + + + + + +    * worked example showing features of package using simulated data . *    in this section , we provide a worked example using simulated data with multiple times and locations for source attribution data generated from the model in section [ sec : model ] ( available in the ` sourcer ` data sets )",
    ". there are two times ( 1 , 2 ) and two locations ( a , b ) over which the human cases vary .",
    "the data must be in long format , with columns giving the number of human cases for each type , a column for each of the sources giving the number of positive samples for each type , and columns giving the time , location and type i d s for each observation .",
    "note , the source data is the same for all locations within a time .",
    "the algorithm is run for a total of 500,000 iterations ( with a burn in of 10000 iterations and thinning 500 ) .",
    "the acceptance rates for all parameters ( except those updated using a gibbs sampler ) can be accessed using the ` my_model$acceptance ( ) ` .    ....",
    "# # source and human case data data(sim_sa_data ) # # prevalences for each source/ time data(sim_sa_prev ) # # true values for the model parameters data(sim_sa_true ) priors < - list(a_theta = 0.01 , b_theta = 0.00001 ,                 a_alpha = 1 , a_r = 0.1 ) my_model < - halddp$new(data = sim_sa_data , k = sim_sa_prev ,                          priors = priors , a_q = 0.1 ) ....    fitting parameters for the mcmc are be passed using    ....",
    "my_model$fit_params(n_iter = 1000 , burn_in = 2000 , thin = 500 ) ....    the model is then run using    ....",
    "set.seed(59623 ) my_model$update ( ) ....    trace and autocorrelation plots for the parameters ( figure  [ fig : trace_acf_sim_data_plots ] ) indicate that the markov chain is mixing well and has converged , and that thinning by 500 is adequate .",
    "the following r code demonstrates how to access and plot the marginal posteriors for some parameters .    ....",
    "# # plot the marginal posterior for source effect 2 , time 1 , location a plot(my_model$extract(params = \" alpha \" , times = \" 1 \" , locations = \" b \" ,        sources = \" source4\")$alpha , type=\"l \" )        # # plot the marginal posterior for the type effect 21 plot(my_model$extract(params = \" q \" , types = \" 21\")$q , type=\"l \" )    # # plot the marginal posterior for the relative prevalence of   # # source effect 5 , type 17 , at time 2 plot(my_model$extract(params = \" r \" , times = \" 2 \" , sources = \" source5 \" ,        types = \" 17\")$r , type=\"l \" )        # # plot the marginal posterior for lambda_j source 1 , time 1 , location a plot(my_model$extract(params = \" lambda_j \" , times = \" 1 \" , locations = \" a \" ,        sources = \" source1\")$lambda_j , type = \" l \" )        # # plot the marginal posterior for lambda_i 10 , time 2 , location b plot(my_model$extract(params = \" lambda_i \" , times = \" 2 \" , locations = \" b \" ,        types = \" 10\")$lambda_i , type=\"l \" ) ....    medians and credible intervals can be obtained for each parameter using ` res$summary ( ) ` .",
    "the marginal density plots of the number of cases attributed to each source at each time and location ( @xmath94 ) show that the true values ( shown by a red horizontal line on the graph ) are being estimated well ( figure  [ fig : sim_pois_lambdaj_plots ] ) .",
    "the violin plots of the number of cases attributed to each type ( residual plot ) for @xmath59 ( figure   [ fig : lambda_i_residuals ] ) shows that the model is fitting well .",
    "the heatmap shows the grouping of the type effects ( figure  [ fig : type_effect_heatmap ] ) computed using a dissimilarity matrix from the clustering output of the mcmc .",
    "the coloured bar under the dendrogram gives the correct grouping from the simulated data .",
    "this shows that the majority of types have been classified correctly .",
    "the research for this paper was financially supported by the ministry for primary industries , the institute of fundamental sciences ( massey university ) , the mepilab ( massey university ) , and chicas ( lancaster university ) .",
    "we acknowledge the following individuals and groups : mepilab ( massey university ) , midcentral public health services and petra mullner ( for the manawatu data set ) and geoff jones ( for his helpful input on automatic clustering methods ) .",
    "havelaar ah , kirk md , torgerson pr , gibb hj , hald t , lake rj , et  al .",
    "world health organization global estimates and regional comparisons of the burden of foodborne disease in 2010 .",
    "doi:10.1371/journal.pmed.1001923 .    . who estimates of the global burden of foodborne diseases : foodborne disease burden epidemiology reference group 2007 - 2015 ; 2015",
    "available on the who web site ( www.who.int ) or can be purchased from who press , world health organization , 20 avenue appia , 1211 geneva 27 , switzerland .",
    "available from : http://apps.who.int/iris/bitstream/10665/199350/1/9789241565165_eng.pdf?ua=1 .",
    "allos bm , moore mr , griffin pm , tauxe rv .",
    "surveillance for sporadic foodborne disease in the 21st century : the foodnet perspective . clinical infectious diseases .",
    "2004;38(supplement 3):s115s120 .",
    "doi:10.1086/381577 .",
    "baker m , wilson r , ikram r , chambers s , shoemack s , cook g. regulation of chicken contamination urgently needed to control new zealand s serious campylobacteriosis epidemic . the new zealand medical journal .",
    "2006;.    mullner p , collins - emerson j , midwinter a , carter p , spencer s , van der logt p , et  al .",
    "molecular epidemiology of campylobacter jejuni in a geographically isolated country with a uniquely structured poultry industry . applied and environmental microbiology .",
    "2010;76(7):21452154 .",
    "van pelt w , van  de giessen a , van leeuwen w , wannet w , henken a , evers e. oorsprong , omvang en kosten van humane salmonellose .",
    "oorsprong van humane salmonellose met betrekking tot varken , rund , kip , ei en overige bronnen .",
    "infectieziekten bull .",
    "1999;.            wilson dj , gabriel e , leatherbarrow ajh , cheesbrough j , gee s , bolton e , et  al . rapid evolution and the importance of recombination to the gastroenteric pathogen campylobacter jejuni . molecular biology and evolution ."
  ],
  "abstract_text": [
    "<S> zoonotic diseases are a major cause of morbidity , and productivity losses in both humans and animal populations . </S>",
    "<S> identifying the source of food - borne zoonoses ( e.g. an animal reservoir or food product ) is crucial for the identification and prioritisation of food safety interventions . for many zoonotic diseases it is difficult to attribute human cases to sources of infection because there is little epidemiological information on the cases . </S>",
    "<S> however , microbial strain typing allows zoonotic pathogens to be categorised , and the relative frequencies of the strain types among the sources and in human cases allows inference on the likely source of each infection . </S>",
    "<S> we introduce ` sourcer ` , an ` r ` package for quantitative source attribution , aimed at food - borne diseases . </S>",
    "<S> it implements a fully joint bayesian model using strain - typed surveillance data from both human cases and source samples , capable of identifying important sources of infection . </S>",
    "<S> the model measures the force of infection from each source , allowing for varying survivability , pathogenicity and virulence of pathogen strains , and varying abilities of the sources to act as vehicles of infection . </S>",
    "<S> a bayesian non - parametric ( dirichlet process ) approach is used to cluster pathogen strain types by epidemiological behaviour , avoiding model overfitting and allowing detection of strain types associated with potentially high virulence.    ` sourcer ` is demonstrated using _ campylobacter jejuni _ isolate data collected in new zealand between 2005 and 2008 . </S>",
    "<S> chicken from a particular poultry supplier was identified as the major source of campylobacteriosis which is qualitatively similar to results of previous studies using the same dataset . </S>",
    "<S> additionally , the software identifies a cluster of 9 mlsts with abnormally high virulence in humans .    ` </S>",
    "<S> sourcer ` enables straightforward attribution of cases of zoonotic infection to putative sources of infection by epidemiologists and public health decision makers . as ` sourcer ` develops , we intend it to become an important and flexible resource for food - borne disease attribution studies . </S>"
  ]
}