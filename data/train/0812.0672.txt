{
  "article_text": [
    "a metric space @xmath0 is called a ptolemy metric space , if the inequality @xmath1 .",
    "+ in this paper we study subgroups @xmath2 of the isometry group of geodesic ptolemy spaces @xmath0 , which act properly and cocompactly on @xmath0 . our motivation to study these spaces is described in subsection [ subsec : motivation ] .",
    "+ we adopt the notation of @xcite(p.131 ) and call an action _ proper _ , if for every @xmath3 there is a number @xmath4 such that the set @xmath5 is finite .",
    "an action is _ cocompact _",
    ", if there is a compact subset @xmath6 , such that @xmath7 .",
    "since @xmath0 allows a proper and cocompact action by isometries , @xmath0 is complete and , since @xmath0 is geodesic , it is indeed a proper metric space , i.e. closed distance balls are compact ( see @xcite p. 132 , 8.4(1 ) ) .",
    "+ the fact that @xmath0 is a proper metric space is used essentially in our paper .",
    "we recall that a group @xmath8 is called _ crystallographic _ if , for some @xmath9 , @xmath8 is isomorphic ( as an abstract group ) to a discrete , cocompact subgroup of the isometry group @xmath10 .",
    "the number @xmath11 is then called the _ rank _ of @xmath8 .",
    "a map @xmath12 between metric spaces is called _ roughly isometric _ , if there exists a constant @xmath13 such that for all @xmath14 we have @xmath15 there exits @xmath3 with @xmath16 , we call @xmath17 a",
    "_ rough isometry_.    [ thm : cryst ] let @xmath0 be a geodesic ptolemy metric space and let @xmath2 be a crystallographic group of rank @xmath11 acting properly and cocompactly on @xmath0 .",
    "then there exists a continuous rough isometry @xmath18 , which is equivariant with respect to the group operation , i.e. @xmath19 , where @xmath8 acts on @xmath20 by isometries with compact quotient .    in the case",
    "that @xmath0 is a topological manifold we can say more .",
    "[ thm : manifold ] let @xmath0 be a geodesic ptolemy metric space which is in addition a topological manifold .",
    "assume that @xmath2 is a crystallographic group of rank @xmath11 which acts properly and cocompactly on @xmath0 .",
    "then there actually exists an equivariant isometry @xmath18 .",
    "the methods of the proof in connection with the results in @xcite give also the following general structure result for abelian groups operating on ptolemy spaces :    [ thm : straight ] let @xmath0 be a geodesic ptolemy metric space and let @xmath2 act properly and cocompactly on @xmath0 .",
    "then every free abelian subgroup of @xmath8 is straight in @xmath8 .    to define the notion of straightness we recall the word norm @xmath21 of a finitely generated group .",
    "let @xmath22 be a set of generators of @xmath8 .",
    "then for @xmath23 , @xmath24 is defined as the length of the shortest word in the @xmath25 and @xmath26 representing @xmath27 .",
    "this norm depends on the choice of generators",
    ". however , as it is easy to see , different sets of generators give rise to equivalent norms .",
    "that is , if @xmath28 and @xmath29 are such norms , then there exists a constant @xmath30 such that @xmath31 for all @xmath23 .",
    "a finitely generated subgroup @xmath32 is called _ straight _ in @xmath8 , if @xmath33 and @xmath21 are equivalent norms on @xmath34 .",
    "this notion is independent of the choice of generators on @xmath34 and @xmath8 .    as a consequence of theorem [ thm : straight ]",
    "we can generalize our result to the action of virtual polycyclic groups .",
    "a group is called _ polycyclic _ , if it admits a finite chain of subgroups @xmath35 , such that @xmath36 is the trivial subgroup and @xmath37 , such that @xmath38 is cyclic .",
    "equivalently a group is polycyclic if it is solvable and every subgroup is finitely generated .",
    "a group is called _ virtual polycyclic _ if it contains a polycyclic subgroup of finite index . in particular crystallographic groups",
    "are virtual polycyclic .",
    "[ cor : solv ] theorem [ thm : cryst ] and theorem [ thm : manifold ] hold also if @xmath2 is assumed to be virtual polycyclic . in particular if a virtual polycyclic group acts properly and cocompactly on a geodesic ptolemy space then there exists a homomorhism @xmath39 with finite kernel such that the image is a crystallographic group .    at the end of the introduction we state a result , which we need in the proof and which is of independent interest ,",
    "see section [ sec : convexity ] .",
    "[ thm : sdc ] a proper , geodesic ptolemy metric space is strictly distance convex .",
    "it is a pleasure to thank alexander lytchak for many inspiring discussions .",
    "all the above results are well known if the space @xmath0 is a @xmath40 space .",
    "a @xmath40-space is ptolemy ( see @xcite ) .",
    "it is an open question if proper ptolemy metric spaces are @xmath40 ( we remark that there are nonlocally compact ptolemy spaces which are not @xmath40 , see @xcite ) . to be very concrete , we do not even know , whether the flat strip theorem of @xmath40-spaces ( see e.g. @xcite p.182 ) holds for ptolemy metric spaces : assume that @xmath41 is a distance function on the set @xmath42 $ ] , such that @xmath43 is a geodesic ptolemy space , the topology on @xmath43 coincides with the standard topology , the curves @xmath44 are geodesics parameterized by arclength for @xmath45 and @xmath46 for some constant @xmath47 .",
    "question : is @xmath43 isometric to a flat strip @xmath48 $ ] ?",
    "we do not know the answer even under the additional assumption that the translation map @xmath49 , @xmath50 is an isometry . in the case of @xmath40 spaces",
    "the flat strip theorem follows from the fact that the distance function @xmath51 is convex for geodesics @xmath52 \\to x$ ] .",
    "we also remark that the convexity of the function @xmath51 is the essential tool to obtain the analogous results of theorem [ thm : cryst ] and theorem [ thm : manifold ] in the @xmath40-case .",
    "since we do not have this convexity , our proof in the ptolemy case is very different .",
    "we outline our main ideas : our proof relies on a weaker form of convexity .",
    "in geodesic ptolemy metric spaces the distance function @xmath53 to a point @xmath54 is convex . as a consequence also busemann functions are convex .",
    "we show ( in the setting of theorem [ thm : manifold ] ) that the busemann function of an axis of an element @xmath55 ( where @xmath56 is the maximal abelian subgroup of @xmath8 ) is indeed an affine function .",
    "we can show that there are enough affine functions to separate points .",
    "thus we can apply the main theorem of @xcite to obtain that @xmath0 is isometric to a convex subset of a normed vector space .",
    "finally we have to use the theorem of schoenberg @xcite to see that @xmath0 is isometric to a euclidean space . in the setting of theorem [ thm : cryst ]",
    "we need suitable modifications .",
    "we should mention that the result and parts of its proof have some analogy to the `` hopf conjecture '' and its proof in @xcite .",
    "compare in this context also @xcite and the discussion in @xcite , p.43 ff .      at the end of this introduction",
    "we give an idea why we investigate geodesic ptolemy spaces .",
    "our motivation was the study of the boundary of @xmath57 spaces .",
    "on the ideal boundary @xmath58 of a @xmath57-space @xmath59 , bourdon @xcite introduced a distance function @xmath60 , depending on a point @xmath61 . a similar metric @xmath62 on @xmath63",
    "was introduced by hamenstdt @xcite , where the metric depends on a point @xmath64 and a busemann function for this point .",
    "the metrics @xmath65 are all mbius equivalent . for a detailed description",
    "compare @xcite .",
    "let us describe the elements of mbius geometry on metric spaces .",
    "let @xmath0 be a metric space , where @xmath66 is the distance of @xmath67 and @xmath68 .",
    "to a quadruple @xmath69 ( where @xmath70 is the diagonal of points where one entry appears 3 or 4 times ) , we associate the _ cross ratio triple _",
    "@xmath71 similar to the classical crossratio there are six reasonable definitions by permuting the entries .",
    "a map @xmath72 is called a _ mbius map _ , if it is injective and for all quadruples from @xmath73 we have @xmath74 .",
    "this definition is equivalent to the usual definition using the classical cross ratio .",
    "let @xmath75 be the subset of points @xmath76 , such that the three numbers @xmath77 satisfy the triangle inequality .",
    "then @xmath0 is a ptolemy metric space , if and only if for all allowed quadruples @xmath78 .",
    "therefore the ptolemy condition is in a natural way a mbius invariant condition . in a certain sense",
    "the ptolemy condition is the natural condition for involutive geometry : note that a metric space @xmath0 is ptolemy if and only if for all points @xmath3 the map @xmath79 , @xmath80 is a metric ( see also @xcite ) .",
    "in @xcite we made the observation that the bourdon and hamenstdt metrics on @xmath81 are ptolemy for @xmath57-spaces @xmath59 and the isometries of @xmath59 extend to mbius maps on @xmath81 . in ptolemy",
    "metric spaces one can naturally define the notion of a circle ( in the generalized sense , i.e. a circle or a line ) . recall that the classical ptolemy theorem states that four points @xmath82 ( in the euclidean plane or more generally in @xmath20 ) lie on a circle ( or a line ) if and only if @xmath83 , where @xmath84 is the set of points @xmath76 with equality in the triangle inequality .",
    "thus let us define    let @xmath0 be a ptolemy space .",
    "a _ circle _ in @xmath0 is a continuous map @xmath85 , such that for all @xmath86 we have equality in the ptolemy inequality , i.e. @xmath87 .",
    "it then turns out that for points @xmath86 , which are ordered cyclically on @xmath88 ( i.e. @xmath68 and @xmath89 lie in different components of @xmath90 ) , we have equality of the form @xmath91 .",
    "note that this notion of a circle is obviously mbius invariant and thus circles are preserved by mbius maps .",
    "now one can reformulate a result of bourdon ( see @xcite ) in the following way : let @xmath59 be a @xmath57-space and consider @xmath81 as a ptolemy space with some bourdon or hamenstdt metric .",
    "let @xmath92 be a circle , then there exists a totally geodesic subspace @xmath93 isometric to @xmath94 , such that @xmath95 is the image of @xmath96 . indeed the circles in @xmath97 correspond @xmath98 to the boundaries of isometrically embedded hyperbolic planes in @xmath59 .",
    "this is one motivation to study ptolemy spaces with many circles .",
    "if we look to our definition of a circle , a circle through infinity should just be a proper map @xmath99 such that for all allowed quadruples @xmath100 we have @xmath87 . for arbitrary but fixed @xmath101 and @xmath102",
    "this implies that @xmath103 .",
    "equivalently , this condition says that @xmath99 is a geodesic line ( not necessarily parameterized proportionally to arclength ) . from this viewpoint",
    "it is also natural to study ptolemy spaces with many lines .",
    "let @xmath0 be a metric space . by @xmath66 we denote the distance between points @xmath104 . unless otherwise stated , we will parameterize geodesics proportionally to arclength .",
    "thus a geodesic in @xmath0 is a map @xmath105 with @xmath106 for all @xmath107 and some constant @xmath108 .",
    "a metric space is called geodesic if every pair of points can be joined by a geodesic . in the sequal @xmath0",
    "will always denote a geodesic metric space .",
    "for @xmath104 we denote by @xmath109 the set of midpoints of @xmath67 and @xmath68 .",
    "a subset @xmath110 is _ convex _ , if for @xmath111 also @xmath112 .",
    "a function @xmath113 is _ convex _ ( resp .",
    "_ affine _ ) , if for all geodesics @xmath105 the map @xmath114 is convex ( resp .",
    "affine ) .    the space @xmath0 is called _ distance convex _ if for all @xmath54 the distance function @xmath115 to the point @xmath116 is convex .",
    "it is called _ strictly distance convex _ , if the functions @xmath117 are strictly convex whenever @xmath118 is a geodesic with @xmath119 for all @xmath120 .",
    "this definition is natural , since the restriction of @xmath121 to a geodesic segment containing @xmath116 is never strictly convex .",
    "the ptolemy property easily implies ( see @xcite ) :    [ lem - distance - convex ] a geodesic , ptolemy metric space is distance convex .    as a consequence",
    ", we obtain that for ptolemy metric spaces local geodesics are geodesics . here",
    "we call a map @xmath105 a _ local geodesic _ , if for all @xmath122 there exists a neighborhood @xmath123 , such that @xmath124 is a geodesic .",
    "[ lem : localglobalgeodesic ] if @xmath0 is distance convex , then every local geodesic is globally minimizing .",
    "assume the contrary , then there is a local geodesic",
    "@xmath125 \\to x$ ] , such that there exists @xmath126 such that for @xmath127 we have @xmath128 for all @xmath129 but @xmath130 for @xmath131 . the distance convexity applied to @xmath121 and the minimizing geodesic @xmath132}$ ] implies that @xmath133 , a contradiction .",
    "in @xcite we gave examples of ptolemy metric spaces which are not strictly distance convex .",
    "however , if the space is proper , then the situation is completely different . + * theorem * [ thm : sdc ] . _ a proper ,",
    "geodesic ptolemy metric space is strictly distance convex . _",
    "+ before we prove this result , we derive some consequences .",
    "the first corollary has already been proved in @xcite .",
    "[ cor : uniquemidpoint ] ( see also @xcite ) let @xmath0 be a proper , geodesic ptolemy space . then for @xmath104 there exists a unique midpoint @xmath134 .",
    "the midpoint function @xmath135 is continuous .",
    "assume that there are midpoints @xmath136 .",
    "let @xmath137 be a midpoint of @xmath138 and @xmath139 .",
    "if @xmath140 , then the strict distance convexity according to theorem [ thm : sdc ] implies @xmath141 , and @xmath142 , which is a contradiction .",
    "the uniqueness of the midpoint function together with the properness easily imply the continuity of @xmath137 .",
    "[ cor : center ] let @xmath0 be a proper , geodesic ptolemy space , and let @xmath6 be a compact subset .",
    "then there exists a unique closed ball @xmath143 of minimal radius , such that @xmath144 .",
    "the existence of such a ball of minimal radius is clear .",
    "we have to prove the uniqueness .",
    "assume that @xmath145 , with @xmath146 .",
    "let @xmath137 be the midpoint of @xmath147 and @xmath148 . if @xmath149 , then @xmath150 and the strict convexity of the distance function implies @xmath151 . by compactness @xmath152 for some @xmath153 contradicting the minimality of @xmath154 .",
    "[ cor : projection ] let @xmath0 be a proper , geodesic ptolemy space , and @xmath155 be a closed and convex subset .",
    "then there exists a continuous projection @xmath156 .",
    "the strict convexity of the distance function easily implies with a similar argument as in the proof above , that for given @xmath3 , there exists a unique @xmath157 , with @xmath158 minimal .",
    "one easily checks that this projection is continuous .    for @xmath40 spaces",
    "this projection is always @xmath159-lipschitz .",
    "we do not know if @xmath160 is @xmath159-lipschitz for general proper geodesic ptolemy spaces .",
    "the strict convexity of the distance function together with the properness implies easily    let @xmath0 be a proper , geodesic ptolemy space and let @xmath104 . then there exists a unique geodesic @xmath161\\to x$ ] from @xmath67 to @xmath68 and the map @xmath162 \\to x$ ]",
    ", @xmath163 is continuous .",
    "as a consequence @xmath0 is contractible .",
    "indeed for the choice of a basepoint @xmath164 the map @xmath165 \\to x$ ] , @xmath166 is a contraction .",
    "[ cor : extgeod ] let @xmath0 be a complete , geodesic ptolemy space .",
    "if @xmath0 is a topological manifold , then every geodesic is extendable .",
    "thus for every geodesic segment @xmath105 there exists a geodesic @xmath167 with @xmath168 .",
    "let @xmath118 be a geodesic defined on some interval @xmath169 , which can not be extended .",
    "we have to show that @xmath170 .",
    "if @xmath171 is a constant map , then it can be extended trivially .",
    "thus @xmath172 consists of more than one point and @xmath171 is not a constant geodesic .",
    "since @xmath0 is complete , we see that @xmath172 is ( after obvious reparameterization ) of the form @xmath173 $ ] with @xmath174 or of the form @xmath175 $ ] for some @xmath176 . in both cases the geodesic @xmath177}:[0,a ] \\to x$ ] can not be extended over its endpoint @xmath178 , since otherwise also @xmath171 could be extended by lemma [ lem : localglobalgeodesic ] .",
    "let @xmath179 and @xmath180 .",
    "the nonextendability of @xmath181}$ ] implies that for every point @xmath182 , the point @xmath67 is not contained in @xmath183)$ ] .",
    "thus @xmath184 defines also a retraction @xmath185 \\to x\\setminus\\{x\\}$ ] , and hence @xmath0 as well as @xmath186 are contractible .",
    "this is in contradiction to the fact that @xmath187 , since @xmath0 is a manifold .",
    "we now prove theorem [ thm : sdc ] .",
    "we start with a simple observation .",
    "[ lem - aux ] if @xmath188 are real numbers with @xmath189 , then @xmath190 .",
    "then @xmath191 , where @xmath192 .",
    "we compute @xmath193 if @xmath194 , then our estimate holds trivially .",
    "if @xmath195 , then the assumption implies that @xmath196 and @xmath197 .",
    "* proof of theorem [ thm : sdc ] : * note that in order to prove theorem [ thm : sdc ] it suffices to prove the + * claim : * _ let @xmath0 be a proper , geodesic , ptolemy metric space .",
    "let further @xmath198 be points with @xmath199 then there exists a midpoint @xmath137 of @xmath67 and @xmath68 such that @xmath200 $ ] .",
    "_ + indeed , since a geodesic ptolemy metric space is distance convex by lemma [ lem - distance - convex ] , the claim implies the uniqueness of midpoints and therefore the validity of theorem [ thm : sdc ] .",
    "+ in order to prove the claim , we set @xmath201 thus , @xmath202 by assumption ( [ eqn - excess ] ) .",
    "let @xmath203 $ ] and let @xmath204 as well as @xmath205 .",
    "thus , @xmath206 and @xmath207 .",
    "+ we first make the additional assumption that @xmath208 and @xmath184 are very close together , i.e. , both are very close to @xmath159 . namely we assume that @xmath209 clearly this assumption holds for @xmath210 ( and hence @xmath211 ) , and at first reading one might as well consider this special case .",
    "we will now prove the claim under the assumption ( [ eqn - assumption - tau - rho ] ) .",
    "later we will reduce the general case to this special situation . + choose geodesics @xmath212\\longrightarrow x$ ] connecting @xmath116 to @xmath67 and @xmath68 , parameterized proportionally to arclength . for every @xmath213 $ ] let @xmath214\\longrightarrow x$ ]",
    "be a geodesic connecting @xmath215 to @xmath216 , parameterized proportionally to arclength . since @xmath0 is proper",
    ", there exists a sequence @xmath217 , @xmath218 , such that @xmath219 , where @xmath137 is some midpoint of @xmath67 and @xmath68 .",
    "+ the distance convexity of geodesic , ptolemy metric spaces implies @xmath220 $ ] . to prove our claim , we assume equality and",
    "will finally reach a contradiction .",
    "+ thus we assume @xmath221=s$ ] .    .",
    "]    we set @xmath222 since @xmath223 we have @xmath224 .",
    "+ by simple triangle inequality , the ptolemy inequality for @xmath225 and the sum of the ptolemy inequalities for @xmath226 and @xmath227 , we obtain the inequalities @xmath228 now the distance convexity [ lem - distance - convex ] yields @xmath229 and similiarly @xmath230 .",
    "these inequalities together with the triangle inequality @xmath231 also yield @xmath232 as well as @xmath233 .",
    "hence we obtain @xmath234 and @xmath235 .",
    "+ in the same way , we deduce @xmath236 and @xmath237 .",
    "+ thus , passing to appropiate subsequences , we find @xmath238 , such that @xmath239 and @xmath240 , @xmath241 and @xmath242 above now yield    @xmath243    but lemma [ lem - aux ] , the inequalities ( [ eqn - frac - betraege ] ) , inequality @xmath244 , @xmath245 and inequality ( [ eqn - assumption - tau - rho ] ) also yield @xmath246 which contradicts to the simultanious validity of the inequalies @xmath247 , and @xmath248 .",
    "+ finally we have to get rid of the assumption that @xmath184 and @xmath208 are close together .",
    "consider some arbitrary @xmath249 with @xmath250 .",
    "consider a geodesic @xmath251 \\to x$ ] , @xmath252 from @xmath253 to @xmath254 parameterized proportionally to arclength .",
    "if @xmath255 , we are done .",
    "thus we assume @xmath256 which then implies by lemma [ lem - distance - convex ] that @xmath257 is affine . as a consequence",
    "we see that @xmath258 is constant .",
    "thus if we take as a new triple the points @xmath259 for some @xmath260 , then the corresponding @xmath261 is the same as for the original triple .",
    "now we can choose @xmath262 sufficiently small , such that for @xmath263 and @xmath264 , @xmath265 the estimate ( [ eqn - assumption - tau - rho ] ) holds ( this is possible , since @xmath261 is fixed and @xmath266 tend to 1 for @xmath267 ) . thus by the above argument , there exists a midpoint @xmath268 of @xmath269 and @xmath270 with @xmath271 .",
    "clearly @xmath268 is also a midpoint of @xmath253 and @xmath254 and we are done .",
    "we recall some facts about normed vector spaces which we will use in the sequel .",
    "let @xmath273 be a normed vector space .",
    "a line in @xmath274 is a map @xmath275 of the form @xmath276 , where @xmath277 .",
    "a line is always a geodesic , however if the normball is not strictly convex , there are other geodesics .",
    "we call a subset @xmath278 _ line - convex _ , if for @xmath111 also the segment @xmath279\\to v$ ] , @xmath280 is contained in @xmath281 .",
    "we use the notion line - convex since it differs from the notion of convexity as defined in section [ sec : convexity ] for normed spaces with non strictly ( line)-convex normball .",
    "let @xmath282 , then a line @xmath275 parameterized by arclength is called an axis of @xmath27 , if @xmath283 for some @xmath284 .",
    "if @xmath27 has an axis , then we denote with @xmath285 the set of points , which lie on axes of @xmath27 .",
    "then @xmath286 is a closed , line - convex subset of @xmath274 .",
    "if @xmath287 commutes with @xmath27 , then @xmath286 is @xmath288-invariant .",
    "essential for our argument is the following result of schoenberg @xcite    [ thm : schoenberg ] a normed vector space @xmath273 is a ptolemy space , if and only if it is an inner product space .    using asymptotic cones , it is not difficult to prove    if a normed vector space is rough isometric to a ptolemy space , then it is a ptolemy space",
    ".    therefore we obtain    [ cor : corschoenberg ] if a normed vector space @xmath273 is rough isometric to a ptolemy space , then it is an inner product space .",
    "in this section @xmath0 allways denotes a geodesic ptolemy space .",
    "let @xmath289 be a geodesic ray parameterized by arclength . as usual",
    "we define the _ busemann function _ @xmath290 . since @xmath291 is the limit of the convex functions @xmath292 , it is convex .",
    "the following proposition implies that , in a ptolemy space , rays with sublinear distance to each other define ( up to a constant ) the same busemann functions .    [ prop : sublinearrays ] let @xmath0 be a ptolemy space , let @xmath293 be rays with busemann functions @xmath294 , and assume @xmath295 .",
    "then @xmath296 is constant .",
    "let @xmath297 and let @xmath298 , @xmath299 .",
    "we define @xmath300 , such that @xmath301 and @xmath302 .",
    "hence we have @xmath303 and @xmath304 .",
    "since @xmath0 is ptolemy , the three numbers @xmath305 satisfy the triangle inequality .",
    "the assumption @xmath295 now implies @xmath306 and hence @xmath307 the last limit implies @xmath308 .",
    "let now @xmath309 be a geodesic line parameterized by arclength .",
    "let @xmath310 be the rays @xmath311 and @xmath312 .",
    "let further @xmath313 .",
    "the following follows easily .",
    "[ lem : pos ] @xmath314 and @xmath315 on the line @xmath171 .",
    "we now consider these busemann functions for lines with sublinear distance .",
    "[ prop : sublinearlines ] let @xmath316 be lines with @xmath317 and @xmath318",
    ". then @xmath319 .",
    "by proposition [ prop : sublinearrays ] we have that @xmath320 and @xmath321 are constant which implies that @xmath322 for some constant @xmath323 .",
    "we show that @xmath324 . if @xmath325 , then by lemma [ lem : pos ] @xmath326 and @xmath327 . thus @xmath328 . if @xmath329 , then @xmath330 and @xmath331 .",
    "thus @xmath332 .",
    "in this section @xmath0 always denotes a geodesic ptolemy metric space .",
    "let @xmath2 be a subgroup of the isometry group operating properly and cocompactly on @xmath0 .",
    "as already stated in the introduction , this implies that @xmath0 is proper and in particular complete .",
    "an element @xmath23 is a _ torsion element _ , if @xmath333 for some @xmath334 . to an element @xmath23 we associate the _ displacement function _ @xmath335 .",
    "a geodesic line is called an axis of an element @xmath27 , if there exists some @xmath336 such that @xmath283 for all @xmath337 .",
    "we always parametrize lines by arclength . by @xmath338",
    "we denote the union of all axes of @xmath27 .",
    "\\(1 ) @xmath339 assumes the minimum @xmath340 .",
    "\\(2 ) @xmath341 if and only if @xmath27 is a torsion element .",
    "\\(3 ) if @xmath27 is not torsion , then @xmath342 .",
    "\\(4 ) if @xmath343 are axis of @xmath27 , then @xmath344 is bounded .",
    "\\(5 ) if @xmath288 commutes with @xmath27 and @xmath171 is an axis of @xmath27 , then also @xmath345 is an axis of @xmath27 .",
    "\\(1 ) is standard .",
    "see e.g. the proof of lemma 2.1 . in @xcite .",
    "\\(2 ) if @xmath346 , then @xmath27 has a fixed point . since @xmath8 operates properly , @xmath27 is a torsion element . if @xmath27 is torsion , then , for given @xmath347 , the orbit @xmath348 is a @xmath27-invariant compact set . by corollary [ cor : center ] , there exists a unique @xmath54 , such that @xmath144 , where @xmath154 is minimal",
    ". then @xmath116 is fixed by @xmath27 , hence @xmath346 .",
    "\\(3 ) let @xmath27 be a nontorsion element .",
    "let @xmath349 be the minimum of the displacement function .",
    "let @xmath3 with @xmath350 .",
    "let @xmath309 be the piecewise geodesic with @xmath351 .",
    "note that @xmath352 and hence @xmath353 .",
    "thus @xmath354 by minimality of @xmath355 we have equality which implies that @xmath356}$ ] is minimizing .",
    "thus since also @xmath357}$ ] is minimizing , @xmath171 is locally minimizing and hence a geodesic by lemma [ lem : localglobalgeodesic ] .",
    "thus @xmath171 is an axis of @xmath27 .",
    "assume now that @xmath309 is an axis with @xmath358 , @xmath359 .",
    "we show that @xmath360 .",
    "let therefore @xmath3 and let @xmath361 . by triangle inequality @xmath362 hence @xmath363 for all @xmath137 , which implies @xmath364 .",
    "\\(4 ) since @xmath343 are axes parameterized by arclength , we have @xmath365 .",
    "\\(5 ) if @xmath288 commutes with @xmath27 and @xmath358 , then @xmath366 , hence also @xmath367 is an axis of @xmath27 .",
    "let now @xmath27 be a nontorsion element of @xmath8 .",
    "we define @xmath368 , where @xmath171 is an axis of @xmath27 .",
    "since two axis have bounded distance , @xmath369 is well defined up to a constant by proposition [ prop : sublinearlines ] .",
    "more generally we define @xmath370 and @xmath371 .",
    "note that @xmath372 is well defined and does not depend on the choice of an axis by proposition [ prop : sublinearrays ] .",
    "[ lem : businvariance ] ( 1 ) if @xmath288 commutes with @xmath27 , then @xmath373 is constant ( in @xmath67 ) .",
    "\\(2 ) @xmath374 .",
    "\\(3 ) @xmath375 on all axes of @xmath27 .",
    "\\(4 ) @xmath376 and @xmath377 for all @xmath378 .",
    "\\(1 ) if @xmath288 commutes with @xmath27 and @xmath309 is an axis of @xmath27 , then also @xmath379 is an axis of @xmath27 and hence in bounded distance to @xmath171 .",
    "thus @xmath380 and @xmath291 differ by a constant by proposition [ prop : sublinearrays ] .",
    "since @xmath381 we otain the result .",
    "\\(2 ) because of ( 1 ) we need to compute the equality only for @xmath382 where @xmath171 is an axis of @xmath27 .",
    "since @xmath383 with @xmath384 we are done .",
    "\\(3 ) is merely a reformulation of lemma [ lem : pos ] .",
    "\\(4 ) follows from an easy computation .",
    "now the proof of theorem [ thm : straight ] follows from the arguments in section iii of @xcite . the essential tool for the proof in that paper was corollary 2.6 which corresponds exactly to our lemma [ lem : businvariance ] .",
    "one can easily check that the proof in the cited paper transfers word by word to the present situation .",
    "let @xmath0 be a geodesic metric space .",
    "recall that for @xmath104 we denote by @xmath385 the set of midpoints of @xmath67 and @xmath68 . a map @xmath386 between two geodesic metric spaces",
    "is called _ affine _ , if for all @xmath104 , we have @xmath387 . thus a map is affine if and only if it maps geodesics parameterized proportionally to arclength into geodesics parameterized proportionally to arclength .",
    "an affine map @xmath113 is called an affine function .",
    "note that this definition coincides with the definition given in section [ sec : convexity ]    given a geodesic metric space @xmath0 , we set @xmath388 @xmath389 is a banachspace , where @xmath390 is the optimal lipschitz constant .",
    "we set @xmath391 , where @xmath392 if @xmath393 is constant . by @xmath394",
    "$ ] we denote the equivalence class of @xmath96 .",
    "then also @xmath395 is a banachspace , where @xmath396\\|=\\|f\\|$ ] .",
    "the group @xmath397 acts on @xmath389 ( and @xmath395 ) by linear isometries via @xmath398 ( resp .",
    "@xmath399)=[{\\gamma}(f)]$ ] ) .",
    "let @xmath400 be the banach dual space of @xmath395 with the norm @xmath401\\in{\\mathcal{a}}(x)}\\frac{|\\rho([f])|}{\\|[f]\\|}.\\ ] ] also @xmath397 operates linearly on @xmath402 by isometries via @xmath403)=\\rho({\\gamma}^{-1}([f]))$ ] .",
    "for @xmath104 let @xmath404 be the evaluation map @xmath405)=f(x)-f(y)$ ] .",
    "it follows directly from the definitions that @xmath406 . for @xmath407",
    "we have @xmath408 .    for a given basepoint @xmath164 consider the subset @xmath409 , and the map @xmath410 if @xmath411 and @xmath412 then for all @xmath394 \\in { \\mathcal{a}}$ ] we have @xmath413=f(z)-f(o)=\\frac{1}{2}(f(x)+f(y))-f(o ) = ( \\frac{1}{2}e(x , o)+\\frac{1}{2}e(y , o))[f].\\ ] ] thus @xmath414 is affine and maps the geodesics in @xmath0 to lines in @xmath415 . in particular @xmath416 is a line - convex subset of @xmath402 . since @xmath417 we see that @xmath414 is @xmath159-lipschitz .",
    "we consider the map @xmath418 given by @xmath419 . indeed @xmath420 is an affine isometric operation , since @xmath421 with respect to this affine operation the map @xmath414 is @xmath397-equivariant , i.e. @xmath422 . the isometries @xmath423 map lines in @xmath416 to lines in @xmath416 .",
    "we remark that this affine action of @xmath397 on @xmath416 is _ not _ the restriction of the linear action of @xmath397 on @xmath402 to the subset @xmath416 .",
    "we recollect all this information in the following    [ lem : aff ] if @xmath0 is a geodesic metric space , then the map @xmath424 is a surjective , affine , @xmath159-lipschitz and @xmath397-equivariant map of @xmath0 onto the line - convex subset @xmath425 .",
    "we say that _ affine functions separate points on @xmath0 _ , if for different @xmath104 there exists @xmath426 with @xmath427 .",
    "note that affine functions separate points if and only if the map @xmath414 is injective . in this case",
    "we have the following strong result of hitzelberger and lytchak @xcite .",
    "if affine functions separate points , then @xmath424 is an isometry .",
    "in this section we assume that @xmath0 is a geodesic ptolemy space and @xmath2 is a crystallographic group operating properly and cocompactly on @xmath0 . recall that under these assumptions @xmath0 is proper .",
    "a group @xmath8 is crystallographic , if and only if @xmath8 has a normal , free abelian subgroup @xmath56 of finite rank and finite index in @xmath8 which is maximal abelian in @xmath8 . in that case",
    ", @xmath56 is unique .",
    "note that @xmath428 , since @xmath56 is free of finite rank .",
    "since @xmath56 has finite index , @xmath56 also operates cocompactly on @xmath0 .",
    "let @xmath429 , let @xmath171 be an axis of @xmath288 and let @xmath430 be the corresponding busemann functions .",
    "it follows from lemma [ lem : businvariance ] that the function @xmath431 is @xmath56 invariant .",
    "since @xmath56 acts cocompactly the function @xmath432 is bounded .",
    "( of theorem [ thm : manifold ] ) we now assume in addition that @xmath0 is a manifold . thus by corollary [ cor : extgeod ] all geodesics in @xmath0 can be extended .",
    "thus the bounded convex functions @xmath432 are constant for all @xmath429 . since @xmath433 for a point on an axis of @xmath288 , we have that @xmath434 on @xmath0 .",
    "thus @xmath431 is in particular affine , and since the @xmath435 are convex , the functions @xmath435 are actually affine .",
    "we now show that the affine functions separate points .",
    "let therefore @xmath104 with @xmath440 .",
    "we first assume that @xmath441 .",
    "then there exists @xmath429 , such that @xmath442 .",
    "there also exists an axis @xmath309 of @xmath443 such that @xmath444 ( this follows since for any axis @xmath445 of @xmath288 and any @xmath446 , also @xmath447 is an axis of @xmath288 ) .",
    "consider now the affine function @xmath448 .",
    "since @xmath449 is @xmath159-lipschitz , we have @xmath450 , @xmath451 , @xmath452 , and @xmath453 by lemma [ lem : businvariance ] ( 2 ) .",
    "thus @xmath454 which shows that @xmath455 are separated by @xmath448 .",
    "let now @xmath104 be arbitrary with @xmath440 .",
    "let @xmath309 be the unit speed geodesic with @xmath456 and @xmath457 for @xmath458 .",
    "let @xmath459 and @xmath460 . by the above argument",
    "there exists an affine function @xmath96 , with @xmath461 .",
    "thus the affine function @xmath462 is not constant , and hence @xmath463 .    since affine functions separate points , the map @xmath464 is an isometry by the hitzelberger lytchak theorem .",
    "thus @xmath416 is an affine subspace of the normed vector space @xmath402 which is in addition a ptolemy space . by schoenbergs result",
    "it is an inner product space and hence isometric to the standard @xmath20 , where @xmath465 .",
    "let @xmath466 be a nonempty , closed , convex and @xmath8-invariant subset , which is minimal with respect to these properties . since @xmath8 operates cocompactly on @xmath0 , it is easy to show , that such minimal set @xmath467 exists .",
    "namely , consider an arbitrary chain @xmath468 of such sets .",
    "then this chain is bounded by the nonempty , closed , convex and @xmath469-invariant set @xmath470 . in order to see that this set is nonempty ,",
    "just take a compact , fundamental region @xmath471 of @xmath469 and consider the intersections @xmath472 , @xmath473 . since @xmath471 is a compact fundamental region , and",
    "the @xmath474 are @xmath469-invariant , it follows that @xmath475 .",
    "now the existence of a minimal set @xmath467 follows from zorn s lemma .    by corollary [ cor :",
    "projection ] there exists a continuous projection @xmath476 .",
    "this projection is @xmath8-equivariant and since @xmath8 operated cocompactly on @xmath0 as well as on @xmath467 , there exists a constant @xmath477 such that @xmath478 for all @xmath3 and hence @xmath160 is a rough isometry .",
    "thus we have to prove the theorem only for @xmath467 .",
    "thus we can suppose that @xmath0 satisfies the following additional              since @xmath432 is a continuous convex function , the condition ( 1 ) is closed and convex .",
    "since @xmath483 is a closed line - convex subset and @xmath414 is continuous , also condition ( 2 ) is closed and convex . since @xmath56 is a normal subgroup of @xmath8 , ( 1 ) and ( 2 ) describe a @xmath8-invariant condition .",
    "thus @xmath484 is closed convex and @xmath8-invariant .",
    "we now show that @xmath484 is not empty . to prove this ,",
    "let @xmath485 be a nonempty , closed , convex and @xmath56-invariant subset , which is minimal with these properties .",
    "since @xmath56 operates ( as a finite index subgroup of @xmath8 ) cocompactly on @xmath0 , it follows as above , that such minimal set @xmath486 exists .",
    "we show that @xmath487 and hence @xmath484 is not empty .",
    "let @xmath429 .",
    "since @xmath56 is abelian , the convex function @xmath432 is @xmath56-invariant and hence @xmath488 is closed , convex and @xmath56-invariant .",
    "thus it follows from lemma [ lem : businvariance ] ( 3 ) that @xmath491 .",
    "this shows that @xmath492 , since @xmath486 was assumed to be minimal and @xmath488 is closed , convex and @xmath56-invariant .",
    "+ recall that @xmath414 maps geodesics to lines or to a point .",
    "we show that @xmath493 is actually a complete line . since @xmath432 is constant and hence affine , also the functions @xmath435 are affine . since @xmath435 are not constant on @xmath494 , the map @xmath495 is also not constant .",
    "it follows that @xmath496 is a complete line which is @xmath497-invariant and hence an axis of @xmath497 .",
    "since @xmath56 is abelian , the set @xmath498 is closed , line - convex and @xmath499-invariant .",
    "hence @xmath500 is closed , convex and @xmath56-invariant . by minimality @xmath501 , which implies that for @xmath502 , we have @xmath482 .",
    "thus we have shown that @xmath503 and hence @xmath504 . by the additional assumption @xmath480 .",
    "we use arguments which are very similar to the arguments in the proof of theorem [ thm : manifold ] . again",
    "@xmath56 operates cocompactly on @xmath0 , and hence there exists @xmath436 such that for all @xmath437 there exists @xmath438 with @xmath439 .          by the above lemma all @xmath497 ,",
    "@xmath429 operate as translations on the set @xmath416 .",
    "thus the line - convex hull of @xmath509 is an affine subspace @xmath510 of dimension equal to @xmath511 for all @xmath347 .",
    "note that all @xmath512 are parallel to each other . since @xmath56 is a finite index normal subgroup of @xmath8 .",
    "there are finitely many points @xmath513 , such that @xmath8 leaves the set @xmath514 invariant .",
    "the line - convex hull of these subspaces defines a finite dimensional affine subspace @xmath274 of @xmath402 , and the group @xmath515 leaves this space invariant and operates affinely on @xmath274 , i.e. maps lines to lines .",
    "since @xmath515 also maps parallels of @xmath512 to parallels of @xmath512 , @xmath515 also operates affinely on the quotient space @xmath516 , and has on that space a finite orbit @xmath517,\\ldots,[x_k]$ ] .",
    "therefore this operation has a fixed point @xmath518 $ ] which is contained in the line - convex hull of @xmath517,\\ldots,[x_k]$ ] .",
    "this implies that there exists an affine subspace @xmath519 parallel to @xmath520 which is @xmath515-invariant and which is contained in the line - convex hull of @xmath514 .",
    "thus @xmath519 is in the image of @xmath414 .",
    "let @xmath521 .",
    "then @xmath522 is a nonempty convex @xmath8-invariant subset , and hence @xmath480 by our additional assumption .",
    "it follows that for all @xmath3 , @xmath523 and by dimension reasons @xmath524 .",
    "it follows that @xmath525 , which proves the lemma .    thus we see that @xmath424 is a @xmath8-equivariant rough isometry . by lemma [ lem :",
    "ce ] @xmath416 is a normed vector space which is rough isometric to the ptolemy space @xmath0 . by the corollary [ cor : corschoenberg ] to schoenbergs result",
    ", we see that @xmath416 is an inner product space and hence we obtain theorem [ thm : cryst ] .      let @xmath8 be a virtual polycyclic group .",
    "let @xmath526 be a polycyclic subgroup of finite index . by a theorem of hirsch",
    "( see e.g. @xcite p.139 ) , @xmath527 contains a torsion free solvable subgroup @xmath528 of finite index",
    ". then also @xmath528 operates cocompactly on @xmath0 and by theorem [ thm : straight ] all abelian subgroups of @xmath528 are straight .",
    "note further that all abelian subgroups of @xmath528 are finitely generated , since @xmath527 is polycyclic .",
    "now a torsion free solvable group , such that all abelian subgroups are finitely generated and straight is a crystallographic group by @xcite lemma 4.3 .",
    "thus @xmath528 and hence also @xmath8 contains a free abelian subgroup @xmath529 of finite index and finite rank .",
    "it follows that @xmath8 has also a normal free abelian subgroup @xmath56 of finite index and finite rank .",
    "but this fact is the only property of @xmath8 which we needed in the proof of theorems [ thm : cryst ] and [ thm : manifold ] .",
    "* open question * : let @xmath8 be a crystallographic group operating properly and cocompactly on a geodesic ptolemy space @xmath0 .",
    "does there exist a totally geodesic flat euclidean subspace @xmath530 which is @xmath8-invariant ?",
    "thomas foertsch,10em= viktor schroeder , + mathematisches institut , institut fr mathematik , + universitt bonn , universitt zrich , + beringstr .",
    "1 , winterthurer strasse 190 , + d-53115 bonn , deutschland ch-8057 zrich , switzerland + foertsch@math.uni-bonn.de +"
  ],
  "abstract_text": [
    "<S> in this paper we study geodesic ptolemy metric spaces @xmath0 which allow proper and cocompact isometric actions of crystallographic or , more generally , virtual polycyclic groups . </S>",
    "<S> we show that @xmath0 is equivariantly rough isometric to a euclidean space . </S>"
  ]
}