{
  "article_text": [
    "the mass distribution of collapsed dark matter clumps ( called mass function ) is one of the most important pieces of information one wants to obtain from a cosmological model .",
    "these clumps are the sites where the most important astrophysical events take place ; they are associated to proto - galactic halos , and to galaxy groups and clusters .",
    "unfortunately , non - linear gravitational collapse is an unsolved problem in the general case , and the only way to get a fair estimate of the mass function is through n - body simulations or through ( semi- ) analytical approximations .    the first approximation to the cosmological mass function was proposed  by doroshkevich ( 1967 ) , and later by press & schechter ( 1974 ; hereafter ps ) . the ps `` numerical recipe '' ( as recently referred to by efstathiou )",
    "can be summarized as follows :    1 .",
    "take the initial density field , at a very early time , and smooth it on the scale @xmath0 , such that the variance of the field is @xmath1 ; we ca nt work with power at very small scales , which becomes non - linear very early .",
    "2 .   follow the linear evolution of the density field : the density in each point is rescaled by the same time - dependent function @xmath2 , the linear growing mode .",
    "3 .   if the linearly evolved density gets as large as a threshold @xmath3 , then the density in those points has gone non - linear ! in other terms , it has collapsed .",
    "compute the fraction of collapsed mass @xmath4 as the probability that the linearly evolved density is larger than the threshold @xmath5 .",
    "underdensities ( 1/2 of mass with gaussian statistics ) in linear theory get more and more underdense , so no wonder that only 50% of mass is able to collapse ; to achieve the correct normalization , multiply the result by two , and do nt ask why !",
    "if the field is smoothed at a scale @xmath0 , it is quite reasonable to assume that a typical mass @xmath6 will form ( @xmath7 is the comoving average mass density ) . then the mass function @xmath8 is computed through the following `` golden rule '' ( as referred to by cavaliere ) : + @xmath9    despite its weaknesses , the ps numerical recipe works much better than expected .",
    "governato et al .",
    "( 1998 ) give the most recent comparison of the ps formula to large numerical simulations : the ps is a good approximation of the n - body curves ( found with different clump - finding algorithms ) , for masses similar to or larger than the typical mass @xmath10 which forms at a given redshift .",
    "the @xmath5 parameter is not very different from the value 1.69 guessed by the spherical collapse model , except that it tends to get as small as 1.5 at @xmath11 ( for a standard cdm model ) .",
    "the ps did not receive much attention until 1988 , when the first `` large '' n - body simulations of efstathiou et al .",
    "( 1988 ) and carlberg & couchman ( 1989 ) showed a good agreement with it .",
    "the mystery of the `` fudge factor '' of 2 was solved by peacock & heavens ( 1990 ) and bond et al .",
    "( 1991 ) , who approached the `` cloud - in - cloud '' problem in a rigorous way ( small structures can be included in larger collapsing ones , even though their density is not larger than the threshold , and taking this into account increases the total fraction of collapsed mass to 1 ) .",
    "it was again a surprise to see that the ps formula , including the factor of 2 , is exactly recovered if the linear density field is smoothed with a sharp filter in the @xmath12-space .",
    "the history of the mass function theory is reviewed in monaco ( 1998 ) , but it can be effectively summarized in a sentence : there is a simple , effective and wrong way to describe the cosmological mass function .",
    "wrong of course does not refer to the results but to the whole procedure .",
    "once the `` statistical '' problem of achieving the correct normalization is solved , the worst defect of the ps recipe is that it completely neglects the complexities of gravitational dynamics , which is treated just at the linear level .",
    "the lagrangian picture of fluid dynamics turns out to be an ideal frame in which to develop a semi - analytical theory for the mass function , able to go beyond linear theory and spherical collapse . before going on ,",
    "it is appropriate to criticize the use of spherical collapse in cosmology , for a number of reasons :    1 .   with spherical symmetry the collapse is clearly identified with the formation of a singularity . in the more general case ,",
    "the definition of collapse is quite tricky , as we are going to show in the following .",
    "2 .   virialization is assumed to have taken place immediately after collapse .",
    "this neglects the many complicated transients which dominate structures like galaxy clusters .",
    "further accretion is spherical . in the real case accretion",
    "comes preferentially from the filamentary network .",
    "the construction of a `` dynamical '' mass function is described in detail in monaco ( 1995 ; 1997a , b ) and reviewed in monaco ( 1998 ) .",
    "the dynamics of gravitational collapse is described though the powerful lagrangian perturbation theory , truncated to third order ( which is necessary to describe collapse , as the second order truncation gives wrong results in underdensities ) .",
    "it is useful to recall that the first term in the perturbation series is the zeldovich ( 1970 ) approximation .",
    "if the infinitesimal mass element is described as a homogeneous ellipsoid , then ellipsoidal collapse turns out to be a useful truncation of the lagrangian series .    in the general case in which no symmetry is imposed to the initial density field",
    ", the definition of collapse itself is tricky .",
    "there is a natural way to define collapse , and it is when orbits start to cross each other ( orbit crossing , hereafter oc ) .",
    "the typical pancake collapse takes place at oc ; this means infinite density , infinite shear , shock waves in a subdominant baryon component , and , last but not least , no reliable solution after it ! then , as long as structures are searched for as high - density clumps , this definition makes sense ; moreover , it marks the onset of multi - stream , highly non - linear dynamics and of shock - heating of gas .",
    "however , it might be argued that oc is too generous in mixing `` real clumps '' , as galaxy clusters , with the filamentary network existent outside clusters .",
    "if the mass element is modeled as an ellipsoid , then oc corresponds to the collapse on its first axis . as proposed for instance by lee & shandarin ( 1997 )",
    ", one might extrapolate the lagrangian series so as to wait for the collapse of the element on the third axis , and then get the mass function of fully virialized clumps .",
    "the difference between the two collapse definitions ( oc and third - axis collapse ) is well illustrated in the following example .",
    "consider a spherical peak in a homogeneous universe , the profile of which is not a simple top - hat but decreases from the center .",
    "while the central mass element collapses in a spherical way , all the other mass elements are subject to axial symmetry , so that their typical collapse is of the spindle kind : two axes collapse , the third one does not collapse at all . in the meantime",
    "each shell collapses in a perfectly spherical way . as a consequence , while the oc criterion selects all the collapsed mass elements , just one mass element collapses on the third axis .",
    "then , the total mass of the spherically collapsing clump , according to the collapse definition based on third - axis collapse , is embarrassingly vanishing .",
    "this example highlights two important facts : ( i ) the local geometry of collapse is different from the global one ; ( ii ) third - axis collapse is good for picking the seeds of collapsed structures , but not for obtaining their total mass , while oc can get the correct normalization , but mixes virialized clumps with filamentary transients .",
    "the second conclusion is confirmed by the fact that lee & shandarin ( 1997 ) need a fudge factor of 12.5 to achieve a good normalization for their mass function .",
    "another limit of the oc definition is the following .",
    "1 shows a 1d sketch of a collapsing structure ; @xmath13 is the initial position of a particle ( the _ lagrangian _ coordinate ) and @xmath14 is its final position ( the _ eulerian coordinate _ ) .",
    "the triple valued region in the @xmath15 relation constitutes the whole multi - stream region , but the oc condition is able to select just the zones with negative slope in the @xmath15 relation . in other words , the oc condition misses the mass which is actually infalling on the structure , picking it only after its first crossing of the structure .",
    "this problem somehow compensates for the excessive generosity of oc in finding the collapsed mass : it just singles out matter which has had some time to relax ! note also that this problem is not present in the adhesion model , in which the caustics have an infinitesimal width : it is connected to the finite size of caustics .",
    "once collapse is defined , one can compute directly from initial conditions the collapse time of each mass element .",
    "it is convenient to express time in terms of the linear growing mode @xmath2 , ( to factorize out the dependence on cosmology ) , and to define the following quantity :    @xmath16    where @xmath17 is the collapse `` time '' for the element @xmath13 . in the linear theory case , @xmath18 .",
    "note that , being @xmath19 ( the inverse of ) a time , any threshold @xmath20 is just given by the inverse time at which the mass function is wanted .",
    "there are no free parameters in this theory .",
    "the @xmath21 function depends also on the smoothing radius used for the smoothing . to calculate the mass function with the correct normalization , it is possible to extend the `` excursion set approach '' of bond et al .",
    "( 1991 ) to the case of the non - gaussian @xmath19 process , smoothed with a sharp @xmath12-space filter .",
    "the case of gaussian smoothing is treated as in peacock & heavens ( 1990 ) .",
    "note that a ps - like approach ( monaco 1995 ) , with no fudge factor , is enough to obtain a fair estimate of the mass function , as the fraction of points which will never collapse is not 50% , as in linear theory , but it is smaller than 8% .",
    "the shape of the filter should be chosen so as to optimize the dynamical predictions ; the gaussian filter is usually suggested .",
    "it is very interesting to see that the dynamical mass function gives meaningful results only in the case of gaussian smoothing . in particular",
    ", it is very similar to a ps curve with a @xmath5 parameter about 1.5 , smaller than the spherical 1.69 value .",
    "this is explained by the fact that the spherical collapse neglects tidal forces , which are able to speed up the collapse , thus forming larger objects .",
    "2 shows a comparison of the dynamical mass function ( with gaussian smoothing ) with the simulations of governato et al .",
    "( 1998 ) ; the left panel shows the results for a flat einstein - de sitter universe ( standard cdm , @xmath22 ) , at redshift @xmath23 , 1.13 , 0.43 and 0 , while the right panel shows the results for an open universe ( @xmath24 , @xmath25 , no cosmological constant ) , at redshift @xmath11 , 0.58 , and 0 .",
    "groups are found with the standard friends - of - friends algorithm , with linking - length 0.2 ( corrected in the open case as described in the paper ) ; the authors have verified that the use of other clump - finding algorithms does not change much the results .",
    "the n - body mass functions are compared with the standard ps prediction ( with @xmath26 ) and with the dynamical mass function , using ellipsoidal collapse .",
    "it must be noted that the 3rd - order prediction is known to underestimate the number of large - mass objects ( monaco 1997a ) : in this range the ellipsoidal prediction performs better .    despite the absence of free parameters to tune",
    ", the dynamical mass function fits the n - body results remarkably well in the einstein - de sitter case : the agreement is improved with respect to the ps formula , with the possible exception of the @xmath27 mass function which is slightly overestimated , while the @xmath23 mass function is underestimated in the highest - mass tail .",
    "the trend of the best - fit @xmath28 with redshift is not reproduced at this stage . on the other hand ,",
    "the ps formula describes well the results of the open simulation , better than the dynamical mass function .",
    "note also that the sharp @xmath12-space predictions lie more than a factor two above the gaussian curves : at variance with the ps theory , the sharp @xmath12-space filter does not seem a good choice in this context .",
    "another conclusion of the dynamical mass function theory is that the small - mass tail can not be predicted in a robust way .",
    "many factors hamper a reliable prediction of small - mass clumps ; most importantly , the lagrangian perturbation theory does not converge to a solution , and any error in the definition of large masses strongly influences the number of small - mass objects .",
    "once the mass function theory is founded on a solid dynamical basis , it is worth investigating in some detail the geometrical problem of going beyond the `` golden rule '' ( eq.[eq : ps ] ) . in other words ,",
    "we want to obtain the distribution of the masses @xmath29 of the objects which form at a given smoothing radius @xmath0 , so as to relate the fraction of collapsed mass to the mass function in a rigorous way .",
    "it is very useful to consider this problem first in 1d .",
    "monaco & murante ( 1998 ) have solved the mass function problem in 1d in all its details ; this is a very instructing game , which gives many precious hints on how to face the more complex 3d problem .",
    "it is useful to construct a function @xmath30 , which gives , for each point @xmath13 in the lagrangian space the largest smoothing radius @xmath31 at which the point is predicted to collapse within a fixed time @xmath32 .",
    "3 shows some examples of these curve , in the case of a white noise power spectrum .",
    "both the predictions based on gaussian and sharp @xmath12-space filters are shown .",
    "`` objects '' can be easily associated to connected segments of collapsed points ; the objects present at a given radius @xmath0 are then given by the intersection of the @xmath30 curve with a line of constant @xmath0 .",
    "note also that , being @xmath31 the _ largest _ smoothing radius at which collapse takes place , the collapsed regions are already corrected for the cloud - in - cloud problem .",
    "it is important to note that , when @xmath0 is decreased , the collapsed objects show a typical behaviour : their mass ( = length ) starts growing , and then saturates to a certain value , remaining approximately stable for a significant range in @xmath0 .",
    "this stabilization is remarkable , and necessary in order to define the mass of an object in any meaningful way .    under the hypothesis that the objects follow a well defined average growing curve @xmath33 ,",
    "it is possible to connect the fraction of collapsed mass with the abundance of objects of mass @xmath29 in the following way :    @xmath34    with some algebra it is possible to write eq .",
    "( [ eq : deconv ] ) in the form of a convolution of the mass function with the differential growing curve .",
    "4 shows the cumulative and differential growing curves in the gaussian and sharp @xmath12-space cases ( both @xmath29 and @xmath0 are expressed in terms of the variance @xmath35 ) ; while the shar @xmath12-space curves are not particularly nice , the gaussian differential curve shows one pronounced and narrow peak .",
    "it is easy to see that the golden rule corresponds to a heavyside @xmath36 function for the growing curve , or a dirac @xmath37 function for the differential one ; in other words , the golden rule corresponds to approximating the peaks shown in fig .",
    "3 with many rectangles , the height ( @xmath0 ) and width ( @xmath29 ) of which are related . in the realistic case of a non-@xmath37 differential growing curve",
    ", the mass function must be deconvolved from it .",
    "however , for most practical purposes the mean value of the differential growing curve is enough : the golden rule strikes back ! even though this average value could be different from that inferred from the mass of the filter , and could depend on the power spectrum .",
    "such a dependence of the average mass on the power spectrum is probably at the origin of the observed decrease of @xmath5 with redshift in cdm universes ( governato et al .",
    "the slope of the power spectrum , at the scale corresponding to the onset of non - linearity , gets smaller ( and negative ) at higher redshift , which means that the smoothed density field gets more correlated .",
    "it is then quite natural to expect larger masses , i.e. a decrease of @xmath5 , at higher redshift .",
    "the 1d problem is also a good starting point for performing a detailed comparison of the mass function theory with simulations .",
    "note also that in 1d linear theory ( with @xmath38 ) and zeldovich approximation are equivalent , and moreover they are an exact solution up to oc .",
    "what is predicted by the theory is not the mass function of `` virialized '' structures ( the word `` virialized '' is widely misused in cosmology : we do nt understand the physical processes which lead to virialization , and then we do nt know how to quantify them ) , nor is it the mass function of halos found with the friends - of - friends or whatever algorithm .",
    "the predictions refer to regions which are in oc .",
    "it is then useful to find oc regions directly in the simulations , and to compare them to the theoretical predictions ; in a second time , the relation between such oc regions and groups , as found by some clump - finding algorithm , can be investigated .",
    "oc regions in the simulations are found by smoothing the @xmath15 map ( the final positions of particles as a function of their initial positions ) in the lagrangian space , then considering all the points with negative slope as collapsed .",
    "the oc is then scale - dependent ; one can construct the @xmath30 curve also in this case , and compare it with the predicted one . from oc , it is possible to reconstruct the whole multi - stream ( ms ) regions , as the multi - valued regions in the @xmath15 relation .",
    "the @xmath31 curves for the oc and ms regions are shown in fig .",
    "3 , together with the predicted ones .",
    "it can be concluded that    1 .",
    "the oc @xmath31 curve is well reproduced by the gaussian curve .",
    "the sharp @xmath12-space curve is remarkably different both from the gaussian and from the oc curve ; then , gaussian smoothing is definitely preferred .",
    "remarkably , the sharp @xmath12-space curve is similar to the ms curve .",
    "it is possible to extend this analysis to 3d .",
    "this has been done with a test p@xmath39 m simulation with @xmath40 particles on a @xmath40 grid . in this case",
    "the oc regions are found by smoothing the vector field @xmath41 , obtained from the output of the n - body simulation , in the lagrangian space , then calculating the jacobian determinant @xmath42 in each point ; the points with negative jacobian determinant are in oc .",
    "the curves @xmath43 are then constructed .",
    "5 shows the contour level of two @xmath31 curves , evaluated on a plane cut of the simulation box .",
    "the @xmath31 curves refer to the prediction of ellipsoidal collapse and to the oc in the simulation .",
    "ellipsoidal collapse is able to reproduce the oc regions in simulations fairly well . on the other hand ,",
    "linear theory ( not shown)turns out to be not bad in predicting the largest structures , but misses completely the connected network , which gives origin to small - scale objects ( we are using gaussian smoothing , in which case the linear theory prediction is known to underestimate the mass function ) .",
    "as in the 1d case , the 3d @xmath31 curves tend to be , at large smoothing radii , a collection of isolated and simply connected regions , the mass of which saturates as @xmath0 decreases .",
    "it is then possible to construct an average growing curve for them , which can then be used to solve the geometrical problem described above .",
    "however , when the variance becomes comparable to one , the collapsed regions become multiply connected in a very messy way . as a consequence , at variance with the 1d case",
    ", there is no obvious way to define the mass of structures ; in other words , it is not straightforward to construct an algorithm to fragment the collapsed medium into `` structures '' .",
    "we are currently trying to find reliable fragmentation algorithms ; the goodness of a fragmentation algorithm can be decided by seeing how well it reproduces the structures found in some other way .",
    "for instance , one could construct a fragmentation algorithm able to reproduce the friends - of - friends halos , but then another algorithm will be needed to reproduce , e.g. , the denmax halos , which are slightly different .",
    "moreover , every clump - finding algorithm is parametric ( e.g. , in the friends - of - friends algorithm the linking length must be fixed ) , and the results depend on the actual value used for the parameters .",
    "there is no univocal way to find halos in simulations , and there is no univocal way to fragment the collapsed medium into structures . as a consequence , there is no univocal way to define the mass function !",
    "the only well - defined quantities are the @xmath31 curve shown in figs . 3 and 5 .",
    "luckily , this `` nihilist '' position is exaggerated from a practical point of view : the largest structures are recovered more or less in a similar way by different clump - finding algorithms , and the problem comes as usual from the small - mass clumps , which come from the multiply - connected medium ( and from the left - overs of the largest structures ) . anyway , this implicit uncertainty must be considered when judging , for instance , the agreement of a mass function theory with a friends - of - friends curve , as that shown in fig .",
    "the dynamical mass function theory is currently been analyzed and applied to many interesting problems .",
    "the comparison to 3d simulations will be soon performed with the large ( @xmath44 points ) simulations already used by governato et al .",
    "( 1998 ) .    once a reliable fragmentation algorithm is found , it can be used to generate large catalogues of objects .",
    "the semi - analytical predictions can be extended to the spin and merging history of objects : the spin is acquired from tidal torques during the mildly non - linear evolution ( catelan & theuns 1996 ) , while merging histories are found through the excursion set approach ( lacey & cole 1993 ) , even though the role of the filter in this case must be clarified .",
    "this can have some definite advantages with respect to the standard n - body simulations , as the semi - analytical calculations are much , much faster .",
    "it can be used , for instance , to simulate halos in deep pencil beams , or to find galactic halos in hubble volume - sized realizations .",
    "none of the problems presented in this paper have been considered by ps ; nonetheless , their formula appears to work quite well .",
    "table 1 contains some of the elements which should be taken into account to construct a fully rigorous theory for the mass function ; it is indicated how these element influence the large mass tail of the mass function .",
    "we have seen that non - linear ( and non - spherical ) dynamics gives an increase of large mass objects because of tidal forces .",
    "but the ps is based on sharp @xmath12-space smoothing , while gaussian smoothing is preferred ; this leads to a decrease of large - mass objects . on the other hand , oc neglects the matter infalling on the structure , which is already in multi - stream regime ; taking this into account increases the mass of objects .",
    "but oc mixes `` virialized '' clumps with filaments ; taking them out of the game would of course decrease the mass of objects .",
    "the deconvolution procedure described in section 3 would generally decrease the number of large mass objects , because of the width of the differential growing curve .",
    "add to this the rather unpredictable value of the average @xmath45 relation .",
    "in practice , the ps numerical recipe is the simplest way to construct a mass function from the gaussian statistics of the initial density .",
    "it is as if some kind of `` central limit theorem '' were in act : the ps works because it neglects so many things that they all tend to compensate each other ! especially if some free parameter can be tuned to obtain good fits to numerical simulations .",
    "the author thanks paolo catelan , alfonso cavaliere , george efstathiou , giuseppe murante , sergei shandarin and tom theuns for many discussions , and fabio governato for kindly providing the object catalogues taken from his simulations .",
    "bond , j.r . ,",
    "cole , s. , efstathiou , g. , kaiser , n. 1991 , apj , 379 , 440 carlberg , r.g . , couchman , h.m.p .",
    "1989 , apj , 340 , 47 catelan , p. , theuns , t. 1996 , mnras , 282 , 436 doroshkevich , a.g . 1967 ,",
    "astrofizika , 3 , 175 efstathiou , g. , frenk , c.s . ,",
    "white , s.d.m . ,",
    "davis , m. 1988 , mnras , 235 , 715 governato , f. , babul , a. , quinn , t. , tozzi , p. , baugh , c.m . , katz , n. , lake , g. 1998 , submitted to mnras , preprint astro - ph/9810189 lacey , c. , cole , s. 1993 , mnras , 262 , 627 lee , j. , shandarin , s. apj , 500 , 14 monaco , p. 1995",
    ", apj , 447 , 23 monaco , p. 1997a ,",
    "mnras , monaco , p. 1997b",
    ", mnras , monaco , p. 1998",
    ", 19 , 153 monaco , p. , murante , g. , 1998 , in preparation peacock , j.a . , heavens , a.f .",
    "1990 , mnras , 243 , 133 press , w.h . , schechter ,",
    "p. 1974 , apj , 187 , 425 ( ps ) zeldovich , ya.b .",
    "1970 , astrofizika , 6 , 319"
  ],
  "abstract_text": [
    "<S> the press & schechter `` numerical recipe '' is briefly reviewed , together with the recently proposed dynamical mass function theory , in which the mass function is constructed by using the powerful lagrangian perturbation theory . </S>",
    "<S> the dynamical mass function is found in good agreement with the recent n - body simulations of governato et al . </S>",
    "<S> ( 1998 ) , in the case of an einstein - de sitter universe . the definition of collapse , the relation between mass and smoothing radius , and the definition of structure in 1d universes are discussed . </S>",
    "<S> a detailed comparison of the dynamical mass function to simulations reveals that the orbit - crossed regions in the simulation are correctly reproduced , while the fragmentation of the collapsed medium into structures can not be done in a univocal way . </S>",
    "<S> finally , we try to answer the question : why the hell does the press & schechter work ? </S>"
  ]
}