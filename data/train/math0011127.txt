{
  "article_text": [
    "let @xmath5 and @xmath6 be two permutations .",
    "an _ occurrence _ of @xmath7 in @xmath8 is a subsequence @xmath9 such that @xmath10 and @xmath11 is order - isomorphic to @xmath7 ; in such a context @xmath7 is usually called a _ pattern_.",
    "we say that @xmath8 _ avoids _",
    "@xmath7 , or is @xmath7-_avoiding _ , if there is no occurrence of @xmath7 in @xmath8 .",
    "for example , let @xmath12 , and @xmath13 , @xmath14 , @xmath15 .",
    "then it is easy to see that @xmath8 avoids @xmath16 , contains exactly one occurrence of @xmath17 , namely , @xmath18 , and contains six occurrences of @xmath19 , which are @xmath20 , @xmath21 , @xmath22 , @xmath23 , @xmath24 , @xmath25 .",
    "the set of all @xmath7-avoiding permutations in @xmath0 is denoted @xmath26 . for an arbitrary finite collection of patterns @xmath27",
    ", we say that @xmath8 avoids @xmath27 if @xmath8 avoids any @xmath28 ; the corresponding subset of @xmath0 is denoted @xmath29 .",
    "by @xmath30 and @xmath31 we denote the corresponding ( ordinary ) generating functions @xmath32 and @xmath33 .",
    "the following simple symmetry arguments allow to decrease the variety of different @xmath27 s to be considered .",
    "define the _ reversal _ and the _ complementation _ operations as follows : @xmath34 , @xmath35 .",
    "it is easy to see that the following four statements are equivalent :    \\(i ) @xmath8 avoids @xmath7 ;    \\(ii ) @xmath36 avoids @xmath37 ;    \\(iii ) @xmath38 avoids @xmath39 ;    \\(iv ) @xmath40 avoids @xmath41",
    ".    more generally , denote by @xmath42 the group of transformations generated by @xmath43 , @xmath44 , and the usual group inverse operation ( it is easy to see that @xmath42 is isomorphic to the dihedral group @xmath45 ) . the for any @xmath46 one has @xmath47 .",
    "the first paper devoted entirely to the study of permutations avoiding certain patterns ( _ restricted permutations _ ) appeared in 1985 ( see @xcite ) .",
    "currently there exist more than fifty papers on this subject .",
    "_ chebyshev polynomials of the second kind _",
    "( in what follows just chebyshev polynomials ) are defined by @xmath48 for @xmath49 .",
    "evidently , @xmath50 is a polynomial of degree @xmath43 in @xmath51 with integer coefficients .",
    "for example , @xmath52 , @xmath53 , @xmath54 , and in general , @xmath55 .",
    "chebyshev polynomials were invented for the needs of approximation theory , but are also widely used in various other branches of mathematics , including algebra , combinatorics , and number theory ( see @xcite ) .    for @xmath56",
    "we define @xmath57 by @xmath58 for example , @xmath59 , @xmath60 , and @xmath61 .",
    "it is easy to see that for any @xmath62 , @xmath57 is rational in @xmath51 .",
    "these rational functions arise in some of the results below .      apparently , for the first time the relation between restricted permutations and chebyshev polynomials was discovered by chow and west in @xcite .",
    "the main result of @xcite can be formulated as follows .",
    "[ tcw ] ( ( * ? ? ?",
    "3.1 ) ) let @xmath63 , @xmath64 @xmath65 , and @xmath66 , then :    \\(i ) @xmath67    \\(ii ) @xmath68    \\(iii ) @xmath69 .    the original proof is based on the use of transfer matrices ( see sec .  2 below ) . several different proofs of various parts of this theorem appeared recently in ( * ?",
    "9 ) ( part ( i ) ) , ( * ? ?",
    "3.1 ) and ( * ? ?",
    "2 ) ( part ( ii ) ) , and ( * ? ? ?",
    "6 ) ( part ( iii ) ) .",
    "they all are based on the use of continued fractions ; the latter approach to restricted permutations was initiated in @xcite and developed in @xcite .",
    "in fact , there are two different ways to use continued fractions .",
    "one of them is more geometrical , and is based on the relation between continued fractions and dyck paths discovered by flajolet ( see sec .  3 below ) .",
    "another is more analytical , and is based on the study of block decompositions ( see sec .  4 below ) .",
    "in this paper we describe these three approaches , and present several ways to extend and generalize the above result .",
    "all our results deal with multiple ( mainly , double ) restrictions , of which one belongs to @xmath1 and others to @xmath2 .",
    "some of the results have been published previously , and we state them here without a proof .",
    "observe that modulo standard symmetry operations ( complement , reversal , and inversion ) , there are only two nonequivalent patterns in @xmath1 ; we choose them to be @xmath70 and @xmath71 .",
    "for the sake of brevity , we denote by @xmath72 $ ] the identity pattern @xmath73 , and by @xmath74 $ ] the _ two - layered _ pattern @xmath75 .",
    "in general , we say that @xmath76 is a _ layered _ pattern if it can be represented as @xmath77 , where each of @xmath78 is a nonempty permutation of the form @xmath79 with @xmath80 ; in this case we denote @xmath7 by @xmath81 $ ] .",
    "observe that our definition slightly differs from the one used in @xcite : their layered patterns are exactly the complements of our layered patterns .",
    "the authors are grateful to c.  krattenthaler and to an anonymous referee for valuable comments that helped us to improve the presentation .",
    "the main idea behind the transfer matrix approach can be described as follows ( see ( * ? ? ?",
    ".  4.7.2 ) ) . consider a directed multigraph on @xmath82 vertices @xmath83 , and let @xmath84 denote its weighted adjacency matrix , that is , @xmath85 is the number of edges directed from @xmath86 to @xmath87 .",
    "then the generating function for the number of walks from @xmath88 to @xmath89 is given by @xmath90 where @xmath91 is the identity matrix and @xmath92 is the minor of @xmath93 with the @xmath43th row and @xmath94th column deleted .    to apply this approach",
    ", one has to construct a bijection between the permutations in question and walks in an appropriate directed graph .",
    "we describe below two bijections of this type : the first based on generating trees , and the second based on dyck paths .      following @xcite , a",
    "_ generating tree _ is a rooted labeled tree with the property that if @xmath95 and @xmath96 are any two nodes with the same label and @xmath97 is any label , then @xmath95 and @xmath96 have exactly the same number of children with the label @xmath97 . to specify a generating tree it therefore suffices to specify :    1 .",
    "the label of the root , and 2 .   a set of succession rules explaining how to derive from the label of a parent the labels of all of its children .    [ aex1 ] ( the complete binary tree ) since all the nodes in the complete binary tree are similar , it is enough to use only one label , which we choose to be @xmath98 .",
    "so we get the following description :    * * root * : @xmath99 * * rule * : @xmath100 .    [ aex2 ] ( the fibonacci tree ) here we have nodes of two different types , so we use two labels : @xmath101 for a non - breeding pair and @xmath98 for a breeding pair .",
    "we thus get :    * * root * : @xmath102 * * rules * : @xmath103,@xmath104    given a generating tree , one assigns to it a directed graph whose vertices correspond to labels and edges from @xmath105 to @xmath106 correspond to the occurrences of @xmath106 in the succession rule @xmath107 .",
    "the graphs corresponding to the above two examples are shown in figure @xmath101 .",
    "= 2.5 in    given a permutation @xmath7 , one defines a rooted tree as follows .",
    "the nodes on level @xmath82 are precisely the elements of @xmath26 .",
    "the parent of a permutation @xmath108 is the unique permutation @xmath109 such that @xmath110 .",
    "we denote the resulting tree @xmath111 .",
    "similarly , the tree corresponding to the set @xmath29 is denoted by @xmath112 .",
    "chow and west @xcite proved that the succession rules for the tree @xmath113 are @xmath114 ( k-1)\\rightarrow(2)\\cdots(k-1)(k-1 ) , & \\end{array}\\ ] ] and the label of the root is @xmath99 . the corresponding graph is shown in figure @xmath98 .",
    "= 2.5 in    the corresponding transfer matrix is @xmath115\\ ] ] besides , chow and west proved that the graphs , and hence the transfer matrices for @xmath116 and @xmath117 are exactly the same ( though the succession rules may vary ) .",
    "the number of permutations in @xmath29 ( in all cases ) is thus equal to the number of walks of length @xmath82 starting from the vertex @xmath98 .",
    "however , since each vertex is connected to vertex @xmath98 by exactly one edge , this number is equal to the number of walks of length @xmath118 starting at vertex @xmath98 and ending at the same vertex .",
    "the generating function for this number is given by @xmath119 with @xmath120 .",
    "it is proved in @xcite that the determinants in question satisfy linear recurrences of order two very similar to that for chebyshev polynomials , which almost immediately yields theorem [ tcw ] , since @xmath121 , @xmath122 , and @xmath123 .",
    "a _ dyck path _ is a path in the plane integer lattice @xmath124 , consisting of up - steps @xmath125 and down - steps @xmath126 , which never passes below the @xmath51-axis .",
    "following @xcite , we define a bijection @xmath127 between permutations in @xmath128 and dyck paths from the origin to the point @xmath129 .",
    "let @xmath130 be a @xmath70-avoiding permutation .",
    "we read the permutation @xmath8 from left to right and successively generate a dyck path .",
    "when @xmath131 is read , then in the path we adjoint as many up - steps as necessary , followed by a down - step from height @xmath132 to height @xmath133 ( measured from the @xmath51-axis ) , where @xmath133 is the number of elements in @xmath134 which are larger that @xmath131 .    for example",
    ", let @xmath135 .",
    "the first element to be read is @xmath136 .",
    "there is one element in @xmath137 which is larger than @xmath136 , therefore the path starts with two up - steps followed by a down - step , thus reaching height @xmath101 .",
    "next @xmath138 is read .",
    "there are @xmath98 elements in @xmath139 which are larger than @xmath138 , therefore the path continues with two up - steps followed by a down - step , thus reaching height @xmath98 .",
    "conversely , given a dyck path starting at the origin and returning to the @xmath51-axis , the obvious inverse of the bijection @xmath127 produces a @xmath70-avoiding permutation .",
    "it is proved in @xcite that the bijection @xmath127 takes permutation in @xmath140)$ ] to dyck paths that never pass above the line @xmath141 .",
    "evidently , such paths correspond bijectively to walks of length @xmath142 starting at vertex @xmath143 in the graph shown in figure @xmath138 .",
    "= 2.5 in    using again @xmath119 one gets theorem [ tcw](ii ) . a further study of the bijection @xmath127 yields part @xmath144 of the same theorem .",
    "the relation between restricted permutations and continued fractions was discovered by robertson , wilf , and zeilberger in @xcite .",
    "the main result in @xcite can be formulated as follows .",
    "let @xmath145 be the generating function for the number of permutations in @xmath128 containing a pattern @xmath7 exactly @xmath43 times .",
    "( robertson , wilf , and zeilberger ( * ? ? ?",
    "1))[thrwz ] @xmath146 in which the @xmath147th numerator is @xmath148 .    to prove this ,",
    "let @xmath8 be a permutation avoiding @xmath70 .",
    "then each letter in @xmath8 to the left of @xmath82 must be greater than any letter to the right of @xmath82 . thus , if @xmath149 ( where both @xmath11 and @xmath150 must necessarily be @xmath70-avoiding ) , then @xmath151 where @xmath152 is the number of occurrences of @xmath7 in @xmath8 .",
    "it follows that the generating function @xmath153 satisfies the equation @xmath154 .",
    "equivalently , @xmath155 and the theorem follows by induction after plugging in @xmath156 .",
    "+ this result was generalized by mansour and vainshtein @xcite , by krattenthaler @xcite , and by jani and rieper @xcite to the case of permutations containing the pattern @xmath72=12\\dots k$ ] exactly @xmath43 times .",
    "it turns out that @xmath157}^r(x)z^r = \\frac1{1-\\dfrac{xz^{d_1}}{1-\\dfrac{xz^{d_2}}{1-\\dfrac{xz^{d_3}}{\\dots } } } } , \\eqno(3.1)\\ ] ] where @xmath158 .",
    "+ the proof in @xcite is a straightforward generalization of the above proof of theorem [ thrwz ] .",
    "the proof in @xcite is based on the bijection @xmath127 between @xmath70-avoiding permutations and dyck paths described in the previous section and on the result of flajolet ( * ? ? ?",
    "1 ) presenting the generating function for the dyck paths in terms of continued fractions .",
    "the proof of @xcite is based on a bijection between @xmath70-avoiding permutations and rooted ordered trees , which can be obtained from the bijection @xmath127 via the standard bijection between rooted ordered trees and dyck paths through a depth - first traversal of the trees ( see ( * ? ? ? * prop .  6.2.1 , cor .",
    "6.2.3 ) ) .",
    "for further generalizations and interesting combinatorial applications see @xcite .",
    "it was observed in @xcite that @xmath57 is the @xmath62th approximant for the continued fraction @xmath159 so @xmath160 for @xmath161 immediately gives theorem [ tcw](ii ) .",
    "paper @xcite contains the description of a bijection @xmath162 between @xmath163-avoiding permutations and dyck paths .",
    "this bijection , combined with roblet and viennot s continued fraction representation of the generating function for dyck paths ( * ? ? ? * prop .  1 )",
    "gives the first part of theorem [ tcw ] .",
    "the core of this approach initiated by mansour and vainshtein @xcite lies in the study of the structure of @xmath70-avoiding permutations , and permutations containing a given number of occurrences of @xmath70 .",
    "let us start with the simplest case of @xmath70-avoiding permutations .",
    "it was noticed in @xcite that if @xmath164 and @xmath165 , then @xmath166 where @xmath167 is a permutation of the numbers @xmath168 , @xmath169 is a permutation of the numbers @xmath170 , and both @xmath167 and @xmath169 avoid @xmath70 .",
    "this representation is called the block decomposition of @xmath171 , see figure @xmath172 .",
    "= 2.5 in    the simple observation allows to formulate a general result concerning permutations avoiding @xmath70 and arbitrary pattern @xmath173 .",
    "recall that @xmath174 is said to be a _",
    "right - to - left maximum _",
    "if @xmath175 for any @xmath176 .",
    "let @xmath177 be the right - to - left maxima of @xmath7 written from left to right .",
    "then @xmath7 can be represented as @xmath178 where each of @xmath78 may be possibly empty , and all the entries of @xmath78 are greater than all the entries of @xmath179 .",
    "define the @xmath180th _ prefix _ of @xmath7 by @xmath181 for @xmath182 and @xmath183 , @xmath184 .",
    "besides , the @xmath180th _ suffix _ of @xmath7 is defined by @xmath185 for @xmath186 and @xmath187 .    [ a1 ] ( ( * ? ? ?",
    "* th .  1 ) ) for any @xmath188 , @xmath189 is a rational function satisfying the relation @xmath190    the proof is rather straightforward .",
    "let @xmath166 be the block decomposition of @xmath164 .",
    "it is easy to see that @xmath171 contains @xmath7 if and only if there exists @xmath180 , @xmath191 , such that @xmath167 contains @xmath192 and @xmath169 contains @xmath193 .",
    "therefore , @xmath171 avoids @xmath7 if and only if there exists @xmath180 , @xmath186 , such that @xmath167 avoids @xmath194 and contains @xmath192 , while @xmath169 avoids @xmath193 .",
    "we thus get the following relation : @xmath195 where @xmath196 , and @xmath197 is the number of permutations in @xmath26 containing @xmath198 at least once . to obtain the recursion for @xmath189 it remains to observe that @xmath199 for any @xmath97 and @xmath147 , and to pass to generating functions .",
    "rationality of @xmath189 follows easily by induction .",
    "+ theorem [ a1 ] allows to reduce the calculation of @xmath189 to finding similar functions for several simpler patterns .",
    "for example , if @xmath200 $ ] is a two - layered pattern , then theorem [ a1 ] gives @xmath201}(x)=1+xf_{[k - m-1]}(x)f_{[k , m]}(x)+x(f_{[k , m]}(x)-f_{[k - m-1]}(x))f_{[m]}(x)\\eqno(4.1)\\ ] ] and hence @xmath202}(x)$ ] can be expressed via @xmath203}(x)$ ] and @xmath204}(x)$ ] , ( see theorem [ a51 ] below ) .",
    "+ consider now the case of permutations containing @xmath70 exactly once .",
    "= 2.5 in    [ thbd1 ] let @xmath205 contain @xmath70 exactly once . then the block decomposition of @xmath171 can have one of the following three forms :    \\(i ) there exists @xmath206 such that @xmath166 , where @xmath167 is a permutation of @xmath207 containing @xmath70 exactly once , and @xmath169 is a permutation of @xmath170 avoiding @xmath70 ;    \\(ii ) there exists @xmath206 such that @xmath166 , where @xmath167 is a permutation of @xmath207 avoiding @xmath70 , and @xmath169 is a permutation of @xmath170 containing @xmath70 exactly once ;    \\(iii ) there exist @xmath208 such that @xmath209 , where @xmath167 is a permutation of @xmath210 avoiding @xmath70 , @xmath169 is a permutation of @xmath211 avoiding @xmath70 , and @xmath212 is a permutation of @xmath213 avoiding @xmath70 .",
    "let @xmath205 contain @xmath70 exactly once .",
    "there are two possibilities : either the only occurrence of @xmath70 in @xmath171 does not contain @xmath82 , or it contains @xmath82 . in the first case",
    "we get immediately that any entry of @xmath171 to the right of @xmath82 is less than any entry of @xmath171 to the left of @xmath82 , since otherwise one gets an occurrence of @xmath70 involving @xmath82 . in the second case ,",
    "let @xmath214 be the occurrence of @xmath70 in @xmath171 .",
    "first , we have @xmath215 , since otherwise either @xmath216 or @xmath217 would be a second occurrence of @xmath70 in @xmath171 .",
    "next , @xmath180 immediately precedes @xmath82 in @xmath171 , since if @xmath97 lies between @xmath180 and @xmath82 , then either @xmath218 or @xmath219 would be a second occurrence of @xmath70 in @xmath171 . finally , any entry to the right of @xmath147 is less than any entry between @xmath82 and @xmath147 , which in turn , is less than any entry to the left of @xmath180 ( the proof is similar to the analysis of the first case ) .",
    "the block decompositions of types @xmath220 and @xmath221 are similar to that for @xmath164 ( see figure 4 ) .",
    "the block decomposition of type @xmath144 is shown in figure @xmath136 .    for a far reaching generalization of this idea , allowing to enumerate permutations with any given number of occurrences of @xmath70 , see @xcite .",
    "throughout this section we write @xmath222 instead of @xmath223 .      by theorem [ tcw ]  ( ii ) and  ( iii ) , the pairs @xmath224\\}$ ] and @xmath225\\}$ ] are _ wilf - equivalent _ , that is @xmath226}(x)=\\bar f_{[k,1]}(x)$ ] .",
    "it turns out that this equivalence class can be extended as follows .",
    "2.4))[a51 ] for any @xmath227 , @xmath228 , @xmath229}(x)=r_k(x).\\ ] ]    this result follows immediately from theorem [ tcw ] and @xmath230 .",
    "+ a further extension is provided by the following result .",
    "we say that @xmath76 is a _",
    "pattern if it can be represented as @xmath231 so that each of @xmath78 is nonempty , @xmath232 is a layered permutation of @xmath233 for some @xmath94 , and @xmath234 .",
    "for example , @xmath235 is a wedge pattern ; here @xmath236 , @xmath237 , @xmath238 , @xmath239 , @xmath240 , @xmath241 , @xmath242 , @xmath243 .",
    "evidently , @xmath74 $ ] is a wedge pattern for any @xmath227 .",
    "2.6))[a52 ] @xmath244 for any wedge pattern @xmath245 .",
    "this result follows easily from theorem [ a1 ] .",
    "the proof of the above two results are purely analytical .",
    "it would be very interesting to find a bijective proof of these results .",
    "the case of general layered patterns can be also expressed in terms of chebyshev polynomials , using the same technique of block decompositions . since the expressions become rather cumbersome , we present here only the case of a @xmath138-layered pattern .",
    "2.5))[a53 ] for any @xmath246 , @xmath247}(x)=2t\\frac{u_{a+b}(t ) u_{a+c-1}(t)u_{b+c}(t)+ u_{b-1}(t)u_b(t ) } { u_{a+b}(t ) u_{a+c}(t)u_{b+c}(t)},\\qquad t=\\frac1{2\\sqrt{x}},\\ ] ] where @xmath248 , @xmath249 , @xmath250 .",
    "denote by @xmath251 the generating function for the number of permutations in @xmath128 containing a pattern @xmath252 exactly @xmath43 times .",
    "the continued fraction representation @xmath160 for @xmath253 immediately gives the following result .",
    "( ( * ? ? ?",
    "3.1))[b54 ] for any @xmath254 , @xmath255}(x)=\\frac1{u^{2}_{k}(t)},\\qquad t=\\frac1{2\\sqrt{x}}.\\ ] ]    this result may be extended in two directions .",
    "first , let us fix @xmath253 and consider other patterns @xmath7 .",
    "the case of @xmath256 $ ] was studied in @xcite .",
    "7))[b55 ] for @xmath257 , @xmath258}(x)=\\frac{1}{4t^2u_{k-2}(t)u_{k}(t ) } , \\qquad t=\\frac1{2\\sqrt{x}}.\\ ] ]    the proof involves bijection @xmath127 and the result of flajolet mentioned in section @xmath138 .    a more general case of @xmath200 $ ] is investigated in @xcite , based on block decompositions .",
    "3.4))[b56 ] for any @xmath259 , @xmath260}(x)=\\frac{1}{2tu_{k}(t)u_{m}(t)u_{k - m-1}(t ) } , \\qquad t=\\frac1{2\\sqrt{x}}.\\ ] ]    another direction would be to increase the value of @xmath43 . a generalization of theorem [ b54 ] to the case @xmath261 was obtained in @xcite , directly from @xmath160 .",
    "3.1))[b57 ] for any @xmath43 , @xmath262 , @xmath263}(x)=\\frac{u^{r-1}_{k-1}(t ) } { ( 2t)^{r-1}u^{r+1}_{k}(t ) } , \\qquad t=\\frac1{2\\sqrt{x}}.\\ ] ]    a similar generalization of theorem [ b55 ] is as follows .",
    "7))[b58 ] for any @xmath43 , @xmath264 , @xmath265}(x)= \\frac1{u_{k-3}(t)u_{k}(t)}\\sum_{l|r}\\frac1{l+1}\\binom{2l}{l } ( 2t)^{1 - 2l-\\frac{r}{l}}\\left(\\frac{u_{k-3}(t ) } { u_{k-2}(t)}\\right)^{r / l } , \\qquad t=\\frac1{2\\sqrt{x}}.\\ ] ]    the ideas behind the proof are the same as in the proof of theorem [ b55 ] .    theorem [ b57 ] can be extended to cover a wider range of @xmath43 s .",
    "( ( * ? ? ?",
    "4.1))[b59 ] for any @xmath43 , @xmath266 , @xmath263}(x)= \\frac{u^{r-1}_{k-1}(t)}{(2t)^{r-1}u^{r+1}_{k}(t ) } \\sum_{j=0}^{\\lfloor(r-1)/k\\rfloor } \\binom{r - kj+j-1}{j}\\left(\\frac{(2t)^{\\frac{k-2}{k}}u_{k}(t ) } { u_{k-1}(t)}\\right)^{kj},\\ ] ] where @xmath267 .",
    "the case of general @xmath43 was treated in @xcite .",
    "3))[b510 ] for any @xmath43 , @xmath263}(x)= \\sum\\left(\\binom{l_1+l_2 - 1}{l_2}\\binom{l_2+l_3 - 1}{l_3 } \\dots\\right)\\frac{u_{k-1}^{l_1 - 1}(t ) } { u_{k}^{l_1 + 1}(t ) } ( 2t)^{-(l_1 - 1)-2(l_2+l_3+\\dots)},\\ ] ] where the sum is over all nonnegative integers @xmath268 with @xmath269 and @xmath267 .",
    "denote by @xmath270 the generating function for the number of permutations in @xmath0 avoiding a pattern @xmath76 and containing @xmath70 exactly once .",
    "we start from the following result obtained in @xcite .",
    "4.2))[c511 ] for any @xmath271 , @xmath272}(x)=\\frac{1}{4t^2u_{k}^2(t ) } \\sum_{j=1}^{k-2}u_{j}^2(t ) , \\qquad t=\\frac1{2\\sqrt{x}}.\\ ] ]    the idea behind the proof is similar to that of the proof of theorem [ thrwz ] explained above in section @xmath138 .",
    "this result can be extended to the case of general @xmath98-layered patterns as follows .",
    "\\(i ) for any @xmath273 , @xmath274}(x)=\\frac{1}{4t^2u_{k}^2(t ) } \\left(\\sum_{j=1}^{k-2}u_{j}^2(t)-1\\right ) , \\qquad t=\\frac1{2\\sqrt{x}};\\ ] ] besides , @xmath275}(x)=\\frac{x^3}{1 - 2x}.\\ ] ]    \\(ii ) for any @xmath276 , @xmath277}(x)=\\frac{1}{4t^2u_{k}^2(t ) } \\left(\\sum_{j=1}^{k-2}u_{j}^2(t)-\\frac{2tu_{k-3}(t)}{u_{k-2}(t)}-2\\right ) , \\qquad t=\\frac1{2\\sqrt{x}};\\ ] ] besides , @xmath278}(x)=\\frac{x^3(1+x)}{(1-x)(1 - 3x+x^2)}.\\ ] ]    \\(iii ) for any @xmath279 and any @xmath227 , @xmath280 , @xmath281}(x)=\\frac{1}{4t^2u_{k}^2(t ) } \\bigg(\\sum_{j=1}^{k - m-2}u_{j}^2(t)+ \\sum_{j=1}^{m-1}u_{j}^2(t)-1\\\\ \\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad+u_{k-1}(t)u_{m-1}(t)u_{k - m-2}(t)\\bigg ) , \\qquad t=\\frac1{2\\sqrt{x}}. \\end{array}\\ ] ]    * remark*. clearly , the cases @xmath282 , @xmath283 ; @xmath284 , @xmath285 ; @xmath279 , @xmath286 are also covered , since @xmath287}(x)= h_{[k , k - m]}(x)$ ] .    by theorem [ thbd1 ] , we have exactly three possibilities for the block decomposition of an arbitrary @xmath205 .",
    "let us write an equation for @xmath288}(x)$ ] with @xmath273 .",
    "the contribution of the first decomposition above is @xmath289}(x)\\bar f_{[k,1]}(x)+x\\big(h_{[k,1]}(x)-h_{[k-2]}(x)\\big)$ ] . here",
    "the first term corresponds to the case @xmath167 avoids @xmath290 $ ] and @xmath169 avoids @xmath291 $ ] , while the second term corresponds to the case @xmath167 avoids @xmath291 $ ] but contains @xmath290 $ ] , and @xmath292 .",
    "the contribution of the second possible decomposition is @xmath293}(x)h_{[k,1]}(x)$ ] ; here @xmath169 contains @xmath70 , and hence is always distinct from @xmath294 .",
    "finally , the contribution of the third possible decomposition is @xmath295}^2(x)\\bar f_{[k,1]}(x)+ x^3\\bar f_{[k-2]}(x)(\\bar f_{[k,1]}(x)-\\bar f_{[k-2]}(x)).\\ ] ]    here the first term corresponds to the case @xmath296 avoid @xmath290 $ ] , @xmath212 avoids @xmath291 $ ] , while the second term corresponds to the case @xmath167 avoids @xmath290 $ ] , @xmath169 avoids @xmath291 $ ] but contains @xmath290 $ ] , and @xmath297 .    solving the obtained linear equation and using theorems [ tcw ] ,  [ c511 ] , and well known identities involving chebyshev polynomials ( see e.g. ( * ? ? ?",
    "4.1 ) ) , we get the desired expression for @xmath288}(x)$ ] , @xmath273 .    in the case",
    "@xmath282 , the contributions of the first and the second decompositions degenerate to @xmath298}(x)$ ] each , while the contribution of the third decomposition degenerates to @xmath299 ( which means that the only permutation having this decomposition is @xmath70 itself ) .",
    "the result follows immediately .",
    "let us consider now the case of @xmath300}(x)$ ] with @xmath276 .",
    "the contribution of the first decomposition is @xmath301}(x)\\bar f_{[k,2]}(x)+x\\big(h_{[k,2]}(x)- h_{[k-3]}(x)\\big)\\bar f_{[2]}(x)$ ] . here",
    "the first term corresponds to the case @xmath167 avoids @xmath302 $ ] and @xmath169 avoids @xmath303 $ ] , while the second term corresponds to the case @xmath167 avoids @xmath303 $ ] but contains @xmath302 $ ] , and @xmath169 avoids @xmath304 $ ] .    the contribution of the second decomposition is @xmath305}(x)h_{[k,2]}(x)$ ] .    finally , the contribution of the third decomposition is @xmath306}^2(x)\\bar f_{[k,2]}(x)+ x^3\\bar f_{[k-3]}(x)\\big(\\bar f_{[k,2]}(x)-\\bar f_{[k-3]}(x)\\big ) \\bar",
    "f_{[2]}(x)\\\\ \\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad+x^3\\big(\\bar f_{[k-2]}(x)-\\bar f_{[k-3]}(x)\\big ) \\bar f_{[2]}(x).\\end{array}\\ ] ] here the first term corresponds to the case @xmath296 avoid @xmath302 $ ] , @xmath212 avoids @xmath303 $ ] , the second term corresponds to the case @xmath167 avoids @xmath302 $ ] , @xmath169 avoids @xmath303 $ ] but contains @xmath302 $ ] , and @xmath212 avoids @xmath304 $ ] , while the third term corresponds to the case @xmath167 avoids @xmath290 $ ] but contains @xmath302 $ ] , @xmath292 , and @xmath212 avoids @xmath304 $ ] .",
    "the expression for @xmath300}(x)$ ] follows easily from this equation and theorems [ tcw ] and [ c511 ] .",
    "the case @xmath307 is treated similarly .    for general @xmath227 , @xmath308",
    ", the contribution of the first decomposition equals @xmath309}(x)\\bar f_{[k , m]}(x)+x\\big(h_{[k , m]}(x)-h_{[k - m-1]}(x)\\big ) \\bar f_{[m]}(x)$ ] , the contribution of the second decomposition equals @xmath310}(x)h_{[k , m]}(x)+ x\\big(\\bar f_{[k , m]}(x)-\\bar f_{[k - m-1]}(x)\\big)h_{[m]}(x)$ ] , and the contribution of the third structure decomposition @xmath311}^2(x)\\bar f_{[k , m]}(x)+x^3\\bar f_{[k - m-1]}(x ) \\big(\\bar f_{[k , m]}(x)-\\bar f_{[k - m-1]}(x)\\big)\\bar f_{[m]}(x)\\\\ \\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad+x^3\\big(\\bar f_{[k , m]}(x)-\\bar f_{[k - m-1]}(x)\\big)\\bar f_{[m-1]}(x ) \\bar f_{[m]}(x ) .",
    "\\end{array}\\ ] ] the final result again follows from theorems [ tcw ] and [ c511 ] .",
    "denote by @xmath312 the generating function for the number of permutations in @xmath0 containing both @xmath70 and a pattern @xmath76 exactly once .",
    "we start from the following result .",
    "[ d513 ] for any @xmath254 , @xmath313}(x)=\\frac{1}{4t^3u_{k}^2(t ) } \\sum_{i=1}^{k-2}\\frac{\\sum_{j=1}^{k - i}u_{j}^2(t)-1 } { u_{k - i}(t)u_{k - i+1}(t ) } , \\qquad t=\\frac1{2\\sqrt{x}}.\\ ] ]    the three possible block decompositions of permutations containing @xmath70 exactly once are described in theorem [ thbd1 ] .",
    "let us find the recursion for @xmath314}(x)$ ] .",
    "it is easy to see that the contribution of the first decomposition equals @xmath315}(x)\\bar f_{[k]}(x)+xh_{[k-1]}(x)g_{[k]}^1(x),\\ ] ] the contribution of the second decomposition equals @xmath316}^1(x)h_{[k]}(x)+x\\bar f_{[k-1]}(x)\\phi_{[k]}(x),\\ ] ] while the contribution of the third decomposition equals @xmath317}^1(x)\\bar f_{[k-1]}(x)\\bar f_{[k]}(x)+x^3\\bar f_{[k-1]}^2(x ) g_{[k-1]}^1(x).\\ ] ] solving the obtained recursion with the initial condition @xmath318}(x)=0 $ ] and using theorems [ tcw ] , [ b54 ] , and [ c511 ] , we get the desired result .    in particular , for @xmath282 we get @xmath319}(x)=2x^5(1 - 2x)^{-3}$ ] , which means that the number of permutations in @xmath0 containing both @xmath70 and @xmath163 exactly once equals @xmath320 ( see ( * ? ? ? * th .",
    "1.3.18 ) ) .    similarly to the previous section , this result can be extended to the case of general @xmath98-layered patterns .",
    "since the answers become very cumbersome , we present here only the simplest case .",
    "[ d514 ] for any @xmath273 , @xmath321}(x)=\\frac { 1 } { 8t^3u_{k}^2(t)}\\left ( \\frac{u_k(t)}{2t^2u_{k-2}(t)}\\sum_{i=1}^{k-4 } \\frac{\\sum_{j=1}^{k - i-2}u_{j}^2(t)-1}{u_{k - i-2}(t)u_{k - i-1}(t)}\\right.\\\\ \\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad+\\left.\\frac{1}{2tu_{k-2}^2(t)}\\sum_{i=1}^{k-4}u_{i}^2(t)+ \\frac{u_{k-3}(t)}{2tu_{k-1}(t)}+\\frac{u_{k}(t)}{u_{k-1}(t)}\\right ) , \\end{array}\\ ] ] where @xmath267 .      here",
    "we present several directions to generalize the results of the previous sections .",
    "the first of these directions is to consider more than one additional restriction .",
    "for example , the following result is true .",
    "let @xmath322 be the generating function for the number of permutations in @xmath323 .",
    "assume that @xmath324 $ ] , @xmath325 , and @xmath326 $ ] .",
    "it is easy to see that the only interesting case is @xmath327 , since otherwise @xmath328,[l]}(x)=\\bar f_{[l]}(x)$ ] .",
    "[ e515 ] let @xmath329 , then @xmath229,[l]}(x)=r_k(x)-\\big(xr_{k - m}(x)r_m(x)\\big)^{l+m - k } ( r_k(x)-r_{k - m}(x)).\\ ] ]    let @xmath164 , then either @xmath330 ( which means that @xmath331 ) , or @xmath332 , where both @xmath167 and @xmath169 avoid @xmath70 . according to this dichotomy",
    ", we get the following recursion : @xmath229,[l]}(x)=1+x\\bar f_{[k - m-1]}(x)\\bar f_{[k , m],[l]}(x)+ x\\big(\\bar f_{[k , m],[l-1]}(x)-\\bar f_{[k - m-1]}(x)\\big)\\bar f_{[m]}(x).\\ ] ] solving this recursion with the initial condition @xmath328,[k - m]}(x)= \\bar f_{[k - m]}(x)$ ] and using theorem [ tcw ] , we get the desired result .",
    "similarly , let @xmath333 be the generating function for the number of permutations in @xmath334 that contain @xmath17 exactly once .",
    "as before , we assume @xmath324 $ ] , @xmath325 , and @xmath326 $ ] . once again , the case @xmath335 is of no interest , since in this case @xmath336;[l]}(x)=g_{[l]}(x)$ ] .",
    "[ e516 ] ( i ) let @xmath337 , then @xmath338;[l]}(x)=\\frac{1}{u_m(t)u_{k - m}(t)}\\left(\\frac{u_{m-1}(t ) } { u_m(t)}\\right)^{l - m}\\left(\\frac{u_{k - m-1}(t)}{u_{k - m}(t)}\\right)^{l+m - k}\\\\ \\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\times\\left(\\sum_{j = m+2}^{k - m}\\frac{u_{j - m-2}(t ) } { u_{j-2}(t)u_{j-1}(t)}\\left(\\frac{u_{m-1}(t)}{u_m(t)}\\right)^{m+1-j}+1\\right ) , \\end{array}\\ ] ] where @xmath267 .",
    "\\(ii ) let @xmath339 , then @xmath338;[l]}(x)=\\\\ \\quad\\frac{1}{u_l(t)u_m(t)}\\left(\\frac{u_{m-1}(t)}{u_m(t)}\\right)^{l - m } \\left(\\sum_{j = m+1}^{l}\\frac{u_{j - m-1}(t ) } { u_{j-1}(t)u_{j}(t)}\\left(\\frac{u_{m-1}(t)}{u_m(t)}\\right)^{m - j}+1\\right ) , \\end{array}\\ ] ] where @xmath267 .",
    "another possible direction is to replace @xmath70 by some restriction of length @xmath172 or more having a similar restrictive power .",
    "define @xmath340 as the set of all patterns in @xmath341 of the form @xmath342 , where @xmath343 is nonempty .",
    "evidently , @xmath344 ; for @xmath345 we get @xmath346 , and so on .",
    "it turns out that @xmath340 is , in a sense , an analog of @xmath70 for @xmath347 .",
    "for example , the following result is an analog of theorem [ tcw ]  ( ii ) for @xmath345 .",
    "[ e517 ] for any @xmath257 , @xmath348\\}}(x)=1+x+x^2r_k(x)r_{k-1}(x)\\bigl(r_{k-1}(x)+r_{k-2}(x)\\bigr).\\ ] ]    the main ingredient of the proof is the following description of the block decompositions of permutations in @xmath349 .",
    "let @xmath350 , then there exist @xmath351 such that either @xmath352 , or @xmath353 , where @xmath354 is a permutation of the numbers @xmath355 , @xmath356 is a permutation of the numbers @xmath357 , and @xmath358 is a permutation of the numbers @xmath359 .",
    "consider now the case of a general @xmath347 .",
    "for an arbitrary @xmath360 we define a sequence @xmath361 of zeros and ones of length @xmath362 as follows .",
    "first of all , we put @xmath363 if @xmath364 and @xmath365 otherwise .",
    "if @xmath366 are already determined , we put @xmath367 if the length of the maximal increasing subsequence in @xmath368 is greater than that of @xmath369 , and @xmath370 otherwise .",
    "for example , let @xmath371 , then @xmath363 , @xmath372 , @xmath373 , @xmath374 , @xmath375 , @xmath376 .",
    "for an arbitrary sequence @xmath377 we denote by @xmath378 the number of permutations @xmath360 such that @xmath379 .",
    "the following result is a further generalization of theorem [ e517 ] .",
    "[ e518 ] for any @xmath380 and any @xmath347 , @xmath381\\}}(x)=\\sum_{i=0}^{p-3}i!x^i+x^{p-2}r_k(x)r_{k-1}(x ) \\sum_{a\\in q^{p-3}}n(a)\\prod_{j=1}^{p-3}r_{k - j - a_{j}}(x).\\ ] ]    as a generalization of theorem [ a51 ] we get the following result .",
    "[ e519 ] ( i ) for any @xmath227 , @xmath382 , @xmath383\\}}(x)=1+\\frac1{4t^2}+\\frac{u_{k-2}(t)u_{m-1}(t ) } { tu_k(t)u_m(t)}\\\\ \\quad\\quad\\quad+\\frac{u_{k - m-2}(t)}{2tu_k(t)u_m(t)}\\left(\\frac{u_{k - m-2}(t)}{u_{k - m-1}(t)}+ \\frac{u_{k - m-3}(t)}{u_{k - m-2}(t)}\\right ) , \\qquad t=\\frac1{2\\sqrt{x}}. \\end{array}\\ ] ]    \\(ii ) @xmath384\\}}(x)=f_{\\{l_4,[k]\\}}(x).\\ ] ]",
    "the case of @xmath71-restricted permutations is studied much less than the previous one .",
    "we start from the following generalization of theorem  [ tcw](i ) .",
    "therefore , the wilf class of @xmath386\\}$ ] contains the pair @xmath387\\}$ ] as well .",
    "once again , we have only an analytical proof of this result .",
    "moreover , the ideas behind this proof are very different from these behind the proofs in the previous section . let @xmath388\\}$ ] ; we define @xmath389 where @xmath390 , and prove that @xmath391 satisfy a linear recurrence ( see ( * ? ? ? * th .  2.3 ) ) .",
    "it follows that @xmath392 where @xmath393 is the @xmath147th catalan number .",
    "using classical identities involving catalan numbers we get the desired result .",
    "+ in view of theorems [ a51 ] and [ a52 ] , it is a challenge to find a bijective proof of theorem [ u1 ] .",
    "the proof of this result is based on the bijection @xmath162 between @xmath163-avoiding permutations with exactly @xmath43 occurrences of the pattern @xmath291 $ ] and dyck paths which start at the origin , return to the @xmath51-axis , and have exactly @xmath43 peaks at height @xmath62 .",
    "+ the case of a general @xmath98-layered pattern remains intractable .",
    "our computational experiments suggest that @xmath396}(x)=g^r_{321 ; [ k,2]}(x)$ ] for @xmath397 ; however , we are unable to prove this ."
  ],
  "abstract_text": [
    "<S> we study generating functions for the number of permutations in @xmath0 subject to two restrictions . </S>",
    "<S> one of the restrictions belongs to @xmath1 , while the other belongs to @xmath2 . </S>",
    "<S> it turns out that in a large variety of cases the answer can be expressed via chebyshev polynomials of the second kind .    </S>",
    "<S> 2000 mathematics subject classification : primary 05a05 , 05a15 ; secondary 30b70 , 42c05    @xmath3 labri , universit bordeaux + 351 cours de la libration , 33405 talence cedex , france + @xmath4 department of mathematics and department of computer science + university of haifa , haifa , israel 31905 + toufik@labri.fr , alek@mathcs.haifa.ac.il     + * contents : *   + </S>"
  ]
}