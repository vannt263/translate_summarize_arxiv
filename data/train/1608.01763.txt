{
  "article_text": [
    "one of the major aims of modern astrophysics is to understand how galaxies and galaxy systems form and evolve in the cosmic density field . in the current standard cosmogony , galaxies are assumed to form via radiative cooling and collapse of baryonic gas within the gravitational potentials of the dark matter structures ( e.g. white & rees 1978 ) . therefore exploring the relationships and interactions between baryonic gas , galaxies and dark matter",
    "is not only essential for understanding galaxy formation ( e.g. mo , van den bosch & white 2010 ) , but also important for using galaxies as tracers of the large - scale structure of the universe to test models for cosmology and dark matter particles ( e.g. , peebles 1980 ; peebles & nusser 2010 ; frenk & white 2012 ) .",
    "many observational programs have been carried out to study the properties of galaxies and the baryonic gas , such as the intergalactic medium ( igm ) , circum - galactic medium ( cgm ) and interstellar medium ( ism ) .",
    "galaxy properties are observed through multi - band galaxy surveys , such as the sloan digital sky survey ( sdss ; york et al .",
    "2000 ) and the two micron all sky survey ( skrutskie et al . 2006 ) .",
    "the gas components can be detected via various ways , such as x - ray observations ( e.g. rosati et al .",
    "2002 ) , quasar absorption line systems ( e.g. danforth & shull 2008 ) , the 21 cm emission of neutral hydrogen gas ( e.g. , koribalski et al . 2004 ) , and millimeter / sub - millimeter emissions of molecular gas ( e.g. young et al . 1995 ) .",
    "these observations provide unprecedented data base to study the processes that shape the eco - systems of galaxies we observe .",
    "theoretically , great progress has been made in understanding the structures in cold dark matter distribution ( e.g. zeldovich 1970 ; davis et al .",
    "1985 ; springel et al . 2005 ) .",
    "the key concept in the buildup of the cosmic structure is the formation of dark matter halos , which are the hosts of galaxies . with the help of n - body simulations ,",
    "the properties of the halo population , such as the spatial clustering , mass function , assembly history , and internal structure , are well understood ( e.g. mo et al .",
    "2010 for a review ) . within the current @xmath2cdm paradigm , methods , such as hydrodynamical simulations ( katz 1992 ; navarro & white 1993 ; vogelsberger et al . 2014 ; schaye et al . 2015 ) , semi - analytic model ( white & frenk 1991 ; croton et al .",
    "2006 ; lu et al .",
    "2011 ) , and empirical models ( jing et al . 1998 ; peacock & smith 2000 ; yang et al . 2003 ; kravtsov et al . 2004 ; zheng et al . 2005 ; vale & ostriker 2006 ; van den bosch et al .",
    "2007 ; behroozi et al . 2010 ; lu et al 2014 ) , have been developed to understand how galaxies form and evolve in dark matter halos .",
    "however our understanding of the physical processes driving galaxy formation and evolution is still poor , and many competing models have been proposed .",
    "it is , therefore , crucial to develop an optimal strategy that can sufficiently utilize the abundant observational data to constrain theoretical models .",
    "one promising way in this direction is to reconstruct the initial density field from which the observed universe has evolved , so that we can carry out simulations for the observed structures under various model assumptions .",
    "such an approach makes it possible to compare model predictions with data in a way that is free of the cosmic variance produced by large - scale environments .",
    "this is particularly important when the observational samples are small , so the cosmic variance is a serious issue , as is the case for dwarf galaxies and for low-@xmath3 quasar absorption line systems .",
    "moreover , accurate constrained simulations can also be used to study the histories and environments of real galaxies , as well as to investigate the interactions among galaxies , gas and dark matter .",
    "there have been a lot of efforts in developing methods to reconstruct the initial conditions of the local universe ( e.g. peebles 1989 ; hoffman & ribak 1991 ; nusser & dekel 1992 ; klypin et al .",
    "2003 ; brenier et al . 2003 ; lavaux 2010 ; jasche & wandelt 2013 ; kitaura 2013 ; doumler et al .",
    "2013 ; wang et al . 2013 ; 2014 ; sorce et al .",
    "these methods differ primarily in three ways .",
    "the first is the observational data that are used to constrain the reconstruction .",
    "some of the previous investigations use galaxies as tracers of the cosmological density field , while others use the peculiar velocities of galaxies . with the advent of large redshift surveys ,",
    "millions of galaxies now have accurate measurements for their positions , redshifts and intrinsic properties .",
    "using galaxy distribution to trace the cosmic density field is an obvious choice .",
    "however , one long - standing problem is that galaxies are biased tracers of cosmic density , and the bias is not easy to model as it depends on how galaxies form in the cosmic density field . in the gravitational instability scenario of structure formation , the peculiar velocities are directly related to the mass density field .",
    "however , only a small fraction of nearby galaxies have reliable peculiar velocity measurements ( e.g. willick et al .",
    "1997 ; tully et al . 2013 ) .",
    "more recently , halos represented by galaxy groups ( e.g. yang et al . 2005 ; 2007 ) have been used to reconstruct the current mass density field ( wang et al . 2009;2013",
    "; muoz - cuartas et al .",
    "2011 ) , that can also serve as the base of the reconstruction .",
    "this method follows the spirit of current halo model ( e.g. cooray & sheth 2002 ) , and automatically takes into account the halo bias .",
    "the second difference is in the dynamical model used to predict the final density field from the initial conditions .",
    "a number of dynamical models have been used , including linear theory , zeldovich approximation and its modification ( nusser & dekel 1992 ; wang et al .",
    "2013 ; doumler et al . 2013 ; sorce et al . 2016 ) , second - order lagrangian perturbation theory and its modifications ( jasche & wandelt 2013 ; kitaura 2013 ; he et al .",
    "2013 ) , and particle - mesh ( pm ) dynamics ( wang et al . 2014 ) .",
    "the third difference is in the model used to infer the initial conditions from the observational constraints .",
    "some of the previous investigations adopted backward models which evolve the present - day density / velocity fields back in time to the linear regime ( nusser & dekel 1992 ; doumler et al .",
    "2013 ; sorce et al .",
    "recently , forward models are proposed , which use a probability distribution function consisting of a gaussian prior and a likelihood function , and use mcmc - like algorithms to obtain the posterior of the initial density field ( jasche & wandelt 2013 ; kitaura 2013 ; wang et al . 2013 ; 2014 ) . both the forward and backward models have their shortcomings : the backward models are only valid on scales where the multi - streaming ( shell crossing ) is absent , while the forward models require a large amount of computations to sample the parameter space .",
    "we refer the reader to wang et al .",
    "( 2014 ) for a more detailed discussion of the various methods .    in our first elucid paper ( wang et al .",
    "2014 , hereafter paper i ) , we developed a forward method which employs the hamiltonian markov chain monte carlo ( hmc ) algorithm to sample the posterior and uses the pm dynamics to evolve the initial condition to the present day .",
    "the reliability and accuracy of the hmc method were examined in great detail in paper i and wang et al .",
    "( 2013 ) using simulations and mock catalogs constructed from them . in the second paper ( tweed et al .",
    "2016 in preparation ) , we use @xmath4-body simulations to examine the reliability of the hmc method in reproducing the dark matter halo population .",
    "we found that our method can effectively trace massive halos back to the initial condition , which demonstrates that our reconstructed initial conditions can be used to simulate the formation histories of individual massive halos .",
    "as the third in a series , this paper presents the application of method to the sdss data .",
    "the paper is organized as follows .",
    "section [ sec_method ] describes briefly the method and observational data we use .",
    "section [ sec_sts ] presents the statistical properties of our constrained simulation .",
    "the relations of the mass density field in the constrained simulation with the sdss groups and galaxies are investigated in section [ sec_corr ] . some interesting structures in the cosmic web as revealed by the constrained simulation",
    "are presented section [ sec_web ] .",
    "finally , we summarize our results and make further discussions some in section [ sec_sum ] .",
    "in this section , we present a brief introduction to our reconstruction method developed in our early studies ( yang et al . 2005;2007 ; wang et al . 2009;2012;2013 ; paper i ) .",
    "the method starts from a redshift catalog of galaxies , such as the sdss .",
    "first , we employ the halo - based group finder to identify galaxy groups from the galaxy catalog .",
    "second , a model based on linear perturbation theory is applied to predict the peculiar velocity of each halo , and to correct the redshift to obtain its distance .",
    "third , the groups in `` real space '' are used to reconstruct the present - day density field in the local universe .",
    "finally , we employ a hmc@xmath5pm method we have developed to reconstruct the initial conditions of the density field in the local universe , and use @xmath4-body simulations to evolve the reconstructed initial conditions to obtain the formation history of the local universe .",
    "the galaxy sample used here is formed from the new york university value - added galaxy catalogue ( blanton et al .",
    "2005 ) of the sdss dr7 ( abazajian et al .",
    "2009 ) , but includes a set of improved reductions ( see yang et al .",
    "we select all galaxies in the main galaxy sample , with @xmath6-band apparent magnitudes @xmath7 after correcting for galactic extinction , with redshifts in the range @xmath8 , and with redshift completeness @xmath9 .",
    "galaxy groups are identified by using the adaptive halo - based group finder developed by yang et al .",
    "( 2005 ; 2007 ) .",
    "group masses are estimated using abundance matching based on the ranking of a characteristic luminosity / stellar mass defined for each of the groups . here",
    ", we adopt their luminosity - based group masses .",
    "tests based on detailed mock catalogs suggest that more than 90% of the true halos can be identified and the fraction is even higher at the low and high mass ends .",
    "the uncertainties in the group mass estimation is about 0.35 dex for groups in the intermediate mass range , and 0.2 dex for both low and high mass groups ( see yang et al .",
    "2007 for details ) .",
    "the sdss dr7 covers a sky area of 7,748 deg@xmath10 , consisting of two parts : a larger region in the northern galactic cap ( ngc ) and a smaller region in the southern galactic cap ( sgc ) . in order to obtain a reliable reconstruction",
    ", we only use the more contiguous ngc region , which has a sky coverage of 7047 deg@xmath10 . as shown in yang et al .",
    "( 2007 ) , the mass assignment based on the characteristic luminosity is complete to @xmath11 for groups with mass @xmath12 . in the following , we only use groups with @xmath13 ,",
    "so our reconstruction is restricted to the redshift range @xmath14 , which will be referred to as the survey volume . within the survey volume ,",
    "the total number of groups with masses above @xmath15 is 121,922 .",
    "the left two panels of figure [ fig_drec ] show the spatial distributions of the galaxies and groups of @xmath16 in a slice of @xmath17 in thickness .",
    "the slice is chosen so that a large scale structure , called the sloan great wall ( gott et al . 2005 ) , is located at the center .",
    "one can see that there are lots of stick - like structures in the high density regions of the galaxy distribution , which point towards to the earth , which are the ` fingers of god ' ( fog ) caused by the virial motions of galaxies within galaxy clusters .",
    "such a fog effect is largely mitigated in the distribution of groups , since the group finder takes into account the virial motions when assigning galaxies into groups .",
    "the reader is referred to yang et al .",
    "( 2007 ) for the details about the group catalog construction and halo mass estimation .",
    "here we adopt the wmap5 cosmology ( dunkley et al .",
    "2009 ) , instead wmap3 adopted in the original yang et al .",
    "( 2007 ) paper .",
    "this mean all quantities are updated with this new cosmology .",
    "since the method ( shown in section [ sec_hd ] ) used to reconstruct present - day density field from dark matter halos is designed to work , and has been tested in great detail , only in real space , we need to correct for redshift distortion in the distribution of groups in order to reconstruct the the present - day density field in real space from groups .",
    "in addition to the virial motion within groups , the large - scale bulk motions of groups can also produce redshift distortion ( kaiser 1987 ) . to this end",
    ", we use the method developed in wang et al .",
    "( 2009 ; 2012 ) .",
    "the basic idea is to apply the linear theory to the mass density field represented by groups to predict the peculiar velocity of each group , and then use it to correct for the redshift distortion .",
    "since the procedure starts from groups in redshift space , iterations are required .",
    "our tests suggest that two iterations are sufficient to achieve convergence .",
    "of course , the linear theory is invalid on small scales ; in particular it may predict too high bulk velocities around high density regions , such as clusters of galaxies . to reduce errors caused by this",
    ", the group mass density field is smoothed using a gaussian kernel with a relatively large scale , corresponding to a mass of @xmath18 at the mean density .",
    "the distribution of groups in `` real space '' is shown in the third panel of figure [ fig_drec ] .",
    "our detailed tests based on mock group catalog showed that the mean offset between the predicted and original positions of groups is between 1.1 and 1.4@xmath19 in the inner region of the survey volume ( wang et al . 2012 ; 2013 ) .",
    "such spatial offset corresponds to a velocity of @xmath20 according to hubble law , which is similar to the typical uncertainty in the predicted velocities ( e.g. wang et al . 2009 ) . in locations close to the boundary ,",
    "the predicted velocities become more inaccurate , because velocity field is sensitive to large scale structures that are not well samples near the boundary .      the group catalog in real space described above",
    "is used to reconstruct the present - day mass density field in the local universe , using a method that closely follows the halo - domain reconstruction method developed in wang et al .",
    "( 2009 ; 2013 ) .",
    "this method `` convolve '' the dark halo population ( as represented by individual groups ) with certain density profiles to reconstruction the large scale density field .",
    "these density profiles are obtained from 8 @xmath4-body simulations particles to trace the evolution of the cosmic density field in a cubic box with a side length of @xmath21 , and four use @xmath22 particles in a smaller , @xmath23 , box .",
    "] of the wmap5 cosmology using gadget-2 code ( springel 2005 ) .",
    "following wang et al .",
    "( 2009 ) , we partition each simulation box into a set of domains .",
    "each domain contains one and only one halo with mass of @xmath24 .",
    "the domain geometry of a halo is determined in such a way that any point in the domain is closer , based on a specific distance proximity , to the halo than to any other halo . the distance proximity between a point and a halo",
    "is defined as @xmath25 , where @xmath6 is the distance between them and @xmath26 is the virial radius of the halo .",
    "we then calculate the average density profile around halos of the same mass in their corresponding domains .",
    "figure [ fig_dp ] shows the results in six different mass bins .",
    "the eight simulations yield almost identical density profiles ; we thus only show the results averaged over them .        the density field",
    "is then reconstructed in the following way . for a sdss group",
    ", we pick a density profile according to its halo mass .",
    "a monte carlo technique is used to put particles around this group to sample the chosen density profile in the three dimensional space within its domain .",
    "this procedure is repeated for all the groups with masses above @xmath15 .",
    "eventually , we get a present - day density field in the local universe , which we denote by @xmath27 . in wang et al .",
    "( 2009 ) , the method was applied to dark halos extracted directly from @xmath4-body simulations .",
    "there it was found that the reconstructed density field correlates with the original simulated density field [ denoted as @xmath28 extremely tightly .",
    "wang et al . also applied the method to mock group catalogs to examine its reliability against uncertainties arising from false identification of groups and redshift distortion effects ( wang et al .",
    "it was found that , on scales of @xmath29 , the root mean square ( r.m.s ) of @xmath30/\\rho'_{\\rm hd}({\\bf x})$ ] is between 0.3 and 0.5 , corresponding to a scatter between 0.11 and 0.18 dex .",
    "these tests demonstrate that our method can reliably recover the density field from groups constructed from a galaxy redshift survey .",
    "however , there is a small but systematical bias in the power spectra of the reconstructed density fields , as demonstrated in wang et al .",
    "( 2009 ) . when the method was applied to halos extracted from @xmath4-body simulations , the power spectra of the reconstructed density fields , @xmath31 , were found to be 10%-20% lower than those of the original simulations , @xmath32 , on some scales .",
    "this loss of power is due to the fact that we have ignored the contribution of smaller halos and that the non - spherical nature of the structures on halo and larger scale is not accurately modeled by the density profiles , such as those shown in figure [ fig_dp ] .",
    "the ratio between these power spectra is about the same for all simulations .",
    "thus , we can correct for the bias simply by using a correcting function defined as , @xmath33 . in practice",
    "we proceed in the following way .",
    "we embed @xmath27 in a periodic box of size @xmath34 , which is divided into @xmath35 grid cells in each dimension . for the grid cells inside the survey volume ,",
    "we obtain the over - density , @xmath36 , where @xmath37 is the mean density within the survey volume . for grid cells outside the survey volume , @xmath38 is set to zero .",
    "we then fourier transform @xmath38 and multiply the resulting fourier modes by @xmath39 .",
    "finally , we obtain the over - density field ( @xmath40 ) by the inverse fourier transformation , and the densities are obtained through @xmath41 . in the forth panel of figure [ fig_drec ] , we show the reconstructed density field smoothed by using a gaussian kernel of radius @xmath42 .",
    "one can see that this density field matches well the distributions of both the galaxies and groups . in the following ,",
    "we denote this reconstructed present - day density field by @xmath43 .    in appendix",
    ", we use realistic galaxy and group mock catalogs to further test our halo - domain method .",
    "we also estimate the uncertainties of the reconstruction by comparing the reconstruction and the original used to construct the mock catalog .",
    "we find that @xmath43 is strongly correlated with the density field of the original simulation , @xmath44 , without any significant bias .",
    "the typical scatter between the two densities , in terms of the r.m.s of @xmath45 , are 0.09 and 0.20 dex at @xmath46 and @xmath47 respectively .",
    "moreover , we find that implementing the correction function improves the reconstruction at low density regions but has no significant effect on high density regions .",
    "the hmc method ( wang et al . 2013 ; paper i ) is then employed to reconstruct the initial density field from the halo - domain density field .",
    "this method infers a linear density field in fourier space , @xmath48 , from a posterior probability distribution function , @xmath49 ^ 2\\omega({\\bf x})/2\\sigma_{\\rm hd}^2({\\bf",
    "x})}\\times\\nonumber\\\\ & & \\prod_{\\bf k}^{\\rm half}\\prod_{j={\\rm re}}^{\\rm im}\\frac{1}{[\\pi p_{\\rm lin}(k)]^{1/2}}{\\rm e}^{-[\\delta_j({\\bf k})]^2/p_{\\rm lin}(k)}\\label{eq_post}\\,.\\end{aligned}\\ ] ] the second term , @xmath50 , is the prior term that ensures @xmath48 to have a gaussian distribution with a given linear power spectrum , @xmath51 .",
    "the likelihood term , @xmath52 , is designed to ensure that the predicted density field ( @xmath53 ) evolved from @xmath48 according to a given structure formation model matches the input nonlinear density field , which in our case is the halo - domain density field @xmath43 . in our application",
    ", @xmath54 is set to @xmath55 , and the weighting function , @xmath56 , is specified below .",
    "since the input final density field is highly non - linear ( figure [ fig_drec ] ) , it requires the structure formation model that links @xmath48 and @xmath57 to be sufficiently accurate so as to properly handle highly nonlinear dynamics on small scale .",
    "as shown in paper i , an inaccurate model can introduce spurious non - gaussian features in the reconstructed linear density field , which in turn can lead to significant bias in the predicted halo population . in this paper , we will follow paper i and use the particle - mesh ( pm ) dynamics to follow the evolution of the density field .",
    "the pm scheme is often used to calculate the forces on large - scales in cosmological simulations .",
    "it can describe the structure formation and evolution accurately as long as the available computational resources allow the implementation with sufficiently high resolutions in both space and time . in what follows ,",
    "reconstruction method based on the hmc with pm dynamics is referred to as the hmc@xmath5pm method .",
    "some important parameters used in the hmc and pm have to be specified before using the hmc@xmath5pm method to reconstruct the initial density field . as discussed in the previous section , the halo - domain density field",
    "is embedded in a 500@xmath58 cubic box and the box is divided into @xmath59 grid cells , so that the grid cell size is @xmath60 .",
    "for such a spatial resolution , twenty pm time steps are sufficient ( see paper i for detailed discussions ) . since we perform the reconstruction in a very large volume , a more accurate pm model ( equivalent to higher spatial resolution ) will require computational resources that are beyond our reach at the moment .",
    "we note , however , that the pm model with @xmath60 and 20 time steps is already much more accurate than any other structure formation models used so far in the literature for initial density field reconstruction , such as the zeldovich approximation and higher - order lagrangian perturbation theory .",
    "with such a pm , significant discrepancies are still present on small scales between the model prediction and the fully non - linear density field , due to the inaccuracy of the model .",
    "the tests in paper i suggest that smoothing both the density fields on a scale of @xmath61 can effectively eliminate such discrepancies . here , we choose a more conservative smoothing scale of @xmath62 .",
    "another important parameter is the weighting function @xmath56 , which specifies the window in which the comparisons between @xmath53 and @xmath43 are to be made . in our reconstruction , all grids outside of the survey volume",
    "are assigned a zero weight , but not all grids inside the survey volume are assigned a full weight .",
    "recall that the halo - domain density field , @xmath43 , is smoothed on @xmath63 in the hmc run .",
    "when performing the smoothing , the density outside of the survey volume is set to the mean cosmic density .",
    "it thus introduces uncertainties into @xmath43 at locations close to the boundary of survey volume . to deal with this boundary effect ,",
    "we define a factor @xmath64 to characterize the closeness of a grid to the boundary . for a grid cell in the survey volume , @xmath65 is the fraction of a spherical volume of radius @xmath66 centered on the grid that is contained by the survey volume .",
    "here we choose @xmath67 , and use @xmath68 to define a boundary layer .",
    "when the curvature radius of the boundary surface is much larger than @xmath17 ( which is the case for most of the cases ) , @xmath69 corresponds to distance of @xmath70 from the boundary , which is larger than the adopted smoothing scale .",
    "so the boundary effect can be ignored for all the grids with @xmath71 .",
    "such grids are assigned a weight of unity , while the grids with @xmath72 are assigned a weight of zero . the final volume ( reconstruction volume hereafter )",
    "is about @xmath73 , about 12% smaller than the original survey volume .",
    "other parameters used in the hmc are set to be the same as in paper i , and will not be repeated here .",
    "our hmc@xmath5pm makes calculations of a total 3000 hmc steps .",
    "the hmc system evolves quickly at the beginning , and achieves a convergent state after about 600 hmc steps .",
    "the typical scatter between @xmath53 and @xmath43 [ hereafter ts , defined as the r.m.s of @xmath74 after the 1000th step remains around 0.015 dex , indicating that after convergence the model density field match the input constraint very well . after convergence , the statistical properties of @xmath48 remain similar , so we only show the results at the 1500th step .",
    "the green dash - dotted line in the left panel of figure [ fig_ps ] shows the power spectrum of @xmath48 at the 1500th hmc step , which is in good agreement with the theoretical power spectrum used in the model .",
    "the right panel shows the probability distributions of the real and imaginary parts of @xmath48 for three different wave - numbers .",
    "these distributions closely match a gaussian distribution , demonstrating that our method recovers the gaussian property of the linear density field very well .          the linear density field output at the 1500th step is chosen to set up the initial condition for an @xmath4-body simulation .",
    "the initial condition is sampled with @xmath0 dark matter particles at an initial redshift of @xmath75 .",
    "the mass of each particle is @xmath76 . because the hmc process only generates the fourier models at @xmath77 ,",
    "the missing modes at larger @xmath78 are complemented by assigning random phases .",
    "the density field is then evolved to present day using l - gadget , a memory - optimized version of gadget-2 ( springel et al . 2005 ) .",
    "one hundred snapshots from @xmath79 to @xmath80 are produced , with the expansion factor evenly spaced in logarithmic space between successive snapshots .",
    "the simulation obtained this way is referred to as the constrained simulation ( hereafter cs ) in the following .    in the fifth panel of figure [ fig_drec ]",
    ", we show the present - day density field of the constrained simulation , @xmath81 . within the reconstruction volume , almost all large - scale structures , and even some small structures ,",
    "are well recovered .",
    "the typical scatter ( ts ) between @xmath43 and @xmath81 is 0.018 dex when smoothed on a scale of @xmath63 , only slightly larger than the ts between @xmath43 and @xmath53 .",
    "when the densities are smoothed on @xmath47 , the ts increases to about 0.13 dex .",
    "given the large dynamical range in density involved , about 2 orders of magnitude , this relatively low ts indicates that @xmath81 matches @xmath43 well even on scales down to @xmath82 .",
    "note , however , the scatter discussed here only represents the uncertainties arising from the hmc@xmath5pm method ; it does not include uncertainties caused by the other parts of the reconstruction discussed above . to estimate the full uncertainties of the constrained simulation",
    ", we have applied the reconstruction method to a realistic galaxy mock catalog ( see appendix ) .",
    "the ts between @xmath81 and the true density @xmath44 are 0.10 and 0.23 dex for @xmath63 and @xmath47 , respectively .",
    "recall that the ts between @xmath43 and @xmath44 are 0.09 dex and 0.20 dex for the two values of @xmath83 , respectively .",
    "this suggests that the major sources of the uncertainties are from the inaccuracies of the redshift - distortion correction , group finder , and halo - domain reconstruction .",
    "see the appendix for detailed discussions .",
    "in this section , we present some statistical properties of the constrained simulation .",
    "when necessary , the results obtained from an @xmath4-body simulation with random initial phases are used for comparisons .",
    "the reference simulation assumes the same cosmology as our constrained simulation and its density field is traced by @xmath84 particles in a cubic box of 300@xmath58 on a side .",
    "power spectra are often used to measure the mass clustering and to characterize the large scale structure . in figure [ fig_ps ] the power spectrum of the reconstructed linear density field",
    "is shown together with the power spectra of the constrained simulation ( cs ) at five different redshifts .",
    "the power spectra predicted by the linear pertubation theory and those of the reference simulation are also shown for comparison .",
    "as one can see , at the linear scales ( @xmath85 ) , the cs power spectra match the linear spectra very well . at smaller scales ,",
    "the cs power spectra are significantly higher than the linear spectra , and the difference increases with the decreasing redshift , clearly owing to non - linear evolutions of the density field .",
    "however , these cs spectra match with those of the reference simulation almost perfectly , suggesting that the constrained simulation reproduces well the large scale structures statistically .     at four different redshifts .",
    ", scaledwidth=50.0% ]    since morphology of the cosmic web is complicated ( figure [ fig_drec ] ) , the power spectrum alone is not sufficient to completely characterize a cosmic density field .",
    "recently , much effort has been giving to developing methods to classify the cosmic web ( e.g. hahn et al .",
    "2007 ; lavaux & wandelt 2010 ; hoffman et al . 2012",
    "; leclercq et al .",
    "2016 ) . here",
    "we employ a dynamical classification , first developed by hahn et al .",
    "( 2007 ) and refined by forero - romero et al .",
    "the basic idea is to use the eigenvalues of the tidal tensor ( or deformation tensor ) to define the type of the local structure in a cosmic web .",
    "the tidal tensor , @xmath86 , is defined as @xmath87 where , @xmath88 is the peculiar gravitational potential and can be calculated from the cs density perturbation ( @xmath89 ) through a modified poisson equation : @xmath90 note that this equation is scaled by @xmath91 and @xmath89 is defined over gird cells and smoothed on a comoving scale of @xmath47 .",
    "we derive the three eigenvalues of the tidal tensor , @xmath92 , at each grid point , and classify a grid point by counting the number of eigenvalues above a given threshold @xmath93 .",
    "a knot point corresponds to all the three eigenvalues being @xmath94 , while a filament point to two , a sheet point to one , and a void point to zero .",
    "the classification of the cosmic web at a given point depends on the choice of @xmath93 .",
    "it is still unclear which threshold value is the best . in figure",
    "[ fig_morth ] , we show the ratios of the volumes in the four types of structures to the whole volume ( the volume filling fraction ) as functions of @xmath93 at four different redshifts .",
    "generally , the volume filling fractions for knots , filaments and sheets decrease with increasing @xmath93 , while that for voids exhibits an opposite behavior . as discussed in forero - romero et al .",
    "( 2009 ) , the eigenvalues of the tidal tensor are not only dynamical quantities , but also reflect the collapse timescale along the corresponding eigenvectors .",
    "thus , these results reflect the collapse time distributions of the structures in three dimensions .",
    "interestingly , the volume filling fraction defined with @xmath95 show almost no variation with redshift .",
    "theoretically , @xmath96 corresponds to a very long collapse time , longer even than the hubble time ( forero - romero et al .",
    "it is thus not surprising that the fractions at @xmath95 are independent of redshift .",
    "however , the dependence of the filling fraction on @xmath93 varies significantly with redshift : the change tends to occur in a narrower range of @xmath93 at higher redshift . by definition @xmath97 .",
    "since the amplitude of the density fluctuation decreases with increasing redshift , the range of the three eigenvalues also decreases with increasing redshift , and so the behavior with @xmath93 is expected .",
    "the results for the reference simulation are presented for comparison .",
    "the fraction of filament ( sheet ) points in the constrained volume is slightly larger ( smaller ) than that in the whole box as well as in the reference simulation , likely because of cosmic variance .",
    "overall , the average properties of the cosmic web in the cs are very similar to those of the reference simulation .",
    "more discussions about the cosmic web and its classification will be presented later ( section [ sec_web ] ) .",
    "embedded in these large structures are virialized dark matter halos formed through non - linear gravitational collapse . in the current paradigm of galaxy formation , halos are thought to be the hosts within which galaxies form and reside .",
    "they thus provide a key link between galaxies and the cosmic density field ( e.g. mo et al . 2010 ) .",
    "understanding the properties of the halo population , therefore , is an important step towards understanding galaxy formation .",
    "furthermore , as demonstrated in paper i , if the structure formation model employed in the hmc is not sufficiently accurate , it can induce non - gaussian properties in the initial condition , which in turn can cause the predicted halo mass function to differ from what one expects to get from the model .",
    "thus , investigating the properties of the halo population provides additional test of the reconstruction method .",
    "we select halos from each snapshot with the standard friend - of - friends ( fof ) algorithm ( davis et al .",
    "1985 ) with a link length equal to 0.2 times the average particle separation .",
    "the halo mass , @xmath98 , is the sum of the masses of all particles in the halo .",
    "figure [ fig_hmf ] shows the halo mass functions in both the whole box and the reconstruction volume at five different epochs .",
    "our results excellently match the theoretical halo mass functions given by sheth et al .",
    "( 2001 ) , except for the highest redshift where the theoretical model predicts higher number density of halos .",
    "this discrepancy at high-@xmath3 is very similar to the finding of reed et al .",
    "( 2003 ) in their ( un - constrained ) simulations , suggesting that it is due to the inaccuracy of the model at high @xmath3 .",
    ".,scaledwidth=50.0% ]    halos grow hierarchically , with small halos forming first and merging to form large halos . after merger",
    ", the small halos may become substructures of the large one , producing a population usually called sub - halos .",
    "host halos / subhalos and their merger histories extracted from @xmath4-body simulations have served as the backbone for semi - analytical model of galaxy formation ( kang et al .",
    "2005 ; croton et al .",
    "2006 ; guo et al .",
    "2011 ; lu et al . 2011 ) and other empirical models , such as subhalo abundance matching ( kravtsov et al . 2004",
    "; vale & ostriker 2006 ; behroozi et al .",
    "2010 ) . to test the ability of our constrained simulation in reproducing the sub - halo population , we have identified sub - halos in all the fof halos and constructed merger trees for all halos and subhalos by using subfind and other relevant codes kindly provided by springel ( springel et al . 2005 ) . in figure [ fig_submf ]",
    ", we show the sub - halo mass function for host halos in four mass ranges .",
    "only sub - halos within the virial radii of their host halos and with more than 50 particles are counted .",
    "the mass functions have slopes very close to @xmath99 , in good agreement with results obtained previously ( e.g. gao et al .",
    "2004 ; diemand et al .",
    "the results for the reference simulation are also presented , both the amplitudes and shapes are in good agreement with the results from the cs .",
    "the full structure of a merger tree is complex and not easy to be presented in a simple way .",
    "here we track the main branch ( i.e. the most massive progenitor ) of a @xmath80 halo back in time until the time when the mass of the most massive progenitor is half of the final halo mass .",
    "the corresponding redshift , sometimes referred to as the formation redshift , is often used to represent the formation history of the halo .",
    "we show in figure [ fig_fz ] the distributions of the formation redshift for halo in three mass ranges .",
    "one can see that the distributions obtained from the cs match well those for reference simulation .        as a summary of this section , the statistical properties of our cs are very similar to those of general , unconstrained simulations , demonstrating that no significant bias is introduced by our reconstruction . with a resolution",
    "about 3 times as high as the widely - used millennium simulation ( springel et al .",
    "2005 ) , this simulation itself can be used to study many properties of the cosmic web ( density , velocity and tidal fields , etc . ) , to construct mock catalogs of galaxies , to model galaxy - galaxy lensing , to study halo formation and distribution , and to generate halo merger trees to model galaxy formation .",
    "more importantly , our constrained simulation is unique in that it can be used to study directly the formation of the structures we observe , and the relation between the mass density field and real galaxies .",
    "furthermore , it can also be used to set up zoom - in simulations in which the zoom - in region to be simulated with high resolutions needs to be designed so as to avoid contaminations by outside low - resolution particles during the evolution of the density field .",
    "since our reconstruction is based on the group catalog , it is expected that the cs density field to be tightly correlated with the spatial distribution of galaxy groups ( figure [ fig_drec ] ) . here",
    "we attempt to look for one - to - one correspondences between the groups and the fof halos identified from the cs . before doing this ,",
    "let us first look at the spatial distributions of groups and halos .",
    "the left panel of figure [ fig_dggh ] shows the distributions of groups and halos with masses above @xmath100 in a @xmath101 slice enclosing the sloan great wall . on large scales ,",
    "the spatial distribution of cs halos follows that of the groups very well . inspecting individual groups",
    ", we can find that almost all of the massive groups ( usually galaxy clusters ) have corresponding fof halos , however , their sizes and locations do not match perfectly . for systems of lower masses ,",
    "the match becomes worse , but they still appear to reside in similar large scale structures .        to match groups and halos in a more quantitative way , we construct a galaxy group list and a halo list .",
    "the group list contains all groups with @xmath16 in the reconstruction volume in decreasing order of group mass .",
    "note that the redshift distortion for these groups has been corrected ( section [ sec_hd ] ) .",
    "the halo list contains all fof halos in the cs ( with no limit on halo mass ) .",
    "for the first group ( the most massive one ) in the group list , we search in the halo list for halos with distances to the group less than @xmath102 and with mass satisfying @xmath103 . here",
    "@xmath104 and @xmath98 are group and halo masses , respectively . if no halo is found to satisfy the two criteria , the group is considered to have no match .",
    "otherwise , we choose the halo with the smallest @xmath105 as the corresponding halo of the group . finally the group is removed from the group list , and the corresponding halo from the halo list .",
    "the procedure is repeated for all groups .",
    "this procedure assumes that large groups have more priority in match a halo than small groups , and mass matching has more priority than distance matching .",
    "the groups that have corresponding halos are referred to as matched groups , otherwise unmatched groups .",
    "the number of matched pairs depends on the two free parameters , @xmath102 and @xmath106 . in figure",
    "[ fig_gf ] , we show the fraction of matched groups as a function of both @xmath102 and @xmath106 . not surprisingly , as @xmath102 and @xmath106 increase , the number of matched groups increases .",
    "about half of the groups with @xmath107 have matched halos with distances less than @xmath108 and @xmath109 .",
    "for @xmath110 ( the smoothing scale adopted in our hmc@xmath5pm ) and @xmath111 , then more than 95% of massive groups have halo matches . for comparison",
    ", we generate an uncorrelated halo sample by rotating the cs halos with a large angle .",
    "the matching results for the rotated halo sample are shown in red contours in figure [ fig_gf ] .",
    "one can see that the fraction of groups with matched halos is much smaller than 5% for the same two parameters .    ) and maximum mass difference ( @xmath112 ) for three group mass ranges .",
    "see the texts for details .",
    "the red lines show the results for uncorrelated halo sample , which is generated by rotating the cs halos with a large angle . ]    for groups with masses @xmath113 , the matching becomes worse . for @xmath110 , half of the groups have halo matches with @xmath114 , and about 80% of the groups have halo matches with @xmath111 .",
    "the corresponding fractions for the rotated halo sample are only 5% and 10% , respectively . for groups with @xmath115 , about 85% of groups are matched with cs halos with @xmath110 and @xmath111 .",
    "this does not mean that the matching is better for small halos , however , since for such a mass about 40% of the groups have matched halos in the rotated sample .",
    "small halos are also much more abundant , so the probability for a group to be matched with an uncorrelated halo is larger .    for low mass groups , the match with cs halos is only slightly better than with uncorrelated halos",
    "this suggests that the small scale modes in the initial condition are only partly recovered .",
    "however , as one can see from figure [ fig_dggh ] , small groups and cs halos also trace the same large - scale structures .",
    "this indicates that the statistical properties of the small groups are strongly correlated with small halos in the cs . in order to quantify such correlations",
    ", we compare the correlation between the number density of small groups and that of cs halos on different scales . to this end",
    ", we divide the cs box into cubes each with a size of @xmath116 on a side , and compute the number densities of groups , cs halos and halos in the rotated sample in each of the cubes .",
    "figure [ fig_ngh ] shows the density - density relation between groups and halos with masses in the range @xmath117 - @xmath118 for cubes with @xmath119 ( left panel ) and @xmath120 ( right panel ) , respectively . here",
    "only cubes with at least 90% of their volumes are contained in the reconstruction volume are included .",
    "as one can see , the number densities of cs halos are tightly correlated with those of groups without any significant bias , and the correlation becomes tighter as @xmath116 increases .",
    "in contrast , no visible correlation can be seen between groups and halos in the rotated sample .",
    "( left panel ) and 30@xmath58(right panel ) .",
    "only halos and groups with masses between @xmath121 and @xmath118 are taken into account .",
    "the solid gray lines indicate the perfect relation.,scaledwidth=50.0% ]    [ [ correlation - between - real - galaxies - and - mass - in - the - constrained - simulation ] ] correlation between real galaxies and mass in the constrained simulation ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    it is well known that galaxies are biased tracers of the cosmic density field ( e.g. peacock 1997 ; jing et al .",
    "the bias is found to depend on both galaxy luminosity and color ( norberg et al .",
    "2001 ; zehavi et al . 2002 ; li et al .",
    "thus , the study of the correlation between galaxies and mass contains important information about galaxy formation .",
    "almost all of the previous studies are concentrated on statistical measurements , such as ( cross ) correlation functions of galaxies . here",
    "we present a one - to - one comparison between galaxy and mass densities sampled on a grid of cube .    to facilitate comparisons with the cs",
    ", we need to correct for the redshift distortions for galaxies .",
    "our correction method consists of two steps .",
    "we first assign the group redshifts ( after correction , see section [ sec_crd ] ) to their member galaxies . then for each satellite galaxy , we assign a random offset relative to its group center , along the line of sight , based on nfw profile ( navarro et al . 1997 ) with mass - concentration relation given by zhao et al .",
    "the method can correct for both kaiser effect and fog effect , and make the spatial distribution of satellites within halos follow the nfw profile ( see shi et al .",
    "2016 for more details ) .",
    "the right panel of figure [ fig_dggh ] shows the cs density field and galaxy spatial distribution .",
    "we separate red and blue galaxies according to their binormal distribution in the @xmath122 color - absolute magnitude plane ( e.g. baldry et al .",
    "2004 ) , using the same separation line as proposed by yang et al .",
    "( 2009 ) : @xmath123 where @xmath124 are the absolute magnitude in the @xmath6 band .",
    "note that both @xmath125 and @xmath122 are @xmath126corrected and evolution - corrected to redshift @xmath127 .",
    "the galaxy distribution match the cs density field very well .",
    "in addition , red galaxies appear more tightly associated with high density regions than blue ones .     and @xmath89 are density contrasts for galaxies and mass , respectively .",
    "each dot point represents the mean density in a cubic box with @xmath119 .",
    "the open circles with error bars are the mean values of the dot points .",
    "the thin lines show @xmath128 , with @xmath129 0.6 , 0.8 , 1.0 , 1.2 , 1.5 , 2.0 , and 3.0 ( from left to right at @xmath130 ) , respectively .",
    "the thick lines are the best fits to the mean correlations . ]      to quantify the correlations in more detail , we select galaxies in three @xmath124 bins , @xmath131 , @xmath132 and @xmath133 , and separate each of them into red and blue subsamples .",
    "we estimate the galaxy density field for each galaxy subsample as follows .",
    "the galaxy subsample is embedded in the cs box and converted into a density field on a grid by using the clouds - in - cells ( cic ) assignment ( hockney & eastwood 1981 ) . for a given subsample , we estimate the limiting redshift of completeness ( @xmath134 ) using equation ( 6 ) in yang et al .",
    "( 2009 ) and the corresponding co - moving distance @xmath135 .",
    "the intersection between the reconstruction volume and the sphere with radius @xmath135 is referred to as the complete volume . here ,",
    "again , we divide the complete volume into equal - sized cubes . for each cube",
    ", the galaxy density contrast is defined to be @xmath136 , where @xmath137 is the galaxy density in the cube and @xmath138 is the mean galaxy density in the complete volume . using the same method",
    ", we also get the mass density contrast in each cube , @xmath89 . in the following ,",
    "we only consider the cubes that each have more than 90% of their volumes contained in the complete volume .",
    "figures [ fig_gd20 ] and [ fig_gd30 ] show @xmath139 versus @xmath140 on two different scales , @xmath141 and @xmath120 , for the six galaxy subsamples defined above .",
    "since the complete volume is different for different sub - samples , the number of cubes used varies .",
    "the galaxy density is strongly correlated with the cs mass density , and the scatter decreases with increasing @xmath116 .",
    "moreover , the galaxy density is biased with respect to the underlying mass density . to quantify this",
    ", we split each sample of cubes into several equal - sized subsamples according to @xmath89 , and compute the mean @xmath140 and @xmath139 for each subsample .",
    "the mean correlations are shown as open circles in the figures . the galaxy bias is usually interpreted in terms of halo bias ( e.g. mo et al . 1996 ) .",
    "we thus use the bias relation @xmath128 to fit the mean results , and show the best - fitting models in thick lines in the figure .",
    "the corresponding bias parameters are list in table  [ tab_bias ] .",
    "the relations with @xmath142 , @xmath143 , @xmath144 , @xmath145 , @xmath146 , @xmath147 , and @xmath148 are also plotted as references .    in general ,",
    "the mean correlations can be well fitted by the theoretical model , and the bias factor tends to be larger for higher luminosity and for red galaxies . in particular , the bias factors obtained here match well those obtained by zehavi et al .",
    "( 2011 ) , who measured the bias as the square root of the ratio of the two - point correlation functions between galaxies and dark matter assuming a fiducial cosmological model .",
    "inspecting closely the fitting curves , we find that the single - bias model fit the observational data better for red galaxies than for blue galaxies . moreover , for a given luminosity , the correlation also appears tighter for red galaxies .",
    "one possible explanation for these results is that , for a given luminosity , blue galaxies tend to reside in halos with a wider range of halo masses than red galaxies . in a future paper",
    ", we will investigate the correlation between the galaxy population and the reconstructed density and tidal fields in detail .",
    "finally , we compare the velocity fields derived from the cs ( @xmath149 ) with the true velocity in the original simulation ( @xmath150 ) .",
    "because the structures outside the reconstruction volume are unconstrained , the motion induced by these structures can not be properly recovered by our methods . the uncertainty caused by such effect",
    "is expected to be stronger near the boundary of the reconstruction volume . to quantify this effect",
    ", we define a parameter to indicate the distance to the boundary .",
    "following wang et al .",
    "( 2012 , see also section [ sec_ic ] ) , we use @xmath64 with @xmath151 to indicate the closeness of a grid to the boundary . for a grid cell close to the boundary the value of @xmath152",
    "is expected to be smaller than one , while for a grid cell located more than @xmath153 away from the survey boundary , @xmath154 .",
    "we divide the reconstruction volume into three parts according to the values of @xmath152 and examine them separately . furthermore , since the mass fluctuations on scales larger than our reconstruction volume may induce a bulk motion in the whole reconstruction volume , we also subtract the mean velocity in the whole reconstruction volume from all velocities used in our calculation .",
    "figure [ fig_mockv ] shows @xmath155 versus @xmath156 for grid cells in the inner region ( @xmath157 ) , the intermediate region ( @xmath158 ) and the boundary region ( @xmath159 ) .",
    "here , @xmath149 and @xmath150 represent a single velocity component along one of the three axes of the cartesian coordinates , and @xmath160 and @xmath161 are the corresponding mean velocities in each of the @xmath162 regions ( their absolute values are less than @xmath163 ) .",
    "since the results for the three velocity components are similar , we plot them together .",
    "the velocity fields shown in the figure are smoothed with @xmath63 . in the inner region , the reconstructed velocity is linearly correlated with the true velocity , with slope very close to unity . the typical scatter , in terms of r.m.s in @xmath164 , is about 80@xmath165 . as @xmath65 decreases , the slope remains around unity , but the scatter increases . for grid cells in the intermediate and boundary regions , the values of the scatter are @xmath166 and @xmath167 , respectively .",
    "when smoothed with a smaller @xmath83 of @xmath47 , the scatter increases only slightly to @xmath168 , @xmath169 and @xmath170 for the three @xmath162 regions .",
    "note that the volumes of the inner , intermediate and boundary regions are 45% , 31% and 24% of the total reconstruction volume , respectively .",
    ", which is used to indicate the closeness to the boundary ( see text for definition ) .",
    "the dashed lines indicate a perfect relationship .",
    "all the velocity fields are smoothed on a scale of @xmath171.,scaledwidth=70.0% ]    we have also checked the dependence of the uncertainties in the density and tidal fields on @xmath65 .",
    "the uncertainties for the two quantities are found to be almost independent of the distance to the boundary so we do not show the results .",
    "note that all of these uncertainties are estimated at @xmath80 , and listed in table [ tab_err ] ."
  ],
  "abstract_text": [
    "<S> a method we developed recently for the reconstruction of the initial density field in the nearby universe is applied to the sloan digital sky survey data release 7 . </S>",
    "<S> a high - resolution n - body constrained simulation ( cs ) of the reconstructed initial condition , with @xmath0 particles evolved in a @xmath1 box , is carried out and analyzed in terms of the statistical properties of the final density field and its relation with the distribution of sdss galaxies . </S>",
    "<S> we find that the statistical properties of the cosmic web and the halo populations are accurately reproduced in the cs . </S>",
    "<S> the galaxy density field is strongly correlated with the cs density field , with a bias that depend on both galaxy luminosity and color . </S>",
    "<S> our further investigations show that the cs provides robust quantities describing the environments within which the observed galaxies and galaxy systems reside . </S>",
    "<S> cosmic variance is greatly reduced in the cs so that the statistical uncertainties can be controlled effectively even for samples of small volumes . </S>"
  ]
}