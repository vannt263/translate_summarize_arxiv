{
  "article_text": [
    "hyperspectral imaging from space - borne spectrometers has a multitude of applications , such as terrain analysis , material identification , military surveillance , etc .",
    "the ever growing spectral and spatial resolution of such instruments poses challenges in handling such wealth of information .",
    "in particular , onboard compression is of paramount importance to overcome the limited downlink bandwidth .",
    "this is a very active area of research as it poses peculiar challenges , not encountered elsewhere .",
    "in fact , onboard compression algorithms face strict complexity limitations due to constraints on the payload hardware . several solutions based on different techniques",
    "have been proposed , such as low - complexity spatial @xcite and spectral transforms @xcite , distributed source coding @xcite , compressed sensing @xcite , and predictive coding @xcite .",
    "predictive coding is one of the most popular solutions , as it enables low - complexity , high - throughput solutions , and excellent rate - distortion performance .",
    "one of the most recent recommendations by the consultative committee for space data systems ( ccsds ) is a lossless compression algorithm based on predictive coding @xcite and an extension to lossy compression is ongoing .",
    "lossy predictive coding is typically operated in the so - called near - lossless mode , where the maximum absolute error on the reconstructed pixels is bounded by a constant . however , near - lossless compression has some drawbacks , the most notable being a variable output rate dependent on the image content . in our previous works",
    "@xcite we showed that it is possible to perform simultaneous rate and quality control with a complexity compatible with resources available onboard of spacecrafts . in this letter , we propose a significantly improved rate control algorithm with respect to @xcite .",
    "the main contribution is that the new algorithm is extremely fast and lightweight with respect to @xcite and this allows mainly to _ i _ ) save hardware resources that could be dedicated to other purposes ( or not used thus saving power ) , compared e.g. with the solution in @xcite which requires a dedicated board , running in parallel to the compressor ; _ ii _ ) enable very high throughput implementations , while the original algorithm may have caused bottlenecks in such scenarios because of some complex rate - distortion optimization operations .",
    "we test the proposed algorithm by extending the ccsds-123 recommendation , but the method is general and can be applied to any predictive encoder .",
    "this section reviews the rate control algorithm originally proposed in @xcite and further developed in @xcite .",
    "the goal of the algorithm is to control the output rate of a predictive encoder of hyperspectral and multispectral images , under low complexity and memory constraints . to be best of our knowledge",
    "this is the only work on rate control for onboard predictive coding .",
    "however rate control algorithms are often used either onground @xcite or onboard @xcite in transform coding schemes .",
    "the algorithm in @xcite selects quantizers operating on the prediction errors in predefined spatial and spectral regions .",
    "the rate control algorithm works on a slice - by - slice basis , where we call `` slice '' a predefined number of lines with all their spectral channels .",
    "each band of each slice is divided into nonoverlapping @xmath0 blocks .",
    "the rate control algorithm assigns a quantization step size for each of the blocks in each spectral band in order to meet the target rate with the lowest distortion .",
    "this is done via a two - stage process consisting of :    * training stage : unquantized prediction residuals in each block are modeled as realizations of independent and identically distributed laplacian random variables .",
    "the sample variance is estimated in order to predict the rate as function of the quantization step size .",
    "the rate function is stored in a lookup table ( lut ) as it is too complex to implement directly . *",
    "optimization stage : a greedy optimization algorithm is employed to select the quantization step sizes that allow achieving the target rate with the lowest distortion .",
    "the training stage requires to run the predictor twice for each slice , once to estimate the variance of the unquantized prediction residuals , then one more time in order to perform the actual coding which also quantizes the residuals with the step sizes computed by the rate controller .",
    "this dual prediction stage can be performed in series to the coding process , as in the original algorithm , or in parallel , as in @xcite , by having an independent module that works ahead of the coding process .",
    "furthermore , the algorithm measures the actual rate produced by encoding the slice with the computed quantization step sizes and uses this information to update the target rate for the next slices .",
    "this mode of operation has been shown to effectively correct inaccuracies in the model without reducing the rate - distortion performance .",
    "in @xcite the authors simplify the rate control algorithm by eliminating the rate - distortion optimization phase and working on line - by - line basis instead of blocks .",
    "this idea is also used in this work , which however solves major drawbacks of the method proposed in @xcite .",
    "the method proposed in this letter improves over @xcite,@xcite,@xcite by introducing the following novel points :    * choosing just one quantization step size per spectral line , which avoids complex rate - distortion optimization algorithms ( also present in @xcite ) ; * on - the - fly estimation of the residual statistics , which avoids running the predictor twice , with significant gains in terms of speed ; * simpler arithmetic that does not involve squaring operations to compute the statistical parameters ; * simpler arithmetic speeding up access to the rate lut ; * reduced number of lut lookups .",
    "in this section we explain the main novel contributions of this work .",
    "the goal is to design a lightweight rate control algorithm that is capable of providing accurate control of the output rate of a predictive encoder while being , at the same time , simple to implement in hardware , and fast in order to enable high - throughput implementations .",
    "[ fig : diagram ] shows a high - level diagram of the proposed method and its interaction with a predictive encoder .",
    "the main operations are described in the following subsections . in the following the term _ spectral line",
    "_ refers to a row of pixels with all its spectral channels .",
    "it can be noticed that the algorithm proceeds one spectral line at a time and that different operations are performed depending on the spatial location of the pixel under coding .",
    "for the sake of simplicity , the following description assumes that the pixels are read and coded in band - interleaved - by - line ( bil ) order .",
    "the objective of the algorithm is to encode the current spectral line , thus producing entropy - coded versions of quantized prediction residuals and to decide the quantization step size to be used to encode next spectral line .",
    "a single quantization step size @xmath1 is used for each spectral line .",
    "the use of a single quantization step size @xmath1 of a uniform scalar quantizer for each spectral line is at the core of the algorithm .",
    "it is necessary to have a statistical characterization of the prediction residuals in each band in order to choose the value of @xmath1 yielding the desired target rate .",
    "the statistics of prediction residuals of adjacent spectral lines are highly correlated and therefore it is possible to use the statistics of the current spectral line as a prediction for the statistics of next line .",
    "we assume that the unquantized prediction residuals are realizations of i.i.d .",
    "laplacian random variables .",
    "the laplacian distribution ( @xmath2 ) is characterized by a single parameter @xmath3 .",
    "notice that the @xmath3 parameter is also related to the variance @xmath4 through @xmath5 .",
    "the magnitude of a laplace random variable follows an exponential distribution of parameter @xmath3 , and the sample mean is the unbiased maximum likelihood estimator of @xmath6 . however , this is not a robust estimator @xcite . replacing it with the sample median",
    "has several advantages , including robustness to outliers ( the residuals are far from perfectly i.i.d .",
    "laplacian ) , and simpler arithmetic ( avoids division by the length @xmath7 of the line ) . computing the exact median of the prediction residuals of an entire row would require a sorting operation of complexity @xmath8 .",
    "a good approximation can be obtained with the median of medians algorithm @xcite which breaks down a row into non - overlapping subsets of @xmath9 contiguous residuals .",
    "the median of each subset is computed and then the median of medians provides an approximation of the true median of the row .",
    "this approach reduces the complexity to @xmath10 .",
    "the parameter @xmath9 is set as a compromise of several objectives .",
    "in fact , @xmath9 should be large enough that the approximation to the median by means of the median of median is satisfactory .",
    "however , a large @xmath9 increases the complexity of the calculation .",
    "a good design should approximately balance the complexity of the local median operations ( each costing @xmath11 ) and the complexity of the final median performed at the end of the row ( costing @xmath12 ) for the typical width of an image , so that throughput is maximized by the absence of bottlenecks .",
    "the coding and estimation jobs proceed together . following the notation of fig .",
    "[ fig : diagram ] , pixels of type a entropy - code the current quantized prediction residual of the current pixel but also store in a temporary buffer the unquantized residual .",
    "the encoder reaches a type - b pixel after @xmath13 type - a pixels and the temporary buffer holds the unquantized prediction residuals for that subset of type - a pixels . after the computation of the unquantized residual for the type - b pixel ,",
    "the median of the buffer is computed and stored in the buffer of medians .",
    "this sequence of @xmath13 pixels of type a terminated by a type b pixel is repeated until the end of the row . the row is terminated by a pixel of type c , which computes both the median for the local subset of pixels and the median of medians . each band",
    "@xmath14 stores its own median of medians @xmath15 .",
    "the last pixel in the last band is of type d and it uses all the medians of medians to run the procedure to determine the quantization step size to be used for the next spectral line",
    ".    there are several important differences with the algorithms in @xcite .",
    "in particular , a major shortcoming of those algorithms is the need to run the predictor twice , once for estimation of the statistics and once for the actual coding .",
    "moreover , they adopt a more computationally expensive approach to parameter estimation by computing the sample variance @xmath4 of the unquantized prediction residuals , and then using it to compute @xmath3 .",
    "this process requires some computational effort when performed with integer arithmetic and is subject to numerical approximations .",
    "@xmath16 @xmath17 prediction of pixel @xmath18 residual @xmath19 @xmath20 median(@xmath21 ) @xmath22 quantized @xmath23 @xmath24 median(@xmath25 ) measure actual output rate update @xmath26 using eq .",
    "( 14 ) from @xcite @xmath27 @xmath28 @xmath29 @xmath30 @xmath28 @xmath31 @xmath29 @xmath31 @xmath28 @xmath30    the procedure that assigns the quantization step sizes is extremely lightweight in order to provide the fastest implementation possible .",
    "it takes as input the set @xmath32 of the medians of medians for all the bands .",
    "the procedure uses a rate lut to find the odd integer - valued quantization step size @xmath33 such that : @xmath34 i.e. , the one providing a total rate for the line and all its spectral channels closest to the target rate @xmath35 . the rate lut implements the following formula ( from @xcite ) , which is the entropy of an i.i.d .",
    "laplacian source quantized with a uniform scalar quantizer of step size @xmath1 and parameter @xmath36 .",
    "@xmath37\\end{aligned}\\ ] ] the proposed method uses two variables , namely @xmath38 and @xmath39 , to index the rate lut that is treated as a two - dimensional matrix storing the values of @xmath40 precomputed using eq .. notice that using @xmath41 instead of @xmath1 as index for the lut is slightly more efficient ( one fewer bit of dynamic range ) .",
    "this technique is faster than the one used in @xcite which uses a single - variable indexing .",
    "indeed the rate depends only on the product @xmath42 and the parameter estimation algorithm of @xcite directly returns @xmath3 .",
    "however , computing the correct position in the table in such manner is inefficient because it requires to perform a multiplication every time @xmath1 or @xmath3 are changed .",
    "moreover , the rate function was sampled at predefined values of @xmath42 and a suitable mapping of the product @xmath42 provided at runtime with the closest in the lut had to be computed .",
    "the proposed method overcomes such limitations by exploiting the fact that @xmath38 is discrete - valued and with limited dynamic range as well as not requiring any index calculation .",
    "a further optimization is included to minimize the number of lut lookups .",
    "the procedure that determines the quantization step size for the following spectral line uses the last chosen quantization step size as a prediction for the next one .",
    "then it checks if such quantization step size yields a rate above or below the target , consequently deciding whether to increase it or decrease it .",
    "since the quantization step sizes used in successive spectral lines are expected to be close , this strategy minimizes the expected number of times the memory storing the lut is queried to compute @xmath40 , thus reducing latency .    as a final remark , in a tradeoff between efficiency and available features",
    ", some characteristics of the algorithm in @xcite have been traded for increased speed .",
    "in particular , the original algorithm performed simultaneous control of rate and quality on image blocks , thus enabling the definition of spatial as well as spectral regions of interest with different rate - distortion policies .",
    "this feature is partially lost in the faster version as a single quantization step size is used for all the bands of a line .",
    "the full algorithm , including both estimation of the statistics of residuals and computation of the quantization step sizes , is reported in algorithm [ alg : ratecontrol ] .",
    "notice that the initialization of @xmath43 may be different from @xmath44 and , depending on the particular target rate , a higher @xmath1 might be appropriate .",
    ".test images [ cols=\"^,^,^,^,^,^,^ \" , ]",
    "we proposed a novel rate control algorithm for predictive coding of hyperspectral images onboard of spacecrafts and tested it by integrating it into a lossy extension of the ccsds-123 recommendation .",
    "the proposed algorithm loses some flexibility with respect to @xcite in terms of spatial modulation of quantization step sizes , but it is orders of magnitude faster enabling simpler and higher throughput implementations , while providing comparable or better image quality .",
    "a.  abrardo , m.  barni , e.  magli , and f.  nencini , `` error - resilient and low - complexity onboard lossless compression of hyperspectral images by means of distributed source coding , '' _ ieee trans .",
    "remote sens .",
    "_ , vol .",
    "48 , no .  4 , pp . 18921904 , 2010 .",
    "a.  barducci , d.  guzzi , c.  lastri , v.  nardino , i.  pippi , and v.  raimondi , `` compressive sensing for hyperspectral earth observation from space , '' _ international conference on space optics _ , vol .  7 , p.  10",
    ", 2014 .",
    "f.  rizzo , b.  carpentieri , g.  motta , and j.  a. storer , `` low - complexity lossless compression of hyperspectral imagery via linear prediction , '' _ ieee signal process .",
    "_ , vol .  12 , no .  2 ,",
    "pp . 138141 , 2005 .",
    "b.  aiazzi , p.  alba , l.  alparone , and s.  baronti , `` lossless compression of multi / hyper - spectral imagery based on a 3-d fuzzy prediction , '' _ ieee trans .",
    "remote sens .",
    "_ , vol .",
    "37 , no .  5 , pp . 22872294 , 1999 .",
    "d.  valsesia and e.  magli , `` a novel rate control algorithm for onboard predictive coding of multispectral and hyperspectral images , '' _ ieee trans .",
    "remote sens .",
    "_ , vol .",
    "52 , no .",
    "10 , pp . 63416355 , oct 2014 .",
    " , `` a hardware - friendly architecture for onboard rate - controlled predictive coding of hyperspectral and multispectral images , '' in _ 2014 ieee int . conf . on image processing _ , oct 2014 , pp . 51425146",
    "a.  said and w.  a. pearlman , `` a new , fast , and efficient image codec based on set partitioning in hierarchical trees , '' _ ieee trans .",
    "circuits syst .",
    "video technol .",
    "_ , vol .  6 , no .  3 , pp .",
    "243250 , jun 1996 .",
    "m.  conoscenti , r.  coppola , and e.  magli , `` constant - snr , rate control and entropy coding for predictive lossy hyperspectral image compression , '' _ ieee trans .",
    "remote sens .",
    "_ , ( accepted for publication ) .",
    "e.  magli , g.  olmo , and e.  quacchio , `` optimized onboard lossless and near - lossless compression of hyperspectral data using calic , '' _ ieee geosci .",
    "remote sens .",
    "_ , vol .  1 , no .  1 ,",
    "2125 , jan 2004 ."
  ],
  "abstract_text": [
    "<S> predictive coding is attractive for compression of hyperspecral images onboard of spacecrafts in light of the excellent rate - distortion performance and low complexity of recent schemes . in this letter </S>",
    "<S> we propose a rate control algorithm and integrate it in a lossy extension to the ccsds-123 lossless compression recommendation . </S>",
    "<S> the proposed rate algorithm overhauls our previous scheme by being orders of magnitude faster and simpler to implement , while still providing the same accuracy in terms of output rate and comparable or better image quality .    </S>",
    "<S> valsesia : fast and lightweight rate control for onboard predictive coding of hyperspectral images    rate control , predictive coding , hyperspectral images </S>"
  ]
}