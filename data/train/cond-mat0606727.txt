{
  "article_text": [
    "the basic problem in equilibrium statistical mechanics is to compute the phase space average , in which monte carlo method plays a very important role @xcite . among all admissible statistical ensembles used with the above purpose ,",
    "the microcanonical ensemble provides the most complete characterization of a given system in thermodynamic equilibrium .",
    "while microcanonical calculations based on microscopic dynamics can suffer from the existence of metastable states with large relaxation times @xcite , the available monte carlo methods based on reweighting technics ( such as the multicanonical monte carlo @xcite ) are also so much machine - time consuming due to they try to obtain the density of states for all values of energy in only one run .",
    "it is very well known that the microcanonical observables can be suitably obtained by using the canonical ensemble whenever _ ensemble equivalence _ takes place in a sufficient large system .",
    "one of the most famous and widely used monte carlo algorithm considering the gibbs canonical ensemble is the metropolis importance sampling algorithm @xcite .",
    "this method has some important features .",
    "it is extremely general and each moves involves @xmath0 operations .",
    "however , its dynamics suffers from _ critical slowing down , _ that is , if @xmath1 is the system size , the correlation time @xmath2 diverges as a critical temperature is approached : the divergence follows a power law behavior @xmath3 in second - order phase transitions , while @xmath2 diverges exponentially with @xmath1 in first - order phase transitions as consequence of the ensemble inequivalence ( multimodal character of the energy distribution function ) .",
    "the aim of the present letter is to develop a new methodology in which the local algorithm metropolis monte carlo could be used for performing microcanonical calculations by avoiding the anomalous behaviors associated with the presence of a first order phase transition in a given energetic region .",
    "the key of our method is to consider certain generalized canonical - like ensemble which is equivalent to the microcanonical ensemble for @xmath1 large enough in spite of the presence of a first - order phase transition , a methodology inspired by our recent paper @xcite .",
    "let us consider a given hamiltonian system @xmath4 becoming extensive in the thermodynamic limit @xmath5 . as already commented , the basic idea of our method is to substitute the gibbs canonical ensemble by the following _ generalized canonical ensemble _ : @xmath6 where @xmath7 , being @xmath8 certain analytical _ bijective function _ of the energy per particle of the system @xmath9 .    the _ planck potential _ @xmath10 associated with the partition function:@xmath11 can be estimated for @xmath1 large by using the steepest descend method as follows:@xmath12 where @xmath13 is the entropy per particle of the system , being @xmath14 the microcanonical accessible volume , and @xmath15 , the _ only one _ stationary energy of the maximization problem @xmath16 whose stationary conditions demand:@xmath17 we found by combining ( [ c1 ] ) and ( [ c2 ] ) that the necessary and sufficient condition for the existence of a unique stationary point of the above maximization problem for any @xmath18 is given by:@xmath19 which has to be applicable for all those admissible values of the energy per particle @xmath20 .",
    "this condition can be rephrased by considering the inverse function @xmath21 of the bijective function @xmath8 , and taking the entropy @xmath22 as a _",
    "scalar function _ which is now rewritten in terms of the variable @xmath23:@xmath24   \\rightarrow-\\left (   \\frac{\\partial\\varphi\\left (   \\varepsilon\\right ) } { \\partial\\varepsilon}\\right )   ^{2}\\frac{\\partial^{2}s\\left (   \\varphi\\right ) } { \\partial\\varphi^{2}}>0 , \\label{maincond}%\\ ] ] which clarifies us that the entropy must be a concave function in this last parametrization .",
    "the approximation ( [ legendre ] ) in the thermodynamic limit is just the legendre transformation between the thermodynamic potentials , @xmath25 with @xmath26 , which takes place as a consequence of the equivalence between the generalized canonical ensemble ( [ gce ] ) and the microcanonical ensemble .",
    "thus , _ we can ensure the ensemble equivalence for all energy values by using an appropriate bijective function _",
    "@xmath8 _ without mattering about the presence of a first - order phase transition_. this remark is precisely the key of the metropolis algorithm described below .    considering the analogy with the gibbs canonical ensemble , the generalized canonical ensemble represents a system in which the parameter @xmath18 associated with the macroscopic observable @xmath27 is keeping fixed by means of certain external experimental arrangement .",
    "the state above is just a consequence of the reparametrization invariance of the microcanonical ensemble : the microcanonical description does not depend on the reparametrization @xmath28 used for describing the equilibrium thermodynamical states of the system .",
    "we only discuss in the present work the applicability of this symmetry in improving the ordinary metropolis importance sampling algorithm based on the gibbs canonical ensemble ( hereafter mmc ) , but the interested reader can see the recent paper @xcite about the implication of the reparametrization invariance in the searching of a topological classification scheme of the phase transitions",
    ".    generally speaking , the main difference between the mmc and the metropolis algorithm based on the reparametrization invariance ( hereafter gcmmc ) is the using of the canonical - like weight @xmath29 .",
    "therefore , the probability @xmath30 for the acceptance of a metropolis move is given by:@xmath31",
    "\\right\\ }   \\right\\ } \\nonumber\\\\ &   \\simeq\\min\\left\\ {   1,\\exp\\left [   -\\eta\\frac{\\partial\\varphi\\left ( \\varepsilon\\right )   } { \\partial\\varepsilon}\\delta\\varepsilon-\\frac{1}{2n}% \\eta\\frac{\\partial^{2}\\varphi\\left (   \\varepsilon\\right )   } { \\partial \\varepsilon^{2}}\\delta\\varepsilon^{2}\\right ]   \\right\\ }   , \\label{paso}%\\end{aligned}\\ ] ] in which all @xmath32 contributions in the exponential argument have been dismissed .",
    "while every energy decreasing @xmath33 is always accepted in the mmc , such probability decreases in the gcmmc due to the presence of the quadratic term in the exponential argument of ( [ paso ] ) , although such effect decreases with the @xmath1 increasing .",
    "obviously , when @xmath1 is large enough , the expression of the acceptance probability of the gcmmc differs effectively from the one used in the mmc by the consideration of a _ variable canonical parameter _",
    "@xmath34:@xmath35 which fluctuates around the microcanonical value @xmath36 derived from the condition ( [ c1 ] ) .",
    "taking into account the sharp gaussian localization of the integral ( [ partition ] ) in the thermodynamic limit , the dispersion @xmath37 can be estimated in terms of the energy dispersion @xmath38 as follows:@xmath39 where @xmath40 denotes the average over the ensemble ( [ gce ] ) .",
    "considering the gaussian estimation of the energy dispersion as @xmath41 with @xmath42 given in ( [ c2 ] ) , the equation ( [ v1 ] ) can be rewritten in the following form:@xmath43    this expression is a very nice result which talks about the limits of precision in a general calculation of the caloric curve by using a local algorithm based on the generalized canonical ensemble ( [ gce ] ) : while temperature can be fixed ( @xmath44 ) wherever the entropy is a concave function , the inverse temperature dispersion @xmath45 can not vanish wherever the entropy be a convex function in terms of energy @xmath20 .",
    "supercritical slowing down associated with the mmc method based on the gibbs canonical ensemble is precisely related with the downfall of the gaussian estimation of the energy dispersion @xmath46 whenever the second derivative of the entropy goes to zero and becomes nonnegative .",
    "it is very interesting to notice that the complementary macroscopic observables energy and temperature obey the _ uncertainly relation _ @xmath47 wherever @xmath48 , which is rather analogue to the quantum mechanics uncertainly relation @xmath49 .",
    "a better analysis allows us to obtain the inequalities @xmath50 whenever entropy @xmath51 be a concave function , while @xmath52 when entropy is convex .",
    "as already commented , the success of the gcmmc methods relies on the selection of a good bijective function @xmath8 satisfying the condition ( [ maincond ] ) , which obviously can be done by following different schemes .",
    "for example , we can rephrase the stationary condition ( [ c1 ] ) as @xmath53 and substitute it in ( [ maincond ] ) .",
    "the resulting equation expresses the monotonic decreasing of the dependence @xmath18 _ versus _ the energy per particle @xmath20 : @xmath54 which talks about a bijective correspondence between @xmath18 and @xmath20 as a consequence of the ensemble equivalence .",
    "this last demand suggests us the implementation of an indirect monte carlo method based on the generalized canonical ensemble ( [ gce ] )  where an arbitrary dependence @xmath55 satisfying the above condition be assumed _ a priory _ , but the unknown associated bijective function @xmath56 must be reconstructed by using reweighting schemes analogue to the ones used in the multicanonical calculations @xcite . nevertheless , we are interested in the present work in the implementation of a variant of the metropolis algorithm with acceptance probability ( [ paso ] ) where the bijective function @xmath56 will be proposed _ a priory _ in order to avoids the ensemble inequivalence in a hamiltonian system with short - range interactions .",
    "let us assume that the interest system  exhibits an ensemble inequivalence inside the energy interval @xmath57 , where @xmath58 .",
    "the microcanonical parameter @xmath59 will change slowly with the energy @xmath20 in this region due to @xmath60 in the first - order phase transitions ( see in the application example described in the next section ) , so that , @xmath61 where @xmath62 is the inverse critical temperature . assuming this last relation as a first approximation , its substitution in the condition of the ensemble equivalence ( [ c2 ] ) yields : @xmath63 with @xmath64 .",
    "this demands is very easy to satisfy by considering the function @xmath65 as a large enough positive constant , @xmath66 .",
    "this assumption allows us to propose the first derivative of the bijective function @xmath8 as follows:@xmath67{cc}% 1 & \\text{if } \\left\\langle \\varepsilon\\right\\rangle > \\varepsilon_{2},\\\\ \\exp\\left (   -\\lambda\\left (   \\varepsilon_{2}-\\varepsilon\\right )   \\right )   & \\text{if } \\left\\langle \\varepsilon\\right\\rangle \\in\\left (   \\varepsilon _ { 1},\\varepsilon_{2}\\right )   , \\\\",
    "\\exp\\left (   -\\lambda\\left (   \\varepsilon_{2}-\\varepsilon_{1}\\right )   \\right )   & \\text{otherwise,}% \\end{array } \\right .",
    "\\label{chita}%\\ ] ] which should avoid the ensemble inequivalence within the energetic range @xmath57 . since @xmath68 is a constant when @xmath69 or @xmath70 , the gcmmc becomes  in the mmc algorithm outside the interval @xmath57 .",
    "although the piecewise function @xmath71 is referred in terms of the instantaneous values of the energy @xmath20 in the metropolis dynamics , we propose in  ( [ chita ] ) that the selection of the interval during the whole computation of the microcanonical averages at a given energy depends on the average energy @xmath72 instead of the instantaneous values @xmath20 .",
    "it can be numerically checked that the existence of any abrupt change in the first derivatives of the function @xmath71 in the acceptance probability ( [ paso ] ) can provoke a significant perturbation in the convergence of the second derivative of the entropy ( associated with the heat capacity ) by using the gcmmc when the instantaneous energy @xmath20 is close to @xmath73 or @xmath74 .",
    "however , the using of @xmath75 instead of the instantaneous value @xmath20 allows the function @xmath71 to exhibit a smooth behavior beyond the interest energy interval @xmath76 during the metropolis dynamics .    in order to obtain a caloric curve @xmath77",
    "_ versus _ @xmath20 with approximately @xmath78 points with @xmath75 more or less uniformly distributed in the interval @xmath79 , the canonical parameter @xmath18 can be increased as follows:@xmath80{cc}% \\eta_{i}+c & \\text{if } \\left\\langle \\varepsilon\\right\\rangle",
    "> \\varepsilon _ { 2},\\\\ \\eta_{i}\\exp\\left (   \\frac{1}{m}\\lambda\\left (   \\varepsilon_{2}-\\varepsilon _ { 2}\\right )   \\right )   & \\text{if } \\left\\langle \\varepsilon\\right\\rangle \\in\\left (   \\varepsilon_{1},\\varepsilon_{2}\\right )   ,",
    "\\\\ \\eta_{i}+c\\exp\\left (   \\lambda\\left (   \\varepsilon_{2}-\\varepsilon_{1}\\right ) \\right )   & \\text{otherwise,}% \\end{array } \\right .",
    "\\label{eta}%\\ ] ] where @xmath81 in the @xmath77 step outside the interest energy interval @xmath82 .",
    "the reader may notice by reexamining the equation ( [ condition_lambda ] ) that a very large value of the numeric constant @xmath83 leads to a very small energy dispersion @xmath84 , provoking  in this way an increasing of the inverse temperature dispersion @xmath45 as a consequence of the uncertainly relation ( [ v2 ] ) .",
    "an appropriate prescription of @xmath83 in order to minimize the dispersion @xmath85 in the caloric curve ( @xmath20 and @xmath77 in dimensionless units ) is given by:@xmath86    taking into consideration all the above exposed , microcanonical caloric curve @xmath87 can be obtained by using our gcmmc methods as follows:@xmath88   = \\eta\\left\\langle \\xi\\left (   \\varepsilon\\right )   \\right\\rangle \\pm\\delta\\beta , \\label{w1}%\\ ] ] where @xmath89 while the second derivative of the entropy or curvature @xmath90 can be given by:@xmath91 in accordance with the equation ( [ v2 ] ) .",
    "the error @xmath92 in the curvature after @xmath93 metropolis iterations can be estimated by the formula : @xmath94 where @xmath2 is the decorrelation time , that is , the minimum of monte carlo iterations necessary to generate effectively independent , identically distributed samples in the metropolis dynamics .",
    "let us apply the gcmmc method in order to perform the microcanonical description of a potts model @xcite : @xmath95 on a two dimensional lattice ( here with periodic boundary conditions ) of @xmath96 spins with @xmath97 possible values ( components ) .",
    "the sum is over pairs of nearest neighbor lattice points only and @xmath98 is the spin state at the _ i - th _ lattice point . generally speaking",
    ", this model system admits a ferromagnetic interpretation by introducing the bidimensional vector variables @xmath99   $ ] with @xmath100 , and defining the total magnetization  as follows @xmath101 .    as elsewhere shown , the @xmath97 states potts model exhibits a first - order phase transition associated to the ensemble inequivalence , which provokes the existence of a supercritical slowing down during the ordinary metropolis dynamics based on the consideration of the gibbs canonical ensemble .",
    "clusters algorithms , like swendsen - wang or wolf algorithms @xcite , do not help in this case @xcite due to they are still based on the consideration of the canonical ensemble , and consequently , the supercritical slowing down associated to the ensemble inequivalence persists @xcite .",
    "[ t ]    potts.eps    this difficulty is successfully overcome by using the multicanonical monte carlo method @xcite , which reduces the exponential divergence of the correlation times with respect to system size to a power at the first - order phase transitions @xcite .",
    "multicanonical ensemble flattens out the energy distribution , which allows the computation of the density of states @xmath102 for all values of @xmath103 in only one run .",
    "this feature of the multicanonical ensemble becomes a disadvantage when we are also interested in the direct computation of the microcanonical average of other microscopic observables at a given value of the energy , i.e. the magnetization density dependence @xmath104 of the potts model ( [ h ] ) with @xmath97 .",
    "this aim can be easily performed by using the gcmmc algorithm .",
    "[ t ]    gc_sw.eps    a preliminary calculation by using the mmc allows us to set the interest energetic window with @xmath105 and @xmath106 in which takes place the critical slowing down associated with the existence of a first - order phase transition in this model for @xmath107 .",
    "the inverse critical temperature was estimated as @xmath108 , allowing us to set @xmath109 . besides , we also set @xmath110 and @xmath111 in the @xmath18 increasing given by the equation ( [ eta ] ) .",
    "the caloric @xmath112 and curvature @xmath113 curves obtained by using the gcmmc algorithm with @xmath114 metropolis iterations for each point is shown in the fig.[potts ] . a comparative study between the present method and the swendsen - wang clusters algorithm @xcite",
    "is shown in the fig.[gc_sw.eps ] .",
    "the backbending in the caloric curve @xmath77 _ versus _",
    "@xmath20 is directly associated to the existence of a negative heat capacity @xmath115 when @xmath116 with @xmath117 and @xmath118 , which is a feature of a first - order phase transition in a small system becoming extensive in the thermodynamic limit .",
    "since the heat capacity is always positive within the canonical ensemble , @xmath119 , such anomalous regions are inaccessible in this description ( @xmath120 denotes the canonical average ) .",
    "this fact evidences the existence of a significant _ lost of information _ about the thermodynamical features  of the system during the occurrence of a first - order phase transitions when the canonical ensemble is used instead of the microcanonical one .",
    "this difficulty is successfully overcome by the gcmmc algorithm , which is able to predict the microcanonical average of the microscopic observables in these anomalous regions where any others monte carlo methods based on the consideration of the gibbs canonical ensemble such as the original mmc , the swendsen - wang and the wolff single cluster algorithms certainly do not work .",
    "[ t ]    magnet1.eps    this fact is clearly illustrated in the fig.[gc_sw.eps ] , which evidences that the swendsen - wang algorithm is unable to describe the thermodynamic states with a negative heat capacity : its results within the anomalous region differ significantly from the ones obtained by using the gcmmc algorithm .",
    "the swendsen - wang dynamics exhibits here an erratic behavior originated from the competition of the two metastable states present in the neighborhood of the critical point ( the energy distribution function in the canonical ensemble is bimodal when @xmath121 , where @xmath122 and @xmath123 , being this feature the origin of the supercritical slowing down ) .    [ ptb ]    metastable.eps    as already shown by gross in ref.@xcite , a negative heat capacity in a system with short - range interactions can be associated to the existence of a non - vanishing interphase surface tension .",
    "other quantities like the transition temperature @xmath124 and the latent heat @xmath125 can be derived easily from the caloric curve @xmath126 .",
    "following the same procedure developed by gross , our calculations allow us to obtain the following estimates for the @xmath97 states potts model with @xmath107 : @xmath127 and @xmath128 .",
    "the study of the magnetic properties of this model within the microcanonical ensemble illustrated in the fig.[magnet1.eps ] , shows us that the existence of the non - vanishing interphase surface tension is not the only one information hidden behind of a negative heat capacity within the canonical description .",
    "the modulus of the magnetization density @xmath129 evidences what could be considered as the signature of two _ phase transitions within the microcanonical description of this model system _ : a continuous ( paramagnetic - ferromagnetic ) phase transition at the critical point @xmath130 , and a discontinuous ( ferro - ferro )  phase transition at @xmath131 ( from a low magnetized ferromagnetic type ii phase towards a high magnetized ferromagnetic type i one ) .",
    "the investigation of these interesting behaviors deserves a further study .",
    "most of thermodynamic points of this dependences were obtained from a data of @xmath114 metropolis iterations , with the exception of all those points belonging to the energetic interval @xmath132 where very large fluctuations of the magnetization density were observed .",
    "the possibility of the gcmmc algorithm of performing a localized computation of the microcanonical averages at a given value of the energy allows us to increase the metropolis iterations @xmath93 up to @xmath133 for each point within the above energetic range in order to reduce the significant dispersion of the expectation values observed there .",
    "the very large fluctuations , the peculiar behavior of the dispersion @xmath134 , the qualitative form of the magnetization curve @xmath135 shown in fig.[magnet1.eps ] , as well as the apparent large relaxation times of the expectation values during the gcmmc dynamics , suggest us the presence of several metastable states with different magnetization densities at a given energy within this last region , whose existence is shown in the fig.[metastable.eps ] .",
    "the anomalies observed in the thermodynamic characterization of the @xmath97 state potts model suggest strongly the existence of the critical slowing down phenomena within the `` microcanonical description '' provided by the gcmmc algorithm .",
    "this fact inspires the development of nonlocal monte carlo algorithms based on the consideration of the generalized canonical ensemble ( [ gce ] ) in order to address the microcanonical description of more larger systems undergoing a discontinuous ( first - order ) phase transitions within the canonical description .",
    "we have presented a very simple methodology for improving the ordinary metropolis importance sampling algorithm @xcite in order to allow the computation of the microcanonical averages during the occurrence of the first - order phase transitions in systems with short - range interactions .",
    "the key of our approach is the consideration of certain generalized canonical ensemble ( [ gce ] )  inspired on the reparametrization invariance of the microcanonical description @xcite , which becomes equivalent to the microcanonical ensemble when the size @xmath1 of the interest system is large enough .",
    "a direct advantage of this new methodology is the possibility of performing a localized computation of the any microcanonical average at a given value of the energy , and avoid in this way the unnecessary computation of the whole energy range , a feature of many other monte carlo technics based on reweighting the energy histogram @xcite .",
    "the existence of anomalies within the microcanonical description of the @xmath97 states poots model inspires the further development of nonlocal monte carlo algorithms based on the consideration of the generalized canonical ensemble ( [ gce ] ) ."
  ],
  "abstract_text": [
    "<S> we introduce a modification of the well - known metropolis importance sampling algorithm by using a methodology inspired on the consideration of the _ reparametrization invariance _ of the microcanonical ensemble . </S>",
    "<S> the most important feature of the present proposal is the possibility of performing a suitable description of microcanonical thermodynamic states during the first - order phase transitions by using this local monte carlo algorithm . </S>"
  ]
}