{
  "article_text": [
    "understanding the folding of proteins from computer simulations is a longstanding but still elusive goal in computational biology .",
    "the difficulties stem from the fact that proteins are only marginal stable . at room temperature",
    "the free energy difference between the biologically active and unfolded states is only of order @xmath1 kcal / mol .",
    "however , this small gap is due to cancelations of large energetic and entropic terms which poses two major challenges to numerical simulations . on the one hand",
    ", one has to find a universal model that captures this delicate balance .",
    "on the other hand , the competing interactions necessarily lead to a rugged energy landscape that makes the exhaustive sampling of low - temperature configurations a challenging computational task . in general",
    ", it has been hard to distinguish which of the two difficulties is the limiting factor in computational protein studies .    in this paper",
    "we address the second challenge and apply a powerful sampling technique that allows to efficiently explore a complex energy landscape by systematically shifting computational resources towards the bottlenecks of a simulation @xcite , which are typically in the vicinity of free energy barriers .",
    "we test our algorithm by simulating the 36-residue villin headpiece sub - domain hp-36 .",
    "this molecule has raised considerable interest in computational biology @xcite as it is one of the smallest proteins with well - defined secondary and tertiary structure @xcite but at the same time with 596 atoms still accessible to simulations @xcite .",
    "its structure which was resolved by nmr analysis and deposited in the protein data bank ( pdb code 1vii ) is shown in fig .  1 .",
    "recent computationally intensive investigations have studied this protein using molecular dynamics @xcite and parallel tempering @xcite techniques . while the former study reports room temperature configurations that are within @xmath2   to the native structure , these randomly sampled configurations could not be singled out from the misfolded structures in a rigorous way .",
    "the latter study @xcite tries to identify the biologically active state as those configurations which minimize the energy functional of an implicit solvent model . however , despite considerable long simulation times low - energy configurations that resemble the experimentally determined one were found only with less than 20% frequency at t=250 k. these conformers differed still by root - mean - square - deviations ( rmsd ) of @xmath3   from the native structure and could also not be distinguished by their energies from that of the predominant misfolded structure .",
    "what leads to the discrepancy with the experiments ? the authors of ref",
    ".   argue that it is due to poor approximations of the simulated force field and especially the implicit solvent model .",
    "indeed , configurations with an rmsd of @xmath4    have been found later with high frequency in simulations with a modified energy function @xcite .",
    "however , the alterations of the implicit solvent model are ad hoc and not universal @xcite , while the parameters of the original model were fitted against experimental data . on the other hand , the data of ref .",
    "could also indicate that despite large computational efforts the simulation has not thermalized and the correct equilibrium distribution of low - energy configurations not yet been found .",
    "deciding between the two alternatives in the above example is especially important as parallel tempering  @xcite ( also known as replica exchange method ) has recently become the simulation technique of choice in protein studies  @xcite .",
    "the question can be re - formulated as how does one gauge the efficiency of a parallel tempering run and ensures that the sampling is sufficiently long to ensure thermal equilibration ?",
    "the present paper describes a measure for this purpose and discusses a protocol that allows one to optimize the performance of parallel tempering runs by finding the best temperature distribution . using the enhanced parallel tempering protocol",
    "we demonstrate that the simulation of ref .   had indeed not thermalized . on the contrary",
    ", we now find a _",
    "dominant _ lowest energy configuration that is within @xmath2   to the native structure .",
    "this rmsd is comparable to the best ones found in previous molecular dynamics simulations @xcite with a different search technique and energy function , but our approach requires only 1% of their computational resources .",
    "in parallel tempering @xcite simulations @xmath5 non - interacting copies , or `` replicas '' , of the protein are simultaneously simulated at a range of temperatures @xmath6 , e.g. by distributing the simulation over @xmath5 nodes of a parallel computer . after a fixed number of monte carlo sweeps ( or a molecular dynamics run of a certain time ) a sequence of swap moves ,",
    "the exchange of two replicas at neighboring temperatures , @xmath7 and @xmath8 , is suggested and accepted with a probability @xmath9 where @xmath10 is the difference between the inverse temperatures and @xmath11 is the difference in energy of the two replicas . for a given replica",
    "the swap moves induce a random walk in temperature space that allows the replica to wander from low temperatures , where barriers in a complex energy landscape lead to long relaxation times , to high temperatures , where equilibration is rapid , _ and back_. the convergence of a parallel tempering run is given by the relaxation at lowest temperature and can be gauged by the frequency of statistically independent visits at this temperature . a lower bound for this number is the rate of round - trips @xmath12 between the lowest and highest temperature , @xmath13 and @xmath14 respectively .",
    "an equivalent measure is the round - trip time @xmath15 , i.e. the average time it takes a replica to move from lowest temperature @xmath13 to the highest temperature @xmath14 , and back .",
    "it is this _ non - local _ measure in temperature space that one has to minimize in order to optimize a parallel tempering simulation @xcite .",
    "commonly , it is assumed that equilibration is fastest if the _",
    "local _ acceptance rate of swaps is the same for all pairs of neighboring temperatures @xmath7 and @xmath8 @xcite .",
    "recently , it has been shown that this assumption is misleading @xcite . here",
    "we review the algorithm outlined in ref .",
    "@xcite and apply it to systematically optimize the temperature set used in our simulations in such a way that for each replica the number of round - trips is maximized , and equilibration of the system at low temperatures thereby substantially improved .",
    "we illustrate this approach by an example parallel tempering simulation of the 36-residue protein hp-36 in an all - atom representation .",
    "the intramolecular interactions are described by the ecepp/2 force field @xcite @xmath16 where @xmath17 is the distance between the atoms @xmath18 and @xmath19 , @xmath20 is the @xmath21-th torsion angle , and energies are measured in kcal / mol .",
    "the protein - solvent interactions are approximated by a solvent accessible surface term @xmath22 here @xmath23 is the solvent accessible surface area of the @xmath24 atom in a given configuration , and @xmath25 a solvation parameter for the atom @xmath18 .",
    "for the present investigation we use the parameter set oons of ref .  .",
    "our implementation is based on the software package smmp ( _ s_imple _ m_olecular _ m_echanics for _ p_roteins ) @xcite which allowed us to distribute the simultaneous simulation of @xmath26 replicas on a beowulf cluster with 2.2  ghz opteron processors .",
    "the initial temperature distribution for these replicas is listed in table  [ table : tsets ] .",
    "a sequence of swap moves between neighboring temperatures is attemped after each monte carlo sweep where a sweep consists of a series of metropolis tests for each of the dihedral angles .",
    "note that the implementation of the force field differs slightly from the one in ref .",
    "leading to ( irrelevant ) differences in the absolute energy values .",
    "our approach to optimize the simulated temperature set is inspired by a recently introduced adaptive broad - histogram algorithm @xcite that maximizes the rate of round - trips in energy space by shifting additional weight toward the bottlenecks of the simulation and has been outlined in the context of classical spin models in ref .",
    "the bottlenecks of the simulation are identified by measuring the local diffusivity of the simulated random walk . in the case of a parallel tempering run , where we simulate a random walk in temperature space , this quantity",
    "is calculated by adding a label  up \" or  down \" to the replica",
    "that indicates which of the two extremal temperatures , @xmath13 or @xmath14 respectively , the replica has visited most recently .",
    "the label of a replica changes only when the replica visits the opposite extremum .",
    "for instance , the label of a replica with label  up \" remains unchanged if the replica comes back to the lowest temperature @xmath13 , but changes to  down \" upon its first visit to @xmath14 .",
    "for each temperature point in the temperature set @xmath27 we record two histograms @xmath28 and @xmath29 . before attempting a sequence of swap moves we increment at temperature @xmath7 that of the two histograms which has the label of the respective replica currently at temperature @xmath7 .",
    "if a replica has not yet visited neither of the two extremal temperatures , we increment neither of the histograms .",
    "for each temperature point this allows us to evaluate the average fraction of replicas which diffuse from the lowest to the highest temperature as @xmath30 in fig .",
    "[ fig : fraction ] this fraction is plotted for our parallel tempering simulations of hp-36 with an initial temperature distribution as listed in table [ table : tsets ] .",
    "the so - labelled replicas define a steady - state current current from @xmath13 to @xmath14 that is proportional to the round - trip rate @xmath12 and therefore independent of temperature . to first order in the derivative",
    "this current is given by @xmath31 where @xmath32 is the local diffusivity at temperature @xmath33 and @xmath34 is the probability distribution for a replica to reside at temperature @xmath33 , where the temperature @xmath33 is now assumed to be a continuous variable ( and not limited to the points of the current temperature set ) . for a given temperature set",
    "we approximate this probability distribution with a step - function @xmath35 , where @xmath36 is the length of the temperature interval around temperature @xmath37 in the current temperature set .",
    "the normalization constant @xmath38 is chosen as @xmath39 rearranging eq .",
    "( [ eq : current ] ) gives a simple measure of the local diffusivity @xmath32 : @xmath40 where we have dropped the normalization @xmath38 and the constant current @xmath19 .",
    "for the parallel tempering simulation of hp-36 this quantity is plotted in fig .",
    "[ fig : diffusivity ] .",
    "the diffusivity shows a strong modulation along the simulated temperature range @xmath41  k , note the logarithmic scale of the ordinate .",
    "a pronounced minimum occurs around @xmath42  k where the diffusivity is suppressed by two orders of magnitude in comparison to the temperature range below 350  k and above 600  k. this minimum in the diffusivity points to a severe bottleneck for the random walk in temperature space : replicas can move back and forth in temperature rapidly below and above this bottleneck , but experience a dramatic slowdown as they approach and pass through the temperature range around 490  k. this behavior can be explained through a free energy barrier associated with a structural transition of the protein ; the minimum in the local diffusivity is located slightly below the maximum of the specific heat at @xmath43  k which is also plotted in fig .  [ fig : diffusivity ] . for hp-36 in the ecepp/2 force - field it has been shown that the position of this peak separates a high - temperature phase with extended unordered configurations from a low - temperature region that is characterized by high helical content of the molecule @xcite . below this transition",
    "a shoulder in the measured local diffusivity points to a second bottleneck in the simulation for an extended range of temperatures @xmath44k@xmath45k , possibly caused by competing low - energy configurations with high helical content .",
    "while the specific heat for this temperature range is slightly larger than in the high - temperature region above 600  k , there is no characteristic feature similar to the progression of the local diffusivity .",
    "the local diffusivity is thus a more sensitive measure to identify bottlenecks in a parallel tempering simulation and to locate the multiple temperature scales dominating the folding process of a protein for a given force field .    in order to speed up equilibration",
    "we want to maximize the rate of round - trips which each replica performs between the two extremal temperatures , or equivalently the diffusive current @xmath19 , by varying the temperature set @xmath46 and thus the probability distribution @xmath47 , as discussed in refs .",
    "@xcite . rearranging and integrating eq .",
    "( [ eq : current ] ) this goal is achieved by minimizing the integral @xmath48 dt \\ ; , \\label{eq : integral}\\ ] ] where we have added a lagrange multiplier @xmath49 which ensures that @xmath47 remains a normalized probability distribution . varying the probability distribution @xmath47 the integrand in eq .",
    "( [ eq : integral ] ) is minimized for @xmath50 where the normalization @xmath51 is again chosen according to the normalization condition in eq .",
    "( [ eq : normalization ] ) . for the optimal temperature",
    "set the temperature points are thus rearranged in such a way that the probability distribution @xmath52 becomes inversely proportional to the square root of the local diffusivity .",
    "measuring the local diffusivity @xmath32 for an initial temperature set , we can determine the optimized probability distribution @xmath53 approximated as a step - function in the original temperature set .",
    "optimized _ temperature set @xmath54 is then found by choosing the @xmath55-th temperature point @xmath56 such that @xmath57 where @xmath58 and the two extremal temperatures @xmath59 and @xmath60 remain fixed .",
    "this feedback of the local diffusivity is then iterated for increasingly long simulation runs  in our simulations we double the number of swaps for subsequent feedback steps  until convergence of the optimized temperature set is found .    in our simulations we start with the arbitrary initial temperature set of table [ table : tsets ] that similar to a geometric progression concentrates temperature points at low temperatures .",
    "three feedback steps were performed , one after 100,000 mc sweeps , a second after further 200,000 sweeps , and a third one after additional 400,000 sweeps .",
    "the iterated temperature sets are plotted in fig .",
    "[ fig : t - sets ] and also listed in table [ table : tsets ] .",
    "the feedback algorithm shifts computational resources towards the temperature of the helix - coil transition and temperature points in the optimized temperature sets concentrate around @xmath43  k where the measured local diffusivity is suppressed , see fig .",
    "[ fig : diffusivity ] . in the derivation of the feedback procedure we have assumed that the local diffusivity is to leading order independent from the temperature set .",
    "a posteriori we can verify this assumption by demonstrating that the optimized temperature set is independent of the initial temperature set . to this end , we perform a second series of feedback optimization steps starting from the temperature set of ref .  .",
    "as illustrated in the lower half of fig .",
    "[ fig : t - sets ] we indeed find that a very similar distribution is approached .",
    "i for the optimized temperature set the acceptance probabilities of replica swaps show a strong _ temperature dependence _ as illustrated in fig .",
    "[ fig : pacc ] .",
    "this is a consequence of the concentration of temperature points around @xmath43  k in the optimized temperature set for hp-36 . there",
    "the acceptance probabilities are found to be relatively high ( around 80% ) while in the temperature regions below 350  k and above 600  k where temperature points have been thinned out the acceptance probabilities drop below some 40% .",
    "the fact that for our optimized temperature set the acceptance probabilities vary with temperature contradicts various alternative approaches in the literature @xcite that aim at maximizing equilibration by choosing a temperature set where the acceptance probability of attempted swaps is independent of temperature .",
    "the feedback - iterations systematically optimize the temperature set which maximize the efficiency of parallel tempering simulations .",
    "we now turn to the results obtained for our simulations of hp-36 and discuss the effects of the temperature reweighting . though the parallel tempering simulations allow to evaluate thermodynamic quantities over a range of temperatures , here we focus on the properties of the configurations at the lowest temperatures . in fig .",
    "[ fig : rgy ] the radius of gyration @xmath61 which measures the compactness of a protein configuration is plotted for the lowest - energy configuration versus the number of monte carlo sweeps . for the initial iteration",
    "the radius of gyration varies in a broad range of @xmath62   .",
    "a histogram of @xmath61 is plotted on top of the time series in fig .",
    "[ fig : rgy ] showing that two sets of configurations are found , one set with `` compact '' configurations characterized by a radius of gyration in the range @xmath63     and `` extended '' configurations with a radius of gyration in the range @xmath64   .",
    "averaging over some 100,000 mc sweeps in the first iteration we find that about 25% of the configurations are `` compact '' , and a remaining 75% of `` extended '' configurations .",
    "previous simulations @xcite with a total of 150,000 mc sweeps also reported the occurrence of these two sets of configurations . similar to our case",
    "the `` extended '' configurations dominated , and only a small fraction of 20% of the configurations were `` compact '' . in the present study we continued the simulation after the first feedback step with an optimized temperature set for an additional 200,000 mc sweeps . the time series in fig .",
    "[ fig : rgy ] shows that as a consequence , the fraction of `` extended '' configurations in the lowest - energy configurations is significantly reduced and some 90% of the sampled lowest - energy configuration have a radius of gyration smaller than 11   .",
    "this ratio increases further to 99% for the final iteration with 400,000 mc sweeps after the second feedback step .",
    "while in the previous study equilibration at low temperatures was determined by analyzing the time series for thermodynamic observables such as the potential energy and convergence was found after some 100,000 mc sweeps , the discrepancy to the results presented here cast serious doubt whether an overall simulation time of some 150,000 mc sweeps and a sub - optimal temperature set were sufficient to reach full equilibration .",
    "the long relaxation times in our example indicate that even with a sophisticated technique like parallel tempering the simulation times have to be considerably longer than commonly assumed . in order to assure equillibrisation at lowest temperature the number of round trip times",
    "should be at least @xmath65 . to probe whether our simulations allow a structural prediction of the true ground state configuration we track the configuration with the overall lowest energy in the simulation and compare it to the protein data bank structure of hp-36 ( pdb code 1vii ) . the lowest - energy configuration obtained in our simulation",
    "is illustrated in fig .",
    "[ fig : lowestenergy - configuration ] . despite the fact that in this structure the two n - terminal helices merged to one long helix ( compromising residues 5 to 21 ) that tightly packs to the c - terminal helix , its rmsd to the pdb structure is only @xmath66   .",
    "this value is substantially lower than in the structures with an rmsd of @xmath67     previously obtained by molecular dynamics simlations @xcite , monte carlo simulations @xcite and optimization techniques @xcite . a structure with comparable rmsd of @xmath68",
    "   has been obtained by large - scale molecular dynamics simulations @xcite . however , in those simulations the best - matching structure was found by comparing _ all _ sampled configurations along multiple trajectories to the pdb structure , while in our simulations the optimal structure is singled out as the one with the lowest energy .",
    "in addition , our simulations consumed only about 1% of the computing time resources ( about 1,000 cpu years ) used in ref .  .",
    "in conclusion , we have applied a powerful feedback algorithm for the numerical simulation of proteins that allows to allocate computational resources in a parallel tempering simulation so that equilibration at all temperatures is considerably improved . by tracking the diffusion of replicas in temperature space we have identified the bottlenecks of a simulation , typically in the vicinity of the folding transition .",
    "feeding back this information we obtain an optimal temperature set that concentrates temperature points at these bottlenecks .",
    "our algorithm differs from previous approaches that aim at maximizing equilibration by considering the local acceptance probabilities of replica exchange moves .",
    "in contrast we find that for the optimal temperature set acceptance probabilities for such swap moves show a strong temperature dependence . applying the optimized parallel tempering technique to the simulation of the 36-residue protein hp-36 we find a dominant low - energy configuration with less than 4    root - mean square distance from the native structure within a fraction of the computing time consumed by high - performance molecular dynamics simulations .",
    "we note , however , that the energy difference between our compact , lowest - energy configuration and the extended structure with lowest energy  which differs from the pdb structure by an rmsd of 8.0  is only @xmath1 kcal / mol ( for the minimized configurations ) . on the other hand ,",
    "the energy of our lowest - energy configuration is 100 kcal / mol _ lower _ than that of the ( minimized ) pdb structure from which ( despite the small rmsd ) it still differs considerably .",
    "hence , while our results appear to be closer to the experimental results than previous simulations they still demonstrate the limitations on protein simulations that are inherent in present energy functions .",
    "the extremely long relaxation times indicate the existence of spurious minima that should be absent in the folding funnel of fast folding proteins such as the villin headpiece .",
    "unveiling these limitations in the energy functions and their underlying causes requires optimized simulation techniques such as the one applied in the present paper .",
    "_ acknowledgments  _ we thank a. laio and b. zagrovic for stimulating discussions , as well as d. a. huse and h. g. katzgraber for fruitful discussions on the technical aspects of this manuscript .",
    "s.t . acknowledges support by the swiss national science foundation , u.h . by a research grant ( che-9981874 ) of the national science foundation ( usa ) .",
    "k , to the highest temperature @xmath69k in a parallel tempering simulation of hp-36 . for the optimized temperature set ( iteration 3 ) ,",
    "the temperature points are distributed in such a way that the fraction shows a nearly constant decay @xmath70 between adjacent temperature points , i.e. @xmath71 . ]     ( left ordinate ) for a random walk in temperature space preformed by a replica in a parallel tempering simulation of the chicken villin headpiece subdomain hp-36 using the ecepp/2 force field and an implicit solvent .",
    "the diffusivity shows a strong modulation with temperature , note the logarithmic scale of the left ordinate .",
    "a pronounced minimum in the local diffusivity occurs slightly below the helix - coil transition around @xmath72  k where the specific heat @xmath73 ( right ordinate ) has a maximum ( dashed line ) . ]      .",
    "the dependence of the acceptance probabilities on the temperature closely reflects the shape of the measured local diffusivity ( filled circles ) . in the vicinity of the helix - coil transition temperature @xmath43  k where the local diffusivity is strongly suppressed the acceptance probabilities",
    "are highest due to the contraction of temperature points in the optimized temperature set .",
    "the dotted lines indicates the minimum in the local diffusivity . ]"
  ],
  "abstract_text": [
    "<S> we apply a recently developed adaptive algorithm that systematically improves the efficiency of parallel tempering or replica exchange methods in the numerical simulation of small proteins . </S>",
    "<S> feedback iterations allow us to identify an optimal set of temperatures / replicas which are found to concentrate at the bottlenecks of the simulations . </S>",
    "<S> a measure of convergence for the equilibration of the parallel tempering algorithm is discussed . </S>",
    "<S> we test our algorithm by simulating the 36-residue villin headpiece sub - domain hp-36 where we find a lowest - energy configuration with a root - mean - square - deviation of less than @xmath0    to the experimentally determined structure . </S>"
  ]
}