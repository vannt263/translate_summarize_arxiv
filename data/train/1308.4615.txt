{
  "article_text": [
    "one of the major challenges in building a quantum computer is to coherently control a large quantum system well enough to perform an arbitrary quantum algorithm.@xcite nuclear magnetic resonance ( nmr ) offers an excellent test bed for developing techniques to control quantum systems.@xcite applying a quantum algorithm in nmr requires rf pulses that manipulate the spin system through the various steps of the algorithm .    in nmr",
    ", optimal control is used for designing and optimizing experiments for various applications such as imaging,@xcite liquid and solid state spectroscopy,@xcite quantum computation,@xcite dynamic nuclear polarization ( dnp),@xcite and algorithmic cooling in the solid state.@xcite pulses in nmr can be designed by simpson ( see ref .  ) , which is , originally , an nmr simulation program .",
    "simpson was lately expanded to implement the optimal control algorithm grape.@xcite    in this work , we designed , using simpson , a polarization exchange ( pe ) pulse , on a 3-qubit system .",
    "we then also implemented that designed pulse experimentally .",
    "a second pulse , compression ( comp ) , which requires more time hence is more challenging , was also designed and implemented on the same experimental system .",
    "these gates were chosen since they manipulate ( redistribute ) the entropy of two or more spins ; pe is important in nmr in general , and comp performs 3-bit reversible entropy compression.@xcite    these two gates and similar ones are building blocks of algorithmic cooling ( see refs .  ) , hence similar gates were already designed for that purpose .",
    "the first attempts were based on directly designing a unitary operation , with no numerical optimization .",
    "see for instance ref .  , for compression , and ref .   for polarization transfer ( and heat - bath cooling beyond shannon s entropy bound",
    ") . however , these initial attempts suffered from a large error in the experimentally implemented gates . the first full algorithmic cooling experiment in solid state nmr , described in ref .  ,",
    "utilized numerical optimization to design comp and swap pulses for @xmath1-labeled malonic acid .",
    "later , grape was applied to this system to obtain higher pulse fidelity , permitting four rounds of algorithmic cooling ( beyond the polarization of the heat - bath).@xcite motivated by this result , the optimized pulses designed here have recently been combined to demonstrate algorithmic cooling in liquid state nmr@xcite ( based on the work presented here ) .",
    "grape has also been used to design pulses for up to seven qubits in crotonic acid.@xcite    the rest of this work consists of the following sections : chapter  [ chap : oc4qgate ] highlights the advantages of the state - to - state optimal control approach for the design of quantum gates .",
    "chapter  [ chap : materials - and - methods ] describes the experimental apparatus and the process of pulse design and analysis .",
    "the designed optimized pulses and the resulting spectra are described in chapter  [ chap : results ] .",
    "we discuss the results and future prospects in chapter  [ chap : discussion ] .",
    "in this section we briefly clarify the advantages of state - to - state design of quantum gates by means of the well - established optimal control methodology .",
    "we focus on the gates relevant for this paper , polarization exchange and compression .",
    "as mentioned above , researchers originally tried to implement a chosen unitary gate directly , with no numerical optimization.@xcite however , due to the need to compansate for undesired free evolution under ising or heisenberg spin - coupling and chemical shifts , the resulting pulse sequences were quite long and each pulse added a non - negligible noise .",
    "for example , the compression is supposed to enhance the polarization from 100% to 150% , and in ref .",
    "the obtained result was only around 122% .",
    "similarly , multiple pe gates were applied in ref .  , and one of them had a fidelity of around 70% only .",
    "numerical optimization allowed better results ( see ref .  ) but their design was rather complicated and a better method was required .",
    "state - to - state optimal control method has the advantage of fully using the redundancy allowed in gate design . instead of choosing a unitary transformation",
    ", the designer only tells the optimization software ( simpson ) the initial state and the desired final state , while giving the software full freedom in searching for the optimal pulse .",
    "this freedom is then somewhat limited by fixing the duration of the pulse , and by demanding robustness of the pulse to small changes .",
    "a swap can be implemented via three controlled - not gates , in case these are easier to implement . in nmr , applying a specific gate to two spins while doing nothing to all other spins is highly challenging ( because spin coupling and chemical shifts are continuously present ) .",
    "polarization exchange ( pe ) `` gate '' is a variant of swap in which we only want to interchange the z - components of the spins without caring about the phases , thus we have some phase redundancy .",
    "for example , equation  [ eq : swap - variant ] displays a variant of swap which does not perform a good swap of the states , but is perfect for pe : @xmath2 ( note the phase in the last line ) .",
    "thus , pe is actually not a single gate but a family of gates .",
    "another source of redundancy arises when two z - states have the same probability , for example if the density matrix is diagonal , such as @xmath3 then any unitary transformation inside the subspace spanned by @xmath4 and @xmath5 does not disturb the pe , hence this gives another source of redundancy .",
    "this opportunity can appear anywhere during the pulse .",
    "any unitary operator @xmath6 ( obtained by applying a fixed hamiltonian for some time ) can be replaced by a different trajectory , e.g. , @xmath7 even if @xmath8 is arbitrary .",
    "this is a source of redundancy which is independent of the above sources ; for example , both swap and the variant of swap from eq .",
    "[ eq : swap - variant ] can be applied by an infinite variety of implementations .    due to all these sources of redundancy the variety of potential pulses",
    "is expected to be quite vast , especially if we use the maximal incrementation allowed by the software .",
    "thus there is a very good probability of finding robust pulses .",
    "we want our pulse to be short , in order not to accumulate dissipation or errors .",
    "this limits the variety of redundant pulses the optimization can choose from ; the redundancy increases with the number of increments .",
    "compression on three spins puts the maximal possible polarization on one of them .",
    "similar to pe , compression is a family of gates , because there is a redundancy in terms of the remaining polarization on the other spins .",
    "even if we limit that redundancy , by maximizing first the polarization on one spin , and then on the next ( while keeping the maximum on the first one of course ) , etc .",
    ", still there is redundancy in terms of the phase , trajectory and possibly identical probabilities of z - states . here is a compression gate that we call comp : @xmath9 see ref .   for explanation of the compression performed using this gate and similar ones .",
    "the experiments were performed on a bruker avance iii 600 spectrometer using a standard 5  mm bbo probe .",
    "the sample was @xmath0-tce with paramagnetic reagent cr(acac)@xmath10 for increased @xmath11 ratios ( see ref .  ) in cdcl@xmath10 ( chloroform - d ) solution , comprising two @xmath1 and one @xmath12 qubits ( see figure [ fig : tce_with_spectrum_ch3 ] ) .    [ !",
    "h ] -tce were utilized in the experiment : h , c2 , and c1 . in the table ,",
    "the chemical shifts relative to the transmitter frequency are in the diagonal elements , and the j - couplings are in the off diagonal elements .",
    "note that the broadcasting frequency of the carbon channel is between the larmor frequencies of c1 and c2 .",
    "the carbon spectrum is at the bottom , the proton spectrum is in the small frame .",
    "remark : the carbons have different t@xmath13 , hence their peaks have different heights , although their integrals , and therefore their polarizations , are equal up to an error of 2%.,title=\"fig : \" ]",
    "grape@xcite is an optimal control algorithm which designs shaped pulses contemplating to apply a state to state transformation , or a given unitary propagator .",
    "a pulse with random shape ( i.e. , random amplitudes and phases ) is generated , and then monotonically improved by gradient ascent in respect to a target function .",
    "robustness of the pulses to experimental parameters such as rf or primary magnetic field inhomogeneities is supported inherently by the algorithm . in this work we used the grape implementation in simpson.@xcite",
    "the grape state - to - state algorithm seeks the optimal amplitudes and phases of the rf fields that transform a given initial density matrix @xmath14 sufficiently close to a desired target density matrix @xmath15 . for a specified pulse duration @xmath16 , grape attempts to increase the overlap between @xmath17 and @xmath15 beyond a given threshold .",
    "the total energy of the pulse might be limited by hardware or the sample allowed temperatures .",
    "grape can consider physical constraints such as the the maximum intensity of the rf transceiver , and can enable robustness to deviation e.g. , in the rf pulse homogeneity .",
    "see table  [ senstable ] .",
    "simpson requires the full hamiltonian of the system , namely , the j - coupling constants and the chemical shifts of the spins .",
    "j - coupling constants were found directly from the spins excitation ( 90@xmath18 ) spectra , i.e. , by using bruker * zg * pulse program .",
    "however , for the carbons the larmor frequency difference is not much greater than the j - coupling , therefore it does not provide a good approximation for the chemical shift .",
    "we preferred to calculate their chemical shifts by matching the measured spectrum in the lab to the predicted spectrum of tce using simpson in simulation mode .",
    "after collecting the parameters measured , the rotating frame hamiltonian used for the optimization is ( coupling constants and chemical shifts are in hz ) :    @xmath19    [ senstable ]    once a pulse is generated it is possible to see how sensitive it is to various parameters by evaluating the target function of the pulse with parameters deviating from the nominal . knowing the sensitivity of a parameter is utilized for determining how much effort should be made in tuning or measuring it .",
    "the required robustness of the pulse to this parameter is also deduced from the sensitivity .",
    "table [ senstable ] summarizes the sensitivity to different parameters of the compression pulse , with expected nominal fidelity of 0.9985 .",
    "table [ tbl : tcet1t2 ] summarizes the t@xmath20 and t@xmath13 values of the spin system .",
    "t@xmath13 was measured directly from the spectrum ( single scan , line - width at half maximum ) .",
    "t@xmath20 of each spin was measured in a different experiment , a few days earlier , by a standard inversion recovery method ( bruker pulse program : * * t1ir * * pulse is applied , followed by a varying delay @xmath21 , a 90@xmath18 pulse and a data acquisition . ] )",
    ". typically , 17 logarithmically even spaced delays were used , and t@xmath20 was found by fitting the data to the expected exponential model .",
    "[ tbl : tcet1t2 ]      the pe pulse was generated by simpson according to the following input parameters :    * * initial state : * @xmath22 @xmath23 diag@xmath24 * * final state : * @xmath25 @xmath23 diag@xmath26 * * max rf : * 2  khz * * duration : * 6  msec    the compression pulse was generated with the following simpson parameters :    * * initial state : * @xmath27 @xmath23 diag@xmath28 * * final state : * @xmath29 @xmath30 * * max rf : * 2  khz * * duration : * 13  msec    notice that in both experiments the final and initial states are degenerate allowing redundancy of potential pulses .",
    "the computation of the pulses required hundreds of iterations of the optimization , and hours or even days of computer time , depending on the complexity of the pulse and its constraints . in order to reduce the calculation time ,",
    "the pulse was first optimized without rf robustness , to reach the vicinity of the efficient pulses . then",
    ", a robustness constraint was added to the optimization , improving the pulse further ( but vastly increasing the calculation time of each iteration ) .",
    "although infinite number of possible compression pulses maximize the polarization of c1 , several considerations were made when selecting the final density matrix .",
    "it is desirable that at the end of the compression , c2 and h would retain some of their polarization , in order to reduce the reset times of the hydrogen in the next steps of algorithmic cooling .",
    "non - required density matrix terms with long thermalization time were avoided as they do nt vanish before the next pe step , and may hinder the cooling . note that the coupling constants determine the transition times , hence choosing a final density matrix sets a lower bound on the pulse length , indirectly affecting the efficiency .",
    "we chose a final density matrix which is identical to the result of applying 3-bit - compression ( see ref .  ) to the initial density matrix .",
    "simpson does not take dissipation mechanisms into account .",
    "this is one of the reasons the observed efficiency of the designed pulses in the lab is lower than predicted by simpson .",
    "the dissipation rates of a system depend on its state .",
    "for example , when a spin is on the x axis it will experience both @xmath11 and @xmath31 relaxation , while on the z axis it will experience only @xmath11 relaxation .",
    "pulses which apply the same unitary operator might also evolve the system in different paths that will cause a different amount of dissipation , and will therefore have different fidelities .",
    "therefore , the uncertainty of the pulse fidelity in the lab was dealt with by generating several pulses that apply the same operation ( state to state ) , and picking the pulse with best fidelity in the lab . in future work , an analysis of dissipation processes can be done in order to find an optimal path . a better pulse",
    "could then be prepared by tailoring multiple pulses ( generated by simpson ) that evolve the system through states in the optimal path .      before each lab session",
    ", two key procedures were performed : acquiring reference spectra and calibrating the power levels of the pulses .",
    "the efficiency of a pulse or an algorithm is determined by comparing the resultant polarization of the spins with their equilibrium polarization .",
    "the polarization is proportional to the integral over the spin s spectral lines .",
    "these spectra were displayed earlier in figure [ fig : tce_with_spectrum_ch3 ] .",
    "we acquired the reference spectra immediately after the ac experiments to avoid any drift effects .",
    "the pulse generated by simpson is given in nutation frequency units ( hz ) , which should be converted to the attenuation of the transmitter in the lab ( db ) .",
    "when the pulse is applied on two channels , both should be calibrated .",
    "the carbon channel was calibrated using a 5  msec selective pulse , generated by simpson , which rotates c2 to the x axis while keeping c1 on the z axis .",
    "the pulse was transmitted in different power levels .",
    "the power level selected is the one that gave the minimal integral over c1 , while the integral over c2 was close to the corresponding integral in the spectrum of a calibrated hard excitation ( 90@xmath18 ) pulse .",
    "knowing the carbon calibration , the power level of the hydrogen in the polarization exchange pulse was calibrated by finding the power which maximizes the polarization transferred to c2 .",
    "the robustness of the pulses to rf inhomogeneity was observed during the power calibration .",
    "for instance , a deviation of @xmath32  db ( i.e. , @xmath33% ) from the optimal carbon and hydrogen power levels , reduced the final polarization of c2 by only 1.6% ( from 3.8 to 3.74 ) .",
    "we measured a spectrum corresponding to the pe pulse ( followed by a readout pulse ) applied onto the equilibrium state .",
    "the spectrum clearly exhibits a polarization increase of c2 : the measured polarization of c1 and c2 are 0.98@xmath340.02 and 3.76@xmath340.02 respectively .",
    "the transfer efficiency is therefore 94% , and the loss of c1 polarization is close to our prediction .",
    "the spectrum is displayed in figure [ fig : polarizationswap600 ] .",
    "the integrals of c1 and c2 are @xmath35 and @xmath36 respectively , compared to a calibrated * zg * spectrum . ]",
    "figure [ fig : comp_amp_phase ] shows the phase and amplitude of the part of the compression pulse applied to the carbon channel .",
    "note that the rapid modulation of the amplitude and phase during the pulse are not always feasible by the hardware , thus reducing the pulse efficiency .",
    "the fourier transform of the pulse s x component is shown in figure [ fig : comp_amp_shape ] .",
    "it is difficult to understand from this image how the pulse addresses the two carbons .",
    "[ h ]      [ hf ]     figure [ fig : compeq ] shows the spectrum of the carbons following the compression pulse and a readout pulse .",
    "the polarizations of c1 and c2 were 2.76@xmath340.02 and -0.631@xmath340.02 respectively , while the simpson prediction was 3.00 and -0.73 .",
    "the efficiency of the compression pulse , which refers to the acquired polarization of c1 was 92% with respect to the ideal case .",
    "the integrals of c1 and c2 are @xmath37 and @xmath38 respectively , compared to a calibrated * zg * spectrum . ]",
    "in this work we demonstrated the design and experimental application of two highly non - trivial quantum gates which are also important building blocks of algorithmic cooling ( ac )  a method for extracting entropy from qubits into the environment.@xcite the implementation was done by using optimal control in liquid state nmr  the state - to - state mode of simpson .    grape has been used for nmrqc for the last few years .",
    "the simpson implementation of grape generated efficient and robust enough pulses .",
    "the parts missing from simpson - the experimental limitations , as well as dissipation processes and numerical errors , cause a gap between the efficiency of the pulses as expected by the optimization and the observed efficiency .",
    "the following factors may explain the gap between simpson s predicted pulses efficiency ( @xmath39 ) , and the efficiency observed in the lab which was between 92% to 94% .    1 .",
    "dephasing - throughout the evolution of the density matrix during the pulses , the system may experience different dephasing which depends on its instantaneous state . assuming the dephasing time constant is the spins average t@xmath13 , 290  ms , the polarization lost during a 6  msec pulse and a 13  msec pulse is roughly 2% and 4% respectively .",
    "although grape can integrate dissipation processes into the state to state optimization , they are not supported by simpson .",
    "a deeper analysis of the evolution of the density matrix is required for a better estimation .",
    "the probe and the rest of the hardware has limited bandwidth , see for example refs .  , and therefore attenuates and distorts frequencies that are far from the carrier wave . in our case ,",
    "the distance between the control points of the shaped pulses is roughly a few micro - seconds , which translates to a bandwidth of @xmath401  mhz .",
    "therefore , highly modulated pulses may reach lower efficiencies than smooth pulses .",
    "the number of the pulse s control points seems to affect the observed efficiency .",
    "the maximal number of point allowed by simpson on our computer are 5000 .",
    "if we could increase the number of control points then perhaps the efficiency would also increase .",
    "possible avenues for further improving pulse fidelity :    * pulse design * - an alternative to simpson is introduced in ref .  ,",
    "an algorithm which generates smooth pulses , easier for the hardware to implement .",
    "another alternative was recently introduced,@xcite an improved version of grape which converges faster by utilizing a quasi - newton method .",
    "this version ( called bfgs - grape ) was implemented in matlab within the spinach package .",
    "the dephasing during the pulse transmission can be minimized by utilizing algorithms which take dephasing into account , or by giving higher priorities to trajectories of the density matrix with the least dephasing .",
    "* hardware * - the fidelity of the pulses can be improved by utilizing a feedback circuit , as described in ref .  , which reduces the fidelity degradation due to hardware bandwidth limitation .",
    "our work paves the way to implementing multiple rounds of algorithmic cooling in solution,@xcite by concatenating pe , compression ( such as those designed above ) and reset steps .",
    "the current work could also be a step towards employing nuclear magnetic resonance quantum computing ( nmrqc ) and ac in biomedical @xmath1-magnetic resonance spectroscopy and imaging .",
    "ac , and other nmrqc tools , may enhance in - vivo spectroscopy of slow metabolic processes , particularly in the brain , whereby @xmath1-labeled metabolites ( e.g. , amino acids ) are produced.@xcite",
    "this work was supported in part by the wolfson foundation , and by the israeli mod research and technology unit . the work of t.m .",
    "was also supported in part by fqrnt through intriq , and by nserc ."
  ],
  "abstract_text": [
    "<S> we demonstrate the use of optimal control to design two entropy - manipulating quantum gates which are more complex than the corresponding , commonly used , gates , such as cnot and toffoli ( ccnot ) : a 2-qubit gate called pe ( polarization exchange ) and a 3-qubit gate called comp ( polarization compression ) were designed using grape , an optimal control algorithm . </S>",
    "<S> both gates were designed for a three - spin system . </S>",
    "<S> our design provided efficient and robust nmr radio frequency ( rf ) pulses for @xmath0-trichloroethylene ( tce ) , our chosen three - spin system . </S>",
    "<S> we then experimentally applied these two quantum gates onto tce at the nmr lab . </S>",
    "<S> such design of these gates and others could be relevant for near - future applications of quantum computing devices . </S>"
  ]
}