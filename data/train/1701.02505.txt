{
  "article_text": [
    "we will make heavy use of graphs of groups and bass  serre theory , as detailed in serre s standard work on the subject @xcite , to which the reader is referred for details . to fix notation",
    ", we recall the definition of a graph .    a _ graph _ @xmath0 consists of a vertex set @xmath45 , an edge set @xmath46 , a fixed - point free involution @xmath47 denoted by @xmath48 , and an _ origin map _ @xmath49 . the _ terminus map _",
    "@xmath50 is defined by @xmath51 .",
    "the edges of @xmath0 are thus equipped with orientations , and the unoriented edges are the pairs @xmath52 .",
    "as well as using graphs of groups , we will also frequently adopt the topological point of view , in which a graph of groups is viewed as the fundamental group of a graph of spaces @xcite .",
    "graphs of spaces are not required to be connected , which will present some technical advantages , although the attaching maps are required to be injective on fundamental groups .",
    "analogously , we may also work with disconnected graphs of groups , as long as we are careful to choose a base point before talking about the fundamental group .",
    "it is particularly important for us to work with _ relative _ versions of graphs of groups and spaces , which characterize the relationship between a vertex group ( or space ) and its incident edge groups ( or spaces ) . to this end , we define various notions of pairs .",
    "we start with pairs of groups .    a _ group pair _ is a pair @xmath53 , where @xmath54 is a group and @xmath55 is a @xmath54-set .",
    "it is often convenient to choose a finite set of orbit representatives @xmath56 , to let @xmath57 , and to specify the pair via the data @xmath58 .",
    "we will use both the notations @xmath53 and @xmath58 to specify group pairs , without fear of confusion .",
    "the key example of a group pair arises when considering a vertex @xmath21 of a graph of groups @xmath59 .",
    "having fixed a lift @xmath60 of @xmath21 to the bass  serre tree , one takes @xmath61 to be the vertex stabilizer @xmath62 and @xmath55 to be the set of edges incident at @xmath60 .",
    "a _ morphism of graphs of groups _ is a morphism of the underlying graphs , accompanied by associated maps of vertex groups and edge groups that intertwine with the attaching maps .",
    "this is most easily thought of by passing to the bass  serre tree .",
    "a morphism of graphs of groups induces a homomorphism of fundamental groups , and lifts to an equivariant map on bass  serre trees .",
    "this motivates the following definition for pairs .    a _ morphism of group pairs _",
    "@xmath63 consists of a set map @xmath64 and a homomorphism @xmath65 that intertwines @xmath66 .",
    "that is , we require that @xmath67 for all @xmath68 and @xmath69",
    ".    in particular , a morphism of graphs of groups defines morphisms of the group pairs at each vertex , and conversely morphisms of pairs that satisfy an obvious compatibility condition can be pieced together to give a morphism of a graph of groups .",
    "it is convenient if we can detect _ global _ properties of morphisms of graphs of groups by looking at _ local _ properties of the induced maps on group pairs .",
    "we are particularly concerned with @xmath30-injectivity , and so we need to develop corresponding notions for group pairs .",
    "requiring that the map of groups @xmath65 be injective is clearly significant .",
    "the following condition is also important .",
    "a morphism of group pairs @xmath63 is _ @xmath37-essential _ if the map @xmath70 induced by @xmath66 is injective .    when applied to pairs associated to graphs of groups , this condition guarantees that the induced map on bass  serre trees does not factor through a fold . putting this together with injectivity",
    ", we have the notion of an essential morphism .",
    "a morphism of group pairs @xmath63 is _ essential _ if the homomorphism @xmath65 is injective and the morphism is also @xmath37-essential .    from this one",
    "easily deduces a local criterion for morphisms of graphs of groups to be @xmath30-injective .",
    "[ prop : essential maps of graphs of groups ] suppose that @xmath71 is a morphism of graphs of groups . if @xmath71 induces essential morphisms on the group pairs corresponding to vertices , then @xmath71 induces an injective map on fundamental groups .",
    "suppose that a group element @xmath72 is in the kernel of @xmath71 .",
    "since the map on bass  serre trees does not factor through a fold , if @xmath72 acts hyperbolically on the bass  serre tree then so does its image , contradicting the fact that @xmath72 is in the kernel .",
    "therefore @xmath72 is elliptic , but since @xmath71 is injective on vertex stabilizers , it follows that @xmath73 .",
    "we next make analogous definitions for spaces .    a _ space pair _ consists of cell complexes @xmath74 together with a continuous map @xmath75",
    ". we will frequently take @xmath76 to be an index set @xmath77 , and let @xmath78 denote the restriction of @xmath19 to @xmath79 , the path component of @xmath80 corresponding to @xmath81 .",
    "we will often use the notation @xmath82 to denote such a space pair .    in most of what follows",
    ", we will take @xmath20 to be a graph and @xmath80 to be a disjoint union of circles .",
    "however , it is useful to allow the extra flexibility of the general definition .",
    "if @xmath20 is path connected then a space pair @xmath82 naturally defines a group pair @xmath53 .",
    "let @xmath83 be the universal cover , and consider the fibre product @xmath84 taking @xmath85 and @xmath86 , we see that @xmath54 acts naturally on @xmath55 , and so @xmath53 is a group pair .",
    "this definition is more transparent if one thinks of @xmath20 as a vertex space of a graph of spaces @xmath87 .",
    "the universal cover @xmath88 of @xmath87 inherits a decomposition as a graph of spaces ; @xmath89 appears as a vertex space of @xmath88 , and the fibre product @xmath90 is the disjoint union of the edge spaces of @xmath88 incident at @xmath89 .",
    "we next define morphisms of space pairs , analogously to morphisms of group pairs .",
    "let @xmath75 and @xmath91 define space pairs @xmath82 and @xmath92 .",
    "morphism of space pairs _",
    "@xmath93 consists of continuous maps @xmath94 and @xmath95 so that @xmath96 .    as in the case of groups ,",
    "compatible collections of maps of pairs can be glued together to construct a map of graphs of spaces .",
    "again , we will need a definition of a @xmath37-essential morphism .    consider a morphism of space pairs @xmath93 .",
    "let @xmath97 be the universal cover of @xmath98 and let @xmath99 be the corresponding covering space of @xmath20 , obtained by pulling back the covering map @xmath100 along @xmath71 . consider the fibre products @xmath101 and",
    "note that the map @xmath94 lifts to a map @xmath102 .",
    "the morphism @xmath93 is called _ @xmath37-essential _ if @xmath103 induces an injective map @xmath104 .",
    "again , we combine this with injectivity on vertex groups to obtain a notion of an essential morphism",
    ".    a morphism of space pairs @xmath105 is _ essential _ if it is @xmath37-essential and @xmath95 is @xmath30-injective .",
    "finally , we note that our two definitions of @xmath37-essential pairs coincide .",
    "let @xmath106 be a morphism of space pairs , inducing the corresponding morphism of pairs @xmath107 on fundamental groups .",
    "the morphism @xmath108 is @xmath37-essential if and only if the morphism @xmath107 is @xmath37-essential .",
    "hence , @xmath108 is essential if and only if @xmath107 is essential .",
    "the quotient of @xmath89 by the action of @xmath109 is @xmath99 , and the corresponding covering map induces a map @xmath110 .    we need to show that two path components @xmath111 and @xmath112 of @xmath90 have the same image under this map if and only if they are in the same orbit of @xmath109 . the `",
    "if ' direction is clear . for the converse , we choose compatible basepoints @xmath113 and suppose that @xmath111 and @xmath112 have the same image",
    ". then the images of their basepoints in @xmath89 are joined by a concatenation of paths @xmath114 where @xmath115 maps to a loop in @xmath99 and @xmath116 is the image of a lift of a loop from @xmath80 to @xmath112 .",
    "these define group elements @xmath117 and @xmath118 so that @xmath119 translates @xmath111 to @xmath112 , and so @xmath111 and @xmath112 are indeed in the same orbit of @xmath109 .",
    "the lemma follows immediately .      in the setting of theorem [ thm : gofgwceg ] ,",
    "the groups @xmath54 are finitely generated free groups , so the spaces @xmath20 can be taken to be graphs .",
    "we may therefore apply the techniques of stallings @xcite .",
    "let @xmath0 be a graph .",
    "the _ star _ of a vertex @xmath21 is the set @xmath120 , the set of edges with initial vertex @xmath21 .",
    "( we will also write @xmath121 for @xmath122 when there is no fear of confusion . ) a morphism of graphs @xmath123 is an _ immersion _ if the induced maps on stars are injective . in this case",
    ", we write @xmath124 .",
    "stallings famously observed that immersions are @xmath30-injective , and that any morphism of finite graphs @xmath125 factors through a canonical immersion @xmath126 where the map @xmath127 is a composition of finitely many folds @xcite .",
    "a _ multicycle _ in a graph @xmath0 is an immersion of graphs @xmath128 , where @xmath129 is a disjoint union of graphs homeomorphic to circles .",
    "the components of @xmath130 are denoted by @xmath27 and the restriction of @xmath19 to @xmath27 is denoted by @xmath131 .",
    "a _ graph pair _ is a space pair @xmath28 , where @xmath0 is a finite graph and @xmath19 is a multicycle .",
    "note that we do not require the graph @xmath0 to be connected .",
    "again , we will need a notion of morphism for graph pairs . as for stallings , for us a morphism of graphs takes vertices to vertices and edges to edges .",
    "since we insist that the maps @xmath19 are immersions , we make a corresponding requirement for morphisms of graph pairs .",
    "let @xmath28 and @xmath36 be graph pairs .",
    "a morphism of space pairs @xmath32 is a _ morphism of graph pairs _ if the map @xmath132 is a morphism of graphs and the map @xmath133 is an immersion .",
    "the first advantage of this setting is that we can certify @xmath30-injective maps using immersions .",
    "note that a morphism of graphs @xmath125 is an immersion if and only if the lift to universal covers @xmath134 is injective .",
    "similarly , we may define an immersion of graph pairs .",
    "a map of graphs pairs @xmath135 is an _ immersion _ if the lifts @xmath134 and @xmath136 are injective . in this case",
    ", we write @xmath137 .    a map of graph pairs factors through a canonical immersion , just as maps of graphs do .",
    "[ lem : folded pair ] a map of graphs pairs @xmath135 factors through a canonical immersion @xmath138 .",
    "the immersion @xmath139 has the universal property that , whenever @xmath71 factors through an immersion @xmath140 , @xmath139 also factors through @xmath140 .",
    "let @xmath54 be the image of @xmath141 in @xmath142 .",
    "we take @xmath143 to be the image of @xmath144 in @xmath145 ; likewise , we take @xmath146 to be the image of @xmath147 in @xmath148 . the group @xmath54 acts naturally on each of these , and we take @xmath149 and @xmath150 to be the respective quotients by the action of @xmath54 .",
    "the class of immersions it too rigid for our purposes , and we would prefer to deal with maps that are essential , but not necessarily immersions . unfortunately , there does not seem to be a good way of certifying essential maps ` locally ' .",
    "however , the next lemma provides a means of locally certifying that a map is @xmath37-essential .",
    "[ lem : d - essential ] if a map of graph pairs @xmath151 is @xmath37-essential and @xmath152 is the corresponding canonical immersion then the induced map @xmath153 is injective .",
    "conversely , if a map of graph pairs @xmath151 factors through an immersion as @xmath154 and @xmath155 is injective then @xmath71 is @xmath37-essential .    by definition , if @xmath71 is @xmath37-essential then the corresponding map @xmath156 is injective on @xmath157 .",
    "the components of these spaces are lines , so the map @xmath156 is itself injective , and so @xmath158 is injective too . finally , since @xmath159 is obtained by quotienting the domain and the range by @xmath160 , it is also injective .    for the converse , if @xmath71 factors as hypothesized , then the lift of @xmath133 factors as @xmath161 the first map is a lift of an injection , hence an injection , and the second map is a lift of an immersion , hence injective .",
    "the result follows since a composition of injective maps is injective .",
    "thus , we can use a map to an immersed pair as a certificate that a morphism of pairs is @xmath37-essential .",
    "we call the data of this certificate a _ @xmath37-immersion_.    [ defn : d - immersion ] a _ @xmath37-immersion _ is a concatenation @xmath162 where @xmath155 is injective .    in general",
    ", a @xmath37-essential morphism may be far from being essential",
    ". however , it turns out that we may promote @xmath37-essential surfaces to essential surfaces  see theorem [ thm : calegari ] below .",
    "given a group pair @xmath163 , where @xmath11 is some non - trivial element of a free group @xmath6 , it is natural to ask ask whether or not @xmath164 is a free factor of @xmath6 .",
    "the standard way of answering this question uses the whitehead graph , which was defined by j. h. c. whitehead in his original paper on automorphisms of free groups @xcite .",
    "( see also @xcite and the references therein for a modern account of whitehead graphs . )",
    "the definition of whitehead graph given in @xcite implicitly involves representing @xmath6 as the fundamental group of a rose  a graph with a single vertex .    here",
    ", we develop the theory of whitehead graphs for general graph pairs .",
    "we are not aware that this approach has been taken in the literature before , but it is similar to the approaches to whitehead graphs given by cashen  macura @xcite and manning @xcite .    consider a graph pair @xmath28 and a vertex @xmath165 of @xmath0 .",
    "whitehead graph _ at @xmath165 is denoted by @xmath166 .",
    "its set of vertices is the star @xmath167 .",
    "the unoriented edges of @xmath166 are the vertices @xmath168 of @xmath130 that map to @xmath165 ; the edge corresponding to @xmath169 joins the vertices @xmath170 and @xmath171 of @xmath166 , where @xmath172 and @xmath173 are the two edges of @xmath130 with @xmath174 .",
    "note that the requirement that the multicycle @xmath19 is an immersion implies that the endpoints of any edge of @xmath166 are distinct .",
    "however , each pair of vertices may be joined by many edges .",
    "we can collect together all the whitehead graphs at the vertices of @xmath0 into a global whitehead graph for the pair @xmath28 .",
    "the _ whitehead graph _ of the pair @xmath28 is the disjoint union @xmath175 note that @xmath176 comes equipped with two additional structures :    a.   the components of @xmath176 are naturally partitioned : two components are equivalent if they are both components of some @xmath166 ; b.   the fixed - point free involution @xmath48 on the edges of @xmath0 defines a fixed - point free involution on the vertices of @xmath176 that extends to a bijection @xmath177 .",
    "we will always think of @xmath176 as equipped with these extra structures .",
    "[ rem : whitehead graphs determine pairs ] the partition on the components of @xmath166 and the involutions @xmath178 are enough information to reconstruct the pair @xmath28 .",
    "stallings studied morphisms of graphs by observing that they always factor as a composition of a sequence of _ folds _ followed by an immersion .",
    "recall that a fold identifies a pair of edges @xmath179 with @xmath180 .",
    "it is therefore natural to study the effect that a fold has on whitehead graphs .",
    "let @xmath181 be a graph and @xmath182 a pair of vertices .",
    "( when we apply this , @xmath181 will be a disjoint union of whitehead graphs . ) a _ wedge _ is a quotient map @xmath183 that identifies @xmath184 and @xmath185 and leaves the rest of @xmath181 unchanged .",
    "we write @xmath186 for the quotient graph @xmath187 . if @xmath188 with @xmath189 then we write @xmath190 for @xmath186 .",
    "the reverse move , which replaces @xmath186 by @xmath181 , is called an _",
    "unwedge_.    the following lemma shows that , at the level of whitehead graphs , folds correspond to wedges .",
    "[ lem : folds give splits ] let @xmath191 be the morphism given by a fold @xmath192 , which identifies two edges @xmath179 of @xmath0 with a common initial vertex @xmath193 to an edge @xmath194 of @xmath195 .",
    "let @xmath196 and let @xmath197 and @xmath198 .",
    "suppose further that @xmath199 is a homotopy equivalence , i.e.  @xmath200 .",
    "then @xmath201 ( note that the unions in this expression may not be disjoint , since @xmath165 may equal @xmath202 for at most one @xmath203 , in which case @xmath204 also equals @xmath205 ) . in particular , @xmath206 is a cut vertex of @xmath207 .",
    "this follows immediately from the definitions .",
    "( the case in which @xmath208 is illustrated in figure [ fig : fold whitehead ] ) .    in the above lemma",
    ", the hypothesis that the map @xmath191 is a _ morphism of pairs _ is essential : if the induced map @xmath209 were not an immersion , then after folding one would need to tighten @xmath210 to an immersion , which might destroy the cut point structure of the whitehead graphs .",
    "[ rem : wedges are injective on oriented edges ] in the setting of lemma [ lem : folds give splits ] , for any vertex @xmath21 of @xmath0 , the map @xmath211 induced by @xmath71 is injective on edges .",
    "in fact , the implication of lemma [ lem : folds give splits ] can be reversed : if one of the whitehead graphs has a cut vertex then we can unfold .",
    "[ lem : splits give folds ] let @xmath212 be a graph pair , and suppose that some edge @xmath206 defines a cut vertex in @xmath207 ( where @xmath198 ) .",
    "then there is a graph pair @xmath28 and a morphism of pairs defining a homotopy - equivalent fold @xmath191 that identifies a pair of edges @xmath179 to @xmath194 .",
    "the hypothesis tells us that @xmath213 , where @xmath214 is a vertex with image @xmath206 in the wedge .",
    "let @xmath197 ( and note that @xmath204 and @xmath205 are not necessarily distinct ) .",
    "we will define the pair @xmath28 via its whitehead graphs ( appealing to remark [ rem : whitehead graphs determine pairs ] ) .",
    "the proof divides into two similar cases , depending on whether or not @xmath215 .",
    "suppose first that @xmath216 . for any vertex @xmath217 of @xmath195 not equal to @xmath204 or @xmath205",
    ", we take a vertex @xmath218 for @xmath0 with whitehead graph isomorphic to @xmath219 .",
    "the remaining vertices of @xmath0 are denoted by @xmath220 .",
    "we define @xmath221 to be @xmath222 for @xmath223 . finally , @xmath166 is defined so that @xmath224 that is , @xmath166 is obtained from @xmath225 by dividing the vertex @xmath194 into two vertices , @xmath179 . the edges of @xmath226 incident at @xmath172 and @xmath173",
    "are defined so that they respect the natural bijections between the stars of the @xmath227 and the stars of the @xmath228 .",
    "there is then a natural lift of the bijections on stars in @xmath229 to bijections on stars in @xmath176 , and this completes the construction of @xmath28 .",
    "the case in which @xmath215 is similar .",
    "again , for any vertex @xmath217 of @xmath195 not equal to @xmath204 or @xmath205 , we take a vertex @xmath218 for @xmath0 with whitehead graph isomorphic to @xmath219 .",
    "the remaining vertices of @xmath0 are denoted by @xmath230 . since @xmath215 , the vertex @xmath194",
    "is contained in @xmath231 , and without loss of generality we may take @xmath232 .",
    "we now define @xmath233 , and @xmath166 so that @xmath234 as before , this means that @xmath226 is obtained by dividing the vertex @xmath194 into two vertices , @xmath179 , and the edges of @xmath166 incident at the @xmath227 are defined to respect the natural bijections between the stars of the @xmath227 and the stars of the @xmath228 . again",
    ", this completes the construction of @xmath28 .    in either case , identifying @xmath172 and @xmath173 defines a fold @xmath235 .",
    "since @xmath236 , the fold is a homotopy equivalence .",
    "note also that , by construction , the fold is a morphism of pairs .",
    "whitehead introduced whitehead graphs to recognize basis elements of free groups and , more generally , free splittings .",
    "( more generally still , whitehead gave an algorithm to find the shortest element in an orbit of the automorphism group . )",
    "we will use whitehead graphs to recognize _ irreducible _ pairs .",
    "[ defn : irreducible pair ] we will call the pair @xmath28 _ reducible _ if : either    a.   [ item : cyclic double ] @xmath142 is cyclic , @xmath130 has one component and @xmath19 is a @xmath30-isomorphism ; or b.   there is a non - trivial free splitting of @xmath142 relative to the family of cyclic subgroups @xmath237 .    if neither of these conditions hold then we call the pair @xmath28 _ irreducible_.    the point of the above definition is that the pair @xmath28 is reducible if and only if the fundamental group of the double @xmath238 , obtained as a graph of spaces with two vertex spaces homeomorphic to @xmath0 and edge maps given by @xmath19 , admits a non - trivial free splitting . item ( [ item : cyclic double ] ) arises because in this instance the fundamental group of the double is @xmath239 , which splits as an hnn extension of the trivial group",
    ".    the following lemma is the key result for recognizing free splittings .",
    "it is quite standard , but we give a proof using folds and wedges as a sample application of the above ideas .",
    "[ lem : whitehead s lemma ] suppose that @xmath19 is an immersion . if @xmath28 is reducible then there is a vertex @xmath165 of @xmath0 so that one of the following holds :    a.   @xmath166 is disconnected ; b.   @xmath166 has a leaf , i.e.  a vertex of valence 1 ; or c.   @xmath166 has a cut vertex , i.e.  a vertex @xmath240 so that @xmath241 is disconnected .",
    "the case in which @xmath142 is cyclic and @xmath242 is a @xmath30-isomorphism is easy and left as an exercise .",
    "suppose therefore that @xmath142 admits a free splitting relative to @xmath19 .",
    "it follows that there is a morphism of graphs @xmath243 which is a homotopy equivalence , so that @xmath195 has a vertex @xmath204 with @xmath225 disconnected .",
    "the morphism @xmath71 now factors as a sequence of homotopy - equivalent folds ; in particular , whenever @xmath172 and @xmath173 with @xmath180 are identified , we have @xmath244 . consider the final such fold , which identifies a pair of distinct vertices @xmath245 to a vertex @xmath246 .",
    "lemma [ lem : folds give splits ] implies that @xmath247 has a cut vertex .",
    "motivated by whitehead s lemma , we call a whitehead graph @xmath166 _ reducible _ if it satisfies one of the three conclusions of the lemma ; otherwise , we call @xmath166",
    "_ irreducible_. we call the pair @xmath28 _ locally irreducible _ if , for every vertex @xmath165 of @xmath0 , the whitehead graph @xmath166 is irreducible .",
    "lemma therefore says that a locally irreducible pair is irreducible .",
    "the converse to this statement is not quite true ",
    "there are irreducible pairs that are not locally irreducible .",
    "to construct an example , take an irreducible pair and apply one fold .",
    "we therefore must allow ourselves to unfold in order to prove a converse to whitehead s lemma .",
    "[ lem : converse to whitehead ] if a pair @xmath28 is irreducible then there is a locally irreducible pair @xmath212 and a map of pairs @xmath248 which is a homotopy equivalence .",
    "if some vertex of @xmath0 has either a disconnected whitehead graph or a leaf then @xmath28 is reducible .",
    "suppose therefore that there is a vertex @xmath246 so that @xmath247 has a cut vertex @xmath249 .",
    "by lemma [ lem : splits give folds ] , there is a fold @xmath248 so that the edge @xmath240 is unfolded to a pair of edges @xmath250 .",
    "note that : the number of edges of @xmath229 is equal to the number of edges of @xmath176 ; the number of vertices of @xmath229 is greater than the number of vertices of @xmath176 ; for each vertex @xmath217 of @xmath195 , the whitehead graph @xmath251 is connected without leaves .",
    "in particular , the number of vertices of @xmath229 is at most the number of edges of @xmath176 .",
    "it follows that only finitely many unfoldings of this form can be performed .",
    "when no further unfoldings can be performed , the final pair @xmath212 is locally irreducible , as claimed .",
    "consider an irreducible graph pair @xmath28 as above . in this section , we will study @xmath37-immersions @xmath162 where @xmath36 is a locally irreducible pair .",
    "we will impose one additional condition on our @xmath37-immersions .",
    "a map of graph pairs @xmath32 is called _ admissible _ if there is a positive integer @xmath252 so that every point in @xmath130 has exactly @xmath253 preimages in @xmath254 .",
    "a @xmath37-immersion @xmath255 is called _ admissible _ if the composition @xmath32 is admissible .",
    "calegari uses the term ` admissible ' similarly for maps of surfaces with boundary @xcite . note that , in his context , the integer @xmath253 counts preimages with a sign determined by orientation , whereas in our context",
    ", the count is unsigned .",
    "we next write down a finite set of pieces , from which @xmath37-immersions of locally irreducible pairs can be constructed .",
    "[ defn : p ] let @xmath256 be the set of components of @xmath176 .",
    "the set @xmath39 of _ pieces ( over @xmath176 ) _ consists of all pairs of maps of graphs ( up to graph isomorphism ) @xmath257 such that @xmath258 is a disjoint union of irreducible graphs , the map @xmath259 is bijective on edges , the map @xmath260 is injective , and @xmath261 .",
    "when @xmath262 is an element of @xmath39 , we will often abuse notation and write @xmath263 , since the map @xmath264 determines @xmath45 .",
    "note that @xmath39 is finite .",
    "this trivial observation is of crucial importance .    we will study admissible @xmath37-immersions of locally irreducible pairs by looking at how they are constructed from the pieces @xmath39 .",
    "the involutions @xmath178 on the stars of vertices of @xmath176 define relations on the elements of @xmath39 , as follows .",
    "consider @xmath265 elements of @xmath39 .",
    "suppose that @xmath240 is a vertex of @xmath266 and that @xmath249 is a vertex of @xmath267 .",
    "let @xmath268 be the set of vertices of @xmath258 that map to @xmath269 , and let @xmath270 be the set of vertices of @xmath271 that map to @xmath272 .",
    "we write @xmath273 if :    a.   @xmath274 , and b.   up to reordering of indices , @xmath178 restricts to bijections @xmath275 for all @xmath276 .",
    "the relation @xmath277 can be interpreted in terms of manning s _ splicing _",
    "operation @xcite .",
    "it says that @xmath258 and @xmath271 can be _ spliced _ at the sets of vertices @xmath278 and @xmath279 , and that @xmath280 and @xmath45 can be spliced at @xmath240 and @xmath249 .    to record how the elements of @xmath39 are glued together ,",
    "we introduce _ @xmath39-stars_.    a _ @xmath39-star _ @xmath281 consists of the following data :    a.   a piece @xmath282 in @xmath39 ; b.   for each vertex @xmath227 of @xmath280 , a choice of piece @xmath283 in @xmath39 and a vertex @xmath228 of @xmath284 so that @xmath285 .",
    "we write @xmath286 and , for each vertex @xmath227 of @xmath258 , we write @xmath287 .",
    "let @xmath288 be the ( finite ) set of all @xmath39-stars .",
    "let @xmath289 and let @xmath290 be the non - negative orthant .",
    "an admissible @xmath37-immersion @xmath291 of a locally irreducible pair @xmath36 defines an integer vector @xmath292 in a natural way , as follows . for each vertex @xmath165 of @xmath293 ,",
    "let @xmath294 be the preimages of @xmath165 in @xmath42 and let @xmath295 be the image vertex in @xmath0 .",
    "the piece @xmath296 is then defined to be @xmath297 if @xmath240 is an edge of @xmath293 with @xmath298 and @xmath299 , then @xmath300 .",
    "therefore , for each vertex @xmath165 of @xmath293 , we can define @xmath301 to be the corresponding @xmath39-star associated to the labels of the neighbouring vertices :    a.   @xmath302 ; and , b.   for each @xmath303 , @xmath304 .",
    "now define @xmath305 to be the vector @xmath306 so that @xmath307 for each @xmath308 .",
    "the image of @xmath309 is not arbitrary : in fact , it is precisely the set of integer points of a certain cone @xmath310 .",
    "we will describe this cone using systems of equations : the gluing equations and the admissibility equations .",
    "we start with the gluing equations .",
    "a non - negative integer vector that satisfies the gluing equations necessarily comes from a @xmath37-immersion of a locally irreducible pair .",
    "we write @xmath311 for an element of @xmath312 . for each pair of pieces @xmath313 and edge @xmath240 satisfying @xmath314 we have the _ gluing equation _",
    "@xmath315 where each sum is taken over all @xmath39-stars @xmath281 satisfying the conditions .",
    "we next describe the admissibility equations , which force any @xmath39-pair that defines a vector to be admissible .",
    "let @xmath316 be an edge of @xmath176 .",
    "for a piece @xmath257 in @xmath39 , set @xmath317 to be the number of preimages of @xmath316 in @xmath258 .",
    "( note that this is either 0 or 1 , by definition . )",
    "we now define a linear map @xmath318 by setting @xmath319 the _ admissibility equations _ assert that @xmath320 for all edges @xmath316 and @xmath321 in @xmath176 .    the cone @xmath310 is now defined to be the subset of @xmath322 that satisfies the gluing equations and the admissibility equations .",
    "[ lem : vectors and pairs ] an integer vector @xmath323 is the image of an admissible @xmath37-immersion from a locally irreducible pair under @xmath309 if and only if it is in @xmath38 .",
    "let @xmath36 be locally irreducible and @xmath324 a @xmath37-immersion .",
    "first we show that @xmath305 satisfies the gluing equations . indeed , the expression in the gluing equations is just two different ways of evaluating the number of edges @xmath240 of @xmath293 with @xmath325 and @xmath326 .",
    "the admissibility equations are satisfied since each @xmath327 evaluates to @xmath328 .",
    "conversely , given an integer vector @xmath329 , we need to construct an admissible @xmath37-immersion @xmath324 with @xmath36 locally irreducible . by remark [ rem :",
    "whitehead graphs determine pairs ] , it is enough to describe @xmath330 together with their pairings on stars of vertices . for each star @xmath281",
    ", @xmath331 contains @xmath332 copies of the piece @xmath333 .",
    "this determines the graphs and maps @xmath331 ; it remains to determine the pairings .",
    "consider the pieces @xmath334 and suppose that @xmath240 is an edge of @xmath280 and @xmath249 is an edge of @xmath45 .",
    "the gluing equations imply that here is a bijection between the number of @xmath39-stars @xmath281 so that @xmath286 and @xmath335 and the number of @xmath39-stars @xmath281 so that @xmath336 and @xmath337 which satisfy the condition that the bijection @xmath338 restricts to a bijection @xmath339 , and thence to bijections of the stars of the preimages in @xmath258 and @xmath271 . choosing a bijection between these @xmath39-stars then determines the required bijection between vertices of the copies of @xmath258 and @xmath271 in these @xmath39-stars , and the bijections between stars are then determined by the relation @xmath340 .    by construction , @xmath36 is locally irreducible and @xmath162 is a @xmath37-immersion . finally , the admissibility equations immediately imply that this @xmath37-immersion is admissible .",
    "thus , we have seen that admissible @xmath37-immersions of locally irreducible pairs correspond naturally to non - zero integer vectors in @xmath38 or , equivalently , to rational points in the projectivization @xmath41 .",
    "motivated by calegari s work on stable commutator length ( see @xcite and @xcite , and also @xcite ) , we will study these rational points via rational functions on @xmath41 .",
    "we start by writing down two natural linear maps on @xmath38 . for an admissible @xmath37-immersion @xmath341 the corresponding linear maps are ( minus ) the euler characteristic of @xmath42 , and the degree @xmath328 with which @xmath254 covers @xmath130 .",
    "the key observation is that both of these can be computed from the vector @xmath305 .",
    "first , the admissibility equations imply that the linear map @xmath327 is independent of @xmath316 .",
    "we therefore write @xmath342 , evidently a linear map which is non - zero on @xmath343 .",
    "second , for a piece @xmath257 in @xmath39 , we let @xmath344 denote the number of connected components of @xmath258 , and let @xmath345 denotes the number of vertices of @xmath258 .",
    "we then define @xmath346 by @xmath347 it s well known that the euler characteristic of a graph can be computed as the sum over the vertices of one minus half the valence , and from this we see that , for an admissible @xmath37-immersion @xmath324 of a locally irreducible pair @xmath36 , we have @xmath348 .",
    "since @xmath349 is a quotient of two linear maps on @xmath343 and the denominator is non - zero , it yields a well defined function on the projectivization @xmath41 .",
    "we call this function @xmath350 the _ projective @xmath39-rank _ function on @xmath41 .",
    "[ rem : p - rank and covers ] suppose @xmath255 is an admissible @xmath37-immersion of a locally irreducible pair .",
    "suppose that @xmath351 is a @xmath352-sheeted covering map .",
    "then @xmath353 is @xmath37-essential and , therefore , by lemma [ lem : d - essential ] , @xmath354 is also a @xmath37-immersion of a locally irreducible pair . furthermore , since @xmath355 and @xmath356 , we see that @xmath357 .    in analogy with stable commutator length ( see @xcite ) , we may use the rational function @xmath40 to define an invariant of a multicycle @xmath19 in a graph @xmath0 .",
    "the _ maximal @xmath39-rank _ of a pair @xmath28 is denoted by @xmath358 and defined to be @xmath359\\in{\\mathbb{p}}({c_{\\mathcal{p}}})}\\rho_{\\mathcal{p}}[{\\underline{x}}]~.\\ ] ] note that this maximum is indeed realized , since @xmath41 is compact .",
    "similarly , the _ minimal _ @xmath39-rank , @xmath360 , is defined to the minimum of @xmath40 over the same domain .",
    "since @xmath41 is compact , the maximal and minimal @xmath39-ranks are certainly attained as long as @xmath41 is non - empty ( i.e.  as long as @xmath38 is non - zero ) . in fact , since @xmath40 is a quotient of linear maps , the maximal and minimal @xmath39-ranks are attained on rational points of @xmath41 , and hence are realized by admissible @xmath37-immersions .",
    "[ thm : rationality theorem ] if @xmath361 , then the maximal and minimal @xmath39-ranks are realized by admissible @xmath37-immersions of locally irreducible pairs ; that is , there exist locally irreducible pairs @xmath362 and admissible @xmath37-immersions @xmath363 so that @xmath364 . in particular , @xmath365 are positive rational numbers .",
    "we prove the result for the maximal @xmath39-rank ; the proof for the minimal @xmath39-rank is identical . if @xmath361 then the projectivization @xmath41 is non - empty . from the definition of @xmath366 , we may normalize and restrict our attention to the rational polytope @xmath367 , so @xmath368 but @xmath369 is linear , and so attains its maximum on a vertex @xmath370 of @xmath367 . since @xmath370 is rational and @xmath366 is a projective function , there is some integer vector @xmath371 , a multiple of @xmath370 , on which @xmath366 attains its maximum .",
    "since @xmath372 is an integer vector , it is equal to @xmath305 for some admissible @xmath39-pair @xmath36 , which therefore realizes @xmath366 , as required .",
    "an admissible @xmath37-immersion @xmath373 of a locally irreducible pair @xmath36 for which @xmath374 is called _ maximal_. ( similarly , if @xmath375 then the @xmath37-immersion is called _",
    "minimal_. )    the above theorem is very much in the spirit of calegari s proof of the rationality of stable commutator length in free groups @xcite , modulo certain additional questions of orientability .",
    "it is possible to give a proof of the main theorem of @xcite along very similar lines .",
    "the following consequence of the results of @xcite will enable us to promote @xmath37-essential surfaces to essential surfaces .",
    "the reader is also referred to @xcite for a comprehensive account of stable commutator length and extremal surfaces in free groups .",
    "[ thm : calegari ] suppose that @xmath28 is a graph pair .",
    "if there exists a compact surface with boundary @xmath33 and a @xmath37-essential , admissible map @xmath34 , then there exists a compact surface with boundary @xmath376 and an essential , admissible map @xmath377 .    passing to a double cover if necessary",
    ", we may assume that @xmath378 is oriented . by a result of culler @xcite",
    ", we may assume that @xmath34 is realized by a map of graph pairs ( where @xmath378 is realized by a fatgraph , i.e.  a graph pair in which the whitehead graph at every vertex is a circle ) .",
    "let @xmath379 be the result of folding the map @xmath380 .",
    "by lemma [ lem :",
    "d - essential ] , the map @xmath381 is a homeomorphism .",
    "therefore , we may equip @xmath382 with the orientation of @xmath35 . in this case",
    ", @xmath383 now defines a boundary cycle in @xmath293 , and so by the main theorem of @xcite , some integer multiple of @xmath383 bounds an extremal surface @xmath384 . but extremal surfaces are essential : ( * ? ? ?",
    "* lemma 2.9 ) shows that extremal surfaces are @xmath30-injective , and a similar argument using boundary compressions shows that they are also @xmath37-essential . since @xmath379 is also essential and admissible , and a composition of essential , admissible maps is essential and admissible , this completes the proof .",
    "our results so far imply that every irreducible pair admits a maximal @xmath37-immersion .",
    "[ lem : maximal pairs exist ] if @xmath28 is irreducible then there exists a maximal , admissible @xmath37-immersion @xmath385 for a locally irreducible pair @xmath36 .",
    "since @xmath28 is irreducible , lemma [ lem : converse to whitehead ] guarantees a locally irreducible pair @xmath248 .",
    "the map @xmath248 consists of a @xmath30-isomorphism and a homeomorphism @xmath386 , so is certainly admissible and essential .",
    "in particular , @xmath387 is an admissible @xmath37-immersion of a locally irreducible pair , so @xmath388 and @xmath361 .",
    "theorem [ thm : rationality theorem ] now implies that a maximal @xmath37-immersion exists .    in this section , we shall use the relative jsj decomposition together with the results of @xcite to show that maximal @xmath37-immersions are closely related to surfaces .",
    "let @xmath28 be a graph pair , and consider the mapping cylinder @xmath389 of @xmath390 .",
    "the pair @xmath28 is said to be of _ surface type _ if the pair of spaces @xmath391 is homotopy equivalent to a pair @xmath378 , where @xmath33 is a compact surface with boundary .",
    "a theorem of culler @xcite shows that any pair @xmath28 of surface type can be unfolded to a _ fatgraph _",
    "@xmath212  a graph pair in which every whitehead graph is a cycle .",
    "one may therefore equivalently think of pairs of surface type as given by fatgraphs .",
    "fundamental groups of pairs of surface type can typically be decomposed as graphs of groups in many ways . in order to discuss this",
    ", we introduce some terminology for graph - of - groups decompositions of pairs .",
    "[ defn : decomposition of group pair ] let @xmath53 be a group pair . a _ decomposition _ of @xmath53 is a graph of groups @xmath59 with fundamental group @xmath54 such that , for every @xmath69 , the stabilizer @xmath392 is conjugate into a vertex group of @xmath59 .",
    "let @xmath21 be a vertex of @xmath59 , and fix a pre - image @xmath60 of @xmath21 in the bass  serre tree",
    "let @xmath394 be the stabilizer of @xmath60 .",
    "set @xmath395 and let @xmath396 be the set of edges of @xmath393 incident at @xmath60 .",
    "the _ induced pair _ at @xmath21 is defined to be @xmath397 , which is defined up to conjugacy in @xmath54 .",
    "the vertex @xmath21 is called _ peripheral _ if @xmath398 is non - empty .",
    "if every edge group of @xmath59 is cyclic then @xmath59 is said to be a _",
    "decomposition of @xmath53 . as usual , the graph of groups @xmath59 is called _ trivial _ if @xmath54 is the stabilizer of some vertex of the bass  serre tree .",
    "we will only be concerned with cyclic decompositions of graph pairs @xmath28 , with @xmath399 .",
    "we will abuse notation and write the corresponding group pair as @xmath400 .",
    "pairs of surface type can be contrasted with rigid pairs , which only have trivial decompositions .    a graph pair @xmath28 is _ rigid _ if every cyclic decomposition of @xmath28 is trivial , and if @xmath28 is not of surface type .",
    "( this last requirement is to rule out the pair of pants , which is of surface type but admits no cyclic decompositions . )",
    "a group pair @xmath400 is _ rigid _ if some ( any ) corresponding graph pair is rigid .",
    "the main theorem of this section is phrased in terms of the _ relative jsj decomposition _ of the group pair @xmath400 .",
    "this is a canonical decomposition of the pair @xmath400 , which in a sense encodes all cyclic decompositions .",
    "the absolute version of this decomposition was described in the hyperbolic case by bowditch @xcite ; the relative version in the free case was described by cashen @xcite .",
    "see also the work of guirardel and levitt , who explain how to construct this jsj decomposition as a tree of cylinders @xcite .",
    "[ thm : jsj ] let @xmath400 be an irreducible group pair .",
    "there is a canonical cyclic decomposition @xmath59 for @xmath6 with the following properties .",
    "a.   the underlying graph of @xmath59 has three kinds of vertices  rigid , surface and cyclic  such that : 1 .",
    "if a vertex @xmath21 is of rigid type then the induced pair at @xmath21 is a rigid group pair ; 2 .",
    "if a vertex @xmath21 is of surface type then the induced pair at @xmath21 is of surface type ; 3 .",
    "if a vertex @xmath21 is cyclic then the vertex group @xmath401 is ( infinite ) cyclic .",
    "b.   the underlying graph of @xmath59 is bipartite , with red vertices cyclic and green vertices either rigid or surface . in particular",
    ", every edge adjoins exactly one cyclic vertex . c.   every peripheral subgroup @xmath402 is conjugate into a unique cyclic vertex group .",
    "( these cyclic vertices are called _",
    "peripheral_. )    the decomposition @xmath59 guaranteed by the theorem is called the _ relative jsj decomposition _ of the pair @xmath400 . for an irreducible graph pair @xmath28",
    ", we will refer to the disjoint union of the relative jsj decompositions of the fundamental groups of the components as the _ relative jsj decomposition _ of the pair @xmath28 .",
    "we are now ready to state the main theorem of this section , which describes the relative jsj decompositions of maximal @xmath37-immersions .",
    "[ thm : maximal pairs and surfaces ] if @xmath36 is locally irreducible and @xmath324 is a maximal , admissible @xmath37-immersion then the relative jsj decomposition of @xmath36 has no rigid vertices . furthermore ,",
    "if there is such a maximal @xmath37-immersion , then there is a maximal @xmath37-immersion of surface type .",
    "the proof is based on ideas from @xcite ; the main technical result of that paper is as follows ( * ? ? ?",
    "* theorem 8) .",
    "[ thm : local theorem ] if @xmath28 is a rigid graph pair then there is a finite - sheeted cover @xmath403 such that , whenever a finite - sheeted cover @xmath248 factors through @xmath404 , the pair @xmath405 is irreducible for any component @xmath406 of @xmath210 .",
    "we will also need a relative analogue of shenitzer s lemma  see , for instance , ( * ? ? ?",
    "* corollary 1.1 )  which we state here in the terminology of this paper .",
    "[ lem : relative shenitzer ] consider a decomposition @xmath59 of a group pair @xmath400 .",
    "if the induced pair at every vertex of @xmath59 is irreducible then the pair @xmath400 is irreducible .",
    "we now assemble the lemmas that we will need to prove theorem [ thm : maximal pairs and surfaces ] .",
    "the first shows how to use a rigid vertex to increase irreducible rank .",
    "its proof is illustrated in figure [ fig : rigid vertex ] .",
    "[ lem : rigid implies non - maximal ] let @xmath28 be an irreducible graph pair . if the relative jsj of @xmath28 has a rigid vertex then there is a locally irreducible pair @xmath212 and an admissible , essential map @xmath248 with @xmath407    consider the relative jsj decomposition @xmath59 of the pair @xmath28 . by theorem",
    "[ thm : local theorem ] and marshall hall s theorem @xcite , after replacing @xmath28 with a finite - sheeted cover we may assume that every rigid vertex @xmath408 has the property guaranteed by theorem [ thm : local theorem ] . note that , if @xmath409 denotes the valence of the vertex @xmath21 , then every rigid vertex @xmath410 has @xmath411 .    to construct @xmath195 , we realize the relative jsj of @xmath28 as a graph of spaces @xmath20 .",
    "we may take the vertex spaces of @xmath20 to be graphs and the edge spaces to be circles , although this is not important for the subsequent argument .",
    "we now construct a new graph of spaces @xmath98 and an essential map @xmath412 .",
    "let @xmath413 , where the product is taken over all rigid vertices of @xmath20 . for each non - rigid vertex @xmath23",
    ", we take @xmath414 copies of the induced pair at @xmath21 .",
    "consider a rigid vertex @xmath410 , with incident edges @xmath415 .",
    "for each edge @xmath416 incident at @xmath410 , we take @xmath417 copies of the pair @xmath418 .",
    "note that every edge space of @xmath20 appears exactly @xmath414 times in this collection of pairs .",
    "we may therefore glue the resulting collection of pairs up to form a graph of spaces @xmath98 .    by construction , @xmath98 is naturally equipped with a map @xmath412 , which is @xmath30-injective by proposition [ prop : essential maps of graphs of groups ] .",
    "furthermore , @xmath98 is naturally equipped with exactly @xmath414 copies of component of @xmath19 ; we call this map of circles @xmath419 .",
    "let @xmath420 be the disjoint unions of the cores ( in the sense of @xcite ) of the covers of @xmath0 corresponding to the components of @xmath421 .",
    "we may realize @xmath422 as a collection of cycles in @xmath420 .",
    "then @xmath423 is an admissible , essential map .",
    "the pair @xmath424 is irreducible by lemma [ lem : relative shenitzer ] , and hence by lemma [ lem : converse to whitehead ] , can be unfolded to a locally irreducible pair @xmath248 .    finally , we compute euler characteristics .",
    "we have @xmath425 , while @xmath426 ( where @xmath410 ranges over all the rigid vertices of @xmath20 and @xmath21 ranges over all the non - rigid vertices ) .",
    "this completes the proof .",
    "a similar argument shows that there are always maximal pairs of surface type .",
    "[ lem : maximal surface type ] let @xmath28 be an irreducible graph pair . if the relative jsj of @xmath28 has no rigid vertices then there is a locally irreducible group pair @xmath212 of surface type and an admissible , essential @xmath248 with @xmath427    consider the jsj decomposition @xmath59 of the pair @xmath28 . by marshall hall s theorem",
    ", we may assume that the attaching maps at cyclic vertices are all isomorphisms .",
    "we realize @xmath428 as a graph of spaces @xmath20 in the natural way , taking each surface vertex to be a compact surface and each cyclic vertex to be a circle , and define a new graph of spaces @xmath98 as follows .",
    "we take @xmath429 copies of each surface vertex @xmath23 .",
    "we take @xmath430 copies of each non - peripheral cyclic vertex space @xmath431 .",
    "we take @xmath429 copies of each peripheral cyclic vertex space @xmath431 of @xmath20 ; these will each be a peripheral vertex of @xmath98 .",
    "finally , we take @xmath432 further copies of each peripheral vertex space @xmath431 ; these will be non - peripheral vertices of @xmath98 .",
    "it is now easy to see that we can assemble these to form @xmath98 so that every non - peripheral cyclic vertex group has exactly two incident edges and all the attaching maps are isomorphisms . as before , the natural map @xmath412 is @xmath30-injective by proposition [ prop : essential maps of graphs of groups ] .",
    "every non - peripheral cyclic vertex @xmath11 is adjacent to exactly two surface vertices , and identified with two boundary components of these .",
    "we may therefore contract the two edges adjacent to @xmath11 to obtain a larger surface vertex .",
    "thus , the resulting graph of spaces @xmath98 is homeomorphic to a surface @xmath33 .",
    "the peripheral cyclic vertices equip @xmath98 with exactly two copies of each component of @xmath19 ; we call this collection of cyclic subgroups @xmath210 .",
    "we note that @xmath433 and that , since only surface vertices contribute to euler characteristic , @xmath434 . therefore , if we replace @xmath435 by a locally irreducible graph pair @xmath212 as in the previous lemma , @xmath436 .    at this stage",
    ", we have a locally irreducible , admissible pair @xmath212 of surface type , satisfying the required constraints on euler characteristic , so that each component of @xmath210 is conjugate into some component of @xmath35 ( and every component of @xmath35 contains a component of @xmath210 ) . to make this pair of surface type , we need @xmath210 to be identified bijectively with @xmath35 . to ensure this , we first invoke marshall hall s theorem again , replacing @xmath195 with a finite - sheeted cover and @xmath210 with its pullback , so that each component of @xmath210 maps isomorphically to the component of @xmath35 that contains it .",
    "for each component @xmath437 , let @xmath438 be the number of components of @xmath210 contained in @xmath439 .",
    "replacing @xmath33 with two copies of itself , we may assume that each @xmath438 is even .",
    "without loss of generality , we may also assume that @xmath440 is minimal among the @xmath438 .",
    "we now take @xmath440 copies of @xmath33 , and equip each boundary component with exactly one component of @xmath210 .",
    "we may then add annuli to @xmath33 to pair up the remaining components of @xmath210 .",
    "this completes the proof .",
    "we can now apply these two lemmas to prove that we can always find a maximal @xmath37-immersion of surface type .",
    "suppose that the relative jsj decomposition of @xmath36 has a rigid vertex .",
    "lemma [ lem : rigid implies non - maximal ] applied to @xmath36 yields a locally irreducible pair @xmath441 and an admissible , essential map @xmath351 .",
    "the composition @xmath442 is @xmath37-essential and therefore , by lemma [ lem : d - essential ] , there is a @xmath37-immersion @xmath354 where @xmath443 is the canonical immersion associated to @xmath353 .",
    "this @xmath37-immersion then has greater projective @xmath39-rank , which is a contradiction .",
    "the second part of the theorem follows in the same way , using lemma [ lem : maximal surface type ] instead of lemma [ lem : rigid implies non - maximal ] .",
    "our main technical theorem follows immediately .",
    "[ thm : essential surfaces exist ] let @xmath28 be an irreducible graph pair .",
    "there exists a compact surface with boundary @xmath33 and an admissible , essential map @xmath34 .    by lemma [ lem :",
    "maximal pairs exist ] , a maximal @xmath37-immersion @xmath324 exists . by theorem [ thm : maximal pairs and surfaces ]",
    ", there is such a maximal @xmath36 of surface type .",
    "the result now follows from theorem [ thm : calegari ] .",
    "in this section we deduce the claimed consequences of theorem [ thm : essential surfaces exist ] . we start with graphs of virtually free groups with virtually cyclic edge groups .",
    "the deduction of the existence of surface subgroups from a result like theorem [ thm : essential surfaces exist ] is well known ( cf .",
    "@xcite or @xcite , for instance ) ; we include an argument here for completeness .",
    "[ thm : surface subgroups ] let @xmath0 be the fundamental group of a graph of virtually free groups with virtually cyclic edge groups . if @xmath0 is hyperbolic and one - ended then @xmath0 contains a quasiconvex surface subgroup .    by @xcite ,",
    "@xmath0 is residually finite and so virtually torsion - free .",
    "we may therefore assume that @xmath0 is the fundamental group of a graph of free groups with cyclic edge groups .",
    "we call the vertices @xmath21 of the underlying graph of @xmath0 _ non - cyclic _ , and subdivide each edge , putting a _ cyclic _",
    "vertex in the middle with vertex - group @xmath444 .",
    "consider the induced pair @xmath445 for a non - cyclic vertex @xmath21 .",
    "since @xmath0 is one - ended , @xmath445 is irreducible . by theorem [ thm : essential surfaces exist ] , we can replace each @xmath445 by an admissible , essential map of a surface pair @xmath446 . by gluing these to the adjacent cyclic vertices ,",
    "we define a new graph of free groups with cyclic edge groups @xmath447 , with every non - cyclic vertex of surface type .",
    "note that @xmath448 for all @xmath21 .",
    "the fundamental group @xmath449 of @xmath447 is equipped with a natural map @xmath450 , and by proposition [ prop : essential maps of graphs of groups ] , @xmath71 is injective .",
    "in particular , @xmath449 contains no baumslag ",
    "solitar subgroups , since @xmath0 is hyperbolic .",
    "the graph of groups @xmath447 is a graph of surfaces glued along their boundary components to circles , which we realize in the natural way as a graph of spaces @xmath20 .",
    "note that @xmath451 .",
    "by @xcite , after replacing @xmath449 by a subgroup of finite index , we may assume that the attaching maps are all homeomorphisms .",
    "it is then easy to see that @xmath20 can be thickened to a 3-manifold @xmath452 with boundary .",
    "since closed 3-manifolds have zero euler characterisitic , @xmath453 and so we may choose a component @xmath33 of @xmath454 with @xmath455 .",
    "inclusion induces a natural map @xmath456 . but",
    "@xmath449 is one - ended by shenitzer s lemma , and dehn s lemma then implies that the map @xmath456 ( and hence the composition @xmath457 ) is injective .    finally , @xmath0 is locally quasiconvex ( * ? ? ?",
    "* theorem d ) , and hence the surface subgroup @xmath458 is quasiconvex .",
    "this completes the proof .    a group @xmath0 is called _ rigid _ if it does not split over a ( possibly finite ) virtually cyclic subgroup .",
    "given a group @xmath0 , a _ virtually cyclic hierarchy _",
    "for @xmath0 is a set of subgroups of @xmath0 obtained by passing to the vertex groups of a splitting of @xmath0 over virtually cyclic edge groups , and then repeating this operation on those subgroups recursively .",
    "if a finite virtually cyclic hierarchy exists , terminating in ( possibly finite ) rigid subgroups , then we shall say that @xmath0 _ has a finite hierarchy_. graphs of virtually free groups with virtually cyclic edge groups play a special role in the subgroup theory of groups that have finite hierarchies .",
    "let @xmath54 be a one - ended group with a finite hierarchy , and let @xmath449 be a one - ended subgroup in the hierarchy of @xmath54 with no one - ended subgroups below it .",
    "then either @xmath449 is rigid or @xmath449 is a graph of virtually free groups over virtually cyclic edge groups .    in @xcite",
    ", sela showed that limit groups have a finite hierarchy .",
    "he also showed that a limit group without a @xmath459 subgroup is hyperbolic , and that non - abelian limit groups are never rigid .",
    "we thus obtain :    [ cor : surface subgroups of limit groups ] every one - ended limit group contains a surface subgroup .",
    "louder and touikan showed that a hyperbolic group without 2-torsion has a finite hierarchy @xcite .",
    "( the restriction on 2-torsion is technical , and conjecturally can be removed . )",
    "we thus obtain the following contribution towards the complete resolution of gromov s question .",
    "[ cor : surface or rigid ] every one - ended hyperbolic group without 2-torsion either contains a surface subgroup or contains a quasiconvex , infinite , rigid subgroup .    in particular , gromov s question is reduced to the rigid case ( modulo the technical issue of 2-torsion ) .",
    "in this section we discuss applications to question [ qu : remeslennikov ] and related problems . as explained in ( * ? ? ?",
    "* theorem 4.17 ) , corollary [ cor : surface subgroups of limit groups ] resolves the question for limit groups .",
    "we include the proof for completeness .",
    "the key point is that it follows that the profinite completions of non - free limit groups have non - zero virtual second cohomology .",
    "we work with continuous cohomology , with coefficients in @xmath460 .      by corollary [ cor : surface subgroups of limit groups ]",
    ", @xmath9 contains a subgroup @xmath463 isomorphic to the fundamental group of a closed surface of non - positive euler characteristic ; in particular , @xmath464 ( with coefficients in @xmath460 ) .",
    "since surface groups are _ good _ in the sense of serre @xcite , it follows that the continuous cohomology @xmath465 is also non - zero . by @xcite",
    ", @xmath463 is a virtual retract of @xmath9 , so there is a finite - index subgroup @xmath461 containing @xmath463 and a retraction @xmath466 . let @xmath467 be the inclusion map , so @xmath468 . both @xmath469 and @xmath203 extend by continuity to maps",
    "@xmath470 and @xmath471 , and @xmath472 .",
    "therefore the induced maps on cohomology satisfy @xmath473 .",
    "in particular , since @xmath465 is non - zero , @xmath474 is also non - zero , as claimed .    since every open subgroup of a profinite free group is profinite free , and hence has zero second cohomology , corollary [ introcor : remeslennikov for limit groups ] follows immediately .",
    "corollary [ introcor : pp ] also follows quickly from theorem [ thm : profinite vb2 for limit groups ]    to prove the contrapositive , we assume that @xmath19 is not primitive in @xmath6 . recall that the _ double _",
    "@xmath238 is the fundamental group of the graph of groups with two vertices labelled by @xmath6 , and one edge between them for each component of @xmath19 .",
    "the double @xmath238 is a limit group and hence , by theorem [ thm : profinite vb2 for limit groups ] , has a subgroup @xmath475 of finite index with @xmath476 .",
    "if @xmath19 were primitive in @xmath14 then @xmath477 would be free profinite , hence so would @xmath478 , and therefore @xmath479 would be zero , a contradiction .",
    "noel brady , matt clay , and max forester .",
    "turn graphs and extremal surfaces in free groups . in _",
    "topology and geometry in dimension three _ , volume 560 of _ contemp .",
    "_ , pages 171178 .",
    "soc . , providence , ri , 2011 .",
    "g.  a. noskov , v.  n. remeslennikov , and v.  a. romankov . infinite groups . in _ algebra .",
    "geometry , vol .",
    "17 ( russian ) _ , pages 65157 , 308 .",
    "nauk sssr , vsesoyuz .",
    "informatsii , moscow , 1979 .",
    "peter scott and terry wall .",
    "topological methods in group theory . in _",
    "homological group theory ( proc .",
    "durham , 1977 ) _ , volume  36 of _ london math .",
    "lecture note ser .",
    "_ , pages 137203 .",
    "cambridge univ . press , cambridge , 1979 ."
  ],
  "abstract_text": [
    "<S> a well known question of gromov asks whether every one - ended hyperbolic group @xmath0 has a surface subgroup . </S>",
    "<S> we give a positive answer when @xmath0 is the fundamental group of a graph of free groups with cyclic edge groups . as a result </S>",
    "<S> , gromov s question is reduced ( modulo a technical assumption on 2-torsion ) to the case when @xmath0 is rigid . </S>",
    "<S> we also find surface subgroups in limit groups . </S>",
    "<S> it follows that a limit group with the same profinite completion as a free group must in fact be free , which answers a question of remeslennikov in this case .    </S>",
    "<S> this paper addresses a well known question about hyperbolic groups , usually attributed to gromov .    </S>",
    "<S> [ qu : gromov ] does every one - ended hyperbolic group contain a surface subgroup ?    here , a _ surface subgroup _ is a subgroup isomorphic to the fundamental group of a closed surface of non - positive euler characteristic . </S>",
    "<S> various motivations for gromov s question can be given . </S>",
    "<S> it generalizes the famous surface subgroup conjecture for hyperbolic 3-manifolds , but it is also a natural challenge when one considers that the ping - pong lemma makes free subgroups very easy to construct in hyperbolic groups , whereas a theorem of gromov  sela  </S>",
    "<S> delzant @xcite asserts that a one - ended group has at most finitely many images in a hyperbolic group . </S>",
    "<S> more recently , markovic proposed finding surface subgroups as a route to proving the cannon conjecture @xcite .    </S>",
    "<S> several important cases of gromov s question have recently been resolved . </S>",
    "<S> most famously , kahn and markovic proved the surface subgroup conjecture @xcite . extending their work has been the topic of a great deal of recent research ( see @xcite , for instance ) . in another dramatic development , </S>",
    "<S> calegari and walker answered gromov s question affirmatively for random groups @xcite , following similar results for random ascending hnn extensions of free groups ( by the same authors @xcite ) and random graphs of free groups with edge groups of rank at least two ( by calegari and the author @xcite ) .    in this paper , we resolve gromov s question for a contrasting class of hyperbolic groups  graphs of free groups with cyclic edge groups . </S>",
    "<S> our main theorem answers gromov s question affirmatively in this case .    </S>",
    "<S> [ thm : gofgwceg ] let @xmath0 be the fundamental group of a graph of free groups with cyclic edge groups . if @xmath0 is one - ended and hyperbolic then @xmath0 contains a quasiconvex surface subgroup .    in fact , using a result of wise , we are able to find surface subgroups in graphs of _ virtually _ free groups with _ virtually _ cyclic edge groups ; see theorem [ thm : surface subgroups ] below .    </S>",
    "<S> numerous special cases of this result are already known . </S>",
    "<S> calegari used his work on the rationality of stable commutator length in free groups @xcite to show that surface subgroups exist when @xmath1 @xcite . </S>",
    "<S> infinite classes of examples were found by the author in joint works with gordon @xcite and with kim @xcite . </S>",
    "<S> kim and oum found surface subgroups in doubles of free groups of rank two @xcite . </S>",
    "<S> the author answered a weaker version of gromov s question for this class of groups , by showing that every such @xmath0 is either a surface group or contains a finitely generated , one - ended subgroup of infinite index @xcite .    </S>",
    "<S> although the class of hyperbolic groups covered by theorem [ thm : gofgwceg ] is quite specific , the theorem has wider consequences for gromov s question . </S>",
    "<S> we call a group _ rigid _ if it does not admit a non - trivial splitting with a virtually cyclic edge group . using strong accessibility @xcite we can , </S>",
    "<S> modulo a technical hypothesis on 2-torsion , reduce gromov s question to the rigid case , using the following corollary .    </S>",
    "<S> [ lettercor : surface or rigid ] let @xmath0 be a one - ended hyperbolic group without 2-torsion . either @xmath0 contains a quasiconvex surface subgroup , or @xmath0 contains a quasiconvex rigid subgroup </S>",
    "<S> .    see corollary [ cor : surface or rigid ] for full details . by a theorem of bowditch @xcite , a one - ended hyperbolic </S>",
    "<S> group @xmath0 is rigid if and only if its gromov boundary does not contain local cut points ( unless @xmath0 is a finite extension of a triangle group ) . </S>",
    "<S> corollary [ lettercor : surface or rigid ] should be useful in any attempt at a general answer to gromov s question , since local cut points in the boundary present extra technical challenges for the ergodic techniques of @xcite and the probabilistic techniques of @xcite , as witnessed by the difficulties resolved in kahn and markovic s proof of the ehrenpreis conjecture @xcite .    </S>",
    "<S> a _ limit group _ is a finitely generated , fully residually free group  that is , a finitely generated group in which every finite subset can be mapped injectively into a free group by a group homomorphism . </S>",
    "<S> limit groups play a central role in the study of algebraic geometry and logic over free groups ; see @xcite _ et seq . </S>",
    "<S> _ ,  in which they were defined , and also the parallel project @xcite _ et seq . </S>",
    "<S> _ theorem [ thm : gofgwceg ] addresses the key case for the problem of finding surface subgroups of limit groups , and so we can also answer gromov s question in that context .    [ </S>",
    "<S> lettercor : limit groups ] let @xmath0 be a limit group . </S>",
    "<S> if @xmath0 is one - ended then @xmath0 contains a surface subgroup .    </S>",
    "<S> see corollary [ cor : surface subgroups of limit groups ] for details . </S>",
    "<S> note that limit groups are not all hyperbolic , but they are all toral relatively hyperbolic @xcite . </S>",
    "<S> in particular , non - hyperbolic limit groups contain a @xmath2 subgroup , so the hyperbolic case is the one of interest .    </S>",
    "<S> these results have interesting applications to a different structural problem in group theory . </S>",
    "<S> recall that the _ profinite completion _ </S>",
    "<S> , @xmath3 , of a group @xmath0 is the closure of the image of @xmath0 in the direct product of its finite quotients ( endowed with the product topology ) . </S>",
    "<S> if two groups @xmath4 and @xmath5 have isomorphic profinite completions , then it is natural to ask whether @xmath4 and @xmath5 must be isomorphic .    in general , the anwer is ` no ' . </S>",
    "<S> there are even examples of non - isomorphic pairs of virtually cyclic groups with isomorphic profinite completions @xcite . </S>",
    "<S> nevertheless , many important questions of this type remain open , of which the following question of remeslennikov is one of the most notable ( * ? ? </S>",
    "<S> * question 15 ) .    </S>",
    "<S> [ qu : remeslennikov ] suppose that @xmath6 is a finitely generated , non - abelian free group and that @xmath0 is finitely generated and residually finite . </S>",
    "<S> if @xmath7 , does it follow that @xmath8 ?    </S>",
    "<S> it is particularly natural to consider question [ qu : remeslennikov ] when @xmath0 is a limit group . </S>",
    "<S> indeed , limit groups are closely related to free groups ( for instance , remeslennikov showed that they are precisely the _ existentially free groups _ </S>",
    "<S> @xcite ) , and are frequently hard to distinguish from them . </S>",
    "<S> bridson , conder and reid @xcite pointed out that corollary [ lettercor : limit groups ] , combined with the results of @xcite , would resolve remeslennikov s question in this case .    </S>",
    "<S> [ introcor : remeslennikov for limit groups ] if @xmath9 is a limit group and not free then the profinite completion @xmath10 is not isomorphic to the profinite completion of any free group .    </S>",
    "<S> the same ideas give a new proof of a theorem of puder and parzanchevski ( * ? ? ? </S>",
    "<S> * corollary 1.5 ) . recall that a word @xmath11 in a free group @xmath6 is called _ primitive _ if @xmath6 splits as a free product @xmath12 . </S>",
    "<S> similarly , an element @xmath13 of the profinite free group @xmath14 is called _ primitive _ if @xmath14 decomposes as a coproduct @xmath15 in the category of profinite groups . </S>",
    "<S> puder and parzanchevski showed that an element @xmath11 of @xmath6 that is primitive in the profinite completion @xmath14 is already primitive in @xmath6 ( * ? ? ? </S>",
    "<S> * corollary 1.5 ) . </S>",
    "<S> this can be thought of as answering a relative version of question [ qu : remeslennikov ] .    </S>",
    "<S> in fact , we can generalize their result , from words to multiwords ( i.e.  finite indexed sets of words ) . </S>",
    "<S> let us call a multiword @xmath16 in @xmath6 _ primitive _ if @xmath6 splits as a free product @xmath17 for some @xmath18 , and make the corresponding definition of a primitive multiword in @xmath14 .    </S>",
    "<S> [ introcor : pp ] let @xmath6 be a finitely generated free group . </S>",
    "<S> if a multiword @xmath19 is primitive in the profinite completion @xmath14 then it is primitive in @xmath6 .    </S>",
    "<S> it is interesting to contrast the techniques of this paper with those of @xcite . </S>",
    "<S> puder and parzanchevski deduce their result from their beautiful characterization of primitive words in free groups as precisely the _ measure - preserving words _ </S>",
    "<S> ( * ? ? ? </S>",
    "<S> * theorem 1.1 ) . </S>",
    "<S> the proof given here is cohomological , and goes via the fact that the virtual second cohomology of the profinite completion of a non - free limit group is non - zero . </S>",
    "<S> corollaries [ introcor : remeslennikov for limit groups ] and [ introcor : pp ] follow quickly from theorem [ thm : profinite vb2 for limit groups ] . </S>",
    "<S> we refer the reader to that theorem and the subsequent remarks for details .    </S>",
    "<S> let us now turn to discuss the proof of theorem [ thm : gofgwceg ] . </S>",
    "<S> our main technical result addresses a _ </S>",
    "<S> relative _ version of gromov s question , finding surfaces in free groups relative to families of cyclic subgroups . to state it concisely </S>",
    "<S> we need to introduce some definitions .    </S>",
    "<S> consider a graph of spaces @xmath20 in the sense of scott and wall @xcite , and let @xmath21 be a vertex with incident edges @xmath22 . </S>",
    "<S> the vertex space @xmath23 , together with the maps of incident edge spaces @xmath24 , defines a _ space pair _ @xmath25 . in the case of interest , </S>",
    "<S> the vertex space @xmath23 will always be a graph ( usually denoted by @xmath0 ) , and the edge spaces @xmath26 will be circles @xmath27 ; such a @xmath28 is called a _ </S>",
    "<S> graph pair_.    global properties of the graph of spaces @xmath20 can be characterized locally , using properties of the pairs associated to vertex spaces . </S>",
    "<S> for instance , @xmath20 is called _ irreducible _ if @xmath29 does not split over a finite subgroup ; we may correspondingly define an _ </S>",
    "<S> irreducible pair _ </S>",
    "<S> @xmath28 ( see definition [ defn : irreducible pair ] ) , and a lemma of shenitzer asserts that if the pairs associated to the vertices are irreducible , then so is @xmath20 ( * ? ? ? </S>",
    "<S> * theorem 18 ) . </S>",
    "<S> corresponding to the notion of a @xmath30-injective map of graphs of spaces @xmath31 , we have an _ essential _ map of pairs @xmath32 , and indeed if a morphism of graphs of spaces is essential on each space pair associated to a vertex then the morphism is itself @xmath30-injective ( see proposition [ prop : essential maps of graphs of groups ] ) .    </S>",
    "<S> we are now ready to state the main technical result .    </S>",
    "<S> [ thm : surfaces in graphs ] if @xmath28 is an irreducible graph pair then there is a compact surface with boundary @xmath33 and an essential map of pairs @xmath34 .    </S>",
    "<S> in fact , we obtain a bit more control than this  </S>",
    "<S> the surface is also _ </S>",
    "<S> admissible _ , meaning that every point of the domain of @xmath19 has the same number of preimages in @xmath35 ; see theorem [ thm : essential surfaces exist ] . </S>",
    "<S> it has been well known for a while that a result like theorem [ thm : surfaces in graphs ] would imply the existence of surface subgroups in graphs of free groups with cyclic edge groups  see , for instance , @xcite or @xcite .    </S>",
    "<S> let us now briefly sketch the proof of theorem [ thm : surfaces in graphs ] . </S>",
    "<S> it can be thought of as a combination of the techniques of @xcite and @xcite .    </S>",
    "<S> first , we study irreducible pairs @xmath36 that map into the irreducible pair @xmath28 . </S>",
    "<S> the irreducibility of the pairs @xmath28 and @xmath36 is characterized using _ </S>",
    "<S> whitehead graphs_. we would like to study essential maps @xmath32 , but it turns out to be difficult to characterize essential maps of irreducible pairs . </S>",
    "<S> instead , we work with _ @xmath37-essential _ maps , meaning that the lift of the map @xmath32 to the universal cover of @xmath0 does nt fold edge spaces together . these can be efficiently characterized using _ @xmath37-immersions _ </S>",
    "<S> ( see definition [ defn : d - immersion ] ) .    </S>",
    "<S> the idea behind the proof of theorem [ thm : surfaces in graphs ] is that , among all irreducible pairs mapping to @xmath28 , the pairs of surface type should be the ones of most negative euler characteristic . to make this precise , </S>",
    "<S> we define a positive polyhedral cone @xmath38 in a finite - dimensional vector space , such that the integer points in @xmath38 correspond to admissible @xmath37-immersions of irreducible pairs @xmath36 . </S>",
    "<S> we also define the _ projective @xmath39-rank function _ </S>",
    "<S> @xmath40 on the projectivization @xmath41 as a quotient of two linear functionals : the ( negation of the ) euler characteristic of @xmath42 , and the degree with which @xmath43 covers @xmath19 . </S>",
    "<S> in particular , @xmath40 achieves its maximum value at some vertex of the polyhedron @xmath41 , which is necessarily a rational line in @xmath38 . since this rational line contains an integer point , an admissible @xmath37-immersion of an irreducible pair exists that maximizes @xmath40 . </S>",
    "<S> we call such a pair @xmath36 _ maximal_.    this approach is similar to the argument of @xcite , in which a polyhedral cone is defined whose integer points correspond to certain maps of surfaces @xmath34 . the hypothesis in @xcite that rational second homology is non - zero </S>",
    "<S> is needed to ensure that this cone is non - zero . </S>",
    "<S> in contrast , the cone @xmath38 is guaranteed to be non - zero since , whenever @xmath28 is irreducible , the identity map @xmath44 leads to an admissible @xmath37-immersion of an irreducible pair .    </S>",
    "<S> the final step of the proof applies the ideas of @xcite to the relative jsj decomposition of a maximal pair @xmath36 . </S>",
    "<S> the conclusion is that any maximal pair has no rigid vertices in its jsj decomposition . </S>",
    "<S> it follows that the jsj decomposition is built from surface pieces , and one quickly concludes that a maximal pair of surface type exists . </S>",
    "<S> thus , we deduce the existence of an admissible , @xmath37-essential surface @xmath34 . to upgrade this to an essential surface </S>",
    "<S> , we appeal to a theorem of calegari ( see theorem [ thm : calegari ] ) , which shows that we can promote a @xmath37-essential map of a surface to an essential one .    </S>",
    "<S> the paper is structured as follows . in section [ sec : pairs ] , we define pairs of groups , spaces and graphs , the natural notions of maps between them , and various properties of those maps . in section [ sec : whitehead graphs ] we adapt the classical theory of whitehead graphs to the setting of a graph pair @xmath28 . </S>",
    "<S> the main result here is a converse to whitehead s lemma ( lemma [ lem : converse to whitehead ] ) , which asserts that an irreducible pair can always be unfolded to a _ locally _ irreducible pair , in which the irreducibility is recognized by the whitehead graphs at the vertices . in section [ sec </S>",
    "<S> : admissible pairs ] , we characterize admissible @xmath37-immersions from locally irreducible graph pairs into @xmath28 as precisely those maps that can be built from a certain finite set @xmath39 of _ pieces_. we define the cone @xmath38 and note that there is a surjective map from admissible @xmath37-immersions of locally irreducible pairs to the integer points of @xmath38 . in section [ sec : rationality ] </S>",
    "<S> , we define the _ projective @xmath39-rank _ </S>",
    "<S> function @xmath40 , and prove that it attains its extremal values at rational points of @xmath41 . </S>",
    "<S> we deduce the existence of a maximal , admissible @xmath37-immersion from a locally irreducible pair . in section [ sec : surfaces ] , we apply the results of @xcite to study admissible @xmath37-immersions with maximal projective @xmath39-rank . </S>",
    "<S> the main result is that there is such a maximal pair of surface type ( theorem [ lem : maximal surface type ] ) , which completes the proof of theorem [ thm : surfaces in graphs ] . in section [ sec : hierarchies ] we deduce theorem [ thm : gofgwceg ] and corollaries [ lettercor : surface or rigid ] and [ lettercor : limit groups ] . </S>",
    "<S> finally , in section [ sec : profinite rigidity ] , we deduce corollaries [ introcor : remeslennikov for limit groups ] and [ introcor : pp ] .      alan reid asked me whether one - ended limit groups have surface subgroups in 2006 . </S>",
    "<S> i have worked on finding surface subgroups with a variety of collaborators , and am grateful to them all : lars louder , sang - hyun kim , cameron gordon , danny calegari , ben barrett . </S>",
    "<S> not all of these projects led to publications , but i learned a lot from each of them . a conversation with frdric haglund and pierre pansu led to the discovery of a serious mistake in an earlier attempted proof . </S>",
    "<S> thanks are also due to daniel groves for comments on an early version of this paper . </S>"
  ]
}