{
  "article_text": [
    "a _ geometric graph _",
    "@xmath1 is a straight - line drawing of a simple , finite ( abstract ) graph @xmath2 , i.e. , we identify the vertices @xmath3 with distinct points in the euclidean plane , and we identify any edge @xmath4 with the straight line segments @xmath5 in the plane .",
    "we assume that the edge @xmath5 does not pass through any vertex of @xmath1 besides @xmath6 and @xmath7 .",
    "we call @xmath2 the abstract graph _ underlying _ @xmath1 .",
    "we say that the edges @xmath8 _ cross _ if the corresponding line segments cross each other , i.e. , if they have a common interior point .",
    "we say that a subgraph of @xmath1 is _ self - intersecting _ if it contains a pair of crossing edges .",
    "geometric graphs without crossing edges are plane drawings of planar graphs : they have at most @xmath9 edges if @xmath10 is the number of vertices .",
    "avital and hanani @xcite , erds , and perles initiated in the mid 1960s the systematic study of similar questions for more complicated _ forbidden configurations _ : let @xmath11 be set of forbidden configurations ( geometric subgraphs ) .",
    "what is the maximal number of edges of an @xmath12 vertex geometric graph not containing any configuration belonging to @xmath11 ?",
    "this problem can be regarded as a geometric version of the fundamental problem of extremal graph theory : what is the maximum number of edges that an abstract graph on @xmath12 vertices can have without containing subgraphs of a certain kind .",
    "many questions of the above type on geometric graphs have been addressed in recent years . in a number of papers",
    "linear upper bounds have been established for the number of edges of a graph , under various forbidden configurations .",
    "they include the configurations of three pairwise crossing edges @xcite , four pairwise crossing edges @xcite , the configurations of an edge crossed by many edges @xcite , or even two large stars with all edges of one of them crossing all edges of the other @xcite .    for a constant number of 5 or more pairwise crossing edges pavel valtr has the best result @xcite : a geometric graph on @xmath12 vertices avoiding this configuration has @xmath13 edges but no construction is known with a super linear number of edges .",
    "adam marcus and the present author @xcite building on an earlier result of pinchasi and radoii @xcite prove an @xmath14 bound on the number of edges of an @xmath12 vertex geometric graph not containing self - intersecting cycles of length four .",
    "no construction is known beating the @xmath15 edges an abstract graph having no cycles of length four can have .    for surveys on geometric graph theory ,",
    "consult @xcite , @xcite and @xcite .",
    "in this paper we consider forbidding self - intersecting paths . for @xmath16",
    "we call a geometric graph _ @xmath0-locally plane _ if it has no self - intersecting subgraph ( whose underlying abstract graph is ) isomorphic to a path of length at most @xmath0 .",
    "pach et al .",
    "@xcite consider @xmath17-locally plane graphs , i.e. , the case of geometric graphs with no self - intersecting paths of length three .",
    "they prove matching lower and upper bounds of @xmath18 on the maximal number of edges of a @xmath17-locally plane graph on @xmath12 vertices .",
    "we extend the the lower bound result of @xcite by considering self - intersecting drawings of longer paths as forbidden configurations .",
    "technically @xmath0-locally plane graphs are defined by forbidding self intersecting paths of length @xmath0 _ or shorter _ , but forbidding only self - intersecting paths of length _ exactly @xmath0 _ would lead to almost the same extremal function .",
    "indeed , one can delete at most @xmath19 edges from any graph on @xmath12 vertices , such that all the non - zero degrees in the remaining graph are larger than @xmath0 .",
    "this ensures that all shorter paths can be extended to a path of length @xmath0 .",
    "it is possible , but not likely , that if one only forbids paths of length @xmath0 with _ the first and last edges crossing _ significantly higher number of edges is achievable .    for even @xmath0",
    "a geometric graph is @xmath0-locally plane if and only if the @xmath20-neighborhood of any vertex @xmath6 is intersection free . note that this requirement is much stronger than the similar condition on abstract graphs , namely that the @xmath20 neighborhood of any point is planar .",
    "one can construct graphs with girth larger than @xmath0 and @xmath21 edges .",
    "in such a graph the @xmath20-neighborhood of any vertex is a tree , still by @xcite the graph does not even have @xmath17-locally plane drawing .    extending the lower bound result in @xcite we prove in theorem  [ 15 ] that for arbitrary fixed @xmath16 there exist @xmath0-locally plane graphs on @xmath12 vertices with @xmath22 edges . here",
    "@xmath23 denotes @xmath24 times iterated logarithm and the hidden constant in @xmath25 depends on @xmath0 .",
    "given two arbitrarily small disks in the plane we can even ensure that all edges of the constructed graph connect a vertex from the first disk with another vertex from the second .",
    "this ensures that all the edges of the constructed geometric graph are arbitrarily close to each other in length and direction .",
    "in the view of the author this makes the existence of a high average degree ( or for that matter high minimum degree ) 100-locally plane graphs even more surprising .    as a simple corollary we can characterize the abstract graphs @xmath11 such that any geometric graph having no self - intersecting subgraph isomorphic to @xmath11 has a linear number of edges .",
    "these graphs @xmath11 are the forests with at least two nontrivial components . to see the linear bound for the number of edges of a geometric graph avoiding a self - intersecting copy of such a forest @xmath11 first delete a linear number of edges from an arbitrary geometric graph @xmath1 until all non - zero degrees of the remaining geometric graph @xmath26 are at least @xmath27 . if @xmath26 is crossing free the linear bound of the number of edges follows .",
    "if you find a pair of crossing edges in @xmath26 they can be extended to a subgraph of @xmath26 isomorphic to @xmath11 . on the other hand , if @xmath11 contains a cycle , then even an abstract graph avoiding it can have a super - linear number of edges .",
    "if @xmath11 is a tree of diameter @xmath0 , then a @xmath0-locally plane geometric graph has no self - intersecting copy of @xmath11 .",
    "notice that the extremal number of edges in this case ( assuming @xmath28 ) is @xmath13 by @xcite , thus much smaller than the @xmath29 edges ( @xmath30 ) for forbidden cycles .",
    "the main tool used in the proof of the above result is a randomized thinning procedure that takes a @xmath31 edge colored bipartite graph of average degree @xmath32 and returns a subgraph on the same vertex set with average degree @xmath33 that does not have a special type of colored path ( walk ) of length four .",
    "the procedure can be applied recursively to obtain a subgraph avoiding longer paths of certain types .",
    "we believe this thinning procedure to be of independent interest .",
    "in particular it can be used to obtain optimal 0 - 1 matrix constructions for certain avoided submatrix problems , see the exact statement in section [ s4 ] and the details in @xcite .    in section [ s2 ]",
    "we define two thinning procedures for edge colored bipartite graphs and prove their main properties .",
    "this is the most technical part of the paper . while these procedures proved useful in other setting too ( and the author finds the involved combinatorics appealing ) this entire section can be skipped if one reads the definition of @xmath0-flat graphs ( the two paragraphs before lemma  [ 10 ] ) and is willing to accept corollary  [ corol ] at the end of the section ( we also use the simple observation in lemma  [ 11 ] ) . in fact , in order to understand the main ideas behind the main result of this paper it is recommended to skip section  [ s2 ] on the first reading and to go straight to section  [ s3 ] where we use corollary  [ corol ] to construct locally plane graphs with many edges . in section [ s4 ] we comment on the optimality of the thinning procedures and have some concluding remarks .",
    "in this section we state and prove combinatorial statements about edge colored abstract graphs , i.e. , we do not consider here geometric graphs at all . the connection to locally plane geometric graphs",
    "will be made clear in section  [ s3 ] .",
    "a _ bipartite graph _ is a triple @xmath34 with disjoint vertex sets @xmath35 and @xmath36 ( called _ sides _ ) and edge set @xmath37 .",
    "in particular , all graphs considered in this paper are _ simple _ , i.e. , they do not have multiple edges or loops .",
    "the edge connecting the vertices @xmath6 and @xmath7 of @xmath1 is denoted by @xmath5 or @xmath38 .",
    "the latter notation is only used if @xmath39 and @xmath40 . by a _",
    "@xmath31-edge coloring _ of a graph we mean a mapping @xmath41 such that adjacent edges receive different colors .",
    "when we do not specify @xmath31 we call such coloring a _ proper edge coloring _ but we always assume that the `` set of colors '' are linearly ordered .",
    "the degree of any vertex in @xmath1 is at most the number @xmath31 of colors , and our results are interesting if the average degree is close to @xmath31 . unless stated otherwise the subgraphs of an edge colored graph are considered with the inherited edge coloring .",
    "our goal is to obtain a subgraph of @xmath1 with as many edges as possible without containing a certain type of colored path or walk .",
    "a simple example of the above concept is the following .",
    "we call a path @xmath42 of length @xmath17 _ heavy _ if @xmath43 and the colors @xmath44 , @xmath45 , @xmath46 , satisfy @xmath47",
    ". the next lemma describes a thinning procedure that gets rid of heavy paths .",
    "although we do not need this lemma in our construction , we present it as a simple analogue of our results for more complicated forbidden walks .    [ 0 ] let @xmath34 be a bipartite graph with a proper edge coloring @xmath41 .",
    "then there exists a subgraph @xmath48 of @xmath1 with @xmath49 that does not contain heavy paths .",
    "the constant @xmath17 in the lemma could be replaced by the base of the natural logarithm .",
    "notice that if @xmath1 had average degree @xmath32 , then the average degree of @xmath26 is @xmath50 .",
    "let @xmath51 and select a uniform random value @xmath52 independently for each vertex @xmath40 .",
    "we say that an edge @xmath53 is of _ class _ @xmath54 .",
    "we call an edge @xmath55 _ eligible _ if its class is @xmath56",
    ". let the subgraph @xmath48 consist of those eligible edges @xmath55 for which there exists no other eligible edge @xmath57 of the same class .",
    "note that the words `` class '' and `` eligible '' will be used in a different meaning when defining the two thinning procedures in the next subsection .    by the construction ,",
    "all edges incident to a vertex @xmath39 have different classes and all edges incident to a vertex @xmath40 have the same class .",
    "let @xmath58 , @xmath59 and @xmath60 form a path in @xmath26 starting in @xmath36",
    ". then @xmath59 and @xmath60 are of the same class , while the class of @xmath58 is different . for the colors",
    "@xmath61 this rules out the order @xmath62 .",
    "thus , @xmath26 does not contain a heavy path .",
    "note that another order , @xmath63 is also impossible .",
    "the number of edges in @xmath26 depends on the random choices we made .",
    "any edge @xmath64 is eligible with probability @xmath65 , and this is independent for all the edges incident to a vertex @xmath39 . as edges of a fixed color form a matching , there are at most @xmath24 edges of any given class incident to @xmath6 .",
    "thus , we have @xmath66\\ge\\frac{(1 - 1/t)^{t-1}}t>\\frac1{3t}.\\ ] ] the expected number of edges in @xmath26 is @xmath67\\ge\\frac{|e|}{3t}.\\ ] ] it is possible to choose the random variables @xmath56 so that the size of @xmath68 is at least as large as its expected value .",
    "this proves the lemma .",
    "next we turn to more complicated forbidden subgraphs . for motivation",
    "we mention that self - crossing paths of length @xmath69 in the 3-locally plane graphs of @xcite ( considered with their natural edge coloring ) are exactly the _ fast walks _",
    "( to be defined below ) . for technical reasons , it will be more convenient to consider walks , i.e. , to permit that a vertex is visited more than once , but we will not allow _ backtracking _ , i.e. , turning back on the same edge immediately after it was traversed .",
    "thus , for us a _ walk _ of length @xmath0 is a sequence @xmath70 of vertices in the graph such that @xmath71 is an edge for @xmath72 and @xmath73 for @xmath74 .",
    "the _ @xmath75-coloring _ ( or simply coloring ) of this walk is the sequence @xmath76 of the colors of the edges of the walk . if @xmath75 is a proper edge coloring , then any two consecutive elements of the coloring sequence are different",
    ".    we use @xmath77 to denote the binary logarithm .",
    "we introduce the notation @xmath78 for two non - equal strings @xmath79 to denote the first position @xmath80 , where @xmath81 and @xmath82 differ .",
    "we consider the set @xmath83 to be ordered lexicographically , i.e. , for @xmath79 we have @xmath84 if @xmath81 has @xmath85 in position @xmath78 ( and thus @xmath82 has @xmath86 there ) .",
    "the following trivial observation is used often in this paper .",
    "we state it here without a proof .",
    "[ 1 ] let @xmath87 and let @xmath81 , @xmath82 and @xmath88 be distinct binary strings of length @xmath24 with @xmath89 .",
    "we have @xmath90 .",
    "furthermore @xmath91 implies @xmath92 , and @xmath84 implies @xmath93 .",
    "a walk of length @xmath69 with coloring @xmath94 is called a _ fast walk _ if @xmath95 .",
    "note that a fast walk may start in either class @xmath35 or @xmath36 .",
    "we call a walk of length @xmath69 a _ slow walk _ if it starts in the class @xmath36 and its coloring @xmath94 satisfies @xmath96 and @xmath97 . note that either the color @xmath98 or @xmath99 can be larger in a slow walk , or they can be equal .",
    "the two _ thinning procedures _ below find a random subgraph of an edge - colored bipartite graph .",
    "one is designed to avoid slow walks , the other is designed to avoid fast walks .    * lexicographic thinning * let @xmath34 be a bipartite graph and let @xmath100 be a proper edge coloring with @xmath101 . _",
    "lexicographic thinning _",
    "is a randomized procedure that produces a subset @xmath102 of the edges and the corresponding subgraph @xmath48 of @xmath1 as follows :    let @xmath103 .",
    "let @xmath11 be the set of triplets @xmath104 , where @xmath105 , @xmath106 , @xmath107 , and @xmath81 has @xmath85 in position @xmath108 .",
    "straightforward calculation gives that @xmath109 .",
    "we order @xmath11 lexicographically , i.e. , @xmath110 if @xmath84 , or @xmath111 and @xmath112 , or @xmath113 and @xmath114 .",
    "consider the following random function @xmath115 .",
    "we select uniformly at random the value @xmath116 with the property that the first bit of @xmath81 is @xmath85 .",
    "we make @xmath117 to be the next element of @xmath11 larger than @xmath118 , and in general @xmath119 is the next element of @xmath11 larger than @xmath120 for @xmath121 .",
    "as @xmath122 and @xmath118 is chosen from the first half of @xmath11 , this defines @xmath123 . in what follows",
    "we simply identify the color @xmath0 with the element @xmath124 without any reference to the function @xmath123 .",
    "we say that @xmath125 and any edge with this color is of _ class _ @xmath81 and _ type _",
    "@xmath108 , while @xmath126 will play no role except in counting how many values it can take .",
    "we choose an independent uniform random value @xmath127 for each vertex @xmath128 .",
    "let @xmath55 be an edge of class @xmath81 and type @xmath108 .",
    "we say that @xmath129 is _ eligible _ if @xmath130 and @xmath131 .",
    "let the subgraph @xmath48 contain those edges @xmath53 that are eligible but not adjacent to another eligible edge @xmath132 of the same type as @xmath129 .",
    "* reversed thinning * let @xmath34 be a bipartite graph and let @xmath100 be a proper edge coloring with @xmath101 .",
    "_ reversed thinning _ is a randomized procedure that produces a subset @xmath102 of the edges and the corresponding subgraph @xmath48 of @xmath1 .",
    "reversed thinning is almost identical to the lexicographic thinning , the only difference is in the ordering of the set @xmath11 .",
    "we define @xmath24 and @xmath11 as in the case of lexicographic thinning . recall that @xmath11 is the set of triplets @xmath104 where @xmath105 , @xmath106 , @xmath133 , and @xmath81 has @xmath85 in position @xmath108 .",
    "we still order @xmath83 lexicographically , but now we reverse the lexicographic order of @xmath11 in the middle term @xmath108 . that is , we have @xmath110 if @xmath84 , or @xmath111 and @xmath134 or @xmath113 and @xmath114 .",
    "we define the function @xmath115 , the _ types _ and _ classes _ of colors and edges , _ eligible _ edges and the subset @xmath68 of edges the same way as for the lexicographic thinning , but using this modified ordering of @xmath11 .",
    "note that we associated a type in @xmath135 and a class in @xmath83 to each edge in either procedure and they satisfy that    * an edge with a smaller class has smaller color ; * among edges of equal class an edge with smaller type has smaller color in the case of lexicographic thinning and it has larger color in the case of reversed thinning ; * among the edges incident to a vertex at most @xmath136 have the same class @xmath81 and the same type @xmath108 .    proving most of the properties of the thinning procedures this is all we need to know about how classes and types are associated to the edges and we could use a deterministic scheme for @xmath123 .",
    "but for lemma  [ 5 ] we need that all types are well represented and the randomization in the identification function @xmath123 ( as well as the dummy first bit of the class ) is introduced to ensure this on the average .",
    "this randomization is not needed if one assumes all color classes have roughly the same size .",
    "the next lemmas state the basic properties of the thinning procedure .",
    "lemma [ 2 ] lists common properties of the two procedures , while lemmas  [ 3 ] and [ 4 ] state the result of the thinning satisfies its `` design criteria '' avoiding slow or fast walks .",
    "finally lemma  [ 5 ] shows that enough edges remain in the constructed subgraphs on average .",
    "note that lemmas  [ 3 ] and [ 4 ] are special cases of the more complex lemmas  [ 7 ] and [ 8 ] proved independently .",
    "we state and prove the simple cases separately for clarity , but these proofs could be skipped .",
    "[ 2 ] let @xmath34 be a bipartite graph with a proper edge coloring @xmath100 . if @xmath48 is the result of either the lexicographic or the reversed thinning then we have    a ) : :    adjacent edges in @xmath26 have distinct types .",
    "b ) : :    if two edges of @xmath26 meet in @xmath36 , they have    the same class .",
    "c ) : :    suppose two distinct edges @xmath129 and @xmath132 of    @xmath26 meet in @xmath35 .",
    "let their classes and types    be @xmath81 , @xmath137 and @xmath108 ,    @xmath138 , respectively . if @xmath139 then    @xmath140 and @xmath141 .",
    "d ) : :    @xmath26 has no heavy path .",
    "the definition of @xmath68 immediately gives a ) .",
    "for b ) note that all eligible edges incident to @xmath40 have @xmath142 for class .    for c ) let @xmath39 be the common vertex of the two edges and apply lemma [ 1 ] for @xmath143 , @xmath81 , and @xmath137 .",
    "finally d ) follows since if a walk of @xmath26 starts in @xmath36 then its coloring @xmath144 must satisfy that @xmath98 and @xmath145 have different class by c ) but @xmath145 and @xmath99 have the same class by b ) , so @xmath47 is impossible .",
    "[ 3 ] let @xmath34 be a bipartite graph with a proper edge coloring .",
    "lexicographic thinning produces a subgraph @xmath26 with no slow walk .",
    "suppose @xmath146 is a walk in @xmath26 starting at @xmath43 and let its coloring be @xmath94 .",
    "assume @xmath147 .",
    "we show that @xmath148 , so this walk is not slow . by lemma [ 2]/a ,",
    "b , as @xmath145 and @xmath99 are colors of edges incident to @xmath149 , they have the same class , but they have different types : @xmath150 , @xmath151 with @xmath152 .",
    "we use lexicographic ordering , so @xmath153 implies @xmath112 .",
    "both @xmath98 and @xmath145 are colors of edges incident to @xmath154 , so by lemma [ 2]/c their classes are different .",
    "since @xmath155 we have @xmath156 for the class @xmath82 of @xmath98 . still by lemma [ 2]/c @xmath157 .",
    "similarly , @xmath99 and @xmath158 are colors of distinct edges in @xmath68 incident to @xmath159 , so they have different classes . as @xmath160 we have @xmath161 for the class @xmath88 of @xmath158 .",
    "we have @xmath162 . by lemma",
    "[ 1 ] we have @xmath163 .",
    "this proves @xmath148 as claimed .",
    "[ 4 ] let @xmath34 be a bipartite graph with a proper edge coloring . reversed thinning produces a subgraph @xmath26 with no fast walk .",
    "suppose @xmath146 is a walk in @xmath26 with coloring @xmath94 .",
    "assume @xmath147 .",
    "we show that @xmath164 , so this walk is not fast .",
    "first assume the walk starts at @xmath165 .",
    "as @xmath26 does not contain a heavy path , @xmath166 is not heavy , so @xmath167 .",
    "this implies @xmath164 as claimed .",
    "now assume @xmath168 .",
    "just as in the proof of the previous lemma , @xmath145 and @xmath99 are colors of edges incident to @xmath149 , so they have the same class , but they have different types : @xmath150 , @xmath151 with @xmath169 .",
    "we use the reversed ordering , so @xmath153 implies @xmath134 .",
    "both @xmath98 and @xmath145 are colors of edges incident to @xmath154 , so their classes are different .",
    "since @xmath155 we have @xmath156 for the class @xmath82 of @xmath98 and @xmath157 . similarly , @xmath99 and @xmath158 are colors of distinct edges in @xmath68 incident to @xmath159 , so they have different classes . as @xmath160",
    "we have @xmath161 for the class @xmath88 of @xmath158 and @xmath162 . by lemma",
    "[ 1 ] we have @xmath92 .",
    "this proves @xmath164 as claimed .",
    "below we estimate the number of edges in @xmath68 . recall that both thinning procedures are randomized .",
    "we can show that the subgraphs they produce have a large expected number of edges .",
    "we did not make any effort to optimize for the constant in this lemma .    [ 5 ] let @xmath34 be a bipartite graph with a @xmath31 edge coloring .",
    "let @xmath48 be the result of either the lexicographic or the reversed thinning .",
    "we have @xmath67\\ge{t-1\\over240d}|e|\\ge{\\log d\\over480d}|e|.\\ ] ]    we compute the probability for a fixed edge @xmath55 to end up in @xmath68 . for this",
    "we break down the random process producing @xmath68 into three phases . in the first phase we select @xmath123 .",
    "with @xmath123 the color @xmath170 is identified with an element of @xmath11 , most importantly , the type of @xmath129 is fixed . in the second phase we select @xmath143 and @xmath142 uniformly at random .",
    "these choices determine if @xmath129 is eligible .",
    "if @xmath129 is not eligible then @xmath171 . so in the third phase we consider @xmath123 , @xmath143 , and @xmath142 fixed and assume @xmath129 is eligible .",
    "we select the random values @xmath172 for vertices @xmath173 .",
    "this effects if other edges are eligible and if @xmath174 . here is the detailed calculation :    let @xmath53 have the color @xmath175 .",
    "the choice of @xmath123 in the first phase determines @xmath176 . by the construction of @xmath123 ,",
    "if we call @xmath137 the last @xmath177 bits of @xmath81 then @xmath178 is uniformly distributed among all its possible values . in particular , the probability that @xmath129 becomes a type @xmath108 edge is exactly @xmath179=\\frac{2^{t+i-2}}{2^{2t-1}-2^t } = \\frac{2^i}{2^{t+1}-4}.\\ ] ]    for phase two we consider the function @xmath123 identifying colors with elements of @xmath11 fixed .",
    "consider an edge @xmath180 of color @xmath125 .",
    "this edge is eligible if @xmath181 and @xmath131 .",
    "this determines @xmath142 and the first @xmath108 bits of @xmath143 .",
    "recall that by the definition of @xmath11 the string @xmath81 has @xmath85 in position @xmath108 .",
    "thus , the probability that the edge @xmath129 of type @xmath108 is eligible is exactly @xmath182 .",
    "assume for the third phase that @xmath129 is eligible .",
    "consider another edge @xmath183 with color @xmath184 of type @xmath108 .",
    "if @xmath81 and @xmath137 do not agree in the first @xmath108 positions , then @xmath132 is not eligible .",
    "if they agree in the first @xmath108 positions , then @xmath132 is eligible if and only if @xmath185 , so with probability @xmath186 .",
    "let @xmath187 be the number of edges @xmath188 of type @xmath108 with the first @xmath108 digits of their class agreeing with @xmath81 , but not counting @xmath129 itself .",
    "we have @xmath189 .",
    "consider now an edge @xmath190 with color @xmath191 such that @xmath192 .",
    "as @xmath129 is eligible , @xmath193 can only be eligible if @xmath194 . if @xmath194 then @xmath193 is eligible if and only if @xmath143 and @xmath195 agree in the first @xmath108 digits .",
    "this happens with probability @xmath196 .",
    "for the number @xmath197 of the edges @xmath198 of type @xmath108 and class @xmath81 we have @xmath199 .    in phase three",
    "the eligibility of all these edges @xmath132 and @xmath193 adjacent with @xmath129 are independent events .    still consider the function @xmath123 fixed . the total probability for an edge @xmath129 of type @xmath108 to be in @xmath68 is @xmath200 & = & 2^{-t - i}(1 - 2^{-t})^{k'_e}(1 - 2^{-i})^{k''_e}\\\\ & \\ge&2^{-t - i}(1 - 2^{-t})^{2^t-1}(1 - 2^{-i})^{2^i-1}\\\\ & > & 2^{-t - i}/7.5.\\end{array}\\ ] ]    the total probability of @xmath174 can be calculated from the distribution of its type and the above conditional probability depending on its type : @xmath201>\\sum_{i=2}^t\\frac{2^i}{2^{t+1}-4}\\cdot\\frac{2^{-t - i}}{7.5 } > \\frac{t-1}{15\\cdot2^{2t}}>\\frac{t-1}{240d}.\\ ] ] the expected number of edges in @xmath68 is then @xmath67>\\frac{t-1}{240d}|e|\\ge\\frac{\\log d}{480d}|e|.\\ ] ]    [ 6 ] let @xmath34 be a bipartite graph with a proper edge coloring .",
    "there exists a subgraph @xmath48 of @xmath1 without a slow walk and with @xmath202 .",
    "similarly , there exists a subgraph @xmath203 of @xmath1 without a fast walk and with @xmath204 .    by lemmas [ 3 ] and [ 4 ] the results of the lexicographic and reversed thinnings",
    "avoid the slow and fast walks , respectively .",
    "there exists an instance of the random choices with the size of @xmath68 being at least its expectation given in lemma [ 5 ] .",
    "this proves the theorem .",
    "here we generalize the concept of fast and slow walks to longer walks .",
    "consider a bipartite graph @xmath34 with a proper edge coloring .",
    "for @xmath205 we call a walk of length @xmath206 in @xmath1 a _",
    "@xmath0-fast walk _ if its coloring @xmath207 satisfies @xmath208 and @xmath209 . for @xmath205 we call a walk of length @xmath206 in @xmath1 a _ @xmath0-slow walk _ if its coloring @xmath207 satisfies the following : @xmath210 for @xmath211 ; @xmath212 for @xmath213 ; @xmath214 for @xmath215 ; @xmath216 for @xmath217 ; and finally @xmath218 .",
    "if a @xmath0-slow walk starts in the vertex set @xmath36 we call it a @xmath219-slow walk , otherwise it is a @xmath220-slow walk .",
    "notice that @xmath221-fast walks are the fast walks and @xmath222-slow walks are the slow walks with their orientation reversed . for the coloring @xmath207 of a @xmath0-fast walk",
    "@xmath223 is in between @xmath224 and @xmath225 for all @xmath226 , @xmath227 , while @xmath228 is the smallest color on this list .",
    "for the coloring @xmath207 of a @xmath0-slow walk the situation is reversed : the only index @xmath226 with @xmath223 being in between @xmath224 and @xmath225 is the index @xmath229 .    in order to apply the lexicographic and reversed thinning recursively we have to change the coloring of the subgraph .",
    "let @xmath34 be a bipartite graph with a proper edge coloring given by @xmath100 .",
    "let @xmath48 the result of the lexicographic or the reversed thinning of @xmath1 .",
    "recall that the edges in @xmath68 have a type @xmath230 with @xmath231 .",
    "the _ type edge coloring _ of @xmath26 is the map @xmath232 defined by @xmath233 for an edge @xmath234 of type @xmath108 . by lemma",
    "[ 2]/a @xmath235 is a proper edge coloring of @xmath26 .",
    "[ 7 ] let @xmath34 be a bipartite graph with proper edge coloring given by @xmath100 .",
    "let @xmath48 the result of the lexicographic thinning of @xmath1 .",
    "let @xmath235 be the type edge coloring of @xmath26 and let @xmath205 . if a subgraph @xmath203 of @xmath26 with its edge coloring given by @xmath235 has no @xmath236-slow walk for @xmath237 then @xmath238 with its edge coloring given by @xmath75 has no @xmath219-slow walk .",
    "notice that the @xmath239 case of this lemma gives a second proof of lemma  [ 3 ] .",
    "let @xmath240 be a walk in @xmath238 starting at @xmath43 and let its @xmath75-coloring be @xmath241 .",
    "assume that @xmath242 or @xmath243 for @xmath244 as required in the definition of a @xmath219-slow walk .",
    "we need to show @xmath245 .",
    "we identify the colors of @xmath75 with the triplets @xmath125 as in the definition of lexicographic thinning .",
    "we let @xmath246 .",
    "the @xmath235-coloring of @xmath247 is @xmath248 .",
    "we have @xmath249 for @xmath250 .",
    "for @xmath251 the colors @xmath252 and @xmath253 are colors of distinct edges incident to @xmath254 ,",
    "so by lemma [ 2]/b their class is the same : @xmath255 .",
    "we consider lexicographic thinning , so the order between @xmath252 and @xmath253 is the same as the order between their types : @xmath256 and @xmath257 .",
    "for @xmath213 we have @xmath258 but for @xmath217 we have @xmath259 .",
    "for @xmath260 the colors @xmath261 and @xmath252 are colors of edges incident to @xmath262 . by lemma",
    "[ 2]/c the classes of these colors do not agree , and the ordering between the classes , between the types , and between the colors themselves are the same .",
    "thus , for @xmath211 we have @xmath263 and @xmath264 .",
    "for @xmath215 we have @xmath265 and @xmath266 . also by lemma [ 2]/c for all @xmath260 we have @xmath267 .",
    "the sequence @xmath268 is monotone decreasing and it changes only in every other step .",
    "the first positions of change between distinct consecutive elements are @xmath269 .",
    "so we have @xmath270 and @xmath271 for the set @xmath272 .",
    "similarly , @xmath273 is monotone increasing and it changes only in every other step .",
    "the first positions of change between distinct consecutive elements are @xmath274 .",
    "so we have @xmath275 and @xmath276 for the set @xmath277 .",
    "let us consider an arbitrary value @xmath213 and let @xmath278 .",
    "consider the @xmath279 long middle portion @xmath280 of the walk @xmath247 : let @xmath281 .",
    "this is a walk of length @xmath279 in @xmath238 starting at @xmath282 . by our assumption on @xmath238",
    "this is not a @xmath236-slow walk if considered with the coloring @xmath235 .",
    "but the @xmath235-coloring of @xmath280 is @xmath283 and the consecutive values in this list compare as required for a @xmath236-slow walk .",
    "therefore , we must have @xmath284 .",
    "we have just proved @xmath285 for @xmath213 . for even @xmath0 and @xmath286",
    "the same formula compares the types of two consecutive edges of @xmath247 and we have already seen its validity in that case too . for every element of the set",
    "@xmath287 we have just found a smaller element of the set @xmath288 .",
    "therefore , @xmath289 . using that @xmath290 and @xmath291 lemma [ 1 ]",
    "gives @xmath292 .",
    "this implies @xmath245 and finishes the proof of the lemma .",
    "[ 8 ] let @xmath34 be a bipartite graph with proper edge coloring given by @xmath100 .",
    "let @xmath48 the result of the reversed thinning of @xmath1 .",
    "let @xmath235 be the type edge coloring of @xmath26 and let @xmath205 . if a subgraph @xmath203 of @xmath26 with its edge coloring given by @xmath235 has no @xmath236-slow walk for @xmath237 then @xmath238 with its edge coloring given by @xmath75 has no @xmath0-fast walk .",
    "notice that the @xmath239 case of this lemma gives a second proof of lemma  [ 4 ] .",
    "the proof of this lemma is very similar to that of lemma [ 7 ] .",
    "let @xmath240 be a walk in @xmath238 and let its @xmath75-coloring be @xmath241 .",
    "assume that @xmath208 as required in the definition of a @xmath0-fast walk .",
    "we need to show @xmath245 . instead , we prove the slightly stronger statement that the class of @xmath98 is smaller than the class of @xmath293 .",
    "we first do that for walks starting in @xmath36 : assume that @xmath43 .",
    "we identify the colors of @xmath75 with the triplets @xmath125 as in the definition of reverse thinning .",
    "we let @xmath246 .",
    "note that the @xmath235-coloring of @xmath247 is @xmath248 .",
    "we have @xmath249 for @xmath250 .",
    "for @xmath251 the colors @xmath252 and @xmath253 are colors of distinct edges incident to @xmath254 , so by lemma [ 2]/b their classes are the same : @xmath255 .",
    "thus the order between @xmath252 and @xmath253 is determined by the order between @xmath256 and @xmath257 , but as we use the reversed ordering in @xmath11 the order between @xmath252 and @xmath253 is reversed compared to the order between @xmath256 and @xmath257 .",
    "specifically , for @xmath213 we have @xmath258 and for @xmath217 we have @xmath259 . for @xmath260",
    "the colors @xmath261 and @xmath252 are colors of edges incident to @xmath282 . by lemma [ 2]/c",
    "the classes of these colors do not agree , and the ordering between the classes , between the types , and between the colors themselves are the same .",
    "thus , for @xmath211 we have @xmath263 and @xmath264 . for @xmath215 we have @xmath265 and @xmath266 . also by lemma [ 2]/c for @xmath260 we have @xmath267 .    at this point",
    "we have the same ordering of the classes and types of the coloring of @xmath247 as in the proof of lemma [ 7 ] .",
    "we also have the same assumption that @xmath238 with the edge coloring @xmath235 has no @xmath236-slow walk for @xmath237 .",
    "so we arrive to the same conclusion @xmath292 with an identical proof .",
    "we finish the proof of the lemma by considering the alternative case when @xmath247 starts in @xmath35 .",
    "now @xmath98 and @xmath145 are colors of edges sharing a vertex @xmath294 , so by lemma [ 2]/b their classes are equal . similarly , the classes of @xmath295 and @xmath293 are equal , so it is enough to prove that the class of @xmath145 is smaller than the class of @xmath295 . for @xmath239",
    "this follows directly from lemma [ 2]/c . for @xmath28 the walk",
    "@xmath296 is exactly the type of walk we considered for @xmath297 . as it starts in @xmath36",
    "we have already proved that the class of its first edge is smaller than the class of its last edge .",
    "this finishes the proof of the case of a walk starting in @xmath35 and also the proof of lemma [ 8 ] .",
    "lemmas [ 7 ] and [ 8 ] set the stage to use the thinning procedures recursively to get subgraphs avoiding @xmath219-slow or @xmath0-fast walks . in a single application of either thinning procedure",
    "the number @xmath31 of colors in the original coloring is replaced by @xmath298 colors in the type coloring . here",
    "@xmath299 , so after @xmath0 recursive calls we still have more than @xmath300 colors , where @xmath301 stands for the @xmath0 times iterated log functions .",
    "( of course , this only makes sense if @xmath302 .",
    "otherwise we can get stuck , as neither thinning procedure is defined in the pathetic case of @xmath303 colors . ) making optimal random choices we may assume that each thinning procedure yields at least the expected number of edges .",
    "thus , the ratio of the number of edges and the number of colors decreases by at most a factor of @xmath304 in each iteration .",
    "clearly , the only interesting case is when the original average degree was @xmath32 in which case the average degree after @xmath0 iterations remains @xmath305 .",
    "the constant of proportionality depends on @xmath0 .",
    "[ 9 ] let @xmath34 be a bipartite graph with a @xmath31 edge coloring and let @xmath205 .",
    "there exists a subgraph @xmath48 of @xmath1 without a @xmath306-slow walk for any @xmath307 and with @xmath308 .",
    "similarly , there exists a subgraph @xmath203 of @xmath1 without a @xmath309-fast walk for any @xmath307 and with @xmath310 .",
    "we apply the thinning procedures recursively .",
    "first we use lexicographic and reversed thinning to obtain subgraphs @xmath311 and @xmath312 of @xmath1 , respectively .",
    "we make sure these graphs have at least as many edges as the expected number given in lemma [ 5 ] .",
    "if @xmath239 we are done , @xmath313 and @xmath314 satisfy the conditions of the theorem .",
    "otherwise we consider @xmath311 and @xmath312 with the type edge coloring .",
    "we find recursively their subgraphs @xmath26 and @xmath238 , respectively , avoiding @xmath236-slow walks for @xmath315 .",
    "this can be done because the sides @xmath35 and @xmath36 play symmetric roles .",
    "finally , we apply lemmas [ 7 ] and lemma [ 8 ] to see that the subgraphs @xmath26 and @xmath238 , if considered with the original edge coloring of @xmath1 , avoid all walks required in the theorem . the number of edges guaranteed in the subgraphs is calculated in the paragraph preceding the theorem and is at least the stated bound .      in this subsection",
    "we establish that removing a linear number of edges from a @xmath0-fast walk free graph the resulting graph has special structural properties .",
    "we note here that the recursive thinning construction that we used to arrive at @xmath0-fast walk free graphs results in a graph that itself is @xmath0-flat as defined below .",
    "we chose however to keep the inductive part of the proof simple and concentrated only on @xmath219-slow and @xmath0-fast walks .",
    "we derive the more complicated properties from these simpler ones .",
    "note that in this subsection we do not use that our graphs are bipartite .",
    "let @xmath1 be a graph and @xmath75 a proper edge coloring of @xmath1 .",
    "we define the _ shaving _ of the graph @xmath1 to be the subgraph obtained from @xmath1 by deleting the edge with the largesr color incident to every ( non - isolated ) vertex .",
    "clearly , we delete at most @xmath12 edges , where @xmath12 is the number of vertices in @xmath1 .",
    "we define the _ @xmath0-shaving _ of @xmath1 to be the subgraph obtained from @xmath1 by repeating the shaving operation @xmath0 times .",
    "clearly , we delete at most @xmath316 edges for a @xmath0-shaving .",
    "let @xmath247 be a walk of length @xmath317 in a properly edge colored graph @xmath1 , and assume its coloring is @xmath318 .",
    "we define the _ height function _",
    "@xmath319 from @xmath320 to the integers recursively letting @xmath321 and @xmath322 for @xmath323 .",
    "note @xmath324 is always odd .",
    "this function considers how the colors of the edges in the walk change , in particular , how many times the next color is larger and how many times it is smaller than the previous color .",
    "we call a graph @xmath1 with proper edge coloring _ @xmath0-flat _ if the following is true for every walk @xmath247 in @xmath1 .",
    "let @xmath325 be the length of @xmath247 , let @xmath318 be the coloring of @xmath247 and assume that the height function satisfies @xmath326 for @xmath327 . if @xmath328 or @xmath329 for all @xmath108 then @xmath330 .",
    "[ 10 ] let @xmath1 be properly edge colored graph .",
    "let @xmath331 and assume @xmath1 has no @xmath309-fast walk for @xmath307 .",
    "then the @xmath332-shaving @xmath26 of @xmath1 is @xmath0-flat .",
    "we prove the following slightly stronger statement by induction on @xmath317 .",
    "let @xmath333 be a walk of length @xmath317 in @xmath1 with coloring @xmath318 .",
    "let @xmath334 be the largest index such that @xmath335 .",
    "assume the walk @xmath336 is in the @xmath332-shaving @xmath26 of @xmath1 .",
    "also assume that @xmath326 for @xmath337 .",
    "if @xmath328 or @xmath329 for all @xmath108 then we claim @xmath330 .",
    "this statement is stronger than lemma [ 10 ] since it allows for the initial decreasing segment of @xmath247 be outside @xmath26 .",
    "if @xmath338 the statement of the claim is obvious from the definition of the height function .",
    "this covers the @xmath339 and @xmath340 base cases .",
    "let @xmath341 and assume the statement is true for walks of length @xmath342 and @xmath343 .",
    "if @xmath344 we have @xmath345 so we must have @xmath346 .",
    "consider the walk @xmath347 of length @xmath342 .",
    "we have @xmath348 for @xmath349 and @xmath350 for @xmath351 .",
    "thus the inductive hypothesis is applicable and we get @xmath352 .    finally consider the @xmath353 case .",
    "as the trivial @xmath338 case was already dealt with we also assume @xmath354 . clearly , @xmath355 implies @xmath356 .",
    "we chose a @xmath357 walk in @xmath1 ending at @xmath358 and with coloring @xmath359 satisfying @xmath360 .",
    "this is possible since the edge @xmath361 is in the @xmath332-shaving @xmath26 of @xmath1 , so we can find the edge @xmath362 in the @xmath363-shaving of @xmath1 , @xmath364 in the @xmath365-shaving , and so on .",
    "we must have @xmath366 as otherwise @xmath367 is a @xmath368-fast walk and no such walk exists in @xmath1 .",
    "now consider the walk @xmath369 .",
    "this is a walk of length @xmath343 and satisfies @xmath370 for @xmath371 and @xmath372 for @xmath373 .",
    "all requirements of the inductive hypothesis are satisfied , so we have @xmath374 .",
    "thus @xmath375 as claimed .",
    "[ corol ] let @xmath34 be a bipartite graph with a @xmath31 edge coloring and let @xmath205 .",
    "there exists a @xmath0-flat subgraph @xmath48 of @xmath1 with @xmath376 .",
    "combine theorem  [ 9 ] nwith lemma  [ 10 ] and the fact that @xmath332-shaving keeps all but at at most @xmath377 edges of @xmath1 .    the final lemma in this section is a simple but useful observation on @xmath0-flat graphs .",
    "it can also be stated for longer walks with height function bounded from below , but for simplicity we restrict attention to short walks .",
    "[ 11 ] let @xmath331 and let @xmath1 be a properly edge colored @xmath0-flat graph .",
    "let @xmath333 be a walk in @xmath1 of length @xmath346 with coloring @xmath318 .",
    "if @xmath378 for all @xmath379 then @xmath380 for all @xmath379 .    we prove the contrapositive statement .",
    "assume @xmath381 for some @xmath379 and let @xmath382 be the smallest such index .",
    "clearly , @xmath383 , @xmath384 and for the walk @xmath385 we have @xmath386 for @xmath387 .",
    "so by the definition of @xmath0-flatness we have @xmath388 .",
    "locally plane graphs were introduced in the paper @xcite ( though the name appears first in this paper ) . that paper gives a simple construction for @xmath17-locally plane graphs .",
    "we recall ( a simplified version of ) the construction as it is our starting point .",
    "let @xmath389 and consider the orthogonal projection of ( the edge graph of ) the @xmath31 dimensional hypercube into the plane .",
    "a suitable projection of the `` middle layer '' of the hypercube provides the @xmath17-locally plane graph .",
    "here is the construction in detail :    let @xmath389 be fixed and set @xmath390 .",
    "the bit at position @xmath108 in @xmath391 ( the @xmath108th coordinate ) is denoted by @xmath392 for @xmath393 .",
    "we let @xmath394 and @xmath395 . the abstract graph underlying the geometric graph to be constructed is @xmath396 with @xmath64 if @xmath39 , @xmath40 and @xmath6 differs from @xmath7 in a single position .",
    "this is the middle layer of the @xmath31 dimensional hypercube .",
    "we define the edge coloring @xmath100 that colors an edge @xmath55 by the unique position @xmath397 with @xmath398 .",
    "notice that this is a proper edge coloring .",
    "the number of vertices is @xmath399 , the number of edges is @xmath400 .",
    "the average degree is greater than @xmath401 .    to make the abstract graph @xmath402 into a geometric graph we project the hypercube into the plane .",
    "we give two possible projections here .",
    "the first is more intuitive and it is closer to the actual construction in @xcite .",
    "we let @xmath403 for @xmath404 and use this vector as the projection of the edges of color @xmath108 .",
    "we will use that among the vectors @xmath405 higher index means higher slope and much greater length .",
    "we identify the vertex @xmath128 with the point @xmath406 .",
    "the edges are represented by the straight line segment connecting their endpoints .",
    "we give the second construction to obtain a graph where all edges are very close in length and direction .",
    "let @xmath407 be arbitrary and consider the vectors @xmath408 and identify a point @xmath128 with @xmath409 .",
    "it is easy to verify that we get a geometric graph in both cases ( i.e. , the vertices are mapped to distinct points and no edge passes through a vertex that is not its endpoint ) .",
    "note that edges of color @xmath108 are all translates of the same vector @xmath405 or @xmath410 .",
    "we do not introduce separate notations for the two geometric graphs constructed this way as they will only be treated separately in the proof of lemma  [ 12 ] , where we refer to them as the first and the second realization of @xmath402 .      in @xcite",
    "a graph very similar to @xmath402 was shown to be @xmath17-locally plane .",
    "here we do more , we analyze all self - intersecting paths of @xmath402 as follows .",
    "[ 12 ] let @xmath247 be a walk in @xmath402 with coloring @xmath318 satisfying @xmath411 .",
    "assume that @xmath247 and all its non - empty subwalks have a unique edge of maximal color .",
    "the first and last edges of @xmath247 cross in either geometric realization if and only if @xmath317 is even and there is an odd index @xmath412 satisfying @xmath413 for all @xmath414 .",
    "let @xmath333 .",
    "note that the first and the last edges cross if and only if @xmath415 and @xmath416 are on different sides of the line @xmath417 through @xmath418 and @xmath419 and similarly @xmath418 and @xmath419 are on different sides of the line @xmath420 through @xmath415 and @xmath416 . to analyze such separations consider the projection @xmath421 to the @xmath7 axis parallel to edges of color @xmath108 .",
    "let us consider the first realization of @xmath402 with the vectors @xmath405 .",
    "we have @xmath422 and the projection of the vector @xmath423 is of length @xmath424 .",
    "thus higher colored edges map to longer intervals ( except color @xmath108 itself ) . under the projection",
    "@xmath425 the direction of the highest colored edge in the walks @xmath426 ( respectively , @xmath427 ) determines which side @xmath418 ( respectively @xmath419 ) lies of the line @xmath420 .",
    "indeed this highest color can not be @xmath98 , so the projections of the other edges will be much shorter and by the unique maximal color property we see that the walk contains at most @xmath428 edges having the @xmath0th largest color , so these shorter projections can not add up to be more than the projection of the largest edge .",
    "we can only have @xmath418 and @xmath419 lying on different sides of @xmath420 if these edges of maximal color are distinct , thus we must have @xmath429 for all @xmath414 . from @xmath430 and the unique maximal color property we have @xmath330 .",
    "taking @xmath223 to maximize @xmath431 for @xmath414 ( this is unique again ) we have @xmath413 for all @xmath414 .",
    "it is left to prove that the first and last edges of @xmath247 cross if and only if @xmath317 is even and @xmath432 is odd .",
    "to prove this claim one has to use that @xmath402 is bipartite with vertex sets @xmath35 and @xmath36 , and every edge of color @xmath88 is a translate of the vector @xmath433 with its head in @xmath36 and tail in @xmath35 .",
    "thus , the vector @xmath71 is either @xmath434 or @xmath435 depending on the parity of @xmath108 .",
    "which sides of @xmath420 @xmath418 and @xmath419 lie is determined by the projections of the @xmath432th and last edge , so they are on opposite sides if @xmath432 and @xmath317 have different parities .",
    "similarly , the sides of @xmath417 on which @xmath415 and @xmath416 lies is detemined by the @xmath436 projection of the first and @xmath432th edges , but as we have @xmath437 they are on different sides if @xmath86 and @xmath432 has the same parity . see figure  1 for a rough depiction of all four cases .",
    "this finishes the proof of the claim and the part of the lemma regarding the first realization of @xmath402 .",
    "the proof for the second realization of @xmath402 as a geometric graph ( involving the vectors @xmath410 ) is slightly more complicated .",
    "we have @xmath438 and @xmath439 .",
    "the @xmath440 terms alternate in sign in the projection on the edges and cancel completely for a walk of even length . for a walk of odd length",
    "a single such term remains but it is dominated by the other terms if the walk has an edge with color above @xmath108 . if , however , no such edge exists , the remaining uncanceled @xmath440 term dominates the other terms in the projection .",
    "thus , if the projection of the unique edge with the largest color of a walk has color @xmath441 or if @xmath442 but the walk has even length , then the sign of the @xmath421 projection of the edge with the largest color determines the sign of the projection of the entire walk .",
    "but in case @xmath442 and the walk has odd length , then the non - canceling @xmath440 term determines the sign .    let the edge @xmath443 be the one with the unique largest color in the walk @xmath426 . a case analysis of the parities of @xmath432 , @xmath317 and whether @xmath444 or @xmath445 hold show that the first and last edges of @xmath247 cross if and only if @xmath446 , @xmath432 is odd and @xmath317 is even  as claimed in the lemma .",
    "we call @xmath447 the _ reverse _ of the walk @xmath333 .",
    "[ 13 ] let @xmath331 and let @xmath26 be a @xmath0-flat subgraph of @xmath402 . if the length of a walk @xmath247 in @xmath26 does not exceed @xmath448 , then @xmath247 has unique edge of largest color .",
    "let @xmath247 be a walk of length @xmath449 in @xmath26 with coloring @xmath318 and assume the largest color is not unique .",
    "we may assume @xmath450 holds for all @xmath414 , otherwise one can take a suitable subwalk of @xmath247 .",
    "by lemma  [ 11 ] we have @xmath451 .",
    "consider @xmath280 the reverse of the walk @xmath247 .",
    "clearly , @xmath452 , but also by lemma  [ 11 ] we have @xmath453 .",
    "so we must have @xmath454 and @xmath317 must be odd .",
    "the contradiction that proves the statement of the lemma comes from the simple observation that between two consecutive appearances of a color in any walk of @xmath402 there always are an even number of edges , so @xmath317 must be even . to see this recall that @xmath402 is bipartite with sides @xmath35 and @xmath36 where @xmath35 consists of the 0 - 1 sequences of length @xmath31 with @xmath455 ones , while the 0 - 1 sequences in @xmath36 contain one more ones .",
    "the @xmath35 end of an edge of color @xmath88 has @xmath85 at position @xmath88 , while the @xmath36 end of this edge has @xmath86 there . along edges of other colors",
    "bit @xmath88 does not change .",
    "thus if a walk traverses an edge of color @xmath88 from @xmath35 to @xmath36 say , then along the walk bit @xmath88 remains @xmath86 until the next time the walk traverses an edge of color @xmath88 and this has to be from @xmath36 to @xmath35 .",
    "we note that lemma  [ 13 ] immediately implies that the girth of a @xmath0-flat subgraph of @xmath402 is at least @xmath456 .",
    "this estimate can be improved by observing that any cycle in @xmath402 has an even number of edges of any color ( one has to flip a bit even times to get beck to the original state ) . in particular any cycle",
    "has at least two occurrences of the largest color .",
    "these edges break the cycle into two paths sharing two edges .",
    "both path has to be of length at least @xmath456 , the length of the cycle is at least @xmath457 .    as every properly edge colored graph is @xmath86-flat the @xmath458 case of the next lemma establishes that @xmath402 is @xmath17-locally plane .",
    "[ 14 ] for any @xmath331 any @xmath0-flat subgraph of @xmath402 is @xmath459-locally plane in either realization .",
    "let @xmath26 be a @xmath0-flat subgraph of @xmath402 .",
    "we need to show that no walk ( or path ) @xmath247 of length @xmath346 is self - intersecting .",
    "it is clearly enough to show that the first and the last edges of @xmath247 do not cross and we may assume that the color of the first edge is not smaller than that of the last edge ( otherwise simply consider the same walk reversed ) . by lemma  [ 13 ] @xmath247 and all its subwalks have a unique edge of maximal color , so lemma [ 12 ] applies .",
    "it is enough to show that the coloring @xmath318 of @xmath247 does not satisfy the conditions of lemma [ 12 ] .",
    "assume the contrary .",
    "so @xmath317 is even , and there is an odd index @xmath432 such that @xmath413 for all @xmath414 .",
    "consider the walk @xmath460 of length @xmath461 .",
    "its coloring is @xmath462 and @xmath463 is its largest color . by lemma",
    "[ 11 ] @xmath464 .",
    "in fact , as @xmath461 is even @xmath465 is odd , so we have @xmath466 .    consider the walk @xmath467 of length @xmath468 and its coloring @xmath469 .",
    "the largest color in @xmath470 is @xmath223 , so we have @xmath471 by lemma [ 11 ] . and",
    "again by parity considerations @xmath472 .",
    "it is easy to see that @xmath473 .",
    "so we have @xmath474 contradicting lemma [ 11 ] .",
    "the contradiction proves lemma [ 14 ] .    [",
    "15 ] for any fixed @xmath475 and large enough @xmath12 there exists a @xmath459-locally plane graphs on @xmath12 vertices having at least @xmath476 edges .",
    "given two arbitrary disks in the plane , one can further assume that all edges of these graph connect a vertex inside one disk to one inside the other disk .",
    "simply combine the results of corollary  [ corol ] and lemma  [ 14 ] .",
    "if @xmath12 is not the size of the vertex set of @xmath402 for any @xmath31 , add isolated vertices to the largest @xmath402 with fewer than @xmath12 vertices .",
    "use the second realization of @xmath402 with a small enough @xmath477 to obtain a geometric graph with all edges connecting two small disks and apply a homothety and a rotation to get to the desired disks .",
    "the maximum number of edges of a @xmath17-locally plane graph on @xmath12 vertices is @xmath18 as proved in @xcite .",
    "the lower bound is reproduced here by the @xmath458 case of theorem [ 15 ] , which is therefore tight .",
    "the upper bound of @xcite extends to _",
    "@xmath6-monotone topological graphs _ ,",
    "i.e. , when the edges are represented by curves with the property that every line parallel to the @xmath7 axis intersects an edge at most once . without this artificial assumption on @xmath6-monotonicity",
    "only much weaker upper bounds are known . for higher values of @xmath0",
    "we do not have tight results even if the edges are straight line segments as considered in this paper . while the number of edges in a @xmath0-locally plane graph constructed here deteriorates very rapidly with the increase of @xmath0 , the upper bound hardly changes .",
    "in fact the only known upper bound better than @xmath13 is for @xmath478-locally plane graphs : they have @xmath479 edges as shown in @xcite .",
    "slightly better bounds are known for geometric ( or @xmath6-monotone topological ) graphs with the additional condition that a vertical line intersects every edge .",
    "if such a graph is @xmath480-locally plane for @xmath205 , then it has @xmath481 edges .",
    "the first realization of @xmath402 does not satisfy this condition , but the second one does .",
    "still , the lower and upper bounds for this restricted problem are far apart : for @xmath69-locally plane graphs with a cutting line the upper bound on the number of edges is @xmath482 while the construction gives @xmath483 .    although we can not establish that the locally plane graphs constructed are optimal we can prove that the thinning procedure we use is optimal within a constant factor .",
    "it follows that any @xmath69-locally plane subgraph of either realization of @xmath402 has @xmath484 edges .",
    "this optimality result below refers to a single step of the thinning procedure",
    ". it would be interesting to establish a strong upper bound on the number of edges of a @xmath0-flat graph for @xmath16 .",
    "let us mention here that the thinning procedures described in this paper found application in the extremal theory of @xmath85-@xmath86 matrices , see @xcite , and there the result is shown to be optimal within a constant factor .",
    "consider an @xmath12 by @xmath12  0 - 1 matrix that has no @xmath221 by @xmath17 submatrix of either of the following two forms : @xmath485 where the @xmath486 can represent any entry .",
    "the maximal number of @xmath86 entries in such a matrix is @xmath487 as proved in @xcite .",
    "the construction proving the lower bound is based on lexicographic thinning .",
    "the following lemma shows that the number of edges in the subgraphs claimed in lemma [ 0 ] and theorem [ 6 ] are optimal in a very strong sense : no properly edge colored graph with significantly more edges than the ones guaranteed by the above results can avoid heavy paths ( slow or fast walks , respectively ) .        for any vertex @xmath491 denote by @xmath492 , where the maximum is for edges @xmath129 incident to @xmath126 . for an edge @xmath55",
    "we define its _ weight _ to be @xmath493 , while its _ @xmath36-weight _ is @xmath494 .",
    "clearly , both @xmath495 and @xmath496 are integers in @xmath497 $ ] .    to prove part a ) of the lemma assume @xmath1 does not contain a heavy path .",
    "we set a threshold parameter @xmath498 and call an edge @xmath129 _ @xmath36-light _ if @xmath499 , otherwise @xmath129 is _",
    "@xmath36-heavy_.    all the edges incident to a vertex @xmath40 have different colors , thus they also have different @xmath36-weights , so at most @xmath24 of them can be @xmath36-light .",
    "the total number of @xmath36-light edges is at most @xmath500 .",
    "now consider two edges @xmath501 and @xmath502 incident to vertex @xmath39 .",
    "assume @xmath503 .",
    "if @xmath504 we can extend the path formed by these two edges with the edge @xmath60 incident to @xmath505 having maximum color @xmath506 . clearly , @xmath507 and the resulting path is heavy unless @xmath508",
    "therefore , the number of @xmath36-heavy edges incident to @xmath6 is at most @xmath509 .",
    "the total number of @xmath36-heavy edges is at most @xmath510 .      for parts",
    "b ) and c ) of the lemma consider an edge @xmath55 . if @xmath511 we call the edge @xmath129 _ maximal_. clearly , there are at most @xmath512 maximal edges",
    ". if @xmath129 is not maximal we define @xmath513 to be the `` next larger colored edge at @xmath6 '' , i.e. , @xmath513 is the edge in @xmath514 having minimal color @xmath515 among edges incident to @xmath6 and satisfying @xmath516 .",
    "we define the _ gap _ of @xmath129 to be @xmath517 .",
    "clearly , @xmath518 .",
    "we call the edge @xmath129 _ heavy _ if @xmath519 , otherwise @xmath129 is",
    "_ light_. recall , that for maximal edges @xmath513 and @xmath520 are not defined and maximal edges are neither light nor heavy .",
    "let @xmath58 and @xmath59 be distinct edges in @xmath514 incident to a vertex @xmath39 .",
    "if @xmath521 then @xmath522 . if @xmath58 is light , @xmath523 follows , therefore at most @xmath524 light edges are incident to @xmath39 .",
    "thus the total number of light edges in @xmath514 is at most @xmath525 .    for part",
    "b ) of the lemma assume @xmath1 does not contain a slow walk .",
    "let @xmath526 and @xmath527 be distinct non - maximal edges in @xmath514 and assume @xmath528 .",
    "let @xmath529 and let @xmath530 be the maximal edge incident to @xmath531 in @xmath1 .",
    "we have @xmath532 and @xmath533 .",
    "the edges @xmath58 , @xmath59 , @xmath60 , and @xmath530 can not form a slow walk .",
    "as @xmath534 we must have @xmath535 .",
    "this implies @xmath536 , and if @xmath59 is heavy @xmath537 .",
    "therefore , at most @xmath524 heavy edges can be incident to @xmath40 .",
    "the total number of heavy edges in @xmath1 is at most @xmath538 .      finally for part c ) of the lemma we assume @xmath1 does not contain a fast walk .",
    "let @xmath540 consist of the edges @xmath64 for which @xmath541 .",
    "assume without loss of generality that @xmath542 .",
    "if this is not the case consider the same graph with its sides switched .",
    "we use here that the definition of a fast walk and the claimed bound on the number of edges are both symmetric in the color classes .    as in the previous case consider two non - maximal edges @xmath526 and @xmath527 in @xmath540 with @xmath528 .",
    "let @xmath58 be the maximal edge incident to @xmath543 and let @xmath544 .",
    "as @xmath545 but @xmath1 does not contain a fast walk we must have @xmath546 .",
    "as @xmath547 we must also have @xmath548 .",
    "if @xmath60 is heavy we also have @xmath549 for all the heavy edges @xmath550 incident to @xmath40 the values @xmath551 increase strictly more than by a factor of @xmath221 .",
    "as these values are integers from @xmath497 $ ] , there are at most @xmath524 heavy edges in @xmath540 incident to @xmath7 .",
    "the total number of heavy edges in @xmath540 is at most @xmath552 .",
    "j. pach , geometric graph theory , in : _ surveys in combinatorics , 1999 _ , j. lamb , d. preece ( eds . ) , london mathematical society lecture notes * 267 * , cambridge university press , cambridge , 1999 , pp .",
    "167200 .",
    "j. pach , r. radoii , g. tth , relaxing planarity for topological graphs , in : _ discrete and computational geometry _ ( j. akiyama , m. kano , eds . ) , lecture notes in computer science * 2866 * , springer - verlag , berlin , 2003 , pp .  221232 .",
    "r. pinchasi , r. radoii , on the number of edges in geometric graphs with no self - intersecting cycle of length @xmath69 , in : _ towards a theory of geometric graphs _ , 233243 , contemporary mathematics 342 , american mathematical society , providence , ri , 2004 ."
  ],
  "abstract_text": [
    "<S> a graph drawn in the plane with straight - line edges is called a geometric graph . if no path of length at most @xmath0 in a geometric graph @xmath1 is self - intersecting we call @xmath1 @xmath0-locally plane . </S>",
    "<S> the main result of this paper is a construction of @xmath0-locally plane graphs with a super - linear number of edges . for the proof </S>",
    "<S> we develop randomized thinning procedures for edge - colored bipartite ( abstract ) graphs that can be applied to other problems as well . </S>"
  ]
}