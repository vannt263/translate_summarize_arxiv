{
  "article_text": [
    "markov random fields ( mrfs ) @xcite are popular probabilistic graphical representation for encoding the object s state space using sites and the correlation between local objects using edges .",
    "for example , a grid is a powerful image representation for pixels , where each site represents a pixel state ( e.g. , intensity or label ) and an edge represents local relations between neighboring pixels ( e.g. , smoothness ) . in other words",
    ", we can encode prior knowledge about the nature of interaction between objects in a mrf .",
    "once the model has been built , we can perform inference in a principled manner .",
    "one of the most important mrf inference problems in many applications is finding _ maximum a posteriori _ ( map ) assignment .",
    "the goal is to search for the the most probable state configuration of all objects , or equivalently , the lowest energy of the model .",
    "the problem is known to be np - complete @xcite . given a mrf of @xmath0 objects",
    "each of which has @xmath1 states , a brute - force search must explore @xmath2 state configurations . in image denoising , for example , @xmath0 is the number of pixels , which can range from @xmath3 , and @xmath1 is the number of pixel intensity levels , which are in the order of @xmath4 .",
    "this calls for heuristic methods which can find reasonable solutions in practical time .",
    "there have been a great number of attempts to solve this problem .",
    "an early approach was based on simulated annealing ( sa ) , where the convergence is also guaranteed for log - time cooling schedule @xcite .",
    "the main drawback of this approach is its low speed ",
    "it takes long time to achieve reasonably good solutions .",
    "another early attempt involves local greedy search , and the iterated conditional mode ( icm ) @xcite is probably the most well - known method . in probabilistic terms",
    ", it iteratively seeks for the mode of the local distribution of states of an object conditioned on the states of nearby objects . translated in combinatorial terms",
    ", it greedily searches for the local valley - here the neighborhood size is limited to @xmath1 - the number of possible states per object .",
    "not surprisingly , this method is prone to getting stuck at poor local minima .",
    "a more successful approach is belief - propagation ( bp ) @xcite , which exploits the _ problem structure _ better than the icm .",
    "the main idea is that we maintain a set of messages sending simultaneously along all edges of the mrf network .",
    "a message carries the information of the state of the sites it originates from , and as a result , any update of a particular site is informed by messages from all nearby sites . however , this method can only be guaranteed to work for a limited class of network structures  when the network reduces to a tree , where there are no loops in the network .",
    "another drawback is that the memory requirement for bp is high - this is generally linear in the number of edges in the network .",
    "more recently , efficient algorithms with theoretical guarantees have been introduced based on the theory of graph cuts @xcite .",
    "this class of algorithms , while being useful in certain computer vision problems , has limitation in the range of problems it can solve  the energy formulation must admits a certain _ metric _ form @xcite . in effect , these algorithms are not applicable to problems where energy functions are estimated from data and their functional forms are not known in priori",
    ".    given this ground , it is desirable to have an approximate algorithm which is fast enough ( better than icm - for example ) , consumes little memory and does not have any specific requirements of network structures or energy functionals .",
    "a meta - heuristic solution has already been proposed in the combinatorial optimization literature - the iterated local search ( ils ) ( e.g. see @xcite ) .",
    "typically , ils encourages jumping between local minima , which can be found by local search methods such as icm .",
    "this algorithm , however , does not exploit any model - specific information , and thus could be inefficient for the map assignment in mrfs . to this end , we propose a novel algorithm called _ tree - based iterated local search _ ( t - ils ) , which combines the strength of bp and ils .",
    "this algorithm exploits the fact that bp works efficiently on tree structures , in which the time complexity is linear in the number of edges in the tree , and thus bp is an effective candidate for locating good local minima .",
    "the main difference from standard tree - based bp is that our trees are _",
    "conditional _ trees which are built upon fixing states of neighbor leaves .",
    "when combined with ils , we have a heuristic algorithm that is less likely to get stuck in poor local minima , and has better chance to reach high quality solution , or even global minima .",
    "we evaluate our tree - based inference methods on three benchmark problems : ising model , stereo correspondence and image denoising .",
    "we empirically demonstrate that t - ils attains good performance , while requiring less training time and memory than the loopy bp , which is one the state - of - the - arts for these problems .    to summarize , our main contributions are the proposal and evaluation of fast and lightweight tree - based inference methods in mrfs .",
    "our choice of trees on @xmath5 images requires only @xmath6 memory where @xmath7 and two passes over all sites in the mrfs per iteration .",
    "these are much more economical than @xmath8 memory and many passes needed by the traditional loopy bp .",
    "this paper is organized as follows .",
    "section  [ sec : problem - setting ] describes mrfs , the map assignment problem , and belief propagation for trees . in section  [ sec : iterated - strong - local ] , the concept of conditional trees is defined , followed by two algorithms : the strong local search t - icm and the global search t - ils .",
    "section  [ sec : exp ] provides empirical support for the performance of the t - icm and t - ils .",
    "finally , section  [ sec : conclusion ] concludes the paper .",
    "the map assignment for markov random fields ( mrfs ) as a combinatorial search problem has attracted a great amount of research in the past several decades , especially in the area of computer vision @xcite and probabilistic artificial intelligence @xcite . the problem is known to be np - hard @xcite . for example , in labeling of an image of size @xmath9 , the problem space is @xmath10 large , where @xmath1 is the number of possible labels per pixel .",
    "techniques for solving the map assignment can be broadly classified into stochastic and deterministic classes . in early days , the first stochastic algorithms were based on simulated annealing ( sa ) @xcite .",
    "the first application of sa to markov random fields ( mrfs ) with provable convergence was perhaps the work of @xcite .",
    "the main drawback of this method is slow convergence toward good solutions @xcite .",
    "nature - inspired algorithms were also popular , especially the family of genetic algorithms @xcite .",
    "some attempts using ant colony optimization and tabu - search have also been made @xcite .",
    "deterministic algorithms started in parallel with iterated conditional model ( icm ) @xcite .",
    "it is a simple greedy search strategy that updates one label at a time .",
    "thus it is very slow and sensitive to bad initialization .",
    "a more successful approach is based on pearl s loopy belief propagation ( bp ) @xcite . due to its nature of using local information ( called `` messages '' ) to update `` belief '' about the optimal solution , loopy bp",
    "is also called a _ message passing _ algorithm .",
    "although loopy bp is neither guaranteed to converge at all nor to reach global optima , empirical evidences so far have indicated that it is very competitive against state - of - the - arts in a variety of image analysis problems @xcite .",
    "research on improving loopy bp is currently a very active topic in a range of disciplines , from artificial intelligence , statistical physics , computer visions to social network analysis @xcite .",
    "the most recent development centers around convex analysis @xcite . in particular , the map is converted into linear programming with relaxed constraints from which a mixture of convex optimization and message passing can be used .",
    "loopy bp also plays role in improving evolutionary algorithms under probabilistic graphical model representation @xcite .",
    "another powerful class of algorithms in computer vision is graph cuts @xcite .",
    "they are , nevertheless , designed with specific cost functions in mind ( i.e. _ metric _ and _ semi - metric _ ) @xcite , and therefore inapplicable for generic cost functions such as those resulting from learning .",
    "again , research in graph cuts is an active area in computer vision @xcite .",
    "interestingly , it has been recently proved that graph cuts are in fact loop bp @xcite .",
    "it is fair to say that the deterministic approach has become dominant due to their performance and theoretical guarantee for certain classes of problems @xcite .",
    "however , the problem is still unsolved for general settings , thus motivates this paper .",
    "our approach has both the deterministic and heuristic nature .",
    "it relies on the concept of _ strong local search _ using the deterministic method of bp , which is efficient in trees .",
    "the local search is strong because it covers a significant number of sites , rather than just one , which is often found in other local search methods such as icm @xcite .",
    "the neighborhood size in our method is very large @xcite . for typical image labeling problems , the size is @xmath11 for an image of height @xmath12 and width @xmath13 and label size of @xmath1 .",
    "standard local search like",
    "icm only explores the neighborhood of size @xmath1 at a time .",
    "once a strong local minimum is found , a stochastic procedure based on iterated local search @xcite is applied to escape from it and explores a better local minimum .",
    "the idea of exploiting the trees in mrf in image analysis is not entirely new . in early days , a spanning tree is used to approximate the entire mrf @xcite .",
    "this method is efficient but the approximation quality may hurt because the number of edges in tree is far less than that in the original mrf .",
    "another way is to built a hierarchical mrf with multiple resolutions @xcite , but this is less applicable for flat image labeling problems .",
    "our method differs from these efforts in that we use trees embedded in the original graph rather than building an approximate tree .",
    "second , our trees are conditional  trees are defined on the values of its leaves .",
    "third , trees are selected as we go during the search process .",
    "more recently , trees are used in variants of loop bp to specify the orders which messages are scheduled @xcite .",
    "our method can also viewed along this line by differs in the way trees are built and messages are updated",
    ". in particular , our trees are conditional on neighbor labeling , which is equivalent to collapsing an associated message to a single value .    iterated local search ( ils ) ,",
    "also known as basin hopping @xcite , has been used in related applications such as image registration @xcite , and structure learning in probabilistic graphical models @xcite .",
    "the success of ils depends critically on the local search and the perturbation ( basin hopping ) strategy @xcite . in @xcite , for example , a powerful local search based on conjugate gradients is essential to reach global solution for the lennard - jones clusters problem .",
    "our work builds strong local search using tree - based bp on the discrete spaces rather than continuous ones .",
    "in this section we introduce markov random fields ( mrfs ) and the map assignment problem with application to image labeling . a mrf is a probabilistic way to express the uncertainty in the discrete system of many interacting variables each of which is characterized by a set of possible states @xcite . in what follows",
    ", we briefly describe the mrf and its map assignment problem and focus on the minimization of model energy .",
    "formally , a mrf specifies a random field @xmath14 over a graph @xmath15 , where @xmath16 is the collection of @xmath0 sites @xmath17 , @xmath18 is the collection of edges @xmath19 between sites , and @xmath20 represents states at site @xmath21 .",
    "the entire system is random because the uncertainty in specifying the exact state of each site .",
    "one of the main objectives is to compute the most probable specification , also known as map assignment , which is the main focus of the paper .      in image labeling problem ,",
    "an image @xmath22 is a collection of pixels arranged in a particular geometrical way , as defined by the graph @xmath23 .",
    "typically , we assume a grid structure over pixels , where every inner pixel has exactly four nearby pixels .",
    "a labeling @xmath24 is the assignment of each pixel @xmath25 a corresponding label @xmath26 for all @xmath27 .",
    "a full specification of an mrf over the labeling @xmath24 given the image @xmath22 can be characterized by its energy .",
    "assuming pairwise interaction between connected sites , the energy is the sum of local energies as follows :    @xmath28    the singleton energy @xmath29 encodes the disassociation between the label @xmath26 and the features of image @xmath22 at site @xmath21 . in image denoising , for example , where @xmath25 is the corrupted pixel and @xmath26 is the true pixel we may use @xmath30 as the cost due to corruption .",
    "the pairwise energy @xmath31 often captures the smoothness nature of image , that is , two nearby pixels tend to be similar .",
    "for example , @xmath32 is a cost of difference between two labels , where @xmath33 is a problem - specific parameter .    in image labeling ,",
    "the task is to find the optimal @xmath34 that minimizes the energy @xmath35 , which now plays the role of the _ cost function : _",
    "@xmath36 for example , in image denoising , this translates to finding a map of intensity that admits both the low cost of corruption and high smoothness .",
    "the formal justification for the energy minimization in mrf can be found through the probability of the labeling defined as    @xmath37    where @xmath38 is the normalization term . thus minimizing the energy is equivalent to finding the most probable labeling @xmath34 . as @xmath39 is often called the _",
    "posterior _ distribution in computer vision[multiblock footnote omitted ] , the energy minimization problem is also referred to as _ maximum a posteriori _ ( map ) assignment .",
    "iterated conditional mode ( icm ) @xcite is a simple local search algorithm .",
    "it iteratively finds the local optimal labeling for each site @xmath21 as follows @xmath40 where @xmath41 is the set of sites connected to the site @xmath21 , often referred to as _",
    "markov blanket_. the markov blanket shields a site from the long - range interactions with remote sites , due to a special property of mrf known as _ markov property , _ which states that probability of a label assignment at site @xmath21 given all other assignments depends only on the nearby assignments @xcite .",
    "the probabilistic interpretation of eq .",
    "( [ eq : icm - energy ] ) is    @xmath42 the local update in eq .",
    "( [ eq : icm - energy ] ) is repeated for all sites until no more improvement can be made .",
    "this procedure is guaranteed to find a local minimum energy in a finite number of steps . however , the solutions found by the icm are sensitive to initialization and often unsatisfactory for image labeling @xcite .      [ cols=\"^ \" , ]     table  [ tab : stereo - energy - time ] shows the effect of changing from @xmath43 to @xmath44 in term of reducing 2d energy and error .",
    "the result , however , has the inherent horizontal ` streaking ' effect since no 2d constraints are ensured ( figs .  [",
    "fig : tsukuba],[fig : venus ] , bottom - left ) .",
    "the randomly initialized t - icm with one iteration ( @xmath45 in algorithm  [ alg : tree - based - icm ] ) performs comparably with the best of sl ( @xmath44 ) .",
    "the performance of t - icm improves significantly by initializing from the result of sl .",
    "t - ils initialized from sl finds better energy than the loopy bp given the same number of iterations , as shown in fig .",
    "[ fig : stereo - energy - minimization ] .      in image denoising , we are given an image corrupted by noise , and the task is to reconstruct the original image . for this set of experiments we use the @xmath46 noisy gray penguin image ( fig .",
    "[ fig : penguin - restore ] ) .",
    "the labels of the mrf correspond to @xmath47 intensity levels ( @xmath48 bits depth ) .",
    "similar to the stereo correspondence problem , we use a simple truncated potts model for the energy as follows @xmath49\\end{aligned}\\ ] ] where @xmath50 prevents the effect of extreme noise , and @xmath51 is smoothness parameter , following @xcite .",
    "in addition , the optimized loopy bp for potts models from @xcite is used .",
    "figs  [ fig : penguin - restore](b , c ) demonstrates that t - ils runs faster than the optimize loopy bp , yielding lower energy and smoother restoration .",
    "> p0.2>p0.15>p0.15c &   unsuccessful iterations .",
    "[ fig : penguin - restore],title=\"fig:\",scaledwidth=28.0% ] + ( a ) & ( b ) & ( c ) & ( d ) +",
    "we have proposed a fast method for inference in markov random fields by exploiting tree structures embedded in the network .",
    "we proposed a strong local search operator ( t - icm ) based on belief - propagation and a global stochastic search operator t - ils based on the iterated local search framework .",
    "we have shown in both simulation and two real - world image analysis tasks ( stereo correspondence and image denoising ) that the t - ils is competitive against state - of - the - art algorithms .",
    "we have demonstrated that by exploiting the structure of the domains , we can derive strong local search operators which can be exploited in a metaheuristic strategy such as ils .",
    "the line of current work could be extended in several directions .",
    "first , we could adapt the t - ils for certain cost functions .",
    "currently , the t - ils is designed as a generic optimization method , making no assumptions about the the nature of optimal solution .",
    "in contrast , label maps in vision are often smooth almost everywhere except for sharp boundaries .",
    "second , the mrfs may offer a more informative way to perform the jump steps , e.g. , by relaxing the messages in the local edges or by keeping track of the hopping trajectories .",
    "third , we have limited the t - ils to uniform distribution of step - sizes , but it needs not be the case . one useful heuristic is lvy flights @xcite in which the step - size @xmath52 is drawn from the power - law distribution : @xmath53 for @xmath54 .",
    "this distribution allows the step - size to usually stay within a certain narrow range but also allows occasional big jump ( which might behave like a total restart ) .",
    "alternatively , we can use beta distribution due to its richness in distribution shape and the boundedness of @xmath52 .",
    "fourth , since a mrf typically contain many separated conditional trees , it could be interesting to explore the parallel jump strategies .",
    "as our development is based on the recognition that we can exploit conditional trees in mrfs to obtain fast strong local search .",
    "the metaheuristics thus need not be limited to ils .",
    "in fact , conditional trees open up a new direction of research in the map assignment by investigating the use of other metaheuristics . for example",
    ", we can use genetic algorithms in conjunction with the conditional trees as follows .",
    "each individual in the ga population can be represented by a string of @xmath0 characters , each of which has one of @xmath1 values in the label alphabet .",
    "for each individual , we run the 2-pass bp to obtain a strong local solution .",
    "then the crossover operator can be applied character - wise on a selected subset to generate a new population .",
    "finally , although we have limited ourselves to applications in image analysis , the proposed algorithm is generic to any problems where mrfs are applicable .",
    "we provide the derivation of eq .",
    "( [ eq : cond - tree - energy ] ) from the probabilistic argument . recall that @xmath55 is the markov blanket of the tree @xmath56 , that is , the set of sites connecting to @xmath56 .",
    "due to the markov property        eq .",
    "( [ eq : cond - tree - energy ] ) can be derived from the energy above by letting : @xmath60 thus finding the most probable labeling of the tree @xmath56 conditioned on its neighborhood is equivalent to minimizing the conditional energy in eq .",
    "( [ eq : map - cond - tree - energy ] ) : @xmath61 the equivalence can also be seen intuitively by considering the tree @xmath56 as a mega - site , so the update in eq .",
    "( [ eq : map - cond - tree - energy ] ) is analogous to that in eq .",
    "( [ eq : icm - energy ] ) .",
    "[ [ proof - of - propositionpropt - icm - local - min - subproof - of - t - icm - local - opt ] ] proof of proposition  [ prop : t - icm - local - min ] [ sub : proof - of - t - icm - local - opt ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~      * @xmath63 is the data energy belonging to the tree @xmath56 , * @xmath64 the data energy outside @xmath56 , * @xmath65 is the interaction energy within the tree , * @xmath66 the interaction energy between the tree and its boundary , and * @xmath67 the interaction energy outside the tree                                john duchi , daniel tarlow , gal elidan , and daphne koller . using combinatorial optimization within max - product belief propagation . in b.",
    "schlkopf , j.  platt , and t.  hoffman , editors , _ advances in neural information processing systems 19 _ , pages 369376 . mit press , cambridge ,",
    "ma , 2007 .",
    "jrg  h kappes , bjoern andres , fred  a hamprecht , christoph schnrr , sebastian nowozin , dhruv batra , sungwoong kim , bernhard  x kausler , thorben krger , jan lellmann , et  al . a comparative study of modern inference techniques for structured discrete energy minimization problems .",
    ", 2014 .",
    "j.  lafferty , a.  mccallum , and f.  pereira .",
    "conditional random fields : probabilistic models for segmenting and labeling sequence data . in _ proceedings of the international conference on machine learning ( icml ) _ , pages 282289 , 2001 .",
    "murphy , y.  weiss , and m.i .",
    "loopy belief propagation for approximate inference : an empirical study . in k.b .",
    "laskey and h.  prade , editors , _ proceedings of the 15th conference on on uncertainty in artificial intelligence ( uai ) _ , pages 467475 , stockholm , 1999 .",
    "truyen tran , trung  thanh nguyen , and hoang  linh nguyen . .",
    "in _ proceedings of 2nd national symposium on research , development and application of information and communication technology ( ict.rda)_ , 2004 .",
    "m.  j. wainwright , t.  s. jaakkola , and a.  s. willsky .",
    "map estimation via agreement on ( hyper)trees : message - passing and linear - programming approaches .",
    "technical report ucb / csd-03 - 1269 , uc berkeley cs division , august 2003 ."
  ],
  "abstract_text": [
    "<S> the _ maximum a posteriori _ ( map ) assignment for general structure markov random fields ( mrfs ) is computationally intractable . in this paper , we exploit tree - based methods to efficiently address this problem . </S>",
    "<S> our novel method , named tree - based iterated local search ( t - ils ) takes advantage of the tractability of tree - structures embedded within mrfs to derive strong local search in an ils framework . </S>",
    "<S> the method efficiently explores exponentially large neighborhood and does so with limited memory without any requirement on the cost functions . </S>",
    "<S> we evaluate the t - ils in a simulation of ising model and two real - world problems in computer vision : stereo matching , image denoising . </S>",
    "<S> experimental results demonstrate that our methods are competitive against state - of - the - art rivals with a significant computational gain . </S>"
  ]
}