{
  "article_text": [
    "ab - initio molecular dynamics@xcite , also called the car - parrinello method , allows to study the dynamical and finite temperature behavior of molecules , surfaces and solids with forces from highly accurate first principles density functional simulations@xcite .",
    "this approach has revolutionized the way electronic structure calculations are done to date .",
    "two main variants of this approach have established themselves .",
    "the original approach of car and parrinello@xcite uses a fictitious lagrangian to deduce a dynamical equation of motion for the wave functions , while the so - called `` exact '' born oppenheimer dynamics@xcite performs self - consistency loops for each set of atomic positions .    the underlying idea of the fictitious lagrangian approach , which treats the electronic wave functions as dynamical fields that obey a newton - type equation of motion .",
    "if the temperature attributed to the motion of the wave functions is sufficiently low , the wave functions propagate close to the born - oppenheimer surface ( i.e. the instantaneous electronic ground state ) . thus the electronic wave functions can be propagated with relatively minor computational effort while the nuclei are moving .",
    "self - consistency loops for each step of the trajectory are avoided .",
    "a difficulty arises from the requirement that the wave functions remain sufficiently close to the born - oppenheimer surface so that physically correct forces on the nuclei are produced .",
    "this implies that the wave functions must remain `` cold '' , while at the same time the nuclei are at the , relatively high , physical temperature .",
    "hence ab - initio molecular dynamics simulations are in principle non - equilibrium simulations .    in most cases ,",
    "the heat transfer between the electronic and the atomic subsystems is sufficiently slow as a result of the separation between electronic and nuclear frequency spectra@xcite . for long simulations ,",
    "however , one has to bear in mind that the nuclear and electronic variables will eventually , even though very slowly , approach thermal equilibrium , where the wave functions deviate from the born - oppenheimer surface and the forces acting on the atoms are unphysical . in order to rigorously maintain a stable simulation ,",
    "two thermostats@xcite are introduced@xcite .",
    "one thermostat keeps the nuclei at their physical temperature and the other one adsorbs the additional heat transfer to the wave functions .",
    "the optimum temperature for the wave - function dynamics , which is required so that the wave functions can follow the nuclei adiabatically , has been discussed earlier.@xcite    however , the previous two - thermostat formulation has three deficiencies :    * for systems consisting of parts that are only in weak thermal contact , the thermostats do not guarantee that the canonical ensemble is correctly sampled . the heat transfer from the nuclei to the wave functions",
    "is larger for some atoms than for others , which may result in different effective temperatures for different parts of the system . *",
    "the target kinetic energy for the wave function dynamics is constant over time and is determined according to the target temperature of the atoms . for small systems",
    "the fluctuations in the atomic kinetic energy can be sizeable . in that case",
    "the wave function thermostat will heat the wave functions when the atomic kinetic energy is low and cool more than necessary if the atoms have a high kinetic energy .",
    "this has an adverse effect on the nuclear trajectories .",
    "* the goal of the wave function thermostat is to keep the wave functions cold .",
    "the thermostat however induces fluctuations in the wave function kinetic energy and thus introduces undesired heating sequences .    in this paper ,",
    "i analyze the trajectories of the nuclei and propose an new formulation of the two - thermostat method , which overcomes these deficiencies .",
    "the new method links the target temperature for the electronic wave functions directly to the instantaneous motion of the atoms .",
    "thus the wave function thermostat adapts to the temperature fluctuations of the nuclei , and minimizes its influence on the atomic trajectories .",
    "secondly , the indirect influence of the wave - function thermostat on the atomic trajectories is compensated using an additional , opposing friction term in the equations of motion for the atoms .    a detailed numerical analysis of the errors in the forces resulting from the deviations from the born - oppenheimer surface and due to the previous two - thermostat formulation been performed@xcite .    in sec .",
    "[ s_oldthermostat ] the previous two - thermostat formulation is restated , which allows me to introduce my notation . in sec .  [ s_downfolding ] effective equations of motion for the nuclei under the influence of the wave function dynamics",
    "are derived .",
    "[ s_instability ] discusses a potential thermodynamical instability in the previous two thermostat formulation of car - parrinello dynamics .",
    "[ s_newthermostat ] describes the new two thermostat formulation .",
    "an approximate scheme for deriving the parameters of the new theory and technicalities of the present implementation are given in sec .",
    "[ s_implementation ] .",
    "test calculations are presented in sec .",
    "[ s_tests ] .",
    "let me first describe my notation .",
    "the electrons are described by one - particle wave functions @xmath0 .",
    "the wave functions @xmath0 are related by a linear transformation @xmath1 to the variational parameters @xmath2 . often the variational parameters are vectors and the transformation is defined by a basis set @xmath3 in the form @xmath4 .",
    "here , i have in mind the projector - augmented wave ( paw ) method@xcite , where the variational parameters are themselves fields , namely the so - called pseudo wave functions @xmath5 .",
    "the pseudo wave functions are expanded in a basis set , a detail that does not concern here .",
    "the pseudo wave functions of the paw method are conceptionally identical to the wave functions of the pseudopotential formalism .    in the ab - initio molecular dynamics method with the previous two - thermostat formulation , the following coupled system of equations of motion is solved .",
    "@xmath6 if @xmath7 $ ] is the kohn - sham total energy functional , the pseudo hamiltonian @xmath8 is defined such that @xmath9 and the forces @xmath10 are the partial derivatives of the kohn - sham total energy functional with respect to the atomic positions .",
    "the pseudo overlap operator @xmath11 is obtained from the transformation between the true wave functions @xmath12 and the pseudo wave functions @xmath13 .",
    "the overlap between two wave functions is @xmath14 .",
    "the lagrange parameters introduced to keep the wave functions orthogonal are denoted as @xmath15 .",
    "the mass of the wave functions is @xmath16 . in practice an operator diagonal in a plane wave representation",
    "the nuclear masses are denoted as @xmath17 , where i is the index of the corresponding atom . @xmath18 and @xmath19 are the `` masses '' of the thermostat variables @xmath20 and @xmath21 for wave functions and nuclei respectively .",
    "these masses determine the reponse time and the dominant frequency of the thermostats .",
    "@xmath22 is the number of nuclear degrees of freedom and @xmath23 is the boltzmann constant .",
    "@xmath24 is a parameter that determines the target kinetic energy of the wave functions in the simulations .",
    "its value is chosen according to an estimate of the born - oppenheimer kinetic energy of the wave functions . in the entire paper hartree atomic units ( @xmath25 )",
    "the present formulation of the thermostat differs from hoover s : the thermostat variable used by hoover corresponds to the _ time derivatives _ of the thermostat variables @xmath21 and @xmath20 used here .",
    "this choice has the advantage that the thermostats obey second order differential equations just as the nuclear position and the wave functions .    even though the equations of motion given above can not be derived from a lagrangian formalism , they have a conserved energy @xmath26 \\nonumber\\\\ & + & \\frac{1}{2}q_\\psi \\dot{x}_\\psi^2 + 2e_{kin,0}x_\\psi + \\frac{1}{2}q_r \\dot{x}_r^2+gk_bt x_r \\ .\\end{aligned}\\ ] ] the first two terms are the kinetic energies of wave functions and nuclei , the third is the potential energy , i.e. the density - functional total energy .",
    "the remaining terms are kinetic and potential energies of the two thermostats for wave functions and nuclei .",
    "simulations with the two thermostats reach a stationary state in which the wave function thermostat variable @xmath20 exhibits an approximately constant drift to larger values , which freezes out the deviations from the born - oppenheimer approximation . as a consequence of energy conservation@xcite the atom thermostat variable decreases at an average rate @xmath27 which restores the energy absorbed by the wave - function thermostat .",
    "in order to understand the motion of the nuclei with the wave functions and thermostats tied to them , let me derive effective equations of motions for the nuclei .",
    "it is useful to consider the atoms as quasiparticles consisting each of a nucleus and the wave function cloud , i.e. the distortion of the surrounding electron gas . just as an electron distorts a surrounding crystal lattice to form a polaron , here a nucleus distorts the electron gas to form a quasiparticle called an atom .",
    "the distortion of the electron gas , respectively its wave functions , will be called wave function cloud .",
    "the effective equations of motion are obtained from the equations of motion in eq .",
    "[ eq_oldthermostat ] by constraining the wave functions to be identical to the exact born - oppenheimer wave function .",
    "the details of the derivation are given in app .",
    "[ a_downfolding ] . here",
    "only the result is shown : @xmath28\\ddot{r}_j&= & f_i - m_i\\dot{r}_i\\dot{x}_r -\\sum_jk_{i , j}\\dot{r}_j\\dot{x}_\\psi \\nonumber\\\\ & -&\\sum_{j , k } \\bigl(\\frac{\\partial k_{i , j}}{\\partial r_k}-\\frac{1}{2}\\frac{\\partial    k_{j , k}}{\\partial r_i}\\bigr)\\dot{r}_j\\dot{r}_k \\ . \\label{eq_downfold}\\end{aligned}\\ ] ] @xmath29 is the effective mass tensor as function of the nuclear positions @xmath30 where @xmath31 are the born - oppenheimer wave functions .",
    "let me discuss this equation :    * the nuclei obtain an effective mass @xmath32 : the atoms appear to be heavier than the nuclei alone , because also the wave functions need to be accelerated , whenever the nuclei accelerate .",
    "this effect has been realized before@xcite and corrections are in common use today . * the third term on the right - hand side of eq .",
    "[ eq_downfold ] is related to the friction imposed by the wave function thermostat on the wave functions . as the thermostat removes kinetic energy from the wave functions ,",
    "also the atoms are cooled down .",
    "in particular for two loosely coupled subsystems , where one subsystem has a different average effective wave function mass than the other , a drift of the thermostat variables cools one subsystem at the cost of the other .",
    "this may cause deviations from the canonical ensemble as discussed in more detail in the following section . *",
    "the last term in eq .",
    "[ eq_downfold ] describes the effect of the changes of the effective mass as the atoms are moving around .",
    "this term will not be discussed in more detail , because in this paper an approximation with the effective masses are independent of the atomic positions will be employed , where this term vanishes .",
    "here , the deviations from the canonical ensemble mentioned above are investigated .",
    "the rate of energy change of a subsystem @xmath33 imposed by the thermostats is according to eq .",
    "[ eq_downfold ] @xmath34 assuming that subsystem @xmath33 is in thermal equilibrium at a temperature @xmath35 , the thermal average of @xmath36 is @xmath37 .",
    "furthermore , the drifts of the two thermostat variables are related by eq .",
    "[ linkthermostats].@xcite thus eq .  [ edrift1 ] can be transformed to @xmath38 \\ , \\end{aligned}\\ ] ] where @xmath22 and @xmath39 are the number of degrees of freedom of the total system and subsystem @xmath33 .    if the thermal average of the born - oppenheimer wave function kinetic energy , @xmath40\\ , \\end{aligned}\\ ] ] is chosen for @xmath24 , one obtains @xmath41\\end{aligned}\\ ] ] where @xmath42 is the number of degrees of freedom in the subsystem @xmath43 which together with subsystem @xmath33 makes up the complete system .",
    "hence , the effect of the thermostats can be described as a heat flow from one system to the other , with a heat transport coefficient @xmath44\\end{aligned}\\ ] ] note that @xmath45 is negative .",
    "thermal equilibrium is only reached when total heat transport coefficient among subsystems is positive .",
    "this clearly shows that there is a thermodynamical instability when the physical thermal coupling is smaller ( in absolute values ) than the implicit coupling via the thermostats .",
    "the conditions for this thermodynamic instability are that    * the drift in the wave function thermostat is sufficiently rapid , * @xmath46 is very different for the atoms of one subsystem as compared to the other , and * the thermal coupling between the systems is sufficiently small , so that the effect of the thermostats is appreciable compared to the physical thermal coupling .    while these conditions rarely corroborate , already the fluctuations , which result from a nearby instability , can render the results of a simulations inaccurate .",
    "to cure the problems of the two - thermostat formulation , terms are added to the equations of motion that compensate the effect of the finite effective mass of the wave functions in the down - folded equations of motion for the atoms .",
    "i proceed with the assumption that the effective mass tensor of the wave functions is known .",
    "later , i will discuss an approximate expression to be used in practice .",
    "i propose a new set of equations of motion , which is the main result of this paper : @xmath47 \\nonumber\\\\     q_r\\ddot x_r     & = & 2 ( \\sum_{i}\\frac{1}{2}m_i\\dot r_i^2-\\frac{1}{2}gk_bt )     \\ , .",
    "\\label{eq : newthermostat}\\end{aligned}\\ ] ] the step function @xmath48 in the equation of motion for the wave function thermostat will be discussed in detail below .",
    "even if the step function is removed , these equations create a stable and energy conserving dynamics .",
    "its role is to shut the thermostat down for those periods of time , where the thermostat would otherwise heat the wave functions .",
    "the system of equations eq .",
    "[ eq : newthermostat ] has a conserved energy @xmath49 \\nonumber\\\\ & + & \\sum_n\\langle\\dot{\\tilde\\psi}_n|m_\\psi|\\dot{\\tilde\\psi}_n\\rangle -\\sum_{i , j } \\frac{1}{2}k_{i , j } \\dot{r}_i\\dot{r}_j \\nonumber\\\\ & + & \\frac{1}{2}q_\\psi \\dot{x}_\\psi^2+\\frac{1}{2}q_r \\dot{x}_r^2+gk_bt x_r \\label{eq_newec}\\end{aligned}\\ ] ] the second line of eq .",
    "[ eq_newec ] is the kinetic energy of the _ free _ motion of the wave functions representing deviations from the born - oppenheimer surface .",
    "the new system of equations of motion differs in four points from the ones used previously .",
    "* the nuclear mass is reduced by the effective wave function mass , so that the effective mass of atoms , namely the sum of the reduced mass of the nuclei and mass of the wave function cloud add up to the true nuclear mass .",
    "this correction has been previously suggested@xcite and is common practice in state - of - the - art ab - initio molecular dynamics simulations . * a friction force @xmath50 acting on the atoms has been added .",
    "this term is controlled by the wave function thermostat and opposes the drag from the wave functions , which themselves are slowed down by the wave function thermostat .",
    "+ the rate of energy added to or removed from the physical system by the wave functions thermostat is @xmath51\\dot{x}_\\psi$ ] .",
    "this energy transfer is proportional to the deviation of the wave functions from the born oppenheimer surface .",
    "hence the thermostat acts only on the _ free _ oscillations of the wave functions . *",
    "the estimate @xmath52 for the instantaneous born - oppenheimer kinetic energy has been introduced into the feedback equations for the wave function thermostat instead of a constant target energy used previously .",
    "this modification was necessary in order to obtain a conserved energy .",
    "+ besides restoring energy conservation , this term has another beneficial role , which is most important for systems with large kinetic energy fluctuations .",
    "the wave function thermostat adapts to the instantaneous kinetic energy of the nuclei and acts only on the deviations of the wave functions from the born - oppenheimer surface : the wave function thermostat would remain inactive for born - oppenheimer wave functions .",
    "* the wave function thermostat shuts down in an energy conserving fashion when it would otherwise heat the wave functions .",
    "this is discussed in the following .    despite the more complex equations of motion the conserved energy has one term less .",
    "there is no potential energy term related to the wave functions , which has important implications .",
    "the thermostat variable oscillates repeatedly between cooling and heating the wave functions .",
    "heating the wave functions is not desirable , as one would like to keep them at their lowest temperature compatible with the dynamics .",
    "a better strategy is to couple the wave function thermostat to the system only when cooling is required .",
    "this can be done in an energy conserving way , since the contribution of the wave function thermostat to the conserved energy vanishes whenever @xmath53 vanishes .",
    "thus the equation of motion for the wave function thermostat in eq .",
    "[ eq : newthermostat ] has been modified by introducing a step function @xmath54 .",
    "@xmath55 is the heaviside step function defined as @xmath56 , @xmath57 and @xmath58 .",
    "the discretization of the equation of motion for the wave function thermostat including the step function is not straightforward .",
    "this equation means the following : the thermostat dynamics is switched on with zero velocity , when the wave function kinetic energy grows larger than the target .",
    "@xmath53 grows and transfers energy from the wave function dynamics into the nuclear subsystem until the velocity of the thermostat variable vanishes again .",
    "at this point the wave function kinetic energy is below its target . instead of allowing the thermostat to heat the system ,",
    "the thermostat variable @xmath20 is instead kept constant , implying that the thermostat is effectively switched off .",
    "if the equation of motion is solved continuously , the velocity of the thermostat vanishes exactly , when the thermostat shuts down .",
    "the velocity will remain zero , until the wave function kinetic energy grows above its target , and thus does not affect the dynamics for that period of time .",
    "the thermostat switches on again , when the kinetic energy grows above the target .",
    "thus the trajectories proceed without any perturbation as long the wave function kinetic energy remains below its target value . in a discretized equation of motion the velocity of the thermostat must be explicitely reset to zero , whenever it would otherwise turn negative .",
    "to summarize , the thermostat resets the kinetic energy to a lower value if the wave functions become too hot , while transfering the energy into the nuclear dynamics .",
    "note that even when the wave function thermostat is on , the atomic trajectories are affected only if the effective mass tensor is inaccurate .",
    "hence the thermostat can operate more strongly before affecting the atomic dynamics .",
    "the thermostat variable of the atom thermostat does not experience any longer a steady drift in the new formulation .",
    "this can be deduced from the conserved energy expression as follows : a drift of the thermostat variables is possible in principle , because a fixed translation of a thermostat variable does not affect the dynamics and is therefore not observable .",
    "the time averaged drift of @xmath21 vanishes , because the potential energy of the atom thermostat is the only term in the conserved energy that depends on the thermostat variable .",
    "all other terms in the conserved energy are observable and therefore stationary",
    ".    a drift of the wave - function thermostat variable does not affect the conserved energy .",
    "hence , a drift of @xmath20 is possible .",
    "this drift counter - balances the heat flow from the nuclei to the wave functions but does not add to the conserved energy .    in the remainder of this section i will discuss a possible dynamical instability and how it can be avoided .",
    "the born - oppenheimer kinetic energy enters with a negative sign , which may point to a possible instability of the wave functions , when the bare mass - tensor with elements @xmath59 turns out not to be positive definite : a particle with mass accelerates in the opposite direction of the forces , and runs away from a minimum . the condition for the bare mass tensor to be positive definite poses a strict upper bound on the wave function mass @xmath16 .    in practice",
    "one needs to be even more restrictive : there is an internal excitation of the quasiparticle `` atom '' , where the nucleus oscillates with high frequency about the wave function cloud .",
    "this mode can be identified clearly when the wave functions are frozen and only the bare nuclei are allowed to move .",
    "if the bare mass of the nuclei is small , these oscillations may have high frequency that require a small time step in the discretization .",
    "while this mode falls into the class of deviations from the born - oppenheimer surface , the thermostat does not cure the problem since the wave function kinetic energy is smaller than its target @xmath52 . to avoid that problem",
    "i suggest to keep the wave function mass @xmath16 sufficiently small , so that @xmath60 .",
    "the new equations of motion require an analytic expression that approximates the effective mass tensor . as a start",
    ", i adopt the model of an infinitely dilute gas of atoms , which has been used in the context of the previous wave function thermostat and mass renormalization .",
    "the model of an infinitely dilute gas assumes that the born - oppenheimer wave functions can be divided up into purely atomic contributions , and that those are identical to the wave functions of the corresponding isolated atoms .",
    "the rationale for the model of an infinitely dilute gas is that the most rapid variations of the wave function occur near the nucleus , and are little affected by the bonding environment .",
    "thus , already the isolated atom will capture most of the relevant contributions .",
    "one can envisage better approximations for the effective mass of the wave functions , which depend explicitely on the atomic positions , and which may be derived from a tight - binding like description .",
    "i insert the atomic wave function into the expression eq .",
    "[ effmass ] for the effective mass tensor of a given atom and obtain @xmath61    it can be shown that in this approximation @xmath29 is diagonal for each atom with three identical matrix elements on its main diagonal : for symmetry reasons the acceleration of an isotropic atom is parallel to the force , that is @xmath62 with some parameter @xmath63 . hence , the acceleration is an eigenvector of the effective mass tensor @xmath64 . since @xmath63 is independent of the direction of the applied force , @xmath65 has three identical eigenvalues .",
    "therefore @xmath29 has the form of a unity matrix times a constant and the identity @xmath66 holds .    thus one can obtain a more simple form of our model effective mass as @xmath67    in the special case of a g - independent mass@xcite , the weight of the wave function cloud is directly related to the kinetic energy of the pseudo wave functions , as reported previously@xcite .",
    "@xmath68 in order to obtain the effective mass tensor , i determine the pseudo wave functions of the atom and transform them into g - space via a bessel transform .",
    "then i evaluate @xmath69 which are combined with the chosen parameters for the wave function mass to the effective mass tensor of the wave functions @xmath70 the variables @xmath71 are the occupation numbers of the one - particle states .",
    "typical values for @xmath72 and @xmath73 are given in tab .",
    "[ mparam ] . note , that these values depend on the choice of pseudo wave functions and are not transferable .",
    "they are listed here solely to provide the reader with a feeling of the order of magnitudes involved .",
    ".coefficients @xmath33 and @xmath43 for eq.[eq : effmass ] for different elements and their values relative to the nuclear masses .",
    "these values are not transferable . [ cols=\"<,^,^,^,^\",options=\"header \" , ]     the effective wave function mass must be substantially smaller than the nuclear masses , i.e. @xmath74 , in order to obtain a stable dynamics .",
    "if this requirement is violated the reduced mass of the atom is negative , and atoms accelerate in the opposite direction of the force acting on them .",
    "all equations of motion are implemented using the verlet algorithm .",
    "an equation of motion for a general coordinate @xmath75 has the form @xmath76 where @xmath77 is a friction coefficient , which may be constant or imposed by a thermostat .",
    "the thermostat @xmath75 creates a canonical ensemble by tuning the friction via @xmath78 with time .    the equations of motion discretized with a time step @xmath79 are obtained by replacing derivatives by the differential quotients @xmath80 and @xmath81 as @xmath82 where @xmath83 .",
    "the choice @xmath84 yields energy conserving trajectories and @xmath85 results in steepest descent dynamics .",
    "intermediate values of @xmath86 are the regime of friction dynamics .    because the thermostat can be propagated only with the knowledge of the instantaneous kinetic energy , which in turn depends on the propagated value of the thermostat , i extrapolate the thermostat variable for @xmath87 from the present and the previous two thermostat values @xmath88 this expression introduces errors of the forces of order @xmath89 , which is consistent with the overall accuracy of the verlet algorithm .",
    "the step function for the thermostat is implemented by resetting @xmath53 to zero for the propagation of wave function and nuclear positions , whenever it has a negative value otherwise , and by setting @xmath90 , whenever the velocity @xmath91 would become negative during the propagation of the thermostat variable .",
    "in order to test stability and accuracy of the method i investigated two systems .",
    "a simulation of carbon monoxide shall illustrate how the thermostats adapt to large fluctuations of the nuclear kinetic energy .",
    "this test case allows also a test of the accuracy .",
    "iron has been used as example for a metal and shows the stability of the trajectories against frequent band crossings .",
    "the simulations described in the following have been performed with the perdew - burke - ernzerhof density functional@xcite .",
    "the plane wave cutoff for the wave functions has been set at 30  ry and the one for the density at 60  ry .",
    "a time step of @xmath92  a.u.@xmath93  fs has been used together with a g - independent wave function mass of 1000  m@xmath94 .",
    "the frequency of the thermostat for the nuclei has been chosen to 10  thz , which is unusually large .",
    "the frequency of the wave function thermostat has been set to 100  thz .",
    "the unit cell size is a 13    fcc unit cell .",
    "the electrostatic interaction between periodic images has been subtracted.@xcite a 1@xmath95s+1@xmath95p+1@xmath95d projector set has been used , that is one projector for every relevant set of angular momentum quantum numbers . the one - center density has been expanded into spherical harmonics up to angular momentum of @xmath96 .",
    "parameter @xmath97 for carbon and @xmath98 for oxygen have been used , resulting in an effective mass of the wave function cloud amounts to 17  % and 35  % of the physical nuclear mass for carbon and oxygen respectively .",
    "rotations and translations have been frozen out by constraints so that a truely one - dimensional system is studied .",
    "the simulation has been performed at 1000  k.    the experimental value for the co stretch vibration is 2170  @xmath99.@xcite.the experimental bond - length is 1.1283  .@xcite fixed point calculation predict a bond - length of 1.138    and a stretch frequency of 2125  @xmath99 .",
    "these deviations are in the range of errors expected for the density functional used .    simulations lasting several picoseconds have been performed.@xcite a sequence of 0.3  ps is shown in fig .",
    "the deviation of the wave - function kinetic energy from the born - oppenheimer surface is -0.05 times the variation of the potential energy and overall smaller than 5  mev .",
    "this indicates that the dilute atomic gas model overestimates the effective masses by about 10% . on the other hand 90  % of the error",
    "has been removed .",
    "the reduced mass of atoms with the wave function cloud is 25  % of the true reduced mass , which , without correction , would result in an overestimate of 10% in the frequencies .",
    "given the error in the effective masses one can expect frequencies that overestimate the frequency derived from static calculation by 1  % , which is good agreement with the 2148  @xmath99 obtained from averaging vibrational periods during five picoseconds .    the friction measured in units of @xmath100 remains below @xmath101 , which is very small indicating that the heat transfer from wave functions to the nuclei is small in this system .",
    "the total energy is conserved to within 5  mev / ps and scales down with the size of the time step .      as a test of a metallic system",
    "i have chosen @xmath102-iron .",
    "an 8 atom fcc unit cell has been used . since",
    "only the @xmath103-point was included in the k - point sampling , i do not expect the simulation to be a realistic description of the material . the simulation temperature is 1185  k , at the martensitic phase transformation temperature .",
    "the parameter @xmath33 was about 12  % larger than the kinetic energy per atom , in order to account for the promotion of s- to d - electrons as one goes from an atom to the solid .",
    "the effective mass of the wave function per atom is 4.75  a.m.u ( a.m.u = m(@xmath104)/12 ) , about 9  % of the nuclear mass .",
    "the atom thermostat had a period of 0.1  ps , and the wave function thermostat had a period of 0.01  fs .",
    "the band gap due to finite k - point sampling is typically about 0.1 - 0.2  ev .",
    "the results for the simulation of one picosecond is shown in fig .",
    "the total energy variation is of order 1  ev .",
    "the mean average kinetic energy related to the non - born oppenheimer motion is 3  mev .",
    "the total energy drifts with 0.47  mev / ps .",
    "the typical deviation from the born - oppenheimer surface is 10 - 15  mev .",
    "most of the time the thermostat is switched off as the kinetic energy remains below the target defined by the effective masses .",
    "the most pronounced quenching sequence occurs at 0.7  ps . here",
    "the sharp increase of the wave function kinetic energy indicates a band crossing .",
    "a band crossing results in a randomization of the wave functions as the occupied state changes its character into that of the formerly unoccupied state , and would otherwise render the remainder of the simulation useless .",
    "the wave function thermostat brings the wave functions back to the born oppenheimer surface , while the perturbation of the nuclear dynamics during this rather strong quench is minimized by the opposing force acting on the nuclei .",
    "in summary , a new formulation of the two thermostat approach for ab - initio molecular dynamics has been presented .",
    "the approach aims at controlling only the deviations from the born - oppenheimer wave functions .",
    "the influence on the born - oppenheimer motion of the wave functions and the nuclear motion is minimized by additional forces opposing the indirect friction of the atoms .",
    "furthermore the thermostat is active only if the wave function kinetic energy grows beyond its estimated born - oppenheimer value .",
    "the new two - thermostat formulation can be applied to small systems with large fluctuations of the nuclear kinetic energy and the fictitious born - oppenheimer wave function kinetic energy .",
    "the new approach rests on an expression for the effective mass tensor of the wave functions .",
    "a simple formula has been derived from the previously employed model of an infinitely dilute gas .",
    "systematic improvements of effective mass tensor , which will improve the quality of the simulation , can be envisaged .",
    "part of this work has been performed at the ibm zurich research laboratory .",
    "i wish to acknowledge the hospitality of prof .",
    "k. schwarz and his group at vienna university of technology , where part of the work has been performed .",
    "this work has benefited from the collaboration within the esf programme on `` electronic structure calculations for elucidating the complex atomistic behavior of solids and surfaces '' .",
    "here , the effective equations of motion eq .  [ eq_downfold ] for the nuclei are derived , which include the forces of the wave functions acting on the nuclei .",
    "the wave functions are constrained to remain exactly on the born - oppenheimer surface , @xmath106 the born - oppenheimer wave functions @xmath107 are the ground state wave function for a given set of atomic positions @xmath108 .    because the born - oppenheimer wave functions depend on the nuclear positions , the forces acting on the wave functions translate into additional forces acting on the nuclei .",
    "thus effective equations of motion for the atoms are obtained .",
    "the atoms are now `` quasiparticles '' consisting of nuclei and the wave function clouds following them .",
    "the constraints are enforced by the method of lagrange multipliers : the constraint forces , which describe the effect of the wave function cloud , are the derivatives of a `` constraint energy '' @xmath109 with the auxiliary fields @xmath110 acting as lagrange parameters .",
    "the resulting constraint forces are @xmath111    the constraint forces are inserted in the equation of motion for the wave functions @xmath112 with the help of the constraint condition @xmath113 and the fact that @xmath114 the auxiliary fields @xmath115 are related to the born - oppenheimer wave functions via eq .  [ eq_constraintfield ] as @xmath116    the auxiliary fields are inserted into the expression for the constraint forces acting on the atoms , eq .",
    "[ eq_fc ] , and after a few transformations the additional forces of the wave function cloud acting on the atoms are obtained : @xmath117 \\nonumber\\\\ & = & -\\sum_j k_{i , j}\\ddot{r}_j -\\sum_{j , k } \\bigl(\\frac{\\partial k_{i , j}}{\\partial r_k}-\\frac{1}{2}\\frac{\\partial    k_{j , k}}{\\partial r_i}\\bigr)\\dot{r}_j\\dot{r}_k \\nonumber\\\\ & -&\\sum_jk_{i , j}\\dot{r}_j\\dot{x}_\\psi\\ .\\end{aligned}\\ ] ] the effective equation of motion given in eq .",
    "[ eq_downfold ] for the nuclei is obtained by adding the corresponding constraint forces to the equations of motion for the nuclei .",
    "99 r. car and m. parrinello , phys .",
    "lett . * 55 * , 2471 ( 1985 ) .",
    "p. hohenberg and w. kohn , phys . rev . *",
    "136 * , b864 ( 1964 ) .",
    "w. kohn and l.j .",
    "sham , phys . rev . * 140 * , a1133 ( 1965 ) .",
    "m. c. payne , m. p. teter , d. c. allan , t. a. arias and j. d. joannopoulos , rev .",
    "mod . phys.*64 * , 1045 ( 1992 ) .",
    "g. pastore , e. smargiassi , f. buda , phys .",
    "a * 44 * , 6334 ( 1991 ) .",
    "s.  nose , mol .",
    "phys . * 52 * , 255 ( 1984 ) .",
    "hoover , phys ,  rev .",
    "a * 31 * , 1695 ( 1985 ) .",
    "blchl and m.  parrinello , phys .",
    "b * 45 * , 9413 ( 1992 ) .",
    "p. tangney and s. scandolo , j. chem . phys . *",
    "116 * , 14 ( 2002 ) .",
    "blchl , phys .",
    "b * 50 * , 17953 ( 1994 ) . removing all terms from @xmath118",
    "that do not exhibit a long - term drift in a stationary simulation leaves only the two thermostat potential energies .",
    "their sum is constant since @xmath118 is conserved .",
    "m.  parrinello , private communication .",
    "note that this hold true only if the system remains in thermal equilibrium , because an ensemble average and a time average is mixed .",
    "a g - independent mass has the form of a constant times the identity operator .",
    "f.  tassone , f.  mauri and r.  car , phys .",
    "b * 50 * , 10561 ( 1994 ) .",
    "perdew and y.  wang , phys .",
    "b * 45 * 13244 ( 1992 ) .",
    "perdew , k.  burke , and m.  ernzerhof , phys .",
    ".  lett . * 77 * , 3865 ( 1996 ) .",
    "blchl , j. chem . phys .",
    "* 103 * , 7422 ( 1995 ) .",
    "rao , j.  chem .",
    "* 17 * , 1099 ( 1948 ) .",
    "huber ansd g. herzberg _ molecular spectra and molecular structure iv .",
    "constants of diatomic molecules _ , van nostrand reinhold , new york , 1979 .",
    "the simulation is not fully equilibrated , as the thermal fluctuations are still larger than in a canonical ensemble .",
    "this is however not relevant for the present purpose ."
  ],
  "abstract_text": [
    "<S> a rigorous two - thermostat formulation for ab - initio molecular dynamics using the fictitious lagrangian approach is presented . </S>",
    "<S> it integrates the concepts of mass renormalization and temperature control for the wave functions . </S>",
    "<S> the new thermostat adapts to the instantaneous kinetic energy of the nuclei and thus minimizes its influence on the dynamics . </S>",
    "<S> deviations from the canonical ensemble , which are possible in the previous two - thermostat formulation , are avoided . </S>",
    "<S> the method uses a model for the effective mass of the wave functions , which is open to systematic improvement . </S>"
  ]
}