{
  "article_text": [
    "next  generation ( ngs ) or high  throughput sequencing ( hts ) technologies provide a revolutionary tool for the study of the genome , epigenome and transcriptome in a multitude of organisms ( including humans ) by allowing the relatively rapid production of millions of short sequence tags , which mirror particular aspects of the molecular state of the biological system of interest .",
    "a common application of ngs technologies is the study of the transcriptome , which involves a family of methodologies , such as rna - seq@xcite , cage ( cap analysis of gene expression ; @xcite ) , sage ( serial analysis of gene expression ; @xcite ) and others .",
    "most published studies on the statistical analysis of count data generated by ngs technologies have focused on the themes of experimental design@xcite , normalisation@xcite and the development of tests for differential expression@xcite .",
    "surprisingly , not much attention has been paid on cluster analysis .",
    "clustering is considered an important tool in the study of genomic data and it has been used extensively in the analysis of microarrays@xcite ( see @xcite for a review of different clustering methods ) .",
    "it involves grouping together the expression profiles of different genes across different points in time , treatments and tissues , such that expression profiles in the same group are more similar in some way to each other than to members of other groups .",
    "genes which are clustered together across samples exhibit co - related expression patterns , which might indicate co  regulation and involvement of these genes in the same cellular processes@xcite .",
    "moreover , whole samples of gene expression profiles can be clustered together , indicating a particular macroscopic phenotype , such as cancer@xcite .",
    "a large class of clustering methods relies on the definition of a distance metric , which quantifies the `` similarity '' between any two gene expression data points .",
    "subsequently , clusters are formed , such that the distance between any two data points in the same cluster is minimised .",
    "typical methods in this category are k  means clustering and self  organising maps ( soms ) @xcite .",
    "another important category includes model  based clustering algorithms . in this case , the whole gene expression dataset is modeled as a random sample from a finite mixture of probability distributions , where each component of the mixture corresponds to a distinct cluster .",
    "the parameters of each component in the mixture ( e.g. mean and variance ) are usually estimated using an expectation ",
    "maximization algorithm@xcite .",
    "hierarchical clustering is yet a third type of clustering methodology , which is particularly suited for modelling genomic ( often hierarchically organized ) data .",
    "it generates a hierarchical series of nested clusters , which can be represented graphically as a _",
    "dendrogram_. this stands in contrast to partition  based methods ( e.g. k  means or soms ) , which decompose the data directly into a finite number of non  overlapping clusters@xcite .    in this paper , we present a model  based statistical approach and associated software ( _ dgeclust _ ) for clustering digital expression data .",
    "the proposed methodology is novel , because it simultaneously addresses the problem of model selection ( i.e. how many clusters are supported by the data ) and uncertainty ( i.e. the error associated with estimating the number of clusters and the parameters of each cluster ) .",
    "this is possible by exploiting a hierarchical dirichlet process mixture model or hdpmm@xcite , a statistical framework , which has been applied in the past on multi  population haplotype inference@xcite and for modelling multiple text corpora@xcite . in our version of the hdpmm ,",
    "individual expression profiles are drawn from the negative binomial distribution ( as , for example , in @xcite ) and parameter estimation is achieved using a novel blocked gibbs sampler , which permits efficiently processing large datasets ( including more than 20k features ) .",
    "we show how the output of our clustering algorithm can be utilised in differential expression analysis and , using simulated data , we demonstrate its superior performance  in terms of receiver operating characteristic ( roc ) and false discovery rate ( fdr ) curves  when compared to popular alternative methods . when applied on cage data from human brains , our methodology manages to detect a significantly larger number of differentially expressed transcripts than alternative methods",
    ". an early version of the proposed methodology has been presented previously in poster format and in @xcite .",
    "formally , the production of count data using next  generation sequencing assays can be thought of as random sampling of an underlying population of cdna fragments .",
    "thus , the counts for each tag describing a class of cdna fragments can , in principle , be modelled using the poisson distribution , whose variance is , by definition , equal to its mean .",
    "however , it has been shown that , in real count data of gene expression , the variance can be larger than what is predicted by the poisson distribution@xcite . an approach that accounts for the so  called `` over - dispersion '' in the data is to adopt quasi  likelihood methods , which augment the variance of the poisson distribution with a scaling factor , thus dropping the assumption of equality between the mean and variance@xcite .",
    "an alternative approach is to use the negative binomial distribution , which is derived from the poisson , assuming a gamma  distributed rate parameter .",
    "the negative binomial distribution incorporates both a mean and a variance parameter , thus modelling over  dispersion in a natural way@xcite . for this reason , in this paper we use the negative binomial distribution for modelling count data .",
    "we indicate the number of reads for the @xmath0 feature ( e.g. gene ) at the @xmath1 sample / library of the @xmath2 class of samples ( e.g. tissue or experimental condition ) with the variable @xmath3 . in a normalised dataset , we assume that @xmath3 is distributed according to a negative binomial distribution with gene and class  specific parameters @xmath4 : @xmath5 where @xmath6 is a probability measure",
    ", @xmath7 is the ( always positive ) mean of the distribution and @xmath8 is a dispersion parameter .",
    "since , the variance @xmath9 is always larger than the mean by the quantity @xmath10 , the negative binomial distribution can be thought of as a generalisation of the poisson distribution , which accounts for over  dispersion .",
    "a common limitation in experiments using ngs technologies is the low number or even absence of biological replicates , which complicates the statistical analysis of digital expression data .",
    "one way to compensate for small sample sizes is to assume that all features share the same variance@xcite .",
    "a less restrictive approach is to implement some type of information sharing between features , which permits the improved estimation of the feature  specific over  dispersion parameters by pooling together features with similar expression profiles@xcite . in this paper ,",
    "information sharing between features and between samples is introduced in a natural way due to the use of dirichlet processes as priors for the negative binomial distribution parameters and due to the hierarchical structure of the mixture model , as explained in this and the following section .",
    "specifically , within each sample class @xmath11 , we assume that the set of gene  specific parameters @xmath12 are random and distributed according to a prior distribution @xmath13 , i.e. @xmath14 furthermore , @xmath13 is itself randomly sampled from a _ dirichlet process _ with positive _ scaling parameter _ @xmath15 and _ base probability _",
    "distribution @xmath16@xcite : @xmath17 dirichlet process priors are distributions over distributions and they have become a popular choice in bayesian inference studies , since they provide an elegant and , in many ways , more realistic solution to the problem of determining the `` correct '' number of components in mixture models .",
    "standard theoretical results@xcite state that a sample @xmath13 from eq .",
    "[ eq : gj ] is a discrete distribution with probability one over a countably infinite set of @xmath18s .",
    "large values of @xmath15 lead to a large number of similarly likely values of @xmath18 , while small values of this parameter imply a small number of highly probable values of @xmath18 .",
    "this and eq . [ eq : theta_prior ] imply that the gene  specific parameters @xmath19 are not all distinct .",
    "different genes within the same class of libraries may share the same value of @xmath18 or , in other words , genes in class @xmath11 are grouped in a ( not known in advance ) number of clusters , based on the value of @xmath18 they share .",
    "equivalently , the expression profiles of different groups of genes in a given class of samples are drawn from different negative binomial distributions , each characterised by its own unique value of @xmath18 . this clustering effect within each sample class",
    "is illustarted in fig .",
    "[ fig : overview ] .      up to this point",
    ", we have considered clustering of features ( e.g. genes ) within the same class of samples , but not across classes of samples ( e.g. tissue or conditions ) . however , in a given dataset , each cluster might include gene expression profiles from the same , as well as from different sample classes .",
    "in other words , clusters are likely shared between samples that belong to different classes .",
    "this sharing of information between sample classes can be expressed naturally in the context of hierarchical dirichlet process mixture models@xcite .",
    "following directly from the previous section , we assume that the base distribution @xmath16 is itself random and sampled from a dirichlet process with a global scaling parameter @xmath20 and a global base distribution @xmath21 : @xmath22 this implies that @xmath16 is ( similarly to each @xmath13 ) discrete over a countably infinite set of atoms @xmath23 , which are sampled from @xmath21 , i.e. @xmath24 . since @xmath16 is the common base distribution of all @xmath13 , the atoms @xmath23 are shared among all samples , yielding the desired information sharing across samples ( see fig .",
    "[ fig : overview ] ) .      in summary , we have the following hierarchical model for the generation of a digital gene expression dataset ( see also fig . [",
    "fig : overview ] ) : @xmath25 where the base distribution @xmath21 provides the global prior for sampling the atoms @xmath26 and it takes the form of the following joint distribution : @xmath27 where @xmath28 is the set of hyperparameters , which @xmath21 depends on . according to the above formula , the inverse of the dispersion parameter @xmath29 is sampled from a lognormal distribution with mean @xmath30 and variance @xmath31 , while the probability parameter @xmath32 follows a uniform distribution in the interval @xmath33 $ ] .",
    "given the above formulation , @xmath29 is always positive , as it oughts to and , since the lognormal distribution has a well known conjugate prior , the above particular form for @xmath21 greatly facilitates the posterior inference of the hyper - parameters @xmath28 ( see below ) .      the definition of the hdpmm in eqs .",
    "[ eq : hdp ] is implicit . in order to facilitate posterior inference ,",
    "an equivalent constructive representation of the above model has been introduced in @xcite utilising sethuraman s stick - breaking representation of a draw from a dirichlet process@xcite .",
    "this representation introduces a matrix of indicator variables @xmath34 , where each element of the matrix , @xmath35 , indicates which cluster the @xmath0 expression measurement in the @xmath2 class of samples belongs to .",
    "two different features belong to the same cluster if and only if their indicator variables , e.g. @xmath35 and @xmath36 , are equal .",
    "a major aim of bayesian inference in the above model , is to calculate the posterior distribution of matrix @xmath37 given the dataset @xmath38 , i.e. @xmath39 .",
    "one approach to estimate this distribution is by utilizing markov chain monte carlo methods , which generate a chain of random samples as a numerical approximation to the desired distribution .",
    "we have developed a blocked gibbs sampler in the software package _ dgeclust _ , which efficiently generates new samples from the posterior @xmath39 .",
    "the algorithm is an extension of the method presented in @xcite for inference in non - hierarchical dirichlet process mixture models and its advantage is that it samples each element of @xmath37 independently of all others .",
    "this not only results in very fast convergence , but it also allows implementing the algorithm in vectorized form , which takes advantage of the parallel architecture of modern multicore processors and potentially permits application of the algorithm on very large datasets .",
    "alternative mcmc methods , which are developed on the basis of the popular chinese restaurant franchise representation of the hdp@xcite , do not enjoy the same advantage since they are restricted by the fact that sampling each indicator variable is conditioned on the remaining ones , thus all of them must be updated in a serial fashion .",
    "details of the algorithm are given in vavoulis & gough , 2014 ( in preparation ) .",
    "assuming that the above algorithm has been applied on a digital expression dataset @xmath38 and a sufficiently large chain of samples @xmath40  which approximates the posterior @xmath39  has been generated , we show how these samples can be utilised in a differential expression analysis scenario .",
    "we consider two classes of samples , 1 and 2 , which might represent , for example , two different tissues or experimental conditions .",
    "a particular feature ( gene or transcript ) is said to be _ not _ differentially expressed , if its expression measurements in classes 1 and 2 belong to the same cluster . in more formal language",
    ", we say that the expected conditional probability @xmath41 that feature @xmath42 is not differentially expressed given data @xmath38 is equal to the expected probability @xmath43 that the indicator variables of feature @xmath42 in sample classes 1 and 2 have the same value .",
    "this probability can be approximated as a simple average over the previously generated mcmc samples @xmath44 : @xmath45 where @xmath46 is equal to @xmath47 if the expression inside the parentheses is true and @xmath48 otherwise .",
    "given a threshold @xmath49 , we can generate a set @xmath50 of potentially differentially expressed features with probabilities less than this threshold , i.e. @xmath51 , where @xmath52 is calculated as in eq .",
    "[ eq : pi ] for all @xmath42 .",
    "as observed in @xcite , the quantity @xmath52 measures the conditional probability that including the @xmath0 feature in list @xmath50 is a type i error , i.e. a false discovery .",
    "this useful property makes possible the calculation of the conditional false discovery rate ( fdr ) as follows : @xmath53 from eq .",
    "[ eq : fdr ] , it can be seen that @xmath50 always has an fdr at most equal to @xmath49 .",
    "alternatively , one can first set a target fdr , say tfdr , and then find the maximum possible value of @xmath49 , such that @xmath54 .",
    "notice that , unlike alternative approaches , which make use of gene  specific p ",
    "values , this methodology does not require any correction for multiple hypothesis testing , such as the benjamini-hochberg procedure . although the computation of fdr using eq .",
    "[ eq : fdr ] is approximate ( since it depends on the accuracy of the calculation of @xmath52 using eq .",
    "[ eq : pi ] ) , it is reasonable to assume that the error associated with this approximation is minimised , if sufficient care is taken when postprocessing the mcmc samples generated by the gibbs sampler .",
    "in order to assess the performance of our methodology , we applied it on simulated and actual count data and we compared our results to those obtained by popular software packages , namely _ deseq _ , _ edger _ and _",
    "bayseq_.    first , we applied our algorithm on simulated clustered data , which were modelled after rna  seq data from yeast ( _ saccharomyces cerevisiae _ ) cultures@xcite .",
    "this data were generated using two different library preparation protocols .",
    "samples for each protocol included two biological ( i.e. from different cultures ) and one technical ( i.e. from the same culture ) replicates , giving a total of six libraries .",
    "the simulated data were generated as follows : first , we fitted the yeast rna  seq data with a negative binomial mixture model , where each component in the mixture was characterised by its own @xmath55 and @xmath56 parameters .",
    "we found that 10 mixture components fitted the data sufficiently well . at this stage",
    ", it was not necessary to take any replication information into account .",
    "the outcome of this fitting process was an optimal estimation of the parameters of each component in the mixture , @xmath29 and @xmath32 , and of the mixture proportions , @xmath57 , where @xmath58 .    in a second stage",
    ", we generated simulated data using the fitted mixture model as a template .",
    "for each simulated dataset , we assumed 2 different classes of samples ( i.e. experimental conditions or tissues ) and 2 , 4 or 8 samples ( i.e. biological replicates ) per class . for gene @xmath42 in class @xmath11",
    ", we generated an indicator variable @xmath35 taking values from @xmath47 to @xmath59 with probabilities @xmath60 to @xmath61 .",
    "subsequently , for gene @xmath42 in sample @xmath62 in class @xmath11 , we sampled expression profile ( i.e. counts ) @xmath3 from a negative binomial distribution with parameters @xmath63 and @xmath64 .",
    "the process was repeated for all genes in all samples in both classes resulting in a matrix of simulated count data . mimicking the actual data , the depth of each library was randomly selected between @xmath65 to",
    "@xmath66 reads .",
    "gene @xmath42 was considered differentially expressed , if indicator variables @xmath67 and @xmath68 were different , i.e. if the count data for gene @xmath42 in the two different classes belonged to different clusters . by further setting @xmath67 equal to @xmath68 for arbitrary values of @xmath42 , it was possible to generate datasets with different proportions of differentially expressed genes .",
    "since the proportion of differentially expressed genes may affect the ability of a method to identify these genes@xcite , we examined datasets with 10% and 50% of their genes being differentially expressed .    in our comparison of different methodologies , we computed the average receiver operating characteristic ( roc ) and false discovery rate ( fdr ) curves over a set of 10 different simulated datasets . in order to keep execution times to a reasonable minimum",
    ", we considered datasets with 1000 features .",
    "all examined methods allow to rank each gene by providing nominal p  values ( _ edger _ , _ deseq _ ) or posterior probabilities ( _ dgeclust _ , _ bayseq _ ) .",
    "given a threshold score , genes on opposite sides of the threshold are tagged as differentially expressed or non  differentially expressed , accordingly . in an artificial dataset , the genes that were simulated to be differentially expressed are considered to be the true positive group , while the remaining genes are considered the true negative group . by computing the false positive rate ( fpr ) and the true positive rate ( tpr ) for all possible score thresholds , we can construct roc and fdr curves for each examined method .",
    "the area under a roc curve is a measure of the overall discriminative ability of a method ( i.e. its ability to correctly classify transcripts as differentially or non  differentially expressed ) .",
    "similarly , the area under an fdr curve is inversely related to the discriminatory performance of a classification method .",
    "our results are summarised in fig .",
    "[ fig : clustered ] . when datasets with 10% de transcripts and a small number of samples is considered ( fig .",
    "[ fig : clustered]ai ) , _ dgeclust _ performs better than the similarly performing _ bayseq _ , _ edger _ and _ deseq_. by increasing the number of samples to 4 and 8 ( figs .",
    "[ fig : clustered]aii and aiii ) , we can increase the discriminatory ability of all methods . again , _ dgeclust _ is the top performer , with _ bayseq _ following closely .",
    "while roc curves provide an overall measure of the discriminatory ability of differrent classification methods , they do not immediately indicate whether the deviation from a perfect classification is mainly due to false positives or false negatives .",
    "for this reason , we also constructed fdr curves , which illustrate the number of false positives as a function of the total number of positives ( i.e. as the decision threshold changes ) .",
    "mean fdr curves for datasets with 10% de transcripts are illustrated in figs .",
    "[ fig : clustered]bi  biii .",
    "notice that we measure the false positives only among the first 100 discoveries , which is the true number of de transcripts in the simulated datasets .",
    "we may observe that _ dgeclust _ keeps the number of false positives smaller than the corresponding number of the examined competitive methods .",
    "this is particularly true at a small number of samples ( figs .",
    "[ fig : clustered]bi and bii ) . for a large number of samples ( fig .",
    "[ fig : clustered]biii ) , _ dgeclust _ and _ bayseq _ perform similarly in terms of keeping false positives to a minimum among the top ranking transcripts .",
    "the same trends are observed when we considered datasets with 50% de transcripts . in this case , the difference in performance between _ dgeclust _ and the competitive methods is even more prominent , as indicated by the average roc curves ( figs .",
    "[ fig : clustered]ci  ciii ) .",
    "this is mainly due to a drop in the performance of _ deseq _ , _ bayseq _ and _ edger _ and not to an increase in the performance of _ dgeclust _ , which remains largely unaffected .",
    "this is particularly true when a larger number of samples is considered ( figs .",
    "[ fig : clustered]cii , ciii ) . in terms of keeping the false positives to a minimum among the top ",
    "ranking trascripts , _ dgeclust _ is again the top performer , with _",
    "bayseq _ in the second place ( figs .",
    "[ fig : clustered]d ) .",
    "notice that when a large number of samples is available , _ dgeclust _ does not return any false positives among the first 500 discoveries ( fig .",
    "[ fig : clustered]diii ) , which is the true number of de transcripts in the simulated datasets .",
    "since our algorithm is designed to take advantage of the cluster structure that may exist in the data , testing different methods on clustered simulated data might give an unfair advantage to _",
    "dgeclust_. for this reason , we further tested the above methodologies on unclustered simulated data ( or , equivalently , on simulated data , where each gene is its own cluster ) .",
    "as in the case of clustered simulated data , the unclustered data were modelled after yeast rna ",
    "seq data@xcite , following a procedure similar to @xcite . in a first stage",
    ", we used _",
    "deseq _ to estimate unique @xmath69 and @xmath70 parameters for each gene @xmath42 in the yeast data . in a second stage , for each gene @xmath42 in each class @xmath11 in the simulated data , we sampled randomly a unique index @xmath35 ranging from @xmath47 to @xmath71 , where @xmath71 was the total number of genes in the simulated data .",
    "subsequently , for each gene @xmath42 in each sample @xmath62 in each class @xmath11 , we sampled counts @xmath3 from a negative binomial distribution with parameters @xmath63 and @xmath64 .",
    "as for the clustered data , gene @xmath42 was simulated to be differentially expressed by making sure that the randomly sampled indicator variables @xmath72 and @xmath73 had different values .",
    "the above procedure for simulating unclustered count data makes minimal assumptions about the expression profiles of differentially and non  differentially expressed genes and it is a simple extension of the procedure we adopted for simulating clustered count data .",
    "as above , we considered datasets with 1000 genes , 2 sample classes and 2 , 4 or 8 samples per class and we randomly selected the library depths between @xmath65 and @xmath66 reads .",
    "also , datasets with either 10% or 50% of their genes being differentially expressed were considered .    our results from testing _",
    "dgecust _ , _ edger _ , _ deseq _ and _ bayseq _ on unclustered simulated data",
    "are presented in fig .",
    "[ fig : unclustered ] .",
    "we may observe that all methods perform similarly for both low ( fig .",
    "[ fig : unclustered]a , b ) and high ( fig .",
    "[ fig : unclustered]c , d ) proportions of de genes . in particular , despite the absence of a clear cluster structure in the data , _ dgeclust _ is not worse than competitive methods .",
    "this is indicative of the fact that our algorithm is applicable on a more general category of count datasets , which includes either clustered or unclustered data . as in the case of clustered data ,",
    "increasing the number of samples improves the overall performance of the various methodologies ( figs .",
    "[ fig : unclustered]a ) and reduces the number of false positives among the top  ranking discoveries ( figs .  [ fig : unclustered]b ) .",
    "the same trends are observed , when a high proportion of de genes is considered ( figs .",
    "[ fig : unclustered]c , d ) .",
    "in addition to simulated data , we also tested our method on cage libraries , which were prepared according to the standard illumina protocol described in @xcite .",
    "the dataset consisted of twenty  five libraries isolated from five brain regions ( caudate nucleus , frontal lobe , hippocampus , putamen and temporal lobe ) from five human donors and it included 23448 features , i.e. tag clusters representing promoter regions ( see materials and methods for more details ) .",
    "as illustrated in fig .",
    "[ fig : sim_progress]a , _ dgeclust _ was left to process the data for 10k iterations .",
    "equilibrium was attained rapidly , with the estimated number of clusters fluctuating around a mean value of approximatelly 81 clusters ( figs .",
    "[ fig : sim_progress]a , b ) and the normalised autocorrelation of the markov chain dropping quickly below 0.1 after a lag of only around 10 iterations ( fig .",
    "[ fig : sim_progress]c ) .",
    "a snapshot of the fitted model at the end of the simulation illustrates how samples from each brain region are tightly approximated as mixtures of negative binomial distributions ( i.e. clusters ; fig .",
    "[ fig : fitted ] ) . after the end of the simulation",
    ", we used the procedure outlined in a previous section in order to identify differentially expressed transcripts using a nominal burn  in period of @xmath74 iterations .",
    "we also applied _ edger _ , _ deseq _ and _ bayseq _ on the same dataset in order to find differentially expressed transcripts between all possible pairs of brain regions .",
    "transcripts selected at an fdr threshold of 0.01 were considered differentially expressed .    in a first stage , we compared the number of de transcripts found by different methods .",
    "it can be observed ( fig .",
    "[ fig : matrix_plot ] , upper triangle ) that , for all pairs of brain regions , _ dgeclust _ returned the largest number of de transcripts , followed by _ edger _ and , then , _ deseq _ and _ bayseq _ which , for all cases , discovered a similar number of de transcripts .",
    "in particular , _ dgeclust _ was the only method that found a significant number of de transcripts ( 520 ) between the frontal and temporal lobes , whereas _",
    "_ deseq _ and _ bayseq _ found only 7 , 3 and 4 de genes , respectively . by checking the overlap between transcripts classified as de by different methods ( fig .",
    "[ fig : matrix_plot ] , lower triangle ) , we conclude that the de transcripts found by _ edger _ , _ deseq _ and _ bayseq _ are in all cases essentially a subset of the de transcripts discovered by _",
    "dgeclust_. _ dgeclust _ appears to identify a large number of `` unique '' transcripts , in addition to those discovered by other methods , followed in this respect by _",
    "edger _ , which also found a small number of `` unique '' transcripts in each case .",
    "in a second stage , we compared the number of de genes identified by _ dgeclust _ between different brain regions and we constructed a ( symmetric ) similarity matrix , which can be used as input to hierarchical clustering routines for the generation of dendrograms and heatmaps .",
    "specifically , each element @xmath75 of this matrix measuring the similarity between brain regions @xmath76 and @xmath77 is defined as follows : @xmath78 where @xmath71 is the number of features in the dataset and @xmath52 is the probability that transcript @xmath42 is differentially expressed between regions @xmath76 and @xmath77 , as computed by eq .",
    "[ eq : pi ] . the similarity matrix calculated as above",
    "was used to construct the dendrogram / heatmap in fig .",
    "[ fig : hier ] , after employing a cosine distance metric and complete linkage .",
    "it may be observed that the resulting hierarchical clustering reflects the evolutionary relations between different regions .",
    "for example , the temporal and frontal lobe samples , which are both located in the cerebral cortex , are clustered together and they are maximally distant from subcortical regions , such as the hippocampus , caudate nucleus and putamen .",
    "the last two are also clustered together and they form the dorsal striatum of the basal ganglia .",
    "despite the availability of several protocols ( e.g. single vs. paired  end ) and sequencing equipment ( e.g. solexa s illumina genome analyzer , abi solid sequencing by life technologies and roche s 454 sequencing ) , all ngs technologies follow a common set of experimental steps ( see @xcite for a review ) and , eventually , generate data , which essentially constitutes a discrete , or _ digital _ measure of gene expression .",
    "this data is fundamentally different in nature ( and , in general terms , superior in quality ) from the continuous fluorescence intensity measurements obtained from the application of microarray technologies . in comparison ,",
    "ngs methods offer several advantages , including detection of a wider level of expression levels and independence on prior knowledge of the biological system , which is required by the hybridisation ",
    "based microarrays@xcite . due to their better quality",
    ", next  generation sequence assays tend to replace microarrays , despite their higher cost@xcite .    in this paper",
    ", we have addressed the important issue of clustering digital expression data , a subject which is surprisingly lacking in methodological approaches , when compared to micro  arrays .",
    "most proposals for clustering rna  seq and similar types of data have focused on clustering variables ( i.e. biological samples ) , instead of features ( e.g. genes ) and they employ distance  based or hierarchical clustering methodologies on appropriatelly transformed datasets , e.g. @xcite .",
    "for example , the authors in @xcite calculate a common variance function for all samples in a tag ",
    "seq dataset of glioblastoma  derived and non  cancerous neural stem cells using a variance  stabilizing transformation , followed by hierarchical clustering using a euclidean distance matrix . in @xcite ,",
    "a pearson correlation dissimilarity metric was used for the hierarchical clustering of rna ",
    "seq profiles in 14 different tissues of soybean after these were normalised using a variation of the rpkm method@xcite .    the above approaches , although fast and relatively easy to implement , do not always take into account the discrete nature of digital gene expression data .",
    "for this reason , various authors have developed distance metrics based on different parameterizations of the log  linear poisson model for modelling count data , e.g. @xcite .",
    "a more recent class of methods follows a model  based approach , where the digital dataset is modeled as a random sample from a finite mixture of discrete probability distributions , usually poisson or negative binomial@xcite . utilising a full statistical framework for describing the observed count data , these model  based approaches often perform better than distance  based algorithms , such as k - means@xcite .    although computationally efficient and attractive due to their relative conceptual simplicity , the utility of both distance and finite model  based clustering methods has been critisised@xcite .",
    "one particular feature of these methodologies , which compromises their applicability , is that the number of clusters in the data must be known _ a priori_. for example , both the k  means and the som alogrithms require the number of clusters as input .",
    "similarly , methods which model the data as a finite mixture of poisson or negative binomial distributions@xcite require prior knowledge of the number of mixture components . estimating the number of clusters usually makes use of an optimality criterion , such as the bayesian information criterion ( bic ) or the akaike information criterion ( aic ) , which requires repeated application of the algorithm on the same dataset with different initial choices of the number of clusters .",
    "thus , the number of clusters and the parameters for each individual cluster are estimated separately , making the algorithm sensitive to the initial model choice .",
    "similarly , hierarchical clustering methods often rely on some arbitrary distance metric ( e.g. euclidian or pearson correlation ) to distinguish between members of different clusters , without providing a criterion for choosing the `` correct '' number of clusters or a measure of the uncertainty of a particular clustering , which would serve to assess its quality .    in this paper",
    ", we have developed a statistical methodology and associated software ( _ dgeclust _ ) for clustering digital gene expression data , which ( unlike previously published approaches @xcite ) does not require any prior knowledge on the number of clusters , but it rather estimates this parameter and its uncertainty simultaneously with the parameters ( e.g. location and shape ) of each individual cluster .",
    "this is achieved by embedding the negative binomial distribution for modelling count data in a hierarchical dirichlet process mixtures framework .",
    "this formulation implies that individual expression measurements in the same sample or in different samples may be drawn from the same distribution , i.e. they can be clustered together .",
    "this is a form of information sharing within and between samples , which is made possible by the particular hierarchical structure of the proposed model . at each level of the hierachy",
    ", the number of mixture components , i.e. the number of clusters , is assumed infinite .",
    "this representes a substantial departure from previously proposed finite mixture models and avoids the need for arbitrary prior choices regarding the number of clusters in the data .",
    "despite the infinite dimension of the mixture model , only the finite number of clusters supported by the data and the associated parameters are estimated .",
    "this is achieved by introducing a blocked gibbs sampler , which permits efficiently processing large datasets , containing more than 10k genes .",
    "unlike mcmc inference methods for hdpmm based on the popular chinese restaurant franchise metaphor@xcite , our algorithm permits updating all gene - specific parameters in each sample simultaneously and independently from other samples .",
    "this allows rapid convergence of the algorithm and permits developing parallelised implementations of the gibbs sampler , which enjoy the increased performance offered by modern multicore processors .",
    "subsequently , we show how the fitted model can be utilised in a differential expression analysis scenario . through comparison to popular alternatives on both simulated and actual experimental data ,",
    "we demonstrate the applicability of our method on both clustered and unclustered data and its superior performance in the former case .",
    "in addition , we show how our approach can be utilised for constructing library  similarity matrices , which can be used as input to hierarchical clustering routines . a slight modification of eq .",
    "[ eq : similarity ] can be used for constructing gene ",
    "similarity matrices ( see vavoulis & gough 2014 , in preparation ) .",
    "thus , our methodology can be used to perform both gene and sample  wise hierarchical clustering , in contrast to existing approaches , which are appropriate for clustering either samples@xcite or genes@xcite only .    in conclusion , we have developed a hierarchical , non  parametric bayesian clustering method for digital expression data .",
    "the novelty of the method is simultaneously addressing the problems of model selection and estimation uncertainty and it can be utilised in testing for differential expression and for sample  wise ( and gene ",
    "wise ) hierarchical grouping .",
    "we expect our work to inspire and support further theoretical research on modelling digital expression data and we believe that our software , _ dgeclust _ , will prove to be a useful addition to the existing tools for the statistical analysis of rna  seq and similar types of data .",
    "we implemented the methodology presented in this paper as the software package _ dgeclust _ , which is written in python and uses the scipy stack .",
    "_ dgeclust _ consists of three command  line tools : _ clust _ , which expects as input and clusters a matrix of unnormalised count data along with replication information , if this is available ; _ pvals _ , which takes as input the output of _ clust _ and returns a ranking of features , based on their posterior probabilities of being differential expressed ; _ simmat _ , which also takes as input the output of _ clust _ and generates a feature or library  wise similarity matrix , which can be used as input to hierarchical clustering routines for the generation of heatmaps and dendrograms .",
    "all three programs take advantage of multi  core processors in order to accelerate computations .",
    "typical calculations take from a few minutes ( as for the simulated data used in this study ) to several hours ( as for the cage data ) , depending on the size of the dataset and total number of simulation iterations .",
    "all analyses in this paper were performed using _ dgeclust _ and standard python / scipy tools , as well as _ deseq _ , _ edger _ and _ bayseq _ for comparison purposes .",
    "the most recent version of _ dgeclust _ is freely available at the following location : https://bitbucket.org/dimitrisvavoulis/dgeclust      _ dgeclust _ uses internally the same normalisation method as _ deseq _ , unless a vector of normalisation factors is provided at the command line .",
    "when comparing different software packages , we used the default normalisation method in each package or the method provided by _ deseq _ , whichever permitted the best performance for the corresponding method .      human post ",
    "mortem brain tissue from frontal , temporal , hippocampus , caudate and putamen from 5 donors was obtained from the netherlands brain bank ( nbb , amsterdam , netherlands ) .",
    "total rna was extracted and purified using the trizol tissue kit according to the manufacturer instructions ( invitrogen ) .",
    "cage libraries were prepared according to the standard illumina cage protocol@xcite .",
    "briefly , five micrograms of total rna was reverse transcribed with reverse transcriptase .",
    "samples were cap  trapped and a specific linker , containing a 3bp recognition site and the type iii restriction  modification enzyme ecop15i , was ligated to the single  strand cdna .",
    "the priming of the second strand was made with specific primers .",
    "after second strand synthesis and cleavage with ecop15i , another linker was ligated .",
    "purified cdna was then amplified with 10 to 12 pcr cycles .",
    "pcr products were purified , concentration was adjusted to 10 nm and sequenced on the hiseq 2000 using the standard protocol for 50bp single end runs .",
    "sequenced reads ( tags ) were filtered for known cage artifacts using tagdust@xcite .",
    "low quality reads and reads mapping to known rrna were also removed .",
    "the remaining reads were mapped to the human genome ( build hg19 ) using the burrows  wheeler aligner for short reads@xcite . mapped reads overlapping or located within 20 bp on the same strand were grouped into tag clusters and tag clusters with low read counts",
    "were removed .",
    "dvv and jg developed the method .",
    "mf and ph provided the cage data .",
    "dvv implemented the method .",
    "dvv and mf performed the analyses .",
    "dvv and jg wrote the paper with contributions from all authors .",
    "the final manuscript was read and approved by all authors .",
    "dvv would like to thank peter green , mark beaumont and colin campbell from the university of bristol for useful discussions on the subjects of dirichlet process mixture models and multiple hypothesis testing .",
    "+ * figure 1 *"
  ],
  "abstract_text": [
    "<S> most published studies on the statistical analysis of count data generated by next  generation sequencing technologies have paid surprisingly little attention on cluster analysis . </S>",
    "<S> we present a statistical methodology ( _ dgeclust _ ) for clustering digital expression data , which ( contrary to alternative methods ) simultaneously addresses the problem of model selection ( i.e. how many clusters are supported by the data ) and uncertainty in parameter estimation . </S>",
    "<S> we show how this methodology can be utilised in differential expression analysis and we demonstrate its applicability on a more general class of problems and higher accuracy , when compared to popular alternatives . </S>",
    "<S> _ dgeclust _ is freely available at https://bitbucket.org/dimitrisvavoulis/dgeclust    [ 1995/12/01 ]    * keywords : * hierachical dirichlet process ; mixture models ; stick  breaking priors ; blocked gibbs sampling ; model  based clustering ; rna  seq ; cage ; digital gene expression data </S>"
  ]
}