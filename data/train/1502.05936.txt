{
  "article_text": [
    "collective motion in systems of self - propelled particles is the subject of a vast literature . how collective motion emerges from the underlying local interactions between the agents",
    "is still poorly understood .",
    "the interactions are either of cognitive nature ( such as in birds , mammals @xcite ) and/or are mediated by a surrounding fluid ( such as in swimming bacteria , sperm cells , etc .",
    "there are several competing strategies to model collective dynamics .",
    "one strategy relies on individual - based models ( e.g. @xcite ) that describe how the position and velocity of each individual evolves in the course of time .",
    "another strategy relies on continuum models ( e.g. @xcite ) describing the system by locally averaged quantities such as the mean density , mean velocity , etc .",
    "an intermediate category of models consist of kinetic models@xcite which describe the individual motions in a probabilistic way .",
    "these different types of models can be connected one to each other as kinetic models can be seen as resulting from an infinite particle number limit of individual - based models , while macroscopic models follow from a hydrodynamic or diffusive rescaling of the kinetic models and subsequently passing to the limit of a large rescaling factor .",
    "we refer to ref .",
    "@xcite for an illustration of this methodology in the case of the vicsek model ( see also below ) .    in this paper",
    ", we are concerned with finding a suitable modeling framework for the three dimensional motion of spermatozoa in the seminal plasma .",
    "as there are evidence that sperm - cell motion in the most common experiments is mostly planar@xcite , we propose a multi - layer model where the motion of sperm - cells is planar and sperm - cells may interact with other sperm - cells of the same layer or of the two neighboring layers .",
    "sperm - cell concentration in raw sperm is incredibly high ( as large as @xmath0 @xmath1 ) and the use of individual - based models to reproduce real sperm - cell experiments is intractable .",
    "it is therefore necessary to derive a macroscopic model describing the collective motion of the cells within each layer and their interactions with the neighboring layers .",
    "spermatozoa can be assimilated to two - dimensional discs . indeed , as regards the occupied volume ,",
    "flagella can be neglected and spermatozoa reduced to their head .",
    "although the heads resemble flat ellipsoids , we simply model them as infinitely thin flat discs .",
    "the acting flagellum produces almost constant propulsion .",
    "thus , it is a good approximation to suppose that all sperm - cells move with the same constant speed and that only the velocity direction is subject to changes .",
    "finally , each disk possesses some inclination with respect to its plane of motion , measured by an inclination angle .",
    "therefore , the position , velocity and attitude of each disk can be described by the position of its center of mass , its velocity direction and its inclination angle .",
    "interactions between sperm - cells are mostly hydrodynamic interactions ( due to the perturbation of the fluid velocity induced by the motion of the cells ) and volume exclusion ( or steric ) interactions ( due to the impossibility that two sperm - cells overlap ) . modeling hydrodynamic and steric interactions within dense suspensions of active particles is a difficult subject .",
    "however , it has been shown in @xcite that for self - propelled elongated particles , such interactions simply result in local alignment of the particles with their neighbors .",
    "therefore , we assume that all these interactions can be lumped into a local alignment interaction with the close neighbors .    as already mentioned , we assume that particle motion is planar and takes place in parallel two - dimensional layers .",
    "each particle belongs to one layer for all times without the possibility to change its layer . for the reasons outlined above , spermatozoa interact inside these 2d layers by alignment of both their velocity and inclination with those of their close neighbors .",
    "specifically , we consider the time - continuous version of the vicsek microscopic model as proposed in ref .",
    "@xcite , where each particle tends to align with the mean direction of its neighbors up to a small brownian perturbation .",
    "the original model was proposed by vicsek et al.@xcite and several variants have been proposed in @xcite .",
    "the inclination alignment dynamics follows a similar rule with the exception that the interaction is nematic ( i.e. two inclination angles differing by a multiple of @xmath2 lead to the same disk attitude ) .",
    "the combined alignment dynamics in the velocity - inclination variables thus differs from the 3d vicsek dynamics ( specifically , in the 3d vicsek , velocity belongs to a 2d - sphere whereas here the pair ( velocity , inclination ) belongs to a 2d torus ) .",
    "the different layers also interact via the volume - exclusion constraint . indeed , due the inclination of the disks , the spermatozoa of one layer exert a friction on the spermatozoa of the nearby layers .",
    "this interaction results in increasing or decreasing the inclination of the spermatozoa in these layers .",
    "a given layer thus acts on the neighboring ones in a similar way as the wind does on plant canopies @xcite .",
    "the involved mechanical forces depend on the geometric configuration of the discs : it thus depends on their respective inclinations and also on their respective velocities .",
    "it results in alignment of velocities and repulsion of inclination angles .",
    "layers are thus coupled and this coupling depends on the so - called overlap function that quantifies the distance between layers .    we then consider a mean - field kinetic version of the model . this equation provides the time evolution of the distribution function in phase space ( position , velocity and inclination ) and takes the form of a fokker - planck equation . here",
    ", it is formally derived in the limit of an infinite number of interacting particles .",
    "although the mathematical validity of the mean - field limit has been established for the vicsek model@xcite , it is still open for the present model and our result so far is only formal .",
    "we perform a spatio - temporal hydrodynamic rescaling of the mean - field kinetic model , considering that the intra - layer interaction scales are much smaller than those of the inter - layer interactions and that the latter occur at the same scales as the macroscopic evolution of the system .",
    "there results a singularly perturbed fokker - planck equation , involving a small parameter @xmath3 measuring the ratio of the small ( microscopic ) scale to the large ( macroscopic ) one .    the macroscopic description of the system is found by letting @xmath3 to zero in the singularly perturbed mean - field kinetic model .",
    "we first need to find the equilibria associated to the fokker - planck operator .",
    "we show that these are given by products of von mises distributions in the velocity and inclination angles respectively .",
    "von mises distributions are the natural analog of gaussian distributions for probabilities on the sphere .",
    "we then need to integrate the equation against the collisional invariants . however , as noticed in ref .",
    "@xcite , only mass is a collisional invariant and we are thus lacking two more collisional invariants to obtain the dynamics on the velocity and inclination .",
    "following ref .",
    "@xcite , we have to introduce the `` generalized collisional invariants '' of this operator : these are collisional invariants valid only on functions with prescribed mean velocity and mean inclination .",
    "we then are able to derive the macroscopic model .",
    "the obtained model consists of a continuity equation for the density @xmath4 and two evolution equations for the mean velocity angle @xmath5 $ ] and mean inclination angle @xmath6 $ ] .",
    "all these quantities are indexed by @xmath7 corresponding to the @xmath8 layer .",
    "the model is written : @xmath9 where @xmath10 denotes the velocity vector .",
    "the constants will be defined further .",
    "the left - hand sides of - form the soh ( self - organized hydrodynamics ) model describing the vicsek dynamics at the macroscopic level @xcite .",
    "they respectively account for the conservation of mass and convection of the mean velocity angle .",
    "the left - hand side of describes the advection of the inclination with the same advection velocity as for the mass .",
    "finally , the right - hand sides of - describe the inter - layer interactions .",
    "the obtained model is thus an hyperbolic system ( like the soh model ) with source terms that couple the velocity and inclination dynamics .",
    "we remark that , once the velocities of all the different layers are co - linear , the source terms vanish .",
    "the model thus simplifies into a superposition of standard soh models in each layer .",
    "however , before reaching an equilibrium , the interplay between inclination and velocity crucially determines which equilibrium velocities and inclinations will be attained .    to validate the macroscopic model , numerical simulations",
    "are performed and compared with those of the particle model . with this aim , we adapt the numerical relaxation method of @xcite designed for the vicsek model .",
    "the numerical simulations show that the macroscopic model captures the velocity alignment between the different layers quite well",
    ". however , some differences in the inclination dynamics appear .",
    "indeed , some transient `` meta - stable '' configurations arise during the course of time .",
    "they are more rapidly left away by the microscopic dynamics than by the macroscopic ones , probably because of the stochastic fluctuations associated with the microscopic dynamics .",
    "this effect due to the finiteness of the particle number in the microscopic dynamics could probably be reproduced by including a stochastic term in the macroscopic model such as the one proposed in ref .",
    "@xcite .",
    "the outline of this article is as follows . in section [ sec : micro_model ] , we introduce the microscopic model . in section",
    "[ sec : meanfieldmodel ] , we present the mean - field limit and the hydrodynamic scaling . in section [ sec : macro_model ] , we provide the derivation of the macroscopic model . in section [ section :",
    "num_experiment ] , we compare the microscopic and macroscopic dynamics on several test - cases .",
    "a discussion of the results is provided in section [ sec : conclu ] .",
    "[ appendix : nematic ] provides complements on nematic alignment modeling , [ annex : coeff_macro ] gives some properties of the coefficients of the macroscopic model and [ annex : num ] describes the numerical schemes used for the simulations .",
    "spermatozoa are represented by discs of radius @xmath11 moving in different layers . in first approximation , the layers , indexed by @xmath12 , are copies of the @xmath13 plane : layer @xmath7 denotes the plane @xmath14 where @xmath15 denotes the inter - distance between the layers . with no interactions between layers , spermatozoa",
    "are supposed to be orthogonal to the layer and follow the vicsek dynamics .",
    "however , if the layer inter - distance is lower than the disc radius @xmath11 , spermatozoa of layer @xmath7 will exert a force on the spermatozoa of the neighboring layers @xmath16 and @xmath17 : they may force them to incline ( with respect to the layer plane )",
    ".        we consider @xmath18 discs in @xmath19 labeled by @xmath20 : each disc is contained into one layer and thus disc @xmath21 has a permanent altitude @xmath22 .",
    "the two - dimensional movement into the layer is described by the position of its center of mass @xmath23 and the velocity orientation of its center of mass @xmath24 : we indeed consider that all particles move at the same speed @xmath25 .",
    "the velocity of the particle is thus given by @xmath26 .",
    "we introduce the angle @xmath27 of @xmath28 with respect to a reference axis , so that @xmath29 with @xmath30 .    concerning the configuration of the disc in space",
    ", we suppose that the disc moves in one direction contained in its plane : the orientation @xmath24 belongs to the disc plane . the angle of this plane with respect to the @xmath31-axis is denoted @xmath32 $ ] .",
    "an angle @xmath33 or @xmath2 means that the disc is perpendicular to the plane while an angle @xmath34 means that the whole disc lies in the layer plane .",
    "the centers of masses follow a vicsek - like dynamics as introduced in ref .",
    "the dynamics of the positions and the velocities are given by the following equations : @xmath35 two dynamics are in competition : alignment and diffusion .",
    "each particle of a given layer @xmath36 tends to align with a direction @xmath37 with an intensity @xmath38 supposed constant .",
    "the direction @xmath37 is defined as a weighted mean direction of the neighbors particle @xmath21 in layers @xmath36 , @xmath39 within the disc of radius @xmath40 : @xmath41 where @xmath42 denotes the contribution of neighbors belonging to the same layer @xmath36 , @xmath43 denotes the contribution of neighbors belonging to layers @xmath39 and @xmath44 quantifies their relative involvement . superscripts ",
    "nb \" means neighboring layers and `` w '' means weighted .",
    "indeed , due to steric constraints within layers , directions of neighbors of layers @xmath39 are weighted according to their inclination .",
    "supposing distance @xmath7 between layers is smaller than twice the particle radius , @xmath45 , we define the overlap function @xmath46 by : @xmath47 this function quantifies the overlapping area of two discs in the @xmath48 direction .",
    "the particle direction is also submitted to a brownian motion @xmath49 with diffusion coefficient @xmath50 .",
    "we here neglect congestion forces and we also neglect alignment between discs of different layers .",
    "the disc angle dynamics follows the following torque balance equation in the over - damped regime , where @xmath51 is the moment of inertia of the disc with respect to its longitudinal axis ( parallel to @xmath52 ) and @xmath53 is the dissipation coefficient . in the over - damped regime",
    ", @xmath51 is negligible and we recover with @xmath54 . ] : @xmath55 where the alignment dynamics inside each layer is in competition with steric forces between layers .",
    "the factor @xmath56 inside the sine function takes into account that the inclination interaction between disks is a nematic one , i.e. orientations @xmath57 or @xmath58 are equivalent . in this way ,",
    "( [ eq : thetadyn ] ) preserves the fact that @xmath59 is defined modulo @xmath2 .",
    "@xmath60 is the rotational stiffness and @xmath61 is a diffusion coefficient .",
    "the inclination of each particle in layer @xmath36 tends to align with the mean inclination @xmath62 of neighboring particles _ of the same layer _ in the disc of radius @xmath63 .",
    "the mean inclination is defined through the following average , which corresponds to a nematic alignment mechanism ( see [ appendix : nematic ] ) : @xmath64 where @xmath65 is defined modulo @xmath2 .",
    "particles on neighboring layers @xmath66 exert a steric force on particles of layer @xmath36 .",
    "@xmath67 is sum of the weighted torques @xmath68 ( with respect to the longitudinal axis ) of the forces exerted by the discs : @xmath69 where @xmath48 is the unit vector in the vertical direction and @xmath70 is the weight defined in .",
    "indeed , the force @xmath71 exerted by disc @xmath72 on disc @xmath21 is supposed to be the projection of the velocity direction @xmath73 on the orthogonal plane to @xmath52 : @xmath74 where @xmath75 is a mobility coefficient .",
    "then the torque @xmath76 of the force @xmath71 with respect to the longitudinal axis of the disc is given by : @xmath77\\cdot v_k(t)\\ ] ] and using the approximation @xmath78 , we obtain : @xmath79 \\cdot v_k(t ) \\\\ & \\approx & \\mu r\\ , \\sgn(h_k - h_j ) \\ , [ p_{v_k^\\perp(t ) } v_j(t ) \\times v_k(t ) ] \\cdot   \\hat z \\\\ & \\approx & \\mu r\\ , \\sgn(h_k - h_j)\\ ,   [ v_j(t ) \\times v_k(t ) ] \\cdot   \\hat z \\end{aligned}\\ ] ]",
    "we introduce the distribution function in phase space : @xmath80 , where @xmath81 is @xmath82-periodic in @xmath83 and @xmath2-periodic in @xmath84 .",
    "note that @xmath7 is still a discrete parameter numbering the layers .",
    "the distribution function satisfies the mean - field kinetic model : @xmath85 where @xmath86 and @xmath87 are defined by : @xmath88 , \\varphi \\in [ 0,2\\pi],\\\\y \\in \\r^2 , |y - x| \\leqslant r_2\\end{subarray } } e^{2 i \\theta } f(y,\\varphi,\\theta , h , t ) \\ , dy \\ , d \\varphi \\ , d\\theta,\\end{aligned}\\ ] ] and @xmath89 , \\varphi \\in [ 0,2\\pi],\\\\ y \\in \\r^2 , |y - x| \\leqslant r_1\\end{subarray } } v(\\varphi ) f(y,\\varphi,\\theta , h , t ) \\ , dy \\ , d \\varphi \\ , d\\theta,\\\\ & j^{\\varphi,\\text{w},\\text{nb}}_{r_1,f}(x,\\theta , h , t ) = \\sum_{k,\\ , k - h = \\pm 1}j^{\\varphi,\\text{w}}_{r_1,f}(x,\\theta , k , t),\\\\ & j^{\\varphi,\\text{w}}_{r_1,f}(x,\\theta , h , t ) = \\int_{\\begin{subarray}{l }   \\theta \\in [ 0,\\pi ] , \\varphi \\in [ 0,2\\pi],\\\\ y \\in \\r^2 , |y - x| \\leqslant r_1\\end{subarray } } g(\\theta,\\theta')v(\\varphi ) f(y,\\varphi,\\theta',h , t ) \\ , dy \\ , d \\varphi \\ , d\\theta'.\\end{aligned}\\ ] ] the torque @xmath90 is given by : @xmath91 \\cdot \\hat z,\\\\ & n_{f}(x,\\theta , h , t ) = \\mu \\ , r \\ , \\sum_{k,\\ , k - h = \\pm 1 } \\sgn(k - h ) \\ , j^{\\varphi,\\text{w}}_{r_3,f}(x,\\theta , k , t),\\end{aligned}\\ ] ] and depends on neighboring layers @xmath16 and @xmath17 .",
    "we then perform a hydrodynamic rescaling to look at the large time and space scale dynamics .",
    "the hydrodynamic rescaling consists in introducing macroscopic variables in space and time : @xmath92 , @xmath93 , with @xmath94 . after dropping the tildes",
    ", the kinetic distribution @xmath95 satisfies the following equation : @xmath96 where the rescaled @xmath97 , @xmath98 , @xmath99 are defined by : @xmath100 \\cdot \\hat z , \\label{eq : fmoment_eps_000 } \\\\ & n^\\varepsilon_{f}(x,\\theta , h , t ) = \\frac{1}{\\varepsilon^2 } \\ , \\mu \\ , r \\ ,    \\sum_{k,\\ , k - h = \\pm 1 } \\sgn(k - h ) \\ , j^{\\varphi,\\text{w}}_{\\varepsilon r_3,f}(x,\\theta , k , t ) .",
    "\\label{eq : fmoment_eps}\\end{aligned}\\ ] ]    we can easily show the following expansion : @xmath101 , \\ , \\varphi \\in [ 0,2\\pi ] } v(\\varphi ) f(x,\\varphi,\\theta , h , t ) \\ ,",
    "d\\varphi \\ , d\\theta,\\\\ & j^{\\varphi,\\text{w}}_{f}(x,\\theta , k , t ) = \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } g(\\theta,\\theta')v(\\varphi ) f(x,\\varphi,\\theta ' , k , t ) \\ , d\\varphi \\ , d\\theta',\\label{eq : flux - nb}\\\\ & j^\\theta_f(x , h , t ) = \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } e^{2 i \\theta }   f(x,\\varphi,\\theta , h , t ) \\ , d\\varphi \\ , d\\theta,\\end{aligned}\\ ] ] where the last quantities are the localized mean inclination angle and momentum .",
    "therefore , system ( [ eq : kin_eps]-[eq : fmoment_eps ] ) becomes , dropping @xmath102 terms : @xmath103 where @xmath104 \\cdot \\hat z , \\label{eq : fmoment_eps_000_res } \\\\ & n_f(x,\\theta , h , t ) =   \\frac{1}{\\varepsilon } \\",
    ", \\mu   r \\ , \\pi r_3 ^ 2 \\ ,   \\sum_{k,\\ , k - h = \\pm 1 } \\sgn(k - h ) \\ , j^{\\varphi,\\text{w}}_f(x,\\theta , k ,",
    "t).\\nonumber \\label{eq : fmoment_eps_res}\\end{aligned}\\ ] ]    we suppose also that the interaction between the layers happens on large time scale .",
    "therefore , we write : @xmath105 . inserting this ansatz",
    ", we obtain : @xmath106 moreover , we suppose that @xmath107 with @xmath108 .",
    "we thus have the following expansion and @xmath109 , we have : @xmath110 ] : @xmath111 and @xmath112 denotes the projection of @xmath113 onto the orthogonal plane to @xmath114 . taking the cross product of the previous expansion with @xmath115 ,",
    "we easily obtain : @xmath116 therefore , regrouping the @xmath117 terms together , equation becomes : @xmath118 with @xmath119 system - is the starting point for the derivation of the macroscopic model .",
    "we want to take the limit @xmath120 in system - . therefore , assuming that the distribution function @xmath121 converge to a limit denoted by @xmath122 as @xmath120 , this limit satisfies the equilibrium condition @xmath123 where @xmath124    we define the von mises - fisher ( vmf ) distribution with periodicity @xmath125 , @xmath126 , concentration parameter @xmath127 and direction @xmath128 by : @xmath129 with @xmath130 we introduce @xmath131    we show the following :    we have @xmath132 [ prop : vmf ]    we have @xmath133 in view of ( [ eq : def_vmf ] ) , eq .",
    "( [ eq : eq1 ] ) can be written : @xmath134 and from ( [ eq : def_vmf_2 ] ) , we deduce ( [ eq : eq3 ] ) .",
    "we define @xmath135 , \\ ,",
    "\\varphi \\in [ 0,2\\pi ] } f(x,\\varphi,\\theta , h , t ) \\ , d\\varphi \\ , d\\theta.\\ ] ] we have the :    for any distribution @xmath136 , we have @xmath137 } = \\rho,\\quad j^\\varphi_{[\\rho   { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ] }   =   c_1\\big(1 ,   \\frac{\\nu}{d } \\big ) \\ , \\rho \\ , v(\\bar \\varphi),\\quad j^\\theta_{[\\rho   { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ] } =    c_1\\big(2 ,   \\frac{k}{\\delta } \\big ) \\ , \\rho \\ , e^{2 i \\bar \\theta},\\label{eq : flux_vmf}\\ ] ] with @xmath138 in particular , we have : @xmath139 } = \\bar \\theta \\mbox { modulo } \\pi , \\quad   \\bar \\varphi_{[\\rho   { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ] } = \\bar \\varphi \\mbox { modulo } 2 \\pi.\\ ] ] [ prop_moments ]    this proposition shows that for the distribution @xmath136 , @xmath4 is its local density and @xmath140 , @xmath141 are its mean direction of motion and mean inclination respectively .    by easy computations",
    ", we have @xmath142 } = \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } v(\\varphi ) \\ , \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ( \\varphi , \\theta ) \\ , \\ , d\\varphi \\ , d\\theta \\nonumber\\\\ & & \\hspace{1 cm } =   \\rho \\big ( \\int_{\\theta \\in [ 0,\\pi ] } m_{2,\\frac{k}{\\delta } , \\bar \\theta } ( \\theta ) \\ , d\\theta   \\big ) \\ ,    \\big ( \\int_{\\varphi \\in [ 0,2\\pi ] } v(\\varphi ) \\ , m_{1,\\frac{\\nu}{d } , \\bar \\varphi } ( \\varphi ) \\ , d\\varphi   \\big ) \\nonumber\\\\ & & \\hspace{1 cm } = \\rho   \\ ,   v(\\bar \\varphi ) \\ , \\int_{\\varphi \\in [ 0,2\\pi ] } m_{1,\\frac{\\nu}{d } , \\bar \\varphi } ( \\varphi ) \\ , \\cos \\varphi \\ , d\\varphi \\nonumber\\\\ & & \\hspace{1 cm } = c_1\\big(1 ,   \\frac{\\nu}{d } \\big ) \\ , \\rho \\ , v(\\bar \\varphi ) , \\end{aligned}\\ ] ] we note that @xmath143 is such that @xmath144 .",
    "therefore , @xmath145 } ) = \\frac { j^\\varphi_{[\\rho   { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ] } } { |j^\\varphi_{[\\rho   { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ] } | } = v(\\bar \\varphi),\\ ] ] showing that @xmath146 } = \\bar \\varphi$ ] modulo @xmath82 .",
    "similarly , we have @xmath147 } =    c_1\\big(2 ,   \\frac{k}{\\delta } \\big ) \\ , \\rho \\ , e^{2",
    "i \\bar \\theta } , \\end{aligned}\\ ] ] and so @xmath148 } } =   e^{2",
    "i \\bar \\theta}$ ] , showing that @xmath149 } = \\bar \\theta$ ] modulo @xmath150 .",
    "the set @xmath151 of equilibria , i.e. @xmath152 is given by : @xmath153 , \\",
    ", \\bar \\theta \\in [ 0,\\pi ] , \\ , \\rho \\in \\r^+ \\right\\}.\\ ] ]    from ( [ eq : eq3 ] ) , we deduce that @xmath154 , \\ , \\varphi \\in [ 0,2\\pi ] } q(f ) \\",
    ", \\frac{f}{{\\mathcal m}_{\\bar \\varphi_f , \\bar \\theta_f } } \\ , d\\varphi \\ , d\\theta \\nonumber\\\\ & & \\hspace{-0.5 cm } = - \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] }   \\big ( d \\ , \\big| \\partial_\\theta \\big (   \\frac{f}{{\\mathcal m}_{\\bar \\varphi_f , \\bar \\theta_f } } \\big ) \\big|^2    + d \\ , \\big| \\partial_\\varphi \\big (   \\frac{f}{{\\mathcal m}_{\\bar \\varphi_f , \\bar \\theta_f } } \\big ) \\big|^2 \\big)\\ , { \\mathcal m}_{\\bar \\varphi_f , \\bar \\theta_f } \\ , d\\varphi \\ ,",
    "d\\theta .",
    "\\label{eq : eq : equi3}\\end{aligned}\\ ] ] now , let @xmath81 be an equilibrium , i.e. @xmath155 .",
    "then , @xmath156 , \\ , \\varphi \\in [ 0,2\\pi ] }   \\big ( d \\ , \\big| \\partial_\\theta \\big (   \\frac{f}{{\\mathcal m}_{\\bar \\varphi_f , \\bar \\theta_f } } \\big ) \\big|^2",
    "+ d \\ , \\big| \\partial_\\varphi \\big (   \\frac{f}{{\\mathcal m}_{\\bar \\varphi_f , \\bar \\theta_f } } \\big ) \\big|^2 \\big)\\ , { \\mathcal m}_{\\bar \\varphi_f , \\bar \\theta_f } \\ ,",
    "d\\varphi \\ ,",
    "d\\theta = 0 .",
    "\\label{eq : eq : equi4}\\end{aligned}\\ ] ] this shows that there exists @xmath157 , such that @xmath158 , which implies that there exist @xmath157 , @xmath159 ( modulo @xmath82 ) and @xmath160 ( modulo @xmath2 ) such that @xmath161 .",
    "reciprocally , we show that @xmath161 are such that @xmath155 . indeed , this follows from ( [ eq : eq : equi3 ] ) and ( [ eq : eq : equi4 ] ) if we show that for @xmath161 , @xmath162 and @xmath163 . but",
    "this follows in turn from proposition [ prop_moments ] .    according to this proposition",
    ", there exists @xmath164 and @xmath165 $ ] , @xmath166 $ ] such that : @xmath167 now , the goal is to find equations for @xmath168 as functions of @xmath169 .",
    "( [ eq : f_eps_2 ] ) can be written @xmath170 in the limit @xmath171 , the right - hand side of ( [ eq : kineps ] ) is singular .",
    "the goal of a collision invariant is to cancel this singular term through integration in @xmath172 against a suitable test functions . for this purpose ,",
    "we define :    a collision invariant ( ci ) is a function @xmath173 such that for all function @xmath174 , we have @xmath175 , \\ , \\varphi \\in [ 0,2\\pi ] }   q(f ) \\ , { \\mathcal i } \\ , d\\varphi \\ , d\\theta = 0.\\ ] ]",
    "we denote by @xmath176 the space of ci .",
    "it is a vector space .    here",
    ", clearly , @xmath176 contains the constant functions , since , as seen from ( [ eq : eq3 ] ) , we have @xmath177 .",
    "however , no other ci appears obviously from ( [ eq : eq3 ] ) .",
    "the use of the constant functions as ci already gives the mass conservation equation . indeed , integrating ( [ eq : kineps ] ) with respect to @xmath172",
    ", we get @xmath178 in this equation , the @xmath179 singularity has disappeared and the limit @xmath171 of eq .",
    "( [ eq : masscons_eps ] ) leads to an equation for @xmath122 .",
    "however , as seen from ( [ eq : local_eq ] ) , @xmath122 depends on three scalar quantities : @xmath4 , @xmath141 and @xmath140 but ( [ eq : masscons_eps ] ) is only one single scalar equation .",
    "therefore , it is not sufficient to determine the dynamics of @xmath122 .",
    "for this reason , we look for a weaker invariant concept , that of generalized collision invariant , as defined in the next section .      for a given pair @xmath180",
    ", we define the operator @xmath181 by @xmath182 we note that @xmath183 is a linear operator and that @xmath184 we define the generalized collisional invariants by the following    let @xmath185 be given .",
    "a generalized collision invariant ( gci ) associated with @xmath186 is a function @xmath173 such that @xmath187 , \\ , \\varphi \\in [ 0,2\\pi ] }    { \\mathcal q}(\\bar \\varphi , \\bar \\theta ; f ) \\ , { \\mathcal i } \\ ,",
    "d\\varphi \\ , d\\theta = 0 , \\nonumber \\\\ & & \\hspace{2.5 cm } \\ ,",
    "\\forall f   \\mbox { such that }   \\bar \\theta_f = \\bar \\theta \\mbox { mod . } \\ , \\frac{\\pi}{2 } \\mbox { and } \\bar \\varphi_f = \\bar \\varphi \\mbox { mod . } \\ , \\pi .",
    "\\label{eq : defgci}\\end{aligned}\\ ] ] we denote by @xmath188 the space of gci associated with @xmath186 .",
    "it is a vector space .    referring to ( [ eq : def_vmf ] ) , for the simplicity of notation",
    ", we define @xmath189 we introduce the two following functions : + ( i ) the function @xmath190 is a @xmath82-periodic solution of the problem @xmath191 } i_1(\\varphi ) \\ , d \\varphi = 0   \\label{eq : diff_i1}\\end{aligned}\\ ] ] ( ii ) the function @xmath192 is a @xmath2-periodic solution of the problem @xmath193 } i_2(\\theta ) \\ , d \\theta = 0 .",
    "\\label{eq : diff_i2}\\end{aligned}\\ ] ] now we have    the solutions @xmath194 and @xmath195 are unique",
    ". moreover , the space @xmath188 of gci associated to @xmath186 is three dimensional and spanned by @xmath196 [ theorem : exist_gci ]    introducing the @xmath197-adjoint @xmath198 of @xmath199 , we can write : @xmath175 , \\",
    ", \\varphi \\in [ 0,2\\pi ] }    { \\mathcal q}(\\bar \\varphi , \\bar \\theta ; f ) \\ , { \\mathcal i } \\ , d\\varphi",
    "\\ , d\\theta   =   \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] }   f \\ ,",
    "{ \\mathcal q}^*(\\bar \\varphi , \\bar \\theta ;   { \\mathcal i } ) \\,d\\varphi \\ , d\\theta.\\ ] ] the constraints @xmath162 modulo @xmath200 and @xmath163 modulo @xmath2 can be equivalently written : @xmath201 , \\",
    ", \\varphi \\in [ 0,2\\pi ] }   f \\ , \\sin ( 2(\\theta - \\bar \\theta ) ) \\ , d \\theta \\ , d \\varphi = 0 , \\quad \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] }   f \\ , \\sin ( \\varphi - \\bar \\varphi ) \\ , d \\theta \\ , d \\varphi = 0 . \\end{aligned}\\ ] ] since these are linear constraints , by a classical duality argument , ( [ eq : defgci ] ) is equivalent to saying that there exist @xmath202 such that @xmath203 , \\ , \\varphi \\in [ 0,2\\pi ] }   f \\ ,   { \\mathcal q}^*(\\bar \\varphi , \\bar \\theta ;   { \\mathcal i } ) \\,d\\varphi \\ , d\\theta   \\\\ & & \\hspace{1 cm } = \\int_{\\theta \\in [ 0,\\pi ] , \\ ,",
    "\\varphi \\in [ 0,2\\pi ] }   f \\ , \\big(\\beta^\\theta \\ , \\sin ( 2(\\theta - \\bar \\theta ) )   + \\beta^\\varphi \\ , \\sin ( \\varphi - \\bar \\varphi ) \\big ) \\",
    ", d \\theta \\ , d \\varphi .",
    "\\end{aligned}\\ ] ] for all functions @xmath81 without constraints .",
    "this implies that @xmath204 satisfies : @xmath205 or , using the explicit expression of @xmath206 : @xmath207 multiplying by a test function @xmath208 , integrating with respect to @xmath172 , using green s formula and the @xmath82 periodicity in @xmath83 ( resp .",
    "the @xmath2 periodicity in @xmath84 ) , we obtain the following variational formulation : @xmath175 , \\ , \\varphi \\in [ 0,2\\pi ] } { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } \\ , \\big ( \\delta \\ , \\partial_\\theta { \\mathcal i } \\ , \\partial_\\theta { \\mathcal j } + d \\ , \\partial_\\varphi { \\mathcal i } \\ , \\partial_\\varphi { \\mathcal j } \\big ) \\ , d\\varphi \\ , d\\theta = \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } \\psi \\ , { \\mathcal j } \\ , d\\varphi \\ , d\\theta ,",
    "\\label{eq : varfor}\\ ] ] with @xmath209 .",
    "we now introduce the functional spaces @xmath210 \\times [ 0,\\pi])$ ] , @xmath211 \\times [ 0,\\pi])$ ] endowed with their classical hilbert norms and inner products , together with : @xmath212 \\times [ 0,\\pi ] )   = \\ {   { \\mathcal j } \\in h^1([0,2\\pi ] \\times [ 0,\\pi ] ) \\ , \\ , | \\ , \\ ,   { \\mathcal j}(0,\\theta ) = { \\mathcal j}(2 \\pi,\\theta ) , \\\\ & & \\hspace{3 cm }   \\quad { \\mathcal j}(\\varphi,0 ) = { \\mathcal j}(\\varphi , \\pi ) , \\ , \\ , a.e .",
    "\\ , \\ , ( \\varphi , \\theta ) \\in   [ 0,2\\pi ] \\times [ 0,\\pi ] \\ } , \\end{aligned}\\ ] ] and @xmath213 \\times [ 0,\\pi ] ) = \\ {   h_{\\mbox{\\scriptsize per}}^1([0,2\\pi ] \\times [ 0,\\pi ] )   \\ , \\ , | \\ , \\ , \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] }   { \\mathcal j } \\ , d\\varphi \\ , d\\theta = 0 \\}.\\ ] ] thanks to a poincar - wirtinger inequality ( which can be easily proved using the rellich - kondrachov compactness theorem ) , the semi - norm @xmath214 , \\ , \\varphi \\in [ 0,2\\pi ] } { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } \\ , \\big ( \\delta \\ , \\big|\\partial_\\theta { \\mathcal j } \\big|^2 + d \\ , \\big| \\partial_\\varphi { \\mathcal j}\\big|^2 \\big ) \\ , d\\varphi \\ , d\\theta,\\ ] ] is a norm on @xmath215 \\times [ 0,\\pi])$ ] equivalent to the classical @xmath216 norm .",
    "therefore , thanks to lax - milgram theorem in @xmath215 \\times [ 0,\\pi])$ ] , there exists a unique @xmath217 \\times [ 0,\\pi])$ ] such that ( [ eq : varfor ] ) holds for any @xmath218 \\times [ 0,\\pi])$ ] .",
    "now , since @xmath219 is the sum of two terms , one being odd in @xmath220 , the other one being odd in @xmath221 , we have @xmath175 , \\ , \\varphi \\in [ 0,2\\pi ] } \\psi \\ , d\\varphi \\ , d\\theta = 0.\\ ] ] therefore , @xmath222 satisfies ( [ eq : varfor ] ) for all @xmath223 \\times [ 0,\\pi ] ) $ ] ( and not only for @xmath218 \\times [ 0,\\pi])$ ] ) .",
    "furthermore , all solutions in @xmath224 \\times [ 0,\\pi ] ) $ ] of ( [ eq : varfor ] ) equal the unique solution in @xmath215 \\times [ 0,\\pi])$ ] up to a constant . indeed ,",
    "if @xmath204 solves ( [ eq : rel_gci ] ) with @xmath225 in @xmath224 \\times [ 0,\\pi])$ ] , we have @xmath226 and therefore , @xmath204 is a constant .",
    "now , we solve ( [ eq : rel_gci ] ) for @xmath227 or @xmath228 and for this purpose , we use the functions @xmath194 and @xmath195 defined at ( [ eq : diff_i1 ] ) and ( [ eq : diff_i2 ] ) .",
    "we note that @xmath229 is the unique solution in @xmath215)$ ] of the variational formulation @xmath230 } m_{1,\\bar \\varphi } \\",
    ",   \\partial_\\varphi i_{1,\\bar \\varphi }   \\ , \\partial_\\varphi j_1 \\ , d \\varphi \\nonumber \\\\ & & \\hspace{1.5 cm } = - \\int_{\\varphi \\in [ 0,2\\pi ] } \\sin(\\varphi - \\bar \\varphi ) \\ , m_{1,\\bar \\varphi } \\ ,   j_1 \\ , d \\varphi , \\quad \\forall j_1 \\in \\dot h^1([0,2\\pi ] ) .",
    "\\label{eq : vari1}\\end{aligned}\\ ] ] and that @xmath231 is the unique solution in @xmath232)$ ] of the variational formulation @xmath233 } m_{2,\\bar \\theta } \\ , \\partial_\\theta i_{2,\\bar \\theta } \\",
    ", \\partial_\\theta j_2 \\ , d \\theta \\nonumber \\\\ & & \\hspace{1.5 cm }   = - \\int_{\\theta \\in [ 0,\\pi ] } \\sin(2(\\theta - \\bar \\theta ) ) \\ , m_{2,\\bar \\theta } \\ ,   j_2 \\ , d \\theta , \\quad \\forall j_2 \\in \\dot h^1([0,\\pi ] ) .",
    "\\label{eq : vari2}\\end{aligned}\\ ] ] the existence and uniqueness of solutions to ( [ eq : vari1 ] ) and ( [ eq : vari2 ] ) follow from the same kind of arguments as for problem ( [ eq : varfor ] ) .",
    "now , it is an easy matter to check that both @xmath234 and @xmath235 are solutions of ( [ eq : varfor ] ) with @xmath227 and @xmath228 respectively .",
    "moreover , they both are in @xmath215 \\times [ 0,\\pi])$ ] and by the uniqueness of the solution of ( [ eq : varfor ] ) , they are the unique solution of this problem with these choices of @xmath236 . we deduce that the space @xmath188 is three - dimensional , spanned by @xmath237 , @xmath238 and @xmath239 , which ends the proof .",
    "functions @xmath190 and @xmath192 equal : @xmath240 thanks to ( [ eq : qqq ] ) and ( [ eq : defgci ] ) , they satisfy : @xmath203 , \\ , \\varphi \\in [ 0,2\\pi ] }   q(f^\\varepsilon ) \\ ,   i_1(\\varphi-\\bar \\varphi_{f^\\varepsilon } ) \\ , d \\varphi \\ , d \\theta = 0 ,   \\label{eq : cancelgci_i1 } \\\\ & & \\hspace{-1 cm }   \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] }   q(f^\\varepsilon ) \\ , i_2(\\theta-\\bar \\theta_{f^\\varepsilon } ) \\ , d \\varphi \\ , d \\theta = 0 .",
    "\\label{eq : cancelgci_i2}\\end{aligned}\\ ] ]      we obtain the macroscopic dynamics by integrating system against the gci .",
    "the resulting equations are presented in the following proposition :    the density @xmath241 , the angle of the mean direction @xmath242 and the mean inclination angle @xmath243 satisfy the following system : @xmath244 } g(\\bar\\theta+\\theta,\\bar\\theta_k+\\theta ' ) m_2(\\theta)m_2(\\theta')\\ , d\\theta d\\theta ' , \\label{eq : g_mean1_final}\\\\ & \\langle gm_2m_2\\partial_\\theta i_2\\rangle(\\bar\\theta,\\bar\\theta_k ) =   2\\kappa_2 \\int_{\\theta,\\theta ' \\in [ 0,\\pi ] } g(\\bar\\theta+\\theta,\\bar\\theta_k+\\theta ' ) m_2(\\theta)\\partial_\\theta i_2(\\theta)m_2(\\theta')\\ , d\\theta d\\theta ' , \\label{eq : g_mean2_final}\\end{aligned}\\ ] ] where @xmath245 denotes @xmath246 and @xmath247 ( with @xmath143 defined at ( [ eq : def_c1 ] ) ) and @xmath248 , @xmath249 , @xmath250 given by : @xmath251 } \\sin \\varphi \\cos \\varphi m_1 i_1\\ , d\\varphi}{\\int_{\\varphi \\in [ 0,2\\pi ] } \\sin \\varphi m_1 i_1\\ , d\\varphi},\\\\ & c_3 = -\\kappa_1 ^ 2 \\int_{\\varphi \\in [ 0,2\\pi ] } \\sin \\varphi m_1 i_1\\ , d\\varphi,\\quad c_4 =   -4\\kappa_2",
    "^ 2\\int_{\\theta \\in [ 0,\\pi ] } \\sin 2 \\theta m_2 i_2\\ , d\\theta,\\quad   \\end{aligned}\\ ] ] and @xmath252 , @xmath253 ( see ( [ eq : defm1m2 ] ) ) .",
    "[ prop : macro_system ]    before giving the proof , let us make some comments .",
    "the left - hand side of equations - is exactly the soh ( self - organized hydrodynamics ) model describing the vicsek dynamics at the macroscopic level ( see ref .",
    "the right - hand side of equation describes the alignment of @xmath254 toward a linear combination of the velocities of the neighboring layers .",
    "the weights of this linear combination depends on the inclination of the different layers .",
    "equation describes the advection of the inclination with the same advection velocity as for the mass .",
    "the right - hand side of eq .",
    "finally also evaluates weighted alignment terms between layers .",
    "the weights are given by - .",
    "they are integral operators , quadratic with respect to the macroscopic equilibria in inclination variable .",
    "they are scaled in such a way to be bounded quantities ( see [ annex : coeff_macro ] ) .",
    "weights involve the second generalized invariant .",
    "finally , this macroscopic model depends on several coefficients , @xmath255 , @xmath248 , @xmath249 , @xmath250 , that are all positive and bounded by @xmath256 ( see [ annex : coeff_macro ] ) .",
    "they are all averages of the von mises equilibria ( either in velocity or inclination variables ) against the collisional invariants .",
    "we apply the moment method : first integrate the equation against the collisional invariants and then taking the limit @xmath120",
    ".    * mass conservation equation .",
    "* here it is just a matter of passing to the limit @xmath171 in ( [ eq : masscons_eps ] ) , using ( [ eq : local_eq ] ) , ( [ eq : flux_vmf ] ) , ( [ eq : def_c1 ] )",
    ". we immediately get ( [ eq : mass_final ] ) .    * velocity and inclination equation . * we multiply by @xmath257 or @xmath258 , integrate with respect to @xmath172 and use ( [ eq : cancelgci_i1 ] ) or ( [ eq : cancelgci_i2 ] ) .",
    "we get @xmath259 , \\ ,",
    "\\varphi \\in [ 0,2\\pi ] } \\big ( \\partial_t f^\\varepsilon + c v(\\varphi ) \\cdot \\nabla_x f^\\varepsilon + \\partial_\\theta(t_{f^\\varepsilon } f^\\varepsilon ) + \\partial_\\varphi ( s_{f^\\varepsilon } f^\\varepsilon)\\big ) \\ , i_k^\\varepsilon \\ , d\\varphi \\ , d \\theta \\\\ & & \\hspace{10 cm }   = 0 , \\quad k=1,2 , \\end{aligned}\\ ] ] in the limit @xmath120 , we have @xmath260 and consequently @xmath261 , where @xmath262 stands for the same quantities with @xmath263 replaced by @xmath264 .",
    "therefore , we get @xmath265 , \\ , \\varphi \\in [ 0,2\\pi ] } \\big ( \\partial_t ( \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) + c v(\\varphi ) \\cdot \\nabla_x ( \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) + \\partial_\\theta(t_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } } \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) + \\nonumber \\\\ & & \\hspace{3.5 cm }   \\partial_\\varphi(s_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } } \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) \\big ) \\ , i_k \\ , d\\varphi \\ , d \\theta   = 0 , \\quad k=1,2 ,   \\label{eq : intoverik}\\end{aligned}\\ ] ] tedious but easy algebra leads to : @xmath266 with @xmath267 even with respect to @xmath221 if @xmath268 is even and even with respect to @xmath269 if @xmath72 is even , odd otherwise .",
    "this gives : @xmath270 since @xmath271 is even in @xmath269 and @xmath221 while @xmath194 is odd in @xmath221 and @xmath195 is odd in @xmath269 , we get : @xmath203 , \\ , \\varphi \\in [ 0,2\\pi ] } \\big ( \\partial_t ( \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) + c v(\\varphi ) \\cdot \\nabla_x ( \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) \\big ) \\ , i_1 \\ , d\\varphi \\ , d \\theta   \\nonumber\\\\ & & \\hspace{-0.5 cm }   = \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } \\ , { \\mathcal t}_{12 } \\ , i_1 \\ , d\\varphi \\ , d \\theta \\nonumber \\\\ & & \\hspace{-0.5 cm }   = \\rho \\big\\ { \\frac{\\nu}{d } \\big(\\int_{\\varphi \\in [ 0,2\\pi ] } \\sin \\varphi m_1 i_1\\ , d\\varphi\\big ) \\partial_t \\bar \\varphi \\nonumber \\\\ & & \\hspace{2 cm }   + \\frac{c \\nu}{d } \\big(\\int_{\\varphi \\in [ 0,2\\pi ] } \\sin \\varphi \\cos",
    "\\varphi m_1 i_1\\ , d\\varphi\\big ) v(\\bar \\varphi ) \\cdot \\nabla_x \\bar \\varphi \\big\\ } \\nonumber\\\\ & & \\hspace{2 cm }   +",
    "c \\big(\\int_{\\varphi \\in [ 0,2\\pi ] } \\sin \\varphi m_1 i_1\\ , d\\varphi\\big ) v(\\bar \\varphi)^\\bot \\cdot \\nabla_x \\rho .   \\label{eq : averageoni1}\\end{aligned}\\ ] ] while @xmath203 , \\ , \\varphi \\in [ 0,2\\pi ] } \\big ( \\partial_t ( \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) + c v(\\varphi ) \\cdot \\nabla_x ( \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) \\big ) \\ , i_2 \\ , d\\varphi \\ , d \\theta \\nonumber \\\\ & & \\hspace{-0.5 cm }   = \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } \\ , { \\mathcal t}_{21 } \\ , i_2 \\ , d\\varphi \\ , d \\theta \\nonumber \\\\ & & \\hspace{-0.5 cm }   = \\rho \\big\\ { \\frac{2 k } { \\delta } \\big(\\int_{\\theta \\in [ 0,\\pi ] } \\sin 2 \\theta m_2 i_2\\ , d\\theta \\big ) \\partial_t \\bar \\theta \\nonumber \\\\ & & \\hspace{0 cm }   + \\frac{2",
    "c k } { \\delta } \\big(\\int_{\\theta \\in [ 0,\\pi ] } \\sin 2 \\theta m_2 i_2\\ , d\\theta \\big ) \\big(\\int_{\\varphi \\in [ 0,2\\pi ] } \\cos \\varphi m_1\\ , d\\varphi \\big ) v(\\bar \\varphi ) \\cdot \\nabla_x \\bar \\theta \\big\\}.   \\label{eq : averageoni2 }   \\end{aligned}\\ ] ] we now treat the last two terms of ( [ eq : intoverik ] ) . using integration by parts we have : @xmath203 , \\",
    ", \\varphi \\in [ 0,2\\pi ] } \\partial_\\theta(t_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } } \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) \\ , i_k \\ , d\\varphi \\ , d \\theta \\\\ & & \\hspace{2 cm }   = - \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } t_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } } \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } \\ , \\partial_\\theta i_k \\ , d\\varphi \\ , d \\theta , \\\\ & & \\hspace{-1 cm }   \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } \\partial_\\varphi(s_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } } \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) \\ ,",
    "i_k \\ , d\\varphi \\ , d \\theta \\\\ & & \\hspace{2 cm }   = - \\int_{\\theta \\in [ 0,\\pi ] , \\ , \\varphi \\in [ 0,2\\pi ] } s_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } } \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } \\ , \\partial_\\varphi i_k \\ , d\\varphi \\ , d \\theta .\\end{aligned}\\ ] ] since @xmath194 does not depend on @xmath84 , the contribution of the third term of ( [ eq : intoverik ] ) for @xmath272 vanishes .",
    "let us write as follows : @xmath273 from and and using ( [ eq : flux_vmf ] ) , we get : @xmath274 } g(\\theta,\\bar\\theta+\\theta ' ) m_2 \\ , d\\theta'\\right)\\ ,",
    "c_1 \\rho v(\\bar\\varphi ) , \\label{eq : mean - weighted}\\ ] ] and then : @xmath275 } g(\\theta,\\bar\\theta_k+\\theta ' ) m_2 \\ , d\\theta'\\right)\\ ,",
    "\\frac{c_1 \\rho_k v(\\bar\\varphi_k)}{c_1\\rho}.\\ ] ] therefore , after integration by parts , and using that @xmath276 is even in @xmath83 , we have : @xmath277 , \\ , \\varphi \\in [ 0,2\\pi ] } \\partial_\\varphi(s_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } } \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) \\ ,",
    "i_1 \\ , d\\varphi \\ , d \\theta \\nonumber   \\\\ & = -\\nu\\beta ' \\rho\\big(\\int_{\\varphi \\in [ 0,2\\pi ] } \\cos \\varphi m_1\\partial_\\varphi i_1\\ , d\\varphi \\big ) v(\\bar \\varphi)^\\perp\\cdot   \\sum_{k,\\ , k - h = \\pm 1 }   \\langle gm_2m_2\\rangle(\\bar\\theta,\\bar\\theta_k)\\ ,   \\frac{c_1\\rho_k v(\\bar\\varphi_k)}{c_1\\rho}\\nonumber\\\\ & = \\frac { \\nu\\beta ' } { \\kappa_1 }   v(\\bar \\varphi)^\\perp\\cdot   \\sum_{k,\\ , k - h = \\pm 1 }   \\langle gm_2m_2\\rangle(\\bar\\theta,\\bar\\theta_k)\\ , c_1\\rho_k   v(\\bar\\varphi_k ) .",
    "\\label{eq : soni1}\\end{aligned}\\ ] ] with @xmath278 defined in and where we use the relation : @xmath279 } \\cos \\varphi m_1\\partial_\\varphi i_1\\ , d\\varphi & = -\\int_{\\varphi \\in [ 0,2\\pi ] } \\sin \\varphi\\ , \\partial_\\varphi(m_1\\partial_\\varphi i_1)\\ , d\\varphi\\\\ & = - \\int_{\\varphi \\in [ 0,2\\pi ] } \\sin^2 \\varphi\\ , m_1\\ , d\\varphi = - \\frac{c_1}{\\kappa_1},\\end{aligned}\\ ] ] obtained by integration by part and using . using ( [ eq : averageoni1 ] ) and and dividing by @xmath280 } \\sin \\varphi m_1 i_1\\ , d\\varphi\\big)$ ] we get ( [ eq : phi_final ] )",
    ".    since @xmath195 does not depend on @xmath83 , the contribution of the last term to ( [ eq : intoverik ] ) for @xmath281 vanishes . from equations ( [ eq :",
    "fmoment_eps_000_res])-([eq : n_eps ] ) and ( [ eq : flux_vmf ] ) , we obtain the expression : @xmath282 \\cdot \\hat z,\\\\ & n_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta}}(x,\\theta , h , t ) = \\mu ' \\ , \\sum_{k,\\ , k - h = \\pm 1 } \\sgn(k - h)\\ , j^{\\varphi,\\text{w}}_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta}}(x,\\theta , k , t).\\end{aligned}\\ ] ] therefore , using and since @xmath283 and @xmath284 is even in @xmath83 , we get after integration by parts : @xmath277 , \\ , \\varphi \\in [ 0,2\\pi ] } \\partial_\\theta(t_{\\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } } \\rho { \\mathcal m}_{\\bar \\varphi , \\bar \\theta } ) \\ , i_2 \\ , d\\varphi \\ , d \\theta \\nonumber   \\\\ & = \\rho\\big(\\int_{\\varphi \\in [ 0,2\\pi ] } \\cos \\varphi m_1\\ , d\\varphi \\big )   v(\\bar \\varphi)^\\perp\\cdot   \\left[\\mu ' \\ , \\sum_{k,\\ , k - h = \\pm 1 }    \\langle gm_2m_2\\partial_\\theta i_2\\rangle(\\bar\\theta,\\bar\\theta_k)\\ , c_1 \\rho_k v(\\bar\\varphi_k)\\right ] .",
    "\\label{eq : torqueoni2}\\end{aligned}\\ ] ] with @xmath285 defined in . using ( [ eq : averageoni2 ] ) and ( [ eq : torqueoni2 ] ) into ( [ eq : intoverik ] ) for @xmath281 and dividing by @xmath286 } \\sin 2 \\theta m_2 i_2\\ , d\\theta \\big)$ ] , we get ( [ eq : theta_final ] ) .",
    "one simple macroscopic equilibrium consists in layers with the same vector velocity fields ( or opposite vector field ) . in that case , inclinations have no impact on the dynamics and are simply transported by the velocity flow . in particular , we have :    for any @xmath5 $ ] , @xmath287 and @xmath288^\\z$ ] , the homogeneous functions @xmath289 define a homogeneous macroscopic equilibria .    the case of opposite vector flows may be non - stable since a small deviation from the equilibria leads to the global alignment of the layers .",
    "in particular , numerical simulations ( see section [ section : hom_sim ] ) capture only equilibria with the same velocity in each layers .",
    "the question whether other stable macroscopic equilibria exists remains open .",
    "in this section , we compare numerical simulations of both the microscopic and macroscopic models .",
    "the numerical methods are variations of those presented in ref .",
    "@xcite : the microscopic model is solved with an implicit scheme and the macroscopic model is solved using the splitting method .",
    "the two methods are detailed in [ annex : num ] .",
    "we consider @xmath290 layers and each layer contains @xmath291 particles .",
    "the particle positions are uniformly randomly distributed on the square @xmath292\\times[0,l_y]$ ] with @xmath293 , the particle velocity direction angles @xmath83 are uniformly randomly distributed on @xmath294 $ ] and the particle inclinations @xmath84 are uniformly randomly distributed on @xmath295 $ ] .",
    "we first consider an homogeneous test - case : the interaction radii @xmath40 , @xmath63 and @xmath296 all equal @xmath297 and each particle thus interacts with ( almost ) all the other ones .",
    "we first consider non - interacting layers supposing @xmath298 . in figure",
    "[ fig : non - interact - layers ] , we plot the distributions of @xmath83 and @xmath84 of the three layers .",
    "we also plot the von mises distributions : @xmath299 where @xmath300 and @xmath301 are the mean velocity angle and mean inclination angle of the particle of the @xmath302-th layer : @xmath303 both velocity and inclination distribution are in good agreement with the von mises distributions . in figure",
    "[ fig : non - interact - layers - mean ] , we present the time evolution of the mean angles @xmath300 and @xmath301 . since there are no layer interactions , these mean angles are almost constant in time up to stochastic fluctuations .",
    "at time @xmath304 .",
    "right : distributions of inclination angle @xmath84 at time @xmath304 .",
    "numerical parameters : @xmath305 , @xmath306 , @xmath307 , @xmath308 , @xmath309 .",
    "number of particles : @xmath291 per layer.,title=\"fig:\",scaledwidth=50.0% ] at time @xmath304 .",
    "right : distributions of inclination angle @xmath84 at time @xmath304 .",
    "numerical parameters : @xmath305 , @xmath306 , @xmath307 , @xmath308 , @xmath309 .",
    "number of particles : @xmath291 per layer.,title=\"fig:\",scaledwidth=50.0% ]     as function of time .",
    "right : mean inclination angles @xmath301 as function of time .",
    "numerical parameters : @xmath305 , @xmath306 , @xmath307 , @xmath308 , @xmath309 .",
    "number of particles : @xmath291 per layer.,title=\"fig:\",scaledwidth=49.0% ]   as function of time .",
    "right : mean inclination angles @xmath301 as function of time . numerical parameters : @xmath305 , @xmath306 , @xmath307 , @xmath308 , @xmath309 .",
    "number of particles : @xmath291 per layer.,title=\"fig:\",scaledwidth=49.0% ]      we still consider @xmath290 layers but the number of particles per layer equals @xmath310 .",
    "the particle positions are uniformly randomly distributed on the square @xmath292\\times[0,l_y]$ ] with @xmath293 and the interaction radii @xmath40 , @xmath63 , @xmath296 equal @xmath311 : there are in average @xmath312 neighboring particles .",
    "we include layer interactions : we suppose that the inter - layer distance @xmath7 equals the particle radius @xmath313 .",
    "the layer interaction coefficients are chosen as follows : @xmath314 and @xmath315 . particle velocity and inclination angles",
    "are randomly distributed according to their respective von mises distribution .",
    "initial mean velocity angle and mean inclination angle for the three layers are chosen as follows : @xmath316 we also perform a time rescaling in the microscopic model .",
    "let @xmath109 and consider the following microscopic parameters : @xmath317 with @xmath318 .",
    "consequently , we choose a macroscopic time scale .",
    "we compare particle simulations with macroscopic simulation .",
    "for the macroscopic model , we thus consider a constant initial density in each layer given by : @xmath319 and the uniform initial values of @xmath300 and @xmath301 given by - .",
    "the macroscopic layer interaction coefficients are given by : @xmath320 with no @xmath321 , since the particle simulation already consider the macroscopic time scale .",
    "[ fig : interact - layers - mean - macro - test3 ] ( top ) depicts the time evolution of the mean velocity and mean inclination for both the microscopic simulation ( dashed line ) and macroscopic simulation ( continuous line ) .",
    "microscopic simulations are averaged of @xmath322 particle simulations .",
    "let us first describe the macroscopic dynamics .",
    "the dynamics can be split into two steps : during the first step , up to time @xmath323 , layer 2 mainly interact with layer 1 since the overlap function is more important between this two layers .",
    "this leads to a first relaxation dynamics that make the mean velocities of these two layers align .",
    "then , during the second step , after time @xmath324 , interactions between layers 2 and 3 becomes predominant and a second relaxation dynamics occur that leads to alignment of the three layers .",
    "we then note that microscopic and macroscopic simulations coincide during the first @xmath325 time unit ( including the first relaxation mechanism ) .",
    "this confirms that the macroscopic model captures the right interaction time scale .",
    "however , we see that , due to the finite number of particles , stochastic fluctuations make the second relaxation occur earlier around time @xmath326 ( micro ) instead of @xmath327 ( macro ) . looking at figures [ fig : interact - layers - mean - macro - test3 ] ( bottom ) , where @xmath328 particle simulations are plotted and compared to macroscopic simulation , we see that the time of the second relaxation depends on the simulation and occurs always before the macroscopic relaxation . as noted in section [ sec : macro_equilibria ] , once the particle velocities of the three layers are aligned , homogeneous inclination angles per layer define equilibria",
    ". therefore , the time of the second relaxation step strongly determines the final inclinations .",
    "this explains the large deviation between macro and micro simulations after time @xmath329 as regards inclinations .",
    "we now conserve the same parameters except that @xmath330 and , consequently , some inclination configuration prevent layers from interacting . in fig .",
    "[ fig : interact - layers - mean - macro - test8 ] , we plot the time evolution of the mean velocity angle and mean inclination angle .",
    "we observe that , in the macroscopic simulation , a slight increase of the inter - layer distance results in large time translation of the second relaxation step going from @xmath327 ( fig .",
    "[ fig : interact - layers - mean - macro - test3 ] ) to @xmath331 ( fig .",
    "[ fig : interact - layers - mean - macro - test8 ] ) .",
    "this highlights the meta - stability of the system between the two relaxation steps . concerning the particle simulations ( in dashed lines ) ,",
    "the slight increase of the inter - layer distance does not result in a so much increase of the second relaxation time ( it goes from @xmath326 ( fig .",
    "[ fig : interact - layers - mean - macro - test3 ] ) to only @xmath327 ( fig .",
    "[ fig : interact - layers - mean - macro - test8 ] ) ) .",
    "the second relaxation thus occurs two times earlier than predicted by the macroscopic simulation .",
    "indeed , due to stochastic fluctuations , some particles interact instead of remaining in non - interacting configuration .",
    "therefore , this is the stochastic fluctuations that impacts the long term dynamics of the model .    )",
    "comparison of macroscopic ( continuous line ) and microscopic ( dashed line ) simulations . left :",
    "mean velocity angles @xmath300 as function of time .",
    "right : mean inclination angles @xmath301 as function of time . up : comparison with the average of @xmath322 microscopic simulations . down : comparison with @xmath328 microscopic simulations .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 , @xmath334 .",
    "layer - interaction parameters : @xmath335 , @xmath336 , @xmath337 , @xmath338 .",
    "microscopic parameters : @xmath310 particles per layer , @xmath314 , @xmath339 .",
    "macroscopic parameters : @xmath340 , @xmath339 . ,",
    "title=\"fig:\",scaledwidth=50.0% ] ) comparison of macroscopic ( continuous line ) and microscopic ( dashed line ) simulations . left :",
    "mean velocity angles @xmath300 as function of time .",
    "right : mean inclination angles @xmath301 as function of time . up : comparison with the average of @xmath322 microscopic simulations . down : comparison with @xmath328 microscopic simulations .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 , @xmath334 .",
    "layer - interaction parameters : @xmath335 , @xmath336 , @xmath337 , @xmath338 .",
    "microscopic parameters : @xmath310 particles per layer , @xmath314 , @xmath339 .",
    "macroscopic parameters : @xmath340 , @xmath339 . ,",
    "title=\"fig:\",scaledwidth=50.0% ]    ) comparison of macroscopic ( continuous line ) and microscopic ( dashed line ) simulations . left : mean velocity angles @xmath300 as function of time .",
    "right : mean inclination angles @xmath301 as function of time . up : comparison with the average of @xmath322 microscopic simulations . down : comparison with @xmath328 microscopic simulations .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 , @xmath334 .",
    "layer - interaction parameters : @xmath335 , @xmath336 , @xmath337 , @xmath338 .",
    "microscopic parameters : @xmath310 particles per layer , @xmath314 , @xmath339 .",
    "macroscopic parameters : @xmath340 , @xmath339 .",
    ", title=\"fig:\",scaledwidth=50.0% ] ) comparison of macroscopic ( continuous line ) and microscopic ( dashed line ) simulations . left :",
    "mean velocity angles @xmath300 as function of time .",
    "right : mean inclination angles @xmath301 as function of time .",
    "up : comparison with the average of @xmath322 microscopic simulations . down : comparison with @xmath328 microscopic simulations .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 , @xmath334 .",
    "layer - interaction parameters : @xmath335 , @xmath336 , @xmath337 , @xmath338 .",
    "microscopic parameters : @xmath310 particles per layer , @xmath314 , @xmath339 .",
    "macroscopic parameters : @xmath340 , @xmath339 .",
    ", title=\"fig:\",scaledwidth=50.0% ]    ) comparison of macroscopic ( continuous line ) and microscopic ( dashed line ) simulations . left : mean velocity angles @xmath300 as function of time .",
    "right : mean inclination angles @xmath301 as function of time .",
    "up : comparison with the average of @xmath322 microscopic simulations .",
    "down : comparison with @xmath328 microscopic simulations .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 , @xmath334 .",
    "layer - interaction parameters : @xmath341 , @xmath336 , @xmath337 , @xmath338 .",
    "microscopic parameters : @xmath310 particles per layer , @xmath314 , @xmath339 .",
    "macroscopic parameters : @xmath340 , @xmath339 .",
    ", title=\"fig:\",scaledwidth=50.0% ] ) comparison of macroscopic ( continuous line ) and microscopic ( dashed line ) simulations . left :",
    "mean velocity angles @xmath300 as function of time .",
    "right : mean inclination angles @xmath301 as function of time . up : comparison with the average of @xmath322 microscopic simulations . down : comparison with @xmath328 microscopic simulations .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 , @xmath334 .",
    "layer - interaction parameters : @xmath341 , @xmath336 , @xmath337 , @xmath338 .",
    "microscopic parameters : @xmath310 particles per layer , @xmath314 , @xmath339 .",
    "macroscopic parameters : @xmath340 , @xmath339 . ,",
    "title=\"fig:\",scaledwidth=50.0% ]    ) comparison of macroscopic ( continuous line ) and microscopic ( dashed line ) simulations . left : mean velocity angles @xmath300 as function of time .",
    "right : mean inclination angles @xmath301 as function of time . up : comparison with the average of @xmath322 microscopic simulations . down : comparison with @xmath328 microscopic simulations .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 , @xmath334 .",
    "layer - interaction parameters : @xmath341 , @xmath336 , @xmath337 , @xmath338 .",
    "microscopic parameters : @xmath310 particles per layer , @xmath314 , @xmath339 .",
    "macroscopic parameters : @xmath340 , @xmath339 .",
    ", title=\"fig:\",scaledwidth=50.0% ] ) comparison of macroscopic ( continuous line ) and microscopic ( dashed line ) simulations . left : mean velocity angles @xmath300 as function of time .",
    "right : mean inclination angles @xmath301 as function of time .",
    "up : comparison with the average of @xmath322 microscopic simulations .",
    "down : comparison with @xmath328 microscopic simulations .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 , @xmath334 .",
    "layer - interaction parameters : @xmath341 , @xmath336 , @xmath337 , @xmath338 .",
    "microscopic parameters : @xmath310 particles per layer , @xmath314 , @xmath339 .",
    "macroscopic parameters : @xmath340 , @xmath339 .",
    ", title=\"fig:\",scaledwidth=50.0% ]      we now consider @xmath290 layers on the square domain @xmath292\\times[0,l_y]$ ] with @xmath342 . as in @xcite , we are interested in taylor - green vortex initial condition .",
    "initial densities are taken uniform equal to @xmath343 .",
    "velocity angles are given by : @xmath344 where @xmath345 denotes the angle between vectors @xmath346 and @xmath347 , @xmath348 is the vector defined by : @xmath349 and @xmath350 are translation of @xmath351 : @xmath352 with translation vectors @xmath353 given by : @xmath354 as regards the velocity initial condition , each layer is thus the translation of a normalized taylor - green vortex .",
    "consequently , layers velocity fields are not initially the same and alignment dynamics should arise .",
    "finally , inclination angles are taken uniform with the same value as the previous test - case .",
    "we first consider non - interacting layers : @xmath298 .",
    "this test - case thus reduces to a simulation of the soh model . in figure",
    "[ fig : noninteract - layers - tg - velocity ] , we plot the space distribution of density , velocity and inclination for both the particle ( left figures ) and macroscopic simulations ( right figures ) for layer @xmath56 ( first and third layer are identical up to translation ) . for the particle simulation , we consider that each layer contains @xmath355 particles .",
    "the interaction radii @xmath40 , @xmath63 and @xmath296 equal @xmath356 .",
    "therefore , the particles have in averaged @xmath357 neighboring particles in each layer at the beginning of the simulation .",
    "we consider the same rescaling with @xmath318 .",
    "densities are computed on a grid with space steps equal to @xmath358 and as regards the particle simulation , they are averaged over @xmath322 runs of the test - case .",
    "we use the same time step for both macroscopic and microscopic simulations .    in fig .",
    "[ fig : noninteract - layers - tg - velocity ] ( top ) , we observe clustering for both microscopic and macroscopic simulation in region of negative divergence flow .",
    "the density in layer @xmath56 has maximal value equal to @xmath359 for the microscopic simulations and @xmath360 for the macroscopic simulation .",
    "consequently the number of neighboring particles is multiplied by a factor @xmath328 in these regions .",
    "we also observe that the vortex are better conserved with the particle simulations .",
    "concerning the velocity field , the microscopic velocity is obtained by dividing the local momentum by the local density .",
    "the velocity vectors should be of size @xmath255 but this is not the case in low density regions due to the small number of particles .",
    "this partly explains the observed differences between the microscopic and macroscopic simulations .",
    "however , there is a quite good overall agreement between the two simulations .",
    "[ fig : noninteract - layers - tg - velocity ] ( bottom ) is represented the cosine ( in absolute value ) of the inclination angle : as layer interactions do not occur , it remains uniform .",
    "( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath361 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ] ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath361 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ]   ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath361 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ] ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath361 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ]      we then consider interacting layers when setting @xmath363 .",
    "the layer interaction parameters are taken equal to : @xmath364 , @xmath365 .",
    "the other parameters are the same as previously .",
    "the parameter @xmath75 is chosen in such a way that the interaction coefficient @xmath366 is of the same order as in section [ section : hom_sim ] .",
    "we compare the average of @xmath322 particle simulations with one macroscopic simulation on fig .",
    "[ fig : interact - layers - tg - velocity ] and [ fig : interact - layers - tg - inclination ] .    fig .",
    "[ fig : interact - layers - tg - velocity ] depicts the density and the velocity vector field for the three superposed layers . as in the previous test - case , we observe that the microscopic and macroscopic simulations are in good agreement .",
    "the velocity vector fields of the three layers are mostly aligned and consequently the density concentrations are localized almost in the same regions .",
    "this is particularly true for the macroscopic simulations ( right ) .",
    "concerning the microscopic simulations ( left ) , we still observe some differences between the layers .    in fig .",
    "[ fig : interact - layers - tg - inclination ] , we represent the cosine of the inclination angle ( in absolute value ) . the inclination for particle simulations",
    "is obtained by computing the local mean inclination angle with formula . due to layer interactions , the inclination is no more uniform .",
    "contrary to the velocity vector field , we observe large differences between the macroscopic and particle inclinations .",
    "this could be a consequence of the differences pointed out in section [ section : hom_sim ] .",
    "note that regions with aligned inclinations do not necessarily match regions of uniform densities .",
    "finally , the inter - layer interactions on inclinations affect in return the density and velocity vector field .",
    "this is particularly clear when comparing the density of layer 2 with the one of the non - interacting test - case ( fig .",
    "[ fig : noninteract - layers - tg - velocity ] ( top ) ) for the macroscopic simulation .",
    "all the symmetries inherited from the initial distribution have been diluted by the inclination / velocity inter - layer interactions .",
    "( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer .",
    "right : velocity vector field for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ] ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer .",
    "right : velocity vector field for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ]   ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer .",
    "right : velocity vector field for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ] ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer .",
    "right : velocity vector field for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ]   ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer .",
    "right : velocity vector field for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ] ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer .",
    "right : velocity vector field for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ]     ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : cosine of the inclination angle ( in absolute value ) for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ] ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : cosine of the inclination angle ( in absolute value ) for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ]    ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : cosine of the inclination angle ( in absolute value ) for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ] ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : cosine of the inclination angle ( in absolute value ) for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ]    ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : cosine of the inclination angle ( in absolute value ) for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ] ( averaged on @xmath322 simulations ) .",
    "number of particles : @xmath355 per layer . @xmath339 .",
    "right : cosine of the inclination angle ( in absolute value ) for the macroscopic simulation .",
    "@xmath339 , @xmath358 .",
    "alignment interaction parameters : @xmath305 , @xmath332 , @xmath307 , @xmath333 .",
    "layer - interaction parameters : @xmath367 , @xmath364 , @xmath365 , @xmath362.,title=\"fig:\",scaledwidth=45.0% ]",
    "in this article , we have proposed an individual - based model of self - propelled disk - like particles interacting through alignment and volume exclusion .",
    "this model is intended to provide a framework for modeling collective sperm - cell dynamics .",
    "particle motion is supposed confined in two - dimensional planar layers .",
    "particle interactions between nearby layers contribute to modify the disk inclinations , which generates a coupling between inclinations and motion .",
    "we have then derived a continuum model from this individual - based model .",
    "it describes the evolution of the local density , mean velocity direction and mean inclination of the disks in the various layers .",
    "numerical simulations have shown a good agreement between the continuum model and the individual - based one , but has also highlighted some differences .",
    "there are many possible directions to expand the current work and make it more realistic . at the individual - based level , the description of the agents and the interaction rules could be improved for a better account of actual sperm - cell motion .",
    "for instance , the assumption that all sperm - cells have the same constant velocity is obviously unrealistic . in any semen sample",
    ", there is always a certain proportion of dead sperm - cells and of less motile ones .",
    "this could be accounted for by allowing the particle velocities to span a certain range of values .",
    "the shape of the head could be improved from the current infinitely thin disk to finite thickness ellipsoids .",
    "the inclination interaction could involve a density dependency as it is more difficult to fit actual disks in one layer if they are inclined towards the plane than if they stand vertically .",
    "finally , one could also imagine a process by which particles would change layers . at the level of the continuum model , one major improvement should be to add a random fluctuation term in order to account for finite system size effects , similar to ref .",
    "we believe that adding such a term would help achieve a better match between the continuum model and the individual - based one .",
    "other improvements would consist in adding a spatial diffusion to retain some of the nonlocality of the alignment interaction , similar to ref .",
    "@xcite or adding a layer - changing term .",
    "finally , for both the individual - based and continuum models , the model parameters should be calibrated by close comparisons with biological data .",
    "nematic alignment consists in alignment with the mean direction .",
    "the mean direction can be defined as the eigenspace of the averaged projection matrix : @xmath368 corresponding to the largest eigenvalue .",
    "the eigenvector @xmath369 satisfies : @xmath370 \\begin{pmatrix } \\cos \\bar\\theta\\\\ \\sin \\bar\\theta \\end{pmatrix } \\times   \\begin{pmatrix } \\cos \\bar\\theta\\\\ \\sin \\bar\\theta \\end{pmatrix } = 0\\ ] ] easy computations lead to the following relation : @xmath371 that can be written also as follows : @xmath372 the mean direction then satisfies : @xmath373 then @xmath374 is defined modulo @xmath375 .",
    "therefore , the orthogonal vectors @xmath369 and @xmath376 are both eigenvectors . using the relation @xmath377",
    "the averaged projection matrix writes : @xmath378 whose eigenvalues are given by @xmath379 .",
    "consequently , the eigenvector @xmath369 corresponding to the largest eigenvalue involves the angle @xmath374 satisfying : @xmath380 @xmath374 is now defined modulo @xmath2 .",
    "we recover the definition of equation [ eq : nematic_alignment ] .",
    "from ref .",
    "@xcite , coefficients @xmath255 and @xmath248 are positive and bounded .",
    "we have the following expansion ( in the limit @xmath381 , that corresponds to large diffusion compared to alignment ) : @xmath382 the following proposition asserts similar results for coefficients @xmath249 and @xmath250 .",
    "constants @xmath249 and @xmath250 can be written : @xmath383 in particular , they are positive and lower than @xmath256 .",
    "we have the following taylor expansions , as @xmath381 and @xmath384 : @xmath385    by integration by part : @xmath386 } \\partial_\\varphi m_1 i_1\\ , d\\varphi = - \\kappa_1 \\int_{\\varphi \\in [ 0,2\\pi ] } m_1 \\partial_\\varphi i_1\\ , d\\varphi\\ ] ] then , using expression , we easily get the expected expression for @xmath249 .",
    "the same manipulations lead to the expression for @xmath250 .",
    "the positivity of @xmath249 and @xmath250 then results from the cauchy - schwarz inequality .",
    "moreover the weight functions @xmath387 and @xmath388 are also bounded .",
    "we have : @xmath389 we have the following taylor expansions : @xmath390 } g(\\bar\\theta+\\theta,\\bar\\theta_k+\\theta ' ) \\ , \\frac{d\\theta}{\\pi } \\frac{d\\theta'}{\\pi } + o(\\kappa_2),\\\\ & \\langle gm_2m_2\\partial_\\theta i_2\\rangle(\\bar\\theta,\\bar\\theta_k ) = - \\kappa_2 \\int_{\\theta,\\theta ' \\in [ 0,\\pi ] } g(\\bar\\theta+\\theta,\\bar\\theta_k+\\theta ' ) \\cos 2\\theta   \\ , \\frac{d\\theta}{\\pi } \\frac{d\\theta'}{\\pi } + o(\\kappa_2 ^ 2).\\end{aligned}\\ ] ]    the inequalities for @xmath387 results from the bounds @xmath391 .",
    "using expression , we have : @xmath392 } g(\\bar\\theta+\\theta,\\bar\\theta_k+\\theta')\\big(-m_2(\\theta ) + \\\\ & \\hspace{4 cm } \\frac{\\pi}{\\left(\\int_0^\\pi",
    "e^{\\kappa_2 \\cos 2u du}\\right)\\left(\\int_0^\\pi e^{-\\kappa_2 \\cos 2u du}\\right)}\\big ) m_2(\\theta')\\ , d\\theta d\\theta'\\\\ & = - \\langle gm_2m_2\\rangle(\\bar\\theta,\\bar\\theta_k)\\\\ & \\qquad + \\frac{\\pi^2}{\\left(\\int_0^\\pi e^{\\kappa_2 \\cos 2u du}\\right)\\left(\\int_0^\\pi e^{-\\kappa_2 \\cos 2u du}\\right)}\\int_{\\theta,\\theta ' \\in [ 0,\\pi ] } g(\\bar\\theta+\\theta,\\bar\\theta_k+\\theta ' ) m_2(\\theta')\\ , \\frac{d\\theta}{\\pi } d\\theta'.\\end{aligned}\\ ] ] in the last expression , both terms have absolute value lower than @xmath256 .",
    "for the sake of completeness , we here recall the numerical scheme used for the numerical simulations .",
    "the deterministic part of equations and can be written : @xmath393 dt , \\\\ & de^{2i\\theta_k } = ( ie^{2i\\theta_k})\\cdot\\left(2k ( e^{2i\\bar\\theta_k } - e^{2i\\theta_k } ) + 2t_k ( ie^{2i\\theta_k})\\right ) ie^{2i\\theta_k } dt , \\end{aligned}\\ ] ] following @xcite ( annex c ) , we then use the scheme : @xmath394 + \\sqrt{2d\\delta t}\\ , \\eps_k^n ,   \\quad \\mbox { modulo } 2\\pi,\\\\ & \\hspace{5 cm } \\text{with } b = v(\\varphi_k^n ) + \\delta t\\ , \\frac{\\nu ( v(\\bar \\varphi_k^{\\text{tot}\\ , n } ) - v(\\varphi_k^n))}{2},\\\\ & \\theta_k^{n+1 } = \\theta_k^n + \\left[2\\theta_k^n - \\arg(c)\\right ] + \\sqrt{\\delta\\delta t}\\ , \\tilde\\eps_k^n , \\quad \\mbox { modulo } \\pi,\\\\ & \\hspace{5 cm } \\text{with } c = e^{2i\\bar\\theta_k^n } + \\delta t\\ , \\frac{2k ( e^{2i\\bar\\theta_k^n } - e^{2i\\theta_k^n } ) + 2t_k^n ( ie^{2i\\theta_k^n})}{2},\\end{aligned}\\ ] ] where @xmath395 and @xmath396 are random variables with standard normal distribution , @xmath397 denotes the argument of the complex number @xmath398 and we recall that @xmath399 denotes the angle between the vector @xmath400 and the vector @xmath347 .",
    "multiplying equations and respectively by @xmath401 and @xmath402 , we get : @xmath403\\nonumber\\\\ & \\ =   p_{v(\\bar\\varphi)^\\perp}\\left[\\frac{\\nu\\beta ' } { c_3}\\ , \\sum_{k,\\ , k - h = \\pm 1 }   \\langle gm_2m_2\\rangle(\\bar\\theta,\\bar\\theta_k)\\ , c_1 \\rho_k v(\\bar\\varphi_k)\\right ] , \\label{eq : phi_final2 } \\\\ & \\rho ( \\partial_t e^{2i\\bar\\theta } +   c c_1 ( v(\\bar \\varphi ) \\cdot\\nabla_x ) e^{2i\\bar\\theta } ) = \\nonumber\\\\ & \\",
    "= \\left[\\frac{1}{c_4}\\ , \\ , ( c_1   \\rho   v(\\bar \\varphi))^\\perp\\cdot \\sum_{k,\\ , k - h = \\pm 1 } \\sgn(k - h ) \\langle gm_2m_2\\partial_\\theta i_2\\rangle(\\bar\\theta,\\bar\\theta_k)\\ ,   c_1 \\rho_k v(\\bar \\varphi_k)\\right ] 2ie^{2i\\bar\\theta}. \\label{eq : theta_final2}\\end{aligned}\\ ] ] to solve this system , we introduce a relaxation model @xmath404 and where @xmath405 denotes the angle of the vector @xmath406 . in the limit @xmath407 , the solution @xmath408 to -- formally converges to @xmath409 , solution of equations and - .    equation -- is numerically solved using a splitting method .",
    "we first solve the conservative part ( with a roe - like method@xcite ) , we then add the source term and we finally solve the relaxation part . for the last step , we just perform a renormalization of the vectors .",
    "this kind of scheme has been validated . in particular",
    ", it captures the correct discontinuous solutions of the macroscopic model corresponding to the solutions of the microscopic simulations . for more details",
    ", we refer to ref .",
    "@xcite .",
    "the characteristic velocities of the conservative system in the @xmath410 direction are : @xmath411 where @xmath412 denotes the first component of the vector @xmath413 .",
    "as noticed in ref .",
    "@xcite , the conservative part of the equation is hyperbolic under the condition : @xmath414 that is the case for the parameters chosen in section [ section : num_experiment ] . to ensure the stability of the conservative step , the time and space steps @xmath415 and @xmath416 have to satisfy the cfl condition : @xmath417 to ensure the stability of the source term step , we choose @xmath415 small enough to ensure : @xmath418 at each time step",
    "this work has been supported by the agence nationale pour la recherche ( anr ) in the framework of the contract motimo ( anr-11-monu-009 - 01 ) and by the national science foundation under grant rnms11 - 07444 ( ki - net ) .",
    "pd is on leave from cnrs , institut de mathmatiques de toulouse , france .",
    "pd acknowledges support from the royal society and the wolfson foundation through a royal society wolfson research merit award and from the engineering and physical sciences research council ( epsrc ) under grant ref : ep / m006883/1 .",
    "chuang , m. r. dorsogna , d. marthaler , a. l. bertozzi and l. s. chayes , state transitions and the continuum limit for a 2d interacting , self - propelled particle system , _ physica d _ * 232 * ( 2007 ) 33 - 47 .",
    "v. i. ratushnaya , d. bedeaux , v. l. kulinskii and a. v. zvelindovsky , collective behavior of self propelling particles with kinematic constraints : the relations between the discrete and the continuous description , _ phys .",
    "a _ * 381 * ( 2007 ) 39 - 46 ."
  ],
  "abstract_text": [
    "<S> we present an individual - based model describing disk - like self - propelled particles moving inside parallel planes . </S>",
    "<S> the disk directions of motion follow alignment rules inside each layer . additionally , the disks are subject to interactions with those of the neighboring layers arising from volume exclusion constraints . </S>",
    "<S> these interactions affect the disk inclinations with respect to the plane of motion . </S>",
    "<S> we formally derive a macroscopic model composed of planar self - organized hydrodynamic ( soh ) models describing the transport of mass and evolution of mean direction of motion of the disks in each plane , supplemented with transport equations for the mean disk inclination . </S>",
    "<S> these planar models are coupled due to the interactions with the neighboring planes . </S>",
    "<S> numerical comparisons between the individual - based and macroscopic models are carried out . </S>",
    "<S> these models could be applicable , for instance , to describe sperm - cell collective dynamics . </S>"
  ]
}