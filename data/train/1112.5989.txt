{
  "article_text": [
    "to describe the practical implementation of the contraction - reduction integral algorithm we have to start from the explicit definition of the exchange matrix elements with respect to the eris and the basis set @xmath60 . within the discretized space eq .",
    "( [ eq:11 ] ) can be written as : @xmath61 where @xmath62 represents the 2-electron coulomb operator .",
    "we made explicit in eq .",
    "( [ eq : wijdiscr ] ) the fact that the support functions are centered on the nuclei positions @xmath63 .    the sets @xmath64 and @xmath65 account for the weight factors of the quadrature points @xmath66 and @xmath67 .",
    "we choose to work with an evenly spaced cubic grid where both @xmath68 and @xmath69 simplify to @xmath70 , with @xmath71 the grid spacing . under the translation @xmath72 , which leaves invariant the eri",
    ", we obtain @xmath73 using @xmath74 . by virtue of the linearity of discretized space , we are allowed to introduce the temporary matrix : @xmath75 we emphasize that @xmath27 is evaluated on a cubic grid centered on the nucleus @xmath34 . the explicit expression for the reduced density of  eq .",
    "( [ eq:13 ] ) is given by , @xmath76 the corresponding reduced pair potential @xmath77 is obtained by solving the poisson equation .",
    "finally , we introduce the temporary matrix : @xmath78 to perform the last numerical integration , yielding the exchange matrix elements : @xmath79 we have made the dependence of the various matrix elements on the translation vectors @xmath80 explicit .",
    "@xmath81 evaluate  and @xmath81 store  @xmath82 @xmath81 evaluate  and @xmath81 store  @xmath83 @xmath81 evaluate  @xmath84 and @xmath81 store  ?",
    "@xmath81 fetch  @xmath38 @xmath81 evaluate  @xmath85 and @xmath81 store  ?",
    "@xmath86 accumulate  @xmath44 : @xmath87 : @xmath21 @xmath81 calculate  @xmath88 @xmath81 evaluate  @xmath43 @xmath86 accumulate  @xmath37 : @xmath87 : @xmath22 : @xmath87 : @xmath39 @xmath81 integrate  @xmath35 : @xmath34    the cri approach involves three main operations : ( i ) the projection of @xmath82 onto the discretized space , where both radial functions and spherical harmonics are evaluated on a cubic grid .",
    "( ii ) the summations of eqs .  ( [ eq : phik ] ) and ( [ eq : omegaj ] ) . (",
    "iii ) the evaluation of the pair potential @xmath43 .",
    "the combination of local fft grids@xcite with the locality property of the nao easily fulfils the efficiency requirement . on each",
    "_ primary _ atom @xmath34 a box is centered at the position @xmath89 .",
    "this box contains an ensemble of grid points called @xmath90 . for the nao set @xmath91 in eq .",
    "( [ eq : xijtransl ] ) other boxes @xmath92 are defined and translated along the vector @xmath93 . here , we choose to work with identical cubic boxes of length @xmath94 , where @xmath95 is the largest confinement radius over the whole set of contracted support functions .",
    "considering that the quadrature of eq .",
    "( [ eq : xijtransl ] ) is different from zero if significant overlap is deemed to exist between the orbital - pairs @xmath96 and @xmath97 , we can first reduced the computational resources involved in ( i ) by defining reduced spaces as , @xmath98 where @xmath99 is the overlap box of @xmath100 with @xmath101 .",
    "then the discretization of @xmath102 is only realized for grid points common to the space span by @xmath103 and @xmath104 , respectively .",
    "secondly , by using the fact that the coordinate system is centered on the primary atom , we can introduced an efficient screening during the course of the calculation and reduced the computational time related to ( ii ) and ( iii ) .",
    "accumulation in the temporary matrices @xmath44 and @xmath37 , which are centered on atom @xmath34 , is performed if the distance @xmath105 between the two distribution centers is below the exx cutoff @xmath87 .",
    "57ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty http://onlinelibrary.wiley.com/doi/10.1002/9780470116449.ch1/summary [ * * ,   ( ) ] link:\\doibase 10.1088/0034 - 4885/75/3/036503 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.1787832 [ * * ,   ( ) ] http://dx.doi.org/10.1002/pssb.200541386 [ * * ,   ( ) ] ,   \\doibase doi:10.1063/1.476741 [ * * ,   ( ) ] \\doibase doi:10.1063/1.472135 [ * * ,   ( ) ] \\doibase doi:10.1063/1.473833 [ * * ,   ( ) ] link:\\doibase 10.1080/0026897042000274801 [ * * ,   ( ) ] link:\\doibase    10.1016/j.chemphys.2008.10.036 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1604371 [ * * ,   ( ) ] link:\\doibase 10.1002/qua.21985 [ * * , ( ) ] \\doibase doi :    10.1021/jp9825157 [ * * ,   ( ) ] link:\\doibase",
    "10.1016/0301 - 0104(73)80059-x [ * * ,   ( ) ] link:\\doibase 10.1063/1.438728 [ * * ,   ( ) ] link:\\doibase 10.1063/1.438313 [ * * ,   ( ) ] link:\\doibase 10.1016/0009 - 2614(85)80121 - 4 [ * * ,   ( ) ] link:\\doibase 10.1063/1.451237 [ * * , ( ) ] link:\\doibase    10.1016/0009 - 2614(95)00838-u [ * * ,   ( ) ] link:\\doibase 10.1007/s002140050244 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3646921 [ * * , ( ) ] link:\\doibase 10.1063/1.2956507 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.34.4405 [ * * ,   ( ) ] link:\\doibase 10.1063/1.476307 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1926272 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.80.085114 [ * * ,   ( ) ] link:\\doibase 10.1016/j.cpc.2009.12.021 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.84.113102 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2166016 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.77.193110 [ * * , ( ) ] link:\\doibase    10.1103/physrevb.79.085102 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3082269 [ * * ,   ( ) ] link:\\doibase 16/j.cpc.2010.03.019 [ * * , ( ) ] link:\\doibase    10.1021/jp908836z [ * * ,   ( ) ] http://dx.doi.org/10.1016/s0010-4655(97)00029-5 [ * * ,   ( ) ] ,   link:\\doibase 10.1016/s0009 - 2614(98)00065 - 7 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.40.3979 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.64.235111 [ * * ,   ( ) ] link:\\doibase 10.1088/0953 - 8984/20/29/294206 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.56.14972 [ * * ,   ( ) ] link:\\doibase 10.1063/1.477923 [ * * , ( ) ] link:\\doibase    10.1103/physrevb.73.205119 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.77.115139 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3036423 [ * * , ( ) ] link:\\doibase 10.1063/1.3009264 [  * * , ( ) ] link:\\doibase 10.1103/physrevlett.93.176403 [ * * ,   ( ) ] link:\\doibase    10.1063/1.2335442 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2754685 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.75.818 [ * * ,   ( ) ] link:\\doibase 10.1063/1.470314 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.60.1551 [ * * , ( ) ] @noop ( ) link:\\doibase 10.1016/s0010 - 4655(01)00248-x [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.76.3168 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.53.7147 [ * * , ( ) ]"
  ],
  "abstract_text": [
    "<S> we present enhancements to the computational efficiency of exact exchange calculations using the density matrix and local support functions . </S>",
    "<S> we introduce a numerical method which avoids the explicit calculation the four - center two - electron repulsion integrals and reduces the prefactor scaling by a factor @xmath0 , where @xmath0 is the number of atoms within the range of the exact exchange hamiltonian . </S>",
    "<S> this approach is based on a contraction - reduction scheme , and takes advantage of the discretization space which enables the direct summation over the support functions in a localized space . using the sparsity property of the density matrix </S>",
    "<S> , the scaling of the prefactor can be further reduced to reach asymptotically @xmath1 .    </S>",
    "<S> the calculation of exchange energy as found in the `` fock  exchange '' for hartree  fock ( hf ) theory or `` exact  exchange '' for kohn  sham ( ks ) density functional theory ( dft ) is well - known to be time consuming , where for a naive implementation the scaling increases with the fourth power of the number of atoms , @xmath0 , or the number of basis states . </S>",
    "<S> it has therefore been the focus of considerable efforts to improve both the efficiency and the scaling . </S>",
    "<S> much of the work has taken place within the quantum chemistry community focussing on approaches using gaussian - type orbitals ( gto ) or exponential - type functions for the radial part such as the well - known slater - type orbitals ( sto ) . </S>",
    "<S> more recently , there has been interest in efficient implementation within the periodic density functional theory community , which traditionally use plane waves as basis functions ( along with atomic pseudopotentials ) and required discrete fast fourier transform ( fft ) technologies . at the same time , linear scaling , or @xmath1 , approaches to finding the electronic ground state have emerged over the last ten to fifteen years,@xcite and new schemes for the evaluation of exact exchange energy have to be developed including the specifications of the @xmath1 techniques . </S>",
    "<S> we report a novel approach to improving the efficiency of exchange calculations for _ any _ localised basis functions , which fits naturally within the formalism of linear scaling dft calculations ; more specifically with the code conquest@xcite .    within the framework of the hf theory , </S>",
    "<S> the exchange energy for a closed - shell system can be written as : @xmath2 using the definition of the density matrix in terms of the molecular eigenstates @xmath3 , @xmath4 where @xmath5 runs over the doubly occupied orbitals . </S>",
    "<S> this yields a more explicit expression for the exchange energy : @xmath6 the typical procedure in quantum chemistry is to express the exchange energy of  eq .  </S>",
    "<S> ( [ eq:3 ] ) in terms of 4-center 2-electron repulsion integrals ( eri ) by expanding @xmath3 onto a linear combination of real atom - centered functions @xmath7 . using the standard notation , </S>",
    "<S> the eri formally reads : @xmath8 the earliest approaches to linear scaling exchange used pre - screening on the integrals and the density matrix based on an assumed decay rate ; see for instance the link@xcite and onx@xcite algorithms . </S>",
    "<S> these analytical methods have been successfully applied in various quantum chemistry codes , though relying on specific basis sets such as gaussian - type orbitals ( gto ) . </S>",
    "<S> alternative efficient solutions generally make the use of a 3-center reduction scheme,@xcite deriving from the density - fitting approach of baerends and roos for slater - type orbtials ( sto),@xcite and dunlap and coworkers@xcite for gto basis sets . </S>",
    "<S> different approaches with a similar spirit , such as the pseudo  </S>",
    "<S> spectral@xcite or the resolution of identity methods@xcite have also demonstrated to be efficient , and improvements are still explored by many groups.@xcite    the plane wave basis sets common within periodic dft implementations make these approaches impossible , and most implementations concentrate on reciprocal space using ffts.@xcite it should be mentioned here that acceptable accuracy is obtained only if an adequate treatment of the coulomb singularities are considered.@xcite . </S>",
    "<S> recently , using a transformation of the kohn - sham orbitals to maximally localised wannier functions , a linear scaling calculation of the exchange potential has been demonstrated.@xcite localised numerical orbital dft approaches to exchange include the semi - analytic solution given by toyoda and ozaki@xcite combining fast - spherical bessel transform for the radial integration and a more traditional analytic method for the spherical harmonic part . </S>",
    "<S> a numerical scheme has also been proposed by shang et al.@xcite where eri are computed by solving numerically the poisson s equation for each localized pair - density @xmath9 , and integrating in real space . similarly to planewave periodic exchange calculations </S>",
    "<S> , the main drawback resides in the accuracy of the poisson solver . </S>",
    "<S> all the methods outlined above involves the explicit calculation of the full or screened set of eris .    </S>",
    "<S> we introduce instead a route which circumvents the calculation of the four - center integrals and works for any smooth finite - range functions , which is particulary well suited for @xmath1 approaches . in standard linear scaling theory , </S>",
    "<S> the density matrix is used as the fundamental variable and is written in a separable form in terms of localised orbitals , also called support functions @xmath10 , @xmath11 where @xmath12 is the density matrix in the representation of the support functions , also known as the density kernel . </S>",
    "<S> linear scaling is achieved when the support functions , centred on the atomic positions @xmath13 , are strictly localised in space and a cutoff is applied to @xmath12 so that , @xmath14 with @xmath15 the density matrix range . from eq .  </S>",
    "<S> ( [ eq:7 ] ) we can therefore write the exchange energy as : @xmath16 with , @xmath17 the exchange matrix @xmath18 becomes now the key quantity to calculate , and for @xmath19 , the resulting exchange energy must be exact . </S>",
    "<S> we note that this form involves a contraction between @xmath20 and one set of local orbitals , seen as the sum over @xmath21 ( or @xmath22 ) in eq .  </S>",
    "<S> ( [ eq:11 ] ) . </S>",
    "<S> this type of contraction is frequently performed in conquest@xcite , but in this case will reduce the prefactor for exchange energy calculation by removing one of the four centres of the eri . moreover , if we apply a range @xmath23 to the exchange , such as @xmath24 we can then achieve linear scaling with the prefactor depending on the localisation of the matrix . </S>",
    "<S> the resulting method is not only efficient , but should be scalable in parallel , as it is compatible with the standard conquest approach to matrix and support function operations .    </S>",
    "<S> as mentioned in the introduction , the key part is to perform the sum over the index @xmath21 _ before _ solving for the coulomb potential of the pair densities ; this simple re - ordering increases the efficiency of the procedure markedly , as we will show below . </S>",
    "<S> we define new contraction functions , @xmath25 , as : @xmath26 it should be outlined that the domain over which these functions are defined requires some care ; this is detailed in the appendix . the sum over @xmath21 need only include those support functions @xmath27 overlapping with @xmath28 , as @xmath29 will be multiplied by this function . </S>",
    "<S> contracted densities are then defined as : @xmath30 and the resulting coulomb potential , @xmath31 is calculated by solving poisson s equation using , for instance , numerical fft routines . as we discuss later , </S>",
    "<S> once the potential has been found a further contraction over @xmath22 is performed to create the function @xmath32 , as : @xmath33 where , again , the sum over support functions @xmath22 need only include those functions which overlap with support function @xmath34 . </S>",
    "<S> the matrix elements @xmath35 are then calculated by integration : @xmath36 the set of function @xmath37 is effectively defined by the density matrix range normally applied to @xmath38 in accordance with  eq .  </S>",
    "<S> ( [ eq:8]) and the need for @xmath39 to overlap with atoms @xmath21 . </S>",
    "<S> there is therefore a clear route to efficient linear scaling exchange calculations within the standard approaches of @xmath1 electronic structure codes .    ) </S>",
    "<S> using explicit eri calculation and the cri method . </S>",
    "<S> ideal @xmath40 and @xmath41 scalings are given by plain lines . </S>",
    "<S> [ fig : scaling1],scaledwidth=48.0% ]     ( in a.u . ) for the calculation of exx in isolated water clusters using the cri method.[fig : scaling2],scaledwidth=48.0% ]    as previously remarked ( see eq .  </S>",
    "<S> ( [ eq:8bis ] ) ) , the calculation time can be reduced further with a screening condition on exchange matrix elements @xmath35 . </S>",
    "<S> this is related to the sparsity property of @xmath42@xcite and the truncation of all the operators involved in the hamiltonian.@xcite from the algorithm of fig .  </S>",
    "<S> [ fig : algoexx ] ( see appendix ) , we note that the evaluation of the reduced potential @xmath43 is performed within a 3-index loop , which contrasts with the 4-index loop ( over a limited set of atoms ) used for the accumulation of temporary matrix @xmath44 </S>",
    "<S> . another possibility would be to compute and store the set @xmath45 ( and @xmath46 ) once , reducing formally after the first cycle the execution time for the calculation of @xmath44 to @xmath47 but increasing the data storage by @xmath48 , respectively .    </S>",
    "<S> practical tests on the efficiency of the contraction - reduction integral ( cri ) algorithm were performed on a set of isolated water clusters ( h@xmath49o)@xmath50 ( @xmath51 ) with fused cubes structures taken from the work of wales and hodges.@xcite calculations of exchange energy were realized after the ks density matrix has been converged using the standard self - consistent - field ( scf ) method . as a result , </S>",
    "<S> the timings presented below for exact exchange ( exx ) energy can be compared to a single scf cycle as found in hf or hybrid - dft calculation . for this demonstration , single-@xmath52 numerical pseudo - atomic orbitals@xcite ( nao ) </S>",
    "<S> have been used for hydrogen and oxygen with cutoff radii of 4.7 and 3.8 au , respectively . </S>",
    "<S> we emphasize that the main conclusions of this work can be easily extended to more flexible basis sets , as far as the support functions are localized . </S>",
    "<S> scf - ks and _ post_-exx calculations were performed with a fixed grid spacing of 0.25 au for the nao discretization . </S>",
    "<S> this protocol allows us to realize fast enough computations on a single processor and also to draw qualitative conclusions on the exchange matrix range .    the central processing unit ( cpu ) times used for the computation of exx </S>",
    "<S> are reported in fig .  </S>",
    "<S> [ fig : scaling1 ] as a function of the number of atoms , for various water clusters , using : ( i ) the explicit evaluation of the full set of eri , ( ii ) the cri approach , and ( iii ) the cri approach with partial storage of the nao during the construction of the temporary matrix @xmath44 involved in the 4-index loop ( see appendix ) . comparing the formal scalings obtained for the cri methods against the full eri approach , it becomes clear that the contraction - reduction algorithm reduces the quartic scaling to to cubic scaling with respect to the size of the water clusters . </S>",
    "<S> timings can be further reduced by requiring the storage of the naos ( the set @xmath45 ) . at this point </S>",
    "<S> we should emphasise that exchange energy values obtained with the three schemes are fully identical , their accuracies being only dependent on the poisson solver used to evaluate the pair potential in eq .  </S>",
    "<S> ( [ eq:14 ] ) .    among the various numerical fft - based methods </S>",
    "<S> , one can choose to evaluate the coulomb potential in reciprocal or real space . whereas the former is the most appropriate for periodic neutral systems when the positively charged nuclei compensate exactly the electronic charge density it becomes less efficient for isolated and/or charged systems.@xcite several schemes have been developed to tackle this problem,@xcite alternatives based on the discrete variable representation ( dvr ) of  eq .  </S>",
    "<S> ( [ eq:14 ] ) which avoids the direct resolution of the poisson equation have been proposed.@xcite the density is generally expanded in a direct product of one - dimensional localized real - space basis functions@xcite as for instance , interpolating scaling functions ( isf ) . after extended comparisons between the dvr - isf developed by genovese et al.@xcite and corrected reciprocal fft - based schemes,@xcite we found that systematic convergence of the eri is obtained with a better accuracy and at a lower cost using the real space poisson solver.@xcite     au . </S>",
    "<S> contributions of the three main routines are presented : the resolution of the poisson equation , the accumulation in the temporary matrices @xmath53 and @xmath54 , and the nao discretization .[fig : scaling3],scaledwidth=48.0% ]    as shown in fig .  </S>",
    "<S> [ fig : scaling2 ] , if integral screenings is introduced within the cri algorithm see fig .  </S>",
    "<S> [ fig : algoexx ] of the appendix the cpu time can be significantly reduced , allowing to reach the @xmath1 regime for clusters with more than 36 atoms ( at @xmath55 au ) . </S>",
    "<S> computational ressources further decrease for shorter exx range along with the faster observation of the linear - scaling regime . </S>",
    "<S> figure  [ fig : scaling3 ] presents the decomposition of the total execution time involved the calculation of the exx using the cri approach for @xmath55 au . </S>",
    "<S> as it would be expected , most of the time is spent on the accumulation in the temporary matrices @xmath44 and @xmath37 , and the poisson solver . </S>",
    "<S> evaluation of the support functions on the cubic grid do not impact to much on timings as far as the reduced overlap space technique is considered ( see appendix ) .    the _ post_-exx accuracy with respect to @xmath23 is given in fig .  [ fig : scaling4 ] for the cluster ( h@xmath49o)@xmath56 using the `` boxkite '' structure,@xcite which is characterized by an edge length around 25.5 au . </S>",
    "<S> because in the present study calculated exx energy is not variational with respect to @xmath23 , we do not expect a monotonic behavior for the plotted convergence profiles on fig .  </S>",
    "<S> [ fig : scaling4 ] , where an accuracy below 1 mha is found for @xmath57 . </S>",
    "<S> this can be compared to the density matrix convergence of 10@xmath58 ha obtained at @xmath59 au . as a result , the price to paid for the fast computation of exchange energy using the cri algorithm is the reduction of the accuracy , which in our case is acceptable considering the size of the system . it should be mentioned that the constant exchange cutoff used in the 3-index loop of fig .  [ </S>",
    "<S> fig : algoexx ] can be different at the three stages . </S>",
    "<S> this will allow acceleration of the convergence without significantly affecting the efficiency . </S>",
    "<S> this linear scaling approach will scale in the same way as the other procedures in conquest , opening the way to efficient exact exchange calculations on 100,000 + atoms .     </S>",
    "<S> for the cluster ( h@xmath49o)@xmath56 . </S>",
    "<S> error is given with respect to the exact calculation.[fig : scaling4],scaledwidth=48.0% ]    finally , in this work we have shown that we are able to circumvent the @xmath40 scaling inferred by the standard calculation of exchange without any approximation . even if the non - local nature of the exx interaction requires a larger range compared to standard @xmath1 dft implementation </S>",
    "<S> , the linear - scaling regime is observable for a fair efficiency / accuracy ratio . in our case , computation time </S>",
    "<S> can be further reduced the fact that fft - based poisson solvers are easily parallelizable along with a judicious choice of the exx matrix range .    </S>",
    "<S> l.a.t . was supported by the bbsrc grant bb / h024217/1 , `` linear scaling density functional theory for biochemistry '' . </S>",
    "<S> the authors are grateful to l. tong , m. j. gillan and m. toyoda for useful discussions . </S>"
  ]
}