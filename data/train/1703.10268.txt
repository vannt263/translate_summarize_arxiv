{
  "article_text": [
    "let @xmath18 denote the vertex set of a graph @xmath4 , @xmath19 denote the edge set of @xmath4 , and @xmath20 . also , if @xmath21 , then @xmath22 is the neighborhood of @xmath23 and @xmath24 .",
    "if @xmath21 and @xmath25 then for shortness we will write @xmath26 to denote @xmath27 . for @xmath28 , @xmath29 denotes the falling factorial @xmath30 .",
    "the first turn - type result for nonhamiltonian graphs was due to ore  @xcite :    [ ore ] if @xmath4 is a nonhamiltonian graph on @xmath5 vertices , then @xmath31 .",
    "this bound is achieved only for the @xmath5-vertex graph obtained from the complete graph @xmath32 by adding a vertex of degree @xmath33 .",
    "erds  @xcite refined the bound in terms of the minimum degree of the graph :    [ erdos ] let @xmath0 be integers with @xmath1 , and set @xmath2 . if @xmath4 is a nonhamiltonian graph on @xmath5 vertices with minimum degree @xmath6 , then @xmath34 this bound is sharp for all @xmath35 .    to show the sharpness of the bound , for @xmath36 with @xmath37 , consider",
    "the graph @xmath8 obtained from a copy of @xmath38 , say with vertex set @xmath39 , by adding @xmath11 vertices of degree @xmath11 each of which is adjacent to the same @xmath11 vertices in @xmath39 .",
    "an example of @xmath40 is on the left of fig  [ fig0 ] .",
    "[ fig0 ]   ( left ) and @xmath41 ( right).,title=\"fig : \" ]   ( left ) and @xmath41 ( right).,title=\"fig : \" ]    by construction , @xmath8 has minimum degree @xmath11 , is nonhamiltonian , and @xmath42 .",
    "elementary calculation shows that @xmath43 in the range @xmath35 if and only if @xmath44 and @xmath5 is odd or @xmath45 and @xmath5 is even .",
    "hence there exists a @xmath46 such that @xmath47 where @xmath48 if @xmath5 is odd , and @xmath49 if @xmath5 is even .",
    "therefore @xmath8 is an extremal example of theorem [ erdos ] when @xmath50 and @xmath51 when @xmath52 .    in  @xcite and independently in  @xcite a stability theorem for nonhamiltonian graphs with prescribed minimum degree was proved .",
    "let @xmath53 denote the edge - disjoint union of @xmath38 and @xmath54 sharing a single vertex .",
    "an example of @xmath41 is on the right of fig  [ fig0 ] .",
    "[ oldma ] let @xmath55 and @xmath56 .",
    "suppose that @xmath4 is an @xmath5-vertex nonhamiltonian graph with minimum degree @xmath6 such that @xmath57 then @xmath4 is a subgraph of either @xmath8 or @xmath53 .",
    "one of the main results of this paper shows that when @xmath5 is large enough with respect to @xmath11 and @xmath58 , @xmath8 not only has the most edges among @xmath5-vertex nonhamiltonian graphs with minimum degree at least @xmath11 , but also has the most copies of _ any _ @xmath58-vertex graph .",
    "this is an instance of a generalization of the turn problem called _ subgraph density problem _ : for @xmath59 and graphs @xmath60 and @xmath61 , let @xmath62 denote the maximum possible number of ( unlabeled ) copies of @xmath60 in an @xmath5-vertex @xmath61-free graph .",
    "when @xmath63 , we have the usual extremal number @xmath64 .",
    "some notable results on the function @xmath62 for various combinations of @xmath60 and @xmath61 were obtained in  @xcite . in particular ,",
    "erds  @xcite determined @xmath65 , bollob ' as and gyri  @xcite found the order of magnitude of @xmath66 , alon and shikhelman  @xcite presented a series of bounds on @xmath62 for different classes of @xmath60 and @xmath61 .    in this paper , we study the maximum number of copies of @xmath60 in nonhamiltonian @xmath5-vertex graphs , i.e. @xmath67 . for two graphs @xmath4 and @xmath60 , let @xmath68 denote the number of _ labeled _ copies of @xmath60 that are subgraphs of @xmath4 , i.e. , the number of injections @xmath69 such that for each @xmath70 , @xmath71 . since for every @xmath60 and @xmath61 , @xmath72 is the maximum of @xmath68 over the @xmath5-vertex graphs @xmath4 not containing @xmath61 , some of our results are in the language of labeled copies of @xmath60 in @xmath4 . for @xmath73 ,",
    "let @xmath74 denote the number of unlabeled copies of @xmath16 s in @xmath4 .",
    "since @xmath75 , we have @xmath76 .",
    "as an extension of theorem [ erdos ] , we show that for each fixed graph @xmath12 and any @xmath11 , if @xmath5 is large enough with respect to @xmath77 and @xmath11 , then among all @xmath5-vertex nonhamiltonian graphs with minimum degree at least @xmath11 , @xmath8 contains the maximum number of copies of @xmath12 .",
    "[ sub]for every graph @xmath12 with @xmath78 , any @xmath79 , and any @xmath80 , if @xmath4 is an @xmath5-vertex nonhamiltonian graph with minimum degree @xmath6 , then @xmath81 .",
    "on the other hand , if @xmath12 is a star @xmath82 and @xmath83 , then @xmath8 does not maximize @xmath84 . at the end of section  [ gen ]",
    "we show that in this case , @xmath85 .",
    "so , the bound on @xmath86 in theorem  [ sub ] has the right order of magnitude when @xmath87 .",
    "an immediate corollary of theorem  [ sub ] is the following generalization of theorem  [ ore ]    [ subo ] for every graph @xmath12 with @xmath78 and any @xmath88 , if @xmath4 is an @xmath5-vertex nonhamiltonian graph , then @xmath89 .",
    "we consider the case that @xmath12 is a clique in more detail . for @xmath90 , define on the interval @xmath91 $ ] the function @xmath92    we use the convention that for @xmath93 , @xmath94 , @xmath95 is the polynomial @xmath96 if @xmath97 and @xmath98 otherwise .    by considering the second derivative",
    ", one can check that for any fixed @xmath17 and @xmath5 , as a function of @xmath99 , @xmath100 is convex on @xmath91 $ ] , hence it attains its maximum at one of the endpoints , @xmath101 or @xmath102 .",
    "when @xmath103 , @xmath104 .",
    "we prove the following generalization of theorem [ erdos ] .",
    "[ erdos_k ] let @xmath105 be integers with @xmath1 and @xmath106 . if @xmath4 is a nonhamiltonian graph on @xmath5 vertices with minimum degree @xmath6 , then the number @xmath74 of @xmath17-cliques in @xmath4 satisfies @xmath107    again , graphs @xmath8 and @xmath108 are sharpness examples for the theorem .    finally , we present a stability version of theorem [ erdos_k ] . to state the result",
    ", we first define the family of extremal graphs .    fix @xmath109 .",
    "in addition to graphs @xmath8 and @xmath53 defined above , define @xmath110 : @xmath111 , where @xmath39 induces a complete graph on @xmath112 vertices , @xmath113 is a set of @xmath114 vertices that induce exactly one edge , and there exists a set of vertices @xmath115 such that for all @xmath116 , @xmath117 .",
    "note that contracting the edge in @xmath118 $ ] yields @xmath119 .",
    "these graphs are illustrated in fig .",
    "[ fig1 ]    [ fig1 ]   ( left ) , @xmath53 ( center ) , and @xmath110 ( right ) , where shaded background indicates a complete graph.,title=\"fig : \" ]   ( left ) , @xmath53 ( center ) , and @xmath110 ( right ) , where shaded background indicates a complete graph.,title=\"fig : \" ]   ( left ) , @xmath53 ( center ) , and @xmath110 ( right ) , where shaded background indicates a complete graph.,title=\"fig : \" ]    we also have two more extremal graphs for the cases @xmath120 or @xmath121 .",
    "define the nonhamiltonian @xmath5-vertex graph @xmath122 with minimum degree @xmath123 as follows : @xmath124 where @xmath39 induces a clique or order @xmath125 , @xmath126 is an independent set of order @xmath127 , and there exists @xmath128 such that @xmath129 for @xmath130 ( see the graph on the left in fig .  3 ) .    the nonhamiltonian @xmath5-vertex graph @xmath131 with minimum degree @xmath127 has vertex set @xmath132 , where @xmath39 induces a clique of order @xmath133",
    ", @xmath113 induces a perfect matching on 4 vertices , and each of the vertices in @xmath113 is adjacent to the same two vertices in @xmath39 ( see the graph on the right in fig .  3 ) .",
    "[ fig3 ]   ( left ) and @xmath134 ( right).,title=\"fig:\",scaledwidth=15.0% ]   ( left ) and @xmath134 ( right).,title=\"fig:\",scaledwidth=15.0% ]    our stability result is the following :    [ newma ] let @xmath55 and @xmath135 .",
    "suppose that @xmath4 is an @xmath5-vertex nonhamiltonian graph with minimum degree @xmath6 such that there exists @xmath106 for which @xmath136 let @xmath137 .",
    "+ ( i ) if @xmath138 , then @xmath4 is a subgraph of @xmath122 or of a graph in @xmath139 ; + ( ii ) if @xmath140 , then @xmath4 is a subgraph of @xmath131 or of a graph in @xmath141 ; + ( iii ) if @xmath142 or @xmath143 , then @xmath4 is a subgraph of a graph in @xmath144 .",
    "the result is sharp because @xmath145 has @xmath146 copies of @xmath16 , minimum degree @xmath147 , is nonhamiltonian and is not contained in any graph in @xmath148 .",
    "the outline for the rest of the paper is as follows : in section 3 we present some structural results for graphs that are edge - maximal nonhamiltonian to be used in the proofs of the main theorems , in section 4 we prove theorem [ sub ] , in section 5 we prove theorem [ erdos_k ] and give a cliques version of theorem [ oldma ] , and in section 6 we prove theorem [ newma ] .",
    "we will use a classical theorem of psa ( usually stated as its contrapositive ) .",
    "[ posa ] let @xmath55 .",
    "if @xmath4 is a nonhamiltonian @xmath5-vertex graph , then there exists @xmath149 such that @xmath4 has a set of @xmath17 vertices with degree at most @xmath17 .",
    "call a graph @xmath4 _ saturated _ if @xmath4 is nonhamiltonian but for each @xmath150 , @xmath151 has a hamiltonian cycle .",
    "ore s proof @xcite of dirac s theorem  @xcite yields that @xmath152 _ for every @xmath5-vertex saturated graph @xmath4 and for each @xmath150 .",
    "_    we will also need two structural results for saturated graphs which are easy extensions of lemmas 6 and 7 in @xcite .",
    "[ g - d ] let @xmath4 be a saturated @xmath5-vertex graph with @xmath153 for any @xmath154 . then for some @xmath155",
    ", @xmath18 contains a subset @xmath156 of @xmath157 vertices of degree at most @xmath157 such that @xmath158 is a complete graph .",
    "since @xmath4 is nonhamiltonian , by theorem  [ posa ] , there exists some @xmath155 such that @xmath4 has @xmath157 vertices with degree at most @xmath157 .",
    "pick the maximum such @xmath157 , and let @xmath156 be the set of the vertices with degree at most @xmath157 . since @xmath159 , @xmath160 .",
    "so , by the maximality of @xmath157 , @xmath161 .",
    "suppose there exist @xmath162 such that @xmath163 . among all such pairs , choose @xmath99 and @xmath164 with the maximum @xmath165 .",
    "since @xmath166 , @xmath167 .",
    "let @xmath168 and @xmath169 . by  , @xmath170 so @xmath171 is a set of @xmath172 vertices of degree at most @xmath172 . since @xmath173 , @xmath174",
    "thus by the maximality of @xmath157 , we get @xmath175 .",
    "equivalently , @xmath176 . for all @xmath177 , either @xmath178 where @xmath179 , or @xmath180 , and so @xmath181 .",
    "now we count the number of @xmath17-cliques in @xmath4 : among @xmath182 , there are at most @xmath183 @xmath17-cliques .",
    "also , each vertex in @xmath171 can be in at most @xmath184 @xmath17-cliques .",
    "therefore @xmath185 , a contradiction .",
    "also , repeating the proof of lemma 7 in @xcite gives the following lemma .",
    "[ hnd ] under the conditions of lemma [ g - d ] , if @xmath186 , then @xmath187 or @xmath188 .",
    "in order to prove theorem [ sub ] , we first show that for any fixed graph @xmath12 and any @xmath11 , of the two extremal graphs of lemma [ hnd ] , if @xmath5 is large then @xmath8 has at least as many copies of @xmath12 as @xmath53 .    [ subk]for any @xmath189 with @xmath190 and any graph @xmath12 with @xmath191 we have @xmath192 .",
    "fix @xmath12 and @xmath193 .",
    "let @xmath194 where @xmath39 and @xmath113 are cliques of order @xmath195 and @xmath114 respectively and @xmath196 , the cut vertex of @xmath53 . also , let @xmath156 denote the independent set of order @xmath11 in @xmath8 .",
    "we may assume @xmath197 , because @xmath198 . if @xmath99 is an isolated vertex of @xmath12 then for any @xmath5-vertex graph @xmath4 we have @xmath199 .",
    "so it is enough to prove the case @xmath200 , and we may also assume @xmath201 .    because both @xmath202 $ ] and @xmath203 are cliques of order @xmath195 , the number of embeddings of @xmath12 into @xmath202 $ ] is the same as the number of embeddings of @xmath12 into @xmath204 .",
    "so it remains to compare only the number of embeddings in @xmath205 such that @xmath206 intersects @xmath207 to the number of embeddings in @xmath208 such that @xmath209 intersects @xmath210 .",
    "let @xmath211 be a partition of the vertex set @xmath212 , @xmath213 .",
    "define the following classes of @xmath214 and @xmath215@xmath216@xmath217 such that @xmath218 intersects @xmath219 , @xmath220 , and @xmath221 , @xmath216@xmath222 such that @xmath223 intersects @xmath156 , @xmath224 , and @xmath225 . by these definitions , if @xmath226 then @xmath227 , and @xmath228 .",
    "also @xmath229 .",
    "we claim that for every @xmath230 , @xmath231 will prove the lemma . if @xmath232 , then   obviously holds .",
    "so from now on , we consider the cases when @xmath233 is not empty , implying @xmath234 .",
    "* case 1 * : there is an @xmath12-edge joining @xmath235 and @xmath236 .",
    "so there is a vertex @xmath237 with @xmath238 .",
    "then for every mapping @xmath239 , the vertex @xmath23 must be mapped to @xmath240 in @xmath53 , @xmath241 .",
    "so this vertex @xmath23 is uniquely determined by @xmath236 .",
    "also , @xmath242 implies @xmath243 .",
    "the rest of @xmath236 can be mapped arbitrarily to @xmath244 and @xmath245 can be mapped arbitrarily to @xmath246 .",
    "we obtained that @xmath247 .",
    "we make a lower bound for @xmath248 as follows .",
    "we define a @xmath249 by the following procedure .",
    "let @xmath250 ( there are @xmath11 possibilities ) , then map some vertex of @xmath251 to a vertex @xmath252 ( there are @xmath253 possibilities ) .",
    "since @xmath254 forms a clique of order @xmath114 we may embed the rest of @xmath236 into @xmath255 in @xmath256 ways and finish embedding of @xmath12 into @xmath8 by arbitrarily placing the vertices of @xmath235 to @xmath257 .",
    "we obtained that @xmath258 .",
    "since @xmath243 we have that @xmath259    * case 2 * : @xmath236 and @xmath260 are not connected in @xmath12 .",
    "we may assume @xmath261 since @xmath236 is a union of components with @xmath262 .",
    "in @xmath53 there are at exactly @xmath263 ways to embed @xmath12 into @xmath113 so that only @xmath236 is mapped into @xmath113 and @xmath235 goes to @xmath246 , i.e. , @xmath264 .",
    "we make a lower bound for @xmath248 as follows .",
    "we define a @xmath249 by the following procedure .",
    "select any vertex @xmath237 and map it to some vertex in @xmath156 ( there are @xmath265 possibilities ) , then map @xmath251 into @xmath266 ( there are @xmath267 possibilities ) and finish embedding of @xmath12 into @xmath8 by arbitrarily placing the vertices of @xmath235 to @xmath257 .",
    "we obtained that @xmath268 .",
    "we have @xmath269    we are now ready to prove theorem  [ sub ] .",
    "* theorem [ sub]*. _ for every graph @xmath12 with @xmath78 , any @xmath79 , and any @xmath80 , if @xmath4 is an @xmath5-vertex nonhamiltonian graph with minimum degree @xmath6 , then @xmath81 .",
    "_    let @xmath270 .",
    "fix a graph @xmath12 with @xmath271 ( if @xmath272 , then either @xmath273 or @xmath274 ) .",
    "the case where @xmath4 has isolated vertices can be handled by induction on the number of isolated vertices , hence we may assume each vertex has degree at least 1 .",
    "set @xmath275 fix a nonhamiltonian graph @xmath4 with @xmath276 and @xmath6 such that @xmath277 .",
    "we may assume that @xmath4 is saturated , as the number of copies of @xmath12 can only increase when we add edges to @xmath4 .    because @xmath278 by ( [ alli ] ) , @xmath279 so , @xmath280 .",
    "after mapping edge @xmath281 of @xmath12 to an edge of @xmath4 ( in two labeled ways ) , we obtain the loose upper bound , @xmath282therefore @xmath283 by psa s theorem ( theorem [ posa ] ) , there exists some @xmath284 such that @xmath4 contains a set @xmath285 or @xmath157 vertices with degree at most @xmath157 .",
    "furthermore by ( [ eps ] ) , @xmath286 .",
    "so by integrality , @xmath287 . if @xmath288 , then by lemma [ hnd ] , either @xmath289 or @xmath290 . by lemma  [ subk ] and ( [ alli ] ) , @xmath289 , a contradiction .",
    "so we have @xmath291 .",
    "let @xmath292 denote the family of all nonempty independent sets in @xmath12 .",
    "for @xmath293 , let @xmath294 and @xmath295 . since @xmath12 has no isolated vertices , @xmath296 and so @xmath297 for each @xmath293 .",
    "let @xmath298 denote the set of embeddings @xmath299 such that @xmath300 and @xmath301 is a maximum independent subset of @xmath302 .",
    "note that @xmath303 is not necessarily independent in @xmath4 .",
    "we show that @xmath304 ways to choose @xmath300 .",
    "after that , since each vertex in @xmath285 has at most @xmath157 neighbors in @xmath4 , there are at most @xmath305 ways to embed @xmath306 into @xmath4 . by the maximality of @xmath301 , all vertices of @xmath307",
    "should be mapped to @xmath308 .",
    "there are at most @xmath309 to do it .",
    "hence @xmath310 .",
    "since @xmath311 , this implies  .",
    "since each @xmath299 with @xmath312 belongs to @xmath298 for some nonempty @xmath293 ,  implies @xmath313    hence @xmath314    given fixed @xmath315 , we claim that the real function @xmath316 is convex for @xmath317 .    indeed , the first term @xmath318 is a product of @xmath58 linear terms in each of which @xmath157 has a negative coefficient ( note that the @xmath319 term cancels out with a factor of @xmath320 in @xmath321 ) .",
    "applying product rule , the first derivative @xmath322 is a sum of @xmath58 products , each with @xmath323 linear terms . for @xmath324 ,",
    "each of these products is negative , thus @xmath325 . finally , applying product rule again , @xmath326 is the sum of @xmath327 products . for @xmath324",
    "each of the products is positive , thus @xmath328 .    similarly , the second factor of the second term ( as a real function of @xmath157 , of the form @xmath329 ) is convex for @xmath330 .",
    "we conclude that in the interval @xmath331 $ ] the function @xmath316 takes its maximum either at one of the endpoints @xmath332 or @xmath333 .",
    "we claim that @xmath334 at both end points .    in case of @xmath335",
    "the first factor of the first term equals @xmath336 . to get an upper bound for the first factor of the second term one can use the inequality",
    "@xmath337 which holds for any number of non - negative @xmath338 s if @xmath339 .",
    "because @xmath340 by ( [ alli ] ) , we obtain that @xmath341 here we used that @xmath342 and @xmath343 by ( [ alli ] ) , @xmath201 , and @xmath344 .",
    "to bound @xmath316 for other values of @xmath157 , let us use @xmath345 ( true for all @xmath99 ) .",
    "we get @xmath346 when @xmath347 , @xmath201 , and @xmath348 by ( [ alli ] ) , the first term is at most @xmath349 .",
    "moreover , for @xmath350 ( [ alli ] ) ( therefore @xmath351 ) we get that @xmath352 is maximized when @xmath58 is maximized , i.e. , when @xmath353 .",
    "the whole term is at most @xmath354 , so in this range , @xmath355 .    by the convexity of @xmath316",
    ", we have @xmath356 .",
    "when @xmath12 is a star , then it is easy to determine @xmath357 for all @xmath5 .",
    "[ cl : star ] suppose @xmath358 with @xmath78 , and @xmath359 and @xmath11 are integers with @xmath360 . if @xmath4 is an @xmath5-vertex nonhamiltonian graph with minimum degree @xmath6 , then @xmath361 and equality holds if and only if @xmath362 .",
    "the number of copies of stars in a graph @xmath4 depends only on the degree sequence of the graph : if a vertex @xmath23 of a graph @xmath4 has degree @xmath363 , then there are @xmath364 labeled copies of @xmath12 in @xmath4 where @xmath23 is the center vertex .",
    "we have @xmath365 since @xmath4 is nonhamiltonian , psa s theorem yields an @xmath366 , and an @xmath157-set @xmath367 such that @xmath368 for all @xmath369 .",
    "take the minimum such @xmath157 , then there exists a vertex @xmath369 with @xmath370 .",
    "we may also suppose that @xmath4 is edge - maximal nonhamiltonian , so ore s condition   holds .",
    "it implies that @xmath371 for all @xmath372 .",
    "altogether we obtain that @xmath4 has @xmath157 vertices of degree at most @xmath157 , at least @xmath373 vertices ( those in @xmath374 ) of degree at most @xmath375 .",
    "this implies that the right hand side of   is at most @xmath376 ( here equality holds only if @xmath377 ) .",
    "note that @xmath378 $ ] .",
    "since for given @xmath5 and @xmath58 the function @xmath379 is strictly convex in @xmath157 , it takes its maximum at one of the endpoints of the interval .",
    "[ rem13 ] as it was mentioned in section  [ res ] , @xmath380 is the right order for @xmath86 when @xmath87 .    to see this , fix @xmath79 and",
    "let @xmath12 be the star on @xmath201 vertices .",
    "if @xmath381 , @xmath359 and @xmath382 , then @xmath108 contains more copies of @xmath12 than @xmath8 does , the maximum in   is reached for @xmath383 .",
    "we present the calculation below only for @xmath384 , the case @xmath385 can be checked by hand by plugging @xmath5 into the first line of the formula below .",
    "we can proceed as follows .",
    "in general , it is difficult to calculate the exact value of @xmath387 for a fixed graph @xmath12 .",
    "however , when @xmath388 , we have @xmath389 . recall theorem [ erdos_k ] :",
    "_ let @xmath105 be integers with @xmath1 and @xmath106 .",
    "if @xmath4 is a nonhamiltonian graph on @xmath5 vertices with minimum degree @xmath6 , then @xmath390 _    _ proof of theorem [ erdos_k]_. by theorem  [ posa ] , because @xmath4 is nonhamiltonian , there exists an @xmath391 such that @xmath4 has @xmath157 vertices of degree at most @xmath157 .",
    "denote this set of vertices by @xmath156 .",
    "then @xmath392 , and every vertex in @xmath156 is contained in at most @xmath393 copies of @xmath16 .",
    "hence @xmath394 .",
    "the theorem follows from the convexity of @xmath100 .",
    "our older stability theorem ( theorem [ oldma ] ) also translates into the the language of cliques , giving a stability theorem for theorem [ erdos_k ] :    [ oldma2 ] let @xmath55 , and @xmath56 .",
    "suppose that @xmath4 is an @xmath5-vertex nonhamiltonian graph with minimum degree @xmath6 and there exists a @xmath106 such that @xmath395 then @xmath4 is a subgraph of either @xmath8 or @xmath53 .",
    "take an edge - maximum counterexample @xmath4 ( so we may assume @xmath4 is saturated ) . by lemma [ g - d ]",
    ", @xmath4 has a set @xmath156 of @xmath396 vertices such that @xmath397 is a complete graph . if @xmath291 , then @xmath398 .",
    "thus @xmath288 , and we may apply lemma [ hnd ] .",
    "one can try to refine theorem [ oldma ] in the following direction : what happens when we consider @xmath5-vertex nonhamiltonian graphs with minimum degree at least @xmath11 and less than @xmath399 but more than @xmath400 edges ?",
    "note that for @xmath401 , @xmath402 which is greater than @xmath5 .",
    "theorem [ newma ] answers the question above in a more general form  in terms of @xmath403-cliques instead of edges .",
    "in other words , we classify all @xmath5-vertex nonhamiltonian graphs with more than @xmath404 copies of @xmath405 .    as in lemma",
    "[ oldma2 ] , such @xmath4 can be a subgraph of @xmath8 or @xmath53 . also , @xmath4 can be a subgraph of @xmath406 or @xmath407 .",
    "recall the graphs @xmath408 and @xmath134 defined in the first two sections of this paper and the statement of theorem [ oldma ] :    [ fig7 ]   and @xmath134.,title=\"fig : \" ]   and @xmath134.,title=\"fig : \" ]   and @xmath134.,title=\"fig : \" ]   and @xmath134.,title=\"fig : \" ]   and @xmath134.,title=\"fig : \" ]    * theorem [ newma]*.    _ let @xmath55 and @xmath135 .",
    "suppose that @xmath4 is an @xmath5-vertex nonhamiltonian graph with minimum degree @xmath6 such that exists a @xmath106 for which @xmath409 let @xmath137 .",
    "_    \\(i ) if @xmath138 , then @xmath4 is a subgraph of @xmath122 or of a graph in @xmath139 ; + ( ii ) if @xmath140 , then @xmath4 is a subgraph of @xmath131 or of a graph in @xmath141 ; + ( iii ) if @xmath142 or @xmath143 , then @xmath4 is a subgraph of a graph in @xmath144 .",
    "suppose @xmath4 is a counterexample to theorem [ newma ] with the most edges",
    ". then @xmath4 is saturated . in particular",
    ", degree condition   holds for @xmath4 .",
    "so by lemma [ g - d ] , there exists an @xmath410 such that @xmath18 contains a subset @xmath156 of @xmath157 vertices of degree at most @xmath157 and @xmath158 is a complete graph .    if @xmath411 , then because @xmath100 is convex , @xmath412 . therefore either @xmath413 or @xmath332 . in the case",
    "that @xmath413 ( and so @xmath186 ) , lemma [ hnd ] implies that @xmath414 .",
    "so we may assume that @xmath332 .    if @xmath415 , then we simply apply theorem  [ oldma ] with @xmath114 in place of @xmath11 and get @xmath416 or @xmath417 .",
    "so , from now on we may assume @xmath418    now   implies that our theorem holds for @xmath142 , since each graph with minimum degree exactly @xmath33 is a subgraph of @xmath419 .",
    "so , below @xmath420 .",
    "let @xmath421 .",
    "the next claim will be used many times throughout the proof .",
    "[ le0 ] ( a ) if there exists a vertex @xmath422 such that @xmath423 , then @xmath424 .",
    "+ ( b ) if there exists a vertex @xmath425 such that @xmath426 has at least 2 neighbors in @xmath156 , then @xmath426 is adjacent to all vertices in @xmath156 .",
    "if @xmath422 , @xmath423 and some @xmath425 is not adjacent to @xmath23 , then @xmath427 . a contradiction to   proves ( a ) .    similarly , if @xmath425 has at least 2 neighbors in @xmath156 but is not adjacent to some @xmath428 , then @xmath429 , again contradicting  .",
    "define @xmath430 , @xmath431 , and @xmath432 . by lemma  [ le0 ]  ( b ) , each vertex in @xmath433 has at most one neighbor in @xmath156 .",
    "so , for each @xmath428 , call the neighbors of @xmath23 in @xmath433 _ the private neighbors of @xmath23_. we claim that @xmath434 indeed , assume @xmath156 is independent . if there exists a vertex @xmath422 with @xmath423 , then by lemma  [ le0 ]  ( b ) , @xmath424 .",
    "so , because @xmath156 is independent , @xmath416 .",
    "assume now that every vertex @xmath422 has degree @xmath11 , and let @xmath435 .",
    "if @xmath436 , then because each @xmath437 has degree @xmath11 , @xmath438 and @xmath439",
    ". then @xmath416 .",
    "if @xmath440 , then each vertex @xmath441 has at least two private neighbors in @xmath433 ; call these private neighbors @xmath442 and @xmath443 .",
    "the path @xmath444 contains all vertices in @xmath156 and can be extended to a hamiltonian cycle of @xmath4 , a contradiction .",
    "finally , suppose @xmath445 .",
    "then every vertex @xmath441 has exactly one private neighbor .",
    "therefore @xmath446 where @xmath447 is composed of a clique @xmath39 of order @xmath112 and an independent set @xmath448 , and there exists a set @xmath449 of size @xmath450 and distinct vertices @xmath451 such that for @xmath452 , @xmath453 .",
    "graph @xmath447 is illustrated in fig .",
    "[ nf1 ] .",
    "[ nf1 ] .,title=\"fig:\",scaledwidth=25.0% ]    for @xmath138 , we conclude that @xmath454 , as claimed , and for @xmath455 , we get a contradiction since @xmath447 is hamiltonian .",
    "this proves  .",
    "call a vertex @xmath422 _ open _ if it has at least two private neighbors , _ half - open _ if it has exactly one private neighbor , and _ closed _ if it has no private neighbors .",
    "we say that _ paths @xmath456 partition @xmath156 _ , if these paths are vertex - disjoint and @xmath457 .",
    "the idea of the proof is as follows : because @xmath158 is a complete graph , each path with endpoints in @xmath158 that covers all vertices of @xmath156 can be extended to a hamiltonian cycle of @xmath4 .",
    "so such a path does not exist , which implies that too few paths can not partition @xmath156 :    [ paths1 ] if @xmath243 then the minimum number of paths in @xmath458 $ ] partitioning @xmath156 is at least @xmath403 .",
    "suppose @xmath156 can be partitioned into @xmath459 paths @xmath460 in @xmath458 $ ] .",
    "let @xmath461 .",
    "then @xmath462 is a path with endpoints in @xmath463 that covers @xmath156 .",
    "because @xmath463 forms a clique , we can find a @xmath464 - path @xmath465 in @xmath158 that covers @xmath466 .",
    "then @xmath467 is a hamiltonian cycle of @xmath4 , a contradiction .    sometimes , to get a contradiction with lemma  [ paths1 ] we will use our information on vertex degrees in",
    "@xmath458 $ ] :    [ paths ] let @xmath61 be a graph on @xmath157 vertices such that for every nonedge @xmath281 of @xmath61 , @xmath468 for some @xmath58 .",
    "then @xmath469 can be partitioned into a set of at most @xmath58 paths .",
    "in other words , there exist @xmath58 disjoint paths @xmath470 with @xmath471 .",
    "construct the graph @xmath472 by adding a clique @xmath60 of size @xmath58 to @xmath61 so that every vertex of @xmath60 is adjacent to each vertex in @xmath469 .",
    "for each nonedge @xmath473 , @xmath474 by ore s theorem , @xmath472 has a hamiltonian cycle @xmath475 .",
    "then @xmath476 is a set of at most @xmath58 paths in @xmath61 that cover all vertices of @xmath61",
    ".    the next simple fact will be quite useful .",
    "[ open]if @xmath458 $ ] contains an open vertex , then all other vertices are closed .",
    "suppose @xmath458 $ ] has an open vertex @xmath23 and another open or half - open vertex @xmath426 .",
    "let @xmath477 be some private neighbors of @xmath23 in @xmath433 and @xmath478 be a neighbor of @xmath426 in @xmath433 .",
    "by the maximality of @xmath4 , graph @xmath479 has a hamiltonian cycle . in other words",
    ", @xmath4 has a hamiltonian path @xmath480 , where @xmath481 and @xmath482 .",
    "let @xmath483 . since g has no hamiltonian cycle , @xmath484 .    since @xmath485 , we have @xmath486 .",
    "suppose that @xmath487 and @xmath488 .",
    "then @xmath489 , and @xmath490 .",
    "but among the neighbors of @xmath491 and @xmath492 , only @xmath23 is not adjacent to @xmath478 , a contradiction .",
    "now we show that @xmath493 is non - empty and not too large .",
    "[ de0 ] @xmath494 .",
    "suppose @xmath495 .",
    "if @xmath156 has an open vertex @xmath23 , then by lemma  [ open ] , all other vertices are closed . in this case",
    ", @xmath23 is the only vertex of @xmath156 with neighbors outside of @xmath156 , and hence @xmath496 , in which @xmath23 is the cut vertex . also if @xmath156 has at most one half - open vertex @xmath23 , then similarly @xmath496 .",
    "so suppose that @xmath156 contains no open vertices but has two half - open vertices @xmath426 and @xmath23 with private neighbors @xmath497 and @xmath498 respectively .",
    "then @xmath499)\\geq d-1 $ ] . by p ' osa s theorem , if @xmath500 , then @xmath458 $ ] has a hamiltonian @xmath501-path .",
    "this path together with any hamiltonian @xmath502-path in the complete graph @xmath397 and the edges @xmath503 and @xmath504 forms a hamiltonian cycle in @xmath4 , a contradiction .",
    "if @xmath140 , then by dirac s theorem , @xmath458 $ ] has a hamiltonian cycle , i.e. a @xmath505-cycle , say @xmath236 . if we can choose our half - open @xmath23 and @xmath426 consecutive on @xmath236 , then @xmath506 is a hamiltonian @xmath501-path in @xmath458 $ ] , and we finish as in the previous paragraph .",
    "otherwise , we may assume that @xmath507 , where @xmath99 and @xmath164 are closed .",
    "in this case ,",
    "@xmath508}(x ) = d_{g[d]}(y ) = 3 $ ] , thus @xmath509 .",
    "so we again have a hamiltonian @xmath501-path , namely @xmath510 , in @xmath458 $ ] . finally ,",
    "if @xmath138 , then @xmath511 , and @xmath458 $ ] is either a @xmath127-vertex path whose endpoints are half - open or a @xmath127-cycle . in both cases , @xmath458 $ ] again has a hamiltonian path whose ends are half - open .",
    "[ ded ] @xmath512 .",
    "since by  , @xmath513 , we have @xmath514 .",
    "suppose @xmath515 .",
    "* case 1 * : all vertices of @xmath156 have degree @xmath11 .",
    "_ case 1.1 : _ @xmath516",
    ". then @xmath416 .",
    "_ case 1.2 : _",
    "@xmath517 . in this case",
    ", each vertex in graph @xmath458 $ ] has degree @xmath98 or @xmath33 . by  ,",
    "@xmath458 $ ] induces a non - empty matching , possibly with some isolated vertices .",
    "let @xmath518 denote the number of edges in @xmath458 $ ] .",
    "if @xmath519 , then the number of components in @xmath458 $ ] is less than @xmath403 , contradicting lemma  [ paths1 ] .",
    "suppose now @xmath520 , and the edges in the matching are @xmath521 and @xmath522 . then @xmath523 . if @xmath140 , then @xmath524 and @xmath525 ( see fig  3 ( right ) ) .",
    "if @xmath500 , then @xmath458 $ ] has an isolated vertex , say @xmath526 .",
    "this @xmath526 has a private neighbor @xmath527 .",
    "then @xmath528 which is more than the number of components of @xmath458 $ ] and we can construct a path from @xmath529 to @xmath493 visiting all components of @xmath458 $ ] .    finally , suppose @xmath458 $ ] has exactly one edge , say @xmath521 .",
    "recall that @xmath530 .",
    "graph @xmath458 $ ] has @xmath450 isolated vertices , say @xmath531 .",
    "each of @xmath338 for @xmath532 has a private neighbor @xmath533 in @xmath433 .",
    "let @xmath534 .",
    "if @xmath138 , then @xmath535 , @xmath536 and hence @xmath537 .",
    "so in this case the theorem holds for @xmath4 . if @xmath523 , then @xmath4 contains a path @xmath538 from @xmath539 to @xmath540 that covers @xmath156 .",
    "_ case 1.3 : _ @xmath541 . since @xmath542 , @xmath523 .",
    "every vertex in @xmath458 $ ] has degree at most @xmath123 , i.e. , @xmath458 $ ] is a union of paths , isolated vertices , and cycles .",
    "vertex has at least @xmath123 private neighbors in @xmath433 .",
    "each endpoint of a path in @xmath458 $ ] has one private neighbor in @xmath433 .",
    "thus we can find disjoint paths from @xmath433 to @xmath433 that cover all isolated vertices and paths in @xmath458 $ ] and all are disjoint from @xmath493 .",
    "hence if the number @xmath543 of cycles in @xmath458 $ ] is less than @xmath544 , then we have a set of disjoint paths from @xmath545 to @xmath545 that cover @xmath156 ( and this set can be extended to a hamiltonian cycle in @xmath4 ) . since each cycle has at least @xmath127 vertices and @xmath546 , if @xmath547 , then @xmath548 , which is possible only when @xmath549 , i.e. @xmath140 . moreover , then @xmath458=c_3\\cup k_1 $ ] and @xmath550 is a single vertex .",
    "but then @xmath551 .    * case 2 * : there exists a vertex @xmath552 with @xmath553 . by lemma  [ le0 ]",
    "( b ) , @xmath554 , and so @xmath4 has at most one open or half - open vertex .",
    "furthermore , @xmath555    _ case 2.1 : _ @xmath556 . if @xmath240 is not closed , then it has a private neighbor @xmath557 , and the neighborhood of each other vertex of @xmath156 is exactly @xmath493 . in this case , there exists a path from @xmath99 to @xmath493 that covers @xmath156 . if @xmath240 is closed ( i.e. , @xmath439 ) , then @xmath458 $ ] has maximum degree @xmath33 .",
    "therefore @xmath458 $ ] is a matching with at least one edge ( coming from @xmath240 ) plus some isolated vertices .",
    "if this matching has at least @xmath123 edges , then the number of components in @xmath458 $ ] is less than @xmath403 , contradicting lemma  [ paths1 ] . if @xmath458 $ ] has exactly one edge , then @xmath558 .",
    "_ case 2.2 : _ @xmath445 .",
    "if @xmath240 is open , then @xmath508}(v^ * ) = 0 $ ] and by  , each other vertex in @xmath156 has exactly one neighbor in @xmath156 . in particular , @xmath11 is even .",
    "therefore @xmath559 $ ] has @xmath560 components .",
    "when @xmath455 and @xmath11 is even , @xmath561 and we can find a path from @xmath493 to @xmath493 that covers @xmath562 , and extend this path using two neighbors of @xmath240 in @xmath433 to a path from @xmath545 to @xmath545 covering @xmath156 .",
    "suppose @xmath138 , @xmath563 and @xmath564 .",
    "then @xmath565 is a cut vertex separating @xmath566 from the rest of @xmath4 , and hence @xmath567 .",
    "if @xmath240 is half - open , then by  , each other vertex in @xmath156 is closed and hence has exactly one neighbor in @xmath156 .",
    "let @xmath557 be the private neighbor of @xmath240 .",
    "then @xmath458 $ ] is @xmath33-regular and therefore has exactly @xmath568 components , in particular , @xmath11 is odd .",
    "if @xmath197 and is odd , then @xmath569 , and so we can find a path from @xmath99 to @xmath493 that covers @xmath156 .    finally , if @xmath240 is closed , then by  , every vertex of @xmath458 $ ] is closed and has degree @xmath33 or @xmath123 , and @xmath240 has degree @xmath123 in @xmath458 $ ] . then @xmath458 $ ] has at most @xmath570 components , which is less than @xmath403 when @xmath455 . if @xmath120 , then @xmath571 and the unique vertex @xmath565 in @xmath493 is a cut vertex separating @xmath156 from the rest of @xmath4 .",
    "this means @xmath572 .",
    "_ case 2.3 : _",
    "@xmath573 . since @xmath542 , @xmath523 .",
    "if @xmath240 is open , then @xmath508}(v^ * ) = 1 $ ] and by  , each other vertex in @xmath156 is closed and has exactly two neighbors in @xmath156 . but",
    "this is not possible , since the degree sum of the vertices in @xmath458 $ ] must be even . if @xmath240 is half - open with a neighbor @xmath557 , then @xmath458 $ ] is @xmath123-regular . thus @xmath458 $ ]",
    "is a union of cycles and has at most @xmath574 components . when @xmath575 , this is less than @xmath403 , contradicting lemma  [ paths1 ] . if @xmath140 , then @xmath571 and the unique vertex @xmath565 in @xmath493 is a cut vertex separating @xmath156 from the rest of @xmath4 .",
    "this means @xmath576 .",
    "if @xmath240 is closed , then @xmath508}(v^ * ) = 3 $ ] and @xmath499)\\geq 2 $ ] .",
    "so , for any vertices @xmath577 in @xmath458",
    "$ ] , @xmath578}(x ) + d_{g[d]}(y ) \\geq 4 \\geq ( d+1 ) - ( d-2 - 1 ) = |v(g[d])| - ( s-1).\\ ] ] by lemma  [ paths ] , if @xmath243 , then we can partition @xmath458 $ ] into @xmath579 paths @xmath580 .",
    "this would contradict lemma  [ paths1 ] .",
    "so suppose @xmath571 and @xmath140 .",
    "then as in the previous paragraph , @xmath576 .    next we will show that we can not have @xmath581 .",
    "[ de1 ] @xmath582 .",
    "suppose @xmath583 where @xmath584 .",
    "* case 1 : * @xmath458 $ ] has an open vertex @xmath23 . by lemma  [ open ] , every other vertex in @xmath156 is closed .",
    "let @xmath585 - v$ ]",
    ". then @xmath586 and @xmath587 .",
    "in particular , for any @xmath588 , @xmath589 by lemma  [ paths ] , we can find a path from @xmath493 to @xmath493 in @xmath4 containing all of @xmath590 .",
    "because @xmath23 is open , this path can be extended to a path from @xmath545 to @xmath545 including @xmath23 , and then extended to a hamiltonian cycle of @xmath4 .",
    "* case 2 : * @xmath156 has no open vertices and @xmath591 . then @xmath499 ) \\geq k-1 $ ] and again for any @xmath592 , @xmath508}(x ) + d_{g[d]}(y ) \\geq 2k-2 $ ] . for @xmath593 , @xmath594 . since @xmath595 , by lemma  [ paths ] , @xmath458 $ ] can be partitioned into @xmath579 paths , contradicting lemma  [ paths1 ] .",
    "* case 3 * : @xmath156 has no open vertices and @xmath596 .",
    "if there is at most one half - open vertex , then for any nonadjacent vertices @xmath592 , @xmath508}(x ) + d_{g[d]}(y ) \\geq 2 + 3 = 5 \\geq ( d+1 ) - ( d-3 - 1)$ ] , and we are done as in case 2 .",
    "so we may assume @xmath4 has at least 2 half - open vertices .",
    "let @xmath171 be the set of half - open vertices in @xmath156 .",
    "if @xmath597 , let @xmath598 . define a subset @xmath599 as follows : if @xmath600 , then let @xmath601 , otherwise , let @xmath602 .",
    "let @xmath603 be the graph obtained from @xmath458 $ ] by adding a new vertex @xmath529 adjacent to all vertices in @xmath599",
    ". then @xmath604 and @xmath605 .",
    "in particular , for any @xmath606 . by lemma  [ paths ] , @xmath590 can be partitioned into @xmath579 disjoint paths @xmath607 .",
    "we may assume that @xmath608 .",
    "if @xmath529 is an endpoint of @xmath609 , then @xmath156 can also be partitioned into @xmath579 disjoint paths @xmath610 in @xmath458 $ ] , a contradiction to lemma  [ paths1 ] .",
    "otherwise , let @xmath611 where @xmath612 .",
    "since every vertex in @xmath613 is half - open and @xmath614 , we may assume that @xmath615 is half - open and thus has a neighbor @xmath616 .",
    "let @xmath617 .",
    "then @xmath618 is a path in @xmath4 with endpoints in @xmath463 that covers @xmath156 .",
    "now we may finish the proof of theorem [ newma ] . by lemmas",
    "[ de0][de1 ] , @xmath582 , say , @xmath535 . furthermore , by lemma  [ ded ] , @xmath619    * case 1 * : @xmath156 has an open vertex @xmath23 .",
    "then by lemma  [ open ] , every other vertex of @xmath156 is closed . since @xmath571 ,",
    "each @xmath620 has degree @xmath450 in @xmath458 $ ] .",
    "if @xmath23 has no neighbors in @xmath156 , then @xmath458 - v$ ] is a clique of order @xmath11 , and @xmath496 . otherwise , since @xmath500 , by dirac",
    "s theorem , @xmath458-v$ ] has a hamiltonian cycle , say @xmath236 .",
    "using @xmath236 and an edge from @xmath23 to @xmath236 , we obtain a hamiltonian path @xmath621 in @xmath458 $ ] starting with @xmath23 .",
    "let @xmath622 be a neighbor of @xmath23 .",
    "then @xmath623 is a path from @xmath433 to @xmath493 that covers @xmath156 , a contradiction .",
    "* case 2 * : @xmath156 has a half - open vertex but no open vertices .",
    "it is enough to prove that @xmath624 $ has    a hamiltonian path $ p$ starting with a half - open vertex $ v$,}\\ ] ] since such a @xmath621 can be extended to a hamiltonian cycle in @xmath4 through @xmath625 and the private neighbor of @xmath23 . if @xmath626 , then for any @xmath627 , @xmath578}(x ) + d_{g[d]}(y ) \\geq d-2 + d - 2 = 2d-4\\geq d+1 = |v(g[d])|.\\ ] ] hence by ore s theorem , @xmath458 $ ] has a hamiltonian cycle , and hence   holds .",
    "if @xmath628 then by  , @xmath629 .",
    "so @xmath458 $ ] has @xmath630 vertices and minimum degree at least @xmath123 . by lemma  [ paths ] , we can find a hamiltonian path @xmath621 of @xmath458 $ ] , say @xmath631 . if at least one of @xmath632 is half - open or @xmath633 , then   holds .",
    "otherwise , each of @xmath632 has @xmath127 neighbors in @xmath156 , which means @xmath634 . but then @xmath458 $ ] has hamiltonian cycle @xmath635 , and again   holds .    * case 3 * : all vertices in @xmath156 are closed",
    ". then @xmath417 , a contradiction .",
    "this proves the theorem .",
    "* it was shown in section  [ gen ] that the right order of magnitude of @xmath86 in theorem [ sub ] when @xmath87 is @xmath636 .",
    "we can also show this when @xmath637 .",
    "it could be that @xmath636 is the right order of magnitude of @xmath86 for all @xmath11 and @xmath58 .",
    "* is there a graph @xmath12 and positive integers @xmath11 , @xmath5 with @xmath638 and @xmath109 such that for some @xmath5-vertex nonhamiltonian graph @xmath4 with minimum degree at least @xmath11 , @xmath639"
  ],
  "abstract_text": [
    "<S> let @xmath0 be integers with @xmath1 , and set @xmath2 . </S>",
    "<S> erds proved that when @xmath3 , each nonhamiltonian graph @xmath4 on @xmath5 vertices with minimum degree @xmath6 has at most @xmath7 edges . </S>",
    "<S> he also provides a sharpness example @xmath8 for all such pairs @xmath9 . </S>",
    "<S> previously , we showed a stability version of this result : for @xmath5 large enough , every nonhamiltonian graph @xmath4 on @xmath5 vertices with @xmath6 and more than @xmath10 edges is a subgraph of @xmath8 .    in this paper , </S>",
    "<S> we show that not only does the graph @xmath8 maximize the number of edges among nonhamiltonian graphs with @xmath5 vertices and minimum degree at least @xmath11 , but in fact it maximizes the number of copies of any fixed graph @xmath12 when @xmath5 is sufficiently large in comparison with @xmath11 and @xmath13 . </S>",
    "<S> we also show a stronger stability theorem , that is , we classify all nonhamiltonian @xmath5-graphs with @xmath6 and more than @xmath14 edges . </S>",
    "<S> we show this by proving a more general theorem : we describe all such graphs with more than @xmath15 copies of @xmath16 for any @xmath17 . </S>",
    "<S> * mathematics subject classification : * 05c35 , 05c38 . + </S>",
    "<S> * keywords : * subgraph density , hamiltonian cycles , extremal graph theory . </S>"
  ]
}