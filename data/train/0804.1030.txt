{
  "article_text": [
    "we consider the classic problem of estimating the number @xmath0 of species in a population , and , subsequentely , their distribution , from a simple random sample drawn with replacement .",
    "we are interested in the `` small sample '' regime in which it is likely that not all species have been observed . problems of this kind arise in a variety of settings : for example , when sampling fish from a lake or insects in a forest ( see , for instance , shen , chao and lin ( 2003 ) @xcite on how to use estimates of @xmath0 to predict further sampling , or @xcite ) ; or when estimating the size of a particular population ( see @xcite ) ; or when trying to guess how many letters an alphabet or how many specific groups of words a language contains ( see @xcite ) or how many words a writer knows ( see @xcite ) ; or , even , when determining how many different coins were minted by an ancient population ( esty @xcite ) . because of its great interest this has become a classic in probability , and there has been a great number of studies suggesting methods for the estimation of @xmath0 .",
    "see , for instance , @xcite for a review through 1993 , @xcite for some further details and colwell s estimates for software implementing a large number of estimators .",
    "in particular , @xcite calls for some development of the bayesian method for the estimation of @xmath0 , which is the direction that we eventually have taken .    in this paper",
    "we start , in fact , by analyzing one well known estimator of @xmath0 , namely the one by chao and lee ( @xcite ) .",
    "one of our results shows that the estimator can be obtained by reconciling two estimators of the unobserved probability @xmath4 : one being an extended version of laplace s `` add @xmath2 '' ( @xcite ) and the other the estimator by turing and good ( @xcite ) , provided that the normalized interspecies variance @xmath1 is interpreted as the inverse of the @xmath2 .",
    "then we proceed by developing simultaneous methods for estimating @xmath0 and @xmath2 ( or @xmath1 , which is the same ) .    by such methods we improve on the original chao - lee estimation , but the estimators we obtain are shown by simulations to have some serious defects .",
    "it is for this reason that we perform a more fundamental analysis of the problem by means of a bayesian approach .",
    "this is based on a dirichlet prior with parameter @xmath2 on the probabilities of @xmath0 species ( see @xcite , @xcite , @xcite , and @xcite for an historical description ) ; the parameter turns out to be the same as the one in laplace s method .",
    "the simultaneous estimation that we develop now takes into account a posterior second moment of the random species probabilities compared to the classical good toulmin estimator for the same quantity ( see @xcite ) .",
    "let us mention that the empirical bayesian approach used here is different from that of existing results in the literature .",
    "the method in @xcite is , in fact , limited to uniform species distributions . on the other hand , the general bayesian approach in boender and rinnoy kan ( 1987 ) @xcite starts from a prior distribution of @xmath0 and , conditionally to @xmath0 , a uniform or dirichlet(@xmath2 ) prior on the species probability , but then introduces a ( level iii ) prior on @xmath2 itself ( as suggested in @xcite ) which in turn requires the introduction of a further parameter ( boender and rinnoy kan ( 1987 ) @xcite , formulae ( 10 ) and ( 11 ) ) , with then no analytical expression for the posteriors . in the end , this direction seems to include several undetermined choices ( the prior on @xmath0 and the extra parameter at level iii ) and no simple analytical expression of the estimators .    at the end of the paper we present some numerical tests . due to the inherent difficulty in finding fully published data for this estimation we resort to simulations and real tests on discovering the size of an alphabet .",
    "the tests seem to indicate that the new estimator of @xmath0 is more flexibile than existing ones and thus preferable , in the sense that the performance of all estimators seem to greatly depend on the normalized variance @xmath1 , and the new estimator is the only one able to perform rather well for all values of @xmath5 $ ] . in our method ,",
    "the only constraint is that @xmath6 , which is @xmath7 , which is imposed in order to ensure convergence of the prior ; this , in turn , imposes a mild limitation on the populations to which the method can be applied , since @xmath1 can , for some peculiar population , exceed @xmath8 ; on the other hand , such populations are likely to be quite unusual and , in addition , all other existing estimators seem also to fail on samples taken from them .",
    "in section 2 we review in detail some known estimation methods of interest in deriving our results ; in section 3 we derive some relations between known estimators and our first improvements ; in section 4 we develop the bayesian method and define our final estimator ; in section 5 we give estimates of the species probabilities from , for both the observed and the unobserved ones ; from these , we indicate how to generate confidence intervals for @xmath0 by means of resampling ; finally , in section 6 we present some simulations revealing a rather good performance of our new estimator and also very adequate results of the confidence intervals .",
    "all detailed mathematical proof are deferred to the appendix .",
    "we start with some notation .",
    "assume that the population from which the sample is drawn has a total of @xmath0 species ( which we sometimes will call states ) having proportions @xmath9 ; and that in a sample @xmath10 of size @xmath11 there are @xmath12 observed species . for @xmath13 , let @xmath14 be the number of observations of the species @xmath15 in the sample , so that @xmath16 we assume that the @xmath14 s are given one of the possible orders in which @xmath17 and @xmath18 for @xmath19 .",
    "also , for @xmath20 , let @xmath21 be the prevalence of @xmath22 , which is to say the number of species observed exactly @xmath22 times , so that @xmath23 next , let @xmath24 be the empirical frequency of species @xmath15 , so that @xmath25 is the coverage , i.e , the total probability of the observed species , and @xmath26 is the unobserved probability .",
    "we are interested in the estimation of @xmath0 from the prevalences .",
    "the estimation of @xmath4 has also been studied intensively ( see , for instance , @xcite and @xcite ) .",
    "in fact , it is possible to turn the estimation of @xmath4 into a simplified version of our original problem by assuming that there are @xmath27 species , the @xmath12 observed ones and the `` new '' species with probability @xmath4 ; the main issue becomes then the estimation of the probabilities of the various species and especially for the new one .",
    "for this and other reasons that we shall see , the estimations of @xmath0 and @xmath4 are closely intertwined ( even the title of @xcite points to this relation )",
    ".    the first attempt to estimate @xmath4 can be extracted from laplace ( see @xcite and @xcite ) who suggested an `` add - one '' estimator : this consists in adding one to the number of observations of each species plus an additional one for the `` unobserved '' species . in an extended version , which can be named `` add @xmath2 ''",
    ", one can add some positive value @xmath2 to each species number of observations ( including the unobserved one ) : an estimate of the probability of each observed species @xmath15 is then @xmath28 and the estimate of the unobserved probability becomes @xmath29    with a seemingly completely different method , turing and good ( see @xcite ) proposed another estimator of @xmath4 .",
    "recall that @xmath30 is the number of species observed exactly once and @xmath11 the size of the sample ; then the turing - good estimator for @xmath4 is some minor modification of : @xmath31 a plausible rationale for this estimator is that while for species observed at least twice the empirical frequency is already becoming stable and very likely close to the corresponding probability , species observed only once are likely to be randomly selected representatives of the collection of the yet unobserved species .",
    "a more sound mathematical derivation is in good ( @xcite ) , in which also a `` smoothing '' of the @xmath32 s is proposed .",
    "other methods to estimate @xmath4 have been developed , and in particular we refer to @xcite for a bayesian method based on the general class of gibbs - type priors ( see also @xcite and the other references in @xcite for the definition and properties of such priors ) .",
    "this class contains several known families of priors as particular cases and each such family is based on one or more parameters , which need to be further estimated . in @xcite , for instance , a maximum likelihood estimator is used .",
    "another recent advance appears in orlitsky et al ( @xcite ) , in which a quantity is introduced , called attenuation , that measures the effectiveness of the estimation of @xmath4 as the sample gets larger ; the performance of an estimator is compared to the maximum probability of the observed prevalences and asymptotically very good estimators are determined .",
    "we are going to base our work here on a preliminary estimation of @xmath4 .",
    "it is conceivable that within the wide class of proposed estimators of @xmath4 some would improve the results that we get ; however , we focus on the unsmoothed turing - good estimator since it is more direct and simple , while still allowing us to achieve very satisfactory results .    getting back to the estimation of @xmath0 , there are several parametric methods based on assuming some structure of the species distribution ; for instance , an estimator devised for the uniform case , in which the probabilities of all species are assumed to be the same is the horvitz - thompson @xmath33 ( see @xcite and bishop , fienberg and holland ( 1975 ) @xcite ) and then @xmath4 can be further estimated , for instance by the unsmoothed turing - good method , to get @xmath34 see @xcite and @xcite .",
    "esty @xcite improves this estimate by assuming a negative binomial prior with parameter @xmath35 to get @xmath36 then providing some ad hoc guess for @xmath35 ( in some cases , @xmath37 ) .    as to nonparametric methods ,",
    "harris @xcite , chao @xcite and chao & lee @xcite have proposed some such estimators , of which the most reliable ones seem to be those proposed in @xcite . in our notation",
    "these amount to @xmath38 with @xmath39 an estimate - for which chao & lee make two proposals - of the normalized variation coefficient of the @xmath40 s .",
    "in fact , assume that @xmath41 is a random variable uniformly distributed on the @xmath0 population probabilities @xmath42 ; , then its average is @xmath43 and its normalized variation coefficient is @xmath44 ^ 2}= t \\sum_{k=1}^{t } ( p_k-\\bar{p})^2      = t \\sum_{k=1}^{t } p_k^2 - 1.\\ ] ] next , chao and lee proceed by using an estimate of good and toulmin @xmath45 and using one preliminary estimate for @xmath0 , for instance , to obtain @xmath46 note that the work by chao and lee can be considered as a further improvement over the results by esty .",
    "however , chao and lee make a rather direct use of a preliminary guess for @xmath0 and we think their method is too sensitive to errors in such preliminary evaluation . in the next section",
    "we start discussing some possible improvements .",
    "\\(i ) we first consider and as equations in the unknowns @xmath0 and @xmath1 and search for simultaneous solutions @xmath47 and @xmath48 . since in some simple examples the unique solution gives @xmath49 , we consider the solutions @xmath50 and @xmath51 of the problem @xmath52 with @xmath53 as in . on letting @xmath54 and @xmath55 for brevity , the function to minimize becomes @xmath56 note that @xmath57 since @xmath58 , so that the solutions of are @xmath59 and @xmath60 .",
    "some tests described in section 6 show that @xmath61 performs better for non uniform populations than the original chao - lee estimate , but has too large a variance .",
    "\\(ii ) next we compare two estimators of @xmath4 , the unsmoothed turing - good and the following modified version of the `` add @xmath2 '' : assume the number @xmath0 of species is known and add @xmath2 to each of the frequencies of all the @xmath0 species , not just to that of those arbitrarily labelled through @xmath27 .",
    "this would give @xmath62 since there are @xmath63 unobserved species .",
    "now , we can hope to reconcile the extended `` add @xmath2 '' and the unsmoothed turing - good estimators by requiring that they assign the same value to @xmath64 .",
    "this amounts to solving @xmath65 solving for @xmath0 we get @xmath66 quite surprisingly , we have obtained    the only value of @xmath0 for which the extended `` add @xmath2 '' and the turing - good estimators of @xmath4 coincide , is the chao - lee estimator @xmath67 with @xmath68 . from now on we will assume this equality and mostly refer to the parameter @xmath2 .",
    "\\(iii ) the relation found in ( ii ) suggests that can be seen as a first moment estimate : @xmath69 so that one can hope to derive @xmath1 from a second moment relation .",
    "the form is suggested by ( i ) , considering the meaning of @xmath53 : @xmath70 the solutions @xmath71 and @xmath72 of and , together with @xmath73 , give new estimators ; although this seems to improve the estimation in some cases , it does appear to have significant flaws , as shown in the simulations reported in tables 1 - 3 .",
    "to further improve the above estimate , we need to understand more about the `` add @xmath2 '' estimator .",
    "it turns out , as was probably known already to laplace , that the probability estimation according to the `` add @xmath2 '' method is nothing but the average species probability under the bayesian posterior on probability distributions on @xmath0 species @xmath74 given the sample , with a single parameter dirichlet prior @xmath75 , i.e. a prior with density @xmath76 for some constant @xmath77 and @xmath6 .",
    "with likelihood @xmath78 the posterior becomes @xmath79 where @xmath80 ( note that the constant terms have been cancelled ) .    by standard integration using the gamma function ( see appendix 1 ) , we find that the average species probability under the posterior is :    @xmath81    as claimed .",
    "this remark , together with our reconcilation lemma in ( i ) above , indicates that we are taking a new step in the development which brought us from to and then to by assigning now two other meanings for @xmath82 , namely that of the add constant in a generalized laplace method and that of the constant in a dirichlet prior .",
    "the bayesian interpretation of @xmath83 also suggests a modification of the second moment minimization . recalling that now @xmath6 we have : @xmath84 with @xmath85[n\\frac{n\\lambda+n}{n - n_1 } ] } \\nonumber\\end{aligned}\\ ] ] where @xmath86 has been taken as in and the calculation is carried out in appendix 1 . in appendix 2",
    "we show the function @xmath87 has two singularities @xmath88 and two zero s , the interesting one being @xmath89    the minimization depends on the sign of @xmath87 for large @xmath2 which in turn depends on the sign of @xmath90 . since @xmath87 is increasing for @xmath6 , if the limit for large @xmath2 is negative , then the only reasonable value we can assign is @xmath91 , else there is a real solution for the minimization problem above : note that if @xmath92 then we are forced to take @xmath93 .",
    "it is thus shown in appendix 2 that the minimization above yields the estimator @xmath94 from we get the following estimator of @xmath0 : @xmath95 or , alternatively , @xmath96    clearly , @xmath97 is not necessarely an integer while @xmath0 is such , and we round it to the nearest integer . notice that when @xmath98 we get @xmath99 .",
    "since we now have an estimate for both the parameters @xmath0 and @xmath2 , we can use the posterior average probability of each species as an estimate of the species probabilities . for the observed species ,",
    "i.e. for @xmath100 , this amounts to @xmath101 this expression is correct also for @xmath102 in which case all species are estimated to have probability @xmath103 .",
    "also note that these values are close to the unbiased estimator @xmath104 of the probability of the @xmath15-th species and can be seen as a mixture of the laplace add-@xmath2 and turing - good estimators since they are obtained by adding @xmath2 to the frequency @xmath14 of the @xmath12 observed species ( recall that @xmath105 ) , but only after having assigned the probability @xmath64 to the event that we will observe a new species ; the estimate of each of the @xmath12 species is then reduced by the factor @xmath106 to compensate for this and , in fact , @xmath107 .",
    "this is likely to be a sensible way to make the attenuation of the laplace estimator ( see @xcite ) finite .",
    "an alternative description of our estimator is then completed by using the previously estimated value of @xmath2 .    a simple approach for the unobserved species would be to uniformly split the probability @xmath64 among the @xmath108 unobserved species and by the reconcilation method in and this would give @xmath109 . on the other hand ,",
    "notice that , since one can read as @xmath110 , the reconciliation method never used the moments of the @xmath40 s for @xmath111 ; therefore , we have some freedom in assigning the estimated values of the @xmath112s for @xmath113 .",
    "these values can then be estimated by taking into account the meaning of @xmath114 as normalized species variance , or of some related quantities ; we could then assign probabilities to the unobserved species to achieve the estimated normalized variance @xmath115 or to achieve some related equality . for simplicity",
    "we will actually focus on @xmath116 and its estimator @xmath117 .",
    "this is a valid approach except when @xmath118 , in which case @xmath119 and @xmath117 turns out to be too small to be a reasonable estimate of @xmath116 ; in that case we replace @xmath117 with @xmath120 .",
    "clearly @xmath121 by jensen s inequality , and thus we require that the estimates @xmath83 of the probabilities of the unobserved species satisfy : @xmath122    we can use any two parameter distribution , such as for instance @xmath123 for @xmath124 , and insist that @xmath125 and @xmath126 solving for @xmath77 and @xmath127 gives the estimated unobserved probabilities @xmath128 , which are used in the simulations of section 6 below to generate confidence intervals by resampling .",
    "it is easily seen that if @xmath129 then @xmath130 and @xmath131",
    "in this section we present numerical simulations and tests of the performance of several estimators compared to those we have developed here .",
    "tables 1 - 4 present the analysis of several populations increasing values of @xmath1 .",
    "tables 5 - 6 present some real tests based on discovering the number of letters in an alphabet from a long text . in table 7 we compute confidence intervals using a resampling based on the reconstructed species probabilities as described in section 5 above .",
    "the estimators compared in tables 1 - 6 are @xmath61 , @xmath132 and @xmath133 defined here , then @xmath134 from , @xmath135 from , the jackknife estimator with optimal parameter @xmath136 from @xcite ( // indicates numerical errors due to small denominators ) , and @xmath137 which is our ( or the chao - lee ) estimator with @xmath138 .    in tables 1 - 4",
    "each population is generated from @xmath0 i.i.d .",
    "random variables , normalized to sum to @xmath8 ; the resulting @xmath1 is determined as normalized interspecies variance ; @xmath139 simple random samples of size @xmath11 are then generated ; finally , mean , sd and mean square error are computed for each estimator .",
    "tables 5 and 6 test the letter content of some passages in english and italian in order to detect the number of letters in each alphabet .",
    "each table shows the results of taking @xmath139 samples of about @xmath140 letters each from the indicated texts .",
    "the conclusion that can be drawn from these tests is that estimator performances are seen to depend on @xmath1 , with the @xmath141 presenting a consistent low value of the mse as long as @xmath5 $ ] .",
    "therefore , @xmath141 has the flexibility to adapt to the different values of the interspecies variance . in table 1 ,",
    "in fact , @xmath142 and the best estimators turn out to be @xmath134 and @xmath135 ( in which clearly @xmath1 gets appropriately estimated ) , but all the estimators defined in the present paper perfom equally well . in the less uniform population in table 2 , jackknife and @xmath133 show the best performances ; and in table 3 where @xmath143 , the best estimator turns out to be @xmath137 , while @xmath141 has only a slightly worse performance .",
    "note that @xmath61 and @xmath132 show a very poor performance in table 2 and 3 .",
    "finally , table 4 shows an extremely skewed population , with @xmath1 very large , for which no estimator works properly .",
    "the reason for @xmath133 is that convergence of the prior imposes @xmath144 .    even in the alphabet test",
    "the performance of @xmath133 turns out to be overall best .",
    "table 7 shows some simulations about confidence intervals for @xmath0 based on samples of size @xmath145 computed from @xmath133 by estimating the species probabilities @xmath146 as described in section 5 and then resampling @xmath139 times from the estimated population distribution .",
    "this process is repeated @xmath147 times and table 7 indicates , for the populations of tables 1 - 3 respectively , the percentage of times the confidence intervals hits the true value of @xmath148 and the average size of the confidence interval .",
    "the hitting percentage comes out remarkably well , due to the good approximation of the true population distribution by the estimated one .",
    ".uniform population : @xmath40 s @xmath149 , @xmath150 . [ cols=\"^,^,^,^,^,^,^,^,^,^ \" , ]     5 in",
    "by definition of the gamma and beta functions @xmath151 and @xmath152 taking @xmath153 we get @xmath154 next , let @xmath155 be the bayesian posterior , given a sample with species records @xmath156 , from a dirichlet prior with parameter @xmath2 on @xmath157 note that @xmath155 is invariant under permutation of the @xmath146 s , so it is valid to express any result via a permutation of indices from a proven statement . therefore , in the following theorems it is sufficient to prove the results for some index @xmath15 .",
    "[ ep ] for evey @xmath6 and for every @xmath158 , @xmath159    for @xmath160 we have : @xmath161 for @xmath162 , let @xmath163 where @xmath164 is the kronecker delta and for @xmath165 let @xmath166 and @xmath167 and let @xmath168 and @xmath169 be as the quantities without hat but with @xmath170 replacing @xmath171 , so that @xmath172 now we have @xmath173 and @xmath174 therefore , @xmath175 it is easily verified that @xmath176 .",
    "moreover , adding these values over the @xmath63 unobserved species we get an estimate of @xmath4 : @xmath177    [ epp ] for every @xmath6 and @xmath178 such that @xmath179 , @xmath180    following the proof of theorem [ ep ] let , for @xmath162 , @xmath181 thus @xmath182 where @xmath183 therefore @xmath184    [ ep2 ] for every @xmath6 and for every @xmath185 @xmath186    as in theorem [ ep ] , for @xmath162 and @xmath187 let @xmath188 so , @xmath189 where @xmath190 therefore , for @xmath191 , @xmath192    if @xmath193 we have @xmath194    we have @xmath195",
    "let @xmath196 and @xmath197 .",
    "we consider now @xmath198 and @xmath199 as free variables satisfying some requirements satisfied by the values that , in fact , @xmath64 and @xmath117 take on in our estimation , namely @xmath200 and @xmath201 .",
    "also let @xmath202 .",
    "then    for every sample , @xmath203    since @xmath204 and @xmath205 we have that @xmath206 is implied by @xmath207    for every sample , @xmath208    by definition of @xmath64 we have @xmath209 then either @xmath210 and the right hand side becomes @xmath211 , or @xmath212 and the relation holds .    for every sample ,",
    "@xmath213    expressing @xmath214 and @xmath11 as function of the @xmath21 s we get @xmath215 then @xmath216    therefore , in the sequel we assume that @xmath198 and @xmath199 satisfy the following relations : @xmath217    let @xmath218[n+ \\lambda \\frac{n+n u/\\lambda}{1-u}]}\\ ] ] we have @xmath219    where @xmath220 is the largest singularity of @xmath87 and @xmath221    the equation @xmath222 has solutions : @xmath223 the root @xmath224 is always non positive and thus it is not interesting and if @xmath225 then @xmath226 achieves the required minimum .    to evaluate the other cases note that the function @xmath87 has two poles @xmath227 and @xmath228 .",
    "moreover , @xmath229 by and , and @xmath230    we now verify that    @xmath87 is increasing for @xmath231 .",
    ". then @xmath233 by .",
    "note that @xmath234 satisfies @xmath235 with the leading coefficient nonnegative by .",
    "therefore , if @xmath236 @xmath237 again by .",
    "thus @xmath238 for all @xmath239 and , by , @xmath240 for all @xmath239 and since the other factors in @xmath241 are also positive , we have that @xmath242 for all @xmath239 as required",
    ".    now there are three possibilities .    1 .",
    "if @xmath243 then from and the above lemma , it follows that @xmath244 for all @xmath239 and increasing , thus @xmath245 2 .   if @xmath246 then from @xmath247 is equivalent to @xmath248 , in which case @xmath249 3 .   if @xmath250 then @xmath251 and by the lemma above @xmath252    the conditions on @xmath198 and @xmath199 are translated into those for @xmath226 and @xmath253 by direct calculation",
    "this work was done during visits by one of us ( ccas ) to the universit di roma , tor vergata ; universit di milano - bicocca ; and universit di firenze .",
    "he takes pleasure in thanking those universities for their warm hospitality and gnampa for its support .",
    "bhning , d. , schn , d. ( 2005 ) : _ nonparametric maximum likelihood estimation of population size based on the counting distribution _ ,",
    "journal of the royal stat .",
    "( c ) appl .",
    "statist . *",
    "54 * , part 4 , 721 - 737 .",
    "bhning , d. , suppawattanabe , b. , kusolvisitkul , w. , vivatwongkasem , c ( 2004 ) : _ estimating the number of drug users in bangkok 2001 : a capture - recapture approach using repeated entries in the list _ ,",
    "j. of epidemiology * 19 * , 1075 - 1083 .",
    "fisher , r.a . ,",
    "steven corbet , a. , williams , c.b .",
    "( 1943 ) : _ the relation between the number of species and the number of individuals in a random sample of an animal population _ , j. an .",
    "* 12 * no . 1 , 42 - 58 .                    jedynak , b. , khudanpur , s. , yazgan , a. ( 2005 ) _ estimating probabilities from small samples _ , 2005 proceedings of the american statistical association , statistical computing section [ cd - rom ] , alexandria , va : american statistical association ."
  ],
  "abstract_text": [
    "<S> we consider the classic problem of estimating @xmath0 , the total number of species in a population , from repeated counts in a simple random sample and look first at the chao - lee estimator : we initially show that such estimator can be obtained by reconciling two estimators of the unobserved probability , and then develop a sequence of improvements culminating in a dirichlet prior bayesian reinterpretation of the estimation problem . by means of this , we obtain simultaneous estimates of @xmath0 , the normalized interspecies variance @xmath1 and the parameter @xmath2 of the prior . </S>",
    "<S> several simulations show that our estimation method is more flexible than several known methods we used as comparison ; the only limitation , apparently shared by all other methods , seems to be that it can not deal with the rare cases in which @xmath3 . </S>"
  ]
}