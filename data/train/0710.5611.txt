{
  "article_text": [
    "a _ de bruijn cycle _ of order @xmath1 is a word in @xmath3 in which each @xmath1-tuple in @xmath4 appears exactly once as a cyclic interval ( see @xcite ) .",
    "the idea of a universal cycle generalizes the notion of a de bruijn cycle .",
    "suppose that @xmath5 is a family of combinatorial objects with @xmath6 , each of which is represented ( not necessarily in a unique way ) by an @xmath1-tuple over some alphabet @xmath7 .",
    "a _ universal cycle _ ( or _ ucycle _ ) for @xmath5 is a word @xmath8 with each @xmath9 represented by exactly one @xmath10 where , here and throughout , index addition is interpreted modulo @xmath11 . with this terminology a de bruijn cycle is a ucycle for words of length @xmath1 over @xmath12 with a word represented by itself .",
    "the definition of ucycle was introduced by chung , diaconis and graham in @xcite .",
    "their paper , and the references therein , forms an good overview of the topic of universal cycles . the cases considered by them include @xmath5 being the set of permutations of an @xmath1-set , @xmath13-subsets of an @xmath1-set , and partitions of an @xmath1-set .    in this paper",
    "we will be concerned with ucycles for permutations : our family @xmath5 will be @xmath14 , which we will regard as the set of all @xmath1-tuples of distinct elements of @xmath15=\\{1,2,\\dots{n}\\}$ ] .",
    "it is not immediately obvious how we should represent permutations with words .",
    "the most natural thing to do would be to take @xmath16 $ ] and represent a permutation by itself , but it is easily verified that ( except when @xmath17 ) it is not possible to have a ucycle in this case . indeed , if every cyclic interval of a word is to represent a permutation then our word must repeat with period @xmath1 , and so only @xmath1 distinct permutations can be represented .",
    "another possibility which we mention in passing would be to represent the permutation @xmath18 by @xmath19 .",
    "it is clear that the permutation is determined by this .",
    "it was shown by jackson @xcite ( using similar techniques to those used for de bruijn cycles ) that these ucycles exist for all @xmath1 .",
    "recently an efficient algorithm for constructing such ucycles was given by williams @xcite .",
    "he introduced the term _ shorthand universal cycles for permutations _ to describe them .",
    "alternatively , chung , diaconis and graham in @xcite consider ucycles for permutations using a larger alphabet where each permutation is represented by any @xmath1-tuple in which the elements have the same relative order .",
    "our aim is to prove their conjecture that such ucycles always exist when the alphabet is of size @xmath2 , the smallest possible .",
    "in contrast to the situation with shorthand universal cycles , the techniques used for de bruijn cycles do not seen to help with this so a different approach is needed .    to describe the problem more formally",
    "we need the notion of order - isomorphism .",
    "if @xmath20 and @xmath21 are @xmath1-tuples of distinct integers , we say that @xmath22 and @xmath23 are @xmath24 if @xmath25 for all @xmath26 .",
    "note that no two distinct permutations in @xmath14 are order - isomorphic , and that any @xmath1-tuple of distinct integers is order - isomorphic to exactly one permutation in @xmath14 .",
    "hence , the set of @xmath1-tuples of distinct integers is partitioned into @xmath0 order - isomorphism classes which correspond to the elements of @xmath14 .",
    "we say that a word @xmath27 over an alphabet @xmath28 is a ucycle for @xmath14 if there is exactly one @xmath10 order - isomorphic to each permutation in @xmath14 .",
    "for example @xmath29 is a ucycle for @xmath30 .",
    "let @xmath31 be the smallest integer @xmath32 for which there is a ucycle for @xmath14 with @xmath33 .",
    "note that if @xmath34 then each permutation is represented by itself and so , as we noted earlier , no ucycle is possible ( unless @xmath17 ) .",
    "we deduce that @xmath35 for all @xmath36 .",
    "chung , diaconis and graham in @xcite give the upper bound @xmath37 and conjecture that @xmath38 for all @xmath36 .",
    "our main result is that this conjecture is true",
    ".    for all @xmath36 there exists a word of length @xmath0 over the alphabet @xmath39 such that each element of @xmath14 is order - isomorphic to exactly one of the @xmath0 cyclic intervals of length @xmath1 .",
    "we prove this by constructing such a word inductively .",
    "the details of our construction are in the next section .",
    "having shown that such a word exists , it is natural to ask how many there are . in the final section we give some bounds on this .",
    "our construction works for @xmath40 . for smaller values of @xmath1",
    "it is a relatively simple matter to find such words by hand . for completeness examples",
    "are @xmath29 for @xmath41 , and @xmath42 for @xmath43 .",
    "we will show how to construct a word of length @xmath0 over the alphabet @xmath39 such that for each @xmath44 there is a cyclic interval which is order - isomorphic to @xmath22 .    before describing the construction",
    "we make a few preliminary definitions .    as is standard for universal cycle problems we let @xmath45 , the _ transition graph _ , be the directed graph with @xmath46    notice that every vertex of @xmath47 has out - degree and in - degree both equal to 2 .",
    "the vertices on a directed cycle in @xmath47 plainly correspond to the @xmath1-tuples which occur as cyclic intervals of some word .",
    "our task , therefore , is to find a directed cycle in @xmath47 of length @xmath0 such that for each @xmath48 there is some vertex of our cycle which is order - isomorphic to @xmath22 .",
    "this is in contrast to many universal cycle problems where we seek a hamilton cycle in the transition graph .",
    "we define the map on the integers : @xmath49    we also , with a slight abuse of notation , write @xmath50 for the map constructed by applying this map coordinatewise to an @xmath1-tuple .",
    "that is , @xmath51    the point of this definition is that if @xmath52 is a permutation of @xmath15 $ ] and @xmath53 $ ] then @xmath54 is the unique @xmath1-tuple of elements of @xmath55\\setminus\\{x\\}$ ] which is order - isomorphic to @xmath22 .",
    "note that , as will become clear , this is the definition we need even though our final construction will produce a ucycle for permutations of @xmath15 $ ] using alphabet @xmath39 .",
    "we also define a map @xmath13 on @xmath1-tuples which permutes the elements of the @xmath1-tuple cyclically .",
    "that is , @xmath56    note that @xmath57 is an edge of @xmath47 and that @xmath58 .    as indicated above , we prove theorem 1 by constructing a cycle of length @xmath0 in @xmath47 such that for each @xmath44 the cycle contains a vertex which is order - isomorphic to @xmath22 .",
    "our approach is to find a collection of short cycles in @xmath47 which between them contain one vertex from each order - isomorphism class and to join them up .",
    "the joining up of the short cycles requires a slightly involved induction step which is where the main work lies .",
    "_ step 1 : _ finding short cycles in @xmath47    the first step is to find a collection of short cycles ( each of length @xmath1 ) in @xmath47 which between them contain exactly one element from each order - isomorphism class of @xmath14 .",
    "these cycles will use only @xmath1 elements from the alphabet and we will think of each cycle as being `` labelled '' with the remaining unused element .",
    "suppose that for each @xmath59 we choose a label @xmath60 from @xmath15 $ ] .",
    "let @xmath61 be the @xmath1-tuple @xmath62 .",
    "we have the following cycle in @xmath47 : @xmath63    we denote this cycle by @xmath64 . as an example , @xmath65 is the following cycle in @xmath66 : @xmath67 where arrows denote directed edges of @xmath66 .",
    "note that for any choice of labels ( that is any map @xmath68 ) the cycles @xmath64 and @xmath69 are disjoint when @xmath70 are distinct .",
    "consequently , whatever the choice of labels , the collection of cycles @xmath71 is a disjoint union .",
    "it is easy to see that the vertices on these cycles contain between them exactly one @xmath1-tuple order - isomorphic to each permutation in @xmath14 .",
    "we must now show how , given a suitable labelling , we can join up these short cycles .",
    "_ step 2 : _ joining two of these cycles    suppose that @xmath72 and @xmath73 are two of the cycles in @xmath47 described above .",
    "what conditions on @xmath74 and their labels @xmath75 will allow us to join these cycles ?",
    "we may assume that @xmath76 .",
    "suppose further that @xmath77 , and that @xmath22 and @xmath23 satisfy the following : @xmath78    if this happens we will say that the pair of cycles @xmath79 are _",
    "linkable_.    in this case @xmath80 and @xmath81 agree at all but one position ; they differ only at the @xmath82 for which @xmath83 and @xmath84 .",
    "it follows that there is a directed edge in @xmath47 from @xmath85 to @xmath86    similarly , there is a directed edge in @xmath47 from @xmath87 to @xmath88    if we add these edges to @xmath89 and remove the edges @xmath90 and @xmath91 then we produce a single cycle of length @xmath92 whose vertices are precisely the vertices in @xmath89 .",
    "we remark that if @xmath93 then the other conditions imply that @xmath94 and so although we can perform a similar linking operation it is not useful . if @xmath95 then @xmath23 is not well - defined .    as an example of the linking operation consider the linkable pair of 6-cycles @xmath65 and @xmath96 in @xmath66 . if we add the edges @xmath97 and @xmath98 , and remove the edges @xmath99 and @xmath100 then a single cycle of length 12 in @xmath66 is produced .",
    "these cycles and the linking operation are shown in figure 1 .     and",
    "@xmath96 are linkable ]    _ step 3 : _ joining all of these cycles    we now show that this linking operation can be used repeatedly to join a collection of disjoint short cycles , one for each @xmath44 , together .",
    "let @xmath101 be the ( undirected ) graph with , @xmath102\\}\\\\ e&=\\{(a , x)(b , y ) : \\c(a , x ) , \\c(b , y ) \\text { are linkable}\\}\\end{aligned}\\ ] ]    if we can find a subtree @xmath103 of @xmath104 of order @xmath105 which contains exactly one vertex @xmath106 for each @xmath107 then we will be able to construct the required cycle .",
    "take any vertex @xmath108 of @xmath103 and consider the cycle @xmath64 associated with it .",
    "consider also the cycles associated with all the neighbours in @xmath109 of @xmath108 .",
    "the linking operation described above can be used to join the cycles associated with these neighbours to @xmath64 .",
    "this is because the definition of adjacency in @xmath104 guarantees that we can join each of these cycles individually .",
    "also , the fact that every vertex in @xmath47 has out - degree 2 means that the joining happens at different places along the cycle . that is",
    "if @xmath110 and @xmath111 are distinct neighbours of @xmath108 then the edge of @xmath64 which must be deleted to join @xmath69 to it is not the same as the one which must be deleted to join @xmath112 to it .",
    "we conclude that we can join all of the relevant cycles to the cycle associated with @xmath108 .",
    "the connectivity of @xmath109 now implies that we can join all of the cycles associated with vertices of @xmath109 into one cycle .",
    "this is plainly a cycle with the required properties .",
    "the next step is to find such a subtree in @xmath104 .",
    "_ step 4 : _ constructing a suitable tree    we will prove , by induction on @xmath1 , the stronger statement that for all @xmath40 , there is a subtree @xmath109 of @xmath113 of order @xmath105 which satisfies :    1",
    ".   for all @xmath107 there exists a unique @xmath114 $ ] such that @xmath115 , 2 .",
    "@xmath116 , 3 .",
    "@xmath117 for all @xmath118 , 4 .",
    "@xmath119 , 5 .",
    "@xmath120 , 6 .",
    "@xmath121 is a leaf in @xmath109 , 7 .",
    "@xmath122 is a leaf in @xmath109 .",
    "where , for a tree satisfying property 1 , we denote the unique vertex in @xmath123 of the form @xmath106 by @xmath124 .    for @xmath125",
    "a suitable tree can be found .",
    "one such is given in figure 2 .    ]",
    "suppose that @xmath40 and that we have a subtree @xmath109 of the graph @xmath113 which satisfies the above conditions .",
    "we will use this to build a suitable subtree of @xmath126 .",
    "a key observation for our construction is that the map from @xmath127 to @xmath128 obtained by replacing each vertex @xmath129 by @xmath130 preserves adjacency .",
    "it follows that subgraphs of @xmath113 are mapped into isomorphic copies in @xmath126 by this map .",
    "further , applying a fixed permutation to the coordinates of the @xmath1-tuple associated with each vertex of @xmath126 gives an automorphism of @xmath126 and so subgraphs of @xmath126 are mapped into isomorphic copies .",
    "we take @xmath1 copies of @xmath109 .",
    "these copies will be modified to form the building blocks for our subtree of @xmath126 as follows .    in the first copy",
    "we replace each vertex @xmath131 by @xmath132 by the observation above this gives an isomorphic copy of @xmath109 in @xmath126 .",
    "we denote this tree by @xmath133 .    in the next copy",
    "we replace each vertex @xmath131 by @xmath134 we denote this tree by @xmath135 .    for all @xmath136 , we take a new copy of @xmath109 and modify it as follows .",
    "we replace each vertex @xmath137 by @xmath138 we denote these trees by @xmath139 .    as we mentioned this results in @xmath1 subtrees of @xmath126 .",
    "they are clearly disjoint because the position in which 1 appears in the first coordinate of each vertex is distinct for distinct trees .",
    "let @xmath140 be the @xmath1 component subforest of @xmath126 formed by taking the union of the trees @xmath141 for @xmath142 .",
    "it is also easy to see that for every @xmath44 there is a vertex in @xmath140 of the form @xmath106 for some @xmath53 $ ] .",
    "it remains to show that the @xmath1 components can be joined up to form a single tree with the required properties .",
    "notice that it is a consequence of the construction of the @xmath141 that if @xmath143 is a leaf in @xmath109 then the following vertices are all leaves in @xmath140 :    * @xmath144 * @xmath145 * @xmath146 for @xmath136 .",
    "we claim that @xmath147 is a leaf in @xmath133 , and hence a leaf in @xmath140 .",
    "this follows from the fact that @xmath122 is a leaf in @xmath109 and the remark above .",
    "we delete this vertex from @xmath140 to form a new forest .    the construction of the @xmath148 and the fact that @xmath117 for all @xmath118 means that @xmath149 for all @xmath118 .",
    "further , the construction of the @xmath135 and the fact that @xmath119 means that @xmath150 .",
    "we add to @xmath140 a new vertex @xmath151 ( this replaces the deleted vertex from @xmath133 ) and edges from this new vertex to @xmath152 for all @xmath153 .",
    "the previous observation shows that all of these vertices are in @xmath140 , and it is easy to check , using the definition of linkability , that the added edges are in @xmath126 .",
    "this new forest has only two components .    similarly , the inductive hypothesis that @xmath121 is a leaf in @xmath109 gives that @xmath154 is a leaf in @xmath140 ( using the case @xmath155 of the observation on leaves ) .",
    "we delete this leaf from the forest , replace it with a new vertex @xmath156 , and add edges from this new vertex to @xmath157 and @xmath158 .",
    "the construction of @xmath159 and the fact that @xmath119 ensures that the first of these vertices is in @xmath140 . the construction of @xmath133 and the fact that @xmath120 ensures that the second of these vertices is in our modified @xmath133 .",
    "these modifications to @xmath140 produce a forest of one component  that is a tree .",
    "denote this tree by @xmath160 .",
    "we will be done if we can show that @xmath160 satisfies the properties demanded .",
    "plainly , @xmath160 contains exactly one vertex of the form @xmath106 for each @xmath44 . by construction @xmath161 , and @xmath162",
    "are vertices of @xmath160 for all @xmath163 .",
    "hence the first three properties are satisfied .",
    "the construction of @xmath159 and the fact that @xmath164 ensures that @xmath165 is a vertex of @xmath160 .",
    "the construction of @xmath166 and the fact that @xmath119 ensures that @xmath167 is a vertex of @xmath160 .",
    "hence properties 4 and 5 are satisfied .",
    "finally , the construction of @xmath135 and the fact that @xmath121 is a leaf in @xmath109 ensures that @xmath168 is a leaf in @xmath140 .",
    "the modifications which @xmath140 undergoes do not change this and so it is a leaf in @xmath160 .",
    "the construction of @xmath159 and the fact that @xmath121 is a leaf in @xmath109 ensures that @xmath169 is a leaf in @xmath140 .",
    "again , the modifications to @xmath140 do not change this and so this vertex is still a leaf in @xmath160 .",
    "hence properties 6 and 7 are satisfied .",
    "we conclude that the tree @xmath160 has the required properties .",
    "this completes the construction .",
    "having constructed a ucycle for @xmath14 over the alphabet @xmath170 it is natural to ask how many such ucycles exist .",
    "we will regard words which differ only by a cyclic permutation as the same so we normalize our universal cycles by insisting that the first @xmath1 entries give a word order - isomorphic to @xmath171 .",
    "we denote by @xmath172 the number of words of length @xmath0 over the alphabet @xmath39 which contain exactly one cyclic interval order - isomorphic to each permutation in @xmath14 and for which the first @xmath1 entries form a word which is order - isomorphic to @xmath171 .",
    "there is a natural upper bound which is essentially exponential in @xmath0 based on the fact that if we are writing down the word one letter at a time we have 2 choices for each letter .",
    "we can also show that there is enough choice in the construction of the previous section to prove a lower bound which is exponential in @xmath105 .",
    "it is slightly surprising that our construction gives a lower bound which is this large .",
    "however , the upper and lower bounds are still far apart and we have no idea where the true answer lies .",
    "@xmath173    suppose we write down our universal cycle one letter at a time .",
    "we must start by writing down a word of length @xmath1 which is order - isomorphic to @xmath171 ; there are @xmath2 ways of doing this .",
    "for each of the next @xmath174 entries we must not choose any of the previous @xmath175 entries ( all of which are distinct ) and so we have 2 choices for each entry .",
    "this gives the required upper bound .",
    "now for the lower bound . we will give a lower bound on the number of subtrees of @xmath113 which satisfies the conditions of step 4 of the proof of theorem 1 .",
    "it can be checked that if a universal cycle comes from a subtree of @xmath113 in the way described then the tree is determined by the universal cycle .",
    "it follows that the number of such trees is a lower bound for @xmath172 .",
    "notice that if we have @xmath176 such subtrees of @xmath113 then we have at least @xmath177 such subtrees of @xmath126 .",
    "this is because in our construction we took @xmath1 copies of @xmath109 to build @xmath160 from and each different set of choices yields a different tree .",
    "we conclude that the number of subtrees of @xmath113 satisfying the conditions is at least @xmath178    finally , we bound @xmath179 .",
    "we modify the given @xmath180 be adding edges from @xmath181 to @xmath182 , from @xmath183 to @xmath184 and from @xmath185 to @xmath186 .",
    "this graph is such that that any of its spanning trees satisfies the properties for our @xmath180 .",
    "it can be checked that this graph has 420 spanning trees .",
    "this gives the lower bound .",
    "this work was inspired by the workshop on generalizations of de bruijn cycles and gray codes held at banff in december 2004 .",
    "i thank the organisers and participants of the workshop for a stimulating and enjoyable week .",
    "9 chung ,  f. , diaconis ,  p. , graham ,  r. ( 1993 ) universal cycles for combinatorial structures .",
    "_ discrete math .",
    "_ * 110 * 4359 .",
    "de bruijn ,  n.g .",
    "( 1946 ) a combinatorial problem .",
    ", proc . _ * 49 * 758764 .",
    "jackson ,  b.w .",
    "( 1993 ) universal cycles for @xmath187-subsets and @xmath187-permutations",
    ". _ discrete math .",
    "_ * 117 * 141150 .",
    "williams ,  a.m. ( submitted 2007 ) shorthand universal cycles for permutations .",
    "_ acm - siam symposium on discrete algorithms 2008_."
  ],
  "abstract_text": [
    "<S> a universal cycle for permutations is a word of length @xmath0 such that each of the @xmath0 possible relative orders of @xmath1 distinct integers occurs as a cyclic interval of the word . </S>",
    "<S> we show how to construct such a universal cycle in which only @xmath2 distinct integers are used . </S>",
    "<S> this is best possible and proves a conjecture of chung , diaconis and graham .    </S>",
    "<S> keywords : universal cycles , combinatorial generation , permutations . </S>"
  ]
}