{
  "article_text": [
    "after the initial focus on the theoretical basis of quantum mechanics , research into harnessing the non - classical properties of quantum systems for technological purposes has intensified over the last decades . while some ideas such as quantum key distribution have become commercially viable applications , the path towards scalable quantum simulation and computation has turned out to be stony .",
    "one of the highest hurdles has been the influence of the environment on quantum systems , causing decoherence and eliminating purely quantum properties  @xcite .",
    "multiple strategies to mitigate against the effects of decoherence have been proposed ; for example , decoherence - free subspaces and noiseless subsystems  @xcite , quantum dynamical decoupling  @xcite , multilevel encoding of logical states  @xcite , and stochastic and optimal control  @xcite . in this work ,",
    "we focus on the last approach .",
    "the basic premise behind optimal control of quantum dynamics is that quantum - mechanical systems can coherently interact with suitable external fields , which can change the system s hamiltonian and thereby alter its dynamical evolution .",
    "varying the temporal , and in some cases spatial profile , of the fields affords us a great degree of control over the system by enabling us to fine - tune its hamiltonian at least within certain constraints .",
    "the idea of optimal control is to use this degree of control to optimally steer the quantum dynamics towards a desired outcome , for instance , from a particular initial state to a desired target state ( which might optimise a certain property of the system such as its energy , dipole moment , or angular momentum ) .",
    "more recently , with the advent of quantum information processing , a more ambitious goal has been formulated : quantum process control , which aspires to control not only the evolution of a single initial state but that of a complete set of basis states to implement a desired dynamic transformation often referred to as a quantum gate .",
    "optimal steering of quantum dynamics is generally considered crucial to achieve high - fidelity implementations of quantum gates , especially in the presence of environmental noise ; previous work has shown that optimal control can be an effective strategy to implement quantum gates in noisy settings  @xcite . however , it is also known that hamiltonian control of the system alone can not undo environmental effects , especially in the markovian setting  @xcite , showing that there are limits on what can be achieved with optimal control",
    ". some of these restrictions can be overcome by extending the idea of control to include measurements or other forms of incoherent control and feedback , as discussed in  @xcite , for example .",
    "however , we shall focus on open - loop coherent control , the most widely used technique today .",
    "the main focus of this paper is the potential and limitations of optimal control with regard to the implementation of high - fidelity quantum gates in noisy environments with a particular emphasis on the differences between markovian and non - markovian environments . from a control point of view",
    "these environments are fundamentally different . in the markovian case",
    ", the system s future depends only on its present state and any information leaked into the environment is irrecoverable . in the non - markovian case",
    ", the environment displays memory effects , which the control can exploit to recover losses to the environment and restore the system s coherence .",
    "we therefore expect the control mechanisms and optimal controls for systems in markovian and non - markovian environments to be fundamentally different . in both cases , however , finding controls that achieve the desired optimal steering is an optimisation problem that quickly becomes computationally very expensive as the hilbert space dimension of the system increases , due to the need to simulate the underlying quantum dynamics .",
    "therefore , the ability of any particular algorithm to _ efficiently _ find solutions close to a _ global _",
    "optimum is of utmost interest , as are the physical characteristics of the optimal controls found , the basic mechanisms by which they achieve the optimal steering , and the effects that may interfere with the control , potentially rendering it ineffective .",
    "these are the core issues we shall discuss .",
    "the paper is organised as follows . in sec .  2",
    ", we briefly describe the different types of environments and how we model them . in sec .  3",
    ", we discuss the optimisation algorithms .",
    "the results for both models are presented and discussed in sec .  4 and the conclusions and suggestions for future work are summarised in sec .",
    "two idealised environmental models can be distinguished , the markovian and the non - markovian one . in the former case ,",
    "the system of interest , or system for short , interacts with a typically much larger memoryless environment ; it is assumed that the future evolution of the system is determined solely by its present state .",
    "in addition , the noise signal has no self - correlation over any time interval .",
    "these conditions are not fulfilled in the non - markovian model and the future evolution of the system also depends on its past .",
    "this is typically true for small structured environments with a low number of degrees of freedom which cause the noise to be self - correlated .",
    "as no information is lost , the coherence of the system can oscillate .",
    "markovian and non - markovian settings represent opposite ends of the spectrum and many physical systems have features in - between the two extremes .",
    "it is also possible for the combination of a system with its non - markovian environment to itself be coupled to a markovian bath , as considered in @xcite . as such",
    ", studying the behaviour of a system under both scenarios allows a wide range of potential implementations to be covered .",
    "the key assumption underlying the markovian model is that the timescale relevant for the system evolution is much greater than the coherence time of the bath so that on the relevant timescales the environment has no memory of the system s past .",
    "the description of a large memoryless environment is a very natural one and many systems have traditionally been studied using the markovian model . among the most common physical processes responsible for markovian decoherence",
    "are phase and population relaxation processes .",
    "dephasing can be caused by external fields or collisions in atomic vapours  @xcite .",
    "population relaxation typically occurs as a result of spontaneous emission of photons or phonons , which been shown to play a dominant role in trapped ions  @xcite .",
    "markovian decoherence processes have also been found in bose - einstein condensates and plasmas  @xcite .",
    "the dynamics of a system in a markovian environment are usually described by a master equation for the reduced density matrix @xmath0 obtained by tracing out the bath degrees of freedom from the state of the system and environment .",
    "the most general time - homogeneous markovian master equation , which is also trace - preserving and completely positive for any initial condition , is the master equation in lindblad form  @xcite @xmath1 where @xmath2 $ ] describes the action of the system s intrinsic hamiltonian @xmath3 , @xmath4 $ ] encapsulates the effect of the control hamiltonian @xmath5 , and @xmath6\\rho_r(t)$ ] accounts for the environment .",
    "@xmath7=ab - ba$ ] is the usual matrix commutator .",
    "the sum over @xmath8 represents the sum over all the bounded lindblad operators @xmath9 acting on the system , where @xmath10 \\rho_r(t ) = v_d \\rho_r(t ) v_d^\\dag      - \\tfrac{1}{2 } [ v_d^\\dag v_d \\rho_r(t)+\\rho_r(t)v_d^\\dag v_d].\\ ] ] we choose units such that @xmath11 . instead of describing the dynamics only for a specific state @xmath12",
    ", we can introduce a superoperator @xmath13 describing the evolution of all possible system states , which must satisfy @xmath14    denoting the system s hilbert space dimension by @xmath15 , the evolution operator @xmath16 is a linear map between @xmath17 complex matrices and thus can be written as a @xmath18 complex matrix acting on a complex column vector representing the state .",
    "the latter can be obtained simply by stacking the columns of the density matrix @xmath19 .",
    "an alternative representation , which is often computationally more convenient , can be obtained by expanding the state and the evolution operators with respect to a basis @xmath20 for the hermitian @xmath21 matrices , such as the generalised pauli matrices or tensor products of pauli matrices for qubit systems . in this case , the state is represented by a real @xmath22 vector @xmath23 , which is determined by @xmath24 , as well as @xmath25 , @xmath26 , and @xmath27 which are determined by @xmath28 real matrices @xmath29 , @xmath30 and @xmath31 , respectively  @xcite ;    @xmath32 ) , \\\\     l_{mn}^{(c ) } & = \\tr(ih_c [ \\sigma_m,\\sigma_n ] ) ,   \\\\     d_{mn}^{(d ) } & = \\tr(v_d^\\dag \\sigma_m v_d \\sigma_n )     -\\tfrac{1}{2 } \\tr [ v_d^\\dag v_d ( \\sigma_m \\sigma_n + \\sigma_n \\sigma_m)].\\end{aligned}\\ ] ]    choosing a real representation is preferable as the multiplication of two complex quantities requires four ( real ) multiplications , compared to one for two real quantities .",
    "although markovian environments play an important role in many physical applications , the study of non - markovian systems , particularly in the solid state , has intensified in recent years ; non - markovian behaviour has been observed in the fluorophore system  @xcite , spin gases  @xcite , spin echoes  @xcite , quantum dots  @xcite , and donor - based charge qubits interacting with phonons  @xcite .",
    "coherence revivals , a key signature of non - markovian behaviour , have also been observed with atoms interacting with cavity electromagnetic radiation @xcite and with electromagnetically trapped ions and molecules @xcite .",
    "there are several ways of dealing with non - markovian environments .",
    "one approach is to derive master equations similar to the lindblad equation for quantum systems under the influence of non - markovian environments using perturbative techniques  @xcite .",
    "this approach has the advantage that the evolution of the system is effectively still determined only by a reduced density matrix describing the system state , not the state of the environment .",
    "it is very useful to describe large environments especially if the non - markovian effects are not too strong . another way to deal with environments are collisional model  @xcite .",
    "the most general approach are hamiltonian models that describe the dynamics of both system and environment and their interaction .",
    "these models are computationally very challenging , and therefore most useful small environments , but have the advantage of being able to describe arbitrary system - bath interactions .",
    "they are therefore useful to model the dynamics if the system and environment are too intertwined to describe the system evolution by a master equation . here",
    "we focus on the latter full hamiltonian approach and model the environment in terms of a small number of noise qubits interacting with one or more system qubits .",
    "we consider different configurations of system and noise qubits as shown in fig .",
    "[ fig : systems ] similar to @xcite .",
    "the coupling between system qubits as well as system and noise qubits is given by a heisenberg exchange interaction and magnetic control fields act on the system qubits .",
    "the coupling between system qubits is assumed to be stronger than the coupling between system and noise qubits .",
    "couplings between the noise qubits are neglected  they have been shown to have little effect on the solutions  @xcite .",
    "for a system of @xmath33 system qubits , @xmath34 noise qubits , and @xmath35 control hamiltonians , the dynamics of the composite system are therefore governed by the schrdinger equation with an overall hamiltonian @xmath36 where @xmath37 and @xmath38 are the dimensions of the environment and the composite system , respectively , and @xmath15 is the ( hilbert space ) dimension of the system as in the markovian case .",
    "@xmath39 denotes the spin operators for the @xmath40th qubit , where @xmath41 is an @xmath42-fold tensor product whose @xmath40th factor is @xmath43 and all other factors are the identity @xmath44 .",
    "@xmath45 is the coupling constant between qubits @xmath40 and @xmath46 .",
    "we use model - based optimal control where an objective functional is defined and the control field is numerically optimised to obtain the best possible value of the functional .",
    "a canonical choice for the performance index for gate optimisation problems is the gate error @xmath47 .",
    "we discretise the controls @xmath48 using piecewise constant functions , dividing the total time @xmath49 into @xmath50 slices @xmath51 $ ] of duration @xmath52 and setting @xmath53 for @xmath54 $ ] .",
    "thus , we have @xmath55 where @xmath56 for @xmath57 $ ] and @xmath58 elsewhere .",
    "this parameterisation is a common choice and natural for many applications such as nuclear magnetic resonance , where waveform generators can approximate a piecewise constant output .",
    "other parameterisations may be considered as appropriate for other applications .",
    "after discretisation of the controls , we are left with a vector of control parameters @xmath59 and an error functional @xmath60 and our goal is to find a control vector @xmath61 such that @xmath62 assumes its global minimum .",
    "motivated by a recent comparison of various first- and second - order sequential and concurrent update methods  @xcite , we opt for a concurrent update quasi - newton method   , which involves iteratively updating the control parameters according to the newton update rule , @xmath63 starting with a guess for the initial field @xmath64 and an initial hessian approximation @xmath65 . the initial hessian is taken to be the identity and the approximate hessian is then constructed from the past gradient history according to the broyden - fletcher - goldfarb - shanno ( bfgs ) formula @xmath66 where @xmath67 , @xmath68 , and @xmath69 by default ; @xmath70 is the search length parameter for a standard newton step .",
    "the optimisation algorithm requires the computation of derivatives of the objective functional @xmath71 with regard to the control variables @xmath72 .",
    "the simplest approach is to approximate the required derivatives numerically using finite differences  @xcite , @xmath73 \\right\\},\\ ] ] with @xmath74,\\ ] ] for a finite value of @xmath75 .",
    "this calculation can be made efficient by recognising that the error does not need to be explicitly evaluated at the two different fidelities  @xcite .",
    "a serious drawback , however , is that the value of the step size is constrained by the fact that choosing too large a value renders the approximation invalid while choosing too small a value reduces the number of accurate digits of the difference in the floating point representation to zero  @xcite .",
    "the step - size parameter therefore needs to be chosen carefully . for the low - dimensional systems considered in the following",
    ", step sizes on the order of @xmath76 generally gave good results , but the optimal value is usually not known a - priori and thus needs to be determined by trial and error .    to avoid this problem ,",
    "analytical derivative formulae can be derived . for typical gate optimisation problems ,",
    "the error function @xmath60 is a simple functional of the time evolution operator @xmath13 of the system , and a derivation similar to  @xcite shows that for piecewise constant controls @xmath77      x(t_{p-1}),\\ ] ] where @xmath78 x(t_{p-1})$ ] and @xmath79 for general markovian systems ; in addition , @xmath80 x(t_{p-1})$ ] and @xmath81 for closed systems subject to unitary evolution .",
    "the latter case includes the non - markovian systems discussed above if @xmath82 is taken to be the hamiltonian and @xmath13 the unitary evolution operator of the total system including the noise qubits .",
    "the integral in ( [ eq : grad ] ) can be evaluated exactly via the augmented matrix exponential formula @xmath83 by setting @xmath84 and @xmath85 or @xmath86 and @xmath87 .",
    "thus we can compute both the matrix exponential @xmath88 and the desired derivative simply by computing the matrix exponential of an augmented matrix twice the size of the system operators . if @xmath89 is diagonalisable , then",
    "the matrix exponential and gradient can alternatively be computed using the spectral decomposition of @xmath90 as discussed in  @xcite ; spectral decomposition is usually the preferred approach for such systems .    for any hamiltonian system , including closed systems and non - markovian systems with noise qubits , the total hamiltonian @xmath91 is always skew - hermitian and thus diagonalisable .",
    "the superoperators for most systems subject to markovian non - unitary evolution , on the other hand , are often not diagonalisable .",
    "therefore , the spectral decomposition approach is usually the preferred choice for closed and non - markovian systems while the augmented matrix exponential is useful for other cases where accurate gradients are required . for small systems such as the one- and two - qubit markovian systems considered below ,",
    "the evaluation of the augmented matrix exponential was actually faster than using the finite difference approximation in our simulations . for higher dimensional systems , the evaluation of the augmented matrix exponential tends to be computationally more expensive than the computation of the gradient using the finite difference approximation .",
    "on the other hand , the analytic formula allows for more accurate gradient computations .",
    "gradient accuracy is a significant factor for the performance of any type of algorithm using gradients , especially quasi - newton methods , and previous work for closed systems has shown that low - order gradient approximations , even if they are faster to compute , are detrimental to the performance of the algorithm in terms of leading to poor convergence and lower fidelities , unless very small step sizes are used  @xcite .",
    "nonetheless , with carefully chosen finite difference step - sizes it was possible to achieve sufficient gradient accuracy to reproduce the convergence behaviour and final fidelities obtained using the augmented matrix exponential routine in most of our markovian system simulations . for non - markovian systems ,",
    "the finite difference approximation was not used due to lack of any discernible benefit .",
    "the algorithm also requires initial fields @xmath92 to start the iteration .",
    "here we choose the components of @xmath92 by randomly sampling according to a gaussian distribution with mean @xmath58 and standard deviation @xmath93 where @xmath94 is a free parameter .",
    "@xmath95 shows that @xmath94 determines the norm of the initial field vector of each component field @xmath96 . for piecewise constant functions with fixed @xmath97 ,",
    "the norm of the field vector is proportional to the @xmath98 norm of the field as a function over @xmath99 $ ] : @xmath100 we refer to the square of the @xmath98 norm of a field as the fluence of the pulse , a quantity that is of independent physical interest as it is proportional to the pulse energy .      for general markovian dynamics ,",
    "the most natural way to compare quantum processes is by considering the distance between the processes in the adjoint representation .",
    "the adjoint representation of a unitary target operator @xmath101 with respect to the chosen basis @xmath102 is given by the @xmath28 real matrix @xmath103 with @xmath104 .",
    "letting @xmath13 be the real adjoint representations of the time - evolution operator of the system defined earlier , we can define the gate error in terms of the square of the frobenius ( or hilbert - schmidt ) norm of @xmath105 , @xmath106          = \\lambda \\left(\\tr(y^\\tp y ) + \\tr[x(\\tf)^\\tp x(\\tf)]-2\\tr[y^\\tp x(\\tf ) ] \\right ) , % % using transpose instead of dagger for clarity\\ ] ] where @xmath107 is a scaling factor .",
    "the gate error is a simple functional of the evolution operator and thus @xmath108   = -2 \\lambda \\tr\\left[\\lambda^t(t ) \\frac{\\partial x(t)}{\\partial f_{mp}}\\right],\\ ] ] where @xmath109 are the partial derivatives of the evolution operator as defined in ( [ eq : grad ] ) .",
    "we will use this performance index with @xmath110 for the optimisation .",
    "however , for the sake of a direct error comparison with closed and non - markovian systems , we also define the error functional @xmath111 where @xmath112 is the _ unit gate fidelity_. it is easy to check that this gate fidelity agrees with the gate fidelity for closed systems if the lindblad operators vanish .    for non - markovian systems , one may be tempted to simply define the gate error by @xmath113| , \\ ] ] where @xmath114 is the dimension , @xmath115 the ( unitary ) time evolution operator of the composite system , @xmath101 the target operator on the system , and @xmath44 the identity operator on the noise subsystem .",
    "however , this error vanishes only if we simultaneously implement the target gate @xmath101 on the system subsystem and the identity on the noise subsystem . usually , however , we do not care what the evolution of the noise subsystem is . therefore ,",
    "a better measure of the gate error is @xmath116 where @xmath117 is an arbitrary time - evolution operator acting on the noise subsystem only , and @xmath107 is a normalisation constant that can be chosen so that the error ranges between @xmath58 and @xmath118 , for instance . )",
    "agrees with the one introduced by grace et al . in  @xcite except that the right - hand side is squared to make the non - markovian gate fidelity @xmath119 agree with the usual gate fidelity for closed systems in the absence of noise qubits .",
    "] taking the matrix norm in  ( [ eq : e2 ] ) to be the frobenius norm and setting @xmath120 , it can be shown that  @xcite @xmath121 where @xmath122 , @xmath123 denotes the partial trace over the system @xmath124 , and @xmath125 is the gate fidelity . differentiating ( [ eq : e2b ] ) with respect to @xmath126",
    ", we obtain @xmath127,\\end{aligned}\\ ] ] and thus the gradient is again defined in terms of the partial derivatives of the total evolution operator @xmath115 with regard to the control variables @xmath126 .",
    "@xmath128 may become singular but from the singular value decomposition @xmath129 , where @xmath130 and @xmath131 are unitary matrices and @xmath131 is a diagonal matrix with non - negative entries , one can easily verify that @xmath132 , which can be defined even if @xmath128 is singular .",
    "to evaluate the performance of the algorithm and quality of the solutions found , we studied a variety of gate optimisation tasks for single , two- , and three - qubit systems in different markovian and non - markovian environments .",
    "details of the system parameters chosen are given in tables [ table1 ] and [ table2 ] . in our system of units , @xmath133 , where @xmath134 is the angular frequency of the system qubit in the one - qubit case and @xmath135 is the boltzmann constant . throughout this paper time",
    "is expressed in units of @xmath136 .",
    "in addition to fundamental issues such as asymptotic error values , how rapidly we converge to these , and the dependence of the convergence behaviour and limiting values on algorithmic parameters such as the choice of the initial fields @xmath92 , we also considered the impact of unwanted side effects such as field leakage and analysed the characteristics of the optimal fields .",
    "[ cols=\"<,<,<,<\",options=\"header \" , ]       +   +    for simple problems , we found considerable uniformity in terms of the final values of the fidelities achieved for different runs and different target gates .",
    "for example , for the one- and two - qubit gate problems considered the final fidelities of more than 95% of all runs for a given problem typically agreed to three or more decimal places .",
    "this suggests that most runs converged to a control that achieved close to optimal performance in terms of reaching an error very close to the global minimum attainable for the given form of decoherence and control field restrictions ( such as the field parameterisation , target time , and time resolution ) .",
    "this was the case in both the markovian and non - markovian case although the errors in the markovian case were higher , especially for the more complex gates .",
    "for instance , for the three - qubit qft gate the maximum asymptotic fidelity was around 99.8% for spontaneous emission , 99.3% for dephasing in either the @xmath137 or @xmath138 basis , and 99.2% for correlated @xmath139-dephasing at a rate of @xmath140 for @xmath141 , while errors @xmath142 were attainable for the non - markovian cases .",
    "this is not unexpected considering that the markovian setting lacks the possibility of coherence revivals . as the difficulty of the gate optimisation problems increased , however , far less uniform convergence behaviour and increasingly large spreads of final fidelities were observed , again in both the markovian and non - markovian cases .",
    "this is exemplified in fig .",
    "[ fig : conv ] which shows the convergence behaviour for 100 runs each for different cases .",
    "for instance , the error of the best run in fig .",
    "[ fig : conv](f ) was @xmath142 while the error of the worst run was @xmath143 , two orders of magnitude larger .    _ conclusion 1 : _ while for simple control tasks a single run with a randomly chosen initial field usually suffices , multiple runs with different initial conditions are essential to find a control that achieves the best possible fidelity for harder control problems .",
    "an important difference in the convergence behaviour between open and closed systems is that in the latter we generally observed accelerated convergence as shown in fig .",
    "[ fig : conv](a ) , while in the dissipative case the convergence was at best linear as in fig .",
    "[ fig : conv](b ) and , in most cases , we actually observed a slowdown in the rate at which the error decreased .",
    "moreover , trapping and long tails are seen in the markovian and non - markovian cases .",
    "this behaviour is consistent with convergence to a limiting value of the error strictly greater than @xmath58 , which is expected for open systems .",
    "the accuracy of the gradient approximation is another limiting factor for very high fidelities .",
    "when quasi - newton methods are used as in our case , the errors in the gradients will eventually also lead to large errors in the approximate hessian and increasingly poor performance of the quasi - newton iteration , precluding further reductions in the errors .",
    "the algorithm should be terminated before this regime is reached .",
    "the use of analytic gradient formulae can alleviate this problem .",
    "however , even the augmented matrix exponential or spectral decomposition gradient formulae , though theoretically exact , will be subject to numerical approximation errors in practice .    _ conclusion 2 : _ trapping , long tails , and diminishing returns as a function of the iteration number for open systems make sensible termination conditions _ essential_.",
    "while for controllable closed systems it is often reasonable to set a threshold such as @xmath144 for the error as the termination condition , for open systems there are usually no strict upper bounds on the attainable fidelities and the best strategy therefore is to _ dynamically monitor _ the rate of decrease in the error and terminate the optimisation when this value becomes too low and we have reached an asymptotic regime .      assuming the model and objective have already been chosen , the algorithm depends on two key inputs : the gate operation time @xmath49 and the choice of the initial fields .",
    "an interesting question is how the choice of these parameters affects the convergence behaviour and limiting values of the fidelities attained .",
    "initial test runs suggested a dependence of the convergence behaviour on the magnitude of the initial fields , which in our case was determined by the variance of the gaussian distribution we sampled from .",
    "to better understand the effects of the target time and magnitude of the initial fields on the convergence behaviour and fidelities attained , we combined the data from many runs for initial fields with different norms ( always sampled from a normal distribution ) and different target times into 2d density plots for the _ success rate _ and the _ success speed_. the success rate here is the fraction of runs for a given choice of initial field norm and target time that reached fidelities at or above the error threshold , which we set to be @xmath145 .",
    "the success speed was defined as the inverse of the expected time required to succeed in finding a control that achieves the desired error threshold , where the expected time to succeed is computed as  @xcite @xmath146    for markovian systems one expects that there exists an optimum time to implement a desired gate with the highest possible fidelity .",
    "this time is expected to depend on the details of the system and the lindblad operators describing the effects of the bath . for shorter gate operation times",
    ", the fidelities will be lower due to a lack of time to implement the required control  @xcite ; for longer times , decoherence effects will reduce the fidelity .",
    "for non - markovian systems , there is generally no upper limit for the gate operation times and we expect longer times to improve both success rates and speeds .",
    "in fact , with a sufficiently long evolution time and no restrictions on the control fields , one can in theory always achieve perfect fidelities if the composite system evolves unitarily and is controllable , as is the case for our systems .    the success rate plots ( fig .  [ fig : success - rate ] ) for",
    "both a cnot and two - qubit identity gate do indeed suggest that there is a lower bound on the target time but no upper bound .",
    "moreover , the success rate plots for one , two , and four noise qubits are very similar and the threshold value for the gate operation time increases only marginally when more noise qubits are added , especially for the cnot gate .",
    "this suggests that neither the difficulty of finding a control nor the time required to implement the gate increases substantially when more noise qubits are added , a very desirable situation in practice .",
    "the picture is slightly less favourable for the identity gate in that the minimum time necessary to successfully implement the gate with the desired fidelity increases more significantly ( from 40 in the absence of noise qubits to about 80 for one , two , or four noise qubits ) . in the markovian case ,",
    "[ fig : success - rate](i ) does show a slight decrease in the success rate for larger gate operation times for the cnot gate , as expected based on the observation above .",
    "nevertheless , much more interesting is the success rate plot for the identity fig .",
    "[ fig : success - rate](j ) , for which there appears to be no minimum gate operation time but there is a sharp drop in the success rate when @xmath49 gets too large .    for both models ,",
    "the success rate plots for the cnot gate show a sharp drop in the success probability regardless of the target time when the amplitudes of the initial fields get too large .",
    "the success speed plots ( fig.[fig : success - speed ] ) further suggest the existence of a sweet spot ( white ) with regard to the field amplitudes for which we can expect rapid convergence . for larger initial field amplitudes , we can expect poor performance due to trapping in sub - global extrema ; for too small initial field amplitudes , we can expect slow convergence .",
    "it is therefore desirable to determine the optimum range of initial field amplitudes at the outset , which could be done by adapting the methodology which has been successful for closed systems  @xcite . in the non - markovian setting the success speed plots for both the cnot and identity gate are not too dissimilar ; in particular , the success speed plots have a sweet spot for larger target times around a certain optimum value of the initial field amplitudes . in the markovian",
    "setting , on the other hand , the shortest time to success was achieved for initial fields with a small magnitude for the cnot gate but large magnitude for the identity gate , showing that the optimum initial field amplitudes may depend on the target gate to be implemented .",
    "in general , the identity gate was harder to implement with high fidelity than the cnot .",
    "a given realization of a basic quantum information processor may thus be more effective in carrying out certain operations than others , and implementing a trivial gate may , in fact , be harder than implementing a maximally entangling gate .",
    "another interesting question is how important it is to take the effect of the environment into account when optimising the gate performance . in general",
    ", one expects a better performance when the environment is taken into account but this is computationally much more expensive .",
    "it is therefore informative to compare the performance of the fields optimised with and without taking the environment into account . to do this ,",
    "we first optimise the controls neglecting decoherence and then start the iteration in the dissipative case with an optimal control obtained for the hamiltonian case . here , we observe major differences depending on the type of environment .    in the markovian case the optimal fields obtained without the environment performed quite well  taking the decoherence mechanisms into account resulted in little , if any , improvement , as shown in fig .",
    "[ fig : refine](a ) .",
    "the blue stems in the figure indicate the error achieved when the pre - optimised fields are directly applied to the dissipative system , while the red stems indicate the final errors achieved when these fields are used as inputs for optimisation with decoherence .",
    "the red and blue stems are virtually indistinguishable which suggests that the performance of the optimal control fields obtained without considering decoherence is comparable to that obtained taking the markovian environment into account .",
    "this was the case across the board for thousands of simulations for all of the systems , gates , and markovian environments considered here .",
    "this disappointing performance of optimal control for markovian systems may seem surprising in view of some earlier work but it is actually in line with results in @xcite as substantial improvements in the fidelities achieved with optimal control in this work were observed only for a qubit encoded in a weakly relaxing subspace , a distinctly different situation from the one considered here . in general , the simulation results are consistent with the observations that open - loop coherent control can not undo the effects of markovian decoherence  @xcite .",
    "this should not be interpreted to imply that optimal control design is not useful for systems subject to markovian decoherence .",
    "optimal control generally still leads to more efficient quantum gates ; however , there are fundamental limitations and it may be necessary to combine optimal control design with other strategies such as robust encoding of quantum information or feedback .    in the non - markovian case , pre - optimised fields almost always performed poorly and the fidelities could be considerably improved by taking the noise qubits into account in the optimisation , as illustrated in fig .  [",
    "fig : refine](b ) . note that we observe a reduction in the error by about three orders of magnitude . starting with pre - optimised fields",
    "also did not improve the convergence speed or increase the attainable fidelities , compared to starting with random initial fields , suggesting that pre - optimisation is not beneficial in this case .",
    "the reason why the fields obtained without taking the noise qubits into account perform poorly can be seen if we plot the evolution of the bloch vectors of the system and noise qubits . fig .",
    "[ fig : bloch](a ) shows the evolution of a single system qubit and four noise qubits under a field optimised to implement a had gate on the system qubit without taking the noise qubits into account .",
    "we see that although the field does not excite the noise qubits directly , they are indirectly excited due to the coupling to the system qubit . in addition , although the magnitude of the excitation is much less than that of the system qubit , it is sufficient to create entanglement between the system and noise qubits , reducing the length of the bloch vector of the system qubit and the gate fidelity .",
    "when the noise qubits are taken into account in the optimisation , the algorithm finds a field that avoids indirect excitation of the noise qubits almost entirely , as shown in fig .",
    "[ fig : bloch](b ) .",
    "entanglement between the system and noise qubits in this case is negligible and the gate fidelity is restored .",
    "+   +   +   + initial and final states indicated by @xmath147 and @xmath148 , respectively .",
    "first qubit ( framed ) is the system qubit .",
    "the gate operation time is @xmath149  @xmath136 in the first three cases and @xmath150  @xmath136 in the fourth case .      in the previous calculations it was assumed that the noise qubits are shielded from the control field and that the field does not affect the environment in any way , an assumption that is not necessarily realistic . to assess the effect of field leakage we considered what happened if the noise qubits were affected by the fields as well  for example , due to field leakage . in the worst case scenario ,",
    "the field seen by nearby noise qubits will be similar to that seen by the system qubits and they may interact with the field in a similar way to the system qubits . in this case , the final fidelities significantly decreased .",
    "in fact , the optimal fields obtained without considering the effect of the field on the noise qubits proved useless , as shown in the bloch trajectory plot in figure [ fig : bloch](c ) .",
    "the noise qubits are now excited not only weakly by the coupling to the system qubit but also directly by the control field , resulting in significant excitation and entanglement between the system and noise qubits , evident by shrinkage of the length of the bloch vector ( especially for the system qubit ) .",
    "nevertheless , if leakage is taken into account in the optimisation , the results can be improved , as shown in fig .",
    "[ fig : bloch](d ) .",
    "we see that unlike in the no - leakage case ( b ) , both the system and noise qubits are excited and now undergo complex evolutions .",
    "there is intermittent entanglement and the noise qubits are left in excited states at the final time ; still , the field is such that the system qubit is disentangled from the noise qubits at the final time and the desired hadamard gate is implemented .    however , to achieve such a performance , the gate operation time had to be substantially increased from @xmath149 to @xmath150 and chosen very carefully . when the target times and time resolution of the field were kept the same as before , the results were poor .",
    "[ fig : leakage](a ) illustrates the complicated dependence of the attainable gate fidelities on the gate operation time for a single system qubit surrounded by multiple noise qubits with frequencies very close to the system qubit s frequency .",
    "only a few runs in fig .",
    "[ fig : leakage](b ) , corresponding to the dips seen in fig .",
    "[ fig : leakage](a ) , reach the error threshold of @xmath145 but these successful runs usually reach it in relatively few iterations . due to the rapid flattening out of the trajectories",
    ", most runs could have been terminated after fewer iterations as it is evident that they will not attain high fidelities .",
    "the significant increase in the amount of time needed to implement a simple single qubit gate can be explained in terms of global control . when the field leakage is taken into account ,",
    "the control problem becomes a global control problem for a five qubit system and the only way we can achieve selective excitation of a single qubit is by exploiting the differences in the resonance frequencies of the qubits .",
    "since frequency differences between the system and noise qubits are small in our case , more time is required to achieve selectivity .",
    "this suggests that the effect of leakage should be significantly reduced if the resonance frequencies of the noise qubits are significantly different from those of the system qubits .    to test this latter idea , we performed additional runs for a two - qubit system with one standard noise qubit , and the same system with a far - detuned noise qubit with @xmath151 instead . for our standard noise qubit , fig .",
    "[ fig : leakage](c ) shows that the gate errors for the two - qubit cnot gate for @xmath152 and @xmath153 are large ( blue stems ) .",
    "the gate operation times and time resolution of the field need to be increased substantially to achieve gate errors below @xmath145 ( red stems )",
    ". however , fig .",
    "[ fig : leakage](d ) demonstrates that for a far - detuned noise qubit all 100 runs for @xmath152 and @xmath153 ( and standard deviation of the initial fields equal to 1 ) reached the error threshold of @xmath145 even when the noise qubit was not shielded , provided the effects of the fields on the noise qubit were taken into account in the optimisation .",
    "accordingly , shielding the noise qubits from the control field may not be necessary , provided they are sufficiently detuned from the system qubit frequencies .",
    "this suggests that increasing the detuning of the noise qubits from the system qubits could be one way to mitigate the effect of the control fields on the noise qubits if leakage is unavoidable .",
    "for instance , this could be achieved via control electrodes  @xcite acting on the noise qubits ( although in practice such direct control of the noise qubits could be technologically challenging ) . in this case , if the noise qubit frequencies are too similar to the system qubit frequencies and they can not be shielded , high fidelities and good gate operation times may be out of reach even with the best optimal control .      while finding solutions that achieve high fidelities is crucial and optimising the algorithms and parameters to achieve rapid convergence",
    "is highly desirable , not all optimal control solutions are created equal . in practice ,",
    "the feasibility of the implementation of a control depends on its basic characteristics such as its pulse energy , amplitude , and bandwidth .",
    "generally , fields with lower amplitudes and pulse energies are desirable as strong fields can be more difficult to implement and cause unwanted excitations or may even break the model the optimisation is based on .",
    "in the markovian case , analysis of the maximum field amplitudes of a large number of successful runs , that is , runs that achieved gate errors @xmath142 , revealed a strong correlation with the magnitude of the initial fields , as determined by the standard deviation @xmath94 of the gaussian distribution we sample from .",
    "this can be seen in the histogram plots of the maximum field amplitudes for 100 successful runs , for different values of the standard deviation of the initial fields ( fig .",
    "[ fig : hist ] ) .",
    "in particular , low - amplitude initial fields ( @xmath94 small ) produce a narrow distribution with a small median value , meaning we are likely to converge to a low - amplitude field if we start with an initial field with a small amplitude . accordingly , there is no need for the addition of penalty terms to the objective functional to constrain the field amplitudes .",
    "penalty terms are generally undesirable as they prevent the algorithm from converging to a global optimum of the objective function and lead to slower convergence . in some cases",
    " for example , fig .",
    "[ fig : hist](b )  the distribution has a long tail , that is , there are some runs starting with small fields that nonetheless converge to high - amplitude solutions .",
    "however , the probability of this happening is generally small , and if we do converge to a field with unexpectedly large amplitudes , we can most likely find a better solution by repeating the unconstrained optimisation with another suitably low - amplitude initial field .    in the non - markovian case ,",
    "we observe similar behaviour but the maximum field amplitude histograms tend to be less sharply peaked than in the markovian case and can exhibit multi - modal features as in fig .",
    "[ fig : hist](d ) . in some cases",
    ", we also observe scattered outliers , which are fields with maximum amplitudes orders of magnitude greater than the median of the distribution , as shown in fig .",
    "[ fig : hist](c ) . in this",
    "setting , there can be substantial differences in the amplitudes of the optimal fields for initial fields with the same standard deviation ; furthermore , the maximum amplitudes and energies of the optimal fields can be substantially reduced by running the algorithm several times to find a solution belonging to the lowest amplitude peak .",
    "we also studied the correlations between the initial and final field fluences .",
    "as shown in fig .",
    "[ fig : scatter ] , for large initial fluences , the final fluences cluster around large values that appear to be proportional to the initial fluence . for initial fluences below a certain value , the distribution of final fluences stabilises , so that we can not decrease the fluence of the optimal fields below a certain threshold regardless of how small we choose the initial fluences .",
    "one way to explain this behaviour is that there is a certain minimum energy required to achieve the control objective .",
    "if we start with initial fields with energies ( fluences ) well below this value , the algorithm has to increase the field energy at least until we reach the minimum energy required to achieve the control objective .",
    "if we start with fields well below this minimum energy threshold , it may take many iterations to reach a regime where optimal controls exist , thus increasing the time required to find a solution .",
    "on the other hand , if we start with fluences well above the minimum required to achieve the control objective , the algorithm has no pressure to decrease the field energy  as we impose no penalty on the field fluences or amplitudes  and thus is likely to converge to an undesirable high - energy pulse .",
    "there is thus a best value for the variance of the initial fields to encourage rapid convergence to a low - energy optimal field .",
    "we have presented a general framework for optimal control of quantum processes for systems in markovian and non - markovian environments . by suitable discretisation of the fields",
    ", we can reduce the complexity of the simulations and obtain analytic gradient formulae that enable us to apply efficient gradient - based optimisation algorithms such as second order quasi - newton methods .",
    "to better understand the performance of the algorithms and the influence of parameters such as gate operation times and initial fields , we introduced new notions of success rates and speeds and used density plots as a new investigative tool . using these tools combined with convergence and statistical analyses of basic characteristics of the optimal fields",
    ", we have investigated the reliability and efficiency with which optimally controlled quantum gates can be implemented on one , two , and three system qubits in markovian and non - markovian models . although both models are based on rather different assumptions , the results for the control optimisation share some similarities .",
    "first , the success rate and speed plots show that both the target gate operation times and magnitudes of the initial fields have a significant impact on the success rates and the expected times to succeed . for non - markovian systems , however , the need to exploit coherence revivals can lead to a complex dependence of the attainable fidelities on the target times especially when the noise qubits are not shielded from the control and have similar frequencies as the system qubits . the success rate and speed plots also suggest that starting with too large field amplitudes increases the likelihood of trapping in many cases , and an analysis of the amplitude distributions for the optimal fields obtained shows that it can also lead to convergence to generally undesirable high - energy optimal fields .",
    "too small amplitudes , on the other hand , tend to result in a slow convergence .",
    "it is therefore desirable to determine the optimum range of the initial field amplitudes , based on knowledge of the actual physical system under consideration  @xcite .",
    "performing several optimisation runs for different initial fields is advantageous in all regimes considered . in the non - markovian case , due to the spread of asymptotic fidelity values , more than one attempt may be needed to obtain a suitably low error solution . with no environment ,",
    "a run which suffers from severe slowdown , even if only intermittently , can be abandoned in favour of starting a fresh run having a lower expected time to completion . in the markovian case ,",
    "both of these reasons apply and it is even more obvious than for non - markovian systems that termination conditions are needed to avoid wasting time on the long tails observed in the convergence plots .",
    "another reason to perform several runs is the considerable variability in the average and maximum amplitudes of the optimal fields across runs .",
    "this issue can also be addressed by imposing constraints during the optimisation procedure , in contrast to adding penalty terms to the objectives ( which should be avoided since they limit the reachable fidelities  @xcite ) .    however , there are also significant differences in the results for the two models .",
    "although optimal control is beneficial to find efficient solutions in both cases , in the markovian setting the potential for optimal control is significantly reduced as the control can not undo the effects of the environment , at least not if we are limited to open - loop coherent control . in that case",
    ", the benefits of optimal control are mainly the ability to implement operations faster or to reduce the detrimental effects of the environment by taking advantage of low - decoherence subspaces ( if these exist ) .",
    "results showing longer target times to be detrimental in the markovian setting , at least in the absence of low - decoherence subspaces , support this conclusion .",
    "perhaps the most surprising result of our simulations , however , is that the fields optimised without taking the environment into account still seemed to be optimal in the markovian setting , at least if the decoherence is relatively uniform and sufficiently weak to be considered a perturbation of the hamiltonian evolution .",
    "this was the case for all of the thousands of runs performed for single , two- , and three - qubit gates and various initial conditions .",
    "furthermore , the simulations strongly suggest that the precise type of markovian environment is not particularly important in that the fields that were optimal for independent dephasing in the @xmath137-basis achieved virtually the same performance for dephasing in the @xmath138-basis .",
    "interestingly , independent relaxation ( spontaneous emission ) of the same strength was slightly less detrimental to the gate fidelities while correlated dephasing proved slightly more detrimental for the multi - qubit gates .",
    "these results contrast with earlier work @xcite and suggest that more work is necessary to understand the mechanisms of action and fundamental limitations of optimal open - loop coherent control in the markovian setting .",
    "the situation is very different in the non - markovian setting . in this case , the control , even if its action is limited to the system , can fully take advantage of memory effects in the environment to restore coherence to and decouple the system from the environment , given sufficient time and control strength .",
    "in contrast to the markovian case , longer gate operation times are actually advantageous and accurate knowledge of the system - bath coupling is crucial . while in the markovian case knowledge of the effective strength and uniformity of environmental effects is sufficient ( and there is no need to know the precise type of coupling ) , fields optimised without taking the system - bath coupling into account , or optimised for a different type of bath , tend to perform poorly in the non - markovian setting .",
    "this is consistent with earlier observations in the literature and suggests the need for accurate characterisation of the system - bath coupling .",
    "further work is necessary to precisely quantify the degree of knowledge that is required .",
    "the bloch trajectory analysis of a subset of the simulations further suggests that the fields optimised taking the system - bath coupling into account mainly act by manipulating the system as needed while at the same time decoupling it from and thus preventing excitation of the bath .",
    "specific to the non - markovian model , field leakage proved to be a major problem : the final fidelities decreased significantly when the field also acted on the noise qubits and optimal fields obtained without considering this effect proved effectively useless .",
    "more importantly , to restore high fidelities in the presence of field leakage generally required substantial increases in the gate operation times unless the frequencies of the noise qubits differed significantly from those of the system qubits .",
    "the mechanisms of action of the controls also shifted from suppression of bath excitation  now no longer possible  to exploiting interference effects to effectively disentangle the system and bath at the target time , while permitting substantial entanglement between system and bath at intermediate times .",
    "this suggests that field leakage is an important issue in practice that requires further study .",
    "sgs acknowledges financial support from epsrc advanced research fellowship ep / d07192x/1 and hitachi .",
    "pdf was supported by a hitachi / epsrc case studentship ."
  ],
  "abstract_text": [
    "<S> we study the implementation of one- , two- , and three - qubit quantum gates for interacting qubits using optimal control . </S>",
    "<S> different markovian and non - markovian environments are compared and efficient optimisation algorithms utilising analytic gradient expressions and quasi - newton updates are given for both cases . </S>",
    "<S> the performance of the algorithms is analysed for a large set of problems in terms of the fidelities attained and the observed convergence behaviour . </S>",
    "<S> new notions of success rate and success speed are introduced and density plots are utilised to study the effect of key parameters , such as gate operation times , and random variables , such as the initial fields required to start the iterative algorithm . </S>",
    "<S> core characteristics of the optimal fields are statistically analysed </S>",
    "<S> . substantial differences between markovian and non - markovian environments in terms of the possibilities for control and the control mechanisms are uncovered . </S>",
    "<S> in particular , in the markovian case it is found that the optimal fields obtained without considering the environment can not be improved substantially by taking the environment into account and the fidelities attained are determined mostly by the gate operation time as well as the overall strength of the environmental effects . </S>",
    "<S> computation time is saved if the fields are pre - optimised neglecting decoherence . in the non - markovian case , </S>",
    "<S> on the other hand , substantial improvements in the fidelities are observed when the details of the system - bath coupling are taken into account . in that case , </S>",
    "<S> field leakage is shown to be a significant issue which can make high gate fidelities impossible to obtain unless both the system and noise qubits are fully controlled . </S>"
  ]
}