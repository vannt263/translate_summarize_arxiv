{
  "article_text": [
    "after the 2008 financial crisis , it has become clear that a better understanding of the mechanisms and dynamics underlying the networked worldwide economy is vital @xcite . among the possible channels of interaction among countries",
    ", international trade plays a major role @xcite . combined together",
    ", the worldwide trade relations can be interpreted as the connections of a complex network , the international trade network ( itn ) @xcite , whose understanding and modeling is one of the traditional goals of macroeconomics .",
    "the standard model of non - zero trade flows , inferring the volume of bilateral trade between any two countries from the knowledge of their gross domestic product ( @xmath0 ) and mutual geographic distance ( @xmath1 ) , is the so - called ` gravity model ' of trade @xcite . in its simplest form ,",
    "the gravity model predicts that the volume of trade between countries @xmath2 and @xmath3 is @xmath4 note that the above expression , as well as the rest of this paper , focuses on the undirected version of the network for simplicity . in this representation",
    ", the trade from country @xmath2 to country @xmath3 and the trade rom country @xmath3 to country @xmath2 are combined together .",
    "given the highly symmetric structure of the itn , this simplification retains all the basic network properties of the system @xcite .    in its simplest form",
    ", the gravity model is fitted on the non - zero weights observed between all pairs of _ connected _ countries .",
    "this means that the model can predict the pair - specific volume of trade only _",
    "after _ the presence of the trade relation itself has been established @xcite .",
    "this intrinsic limitation is alarming , since almost half of the links in the itn are missing @xcite .",
    "although several improvements and generalizations of the standard gravity model have been proposed to overcome this problem ( see @xcite for excellent reviews ) , so far none of them succeeded in reproducing the observed complex topology and the observed volumes simultaneously .",
    "moreover , the various attempts have not been conceived under a unique theoretical framework and are therefore based on the combination of different mechanisms ( e.g. one for establishing the presence of a trade relation , and one for establishing its intensity ) . in general , the challenge of successfully predicting , via only one mechanism , both trade probabilities and trade volumes remains an open problem .    over the past years",
    ", the problem of replicating the observed structure of the itn has been extensively approached using network models @xcite and , more indirectly , maximum - entropy techniques to reconstruct networks from partial information @xcite .",
    "these studies have focused both on the purely binary architecture ( defined solely by the existence of trade exchanges between world countries ) @xcite and on the weighted structure ( when also the magnitude of these interactions is taken into account ) @xcite .",
    "what clearly emerges is that both topological and weighted properties of the network are deeply connected with purely macroeconomic properties ( in particular the gdp ) governing bilateral trade volumes @xcite .",
    "however , it has also been clarified that , while the knowledge of the degree sequence ( i.e. the number of trade partners for each country ) allows to infer the the entire binary structure of the network with great accuracy @xcite , the knowledge of the strength sequence ( i.e. the total volume of trade for each country ) gives a very poor prediction of all network properties @xcite . indeed , the network inferred only from the strength sequence has a trivial topology , being much denser ( if integer link weights are assumed @xcite ) or even fully connected ( if continuous weights are assumed @xcite ) , and in any case much more homogeneous than the empirical one .",
    "this limitation leads back to the main drawback of the gravity model .",
    "indeed , it has been shown that a simplified version of the gravity model ( with @xmath5 and @xmath6 ) can be recovered as a particular case of a maximum - entropy model with given strength sequence ( and continuous link weights ) @xcite .",
    "combined together , the high informativeness of the degree sequence for the binary representation of the itn and the low informativeness of the strength sequence for its weighted representation contradict the naive expectation that , once aggregated at the country level , weighted structural properties ( the strengths ) are _ per se _ more informative than purely binary properties ( the degrees ) .",
    "this puzzle has generated further interest around the challenge of finding a unique mechanism predicting link probabilities and link weights simultaneously .    as a step forward in this direction , an improved reconstruction approach @xcite , based on an analytical maximum - likelihood estimation method @xcite , has been recently proposed in order to construct more sophisticated maximum - entropy ensembles of weighted networks .",
    "this approach builds on previous mathematical results @xcite characterizing a network ensemble where both the degree and the strength sequences are constrained .",
    "the graph probability is the so - called generalized bose - fermi distribution @xcite , and the resulting network model goes under the name of enhanced configuration model ( ecm ) @xcite . when used to reconstruct the properties of several empirical networks , the ecm shows a significant improvement with respect to the case where either only the degree sequence ( binary configuration model , bcm for short ) or only the strength sequence ( weighted configuration model , wcm for short ) is constrained .",
    "one therefore expects that combining the knowledge of strengths and degrees is precisely the ingredient required in order to successfully reproduce the itn from purely local information .",
    "indeed , a more recent study has showed that , when applied to international trade data ( both aggregated and commodity - specific ) , the method successfully reproduces the key properties of the itn , across different years and for different levels of aggregation ( i.e. for different commodity - specific layers ) @xcite .",
    "however , in itself the ecm is a network reconstruction method , rather than a genuine model of network formation . to turn it into a proper network model for the itn structure",
    ", it would be necessary to find a macroeconomic interpretation for the underlying variables involved in the method .",
    "this operation would correspond to what has already been separately performed at a purely binary level ( by identifying a strong relationship between the gdp and the variable controlling the degree of a country in the bcm @xcite ) and at a purely weighted level ( by finding a relationship between the gdp and the variable controlling the strength of a country in the wcm @xcite , in the same spirit of the gravity model ) . generalizing the above results to the combination of strengths and degrees",
    "is not obvious , given the different mathematical expressions characterizing the ecm , the bcm and the wcm .",
    "in this paper we show that , indeed , the variables of the ecm are all strongly correlated with the gdp .",
    "this result gives a macroeconomic interpretation of the parameters values satisfying the itn constraints .",
    "reversing the perspective , this result enables us to introduce the first gdp - driven model that successfully reproduces the binary and the weighted properties of the itn simultaneously .",
    "finally , we show that the ecm model can be replaced by a simpler , two - step model that reconciles the binary projection of the ecm model with the topology predicted by the bcm .",
    "these results represent a promising step forward in the formulation of a unified model for the structure of the itn .",
    "since our results are a generalization of previous maximum - entropy approaches to the characterization of the itn , in this section we first briefly review the main results of those approaches , while our new findings are presented in the next section . in so doing , we gradually introduce the mathematical building blocks of our analysis and illustrate our main motivations .",
    "moreover , since previous studies have used different data sets , we also recalculate the quantities of interest on the same data set that we will use later for our own investigation .",
    "this allows us to align the results of previous approaches and properly compare them with our new findings .",
    "we use yearly bilateral data on exports and imports from the united nations commodity trade database ( un comtrade ) @xcite from year 1992 to 2004 .",
    "the sample refers to 13 years , 1992 - 2004 , represented in current u.s .",
    "dollars , and disaggregated over 97 commodity classes . in this paper",
    "we analyze the aggregated level , which results in 13 yearly temporal snapshots of undirected total trade flows .",
    "our network consists of @xmath7 countries , present in the data throughout the considered temporal interval .",
    "+ this data set was the subject of many studies exploring both purely the binary representation , and its full weighted representation @xcite .",
    "another data set which is widely used to represent the itn network is the trade data collected by gleditsch @xcite .",
    "the data contain the detailed list of bilateral import and export volumes , for each country in the period 1950 - 2000 .",
    "if one focuses solely on the binary undirected projection of the itn , then the binary configuration model ( bcm ) represents a very successful maximum - entropy model . in the bcm , the local knowledge of the number of trade partners of each country , i.e. the degree sequence ,",
    "is specified .",
    "it has been shown that higher - order properties of the itn can be simply traced back to the knowledge of the degree sequence @xcite .",
    "this result adds considerable information to the standard results of traditional macroeconomic analyses of international trade .",
    "in particular , it suggests that the degree sequence , which is a purely topological property , needs to be considered as an important target quantity that international trade models , in contrast with the mainstream approaches in economics , should aim at reproducing @xcite .",
    "let us first represent the observed structure of the itn as a weighted undirected network specified by the square matrix @xmath8 , where the specific entry @xmath9 represents the weight of the link between country @xmath2 and country @xmath3 .",
    "then , let us represent the binary projection of the network in terms of the binary adjacency matrix @xmath10 , with entries defined as @xmath11,\\:\\forall\\:{i , j}$ ] .",
    "a maximum - entropy ensemble of networks is a collection of graphs where each graph is assigned a probability of occurrence determined by the choice of some constraints .",
    "the bcm is a maximum - entropy ensemble of binary graphs , each denoted by a generic matrix @xmath12 , where the chosen constraint is the degree sequence . in the canonical formalism @xcite",
    ", the latter can be constrained by writing the following hamiltonian : @xmath13 where the degree sequence is defined as @xmath14,\\:\\forall\\:{i}$ ] . as a result of the constrained maximization of the entropy @xcite",
    ", the probability of a given configuration @xmath12 can be written as @xmath15^{a_{ij}}\\left [ \\frac{1}{1+z_iz_j}\\right]^{1-a_{ij}}\\ ] ] where @xmath16 and @xmath17 .",
    "the latter represents the probability of forming a link between nodes @xmath2 and @xmath3 , which is also the expected value @xmath18 according to the maximum - likelihood method proposed in @xcite , the vector of unknowns @xmath19 can be numerically found by solving the system of @xmath20 coupled equations @xmath21 where the expected value of each degree @xmath22 is matched to the observed value @xmath23 in the real network @xmath24 .",
    "the ( unique ) solution will be indicated as @xmath25 . when inserted back into eq.([eq_pzz ] ) , this solution allows to analytically describe the binary ensemble matching the observed constraints .",
    "being the result of the maximization of the entropy , this ensemble represents the least biased estimate of the network structure , based only on the knowledge of the empirical degree sequence .    in fig .",
    "[ fig1 ] we plot some higher - order topological properties of the itn as a function of the degree of nodes , for the 2002 snapshot .",
    "these properties are the so - called average nearest neighbor degree and the clustering coefficient . for both quantities ,",
    "we plot the observed values ( red points ) and the corresponding expected values predicted by the bcm ( blue points ) .",
    "the exact expressions for both empirical and expected quantities are provided in the appendix .",
    "we see that the expected values are in very close agreement with the observed properties .",
    "these results replicate recent findings @xcite based on the same un comtrade data .",
    "they show that at a binary level , the degree correlations ( disassortativity ) and clustering structure of the itn are excellently reproduced by the bcm .",
    "as we also confirmed in the present analysis , these results were found to be very robust , as they hold true over time and for various resolutions ( i.e. , for different levels of aggregation of traded commodities ) @xcite .",
    "it should be noted that eq.([eq_pzz ] ) can be thought of as a particular case of the so - called _ fitness model _",
    "@xcite , which is a popular model of binary networks where the connection probability @xmath26 is assumed to be a function of the values of some ` fitness ' characterizing each vertex .",
    "indeed , the variables @xmath25 can be treated as fitness parameters @xcite which control the probability of forming a link . a very interesting correlation between a fitness parameter of a country ( assigned by the model ) and the @xmath0 of the same country",
    "was found @xcite .",
    "this relation is replicated here in fig .",
    "[ fig2 ] , where the rescaled @xmath0 of each country ( @xmath27 ) is compared to the value of the fitness parameter @xmath28 obtained by solving eq.([maxlike ] ) .",
    "the red line is a linear fit of the type @xmath29     the calculated @xmath30 , compared with the @xmath31 ( re - scaled gdp ) for each country for the undirected binary aggregated itn in the 2002 snapshot , with the linear fit @xmath32 ( red line ) . ]",
    "this leads to a more economic interpretation where the fitness parameters can be replaced ( up to a proportionality constant ) with the @xmath0 of countries , and used to reproduce the properties of the network .",
    "this procedure , first adopted in @xcite , can give predictions for the network based only on macroeconomic properties of countries , and reveals the importance of the @xmath0 in to the binary structure of the itn .",
    "importantly , this observation was the first empirical evidence in favour of the fitness model as a powerful network model @xcite .",
    "likewise , other studies have shown that the observed topological properties turn out to be important in explaining macroeconomics dynamics @xcite .          despite the importance of the topology ,",
    "the latter is only the backbone over which goods are traded , and the knowledge of the volume of such trade is extremely important . to be able to give predictions about the weight of connections",
    ", one needs to switch from an ensemble of binary graphs to one of weighted graphs .",
    "the simplest weighted counterpart of the bcm is the wcm , which is a maximum - entropy ensemble of weighted networks where the constraint is the strength sequence , i.e. the total trade of each country in the case of the itn .",
    "recent studies have shown that the higher - order binary quantities predicted by the wcm , as well as the corresponding weighted quantities , are very different from the observed counterparts @xcite .",
    "more specifically , the main limitation of the model is that of predicting a largely homogeneous and very dense ( sometimes fully connected ) topology .",
    "roughly speaking , the model excessively ` dilutes ' the total trade of each country by distributing it to almost all other countries .",
    "this failure in correctly replicating the purely topological projection of the real network is the root of the bad agreement between expected and observed higher - order properties .",
    "just like the bcm has been related to the fitness model @xcite , a variant of the wcm has been related to the gravity model @xcite .",
    "the variant is actually a continuous version of the wcm , where the strength sequence is constrained and the weights are real numbers instead of integers .",
    "when applied to the itn , the model gives the following expectation for the weight of the links : @xmath33 where @xmath34 is the total strength in the network , and @xmath31 is the re - scaled @xmath0 as before @xcite .",
    "in essence , the above expression identifies again a relationship between the @xmath0 and the hidden variable ( analogous to the fitness in the binary case ) specifying the strength of a node .    equation ( [ eq_ff ] ) coincides with eq.([eq_gravity ] ) where @xmath5 and @xmath6 .",
    "the model therefore corresponds to a particularly simple version of the gravity model .",
    "indeed , the model reproduces reasonably well the observed non - zero weights of the itn @xcite .",
    "however , just like the gravity model , the model predicts a complete graph where @xmath35 , and dramatically fails in reproducing the binary architecture of the network . this can be easily shown by realizing that the continuous nature of edge weights , which can take non - negative real values in the model , implies that there is a zero probability of generating zero weights ( i.e. missing links ) .",
    "we will show the prediction of this model in comparison with our results later on in the paper .",
    "motivated by the challenge to satisfactorily model both the topology and the weights of the itn , the ecm has been recently proposed as an improved model of this network @xcite .",
    "the ecm focuses on weighted networks , and can enforce the degree and strength sequence simultaneously @xcite .",
    "it builds on the so - called generalized bose - fermi distribution that was first introduced as a null model of networks with coupled binary and weighted constraints @xcite .    in the ecm",
    ", the degree and strength sequence can be constrained by writing the following hamiltonian : @xmath36\\ ] ] where the strength sequence is defined as @xmath37 and the degree sequence as @xmath38,\\:\\forall\\:i$ ] . as a result",
    ", the probability of a given configuration @xmath39 can be written as    @xmath40    with @xmath41 and @xmath42 .",
    "the ecm gives the following predictions about the probability of a link ( @xmath43 ) and the expected weight of the link ( @xmath44 ) : @xmath45    according to the maximum - likelihood method proposed in @xcite , the vectors of unknowns @xmath46 and @xmath47 can be numerically found by solving the system of @xmath48 coupled equations @xmath49 and will be indicated as @xmath50 and @xmath51 .",
    "these unknown parameters can be treated as fitness parameters which control the probability of forming a link and the expected weight of that link simultaneously .",
    "the application of the ecm to various real - world networks shows that the model can accurately reproduce the higher - order empirical properties of these networks @xcite .",
    "when applied to the itn in particular , the ecm replicates both binary and weighted empirical properties , for different levels of disaggregation , and for several years ( temporal snapshots ) @xcite . indeed , in fig .",
    "[ fig3 ] we show the higher - order binary quantities ( average nearest neighbor degree and clustering coefficient ) as well as their weighted ones ( average nearest neighbor strength and weighted clustering coefficient ) for the 2002 snapshot of the itn .",
    "we compare the observed values ( red points ) and the corresponding quantities predicted by the ecm ( blue points ) .",
    "the mathematical expressions for all these quantities are provided in the appendix .",
    "we find a very good agreement between data and model , confirming the recent results in @xcite for the data set we are using here .",
    "we also confirmed that these results are robust for several temporal snapshots @xcite .",
    "considering the promising results of the ecm , we now make a step forward and check whether the hidden variables @xmath52 and @xmath53 , which effectively reproduce the observed itn , can be thought of as ` fitness ' parameters having a clear economic interpretation .",
    "this amounts to check whether the relation shown previously in fig .",
    "[ fig2 ] for the purely binary case can be generalized in order to find a macroeconomic interpretation to the abstract fitness parameters in the general weighted case as well .",
    "the calculated @xmath52 ( left panel ) and @xmath54 ( right panel ) compared with the @xmath31 ( rescaled gdp ) for each country for the undirected binary aggregated itn in the 2002 snapshot , with the linear fits ( in log - log scale ) @xmath55 , and @xmath56 ( red lines ) , where a , b , and c are the fitted constant parameters per year . ]    in fig .",
    "[ fig4 ] we show the relationship between the two parameters @xmath52 and @xmath53 and the rescaled @xmath0 ( @xmath31 ) for each country of the itn in the 2002 snapshot .",
    "we find strong correlations between these quantities .",
    "the fitness parameter @xmath52 turns out to be in a roughly linear relation with the rescaled gdp @xmath31 , fitted by the curve @xmath57 where @xmath58 is the fitted constant , and @xmath59 ( all the @xmath0s are relative to that specific year ) .",
    "it should be noted that this relation is similar to that found between @xmath30 and @xmath31 in the bcm and shown previously in fig.[fig2 ] , but less accurate .",
    "this observation will be useful later .",
    "by contrast , since the @xmath0 is an unbounded quantity , while the fitness parameter @xmath53 is bounded between 0 and 1 ( this is a mathematical property of the model @xcite ) , the relation between @xmath53 and @xmath31 is necessarily highly nonlinear .",
    "a simple functional form for such a relationship is given by @xmath60 indeed , fig .",
    "[ fig4 ] confirms that the above expression provides a very good fit to the data .",
    "we checked that the above results hold systematically over time , for each snapshot of the itn in our data set .",
    "this implies that , in a given year , we can insert eqs.([eq_xx ] ) and ( [ eq_yy ] ) into eqs.([eq_pp ] ) and ( [ eq_ww ] ) to obtain a gdp - driven model of the itn structure for that year .",
    "such a model highlights that the @xmath0 has a crucial role in shaping both the binary and the weighted properties of the itn .",
    "while this was already expected on the basis of the aforementioned results obtained using the bcm and the wcm ( or the corresponding simplified gravity model ) separately , finding the appropriate way to explicitly combine these results into a unified description of the itn has remained impossible so far .",
    "rather than exploring in more detail the predictions of the gdp - driven model in the form described above , we first make some considerations leading to a simplification of the model itself .      at this point",
    ", it should be noted that we arrived at two seemingly conflicting results .",
    "we showed that both the bcm and ecm give a very good prediction for the binary topology of the network .",
    "however , eqs.([eq_pzz ] ) and ( [ eq_pp ] ) , which specify the connection probability @xmath26 in the two models , are significantly different .",
    "the comparable performance of the bcm and the ecm at a binary level ( see figs.[fig1 ] and [ fig3 ] ) makes us expect that , when the specific values @xmath25 and @xmath50 are inserted into eqs.([eq_pzz ] ) and ( [ eq_pp ] ) respectively , the values of the connection probability become comparable in the two models , despite the different mathematical expressions .    in fig .",
    "[ fig5 ] we compare the the two probabilities for the itn in the 2002 snapshot .",
    "note that each point refers to the probability of creating a link between a pair of countries , which results in @xmath61 points .",
    "indeed , we can see that the values are scattered along the identity line , confirming the expectation that the connection probability has similar value in the two models .",
    "the above result allows us to make a remarkable simplification . in eqs.([eq_pp ] ) and ( [ eq_ww ] ) , we can replace the expression for @xmath26 provided by the ecm with that provided by the bcm in eq.([eq_pzz ] ) . to avoid confusion ,",
    "we denote the new probability with @xmath62 , where @xmath63 stands for ` two - step ' , for a reason that will be clear immediately .",
    "this results in the following equations for the expected network properties : @xmath64 where the @xmath30 s , and therefore the @xmath65 s , depend only on the degrees through eq.([maxlike ] ) , while the @xmath53 s and the @xmath66 s depend on both strengths and degrees through eqs.([eq_kk ] ) and ( [ eq_ss ] ) .    in this simplified model the connection probability , which fully specifies",
    "the topology of the ensemble of networks , no longer depends on the strengths as in the ecm , while the weights still do .",
    "this implies that we can specify the model via a two - step procedure where we first solve the @xmath20 equations determining @xmath62 via the degrees , and then find the remaining variables determining @xmath66 through the ecm .",
    "for this reason , we denote the model as the two - step ( ts ) model .",
    "the probability of forming a link in the ecm @xmath67 compared to the probability in the bcm @xmath68 for the undirected binary aggregated itn in the 2002 snapshot .",
    "the red line describes the identity line . ]",
    "the probability of a configuration @xmath39 reads @xmath69 where @xmath70 is the probability that a link of weight @xmath71 connects the nodes ( countries ) @xmath2 and @xmath3 .",
    "the above probability has the same general expression as in the original ecm @xcite , but here @xmath30 comes from the estimation of the simpler bcm .",
    "it is instructive to rewrite ( [ prob ] ) as @xmath72 to highlight the random processes creating each link . as a first step",
    ", one determines whether a link is created or not with a probability @xmath62 .",
    "if a link ( of unit weight ) is indeed established , a second attempt determines whether the weight of the same link is increased by another unit ( with probability @xmath73 ) or whether the process stops ( with probability @xmath74 ) .",
    "iterating this procedure , the probability that an edge with weight @xmath75 is established between nodes @xmath2 and @xmath3 is given precisely by @xmath76 in eq.([prob2 ] ) .",
    "the expected weight @xmath66 is then correctly retrieved as @xmath77 .    using the relations found in eqs.([eq_zz ] ) and ( [ eq_yy ] ) , we can input the @xmath31 as the fitness parameters into eqs.([eq_pts ] ) and ( [ eq_wts ] ) to get the following expressions that mathematically characterize our gdp - driven specification of the ts model : @xmath78 the above equations can be used to reverse the approach used so far : rather than using the @xmath48 free parameters of the ecm ( @xmath46 and @xmath47 ) or of the ts model ( @xmath19 and @xmath47 ) to fit the models on the observed values of the degrees and strengths",
    ", we can now use the knowledge of the gdp of all countries to obtain a model that only depends on the three parameters @xmath79 , @xmath80 , @xmath81 . assigning values to these parameters",
    "can be done using two techniques : maximization of the likelihood function and non - linear curve fitting . since the model is a two - step one , we can first assign a value to the parameter @xmath79 , and only in the second step ( once @xmath79",
    "is set ) we fit the parameters @xmath80 and @xmath81 .",
    "we chose to fix @xmath79 by maximizing the likelihood function @xcite , which results in constraining the expected number of links to the observed number ( @xmath82 ) , as in @xcite .",
    "fixing the values of @xmath80 and @xmath81 is slightly more complicated .",
    "since the model uses the approximated expressions of the ts model , rather than those of the original ecm model , maximizing the likelihood function in the second step no longer yields the desired condition @xmath83 , where @xmath34 is the total strength in the network .",
    "similarly , extracting the parameters from the fit as shown in fig .",
    "[ fig4 ] does not maintain the total strength in the network .",
    "in absence of any a - priori preference , we chose the latter procedure , due to its relative numerical simplicity with respect to the former one .        in fig .",
    "[ fig6 ] we show a comparison between the higher - order observed properties of the itn in 2002 and their expected counterparts predicted by the gdp - driven ts model .",
    "again , the mathematical expressions of these properties are provided in the appendix . as a baseline comparison ,",
    "we also show the predictions of the @xmath0-driven wcm model with continuous weights described by eq.([eq_ff ] ) @xcite , which coincides with a simplified version of the gravity model as we mentioned .",
    "we see that the gdp - driven ts model reproduces the empirical trends very well .",
    "of course , as expected , the predictions in fig.[fig6 ] ( which use only three free parameters ) are more noisy than those in fig.[fig3 ] ( which use @xmath48 free parameters ) .",
    "this is due to the fact that eqs.([eq_zz ] ) and ( [ eq_yy ] ) describe fitting curves rather than exact relationships .",
    "importantly , our model performs significantly better than the wcm / gravity model in replicating both binary and weighted properties .",
    "again , the drawback of these models lies in the fact that they predict a fully connected topology and a relatively homogeneous network .",
    "it should also be noted that the plot of average nearest neighbor strength ( @xmath84 ) predicted by our model is slightly shifted with respect to the observed points .",
    "this effect is due to the fact that , as we mentioned , the total strength @xmath34 ( hence the average trend of the @xmath84 ) is only approximately reproduced by our model , as a result of the simplification from the ecm to the ts model .    as for all the other results in this paper",
    ", we checked that our findings are robust over the entire time span of our data set .",
    "we therefore conclude that the ecm model , as well as its simplified ts variant , can be successfully turned into a fully gdp - driven model that simultaneously reproduces both the topology and the weights of the itn .",
    "+ the success of the ts model has an important interpretation .",
    "looking back at eqs.([eq_pts ] ) and ( [ twostep1 ] ) , we recall that the effect of the ts approximation is the fact that the connection probability @xmath62 can be estimated separately from the weights @xmath66 , using only the knowledge of the degree sequence if eq.([eq_pts ] ) is used , or the gdp and total number of links if eq.([twostep1 ] ) is used , while discarding that of the strengths . by contrast",
    ", the estimation of the expected weights @xmath66 can not be carried out separately , as it requires that the connection probability @xmath62 appearing in eqs.([eq_wts ] ) and ( [ twostep2 ] ) is estimated first .",
    "this asymmetry of the model means that the topology of the itn can be successfully inferred without any information about the weighted properties , while the weighted structure can not be inferred without topological information .",
    "the expressions defining the ts model provide a mathematical explanation for this otherwise puzzling effect that has already been documented in previous analyses of the itn @xcite .",
    "in this paper we have introduced a novel @xmath0-driven model which successfully reproduces both the binary and weighted properties of the itn .",
    "the model uses the @xmath0 of countries as a sort of macroeconomic fitness , and reveals the existence of strong relations between the @xmath0 and the model parameters controlling the formation and the volume of trade relations . in the light of the limitations of the existing models ( most notably the binary - only nature of the fitness model and the weighted - only nature of the gravity model ) , we believe that our results represent a promising step forward in the development of a unified model of the itn structure .",
    "we have also shown that the full ecm model can be effectively reduced to the simpler ts model .",
    "the success of the latter provides a mathematical explanation of an otherwise puzzling asymmetry , namely the fact that purely topological properties can be successfully predicted without knowing the weights , while weighted network properties can only be predicted if the topological ones are preliminary estimated .",
    "future work should explore how to further improve these results and possibly expand them by introducing additional macroeconomic parameters like geographic distance , thus fully bridging the gap between network - based and gravity - based approaches to the structure of international trade .",
    "aa and dg acknowledge support from the dutch econophysics foundation ( stichting econophysics , leiden , the netherlands ) with funds from beneficiaries of duyfken trading knowledge bv , amsterdam , the netherlands .",
    "this work was also supported by the eu project multiplex ( contract 317532 ) and the netherlands organization for scientific research ( nwo / ocw ) .",
    "in this appendix we give a summarized description of the binary and weighted network quantities which are studied in this paper .",
    "specifically , we first show how the properties are measured over a real network , and then how the expected values under the ecm and the ts model are constructed .",
    "let us note a weighted undirected network as a square matrix @xmath39 , where the specific entry @xmath71 represents the edge weight between country @xmath2 and country @xmath3",
    ". the binary representation of the network is noted by a binary matrix @xmath12 , where the entries are @xmath85,\\:\\forall\\:{i , j}$ ] . + we compute the average nearest neighbor degree as : @xmath86 its calculated as the arithmetic mean of the degrees of the neighbors of a specific node , which is a measure of correlation between the degrees of adjacent nodes .",
    "+ the binary clustering coefficient has the following expression : @xmath87 it is a measure of the tendency to which nodes in a graph form cluster together .",
    "more specifically , it counts how many closed triangles are attached to each node with respect to all the possible triangles .",
    "+ the corresponding weighted properties are the average nearest neighbor strength and the weighted clustering coefficient . the average nearest neighbor strength , defined as : @xmath88 where @xmath89 is the strength ( total flow ) of a country .",
    "the @xmath90 measure the average strength of the neighbors for a specific node @xmath2 . like its binary counterpart",
    ", it gives the magnitude of activity of a specific node neighbors ( weighted activity ) .",
    "the weighted clustering coefficient @xcite defined as : @xmath91 the @xmath92 is a measure of the weight density in the neighborhood of a node .",
    "it classify the tendency of a specific node to cluster in a triangle taking into account also the edge - values .",
    "+ now , the measured properties of the real network need to be compared with the reproduced properties of the different models .",
    "these reproduced properties are the expected values of the maximum entropy ensemble that each model i d generating , and can be calculated analytically .",
    "the expected values can be obtained by simply replacing @xmath93 with the probability @xmath26 for the different models ( @xmath26 is different to each model ) .",
    "this next step is what we will discuss in the next sections .",
    "since the bcm model is only dealing with the binary representation , we will have expected values just for the two binary higher - order properties . while the ecm gives expectations for the weighted counterparts of the binary properties .",
    "+ for the binary higher - order properties , we replace @xmath93 with @xmath26 which is the probability of creating a link , and also the expected value of the edge @xmath94 .",
    "this simple procedure yields the analytic formula of the expected value for the properties .",
    "we compute the expected average nearest neighbor degree as : @xmath95      in the weighted case ( weighted higher - order properties ) , we are left only with the ecm .",
    "the expected average nearest neighbor strength is calculated as : @xmath99 where @xmath100 and we input the @xmath26 of the ecm model as before .",
    "+ in the expected value of the @xmath101 we should be more careful , since it is necessary to calculate the expected product of ( powers of ) distinct matrix entries @xmath102        here again we use the known expressions for the properties and replacing the terms @xmath65 and @xmath108 with the expected values @xmath109 and @xmath44 correspondingly .",
    "however , here the expected values are a function of the @xmath0 of the countries , or more specifically the re - scaled @xmath0 @xmath31 .",
    "the expresions for the higher - order binary properties are as before : @xmath110 and @xmath111 where @xmath112 .      for convenience reasons we will write the expression for the weighted clustering coefficient @xmath101 first as a function of the fitness parameters @xmath30 and @xmath53 , and later replaced them with the corresponding @xmath0 terms .",
    "the expected the expected value of the @xmath101 in the two - step case is : @xmath115 as before we observe that @xmath103                                                  t. squartini and d. garlaschelli , _ jan tinbergen s legacy for economic networks : from the gravity model to quantum statistics _ , in econophysics of agent - based models , pp . 161 - 186 ( springer international publishing , 2014 ) .",
    "g. fagiolo , _ the international - trade network : gravity equations and topological properties _ , journal of economic interaction and coordination * 5(1 ) * , 1 - 25 ( 2010 ) .",
    "musmeci , n. , battiston , s. , caldarelli , g. , puliga , m. , gabrielli , a. _ bootstrapping topological properties and systemic risk of complex networks using the fitness model _ , journal of statistical physics , * 151 * , 720 - 734 ( 2013 ) .",
    "caldarelli , g. , chessa , a. , pammolli , f. , gabrielli , a. , and puliga , m _ reconstructing a credit network _ nature physics , * 9 * , 125 - 126 ( 2013 ) .",
    "r. mastrandrea , t. squartini , g. fagiolo , d. garlaschelli , _ enhanced reconstruction of weighted networks from strengths and degrees _ , new j. phys . * 16 * , 043022 ( 2014 ) .",
    "f. picciolo , t. squartini , f. ruzzenenti , r. basosi , d. garlaschelli , _ the role of distances in the world trade web _ , proceedings of the eighth international conference on signal - image technology & internet - based systems ( sitis 2012 ) , pp . 784 - 792 ( edited by ieee ) ( 2013 ) ."
  ],
  "abstract_text": [
    "<S> recent events such as the global financial crisis have renewed the interest in the topic of economic networks . one of the main channels of shock propagation among countries is the international trade network ( itn ) . </S>",
    "<S> two important models for the itn structure , the classical gravity model of trade ( more popular among economists ) and the fitness model ( more popular among networks scientists ) , are both limited to the characterization of only one representation of the itn . </S>",
    "<S> the gravity model satisfactorily predicts the volume of trade between connected countries , but can not reproduce the observed missing links ( i.e. the topology ) . on the other hand </S>",
    "<S> , the fitness model can successfully replicate the topology of the itn , but can not predict the volumes . </S>",
    "<S> this paper tries to make an important step forward in the unification of those two frameworks , by proposing a new gdp - driven model which can simultaneously reproduce the binary and the weighted properties of the itn . </S>",
    "<S> specifically , we adopt a maximum - entropy approach where both the degree and the strength of each node is preserved . </S>",
    "<S> we then identify strong nonlinear relationships between the gdp and the parameters of the model . </S>",
    "<S> this ultimately results in a weighted generalization of the fitness model of trade , where the gdp plays the role of a ` macroeconomic fitness ' shaping the binary and the weighted structure of the itn simultaneously . </S>",
    "<S> our model mathematically highlights an important asymmetry in the role of binary and weighted network properties , namely the fact that binary properties can be inferred without the knowledge of weighted ones , while the opposite is not true . </S>"
  ]
}