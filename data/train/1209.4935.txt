{
  "article_text": [
    "the scientific goals of the next generation of radio telescopes will be enabled by transforming our approach to signal processing by exploiting the digital revolution .",
    "real - time signal processing for telescope arrays must address data rates that will exceed @xmath01 terabyte / s and require petaop / s signal processing .",
    "the huge volumes of data must be matched with the computing power to process that data and produce meaningful results .",
    "innovative approaches in signal processing , computing hardware , algorithms , and data handling are necessary .",
    "in addition to handling the data rates , adaptive calibration and beamforming are essential to handle atmospheric perturbations ( adaptive optics ) , and radio frequency interference ( rfi ) , and to provide a user environment which makes the full power of large telescope arrays accessible to both expert and non - expert users .",
    "the current data processing paradigm uses on - line custom digital signal processing ( dsp ) with off - line data reduction and analysis in general purpose computers .",
    "off - line processing can handle only a few percent of the data generated by the on - line dsp .",
    "the large time between data acquisition and analysis , results in lost science opportunities .    in this paper",
    "we propose to address these problems by integrating on - line and off - line data processing in a heterogeneous system using asic , fpga , gpu and computer clusters to provide a flexible programming environment with real - time feedback .",
    "adaptive real - time imaging enables us to image large regions with high frequency and time resolution .",
    "variable sources , instrumental problems and rfi are handled in real time .",
    "we propose to build a development computing platform with a flexible correlator , beam former and imager for radio telescope and receiver arrays that is based on state - of - the - art , digital signal processing closely coupled with a computing cluster .",
    "this instrumentation will be accessible to scientists , engineers , and students for research and development of real - time processing algorithms , and taps into the pool of talented and innovative students and visiting scientists from engineering , computing , and astronomy backgrounds .",
    "adaptive real - time imaging is a major step in transforming synthesis imaging from an off - line to a real - time process  a digital camera for radio telescopes .",
    "this transformation enables new science , and is necessary to prevent astronomers from being overwhelmed by data and off - line data reduction .",
    "in addition to signal processing and scientific advances , new approaches are needed to enable power - efficient instrumentation that is affordable on a massive scale .",
    "adaptive real - time imaging will revolutionize the science capabilities of existing and developing telescopes like the atacama large millimeter array ( alma ) , the murchison wide - field array ( mwa ) , and have a broad impact on the way that radio telescope arrays can be used .",
    "adaptive real - time imaging will transform synthesis telescopes by providing real - time feedback to observers .",
    "obtaining calibrated data and images quickly will enable astronomers to optimize the observations and calibrations needed to realize their science .",
    "section 2 reviews the current state of the art and the problems faced by existing and next generation aperture synthesis telescopes .",
    "section 3 presents a model for developing adaptive real - time imaging . in section 4 , 5 and 6",
    "we trace the data processing from the telescopes through cross correlation , calibration and imaging .",
    "section 7 presents some current developments and conclusion .",
    "arrays of radio telescopes enable us to map the sky brightness using aperture synthesis techniques ( thompson , moran , & swenson , 2001 [ tms2001 ] ) .",
    "if the dimensions of the radio source and the telescope array are small compared with the distance to the source , then the coherence of the wavefront is proportional to the fourier transform of the intensity distribution of the source ( van cittert - zernike theorem , born & wolf , 1959 ) .",
    "the coherence , also known as the visibility function , is obtained from measurements of the cross correlation of signals between pairs of antennas in the telescope array .",
    "a telescope array with @xmath1 antennas , provides @xmath2 cross correlations and @xmath1 auto correlations for each polarization product .",
    "the earth s rotation of the projected geometry of the telescope array in the direction of a celestial source provides additional samples of the source visibility function in the aperture plane ( ryle , 1962 ; tms2001 ) .",
    "digital cross correlators compute cross - power frequency spectra for all pairs of antennas in the telescope array .",
    "since the signals from celestial radio sources are typically much weaker than the uncorrelated noise power from sky and radio receivers , the measured cross correlations are time - averaged to enhance the signal - to - noise ratio .",
    "the expanded vla ( evla ) with 27 antennas ( perley et al . 2011 ) , and the atacama large millimeter array ( alma ) with 64 antennas ( wootten & thompson , 2009 ) represent the current state of the art aperture synthesis telescopes at centimeter and millimeter / submillimeter wavelengths respectively .",
    "the digital correlators are peta - op , special - purpose computers .",
    "the evla correlator ( carlson & dewdney , 2000 ) cross correlates all pairs of antennas with up to 16 ghz of bandwidth with a minimum of 16,384 spectral channels in 64 full polarization , independent spectral windows . the alma correlator ( escoffier et al",
    ". , 2007 ) processes 16 ghz of bandwidth for the 2016 pairs of antennas and 4 polarization products .",
    "the basic operation is a complex - multiply and add operation .",
    "the complex multiply is typically 4@xmath34-bit with accumulation into 32-bits at rates @xmath4s@xmath5 .",
    "large digital correlators built using custom asics take 5 - 10 years to develop ( e.g. , alma : escoffier et al . 2007 ; evla : perley et al . 2011 ) .",
    "time - averaged correlation data are written to a data archive for off - line data processing .",
    "the data rate from the evla correlator can be up to 350 gb s@xmath5 .",
    "only a few percent of this data rate can be handled by the off - line data processing .",
    "the current plan for alma is an average data rate @xmath0 6 mb s@xmath5 and a peak rate 60 mb s@xmath5 ( lucas et al .",
    "even so , users will be faced with the prospect of dealing with several terabytes of data for evla and alma observations ( evla : perley , 2004 ; alma : lucas et al .",
    "2004 ) .",
    "calibration and imaging are made in general purpose floating point processors using the averaged cross correlations from the data archive .",
    "the complex - valued cross correlations are samples of the fourier transform of the sky brightness distribution .",
    "these are calibrated w.r.t .",
    "measurements of known sources .",
    "when sufficient cross - correlations have been measured , images of the sky brightness distribution can be made from the fourier transform of the calibrated cross correlations .",
    "the images , @xmath6 , are , in general , functions of position , @xmath7 , frequency , @xmath8 , polarization , @xmath9 ( stokes i , q , u , v ) , and time , @xmath10 .",
    "sophisticated image processing algorithms have been developed to self - calibrate the measured cross - correlation function using images of the sky brightness , and to remove sidelobes of the synthesized beam and confusing sources ( e.g. , tms2001 ; cornwell and perley , 1992 ) .",
    "these algorithms have been very successful , but are time consuming and require a level of expertize which many astronomers do not wish to acquire in order to do their science .",
    "the delayed calibration and analysis of the data limit the science which can be done .",
    "variable sources , targets of opportunity , instrumental and atmospheric problems , and radio frequency interference ( rfi ) at low frequency , are more easily handled as the data are being acquired .",
    "aperture synthesis arrays at meter wavelengths present formidable problems .",
    "the wide field of view of the telescopes are full of radio sources which confuse the regions of interest .",
    "the antennas have direction - dependent response over the field of view , and the ionosphere can cause direction - dependent phase shifts on short time scales .",
    "lofar is a low frequency array telescope with antennas at 77 stations spread over 100 km and observing in the frequency range 30 - 90 and 120 - 250 mhz .",
    "data from the antennas at each station are combined into phased array beams to reduce the data rate to a single data stream for each station .",
    "correlation of the station beams is made in a 34 tflop , ibm bluegene / l .",
    "lofar calibration and imaging are made in pipelined data processing performing rfi flagging , with calibration using a model sky brightness model ( nijboer & noordam , 2006 ) .",
    "the murchison wide - field array ( mwa ) was designed as a 512-antenna array being built in western australia to observe in the frequency range 80 - 300 mhz .",
    "the correlation data would comprise of 130,000 cross correlations with 768 frequency channels and 4 polarization products ( ord et al .",
    "the data rate @xmath019 gb s@xmath5 is impractical to store ; data will be calibrated and imaged in a real - time pipeline with images of the sky produced at 8 s intervals .",
    "the real - time calibration pipeline processing is discussed in detail by mitchell et al .",
    "the mwa was recently de - scoped to a 128-antenna array , which reduces the data rate by a factor 16",
    ".    the square kilometer array ( ska ) will be able to form simultaneous images in multiple regions within the field of view .",
    "the ska science requirements ( schilizzi et al . 2007 ) require imaging multiple regions with an image fidelity @xmath11 between 0.5 and 25 ghz .",
    "the bandwidth @xmath025% at observing frequencies below 16 ghz , and 4 ghz above 16 ghz .",
    "each band will have @xmath12 spectral channels with a minimum accumulation interval 0.5 s. the images should have at least @xmath13 beam areas at the maximum angular resolution .",
    "three key science projects require all - sky surveys .",
    "survey science requires images with superb image quality , which imposes stringent requirements on the calibration and sidelobe levels at every stage of beam formation . a major theme driving the ska design is the high cost of data processing ( perley et al .",
    "2003 ; cornwell 2004 , 2005 ; lonsdale et al . 2004 ; wright et al .",
    "in this paper we propose to develop calibration and imaging in close to real time in order to reduce the burden of expert data reduction on the end user , and to make best use of both telescope and human resources .",
    "large arrays and new science require seamlessly integrating calibration and imaging into the data acquisition process .",
    "calibration , imaging , and deconvolving the response of sources outside the fields of interest are intimately related , and are best handled in close to real time , rather than using off - line data processing .",
    "calibration in close to real time uses a model of the sky brightness distribution .",
    "the derived calibration parameters are fed back into the imagers and beam formers .",
    "the regions imaged update and improve the a - priori model , which becomes the final calibrated image by the time the observations are complete ( figure 1 ) .",
    "high performance digital signal processing enables us to handle high data rates in parallel , and to make images in close to real time .",
    "images can be made simultaneously for multiple regions within the field of view by integrating the output from the correlators on multiple targets of interest , calibration sources , and sources whose sidelobes confuse the regions of interest .",
    "the system design uses modular dsp boards with a 10 gbe interconnect architecture which allows reconfiguration of the computing resources for multiple applications .",
    "the programming model uses a system generation library with hardware abstractions which allow the application programmer to focus on the application rather than the details of the hardware .",
    "the system design and programming model together allow the application software to survive by using a technology independent design flow .",
    "a major problem in the design of large antenna array processors has been the routing of high - bandwidth data .",
    "each cross - correlation processor and beam former must receive data from every antenna , and the number of interconnections can become unmanageable . the casper group has developed a packetized signal flow architecture capable of performing this antenna / frequency data transposition using commercial 10 gbit ethernet ( 10 gbe ) switches ( parsons et al .",
    "the fpga devices are programmed using open - source signal processing libraries developed and supported at multiple observatories that allow flexible , scalable , and device - independent solutions ( brodersen et al .",
    "2004 ; parsons et al .",
    "this ongoing work reduces the time and cost of implementing interferometer processors while supporting upgrades to new generations of processing technology .",
    "a hybrid solution using beam formation and correlators provides a flexible development path for imaging large fields of view .",
    "phased array beams can be formed anywhere in the sky by adding the signals from the antennas .",
    "the sidelobe structure of each beam depends on the array geometry , the source direction , and the amplitude and phase weighting of the signals from each antenna .",
    "beam formation is appropriate for analyzing signals from discrete radio sources such as pulsars , seti targets and rfi sources .",
    "beam formation allows us to channel the collecting area of large arrays of telescopes into expensive back - end analysis engines .",
    "direct imaging using beam formation is appropriate for compact sources , but is currently too expensive for imaging large fields .",
    "correlators provide a versatile mechanism for imaging multiple regions within a field of view .",
    "in this section we trace the data flow through an imaging system using correlators and beam formers .",
    "figure 1 shows the overall system .",
    "the total bandwidth of signals from @xmath1 antennas is @xmath14 , where @xmath15 is the analog bandwidth and @xmath16 the number of polarizations from each antenna .",
    "the data for each antenna are digitized with 2 - 12 bit precision .",
    "the total data bandwidth is @xmath17 , e.g. , for @xmath1 = 1000 , @xmath15 = 1 ghz , @xmath16 = 2 , and @xmath18 = 8 , the total data bandwidth is @xmath19 bytes s@xmath5 .",
    "the bandwidth must be channelized , to provide spectral resolution , to facilitate interference rejection , and to reduce bandwidth smearing by using multi - frequency synthesis ( mfs ) .",
    "the science and rfi requirements for a large number of frequency channels favor an ` fx ' architecture ( figure 1 ) .",
    "voltage signals from each antenna and polarization are divided into many frequency channels ( ` f ' stage ) .",
    "excellent separation of frequency channels can be obtained with polyphase filters .",
    "fixed point processors are well matched to the ` f ' stage , with @xmath20 complex - multiply - add operations and a high data bandwidth .",
    "after the frequency transform , the data can be processed in parallel , reducing the data rate in each frequency channel by a factor @xmath21 .",
    "these data are routed into cross correlators for each pair of antennas and frequency channel to measure the correlation properties of the incident radiation ( ` x ' stage ) , and into beam formers to form phased array beams at multiple points in the sky .",
    "commercial 10-gbe switches provide flexible routing which allows the dsp to be upgraded , repaired , and reprogrammed with minimum interruption to telescope operations .",
    "cross correlation is a complex - multiply and accumulate operation for all pairs of antennas and polarizations . for a dual polarization array with @xmath1 antennas and bandwidth , @xmath15",
    ", the correlator must provide @xmath22 complex - multiply and accumulate operations per second , independent of the number of frequency channels .",
    "the complex - multiply is typically 4@xmath34-bit with accumulation into 32-bits . using fewer bits in the cross correlation results in a small loss in resulting signal - to - noise , but allows the use of lookup tables for the cross correlations . floating point processors can also be used .",
    "performance , cost and power comparisons of asic , fpga , gpu , and cpu processors have been made by a number of authors ( ord et al .",
    "2009 ; nieuwpoort & romein 2009 ; clark , laplant , & greenhill 2011 ) .",
    "an order of magnitude estimate for the cost of a custom asic correlator which has been considered by the casper group , is $ 2 m + $ 10 per chip , versus $ 2000 for a high performance gpu or fpga , which suggest that an asic correlator would be a better solution for systems with more than @xmath0 1000 chips .",
    "the development times are : gpu ( @xmath0 1 yr ) , fpga ( @xmath0 2 yr ) , asic ( @xmath0 5 yr ) .",
    "asics or fpgas offer more bandwidth , gpus offer more flops , per $ .",
    "development time favors gpus .",
    "asics will be required for arrays with large numbers of correlations in order to meet the power / heat requirements .",
    "a heterogeneous system would allow choosing the appropriate solutions at each stage of the data flow .",
    "clark et al . (",
    "2011 ) have a useful discussion in section 2.3 .",
    "after correlation there are @xmath23 auto and crosscorrelations for each polarization product .",
    "the data are then time averaged .",
    "the data rate is reduced from the input bandwidth , @xmath15 to the rate of change of the cross correlations  the fringe rate . in order to correlate the signals from a siderial source anywhere in the sky , the data bandwidth from the correlator",
    "is :    @xmath24 ,    where @xmath25 polarization products , and @xmath26 is the earth rotation rate , @xmath27 radian s@xmath5 .",
    "e.g. , for @xmath28 , @xmath29 , @xmath25 , @xmath30 , @xmath31 , and @xmath32 ( complex data ) , the total data bandwidth would be @xmath33 bytes s@xmath5 .",
    "sampling the correlator at the fringe rate allows us to make images over a wide field of view , including targets of interest , calibration sources , and sources whose sidelobes confuse the regions of interest .",
    "we can form simultaneous images in multiple regions within the field of view by integrating the output from the correlators at multiple phase centers .",
    "the data stream from each correlator is multiplied by phase factors , @xmath34 , where @xmath35 = @xmath36 is the baseline vector for antenna pair @xmath37 , and @xmath38 is the phase center in each region of interest .",
    "the data bandwidth for imaging the primary beam width is :    @xmath39 .",
    "e.g. , for @xmath28 , @xmath29 , @xmath25 , @xmath40 , and @xmath32 ( complex data ) , the total data bandwidth is @xmath41 bytes s@xmath5 for 1 km baselines , and @xmath42 bytes s@xmath5 for 1000 km baselines .",
    "an a - priori model of the sky brightness distribution is used for calibration and imaging . in the standard observing paradigm , strong compact sources are used as primary calibrators , and self - calibration is used to improve the calibration during the off - line imaging process .",
    "the calibrations are the product of antenna station beam patterns , gains , bandpass and polarization corrections which are derived from a least squares fit of the data to a model visibility which is computed for the calibration source or the sky brightness model . for compact sources ,",
    "a simple direct fourier transform can be used . for more complex sky brightness models",
    ", a gridded fft can be used to derive the model visibility used in a least squares fit to the measured cross correlations .",
    "the calibrations may vary with time and position in the sky . for phased array station beams ,",
    "atmospheric fluctuations make the primary beam response time variable .",
    "our approach to these problems is to separately calibrate the data for each phase center .",
    "we can identify regions which have bright emission from a - priori images of the sky brightness , and image only regions which are of interest or contain sources whose sidelobes corrupt the regions of interest .",
    "confusing sources may be in the sidelobes of the primary beam , or in different isoplanatic regions .",
    "the sky model is used in a self calibration algorithm to determine the antenna calibration as a function of time for each phase center which contains suitable sources .",
    "the calibrations at each phase center are correlated , and can be improved by developing a global model across the array as a function of time and frequency ( nijboer et al .",
    "if the source contains spectral lines , multiple frequency channels are used simultaneously to determine the calibration .",
    "observations in multiple frequency bands can be used to separate the gains into tropospheric and ionospheric delays .",
    "the data streams can be buffered so that the gains can be averaged and interpolated before being applied to the data stream .",
    "confusing sources are removed by subtracting the source model from the calibrated data stream .",
    "the subtraction can be made for each region of interest and frequency channel in distributed processors associated with each correlation engine , but including the response from the whole sky model , especially of course the strong sources ( wright 2005 ; mitchell et al .",
    "2008 ) .",
    "the basic calibration computation is a complex - multiply of the measured cross correlations ( @xmath43 data ) for each data sample and frequency channel .",
    "the calibrations can be stored in data structures and applied when the @xmath43 data are plotted , analyzed , or imaged . in figure 2 , we plot the computation time for calibrating multi - channel @xmath43 data versus the number of @xmath43 data samples in an off - line simulation for alma data with 60 antennas in a 4 km configuration .",
    "figure 2 shows that the off - line calibration time is proportional to the number of @xmath43 data samples .",
    "we used the miriad data reduction package ( sault , teuben & wright , 1995 ) , which uses a streaming data format .",
    "the complex - valued @xmath43 data were represented by 4 bytes per frequency channel with a scaling factor for each multi - channel data sample .",
    "the 4-byte representation of the @xmath21 allows a 1:32,000 spectral dynamic range for each multi - channel data sample . including the time - variable meta - data which describe the data , the telescope , and the observations , the total length was 460 bytes for a 100-channel data sample .",
    "the calibration rate was 6 mbytes s@xmath5 , showing that the average data rate currently allowed for alma could be calibrated in a single pipelined process on a standard rack server , and that much higher data rates could be supported in multiple threads on a modest sized cluster .",
    "further gains in computing efficiency are clearly possible .",
    "off - line data reduction typically uses static  measurement sets \" with the @xmath43 data represented as 8- or 16-byte complex values .",
    "an astronomer using off - line data processsing typically keeps several copies of calibrated and uncalibrated @xmath43 data , with each step requiring reading and writing the @xmath43 data .    in a real - time imaging pipeline ,",
    "the calibrations are derived from , and applied to the data streams from the correlators ( see figure 1 ) .",
    "rfi must be also subtracted from the data stream before it is passed to the imaging engine and beam formers .",
    "rfi presents a special case in several ways .",
    "rfi sources may be stationary , or moving across the sky at a non - siderial rate .",
    "a correlator can be used to locate and characterize rfi as a function of time , frequency and polarization .",
    "the signal - to - noise can be improved by pointing some of the antennas or beam formers at the rfi sources .",
    "correlators allocated to measuring rfi may need to sample the signal at high data rates .",
    "for phased array telescopes , the station beam can form nulls at the position of ( moving ) rfi sources .",
    "accurate calibration of the array antennas is required in real time ( barott et al . 2011 ) .",
    "the standard imaging algorithm is an fft of the gridded @xmath43 data for each field of view , polarization and frequency channel .",
    "here we review the basic math . for a more detailed description ,",
    "see e.g. , thompson , moran , & swenson , ( 2001 ) , and references therein .",
    "the brightness distribution is the fourier transform of the sampled visibility data , @xmath44 .",
    "since we only have discrete samples of @xmath44 , we define a weighting function @xmath45 , and make an image , @xmath46 which is the fourier transform of the product of @xmath44 and @xmath45 .",
    "the weighting function @xmath45 is typically chosen to minimize the noise and make a more uniform weighting of the sampled @xmath43 plane .",
    "@xmath47 where @xmath44 is not sampled .",
    "the image @xmath46 , the fourier transform of the product of @xmath44 and @xmath45 , is the convolution of the fourier transforms of @xmath44 and @xmath45 .",
    "the observed brightness distribution is the sky brightness distribution , @xmath6 , illuminated by the primary beam pattern , @xmath48 . omitting the functional dependence for clarity , @xmath49 \\star b$ ] , where @xmath15 is the synthesized beam , the instrumental point - source response . in order to use a fast fourier transform algorithm , we re - sample the @xmath43 data onto a gridded @xmath43 plane .",
    "the @xmath43 data are multiplied by the weighting function @xmath45 , convolved by a gridding function @xmath50 , and re - sampled onto a regular grid by @xmath51 .",
    "@xmath52\\times \\pi",
    "< = fft = > [ ( ( i \\times a)\\star b ) \\times c ] \\star \\amalg\\ ] ] thus , the fourier transform of the gridded @xmath43 data is an image of the sky brightness distribution @xmath53 , multiplied by the primary beam pattern , @xmath54 , convolved the synthesized beam @xmath15 , multiplied by @xmath55 , and convolved by @xmath56 .",
    "the convolution by @xmath56 replicates the image at intervals @xmath57 , where @xmath58 is the sample interval of the gridded @xmath43 data .",
    "aliasing in the sky brightness image is minimized by choosing a function @xmath50 , so that its fourier transform @xmath55 falls to a small value at the edge of the image .",
    "the imaging step is usually followed by correction in the image plane for the gridding convolution , @xmath55 , and deconvolution to remove the response to source structure in the sidelobes of the synthesized beam , @xmath15 .",
    "two different deconvolution algorithms are commonly used : an iterative point source subtraction algorithm , clean , which is well matched for deconvolving compact source structures , and maximum entropy , a gradient search algorithm , which maximizes the fit to an a - priori image , in a least squares fit the the @xmath43 data .",
    "both algorithms operate in the image plane on the synthesized image and beam .    in figure 2",
    ", we plot the time for a gridded fft in miriad for a multi - channel image with 1280 @xmath3 1280 pixels and 100 frequency channels .",
    "the multi - channel data are gridded and imaged as a vector with a common pixel size , gridding convolution function , and synthesized beam .",
    "figure 2 shows that the imaging time is proportional to the number of @xmath43 data samples , at a rate 3.4 mbytes s@xmath5 using a single processor .",
    "image deconvolution time , scales with image size and complexity , and is cpu intensive .",
    "a direct deconvolution , dividing by the fourier transform of the synthesized beam , can not be used because the fourier plane is not completely sampled .",
    "both clean and maximum entropy are iterative algorithms , using ffts of the image and synthesized beam .",
    "a 1280 @xmath3 1280 @xmath3 100 channel , real valued image ( 4-bytes per pixel ) @xmath0650 mbytes , with a common synthesized beam ( 6.5 mbyes ) , can be deconvolved in memory .",
    "the frequency channels can be deconvolved in parallel processes .",
    "image deconvolution is relatively fast for compact image structures , but can exceed the imaging time for complex images .    in a real - time imaging pipeline , images in multiple frequency channels can be processed in parallel in a distributed architecture .",
    "the images are formed from the calibrated data stream from which the a - priori sky model has been subtracted , and are therefore difference images from the sky model . subtracting the sky brightness model from the @xmath43 data minimizes many of the problems in the gridded fft , and in particular allows position dependent calibrations and time variable primary beam patterns to be handled ( see , e.g. , wright & corder 2008 ) .",
    "the difference images are used to update the sky model , including not only the regions of interest , but also improving the accuracy of sources whose sidelobes must be subtracted .",
    "as the observations proceed , both the model image and the calibration are improved .",
    "the process converges when the difference images approach the noise level and the model image is consistent with the data . for a small field of view",
    "a 2d fft can be used to image the region around each phase center . the maximum image size for a 2d fft scales as @xmath59 , @xmath60 beam areas on a 1000 km baseline at @xmath61 1 cm .",
    "deconvolution is minimized by obtaining good @xmath43 sampling of the aperture plane , and low synthesized beam sidelobe levels for large @xmath1 array designs .",
    "e.g. , for the alma array with 60 antennas , the sidelobe levels are @xmath0 1 % . in many cases , deconvolution in the image plane may not be needed , since the model image and sidelobes of confusing sources have been subtracted from the @xmath43 data . in addition , images may be limited by atmospheric and instrumental errors which must be removed from the @xmath43 data and can not be removed by deconvolving in the image plane .",
    "the imaging engine can make images using all the frequency channels .",
    "spectral line images can be made for multiple frequency channels , averaged into the desired frequency or velocity intervals .",
    "wideband , mfs imaging treats the frequency channels as independent @xmath43 samples .",
    "the a - priori model used in the calibration can be updated at intervals , when the difference from the best current image is significant .",
    "variable sources are detected as intermittent sources which are inconsistent with the current model .",
    "we should also accumulate a @xmath62 image to help identify pixels where there are time variable sources or rfi sources . in some cases we may want to keep a time series of difference images and the model images used for the calibration .",
    "we view imaging as a dynamic process which can be guided in real time by observers inspecting the convergence of the model image and the @xmath62 image .",
    "as the observations proceed , the observations can be moved to regions where more data are needed to define the science goals , either regions of interest , or sources whose sidelobes are confusing , or new sources which are discovered in the imaging process .",
    "isoplanatic patches may vary during the observations requiring different observation centers to adequately determine the calibration across the sky .",
    "the data archive serves as the data base for the observations , calibrations and instrument status during the observations .",
    "the data streams from each phase center are saved in the data archive along with the metadata .",
    "data from the data archive can be replayed though the imaging system so that the best model of the sky and calibration data from the completed observations can be used to improve the calibration of the final image and extract time variable sources .",
    "in this paper we propose to develop adaptive real - time imaging using correlators and beam formers with a high data bandwidth into computer clusters . the mismatch between the data rates in the on - line dsp and those supported by off - line processing",
    "is resolved by integrating the calibration and imaging with the data acquisition process .",
    "calibration and imaging are handled with the real - time feedback of the antenna calibration needed for beam formers and rfi suppression .",
    "images can be made simultaneously for multiple regions within the field of view by integrating the output from the correlators on multiple targets of interest , calibration sources , and sources whose sidelobes confuse the regions of interest .",
    "the regions imaged are used to update and improve the a - priori model , which becomes the final calibrated image by the time the observations are complete .",
    "a number of current telescopes are developing these concepts . the allen telescope array ( welch et al .",
    "2009 ) is a leading prototype for the ska .",
    "small ( 6.1 m ) dishes give the ata excellent survey speed for wide field imaging , with a frequency coverage from 0.5 to 11.2 ghz .",
    "the use of flexible digital signal processing enables multiple simultaneous observing projects and automated data processing ( keating et al .",
    "figure 3 shows an example of the data processing required for transient sources .",
    "the precision array for probing the epoch of re - ionization ( paper ) is an array of precision dipoles to map the whole sky which uses a packetized correlator design ( parsons et al .",
    "calibration uses an all - sky model ( parsons et al .",
    "2010 ) .",
    "the murchison wide - field array ( mwa ) is a low - frequency radio telescope to search for the spectral signature of the epoch of reionization ( eor ) and to probe the structure of the solar corona .",
    "the mwa will have 128 antenna arrays capable of imaging the sky from 80 mhz to 300 mhz with an instantaneous field of view that is tens of degrees wide and a resolution of a few arcminutes ( mitchell et al .",
    "a data rate @xmath01 gb / s with images every 8 s requires on - site , real - time processing and reduction in preference to archiving , transport and off - line processing .",
    "real time performance needs @xmath02.5 tflop / s .",
    "edgar et al ( 2010 ) present a heterogeneous computing pipeline implementation , using gpus which are a good fit for pipeline processing , but lack flexibility or feedback into the data acquisition , e.g. , rfi detection and excision .",
    "high performance digital signal processing enables us to handle high data rates from aperture synthesis arrays in parallel , and to make images in close to real time .",
    "adaptive real - time data processing will revolutionize the science capabilities of existing and developing telescopes , and have a broad impact on the way that radio telescope arrays can be used .    the current situation for aperture synthesis arrays",
    "may be compared with a jet - liner .",
    "both are extremely complicated and sophisticated systems .",
    "both can be programmed to function automatically to deliver the expected results .",
    "however , the pilot of the jet - liner has the full power of the control systems to handle unexpected situations in real time .",
    "whereas , the astronomer has little real - time feedback , or ability to adapt the observations to new discoveries , and , even worse , the unexpected result may not be in the data because off - line data processing can not handle the data rate or computational needs .",
    "high performance computing with real - time feedback to observers will enable us to optimize the observations and calibrations needed to realize the science .",
    "i thank the many colleagues and students who have contributed to this work , in particular , dan werthimer and the casper students and staff for hardware and software tools which enable us to build reconfigurable data processing for radio astronomy .",
    "thanks to the anonymous referees for valuable comments which have improved the presentation of this work .",
    "this paper is dedicated to my colleague , the late don backer .",
    "this work was supported by the national science foundation under grant number ast-0906040 ,  collaborative digital instrumentation for the radio astronomy community \"",
    "barott , w. c. , et al . , 2011 , radio science , 46 , 1016  real - time beamforming using high - speed fpgas at the allen telescope array \"      brodersen , b. , chang , c. , wawrznek , j. , werthimer , d. , & wright , m. , 2004 , ",
    "bee2 : a multi - purpose computing platform for radio telescope signal processing applications \" http://bwrc.eecs.berkeley.edu/research/bee/bee2/presentations/bee2_ska2004_poster.pdf      clark , m. a. , laplante , p. c. , & greenhill , l. j. , 2012 ,  accelerating radio astronomy cross - correlation with graphics processing units , \" international journal of high performance computing applications , arxiv:1107.4264"
  ],
  "abstract_text": [
    "<S> the digital revolution is transforming astronomy from a data - starved to a data - submerged science . </S>",
    "<S> instruments such as the atacama large millimeter array ( alma ) , the large synoptic survey telescope ( lsst ) , and the square kilometer array ( ska ) will measure their accumulated data in petabytes . </S>",
    "<S> the capacity to produce enormous volumes of data must be matched with the computing power to process that data and produce meaningful results . </S>",
    "<S> in addition to handling huge data rates , we need adaptive calibration and beamforming to handle atmospheric fluctuations and radio frequency interference , and to provide a user environment which makes the full power of large telescope arrays accessible to both expert and non - expert users . delayed calibration and analysis limit the science which can be done . to make the best use of both telescope and human resources we must reduce the burden of data reduction .    </S>",
    "<S> we propose to build a heterogeneous computing platform for real - time processing of radio telescope array data . </S>",
    "<S> our instrumentation comprises of a flexible correlator , beam former and imager that is based on state - of - the - art digital signal processing closely coupled with a computing cluster . </S>",
    "<S> this instrumentation will be highly accessible to scientists , engineers , and students for research and development of real - time processing algorithms , and will tap into the pool of talented and innovative students and visiting scientists from engineering , computing , and astronomy backgrounds . </S>",
    "<S> the instrument can be deployed on several telescopes to get feedback from dealing with real sky data on working telescopes .    </S>",
    "<S> adaptive real - time imaging will transform radio astronomy by providing real - time feedback to observers . </S>",
    "<S> calibration of the data is made in close to real time using a model of the sky brightness distribution . </S>",
    "<S> the derived calibration parameters are fed back into the imagers and beam formers . </S>",
    "<S> the regions imaged are used to update and improve the a - priori model , which becomes the final calibrated image by the time the observations are complete . </S>"
  ]
}