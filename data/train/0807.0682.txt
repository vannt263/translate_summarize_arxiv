{
  "article_text": [
    "an ongoing challenge in simulations of quantum spin systems is to reach larger lattices sizes , thus enabling more reliable extrapolations to the thermodynamic limit . with the advent of loop - cluster algorithms @xcite and related schemes",
    "@xcite developed since the mid-1990s , finite temperature ( @xmath10 ) quantum monte carlo ( qmc ) simulations have become possible on lattices with millions of spins for models with positive - definite path integral ( world line ) @xcite or stochastic series expansion ( sse ) @xcite representation of the partition function .",
    "the computational effort scales linearly in the number of spins @xmath3 .",
    "since the effort also scales as @xmath11 , simulations at very low @xmath10 or in the ground state ( using @xmath10 low enough to eliminate finite-@xmath10 effects ) , are limited to smaller lattices , however .",
    "the ground state can typically be reached for @xmath12 spins .",
    "currently accessible system sizes suffice for studying ground states of many important models , e.g. , the two - dimensional ( 2d ) heisenberg model @xcite and variants of it with non - uniform coupling patterns leading to quantum phase transitions of the antiferromagnet into a disordered ground state.@xcite in other , similar systems there are still controversial issues @xcite that may need larger lattices to be conclusively resolved .",
    "larger lattice sizes are crucial in systems exhibiting more complex ground states and quantum phase transitions .",
    "one example of current interest is a class of `` j - q '' models2d heisenberg models with four - spin interactions engineered to destroy the antiferromagnetic order and drive the system into a valence - bond - solid ( vbs ) state.@xcite the vbs state has intricate fluctuations and the true nature of its thermodynamic limit is only manifested on large lattices.@xcite this illustrates the need to develop better ground - state methods , as a more efficient alternative to going to very low @xmath10 with finite - temperature methods .    in this paper",
    "we introduce a method combining loop updates first developed for finite-@xmath10 simulations @xcite with a ground - state projector qmc method operating in the valence bond ( vb ) basis.@xcite this over - complete singlet basis has some features that make it uniquely well suited for studies of spin - rotationally invariant hamiltonians such as the heisenberg model and its extensions with multi - spin interactions.@xcite    it has been known for some time @xcite that there is a simple and elegant relationship between vb states consisting of @xmath13 pairs of spins forming singlets,@xcite and the loop algorithm , which indeed works by switching between a vb basis and a basis of @xmath3 spins @xmath14 and @xmath15 ( for @xmath16 systems ) . here",
    "we exploit this switching for ground state projections .",
    "an attractive feature of this approach is that it enables the use of very good singlet trial wave functions , the simplest example of which is the amplitude - product state proposed by liang , doucot and anderson.@xcite the ground state can then be reached much faster than with finite-@xmath10 methods , and with much less computational effort than projector methods formulated purely in the vb basis.@xcite in addition we show that purely variational calculations can also be made more efficient by combining spins and vbs , including a loop update similar to one previously developed for classical dimer models.@xcite    the projector qmc algorithm with loops , working in the combined space of vbs and spins , is in the end very similar to @xmath17 sse and worldline loop algorithms .",
    "essentially , the @xmath18 projector approach corresponds to `` cutting open '' the periodic imaginary - time boundary and `` sealing '' the resulting open loop segments with valence bonds ( which serve as continuations of the loops ) .",
    "we demonstrate the efficiency of the projector method by producing high - precision bench - mark results for the sublattice magnetization of the 2d heisenberg model with up to @xmath8 spins .",
    "we also discuss the properties of the variationally optimized amplitude - product states used as a trial states for the ground - state projections ( extending the results of ref .   to larger lattices ) .",
    "we begin in sec .",
    "[ basis ] by summarizing the properties of the vb basis needed for formulating the algorithms . in sec .",
    "[ variational ] we discuss variational monte carlo simulations and optimization of amplitude - product states , and in sec .  [ projector ]",
    "we describe the projector qmc method .",
    "we show results of both variational and projector calculations in sec .",
    "[ results ] , and conclude in sec .  [ summary ] with a summary and discussion .",
    "a vb state is a product of two - spin singlets , @xmath19 where @xmath20 and @xmath21 denote sites on sublattice @xmath22 and @xmath23 on a bipartite system . for @xmath3 ( even )",
    "spins there are @xmath24 ways to draw the vbs , and hence the basis is massively overcomplete . the properties of vb states have been discussed extensively in the literature.@xcite here we will only summarize the most important aspects of the basis and introduce some notation needed for our algorithms .    we can formally use a label @xmath25 for enumerating the vb configurations and denote a state as @xmath26 the overlap between two vb states is @xmath27 where @xmath28 is the number of loops formed in the so - called _ transposition graph _ when the bonds in @xmath29 and @xmath30 are superimposed .",
    "an example is shown in fig .",
    "[ fig1 ] .    like the overlap , matrix elements of operators of interest can typically also be related to the transposition - graph loops.@xcite to compute spin - spin correlations we will need @xmath31 where @xmath32 for sites on sublattice a and b , respectively , and @xmath33 is a label distinguishing the loop to which site @xmath34 belongs .",
    "more complicated matrix elements and their relationships to the loop structure are discussed in ref .  .",
    "[ fig1 ] also shows one of the spin states , @xmath35 contributing to both the vb states ( meaning that the spins on all bonds of the transposition graph are anti - parallel ) . in ( [ zri ] )",
    "the index @xmath34 refers to the allowed spin states in @xmath30 ; the @xmath36 states with anti - parallel spins on every bond . with the sign convention in ( [ singlet ] )",
    ", the vb state can be written as @xmath37 where @xmath38 denotes the number of @xmath14 spins on sublattice @xmath22 .",
    "the vb states thus obey the well known marshall sign rule , which ensures that the ground state has a positive - definite expansion in terms of them [ for an interaction with the same a - b bipartite structure as in the definition of the valence bonds , eq .",
    "( [ singlet ] ) ] .    when writing the overlap ( [ overlap1 ] ) using spin states , @xmath39 only the terms with @xmath40 contribute . since the spins on",
    "every bond must be anti - parallel , the spin configuration around a loop in the overlap graph must be staggered .",
    "the signs cancel and the sum then simply counts the number of such configurations .",
    "there are two staggered spin patterns for each loop , resulting in the overlap ( [ overlap1 ] ) . here",
    "we will use the equivalence between the two ways of expressing the overlap , ( [ overlap1 ] ) and ( [ overlap2 ] ) , as a starting point for constructing efficient variational and ground - state projector algorithms .",
    "lattice with sublattices a and b indicated with open and solid circles .",
    "bond configurations of a bra @xmath41 and ket state @xmath30 are shown as dashed and solid lines , respectively .",
    "for clarity , all bonds here are of length one lattice spacing , but in general a bond can connect any pair of sites on different sublattices .",
    "the number of loops is @xmath42 and the number of sites @xmath43 , giving , according to eq .",
    "( [ overlap1 ] ) , an overlap @xmath44 .",
    "a configuration of @xmath14 and @xmath15 spins compatible with both vb states is also shown.,title=\"fig:\",width=226 ] -2 mm    -3 mm",
    "we first discuss variational calculations , which we will use to construct good trial states for subsequent ground - state projection .",
    "an arbitrary singlet state @xmath45 can be expanded in vb states ; @xmath46 because of the over - completeness , the expansion coefficients @xmath47 are not unique , but this is not a problem in practice . in the variational state introduced by liang _",
    "et al._,@xcite the coefficients are taken to be products of bond amplitudes @xmath48 , @xmath49 where @xmath50 is the number of bonds of size @xmath51 , where in a translationally - invariant system , all applicable lattice symmetries can be used , e.g. , for a 2d square lattice the amplitudes are @xmath52 , with @xmath53 and @xmath54 ( the components of the vector @xmath51 defining the `` shape '' of the bond , transformed to the all - positive quadrant ) , and also @xmath55 .    to optimize the amplitudes using variational qmc simulations ,",
    "the energy is written as @xmath56 where the weight @xmath57 and energy estimator @xmath58 are @xmath59 for a model with two - spin interactions ( to which the methods discussed here are not limited,@xcite but for simplicity of the discussion we will not consider higher - order interactions here ) , the energy estimator is a sum of terms of the form ( [ ssestimator ] ) . as in any variational calculation",
    ", the idea is to compute @xmath60 and its derivatives with respect to the amplitudes and then use this information to periodically adjust the amplitudes , in order to approach the energy minimum . here",
    "we will not be concerned with the optimization aspect of the problem ( which is discussed in detail in ref .  , including also explicit expressions for evaluating the derivatives ) , but focus on the monte carlo sampling aspects of the problem .",
    "-2 mm    -3 mm    for a given set of amplitudes , the vb configurations can be sampled according to the weight @xmath57 by simple moves of bond pairs.@xcite choosing two sites on the same sublattice ( e.g. , next - nearest - neighbors on the square lattice ) , there are two allowed ( bipartite ) configurations of the two bonds connected to these sites , and the monte carlo move amounts to switching from the current one to the other possible one . such an update is illustrated in fig .",
    "the ratio @xmath61 of the weights after ( @xmath62 ) and before ( @xmath57 ) the update needed for the metropolis acceptance probability ; @xmath63 . \\label{paccmetro}\\ ] ] the ratio involves the amplitudes of the affected bonds from the amplitude product ( [ wamp ] ) , as well as the ratio of the new to old overlap ( [ overlap1 ] ) . here the number of loops @xmath28 can increase or decrease by one .",
    "determining this change requires tracing a loop going through one of the four sites involved in the two - bond move . starting from one of these sites , the loop going through that site before the re - configuration is followed , until some other site out of those four is reached .",
    "if that site is connected to the same bond as the initial site , then the four sites must belong to two different loops ( and after the move they will all be in the same loop , i.e. , @xmath28 is decreased by @xmath64 ) , whereas if it belongs to the second bond all four sites are in a single loop ( which is split into two after the update , leading to @xmath28 increasing by @xmath64 ) .",
    "the loop tracing is the most time consuming part of the calculation , in particular for systems where the loops are typically long .",
    "the loop lengths are related to the squared sublattice magnetization , according to@xcite @xmath65 where @xmath66 is the length of loop @xmath67 . for the single loop of length @xmath68 going through a randomly chosen site @xmath34 , this relation becomes @xcite @xmath69 where the averages refer to the monte carlo sampling . for systems with antiferromagnetic long - range order there are system - spanning loops,@xcite i.e. , there are some loops of length @xmath70 in typical configurations . in this case",
    ", the computational effort of a sweep of @xmath71 two - bond updates therefore scales as @xmath72 .",
    "here we avoid the loop - tracing step by re - introducing the spins into the sampling space , replacing the pure - bond overlap ( [ overlap1 ] ) with the equivalent expression ( [ overlap2 ] ) .",
    "in addition to sampling the bond tilings @xmath73 of the bra and ket states , we then also have to sample their compatible spin configurations @xmath74 .",
    "a two - bond move can not always be performed in this combined space , since the re - configured bonds may not be compatible with the current spin configuration . starting with an allowed combined configuration @xmath75 ( an example of which",
    "is shown in fig .",
    "[ fig1 ] ) , we carry out @xmath13 two - bond attempts in each of the bond configurations @xmath73 , and thereafter construct all vb loops and flip each loop ( i.e. , flip all the spins in the loop ) with probability @xmath76 .",
    "the number of operations required for one such full cycle of updates scales as @xmath3 . in the scaling of the computational effort we thus avoid the factor @xmath77 .",
    "if there is antiferromagnetic order ( system spanning - loops , @xmath78 ) , or even in the absence of long - range order if the correlation length is large , the time savings of switching to the combined spin - bond basis is very large .",
    "it is worth pointing out the reason why this method of avoiding to compute the overlap ( [ overlap1 ] ) works .",
    "it is because the combined monte carlo sampling of spins and bonds will , according to the standard detailed balance and ergodicity principles , automatically favor bond configurations for which there are more compatible spin configurations , on average exactly in proportion to the re - written overlap , eq .",
    "( [ overlap2 ] ) , which is just the number of spin configurations compatible with a given bond configuration .",
    "thus , the overlap is taken into account probabilistically in the extended space , instead of being computed exactly in the pure vb space.@xcite one may ask whether this could lead to a worse performance of the combined bond - spin sampling relative to pure vb sampling .",
    "the bond sampling in the mixed space is constrained , but , on the other hand , in the pure vb sampling a decreasing overlap after a bond reconfiguration ( which should occur in half of the updates ) reduces the acceptance rate .",
    "these two effects should , on average , balance each other , and thus the performance of the two methods should be similar when measured in terms of the number of bond updates performed",
    ". the sampling is , however , much faster in the combined space .",
    "note also that measurements of observables can ( and normally should ) still be carried out in the pure vb basis ( instead of measuring just the @xmath0-components of , e.g. , correlation functions ) , i.e. , at this stage it does not matter what the spin configuration is , and one just considers rotationally invariant estimators , such as eq .",
    "( [ ssestimator ] ) , in the pure vb basis .",
    "this corresponds exactly to summing over all compatible spin configurations , i.e. , one can consider the vb ( loop ) estimators as _ improved estimators_.@xcite      as an alternative to sampling the vb states using the two - bond reconfigurations , one can also implement a loop update similar to one developed for classical dimer models.@xcite the idea is to first move one end of a randomly chosen bond , thereby creating two defects ( an empty site and one site with two bonds ) that should not be present in a valence - bond state .",
    "subsequent bond moves are then carried out to move one of these defects , until it annihilates the second one ( the loop closes ) and a new allowed bond configuration has been generated .",
    "the first step of such a loop update is illustrated in fig .",
    "( note that these loops are different from those in the rest of the paper ) .",
    "-2 mm    -3 mm    in an algorithm ( as well as in an actual computer implementation ) , it is convenient to represent the bonds by links between sites , stored in a one - dimensional array @xmath79 , @xmath80 . thus , if sites @xmath34 and @xmath81 are connected by a bond , then @xmath82 and @xmath83 . starting at a randomly chosen site @xmath84 ( in either @xmath29 or @xmath30 ; here we consider @xmath30 with the links stored in an array @xmath85 ) the bond connected to it is considered for a reconfiguration",
    ". the bond will stay attached to its second site , @xmath86 , and the new other end , @xmath81 , will be chosen according to probabilities proportional to the corresponding amplitudes @xmath87 .",
    "this is accomplished in practice by carrying out a bisection search for values bracketing a random number in @xmath88 in a pregenerated table containing cumulative probabilities , i.e. , normalized partial sums of the amplitudes.@xcite if , for the chosen site @xmath81 [ obtained by adding the chosen bond vector @xmath51 to the current site @xmath34 ] the spin @xmath90 , the move would not be consistent with the spin configuration , and a new @xmath81 should then be chosen [ repeatedly if necessary , until @xmath91 is satisfied ] .",
    "after moving the bond to an acceptable @xmath81 , setting @xmath92 , this site will have two bonds on it ( but in the array @xmath85 the original link has been destroyed , which does not matter since it will no longer be needed ) , and the original site @xmath84 will have no bond attached to it ( unless the chosen site happens to be the starting site , @xmath93 , in which case the loop update is immediately terminated and another loop building is started from a new randomly chosen site @xcite ) . to `` heal '' the double - bond defect at @xmath81 , the end of the old bond connected to it is moved .",
    "this is done in the same way as for the initial bond move , with @xmath84 in the description above replaced by @xmath81 .",
    "the procedures are repeated until it happens that @xmath93 , at which point the double - bond and no - bond defects annihilate each other and the loop closes .",
    "the loops can be large , and this kind of update should therefore be much more efficient than the local two - bond updates . the number of loops constructed in each updating sweep should be adjusted so that , on average , a number @xmath71 of bonds are moved .    for an amplitude - product state with non - zero amplitudes @xmath94 for all @xmath51 ,",
    "the bisection search in the bond - loop update introduces a factor @xmath95 in the time scaling of the algorithm , which may or may not ( depending on the nature of the state ) be outweighed by shortened autocorrelation times relative to the two - bond updates .",
    "note also that if the amplitudes are zero or very small beyond some distance @xmath96 ( e.g. , in the case of exponentially decaying amplitudes ) , the table of probabilities should only include those amplitudes with practically non - vanishing amplitudes , which also removes the @xmath97 factor from the scaling in such cases .",
    "we now turn to the projector qmc method , using the heisenberg model as a concrete example of loop updates for efficient ground - state projection of a variational state in the vb basis .",
    "we write the hamiltonian on a bipartite lattice as @xmath98 where @xmath99 denotes nearest - neighbor sites .",
    "the bond operators @xmath100 are singlet projectors ( equivalent to loop operators,@xcite up to a factor of @xmath101 and bipartite rotation ) which can have two effects when acting on a vb state : @xmath102 these simple rules , and the absence of minus signs ( in the case of an unfrustrated system ) , enable a qmc scheme for projecting out the ground state @xmath103 from an arbitrary state ( [ psivb ] ) in the vb basis.@xcite      irrespective of the basis and hamiltonian , the projector approach is based on the expression @xmath104,\\ ] ] where @xmath105 , @xmath106 are the energy eigenstates in a hilbert space of @xmath107 states .",
    "if @xmath108 is the largest ( in magnitude ) eigenvalue and the expansion coefficient @xmath109 , then @xmath110 for large @xmath111 . in a qmc projector scheme ,",
    "a high power of @xmath112 and its action on the trial state @xmath45 are sampled stochastically .    to this end , for the heisenberg model we write @xmath113 as a sum of all products of @xmath111 bond operators and introduce the notation @xmath114 for such operator strings ; @xmath115 where @xmath116 is a formal label for the different strings of singlet projectors .",
    "we write the state resulting when acting with a @xmath114 on a given vb state @xmath30 as @xmath117 where @xmath118 is obtained in practice by successively applying the rules ( [ habdia ] ) and ( [ haboff ] ) , which also gives the number @xmath119 of off - diagonal operations ( [ haboff ] ) .",
    "the expectation value of an arbitrary operator @xmath120 can be written as @xmath121 where the weight @xmath122 and estimator @xmath123 are @xmath124 the expectation value can be evaluated by importance - sampling , as discussed in ref .  . however , up until now the sampling was rather inefficient .",
    "each random replacement of operators ( one or several ; the number is adjusted to give a suitable acceptance rate ) in @xmath114 requires a full propagation of the current vb state , counting @xmath119 in eq .",
    "( [ propagate ] ) , and thereafter counting @xmath28 in the overlap ( [ overlap1 ] ) .",
    "that is , unlike what is normally the case in monte carlo simulations , one here can not simply determine the weight ratio locally when a small change is made in the configuration , and , hence , the full weight has to be computed in each update .",
    "this results in a scaling @xmath125 of the computational effort involved in a full updating sweep . here",
    "one factor @xmath111 corresponds to the effort of propagating the full updated operator string .",
    "constructing and counting the loops in the transposition graph ( [ overlap1 ] ) requires @xmath71 operations .",
    "if @xmath6 this effort is swamped by the bond propagation , and the total effort of carrying out a number @xmath126 of updates ( needed to significantly change the operator sequence ) is @xmath127 , whereas for the situation @xmath128 ( which is less interesting in practice , as we will see when discussing the convergence properties ) , the effort is formally @xmath129 . when using an amplitude - product as the trial state ( instead of a fixed bond configuration ) , we should also perform @xmath71 two - bond updates of the trial state , each of which demands the same computational effort as an operator replacement .     for a 4-site system with @xmath130 .",
    "the arcs to the left and right indicate vb states @xmath41 , @xmath131 and the two columns of filled and open circles represent @xmath14 and @xmath15 spins of compatible spin states @xmath132 , @xmath133 .",
    "the spins at the four operators ( vertices ) are also indicated .",
    "there are three loops , part of which consist of vbs .",
    "expectation values are evaluated at the mid - point indicated by the dashed line.,title=\"fig:\",width=255 ] -2 mm    -3 mm      we will now show how using the combined spin - bond basis brings the scaling of one updating sweep down from @xmath134 to @xmath135 .",
    "we construct a loop update , which we here implement for the power @xmath136 in a way similar to the `` operator - loop '' update for @xmath137 , where @xmath138 , in the sse representation @xcite in @xmath17 simulations .",
    "the operator - loop approach is analogous to the original loop method for world lines , @xcite with the main difference that the sampling scheme is formulated in terms of insertions and removals of operators , instead of deforming world - line configurations .",
    "the formal relationships between the two approaches are discussed in ref .  .",
    "the sse formulation is somewhat easier to relate directly to the present case of projector qmc .",
    "we could also project with @xmath137 , taylor - expanded as in the sse method , but the fixed - power approach allows for some minor simplifications . the primary differences with respect to finite-@xmath10 sse simulations",
    "is then the fixed value of @xmath111 and the vb `` end - cap '' boundaries in the `` propagation '' direction , replacing the periodic boundary conditions appropriate at finite @xmath10 .    to make the analogy with the sse loop method as close as possible",
    ", we split the singlet - projector operators @xmath100 into their diagonal , @xmath139 , and off - diagonal , @xmath140 , parts , @xmath141 we use a superscript @xmath142 on the operator string @xmath143 in ( [ hm ] ) to denote the @xmath144 different combinations of diagonal and off - diagonal operators for a given full - operator string @xmath114 .",
    "with spins @xmath145 , @xmath146 compatible with @xmath147 , @xmath148 , we sample vbs , spins , and operators , according to the weight @xmath149 under the condition @xmath150 .",
    "the constraints exactly compensate for the other factors in the original weight ( [ vbweight ] ) and there is no explicit dependence in ( [ weight ] ) on the operator - string ( @xmath151 ) and spin ( @xmath152 ) indices .",
    "an example configuration is shown in fig .",
    "[ fig4 ] . on a bipartite lattice",
    "the weights are positive , since minus signs present in the states ( [ vrz ] ) compensate those arising from an odd number of off - diagonal operators ( [ hab2 ] ) ( or , equivalently , all signs could be eliminated by a sublattice rotation @xcite ) .",
    "we now briefly describe the monte carlo sampling procedures . starting with vb configurations @xmath153 ( where normally one would take @xmath154 for simplicity ) and compatible spin configurations @xmath155 , an initial string cotaining only diagonal operators @xmath139 can be used ( consistent with the constraint that each operator must act on two anti - parallel spins ) .",
    "successive configurations maintaining the constraints are generated with three types of updates .    in the first update  the `` diagonal update''the combined string @xmath156 ( where the transpose @xmath10 of an operator sequence just corresponds to writing it in the reverse order , corresponding to acting with it on a bra state instead of a ket ) containing @xmath157 operators is traversed and each diagonal operator in it is updated ( moved to a randomly selected bond ) , under the condition that it acts on anti - parallel spins .",
    "this step corresponds to changing the vertex break - up in the original world - line loop scheme .",
    "@xcite as in the sse method,@xcite the constraints are checked by keeping the single state @xmath158 , which is needed for moving a diagonal operator at location @xmath159 in the string .",
    "this state is obtained by acting on the originally stored ket spin configuration @xmath160 with the first @xmath159 operators in the sequence .",
    "it is changed ( by flipping two spins ) whenever an off - diagonal operator is encountered in the course of traversing the positions @xmath161 . at the end of this procedure",
    "the stored bra state is obtained , @xmath162 , for a valid configuration .    in a second updating stage ",
    "the loop update  a linked list of operator - vertices is first constructed .",
    "a vertex consists of the spin states `` entering '' and `` exiting '' an operator , as shown in fig .",
    "they connect , forming loops .",
    "the only difference with respect to the operator - loops in the sse method is that a loop can now be connected to the ket or bra vb state , and the valence bonds constitute parts of such loops ( replacing the periodic boundary conditions used at @xmath17 ) . to keep nonzero ( indeed , constant ) matrix elements of the operators @xmath100 , all spins on a loop have to be flipped together , in the process changing also @xmath163 .",
    "each loop is flipped with probability @xmath76 . in practice ,",
    "all loops are constructed , and the random decision of whether or not to flip a loop is made before the loop is constructed .",
    "vertices in a loop that is not to be flipped are just flagged as visited , so that the same loop is not traversed more than once ( i.e. , a loop construction is always started from a vertex - leg that has not yet been visited ) .",
    "the reason for constructing all the clusters and flipping each with probability @xmath76 , instead of generating single clusters starting from random seed locations and flipping them with probability @xmath64 ( as in the classical wolff method @xcite ) , is that the _ de facto _ loop structure is only changed when performing the diagonal updates .",
    "one would therefore potentially generate the same cluster several times , which would lead to lower efficiency compared to uniquely identifying all clusters and flipping each at most once . in principle",
    "one could modify the algorithm with combined diagonal and cluster updates , but this is more complicated and would probably not lead to improvements in efficiency in most cases .    a flipped loop including one or several vbs will cause spin flips in the stored spin configurations @xmath164 or @xmath165 . in the loop updating procedure we do not have to explicitly keep track of any other spins than those in @xmath164 and @xmath165 .",
    "the four spins at the operators ( the vertex legs ) are irrelevant at the loop updating stage , because all the vertices automatically involve only operations on anti - parallel spins , both before and after a loop flip . for each vertex",
    "encountered when constructing a loop , we therefore simply have to change the operator - type index , @xmath166 , in the list of operators ( i.e. , the same list @xmath167 used in the diagonal update and to construct the linked vertex list ) .    the third type of update  the state update  is identical to the vb reconfigurations described in sec .",
    "[ variational ] for the variational calculation .",
    "normally one would use an amplitude - product state with coefficients ( [ wamp ] ) , which enter in the weight ( [ weight ] ) .",
    "reconfigurations of the bonds can be carried out with either two - bond or bond - loops moves , as explained in sec .",
    "[ variational ] .",
    "they only change the loop connections at the vb `` end caps '' .",
    "when measuring operator expectation values one can go back to a pure vb ( = loop ) representation , using the estimator ( [ vbestim ] ) .",
    "this corresponds to summing over all loop orientations .",
    "most quantities of interest can be expressed in terms of the loops in the transposition graph corresponding to @xmath168.@xcite note that these transposition - graph loops can also be obtained from the `` space - time '' loops constructed in the updates , by connecting the sites ( in practice just assigning a label , the loop number @xmath169 ) crossed by the same loop at the propagation midpoint ( indicated by a dashed line in fig .",
    "[ fig4 ] ) .",
    "the  space - time ",
    "loops can also provide access to imaginary time correlation functions @xcite in the ground state ( see section [ sec : discussion ] ) .",
    "since there are no differences in the measurement procedures for equal time observables with respect to the original vb projector algorithm , we refer to the literature for this aspect of the simulations.@xcite    in some applications , instead of measuring a ground state expectation value @xmath170 one is interested in matrix elements of the form @xmath171 , where @xmath172 is a reference state , normally the nel state in the @xmath0-component basis .",
    "this corresponds to sampling the wave function itself ( generating the basis states with probability proportional to the positive - definite wave - function coefficients ) .",
    "the energy ( including excitation energies in different momentum sectors ) can be computed like this,@xcite and also calculations of entanglement entropy can be formulated in this way.@xcite a mixed matrix element can also easily be sampled in the spin - bond basis . in this case the loops terminating on the state @xmath172 should never be flipped , because @xmath172 is a single spin configurations ( in the case of the nel state ",
    "other reference states are also possible and would require other rules for the boundary loops ) .",
    "as a demonstration of the efficiency of the methods , we present results for the sublattice magnetization @xmath7 of the 2d heisenberg model . this quantity has been calculated in numerous previous studies , but the currently best published estimate , @xmath173 , obtained on the basis of @xmath174 qmc results for @xmath175 up to @xmath176 , is already more than ten years old.@xcite recently , the density matrix renormalization group method was used to calculate @xmath7 on rectangular lattices with @xmath177 sites , giving a result consistent with the above value and with a similar precision.@xcite results have also been obtained using finite-@xmath10 data and scaling forms that in principle allow simultaneous @xmath178 extrapolations . with @xmath175 up to @xmath179 and",
    "@xmath11 up to @xmath180 , ref .",
    "reported @xmath181 .",
    "this is higher than ( and well outside the error bars of ) the @xmath18 results cited above . in order to resolve the discrepancy",
    ", it would be useful to have ground state results based on larger lattices .",
    "here we consider @xmath175 up to @xmath182 .",
    "below we first discuss convergence aspects of the vb method , including the behavior with different trial states , and then present results and finite - size extrapolation of the sublattice magnetization .",
    "we first discuss the amplitude - product states used as trial states for the ground - state projection . the quality of the variationally optimized states [ i.e.",
    ", all amplitude @xmath52 were determined by variational monte carlo simulations , as explained in sec .",
    "[ variational ] ] is illustrated in fig .",
    "[ fig5 ] for system sizes @xmath175 up to @xmath183 .",
    "results for up to @xmath184 were previously presented in ref .",
    "here we improve slightly on those results , thanks to the more efficient sampling procedures allowing for better statistics for the computed derivatives .",
    "the results are compared to converged results of the qmc projector method ( which can be considered as exact to within small statistical errors that are not visible in the graphs ) .",
    "the relative error of the variational energy is @xmath185 for large systems .",
    "the sublattice magnetization falls on a a smooth curve in good agreement ( better than 1% ) with the projected data for @xmath175 up to @xmath186 . for larger systems the behavior becomes erratic ,",
    "however , being higher or lower ( outside the error bars ) than the projected data in a seemingly random way .",
    "this can be explained as due to the energy becoming less sensitive to the long - range spin correlations for increasing @xmath175 , i.e. , there are states with significantly different sublattice magnetizations but energy expectation values that are the same to within the precision of the simulations . to obtain the correct best sublattice magnetization for large @xmath175 ( corresponding to the minimum energy determined to extreme precision ) with the variational approach",
    "therefore requires unreasonably long simulations ( which is true in general in variational calculations ; not just with the amplitude - product states used here ) .     -2 mm    -3 mm       states states projected using different trial states ; amplitude - product states with amplitudes @xmath187 ( @xmath188 ) as well as with @xmath52 determined by minimizing the energy ( in two independent optimizations , giving slightly different amplitudes).,title=\"fig:\",width=264 ] -2 mm    turning now to results of the projector method , it is useful to test the convergence as a function of the projection power @xmath111 for different trial wave functions . clearly , the preferred option is to use the best variational state available , but optimizing an amplitude - product state also takes some time ( depending on how close to the energy minimum one strives ) , and , as we have seen above , for large systems it may not even be possible to find the truly optimal amplitudes .",
    "[ fig6 ] shows the energy and the sublattice magnetization for @xmath184 versus @xmath189 , obtained using trial states with amplitudes @xmath187 , @xmath188 , without any optimization , as well as with amplitudes obtained in two independent optimization runs .",
    "it is known @xcite that the optimal amplitudes decay as @xmath190 asymptotically , but the short - bond amplitudes show deviations from this form .",
    "indeed , the best convergence is seen for @xmath191 , but with optimized amplitudes the convergence is still much faster .",
    "although the two optimized variational states have very similar energies , there are still clear differences in the convergence of the sublattice magnetization , related to the insensitivity of the variational energy to the long - distance spin correlations .    in some cases",
    "the convergence of the sublattice magnetization is non - monotonic ( while the energy always has to converge monotonically ) , as illustrated in fig .",
    "the behavior depends on details of the variationally optimized amplitudes ; likely non - monotonicity can be traced to incomplete optimization .",
    "( @xmath192 in the inset ) , using an optimized trial state .",
    "the dashed lines show the result @xmath193 error bar of sse calculations ( using loop updates ) at very low temperatures ( @xmath194 in the case of @xmath195).,title=\"fig:\",width=283 ] -2 mm    -3 mm      .projector qmc results for the squared sublattice magnetization and the spin correlation function at maximal separation for several @xmath196 lattices .",
    "the numbers within brackets indicate the statistical error ( one standard deviation of the average ) in the last digit . [ cols=\"^,<,<\",options=\"header \" , ]     -3 mm    -3 mm    we now discuss large - scale calculations for the 2d heisenberg model . we have calculated @xmath197 as well as the spin correlation function @xmath198 , which equals @xmath197 when @xmath199 , for lattices with @xmath175 up to @xmath182 , making sure that the results are well converged to the ground state in all cases .",
    "the raw data are listed in table .",
    "[ restab ] the results are graphed versus @xmath200 in fig",
    ".  [ fig8 ] , along with polynomial fits @xcite used to extrapolate to @xmath201 .",
    "the extrapolated @xmath197 and @xmath198 agree statistically and are stable with respect to the range of @xmath175 included and the order of the polynomials .",
    "the statistics is slightly better for @xmath202 and the polynomial needed to fit it is one order smaller than for @xmath197 .",
    "based on @xmath202 , we estimate @xmath9 , somewhat above the previous @xmath18 results.@xcite the error bar is more than an order of magnitude smaller . the higher value from finite-@xmath10 simulations@xcite can be ruled out ( differing by more than 15 of its error bars from our result )",
    "this illustrates difficulties with unknown corrections to the @xmath203 scaling forms . extrapolating @xmath18 properties directly as a function of a single parameter ( @xmath200 ) can in general",
    "be expected to be more reliable .",
    "indeed , since the appearance of the ( unpublished ) original short version of the present article , @xcite the results of ref .   have been recalculated and revised@xcite and now agree with our results .",
    "we have shown how re - introducing the spins into the vb basis allows for much faster sampling of amplitude - product states and , in particular , very efficient ground - state projector simulations .",
    "for variational calculations it saves a factor up to system size @xmath3 , and for projector qmc a factor up to the projection power @xmath111 , bringing the total computational effort from @xmath4 to @xmath5 ( where normally @xmath6 , i.e. , the improvements can be orders of magnitude ) .",
    "one striking and appealing aspect of the projector algorithm is its close similarity with state - of - the - art @xmath17 qmc loop methods , in particular the sse variant @xcite but also the world - line approach ( for which loop updates similar to those used here were originally developed@xcite ) .",
    "essentially , the @xmath18 projector approach corresponds to `` cutting open '' the periodic imaginary - time boundary condition used at @xmath17 and terminating the resulting free loop ends with valence bonds ( which act as continuations of the loops ) .",
    "it is therefore very easy to rewrite , e.g. , an sse program for @xmath18 projection .",
    "a favorable aspect of the @xmath18 projector approach is that vb amplitude - product states often are very good trial states ( as noted already a long time ago @xcite ) , which helps substantially to achieve a fast convergence as a function of the power @xmath111 of the projection operator @xmath204 .          in view of the similarity with @xmath17 methods ,",
    "it is worth asking how much faster a converged @xmath18 simulation is than a @xmath17 simulation carried out at @xmath10 sufficiently low for obtaining ground state properties . to answer this question , we first need to compare directly the size of the configuration space of the two formulations .",
    "consider the sse method , which is based on sampling the taylor expansion of @xmath137.@xcite the average of the expansion power @xmath205 is given by @xmath206 , where @xmath60 is the total energy ( @xmath71 ) , which includes for each bond ( in the case of the @xmath207 heisenberg model ) an added constant @xmath208 [ exactly as in the singlet projector operator in eq .",
    "( [ ham ] ) ] .",
    "let us consider the @xmath209 heisenberg model , where for large systems the energy per site is @xmath210 , which , including the constant @xmath208 , corresponds to @xmath211 thus , the average expansion power @xmath212 . in the projector approach , the number of operators in the sequence is @xmath157 , and thus the computational efforts of the two methods should be comparable if @xmath213 ( since there is only a very small overhead in sampling in the projector scheme , related to the boundary vb states ) . in fig .",
    "[ fig9 ] we show results of the two methods versus these normalized parameters for @xmath195 .",
    "a much faster convergence of the projector approach can be seen , especially for the energy .",
    "it is clear that here the fact that the trial state is well optimized plays a big role  with a very poorly optimized trial state the @xmath17 approach may even converge faster .     system versus the power @xmath111 of the hamiltonian used in the projection . the results at @xmath189 are compared with @xmath17 results graphed versus the normalized inverse temperature @xmath214 ( corresponding to a similar computational effort as the projection scheme at @xmath189).,title=\"fig:\",width=264 ] -2 mm      it should be noted that the loop estimators used in qmc calculations at @xmath17 are exactly equivalent to vb estimators,@xcite such as eq .",
    "( [ ssestimator ] ) , if @xmath10 is low enough for a simulation to sample only the singlet subspace , whereas at higher @xmath10 some loops  those that change the total magnetization when flipped  correspond to higher spin contributions .",
    "an important difference between the @xmath18 and @xmath17 approaches should be pointed out in this context : to improve the statistics in @xmath17 simulations one can take advantage of the periodic `` time '' boundaries .",
    "averages of observables can be computed over all the propagated states . whether or not this is a significant advantage in practice depends on the observable ( its auto - correlation function as a function of imaginary time , which determines the effective number of independent measurements generated ) . in some cases ,",
    "the averaging can be carried out almost without overhead . at first sight",
    "it might appear that no averaging of this kind can be done with the projector method , since the matrix elements of observables are defined at the mid - point of the configuration ( as indicated in fig .",
    "[ fig4 ] ) .",
    "one can of course shift the measurement point , and average over several such points , although then either the ket or the bra might not be equally well converged to the ground state . in practice , this kind of averaging may , however , still pay off , although we have not investigated it quantitatively . note also that quantities given in terms of kubo integrals ( susceptibilities ) explicitly require access to imaginary - time correlation functions , which can in principle be measured in the projector scheme by using the  space - time  loops constructed in the updates.@xcite it would then be better to formulate using the taylor expansion of @xmath137 instead of a fixed power @xmath113 , and one would require longer projections than equal - time correlations , long enough for the imaginary - time correlator to have decayed below some small number beyond which further contributions can be neglected .",
    "these issues are common to projector methods and have been investigated and discussed in detail in the context of fermionic auxiliary - field qmc calculations.@xcite      the possibility to use the valence - bond basis in qmc simulations was first suggested more than 20 years ago.@xcite it is also implicitly the basis for the loop algorithm.@xcite other aspects of simulations explicitly formulated in the vb basis became more widely used only recently , after its generic utility , including simplified access to many physical quantities , was pointed out.@xcite we briefly list some works where the unique aspects of the vb basis where exploited in such simulations , and where the improvements presented here can be expected to lead to further progress .",
    "alet _ et al .",
    "_ @xcite and , independently , chhajlany _",
    "et al._@xcite defined a vb entanglement entropy , which can be evaluated using ground - state projection ( unlike other entropy definitions , which normally can not be directly evaluated ) .",
    "a slightly different variant of this entanglement measure was proposed by lin and sandvik , who also introduced another measure , the loop entanglement entropy , based on the loops in the transposition graph.@xcite hastings _ et al .",
    "_ recently showed that one of the standard definitions of entanglement entropy , the renyi @xmath215 entropy , in fact also can be evaluated with vb simulations.@xcite these developments will allow , e.g. , tests of the `` area law '' of entanglement entropy and deviations from it in a wide range of quantum spin systems .",
    "beach _ et al .",
    "_ have extended the projector scheme for standard su@xmath216 spins to an often used representation of su(@xmath3 ) invariant models , including also the possibility of continuously varying @xmath3.@xcite this extension is of interest as many analytical theories are formulated as large-@xmath3 expansions , and it is useful to make direct contact between this approach and unbiased numerical calculations . using a similar approach , tran _",
    "et al . _ have carried out vb simulations of a chain of non - abelian su(@xmath101)@xmath217 particles ( where @xmath218 is related to the central charge),@xcite generalizing the standard @xmath207 heisenberg chain .",
    "one can also consider effective hamiltonians explicitly constructed in the vb basis.@xcite    one of the first applications of the pure vb projector method was to the j - q model ; a potential realization of `` deconfined '' quantum criticality.@xcite since the appearance of the unpublished original short version of the present article,@xcite the improved vb loop method has already been used to study su(@xmath3 ) versions of the j - q model with @xmath219 and @xmath220.@xcite here it can be noted that the variational amplitude - product states can also be extended to allow for valence - bond - solid order ( by introducing factors favoring or disfavoring various local short - bond configurations ) , which is useful for studying j - q models in the vbs phase.@xcite    the spin texture around a non - magnetic impurity in the j - q model has been studied with the spin - bond sampling algorithm with an extra unpaired spin.@xcite triplet excitations of random antiferromagnetic clusters were investigated with vb simulations including a triplet vb in the background of singlets by wang and sandvik,@xcite a measurement which also can be carried out with two unpaired parallel spins .",
    "measurements of triplet excitations for fixed momentum were discussed in ref .  .",
    "finally , we note that the loop - based projector scheme that we have presented here for isotropic spin systems can in principle be extended to anisotropic models as well@xcite ( and also to more complex bosonic systems , as well as fermions in one dimensions ) .",
    "the difference will be that the variational trial states appropriate in most other cases would not have natural expressions in the singlet valence bond basis .",
    "as an example , consider the case of a variational wave function written just in terms of the @xmath0-components of the spins ( e.g. , a jastrow state ) .",
    "there is then some weight ( wave function coefficient ) @xmath221 for the trial state , and normally this weight will change when a loop terminating at the trial state is flipped .",
    "the loops in this case would be of the `` directed '' type , @xcite and one could build in the weight - change coming from the trial state into the directed loop equations ( which dictate the probabilities for the loop - building along different paths through the vertices ) .",
    "this approach may be more efficient than the green s function or diffusion monte carlo methods @xcite normally used for ground - state projection of a variational trial state .",
    "-9 mm    we thank kevin beach for many useful discussions .",
    "aws was supported by the nsf under grants no .",
    "dmr-0513930 and  dmr-0803510 .",
    "part of this work was carried out by aws while on sabbatical at the institute for solid state physics , university of tokyo , japan , and at the department of physics , national taiwan university , taipei , taiwan .",
    "he would like to thank these institutions for their hospitality and financial support .                                                                    in ref .",
    "a `` directed loop '' scheme was used for classical dimers with restriction to short bonds ( of two different lengths ) . in that case",
    "there are no bond updates in which a bond does not move ( i.e. , in which the generated bond is the same as the current one ) .",
    "however , this approach is not practical when there is no restriction on the bond lengths ( as is required in the over - complete vb basis ) . the probability of not moving a bond is low and in practice the scheme of bond selection from a single list with all bonds is still very efficient ."
  ],
  "abstract_text": [
    "<S> we show how efficient loop updates , originally developed for monte carlo simulations of quantum spin systems at finite temperature , can be combined with a ground - state projector scheme and variational calculations in the valence bond basis . </S>",
    "<S> the methods are formulated in a combined space of spin @xmath0-components and valence bonds . </S>",
    "<S> compared to schemes formulated purely in the valence bond basis , the computational effort is reduced from up to @xmath1 to @xmath2 for variational calculations , where @xmath3 is the system size , and from @xmath4 to @xmath5 for projector simulations , where @xmath6 is the projection power . </S>",
    "<S> these improvements enable access to ground states of significantly larger lattices than previously . </S>",
    "<S> we demonstrate the efficiency of the approach by calculating the sublattice magnetization @xmath7 of the two - dimensional heisenberg model to high precision , using systems with up to @xmath8 spins . </S>",
    "<S> extrapolating the results to the thermodynamic limit gives @xmath9 . </S>",
    "<S> we also discuss optimized variational amplitude - product states , which were used as trial states in the projector simulations , and compare results of projecting different types of trial states . </S>"
  ]
}