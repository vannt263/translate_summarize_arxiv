{
  "article_text": [
    "recently , many interesting schemes have been proposed which use atomic ensembles with a large number of identical atoms as the basic system for quantum state engineering and for quantum information processing .",
    "for instance , one can use atomic ensembles for generation of substantial spin squeezing @xcite and continuous variable entanglement @xcite , for storage of quantum light @xcite , for realization of scalable long - distance quantum communication @xcite , and for efficient preparation of many - party entanglement @xcite .",
    "the experimental candidates of atomic ensembles can be either some cold or ultracold atoms in a trap @xcite , or a cloud of room - temperature atomic gas contained in a glass cell with coated walls @xcite .",
    "the schemes based on atomic ensembles have some special advantages compared with the quantum information schemes based on the control of single  particles : firstly , laser manipulation of atomic ensembles without separate addressing of individual atoms is normally easier than the coherent control of single particles ; secondly , and more importantly , atomic ensembles with suitable level configurations could have some kinds of collectively enhanced coupling to certain optical mode ( called the signal light mode ) due to the many - atom interference effects . thanks to this enhanced coupling , we can obtain collective enhancement of the signal - to - noise ratio ( that is , the ratio between the controllable coherent interaction and the uncontrollable noisy interactions ) compared with the single - particle case if we choose to manipulate the appropriate atomic and optical modes .",
    "this collective enhancement plays an important role in all the recent schemes based on the atomic ensembles .    to describe the interaction between atomic ensembles and optical beams , in particular , to understand the collective enhancement of the signal - to - noise ratio , normally one assumed a simple cavity - qed model @xcite or a one - dimensional light propagation model @xcite with an independent spontaneous emission rate for each atom .",
    "in contrast to this , most of the current experiments are done with free - space atomic ensembles coupling directly to the three - dimensional optical beams @xcite .",
    "it is not obvious that the predictions from the simple models will always be valid for this real much more complicate experimental situations . to fully predict and understand the real experiments",
    ", one needs to answer various questions associated with the three - dimensional interaction effects , for instance , what is the inherent mode structure of the signal light when we have a definite geometry of the atomic ensemble ?",
    "can we achieve a good mode matching with the matching efficiency in principle arbitrarily close to one ?",
    "what is the noise magnitude associated with density fluctuation ( induced by the random initial distribution of the atom positions and the random atomic motion ) of the atomic ensemble ? in the three - dimensional configuration , is there still the collective enhancement of the signal - to - noise ratio ?    in this paper , we will try to provide answers to the above important questions for a raman type @xmath0-level configuration which is useful for scalable long - distance quantum communication @xcite and for many - party entanglement generation @xcite .",
    "in general , it is very challenging to build a full quantum theory from the first principle to describe the interaction between the many - atom ensemble and the infinite - mode optical field and to give definite answers to the above - listed questions . in this paper",
    ", we will use a perturbative approach by assuming that the raman pumping laser is very weak .",
    "there are several motivations to use a perturbative approach : firstly , the schemes in @xcite for scalable quantum communication and for many - party entanglement generation can work in the weak - pumping limit , so the perturbative approach describes a useful realistic situation .",
    "secondly , the perturbative calculations allow us to investigate the three - dimensional effects and to give definite answers to the questions listed above from the first principle without any doubtful approximation .",
    "finally , we expect the three - dimensional effects should be at least to some extent independent of the power of the pumping laser , so the perturbative calculations could give at least some indications for the three - dimensional interaction picture in other regions .",
    "the calculations reveal some significant results which are unexpected from the simple models , for instance , it turns out that due to the density fluctuation of the atomic ensemble , there will be two sources of noise for the light - atomic - ensemble interaction : one is the spontaneous emission loss and the other is the inherent mode mismatching noise ( here , by `` inherent '' , we mean that this mode mismatching is not from any technical imperfection ) .",
    "thus , we need to use two quantities to describe the signal - to - noise ratios , and need to keep a balance between these two sources of noise by appropriate mode matching methods to optimize the setup for applications . the intuitive mode matching method will result in a quite large inherent mode mismatching noise .",
    "it is better to use some other mode matching methods which reduce the mode matching noise at the price of increasing the spontaneous emission loss .",
    "this can optimize the setup for some applications , such as the ones in refs .",
    "@xcite , since there the spontaneous emission loss has a far less important influence .",
    "the calculations in this paper also demonstrate that in the realistic three - dimensional configuration , one can still obtain large collective enhancement of the signal - to - noise ratio for atomic ensembles compared with the single - atom case , which is an important feature of this kind of systems .",
    "it is also helpful to make a comparison between the collective enhancement of the signal - to - noise ratio we consider here and some other collective optical effects , such as the superradiance .",
    "the similarity lies in that both phenomena involve many - atom interference .",
    "however , there are also important differences . for superradiance ,",
    "it is a stimulated emission effect , and the enhancement is in the emission speed . at the initial stage",
    ", coherence is built between different atoms from the spontaneous emissions .",
    "after the coherence has been built , superradiance can be understood even from a classical interference picture .",
    "for the light - atomic - ensemble interaction considered here , we are still completely in the spontaneous emission region which needs a full  quantum description , and the enhancement is not in the emission speed , but in the signal - to - noise ratio when we only manipulate and measure a definite atomic mode ( called the symmetric collective atomic mode ) and a definite signal light mode ( which is the optical mode collinear with the raman pumping light ) .",
    "the coupling between the above atomic and the optical modes are coherent for different atoms ( which means for this coupling there is a certain phase relation between different atoms ) , while the coupling of these two modes to other atomic and other optical modes ( called the noise modes ) are inherent with random phase relations between different atoms ( the randomness comes from the random atom positions ) .",
    "we have collective enhancement of the signal - to - noise ratio since the coherent coupling interferes constructively for different atoms .",
    "of course , in the three - dimensional free - space , there are infinite optical modes , and the signal light mode changes continuously to other noisy optical modes when we continuously vary the solid angle .",
    "due to the continuous change from the coherent coupling to the inherent coupling , we have non - trivial mode matching problem , and we get some inherent mode mismatching noise .",
    "we also would like to mention that there are some early important works on the transverse effects of the raman interaction by using the three - dimensional light propagation equations @xcite .",
    "however , it is not clear to us how to use this approach to describe the collective enhancement of the signal - to - noise ratio , and in particular , how to give definite answers to the questions listed above .",
    "there is also some unpublished effort to try to figure out the three - dimensional effects in another light - atom interaction configuration @xcite .",
    "the interaction picture is not yet clear to us .",
    "this paper is arranged as follows : in sec .",
    "ii , we explain the interaction scheme and the basic ideas of the applications of this interaction scheme for quantum information processing . with the applications in mind , we can focus our efforts on the most relevant quantities that we need to calculate .",
    "we will also explain in this section the basic interaction picture between the light and the atomic ensemble from our calculations .",
    "then , in the next section , we will describe the theoretical model for this light - atom interaction from the first principle , and solve this model by using a perturbative approach . in sec .",
    "iv , we will discuss the properties of this solution , in particular , we will define and calculate the mode structure of the signal light , the spontaneous emission inefficiency , and the inherent mode mismatching noise .",
    "v is devoted to the discussion of the appropriate mode matching methods for real experiments .",
    "we show that by appropriate mode matching methods , we can keep a balance between the two sources of noise mentioned above in order to optimize this setup for applications . finally , in sec .",
    "vi we summarize the results .",
    "the basic element of our system is an atomic ensemble , which consists of a cloud of @xmath1 identical atoms with the relevant level structure shown in fig .",
    "1 . a pair of metastable lower states @xmath2 and @xmath3 can correspond , for instance , to hyperfine or zeeman sublevels of electronic ground state of alkali atoms . the relevant coherence between the levels @xmath4 through optical pumping .",
    "the ensemble is then illuminated by a weak pumping laser pulse which couples the transition @xmath5 with a large detuning @xmath6 , and we look at the spontaneous emission light from the transition @xmath7 through the raman transition . in the second configuration ,",
    "as is reported in the experiment @xcite , the pumping laser is focused with a transverse area smaller than the transverse area of the atomic ensemble , so only part of the atoms are illuminated by the laser at each instant . however , during the light - atom interaction period , all the atoms in the ensemble are moving fast , and they frequently enter and leave the interaction region . as a result , each atom still has an equal small probability to be excited into the state @xmath8 .",
    "as we will show in the next section , after the atomic gas interacts with a weak pumping laser , there will be a special atomic mode @xmath9 called the symmetric collective atomic mode , and a special optical spontaneous emission mode @xmath10 ( which couples to the transition latexmath:[$|e\\rangle \\rightarrow    atomic mode @xmath9 and the signal light mode @xmath10 are defined respectively by @xmath12@xmath13where @xmath14 represents the the plane wave mode with the wave vector @xmath15 ( we have used the plane wave modes as the eigenmodes for the expansion of the optical spontaneous emission field ) .",
    "the operators @xmath16 satisfy the standard commutation relations @xmath17",
    "= \\delta \\left ( { \\bf k - k}^{\\prime } \\right ) $ ] , and @xmath18 is the normalized signal mode function whose explicit form will be specified in sec .",
    "we just need to mention here that @xmath10 represents the spontaneous emission light which is basically collinear with the pumping laser , with a distribution only over a very small solid angle .",
    "the particularity of the modes @xmath9 and @xmath10 comes from the fact that they are dominantly correlated with each other , which means , if a atom is excited to the symmetric collective mode @xmath9 , the accompanying spontaneous emission photon will most probably go to the signal light mode @xmath10 , and vice versa .",
    "there are still many other atomic modes in the ensemble and infinite other optical modes in the spontaneous emission field , and these atomic and optical modes are correlated with each other in a complicated way . however , the correlation between the good modes @xmath9 and @xmath10 is quite `` pure '' , and these two modes are only weakly correlated with the other atomic and optical modes which contribute to noise .",
    "the correlation between the atomic mode @xmath9 and other optical modes contributes to the spontaneous emission loss , and the correlation between the signal mode @xmath10 and other atomic modes contributes to the inherent mode mismatching noise .",
    "the interaction picture for this system is schematically shown by fig .",
    "the applications of this system for quantum information processing exactly comes from the almost pure correlation between the modes @xmath9 and @xmath10 . if we neglect the weak correlations between the good modes @xmath19 and the other noisy atomic and optical modes , that is , we neglect the two sources of noise illustrated in fig .",
    "2 , all the noisy modes can be traced over , and we get effectively a two - mode problem . the excitations in the modes @xmath9 and @xmath10 can be both separately measured .",
    "for the signal mode @xmath10 , this is done through a single - photon detector with an appropriate mode - matching ; and for the atomic mode @xmath9 , this can be done by first mapping the atomic excitation to an excitation in the signal mode through a repumping laser pulse @xcite , and then detecting it again through a single - photon detector . using the almost pure correlation between the modes @xmath9 and @xmath10 , one can generate some preliminarily entanglement between two distant atomic ensembles by only linear optics means , which forms the important first step for applications of this setup for different kinds of quantum information processing tasks detailed in refs .",
    "@xcite . here",
    ", we will briefly explain the basic ideas on how to entangle atomic ensembles using the correlation between the modes @xmath9 and @xmath10 .",
    "this explanation helps us to define the most relevant quantities for the applications that we need to calculate .",
    "the setup for entanglement generation between the two distant atomic ensembles l and r is shown by fig .",
    "we apply simultaneously two short raman pumping pulses on the ensembles l and r , respectively , so that for each  ensemble the light scattered to the signal mode @xmath10 has a mean photon number much smaller than @xmath20 .",
    "the signal modes are then coupled to optical channels ( such as fibers ) through mode matching after the filters , which are polarization and frequency selective to filter the pumping light .",
    "the signal pulses after the transmission channels interfere at a 50%-50% beam splitter bs , with the outputs detected respectively by two single - photon detectors d1 and d2 . if either d1 _ or _ d2 registers one photon , the process is finished . otherwise , we first apply a repumping laser pulse to the transition @xmath21 on the ensembles l and r to set the atoms back to the ground state @xmath22 , then the same raman driving pulses as the first round are applied to the transition @xmath23 and we detect again the photon number of the signal modes after the beam splitter .",
    "this process is repeated until finally we have a click in either d1 or d2 detector .",
    "we show now how the entanglement is generated between the ensembles l and r if we successfully register one photon in d1 or d2 detector . to understand this ,",
    "let us first look at one ensemble . before the raman pumping pulse , the collective atomic mode @xmath9 and the signal light mode @xmath10 are in vacuum states , which are denoted respectively  by @xmath24 , @xmath25 .",
    "if we neglect the small noisy correlations , after the weak pumping , the state of the the modes @xmath9 and @xmath10 has the following form ( see the next section for the detailed derivation )    @xmath26    where @xmath27 is the probability for one atom excited to the collective atomic mode @xmath9 , and @xmath28 represents the high - order terms with more excitations whose probabilities are equal to or smaller than @xmath29 .    in fig .",
    "3 , the pumping pulses excite both ensembles simultaneously , the whole system is thus described by the state @xmath30 , where @xmath31 and @xmath32 are given by eq .",
    "( 1 ) with all the operators and states distinguished by the subscript @xmath33 or @xmath34 , respectively .",
    "the two signal light modes are superposed at the beam splitter , and a photodetector click in either d1 or d2 measures respectively the operators @xmath35 or @xmath36 with @xmath37 . here",
    ", @xmath38 denotes the difference of the phase shifts in the two - side optical channels .",
    "conditional on the detector click , we should apply a projection operator @xmath39 or @xmath40 onto the whole state @xmath30 . if we neglect the high - order corrections in eq .",
    "( 3 ) , the projected state of the ensembles l and r thus has the form @xmath41which is maximally entangled in the excitation number basis . the generation of this kind of state forms the basis of further applications in quantum information processing @xcite . if we take into account the high - order terms in eq .",
    "( 3 ) , the fidelity between the actually generated state and the ideal state ( 4 ) will decrease by an amount proportional to @xmath42 , and this decrease will contribute to the final fidelity imperfection of the schemes in refs .",
    "@xcite . for the applications described by these schemes , we need to fix the fidelity imperfection to be small , which means that we should keep a small excitation probability @xmath42 by controlling the intensity of the raman pumping laser .",
    "now we look at the influence of the two types of noisy correlations illustrated in fig .",
    "2 . the spontaneous emission loss can be quantified by the probability @xmath43 of the event that the scattered photon goes to some other optical modes instead of the signal mode @xmath10 while the accompanying atom is excited to the collective atomic mode @xmath9 . without the spontaneous emission loss , for each round of raman pumping , we succeed with a probability @xmath44 to get a detector click , which prepares the entangled state ( 4 ) .",
    "however , the spontaneous emission loss means that even if an atom is excited to the mode @xmath9 ( which has a probability @xmath45 for each ensemble ) , the accompanying photon , with a probability @xmath46 , can not be registered . for entanglement generation , the fidelity imperfection to the ideal state ( 4 ) is given by the excitation probability of the atomic mode @xmath9 , which is now @xmath47 instead of @xmath42 ( we always use @xmath42 to denote the possibility of the good event described by eq .",
    "( 3 ) ) . to fix the fidelity imperfection to be small , in the presence of the spontaneous emission loss ,",
    "we need to further decrease the excitation probability @xmath42 by a factor of @xmath48 , which means that we have a smaller probability to register one signal photon .",
    "so , as a result of this noise , the preparation efficiency ( the success probability of the scheme ) is decreased by a factor of @xmath48 when we fix the fidelity imperfection .",
    "the inherent mode - mismatching noise can be quantified by the probability @xmath49 of the event that an atom is excited to some other atomic modes instead of the collective mode @xmath9 while the accompanying photon goes to the right signal mode @xmath10 . in this case",
    ", we can register a photon from the single - photon detectors , but the atomic mode @xmath9 will be actually still in the initial vacuum state @xmath50 .",
    "so , this noise will add some vacuum component to the generated state between the ensembles l and r. in the presence of this noise , the generated state between the ensembles l and r is mixed with the form @xmath51where the vacuum coefficient @xmath52 is basically given by the conditional probability @xmath53 for this noise contribution .",
    "actually , as has been shown in @xcite , there are other sources of noise which can contribute to the vacuum coefficient @xmath52 , such as the detector dark counts , and the detector inefficiency in the succeeding entanglement connection scheme detailed in ref .",
    "it has also been shown there the vacuum component noise will be finally automatically purified , and thus has no influence on the final communication fidelity",
    ". however , it has a more significant influence on the efficiency than the spontaneous emission loss . for applications in refs .",
    "@xcite , to get a better overall efficiency , it is better to keep a balance between the mode mismatching noise @xmath54 and the spontaneous emission inefficiency @xmath43 , with @xmath55 significantly smaller than @xmath43 .",
    "it is helpful to make a comparison here with the single - atom case . for a single atom interacting with the free - space light with the same level configuration as shown in fig .",
    "1 , there is only one atomic mode given by @xmath56 , but there are still infinite optical modes .",
    "we can still identify the forward scattered optical mode @xmath10 as the signal mode .",
    "the interaction picture is then shown intuitively by fig .",
    "4 . for a single atom",
    ", there is no inherent mode - mismatching noise , but the spontaneous emission inefficiency becomes much larger .",
    "if the atom is excited to the level @xmath8 ( that is , to the mode @xmath57 ) through the raman laser pumping , the accompanying photon has a probability to go to all the possible directions @xcite , and thus has only a very small possibility to go to the signal mode @xmath10 .",
    "we will calculate in the following sections the spontaneous emission inefficiencies for the signal atom case as well as for the atomic ensemble case , and compare them with the different mode - matching methods to see whether there is collective enhancement of the signal - to - noise ratio for the many - atom ensemble .",
    "we will now go to the detailed description of the light - atomic - ensemble interaction . from this description",
    ", we will calculate the signal - light mode structure @xmath58 , the spontaneous emission inefficiency @xmath59 , and the inherent mode - mismatching noise @xmath53 . in the interaction configuration shown by fig .",
    "1 , the raman pumping laser can be described classically by neglecting its small quantum variance , and is assumed to be propagating basically along the @xmath60 direction .",
    "so , we can write its amplitude as @xmath61 , where @xmath62 is the carrier frequency and @xmath63  is a slow varying function of the coordinate @xmath64 and the time @xmath65 . the field @xmath66 coupling to the transition @xmath67 with @xmath68 , and @xmath14 , the corresponding annihilation operator . then , the hamiltonian describing the light - atom interaction has the following form in the interaction picture ( setting @xmath69)@xmath70 } d^{3}{\\bf k+h.c.}\\right\\ } ,   \\nonumber\\end{aligned}\\]]where the detuning @xmath71 with @xmath72 , the frequency difference between the atomic levels , @xmath73  ( @xmath74 ) are the transition operators of the @xmath75th atom , @xmath76 is the coordinate of the @xmath75th atom , and @xmath77 are the coupling coefficients which are proportional to the dipole moments of the corresponding transitions . the coefficient @xmath78 depends in general on the direction of the wave vector @xmath79 by the dipole pattern . in eq . ( 6 ) ,",
    "the carrier frequency of the spontaneous emission field @xmath80 is given by @xmath81 , and its relevant frequency width can be estimated by the natural width @xmath82 of the excited level @xmath83 , which means that the modes @xmath14 with the frequency difference between @xmath84 and @xmath85 much larger than the width @xmath82 will have negligible influence on the system dynamics .",
    "we neglect in eq .",
    "( 6 ) the spontaneous emission back to the level @xmath2 since it is not important for our purpose ( with the detection method specified in sec .",
    "ii ) , and has no influence on all of our results .",
    "if both the natural width @xmath82 and the frequency spreading of the pumping laser @xmath86 are significantly smaller than the detuning @xmath87 , we can adiabatically eliminate the upper level @xmath88 } d^{3}{\\bf k}\\right .",
    "\\nonumber \\\\ & & \\left .",
    "{ \\bf + h.c.}\\right\\ } -\\frac{\\left| g_{eg}\\right| ^{2}}{\\delta } % \\sum_{i=1}^{n_{a}}\\sigma _ { gg}^{i}\\left| u\\left ( { \\bf r}_{i},t\\right ) \\right| ^{2 } ,   \\label{7}\\end{aligned}\\]]where @xmath89 and @xmath90 with @xmath91 , the unit vector in the @xmath60 direction .",
    "we have neglected in eq .",
    "( 7 ) the stark shift of the level @xmath3 since it is much smaller than the other terms ( the spontaneous emission field is much weaker than the pumping field ) .",
    "the last term in eq .",
    "( 7 ) ( the stark shift of the level @xmath2)can be eliminated if we make a phase rotation of the basis @xmath92 to @xmath93 .",
    "thus , we can simply drop off the last term , and replace @xmath94 by @xmath95 . in the following , for simplicity of the symbol",
    ", we will denote @xmath96 still by @xmath97 , and denote @xmath98 by a single coefficient @xmath99 .    at the beginning , all the atoms and in the ground state @xmath2 , and all the optical modes @xmath14 are in the vacuum state .",
    "we denote this initial state of all the atomic and optical modes by @xmath100vac@xmath101 .",
    "then , if the raman pumping laser @xmath86 is short and weak enough , we can expand the final state @xmath102 into a perturbative expansions . to the second order of the perturbation , the final state has the form@xmath103 \\right\\ } |% \\text{vac}\\rangle   \\label{e8}\\end{aligned}\\]]where @xmath104 is the duration of the raman pulse , and @xmath105 $ ] denotes the time - ordered product .    at this point",
    ", we should note that for an atomic vapor , the atom positions @xmath106 are randomly distributed , and during the light - atom interaction , the atoms are moving fast in the room - temperature @xcite .",
    "therefore , we should treat @xmath76 in the hamiltonian ( 7 ) as stochastic variables .",
    "we make the following two assumptions about the properties of these variables : ( i ) for different atoms @xmath75 and @xmath107 , @xmath108 and @xmath76 do not correlate with each other ; ( ii ) different stochastic variables @xmath76 obey the same probability distribution which is determined by the geometry of the atomic cell . note that these two assumptions are well satisfied by the room - temperature atomic gas . if the atom positions @xmath76 behave as classical random variables , we should take an average of the final state @xmath102 over the joint probability distribution of these variables , and the resulting state becomes mixed with @xmath109where the symbol @xmath110 denotes the average over all the variables @xmath76 .    to take the average in eq .",
    "( 9 ) , first we note that the hamiltonian ( 7 ) can be written as @xmath111with @xmath112only the term in the large bracket of the hamiltonian @xmath113 depends on the variable @xmath76 . by the property ( i ) of the variables @xmath76 , we have@xmath114by the property ( ii ) of the variables @xmath76 , we know that @xmath115  becomes independent of the atom index @xmath75 , so the average of the hamiltonian @xmath116 has the simple form @xmath117where @xmath9 is the symmetrical collective atomic operators defined in eq .",
    "we will write the initial vacuum state @xmath100vac@xmath101 as a tensor product of the atomic part @xmath100vac@xmath118 and the optical part @xmath100vac@xmath119 , and denote the atomic state @xmath120vac@xmath121 simply by @xmath122 . with this notation , a combination of eqs .",
    "( 8)-(13 ) yields the following form for the averaged state @xmath123 @xmath124where the effective pure state @xmath125 ( not - normalized ) is@xmath126 , and the noise component @xmath127 is given by@xmath128with the value of @xmath129 determined by the normalization of @xmath130 , i.e. , by @xmath131 . in eq .",
    "( 14 ) , @xmath132 represents the higher - order terms compared with the magnitude of @xmath129 and @xmath42 , which will be neglected in the following .",
    "we also ignored the second - order cross - terms proportional to @xmath133vac@xmath134 or @xmath100vac@xmath135 in writing eq .",
    "( 14 ) , since they have no contributions to the quantities we will calculate in the below .",
    "the solution ( 14 ) serves as the starting point for discussions of various properties of this system in the following section .",
    "now , let us analyze the properties of the light - atomic - ensemble interaction revealed by the solution ( 14 ) .",
    "first , we look at the effective pure state @xmath136 .",
    "the state @xmath125 has exactly the same form as the ideal state ( 3 ) which is the starting point for all the applications . to see this clearly",
    ", we can write @xmath125 as @xmath137vac@xmath101 , by defining the signal mode@xmath138where the value of @xmath42 is determined by the normalization of the operator @xmath139 , i.e. , by the condition @xmath140 = 1 $ ] .",
    "we are particularly interested in the spatial structure of the signal mode @xmath141 , since one needs to know this spatial structure to design mode - matching in practical experiments .",
    "the integration @xmath142 can be expressed as @xmath143 , where @xmath144 represents the infinitesimal solid angle and @xmath145 is the bandwidth of the spontaneous emission field which is in the order of the natural width @xmath82 of the excited level latexmath:[$%    @xmath139 is determined by the superposition coefficient @xmath147 as a function of the solid angle @xmath148 .",
    "typically , the size @xmath33 of the atomic ensemble ( centimeter long or less ) satisfies the condition @xmath149 , and @xmath150 ( @xmath151 is either around ghz or zero , depending on one uses the hyperfine level or the zeeman sublevel for the @xmath3 state ) . in this case ,",
    "@xmath152 , which only depends on the direction of @xmath79 , and becomes independent of the frequency @xmath153 .",
    "we assume that the raman pumping field can be factorized as @xmath154 , where @xmath155 is a slowly changing function of the coordinate , and can be well approximated as a constant along the size of the atomic ensemble . with this condition ,",
    "the superposition function @xmath156 is factorized as a product of the frequency part @xmath157 and the spatial part @xmath158 , and the spatial part @xmath159 becomes independent of the emission frequency @xmath153 and the interaction time @xmath104 . to have a more explicit expression of the spatial structure @xmath160 of the signal mode @xmath139",
    ", we assume that the atoms are distributed by the normalized distribution function @xmath161 ( with @xmath162 ) , which is determined by the geometry of the ensemble . as we mentioned before",
    ", the interaction coefficient @xmath163 normally also depends on the direction of the wave vector @xmath79 in the form of a dipole pattern , but it varies very slowly with the angle @xmath148 compared with other contributions in @xmath158 , so we drop it off when considering the spatial structure of the signal mode . under this circumstance ,",
    "@xmath158 is simply expressed as@xmath164to further simplify this expression , we assume a gaussian pump beam with @xmath165 , and a gaussian form for the transverse part of the atomic distribution function with @xcite @xmath166where @xmath167 and @xmath168 characterize the radius of the pump beam and the radius of the atomic ensemble , respectively , and @xmath33 is the length of the ensemble . in this case , we have an analytic expression for the signal mode function @xmath169where the function @xmath170 is defined as @xmath171 . from this expression , we see that the signal photon mainly goes to the forward direction .",
    "the signal mode is inside a small cone around @xmath172 with @xmath173 characterized by @xmath174 $ ] .",
    "we have shown that the first component of the solution ( 14 ) exactly contributes to the ideal coherent process , and have specified the spatial structure of the signal mode .",
    "now we analyze the contributions of the noise described by the second component of eq .",
    "( 14 ) . from eq .",
    "( 14 ) , we see that the noise component @xmath127 is expressed as a tensor product of the atomic density operator @xmath175 and the remaining optical density operator @xmath176 . besides the symmetric collective atomic mode @xmath9 and the signal optical mode @xmath10",
    ", there are many other noise modes contributing to the atomic density operator @xmath177 and the optical density operator @xmath178 .",
    "these noise modes correlate with each other in a complicated way , however , these correlations do not contribute to the noise of the relevant dynamics if the two signal modes are not involved in the correlations , since the reduced density operator of the modes @xmath9 and @xmath179 , which describes the relevant dynamics , will not be influenced by these correlations after we take trace over all the noise modes .",
    "nevertheless , the correlations between the good modes and the noisy mode will have influence on the relevant dynamics , and these contribute to the two sources of noise we have mentioned before : the spontaneous emission loss and the inherent mode - matching inefficiency .",
    "these two sources of noise are described quantitatively by the conditional probabilities @xmath43 and @xmath53 , respectively .",
    "the @xmath43 represents the probability that an atom is excited to the right mode @xmath9 , but the accompanying photon does not go to the signal mode @xmath10 . from the solution ( 14 ) to the whole density operator @xmath123 , this possibility can be expressed as @xmath180where @xmath181 represents the trace over all the remaining atomic and optical modes involved in the operator @xmath123 .",
    "similarly , @xmath55 represents the probability that a photon is emitted to the signal mode @xmath10 , but the accompanying atomic excitation is not in the right mode @xmath9 , and this possibility can be expressed from the density operator @xmath123 as@xmath182 in the following , we need to calculate these two probabilities to quantify the noise magnitudes .    from the solution",
    "( 14 ) , we can derive the probability @xmath183 for one atomic excitation in the mode @xmath9 , the possibility @xmath184 for one photon in the mode @xmath10 , and the joint possibility @xmath185 for one atom in the mode @xmath186 and one photon in the mode @xmath10 .",
    "they are respectively given by @xmath187    @xmath188    @xmath189    where @xmath129 and @xmath42 are obtained respectively from the normalization of @xmath130 and @xmath139 ( see eq .",
    "( 16 ) and eq .",
    "( 17 ) ) , and the ratio @xmath190 is defined as@xmath191with @xmath178 , the optical part of the noise component @xmath192 as we have specified before .    from the above equations , we see that we only need to calculate the two ratios @xmath193 and @xmath190 to determine the noise probabilities @xmath194 and @xmath53 .",
    "as we have mentioned before , the shape @xmath195 of the pump beam is typically decomposed as @xmath196 with @xmath155 approximately independent of @xmath197 along the size of the atomic ensemble . in this case , the two ratios @xmath198 and @xmath190 have much simplified expressions , which , become independent of the interaction details , such as the interaction time or the bandwidth of the coupling field , and depend only on some spatial integrations determined by the geometry of the atomic ensemble and the pump beam . for simplicity , we also neglect the slow variation of the coupling coefficient @xmath163 with the direction of @xmath79 . under these conditions ,",
    "the ratios @xmath193 and @xmath190 are given respectively by @xmath199@xmath200 ^{-2 }   \\nonumber \\\\ & & \\times \\int_{4\\pi } d\\omega \\int_{4\\pi } d\\omega ^{\\prime } \\left\\ { \\left\\langle \\left| u_{\\perp } \\left ( { \\bf r}_{i}\\right ) \\right| ^{2}e^{-i\\left ( { \\bf k - k}^{\\prime } \\right ) { \\bf \\cdot r}_{i}}\\right\\rangle _ { \\left\\ { { \\bf r}_{i}\\right\\ } } \\right .",
    "\\label{28e } \\\\ & & \\times \\left .",
    "\\left\\langle u_{\\perp } ^{\\ast } \\left ( { \\bf r}_{i}\\right ) e^{i\\delta { \\bf k\\cdot r}_{i}}\\right\\rangle _ { \\left\\ { { \\bf r}_{i}\\right\\ } } \\left\\langle u_{\\perp } \\left ( { \\bf r}_{i}\\right ) e^{-i\\delta { \\bf k}% ^{\\prime } { \\bf \\cdot r}_{i}}\\right\\rangle _ { \\left\\ { { \\bf r}_{i}\\right\\ } } \\right\\ } -1 .",
    "\\nonumber\\end{aligned}\\]]similar to the case for calculating the signal mode structure @xmath201 , we also assume a gaussian pump beam and a gaussian form for the transverse atomic distribution function as is shown by eq . (",
    "19 ) . in this case",
    ", we have the following analytic expressions for these two ratios @xmath202@xmath203 ^{-2 } \\nonumber \\\\ & & \\times \\int_{0}^{\\pi } \\int_{0}^{\\pi } \\sin \\theta \\sin \\theta ^{\\prime } d\\theta d\\theta ^{\\prime } \\left\\ { \\frac{1}{2\\pi } \\int_{0}^{2\\pi } e^{-\\frac{1% } { 4}k_{0}^{2}r_{0}^{2}r_{0}^{2}\\left ( \\sin ^{2}\\theta + \\sin ^{2}\\theta ^{\\prime } -2\\sin \\theta \\sin \\theta ^{\\prime } \\cos \\varphi \\right ) /\\left ( r_{0}^{2}+2r_{0}^{2}\\right ) } d\\varphi \\right .",
    "\\label{30 } \\\\ & & \\left .",
    "\\times e^{-\\frac{1}{4}k_{0}^{2}r_{0}^{2}r_{0}^{2}\\left ( \\sin ^{2}\\theta + \\sin ^{2}\\theta ^{\\prime } \\right ) \\left ( r_{0}^{2}+r_{0}^{2}\\right ) } % % tcimacro{\\func{sinc}}% % beginexpansion \\mathop{\\rm sinc}% % endexpansion \\left [ k_{0}l\\left ( \\sin ^{2}\\frac{\\theta } { 2}-\\sin ^{2}\\frac{\\theta } { 2}% \\right ) \\right ] % tcimacro{\\func{sinc}}% % beginexpansion \\mathop{\\rm sinc}% % endexpansion \\left ( k_{0}l\\sin ^{2}\\frac{\\theta } { 2}\\right ) % tcimacro{\\func{sinc}}% % beginexpansion \\mathop{\\rm sinc}% % endexpansion \\left ( k_{0}l\\sin ^{2}\\frac{\\theta ^{\\prime } } { 2}\\right ) \\right\\ } -1 .",
    "\\nonumber\\end{aligned}\\]]in writing eq .",
    "( 29 ) , we have assumed @xmath204 and have neglected the term which is about @xmath205 times smaller .    from the two ratios @xmath193 and @xmath190 , the spontaneous emission loss and the inherent mode matching inefficiency",
    "are directly written as@xmath206@xmath207the approximations in eqs .",
    "( 31 ) and ( 32 ) are valid under the condition @xmath208  ( we neglected the terms which are @xmath209 times smaller ) .",
    "to minimize the two sources of noise @xmath43 and @xmath53 , it is better to have a large @xmath210 and a small @xmath190 .",
    "we will discuss the details in the following section on how to minimize these two noise by using different kinds of mode matching methods .",
    "at the end of this section , we would like to make a brief comparison with the single atom case .",
    "for the case of a single atom , if the position of this atom is also fluctuating in the space , the above calculation is still valid but with @xmath211 . from eqs .",
    "( 21)-(26 ) , we see that in the case of @xmath211 , we always have @xmath212 .",
    "thus , for the case of a single atom , the spontaneous emission loss is the only source of noise , as has been shown intuitively in fig .",
    "however , in this case , the spontaneous emission inefficiency @xmath43 , which can be approximated by @xmath213 since @xmath214 , becomes much larger .",
    "if we compare the efficiency ( defined as @xmath48 ) from the spontaneous emission noise between the single - atom case and the atomic - ensemble case , we see that this efficiency is increased by about a factor of @xmath1 for the atomic ensemble .",
    "this is what we called the collective enhancement of the signal - to - noise ratio for the many - atom ensemble .",
    "the first mode - matching method is to choose the signal mode as the mode for detection , with the mode function exactly given by the inherent spatial structure ( 20 ) of the signal light .",
    "the mode function ( 20 ) is similar to a gaussian function , especially when @xmath215 and @xmath216 .",
    "( it would be an exact gaussian function if the axial distribution of @xmath217 is gaussian ) .",
    "one can couple a gaussian mode into a single - mode optical fibre with a good technical mode - matching efficiency .",
    "for this case with an exact mode matching , the two noise probabilities @xmath43 and @xmath53 are exactly given by eqs .",
    "( 29)-(32 ) .",
    "we now go to the calculations of these two noise probabilities . for this purpose ,",
    "we need to understand first how to get a large @xmath210 and a small @xmath190 to minimize the noise @xmath218 and @xmath53 .",
    "first , we give an estimation of the ratio @xmath210 .",
    "it has a definite physical meaning . from eq .",
    "( 29 ) , we see that the integration function is significantly different to zero only when the integration variable @xmath219 falls into a small cone with @xmath220 , where @xmath221 is estimated by @xmath222 with @xmath223 .",
    "thus , the result of the integration can be estimated by @xmath224 .",
    "we also know that the total atom number can be approximated by @xmath225 , where @xmath226 denotes the average atom number density . from this",
    ", we see that the ratio @xmath227 is estimated by @xmath228if we assume that the two bounds for @xmath210 are comparable , which means that @xmath229 , or the fresnel number defined as @xmath230 is in the order of @xmath20 , we have @xmath231 , where the on - resonance optical depth @xmath232 is simply defined as @xmath233 .",
    "therefore , to have a small spontaneous emission inefficiency @xmath234 , we need to use an optically dense ensemble with @xmath235 ( the off - resonance optical depth can still be much smaller than @xmath20 due to the large detuning ) .",
    "next , we consider how to minimize the ratio @xmath190 by choosing appropriate interaction configurations . from eq .",
    "( 30 ) , we see that @xmath190 increase with the ratio @xmath236 .",
    "this can be intuitively understood as follows : the noise characterized by @xmath53 and @xmath190 comes from the density fluctuation of the atomic ensemble . with a larger @xmath168 ,",
    "the atoms have more space to move around , and one thus has a relatively larger density function and a larger noise ratio @xmath190 @xcite .",
    "thus , to minimize @xmath237 , we choose a configuration with @xmath238 in the following , which means , the pumping laser is shined on all the atoms with a broad cross section . in this case , the effective radius @xmath239 .",
    "now we would like to calculate the noise probabilities @xmath43 and @xmath53 in a more accurate way in the case of exact mode matching .",
    "this requires us to carry out the complicate integrations in eqs .",
    "( 29 ) and ( 30 ) , which is only possible by using numerical methods .",
    "the spontaneous emission inefficiency @xmath43 depends on the optical depth @xmath240 .",
    "we have numerically calculated the value of  @xmath241 versus the optical depth @xmath242 under different geometries of the atomic ensemble .",
    "the geometry of the ensemble is described by the fresnel number @xmath243 .",
    "the calculation result is shown in fig .",
    "5 . from the figure",
    ", we see that the spontaneous emission inefficiency is insensitive to the geometry of the ensemble .",
    "the two curves with @xmath244 and @xmath245 basically overlaps . with a much smaller @xmath246 , the inefficiency",
    "@xmath43 increases by about a factor of @xmath247 . on the other hand",
    ", @xmath43 is sensitive to the optical depth @xmath248 .",
    "it decrease with @xmath249 approximately linearly , which confirms the rough estimation from the above . from the curves",
    ", we can write @xmath218 approximately as @xmath250 for the fresnel number @xmath251 from @xmath20 to @xmath252 . in the above numerical calculation , we assumed some typical values for the parameters with @xmath253 m and @xmath254 cm , but actually the result is very insensitive to the parameter @xmath255 as long as it is still much larger than @xmath20 . for an atomic cell with a typical number density @xmath256@xmath257 and length @xmath254 cm , the optical depth @xmath258 , and we have a spontaneous emission inefficiency @xmath259 , which is very small .",
    "the inherent mode matching inefficiency @xmath53 is determined by the geometry of the ensemble , and does not depend on the value of the optical depth .",
    "we have numerically calculated the value of @xmath53 .",
    "it turns out that @xmath53  is actually also insensitive to the geometric parameters @xmath255 and @xmath260 as long as they are still in the typical region .",
    "for instance , we have @xmath261 for @xmath244 , @xmath262 for @xmath245 , and @xmath263 for @xmath264 . in each case",
    ", we change the length @xmath33 from @xmath265 cm to @xmath266cm(with @xmath267 m ) , and the value of @xmath53 basically does not change at all .",
    "note that the typical inherent mode matching inefficiency @xmath261 is quite large , and we can not efficiently reduce it by controlling the geometry of the ensemble . as we have mentioned before",
    ", the mode mismatching noise has a more significant influence on the efficiency of the application schemes than the spontaneous emission noise .",
    "the large inherent mode matching inefficiency is a disadvantage of the exact mode - matching method .    to reduce the inefficiency @xmath53",
    ", we consider the following simple improvement to the exact mode matching method . after the light - atomic - ensemble interaction ,",
    "the scattered light is focused by a lens , and we apply an aperture on the focal plane of the lens to collect the signal light only from a small cone in the forward direction with @xmath268 , where the detection angle @xmath269 can be controlled by the size of the aperture .",
    "we call this kind of mode matching the filtered exact mode matching . by the exact mode matching , we detect the photon scattered to the signal mode ; and by the filtered exact mode matching , we only detect the scattered photon which is in the signal mode and at the same time lies in the filtering cone with @xmath270 . due to the additional restriction , we now have a less success probability to register the photon",
    ". the spontaneous emission inefficiency @xmath241 should increase , but through this scarification , we can significantly reduce the noise @xmath53 , which means , if we register the photon with this additional restriction , we are more confident that the accompanying atomic excitation will go to the collective atomic mode @xmath9 . to calculate @xmath43 and @xmath53  for the filtered exact mode matching , we can still use eqs .",
    "( 21)-(26 ) , but the signal mode @xmath10 should be confined inside the small cone with @xmath268 . inside this filtering cone , the signal mode has the same mode structure as given by eq .",
    "( 20 ) . with this modified signal mode",
    ", we find that @xmath53 is still given by eqs .",
    "( 32 ) and ( 30 ) , but all the integrations of @xmath219 and @xmath271 in eq . (",
    "30 ) can only be taken from @xmath272 to the filtering angle @xmath269 instead of from @xmath272 to @xmath273 . the spontaneous emission inefficiency @xmath43 now has the following expression@xmath274where we have assumed @xmath275 for the approximation , and the symbol @xmath276 means that the integration of @xmath219 in @xmath42 can only be taken from @xmath272 to @xmath269 . from eq .",
    "( 34 ) , we need to calculate two ratios @xmath193 and @xmath277 for @xmath43 . the ratio @xmath193 is exactly given by eq .",
    "( 29 ) , and the ratio @xmath278 has the same form as eq .",
    "( 29 ) , but the integration of @xmath219 is only from @xmath272 to @xmath279 .    we have numerically calculate the noise probabilities @xmath43 and @xmath55 versus the filtering angle @xmath269 , and the result is shown in fig . 6 with the fresnel number @xmath244 and the optical depth @xmath280 . from the figure , we see that by decreasing the filtering angle @xmath269 , we can significantly reduce the noise @xmath49 .",
    "the cost is that at the same time the inefficiency @xmath218 significantly increases .",
    "however , as we have mentioned before , though both of the noise @xmath43 and @xmath53 are correctable in the application schemes in refs .",
    "@xcite , the mode mismatching noise @xmath53 has a more severe influence on the final efficiency of the schemes than the spontaneous emission noise @xmath281 .",
    "thus , for these applications , it is worthy to choose an appropriate filtering angle @xmath269 with @xmath53 significantly smaller than @xmath43 .",
    "for instance , if we choose the angle @xmath282 , the mode mismatching noise @xmath283 , which is basically negligible compared with other sources of noise . at the same time , @xmath284 , which seems to be quite large .",
    "however , to overcome this noise , we need only to increase the repetitions of the entanglement generation scheme in refs .",
    "@xcite by another factor of @xmath266 ( given by @xmath285 ) , which is actually only a moderate cost .",
    "this choice would be much better than the case without any filtering , where we have an inherent mode mismatching noise @xmath286 .",
    "for the purpose of guiding the choice of the best experimental configuration , we list several important values of @xmath218 and @xmath53 versus the angle @xmath269 in the following table    [ cols= \" < , < , < , < , < , < \" , ]     for the simple filtering method , we also calculated the noise probabilities @xmath241 and @xmath53 under different geometries of the ensemble . for the fresnel number @xmath245 and @xmath264 ,",
    "the results are shown in fig .",
    "we assumed the same optical depth and the cell length in these calculations . since the qualitative picture revealed by this figure is quite similar to the case of the filtered exact mode matching",
    ", we do not need to discuss its properties in details .",
    "for experimental realizations , the simple filtering method can be much easier than other mode matching methods .",
    "the calculation here shows that the price we need to pay for this simplification is to choose a smaller filtering angle with a significantly increased spontaneous emission inefficiency .",
    "note that for the application schemes in refs .",
    "@xcite , this price seems to be still acceptable .",
    "for instance , if we choose @xmath287 , the mode mismatching noise @xmath288 has already been small . in this case , the additional repetitions of the entanglement generation scheme in refs .",
    "@xcite is given by the factor @xmath289 , which is not too much .",
    "in summary , we have developed a theory in the weak pumping limit to describe the three - dimensional effects in the interaction between the free - space light and the many - atom ensemble .",
    "the calculations demonstrate some interesting results which are not know from the other approaches : firstly , it shows that the signal light has an inherent spatial mode structure , which is determined together by the geometry of the ensemble and the mode structure of the pump beam .",
    "secondly , it reveals that there will be two sources of noise during the light - atom interaction .",
    "one is the spontaneous emission inefficiency , which is inversely proportional to the on - resonance optical depth of the ensemble ; and the other is the inherent mode mismatching noise , which arises from the density fluctuation of the ensemble , and should be fully determined by the geometry of the ensemble for room - temperature atomic cells .",
    "it turns out that the inherent mode mismatching noise is quite large if one collects the signal light through the exact mode matching method , and one can not efficiently reduce this noise by optimizing the geometry of the ensemble since in the typical parameter region , this noise is insensitive to the cell geometry . finally , we show an effective way to reduce the inherent mode mismatching noise by adding an aperture to select the light only from a small emission cone . by this mean , we can efficiently reduce the mode mismatching noise at the price of increasing the spontaneous emission inefficiency .",
    "it is worthy to do this since the spontaneous emission inefficiency is far less important for some application schemes .",
    "there are two methods for this purpose : the filtered exact mode matching method and the simple filtering method .",
    "both methods can reduce the inherent mode matching noise if one chooses an appropriate filtering angle .",
    "the calculations in this paper show that there is a large collective enhancement of the signal - to - noise ratio if one compares the many - atom ensemble with the single - atom case , which confirms the predication from some simple theoretical models , and demonstrates the validity of this important observation for the complicated realistic situations .    at the end of this paper",
    ", we should mention that the calculations here also show that for any mode matching method , we can not make the spontaneous emission inefficiency @xmath43 and the inherent mode mismatching noise @xmath53 both negligible for the room - temperature atomic cell even if the cell has a large on - resonance optical depth .",
    "this result does not have much influence on the application schemes in refs .",
    "@xcite since they are inherently robust to the noise @xmath43 and @xmath49 . as a consequence of this inherent robustness",
    ", a non - negligible but not - huge noise only has a moderate influence on the efficiency of the schemes .",
    "however , for any of the application schemes of atomic ensembles which are not inherently robust , such as the quantum light memory scheme or the continuous variable teleportation scheme @xcite , a non - negligible noise will decrease the scheme fidelity .",
    "the calculations here do not directly apply to these schemes , since they work out of the perturbation region .",
    "however , it indeed raises the interesting question whether there is some theoretical limit on the best achievable fidelity of these schemes if one uses free - space atomic cells for their implementation .",
    "* acknowledgments * : l.m.d .",
    "thanks jeff kimble and alex kuzmich for discussions",
    ". work of l.m.d was supported by the caltech muri center for quantum networks under aro grant no .",
    "daad19 - 00 - 1 - 0374 , by the national science foundation under grant no .",
    "eia-0086038 , and also by the chinese science foundation and chinese academy of sciences .",
    "work at the university of innsbruck was supported by the austrian science foundation and eu networks .",
    "note that for rapidly moving atoms , we also have the effect of doppler shifts which are not included in the hamiltonian ( 6 ) .",
    "however , the doppler shifts are not important for the off - resonant coupling considered here ( they are still significantly than the detuning ) . in addition",
    ", the doppler shifts will cancel for the spontaneous emission modes which are nearly collinear with the pumping laser ( including the important signal light mode ) .",
    "the noise properties in  subsequent discussions will depend on the ratio of the transverse length scales for the atomic cell and for the pump beam , but they are insensitive to the detailed form of the atomic distribution function . here ,",
    "for simplicity of the calculation , we assume a gaussian form for the atomic transverse distribution function .",
    "but we expect that all the results will be basically still valid if the transverse distribution is not in the gaussian form , but instead , is uniform within the cell radius @xmath168 and zero outside .    note that this is a valid picture for room - temperature atomic cells .",
    "however , for ultracold atoms , each atom will be localized in a small space , and the density fluctuation basically will not depend on the size and geometry of the ensemble .",
    "thus , for cold atoms , one may have a different interaction picture and a smaller noise ratio ."
  ],
  "abstract_text": [
    "<S> atomic ensembles have shown to be a promising candidate for implementations of quantum information processing by many recently - discovered schemes . </S>",
    "<S> all these schemes are based on the interaction between optical beams and atomic ensembles . for description of these interactions , </S>",
    "<S> one assumed either a cavity - qed model or a one - dimensional light propagation model , which is still inadequate for a full prediction and understanding of most of the current experimental efforts which are actually taken in the three - dimensional free space . here , we propose a perturbative theory to describe the three - dimensional effects in interaction between atomic ensembles and free - space light with a level configuration important for several applications . </S>",
    "<S> the calculations reveal some significant effects which are not known before from the other approaches , such as the inherent mode - mismatching noise and the optimal mode - matching conditions . </S>",
    "<S> the three - dimensional theory confirms the collective enhancement of the signal - to - noise ratio which is believed to be one of the main advantage of the ensemble - based quantum information processing schemes , however , it also shows that this enhancement need to be understood in a more subtle way with an appropriate mode matching method .    # </S>"
  ]
}