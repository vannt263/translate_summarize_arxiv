{
  "article_text": [
    "in phylogeny , one assumes that the relationship of a set of taxonomic units ( or taxa ) can be visualised by a ( binary ) tree .",
    "the aim is to derive this tree from the observations at the taxa . from a stochastic modelling point of view , one assigns the taxa to the leaves of a ( binary ) tree , and assumes that the observations ( which are usually considered to be i.i.d . over different sites ) are the end results of a markov process along the tree .",
    "the goal is to derive the best combination of tree and markov model to explain the observations .",
    "this work regards the identifiability problem of this inference .",
    "it essentially asks whether it is possible that infinite data sets are able to uniquely identify the transitions on the tree and the tree completely .",
    "note that in the present context , identifiability readily leads to consistency of various methods of estimating the parameters of the model ( see * ? ? ?",
    "* section 2.2 for an overview ) .",
    "however , usually one only has an estimate of the leaf distribution such a process induces .",
    "this leads to the question of whether one can find ( simple ) conditions to determine whether a taxon distribution comes from a markov process . in other words",
    ", we ask whether we can validate the model , at least if there are infinitely many data points available .",
    "to approach this problem , we consider a very simple model .",
    "we assume that our process can take only one of two states for every site , and that the tree is a tripod tree .    under these restrictions",
    ", we can completely describe the map from the taxon distribution to the parameters of the model , including necessary and sufficient conditions on positivity of the parameters .",
    "thereby , no conditions for reversibility of the processes on the edges are needed .",
    "the analysis of the model on tripod trees has immediate consequences for quartet trees .",
    "we derive these conditions to exemplify the shortcomings of an extension from tripods to quartets .",
    "technically , the generic part of this work is already well - known .",
    "initial work on the two state model from psychology can be found in @xcite .",
    "@xcite used these results in artificial intelligence to algorithmically identify the whole tree behind two - state markov models .",
    "note that identifiability of markov models especially in phylogeny was studied in @xcite .",
    "we add to those results the analysis of the degenerate cases , together with a complete analysis of the quartet tree model .    the typical tool ( for multi - state models ) to identify a subspace of taxon distributions which might come from a markovian tree model are phylogenetic invariants @xcite .",
    "those invariants are polynomials in the taxon distribution which are zero for those distributions that are derived from the model of interest .",
    "@xcite discuss another very interesting set of invariants , the so - called markov invariants .",
    "these are invariants whose value on a tree scales with the determinants of the markov matrices on the edges .",
    "thus , markov invariants indicate simple relations between the observations ( the distribution of leaf states ) and the model ( described by the markov matrices ) , and provide conditions on the observations based on properties of the model .",
    "we will make use of this property in this work .    in the two - state tripod case",
    "there is only one , the trivial invariant .",
    "but , not all leaf distributions are derived from the markov model . in fact",
    ", we derive polynomials that vanish on distributions which satisfy the trivial invariant but are not identifiable under the markov model . to accommodate this observation we suggest incorporating these polynomials into the set of invariants but with the addition that these polynomials do not vanish for identifiable distributions .",
    "we discuss degenerate distributions to describe this observation .",
    "although most of the leaf distributions allow for complex solutions of the model equations , in order for the solution of the algebraic equation to be parameters of a markov model additional inequalities must be fulfilled @xcite .",
    "the approach of @xcite is restricted to the cavender - farris - neyman model ( cfn * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) to accommodate the hadamard approach @xcite .",
    "@xcite investigated the cfn model to explore conditions to obtain solutions for different optimisation problems in phylogeny . extending our approach we recover the inequalities presented in @xcite .",
    "as a final step we investigate how the results for tripod trees extend to trees of four leaves .",
    "the results provide a glimpse at what we can expect from the reconstruction from tripods when we have no knowledge of the identifiability of the given taxon distribution .",
    "the structure of this work is as follows : in section [ sect.model ] we describe the general mutation model on a tree , with specialisation to tripod trees coming in section [ sect.tree ] .",
    "section [ sect.tripod ] deals with the complete solution of the two - state tripod tree model",
    ". then , in section [ sect.quartet ] we use these results to analyse the general two - state markov model on quartet trees .",
    "section [ sect : markovinv ] discusses the relation between our work and the concept of markov invariants , and possible extensions of this work . ] for the sake of readability , proofs are presented in [ app : proofs ] .",
    "in this section we introduce the general markov model and its properties .",
    "@xcite nicely motivate this model in the following way .",
    "assume , one is given a set @xmath0 of taxa and a set of observations from a markov process @xmath1 . from these observations",
    "one deduces a correlation between the taxa .",
    "the assumption is that this correlation can be explained by an underlying ( binary ) tree @xmath2 and an extension @xmath3 of @xmath4 such that for any pair of taxa there is an interior node such that given the state at the interior node the two taxa are independent .",
    "[ fig : arbitrary ] for a depiction of this .    a binary tree with six leaves .",
    "gray lines and nodes describe the hidden part of the process . ]",
    "let us look closer at the process @xmath5 .",
    "the independence of pairs of taxa given an interior node on the path between them corresponds to the so - called _ directed local markov property _",
    "( e.g. , * ? ? ?",
    "* chapter 2 ) . for this property one has to identify a node @xmath6 as the root of the tree and direct all edges away from @xmath7 .",
    "thus , our tree becomes a directed acyclic graph , and for every node @xmath8 there is a parent node @xmath9 ( with respect to the root ) , such that @xmath10 .",
    "further , for each node @xmath11 one defines the set its descendants as those nodes @xmath12 for which the path from the root to @xmath12 passes through @xmath13 .",
    "the non - descendants are then the nodes that are neither descendants nor parents .",
    "the directed local markov property states that conditioned on the state of its parent node the state of a node @xmath9 is independent of the states of its non - descendants . with this property",
    "the joint distribution @xmath14 has the _ factorisation property _ ,",
    "i.e. for the joint state @xmath15 we get    @xmath16\\prod_{(\\alpha,\\beta)\\in{e } } \\pr[y_\\beta=\\chi_\\beta|y_\\alpha=\\chi_\\alpha]= q^{\\zeta}_{\\chi_{\\zeta}}\\prod_{(\\alpha,\\beta)\\in{e}}m^{\\alpha\\beta}_{\\chi_\\alpha\\chi_\\beta}.\\ ] ]    here , the marginal distribution @xmath17 corresponds to the initialisation of the process , i.e. @xmath18 is the probability that the process attains state @xmath19 at the root .",
    "the transition matrices @xmath20 describe the way the process progresses along an edge .",
    "e.g. , for an edge @xmath10 the term @xmath21 is the probability that the character @xmath22 at node @xmath12 is mutated into character @xmath23 at node @xmath13 .    in summary",
    ", the joint probability distribution @xmath14 is given by the marginal distribution @xmath17 and the transition matrices @xmath20 , and thus such a markov process is completely characterised by these parameters .",
    "we will call @xmath17 and @xmath20 the _ process parameters_.    in general , the actual position of the root node @xmath7 is not important for , i.e. @xmath7 can be chosen arbitrarily from @xmath24 , including a leaf ( e.g. , * ? ? ?",
    "we only have partial knowledge on the realisations of the process @xmath5 through the process @xmath4 on the leaves .",
    "the joint distribution @xmath25 of @xmath4 can then be inferred from using the law of total probability .",
    "let @xmath26 denote the joint state at the leaves . then    @xmath27    note that under the assumption that @xmath4 comes from a reversible markov process @xmath5 @xcite proved that all process parameters can be recovered from all the distributions of the restrictions of @xmath4 to arbitrary triples of taxa .",
    "if we find process parameters for a joint taxon distribution @xmath28 then we call @xmath28 _ tree decomposable_. if the obtained process parameters are unique ( up to model - specific symmetries ) , we call @xmath28 _ algebraically identifiable _ , and if further the process parameters are marginal and transition probabilities , then @xmath28 is called _ stochastically identifiable_. clearly , any stochastically identifiable distribution is also algebraically identifiable .    looking at we realise that verifying the tree decomposability of a distribution @xmath28 is equivalent to solving a polynomial equation system of @xmath29 independent equations in @xmath30 variables .",
    "we observe that the markov equations are overdetermined for @xmath31 , i.e. the space of tree decomposable distributions is a proper subspace of the space of all distributions . from this",
    "we conclude , that there are conditions that define a tree decomposable distribution .",
    "these conditions are generally known as _",
    "invariants _ , polynomials in @xmath29 variables whose roots are distributions that are tree decomposable .",
    "one example of an invariant is    @xmath32    i.e. all probabilities sum to one .",
    "this is fittingly called the _",
    "trivial invariant_. @xcite provide a complete set of invariants for trees of arbitrary size under a two - state - model , and observe that for complete identification the knowledge of the restrictions to six taxa are necessary .",
    "however , as pointed out in multiple publications ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) such invariants are not sufficient to guarantee tree identifiability . in particular , additional inequalities are needed .    here",
    ", we are not only interested in recapturing invariants and inequalities .",
    "in addition , we also investigate those distributions that are not algebraically identifiable or not tree decomposable at all to discuss their impact on invariant - based inference .",
    "the starting point of our analysis is the tripod tree @xmath33 with taxa @xmath34 , interior node @xmath7 and edges @xmath35 ( see fig . [",
    "fig : tripod ] ) .",
    "this is the only labeled topology for three taxa .",
    "hence any inference will be process- and not topology - related . @xcite select a taxon as the root for their approach .",
    "we will place the root at the interior node for the symmetry this provides in the tree equations .",
    "the tripod tree @xmath33 . ]    as stated in the previous section , if the joint distribution @xmath28 of @xmath36 comes from a markov process then there are parameters @xmath37 such that the markov equations are satisfied . on a tripod tree",
    "these equations are the _ tripod equations _",
    "@xmath38    as before we call @xmath28 _ tree decomposable _ , if there are parameters , _ algebraically identifiable _",
    ", when the parameters are unique ( up to some symmetries discussed later ) , and _ stochastically identifiable _ if the parameters are unique and proper marginal and transition probabilities .",
    "the works of @xcite and @xcite were mainly interested in inferring conditions under which a triplet distribution is stochastically identifiable .",
    "while recovering their results we also investigate tree decomposability and algebraic identifiability in order to describe their impact on invariant - based inference .    for three taxa",
    "the only invariant is the trivial invariant .",
    "thus , one could expect that all triplet distributions are tree decomposable . as we will see later ,",
    "this is not the case .",
    "in fact , we will present polynomials whose roots satisfy the trivial invariant but are not tree decomposable .      following @xcite we identify the symbols @xmath39 and @xmath40 with their actual integer counterparts .",
    "this permits us to introduce a set of terms that are very helpful for later steps of the analysis .",
    "we start by introducing the following abbreviations :    @xmath41=p_{111},\\\\ { \\varepsilon}_{\\alpha\\beta}&:={\\mathbb{e}}x_\\alpha x_\\beta=\\pr[x_\\alpha=1,x_\\beta=1]=p_{11{\\sigma}}=p_{110}+p_{111},\\\\ { \\varepsilon}_\\alpha&:={\\mathbb{e}}x_\\alpha=\\pr[x_\\alpha=1]=p_{1{\\sigma}{\\sigma}}=p_{100}+p_{101}+p_{110}+p_{111}.\\end{aligned}\\ ] ]    the symbols @xmath42 and its modifications @xmath43 etc .",
    "are direct consequences of the application of the law of total probability to the equation system .",
    "these terms are also known as _",
    "marginalisations _ leading to a removal of a random variable from consideration by summing over its states .",
    "this linear modification means we can study the tripod equations also in terms of its marginalisations .    in the case of the binary model the above symbols @xmath44 for all @xmath45 correspond to the joint mean of the random variables for the taxa in @xmath46 . using these definitions we can introduce simple terms which correspond to the covariances between the set of random variables :    @xmath47={\\mathbb{e}}x_\\alpha x_\\beta-{\\mathbb{e}}x_\\alpha{\\mathbb{e}}x_\\beta,\\end{aligned}\\ ] ]    with equivalent definitions for @xmath48 and @xmath49 .",
    "of further interest are the following terms ( @xmath50 )    @xmath51    with equivalent definitions for @xmath52 and @xmath53 .",
    "these terms are actually multiples of the conditional covariances , @xmath54={\\tau}_{\\alpha\\beta|c}/p_{{\\sigma}{\\sigma}c}$ ] .",
    "finally , we also introduce the three - way covariances    @xmath55={\\mathbb{e}}(x_\\alpha-{\\mathbb{e}}x_\\alpha)(x_\\beta-{\\mathbb{e}}x_\\beta)(x_\\gamma-{\\mathbb{e}}x_\\gamma)\\\\ & = { \\varepsilon}_{\\alpha\\beta\\gamma}-{\\varepsilon}_\\alpha{\\varepsilon}_{\\beta\\gamma}-{\\varepsilon}_\\beta{\\varepsilon}_{\\alpha\\gamma}-{\\varepsilon}_\\gamma{\\varepsilon}_{\\alpha\\beta}+2{\\varepsilon}_\\alpha{\\varepsilon}_\\beta{\\varepsilon}_\\gamma.\\end{aligned}\\ ] ]    for a review on covariance for more than two random variables see e.g. @xcite .",
    "the term @xmath56 describes the interactions of the three leaves considered .",
    "@xcite call this term a _",
    "stangle _ , a stochastic tangle , highlighting its relation to entangled states of qbits in quantum mechanics .",
    "the three - way covariances are zero in the case of symmetric models like cfn , which also reflects the findings in @xcite .",
    "however , for more complex models the three - way covariances are needed as indicated by the findings of @xcite .    since covariances are a measure of interdependence of random variables , and because the identification of a tree and a markov model is an interpretation of the interdependence in terms of hidden variables and conditional independence , looking at these covariances is a very logical way to verify whether or not such an interpretation is admissible .",
    "using these terms we can immediately propose a useful property .",
    "[ lemma : flip ] let @xmath28 denote the joint probability for binary random variables @xmath57 and @xmath58 . if we flip the state in one taxon , then we flip the signs in its pairwise covariances . e.g. , if @xmath59 , then @xmath60 , @xmath61 @xmath62 .",
    "one immediate consequence of this observation is that the product @xmath63 always has the same sign no matter how much we flip states .      in this section",
    "we assume that @xmath28 is tree decomposable and regard some immediate consequences .",
    "we will later see that these conditions are necessary for identifiability but not sufficient .",
    "nevertheless , these conditions provide some immediate insights for it .",
    "[ lem : indi ]    1 .",
    "if a triplet distribution @xmath28 is tree decomposable on @xmath33 with @xmath64 , then also @xmath65 and @xmath66 or @xmath67 .",
    "if a triplet distribution @xmath28 is stochastically identifiable then the product @xmath63 is non - negative .",
    "the non - negativity of the product has already been verified by @xcite .",
    "with lemma [ lemma : flip ] it is not complicated to derive that on a star tree ( with arbitrary number of leaves ) there always is a state flipping such that all pairs of leaves are positively correlated .",
    "[ coro : positiveflipping ] suppose we are given a stochastically identifiable distribution @xmath28 on a tree with finite leaf set @xmath68 such that the pairwise covariances do not vanish , i.e. , @xmath69 for all @xmath70 .",
    "then there exists a set of leaves @xmath71 such that flipping the states of the leaves in @xmath72 yields all covariances @xmath73 , @xmath70 , being positive .",
    "lemma [ lem : indi](1 ) occurs exactly if @xmath74 or @xmath75 is independent of the remaining random variables .",
    "it also implies the following :    [ coro : notreepair ] a triplet distribution @xmath28 with @xmath64 but @xmath76 and @xmath77 is not tree decomposable .",
    "thus we already see , that the trivial invariant does not characterise tree decomposable distributions in this setting .",
    "the following example shows that such cases can be easily constructed .",
    "[ ex : notreepair ] triplet distributions of type    @xmath78\\setminus\\{2\\},\\end{aligned}\\ ] ]    yield @xmath64 but @xmath79 and hence are not tree decomposable .",
    "in fact , for binary variables a much more complicated graphical model with more `` inner '' nodes and edges is needed to explain theses covariances .",
    "in this section we are given a triplet distribution @xmath28 and infer conditions under which it is algebraically identifiable .",
    "for each case we will present an example .",
    "as has been pointed out multiple times , the only invariant in the tripod case is the trivial invariant . in other words ,",
    "the `` set '' of invariants for a tripod tree is satisfied by all triplet distributions . however , as we have seen in corollary [ coro : notreepair ] there are triplet distributions that are not tree decomposable even though they satisfy the trivial invariant . thus executing the actual decomposition , i.e. finding a solution for the tripod equations not only provides complete forms for the parameters but is also helpful to identify further cases .",
    "the first task is to clarify up to which level of uniqueness the decomposition of a triplet distribution can be attained .",
    "to do this we look at the implications of a state - flip at the root .",
    "[ lem : stateflip ] if a triplet distribution @xmath28 is tree decomposable with parameters @xmath37 then it is also tree decomposable for parameters @xmath80 with @xmath81 .    hence , except for the case where everything is equal to @xmath82 , there will always be at least two sets of parameters that decompose a triplet distribution @xmath28 . in terms of molecular evolution",
    "one can view these solutions as having either few mutations ( @xmath83 leaf ) or many mutations ( @xmath84 leaf ) for the other .",
    "@xcite addressed the problem of symmetric solutions by introducing matrix categories that are _ reconstructible from rows_. one such class consists of diagonally dominant matrices , i.e. @xmath85 for all leaves and @xmath86 .",
    "if only these two sets of parameters exist then we will regard the associated distribution as algebraically identifiable .",
    "it should be noted that the set of symmetric solutions increases with the number of parameters , i.e. each possible permutation of the states at the root yields a new solution .",
    "this fact has also been observed by @xcite in the case of the time - continuous markov model .",
    "next , we present conditions under which @xmath28 is algebraically identifiable and present the closed form for the parameters .",
    "[ thm : alg ] let @xmath28 denote a triplet distribution and assume    @xmath87    then @xmath28 is algebraically identifiable .",
    "the associated parameters have the following form :    @xmath88    where @xmath89 .",
    "note that @xcite presented a similar solution for the parameters .",
    "looking at the parameters in we see that algebraically the conditions in prevent division by zero .",
    "together with the trivial invariant we can thus claim that the space of algebraically identifiable triplet distributions is given by @xmath90 with    @xmath91    considering and lemma [ lem : indi](2 ) we see that triplet distributions with @xmath92 are only algebraically , but not stochastically identifiable .",
    "in fact , for @xmath93 we get real - valued parameters , and for @xmath94 we get a set of complex - valued parameters .",
    "the following example presents such distributions .    [ ex : negative ] regard the distributions    @xmath95    all three distributions satisfy the conditions , i.e. they are algebraically identifiable . for @xmath96 the covariance @xmath49 is negative and the other two positive , while for @xmath97 we have @xmath48 negative and the other two positive .",
    "the distribution @xmath98 has only positive pairwise covariances .",
    "the parameters for @xmath96 are real - valued , the parameters for @xmath97 are complex - valued and @xmath98 is stochastically identifiable .",
    "though this example is artificial it indicates just how sensitive the model is to misreads in alignments .",
    "e.g. , the difference between @xmath96 and @xmath98 could be seen as reading the pattern @xmath99 under @xmath98 as pattern @xmath100 under @xmath96 .",
    "the next step is to determine conditions under which a distribution satisfying is stochastically identifiable .",
    "these conditions should correspond to the conditions given by ( * ? ? ?",
    "* theorem 1 ) .",
    "example [ ex : negative ] dealt with @xmath92 .",
    "however , as the following example shows , positivity of the product does not necessarily yield stochastic identifiability .",
    "[ exa : pos ] the tripod distribution    @xmath101    yields positive covariances for all three pairs but also @xmath102 , i.e. not a probability .    the example contains a pattern of expected zero occurrence . from the tripod equations we conclude that a stochastically identifiable distribution is strictly positive , thus this example",
    "is slightly contrived . however , as example [ ex : notreepair ] showed , a strictly positive triplet distribution is not necessarily stochastically identifiable either .    in order to get necessary and sufficient conditions on a triplet distribution to be stochastically identifiable we need to go back to the parameters in and bound them accordingly .",
    "this yields :    [ thm : stoch ] a triplet distribution @xmath28 is stochastically identifiable if and only if after suitable state flips the following inequalities hold    @xmath103    in other words , the direction of the correlation between a pair of leaves shall not be influenced by the third leaf . with this",
    "we can summarise that a triplet distribution is stochastically identifiable if it is in @xmath90 and there is a state flip such that is satisfied .",
    "the tripod distribution @xmath28 from example [ exa : pos ] has positive pairwise and conditional covariances except for @xmath104 .",
    "thus it does not satisfy .",
    "the above considerations dealt with cases where a given triplet distribution @xmath28 is algebraically identifiable . the final step of the tripod analysis is to regard those distributions that violate the conditions .",
    "corollary [ coro : notreepair ] already discussed the case where one pairwise covariance is zero while the other two are not and we found that they were not tree decomposable . in the following we look at the remaining cases .",
    "[ prop : nofullpair ] assume that a triplet distribution @xmath28 obeys @xmath105 but @xmath106 .",
    "then @xmath28 is not tree decomposable .    in other words",
    ", we found another set of triplet distributions that are not tree decomposable .",
    "the distribution    @xmath107    yields @xmath108 and @xmath109 but @xmath110 and hence has no factorisation in the sense of .",
    "as in example [ ex : notreepair ] we point out here that there seems to be no simple graphical structure which explains the observed covariances adequately . on the other hand ,",
    "similarly to example [ ex : negative ] the simple act of moving @xmath111 from pattern @xmath112 to pattern @xmath113 yields algebraic identifiability .",
    "this indicates the level of care required when inferring meaning from observed covariances .",
    "together with corollary [ coro : notreepair ] this covers the distributions that are not tree decomposable .",
    "the remaining cases are triplet distributions that are tree decomposable but not algebraically identifiable .",
    "[ prop : degenerates ] let @xmath28 be a triplet distribution with @xmath64 and @xmath66 .",
    "then @xmath28 is tree decomposable with infinitely many parameter sets .",
    "the parameter sets are identified by one of the following compositions :    1 .",
    "then @xmath114 , and for any @xmath115 : + @xmath116 + with free parameters @xmath117 .",
    "2 .   @xmath67 .",
    "then for all @xmath118 the free parameters can be distributed as follows : 1 .",
    "@xmath119 and + @xmath120 + with free parameters @xmath121 .",
    "2 .   @xmath122 with free parameter @xmath123 .",
    "3 .   @xmath124 with free parameters @xmath125 .",
    "in other words , the distribution is tree decomposable because process parameters exist but it is not algebraically identifiable because we have no means to recover the true parameters or more precisely , there are infinitely many parameters that yield the same distribution .",
    "the triplet distribution    @xmath126    yields complete independence of the leaves @xmath127 , i.e. the case ( ii ) in proposition [ prop : degenerates ] is to be regarded here .",
    "it is not too surprising that such a distribution yields an infinite number of solutions since the state at the root is completely undetermined .",
    "looking again at the cases listed above , we see that @xmath74 is not only pairwise independent from @xmath128 ( induced by @xmath129 ) , but even completely independent .",
    "then the multiple solutions come from the fact that we can place the root arbitrarily between @xmath13 and @xmath130 .",
    "the good news is , that the non - identifiable cases form a small subset among all triplet distributions .",
    "in fact :    [ prop : lebesgue ] non - identifiable triplet distributions , i.e. distributions violating the conditions form a lebesgue zero set in the set of all possible triplet distributions .",
    "this concludes our analysis of the tripod case .",
    "we identified the subset of triplet distributions that are uniquely algebraically and stochastically identifiable , and those that are tree decomposable but not algebraically identifiable , or not tree decomposable at all .",
    "in this section we will explore the implications of extending the results for three taxa to four taxa . for this section",
    "we look at the quartet tree @xmath131 with    @xmath132    fig .",
    "[ fig : quartet ] provides an illustration including the four tripod restrictions @xmath133 and @xmath134 .",
    "regard the quartet distribution @xmath135 describing the joint distribution for @xmath136 and @xmath137 .",
    "if @xmath138 is stochastically identifiable and reversible then it can be reconstructed from the _ marginalisations _ on its four tripods @xcite , i.e. computing the parameters for all tripods will immediately return the full process . however , the converse is not necessarily true . as example",
    "[ exa : chor ] below shows , there are cases where each tripod marginalisation is stochastically identifiable but no quartet tree can be reconstructed .",
    "the quartet tree @xmath139 with its tripod restrictions @xmath140 and @xmath141 .",
    "again , gray lines and vertices indicate the hidden or unknown variables of the approach presented here . ]",
    "@xcite presented an algorithm to reconstruct the topology for an arbitrary number of taxa .",
    "their algorithm employs the condition that tripods that share an interior node in the ( unknown ) tree topology must have the same marginal distribution at this interior node .",
    "their approach yields an invariant , which for @xmath139 amounts to    @xmath142    this invariant is related to the four - point - condition ( e.g. , * ? ? ?",
    "* ) and thus topologically informative , i.e. it is particular to topology @xmath139 . if a distribution @xmath138 is from another tree than @xmath143 .    to reconstruct the process parameters as well , more invariants are needed .",
    "in particular , for @xmath138 to be algebraically identifiable on @xmath139 the parameters obtained from the tripod marginalisations must satisfy the following properties :    1 .",
    "the parameters for edges @xmath144 and @xmath145 obtained from triplet distributions @xmath146 and @xmath147 , respectively , must be equal .",
    "2 .   the parameters for edges @xmath148 and @xmath149 obtained from triplet distributions @xmath150 and @xmath151",
    ", respectively , must be equal .",
    "the parameters @xmath152 for the interior edge @xmath153 are obtained from the equations + @xmath154 + these equations must hold equivalently when @xmath130 is replaced by @xmath137 and the parameters come from tripod @xmath155 instead of @xmath156 .",
    "these conditions imply further restrictions on @xmath138 .",
    "an indicator for the minimal number of such conditions is the observation that a quartet distribution @xmath138 has 15 degrees of freedom , but there are only 11 process parameters on @xmath139 , two for each edge and one for the root distribution .",
    "thus we need at least four additional conditions or rather invariants .",
    "we will use the above observations to derive an equivalent set of invariants .",
    "[ prop : algext ] a quartet distribution @xmath138 is algebraically identifiable on @xmath139 if its tripod marginalisations satisfy conditions and the following invariants vanish on @xmath138 :    @xmath157    the parameters unique up to state flip at the interior nodes are then given by theorem [ thm : alg ] and    @xmath158    the existence of these invariants means that tree decomposable quartet distributions form a lebesgue zero set in the set of all quartet distributions for the same reason that the non - identifiable sets are a lebesgue zero set in the set of all tree decomposable distributions .",
    "invariant @xmath159 comes from the equality of the marginal distributions at the interior nodes , as proposed by @xcite .",
    "invariants @xmath160 and @xmath161 come from the equality of edge transition matrices .",
    "hence , distributions for which @xmath162 and @xmath161 vanish will uniquely identify topology @xmath139 .",
    "therefore , @xmath159 to @xmath161 are topologically informative .",
    "however , only distributions for which @xmath163 vanishes will be subject to the inferred parameters . in other words , in the set of zero points for @xmath159 to @xmath161 there is a set of distributions that returns the same set of parameters for @xmath139 , but only for one of these distributions @xmath163 vanishes",
    ". it would be interesting to investigate how this distribution relates to the set it projects from , e.g. if it is related to the possible maximum likelihood optimum .    despite the fact that @xmath159 to @xmath161 are sufficient to infer a topology",
    ", @xmath163 is also topologically informative in that it will not vanish for distributions coming from another tree .    in the case of the cfn model , all triplet covariances vanish .",
    "hence , only invariants @xmath163 and @xmath159 are of interest in that case . therefore , either invariant is sufficient to identify the associated tree topology .    the parameters for the interior edge do not add more non - identifiable cases .",
    "however , as in the tripod case , further conditions are needed to guarantee quartet identifiability .",
    "[ prop : stoch ] a quartet distribution is stochastically identifiable if and only if every triplet marginalisations satisfies both theorem [ thm : stoch ] and the following inequalities    @xmath164    all other relations are covered due to the fact that the quartet distribution @xmath28 needs to satisfy the invariants @xmath165 . the following example provides a very nice case in which reconstruction is not possible but offers a very interesting challenge .",
    "[ exa : chor ] @xcite discussed several examples of distributions with multiple maxima of the likelihood function .",
    "these examples relate to the cfn model , i.e. , @xmath166 so that the hadamard approach can be used . regard the symmetric distribution    @xmath167    retrieving the statistics yields :    @xmath168    the last equality immediately shows , that the above distribution will trivially satisfy invariants @xmath160 and @xmath161 . however , we get @xmath169 and @xmath170 , i.e. our observations do not come from the quartet tree defined by the bipartition @xmath171 . looking at the alternative invariants for @xmath159 , i.e. at    @xmath172    we see that this distribution comes from none of the available quartet trees .",
    "nevertheless , we shall have a look at the parameters .",
    "note that the symmetry of the distribution @xmath28 implies @xmath173 .",
    "looking at the numerical values for the parameters for every tripod tree we find surprising similarities :    .[tab : values]the parameters for each triplet . [ cols=\">,^,^,^,^,^\",options=\"header \" , ]     these parameters permit us to infer parameters @xmath174 and @xmath175 such that e.g. the parameters for @xmath12 on the tripod trees @xmath176 and @xmath177 can be obtained from the parameter for tripod tree @xmath178 by    @xmath179    with analogue assignments for the other leaves .",
    "these computations can be visualised by the network in fig .",
    "[ fig : network ] .",
    "the assignment of probabilities for each split permits to justify the observations for each of the four tripod trees .",
    "however , the visualisation is misleading because the factorisation of the system does not follow the edges in the network ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "assignment of mutation probability from the symmetric distribution in .",
    "the black lines indicate the triplet @xmath178 . assigned branch lengths are rounded values . ]",
    "this section investigates the connection between the work presented here and the concept of markov invariants as coined by @xcite . to show these relations we will look back at our covariances and investigate their relationship with the parameters .",
    "following @xcite one can write the three - way - probabilities as a @xmath180 tensor @xmath181 such that    @xmath182    with this as a basis we easily infer our pairwise covariances in terms of determinants of dimensional restrictions of @xmath181 . e.g. , a marginalisation over @xmath130 corresponds to @xmath183 .",
    "the determinant of this matrix then corresponds to    @xmath184    thus , we have invariably obtained an alternative way to compute the covariances . in a similar fashion ,",
    "if we take the determinant of the conditional kernels @xmath185 , we arrive at the ( not normalised ) conditional covariance @xmath186 :    @xmath187    it must be noted that the determinant has been used earlier in connection with logdet families ( e.g. , * ? ? ?",
    "in order to relate these findings to the process parameter , let us denote by @xmath188 the diagonal matrix of the marginal distribution at the root , and with    @xmath189    the transition matrix for leaf @xmath12 .",
    "then the marginalisation of equation can be written as    @xmath190    where @xmath191 is the marginal distribution at the most recent common ancestor of @xmath12 and @xmath13 .",
    "if @xmath192 is defined as the set of edges connecting the root of the tree and the most recent common ancestor of @xmath12 and @xmath13 then we compute @xmath191 by    @xmath193    if we take the determinant on both sides of eq .",
    "we get    @xmath194    we further observe that the determinant in the two - state - case is equal to    @xmath195    going back to a tripod tree under the two - state - model this yields the relation    @xmath196    this relation has been observed in @xcite and forms the basis for logdet inference .",
    "the covariances @xmath73 also form the simplest form of _ markov invariants_. @xcite define these terms in general by :    @xmath197    with @xmath198 denoting the exponent for edge @xmath199 .",
    "the term @xmath200 describes a function depicting the relationship of a reduced structure in the tree . @xcite",
    "give one example of such a reduced structure as the tree for which the pendant edges have been reduced to length zero .",
    "in the case of the tripod tree this reduced structure corresponds to the interior node @xmath7 , and hence the distribution @xmath150 is equivalent to @xmath17 only . in this",
    "setting , markov invariants are one - dimensional `` representations '' of the stochastic models used for inference , such that the complex structure of these models is retained @xcite .    in our framework , we rediscover more markov invariants of type when investigating how the remaining covariances are related to the process parameters under the tripod equations .",
    "in fact , we find :    @xmath201    with equivalent terms for the other covariances .",
    "these equivalences permit a different way to prove theorem [ thm : alg ] from the one we present in [ app : proofs ] .",
    "it should be noted that our interpretation of the above markov invariants as covariances only works for the two state model . on the other hand ,",
    "the form of the markov invariants stays valid , even though they might not be as immediately apparent from the model as in the cases discussed here .",
    "however , in the case of the two - state model using the notion of covariance permits a good interpretation of the findings .",
    "we observe for the ( not normalised ) conditional covariances    @xmath202    i.e. , the transition matrix for leaf @xmath130 shall be included into the term @xmath200 for to be valid .",
    "on the other hand , remember that we did not use these covariances to solve the tripod equations .",
    "we need them only to formulate the positivity constraints in theorem [ thm : stoch ] .",
    "this property is beyond the purely algebraic framework .    in summary ,",
    "markov invariants are very useful when investigating properties of and conditions on leaf distributions @xmath28 .",
    "especially , they explore the relationship of process parameters and leaf distribution such that phylogenetic invariants like @xmath159 to @xmath161 from proposition [ prop : algext ] can be easily extracted .",
    "we will employ these relationships to prove the results of section [ sect.tree ] .",
    "[ [ acknowledgements ] ] acknowledgements + + + + + + + + + + + + + + + +    we thank elizabeth s. allman and john a. rhodes for stimulating the finalization of the manuscript as well as for sharing their thoughts on this subject with us .",
    "further , we owe much to the discussions with david bryant , mike steel , and arndt von haeseler .",
    "suggestions from jessica leigh and three anonymous referees are greatly appreciated .",
    "26 [ 1]#1 [ 1]`#1 ` urlstyle [ 1]doi : # 1    david bryant , nicolas galtier , and marie - anne poursat .",
    "likelihood calculation in molecular phylogenetics . in olivier",
    "gascuel , editor , _ mathematics of evolution and phylogeny _ , chapter  2 , pages 3362 .",
    "oxford university press , 2005 .",
    "joseph  t. chang .",
    "full reconstruction of markov models on evolutionary trees : identifiability and consistency .",
    "_ , 137:0 5173 , 1996 .",
    "url http://dx.doi.org/10.1016/s0025-5564(96)00075-2 .",
    "paul  f. lazarsfeld and neil  w. henry .",
    "_ latent structure analysis_. houghton , mifflin , new york , 1968 .",
    "judea pearl and michael tarsi . structuring causal trees",
    ". _ j. complexity _",
    ", 2:0 6077 , 1986 .",
    "url http://dx.doi.org/10.1016/0885-064x(86)90023-3 .",
    "elizabeth  s. allman , catherine matias , and john  a. rhodes .",
    "identifiability of parameters in latent structure models with many observed variables .",
    "_ , 370 ( 6a):0 30993132 , 2009 .",
    "url http://dx.doi.org/10.1214/09-aos689 .",
    "elizabeth  s. allman and john  a. rhodes .",
    "phylogenetic ideals and varieties for the general markov model .",
    "appl . math .",
    "_ , 400 ( 2):0 127148 , 2008 .",
    "url http://dx.doi.org/10.1016/j.aam.2006.10.002 .",
    "elizabeth  s. allman and john  a. rhodes .",
    "phylogenetic invariants for the general markov model of sequence mutation .",
    "biosci . _ , 1860 ( 2):0 113144 , december 2003 .",
    "url http://dx.doi.org/10.1016/j.mbs.2003.08.004 .",
    "ellen baake .",
    "what can and what can not be inferred from pairwise sequence comparisons ? _ math .",
    "_ , 1540 ( 1):0 121 , 1998 .",
    "url http://dx.doi.org/10.1016/s0025-5564(98)10044-5 .",
    "bernd sturmfels and seth sullivant .",
    "toric ideals of phylogenetic invariants .",
    "_ j. comput .",
    "_ , 120 ( 4):0 457481 , 2005 .",
    "url http://dx.doi.org/10.1089/cmb.2005.12.457 .",
    "james  a. lake . a rate - independent technique for analysis of nucleic acid sequences : evolutionary parsimony .",
    "_ , 40 ( 2):0 167191 , 1987 .",
    "url http://mbe.oxfordjournals.org/content/4/2/167.abstract .",
    "james  a. cavender and joseph felsenstein .",
    "invariants of phylogenies in a simple case with discrete states .",
    "_ j. classif .",
    "_ , 4:0 5771 , 1987 .",
    "url http://dx.doi.org/10.1007/bf01890075 .",
    "steven n. evans and terrence p. speed .",
    "invariants of some probability models used in phylogenetic inference .",
    "_ , 210(1):0 355 - 377 , 1993 .",
    "url http://dx.doi.org/10.1214/aos/1176349030 .",
    "jeremy  g. sumner , michael  a. charleston , lars  s. jermiin , and peter  d. jarvis .",
    "markov invariants , plethysms , and phylogenetics .",
    "_ j. theor .",
    "_ , 253:0 601615 , 2008 .",
    "url http://dx.doi.org/10.1016/j.jtbi.2008.04.001 .",
    "jeremy  g. sumner , and peter  d. jarvis .",
    "markov invariants and the isotropy subgroup of a quartet tree .",
    "_ j. theor .",
    "_ , 258:0 302310 , 2009 .",
    "url http://dx.doi.org/10.1016/j.jtbi.2009.01.021 .",
    "piotr zwiernik and jim  q. smith .",
    "tree - cumulants and the identifiability of bayesian tree model .",
    "arxiv:1004.4360v1 , 2010 .",
    "url http://arxiv.org/abs/1004.4360 .",
    "frederick  a. matsen .",
    "fourier transform inequalities for phylogenetic trees .",
    "_ ieee acm t. comput .",
    "_ , 60 ( 1):0 8995 , 2009 .",
    "url http://dx.doi.org/10.1109/tcbb.2008.68 .",
    "ziheng yang .",
    "complexity of the simplest phylogenetic estimation problem .",
    "royal soc .",
    "b _ , 267:0 109116 , 2000 .",
    "url http://dx.doi.org/10.1098/rspb.2000.0974    james  a. cavender .",
    "taxonomy with confidence .",
    "_ , 40:0 271280 , 1978 .",
    "url http://dx.doi.org/10.1016/0025-5564(78)90089-5 .",
    "james  s. farris . a probability model for inferring evolutionary trees .",
    "_ , 220 ( 3):0 250256 , 1973 .",
    "url http://www.jstor.org/stable/2412305 .",
    "jerzy neyman .",
    "molecular studies of evolution : a source of novel statistical problems . in s.",
    "dasgupta and j.  yackel , editors , _ statistical decision theory and related topics _ , pages 127 . academic press , new york , 1971 .",
    "michael  d. hendy and david penny .",
    "a framework for the quantitative study of evolutionary trees .",
    "_ , 380 ( 4):0 297309 , 1989 .",
    "url http://dx.doi.org/10.2307/2992396 .",
    "lszl szekely , mike  a. steel , and peter  l. erds .",
    "fourier calculus on evolutionary trees .",
    "_ , 140 ( 2):0 200210 , 1993 .",
    "url http://dx.doi.org/10.1006/aama.1993.1011    steffen  l. lauritzen .",
    "_ graphical models_. oxford stastical science series .",
    "clarendon press , oxford , 1996 .",
    "isbn 0 - 19 - 852219 - 3 .",
    "url http://ukcatalogue.oup.com/product/9780198522195.do .",
    "j.  c.  w. rayner and eric  j. beh . towards a better understanding of correlation .",
    "_ , 630 ( 3):0 324333 , 2009 .",
    "url http://dx.doi.org/10.1111/j.1467-9574.2009.00425.x .",
    "mike a. steel .",
    "recovering a tree from the leaf colourations it generates under a markov model .",
    "_ appl . math .",
    "letter _ , 70 ( 2 ) , 1923 , 1994 .",
    "url http://dx.doi.org/10.1016/0893-9659(94)90024-8 .    charles semple and mike steel . _",
    "phylogenetics_. oxford lectures series in mathematics and its applications .",
    "oxford university press , 2003 .",
    "isbn 0 - 19 - 850942 - 1 .",
    "benny chor , michael  d hendy , barbara  r holland , and david penny . multiple maxima of likelihood in phylogenetic trees : an analytic approach . _ mol .",
    "_ , 170 ( 10):0 15291541 , 2000 .",
    "url http://mbe.oxfordjournals.org/content/17/10/1529.full .",
    "david bryant . extending tree models",
    "to splits networks . in _",
    "algebraic statistics for computational biology _ , chapter  17 , pages 320332 .",
    "cambridge university press , 2005 .",
    "a state flip replaces the probabilities at leaf @xmath12 implies a `` new '' distribution @xmath150 with @xmath203 .",
    "this has the following implications to the covariances .",
    "select one leaf @xmath209 and define @xmath210 .",
    "flipping the states in @xmath72 gives us @xmath211 for all @xmath212 by lemma [ lemma : flip ] .",
    "fix now @xmath213 .",
    "then @xmath214 , together with the root @xmath7 of the tree , define uniquely a tripod tree and the restriction of @xmath28 to @xmath214 must obey the tripod equations . using lemma [ lem :",
    "indi](2 ) , on this tripod tree shows now that @xmath215 .",
    "this implies that @xmath216 is positive , too .",
    "a triplet distribution @xmath28 for which only one covariance is zero does not satisfy lemma [ lem : indi](1 ) and hence is not tripod decomposable .",
    "further , by looking at we see that there is also no real- or complex - valued parameter set that would yield only one zero covariance .",
    "hence , such a triplet distribution would also not be algebraically decomposable .",
    "we derive the parameters from the tripod equations .",
    "as mentioned in section [ sect : statbin ] there is a linear relationship between @xmath28 and its marginalisations .",
    "thus , finding a solution for the tripod equations is equivalent to finding the solution for the following set of equations                                                                                                        we recover @xmath152 by inserting the parameters from into . to infer the invariants we first look at the equality conditions .",
    "we do this representatively by looking at @xmath251 .",
    "in particular we look at                    theorem [ thm : stoch ] covers the first part of the proposition .",
    "the remaining inequalities are obtained by bounding between 0 and 1 and use the fact that the covariances are always positive with lemma [ lem : indi](1 ) :"
  ],
  "abstract_text": [
    "<S> methods of phylogenetic inference use more and more complex models to generate trees from data . however , even simple models and their implications are not fully understood .    here , we investigate the two - state markov model on a tripod tree , inferring conditions under which a given set of observations gives rise to such a model . this type of investigation has been undertaken before by several scientists from different fields of research .    </S>",
    "<S> in contrast to other work we fully analyse the model , presenting conditions under which one can infer a model from the observation or at least get support for the tree - shaped interdependence of the leaves considered .    we also present all conditions under which the results can be extended from tripod trees to quartet trees , a step necessary to reconstruct at least a topology . apart from finding conditions under which such an extension works we discuss example cases for which such an extension does not work .    </S>",
    "<S> phylogenetics , identifiability , invariant , two - state - model </S>"
  ]
}