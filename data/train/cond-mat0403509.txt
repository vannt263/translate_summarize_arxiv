{
  "article_text": [
    "quantum monte carlo ( qmc ) methods have been successfully employed over the last decade to compute ground state electronic properties of large molecules and solids  @xcite .",
    "compared to other electronic structure approaches , qmc has the advantage that it can be applied to sufficiently large systems and still provide an accurate description of both dynamical and static electronic correlation .",
    "recently , qmc methods have also been used for the calculations of excited states  @xcite , a rather novel direction where relatively little experience exists .    in both variational monte carlo ( vmc ) and",
    "diffusion monte carlo ( dmc ) , the many - body trial wave function determines the quality of the calculation and is commonly chosen to be of the jastrow - slater type : a single- or multi - determinant wave function is multiplied by a correlation jastrow factor to partly account for dynamic electronic correlation . while the jastrow factor is generally optimized within qmc using the variance minimization method  @xcite , the determinantal component of the wave function is computed with methods such as hartree - fock , multi - configuration self consistent field ( mcscf , casscf ) or small scale configuration interaction ( ci ) , and , in most cases , is left unchanged when the jastrow factor is added .",
    "however , the jastrow factor is a positive function of the inter - particle coordinates and , therefore , does not change the nodal surface of the trial wave function . consequently , the fixed - node dmc energy is solely determined by the _ determinantal part _ of the trial wave function  @xcite .",
    "any approach aimed at improving the fixed - node dmc energy using a jastrow - slater trial wave function must therefore reoptimize the determinantal part in the presence of the jastrow factor .",
    "recently , the energy fluctuation potential ( efp ) approach to the optimization of jastrow - slater wave functions has been developed and applied to ground state calculations : the energy has been minimized with respect to a subset of the orbital parameters in single - determinant wave functions  @xcite , the ci coefficients in multi - determinant wave functions  @xcite , and the jastrow parameters in periodic systems  @xcite . in the efp method ,",
    "the optimization is performed iteratively through monte carlo sampling and the fitting of the energy fluctuations . here",
    ", we extend the efp method to the simultaneous full optimization of ci coefficients and single - particle orbitals by reformulating the optimization of the orbitals as a super - ci approach  @xcite for jastrow - slater wave function : the orbital variations are expressed as single excitations to a set of external orbitals and the improved orbitals are then obtained from the natural orbitals of this super - ci expansion . moreover , for excited states , we further develop the efp technique to treat an average of several states within the same irreducible representation of the pointgroup of the molecule . with these additions",
    ", the method closely resembles the state - averaged mcscf approach  @xcite .",
    "when one treats multiple states , the resulting jastrow - slater wave functions are however not orthogonal since orthogonality is only ensured for the determinantal parts .    to illustrate the performance of our optimization approach",
    ", we study the @xmath0 state of ethene which has been the subject of much theoretical debate and reconsideration over more than twenty years  @xcite .",
    "the difficulty in describing the @xmath0 can be mainly ascribed to the fact that any method insufficiently accounting for electron correlation will strongly mix this valence state with rydberg states .",
    "explicit inclusion of dynamic correlation in the reference wave function appears to be necessary to avoid such mixing but this renders the construction of a reference for highly correlated quantum chemical calculations particularly complicated .",
    "in addition , the result is sensitive to the choice of the basis and to the optimization of the occupied @xmath1- orbitals which can not all be treated as frozen .",
    "qmc calculations for the @xmath0 state are also affected by similar problems and , to obtain a satisfactory description of this state , we find it necessary to optimize the determinantal part of the wave function in the presence of the jastrow factor , that is to include the feedback of dynamic correlation on the determinantal reference .",
    "the rydberg character of the initial trial wave function is successfully corrected by our efp optimization , and the dmc excitation energy is lowered by about 0.5  ev upon optimization of the orbitals and brought in very good agreement with the most sophisticated quantum chemical results .",
    "our optimization approach is very efficient and robust , converging in a small number of iterations even when the initial trial wave function is worsened by making the single - particle basis more diffuse .",
    "we find that the efp optimization has superior convergence properties than the stochastic reconfiguration method  @xcite by sorella _",
    "_ finally , we consider two rydberg - like states @xmath2 and @xmath3 as examples of states which are not the lowest ones in their irreducible representations and for which we successfully employ our extension of the efp approach to the simultaneous optimization of multiple states . in a related paper  @xcite",
    ", we further investigate the state - average efp approach by studying conformational changes in formaldimine , formaldehyde and a protonated schiff - base model , and find that the optimization of excited states in the absence of symmetry constraints always works reliably .    in sec .",
    "[ sec : efp ] , we review the efp approach and introduce our method to fully optimize ci and orbital coefficients for ground and excited states . the relationship with the stochastic reconfiguration method by sorella _",
    "_ is also examined .",
    "computational details are given in sec .",
    "[ sec : comp ] and the numerical results for ethene are shown in sec .  [ sec : results ] . finally , we present our conclusions in sec .  [",
    "sec : conclusion ] .",
    "the trial wave functions commonly used in quantum monte carlo calculations are of the jastrow - slater form : @xmath4 where @xmath5 is the jastrow factor which explicitly depends on electron - electron separations and partially accounts for dynamic correlation .",
    "the @xmath6 s are a set of spin - adapted configuration state functions ( csf ) expressed as linear combinations of slater determinants : @xmath7 for a given jastrow factor , we want to minimize the energy with respect to the ci coefficients @xmath8 and the orbitals in the determinantal part of the wave function .",
    "let us assume that the determinantal component of the wave function @xmath9 ( eq .  [ wf ] ) is an eigenstate of a ci hamiltonian in the basis of the configuration state functions @xmath6 .",
    "since the configuration state functions @xmath6 and the orthonormal eigenstates @xmath10 of this hamiltonian span the same space , we can express the infinitesimal variations in the @xmath8 coefficients of @xmath9 as variations with respect to the eigenstates @xmath10 other than @xmath9 : @xmath11 where , without loss of generality , we have set @xmath9 equal to the lowest eigenstate @xmath12 .",
    "the corresponding derivatives of the energy are given by : @xmath13 where @xmath14 denotes the average with respect to the square of trial wave function , @xmath15 , which can be conveniently computed by monte carlo sampling .",
    "we defined @xmath16 and @xmath17 where @xmath18 the energy is stationary with respect to variations of the ci coefficients if these derivatives are zero . as shown in eq .",
    "[ eq : deriv ] , the fluctuations of the local energy become then uncorrelated with the fluctuations of the functions @xmath19 , which means that the remaining fluctuations of the local energy can not be further reduced by adding some combination of the functions @xmath19 .    the energy fluctuation potential ( efp ) method is based on this last observation , and reformulates the energy minimization problem as a least - squares fit of the fluctuations of the local energy with an arbitrary combination of the functions @xmath19 : @xmath20 a minimization of @xmath21 with respect to the parameters @xmath22 leads to the following set of linear equations  @xcite : @xmath23 the equation for the trial state @xmath12 is simply @xmath24 and can be used to eliminate @xmath25 from the other equations which , for @xmath26 , become : @xmath27 with @xmath28 and @xmath29 .",
    "the left - hand side of these equations correspond to the derivatives of the energy with respect to variations in the ci coefficients ( eq .  [ eq : deriv ] ) .",
    "therefore , the fitting parameters @xmath30 are all zero if and only if all the derivatives of the energy are zero  @xcite .    for an arbitrary trial wave function @xmath31 , the parameters @xmath22 which solve these linear set of equations will be different from zero . in order to understand how to use the coefficients @xmath22 to obtain a new set of ci coefficients ( or @xmath32 coefficients in eq .",
    "[ eq : delta ] ) , let us first consider the case when there is no jastrow factor and suppose that @xmath33 is the eigenstate @xmath34 of an _ incorrect _ ci hamiltonian @xmath35 : @xmath36 where the states @xmath37 are not the ci eigenstates for the given set of configuration state functions @xmath6 .",
    "the coefficients @xmath38 are easily obtained from eq .",
    "[ eq : lineq_qmc ] as @xmath39 therefore , the corrections @xmath38 correspond to off - diagonal elements of the correct ci hamiltonian coupling to the lowest state . with the use of these coefficients , a new hamiltonian @xmath40 is constructed as @xmath41 the updated hamiltonian is diagonalized , yielding a new set of states @xmath42 , and the procedure is repeated until convergence .",
    "an iterative approach is necessary because only the row and the column of the ci hamiltonian corresponding to @xmath12 are corrected at each step . at convergence ,",
    "one obtains @xmath43 and the correct ci eigenstate @xmath12 .",
    "therefore , we have devised an iterative scheme to improve on the starting wave function and perform a ci calculation for @xmath12 .    after reintroducing the jastrow factor ,",
    "we proceed motivated by the above scheme developed in the absence of the jastrow factor and by the observation that , if @xmath44 were an eigenstate of the hamiltonian @xmath45 , @xmath33 would be a right eigenstate of the operator @xmath46 with the same eigenvalue .",
    "therefore , for jastrow - slater wave functions , the efp method constructs iteratively an effective hamiltonian @xmath47 which approximates @xmath46 as far as the action on the trial state @xmath33 is concerned .",
    "one can then interpret eq .",
    "[ eq : lineq_qmc ] as obtained from a least - squares fit of the local energy of the effective hamiltonian @xmath46 acting on the determinantal part of the trial wave function @xmath48 this interpretation allows us to use the corrections @xmath22 to update the approximate effective hamiltonian @xmath47 in an iterative scheme as in the absence of the jastrow factor .",
    "the initial guess for @xmath47 is arbitrary but , if we assume that an initial ci or mcscf calculation yields a wave function not too far from the final one , we can construct a reasonable starting hamiltonian using a complete set of states @xmath49",
    "( i.e. as many states as csf ) and the associated energies @xmath50 from such a calculation .",
    "typically , the qmc trial state @xmath33 is truncated according to a threshold on the csf coefficients . since the corrections to @xmath47 are sampled from @xmath51 , where @xmath33 is assumed to be an eigenstate of @xmath47 , it is important to keep @xmath47 consistent with @xmath33 . to this end , @xmath47 is modified to yield the truncated @xmath33 as an eigenstate by setting to zero the matrix elements between the csf s included in @xmath33 and the ones omitted .    as the iterative process proceeds",
    ", the effective hamiltonian will contain more and more contributions sampled within quantum monte carlo and thus incorporate statistical noise .",
    "consequently , symmetries inherent to the true hamiltonian could by broken .",
    "this can be avoided by using symmetry adapted expansion functions instead of simple slater determinants .",
    "if molecular pointgroups are restricted to abelian groups , individual determinants of symmetry adapted orbitals are proper spatial basis functions and only spin symmetry has to be considered .",
    "recently , umezawa and tsuneyuki  @xcite proposed an optimization method for a single determinant jastrow - slater wave function based on the minimization of the quantity @xmath52 where @xmath53 . within this approach ,",
    "the derivatives of the energy with respect to the parameters in the determinant are in general not zero upon convergence .      in order to obtain more compact wave functions , it is important to optimize the orbitals comprising the slater determinants along with the coefficients in front of these determinants . within the traditional quantum chemistry framework ,",
    "this approach is known as the mcscf method , which is employed in the generation of reference wave functions for both complete - active - space second - order perturbation theory ( caspt2 ) and mrci ( multi - reference ci ) .",
    "orbital optimization can be achieved either by using lagrange multipliers , a method similar but much more involved then the scf method , or using a so - called super - ci expansion  @xcite . within the latter approach",
    ", the original reference space is augmented by all possible single excitations with respect to a set of external orbitals , leading to the super - ci wave function @xmath54 the notation @xmath55 means that in the reference csf @xmath6 an electron from the spin - orbital @xmath56 is promoted to the external spin - orbital @xmath57 . by virtue of the brillouin - levy - berthier theorem  @xcite",
    ", it can be shown that the orbitals of the reference space are optimal with respect to variations in the external space if the coefficients in front of appropriate combinations of single excitations vanish .",
    "if convergence has not been reached , the coefficients @xmath58 can be used to generate improved reference orbitals . here ,",
    "we follow ruedenberg _ et al . _",
    "@xcite in generating new orbitals via natural orbitals of the super - ci wave function .",
    "we reformulate the minimization problem of the orbitals in a jastrow - slater wave function as a super - ci approach .",
    "the resulting procedure consists of the following steps :    _ step 1_. for a given trial wave function @xmath31 , all single excitations out of the determinantal component @xmath33 are generated . in this enlarged space of csf s",
    ", the super - ci hamiltonian is set up and modified to yield @xmath33 ( and not @xmath59 ) as an eigenstate .",
    "thus , a starting effective super - ci hamiltonian @xmath60 ( eq .  [ eq : heff_0 ] ) is obtained with @xmath33 as @xmath61 .",
    "the quantities appearing in the linear equations ( eq .",
    "[ eq : lineq_qmc ] ) are then sampled in a variational monte carlo run with wave function @xmath62 , and the corrections @xmath22 are obtained and added to the original hamiltonian @xmath60 .",
    "the new effective hamiltonian @xmath63 is diagonalized to yield a new state @xmath64 .",
    "_ step 2_. the natural orbitals ( i.e.  the eigenvectors of the single particle density matrix ) are computed for the state @xmath64 .",
    "the new reference orbitals are then obtained by demanding that the natural orbitals of the new reference wave function coincide with the natural orbitals of the super - ci wave function as explained in appendix  [ sec : orbtrafo ] .",
    "_ step 3_. after the orbital update is performed , the super - ci hamiltonian needs to be recalculated in the basis given by the new orbitals . while this is of course possible in the context of usual mcscf , it is not in the case of the efp since the effective hamiltonian considered here contains contributions sampled within qmc . instead , we transform the effective hamiltonian approximately by projecting it onto a set of csf consisting of the new orbitals but having the same occupation patterns as the old csf .",
    "subsequent qmc sampling of the matrix elements of the effective hamiltonian as described above will correct this approximation .",
    "let us denote with @xmath65 , @xmath6 and @xmath66 the old orbitals , csf s , and determinants , respectively , and with a tilde the corresponding new quantities .",
    "we project the old set of csf s onto the new ones @xmath67 where the expansion coefficients are given by @xmath68 .",
    "if the reference space is complete ( casscf ) , this relation would be exact .",
    "otherwise , it leads to a projection of the new effective hamiltonian onto the new set of csf s @xmath69 .    since the csf s",
    "are linear combinations of determinants ( eq .  [ eq : csf ] ) with the same set of coefficients @xmath70 for the old and new orbitals , the expansion coefficients @xmath71 can be evaluated as @xmath72 the overlap of two slater determinants is computed as the determinant of the overlap matrix of the spin orbitals occupied in the determinants under consideration : @xmath73 where @xmath74 , with @xmath75 the i - th orbital of spin @xmath1 in the determinant .",
    "finally , the effective hamiltonian is expressed in the projected basis @xmath69 as @xmath76    to illustrate the effect of the projection , let us consider a system of two electrons and two orbitals @xmath77 where the reference determinant ( active space ) is @xmath78 , and the single excitations into @xmath79 ( external space ) yield the determinants @xmath80 and @xmath81 . with a new orbital @xmath82 , the ( projected ) matrix element of the new reference determinant @xmath83 is missing the contribution from the determinant @xmath84 which is proportional to @xmath85 and is small if @xmath86 is close to @xmath87 . in general , if the new orbitals do not significantly differ from the old ones ( i.e.  the occupation numbers of the corresponding natural orbitals are close to 0 , 1 , and 2 , respectively ) , the projection approximation is expected to be quite accurate .      even though , in the above description of the efp method , we choose the trial state @xmath62 to be the lowest state @xmath88 ,",
    "this is not a requirement .",
    "since the efp conditions lead to a state for which the energy is stationary with respect to parameter variations , arbitrary states could be optimized if a close enough starting guess is provided .",
    "however , in optimizing a higher state , one sometimes faces the so - called root flipping problem known from ci and mcscf calculations of excited states : the higher state is lowered so much in energy that it approaches ( and mixes with ) an initially lower state of the same symmetry which is not being optimized .",
    "when this happens , the procedure either converges to the lower state or , more likely , does not converge at all .    within the mcscf framework ,",
    "a well established solution to the root flipping problem is the so - called state averaged mcscf ( sa - mcscf ) method  @xcite . in sa - mcscf , the optimized quantity is the weighted average of the energies of the states under consideration : @xmath89 where the weights @xmath90 are fixed and @xmath91 .",
    "the multi - determinant wave functions @xmath92 depend on their individual sets of ci - coefficients @xmath93 but on a common set of orbitals .",
    "therefore , if the averaged energy @xmath94 is stationary with respect to all parameter variations , the individual state energies @xmath95 are stationary with respect to variations of the ci - coefficients but _ not _ with respect to variations of the orbitals . in sa - mcscf",
    ", the wave functions are kept orthogonal and a generalized variational theorem applies  @xcite .",
    "the concept of state averaging is introduced into the efp framework by considering several states @xmath96 , and associated weights @xmath90 ( @xmath97 ) instead of a single trial state @xmath62 . in the efp procedure",
    ", one needs to modify how the corrections to the effective hamiltonian are obtained and how the natural orbitals are computed .    for multiple states ,",
    "we start from a least squares problem like in eq .",
    "[ eq : chisq ] , but with the single trial function replaced by the ensemble @xmath98 , with the same jastrow factor for all states : @xmath99 where the local energy and the functions @xmath100 are defined as before but refer now to the different trial states , @xmath101 and @xmath102 denotes the average with respect to @xmath103 .",
    "since the optimization of orbitals is expressed as optimization of ci coefficients in the external space , all parameters become state - specific and the minimization of @xmath21 leads to a different set of linear equations for each state .",
    "the corrections @xmath104 from these equations are then combined with the weights @xmath90 to yield a new single approximate effective hamiltonian .",
    "after this averaged effective hamiltonian has been diagonalized , a set of natural orbitals common to all states is obtained from the averaged single particle density matrix @xmath105 as a result of this last step , the corrections @xmath104 corresponding to external excitations do not vanish upon convergence and , as in the sa - mcscf , only the averaged energy will become stationary with respect to orbital variations .    since our procedure imposes orthogonality only among the determinantal parts @xmath10 , the full wave functions @xmath92 will in general not be orthogonal due to the presence of the jastrow factor . therefore , the generalized variational theorem providing lower bounds for the excited state energies can be violated .",
    "we briefly review the so - called stochastic reconfiguration ( sr ) approach  @xcite of sorella _ et al . _ and discuss similarities and differences with the efp method .    in the sr method ,",
    "an improved state is obtained by applying the operator @xmath106 to the current trial state @xmath107 where @xmath108 is an energy shift which controls the rate of convergence .",
    "if there is a parameterized _ ansatz _ for @xmath109 with parameters @xmath110 , a linear variation with respect to all parameters can be written as @xmath111 where the quantities @xmath19 with @xmath112 are the logarithmic derivatives of @xmath109 with respect to the parameter @xmath113 @xmath114 and @xmath115 denotes a change in the parameter @xmath113 .",
    "the operator @xmath116 is the identity and the associated parameter @xmath117 corresponds to an overall scaling of the wave function .",
    "the central idea of the sr approach is to apply @xmath106 to the current trial wave function and project the result onto the space defined by the parameterization .",
    "this leads to the conditions @xmath118 after inserting eq .",
    "[ eq : ansatz ] for @xmath119 and replacing @xmath109 with @xmath62 , the following equations are obtained for @xmath120 : @xmath121 the @xmath122 equation yields the scaling @xmath123 in terms of @xmath108 : @xmath124 after substitution of @xmath108 , the equations with @xmath112 become @xmath125 which can be rewritten as @xmath126 these equations coincide , apart from the minus sign , with the working equations of the efp method ( eq .  [ eq : lineq_qmc ] ) . however , they describe different quantities : changes in the wave function ( @xmath127 ) in the sr method , and changes to the hamiltonian ( @xmath128 ) in the efp method .    to investigate the connection between the efp and the sr method ,",
    "let us suppose that the new eigenstates of the efp effective hamiltonian are not obtained through diagonalization but approximately to first order in the perturbation given by the corrections @xmath128 .",
    "then , the change of the trial state with respect to the @xmath56-th eigenstate @xmath49 of the old effective hamiltonian is given by @xmath129 while , in the sr method , the same quantity is obtained as @xmath130 where the parameter @xmath115 corresponds to a variation with respect to the eigenstate @xmath49 .",
    "therefore , the main difference between the two methods seems to be a _",
    "parameter specific scaling _ in the efp as opposed to a global one in the sr method .",
    "we found this difference to affect the convergence rate of the methods sometimes considerably , as will be shown in sec .",
    "[ sec : results ] .    as pointed out by sorella _",
    "_ , there is a relationship between the choice of the energy shift parameter @xmath108 and the amount of sampling to determine the corrections @xmath115 in each iteration .",
    "the more accurately these are sampled , the smaller one can make @xmath108 , achieving faster convergence . however , as shown in appendix [ sec : srconverg ] , a simple consideration of the convergence behavior suggests that there exists a critical @xmath131 below which convergence can not be achieved , a finding which is in agreement with our numerical results .",
    "the vertical excitations of ethene are computed using the experimental ground state geometry which is of d@xmath132 symmetry ( @xmath133 , @xmath134 and @xmath135 )  @xcite .",
    "the molecule is placed in the @xmath136- plane with the molecular axis along the @xmath137 direction .",
    "the carbon 1@xmath138 electrons are replaced by a norm - conserving @xmath138-non - local pseudopotential generated in an all - electron hartree - fock calculation for the carbon atom .",
    "the potential of the hydrogen atom is softened by removing the coulombic divergence .",
    "the gaussian basis sets are optimized for our soft pseudopotentials and augmented with polarization and diffuse functions .",
    "the calculations are performed with two different basis sets .",
    "basis ( a ) is a contracted ( 12@xmath13812@xmath1392@xmath140)/[5@xmath1385@xmath1392@xmath140 ] basis with the most diffuse exponent being 0.02 .",
    "basis ( b ) consists of basis ( a ) augmented with two more diffuse @xmath138 and @xmath139 functions with exponents 0.005 and 0.002 .",
    "the hartree - fock and casscf calculations are performed with the program gamess(us )  @xcite . in all sa - mcscf calculations ,",
    "equal weights are employed for the two states .",
    "the program package champ  @xcite is used for the quantum monte carlo calculations .",
    "different jastrow factors are used to describe the correlation with a hydrogen and a carbon atom , and their parameters are optimized within qmc using the variance minimization method  @xcite .",
    "we employ both a ` 2-body ' jastrow factor consisting of electron - electron and electron - nucleus terms , and a ` 3-body ' jastrow factor where additionally electron - electron - nucleus terms are included  @xcite .",
    "an imaginary time step of 0.075 h@xmath142 is used in the dmc calculations .",
    "singular value decomposition with a threshold of @xmath143 is used for inverting the matrix @xmath144 in eq .",
    "[ eq : lineq_qmc ] .",
    "we always find a large gap in the spectrum of this matrix so that the results are not sensitive to the precise value of the threshold .",
    "all traditional quantum chemistry as well as qmc techniques rely on the fact that their reference or trial wave function captures the essential nature of the state under consideration , whose description is then refined by including dynamic correlation .",
    "this precisely fails in the case of the valence @xmath0 state of ethene since explicit inclusion of dynamic correlation already in the reference seems necessary to avoid mixing with rydberg states .",
    "moreover , the problem worsens with increasing single - particle basis set , especially with the addition of more diffuse functions , since a simple reference wave function yields a state of even more rydberg nature .",
    "an additional complication with this state is posed by the occupied @xmath1 orbitals which respond to the @xmath145 excitation and can not be treated as frozen .",
    "although ethene seems to be a very special case , similar problems are expected to be present in many photoactive molecules , possibly in a milder but also less clear - cut way .",
    "for all these reasons , the @xmath0 state of ethene represents a very stringent test for methods which aspire to provide highly accurate excitation energies , and is therefore chosen here as an illustrative example to demonstrate the effectiveness of our efp optimization method .",
    "although the @xmath0 state of ethene is an ideal test case for sophisticated correlation methods , a down - side must be mentioned : it is very difficult to extract reliable estimates of this vertical excitation from gas phase experiments since ethene starts immediately to twist upon photoexcitation .",
    "current interpretations of the measured data seem to indicate 7.7  ev as a lower bound to the @xmath0 vertical excitation energy of ethene  @xcite .",
    "theoretical excitation energies obtained with contemporary quantum chemistry methods vary between 7.69  ev from mrci  @xcite and 8.4  ev from caspt2  @xcite .    [ cols=\"<,<,<,<,<,<,<,<,<,<,<\",options=\"header \" , ]     @xmath146 ref .",
    ", @xmath147 ref . , @xmath148 ref . , @xmath140 ref . , @xmath149 ref .",
    "in table  [ table : ethylene1 ] , we present the vmc and fixed - node dmc energies for the ground state @xmath150 and the @xmath0 state of ethene .",
    "we also list the vmc expectation value of the spread of the wave functions in the direction perpendicular to the molecular plane , @xmath151 , since this quantity has proven useful to differentiate between the valence and rydberg nature of a state .",
    "additionally , we show results for the higher singlet states @xmath152 and @xmath3 and the @xmath153 triplet state .    for the @xmath0 state ,",
    "we investigate how the qmc excitation energy varies when going from basis set ( a ) to the more diffuse basis set ( b ) , and whether our efp optimization method is able in both cases to correct the rydberg character of the starting mcscf reference used in the jastrow - slater wave function .",
    "since the @xmath0 state is expected to have a pronounced homo - lumo character , we first employ a simple two - determinant wave function , corresponding to a 2 electron in 2 orbitals casscf wave function ( denoted by cas 2 - 2 ) . to improve on possible deficiencies of this description , we also consider a 6 electron in 6 orbitals casscf wave function ( denoted by cas 6 - 6 ) where the active space consists of the orbitals @xmath154 , @xmath155 , @xmath156 , @xmath157 , and @xmath158 . since optimizing both ci coefficients and orbitals for this active space would result in more than @xmath159 csf s which is not feasible with our present implementation , we first optimize the ci coefficients with respect to a fixed set of orbitals . upon convergence ,",
    "we apply a threshold of 0.01 to the coefficients of the csf s and augment the resulting truncated ci expansion with single excitations in order to relax the orbitals . in this last step ,",
    "single excitations from core orbitals , i.e.  occupied orbitals that were not included in the cas , can be considered as well .",
    "the number of virtual orbitals for single excitations is dictated by technical limitations : while , for the cas 2 - 2 wave function , all virtual orbitals can be used , in the case of the truncated cas 6 - 6 wave function , we include the lowest 50 virtual orbitals .",
    "an illustration of the two - step procedure is given in fig .",
    "[ fig : iter1 ] : after the initial optimization of the ci coefficients , the orbitals in the reference comprised by the relevant csf s are relaxed .",
    "this two - step approach is justified by the very different role of the reference wave function in qmc compared to traditional quantum chemistry methods : a smaller number of determinants is needed in a jastrow - slater wave function since the reference does not define the available excitation space for the description of dynamical correlation as it is the case for a method like mrci .",
    "finally , we investigate the effect on the excitation energy as an increasing number of occupied orbitals are reoptimized , and the impact of using a 3-body versus a 2-body jastrow factor .",
    "the results in table  [ table : ethylene1 ] for the @xmath0 state can be summarized as follows .",
    "the initial mcscf jastrow - slater wave functions have a substantial rydberg contribution which , as expected , increases when the basis set becomes more diffuse . the spread @xmath160 in the direction perpendicular to the molecular plane increases from 37 @xmath161 with basis ( a ) to 52 @xmath161 with basis ( b ) for the cas 2 - 2 wave function .",
    "the resulting fixed - node dmc excitation energies are about 8.5  ev , thus much higher than what was found in other benchmark _ ab initio _ calculations .",
    "they roughly agree with caspt2 results which are believed to suffer from the same deficiency .",
    "optimizing the orbitals in the presence of the jastrow factor , i.e.  including the feedback of dynamic correlation on the reference , reduces the spread of the wave function to 18 - 22 @xmath161 , slightly larger than the ground state value .",
    "the dmc excitation energies are lowered by as much as 0.5 - 0.6  ev .",
    "after optimization , the results obtained with basis a and basis b are indistinguishable .    for cas 2 - 2 wave functions , the most substantial reduction in the vmc and dmc energies and in @xmath160 is obtained when the active orbitals are optimized in the presence of the jastrow factor .",
    "if @xmath1 orbitals are included in the optimization , further smaller improvements are gained at the variational level while the dmc energies remain rather insensitive . using a cas 6 - 6 wave function instead of the two - determinant wave function yields lower vmc energies but , for fixed - node dmc",
    ", the effect of the multi - configuration trial wave function is not very large .",
    "in fact , after the optimization , there remain only 10 determinants with ci coefficients above our threshold of 0.01 while , in the initial cas 6 - 6 wave function from mcscf , 36 determinants meet the same criterion . when a 3-body jastrow factor is employed , the difference between a cas 6 - 6 and a cas 2 - 2 energy becomes negligible also at the vmc level .",
    "in general , the use of a 3-body instead of a 2-body jastrow factor always gives lower vmc energies and lower excited - state dmc energies  @xcite while the dmc energies of the ground state are rather unaffected .",
    "the resulting improvement on the dmc excitation energy is visible only when a cas 2 - 2 jastrow - slater wave function is used to localize the pseudopotential  @xcite .",
    "example of the convergence of the vmc energy and the spatial extent @xmath160 of the wave function in the efp optimization of a cas 6 - 6 wave function with basis ( a ) .",
    "initially , only the ci coefficients are being optimized .",
    "after the first 10 iterations , a threshold of 0.01 is applied to the coefficients of the csf s and only single excitations on top of this truncated ci wave functions are considered to optimize all the occupied orbitals .",
    "the statistical error is smaller than the size of the symbols .",
    "see the text for more details.,width=321 ]    the reduction of the spatial extent of the trial wave function after reoptimization to values around 20 @xmath162 is in qualitative agreement with the findings of buenker _",
    "et al . _",
    "@xcite and lischka _ et al . _",
    "@xcite although we observe a considerably larger spread of the values depending on the details of the optimization . as fig .",
    "[ fig : iter1 ] illustrates , the convergence of @xmath160 with the number of steps in the efp optimization is much slower than the convergence of the energy and harder to establish .",
    "interestingly , the efp optimization appears to be sensitive to quantities other than the energy : even though the energy is practically converged , additional optimization steps yield a systematic lowering of @xmath160 .",
    "our final dmc results are summarized and compared with experiment and other theoretical studies in table  [ table : ethylene2 ] .",
    "the best estimate for the excitation energy of the @xmath0 state is @xmath163  ev , in good agreement with most other _",
    "ab initio _",
    "calculations  @xcite . however , it is higher by about 0.23  ev than the value of 7.69  ev recently obtained by lischka _",
    "_ using a sophisticated mrci approach with up to 12 electrons in 12 orbitals reference spaces .",
    "it should be noted that such mrci calculations suffer from a size - consistency problem which can be approximately corrected using a term proposed by davidson ( see e.g. ref .  ) . for the present example , the davidson correction amounts to about 0.1  ev and buenker and krebs questioned its trustworthiness  @xcite .",
    "the mrci results of buenker and krebs were partly obtained using mcscf triplet orbitals which are as compact as the ground state orbitals . following this established strategy ,",
    "recent dmc calculations also employed triplet orbitals in trial wave functions for singlet states  @xcite",
    ". however , when we use this recipe for ethene , the corresponding fixed - node dmc value is @xmath164 ev , which is comparable with the value obtained from singlet mcscf orbitals .    in the case of the @xmath2 and @xmath165 states ,",
    "we employ our state - averaged efp optimization approach because these states are not the lowest in their irreducible representation and , therefore , have to be optimized in the presence of the @xmath166 and @xmath167 states , respectively . in dmc",
    ", we rely instead on the fixed - node approximation to prevent a collapse to the lower states ( see appendix  [ sec : dmc ] ) .",
    "the efp optimization of multiple states is found to be quite stable : both vmc and dmc energies of the @xmath167 state taken from the state - averaged optimization ( denoted by sa in table  [ table : ethylene1 ] ) are in agreement with the corresponding values obtained by optimizing the lower state alone .",
    "moreover , upon optimization , the dmc excited state energies are substantially higher than those obtained using mcscf orbitals which give excitation energies lower than the experimental values by 0.33  ev for the @xmath2 and 0.48  ev for the @xmath165 state .",
    "this can possibly be understood from the fact that valence - rydberg mixing in the initial mcscf wave function raises the lower state and lowers the higher one . as in the case of the @xmath167 state , the best excitation energy for the @xmath165 state",
    "is obtained when a 3-body jastrow factor is employed , while the @xmath2 excitation is insensitive to the change from a 2-body to a 3-body jastrow factor .",
    "our final dmc excitation energies of @xmath168  ev for @xmath2 and @xmath169  ev for @xmath165 are only slightly higher than the corresponding experimental values  @xcite of @xmath170  ev and @xmath171  ev , respectively .    for the @xmath172 state we obtain an excitation energy of @xmath173",
    "ev which agrees with the recent dmc result  @xcite of el akramine _ et al . _ , the experimental value quoted in ref .",
    "@xcite and the mrci calculation of krebs and buenker  @xcite . the higher mrci value of @xmath174ev reported by gemein and peyerimhoff  @xcite seems to result from using a somewhat different geometry .",
    "convergence of the vmc energy and the spatial extent @xmath160 of the ethene @xmath167 state with the iteration number in the optimization .",
    "the efp and the sr method with two different values of the parameter @xmath108 are used to optimize the two active orbitals in a two - determinant wave function with basis ( a ) . for values of @xmath108",
    "lower than -10 a.u .",
    ", the sr optimization is unstable .",
    "the statistical error is smaller than the size of the symbols .",
    "see text for more details .",
    ", width=321 ]    finally , we examine the differences between our efp approach and the stochastic reconfiguration method by sorella _",
    "et al._. as explained in sec .",
    "[ sec : sr ] , the sr method applied to the optimization of the determinantal part of the trial wave function can be considered as a simpler variant of the efp approach that should lead to the same solution upon convergence but may have different convergence properties . in fig .",
    "[ fig : iter2 ] , the different performance of the two approaches is illustrated with the optimization of the two active orbitals in a two - determinant basis-(a ) wave function of the @xmath0 state of ethene .",
    "both calculations are performed using the same amount of monte carlo sampling per iteration . while the efp method is parameter - free , the convergence of the sr approach depends on the choice of the parameter @xmath108 .",
    "we find the optimal value of @xmath108 leading to the fastest convergence to be about @xmath175 a.u .",
    ", a value which approximately agrees with our simple estimate of the critical value @xmath131 given in appendix  [ sec : srconverg ] .",
    "values of @xmath108 higher than @xmath131 yield slower convergence as can be seen in fig .",
    "[ fig : iter2 ] . on the other hand ,",
    "decreasing @xmath108 below @xmath131 results in the divergence of the energy since the contributions of some excited states in the wave function start to be amplified instead of damped . while the efp optimization is essentially converged after about 10 iterations , the sr approach even at the optimal value of @xmath176 a.u",
    ".  takes more than 100 iterations to converge .",
    "as explained in appendix  [ sec : srconverg ] , the critical value @xmath131 is related to the energy spread inside the variational space which , in the case of orbital variations , is the space spanned by the single excitations from the reference configurations into the set of admitted virtual orbitals . for basis (",
    "a ) and a two - determinant reference , if we use all virtual orbitals of proper symmetry , this spread amounts to about @xmath177 a.u .",
    "if we reduce the energy spread by excluding high - lying virtual orbitals which are not expected to contribute significantly to the optimization , @xmath108 can be further decreased , yielding a faster convergence .",
    "however , the convergence of the sr approach is expected to become slower as the size of the system increases since the energy spread of the variational space will increase as well .",
    "we extended the energy fluctuation potential ( efp ) method to simultaneously optimize the orbitals and the ci coefficients in jastrow - slater wave functions via a super - ci approach , and to treat state - averaging for the optimization of multiple states of the same symmetry . with these additions , the method becomes a useful and effective tool to optimize trial wave functions for both ground and excited states , which can then be used in fixed - node diffusion monte carlo .",
    "as illustrative examples , we considered several vertical excitations of ethene , in particular the difficult valence @xmath167 state .",
    "for this state , the efp approach leads to strongly improved trial wave functions upon the starting rydberg - like mcscf reference , as can especially be seen from the reduced spatial spread of the optimized wave function .",
    "all results seem in reasonable agreement with experiment and other quantum chemical methods .",
    "in contrast to techniques like mrci and caspt2 , it is not necessary to use multi - configuration trial wave functions once the orbitals are optimized in the presence of the jastrow factor .",
    "also , using triplet orbitals for singlet states does not appear to be a reliable recipe for fixed - node dmc .",
    "our efp optimization of multiple states was employed for the two rydberg - like states @xmath2 and @xmath3 of ethene , which are not the lowest ones in their irreducible representations .",
    "the optimization procedure is stable and yields substantially higher dmc excited state energies than the ones obtained with mcscf orbitals , bringing the corresponding excitation energies in better agreement with the experimental values .",
    "in addition , we also compared the efp method to the stochastic reconfiguration method of sorella _ et al . _",
    "these two methods stem from quite different theoretical backgrounds but , for practical purposes , the efp approach can be regarded as a more sophisticated variant of the sr scheme . in general , the efp method shows much faster convergence than the sr approach . on the other hand ,",
    "the sr technique can be applied to the optimization of arbitrarily parameterized wave functions while the efp method is always based on a suitable factorization of the wave function .",
    "this work is part of the research programme of the stichting voor fundamenteel onderzoek der materie ( fom ) , which is financially supported by the nederlandse organisatie voor wetenschappelijk onderzoek ( nwo ) .",
    "let @xmath178 be the orthogonal transformation between the current orbitals @xmath179 and the corresponding natural orbitals @xmath180 of the reference wave function @xmath181 : @xmath182 after updating and rediagonalizing the super - ci hamiltonian ( i.e.  reference plus single excitations ) , the natural orbitals of this wave function are given by the transformation @xmath183 : @xmath184 here , @xmath185 and @xmath186 ( @xmath187 ) denote the dimensions of the reference space and the super - ci space , respectively .",
    "the new reference orbitals @xmath188 are now obtained as @xmath189 where the orthogonality of @xmath178 ( @xmath190 ) was used . upon convergence",
    ", this ensures that the natural orbitals of the reference wave function coincide with the corresponding subset of the natural orbitals of the super - ci expansion .    as the new virtual orbitals ( @xmath191 ) one can use the orbitals @xmath192 since they are orthogonal to the occupied ones .",
    "alternatively , one can obtain a new set of virtual orbitals by explicit orthogonalization of the orbitals of the previous iteration to the new occupied orbitals .",
    "it should be noted that in the case of a complete reference space ( cas ) the natural orbitals of the super - ci expansion could be used instead of the orbitals from the transformation above , since the cas wave function is invariant with respect to transformations among the active orbitals .",
    "however , subsequent truncation of the wave function ( omission of determinants with coefficients below some threshold ) could lead to slightly different results depending on the orbital transformation employed .",
    "let us suppose that the @xmath185 eigenstates of some hamiltonian @xmath45 are known @xmath193 an approximation @xmath194 to the state @xmath195 can be written as @xmath196 the variations with respect to the states @xmath197 are introduced as @xmath198 acting with the operator @xmath106 on @xmath194 yields @xmath199 therefore , after dividing by @xmath200 and equating @xmath201 with @xmath202 , we obtain that the corrections @xmath203 are given by @xmath204 here , there is no need for a projection since applying @xmath106 does not give rise to contributions outside the variational space .",
    "the method converges if @xmath205 where @xmath206 would give convergence in one step while ratios closer to @xmath207 yield slower convergence .",
    "this translates into the condition @xmath208 . at the critical value @xmath131",
    ", the contribution due to @xmath92 will be suppressed at the rate @xmath209 which becomes smaller as the energy spread in the variational subspace @xmath210 increases .",
    "in diffusion quantum monte carlo ( dmc ) , the imaginary time evolution operator is used to stochastically project a trial wave function @xmath62 onto the lowest energy state @xmath12 of the system to which @xmath62 is not orthogonal : @xmath211 for fermions , the so - called fixed - node approximation is generally introduced in order to prevent collapse to the bosonic solution : the result of the projection is constrained to have the same nodal surface as a given trial wave function @xmath62 . this is equivalent to separately solving the schrdinger equation in the regions of constant sign ( nodal pockets ) of @xmath62 subject to dirichlet boundary conditions .",
    "the nodal pockets of a ground state wave function can be shown to be equivalent , and good ground state trial wave functions seem to approximate this property well .",
    "in the same way as a trial wave function can be used within the fixed - node approximation to prevent collapse to the energetically lower bosonic state , it can also be employed for an excited state calculation to prevent collapse to lower states . if the excited state trial wave function has the exact nodes , the exact excited state energy is recovered . however , with approximate nodes , the method is not variational except for the lowest state of each one - dimensional irreducible representation of the pointgroup of the molecule  @xcite .",
    "999 w. m. c. foulkes , l. mitas , r. j. needs , and g. rajagopal , rev .",
    "mod . phys . * 73 * , 33 ( 2001 ) .",
    "j. c. grossman , m. rohlfing , l. mitas , s. g. louie , and m. l. cohen , phys .",
    "lett . * 86 * , 472 ( 2001 ) .",
    "a. r. porter , o. k. al - mushadani , m. d. towler , and r. j. needs , j. chem .",
    "* 114 * , 7795 ( 2001 ) .",
    "a. puzder , a. j. williamson , j. c. grossman , and g. galli , phys .",
    ". lett . * 88 * , 097401 ( 2002 ) ; a. j. williamson , j. c. grossman , r. q. hood , a. puzder , and g. galli , phys .",
    ". lett . * 89 * , 196803 ( 2002 ) .",
    "a. aspuru - guzik , o. el akramine , j. c. grossman , and w. a. lester , jr . ,",
    "j. chem . phys . * 120 * , 3049 ( 2004 ) . c. j. umrigar , k. g. wilson , and j. w. wilkins , phys .",
    "lett . * 60 * , 1719 ( 1988 ) .",
    "if non - local pseudopotentials are used , the trial wave function including the jastrow factor is used to localize the pseudopotential so that the dmc energy will depend on the jastrow factor . c. filippi and s. fahy , j. chem .",
    "phys . * 112 * 3523 ( 2000 ) .",
    "f. schautz and s. fahy , j. chem .",
    "phys . , * 116 * , 3533 ( 2002 ) d. prendergast , d. bevan , and s. fahy , phys",
    "b * 66 * art .",
    "155104 ( 2002 ) k. ruedenberg , l. m. cheung , and s. t. elbert , int .",
    "j. quantum chem .",
    "* 16 * 1069 ( 1997 ) .",
    "werner , and p. j. knowles , j. chem .",
    "phys . * 82 * , 5053 ( 1985 ) ; a. spielfiedel , n. g. feautrier , p. r. chambaud , and h. j. werner , chem .",
    ". lett . * 183 * , 16 ( 1991 ) ; k. docken and j. hinze , j. chem . phys . *",
    "57 * , 4928 ( 1972 ) .",
    "r. l. graham and k. f. freed , j. chem .",
    "* 96 * , 1304 ( 1992 ) .",
    "k. b. wiberg , c. m. hadad , j. b. foresman , and w. a. chupka , j. phys . chem . * 96 * , 10756 ( 1992 ) . j. b. foresman , m. head - gordon , j. a. pople , and m. j. frisch , j. phys",
    ". chem . * 96 * , 135 ( 1992 ) .",
    "l. serrano - andrs , m. merchn , i. nebot - gil , r. lindh , and b. roos , j. chem .",
    "* 98 * , 3151 ( 1993 ) . v. m. garca , r. caballol , and j. p. malrieu , chem .",
    ". lett . * 261 * , 98 ( 1996 ) .",
    "b. gemein and s. peyerimhoff , j. phys .",
    "chem . * 100 * , 19257 ( 1996 ) .",
    "s. krebs and r. j. buenker , j. chem .",
    "* 106 * , 7208 ( 1997 ) .",
    "e. r. davidson and a. a. jarzcki , chem .",
    ". lett . * 285 * , 155 ( 1998 ) .",
    "t. mller , m. dalos , and h. lischka , j. chem .",
    "phys . * 110 * , 7176 ( 1999 ) .",
    "s. grimme and m. waletzke , j. chem . phys . *",
    "111 * , 5645 ( 1999 ) .",
    "i. garca - cuesta , a. m. j. sanchez de mers , and h. koch , j. chem .",
    "phys . * 118 * , 8216 ( 2003 ) .",
    "s. sorella , phys .",
    "b * 64 * , 024512 ( 2001 ) .",
    "m. casula and s. sorella , j. chem . phys . * 119 * , 6500 ( 2003 ) .",
    "f. schautz , f. buda , and c. filippi , in preparation .",
    "an alternative could be to minimize @xmath21 directly along the lines of variance minimization .",
    "this approach would avoid to compute and to invert the covariance matrix in eq .",
    "[ eq : lineq_qmc ] .",
    "we assume that the jastrow factor does not introduce linear dependencies among the variational parameters .",
    "n. umezawa and s. tsuneyuki , j. chem .",
    "* 119 * , 10015 ( 2003 ) r. shepard , ab initio methods in quantum chemistry , part ii , advances in chemical physics * lxix * , lawley , k. p. , ed . , john wiley & sons , p. 69",
    "b. levy and g. berthier , int .",
    "j. quantum chem .",
    "* 2 * 307 ( 1968 ) .",
    "m. w. schmidt , k. k. baldridge , j. a. boatz _",
    "_ , j. comput .",
    "* 14 * , 1347 ( 1993 ) .",
    "champ is a quantum monte carlo program package written by c. umrigar and c. filippi with contributions from f. schautz ; unpublished .",
    "c. filippi and c. j. umrigar , j. chem .",
    "phys . * 105 * , 213 ( 1996 ) ; the jastrow factor is adapted to deal with pseudo - atoms .",
    "r. mcdiarmid , advances in chemical physics bf 110 , 177 ( 1999 ) .",
    "e. r. davidson , j. phys .",
    "chem . * 100 * , 6161 ( 1996 ) . o.",
    "el akramine , a. c. kollias , and w. a. lester , jr . ,",
    "j. chem . phys .",
    "* 119 * , 1483 ( 2003 ) .",
    "w. m. c. foulkes , r. q. hood , and r. j. needs , phys .",
    "b * 60 * , 4558 ( 1999 ) ."
  ],
  "abstract_text": [
    "<S> a quantum monte carlo method is presented for determining multi - determinantal jastrow - slater wave functions for which the energy is stationary with respect to the simultaneous optimization of orbitals and configuration interaction coefficients . </S>",
    "<S> the approach is within the framework of the so - called energy fluctuation potential method which minimizes the energy in an iterative fashion based on monte carlo sampling and a fitting of the local energy fluctuations . </S>",
    "<S> the optimization of the orbitals is combined with the optimization of the configuration interaction coefficients through the use of additional single excitations to a set of external orbitals . a new set of orbitals </S>",
    "<S> is then obtained from the natural orbitals of this enlarged configuration interaction expansion . </S>",
    "<S> for excited states , the approach is extended to treat the average of several states within the same irreducible representation of the pointgroup of the molecule . </S>",
    "<S> the relationship of our optimization method with the stochastic reconfiguration technique by sorella _ </S>",
    "<S> et al . _ </S>",
    "<S> is examined . </S>",
    "<S> finally , the performance of our approach is illustrated with the lowest states of ethene , in particular with the difficult case of the @xmath0 state . </S>"
  ]
}