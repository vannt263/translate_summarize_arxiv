{
  "article_text": [
    "the minimal polynomial of a @xmath0 matrix @xmath1 may be viewed as the minimal scalar generating polynomial of the linearly recurrent sequence of powers of @xmath2 .",
    "algorithm @xcite projects the matrix sequence to a scalar sequence @xmath3 ) , where @xmath4 .",
    "the vectors @xmath5 are chosen at random .",
    "the algorithm continues by computing the minimal generating polynomial of @xmath6 which , with high probability , is the minimal polynomial of @xmath1 .",
    "block wiedemann algorithms @xcite fatten @xmath7 to matrix @xmath8 having several rows and @xmath9 to a matrix @xmath10 having multiple columns , so that the projection is to a sequence of smaller matrices , @xmath11 , where , for chosen block size @xmath12 , @xmath13 are uniformly random matrices of shape @xmath14 and @xmath15 , respectively .",
    "a block berlekamp / massey algorithm is then used to compute the matrix minimal generating polynomial of b @xcite , and from it the minimal scalar generating polynomial .",
    "all of the algorithms based on these random projections rely on preservation of some properties , including at least the minimal generating polynomial . in this paper",
    "we analyze the probability of preservation of minimum polynomial under random projections for a matrix over a finite field .",
    "let @xmath16 and let * @xmath17 * denote the probability that @xmath18 for uniformly random @xmath19 and @xmath20 .",
    "@xmath17 is the focus of this paper and this notation will be used throughout .",
    "our analysis proceeds by first giving exact formulas for @xmath17 in terms of field cardinality @xmath21 , projected dimension @xmath12 , and the elementary divisors of @xmath1 .",
    "let @xmath22 , a function of field cardinality , @xmath21 , projected block size , @xmath12 , and the matrix dimension , @xmath23 .",
    "building from our formula for @xmath17 , we give a means to compute @xmath24 precisely and hence to derive a sharp lower bound .",
    "our bound is less pessimistic than earlier ones such as @xcite which primarily apply when the field is large .    even for cardinality 2",
    ", we show that a modest block size ( such as b = 22 ) assures high probability of preserving the minimal polynomial .",
    "a key observation is that when the cardinality is small the number of low degree irreducible polynomials is also small .",
    "@xcite used this observation to make a bound for probability of minimal polynomial preservation in the non - blocked algorithm . here",
    ", we have exact formulas for @xmath17 which are worst when the irreducibles in the elementary divisors of @xmath1 are as small as possible . combining that with information on the number of low degree irreducibles , we obtain a sharp lower bound for the probability of minimal polynomial preservation for arbitrary @xmath0 matrix ( when the elementary divisors are not known a priori ) .",
    "every square matrix , @xmath1 , over a finite field @xmath25 is similar over @xmath25 to its generalized jordan normal form , @xmath26 , a block diagonal direct sum of the jordan blocks of its elementary divisors , which are powers of irreducible polynomials in @xmath27 $ ] .",
    "@xmath1 and @xmath26 have the same distribution of random projections .",
    "thus we may focus attention on matrices in jordan form .",
    "after section [ defs ] on basic definitions concerning matrix structure and linear recurrent sequences , the central result , theorem [ thm : prob1 ] is the culmination of section [ sec : prob ] where probability of preserving the minimal polynomial for a matrix of given elementary divisors is analyzed .",
    "examples immediately following theorem [ thm : prob1 ] illustrate the key issues .",
    "the exact formulation of the probability of minimal polynomial preservation in terms of matrix , field , and block sizes is our main result , theorem [ thm : worst ] , in section [ sec : worst ] .",
    "it s corollaries provide some simplified bounds .",
    "section [ examplebounds ] , specifically figure [ probability_plot ] , illustrates practical applicability .",
    "we finish with concluding remarks , section [ conclusion ] .",
    "let @xmath28 be the vector space of @xmath29 matrices over @xmath25 , and @xmath30 the vector space of sequences of @xmath31 matrices over @xmath25 .",
    "for a sequence @xmath32 and polynomial @xmath33 $ ] , define @xmath34 as the sequence whose @xmath35-th term is @xmath36 .",
    "this action is a multiplicative group action of @xmath27 $ ] on @xmath30 , because @xmath37 for @xmath38 $ ] and @xmath39 for @xmath40 and @xmath41 .",
    "further , if @xmath42 we say @xmath43 _ annihilates _ @xmath44 . in this case , @xmath44 is completely determined by @xmath43 and its leading @xmath45 coefficient matrices @xmath46 .",
    "then @xmath44 is said to be _ linearly generated _ , and @xmath47 is also called a _ generator _ of @xmath44 . moreover , for given @xmath44 , the set of polynomials that generate @xmath44 is an ideal of @xmath27 $ ] .",
    "its unique monic generator is called the _ minimal generating polynomial _ , or just _ minimal polynomial _ of @xmath44 and",
    "is denoted @xmath48 . in particular , the ideal of the whole of @xmath27 $ ] is generated by 1 and , acting on sequences , generates only the zero sequence . for a square matrix @xmath1 , the minimal polynomial of the sequence @xmath49",
    "is also called the minimal polynomial of @xmath1 .",
    "@xmath50 .",
    "we will consider the natural transforms of sequences by matrix multiplication on either side .",
    "for @xmath51 @xmath52 over @xmath53 and for @xmath54 @xmath55 over @xmath56 for any polynomial @xmath57 , it follows from the definitions that @xmath58 .",
    "it is easy to see that the generators of @xmath44 also generate @xmath59 and @xmath60 , so that @xmath61 and @xmath62    more specifically , we are concerned with random projections , @xmath63 , of a square matrix @xmath1 , where @xmath13 are uniformly random , @xmath64 . by _ uniformly _ random",
    ", we mean that each of the ( finitely many ) matrices of the given shape is equally likely .",
    "[ lem : sim ] let @xmath65 be similar square matrices over @xmath66 and let @xmath12 be any block size",
    ". then @xmath67 . in particular , @xmath68 where @xmath69 is the generalized jordan form of @xmath1 .",
    "suppose @xmath1 and @xmath70 are similar , so that @xmath71 , for a nonsingular matrix @xmath72 .",
    "the @xmath73 projection of @xmath74 is the @xmath75 projection of @xmath1 .",
    "but when @xmath13 are uniformly random variables , then so are @xmath76 and @xmath77 , since the multiplications by @xmath72 and @xmath78 are bijections .",
    "thus , without loss of generality , in the rest of the paper we will restrict attention to matrices in generalized jordan normal form .",
    "we describe our notation for jordan forms next .",
    "the _ companion matrix _ of a monic polynomial @xmath79 of degree @xmath45 is @xmath80 is the _",
    "jordan block _ corresponding to @xmath81 , a @xmath82 matrix .",
    "it is standard knowledge that the minimal polynomial of @xmath83 is @xmath81 .",
    "when @xmath84 , @xmath85 .",
    "in particular , we use these basic linear algebra facts : for irreducible @xmath43 , ( 1 ) @xmath86 is zero everywhere except in the lowest leftmost block where it is a nonsingular polynomial in @xmath87 ( see , for example , @xcite ) , and ( 2 ) the krylov matrix @xmath88 is nonsingular unless @xmath89 .    generalized jordan normal forms are ( block diagonal ) direct sums of primary components , @xmath90 where the @xmath91 are distinct irreducibles and the @xmath92 are positive exponents , nonincreasing with respect to @xmath93 .",
    "every matrix is similar to a generalized jordan normal form , unique up to order of blocks .",
    "recall our definition that , for @xmath16 , * @xmath17 * denotes the probability that minimal polynomial is preserved under projection to @xmath94 , i.e. , @xmath18 for uniformly random @xmath19 and @xmath20 .",
    "for the results of this paper the characteristic of the field is not important .",
    "however the cardinality @xmath21 is a key parameter in the results . for simplicity , we are restricting to projection to square blocks .",
    "it is straightforward to adjust these formulas to the case of rectangular blocking .    by lemma [ lem : sim ]",
    ", we may assume that the given matrix is in generalized jordan form , which is a block diagonal matrix .",
    "the projections of a block diagonal matrix are sums of independent projections of the blocks . in other words , for the @xmath13 projection of @xmath95 let @xmath96 be the blocks of columns of @xmath8 and rows of @xmath10 conformal with the block sizes of the @xmath97 . then @xmath98 . in additionto",
    "this observation the particular structure of the jordan form is utilized .    in subsection [ toprimarycomp ]",
    "we show that the probability @xmath17 may be expressed in terms of @xmath99 for the primary components , @xmath100 , associated with the distinct irreducible factors of the minimal polynomial of @xmath1 .",
    "this is further reduced to the probability for a direct sum of companion matrices @xmath87 in [ todirectsum ] .",
    "finally , the probability for @xmath101 is calculated in [ adirectsum ] by reducing it to the probability that a sum of rank 1 matrices over the extension field @xmath102/\\langle f(x ) \\rangle$ ] is zero . in consequence",
    "we obtain a formula for @xmath17 in theorem [ thm : prob1 ] . examples examples illustrating theorem [ thm : prob1 ] are given in subsection [ sec : examples ] .",
    "let @xmath103 where the @xmath104 $ ] are distinct irreducible polynomials and the @xmath92 are positive exponents , nonincreasing with respect to @xmath93 . in this section , we show that @xmath105    [ lem : minpolysum ] let @xmath44 and @xmath106 be linearly generated matrix sequences .",
    "then @xmath107 .",
    "let @xmath108 , @xmath109 and @xmath110 . the lemma follows from the observation that @xmath111    as an immediate corollary we get equality when @xmath43 and @xmath57 are relatively prime .    [ cor : minpolysumrelprime ] let @xmath44 and @xmath106 be linearly generated matrix sequences with @xmath108 and @xmath109 such that @xmath112 .",
    "then @xmath113 .    by the previous lemma , @xmath114 with @xmath115 and @xmath116 .",
    "we show that @xmath117 and @xmath118 . under our assumptions , @xmath119 so that @xmath120 is a generator of @xmath106 .",
    "but if @xmath121 is a proper divisor of @xmath57 , then @xmath120 is not in the ideal generated by @xmath57 , a contradiction",
    ". similarly @xmath122 must equal @xmath43 .",
    "[ thm : minpolysum ] let @xmath103 where the @xmath91 are distinct irreducibles and the @xmath92 are positive exponents , nonincreasing with respect to @xmath93 .",
    "then , @xmath123 .",
    "let @xmath124 , and @xmath125 , where @xmath126 are blocks of @xmath13 conforming to the dimensions of the blocks of @xmath1 . then , @xmath127 .",
    "let @xmath128 . because @xmath129 and all @xmath91 are unique irreducibles , then @xmath130 when @xmath131 .",
    "therefore , by corollary [ cor : minpolysumrelprime ] , @xmath132 .",
    "therefore @xmath133 if and only if @xmath134 for all @xmath135 , and @xmath136 .",
    "next we calculate @xmath137 , where @xmath138 $ ] is an irreducible polynomial and @xmath139 are positive integers .",
    "we begin with the case of a single jordan block before moving on to the case of a direct sum of several blocks .",
    "consider the jordan block @xmath140 determined by an irreducible power , @xmath81 .",
    "@xmath141 is independent of @xmath142 .",
    "thus , @xmath143 .",
    "this fact and @xmath144 are the subject of the next lemma .",
    "[ thm : block ] given a finite field @xmath66 , an irreducible polynomial @xmath145 $ ] of degree @xmath45 , an exponent @xmath142 , and a block size @xmath12 , let @xmath146 be the jordan block of @xmath81 and let @xmath147 be the sequence @xmath148 . for @xmath149 and @xmath150 the following properties of minimal polynomials hold .    1 .",
    "if the entries of @xmath10 are uniformly random in @xmath66 , then @xmath151 note that the probability is independent of @xmath142 .",
    "2 .   if @xmath10 is fixed and the entries of @xmath8 are uniformly random in @xmath66 , then @xmath152 with equality if @xmath153 .",
    "3 .   if @xmath8 and @xmath10 are both uniformly random , then @xmath154    for parts 1 and 2 , let @xmath155 be the lower left @xmath156 block of @xmath157 .",
    "@xmath155 is nonzero and all other parts of @xmath157 are zero . note that @xmath158 $ ] , the set of polynomials in the companion matrix @xmath87 , is isomorphic to @xmath102/\\langle f \\rangle$ ] . since @xmath155 is nonzero and a polynomial in @xmath87 , it is nonsingular . since for any polynomial @xmath57 and matrix @xmath1 one has @xmath159 , the lower left blocks of the sequence @xmath160 form the sequence @xmath161 .",
    "@xmath162 is zero except in its lower @xmath45 rows which are @xmath163 , where @xmath164 is the top @xmath45 rows of @xmath10 .",
    "this sequence is nonzero with minimal polynomial @xmath43 unless @xmath165 which has probability @xmath166 .",
    "if @xmath167 the inequality is trivially true . for @xmath153 , @xmath168 is zero except in its lower left @xmath169 corner @xmath170 , where @xmath164 is the top @xmath45 rows of @xmath10 and @xmath171 is the rightmost @xmath45 columns of @xmath8 .",
    "since @xmath155 is nonsingular , @xmath172 is uniformly random and the question is reduced to the case of projecting a companion matrix .",
    "let @xmath173 for irreducible @xmath43 of degree @xmath45",
    ". for nonzero @xmath174 , @xmath175 is nonzero and has minpoly @xmath43 .",
    "we must show that if @xmath176 is nonzero then @xmath177 also has minpoly @xmath43 .",
    "let @xmath9 be a nonzero column of @xmath10 .",
    "the krylov matrix @xmath178 has as it s columns the first @xmath45 vectors of the sequence @xmath179 .",
    "since @xmath9 is nonzero , this krylov matrix is nonsingular and @xmath180 implies @xmath181 .",
    "thus , for any nonzero vector @xmath182 , we have @xmath183 so that , for nonzero @xmath8 , the sequence @xmath184 is nonzero and has minimal polynomial @xmath43 as needed . of the @xmath185 possible",
    "@xmath8 , only @xmath186 fails to preserve the minimal polynomial .",
    "part 3 . by parts 1 and 2",
    ", we have @xmath187 probability of preservation of minimum polynomial @xmath81 , first at right reduction by @xmath10 to the sequence @xmath188 and then again the same probability at the reduction by @xmath8 to block sequence @xmath189",
    ". therefore , @xmath190 .",
    "consider the primary component @xmath191 , for irreducible @xmath43 , and let @xmath192 .",
    "we reduce the question of projections preserving minimal polynomial for @xmath69 to the corresponding question for direct sums of the companion matrix @xmath87 , which is then addressed in the next section .",
    "[ lem : companion ] let @xmath193 , where @xmath138 $ ] is irreducible , and @xmath139 are positive integers .",
    "let @xmath192 .",
    "let @xmath6 be the number of @xmath139 equal to @xmath142 .",
    "then , @xmath194    the minimal polynomial of @xmath69 is @xmath81 and that of @xmath157 is @xmath43 . a projection @xmath195 preserves minimal polynomial @xmath81 if and only if @xmath196 has minimal polynomial @xmath43 . for all @xmath197 we have @xmath198",
    ", so it suffices to consider direct sums of jordan blocks for a single ( highest ) power @xmath81 .",
    "let @xmath199 be the jordan block for @xmath81 , and let @xmath200 .",
    "a projection @xmath201 is successful if it has the same minimal polynomial as @xmath1 .",
    "this is the same as saying the minimal polynomial of @xmath202 is @xmath43 .",
    "we have @xmath203 for the last expression @xmath204 is the rightmost block of @xmath205 and @xmath206 is the top block of @xmath207 .",
    "the equality follows from the observation in the proof of theorem [ thm : block ] that @xmath160 is the sequence that has @xmath208 ( @xmath155 nonsingular ) in the lower left block and zero elsewhere .",
    "thus , @xmath209 .",
    "let @xmath43 be irreducible of degree @xmath45 . to determine the probability that a block projection of @xmath210 preserves the minimal polynomial of @xmath1",
    ", we need to determine the probability that @xmath211 .",
    "we show that this is equivalent to the probability that a sum of rank one matrices over @xmath212/\\langle f(x ) \\rangle$ ] is zero and we establish a recurrence relation for this probability in corollary [ recurrence ] .",
    "this may be considered the heart of the paper .",
    "[ thm : zero_sum_prob ] let @xmath213 , where @xmath138 $ ] is irreducible of degree @xmath45 .",
    "@xmath17 is equal to the probability that @xmath214 , where @xmath215 and @xmath216 are chosen uniformly randomly , and @xmath126 are blocks of @xmath13 , respectively , conforming to the dimensions of the blocks of @xmath1 .",
    "because @xmath217 and @xmath218 , then @xmath219 .",
    "because @xmath43 is irreducible , it has just two divisors : @xmath43 and @xmath220 .",
    "the divisor 1 generates only the zero sequence .",
    "therefore , if @xmath221 then @xmath222 . otherwise , @xmath223 .",
    "thus @xmath17 equals the probability that @xmath224 .",
    "the connection between sums of sequences @xmath225 and sums of rank one matrices over the extension field @xmath226 is obtained through the observation that for column vectors @xmath5 , one has @xmath227 where @xmath228 is the regular matrix representation of @xmath226 , i.e. @xmath229 in @xmath226 .",
    "the vectors @xmath182 and @xmath9 can be interpreted as elements of @xmath226 by associating them with the polynomials @xmath230 and @xmath231 . moreover , if @xmath232 is chosen as a basis for @xmath226 over @xmath25 , then @xmath233 and @xmath234 .    letting @xmath173 ,",
    "the initial segment of @xmath235 is @xmath236 , which is @xmath237 , where @xmath238 is the krylov matrix whose columns are @xmath239 .",
    "the following lemma shows that @xmath240 and establishes the connection @xmath227 .",
    "[ thm : krillov_reg ] let @xmath43 be an irreducible polynomial and @xmath241/\\langle f \\rangle$ ] be the extension field defined by @xmath43 .",
    "let @xmath228 be the regular representation of @xmath226 and @xmath173 the companion matrix of @xmath43",
    ". then @xmath242 .",
    "let @xmath243 be the vector with a one in the @xmath93-th location and zeros elsewhere .",
    "then , abusing notation , @xmath244 and @xmath245 . since this is true for arbitrary @xmath93 the lemma",
    "is proved .",
    "let @xmath8 and @xmath10 be @xmath246 and @xmath247 matrices over @xmath25 .",
    "let @xmath248 be the @xmath135-th row of @xmath8 and @xmath249 be @xmath93-th column of @xmath10 .",
    "the sequence @xmath250 of @xmath251 matrices can be viewed as a @xmath251 matrix of sequences whose @xmath252 element is equal , by the discussion above , to @xmath253 .",
    "this matrix can be mapped to the @xmath251 matrix over @xmath226 whose @xmath252 element is the product @xmath254 .",
    "this is the outer product @xmath255 , with @xmath8 and @xmath10 viewed as a column vector over @xmath226 and a row vector over @xmath226 respectively .",
    "hence it is a rank one matrix over @xmath226 provided neither @xmath8 nor @xmath10 is zero .",
    "since any rank one matrix is an outer product , this mapping can be inverted .",
    "there is a one to one association of sequences @xmath250 with rank one matrices over @xmath226 .    to show that this mapping relates rank to the probability that the block projection @xmath256 preserves the minimum polynomial of @xmath1",
    ", we must show that if @xmath257 then the corresponding sum of @xmath258 rank one matrices over @xmath226 is the zero matrix and vice versa .",
    "this will be shown using the fact that the transpose @xmath259 is similar to @xmath260 .",
    "while it is well known that a matrix is similar to its transpose , we provide a proof in the following lemma which constructs the similarity transformation and shows that the same similarity transformation works independent of @xmath9 .",
    "[ thm : transpose ] given an irreducible monic polynomial @xmath138 $ ] of degree @xmath45 , there exists a symmetric nonsingular matrix @xmath261 such that @xmath262 , for all @xmath263 .",
    "we begin with @xmath87 .",
    "every matrix is similar to it s transpose by a symmetric transform @xcite .",
    "let @xmath261 be a similarity transform such that @xmath264 .",
    "then @xmath265 .",
    "it may be informative to have an explicit construction of such a transform @xmath261 .",
    "it can be done with hankel structure ( equality on antidiagonals ) .",
    "let @xmath266 @xmath267 denote the @xmath0 hankel matrix with first row @xmath268 @xmath269 and last row @xmath270 .",
    "for example @xmath271 then define @xmath261 as @xmath272 . a straightforward computation verifies @xmath273 .",
    "[ thm : map ] given an irreducible monic polynomial @xmath138 $ ] and it s extension field @xmath274/\\langle f(x ) \\rangle}$ ] , there exists a one - to - one , onto mapping from the @xmath94 projections of @xmath275 to @xmath276 that preserves zero sums , i.e. @xmath277 iff @xmath278 .",
    "the previous discussion shows that the mapping @xmath279 from @xmath94 projections of @xmath275 onto rank one matrices over @xmath226 is one - to - one .",
    "let @xmath280 and @xmath281 be the @xmath135-th row of @xmath282 and and the @xmath93-th column of @xmath283 , respectively .",
    "let p be a matrix , whose existence follows from lemma [ thm : transpose ] , such that @xmath284 .",
    "assume @xmath257 .",
    "then using lemma [ thm : krillov_reg ] and properties of @xmath228 @xmath285 let @xmath286 be the vector whose @xmath135-th row is @xmath287 then the corresponding sum of outer projects @xmath288 . because @xmath261 is invertible , the argument can be done in reverse , and for any zero sum of rank one matrices over @xmath226 we can construct the corresponding sum of projections equal to zero .    thus the probability that @xmath289 is the probability that randomly selected @xmath258-term outer products over @xmath226 sum to zero .",
    "the next lemma on rank one updates provides basic results leading to these probabilities .",
    "[ lem : increase_rank ] let @xmath290 be given and consider rank one updates to @xmath291 . for conformally blocked column vectors @xmath292",
    "we have that + @xmath293",
    "if and only if @xmath294 and @xmath295 are both zero , and + @xmath296 if and only if @xmath297 are both nonzero .    without loss of generality ( orthogonal change of basis ) we may restrict attention to the case that @xmath298 and @xmath299 , where @xmath139 is the @xmath135-th unit vector , @xmath300 if @xmath301 and @xmath302 otherwise , and similarly for @xmath303 vis a vis @xmath304 .",
    "suppose that in this basis @xmath305 .",
    "then @xmath306    the rank of @xmath307 is @xmath308 just in case @xmath294 @xcite . in our setting this condition",
    "is that @xmath309 .",
    "we see that , for a rank of @xmath308 , we must have that @xmath309 and @xmath310 both zero . for rank",
    "@xmath311 it is clearly necessary that both of @xmath310 are nonzero .",
    "it is also sufficient because for @xmath312 the order @xmath311 minor @xmath313 has determinant @xmath314 .",
    "these conditions translate into the statements of the lemma before the change of basis .",
    "[ ranks ] let @xmath16 be of rank @xmath315 , and let @xmath5 be uniformly random in @xmath316 .",
    "then ,    1 .   the probability that @xmath317 is @xmath318 2 .   the probability that @xmath319 is @xmath320 3 .   the probability that @xmath321 is @xmath322 with equality when @xmath323",
    "there exist nonsingular @xmath324 such that @xmath325 and @xmath326 .",
    "since @xmath327 and @xmath328 are uniformly random when @xmath5 are , we may assume without loss of generality that @xmath329 .    for part 1 , by corollary",
    "[ ranks ] , the rank of @xmath330 is less than @xmath315 only if both @xmath5 are zero in their last @xmath331 rows and @xmath332 . for @xmath333 , @xmath332 only when @xmath334 and we have , for the first @xmath135 such that @xmath335 , that @xmath336 .",
    "counting , there are @xmath337 possible @xmath182 and then @xmath338 @xmath9 s satisfying the conditions .",
    "the stated probability follows .    for part 2 , by the preceding lemma",
    ", the rank is increased only if the last @xmath331 rows of @xmath182 and @xmath9 are both nonzero .",
    "the probability of this is @xmath339 .",
    "for the part 3 inequality , if the sign is changed and 1 is added to both sides , the inequality becomes @xmath340 .",
    "note that @xmath341 and @xmath342 .",
    "let @xmath343 and @xmath344 .",
    "note that @xmath345 and @xmath12 are positive .",
    "thus , it is obvious that @xmath346 .",
    "that is , @xmath347 therefore , @xmath348 .",
    "[ def : q ] for @xmath349 uniformly random in @xmath350 , and @xmath351 , let @xmath352 denote the probability that @xmath353 .",
    "[ recurrence ] let @xmath354 , for uniformly random @xmath355 , and let @xmath356 , and @xmath357 be defined as described in corollary [ ranks ] .",
    "let @xmath358 ( definition [ def : q ] ) . then , @xmath359 satisfies the recurrence relation @xmath360 where @xmath361 ; and @xmath362 are defined as they are in corollary [ ranks ] .",
    "the general recurrence is evident from the fact that a rank one update can change the rank by at most one , and that @xmath363 .",
    "the rank of the sum of @xmath258 rank one matrices can not be greater than either @xmath258 or @xmath23 , nor less than zero .",
    "these probabilities apply as well to the preimage of our mapping ( block projections of direct sums of companion matrices ) , which leads to the next theorem .",
    "[ thm : probcompanion ] let @xmath138 $ ] be an irreducible polynomial of degree @xmath45 , and let @xmath364 .",
    "then , @xmath365 where @xmath366 ( definition [ def : q ] ) .    by lemmas [ thm : zero_sum_prob ] and [ thm : map ] , the probability that a @xmath94 projection of @xmath1 fails is precisely @xmath367 .    for the inequality , in all cases @xmath368",
    "therefore ,    @xmath369    let @xmath370 .",
    "since @xmath371 are positive integers , @xmath372 is linear with positive slope .",
    "probability @xmath367 has range [ 0,1 ] and we have @xmath373 .",
    "therefore , @xmath374 , for all @xmath375 .",
    "theorem [ thm : probcompanion ] generalizes theorem [ thm : block ] .",
    "that is , @xmath376 where @xmath138 $ ] is an irreducible polynomial of degree @xmath45 .",
    "theorem [ thm : probcompanion ] makes clear that @xmath377 is minimized when there is a single block , @xmath378 .",
    "the following theorem summarizes the exact computation of the probability that the minimal polynomial of a matrix is preserved under projection , in terms of the elementary divisor structure of the matrix .",
    "[ thm : prob1 ] let @xmath16 be similar to @xmath379 where the @xmath91 are distinct irreducibles of degree @xmath380 , and the @xmath92 are positive exponents , nonincreasing with respect to @xmath93 .",
    "let @xmath381 be the number of @xmath92 equal to @xmath382 .",
    "then , @xmath383    by lemma [ lem : sim ] , @xmath68 . by theorem [ thm : minpolysum ] , @xmath384 . by lemma [ lem : companion ] , @xmath385 . finally , by theorem [ thm : probcompanion ] , @xmath386",
    ". therefore , @xmath387 .",
    "this section uses theorem [ thm : prob1 ] to compute @xmath17 for several example matrices , and compares the probability for matrices with related but not identical invariant factor lists .",
    "@xmath388@xmath389 where @xmath390 .",
    "let @xmath47 and @xmath372 be the irreducible polynomials @xmath391 and @xmath392 in @xmath393 $ ] .",
    "let @xmath394 denote the list of invariant factors of @xmath1 ordered largest to smallest .",
    "thus ,    @xmath395    by theorem [ thm : prob1 ] ,    @xmath396    .[table : blocksize]@xmath397 vs @xmath12 [ cols=\"^,^,^,^,^\",options=\"header \" , ]     by part 3 of theorem [ thm : block ] , @xmath398 and @xmath399 . using the recurrence relation in corollary [ recurrence ] , we may compute @xmath400 and @xmath401 .",
    "table [ table : blocksize ] shows the resulting probabilities .",
    "observe that @xmath397 increases as @xmath12 increases .",
    "these five examples illustrate the effect of varying matrix structure and block size on @xmath402 . by theorem [ thm :",
    "probcompanion ] , @xmath403 and @xmath404 . by theorem [ thm : prob1 ] ,",
    "@xmath405 and @xmath406 . therefore , @xmath407 and similarly @xmath408 . finally , since @xmath409 and @xmath410 , @xmath411 and @xmath412 , for any linear @xmath413",
    "therefore , @xmath414 has the minimal probability amongst the examples and in fact has the minimal probability for any @xmath415 matrix .",
    "the worst case bound is explored further in the following section .",
    "given the probabilities determined in section  [ sec : prob ] of minimum polynomial preservation under projection , it is intuitively clear that the lowest probability of success would occur when there are many elementary divisors and the degrees of the irreducibles are as small as possible .",
    "this is true and is precisely stated in theorem [ thm : worst ] below .",
    "first we need several lemmas concerning direct sums of jordan blocks .    for @xmath16 , as before , @xmath17 denotes the probability that + @xmath18 , where @xmath19 and @xmath20 are uniformly random .",
    "[ lem : prob1 ] let @xmath43 be an irreducible polynomial over @xmath66 , let @xmath416 be a sequence of exponents for @xmath43 , and let @xmath12 be the projection block size .",
    "then @xmath417    this follows from part 3 of theorem [ thm : block ] , and theorems [ thm : probcompanion ] and [ thm : prob1 ] , since + @xmath418 .",
    "[ lem : prob2 ] let @xmath43 be an irreducible polynomial over @xmath66 of degree @xmath45 , let @xmath419 be distinct irreducible polynomials of degree @xmath45 over @xmath66 , and let @xmath12 be the projection block size .",
    "then @xmath420    this follows from theorem [ thm : minpolysum ] and part 3 of theorem [ thm : block ] , since @xmath421 and @xmath422 .",
    "[ lem : prob3 ] let @xmath122 and @xmath423 be irreducible polynomials over @xmath66 of degree @xmath424 and @xmath425 respectively and let @xmath12 be any projection block size .",
    "then , if @xmath426 , @xmath427    the follows again from part 3 of theorem [ thm : block ] since @xmath428 .    recall the definition : @xmath429 this is the worst case probability that an @xmath0 matrix has minimal polynomial preserved by uniformly random projection to a @xmath94 sequence . in view of the above lemmata , for the lowest probability of success we must look to matrices with the maximal number of elementary divisors . define @xmath430 to be the number of monic irreducible polynomials of degree @xmath431 in @xmath102 $ ] . by the well known formula of @xcite , @xmath432 where @xmath433 is the mbus function .",
    "asymptotically @xmath430 converges to @xmath434 . by definition ,",
    "@xmath435 for square free @xmath345 with @xmath35 distinct prime factors and @xmath436 otherwise .",
    "the degree of the product of all the monic irreducible polynomials of degree @xmath45 is then @xmath437 .",
    "when we want to have a maximal number of irreducible factors in a product of degree @xmath23 , we will use @xmath438 etc .",
    ", until the contribution of @xmath430 no longer fits within the degree @xmath23 .",
    "in that case we finish with as many of the degree @xmath431 irreducibles as will fit . for this purpose",
    "we adopt the notation @xmath439    [ thm : worst ] let @xmath440 be the field of cardinality @xmath21 . for the @xmath431 such that @xmath441 , @xmath442 let @xmath443 .",
    "when @xmath444 , the minimum occurs for those matrices whose elementary divisors are irreducible ( not powers thereof ) , distinct , and with degree as small as possible .",
    "when @xmath445 the minimum occurs when the elementary divisors involve exactly the same irreducibles as in the @xmath446 case , but with some elementary divisors being powers so that that the total degree is brought to @xmath23 .",
    "let @xmath16 and let @xmath447 be irreducible powers equal to the invariant factors of @xmath1 .",
    "if @xmath17 is minimal , then by lemmas [ lem : prob1],[lem : prob2],[lem : prob3 ] we can assume that the @xmath91 are distinct and have as small degrees as possible .",
    "since @xmath441 , this assumption implies that all irreducibles of degree less than @xmath431 have been exhausted .",
    "if additional polynomials of degree @xmath431 can be added to obtain an @xmath448 matrix , this will lead to the minimal probability since adding any irreducibles of higher degree will , by theorem [ thm : block ] , reduce the total probability by a lesser amount . in this case",
    "all of the exponents , @xmath139 will be equal to one .",
    "if @xmath315 is not 0 , then an @xmath448 matrix can be obtained by increasing some of the exponents , @xmath139 , without changing the probability .",
    "this , again by theorem [ thm : block ] , will lead to a smaller probability than those obtained by removing smaller degree polynomials and adding a polynomial of degree @xmath431 or higher .",
    "theorem [ thm : worst ] can be simplified using the approximations @xmath449 and @xmath450 .",
    "[ cor : worst ] for field cardinality @xmath21 , matrix dimension @xmath23 , and projection block dimension @xmath12 , @xmath451 where @xmath452 is the @xmath431-th harmonic number .",
    "@xmath453    also , for large primes , the formula of theorem [ thm : worst ] simplifies quite a bit because there are plenty of small degree irreducibles . in the next corollary",
    "we consider ( a ) the case in which there are @xmath23 linear irreducibles and ( b ) a situation in which the worst case probability will be defined by linear and quadratic irreducibles .",
    "[ cor : simp ] for field cardinality @xmath21 , matrix dimension @xmath23 , and projection block dimension @xmath12 , if @xmath454 then @xmath455 if @xmath456 then @xmath457      when @xmath458 and we are only concerned with projection on one side , the first formula of corrolary [ cor : simp ] simplifies to @xmath459 .",
    "the bound given by kaltofen and pan @xcite for the probability of @xmath460 is the first two terms of this expansion , though developed with a very different proof .    for small primes , @xcite(proposition 3 )",
    "treats the case @xmath458 and he fixes the projection on one side because he is interested in linear system solving and thus in the sequence @xmath461 , for fixed @xmath12 . for small @xmath21 ,",
    "his formula , @xmath462 , computed with some approximation , is nonetheless quite close to our exact formula .",
    "however as @xmath21 approaches @xmath23 the discrepancy with our exact formula increases . at the large / small crossover , @xmath463 , kaltofen / pan s lower",
    "bound is 0 , wiedemann s is @xmath464 , and ours is @xmath465 the kaltofen / pan probability bound improves as @xmath21 grows larger from @xmath23 .",
    "the wiedemann bound becomes more accurate as @xmath21 goes down from @xmath23 .",
    "but the area @xmath466 is of some practical importance . in integer matrix algorithms where the finite field used is a choice of the algorithm , sometimes practical considerations of efficient field arithmetic encourages the use of primes in the vicinity of @xmath23 .",
    "for instance , exact arithmetic in double precision and using blas @xcite works well with @xmath467 .",
    "sparse matrices of order @xmath23 in that range are tractable .",
    "our bound may help justify the use of such primes .",
    "but the primary value we see in our analysis here is the understanding it gives of the value of blocking , @xmath468 .",
    "figure [ probability_plot ] shows the bounds for the worst case probability that a random projection will preserve the minimal polynomial of a matrix @xmath469 for various fields and projection block sizes .",
    "it shows that the probability of finding the minimal polynomial correctly under projection converges rapidly to 1 as the projected block size increases .",
    "we have drawn a precise connection between the elementary divisors of a matrix and the probability that a random projection , as done in the ( blocked or unblocked ) wiedemann algorithms , preserves the minimal polynomial .",
    "we provide sharp formulas both for the case where the elementary divisor structure of the matrix is known ( theorem [ thm : minpolysum ] and theorem [ thm : prob1 ] ) and for the worst case ( theorem [ thm : worst ] ) . as indicated in figure [ probability_plot ] for the worst case , a blocking size of 22 assures probability of success greater than @xmath470 for all finite fields and all matrix dimensions up to @xmath471 .",
    "the probability decreases very slowly as matrix dimension grows and , in fact , further probability computations show that the one in a million bound on failure applies to blocking size 22 with much larger matrix dimensions as well . looking forward",
    ", it would be worthwhile to extend the analysis to apply to the determination of additional invariant factors .",
    "blocking is known to be useful for finding and exploiting them .",
    "for example , some rank and frobenius form algorithms are based on block wiedemann @xcite . also , we have not addressed preconditioners .",
    "the preconditioners such as diagonal , toeplitz , butterfly @xcite , either apply only for large fields or have only large field analyses .",
    "one can generally use an extension field to get the requisite cardinality , but the computational cost is high .",
    "block algorithms hold much promise here and analysis to support them over small fields will be valuable .",
    "kaltofen , e. , pan , v. , 1991 .",
    "processor efficient parallel solution of linear systems over an abstract field . in : third annual acm symposium on parallel algorithms and architectures .",
    "acm press , pp .",
    "180191 .",
    "villard , g. , 1997 .",
    "further analysis of coppersmith s block wiedemann algorithm for the solution of sparse linear systems . in : international symposium on symbolic and algebraic computation .",
    "acm press , pp . 3239 ."
  ],
  "abstract_text": [
    "<S> blackbox algorithms for linear algebra problems start with projection of the sequence of powers of a matrix to a sequence of vectors ( lanczos ) , a sequence of scalars ( wiedemann ) or a sequence of smaller matrices ( block methods ) . </S>",
    "<S> such algorithms usually depend on the minimal polynomial of the resulting sequence being that of the given matrix . here </S>",
    "<S> exact formulas are given for the probability that this occurs . </S>",
    "<S> they are based on the generalized jordan normal form ( direct sum of companion matrices of the elementary divisors ) of the matrix . </S>",
    "<S> sharp bounds follow from this for matrices of unknown elementary divisors . </S>",
    "<S> the bounds are valid for all finite field sizes and show that a small blocking factor can give high probability of success for all cardinalities and matrix dimensions . </S>"
  ]
}