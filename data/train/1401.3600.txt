{
  "article_text": [
    "although no galaxy is ever in perfect dynamical equilibrium , equilibrium dynamical models are central to the interpretation of observations of both our galaxy and external galaxies .",
    "a major reason for the importance of equilibrium models is that we can infer a galaxy s gravitational potential , and thus its dark - matter distribution , only to the extent that the galaxy is in equilibrium .",
    "moreover , equilibrium models are the simplest models and more complex configurations , involving spiral structure or an on - going minor merger for example , are best modelled as perturbations of an equilibrium model .",
    "globular clusters are the stellar systems that are most completely understood , and the theory of these systems illustrates the importance of equilibrium models : at each instant the cluster is assumed to be in dynamical equilibrium , so , by jeans theorem , its distribution function ( ) is a function of the relevant isolating integrals , such as stellar energy @xmath1 , total angular momentum @xmath2 , or angular momentum about a symmetry axis , @xmath3 . over many dynamical times",
    "encounters between stars and stellar evolution cause the  to change , but in such a way that the  continues to satisfy jeans theorem , so the cluster evolves through a series of dynamical equilibria .",
    "@xmath0-body simulations of cosmological clustering likewise yield a picture in which dark - matter haloes are far from dynamical equilibrium only during short - lived and quite rare major mergers . in general",
    "a dark - matter halo can be well approximated by a dynamical equilibrium that is mildly perturbed by accretion .    the natural way to model a dynamical equilibrium is via jeans theorem , which assures us that the system s  can be assumed to be a non - negative function of isolating integrals .",
    "since one expects a smooth time - independent gravitational potential to admit up to three functionally independent isolating integrals , jeans theorem states that we should be able to represent an equilibrium stellar system by the density of stars in a three - dimensional space of integrals rather than in full six - dimensional phase space .",
    "this reduction in dimensionality makes the system very much easier to comprehend and model .",
    "since any function of integrals is itself an integral , infinitely many different integrals may be used as arguments of the .",
    "however , the action integrals @xmath4 stand out as uniquely suited to be used as arguments of the .",
    "what makes actions special is that they can be complemented by canonically conjugate variables , the angles @xmath5 , to form a complete set of canonical phase - space coordinates .",
    "obviously the equations of motion of the actions are trivial : @xmath6 . more remarkably",
    "the equations of motion of the angles are almost as trivial : @xmath7 .",
    "thus the angle variables increase linearly in time and if we use angle - action coordinates , the unperturbed motion of stars becomes trivial .",
    "this fact makes angle - action coordinates uniquely suited to work involving perturbation theory , and indeed the angle - action coordinates of the kepler problem were invented to explore the role played by planet - planet interactions in the dynamics of the solar system .",
    "@xcite have shown that angle - action coordinates make it possible to identify stars near the sun that have been stripped from an object that was tidally disrupted gigayears ago , and even to determine the date of the disruption to good precision . @xcite and",
    "@xcite have used angle - action coordinates to identify stars near the sun that are resonantly trapped by spiral structure . @xcite",
    "have shown how angle - action coordinates for the stars of a stream enable one to constrain the gravitational potential in which the stream moves .",
    "cosmological simulations have shown that triaxial dark matter haloes are to be expected , at least up to the point at which baryons become gravitationally dominant @xcite .",
    "moreover , @xcite and @xcite present evidence that the tidal tails of the sagittarius dwarf galaxy can only be fitted if the milky way has a triaxial dark matter halo .",
    "hence we need to be able to determine angle - action coordinates for stars in triaxial potentials . in this paper",
    "we show how to evaluate the angles and actions of particles in a given triaxial potential .",
    "if the potential is axisymmetric , the actions can be evaluated using the algorithm given by @xcite .    in section  [ sec::formal ] we derive the equations that yield values of angles , frequencies and actions . in section  [ sec::eg ]",
    "we test our solutions of these equations by comparing the resulting angles , frequencies and actions for two orbits in a stckel potential with analytic values . in section  [ sec::appl ]",
    "we use the equations to explore a constant - energy surface of the action space of the triaxial potential for our galaxy that @xcite fitted to the tidal stream of the sagittarius dwarf . in section  [ sec::discuss ]",
    "we relate our work to previous work in the field , discuss a possible extension , and explore how the method copes with resonant trapping .",
    "section  [ sec::conclude ] sums up and looks to the future .",
    "angles and actions can be assigned to orbits that are `` regular '' or quasiperiodic because such an orbit is confined to a torus labelled by the actions @xcite .",
    "we will work in three dimensions so will have three actions denoted as @xmath8 .",
    "each action quantifies the magnitude of the oscillation in a suitable coordinate .",
    "the transformation from ordinary phase - space coordinates @xmath9 to angle - action coordinates @xmath10 is possible analytically in only a few cases .",
    "@xcite used one of these cases as a starting point for the numerical construction of more general transformations by `` torus mapping '' .",
    "the key point about torus mapping is that it yields orbits with specified actions rather than orbits with specified initial conditions @xmath9 . when analysing an @xmath0-body model , we require actions given an initial condition and not vice versa . here",
    "we adapt the approach of @xcite into a procedure which finds the actions , angles and frequencies given a series of phase - space coordinates @xmath11 sampled along an orbit at times @xmath12 , where @xmath13 .    with this time series",
    "we seek a generating function that will map a `` toy torus '' of a simple `` toy potential '' into the `` target torus '' to which the orbit is confined .",
    "the toy potential must have analytically tractable angles and actions and permit orbits that have the correct geometry .    in the absence of figure rotation ,",
    "a general triaxial potential admits two basic classes of non - resonant orbit : loop orbits and box orbits @xcite .",
    "loop orbits have a definite sense of rotation either around the long- or short - axis of the potential , whilst a box orbit has no sense of rotation and can reach down to the centre of the potential .",
    "hence the class of an orbit can be determined by inspection of components of the angular momentum along the orbit : if all components of the angular momentum change sign , the orbit has no sense of circulation and is a box orbit ; when a component of the angular momentum retains its sign , the orbit is a loop orbit around the corresponding axis @xcite . for each class of orbit we use a toy potential that provides tori with the same geometrical structure as the tori of the given orbit class .    for a box orbit",
    "the actions @xmath14 , @xmath15 and @xmath16 quantify the oscillation in the @xmath17 , @xmath18 and @xmath19 directions , respectively . for loop orbits",
    ", @xmath14 quantifies oscillation in a generalized radial coordinate . for a short - axis loop",
    "@xmath15 quantifies the particle s circulation around the short axis , whilst @xmath16 quantifies oscillation parallel to this axis . for a long - axis loop orbit",
    ", @xmath16 quantifies circulation around the long axis , whilst @xmath15 quantifies oscillation parallel to this axis .",
    "we choose this definition such that our actions match @xmath20 , @xmath21 and @xmath22 for a stckel potential @xcite , and each class of orbit occupies a distinct region of action space ( see section  [ sec::appl ] ) .        for box orbits we use the potential of the triaxial harmonic oscillator , @xmath23 which has three parameters , @xmath24 .",
    "here we have chosen the principal axes of the potential to lie along the cartesian @xmath25 directions on the assumption that the time series has already been rotated into the coordinate system that is aligned with the principal axes of the true potential .",
    "the actions and angles in this potential are given by @xmath26      for loop orbits we use the isochrone potential , @xmath27 where @xmath28 is the spherical radius .",
    "this potential has two free parameters : the mass @xmath29 and the scale radius , @xmath30 .",
    "the expressions for the actions and angles in this potential are more involved than for the harmonic oscillator so are not repeated here .",
    "readers can consult @xcite for the appropriate equations .",
    "the three actions in the isochrone potential are given by the radial action @xmath31 , the @xmath19-component of the angular momentum @xmath3 and the vertical action @xmath32 , where @xmath2 is the total angular momentum . with this choice",
    "we must orient our coordinate system , such that the orbit circulates around the @xmath19-axis , before finding the actions .",
    "one might also include the offset of the centre of the potential from the coordinate centre as a free parameter , but we shall not do so here , presuming instead that the time samples @xmath33 have already been adjusted to be relative to one s best estimate of the centre of the true potential .",
    "once a class of potential has been chosen , we set the parameters of the potential by minimizing @xcite @xmath34 where the sum is over the times , @xmath35 is the value of the toy hamiltonian at @xmath11 , and @xmath36 is the mean of these values .",
    "the minimization of @xmath37 is done using the levenberg ",
    "marquardt algorithm @xcite .",
    "the experiments described below suggest that this method for selecting the parameters is sub - optimal in that it leads to a rather centrally concentrated toy potential being selected .",
    "this central concentration then leads to high - order fourier components being required in the generating function .",
    "however , our attempts to find a better procedure for selecting the toy potential have not met with success .      with",
    "a toy potential chosen , we construct the generating function to transform between the angle - actions @xmath10 of the toy potential , and those @xmath38 of the target potential . the generating function for this transformation , @xmath39 , can be written @xmath40 where the vector @xmath41 has integer components .",
    "the first term on the right generates the identity transformation , whilst the structure of the second part is required by the periodicity of the angle variables .",
    "@xcite show that if the hamiltonian is time - reversible , the reality of the generating function requires the @xmath42 to satisfy @xmath43 for this condition to be satisfied there must exist a point on the toy torus at which @xmath44  in appendix  [ appendix::symmetries ] we demonstrate that this is true for the toy potentials of the previous section . with this constraint",
    ", the generating function can be written as @xmath45 where the integer vectors @xmath41 are now restricted to just half of a three - dimensional lattice .",
    "we take this half to be the set @xmath46 , where either @xmath47 , @xmath48 or @xmath49 .",
    "symmetries of the target potential require some of the @xmath42 to be zero .",
    "this is discussed further in appendix  [ appendix::symmetries ] .    from the generating function ( [ eq : gfn ] )",
    "we find that the toy actions are @xmath50 and the target angles are @xmath51 note that by the choice of our generating function , the target angle zero - point coincides with the toy - angle zero - point .    given the choice of a toy hamiltonian , we may find the toy actions and angles @xmath52 at each time .",
    "each time then produces a separate equation   with common unknowns : the target actions and the fourier components of the generating function , @xmath42 .",
    "we can not solve these equations exactly because we are dealing with equations in an infinite number of unknowns .",
    "because we can include only a finite number of terms on the right - hand side of each equation , the right - hand sides should not agree exactly with the left - hand sides , and the correct procedure is to minimize the sum of the squares of the residuals of individual equations .",
    "this sum is @xmath53 where the inner sum is over the dimension of the action space and the set @xmath54 is limited to a finite number of vectors @xmath41 .",
    "we take this set to be the @xmath0 vectors that satisfy the condition @xmath55 , where @xmath56 .",
    "we minimize @xmath1 by setting to zero its derivatives with respect to the unknowns : @xmath57    to solve these equations we define a matrix @xmath58 that has as subscripts the vector @xmath41 and the integer @xmath59 that selects a particular spatial dimension .",
    "this @xmath0-by-@xmath60 matrix is @xmath61 we further define two @xmath62-vectors @xmath63 and the symmetric matrix @xmath64 here @xmath65 is the 3-by-3 identity matrix . with these definitions , the equations ( [ eq : basicj ] ) to be solved",
    "can be written as @xmath66 we solve these equations for @xmath67 by lu decomposition @xcite .    a similar procedure yields the target angles from equation  .",
    "we note that at time @xmath12 the orbit has @xmath68 where @xmath69 is the target frequency , and @xmath70 is the angle corresponding to the initial point in the orbit integration .",
    "the relevant sum of squared residuals is @xmath71 the unknowns now are @xmath70 , @xmath69 and the set of @xmath72 .",
    "the requirement of vanishing partial derivatives of @xmath73 with respect to the unknowns yields the matrix equation , @xmath74 these symbols are defined in appendix  [ appendix::angles ] .",
    "the toy angles will be @xmath75-periodic , and we require the same for the target angles @xmath76 .",
    "however , in order to solve the matrix equation we must first make the @xmath77 from the orbit integration continuously increase , and then we solve for the target angles and take the @xmath75-modulus .      given the scheme presented above , the only questions that remain are how to select the orbit integration time @xmath80 , the number of time samples , @xmath78 , to use , and what value to use for @xmath79 , which determines the number @xmath0 of fourier components we solve for . here",
    "we discuss how we can automatically choose these parameters such that we have good recovery of the unknowns .",
    "a necessary condition is that the number of unknowns must be less than the number of time samples , @xmath78 . for the action calculation",
    "the number of unknowns is approximately @xmath81 , whilst for the angle - frequency calculation we have @xmath82 unknowns .",
    "we also expect our ability to recover the unknowns to depend upon the sampling of the toy angle space .",
    "let us first consider an idealised 1d case . if we were able to sample uniformly in the toy angle of a 1d system , we would select @xmath78 points in a single period separated in toy angle by @xmath83 . with this sampling rate",
    "we would be able to constrain all modes @xmath84 with @xmath85 .",
    "we can choose to constrain only the @xmath79 modes with @xmath86 as then we would be super - sampling the highest considered modes .",
    "here we are using a time series that is a product of an orbit integration so is not uniformly spaced in toy angles  the toy - angle distribution depends on the target hamiltonian , the toy potential and the distribution of sampling times .",
    "the recovery of fourier components from non - uniform samples is discussed in @xcite . to constrain modes from a 1d non - uniform sampling we must sample on average at or above the nyquist frequency .",
    "if we have toy - angle samples @xmath5 we require @xmath87 to constrain mode @xmath88 .    here",
    "we are attempting to recover components from samples , @xmath89 , in 3d toy - angle space . as we are restricted to using samples generated from an orbit integration",
    ", our sampling is limited to some sub - space of the full 3d toy - angle space .",
    "the 3d sampling can be considered as a series of 1d samples in @xmath90 ( we first unroll the angles such that they increase continuously ) . in order to recover the @xmath42 from this toy - angle sampling we need to satisfy two conditions :    1 .   as in the 1d case",
    "we need to sample on average at or above the nyquist frequency such that @xmath91 2 .   for every included mode , @xmath41",
    ", we would also like a good total coverage in @xmath92 .",
    "we choose to require that the @xmath92 samples cover the full range from @xmath93 to @xmath75 : @xmath94 if this condition is not satisfied , we are including a mode which will not be well constrained by the toy - angle sampling i.e. the average of @xmath95 will not be near zero .",
    "we therefore expect that the corresponding @xmath42 will not be well recovered from this sampling . it could be that this @xmath42 is not significant so will not affect the recovered actions and frequencies significantly .",
    "however , a conservative approach would ensure that equation   is satisfied for all included modes .",
    "the second of these conditions is the stricter . to ensure that the toy - angle sampling satisfies equation   when an orbit is near - resonant",
    ", we require time samples which span a very large number of periods .",
    "this is an inevitable drawback of the approach taken here because we have very little control over the sampling in the toy angle space .",
    "having identified a mode which will not be well constrained , one possibility is to set @xmath96 for this mode .",
    "however , by doing this , we risk throwing out a mode which is significant , and the recovery of the actions and frequencies will deteriorate so we opt not to do this .",
    "another requirement is that the @xmath42 ( and @xmath97 ) decrease as we go to larger @xmath41 such that the truncation at @xmath79 is valid . if the @xmath42 do not decrease with @xmath41 , this is evidence of aliasing such that these higher @xmath41 modes are not well recovered and we expect the actions",
    ", angles and frequencies will also not be well recovered .",
    "we will now summarize the above discussion into a procedure that can be implemented :    * we first select a reasonable @xmath79 , for instance @xmath98 is used in the later examples .",
    "* we then integrate for some time @xmath80 recording at least @xmath99 time samples ( or @xmath100 if we only need the actions ) such that we have as many equations as unknowns .",
    "this is always satisfied if we choose @xmath101 * for each time sample we find the toy angles and check that equations   and   are satisfied for each mode . if equation   is not satisfied , @xmath80 is much longer than the fundamental orbital periods and so we require a finer time sampling from the orbit integration . if equation   is not satisfied then we continue integrating the orbit until this equation _ is _ satisfied for all the modes . * we then perform the procedure outlined in section  [ sec::generatingfn ] to find the @xmath42 .",
    "we require the @xmath42 to be decreasing with @xmath41 such that on the boundaries the values of the @xmath42 are small .",
    "if we find that the boundary values of @xmath42 are large , we have not included a sufficient number of modes in the generating function so we must increase @xmath79 and repeat the above procedure until we are satisfied that all dominant modes are included .    as we will see below this procedure",
    "is very conservative but should ensure that the recovery of the actions , angles , frequencies and components of the generating function are accurate .",
    "as a test of the above , let us look at an example .",
    "the most general separable triaxial potential is the triaxial stckel potential @xcite .",
    "we choose to work with the perfect ellipsoid , which has density profile @xmath102 where @xmath103 the associated coordinates are confocal ellipsoidal coordinates in which the actions can be expressed as one - dimensional integrals .",
    "these may be calculated numerically using gauss - legendre quadrature .",
    "similarly the frequencies can also be determined from one - dimensional integrals .",
    "equations for these quantities are given in @xcite .",
    "here we work with the potential with parameters @xmath104 @xmath105 @xmath106 and @xmath107 .    in this potential",
    "we examine two orbits  a short - axis loop orbit with initial condition @xmath108 , @xmath109 and a box orbit with initial condition @xmath110 , @xmath111 .",
    "each orbit was integrated for eight times the longest period , @xmath112 .",
    "we set @xmath113 and calculated the corresponding number of uniformly - spaced time samples required from equation  .",
    "we ensured that equations   and   were satisfied for all the included modes . in figs  [ loop ] and  [ box ]",
    "we show the orbits in the @xmath114 and @xmath115 planes , the sampling of the toy - angle space and the resultant actions .",
    "we also show , in faint red , the result of integrating in the best - fitting toy potential .",
    "this gives us an idea of the work that the generating function has to do to deform the toy torus into the target torus .",
    "@xmath116{fig1.pdf}\\ ] ]    @xmath117{fig2.pdf}\\ ] ]    for the loop orbit the true and recovered actions are @xmath118 and the true and recovered frequencies are @xmath119    @xmath120{fig3.pdf}\\ ] ]    @xmath121{fig4.pdf}\\ ] ]    in fig .",
    "[ loop_planes ] we show two cross - sections of @xmath41-space showing the absolute value of the components of the generating function .",
    "( for the isochrone potential we use the convention that subscript 1 refers to @xmath31 , subscript 2 refers to @xmath3 and subscript 3 refers to @xmath32 . )",
    "we see that the two most significant modes are @xmath122 , which causes a mixing between the radial motion and azimuthal motion , and @xmath123 .",
    "note that the @xmath42 decrease towards the boundary so we are content that we have included the relevant modes .    for the box orbit the true and recovered actions are @xmath124 and the true and recovered frequencies are @xmath125    in fig .",
    "[ box_planes ] we show two cross - sections of @xmath41-space showing the absolute value of the components of the generating function .",
    "the two most significant modes are @xmath126 , which causes a mixing between the @xmath17 motion and the @xmath18 motion , and @xmath127 , which mixes the @xmath17 and @xmath19 motions .",
    "these modes are required to distort the rectangular orbits of the triaxial harmonic oscillator into those bounded by surfaces of constant confocal ellipsoidal coordinate .",
    "note that the @xmath42 decrease towards the boundaries as required .",
    "also the structure of fig .  [ loop_planes ] is much richer than that of fig .",
    "[ box_planes ] , signalling that the generating function has many more significant terms .      fig .",
    "[ accuracy ] shows errors in @xmath128 and @xmath129 for the box orbit as a function of @xmath79 for various choices of the total integration time @xmath80 .",
    "we have linked @xmath79 to @xmath78 via equation  .",
    "however we have not ensured that equations   and   are satisfied for each case .",
    "the weight of the points is proportional to the largest gap in coverage for the @xmath0 modes .",
    "we see that in general a longer integration time provides a more accurate estimate of the action and particularly the frequency",
    ". we can understand this as a longer line segment provides a better measurement of the gradient for noisy data . from fig .",
    "[ accuracy ] we see that when working with high @xmath79 it is not sufficient to satisfy equation  .",
    "we must also satisfy equation   such that we have a sufficient sampling in toy - angle space to constrain these higher modes .    for @xmath130 equation",
    "is not satisfied for @xmath131 . for large @xmath79 and @xmath130 many modes",
    "have insufficient coverage and the results are very poor . for the other three integration times equation   is not satisfied for @xmath132 . for @xmath133",
    "this results in an immediate deterioration of the frequency recovery as we have included a mode with @xmath134 . for @xmath135 and @xmath136",
    "a lack of coverage has not affected the results apart from for @xmath135 and @xmath137 where the frequency recovery is poorer .",
    "the mode which is not well covered is also not well covered for @xmath138 but we only see the effects of this lack of coverage when we try to include more modes . for @xmath136 both",
    "the action and frequency recovery are very good despite equation   not being satisfied when @xmath139 .",
    "in particular there is one mode for which @xmath140 .",
    "it seems that this coverage is sufficient to not degrade the results . in conclusion , when equation   is satisfied we recover the frequencies and actions well , whilst when it is not satisfied the recovery deteriorates in some cases , particularly that of the frequency .",
    "finally , we find that when we double the number of time samples used for the examples shown in fig .",
    "[ accuracy ] the results change significantly only when equation   is not satisfied .",
    "therefore , we conclude that provided we have more equations than unknowns and have satisfied equations   and   the actions and frequency recovery will be satisfactory .",
    "@xmath141{fig5.pdf}\\ ] ]      to illustrate some of the points discussed we show results for a near - resonant orbit .",
    "this orbit is a box orbit with the initial conditions @xmath142 , @xmath143 .",
    "again we integrate for time @xmath135 and set @xmath98 .",
    "the results are shown in fig .",
    "the frequency vector of this orbit is nearly parallel to @xmath144 so the coverage of this mode is very poor and @xmath145 for @xmath144 .",
    "however , the true and recovered actions are @xmath146 and the true and recovered frequencies are @xmath147 as seen before , poor coverage in one of the modes is not detrimental to the action and frequency recovery .",
    "@xmath116{fig6.pdf}\\ ] ]",
    "as a brief application of the method outlined in this paper we will inspect the action diagram for a realistic triaxial galactic potential .",
    "we take the potential from @xcite .",
    "this potential was found to produce the best fit to the sagittarius stream data .",
    "this potential has three components : a disc defined by the miyamoto - nagai potential @xmath148 with @xmath149 , @xmath150 and @xmath151 ; a spherical bulge described by the hernquist profile @xmath152 with @xmath153 and @xmath154 ; and the triaxial logarithmic halo @xmath155 with @xmath156 , @xmath157 , @xmath158 , @xmath159 , @xmath160 and @xmath161 .",
    "we inspect a single orbit in this potential in fig .",
    "[ lmpot_test ] .",
    "the chosen orbit is a short - axis loop orbit with initial condition @xmath162 , @xmath163 .",
    "we use different , but overlapping , @xmath164 long segments of the orbit with @xmath165 to calculate the actions , angles and frequencies using @xmath113 .",
    "we ensure equation   is satisfied for these time samplings .",
    "this orbit lies in the surface of constant energy explored in the next section .",
    "we find that the action and frequency are @xmath166 the error in the actions and frequencies can be estimated by the spread of the estimates from each segment .",
    "we find @xmath167 for each orbit segment we find @xmath70 and these different values should all lie along straight lines with gradients given by the derived frequencies . in fig .",
    "[ lmpot_test ] we show that the condition is well satisfied .",
    "using different orbit segments is perhaps the only way to estimate the error in an action or frequency found using the present method .",
    "it is simplest to use consecutive orbit segments as we have here .",
    "however , a better method is to use orbit segments separated by a large time interval .",
    "this can be achieved most effectively by utilizing the estimated generating function to find an initial condition for a second orbit integration .",
    "a simple choice is to increase one of the derived angle coordinates by @xmath168 .",
    "now we turn to constructing the action diagram for the chosen potential . for a given energy ( that of a particle dropped at @xmath169 on the intermediate axis ) we launched particles at a series of points linearly spaced between @xmath170 and @xmath169 along the potential s intermediate axis with the velocity vector perpendicular to the axis and inclined at linearly spaced angles to the @xmath19-axis between @xmath93 and @xmath168-axis .",
    "however , at small radii ( @xmath171 ) the intermediate axis of the full potential is in the @xmath114 plane due to the disc contribution , and the @xmath19-axis is the short axis . ] .",
    "we integrated each initial condition for @xmath172 saving @xmath173 samples .",
    "for all orbits the energy was conserved to one part in @xmath174 .",
    "we set @xmath98 and ensured that equations   and   were satisfied .",
    "if equation   was not satisfied , we had undersampled the orbit , so we took a finer sampling .",
    "if equation   was not satisfied we did not have sufficient coverage , so we continued integrating for another @xmath175 , taking another @xmath176 samples .",
    "we then calculated the actions from the time series .",
    "[ lmpot ] shows each orbit as a point in 3d action - space , by a factor of @xmath177 .",
    "@xmath14 for a loop orbit corresponds to a single oscillation from minimum to maximum coordinate and back , whilst for a box orbit a single oscillation covers the interval @xmath93 to maximum coordinate four times . ] .",
    "we see that the surface of constant energy is a triangle - shaped plane in action - space .",
    "the points are coloured based on their orbit classification . an equivalent figure for a stckel potential",
    "can be found in @xcite .    in a triaxial potential ,",
    "the loop orbits can be divided into two classes : the short - axis loops that loop around the short axis ( in our case the @xmath19-axis ) and the long - axis loops that loop around the long axis ( the @xmath17-axis ) . along with",
    "the box orbits these three classes of orbit occupy distinct regions on the action - space plane of constant energy . at each corner of the plane",
    "only one action is non - zero and the corresponding orbit is the parent orbit of each of the three classes : the @xmath178 orbit is a radial orbit along the long axis , the @xmath179 orbit is a closed orbit in the @xmath114 plane and the @xmath180 orbit is a closed orbit in the @xmath181 plane .",
    "we note that near the interface between the different orbit classes some regions of the plane are depleted of points ( our choice of initial sampling causes an increased density of points near the edges of the plane ) .",
    "also there is some overlap between the different orbit classes in the action space .",
    "these features are due to the presence of resonant islands with surrounding chaotic orbits at the interface of the regular orbit regions ( see section  [ sec::chaos ] ) . for orbits near the box / loop boundary it can take many orbital periods to correctly identify the orbit class @xcite , and some may be misclassified .",
    "@xmath182{fig7.pdf}\\ ] ]    @xmath183{fig8.pdf}\\ ] ]",
    "the problem addressed here goes back to @xcite , who fourier transformed the time series @xmath184 of individual coordinates and assigned to each line in the resulting spectrum appropriate integers @xmath185 so that @xmath186 could be identified with @xmath187 .",
    "once this identification had been successfully accomplished , @xmath188 could be replaced with @xmath189 to yield the orbit s angle representation .",
    "this approach is inferior to that introduced here in several respects : ( i ) whereas the generating function is a scalar , a star s location is described by a vector , so it is wasteful to construct the angle representations of all three coordinates rather than the angle representation of the generating function : @xcite failed to take advantage of the strong restrictions on tori that arise from angle - action coordinates being canonical .",
    "( ii ) it is not straightforward to measure correctly the complex amplitudes @xmath190 from the discrete fourier transform of a time series such as @xmath184 because the required amplitude will in general not lie at one of the discrete frequencies sampled .",
    "( iii ) when an orbit is near - resonant there is often dangerous ambiguity in the integers @xmath185 that should be assigned to a particular line . with the present technique we work from the outset with periodic functions and their fourier series",
    "so the issue of how frequencies fall on a discrete grid does not arise .",
    "moreover , the assignment of integers @xmath185 to fourier terms is unambiguous .",
    "the method described here has significant overlap with the work of @xcite on the construction of magnetic coordinates and the related method of @xcite for the construction of angle coordinates . in both these studies angle - action variables",
    "were evaluated along numerically computed orbits .",
    "the coordinates evaluated were not those of a toy potential but of a trial torus that had been previously constructed : @xcite was refining the fourier coefficients @xmath42 while @xcite were solving for the @xmath191 given the @xmath42 . in both these studies ,",
    "several initial conditions for orbit integration were chosen on each torus to overcome the problem that with a single short integration a resonant orbit yields a highly non - uniform distribution of sample points on the torus . since we do not have a good representation of the target torus until the equations have been set up and solved",
    ", we can not take advantage of this possibility .",
    "@xcite solved for the discrete fourier transforms of the @xmath192 rather than for the @xmath42 because the matrix that then has to be inverted is nearly diagonal when the toy and target tori are close to one another and the sample points provide a nearly regular grid in the space of toy angles .",
    "since our toy and target tori can be quite different , and it is hard to achieve a uniform sampling of toy - angle space , we have not used warnock s technique .",
    "we have used completely different toy potentials for each class of orbit , and it is natural to ask whether it would not be advantageous to use always a stckel potential since such a potential has tori of every type .",
    "we have not pursued this option for two reasons .",
    "first , the actions and angles of stckel potentials require the evaluation of integrals whereas the potentials we have used yield algebraic expressions for angles and actions . secondly , and more fundamentally ,",
    "when integrating an orbit that lies close to the box / loop interface , it would be non - trivial to ensure that the toy torus with the actions of the target orbit had the same geometry as the target torus . by using potentials that support only one type of torus ,",
    "we are assured from the outset that this condition is satisfied . however , this rests on our correct identification of the orbit type from the time series .",
    "as we saw with the @xcite potential , in some marginal cases it may take many orbital periods to correctly identify the orbit .",
    "we have focused here on orbits that are non - resonant members of the major orbital families . in real galactic potentials",
    "one encounters orbits that are either resonantly trapped or chaotic ( e.g.   3.7 * ? ? ?",
    "chaotic orbits can be thought of as sequences of sections of resonantly trapped orbits , so these two types of orbit raise similar issues .    in a generic integrable potential , the frequencies @xmath193",
    "depend on the actions , so on some tori a resonant condition @xmath194 is satisfied .",
    "consequently , individual orbits on these resonant tori do not cover the entire torus since the condition @xmath195 constrains the angle variables .",
    "this lack of coverage makes it impossible to determine some of the fourier coefficients @xmath42 .",
    "when the potential is strictly integrable , orbits on tori that are adjacent to a resonant torus completely cover their tori although they take a long time to do so . in a generic potential , however , such orbits move over a series of tori without covering any of them , as they librate around the strictly resonant orbit .",
    "consequently , these orbits have some of the characteristics of a strictly resonant torus .",
    "when the present technique is used on a resonantly trapped orbit , the generating function will map the toy torus into a close approximation to the strictly resonant torus , so in an @xmath0-body model the density of stars on this torus will seem to be larger than it really is .",
    "hence with the present technique , resonantly trapped orbits will give rise to apparent crowding in action space that is analogous to the signature of resonances when particles are mapped into frequency space by determining orbital frequencies by fourier decomposition of coordinates @xcite : when the ratios @xmath196 and @xmath197 are used to place orbits in frequency - ratio space , the existence of resonantly trapped orbits leads to a crowding of points along the straight lines associated with certain resonance conditions @xmath195 ( * ? ? ?",
    "* ( b ) ) .",
    "chaotic orbits can be considered as moving through a series of quasi - periodic orbits .",
    "therefore the recovered actions and frequencies from our method will be a function of the total integration time .",
    "we see that the region of the constant energy surface occupied by the box orbits in fig .",
    "[ lmpot ] has considerable crowding and the regular grid of initial conditions is not visible .",
    "this is indicative of chaotic orbits which have been allocated very different actions from one initial condition to the next .    in fig .",
    "[ binneytremainef ] we perform the same procedure as outlined in ",
    "3.7.3(b ) of @xcite to inspect the ratio of frequencies plane of a logarithmic potential .",
    "we use the potential @xmath198 with @xmath199 , @xmath200 and @xmath201 .",
    "we drop a series of test particles on the surface @xmath202 regularly spaced in the spherical polar coordinates @xmath203 and @xmath204 , and integrate each initial condition for a time @xmath205 extracting @xmath206 samples .",
    "we then use our method to find the corresponding orbital frequencies and plot their ratio in fig .",
    "[ binneytremainef ] .",
    "as noted in @xcite the top - right corner of this plane shows the regular spacing of the initial conditions whilst the lower - left corner shows a more irregular distribution with no evidence of the regular grid of initial conditions used to produce it .",
    "also , we find that there are overdensities along lines corresponding to resonances .",
    "our plot is very similar to that shown in @xcite .",
    "however , the structure of the irregular bottom - left region differs .",
    "this is to be expected as it is these orbits which are irregular , and how one assigns regular properties to them depends on the method employed .",
    "@xmath207{fig9.pdf}\\ ] ]",
    "we have presented a method for finding actions , frequencies and angles from numerically integrated orbits in a general potential .",
    "the method relies on estimating the fourier components of the generating function that maps a toy torus into the torus on which the computed orbit lies by solving systems of linear algebraic equations .",
    "this method enables one to determine the angle - action coordinates @xmath10 of a given phase - space point @xmath9 .",
    "it has numerous possible applications in astronomy .",
    "ours is the first method presented in the literature for finding the actions in a general triaxial potential .",
    "triaxiality is an essential ingredient of dark - matter distributions , and a realistic galactic model which should include non - axisymmetric features such as the bar , and the potentially triaxial halo .",
    "this method is a necessary first step towards constructing distribution functions , @xmath208 , for these more complex galactic components .",
    "an important application is to the analysis of @xmath0-body simulations .",
    "a single @xmath0-body snapshot consists of 3d positions and velocities for @xmath209 particles . letting the simulation evolve for a few time steps produces another snapshot with a completely different set of @xmath210 positions and velocities .",
    "thus the particles phase - space coordinates constitute a highly degenerate and non - compact representation of the simulation .",
    "effective analysis of the simulation should start by condensing the coordinates into a smaller set of numbers .",
    "this can be done by replacing the @xmath211 numbers @xmath11 with just three numbers @xmath4 and plotting each particle as a point in 3d action space .",
    "the simulation then becomes a density of particles in a 3d space .",
    "this representation will greatly facilitate the comparison of different @xmath0-body models .",
    "also it may prove possible to find good fits to the star density in terms of analytic functions , as @xcite have done for numerical dark - matter haloes and appears to be possible for the galactic discs @xcite .",
    "we hope to report on an application of this method to an @xmath0-body simulation soon .",
    "it should be noted that it is not advisable to take the @xmath78 time samples of a given orbit directly from the simulation . rather at some time",
    "@xmath212 the potential should be computed on a spatial grid ( e.g. * ? ? ?",
    "* ) , and the equations of motion in this potential should be integrated for @xmath78 timesteps starting from the phase - space location of each particle at time @xmath212 .",
    "these integrations in a fixed potential lend themselves to massive parallelization , for example on a graphical processor unit ( gpu ) so it should be possible to compute angle - action coordinates for very large numbers of particles .    here",
    "we discussed time - reversible triaxial potentials . in this case",
    "we can determine a priori the phases of the terms in the generating function .",
    "rotation of the figure of the potential destroys the time - reversibility of the hamiltonian and we lose the ability to set the phases a priori . in the worst case ,",
    "the @xmath42 in equation ( [ eq : gengf ] ) become complex numbers that are only limited by the condition @xmath213 required to make the generating function real . extending the current framework to this case",
    "@xmath214 doubles the dimensionality of the matrices we must solve for given @xmath79 .",
    "js acknowledges the support of stfc .",
    "jb was supported by stfc by grants r22138/ga001 and st / k00106x/1 .",
    "the research leading to these results has received funding from the european research council under the european union s seventh framework programme ( fp7/2007 - 2013 ) / erc grant agreement no .",
    "in section [ sec::generatingfn ] we asserted that for a time - reversible hamiltonian the fourier components of the generating function , @xmath42 , are real .",
    "however , it must also be true that there is a point on the target torus where @xmath44 .",
    "@xcite show that this is true if the toy potential is an isochrone and the target hamiltonian is axisymmetric",
    ". additionally they demonstrated that when the potential is symmetric about the plane @xmath215 , fourier components of the generating function with odd @xmath216 vanish .",
    "here we repeat these arguments extended to the 3d triaxial case .",
    "let us first consider the loop orbits .",
    "suppose we have a target hamiltonian of the form @xmath217 where @xmath218 are standard spherical polar coordinates .",
    "the equations of motion for the toy actions are @xmath219 now let us consider the point @xmath220 : at this point the particle is at pericentre , at a maximum in its vertical oscillation and at @xmath221 .",
    "therefore at this point we have that @xmath222 so @xmath223 in a triaxial potential with its axes aligned with the coordinate axes , @xmath224 is a symmetry plane of the potential so @xmath225 and @xmath226 .",
    "this is the requirement introduced in section  [ sec::generatingfn ] for the fourier components of the generating function to be real .",
    "now let us consider the point @xmath227 . here",
    "the particle is at pericentre , crossing the @xmath215 plane , and at @xmath221 . at this point",
    "we have @xmath228 so @xmath229 as we saw before the first term is zero as @xmath224 is a symmetry plane of the potential .",
    "the second term is also zero as @xmath215 is also a symmetry plane . by a similar argument at @xmath230 , @xmath231 as @xmath232",
    "is a symmetry plane of the potential .",
    "we calculate @xmath233 from equation   as @xmath234 at the point @xmath220 we know @xmath44 so we require @xmath235 so @xmath236 must be even .",
    "similarly we know @xmath44 at @xmath230 so @xmath237 is restricted to even values .",
    "however , @xmath238 can take any integer value .",
    "now let us consider the box orbits .",
    "we have a target hamiltonian of the form @xmath239 where @xmath240 and the equations of motion for the toy actions are @xmath241 consider the point @xmath227 . here",
    "the orbit is turning in all three coordinates so @xmath242 and @xmath243 so @xmath44 as required in section  [ sec::generatingfn ] .",
    "now let us consider the point @xmath244 . here",
    "the orbit is turning in @xmath18 and @xmath19 and is passing through the @xmath224 plane at which point @xmath245 as @xmath246 is at a maximum .",
    "therefore we have @xmath247 for a triaxial potential aligned with our choice of cartesian axes @xmath224 is a symmetry plane so @xmath248",
    ". therefore @xmath44 here and by similar arguments to the loop orbit case we are restricted to even @xmath238 .",
    "we can employ the same arguments by considering the stationary points @xmath230 and @xmath220 to show that @xmath237 and @xmath236 must be even .",
    "to find the angles and frequencies from an orbit timeseries we must minimize equation   with respect to the unknowns .",
    "the unknowns are @xmath70 , @xmath69 and the set of @xmath72 , which we denote as @xmath249 . for each time",
    "we define the @xmath0-vector @xmath250 we also define the @xmath251-vectors @xmath252 @xmath253 and the symmetric matrix @xmath254 where each @xmath255 is an @xmath0-by-@xmath60 matrix with the @xmath0-vector @xmath256 in the @xmath257th column , and each @xmath256 is evaluated at the @xmath258th time . setting the partial derivatives of @xmath73 with respect to the unknowns to zero yields the matrix equation , @xmath74"
  ],
  "abstract_text": [
    "<S> we present a method for extracting actions , angles and frequencies from an orbit s time series . </S>",
    "<S> the method recovers the generating function that maps an analytic phase - space torus to the torus to which the orbit is confined by simultaneously solving the constraints provided by each time step . </S>",
    "<S> we test the method by recovering the actions and frequencies of tori in a triaxial stckel potential , and use it to investigate the structure of orbits in a triaxial potential that has been fitted to our galaxy s sagittarius stream . </S>",
    "<S> the method promises to be useful for analysing @xmath0-body simulations . </S>",
    "<S> it also takes a step towards constructing distribution functions for the triaxial components of our galaxy , such as the bar and dark halo .    </S>",
    "<S> = 1    methods : numerical  galaxy : kinematics and dynamics  galaxies : kinematics and dynamics </S>"
  ]
}