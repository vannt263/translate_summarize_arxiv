{
  "article_text": [
    "star formation histories , as described by the temporal evolution of the star formation rate , @xmath0 , and the cumulative numbers of stars formed are the crucial astronomical parameters needed to constrain cosmological models , galaxy formation scenarios , galactic evolution models and star formation theories in general . in practice ,",
    "uncertainties in the theories of stellar formation and evolution , as well as degeneracy in a stars observational parameters between age and metallicity , not to mention observational errors and unknown distance and reddening corrections , make inferring @xmath0 for distant systems difficult . actually , even assuming a known stellar initial mass function ( @xmath1 ) and metallicity , a given set of isochrones and no distance or reddening corrections , recovering the @xmath0 which gave rise to a given hr diagram is not trivial .",
    "it is this restricted form of the general problem which we attempt to improve on in this paper .",
    "the increasing feasibility of studies which resolve the stellar populations of nearby systems has made possible quantitative investigation of the @xmath0 in these systems through comparison of the observed hr diagram with synthetic ones e.g. chiosi et al .",
    "( 1989 ) , aparicio et al .",
    "( 1990 ) and mould et al .",
    "( 1997 ) using magellanic and local clusters , and mighell & butcher ( 1992 ) , smecker - hane et al .",
    "( 1994 ) , tolstoy ( 1995 ) , aparicio & gallart ( 1995 ) and mighell ( 1997 ) using dsph companions to the milky way .",
    "the framework within which this problem is generally faced is to construct a statistical estimator of how closely a synthetic hr diagram constructed from an assumed @xmath0 resembles the observed one , and then to select the @xmath0 , from amongst a set of plausible ones , which maximizes the value of this estimator ( e.g. tolstoy & saha 1996 ) .",
    "the most rigorous estimator is probably the likelihood , as defined through bayes s theorem . in practice",
    "this states that one should look for the model which maximizes the probability of the observed data set having arisen from it . in comparing two or more candidate models through",
    "the likelihood one takes into account the position of each star in the observed hr diagram , there being no necessity to smooth the data into a continuous distribution , or to include only specific features of the hr diagram , such that all the available information contributes to the comparison",
    ". the robustness of the approach is undermined by the degree of subjectivity associated with defining the set of plausible models one is going to consider .",
    "further , as none of the statistical estimators has an absolute normalization , in the end one is left with that model , of the ones one started by proposing , which best reproduces the data , which might not necessarily be a `` good '' approximation to the true @xmath0 .",
    "the likelihood of the data having arisen from a particular model can only be calculated if one has the data , the errors , and the particular model fully specified .",
    "this last condition has led to the almost exclusive use of parametric @xmath0 s .",
    "this last point is not necessarily negative , in the case of globular clusters both theoretical calculations showing the binding energy of the gas in the clusters to be insufficient to retain the gas against the disruption of the first sn s and the observed thin , clearly defined isochrones in the hr diagrams imply that globular clusters consist of approximately coeval stellar populations . in this case , the @xmath0 can accurately be parameterized as a short lived burst . given a normalization condition through the total number of stars , the problem is reduced to finding the age of the burst i.e. , a 1d parameter space is defined , which includes all plausible @xmath0 . the likelihood is then evaluated over all the parameter space , and the value of the parameter for which the maximum occurs selected",
    ". however , in most other stellar systems , one expects a more complex @xmath0 , where a particular parameterization will sometimes appear to reject a particular astrophysical model and favour another . if it is the precise form of the @xmath0 which might serve as a constraint on a theory ( e.g. a collection of randomly located bursts as fragments accrete or a more uniform function as gas cools , for the build up of the galaxy ) , one must consider the most general @xmath0 .",
    "the less one assumes _ a priori _ about the @xmath0 one is solving for , the more objective the inference will be .    a first attempt at solving for @xmath0 non parametrically is to break the star formation history into a series of bursts , and to solve for the amplitude of each one e.g. dolphin ( 1997 ) . other variants of this approach are possible , for example hurley - keller et al .",
    "( 1998 ) who parameterize the @xmath0 of the carina dwarf as consisting of 3 bursts , and solve for the positions , durations and amplitudes of each . in principle , as the number of bursts considered tends to infinity , the full @xmath0 is recovered .",
    "the difficulty in increasing the number of bursts considerably lies in that each extra burst increases the _ dimension _ of the parameter space by at least one . as the likelihood hyper - surface will in general be quite complex , the only reliable way of finding the absolute maximum is to evaluate the likelihood function over the entire parameter space .",
    "this last procedure is clearly not a practical approach , as calculating the likelihood of a complete set of thousands of observed stars for even one single model is a lengthy procedure , let alone throughout a 100 or more dimensional space .",
    "further , methods which consider a large parameter space often do not use a full likelihood analysis , but simpler statistical estimators such as luminosity functions ( aparicio & gallart 1995 , mighell 1997 ) . in this last approach",
    "the hr diagram is divided into cells and the numbers of stars in each used as independent variables to construct a statistical estimator .",
    "the resulting statistic is not strictly rigorous as the numbers of stars in different cells are in fact correlated through the underlying imf and @xmath0 .",
    "presently , methods of comparing simulated hr diagrams with observations can be classified according to the statistical criterion used in the comparison",
    ". a few examples of the variety in these categories are tolstoy ( 1995 ) and mould et al .",
    "( 1997 ) who use full maximum likelihood statistics , dolphin ( 1997 ) and ng ( 1998 ) who use chi - squared statistics , and aparicio et al .",
    "( 1997 ) and hurley - keller et al .",
    "( 1998 ) who break the hr diagrams into luminosity functions before constructing the statistical estimator .",
    "in this paper we present a variational calculus method of solving directly for the maximum likelihood @xmath0 , which does not require any assumptions on the function one is trying to recover , or to evaluate the likelihood of any of the @xmath0 s being considered ( all continuous functions of time ) .",
    "we construct an integro - differential equation which is iterated to find a @xmath0 which yields a vanishing first variation for the likelihood . at each iteration",
    "the @xmath0 is solved with an arbitrary time resolution .",
    "conveniently , computation times scale only linearly with this time resolution .",
    "this allows a very fine reconstruction of the @xmath0 , which would be prohibitively expensive in a parametric decomposition of the @xmath0 .",
    "the layout of our paper is as follows : in section 2 we present the method , which we test in section 3 using a variety of synthetic hr diagrams . in section 4",
    "we explore how errors in the assumed metallicity , imf and binary fraction modify our results , and section 5 contains our conclusions .",
    "as stated in the introduction , our goal is to recover the star formation history which gave rise to an observed population of stars , described by @xmath0 , the star formation rate as a function of time .",
    "as we want our method to be of a very general applicability , we shall assume absolutely nothing about the @xmath0 we are trying to recover , beyond that it be a continuous function of time .",
    "it is important not to impose any _ a priori _ parameterization on @xmath0 , since it is precisely the form of this function that we are trying to recover from the data , @xmath0 will be fixed entirely by the data .",
    "one obvious constraint will be the total number of stars produced , which furnishes a normalization condition on @xmath0 , over the range of masses over which stars can be observed .",
    "obtaining the faint end slope of the initial mass function is an entirely different problem which we shall not address . here",
    "we will be concerned only with that fraction of the total star formation which produced stars still readily visible today .",
    "it is this that we are calling the @xmath0 .",
    "the final observed hr diagrams are the result of the star formation histories in those systems , but also of the relevant initial mass function , the metallicity and the stellar evolutionary processes .",
    "we shall assume all these other physical ingredients are actually known .",
    "this is not an unreasonable assumption , since there are many interesting astrophysical systems for which this essentially holds , and for which only the star formation history is poorly known .",
    "examples of such systems are some of the dwarf spheroidal companions to our galaxy , for which independent measurements of the metallicity confirm that this parameter is consistently low throughout ( e.g. da costa 1994 ) .",
    "further , we are only interested in the stars which end up in the observations , which basically leaves us with a mass region over which the initial mass function is well established . theoretical studies of stellar isochrones have advanced significantly over the last decade , and now there seems to be little uncertainty in the physical properties of stars over the mass range 0.6 - 3 solar masses , during all but the shortest lived periods .",
    "here we are using the latest padova isochrones ( fagotto et al .",
    "1994 , girardi et al .",
    "1996 ) , including most stages of stellar evolution up to the rgb phase .",
    "our inference will depend on the precise details of the isochrones we use , but our aim here is not to insist upon any particular age calibration , but basically to show the merits of the method being presented .",
    "future papers apply the method to real data .      having a fixed set of observations @xmath2 , which we are assuming resulted from a model which belongs to a certain known set of models",
    "@xmath3 we want to find the model which has the highest probability of resulting in the observed data set , @xmath4 .",
    "that is , we wish to identify the model which maximizes @xmath5 , the joint probability of @xmath4 occurring for a given model @xmath6 . from the definition of conditional probabilities ,",
    "@xmath7    where @xmath8 is the conditional probability of observing a given a fixed model @xmath6 occurred , @xmath9 is the conditional probability of model @xmath6 given the observed data @xmath4 , and @xmath10 are the independent probabilities of @xmath4 and @xmath6 , respectively .",
    "further , if the @xmath11s are exclusive and exhaustive ,    @xmath12    where @xmath13 is a constant , so that equation  ( 1 ) becomes :    @xmath14    which is bayes theorem .",
    "@xmath15 is called the _ prior _ distribution , and defines what is known about model @xmath6 without any knowledge of the data .",
    "as we want to maximize the relevance of the data in our inference , we can take the hypothesis of equal prior probabilities , finding the maximum likelihood model under this assumption is hence simplified to finding the model @xmath6 for which @xmath8 is maximized .",
    "our set of models from which the optimum @xmath0 is to be chosen includes all continuous , twice differentiable functions of time such that the total number of stars formed does not conflict with the observed hr diagram .    in order to find the @xmath0 which maximizes the probability of the observed hr diagram resulting from it",
    ", we first have to introduce a statistical model to calculate the probability of the data resulting from a given @xmath0 .",
    "take one particular star , having an observed luminosity and colour , @xmath16 , and an intrinsic luminosity and colour @xmath17 , which will usually differ due to observational errors , where the index @xmath18 distinguishes between the @xmath19 observed stars making up the hr diagram .",
    "the probability of this observed point being a star belonging to a particular isochrone @xmath20 , i.e. , being part of the stars formed by @xmath21 will be given by :    @xmath22 ^ 2 \\over { 2 \\sigma^2(l_i ) } \\right)\\ ] ]    in equation  ( 4 ) @xmath23 denotes the observational error in the measurement of the colour of the @xmath24 observed star , which is a function of the luminosity of this star , and which we are assuming follows a gaussian distribution .",
    "in real data , the errors in the luminosity are much smaller than in the colour determination , which comes from subtracting two observed quantities . for simplicity ,",
    "we only consider errors in the colour , which increase with decreasing luminosity , in a way determined by the particular observation . in this case",
    "@xmath25 which we adopt throughout , the generalization to an error ellipsoid being trivial .",
    "@xmath26 is the colour the observed star having luminosity @xmath27 would have if it had actually formed at @xmath28 .",
    "@xmath29 is the density of stars along the isochrone @xmath20 around the luminosity of the observed star , @xmath27 , for an isochrone containing a unit total mass of stars .",
    "therefore , for stars in their main sequence phase , @xmath30 is actually the initial mass function expressed in terms of the luminosity of the stars .",
    "further along the isochrone it contains the initial mass function convolved with the appropriate evolutionary track .",
    "finally , @xmath21 indicates the total mass of stars contained in the isochrone in question , and is the only quantity in equation  ( 4 ) which we ignore , given an observational hr diagram , an initial mass function and a continuous set of isochrones .",
    "the probability of the observed point @xmath16 being the result of a full given @xmath0 will therefore be :    @xmath31    where @xmath32 ^ 2 \\over { 2 \\sigma^2(l_i ) } \\right)\\ ] ]    where @xmath33 and @xmath34 are a maximum and a minimum time needed to be considered , for example 0 and 15 gyr .",
    "we shall refer to @xmath35 as the likelihood matrix . at this point",
    "we introduce the hypothesis that the @xmath19 different observed points making up the total hr diagram are independent events , to construct :    @xmath36    which is the probability that the full observed hr diagram resulted from a given @xmath0 .",
    "this first part is essentially well known , and we have presented it as it was laid out in tolstoy & saha ( 1996 ) , who use equation ( 6 ) to compare between different set proposed @xmath37 .    the remainder of the development is entirely new .",
    "we shall use equation ( 6 ) to construct the euler equation of the problem , and hence obtain an integro - differential equation directly for the maximum likelihood @xmath0 , about which we shall assume nothing _ a priori_. it is the functional @xmath38 which we want to maximize with respect to @xmath0 to find the maximum likelihood star formation history .",
    "the condition that @xmath39 has an extremal can be written as @xmath40 and the techniques of variational calculus brought to bear on the problem .",
    "firstly , we develop the product over @xmath41 using the chain rule for the variational derivative , and divide the resulting sum by @xmath42 to obtain :    @xmath43    in order to construct an integro - differential equation for @xmath0 we introduce the new variable @xmath44 defined as :    @xmath45    introducing the above expression into equation  ( 7 ) and developing the euler equation yields ,    @xmath46    where @xmath47    we have thus constructed an integro - differential equation whose solution yields a @xmath0 for which the likelihood has a vanishing first variation .",
    "this in effect has transformed the problem from one of searching for a function which maximizes a product of integrals ( equation 6 ) to one of solving an integro - differential equation ( equation 8) .",
    "solving equation  ( 8) will be the main problem , as this would yield the required star formation history directly , without having to calculate @xmath42 explicitly over the whole space containing all the possible @xmath48 .",
    "we now implement an iterative scheme for solving equation(8 ) , the details of which are given in the appendix . given the complexity of the isochrones , the initial mass function and the unknown star formation histories we are trying to recover , it is not possible to prove convergence analytically for the implemented iterative method .",
    "we shall show experimentally in the following section that the method works remarkably well for a wide range of synthetic hr diagrams produced from known @xmath0 s , independent of the initialization used .",
    "* figure 1 . *    in order to see whether the iterative method outlined in the appendix converges , and if so , whether it does so to the correct @xmath0 , we shall perform a variety of tests using synthetic hr diagrams produced from known @xmath0 s . to produce a realistic hr diagram from a proposed @xmath0",
    "requires firstly a method of obtaining the colour and luminosity of a star of a given mass and age .",
    "interpolating between isochrones is a risky procedure which can imprint spurious structure in the inference procedure , given the almost discontinuous way that stars properties vary across critical points along the isochrones , and how these critical points vary with time and metallicity . to avoid this we use the latest padova ( fagotto et al .",
    "1994 , girardi et al .",
    "1996 ) full stellar tracks , calculated at fine variable time intervals , and a careful interpolating method which uses only stars at constant evolutionary phases to construct an isochrone library .",
    "we calculate 100 isochrones containing 1000 uniformly spaced masses each , with a linear spacing between 0.1 and 15 gyr , which determines the time resolution with which we implement the method to be 150 myr .",
    "an arbitrary time resolution can be achieved using a finer isochrone grid , which only increases the calculation times linearly with the number of intervals .",
    "unless otherwise stated , we shall be assuming a metallicity of @xmath49_{\\odot}=-1.7 $ ] , which is in the range of the spectroscopically derived values for the dsph s ( grebel 1997 ) .",
    "although in comparison with real data it is important to use colours and magnitudes , trying to make these first tests as clean as possible , we perform them on the theoretical hr diagram , in terms only of temperature ( t ) and luminosity ( l ) .",
    "units throughout are @xmath50 , degrees @xmath51 and @xmath52 .    having fixed the isochrones , we now need to specify the manner in which the density of stars will vary along these isochrones , i.e. an imf .",
    "we use the imf derived by kroupa et al .",
    "( 1993 ) , where a single fit to this function is seen to hold for stars towards both galactic poles , and for all stars in the solar neighborhood . in analyzing the stellar distribution towards the galactic poles , a wide range of metallicities and ages is sampled , and care was taken to account for all the effects this introduces , including the changing mass - luminosity relation at different ages and metallicities , completeness effects as a function of luminosity and distance , and the contribution of binaries . at this point",
    "we shall assume their result to be of universal validity , and use their fit :    @xmath53        m^{-2.2 } &   0.5m_{\\odot } < m\\le 1.0 m_{\\odot } \\\\[1.0 ex ]       m^{-2.7 } &   1.0m_{\\odot } < m \\end{array}\\right.\\ ] ]    we normalize this relation such that a unit total mass is contained upwards of @xmath54 , although only stars in the mass range @xmath55 can end up in the hr diagram .",
    "we can now choose a @xmath0 , and use the imf of equation  ( 9 ) to populate our isochrones and create a synthetic hr diagram , after including `` observational '' errors , assumed as gaussian on log(t ) .",
    "the dispersion is assumed to depend only on @xmath56 , and as an illustrative example we will use :    @xmath57^{1.5 } } \\ ] ]      as a first test we use a @xmath0 consisting of two gaussian bursts at different epochs , of different amplitudes and total masses .",
    "this @xmath0 is shown by the dashed line in the right panel of figure(1 ) , where the time axis shows the age of the corresponding stellar populations .",
    "the left panel of figure  ( 1 ) shows the resulting hr diagram which contains a total of 3819 stars . to ensure a realistic error structure",
    "the shape of equation  ( [ sigma ] ) was obtained from a fit to the errors of the hst observations of dsph galaxies of unavane and gilmore ( private communication ) .",
    "the amplitude of this error is representative of what is seen in current hst observations . from the synthetic hr diagram",
    "the general features of the input @xmath0 can be seen , in that two basic populations are evident . obtaining the precise duration and location of these two bursts requires more work , and the detailed shape of each is quite hard to recover .    from the position of every one of the 1324 simulated stars with @xmath58 on figure  ( 1 ) ( see below ) we construct the matrix @xmath35 , where we further assume that the `` observational '' errors are well understood i.e. @xmath59 is known . since the colour of a star having a given luminosity can sometimes be a multi - valued function , in practice we check along a given isochrone , to find all possible masses a given observed star might have as a function of time , and add all contributions ( mostly 1 , sometimes 2 and occasionally 3 ) in the same @xmath35 .",
    "calculating this matrix is the only slow part of the procedure , and is equivalent to calculating the likelihood of one model .",
    "the likelihood matrix @xmath35 is the only input required by the method .",
    "the total number of stars is used as a normalization constraint at each iteration , needed to recover @xmath0 from @xmath44 . as mentioned earlier ,",
    "it is not necessary to calculate the likelihood over the solution space being considered , i.e. @xmath35 is only calculated once , which makes the method highly efficient .    given the degeneracy of isocrones of different ages in the main sequence region , the lower fraction of the hr diagram is of relevance only in establishing the total normalization condition , and not in determining the shape of the @xmath0 .",
    "for this reason , we only include in the inference procedure stars with @xmath58 , other stars are only used in fixing the overall normalization .",
    "the final results are not affected by this cut , but the iterative procedure converges much more rapidly and in a numerically more stable way if the lower degenerate and high error region of the hr diagram is excluded .",
    "* figure 2 . *    in figure  ( 1 )",
    "we also show the results of the first 12 iterations of the method every 2 iterations , which form a sequence of increasing resemblance to the input @xmath0 .",
    "the distance between successive iterations decreases monotonically at all ages , which together with the fact that after 12 iterations no further change is seen , shows the convergence of the method for this case . from the 2nd iteration (",
    "lowest dotted curve in the burst regions ) it can be seen that the iteration of the variational calculus equation constructed from maximizing the likelihood is able to recover the input @xmath0 efficiently .",
    "the positions , shapes and relative masses of the two bursts were correctly inferred by the 2nd iteration , although it took longer for the method to eliminate the populations outside of the two input bursts .",
    "the convergence solution is in remarkable agreement with the input @xmath0 , and only differs slightly , as seen from figure  ( 1 ) .",
    "no information was used in the inverting procedure beyond that which is available from the synthetic hr diagram , which was used extensively in constructing the likelihood matrix @xmath35 , which is the only input required by the inversion .",
    "the variational calculus method recovers a @xmath0 for which the first variation of the likelihood vanishes , without assuming any _ a priori _ condition on the @xmath0 , beyond being a continuous twice differentiable function of time .",
    "the second test uses an input @xmath0 which differs from the previous one in that the bursts are of much shorter duration and larger amplitude , to approximately preserve the total number of stars .",
    "the input @xmath0 of this case is shown by the dashed curve in the right panel of figure  ( 2 ) . the hr diagram which results from this @xmath0",
    "is shown in the left panel of figure  ( 2 ) and shows basically the same populations as in figure  ( 1 ) but with a much smaller spread , it contains a total of 3783 stars , with 1299 above @xmath60 .",
    "the errors in these two cases were equal .",
    "* figure 3 .",
    "*    the inversion procedure is shown in the right panel of figure  ( 2 ) , were it can be seen that the convergence of the method remains robust , although this time it took slightly longer , the first 15 iterations are shown every 3 .",
    "the @xmath0 to which the method converged ( after 20 iterations ) again accurately reproduces the input one , the age , duration , amplitude and shape of the two input bursts were correctly inferred . that the shorter duration of the bursts was correctly inferred in this case shows that in the previous one the reconstructed age duration was not due to the spread caused by the errors , but was actually resolved in the data , and recovered correctly by the method . in this second case however , the spread due to the errors begins to be comparable to the intrinsic one of the input @xmath0 , and causes an artificial broadening of the recovered stellar ages , particularly in the older component .",
    "this last effect causes also a slight underestimate in the maximum amplitude of the bursts . reducing the duration of the older component further would not produce a shorter duration in the inferred burst , unless the errors were also reduced",
    "that is , the method is capable of recovering the full age precision allowed by the observational errors .      as a third test we present figure  ( 3 ) , which is analogous to figures  ( 1 ) and ( 2 ) .",
    "the synthetic hr diagram this time contains 5907 stars with 1913 upwards of @xmath60 , and has the same errors as were used in figure  ( 1 ) . from the hr diagram in figure  ( 3 ) it can be seen that we have a dominant old population and a more recent component , with some degree of intermediary activity . in order to go beyond such a qualitative description to a quantitative assessment of detailed shapes and magnitudes of the star formation episodes we apply our inversion method , with results shown in the right panel of figure  ( 3 ) , this time the first 18 iterations , every 3 .",
    "the dashed line in figure ( 3 ) shows the input @xmath0 , which consists of a young narrow burst , a linearly decreasing intermediary component , and a larger older one . as figure",
    "( 3 ) shows , the method successfully inverted the hr diagram , converging very rapidly into the main features of the input @xmath0 .",
    "the youngest star formation episode was recovered remarkably well , as was the older dominant component , the @xmath0 to which the method converges differs only marginally from the input one in these two regions . in the intermediary region",
    "the method did recover the main features of the input @xmath0 , although the minimum was slightly overestimated . a low level numerical error due to edge effects near @xmath61 also appeared .",
    "a general feature of the method is that it rapidly eliminates any population younger than those present , but it takes longer to exclude populations older than those present . in general",
    ", the resolution of the inversion procedure decreases with age , as the critical regions of older isochrones become swamped in the noise .",
    "lower noise levels make the inversion procedure easier and more accurate results are obtained .    as a fourth test",
    "we use an input @xmath0 which differs from that of the previous test , only in that the intermediary population increases with time , rather than the opposite .",
    "the resulting hr diagram is therefore very similar to the previous case , as can be seen from comparing the left panels of figures ( 3 ) and ( 4 ) .",
    "the errors were the same as in all previous cases , while this test produced 5235 stars , 1743 in the region used by the inference procedure .",
    "figure ( 4 ) shows the input @xmath0 as the dashed line , and the first 15 iterations of the inversion method , every 3 , together with the final result at 20 iterations . as the ages and amplitudes of the two main components match those of the previous case , the hr diagrams of figures ( 3 ) and ( 4 ) differ only by a few stars .",
    "that the method is capable of discriminating between two such similar cases is encouraging . from the solid curve in figure ( 4 )",
    "it can be seen that again the method converges , and again into a @xmath0 which reproduces the input one to a high degree , the method efficiently eliminated populations outside of those actually present .",
    "not only are the main components identified in age and amplitude , but also the intrinsic shape of the bursts is recovered , as in the abrupt end of the younger burst , and the slanting intermediary component .",
    "moderate discrepancies between the input and recovered @xmath0 remained , specially in the appearance of an artificial oscillatory component superimposed mostly on the slanting component , possibly due to structure introduced by the small number of stars driving the likelihood matrix in that region .",
    "* figure 4 . *    * figure 5 .",
    "*    * figure 6 .",
    "*      the fifth test explores explicitly the way in which the method reacts to populations older than 10gyr , an approximate limit beyond which observational errors totally confuse the turn off points , in situations equivalent to current hst observations of dsph galaxies .",
    "this fifth test has the same input @xmath0 as shown in figure ( 4 ) , with the difference that an old component was added beyond 10 gyr .",
    "this @xmath0 is shown by the dashed line in the right panel of figure ( 5 ) .",
    "the left panel of figure ( 5 ) shows the resulting hr diagram which is used in the inversion process , and which only marginally differs from the one of figure ( 4 ) .",
    "figure ( 5 ) shows that the inversion procedure converged to a @xmath0 which is a highly accurate representation of the input @xmath0 in regions younger than around 10 gyr .",
    "although the result of this test differed from that of the previous one for populations older than 10 gyr in that the stars from this region were detected , the time structure of the oldest burst was totally erased .",
    "the poorer performance of the method in this region is also due to the proportionally smaller numbers of stars which live into the @xmath62 hr diagram .",
    "if more stars had been available in this last test , the older regions would have been better reproduced .      in this section",
    "we present figure ( 6 ) , which has the same input @xmath0 as in case 5 , and differs only in that a much lower noise level was assumed . in constructing the hr diagram seen in the left panel of figure ( 6 )",
    "the numerical constant in eq ( 10 ) was reduced from @xmath63 to @xmath64 .",
    "this lower noise level is reflected in the clearer hr diagram , where the older population is now distinguishable from the noise of the younger main sequence .",
    "the right panel in figure ( 6 ) shows the result of the inversion procedure , which differs from case 5 mostly in the speed with which the method converged , only 10 iterations were needed .",
    "the few stars in the oldest component which can be separated from the younger main sequence are sufficient to accurately recover the shape for this burst .",
    "in general , the variational calculus treatment of the maximum likelihood problem , together with the iterative method for solving the resulting equation , works remarkably well , within the practical limits set by the `` observational '' errors .",
    "having assumed only that the @xmath0 was a continuous function of time , the method manages to recover the input function quite accurately , under conditions similar to those present in current observations .",
    "in forthcoming papers we apply this methodology to derive star formation histories for several galactic satellites , and the solar neighbourhood .",
    "* figure 7 .",
    "*    * figure 8 .",
    "*    * figure 9 .",
    "*    as explained at the end of section 2 , the integro - differential equation ( equation 8) which results from applying variational calculus to maximize the functional of @xmath0 given by the likelihood function ( equation 6 ) is solved iteratively .",
    "this requires the use of an initialization function for the method . in all previous examples",
    "we have used the method described in the appendix , where for the first iteration all the @xmath65 coefficients are set equal to 1 , and equation ( 8) then solved using a finite differences procedure to obtain @xmath66 .",
    "this provides a natural initialization for the problem which is driven by the likelihood matrix @xmath35 .",
    "this same method will also be used in the following sections . in this section",
    "however , we study the generality of this initialization and the effects of adopting different ones .",
    "we present two cases , in each a fixed hr diagram was inverted using a variety of initialization conditions , the first being the natural condition .",
    "the other initialization procedures used where actually to start by supplying @xmath66 directly , the rest of the procedure being unchanged .",
    "one should expect this differences to matter little , as in the solving of equation ( 8) the previous solution @xmath67 enters in the determination of @xmath68 only through the @xmath69 coefficients , i.e. only through time integrals of @xmath67 , weighted by the likelihood matrix . in this way the details of the previous iteration",
    "are lost to the next , it is the likelihood matrix and the time derivative of it which drive the convergence ( see equation 8) .",
    "figure ( 7 ) shows the effects of adopting different initialization procedures to invert the hr diagram resulting from a simple gaussian burst input @xmath0 .",
    "this input @xmath0 resulted in 7411 stars , 2458 brighter than the @xmath60 limit , the noise level was the same as in figure ( 1 ) . in the first row the natural condition ( n ) was used , where @xmath66 , @xmath70 , @xmath71 and @xmath72 are shown in the four panels of the first row .",
    "the last panel also shows the input @xmath0 as a dotted curve . in the second row",
    "a constant @xmath66 was used ( c ) , a decaying one in the third row ( d ) , a misplaced burst in the fourth ( m ) and a sine wave ( s ) in the fifth row , all sequences show the initial @xmath0 and the first , third and tenth iterations of equation ( 8) . in this way",
    "the first column shows the initial , the second the first iteration , the third the third iteration , and the last column the tenth iteration , by which time the method had converged in all cases .",
    "clearly , as each iteration enters into the calculation of the next only through an integral condition , the method is highly independent of the choice of initialization function .",
    "although the five initial @xmath66 vary markedly , already the first iteration shows a much more homogeneous sample , whilst by the third iteration all initialization procedures give highly similar answers . as expected , the final result is seen to be totally independent of the initialization procedure , it is driven exclusively by the likelihood matrix . this last point is shown in the last column of figure ( 7 ) , where the final answers of the five different initial @xmath66 can be seen to differ only marginally , and to be in all cases a very good estimate of the input @xmath0 , which is shown by the dotted curve .",
    "figure ( 8) is analogous to figure ( 7 ) , but was constructed using a more complicated input @xmath0 , shown by the dashed curve in the last column of figure ( 8) . again , even though the initial @xmath73 where very different , the second and third columns show the variation between the first iterations to be much reduced , and almost gone by the third . the final result in all cases is identical , and a good approximation to the input @xmath0 , which was more complex than what was used in figure ( 7 ) .",
    "even the slight error seen between the final result and the input @xmath0 is a feature independent of the initialization assumptions .",
    "the solution is clearly seen to be driven by the likelihood matrix , which is of course the same for all cases , as it depends only on the position of the stars in the hr diagram , and the stellar evolutionary model used .",
    "case ( s ) illustrates how spurious high frequency structure does not propagate between iterations , which is natural as only integral coefficients of @xmath67 intervene in estimating @xmath68 .",
    "this is one of the merits of our method , as numerical noise is suppressed .",
    "the independence of the answer on the initialization procedure is encouraging of the solid statistical foundation of the method and the validity of the variational calculus approach , but is not an essential feature , as there exists a natural initialization internal to the problem , which should be preferred in all cases .",
    "henceforth we shall make use only of this natural initialization as described in the appendix .",
    "* figure 10 . *    uncertainties in the imf , metallicity and binaries differ from simple sample size or photometric error in inducing a systematic mismatch between the isochrones used in any specific calculation and those which describe the astrophysics of the hr diagram being inverted .",
    "the following tests show the sensitivity of the method to uncertainties in the input imf , metallicities and binary fraction .",
    "firstly we present figure ( 9 ) , the synthetic hr diagram contains 6340 stars with 1808 brighter than @xmath60 , and the input @xmath0 is shown by the dashed line in the right panel of figure ( 9 ) .",
    "the inversion of this hr diagram clearly shows again the convergence of the method to an accurate representation of the input @xmath0 .",
    "this test was included to define a control case to which variations can be compared .",
    "the left panel in figure ( 10 ) shows the results of applying the inversion procedure with a `` wrong '' imf to the hr diagram in figure ( 9 ) which was produced using the imf of equation  ( 9 ) .",
    "the inversion procedure assumed an imf @xmath74 for all masses .",
    "comparing figure ( 9 ) and the left panel in figure ( 10 ) it can be seen that the main effect of an error in the imf is a distorted normalization , which is based on the total number of stars .",
    "the imf used in the inversion is one in which low mass stars are more dominant than in the imf used to construct the hr diagram , as a result , a lower @xmath0 sufficed to produce the correct number of stars . as the colour and luminosity of a star of a given age and mass are not affected by changes in the imf , the location of the relevant populations was not affected .",
    "the net result of changing the imf used in the inversion was a reduction of the recovered @xmath0 by a factor of @xmath75 , which is the factor by which the mass in stars in the mass region which we are sampling differs between the two imf s .",
    "the convergence of the method was similarly unaffected .",
    "we can conclude that errors in the imf used , within the expected uncertainties , do not affect the derived star formation history significantly .",
    "in the following tests we investigate the effects of an uncertainty in the metallicity ; the well known degeneracy between the inferred age and metallicity of an observed stellar population will be evident .",
    "figure ( 10 ) , right panel shows the result of inverting the hr diagram of figure ( 9 ) , which was produced using a metallicity of @xmath49=-1.7 $ ] , using this time isochrones for @xmath49=-0.7 $ ] in the inversion procedure .",
    "the convergence of the method was not affected , and proceeded at the same rate as in the previous two cases , as the same hr diagram was used .",
    "the result of having assumed a metallicity one order of magnitude higher than that of the stellar population being inverted is a @xmath0 much younger than the input one , as can be seen from figure ( 10 ) , right panel .",
    "this discrepancy is due to the fact that the isochrones used in the inversion have very different temperatures and luminosities for stars of a given mass , from those of the isochrones used to generate the hr diagram .",
    "actually , the colours and luminosities of stars from the higher metallicity isochrones approximately correspond to those of younger stars from the lower metallicity isochrones , the age - metallicity degeneracy . having",
    "used isochrones in the inversion procedure which do not correspond to the stars being studied also confuses the method and the shape of the recovered @xmath0 is slightly distorted . the younger age assigned to the stars",
    "being analyzed also produces a slightly lower total @xmath0 , as with a younger population a larger fraction of the stars live into the present day hr diagram . using real data ,",
    "the slope of the rgb can be used to determine the metallicity to greater accuracy than the difference between the used and assumed metallicities of this example , where the effect was exaggerated .",
    "it is interesting to perform the complementary test , where the hr diagram is produced using a non constant metallicity , and inverted assuming a constant one .",
    "this is presented in figure ( 11 ) .    * figure 11 .",
    "*    figure ( 11 ) shows the hr diagram which results from the input @xmath0 of figure ( 9 ) , with the difference that on this occasion the metallicity was not constant . in this case",
    "we used a metallicity of @xmath49=-1.7 $ ] for the stars older than 7.5 gyr , and of @xmath49=-0.7 $ ] for the stars younger than 7.5 gyr , i.e. , a crude enrichment history .",
    "this is clearly seen in figure ( 11 ) , where the two populations having different metallicities are evident , from the width of the rgb . as in all previous cases ,",
    "the noise level was not changed .",
    "the result of applying the inversion method assuming a constant metallicity of @xmath49=-1.7 $ ] is shown in the right panel of figure ( 11 ) .",
    "the method correctly identifies the half of the @xmath0 with the lower metallicity ; the higher metallicity population is totally misinterpreted .",
    "actually , the age the inversion procedure should assign to the high metallicity component is in fact greater than 15 gyr , which is in contradiction with the fixed boundary condition of @xmath76 .",
    "this makes the inversion procedure somewhat unstable , which in principle can be used to indicate that the isochrones being used in the inversion procedure do not correspond to the studied stars .",
    "the two distinct giant branches seen in this hr diagram indicate a difference in the metallicities of both populations .",
    "if this were introduced as an extra constraint , the method would successfully recover the correct @xmath0 .",
    "as it might have been expected , uncertainties in the metallicity distort the inference procedure significantly , making the present method only of any use in cases where the metallicity is well known , as is the case for some dsph companions of the galaxy .",
    "other stellar systems exist where direct spectroscopic measurements can yield an observational constraint on the metallicity , and consequently make methods such as the one we have presented here useful .",
    "the uncertainties inherent to the determinations of these metallicities will result in errors in the answer yielded by the method , in ways similar to those discussed by aparicio et al .",
    "( 1997 ) or tolstoy et al .",
    "( 1998 ) .",
    "however , solving the theoretical problem of recovering simultaneously the @xmath0 and @xmath77 remains a challenge .",
    "variational calculus methods can be formally extended to the case of recovering several functions simultaneously , and in a further work we shall present one option through which the age metallicity degeneracy can be much reduced . basically , the difficulty stems from the impossibility of determining uniquely an observed star s age and metallicity from its observed colour and luminosity .",
    "one can in practice pick an age , and there will be a star of some metallicity with the required properties , which makes isochrone fitting impractical .",
    "nevertheless , the masses of these stars will be different , which provides a way of distinguishing between an old , low metallicity isochrone and a young metal rich one , even if the curves are indistinguishable on the hr diagram . in calculating the full likelihood ,",
    "one considers the probability of an observed star belonging to each isochrone .",
    "even if the star is the same distance from two isochrones of different age , the possibility of it coming from both will be different , as the density of points along them will depend on mass .",
    "knowing the relevant imf therefore furnishes an extra constraint .",
    "* figure 12 . *      as a final variation we consider the effects a non - zero binary fraction would produce , which is shown in figure ( 12 ) .",
    "figure ( 12 ) shows the hr diagram which results from the @xmath0 of the previous tests , with the same imf and metallicity of figure ( 9 ) , but with the inclusion of a binary fraction of 0.5 .",
    "half of the stars generated had a secondary companion picked from the same imf .",
    "the luminosity of the resulting binary is given by the sum of the luminosities of the two components , and its combined effective temperature through the stefan - boltzmann law . in the current observations of dsph galaxies and other similarly crowded fields the main contribution to the `` binary '' population comes not from physical binaries , but from observational confusion . attempting to model this effect we picked the secondary star from the same imf as the primary one ( e.g. see kroupa et al .",
    "( 1993 ) for a discussion of binary confusion in observations ) .",
    "we took the value of 0.5 for the binary fraction as a representative number from kroupa et al .",
    "( 1993 ) .",
    "as can be seen from comparing figures ( 12 ) and ( 9 ) , the main result of having included a large binary fraction is a reduction in the total number of stars ; the morphology of the hr diagram was not significantly affected .",
    "this last effect is due to the fact that the offset between the single star and the binary star main sequences is comparable to the noise in that region , producing only a slightly broadened main sequence .",
    "the effects of binaries in other parts of the diagram are negligible , as the addition of a main sequence star to a giant does not affect the observed properties of the giant , and the odds of getting a binary giant are slim .",
    "the results of the inversion method are shown in the right panel of figure ( 12 ) , where the dashed line shows the input @xmath0 , and the dotted and solid curves the first 18 iterations of the method , every 3 .",
    "the convergence of the method is not affected , and proceeds quite rapidly .",
    "it can be seen that the method accurately identifies the age , duration and structure of the input burst , although with a normalization error which results from the reduction in the total number of stars seen . a further slight discrepancy between the input @xmath0 and the recovered one appears at old ages , as the method confuses the broadening in the main sequence for a minor , extended age population . as with the errors in the imf , having neglected the effects of binaries affects mostly the normalization of the recovered @xmath0 , distorting the general shape only slightly .",
    "this is encouraging as the absolute normalization will in any case have to be supplied externally through global @xmath78 ratios or other observations , when studying large extended systems such as dsph galaxies for which hr diagrams , covering the complete galaxy do not at the moment exist .",
    "we can summarize our results as follows :    \\1 ) we have introduced a variational calculus scheme for solving maximum likelihood problems , and tested it successfully in the particular case of inverting hr diagrams .",
    "\\2 ) assuming a known imf and metallicity we have presented a totally non - parametric method for inverting hr diagrams which yields good results when recovering stellar populations younger than 10 gyr , with data quality similar to those attained in current hst observations of dsph galaxies .",
    "populations older than 10 gyr can only be recovered equally well from hr diagrams with much reduced observational errors .",
    "\\3 ) uncertainties in the imf and binary fractions result in normalization errors on the total @xmath0 .",
    "given the existence of an age - metallicity degeneracy on the colours and magnitudes of stars , an error in the assumed metallicity results in a seriously mistaken @xmath0 .",
    "this makes the version of the variational calculus approach we present here only useful in cases where the metallicity of the stars is known .",
    "the work of x. hernandez was partly supported by a dgapa - unam grant .",
    "the authors wish to thank rafael rosales for his help in developing the statistical model presented here and ricardo carretero for help with the convergence of the method .",
    "aparicio a. , bertelli g. , chiosi c. , garcia - pelayo j.m . , 1990 ,",
    "a&a 240 , 262 aparicio a. , gallart c. , 1995 , aj , 110 , 2105 aparicio a. , gallart c. , bertelli g. , 1997 , aj , 114 , 669 chiosi c. , bertelli g. , meylan g. , ortolani s. , 1989 , a&a , 219 , 167 da costa g.s . , 1994 , eso / ohp workshop on dwarf galaxies , eds meylan g. , & prugniel p. , p. 221 dolphin a. , 1997 , new astronomy , 2 , 397 fagotto f. , bressan a. , bertelli g. , chiosi c. , 1994 , a&as , 104 , 365 girardi l. , bressan a. , chiosi c. , bertelli g. , nasi e. , a&as 117 , 113 grebel e.k . , 1997 ,",
    "preprint , astro - ph 9706191 hurley - keller d. , mateo m. , nemec j. , 1998 , aj , 115 , 1840 kroupa p. , tout c.a . , gilmore g. , 1993 , mnras , 262 , 545 mighell k.j . , butcher h.r . , 1992 ,",
    "a&a , 255 , 26 mighell k.j . , 1997 , aj , 114 , 1458 mould j.r . , han m. , stetson p.b . , gibson b. , graham j.a . , huchura j. , madore b. , rawson d. , 1997 , apj , 483 , l41 ng y.k . , 1998 ,",
    "a&as , 132 , 133 smecker - hane t.a . , stetson p.b . , hesser j.e .",
    ", lehnert m.d . ,",
    "1994 aj , 108 , 507 tolstoy e. , 1995 , phd .",
    "thesis , groeningen university , the netherlands .",
    "tolstoy e. , saha a. , 1996 , apj , 462 , 672 tolstoy e. , gallagher j.s . ,",
    ", hoessel j.g . ,",
    "saha a. , dohm - palmer r.c . ,",
    "skillman e.d .",
    ", mateo m. , hurley - keller d. , astro - ph/9805268 accepted in aj    * figure a1 .",
    "*    * figure a2 . *",
    "in section 2 we proposed a variational calculus approach to solving directly for the maximum likelihood @xmath0 , which yielded :        the first step is to evaluate @xmath35 from the position of the modeled stars for each of the values of t being considered , 100 in this case .",
    "@xmath81 is then calculated using a quadratic interpolation on @xmath35 .",
    "we next evaluate the coefficients in equation  ( 8) by assuming @xmath82 . setting the condition @xmath83",
    ", we solve equation  ( 8) using a finite differences scheme , to obtain @xmath66 .",
    "this is then used to recalculate the integral coefficients for each star , @xmath84 , which completes the cycle of each iteration .",
    "other initialization procedures are of course possible , but this one is the one which appears natural to the problem , as it gives a @xmath66 which is determined by the likelihood matrix .",
    "@xmath0 is then recovered from @xmath85 and normalized through the total number of stars .",
    "the results of this iterative scheme are shown by the solid lines in the left panel of figure ( a1 ) , which also shows as a dotted line the input @xmath0 .",
    "this is the same case as shown in figure ( 1 ) .",
    "as the left panel of figure ( a1 ) shows , the method gives a solution which is actually the opposite of the input @xmath0 , and which rapidly diverges and oscillates .",
    "this result is not altogether surprising , as variational calculus methods yield solutions which imply stationary values of a functional , not necessarily a maximum . in this case , the method is tending to a _",
    "minimum _ of the likelihood . to overcome this problem",
    "we introduce the conjecture that the maximum likelihood @xmath0 will have a time derivative of the opposite sign to that of the one which minimizes the likelihood , at all points .",
    "this assumption translates into changing the sign of c2(t ) .",
    "the result of the method is now shown in the right panel of figure ( a1 ) which gives the 1,2,3,4,5,8,12 and 13 iterations , as in the left panel . in this case",
    ", the method correctly identifies the ages of the populations present , but actually oscillates , and each branch still slowly diverges .",
    "this behaviour is not uncommon in dynamical systems , and there was no guarantee that the simplest implementation would work . inspecting the behaviour of the c1(t ) and c2(t ) coefficients we identified c2(t ) as the source of the oscillations .",
    "we therefore introduced an averaging from one iteration to the next on the value of c2(t ) .",
    "as in each branch one population grows as the other tends to zero , we kept twice the average of c2(t ) at the present iteration and the previous one .",
    "the result of the method at this stage can be seen in the left panel of figure ( a2 ) .",
    "the dotted curve is again the input @xmath0 , and the solid ones show the same iterations as in the previous case .",
    "the method now converges steadily into the two populations present , correctly excluding populations not present , although a tilt towards younger ages is apparent .",
    "we interpret this tilt as caused by the differential incompleteness of the hr diagram as a function of time .",
    "as our isochrones stop at the tip of the rgb , at a star of a zero age mass which decreases for older isochrones , the older populations are missing an increasing proportion of their stars . to obtain the @xmath0 in the mass range @xmath86 from",
    "our inferred @xmath0 which sees stars only between @xmath87 and the tip of the rgb we multiply the @xmath0 by a minor correction factor to compensate for this incompleteness , given by integrating equation  ( 9 ) out to the tip of the rgb at every t , and comparing with the result at t=0 .",
    "this final correction is introduced only when plotting the results , and is not included in the iterative procedure . in dealing with real data",
    "it will be necessary to remove any stars associated with evolutionary phases not included in the isochrones with which those stars are compared .",
    "the final results for this particular example are shown in the right panel of figure ( a2 ) , where the solid curves show the same iterations as the previous 2 cases .",
    "the method now tends strongly to the input @xmath0 , to a level limited only by the amount of noise present in the modeled stars , as explored in section ( 3 ) .",
    "we realize that the final method is not a rigorous implementation of the mathematical hypothesis , for which reason we have tested the validity and precision experimentally with a very large number of synthetic hr diagrams . the results where highly accurate in all cases , a fraction of which are detailed in sections ( 3 ) and ( 4 ) ."
  ],
  "abstract_text": [
    "<S> we introduce a new method for solving maximum likelihood problems through variational calculus , and apply it to the case of recovering an unknown star formation history , @xmath0 , from a resulting hr diagram . </S>",
    "<S> this approach allows a totally non - parametric solution which has the advantage of requiring no initial assumptions on the @xmath0 . as a full maximum likelihood statistical model is used , we take advantage of all the information available in the hr diagram , rather than concentrating on particular features such as turn off points or luminosity functions . </S>",
    "<S> we test the method using a series of synthetic hr diagrams produced from known @xmath0 , and find it to be quite successful under noise conditions comparable to those present in current observations . at this point </S>",
    "<S> we restrict the analysis to situations where the metallicity of the system is known , as is the case with the resolved populations of the dwarf spheroidal companions to the milky way or the solar neighbourhood hipparcos data . </S>",
    "<S> we also include tests to quantify the way uncertainties in the assumed metallicity , binary fraction and imf affect our inferences .    methods : statistical  methods : analytical  stars : formation  galaxies : evolution </S>"
  ]
}