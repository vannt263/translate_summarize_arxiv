{
  "article_text": [
    "fifty years ago @xcite , herbert simon defined complex systems as nested hierarchical networks of components organized as interconnected modules .",
    "hierarchy seems a pervasive feature of the organization of natural and artificial systems @xcite .",
    "the examples span from social interactions @xcite , urban growth @xcite , and allometric scaling @xcite to cell function @xcite , development @xcite , ecosystem flows @xcite , river networks @xcite , brain organization @xcite and macroevolution @xcite .",
    "but hierarchy is a polysemous word , involving order , levels , inclusion or control as possible descriptors @xcite , none of which captures either its complexity or the problem of its measure and origins .",
    "although previous work using complex networks theory has quantitatively tackled the problem @xcite , some questions remain : is hierarchy a widespread feature of complex systems organization ?",
    "what types of hierarchies do exist ?",
    "are hierarchies the result of selection pressures or , conversely , do they arise as a byproduct of structural constraints ?",
    "a well established concept where such questions are addressed involves the use of a _ morphospace _",
    "@xcite namely a phenotype space where a small set of quantitative traits can be defined as the axes . here",
    "we take a step in this direction by combining morphospace and network theories , taking the intuitive idea of hierarchy as the starting point : a pattern of relations where there is no ambiguity in who controls whom with a pyramidal structure in which the few control the many .",
    "formally , the picture of hierarchy matches a tree of relations @xcite , ideally represented by a directed graph . as shown in fig .",
    "( [ fig : fig_1 ] ) the elements of the system are represented by nodes connected by arrows establishing the map of relations of who affects whom . accordingly , a measure of hierarchy should account for the deviations from this ideal tree picture .",
    "such deviations occur because : ( a ) several elements are on the top , ( b ) downstream elements interact horizontally or ( c ) feedback loops are present . as shown in fig .",
    "( [ fig : fig_1]a ) , the tree - like picture matches the concept of genealogies , taxonomies , armies and corporations .",
    "conversely , drainage networks in river basins @xcite would define a reverse anti - hierarchical situation , as depicted in fig .",
    "( [ fig : fig_1]b ) . in this structure ,",
    "multiple elements on the top merge downstream like an inverted tree . in between them , we can place a more or less symmetric web ( fig . [",
    "fig : fig_1]c ) somewhat combining both tendencies .",
    "but , in general , neither biological nor technological webs match the feedforward pattern .",
    "in most real systems , signal integration requires gathering inputs from different sources , while robust processing and control requires crosstalk and feedbacks , as represented by fig .",
    "( [ fig : fig_1]d ) , which are often organized in a modular fashion @xcite .",
    "hierarchy seems to pervade a coherent form of organization that allows reducing the costs associated to reliable information transmission @xcite and to support efficient genetic and metabolic control in cellular networks @xcite .",
    "however , a unified picture of hierarchy should not only provide a formal definition but also help understanding the forces that shape it .",
    "here we provide the formalization and the quantitative characterization of the morphospace of the possible hierarchies .",
    "the study of a large number of real networks and its comparison with model systems provide some unexpected answers to the previous questions .",
    "since hierarchy is about relations , our approach formalizes the interaction between system s elements by means of a directed graph @xmath0 @xcite where @xmath1 ( @xmath2 ) is a node and @xmath3 an arrow going from @xmath4 to @xmath5 .",
    "this graph is transformed into the key object for our methodology : the so - called _ node weighted condensed graph _ , @xmath6 .",
    "( [ fig : fig_1]d and [ fig : fig_1]h ) show , @xmath7 is a feedforward structure where cyclic modules of @xmath8 ( the so - called strongly connected components @xmath9 , hereafter @xmath10s ) are represented by individual nodes ( thereby obtaining the _ condensed graph _",
    "it is worth to mention that @xmath10 detection has been shown as a powerful approach for subsystem identification @xcite unraveling the presence of nested organizations . in the case of a given @xmath7",
    ", every node has a weight @xmath11 that indicates the number of elements from @xmath8 it represents ( see section [ sec : dags ] in the appendix for details ) .",
    "interestingly , such a graph represents the largest set of subgraphs of @xmath8 ( which , in this case , turn to be either isolated nodes or @xmath10 s ) that can be properly _ ordered _ attending the causal flow defined by the arrows .",
    "this latter property will be the key to conceptually connect our definition of hierarchy with order .",
    "our space of hierarchies will be a metric space @xmath12 , defined from three coordinates : treeness ( @xmath13 ) , feedforwardness ( @xmath14 ) and orderability ( @xmath15 ) , which properly quantify graph hierarchy .",
    "treeness ( @xmath13 , being @xmath13 in the range @xmath16 ) weights how pyramidal is the structure and how unambiguous is its chain of command .",
    "this measure covers the range from hierarchical ( @xmath17 , fig .",
    "( [ fig : fig_1]a ) ) to anti - hierarchical ( @xmath18 , fig .",
    "( [ fig : fig_1]b ) ) graphs including those structures which do not exhibit any pyramidal behaviour ( @xmath19 , fig .",
    "( [ fig : fig_1]c ) ) . as illustrated in fig .",
    "( [ fig : fig_1]e - g ) , these graphs are characterized by taking the structure as a road map where we compare the diversity of choices we can take going top - down , i.e. , following the arrows of the structure , versus the uncertainty generated when reverting the paths going bottom - up .",
    "such diversity is properly quantified using _ forward _ ( @xmath20 ) and _ backward _ ( @xmath21 ) entropies , respectively .",
    "entropies are computed over directed acyclic graphs @xcite .",
    "while section [ sec : detailedderivation ] of the appendix presents a rigorous description of these concepts , they can be briefly presented departing from the node - weighted condensed graph @xmath6 shown in fig .",
    "( [ fig : fig_1]h ) .",
    "notice that a directed acyclic graph is naturally a node - weighted graph and hence ensures @xmath22 . from the graph @xmath7 , we define two sets , namely @xmath23 and @xmath24 .",
    "the first , composed by nodes with @xmath25 , i.e. the set of _ maximal _ nodes and the second , the set of nodes with @xmath26 , to be referred to as the set of _ minimal nodes_. now , let @xmath27 be the set of all paths starting in some maximal node . since @xmath7 is a graph without cycles , this set contains a finite number of elements @xmath28 .",
    "if @xmath29 , the uncertainty associated to follow a given path starting from @xmath4 and ending to some node in @xmath24 , @xmath30 will be : @xmath31 where @xmath32 is the probability that the path @xmath33 is followed , starting from node @xmath29 .",
    "the average uncertainty we face to follow a path starting from some node in @xmath23 will be @xmath34 which is the general expression of the _ forward _ entropy of @xmath35 . in a similar way but reversing the pathways a _ backwards _ entropy , @xmath36 , of @xmath7 can be obtained .",
    "details of the derivation of @xmath36 are found in section [ sec : detailedderivation ] of the appendix .",
    "once the entropies accounting for the top - down and bottom - up path diversity generation are properly derived , we proceed to define a function with the aim of quantitatively grasp the deviations of @xmath7 from the ideal tree picture of a hierarchical system .",
    "the explicit form is obtained by means of the normalized difference @xcite of the two presented entropies , namely : @xmath37 for the sake of consistency @xmath38 if @xmath39 -occurring in the case where @xmath7 is a linear chain .",
    "the final value @xmath40 is computed as follows : first , let @xmath41 be set containing @xmath7 and all subgraphs of @xmath7 that can obtained by means of the application of a _ leaf removal algorithm _ ( either top - down or bottom up , see section [ sec : detailedderivation ] of the appendix for details ) .",
    "then , @xmath40 is obtained by averaging @xmath42 along all the members of @xmath41 : @xmath43 in addition , @xmath44 if @xmath7 has no links -which can happen , e.g. , if @xmath8 is totally cyclic .",
    "@xmath40 has been shown to be a very good indicator of the deviations of a given acyclic graph from the ideal hierarchical , tree - like picture @xcite .      in the @xmath7 , since the elements within a @xmath10 can not be intrinsically ordered , @xmath10s constitute non orderable modules of the feedforward structure . as fig .",
    "( [ fig : fig_1]h ) shows , @xmath10s represent a violation of the order at a given point of the feedforward condensed structure . here , the size of the @xmath10s , but also their position in the feedforward structure are key elements for the quantification of the impact of cyclic modules in the feedforward structure , since the higher the @xmath10 position , the larger the number of its downstream dependencies . according to this ,",
    "we define feedforwardness ( @xmath14 , being @xmath45 ) , a measure that weights the impact of cyclic modules on the feedforward structure of the graph , where cyclic modules closer to the _ top _ of @xmath8 will introduce a larger penalty on hierarchical order than those placed at the bottom . for every path @xmath33 starting from the top of @xmath7",
    "we compute the fraction of the nodes that it contains against the actual nodes of @xmath8 it represents .",
    "formally , if @xmath46 is the set of nodes participating in the path @xmath33 , @xmath47 where , as illustrated in fig .",
    "( [ fig : fig_1 ] ) , @xmath11 is the _ weight _ of node @xmath4 in the _ node- weighted _ condensed graph . to obtain a statistical estimator of the impact of the location of cyclic modules within the causal flow described by the network",
    ", we first have to define the set @xmath48 , which is the set containing all possible paths starting from the set of maximal nodes , @xmath23 , and ending in any other node of @xmath7 .",
    "now , @xmath49 is , thus , simply the average of @xmath50 over all elements of @xmath48 , i.e. : @xmath51      as hierarchy is grounded on the concept of order , we need a descriptor that accounts for how orderable is the graph under study . ranging from a fully cyclic graph to a feedforward structure _ orderability _",
    "( @xmath15 ) lies in the range @xmath52 and it is defined as the fraction of the nodes of the graph @xmath8 that _ does not _ belong to any cycle .",
    "these nodes , therefore , make part of the fraction of the network that can be actually ordered .",
    "such an orderable fraction provides a raw but very meaningful estimator about how ordered is the set of nodes within the graph ( see figs .",
    "( [ fig : fig_1]i - l ) ) .",
    "formally , we define @xmath53 as : @xmath54    once we exposed the formal description of the different hierarchy indicators , i.e. treeness ( @xmath13 ) , feedforwardness ( @xmath14 ) and orderability ( @xmath15 ) , we proceed to collect them together to create a space @xmath12 where networks can be properly evaluated and compared .",
    "once our coordinates are defined , let us first see what is the repertoire of possible patterns that could be observed . according to our formalism ,",
    "the hierarchical features of any directed network are given by a point @xmath55 in a 3d morphospace @xmath12 , being @xmath56\\times[0,1]\\times[0,1]$ ] ( fig .",
    "( [ fig : fig_2]a ) and fig ( [ fig : toys ] ) of the appendix ) .",
    "the point @xmath55 represents the graph @xmath8 by three coordinates , @xmath57 in the morphospace @xmath12 , according to its hierarchical properties . using the schematic representation of graphs outlined in fig .",
    "( [ fig : fig_1 ] ) , we define an intuitive icon associated to each kind of graph . as summarized in fig .",
    "( [ fig : fig_2]a ) , the perfect hierarchy is located at @xmath58 , whereas the completely non - hierarchical system - a totally cyclic network- is located at @xmath59 .",
    "interestingly , orderability and feedforwardness provide complementary information that defines forbidden regions of the morphospace .",
    "since @xmath60 is only possible when @xmath61 , feedforward networks belong to the @xmath62 line . given @xmath63 , not other @xmath64 is permitted by definition .",
    "attending to @xmath14 and @xmath15 , we find an interesting region , defined by @xmath65 and @xmath66 .",
    "it is worth to stress that , while @xmath53 and @xmath67 converge in their upper bound in a single value that defines the region of feedforward networks , they differ when @xmath15 goes to zero .",
    "this is because @xmath49 deals with the condensed graph while including _ condensed _ modules but @xmath53 is about the nodes out of cycles .",
    "this little difference allows to unravel a family of rare networks highlighted by its extreme configuration -as shown by green icons in fig .",
    "( [ fig : fig_1]a ) .",
    "essentially they are formed by chains of small @xmath10s disposed in a feedforward structure .    from these two axes accounting for the cyclic nature of networks ,",
    "the coordinate @xmath13 provides additional information about the organization of the resulting feedforward structure after network condensation . attending to the concept of a pyramidal structure , the plane separating hierarchy from anti - hierarchy ( @xmath19 ) defines a family of symmetric structures , where the downstream path diversity is canceled by the uncertainty resulted when reversing these paths .",
    "interestingly , when cycles are incorporated to this structure at @xmath19 , the resulting structure is a bow - tie organization . in this particular structure ,",
    "a large @xmath10 occupies a central position in a quite symmetrized feedforward structure of inputs and outputs @xcite . as shown in fig .",
    "( [ fig : fig_2]a ) , the larger the @xmath10 , the lower are the values of @xmath14 and @xmath15 .",
    "since null models do not consider optimal designs or functional constraints , they provide good insights about the part of the morphospace where no selection pressure is at work .",
    "( [ fig : fig_2]b - c ) shows that both homogeneous and broad random networks occupy ( basically ) the same region in @xmath12 .",
    "this co - occupation , within the bow - tie plane with @xmath68 , shows that random graphs appear located right in the middle between hierarchical and anti - hierarchical structures , independently of the type of degree distribution of the studied models .",
    "that implies , among other things , that they account for both bow - tie structures and feed - forward sparse webs .",
    "what about real nets ?",
    "here we use @xmath69 real networks encompassing @xmath70 classes of natural and artificial systems ( see si2 for numerical details of @xmath71 values ) . as fig .",
    "( [ fig : fig_2]d ) shows , a few isolated systems reach the boundaries of @xmath12 : a cell lineage located at @xmath72 and a small social network located at @xmath73 .",
    "however , most networks fall into four clusters .    first , a group consisting of metabolic , neural , linguistic and some social networks is found at the lower part of the bow - tie domain , clearly embedded within the cloud of random graphs ( fig .",
    "[ fig : fig_2]d )",
    ". interestingly , randomized nets of this group show a similar behavior although with a more central position within the cloud of random nets ( see fig .",
    "( [ fig : fig_nova ] ) .",
    "an interesting case is given by the presence of bow - tie patterns in metabolic networks @xcite .",
    "they display a large central cycle , much larger than that observed in their randomized counterparts .",
    "this likely reflects the advantage of reusing and recycling molecules .",
    "the second group placed at the @xmath74 plane shows a narrow band of feedforward nets including electronic circuits with @xmath75 and software graphs slightly biased to negative @xmath40 values . here",
    "too the dispersal seems consistent with what is expected from very diluted random graphs ( see fig .",
    "( [ fig : fig_2]c ) ) .",
    "this sparseness is a consequence of engineering practices focused on reducing the wiring costs while keeping the system connected @xcite .",
    "the third group displays slightly positive values of @xmath40 and is composed of graphs with cycles of small size but with a predominant position at the feedforward structure giving rise to a very high @xmath15 with variable @xmath49 .",
    "these are gene regulatory networks plus a protein kinase network .",
    "@xmath49 dispersion is due to the variable size of modules located at the top of the structure .",
    "the special location in @xmath12 , far from the random cloud , is caused by a small fraction of genes , the dna - binding elements ( transcription factors ) , located at the top of the network , which participate in cycles .",
    "finally , the fourth group is defined by an isolated cluster of ecological flow graphs , located around @xmath76 .",
    "their @xmath77 values indicate a certain degree of pyramidal structure and the low @xmath53 s are consistent with an important role played by loops .",
    "the special status of these networks ( not shared by other webs ) is consistent with the well known picture of a trophic pyramid combined with the presence of recycling @xcite .",
    "nodes and an average degree of four links per node is built .",
    "the resulting @xmath7 ( b ) displays a very clear bow - tie organization ( c ) .",
    "the human metabolic network ( d ) , although non - homogeneous and resulting from evolution , displays a similar pattern ( e - f ) .",
    "both graphs are close within @xmath12 .",
    "network layouts generated using cytoscape software @xcite.,width=321 ]    the four clusters point to different scenarios pervading the origins of their hierarchical organization .",
    "one key observation is that most data sets are found within the envelope predicted by the ensembles of random graphs ( see fig .",
    "( [ fig : fig_nova ] ) ) .",
    "since these null models do not consider optimal designs nor functional traits , we conclude that , as it was reported in the context of modularity @xcite , hierarchical order may be a byproduct of inevitable random fluctuations , which spontaneously generate graph correlations , bow - tie networks , which have been suggested to define a flexible , robust and evolved type of systems @xcite , perhaps resulting from selection for robustness would be a byproduct of the generation rules responsible for network growth .",
    "the previous results raise the question of how the voids in the morphospace need to be interpreted . in order to decide whether they are simply forbidden or have not been reached by evolution , we used an evolutionary search algorithm @xcite which , starting from a random configuration , tries to get the points of a evenly gridded partition of the morphospace .",
    "the results provide a picture about how accessible are the different regions of @xmath12 .",
    "detailed information about the evolutionary algorithm is found in section [ sec : accessibilityevolution ] of the appendix .",
    "very briefly , the evolutionary algorithm starts from a given set of small random graphs @xmath78 belonging to the cloud of null models and networks . given a target point @xmath79 of @xmath12",
    ", these graphs are evolved by a random process of link addition and deletion with selection of networks minimizing the distance @xmath80 .",
    "the number of nodes for every graph , @xmath81 , remains constant in this process and graphs must belong to a single connected component .",
    "only the number of links and their distribution are affected by the evolutionary algorithm . in this way",
    "the algorithm explores the network space , approaching the desired point and sometimes reaching it .",
    "the high computational cost of this experiment makes difficult to operate with larger networks .",
    "however , it is worth to note that their small size provides an advantage for the evolutionary search in the change of the network configuration since few changes in the connections have by general a deep impact in their structure . in this way",
    "the use of small network sizes contribute to an efficient exploration , providing a coarse grained picture of network reachability .",
    "( [ fig : accessibility ] ) reveals that the cloud of null models represented in fig .",
    "( [ fig : fig_2]b ) is easily accessible , as indicated by the dark blue color of the region .",
    "as expected hierarchical ( @xmath17 ) and anti - hierarchical regions ( @xmath18 ) are quite symmetric .",
    "deviations are due to the dispersion produced by the finite - size statistics , specially when the resulting @xmath7 become very little , by the imposition of a high number of cycles , as it happens for @xmath82 .",
    "this is the reason why , at @xmath82 , reachability is rather heterogeneous .",
    "the solutions for this orderability are only possible by forcing to the network population to exhibit a large fraction of the nodes within cycles .",
    "this constraint inevitably produces a @xmath7 with just a handful of nodes .",
    "then , as it happens for a broad number of topological measures , values of @xmath13 and @xmath14 are extremely sensible to small variations in network configurations .",
    "such a trend is less dramatic when @xmath15 increases ( see @xmath83 and @xmath84 of fig .",
    "[ fig : accessibility ] ) since the fraction of nodes belonging to cycles is small enough to produce a rich combination of configurations in the resulting node - weighted condensed graphs .    however , the most interesting results here concerns the presence of inaccessible regions , labeled in dark red color .",
    "low levels of @xmath15 seem to reduce the space of possible conformations . at @xmath82",
    "the extremes of @xmath13 and @xmath14 are inaccessible under our _ in silico _ evolutionary experiments .",
    "such a behavior is relaxed at @xmath83 here , a large region of high reachability is observed for extreme values of @xmath13 but , not occupied by real networks .",
    "this may indicate that a part of @xmath12 is accessible and yet not occupied , suggesting that the spontaneous correlations created by random fluctuations provide the source of order for free . as a consequence ,",
    "non- adaptive processes would have played a major role in shaping hierarchies in nature @xcite .    finally , an interesting trend is observed when @xmath15 approaches its upper bound .",
    "the larger @xmath15 , the more reduced is the range of the _ possible _ of @xmath14 .",
    "close to @xmath85 , there only exists graph configurations for @xmath86 , coinciding with feedforward networks encompassing , electronic circuits and software networks .",
    "of the appendix for algorithm definition ) . to study the reachability of the regions of @xmath12 ,",
    "the space was evenly spaced in 300 target points @xmath79 distributed in a partition of @xmath87 of the @xmath88 plane and three values of @xmath89 .",
    "target points are labeled by crosses in the charts .",
    "selection operated during @xmath90 generations .",
    "color indicates at which generation were acquired every grid in an average of 250 evolutionary experiments .",
    "blue squares indicate that they are -in average- accessible after a few rounds of the process whereas red ones are unreachable before @xmath91 iterations.,width=264 ]",
    "both biological and cultural evolution operate under a number of deep constraints @xcite .",
    "some of them result from the underlying rules of network growth and change , which strongly limit the repertoire of potential designs . an important question posed by evolutionary theory",
    "is the nature and relevance of such constraints in shaping the space of the possible .",
    "our study provides a rationale for exploring the possible and the actual in complex networks under a static view dominated by causal relations among components and modules . in this context",
    ", the inclusion of functionality , dynamics or weighted structures has not being taken into account and should be the object for further work . by defining a general space of hierarchical webs , we are able to detect the presence of a rather limited domain occupied by real and random null - models .",
    "the large voids surrounding these clusters of webs ( defining four major groups ) are partially inaccessible and partially reachable , as shown by means of a directed evolution algorithm .",
    "the majority of webs display a balance between integration of multiple signals and control over multiple targets under a bow - tie structural pattern .",
    "the computational nature of regulatory networks and the combination of layers and cycles common to energy flows in food webs separate them from this large cluster .",
    "the matching of random and real webs in the first two clusters suggests that their hierarchical features can be accounted for from the spontaneous correlations associated to random graphs of a given degree , indicating that the observed webs are simply the most probable ones . by connecting network theory with theoretical morphology a powerful picture of",
    "complexity emerges , which allows us to both characterize hierarchical order and provide an evolutionary framework to explain how hierarchy emerges in nature .",
    "the formalism presented in this work provides a suitable framework for the quantitative approximation for the study of hierarchical organizations , and links to non - equilibrium thermodynamics could be defined in the future , attending the similarity of certain approaches @xcite .",
    "further effort in the inclusion of the strength of relations among elements from empiric data as weighted graphs would contribute for a more accurate view of the hierarchy of systems .",
    "future work in the development of generative models for the study of the emergence of hierarchy will be of strong interest in the study of dynamics in the exploration of the limits of what is possible for natural , technological and social organizations .",
    "we would like to thank the members of the lab for useful discussions .",
    "rvs thanks d. erwin , e. smith , g. west and m. gell - mann for useful discussions on hierarchy .",
    "we thank olaf sporns for useful comments .",
    "we thank wormbase , vladimir batagelj and andrej mrvar for pajek dataset and mark newman for his network dataset .",
    "this work has been supported by grants of the james mcdonnell foundation , the botn foundation and by the santa fe institute",
    ".    10    simon ha ( 1962 ) the architecture of complexity .",
    "_ proceedings of the american philosophical society _ 106:467482 .",
    "mihm j , loch ch , wilkinson dm , huberman ba ( 2010 ) hierarchical structure and search in complex organizations .",
    "_ management science _ 56:831848 .",
    "amaral mhr , loch ch , wilkinson d , huberman ba ( 1996 ) scaling behaviour in the growth of companies .",
    "_ nature _ 379:831848 .",
    "guimer r , danon l , daz - guilera a , giralt f , arenas a ( 2003 ) self - similar community structure in a network of human interactions .",
    "_ phys rev e stat nonlin soft matter phys _ 68:065103 .",
    "valverde s , sol rv ( 2007 ) self - organization versus hierarchy in open - source social networks .",
    "_ phys rev e stat nonlin soft matter phys _ 76:046118 .",
    "krugman pr ( 1996 ) confronting the mystery of urban hierarchy .",
    "_ journal of the japanese and international economies _ 10:399418 .",
    "batty m , longley p ( 1994 ) _ fractal cities : a geometry of form and function _",
    "( academic press , san diego , ca and london ) .",
    "west g , brown j , enquist b ( 1997 ) a general model for the origin of allometric scaling laws in biology .",
    "_ science _ 276:122126 .",
    "ma h , buer j , zeng a ( 2004 ) hierarchical structure and modules in the escherichia coli transcriptional regulatory network revealed by a new top - down approach . _",
    "bmc bioinformatics _ 5:199 .",
    "yu h , gerstein m ( 2006 ) genomic analysis of the hierarchical structure of regulatory networks .",
    "_ proc natl acad sci u s a _",
    "103:1472414731 .",
    "cosentino - lagomarsino m , jona p , bassetti b , isambert h ( 2007 ) hierarchy and feedback in the evolution of the escherichia coli transcription network .",
    "_ proc natl acad sci u s a _ 104:55165520 .",
    "n , yan k , gerstein mb ( 2010 ) analysis of diverse regulatory networks in a hierarchical context shows consistent tendencies for collaboration in the middle levels .",
    "_ proc natl acad sci u s a _ 107:68416846 .",
    "rodrguez - caso c , corominas - murtra b , sol rv ( 2009 ) on the basic computational structure of gene regulatory networks .",
    "_ mol biosyst _ 5:161729 .",
    "erwin dh , davidson eh ( 2009 ) the evolution of hierarchical gene regulatory networks .",
    "_ nat rev genet _ 10:141148 .",
    "hirata h , ulanowicz r ( 1985 ) information theoretical analysis of the aggregation and hierarchical structure of ecological networks .",
    "_ j. theor .",
    "_ 116:321341 .    wickens j , ulanowicz r ( 1988 ) on quantifying hierarchical connections in ecology . _ j. social biol .",
    "_ 11:369378 .",
    "rodrguez - iturbe i , rinaldo a ( 1996 ) _ fractal river basins : chance and self - organization _ ( cambridge university press , cambridge ( uk ) ) .",
    "kaiser m , hilgetag cc , r. k ( 2010 ) hierarchy and dynamics of neural networks .",
    "_ frontiers in neuroinformatics _ 4:112 .",
    "eldredge n ( 1985 ) _ unfinished synthesis : biological hierarchies and modern evolutionary thought .",
    "_ ( oxford u. press , new york . ) .",
    "mcshea dw ( 2001 ) the hierarchical structure of organisms .",
    "_ paleobiology _ 27:405423 .",
    "lane d ( 2006 ) _ hierarchy in natural and social sciences _ , ed pumain d ( springer , dordrecht ) , pp 81119 .",
    "ravasz e , somera al , mongru da , oltvai zn , barbasi al ( 2002 ) hierarchical organization of modularity in metabolic networks .",
    "_ science _ 297:15511555 .",
    "vzquez a , pastor - satorras r , vespignani a ( 2002 ) large - scale topological and dynamical properties of the internet . _ phys rev e stat nonlin soft matter phys _ 65:066130 .",
    "trusina a , maslov s , minnhagen p , sneppen k ( 2004 ) hierarchy measures in complex networks .",
    "_ phys rev lett _ 92:178702 .",
    "clauset a , moore c , newman mej ( 2008 ) hierarchical structure and the prediction of missing links in networks . _",
    "nature _ 453:98101 .",
    "corominas - murtra b , rodrguez - caso c , goi j , sol r ( 2011 ) measuring the hierarchy of feedforward networks . _",
    "chaos _ 21:016108 .",
    "dehmer m , borgert s , emmert - streib f ( 2008 ) entropy bounds for hierarchical molecular networks .",
    "_ plos one _ 3:e3079 .",
    "rammal r , toulouse g , virasoro ma ( 1986 ) ultrametricity for physicists .",
    "_ 58:765 .",
    "song cm , havlin s , makse ha ( 2006 ) origins of fractality in the growth of complex networks .",
    "_ nature physics _ 2:275281 .",
    "nicolis js ( 1986 ) _ dynamics of hierarchical systems : an evolutionary approach _ ( springer - verlag , london , uk ) .",
    "mones e , vicsek l , vicsek t ( 2012 ) hierarchy measure for complex networks .",
    "_ plos one _ 7:e33799 .",
    "niklas kj ( 1994 ) morphological evolution through complex domains of fitness .",
    "_ proc natl acad sci u s a _ 91:67726779 .",
    "mcghee gr ( 1999 ) _ theoretical morphology .",
    "the concept and its applications . _",
    "( colombia university press .",
    "new york ) .",
    "thomas rd , shearman rm , stewart gw ( 2000 ) evolutionary exploitation of design options by the first animals with hard skeletons .",
    "_ science _ 288:12391242 .",
    "shoval o , et  al .",
    "( 2012 ) evolutionary trade - offs , pareto optimality , and the geometry of phenotype space . _",
    "science _ 336:11571160 .",
    "schuetz r , zamboni n , zampieri m , heinemann m , sauer u ( 2012 ) multidimensional optimality of microbial metabolism .",
    "_ science _ 336:601604 .",
    "whyte ll , wilson ag , wilson dm ( 1969 ) _ hierarchical structures _",
    "( new york elsevier ) .",
    "kitano h ( 2004 ) biological robustness .",
    "_ nat rev genet _",
    "5:826837 .",
    "guimer r , arenas a , daz - guilera ( 2001 ) communication and optimal hierarchical networks .",
    "_ physica a _ 299:247252 .",
    "stelling j , sauer u , szallasi z , doyle f , doyle j ( 2004 ) robustness of cellular functions . _ cell _ 118:675685 .",
    "gross j , yellen j ( 1998 ) _ graph theory and its applications _",
    "( crc , boca raton , florida ) .",
    "bonchev d , rouvray d ( 2005 ) _ complexity in chemistry , biology , and ecology _ , mathematical and computational chemistry ( springer ) .",
    "zhao j , yu h , luo j , cao z , li y ( 2006 ) hierarchical modularity of nested bow - ties in metabolic networks . _",
    "bmc bioinformatics _ 7:386 .",
    "corominas - murtra b , rodrguez - caso c , goi j , sol rv ( 2010 ) topological reversibility and causality in feed - forward networks .",
    "_ new j. of phys . _ 12:113051 .",
    "broder a , et  al .",
    "( 2000 ) graph structure in the web . _ comput .",
    "_ 33:309320 .",
    "goi j , corominas - murtra b , sol rv , rodrguez - caso c ( 2010 ) exploring the randomness of directed acyclic networks .",
    "_ 82:066115 .",
    "white jg , southgate e , thompson n , brenner s ( 1986 ) the structure of the nervous system of the nematode caenorhabditis elegans .",
    "314:1340 .",
    "cancho rf , janssen c , sol rv ( 2001 ) topology of technology graphs : small world patterns in electronic circuits .",
    "_ phys rev e stat nonlin soft matter phys _ 64:046119 .",
    "jeong h , tombor b , albert r , oltvai zn , barbasi al ( 2000 ) the large - scale organization of metabolic networks .",
    "_ nature _ 407:651654 .",
    "ma h , zeng a ( 2003 ) reconstruction of metabolic networks from genome data and analysis of their global structure for various organisms .",
    "_ bioinformatics _ 19:270277 .",
    "ma h , et  al .",
    "( 2007 ) the edinburgh human metabolic network reconstruction and its functional analysis . _",
    "mol syst biol _ 3:135 .",
    "valverde s , sol rv ( 2005 ) logarithmic growth dynamics in software networks .",
    "_ europhysics letters _ 72:858864 .",
    "ma h , zeng a ( 2003 ) the connectivity structure , giant strong component and centrality of metabolic networks .",
    "_ bioinformatics _ 19:14231430 .",
    "allesina s , bodini a , bondavalli c ( 2005 ) ecological subsystems via graph theory : the role of strongly connected components .",
    "_ oikos _ 110:164176 .",
    "guimer r , sales - pardo m , amaral lan ( 2004 ) modularity from fluctuations in random graphs and complex networks .",
    "_ phys rev e stat nonlin soft matter phys _ 70:025101 .",
    "sol r , valverde s ( 2008 ) spontaneous emergence of modularity in cellular networks .",
    "_ journal of the royal society interface _ 5:129133 .",
    "marn j , sol rv ( 1999 ) macroevolutionary algorithms : a new optimization method on fitness landscapes .",
    "_ ieee transactions on evolutionary computation _ 3(4):272286 .",
    "smoot me , ono k , ruscheinski j , wang pl , ideker t ( 2011 ) cytoscape 2.8 : new features for data integration and network visualization .",
    "_ bioinformatics _ 27:431432 .",
    "lynch m ( 2007 ) the evolution of genetic networks by non - adaptive processes .",
    "_ nat rev genet _",
    "8:803813 .",
    "sol r , valverde s , rosals - casals m , kauffman s , farmer d , eldredges n ( 2013 ) the evolutionary ecology of technological innovations .",
    "_ complexity _ ( in press ) .",
    "rinaldo a , maritan a , colaiori f , flammini a , rigon r , rodrguez - iturbe and banavar j r ( 1996 ) thermodynamics of fractal networks _ phys .",
    "_ 76 , 3364 - 3367    wissner - gross a d and freer c e ( 2013 ) causal entropic forces _ phys .",
    "lett . _ 110 , 168702",
    "this appendix presents in a self - contained way the conceptual issues that lead us to the rigorous formalization of hierarchy in complex networks .",
    "although some of these concepts can be found in standard handbooks on graph theory -for example @xcite- , we present all them from scratch in order to provide the reader with a consistent and clear mathematical apparatus . the aim is to remove any inconsistency in notation when introducing original concepts .",
    "the type of object studied here is any kind of _ connected _ directed graph , i.e. , any directed graph composed by a single component .",
    "although the formalism could be applied over graph structures consisting in more than a single component -as usually happens when working with random graphs- we assume that unconnected components have no causal relation of any kind and , therefore , the concept of hierarchy looses any meaning .",
    "as we shall see , the possibility to relate parts of the system by means of the topological information is basic for our definition of hierarchy .",
    "the appendix is structured as follows : first we present in an axiomatic way the features a given system based on relations among objects must hold in order to be considered _ perfectly hierarchical_. deviations from this perfect configuration have to be properly quantified , giving rise to the three coordinates of the hierarchy .",
    "then , we provide the basis to work with , revising several basic definitions of directed graphs and some of their most salient properties .",
    "we focus our attention on the condensation operation and on the layered structure of the resulting condensed graph .",
    "basic definitions are followed by the proper definition of the hierarchy coordinates .",
    "such definitions are detailed and described with the aim of conveying the reader the flavor and intuitions that underlie them .",
    "once the formal framework is properly described we explore the regions of the defined morphospace occupied by model networks .",
    "this section is followed by the list of studied networks and the randomization methods we used to explore the relevance of the observed results .",
    "it is important to stress that the rigorous and systematic confrontation of real data with their randomized counterparts elucidates much of the possible origins of the observed patterns .",
    "finally , we explore the space of possible hierarchical configurations through an evolutionary algorithm whose rules are described in detail .",
    "the _ perfectly hierarchical system _ will have the following three properties :    * _ order _ , * _ reversibility _ and * _ pyramidal structure_.    let us be more precise .",
    "suppose we have a set @xmath92 and a set relation @xmath93 .",
    "let @xmath94 be the _ transitive closure of @xmath95 _ , , the transitive closure of a relation @xmath96 is the minimal transitive relation @xmath97 such that @xmath98 . see @xcite or @xcite .",
    "] we will say that @xmath95 _ is hierarchical _",
    "if @xmath95 has the following properties :    * _ order _ , @xmath99 ( _ there are no cyclic relationships : we can * order * the elements is a _ strict partial order_. @xmath100 is a strict partial order if it is i ) @xmath101 ( _ non - reflexive _ ) ii ) @xmath102 ) ( _ antysimetric _ ) and iii ) @xmath103\\rightarrow(\\langle a_i , a_j\\rangle\\in k)$ ] ( _ transitive _ ) . ] ) _ * _ reversibility _ @xmath104 ( _ there is only one commander for any commanded : the chain of commands is * reversible*_. ) * _ pyramidal structure _ + * a * ) @xmath105 ( _ a commander commands more than a single element . _ ) + * b * ) @xmath106 ( _ there is only a single element which is not commanded by another element . _ ) + * c * ) let @xmath107 be the set of commanders of element @xmath108 , i.e. : @xmath109 if @xmath110 are such that @xmath111 such that @xmath112 or @xmath113 , then @xmath114 ( _ all the elements of the bottom are subjected to a chain of commands of the same length .",
    "these last properties give the * pyramidal structure * of @xmath95 _ )    it is straightforward to realize that the directed , inverted _ tree _ in which all the arrows go _ downwards _ starting from a single root naturally emerges as the graphical description of the perfect hierarchical system -see fig . ( [ fig : postulates ] ) . the rigorous proof of this statement is given as a lemma in section [ sec : dags ] when the appropriate formalism is developed .",
    "* the measure of hierarchy must properly quantify the deviations from this perfect structure , considering these three postulated properties . *",
    "the whole set of relationships between elements of the systems under scrutiny define a _ directed graph_. in any directed graph , links describe some kind of causal relation between two elements of the set which is considered relevant for the system .",
    "we thus begin revising several facts about directed graphs .",
    "these basic notions can be found in any standard textbook on graph theory , like @xcite .",
    "let @xmath115 be a directed graph , being @xmath116 , the set of nodes , and @xmath117 the set of arcs -where the order , @xmath118 implies that there is an arc in the following direction : @xmath119 . given a node @xmath120",
    ", the number of outgoing links , to be written as @xmath121 , is called the _ out - degree _ of @xmath4 , and the number of ingoing links of @xmath4 is called the _ in - degree _ of @xmath4 , written as @xmath122 .",
    "the _ adjacency matrix _ of a given graph @xmath8 , @xmath123 is a @xmath124 matrix where @xmath125 ; and @xmath126 otherwise . through the adjacency matrix , @xmath127 and @xmath128",
    "are computed as @xmath129    a _ path _ from node @xmath120 to node @xmath130 , @xmath131 in a directed graph is an alternated sequence of nodes and links : @xmath132 such that @xmath133 ( the @xmath134 subscript is due to the possible presence of more than a single path from @xmath4 to @xmath5 ) . the _ length _ of a path , @xmath135 is the number of edges appearing in the sequence .",
    "we observe that some edges can appear twice or more in the sequence . in that case , we take into account all appearances of the edge . since a path @xmath131 is an alternating sequence of nodes and links , it seems natural to define two sets : @xmath136 as the set of all nodes present in the path and @xmath137 , the set of all edges present in the path .",
    "then we define the set @xmath138 as the ( possibly infinite ) set of all paths that can be defined in @xmath8 .",
    "a _ cycle _ in a directed graph is the subgraph formed by the edges and nodes defining a path which begins and ends in the same node , i.e , if @xmath139 such that @xmath140 .",
    "the set of cycles of a given graph is @xmath141 .",
    "if @xmath142 is maximal , i.e. , @xmath143 then , @xmath144 is called a _ strongly connected component _ , hereafter @xmath10",
    ". we will refer to the set of @xmath10 s as @xmath145 .",
    "since every @xmath10 is itself a subgraph , we can refer to it as @xmath146 , where @xmath147 , @xmath148 are the nodes and the edges of @xmath149 , respectively .",
    "the _ underlying graph _ of a given directed graph @xmath8 , to be written as @xmath150 , is the undirected graph @xmath151 obtained by substituting all arcs of @xmath152 , @xmath153 by undirected edges giving the set @xmath154 .",
    "a directed graph @xmath8 is said to be _ connected _ if for any pair of nodes @xmath155 there is a finite , undirected path linking them ; i.e. , a finite sequence @xmath156 where @xmath157 . notice that now the links are depicted by unordered pairs , therefore @xmath158 .    given a graph @xmath0 , a _ component _",
    "@xmath159 is a maximal subgraph of @xmath8 by which , for every pair of nodes @xmath160 belonging to it there is an undirected , finite path linking them .",
    "we refer to the set of components of @xmath8 as @xmath161 it turns out that a connected graph has only one component , the graph itself . in general , we will work with connected graphs .",
    "it is worth to note that , connectedness may be lost during a randomization process but , as we shall see in section [ sec : realnetworks ] , the randomization methods we use respect the structure of components of the graph -i.e . , connectedness if it be .      a _ directed acyclic graph _ or _ feedforward graph _",
    "-hereafter , @xmath162- is a directed graph characterized by the absence of cycles .",
    "the first consequence of the absence of cycles is the non - existence of infinite paths within -a finite- @xmath8 .",
    "@xmath162s have been also referred to as _ ordered graphs _ because it is always possible to _ topologically sort _ a @xmath162 @xcite .",
    "a topological sorting consists in numbering all the nodes @xmath163 in such a way that arcs always point to nodes having higher numerical label than their origin , i.e. , for any pair @xmath164 such that @xmath165 , then @xmath166 this property will be crucial to justify the link between hierarchy , order and causal relation .",
    "this sorting implies that a @xmath162 can represent a more or less entangled structure of interconnected causal processes .",
    "we stress in the analogy between order theory and @xmath162 structures by defining following set : @xmath167 to be named the set of _ maximal nodes _ of @xmath8 .",
    "complementarily , one can define the set of nodes @xmath24 as @xmath168 which will be referred to as the set of _ minimal nodes _ of @xmath8 .",
    "the set of all paths @xmath169 , from @xmath23 to @xmath170 is indicated as @xmath171 .",
    "given a node @xmath172 , the set of all paths from @xmath23 to @xmath4 is written as @xmath173 we observe that the length of the _ longest _ path of a finite @xmath162 is always bounded .",
    "we will refer to this numerical value as @xmath174 which , taking into account the properties of the powers of the adjacency matrix , can be straightforwardly obtained : @xmath175    a special type of @xmath162 is to be defined now , since , as we will show below , depicted the perfect hierarchy .",
    "a _ directed tree _ in which _ all the leafs have the same length _ is a @xmath162 with @xmath176 in which all elements but the one in @xmath23 have @xmath177 , either @xmath26 or @xmath178 and in which @xmath179 , if @xmath180 , then @xmath181 -the _ leafs _ are all paths going from @xmath23 to @xmath24 .",
    "see figure ( [ fig : postulates ] ) for an example of this kind of graph .",
    "let us now take the set - theoretic framework used at the beginning of this document and replace @xmath182 by @xmath183 ( the set of nodes ) and @xmath95 by @xmath184 ( the set of links ) .",
    "now we have a graph representation of the kind of relations that display a perfect hierarchical organization .",
    "it turns out that the type of graph defined above satisfies all the postulates defined in [ sec : postulates ] is the graphical representation of a perfect hierarchical system .",
    "let us state is as a formal lemma :    * lemma * : _ under the hallmark described ( see postulates , section [ sec : postulates ] ) , the kind of graph @xmath8 depicting the perfect hierarchy is a directed tree in which all the leafs have the same length . _    * proof * : by the _ order _ property , @xmath8 has no cycles . by the _ reversibility _ property the graph nodes of the graph have either @xmath25 or @xmath177 . by the _ pyramidal _ property * a ) * the nodes have either @xmath26 or @xmath178 . by",
    "property * b ) * the graph is connected and @xmath176 and by _ pyramidal _ property * c ) * , if @xmath180 , then @xmath179 , then @xmath181 ( notice that there is only one path to go from @xmath185 to a given @xmath186 ) .",
    "therefore , @xmath8 is _ directed tree _ in which _ all the leafs have the same length_.    now that we have the mathematical characterization of the perfectly hierarchical graph , we restart the conceptual presentation that will help us to properly evaluate deviations from the ideal graph .      now we consider again the wide class of directed graphs , not only @xmath162s .",
    "let @xmath187 be the set of @xmath10s .",
    "we will build the _ condensed _ graph of @xmath8 , to be referred to as @xmath7 , in which every @xmath10 is merged into a single node , maintaining the links that connect a node of such @xmath10 with nodes out of such @xmath10 .",
    "more formally , @xmath188,\\ ] ] i.e. , nodes of @xmath7 are either @xmath10s of @xmath8 or nodes that do not belong to any @xmath10 of @xmath8 .",
    "consistently , edges on @xmath189 connect nodes of @xmath190 in such a way that    @xmath191    it turns out that , by definition , @xmath7 is a @xmath162 .",
    "below we have an example of the condensation operation , step by step .",
    "we have a graph @xmath8 ( left ) .",
    "we then identify the @xmath10s of @xmath8 ( center ) and collapse all nodes belonging to a @xmath10 in a single node , thus obtaining @xmath7 ( right ) :        notice , as illustrated in figure ( [ fig : condenstion ] ) that @xmath7 is a @xmath162 , as expected .      a conceptual step beyond",
    "the condensed graph is the _ node - weighted _ condensed graph .",
    "all the computations presented in this paper will be performed over such a graph .",
    "let us formally describe it : in this graph , a weight @xmath11 is assigned to every node @xmath192 in the following way : @xmath193 therefore , the sequence of @xmath194 will be the sequence of weights of @xmath7 .",
    "clearly , @xmath195 in plain words , @xmath11 accounts for the number of nodes belonging to @xmath183 represented by a single node in @xmath190 . in the forthcoming example we detail the obtaining of such a graph from a given directed graph .",
    "we have the graph -left- ; then , we identify its @xmath10s -center- and , then , -right- we label the nodes of @xmath7 with their corresponding @xmath196 s :    .,width=302 ]      the objective of this section is to rigorously define the dissection in layers of a given @xmath162 .",
    "the non - cyclic nature of such graph structures enables us to define a finite set of layers .",
    "layers can be identified through a _",
    "backward _ or _ bottom up leaf removal _ ( @xmath197 ) algorithm or through a _",
    "forward _ or _ top down leaf removal _ ( @xmath198 ) algorithm .",
    "algorithm works as follows : given a @xmath162 @xmath8 , at every iteration we remove the nodes having @xmath25 until there is no node to remove .",
    "the set of nodes removed at every iteration define a layer of the @xmath162 .",
    "it is straightforward that the number of steps needed is @xmath199 and so is the number of layers .",
    "a @xmath197 algorithm works exactly in the same way , but removing nodes having @xmath26 .",
    "the interested reader can go to @xcite . ]",
    "although @xmath198 and @xmath197 algorithms identify the same number of layers , the specific composition of every layer is not necessarily the same .",
    "in addition , using these two algorithms , we can build two sets of subgraphs by successively removing layers of the @xmath162 .",
    "as we shall see , these two sets will be very useful to derive the proposed measure of hierarchy .",
    "accordingly , we define two partitions of @xmath190 , @xmath200 and @xmath201 .",
    "the number of layers relates to @xmath202 -see equation ( [ k])- as follows : @xmath203 the members of such partitions are the nodes defining the layers of the @xmath162 , computed by either a @xmath197 or @xmath198 algorithm -depending on which partition we generate , either @xmath204 or @xmath205 , respectively .",
    "specifically , using the bottom up approach -i.e .",
    ", using a @xmath197 algorithm- the first member of such partition is defined as the following subset of nodes : @xmath206 and , using the top - down approach -i.e .",
    ", using a @xmath198 algorithm- the first member is defined as , @xmath207 clearly , @xmath208 and @xmath209 . with the above subsets of @xmath210 we can define the graphs @xmath211 , and @xmath212 in the following way : @xmath213 and @xmath214 respectively . similarly , we build @xmath215 and @xmath216 as : @xmath217 which , in turn , enables us to derive @xmath218 , @xmath219 , @xmath220 and @xmath221 : @xmath222 in the general case , if @xmath223 , @xmath224 where @xmath225 it is worth to note that @xmath226 and that @xmath227 the two previous sequences of subgraphs can be ordered by inclusion , namely @xmath228 and @xmath229 the dissection of @xmath7 in the above described two sequences of subgraphs will enable us to exhaustively explore the role of all layers in the further hierarchy measure .",
    "we finally define the set @xmath41 , containing the graph @xmath7 and all non - empty subgraphs obtained by means of the application of a leaf removal algorithm ( either bottom up or top down ) and which contain at least one link : @xmath230 it is not difficult to check that @xmath231    let us provide an example in figure ( [ fig : leafremoval ] ) : starting from a @xmath162 ( left ) , we identify the layers @xmath232 using a @xmath197 algorithm ( center ) , and the layers @xmath233 using a @xmath198 algorithm ( right ) :     and @xmath234.,width=302 ]    furthermore , we can obtain the sequence of graphs ordered by inclusion @xmath235 -notice that the last graph consists of two isolated nodes :    .,width=302 ]    and the sequence of graphs ordered by inclusion @xmath236 :    : , width=302 ]",
    "this section is devoted to the formalization of a quantitative descriptor of hierarchy .",
    "such a descriptor is defined from three hierarchy coordinates .",
    "these three coordinates are : _ orderability _ ( @xmath15 ) , _ feedforwardness _ ( @xmath14 ) and _ treeness _ ( @xmath13 ) .",
    "thus , any directed graph will define a point in such space , described as follows : @xmath237 from the coordinates of @xmath55 we can extract information about the structure of the net under the conceptual background of hierarchy presented in section [ sec : postulates ] based on the concepts of _ order _ , _ reversibility _ and _ pyramidal structure_. through the values of these coordinates we must be able to identify and properly quantify deviations from such an ideal behavior . as we shall see , such three components naturally arise as long as we go in depth in our inquiry for a hierarchy estimator .",
    "the order @xmath238 derives from clarity issues related to the visualization . for the sake of clarity in the exposition",
    ", however , the order of the sections in which we present such measures will not follow such @xmath239 structure .",
    "instead , we define the coordinates in such a way that we go from the simplest ( @xmath15 ) to the most complex one ( @xmath13 ) .",
    "we are now ready to define the coordinates of hierarchy .",
    "_ this is the @xmath240 coordinate of @xmath55_.    the _ orderability _ , @xmath15 , of the graph @xmath8 is the fraction of nodes not belonging to any cycle -which are , by definition , non - orderable structures . in a more formal way ,",
    "let @xmath8 be a directed graph and @xmath7 be its condensed counterpart .",
    "the orderability of the graph @xmath53 is defined as : @xmath241 in terms of the node - weighted condensed graph , we can rewrite the above expression as : @xmath242    let us provide an example : in the graph depicted below ( left ) , @xmath243 , @xmath244 ( right ) .",
    "the grey circle depicts a condensed @xmath10 .",
    "@xmath245 , therefore , @xmath246 :        this is a raw indicator of the fraction of the net that can be ordered . a tree or ,",
    "more generally , a feed - forward network will display @xmath63 , in agreement to their orderable nature .",
    "in contrast , a network which is totally cyclical would display @xmath65 .",
    "_ this is the @xmath247 coordinate of @xmath55_.    beyond the nodes than can be ordered , now we want to know the impact of the non - orderable regions of the graph over the potential causal paths described by it . in raw words , where , within the causal flow , we find the non - orderable regions .",
    "this is captured by the to - called _ feedforwardness _ , @xmath49 , a measure centered on the paths of the graph @xmath7 beginning in the set of maximal nodes , @xmath23 -see equations ( [ maximalset ] , [ minimalset ] ) and ( [ pimmu ] ) .",
    "specifically , for every path going from @xmath23 to @xmath248 , , @xmath249 , unless the contrary is indicated . ]",
    "we define a function , @xmath14 , which evaluates the quotient between the number of nodes and the overall weight of the path . to cover all nodes of the graph",
    ", the numerical value of the coordinate will be averaged over the sequence of graphs obtained when applying a @xmath197 algorithm . if @xmath7 is finite both @xmath23 and @xmath250 are finite and we can safely compute averages of these observables .    to put the things in a more concrete way ,",
    "let @xmath8 be a graph and @xmath7 its condensed counterpart .",
    "if @xmath251 , we define the function @xmath14 of @xmath33 , @xmath252 , as : @xmath253 for example , if we take the graph studied above and we choose the highlighted path , to be named @xmath254 :        we have that @xmath255 .",
    "to compute the overall average we then build the function @xmath256 : @xmath257 and we compute @xmath258 -see section [ sec : dissection ] for the definition of @xmath259 s : @xmath260 we finally average over all @xmath8 s and @xmath7 , skipping @xmath261 because , by its very definition , this graph has no paths : @xmath262 and , for the sake of consistency , if the graph consists in a single node , @xmath263 the interested reader can check that , with equation ( [ eq : fop ] ) , we cover all paths from @xmath23 to @xmath250 .    again",
    ", we will find @xmath60 in @xmath162s , as well as @xmath264 in networks consisting of a single strongly connected component .",
    "the combination of @xmath53 and @xmath49 tells us how are cycles located within the net and the impact they have in the order of the structure .",
    "the combination of @xmath53 and @xmath49 , thus , provides us interesting information on how the net is globally organized .",
    "_ this is the @xmath265 coordinate of @xmath55 . _",
    "this measure accounts for the _ reversibility _ and the _",
    "pyramidal structure_. the forthcoming coordinate is of information - theoretic nature and can only be computed over the condensed graph @xmath7 , since it can only be defined over @xmath162s .",
    "the impact of cycles ( non - orderable regions of the graph ) is already evaluated by the two previous indicators .",
    "this new coordinate largely relies on the computation of a special kind of entropies which , for the sake of brevity , are not going to be derived in detail here .",
    "we refer the interested reader to @xcite .",
    "intuitively , we first observe that deviations from reversibility can be properly captured measuring the uncertainty in reversing a given path , a measure called _ topological reveresibility _",
    "this measure of uncertainty is provided by the statistical entropy over the set of paths present in a given graph .",
    "it turns out that deviations of the pyramidal structure can be also quantified through an information - theoretic measure , namely , from the difference between the amount of statistical entropy generated when we cross the graph according to the flow direction depicted by the arrows and the uncertainty in reversing the paths @xcite .",
    "the spirit of the measure is to compare the creation of alternatives -new paths- in a top down exploration of the @xmath162 against the irreversibility of these paths .",
    "if the quantification of the uncertainty in reversing the paths displays a lower value than the quantification of alternatives , we say that , qualitatively , the net shows a pyramidal structure .",
    "if the creation of new paths in a top down exploration of the graph is quantitatively equal to the uncertainty in reversing them , then , there is no argument to attribute to the net any pyramidal shape .",
    "finally if the situation is opposite to the former one , the graph will display a funnel - like or inverted pyramid structure .",
    "below we present the above mentioned entropies in more detail .",
    "let @xmath8 be a directed graph and @xmath266 its condensed counterpart .",
    "let @xmath267 be the adjacency matrix of @xmath7 .",
    "we first define the @xmath268 matrix @xmath269 in the following way : @xmath270 and @xmath271 . from this definition ,",
    "we obtain the explicit dependency of the probability of crossing @xmath5 when we start to reverse a path from @xmath4 , @xmath272 .",
    "thanks to the @xmath162-like nature of the condensed graph , we can compute such a probability directly from the powers of the adjacency matrix @xcite , namely , @xmath273^k({\\cal    g})\\right)_{ij}. \\label{phi(b)}\\ ] ]    .",
    "we have @xmath274 different paths ( center , inside the rectangle ) to reach @xmath196 from the top -the maximal nodes .",
    "so there is _ uncertainty in reversing the path_. finally ( right ) , we observe that there is no uncertainty in reversing the causal path that ended in @xmath275 , since there is only one path to go to @xmath275 from the maximal nodes . in this graph @xmath276 due to",
    "the uncertainty arisen when reversing the paths that ended in @xmath196.,width=302 ]    now we compute the average amount of uncertainty we have to face when _ reversing _ a path . specifically , we have path starting at some node in @xmath23 and ending at node @xmath277 .",
    "we want to know the uncertainty of recovering this path if we go backwards , i.e. , from the node @xmath278 to a given node in @xmath23 .",
    "this average uncertainty is provided by the following entropic functional @xcite : @xmath279      .",
    "we have @xmath280 different paths ( center , inside the rectangle ) to reach a node belonging to the set of minimal nodes .",
    "so there is _ uncertainty in following the path_. finally ( right ) , we observe that there is no uncertainty in following the causal path that begun in @xmath196 , since there is only one path to go from @xmath196 to the minimal nodes . in this graph , @xmath281 , due to",
    "the uncertainty arisen in following the paths starting in @xmath275.,width=302 ]    now we compute the forward version of the above defined entropy . in this case , we need to compute the probability to cross node @xmath282 departing from @xmath29 according to the causal flow -not reversing it , as above .",
    "the explicit expression of this probability is defined from matrix @xmath283 : @xmath284 and @xmath285 , @xmath286 .",
    "then , in analogy to what we found above -equation ( [ phi(b)])- , we have that the probability to cross node @xmath5 if we started a path in @xmath4 is @xmath287^k({\\cal g})\\right)_{ij}. \\label{phi(b1)}\\ ] ] the average of the amount of uncertainty emerging when we want to follow a path from which we know that starts in a given @xmath29 and ends in a given node of @xmath24 will now be @xcite : @xmath288 where @xmath23 is the set of maximal nodes .",
    "and @xmath20 grasp the hierarchical nature of graphs .",
    "the graph on the left displays @xmath289 and it is thereby hierarchical . on the contrary , the graph on the center displays @xmath290 , being thus _ anti_hierarchical .",
    "finally , on the right we have a graph such that @xmath291 , thus it is neither hierarchical nor anitihierarchical.,width=302 ]    the presented coordinate compares the creation of new paths following the causal flow defined by the arrows against the uncertainty to reverse them .",
    "the creation of new paths is due to the existence of more than a single alternative to leave a given node .",
    "if we create new paths we are thus creating information -quantified by @xmath20 .",
    "however , such information can be destroyed by the uncertainty in reversing the paths -evaluated by @xmath21 . intuitively , a graph having pyramidal structure will have the balance @xmath292 positive , whereas a graph having inverted pyramidal structure will display @xmath292 negative . a completely random @xmath162 displays @xmath291 @xcite .",
    "it turns out that , properly manipulated , such information measures are the perfect indicators of the pyramidal properties of the graph , a key ingredient of our hierarchy coordinates .    in order to generate a normalized estimator ( between @xmath293 and @xmath294 ) accounting for the balance between @xmath295 and @xmath36",
    "we define @xmath296 as follows : @xmath297 the _ treeness coordinate of a @xmath162 _ , to be indicated as @xmath40 , will be the average among the @xmath298 subgraphs @xmath299 , the @xmath298 subgraphs @xmath300 and @xmath8 itself , i.e. , the set @xmath41 defined in equation ( [ eq : defw ] ) , and @xmath301 because they contain no links by definition , and , therefore , would impact to the computation of the hierarchy without justification , and ii ) consistently , we compute the average between @xmath302 objects , the sie of the set @xmath41 defined in equation ( [ eq : defw ] ) . ]",
    "i.e. : @xmath303 where @xmath304 is the set of subgraphs of @xmath7 obtained through the application of a lead removal algorithm ( either bottom up or top down ) and which contain at least one link , as defined in equation ( [ eq : defw ] ) .     and @xmath305",
    ". however , the two graphs on the right contains a violation on the hierarchy assumptions , namely , the need for _ pyramidal _ structure at all levels .",
    "the dissection allows to identify and penalize such deviations .",
    ", width=302 ]    for the sake of consistency we explicitly define the behavior of some limit , potentially problematic cases .",
    "when obtaining the sequence of @xmath8 s and @xmath306 s the graph can break into more than a single connected component .",
    "let @xmath307 the set of components of our graph @xmath308 , let @xmath309 be the set of nodes of the @xmath310-th component of @xmath259 and let @xmath311 the set of nodes of the @xmath310-th component of @xmath312 .",
    "the parameter @xmath313 is evaluated averaging the individual contributions of the different connected components of @xmath259 or @xmath312 according to the number of nodes they have against @xmath314 or @xmath315 , the set of all nodes of @xmath259 and @xmath312 , respectively , leading to : @xmath316 @xmath317    we impose , for both mathematical and conceptual consistency , that : @xmath318 furthermore , if @xmath319 , ( i.e. , the case where the graph consists of a single node ) : @xmath320              these three coordinates enabled us to define a morphospace , @xmath12 , in which every net will be represented by a point @xmath321 in this space .",
    "the coordinates defining such space are thought of to grasp the essentials of _ hierarchy _ , taking as the canonical hierarchical structure the one satisfying the postulates presented in section [ sec : postulates ] .",
    "additionally , as we have seen , comparison between coordinates also provides us valuable information concerning the whole structural organization of the net .",
    "for example , the relation between @xmath15 and @xmath14 enables us to estimate how many cyclic regions are in the graph and at what point of the causal flow they are located .",
    "in addition , they provide an estimator of relevance of coordinate @xmath13 , since low values of @xmath322 indicate us that the net is mainly cyclical and that the feed - forward - like analysis provided by @xmath13 is less relevant than in the case where @xmath323 are close to @xmath294 . to test the consistency of this coordinate system",
    ", we will rigorously check the behavior in several extreme and paradigmatic cases :    * lemma*:_g displays @xmath324 if and only if @xmath8 is a directed tree in which all the leafs have the same length , as defined in section [ sec : directedgraphs ] .",
    "_    * proof*@xmath325 @xmath326 by definition , this graph is a @xmath162 , therefore , @xmath62 .",
    "furthermore , all its nodes but the one in @xmath23 have @xmath177 , which means that @xmath327 and , since all but the set of minimal nodes will display @xmath178 , then : @xmath328 and , thus ,    @xmath329    the above claims are also true for the whole graph @xmath8 therefore , all the @xmath302 quotients of the type shown in equation ( [ eq : f ] ) involved in the computation of @xmath40 will have a value value equal to @xmath294 , which leads to @xmath330 .",
    "@xmath331 if @xmath62 , then @xmath8 is a @xmath162 . to see that @xmath330",
    ", it is enough to realize that the graph must satisfy equations ( [ eq : h_b=0 ] , [ eq : h_b>0 ] ) and that this can only happen if @xmath8 is a directed tree in which all the leafs have the same length .",
    "we observe that , if the laves have not the same length , then a @xmath332 will emerge in some computation , lowering the value to @xmath333 .",
    "* corollary * : _",
    "@xmath8 displays @xmath334 if and only if @xmath8 is a directed tree in which all the leafs have the same length , as defined in section [ sec : directedgraphs ] but with changing the direction of all arrows .",
    "_    this latter case would belong to the perfect _ antihierachical _ system .",
    "a graph consisting in a big cycle will be the paradigmatic example of _ non - hierarchical _ system , showing thus @xmath335 .",
    "finally , a graph consisting of a chain of nodes , or a @xmath162 in which all the layers have the same size and all nodes the same connectivity will be the paradigmatic example of _ non - hierarchical _ but _ ordered system _ , showing @xmath336 .",
    "an illustration of the gallery of conformation on the region of possible networks in the @xmath12 space is provided in figure ( [ fig : toys ] ) .",
    "notice that some regions of the morphospace can not be occupied by the very definition of the measures , while others represent strange configurations .",
    "it is worth to note that it is mathematically possible to apply this formalism to networks containing more than one connected component .",
    "however , meaningful information can only be obtained from the study of a single component since it represents a unique causal structure .    in figure ( [ fig:1 ] )",
    "we detail the computation of the hierarchy coordinates of a given graph . from the original directed graph ,",
    "the process of strongly connected component ( @xmath10 ) detection and condensation give rise a node - weighted condensed graph by from the original graph . from this graph ,",
    "the three coordinates are computed .",
    "we will now provide estimations for the hierarchy coordinates in random directed graphs .",
    "a word of caution is needed .",
    "exact calculations of the above presented values are hard and far away from the scope of this work .",
    "we therefore will present the analytic results starting from some simplifying assumptions to obtain indications on what we should expect in the case of large , sparse random networks .",
    "we will focus on @xmath13 and @xmath15 , since the active presence of paths and cycles in the computation of @xmath14 makes any rough estimation extraordinarily complex and of no practical use .",
    "we are going to show that the expected value @xmath337 over an ensemble of random directed graphs is @xmath332 .",
    "the reasoning takes advantage of the internal symmetries of the ensemble and uses several critical assumptions which will be clearly highlighted .",
    "a totally rigorous derivation of this result would require a deep exploration of such assumptions , something that goes far from the main scope of the presented work .",
    "let us suppose that we have an undirected graph @xmath8 having adjacency matrix @xmath338 .",
    "now , _ every undirected link _ is transformed into a directed one and the direction of the arrow is defined at random with probability @xmath339 .",
    "let us define @xmath340 as the ensemble of all @xmath23 possible directed graphs we can build from @xmath8 by imposing a direction at random over the links present in such graph : @xmath341 let now @xmath342 be their respective adjacency matrices .",
    "in addition , let @xmath343 be the graph described by the transpose of the adjacency matrix of @xmath344 , @xmath345 .",
    "we observe that , since directions have been assigned at random : @xmath346 for any graph we can build , a graph with all the directions of the links switched can also be built up.we can therefore induce a partition in @xmath340 , @xmath347 , made of pairs of graphs of @xmath340 , namely : @xmath348 and , since this is a partition of @xmath340 , we highlight that @xmath349 these properties will be useful in the forthcoming derivations .",
    "we observe that the partition of the ensemble in pairs of graphs whose adjacency matrices are mutually transposed will also be possible after the condensation operation , therefore , if @xmath350 is the ensemble of all possible condensed graphs out of all directed graphs composing @xmath340 : @xmath351 ( notice that @xmath352 in most cases ) , then , @xmath353 also holds .",
    "this symmetry within the ensemble @xmath354 is found as long as @xmath339 , i.e. , directions of links are totally imposed at random .",
    "we keep this in mind and we proceed to compute the expected value of the backwards and forward entropy over the ensemble , @xmath355 , and we see that : @xmath356\\nonumber\\\\ & = & \\frac{1}{|g_{\\cal c}({\\cal g})|}\\left[\\sum_{{\\cal g}_{\\ell}^{\\cal c}\\in g_{\\cal c}({\\cal g}))}\\right.\\nonumber\\\\ & & \\left.\\frac{1}{|m_{\\ell}|}\\sum_{v_i\\in \\mu_{\\ell}}\\sum_{v_k\\in v\\setminus m_{\\ell}}\\mathbb{p}(v_i\\leftarrow v_k)\\cdot\\log k_{in}(v_k)\\right]\\nonumber\\\\ & = & \\langle h_b\\rangle\\nonumber,\\end{aligned}\\ ] ] where @xmath357 and @xmath358 stand for the maximal and minimal sets of @xmath359 . notice that the crucial step is the second equality , where we use the symmetry of @xmath350 described in equation ( [ eq : transponsedag ] ) .",
    "we therefore have that @xmath360 this tells us that @xmath361 .",
    "however , we can not jump directly to conclude that @xmath362 .",
    "using the same reasoning we used above , we compute @xmath363 : @xmath364 again , in the second step , we rearranged the terms of the sum by means of the partition @xmath365 -see equation ( [ eq : partition])- induced over the ensemble @xmath350 , thereby resetting all terms of the sum to zero .",
    "thus , we can conclude that : @xmath366 and , since it is true _ in general _",
    ", we have proven that given a graph @xmath8 , if we build an ensemble of random directed graphs @xmath340 using the procedure described at the beginning of the section , then : @xmath367 a couple of remarks are in force .",
    "@xmath368 the first one concerns the assumption that the ensemble @xmath350 is _ well behaved _ , which means that the averages collapse to the most probable value of a given observable .",
    "as we shall see , this assumption holds in general in ensembles of random graphs , and it seems reasonable to assume that this is independent of the degree distribution , as long as the graph is obtained using the random procedure presented above . @xmath369 the second remark concerns cycles containing @xmath370 nodes which , by construction , are avoided in the above developments .",
    "however , we observe that these bidirectional links already introduce a symmetry within the adjacency matrix under the transpose operation and , consequently , their presence would have no impact in equation ( [ eq : transponsedag ] ) and thus the reasoning still holds .",
    "we remark that this is what is observed in random graphs , independently of their degree distributions , as we see in figure ( 15 ) and in the forthcoming sections .     in an ensemble of",
    "directed random graphs of size @xmath371 in terms of the average degree @xmath372 . as predicted by equation ( [ eq : predictiot ] ) ,",
    "values accumulate around @xmath19 . as the connectivity increases , the variance increases as well .",
    "this is due to the process of condensation , that reduces drastically the size of the graph , since most nodes belong -as we shall see in the next section- to a single cycle .",
    "therefore , the resulting condensed graph is very small and even being maximals directly connected to minimals , thereby revealing , in some cases , extreme values of @xmath13 , like @xmath293 or @xmath294.,width=309 ]      now we will obtain an estimate of the evolution of the @xmath15 coordinate .",
    "to this end we will use standard theory of generating functions applied to the emergence of giant components within a random graph .",
    "we will not develop the reasoning since this is far from the scope of the work and they it is clearly developed in @xcite , @xcite or @xcite .",
    "we recommend the interested reader to go to this literature and references therein .",
    "let us work with an ensemble of directed random graphs , @xmath0 .",
    "the undirected average degree will be thus : @xmath373 and the average @xmath374 and @xmath375 degree will be @xmath376 i.e. , since directions are spread at random , we assume that @xmath377 .",
    "it is well known that , in general , after a certain threshold of @xmath372 the _ giant connected component _ ( @xmath378 ) emerges , namely , a connected component of @xmath8 containing a finite fraction , @xmath379 , of the nodes of the graph @xcite . for",
    "directed graphs , in addition , we observe further the emergence of the _ giant strongly connected component _ , ( @xmath380 ) namely , a single @xmath10 containing a finite fraction @xmath381 of the nodes of the graph @xcite .",
    "the @xmath380 will represent the largest _ cyclic region _ of the graph .",
    "consequently , if we assume that small @xmath10s that can be also present within the graph represent a negligible fraction of it when compared to the size of the @xmath380 , one can approach the following : @xmath382 the @xmath383 term acts as a normalization factor over the connected fraction of the graph , since our hierarchy computations only make sense over fully connected structures .",
    "notice that the probability to have @xmath370 @xmath378 is vanishingly small @xcite and thus , with high probability @xmath384 therefore , the normalization of the relative size of the @xmath380 with the size of the @xmath378 provides us an estimation about the actual impact of cycles over the connected structure of the graph .",
    "we then use generating function methodology to obtain an estimate both @xmath385 and @xmath381 .",
    "let @xmath386 be the generating function of the degree distribution , @xmath387 , of the graph @xmath8 having average degree @xmath372 : @xmath388 then , following @xcite , we have that @xmath389 being @xmath390 the smallest positive solution of @xmath391 to obtain @xmath381 of the random directed graph , one proceeds in an analogous way : let now @xmath392 be the generating function of the joint @xmath374-degree and @xmath375-degree distribution , @xmath393 of a given random graph @xmath8 : @xmath394 following @xcite , we know that , if there is no correlation between @xmath374 and @xmath375-degrees @xmath395 , we can estimate the size of the @xmath380 as : @xmath396 where @xmath397 is smallest positive root of the following self - consistent equation : @xmath398 and , identically , @xmath399 is smallest positive root of the following self - consistent equation : @xmath400 we emphasize that this independence condition among @xmath127 and @xmath128 is a very strong one , consequently , results must be seen as a rough estimation of the qualitative behavior of the @xmath380 .    to obtain concrete results , we now turn to an ensemble of directed @xmath401 graphs with uncorrelated @xmath374 and @xmath375 degrees . in this ensemble , @xmath402 directed links are spread at random among pairs of the @xmath403 existing nodes .",
    "the @xmath374 and @xmath375 average degrees will be @xmath377 , and the degree distribution of the @xmath374 and @xmath375 binomial distribution around the above mentioned averages . under this framework",
    ", one has that : @xmath404 and @xmath405 thereby obtaining an interesting simplification of our problem , namely , @xmath406 thus , the above critical values read : @xmath407 and , from equation ( [ eq : predictioo ] ) , @xmath408 since , from equation ( [ eq : sgiant ] ) @xmath409 .    in figure",
    "( 16 ) we plot estimates of equation ( [ eq : oestimate ] ) and real values from an ensemble of erdos - renyi graph and we see that , despite the strong assumptions made , the behavior of @xmath15 can be clearly predicted from the mentioned equation , providing a good insight to the behavior of such coordinate .     in an ensemble of directed random graphs of @xmath410 in terms of the average degree @xmath372 .",
    "similar behaviour was obtained for ensembles of 500 nodes .",
    "the blue line contains the theoretical prediction provided by equation ( [ eq : oestimate ] ) and dots represent actual graphs of the ensemble . as we can see the fitting between real data and the theoretical prediction is , in spite the assumptions made , very good.,width=309 ]      in order to get insight about the behaviour of this coordinate we provide a numerical computation of f for an ensemble of increasing directed er networks .",
    "figure ( 17 ) shows the dramatic impact of @xmath411 in @xmath14 . in this case ,",
    "due to @xmath14 intrinsically depends on the diameter of the graph in the computation of the number of pathways from minimal to maximals in the condensed graph .",
    "it is not ignored by the authors that the drastic reduction of @xmath14 by increasing @xmath372 is tied to the impact of @xmath10 size affecting to the length of pathways in the condensed graph . however , we consider that to find this connection go beyond the aim of a work that pursue the presentation of a formalisation and characterization of the concept of hierarchy in the framework of a morphospace",
    ". further work in this direction will contribute to the analytical comprehension of the impact of @xmath411 in @xmath14 .",
    "all the theoretical work is thus finished . from now on , we will apply such machinery to the analysis of both model and real networks .     in an ensemble of",
    "directed random graphs of @xmath410 in terms of the average degree @xmath372 .",
    "similar behaviour was obtained for ensembles of 500 nodes.note the slight data dispersion at high @xmath411 values .",
    "this region correspond to connectivities where the resulting condensed graph is very little . in such circumstance ,",
    "variations in the position of the scc in node weighted condensed graph has a considerable impact of @xmath14 computation.,width=309 ]",
    "in this section we systematically study the location of both real and model networks in the morphospace defined by the three coordinates @xmath412 .",
    "we begin by studying classical models of random graphs , namely , the erds - rnyi ( er ) @xcite , the barabsi - albert preferential attachment ( ba ) @xcite and the callaway - hopcroft - kleinberg - newman - strogatz uniform attachment ( callaway ) @xcite .",
    "then , we evaluate the hierarchy coordinates of @xmath413 real networks belonging to different systems .",
    "the analysis of real nets is completed by confronting the obtained results with the exploration of the hierarchy coordinates of their corresponding randomized ensembles .",
    "we use two randomization methods which are exposed in detail .",
    "finally we present an in silico experiment of evolution of networks inside the morphospace . such analysis enables us to explore the accessibility of the space of possible configurations and sheds light on what is likely to observe in real systems .",
    "analysis of model networks obtained using the directed versions of er , ba and callaway models show similar results . in all cases , model networks having high connectivities aggregate around the region defined by the rectangle @xmath414 , @xmath415 @xmath416 .",
    "the high variance on the value of @xmath13 can be explained by the fact that @xmath7 is very small , since high connectivity produces a drastic process of condensation .",
    "it is easy to see that a network with a handful of nodes is more likely to give extreme values than large networks .",
    "departing from the value @xmath417 displayed at high connectivities , as connectivity decreases , @xmath15 starts to increase but nets still aggregate around @xmath418 and @xmath419 . for low connectivities ,",
    "@xmath13 values tend to be closer to @xmath19 but both @xmath14 and @xmath15 change their behavior , increasing their values to reach the region around the point @xmath420 .",
    "this latter situation can be explained by the low presence -or complete absence- of cycles in networks having small connectivities .",
    "actually , the region @xmath420 is only occupied by @xmath162s .",
    "results are shown in figure ( 2b - c ) of the main text * hierarchy in complex systems : the possible and the actual*.      * directed er graphs*.- we begin with the nets generated by the directed version of the erds rnyi model . such a model consists of two parameters , @xmath403 and @xmath421 , that specify the size of the network ( @xmath403 ) and the probability of connecting any pair by an arc in any direction ( @xmath421 ) . for @xmath422 , this model does not ensure connectedness until values of @xmath423 @xcite .",
    "an ensemble of @xmath424 graphs with three sizes ( @xmath425 ) was created following the following procedure : we create @xmath426 replicas for every graph size starting from @xmath427 .",
    "we repeated this process reducing @xmath421 in a step size of @xmath428 until a value of @xmath421 able to produce graphs with a fraction of vertices belonging to the giant connected component larger than @xmath429 .",
    "the resulting ensemble encompasses a range of @xmath430 . *",
    "directed callaway graphs*.- the uniform attachment @xcite is an iterative model consisting of three parameters , namely @xmath431 , @xmath432 and @xmath433 . starting on a fully connected set of @xmath431 nodes , during @xmath433 iterations a new node",
    "is added to the network .",
    "such node is linked to @xmath432 existing nodes .",
    "these nodes can be selected with equal probability , i.e. there is a _ uniform _ attachment .",
    "once the iterative process is finished , a random uniform orientation that converts links into directed arcs is performed in order to obtain a directed graph .",
    "an ensemble of @xmath434 directed graphs was generated considering @xmath426 replicas of networks for three different sizes(@xmath425 ) and four averages degrees ( @xmath435 ) .",
    "average degrees correspond with @xmath436 ; in each case , the seed is a clique of @xmath437 nodes .",
    "* directed ba graphs*.- the preferential attachment @xcite is an iterative model consisting of three parameters , namely @xmath431 , @xmath432 and @xmath433 .",
    "starting on a fully connected set of @xmath431 nodes , during @xmath433 iterations a new node is added to the network .",
    "such node is linked to @xmath432 of the existing nodes .",
    "these nodes are subject to be selected with a probability proportional to their degree , i.e. there is a preferential attachment . once the iterative process is finished , a random uniform orientation that converts links into directed arcs is performed in order to obtain a directed graph .",
    "an ensemble of @xmath434 directed graphs containing @xmath426 replicas of networks for three different sizes(@xmath425 ) and four averages degrees ( @xmath435 , corresponding to @xmath436 ) was generated .",
    "as above , the seed is a clique of @xmath437 nodes in all cases .      after looking at the properties of standard models of random networks",
    ", we explored a collection of @xmath413 networks encompassing @xmath70 types of systems obtained from real data .",
    "figure results are shown in figure ( 2d ) of the main text * hierarchy in complex systems : the possible and the actual * , shows the resulting @xmath438 morphospace for the real networks used in this work . to discuss the relevance of the observed results , we confronted data of real networks against the one obtained from their randomized counterparts .",
    "randomized ensembles were built using two different techniques of randomization .",
    "below methods and results are detailed , after the network data set presentation .",
    "label : neuronal in the fig 2 of the article .",
    "a directed , weighted network representing the neural network of _ c. elegans_. data compiled by d. watts and s. strogatz and made available at the mark newman s website : http://www-personal.umich.edu/mejn/netdata/ used in @xcite .",
    "original experimental data taken from @xcite .",
    "label : metabolisms in the fig 2 of the article .. metabolic network set is a selection of 19 reaction - metabolite directed networks obtained from three different published papers for different organisms :      networks obtained from the database published in @xcite .",
    "a selection of 5 multicellular animals : _",
    "h. sapiens _ ( hsa ) , _ m. musculus _ ( mmu ) , _",
    "d. melanogaster _",
    "( dme ) , _ r. novergicus _",
    "( rno ) and _ c. elegans _ ( cel )",
    ". one multicelular plant : _",
    "a. thaliana _",
    "two unicellular funghi : _ s. cerevisiae _ ( sce ) , _ s. pombe _ ( spo ) . and seven prokaryotes : _ p. aeruginosa _ ( pae ) , _",
    "e. coli _ ( eco ) , _ b subtilis _",
    "( bsu ) , _ mycoplasma genitalis _",
    "( mge ) , _ mycoplasma pneumoniae _ ( mpn ) , _ synechocystis sp .",
    "_ pcc6803 ( syn ) and _ salmonella typhimurium _ ( sty ) .",
    "label : food webs in the fig 2 of the article .",
    "these networks describes the exchange flow from the donor to recipient compartments where not necessarily nodes represent single species .",
    "the food web set contains a set of 22 directed weighted graphs in their original format . in this article",
    "were taken as unweighted directed graphs .",
    "food - webs were originally selected from the r.e .",
    "ulanowicz s collection from the ecosystem network analysis site and from atlss - network analysis of trophic dynamics in south florida ecosystems and compiled in the pajek dataset .",
    "source : http://vlado.fmf.uni-lj.si/pub/networks/data/bio/ foodweb / foodweb.htm .",
    "label : grns and kinase network respectively , in the fig 2 of the article .",
    "grns set contains the networks from two different articles .",
    "the data consists of directed networks where nodes are genes and arcs between two genes captures the interaction of the respective gene product -represented by the source node- over the regulatory region of the target gene -target node .",
    "the only one available kinase network at the present is represented by a directed network where nodes are proteins and arcs represents the relation of phosphorylation of a protein -node source- over the a target protein -node target .",
    "grns of _ s cerevisiae _ , _",
    "e. coli _ , _ mus musculus _ , _ ratus novergicus _ , _ homo sapiens _ and _ micoplasma tuberculosis _ and one kinase network of _ s cerevisiae _",
    "were taken from http://info.gersteinlab.org/hierarchy and published in @xcite .",
    "grns of _ s. cerevisiae _ , _",
    "e. coli _ , and _ bacillus subtilis _ taken from @xcite .",
    "label : word corpora in the fig 2 of the article.four directed lexical graph from different texts according the description in @xcite : `` angie s wren xmas tale '' ( paul auster ) , `` frankenstein or the modern prometeous '' ( mary shelley ) , `` ulisses '' ( james joyce ) , `` moby dick '' ( herman melville ) , `` black cat '' ( edgar allan poe ) and a fragment of the new york times column .",
    "label : citations in the fig 2 of the article . a directed and feedforward graph of citations networks .",
    "nodes are articles and every article points to the articles in which it is cited .",
    "papers that cite s. milgram s 1967 psychology today paper or use small world . taken from pajek dataset : http://vlado.fmf.uni-lj.si/pub/networks/data/      label : software in the fig 2 of the article .",
    "ten directed networks capturing the map of file dependencies in different software . in these networks",
    "every node is a file .",
    "if a file a is called from another file b , then b receives an arrow from a. although is generally avoided in programming , one file can content more than one function -argument- and therefore it can be called for more than one purposes .",
    "this feature would explain the appearance of cycles in some circumstances .",
    "eight networks were taken from @xcite .",
    "two additional networks were obtained from the internet : r package dependencies : taken from http://csgillespie.wordpress.com/2011/03/23/graphical-display-of-r-packages-dependencies/ java packages taken from : http://gd2006.org/contest/details.php#java      label : ownership in the fig 2 of the article .",
    "eva is a multidisciplinary research project combining information extraction , information visualization , and social network analysis techniques to bring greater transparency to the public disclosure of inter - relationships between corporations .",
    "this data corresponds with an ownership network with 6,726 relationships among 8,343 companies .",
    "http://denali.berkeley.edu/eva/ data obtained form pajek database : http://vlado.fmf.uni-lj.si/pub/networks/data/ econ / eva / eva.htm k. norlen , g. lucas , m. gebbie , and j. chuang .",
    "eva : extraction , visualization and analysis of the telecommunications and media ownership network .",
    "proceedings of international telecommunications society 14th biennial conference ( its2002 ) , seoul korea , august 2002 .",
    "label : social in the fig 2 of the article . a directed network of hyperlinks between weblogs on us politics , recorded in @xcite .",
    "data obtained from pajek database .",
    "original data was taken by pajek database from the mark newman s",
    "dataset http://www-personal.umich.edu/  mejn/ netdata/      label : social in the fig 2 of the article .",
    "the case is a small hi - tech computer firm which sells , installs , and maintains computer systems .",
    "the network contains the friendship ties among the employees , which were gathered by means of the question : who do you consider to be a personal friend ?",
    "a friendship choice ( arc ) is only included in the network if both persons involved acknowledge it .",
    "taken from http://vlado.fmf.uni-lj.si/pub/networks/data/esna/hitech.htm , published in @xcite .",
    "label : social in the fig 2 of the article .",
    "taken from pajek dataset http://vlado.fmf.uni-lj.si/pub /networks",
    "/ data / esna / modmath.htm .",
    "this network concerns the diffusion of a new mathematic method in the 1950s .",
    "this innovation was instigated by top mathematicians and sponsored by the national science foundation of the usa as well as the u.s .",
    "department of education .",
    "carlson , adoption of educational innovations ( eugene : university of oregon , center for the advanced study of educational administration , 1965 , p. 19 ) .",
    "label : genealogies in the fig 2 of the article .",
    "data taken from : http://vlado.fmf.uni-lj.si/ pub / networks / data / esna / csphd.htm .",
    "the network contains the ties between ph.d .",
    "students and their advisors in theoretical computer science ; each arc points from a supervisor to a student .",
    "the partition contains the ( estimated ) year in which the ph.d .",
    "was obtained .",
    "original author : david johnson ; maintained by ian parberry .",
    "the sigact theoretical computer science genealogy , last updated july 22 , 1996 . data taken as appeared in @xcite        in this randomization technique",
    ", we generate the ensemble of randomized graphs by taking as topological invariants the undirected degree sequence and the component structure .",
    "it is worth to note that the component structure is not preserved using a standard method of graph randomization under the so - called _ configuration model _",
    "approach @xcite .",
    "given an undirected graph @xmath0 , @xmath439 , its _ undirected degree sequence _",
    ", @xmath440 , is the sequence of @xmath441 integer numbers in which the @xmath433-th number depicts the undirected degree of node @xmath4 , @xmath442 in a given labeling @xmath443 of the nodes of the graph : @xmath444 let us suppose that such a graph has a given component structure @xmath445 .",
    "the randomization method applied here keeps invariant both @xmath440 and @xmath446 .",
    "this is performed using a _ directed _ version of the _ local swap _",
    "algorithm @xcite .",
    "_ local swap",
    "_ diverges from standard random rewiring algorithms because it keeps invariant the component structure of the graph .",
    "the figure below shows how we generate the randomized elements of the ensemble .",
    "let @xmath8 be a directed graph .",
    "we choose three links such that they form a chain of length three in @xmath447 , figure ( [ fig : localswapund ] , left ) , i.e. , a `` @xmath448 '' structure , no matter the direction of the arrows .",
    "then , we cross the links at the extremes of the chain , i.e. , generating a `` @xmath449 '' structure , figure ( [ fig : localswapund ] center ) . finally , we flip the senses of the arrows at random and , thus , links @xmath450 and @xmath451 have transformed into @xmath452 and @xmath453 .",
    "if @xmath452 or @xmath453 previously existed , we abort this randomizing event and we restart looking at random for another @xmath448 structure within the graph .        for every real network we generated an ensemble of @xmath454 replicas obtained after applying the randomization algorithm until we performed @xmath455 link switches or @xmath456 trials .",
    "the latter applies generally if the net belongs to an ensemble having a few members , which can happen due to several reasons , mainly , if the net is too dense or if the net is very sparse , or if it has a non - standard component structure .",
    "numerical details of the randomization process for each real network are described in the appendix .",
    "now we generate the ensemble of randomized graphs by taking as topological invariants the directed degree sequence and the component structure . given a directed graph @xmath0 , @xmath439 , its _ directed degree sequence _ ,",
    "@xmath457 , is the sequence of @xmath441 pairs of integer numbers in which the first number of the @xmath433-th pair depicts the @xmath374-degree of node and the second one depicts the @xmath375-degree of node @xmath4 , in a given labeling @xmath443 of the nodes of the graph :      let us suppose that such a graph has a given component structure @xmath445 .",
    "the randomization method applied here keeps invariant both @xmath457 and @xmath446 .",
    "the conservation of @xmath457 makes this randomization method slightly more restrictive than the other presented above .",
    "specifically , we look for @xmath448 structures in @xmath8 to perform a _ local swap _ , but , now , the sense of the arrows matter . indeed ,",
    "the kind of @xmath448 structures over which we can apply a local swap keeping the directed degree sequence of the graph are :              figure ( [ fig : localswapdir ] ) shows how we generate the randomized elements of the ensemble .",
    "first , we select at random a structure of the kind described in figure ( [ fig : strucslocalswapdir ] ) , figure ( [ fig : localswapdir ] , left ) .",
    "then , we cross the links at the extremes of the chain , i.e. , generating a `` @xmath449 '' structure ( [ fig : localswapdir ] center ) . finally , we check if new links @xmath452 and @xmath453 previously existed .",
    "if so , we abort this rewiring event and we restart another one looking at random for structures like the ones described in figure ( [ fig : strucslocalswapdir ] ) .        for every real network we generated an ensemble of @xmath454 replicas obtained after applying the randomization algorithm until we performed @xmath455 link switches or @xmath456 trials , if the net belongs to an ensemble having a few members .",
    "network randomization offers a quantitative picture of how far real networks are from their respective randomly generated ensembles whose correlations are eliminated by an iterative process of arc rewiring . comparison is given by contrasting the @xmath438 coordinates , @xmath459 , of a particular real network with a distribution of values obtained from a randomized ensemble represented by its percentiles in a box plot fashion .",
    "this chart allows us to elude any assumption on the statistical behavior of the ensembles of randomized graphs .",
    "figure ( [ fig : randomization_composition ] ) shows the comparison between real and random ensemble data , the latter generated according methods * a * and * b*. studied networks appear clustered by types , and every type of network has an associated color",
    ". numbers , network labels , colors and other additional network quantifiers are detailed in the supplemental information ii .",
    "in the figure , real network values are represented in charts by a grey square .",
    "the distribution of @xmath438 values for every generated ensembles is represented in a box plot .",
    "percentiles @xmath460 , and @xmath461 are represented by an empty blue line box while the percentile @xmath462 is depicted with a red line inside .",
    "whiskers show the values within percentiles @xmath463 and @xmath464 .",
    "finally , red crosses display the values out for the whisker range .    in figure ( [ fig : randomization_composition ] ) looking at the position of real networks , they fall out from the percentile @xmath462 of their randomized ensembles in the @xmath12 space . therefore , we can argue that real networks of under scrutiny have not a representative graphical configuration for their degree sequence .",
    "this indicates that , although real networks tend to live in the null model regions as we saw earlier , system s constraints confer differences in the pattern of connections that distinguish real networks from their randomized counterparts .",
    "this difference is more accentuated for method * a * ( the directed degree sequence is not conserved ) than for method * b * , mainly due to the fact that the latter imposes a more dramatic restriction in the graphical configuration .    in relation",
    "to @xmath13 coordinate , graphs tend to show @xmath13 values close to zero . however , there are exceptions .",
    "positive biased values are observed in food webs and most of grns .",
    "such nets are thus hierarchic ( @xmath17 ) , in terms of how the causal flow is organized . on the contrary ,",
    "electronic circuits show an anti hierarchical configuration ( @xmath18 ) , with a tendency to occupy slightly negative , but significant , values of @xmath13 .",
    "looking at @xmath14 and @xmath15 values , real networks are generally far from the whiskers of the ensemble , when confronting real data against the ensemble obtained using the randomization method * a * -where directed degree sequence is preserved . in most cases real data appears to avoid the general cyclic character observed in randomized networks .",
    "this trend seems to be reduced when the directed degree sequence is conserved ( randomization method * b * ) .",
    "this points to the conclusion that not local correlation among connectivities but the pattern of inputs and outputs would explain part of @xmath438 values . in general , such a trend presents a larger cyclic character in randomizations than in real networks .",
    "however , we can observe two exceptions to this general behavior .",
    "looking at the @xmath15 for randomized ensembles obtained through method * a * , metabolisms and word corpora show a higher cyclic character than their respective randomized ensembles .",
    "however , when compared to randomized ensembles obtained using method * b * , the trend is similar to the common values observed in randomized versions . as it happened in the previous cases , the range occupied by real and randomized data seems to be fairly justified in most cases by directed degree sequence .",
    "now we shall concern ourselves to an _ in silico _ experiment based on an evolutionary algorithm applied to graph population variation .",
    "so far we studied how both real nets and their corresponding random ensembles cover the different regions of the morphospace @xmath12 .",
    "the numerical experiment presented below will give us important information on how _",
    "accessible _ are the different regions of the morphospace if we impose selective pressures related to specific values of hierarchy coordinates over the possible graphs . in raw words , we let evolve a _ population _ of graphs taking as selective pressure the distance of such graphs to a given target point of @xmath12 . for a given graph , the closer it is to this target point , the higher is its selective value . at the global , evolutionary level , what we want to evaluate is how long it takes is to reach a given target point : the more it takes the population to reach it , the more _ inaccessible _ is this region considered .",
    "results are shown in figure ( 4 ) of the main text * hierarchy in complex systems : the possible and the actual*.    let us detail the experiment . using a method described in @xcite we quantified the accessibility of a grid of points in the defined 3d morphospace @xmath12 .",
    "this experiment has a high computational cost , thus , we covered @xmath12 by a grid containing @xmath454 points in three cuts , corresponding to three @xmath88 planes at three different values of orderability .",
    "the three planes are the ones defined by @xmath465 . for",
    "each decided @xmath15 value , along the @xmath88 plane , minimum and maximum coordinates were distanced a value of @xmath466 distance units , the distance is computed using the standard euclidean norm , namely : @xmath467 ] from the boundaries and all points of the grid were equally distanced at @xmath468 .",
    "each of the resulting @xmath438 points was used as a target to be reached or approached by a euclidean distance in the 3d morphospace .",
    "we say that to _ reach _ a given target @xmath438 point , @xmath469 , is done when at least one graph of an evolving population acquires a @xmath438 value @xmath459 such that the euclidean distance between @xmath459 and @xmath469 is smaller than @xmath466 distance units .",
    "the initial condition of this algorithm is defined by a population of graphs @xmath470 ( always single connected components ) , being @xmath471 , each one made of @xmath472 nodes , generated following the directed erds rnyi model with @xmath473 ( see section [ model networks ] for model details ) .",
    "* computation of the @xmath438 values @xmath55 for all @xmath474 .",
    "* for each graph @xmath8 of @xmath470 , we compute the euclidean distance @xmath475 between @xmath55 and desired target point @xmath476 .",
    "* we calculated the average of the euclidean distance over the population @xmath477 . *",
    "we applied the selection criterion : we eliminate from the @xmath470 those graphs satisfying @xmath478 .",
    "the set of _ survivals _ is @xmath479 . *",
    "we create a sequence @xmath480 picking at random and copying elements from @xmath481 .",
    "we perform this operation @xmath482 times -therefore , the sequence has length @xmath483 , and repetitions are allowed . *",
    "we apply the _ randomization operator _ over all graphs of the sequence , keeping the graphs of @xmath481 invariant . after this step , together with the unchanged graphs excluded from the rewiring process , we obtaining the new generation of @xmath470 .      * random addition from one up to three arcs . *",
    "random deletion from one up to three arcs of a graph .",
    "this step must satisfy the condition of preserving the single connected component . if not , randomization event is aborted and new arcs are chosen to be removed .",
    "there is one situation defined by two conditions for which evolutionary algorithm can be stacked : given a generation , @xmath368 if none of the graphs become close enough to the target point and @xmath369 none or all graphs are below the fitness mean of the population .",
    "then , to avoid the evolutionary algorithm freezes , the following rule is applied :      for each target point of the grid , @xmath485 replicas of the evolutionary experiment were performed .",
    "each population pursuing a target point was allowed to evolve up to @xmath484 generations .",
    "the average number of generations needed to reach each target point was used as an estimator of the accessibility of that part of @xmath12 .",
    "those cases were the accessibility value is exactly @xmath484 indicate that none of the graphs in none of the @xmath485 processes was able to reach that target point -see figure ( 4 ) of the main text for results . in these cases , we expect that more than @xmath484 generations are needed .    a note of caution must be added to interpret the strength of the obtained results .",
    "it is worth to note that parameters of the evolutionary algorithm may be determinant in shaping the observed fitness landscape , thereby accelerating or slowing the convergence process to the desired target point .",
    "the aim of this experiment was just to shed light on how accessible different regions of @xmath12 are , considering selection and evolution driving forces . in this context",
    ", we numerically answered this question choosing a combination of parameters which we consider to be enough representative to provide us relevant information . and indeed , thanks to this approximation , we showed that not all regions are equally accessible but , instead , some regions are fairly improbable to be achieved . among other factors ,",
    "the size of the network may play a crucial role to achieve certain regions of the morphospace , since , for example it is easier for small networks to display extreme configurations .",
    "the described results create a nice , global picture of what is possible and what is actually observed within the zoo of complex networks .",
    "this objective is achieved from a rigorous definition of hierarchy ."
  ],
  "abstract_text": [
    "<S> hierarchy seems to pervade complexity in both living and artificial systems . despite its relevance , no general theory that captures all features of hierarchy and </S>",
    "<S> its origins has been proposed yet . here </S>",
    "<S> we present a formal approach resulting from the convergence of theoretical morphology and network theory that allows constructing a 3d morphospace of hierarchies and hence comparing the hierarchical organization of ecological , cellular , technological and social networks . </S>",
    "<S> embedded within large voids in the morphospace of all possible hierarchies , four major groups are identified . </S>",
    "<S> two of them match the expected from random networks with similar connectivity , thus suggesting that non - adaptive factors are at work . </S>",
    "<S> ecological and gene networks define the other two , indicating that their topological order is the result of functional constraints . </S>",
    "<S> these results are consistent with an exploration of the morphospace using in silico evolved networks . </S>"
  ]
}