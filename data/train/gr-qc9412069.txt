{
  "article_text": [
    "the continued progress in the field of numerical relativity has demonstrated the feasibility of evolving strong curvature fields , including black holes , on a computer .",
    "recent calculations of spacetimes with black holes include simulations of highly distorted black holes  @xcite , colliding black holes  @xcite , the formation of black holes from imploding gravitational waves  @xcite , and balls of collisionless matter  @xcite .",
    "calculations like these are important stepping stones to full 3d simulations of two coalescing black holes .",
    "such simulations will be very important for understanding gravitational signals that will be detected by new gravitational wave detectors , such as the ligo and virgo  @xcite laser interferometers and advanced bar detectors  @xcite .",
    "however , as black holes are accompanied by singularities , their presence in numerical spacetimes leads to extreme dynamic ranges in length and time , making it difficult to maintain accuracy and stability for long periods of time .",
    "all calculations of black hole spacetimes to date , like those mentioned above , develop difficulties at late times due to the large dynamic ranges that must be computed .",
    "these difficulties are even more severe when black holes are evolved in 3d  @xcite .    the traditional way to deal with these problems has been to take advantage of the coordinate degrees of freedom inherent in the einstein equations to avoid the extreme curvature regions .",
    "the `` many fingers of time '' in relativity allows one to evolve particular regions of space without evolving the regions in which singularities are present or forming . these so - called singularity avoiding slicing conditions wrap up around the singular region ( see fig .",
    "[ fig : wrap ] ) so that a large fraction of the spacetime outside the singular region can be evolved .",
    "several different types of singularity avoiding slicings have been proposed  @xcite and applied with variable degrees of success to a number of problems .",
    "however , these conditions by themselves do not completely solve the problem ; they merely serve to delay the breakdown of the numerical evolution . in the vicinity of the singularity ,",
    "these slicings inevitably contain a region of abrupt change near the horizon and a region in which the constant time slices dip back deep into the past in some sense .",
    "this behavior typically manifests itself in the form of sharply peaked profiles in the spatial metric functions  @xcite , `` grid stretching ''  @xcite , large coordinate shift  @xcite on the black hole throat , _",
    "etc_. these features are most pronounced where the time slices are sharply bent towards the past ( as shown in fig .",
    "[ fig : wrap ] ) for a reason that will be discussed below .",
    "numerical simulations will eventually crash due to these pathological properties of the slicing . as these problems are even more severe in 3d , where much longer evolutions will be required to study important problems like the coalescence of two black holes , it is essential to investigate alternative methods to handle singularities and black holes in numerical relativity .",
    "cosmic censorship suggests that in physical situations , singularities are hidden inside black hole horizons . because the region of spacetime inside the horizon can not causally affect the region of interest outside the horizon , one is tempted to cut away the interior region containing the singularity and evolve only the singularity - free region outside . to an outside observer",
    "no information will be lost since the region cut away is unobservable .",
    "the procedure of cutting away the singular region will drastically reduce the dynamic range , making it easier to maintain accuracy and stability . with the singularity removed from the numerical spacetime ,",
    "there is in principle no physical reason why black hole codes can not be made to run indefinitely without crashing .",
    "although the desirability of a horizon boundary condition has been raised many times in the literature  @xcite , it has proved to be difficult to implement such a scheme in a dynamical evolution  @xcite .",
    "the boundary condition which one needs to impose on a black hole horizon , which is a one - way membrane  @xcite , should be some form of out - going ( into the hole ) boundary condition . however , except for the case of linear nondispersive fields propagating in a flat spacetime , we are not aware of any satisfactory numerical out - going wave boundary conditions  @xcite . waves in relativity can be nonlinear , dispersive and possess tails and other complications .",
    "moreover , what a wave is in the near zone is not even well - defined .",
    "the development of a general out - going wave boundary condition in numerical relativity is certainly highly nontrivial .    in a recent paper",
    "@xcite we demonstrated that a horizon boundary condition can be realized .",
    "here we present a more detailed discussion of our methods and various extensions to that earlier work .",
    "there are two basic ideas behind our implementation of the inner boundary condition : ( 1 )  we use a `` horizon locking coordinate '' which locks the spatial coordinates to the spatial geometry and causal structure .",
    "this amounts to using a shift vector that locks the horizon in place near a particular coordinate location , and also keeps other coordinate lines from drifting towards the hole . in  @xcite we investigated one particular type of shift condition , namely the `` distance freezing '' shift . here",
    "we report on various choices of shift conditions , including the original `` distance freezing '' shift that freezes the proper distance to the horizon , an `` expansion freezing '' shift that freezes the rate of expansion of outgoing null rays , an `` area freezing '' shift that freezes the area of radial shells , and the minimal distortion shift  @xcite that minimizes the global distortion in the 3-metric .",
    "some of these shifts have the advantage that they can be generalized more easily to geometries and coordinate systems other than the spherical one .",
    "the use of these shift vectors will be discussed in detail in section  iii .",
    "the basic message is that the idea of a horizon locking coordinate is robust enough for many different implementations , with some implementations likely extendible to the general 3d case .",
    "( 2 )  we use a finite differencing scheme which respects the causal structure of the spacetime , which essentially means that spatial derivatives are computed at the `` center of the causal past '' of the point being updated .",
    "such a differencing scheme is not only essential for the stability of codes using large shift vectors as in those with `` horizon locking coordinates '' , but also eliminates the need of explicitly imposing boundary conditions on the horizon . as pointed out in  @xcite , this is , in a sense , the horizon boundary condition without a boundary condition . since the horizon is a one - way membrane , quantities on the horizon can be affected only by quantities outside but not inside the horizon . hence , in a finite differencing scheme which respects the causal structure , all quantities on the horizon can be updated solely in terms of known quantities residing on or outside the horizon , and there is no need to impose boundary conditions to account for information not covered by the numerical evolution .",
    "such an approach can be applied to all kinds of source terms that one may want to deal with in numerical relativity .",
    "[ otherwise one would have to develop an out - going ( into the black hole ) wave boundary condition for each physical problem , i.e. , one out - going wave condition for gravitational waves , one for em fields , one for perfect fluids , _",
    "etc_. ]    in ref .",
    "@xcite we implemented causal differencing in a first order way , which respected the causal structure but did not carefully take account of the exact light cone centers . in this paper",
    "we report on the results obtained in the second generation of our code which explicitly and accurately takes account of the causal past of a grid zone .",
    "the basic idea in constructing the causal differencing scheme is that , for a set of differential equations written in a spacetime coordinate system with a shift vector , the finite differenced version of the equations can be obtained by:@xmath2(i )  transforming the coordinate system to one without a shift , ( ii )  choosing a differencing method for this set of differential equations in the usual manner , as required by the physics involved , and ( iii )  transforming the resulting finite differenced equations back to the original coordinate system .",
    "the equations so obtained can be very different from those obtained by applying directly the usual differencing method to the set of differential equations with a shift .",
    "a direct application can easily lead to a set of unstable finite differenced equations when the shift is large .",
    "that is , the actions of coordinate transformation and finite differencing do not commute . by going through a coordinate system without a shift vector , we guarantee that the stability of the final differenced equations is independent of the shift vector .",
    "a general overview of the program we adopt is the following : suppose we want to numerically evolve a collapsing star . the initial data can be set up and evolved for a while with some suitable gauge conditions , while looking out for the generation of an apparent horizon . when one is formed and grows to a certain finite size , a shift vector can be introduced to maintain the apparent horizon at a constant coordinate position",
    "this determines the shift vector right at the apparent horizon .",
    "the shift at other grid points is determined by criteria which are consistent with the choice of the shift at the apparent horizon . in this paper",
    ", we study a subset of the above scenario in which a spherically symmetric black hole exists in the initial data .",
    "generalizations of our basic methods to more complicated geometries are discussed throughout this paper .",
    "we use the 3@xmath31 formalism which views spacetime as a foliation by spatial 3-surfaces with a metric @xmath4 and extrinsic curvature tensor @xmath5 .",
    "( we adopt the usual notation and use latin letters to denote 3-dimensional indices . ) in this picture the spacetime metric can be written as @xmath6 where @xmath7 is the lapse function that determines the foliation of the spacetime and @xmath8 is the shift vector specifying the three - dimensional coordinate transformations from time slice to time slice .    in this formalism , the evolution equations become @xmath9 \\nonumber \\\\ & & + \\beta^c d_c k_{ab } + k_{ac } d_b \\beta^c + k_{cb } d_a \\beta^c , \\label{evolk}\\end{aligned}\\ ] ] and the hamiltonian and momentum constraints are respectively @xmath10 where @xmath11 is the 3-ricci tensor , @xmath12 is its trace , @xmath13 is the trace of @xmath14 , and @xmath15 is the covariant derivative associated with the 3-metric @xmath16 .",
    "we use the framework of spherically symmetric spacetimes to illustrate the idea of locking the horizon and the coordinate system . as shown by bernstein , hobill , and smarr  @xcite ( denoted henceforth by bhs ) , the numerical construction of even a schwarzschild spacetime is nontrivial with a general choice of lapse and shift .",
    "both in this paper and in  @xcite , the lapse can be arbitrarily specified .",
    "the shift is taken to be always in the radial direction with only one component @xmath17 , consistent with spherical symmetry .",
    "the spatial line element is taken to be @xmath18 the coordinates @xmath19 are the standard spherical coordinates on the @xmath20 constant 2-spheres and @xmath21 is a radial coordinate related to the schwarzschild isotropic coordinate @xmath22 by @xmath23 , where @xmath1 is a length scale parameter which is equal to the mass of the black hole . with this coordinate ,",
    "the throat is located at @xmath24 . the line element ( [ 3metric ] )",
    "is easily generalized to one which is suitable for numerical studies of axisymmetric spacetimes  @xcite , and it includes both the radial gauge  @xcite and the quasi - isotropic or isothermal gauge  @xcite .",
    "the conformal factor @xmath25 is a function that depends only on @xmath26 and is specified on the initial time slice so that it satisfies the hamiltonian constraint with time symmetry and conformal flatness .",
    "the evolution equations for the 3-metric and extrinsic curvature ( here @xmath27 and @xmath28 ) are : @xmath29 \\nonumber\\\\ & & + \\",
    ", \\alpha \\ ,",
    "h_a \\left ( \\frac{2 h_a}{a}-\\frac{h_b}{b}\\right )     \\label{hadot}\\\\     \\dot{h}_b = & & \\psi^{-4}\\left [ \\alpha r_{\\theta\\theta } - \\alpha '     \\left ( \\frac{b'}{2a } + \\frac{2 \\psi ' b}{a\\psi } \\right )     + \\frac{4h_b\\beta \\psi ' } { a \\psi } + \\beta \\frac{h_b'}{a}\\right ]     + \\alpha \\frac{h_ah_b}{a}~ , \\label{hbdot}\\end{aligned}\\ ] ] and the hamiltonian and momentum constraints respectively become @xmath30 @xmath31 where @xmath32 and @xmath33 are the 3-ricci components and the extrinsic curvature is written as @xmath34 to help simplify the form of the equations .",
    "we evolve eqns .",
    "( [ adot ] ) to ( [ hbdot ] ) with the time - symmetric schwarzschild solution as the initial data : @xmath35 , @xmath36 and @xmath37 . in the numerically evolved spacetime",
    ", the topology of the @xmath38 constant hypersurfaces is given by the single einstein - rosen bridge , although the geometry can be different .",
    "with the radial coordinate behaving as @xmath39 , the grid can cover a large range of circumferential radius @xmath40 . at the outer boundary",
    ", it suffices for our present purpose to take the metric as fixed .",
    "the inner boundary condition is the subject of this paper .",
    "bhs have developed one of the most accurate codes to date to evolve single black hole spacetimes in one spatial dimension .",
    "they carry out a thorough treatment using maximal slicing @xmath41 , with zero or a minimal distortion shift and nine different methods for finite differencing the evolution equations including maccormack , brailovskaya and leapfrog schemes .",
    "results presented in this paper will be compared to this standard .",
    "we first demonstrate the difficulty of using singularity avoiding slicings ( e.g. , maximal slicing ) using the bhs code .",
    "bhs find that the most accurate evolutions are obtained by using the maccormack or brailovskaya differencing schemes , maximal slicing and zero shift vector , although the leapfrog scheme is of comparable accuracy and is preferred in 2d .",
    "results obtained with the bhs code are considered to be very accurate , but as in all codes designed so far to evolve black holes , it develops difficulties at late times . in figs .",
    "[ fig : grr ] and  [ fig : ham ] we show the best results using the bhs code with 400 zones to cover the domain from @xmath24 to 6 . the solid lines in fig .",
    "[ fig : grr ] are the radial metric component @xmath42 shown from @xmath43 to @xmath44 at every @xmath45 intervals .",
    "the dashed line is the coordinate position of the apparent horizon versus time .",
    "we see that the horizon is growing in radius , due to the infalling of coordinates and a spike is rapidly developing near the horizon which eventually causes the code to crash . the inaccuracy generated by the sharp spike is shown explicitly in fig .",
    "[ fig : ham ] , where the violation of the hamiltonian constraint is plotted at various times . figs .",
    "[ fig : grr ] and  [ fig : ham ] indicate the code has developed substantial errors by @xmath46 . at this point ,",
    "the peak value of the hamiltonian constraint stops growing , as the spike in the radial metric component can no longer be resolved .",
    "errors in the apparent horizon mass are approximately 25% . at time",
    "@xmath47 numerical instabilities begin to grow , causing the code to crash shortly thereafter .",
    "the development of the spike is the combined effect of the grid points falling into the black hole and the collapse of the lapse .",
    "the coordinate points at smaller radii have larger infall speeds causing the radial metric component @xmath48 to increase towards smaller @xmath26 . however , at the same time , there is a competing effect due to the use of the singularity avoiding time slice .",
    "the motion of the grid points close to @xmath49 is frozen due to the `` collapse of the lapse . '' at small radii well inside the horizon , the latter effect dominates , and @xmath48 can not increase in time .",
    "this causes @xmath48 to develop a peak at a place slightly inside the horizon where the difference in the infalling speed of the grid points is large , but the lapse has not completely collapsed .",
    "bhs investigated using the minimal distortion shift vector as a means of reducing the shear in the metric components .",
    "however , they found that although the sharp gradients in the radial metric component are eliminated from the region containing the event horizon , the shear is transformed to the throat , where volume elements vanish as the singularity is approached .",
    "a key to stable and accurate evolutions for long times is to utilize the shift vector to lock the coordinate system with respect to the geometry of the spacetime so that there is no infalling of grid points .",
    "an obvious feature in the black hole geometry that can be used for such a purpose is the apparent horizon . here for convenience of discussion we refer to the apparent horizon as the two - dimensional spatial surface having a unit outward pointing 3-vector @xmath50 satisfying@xcite @xmath51 where @xmath52 is the expansion of the outgoing null rays . for a rigorous discussion of the apparent horizon , see e.g. ,  @xcite . in this present work",
    ", we assume that there is one and only one such surface in the black hole spacetime .",
    "although the apparent horizon is not defined locally in space , it is defined locally in time , and hence is a convenient object ( in comparison to the event horizon ) to work with in numerical evolutions .",
    "there are two key steps in locking the coordinate system to the black hole geometry .",
    "we first lock the position of the apparent horizon to a fixed coordinate location .",
    "then all grid points in the spacetime are fixed with respect to the apparent horizon .",
    "in spherical geometry with the 3-metric ( [ 3metric ] ) , the expansion of outgoing null rays reduces to @xmath53 where the differential operator @xmath54 is the outgoing null vector , the action of which on the surface area is zero at the apparent horizon .",
    "therefore the coordinate location of the apparent horizon @xmath55 is given by the root of this equation @xmath56 .",
    "one might attempt to solve for the shift in this equation to make @xmath55 constant in time .",
    "however , despite the apparent existence of a @xmath17 term in the operator @xmath57 , the equation defining the horizon is independent of @xmath17 , once the time derivative of the metric function @xmath58 in this equation is expressed in terms of known quantities on the present time slice .",
    "this is to be expected as the location of the apparent horizon on a particular time slice should be independent of the value of @xmath59 on that slice . instead",
    ", as the time rate of change of @xmath55 is a function of the shift , one can determine the `` horizon locking '' shift by solving for the shift in the equation @xmath60 that is , we require the zero of the function @xmath61 at @xmath62 to be time independent .",
    "this gives a condition on @xmath17 .",
    "alternatively , one can also determine the shift by requiring that the area of the coordinate surface defining the horizon at some time be held fixed from that point in time forward .",
    "in a nondynamical spacetime , such as schwarzschild , this condition will also lock the coordinate location of the horizon . for the present spherically symmetric case",
    ", this requirement can be written as @xmath63_{\\eta = \\eta_{ah}}=0 \\ , .",
    "\\label{arealock}\\ ] ] one can think of other ways to determine the shift @xmath17 at the apparent horizon for locking it .",
    "the methods given by ( [ shiftcond ] ) or ( [ shiftcond2 ] ) are chosen for their extensibility into the 3d case .",
    "although the present discussion has focused on `` locking '' the horizon , in general one would like to have the ability to fully control the motion of the horizon , i.e. , place the horizon at the coordinate location of our choosing , which need not be one fixed value for all times .",
    "for example , if matter is falling into the black hole , it would be natural to have the horizon of the black hole expand in coordinate location .",
    "a particularly interesting case is to have the black hole move across the numerical grid with the coordinate location of the horizon changing accordingly in time .",
    "such controlled motion of the horizon can be achieved by a simple variant of the method described above .",
    "work in this direction will be discussed in detail elsewhere .",
    "preventing the apparent horizon from drifting is only part of the story , as we must also specify the shift at other locations to prevent pathological behavior of the coordinate system throughout the spacetime and to prevent grid points from `` crashing '' into the apparent horizon .",
    "we have investigated the following four implementations of the shift :    * `` distance freezing '' shift*:with the apparent horizon fixed at constant @xmath26 , one can tie all grid points to the horizon by requiring the proper distance between grid points to be constant in time . in the spherically symmetric case , this determines the shift through the differential equation ( [ adot ] ) .",
    "setting @xmath64 gives @xmath65 equation  ( [ shifta ] ) can be solved for @xmath17 by integrating from the horizon to the outer boundary for regions outside the black hole , and from the horizon to the inner boundary of the numerical grid for regions inside the horizon .",
    "we use a fourth - order runge - kutta method to solve the first order equation on each time slice .",
    "the use of this shift condition has been briefly discussed in @xcite . in section  v below , we present results obtained using this shift , with recent improvements in implementation incorporated .",
    "* `` area freezing '' shift*:alternatively , one can choose to freeze in time the area of the surfaces of constant radial coordinate so that @xmath66 .",
    "this yields the following equation for @xmath17 @xmath67 an advantage of using the `` area freezing '' shift is that it is tied nicely to the apparent horizon when the horizon is locked with eq .",
    "( [ arealock ] ) . in fact , eq .",
    "( [ areas ] ) is simply an application of eq .",
    "( [ arealock ] ) not just on the ah , but everywhere .",
    "another advantage of such a choice is that it yields an algebraic expression for the shift , hence eliminating the need for a spatial integration , as in eq .",
    "( [ dfreeshift ] ) .",
    "furthermore , this shift condition allows the surface area ( a sensitive function in the evolution of black hole spacetimes ) to be well - defined in time and not subject to numerical discretization errors .",
    "however , just like the distance freezing shift , this shift condition is strongly coordinate dependent .",
    "the usefulness of the distance freezing shift in a full 3d black hole spacetime depends on one s ability to pick a suitable `` radial direction '' from the hole , e.g. , the direction of maximum grid stretching .",
    "similarly , the usefulness of the area freezing shift in the full 3d case depends on one s ability to pick suitable closed 2-surfaces for locking . in the following we turn to two other shift conditions that are completely geometric in nature , and",
    "therefore can be generalized in a straightforward manner to other coordinate systems and to 3d treatment .",
    "* `` expansion freezing '' shift*:a choice of shift condition closely related to the area freezing shift is obtained by freezing the expansion ( [ theta ] ) of closed surfaces which have spatially uniform expansions , i.e. , @xmath68 in spherical symmetry , these surfaces are simply surfaces of constant radial coordinates .",
    "we have studied the implementation of both condition  ( [ tex ] ) and the similar condition @xmath69 the results are similar .",
    "this shift condition , just like the area freezing shift , ties in naturally with the horizon locking condition  ( [ shiftcond ] ) .",
    "it also yields an algebraic expression for @xmath70 , namely , @xmath71 \\label{tex3}\\end{aligned}\\ ] ] with @xmath72 . on the horizon @xmath73 , but this is not so inside nor outside the horizon .",
    "this condition can be generalized to the 3d case in a straightforward manner as the constant @xmath74 surfaces can be regarded , in some sense , as concentric surfaces centered at the hole . at present",
    "we are developing a scheme for determining such closed 2d surfaces with uniform expansion in 3d space .",
    "* minimal distortion shift : * a final option that we consider in this paper is the minimal distortion shift , written in covariant form as @xmath75 in spherical coordinates , this reduces to the following second order equation for @xmath17 @xmath76 one of the most attractive properties of this shift condition is its geometric nature .",
    "it minimizes coordinate shear in a global sense .",
    "also its formulation is completely independent of coordinates so that it may be equally applied to a single black hole in spherical coordinates as to a two black hole coalescence in 3d cartesian coordinates .",
    "however , this shift vector is more difficult to implement numerically , particularly in three dimensions .",
    "we solve separately for the two regions inside and outside the apparent horizon . outside the horizon",
    "we treat the equation for @xmath17 as a two point boundary value problem using ( [ hlock ] ) or ( [ arealock ] ) to fix @xmath17 at the horizon and setting @xmath77 at the outer edge . inside the horizon",
    "we use a second order backward substitution method specifying @xmath70 and @xmath78 at the horizon .",
    "@xmath78 is computed from the outer domain solution , thus allowing for smooth extensions of the numerical solution through the horizon .",
    "the difficulty in extending this to the 3d case is that one has to solve a set of coupled elliptic partial differential equations with an irregular inner boundary on each time slice during the evolution .",
    "all the above discussed shift conditions have been found to successfully lock the coordinate system to the spacetime geometry in the spherically symmetric case .",
    "the results will be given in section  v. the basic point we want to make here is that the idea of locking the coordinate system to the geometry in black hole spacetimes by making use of the apparent horizon is robust enough that there can be many different ways to implement it .",
    "this robustness makes it promising for implementation in 3d .    an important point to note",
    "is that these shifts can be applied to either all of the spacetime grid , or just in the vicinity of the black hole .",
    "the freedom of turning the shift off at a distance away from the black hole , so that the coordinates are not necessarily everywhere locked , is important when we go away from spherical symmetry .",
    "for example , in multiple black hole spacetimes , one would like to be able to lock the grid in one part of the spacetime to one hole , while locking other parts to other black holes .",
    "we will demonstrate in section  v that such partial locking is possible .",
    "one consequence of introducing a nonzero shift vector in horizon locking coordinates is that inside the horizon the future light cone is tilted inward towards smaller @xmath26 .",
    "if the shift is such that the horizon stays at constant coordinate value , i.e. , the horizon locking shift of section  iii above , the light cone will be completely tilted to one side inside the horizon .",
    "this feature of the light cone is convenient for the implementation of the horizon boundary condition .",
    "it allows us to excise the singular region inside some fixed grid point .",
    "since grid points are fixed to the coordinates , data at a particular grid point depends only on past data from grid points at equal or larger _ coordinate _ values inside the horizon .",
    "note that without such a horizon locking shift vector this will not necessarily be true .",
    "the remaining task is then to construct a finite differencing scheme which can maintain the causal relations between grid points . of course , due to the courant stability requirement , causal relations between grid points can not be maintained exactly .",
    "inevitably information propagates slightly faster than the speed of light in a finite differencing equation .",
    "however , by keeping buffer zones inside the horizon in the numerical evolution domain , the light cones will be tilted to such an extent that even the innermost grid point can be evolved with information on grid points in the buffer zones while having the courant condition safely satisfied .",
    "with such a scheme there is no need to supply boundary conditions at the inner edge of the grid , since all points which can be affected by the inner edge point , even on the finite differencing level , are off the grid .",
    "we shall see that the causal differencing scheme is useful not only for imposing the horizon boundary condition , but that it is also essential for stability when evolving the differential equations with a large shift vector  @xcite . in the following subsections",
    ", we shall first illustrate this with a simple scalar field example , before turning to the general relativistic case .",
    "consider a simplified @xmath79 flat space @xmath80 and a simple scalar field @xmath81 described by @xmath82 introduce a shift vector by performing a coordinate transformation @xmath83 the spacetime becomes @xmath84 with @xmath85 the evolution equation ( [ scalev ] ) in the first order form becomes @xmath86 @xmath87 one might attempt to finite difference ( [ 34 ] ) and ( [ 35 ] ) in terms of the usual leapfrog scheme : @xmath88 @xmath89 in obvious notation .",
    "however , a straightforward von neumann stability analysis shows that for any given @xmath90 , the system of finite difference equations ( [ 36 ] ) and ( [ 37 ] ) is _ unstable _ for a large enough @xmath70 .",
    "[ fig : cenun ] demonstrates the development of @xmath91 obtained by this scheme . the initial data for @xmath81 is a gaussian represented by the dashed line and @xmath92 .",
    "the shift @xmath70 is taken to be the following function of space and time @xmath93",
    "so that the field @xmath81 is experiencing a shift increasing in time , but decreasing in @xmath94 , analogous to the black hole case . @xmath95 is plotted at equal time intervals up to time @xmath96 as solid lines in the figure .",
    "the initial gaussian splits into two . due to the shift",
    "one component has a large coordinate velocity moving rapidly to the left , while the other component has a much smaller coordinate velocity .",
    "we see that at the last plotted time @xmath96 , the evolution becomes unstable .",
    "the reason for this instability is easy to understand . in trying to update the data at the @xmath97 point on the @xmath98 slice",
    "[ the point @xmath99 , the `` region of finite differencing '' used on the right - hand side of ( [ 37 ] ) is from @xmath100 to @xmath101 .",
    "however , the point @xmath102 has the edges of its backward light cone on the @xmath98 slice , with the presence of a shift @xmath70 , given by @xmath103 on the left , and @xmath104 on the right .",
    "hence if @xmath105 , or @xmath106 for a negative @xmath70 , part of the `` region of causal dependence '' of the point @xmath102 lies outside the `` region of finite differencing '' , and the evolution becomes unstable .    to enforce that the finite differencing scheme follows the causal structure of the numerical grid , which becomes nontrivial in the presence of a shift ,",
    "the idea we propose is the following :    * in trying to finite difference a set of differential equations with a shift , like eqns .",
    "( [ 34 ] ) and ( [ 35 ] ) , we first transform back to a coordinate without shift . in the case above , this means going back to ( [ 28 ] ) . * in this new coordinate system without shift , the causal structure is trivial , and the finite differencing scheme can be picked in the usual manner according to the structure of the equation . in the present case , for example , it can be the leapfrog scheme @xmath107 @xmath108 notice that we have denoted @xmath109 as @xmath110 , instead of @xmath13 , since @xmath109 is different from @xmath111 * the finite differenced equations ( [ 39 ] ) and ( [ 40 ] ) are in terms of @xmath112 and @xmath113 .",
    "we then transform these difference equations back to the coordinate system @xmath114 with a shift .",
    "this procedure gives the `` causal leapfrog differencing '' @xmath115 @xmath116 where @xmath117 .",
    "notice that here the dependent variable @xmath118 is _",
    "not@xmath119 _ transformed back to @xmath120 . in using the variable @xmath118 ,",
    "the final equations are simpler and do not involve the derivative of @xmath70 .",
    "the price to pay is that , if we want to reconstruct @xmath120 from @xmath118 , we have to obtain also the function @xmath121 of the coordinate transformation .",
    "the function @xmath122 can be evolved with the auxiliary equation @xmath123    a straightforward von neumann analysis shows that the stability of the two sets of finite differenced equations ( [ 39 ] ) , ( [ 40 ] ) and ( [ 41 ] ) , ( [ 42 ] ) are the same , as they should be by construction .",
    "( [ 41 ] ) and ( [ 42 ] ) have the correct causal property independent of the value of the shift .",
    "[ fig : cau ] shows the evolution of @xmath81 with this causal leapfrog differencing scheme using the same initial data , grid parameters and shift as in fig .",
    "[ fig : cenun ] .",
    "the evolution is carried out to @xmath124 , with @xmath95 shown at equal time intervals .",
    "clearly the evolution is stable .",
    "the situation with the einstein equations is no different from the scalar field equation as far as the problem of finite differencing is concerned . to find the finite differenced version of eqns .",
    "( [ adot ] ) to ( [ hbdot ] ) , we transform to a coordinate system without a shift @xmath125 the line element in these new coordinates can be written as @xmath126 it is easy to see that the two sets of metric functions are related by @xmath127 in terms of this new set of variables , the einstein evolution equations ( [ adot ] ) to ( [ hbdot ] ) become @xmath128 @xmath129 finite differencing these equations is straightforward .",
    "for example , if the leapfrog scheme is chosen , upon transforming back to the @xmath130 coordinates , the resulting finite differenced equations have exactly the same structure as ( [ 41 ] ) and ( [ 42 ] ) .",
    "there are terms without @xmath70 , evaluated on the @xmath98 slice at the causal center of the backward light cone of the point @xmath102 , and terms involving @xmath70 evaluated on the @xmath131 slice at the corresponding location of the causal center on this slice .    also similar to the scalar field case",
    ", we keep the dependent variables in the finite differenced equations as @xmath132 , @xmath133 , @xmath134 , @xmath135 ) .",
    "they are related to ( @xmath48 , @xmath58 , @xmath136 , @xmath137 ) by the auxiliary function @xmath138 , which is evolved with eqn .",
    "( [ 49 ] ) .",
    "it is also possible to evolve directly with the variables ( @xmath139 @xmath58 , @xmath136 , @xmath137 ) with full causal differencing . in this case",
    "no auxiliary function is needed .",
    "the details of this approach will be presented elsewhere .",
    "in this section we discuss results obtained by implementing the horizon boundary scheme .",
    "first we outline the issues common to all varieties of the boundary scheme , and then we present results for each different implementation .    to study how well the horizon boundary condition works ,",
    "we compare results with those obtained using the bhs black hole code , which is one of the most accurate codes to date in evolving spherical black holes .",
    "the most accurate evolutions in the bhs code are obtained with maximal slicing and zero shift , which is the case to which we shall be comparing our results . in this case , the apparent horizon is initially located on the throat of the black hole , which is the inner boundary of the computational domain . as the spacetime evolves the coordinates fall towards the hole , so the coordinate location of the horizon will move out . the evolution begins with the lapse collapsing to zero behind the horizon and the radial metric function increasing as the coordinates collapse inward . to stop the radial metric function from developing a sharp peak ( as shown in fig .",
    "[ fig : grr ] ) , we smoothly introduce a horizon locking shift over a period of time .",
    "the phase - in period for the shift typically lasts @xmath140 starting from @xmath141 , and so the full horizon boundary condition is in place by @xmath142 , and the inner grid points close to the singularity are dropped from the numerical evolution .",
    "we retain 10 to 20 grid points inside the apparent horizon as buffer zones for added stability . having these `` buffer zones '' inside the horizon",
    "helps because of two reasons .",
    "first , in the horizon locking coordinate the light cones are tilted more as we go further inside the horizon .",
    "second , any inaccuracy generated at the innermost grid point has a longer distance to leak through , and hence decreases substantially in amplitude , before it can affect the physically relevant region outside the horizon .    by the time the shift is fully phased in",
    ", the radial metric function is still of order unity everywhere .",
    "the lapse is also of order unity throughout the grid , with the smallest value being 0.3 at the inner boundary of the grid . the subsequent evolution , using the same grid parameters as in the bhs code , gives us a direct comparison between implementing and not , the horizon boundary condition .    without the horizon boundary condition",
    ", one has to let the lapse collapse to a value even below @xmath143 in the inner region , i.e. , one does not evolve that part of the spacetime in order to help prevent the code from crashing .",
    "nevertheless , the code will still subsequently crash as the radial metric function develops a sharp peak near the horizon ( growing from a value of order 1 to a peak value well over 100 within a span of just a few grid points , depending on the resolution ) . with the horizon boundary condition in place ,",
    "there is no need to collapse the lapse .",
    "in fact the lapse is kept frozen from the time the boundary condition is fully phased in .",
    "we stress that the boundary condition permits accurate evolutions for extremely long times ( see below ) with lapses of order unity throughout the entire calculation in space and in time .",
    "another issue is the implementation of causal differencing for the black hole spacetime . in our first treatment of this problem",
    "@xcite we introduced causal differencing in a first order way by taking into account the direction of light cones when constructing difference operators , but without accounting for the width and the precise location of the center of the backward light cones .",
    "basically , the implementation in @xcite is similar to using one - sided derivatives in a region where the flow of information is one - sided . here",
    "we report on the results obtained with the full causal differencing scheme using the `` tilde '' variables as described in section  iv , and we see a substantial improvement in accuracy .",
    "we begin by presenting results of implementing the horizon boundary condition using our `` distance freezing '' shift that freezes the radial metric function @xmath42 in time . in fig .",
    "[ fig : hlock : a ] we show the evolution of the radial metric function @xmath42 up to a time of @xmath144 for a run with 400 radial zones ( @xmath145 ) .",
    "note that @xmath21 is a logarithmic radial coordinate that runs from @xmath24 at the throat to @xmath146 at the outer boundary .",
    "the outer edge corresponds to @xmath147 in the isotropic coordinate @xmath148 .",
    "the horizon is locked at @xmath149 after the boundary scheme is fully phased in by @xmath150 .",
    "the inner grid points are dropped at that point , so the lines at later times do not cover the inner region .",
    "we see that @xmath42 changes rapidly initially before and during the phase - in period .",
    "after that , the evolution gradually settles down . from @xmath151 to @xmath144 the profile barely changes .",
    "although the shift is designed to make @xmath48 a constant in time , due to discretization errors , the freeze is not perfect .",
    "however , a perfect locking is also not necessary , as demonstrated by the stability and the accuracy of the results shown here .",
    "this slow drifting in @xmath48 is to be compared to the sharp peak in fig .",
    "[ fig : grr ] produced by the bhs code without using the horizon boundary condition .    in fig .",
    "[ fig : hlock : b ] we show the evolution of @xmath152 , the angular metric function .",
    "we see that the shift which is designed to freeze @xmath48 also freezes @xmath58 .",
    "again the evolution of @xmath152 settles down by @xmath151 , and the change in the profile becomes negligible .",
    "this shows that the shift vector has succeeded in locking the coordinate system to the geometry . with the geometry of the schwarzschild spacetime being static , and the time slicing ( lapse ) not changing in time",
    ", all metric functions must become frozen .    in fig .",
    "[ fig : hlock : m ] we show the mass of the apparent horizon , defined by @xmath153 on the vertical axis we show the difference between the analytic value @xmath154 and the numerically computed value .",
    "by @xmath155 the mass is just @xmath156 for the `` distance freezing '' shift with full causal differencing , with resolution of 200 grid points .",
    "we also show results obtained with our earlier first order implementation of the boundary condition scheme , which did not use full causal differencing .",
    "although the old results are already quite good , the improvement due solely to causal differencing is clear . for comparison ,",
    "we show also the error in mass given by the bhs code with the much higher resolution of 400 grid zones .",
    "the improvement one can get by imposing the horizon boundary condition is obvious",
    ".    figs .",
    "[ fig : block : a ] , [ fig : block : b ] , and [ fig : block : m ] , show , respectively , the evolution of @xmath48 , @xmath58 and @xmath157 , analogous to figs .",
    "[ fig : hlock : a ] , [ fig : hlock : b ] , and [ fig : hlock : m ] , but for the case of the horizon boundary implemented with the `` area freezing '' shift discussed in section  iv .",
    "we note that the basic features are the same . before and during the phase - in ,",
    "@xmath42 and @xmath152 are rapidly changing .",
    "after the phase - in , the metric functions @xmath48 and @xmath58 basically settle down . although the shift is designed to freeze @xmath58 in this case , @xmath48 also gets frozen .",
    "we see in fig .",
    "[ fig : block : b ] that @xmath58 is much more accurately locked compared to the @xmath58 in fig .",
    "[ fig : hlock : b ] .",
    "notice that in figs .",
    "[ fig : block : a ] and [ fig : block : b ] , @xmath48 and @xmath58 have different spatial distributions compared to those of figs .  [ fig : hlock : a ] and [ fig : hlock : b ] .",
    "the grid points are tied to the geometry by the shifts in both cases , but they are tied at different locations . in the area",
    "freezing shift case , the shift at the horizon is treated as the shift at other positions . the error in mass ,",
    "@xmath158 which is a very sensitive indicator of accuracy is plotted against time for different resolutions in fig .",
    "[ fig : block : m ] .",
    "again the bhs case is shown for comparison .",
    "the next set of figs .",
    "[ fig : elock : a ] , [ fig : elock : b ] , [ fig : elock : m ] , and [ fig : expb ] are for the expansion freezing shift , a choice of shift vector which is geometrically motivated and coordinate independent .",
    "we again see that the grid points are basically locked to the geometry by this condition after phasing in . however , we see that there is an intermediate region outside the horizon but not too far from the black hole for which the locking is less perfect compared to the previous two choices of shift .",
    "the basic reason is that although the expansion @xmath52 is monotonically increasing with the radial coordinate near the horizon , it is not the case farther out , as shown in fig .",
    "[ fig : expb ] . near the peak of the expansion , where the expansion is nearly a constant with respect to changing radial position , the determination of a shift required to lock the surface of constant expansion is clearly more difficult . as a result , both @xmath48 in fig .",
    "[ fig : elock : a ] and @xmath58 in fig .",
    "[ fig : elock : b ] show some evolution in that region , indicating motion of the grid .",
    "however , as this region is further away from the horizon , such motion of the grid is not causing any serious difficulty , and the evolution is still stable and accurate , as shown by the error in the mass plot of fig .",
    "[ fig : elock : m ] .    figs .",
    "[ fig : mdlock : a ] , [ fig : mdlock : b ] , and [ fig : mdlock : m ] are the corresponding figures for the final minimal distortion shift case .",
    "bhs reported that the use of a minimal distortion shift is troublesome in the region near the throat , as the volume element is small there . with the horizon boundary condition",
    ", the region near the throat is cut off explicitly , and the minimal distortion shift with boundary conditions for the shift equation set on the horizon ( _ cf .",
    "_ see sec .",
    "iii.b ) works as nicely as the other horizon locking shifts .    as a further check on the accuracy of the calculations , in fig .",
    "[ fig : alkham ] we show the distributions of the violation of the hamiltonian constraint at @xmath159 for the bhs code without a horizon boundary condition , and at @xmath144 for the four different implementations of the horizon conditions .",
    "as the evolutions are completely unconstrained , the value of the hamiltonian provides a useful indicator of the accuracy .",
    "the distributions of the hamiltonian constraint show steady profiles in time for all of our horizon boundary schemes .",
    "we show the comparison to the bhs result at @xmath160 instead of @xmath144 , since the bhs code is no longer reliable after @xmath161 for reasons discussed above . to put the bhs result on the same scale",
    "it is divided by a factor of 10 .",
    "all runs are done with the same grid parameters and a resolution of 400 zones .",
    "the increase in accuracy provided by the horizon boundary condition is obvious .    for spacetimes with multiple black holes ,",
    "the grid points should not all be locked with respect to just the horizon of one of the holes . in fig .",
    "[ fig : loclk ] we show the effect of turning off the shift at a finite distance away from the black hole .",
    "the shift is smoothly set to zero at @xmath162 , with the shift at small @xmath26 being the area freezing shift . in the region that the coordinate is not locked , we see in fig .  [",
    "fig : loclk ] that the value of @xmath152 is decreasing in time as expected , since the grid points there are falling towards the hole .",
    "the motion of the grid points would be different if there were another hole further out in the spacetime .",
    "this study of using a `` localized shift '' provides evidence that our scheme is flexible enough to handle more complicated situations .",
    "one last question one might have is the long term stability of the horizon boundary scheme . in fig .",
    "[ fig : lgtrm ] , we show a run up to @xmath163 with a resolution of 200 grid zones and using the `` distance freezing '' shift .",
    "errors in the mass @xmath164 and the hamiltonian constraint evaluated at the horizon are shown as a function of time .",
    "we note that at the end of the run the mass error is just 4% .",
    "stable and accurate evolutions for such a long time are likely to be required for the spiraling two black hole coalescence problem .",
    "progress in numerical relativity has been hindered for 30 years because of the difficulties in avoiding spacetime singularities in the calculations . in this paper , we have presented several working examples of how an apparent horizon boundary scheme can help circumvent these difficulties .",
    "we have demonstrated this scheme to be robust enough that it allows many different ways of implementation . also , as shown by the results in section v , it is likely that even an approximate implementation of horizon boundaries can yield stable and accurate evolutions of black hole spacetimes",
    ". such approximate implementations can be most important in extending this work to 3d spacetimes and will be discussed elsewhere . throughout this work we have sought to consider ideas that are applicable or extensible to the most general 3d case , where no particular symmetry , gauge condition , metric form , or evolution scheme is assumed .",
    "in fact four different gauge conditions were demonstrated here with the same code , and in no case were the equations specialized to the particular gauge under investigation .",
    "although in this paper we have only implemented this scheme in spherical vacuum spacetimes , neither sphericity nor vacuum are intrinsic restrictions on the scheme . indeed , in  @xcite we have shown that the horizon boundary condition scheme works in the case of a scalar field infalling into a black hole .",
    "the follow - up study of that case will be reported elsewhere .",
    "the discussion in this paper has been carried out in terms of a free evolution scheme .",
    "for constrained evolution , the horizon boundary condition can be constructed in the same spirit as discussed here . with the implementation of a horizon locking shift",
    ", the boundary values of the elliptic constraint equations can be obtained from data in the region of causal dependence on the previous time slice , using the evolution equations .",
    "furthermore , the apparent horizon condition itself could be used to provide a boundary value of some quantity for constraint equations .",
    "although we have shown only cases where the horizon is locked to the coordinate system , as pointed out in section iii , this is not a requirement for the evolution .",
    "the shift can be used to control the motion of the horizon .",
    "such controlled motion will be particularly useful in moving black holes through the numerical grid , as will be needed , for example , in the long term evolution of the two black hole inspiral coalescence .",
    "we found that such controlled motion can be easily achieved in the scheme described in this paper .",
    "the details of this will be reported elsewhere .",
    "other issues that need to be addressed are that the apparent horizon location may jump discontinuously , or multiple horizons may form . these problems can be handled by simply tracking newly formed horizons and phasing in a new boundary in place of the old one(s ) .",
    "multiple black holes can be handled by locking the coordinates only in the vicinity of the black holes .",
    "we are beginning to examine these issues .",
    "we are happy to acknowledge helpful discussions with andrew abrahams , david bernstein , matt choptuik , david hobill , ian redmount , larry smarr , jim stone , kip thorne , lou wicker , and clifford will .",
    "we are very grateful to david bernstein for providing a copy of his black hole code , on which we based much of this work .",
    "j.m . acknowledges a fellowship ( p.f.p.i . ) from ministerio de educacin y ciencia of spain .",
    "this research is supported by the ncsa , the pittsburgh supercomputing center , and nsf grants nos .",
    "phy91 - 16682 , phy94 - 04788 , phy94 - 07882 and phy / asc93 - 18152 ( arpa supplemented ) ."
  ],
  "abstract_text": [
    "<S> it was recently shown that spacetime singularities in numerical relativity could be avoided by excising a region inside the apparent horizon in numerical evolutions . in this paper </S>",
    "<S> we report on the details of the implementation of this scheme . </S>",
    "<S> the scheme is based on using ( 1 )  a horizon locking coordinate which locks the coordinate system to the geometry , and ( 2 )  a finite differencing scheme which respects the causal structure of the spacetime . </S>",
    "<S> we show that the horizon locking coordinate can be affected by a number of shift conditions , such as a `` distance freezing '' shift , an `` area freezing '' shift , an `` expansion freezing '' shift , or the minimal distortion shift . </S>",
    "<S> the causal differencing scheme is illustrated with the evolution of scalar fields , and its use in evolving the einstein equations is studied . </S>",
    "<S> we compare the results of numerical evolutions with and without the use of this horizon boundary condition scheme for spherical black hole spacetimes . with the boundary condition a black hole </S>",
    "<S> can be evolved accurately well beyond @xmath0 , where @xmath1 is the black hole mass . </S>"
  ]
}