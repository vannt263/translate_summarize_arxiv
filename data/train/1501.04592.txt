{
  "article_text": [
    "the uniform distribution on the group consisting of all unitary operations acting on @xmath0 qubits is captured by the _ haar measure _ , which is the unique measure that is invariant under left and right multiplication by any group element .",
    "haar - random unitaries , by their symmetries , facilitate many analyses in quantum information @xcite .",
    "however , haar - random unitaries have very high computational complexity , in that most of them can not be efficiently implemented or reasonably well approximated by circuits of size polynomial in the number of qubits .",
    "they require many bits to describe .",
    "they also require a lot of randomness to sample .",
    "unitary 2-designs are probability distributions on finite subsets of the unitary group that have some specific properties in common with the haar measure . several common definitions for unitary 2-designs have been proposed and studied , each revolving around a specific property or application and appropriate notion of approximation @xcite .",
    "these 2-designs are computable by polynomial - size circuits with short specifications and low sampling complexity .",
    "we focus on _ exact _ unitary 2-designs . in the exact case",
    ", we will see that several commonly used definitions can be shown to be equivalent to each other .",
    "one particularly natural definition is that they are _ two - query indistinguishable _ from haar - random unitaries .",
    "imagine a game where , at the flip of a coin , @xmath2 is sampled either according to the haar measure or with respect to the unitary 2-design .",
    "a two - query distinguishing procedure can make two queries to @xmath2 ( each being either in the forward direction as @xmath2 or in the reverse direction as @xmath3 ) as well as other quantum operations that do not depend on @xmath2 and then outputs a bit .",
    "a unitary 2-design has the property that no two - query distinguishing procedure can distinguish between the haar - random case and the 2-design case with probability greater than @xmath4 . by this definition ,",
    "a unitary 2-design is a quantum analogue of 2-universal hash function  @xcite ( or , more precisely , 2-universal hash permutation ) .",
    "we will show in section  [ sec : definitions ] that this definition is equivalent to previous definitions , including those based on _ bilateral twirling _",
    "@xcite and _ channel twirling _",
    "@xcite .",
    "the uniform distribution on the clifford group has been shown to be an exact unitary 2-design in the sense of bilateral twirling @xcite and channel twirling @xcite .",
    "this implies that the circuit complexity is @xmath5 where the gates are one- and two - qubit gates from the clifford group  @xcite .",
    "moreover , the sampling cost is @xmath6 random bits of entropy . in the context of bilateral twirling ,",
    "@xcite shows that a certain process of random circuit generation ( introduced in  @xcite ) yields @xmath7-approximate unitary 2-designs of size @xmath8 , where @xmath7 measures the distance of the resulting operation from the ideal one .",
    "another construction  @xcite yields circuits of size @xmath9 for a notion of approximation related to channel twirling .",
    "however , there is evidence ( see , e.g. , section  2 of  @xcite and section  1.1 of  @xcite ) , that the calibration of the approximation used incurs a blow - up by a factor that is exponential in @xmath0 in the bilateral twirl context . in other words , for the more general setting , we need @xmath10so the circuit size becomes @xmath11 .",
    "note that , for exact unitary 2-designs as well as approximations of them related to bilateral twirling , all of the above constructions incur circuits of size @xmath12 and require @xmath13 random bits of entropy .",
    "reference @xcite proves that there exists a small subgroup of the clifford group that gives rise to an exact unitary 2-design that uses approximately @xmath14 random bits of entropy .",
    "however , the circuit complexity for this construction is unknown , beyond the @xmath15 bound that holds for any clifford operation .",
    "references @xcite and @xcite study the necessary and sufficient entropy for exact and approximate unitary @xmath16-designs .",
    "approximately @xmath17 random bits of entropy are necessary .",
    "we give three constructions of _ exact _ unitary 2-designs on @xmath0 qubits that have the following quantum gate costs ( number of one- and two - qubit gates ) :    * @xmath18 gates ( all clifford gates ) for infinitely many @xmath0 , assuming the extended riemann hypothesis is true .",
    "* @xmath18 gates ( including non - clifford gates ) for all @xmath0 , unconditionally . * @xmath19 gates ( all clifford gates ) for all @xmath0 , unconditionally .",
    "the circuits for the first two constructions can be organized so as to perform their computation in @xmath20 depth ; the third in @xmath21-depth ( using the fact that efficient multiplication / convolution algorithms require only @xmath22-depth  @xcite ) .",
    "all three constructions use @xmath14 bits of randomness ( more precisely , they sample from a uniform distribution on a set of size @xmath23 ) .",
    "they all consist of unitaries in the clifford group ( even in the second construction , where non - clifford gates are used to compute clifford unitaries efficiently ) .",
    "the circuits use @xmath24 ancilla qubits ( where each ancilla qubit is initially in state @xmath25 and is restored to this state at the end of the computation ) . finally",
    ", the cost of the classical process that samples these unitary 2-designs ( outputs a description of the quantum circuit ) is polynomial in @xmath0 .",
    "the cost is dominated by the complexity of computing square roots in the finite field @xmath26 .",
    "it should also be noted that our definition  [ def:2queryu ] is a new characterization of unitary 2-designs in terms of 2-query indistinguishability that may be of independent interest .      since our constructions yield exact unitary 2-designs , they are automatically valid for all notions and definitions of approximate unitary 2-designs .",
    "our construction thus achieves the minimum known circuit size , depth , and sampling complexity simultaneously , among both exact and approximate unitary 2-designs .",
    "exact @xmath16-designs offer other advantages .",
    "besides the original operational applications of bilateral and channel twirling , @xmath16-designs have appeared in second moment analysis .",
    "for example , they arise in @xcite , where results are obtained about the decoupling of two quantum systems and quantum channel capacities .",
    "an exact 2-design can be used in a  plug - and - play \" manner .",
    "for example , there exists an encoding operation in any unitary @xmath16-design that achieves the quantum channel capacity .",
    "thus , our results _ automatically _ imply the existance of encoding circuits of @xmath27 clifford gates and depth @xmath21 .",
    "in some applications such as decoupling , the distance from an exact @xmath16-design is amplified by a dimensional factor that can be exponential in @xmath0 ( for example , theorem  1 in  @xcite ) .",
    "using our exact construction , such error term vanishes exactly , so does the issue of the exponential amplification of errors .",
    "thus our results yield potentially tighter bounds while maintaining a circuit size of @xmath1 .    prior to our work ,",
    "@xcite constructs a method to generate random circuits of size @xmath28 and depth @xmath29 that does not give rise to a @xmath16-design , yet achieves decoupling and providing small encoding circuits for quantum error correcting codes @xcite .",
    "the advantage in their approach is that no ancillas are needed , and the circuit may model some random physical processes .",
    "however , the depth is higher , and a substantial amount of analysis is required in the aforementioned references to show that the construction and circuit size indeed achieve the tasks with the desired accuracy .",
    "adapting their construction to other applications may also require additional analysis .",
    "we first discuss several definitions that are equivalent to the concept of unitary @xmath16-designs .",
    "let @xmath30 denote the group of @xmath31 unitary matrices .",
    "we are interested in distributions over @xmath30 .",
    "the haar measure on @xmath30 is the unique measure on @xmath30 that is invariant under left and right multiplication by any @xmath32 .",
    "we denote the haar measure by @xmath33 .",
    "let @xmath34 denote a finite ensemble of unitary matrices @xmath35 where @xmath36 and @xmath37 .",
    "sampling from the haar measure is a powerful technique in quantum information theory .",
    "sometimes , we use a physical procedure that averages over such random choices of unitary transformation ( for example @xcite ) .",
    "some other times , we have a randomized argument , for example , in the proof of quantum channel capacity @xcite , in which the average performance over all possible unitary encoding is evaluated .",
    "we are interested in contexts in which such sampling from the haar measure can be replaced by sampling from a finite ensemble @xmath34 of unitary matrices .",
    "this can reduce the required resources such as shared randomness or communication to implement the random unitary , as well as the computational complexity of implementing the randomly chosen unitary .",
    "we now discuss several of these circumstances .",
    "the first context is concerned with the expected value of polynomials of the entries of unitary matrices drawn according to some distribution .",
    "this definition is essentially the original definition of _ unitary 2-design _ in  @xcite , and is useful for proving results in other contexts .",
    "[ def : u2design ] we say that @xmath38 is _ degree-@xmath16 expectation preserving _ if , for every polynomial @xmath39 of degree at most @xmath16 in the matrix elements of @xmath2 and at most @xmath16 in the complex conjugates of those matrix elements , _ i=1^k p_i ( u_i ) = d(u ) ( u ) . [ eq : u2design ]    in eq .",
    "( [ eq : u2design ] ) and throughout the paper , an integral written without a specific domain is taken over  @xmath30 .",
    "the second context is concerned with distinguishing whether a random sample @xmath2 is drawn from the haar measure or from the ensemble @xmath38 , when an arbitrary distinguishing circuit is allowed to make a total of at most two queries of @xmath2 or @xmath40 .",
    "the most general circuit @xmath41 of this form is depicted in figure [ fig : def-2-design ] .",
    "-query distinguishing circuit _",
    "@xmath41 : querying @xmath2 and @xmath2 ( left ) ; querying @xmath2 and @xmath42 ( right ) .",
    "the initial state @xmath43 is arbitrary , @xmath44 is an arbitrary unitary , and the final measurement is arbitrary.,scaledwidth=70.0% ]    the circuit @xmath41 starts with an arbitrary initial state @xmath43 ( a positive semidefinite matrix of trace @xmath45 ) .",
    "then , the first query , an arbitrary operation @xmath44 , the second query , and an arbitrary final measurement are applied in order .",
    "we call any such circuit a @xmath16-query distinguishing circuit .",
    "the final output state is denoted as @xmath46 .",
    "[ def:2queryu ] we say that @xmath38 is _ @xmath16-query indistinguishable _ , if , for any distinguishing circuit @xmath41 making up to two queries of a random unitary or its adjoint , @xmath47    the next context is a special case of the scenario depicted in figure [ fig : def-2-design ] , where @xmath2 is queried twice in parallel , as illustrated in figure  [ fig : bilateral ] .",
    ". the initial state and the measurement are arbitrary.,scaledwidth=14.0% ]    consider bipartite operations in which two disjoint systems undergo the same unitary transformation drawn according to some distribution .",
    "these operations are sometimes called bilateral twirls @xcite . the _",
    "@xmath38 bilateral twirl _ is defined as the quantum operation _ ( ) = _",
    "i=1^k p_i u_i u_i u_i^ u_i^. [ eq : btwirle ] the _ full bilateral twirl _ is defined as the quantum operation _",
    "( ) = d ( u ) u u u^ u^. [ eq : btwirlf ] the full bilateral twirl is motivated operationally @xcite and it appears in various mathematical proofs in quantum information @xcite .",
    "definition [ def : btwirl ] describes ensembles that derandomize the full bilateral twirl .",
    "[ def : btwirl ] we say that the ensemble @xmath38 _ implements the full bilateral twirl _ if @xmath48 for all @xmath43 .",
    "[ eq : btwirl ]    the fourth context is concerned with the task of converting any quantum channel into a depolarizing channel of the same average fidelity .",
    "this conversion has many important applications , for example , _ benchmarking _ ( for estimating average channel fidelity ) of quantum devices @xcite and error estimation ( for detecting eavesdropping ) in quantum key distribution @xcite .",
    "let @xmath49 be any quantum channel that maps @xmath50-dimensional quantum states to @xmath50-dimensional quantum states .",
    "an @xmath38-channel - twirl of @xmath49 , denoted by @xmath51 , is defined as the quantum channel that acts as _ ( ) : _",
    "i=1^k p_i u_i^(u_i u_i^ ) u_i .",
    "[ def : e - twirl - channel ] in other words , a random change of basis is applied to the system before the channel @xmath49 acts and it is reverted afterwards .",
    "a full - channel - twirl of a quantum channel @xmath49 is given by _",
    "( ) : d(u ) u^(u u^ ) u . [ def : haar - twirl - channel ]    [ def : channeltwirl ] we say that @xmath38 _ implements the full channel - twirl _ if @xmath52 for all quantum channels @xmath49 .",
    "lemma  [ lem : equivdef ] below states that these four relationships between ensembles and the haar measure are equivalent .",
    "thus , we can think of an ensemble satisfying one of the conditions in alternate ways .",
    "[ lem : equivdef ] let @xmath38 be any ensemble of unitaries in @xmath30 . then , the following are equivalent : + ( 1 ) @xmath38 is degree-@xmath16 expectation preserving .",
    "+ ( 2 ) @xmath38 is @xmath16-query indistinguishable .",
    "+ ( 3 ) @xmath38 implements the full bilateral twirl .",
    "+ ( 4 ) @xmath38 implements the full channel twirl .",
    "the following corollary of lemma [ lem : equivdef ] is not obvious from definitions [ def : btwirl ] and [ def : channeltwirl ] alone .",
    "[ cor : dagger ] for @xmath34 , let @xmath53 .",
    "+ ( a ) @xmath38 implements the full - bilateral twirl iff @xmath54 does .",
    "+ ( b ) @xmath38 implements the full channel twirl iff @xmath54 does .",
    "we note that additional definitions have been discussed in @xcite .",
    "several parts of lemma [ lem : equivdef ] have been proved in literature @xcite . in particular",
    ", @xcite relates definitions ( 1 ) , ( 3 ) , and ( 4 ) with bounds on the approximations .",
    "we provide a complete ( alternative ) proof of lemma  [ lem : equivdef ] in appendix [ appendix : definitions ] .    due to lemma  [ lem : equivdef ] ,",
    "when we do not need to specify the context , we just call an ensemble satisfying any one of the four conditions a `` unitary @xmath16-design . ''",
    "we describe a simple sufficient condition for @xmath38 to be a unitary @xmath16-design .",
    "we begin by reviewing some basic definitions and terminology associated with the pauli group .",
    "let @xmath55 , @xmath56 , and @xmath57 denote the @xmath58 pauli matrices .",
    "for any @xmath59 , define @xmath60 and @xmath61 .    the _ pauli group _ @xmath62 consists of all operators of the form @xmath63 , where @xmath64 and @xmath65 .",
    "let @xmath66 , the quotient group that results from disregarding global phases in @xmath62 ( each element of @xmath67 can be represented as @xmath68 ) .",
    "we call @xmath69 the trivial pauli",
    ".    let @xmath70 ( the @xmath58 hadamard matrix ) , @xmath71 ( the phase gate ) , and @xmath72    [ def : clifford ] the _ clifford group _",
    "@xmath73 is the set of all unitary matrices that permute the elements of @xmath62 ( and thus @xmath67 ) under conjugation .",
    "the clifford group @xmath73 contains the @xmath74 , cnot , and @xmath75 gates , and they form a generating set @xcite .",
    "since the conjugation of @xmath76 by some @xmath77 is a permutation of elements in @xmath62 , this induces a permutation @xmath78 on  @xmath67 .",
    "consider an ensemble @xmath34 of unitary matrices @xmath79 in the clifford group @xmath73 .",
    "we say that @xmath38 is _ pauli mixing _ , if for all @xmath80 such that @xmath81 , the distribution @xmath82 is uniform over @xmath83 .    for any ensemble @xmath34 ,",
    "let @xmath84 where @xmath85 ranges over all elements in @xmath67 . intuitively , @xmath86 is the ensemble where a random element drawn from @xmath38 is preceded by a random pauli operation drawn from @xmath67 .",
    "pauli mixing by @xmath38 is a sufficient condition for the ensemble @xmath86 of clifford unitaries to be a unitary @xmath16-design .",
    "more specifically , we have the following lemma .",
    "[ lemma : pauli - mixing - to-2design ] let @xmath38 be an ensemble of clifford unitaries and @xmath86 be defined as above . if @xmath38 is pauli mixing , then @xmath86 implements the full bilateral twirl .",
    "the original proof idea of lemma [ lemma : pauli - mixing - to-2design ] was given by @xcite .",
    "a short proof based on representation theory can be found in @xcite . in appendix",
    "[ appendix : pmi2d ] we provide an elementary proof that may be of independent interest .",
    "this proof borrows some ideas from @xcite but has fewer assumptions .",
    "in particular , the new proof does not rely on knowing how the full - bilateral twirl acts , and derives it on the side .",
    "the action of the full - bilateral twirl is known , but existing proofs we know of rely either on representation theory or the double commutant theorem .",
    "note that , in light of lemma  [ lem : equivdef ] , an alternate way of proving that , whenever @xmath38 is pauli mixing , @xmath86 is a unitary @xmath16-design is to use definition  [ def : channeltwirl ] .",
    "this can be shown in the following two steps .",
    "first , conjugating any channel by a uniformly random pauli operation drawn from @xmath67 yields a _ mixed - pauli channel _ ( a channel that is a probability distribution on the pauli operators ) .",
    "this is proved in  @xcite .",
    "second , it is clear that , if @xmath38 is pauli mixing , then conjugating any mixed pauli channel by a random element of @xmath38 results in a depolarizing channel with the same average fidelity as the mixed pauli channel .",
    "this corresponds exactly to an implementation of the full channel twirl .",
    "for the purposes of analyzing the clifford group and its action on the pauli group elements @xmath88 , it is fruitful to associate @xmath89 and @xmath90 with elements of the galois field of size @xmath91 .",
    "however , for this association to work well technically , we work with two different representations of field elements .",
    "if @xmath89 is represented in some _ primal _ basis then @xmath90 is represented in the _ dual _ of that basis .",
    "this section explains this basic framework .",
    "let @xmath26 denote the galois field of size @xmath91 ( more information about these fields can be found in  @xcite ) .",
    "the elements of this field are a vector space over @xmath92 so the notion of a basis is well - defined : @xmath93 are a _ basis _ if they are linearly independent and span the field .",
    "relative to a basis @xmath94 that we refer to as the _ primal basis _",
    ", we identify each @xmath95 with the binary string @xmath96 for which @xmath97 .",
    "a _ polynomial basis _ of @xmath26 is a basis that is of the form @xmath98 , for some @xmath99 .",
    "the standard constructions of @xmath26 in terms of irreducible polynomials result in a polynomial basis . however , there are bases that are not necessarily of this form , and these arise in our constructions . for instance , a _ normal basis _ of @xmath26 has the form @xmath100 for some @xmath99 .",
    "the dual of a basis is defined in terms of the _ trace _ function @xmath101 , which is defined as @xmath102 .",
    "the trace has the property that @xmath103 , for all @xmath104 . in terms of @xmath105",
    ", we can define the _ trace inner product _ of @xmath104 as @xmath106 .",
    "now , for an arbitrary primal basis @xmath93 , we can define its _ dual basis _ as the unique @xmath107 such that @xmath108 the coordinates of any @xmath95 with respect to the primal basis @xmath94 satisfy @xmath109 .",
    "also , for @xmath95 , let @xmath110 denote the coordinates of @xmath89 with respect to the dual basis @xmath111 in the sense that @xmath112 . with this notation ,",
    "@xmath89 and @xmath113 can be interpreted as two binary strings that refer to the same element of @xmath26 , but expressed in different coordinate systems .",
    "it is straightforward to show that the conversion from primal to dual basis coordinates corresponds to multiplication by @xmath114 that is , @xmath115 ( with matrix - vector multiplication in mod 2 arithmetic ) . also , @xmath106 is the dot - product of the coordinates of @xmath89 in the primal basis and the coordinates of @xmath90 in the dual basis : @xmath116 the dual of the dual basis is the primal basis .",
    "a basis is _ self - dual _ if @xmath117 for all @xmath118 .",
    "relative to any basis , multiplication by any particular @xmath119 is a linear operator in the following sense .",
    "there exists a binary @xmath120 matrix @xmath121 such that , for all @xmath122 , @xmath123 ( with mod 2 arithmetic for the matrix - vector multiplication ) .",
    "in fact , this matrix @xmath121 is @xmath124 it should be noted that algorithms for multiplication in @xmath26 are basis dependent ; the obvious cost of converting between two bases is @xmath6 .      due to lemma [ lemma : pauli - mixing - to-2design ]",
    ", it suffices to compute an ensemble of clifford unitaries that is pauli mixing .",
    "chau  @xcite showed that there is a subgroup of the clifford group of size @xmath125 such that sampling uniformly over this subgroup performs pauli mixing .",
    "this subsection gives an overview of the approach in  @xcite .",
    "the subgroup is isomorphic to the special linear group of @xmath126 matrices over @xmath26 : @xmath127 note that @xmath87 has @xmath128 elements .",
    "this subgroup induces a group action of @xmath87 on the paulis by conjugation by certain unitaries .",
    "[ def : induce ] with respect to a primal basis for @xmath26 , a unitary @xmath2 _ induces _",
    "@xmath129 if , for all @xmath130 such that @xmath131 @xmath132 where @xmath133 means equal up to a global phase in @xmath134 that is a function of @xmath135 , @xmath89 , and @xmath90 .",
    "let @xmath136 denote a unitary that induces @xmath135 with respect to the primal basis ( @xmath136 is unique up to multiplication by a pauli ) . let @xmath137 denote a unitary that induces @xmath135 with respect to the dual basis .",
    "it should be noted that , in  @xcite , eq .   is expressed using different notation for the paulis , that we call _ subscripted _ paulis , defined as satisfying @xmath138 and @xmath139 .",
    "it is easy to express these in terms of our _ superscripted _ paulis , @xmath140 and @xmath141 , as @xmath142 and @xmath143 ( since @xmath144 ) .",
    "the occurence of the dual basis in @xmath145 ( which is equivalent to using @xmath146 ) in eq .",
    "is not merely a matter of convention : for general @xmath147 there _ does not exist _ a unitary @xmath2 that induces @xmath135 in the sense that @xmath148 . in terms of defintion  [ def : induce ] , the following holds .",
    "[ lemma : induce ] with respect to any primal basis of @xmath26 and every @xmath129 , there exists an @xmath0-qubit clifford unitary @xmath136 that induces @xmath135 .",
    "the proof of lemma  [ lemma : induce ] in @xcite exhibits a possible choice of @xmath136 for any @xmath147 .",
    "however , it is unclear how to implement that @xmath136 as a small quantum circuit , except for the fact that @xmath136 is in the clifford group , so its gate complexity is @xmath5 by  @xcite .",
    "our results in subsequent sections amount to an alternate proof of lemma  [ lemma : induce ] for certain bases of @xmath26 , as well as a modified version of this lemma .",
    "this enables us to ultimately attain gate constructions of size @xmath1 that implement unitary 2-designs .",
    "the relationship between lemma  [ lemma : induce ] and unitary 2-designs is based of the fact that the uniform ensemble over @xmath149 is pauli mixing , which is a consequence of the following .",
    "[ lemma41 ] let @xmath150 be chosen uniformly at random . then , for any non - zero @xmath151 , the distribution @xmath152 is uniform over all the non - zero elements of @xmath153 .",
    "suppose , by contradiction , that there are distinct @xmath154 , @xmath155 with @xmath156 , @xmath157 and @xmath158 .",
    "but there exists an @xmath159 such that @xmath160 .",
    "so , @xmath161 .",
    "but the distribution over @xmath135 is the same as the distribution over @xmath162 , so the left side of the last inequality is @xmath163 , which is a contradiction .",
    "our goal is to implement @xmath136 ( for @xmath147 ) with quantum circuits consisting of @xmath1 clifford gates .",
    "the interplay between the primal basis and the dual basis is a major complicating factor that we address using two different approaches . in one of our approaches",
    "we modify the framework of @xmath87 .",
    "our approach in section  [ sec : mult ] is based on a self - dual basis for @xmath26 and the structure of @xmath87 .",
    "our approach in section  [ sec : mult - poly ] is based on a polynomial basis for @xmath26 ( and its dual ) and the structure of two subgroups of @xmath87 : the lower triangular subgroup and the upper triangular subgroup .",
    "these are defined respectively as @xmath164    \\ut_2({\\mbox{\\rm gf}}(2^n ) ) & = \\biggl\\ {      \\begin{pmatrix }        \\alpha & \\beta \\\\        0 & \\alpha^{-1 }",
    "\\end{pmatrix } :       \\mbox{$\\alpha , \\beta \\in { \\mbox{\\rm gf}}(2^n)$ and $ \\alpha \\neq 0 $ }    \\biggr\\}.\\end{aligned}\\ ] ] these subgroups have interesting mixing properties , albeit weaker ones than @xmath87 , which are explained in section  [ sec : mult - poly ] .",
    "we begin with the following definition , which provides a convenient terminology .    with respect to a primal basis for @xmath26 , an _ implementation _ of @xmath147",
    "is a quantum circuit consisting of one- and two - qubit gates that implements a unitary @xmath136 that induces @xmath135 .",
    "we first show that all elements of @xmath87 can be written as a product of a small constant number of matrices in a generating set  and more restrictive generating sets for @xmath165 and @xmath166 .",
    "then we describe clifford unitaries that induce these generating matrices . in subsequent sections ,",
    "we show how to implement these unitaries with @xmath1 quantum gates , thereby implementing elements of @xmath87 .",
    "[ lemma : gaussian_elim ] every element @xmath147 can be expressed as a product of a constant number of the following elements of @xmath87 : @xmath167 where @xmath168 is non - zero .    for any @xmath169",
    ", we can decompose it into a product as follows : @xmath170 furthermore , for any non - zero @xmath122 , there exists @xmath171 such that @xmath172 ( explicitly @xmath173 ) .",
    "this permits us to decompose further as @xmath174 and @xmath175    it is easy to specialize the above lemma to the lower triangular and upper triangular matrices in @xmath87 as follows .",
    "[ lemma : gaussian_elim - triangular ] every element of @xmath165 can be expressed as a product of a constant number of elements the form @xmath176 and every element @xmath166 can be expressed as a product of a constant number of elements of the form @xmath177 where @xmath168 is non - zero .    in view of lemmas",
    "[ lemma : gaussian_elim ] and  [ lemma : gaussian_elim - triangular ] , we can implement @xmath135 from @xmath87 ( or @xmath166 or @xmath165 ) by implementing @xmath178 for non - zero @xmath119 , @xmath179 , @xmath180 , and @xmath181 .",
    "first consider an element of @xmath87 of the form @xmath182 for any non - zero @xmath119 .",
    "an element of the clifford group that induces this is the _ multiply - by-@xmath183 _ ( in the primal basis ) operation @xmath121 defined ( eq .  ) promoted to a unitary operation via @xmath184 .",
    "] as @xmath185 . to check this , note that , for all @xmath186 , @xmath187 and , furthermore , @xmath188 it follows that , for all @xmath104 , @xmath189 .",
    "we summarize the effect of conjugating a pauli @xmath190 by @xmath121 on the binary strings @xmath89 and @xmath191 as the following mapping : @xmath192 here @xmath121 is the linear operator corresponding to multiplication by @xmath183 in the primal basis , as defined in eq .  ;",
    "@xmath193 , the transpose of @xmath194 , which ( due to the form of eq .  ) is the linear operator corresponding to multiplication by @xmath195 in the dual basis .",
    "now consider the element @xmath179 of @xmath87 .",
    "the element of the clifford group that induces this should transform the pauli @xmath190 along the lines of the mapping @xmath196 where @xmath197 is the linear operator for primal - to - dual basis conversion defined in eq .  .",
    "we can summarize this mapping .",
    "the entries of the square - bracketed @xmath126 matrix are linear operators on @xmath198 . ] as @xmath199 for _ any _ symmetric @xmath120 binary matrix @xmath197 , there is a clifford unitary that implements this mapping ( eq .  ) , namely @xmath200 defined as @xmath201 we begin with some preliminary observations .",
    "since , for all @xmath202 , @xmath203 , an equivalent definition is @xmath204 from this equivalent definition , it is clear that @xmath200 is in the clifford group , since it is computed by the following composition of gates : an @xmath75 gate acting on each qubit @xmath205 for which @xmath206 ; and a controlled-@xmath207 gate acting on qubits @xmath205 and @xmath208 for each @xmath209 where @xmath210 ( all these gates commute ) .",
    "this generic construction consists of @xmath6 gates . in sections  [ sec : mult ] and",
    "[ sec : mult - poly ] , we give two approaches that address the problem of computing @xmath200 with @xmath1 gates when @xmath197 is a suitable primal - to - dual basis conversion matrix .    to check that @xmath200 implements the mapping in eq .  , it is convenient to separately consider the diagonal and off - diagonal entries of @xmath197",
    ". let @xmath211 , where @xmath212 is diagonal and @xmath213 for all @xmath214 .",
    "clearly @xmath215 then @xmath216 and it is straightforward to check that @xmath217 for @xmath218 , we have @xmath219 and @xmath200 commutes with every @xmath145 . combining eqns .   and",
    ", we have @xmath220 which implies that @xmath200 implements the mapping in eq .  .",
    "finally , for completeness , we consider the form of a unitary operation that induces the element @xmath180 of @xmath87 .",
    "it should be noted that , in section  [ sec : mult ] , the @xmath197 that arises is trivial ; and , in section  [ sec : mult - poly ] , we bypass this operation altogether . to induce @xmath180 ,",
    "the required effect on paulis @xmath190 is @xmath221 this is the composition of two mappings : @xmath222 and @xmath223 the first mapping is induced by @xmath197 ( which is defined as the unitary operator @xmath224 ) , and the second mapping is induced by @xmath225 .",
    "our first approach is to represent @xmath26 in a self - dual basis .",
    "the advantage of using a self - dual basis is that , @xmath226 , which makes @xmath179 and @xmath180 very easy to implement with @xmath227 gates , using @xmath228 and @xmath225 respectively .",
    "this works because @xmath229 and @xmath230 .",
    "note , with respect to a self - dual basis , there is no distinction between @xmath191 and @xmath90 .",
    "the challenge of using a self - dual basis lies in the implementation of @xmath178 ( or @xmath121 , the field multiplication ) with respect to a self - dual basis .",
    "fast multiplication methods with respect to a polynomial basis are known ; however , no polynomial basis of @xmath231 is also self - dual if @xmath232 @xcite .",
    "our solution is to use special self - dual bases , constructed with _",
    "gauss periods _ , that can be efficiently converted to and from polynomial bases .",
    "such special self - dual bases are known for _ admissible _ @xmath0 s ( see definition [ def : adn ] below ) . according to @xcite , there are _ infinitely many _ admissible @xmath0 s under the extended riemmann hypothesis . our implementation and the rest of this section , are restricted to these values of @xmath0 :    [ def : adn ] a natural number @xmath0 is called _ admissible _ if the following two conditions hold : + ( 1 ) @xmath233 is prime + ( 2 ) @xmath234 , where @xmath235 is the index of the subgroup generated by @xmath16 in @xmath236 . + here",
    ", @xmath236 is the multiplicative group of @xmath237 which is cyclic with @xmath238 elements .",
    "thus @xmath239 .    in the remainder of this section ,",
    "we first describe the procedure of finding a self - dual basis using gauss periods , and briefly state the efficient conversion between these two representations .",
    "then we describe the structure of the implementation of @xmath121 .",
    "since , for admissible values of @xmath0 , @xmath233 is prime , fermat s little theorem implies @xmath240 .",
    "so @xmath233 divides @xmath241 , which implies that there is a primitive @xmath242-th root of unity @xmath243 .",
    "consider the set @xmath244 we first show that @xmath245 is a self - dual normal basis of @xmath231 over @xmath246 .",
    "then we show how to efficiently convert between @xmath245 and a polynomial basis .    for an admissible @xmath0 ,",
    "@xmath16 and @xmath247 generate @xmath236 ( i.e. , @xmath248 ) . a proof is given in @xcite .",
    "we illustrate the main idea behind an elementary proof as follows .",
    "let @xmath249 generate the cyclic group @xmath236 and @xmath250 for some natural number @xmath208 . since @xmath235 is the index of @xmath251 in @xmath236 , @xmath252 .",
    "furthermore , @xmath253 .",
    "since @xmath234 , there are integers @xmath254 such that @xmath255 and therefore , @xmath256 .",
    "so it must hold that @xmath257 and we can reorder the elements of @xmath245 as @xmath258 which , in @xmath231 , is equal to @xmath259 where @xmath260 is called a _ gauss period _ of type @xmath261 over @xmath246 .",
    "a special case of theorem 3.1 in @xcite implies that @xmath262 is a normal element in @xmath231 ( generating a normal basis as defined in section  [ sec : field - basics ] ) .",
    "then , from corollary 3.5 in @xcite , any normal basis of gauss period of type @xmath261 over @xmath246 is self - dual when @xmath263 , so , @xmath245 is self - dual , as claimed .",
    "next , we show how to efficiently convert between @xmath245 and a polynomial basis . for an element @xmath264 written in the basis @xmath245 ,",
    "i.e. , @xmath265 , we represent @xmath89 as @xmath266^t$ ] with respect to the spanning set @xmath267 . including the element @xmath45 makes this spanning set not a basis , but significantly simplifies the conversion between the two spanning sets : @xmath268 \\ , , \\label{eq : sprime } \\\\",
    "\\mathcal{t } = &     [ 1 , \\beta+\\beta^{-1},(\\beta+\\beta^{-1})^2,\\ldots,(\\beta+\\beta^{-1})^n ]   \\label{eq : t}\\end{aligned}\\ ] ] where the latter arises from adding @xmath45 to a polynomial basis . with abuse of notations ,",
    "we call the vector @xmath269 a _ self - dual spanning set _ and the vector @xmath270 a _ polynomial spanning set _ if the context is clear .",
    "the fact that @xmath270 is not a basis does not affect how we represent a field element as a polynomial based on @xmath270 , i.e. , @xmath271 , and fast multiplication of two polynomials of this form still works .",
    "we now describe the linear transformations @xmath272 and @xmath273 that interchange @xmath269 and @xmath270 : @xmath274 the transformations @xmath272 , @xmath275 between the linearly dependent spanning sets are not unique .",
    "a simple choice for @xmath272 is based on the binomial expansion of @xmath276 .",
    "more precisely , for general @xmath208 , we can define @xmath277 as @xmath278 and equations ( [ eq : convert1 ] ) and ( [ eq : convert2 ] ) follow .    finally , we turn to the circuit implementation for this converision , and the implementation for the field multiplication .",
    "the following theorem establishes the efficient representation conversion between @xmath270 and @xmath269 .",
    "[ thm4132 ] right multiplying @xmath272 ( @xmath273 respectively ) by the vector representation of an element in @xmath231 with respect to the spanning set @xmath270 ( @xmath279 respectively ) can be done using @xmath280 operations ( additions and multiplications ) in @xmath246 .",
    "the proof of the above theorem is shown in @xcite , from which a representation conversion circuit can be built with @xmath280 cnot gates .",
    "the intuition is that @xmath272 and @xmath273 can be decomposed as a product of @xmath20 matrices , each with @xmath227 1 s .",
    "since the linear transformation can be done with @xmath246 additions and multiplications , it can be implemented with cnot gates .    here",
    "we prove theorem [ thm4132 ] with a different approach  a recursive construction that also requires @xmath280 cnot gates .",
    "first consider @xmath277 as defined in eq .   where @xmath281 is a power of @xmath16 .",
    "taking @xmath282 as an example , @xmath283.\\end{aligned}\\ ] ]    we use two properties for @xmath277 when @xmath284 ( see @xmath285 above for an illustration ) : + ( 1 ) each @xmath277 consists of three non - zero blocks : two identical diagonal blocks which is @xmath286 and a block above the diagonal which we call @xmath287 ( which is almost like @xmath286 turned upside down ) .",
    "+ ( 2 ) the first row of @xmath287 contains only zero s .",
    "the @xmath288 row of @xmath287 is the @xmath289 row of @xmath286 .",
    "we first explain why these two properties hold , as illustrated in figure [ fig4133 ] .",
    "take the pascal s triangle ( mod 2 ) with @xmath208 rows , and rotate the entries 90 degrees counter - clockwise .",
    "this gives the ( nontrivial ) @xmath290 entries of @xmath277 when @xmath291 and @xmath292 is even .",
    "the stated properties for @xmath277 primarily comes from the fact that pascal s triangle ( mod 2 ) with @xmath208 rows consists of 4 triangles of @xmath293 rows , the middle one only has zero entries , and the other three are identical copies of pascal s triangle ( mod 2 ) with @xmath293 rows . also , the triangle is always left - right symmetric .",
    "proofs of these are readily obtained from lucas theorem representation of integers @xmath294 and @xmath0 , where @xmath295 , and @xmath296 is prime : @xmath297 then , @xmath298 ( see , online for example @xcite , or from the literature @xcite ) .     matrix .",
    "taking the left half of an @xmath299-level pascal s triangle and rotating counter - clockwise by 90 degrees , we obtain the @xmath285 matrix .",
    "note that the block @xmath300 is the horizontal reflection of the lower diagonal block @xmath301 with a downward shift , as described by property ( 2 ) .",
    "[ fig4133 ] ]    if we multiply @xmath277 to a vector , @xmath302    \\left[\\begin{array}{c }        v_1 \\\\        v_2    \\end{array}\\right ]    =     \\left[\\begin{array}{c }        l_{k/2 } \\ ; v_1 + \\gamma_{k/2 } \\ ; v_2 \\\\",
    "l_{k/2 } \\ ; v_2    \\end{array}\\right].\\ ] ] due to the relation between @xmath287 and @xmath286 , we can implement this computation by the circuit in figure  [ fig4131 ] . using standard recursion analysis",
    ", the circuit contains @xmath303 cnot gates .    ]    for general values of @xmath208 , let @xmath304 and apply the above construction to @xmath305 .",
    "the sub - circuit with the first @xmath208 registers and only those cnots between them gives a circuit for @xmath277 that still has size @xmath303 .",
    "a circuit for @xmath306 converting a vector from the self - dual representation to the polynomial representation can be obtained by running the circuit for @xmath277 backwards .",
    "the first qubit which corresponds to the additional `` 1 '' in @xmath269 is always @xmath307 and it remains untouched during the computation .",
    "therefore , the first qubit can be safely removed in the implementation .",
    "it is kept in the analysis for conceptual simplicity .",
    "finally , we are ready to give the recipe for the fast multiplication of two elements @xmath308 represented in the basis @xmath269 :    1 .   insert a zero at the beginning of the vector representations of @xmath89 and @xmath90 to get the vectors @xmath309 and @xmath310 with respect to the spanning set @xmath269 .",
    "2 .   convert @xmath309 and @xmath310 to new representations @xmath311 and @xmath312 with respect to the polynomial spanning set @xmath270 , using the circuit for @xmath275 .",
    "3 .   multiply @xmath311 and @xmath312 using schnhage s multiplication algorithm @xcite .",
    "the result is a vector with respect to the polynomial spanning set @xmath313 .",
    "4 .   apply linear transformation @xmath314 to the vector above so it is represented in the spanning set @xmath315 . then",
    ", discard the first element which is always 0 .",
    "the result is the vector representation with respect to the spanning set @xmath316 . since @xmath317 is the @xmath242-th root of unity in @xmath318 ( i.e. , @xmath319 ) , we have @xmath320 , @xmath321",
    ". therefore with @xmath0 additional @xmath246 cnots , the resulting vector can be reduced to the one with respect to the permuted self - dual normal basis @xmath245 .    in step 3 ,",
    "schnhage s multiplication algorithm @xcite uses a radix-3 fft algorithm to do fast convolution .",
    "readers not familiar with german may refer to @xcite for another description of schnhage s algorithm .",
    "this multiplication algorithm requires @xmath322 operations ( additions and multiplications ) .",
    "additions can be implemented with cnot gates .",
    "multiplications involved in this radix-3 fft are the ones between an element of @xmath323/\\left < x^{2m}+x^m+1\\right>$ ] ( for certain @xmath294 ) and @xmath324 ( which is a @xmath325-th root of unity in @xmath323/\\left < x^{2m}+x^m+1\\right>$ ] ) .",
    "the result of this kind of multiplications is a shift of coefficients and it can be implemented by swap gates .",
    "therefore , the whole multiplication method can be implemented with @xmath326 cnot gates . as an example , figure [ fig4132 ] shows the implementation of @xmath121 in @xmath327 .     for multiplication of @xmath89 by @xmath183 where @xmath328 .",
    "@xmath329 is an implementation of schnhage s multiplication algorithm .",
    "the input and output bits are with respect to a self - dual basis.[fig4132 ] ]    it is easy to show that the radix-3 fft algorithm has logarithmic depth : if the current step of this algorithm is working on a polynomial of degree @xmath208 , in the next recursion step , it will work in parallel on three polynomials of degree @xmath330 .",
    "the total number of steps ( i.e. , the depth of the circuit ) is therefore @xmath20 for a polynomial of degree @xmath0 . to multiply two polynomials of degree at most @xmath0 ,",
    "each recursion step essentially consists of three components : computing the radix-3 fft , recursively doing @xmath331 multiplications of polynomials of degree at most @xmath331 ( in parallel ) , and computing the inverse radix-3 fft . using a similar analysis , the depth of the polynomial multiplication circuit is @xmath332 .",
    "the logarithmic depth of the basis conversion circuit can be shown by its recursive structure ( e.g. , figure 4 ) .",
    "therefore , the depth of the circuit for @xmath121 is @xmath20 .",
    "the ancillary qubits can be reset to @xmath25 using standard techniques in reversible computing .",
    "the result is an implementation of @xmath121 for any non - zero @xmath119 with @xmath326 cnots .",
    "in this section we present alternative constructions in terms of _ polynomial _",
    "bases for @xmath26 . in such bases",
    ", there are elements of @xmath87 , such as @xmath180 , that we do not currently know how to implement with @xmath1 gates .",
    "however , we show that we can implement any lower triangular @xmath333 with @xmath1 gates  and also any upper triangular @xmath334 with respect to the dual basis of a polynomial basis .",
    "we then show how to combine these implementations to achieve pauli mixing .    to implement @xmath333",
    ", it suffices to do so for the generators @xmath178 ( @xmath335 ) and @xmath179 . when the primal basis is a polynomial basis , @xmath178 is straightforward to implement with @xmath18 clifford gates with depth @xmath20 directly from fast polynomial multiplication algorithms  @xcite . for @xmath179 ,",
    "this amounts to implementing @xmath200 defined in eqns .   and , where @xmath197 is the primal - to - dual basis conversion matrix of eq .",
    "since we are setting the primal basis to a polynomial basis , @xmath197 is a _ hankel matrix _ : for all @xmath336 , if @xmath337 then @xmath338 . we make use of this property in the next two subsections .",
    "to implement @xmath334 with respect to the dual basis ( i.e. , @xmath137 ) , it suffices to note that , with respect to the dual basis , the operations that induce @xmath178 and @xmath181 are @xmath339 and @xmath340 ( respectively ) .      here",
    "we provide an implementation of @xmath179 using @xmath18 gates that can be organized so as to have depth @xmath20 .",
    "this construction uses non - clifford gates ( the next subsection contains a construction in terms of clifford gates only that is slightly less efficient ) . the operation that we need to implement is @xmath200 ( defined in eqns .   and ) , where @xmath197 is the primal - to - dual basis conversion matrix of eq .  , which is a hankel marix .",
    "recall from eq .",
    "that @xmath341 note that the expression for the exponent of the phase is of the form @xmath342}\\ , w \\begin{bmatrix } c_{1 } \\\\",
    "c_{n } \\end{bmatrix},\\end{aligned}\\ ] ] where it is sufficient to use mod 4 arithmetic to compute the vector - matrix - vector product , since the base of the exponent is  @xmath118 ( it is not sufficient to use mod 2 arithmetic ) .",
    "the product of a hankel matrix with a vector reduces to convolution and hence to polynomial multiplication ( over the ring @xmath343 in this case ) .",
    "therefore , we can compute @xmath344 , defined as @xmath345 with a fast algorithm for polynomial multiplication over rings using only @xmath18 gates to @xmath346 by employing the improved algorithms for integer multiplication initiated by frer  @xcite . ]",
    "( see , for example , theorem  8.23 in  @xcite ) .",
    "then the correct phase to implement @xmath200 can be obtained from the @xmath238 ancillary qubits containing @xmath347 ( each @xmath348 is a two - bit string ) and the @xmath0 qubits containing @xmath349 as follows . for each @xmath214 , apply a controlled-@xmath207 gate between the high order bit of @xmath348 and @xmath350 and apply a controlled-@xmath75 gate between the low order bit of @xmath348 and @xmath350 .",
    "this implementation appears to require non - clifford gates , since the underlying ring is @xmath343 and addition mod 4 requires non - clifford gates ; also , the implementation explicitly uses controlled-@xmath75 gates .",
    "since this construction uses polynomial multiplications , it follows from the circuit depth analysis in section  [ sec : mult ] that the circuit depth of this construction is @xmath20 . in the next section ,",
    "we describe a different procedure for implementing @xmath351 that is slightly less efficient , but uses only clifford gates .      here",
    "we provide an implementation of @xmath179 using @xmath19 clifford gates that can be organized so as to have depth @xmath21 .",
    "the operation that we need to implement is @xmath200 ( defined in eqns .   and ) , where @xmath197 is the primal - to - dual basis conversion matrix of eq .",
    ", which is a hankel marix . in the previous section , we reduced the computation to a convolution in mod 4 arithmetic , and we needed non - clifford gates to compute this efficiently . here , we use a recursive procedure that is based on convolutions in mod 2 arithmetic , which can be performed efficiently with clifford gates .    to simplify our presentation",
    ", we assume that @xmath0 is a power of 2 ( though our approach can be generalized to arbitrary @xmath0 by dividing unevenly in the recursive step , as @xmath352 ) .",
    "we divide @xmath197 into four @xmath353 blocks as @xmath354 where @xmath355 are @xmath353 hankel matrices and @xmath356 .",
    "define @xmath357 clearly , @xmath358",
    "so we can implement @xmath359 , @xmath360 , and @xmath361 separately .",
    "we first show how to implement @xmath359 using @xmath18 gates . from eq .",
    ", @xmath362 and the expression for the exponent in the phase in eq .",
    "is of the form @xmath363}\\ , w^{(12 ) } \\begin{bmatrix } c_{1 } \\\\ \\vdots",
    "\\\\ c_{\\frac n2 } \\end{bmatrix},\\end{aligned}\\ ] ] where it is sufficient to use mod 2 arithmetic to compute the vector - matrix - vector product ( since the base of the exponent is @xmath247 ) .",
    "since a product of a hankel matrix with a vector reduces to convolution ( and hence polynomial multiplication over the field @xmath92 ) , we can compute the bits @xmath364 , defined as @xmath365 in @xmath366 ancillary registers using only @xmath18 gates .",
    "moreover , since the convolution is with respect to entries of @xmath197which are constants in our setting  all the gates can be clifford gates ( in fact , cnot gates ) .",
    "then we can apply @xmath227 controlled-@xmath207 gates between the bits @xmath364 and @xmath367 ( respectively ) to apply the phase that correctly implements @xmath359 .",
    "what remains is to compute @xmath360 and @xmath361 .",
    "each of these is equivalent to computing an instance of the original problem of size @xmath368 . in the bottom of the recurrence ( when @xmath197 is a @xmath369 matrix )",
    ", a single @xmath75 ( phase ) gate computes @xmath200 .",
    "the gate cost @xmath370 of the recursive procedure satisfies the recurrence @xmath371 whose solution satisfies @xmath372 this recursive construction needs polynomial multiplication in each recursion step . according to the circuit depth analysis for polynomial multiplication in section  [ sec : mult ] , the circuit depth is @xmath373 .      here",
    ", we show how to pauli mix by implementing @xmath136 for @xmath333 and @xmath137 for @xmath334 .",
    "we will explain our approach in two parts .",
    "in the first part , we explain the actual generation and construction of unitaries  which is simple , but not clearly a unitary 2-design . in the second part",
    ", we explain why the method actually works .",
    "the construction is based on the following decomposition of elements of @xmath87 , along the lines of eq .",
    ": @xmath374 note that all matrices in this decomposition are lower triangular , upper triangular , or @xmath375 .",
    "lower triangular matrices can be implemented in the primal basis ; upper triangular matrices can be implemented in the dual basis ; and @xmath375 can be implemented in any self - dual basis ( by @xmath225 ) .    the procedure to generate",
    "an element of the ensemble is as follows .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ * generation procedure : *    1 .",
    ": :    sample @xmath376 according to    the uniform distribution . 2.1 : :    if @xmath377 then set @xmath378 to    @xmath379 set @xmath380 to    @xmath381 construct the clifford group element    @xmath382 ( composition of two    circuits ) . 2.2 : :    else if @xmath383 then set @xmath135 to    @xmath384 construct the clifford group element    @xmath385 ( composition of two circuits ) .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    note that the composition in step 2.1 is along the lines of the first case of eq .",
    "and the composition in step 2.2 is along the lines of the second case of eq .  .",
    "in each case , a clifford group element with gate complexity @xmath18 ( or clifford gate complexity @xmath19 ) results ; however , the subset of all cliffords that can arise by this procedure does not have the structure of @xmath87 because of the disparate coordinate systems being used for the components .",
    "this concludes the description of the generation and construction of elements of the ensemble .",
    "we now explain why the ensemble resulting from the above procedure is a unitary 2-design in spite of the mismatched bases used to convert the matrices arising from eq .   into clifford unitaries .",
    "first , we consider the mixing property over the paulis that results from @xmath136 for a random @xmath333 , and similarly for @xmath166 .",
    "partition the non - zero elements of @xmath386 into these two ( disjoint ) subsets : @xmath387 r_2 & = \\bigl\\ { \\bigl(\\begin{smallmatrix } a \\\\",
    "b   \\end{smallmatrix}\\bigr ) \\in { \\mbox{\\rm gf}}(2^n)\\times { \\mbox{\\rm gf}}(2^n ) : \\mbox{$a \\neq 0 $ }   \\bigr\\}.\\end{aligned}\\ ] ] it is straightforward to verify that a random element @xmath333 uniformly mixes within @xmath388 and it uniformly mixes within @xmath389 in the following sense .",
    "[ lemma - lt - mixing ] let @xmath390 be chosen uniformly at random .",
    "then , for any @xmath391 , the distribution @xmath392 is uniform over @xmath388 and , for any @xmath393 , the distribution @xmath392 is uniform over @xmath389 .",
    "a similar result holds for @xmath166 with the components switched in the definitions of @xmath388 and @xmath389 ( we omit the simple proof of this ) .    to illustrate the consequences of lemma",
    "[ lemma - lt - mixing ] on the paulis , we can organize the @xmath0-qubit paulis into rows and columns where @xmath394 is in column @xmath89 and row @xmath90 .",
    "figure  [ fig : pauli - mix ] shows such a layout for the @xmath395 case where the identity pauli is excluded .    [ cols=\"^,^,^,^ \" , ]     based on lemma  [ lemma - lt - mixing ] , conjugating by @xmath136 for a uniformly distributed @xmath333 causes the first column to mix uniformly and also the complement of the first column ( consisting of all columns except the first ) to mix uniformly .",
    "we call this effect _ lower - triangular pauli mixing_. schematically , this is illustrated in figure  [ fig : lower - triangular - mixing ] .",
    "we can similarly define _ upper - triangular pauli mixing _",
    ", corresponding to a transposed version of figure  [ fig : lower - triangular - mixing ] .",
    "sampling @xmath334 and then constructing the clifford unitary @xmath137 achieves upper - triangular mixing .",
    "we define one additional form of mixing , that we call _ column pauli mixing _ , illustrated in figure  [ fig : column - mixing ] , where paulis in the first column do not change and any pauli in the complement of the first column mixes within its column . such mixing is accomplished by choosing @xmath396 for a uniformly random @xmath397 , and then constructing the clifford unitary @xmath136 .        from eq .",
    ", we can deduce that our procedure is applying a probabilistic mixture of the two procedures below . with probability @xmath398 it applies procedure a",
    "; with probability @xmath399 it applies procedure b ( @xmath399 is the probability that @xmath383 for a random @xmath400 ) .    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ * procedure a * :    1 .   apply an upper - triangular pauli mixing operation .",
    "2 .   apply a row pauli mixing operation ( independently from the first step ) .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ * procedure b * :    1",
    ".   apply @xmath225 ( thereby transposing the layout of the paulis ) .",
    "2 .   apply a lower - triangular mixing operation .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    we now prove that the above mixture of procedures a and b results in pauli mixing .",
    "the stochastic process of applying either procedure a or procedure b , with probabilities @xmath398 and @xmath399 ( respectively ) is pauli mixing .    for convenience ,",
    "let @xmath401 .",
    "first , consider the case of an initial pauli that is in the first row ( i.e. , it is of the form @xmath140 ) .",
    "then , as illustrated in figure  [ fig : first - row - mixing ] ,        if procedure a is applied , the result is a uniform distribution on the complement of the first column , where the probability of each pauli is @xmath402 . on the other hand ,",
    "if procedure b is applied , the result is a uniform distribution on the first column , where the probability of each pauli is @xmath403 .",
    "consider the mixture of these distributions ( procedure a with probability @xmath404 and procedure b with probability @xmath405 ) .",
    "since @xmath406 and @xmath407 , the result is the uniform distribution .",
    "next , consider the case of an initial pauli that is not in the first row ( i.e. , @xmath394 with @xmath408 ) .",
    "then , as illustrated in figure  [ fig : general - mixing ] ,        if procedure a is applied , the result is a two - level distribution : the probability of each pauli in the first column is @xmath402 ; the probability of each pauli in the complement of the first column is @xmath409 . on the other hand , if procedure b is applied , the result is a uniform distribution on the complement of the first column , where the probability of each pauli is @xmath402 .",
    "consider the mixture of these distributions ( procedure a with probability @xmath404 and procedure b with probability @xmath405 ) .",
    "since @xmath406 and @xmath410 , the result is the uniform distribution .",
    "we thank olivia di matteo for pointing out reference @xcite and aram harrow for pointing out reference @xcite . we thanks",
    "joachim von zur gathen , mark giesbrecht , and arne storjohann for discussions about finite field algorithms , and daniel gottesman and aram harrow for other discussions .",
    "this research was supported in part by canada s nserc and crc , a david r. cheriton graduate scholarship , and the u.s .",
    ".    10    s.  aaronson and d.  gottesman .",
    "improved simulation of stabilizer circuits .",
    ", 70:052328 , nov 2004 .",
    "quant - ph/0406196 .    c.  h. bennett , d.  p. divincenzo , j.  smolin , and w.  k. wootters .",
    "mixed - state entanglement and quantum error correction .",
    ", 54:38243851 , 1997 .",
    "w.  brown and o.  fawzi .",
    "decoupling with random quantum circuits . , 2013 .    w.  brown , and o.  fawzi .",
    "short random circuits define good quantum error correcting codes . in _ proceedings of the ieee international symposium on information theory _ , isit 13 , pages 346 - 350 .",
    "j.  l. carter and m.  n. wegman .",
    "universal classes of hash functions ( extended abstract ) . in _ proceedings of the ninth annual acm symposium on theory of computing _ , stoc 77 , pages 106112 , new york , ny , usa , 1977 .",
    "h.  f. chau .",
    "unconditionally secure key distribution in higher dimensions by depolarization .",
    ", 51(4):14511468 , 2005 .",
    "arxiv : quant - ph/0405016 .",
    "choi , completely positive linear maps on complex matrices .",
    ", 10:285290 , 1975 .    c.  dankert , r.  cleve , j.  emerson , and e.  livine .",
    "exact and approximate unitary 2-designs and their application to fidelity estimation .",
    ", 80:012304 , jul 2009 .",
    "i.  devetak . the private classical capacity and quantum capacity of a quantum channel .",
    ", 51:4455 , 2005 .",
    "arxiv : quant - ph/0304127 .",
    "d.  p. divincenzo , d.  w. leung , and b.  m. terhal .",
    "quantum data hiding .",
    ", 48(3):580598 , 2002 .",
    "arxiv : quant - ph/0103098 .",
    "j.  emerson , y.  s.  weinstein , m.  saraceno , s.  lloyd , d.  g.  cory .",
    "pseudo - random unitary operators for quantum information processing . , 302(5653):20982100 , 2003 .",
    "n.  fine .",
    "binomial coefficients modulo a prime .",
    ", 589592 , 1947 .    m.  frer .",
    "faster integer multiplication .",
    ", 39(3):9791005 , 2009 .",
    "s.  gao , j.  von  zur gathen , d.  panario , and v.  shoup .",
    "algorithms for exponentiation in finite fields . , 29(6):879  889 , 2000 .",
    "d.  gottesman the heisenberg representation of quantum computers . in _ proceedings of the xxii international colloquium on group",
    "theoretical methods in physics _ , pages 3243 , 1999 .",
    "d.  gross , k.  audenaert , and j.  eisert .",
    "evenly distributed unitaries : on the structure of unitary designs . , 48:052104 , 2007 .",
    "a.  w. harrow and r.  a. low .",
    "random quantum circuits are approximate 2-designs . , 291(1):257302 , 2009 .",
    "arxiv:0802.1919 .",
    "m.  hastings .",
    "randomizing quantum states : constructions and applications .",
    ", 5:255 , 2009 .",
    "arxiv:0809.3972 .",
    "p.  hayden , m.  horodecki , j.  yard , and a.  winter .",
    "a decoupling approach to the quantum capacity .",
    ", 15:719 , 2008 .",
    "p.  hayden , d.  leung , p.  w. shor , and a.  winter .",
    "randomizing quantum states : constructions and applications . , 250(2):371391 , 2004 .",
    "quant - ph/0307104 .",
    "p.  hayden , d.  w. leung , and a.  winter .",
    "aspects of generic entanglement . , 265(1):95117 , 2006 .",
    "quant - ph/0407049 .",
    "p.  hayden and a.  winter .",
    "counterexamples to the maximal @xmath296-norm multiplicativity conjecture for all @xmath411 . , 284(1):263280 , 2008 .    m.  hazewinkel .",
    ", volume  1 .",
    "elsevier , 1996 .",
    "d.  leung .",
    "choi s proof as a recipe for quantum process tomography .",
    "journal of mathematical physics , 44(2):528533 , 2003 .",
    "quant - ph/0201119 .",
    "r.  low . pseudo - randomness and learning in quantum computation .",
    "phd thesis , university of bristol , uk , 2010 .",
    "arxiv:1006.5227 .",
    "r.  lidl and h.  niederreiter . .",
    "cambridge university press , cambridge , revised edition , 1994 .",
    "s.  lloyd .",
    "capacity of the noisy quantum channel .",
    ", 55:16131622 , 1997 .",
    "m.  nielsen and i.  chuang .",
    "cambridge university press , 2000 .",
    "l.  riddle .",
    "a.  roy and a.  j. scott .",
    "unitary designs and codes . , 53(1):1331 , 2009 .",
    "a.  schnhage .",
    "schnelle multiplikation von polynomen ber krpern der charakteristik 2 . , 7(4):395398 , 1977 .",
    "p.  w. shor .",
    "the quantum channel capacity and coherent information . lecture notes , msri workshop on quantum computation , 2002 .",
    "available online at http://www.msri.org/publications/ln/msri/2002/ + quantumcrypto / shor/1/.    o.  szehr , f.  dupuis , m.  tomamichel , and r.  renner .",
    "decoupling with unitary approximate two - designs .",
    ", 15(5):053022 , 2013 .",
    "j.  von  zur gathen and j.  gerhard . .",
    "cambridge university press , 1999 .",
    "j.  von  zur gathen and f.  pappalardi .",
    "density estimates related to gauss periods . in _ cryptography and computational number theory _ , pages 3341 .",
    "springer , 2001 .",
    "j.  von  zur gathen , a.  shokrollahi , and j.  shokrollahi .",
    "efficient multiplication using type 2 optimal normal bases . in _ arithmetic of finite fields _ , pages 5568 .",
    "springer , 2007 .",
    "j.  watrous .",
    "naimark s theorem ; characterizations of channels .",
    "`` theory of quantum information '' lecture notes , https://cs.uwaterloo.ca/@xmath413watrous/lecturenotes.html .",
    "* lemma  [ lem : equivdef ] . * _ let @xmath38 be any ensemble of unitaries in @xmath30 . then , the following are equivalent : + ( 1 ) @xmath38 is degree-@xmath16 expectation preserving .",
    "+ ( 2 ) @xmath38 is @xmath16-query indistinguishable .",
    "+ ( 3 ) @xmath38 implements the full bilateral twirl .",
    "+ ( 4 ) @xmath38 implements the full channel twirl .",
    "_    * corollary [ cor : dagger ] . * _ for @xmath34 , let @xmath53 .",
    "+ ( a ) @xmath38 implements the full - bilateral twirl iff @xmath54 does .",
    "+ ( b ) @xmath38 implements the full channel twirl iff @xmath54 does .",
    "_    we will show , in order , ( 1 ) @xmath414 ( 2 ) @xmath414 ( 3 ) @xmath414 ( 1 ) , corollary [ cor : dagger](a ) , then , ( 2 ) @xmath414 ( 4 ) @xmath414 ( 3 ) , and finally corollary [ cor : dagger](b ) .",
    "\\(1 ) @xmath414 ( 2 ) : consider any distinguishing circuit @xmath41 making up to two queries of @xmath2 or @xmath40 .",
    "note that the output state @xmath46 is a product of matrices with at most two factors of @xmath2 and two factors of @xmath40 .",
    "thus , each entry of @xmath46 is a polynomial of degree at most @xmath16 in the matrix elements of @xmath2 and at most @xmath16 in the complex conjugates of those matrix elements . by hypothesis ,",
    "@xmath38 is degree-@xmath16 expectation preserving , thus the following holds entrywise : @xmath415 and @xmath38 is @xmath16-query - indistinguishable .",
    "\\(2 ) @xmath414 ( 3 ) : this follows from the definition that the bilateral twirl circuit is a special case of a 2-query distinguishing circuit @xmath41 .",
    "\\(3 ) @xmath414 ( 1 ) : let @xmath416 be a basis for @xmath417 .",
    "suppose @xmath38 implements the full bilateral twirl , so , @xmath418 , _ i=1^k p_i u_i u_i u_i^u_i^ = d ( u )",
    "u u u^u^. [ eq : btwirlrepeat ] since the density matrices span the complex hilbert space of all possible square matrices of the same dimension , the above relation holds if we replace @xmath43 by @xmath419 , for all @xmath420 .",
    "furthermore , we can left- and right - multiply the above equation by @xmath421 and @xmath422 .",
    "this gives _",
    "i=1^k p_i a_5|u_i|a_1 a_6|u_i|a_2 a_3|u_i^|a_7 a_4 |u_i^|a_8 = d ( u ) a_5|u|a_1 a_6|u|a_2 a_3|u^|a_7 a_4 |u^|a_8 . repeating the above for all possible @xmath423 and applying linearity implies eq .",
    "( [ eq : u2design ] ) and that @xmath38 is degree-@xmath16 expectation preserving .",
    "corollary [ cor : dagger](a ) : from definition  [ def:2queryu ] , @xmath38 is @xmath16-query - indistinguishable iff @xmath54 is .",
    "thus , by the equivalence between ( 2 ) and ( 3 ) , @xmath38 implements the full - bilateral twirl iff @xmath54 does .",
    "\\(2 ) @xmath414 ( 4 ) : this follows from the definition that the channel twirl circuit is a special case of a @xmath16-query distinguishing circuit @xmath41 .",
    "\\(4 ) @xmath414 ( 3 ) : we provide a proof for the most general unitary 2-design here .",
    "readers interested in the special ( but common ) case when the ensemble @xmath38 consists only of clifford unitaries and @xmath424 can consult appendix [ appendix : shortproof ] for a short proof .",
    "we begin with some relevant concepts in quantum information .",
    "let @xmath425 denote an orthonormal basis for @xmath426 , @xmath427 denote the set of all bounded @xmath31 matrices , and @xmath428 .",
    "let @xmath429 denote the identity map on @xmath427 .",
    "for any linear map @xmath430 , denote the _ choi - matrix _ of @xmath431 by @xmath432 @xcite .",
    "@xmath431 is completely positive if and only if @xmath433 is positive semidefinite @xcite ( see also @xcite ) .",
    "a quantum channel is a linear , trace - preserving , and completely positive map .",
    "suppose for every quantum channel @xmath49 , @xmath434 .",
    "then , @xmath435 . rephrasing this equality using eqs .",
    "( [ def : e - twirl - channel ] ) and ( [ def : haar - twirl - channel ] ) , we have _ i=1^k p_i ( u_i^i ) ( ) ( ( u_i i ) ( u_i^i ) ) ( u_i i ) = d(u ) ( u^i ) ( ) ( ( u i ) ( u^i ) ) ( u i ) .",
    "[ eq : channel2bilateraltwirl ] we transform each side of the above equation in @xmath436 steps , turning the choi matrix of the twirled channel into the bilateral twirl of an operator closely related to the choi matrix of @xmath49 .",
    "first , for the lhs of ( [ eq : channel2bilateraltwirl ] ) , we apply the transpose trick @xmath437 , where @xmath105 and @xmath438 denote the transpose and the complex conjugate respectively .",
    "second , we commute the conjugation by @xmath439 with @xmath440 .",
    "we apply similar manipulations on the rhs of eq .",
    "( [ eq : channel2bilateraltwirl ] ) .",
    "the equation becomes _",
    "i=1^k p_i ( u_i^u_i^t ) ( ) ( ) ( u_i u_i^ * ) = d(u ) ( u^u^t ) ( ) ( ) ( u u^ * ) .",
    "[ eq : channel2bilateraltwirl-2 ] third , we apply to eq .",
    "( [ eq : channel2bilateraltwirl-2 ] ) the _ partial transpose _ of the second system : for any @xmath441 , this linear map takes @xmath442 to @xmath443 .",
    "in particular , the partial transpose of @xmath444 is equal to @xmath445 where @xmath446 is the swap operator on @xmath447 .",
    "equation ( [ eq : channel2bilateraltwirl-2 ] ) becomes _",
    "i=1^k p_i ( u_i^u_i^ ) ( ) ( ) ( u_i u_i ) = d(u ) ( u^u^ ) ( ) ( ) ( u u ) [ eq : channel2bilateraltwirl-3 ] which says",
    "_ ^ ( ( ) ( ) ) = t _ ( ( ) ( ) ) .",
    "[ eq : channel2bilateraltwirl-4 ] altogether , the transpose trick , the commutation , and the partial transpose transform eq .",
    "( [ eq : channel2bilateraltwirl ] ) concerning the equality of the choi - matrices of the two channel twirls for @xmath49 into eq .",
    "( [ eq : channel2bilateraltwirl-4 ] ) establishing the equality of the two bilateral twirls of the matrix @xmath448 .",
    "it remains to apply eq .",
    "( [ eq : channel2bilateraltwirl-4 ] ) to a set of carefully chosen @xmath49 s to show that @xmath449 for a basis @xmath450 of the input space .",
    "this will show that @xmath54 implements the full bilateral twirl . by corollary [ cor : dagger ]",
    ", @xmath38 also implements the full bilateral twirl and the proof will be completed .",
    "we consider @xmath49 s with a specific form .",
    "let @xmath451 be the completely randomizing map on @xmath427 , i.e. , @xmath452 for all @xmath453 .",
    "note that @xmath454 .",
    "consider any bounded linear map @xmath455 that is trace preserving and for which @xmath456 is hermitian ( the latter property is called hermiticity preserving )",
    ". then , for sufficiently small , positive , @xmath457 , @xmath458 has positive semidefinite choi - matrix , and is therefore completely positive .",
    "furthermore , @xmath49 is linear and trace - preserving .",
    "so , @xmath49 is a quantum channel .",
    "when we apply eq .",
    "( [ eq : channel2bilateraltwirl-4 ] ) to such @xmath49 s , the @xmath451 terms cancel out ( because @xmath459 which is invariant under either bilateral twirl ) . therefore , eq .  ( [ eq : channel2bilateraltwirl-4 ] ) holds for all linear , trace and hermiticity preserving maps @xmath455 ( which are easier to construct than quantum channels ) .",
    "we are ready to show that @xmath460 for a basis @xmath450 of the input space .",
    "we take @xmath461 where @xmath462 is a basis for @xmath427 with the following additional properties : + ( 1 ) each @xmath463 is hermitian . + ( 2 ) @xmath464 . +",
    "( 3 ) @xmath465 . in particular ,",
    "@xmath466 is traceless for @xmath467 .",
    "+ ( 4 ) the swap operator has a simple representation in this basis , = _",
    "l=1^d^2 h_l h_l .",
    "such basis exists for all @xmath50 .",
    "when @xmath424 , @xmath463 can be taken to be proportional to the pauli matrices ( see eq .",
    "( [ eq : pauli - swap ] ) for the last condition ) . for general @xmath50",
    ", we show in appendix [ appendix : gell - mann ] that the _ generalized gell - mann matrices _ can be used to construct such @xmath463 s .",
    "we will verify that @xmath468 for all @xmath469 .",
    "first , the equality is immediate for @xmath470 .",
    "second , for each @xmath471 consider @xmath472 defined by @xmath473 , and @xmath474 for all @xmath475 .",
    "@xmath472 is trace - preserving since each @xmath466 is traceless for @xmath467 .",
    "furthermore , @xmath476 and partial transposing the second system gives @xmath477 , which is therefore hermitian .",
    "so , we can apply eq .",
    "( [ eq : channel2bilateraltwirl-4 ] ) to @xmath472 and conclude @xmath478 .",
    "third , because of the symmetry of the bilateral twirl , @xmath479 .",
    "fourth , let @xmath480 and consider @xmath481 such that @xmath482 , @xmath483 , and @xmath484 for all @xmath485 and @xmath486 . with arguments similar to the second case , @xmath487 .",
    "this completes the proof .",
    "corollary [ cor : dagger](b ) : we have established the equivalence between ( 3 ) and ( 4 ) , thus , by corollary [ cor : dagger](a ) @xmath38 implements the full channel twirl iff @xmath54 does .",
    "here , we consider the special case when @xmath488 is an ensemble with clifford unitaries and @xmath424 . we will show that if @xmath38 implements the full channel twirl then it implements the full bilateral twirl .",
    "the proof relies on several definitions in section  [ sec : pauli - mixing ] . we will show that if @xmath38 implements the full channel twirl then it is necessarily pauli mixing , and the rest follow from lemma [ lemma : pauli - mixing - to-2design ] .",
    "so , consider an ensemble @xmath488 with clifford unitaries @xmath489 such that @xmath52 for all quantum channels @xmath49 .",
    "take an arbitrary pauli matrix @xmath80 with @xmath81 and an overall phase so that @xmath490 .",
    "let @xmath491 . on one hand , @xmath492 .",
    "on the other hand , @xmath493 for some @xmath494 .",
    "note that for each @xmath118 , @xmath489 is in the clifford group so @xmath495 is a pauli matrix .",
    "thus , we have two kraus representations for the same twirled channel , both with kraus operators in the quotient pauli group @xmath67 , which is a basis for @xmath496 matrices over @xmath497 . invoking theorem 8.2 of @xcite concerning the degrees of freedom over these kraus operators , the @xmath118-th term of @xmath51",
    "can only contribute to the @xmath498 term of @xmath499 iff @xmath500 in @xmath67 .",
    "finally , each @xmath501 appears with equal weight in @xmath502 , thus the distribution @xmath503 is uniform over @xmath504 .",
    "we want @xmath462 to be a basis for @xmath427 with the following additional properties : + ( 1 ) each @xmath463 is hermitian .",
    "+ ( 2 ) @xmath464",
    ". + ( 3 ) @xmath465 .",
    "in particular , @xmath466 is traceless for @xmath467 .",
    "+ ( 4 ) the swap operator @xmath506 .",
    "+ we use the _ generalized gell - mann matrices _ for the construction .",
    "let @xmath464 .",
    "for @xmath507 , let @xmath508 where @xmath509 is a diagonal matrix with @xmath510 , @xmath511 , and @xmath512 for @xmath513 .",
    "for @xmath514 , let @xmath515 with any ordering .",
    "these @xmath516 @xmath463 s span @xmath427 .",
    "each @xmath463 is hermitian , and @xmath465 .",
    "finally , the expression for the swap operator @xmath517 can be verified by checking that each of the @xmath518 matrix entries on the rhs has the value given by the lhs .",
    "the verification involves routine arithmetic , each off - diagonal element involves only 2 terms , and the diagonal elements can be expressed as simple telescopic sums .",
    "* lemma [ lemma : pauli - mixing - to-2design ] . *",
    "_ let @xmath38 be an ensemble of clifford unitaries and @xmath86 be as defined in section  [ sec : pauli - mixing ]",
    ". if @xmath38 is pauli mixing , then @xmath86 implements the full bilateral twirl .",
    "_    the goal is to show that @xmath519 for all density matrices @xmath43 .",
    "note that both @xmath520 and @xmath521 are linear transformations on @xmath522 matrices .",
    "so , it suffices to show that @xmath520 and @xmath521 act identically on a basis for these matrices .",
    "we consider a basis that contains the identity matrix @xmath523 and the swap operator @xmath524 acting on @xmath238 qubits , completed with matrices @xmath135 trace orthonormal to @xmath523 and @xmath524 ( i.e. , @xmath525 )",
    ". we will prove the following three claims :        to prove the third claim , it suffices to show @xmath532 .",
    "this is because , for any @xmath533 matrices @xmath534 , @xmath535 . in turns ,",
    "this is due to the fact that @xmath536 ; applying the last identity to each unitary in @xmath86 and invoking linearity gives the desired result .",
    "we now show that @xmath532 .",
    "we make a crucial observation that @xmath537 , and thus @xmath538 now , we use the fact that @xmath67 is a basis for @xmath496 matrices to write @xmath539 for some @xmath540 .",
    "we take @xmath541 , so , the two conditions on @xmath135 can be rephrased as @xmath542 and @xmath543 . by linearity , we focus on analyzing @xmath544 for any @xmath545 . note that _ _ ( r_a r_b ) = _ i p_i ( u_i u_i ) ( u_i^u_i^ ) .",
    "[ eq : mixing2btwirl ] if @xmath546 , @xmath547 such that @xmath548 commutes with @xmath549 and anticommutes with @xmath550 .",
    "so , 2 _ j ( r_j r_j ) ( r_a r_b ) ( r_j^r_j^ ) + = _ j ( r_j r_j ) ( r_a r_b ) ( r_j^r_j^ ) + _ j ( r_j r_c r_j r_c ) ( r_a r_b ) ( r_c^r_j^r_c^r_j^ )  =   and @xmath551 . if @xmath552 , @xmath553 substituting the above into eq .",
    "( [ eq : mixing2btwirl ] ) and using the fact that @xmath38 is pauli mixing , we obtain _ _ ( r_a r_a ) = _ r_j _ n \\\\{i } r_j r_j = t [ eq : swap ] for a matrix @xmath105 independent of @xmath89 .",
    "putting all the pieces together , @xmath554"
  ],
  "abstract_text": [
    "<S> a unitary 2-design can be viewed as a quantum analogue of a 2-universal hash function : it is indistinguishable from a truly random unitary by any procedure that queries it twice . </S>",
    "<S> we show that exact unitary 2-designs on @xmath0 qubits can be implemented by quantum circuits consisting of @xmath1 elementary gates in logarithmic depth . </S>",
    "<S> this is essentially a quadratic improvement in size ( and in width times depth ) over all previous implementations that are exact or approximate ( for sufficiently strong approximations ) . </S>"
  ]
}