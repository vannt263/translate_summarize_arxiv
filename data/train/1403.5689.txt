{
  "article_text": [
    "a graphical model consists of a graph and a probability distribution that satisfies a _",
    "markov property _ of the graph , being a set of conditional independence constraints encoded by the graph .",
    "such models arise naturally in many statistical problems , such as contingency table analysis and covariance estimation .",
    "@xcite consider distributions over these distributions , which they term _ laws _ to emphasise the distinction from the underlying sampling distribution .",
    "laws arise primarily in two contexts : as sampling distributions of estimators and as prior and posterior distributions in bayesian analyses .",
    "specifically , @xcite focus on hyper markov laws that exhibit conditional independence properties analogous to those of the distributions of the model . by exploiting such laws ,",
    "it is possible to perform certain inferential tasks locally ; for instance , posterior laws can be calculated from subsets of the data pertaining to the parameters of interest .",
    "although other types of graphical model exist , we restrict ourselves to undirected decomposable graphs and directed acyclic graphs , which exhibit the special property that their markov distributions can be constructed in a recursive fashion by taking _",
    "markov combinations _ of smaller components . in the case of undirected decomposable graphs , for any decomposition @xmath0 of the graph @xmath1 , a markov distribution",
    "is uniquely determined by the marginal distributions over @xmath2 and @xmath3 [ @xcite , lemma  2.5 ] . by a recursion argument ,",
    "this is equivalent to specifying marginal distributions on cliques .",
    "a similar construction can be derived for directed acyclic graphs : the distribution of each vertex conditional on its parent set can be chosen arbitrarily , and the set of such distributions determines the joint distribution . as we demonstrate in section  [ sec : markov - equivalence ] , this property can also be characterised in terms of a partitioning based on _ ancestral sets_.",
    "it is this partitioning that makes the notion of hyper markov laws possible .",
    "in essence , these are laws for which the partitioned distributions exhibit conditional independence properties analogous to those of the underlying distributions . in the case of undirected decomposable graphs , a law @xmath4 for @xmath5 over @xmath6 ,",
    "the set of markov distributions with respect to @xmath1 , is _ weak hyper markov _ if for any decomposition @xmath0 , @xmath7.\\ ] ] weak hyper markov laws arise naturally as sampling distributions of maximum likelihood estimators of graphical models [ @xcite , theorem  4.22 ] . a more specific class of laws",
    "are those that satisfy the _ strong hyper markov property",
    "_ , where for any decomposition @xmath0 , @xmath8.\\ ] ] when used as prior laws in a bayesian analysis , strong hyper markov laws allow for local posterior updating , in that the posterior law of clique marginal distributions only depends on the data in the clique [ @xcite , corollary  5.5 ]",
    ".    however , hyper markov laws only apply to individual graphs : if the structure of the graph itself is unknown , then a full bayesian analysis requires a prior distribution over graphical structures , which we term a _ graph law_. very little information is available to guide the choice of such priors , with a typical choice being a simple uniform or constrained erds  rnyi prior .",
    "the aim of this paper is to extend the hyper markov concept to the structure of the graph itself .",
    "we study graph laws that exhibit similar conditional independence structure , termed _ structural markov properties_. these properties exhibit analogous local inference properties , and under minor assumptions , characterise exponential families , which serve as conjugate families to families of compatible markov distributions and hyper markov laws .",
    "the outline of the paper is as follows . in section  [ sec : background ]",
    "we introduce the terms and notation used in the paper , in particular the notion of a semi - graphoid to define what we mean by structure .",
    "section  [ sec : udg - smp ] develops the notion of a structural markov property and characterises such laws for undirected decomposable graphs .",
    "section  [ sec : order - direct - struct ] briefly develops a similar notion for directed graphs consistent with a fixed ordering . in section  [ sec : markov - equivalence ] we consider the notion of markov equivalence of directed acyclic graphs , and extend the structural markov property to these equivalence classes .",
    "finally , in section  [ sec : discussion ] we discuss some properties , computational considerations , and future directions .",
    "much of the terminology in this paper is standard in the graphical modelling literature . for this",
    "we refer the reader to texts such as @xcite or @xcite . for clarity and consistency ,",
    "the following presents some specific terms and notation used in this paper .      a _ graph _ @xmath1 consists of a set of _ vertices _ @xmath9 and a set of _ edges _ @xmath10 of pairs of vertices . in the case of undirected graphs",
    ", @xmath10 will be a set of unordered pairs of vertices @xmath11 ; in the directed case it will be a set of ordered pairs @xmath12 , denoting an arrow from @xmath13 to @xmath14 , of which @xmath14 is termed the _ head_. for any subset @xmath15 , @xmath16 will denote the induced subgraph with vertex set @xmath2 .",
    "a graph is _ complete _ if there exists an edge between every pair of vertices , and _ sparse _ if no edges are present ( the graph with empty vertex set is both complete and sparse ) .",
    "we focus on two particular classes of graphs .      a _ path _ in an undirected graph",
    "@xmath1 is a sequence of vertices @xmath17 such that @xmath18 , in which case we can say @xmath19 is _ connected _ to @xmath20 .",
    "sets @xmath21 are _ separated _ by @xmath22 if every path starting at an element of @xmath2 and ending at an element of @xmath3 contains an element of @xmath23 .",
    "a pair of sets @xmath0 is a _ covering pair _ of @xmath1 if @xmath24 .",
    "a covering pair is a _ decomposition _",
    "if @xmath25 is complete and @xmath2 and @xmath3 are separated by @xmath26 in @xmath1 .",
    "a decomposition is _ proper _ if both @xmath2 and @xmath3 are strict subsets of @xmath9 . for any set of undirected graphs @xmath27 , define @xmath28 to be the set of @xmath29 for which @xmath0 is a decomposition .",
    "a graph is _ decomposable _ if it can be recursively decomposed into complete subgraphs .",
    "an equivalent condition is that the graph is _ chordal _ , in that there exists no set which induces a cycle graph of length 4 or greater . throughout the paper we will take @xmath30 to be a fixed , finite set , and define @xmath31 to be the set of undirected decomposable graphs ( udgs ) with vertex set @xmath30 .",
    "the maximal sets inducing complete subgraphs are termed _ cliques _ , the set of which is denoted by @xmath32 . for any decomposable graph it is possible to construct a _ junction tree _ of the cliques .",
    "the intersections of neighbouring cliques in a junction tree are termed _ clique separators _ , the set of which is denoted by @xmath33 .",
    "the _ multiplicity _ of a separator is the number of times it appears in the junction tree .",
    "the cliques , separators , and their multiplicities are invariants of the graph .",
    "an undirected graph @xmath1 is _ collapsible _ onto @xmath34 if each connected component @xmath35 of @xmath36 has a boundary @xmath37 which induces a complete subgraph .",
    "note that if @xmath0 is a decomposition of @xmath1 , then @xmath1 is collapsible onto both @xmath2 and @xmath3 .",
    "a directed graph @xmath1 is _ acyclic _ if there exists a _",
    "compatible well - ordering _",
    "@xmath38 on @xmath9 , that is , such that @xmath39 for all @xmath40 . for any such @xmath38 ,",
    "the _ predecessors _ of a vertex @xmath14 is the set @xmath41 .",
    "the set of directed acyclic graphs ( dags ) on @xmath30 will be denoted by @xmath42 , and the subset for which @xmath38 is a compatible well - ordering is denoted by @xmath43 .",
    "a vertex @xmath13 is a _ parent _ of @xmath14 if @xmath40 . the set of parents of @xmath14",
    "is denoted by @xmath44 .",
    "conversely , @xmath13 is a _ child _ of @xmath14 .",
    "a set @xmath45 is _ ancestral _ in @xmath1 if @xmath46 .",
    "the minimal ancestral set containing @xmath47 is denoted by @xmath48 .",
    "the _ skeleton _ of a directed graph @xmath1 is the undirected graph obtained by replacing all the directed edges with undirected edges .",
    "the _ moral graph _ of @xmath1 , denoted by @xmath49 , is the skeleton of the graph obtained by adding ( if necessary ) an edge between each pair of vertices having a common child .",
    "let @xmath50 be a random vector on some product space @xmath51 , with distribution denoted by @xmath52 or @xmath53 .",
    "a _ model _ is a family of distributions @xmath54 for @xmath55 .",
    "following @xcite , a distribution over @xmath54 will be termed a _ law _ and denoted by @xmath4 .",
    "a random distribution following such a law will be denoted by @xmath5 .    for any @xmath56 , @xmath57 will denote the subvector @xmath58 , with @xmath59 or @xmath60 denoting its marginal distribution .",
    "the marginal law of @xmath61 will be denoted by @xmath62 .",
    "furthermore , for any pair @xmath63 , we can denote by @xmath64 the collection of conditional distributions of @xmath65 under @xmath53 , and by @xmath66 the induced law of @xmath67 under @xmath4 .",
    "we will use @xmath68 to indicate the existence of a bijective function ; for instance , we can write @xmath69 for any @xmath70 .",
    "when discussing the `` structure '' of a graphicalmodel , many authors use this term to refer to the graph itself .",
    "in particular , when they talk of `` estimating the structure , '' they mean inferring the presence or absence of individual edges of the graph .    in this paper , we take the view that `` structure '' refers to a set of conditional independence properties , and that a graph is merely a representation of this structure .",
    "this distinction is an important one : it implies that graphs that encode the same set of conditional independence statements must be treated as identical , leading to the notion of _ markov equivalence_. a more subtle but even more important point is that when investigating properties such as decompositions or ancestral sets , we are , effectively , looking at properties of sets of conditional independencies .    to make this more concrete , we use the notion of a _ semi - graphoid _ , a special case of a _ separoid _ [ @xcite ] , to describe the abstract properties of conditional independence .",
    "[ dfn : separoid ] given a finite set @xmath30 , a _",
    "semi - graphoid _ is a set @xmath71 of triples of the form @xmath72 , where @xmath73 , satisfying the properties :    for all @xmath63 , @xmath74 ;    if @xmath75 , then @xmath76 ;    if @xmath75 and @xmath77 , then @xmath78 ;    if @xmath75 and @xmath77 , then @xmath79 ;    if @xmath75 and @xmath80 , then @xmath81 .",
    "these properties match the well - established properties of conditional independence [ @xcite ] .",
    "we can define the semi - graphoid of a graph as the set of triples encoding its global markov property : the semi - graphoid of an undirected graph @xmath1 is @xmath82 and the semi - graphoid of a directed acyclic graph @xmath83 is the set @xmath84    we say that a joint distribution @xmath52 for @xmath50 is _ markov _ with respect to a semi - graphoid @xmath71 if @xmath85.\\ ] ] that is , a distribution is markov with respect to a graph if it is markov with respect to the semi - graphoid of the graph .",
    "we write @xmath6 or @xmath86 to be the set of distributions that are markov with respect to @xmath1 or @xmath71 .    similarly , a law @xmath4 is _ weak hyper markov _ with respect to the semi - graphoid if @xmath87.\\ ] ] however , the strong hyper markov laws can not be directly characterised in terms of the semi graphoid .",
    "semi - graphoids have a natural projection operation : for any set @xmath88 , we can define the projection onto @xmath89 of a semi - graphoid @xmath71 on @xmath30 to be @xmath90 under certain conditions , this can match the natural projection operation , the induced subgraph , of the underlying graph .",
    "for undirected graphs,@xmath91_u = { \\mathfrak{m}}(g_u)$ ] if and only if @xmath1 is collapsible onto @xmath89 [ @xcite , corollary  2.5 ] .",
    "for directed acyclic graphs , we have the weaker sufficient condition that if @xmath2 is ancestral in @xmath83 , then @xmath92_a = { \\mathfrak{m}}({{{\\mathcal{g}}}}_a)$ ] .",
    "we now extend the hyper markov framework to the case where the graph itself is regarded as a random object @xmath93 , taking values in the set of undirected decomposable graphs with vertex set @xmath30 ; equivalently , @xmath93 can be thought of as a random vector of length @xmath94 indicating the presence or absence of individual edges . as the graph is a parameter of the model , we term its distribution a _ graph law _ , denoted by @xmath95 .",
    "our aim is to identify and characterise hyper markov - type properties for @xmath93 .",
    "hyper markov laws are motivated by the property that graph decompositions allow one to decompose markov distributions into separate components . for a fixed graph @xmath96 , then any markov distribution @xmath97 is uniquely characterised by its marginals @xmath60 and @xmath98 , taking values in @xmath99 and @xmath100 , respectively [ @xcite , lemma  2.5 ] . moreover ,",
    "these can be chosen arbitrarily , subject only to the constraint @xmath101 .",
    "hyper markov laws are derived by imposing probabilistic conditional independence on this natural separation .    in a similar manner",
    ", graphs themselves can be characterised by their projections onto each part of a decomposition .",
    "[ prp : graph - product ] let @xmath102 and @xmath103 be decomposable graphs with vertex set @xmath2 and @xmath3 , respectively , such that both @xmath104 and @xmath105 are complete .",
    "then the graph @xmath1 with @xmath106 is the unique decomposable graph on @xmath107 such that :    @xmath108 ,    @xmath109 , and    @xmath0 is a decomposition of @xmath1 .    to satisfy ( i ) and ( ii )",
    ", the edge set must contain @xmath110",
    ". it can not contain any additional edges @xmath11 , as this would violate : ( i ) , if @xmath111 ; ( ii ) , if @xmath112 ; or ( iii ) , if @xmath113 and @xmath114 .",
    "in other words , a graph @xmath96 is characterised by @xmath16 and @xmath115 , and @xmath16 and @xmath115 can be chosen independently . moreover",
    ", this also decomposes the semi - graphoid , as @xmath1 is collapsible onto both @xmath2 and @xmath3 .",
    "we define the graph @xmath116 resulting from proposition  [ prp : graph - product ] to be the _ graph product _ of @xmath102 and @xmath103 , denoted by @xmath117    although we only use the graph product when @xmath118 is complete , the definition can be extended to the case where @xmath102 and @xmath103 are collapsible onto @xmath26 .    for a graph law @xmath95 over @xmath119 ,",
    "a straightforward way to extend the hyper markov property in this case would be to require that @xmath120.\\ ] ] note that in this case the term @xmath121 is redundant : if @xmath0 is a decomposition of  @xmath1 , then @xmath118 must be complete , and so we are left with a statement of marginal independence @xmath122 .",
    "a more general question remains : how might this property be extended to a graph law over all undirected graphs ?",
    "a seemingly simple requirement is that ( [ eq : smp - sub ] ) should hold whenever a decomposition exists .",
    "this motivates the following definition .",
    "[ dfn : smp ] a graph law @xmath95 over @xmath31 is _ structurally markov _ if for any covering pair @xmath0 where @xmath123 , then @xmath124 is independent of @xmath125 , conditional on @xmath0 being a decomposition of @xmath93 .",
    "this is written as @xmath126.\\ ] ]    in essence , the structural markov property states that the structures of different induced subgraphs are conditionally independent given that they are in separate parts of a decomposition .",
    "see figure  [ fig : udg - smp ] for a depiction .",
    "the use of braces on the right - hand side of ( [ eq : smp ] ) is to emphasise that the conditional independence is defined with respect to the _ event _ @xmath127 , and not a random variable as in the markov and hyper markov properties .",
    "in other words , we do not assume @xmath128 .",
    "being a decomposition , the existence of the remaining edges in @xmath124 ( ) is independent of those in @xmath125 ( ) . ]",
    "the graph product operation provides a very useful characterisation of the structural markov property .",
    "[ prp : sm - ratio ] a graph law @xmath129 is structurally markov if and only if for every covering pair @xmath0 , and every @xmath130 , @xmath131 where @xmath132 is the density of @xmath129 with respect to the counting measure on @xmath31 .    by proposition",
    "[ prp : graph - product ] , both @xmath133 , and so if @xmath134 , the statement is trivial . otherwise , the conditional density of a structural markov law is of the form @xmath135 the result follows by substitution into ( [ eq : sm - ratio ] ) .",
    "the structural markov property has an inherent divisibility property that arises on subgraphs induced by decompositions .",
    "first we require the following lemma .",
    "[ lem : sub - decomposition ] let @xmath0 be a decomposition of a graph @xmath1 , and @xmath136 a covering pair of @xmath2 with @xmath137 .",
    "then @xmath136 is a decomposition of @xmath16 if and only if @xmath138 is a decomposition of @xmath1 .",
    "recall that @xmath139 separates @xmath89 and @xmath30 in @xmath1 if and only if @xmath140 . since @xmath136 is a covering pair of @xmath2 , @xmath141 , and hence @xmath142 .",
    "if @xmath136 is a decomposition of @xmath143 , then @xmath144 , which implies that @xmath145 . since @xmath146 is complete , @xmath147 is a decomposition of @xmath1 .",
    "the converse result follows by the reverse argument .",
    "[ thmm : sm - subgraph ] let @xmath95 be a structurally markov graph law .",
    "then the conditional law for @xmath148 is also structurally markov .",
    "let @xmath136 be a covering pair of @xmath2 : if we restrict @xmath149 , then @xmath121 must be complete . as we are only interested in the case where @xmath136 is a decomposition of @xmath124 , then @xmath26 must be a subset of either @xmath23 or @xmath150 : without loss of generality , we may assume @xmath137 .",
    "since @xmath138 is a covering pair of @xmath30 , by the structural markov property , @xmath151 if @xmath152 is the indicator variable of an event @xmath153 , we can write @xmath154 by the properties of conditional independence [ @xcite ] , the term @xmath155 may be moved to the right - hand side .",
    "furthermore , we are only interested in the case where it equals @xmath156",
    ". hence we can write @xmath157 by lemma  [ lem : sub - decomposition ] , @xmath158 if and only if @xmath159 .",
    "so @xmath160 again , by lemma  [ lem : sub - decomposition ] , @xmath161 if and only if @xmath162 , hence : @xmath163      dawid and lauritzen ( @xcite ) define a _ meta markov model _ as a set of markov distributions that exhibits _ conditional variation independence _ , denoted by the ternary relation ( @xmath164 ) , in place of the conditional probabilistic independence of hyper markov laws ; see also @xcite .",
    "analogous structural properties can be defined for families of graphs .",
    "[ dfn : struct - meta - markov ] let @xmath27 be a family of undirected decomposable graphs on @xmath30 . then @xmath27 is _ structurally meta markov _ if for every covering pair @xmath0 , the set @xmath165 is the same for all @xmath166_b]$ ] .",
    "that is , @xmath167    in other words , this property requires that the set of pairs @xmath168 of @xmath169 be a product set .",
    "clearly the set @xmath31 of all decomposable graphs on @xmath30 is structurally meta markov .    as with probabilistic independence",
    ", we can characterise it in terms of the graph product operation .",
    "[ thmm : struct - meta - markov - gtimes ] a family of undirected decomposable graphs @xmath27 is structurally meta markov if and only if @xmath170 for all @xmath171 .",
    "this follows directly from proposition  [ prp : graph - product ] .",
    "theorem  [ thmm : struct - meta - markov - gtimes ] is particularly useful in that if a family of graphs is characterised by a specific property , we can show that it is structurally meta markov if this property is preserved under the graph product operation .",
    "[ exm : struct - meta - markov - maximal - clique ] the set of undirected decomposable graphs whose clique size is bounded above by some @xmath172 and whose separator size is bounded below by @xmath173 is structurally meta markov . to see this , note that a clique of @xmath174 must be a clique of either @xmath16 or @xmath175 ( and hence of either @xmath1 or @xmath176 ) , and therefore the graph product operation can not increase the size of the largest clique .",
    "similarly , it is not possible for a graph product to decrease the size of the smallest separator : a separator of @xmath174 must either be a separator of @xmath1 or @xmath176 , or be @xmath26 ( this is a consequence of lemma  [ lem : ctdecom ] ) .    in the case @xmath177 and @xmath178 , this is the set of forests on @xmath30 , and when @xmath177 and @xmath179 , this is the set of trees on @xmath30 .",
    "[ exm : struct - meta - markov - sandwich ] consider two graphs @xmath180 such that @xmath181 .",
    "then the `` sandwich '' set between the two graphs , @xmath182 is structurally meta markov .",
    "this follows from the fact that an edge can only appear in a graph product if it is in one of the elements of the product .    as with hyper markov laws , being a structural meta markov family is a necessary condition for the existence of a structural markov law .",
    "[ thmm : struct - markov - support - meta ] the support of a structurally markov graph law is a structurally meta markov family .",
    "let @xmath27 be the support of the structurally markov graph law @xmath129 with density @xmath132 . by proposition",
    "[ prp : sm - ratio ] , if @xmath171 and both @xmath183 and @xmath184 are nonzero , then @xmath185 must also be nonzero , and hence in @xmath28 . therefore , by theorem  [ thmm : struct - meta - markov - gtimes ] , @xmath27 is structurally meta markov .",
    "we now investigate how the structural markov property interacts with the markov and hyper markov properties . in order to do this ,",
    "we need to define families of distributions and laws for every graph .",
    "[ dfn : compat ] for @xmath186 , let @xmath187 be a family of probability distributions for @xmath55 .",
    "we write @xmath188 if , given @xmath189 , @xmath190 .",
    "then @xmath191 is _ compatible _ if :    for each @xmath192 , @xmath55 is markov with respect to @xmath1 under @xmath193 , and    @xmath194 whenever @xmath195 are collapsible onto @xmath2 and @xmath196 .",
    "similar properties can be defined for laws .",
    "[ dfn : hyper - compat ] for @xmath186 , let @xmath197 be a family of laws for the parameters @xmath5 of a family of distributions on @xmath55 .",
    "again , we can write @xmath198 if , given @xmath189 , @xmath199",
    ". then @xmath200 is _ hyper compatible _ if :    for all @xmath192 , @xmath201 is weak hyper markov with respect to @xmath1 , and    @xmath202 whenever @xmath203 are collapsible onto @xmath2 and @xmath196 .",
    "@xcite , section  6.2 , originally used the term compatible to refer to what we term the hyper compatible case : we introduce the distinction so as to extend the terminology to the distributional ( nonhyper ) case .",
    "as markov distributions and hyper markov laws are characterised by their clique - marginal distributions [ @xcite , theorems 2.6 and 3.9 ] , it is sufficient for condition ( ii ) in definitions [ dfn : compat ] and [ dfn : hyper - compat ] to hold when @xmath16 and @xmath204 are complete . moreover , if the complete graph @xmath205 is contained in @xmath27 , then the compatible and hyper compatible families are characterised entirely by @xmath206 and @xmath207 , respectively .",
    "[ exm : hyper - inv - wishart ] the _ inverse wishart law _ for the covariance selection model @xmath208 assigns @xmath209 .",
    "this law is strong hyper markov with respect to the complete graph on @xmath30 , and the hyper compatible family generated by @xmath4 are the _ hyper inverse wishart laws _ @xmath210 [ @xcite , example  7.3 ] .",
    "a law induces marginal distribution @xmath211 for @xmath55 such that @xmath212 $ ] , referred to as the _ predictive distribution _ in bayesian problems .",
    "therefore a family of laws will also induce a family of distributions .",
    "although in general hyper compatibility will not imply compatibility , there is one important special case .",
    "[ prp : compat - law - dist ] let @xmath200 be a family of laws such that each law @xmath213 is strong hyper markov .",
    "then the family of marginal distributions @xmath214 is hyper compatible .    by @xcite , proposition  5.6 , the marginal distribution of a strong hyper markov law is markov with respect to the same graph .",
    "the result follows by noting that the marginal distribution on a complete subgraph is a function of the marginal law .    a graph law @xmath95 combined with a compatible set of distributions @xmath191 defines a joint distribution @xmath215 for @xmath216 under which @xmath217 .",
    "likewise , @xmath129 combined with a set of hyper compatible laws @xmath200 defines a joint law @xmath218 for @xmath219 , and so a joint distribution on @xmath220 .",
    "the key conditional independence property of any such joint distribution or law can be characterised as follows .",
    "[ prp : compat - ci ] for any graph law @xmath129 over @xmath186 for @xmath93 , and @xmath221 for a compatible family @xmath191 indexed by @xmath27 , @xmath222.\\ ] ] similarly , if @xmath223 for a hyper compatible family @xmath200 indexed by @xmath27 , then @xmath224.\\ ] ]    let @xmath130 such that @xmath196 . as @xmath1 and @xmath176 are both collapsible onto @xmath2 ,",
    "then @xmath225 in a compatible family , and @xmath226 in a hyper compatible family .",
    "when combined with the structural markov property , we obtain some useful results .",
    "[ thmm : sm - mark ] if @xmath93 has a structurally markov graph law @xmath129 , and @xmath55 has a distribution from a compatible set @xmath191 , then @xmath227.\\ ] ]    see appendix [ sec : proofs ] .",
    "[ cor : sm - mark - post ] if @xmath93 has a structurally markov graph law , and @xmath55 has a distribution from a compatible set @xmath191 , then the posterior graph law for @xmath93 is structurally markov .",
    "by theorem  [ thmm : sm - mark ] and the axioms of conditional independence , we easily obtain @xmath228    we can also apply similar arguments at the hyper level .",
    "[ thmm : sm - hm ] if @xmath93 has a structurally markov graph law @xmath129 , and @xmath53 has a law from a hyper compatible set @xmath200 , then @xmath229.\\ ] ] furthermore , if each law @xmath230 is strong hyper markov with respect to @xmath1 , then @xmath231.\\ ] ]    the proof for the first case is the same as in theorem  [ thmm : sm - mark ] .",
    "the proof for the strong case follows similar steps , except starting with the strong hyper markov property @xmath232    hyper compatible sets of strong hyper markov laws have the additional advantage that the posterior graph law will also be structurally markov : this follows from theorem  [ thmm : sm - mark ] and @xcite , proposition  5.6 , which states that the marginal distribution of the data under a strong hyper markov law is markov .",
    "furthermore , the posterior family of graph laws @xmath233 will maintain hyper compatibility .",
    "we show that the family of structural markov laws forms an exponential family of conjugate distributions for bayesian updating under compatible sampling .",
    "[ dfn : charfn ] define the _ completeness vector _ of a graph to be the function @xmath234 such that , for each @xmath56 , @xmath235 furthermore , define the _ clique vector _ of a graph @xmath236 to be the mbius inverse of @xmath237 by _ superset _ inclusion @xmath238    in the language of @xcite , @xmath237 and @xmath239 are both _",
    "imsets_. the decomposition of @xmath237 and @xmath239 mirrors that of the graph .",
    "[ lem : ctdecom ] if @xmath96 , then @xmath240 ^ 0 + \\bigl[c ( { { \\mathcal{g}}}_b)\\bigr]^0 - \\bigl[c({{\\mathcal{g}}}_{a \\cap b } ) \\bigr]^0 \\quad\\mbox{and } \\label{eq : cdecom } \\\\",
    "t({{\\mathcal{g } } } ) & = & \\bigl[t({{\\mathcal{g}}}_a)\\bigr]^0 + \\bigl[t ( { { \\mathcal{g}}}_b)\\bigr]^0 - \\bigl[t({{\\mathcal{g}}}_{a \\cap b } ) \\bigr]^0 , \\label{eq : tdecom}\\end{aligned}\\ ] ] where @xmath241 ^ 0 $ ] denotes the expansion of a vector with zeroes to the required coordinates .",
    "a subset @xmath242 induces a complete subgraph of @xmath243 if and only if it induces a complete subgraph of @xmath16 or of @xmath115 ( or of both ) .",
    "( [ eq : cdecom ] ) follows by the inclusion - exclusion principle .",
    "( [ eq : tdecom ] ) may then be obtained by substitution into  ( [ eq : tcharfn ] ) .",
    "[ thmm : tform ] for any decomposable graph @xmath244 and @xmath56 , @xmath245 where @xmath32 are the cliques of @xmath1 , and @xmath33 are the clique separators , and each separator @xmath23 has multiplicity @xmath246 .    for any @xmath247 ,",
    "let @xmath248 be the graph on @xmath30 whose edges are the set of all pairs @xmath249 ( i.e. , complete on @xmath35 and sparse elsewhere ) .",
    "then it is straightforward to see that @xmath250 now let @xmath251 be a perfect ordering of the cliques of @xmath252 , and @xmath253 be the corresponding separators . by lemma  [ lem : ctdecom ]",
    ", it follows that @xmath254    objects similar to the clique vector have arisen in several contexts .",
    "notably , it appears to be equivalent to the index @xmath14 of lauritzen , speed and vijayan [ ( @xcite ) , definition  5 ] , which is characterised in a combinatorial manner .",
    "it is also closely related to the _ standard imset _ of @xcite , which is equal to @xmath255 where @xmath205 is the complete graph .",
    "the algorithm of @xcite for the enumeration of decomposable graphs is based on a generating function for the vector @xmath256 that he termed the `` maximal clique vector , '' and is equivalent to @xmath257    [ prp : tprop ] for any @xmath244 , the vector @xmath258 has the following properties :    @xmath259    for each @xmath260 @xmath261    @xmath262    @xmath263    by the mbius inversion theorem [ see , e.g. , @xcite , lemma  a.2 ] , @xmath237 can also be expressed in terms of @xmath239 , @xmath264 ( i ) and ( ii ) are @xmath265 at @xmath266 and @xmath267 , respectively , both of which induce complete subgraphs .",
    "( iii ) is obtained from ( ii ) by summation over @xmath260 , and ( iv ) is obtained from ( ii ) by double counting each edge via summation over both elements @xmath268 .",
    "[ dfn : clique - expon ] the _ clique exponential family _ is the exponential family of graph laws over @xmath186 , with @xmath239 as a natural statistic ( with respect to the uniform measure on @xmath31 ) .",
    "that is , laws in the family have densities of the form @xmath269 where @xmath270 is the normalisation constant , which will generally be hard to compute .",
    "equivalently , the distribution can be parameterised in terms of @xmath237 , @xmath271 but @xmath239 is more useful due to the fact that it is sparse ( by theorem  [ thmm : tform ] ) and , as we shall see , is the natural statistic for posterior updating .    note that this distribution is over - parametrised . by proposition",
    "[ prp : tprop](i ) and ( ii ) , there are @xmath272 linear constraints in the set of possible @xmath273 , adding multiples of @xmath274 , or @xmath275 to @xmath276 will leave the resulting @xmath132 unchanged . for the purpose of identifiability , we could define a standardised vector @xmath277 as @xmath278 such that @xmath279 , and @xmath280 for all @xmath260 .",
    "[ thmm : struct - markov - exponential ] let @xmath129 be a graph law whose support is @xmath31 . then @xmath129 is structurally markov if and only if it is a member of the clique exponential family .",
    "see appendix [ sec : proofs ] .",
    "it is possible to weaken the condition of full support ; for example , the same argument applies to any family @xmath27 with the property that if @xmath192 and @xmath35 is a clique of @xmath1 , then @xmath281 .",
    "a very similar family was proposed by @xcite ; however , their family allows the use of different parameters for cliques and separators , which will generally not be structurally markov .",
    "[ exm : uniform ] the simplest example of such a distribution is the uniform distribution over @xmath31 , which by proposition  [ prp : tprop](i ) , corresponds to @xmath282 being constant for all  @xmath2 .",
    "[ exm : binomial ] another common approach is to use a set of @xmath94 independent bernoulli variables with probability @xmath283 to indicate edge inclusion ( i.e. , an erds  rnyi random graph ) , conditional on @xmath93 being decomposable .",
    "the density of such a law is of the form @xmath284 by proposition  [ prp : tprop](iv ) , it follows that this distribution is a member of the exponential family with parameter @xmath285 more generally , the family with parameter @xmath286 would correspond to the extension where each edge @xmath287 has its own probability @xmath288 .    by adjusting parameters of the family , particular graphical features can be emphasised .",
    "for example , a family of the form @xmath289 with @xmath290 , will penalise clique sizes greater than 2 , placing a higher probability on forest structures .",
    "[ exm : armstrong ] for comparison , it is useful to consider a nonstructurally markov graph law . define the distribution over the number of edges to be uniform , and the conditional distribution over the set of graphs with a fixed number of edges to be uniform .",
    "this has density of the form @xmath291 specifically for graphs on three vertices , we have that @xmath292 therefore by proposition  [ prp : sm - ratio ] the law can not be structurally markov .",
    "we saw in corollary  [ cor : sm - mark - post ] that if the sampling distributions are compatible , then posterior updating will preserve the structural markov property . in this section",
    "we show that this updating may be performed locally , with the exponential clique family forming a conjugate prior for a family of compatible models .",
    "[ thmm : compatible - family - density ] let @xmath191 be a family of compatible distributions for @xmath55 , where each @xmath193 has density @xmath293 with respect to some product measure .",
    "then @xmath294_a},\\ ] ] for all @xmath295 such that @xmath296 , where @xmath297 is the marginal density of @xmath57 whenever @xmath16 is complete , and @xmath298 .",
    "for any decomposition @xmath0 of @xmath1 , then for any @xmath295 such that @xmath299 , @xmath300 the result follows by recursive decomposition over the clique tree",
    ".    therefore if the prior law for @xmath93 is a clique exponential with parameter @xmath276 , then under sampling from a compatible family the resulting posterior law is of the same family , @xmath301 \\cdot t({{\\mathcal{g } } } ) \\bigr\\}.\\ ] ]    a key benefit of this conjugate formation is that we can describe the posterior law with a parameter of dimension @xmath302 ( strictly speaking , we only need @xmath303 , due to the over - parametrisation ) .",
    "this is much smaller than for an arbitrary law over the set of undirected decomposable graphs , which would require a parameter of length approximately @xmath304 .",
    "we now investigate the first of two different methods by which the structural markov property might be extended to directed acyclic graphical models ( dags ) . in this section",
    ", we consider a law for a random graph @xmath305 over the set @xmath43 : the set of directed acyclic graphs that respect a fixed well ordering @xmath38 on @xmath30 .",
    "the set @xmath43 is straightforward to characterise , as @xmath38 determines the directionality of an edge between a pair of vertices .",
    "therefore , as in the undirected case , a random graph @xmath305 on @xmath43 can also be interpreted as a random vector of length @xmath94 .    in order to develop a structural markov graph law over @xmath43 ,",
    "recall that the strong directed hyper markov property can be expressed as @xmath306 for all @xmath260 .",
    "this in turn implies mutual independence of the collection @xmath307 .",
    "each element @xmath308 is constrained by @xmath1 only through the parent set @xmath44 , as we require that @xmath309 .",
    "this motivates the following definitions .",
    "the _ ordered remainder graph of @xmath83 of @xmath260 with respect to @xmath38 _ , denoted by @xmath310 is the graph on @xmath311 , and edge set @xmath312 , that is , the subgraph @xmath313 with the addition of all possible edges between elements of @xmath314 respecting @xmath38 .",
    "the ordered remainder graph directly corresponds to the parent set of the vertex , or equivalently , the set of vertices with a common head , @xmath315 the advantage of the remainder graph is that it allows the partitioning of the semi - graphoid into its constituent components .",
    "[ prp : order - partition ] let @xmath83 be a directed acyclic graph compatible with the ordering @xmath38 .",
    "then a distribution @xmath52 is markov with respect to @xmath83 if and only if for each @xmath260 , @xmath316 is markov with respect to @xmath310 .",
    "similarly , a law @xmath4 is weak / strong hyper markov if and only if for each @xmath260 , @xmath317 is weak / strong hyper markov with respect to @xmath310 .",
    "these follow from the ordered directed markov property .",
    "the motivation of the term `` remainder '' is that @xmath318 encodes the remainder of the semi - graphoid of @xmath319 that is not determined by @xmath320 .",
    "the graph law @xmath321 over @xmath43 is _ ordered directed structurally markov _ with respect to the ordering @xmath38 if for each @xmath260 , @xmath322    as @xmath323 , this implies that the set of all ordered remainder graphs , or equivalently , the set of all parent sets , are mutually independent ; see figure  [ fig : ordered - remainder ] .     on @xmath324 , subject to the ordering @xmath325 , and its corresponding ordered remainder graphs . under an ordered directed structural markov graph law , the ordered remainder graphs  or",
    "equivalently , the collections of like - coloured edges  are independent . ]",
    "admittedly this construction is not very complicated , but it does demonstrate how structure can be `` decomposed '' in directed graphs , which will be used in the next section .",
    "the approach in section  [ sec : order - direct - struct ] can not be applied directly to distributions over the @xmath42 , the set of all directed acyclic graphs on @xmath30 . for instance , parent sets of individual vertices can not be independent : if @xmath13 is a parent of @xmath14 , then @xmath14 is precluded from being a parent of @xmath13 .",
    "a bigger problem is that there is no longer a one - to - one correspondence between a graph and its semi - graphoid .",
    "that is , two or more distinct dags may have identical conditional independence properties , for example , , , and .",
    "[ dfn : dagoid ] let @xmath83 and @xmath326 be directed acyclic graphs such that @xmath327 . then @xmath83 and @xmath326 are termed _ markov equivalent _ , and we write @xmath328 a _ dagoid _ is a markov equivalence class of directed acyclic graphs .",
    "we define the _ complete _ and _ sparse _ dagoids to be the markov equivalence classes of complete and sparse dags , respectively .",
    "we use @xmath329 to denote the set of dagoids on @xmath30 .",
    "there are various methods of characterising markov equivalence , several of which are mentioned in the .",
    "so when specifying a law for directed acyclic graphs , we are left with the question of whether or not we should treat markov equivalent graphs as the same model . in other words , whether the model is defined by the graph or the set of conditional independence statements which it encodes . as noted earlier , we take the latter view .",
    "a further advantage of working with equivalence classes is that a smaller number of models needs be considered .",
    "unfortunately this may not be as beneficial as one may initially hope : @xcite observed empirically that the ratio of the number dags to the number of equivalence classes appears to converge to approximately @xmath330 as the number of vertices increases .",
    "although ancestral sets are used in the definition of the global directed markov property , ancestral sets themselves are not preserved under markov equivalence . however , as noted in section  [ sec : separoids ] , subgraphs induced by ancestral sets preserve the projection of the semi - graphoid .",
    "a somewhat trivial consequence is the following .",
    "[ prp : dag - ancestral - equiv ] let @xmath331 and @xmath56 be ancestral in both @xmath83 and @xmath326 . then @xmath332 .",
    "this motivates the following definition .",
    "[ dfn : dagoid - ancestral ] a set @xmath56 is _ ancestral _ in a dagoid @xmath333 if it is ancestral for some graph @xmath334 . for any such @xmath2 , define the _ subdagoid induced by @xmath2 _ to be the markov equivalence class of @xmath335 , and denote it by @xmath336 .    for any @xmath56 ,",
    "let @xmath337 denote the set of dagoids on @xmath30 in which @xmath2 is an ancestral set .",
    "note that the dagoid ancestral property is not as strong as the collapsibility property in undirected graphs , in that there can exist nonancestral sets that also preserve the semi - graphoid of the induced subgraph .    however , ancestral sets are still quite powerful , in that they can be used to decompose the semi - graphoid .    [ dfn : dag - insertion ] let @xmath83 be a directed acyclic graph on @xmath30 , of which @xmath2 is an ancestral set , and let @xmath102 be a directed acyclic graph on @xmath2",
    ". then the _ insertion of @xmath102 into @xmath83 _ , written @xmath338 is the directed acyclic graph on @xmath30 with edge set @xmath339.\\ ] ]    in other words , the edges between elements of @xmath2 are determined by @xmath102 , and all other edges are determined by @xmath83 .",
    "this operation preserves markov equivalence .",
    "[ lem : dag - insertion - equiv ] let @xmath83 and @xmath326 be markov equivalent graphs in which @xmath2 is an ancestral set , and @xmath102 and @xmath340 be markov equivalent graphs on @xmath2 .",
    "then @xmath341    we use the notation and results of appendix  [ sec : mark - equiv ] .",
    "both graphs must have the same skeleton .",
    "let @xmath342 be an immorality in @xmath343",
    ". then if @xmath344 , then @xmath342 must be an immorality of @xmath102 , and hence also an immorality of @xmath340 , and so also of @xmath345 .",
    "otherwise if @xmath346 , and at least one of @xmath347 or @xmath237 is not in @xmath2 , then @xmath342 must be an immorality of @xmath83 , and hence an immorality of @xmath326 and @xmath345 .    finally ,",
    "if @xmath346 and @xmath348 , then @xmath349 must not be an edge in the skeleton @xmath102 , nor an edge in the skeleton of @xmath340 .",
    "hence it must also be an immorality of @xmath350 .",
    "consequently for a dagoid @xmath333 with ancestral set @xmath2 , we can define the _ ancestral insertion _ of a dagoid @xmath351 on @xmath2 into @xmath333 as @xmath352,\\ ] ] where @xmath334 is a directed acyclic graph with an ancestral set @xmath2 , @xmath353 , and @xmath241 $ ] denotes the markov equivalence class .",
    "we use this approach to extend the notion of a remainder graph from the previous section without the use of a fixed well - ordering .",
    "[ dfn : dag - remainder ] let @xmath2 be an ancestral set of a directed acyclic graph @xmath83 .",
    "a  directed acyclic graph @xmath354 is a _ remainder graph of @xmath83 given @xmath2 _",
    "if @xmath355 where @xmath356 is a complete dagoid on @xmath2 .    by lemma  [ lem : dag - insertion - equiv ] ,",
    "the remainder graph must be unique up to markov equivalence .",
    "hence for a dagoid @xmath357 , we can uniquely define the _ remainder dagoid of @xmath333 given @xmath2 _ , denoted by @xmath358 ; see figure  [ fig : dagoids ] .     is an ancestral set of the dagoid containing @xmath83 , as it is ancestral in the graph @xmath326 obtained by reversing the covered edge @xmath359 .",
    "@xmath360 is obtained by replacing the edges between elements of @xmath2 with those of a complete graph on @xmath2 . ]",
    "analogous with the ordered case , the induced and remainder dagoids @xmath336 and @xmath361 characterise the complete dagoid ( via the ancestral insertion ) .",
    "moreover , they can be chosen independently .",
    "[ thmm : dagoid - variation - indep ] for any @xmath56 , we have @xmath362    for any @xmath363 , we can construct @xmath364 .",
    "this will have the required properties that @xmath365 and @xmath366 .",
    "this motivates the following construction for the structural markov property .",
    "[ dfn : dag - smp ] we say a graph law @xmath367 is _ structurally markov _ if for any @xmath56 , we have @xmath368.\\ ] ]    as in the undirected case , we can characterise this property via the odds ratio of the density .",
    "[ prp : dag - sm - ratio ] a graph law is structurally markov if and only if for any @xmath369 , we have @xmath370    as in proposition  [ prp : sm - ratio ] , we may write the density @xmath371      the equivalence class formulation of a dagoid is difficult to work with , both algebraically and computationally .",
    "instead we propose a characteristic vector similar to the clique vector of section  [ sec : clique - vector ] .",
    "[ dfn : d - clique ] the _ d - clique vector _ of a directed acyclic graph @xmath83 is @xmath372 + \\delta(\\varnothing ) \\in{\\mathbb{z}}^{2^v},\\ ] ] where @xmath373 .",
    "again , we note the relationship to the imsets of @xcite , specifically the structural imset @xmath374 in section  [ sec : mark - equiv - imsets ] . for our purposes ,",
    "the d - clique vector is a more convenient object with which to work .",
    "this exhibits analogous properties to those of the clique vector of section  [ sec : clique - vector ] .",
    "[ prp : dagoid - tprop ] the properties of proposition  [ prp : tprop ] apply to all directed graphs @xmath375 .",
    "\\(i ) follows directly from the definition .",
    "( ii ) is obtained by noting that each term of ( [ eq : d - clique ] ) contributes 1 if the summand is @xmath14 , and 0 otherwise . for ( iii ) , each term of ( [ eq : d - clique ] ) contributes 1 , and ( iv ) is due to each term of ( [ eq : d - clique ] ) counting the number of edges whose head is @xmath14 .    in a similar manner to the undirected case",
    ", we can define the _ d - completeness vector _ to be the mbius transform of the d - clique vector , @xmath376 and say that a set @xmath377 is _ d - complete _ if @xmath378 .",
    "this corresponds to the definition of the characteristic imset of @xcite .",
    "[ lem : d - complete - parents ] let @xmath38 be a well - ordering of a directed acyclic graph @xmath83 .",
    "for any nonempty set @xmath56 , with maximal element @xmath347 under @xmath38 , @xmath379    this provides the link to the completeness and clique vectors of undirected graphs from section  [ sec : clique - vector ] .",
    "[ cor : d - clique - perfect ] if @xmath83 is a perfect directed acyclic graph , and @xmath380 is its skeleton , then @xmath381 , and hence @xmath382 .",
    "most important , the d - clique vector is a unique representation of the dagoid .",
    "[ thmm : d - clique - markov - equiv ] let @xmath383 be directed acyclic graphs on @xmath30",
    ". then @xmath331 if and only if @xmath384 .    to show that the d - clique vector is preserved under markov equivalence , by theorem  [ thmm : dag - equiv - reversal ]",
    "it is sufficient to show that it is preserved under a covered edge reversal .",
    "if @xmath385 is a covered edge of @xmath83 , then the contribution of these vertices to the sum ( [ eq : d - clique ] ) is @xmath386 + \\bigl[\\delta\\bigl(\\{b\\ } \\cup { \\operatorname{pa}}_{{{\\mathcal{g}}}}(b)\\bigr ) - \\delta\\bigl({\\operatorname{pa}}_{{{\\mathcal{g}}}}(b)\\bigr ) \\bigr ] \\\\ & & { } + \\sum_{v \\ne a , b } \\bigl [ \\delta\\bigl(\\{b\\ } \\cup { \\operatorname{pa}}_{{{\\mathcal{g}}}}(b)\\bigr ) - \\delta\\bigl({\\operatorname{pa}}_{{{\\mathcal{g}}}}(b)\\bigr ) \\bigr ] + \\delta(\\varnothing).\\end{aligned}\\ ] ] by definition , @xmath387 , and",
    "so the corresponding terms will cancel . if @xmath388 is obtained from @xmath83 by reversing @xmath385 , note that @xmath389 and the remaining terms will be unchanged .",
    "hence @xmath390 .    to show that the d - completeness vector ( and hence , also the d - clique vector ) is unique to the equivalence class , by theorem  [ thmm : dag - equiv - immoral ]",
    "we can show that it determines the skeleton and immoralities . by lemma  [ lem : d - complete - parents ] , there is an edge between @xmath13 and @xmath14 in @xmath83 if and only if @xmath391 .",
    "likewise , @xmath392 is an immorality if and only if @xmath393 and @xmath394 .",
    "this cancellation of terms involving covered edges is very useful : as a consequence , the d - clique vector will generally be quite sparse . in line with the clique vector , we term a set @xmath56 such that @xmath395 a _ d - clique _ , and set @xmath2 such that @xmath396 a _ d - separator _ : see examples in figure  [ fig : d - clique ] .    ) and d - separators ( ) of different directed acyclic graphs . note that in the perfect dag , the d - cliques and d - separators are the cliques and separators of the skeleton .",
    "however , as in , d - separators may contain d - cliques . ]",
    "[ thmm : d - clique - ancestral ] let @xmath2 be an ancestral set of a dagoid @xmath333",
    ". then @xmath397 ^ 0 + t({{\\mathcal{d}}}_{v|a } ) - \\delta(a),\\ ] ] where @xmath241 ^ 0 $ ] denotes the expansion of the vector with zeroes to the required coordinates .",
    "let @xmath334 in which @xmath2 is ancestral , and @xmath38 be a well - ordering of @xmath83 in which elements of @xmath2 precede those of @xmath398",
    ". then @xmath399 the result follows after noting that @xmath400 = \\delta(a ) . \\ ] ]    we now arrive at the key result of this section : the dagoid structural markov property characterises an exponential family of graph laws .",
    "[ thmm : dsmp - exp ] let @xmath129 be a graph law whose support is @xmath329 .",
    "then @xmath129 is structurally markov if and only if it is a member of the exponential family with the d - clique vector as natural sufficient statistic , that is , if @xmath129 has density of the form @xmath401    see appendix  [ sec : proofs ] .",
    "[ exm : dagoid - uniform ] as in the undirected case , the simplest example of a structurally markov graph law is the uniform law over @xmath329 , on taking @xmath402 .",
    "[ exm : dagoid - erdos ] for any directed graph @xmath334 , let @xmath403 denote @xmath404 . by proposition  [ prp : dagoid - tprop ] , @xmath405 .",
    "so , for any @xmath406 , the graph law specified by @xmath407 is structurally markov , on taking @xmath408 .    however , we note that some simple laws are _ not _ structurally markov .",
    "[ exm : dag - uniform ] consider the law in which @xmath409 is proportional to @xmath410 , in other words , the uniform law on @xmath42 projected onto @xmath329 . then using @xmath241 $ ] to denote markov equivalence class",
    ", we note the size of the following dagoids : @xmath411 & = & \\bigl\\{\\mbox{\\includegraphics{1319i12.eps } } \\bigr\\ } , \\\\ { } \\bigl[\\mbox{\\includegraphics{1319i13.eps}}\\bigr ] & = & \\bigl\\{\\mbox{\\includegraphics{1319i13.eps}},\\mbox{\\includegraphics[raise=-3pt]{1319i14}}\\bigr\\ } , \\\\ { } \\bigl[\\mbox{\\includegraphics{1319i15.eps}}\\bigr ] & = & \\bigl\\{\\mbox{\\includegraphics{1319i15.eps}}\\bigr\\ } , \\\\ { } \\bigl[\\mbox{\\includegraphics{1319i16.eps}}\\bigr ] & = &   \\bigl\\{\\mbox{\\includegraphics{1319i16.eps } } , \\mbox{\\includegraphics{1319i17.eps } } , \\mbox{\\includegraphics[raise=-3pt]{1319i18 } } ,   \\mbox{\\includegraphics{1319i19.eps } } , \\mbox{\\includegraphics{1319i20.eps } } ,   \\mbox{\\includegraphics{1319i21.eps}}\\bigr\\}.\\end{aligned}\\ ] ] as a consequence , this law does not satisfy the property @xmath412\\bigr )   \\pi\\bigl(\\bigl[\\mbox{\\includegraphics[raise=-3pt]{1319i12}}\\bigr]\\bigr ) = \\pi\\bigl(\\bigl[\\mbox{\\includegraphics{1319i13.eps}}\\bigr]\\bigr )   \\pi\\bigl(\\bigl[\\mbox{\\includegraphics[raise=-3pt]{1319i15}}\\bigr]\\bigr)$ ] required by proposition  [ prp : dag - sm - ratio ] .",
    "we note that similar exponential families were proposed by @xcite . however , they treat markov equivalent graphs as distinct , and allow them to have different probabilities .      as with the undirected case ,",
    "a graph law is only part of the story . for each dagoid @xmath333",
    ", we also require a method to specify a markov sampling distribution and a law over such sampling distributions .",
    "[ dfn : dag - compat ] distributions @xmath53 and @xmath413 , markov with respect to directed acyclic graphs @xmath83 and @xmath326 respectively , are termed _",
    "graph compatible _ if , for every vertex @xmath14 such that @xmath414 , there exist versions of the conditional probability distributions for @xmath415 such that @xmath416 distributions @xmath53 and @xmath413 , markov with respect to dagoids @xmath333 and @xmath417 , respectively , are termed _ dagoid compatible _ if they are graph compatible for every pair of graphs @xmath418 .",
    "likewise , laws @xmath419 and @xmath420 , hyper markov with respect to @xmath83 and @xmath326 , respectively , are termed _ graph hyper compatible _ if for every vertex @xmath14 such that @xmath414 , there exist versions of the conditional laws for @xmath421 such that @xmath422 by @xcite , section  8.2 , the weak hyper markov property may be characterised in terms of @xmath423 , and so the weak hyper markov property can be defined with respect to a dagoid .",
    "laws @xmath419 and @xmath420 , that are hyper markov with respect to @xmath333 and @xmath417 , respectively , are _ dagoid hyper compatible _ if they are graph compatible for every pair of graphs @xmath424 .    as in the undirected case",
    ", we can define a family of compatible distributions @xmath425 and a family of hyper compatible laws @xmath426 if they are pairwise compatible or hyper compatible with respect to the relevant graphs .",
    "[ prp : dagoid - compat - ci ] suppose @xmath367 is a graph law over @xmath329 and @xmath191 is a family of compatible distributions",
    ". then @xmath427\\ ] ] and @xmath428.\\ ] ] likewise , if @xmath367 is a graph law over @xmath329 and @xmath200 is a hyper compatible family of laws , then @xmath429\\ ] ] and @xmath430.\\ ] ]    this is much the same as proposition  [ prp : compat - ci ] : for ( [ eq : dagoid - compat - ci-1 ] ) , the distribution of @xmath57 is determined by the parent sets of the vertices in @xmath2 in some @xmath431 in which @xmath2 is ancestral .",
    "likewise , in ( [ eq : dagoid - compat - ci-2 ] ) , the conditional distribution for @xmath432 is determined by the parent sets of vertices in @xmath433 .",
    "the same argument applies at the hyper level .",
    "note that in the definition of compatibility and hyper compatibility we specifically refer to _ versions _ of conditional probabilities and laws , as in some cases the conditional distributions / laws will not be uniquely defined , due to conditioning on null sets .    as the weak hyper markov property",
    "is defined on the separoid , the weak directed hyper markov property is well - defined for any dagoid .",
    "however , the strong form requires further conditions .",
    "[ dfn : strong - dagoid - hyper - markov ] a law @xmath419 over @xmath434 is _ strong hyper markov _ with respect to @xmath333 if it is strong directed hyper markov with respect to every @xmath334 .    if @xmath334 is perfect , then the strong dagoid hyper markov property is equivalent to the undirected strong hyper markov property on the skeleton of @xmath83 ; see @xcite [ ( @xcite ) , proposition  3.15 ] .",
    "the notion of hyper compatibility is equivalent to the `` parameter modularity '' property of @xcite .",
    "likewise , the strong hyper markov property is equivalent to their `` parameter independence . ''",
    "[ exm : dagoid - hiw ] for each vertex @xmath14 of a directed acyclic graph @xmath83 , we define the law for the conditional parameter @xmath435 to be the same as that of the inverse wishart @xmath436 . that is , using the notation of @xcite , we have @xmath437 where @xmath438 by the properties of the inverse wishart law",
    ", it follows that the law is preserved under covered edge reversals .",
    "therefore by theorem  [ thmm : dag - equiv - reversal ] , it is well defined for a dagoid , and so may be termed the _ dagoid hyper inverse wishart law_. note that this property is not satisfied by the more general inverse type - ii wishart family of @xcite .",
    "[ thmm : dagoid - struct - markov - strong - compat ] if @xmath200 is a family of strong hyper markov hyper compatible laws , then the family of marginal data distributions is compatible .    the hyper compatibility and the strong hyper markov property imply that , for any two dagoids @xmath439 and any @xmath440 , if @xmath414 for some @xmath260 , then @xmath441 therefore , the family of marginal data distributions @xmath442 will have @xmath443 = \\bar\\theta^{({{\\mathcal{d}}}')}(x_v { \\vert}x_{{\\operatorname{pa}}_{{{{\\mathcal{g } } } } } } ) = { \\mathbb{e}}_{\\mbox{\\scriptsize{{\\pounds}}}}^{({{\\mathcal{d } } } ' ) } [ { \\tilde{\\theta}}_{v|{\\operatorname{pa}}_{{{{\\mathcal{g } } } } } } ] . \\ ] ]    this is particularly useful because , as in the undirected case , the structural markov property will be preserved in the posterior under compatible sampling .",
    "[ thmm : dagoid - struct - markov - post ] suppose @xmath367 is a structurally markov graph law over @xmath329 and @xmath191 is a family of compatible distributions .",
    "then the posterior graph law for @xmath444 is structurally markov .    by the structural markov property and ( [ eq : dagoid - compat - ci-1 ] ) , we have @xmath445 and hence @xmath446 combining this with ( [ eq : dagoid - compat - ci-2 ] ) , we get @xmath447 and hence @xmath448      if it is possible to avoid the problem of conditioning on null sets , then as in the undirected case , a compatible family can be characterised by a distribution on the complete dagoid .    [ thmm : dag - compat - complete ]",
    "if the distribution on the complete dagoid has positive density @xmath449 with respect to some product measure , then the compatible distribution for any dagoid @xmath333 has density @xmath450_a}.\\ ] ]    let @xmath83 be an arbitrary graph in @xmath333 . then by compatibility , @xmath451^{t({{\\mathcal{d}}})_a}. \\ ] ]    as a consequence , if the graph law has a d - clique exponential family of the form  ( [ eq : dsmp - exp ] ) , and the sampling distributions are compatible with density of the form  ( [ eq : dag - compat - complete ] ) , then the posterior graph law will have density @xmath452 \\cdot t({{\\mathcal{d } } } ) \\bigr \\}.\\ ] ] that is , the d - clique exponential family is a conjugate prior under sampling from a compatible family .",
    "we have demonstrated how conditional independence can be used to characterise families of distributions over undirected graphs , ordered directed graphs , and equivalence classes of directed graphs .",
    "one point to emphasise is that all three structural markov properties are distinct , in that no one property can be derived as a special case of another ; for example , the undirected structural markov property does not arise from the dagoid structural markov property restricted to equivalence classes of perfect dags .",
    "one significant open question is how the full support requirements of theorems  [ thmm : struct - markov - exponential ] and [ thmm : dsmp - exp ] might be weakened .",
    "obviously these theorems would not hold for all subsets of graphs / dagoids , though we conjecture that they will hold for any structurally meta markov subsets .",
    "a related problem is characterising structurally meta markov subsets of graphs .",
    "one problem which we have not broached is the numerical calculation of such graph laws . except for",
    "the ordered directed case , where the computations can be done in parallel , for even small numbers of vertices it can quickly become infeasible to enumerate all graphs , and hence some sort of numerical approximation will usually be required .",
    "markov chain monte carlo ( mcmc ) methods are commonly utilised for this purpose .    for undirected decomposable graphs",
    ", @xcite proposed a method in which each iteration proposes adding or removing a single edge .",
    "they consider the problem of sampling from the posterior of a uniform prior with a compatible family sampling distributions , though this procedure can be applied to any structural markov graph law .",
    "this requires computing the metropolis ",
    "hastings acceptance ratio , @xmath453\\bigr\\},1 \\bigr ) , & \\quad$ { { \\mathcal{g}}},{{\\mathcal{g } } } ' \\in{{\\mathfrak{u}}}$ , \\vspace * { 2pt } \\cr 0 , & \\quad $ \\mbox{otherwise.}$ } \\ ] ] the results of @xcite [ ( @xcite ) , lemma  3 ] and giudici andgreen [ ( @xcite ) , theorem  2 ] characterise such so - called neighbouring graphs , and also imply that for any two such graphs @xmath454 , the vector @xmath455 has only 4 nonzero elements .",
    "consequently , for any structurally markov graph law over @xmath31 , the parameter @xmath276 need only be evaluated on 4 such places : this is particularly beneficial for posterior graph laws where each element of @xmath276 requires the evaluation of the marginal density of the model",
    ".    unfortunately , such algorithms often exhibit poor mixing properties [ @xcite ] , resulting in unreliable estimates . @xcite",
    "develop an extension for making proposals which add or remove multiple edges , resulting in faster mixing : this algorithm is also able to take advantage of local computations in computing the acceptance ratio .    for dagoids ,",
    "the problem is considerably more difficult .",
    "@xcite , @xcite and @xcite have developed methods for characterising the neighbouring dagoids ( i.e. , dagoids obtained by adding or removing an edge to a graph in the current dagoid ) .",
    "@xcite recently developed an mcmc scheme based on this approach : as in the undirected case , the acceptance ratio will also depend on a sparse vector , and so can be computed efficiently .",
    "more generally , the problem of finding the most probable graph under a structural markov law , which for posterior laws is known as maximum _ a posteriori _ ( map ) estimation , is an example of a _ strong decomposable search criterion _ [ @xcite , section  8.2.3 ] . as suggested by @xcite , linear and integer programming techniques based on the",
    "( d-)clique or ( d-)completeness vectors may provide elegant solutions to this problem .",
    "a further open question is how structural markov properties might be defined for other classes of graphical models , such as nondecomposable undirected graphs , ancestral graphs , and marginal independence ( bidirected ) graphs .",
    "the identification of such properties would rely on establishing constructions for partitioning the structure , analogous to decompositions and ancestral graphs .",
    "numerous techniques have been developed for determining whether two graphs are markov equivalent .",
    "the _ skeleton _ of a dag is the undirected graph obtained by substituting the directed edges for undirected ones .",
    "a triplet @xmath342 of vertices is an _ immorality _ of a dag @xmath83 if the induced graph @xmath456 is of the form @xmath457 .",
    "[ thmm : dag - equiv - immoral ] directed acyclic graphs @xmath83 and @xmath326 are markov equivalent if and only if they have the same skeleton and the same immoralities .      an edge of a dag @xmath83 is _ essential _ if it has the same direction in all markov equivalent dags .",
    "the _ essential graph _ of @xmath83 is the graph in which all nonessential edges are replaced by undirected edges .",
    "although not explored further in this work , the essential graph is a type of _ chain graph _ , a class of graphs that may have both directed and undirected edges .",
    "for further details on chain graphs , in particular their markov properties and how they relate to undirected and directed acyclic graphs , see @xcite and @xcite .",
    "[ thmm : dag - equiv - essential ] directed acyclic graphs @xmath83 and @xmath326 are markov equivalent if and only if they have the same essential graph .",
    "unfortunately , there is no simple criterion for determining whether or not an edge of a given dag is essential , although @xcite developed an iterative algorithm .",
    "this limits their usefulness .",
    "a convenient characterisation of markov equivalence can be given in terms of edge reversals .",
    "an edge @xmath458 of a dag @xmath83 is _ covered _ if @xmath459 .",
    "[ thmm : dag - equiv - reversal ] directed acyclic graphs @xmath83 and @xmath326 are markov equivalent if and only if there exists a sequence of dags @xmath460 such that each @xmath461 differ only by the reversal of one covered edge .",
    "this result is particularly useful for identifying properties that are preserved under markov equivalence , as it is only necessary to show that the property is preserved under a covered edge reversal .",
    "imsets for undirected decomposable graphs were briefly mentioned in section  [ sec : clique - vector ] .",
    "this formalism can be extended to directed acyclic graphs .",
    "the _ standard imset _ of a directed acyclic graph @xmath83 is [ @xcite , page 135 ] @xmath462,\\ ] ] where @xmath373 .",
    "[ thmm : dag - equiv - imset ] directed acyclic graphs @xmath83 and @xmath326 are markov equivalent if and only if @xmath463 .",
    "@xcite give details of the relationship between the imset and the essential graph of a dag , and how one may be obtained from the other .",
    "proof of theorem  [ thmm : sm - mark ] the markov property states that under @xmath464 $ ] , @xmath465 since if @xmath127 , then @xmath466 , we can rewrite ( [ eq : sm - mark-1 ] ) as @xmath467 as a consequence of proposition  [ prp : compat - ci ] , @xmath468 and combined with ( [ eq : sm - mark-2 ] ) , @xmath469 furthermore , by the structural markov property and proposition  [ prp : compat - ci ] , @xmath470 and we can further condition on @xmath471 .",
    "the result follows from this and ( [ eq : sm - mark-4 ] ) .",
    "suppose that @xmath129 is structurally markov .",
    "for any @xmath472 , let @xmath473 be a perfect ordering of the cliques , and let @xmath253 be the corresponding separators , and @xmath474 .",
    "furthermore , recursively define the graphs @xmath475 by proposition  [ prp : sm - ratio ] , for each @xmath476 , @xmath477 note that @xmath478 . then , by induction , @xmath479 by theorem  [ thmm : tform ] , where @xmath480 .",
    "proof of theorem  [ thmm : dsmp - exp ] if the law is in the exponential family ( [ eq : dsmp - exp ] ) , then , by theorem  [ thmm : d - clique - ancestral ] , @xmath483 - \\omega_a \\bigr\\ } \\propto p\\bigl({{\\mathcal{d}}}_a|{\\mathfrak{d}}(a)\\bigr ) p\\bigl({{\\mathcal{d}}}_{v|a } | { \\mathfrak{d}}(a)\\bigr),\\ ] ] and hence the law must be structurally markov .    for the converse ,",
    "define @xmath484 to be the dagoid in which the induced dagoid on @xmath56 is complete , but otherwise sparse ( in other words , the remainder dagoid , @xmath485 , of the sparse dagoid @xmath486 corresponding to complete independence ) .      by proposition",
    "[ prp : dag - sm - ratio ] , for @xmath489 , @xmath490 however , @xmath491 therefore , since @xmath492 , @xmath493 \\bigg/ \\biggl [ \\prod_{i=2}^d \\pi\\bigl({{\\mathcal{d}}}^ { ( { \\operatorname{pa}}(v_i))}\\bigr ) \\biggr],\\ ] ] which is of the form in ( [ eq : dsmp - exp ] ) with @xmath494"
  ],
  "abstract_text": [
    "<S> this paper considers the problem of defining distributions over graphical structures . </S>",
    "<S> we propose an extension of the hyper markov properties of dawid and lauritzen [ _ ann . </S>",
    "<S> statist . _ </S>",
    "<S> * 21 * ( 1993 ) 12721317 ] , which we term _ structural markov properties _ , for both undirected decomposable and directed acyclic graphs , which requires that the structure of distinct components of the graph be conditionally independent given the existence of a separating component . </S>",
    "<S> this allows the analysis and comparison of multiple graphical structures , while being able to take advantage of the common conditional independence constraints . </S>",
    "<S> moreover , we show that these properties characterise exponential families , which form conjugate priors under sampling from compatible markov distributions .    ./style / arxiv - general.cfg </S>"
  ]
}