{
  "article_text": [
    "in standard problems of radiation hydrodynamics ( rh ) where radiation contains a large fraction of the energy and momentum density , the boltzmann equation ( be ) must be coupled to the hydrodynamic equations in order to obtain the evolution of the system as well as the spectrum and angular distribution of the radiation field .",
    "however , an algorithm built to solve the be numerically ( a boltzmann solver ) in a non - stationary case is too time - consuming , from a computational point of view , to allow for the extension to more than one dimension of the existing numerical codes @xcite . in many cases , instead of the be , its _ angular moments _ are considered , obtaining then the multigroup ( or multi - frequency ) equations or the even simpler energy averaged equations .",
    "standard rh methods @xcite have found their way into the literature , and one can find several rh codes with different approaches for the radiation transport part , from single - energy - group ( or two temperature ) such as visphot @xcite or titan @xcite , to multigroup radiative transfer , such as stella @xcite .",
    "other authors built codes devoted more specifically to the radiation transport , but at the expense of detailed hydrodynamics .",
    "an example is the code eddington @xcite in which free expansion is assumed .",
    "the hydrodynamics part of most of the existing codes is a one dimensional implicit finite difference scheme , including artificial viscosity terms for problems requiring an accurate treatment of shock waves and discontinuities . during the last decade",
    ", a new subclass of numerical methods , the so - called godunov - type methods , has been gradually substituting the schemes based on numerical viscosity due to their easier extension to multidimensional cases and their greater capabilities in the treatment of strong shocks .",
    "the lack of a radiation transport method fully compatible with hydrodynamical godunov - type schemes is one of the motivations of these paper .    turning back to the radiation transport part , another important issue related to the angular moment equations is the closure relation . by taking angular moments of the distribution function the complexity of",
    "be is highly reduced , but the information about the angular dependence of the radiation field is partially lost .",
    "each @xmath0 angular moment equation of the be contains angular moments of higher order , thus any truncated hierarchy of moment equations contains more unknowns than equations and must be supplied with additional equations or _ closure relations _ @xcite . theoretically ,",
    "if the correct closure for a given problem is known , the solution obtained for the first moments of the distribution function by solving the moment equations should be the same as the solution obtained by solving the be .",
    "although the moment equations are much simpler to solve than the be , in many situations an additional simplification is made by neglecting some other terms , leading to the _ diffusion approximation _ ( da ) .",
    "in this approximation , however , the resulting energy flux can be higher than the limit predicted by causality , specially in the regions where the radiation mean free path becomes comparable to the characteristic length .",
    "different extensions of da , like _ flux - limited diffusion _",
    "@xcite or _ artificial opacities _ @xcite",
    "have being used to overcome this problem .",
    "these extensions only partially solve the breakdown of the da in the semi - transparent and transparent layers , and all of them are based on the same idea : to reintroduce some terms which had been dropped in the original assumptions of the da .",
    "the term which is usually kept out of the equations is the time derivative of the fluxes . by neglecting this term ,",
    "the character of the system of equations is changed to parabolic , and causality is therefore violated ( disturbances propagate at infinite velocity ) . in order to develop a method which is valid in all regimes ( from diffusion to free streaming ) while preserving causality , one must solve the full set of equations keeping its hyperbolic character .    in this paper",
    ", we address the problem of establishing a well - defined hyperbolic system of equations for the first angular moments of the be in the non - stationary spherically symmetric case .",
    "we will see that , besides the important question of its hyperbolicity , some constraints on the mathematical properties of the closure relations can be derived .",
    "they might help to disregard among some of the closures previously proposed .",
    "moreover , the behaviour of the characteristic fields of the hyperbolic system , which gives information on the velocity of perturbations , can also be used to establish additional constraints to the closures .",
    "a direct consequence of considering the moment equations in hyperbolic form is that it permits the application of powerful numerical techniques that have been developed in recent years for hyperbolic systems of conservation laws ( the equations of classical and relativistic fluid dynamics for perfect fluids , for example ) . among the different numerical techniques , the so - called high resolution shock capturing ( hrsc ) methods",
    "have a number of interesting features such that stability , being conservative , convergence to physical solutions and high accuracy in regions where the solution is smooth .",
    "hrsc methods are based on the resolution of local riemann problems ( an initial value problem with discontinuous data ) at the interfaces of numerical shells , ensuring a consistent treatment of discontinuities and steep gradients @xcite .",
    "their special relativistic extension @xcite has shown its potential in simulations of heavy ion collisions and extra - galactic jets , and different attempts to extend the method to general relativity have been done @xcite .",
    "we refer the interested reader to the recent reviews by mart & mller and ibez & mart for a detailed description of the current status of hrsc techniques in numerical relativistic hydrodynamics .",
    "although hrsc are specially designed for hyperbolic systems without source terms which corresponds to the transparent regime , we will show in numerical experiments that , by appropriate treatment of the sources , accurate solutions can be obtained also in the diffusion regime , where the source terms are dominant .",
    "the structure of the paper is the following : in  2 we summarise the deduction of the angular moment equations of the be in a spherically symmetric case , and for a static background .",
    "we also describe the general form of the collision terms when emission - absorption and iso - energetic scattering processes are included . in ",
    "3 we discuss the most common techniques used to solve the transport equations , such as diffusion or flux - limited diffusion , remarking their main features and limitations . in ",
    "4 the hyperbolic character of the equations and its implications for the closure relations are discussed . in  5 , the numerical techniques employed to solve the transport equations as a hyperbolic system of conservation laws are discussed .",
    "a number of numerical experiments solving the transport equations in several test problems are displayed in  6 , and the feasibility of the hyperbolic treatment in all kinds of regimes is demonstrated .",
    "finally , main conclusions and advantages of our proposal are summarised in  7 .",
    "we shall start our discussion from the radiative transfer equations in a static medium , deferring to a future work the inclusion of fluid velocity terms in the equations .",
    "although the restriction to zero velocity seems to be specific , there are some astrophysical scenarios where the assumption that matter is at rest is a reasonable approach .",
    "moreover , the inclusion of velocity terms , in some cases of interest does not change the essentials of our conclusions .    in a static background ,",
    "the boltzmann equation for massless particles in spherical coordinates can be written as follows . ]",
    "@xmath1 = \\left ( \\frac { d{\\cal i}}{d \\tau } \\right)_{coll}\\ ] ]    where @xmath2 is the invariant distribution function , @xmath3 is the cosine of the angle of the particle momentum with respect to the radial direction , @xmath4 the energy of the particle and the right hand side term is the invariant source or collision term coming from the interaction between the radiation field and matter .    as stated in the introduction , a common method of solving the be is the method of moments @xcite , which involves taking angular moments of the equation by applying the operator    @xmath5    denoting by @xmath6 , @xmath7 and @xmath8 the angular moments of the specific intensity @xmath9 , @xmath10 being the statistical weight ( @xmath11 for photons and @xmath12 for neutrinos ) @xmath13 the equations corresponding to the first two moments ( 0 and 1 ) of the be are :    @xmath14    @xmath15    where the moments of the collision term are defined as @xmath16 @xmath17    notice that , in the absence of velocity fields or strong gravitational fields , the different energy groups in a multifrequancy scheme are only coupled through the source terms , rendering the mathematical character of the left hand side of equations ( [ mom0])-([mom1 ] ) formally identical to the energy - averaged problem .      the most general form for the collision term including emission , absorption and isoenergetic scattering is the following :    @xmath18\\right)\\ ] ]    where @xmath19 is the emissivity , @xmath20 the absorption opacity including final states blocking ( for fermions ) or stimulated emission ( for bosons ) and @xmath21 the scattering opacity related to the scattering reaction rate ( @xmath22 ) through @xmath23 where @xmath24 is the angle between the in - going and outgoing particle and @xmath25 is the azimuthal angle .",
    "the opacities and the emissivity are expressed in units of inverse length .    for isotropic scattering the source terms appearing in equations ( [ mom0 ] ) and ( [ mom1 ] )",
    "can be written as @xmath26 @xmath27 where @xmath28 and @xmath29 is the value of @xmath6 in equilibrium with matter . in the above",
    ", we have assumed matter in local thermodynamic equilibrium ( lte ) , and only the radiation field ( photons or neutrinos ) is allowed to deviate from equilibrium .",
    "the conclusions of our study might be affected by large velocity fields or for frequencies close to line discontinuities , which are present in some astrophysical scenarios , and deserve a more careful study @xcite .",
    "one of the approaches most widely used to solve the transport equations numerically is the _ diffusion approximation _ , in which the invariant distribution function is assumed to be nearly isotropic in the comoving frame .",
    "thus an expansion in terms of legendre polynomials to the order @xmath30 is enough to maintain the main features of the radiation field @xmath31 where @xmath32 .",
    "consistent with this assumption , the time derivative of the flux is neglected in equation ( [ mom1 ] ) , and together with equation ( [ q1 ] ) gives the following relation for the flux in terms of the energy gradient @xmath33    as stated before , the da breaks down when the mean free path is large compared to the typical scale of the problem , and the fluxes calculated with the former formula may give non - causal values , in the sense that the flux can be greater than the energy density .",
    "this pathology comes from the fact that we have neglected some terms in the momentum equation in order to obtain a simple formula for the fluxes .",
    "flux limiters have been introduced _",
    "ad hoc _ in the literature to avoid this non - causal behaviour ; see , _",
    "e.g. _ , minerbo , levermore & pomraining or cernohorsky & bludman . in order to illustrate where the problems stem from , we begin by deriving the _ flux - limited diffusion _ equations .",
    "let us define the _ flux factor _ , @xmath34 , and the _ eddington factor _",
    ", @xmath35 : @xmath36 @xmath37 by subtracting equation ( [ mom0 ] ) multiplied by @xmath34 from ( [ mom1 ] ) , and after some algebra ( now keeping all terms ) , one obtains : @xmath38 where the quantities , including the flux and eddington factors , are now energy dependent .",
    "the explicit expression for the different _ opacities _ are @xmath39 @xmath40    the _ physical opacity _ , @xmath41 , or effective albedo only depends on the interaction of radiation with matter and includes an out  of  equilibrium correction to absorption opacity .",
    "the second term in the denominator , @xmath42 , is the multigroup extension of the so - called _ artificial opacity _",
    "@xcite and takes into account geometrical corrections and deviations from the diffusion limit ( it vanishes in the limit @xmath43 ) .",
    "the term in the numerator of equation ( [ fdif ] ) , @xmath44 , plays the role of a flux  limiter .",
    "it has the value @xmath45 in the diffusion limit and goes to zero as the free streaming limit ( @xmath46 , @xmath47 ) is reached . to close the set of equations , a closure relation for @xmath35",
    "is needed , and it is directly related to flux limiter @xmath48 .",
    "we will re - address the closure relation problem in next section .    with this description of the transport equations , the simple structure of the diffusion equation and its parabolic character",
    "is maintained when the first term in @xmath42 is neglected ( @xmath49 = 0 ) .",
    "the geometric and velocity field corrections can also be included through artificial opacities as corrections to the physical opacity .",
    "although the flux - limiter helps to avoid non - causal behaviour in the sense @xmath50 , causality is also violated when the time derivative of @xmath34 is neglected , because the character of the equations change to parabolic , which results in an infinite speed of propagation of the information . by keeping this term ,",
    "the diffusion scheme is , in some applications , numerically unstable and further numerical tools are needed to handle these instabilities .",
    "this is the subject of the next section .",
    "the system of equations ( [ mom0 ] ) and ( [ mom1 ] ) can be written in a compact form as follows @xmath51 where the vectors @xmath52 and @xmath53 are @xmath54 @xmath55 and the sources @xmath56 , according to equations ( [ s0]-[s1 ] ) , are given by @xmath57 notice that the sources are free of partial derivative operators .",
    "the above system of equations ( [ system ] ) is said to be a hyperbolic system of conservation laws ( with source terms ) when the jacobian matrix associated to the _ fluxes _ , @xmath58 , has real eigenvalues and there exists a complete set of corresponding eigenvectors . to analyse the jacobian matrix",
    ", we will assume that the eddington factor is only a function of the flux factor @xmath59 .",
    "this assumption is commonly used by a number of authors who have proposed different closure relations or flux - limiters in the context of flux - limited diffusion . in this case , the jacobian matrix is _ = ( ) where @xmath60 .",
    "the eigenvalues of the above matrix are @xmath61 and the right eigenvectors are @xmath62 the mathematical character of the system of equations ( [ system ] ) depends on the value of the discriminant in equation ( [ lambda ] ) , which can be written as follows [ disc ] = ( p-2f)^2 + 4(p -f^2 ) . since @xmath35 and @xmath34 are normalised moments of a non  negative weight function , on the unit sphere , there is an extra relation between @xmath34 and @xmath35 , the _ schwarz inequality _ [ schw ]",
    "f^2 p 1  , that ensures that for any closure satisfying ( [ schw ] ) the eigenvalues are always real and hence the hyperbolic character is guaranteed .",
    "in addition , causality imposes that the velocity of propagation of perturbations must be smaller than the speed of light , which gives another constraint on the eigenvalues | _ | 1  , that can be expressed in terms of @xmath34 , @xmath35 and @xmath63 as follows - p .",
    "[ ppb ] this restriction , together with equation ( [ schw ] ) and the condition @xmath64 , defines the region in the @xmath65 $ ] space allowed for causal closures .    in many astrophysical problems , radiation diffuses out from a central opaque region to an outer optically thiner region .",
    "in such a scenario , the radiation angular distribution is nearly isotropic in the central region ( @xmath66 ) and forward peaked in the transparent region , far from the opaque centre ( @xmath46 ) .",
    "thus , the closure in that problem must satisfy p(f=0)= p(f=1 ) = 1 .",
    "the first limit comes from the diffusion approximation while the second limit comes from the schwarz inequality ( [ schw ] ) , and both are satisfied by all the closures found in the literature ( see table i ) .",
    "another general property is that , in the diffusion regime the eddington factor has the constant value of @xmath67 , thus another restriction on the derivative can be imposed [ cons2 ] p(f=0 ) = 0  , that leads to the characteristic speeds @xmath68 . in the limit @xmath69 , equations ( [ schw ] ) and ( [ ppb ] ) gives the bounds @xmath70 and the eigenvalues in this limit are @xmath71 and @xmath72 . according to the theory of hyperbolic systems ,",
    "this result can be interpreted as a first wave propagating outwards at the speed of light and a second wave with a characteristic speed that depends on the value of @xmath63 .",
    "although @xmath73 depends on the form of the closure , for @xmath69 the amplitude of this second wave is zero and the value of @xmath63 does not affect the evolution .",
    "however , for @xmath34 close but not equal to one , the choice of @xmath63 can be important , as we will show in section  5.2 .",
    "similar conclusions can be obtained for the case @xmath74 .    in table 1",
    "we summarise the main properties of some of the most widely used closures : minerbo , lp @xcite , the linear formula by auer , kershaw s parabolic approach @xcite , the flux - limiters used by bruenn and bowers & wilson , janka s fit to montecarlo simulations of neutrino transport in supernovae @xcite and that corresponding to an isotropically emitting sphere @xcite , named _",
    "vacuum_.    there are several comments about table i that we would like to address .",
    "first , one closure relation ( bw ) leads to non - causal values of one eigenvalue in the diffusion regime .",
    "secondly , four closures do not satisfy the condition @xmath75 ( auer , bruenn , bw , vacuum ) .",
    "auer s formula failure is due to an excessive simplification ( it is a linear approach ) while vacuum has been obtained from the assumption of an isotropically radiating sphere , which restricts their validity to @xmath76 .",
    "the closure relations proposed by kershaw , janka , minerbo and lp have the common features of preserving causality leading to reasonable values of the characteristic velocities ( @xmath68 ) in the diffusion regime .",
    "thirdly , it is worthy to point out that all the closures except auer s give @xmath77 when approaching the radially - streaming limit @xmath78 , which makes both eigenvalues be positive .",
    "it ensures that no information can be propagated inwards for sufficiently high values of @xmath34 .",
    "it is clear that these closures can not be used to treat problems in which a small perturbation is propagating inwards from the transparent region , as we will show in next section .    in a more general situation ,",
    "the eddington factor depends on both , the flux factor and the occupation density corresponding to the zeroth angular moment of the distribution function , @xmath79 .",
    "the jacobian matrix associated to the fluxes is    @xmath80 and now the eigenvalues are @xmath81 where the discriminant is @xmath82    in contrast to ( [ disc ] ) , the sign of the discriminant might be negative for negative values of @xmath83 , and the system would become elliptic instead of hyperbolic . as stated before ,",
    "hyperbolic equations are related to finite speeds of propagation of the perturbations , while elliptic equations are related with boundary problems and do not allow for solutions with propagating signals .",
    "this fact indicates that , in order to preserve hyperbolicity , only closures which give positive values of the discriminant should be considered .",
    "a closure of this kind has been proposed by cernohorsky & bludman using arguments of maximum entropy .",
    "minerbo s , lp s and the vacuum closures can be obtained as limiting cases of cb closure in the low occupation limit ( classical statistics ) , large ocuppation limit for bose - einstein statistics and maximal forward packing limit for fermi - dirac statistics , respectively .",
    "we have checked that cb closure gives real and causal eigenvalues for both , bose - einstein and fermi - dirac statistics , in any regime .",
    "the numerical code employed for the calculations presented in  6 is a finite finite difference scheme in which the left ( l ) and right ( r ) states for the riemann problems set up at each interface have been obtained with a monotonic , piecewise linear reconstruction procedure @xcite .",
    "the numerical fluxes are evaluated following the idea of harten , lax & van leer , that is based on approximate solution of the original riemann problem with a single intermediate state .",
    "the resulting numerical flux is given by ^hll = where @xmath84 and @xmath85 .",
    "the time - advance algorithm is a tvd - preserving , third order runge - kutta that takes into account the influence of the source terms in intermediate steps . the source term in this problem",
    "deserves a special mention .",
    "it acts as a relaxation term which leads to a long - time behaviour governed by the reduced parabolic system described in section  3 .",
    "although high resolution methods for hyperbolic conservation laws usually fail to capture this feature ( unless a very fine grid is used ) , the use of a modified flux @xcite and an implicit linearization of the source term in each runge - kutta step allows us to succeed in the treatment of such stiff relaxation term with coarse grids and time - steps longer than the source time - scale ( @xmath86 ) , as we will show in subsection  6.1 .",
    "although we have constrained the numerical experiments to situations when only scattering processes are permitted , the inclusion of absorption - emission processes can be treated in a similar way .",
    "however it introduces energy and momentum exchange with the matter and makes necessary to solve the equations of radiation transport coupled with the equations of hydrodynamics or the equations of hydrostatic equilibrium with number and heat transfer .",
    "such a problem is out of the scope of this paper , in which we focussed on the radiation part , and will be addressed in forthcoming works .",
    "to check the applicability of hrsc techniques to radiation transport problems , we have performed a number of numerical tests considering several simplified models in which the analytical solution is known . in the remainder of this section",
    "we describe the different tests and display the results .",
    "our intention is to prove that our method can solve radiation transport in all kinds of regimes , from diffusion ( test 1 ) to radially streaming ( test 2 ) , going through the semi - transparent region ( test 5 ) and in situations where strong gradients are developed ( test 4 ) .",
    "ideally , in a multi - group scheme we have as many systems of two equations as energy bins in which the radiation density is splitted . in a radiation hydrodynamics problem",
    "all those pairs of equations are coupled to the matter equations and must be solved together . since our objective is to study the applicability of hrsc techniques for the radiation part , in what follows we assume to have only one energy group or , equivalently , we consider the energy integrated equations .",
    "notice , though , that the conclusions are not affected since , when velocity fields are not taken into account , the equations for different energies are only coupled through the source terms .",
    "a different problem will arise when velocity fields are important or gravitational and doppler red - shift are considered . in those situations",
    "either the anisotropy of the source term ( in the observer frame ) or the advection and aberration terms ( in the comoving frame ) cause the energy redistribution along the photon ( or neutrino ) path and a more careful treatment needs to be done .      in the diffusion limit",
    ", the closure is obviously @xmath87 and the time derivative of the flux can be neglected , leading to equation ( [ f1 ] ) . setting the absorption opacity to zero and the scattering opacity to a constant value , the analytical solution of the system formed by ( [ mom0 ] ) and ( [ f1 ] )",
    ", corresponding to an initial value problem consisting in a dirac delta located in @xmath88 at @xmath89 , is the following e(r , t ) = ( ) ^3/2 \\ { - } f(r , t ) = e(r , t ) we imposed @xmath90 as inner boundary conditions and outflow boundary conditions in the outermost shell .",
    "we have performed two simulations .",
    "first , we set a value of @xmath91 on a equally spaced grid of 100 shells in the domain @xmath92 $ ] .",
    "it corresponds to a peclet number ( @xmath93 ) of order unity .",
    "the cell _ peclet number _ is a measure of the spatial resolution relative to the relaxation scale and a grid is coarse when @xmath94 .",
    "this first simulation starts at @xmath95 to avoid the numerical problems produced by an infinite value in @xmath89 .",
    "results are shown in figure [ fig1a ] . the energy density ( left panel ) and the flux ( right panel )",
    "are displayed for different times in dimension - less units , @xmath96 from top to bottom .",
    "the solid line corresponds to the analytical solution and the crosses correspond to the numerical solution .",
    "notice that , although we are finding numerical solutions of system ( [ system ] ) , the analytical solution of the diffusion limit is well reproduced by the numerical code , since the opacity is large enough to be close to the diffusion limit . the second simulation has been performed in a grid of 100 shells in the domain @xmath97 $ ] , and using a value of @xmath98 , which corresponds to @xmath99 .",
    "the initial time in this case is 200 and the courant time - step is of the same order ( @xmath100 ) as in the previous simulation , three orders of magnitude larger than the relaxation scale .",
    "results are displayed in fig .",
    "[ fig1b ] .",
    "the agreement between the analytical and the numerical solutions clearly proofs the capability of the code to handle situations with very stiff source terms .      in the radially streaming limit ( @xmath101 , @xmath102 ) , and assuming there is no interaction between radiation and matter ( @xmath103 , @xmath104 ) equations ( [ system ] ) are reduced to @xmath105 the solution to this equation is any linear combination of ingoing and outgoing spherical waves , _",
    "i.e. _ , any linear combination of functions of the form @xmath106 .",
    "for the first numerical experiment we choose a gaussian spherical wave propagating outwards , e(r , t ) = \\ { - ( r - t)^2 } f(r , t ) = e(r , t ) .",
    "our numerical grid consists on 200 equally spaced shells going from @xmath107 to @xmath108 and the boundary conditions consist in imposing the analytical solution in both boundaries .",
    "we show the results of this test in figure [ fig2a ] . in the figure we displayed the analytical solution ( solid line ) and",
    "the numerical ( crosses ) for the energy density . in order to analyse the effect of the particular choice for the closure",
    ", we repeated the experiment using different values for @xmath109 , which leads to different speeds of propagation of the waves , and no difference was observed .",
    "the final reason is that all the closures displayed in table 1 give @xmath110 .",
    "this is a general property of any closure , since @xmath111 is a positive defined function that goes to zero as @xmath46 and , therefore , its derivative has to be negative in a vicinity of @xmath69 and @xmath112 . thus taking the limit @xmath46 in ( [ lambda ] ) ,",
    "one obtains _ + = = 1    to understand why the value of @xmath113 is not important in this problem , we study the diagonalized system obtained by adding and subtracting the two equations in ( [ system ] ) after taking @xmath102 , @xmath114 in this equations it is clearly seen that the quantities propagated with velocities @xmath115 ( riemann invariants ) are @xmath116 , respectively . since in our particular problem we took @xmath117 ,",
    "the quantity propagated by @xmath113 is identically null and the value of the speed of propagation does not affect the solution .",
    "a different situation is found when we add to the initial conditions a second wave propagating in the opposite direction .",
    "figure [ fig2b ] shows the results from such experiment , in which a second wave with smaller amplitude and opposite direction is located initially at @xmath118 .",
    "the closure used was @xmath102 , @xmath119 , which gives @xmath120 , @xmath121 . in the figure ,",
    "the analytical solution is denoted by the solid lines and the numerical solution by crosses and each panel corresponds to a different time .",
    "it can be seen how the code is able to solve the interaction of the two waves until they completely cross over .",
    "the difference between the analytical and numerical solution near the center for the last panel are due to the boundary conditions ( initially , it was an ingoing wave ) .",
    "to illustrate the effect of a wrong speed of propagation , the experiment is repeated with kershaw s closure , that gives a correct speed of propagation when @xmath122 but a wrong value otherwise .",
    "results are shown in figure [ fig2c ] for the same time steps as in the previous case . at the beginning",
    "both waves seem to propagate correctly but , as they cross each other and the flux factor departs from unity , the numerical result differs from the analytical solution .",
    "a similar behaviour is obtained with other closures .",
    "this simple example manifests the importance of the choice for the closure , since it fixes the speeds of propagation of the waves .      in the two previous tests we studied the limiting cases , diffusive and free - streaming regimes .",
    "another academic problem in the limit of vanishing opacities consists in a sphere of radius @xmath123 radiating isotropically into vacuum ( figure [ vac ] ) . given the explicit form of the distribution function at the surface of the sphere , @xmath124",
    ", the general solution can be easily obtained    ( t , r , ) = \\ { .",
    "where s = r ( - ) x(r , t ) = \\ { . where @xmath125 .",
    "we take a linear time dependence @xmath126 , being @xmath127 an arbitrary constant , so that the angular integrals can be done analytically .",
    "the angular moments of the distribution function are , then , given by e(t , r)=    f(t , r)=    p(t , r)= .",
    "we set up a numerical grid of 200 points , uniformly distributed , from @xmath128 to @xmath129 .",
    "the initial conditions are @xmath130 and @xmath131 with @xmath132 being a small number , different from zero for numerical purposes .",
    "we have taken @xmath133 .",
    "the radiation field is introduced through the inner boundary conditions , @xmath134 and @xmath135 .",
    "outflow is assumed in the outer boundary .    in figure [ fig3a ] the evolution of the radiation energy density as a function of the radial coordinate",
    "is shown for three different evolution times .",
    "the test has been repeat for three different closure relations from those described in table 1 : vacuum ( dashed lines ) , kershaw ( dotted lines ) and minerbo ( dashed - dotted lines ) . as in the previous figures the analytical solution is represented by the solid line .",
    "although the appropriate closure for this problem ( vacuum ) gives a better approximation to the real solution , it is remarkable that other closures also give similar results .",
    "the differences between different closures stem from the slightly different propagation speeds of the simple waves in the regime of interest . unlike in the two - wave problem described in previous section , for this specific problem any reasonable closure might be used without major deviations from the real solution .      with this test we intend to simulate a more realistic scenario in which , initially , radiation produced in the center of a star diffuses out with constant luminosity .",
    "we begin by setting up a sphere which is in radiative equilibrium at a given luminosity @xmath136 . for @xmath137 , the stationary solution",
    "is given by e(r ) = f(r ) = where @xmath123 is the radius of the outer boundary , at which @xmath69 .",
    "starting with the initial model corresponding to @xmath138 , we let it evolve in three different situations : 1 ) we take @xmath139 as boundary conditions at the inner boundary ( located at @xmath128 ) , and the radiation field should diffuse out continuously ; 2 ) we change the inner boundary condition to @xmath140 , ten times larger than the initial model .",
    "the behaviour is now the opposite , the energy density must increase until the new stationary solution for the new luminosity is reached ; 3 ) we again take @xmath139 at the inner boundary but we switch on a central point  source in the middle of the star ( @xmath141 ) .",
    "the radiation field must evolve towards the corresponding stationary solution , which is different in the two parts of the star defined by the source .",
    "inside , the luminosity is zero and the energy density is constant . in the region",
    "external to the energy source , the stationary solution is defined by @xmath142 , where @xmath143 is the energy per unit time injected by the source .",
    "the results for @xmath91 are shown in figures [ fig4a]-[fig4c ] , for cases 1 to 3 , respectively .",
    "all three simulations have been done on the same grid of 200 uniform zones and outflow boundary conditions in the outer edge have been imposed .",
    "left panels display the energy density as a function of radius .",
    "the thick solid line in the figures corresponds to the initial model and the thick dotted line in figure [ fig4b ] represent the stationary solution with @xmath140 . in figure",
    "[ fig4b ] , we can see how the heat wave lasts about 1000 time - units ( the diffusion time @xmath144 ) to arrive to the surface and a new stationary solution is successfully obtained after @xmath145 times the diffusion time scale .",
    "testing a method in the semi - transparent regime becomes a tough issue due to a lack of analytical solutions to compare with . to overcome this problem ,",
    "we have performed monte carlo simulations , which is the closest solution to an exact one , and results in an excellent test of the performance of the method in the semi - transparent regime .",
    "we have used a monte carlo code that simulates the transfer of a radiation field in a spherically symmetric geometry .",
    "we consider a region with inner boundary at @xmath146 and outer boundary at @xmath147 , divided in 200 spherical shells . within each shell",
    "a constant value of the scattering opacity ( elastic and isotropic ) is assumed .",
    "we do not consider emission or absorption processes .",
    "our monte carlo procedure starts by injecting particles at the inner boundary outwardly - directed .",
    "then , we compute the trajectory of each particle as it scatters off matter , according to the standard random walk laws @xcite .",
    "the trajectory ends when the particle escapes by crossing the outer boundary or it re - enters the inner boundary .",
    "once the path of a particle is computed we proceed to calculate the contribution of this particle to the moments of the radiation field .",
    "the contribution of each particle to the energy density at a given numerical shell is calculated by adding the path length between two successive scattering events , within the shell , divided by the volume of the shell .",
    "consequently , the total energy density is obtained just by adding the contribution of each particle multiplied by an arbitrary factor analogously , to obtain the contribution of each particle to the flux , the path length is weighted using the cosine of the angle with respect to the radial direction .",
    "finally , pressure is calculated by means of the same procedure , but using the square of the cosine as weight of the path length .    in our numerical experiment",
    "we have taken : @xmath148 and @xmath149 .",
    "the opacity law is an exponentially decreasing function in radius , taking the value @xmath150 at the inner boundary and @xmath151 at the outer boundary .",
    "the corresponding values of the optical depth are such that an important part of the region is semi - transparent .",
    "we have run the monte carlo code using @xmath152 particles in order to obtain the stationary solution .",
    "the set up for our transport code is the following : i ) the above opacity law , ii ) the inner boundary conditions given by the stationary solution ( obtained from monte carlo ) , and iii ) the closure relation .",
    "we have performed two different calculations using kershaw s closure relation and a cubic polynomial fit to monte carlo results , explicitly p = 0.3228 + 0.1902 f-0.0476 f^2 + 0.5131 f^3 starting with arbitrary initial profiles , we let the radiation field evolve until the stationary solution is reached and results can be compared to those obtained from the monte carlo simulations .    in figure",
    "[ fig6 ] we show the stationary solutions calculated from monte carlo simulations ( solid line ) and from our code with the two different closures , kershaw s ( dotted line ) and the above fit ( dashed line ) . from the results displayed in the figure we can conclude that the evolutionary code describes the semi - transparent regime accurately .",
    "the differences in the values of the energy density ( left panel ) , normalized to its inner boundary value , amounts less than a few percentage in any case .",
    "the slight discrepancies in the flux factor are mainly due to the closure relation employed , being less than 6% for kershaw s closure and less than 3% for the fit .",
    "the closure , therefore , sets the maximum accuracy that can be obtained , although qualitative results at a level of 10% uncertainty can easily be obtained with any reasonable closure in the semi - transparent regime .",
    "our last experiment intends to illustrate how the numerical method we proposed can succeed in situations when standard flux - limited diffusion techniques fail .",
    "we set up a sphere of radius @xmath153 with a radiation energy density of @xmath154 , embedded in a background where the opacity varies as follows : = \\ { . where we have taken @xmath155 . outside the sphere",
    "we take @xmath156 ( in practice , @xmath157 for numerical reasons ) , and initially the flux is zero everywhere .",
    "it tries to mimic a situation in which radiation scatters out in a central star , where the diffusion approximation remains valid , through an opacity - varying atmosphere up to the surface ( @xmath158 ) , where the opacity suddenly vanishes .",
    "then , it crosses a transparent region to find a very opaque layer , where diffusion operates again .",
    "this sort of problem is obviously a tough challenge for diffusion - based codes , since they can not work properly in the transparent region .    in figure [ fig6 ]",
    "we show results from the evolution of this problem on a grid of 200 uniform shells and using kershaw s closure . in the left panel",
    "we show the energy density for different times .",
    "it can be seen how a gradient is developed in the diffusive regions @xmath159 while radiative equilibrium @xmath160 in the transparent region between the two opaque layers is rapidly obtained .",
    "notice also that only for the last snapshot ( @xmath161 , dashed curve ) there is a flux of energy in the outer transparent region , because it takes some time to the radiation to diffuse through the opaque layer and develop a gradient that keeps the outgoing flow .",
    "we have studied the mathematical character of the angular moment equations of radiative transfer , considering the implications of using different closure relations .",
    "the role played by the closure and their derivatives is more apparent in the hyperbolic formulation .",
    "after this analysis , we conclude that the hyperbolic character is assured for a given variety of closures widely used in the literature : those given by @xmath59 . for general closures @xmath162 ,",
    "hyperbolicity can not be guaranteed , although the closure proposed by cernohorsky & bludman , based on maximum entropy arguments , leads to real eigenvalues .",
    "additional constraints on the closures are imposed on the base of the behaviour of the eigenvalues of the jacobian matrix since they give the velocity of propagation of perturbations .",
    "causality limitation is written in terms of the closure relation helping us to select , from this point of view , among the different closures reviewed .",
    "it turns out that only one of the closures analysed does not satisfy causality , allowing for velocities of the waves higher than the speed of light . for the other closures ,",
    "although derived without taking into account the mathematical issues addressed in this paper , we found that they are consistent with hyperbolicity and causality .    writing the moment equations of the distribution function as a hyperbolic system of conservation laws",
    "allows one to apply numerical techniques specifically designed for such systems , the so - called hrsc methods .",
    "we have applied hrsc methods to solve the transport equations in a static background showing , for a number of test problems , the feasibility of the method . from the results ,",
    "the main conclusion is that the numerical method can be used in any regime , from optically thick to transparent regions , obtaining numerical solutions with high accuracy .",
    "it turns out that the closure relation plays an important role , more evident than in traditional methods for radiation transfer , that can be useful to choose the more appropriate closure for a given problem .",
    "when the radiation transport equations are written as a system of conservation laws , the coupling with hydrodynamics is straightforward @xcite .",
    "this feature make us to be confident in the possibility of applying the method to problems involving radiative flows .",
    "moreover , we are optimistic in the applicability to multidimensional problems , since the extension of the method is straightforward .",
    "this work has been supported by the spanish dgicyt ( grant pb97 - 1432 ) . j.a.p . also acknowledges previous financial support from the ministerio de educacin y cultura .",
    "groth , c. p. t. , gombosi , t. i. , roe , p. , l. , brown , s. l. , 1996 , proceedings of the _ fifth international conference on hyperbolic problems _ , eds .",
    "glimm , j. , graham , m.j . ,",
    "grove , j.w .",
    ", world scientific ."
  ],
  "abstract_text": [
    "<S> we study the mathematical character of the angular moment equations of radiative transfer in spherical symmetry and conclude that the system is hyperbolic for general forms of the closure relation found in the literature . </S>",
    "<S> hyperbolicity and causality preservation lead to mathematical conditions allowing to establish a useful characterization of the closure relations . </S>",
    "<S> we apply numerical methods specifically designed to solve hyperbolic systems of conservation laws ( the so - called godunov - type methods ) , to calculate numerical solutions of the radiation transport equations in a static background . </S>",
    "<S> the feasibility of the method in any kind of regime , from diffusion to free - streaming , is demonstrated by a number of numerical tests and the effect of the choice of the closure relation on the results is discussed .    </S>",
    "<S> radiative transfer  methods : numerical </S>"
  ]
}