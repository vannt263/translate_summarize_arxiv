{
  "article_text": [
    "since its introduction in 1985 the car - parrinello ( cp ) method @xcite has increasingly been used to study an ever wider range of problems in the dynamics and thermodynamics of solids and liquids under various conditions and in studying the dynamics of chemical reactions .",
    "cp is an efficient method to solve the kohn - sham equations of density functional theory@xcite `` on the fly '' , as the electronic ground state evolves due to changing ionic positions .",
    "it is based on the introduction of an additional inertia associated with the electronic orbitals , which are evolved as classical degrees of freedom along the ionic molecular dynamics ( md ) trajectory .",
    "its popularity stems from its efficiency relative to full born - oppenheimer ( bo ) dynamical methods , where the electronic orbitals are forced to be in the ground state for each ionic configuration , and from the observation that apart from small fluctuations which average out on a femtosecond timescale the physical quantities which are extracted from it are indistinguishable from bo dynamics@xcite .",
    "it is known that the introduction into the electronic system of a fictitious inertia introduces differences into the dynamics relative to the bo dynamics",
    ". however these differences have never been fully quantified or analysed in the context of the appropriate theoretical framework . in this paper",
    "we carefully examine the relationship between cp and bo dynamics and show how the difference between them scales with the value of the fictitious mass parameter , @xmath0 .",
    "we derive analytic expressions for such differences in the limit of the fictitious kinetic energy associated with electronic orbitals being a minimum .",
    "as has been proposed previously@xcite , we show how these errors may be corrected in the ideal case where the electron - ion coupling can be modeled as a rigid dragging of localized atomic orbitals and show its application to specific examples .",
    "we suggest that quantities extracted from cp simulations should always be checked against their possible dependence on the value of @xmath0 .",
    "the central issue is the following : the classical motion of the electronic orbitals in cp can be thought of as being made up of two components .",
    "one component consists of fast oscillations with period equal to or faster than @xmath1 , @xmath2 being the lowest electronic excitation energy and @xmath0 the fictitious electronic mass@xcite .",
    "the second component is the unavoidable but `` adiabatic '' response of the electronic orbitals to the ionic dynamics , whose shortest characteristic time we denote by @xmath3 ( @xmath4 ) .",
    "it is generally thought that keeping the time scales ( or frequency spectra ) of the two components well separated ( i.e. by reducing @xmath0 ) ensures a correct adiabatic decoupling and guarantees that the cp dynamics is a faithful representation of the bo dynamics .",
    "we show here that the adiabatic decoupling is a necessary but not sufficient condition for the accuracy of cp dynamics .",
    "in particular , the fictitious inertia also causes the slow component of the electronic dynamics to exchange momentum and energy with the ions , yielding a departure of the cp forces on the ions from the bo ones for large values of @xmath0 .",
    "we begin by outlining the relevant theory and deriving an expression for the difference between cp forces and bo forces in the limit of minimum fictitious electronic kinetic energy .",
    "we then consider the simplified model of rigid ions and derive the error in the forces for this system .",
    "we show how the thermodynamics and the dynamics can be corrected for systems in which the rigid - ion model provides a good description of the electronic structure .",
    "we illustrate these theoretical considerations by studying the examples of magnesium oxide and silicon .",
    "the car - parrinello method makes use of the following classical lagrangean : @xmath5 \\label{eqn : lagrange1}\\ ] ] to generate trajectories for the ionic and electronic degrees of freedom via the coupled set of equations of motion @xmath6 } { \\partial r_{i}^{\\alpha}}= f_{cp_{i}}^{\\alpha}\\label{eqn : ions1}\\ ] ]    @xmath7}{\\delta   \\langle \\psi_{i}| } \\label{eqn : electrons1}\\ ] ]    where @xmath8 and @xmath9 are the mass and position respectively of atom @xmath10 , @xmath11 are the kohn - sham orbitals which are allowed to evolve as classical degrees of freedom with inertial parameters @xmath12 , and @xmath13 $ ] is the kohn - sham energy functional evaluated for the set of ionic positions @xmath14 and the set of orbitals @xmath15 .",
    "the functional derivative of the kohn - sham energy in ( [ eqn : electrons1 ] ) is implicitly restricted to variations of @xmath15 that preserve orthonormality .",
    "we wish to compare the dynamics of ions evolved with this method with the true bo dynamics . for this purpose ,",
    "we decompose the cp orbitals as @xmath16 where @xmath17 are the ground state ( bo ) orbitals which are uniquely defined for given ionic coordinates as those that minimize @xmath18 $ ] .",
    "this allows us to consider separately the evolution of the instantaneous electronic ground state and the deviations of the cp orbitals from that ground state .",
    "a preliminary interesting observation follows from such a decomposition : strictly speaking , the cp equations do not reduce to the bo equations in the limit of vanishing @xmath19 , for any finite value of @xmath0 . in fact , because of the dependence of the ionic coordinates on time , the bo orbitals have a non vanishing `` acceleration '' given by @xmath20 where we have used the fact that @xmath21 it now becomes clear that eqn .",
    "( [ eqn : electrons1 ] ) is not compatible with a vanishing departure of the cp orbitals from the bo orbitals , since the right - hand side of ( [ eqn : electrons1 ] ) would vanish if @xmath22 , while the left - hand side would not , by virtue of ( [ eqn : kick ] ) .",
    "so the cp orbitals can not take their ground state values unless @xmath0 vanishes too . as a consequence of this",
    ", the ionic dynamics is affected by a bias proportional to @xmath0 and , as we will see , to the strength of the electron - ion interaction .",
    "we now wish to explore the consequences that such a departure from the ground state has on the instantaneous cp forces @xmath23 .",
    "we thus calculate how cp forces deviate from the bo forces @xmath24 at a given point in phase space along the cp trajectory .",
    "we may write , for the @xmath25-th cartesian component of the force on atom @xmath10 : @xmath26}{\\partial r_{i}^{\\alpha } } & = &   \\frac{d e[\\{\\textbf{r}_{i}\\};\\{\\psi_{i}\\}]}{d r_{i}^{\\alpha } } \\nonumber \\\\ & - &   \\sum_{i}\\bigg ( \\frac{\\delta e[\\{\\textbf{r}_{i}\\};\\{\\psi_{i}\\}]}{\\delta |\\psi_{i}\\rangle }   \\frac{\\partial |\\psi_{i}^{(0)}\\rangle}{\\partial r_{i}^{\\alpha } } + \\frac{\\partial \\langle \\psi_{i}^{(0)}|}{\\partial r_{i}^{\\alpha } } \\frac{\\delta e[\\{\\textbf{r}_{i}\\};\\{\\psi_{i}\\}]}{\\delta \\langle \\psi_{i}| } \\bigg ) \\label{eqn : fcp1}\\end{aligned}\\ ] ] substitution of equation  [ eqn : electrons1 ] yields @xmath27}{d r_{i}^{\\alpha } } -   \\sum_{i}\\mu_{i}\\bigg ( \\langle\\ddot{\\psi}_{i}|           \\frac{\\partial |\\psi_{i}^{(0)}\\rangle}{\\partial r_{i}^{\\alpha } } + \\frac{\\partial \\langle \\psi_{i}^{(0)}|}{\\partial r_{i}^{\\alpha } }    @xmath28}{d r_{i}^{\\alpha } } & = &   \\frac{d}{d r_{i}^{\\alpha}}\\bigg\\{e[\\{\\textbf{r}_{i}\\};\\{\\psi_{i}\\ } ] \\bigg |_{\\{\\psi_{i}^{(0)}\\ } }   \\nonumber \\\\ & + & \\sum_{i}\\bigg ( \\frac{\\delta e[\\{\\textbf{r}_{i}\\};\\{\\psi_{i}\\ } ] } { \\delta |\\psi_{i}\\rangle}\\bigg |_{\\{\\psi_{i}^{(0)}\\}}|\\delta \\psi_{i}\\rangle + \\langle \\delta \\psi_{i}|\\frac{\\delta e[\\{\\textbf{r}_{i}\\};\\{\\psi_{i}\\ } ] } { \\delta \\langle \\psi_{i}|}\\bigg |_{\\{\\psi_{i}^{(0)}\\ } } \\bigg ) + order(\\delta \\psi_{i}^{2 } )   \\bigg \\ } \\nonumber \\\\ & = & - f_{bo_{i}}^{\\alpha } + 0 + order(\\delta \\psi_{i}^{2})\\end{aligned}\\ ] ] we can write the error in the cp force as @xmath29 , between the cp and the bo forces , we assume adiabatic decoupling and look for contributions to this difference that do not vanish when averaged over time scales longer than the fictitious dynamics of the electrons ( @xmath30 ) but shorter than the time scales of the ionic dynamics ( @xmath3 ) .",
    "only these contributions are expected to contribute significantly to the ionic dynamics@xcite . to this end",
    "we rewrite eqn .",
    "( [ eqn : electrons1 ] ) , using ( [ eqn : decomp ] ) , as @xmath31}{\\delta \\langle \\psi_{i}| }   = -\\frac{1}{\\mu_{i } } \\bigg ( \\frac{\\delta^{2 } e[\\{\\textbf{r}_{i}\\},\\{\\psi_{i}\\}]}{\\delta | \\psi_{i } \\rangle   \\delta \\langle \\psi_{i}|}\\bigg |_{\\{\\psi_{i}^{(0)}\\ } } |\\delta\\psi_{i}\\rangle   + order(\\delta \\psi_{i}^{2})\\bigg )   \\label{eqn : electrons3}\\end{aligned}\\ ] ] and we show that when eq .",
    "( [ eqn : electrons3 ] ) is averaged over a time scale shorter than @xmath3 but longer than @xmath30 , then @xmath32 vanishes . in order to prove it , we re - express equation  [ eqn : electrons3 ] as @xmath33 where @xmath34}{\\delta | \\psi_{i } \\rangle   \\delta \\langle \\psi_{i}|}\\bigg |_{\\{\\psi_{i}^{(0)}\\}}\\end{aligned}\\ ] ] and @xmath35 is an eigenvector of @xmath36 with eigenvalue @xmath37 . @xmath38 and @xmath36 , by definition , vary on the timescale of ionic motion .",
    "we consider timescales much smaller than @xmath39 such that @xmath38,@xmath36 and @xmath40 are approximately constant . in this case",
    "a solution of  [ eqn : electrons4 ] is of the form @xmath41 where @xmath42 and @xmath43 is a complex constant .",
    "if we assume that @xmath44 is very large relative to @xmath45 then the average value of @xmath46 over timescales much greater than @xmath47 is @xmath48 since @xmath49 .",
    "to summarise : if we consider the dynamics of the electronic orbitals to consist of an adiabatic response of the electronic orbitals to the ionic dynamics and an independent fast oscillating part then , under the assumption that the timescales of the fast component are much shorter than the shortest time period in the ionic system , i.e. assuming adiabatic decoupling , the average error in the car - parrinello forces is given by ( using equations  [ eqn : error ] ,  [ eqn : electrons3 ] and  [ eqn : average ] )    @xmath50",
    "in order to gain insight into the scale of this problem with the cp forces we consider the simple example of rigid ions .",
    "we assume that each electron is localised around an ion and that there is no distortion of a particular ion s charge distribution as it moves in the field of the other ions .",
    "we can refer each wavefunction @xmath51 to a particular ion as follows @xmath52 where the electronic states are labelled by an ion index , @xmath10 , and the index @xmath53 labelling the electronic state of the ion .",
    "the rigidity of the ionic charge distribution means that @xmath54 equation  [ eqn : error2 ] becomes @xmath55 the second term in equation  [ eqn : error3 ] vanishes due to symmetry , at least assuming an atomic charge density with spherical symmetry .",
    "the first term may be written in terms of @xmath56 the quantum electronic kinetic energy of an electron in state @xmath53 of atom @xmath10 as @xmath57 where @xmath58 is the ( real ) mass of an electron .",
    "since the ions are rigid the quantum kinetic energy associated with each one is a constant and equation  [ eqn : error3 ] becomes @xmath59 with @xmath60 in this case the ionic positions and velocities are updated during a car - parrinello simulation according to @xmath61 in other words , for systems where the rigid ion approximation is valid , the cp approximation amounts simply to a rescaling of the ionic masses . since the classical partition function depends only on the interaction potential , the thermodynamics of the system as calculated with a cp dynamics is identical to the thermodynamics of the bo system .",
    "the definition of temperature will however be affected , because if the actual ionic dynamics in cp is given by ( [ eqn : masscorr ] ) , then the real temperature at which the system equilibrates , at least in the case of a microcanonical dynamics for the ions , is given by @xmath62 where @xmath63 signifies the average over time and @xmath64 is the number of atoms .",
    "this differs from the standard definition by the addition of a term proportional to @xmath65 . the additional term in eq . ( [ eqn : realtemp ] )",
    "can be readily traced to the additional inertia caused by the rigid dragging of the electronic orbitals .",
    "in fact , using ( [ eqn : orbvel ] ) and ( [ eqn : rigid ] ) , we can show that this term coincides , within the rigid ion model , with the fictitious electronic kinetic energy , when the contribution from the dynamics of the @xmath19 is negligible i.e. @xmath66 in other words if the electronic orbitals move rigidly with the ions the actual inertia of the ions in a cp simulation can be obtained by adding to the `` bare '' ionic inertia the inertia carried by the electronic orbitals .",
    "this result has been pointed out previously @xcite and ionic masses are commonly renormalized when dynamical quantities are being investigated .",
    "we now explore the consequences that such a modification of the ionic inertia has on typical observables extracted from cp simulations .",
    "first , as already mentioned , the correct definition of temperature in a microcanonical cp simulation is given by ( [ eqn : realtemp ] ) .",
    "similarly , in a simulation where temperature is controlled , e.g. through a nos thermostat@xcite , the quantity to be monitored corresponds to the instantaneous value of ( [ eqn : realtemp ] ) .",
    "dynamical observables will also be affected by the additional inertia , as already noted in the case of phonons extracted from cp - md in carbon systems @xcite . in the case of homogeneous systems ( a single atomic species in which all the atoms are in similar local chemical environments )",
    "all dynamical quantities can be simply rescaled using the mass correction of eqn .",
    "( [ eqn : masscorr ] ) . however , for heterogeneous systems the correction is not always trivial , as different mass corrections apply to different atomic species due to different atomic kinetic energies . in practice",
    ", we found that a convenient and more general way to express the mass correction of ion @xmath10 is given by @xmath67 where @xmath68 is a dimensionless constant which takes into account the relative contribution of species @xmath10 to the total quantum kinetic energy @xmath69 .",
    "in order to gain more insight into the theory put forward in the previous sections , we have performed cp simulations on pressurised magnesium oxide and on silicon . among the insulators ( we restrict our analysis to insulators as adiabatic decoupling is less obvious in metallic systems and this would complicate considerably our analysis ) , mgo and silicon are extremal cases : mgo is a highly ionic system with large quantum kinetic energy associated with the strongly localised charge distribution ; silicon on the other hand is a covalent system where electron states are much more delocalised . within our pseudopotential description of mgo @xcite , the 1s,2s and 2p states",
    "are frozen into the core of mg whereas only the 1s states are frozen into the core of o. since there is very nearly complete transfer of the two 3s electrons from mg to o ( inspection of charge density contour plots reveal no evidence of any valence charge anywhere except surrounding o sites ) the electron quantum kinetic energy may to a first approximation be attributed to electronic states localised on oxygen ions .",
    "this makes mgo an ideal system to study within the rigid ion model since only the oxygen mass will be rescaled .",
    "as mentioned in the previous section , additional problems arise if one deals with more than one electron - carrying species as the quantum kinetic energy must be divided between these species .",
    "the large quantum kinetic energy of mgo means that the error in the cp forces should be large relative to many materials .",
    "the simulations of mgo were performed at a high pressure ( @xmath70 kbar ) as this enhanced its ionicity .",
    "silicon on the other hand is a covalent / metallic system with relatively low quantum kinetic energy .",
    "as such it should be one of the systems most favourable to the car - parrinello approximation but least favourable to description in terms of rigid ions .",
    "we have performed ten different simulations .",
    "the technical details are summarised in table  [ table : details ] .",
    "all simulations were performed with a cubic simulation cell of side @xmath71 ( see table  [ table : details ] ) under periodic boundary conditions and with 64 atoms in the unit cell .",
    "we used a plane wave basis set with an energy cut off for the wavefunctions of @xmath72 .",
    "the brillouin zone was sampled using only the @xmath73point . in each simulation",
    "we have used the mass preconditioning scheme of tassone _",
    "et al._@xcite and the parameters @xmath74 and @xmath75 in table  [ table : details ] are defined as in ref.[5 ] .",
    "liquid silicon is metallic and so , as suggested by blchl and parrinello  @xcite , two nos thermostats were used to counteract the effects of energy transfer between the ions and the @xmath76 due to overlap of their frequency spectra.the values of the parameters used were @xmath77 a.u./atom,@xmath78 a.u./atom and @xmath79 a.u .. these were chosen for compatibility with those of ref.[10 ] by taking into account the slight increase in temperature and scaling accordingly .    in all simulations , with the exception of simulation 2 ,",
    "the system was first allowed to evolve for at least @xmath80 ps and this trajectory was discarded . for simulation 2 , this initial equilibration time was @xmath81 ps .",
    "all results reported are taken from the continuations of these equilibration trajectories .    in all simulations , the total quantum kinetic energy of the system , and hence the average mass correction ( [ eqn : deltam2 ] ) , varied during the simulation by less than @xmath82 .",
    "it was therefore taken as a constant in further analysis .",
    "the total energy of all the degrees of freedom ( including the thermostats in simulation 3 ) was conserved in all simulations _ at least _ to within one part in @xmath83 .      in order to check the predictions of the theory developed in sections ii and iii , we have taken segments of cp trajectories and calculated the true bo forces along these segments by putting the electronic orbitals to their ground state with a steepest descent method .",
    "we look at the instantaneous error in the @xmath84 cartesian component of the cp force on atom @xmath10 relative to the root - mean - squared ( r.m.s ) bo force component , i.e :    @xmath85    and the instantaneous relative error minus the relative error predicted by the rigid - ion model : @xmath86_{corr }   = \\frac { \\delta f_{i}^{\\alpha}(t)+\\delta m_{i } \\ddot{r}_{i}^{\\alpha } } { \\sqrt { \\frac{\\sum_{c}\\sum_{j,\\beta } ( f_{bo_{j}}^{\\beta})^{2 } } { 3 n n_{c } } } } \\label{eqn : df2}\\end{aligned}\\ ] ] where @xmath87 is the number of ionic configurations at which the error in the cp forces was calculated and @xmath88 is the sum over all such configurations . the value of @xmath65 in ( [ eqn : df2 ] ) is determined using the rigid - ion - model expression ( [ eqn : deltam2 ] ) , and @xmath69 was given its average value during the simulation .",
    "the scaling parameters which were found to give best results for silicon and oxygen were @xmath89 and @xmath90 respectively .",
    "we also look at @xmath91 and @xmath92 the r.m.s values of @xmath93 _ { } $ ] and @xmath93_{corr}$ ] over all the ions , cartesian components and configurations tested .    since the cp forces are affected by a `` fast '' component whose effect on the ionic dynamics is believed to average out on the time scale of the ionic motion , we introduce the quantity @xmath94 , defined as @xmath95 if we begin our comparison between cp and bo forces at some instant @xmath96 along the trajectory then inspection of @xmath94 gives a feeling for how large the fast component is .",
    "if the errors in all the forces of the system oscillate rapidly with an average of zero then @xmath94 decreases very quickly from the value of one at @xmath97 to zero at @xmath98 . for systematic errors",
    "@xmath94 should decrease gradually from one to zero on a timescale of the order of the period of @xmath3 .",
    "in realistic cases @xmath94 drops from one and levels off to a smaller value for @xmath99 , and then decreases gradually to zero for @xmath100 exceeding @xmath3 .",
    "the value of @xmath94 on the plateau between @xmath30 and @xmath3 provides a measure of how much the errors calculated in ( [ eqn : df1 ] ) and ( [ eqn : df2 ] ) are attributable to a systematic ( i.e. `` slow '' ) departure from the bo surface .",
    "we begin by looking at the forces in silicon in both the solid at @xmath101 k and the liquid at @xmath102 k ( simulations 1,2 and 3 ) .",
    "simulation 1 was preceded by a short run where the temperature was set to about 1000 k. electrons were then relaxed in their ground state and the ionic velocities set to zero .",
    "this allows the electrons to smoothly accelerate with the ions .",
    "a microcanonical simulation followed where the ionic temperature reached , after a short equilibration , the value of 330 k. this procedure was followed in all the simulations reported here , except where discussed .    in solid si at @xmath103 k ( fig .",
    "[ fig : si300ksmooth ] ) we find that the standard deviation of the error in forces is @xmath104 .",
    "however , most of this error can be attributed to a rigid dragging of the si atomic orbitals .",
    "the standard deviation of the error is in fact reduced to @xmath105 after the rigid - ion correction ( [ eqn : masscorr ] ) is subtracted .",
    "the @xmath106 drop of @xmath107 ( corrected ) shown in fig .",
    "[ fig : si300ksmooth]b indicates that @xmath106 of the residual @xmath105 error can be attributed to `` fast '' oscillations , so that the overall average error introduced by the cp approximation , once corrected for the rigid dragging and under the assumption that the fast component is not relevant , is less than @xmath108 .",
    "as has been pointed out previously by remler and madden @xcite , it is important to begin the dynamics with electrons and ions moving in a consistent way as we have done here in all simulations except the one we now discuss ( simulation 2 ) and in the case of liquid si ( simulation 3 ) .",
    "we found that the error in the forces increases substantially if the simulation is not started from zero ionic velocities , a procedure that would otherwise have the advantage of shortening considerably the time needed to reach thermal equilibrium .",
    "simulation 2 started from the end of simulation 1 , but electrons have been put in the ground state before restarting ( ionic velocities and positions were instead kept unchanged ) .",
    "forces were tested after @xmath81ps from the electron quenching .",
    "the standard deviation of the error in forces is now @xmath109 and the error in the forces as corrected according to the rigid ion approximation at @xmath110 , is not significantly improved .",
    "however clearly from inspection of @xmath107 in fig .",
    "[ fig : si300krough]b and the sample force component in fig .",
    "[ fig : si300krough]c most of this error can be attributed to the high frequency oscillations of the electronic orbitals .",
    "if we assume that these oscillations do not influence the ionic dynamics , the error reduces to about 1.2% for the uncorrected forces and to less than 0.5% for the corrected forces .",
    "the amplitudes of these oscillations are nevertheless significant and may affect the thermodynamics in a way that is not easy to predict .",
    "these oscillations clearly originate from the initial jerk experienced by the the electrons in their ground state and survive for a long time due to the adiabatic decoupling .    in the liquid",
    "the situation is considerably worse than in the crystal .",
    "the standard deviation of the error is @xmath111 which improves only to @xmath112 with the rigid - ion correction .",
    "there do not seem to be high frequency , high amplitude oscillations here despite the simulation being started with finite ionic velocities . however , there are oscillations of a lower frequency ( although still quite high relative to ionic timescales ) which are probably due to the presence of the nos thermostat",
    ". it may be that the nos thermostat has the effect of damping out the kinds of oscillations seen in fig .",
    "[ fig : si300krough ] but the presence of these other oscillations is hardly an improvement .",
    "this highlights the need for careful choice of parameters for the nos thermostat , particularly the value of @xmath113 .",
    "it is not clear how one should choose this parameter in general .",
    "for example , here we have used a value of @xmath113 compatible with ref.[10 ] , however we note that this is considerably smaller than the value recommended in ref.[6 ] which was obtained according to a rigid ion model .",
    "we have also done simulations using higher values of @xmath113 and in all cases the errors in the forces have been greater .",
    "it is likely therefore that by decreasing further @xmath113 we might improve further the forces however this has not been attempted here .",
    "the issue of thermostatting a system in a way which minimizes the kinds of errors seen here while accounting for the evolution of the electronic ground state in a more general way than is allowed by the rigid - ion approximation has recently been tackled by blchl@xcite .",
    "we now look at the forces in crystalline mgo with @xmath114a.u ( fig .",
    "[ fig : o_solid400 ] ) .",
    "the relatively high quantum kinetic energy associated with states attached to the o ions means that , according to eq .",
    "( [ eqn : a ] ) , the errors in the forces are considerably larger for the o ions than we have seen for si . the errors in the cp forces have in fact a standard deviation as large as @xmath115",
    ". however , when this is corrected as in ( [ eqn : masscorr ] ) by attributing all the quantum kinetic energy to states rigidly following the o ions the standard deviation of the error reduces to @xmath116 .",
    "furthermore , the corrected value of @xmath107 indicates that about @xmath117 of the error on the o forces cancels out after account is taken for the high frequency oscillations , suggesting that a more appropriate estimate of the error is @xmath118 .",
    "the amplitude of the fast oscillations is a cause for concern however and since the simulation was begun at zero ionic velocity it is not clear how it may be reduced further .",
    "we focus here only on mgo , as the effects of the electronic dragging are enhanced . according to the results of section iii",
    ", we should expect a difference between the naive definition of temperature and the definition corrected by the electronic dragging , eqn .",
    "( [ eqn : realtemp ] ) .",
    "in the case of mgo , as noted in the previous section , this correction affects only the oxygen atoms , as only a minor amount of electronic charge is carried by the mg@xmath119 ion . in fig .",
    "[ fig : temperature ] we show the behavior of the instantaneous values of the naive and corrected temperatures .",
    "the corrected temperature exceeds the naive definition by about 500 k. more interestingly , we report in fig .",
    "[ fig : temperature ] also the contributions to the temperature of the two atomic species .",
    "it is clear that the naive definition would imply that the two species are not at thermal equilibrium . on the other hand , use of the corrected definition for the oxygen temperature",
    "brings the temperature of the two species in much better agreement , supporting the conclusion , based on the rigid ion model , that thermodynamics can be restored by a simple rescaling of the oxygen mass .",
    "the mass rescaling , as calculated with ( [ eqn : error3 ] ) amounts to @xmath120 atomic mass units ( @xmath121 atomic mass units ) .",
    "we also report in fig .",
    "[ fig : temperature ] the instantaneous value of the fictitious electronic kinetic energy , the l.h.s . of eq .",
    "( [ eqn : temp_e ] ) , and the difference between this quantity and the r.h.s . of eq .",
    "( [ eqn : temp_e ] ) , which represents the contribution due to the rigid dragging of the electronic orbitals .",
    "the difference is very small , implying that residual contributions due , for example , to the fast electronic oscillations are negligible in mgo compared to the slow dragging of the orbitals .",
    "we have calculated the phonon densities of states of crystalline si and mgo by fourier transforming the velocity autocorrelation function . in all cases ,",
    "the first picosecond of the simulation was discarded and results obtained by averaging over at least one subsequent picosecond . for silicon the velocity autocorrelation function was calculated on a time domain of length @xmath122ps and for mgo on a time domain of length @xmath81ps .    in silicon ( fig .",
    "[ fig : phonon_si ] ) the difference is reasonably small . according to the rigid ion model the frequencies should be corrected using @xmath123 where @xmath124 is the frequency as extracted directly from the cp simulation .",
    "we find that for silicon this overestimates by about a factor of two the amount of the correction .",
    "this small discrepancy may be due to the length of simulation used for calculating the frequency spectra or due to a breakdown of the rigid - ion description when @xmath125 .",
    "it may also be that neglecting the effect of the fast oscillations is not be completely appropriate when the dragging contribution is small .    in mgo , as expected",
    "the difference is much larger .",
    "we calculate the phonon spectra for @xmath114a.u . and for @xmath126a.u and find large differences between them ( see fig .  [",
    "fig : phonon_mgo ] ) highlighting again how the dynamics depends on the value of @xmath0 .",
    "the fact that two species are involved complicates matters as the mass correction is different for the two species ( it actually vanishes for mg ) .",
    "therefore we should not expect simply a rigid shift of the frequencies .",
    "however , if the rigid - ion approximation is valid , one may conceive to rescale the oxygen mass _ a priori _ in eq .",
    "( [ eqn : ions1 ] ) as @xmath127 , so that the actual cp dynamics expressed in terms of the bo forces , eq .",
    "( [ eqn : masscorr ] ) , becomes identical to the bo dynamics if the rigid ion approximation holds .",
    "we have done this for mgo , again for @xmath114a.u . and @xmath126a.u and we see that the results are much improved",
    ". there are only small differences in the positions of the peaks and the overall shapes of the curves are very similar .",
    "we now try to address the question of how the error in the cp forces depends on the fictitious electron mass . according to eqn .",
    "[ eqn : error2 ] the error should scale approximately linearly with the mass .",
    "however this is based on the simplifying assumptions that the oscillations in @xmath76 have a small amplitude and that the @xmath76 do not on average exchange energy with the ions , i.e. full adiabatic decoupling is achieved .",
    "[ fig : scaling ] shows @xmath128 and @xmath92 for the oxygen ion for three different values of @xmath74 where @xmath92 has been scaled to eliminate the contribution of errors from high frequency oscillations by inspection of @xmath107 .",
    "since the uncorrected error is dominated by the effect of the displacement of the equilibrium positions of the orbitals from the ground state , this scales approximately linearly with @xmath74 . the small error which remains",
    "after the rigid ion correction has been applied could have contributions from many different sources including deviations from the rigid ion description and interactions between the ions and the @xmath129 .",
    "it is also of the order of the fluctuations in @xmath69 during the simulation .",
    "the various cases studied in this work have been explicitly chosen because of their `` extremal '' behavior .",
    "the oxygen ions in mgo have a very strong electron - ion coupling as shown by the large quantum kinetic energy",
    ". however , oxygen seems to be well described within the rigid - ion approximation and so the thermodynamics are probably quite close to those of a bo system .",
    "crystalline silicon is less well described in terms of rigid ions ( although still remarkably well ) but it has a much lower electron - ion coupling so the errors in the forces are very small . if we `` measure '' the departure of the cp dynamics from the bo dynamics in terms of @xmath130 , with @xmath131 defined as in ( [ eqn : masscorr ] ) , then it appears that the elements where the departure is expected to be larger are located in the upper right of the periodic table , because they combine a low atomic mass with a large binding energy of the valence electrons ( and thus a large quantum kinetic energy ) .",
    "transition metals may also be strongly affected , because of the large number and strong localisation of the @xmath132-electrons . however , the higher the localisation of the orbitals , the higher the chances that the description of the electronic dynamics in terms of rigid orbitals is correct .",
    "the large departure observed in the case of mgo suggests that a proper assessment of how much the cp forces differ from the bo ones is mandatory in most systems .",
    "this can be achieved by either calculating the bo forces for selected ionic configurations , or by performing simulations for different ( smaller ) values of @xmath0 , and checking how the results scale with decreasing @xmath0 .",
    "if the departure is large then it is likely that in many cases the cp forces can be brought into good agreement with the bo ones by simply rescaling the ionic masses .",
    "additional complications may arise when the dynamics lead to fundamental changes in the electronic structure .",
    "the first and second derivatives of the electronic orbitals with respect to the positions of the ions , which appear in equation  [ eqn : error2 ] , may become relevant in regions of phase space where the electrons play a significant role .",
    "for example , if charge transfer between ions occurs , or if a substantial rearrangement of the electronic orbitals takes place , as in a chemical reaction , then the simple method of rescaling the ionic masses will no longer work .",
    "if one is to judge the quality of a cp simulation by the errors in the forces as we have largely done here , then a question which needs to be addressed is to what extent these errors manifest themselves as errors in the properties of interest in the simulation .",
    "it is likely that random high frequency oscillations in the forces such as those due to the dynamics of the @xmath19 have no discernible effect on the thermodynamics of the system if such oscillations are small .",
    "the magnitude of the oscillations seen here in the case of mgo is a cause for concern however .",
    "a further problem may arise at high temperatures where , if there is electron - ion coupling , energy can pass between ions and electronic orbitals and the ionic and orbital subsystems may begin to equilibrate leading to an increase in the fictitious electronic kinetic energy .",
    "this can be seen by inspection of equation  [ eqn : electrons4 ] , where the ionic terms may vary over short timescales if the ionic kinetic energy is very high and the fictitious mass @xmath0 too large .",
    "it has previously been supposed@xcite that such an irreversible increase of kinetic energy was due to overlap of the ionic frequency spectrum with that of the electrons due to a small or vanishing bandgap , @xmath133 .",
    "however a small bandgap is a sufficient but not a necessary condition for this energy transfer to occur .",
    "all of the effects discussed in this paper are dependent on the choice of the fictitious mass parameter , @xmath0 , and by reducing this parameter all thermodynamic and dynamic properties of a simulation may be brought arbitrarily close to those in a born - oppenheimer system .",
    "however , a reduction of @xmath0 has the drawback that the time step required to integrate the equation of motion for the electronic orbitals is reduced thereby decreasing the computational efficiency of the method .",
    "by checking how the property of interest in a simulation scales with @xmath0 one can control the level of approximation with which it is calculated .",
    "under the assumption that high frequency electronic oscillations ( i.e. the dynamics of the @xmath76 ) are small and independent of ionic motion , we have shown that car - parrinello simulations amount to solving the equation of motion for the ions @xmath134    we have compared the forces in simulations of si and mgo for a number of different values of @xmath0 to the bo forces and found that in the case of si the errors are small and change very slightly the phonon spectrum of the crystal . in mgo",
    "we observe very large systematic errors in the forces which are however mostly attributable to a rescaling of the mass of the oxygen ion thereby preserving the thermodynamics . when corrected for this effect",
    "the errors are slightly higher than those in crystalline si but still quite small .",
    "the phonon densities of states further confirm both the inadequacy of cp at these values of @xmath0 without the rigid - ion correction to describe dynamics and the ability of the rigid - ion model to correct the dynamics in mgo .",
    "* acknowledgements . *",
    "the authors would like to thank r. car and n. marzari for useful discussions .",
    "we also thank p. blchl for providing us with an advance copy of his manuscript@xcite .",
    "in addition p.t . would like to thank a. trombettoni for useful discussions and m. payne for some valuable suggestions . in this work extensive use",
    "was made of the keck computational materials science laboratory at the princeton materials institute .",
    "99 r. car and m. parrinello , phys .",
    "lett . * 55 * , 2471 ( 1985 ) . w. kohn and l. j. sham , phys . rev . * 140 * , a1133 ( 1965 ) .",
    "see , for example p.e .",
    "blchl , phys .",
    "b * 50 * , 17953 ( 1994 ) .",
    "g. pastore , e. smargiassi and f. buda , phys .",
    "a * 44 * , 6334 ( 1991 ) .",
    "f. tassone , f. mauri and r. car , phys .",
    "b * 50 * , 10561 ( 1994 ) .",
    "p. e. blchl and m. parrinello , phys .",
    "b * 45 * , 9413 ( 1992 ) .",
    "j. kohanoff , comput .",
    "* 2 * , 221 ( 1994 ) .",
    "s. scandolo _",
    "et al _ , phys .",
    "* 74 * , 4015 ( 1995 ) .",
    "n. trouiller and j. l. martins , phys . rev . *",
    "b 43 * , 1993 ( 1991 ) o. sugino and r. car , phys .",
    "lett . * 74 * , 1823 ( 1995 ) .",
    "s.  nos , mol . phys . * 52 * , 255 ( 1984 ) .",
    "d. k. remler and p. a. madden , mol . phys . * 70 * , 921 ( 1990 ) .",
    "p. e. blchl , submitted to phys . rev .",
    "b         and all cartesian components @xmath25 of the percentage errors in the cp forces relative to the bo forces at the same ionic positions , @xmath135 ( full line ) and these errors when the forces have been partially corrected according to a rigid - ion model , @xmath136_{corr}$ ] ( dashed line ) .",
    "( b ) @xmath107 as defined by eqn .",
    "[ eqn : gamma ] for the full error in the forces and those as partially corrected according to the rigid - ion model ( c ) @xmath137,@xmath138 and @xmath139 ( multiplied by a factor of @xmath140 for visibility ) for a typical force component .",
    "dots indicate the points at which the bo force was calculated ( every 5 time steps ) . , title=\"fig:\",width=302,height=453 ] +         k. ( a ) and ( b ) are as in fig . 1 ( c ) from top to bottom @xmath139,@xmath141(dotted line ) , @xmath142,@xmath138,@xmath137 for a typical force component .",
    "dots indicate the points at which the bo force was calculated ( every time step ) .",
    ", width=302,height=453 ]"
  ],
  "abstract_text": [
    "<S> we derive an analytic expression for the average difference between the forces on the ions in a car - parrinello simulation and the forces obtained at the same ionic positions when the electrons are at their ground state . </S>",
    "<S> we show that for common values of the fictitious electron mass , a systematic bias may affect the car - parrinello forces in systems where the electron - ion coupling is large . </S>",
    "<S> we show that in the limit where the electronic orbitals are rigidly dragged by the ions the difference between the two dynamics amounts to a rescaling of the ionic masses , thereby leaving the thermodynamics intact . </S>",
    "<S> we study the examples of crystalline magnesium oxide and crystalline and molten silicon . </S>",
    "<S> we find that for crystalline silicon the errors are very small . for crystalline mgo </S>",
    "<S> the errors are very large but the dynamics can be quite well corrected within the rigid - ion model . </S>",
    "<S> we conclude that it is important to control the effect of the electron mass parameter on the quantities extracted from car - parrinello simulations . </S>"
  ]
}