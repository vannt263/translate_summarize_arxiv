{
  "article_text": [
    "in the last few years , more and more attention has been paid to the problem of state and parameters identification for complex three - dimensional models used in biomedical applications .",
    "several works can be cited : for example in cardiac electrophysiology @xcite or in cardiac mechanics @xcite , or also in hemodynamics @xcite .",
    "the observations available in these contexts are often multiphysics since several modalities can be used simultaneously : electrocardiograms , electrograms , mri , ct scan , flow measurements with ultrasound , pressure measurement with catheters , myocardium thickness measurement with piezoelectric sensors , etc . up to now , the multiphysics nature of these problems has sometimes been taken into account in the direct models but it has rarely been used in the inverse problems .    the first purpose of the present study is to exhibit an example where multiphysics observations actually improve the identifiability of a coupled system .",
    "more precisely , considering an electromechanical model of the heart , it is shown that the estimation of an electrical parameter is improved if the electrical observation , namely the electrocardiogram , is enriched with mechanical observations , namely the movement of the myocardium . in this model ,",
    "the electrophysiology acts as an input for the mechanics , but the electromechanical feedback is neglected  @xcite .",
    "the coupling is therefore only one - way .",
    "the second purpose of this article is to show that a reduced order filtering strategy is well - suited to this class of multiphysics problems .",
    "optimal filtering , like kalman filter and its nonlinear extensions , is known to be very efficient but also too expensive to be used for large problems like those considered here .",
    "an effective strategy consists in using this kind of methods for the parameters only , and to address the uncertainties on the state variables through a less expensive approach .",
    "this strategy has been successfully used for example in mechanics where the state variable was handled with a luenberger filter @xcite . in this paper , a similar strategy",
    "is proposed to filter the electrical state variables , by exploiting the special structure of the one - way coupled problem .",
    "but due to the structure of the equations , a luenberger approach is not straightforward in electrophysiology . a different reduced order method , based on proper orthogonal decomposition",
    "is then proposed , as it was done for cardiac mechanics in @xcite .",
    "the goal of the inverse problem of electrocardiography , also called _ cardiac electrical imaging _ , is to reconstruct the electrical activity of the heart from body surface potential maps .",
    "various strategies have been proposed since four decades .",
    "all of them assume that measurements of the electrical potential @xmath0 are available on parts of the torso boundary @xmath1 .",
    "the different strategies can be distinguished by the cardiac electrical source models they rely on .",
    "one of the first approaches was to estimate equivalent electrical dipoles @xcite .",
    "another popular approach is to estimate the heart surface potential , usually called epicardial potential ( even though pericardial potential would be more appropriate as noted in @xcite ) .",
    "the potential @xmath0 within the torso @xmath2 is assumed to be solution of the poisson problem : @xmath3 where @xmath4 denotes the boundary of the heart and @xmath5 is the electrical conductivity of the torso .",
    "the inverse problem then consists in estimating @xmath6 on @xmath4 ( see e.g. @xcite ) .",
    "this problem being notoriously ill - posed , various regularizations have been proposed : tikhonov @xcite , the use of temporal information @xcite , truncated singular value decomposition or truncated total least square @xcite .",
    "another approach to address the inverse problem of electrocardiography is to consider the following equation within the heart @xmath7 : @xmath8 which is one of two equations of the _ bidomain model _ ( see section  [ sub : electrophysiology ] ) .",
    "then , instead of estimating the epicardial potential @xmath6 on the surface @xmath4 , the goal is to estimate the transmembrane potential @xmath9 within the heart . in @xcite ,",
    "the two approaches were compared : investigating the null - space of the inverse problem , the authors concluded that the transmembrane potential - based formulation is more promising because it is based on a stronger biophysical _ a priori_. as the epicardial potential approach , the transmembrane potential approach is ill - posed and must be regularized . in @xcite ,",
    "four variants of @xmath10-tikhonov regularization are compared . in @xcite , @xmath11-tikhonov regularization",
    "is used with a prior taking two different homogeneous values in the myocardium depending on cardiac phase ( plateau or rest values ) .",
    "the inverse problem , formulated in a pde - constrained framework , is addressed by directly solving the optimality saddle - point problem . in @xcite , the estimation of the transmembrane potential",
    "is combined with a level set technique to efficiently identify the location of a myocardial infarction . in @xcite ,",
    "the approach of @xcite is generalized to more general objective functions and constraints in order to identify ischemic regions ( characterized by lower amplitude during the plateau phase ) .",
    "two different regularizations are investigated : the tikhonov regularization , which is found to overestimate ischemic regions but with good sensitivity , and the total variation regularization which is found to underestimate ischemic regions but with high specificity .    in @xcite ,",
    "the authors note that the usual regularization techniques have no physical ground .",
    "instead , they propose to regularize the inverse solution with the monodomain equations coupled to the fenton - karma ionic model .",
    "the strategy proposed in the present paper has some similarities with this approach .",
    "we rely on a full electrophysiological model of the action potential coupled to the poisson problem to estimate the solution of the heart electrical activation .",
    "this physical model is personalized on the fly with respect to its parameters in order to adapt it to a specific patient .",
    "furthermore , we propose an additional step of modeling by considering the mechanical response to the electrophysiological activation , so we are able to also integrate mechanical measurements .",
    "indeed , we believe that multimodal observations improve the identifiability of the complete model and therefore improve the quality of the electrical and mechanical state reconstruction .",
    "another originality of our work is the use of a sequential data assimilation strategy that is adapted to a coupled electromechanical evolution model .",
    "here we demonstrate how state - of - the - art gain filter on the electrophysiological model and on the mechanical model can be aggregated to propose a joint gain filter for the coupled problem .",
    "the paper is organized as follows . in section  [ sec : models ] , the electromechanical model is presented . in section  [ sec : measurements ] , the observation operators  namely the measurements  are detailed for the electrical and the mechanical variables . in section  [ sec : data_assimilation_principles ] , the general notions of data assimilation , optimal filtering and reduced order filtering are reviewed .",
    "although the algorithms of this section are not new , their presentation differs from what is most often done in the literature since a purely deterministic description is adopted . in section  [ sec : data_assimilation_electromech ] , the algorithms used for the electromechanical problem are proposed and analyzed . in section  [ sec : numerical_test_cases ] , numerical experiments based on synthetic data are presented .",
    "the main purpose is to estimate a non - homogeneous parameter of the electrical model using electrical and mechanical observations .",
    "we present the models in a time and space continuous context before entering into the discretization details and their numerical implementation .",
    "concerning the continuous context , we denote by an underline character any vector field of @xmath12 and two underlines any second - order tensor .",
    "a widely accepted model of the macroscopic electrical activity of the heart is the so - called _ bidomain model _ @xcite .",
    "it consists of two degenerate parabolic reaction - diffusion pdes which describe the dynamics of the averaged intra- and extracellular potentials @xmath13 and @xmath6 , coupled to a system of odes defining an _ ionic model_. this model is related to the chemical dynamics of the myocardium cell membrane , in terms of the ( vector or scalar ) variable @xmath14 representing the distributed ion concentrations and gating states , or a phenomenological counterpart .",
    "the model reads @xmath15 where @xmath16 represents the transmembrane potential , @xmath17 is the membrane capacitance per unit area , @xmath18 is a constant representing the rate of membrane area per unit volume , @xmath19 are the intra- and extra - cellular conductivity tensors , @xmath20 is an external volume current . in the function @xmath21",
    "represents an ionic model . in this article , the mitchell - schaeffer ionic model @xcite is considered , with the same rescaling as in @xcite",
    "it is a reduced complexity model capable of integrating relevant phenomenological properties of the ventricle cell membrane : @xmath22              g({v_{m}},{w } ) = \\left\\ {                  \\begin{aligned }                      \\frac{{w}}{{\\tau_{\\mathrm{open } } } } -\\frac{1}{{\\tau_{\\mathrm{open}}}({v_{\\mathrm{max}}}-{v_{\\mathrm{min}}})^2 } & \\quad \\mbox{if } { v_{m}}\\leq { v_{\\mathrm{gate}}},\\\\                      \\frac{{w}}{{\\tau_{\\mathrm{close } } } } & \\quad \\mbox{if } { v_{m } } > { v_{\\mathrm{gate } } } ,                  \\end{aligned}\\right .",
    "\\end{cases}\\ ] ] where @xmath23 , @xmath24 , @xmath25 , @xmath26 , @xmath27 are given constants and @xmath28 and @xmath29 are scaling constants ( typically @xmath30 and @xmath31 ) .",
    "on the boundary @xmath4 , we have @xmath32 , and the heart is assumed to be isolated , @xmath33 , as often done in the literature  @xcite . for well - posedness , the condition @xmath34 is enforced .",
    "summing and subtracting the first two equations of , the system reads @xmath35    a @xmath36 finite element discretization of the potential variables is used   see the corresponding refined electrical mesh in figure  [ fig : meshes ] .",
    "this leads to a discretization space @xmath37 with @xmath38 degrees of freedom ( i.e. @xmath39 ) .",
    "to each field   for instance @xmath9 ",
    "is associated its corresponding approximation , denoted with an index @xmath40   for example @xmath41 .",
    "equivalently , this approximation can be represented by its corresponding vector of degrees of freedom written with a vector in uppercase letter ",
    "_ i.e. _ @xmath42 . the finite element vector of degrees of freedom or the discretization of linear form",
    "are then defined with vectors in straight uppercase letter whereas the finite element matrix operator with a bold uppercase letter . with this notation : @xmath43 @xmath44 @xmath45 and if a spatial discretization of the internal variable is done by node @xmath46 where the applied current and the ionic variables have been interpolated , allowing to define the ionic variables at the nodes instead of the quadrature points . finally , after spatial discretization system reads @xmath47 the state of this system is @xmath48 while @xmath49 appears as an auxiliary variable verifying the static equilibrium @xmath50 with @xmath42 .",
    "this can be summarized by @xmath51 where @xmath52 denotes the vector of parameters of the electrophysiology model , @xmath53 and @xmath54 the uncertainty on the parameters and the initial condition respectively .",
    "the heart domain is denoted by @xmath55 at any time @xmath56 .",
    "this domain is the image of a reference configuration @xmath7 through the solid deformation mapping @xmath57 @xmath58 & \\longrightarrow { { \\omega}^{\\scriptscriptstyle \\mathrm{h}}}(t),\\\\          ( { { \\underline{\\xi}}},t ) & \\longmapsto { { \\underline{\\mathrm{x}}}}= { { \\underline{\\xi}}}+ { { \\underline{y}}}({{\\underline{\\xi}}},t )       \\end{aligned }      \\right.\\ ] ] where @xmath59 is the solid displacement .",
    "the solid velocity is given by @xmath60 .",
    "the deformation gradient @xmath61 is given by @xmath62 , and its determinant is denoted by @xmath63 .",
    "the right cauchy - green deformation tensor is defined by @xmath64 , the green - lagrange tensor by @xmath65 and its linearization by @xmath66 .",
    "the mass per unit volume is denoted by @xmath67 and the cauchy stress tensor by @xmath68 . in the reference configuration , the first and second piola stress tensor are respectively defined by @xmath69 and @xmath70 .",
    "the constitutive law is assumed to be a combination of a hyperelastic law of potential @xmath71 , a viscous component chosen proportional to the strain rate @xmath72 , and an active part along the fiber direction @xmath73 represented by 3 internal variables which are @xmath74 the active strain , @xmath75 the active stiffness and @xmath76 the associated active stress @xcite : @xmath77 with @xmath78 , where these 3 internal variables rely on a chemically - controlled constitutive law describing the myofibre mechanics @xcite : @xmath79 with @xmath80 , @xmath81 , @xmath82 given parameters , @xmath83 a function of @xmath74 accounting for the frank - starling effect and @xmath84 directly related to the electrical activity of the heart by @xmath85 where @xmath86 and @xmath87 are two scaling parameters .",
    "concerning the boundary conditions , the external organs are modeled by visco - elastic boundary conditions on a sub - part of the epicardium : @xmath88 . a uniform pressure is enforced on the left and right endocardium : @xmath89 . in summary ,",
    "the mechanical problem reads @xmath90 with the constitutive law .",
    "several improvements can be formulated on this model : other active or passive constitutive laws , more sophisticated boundary conditions for the tethering of the myocardium or hemodynamics , _",
    "etc_. the estimation strategy presented here can be adapted to any of these improvements since we only refer to state - space model description to formulate our data assimilation methods .",
    "the system is discretized with a @xmath36 finite element ",
    "see the corresponding mechanical mesh in figure  [ fig : meshes ]   with a 5% compressibility acceptance in order to avoid any numerical locking . concerning the fibre directions , we prescribed them on each point of the mesh with an elevation angle varying from -60 degrees to 60 degrees through the myocardium thickness .",
    "the discrete system is based on the variational formulation associated with : @xmath91 using the same convention as for the electrophysiological model discretization , the mass operator is defined by @xmath92 the stress residual by @xmath93 some weighted mass operators on the boundary by @xmath94 and a following pressure operator by @xmath95 the internal variables @xmath96 are gathered in a vector @xmath97 , which is discretized at the integration points .",
    "a vector of degrees of freedom @xmath98 is associated with the discontinuous field @xmath99 and the model is discretized by @xmath100 .",
    "the complete mechanical model is spatially discretized into @xmath101 the state of this system is @xmath102 . denoting by @xmath103 the set of the parameters characterising the mechanics , affected by an a priori uncertainty @xmath104 and with @xmath105 the a priori uncertainty on the initial condition ,",
    "the mechanical system reads @xmath106 where the electrical variable @xmath107 , solution to  , can be seen as an input .      from a computational point of view , the electromechanical problem consists in solving two coupled systems .",
    "we chose to keep the two sub - systems in independent solvers .",
    "this choice allows us to use legacy codes , to make their maintenance easier and to take advantage of the specific numerical methods adapted to each physical compartment .",
    "the coupling algorithm sketched in figure  [ fig : masterworkers ] is handled by a `` master '' code which exchanges the heart displacements and the transmembrane potential with the electrical and mechanical software . in this work",
    ", it is assumed that there is no electromechanical feedback .",
    "the transmembrane potential @xmath9 is sent to the mechanical problem .",
    "then , the one - way coupling is performed through the quantity @xmath108 which triggers the mechanical contraction via a change in the active stiffness @xmath75 and in the active stress @xmath76 , see .",
    "= [ rectangle , draw , text width=7em , text centered , drop shadow , fill = white , rounded corners , minimum height=3em ] = [ pin edge = to-,thin , black ]    ( masterinit ) initialization ; ( mechanics0 ) mech .",
    "solver + @xmath109 ; ( electric0 ) elec .",
    "solver + @xmath109 ; ( masteriter ) interpolation ;    ( mechanics1 ) mech .",
    "solver + @xmath110 ; ( electric1 ) elec .",
    "solver + @xmath111 ;    ( masteriter.10 ) ",
    "node[name = vtom ] @xmath112 ( mechanics1.170 ) ; ( electric1.10 )  node[name = vfrome ] @xmath112(masteriter.170 ) ; ( masterinit.350 )  node[name = dfromm ] start iter .",
    "( mechanics0.190 ) ; ( masterinit.170 ) ",
    "node[name = vfrome ] start iter .",
    "( electric0.10 ) ;    ( timestep1 ) @xmath113 ; ( timestep2 ) @xmath113 ; ( timestep3 ) @xmath113 ; ( electric0.south )  node[name = timeelec , above right ] @xmath114 ( electric1.north ) ;    ( mechanics0.south )  node[name = timemech ] @xmath115 ( mechanics1.north ) ;    ( masterinit.south )  node[name = update ] @xmath116 ( masteriter.north ) ;    background ( masterinit.west)+(-0.2,2.1 ) node ( masternw ) ; ( masteriter.east)+(0.2,-1.0 ) node ( masterse ) ; ( masternw ) rectangle ( masterse ) ; ( masterinit.north)+(0,1 ) node ( mastern ) master elec .- mech . ;    ( electric0.west)+(-0.2,2.1 ) node ( electricnw ) ; ( electric1.east)+(0.2,-1.0 ) node ( electricse ) ;    ( electricnw ) rectangle ( electricse ) ; ( electric0.north)+(0,1 ) node ( electricn ) slave elec .",
    "solver ;    ( mechanics0.west)+(-0.2,2.1 ) node ( mechanicsnw ) ; ( mechanics1.east)+(0.2,-1.0 ) node ( mechanicsse ) ;    ( mechanicsnw ) rectangle ( mechanicsse ) ; ( mechanics0.north)+(0,1 ) node ( mechanicsn ) slave mech .",
    "solver ;    because of the characteristics of the action potential propagation , the space and time steps required by the electrophysiology are typically smaller than those needed by the mechanics . to ensure accuracy at a reasonable computational cost , each sub - problem",
    "is solved with its own space and time step .",
    "the data are transmitted by the master code at some check - point in time ( see figure  [ fig : masterworkers ] ) and interpolated in space from a mesh to another ( see figure  [ fig : meshes ] ) .",
    "eventually , a typical complete direct simulation of our model is presented in figure  [ fig : directsimulation ] .",
    "[ htb ]     nodes , @xmath117 elements ) and electrical mesh ( center , @xmath118 nodes , @xmath119 elements ) and thorax mesh ( right , @xmath120 nodes , @xmath121 elements ) ]    [ htbp ]        the inverse problem will be addressed on the discrete formulations .",
    "the state and the parameters are defined as the combination of the electrical and the mechanical ones @xmath122 defining @xmath123 , this state variable follows the dynamics    @xmath124    the initial condition includes the quantities @xmath125 and @xmath126 which model the uncertainties on the initial condition and on the parameters respectively .",
    "when necessary , a trajectory will be denoted by @xmath127}$ ] .",
    "this system can also be written in an augmented form by concatenated the state and parameters in @xmath128 .",
    "this augmented state satisfies @xmath129 .",
    "the real trajectory is assumed to be a solution of the model for a given value of the uncertainties and is given by @xmath130 .",
    "the best way to access the electrophysiological quantities would be to directly measure the electrophysiological potential at the heart surface .",
    "this is possible with an invasive procedure where a basket of electrodes is immersed in the ventricle and records the potential close to the endocardium surface ( @xcite e.g. ) . in that case , the electrophysiological measurements can be represented by @xmath131 where the observation operator @xmath132 interpolates the values at the basket electrodes and @xmath133 gathers all the measurement errors . after spatial discretization @xmath134 where",
    "now @xmath133 takes also into account the finite element discretization error .    to avoid such invasive measurement procedures , it is preferable to rely on electrocardiograms .",
    "physiologically , the electrical potential diffuses from the heart to the rest of the body through the pericardium .",
    "the ecg depicts the time course of standardized potential differences on the body surface .",
    "we refer to @xcite for examples of healthy and pathological ecg obtained with the electrophysiology model used in the present paper .",
    "the electrical diffusion within the body @xmath2 can be modelled by a poisson equation with the extracellular potential as a boundary condition on the heart surface and homogeneous neumann boundary elsewhere : @xmath135 where the conductivity tensor is assumed to be isotropic , but non - homogeneous to account for the different conductivities of the lungs , the bones and the rest of the body ( see @xcite ) .",
    "after spatial discretization   see the corresponding thorax mesh in figure  [ fig : meshes ] ",
    "the ecg measurements denoted by @xmath136 are still related to the electrical state variable by an observation operator @xmath132 which is the composition of the discrete diffusion operator and a linear combination of the potential at 9 points of the body surface .",
    "assuming that the model is accurate enough , the actual ecg can still be represented by where @xmath133 gathers all the possible measurement errors , including the errors resulting from the modelling of the measurement procedure .",
    "after spatial discretization , a relation of the form still holds , but with @xmath133 also accounting for the discretization error .      the heart contraction can also be perceived from a kinematic and even a mechanical perspective .",
    "in fact , the displacements of the cavity can be observed using imaging modalities , for example cine - mri sequence , ct - sequence or even tagged - mri sequence .",
    "considering for example this last type of measurement and assuming adequate registration strategies allowing to extract @xmath137 displacements of material points @xcite , we can assume that displacements are measured in a large part of the ventricles , typically between two short axis planes , the first one slightly lower than the base and the second one slightly higher than the apex ",
    "see figure  [ fig : directsimulation ] . with more standard sequences , like cine - mri or ct sequences , we can benefit from optical flow strategies to extract displacements most of the time on part of the boundary . in both cases , after discretization , we can assume the existence of an observation operator @xmath138 such that the measured displacements are given by @xmath139 where @xmath140 is now a vector taking into account the discretization error .",
    "extracting displacements using registration techniques is still a challenge and it often leads to the measurement of an apparent motion instead of the real motion . as a consequence , it can be more adequate to consider the structure measured in itself more than its collection of material points .",
    "this was done typically in @xcite where in cine - mri and ct sequences the contours of interest are extracted and compared to the contours produced by the simulation by the use of a discrepancy field of the form @xmath141 .",
    "hence , the closer to 0 the discrepancy is the more information we have extracted from the images . as demonstrated in @xcite , this type of discrepancy operator is a simple non - linear generalization of the discrepancy computed by subtracting to the actual measurements the one produced by the use of the observation operator defined below .",
    "this generalization has demonstrated its efficiency in several real cases of data assimilation investigations @xcite .",
    "but , for the sake of simplicity , and since this work is primarily aimed at providing a proof of concept , we limit ourselves to more simple observation operators .",
    "note that the use of a non - linear observation operator is , in the end , always analyzed in the light of the corresponding linearized operator @xcite .",
    "the stresses are more intricate to measure . for now , the most common measurement available is an intracavity pressure obtained after invasive catheterization or reconstructed from arterial blood pressure measurements . in this article",
    "we assume that we can consider the intracavity pressure as a given source term in our model . in a more general case",
    ", we could model the evolution of the intracavity pressures with the help for example of a windkessel model and then use the possibly noisy measurements in a data assimilation context where the intracavity pressures are additional variables of the model .",
    "finally the observations are concatenated and therefore given and the complete form @xmath142 which for the sake of generality will not be necessarily considered as linear when it is not mandatory .",
    "data assimilation has become a very popular strategy to estimate a wide range of modeling uncertainties in numerical simulations @xcite .",
    "it has been initiated for environmental sciences but has now reached life sciences and especially cardiology . to introduce its main concepts in the _ state - space _ formalism , we consider a dynamical model @xmath143 in this equation , @xmath144 denotes the _ state variable _ , namely , the physical quantity which the model aims at describing during its time evolution . in this generic notation ,",
    "the whole model is essentially summarized in the _ dynamical operator _",
    "@xmath145 , which applies on the state variable itself , and may depend on time @xmath56 as well as on a set of physical parameters denoted by @xmath146 . in this work , corresponds to the electromechanical system defined by and , or  to avoid issues associated with pdes",
    " its discrete counterpart and ( but most of what is presented here can be actually generalized to infinite dimensional systems  @xcite ) .",
    "the initial condition @xmath147 and the parameter vector @xmath146 must be prescribed in .",
    "hence , when these quantities are unknown , they have to be estimated . in general @xmath147 and @xmath146",
    "are decomposed into known parts @xmath148 and @xmath149 called _ a priori _ and uncertain parts @xmath150 and @xmath151 : @xmath152 when necessary , the trajectory of @xmath153 will be denoted by @xmath154}$ ] .",
    "let us now re - consider an augmented state @xmath155 in order to integrate parameter uncertainties .",
    "the corresponding augmented model is defined by @xmath156 hence the parameters and the state can be consider in the same formalism .",
    "however , these two quantities differ in their dimension . indeed ,",
    "when the state is defined based on a pdes model , the dimension of the state variable after space discretization is typically of the size of @xmath157 to @xmath158 degrees of freedom .",
    "by contrast , the size of the parameter vector is generally much more limited .",
    "even if distributed parameters are considered , their variation should be considered smooth enough so that they can be discretized on a coarse mesh or a subdivision of the domain into large regions . therefore , typically less than a hundred of parameter values need to be estimated .",
    "the measurements presented in section  [ sec : measurements ] can be cast in a general form : given a real trajectory @xmath159 , the noisy observations are represented using an observation operator @xmath160 such that @xmath161 where @xmath162 denotes the actual data field .",
    "note that @xmath160 can possibly be extended to a function of @xmath163 and will then be denoted by @xmath164 .",
    "a common strategy in data assimilation is to minimize a criterion that balances the confidence in the a priori value of the state and parameters and a discrepancy measure between the given observations and the simulated ones . in the state - space formalism",
    "this criterion is typically least - square and reads @xmath165})\\rvert}_{m}^2 \\ , dt.\\ ] ] where @xmath166 is a metric on the observation space and @xmath167 is the inverse of a metric which can be interpreted as an initial uncertainty covariance .",
    "the so - called _ 4d - var _",
    "method @xcite consists in finding the unknown quantities @xmath168 by minimizing @xmath169 under the constraint of following the dynamics .",
    "when @xmath170 goes to infinity the minimization is expected to produce a better and better estimate .",
    "this minimization under constraint requires the computation of an adjoint variable used to compute the gradient .",
    "hence , a gradient based descent algorithm requires numerous iterations of the direct and adjoint dynamics .    when we do not wish to precisely retrieve the initial error @xmath168 but only seek to accurately approximate the state @xmath171 `` independently '' of the possible initial error",
    ", we can avoid minimization iterations by the use of sequential estimation methods .",
    "the principle in sequential estimation methods is to introduce a modified system   denoted by a circumflex accent   called _ observer _ whose dynamics is changed to incorporate a correction based on the measured discrepancy .",
    "the new system dynamics therefore reads @xmath172 where @xmath173 is called the _ observer gain _ or _",
    "filter_. the ultimate objective of the observer @xmath174 is to converge in time to the real trajectory @xmath175 and the gain has to be designed regarding this objective .",
    "two strategies are commonly followed in this respect .",
    "first , the gain can be constructed from the optimality criterion by defining the so - called _ _ optimal observer _ _   or optimal sequential estimator   with @xmath176}(t).\\ ] ] an optimal gain is obtained by differentiating this definition with respect to the time variable @xmath56 appearing in both the trajectory @xmath177 and in the criterion @xmath178 .",
    "this approach is well - known in a linear framework ",
    "_ i.e. _ where all the operators are linear   and leads to the famous kalman - bucy filter @xcite .",
    "the optimal filter is then defined from the solution of a riccati equation . in a non - linear framework ,",
    "the gain is more intricate to compute and derives from a hamilton - jacobi - bellman solution @xcite .",
    "hence , in this case , numerous works rely on approximate solutions as defined for example by the extended kalman filter ( ekf ) which uses the riccati equation of the linear kalman filter with the tangent operator of the non - linear model and observation operators @xcite . eventually , the great advantage of the optimal sequential approach is that , like the 4d - var , it can be defined for every model and every observation operator .",
    "the biggest drawback is that   even with approximate solutions ",
    "the filter is very costly to compute , especially for large dimensional systems like the ones produced by pdes or their discretizations .",
    "therefore , alternative strategies  the luenberger observers and the reduced order optimal filtering  will be presented below .",
    "even if we will have to rely on alternative strategies , it is interesting to develop the optimal filtering equations . for the sake of simplicity",
    ", we proceed after space discretization .",
    "the space discretized system variable is denoted by @xmath179 and the space discretized parameters by @xmath180 .",
    "the observer state @xmath181 and parameters @xmath182 follow a modified version of the dynamics : @xmath183 where the gain @xmath184 is a linear operator . in the augmented form with @xmath185",
    "we write @xmath186 the most classical gain is given by the extended kalman filter ( ekf ) : @xmath187 , where @xmath188 is obtained from the solution of a riccati equation on the augmented form @xmath189 the operator @xmath188 solution of the riccati equation is called _ covariance _ since it can be linked in a stochastic framework to the covariance of the state estimation error evolving during the sequential estimation @xcite .",
    "when decomposed on the state and parameter @xmath190 this gives @xmath191 and @xmath192    the practical algorithms ",
    "for instance time - discrete ekf or ukf for unscented kalman filter   derived from this formulation are presented in  [ append : ekf - ukf ] .",
    "even if ukf differs from ekf , it is easy to prove that their analysis which relies on the linearization of their respective estimation error is based on the same error system @xcite .",
    "this is due to the fact that when all operators are assumed to be linear , a finite difference operator or the tangent operator are in fact identical .",
    "this implies that we will rely on ukf for the numerical simulation whereas , for the estimator analysis , we will keep ekf which can easily be written in both time - continuous and time - discrete formulations .",
    "various sequential estimators can be defined on any dynamical system , and parameter identification can be easily included .",
    "this is due to the underlying optimal principles behind the estimator presented before , even if in a non - linear framework we have only relied on approximation rules to extend the optimal filters found in the linear case .",
    "however , these estimators have a fundamental drawback since the covariance operator @xmath188 is a full matrix of @xmath193 . recalling that @xmath194 is the dimension of the state variables which discretize the pdes field variables , the optimal estimators are intractable for classical finite element models .",
    "a classical first strategy for circumventing the curse of dimensionality consists in assuming a specific reduced - order form for the covariance operators .",
    "for example , making the ansatz @xmath195 with @xmath196 an invertible matrix of small size @xmath197 and @xmath198 an extension operator , we can show @xcite that with linear operators the solution of the riccati equation   in augmented form reduces to @xmath199 which are now computable in practice . in a non - linear framework ,",
    "the covariance dynamics can then be approximated as in @xcite by extending as @xmath200 this observer is called _ reduced - order extended kalman filter _ ( roekf ) .",
    "the time discrete version of this approach is presented in [ append : roekf - roukf ] , as well as its ukf counterpart .",
    "another way to circumvent the curse of dimensionality is to built a filter which is not based on an underlying optimal criterion .",
    "this idea was initially introduced in @xcite and therefore is often called _ luenberger _ filter and observer .",
    "it was quickly popularized in data assimilation @xcite where the curse of dimensionality was very limiting for systems coming from the discretization of pdes . in data assimilation",
    "this strategy is also referred to as the _ nudging _ approach because the filter is designed to `` gently '' correct the dynamics .",
    "the goal of the correction is to make the estimation error @xmath201 converge to 0 . in a linear framework ,",
    "the state error dynamics is @xmath202 thus the strategy is to design a filter gain @xmath203 based on the underlying physics of the problem which makes the dynamics operator @xmath204 dissipative ",
    "strongly if possible .",
    "such luenberger filters are designed for the state estimation of specific physical systems and for specific observation operators .",
    "for instance , filters have been proposed for transport equations @xcite , schrdinger problems @xcite , for waves @xcite , beams , elasticity @xcite or fluid - structure problems @xcite . in section  [ sub :",
    "luenberger_observer ] , this approach will be used for the mechanical problem .",
    "system   has been defined from the augmented state vector gathering the original state and the parameters .",
    "after decomposition on @xmath144 and @xmath146 , this implies that the initial parameters now evolve in time within the observer @xmath205 we have seen that the optimal filter does not make any difference between state and parameters .",
    "however , when dealing with luenberger observer , there is no direct way to incorporate the parameter identification ",
    "i.e. to design @xmath206   from an already defined luengerger filter @xmath207 on the state",
    ". this problem is known as _ adaptative filtering _ @xcite . in particular in @xcite",
    "a systematic strategy has been proposed to extend a possible luengerger observer to a joint state and parameters estimation by combining the luenberger filter and an optimal filter reduced to the remaining parameter space . taking into account that the parameter space is of much smaller dimension , this strategy allows us to compute a physically - based gain on the large dimensional state and an optimal - based filter on the small parameter space .",
    "the resulting observer is proved to converge under adequate assumptions in linear cases and can be extended to non - linear cases .    when considering multi - physics coupled systems , as the electromechanical problem , the same type of problem occurs as for joint state and parameters estimation .",
    "if optimal filters are considered , there is no difficulty to combine them . when measurements are available , and when luenberger filters have also been designed for the different types of physics , it is also easy to combined them .",
    "but , as said before , optimal filters are extremely expensive , and it is not always possible to design a luenberger filter for all the physical compartments of the problem . it will be justified in section  [ sub : estimation_of_coupled_systems ] that , as done for the state and parameter estimation , it is possible for one - way coupled problems to combine a luenberger filter in one part of the system and a reduced optimal filter on the other part .",
    "the above data assimilation principles can been applied to the system modeling the cardiac electrophysiology . using a few measures of the electrical potential , the goal is to reduce the uncertainties on the state and the parameters involved in the modeling of cardiac cells . for this system ,",
    "contrary to the mechanical system that will be presented in the next section , there is no straightforward luenberger observer .",
    "the state has therefore to be filtered differently .    a possible strategy to overcome the curse of dimensionality induced by the optimal filtering is to discretize the problem on a low - dimensional basis . here",
    ", we propose to build this basis by proper orthogonal decomposition ( pod ) .",
    "the pod basis is obtained by keeping the most relevant modes resulting from a principal component analysis of a set of pre - computed solutions . for more details about pod",
    ", we refer for example to @xcite and to @xcite for applications to electrophysiology .",
    "we denote by @xmath208 the matrix made of the first @xmath209 modes .",
    "these modes are orthonormal with respect to a given scalar product , typically in @xmath210 or @xmath211 . denoting by @xmath212 the gramian matrix associated with this scalar product , the pod expansion coefficients of a vector @xmath213",
    "are given by @xmath214 .",
    "defining @xmath215 and @xmath216 , the state vector can be decomposed as @xmath217 .    as for the reduced filtering",
    ", a first strategy would consist in replacing the full order model by the reduced one : @xmath218 where @xmath219 is computed from the finite element matrices @xmath220 and the vectors @xmath221 are projected on the pod space . then , after discretization , this ( small ) system can be estimated by ekf or ukf ( [ append : ekf - ukf ] ) . in doing so , the estimator is known to be stable , but this approach has a drawback : if the pod basis is not rich enough to capture the relevant phenomena , the reduced order dynamics may be a poor approximation of the full order one .",
    "thus we may have a consistency problem in our way of modeling and approximating the system of interest .",
    "that is why we prefer another strategy which consists in solving the full order dynamics , and then applying the filter to the projection of the state vector on the pod basis .",
    "in other words , we apply roukf algorithm ( [ append : roekf - roukf ] ) with a reduced variable made of the parameters and the components of the augmented state vector on the pod basis : @xmath222 contrary to the first approach , the full model is preserved .",
    "the drawback is that it can not be proved that the part of the error which is not filtered will not grow and then pollute the approximation .",
    "thus , while the first approach could suffer from a consistency problem , the second one can suffer from a stability problem .",
    "nevertheless , in all our test cases , this second strategy proved to be robust and accurate .    by combining this strategy with ukf",
    ", the following algorithm is obtained to filter the electrical state .",
    "the initial condition projector is given by @xmath223 then we consider an adequate ukf sampling rule composed of weights and particles ( see @xcite or [ append : ekf - ukf ] ) , we store the associated weights @xmath224 in the diagonal matrix @xmath225 and precompute specific particles , here the so - called unitary sigma - points ( i.e.  with zero mean and unit covariance ) .",
    "more specifically , we consider the @xmath226 unitary simplex sigma points , where @xmath227 is the reduced space dimension @xcite . we denote them by @xmath228 and perform at each time step : a first sampling step which generates the particles identified by a subscript @xmath229}$ ] ; a prediction step denoted by an additional superscript @xmath230 and a correction step denoted instead by an additional superscript @xmath231 .",
    "[ eq : roukfstate ]    1 .",
    "sampling : @xmath232              \\hat{{x}}^{[i]+}_{\\perp n } & = \\hat{{x}}_{\\perp n}^+ + { \\mathrm{l}^{\\!\\!{\\scriptscriptstyle { x}_{\\perp}}}}_n \\cdot { c}_n \\cdot i^{i},\\quad 1\\leq i \\leq { p}\\\\[0.1 cm ]              \\hat{\\alpha}^{[i]+}_n & = \\hat{\\alpha}_n^+ + { \\mathrm{l}^{\\!\\!{\\scriptscriptstyle \\alpha}}}_n \\cdot { c}_n^\\intercal \\cdot i^{i},\\quad",
    "1\\leq i \\leq { p}\\\\[0.1 cm ]                 \\hat{{\\theta}}^{[i]+}_n & = \\hat{{\\theta}}_n^+ + { \\mathrm{l}^{\\!{\\theta}}}_n \\cdot { c}_n^\\intercal \\cdot i^{i},\\quad 1\\leq i \\leq { p}\\end{cases }      \\end{aligned}\\ ] ] 2 .   prediction : @xmath233-}_{n+1 } & = { \\mathrm{{a}}}_{n+1|n}(\\hat{{x}}^{[i]+}_{n}),\\quad 1\\leq i \\leq { p}\\\\[0.1 cm ]           \\hat{\\alpha}^{[i]-}_{n+1 } & = { \\pi}^\\intercal \\hat{{x}}^{[i]-}_{n+1},\\quad 1\\leq i \\leq { p}\\\\[0.1 cm ]          \\hat{{x}}^{[i]-}_{\\perp n+1 } & = \\hat{{x}}^{[i]-}_{n+1 } - { \\pi}\\hat{\\alpha}^{[i]-}_{n+1},\\quad 1\\leq i \\leq { p}\\\\[0.1 cm ]          \\hat{{x}}^-_{\\perp n+1 } & = \\sum_{i=1}^{{p } } \\alpha_i \\hat{{x}}_{\\perp n+1}^{[i]-}\\\\[0.1 cm ]          \\hat{\\alpha}^-_{n+1 } & = \\sum_{i=1}^{{p } } \\alpha_i \\hat{\\alpha}_{n+1}^{[i]-}\\\\[0.1 cm ]          \\hat{{\\theta}}^-_{n+1 } & = \\sum_{i=1}^{{p } } \\alpha_i \\hat{{\\theta}}_{n+1}^{[i]- }      \\end{cases }     \\end{aligned}\\ ] ] 3 .   correction : @xmath234-}]{d}_\\alpha [ i^{[*]}]^\\intercal \\\\[0.1 cm ]                      { \\mathrm{l}^{\\!\\!{\\scriptscriptstyle \\alpha}}}_{n+1 } & = [ \\hat{\\alpha}^{[*]-}_{n+1}]{d}_\\alpha [ i^{[*]}]^\\intercal \\\\[0.1 cm ]                   { \\mathrm{l}^{\\!{\\theta}}}_{n+1 } & = [ \\hat{{\\theta}}^{[*]-}_{n+1}]{d}_\\alpha [ i^{[*]}]^\\intercal \\\\[0.1 cm ]                            { z}_{n+1}^{[i]- } & = { \\mathrm{{h}}}_{n+1}(\\hat{{x}}^{[i]-}_{n+1 } ) \\\\[0.1 cm ]          { z}_{n+1}^{- } & = \\sum_{i=1}^{{p } } \\alpha_i { z}_{n+1}^{[i]- } \\\\[0.1 cm ]          { \\gamma}_{n+1 } & =   [ { z}^{[*]-}_{n+1}]{d}_\\alpha [ i^{[*]}]^\\intercal \\\\[0.1 cm ]          { \\mathrm{u}}^{n+1 } & =   { \\mathbbm{1}}+ { \\gamma}_{n+1}^\\intercal   { \\mathrm{{w}}}_{n+1}^{-1 } { \\gamma}_{n+1 } \\\\[0.1 cm ]          \\hat{{x}}^{+}_{\\perp n+1 } & = \\hat{{x}}^{-}_{\\perp n+1 } + { \\mathrm{l}^{\\!\\!{\\scriptscriptstyle { x}_{\\perp}}}}_{n+1 } { \\mathrm{{m}}}_{n+1 }   { \\gamma}_{n+1}^\\intercal { \\mathrm{{m}}}_{n+1 }   ( { z}_{n+1 } - { z}_{n+1}^{-})\\\\                          \\hat{\\alpha}_{n+1}^{+ } & = \\hat{\\alpha}_{n+1}^{- } + { \\mathrm{l}^{\\!\\!{\\scriptscriptstyle \\alpha}}}_{n+1 } { \\mathrm{u}}^{n+1 }   { \\gamma}_{n+1}^\\intercal { \\mathrm{{m}}}_{n+1 }   ( { z}_{n+1 } - { z}_{n+1}^{-})\\\\                  \\hat{{\\theta}}_{n+1}^{+ } & = \\hat{{\\theta}}_{n+1}^{- } + { \\mathrm{l}^{\\!{\\theta}}}_{n+1 } { \\mathrm{u}}^{n+1 }   { \\gamma}_{n+1}^\\intercal { \\mathrm{{m}}}_{n+1 }   ( { z}_{n+1 } - { z}_{n+1}^{- } )      \\end{cases }     \\end{aligned}\\ ] ]    where @xmath235}]$ ] is the matrix concatenating the @xmath236 vectors side by side , and similarly for other vectors @xcite . from the last three corrections defined in , the state correction reads @xmath237      to filter the mechanical state , a luenberger approach is used , following @xcite .",
    "consider the first two equations of with @xmath238 where the observations are given by @xmath239 we then define the estimator by @xmath240 where @xmath241 is a scalar gain and @xmath242 is an extension operator typically given for any displacement field @xmath243 by @xmath244 with @xmath245 the elasticity tensor coming from the linearization of @xmath246 around @xmath247 or a given trajectory at a given time @xmath56 . on a linearized system , it can be proved that the the state error @xmath248 between the estimator and the target tends to zero @xcite .",
    "a consistent space discretization is given by @xmath249 which converges to the real trajectory .",
    "note that the proof of convergence after discretization is in general difficult and should be proved here using the internal viscosity to control the spurious high frequencies introduced by the discretization .    finally in a state - space form",
    ", there exists a luenberger filter @xmath250 such that @xmath251 which converges for any initial error to an observed trajectory .",
    "this luenberger filter , defined in the context of passive non - linear mechanics , was also shown to be robust to the introduction of the active part in the cardiac mechanics @xcite . in this context",
    ", the luenberger filter can be considered as a filter on the reduced space of the displacement and velocity field whereas the internal variables associated with the heart contraction are already stable .",
    "nevertheless , note that the filter robustness has been demonstrated numerically but remains to be proved theoretically .      in this section we present an original strategy to aggregate the already defined filters of each submodel   namely the electrophysiological model and the mechanical model .",
    "this strategy is then justified by an estimation error analysis . to simplify the presentation and analysis of our method , we first consider the following _ one way _ coupling system with perfectly known parameters . indeed ,",
    "we have already seen how a joint state and parameter estimation can be added `` in a second stage '' once the state estimation is proved to be effective .",
    "hence in practice the parameter identification will be considered but here , we can focus on the state as the main difficult aspect of the analysis .",
    "we thus consider @xmath252 and we propose to combine the luenberger state filter on the mechanical part and the reduced order filter of section  [ sub : state_estimation_in_electrophysiology ] on the electrical part .",
    "we also recall that the observation operator is composed of two concatenated operators @xmath253 and @xmath254 as defined in .",
    "we can consider a roekf without loss by generality at the time - continuous level . concerning the derivatives , we denote @xmath255 and @xmath256 respectively the partial differential with respect to @xmath257 and @xmath107 respectively , whereas we keep @xmath258 when there is no ambiguity or when the differential is total ",
    "_ i.e. _ with respect to all variables . from the general reduced order formulation of the ekf presented in section  [ sub : reduced_order_optimal_filters ] we introduce this time @xmath259 such that @xmath260 note that in the dynamics the luenberger filter only applies on the mechanical part using only the mechanical data",
    ". however , the optimal filter strategy allows to benefit from both the electrical and mechanical data to correct the electrophysiology dynamics .",
    "this correction is then reverberated to the mechanical dynamics which also reads @xmath261 when assuming @xmath262 invertible .",
    "note that in the particular case where @xmath263 is linear the last expression simplifies into @xmath264[1pt]{({\\mathrm{l}}^{\\mathrm e})^{-1 } \\hat{{x}}^{\\mathrm e}}^{\\bm \\cdot } , \\ ] ]      to ensure the convergence of the observer , @xmath262 is assumed to be invertible .",
    "note that @xmath262 follows the tangent dynamics of the electrophysiological around the estimated trajectory of the model , starting from the initial condition @xmath265 . therefore , even for a dissipative system",
    ", we can assume @xmath262 to be invertible but potentially ill - conditioned .",
    "moreover the invertibility of @xmath262 can also be verified numerically in the specific case of concern .",
    "we recall that we denote by @xmath266 the estimation error .",
    "the variable @xmath267 follows a non - linear dynamics .",
    "then by linearization of this dynamics around the target trajectory we get a linear dynamics satisfied by linearized estimation error denoted by @xmath268 .",
    "in fact we have @xmath269 here we introduce the change of variables @xmath270 and obtain @xmath271 the first equation corresponds to the dynamics of the linearized error studied for the mechanical system .",
    "hence it converges to 0 .",
    "therefore the second term in the second equation tends to 0 .",
    "the homogeneous part of the second equation can then be proved to converge to 0 if the following observability condition is satisfied with our linear observation operator ",
    "namely , @xmath272 in our particular example .",
    "namely we expect for all initial error @xmath273 that @xmath274 which can be at least verified numerically . in the last observability condition",
    "we see that @xmath275 represents the effect of a variation on @xmath276 on both the electrophysiology and the mechanics .",
    "this effect is then observed through @xmath277 .",
    "the observability is thus expected to be improved with respect to the situation where only the electrophysiology is considered .",
    "this will be confirmed numerically .",
    "( masterroukf ) master + roukf + ( sampling ) ; ( master ) @xmath278 $ ] + particle + solver ; ( mechanics ) @xmath279 $ ] + particle + solver ; ( electric ) @xmath280 $ ] + particle + solver ;    ( masterroukf.south ) ",
    "node[name = firstsend ] @xmath281+}_{n},\\hat{{\\theta}}^{[i]+}_{n}$ ] ( master.north ) ; ( masterroukf.south )  node[name = firstsend ] @xmath282+}_{n},\\hat{{\\theta}}^{[{p}]+}_{n}$ ] ( mechanics.north ) ; ( masterroukf.south )  node[name = firstsend , above ] @xmath283+}_{n},\\hat{{\\theta}}^{[1]+}_{n}$ ] ( electric.90 ) ; ( masterroukf2 ) master + roukf + ( correction ) ; ( master.south )  node[name = firstsend ] @xmath281-}_{n+1},\\hat{{\\theta}}^{[i]-}_{n+1}$ ] ( masterroukf2.north ) ; ( mechanics.south )  node[name = firstsend ] @xmath282-}_{n+1},\\hat{{\\theta}}^{[{p}]-}_{n+1}$ ] ( masterroukf2.north ) ; ( electric.south )  node[name = firstsend , below ] @xmath283-}_{n+1},\\hat{{\\theta}}^{[1]-}_{n+1}$ ] ( masterroukf2.north ) ;    the correction steps of algorithms   ( for mechanics ) and   ( for electrophysiology ) are independent of the problem , and can thus be implemented by adopting again a master - slave strategy . in our electromechanical simulator , this yields a two - level interweaved master - slave strategy , the master handling the electromechanical problem becoming a slave of the sequential estimator algorithm .",
    "the tasks of the electromechanical master are the data exchange and the correction of unknowns and parameters .",
    "the estimation algorithm is summarized in figure  [ fig : masterworkersestim ] for a generic time step .",
    "the first data transmission appearing in figure  [ fig : masterworkersestim ] is done in order to update the initial value for each solver .",
    "this is handled by the electromechanical master .",
    "in this section , the methodology presented in section  [ sub : state_estimation_in_electrophysiology ] is applied to the electrophysiological problem of section  [ sub : electrophysiology ] .",
    "the purpose is twofold : first , assess the reduced order state filtering based on pod ; second , illustrate the interest of estimating simultaneaously the state and the parameters .",
    "all the test cases of this section are performed on the geometry of figure  [ fig : meshes ] , including the fibers in the conductivity tensors , and with the parameters typically used to generate healthy ecg @xcite .",
    "synthetic data are generated by applying in an external current @xmath284 during @xmath285 .",
    "two sets of measurements are considered : ( 1 ) 12-lead ecg only or ( 2 ) 12-lead ecg enriched with the extra - cellular potential at 8 epicardium points .",
    "the first set of measurements is of course the easiest to obtain .",
    "the rationale for the second set is to foresee what could be the benefit of including the measurements available from cardiac stimulators or implantable defibrillators . for both cases ,",
    "these measurements are perturbed by an additive gaussian white noise of standard deviation of @xmath286 ( figure  [ fig : obsnoise ] ) .",
    "note that another option could be to include endocardial extracellular potentials , if a catheter can provide them .",
    "we do not anticipate significant differences with respect to the results obtained with epicardial measurements .      before addressing parameter estimations",
    ", a first test is run to assess the reduced order state filter , assuming that all parameters are perfectly known ",
    "for instance with @xmath287 and @xmath288 .",
    "in other words , we study the problem of the state estimation alone applied only tp the electrophysiological model .",
    "the pod basis used in the reduced order state filter was obtained , in this case , from snapshots generated with these parameters , among others .",
    "we choose to run the estimation simulation without any external current and compare it with the target simulation starting from @xmath289 .",
    "when the estimation starts , the state variables are therefore significantly perturbed with respect to the direct simulation used to generate the synthetic data . in doing so",
    ", we introduce a significant state error in our estimation problem .",
    "figure  [ fig : vm_estimation ] compares the estimated mean value of the transmembrane potential @xmath9 and the ionic variable @xmath14 with the target values , while figure  [ fig : vmdistrib ] compares the spatial distributions over the whole heart domain .",
    "we see that , despite the very large initial error , the estimator succeeds quite well in compensating for the lack of information about the initial stimulation and retrieving in time the accurate electrical state .",
    "indeed , it is remarkable that with a correction only coming from the reduced state filter and applied from @xmath290 , the resulting estimated transmembrane potential and ionic current are in good agreement with their target values . eventually , we point out that , as expected , adding a few measurements on the myocardium slightly improves the result . however",
    "this type of measurement clearly requires an invasive procedure @xcite .",
    ".set of parameters used to build the pod basis . [ cols=\">,^,^,^,^\",options=\"header \" , ]         in conclusion , this last example is a rich illustration of our sequential strategy , with a state filter based on a luenberger approach for the mechanics and on a reduced order optimal filter for the electrophysiology and the parameters . in particular",
    "it allows us to numerically justify the importance of having a correction for every type of uncertainties , especially for state uncertainties .",
    "moreover we numerically demonstrate the interest of taking advantage of the multi - physics nature of a problem to identify some parameters   here",
    "@xmath27 accounting for the plateau duration   which have an impact on the coupled physics",
    "in this work , a complete framework for the joint state and parameter estimation of a complex multi - physics problem has been presented .",
    "the strategy consists of luenberger observers and reduced order optimal observers .",
    "the robustness of the approach is ensured by the fact that each component of this system is corrected by the data . in particular , the importance of state estimation when performing",
    "a parameter identification has been illustrated .",
    "for weakly coupled systems we have justified that our filter combination and aggregation lead to a reduction of the estimation error .",
    "it is expected that the same type of results could be proved for fully coupled problems in the future .",
    "this general strategy has been applied to an electromechanical model of the heart but other coupled systems of interest in various fields of application can be estimated with this approach . in this framework , we have also shown that the use of mechanical data could considerably improve the observability of the problem .",
    "the direct electromechanical model is clearly more demanding than the direct electrophysiology model .",
    "however , we have shown that the associated inverse problem which consists in identifying its parameters from all the available data   mechanical and electrical   is better defined than the pure electrophysiology inverse problem .    in conclusion , this work provides a promising new strategy to address the classical inverse problem of electrocardiography , and suggests a new way to reduce its well - known ill - posedness .",
    "the numerical results , based on synthetic data , are presented primarily to validate the methodology .",
    "this validation being successfully achieved , an important issue to be addressed in future works concerns the adequacy and accuracy of the models .",
    "another important perspective is the validation against real data .",
    "using real data will necessitate a complete patient workflow where anatomical data , ecg and tagged - mri ( or at least cine - mri based on the results of @xcite ) are acquired and post - processed . in this respect ,",
    "we point out that our strategy is indeed quite demanding in term of data acquisition and processing .",
    "this must be ultimately compared   in term of estimation robustness and accuracy versus difficulty  to existing methods such as electrocardiographic imaging ( ecgi ) @xcite where only ecg - like measurements are necessary with special vests recording up to 224 body - surface potentials .",
    "the authors would like to thank the anonymous reviewers for their valuable comments and suggestions .",
    "the time - discretization of the optimal estimator presented in section  [ sub : the_extended_kalman_filter ] is based on the principle that the optimality should be conserved at the discrete level .",
    "let us first denote a stable and consistent discretization of the original model by @xmath291 and define a discrete - time functional @xmath292})\\rvert}_{{m}_k}^2\\ ] ] with @xmath293 when a fixed time - step is considered .",
    "this choice of discrete observation norm @xmath294 ensures that the discrete - time functional @xmath295 is consistent with respect to the continuous - time functional @xmath169 .",
    "the discrete - time optimal filter is then defined by @xmath296}$ ] .",
    "the discrete - time counterpart of for the optimal linear estimator can be deduced with a prediction - correction time scheme .",
    "we denote by a superscript @xmath297 the prediction computations and by a superscript @xmath298 the correction computations .",
    "[ eq : kalmandiscrete ]    1 .",
    "prediction : @xmath299 2 .",
    "correction : @xmath300    this algorithm can be interpreted as prediction - correction time discretization of .    another way to propose an efficient estimator is to replace at the time - discrete level the tangent operators by a finite difference interpolation based on the computation of the original operator on numerous sampling points .",
    "this is the case for ensemble kalman filter ( enkf ) @xcite or the unscented kalman filter ( ukf ) @xcite . in this article",
    "we focus on the second one which is a discrete - time estimator based on sampling particles called _ sigma - points _ helping to replace the tangent computations .",
    "let us introduce the so - called _ unitary sampling points _",
    "@xmath301}$ ] and weight @xmath302 with the following rules @xmath303 } = 0 , \\quad          \\sum_{i=1}^{{p } } \\alpha_i i^{[i ] } \\cdot   { i^{[i]}}^\\intercal = { \\mathbbm{1}},\\ ] ] so that , at each time step , the sigma - points can be generated around the estimated values based on the covariance estimation by    [ eq : ukfdiscrete ] @xmath304 + } \\\\",
    "\\hat{{\\theta}}_{n+1}^{[i]+ }      \\end{pmatrix } =           \\begin{pmatrix }          \\hat{{x}}_{n+1}^+ \\\\",
    "\\hat{{\\theta}}_{n+1}^+      \\end{pmatrix}+ \\sqrt{{\\mathrm{{p}}}^+_{n+1 } } i^{[i]},\\ ] ] then we compute the prediction @xmath305- } = { \\mathrm{{a}}}_{n+1|n}(\\hat{{x}}_{n}^{[i]+},\\hat{{\\theta}}_{n}^{[i]+ } ) , \\quad & \\hat{{x}}_{n+1}^- = \\sum_{i=1}^{{p } } \\alpha_i \\hat{{x}}_{n+1}^{[i]- } , \\\\",
    "\\hat{{\\theta}}_{n+1}^{[i]- } \\,\\ , = \\hat{{\\theta}}_{n}^{[i]+ } , \\quad & \\hat{{\\theta}}_{n+1}^- = \\sum_{i=1}^{{p } } \\alpha_i \\hat{{\\theta}}_{n+1}^{[i]- } = \\hat{{\\theta}}_{n}^+ ,      \\end{cases}\\ ] ] and the corresponding observations @xmath306- } = { \\mathrm{{h}}}(\\hat{{x}}_{n+1}^{[i]-}),\\quad   \\hat{{z}}_{n+1}^{- } = \\sum_{i=1}^{{p } } \\alpha_i \\hat{{z}}_{n+1}^{[i]}.\\ ] ] the gain is then defined by @xmath307-}-\\hat{{x}}_{n+1}^-)(\\hat{{z}}_{n+1}^{[i]-}-\\hat{{z}}_{n+1}^{-})^\\intercal,\\\\          { \\mathrm{{p}}^{{\\scriptscriptstyle { \\theta}\\ ! { z}}}}_{n+1 } = \\sum_{i=1}^{{p } } \\alpha_i(\\hat{{\\theta}}_{n+1}^{[i]-}-\\hat{{\\theta}}_{n+1}^-)(\\hat{{z}}_{n+1}^{[i]-}-\\hat{{z}}_{n+1}^{-})^\\intercal , \\\\",
    "{ \\mathrm{{p}}^{{\\scriptscriptstyle { z}\\ ! { z}}}}_{n+1 } = \\sum_{i=1}^{{p } } \\alpha_i(\\hat{{z}}_{n+1}^{[i]-}-\\hat{{z}}_{n+1}^{-})(\\hat{{z}}_{n+1}^{[i]-}-\\hat{{z}}_{n+1}^{-})^\\intercal + { m}_{n+1}^{-1 } , \\\\          { \\mathrm{{g}}^{\\!{\\scriptscriptstyle{x}}}}_{n+1 } = ( { \\mathrm{{p}}^{{\\scriptscriptstyle { x}\\ ! { z}}}}_{n+1 } ) \\cdot ( { \\mathrm{{p}}^{{\\scriptscriptstyle { z}\\ ! { z}}}}_{n+1})^{-1},\\\\          { \\mathrm{{g}}^{{\\theta}}}_{n+1}=({\\mathrm{{p}}^{{\\scriptscriptstyle { \\theta}\\ ! { z}}}}_{n+1 } ) \\cdot ( { \\mathrm{{p}}^{{\\scriptscriptstyle { z}\\ ! { z}}}}_{n+1})^{-1 } \\end{cases}\\ ] ] so that , with the covariance @xmath308- } \\\\ \\hat{{\\theta}}_{n+1}^{[i]- }      \\end{pmatrix } \\begin{pmatrix }          \\hat{{x}}_{n+1}^{[i]- }",
    "\\\\ \\hat{{\\theta}}_{n+1}^{[i]- }      \\end{pmatrix}^\\intercal , \\quad { { } ^{\\flat\\!}}{\\mathrm{{p}}^{{\\scriptscriptstyle { x}\\ ! { z}}}}_{n+1 } = \\begin{pmatrix }           { \\mathrm{{p}}^{{\\scriptscriptstyle { x}\\ ! { z}}}}_{n+1 } \\\\",
    "{ \\mathrm{{p}}^{{\\scriptscriptstyle { \\theta}\\ ! { z}}}}_{n+1 }      \\end{pmatrix},\\ ] ] we still have @xmath309    this filter has the great advantage to be much easier to compute numerically since , contrary to ekf , the tangent operators computations are no longer required .",
    "the reduced - order filtering concept presented in section  [ sub : reduced_order_optimal_filters ] can be directly applied to the time and space discretized versions of the equations , leading to a time - discrete roekf :    [ eq : rokalmandiscrete ]    1 .",
    "prediction : @xmath310 2 .",
    "correction : @xmath311    this algorithm has been applied in @xcite for parameter identification by reducing the uncertainty space to the parameter space .",
    "indeed , the extension @xmath198 is initially decomposed into @xmath312 using the fact that the parameters dynamics is null , we can easily proved that @xmath313 then , by direct computation , we have the continuous - time formulation of the roekf in a parameter identification context @xmath314 in  , we see that the filter correction appears in the parameters dynamics .",
    "then , the correction on the parameters is reverberated to the state by the mean of @xmath315 which can be interpreted from its proper dynamics as the sensitivity of the model with respect to the parameters . therefore even for a reduced order strategy on the parameters the global filter corrects the two components of the model , namely the parameters but also the state .",
    "the same principles can be applied after the time discretization of the model to get    [ eq : paramroekfdiscrete ]    1 .",
    "prediction : @xmath316 2 .",
    "correction : @xmath317    starting from the same initial conditions .",
    "we have presented the reduced order ekf and have recalled its convergence .",
    "now a legitimate question is to know if a reduced order strategy can be applied to other types of approximation of the optimal filtering approach .",
    "the answer was given for the ukf filter in @xcite where a reduced order version ( roukf ) was derived .",
    "moreover it was also applied to a specific case where the initial uncertainty is reduced to the parametric space . in the general context   _",
    "i.e. _ without particularizing the state and parameter dependency",
    "  the roukf can be formulated as follow .",
    "given an adequate sampling rule , we store the corresponding weights @xmath224 in the diagonal matrix @xmath225 and precompute specific unitary simplex sigma - points @xmath228 ( i.e.  with zero mean and unit covariance ) with @xmath318 since the reduced space corresponds here to the parametric space .",
    "the algorithm consists of the following three steps computed recursively :    [ eq : roukf ]    1 .",
    "sampling : @xmath319              \\hat{{x}}^{[i]+}_{n } & = \\hat{{x}}_{n}^+ + { \\mathrm{l}^{\\!\\!{\\scriptscriptstyle { x}}}}_n \\cdot { c}_n^\\intercal \\cdot i^{i},\\quad 1\\leq i \\leq { p}\\\\[0.1 cm ]                          \\hat{{\\theta}}^{[i]+}_{n } & = \\hat{{\\theta}}_{n}^+ + { \\mathrm{l}^{\\!{\\theta}}}_n \\cdot { c}_n^\\intercal \\cdot i^{i},\\quad 1\\leq i \\leq { p}\\\\[0.1 cm ]          \\end{cases }      \\end{aligned}\\ ] ] 2 .",
    "prediction : @xmath320-}_{n+1 } & = { \\mathrm{{a}}}_{n+1|n}(\\hat{{x}}^{[i]+}_{n},\\hat{{\\theta}}^{[i]+}_{n}),\\quad 1\\leq i \\leq { p}\\\\[0.1 cm ]           \\hat{{\\theta}}^{[i]-}_{n+1 } & = \\hat{{\\theta}}^{[i]+}_{n},\\quad 1\\leq i \\leq { p}\\\\[0.1 cm ]           \\hat{{x}}^-_{n+1 } & = \\sum_{i=1}^{{p } } \\alpha_i \\hat{{x}}_{n+1}^{[i]-}\\\\[0.1 cm ]          \\hat{{\\theta}}^-_{n+1 } & = \\sum_{i=1}^{{p } } \\alpha_i \\hat{{\\theta}}_{n+1}^{[i]-}\\\\[0.1 cm ]      \\end{cases }     \\end{aligned}\\ ] ] 3 .",
    "correction : @xmath321-}_{n+1}]{d}_\\alpha [ i^{[*]}]^\\intercal \\\\[0.1 cm ]            { \\mathrm{l}^{\\!{\\theta}}}_{n+1 } & = [ \\hat{{\\theta}}^{[*]-}_{n+1}]{d}_\\alpha [ i^{[*]}]^\\intercal \\\\[0.1 cm ]                        { z}_{n+1}^{[i]- } & = { \\mathrm{{h}}}_{n+1}(\\hat{{x}}^{[i]-}_{n+1 } ) \\\\[0.1 cm ]          { z}_{n+1}^{- } & = \\sum_{i=1}^{{p } } \\alpha_i { z}_{n+1}^{[i]- } \\\\[0.1 cm ]          { \\gamma}_{n+1 } & =   [ { z}^{[*]-}_{n+1}]{d}_\\alpha [ i^{[*]}]^\\intercal \\\\[0.1 cm ]          { \\mathrm{u}}_{n+1 } & =   { \\mathbbm{1}}+ { \\gamma}_{n+1}^\\intercal   { \\mathrm{{m}}}_{n+1 } { \\gamma}_{n+1 } \\\\[0.1 cm ]          \\hat{{x}}_{n+1}^{+ } & = \\hat{{x}}_{n+1}^{- } + { \\mathrm{l}^{\\!\\!{\\scriptscriptstyle { x}}}}_{n+1 } { \\mathrm{u}}_{n+1}^{-1 } { \\gamma}_{n+1}^\\intercal { \\mathrm{{m}}}_{n+1 }   ( { z}_{n+1 } - { z}_{n+1}^{-})\\\\[0.1 cm ] \\hat{{\\theta}}_{n+1}^{+ } & = \\hat{{\\theta}}_{n+1}^{- } + { \\mathrm{l}^{\\!{\\theta}}}_{n+1 } { \\mathrm{u}}_{n+1}^{-1 }   { \\gamma}_{n+1}^\\intercal { \\mathrm{{m}}}_{n+1 }   ( { z}_{n+1 } - { z}_{n+1}^{- } )               \\end{cases }     \\end{aligned}\\ ] ]    where @xmath235}]$ ] is the matrix concatenating the @xmath236 vectors side by side , and similarly for other vectors .    the analysis of this estimator can also be found in @xcite and relies again on the fact that the linearized error satisfies exactly the same dynamics as the linearized error of the roekf .",
    "therefore the demonstration by linearization is directly obtained .",
    "the combined practical simplicity and efficiency of such parameter estimator in comparison to other adaptive observers have made this approach popular for real case parameter estimation problems @xcite .",
    "10                  j.  blum , f .- x .",
    "le  dimet , and i.  m. navon .",
    "data assimilation for geophysical fluids . in r.",
    "temam and j.  tribbia , editors , _ handbook of numerical analysis : computational methods for the atmosphere and the oceans_. elsevier , 2008 .",
    "p.  colli franzone and g.  savar .",
    "degenerate evolution systems modeling the cardiac electric field at micro- and macroscopic level . evolution equations , semigroups and functional analysis . , 1(50):4978 , 2002 .",
    "m.  delia , l.  mirabella , t.  passerini , m.  perego , m.  piccinelli , c.  vergara , and a.  veneziani .",
    "applications of variational data assimilation in computational hemodynamics . in d.",
    "ambrosi , a.  quarteroni , and g.  rozza , editors , _ modeling of physiological flows _ , volume  5 of _ ms&a",
    " modeling , simulation and applications _ , pages 363394 .",
    "springer milan , 2012 .",
    "m.  eldar , d.g .",
    "ohad , j.j .",
    "goldberger , z.  rotstein , s.  hsu , d.k .",
    "swanson , and a.j .",
    "transcutaneous multielectrode basket catheter for endocardial mapping and ablation of ventricular tachycardia in the pig .",
    ", 96(7):24302437 , 1997 .",
    "a.  krishnamurthy , c.t .",
    "villongco , j.  chuang , l.r .",
    "frank , v.  nigam , e.  belezzuoli , p.  stark , d.e .",
    "krummen , s.  narayan , j.h .",
    "omens , a.d .",
    "mcculloch , and r.c.p kerckhoffs .",
    "patient - specific models of cardiac biomechanics . , 244:421 , 2013 .",
    "z.  liu , c.  liu , and b.  he .",
    "noninvasive reconstruction of three - dimensional ventricular activation sequence from the inverse solution of distributed equivalent current density .",
    ", 25(10):13071318 , 2006 .",
    "s.  marchesseau , h.  delingette , m.  sermesant , r.  cabrera - lozoya , c.  tobon - gomez , p.  moireau , r.m .",
    "figueras i  ventura , k.  lekadir , a.  hernandez , m.  garreau , e.  donal , c.  leclercq , s.g .",
    "duckett , k.  rhode , c.a .",
    "rinaldi , a.f .",
    "frangi , r.  razavi , d.  chapelle , and n.  ayache . . , 2013",
    "b.  messnarz , m.  seger , r.  modre , g.  fischer , f.  hanser , and b.  tilg . a comparison of noninvasive reconstruction of epicardial versus transmembrane potentials in consideration of the null space .",
    ", 51(9):16091618 , 2004 .",
    "d.  m mirvis , f.w .",
    "keller , r.e .",
    "ideker , j.w .",
    "cox , r.f .",
    "dowdie , and d.g .",
    "detection and localization of multiple epicardial electrical generators by a two - dipole ranging technique .",
    ", 41(4):551557 , 1977 .",
    "p.  moireau , c.  bertoglio , n.  xiao , c.a .",
    "figueroa , c.a .",
    "taylor , d.  chapelle , and j .- f .",
    "sequential identification of boundary support parameters in a fluid - structure vascular model using patient image data .",
    ", 12(3):475496 , 2013 .",
    "nielsen , o.m .",
    "lysaker , c.  tarrou , j.  sundnes , x.  cai , and k .- a .",
    "mardal . on the use of the bidomain equations for computing the transmembrane potential throughout the heart wall : an inverse problem . in a.",
    "murray , editor , _ computers in cardiology 2006 _ , pages 797800 .",
    "computers in cardiology , 2006 .",
    "issn 0276 - 6547 .",
    "m.  potse , b.  dub , j.  richer , a.  vinet , and r.  m. gulrajani . a comparison of monodomain and bidomain reaction - diffusion models for action potential propagation in the human heart .",
    ", 53(12):24252435 , 2006 .",
    "rincon , m.  bendahmane , and b.  ainseba .",
    "computing the electrical activity of the heart with a dynamic inverse monodomain operator . in _ engineering in medicine and biology society ( embc ) , 2013 35th annual international conference of the ieee _ , pages 37973800 .",
    "ieee , 2013 ."
  ],
  "abstract_text": [
    "<S> this work addresses the inverse problem of electrocardiography from a new perspective , by combining electrical and mechanical measurements . </S>",
    "<S> our strategy relies on the definition of a model of the electromechanical contraction which is registered on ecg data but also on measured mechanical displacements of the heart tissue typically extracted from medical images . in this respect </S>",
    "<S> , we establish in this work the convergence of a sequential estimator which combines for such coupled problems various state of the art sequential data assimilation methods in a unified consistent and efficient framework . </S>",
    "<S> indeed we aggregate a luenberger observer for the mechanical state and a reduced order unscented kalman filter applied on the parameters to be identified and a pod projection of the electrical state . then using synthetic data we show the benefits of our approach for the estimation of the electrical state of the ventricles along the heart beat compared with more classical strategies which only consider an electrophysiological model with ecg measurements . </S>",
    "<S> our numerical results actually show that the mechanical measurements improve the identifiability of the electrical problem allowing to reconstruct the electrical state of the coupled system more precisely . </S>",
    "<S> therefore , this work is intended to be a first proof of concept , with theoretical justifications and numerical investigations , of the advantage of using available multi - modal observations for the estimation and identification of an electromechanical model of the heart . </S>"
  ]
}