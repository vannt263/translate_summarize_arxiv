{
  "article_text": [
    "in the recent years there has been a huge amount of work done on phylogenetic varieties  we advise the reader to consult e.g.  @xcite and references therein .",
    "these algebraic varieties contain the set of joint distributions at the leaves of a tree evolving under a markov model of molecular evolution . from the biological point of view , these varieties are interesting because they provide new tools of non - parametric inference of phylogenetic trees . at present",
    ", the algebraic / geometric framework of phylogenetic varieties has allowed proving the identifiability of parameters of certain evolutionary models widely used by biologists @xcite , proposing new methods of model selection @xcite , and producing new phylogenetic reconstruction methods @xcite .    from the mathematical point of view , there has been a great effort in finding a whole description of the ideal of these phylogenetic varieties @xcite .",
    "still , for some models , many questions remain open for trees on an arbitrary number of leaves @xmath2 . indeed ,",
    "if one is interested in using these algebraic tools with real data , one would need a small set of generators of the ideal ( rather than a description of the whole ideal ) ; it would also be desirable to know the degree at which the ideal is generated @xcite ; and as the codimension of the variety is exponential in @xmath2 , it is necessary to distinguish between generators that only account for the underlying evolutionary model , those that account for the tree topology , and those that could be useful for inferring the numerical parameters ( see @xcite for a good introduction to this topic ) .",
    "for instance , the authors of @xcite and @xcite raised the question whether knowing complete intersection containing the phylogenetic variety and of the same dimension would be enough .",
    "eminently , for biological applications it is only relevant to know the description of the variety around the points that make sense _ biologically _ speaking .",
    "if these points are smooth , then a complete intersection can define the variety on a neighborhood of these points .",
    "this is the approach that was considered in @xcite for the particular model of kimura 3-parameter and is the same goal that we pursued in @xcite for abelian group - based models . in the present paper",
    "we address this problem for the more general class of _ g - equivariant models _ , which contains more general algebraic models of interest to biologists ( for example the strand - symmetric and the general markov models ) .",
    "we give an explicit algorithm to construct a complete intersection that describes the variety on a dense open subset around a generic _ point of no evolution_. points of no evolution represent molecular sequences that remain invariant from the common ancestor to the leaves of the tree .",
    "points in the phylogenetic variety that arise from biologically meaningful parameters are supposed to be near these points of no evolution ( otherwise phylogenetic inference could not be made ) , and therefore it is important to study the variety around these points .",
    "also , as we describe the variety at a dense open subset containing these points , we cover most ( actually , all but possibly a subset of smaller dimension ) of the biologically meaningful points of the variety . also , in the same papers mentioned above , it is argued that a complete intersection can contain points in other irreducible components that can mislead the results in practice .",
    "however , the complete intersection we give contains a regular sequence of the edge invariants , which are known to be phylogenetic invariants @xcite .",
    "therefore , the other irreducible components of the complete intersection do not contain other phylogenetic varieties .",
    "we prove first that these points are non - singular and therefore the variety can be described locally at these points by the smallest possible number of equations , the codimension of the variety .",
    "a system of generators of the local complete intersection can be explicitly computed .",
    "the degree of these generators is low and depends on a local description of claw trees related to the interior nodes of the tree and of the multiplicities of the permutation representation of the group @xmath3 .",
    "for example , for the biologically interesting models mentioned above , the complete intersection we provide has generators of degree at most 13 .",
    "one should contrast this to the generators of the complete intersection given in @xcite for the kimura 3-parameter model , which had exponential degree in the number of leaves .",
    "our approach is also useful in case one wants to use differential geometry for this variety ( for example to compute the distance of a point to this variety , @xcite ) .",
    "the description of the ideal of phylogenetic invariants for @xmath4-equivariant models was provided by draisma and kuttler @xcite .",
    "there are two ways to obtain the whole ideal of phylogenetic invariants for a given tree , assuming the ideals for star trees are known .",
    "the first description relies on the ideals of star trees associated to inner vertices of a given tree - so - called flattenings .",
    "the second description is inductive , where we regard a big tree as a join of two smaller trees .",
    "our approach is based on the second method .",
    "we start by inducing phylogenetic invariants from smaller trees .",
    "the induced phylogenetic invariants are of course not enough to provide a description for the larger tree .",
    "we complement them by so - called thin flattenings @xcite .",
    "they are very explicit , however still numerous .",
    "it turns out that the choice of leaves in smaller trees distinguishes specific thin flattenings .",
    "combining those with induced invariants yields our main result : under a minor assumption on claw trees ( see [ assumption ] ) which is satisfied by the tripod on the most popular equivariant models ( jukes - cantor , kimura 3st , strand symmetric ) and also by the general markov model , we provide an explicit local description of the variety associated to a model and a tree ( see theorem  [ invariantsci ] ) .",
    "moreover , both in the starting point and in the induction process , the choices we make are almost canonical so that the complete intersection we produce is a natural one and could be reasonably used in practice .",
    "the methods used in this paper rely on basic algebraic geometry and group representation theory .",
    "it is important to note that the results of the paper hold for any @xmath4-equivariant model , @xmath3 , for any @xmath1 , and therefore representation theory has been the necessary tool to deal with all these models at the same time . on the other hand",
    ", our results also hold for trees with any number of leaves and any degrees at the interior nodes .",
    "the approach adopted to prove the main result [ invariantsci ] also produces a computationally effective list of elements in the ideal of the phylogenetic variety .",
    "indeed , the list of equations provided in theorem [ invariantsci ] for a tree @xmath0 with @xmath2 leaves is constructed from equations describing locally the phylogenetic varieties of claw trees of the interior nodes of @xmath0 and from certain minors of the thin flattenings mentioned above .",
    "the number of equations from the thin flattenings grows exponentially with @xmath2 , but the number of equations corresponding to claw trees does not ( it grows exponentially with the maximum degree of an interior node of @xmath0 , see remarks [ rem_nab ] and [ rem_notexpon ] ) .",
    "however , evaluating the minors of the thin flattenings is not the optimal way of evaluating the rank of a matrix and these equations could therefore be substituted by a numerical method such as the singular value decomposition ( see @xcite ) .",
    "the remaining equations form a set that can be useful in practice , for example for the estimation of the parameters that maximize the likelihood via lagrange multipliers ( see the tools used in @xcite and @xcite ) .",
    "the structure of the paper is as follows . in the following section 2",
    ", we recall the background on linear representation theory of finite groups that is needed in the sequel . in section 3",
    ", we recall the definition of equivariant models and of phylogenetic varieties . in this section",
    "we prove as well two key results that shall allow us to provide a complete intersection as desired : first we compute the dimension of the phylogenetic varieties for any equivariant model @xmath5 , @xmath6 , and any tree @xmath0 , and then we prove that these varieties are smooth at generic points of no evolution .",
    "then in section 4 we describe the set of equations that shall be used to prove our main result . the setup for this description",
    "is conceived towards the induction steps that are needed in the proof of the main result . in section 5",
    "we describe the induction step and the `` claw tree hypotheses '' needed to prove our main result , theorem [ invariantsci ] in the largest generality .",
    "the proof of this theorem is constructive and provides an algorithm for obtaining the desired complete intersection assuming the claw tree hypotheses is satisfied . in section 6",
    "we prove that this claw tree hypothesis holds for trivalent trees on the general markov model , the strand symmetric model , and the jukes - cantor model ( the kimura 3-parameter case was already considered in @xcite ) .",
    "for these models we also specify complete intersections ( following the algorithm provided in section 5 ) that describe the variety for quartet trees around generic points of no evolution .",
    "m.casanellas and j.fernndez-snchez were partially supported by spanish government mtm2012 - 38122-c03 - 01/feder and generalitat de catalunya 2014 sgr-634 .",
    "m.michaek was supported by national science center grant sonata umo-2012/05/d",
    "/ st1 /01063 .",
    "part of the work was conducted while michaek was visiting freie universitt , berlin and uc berkeley ( prime daad program 2015 - 2016 ) and crm barcelona ( epdi program 2013 ) .",
    "in this section we recall the basic concepts of representation theory that will be needed in the sequel .",
    "the reader is referred to @xcite or @xcite for details and proofs . throughout the paper we work over the field of complex numbers @xmath7 .",
    "let @xmath4 be a finite group .",
    "a _ representation _ of @xmath4 is a group homomorphism @xmath8 , where @xmath9 is a @xmath7-vector space of finite dimension .",
    "we will refer to @xmath9 as the representation itself ( or also as a @xmath4-module ) if the map @xmath10 can be understood from the context , and for @xmath11 and @xmath12 we shall denote by @xmath13 the vector @xmath14 .",
    "a @xmath4-_equivariant map _ is a linear map @xmath15 between two representations of @xmath4 that satisfies @xmath16 for all @xmath11 .",
    "the set of all @xmath4-equivariant maps between @xmath9 and @xmath17 is denoted as @xmath18 .",
    "two @xmath4-modules @xmath9 and @xmath17 are said to be _ isomorphic _ ( denoted as @xmath19 ) if there is a @xmath4-equivariant isomorphism of vector spaces @xmath20 .",
    "a representation @xmath9 is _ irreducible _ if it does not contain any proper @xmath4-invariant subspace .",
    "otherwise , @xmath9 is said to be _",
    "reducible_. we will denote by @xmath21 the subspace of vectors of @xmath9 that are @xmath4-_invariant _ under the action of @xmath4 , that is , @xmath22 for all @xmath11 .    let @xmath23 be two irreducible representations of @xmath4 .",
    "if @xmath20 is @xmath4-equivariant , then either @xmath24 or @xmath25 is an isomorphism , in which case @xmath26 .",
    "[ nota ] let @xmath27 , @xmath28 be the irreducible representations of @xmath4 ( up to isomorphism ) .",
    "we write @xmath29 for the character corresponding to @xmath30 : @xmath31 .",
    "we adopt the convention that @xmath32 refers to the _ identity _ ( or _ trivial _ ) representation .",
    "[ maschke ] if @xmath8 is a representation of @xmath4 , then there exists a unique decomposition @xmath33 $ ] , where each @xmath34 $ ] is isomorphic to @xmath35 for some _ multiplicity _ @xmath36 .",
    "we call @xmath34 $ ] the _ isotypic component _ of @xmath9 associated to @xmath30 .",
    "notice that @xmath21 is equal to the isotypic component of @xmath9 associated to the trivial representation of @xmath4 : @xmath37 $ ] .",
    "[ rem_vk ] by virtue of these fundamental results , for any representation @xmath9 of @xmath4 , the dimension of @xmath38 equals the multiplicity of @xmath30 in @xmath9 .",
    "moreover , the collection of the images of a chosen vector @xmath39 under maps in @xmath38 form a subspace @xmath40 in @xmath9 of dimension equal to the multiplicity of the isotypic component , @xmath41 .",
    "analogously to highest weight spaces , the spaces @xmath40 will represent the whole isotypic components . in particular , for any two representations @xmath42 we can identify @xmath43 with @xmath44 .    [",
    "[ permutation - representation . ] ] permutation representation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    from now on we focus on the following setting . given a finite set @xmath45 of cardinality @xmath1",
    ", we define @xmath46 as the @xmath7-vector space generated by the elements of @xmath45 . in this way",
    ", the elements of @xmath45 play the role of the standard basis of @xmath47 , so that an element @xmath48 and the corresponding vector of the standard basis shall be denoted in the same way .",
    "motivated by biology , in our examples we consider @xmath49 but our work holds for any finite set .",
    "we denote @xmath50 . by abuse of notation , @xmath51",
    "will be sometimes taken as the column - vector with all its @xmath1 coordinates equal to one .",
    "henceforth , @xmath4 shall be a permutation group of @xmath45 , that is , @xmath4 is a subgroup of @xmath52 .",
    "the restriction to @xmath4 of the _ permutation representation _ @xmath47 , given by the permutation of the elements in @xmath45 , induces a representation @xmath53 of @xmath4 on any tensor power @xmath54 by extending linearly the action @xmath55 for @xmath56 . in this paper",
    ", we will only deal with such representations @xmath57 together with the irreducible representations @xmath58 of @xmath4 .    according to masckhe s theorem",
    ", any tensor power @xmath54 will decompose into a direct sum of modules @xmath59 $ ] ( the isotypic components ) each of them being a number of copies of one of the irreducible modules @xmath30 .",
    "this number is the multiplicity of @xmath30 in @xmath60 and will be denoted by @xmath61 . in the particular case @xmath62 , explicit formulas for @xmath61 can be provided in terms of kronecker coefficients .",
    "we write @xmath63 for the vector of multiplicities of @xmath64 .",
    "as the case @xmath65 will play a special role , we simplify notation and write @xmath66 for the vector of multiplicities of @xmath47 .    from now on ,",
    "we fix subspaces @xmath67 for @xmath68 according to remark [ rem_vk ] by fixing a vector @xmath69 and taking its images by maps in @xmath70 .",
    "this vector also defines subspaces @xmath71 , which shall be considered fixed from now on .",
    "we consider the hermitian inner product in @xmath47 that makes @xmath45 into an orthonormal basis , and denote it by @xmath72 for any @xmath73 . this inner product will be used to identify @xmath47 with @xmath74 by sending a vector @xmath75 to the linear form @xmath76 that maps @xmath77 to @xmath78 .",
    "the inner product in @xmath47 induces an inner product in @xmath54 defined as @xmath79 for @xmath80 and extending it sesquilinearly .",
    "[ [ dual - representation . ] ] dual representation .",
    "+ + + + + + + + + + + + + + + + + + + +    if @xmath81 is a representation of @xmath4 with character @xmath82 , then its dual @xmath83 is also a representation via the homomorphism @xmath84 that maps @xmath85 to @xmath86 , and @xmath87 has character @xmath88 ( the conjugate of @xmath82 ) .    at the level of vector spaces",
    ", the inner product above provides an isomorphism @xmath89 .",
    "nevertheless , if @xmath9 is a representation of a group @xmath4 , then it may happen that it is not @xmath4-isomorphic to @xmath83 .",
    "this will force us to distinguish between the space and its dual in the sequel .",
    "however , the permutation representations @xmath90 that we consider in this paper satisfy @xmath91 because they have real characters . in particular , the @xmath4-isomorphism @xmath91 induces @xmath4-isomorphisms @xmath92\\cong_g   v[\\chi_k]$ ] and @xmath93 for all @xmath94 .",
    "thus , the reader may freely ignore all the dual signs in our article .",
    "we decided to keep them , as most of the arguments we provide hold without the assumption @xmath91 on a representation theoretic level .",
    "there is also a natural @xmath4-isomorphism @xmath95 which at the level of @xmath4-invariant vectors translates to @xmath96 .",
    "representation theory allows us to decompose the ambient space @xmath97 in terms of the irreducible representations of @xmath4 as follows",
    ". this decomposition will be fundamental for us and will play a key role in the paper .",
    "[ prop : w^ng ] for any @xmath98 , there is a natural isomorphism of vector spaces @xmath99 in particular , the dimension of @xmath100 is @xmath101 , where @xmath102 is the index of the irreducible representation dual to @xmath30 , that is , @xmath103 . using the language of category theory ,",
    "the functors @xmath104 and @xmath105 from the category of @xmath4 representations to the category of vector spaces are isomorphic .    applying maschke s theorem and schur s lemma , we infer @xmath106,({\\otimes}^b w)[\\chi_j ] ) \\cong   \\oplus_{k=1}^t { \\mathrm{hom}\\,}_{{\\mathbb{c } } } ( { \\mathcal{f}_{k}({\\otimes}^a w^ * ) } , { \\mathcal{f}_{k}({\\otimes}^b w ) } ) \\\\ & \\cong & \\oplus_{k=1}^t { \\mathrm{hom}\\,}_{{\\mathbb{c}}}\\left ( ( { \\mathcal{f}_{k^*}({\\otimes}^a w)})^ * , { \\mathcal{f}_{k}({\\otimes}^b w)}\\right ) \\cong \\bigoplus_{k=1}^t \\ ; { \\mathcal{f}_{k^*}(\\otimes^a w ) }   { \\otimes}{\\mathcal{f}_{k}(\\otimes^b w)}.\\end{aligned}\\ ] ]",
    "a tree is a connected finite graph without cycles , consisting of vertices and edges . given a tree @xmath0",
    ", we write @xmath107 and @xmath108 for the set of vertices and edges of @xmath0 .",
    "the _ degree _ of a vertex is the number of edges incident to it .",
    "the set @xmath107 splits into the set of leaves @xmath109 ( vertices of degree one ) and the set of interior vertices @xmath110 : @xmath111 .",
    "one says that a tree is _ trivalent _ if each vertex in @xmath110 has degree 3 .",
    "a tree topology is the topological class of a tree where every leaf has been labeled .",
    "given a subset @xmath112 of @xmath109 , the subtree induced by @xmath112 is just the smallest tree composed of the edges and vertices of @xmath0 in any path connecting two leaves in @xmath112 .",
    "a tree @xmath0 is _ rooted _ if a specific node @xmath113 is labeled as the root .    in order to model the substitution of the states in @xmath45 according to a markov process on a rooted tree @xmath0 , one has to specify a distribution @xmath114 at the root of the tree and a collection of substitution matrices @xmath115 @xcite .",
    "the set of possible root distributions and substitution matrices for a tree @xmath0 is called the _ set of parameters_. in the applications to biology , one has to restrict the set of parameters to stochastic vectors and matrices , but this restriction is unnecessary for the core of this paper .",
    "below we describe _ equivariant _ models of evolution , which include some of the most well - known models .    as above , let @xmath45 be a finite set of cardinal @xmath1 , @xmath47 be the @xmath7-vector space @xmath116 , and @xmath117 be a permutation group of @xmath45 .",
    "in this section we use the distinguished basis @xmath45 of @xmath47 to identify @xmath118 matrices with complex entries with @xmath119 .",
    "@xcite ) a rooted tree @xmath0 evolves under the _ equivariant model _",
    "@xmath120 if a @xmath4-invariant vector @xmath114 is associated to the root of @xmath0 and substitution matrices @xmath121 in @xmath122 are associated to each edge @xmath123 of @xmath0 . for the equivariant model @xmath120 , the set of _ parameters _ is @xmath124 if one wants to talk about _ stochastic parameters _ , @xmath125 one has to restrict the root distribution to @xmath126 , and the substitution matrices to @xmath127 ( and then require that all entries are real , nonnegative , but this is not relevant for our purposes ) . as a special case , if the group @xmath4 is trivial , @xmath128 , we will denote by @xmath129 and @xmath130 the corresponding spaces of parameters .",
    "the _ parametrization map _ that assigns a distribution at the leaves of @xmath0 to each set of parameters is @xmath131 defined by @xmath132 where @xmath133 @xmath134 denotes the state at the vertex @xmath75 , @xmath135 ( respectively @xmath136 ) is the parent ( respectively , child ) node of @xmath123 , and @xmath137 are the coordinates of the root distribution @xmath114 .",
    "when we restrict this map to the set of parameters @xmath138 , we denote it as @xmath139 in this case the image lies in @xmath97 .",
    "when the parametrization ( [ param ] ) is restricted to the set of stochastic parameters , we obtain @xmath140 where @xmath141 is the hyperplane defined as @xmath142 the analogous restrictions to @xmath125 are denoted as @xmath143 .",
    "the word `` stochastic '' here has a broader meaning than usually , because for our aim we only need entries summing to one and not necessarily nonnegative entries .",
    "the _ phylogenetic variety associated to a tree @xmath0 evolving under @xmath120 _ is the ( affine ) algebraic variety @xmath144 where @xmath145 represents the zariski closure of a set @xmath146 .",
    "similarly , the _ stochastic phylogenetic variety associated to a tree _ @xmath0 is the smallest algebraic variety @xmath147 containing the set @xmath148 one has @xmath149 ( see , for example , @xcite ) . in particular , the equations defining @xmath147 are the same equations defining @xmath150 plus the equation defining @xmath151 .",
    "notice that in the definition of the phylogenetic variety we have not specified the root of the tree .",
    "it is well known that different root placements give rise to the same phylogenetic variety .",
    "indeed , it is clear that a matrix @xmath152 belongs to @xmath122 if and only if so does its transpose @xmath153 .",
    "now , it can be seen that if we move the root from one node to a neighboring node and we replace the matrices @xmath121 of the edges with inverted orientation with their transpose , the image of the new parameters will remain the same .",
    "moreover , we may assume that @xmath154 when parameterizing @xmath150 since choosing an edge @xmath155 attached to the root and changing @xmath156 by @xmath157 gives rise to the same image point .",
    "hence @xmath150 does not depend on the root .",
    "as @xmath151 also does not depend on the root , neither does @xmath158 . in case",
    "we take all matrices @xmath121 equal to the identity , the image by @xmath159 represents no evolution at all .",
    "given an equivariant model @xmath120 , a point @xmath160 in @xmath161 is a _ point of no evolution _ if @xmath162 and @xmath160 is invariant under @xmath4 .",
    "if @xmath162 is a point of no evolution , then it belongs to @xmath150 for any tree @xmath0 on @xmath2 leaves because @xmath163 where @xmath164 and @xmath165 corresponds to the identity matrix at each edge : @xmath166 .    for biological applications ,",
    "we are interested in real / stochastic points in @xmath161 that are close to points of no evolution ( in the complex euclidean distance ) .",
    "indeed , as @xmath159 is a continuous map , if @xmath167 is close to a point of no evolution @xmath160 , then there is a preimage of @xmath167 close to @xmath168 .",
    "the parameters close to @xmath168 are precisely those that are interesting biologically speaking because they account for probabilities of no mutation greater than probabilities of mutation ( that is , diagonal entries greater than off - diagonal entries in transition matrices ) .",
    "to this end , the main goal of this paper is to provide a local description of the phylogenetic varieties around the points of no evolution .",
    "[ main_equivariantmodels ] the definition of equivariant model includes important evolutionary models used in phylogenetics for @xmath169 like    1 .",
    "jukes - cantor @xcite , for @xmath170 or @xmath171 ( the alternating group ) ; 2 .",
    "kimura 2-parameter @xcite , for @xmath172 ; 3 .",
    "kimura 3-parameter @xcite , for @xmath173 ; 4 .",
    "strand - symmetric @xcite , for @xmath174 ; 5 .",
    "general markov ( briefly gmm ) @xcite , for @xmath128 .",
    "we say that @xmath120 is a _ submodel _ of @xmath175 if @xmath176 . with this terminology ,",
    "all the models above are submodels of the general markov model and we have inclusions from top to bottom on the sets of corresponding parameters ( and algebraic varieties ) .      in this subsection",
    "we compute the dimension of the phylogenetic variety associated to any @xmath4-equivariant model on any tree @xmath0 , @xmath117 .",
    "this dimension was already known in the particular cases of the jukes - cantor , kimura 2 and 3 parameters and general markov model .",
    "the result yields the codimension of these varieties and hence it is the first step towards providing a complete intersection containing them .",
    "[ dimension ] for any group @xmath117 and any tree @xmath0 without nodes of degree 2 , the dimension of @xmath158 is @xmath177 and the dimension of @xmath150 is @xmath178 .",
    "the dimension of @xmath158 is upper bounded by the dimension of @xmath125 , which we compute in the following .",
    "+ each transition matrix @xmath152 is an element of @xmath179 so , as in our case @xmath180 , the number of parameters is @xmath181 .",
    "however , because of the stochastic assumption , the sum of the rows of each matrix @xmath152 is fixed to one .",
    "notice that @xmath182 surjects onto @xmath183 by the map @xmath184 .",
    "hence , there are @xmath185 independent restrictions on the parameters of @xmath152 .",
    "this makes @xmath186 free parameters for the choice of the transition matrices .",
    "+ on the other hand , the distribution of the root is given by a vector @xmath187 .",
    "the stochastic condition implies that the sum of the coordinates is equal to one .",
    "this makes @xmath188 free parameters for the choice of the root distribution .",
    "+ summing up , we have that @xmath189 is less or equal than @xmath190 .    in order to prove the other inequality we use chang s result ( @xcite ) and its generalization ( @xcite ) on the  generic identifiability of parameters  of the general markov model @xmath191 on trees without nodes of degree 2 .",
    "this result says that the fiber of @xmath192 is finite for parameters @xmath193 that satisfy : ( 1 ) no entry of @xmath114 is zero ; ( 2 ) all @xmath121 are non - singular ; and ( 3 ) @xmath194 for all @xmath123 .",
    "these generic conditions @xmath195-@xmath196 are also generic for the parameters of any equivariant model @xmath120 .",
    "that is , if @xmath197 , for any group @xmath198 we have    1 .",
    "@xmath199 is not included in @xmath200 ( indeed , @xmath201 for example ) , 2 .",
    "@xmath202 is not contained in the set of singular matrices ( indeed , @xmath203 ) , and 3 .",
    "@xmath202 does not only contain matrices with determinant @xmath204 or @xmath205 ( for example , the matrix with all entries equal to @xmath206 belongs to @xmath202 ) .",
    "this means that for generic parameters @xmath207 , if we set @xmath208 , the preimage @xmath209 is finite .",
    "as the preimage @xmath209 contains @xmath210 , this implies that the generic fiber of @xmath143 is finite .",
    "therefore , the dimension of @xmath158 is upper bounded by the dimension of the domain of @xmath143 , which has been computed above .",
    "the claim for @xmath150 follows because it is the closure of the cone over @xmath158 .",
    "this result implies the generic identifiability of the stochastic parameters for trees evolving under equivariant models ( see ( * ? ? ?",
    "* definition 1 ) for example ) .",
    "the stochastic parameters of a tree @xmath0 evolving under an equivariant model @xmath5 , @xmath117 , are generically identifiable if @xmath0 has no nodes of degree 2 .",
    "it can be checked easily that for the evolutionary models listed in example [ main_equivariantmodels ] , the dimension for a trivalent tree on @xmath2 leaves ( and hence with @xmath211 edges ) @xmath0 is    1 .",
    "@xmath212 for the jukes - cantor model ; 2 .",
    "@xmath213 for the kimura 2-parameter model ; 3 .",
    "@xmath214 for the kimura 3-parameter model ; 4 .",
    "@xmath215 for the strand symmetric model ; 5 .",
    "@xmath216 for the general markov model .    if @xmath0 has @xmath2 leaves , we will write @xmath217 for the codimension of @xmath150 in @xmath97 ( equal to the codimension of @xmath158 in @xmath151 ) , that is , @xmath218 .",
    "the dimension of @xmath97 is @xmath219 , which has been computed in ( * ? ? ?",
    "20 ) for the models listed in example [ main_equivariantmodels ] .",
    "let @xmath220 be the _",
    "claw @xmath2-tree _ , that is , the tree with one inner vertex and @xmath2 leaves . in what follows",
    "we prove that the variety corresponding to @xmath220 is smooth at generic points of no evolution .",
    "in particular , it can be locally defined by a complete intersection .    given a permutation subgroup @xmath4 of @xmath52 , we denote by @xmath221 the group of @xmath4-equivariant @xmath222 invertible matrices .",
    "clearly , @xmath221 defines an action on @xmath122 by @xmath223 .",
    "[ thm : orbit ] the variety @xmath224 is the zariski closure of the orbit of @xmath225 under the group action of @xmath226 .",
    "the conditions    * @xmath227 for all @xmath228 , and * all coordinates @xmath114 are different from @xmath229    define open sets in @xmath138 . as @xmath230 and @xmath231 , the intersection of these open sets is non - empty and a generic point @xmath232 satisfies both conditions .",
    "let us fix one edge @xmath155 .",
    "notice that @xmath157 is invertible ( as the coordinates of @xmath114 are nonzero ) and is @xmath4-invariant ( as @xmath233 ) .",
    "this means @xmath234 .",
    "notice that @xmath235 , where @xmath236 for @xmath237 and @xmath238 .",
    "however , @xmath239 .",
    "if @xmath240 satisfies @xmath241 for all @xmath242 , then it is nonsingular .",
    "in particular , a generic point of no evolution of @xmath224 and @xmath243 is nonsingular .",
    "for @xmath224 the statement follows directly from theorem [ thm : orbit ] .",
    "let us also notice that @xmath224 is a cone , hence a point of @xmath243 is smooth if and only if it is smooth as a point of @xmath224 .",
    "when @xmath4 acts on the basis of @xmath9 transitively and freely then @xmath244 is a torus .",
    "this is the case of so - called group - based models and , as follows from theorem [ thm : orbit ] the variety @xmath243 is toric @xcite .",
    "a _ bipartition _ @xmath245 of the set of leaves is just a decomposition @xmath246 , where @xmath112 and @xmath247 are disjoint sets . throughout the paper ,",
    "we write @xmath248 , @xmath249 and , to avoid trivialities , we will assume that @xmath250 .",
    "a bipartition is an _ edge split of @xmath0 _ if it arises by removing one of the edges of @xmath0 .",
    "if @xmath251 , we denote @xmath252 by @xmath253 .    given a tree @xmath0 , in this section",
    "we proceed to construct equations that will define a complete intersection for @xmath150 .",
    "we choose an internal edge @xmath123 of @xmath0 , which induces an edge split of the set of leaves @xmath246 .",
    "this allows us to view the tree @xmath0 as the gluing of two trees @xmath254 where @xmath255 , @xmath256 , and @xmath257,@xmath258 are the two vertices of the edge @xmath123 , see figure [ figure : decomposition2 ] and @xcite .",
    "we assume that the leaves of @xmath0 are ordered so that those in @xmath112 appear in the first place , and those in @xmath247 appear afterwards .",
    "we call @xmath259 the last leaf of @xmath112 and @xmath260 the first leaf of @xmath247 . a complete intersection for the variety @xmath150",
    "will be obtained by joining equations of a complete intersection for @xmath261 , of a complete intersection for @xmath262 and specific edge invariants .",
    "all results of this section ( and the following ) still hold if we replace the vector @xmath51 by any other @xmath4-invariant vector of @xmath47 .        in order to provide specific equations for the varieties associated to phylogenetic trees",
    ", we proceed to construct a basis @xmath266 of @xmath97 related to a given edge split @xmath245 as above .",
    "this basis shall be used to specify coordinates and provide the equations as polynomials in these specific indeterminates .",
    "the important point is that this basis must be consistent with the decomposition @xmath267 given by proposition [ prop : w^ng ] .        1 .",
    "choose bases @xmath268 of each @xmath269 , @xmath28 .",
    "2 .   for each @xmath270 ,",
    "the vectors @xmath271 of @xmath272 , @xmath273 , are linearly independent .",
    "indeed , the monomorphism @xmath274 obtained by tensoring with a power of @xmath51 induces a monomorphism @xmath275 .",
    "we extend them to a basis @xmath276 of @xmath272 .",
    "3 .   we repeat step 2 for @xmath112 to obtain a basis @xmath277 of @xmath278 for each @xmath94 ( but now tensoring at the left , @xmath279 ) .",
    "4 .   write @xmath146 for the inverse of the isomorphism of proposition [ prop : w^ng ] .",
    "its restrictions induce natural isomorphisms from @xmath280 to @xmath281,w_b[\\chi_k])\\cong ( w_a[\\chi_{k^ * } ] \\otimes w_b[\\chi_k])^g.\\ ] ] we call @xmath282 the desired basis @xmath283 of @xmath97 .",
    "[ s_operator ] we describe here the isomorphism @xmath146 mentioned above .",
    "let @xmath25 be the morphism in @xmath286 corresponding to @xmath287 ( this is , @xmath288 ) . to present @xmath289 as an element @xmath290,w_b[\\chi_k])$ ] we proceed as follows :    1",
    ".   denote by @xmath291 the dual basis for @xmath292 .",
    "choose a subset @xmath293 such that , for any @xmath294 , @xmath295 is a basis of a subrepresentation in @xmath296 $ ] ( necessarily isomorphic to @xmath30 ) .",
    "then , @xmath297 is a basis of @xmath296 $ ] .",
    "we define @xmath298 and @xmath299 for @xmath300 .",
    "this is the natural @xmath4-equivariant morphism associated to @xmath25 .",
    "the following statement claims that under stronger assumptions , the image of @xmath285 under the canonical isomorphism @xmath301,w_b[\\chi_k ] ) \\cong ( w_a[\\chi_{k^*}]\\otimes w_b[\\chi_k])^g$ ] has the particularly nice form of the averaging operator .",
    "namely ,      first we notice that the kernel of the averaging operator always contains the kernel of @xmath285 .",
    "moreover , the result of the averaging operator is a @xmath4-equivariant homomorphism .",
    "it remains to evaluate it on @xmath305 .",
    "notice that for each @xmath306 , we have @xmath307 . hence we have the following equality @xmath308 therefore , the right hand part of the equality in the lemma when evaluated at @xmath305 is : @xmath309 on the other hand we have @xmath310 as @xmath285 is equivariant .",
    "so far we did not use the fact that @xmath151 is a subgroup .",
    "however , in such case @xmath311 is the dual basis to @xmath312 , i.e.  @xmath313 . in particular",
    ", @xmath314 substituting this in ( [ eq : two ] ) clearly yields the expression in ( [ eq : one ] ) , by point 3 in remark [ s_operator ] .      for the models of example [ main_equivariantmodels ] , we consider the fourier basis of the space @xmath47 , defined as @xmath315 of @xmath47 where @xmath316 notice that @xmath317 equals the vector @xmath51 introduced above and is invariant under the action of any permutation of @xmath318 .",
    "notice also that the permutation groups associated to these models have only real characters ; so for every irreducible representation , it holds @xmath319 . throughout this section , we adopt the following notation : given @xmath320 , we write @xmath321 for the tensor @xmath322 .",
    "[ examples2 ] to illustrate the first step of the algorithm of the previous section , we proceed to obtain basis of each space @xmath269 when the group @xmath4 is chosen according to some of the models of example [ main_equivariantmodels ] .",
    "all these models satisfy the following property :        1 .",
    "@xmath128 ( gmm ) . in this case",
    ", the only representation is the _ identity _ representation .",
    "we can take @xmath323 , @xmath324 , @xmath325 , @xmath326 , which form a basis of @xmath327 .",
    "2 .   @xmath328 ( strand symmetric model ) .",
    "there are two irreducible representations : the _ identity _ and the _ sign _ representations . by taking @xmath323 , @xmath329 , @xmath330 , @xmath331 , we have that @xmath332 and @xmath333 are basis of @xmath334 $ ] and @xmath335 $ ] , respectively .",
    "3 .   @xmath336 ( kimura 3-parameter ) .",
    "there are four irreducible representations , each with dimension one ( since @xmath4 is abelian ) .",
    "then , we can take @xmath323 , @xmath330 , @xmath337 and @xmath338 , so that each @xmath269 is spanned by the corresponding @xmath339 .",
    "4 .   @xmath340 ( kimura 2-parameter ) .",
    "there are two irreducible representations for @xmath4 with dimension 1 .",
    "taking @xmath323 , @xmath341 , we obtain @xmath342 , for @xmath343 .",
    "there is still a 2-dimensional irreducible representation ; we can take @xmath344 to get a basis of the corresponding space @xmath345 ( a different possibility would be to take @xmath346 ) .",
    "@xmath170 ( jukes - cantor ) .",
    "there are five irreducible representation , but only two of them appear in the maschke decomposition of @xmath47 : the identity representation and one 3-dimensional representation with character @xmath347 in table [ table : char_tables ] . by taking @xmath323 and @xmath348 ,",
    "we obtain bases for the spaces @xmath349 and @xmath350 .",
    "there exist equivariant models that do not satisfy the property ( * ) above .",
    "for example , if @xmath351 , there are two irreducible representations @xmath352 and the maschke decomposition of @xmath47 becomes @xmath353\\oplus w[\\chi_2]$ ] , where @xmath354=\\langle { \\underline{{\\mathtt{a}}}}\\rangle \\oplus \\langle { \\underline{{\\mathtt{c}}}}\\rangle \\oplus \\langle { \\underline{{\\mathtt{g}}}}+{\\underline{{\\mathtt{t}}}}\\rangle$ ] and @xmath355=\\langle { \\underline{{\\mathtt{g}}}}-{\\underline{{\\mathtt{t}}}}\\rangle$ ] .",
    "[ example_ss ] * a basis linked to a bipartition for the strand symmetric model . * take @xmath328 , so we deal with the strand symmetric model .",
    "the character table of @xmath4 is shown in table [ table : char_tables ] .",
    ".[table : char_tables ] character tables of the groups @xmath318 and @xmath356 .",
    "the character @xmath82 corresponds to the permutation representation of the group on the space @xmath47 .",
    "[ cols=\"<,^,^,^,^,^\",options=\"header \" , ]     we also need to consider the equations obtained from the tripods associated to the bipartition : @xmath263 with leaves @xmath357 , and @xmath264 with leaves @xmath358 ( see figure [ figure : quartet ] ) .",
    "now , it can be seen that a complete intersection for the tripod @xmath359 with leaves @xmath360 is given by @xmath361      from @xmath365 , we take @xmath366 to obtain the extended equation in the original coordinates @xmath284 : @xmath367 analogously , from @xmath368 , we take @xmath369 to obtain the extended equation : @xmath370 these 9 equations define a local complete intersection around generic points of no evolution for the variety @xmath150 in @xmath371 .",
    "the aim of this subsection is to explicitly provide codimension many equations of the variety @xmath372 for the tripod for gmm that cut @xmath372 out in a neighborhood of no evolution points .",
    "as the salmon conjecture is well - studied and answered on the set theoretic level @xcite many of the equations of @xmath372 are known .",
    "however , it turns out that the simplest equations , going back to strassen , are enough to obtain a description of the local complete intersection . as we will see not only are they enough - also their choice is astonishingly natural .",
    "recall that when @xmath45 has @xmath1 elements , @xmath372 is the @xmath1-th secant variety of the segre product @xmath373 , i.e. the closure of the locus of rank @xmath1 tensors in the space @xmath374 , where @xmath375 . for",
    "the sake of completeness let us recall landsberg - ottaviani s interpretation of strassen equations @xcite .",
    "each tensor @xmath376 is naturally identified with a map @xmath377 .",
    "let us tensor this map with the identity on @xmath378 obtaining a map @xmath379 .",
    "using the natural map @xmath380 we obtain @xmath381 .",
    "when @xmath382 has rank one , i.e. @xmath383 , then the rank of @xmath384 ( as a matrix ) is at most @xmath385 because the image of @xmath384 is the subspace @xmath386 .",
    "hence , if @xmath382 is of rank @xmath1 , then @xmath384 has rank at most @xmath387 . using the matrix representation of @xmath384 all @xmath388",
    "minors provide equations of the @xmath1-th secant variety .          in the matrix representation of @xmath384",
    "exactly @xmath387 columns contain an entry @xmath401 or @xmath402 for some @xmath403 .",
    "namely , these are the columns indexed by @xmath391 , where @xmath404 .",
    "each such column contains exactly one such entry .",
    "moreover , these entries are contained in @xmath387 different rows : those indexed by @xmath405 ( for @xmath406 ) or @xmath407 ( for @xmath408 ) .",
    "these precise rows and columns will be called _",
    "distinguished_. in table [ matrix ] distinguished rows and columns are marked with @xmath409 and depicted in gray .",
    "consider any minor @xmath152 of @xmath384 of order @xmath388 .",
    "if it does not contain all the distinguished rows and columns , then all its derivatives vanish on any point of no evolution .",
    "indeed , each monomial in @xmath152 will contain at least a degree two factor in variables different from @xmath401 , hence any derivative of such monomial ( if nonzero ) will contain such a variable and will vanish on the no evolution point .",
    "thus from now on we will be interested only in those minors @xmath152 that contain all the distinguished rows and columns .",
    "such minors are of course specified by choosing a non - distinguished row @xmath113 and column @xmath410 . by the same argument as above ,",
    "only the derivative of @xmath152 with respect to the @xmath411 entry can be nonzero at a point of no evolution : this derivative equals the determinant of the submatrix given by distinguished rows and columns , i.e. it equals @xmath412    let us consider a nondistinguished row indexed by @xmath392 , @xmath393 , @xmath413 , @xmath414 .",
    "it contains exactly two nonzero variables in the nondistinguished columns : -@xmath415 and @xmath416 . in particular , there are @xmath417 variables in the submatrix indexed by nondistinguished rows and columns , and they are all different . hence , the corresponding minors have independent differentials at a generic point of no evolution ( which does not have any coordinate equal to zero ) .",
    "notice however that @xmath418 is the codimension of the variety by terracini s lemma @xcite .",
    "thus we can conclude that the given minors provide locally a description of the variety as a complete intersection at the generic points of no evolution .    for @xmath419 in @xmath420 , with @xmath421 , @xmath422",
    ", we call @xmath423 the equation given by the minor formed by the distinguished rows and columns , plus row @xmath392 , and column @xmath424 if @xmath393 or @xmath425 if @xmath426 . we have proven the following :      next , we proceed to prove that assumption [ assumption ] is also satisfied .",
    "consider @xmath169 and let @xmath428 be the fourier basis .",
    "we have @xmath429 equations @xmath430 which are indexed by 3-element subsets of @xmath431 . by the previous discussion ,",
    "each equation @xmath432 has only one nonzero directional derivative ( after evaluated at a generic point of no evolution ) in the standard basis , namely with respect to @xmath433 .",
    "notice that if we removed all the columns of the jacobian matrix indexed by variables of type @xmath434 the matrix would drop rank : all rows indexed by equations @xmath435 would be zero .",
    "let us consider the basis @xmath436 , where @xmath437 , but @xmath438 .",
    "let us call @xmath439 the jacobian matrix with @xmath429 rows indexed by the above equations written in this new basis and @xmath440 columns indexed by basis elements @xmath436 .",
    "let @xmath441 be the submatrix of @xmath439 obtained by removing all the columns indexed by a variable of type @xmath442 for any @xmath443 .",
    "let us fix distinct @xmath438 .",
    "there are precisely two equations @xmath444 as described above .",
    "the evaluation at a generic point of no evolution of the directional derivatives of these equations with respect to @xmath445 equals zero unless @xmath446 and @xmath447 . these give us @xmath448 variables that can give nonzero derivatives ( as we assume @xmath449 )",
    ". actually , the directional derivative of @xmath450 with respect to @xmath451 is equal to @xmath452 where @xmath410 is the amount defined in ( [ defn_c ] ) and @xmath453 represents the sign of @xmath242 in @xmath454 : @xmath455 if @xmath456 or @xmath457 , and @xmath458 otherwise .    on the other hand , at a generic point of no evolution ,",
    "the evaluation of the derivatives with respect to any variable @xmath459 gives a nonzero value only when applied to the equations @xmath460 or @xmath461 .",
    "hence the nonzero entries of the @xmath462 matrix @xmath441 are contained in @xmath463 rectangles of shape @xmath464 , not sharing rows or columns .",
    "to finish the proof it remains to show a @xmath465 submatrix with nonzero determinant in each rectangle . if @xmath466 or @xmath467 , then @xmath468 . without loss of generality , we may assume that @xmath466 .",
    "then , we choose the derivatives with respect to @xmath469 , and @xmath470 .",
    "the submatrix obtained has the form : @xmath471 if @xmath472 , then @xmath473 and we can take @xmath474 . we choose the derivatives with respect to @xmath475 and @xmath476 .",
    "the obtained submatrix is of the form : @xmath477 in any case , the determinant is @xmath478 and we are done .",
    "take @xmath328 , corresponding to the strand symmetric model as in example [ main_equivariantmodels ] . in order to deduce equations for the tripod ,",
    "we construct first a convenient basis for the space @xmath479 .",
    "we take @xmath480 and @xmath481 .",
    "take @xmath482 and keep the notation used in example [ example_ss ] . a basis for @xmath483",
    "would be inferred from @xmath484 by taking the image of the operator @xmath146 specified in remark [ s_operator ] applied to the tensors @xmath485 ( as the irreducible representations have dimension 1 , remark [ s_operator ] trivially applies ) : @xmath486 in other words , the _ fourier basis for ssm _ is the subbasis of the usual fourier basis for @xmath487 formed by triplets that contain an even number of elements in @xmath488 .",
    "thus we denote its coordinates as the usual fourier coordinates @xmath489 ( corresponding to the basis vector @xmath490 ) . if @xmath491 is a no evolution point , then its fourier coordinates are given by        a complete intersection for the variety corresponding to the tripod ( which has codimension 12 in @xmath495 ) is defined by 12 equations and can be obtained from the 24 equations we described for the tripod evolving under gmm as follows . as in section [ sec : gmm ] we consider the tensor @xmath0 and write the matrix @xmath496 in the fourier coordinates .",
    "as @xmath489 is 0 if @xmath490 contains an odd number of elements in @xmath488 , the matrix @xmath496 reduces to the matrix presented in table [ matrixssm ] .",
    "the subindices @xmath497 refer now to @xmath498 respectively .",
    "when we consider the same equations as in the previous section we observe that out of the 12 nondistinghuished rows , only 6 contain nonzero entries at the nondistinguished columns ( and they contain exactly 2 nonzero entries ) .",
    "these rows are those labelled by @xmath499 such that @xmath500 and @xmath501 contains an even number of @xmath502 the same argument used for the general markov model proves that these twelve @xmath503 minors define a local complete intersection at the generic points of evolution and that they satisfy assumption [ assumption ] .",
    "now out of these equations we provide a local complete intersection for trees with four leaves .",
    "take @xmath0 the tree with 4 leaves and choose @xmath504 and @xmath505 as in the previous example ( see figure  [ figure : quartet ] ) .",
    "we proceed to obtain a basis for the ambient space @xmath371 of the variety @xmath506 .",
    "similar computations as above show that @xmath507 so , a basis for @xmath508 is given by all tensors of the form @xmath509 ( as the irreducible representations have dimension 1 , remark [ s_operator ] trivially applies ) .",
    "now , if @xmath510 is a no evolution point , and we write @xmath511 , then each irreducible representation gives rise to a @xmath512-matrix @xmath513 , @xmath343 : @xmath514 where rows are indexed by the @xmath515 and columns are indexed by the @xmath516 . as above , from lemma [ nonzero_derivatives ] , we know that @xmath517 the resulting edge invariants arise from each @xmath513 as rank restrictions for the 3-minors containing @xmath518 , namely : @xmath519 these invariants together with the 12 equations obtained from @xmath263 and the 12 equations obtained from @xmath264 define a complete intersection for the variety of @xmath0 locally near the points of no evolution .",
    "n.  eriksson , k.  ranestad , b.  sturmfels , and s.  sullivant .",
    "phylogenetic algebraic geometry . in `` projective varieties with unexpected properties '' ( eds : c. ciliberto , a. geramita , b. harbourne , r - m .",
    "roig and k. ranestad ) , de gruyter , berlin , 2005 ."
  ],
  "abstract_text": [
    "<S> phylogenetic varieties related to equivariant substitution models have been studied largely in the last years . </S>",
    "<S> one of the main objectives has been finding a set of generators of the ideal of these varieties , but this has not yet been achieved in some cases ( for example , for the general markov model this involves the open `` salmon conjecture '' , see @xcite ) and it is not clear how to use all generators in practice . motivated by applications in biology , we tackle the problem from another point of view . </S>",
    "<S> the elements of the ideal that could be useful for applications in phylogenetics only need to describe the variety around certain _ points of no evolution _ ( see @xcite ) . </S>",
    "<S> we produce a collection of explicit equations that describe the variety on a zariski open neighborhood of these points ( see theorem [ invariantsci ] ) . </S>",
    "<S> namely , for any tree @xmath0 on any number of leaves ( and any degrees at the interior nodes ) and for any equivariant model on any set of states @xmath1 , we compute the codimension of the corresponding phylogenetic variety . we prove that this variety is smooth at general points of no evolution , and provide an algorithm to produce a complete intersection that describes the variety around these points . </S>"
  ]
}