{
  "article_text": [
    "neutrinos are elusive , weakly interacting particles . due to their small cross - sections with ordinary matter , which make their detection on the earth so challenging , they represent a very efficient way for astrophysical dense and hot plasma to radiate energy away . in particular",
    ", they are expected to be copiously emitted in stellar explosive scenarios , including core - collapse supernovae ( ccsne ) ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* for recent reviews ) and compact binary mergers ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* for recent reviews ) .",
    "the modeling of such systems is extremely stimulating , due to the large variety of involved scales , and to the complex and rich physics required .",
    "the treatment of neutrinos , in particular their transport from optically thick to optically thin regions , is among the most crucial and difficult parts to model .",
    "this is even more evident for intrinsically multidimensional problems , where the solution of the boltzmann transport equation would result in a genuine seven - dimensional problem ( e.g. , * ? ? ?",
    "the large variety of questions and possible initial conditions , together with the parallel increase of computational power , have motivated the development of several neutrino treatments , which differ in complexity and accuracy .",
    "the solution of the complete boltzmann equation for neutrino radiation has been performed for spherically symmetric simulations of ccsne @xcite .",
    "solutions in 2d ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and , recently , in 3d @xcite , neglecting velocity dependent terms , in the context of collapsing stellar cores , have also been presented . another sophisticated approach to the neutrino transport problem",
    "is represented by the so called moment schemes . in these schemes , the explicit angular dependence in the neutrino momentum space",
    "is removed by integrating the distribution function and introducing momenta ( for example , the energy density is the zeroth momentum , while the linear momentum density is the first momentum ) .",
    "the boltzmann transport equation is replaced by time evolution equations for the different momenta . among them , we recall the ( multi - group ) flux limited diffusion schemes , ( mg)fld , where only the 0th moment is considered ( @xcite ; for related applications see , e.g. , @xcite ) , and the m1 schemes , where both the 0th and 1st momenta are taken into account ( see , e.g. , @xcite ) .",
    "the closure relation in m1 schemes is usually provided by an analytic expression .",
    "it is possible to design moment schemes where the closure relation is not analytic , but it is given by a variable eddington tensor ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "? * ; * ? ? ?",
    "this latter solution is close to the solution of the full boltzmann equation .",
    "another noteworthy approximate transport scheme is the isotropic diffusion source approximation ( idsa , @xcite ; see @xcite for some recent applications ) , where the distribution function is separated into a trapped and a free - streaming component .",
    "also monte carlo methods have been developed in the context of neutrino transport ( see , for example , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "more approximate treatments include gray transport schemes @xcite , gray neutrino leakage schemes @xcite and light - bulb schemes @xcite .    in this paper , we present an improved and more sophisticated version of the classical leakage scheme .",
    "leakage schemes have a long history in computational astrophysics : due to their reduced computational cost and to their flexibility , they were , after fld schemes , among the first developed neutrino treatments for spherically symmetric core - collapse models @xcite , and for the first three - dimensional compact binary merger simulations @xcite .",
    "more recently , gray leakage schemes have been widely applied to study , for example : i ) neutrino and gravitational wave emissions from rotating and/or magnetized collapsing stellar cores , in axisymmetry @xcite or in three dimensions @xcite ; ii ) supernova explosions caused by the magneto - rotational mechanism ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) ; iii ) the influence of the pions and hyperons in the nuclear equation of state ( eos ) of stellar cores collapsing into a black hole @xcite , iv ) the impact of asphericity in the progenitor model for core - collapse simulations @xcite , v ) gravitational waves and neutrino emission from newtonian simulations of compact binary mergers @xcite .",
    "general relativistic extensions of the gray scheme have also been developed @xcite .",
    "they have been used , for example , to simulate : i ) spherically symmetric models of supernovae and black hole formation from massive stellar cores @xcite ; ii ) three - dimensional general relativistic core - collapse models @xcite , including also magnetic fields @xcite ; iii ) gravitational waves and neutrino emission from general relativistic simulations of compact binary mergers @xcite ; iv ) the collapse of rotating stellar core to a black hole surrounded by an accretion disc @xcite .",
    "despite such a broad application field , detailed comparisons between the results obtained by a leakage scheme and more sophisticated neutrino transports are difficult to find . for example , @xcite compared the luminosities obtained by a gray leakage scheme with the ones obtained by mgfld or moment schemes , during and after a compact binary merger .",
    "moreover , @xcite and @xcite provide temporal profiles of the neutrino luminosities and mean energies occurring after core bounce in ccsne simulations , together with a few radial profiles of some relevant quantities ( e.g. , entropy or electron fraction ) .",
    "these results can be compared with reference results in the literature ( e.g. , @xcite ) .",
    "they found a qualitative good agreement , even if quantitative differences were present .",
    "this confirms the idea that leakage schemes capture the dominant aspects of neutrino cooling , even if the evolution of the neutrino field in the opaque region and the inclusion of consistent absorption terms in the optically thin region remain challenging .",
    "in the advanced spectral leakage ( asl ) treatment we conjugate the usual positive aspects associated with leakage schemes ( mainly , the reduced computational cost and flexibility ) , with an improved accuracy , obtained using a spectral approach ( i.e. , solving different leakage schemes , for different energy bins ) , modeling a neutrino trapped component in the optically thick region , and including a consistent absorption term obtained from the spectral cooling rates .",
    "the development of the asl treatment has been performed in the framework of spherically symmetric models of ccsne , where the new treatment has been compared against a detailed boltzmann neutrino transport .",
    "@xcite used it , in combination with the idsa for electron flavor neutrinos , to model heavy flavor neutrinos in spherically symmetric , artificially induced explosions of ccsne . however , one of the goals of this approximate scheme is the application to multidimensional models , with reduced computational costs .",
    "applications of the asl scheme in multidimensional astrophysical simulations have been already performed in the past few years .",
    "@xcite simulated a magnetically - driven ccsn explosion of a 15  @xmath0 progenitor star , using the three - dimensional , cartesian mhd code fish @xcite coupled with a previous version of the asl scheme to model the neutrino cooling . @xcite studied the neutrino - driven wind that emerges from the remnant of a binary neutron star merger , in presence of a long - lived massive neutron star .",
    "they used the fish code coupled with the asl scheme .",
    "the neutrino heating rates were based on neutrino densities in optically thin regions , computed by a ray - tracing algorithm .    in section [ sec : the new asl ] , we provide a detailed presentation of the asl scheme and of its terms . in section [ sec : tests and validity ] , we test the new scheme in the context of spherically symmetric models of ccsne , comparing the results obtained by the new treatment with the solution of the boltzmann transport equation",
    ". we also briefly explore the impact of the variation of the few free parameters present in the scheme . in section [ sec : multid models ]",
    ", we show the flexibility and the versatility of the asl scheme by implementing it in two different multidimensional codes , a grid code and an sph code , modeling ccsne . finally , in section [ sec : conclusions ] , we summarize and discuss our results .",
    "the asl scheme is an approximate neutrino treatment designed for neutrinos and antineutrinos of all flavors .",
    "while electron neutrinos ( @xmath1 ) and antineutrinos ( @xmath2 ) are considered separately , @xmath3 and @xmath4 neutrinos , as well as their antiparticles , are treated as a single neutrino species ( @xmath5 ) . for each of the three independent species ,",
    "we perform a spectral treatment , i.e. we distinguish between neutrinos with different energies .",
    "the interaction between matter and neutrinos is provided by weak interaction processes . for each production , absorption , or scattering reaction",
    ", we compute the corresponding spectral emissivity @xmath6 , absorptivity @xmath7 , or scattering rate @xmath8 , respectively , as they are defined in the boltzmann transport equation , for a neutrino energy @xmath9 and a position @xmath10 ( in this section we consider a fixed time @xmath11 ) .",
    "the total emissivity and absorptivity are computed as the sum over all considered neutrino processes . while the emissivity provides the local rates of neutrino production , the absorptivity and the scattering rates are the sources of the local neutrino opacity .",
    "the local opacity can be expressed in terms of the _ total _ mean free path @xmath12 , @xmath13 where @xmath14 is the speed of light , and the indexes @xmath15 and @xmath16 run over all the considered absorption and scattering reactions , respectively . besides the total mean free path , in which all reactions are treated equally , we define also an _ energy _ mean free path , @xmath17 .",
    "the latter represents the mean free path over which neutrinos can effectively exchange energy with the fluid . to compute it",
    ", we perform the geometrical mean between the total mean free path and the mean free path only due to highly inelastic processes , i.e. all the absorption processes and the scattering processes where the energy of the incoming and out - coming neutrinos is expected to differ significantly via @xmath18 .",
    "even if they do not allow direct energy exchange between neutrinos and matter , they still provide opacity and increase the probability of inelastic processes to locally happen . ]",
    "( see , for example , @xcite or @xcite for analogous expressions ) : @xmath19 where we have restricted the sum only over inelastic processes , abbreviated by _ inel _ and labeled by @xmath20 .",
    "the neutrino optical depth @xmath21 is defined as the path integral of the inverse neutrino mean free path , @xmath22 , calculated on a typical radiation path , @xmath23 , connecting any point @xmath24 of the system with its edge : @xmath25 from a physical point of view , it is a measure of the accumulated opacity of matter to radiation along an escape path : it counts the number of interactions that , on average , a radiation particle , emitted at a certain point , experiences before leaving the system .",
    "the two mean free paths introduced above can be used to compute two different optical depths , a total optical depth , @xmath26 , and an energy optical depth , @xmath27 .",
    "we note that @xmath28 , by definition . in the case of spherically symmetric models ,",
    "the optical depth retains the spherical symmetry and @xmath21 can be simply calculated along radial paths : @xmath29 otherwise , for more general geometries , multidimensional algorithms are required to compute the optical depth along paths that minimize the number of neutrino - matter interactions ( e.g. , @xcite ) .    according to the values of @xmath30 and @xmath31 for the most relevant neutrino energies , several different regimes can be distinguished :    1 .",
    "@xmath32 and @xmath33 , the _ equilibrium - diffusive _ regime .",
    "the radiation field is in thermal and weak equilibrium with the surrounding matter , and neutrinos can be considered as a trapped fermi gas inside the fluid , behaving like a fluid component itself . under these assumptions ,",
    "the distribution functions describing the neutrino gas can be expressed as @xmath34 , where @xmath35 is the trapped component and @xmath36 is a small deviation from equilibrium , that we neglect @xcite .",
    "we assume further that the trapped component has no explicit angular dependence in the momentum space , @xmath37 ( for a more detailed discussion of the decomposition of the neutrino distribution function in a ( isotropic ) trapped component and a free streaming one see @xcite ) .",
    "the integration over the neutrino phase space of @xmath35 and @xmath38 gives information about the particle and the energy contents of the neutrino gas : @xmath39 @xmath40 where @xmath41 is the baryon mass and @xmath42 the planck constant .",
    "2 .   @xmath32 , but @xmath43 , the _ diffusive _ regime .",
    "neutrinos still diffuse , but they are not necessarily in thermal equilibrium with the surrounding plasma .",
    "@xmath44 , the _ semi - transparent _ regime .",
    "the solution of the boltzmann transport problem would be here ideal to model the radiation transport with accuracy .",
    "the surfaces defined by the conditions @xmath45 are called _ neutrino surfaces _ ( or _ neutrinospheres _ , in spherically symmetric models ) . in the case of @xmath30 , they are considered as the last - interaction surfaces , before neutrinos can stream away freely . for @xmath31 , they represent the surface at which neutrinos decouple thermally from matter .",
    "@xmath46 , the _",
    "free streaming _",
    "regime . in this regime ,",
    "neutrinos that are locally produced can stream out freely , almost with no interaction with matter . at the same time",
    ", a fraction of the large neutrino fluxes coming from the neutrino surfaces can be here re - absorbed by matter .      in",
    "the following we consider a newtonian hydrodynamical system at time @xmath11 , which is evolving in time with a time - step @xmath47 . to be more general , we consider a three - dimensional domain and , unless it is explicitly said , no symmetries are assumed .",
    "the system is described by its density @xmath48 , temperature @xmath49 , electron fraction @xmath50 , and velocity field @xmath51 .",
    "the trapped neutrino components are defined by @xmath52 and @xmath53 .",
    "all these quantities are given at every position @xmath10 .",
    "we define the vector of conserved variables , @xmath54 , and the corresponding flux tensor , @xmath55 , as : @xmath56 where the specific internal energy @xmath57 and the fluid pressure @xmath58 are provided by an eos as functions of @xmath59 , while @xmath60 is the modulus of the fluid velocity .",
    "the evolution of the system is determined by : @xmath61 where @xmath62 is the gravitational source term , depending on the gravitational potential @xmath63 , and @xmath64 is the neutrino source term . the latter is related to the variation of the specific internal energy , @xmath65 , of the electron fraction , @xmath66 , of the neutrino trapped components , @xmath67 and @xmath68 , and of the fluid velocity , @xmath69 , provided by neutrinos : @xmath70 the goal of the asl scheme is the estimation of the neutrino source term , @xmath64 , from the present values of the thermodynamical state @xmath54 of the system . before proceeding",
    ", it is important to notice that any leakage scheme models the local net loss of leptons in form of neutrinos , i.e. the variations of the total ( trapped ) lepton number , @xmath71 , and of the specific total internal energy , @xmath72 .",
    "these quantities are related with the variation rates appearing in equation  ( [ eq : source terms ] ) by @xmath73 and @xmath74 note that the contributions to @xmath71 given by @xmath5 and @xmath75 cancel in our approach . concerning the neutrino stress , we distinguish @xmath69 into two contributions : @xmath76 i.e. , one related with the trapped neutrinos , @xmath77 , and one with the absorption of radiation in optically thin conditions , @xmath78 .",
    "in section [ subsec : trapped part ] we show how we compute the rates for the trapped components @xmath79 and @xmath80 , and the neutrino stress in trapped conditions @xmath81 .",
    "the calculation of the leakage rates , @xmath72 and @xmath71 , and of the neutrino stress in free - streaming conditions , @xmath82 , is exposed in section [ subsec : effective part ] . in both sections ,",
    "we omit the explicit dependence on time and position in the equations , apart when the neutrino energy is involved . in that case",
    ", we only omit the temporal dependence .",
    "the variation rates for the trapped components are computed as : @xmath83 where @xmath84 and @xmath85 are guesses of the trapped components at @xmath86 , only due to neutrino processes .",
    "their computation is done following these steps .",
    "i ) reconstruct approximated trapped components of the neutrino distribution functions , @xmath35 , at the current time @xmath11 based on @xmath52 .",
    "this is done assuming that @xmath87 the exponential cut - off ensures that @xmath35 is significantly different from 0 only when neutrino trapping conditions are fulfilled with respect to the energy optical depth , i.e. @xmath88 , and that it is proportional to @xmath89 for @xmath90 .",
    "the local parameter @xmath91 is fixed by equation  ( [ eq : ynu def ] ) .",
    "to reconstruct @xmath92 does not ensure the exact reconstruction of @xmath53 .",
    "on one hand we have tested that the usage of @xmath53 instead of @xmath52 does not change our results significantly . on the other hand ,",
    "the usage of the original ( i.e. , not reconstructed ) values of @xmath53 in the computation of @xmath80 still ensures energy conservation . ]",
    "the equilibrium distribution functions are assumed to be fermi - dirac distribution functions of a neutrino gas in thermal and weak equilibrium with matter @xmath93 where @xmath94 is assumed to be equal to the matter temperature ( true for @xmath95 ) and @xmath96 is the neutrino degeneracy parameter . for @xmath1 and @xmath2",
    ", we use the equilibrium degeneracy parameter : @xmath97 where @xmath98 , @xmath99 and @xmath100 are the relativistic chemical potentials of neutrons , protons and electrons , respectively . for @xmath101 , we assume @xmath102 . if @xmath5 are produced by electron - positron annihilation , this relation suggests that neutrinos and antineutrinos of these flavors have approximately opposite chemical potentials .",
    "however , the substantial equivalence between @xmath5 and @xmath75 ) , and nuclear effects distinguishing @xmath103 and @xmath104 ( like weak magnetism ) are neglected .",
    "] implies also the equivalence between their chemical potentials .",
    "thus , the degeneracy parameter for @xmath5 is set to 0 .",
    "\\ii ) evolve @xmath35 according to timescale arguments between @xmath11 and @xmath86 .",
    "this is done considering the neutrino production and diffusion as two competing processes : @xmath105 with : @xmath106 and @xmath107 in equations  ( [ eqn : fdot prod ] ) and ( [ eqn : fdot diff ] ) , all the quantities are evaluated at position @xmath10 and for a certain neutrino energy @xmath9 . in equation  ( [ eqn : fdot prod ] )",
    ", the term before the exponential ensures that the distribution function reaches the equilibrium value whenever the production timescale is small enough compared to the time - step @xmath47 .",
    "similarly , the first part of equation  ( [ eqn : fdot diff ] ) causes the distribution function to go to 0 , if the diffusion timescale is small enough compared with @xmath47 .",
    "the exponential factors in both expressions are a switch between the diffusive and the free - streaming regime .",
    "the production timescale , @xmath108 , is set by the neutrino emissivity : @xmath109 following @xcite ( cf .",
    "@xcite ) we define the diffusion timescale , @xmath110 , as @xmath111 the quantity @xmath112 can be understood as the effective width of a layer drained by the diffusion flux and it is calculated as @xmath113 usually , @xmath114 ( e.g. , @xcite , @xcite and @xcite ) . while for large optical depths equation  ( [ eqn : diffusion timescale ] ) provides an estimate of a proper diffusion timescale , in the optically thin regime its value decreases significantly , due to its quadratic dependence on the optical depth .",
    "\\iii ) obtain @xmath115 and @xmath116 from @xmath117 , based on equations  ( [ eq : ynu def ] ) and ( [ eq : znu def ] ) .",
    "trapped neutrinos provide a source of stress for the fluid .",
    "this stress is determined by the gradient of the pressure of the neutrino gas @xmath118 where the neutrino pressure is evaluated based on the energy content of the neutrino gas , @xmath119      the rates for the total lepton number and total specific internal energy are obtained as the net balance between the emission rates ( @xmath120 for the particles and @xmath121 for the energy ) and the absorption rates in optically thin conditions ( @xmath122 for the particles and @xmath123 for the energy ) : @xmath124 and @xmath125 in equations  ( [ eqn : yldot ] ) and ( [ eqn : udot ] ) , @xmath5 and @xmath75 do not provide any net contribution to the lepton number and do not contribute to the absorption in optically thin conditions .",
    "the emission and absorption rates are obtained from spectral emission ( @xmath126 ) and absorption ( @xmath127 ) rates , according to : @xmath128 @xmath129 with @xmath130 .",
    "the emission rates are computed as smooth interpolation between the production rates , @xmath131 and the diffusion rates , @xmath132 the former are expected to be dominant in optically thin conditions , while the latter in the opaque region .",
    "the interpolation formula is provided by @xmath133 where @xmath134 is the interpolation expression used for the emission rates in gray leakage schemes ( cf , for example , * ? ? ?",
    "* ; * ? ? ?",
    "@xmath135 and @xmath136 are parameters , and @xmath137 is a local normalization factor : @xmath138 then , for @xmath139 and @xmath140 , we obtain @xmath141 .",
    "finite , non - zero values of these constants introduce two important improvements in the asl scheme : + i ) in the case where @xmath142 , the total amount of emitted @xmath1 s and @xmath2 s is usually overestimated .",
    "when a large fraction of the emission rates is produced in the semi - transparent and optically thin conditions , the interpolation favors the usage of the production rates , calculated as integral over the whole solid angle of isotropic emission rates , equation  ( [ eqn : r_prod definition ] ) .",
    "however , a significant fraction of those neutrinos are emitted toward the optically thick region .",
    "moreover , the emission rates can be significantly reduced by pauli s blocking factors , provided by the large amount of free streaming neutrinos emitted at the neutrino surface or locally produced . to efficiently take into account these effects",
    ", we have introduced the factor @xmath143 in equation  ( [ eqn : r_eff last version ] ) .",
    "@xmath135 is a free parameter of the model and it is expected to be @xmath144 for @xmath1 and @xmath2 in strongly accreting systems . on the other hand ,",
    "since the emission of @xmath5 from optically thin conditions is usually negligible , we use @xmath145 .",
    "+ ii ) the rates obtained with equation  ( [ eqn : r_eff old version ] ) retain spectral information of the local thermodynamical properties of matter . nevertheless during the diffusion process ,",
    "high energy neutrinos coming from optically thick regions thermalize to lower energies , at least as long as @xmath146 .",
    "thus , the spectrum emerging from the neutrinospheres is softer than the one provided by equation  ( [ eqn : r_eff old version ] ) . to mimic this transition ,",
    "we have included the term @xmath147 in equation  ( [ eqn : r_eff last version ] ) .",
    "the definition of @xmath137 , equation  ( [ eqn : normalization factor n ] ) , ensures that the number of neutrinos emitted is preserved , while their final spectrum is modeled according to the energy optical depth . since a few inelastic interactions are necessary to thermalize the spectrum",
    ", we expect @xmath148 .",
    "eventually , neutrinos emitted at the neutrino surface and above it stream away in the optically thin region , with a non - negligible probability to be re - absorbed by the fluid . in the asl scheme",
    ", we include an estimate of this non - local absorption rates , @xmath149 , based on the computation of the neutrino densities outside the neutrino surfaces .",
    "the spectral absorption rates for @xmath1 and @xmath2 in optically thin conditions are calculated as : @xmath150 @xmath151 is the pauli blocking factor for electrons or positrons in the final state : @xmath152 where we have assumed that the electron or positron produced by the absorption of an electron neutrino or antineutrino , respectively , has an energy equal to the energy of the incoming neutrino , corrected by the mass difference @xmath153 . in equation  ( [ eqn : heating term outside ] ) , @xmath154 is an exponential term that ensures the application of the heating rates only in the optically thin region .",
    "the quantity @xmath155 is the spectral neutrino density , defined such as the total neutrino density outside the neutrino surface , @xmath156 , is : @xmath157    one of the limits of any leakage scheme is that it does not model the spatial and angular distribution of the emission outside the neutrino surface .",
    "thus , the calculation of @xmath127 requires first a separate evaluation of @xmath158 .",
    "this task depends strongly on the nature of the problem and on the symmetry of the system . for spherically symmetric models ,",
    "the preferential propagation direction is the radial one , and the neutrino densities are related to the spherically symmetric neutrino spectral particle luminosities , @xmath159 , by @xmath160 where @xmath161 is the radial coordinate ( e.g. , @xcite ) .",
    "this conversion between the neutrino flux and density involves the ( spectral ) flux factor @xmath162 .",
    "it represents the average of the cosine of the propagation angle for the free - streaming neutrinos .",
    "far from the neutrinospheres , the distribution functions are expected to peak in the forward direction , meaning @xmath163 .",
    "close to the neutrinospheres , assuming that radiation is emitted isotropically above the plane tangential to the neutrinospheres , @xmath164 . following @xcite",
    ", we use an analytic approximation for @xmath165 : @xmath166 the quantity @xmath159 is computed at each radius and for each neutrino energy as a solution of the differential equation @xmath167    the neutrinos absorbed in free - streaming conditions deposit momentum in the fluid . in the case of spherically symmetric models , the related stress is computed as : @xmath168    for systems with an approximate spherical symmetry ( like collapsing stellar cores ) , the procedure described above to compute @xmath169 and @xmath170 can be applied in a ray - by - ray fashion ( i.e. , along radial paths starting from the center of the system ) . for more general geometries , ray - tracing algorithms can be designed ( e.g. , @xcite ) .",
    "we implement the asl scheme , as it is described in section  [ sec : the new asl ] , in the implicit , spherically symmetric hydrodynamics code _ agile _",
    "( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) .",
    "for the calculation of the neutrino emissivities , absorptivities and scattering rates , we include a minimal set of neutrino - matter reactions containing the most relevant ones .",
    "for the production and the absorption of electron flavor neutrinos , @xmath171 where @xmath172 and @xmath173 refer to electrons and positrons , while @xmath174 , @xmath175 and @xmath176 to neutrons , protons and nuclei with mass number @xmath177 and atomic number @xmath178 , respectively .",
    "pair processes , like electron - positron annihilation and neutrino bremsstrahlung from free nucleons ( generically referred as @xmath179 ) , are expected to be secondary sources for @xmath1 and @xmath2 , but primary for @xmath5 : @xmath180 all the reactions listed above are considered as inelastic .",
    "major sources of opacity for all neutrino species are provided by scattering on nucleons and nuclei : @xmath181 these scattering reactions are considered as elastic in the computation of the total and energy mean free paths .",
    "all these weak interactions are implemented according to @xcite , apart from neutrino bremsstrahlung @xcite and pair production @xcite , whose implementation is described in appendix  [ appa ] .",
    "the opacity provided by the scattering of neutrinos on electrons and positrons has not yet been implemented .",
    "it has been shown that this process is relevant to thermalize neutrinos during the collapse of the core ( e.g. , @xcite ) and in the cooling phase of the proto - neutron star ( pns ) in exploding models , seconds after core bounce @xcite . even if the effect of this reaction on the total and energy mean free path",
    "is not considered , the thermalization effect provided by it in the optically thick regime is partially taken into account in our scheme by enforcing the usage of equilibrium fermi - dirac distribution functions to model the neutrino trapped component .",
    "the impact of this effective treatment in the different parts of a core - collapse simulation is discussed later in more detail .",
    "the asl scheme is an effective treatment for neutrino - radiation hydrodynamics .",
    "therefore , it requires to be tested and compared against a reference solution , not only to check its validity and accuracy , but also to set the free parameters that appear in the scheme . to perform this test ,",
    "we choose the case of spherically symmetric core - collapse models .",
    "we start with a zero age main sequence ( zams ) 15  @xmath0 progenitor model , obtained by @xcite .",
    "we follow the collapse of the core and the first 300 milliseconds after core bounce .",
    "we include @xmath182 from the initial progenitor , distributed over 103 radial zones on the adaptive lagrangian grid of _ agile _  .",
    "the corresponding initial outer radius is @xmath183 far from the origin . as reference solution",
    ", we use the results obtained by the ` boltztran `  code ( * ? ? ?",
    "* ; * ? ? ?",
    "? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) , also coupled with the _ agile _  code . `",
    "boltztran `  solves the boltzmann equation using the method of discrete ordinates with a gauss - legendre quadrature . `",
    "boltztran `  incorporates all the neutrino reactions listed in equations  ( [ eqn : neutrino reaction 1])-([eqn : neutrino reaction 3 ] ) . for consistency with our asl implementation",
    ", we rely on the neutrino reactions implementation reported in @xcite .",
    "recently , @xcite has shown the impact of modern neutrino rates in _",
    "agile_-`boltztran `  runs .",
    "we postpone the implementation of more accurate reaction rates in the asl to a future step .",
    "furthermore , we notice that , even if neutrino - electron scattering is implemented in the ` boltztran `  version we are using , for consistency our reference runs do not include it , if not stated otherwise .",
    "we perform our tests and compute our reference solutions assuming newtonian gravity to be able to compare later with different multidimensional newtonian hydrodynamical schemes . in all our _",
    "agile_-asl  runs , as well as in the _ agile_-`boltztran `  ones , we use the lattimer - swesty eos @xcite , with nuclear compressibility @xmath184 .",
    "neutrino energies are discretized by 20 geometrically increasing energy groups in the range @xmath185 . in the _",
    "agile_-`boltztran `  runs , the neutrino propagation angle is discretized by 6 angular bins .",
    "cccc name & @xmath186 & @xmath187 & @xmath136 +   + cal & @xmath188 & @xmath189 & @xmath190 +   + std & @xmath191 & 0.55 & 20 +   + ad_2 & 2 & 0.55 & 20 + ad_5 & 5 & 0.55 & 20 + ab_45 & @xmath191 & 0.45 & 20 + ab_65 & @xmath191 & 0.65 & 20 + tc_7 & @xmath191 & 0.55 & 7 + tc_54 & @xmath191 & 0.55 & 54 +    the validation and the calibration of the asl scheme are done by comparing directly the temporal and the radial profiles of some relevant quantities obtained with _",
    "agile_-asl  with our reference solutions .",
    "we do not define a quantitative criterion to compare the different results , because our simulations span a broad range of conditions and this prevents the possibility to select a single quantity as indicator .",
    "instead , we search for the parameter set that , overall , best matches the most important features of a ccsn model between collapse and a few hundreds of milliseconds after core bounce . in particular , during the collapse we focus on central quantities ( e.g. , density , entropy and electron fraction ) . before and after bounce , we monitor the profiles of matter density , @xmath48 , matter entropy per baryon , @xmath16 , electron fraction , @xmath50 , and radial velocity , @xmath192 . regarding the neutrino quantities , we investigate the radial profile of @xmath52 , together with the luminosities , @xmath193 , and the root mean squared ( rms ) neutrino energies , @xmath194 , both measured at 300 km from the center . the different versions of _",
    "agile_-asl  differ by the usage of a distinct set of parameters , @xmath195 .",
    "the ranges we have explored are reported in the first row of table  [ tab : parameter and runs ] .",
    "the values of the parameters that provide the overall best agreement in all the monitored quantities , during the entire simulation , are :    * @xmath196 , where @xmath197 is the mass fraction of heavy nuclei .",
    "this peculiar dependence is a simple interpolation between two limiting behaviors : @xmath198 in the unshocked regions ( more relevant in the collapse phase ) and @xmath199 in the shocked ones ( more relevant in the post bounce phase ) .",
    "the physical interpretation of this difference is linked with the fact that in the unshocked region @xmath1 and @xmath2 opacities depend more on quasi - elastic scattering on nucleons and nuclei than on inelastic absorption processes ( @xmath200 ) ; while in the shocked region both are equally important ( @xmath201 ) .",
    "when isoenergetic scattering dominates , high energy neutrinos diffuse changing more slowly their energy and interacting more with matter , compared with thermalized neutrinos .",
    "this effect leads to a significant increase of the diffusion timescale . *",
    "@xmath202 , while @xmath203 .",
    ".    we will refer to this set of values as our _ standard set _",
    "( second row in table  [ tab : parameter and runs ] ) .      in the following ,",
    "we describe the results we obtain for our 15  @xmath0 model and how they compare with our reference solution .",
    "the stellar iron core collapses until densities in excess of nuclear saturation density are reached in the center and a shock wave forms .",
    "free streaming neutrinos reduce the total lepton number , while the electron fraction is further decreased by the conversion of electrons into @xmath1 .",
    "the core reaches core bounce on a time @xmath205 after the beginning of the simulation .",
    "the central density at bounce is @xmath206 and the enclosed mass at the shock formation point is @xmath207 . the central density and the initial pns mass compare closely with the corresponding values obtained by _",
    "agile_-`boltztran `",
    "( @xmath208 and @xmath209 , respectively ) , while the collapse time of the reference model is shorter , @xmath210 . in figure",
    "[ fig1 ] , we compare the central values obtained for @xmath50and @xmath211 ( left panel ) , and for the entropy and temperature ( right panel ) , as a function of the central density during the collapse . moreover , in figure  [ fig2 ] , we plot radial profiles of @xmath50 , temperature and radial velocity , as a function of the enclosed mass , for three different times during the collapse ( labeled by their central density ) . in all cases ,",
    "we have obtained a good agreement with the reference solution .",
    "the decrease of @xmath50is well reproduced during the deleptonization process , while neutrino trapping occurs when the central density reaches @xmath212 .",
    "after that , the further decrease of @xmath50is compensated by the growth in @xmath211 , keeping the total lepton number and the entropy roughly constant . in the asl model ,",
    "the entropy per baryon and the electron fraction stay almost constant after neutrino trapping up to core bounce , inside the innermost 0.8  @xmath0 . in",
    "the ` boltztran `  reference solution , the detailed treatment of the equilibrium approach and diffusion process slightly reduces the total lepton number ( @xmath213 ) , compared with the asl solution .",
    "similarly , the entropy per baryon rises just before the formation of the shock wave ( @xmath214 ) .",
    "this difference is due to full thermal and weak equilibrium with matter assumed in the asl treatment .",
    "however , this equilibrium is only approximated and deviations from it leads to a slightly larger matter entropy @xcite .",
    "finally , in the radial velocity profile , we notice a wiggle appearing after neutrino - trapping sets in , around @xmath215 .",
    "this is due to the neutrino stress , computed according to equation  ( [ eqn : vdot opaque regime ] ) , which can overestimate the stress at the interface between the trapped and the free - streaming regime , and neglect additional momentum transfer in optically thin conditions .",
    "after core bounce , the shock wave propagates outwards and iron group nuclei falling into the shock are photo - dissociated into neutrons and protons .",
    "once the shock reaches the relevant neutrinospheres , electron capture on free protons in almost free - streaming conditions causes a peak in @xmath1 luminosity and a fast neutronization of the shocked matter .",
    "later , the absorption of electrons and positrons on free nucleons , together with neutrino pair processes , produces an intense radiation emission of neutrinos of all flavors .",
    "the combined effect of the nuclei photo - dissociation and neutrino emission causes the prompt shock expansion to stop and the shock itself to stall within a few tens of milliseconds .",
    "the absorption of neutrinos inside the so - called gain region increases the shock radius during several tens of milliseconds after the stalling .",
    "however , this energy deposition is not enough to revive the shock and lead to an explosion of the star .",
    "+    figure  [ fig3 ] shows radial profiles of several quantities at core bounce , as a function of the enclosed mass , as well as at two different times after core bounce ( @xmath216 and @xmath217 ) , as a function of the radial distance from the center .",
    "the results obtained with the asl scheme show the most relevant features and the expected typical evolution . we find a good agreement for the location of the shock during the different phases .",
    "we recognize the effect of the passage of the shock wave in the electron fraction profile as well as the result of the neutrino emission and absorption on the entropy profile ( especially around 120 ms , where the increase of the entropy inside the gain region can be seen ) .",
    "a detailed comparison with the reference solution shows several quantitative differences between the two models .",
    "they originate from our approximate treatment , compared to a detailed neutrino transport scheme .",
    "however , the overall qualitative ( and also a partial quantitative ) agreement between the two models is preserved during the entire simulation time .    in the left panel of figure  [ fig4 ]",
    ", we present the temporal evolution of the shock and pns radii ( defined as @xmath218 ) .",
    "overall , @xmath219 and @xmath220 evolutions are in good agreement with the reference model .",
    "in the _ agile_-asl  run , the shock expansion reaches its maximum , @xmath221 , around at 140 ms .",
    "this maximum extension is @xmath222 smaller than the maximum @xmath219 obtained by the _ agile_-`boltztran `  simulation .",
    "we also notice that the latter reaches its maximum earlier ( @xmath223 ) . in general",
    ", the shock evolution is more pessimistic in the asl model than in the reference one .",
    "on one hand , this is a consequence of the smaller pns radius ( e.g. * ? ? ?",
    "* ) , which in turn is due to an overestimated neutrino cooling happening in the semi - transparent regime . on the other hand , the comparison with a ` boltztran `  model including also neutrino - electron scattering ( thin long - dashed lines ) suggests that the smaller shock radius obtained by the asl during the first 30ms after core bounce could also be the result of the effective inclusion of the neutrino thermalization provided by this inelastic process .",
    "this effect , together with the enhanced @xmath1 luminosity around neutrino burst , compensates for the larger enclosed mass at core bounce . finally , despite the slightly smaller extension , the pns contraction rate within the first 300 ms is similar to the one of the reference solution .",
    "the neutrino luminosities and rms energies are displayed in the middle and right panels of figure  [ fig4 ] .    during the collapse phase , electron capture on nuclei",
    "causes the @xmath1 luminosity to rise .",
    "this increase proceeds monotonically up to neutrino trapping ( @xmath224 ) , when the enhanced core opacity and the fast decreasing collapse timescale halt ( and even slightly decrease ) the @xmath1 luminosity .",
    "once the core has bounced and the shock has passed through the relevant neutrinospheres , @xmath225 shows a burst and peaks at @xmath226 .",
    "the same behavior appears in the reference solution obtained by _",
    "agile_-`boltztran `  , even if the luminosities are a bit smaller ( @xmath227 at trapping and @xmath228 at burst ) .",
    "after the neutrino burst , @xmath225 decreases and stabilizes during the accretion phase , @xmath229 . at the same time ,",
    "the @xmath2 luminosity rises and becomes almost equal to @xmath225 during the whole accretion phase .",
    "the same trend is observed in the reference solution and the differences in the absolute values are usually within 10% .",
    "the smaller values obtained by the asl scheme are related with the smaller neutrinosphere radii .",
    "also the rise of @xmath230 proceeds after core bounce , but a few milliseconds before @xmath231 .",
    "this is expected because of the negative @xmath2 degeneracy parameter and to their larger opacity . in the rising phase ( i.e. , within the first @xmath232 ) , the asl scheme underestimates the @xmath5 luminosities , while the agreement increases during the stationary accretion phase .",
    "this discrepancy is due to the difficulty by the asl scheme in modeling the dynamical rise of the @xmath5 s , which are characterized by an extended scattering atmosphere above the radius where neutrino bremsstrahlung and pair production freeze out .",
    "the rms energies obtained by the asl scheme show trends in agreement with the reference solution .",
    "a harder spectrum is obtained for @xmath1 during the collapse phase and for @xmath2 in the first tens of milliseconds after core bounce .",
    "we notice that the rms energies for @xmath5 s are consistent with the values obtained by the reference solution , i.e. without including neutrino - electron scattering . however , the inclusion of this process in _",
    "agile_-`boltztran `  leads to significantly smaller energies",
    "( by @xmath233 ) .",
    "this indicates that this process is responsible for efficiently down - scattering high energy @xmath5 s , while they diffuse out from the core .",
    "the same behavior is visible for @xmath1 s during the latest phases of the collapse .",
    "we briefly explore the sensitivity of the asl scheme with respect to variations of its free parameters ( @xmath234 ) around the calibrated values . to do this",
    ", we consider the 15  @xmath0 model of section [ subsec : 15msun test ] , with its standard set of parameters , and we vary independently each of them .",
    "we choose @xmath235 ( ad_2 model ) and @xmath236 ( ad_5 model ) , @xmath237 ( ab_45 model ) and @xmath238 ( ab_65 model ) , and @xmath239 ( tc_7 model ) and @xmath240 ( tc_54 model ) , representing six independent tests ( see table  [ tab : parameter and runs ] ) .",
    "we notice that the diffusion rates are proportional to @xmath241 , and the chosen diffusion parameters could be also expressed as @xmath242 ( ad_2 model ) and @xmath243 ( ad_5 model ) .",
    "thus , the variations of @xmath186 and @xmath187 span an effective interval of roughly @xmath244 around the calibrated values . for @xmath136 , we choose two values such that @xmath245    in figure  [ fig5 ] , we show the shock and pns radius , the @xmath1 luminosity , and the @xmath1 rms energy ( the corresponding curves for @xmath2 and @xmath5 present analogous trends ) for each of the six tests , in comparison with the reference case . the parameter @xmath187 alters the emission rates everywhere inside the core ( cf . equation  ( [ eqn : r_eff last version ] ) ) , causing a variation of the total neutrino luminosity roughly equal to the variation of the parameter itself .",
    "since it applies equally to all neutrino energies , it does not affect directly the neutrino spectrum and it modifies only marginally the evolution of the neutrino mean energies .",
    "the variations of the rms energies that we observe in ab_45 and ab_65 are mainly due to the different evolution of the radial profiles of the thermodynamical quantities .",
    "a variation of @xmath244 of @xmath187 does not change the qualitative behavior of the simulations , but it changes the shock radius significantly , by a few tens of kilometers .",
    "variations of the pns radius are more restrained .    since the diffusion rates affect mainly the behavior of the deep interior of the collapsing core , the radius of the pns is more sensitively affected by variations of the diffusion parameter @xmath186 .",
    "in particular , an increase of @xmath186 ( ad_5 ) causes a decrease of the diffusion rates .",
    "it also moves outwards the transition region between the diffusion and the production rates ( cf .",
    "equation  ( [ eqn : r_eff old version ] ) ) .",
    "the combined results of these effects are a decrease of the neutrino luminosities ( also in this case , roughly equal to the relative variation of the parameter ) and a significant softening of the neutrino spectrum .",
    "lower neutrino mean energies and luminosities translate into a less efficient neutrino heating .",
    "nevertheless the consequent reduced energy deposition behind the shock is partially compensated by the slower contraction of the pns and of the shock radius , which is expected in the case of reduced neutrino luminosities .",
    "a decrease of @xmath186 ( ad_2 ) provides parallel , but opposite effects .",
    "the variations of the parameter @xmath136 have the smallest impact on the asl scheme results .",
    "in particular , a large increase of @xmath136 from 20 to 54 ( tc_54 ) provides larger neutrino mean energies , but it also increases the emission rates associated with high energy neutrinos , equation  ( [ eqn : r_eff last version ] ) . the more intense energy emission coming from the optically thick region is still not enough to modify significantly the evolution of the pns radius .",
    "however , it almost compensates the more efficient absorption provided in optically thin conditions , and limits the differences in the radial profiles and in the shock conditions .",
    "analogous , but opposite , considerations apply to the tc_7 run .    our brief parametric study has shown that even significant variations of the free parameters of the model ( of the order of @xmath244 ) around the calibrated values do not change qualitatively the results of the simulations for the tested 15  @xmath0 progenitor .",
    "on the other hand , quantitative differences are present : variations of the parameters @xmath187 and @xmath186 have the largest impact , since they modify significantly the neutrino luminosities and mean energies .",
    "the diffusion parameter regulates also the contraction rate of the pns , while it has a less pronounced effect on the neutrino mean energies , compared with @xmath187 .",
    "variations of @xmath136 affect mainly the neutrino mean energies , but have a reduced impact on the overall dynamics .       +    after having presented the calibration of the asl free parameters for the core - collapse of a 15  @xmath0 zams star , we test them with two different progenitors : 12  @xmath0 @xcite and 40  @xmath0 @xcite zams stars . also for these cases , we compare the results obtained in newtonian simulations performed with _ agile_-asl  with the ones of _",
    "agile_-`boltztran `  .",
    "for the 12  @xmath0 case , we include 1.67  @xmath0 from the initial progenitor , distributed over 103 radial zones .",
    "the initial radius extends up to @xmath246 .",
    "for the 40  @xmath0 case , we include 2.60  @xmath0 from the initial progenitor , distributed over 135 radial zones , ranging initially from 0 up to @xmath247 from the center .    the comparison of the collapse profiles between the _ agile_-asl  and the _",
    "agile_-`boltztran `  results shows a very good agreement , for example in the evolution of the central entropy and electron fraction , similar to the one we have observed for the 15  @xmath0 calibration model .",
    "the time necessary to reach core bounce is again larger by 15 - 20% in the asl case : 169 ms and 354 ms , to be compared with 142 ms and 313 ms obtained in the detailed neutrino transport run , for the 12  @xmath0 and 40  @xmath0 case , respectively .",
    "the enclosed mass where the shock forms is larger in the asl models by only a few percents ( 2 - 3 % ) . in figure",
    "[ fig6 ] , we present the evolution of some key quantities during 250 ms after core bounce , for both the 12  @xmath0 ( upper panels ) and the 40  @xmath0 ( lower panels ) progenitor models . for comparison purposes ,",
    "we plot also the results obtained by the _",
    "agile_-`boltztran `  code .",
    "overall , the results obtained with the asl model reproduce qualitatively , and partially quantitatively , the results obtained by the detailed boltzmann neutrino transport .",
    "the agreement is better for the 40  @xmath0 case .",
    "this is due to the fact that , despite the large difference in the zams mass , the core properties of the 15  @xmath0 progenitor show similarities with more massive progenitors and differences with lighter progenitors . in the 12  @xmath0 case ,",
    "the results obtained by the asl scheme look more pessimistic , due to a faster and more intense energy loss above the neutrinospheres during the first tens of milliseconds after core bounce .",
    "the lower @xmath1 and @xmath2 luminosities , and the larger rms energies , observed for @xmath248 , are a consequence of the more compact pns and shock . also for these two progenitor models ( and especially for the 12  @xmath0 one ) ,",
    "the @xmath1 luminosity and shock radius evolutions within the first tens of milliseconds after core bounce follow more closely the results obtained with ` boltztran `  , once the neutrino scattering on electrons and positrons has been included .",
    "the reasons are analog to the 15  @xmath0 case . according to the analysis reported in section  [ sec : parameter variations ] , the more pessimistic results obtained for the 12  @xmath0 case can also indicate that light progenitors would require a slightly different parameter choice to better match results from the reference model ( in particular , larger @xmath186 and @xmath187 ) .",
    "in section [ sec : tests and validity ] , we have compared results from the asl scheme against boltzmann transport in spherically symmetric models . to do that",
    ", we used the same hydrodynamics code , _ agile _  . in order to show the possibility for the scheme to be implemented in multidimensional contexts , we report the following two tests , performed with two different hydrodynamical codes . in the first one , we apply the asl scheme in a multidimensional setting by coupling it to an axisymmetric eulerian and non - relativistic hydrodynamics solver , to model the core - collapse of a stellar iron core . in the second one , we couple our algorithm with a lagrangian hydrodynamics code , and we simulate the same stellar core - collapse in 3d using smoothed particle hydrodynamics ( sph ) . in both cases",
    "we consider a 15  @xmath0 progenitor from @xcite .",
    "we use the @xcite eos with nuclear compressibility @xmath249 mev and the asl standard parameter set , as described in section [ sec : tests and validity ] , with 20 geometrically increasing energy bins between 3 mev and 300 mev .",
    "the different dimensions , implementations and numerical techniques are expected to introduce differences among the multidimensional tests and compared with 1d results ( see section  [ sec : tests and validity ] ) .",
    "nevertheless , during the collapse phase and in the first tens of milliseconds after core bounce , the profiles and the shock shape are expected to behave similarly to spherically symmetric models ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , even if deviations due to pns and prompt convection can appear ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) . at later times ,",
    "multidimensional effects change significantly the dynamics of the system .",
    "several multidimensional ccsn results , employing more sophisticated neutrino treatments , have been published . in the case of axisymmetric models of a 15  @xmath0 model , see e.g. @xcite . for three - dimensional sph models ,",
    "see e.g. @xcite .",
    "they provide reference cases to check the qualitative behavior of our simulations and of the neutrino quantities within a few hundreds milliseconds after core bounce . however , our focus is to demonstrate the versatility and portability of the asl algorithm , along with the validation of the results it provides with 1d detailed simulations , but not to compare to other hydrodynamical codes and among different dimensions .",
    "+             +            the equations of hydrodynamics in spherical coordinates and azimuthal symmetry are evolved with a directionally unsplit finite - volume scheme .",
    "the scheme is of godunov type using a second - order in space well - balanced reconstruction @xcite with characteristic limiting , a hllc approximate riemann solver @xcite and a second - order in time strong stability preserving runge - kutta ( ssp - rk2 ) @xcite time integration .",
    "spurious solutions near strong ( grid aligned ) shocks are avoided by the use the h - correction method by @xcite .",
    "newtonian self - gravity is approximated by a spatially second - order accurate discretization of the monopole term ( i.e. , by spherically averaging the mass density and integrating the resulting one - dimensional profile ) and a spatially second - order five - point discretization of the poisson equation for the deviation from the monopole term .",
    "the asl scheme is coupled to the hydrodynamics by a `` ray - by - ray '' approach : apart from the trapped neutrino components ( @xmath250 ) , which we evolve according the corresponding multidimensional advection equations ( see equations  ( [ eqn : hydro equations])-([eqn : variables and fluxes ] ) ) , the asl scheme is applied as described in section [ sec : the new asl ] along each radial `` ray '' . however , in the present implementation we have neglected the neutrino stress in the momentum equation .",
    "the computational domain includes the innermost 5000 km and the full [ 0,@xmath251 polar realm .",
    "the radial direction is discretized by @xmath252 logarithmically spaced cells : @xmath253 , @xmath254 , @xmath255 and @xmath256 km .",
    "the polar direction is uniformly discretized by @xmath257 cells .",
    "the progenitor is then mapped ( without adding any rotation and perturbations ) onto the computational domain and evolved numerically through collapse , bounce and until @xmath258 ms post - bounce .",
    "the collapse proceeds without any noticeable deviations from spherical symmetry until it is halted by parts of the inner core bouncing at @xmath259 ms after the start of the simulation due to the stiffening of the eos . at that time the central density reaches @xmath260",
    "g @xmath261 .",
    "the enclosed mass at the shock formation radius is @xmath262 , which is slightly lower than in the one - dimensional reference simulation . in figure",
    "[ fig7 ] , we present a detailed comparison of the profiles from the axisymmetric simulation with the one - dimensional reference . at bounce ( left panels ) , we observe that all the quantities are in good agreement .",
    "the 2d simulation has a slightly more compact pns , which we attribute to the fact that we have neglected the neutrino stress . at 30",
    "ms after bounce ( middle panels ) the agreement is still very good up to the negative entropy gradient , which was washed out by prompt convection . at later times",
    ", the two - dimensional simulation deviates from the one - dimensional reference due to multidimensional effects , e.g. , convection and shock instabilities .",
    "this is illustrated in the right panels of figure  [ fig7 ] , where we compare the profiles at 120 ms after bounce .    in the left panel of figure  [ fig8 ] , we show the minimum , average and maximum shock and pns radii . in the same panel , the spherically",
    "averaged net heating rate by electron flavor neutrinos is also shown .",
    "the shock and pns radii evolution can be separated in three distinct phases .",
    "the first lasts from bounce up to @xmath263 ms after bounce .",
    "this phase features the initial very strong acceleration of the shock wave .",
    "when the shock passes the neutrino spheres , the neutronization burst induces strong cooling as indicated by the negative heating rate . during this phase",
    "the evolution is almost perfectly spherically symmetric .",
    "the second phase starts at @xmath263 ms after bounce and lasts up to @xmath264 ms . during this phase the unstable entropy profile left behind by the shock wave triggers strong convective motions , i.e. , the so - called prompt - convection",
    "this induces anisotropic shock movements , which are visible in the minimum and maximum shock radii .",
    "the effect is also visible in the minimum and maximum pns radii , but to a much lesser extent .",
    "however , the anisotropic shock movements remain mild , i.e. , the difference between minimum and maximum shock radius does not exceed @xmath265 km . in the upper - left panel of figure  [ fig9 ]",
    ", we show a snapshot at @xmath266 ms post - bounce when prompt - convection just sets in . during this second phase",
    ", one observes the appearance and progressive growth of regions below the shock with net neutrino heating . in the right - upper panel",
    "we show a snapshot at 120 ms post - bounce .",
    "it can be seen , that there is an extended heating region below the shock . at this time",
    ", convective motions due to neutrino energy deposition start to set in .",
    "the third and last phase starts @xmath264 ms and lasts until we stopped the simulation . during this phase ,",
    "the energy deposited by the neutrinos triggers strong convective motions .",
    "plumes rise by buoyancy against the continuous accretion flow .",
    "this in turn triggers increasingly strong shock movements and it is illustrated in the two lower panels of figure  [ fig9 ] .    in the central and right panels of figure  [ fig8 ] , we show the neutrino luminosities and rms energies from the axisymmetric simulation .",
    "both quantities agree well with the one - dimensional reference .",
    "moreover , the multidimensional one shows some oscillations in all the quantities after @xmath267 50 ms post bounce .",
    "these oscillations become stronger after @xmath268 ms , especially in the luminosities .",
    "we attribute these differences again to multidimensional effects .",
    "the calculation is performed using our sph code , ` sphynx ` , that solves the euler equations derived from a variational principle ( see , e.g. , * ? ? ? * and references therein ) . `",
    "sphynx ` uses high order interpolating kernels , namely the @xmath269 kernels with @xmath270 @xcite , and an improved gradients evaluation based in the integral approach iad@xmath271 @xcite .",
    "three dimensional gravity is calculated with a hierarchical tree structure created using the barnes - hut algorithm @xcite , and the neutrino treatment is handled with a three dimensional version of the asl treatment presented in section  [ sec : the new asl ] .      to evolve the system with `",
    "sphynx ` we solve the hydrodynamical equations in lagrangian form , including a gravitational and a neutrino source term . in the momentum equation , we add the total neutrino pressure , equation  ( [ pnu1 ] ) , to the plasma pressure .",
    "therefore , the stress provided by the trapped neutrinos is directly taken into account .",
    "the evolution of each @xmath53 is provided by an energy equation ( similar to the equation for the plasma internal energy @xmath57 ) which consistently uses the neutrino pressure @xmath272 .    from the position of the sph particles and the eos",
    ", we compute the local density , gradient of pressure , gravitational potential and internal energy . moreover , each particle carries information regarding the electron fraction , @xmath50and the neutrino trapped components , @xmath273 ) .",
    "similarly to the method presented in section  [ sec : the new asl ] , the asl scheme ultimately provides the rates of change for these quantities ( @xmath274 , @xmath79 , @xmath80 ) and for the internal energy ( @xmath275 ) .",
    "the abundances of electrons and neutrinos are evolved explicitly , while the implementation of the energy equation for @xmath53 is described in appendix  [ appb ] .",
    "most of the quantities which are needed to compute the previous terms are local , so the implementation of the asl scheme in the sph structure is straightforward and directly done in 3d with very few modifications of the hydrodynamical part of the code .",
    "the only non - local quantities are the spectral optical depths , @xmath276 and @xmath277 , and the spectral neutrino densities , @xmath278 , used in the calculation of the non - local absorption rates , @xmath149 , equation  ( [ eqn : heating term outside ] ) ) .",
    "to compute the optical depths we use the expected quasi - spherical symmetry of a collapsing stellar core by defining a one dimensional radial grid . on this grid",
    "we calculate the spherical averages of the neutrino spectral mean free paths ( which are computed locally in 3d , at each sph particle position ) .",
    "then , we integrate @xmath279 radially , from the external edge up to each radial position to obtain the radial optical depth .",
    "finally , the spherically symmetric optical depth is mapped back on the three dimensional sph particle distribution , interpolating with respect to the distance from the center of mass . using the 3d density as interpolation variable led to no significant differences . regarding the neutrino densities",
    ", we also consider them to be spherically symmetric , and to evaluate them we calculate the spectral number luminosity via performing a radial integration over all the particles sorted from lower to higher radius .",
    "we set up a ccsn sph simulation with 200,000 particles , using newtonian gravity .",
    "we map the spherically symmetric progenitor model into a three dimensional quasi - random sobol distribution of equal mass particles .",
    "we simulate @xmath280 of mass and up to @xmath281 km in radius .",
    "next we perform an angular relaxation of the system by allowing the particles to move , but with fixed radius .",
    "in this way we erase artificial gradients of pressure formed by random clumps of particles , and obtain clean radial profiles that adjust to the initial 1d model .",
    "the dynamics of the collapse and of the early post - bounce phase are in very good agreement with the previous results .",
    "the electron fraction in the center of the pns decreases until it reaches @xmath282 .",
    "when the central density becomes @xmath283  g  @xmath284 , the core bounces and a shock wave forms at the surface of the newly born pns .",
    "more specifically , the shock is formed at @xmath285  km , which corresponds to an enclosed mass of @xmath286 of unshocked material .    in figure",
    "[ fig10 ] , we present radial profiles of radial velocity ( left column ) , electron fraction ( central column ) and entropy ( right column ) , at four different times from core bounce up to 100ms . each point in the panels represents one of the sph particles . from the low dispersion of the profiles at bounce , we can see that the collapse preserves spherical symmetry , as expected .",
    "we notice the position of the shock wave from the entropy spike and from the corresponding starting deleptonization in the @xmath50profile . as the shock proceeds ,",
    "multidimensional effects and inhomogeneities appear and grow inside the shocked material .",
    "this effect can be seen from the spread of particles in the profiles of all represented quantities in the second row .",
    "after 50 ms the initial prompt convection has been quenched and the evolution proceeds more steadily .",
    "later on , convection slowly settles again in the shocked material , but with a longer timescale , which can be seen in the profiles of radial velocity and @xmath50 as a increased scatter of the particles ( last row ) .",
    "the shape and the evolution of multidimensional instabilities can be better seen in figure  [ fig11 ] . in this series of snapshots ,",
    "we project onto the @xmath287 plane all the particles included in a thin layer of 20  km around the equatorial plane ( @xmath288 ) , for the same time steps used in figure  [ fig10 ] .",
    "the size of the box is 200  km side .",
    "material processed by the shock is slowed down , deleptonized , and accreted onto the hot pns . at 17  ms",
    "we show the development of a transitory violent convection that comes right after the shock launch , which in this snapshot has reached the outer edge of the plot , at @xmath289  km . at 50  ms",
    "the convection modes have been quenched and the pns accretes with a steady flow .",
    "this leads to the more evolved image at 100  ms , where accretion occurs smoothly on a slowly compactifying pns . as time proceeds , the accretion and compression of matter increases the temperature above the surface where the shock was launched .",
    "the low numerical diffusion of sph helps keeping the heat located in this region .",
    "the strong deleptonization via neutrino emission can be seen at work in all snapshots , even at 17  ms , where evident 3d features occur , showing that the asl is working correctly in multidimensional simulations .    in the left panel of figure  [ fig12 ]",
    ", we show the evolution of the pns radius ( black line ) and of the shock radius ( red line ) as a function of time after bounce .",
    "the pns shows a stable evolution with a slowly decreasing radius , corresponding to a more compactified configuration due to accretion and cooling .",
    "the shock position is determined within the local resolution as the radius at which the artificial viscosity ( av ) peaks .",
    "the av is specifically designed to dissipate energy only when shocks are present .",
    "we saw in all of our simulations that , once the shock is formed and launched , the av is approximately two orders of magnitude higher at the shock position than in the surrounding matter .",
    "the overall evolution of the shock is similar to the spherical results , with a fast expansion reaching 100  km within the first 5  ms , and after some oscillations , triggered by 3d convection , it settles around 150  km . in the same figure",
    ", we also present the time evolution of the local cooling and heating rates color - coded .",
    "the thin white region between the cooling ( blue ) and the heating ( red ) regions is the location of the gain radius , which settles around 100  km at 50  ms after bounce and slowly recedes , while the neutrino heating sets in behind the shock .    in the central and right panels of figure  [ fig12 ]",
    ", we show the temporal evolution of the neutrino luminosities and rms energies , respectively , calculated during our sph simulation with the asl scheme .",
    "the obtained results agree well with the 1d simulation performed with the asl scheme .",
    "in particular , in the luminosity evolutions we distinguish all relevant features expected in the collapse , burst and accretion phases .",
    "also the rms energies have an evolution that corresponds very well with the results obtained with the reference 1d model , and their hierarchy is preserved through the simulation .",
    "another feature which looks interesting is the oscillation in the luminosities within the first milliseconds after neutrino burst : they appear in all three curves and they are related to violent convection inside the pns during the very early post - bounce phase .",
    "prompt , violent convection inside the pns was also observed , for example , by @xcite in 2d sph simulations , and more recently by @xcite and @xcite ) .",
    "this feature deserves a deeper investigation ( see , e.g. , the analysis performed by @xcite and @xcite ) .",
    "we have presented the advanced spectral leakage ( asl ) scheme .",
    "this provides an approximate treatment for the neutrino transport problem in astrophysical contexts , like the core - collapse of massive star or the merger of compact objects .",
    "the goal of the scheme is to provide an efficient and physically motivated treatment that contains all the major aspects of neutrino emission and absorption , with a level of accuracy lower than other more sophisticated ( multidimensional ) neutrino transports ( like , for example , m1 schemes , mgfld schemes or idsa ) , but higher than the classical gray leakage schemes .",
    "it allows the application to different astrophysical contexts , codes , and geometrical dimensions , with a reduced computational cost . due to its effective nature",
    ", details of the neutrino transport can not always be reproduced .",
    "nevertheless , it is optimal : 1 ) to study problems where a spectral neutrino treatment is required , but the details of the neutrino behavior are of secondary importance ; 2 ) to perform extensive parametric or high - resolution studies , which are still computationally too costly in multidimensional simulations with detailed neutrino transports ; 3 ) to accomplish preparatory and exploratory tests ; 4 ) during the developing and testing of a hydrodynamic code , when the usage of an easily verifiable , but still reliable neutrino treatment could be useful ; 5 ) to study complex and very dynamical systems in which , due to the lack of symmetries , other more sophisticated neutrino treatments are still not available .    due to its approximate nature ,",
    "it is not well suited to investigate aspects where the details of the neutrino transport are crucial ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "moreover , since it avoids the solution of the transport problem in the diffusive regime by estimates of the diffusion timescales , it is not designed to study the detailed cooling of compact objects , especially over long timescales @xcite .",
    "we have developed and tested the scheme against reference models provided by numerical solutions of the boltzmann equation .",
    "we have explored three progenitors with 12,15 and 40  @xmath0 zams masses .",
    "the 15  @xmath0 case has been more extensively studied to calibrate the free parameters of the scheme .",
    "we have also investigated the impact of the variation of their values on the obtained results .",
    "usually , the changes we have tested produced differences qualitatively in agreement with what we expected .",
    "large quantitative discrepancies are observed when the parameter values differ significantly from the calibrated ones .",
    "the 12  @xmath0 and 40  @xmath0 cases have been used to show the robustness of the calibrated parameters with respect to the progenitor model .",
    "overall , the radial profiles of several hydrodynamical and thermodynamical quantities obtained by the asl scheme show a good agreement with the reference solutions during the whole simulated period ( from the collapse to the neutrino heating phase ) .",
    "small differences are present during the collapse phase and in the prompt shock expansion , while in the neutrino heating phase , where a detailed treatment would be required to model with accuracy both the neutrino emission and absorption , differences tend to grow .",
    "usually , the shock position is well reproduced , with typical differences not larger than @xmath290 even at later times ( larger discrepancies have been observed only for the 12  @xmath0 case ) .",
    "the profiles of electron fraction and entropy are the ones that present the most notable differences , even though some differences can be interpreted as radial or temporal shifts .",
    "we have also compared the temporal evolution of the neutrino luminosities and mean energies , for all neutrino flavors .",
    "again , the most relevant features are present also in the approximate results , especially for @xmath1 s .",
    "quantitative differences are nevertheless visible , especially in the rapid growth of @xmath2 s and @xmath5 s in the early post - bounce phase .",
    "the behaviors and the values we have obtained for the rms energies of @xmath1 and @xmath2 are consistent with the reference solution .",
    "this is true especially in the neutrino heating phase , where describing correctly the mean neutrino energies is crucial to model the neutrino absorption in the optically thin region .",
    "we have also shown that the scheme can be applied , without conceptual changes , to different types of codes and to different spatial dimensions . in this respect ,",
    "we have implemented and tested it in multidimensional core - collapse models using an axisymmetric eulerian grid code and a three - dimensional lagrangian sph code .",
    "these models agrees with our spherically symmetric solution during the collapse and in the early post - bounce phase .",
    "multidimensional features appear in the post - bounce phase and they agree ( at least , at a qualitative level ) with published results obtained in multidimensional models employing more detailed neutrino transport .",
    "in fact , the asl treatment have already been applied to multidimensional ccsn models @xcite and to the study of the aftermath of neutron star mergers @xcite .",
    "the scheme presents a modular structure which allows the inclusion of new neutrino reactions and opacities , as well as the possibility to include more sophisticated treatments ( for example , for the reconstruction of the trapped distribution functions or for the neutrino thermalization process ) , without changing its basic features .",
    "the inclusion of additional neutrino reactions , like neutrino - electron scattering , or of some relevant relativistic and doppler effects ( e.g. , * ? ? ? * and references therein ) in the asl scheme will be carried out in the nearby future .",
    "the authors thank a. arcones , e. gafton , m. liebendrfer , s. rosswog and f - k .",
    "thielemann for useful discussions and comments about this work .",
    "ap is supported by the helmholtz - university investigator grant no .",
    "vh - ng-825 .",
    "he also thanks the university of basel and eth zrich for their hospitality .",
    "rc acknowledges the support from the hp2c supernova project , the european research council ( fp7 ) under the erc advanced grant agreement n 321263 - fish , and the diaphane project within the platform for advanced scientific computing ( pasc ) .",
    "rc and rk thank tu darmstadt for its hospitality .",
    "ap , rc and rk acknowledge the use of computational resources provided by the swiss supercomputing center ( cscs ) , under the allocation grant s414 .",
    "the authors thank also m. liebendrfer for the access to ` boltztran `  runs , and acknowledge the support of scicore ( http://scicore.unibas.ch/ ) scientific computing core facility at university of basel , where some of the calculations were performed .",
    "rk acknowledges the computing resources provided by the brutus and euler clusters at ethz .",
    "in this appendix , we present our implementation of the neutrino pair processes , eqs .",
    "( [ eqn : ep annihilation ] ) and ( [ eqn : bremsstrahlung ] ) , in the context of the asl scheme .",
    "our goal is the computation of the associated emissivities , @xmath291 and absorptivities , @xmath292 .",
    "these quantities are necessary to compute the local mean free paths , eqs .",
    "( [ eqn : lambda tot ] ) and ( [ eqn : lambda eff ] ) , the production and diffusion timescales equations  ( [ eqn : tprod ] ) and ( [ eqn : diffusion timescale ] ) , and the production rates , equation  ( [ eqn : r_prod definition ] ) .",
    "we start from the expression of the collision integral for pair processes in the boltzmann equation for the neutrino species @xmath103 ( see , e.g. , @xcite or @xcite ) : @xmath293 where @xmath104 denotes the antiparticle of @xmath103 , @xmath294 and @xmath295 the neutrino momenta , @xmath296 and @xmath297 the neutrino distribution functions , and @xmath298 and @xmath299 the kernel of the pair reactions .",
    "to compute the local emissivities , we consider the first term in the integral of equation  ( [ eqn : pair collision term ] ) and we perform the integral over the @xmath104 phase space , neglecting pauli blocking factors for @xmath104 in the final state , since the production rate is mainly relevant in the optically thin region : @xmath300 for the absorptivities , we consider the right term of the integral in equation  ( [ eqn : pair collision term ] ) , and we integrate it over the phase space of @xmath104 , @xmath301 assuming that @xmath297 is described by fermi - dirac distribution functions in weak and thermal equilibrium . within this assumption",
    ", we recover the correct limit in the diffusive regime , where the calculation of the mean free path and of the optical depth are more relevant . in the optically thin limit , where the actual distribution functions are expected to differ significantly from fermi - dirac distributions ,",
    "our approach is expected to overestimate the absorptivity due to pair processes .",
    "this would lead to a smaller @xmath302 .",
    "however , we have tested that , for the corresponding relevant thermodynamical conditions , @xmath302 is still significantly larger than the mean free path due to assorption or scattering on nucleons .",
    "moreover , @xmath302 is always much larger than the linear dimension of the system .",
    "thus , our overestimated absorptivities in optically thin conditions do not affect critically the location of the neutrino surfaces .",
    "the reaction kernels , @xmath299 and @xmath298 , are calculated following @xcite for the bremsstrahlung process , and @xcite for the pair annihilation process .",
    "the calculation of the integrals ( [ eqn : pair emission ] ) and ( [ eqn : pair absorption ] ) during runtime would be by far the most expensive part of the rate computation .",
    "thus , we decide to tabulate these emission and absorption rates , and to interpolate them during the program execution .",
    "we compute them as a function of the matter density , electron fraction and temperature . for our tables",
    "we consider a three - dimensional grid , where we uniformly sample : i ) the logarithm of the matter density , with 104 points between @xmath303 and @xmath304 ; ii ) the electron fraction , with 72 points between 0.0 and 0.56 ; iii ) the logarithm of the matter temperature , with 31 points between 0.1 mev and 100 mev .",
    "we perform the integral over the neutrino energy by splitting the @xmath305 integration interval into two segments , @xmath306 and @xmath307 , with @xmath308 . for the second ,",
    "improper integral , we perform the change of variable @xmath309 . then , we integrate each of the two integrals using the gauss - legendre quadrature with 16 points .",
    "the interpolation at runtime is accomplished by a trilinear interpolation method .",
    "in this appendix , we present our implementation of the equation that evolves @xmath53 in the sph implementation of the asl . in the following ,",
    "all sph equations use iad@xmath271 for calculating derivatives @xcite . to make a conversion to the traditional sph prescription simply substitute all @xmath310 by @xmath311 .",
    "the trapped neutrino energy @xmath53 is evolved according to @xmath312 from equation  ( [ sphznu ] ) it is clear that the variation of @xmath53 consists of two contributions : the first term is is due to the @xmath313 work and can be calculated using a sph equation similar to the sph ( baryonic ) energy equation , which takes into account the neutrino pressure ( instead of the baryonic pressure ) and the density changes of the fluid .",
    "the second one is the source term provided by the asl scheme and takes into account the rate of change of energy of the trapped neutrinos due to production and diffusion . in overall , evolving independent equations for @xmath80 is equivalent to split the equation for the total internal energy @xmath314 in two components : baryonic and neutrinos .",
    "the baryonic part is accounted with a regular sph equation for specific internal energy @xmath57 , while the neutrino component is calculated with :      where @xmath316 is the particle index , @xmath51 is the velocity vector , and @xmath317 is the grad - h term .",
    "then , @xmath318 could be calculated using the same integration method used for the specific internal energy .    although this scheme is quite straightforward , in order to calculate the new @xmath53 we evaluate the rate of change @xmath80 , which in fact depends on @xmath53 itself via @xmath272 ( equation  [ pnu1 ] ) .",
    "therefore , we opted for developing a semi - implicit scheme that preserves the consistency between both magnitudes at a very low computational cost . noting that our objective is @xmath319 we can now substitute equation  ( [ pnu ] ) into equation  ( [ eqn : energysph2 ] ) to explicitly show its dependence on @xmath318 .",
    "taking into account all sources we can write :          equation  ( [ znueq ] ) shows a very stable evolution for @xmath53 in all the simulations and it provides consistent values for the neutrino pressure and the neutrino energy by construction .",
    "after its evaluation , we use the new @xmath318 to calculate , via equation  ( [ pnu ] ) , the neutrino pressure @xmath272 that is afterwards included in the momentum equation via adding it to the baryonic pressure ."
  ],
  "abstract_text": [
    "<S> we present an advanced spectral leakage ( asl ) scheme to model neutrinos in the context of core - collapse supernovae and compact binary mergers . based on previous gray leakage schemes </S>",
    "<S> , the asl scheme computes the neutrino cooling rates by interpolating local production and diffusion rates ( relevant in optically thin and thick regimes , respectively ) , separately for discretized values of the neutrino energy . </S>",
    "<S> neutrino trapped components are also modeled , based on equilibrium and timescale arguments . </S>",
    "<S> the better accuracy achieved by the spectral treatment allows a more reliable computation of neutrino heating rates in optically thin conditions . </S>",
    "<S> the scheme has been calibrated and tested against boltzmann transport in the context of newtonian spherically symmetric models of core - collapse supernovae . </S>",
    "<S> asl shows a very good qualitative and a partial quantitative agreement , for key quantities from collapse to a few hundreds of milliseconds after core bounce . </S>",
    "<S> we have proved the adaptability and flexibility of our asl scheme coupling it to an axisymmetric eulerian and to a three - dimensional sph code to simulate core - collapse . </S>",
    "<S> therefore , the neutrino treatment presented here is ideal for large parameter - space explorations , parametric studies , high - resolution tests , code developments , and long - term modeling of asymmetric configurations , where more detailed neutrino treatments are not available or currently computationally too expensive . </S>"
  ]
}