{
  "article_text": [
    "a junction between two superconductors responds to an imposed magnetic flux @xmath0 by producing a chain of circulating current vortices , known as josephson vortices.@xcite the critical current @xmath7 oscillates with period @xmath8 and amplitude @xmath9 .",
    "these socalled fraunhofer oscillations are a macroscopic quantum interference effect , first observed in 1963 in a tunnel junction.@xcite the effect is now used as a sensitive probe of ballistic transport and edge currents in graphene and topological insulators.@xcite    since the self - field of the current vortices is typically too weak to screen the imposed magnetic field @xmath10 from the junction area , the arrangement of josephson vortices is governed by quantum interference  unaffected by the classical electrostatics that governs the two - dimensional ( 2d ) abrikosov vortex lattice in the bulk superconductor.@xcite the fundamental question addressed here , is whether quantum interference by itself is capable of producing a 2d vortex lattice in a josephson junction .",
    "it is known that the linear arrangement of the vortices along the superconducting interface is modified by insulating boundaries,@xcite in a junction of lateral width @xmath11 comparable to the separation @xmath5 of the interfaces .",
    "but in wide junctions ( @xmath12 ) , when boundary effects are irrelevant , only linear arrangements of josephson vortices are known.@xcite    we have discovered that a 2d josephson vortex lattice appears when the circular fermi surface acquires a square or hexagonal distortion .",
    "such a warped fermi surface has flattened facets that produce a nonisotropic velocity distribution of the conduction electrons , peaked at velocity directions normal to the facets .",
    "analytical and numerical calculations of the supercurrent distribution in the high - field regime ( magnetic length @xmath4 less than @xmath5 ) reveal the appearance of multiple rows of vortex - antivortex pairs , forming a 2d bipartite rectangular lattice in the normal region with lattice constant @xmath13     on a square lattice with a half - filled band and a square fermi surface ( lattice constant @xmath14 , normal region of size @xmath15 , band width @xmath16 , fermi velocity @xmath17 , resulting in @xmath18 transverse modes per spin direction at the fermi level , superconducting gap @xmath19 , zero phase difference ) .",
    "the two panels are for a weak and strong perpendicular magnetic field , both at a low temperature @xmath20 in the short - junction regime @xmath21 .",
    "the cyclotron radius @xmath22 remains large compared to @xmath5 also for the strongest fields considered , @xmath23 .",
    "a bipartite square lattice of vortex - antivortex pairs in the normal region ( lattice constant @xmath24 ) forms in the lower panel .",
    "notice the edge reconstruction of the vortex lattice , producing an edge channel of width @xmath25 large compared to @xmath26 .",
    "this edge channel results purely from magnetic interference , it is unrelated to the skipping orbits along the edge that would form in higher fields ( when @xmath27 ) . ]    as shown in fig .",
    "[ fig_vortexlatticesim ] ( resulting from a numerical simulation discussed in sec .  [ numerics ] ) , in the weak - field regime @xmath28 there is only a single row of @xmath29 vortex - antivortex pairs .",
    "however , when @xmath30 drops well below @xmath5 multiple rows of vortex - antivortex pairs appear .",
    "the appearance of this 2d vortex lattice is associated with a crossover from a @xmath31 to a @xmath32 decay of the amplitude of the fraunhofer oscillations .",
    "in contrast , for a circular fermi surface the amplitude crosses over to an accelerated @xmath33 decay when @xmath34.@xcite    the outline of this paper is as follows . in secs .  [ description ] and [ semiclassics ]",
    "we formulate the problem of magnetic interference in a ballistic josephson junction and present the semiclassical analytical solution for the current distribution .",
    "the resulting vortex lattice is described in sec .",
    "[ currentvortices ] , far from the lateral boundaries . as shown in sec .",
    "[ edgechannel ] , within a magnetic length @xmath30 from the boundaries there is a lattice reconstruction that produces an edge channel purely as a result of quantum interference , at magnetic fields that are still so weak that the curvature of the trajectories due to the lorentz force can be neglected . because of the edge channel the amplitude of the fraunhofer oscillations decays as @xmath35 rather than as @xmath36 , see sec .",
    "[ highbdecay ] . in sec .",
    "[ numerics ] we test the semiclassics with a fully quantum mechanical solution of a tight - binding model .",
    "this numerical simulation also allows us to assess the sensitivity of the results against the effects of disorder and nonideal ns interfaces .",
    "we conclude in sec .",
    "[ conclude ] .",
    ", length @xmath5 ) connecting two superconductors at a phase difference @xmath37 .",
    "a perpendicular magnetic field @xmath10 is applied to the normal region .",
    "electron trajectories used in the semiclassical calculation of the supercurrent density are indicated . ]",
    "we consider a two - dimensional ( 2d ) normal metal ( n ) layer in the @xmath38@xmath39 plane , covered by two superconducting electrodes ( @xmath40 and @xmath41 ) a distance @xmath5 apart ( see fig .  [ fig_diagram ] ) .",
    "the proximity effect induces an excitation gap @xmath42 in the s - region @xmath43 , @xmath44 , producing a discrete excitation spectrum in the n - region @xmath43 , @xmath45 .",
    "we work in the short - junction regime @xmath46 , with @xmath47 the superconducting coherence length induced by the proximity effect .",
    "( the short - junction regime is chosen for simplicity , we do not expect our qualitative findings to change when @xmath5 becomes longer than @xmath48 . ) the lateral width @xmath11 of the junction is @xmath49 , it may be comparable to @xmath48 .",
    "the gap @xmath50 in the bulk superconductors is assumed to be much larger than @xmath42 , with a bulk coherence length @xmath51 much smaller than @xmath48 .    a perpendicular magnetic field @xmath10 ( magnetic length @xmath4 ) produces oscillations in the critical current of the josephson junction ( fraunhofer oscillations ) , periodic with period @xmath8 in the enclosed flux @xmath52 .",
    "we assume that the magnetic field is screened from the s - region by a short screening length in the bulk superconductors , even in the high - field regime @xmath53 .    in the analytical calculation",
    "we take the semiclassical limit @xmath54 , in which bound states in the junction can be associated with classical trajectories .",
    "the junction is ballistic ( no impurity scattering ) , so the trajectories are arcs of cyclotron radius @xmath55 .",
    "we assume that @xmath56 is sufficiently large that the ratio @xmath57 remains @xmath58 for the largest fields considered , so we neglect the curvature of the trajectories in the analytical calculation ( but not in the numerics ) .",
    "in particular , skipping orbits along the edge play no role in our analysis .    the single - electron dispersion relation @xmath59 has a nonisotropic dependence on the 2d wave vector @xmath60 , resulting in a nonisotropic distribution of the velocity @xmath61 over the fermi surface .",
    "our analysis is general , but for a specific example we consider the warping of the fermi surface on a square lattice ( unit lattice constant ) , with dispersion relation @xmath62    the fermi surface is deformed from a circle to a square as we raise the fermi energy from the bottom of the band to the band center . for later use",
    "we record the relation at the fermi energy @xmath63 between @xmath64 and the angle of incidence @xmath65 on the ns interface : @xmath66",
    "in semiclassical ( wkb ) approximation@xcite a bound state at energy @xmath67 corresponds to a periodic classical trajectory that traverses the junction , accumulating a phase shift that is a multiple of @xmath68 .",
    "we distinguish two types of periodic trajectories , one in which an _ electron _ propagates from superconductor @xmath40 to @xmath41 , is andreev reflected as a hole and retraces its path to @xmath40 , and another in which a _ hole _ propagates from @xmath40 to @xmath41 and retraces its path as an electron .",
    "the first path is indicated by @xmath69 , the second path by @xmath70 .    for a given periodic trajectory",
    "the total phase shift is given by @xmath71 the @xmath72-dependent term , which has the same sign for @xmath73 , is the phase shift accumulated over a penetration depth in the superconductor ( in the andreev approximation@xcite @xmath74 ) .",
    "the @xmath75-dependent terms consist of the contribution from the pair potential in @xmath76 ( phase difference @xmath37 ) and the phase shift @xmath77 accumulated in the n - region from the vector potential @xmath78 .    in the short - junction regime",
    "@xmath46 we may neglect the phase shift in n arising from the energy difference @xmath79 of electron and hole.@xcite for @xmath80 the ( spin degenerate ) bound state corresponding to this periodic trajectory is at energy @xmath81 with @xmath82    a tube of width of the order of the fermi wave length , extending along the trajectory that passes through the point @xmath83 at an angle @xmath65 with the @xmath39-axis , can be thought of as a single - mode wave guide connecting the two superconductors . in thermal equilibrium at temperature @xmath84 the single - mode supercurrent is given by@xcite @xmath85 including a factor of two from the spin degeneracy .",
    "the trajectory dependence enters via the phase shift @xmath86 . notice that , notwithstanding the appearance of the half - phases @xmath87 , the supercurrent is @xmath68-periodic in @xmath88",
    " as it should be .    the total supercurrent @xmath89 through the josephson junction follows upon integration of eq .",
    "over the phase space of the propagating modes at the fermi level , with measure @xmath90 : @xmath91 there is no dependence of @xmath89 on @xmath92 because of current conservation .    in zero magnetic field",
    "@xmath93 the dependence of @xmath94 on @xmath95 disappears , so we recover the familiar expression@xcite @xmath96 for the supercurrent in a ballistic josephson junction .",
    "the zero - temperature critical current , reached at @xmath97 , is @xmath98    we also require the spatial distribution of the supercurrent density . to avoid notational complexity",
    "we assume that there is a one - to - one relation between @xmath99 and @xmath100 .",
    "this applies to a warping of the fermi circle that keeps it singly - connected and convex . for a circular fermi surface",
    "the measure @xmath101 . upon warping",
    "we have instead @xmath102 with a nonuniform angular profile @xmath103 .",
    "the current density can then be written as @xmath104 with @xmath105 a unit vector in the direction of motion ( note that @xmath65 is the angle with the @xmath39-axis , see fig .",
    "[ fig_diagram ] ) .",
    "this is an intuitive expression , but for the calculations it is more convenient to return to @xmath64 as integration variable , @xmath106",
    "to demonstrate the emergence of a supercurrent vortex lattice we calculate the current density at a point @xmath83 in the normal region , in the limit @xmath107 that boundary effects can be ignored .",
    "( these are considered in the next section . ) at a given angle @xmath65 with the @xmath39-axis ( see fig .",
    "[ fig_diagram ] ) , the phase shift @xmath77 in eq .",
    "equals @xmath108 the resulting current density follows from eq .   upon integration ,",
    "once we have specified the relation between @xmath64 and @xmath65 . to be definite we take a square lattice dispersion , where @xmath109 is given as a function of @xmath64 by eq .  .",
    "results are shown in fig .",
    "[ fig_infinitewide ] .",
    "if the angular distribution @xmath103 on the fermi surface is peaked at angles @xmath110 , the phase shift produces a bipartite rectangular lattice of vortex - antivortex pairs .",
    "( notice that the superconducting phase difference @xmath88 simply shifts the lattice in the @xmath38-direction . )",
    "the lattice constants are @xmath111 parallel to the ns interfaces and @xmath112 in the perpendicular direction , with @xmath26 given by eq .  .    in the square lattice",
    "the fermi surface has a square warping near the center of the band , and if the ns interfaces are oriented along a principal axis one has @xmath113 , so the vortex - antivortex lattice is a square lattice with lattice constant @xmath26 in both directions , see panels @xmath114 in fig .",
    "[ fig_infinitewide ] .",
    "the two - dimensional lattice disappears  leaving only a single row of vortices  if we move away from band center , see panels ( a ) , as the angular distribution @xmath103 broadens around normal incidence . since @xmath115 for @xmath116 this broadening of @xmath103 produces a broad range of perpendicular lattice constants , which smear out the structure of the vortex lattice in the direction perpendicular to the ns interface .",
    "only the @xmath65-independent structure parallel to the ns interfaces remains .",
    "c for @xmath117 , at a much lower temperature of @xmath118 .",
    "the vortex and antivortex sublattices ( red and blue dots ) are no longer equivalent . ]    at the elevated temperatures @xmath119 of fig .",
    "[ fig_infinitewide ] the vortices and antivortices are equivalent , but at lower temperatures this symmetry between the two sublattices is broken , see fig .",
    "[ fig_vortex_lowt ] .",
    "counterclockwise vortices and clockwise antivortices are centered at points where @xmath120 equals , respectively , @xmath121 or @xmath122 , modulo @xmath68 . at elevated temperatures",
    "the current - phase relationship is nearly sinusoidal , with the same slope at @xmath123 ( up to a sign difference ) . at low temperatures the slope at @xmath124",
    "is not much affected , so the antivortices retain their circular shape , but the vortices at @xmath125 see a much larger slope and contract in a square - like shape around the lattice points .",
    "the vortex lattice is modified if we approach the lateral boundaries at @xmath126 .",
    "we still assume @xmath12 , so we can treat the boundaries separately . at each boundary",
    "we impose a hard - wall confinement with specular reflection ( see fig .  [ fig_diagram ] ) .",
    "a trajectory from superconductor @xmath40 to @xmath41 that passes through the point @xmath83 at an angle @xmath65 with the @xmath39-axis is affected by the boundary at @xmath127 if @xmath128 is in the interval @xmath129 in this interval the boundary reflection replaces the expression for the phase shift @xmath77 by    [ gammabetadef ] @xmath130    see app .",
    "[ appabphase ] . the corresponding expression for the boundary at @xmath131 follows from the symmetry relation @xmath132        the resulting supercurrent distribution near the boundary",
    "is shown in fig .",
    "[ fig_finitewidth ] . for @xmath53 an edge channel appears when the fermi surface is strongly warped , see panel ( c ) , becoming less pronounced as the fermi surface becomes more and more circular , see panels ( b ) and ( a ) .",
    "the streamlines in the edge channel inherit their periodicity from the vortex lattice , but the width @xmath133 of the edge channel is larger than @xmath134 .",
    "the net current flowing along the edge channel is sensitive to the phase difference @xmath88 between superconductors @xmath40 and @xmath41 , see fig .",
    "[ fig_edgevector ] .",
    ", for two values of the superconducting phase difference @xmath37 ( all other parameters are kept the same ) .",
    "the left and right panels correspond , respectively , to minimal and maximal current flowing along the edge channel . ]    to understand this edge reconstruction of the vortex lattice , we note that because the phase shift @xmath77 now depends quadratically rather than linearly on @xmath128 , there is a point of stationary phase : @xmath135 at @xmath136 . for a warped fermi surface with @xmath103 peaked at @xmath110",
    "an edge channel extends along the lines of stationary phase , of width @xmath137 the edge channel carries a net current from @xmath40 to @xmath41 that depends on the parameter @xmath138 and the superconductor phase difference @xmath88 : the edge current is minimal for @xmath139 and maximal for @xmath140 , modulo @xmath121 .",
    "( in fig .  [ fig_edgevector ]",
    "we have @xmath141 mod @xmath121 , so minimal and maximal current corresponds to @xmath124 and @xmath142 , respectively . )",
    "as we will show in the next section , this edge current produces a critical current of order @xmath143 , with the anomalously slow decay @xmath144 .",
    "to obtain the critical current @xmath145 of the josephson junction , we first need to calculate at a given phase difference @xmath88 the total supercurrent @xmath146 by integrating @xmath147 over @xmath128 from @xmath148 to @xmath149 . from eq .",
    "we thus have @xmath150    analytical progress is simplest in the high - temperature regime @xmath119 , when the @xmath88-dependence of @xmath94 from eq .",
    "becomes approximately sinusoidal , @xmath151 we assume that the velocity distribution on the fermi surface is symmetric around normal incidence , @xmath152 . because of eq .",
    "we may then restrict the @xmath65-integration in eq .   to positive angles , @xmath153.\\label{icthetaplus}\\end{aligned}\\ ] ]",
    "we thus find that the integrated supercurrent retains a sinusoidal @xmath88-dependence , with critical current @xmath154    in the interval @xmath155 there is at most one boundary collision .",
    "we restrict ourselves to this interval , because the contributions to @xmath156 near grazing incidence are anyway suppressed exponentially at finite temperature .",
    "( all contributions are included in the numerics . )",
    "fixing the arbitrary @xmath39-coordinate at @xmath157 , we have from eqs .   and the expression for @xmath77 that we need :    [ gammaresult ] @xmath158    with @xmath138 defined in eq .  .",
    "the integral over @xmath128 in eq .   can be carried out analytically : @xmath159,\\nonumber\\\\ & \\alpha=\\frac{l\\sqrt{\\tan\\theta}}{l_m\\sqrt\\pi},\\;\\;\\beta'=\\frac{lw}{l_m^2}\\left(1-\\frac{l}{w}\\tan\\theta\\right).\\label{alphabetadef}\\end{aligned}\\ ] ] the functions @xmath160 and @xmath161 are the fresnel cosine and sine integrals , @xmath162 both @xmath163 and @xmath164 tend to @xmath165 for @xmath166 .    if the angular distribution @xmath103 is sharply peaked around @xmath110 , we obtain from eqs .   and",
    "the high - field ( @xmath167 ) critical current @xmath168 with effective junction width @xmath169 and edge channel width @xmath170 . comparing with the low - field ( @xmath171 ) fraunhofer oscillations , @xmath172 we note three differences : the amplitude decays more slowly , @xmath144 instead of @xmath173 ; the flux periodicity is larger by a factor @xmath174 ; and the maxima are phase shifted by @xmath175 flux quantum .",
    "this qualitatively different behavior is illustrated in fig .",
    "[ fig_fraunhofer ] , compare blue and grey curves .",
    "versus the flux @xmath0 through the normal region ( aspect ratio @xmath176 ) , calculated from eq .   for a circular fermi surface ( @xmath177 , red curve decaying @xmath178 ) , and for a square fermi surface ( @xmath179 , blue curve decaying @xmath3 ) .",
    "the low - field fraunhofer oscillations are included for comparison ( grey curve decaying @xmath180 ) . ]    at the other extreme of an isotropic angular distribution , for a circular fermi surface , we obtain the opposite effect : instead of a slower decay of the high - field fraunhofer oscillations the decay is faster , @xmath181 instead of @xmath173 , compare red and blue curves.@xcite this accelerated decay is a known result.@xcite what we have found here is that the switch from a circular to a square fermi surface slows down the decay by a fourth root , from @xmath182 to @xmath183 .",
    "to test the analytical semiclassical theory we have performed numerical simulations of a tight - binding model .",
    "we start from the bogoliubov - de gennes hamiltonian , @xmath184 with the single - particle dispersion @xmath185 on a square lattice given by eq .  .",
    "the pair potential @xmath42 and vector potential @xmath186 are chosen as in fig .",
    "[ fig_diagram ] , with @xmath187 for @xmath45 ( no pairing interaction in the normal region ) and @xmath188 for @xmath44 ( complete screening of the magnetic field from the superconductor ) .",
    "the self - field of the currents in the normal region is neglected , so @xmath186 is entirely due to the externally imposed field @xmath10 .",
    "the orbital effect of the magnetic field is fully included , but we neglect the coupling to the electron spin@xcite and can therefore omit the spin degree of freedom from the hamiltonian .",
    "the @xmath189 matrix green s function @xmath190 is calculated at imaginary energy @xmath191 using the kwant toolbox for tight - binding models.@xcite the expectation value of the current density in thermal equilibrium , @xmath192 is then obtained from a ( rapidly convering ) sum over matsubara frequencies @xmath193.@xcite ( see ref .   for an alternative approach . )",
    "the time - consuming step in this calculation is the calculation of the inverse operator @xmath194 , but once this is done for one value of the superconducting phase difference @xmath88 , we can use dyson s equation to obtain the result for other values of @xmath88 without further inversions .    , zoomed in at the right boundary .",
    "( b ) : at a higher temperature the vortices and antivortices are approximately equivalent . ]    , for the same parameters as fig .",
    "[ fig_vortexlatticesim ] . since @xmath195 along this cut , the plotted @xmath196 is the full current density .",
    "the red and blue dots identify the center of a vortex or antivortex , which are distinct at this low temperature of @xmath197 .",
    "the solid curves are the results of the numerical simulation , the dashed curves are the semiclassical result in the short - junction regime . ]",
    "results for the vortex lattice in the case of a nearly square fermi surface ( @xmath198 ) are shown in figs .",
    "[ fig_vortexlatticesim ] and [ fig_vortexlatticehight ] .",
    "the agreement with the semiclassical result is not fully quantitative , see fig .",
    "[ fig_comparison_lowt_highb ] , but all the qualitative features of the vortex lattice coming out of the analytics are well reproduced in the numerics .",
    "also the @xmath199 decay is recovered in the simulation , see fig .",
    "[ fig_fraunhofersim ] .",
    "versus the flux @xmath0 through the normal region , resulting from the numerical simulation with the parameters of figs .  [ fig_vortexlatticesim ] and [ fig_vortexlatticehight ] .",
    "the minima of the fraunhofer oscillations no longer go to zero at low temperatures ( blue curves ) , because of the skewed current - phase relationship .",
    "the upper panel shows a linear scale , the lower panel a log - log scale with the @xmath200 decay indicated ( black dashed line ) .",
    "( the @xmath2 decay of the conventional fraunhofer oscillations is also included for comparison . ) ]    in both the analytics and numerics so far we took a ballistic josephson junction , without any disorder in the normal region , and ideal ( fully transparent ) ns interfaces .",
    "the numerical simulation provides a way to test for the effects of impurity scattering and nonideal interfaces .",
    "disorder was modeled by adding a random component @xmath201 to the on - site electrostatic potential , drawn uniformly from the interval @xmath202 $ ] . for the tunnel barrier we reduced the hopping amplitude at the two ns interfaces . as shown in fig .",
    "[ fig_fraunhoferdisorder ] , the slow @xmath32 decay persists even if the critical current is reduced substantially by the tunnel barrier .",
    "disorder provides a stronger perturbation , in the form of random sample - specific fluctuations,@xcite but averaged over series of peaks the slow decay persists .",
    "b. the disorder strength or tunnel barrier height is quantified by the reduction of the normal state conductance @xmath203 .",
    "the topmost ( red ) curve corresponds to the ideal case without disorder or tunnel barrier . ]",
    "_ two - dimensional _ vortex lattices are well established for abrikosov vortices in a bulk superconductor,@xcite but josephson vortices in an sns junction were only known to arrange as a _ one - dimensional _",
    "chain.@xcite our key conceptual finding is that the 2d arrangement is hidden by angular averaging over the fermi surface . for",
    "a distribution of angles of incidence peaked at @xmath204 , resulting from a strong square or hexagonal warping of the fermi surface , a 2d lattice develops when the magnetic length @xmath4 drops below the separation @xmath5 of the ns interfaces .",
    "the lattice is bipartite , with a vortex and antivortex in a rectangular unit cell of size @xmath205 parallel to the interface and @xmath206 perpendicular to the interface . for a circular fermi surface",
    "the 2d lattice degrades to a 1d chain .",
    "it would be interesting to search for this 2d josephson vortex lattice in some of the quasi - two - dimensional systems that are known to have a warped fermi surface , such as the hexagonal warping on the surface of a three - dimensional topological insulator.@xcite by way of illustration , fig .",
    "[ fig_hexagon ] shows the vortex lattice calculated for the @xmath207 $ ] surface dispersion of @xmath208,@xcite @xmath209 with the @xmath38-axis ( the ns interface ) oriented along the @xmath210k direction in the brillouin zone .",
    "dispersion relation ( parameters @xmath211 , @xmath212 , @xmath213 , @xmath214 , other parameters and color scale as in fig .",
    "[ fig_vortex_lowt ] ) .",
    "the difference with square warping is that the lattice is rectangular rather than square , with aspect ratio @xmath215 . ]",
    "the vortices could be detected directly by a scanning tunneling probe,@xcite or indirectly through the flux @xmath0-dependent fraunhofer oscillations@xcite  we have found that the transition from a 1d to a 2d arrangement of vortices is accompanied by a slow - down of the decay of the oscillation amplitude from @xmath2 to @xmath216 .",
    "while in the main text we have focused on the current distribution , we note that a 2d lattice structure with the same periodicity appears also in the superconducting pair potential ( see app .",
    "[ apporderparam ] ) and in the local density of states ( see app .",
    "[ appdos ] ) .",
    "a particularly intriguing feature of the vortex lattice is the reconstruction at the edge , resulting in an edge channel of width @xmath25 parametrically larger than the lattice constant .",
    "it is this edge channel that effectively carries the supercurrent when @xmath53 , resulting in the decay scaling as @xmath217 .",
    "notice that the edge channel appears entirely as a result of quantum interference  in contrast to the quantum hall edge channel any orbital effects of the magnetic field play no role here .",
    "we have benefited from discussions with i. muhammad and m. wimmer .",
    "this research was supported by the foundation for fundamental research on matter ( fom ) , the netherlands organization for scientific research ( nwo / ocw ) , and erc starting and synergy grants .",
    "we calculate the aharonov - bohm phase shift @xmath218 accumulated along a trajectory across the josephson junction , from superconductor @xmath40 at @xmath219 to @xmath41 at @xmath220 , including the effects of multiple specular reflections at the side walls @xmath126 . the geometry is shown in fig .  [ fig_diagram ] .",
    "assume that the trajectory starts at @xmath221 from the point @xmath222 , @xmath219 at the lower ns interface , at an angle @xmath223 with the positive @xmath39-axis .",
    "the opposite ns interface at @xmath224 is reached at the time @xmath225 , with @xmath226 the velocity component in the @xmath39-direction ( which does not change at a boundary reflection ) .    in the gauge",
    "@xmath78 the line integral takes the form @xmath227 the time dependence of @xmath228 is given by @xmath229,\\\\ & u(t)=x(0)+v_{\\rm f}t\\sin\\theta(0 ) , \\end{split}\\ ] ] where we have defined @xmath230 as the integer nearest to @xmath231 .",
    "the absolute value of @xmath232 counts the number of boundary reflections up to time @xmath233 . at time",
    "@xmath234 $ ] we have @xmath235,\\ ] ] where @xmath236 is the integer nearest to @xmath237/w$ ] .",
    "integration of eq .",
    "results in @xmath238\\biggr).\\label{gammaapp}\\ ] ] this is sufficient to calculate the total current through the josephson junction , by integrating the current density through the lower ns interface .    to obtain the current distribution within the junction , say at the point @xmath83 , we need to find the corresponding coordinates @xmath239 of the trajectory at the lower ns interface .",
    "the angle @xmath65 at the point @xmath83 equals @xmath240 .",
    "the point @xmath83 is reached at a time @xmath241 after @xmath242 boundary reflections . retracing back the trajectory , we find @xmath243,\\\\ & \\theta(0)=(-1)^{\\nu_0}\\theta .",
    "\\end{split}\\ ] ]    this calculation of the aharonov - bohm phase @xmath77 holds for any number of boundary collisions at @xmath126 . in the main text",
    "we only need the result for a single boundary collision at @xmath127 .",
    "one readily checks that eq .",
    "reduces to eq .   upon substitution of @xmath244 , @xmath245 for @xmath246 or @xmath244 , @xmath247 for @xmath248",
    "the coherent superposition of electrons and holes in an andreev level produces a nonzero order parameter @xmath249 in the normal region , in the absence of any pairing interaction.@xcite in this appendix we show that the amplitude @xmath250 has a 2d lattice structure with the same periodicity as the current vortex lattice studied in the main text .",
    "an andreev level in the sns junction of fig .  [ fig_diagram ] , at the positive energy @xmath251 has a wave function @xmath252 that penetrates into the superconducting regions @xmath44 over a distance @xmath253 in the normal region @xmath45 the wave function has a constant amplitude , given in wkb approximation by@xcite @xmath254 the electron and hole components @xmath255 differ in phase by @xmath256 in accord with the andreev reflection boundary condition at the ns interfaces,@xcite @xmath257 we have defined @xmath258 , so that @xmath259 for @xmath260 .",
    "the electron - hole mode @xmath261 at energy @xmath72 contributes to the superconducting order parameter an amount@xcite @xmath262 integration over the modes gives the full order parameter , @xmath263 this expression has the proper @xmath68-periodicity in the superconducting phase , since @xmath264 and @xmath265 if @xmath266 or @xmath267 is incremented by @xmath68 .",
    "we evaluate @xmath249 in a wide sns junction , at a point @xmath268 far from the lateral boundaries .",
    "a mode passing through this point at an angle @xmath65 relative to the @xmath39-axis has aharonov - bohm phase @xmath269,\\nonumber\\\\ & \\gamma=\\frac{2e}{\\hbar}\\int_{s_1}^{s_2 } \\bm{a}\\cdot d\\bm{l}=\\frac{2l}{l_m^2}(x_0-y_0\\tan\\theta),\\end{aligned}\\ ] ] so that the phase shift is given by @xmath270    , calculated from eq .  .",
    "current vortices and antivortices in fig .",
    "[ fig_vortex_lowt ] correspond to local minima of @xmath250 . ]    for the warped fermi surface of a square lattice ( unit lattice constant , see sec .",
    "[ description ] ) we have @xmath271 the order parameter then results from the integral @xmath272 with @xmath273 .",
    "the resulting 2d lattice structure is shown in fig .",
    "[ fig_orderparameter ] , corresponding to the current vortex lattice of fig .",
    "[ fig_vortex_lowt ] .",
    "to complete the picture , we also demonstrate the development of a 2d lattice structure in the density of states .",
    "the states at @xmath274 contribute @xmath275 $ ] to the local density of states @xmath276 .",
    "the total contribution is @xmath277        99 m. tinkham , _ introduction to superconductivity _",
    "( dover publications , 2004 ) .",
    "j. m. rowell , _ magnetic field dependence of the josephson tunnel current _ , phys .",
    "lett . * 11 * , 200 ( 1963 ) .",
    "s. hart , h. ren , t. wagner , p. leubner , m. mhlbauer , c. brne , h. buhmann , l. w. molenkamp , and a. yacoby , _ induced superconductivity in the quantum spin hall edge _ , nature phys . *",
    "10 * , 638 ( 2014 ) . v. s. pribiag , a. j. a. beukman , f. qu , m. c. cassidy , c. charpentier , w. wegscheider , and l. p. kouwenhoven , _ edge - mode superconductivity in a two - dimensional topological insulator _ , nature nanotech . *",
    "10 * , 593 ( 2015 ) . v. e. calado , s. goswami , g. nanda , m. diez , a. r. akhmero , k. watanabe , t. taniguchi , t. m. klapwijkl and l. m. k. vandersypen , _ ballistic josephson junctions in edge - contacted graphene _ , nature nanotech .",
    "* 10 * , 761 ( 2015 ) .",
    "s. hart , h. ren , m. kosowsky , g. ben - shach , p. leubner , c. brne , h. buhmann , l. w. molenkamp , b. i. halperin , and a. yacoby , _ controlled finite momentum pairing and spatially varying order parameter in proximitized hgte quantum wells _ , arxiv:1509.02940 .",
    "m. t. allen , o. shtanko , i. c. fulga , a. akhmerov , k. watanabi , t. taniguchi , p. jarillo - herrero , l. s. levitov , and a. yacoby , _ visualization of phase - coherent electron interference in a ballistic graphene josephson junction _ , nature phys .",
    "* 12 * , 128 ( 2016 ) .",
    "m. ben shalom , m. j. zhu , v. i. falko , a. mishchenko , a. v. kretinin , k. s. novoselov , c. r. woods , k. watanabe , t. taniguchi , a. k. geim , and j. r. prance , _ quantum oscillations of the critical current and high - field superconducting proximity in ballistic graphene _ , nature phys .",
    "* 12 * , 318 ( 2016 ) .",
    "j. p. heida , b. j. van wees , t. m. klapwijk , and g. borghs , _ nonlocal supercurrent in mesoscopic josephson junctions _ , phys .",
    "b * 57 * , r5618 ( 1998 ) .",
    "u. ledermann , a. l. fauchre , and g. blatter , _ nonlocality in mesoscopic josephson junctions with strip geometry _ ,",
    "b * 59 * , r9027 ( 1999 ) .",
    "v. barzykin and a. m. zagoskin , _ coherent transport and nonlocality in mesoscopic sns junctions : anomalous magnetic interference patterns _ , superlatt",
    ". microstruct . * 25 * , 797 ( 1999 ) .",
    "minsoo kim , dongchan jeong , gil - ho lee , yun - sok shin , hyun - woo lee , and hu - jong lee , _ tuning locality of pair coherence in graphene - based andreev interferometers _ , scientific reports * 5 * , 8715 ( 2015 ) .",
    "j. c. cuevas and f. s. bergeret , _ magnetic interference patterns and vortices in diffusive sns junctions _",
    "lett . * 99 * , 217002 ( 2007 ) .",
    "f. s. bergeret and j. c. cuevas , _ the vortex state and josephson critical current of a diffusive sns junction _ , j. low temp . phys . * 153 * , 304 ( 2008 )",
    ". m. alidoust , g. sewell , and j. linder , _ non - fraunhofer interference pattern in inhomogeneous ferromagnetic josephson junctions _ , phys .",
    "lett . * 108 * , 037001 ( 2012 ) .",
    "m. alidoust and k. halterman , _ proximity induced vortices and long - range triplet supercurrents in ferromagnetic josephson junctions and spin valves _ , j. appl .",
    "phys . * 117 * , 123906 ( 2015 ) .",
    "m. amundsen and j. linder , _ general solution of 2d and 3d superconducting quasiclassical systems : coalescing vortices and nanoisland geometries _ , sci . rep .",
    "* 6 * , 22765 ( 2016 ) .",
    "h. meier , v. i. falko , and l. i. glazman , _ edge effects in the magnetic interference pattern of a ballistic sns junction _ ,",
    "b * 93 * , 184506 ( 2016 ) .",
    "j. bardeen , r. kmmel , a. e. jacobs , and l. tewordt , _ structure of vortex lines in pure superconductors _ ,",
    "phys . rev . *",
    "187 * , 556 ( 1969 ) .",
    "a. f. andreev , _ the thermal conductivity of the intermediate state in superconductors _ , sov .",
    "jetp * 19 * , 1228 ( 1964 ) . at grazing incidence",
    "angles @xmath283 the short - junction criterion is more stringent than @xmath46 , we require @xmath284 . in the analytics",
    "we ignore this complication , but it is fully incorporated in the numerics . c. w. j. beenakker and h. van houten , _ josephson current through a superconducting quantum point contact shorter than the coherence length _ ,",
    "66 * , 3056 ( 1991 ) .",
    "i. o. kulik and a. n. omelyanchuk , _ properties of superconducting microbridges in the pure limit _ ,",
    "j. low temp .",
    "phys . * 3 * , 459 ( 1977 ) .",
    "the @xmath33 decay of the critical current for a circular fermi surface follows upon numerical integration of eq .   with @xmath177 ,",
    "see fig .",
    "[ fig_fraunhofer ] . unlike the @xmath32 decay for a square fermi surface , we have not managed to derive the @xmath33 decay analytically .",
    "as explained in t. yokoyama , m. eto , and yu .  v. nazarov , phys .",
    "b * 89 * , 195407 ( 2014 ) , the influence of the zeeman energy on the josephson effect is quantified by the phase shift @xmath285 . in the magnetic field regime where the cyclotron radius @xmath286 is large compared to the separation @xmath5 of the ns interfaces ( which is the regime of interest here ) , the condition @xmath287 is ensured provided the @xmath288-factor is not much larger than unity . c. w. groth , m. wimmer , a. r. akhmerov , and x. waintal , _",
    "kwant : a software package for quantum transport _",
    ", new j. phys .",
    "* 16 * , 063065 ( 2014 ) .",
    "a. furusaki , _ dc josephson effect in dirty sns junctions : numerical study _ , physica b * 203 * , 214 ( 1994 ) .",
    "p. rakyta , a. kormnyos , and j. cserti , _ magnetic field oscillations of the critical current in long ballistic graphene josephson junctions _ ,",
    "m. z. hasan , h. lin , and a. bansil , _ warping the cone on a topological insulator _",
    ", physics * 2 * , 108 ( 2009 ) .",
    "l. fu , _ hexagonal warping effects in the surface states of topological insulator @xmath289 _ , phys .",
    "lett . * 103 * , 266801 ( 2009 ) .",
    "o. m. auslaender , l luan , e. w. j. straver , j. e. hoffman , n. c. koshnick , e. zeldov , d. a. bonn , r. liang , w. n. hardy , and k. a. moler , _ mechanics of individual , isolated vortices in a cuprate superconductor _ , nature phys .",
    "* 5 * , 35 ( 2009 ) .",
    "a. finkler , d. vasyukov , y. segev , l. neeman , y. anahory , y. myasoedov , m. l. rappaport , m. e. huber , j. martin , and a. yacoby , _ nano - sized squid - on - tip for scanning probe microscopy _ , j. phys .",
    ". ser . * 400 * , 052004 ( 2012 ) .",
    "d. roditchev , c. brun , l. serrier - garcia , j. c. cuevas , v. h. loiola bessa , m. v. miloevi , f. debontridder , v. stolyarov , and t. cren , _ direct observation of josephson vortex cores _ , nature phys .",
    "* 11 * , 332 ( 2015 ) .",
    "f. chiodi , m. ferrier , s. guron , j. c. cuevas , g. montambaux , f. fortuna , a. kasumov , and h. bouchiat , _ geometry - related magnetic interference patterns in long sns josephson junctions _ , phys .",
    "b * 86 * , 064510 ( 2012 ) .",
    "b. crouzy and d. a. ivanov , _",
    "magnetic interference patterns in long disordered josephson junctions _ , phys .",
    "b * 87 * , 024514 ( 2013 ) ."
  ],
  "abstract_text": [
    "<S> the critical current of a josephson junction is an oscillatory function of the enclosed magnetic flux @xmath0 , because of quantum interference modulated with periodicity @xmath1 . </S>",
    "<S> we calculate these fraunhofer oscillations in a two - dimensional ( 2d ) ballistic superconductor  normal - metal  superconductor ( sns ) junction . for a fermi circle </S>",
    "<S> the amplitude of the oscillations decays as @xmath2 or faster . if the fermi circle is strongly warped , as it is on a square lattice near the band center , we find that the amplitude decays slower @xmath3 when the magnetic length @xmath4 drops below the separation @xmath5 of the ns interfaces . </S>",
    "<S> the crossover to the slow decay of the critical current is accompanied by the appearance of a 2d array of current vortices and antivortices in the normal region , which form a bipartite rectangular lattice with lattice constant @xmath6 . </S>",
    "<S> the 2d lattice vanishes for a circular fermi surface , when only the usual single row of josephson vortices remains . </S>"
  ]
}