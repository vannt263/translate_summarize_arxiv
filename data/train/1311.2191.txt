{
  "article_text": [
    "let @xmath0 @xmath1 be an open and bounded set , and consider a function @xmath2 . the neighborhood filter operator is defined by @xmath3 where @xmath4 is a positive constant , and @xmath5 is a normalization factor , intended to allow constants to be fixed points of @xmath6 .",
    "the neighborhood filter ( nf ) is the simplest particular case of other related filters involving local terms , notably the yaroslavsky filter @xcite , the susan filter @xcite introduced by smith and brady , the bilateral filter @xcite of tomasi and manduchi , and the nonlocal means filter ( nlm ) @xcite by buades , coll and morel .",
    "these methods have been introduced in the last decades as efficient alternatives to local methods such as those expressed in terms of nonlinear diffusion partial differential equations ( pde s ) , among which the pioneering approaches of perona and malik @xcite , lvarez , lions and morel @xcite and rudin , osher and fatemi @xcite are fundamental .",
    "we refer the reader to @xcite for a review and comparison of these methods .    among all these filters ,",
    "the neighborhood filter is the simplest , but yet useful , method due to its compromise between denoising quality and computational speed . indeed , although it creates shocks and staircasing effects @xcite , the computational cost is by far lower than those of other integral kernel filters or pde s based methods .",
    "since , usually , a single denoising step of the nonlocal filters is not enough , an iteration is performed according to several choices of the iteration actualization , see ( [ def.gff ] ) and ( [ def.gfv ] ) for two of such strategies .    in this context",
    ", the neighborhood filter and its variants have been analyzed from different points of view .",
    "for instance , barash @xcite , elad @xcite , barash et al .",
    "@xcite , and buades et al .",
    "@xcite investigate the asymptotic relationship between the yaroslavsky filter and the perona - malik pde .",
    "gilboa et al .",
    "@xcite study certain applications of nonlocal operators to image processing . in @xcite , peyr establishes a relationship between the non - iterative nonlocal filtering schemes and thresholding in adapted orthogonal basis . in a more recent paper , singer et al .",
    "@xcite interpret the neighborhood filter as a stochastic diffusion process , explaining in this way the attenuation of high frequencies in the processed images .    in this article",
    ", we reformulate the neighborhood filter in terms of the _ decreasing rearrangement _ of the initial image , @xmath7 , which is defined as the inverse of the _ distribution function _ @xmath8 , see section 2 for the precise definition .    realizing that the structure of level sets of @xmath7 is invariant through the neighborhood filter operation as well as through the decreasing rearrangement of @xmath7 allows us to rewrite ( [ def.nf ] ) in terms of a one - dimensional integral expression , see theorem  [ th.equivalence1 ] .",
    "although from expression ( [ def.nf ] ) is readily seen that only computation on level lines is needed to perform the filtering , the alternative expression in terms of the decreasing rearrangement offers room for further analysis of the iterative scheme .    perhaps , the most important consequence of the rearrangement is , apart from the dimensional reduction , the reinterpretation of the nf as a _ local _ algorithm .",
    "thanks to this , we may prove some properties of the neighborhood filter nonlinear iterative scheme , see ( [ def.gfv ] ) , among which    * the asymptotic behavior of the nf as a shock filter of the type introduced by lvarez et al .",
    "@xcite , combined with a contrast loss effect , see theorem  [ th.pde ] . * the contrast change character of the nf , i.e. the existence of a continuous and increasing function @xmath9 such that @xmath10 , see corollary  [ cor.contrast ] .",
    "as mentioned above , the most salient advantage of the neighborhood filter in its rearranged version is speed .",
    "if @xmath11 denotes the image size in pixels , the complexity of other nonlocal filters such as the _ classical _ nf , the bilateral or the nlm filters are of the order @xmath12 , where @xmath13 depends on different parameters ( window sizes ) used in those models",
    ". a typical value of @xmath13 may be of the order @xmath14 , for the nlm .",
    "however , the complexity of the rearranged version of the nf depends on the number of the initial image intensity levels , which we assume quantized in @xmath15 levels , and on some small constant related to the window size , @xmath4 , resulting in a complexity of the order @xmath16 , being a typical value of @xmath17 of the order @xmath18 .",
    "thus , the complexity of the nf is independent of the image size , once the level lines of the initial image have been identified .",
    "however , denoising quality of the nf is , by far , poorer .",
    "the staircaising effect , always present in algorithms reducing the total variation of the initial image , is especially strong for the nf .",
    "in fact , after several iterations , and depending on the window size @xmath4 , the nf output image concentrates most of its pixels mass on few level sets , producing a segmentation - like effect on the initial image .",
    "a quick explanation of the difference between the nf and the bilateral and nlm filters is that the nf does not retain any local information of the image , diffusing the intensity values just according to the mass of their corresponding level lines .",
    "thus , a pixel belonging to a level line with large mass will retain its value even if it is isolated in a component of the image with different intensity value .    due to this , the neighborhood filter and morphological filters deduced from the topographic map of an image , see for instance the monograph by caselles and monasse @xcite , such as the grain and the killer filters , are also different since the latter use the local geometry of level sets connected components in a fundamental manner .",
    "however , they do share some similitudes in their level set based framework , and this could be used for combining both algorithms . for instance , the isolated small regions belonging to a level line with large mass which remain in the filtered image after the nf application could be removed by morphological procedures , such as opening and closing operators .",
    "the segmentation - like behavior of the nf may be explained in terms of the relationship between the inflexion points of the decreasing rearrangement and the local extreme points of the image histogram , @xmath19 .",
    "thus , since the nf behaves asymptotically as a shock filter , and shock filters accumulate mass in inflexion points , we deduce that the nf works as an histogram based segmentation algorithm .    since for our analysis the gaussian form of the integral kernel is not important",
    ", we consider the following generalization of the neighborhood filter @xmath20 with @xmath21 , and @xmath22 . for the moment , we only assume @xmath23 and @xmath24 to have ( [ def.gf ] ) well defined , although more meaningful conditions will be stated later .",
    "we consider the following iterative schemes , for @xmath25 ( including @xmath26 ) , and @xmath27 :    1 .",
    "iteration with fixed kernel ( linear operator ) , @xmath28 with @xmath29 .",
    "2 .   iteration with varying kernel ( nonlinear operator ) , @xmath30 with @xmath31 .",
    "observe that , for both schemes , we have @xmath32 for all @xmath25 , and therefore the iterations are well defined .",
    "the plan of the article is the following . in section",
    "2 we introduce the notion of decreasing rearrangement and establish the equivalence between ( [ def.gff ] ) and ( [ def.gfv ] ) and its corresponding versions under this transformation .",
    "in addition , we show some examples on the relationship between an image and its relative rearrangement and histogram . in section  3 ,",
    "we prove some qualitative properties of the nonlinear iterative scheme , among which its behavior as a shock filter . in section  4 , we describe the discretization of the continuous model and demonstrate with examples the denoising capabilities of the nf in comparison with the bilateral and nlm filters , and its interpretation as a segmentation - like algorithm . in section  5",
    "we give our conclusions .",
    "finally , let us emphasize that the reformulation of the neighborhood filter we propose produces the same filtered image than that obtained through the classical nf",
    ". however , there are two important advantages in our approach : ( i ) the filtering process is performed through a one - dimensional integral , reducing largely the algorithm complexity , and ( ii ) the rearranged version exposes the nf functioning to a deeper mathematical analysis .",
    "let us denote by @xmath33 the lebesgue measure of any measurable set @xmath34 .    for a lebesgue measurable function @xmath35 , the function @xmath8 is called the _ distribution function _ corresponding to @xmath7 .",
    "function @xmath36 is non - increasing and therefore admits a unique generalized inverse , called the _ decreasing rearrangement_. this inverse takes the usual pointwise meaning when the function @xmath7 has not flat regions , i.e. when @xmath37 for any @xmath38 . in general , the decreasing rearrangement @xmath39\\to{\\mathbb{r}}$ ] is given by : @xmath40 notice that since @xmath41 is non - increasing in @xmath42 $ ] , it is continuous but at most a countable subset of @xmath42 $ ] .",
    "in particular , it is right - continuous for all @xmath43 $ ] .",
    "the notion of rearrangement of a function is classical .",
    "we refer the reader to the textbook @xcite for the basic definitions and to the monograph @xcite for a deeper insight into the subject .",
    "the following equi - measurability property holds ( * ? ? ?",
    "* corollary 1.1.1 ) .",
    "let @xmath44 be a borel function .",
    "then @xmath45 in particular , @xmath46 for all @xmath47 $ ] .",
    "we shall use the following notation for the level sets of @xmath7 : @xmath48.\\ ] ]    the following theorem asserts that we may compute the neighborhood filters in the one - dimensional space @xmath42 $ ] .",
    "[ th.equivalence1 ] let @xmath0 be an open and bounded set , @xmath49 , and @xmath50 be a borel function .",
    "let @xmath51 be , without loss of generality , non - negative and set @xmath52 .",
    "then , for @xmath53 ( resp .",
    "@xmath54 ) , the iterative scheme ( [ def.gff ] ) ( resp ( [ def.gfv ] ) ) may be computed as , for @xmath55 and @xmath56 $ ] , @xmath57 , with @xmath58 and @xmath59 .",
    "in addition , for @xmath60 , @xmath61    _ proof .",
    "_ we start considering the one - step neighborhood filter defined in ( [ def.nf ] ) . for each @xmath62 such that @xmath63 ( i.e. all @xmath64 but a subset of zero measure ) , we consider the borel function @xmath44 given by @xmath65 then , ( [ prop.1 ] ) implies @xmath66 and @xmath67 since @xmath55 , for some @xmath56 $ ] , we have @xmath68 and similarly for @xmath69 .",
    "we thus introduce the equivalent formulation to ( [ def.nf ] ) given by , for @xmath56 $ ] @xmath70 with @xmath71 and @xmath72 .",
    "the extension of this transformation to the iterative schemes ( [ def.gff ] ) and ( [ def.gfv ] ) ( @xmath53 or @xmath54 , respectively ) is straightforward due to the invariance of the level sets structure with respect to the neighborhood filtering , see ( [ def.onestep ] ) . for both schemes ,",
    "the step @xmath73 gives @xmath74 for @xmath55 . in the case of the scheme with variable kernel ( [ def.gfv ] )",
    ", we may use the same function @xmath75 defined in ( [ def.f ] ) to deduce that @xmath76 is constant in @xmath77 for each @xmath56 $ ] . an induction argument",
    "allows us to define @xmath78 for @xmath25 , and @xmath55 , which is ( [ def.nfstar ] ) with @xmath54 .    for the fixed kernel scheme ( [ def.gff ] ) ( @xmath53 ) we can not use @xmath75 in the step @xmath73 because the values of @xmath79 and @xmath80 inside the integral may be different on the level set @xmath77",
    "however , these functions are still constant in each level set , implying the existence of a measurable function @xmath81 such that @xmath82 for @xmath55 , for @xmath56 $ ] .",
    "therefore , we may repeat the above argument with function @xmath75 replaced by @xmath83 if @xmath84 and @xmath85 if @xmath86 , thus obtaining @xmath87 reasoning in a similar way for @xmath88 , and recalling the definition of @xmath89 we obtain for @xmath55 , @xmath90 then ( [ def.nfstar ] ) for @xmath53 .",
    "follows from an inductive argument .    finally , using ( [ bound.iter ] ) and the equi - measurability property ( [ prop.1 ] ) we obtain ( [ bound.iterstar ] ) for all @xmath25 . @xmath91",
    "+      +          we show three examples of the decreasing rearrangement for clean and noisy images , all of them quantized in the usual interval @xmath92 $ ] .",
    "we have chosen as test images a natural image , _ boat _ , a texture image , _ texture _ , and a synthetic image , _",
    "squares_. the first two images are taken from the data base of the signal and image processing institute , university of southern california ( boat.512.tiff of vol .  3 and 1.5.02.tiff of vol .  1 ,",
    "respectively ) , see @xcite , while the third is a synthetic image constructed with four gray levels ( @xmath93 and @xmath94 ) and such that its four level sets have the same measure .",
    "this choice is motivated by the bad ( resp .",
    "good ) performance of the nf for uniform ( resp .",
    "extreme ) distribution of gray levels mass .",
    "these distributions are plotted in fig .",
    "[ fig1 ] .    a gray levels mass uniformly distributed image has a straight line as decreasing rearrangement , or a constant , as histogram .",
    "[ fig1 ] , we observe that the decreasing rearrangement of the boat , is closer to a straight line than that of the texture , which is still _",
    "continuous_. the choice of the synthetic image is motivated by its extreme behavior : a piece - wise constant decreasing rearrangement .",
    "we have added a gaussian white noise of @xmath95 to the test images according to the noise measure @xmath96 , where @xmath97 is the empirical standard deviation , @xmath7 is the original image , and @xmath98 is the noise",
    ".    we may observe in fig .",
    "[ fig1 ] that the main consequence of noise addition on the decreasing rearrangement is its smoothening towards a straight line .",
    "of course , the effect is stronger in far from uniformly distributed images , like the squares .",
    "finally , observe the connection between points of local maximum or minimum for the histogram and inflexion points for the decreasing rearrangement .",
    "this is the base for justifying the use of the nf as a segmentation algorithm .",
    "for the differential analysis we carry out in this section we have to assume regularity properties on the decreasing rearrangement of the given image .",
    "in general , if @xmath99 , with @xmath100 , and @xmath101 is open , bounded and connected , then @xmath102 for any @xmath103 , see ( * ? ? ?",
    "however , not much more than this is expected , and even for @xmath104 functions , their decreasing rearrangement may be non globally differentiable , see fig .",
    "[ rem.fig ] .",
    "the following theorem asserts that the monotonicity property of the decreasing rearrangement of the initial image is conserved along all the iterations .",
    "in addition , for some type of kernels among which the gaussian is included , the measure of flat regions does not change in the iterative procedure .",
    "we also obtain a condition in terms of the window size , @xmath4 , ensuring that the steady state is a constant .",
    "[ th.derivada ] let @xmath105 for some @xmath106 .",
    "let @xmath107 , with @xmath108 for all @xmath109 , and @xmath110 for all @xmath111 in a neighborhood of @xmath112 .",
    "let @xmath113 be given by the iterative scheme ( [ def.nfstar ] ) , for @xmath25 and @xmath54 .",
    "then we have , for all @xmath25 ,    1 .",
    "@xmath114 , and if @xmath115 then @xmath116 .",
    "2 .   let @xmath117 and assume @xmath118 then @xmath119 a.e . in @xmath120 .",
    "in addition , if @xmath121 and the inequality in ( [ cond.k ] ) is strict then @xmath122 .",
    "3 .   let @xmath123 be a continuous function of @xmath4 such that @xmath124 .",
    "assume that @xmath125 in @xmath126 , and let @xmath127 assume @xmath128 for some @xmath129 .",
    "then , if @xmath4 is large enough the sequence @xmath130 converges uniformly to a constant .    with the additional assumption of @xmath131 being symmetric , condition ( [ cond.k ] ) imposes @xmath132 if @xmath133 , that is , it must be a decaying kernel .",
    "observe that the gaussian kernel @xmath134 satisfies all the assumptions of theorem  [ th.derivada ] .",
    "in particular , condition ( [ cond.k2 ] ) is satisfied for @xmath135 and @xmath136 .    functions @xmath137 and @xmath138 are related in the following way : @xmath139 . thus , if @xmath125 in @xmath126 then condition ( [ cond.k ] ) is equivalent to @xmath140 .",
    "_ proof of theorem  [ th.derivada ] .",
    "_ differentiating ( [ def.nfstar ] ) , for @xmath54 , with respect to @xmath141 we obtain @xmath142 let us consider the case @xmath26 . by assumption , @xmath143 .",
    "on one hand , since @xmath131 is continuous and positive in a neighborhood of @xmath112 , and @xmath144 is bounded in @xmath145 , we deduce @xmath146 , for some positive constant @xmath147",
    ".    on the other hand , the regularity assumed on @xmath89 also implies @xmath148 . using these properties together with the lipschitz continuity of @xmath131",
    "we obtain that also @xmath149",
    ". then we proceed recursively to deduce @xmath114 for all @xmath25 , and thus ( i ) follows .",
    "to check the sign of @xmath150 , let us simplify the notation introducing , for fixed @xmath151 , @xmath152 then @xmath119 follows from ( [ deri ] ) if we prove @xmath153 which is equivalent to @xmath154 , with @xmath155 interchanging the dummy variables , we get after addition of the corresponding identities @xmath156 we then use assumption ( [ cond.k ] ) to deduce @xmath154 .",
    "the second part of ( ii ) follows from similar arguments .",
    "we , finally , prove ( iii ) . using ( [ deri ] ) and the definition ( [ def.alpha ] ) we have @xmath157 since @xmath125 , we may rewrite @xmath158 as @xmath159 using again the interchange of dummy variables and condition ( [ cond.k2 ] ) we obtain @xmath160 therefore , for @xmath4 large enough ( depending on the shape of function @xmath161 ) we have @xmath162 , with @xmath163 .",
    "the result follows .",
    "@xmath91    [ cor.reg ] let @xmath164)$ ] and @xmath165 , with @xmath166",
    ". then @xmath167)$ ] for all @xmath25 .",
    "_ from formula ( [ deri ] ) we see that the @xmath168order derivative of @xmath113 is given in terms of a quotient with a non - vanishing denominator and a numerator expressed as a composition of continuous functions , given in terms of the derivatives of order up to @xmath169 of @xmath130 and @xmath131 . @xmath91",
    "although an easy consequence of theorems  [ th.equivalence1 ] and [ th.derivada ] , the following result neatly exposes the functioning of the neighborhood filter .",
    "we recall that the mapping @xmath9 is a _ contrast change _ if @xmath170 is strictly increasing and continuous .",
    "[ cor.contrast ] assume the conditions of theorem  [ th.derivada ] , with the exception of condition ( iii ) , and suppose that @xmath171 for all @xmath151 .",
    "then , there exists a contrast change , @xmath170 such that @xmath172 in @xmath101 , where @xmath173 is the @xmath174th iteration of the nonlinear iterated neighborhood filter ( [ def.gfv ] ) .    _ proof . _ since , by assumption , @xmath175)$ ] , and @xmath171 for @xmath151 , the corresponding distribution function of @xmath89 , @xmath176 is continuous and invertible in @xmath120 and , actually , it is the inverse of @xmath89 .",
    "notice that @xmath176 coincides with the distribution function of @xmath177 , since @xmath178 .",
    "we define the function @xmath179.\\ ] ] by theorem  [ th.derivada ] , @xmath180)$ ] , and @xmath181 , implying that @xmath170 is continuous and increasing ( composition of two continuous and decreasing functions ) .    according to theorem  [ th.equivalence1 ] , the structure of level sets is invariant under the nf , i.e. the level lines of @xmath173 are the same as those of @xmath79 .",
    "in addition , the values of @xmath173 on the level lines are given by ( [ def.nfstar ] ) .",
    "therefore , for @xmath182 , for all @xmath183 $ ] , we have @xmath184 @xmath91    in the following theorem we establish a correspondence between the nonlocal diffusion scheme ( [ def.nfstar ] ) and local diffusion .",
    "this is a fundamental ingredient for the properties deduced later , which can not be directly deduced from the n - dimensional model .    indeed , since @xmath130 is non - increasing for all @xmath25 ( theorem  [ th.derivada ] ) , we have that the values selected by the nonlocal kernel @xmath185 are related to the independent variables through , for instance , taylor s expansion .    for example , if @xmath41 is smooth , we may approximate @xmath186 therefore , the size of the support of the cut - off function approximated by the gaussian is related to the size of @xmath187 .",
    "if @xmath187 is large , the size is small and the diffusion only occurs in a small interval around @xmath188 .",
    "the opposite effect holds if @xmath187 is small .",
    "although more general assumptions on @xmath131 may be prescribed , see remark  [ remth.pde ] , we estate this result for the gaussian kernel , for clarity .",
    "we also ask for further regularity on @xmath41 .",
    "[ th.pde ] let @xmath189)$ ] be such that @xmath190 in @xmath42 $ ] .",
    "let @xmath191 .",
    "then , for all @xmath151 , there exist positive constants @xmath192 independent of @xmath4 such that @xmath193 with @xmath194 and with @xmath195 , and @xmath196 .",
    "there are two interesting effects captured by ( [ app.nfstar ] ) :    1 .   the border effect ( loss of contrast )",
    "function @xmath197 is _ active _ only when @xmath141 is close to the boundaries , @xmath198 and @xmath199 . for @xmath200",
    "the term @xmath201 contributes to the decrease of the largest values of @xmath113 while for @xmath199 the opposite effect takes place .",
    "therefore , this term tends to flatten @xmath113 , i.e. induces a loss of contrast .",
    "the term @xmath202 is anti - diffusive , inducing large gradients of the iterated functions in a neighborhood of the inflexion points . in this sense ,",
    "the scheme ( [ app.nfstar ] ) is related to the shock filter introduced by alvarez and mazorra @xcite @xmath203 where @xmath204 is a smoothing kernel and function @xmath75 satisfies @xmath205 for any @xmath206 . indeed , neglecting the border and the lower order terms , and defining @xmath207",
    ", we obtain from ( [ app.nfstar ] ) @xmath208 which may be regarded as a time discretization of ( [ alvarez ] ) .",
    "_ proof of theorem  [ th.pde ] .",
    "_ we may rewrite the iterative scheme ( [ def.nfstar ] ) , for @xmath25 and @xmath54 as @xmath209 due to ( 3 ) of theorem  [ th.derivada ] we have @xmath210 in @xmath120 , and due to ( [ bound.iterstar ] ) , @xmath211 .",
    "let us denote the inverse of @xmath212 by @xmath213 . using the change of variable @xmath214 and writing @xmath215",
    ", we obtain from ( [ th2.1 ] ) @xmath216 with @xmath217 using the explicit form of @xmath131 and integrating by parts , we obtain @xmath218 with @xmath197 given by ( [ def.ktilde ] ) .    by assumption , functions @xmath219 are bounded in @xmath220 $ ] and by corollary  [ cor.reg ] they are also continuously differentiable in @xmath221 .",
    "consider the interval @xmath222 .",
    "by well known properties of the gaussian kernel , we have @xmath223 and @xmath224 in particular , from ( [ gauss.2 ] ) we get @xmath225 taylor s formula implies @xmath226 therefore , from ( [ th2.i1 ] ) , ( [ gauss.1 ] ) and ( [ th2.4 ] ) we deduce @xmath227 similarly , @xmath228 then , the result follows from ( [ th2.3 ] ) substituting @xmath229 by @xmath188 . @xmath91    [ remth.pde ] theorem  [ th.pde ]",
    "may be extended to lipschitz continuous decaying kernels satisfying the growth condition @xmath230 in such case , the higher order terms in formula ( [ app.nfstar ] ) must be replaced by @xmath231 and @xmath232 , respectively , with @xmath233 , and @xmath234 are just some positive constants . in addition , function @xmath197 given by ( [ def.ktilde ] ) is replaced by some continuous function related to a primitive of @xmath235 , and still inducing the border effect commented after the statement of the theorem .",
    "this primitive plays the same role as @xmath236 ( the primitive when @xmath237 is a gaussian kernel ) in formulas ( [ th2.i1 ] ) , ( [ gauss.1 ] ) and ( [ gauss.2 ] ) , from where condition ( [ ext.kernel ] ) arises .",
    "for computing the iterated neighborhood filter ( [ def.gfv ] ) of a function through its decreasing rearrangement version ( [ def.nfstar ] ) , we assume that the initial image , @xmath79 is quantized in some range , e. g. @xmath92 $ ] , and compute its decreasing rearrangement @xmath238 as the inverse of the distribution function @xmath239 .",
    "then , the iterations are performed by computing the integrals involved in the filter by a simple middle point formula , i.e. by assuming a constant - wise interpolation of the discrete image .",
    "only two parameters must be fixed in advance , the _ length _ of the kernel window , @xmath4 , and a tolerance for the stopping criterium or , alternatively , the number of filtering iterations .",
    "when the iterations are stopped at iteration , say , @xmath240 , we recover the output image by using the formula provided in theorem  [ th.equivalence1 ] , @xmath241,\\ ] ] where @xmath77 stands for the level sets of @xmath79 , see ( [ def.levelsets ] ) . recall that the level sets structure of @xmath242 , for @xmath243 is invariant .",
    "we used a stopping criterium based on the variational approach of the nf given by kindermann et al .",
    "in particular , the authors formally show that the critical points of the functional @xmath244 for @xmath245 , coincide with the fixed points of the neighborhood filter .",
    "the gradient descent scheme associated to the minimization of @xmath246 is just the iterated neighborhood filter ( [ def.gfv ] ) , and thus the relative difference of the decreasing sequence @xmath247 between successive iterations may be used as a stopping criterium .",
    "in fact , using the equi - measurability property ( [ prop.1 ] ) we readily deduce @xmath248 which is the actual form of the functional we use for the stopping criterium",
    ".    let us mention that in @xcite the authors show that the functional @xmath246 is not convex , in general , and therefore the existence and uniqueness of a global minimum for @xmath246 may not be deduced from the standard theory .",
    "finally , let us stress that in discrete computations the analytical results obtained in section  3 are not always observed .",
    "the reason is , of course , that some of the assumptions are not fulfilled in the discrete framework .",
    "importantly , those referring to the unbounded support of the kernel @xmath131 , or to the regularity of @xmath41 .",
    "for example , for the gaussian kernel used in our numerical experiments , it is proven in theorem  [ th.derivada ] that if @xmath171 then @xmath249 for all @xmath250 . however , as it may be seen , for instance , in fig .",
    "[ fig2 ] ( fourth row , second column ) , this property is violated in the discrete framework .",
    "nevertheless , the weaker result @xmath251 is always observed in the experiments      in the first set of experiments we used the neighborhood filter for denoising porpouses , and compare it with other related filters : the bilateral filter , @xmath252 where @xmath4 and @xmath253 are positive constants , and @xmath254 and the nonlocal means filter , @xmath255 where @xmath256 , @xmath257 is a gaussian kernel of standard deviation @xmath258 and @xmath259    since the usual version of the nf , given by ( [ def.gfv ] ) , and the version introduced in this article , expressed through the decreasing rearrangement by ( [ def.nfstar ] ) , are equivalent , there is no need of comparison between them .",
    "the denoising properties of these three filters are well known , and a thoroughfull comparison among them ( and among other filters ) is given in @xcite . here , we are not so interested in deciding which is the best performing denoising algorithm than in analyzing their behavior with respect to the histogram and the decreasing rearrangement redistributions .",
    "we applied the filters on the test images given in the introduction , see fig .",
    "[ fig1 ] , corrupted with an additive gaussian white noise of @xmath95 , according to the noise measure @xmath96 , where @xmath97 is the empirical standard deviation , @xmath7 is the original image , and @xmath98 is the noise .    in figs .",
    "[ fig2 ] to [ fig4 ] we show the results of applying these filters to the boat , the texture and the squares images .",
    "the columns correspond to : noisy image , neighborhood filter , nonlocal means filter , and bilateral filter .",
    "the rows correspond to : image , detail of the image , intensity histograms of noisy and denoised images , decreasing rearrangements of noisy and denoised images , level curves of image details showed in row 2 .",
    "although the bilateral and the nonlocal means filters are applied only once , their execution time is always much larger than that of the iterated neighborhood filter , for which we used the stopping criterium @xmath260 producing between eight iterations , for the squares image , and twenty iterations , for the texture image .",
    "we used the same parameter values for @xmath4 and @xmath253 in all the experiments .",
    "as expected , the best visual result for the natural image is obtained with the nonlocal means filter : smoother and with a lower staircaising effect than the others .",
    "it is interesting to notice how the absence of local information in the neighborhood filter produces regions with rapid intensity value changes , for instance in the clouds of the image .",
    "the smoothing effect of the local terms in the bilateral and the nlm filters prevent the formation of this artifact .",
    "a partial explanation of the worse behavior of the nf may be found in the corresponding plots for the histograms and the decreasing rearrangements .",
    "while the bilateral and the nlm filters keep almost unchanged the gray intensity structure of the pixel mass , the nf concentrates most of the mass in few and disconnected values which , in general , is an undesired effect in natural images .    finally , observe that all the filters produce a level lines shortening , notably the nlm filter .",
    "for the texture image , similar conclusions may be deduced . in this case , the level lines shortening is specially intense for the nf .",
    "the area between the circles is _ cleaned _ to one single intensity value , around 225 .",
    "we may check in the corresponding histograms the large difference between the mass assigned to this value in the different filters .",
    "this is a first clue in the consideration of the nf as a segmentation - like filter .    for the synthetic image squares , the result of applying the nf is almost a perfect image recovery , while the bilateral and the nlm filters keep always some noise due to the local diffusion .",
    "the spatial smoothening effect of the latter work against denoising , for this image .",
    "let us finally point out to the border effects mentioned after theorem  [ th.pde ] , involving formula ( [ app.nfstar ] ) , and related to the contrast loss induced by the nf .",
    "they are clearly visualized in the plots of the decreasing rearrangement of these images .",
    "also the anti - diffusive behavior of the algorithm , captured by the second order term of formula ( [ app.nfstar ] ) is observed : concave regions induce increase on the iterate while convex regions induce decrease .",
    "the result is a steeper slope around the inflexion points at each iteration .",
    "the intensity histogram , @xmath261 , of an image @xmath7 is defined by the measure of its level sets @xmath262.\\ ] ] we therefore have the following relationship between the histogram and the distribution function of @xmath7 , @xmath263 in particular , under regularity assumptions , critical points of the histogram coincides with inflexion points of the distribution function and , hence , of the decreasing rearrangement .",
    "observe that histogram critical points detection is the base for some segmentation algorithms , see for instance @xcite . due to the discrete nature of computations , finding",
    "the maxima of the histogram from where initiating a segmentation procedure is a challenging task .    at this respect ,",
    "the nf may be seen as a way of detecting histogram maxima , i.e. inflexion points of the decreasing rearrangement , which produces an _",
    "automatic _ segmentation with the only tunning of the the window size controlled by @xmath4 .    to demonstrate this capability",
    ", we applied the nf to mri brain segmentation .",
    "we used a phantom brain from the simulated brain database @xcite with a @xmath264 of additive riccian noise .    in fig .",
    "[ fig5 ] we show an axial slice of the volume ( initial image ) an the corresponding segmentation in four , three and two regions reached by setting @xmath265 , respectively .",
    "the contour lines and the decreasing rearrangement are shown too .    in fig .",
    "[ fig6 ] we show the masks of the segmented regions corresponding to @xmath266 .    in fig .",
    "[ fig7 ] we show the grey - white matter segmentation performed with the nf and with other standard packages : freesurfer @xcite , fsl @xcite and spm8 @xcite .",
    "the dice coincidence coefficient is computed for all the algorithms , see table  [ tab : label ] , showing a good performance of the nf in relation to the more sophisticated algorithms implemented in the mentioned packages .",
    "the dice coefficient is one if a perfect match to the ground truth is attained .",
    "zero , on the contrary .",
    "although in fig .",
    "[ fig7 ] we have shown the results for one slice , the nf is applied directly to the whole volume , meaning that the dimension reduction is from a three dimensional space ( the space of voxels ) to a one dimensional space ( the space of level lines measures ) .",
    "thus , the time execution of the nf is several orders of magnitude lower than the others ( a standard volume takes few seconds in a standard laptop ) .",
    "however , this is no more than a toy example , from where general conclusions can not be inferred .    .",
    "* comparison among several algorithms * [ cols=\"^,^,^,^,^,^,^,^,^ \" , ]     [ tab : label ]     +      +   +   +       +     +         +   +   +         +     +         +   +   +         +     +         +   +     +   +     +",
    "in this paper we introduced the use of the decreasing rearrangement to express nonlinear and nonlocal filters in terms of integral operators in the one - dimensional space @xmath42 $ ] .",
    "we have proved properties related to the neighborhood filter nonlinear iterative scheme . in particular , geometric properties like the invariance of level sets and the performance of the filter as a contrast change .",
    "we have also proven a detailed qualitative behavior of the iterations as a power expansion in terms of the window size , and with coefficients which depend on up to second order derivatives of the iterations .",
    "this allowed us to distinguish two kind of effects of the filtering process : an anti - diffusive effect of shock - filter type , and a contrast loss effect .",
    "motivated by the possible piece - wise constant steady state of the discrete problem , we have illustrated the interpretation of the filter as a segmentation algorithm , indeed connected to other techniques involving the histogram thresholding .",
    "the main conclusion of our work is that , for certain kind of images , among which those having concentrated their pixel mass around few intensity levels , the nf is appropriate both as a denoising and as a histogram - maxima based segmentation algorithm .",
    "the execution time of its rearranged version clearly out - performs those of other algorithms .",
    "however , for other kind of images , specially those with a relatively flat histogram , the results of the nf are poor .",
    "the authors thank to the anonymous reviewers for their interesting comments and suggestions , which have notably contributed to the improvement of our work .",
    "chang ci , du y , wang j , guo sm , thouin p ( 2006 ) survey and comparative analysis of entropy and relative entropy thresholding techniques . in : vision , image and signal processing , iee proceedings- , iet , vol 153 , pp 837850"
  ],
  "abstract_text": [
    "<S> nonlocal filters are simple and powerful techniques for image denoising . in this paper </S>",
    "<S> , we give new insights into the analysis of one kind of them , the neighborhood filter , by using a classical although not commonly used transformation : the decreasing rearrangement of a function . independently of the dimension of the _ image _ , we reformulate the neighborhood filter and its iterative variants as an integral operator defined in a one - dimensional space . </S>",
    "<S> the simplicity of this formulation allows to perform a detailed analysis of its properties . among others , we prove that the filtered image is a contrast change of the original image , an that the filtering procedure behaves asymptotically as a shock filter combined with a border diffusive term , responsible for the staircaising effect and the loss of contrast .    </S>",
    "<S> * keywords : * neighborhood filters , decreasing rearrangement , denoising , segmentation </S>"
  ]
}