{
  "article_text": [
    "metabolomics is the comprehensive study of all small organic compounds in a biological specimen @xcite .",
    "metabolite concentrations in body fluids such as urine , serum , and plasma have proven valuable in predicting disease onset and progression @xcite .",
    "metabolomic data can be generated by a variety of methods of which mass spectrometry and @xmath0h nmr spectroscopy are the most common . while its high sensitivity makes mass spectrometry the preferred method for discovery projects , the high reproducibility of nmr data @xcite is ideal for applications in precision medicine .",
    "@xmath0h nmr allows for the simultaneous detection of all proton - containing metabolites present at sufficient concentrations in biological specimens .",
    "furthermore , nmr signal volume scales linearly with concentration .",
    "the complete set of nmr signals acquired from a given specimen is called its metabolite `` fingerprint '' . due to differences in ph ,",
    "salt concentration , and/or temperature , relative displacement of signal positions occurs across spectra .",
    "binning schemes can compensate for this effect by splitting spectra into segments called bins and summing up signal volumes contained therein .",
    "equal - sized bins are commonly used , albeit other schemes such as adaptive binning have been suggested @xcite . binned fingerprint data is the typical starting point for subsequent multivariate data analysis including biomarker discovery and specimen classification using methods such as support vector machines @xcite , ridge @xcite , and lasso regression @xcite .",
    "metabolite fingerprints need to be scaled to a common unit .",
    "typical examples include mmol metabolite per ml plasma , mmol metabolite per mmol creatinine in urine , or the relative contribution of a bucket to the total spectral intensity of an nmr spectrum . in practice",
    "this is achieved by dividing each spectrum by the unit defining quantity : the intensity of an nmr reference such as tsp , the intensity of creatinine , or the total spectral intensity .",
    "this scaling of the raw data defines the measurement , but it also serves a second purpose : scaling corrects for unwanted experimental and physiological variability in the raw spectra . correcting unwanted variability is usually called normalization .",
    "instrument performance can vary and so can patient - specific parameters like the fluid balance , which is affected by drinking , respiration , defecation , perspiration , or medication , thus altering urine metabolite concentrations without reflecting disease state @xcite .",
    "all scales have their pros and cons : the nmr reference can normalize for spectrometer performance @xcite but not for unwanted variability in urine density .",
    "choosing creatinine as a standard for urine assumes the absence of inter - individual differences in the production and renal excretion of creatinine @xcite .",
    "in fact , creatinine production and excretion is affected by sex , age , muscle mass , diet , pregnancy , and , most importantly , renal pathology @xcite .",
    "normalization to a constant total spectral intensity or spectral mapping to a reference spectrum assume that the total amount of metabolites is constant over time and across patients and that spectra are not contaminated by signals that do not represent metabolites .",
    "however , this is not always the case @xcite .",
    "in fact , for urinary specimens of patients suffering from proteinuria the additional protein signals greatly increase total spectral area , and scaling to a constant total intensity systematically underestimates metabolite abundances",
    ". similarly , excessive glucose uptake , for example by a glucose infusion , leads to high total spectral intensities that are dominated by glucose and its metabolites .",
    "while the high values for these metabolites correctly reflect the metabolic state for these patients , their influence on the total spectral intensity leads to systematic underestimation of metabolites not related to glucose metabolism .    in general , the preferred scaling protocol depends on the specific data set to be investigated .",
    "however , for some data sets it is not possible to use the same scale for all patients in the cohort .",
    "we will describe such data sets below . in this case",
    "different protocols need to be used for different patients , introducing new challenges to data analysis .    in this contribution",
    ", we first studied how the choice of scale affects statistical analysis , the selection of biomarkers , and patients diagnosis by these biomarkers .",
    "we report on two supervised metabolomics data analysis scenarios , namely urine and plasma biomarker discovery in 1d @xmath0h nmr metabolite fingerprints for the early detection of acute kidney injury onset after cardiac surgery @xcite . in both applications we tested metabolites for differential abundance using alternative scaling protocols .",
    "we observed pronounced disagreements between the lists of significantly differential metabolites depending on how the same data was scaled .",
    "more importantly , the different scalings led to inconsistencies in the classification of individual patients . in view of these observations ,",
    "reproducibility of metabolic studies is only possible if the exact same scaling protocols are used .    to overcome this problem",
    ", we extended zero - sum regression @xcite , which has recently been demonstrated to be invariant under any rescaling of data @xcite , to logistic zero - sum regression and compared it to two standard methods for constructing multivariate signatures : lasso logistic regression and support vector machines in combination with _",
    "t_-score based feature filtering .",
    "unlike the latter methods , logistic zero - sum regression always identifies the same biomarkers regardless of the scaling method .",
    "consequently , prior data normalization may be omitted completely .",
    "we make logistic zero - sum regression available as an _ r _ package and as a high - performance computing software that can be downloaded at https://github.com/rehbergt/zerosum .",
    "the first data set comprised 1d @xmath0h nmr fingerprints of @xmath1 = 106 urine specimens , which had been collected from patients 24 h after cardiac surgery with cardiopulmonary bypass ( cpb ) use at the university clinic of erlangen @xcite . of these 106 ,",
    "34 were diagnosed with acute kidney injury ( aki ) 48 h after surgery .",
    "the challenge in this data is to define a urinary biomarker signature that allows for the early detection of aki onset ( acute kidney injury network ( akin ) stages 1 to 3 ) . the second data set consisted of 85 edta - plasma specimens , which had been collected 24 h post - op from a subcohort of the original cohort of 106 patients undergoing cardiac surgery with cpb use and which had been subjected to 10 kda cutoff filtration @xcite . in total , 33 patients out of these 85 patients were diagnosed with postoperative aki @xcite .",
    "again our goal is to detect biomarkers for an earlier detection of aki .",
    "a total of 400 @xmath2l of urine or edta - plasma ultrafiltrate was mixed with 200 @xmath2l of phosphate buffer , ph 7.4 , and 50 @xmath2l of 0.75% ( w ) 3-trimethylsilyl-2,2,3,3-tetradeuteropropionate ( tsp ) dissolved in deuterium oxide as the internal standard ( sigma - aldrich , taufkirchen , germany ) .",
    "nmr experiments were carried out on a 600 mhz bruker avance iii ( bruker biospin gmbh , rheinstetten , germany ) employing a triple resonance ( @xmath0h , @xmath3c , @xmath4p , @xmath5h lock ) cryogenic probe equipped with @xmath6-gradients and an automatic cooled sample changer .",
    "for each sample , a 1d @xmath0h nmr spectrum was acquired employing a 1d nuclear overhauser enhancement spectroscopy ( noesy ) pulse sequence with solvent signal suppression by presaturation during relaxation and mixing time following established protocols @xcite .",
    "nmr signals were identified by comparison with reference spectra of pure compounds acquired under equal experimental conditions @xcite .",
    "the spectral region from 9.5 to @xmath70.5 ppm of the 1d spectra was exported as even bins of 0.001 ppm width employing amix 3.9.13 ( bruker biospin ) .",
    "the data matrix was imported into the statistical analysis software _",
    "r _ version 3.3.2 . for the urinary spectra , the region 6.5  4.5 ppm , which contains the broad urea and water signals ,",
    "was excluded prior to further analysis . for plasma spectra , the region 6.2  4.6 ppm , containing the urea and remaining water signals ,",
    "was removed prior to analysis .",
    "in addition , the regions 3.82  3.76 ppm , 3.68  3.52 ppm , 3.23  3.2 ppm , and 0.75  0.72 ppm , corresponding to filter residues and free edta , were excluded prior to classification for the plasma specimens .",
    "we compare our scaling- and normalization - invariant approach to standard analysis strategies that were applied to data preprocessed by four state - of - the - art normalization protocols .",
    "for creatinine normalization of urinary data we divided each bucket intensity by the summed intensities of the creatinine reference region ranging from 3.055 to 3.013 ppm of the corresponding nmr spectrum . when scaling to the total spectral intensity we summed over all signal intensities from 9.5 to 0.5 ppm after exclusion of the water and urea signals and divided each bucket intensity by this sum .",
    "when scaling to the signal intensity of the nmr reference compound , in our case tsp , we summed up the intensities of the tsp buckets ranging from @xmath70.025 to 0.025 ppm and divided each bucket intensity by this sum .",
    "this normalization method corrects for differences in spectrometer performance @xcite , but not for differences in fluid intake .",
    "finally , we also evaluated probabilistic quotient normalization ( pqn ) @xcite .",
    "pqn follows the rationale that changes in concentration of one or a few metabolites affect only small segments of the spectra , whereas specimen dilution , for example due to differences in fluid intake in case of urinary specimens , influences all spectral signals simultaneously @xcite .",
    "following @xcite we first normalized each spectrum to its total spectral intensity .",
    "then , we took the median across all these spectra as the reference spectrum and calculated the ratio of all bucket intensities between raw and reference spectra .",
    "the median of these ratios in a sample was our final division factor .    for subsequent analysis , only the spectral region between 9.5 and 0.5",
    "ppm was taken into account . to compensate for slight shifts in signal positions across spectra due to small variations in sample ph , salt concentration , and/or temperature , bucket intensities across ten buckets",
    "were fused together in one bucket of 0.01 ppm width by summing up the individual bucket intensities .",
    "the resulting intensities were @xmath8 transformed to correct for heteroscedasticity , and all subsequent data analysis was performed with these values .",
    "we compared logistic zero - sum regression to two classification algorithms for normalized data , namely a support vector machine @xcite employing a linear kernel function combined with univariate feature filtering ( f - svm ) and the least absolute shrinkage and selection operator ( lasso ) logistic regression @xcite . in the lasso logistic regression and the zero - sum models , the penalizing parameter @xmath9 that balances",
    "the bias variance trade - off was optimized in an internal cross - validation .",
    "lasso models were trained utilizing the _ r _ package _ glmnet _ @xcite .",
    "the zero - sum models were trained by employing our _ zerosum _ software , which is implemented in two versions : first , a version optimized for high - performance computing ( hpc ) , and second , an _ r _",
    "package for ordinary desktop computers .",
    "we utilized the _ zerosum _ hpc implementation throughout the article .",
    "the parameter @xmath9 induces sparseness of the models and circumvents over - fitting for lasso and zero - sum models . similarly , we optimized the parameters of f - svm .",
    "this was done in a two - fold nested cross - validation , i.e. ,  in each cross - validation step we screened for the best feature threshold , allowing for @xmath10 included features , and the matching best cost parameter , which was screened in @xmath11 . for training the svm we utilized the _",
    "r _ package _",
    "metabolic biomarkers can be metabolites or just spectral features .",
    "moreover , they can be identified as stand - alone predictors or as part of a multivariate biomarker signature . before we focus on signatures we study the effect of scales on stand - alone biomarkers .",
    "more precisely , we focus on spectral buckets with differential intensities between two classes of samples , i.e. , from patients who developed acute kidney injury after cardiac surgery versus from those that did not .",
    "bin intensities were normalized to ( a ) a constant total spectral intensity , ( b ) a constant creatinine intensity , ( c ) a median reference spectrum employing the most probable quotient and ( d ) a constant intensity of the nmr reference .",
    "for scoring normalized bin intensities as potential biomarkers we used benjamini - hochberg ( b / h ) corrected @xmath12-values from the moderated _ t_-statistics implemented in the _ r _ package limma @xcite and @xmath8 fold changes between the classes .",
    "figure [ t - test ] shows plots of spectral bin positions against @xmath13(@xmath12-values ) ( a - d ) and @xmath8 fold changes ( e - h ) between aki and non - aki urine specimens . from left to right the plots correspond to ( a , e ) normalization by total spectral intensity , ( b , f ) normalization to creatinine , ( c , g ) pqn , and ( d , h ) normalization to tsp .",
    "the red line in plots ( a - d ) marks a significance level of 0.01 , corresponding to a false discovery rate ( fdr ) below 1@xmath14 .",
    "significant buckets are plotted in red in all eight plots .    *",
    "normalization to total spectral intensity : * on this scale we observed almost exclusively negative fold changes indicating lower bucket intensities for aki in comparison to non - aki .",
    "242 features were significant with features corresponding to carnitine , 2-oxoglutaric acid , and glutamine ranking highest .",
    "supplementary table s1 ( a ) lists raw and b / h - adjusted @xmath12-values as well as metabolite assignments of the top ten significant buckets .",
    "technical artifacts of the scale become apparent too : the spectral region from 4 to 3.5 ppm , highlighted as a blue band , hardly comprised any significant features .",
    "this region is dominated by signals from sugars such as d - mannitol , which had been used as a pre - filling material for the tubes of the cpb machine @xcite . as d - mannitol exhibits a rather large number of nmr signals ,",
    "as highlighted in an exemplary urine spectrum shown in figure [ aki_urin ] , it comprised between @xmath15 and @xmath16 of the total spectral areas . on a scale that makes the total spectral area the same across all samples",
    "these signals can not serve as biomarkers . however , all patients take up d - mannitol during surgery , and the amount of d - mannitol still found in urine 24 h past surgery is modulated by actual kidney function .",
    "d - mannitol entangles kidney function with the total spectral area .",
    "therefore , the spectral area can not be recommended for scaling biomarkers , at least not in this context .",
    "* normalization to creatinine : * for this scale we observed different analysis results .",
    "@xmath8 fold changes were predominantly positive indicating higher metabolite levels in aki patients .",
    "204 buckets were significant , and the top ten are listed in supplementary table s1 ( b ) .",
    "the biomarker ranked highest was tranexamic acid , which is given in cardiac surgery to prevent excessive blood loss .",
    "strikingly , the region between 4 and 3.5 ppm ( blue band ) containing the d - mannitol signals was highly significant on this scale",
    ".    however , this scale confounds with aspects of kidney function . in response to kidney disease",
    "urinary creatinine excretion rates can be affected @xcite .",
    "thus , normalization to creatinine can also obscure other metabolite biomarkers if their excretion correlates with that of creatinine .",
    "* probabilistic quotient normalization : * on this scale we observed both positive and negative fold changes in almost equal numbers .",
    "only 89 features were now significant , and the top ten are listed in table s1 ( c ) , with carnitine and glutamine as the leading biomarkers .",
    "again , the blue shaded region now covers significant features , although the number is much lower than after creatinine scaling .    due to the strong conceptual similarity between pqn and normalization to total spectral intensity",
    ", the d - mannitol artifact also compromises the use of pqn .",
    "* tsp normalization : * on this scale we did not detect any significant biomarkers .",
    "the scaling method corrects only for differences in spectrometer performance , not for changes in global metabolite concentration . due to large variability in urine density throughout the cohort",
    ", it can not be used in this context .",
    "we observed only one bucket at 3.715 ppm , identified as an overlap of propofol - glucuronide , broad protein signals , and tentatively d - glucuronic acid , which obtained a significant @xmath12-value on three scales ( figure [ venn_aki_classif]a ) .",
    "the plasma data biomarker discovery was not consistent across scales either ( supplementary table s2 , figure s1 , and figure [ venn_aki_classif]b ) . scaling to total spectral area and scaling to tsp predominantly identified metabolites that accumulate in the blood of patients developing aki .",
    "one might explain this observation by a reduced glomerular filtration in these patients .",
    "however , the pqn data immediately challenged this interpretation , as it identified a large set of down - regulated metabolites in aki .",
    "creatinine normalization is not common for plasma metabolomics and was not investigated here .",
    "exemplary 1d @xmath0h nmr spectrum of a urine specimen collected 24 h after surgery from an aki patient .",
    "the lower histogram illustrates the common binning procedure.,scaledwidth=50.0% ]     number of significant buckets and their overlap between the different scaling methods for ( a ) the aki urine and ( b ) the aki plasma data set.,title=\"fig:\",scaledwidth=24.0% ]   number of significant buckets and their overlap between the different scaling methods for ( a ) the aki urine and ( b ) the aki plasma data set.,title=\"fig:\",scaledwidth=24.0% ]      biomarkers can be combined to biomarker signatures in multivariate analysis .",
    "machine - learning algorithms are used to learn these signatures from training data .",
    "we tested two of these algorithms , namely a linear svm with @xmath17-score based feature filtering ( f - svm ) and standard logistic lasso regression .",
    "both methods implement linear signatures of the form @xmath18 where @xmath19 is the raw signal from bucket @xmath20 in patient @xmath21 , @xmath22 the weight of this feature , and @xmath23 the scaling factor used to normalize sample @xmath21 .",
    "both methods were used to learn signatures from data normalized in four different ways , namely scaling by total spectral area , scaling to creatinine , pqn , and scaling to tsp .",
    "the performance of the algorithms was tested in cross - validation .",
    "figure [ roc_aki]a shows roc curves of signatures that aim to predict aki from urinary fingerprints using f - svm signatures .",
    "the areas under the roc curves ( auc - roc ) are summarized in table [ roc_table ] .",
    "the higher this area the better the prediction of patient outcome .",
    "performances ranged from an auc of 0.72 for tsp - scaled data to an auc of 0.83 for pqn data . in line with the results for stand - alone biomarkers , the f - svm algorithm picked different features across scaling methods .",
    "not a single bucket was chosen simultaneously for all four scales ( figure [ roc_aki]a bottom row ) .",
    "figure [ roc_aki]b and table [ roc_table ] show the corresponding results for standard lasso logistic regression .",
    "the lasso signatures performed slightly better and were more consistent .",
    "nevertheless , there is still a dependence of the chosen biomarkers on the scale .",
    "similar results were observed for the plasma data set ( supplementary figure s2 ) .    the urinary aki data set : receiver operating characteristic ( roc ) curves for two classification approaches , ( a ) svm in combination with @xmath17-test based feature filtering and ( b ) lasso , after application of four different normalization strategies : scaling to total spectral area ( red solid line ) , scaling to creatinine ( blue dashed line ) , probabilistic quotient normalization ( pqn ) ( green dotted line ) , and scaling to tsp ( yellow dashed - dotted line ) .",
    "the bottom row shows the number of features included in the respective classification models in venn diagrams .",
    "the corresponding models were built by averaging over all models of the outer cv loop . ]          from a clinical perspective , varying biomarkers constitute only a minor problem , as long as they agree in their predictions of outcome",
    ". however , they usually do not agree .",
    "for the urinary data set , lasso signatures yielded conflicting predictions in 16% of patients . for f - svm signatures ,",
    "the percentage increased to 30% .",
    "figure [ classification_summary_aki ] summarizes the predictions of aki onset after cardiac surgery patient by patient for the urinary data set .",
    "the row `` patient outcome '' shows patients in blue who did not develop aki ( akin stage 0 ) and in red those that developed aki .",
    "furthermore , the yellow dashed lines highlight patients with akin stage 2 and 3 , a more severe manifestation of kidney injury .",
    "the latter patients constitute the high - risk group where early detection of aki onset can save lives @xcite .",
    "the true outcomes 48 h after surgery are contrasted to the predictions 24 h earlier . shown",
    "are predictions of f - svm and lasso signatures for the four scaling methods .",
    "we observed that predictions frequently changed with scale and that signatures learned on data that was scaled to , e.g. , creatinine did not properly identify the highest risk group . for f -",
    "svm only the signature on pqn data identified all high - risk patients correctly .",
    "the lasso identified high - risk patients for total spectral area and pqn data correctly .",
    "we discuss some misclassifications in more detail .",
    "patients aki-35 and aki-106 developed severe aki after 48 h but were not predicted to do so by two of the f - svm signatures , namely those for creatinine and total spectral area scaled data .",
    "a key observation of this paper is that these misclassifications could be traced back to data normalization . in theory , the predictions could have been saved by readjusting the scaling of these fingerprints ( however , the necessary scaling factor is not evident _ a priori _ ) .",
    "figure [ prob_vs_gamma ] shows the prediction probabilities of these signatures on the @xmath24-axis .",
    "if this probability was above 0.5 we predicted an onset of aki , otherwise we did not .",
    "the @xmath25-axis shows possible multiplicative scale adjustments @xmath26 .",
    "a value of @xmath27 indicates the actual scale used for prediction .",
    "values of @xmath28 correspond to a down - scaling of all buckets by the factor @xmath26 , while values of @xmath29 correspond to an up - scaling by @xmath26 .",
    "the plot thus shows the probability of developing aki as a function of the scale - readjustment factor @xmath26 .",
    "the dashed lines correspond to f - svm and the solid lines to lasso signatures .",
    "colors indicate the underlying scaling methods of the signatures : total spectral area ( red ) , creatinine ( blue ) , pqn ( green ) , and tsp ( yellow ) .    on the original scale ( @xmath27 )",
    "patient aki-35 shows prediction probabilities below 0.5 for f - svm - creatinine ( blue dashed line ) and f - svm - total - area ( red dashed line ) .",
    "let @xmath30 be the ratio of the creatinine signal ( from 3.055 to 3.013 ppm ) and the remaining spectral area after exclusion of the d - mannitol region ( 4.0 to 3.5 ppm ) . for aki-35 we observed @xmath31 , while the median over all aki predicted samples was @xmath32 . in line with this",
    ", up - scaling the fingerprint rescues the prediction for this patient ( blue dashed line in figure [ prob_vs_gamma]a ) .",
    "similarly , @xmath33 , the ratio between d - mannitol and the remaining spectral area , was @xmath34 , while the median over all aki predicted samples was 2.42 , which explains why the f - svm - total - area prediction could be rescued by a down - scaling of the fingerprint ( red dashed line in figure [ prob_vs_gamma]a ) .",
    "similar problems can be observed for patient aki-106 , and for the lasso - creatinine signature in patients aki-70 and aki-4 .    for the plasma data , we observed inconsistent predictions for 19% ( 6% ) of the patients for f - svm ( lasso ) ( supplementary figure s3 ) . here , no method identified the high - risk group completely , with best identification shown for lasso on pqn data .    in summary , we observed inconsistencies in the selection of biomarkers and more importantly in the prediction of patient outcome across the four scaling methods .",
    "these inconsistencies were most pronounced for the filter - based feature selection in f - svm and affected urinary fingerprints more than plasma fingerprints . still they could be observed for all analysis scenarios . for several patients",
    "a simple scale adjustment would have saved the prediction .",
    "the next section will show that zero - sum logistic regression resolves these inconsistencies fully and leads to more accurate predictions .    the probability of aki prediction as a function of the scale readjustment factor @xmath26 ( see text ) .",
    "the dashed lines correspond to f - svm signatures and the solid lines to lasso signatures .",
    "colors indicate the underlying scaling methods of the signatures : total spectral area ( red ) , creatinine ( blue ) , pqn ( green ) , and tsp ( yellow ) .",
    "the black dotted line gives the zero - sum predictions , which are independent of @xmath26 .",
    ", title=\"fig : \" ] the probability of aki prediction as a function of the scale readjustment factor @xmath26 ( see text ) .",
    "the dashed lines correspond to f - svm signatures and the solid lines to lasso signatures .",
    "colors indicate the underlying scaling methods of the signatures : total spectral area ( red ) , creatinine ( blue ) , pqn ( green ) , and tsp ( yellow ) .",
    "the black dotted line gives the zero - sum predictions , which are independent of @xmath26 .",
    ", title=\"fig : \" ] the probability of aki prediction as a function of the scale readjustment factor @xmath26 ( see text ) .",
    "the dashed lines correspond to f - svm signatures and the solid lines to lasso signatures .",
    "colors indicate the underlying scaling methods of the signatures : total spectral area ( red ) , creatinine ( blue ) , pqn ( green ) , and tsp ( yellow ) .",
    "the black dotted line gives the zero - sum predictions , which are independent of @xmath26 .",
    ", title=\"fig : \" ] the probability of aki prediction as a function of the scale readjustment factor @xmath26 ( see text ) .",
    "the dashed lines correspond to f - svm signatures and the solid lines to lasso signatures .",
    "colors indicate the underlying scaling methods of the signatures : total spectral area ( red ) , creatinine ( blue ) , pqn ( green ) , and tsp ( yellow ) .",
    "the black dotted line gives the zero - sum predictions , which are independent of @xmath26 .",
    ", title=\"fig : \" ]      zero - sum regression @xcite is a novel machine - learning algorithm that is insensitive to rescaling the data @xcite .",
    "it allows for a selection of biomarkers that does not depend on the units chosen .",
    "the classifications of patients that result from these signatures do not depend on any scaling of the data either .",
    "in fact , patients can be classified with spectral data that were not normalized at all .    for the reader s convenience we review the concept here in a nutshell : let @xmath35 be metabolomics data , where @xmath36 is the logarithm of the intensity for bucket @xmath37 in sample @xmath38 and @xmath39 the corresponding clinical response of patient @xmath21 .",
    "in regression analysis the data sets need to be normalized to a common unit .",
    "note that the data are on a logarithmic scale , therefore the scaling to a common unit becomes a shifting of the spectrum @xmath40 by some sample specific value @xmath41 .",
    "thus for normalized data the regression equation reads @xmath42 now note that the equation becomes independent of the normalization @xmath41 if and only if the regression coefficients @xmath22 sum up to zero , i.e. , @xmath43 this is the idea of zero - sum regression . in the machine - learning context of high - content data ,",
    "zero - sum regression can be combined with lasso or elastic - net regularization and shows predictive performances that were not compromised by the zero - sum constraint @xcite .    in",
    "many biomarker discovery challenges the response @xmath24 is not continuous but binary .",
    "we thus need to extend the concept of zero - sum regression from linear regression to classification .",
    "we do this by introducing logistic zero - sum regression .    in standard logistic regression",
    "the log - likelihood of normalized data reads @xmath44 where we abbreviated @xmath45 . in this generalized linear model",
    "the log - likelihood again becomes independent of the normalization @xmath41 if the regression coefficients @xmath22 add up to zero .",
    "this statement also holds if we add the penalizing term @xmath46 , which corresponds to the elastic - net regularization penalty .",
    "the parameter @xmath9 is calibrated in cross - validation @xcite , while @xmath47 is usually fixed to a specific value in @xmath48 $ ] .",
    "here , @xmath49 corresponds to ridge regression @xcite and @xmath50 to the lasso @xcite .",
    "thus , logistic zero - sum regression amounts to finding coefficients @xmath51 that minimize @xmath52 for all applications throughout the article , we have chosen @xmath50 .",
    "as proposed by @xcite we use the quadratic approximation of eq .",
    "( [ loglilogist ] ) locally at the current parameters @xmath53 of the optimization algorithm :    @xmath54    with @xmath55 @xmath56 is independent of @xmath57 and can thus be neglected .",
    "an efficient coordinate - descent algorithm for zero - sum regression can be constructed by incorporating the zero - sum constraint into the log - likelihood by substituting @xmath58 with @xmath59 @xcite . calculating the partial derivative of the resulting log - likelihood with respect to @xmath60 ( @xmath61 ) and solving for @xmath60 yields an update scheme for @xmath60 and @xmath58 : @xmath62 the update value for @xmath58",
    "is given by @xmath59 .",
    "after each update the approximation has to be renewed .",
    "since we update @xmath60 and @xmath58 simultaneously the number of updates scales quadratically with the number of features .",
    "therefore , the minimization problem ( [ loglizsum ] ) will be computationally demanding if @xmath25 becomes high - dimensional .",
    "we performed a nested cross - validation ( cv ) , where the inner cv uses 10 folds to determine a suitable regularization strength @xmath9 and the outer cv is a leave - one - out cv to evaluate the prediction accuracy of the resulting models .",
    "we are evaluating two different data sets , each within a leave - one - out cv , one data set with 4 and the other with 3 different normalizations , and therefore we have to do 107@xmath634 + 86@xmath633=686 independent inner cvs .",
    "each of these cvs is performed on an approximated regularization path of length 500 , however , the algorithm stops when overfitting occurs . in total",
    "we performed @xmath64 model fits .",
    "this number presents an obvious computational challenge . to avoid numerical uncertainties in the feature selection we used the very precise convergence criterion of @xmath65 , which additionally increases the computational effort .    on a standard server",
    "( 2 intel xeon x5650 processors with 6 cores each ) , the complete calculation took about two days .",
    "we were able to bring the compute time down to 12 minutes by developing an hpc implementation of _ zerosum _ and executing it on 174 nodes of the supercomputer qpace 3 operated by the computational particle physics group .",
    "qpace 3 currently comprises 352 intel xeon phi 7210 ( `` knights landing '' ) processors , connected by an omnipath network .",
    "each processor contains 64 compute cores , and each of these compute cores contains two 512-bit wide vector units . to run efficiently on this machine ,",
    "the _ zerosum _ c code was extended to use avx512 vector intrinsics for the calculation of the coordinate - descent updates .",
    "openmp is used to parallelize the inner cv so that the data has to be stored in memory only once and can be accessed from all folds .    additionally , we provide a new _ zerosum _ _ r _ package , which is a wrapper around the hpc version and can easily be used within _",
    "r _ package also includes functions for exporting and importing all necessary files for / from the hpc implementation .    for users without access to hpc facilities",
    ", our package can be run on a regular workstation with reduced convergence precision and a shorter regularization path in less than one hour .",
    "receiver operating characteristic ( roc ) curves for logistic zero - sum regression , after application of four different normalization strategies , scaling to total spectral area ( red solid line ) , scaling to creatinine ( blue dashed line ) , probabilistic quotient normalization ( pqn ) ( green dotted line ) , and scaling to tsp ( yellow dashed - dotted line ) for ( a ) the urinary aki and ( b ) the plasma aki data set .",
    "the right column shows the number of features included in the respective classification models in venn diagrams .",
    "the corresponding models were built by averaging over all models of the outer cv loop .",
    ", title=\"fig : \" ]    receiver operating characteristic ( roc ) curves for logistic zero - sum regression , after application of four different normalization strategies , scaling to total spectral area ( red solid line ) , scaling to creatinine ( blue dashed line ) , probabilistic quotient normalization ( pqn ) ( green dotted line ) , and scaling to tsp ( yellow dashed - dotted line ) for ( a ) the urinary aki and ( b ) the plasma aki data set . the right column shows the number of features included in the respective classification models in venn diagrams .",
    "the corresponding models were built by averaging over all models of the outer cv loop .",
    ", title=\"fig : \" ]      logistic zero - sum regression is not affected by changes in scale . actually , it will always yield the same result regardless of the scaling method used .",
    "figure [ roc_zerosum ] gives the corresponding roc curves and venn diagrams for the four normalization strategies investigated .",
    "since zero - sum models are scale independent , this classification approach always identified the same biomarkers and assigned the same weights to them independently of the normalization method chosen .",
    "supplementary file 1 ( supplementary file 2 ) lists all nmr buckets and corresponding metabolites for the urinary ( plasma ) data set with regression weights not equal to zero in at least one classification - normalization approach . again",
    "consider the urinary aki data set .",
    "metabolites with large absolute regression weights ( @xmath66 ) in the zero - sum models included both endo- as well as exogenous compounds .",
    "the largest positive regression weight was assigned to a bucket at 3.285 ppm , which was identified as a superposition of myo - inositol , taurine , 4-hydroxy - propofol-4-oh - d - glucuronide , and tentatively to d - glucuronic acid as well as an unknown metabolite .",
    "other important buckets with large positive regression weights comprised propofol - glucuronide , 4-hydroxy - propofol-1-oh - d - glucuronide , isobutyrylglycine , broad protein signals , and probably 2-oxoisovaleric acid , indoxyl sulfate , as well as unidentified metabolites . buckets with large negative regression weights correspond to a superposition of carnitine and 4-hydroxy - propofol-4-oh - d - glucuronide , n - acetyl - l - glutamine , and probably 4-hydroxyphenylacetic acid , as well as unidentified metabolites .",
    "positive / negative regression coefficients indicate an up-/down - regulation of the corresponding metabolite in the aki in comparison to the non - aki group .",
    "consequently , we can report an up - regulation of exogenous compounds such as glucuronide conjugates of propofol , an anesthetic agent which had been administered during the cardiac surgery and is mainly metabolized by glucuronidation @xcite .",
    "elevated urinary levels of propofol conjugates in the aki group point to a delayed excretion of exogenous compounds caused by reduced glomerular filtration or prolonged administration @xcite .",
    "higher absolute concentrations of propofol - glucuronide ( @xmath12-value @xmath67 ) have already been reported for the 24 h urine nmr fingerprints in @xcite .",
    "an up - regulation of carnitine in the non - aki group is indicated by its large negative regression weight .",
    "this observation has already been reported in @xcite , where an up - regulation of carnitine , whose main function is the transport of long - chain fatty acids into the mitochondria for subsequent beta - oxidation @xcite , in the non - aki group has been discussed as a successful protective response against ischemic injury .    also , logistic zero - sum regression returned the same predictions for all patients regardless of the applied normalization strategy , summarized in figure [ classification_summary_aki ] , as well as in supplementary figure s3 . furthermore , the zero - sum constraint did not compromise predictive performance for the urinary and plasma aki data set , respectively ( table [ roc_table ] , figures [ roc_zerosum]a and [ roc_zerosum]b ) .",
    "auc values ranged among the highest for the urinary aki data set , and yielded the largest value among all three classification methods in combination with three different normalization strategies for the plasma aki data set .",
    "most importantly , zero - sum regression reliably identified patients that developed severe aki ( stage 2 and 3 , highlighted by yellow dashed area )",
    ". only lasso on pqn data gave competitive results .",
    "with respect to auc , zero - sum was still superior .",
    "moreover , a sample - specific rescaling @xmath26 has no effect on the corresponding zero - sum prediction probabilities , as illustrated in figure [ prob_vs_gamma ] by the black dotted lines .",
    "we first pointed out some intrinsic problems in metabolomics biomarker detection .",
    "the identification of biomarkers strongly depends on the method selected for scaling the reference profiles . for stand - alone biomarkers , accordance across scales can be as low as 0% .",
    "the same is true for multivariate biomarker signatures when filtering approaches like filtering by the _",
    "t_-statistics are used , while wrapping approaches like the lasso yield somewhat more consistent yet still not scale - independent signatures .",
    "more importantly , the prediction of a patient s outcome can change depending on the scaling method employed .",
    "in fact , for some cases we could attribute failing prediction to inappropriate scaling of the raw data . to overcome this problem",
    "we suggest logistic zero - sum regression , which provides a completely scale - independent analysis .",
    "it always selects the same biomarkers , assigns the same weights to them , and predicts the same outcome no matter whether the raw data was scaled relative to total spectral area , creatinine , tsp , any other reference point , by pqn , or not at all .",
    "furthermore , zero - sum regression was among the best aki predictors both for urinary and plasma fingerprints . also , the number of chosen features did not change significantly compared to other signatures , allowing for transfer of zero - sum signatures into clinical practice .",
    "the interplay of statistical analysis and normalization protocols has been described by several authors @xcite . proposed",
    "strategies to overcome these issues included the selection of the most `` robust '' normalization @xcite or the parallel application of several normalization strategies and a subsequent meta analysis of the individual results @xcite .",
    "clearly , these strategies deal with the problem , but unlike zero - sum regression do not solve it .",
    "the zero - sum signatures did not identify completely new biomarkers .",
    "in fact , most of the underlying metabolites of the signatures were described before .",
    "however , we believe that zero - sum signatures make better use of these biomarkers by combining and weighing them differently .",
    "predictions are no longer confined to a specific normalization protocol but hold in general .",
    "biological interpretation becomes easier as there are fewer user - dependent choices to make .",
    "it is a set of metabolites that hold predictive information and not their abundance relative to an arbitrarily chosen reference point .",
    "moreover , signatures can be validated across studies and tested in different labs even if scaling protocols do not match or if no scaling is applied at all .",
    "this fact has the potential to greatly enhance the reproducibility of clinical trials .",
    "the urinary aki data set is a good example for data where a proper normalization can not replace independence of normalization .",
    "we believe that this data set just can not be normalized properly : varying urine density precludes tsp normalization , the strong confounding of spectral areas by d - mannitol signals and by proteinuria eliminates both normalization to the total spectral area and pqn , while creatinine excretion is entangled with kidney function and varies strongly across patients , disqualifying it from use as a common reference .",
    "moreover , correcting for artifacts like d - mannitol requires that the existence of an artifact is known for a specific patient .",
    "interestingly , the lasso - tsp signature worked surprisingly well in spite of strong variability in urinary density across patients .",
    "coincidently , however , this signature had weights adding up to almost ( yet not exactly ) zero .",
    "lasso is an algorithm used in artificial intelligence .",
    "here it detected the intrinsic normalization problems with the tsp - normalization and `` intelligently '' decided for a scale - independent zero - sum type signature @xcite .    our _ zerosum _ package can be used on a desktop computer for small data sets and reduced precision .",
    "large clinical studies with several thousand patients require the use of an hpc infrastructure .",
    "we here offer code that can be used for such studies .    in conclusion , we provide a high - performance classification framework independent of prior data normalization , which reduces the number of user - adjustable parameters and should be ideally suited for the transfer of metabolic signatures across labs .",
    "furthermore , we expect that the results presented here also hold for metabolomics data generated by other methods such as mass spectrometry .",
    "the authors thank drs . gunnar schley , carsten willam , and kai - uwe eckardt for providing the urine and plasma specimens of the aki data sets .",
    "financial support : e : med initiative of the german ministry for education and research ( grant 031a428a ) and the german research foundation ( sfb / trr-55 ) .",
    "none .",
    "anderson , p. e. , mahle , d. a. , doom , t. e. , reo , n. v. , delraso , n. j. , raymer , m. l. , _ dynamic adaptive binning : an improved quantification technique for nmr spectroscopic data _ , metabolomics , 2011 , 7(2):179 - 190 .",
    "altenbuchinger , m. , rehberg , t. , zacharias , h. u. , oefner , p. j. , dettmer - wilde , k. , holler , e. , weber , d. , gessner , a. , hiergeist , a. , spang , r. , _ reference point insensitive molecular data analysis _ , bioinformatics , 2016 , doi:10.1093/bioinformatics / btw598 .",
    "dawiskiba , t. , deja , s. , mulak , a. , zbek , a. , jawie , e. , paweka , d. , banasik , m. , mastalerz - migas , a. , balcerzak , w. , kaliszewski , k. , skra , j. , bar , p. , korta , k. , pormaczuk , k. , szyber , p. , litarski , a. , mynarz , p. , _ serum and urine metabolomic fingerprinting in diagnostics of inflammatory bowel diseases _ , world journal of gastroenterology , 2014 , 20(1):163 - 174 .",
    "de meyer , t. , sinnaeve , d. , van gasse , b. , tsiporkova , e. , rietzschel , e. r. , de buyzere , m. l. , gillebert , t. c. , bekaert , s. , martins , j. c. , van criekinge , w. , _ nmr - based characterization of metabolic alterations in hypertension using an adaptive , intelligent binning algorithm _ , 2008 , analytical chemistry , 80(10):3783 - 3790 .",
    "dieterle , f. , ross , a. , schlotterbeck , g. , senn , h. , _ probabilistic quotient normalization as robust method to account for dilution of complex biological mixtures .",
    "application in 1h nmr metabonomics _",
    ", analytical chemistry , 2006 , 78(13):4281 - 90 .",
    "elliott , p. , posma , j. m. , chan , q. , garcia - perez , i. , wijeyesekera , a. , bictash , m. , ebbels , t. m. d. , ueshima , h. , zhao , l. , van horn , l. , daviglus , m. , stamler , j. , holmes , e. , nicholson , j. k. , _ urinary metabolic signatures of human adiposity _ , science translational medicine , 2015 , 7(285):285ra62 .",
    "gronwald , w. , klein , m. s. , kaspar , h. , fagerer , s. r. , nrnberger , n. , dettmer , k. , bertsch , t. , oefner , p. j. , _ urinary metabolite quantification employing 2d nmr spectroscopy _ , analytical chemistry , 2008 , 80(23):9288 - 9297 .",
    "gronwald , w. , klein , m. s. , zeltner , r. , schulze , b .-",
    "reinhold , s. w. , deutschmann , m. , immervoll , a .-",
    "k . , bger , c. a. , banas , b. , eckardt , k .- u .",
    ", oefner , p. j. , _ detection of autosomal dominant polycystic kidney disease by nmr spectroscopic fingerprinting of urine _ , kidney international , 2011 , 79:1244 - 1253 .",
    "hochrein , j. , klein , m. s. , zacharias , h. u. , li , j. , wijffels , g. , schirra , h. j. , spang , r. , oefner , p. j. , gronwald , w. , _ performance evaluation of algorithms for the classification of metabolic ^1^h nmr fingerprints _ , journal of proteome research , 2012 , 11:6242 - 6251 .",
    "hochrein , j. , zacharias , h. u. , taruttis , f. , samol , c. , engelmann , j. , spang , r. , oefner , p. j. , gronwald , w. , _ data normalization of @xmath68h - nmr metabolite fingerprinting datasets in the presence of unbalanced metabolite regulation _ , journal of proteome research , 2015 , 14(8):3217 - 3228 .",
    "keun , h. c. , ebbels , t. m. , antti , h. , bollard , m. e. , beckonert , o. , schlotterbeck , g. , senn , h. , niederhauser , u. , holmes , e. , lindon , j. c. , nicholson , j. k. , _ analytical reproducibility in 1h nmr - based metabonomic urinalysis _",
    ", chemical research in toxicology , 2002 , 15(11 ) , 1380 - 1386 .",
    "ross , a. , schlotterbeck , g. , dieterle , f. , senn , h. , _ nmr spectroscopy techniques for application to metabonomics _",
    ", in lindon , j. c. , nicholson , j. k. , holmes , e. , ( eds . ) , _ nmr spectroscopy techniques for application to metabonomics _ ,",
    "elsevier bv : amsterdam , the netherlands , 2007 , pp .",
    "55 - 112 .",
    "ritchie , m.e . ,",
    "phipson , b. , wu , d. , hu , y. , law , c.w . , shi , w. , smyth , g.k . ,",
    "_ limma powers differential expression analyses for rna - sequencing and microarray studies _ , 2015 , nucleic acids research 43(7 ) , e47 .",
    "saccenti , e. , _ correlation patterns in experimental data are affected by normalization procedures : consequences for data analysis and network inference _ , journal of proteome research , 2016 , doi 10.1021/acs.jproteome.6b00704 .",
    "viant , m. r. , lyeth , b. g. , miller , m. g. , berman , r. f. , _ an nmr metabolomic investigation of early metabolic disturbances following traumatic brain injury in a mammalian model _ ,",
    "nmr in biomedicine , 2005 , 18(8 ) , 507 - 516 .",
    "zacharias , h. u. , schley , g. , hochrein , j. , klein , m. s. , kberle , c. , eckardt , k .- u .",
    ", willam , c. , oefner , p. j. , gronwald , w. , _ analysis of human urine reveals metabolic changes related to the development of acute kidney injury following cardiac surgery _ , metabolomics , 2013 , 9(3):697 - 707 .",
    "zacharias , h. u. , hochrein , j. , klein , m. s. , samol , c. , oefner , p. j. , gronwald , w. , _ current experimental , bioinformatic and statistical methods used in nmr based metabolomics _",
    ", current metabolomics , 2013 , 1(3):253 - 268(16 ) .",
    "zacharias , h. u. , hochrein , j. , vogl , f. c. , schley , g. , mayer , f. , jeleazcov , c. , eckardt , k .- u .",
    ", willam , c. , oefner , p. j. , gronwald , w. , _ identification of plasma metabolites prognostic of acute kidney injury after cardiac surgery with cardiopulmonary bypass _ , journal of proteome research , 2015 , 14(7):2897 - 2905 ."
  ],
  "abstract_text": [
    "<S> * motivation : * metabolomics data is typically scaled to a common reference like a constant volume of body fluid , a constant creatinine level , or a constant area under the spectrum . </S>",
    "<S> such normalization of the data , however , may affect the selection of biomarkers and the biological interpretation of results in unforeseen ways .    </S>",
    "<S> * results : * first , we study how the outcome of hypothesis tests for differential metabolite concentration is affected by the choice of scale . </S>",
    "<S> furthermore , we observe this interdependence also for different classification approaches . </S>",
    "<S> second , to overcome this problem and establish a scale - invariant biomarker discovery algorithm , we extend linear zero - sum regression to the logistic regression framework and show in two applications to @xmath0h nmr - based metabolomics data how this approach overcomes the scaling problem .    </S>",
    "<S> * availability : * logistic zero - sum regression is available as an _ r _ package as well as a high - performance computing implementation that can be downloaded at https://github.com/rehbergt/zerosum . </S>"
  ]
}