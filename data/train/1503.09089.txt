{
  "article_text": [
    "there exists a vast number of papers dealing with the shallow water problem .",
    "aspects of the propagation of weakly nonlinear , dispersive waves are still beeing studied .",
    "last year we published two articles @xcite in which korteveg  de vries type equations were derived in weakly nonlinear , dispersive and long wavelength limit .",
    "the second order kdv type equation was derived .",
    "the second order kdv equation @xcite , sometimes called `` extended kdv equation '' , was obtained for the case with a flat bottom . in derivation of the new equation we adapted the method described in @xcite . in @xcite ,",
    "an analytic solution of this equation in the form of a particular soliton was found , as well .",
    "it is well known , see , e.g.  @xcite , that for the kdv equation there exists an infinite number of invariants , that is , integrals over space of functions of the wave profile and its derivatives , which are constants in time .",
    "looking for analogous invariants for the second order kdv equation we met with some problems even for the standard kdv equation ( which is first order in small parameters ) .",
    "this problem appears when energy conservation is considered .    in this paper",
    "we reconsider invariants of the kdv equation and formulas for the total energy in several different approaches and different frames of reference ( fixed and moving ones ) .",
    "we find that the invariant  @xmath0 , sometimes called the energy invariant , does not always have that interpretation",
    ". we also give a proof that for the second order kdv equation , obtained in @xcite ,  @xmath1 is not an invariant of motion .",
    "there are many papers considering higher - order kdv type equations . among them",
    "we would like to point out works of byatt - smith @xcite , kichenassamy and olver @xcite , marchant @xcite , zou and su @xcite , tzirtzilakis _ et.al .",
    "_ @xcite and burde @xcite .",
    "it was shown that if some coefficients of the second order equation for shallow water problem ( [ etaab ] ) are diferent or zero then there exists a hierarchy of solition solutions .",
    "kichenassamy and olver @xcite even claimed that for second order kdv equation solitary solutions of appropriate form can not exist .",
    "this claim was falsified in our paper @xcite where the analytic solution of the second order kdv equation ( [ etaab ] ) was found . concerning the energy conservation",
    "there are indications that collisions of solitons @xcite which are solutions of higher order equations of kdv type can be inelastic @xcite .    the paper is organized as follows . in section [ equations ] several frequently used forms of kdv equations are recalled with particular attention to transformations between fixed and moving reference frames . in section [ invariants ]",
    "the form of the three lowest invariants of kdv equations is derived for different forms of the equations . in section [ energy ]",
    "we show that the energy calculated from the definition @xmath2 has no invariant form .",
    "section [ varia ] describes the variational approach in a potential formulation which gives a proper kdv equation but fails in obtaining second order kdv equations . in the next section",
    "the proper invariants are obtained from luke s lagrangian density .",
    "section [ concl ] summarizes conclusions on the energy for kdv equation . in section",
    "[ extended ] we apply the same formalism to calculate energy for waves governed by the extended kdv equation ( second order ) .",
    "we found that energy is not conserved neither in fixed coordinate system nor in the moving frame .",
    "the geometry of shallow water waves is presented in fig .",
    "[ geom ] .    in @xcite we derived an equation , second order in small parameters , in the fixed reference system and with scaled nondimensional variables containing terms for bottom fluctuations .",
    "they will not be considered here .    for a flat bottom that equation reduces to the second order",
    "kdv type equation , identical with  ( * ? ?",
    "* eq .  ( 21 ) ) for @xmath3 , that is , @xmath4 subscripts denote partial differentiation .",
    "small parameters  @xmath5 are defined by ratios of the wave amplitude  @xmath6 , the average water depth  @xmath7 and mean wavelength  @xmath8 @xmath9    equation ( [ etaab ] ) was earlier derived in @xcite and called `` the extended kdv equation '' .",
    "limitation to the first order in small parameters yields the kdv equation in a fixed coordinate system @xmath10 transformation to a _ moving frame _   in the form @xmath11 allows us to remove the term  @xmath12 in the kdv equation in a frame moving withthe velocity of sound @xmath13 @xmath14 the explicit form of the scaling leading to equations ( [ etaab ] )  ( [ kdv1 m ] ) is given by ( [ przeskalowanie ] ) .",
    "problems with mass , momentum and energy conservation in the kdv equation were discussed in @xcite recently . in this paper",
    "the authors considered the kdv equations in the original dimensional variables .",
    "then the kdv equatios are @xmath15 in a fixed frame of reference and @xmath16 in a moving frame . in both , @xmath17 , and ( [ ruch ] )",
    "is obtained from ( [ nieruch ] ) by setting @xmath18 and dropping the prime sign . in our present paper",
    "we discuss the energy formulas obtained both in fixed and moving frames of reference for kdv ( [ kdv1 ] ) , ( [ kdv1 m ] ) , ( [ nieruch ] ) , ( [ ruch ] ) .",
    "there seem to be some contradictions in the literature because the form of some invariants and the energy formulas differ in different sources because of using different reference frames and/or different scalings . in this paper",
    "we address this problems .",
    "the second goal is to present some invariants for a kdv type equation of the second order ( [ etaab ] ) .",
    "what invariants can be attributed to equations ( [ etaab ] )  ( [ kdv1 ] ) and ( [ nieruch ] )  ( [ ruch ] ) ?",
    "it is well known , see , e.g. ( * ? ? ?",
    "* ch .  5 ) , that an equation of the form @xmath19 where neither  @xmath20 ( an analog to density ) nor  @xmath21 ( an analog to flux ) contain partial derivatives with respect to  @xmath22 , corresponds to some _",
    "conservation law_. it can be applied , in particular , to kdv equations ( where there exist an infinite number of such conservation laws ) and to the equations of kdv type like ( [ etaab ] ) .",
    "functions  @xmath20 and  @xmath21 may depend on  @xmath23 but not @xmath24 .",
    "if both functions  @xmath20 and  @xmath25 are integrable on  @xmath26 and @xmath27 const ( soliton solutions ) , then integration of equation ( [ coneq ] ) yields @xmath28 since @xmath29 the same conclusion applies for periodic solutions ( cnoidal waves ) , when in the integrals ( [ coneq1 ] ) , ( [ limits ] ) limits of integration @xmath26 are replaced by @xmath30 , where @xmath31 is the space period of the cnoidal wave ( the wave length ) .      for the kdv equation ( [ kdv1 ] ) the two first invariants can be obtained easily . writing ( [ kdv1 ] ) in the form @xmath32 one immediately obtains the conservation of mass ( volume ) law @xmath33 similarly , multiplication of ( [ kdv1 ] ) by  @xmath34   gives @xmath35 resulting in the invariant of the form @xmath36 in the literature of the subject , see , e.g.   @xcite ,  @xmath37 is attributed to momentum conservation .",
    "invariants @xmath38 have the same form for all kdv equations ( [ kdv1 ] ) , ( [ kdv1 m ] ) , ( [ kdvm ] ) , ( [ nieruch ] ) , ( [ ruch ] ) .",
    "denote the left hand side of ( [ kdv1 ] ) by  @xmath39 and take @xmath40 the result , after simplifications is @xmath41 then the next invariant for kdv in the fixed reference frame ( [ kdv1 ] ) is @xmath42    the same invariant is obtained for the kdv in the moving frame ( [ kdv1 m ] ) . the same construction like ( [ csti3 ] ) but for equation ( [ kdv1 m ] ) results in @xmath43 then the next invariant for kdv equation in moving reference frame ( [ kdv1 ] ) is @xmath44    the procedure similar to those described above leads to the same invariants for both equations ( [ nieruch ] ) and ( [ ruch ] ) where kdv equations are written in dimensional variables .",
    "to see this , it is enough to take  @xmath45 , where  @xmath46 is the lhs either of ( [ nieruch ] ) or ( [ ruch ] ) . for equation ( [ nieruch ] )",
    "the conservation law is @xmath47 whereas for equation ( [ ruch ] ) the flux term is different @xmath48 but in both cases the same @xmath0 invariant is obtained as @xmath49    * conclusion  * _ invariants @xmath0 have the same form for fixed and moving frames of reference when the transformation from fixed to moving frame scales  @xmath50 and @xmath22 in the same way ( e.g. @xmath51 and @xmath52 ) . when scaling factors are different , like in ( [ tr ] ) , then the form of @xmath0 in the moving frame differs from the form in the fixed frame , see appendix  [ app1 ] .",
    "_    for those solutions of kdv which preserve their shapes during the motion , that is , for cnoidal solutions and single soliton solutions , integrals of any power of  @xmath53 and any power of arbitrary derivative of the solution with respect to  @xmath50 are invariants .",
    "that is , @xmath54 where  @xmath55 , and  @xmath56 is an arbitrary real number . then an arbitrary linear combination of  @xmath57 is an invariant , as well .",
    "can we construct invariants for kdv type equations of the second order ?",
    "let us try to take @xmath58 for equation ( [ etaab ] ) .",
    "then we find that all terms , except  @xmath24 , can be written as @xmath25 , as @xmath59 dx \\nonumber\\nonumber \\\\ & = & \\hspace{2ex } \\eta + \\frac{3}{4}\\alpha \\eta^2 + \\frac{1}{6}\\beta \\eta_{2x }   - \\frac{1}{8}\\alpha^2\\eta^3    \\\\ & & \\hspace{4ex } +   \\alpha\\beta\\left(\\frac{13}{48}\\eta_x^2 + \\frac{5}{12}\\eta\\eta_{2x}\\right ) + \\frac{19}{360}\\beta^2\\eta_{4x}. \\nonumber\\end{aligned}\\ ] ] as ( [ coneq2 ] ) depends on  @xmath34   and space derivatives and also since all those functions vanish when  @xmath60 , the conservation law for mass ( volume ) @xmath61 holds for the second order equation .",
    "( conservation law ( [ coneq3 ] ) holds for the equation with an uneven bottom , as well . )",
    "until now we did not find any other invariants for the secod order equations .",
    "moreover , we can show that the integral  @xmath62 ( [ i2 ] )  * is no longer * an invariant of the second order kdv equation ( [ etaab ] ) . upon multiplication of equation ( [ etaab ] ) by  @xmath34",
    "one obtains @xmath63",
    "+ \\frac{1}{8 } \\alpha\\beta\\ , \\eta\\eta_x\\eta_{2x } \\;.",
    "\\nonumber\\end{aligned}\\ ] ] the last term in ( [ e2a ] ) can not be expressed as  @xmath64 .",
    "therefore  @xmath65   is not a conserved quantity .",
    "the invariant @xmath0 is usually referred to as the energy invariant . is this really the case ?",
    "the hydrodynamic equations for an incompressible , inviscid fluid , in irrotational motion and under gravity in a fixed frame of reference , lead to a kdv equation of the form @xmath66 we will find the function @xmath67 obtained as a byproduct in derivation of kdv , useful in what follows . for more details see appendix  [ app2 ] or ( * ? ? ?",
    "* chapter  5 ) .",
    "tildas denote scaled dimensionless quantities .    now construct the total energy of the fluid from the definition .",
    "the total energy is the sum of potential and kinetic energy . in our two - dimensional system the energy in original ( dimensional coordinates ) is @xmath68    equations ( [ nkdv ] ) and ( [ w1 ] ) are obtained after scaling @xcite .",
    "we now have dimesionless variables , according to @xmath69 and @xmath70 @xmath71 note , that the factor in front of the integrals has the dimension of energy .    in the following ,",
    "we omit signs  @xmath72 , having in mind that we are working in dimensionless variables .",
    "integration in ( [ enpotnzm ] ) with respect to  @xmath73 yields @xmath74 . \\nonumber\\end{aligned}\\ ] ] after renormalization ( substraction of constant term @xmath75 ) one obtains @xmath76    in kinetic energy we use the velocity potential expressed in the lowest ( first ) order @xmath77 where @xmath78 was defined in ( [ w1 ] ) . now the bracket in the integral ( [ enkinnzm ] ) is @xmath79 inegration with respect to the vertical corrdinate  @xmath73 gives , up to the same order , @xmath80   dx    \\\\ & = & \\frac{1}{2 } \\rho g h^2 l \\!\\ !",
    "\\int^{+\\infty}_{-\\infty } \\!\\!\\!\\ ! \\alpha^2",
    "\\left [ f_x^2 + \\alpha f_x^2\\eta + \\frac{1}{3 } \\beta \\left(f_{xx}^2 -f_x f_{xxx}\\right)\\right ]   dx . \\nonumber\\end{aligned}\\ ] ] in order to express energy through the elevation funcion  @xmath34 we use ( [ w1 ] ) .",
    "we then substitute  @xmath81 in terms of the third order and  @xmath82   in terms of the second order    @xmath83   dx   \\nonumber \\\\ & = & \\frac{1}{2 } \\rho g h^2 l\\ ; \\alpha^2 \\left [ \\int^{+\\infty}_{-\\infty }    \\left ( \\eta^2+\\frac{1}{2}\\alpha \\eta^3   \\right )   dx \\right .",
    "\\\\ & & \\hspace{10ex } \\left .",
    "+ \\int^{+\\infty}_{-\\infty }   \\frac{1}{3}\\beta \\left(\\eta_x^2+\\eta\\eta_{xx } \\right )   dx\\right ] .\\nonumber\\end{aligned}\\ ] ]    the last term vanishes as @xmath84 therefore the total energy in the fixed frame is given by @xmath85 the energy ( 39 ) in a fixed frame of reference * has non invariant form*. the last term in ( 39 ) results in small deviations from energy conservation only when @xmath86 changes in time in soliton s reference frame , what occurs only during soliton collision .",
    "this deviations are discussed and illustrated in section vi  e.    the result ( [ ecrz1 ] ) gives the energy in powers of  @xmath34 only .",
    "the same structure of powers in  @xmath34 was obtained by the authors of @xcite , who work in dimensional kdv equations ( [ nieruch ] ) and ( [ ruch ] ) .",
    "on page 122 they present a non - dimensional energy density @xmath87 in a frame moving with the velocity @xmath88 .",
    "then , if @xmath89 is set , the energy density in a fixed frame is proportional to @xmath90 as the formula is obtained up to second order in @xmath91 .",
    "however , the third order term is @xmath92 , so the formula up to the third order in @xmath91 becomes @xmath93 this energy density contains the same terms like ( [ ecrz1 ] ) and does not contain the term @xmath94 , as well .",
    "energy calculated from the definition does not contain a proper invariant of motion .",
    "now consider the total energy according to ( 28 ) calculated in a frame moving with the velocity of sound @xmath17 .",
    "using the same scaling ( 29 ) to dimensionless variables we note that in these variables @xmath95 . as pointed by ali and kalisch [ 8,sect .  3 ] working in such system",
    "one has to replace @xmath96 by the horizontal velocity in a moving frame , that is by @xmath97 . then repeating the same steps as in the previous subsection yields the energy expressed by invariants @xmath98\\ ! d\\tilde{x }",
    "\\nonumber \\\\   & = & \\rho g h^2 l \\left(-\\frac{1}{2 } \\alpha i^{(1 ) } + \\frac{1}{4 } \\alpha^2 i^{(2 ) } + \\frac{1}{2 } \\alpha^3 i^{(3 ) } \\right).\\end{aligned}\\ ] ] the crucial term  @xmath99 in ( [ etmov ] ) appears due to integration over vertical variable of the term  @xmath100 supplied by @xmath101 .",
    "some attempts at the variational approach to shallow water problems are summarized in g.b .",
    "whitham s book ( * ? ? ?",
    "* sect  16.14 ) .",
    "for kdv as it stands , we can not write a variational principle directly .",
    "it is necessary to introduce a velocity potential .",
    "the simplest choice is to take  @xmath102",
    ". then equation ( [ kdv1 ] ) in the fixed frame takes the form @xmath103 the appropriate lagrangian density is @xmath104 indeed , the euler  lagrange equation obtained from lagrangian ( [ l1wn ] ) is just ( [ e1p ] ) .    for our moving reference frame the substitution  @xmath102 into ( [ kdv1 m ] )",
    "gives @xmath105 so , the appropriate lagrangian density is @xmath106 again , the euler  lagrange equation obtained from lagrangian ( [ l1wr ] ) is just ( [ e1pr ] ) .",
    "the hamiltonian for the kdv equation in a fixed frame ( [ kdv1 ] ) can be obtained in the following way . defining generalized momentum  @xmath107 , where  @xmath108 is given by ( [ l1wn ] ) , one obtains @xmath109 dx=   \\int_{-\\infty}^{\\infty } \\left[\\frac{1}{2 } \\varphi_{x}^2 + \\frac{\\alpha}{4}\\varphi_{x}^3-\\frac{\\beta}{12 } \\varphi_{xx}^2\\right ] dx \\nonumber \\\\ & = & \\int_{-\\infty}^{\\infty } \\left[\\frac{1}{2}\\eta^2+\\frac{1}{4}\\alpha\\left ( \\eta^3-\\frac{\\beta}{3\\alpha } \\eta_{x}^2\\right)\\right ] dx \\,.\\end{aligned}\\ ] ] the energy is expressed by invariants  @xmath110 so it is a constant of motion .    the same procedure for kdv in a moving frame ( [ kdv1 m ] ) gives @xmath111 dx=\\int_{-\\infty}^{\\infty } \\left [ \\frac{\\alpha}{4 } \\varphi_{x}^3-\\frac{\\beta}{12 } \\varphi_{xx}^2\\right ] dx \\nonumber \\\\ & = & \\frac{1}{4}\\alpha \\int_{-\\infty}^{\\infty}\\left(\\eta^3-\\frac{\\beta}{3\\alpha } \\eta_{x}^2\\right ) dx \\,.\\end{aligned}\\ ] ] the hamiltonian ( [ hh2 ] ) only consists  @xmath0 .",
    "the constant of motion in a moving frame is @xmath112    the potential formulation of the lagrangian , described above , is succesful for deriving kdv equations both for fixed and moving reference frames .",
    "it fails , however , for the second order kdv equation  ( [ etaab ] ) .",
    "we proved that there exists a nonlinear expression of @xmath113 , such that the resulting euler ",
    "lagrange equation differs very little from equation ( [ etaab ] ) .",
    "the difference lies only in the value of one of the coefficients in the second order term @xmath114 .",
    "particular values of coefficients in this term also cause the lack of the  @xmath62 invariant for second order kdv equation , ( see ( [ e2a ] ) ) .",
    "the full set of euler equations for the shallow water problem , as well as kdv equations ( [ kdv1 ] ) , ( [ kdvm ] ) , and second order kdv equation ( [ etaab ] ) can be derived from luke s lagrangian @xcite , see , e.g. @xcite .",
    "luke points out , however , that his lagrangian is not equal to the difference of kinetic and potential energy .",
    "lagrange equations obtained from @xmath115 do not have the proper form at the boundary . instead ,",
    "luke s lagrangian is the sum of kinetic and potential energy suplemented by the @xmath116 term which is necessary in dynamical boundary condition .",
    "in chapter 5.2 of the infeld and rowlands book the authors present a derivation of the kdv equation from the euler ( hydrodynamic ) equations using a single small parameter  @xmath117 .",
    "moreover , they show that the same method allows us to derive the kadomtsev  petviashvili ( kp ) equation @xcite for water waves and also nonlinear equations for ion acoustic waves in a plasma @xcite .",
    "the authors first derive equations of motion , then construct a lagrangian and look for constants of motion . for the purpose of this paper and for comparison to results obtained in the next subsections it is convenient to present their results starting from luke s lagrangian density .",
    "that density can be written as ( here @xmath118)@xmath119 dz   \\,.\\ ] ]    in chapter 5.2.1 of @xcite the authors introduce scaled variables in a movimg frame ( @xmath117 plays a role of small parameter and if  @xmath120 , then kdv equation is obtained ) .",
    "then ( for details , see appendix  [ app2 ] or ( * ? ? ?",
    "* chapter  5.2 ) ) @xmath121 substitution of the above formulas into the expression [  ] under the integral in ( [ lluke ] ) gives @xmath122 } [ ~ ] & = & z - \\varepsilon f_\\xi + \\varepsilon^2\\left(f_\\tau+\\frac{1}{2}f_\\xi^2 + \\frac{z^2}{2}f_{\\xi\\xi\\xi } \\right )   \\\\ & & \\hspace{2ex } + \\varepsilon^3\\frac{z^2}{2}\\left[-f_{\\xi\\xi\\tau } + ( f_{\\xi\\xi}^2-f_\\xi f_{\\xi\\xi\\xi } ) \\right ] + o(\\varepsilon^4).\\nonumber\\end{aligned}\\ ] ] * remark *   the full lagrangian is obtained by integration of the lagrangian density ( [ lluke ] ) with respect to  @xmath50 .",
    "integration limits are  @xmath26 for a soliton solutions , or  @xmath123 $ ] , where  @xmath124wave length ( space period ) for cnoidal solutions .",
    "integration by parts and properties of the solutions at the limits , see ( [ limits ] ) , allow us to use the equivalence @xmath125 .",
    "therefore @xmath126 } [ ~ ] & = & z - \\varepsilon f_\\xi + \\varepsilon^2\\left(f_\\tau+\\frac{1}{2}f_\\xi^2 + \\frac{z^2}{2}f_{\\xi\\xi\\xi } \\right ) \\\\ & & \\hspace{2ex }   + \\varepsilon^3\\frac{z^2}{2}\\left[-f_{\\xi\\xi\\tau } + 2f_{\\xi\\xi}^2\\right ] + o(\\varepsilon^4).\\nonumber\\end{aligned}\\ ] ] integration over @xmath73 gives ( note that @xmath127 ) @xmath128 \\nonumber \\\\ & &    + \\frac{1}{3}(1+\\varepsilon\\eta)^3 \\left[\\frac{1}{2}\\varepsilon^2 f_{\\xi\\xi\\xi } -\\frac{1}{2}\\varepsilon^3   f_{\\xi\\xi\\tau } + \\varepsilon^3 f_{\\xi\\xi}^2   \\right].\\end{aligned}\\ ] ] write ( [ luke ] ) up to third order in  @xmath117 @xmath129 it is easy to show , that @xmath130 the hamiltonian density reads as @xmath131 .",
    "\\nonumber\\end{aligned}\\ ] ] dropping the constant term one obtains the total energy as @xmath132d\\xi.\\end{aligned}\\ ] ]    now , we need to express @xmath133 and its derivatives by @xmath34 and its derivatives .",
    "we use ( [ w1 ] ) replacing @xmath91 and @xmath134 by @xmath117 , that is , @xmath135 then the total energy in a moving frame is expressed in terms of the second and the third invariants @xmath136.\\ ] ]    note that the term  @xmath137   occuring in the third order invariant originates from three terms appearing in  @xmath138 ,  @xmath139   and @xmath116 ( see terms  @xmath140   and  @xmath141   in ( [ 5.2.20 ] ) ) .",
    "the original lagrangian density in luke s paper @xcite is @xmath142 dy   \\,.\\ ] ] after scaling as in @xcite @xmath143 we obtain @xmath144 the lagrangian density in scaled variables becomes ( @xmath145 ) @xmath146d\\tilde{y}\\nonumber \\\\ & &   + \\frac{1}{2 }   \\rho g h^2 ( 1+\\alpha\\eta)^2 .",
    "\\end{aligned}\\ ] ] so , in dimensionless quatities @xmath147d\\tilde{y } + \\frac{1}{2 } \\alpha\\eta^2,\\ ] ] where the constant term and the term proportional to  @xmath34 in the expansion of  @xmath148 are omitted .",
    "the form ( [ ll ] ) is identical with eq .",
    "( 2.9 ) in marchant & smyth @xcite .",
    "the full lagrangian is obtained by integration over  @xmath50 . in dimensionless variables ( @xmath149 )",
    "it gives @xmath150d\\tilde{y}\\ ! + \\ !",
    "\\frac{1}{2 } \\alpha\\eta^2 \\right]\\ ! d\\tilde{x}.\\ ] ] the factor in front of the integral ,  @xmath151 , has the dimension of energy .",
    "next , the signs ( @xmath72 ) will be omitted , but we have to remember that we are working in scaled dimensionless variables in a fixed reference frame .",
    "express the lagrangian density by  @xmath34   and  @xmath152 .",
    "now , up to first order in small parameters @xmath153 then the expression under the integral in ( [ ll ] ) becomes @xmath154 = f_t - \\frac{1}{2 } \\beta y^2 f_{xxt } + \\frac{1}{2 } \\alpha f_x^2 + \\frac{1}{2 } \\alpha\\beta y^2 \\left(- f_x f_{xxx } + f_{xx}^2\\right).\\ ] ] from properties of solutions at the limits  @xmath155 .",
    "integration of ( [ pot2 ] ) over  @xmath73 yields @xmath156    the dimensionless hamiltonian density is + ( @xmath157 ) @xmath158\\!.\\ ] ] again , we need to express the hamiltonian by  @xmath34 and its derivatives , only . inserting @xmath159 into ( [ h02 ] ) and leaving terms up to third order one obtains @xmath160.\\ ] ]",
    "the energy is @xmath161 dx \\nonumber \\\\ & = &   -\\left [ \\alpha^2   \\ ! \\int_{-\\infty}^{\\infty } \\!\\!\\eta^2 dx + \\frac{1}{4 } \\alpha^3 \\!\\int_{-\\infty}^{\\infty } \\!\\!\\eta^3 dx \\right ] \\end{aligned}\\ ] ] since the integral of the @xmath162 term vanishes . here , in the same way as in calculations of energy directly from the definition ( [ ecrz1 ] ) ,",
    "the energy is expressed by integrals of @xmath163 and @xmath164 .",
    "the term proportional to @xmath165 is not present in ( [ h0ee ] ) , because it was dropped earlier @xcite .",
    "transforming into the moving frame @xmath166 @xmath167 @xmath168 up to second order @xmath169 \\nonumber \\\\   & = & \\frac{1}{2 } \\alpha f_{\\bar{x}}^2 + \\alpha\\beta y^2 f_{\\bar{x}\\bar{x}}^2.\\end{aligned}\\ ] ] therefore the expression under the integral in ( [ ll ] ) is @xmath170 =   -f_{\\bar{x } } + \\frac{1}{2 } \\beta y^2 f_{\\bar{x}\\bar{x}\\bar{x } } + \\alpha ( f_{\\bar{t}}- \\frac{1}{2 } \\beta y^2 f_{\\bar{x}\\bar{x}\\bar{t } } ) + \\frac{1}{2 } \\alpha f_{\\bar{x}}^2 + \\alpha\\beta y^2 f_{\\bar{x}\\bar{x}}^2.\\ ] ]    integration yields @xmath171    like in ( [ h02 ] ) above , the hamiltonian density is @xmath172 .",
    "\\nonumber\\end{aligned}\\ ] ] expressing @xmath173 by ( [ fx2 ] ) one obtains @xmath174 . \\nonumber\\end{aligned}\\ ] ] finally the energy is given by @xmath175 since integrals from terms with  @xmath176   vanish at integration limits , and  @xmath177 .",
    "the invariant term proportional to @xmath165 is not present in ( [ hhuu2 ] ) , because it was dropped in ( [ ll ] ) .",
    "if we include that term , the total energy is a linear combination of all three lowest invariants , @xmath178 . + * comment  * _ an almost identical formula for the energy in a moving frame , for kdv expressed in dimensional variables ( [ ruch ] ) , was obtained in @xcite . that energy is expressed by all three lowest order invariants @xmath179 as well .",
    "translation of ( [ kal3 ] ) to nondimensional variables yields @xmath180 _      the total energy in the fixed frame is given by equation  ( [ ecrz1 ] ) . taking into account its non - dimensional part",
    "we may write @xmath181 dx \\nonumber \\\\ & = & \\alpha i^{(1 ) } + \\alpha^2 i^{(2)}+\\frac{1}{4 } \\int_{-\\infty}^{\\infty}(\\alpha\\eta)^3 dx\\end{aligned}\\ ] ] in order to see how much the changes of @xmath182 violate energy conservation we will compare it to the same formula but expressed by invariants @xmath183    the time dependence of @xmath182 and @xmath184 is presented in fig .",
    "[ s3inv ] for a 3-soliton solution of kdv ( [ kdv1 ] ) .",
    "presented is time evolution in the interval @xmath185 $ ] .",
    "the shape of the 3-soliton solution is presented only for three times @xmath186 in order to show shapes changing during the collision .    for presentation",
    "the example of a 3-soliton solution with amplitudes equal 1,5 , 1 and 0.5 was chosen . in fig .",
    "[ s3ev ] the positions of solutions at given times were artificially shifted to set them closer to each other . the plots in figs .  [ s3inv ] and [ s3ev ] for @xmath187 are symmetric to those which are shown in the figures .    for this example",
    "the relative discrepancy of the enregy @xmath182 from the constant value , is very small @xmath188 however , the @xmath184 energy is conserved with numerical precision of thirteen decimal digits in this example . in a similar example with a 2-soliton solution ( with apmlitudes 1 and 0.5 ) the relative error ( [ enonc ] ) was even smaller , with the value @xmath189 .",
    "this suggests that the degree of nonconservation of energy increases with @xmath190 , where @xmath190 is the number of solitons in the solution .    [",
    "cols=\"<,^,^,^,^,^ \" , ]",
    "the main conclusions can be formulated as follows    * the invariants of kdv in fixed and moving frames have the same form .",
    "( of course when we have the same scaling factor for @xmath50   and @xmath22 in the transformation between frames ) . *",
    "we confirmed some known facts .",
    "firstly , that the usual form of the energy  @xmath2   is not always expressed by invariants only .",
    "the reason lies in the fact , as pointed out by luke in @xcite , that the euler ",
    "lagrange equations obtained from the lagrangian  @xmath115   do not supply the right boundary conditions .",
    "secondly , the variational approach based on luke s lagrangian density provides the right euler equations at the boundary and allows for a derivation higher order kdv equations . * in the frame moving with the velocity of sound all energy components are expressed by invariants .",
    "energy is conserved .",
    "* numerical calculations confirm that invariants  @xmath191   in the forms ( [ i1 ] ) , ( [ i2 ] ) , ( [ i3e ] ) , ( [ i3em ] ) are exact constants of motion for two- and three - soliton solutions , both for fixed and moving coordinate systems . in all performed tests",
    "the invariants were exact up to fourteen digits in double precision calculations .",
    "* for the extended kdv equation ( [ etaab ] ) we have only found one invariant of motion @xmath192 ( [ coneq3 ] ) . * the total energy in the fixed coordinate system as calculated in ( [ ecrz1 ] )",
    "is not exactly conserved but only altered during collisions , even then by minute quantities ( an order of magnitude smaller than expected ) .",
    "details in figure caption of figure [ s3inv ] .    a summary of these conclusions can be found in table  [ tab ] .",
    "in this section we calculate energy formula coresponding to a wave motion governed by second order equations in scaled variables , that is the equation ( [ etaab ] ) for the fixed coordinate system and the correponding equation for a moving coordinate system . as previosly",
    "we compare energies calculated from the definition with those luke s lagrangian .        in section [ energy ] a , total energy of the wave governed by kdv equation , that is the equation ( [ kdv1 ] ) with terms only up to first order in small parameters was obtained in ( [ ecrz1 ] ) . in calculation according to eq .",
    "( [ etaab ] ) the potential energy is expressed by the same formula ( [ eprz1 ] ) as previously for kdv equation . in the expression for kinetic energy",
    "the velocity potential has to be expanded to second order in small parameters @xmath193 with derivatives @xmath194 integrating over @xmath73 and retaining terms up to fourth order yields @xmath195 dx . \\nonumber\\end{aligned}\\ ] ] expression ( [ ek4 ] ) limited to first line gives kinetic energy for kdv equation , see ( [ ekrz1 ] ) .",
    "insertion ( [ f1x2 ] ) and its derivatives into ( [ ek4 ] ) gives @xmath197 dx .",
    "\\nonumber\\end{aligned}\\ ] ] from properties of solutions at @xmath60 terms with @xmath134 and @xmath198 in square bracket vanish and the term with @xmath162 can be written form .",
    "finally one obtains @xmath199\\ !",
    "dx.\\ ] ] then total energy is the sum of ( [ eprz1a ] ) and ( [ ek4b ] ) @xmath200   dx . \\nonumber\\end{aligned}\\ ] ]        calculate energy in the same way as in section [ lukl ] , c , but in one order higher . in",
    "scaled coordinates lagrangian density is expressed by ( [ ll ] ) ( here we keep infinite constant term ) @xmath201\\ , dy \\right .",
    "\\nonumber \\\\ & & \\left .",
    "\\hspace{8ex } + \\frac{1}{2}(1+\\alpha\\eta)^2 \\right\\ } .\\end{aligned}\\ ] ] from ( [ velp ] ) we have @xmath202 inserting ( [ phit ] ) and ( [ velpx ] ) into ( [ luke1 ] ) , integrating over @xmath73 and retaining terms up to third order one obtains ( constant term @xmath203 i d dropped ) @xmath204 the the hamiltonian density @xmath205 is @xmath206 now , we use @xmath78 in the second order ( [ f1x2 ] ) and its derivatives .",
    "insertion these expressions into ( [ hlyy ] ) nd retention terms up to thired order yields @xmath207 the energy is obtained by integration of ( [ hlyy1 ] ) over @xmath50 ( using integration by parts and properties of @xmath34 and its derivatives at @xmath60 )",
    ". then terms with @xmath162 and @xmath208 vanish .",
    "the final result is @xmath209 dx , \\nonumber \\end{aligned}\\ ] ] the same as ( [ ecrz2 ] ) but with the opposite sign .",
    "let us follow arguments given by ali and kalisch ( * ? ? ?",
    "3 ) and used already in section [ energy ] b. working in a moving frame one has to replace @xmath96 by the horizontal velocity in a moving frame , that is , @xmath210 .",
    "then in a frame moving with the sound velocity we have @xmath211 then the expression under integral over @xmath73 in ( [ enkinnzm ] ) becomes ( in the following terms up to fourth order are kept ) @xmath212      then insertion @xmath78 ( [ f1x2 ] ) and its derivatives yields @xmath214 dx,\\nonumber\\end{aligned}\\ ] ] where constant term is dropped .",
    "using properties of solutions at @xmath60 this expression can be simplified to @xmath215\\ ! dx.\\end{aligned}\\ ] ] then total energy is @xmath216\\ !",
    "dx.\\end{aligned}\\ ] ]            then hamiltonian density @xmath224 after insertion of ( [ luk3 ] ) into ( [ ham ] ) yields @xmath225 in order to express ( [ ham3 ] ) by @xmath34 only we use @xmath173 in the form ( [ f1x2 ] ) and its derivatives .",
    "it gives @xmath226      from properties of solution integrals of terms with @xmath228 vanish and terms with @xmath229 can be simplified .",
    "finally , energy is given by the follwing expression @xmath230 dx.\\nonumber \\end{aligned}\\ ] ]            in order to check energy conservation for the extended kdv equation ( [ etaab ] ) we performed several numerical tests .",
    "first , discuss energy conservation in a fixes frame .",
    "we calculated time evolution governed by the equation ( [ etaab ] ) of waves which initial shape was given by 1- , 2- and 3-soliton solutions of the kdv ( first order ) equations . for presentation",
    "the following initial conditions were chosen .",
    "3-soliton solution have amplitudes 1.5 , 1 and 0.25 , 2-soliton solution have amplitudes 1 and 0.5 and 1-soliton solution the amplitude 1 .",
    "the changes of energy presented in figs .",
    "[ enonn ] and [ enonr ] are qualitatively the same also for different amplitudes .",
    "an example of such time evolution for 3-soliton solution is presented in fig .",
    "time range in fig .",
    "[ 3sn ] contains initial shape of 3-soliton solution with almost separated solitons at @xmath234 , intermediate shapes and almost ideal overlap of solitons at @xmath235 . in order to do not obscure details",
    "the subsequent shapes are shifted verticaly with respect to the previous ones .",
    "note additional slower waves after the main one which are generated by second order terms of the equation ( [ etaab ] ) , that were already discussed in @xcite .",
    "we see that the total energy for waves which move according to the extended kdv equation is * not * conserved .",
    "although energy variations are generally small ( in time range considered they do not extend 0.001% , 0.004% and 0.005% for 1- , 2- , 3-soliton waves , respectively ) they increase with more complicated waves .",
    "for additional check of numerics the invariant @xmath236 for the eaquation ( [ etaab ] ) was plotted as mass . in spite of approximate integration the value of @xmath192",
    "was obtained constant up to 10 digits for all initial conditions .",
    "the time range of the evolution was chosen for a convenient comparison with the numerical results obtained in fixed reference frame , that is 2- and 3-soliton waves move from separate solitons to fully colliding time instant .",
    "the convention of symbols is the same as in fig .",
    "[ enonr ] .",
    "the energy is calculated according to the formula ( [ etmfrrz2 ] ) . in moving coordinate system energy variations are even greater than in the fixed reference frame , because in the time period considered it approaches values of 0.02% , 0.12% and 0.2% for 1- , 2- and 3-soliton waves , respectively .",
    "this increase of relative time variations of energy can not be atributed only to two times smaller leading term ( @xmath238 ) in ( [ etmfrrz2 ] ) with respect to ( [ ecrz2 ] ) . again , in spite of approximate integration the value of @xmath192 was obtained constant up to 10 digits for all initial conditions .          in both cases we calculated energy using two methods : from definition and from luke s lagrangian .",
    "both methods give consistent results . for fixed frame energies ( [ ecrz2 ] ) and ( [ eluknieruch ] )",
    "are the same",
    ". for moving frame the energy calculated from the definition contains one term more then energy calculated from luke s lagrangian , but this term ( @xmath239 ) is the invariant @xmath192 .",
    "when this term is dropped both energies in moving coordinate system ( [ etmfrrz2 ] ) and ( [ en3b ] ) are the same and energies in both coordinate systems differ only by sign .    the general conclusion concerning energy conservation for shallow water wave problem can be formulated as follows . since there exists the lagrangian of the system ( luke s lagrangian ) then exact solutions of euler equations have to conserve energy",
    "however , when approximate equations of different orders resulting from exact euler equations are considered , energy conservation is not a priori determined .",
    "the kdv equations obtained in first order approximation has a miraculous property , an infinite number of invariants with energy among them .",
    "however , this astonishing property is lost in second order approximation to euler equations and energy in this order may be conserved only approximately .      the simplest , _ mathematical _",
    "form of the kdv equation is obtained from ( [ kdv1 ] ) by passing to the moving frame with additional scaling @xmath240 which gives a standard , _ mathematical _   form of the kdv equation @xmath241 equations ( [ kdvm ] ) , particularly with  @xmath3   are favored by mathematicians , see , e.g.  @xcite .",
    "this form of kdv is the most convenient for ism ( the inverse scattering method , see , e.g.  @xcite ) .    for the moving reference frame , in which the kdv equation has a standard ( mathematical ) form ( [ kdvm ] ) , the invariant  @xmath0   is slightly different . to see this difference denote the lhs of ( [ kdvm ] ) by  @xmath242 and",
    "construct @xmath243 then after simplifications one obtains @xmath244 & = & 0 , \\nonumber \\end{aligned}\\ ] ] which implies the invariant  @xmath0 in the following form @xmath245 we see , however , that the difference between ( [ i3ruch ] ) and ( [ i3em ] ) is caused by additional scaling .    in the lagrangian approach as described in sect .",
    "[ varia ] , the substitution  @xmath246 into ( [ kdvm ] ) gives @xmath247 then the appropriate lagrangian density for equation ( [ kdvm ] ) with ( @xmath217 ) is @xmath248 indeed , the euler  lagrange equation obtained from the lagrangian ( [ l1w ] ) is just ( [ e1pa ] ) .",
    "the hamiltonian for kdv ( [ kdvm ] ) can be found e.g.  in @xcite .",
    "defining generalized momentum  @xmath107 , where  @xmath108 is given by ( [ l1w ] ) , one obtains @xmath249 dx=   \\int_{-\\infty}^{\\infty } \\left[\\frac{\\partial   \\mathcal{l}}{\\partial \\varphi_{t } }   \\varphi_t-\\mathcal{l}\\right ] dx   \\\\ & = & \\int_{-\\infty}^{\\infty } \\left[\\varphi_{x}^3-\\frac{1}{2 } \\varphi_{xx}^2\\right ] dx = \\int_{-\\infty}^{\\infty } \\left[\\eta^3-\\frac{1}{2 } \\eta_{x}^2\\right ] dx \\,.\\nonumber\\end{aligned}\\ ] ] this is the same invariant as  @xmath250 in ( [ i3ruch ] ) .",
    "we look for solutions to the laplace equation ( [ eu1 ] ) in the form @xmath252 yielding @xmath253=0.\\ ] ] in two dimensions @xmath254 we obtain @xmath255 the boundary condition at the bottom , @xmath256 at @xmath257 implies @xmath258 and then all odd @xmath259 .",
    "now @xmath260 where @xmath261 . in the stretched",
    "coordinates @xmath262 so @xmath263 now both ( [ eu1 ] ) and ( [ eu2 ] ) are satisfied .",
    "we must also satisfy the boundary conditions on @xmath264 .    in the derivation of kdv and kadomtsev - petiashvili @xcite from the euler equations ( [ eu1])([eu4 ] ) infeld and",
    "rowlands @xcite applied scaling assuming the following relations @xmath265 they then applied a transformation to a frame moving with velocity of sound .",
    "the coordinates scales as @xmath266 @xmath267 for the wave amplitude and velocity potential the appropriate scaling was @xmath268 and @xmath269 then the lowest order expression for @xmath270 is @xmath271 next , infeld and rowlands show that in order to simultaneously satisfy ( [ eu3 ] ) and ( [ eu4 ] ) the next order contributions to @xmath34 and @xmath270 cancel .",
    "it is enough to keep @xmath272 and drop upper index @xmath273 in what follows .",
    "whitham , _ linear and nonlinear waves _ ,",
    "wiley , new york , 1974 .",
    "f.  cooper , c.  lucheroni , h.  shepard and p.  sodano , _ variational method for studying solitons in the korteweg - devries equation _",
    "lett .  a * 173 * 33 - 36 ( 1993 ) ."
  ],
  "abstract_text": [
    "<S> it is well known that the kdv equation has an infinite set of conserved quantities . </S>",
    "<S> the first three are often considered to represent mass , momentum and energy . here we try to answer the question of how this comes about , and also how these kdv quantities relate to those of the euler shallow water equations . here </S>",
    "<S> luke s lagrangian is helpful . </S>",
    "<S> we also consider higher order extensions of kdv . </S>",
    "<S> though in general not integrable , in some sense they are almost so , these with the accuracy of the expansion . </S>"
  ]
}