{
  "article_text": [
    "in combinatorics on words , the most famous class of words probably is the class of sturmian words : aperiodic words having minimal factor complexity possible ( see @xcite ) .",
    "sturmian words are profoundly studied and many generalizations are known , see for instance @xcite .",
    "one such generalization of sturmian words are episturmian words .",
    "episturmian words were inspired by arnoux ",
    "rauzy words ( see @xcite ) .",
    "an infinite word over a @xmath3-letter alphabet is _ episturmian _ if it is closed under reversal and has at most one left special factor of each length .",
    "refer for instance to @xcite for more results on this class .",
    "a notion related to the study of episturmian words is a _ palindrome _  a word equal to its reversal .",
    "episturmian words are rich in palindromes : they contain the maximum number of distinct palindromic factors possible .",
    "precisely , we say that a finite word @xmath4 is _ rich _ if it contains exactly @xmath5 distinct palindromic factors , which is the upper bound for the number of distinct palindromic factors in a finite word of length @xmath6 ( see @xcite ) .",
    "the notion is extended to infinite words : an infinite word is _ rich _ if every its factor is rich .    in the context of this upper bound on the number of palindromic factors , a measure of the count of missing palindromic factors",
    "was introduced in @xcite : the _ palindromic defect _",
    "@xmath7 of a finite word @xmath4 is @xmath8 where @xmath9 is the set of all palindromic factors of @xmath4 .",
    "the palindromic defect of an infinite word @xmath10 is defined by @xmath11 .",
    "if @xmath12 is finite , we say that @xmath10 is _ almost rich_. ( if it is zero , then @xmath10 is rich as already mentioned . )",
    "besides episturmian words , examples of rich words include some well - explored word classes such as words coding symmetric interval exchange transformation ( see @xcite ) and words coding rotation on two intervals ( see @xcite ) .",
    "properties and characterizations of rich words are studied for instance in @xcite .",
    "examples of words that are have finite and nonzero palindromic defect are also known .",
    "such words can be constructed using iterated palindromic closure : let @xmath13 with @xmath14 being an alphabet .",
    "set @xmath15 where @xmath16 and @xmath17 is the shortest palindrome having @xmath4 as a prefix ( i.e. , the _ palindromic closure _ of @xmath4 ) .",
    "the infinite word having @xmath18 as its prefix for all @xmath19 is the _ standard word with seed @xmath20 and directive sequence @xmath21_. it follows from @xcite that such a word is almost rich .",
    "general properties and characterizations of almost rich words are studied in @xcite .    in this paper",
    ", we study richness and almost richness of images of episturmian words by a morphism from a specific class . our first result states that we obtain an almost rich word while using a morphism of class @xmath0 introduced in @xcite ( see later for the definition ) .",
    "[ th : pretmapstorich ] let @xmath22 be an episturmian word and @xmath23 be a morphism of class @xmath0 .",
    "the word @xmath24 is almost rich .",
    "the second main result involves a letter - to - letter projection of a ternary episturmian word to binary alphabet .",
    "we use the following definition for a such a projection .",
    "[ def : binarniprojekce ] let @xmath14 be an alphabet and @xmath25 its proper subset . a morphism @xmath26 defined by @xmath27 is called a _ binary projection _ from @xmath14 .",
    "the second main result states that we obtain a rich word by projecting a ternary episturmian word to a binary alphabet .",
    "[ arprojekcerich ] let @xmath10 be an episturmian word over a ternary alphabet @xmath14 and @xmath28 be a binary projection from @xmath14 .",
    "the word @xmath29 is rich .",
    "our motivation for these results is to find new binary words which are rich in a generalized sense  with respect to both symmetries given by the involutive antimorphisms on a binary alphabet : the reversal @xmath30 and the exchange of letters @xmath31 .",
    "we give a definition in , see also @xcite for more information on this generalization .",
    "to construct new binary words rich in this generalized sense , we use the recent results of @xcite which provides theorems that relate the classical richness and the generalized richness on the binary alphabet .",
    "our computer experiments suggest that we can improve : we can drop the requirement on the size of the alphabet @xmath14 .",
    "we state this hypothesis in the last section .",
    "the paper is organized as follows .",
    "the next section contains some necessary definitions and basic results .",
    "contains overview of results on episturmian words and proofs of the main results .",
    "finally , contains an application of the main results : a construction of binary words which are rich and almost rich in the generalized sense .",
    "the last section states some comments and open questions .",
    "let @xmath14 be an _ alphabet _  a finite set of _ letters_. a finite sequence @xmath32 with @xmath33 for all @xmath19 is a _",
    "finite word_. the _ length _ of the word @xmath4 is denoted @xmath6 and equals @xmath34 .",
    "the unique word of length @xmath35 is the _ empty word _ , it is denoted @xmath36 .",
    "the set @xmath37 is the set of all finite words over @xmath14 .",
    "the set @xmath37 equipped with concatenation forms a free monoid with the neutral element @xmath36 .",
    "a word @xmath38 is a _ factor _ of a word @xmath39 if @xmath40 for some words @xmath41 . if @xmath42 , then @xmath43 is a _ prefix _ of @xmath4 ; if @xmath44 , then @xmath43 is a _ suffix _ of @xmath4 .",
    "if @xmath4 is of the form @xmath45 , then @xmath46 is denoted @xmath47 and the word @xmath48 is a _ conjugate _ of the word @xmath4 .    an _ infinite word _ over @xmath14 is a sequence @xmath49 .",
    "the set of all infinite words over @xmath14 is denoted by @xmath50 .",
    "a finite word @xmath39 of length @xmath34 is a _ factor _ of @xmath51 if there exists an integer @xmath19 such that @xmath52 .",
    "the integer @xmath19 is an _ occurrence _ of the factor @xmath4 in @xmath10 .",
    "the _ language _ of @xmath10 is the set of all its factors and is denoted by @xmath53 . given @xmath54 and @xmath39 , if @xmath55 , then @xmath56 is a _",
    "right extension _ of the factor @xmath4 .",
    "the set of all right extensions of @xmath4 is denoted @xmath57 .",
    "any factor of @xmath10 has at least one right extension .",
    "if @xmath4 has at least two right extensions , it is _",
    "right special_. the notions of _ left extension _ of a factor , _ left special _ factor and @xmath58 are defined analogously .",
    "a factor @xmath4 which is left and right special is _",
    "bispecial_.    an infinite word @xmath10 is _ recurrent _ if any factor of @xmath10 has infinitely many occurrences in @xmath10 .",
    "if for every factor the sequence of all its consecutive occurrences has its first difference bounded , then the word @xmath10 is _",
    "uniformly recurrent_. let @xmath59 be a factor of @xmath10 such that @xmath59 has a prefix @xmath4 and @xmath4 occurs as a factor in @xmath59 exactly twice .",
    "such a word @xmath60 is a _ return word _ of @xmath4 and the word @xmath59 is a _ complete return word _ of @xmath4 .",
    "an infinite word @xmath10 is uniformly recurrent if and only if every its factor has finitely many return words .",
    "an infinite word @xmath10 is _ eventually periodic _ if there exist words @xmath61 and @xmath46 such that @xmath62 .",
    "it is _ periodic _ if @xmath63 .",
    "if an infinite word is not eventually periodic , it is _ aperiodic_.    we denote by @xmath64 the mapping @xmath65 which is determined by @xmath66 , i.e. , it counts the factors of length @xmath34 of the word @xmath10 .",
    "this mapping is the _ factor complexity _ of @xmath10",
    ".    given two alphabets @xmath14 and @xmath67 , a mapping @xmath68 is a _ morphism _ if @xmath69 for all @xmath70 .",
    "it is an _ antimorphism _ if @xmath71 for all @xmath70 .",
    "an infinite word @xmath10 is _ closed under the mapping @xmath72 _ if for any factor @xmath73 we have also @xmath74 .",
    "a morphism @xmath75 is a _ conjugate morphism _ to a morphism @xmath72 if there exists a word @xmath76 such that for any letter @xmath54 we have @xmath77 .",
    "an antimorphism @xmath78 is _ involutory _ if @xmath79 .",
    "the most frequent involutory antimorphism is the reversal mapping @xmath30 which is given by @xmath80 it can be easily seen that if a word @xmath10 is closed under an involutory antimorphism , then @xmath10 is recurrent .    if @xmath81 , then @xmath4 is a _",
    "palindrome_. the set of all palindromes occurring as factors of a finite word @xmath4 is denoted @xmath9 .",
    "the _ palindromic complexity _ of an infinite word @xmath10 is the mapping @xmath82 defined by @xmath83 , i.e. , the number of palindromic factors of length @xmath34 .",
    "a palindrome @xmath4 is _ centered at @xmath84 _ if @xmath85 for some word @xmath43 .",
    "obviously , a palindrome is centered at @xmath36 if and only if it is of even length .",
    "let @xmath39 .",
    "the quantity measuring the number of missing palindromic factors in @xmath4 is the _ ( palindromic ) defect _ of @xmath4 , introduced in @xcite and given by @xmath86 the notion of defect is extended to infinite words in the following way : let @xmath10 be an infinite word , we set @xmath87 if the defect of a finite or infinite word is zero , the word is fully saturated by distinct palindromic factors and is said to be _ rich _ ( or sometimes _ full _ ) .",
    "if its defect is finite , it is _",
    "almost rich_.    to prove ( almost ) richness of a word we will use the characterization of rich words given in @xcite .",
    "it exploits the notion of bilateral order @xmath88 of a factor @xmath4 and palindromic extension of a  palindrome .",
    "the _ bilateral order _ was introduced in @xcite as @xmath89 if @xmath90 and @xmath91 are letters , we say that @xmath92 is a _ both - sided extension of @xmath4 _ if @xmath93 .",
    "moreover , if @xmath4 is a palindrome and @xmath94 , then @xmath95 is its _",
    "palindromic extension_. the set of all palindromic extensions of a palindrome @xmath96 is denoted by @xmath97 : we have @xmath98    [ thm : minus1 ] let @xmath10 be an infinite word that is closed under reversal .",
    "the word @xmath10 is rich if and only if any bispecial factor @xmath4 of @xmath10 satisfies @xmath99    the next theorem is another characterization of rich words which will be useful .",
    "[ thm : rich_crw_gen ] a word @xmath10 is rich if and only if for every @xmath96 , any factor of @xmath10 containing exactly two occurrences of @xmath4 or @xmath100 , one as a prefix and one as a suffix , is a palindrome .",
    "hof , knill and simon studied in @xcite words having infinitely many palindromes .",
    "they considered words that are constructed using morphisms of the following class :    [ classp ] a primitive morphism @xmath101 belongs to the class @xmath102 if there exists a palindrome @xmath103 such that for any letter @xmath54 we have that @xmath60 is a prefix of @xmath104 and @xmath105 is a palindrome .",
    "the class @xmath102 is related to words with infinitely many palindromes in the following sense .",
    "let @xmath106 be a morphism of class @xmath102 .",
    "if @xmath43 is a palindrome , then @xmath107 is also a palindrome .",
    "thus , a fixed point of a morphism of class @xmath102 has infinitely many palindromes .",
    "the question is the converse : if one has a uniformly recurrent fixed point with infinitely many palindromes , can it be generated by a morphism of class @xmath102 ?",
    "a discussion on the meaning of this formulation can be found in @xcite . in @xcite ,",
    "the author gave the following affirmative answer to this question in case of a binary alphabet : if a binary fixed point of a primitive morphism @xmath106 contains infinitely many palindromes , then @xmath106 or @xmath108 is conjugate to a morphism from class @xmath102 . in @xcite , it is demonstrated that this claim can not be generalized to a larger alphabet even under the assumption of injectivity of the morphism . in @xcite ,",
    "the authors show that if an infinite word is a fixed point of a marked primitive morphism and contains infinitely many palindromes , then some power of the morphism has a conjugate in class p.",
    "we now mention two classes of morphisms that are closely related to the class @xmath102 .",
    "the first class is defined in  @xcite .",
    "a  morphism @xmath106 is a  _ standard morphism of class @xmath102 _ ( or a  _ standard @xmath102-morphism _ ) if there exists a  palindrome @xmath60 ( possibly empty ) such that for all @xmath109 and @xmath110 is a palindrome .",
    "if @xmath60 is non - empty , then some ( or all ) of the palindromes @xmath110 may be empty or may even take the form @xmath111 with @xmath112 a  proper palindromic suffix of @xmath60 .",
    "a  standard morphism of class @xmath102 is _ special _ if    1 .   whenever @xmath113 , with @xmath114 , occurs in some @xmath115 , then this occurrence is @xmath116 for some @xmath117 with @xmath118 ; and 2 .",
    "all @xmath119 end with different letters .",
    "let @xmath106 be a special standard morphism of class @xmath102 .",
    "it is related to richness in the following way : if @xmath10 is rich , then @xmath120 is almost rich , see @xcite .",
    "the second class of morphisms related to the class p is the class @xmath0 . in @xcite ,",
    "this class was used to show relations between rich and almost rich words in general : every almost rich word is an image of a rich word by a morphism of this class .",
    "the class was also used in @xcite to show that every episturmian word is an image of an arnoux  rauzy word . in @xcite , it is used to show an answer to an interpretation of the previously mentioned question of hof , knill and simon .",
    "[ def : pret ] let @xmath121 and @xmath122 be a palindrome .",
    "we say that @xmath106 is of class @xmath0 ( with respect to @xmath60 ) if the following is true :    * [ def_pret_1",
    "] @xmath123 is a palindrome for any @xmath124 , * [ def_pret_2 ] @xmath123 contains exactly @xmath125 distinct occurrences of @xmath60 , one as a prefix and one as a suffix , for any @xmath124 , * [ def_pret_3 ] @xmath126 for all @xmath127 .",
    "a direct consequence of the above definition is that any morphism @xmath128 is injective and @xmath129 is a palindrome if and only if @xmath130 is a palindrome .",
    "an important property of the class is also that it is closed under taking composition of morphisms , see @xcite .",
    "the following example taken from @xcite illustrates that there exists a morphism of class @xmath0 which maps a word having finite defect to a word with infinite defect .",
    "one of the main results of this article , , states that is can not happen if such a morphism acts on an episturmian word .",
    "[ ex : pret ] let @xmath131 and for all @xmath132 set @xmath133 let @xmath134 be determined by the limit @xmath135 and @xmath136 be given as follows : @xmath137 proposition 5.7 in @xcite states that @xmath138 and @xmath139 .",
    "in other words , the morphism @xmath106 , which is of class @xmath0 , maps a rich word to a word which is not almost rich .",
    "the key property of @xmath140 in this case is that the palindromes @xmath141 have two palindromic extensions @xmath142 and @xmath143 which produce ( by application of @xmath106 ) the same palindrome @xmath144 but they also produce a non - palindromic complete return word to it ( it is contained in @xmath145 ) .",
    "having infinitely many non - palindromic complete return words to palindromes implies that the defect is infinite ( see @xcite ) .",
    "in this section , we first recall and deduce some properties of episturmian words that will be needed later . a proof of theorem [ th : pretmapstorich ] is given in the second subsection .",
    "the last subsection contains a proof of .      for basic reference on episturmian words",
    ", the reader can refer to @xcite or survey papers @xcite .",
    "as already mentioned , an infinite word @xmath146 is _ episturmian _ if for any @xmath34 there exists at most one left special factor of length @xmath34 and @xmath10 is closed under reversal . if for any @xmath34 there exists exactly one left special factor of length @xmath34 with @xmath147 left extensions , then @xmath10 is a @xmath3-ary _ arnoux  rauzy _ word with @xmath148 .    the most important examples of episturmian words can be constructed using the palindromic closure .",
    "the standard word with the directive sequence @xmath149 and with the seed @xmath150 , i.e. , the word @xmath10 such that @xmath151 is an episturmian word over @xmath14 and it is called _ standard episturmian_. the importance follows from the fact that given any episturmian word @xmath10 , there exists a unique standard episturmian word with the same language . since richness is a property of language , when studying it , we can restrict ourselves to the standard episturmian words which are characterized by their directive sequence . a standard episturmian word can be recognized by looking at its prefixes : an episturmian word is standard if and only if each its prefix is a left special factor .",
    "a basic property of any episturmian word @xmath10 is that one letter is _ separating _ : it occurs in every factor of length @xmath125 .",
    "the separating letter of @xmath10 is the first letter of the directive sequence @xmath152 of the corresponding standard episturmian word .",
    "denote @xmath153 the least integer such that @xmath154 is not a prefix of @xmath155 .",
    "then the word @xmath156 with @xmath157 is a factor of the episturmian word @xmath10 only if @xmath158 or @xmath159 .",
    "moreover , the word @xmath154 is a factor of the episturmian word @xmath10 if and only if the letter @xmath160 occurs at least once in the sequence @xmath161 .",
    "any palindromic prefix of a standard episturmian word is equal to @xmath162 for some @xmath163 .",
    "the complete return words of @xmath162 are described by theorem 4.4 of @xcite .",
    "denote by @xmath164 the set @xmath165 .",
    "every complete return word of @xmath162 equals to the palindromic closure @xmath166 where @xmath167 .",
    "the word @xmath110 is the corresponding return word .",
    "thus , the palindromic prefix @xmath162 has exactly @xmath168 return words .",
    "bispecial factors play a crucial role in the study of the language of an infinite word .",
    "we give essential properties of bispecial factors of an episturmian word .",
    "any bispecial factor @xmath4 of an episturmian word @xmath10 is a palindrome ; moreover there exists @xmath163 such that @xmath169 , where @xmath162 is a palindromic prefix of the corresponding standard episturmian word . denoting again @xmath170 , the set of all non - palindromic both - sided extensions of the bispecial factor @xmath4 satisfies @xmath171 where @xmath172 is the unique letter such that @xmath173 and @xmath174 for some letter @xmath175 .",
    "if @xmath10 is arnoux  rauzy , then @xmath176 ( see @xcite ) ( and @xmath177 ) ; if @xmath10 is not arnoux  rauzy , then it depends on @xmath4 whether @xmath176 ( and there exist a bispecial factor @xmath4 such that @xmath178 ) .    the next lemmas give an insight on the structure of return words of an episturmian word .",
    "[ ar_rw_projekce ] let @xmath10 be an episturmian word over @xmath14 and @xmath96 be a factor .",
    "let @xmath179 be the list of all distinct return words of @xmath4 in @xmath10 .",
    "define a morphism @xmath78 over @xmath180 by the rule @xmath181 for all @xmath182 .",
    "there exists an episturmian word @xmath140 over @xmath183 such that @xmath184 for some finite word @xmath185 .",
    "first , let us assume that @xmath4 is a bispecial factor of @xmath10 . if @xmath10 is an arnoux  rauzy word , then @xmath186 and the claim follows directly from the proof of theorem 1 in @xcite and from theorem 3 ibidem . in case @xmath187 ,",
    "the proof is analogous and is left to the reader .",
    "suppose @xmath4 is not bispecial and it can be extended in a unique way to the shortest bispecial factor @xmath188 in which it occurs .",
    "a factor @xmath60 is a return word of @xmath91 if and only if @xmath189 is a return word of @xmath4 .",
    "thus the morphism @xmath78 ( defined using the return words of @xmath4 ) is a conjugate morphism of the morphism defined using the return words of @xmath91 and we can use the validity of the statement for the bispecial factor @xmath91 .",
    "the last case , @xmath4 is not bispecial and it can not be extended to a bispecial factor , is trivial as @xmath4 has only one return word and thus @xmath190 .",
    "the word @xmath140 from captures the structure of return words of the factor @xmath4 in @xmath10 .",
    "such a word was also studied in @xcite and we keep the same terminology : we say that the word @xmath140 from the previous lemma is a _ derivated word of @xmath10 with respect to the factor @xmath4 _ and its corresponding morphism is @xmath78 . by comparing the definitions we obtain that if @xmath4 is a palindrome , then @xmath191 .",
    "[ ar : delky ] let @xmath10 be a standard episturmian word @xmath10 over the alphabet @xmath192 with the directive sequence @xmath193 , where @xmath194",
    ". denote by @xmath153 the least integer such that @xmath195 is not a prefix of the directive sequence .    1 .",
    "if @xmath196 or @xmath197 , then no two return words of @xmath4 have the same length .",
    "if there exists @xmath198 such that @xmath199 and @xmath200 , then @xmath201 is a factor of @xmath10 and no two return words of @xmath4 have the same length .",
    "if @xmath4 has exactly @xmath202 return word , then the claim is trivially satisfied .",
    "suppose @xmath4 has more than @xmath202 return word .",
    "let @xmath188 be the shortest bispecial factor containing @xmath4 .",
    "any return word of @xmath4 has the form @xmath189 , where @xmath60 is a return word of @xmath91 .",
    "therefore , it is enough to prove the statement only for bispecial factors . since @xmath10 has a prefix @xmath203 but not @xmath195 , the bispecial factor @xmath91 contains at least two distinct letters .",
    "as already mentioned , theorem 4.4 of @xcite describes the return words of bispecial factors .",
    "in particular , any complete return word of @xmath91 equals to the palindromic closure of @xmath204 for some letter @xmath205 .",
    "moreover , since @xmath10 is standard , each bispecial factor @xmath91 of @xmath10 is a palindromic prefix of @xmath10 . since the prefixes of the word are constructed using the palindromic closure and the directive sequence , the palindromic closures @xmath206 and @xmath207 for distinct letters @xmath208 and @xmath209 have the same length if and only if neither @xmath208 nor @xmath209 occurs in @xmath91 ( see @xcite ) .",
    "as @xmath91 contains at least two distinct letters , this can not happen on the ternary alphabet .",
    "[ delsirw ] as one can see from the proof of the last lemma , for alphabets having cardinality greater than @xmath210 the claim of the last lemma does not hold .",
    "let us suppose that @xmath10 is a standard episturmian word with its directive sequence @xmath211 .",
    "we have @xmath212 clearly , @xmath213 .",
    "the factors @xmath214 and @xmath215 are return words of @xmath216 and they are of the same length .    [ lem : epist_navraty_k_pismenum ] let @xmath10 be an episturmian word over @xmath14 .",
    "let @xmath217 and @xmath218 be a factor of @xmath10 such that @xmath219 and @xmath61 does not contain any letter from @xmath25 .",
    "the word @xmath61 is a palindrome .",
    "we can suppose without loss of generality that the word @xmath10 is standard episturmian .",
    "we order the elements of @xmath25 according to their first occurrence in the directive sequence , i.e. , @xmath220 where @xmath221 appears for the first time in the directive sequence of @xmath10 before the first occurrence of @xmath222 if and only if @xmath223 .",
    "suppose @xmath224 .",
    "let @xmath225 be the longest prefix of @xmath10 that does not contain @xmath226 ( or equivalently , the longest prefix of @xmath10 over @xmath227 ) . since @xmath10 is a standard word constructed using the palindromic closure operators , the word @xmath225 is a palindrome ( it may be empty ) .",
    "the shortest palindromic prefix containing @xmath226 is @xmath228 . using theorem 4.4 of @xcite we have that any complete return word of @xmath228 has the form @xmath229 for some @xmath230 . if @xmath228 is bispecial ,",
    "it is the shortest bispecial containing @xmath226 ; if it is not bispecial , then @xmath10 is periodic . in both cases ,",
    "any word @xmath231 is a prefix of a complete return word of @xmath228 without the leading @xmath225 . if @xmath232 , then @xmath233 and @xmath234 , i.e. , @xmath235 is a palindrome .",
    "if @xmath236 , then @xmath237 and @xmath238 , i.e. , @xmath61 is again a palindrome .",
    "take @xmath239 and suppose @xmath240 .",
    "let @xmath241 be the longest prefix of @xmath10 that does not contain @xmath222 .",
    "the shortest palindromic prefix of @xmath10 containing @xmath222 is the word @xmath242 . if @xmath242 is bispecial ,",
    "it is the shortest bispecial factor containing @xmath222 ; if it is not bispecial , then @xmath10 is periodic .",
    "both cases imply that the any complete return word of @xmath222 starts with @xmath243 .",
    "since @xmath244 for some word @xmath245 , there is just one word of the desired form , precisely @xmath246 , i.e. , @xmath247 , and the proof is finished .",
    "when dealing with images by a morphism a useful notion is an ancestor .",
    "suppose that @xmath4 is a factor of @xmath248 for some infinite word @xmath140 and morphism @xmath78 .",
    "a factor @xmath249 is an _ ancestor _ by @xmath78 of @xmath4 if @xmath250 contains @xmath4 but neither @xmath251 nor @xmath252 contains @xmath4 .",
    "the following lemma can be considered as a generalization of .",
    "the lemma uses an additional notion .",
    "let us fix a factor @xmath4 of an episturmian word @xmath10 over the alphabet @xmath14 and a subset @xmath253 .",
    "a both - sided extension @xmath254 of @xmath4 in @xmath10 is called _ @xmath183-extension _ if @xmath208 and @xmath209 belong to @xmath183 .",
    "[ lem : zobecnenereturn ] let @xmath4 be a palindromic factor of an episturmian word @xmath255 and @xmath256 be the unique letter satisfying @xmath257 for some letter @xmath208 .",
    "let @xmath258 such that @xmath259 . if @xmath260 is a factor of @xmath10 containing exactly two @xmath183-extensions of @xmath4",
    " one as its prefix and one as its suffix  then @xmath261 is a palindrome .",
    "if @xmath4 is not a bispecial factor , then the only both - sided extension of @xmath4 is @xmath95 .",
    "it means that @xmath262 is a complete return word of the palindrome @xmath95 and thus , using , the word @xmath261 is a palindrome .    for a bispecial factor @xmath4 ,",
    "we denote by @xmath34 the number of occurrences of the factor @xmath4 in @xmath261 .",
    "if @xmath263 , then @xmath261 is a complete return word of @xmath4 and , since @xmath10 is rich , using @xmath261 is a palindrome .    if @xmath264 , we first show that the factor @xmath260 begins with @xmath265 and ends with @xmath266",
    "suppose that @xmath260 begins with @xmath254 , @xmath267 .",
    "there is only one complete return word of @xmath4 beginning with @xmath268 , it ends with @xmath269 and it is always followed by the letter @xmath90 , thus we have a contradiction to @xmath270 .",
    "we deal with two subcases :    \\1 ) @xmath271 .",
    "+ since the word @xmath260 has a prefix @xmath272 , it has a suffix @xmath273 . the factor",
    "@xmath274 does not contain further occurrences of @xmath61 and @xmath275 . according to",
    ", such a factor is a palindrome in any rich word , in particular in the episturmian word @xmath10 , as we want to show .",
    "\\2 ) @xmath276 .",
    "+ let @xmath67 be the set of letters such that for all @xmath277 the word @xmath278 is a right extension of @xmath4",
    ". for all @xmath277 , denote @xmath279 the return word of @xmath4 which has a prefix @xmath278 .",
    "define a morphism @xmath280 by setting @xmath281 for all @xmath277 .",
    "using , let @xmath282 be the episturmian word which is a derivated word of @xmath10 with respect to the factor @xmath4 such that @xmath78 is the corresponding morphism .",
    "the ancestor by @xmath78 of the factor @xmath260 is a factor @xmath283 with @xmath245 containing only letters from @xmath284 and moreover , in any pair of neighboring letters in @xmath285 exactly one of the letters is @xmath90 , i.e. , @xmath286 does not occur in @xmath285 .    if @xmath287 , then we apply lemma [ lem : epist_navraty_k_pismenum ] with @xmath288 .",
    "we get that @xmath285 is a palindrome and thus @xmath289 is a palindrome as well .    if @xmath290 and @xmath291 , then since @xmath90 is the separating letter in @xmath140 , we have that @xmath292 is an image of the morphism @xmath293 defined by @xmath294 and @xmath295 for any @xmath296 .",
    "thus @xmath297 where @xmath298 is a factor of an episturmian word and @xmath299 is produced from @xmath245 by erasing all letters @xmath90 in it .",
    "moreover , the word @xmath299 does not contain letters from @xmath183 .",
    "applying lemma [ lem : epist_navraty_k_pismenum ] with @xmath300 we get that @xmath301 is a palindrome . since @xmath293 and @xmath78 belong to the class @xmath0 , their composition @xmath302 is in @xmath0 with respect to @xmath303 .",
    "consequently , @xmath304 is a palindrome .",
    "the morphism @xmath293 is one of _ episturmian morphisms _",
    ", see @xcite .",
    "for instance , episturmian morphisms can be used to construct episturmian words .",
    "besides the proof of theorem [ th : pretmapstorich ] which concerns images of episturmian words under a morphism of class @xmath0 , we also provide in this section a description of the bilateral order of long bispecial factors in these infinite words .",
    "this result is needed also to prove in the next section .",
    "[ lem : epis_pret ] let @xmath10 be an episturmian word and let @xmath305 a morphism of class @xmath0 with respect to the palindrome @xmath60 . if @xmath306 is a bispecial factor containing at least one occurrence of @xmath60 , then its bilateral order @xmath307 is @xmath308 or @xmath35 , and satisfies .",
    "let @xmath309 be a bispecial factor containing @xmath60 .",
    "let us denote @xmath310 and @xmath311 the prefix and the suffix of @xmath4 containing the factor @xmath60 exactly once . as @xmath312 belongs to the class @xmath0",
    ", there exists a unique factor @xmath313 such that @xmath314 .",
    "let @xmath315 be all the letters such that @xmath316 is a right extension of @xmath4 .",
    "we denote by @xmath317 .",
    "this set is well defined due to the choice of @xmath61 and @xmath43 .",
    "since @xmath312 is of class @xmath0 , it follows that @xmath318 if @xmath319 .",
    "thus , @xmath43 is right special .",
    "let @xmath320 be all the letters such that @xmath321 is a left extension of @xmath4 .",
    "analogously to @xmath322 , we define the sets @xmath323 .",
    "we conclude that @xmath43 is left special , thus it is bispecial .",
    "denote by @xmath90 the unique letter such that @xmath324 and @xmath325 for some @xmath175 .",
    "next , we show that there exists an index @xmath19 such that @xmath326 .",
    "suppose the contrary : for all @xmath19 and @xmath327 we have that @xmath316 is a factor of @xmath328 for some letter @xmath329 ( possibly depending on @xmath91 ) .",
    "using , since @xmath330 , it implies that @xmath331 , i.e. , @xmath43 is not special  a contradiction .",
    "let without loss of generality @xmath332 .",
    "analogously , we have @xmath333 .    using the property for @xmath43",
    ", we have that if @xmath334 , then @xmath335 implies @xmath336 and symmetrically @xmath239 implies @xmath337 .",
    "thus we have @xmath338 to calculate the bilateral order of @xmath4 , it remains to see if @xmath339 is its both - sided extension or not : if @xmath340 , then @xmath341 ; otherwise @xmath342 .",
    "we first show that if @xmath343 , then @xmath4 is a palindrome . since @xmath344",
    ", there is no letter @xmath327 for some @xmath19 such that the longest common prefix of @xmath345 and @xmath346 is longer than @xmath347 .",
    "similarly , there is no letter @xmath348 for some @xmath198 such that the longest common suffix of @xmath349 and @xmath350 is longer than @xmath351 .",
    "this implies @xmath352 , and @xmath353 , i.e. , @xmath4 is a palindrome .",
    "moreover , we obtain @xmath354 , and for all @xmath19 there exists @xmath198 such that @xmath355 .",
    "it implies that @xmath356 is a palindrome if and only if @xmath357 .",
    "we have that @xmath340 if and only if @xmath358 or @xmath359 or @xmath360 .",
    "thus , if @xmath361 , i.e. , @xmath362 , then @xmath343 , which implies that @xmath4 is a palindrome and @xmath4 has no palindromic extension .",
    "therefore , @xmath363 and is satisfied .",
    "the last case is @xmath340 . if @xmath4 is a palindrome , since @xmath339 is the only palindromic extension , is again satisfied . if @xmath4 is not a palindrome , we have @xmath341 , and is also satisfied .",
    "let @xmath312 be a morphism from @xmath0 with respect to @xmath60 .",
    "since @xmath10 is a derivated word of @xmath24 with respect to @xmath60 , then @xmath10 is periodic if and only if @xmath24 is periodic .",
    "suppose @xmath10 is periodic .",
    "thus , @xmath24 is also periodic . in theorem 4 of @xcite",
    ", it is shown that an infinite periodic word contains infinitely many palindromes if and only if it is equal to @xmath364 for some palindromes @xmath61 and @xmath365",
    ". since @xmath10 contains infinitely many palindromes , @xmath24 contains infinitely many palindromes and we can write @xmath366 for some palindromes @xmath61 and @xmath365 from @xmath367 .",
    "it can be easily seen that such a word has finite defect .",
    "suppose @xmath10 is aperiodic . as shown in @xcite , a uniformly recurrent infinite word @xmath24 containing infinitely many palindromes",
    "has finite defect if and only if there exists an integer @xmath368 such that any complete return word of any palindrome @xmath4 of length at least @xmath368 is palindromic . as for each palindrome @xmath369 ,",
    "the word @xmath370 is a palindrome , and moreover a factor of @xmath24 , it remains to verify palindromicity of complete return words to palindromic factors of length @xmath371 such that @xmath372 .",
    "let @xmath4 be a palindromic factor of @xmath24 such that @xmath373 .",
    "first , suppose that @xmath4 is a bispecial factor .",
    "the word @xmath4 contains @xmath60 and according to the proof of lemma [ lem : epis_pret ] there exists a bispecial palindromic factor @xmath43 , a letter @xmath90 and a factor @xmath245 such that for some letter @xmath208 we have @xmath374 let @xmath375 be a complete return word of @xmath4 .",
    "clearly , @xmath376 for some factor @xmath377 and @xmath43 is a prefix and a suffix of @xmath261 . if @xmath245 is the empty word @xmath36 , then @xmath261 is a complete return word of @xmath43 in @xmath10 .",
    "since @xmath261 is a palindrome , the factor @xmath378 is a palindrome as well .",
    "if @xmath379 , then we apply lemma [ lem : zobecnenereturn ] with @xmath380 . according to our notation any ancestor of @xmath4 has the form @xmath381 , where @xmath382 . moreover , any ancestor of the complete return word @xmath376 equals @xmath260 with @xmath382 and the factor @xmath260 has only two occurrences of @xmath183-extensions of the factor @xmath43 . according to lemma [ lem : zobecnenereturn ] ,",
    "the factor @xmath261 is a palindrome and thus @xmath383 is a palindrome as well .",
    "it implies that the complete return word @xmath384 is a palindrome , too .    to complete the proof",
    ", we need to discuss the case when @xmath4 is not bispecial .",
    "since @xmath24 is closed under reversal , such a palindrome @xmath4 has a unique both - sided extension and this extension is palindromic .",
    "it implies that the shortest bispecial factor in which the palindrome @xmath4 occurs is a bispecial palindrome , say @xmath385 .",
    "moreover , @xmath261 is a complete return word of @xmath4 if and only if @xmath386 is a complete return word of @xmath261 . since @xmath386 is palindrome ,",
    "@xmath261 is palindrome as well .",
    "given an episturmian word @xmath10 and a morphism @xmath312 of class @xmath0 , the defect of @xmath24 can be nonzero .",
    "it suffices to choose @xmath312 such that for some letter @xmath54 the defect of @xmath350 is nonzero , which is possible in general .",
    "for instance , let @xmath10 be the fibonacci word , i.e. , the fixed point of the morphism given by @xmath387 and @xmath388 .",
    "the fibonacci word is sturmian , i.e. , an episturmian word .",
    "let @xmath389 be determined by @xmath390 ( the morphism @xmath312 is of class @xmath0 with respect to the palindrome @xmath391 . ) we have @xmath392 , thus @xmath393 .",
    "in fact , @xmath394 .      before proving , we need two lemmas concerned with images of episturmian words by morphisms of a special form .",
    "[ lemma : abdom ] let @xmath10 be an episturmian word over @xmath14 and @xmath395 a morphism of class @xmath0 such that @xmath396 for all @xmath208 .",
    "the word @xmath24 is rich .",
    "any morphism from class @xmath0 is injective , thus @xmath397 for any @xmath398 .",
    "we will show that if @xmath4 is a bispecial factor of @xmath24 , then its bilateral order @xmath307 satisfies .",
    "if the bispecial factor @xmath4 contains the letter @xmath399 , the claim follows from .",
    "suppose @xmath4 does not contain any occurrence of the letter @xmath399 , i.e. , @xmath400 with @xmath401 .",
    "the set of both - sided extensions of @xmath4 clearly contains @xmath402 and @xmath403 .",
    "thus the set of both - sided extensions of @xmath4 has cardinality @xmath404 .",
    "since @xmath405 , according to equation we have @xmath406 .    since is satisfied for any bispecial factor of @xmath24 , the richness of @xmath24 follows from .",
    "[ lemma : abnedom ] let @xmath10 be a ternary episturmian word over @xmath407 with the separating letter @xmath35 and let @xmath395 be a morphism such that @xmath408 and @xmath409 for all @xmath410 .",
    "the word @xmath24 is rich .",
    "let @xmath153 be the minimal integer such @xmath195 is not a prefix of the directive sequence of the standard episturmian word having the same language as @xmath10 .",
    "it means that any two non - zero letters of @xmath10 are separated by the block @xmath195 or @xmath411 .    if @xmath195 does not belong to @xmath412 , then @xmath413 , which is a rich word .",
    "let us suppose that @xmath195 occurs in @xmath10 .",
    "using , let @xmath414 be an episturmian word that is a derivated word of @xmath10 with respect to the factor @xmath195 and let @xmath78 be the corresponding morphism .",
    "thus , for any letter @xmath415 the image @xmath416 is a return word of @xmath195 in @xmath10 .",
    "using one can see that the morphism @xmath417 is of class @xmath0 with respect to the palindrome @xmath418 .",
    "we will show that if @xmath4 is a bispecial factor of @xmath419 , then the bilateral order @xmath307 satisfies .",
    "if the bispecial factor @xmath4 contains @xmath60 , the claim follows from .",
    "suppose @xmath4 does not contain any occurrence of the word @xmath60 .",
    "since any occurrence of the letter @xmath420 in @xmath419 is followed by block @xmath421 or @xmath422 one can see that the longest factor ( not necessarily bispecial ) of @xmath423 which does not contain @xmath424 is of the form @xmath425 for some integer @xmath3 .",
    "thus the bispecial factor @xmath4 is of the form @xmath426 , with @xmath427 .",
    "since @xmath425 is a factor , we can see that @xmath428 and @xmath429 are factors of @xmath24 . since @xmath4 is a palindrome",
    ", we have @xmath430 and consequently @xmath4 satisfies as well .    since is satisfied for any bispecial factor of @xmath24 , implies that @xmath24 is rich .    without loss of generality",
    "let us suppose that @xmath431 and @xmath35 is the separating letter of @xmath10 .",
    "let @xmath175 be the letter such that @xmath432 for all @xmath433 such that @xmath434 .",
    "suppose @xmath435 .",
    "let @xmath140 be a derivated word of @xmath10 with respect to the factor @xmath35 and let @xmath78 be the corresponding morphism . since the return words of @xmath435 are @xmath35 and @xmath436 for all @xmath437 , we may choose @xmath78 such that @xmath438 .",
    "it implies that the morphism @xmath439 and the word @xmath140 satisfy the assumptions of which implies that @xmath440 is rich .",
    "suppose @xmath410 , i.e. , @xmath208 is not the separating letter in @xmath10 .",
    "let again @xmath140 be a derivated word of @xmath10 with respect to the word @xmath208 and let @xmath78 be the corresponding morphism . using , one can see that @xmath441 is of the form as in the assumptions which implies that @xmath440 is rich .",
    "a generalization of the notion of richness was introduced in @xcite . as already mentioned , and results of @xcite may be used to produce examples of words that are rich in this generalized sense . in order to give these examples , and to give the definition of generalized richness on binary alphabets , we need a few more definitions .",
    "let @xmath31 be the antimorphism over @xmath442 which exchanges the two letters , i.e. , for instance we have @xmath443 .",
    "let @xmath444 . if @xmath445 , the word @xmath61 is a _",
    "@xmath78-palindrome_. the _ @xmath78-palindromic complexity _ of an infinite word @xmath10 is the mapping @xmath446 , defined by @xmath447 .    let @xmath448 . for binary words closed under all elements of @xmath1 ,",
    "it is shown in @xcite that @xmath449 when equality is reached for every @xmath450 , we say that the word is _",
    "@xmath1-rich_. when the equality holds except for finitely many @xmath34 , then the word is _",
    "almost @xmath1-rich_.    in @xcite , the notion of generalized richness is defined for arbitrary alphabet and a finite group of morphisms and antimorphisms @xmath451 containing at least one antimorphism . in this context , the `` classical '' richness defined in the previous sections is for @xmath452 , and it coincides with ( almost ) @xmath453-richness , or shortly ( almost ) @xmath30-richness .",
    "the following construction of @xmath1-rich and almost @xmath1-rich words uses the operation @xmath454 acting over words over the alphabet @xmath455 and defined by @xmath456 , where @xmath457 .",
    "it also uses the two following results of @xcite .    [ centered ] let @xmath458 be uniformly recurrent .",
    "if @xmath459 contains infinitely many @xmath30-palindromes centered at the letter @xmath202 and infinitely many @xmath30-palindromes not centered at the letter @xmath202 , then @xmath460 is closed under all elements of @xmath1 .",
    "[ thm : bin1 ] let @xmath461 and let @xmath460 be closed under all elements of @xmath462 . then @xmath460 is @xmath1-rich ( resp .",
    "almost @xmath1-rich ) if and only if @xmath463 is @xmath30-rich ( resp .",
    "almost @xmath30-rich ) .",
    "in order to produce an almost @xmath1-rich word using the last two claims , we need to find a suitable uniformly recurrent binary almost @xmath30-rich word @xmath140 which contains infinitely many @xmath30-palindromes centered at the letter @xmath202 and infinitely many @xmath30-palindromes not centered at the letter @xmath202 .",
    "we will apply a well chosen morphism @xmath464 on an episturmian word to produce such a word @xmath140 .",
    "let us recall that any arnoux ",
    "rauzy word over @xmath14 has infinitely many palindromes centered at @xmath90 for each @xmath465 , see @xcite .",
    "consider @xmath305 a morphism from the class @xmath0 with respect to a palindrome @xmath60 .    *",
    "if @xmath43 is a palindrome of even length , the palindrome @xmath466 is centered at the same letter as @xmath60 . *",
    "if @xmath43 is a palindrome of odd length , centered at @xmath467 , then @xmath466 is centered at the same letter as @xmath346 .",
    "thus , when we have an arnoux  rauzy word @xmath10 over @xmath14 , we can always pick a morphism @xmath468 such that @xmath469 has infinitely many palindromes centered at @xmath202 and infinitely many palindromes not centered at @xmath202 . using , we have that @xmath140 is almost @xmath30-rich . since @xmath10 is uniformly recurrent , if @xmath460 is a word such that @xmath470 , then it is closed under all elements of @xmath1 by .",
    "implies that @xmath460 is almost @xmath1-rich .    using",
    ", we can produce @xmath1-rich words .",
    "[ hrichp ] let @xmath10 be a ternary arnoux ",
    "rauzy word over the alphabet @xmath192 and @xmath28 be a binary projection over @xmath14 . if @xmath461 is a preimage of @xmath29 by @xmath471 , i.e. , @xmath472",
    ", then @xmath460 is @xmath1-rich .",
    "we use the two well - known properties of arnoux  rauzy words which were already mentioned : any arnoux  rauzy word is uniformly recurrent and any arnoux ",
    "rauzy word contains infinitely many palindromes centered at @xmath90 , where @xmath473 .",
    "therefore , @xmath29 is uniformly recurrent and contains infinitely many palindromes centered at @xmath202 and infinitely many palindromes centered at @xmath36 . due to , the word @xmath460 is closed under all elements of @xmath1 . according to , @xmath460 is @xmath1-rich .",
    "as already mentioned in the introduction , our computer experiments suggest that we may conjecture a more general statement than :    let @xmath10 be an episturmian word over @xmath14 and @xmath28 be a binary projection from @xmath14 .",
    "the word @xmath29 is rich .    besides this conjecture",
    ", one may inquire about the class of binary words that is obtained by applying a binary projection on an episturmian word .",
    "study of special factors , factor complexity and structure of return words may provide insight into this class .",
    "it would also be of interest to see if there is a relation to some known class of binary words .",
    "the author acknowledges financial support from the czech science foundation grant gar 13 - 35273p .",
    "the computer experiments were performed using the open - source algebra system ` sage ` @xcite ."
  ],
  "abstract_text": [
    "<S> we study morphisms from certain classes and their action on episturmian words . </S>",
    "<S> the first class is @xmath0 . in general </S>",
    "<S> , a morphism of class @xmath0 can map an infinite word having zero palindromic defect to a word having infinite palindromic defect . </S>",
    "<S> we show that the image of an episturmian word , which has zero palindromic defect , under a morphism of class @xmath0 has always its palindromic defect finite . </S>",
    "<S> we also focus on letter - to - letter morphisms to binary alphabet : we show that images of ternary episturmian words under such morphisms have zero palindromic defect . </S>",
    "<S> these results contribute to the study of an unsolved question of characterization of morphisms that preserve finite ( resp . </S>",
    "<S> zero ) palindromic defect . </S>",
    "<S> they also enable us to construct new examples of binary @xmath1-rich and almost @xmath1-rich words , where @xmath2 is the group generated by both involutory antimorphisms on a binary alphabet . </S>"
  ]
}