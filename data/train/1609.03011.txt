{
  "article_text": [
    "we let @xmath0 be one - dimensional diffusion and denote by @xmath1 the reflected process , @xmath2 where @xmath3 } x_u\\vee s$ ] with @xmath4 .",
    "hence @xmath1 is the excursion of @xmath5 from its running maximum @xmath6 .",
    "we consider an optimal stopping problem that involves both @xmath5 and @xmath6 .",
    "it is subject to absorbing boundary that varies with @xmath6 .",
    "that is , @xmath7.\\end{aligned}\\ ] ] where the rewards @xmath8 and @xmath9 are measurable functions from @xmath10 to @xmath11 and @xmath12 is also a measurable function .",
    "the rigorous mathematical definition of this problem is presented in section [ sec : model ] . in this paper",
    ", we shall solve for optimal strategy and corresponding value function along with optimal stopping region in the @xmath13-plane .    for optimal stopping that involve both @xmath6 and @xmath5 , we mention a pioneering work of peskir @xcite where the author used the  maximum principle \" .",
    "there are also ott @xcite and guo and zervos @xcite . in the former paper",
    ", the author solves problems including a capped version of the shepp - shiryaev problem ( the russian option ) @xcite .",
    "the latter makes another contribution that extends @xcite and the reward function therein is @xmath14 with @xmath15 .",
    "this reward function includes perpetual call , lookback option , etc .",
    "as special cases . in many solved problems , brownian motion or geometric browninan motion is used as underlying process in an effort to obtain tractable solutions . a recent development in this area includes alvarez and matoki @xcite where a discretized approach is taken to find optimal solutions and a corresponding numerical algorithm is presented .",
    "the idea of our solution method is the following : we look at excursions that occur from each level of @xmath6 , during an excursion from level @xmath16 , the value of @xmath17 is fixed until @xmath5 returns to @xmath18 . using this , the problems reduce to an infinite number of one - dimensional optimal stopping problems . in this spirit , we then attempt to rewrite the problem equation in the form of sequences of excursions . for finding the explicit form of the value function , we employ the theory of excursion of lvy processes , in particular the characteristic measure that is related to the height of excursions .",
    "( refer to bertoin @xcite as a general reference . )",
    "since the diffusion @xmath5 is not in general of independent increments , we use the measure change to make the diffusion behave like a brownian motion under the new measure .",
    "having done that , we solve , at each level of @xmath6 , one - dimensional optimal stopping problems by using the excessive characterization of the value function .",
    "this corresponds to the concavity of the value function after certain transformation .",
    "we briefly review this transformation in section [ sec : diffusion - facts ] .",
    "see dynkin@xcite , alvarz@xcite and dayanik and karatzas @xcite for more details . for the excursion theory for",
    "spectrally negative lvy processes ( that have only downward jumps ) , we mention avram et al .",
    "@xcite , pistorius @xcite @xcite and doney @xcite where , among others , an exit problem of the reflected process @xmath1 is studied .",
    "our contributions in this paper may advance the literature in several respects : we do not assume any specific forms or properties in the reward functions ( except for mild ones ) , and we provide _ explicit _ forms of the value function and illustrate the procedure of the solution method .",
    "in contrast to the literature , our approach is rather direct , without resorting to the variational inequality . see section [ sec : solution ] .",
    "accordingly , the solution method can be applied in a more general setting .",
    "the rest of the paper is organized as follows . in section [ sec : model ] , we formulate a mathematical model with a review of some important facts of linear diffusions , and then find an optimal solution .",
    "the key step is to represent and compute the value @xmath19 , which is handled in sections [ sec : solution ] and [ sec : finding - v(s , s ) ] . under the mild assumptions ( assumption [ assumption ] ) , we present @xmath19 in an explicit form . the next step is to find @xmath20 in section [ sec : method ] .",
    "moreover , we shall demonstrate the methodology by using a new problem ( section [ sec : call - with - s ] ) as well as some problems in the literature ( section [ sec : lookback ] and [ sec : perpetual ] ) .",
    "let us stress that the new problem might not be easily handled by the conventional methods .",
    "appendices include a proof of the technical lemma and some discussion about the _ smooth - fit principle _ in this problem .",
    "let the diffusion process @xmath21 represent the state variable defined on the probability space @xmath22 , where @xmath23 is the set of all possible realizations of the stochastic economy , and @xmath24 is a probability measure defined on @xmath25 .",
    "the state space of @xmath5 is given by @xmath26 , where @xmath27 and @xmath28 are _ natural boundaries_. that is , @xmath5 can not start from and exit from @xmath27 or @xmath28 .",
    "we denote by @xmath29 the filtration with respect to which @xmath5 is adapted and with the usual conditions being satisfied .",
    "we assume that @xmath5 satisfies the following stochastic differential equation : @xmath30 where @xmath31 for any @xmath32 and @xmath33 is a standard brownian motion .",
    "the running maximum process @xmath34 with @xmath4 is defined by @xmath3 } x_u\\vee s$ ] .",
    "in addition , we write @xmath1 for the reflected process defined by @xmath35 . we consider the following optimal stopping problem and the value function @xmath36 associated with initial values @xmath37 and @xmath38 ; @xmath39\\end{aligned}\\ ] ] where @xmath40 and @xmath41 is the expectation operator corresponding to @xmath42 , @xmath43 is the constant discount rate and @xmath44 is the set of all @xmath45-adapted stopping times .",
    "the payoff is composed of two parts ; the running income to be received continuously until stopped , and the terminal reward part .",
    "the running income function @xmath46 is a measurable function that satisfies @xmath47<\\infty.\\ ] ] the reward function @xmath48 is assumed to be measurable .",
    "our main purpose is to calculate @xmath49 and to find the stopping time @xmath50 which attains the supremum .    for each collection @xmath51 of borel measurable sets ,",
    "we define a stopping time @xmath52 by @xmath53 and define a set of stopping times @xmath54 by @xmath55 . in other words",
    ", @xmath52 is the first time the excursion @xmath56 from level , say @xmath57 , enters the region @xmath58 .",
    "suppose that @xmath59 for any @xmath60 , we write @xmath61      we will reduce the problem to an infinite number of one - dimensional optimal stopping problem and discuss the optimality of the proposed strategy .",
    "let us denote by @xmath62 the @xmath63-potential of @xmath8 : @xmath64.\\ ] ] from the strong markov property of @xmath65 , we have @xmath66\\\\ & = & { \\mathbb{e}}^{x , s } \\left[\\int^{\\infty}_0 e^{-qt}f(x_t , s_t){{\\rm d}}t - \\int^{\\infty}_{\\tau } e^{-qt}f(x_t , s_t){{\\rm d}}t \\right]\\nonumber\\\\ & = & \\bar{f}(x , s)-{\\mathbb{e}}^{x , s } \\left[{\\mathbb{e}}\\left[\\int^{\\infty}_{\\tau } e^{-qt}f(x_t , s_t){{\\rm d}}t \\bigm| \\mathcal{f}_{\\tau}\\right ] \\right]\\nonumber\\\\ & = & \\bar{f}(x , s)-{\\mathbb{e}}^{x , s } \\left[e^{-q\\tau}{\\mathbb{e}}^{x_{\\tau},s_{\\tau}}\\left[\\int^{\\infty}_0 e^{-qt}f(x_t , s_t){{\\rm d}}t \\right ] \\right]\\nonumber\\\\ & = & \\bar{f}(x , s)-{\\mathbb{e}}^{x , s } \\left[e^{-q\\tau}\\bar{f}(x_{\\tau},s_{\\tau})\\right]\\nonumber \\ ] ] hence the value function @xmath49 can be written as @xmath67 where @xmath68.\\end{aligned}\\ ] ] since @xmath69 has nothing to do with the choice of @xmath70 , we concentrate on @xmath20 .",
    "let us first define the first passage times of @xmath5 : @xmath71 by the dynamic programming principle , we can write @xmath72 as @xmath73,\\end{aligned}\\ ] ] for any stopping time @xmath74 . see , for example , pham @xcite page 97 .",
    "now we set @xmath75 in ( [ eq : dp ] ) . for each level @xmath57 from which an excursion @xmath76 occurs , the value @xmath6 does not change during the excursion .",
    "hence , during the first excursion interval from @xmath38 , we have @xmath16 for any @xmath77 , and ( [ eq : dp ] ) can be written as the following one - dimensional problem for the state process @xmath5 ; @xmath78.\\nonumber\\end{aligned}\\ ] ] now we can look at _ only _ the process @xmath5 and find @xmath79 .    in relation to , we consider the following one - dimensional optimal stopping problem as for @xmath5 and its value function @xmath80 ; @xmath81,\\end{aligned}\\ ] ] where @xmath82 is a constant .",
    "note that @xmath83 holds when @xmath84 , and we shall present how to characterize and compute @xmath85 in sections [ sec : solution ] and [ sec : finding - v(s , s ) ] .",
    "recall that , in pursuit of optimal strategy @xmath50 in the linear diffusion case , we can utilize the full characterization of the value function and optimal stopping rule .",
    "in particular , an optimal stopping is , in a very general setup , attained by the _ threshold strategy_. that is , one should stop @xmath5 when at the first time that @xmath5 enters a certain region , called stopping region . see dayanik and karatzas @xcite ; propositions 5.7 and 5.14 .",
    "see also pham @xcite ; section 5.2.3 .",
    "note that , however , writing the value of @xmath19 in an explicit form is not trivial and is an essential part of the solution , which we shall do in the next section ( see propositions [ prop:1 ] and [ prop:2 ] ) .",
    "let us recall the fundamental facts about one - dimensional diffusions ; let the differential operator @xmath86 be the infinitesimal generator of the process @xmath5 defined by @xmath87 and consider the ode @xmath88 .",
    "this equation has two fundamental solutions : @xmath89 and @xmath90 .",
    "we set @xmath89 to be the increasing and @xmath90 to be the decreasing solution .",
    "they are linearly independent positive solutions and uniquely determined up to multiplication .",
    "it is well known that @xmath91   = \\begin{cases } \\frac{\\psi(x)}{\\psi(z ) } , & x \\le z,\\\\[4pt ] \\frac{\\varphi(x)}{\\varphi(z ) } , & x \\ge z.    \\end{cases}\\end{aligned}\\ ] ] for the complete characterization of @xmath89 and @xmath90 , refer to it and mckean @xcite .",
    "let us now define @xmath92 then @xmath93 is continuous and strictly increasing . next , following dynkin ( pp .  238 , @xcite ) , we define concavity of a function with respect @xmath94 as follows : a real - valued function @xmath95 is called _ @xmath94-concave _ on @xmath96 if , for every @xmath97\\subseteq \\mathcal{i}$ ] , @xmath98    now consider the optimal stopping problem : @xmath99\\ ] ] where @xmath100 : @xmath101\\mapsto { \\mathbb{r}}_+$ ] .",
    "let @xmath102 be the smallest nonnegative concave majorant of @xmath103\\ ] ] where @xmath104 is the inverse of @xmath94 .",
    "then we have @xmath105 and the optimal stopping region @xmath106 is @xmath107 : v(x)=h(x)\\ } { \\quad\\text{and}\\quad}\\tau^*:=\\inf\\{t\\ge 0 : x_t\\in \\gamma\\}\\ ] ] as in propositions 4.3 and 4.4 of @xcite .",
    "note that for the rest of this article , the term ",
    "transformation \" should be understood as .    when both boundaries @xmath27 and @xmath28 are natural , @xmath108 for all @xmath109 if and only if @xmath110 are both finite .",
    "now we look to an explicit solution of @xmath49 for @xmath111 . the first step is to find @xmath19 in .",
    "that it , we consider the case @xmath112 . set stopping times @xmath113 as @xmath114 and define the function @xmath115 by @xmath116 for which @xmath117 .",
    "since optimal strategy belongs to threshold strategies , we shall focus on the set of @xmath52 in .",
    "in other words , if @xmath112 , given a threshold strategy @xmath118 where @xmath119 is in the form of @xmath120\\subset [ 0 , + \\infty)$ ] , the value @xmath121 is equal to @xmath122 . accordingly , @xmath123 on the set @xmath124 . from the strong markov property of @xmath65 , when @xmath125 and @xmath126 , we have @xmath127\\\\ & = & \\int^{\\infty}_s{\\mathbb{e}}^{s , s}\\left[{\\mbox{1}\\hspace{-0.25em}\\mbox{l}}_{\\{\\tau(d)<+\\infty , s_{\\tau(d)}\\in{{\\rm d}}m\\}}e^{-q\\tau(d)}(g-\\bar{f})(x_{\\tau(d)},s_{\\tau(d)})\\right]\\nonumber\\\\ & = & \\int^{\\infty}_s{\\mathbb{e}}^{s , s}\\left[{\\mbox{1}\\hspace{-0.25em}\\mbox{l}}_{\\{t_m\\leq\\tau(d)\\}}e^{-qt_m}{\\mathbb{e}}^{m , m}\\left[e^{-q\\tau_{l_d(m)}}(g-\\bar{f})(x_{\\tau_{l_d(m)}},s_{\\tau_{l_d(m)}})\\right.\\right.\\nonumber\\\\ & & \\left.\\left.\\times{\\mbox{1}\\hspace{-0.25em}\\mbox{l}}_{\\ { s_{\\tau_{l_d(m)}}\\in { { \\rm d}}m\\}}\\right]\\right]\\nonumber\\\\ & = & \\int^{\\infty}_s{\\mathbb{e}}^{s , s}\\left[{\\mbox{1}\\hspace{-0.25em}\\mbox{l}}_{\\{s_{\\tau(d)}\\geq m\\}}e^{-qt_m}\\right](g-\\bar{f})(m - l_d(m),m)\\nonumber\\\\ & & \\times{\\mathbb{e}}^{m , m}\\left[e^{-q\\tau_{l_d(m)}}{\\mbox{1}\\hspace{-0.25em}\\mbox{l}}_{\\{s_{\\tau_{l_d(m)}}\\in { { \\rm d}}m\\}}\\right]\\nonumber.\\end{aligned}\\ ] ] now we calculate these expectations by changing probability measure .",
    "we introduce the probability measure @xmath128 defined by @xmath129 , \\text{for every } a\\in{\\mathcal{f}}.\\ ] ] then @xmath130 is a process in natural scale under this measure @xmath128 .",
    "see borodin and salminen @xcite(pp .",
    "33 ) and dayanik and karatzas @xcite for detailed explanations .",
    "hence we can write , under @xmath128 , @xmath131 , where @xmath132 is a constant and @xmath133 is a brownian motion under @xmath128 . since @xmath134 is a lvy process",
    ", we can define the process @xmath135 of the height of the excursion as @xmath136 and @xmath137 otherwise , where @xmath138 .",
    "then @xmath139 is a poisson point process , and we denote its characteristic measure under @xmath128 by @xmath140 of @xmath134 . it is well known that @xmath141 see , for example , inlar @xcite ( pp .",
    "416 ) . by using these notations",
    ", we have is a standard brownian motion @xmath142 , then @xmath143 and the right - hand side reduces to @xmath144 . ] @xmath145 on the other hand , from the definition of the measure @xmath128 , we have @xmath146\\\\ & = & \\frac{\\varphi(m)}{\\varphi(s)}{\\mathbb{e}}^{s , s}\\left [ e^{-qt_m}{\\mbox{1}\\hspace{-0.25em}\\mbox{l}}_{\\ { s_{\\tau(d)}>m \\ } } \\right].\\end{aligned}\\ ] ] combining these two things together , @xmath147=\\frac{\\varphi(s)}{\\varphi(m)}\\exp\\left ( -\\int^m_s\\frac{f'(u){{\\rm d}}u}{f(u)-f(u - l_d(u ) ) } \\right).\\ ] ] similarly , by changing the measure and noting that @xmath148 , we have @xmath149\\\\ \\nonumber & = & \\frac{\\varphi(m)}{\\varphi(m - l_d(m))}\\cdot\\frac{1}{\\varphi(m)}{\\mathbb{e}}^{m , m}\\left[e^{-q\\tau_{l_d(m)}}\\varphi(x_{\\tau_{l_d(m)}}){\\mbox{1}\\hspace{-0.25em}\\mbox{l}}_{\\{s_{\\tau_{l_d(m)}}\\in { { \\rm d}}m\\}}\\right]\\\\ \\nonumber & = & \\frac{\\varphi(m)}{\\varphi(m - l_d(m))}{\\mathbb{p}}^{\\varphi}_{m , m}(f(s_{\\tau_{l_d(m)}})\\in{{\\rm d}}f(m))\\\\ \\nonumber & = & \\frac{\\varphi(m)}{\\varphi(m - l_d(m))}{\\mathbb{p}}^{\\varphi}_{m , m}(f(s_{\\tau_{l_d(m)}})-f(x_{\\tau_{l_d(m)}})=l_d(m ) , f(s_{\\tau_{l_d(m)}})\\in{{\\rm d}}f(m))\\nonumber.\\end{aligned}\\ ] ]    since @xmath134 is a lvy process under @xmath150 , we can apply theorem 2 in pistorius @xcite to calculate the last probability .",
    "then we have @xmath151    we have , up to this point , proved the following :    [ prop:1 ] when @xmath112 , the function @xmath85 for @xmath152 can be represented by @xmath153    this representation of @xmath19 applies to general cases .",
    "in solving an optimal stopping problem involving @xmath6 and @xmath5 , one of the aims is to draw a diagram like figure [ fig - example - design ] .",
    "note that we draw the diagram with @xmath18 on the horizontal axis since it is better understood than otherwise . for distinct values in the @xmath13-diagram , we need to determine whether a point in @xmath10 is in the continuation region ( @xmath154 ) or stopping region ( @xmath106 ) .",
    "the task in this subsection by moving downwards to @xmath155 from the diagonal @xmath156 .",
    "we take this in section [ sec : method ] and solve an example in [ sec : call - with - s ] . ]",
    "is to compute the value @xmath19 at a point @xmath157 on the diagonal and to determine whether it belongs to @xmath154 or @xmath106 .",
    "as stressed before , once we fix @xmath57 , the problem reduces to one - dimensional problems in @xmath5 and hence the way to find @xmath19 is similar to the one described in section [ sec : diffusion - facts ] . specifically , we set @xmath57 and attempt to find the smallest nonnegative concave majorant @xmath158 of @xmath159 in the neighborhood of @xmath18 .",
    "let us denote by @xmath160 ( resp .",
    "@xmath161 ) the stopping region ( resp .",
    "continuation region ) with respect to the reward @xmath162 in , corresponding to this @xmath18 .",
    "note that this @xmath163 ( resp .",
    "@xmath161 ) should be distinguished from the stopping region @xmath164 ( resp .",
    "@xmath154 ) of the problem , the final object to figure out . due to the dependence of the reward on @xmath18 , however , there are some situations where we need to be careful . to discuss , we shall hereafter ( for the rest of this section ) assume the following :    [ assumption ] denote by @xmath165 the threshold point that separates @xmath161 and @xmath166 with respect to the reward @xmath167 associated with this @xmath18 .    1 .",
    "@xmath168 is increasing in @xmath18 , 2 .   for @xmath169 ,",
    "the continuation region @xmath161 corresponding to @xmath162 is in the form of @xmath170 $ ] or @xmath171 , and 3 .   holds .",
    "the first assumption is merely to restrict our problems to practical ones because we are solving maximization problems .",
    "the second is to make our argument concrete and simplistic .",
    "more complicated structure can be handled by some combinations of the cases prescribed below . for the third , since our main concern is to find a finite value function , we shall consider the case where holds .",
    "if @xmath18 belongs to @xmath163 , we have @xmath173 ; however , instead of stopping immediately , there is a possibility that a greater value can be attained if one stops @xmath5 during the excursion from some upper level @xmath174 .",
    "recall that proposition [ prop:1 ] has incorporated this .",
    "see also remark [ rem : meaning ] below .",
    "now we wish to obtain more explicit formulae for @xmath85 from the general representation . for this purpose ,",
    "let us denote @xmath175 to avoid the long expression and rewrite in the following way : for any @xmath176 , @xmath177\\\\ & = & \\sup_{l_d}\\left[\\int_{s}^{s+\\epsilon}\\frac{\\varphi(s)}{\\varphi(m - l_d(m))}\\exp\\left(-\\int_s^{m}p(u ; l_d){{\\rm d}}u\\right)p(m ; l_d)g(m ; l_d){{\\rm d}}m\\right.\\\\ & & + \\left.\\frac{\\varphi(s)}{\\varphi(s+\\epsilon)}\\exp\\left(-\\int_s^{s+\\epsilon}p(u ; l_d){{\\rm d}}u \\right ) v(s+\\epsilon , s+\\epsilon)\\right].\\end{aligned}\\ ] ] this expression naturally motivates us to set @xmath178 as @xmath179\\ ] ] and we have @xmath180 . dividing both sides by @xmath181 and choosing the optimal level @xmath182 , we have , for any @xmath18 given , @xmath183.\\ ] ]    let us consider the transformation of a borel function @xmath184 defined on @xmath185 through @xmath186 on @xmath187 $ ] where @xmath104 is the inverse of the strictly increasing @xmath93 in . if we evaluate @xmath188 at @xmath189 , we obtain @xmath190 , which is the form that appears in . note that @xmath191    [ prop:2 ] fix @xmath192 .",
    "if ( 1 ) the reward function @xmath168 is increasing in the second argument and ( 2 ) if @xmath193 is strictly convex on @xmath194 , we have @xmath195 where @xmath196+f'(u)\\varphi'(u)}\\ ] ] and @xmath197 is the maximizer of the map @xmath198+f'(s)\\varphi'(s)}\\cdot(g-\\bar{f})(s - z , s)\\quad \\text{on}{\\hspace{0.2cm}}[0 , \\infty).\\ ] ] if ( 2) @xmath193 is linear on @xmath194 , then @xmath199 is to be replaced by @xmath200+f'(u)\\varphi(u)}.\\ ] ]    the strict convexity of @xmath193 implies @xmath201 on the other hand , if @xmath193 is linear , then the inequality in is replaced by the equality : @xmath202 we shall use this property in the proof of lemma [ lem : epsilon ] . note that it is easily proved that geometric brownian motion satisfies and brownian motion ( with or without drift ) does the other one",
    "the @xmath90 functions of orstein - uhlenbeck process @xmath203 ( with @xmath204 and @xmath205 ) and its exponential version @xmath206 ( where @xmath207 are positive constant ) involve special functions ; the parabolic cylinder function and the confluent hypergeometric function of the second kind , respectively ( see lebedev @xcite ) . while it is hard to prove the log convexity of these special functions , it is numerically confirmed that both processes satisfy .",
    "moreover , the equality condition implies that @xmath208 so that @xmath181 is an exponential function .",
    "hence it is confirmed that this case includes brownian motion .",
    "( of proposition [ prop:2 ] ) let us first take the strictly convex case of @xmath193 . for taking limits of @xmath209 in ,",
    "we need the following lemma whose proof is postponed to appendix [ app : a ] :    [ lem : epsilon ] under the assumption of proposition [ prop:2 ] with convex @xmath210 , for @xmath211 sufficiently close to zero , we have @xmath212    note that @xmath213 for all @xmath192 and @xmath211 and that @xmath214 for all @xmath192 .",
    "+ suppose that the lemma is proved , let us continue the proof of proposition [ prop:2 ] . by using in lemma [ lem : epsilon ]",
    ", we can write , for @xmath215 small , @xmath216 moreover , since @xmath217 , the optimal threshold @xmath197 should satisfy @xmath218,\\ ] ] from which equation , in view of , we obtain @xmath219+f'(s)\\varphi'(s ) } ( g-\\bar{f})(s - l^*_d(s ) , s),\\end{aligned}\\ ] ] where the last equality is obtained by lhpital s rule , and hence @xmath197 is the value which gives the supremum to @xmath220 .",
    "when @xmath193 is linear , in lieu of , we claim that @xmath221 for @xmath211 sufficiently small .",
    "the intuition here is the following : since @xmath222 in lemma [ lem : epsilon ] can be written as @xmath223 ( as @xmath209 ) and in case of brownian motion , @xmath224 , the factor should be independent of @xmath18 .",
    "it can be easily seen that the proof of lemma [ lem : epsilon ] holds in this case , too .",
    "accordingly , instead of , we have @xmath225 for the rest , we just proceed as in the proof of proposition [ prop:2 ] to obtain @xmath226 .",
    "[ rem : meaning]let us slightly abuse the notation by writing @xmath227+f'(s)\\varphi'(s)}=q(s ; z)$ ] to avoid the long expression .",
    "note that @xmath228 is the value corresponding to the strategy @xmath229 with @xmath230 and @xmath231 for every @xmath232 ; that is , this amount is obtained when we stop if @xmath5 goes below @xmath233 in the excursion at level @xmath57 and behave optimally at all the higher levels @xmath234 .    in summary , in case ( 1 )",
    ", we should resort to proposition [ prop:2 ] to compute @xmath19 .",
    "if @xmath235 for this @xmath18 , we shall have @xmath236 .",
    "recall that @xmath238 is defined in assumption [ assumption ] . in this case ,",
    "similar to case ( 1 ) , a positive @xmath197 may lead to improvement of the value of @xmath19 , so that we use proposition [ prop:2 ] .",
    "@xmath240 is defined in assumption [ assumption ] .",
    "for this case , the typical situation is that @xmath165 is monotonically decreasing in @xmath18",
    ". see figure [ fig - example - design ] .",
    "the curve separating the region @xmath106 and @xmath241 corresponds to the function @xmath165 .",
    "then define the point @xmath242 such that @xmath243 holds .",
    "one receives @xmath244 when stops there .",
    "in contrast to the previous cases ( 1 ) and ( 2 ) , @xmath18 is located to the left of @xmath165 , we are not supposed to stop during the excursions from the level @xmath245 .",
    "mathematically , it means that we let @xmath246 in of proposition [ prop:1 ] .",
    "the left boundary @xmath27 is assumed to be natural and hence @xmath247 and @xmath248 , the dirac measure sitting at @xmath242 .",
    "now , from , simplifies to @xmath249 which is , in view of , simply the expected discounted value of @xmath250 .",
    "note that for @xmath251 , the reward @xmath252 does not depend on @xmath18 and thereby with respect to this reward , @xmath253 for @xmath251 .",
    "+ before moving on to find the general solution @xmath20 , it should be beneficial to briefly review some special cases in finding @xmath85 . in this section ,",
    "the diffusion @xmath5 is geometric brownian motion @xmath254 and @xmath88 provides @xmath255 and @xmath256 with @xmath257 and @xmath258 .",
    "the parameters are @xmath259 .",
    "the values of the options here are computed under the physical measure @xmath24 .",
    "the reward function is @xmath260 where @xmath261 $ ] .",
    "set @xmath262 . by setting @xmath189 in , @xmath263 .",
    "the graph of @xmath264 against the horizontal axis @xmath265 is in figure [ fig - put]-(a ) .",
    "it can be seen that @xmath266 and that case ( 1 ) applies .",
    "the optimal threshold @xmath197 can be found by proposition [ prop:2 ] : the optimal level @xmath267 is given by @xmath268 where @xmath269 , independent of @xmath18 , so that @xmath270 .",
    "once @xmath197 is obtained , we can compute @xmath19 from . while we shall discuss the general method of computing @xmath20 for @xmath271 in section [ sec : method ] , it is appropriate to touch upon this issue here .",
    "for this fixed @xmath262 , we examine the smallest concave majorant of @xmath162 .",
    "but the majorant must pass the point @xmath272 the red line @xmath273 is drawn connecting these points with a positive slope @xmath274 .",
    "in fact , the smooth - fit principle holds at @xmath275 as is discussed in @xcite .",
    "accordingly , @xmath276 is in the continuation region . for more comments about the smooth - fit principle ,",
    "see appendix [ rem : shiryaev ] .",
    "the reward function is @xmath277 which does not depend on @xmath18 and there is no absorbing boundary .",
    "this is an ordinary optimal stopping problem .",
    "the graph of @xmath278 is in figure [ fig - put]-(b ) which is drawn against the horizontal axis of @xmath189 when @xmath262 .",
    "the function @xmath279 attains _ unique maximum _ at @xmath280 where @xmath281 , so that @xmath282 . since @xmath9 is independent of @xmath18",
    ", so is @xmath267 .    by using this fact ,",
    "we can use proposition [ prop:1 ] and compute @xmath19 easily . in fact , an observation of reveals that if @xmath283 is constant for @xmath284 , then we have @xmath285 which in turn makes @xmath286 then reduces to @xmath287 and @xmath182 is the maximizer of the map @xmath288 .    at this point",
    "the tangent line has slope zero ; that is , @xmath289 .",
    "see the red horizontal line connecting two points @xmath290 and @xmath291 . at @xmath280",
    ", we have the smooth - fit principle hold and @xmath292 is in the continuation region .     + ( a ) lookback option @xmath293     + ( b ) perpetual put @xmath294",
    "finally , let us consider the general case , @xmath295 .",
    "since we calculated @xmath85 , we can represent @xmath72 by ( [ eq : one - dim - version ] ) : @xmath296.\\end{aligned}\\ ] ] as we noted in section 2 , this can be seen as just an one - dimensional optimal stopping problem for the process @xmath5 . in terms of the @xmath13-diagram like figure [ fig - example - design ] , we fix @xmath297 , say and use the information of @xmath298 , compute @xmath299 and tell , by moving down from the diagonal point @xmath300 , whether a point @xmath301 belongs to @xmath154 or @xmath106 . after discussing generality here ,",
    "we shall study an example in section [ sec : call - with - s ] by showing how to implement the method presented in dayanik and karatzas @xcite .",
    "now suppose that we have found @xmath19 for each @xmath302 . the next step is to solve .",
    "consider an excursion from the level @xmath57 . recall that @xmath85 represents the value that one would obtain when @xmath5 would return to that level @xmath18 .",
    "if there is no absorbing boundary , we can let the height of excursions arbitrarily large .",
    "since we are assuming , by proposition 5.12 in @xcite , the value function in the transformed space must pass the points : @xmath303 then the task is to find for each @xmath18 the smallest concave majorant @xmath304 of @xmath305 and to identify the region @xmath306 as optimal stopping region .",
    "mathematically , @xmath307 must satisfy the following conditions :     +    1 .",
    "@xmath308 on @xmath309 $ ] , 2 .",
    "@xmath310 , 3 .",
    "@xmath311 , 4 .",
    "@xmath307 is concave on @xmath309 $ ] , and 5 .   for any functions @xmath312 which satisfies four conditions above , @xmath313 on @xmath309 $ ] .",
    "now once we have done with one @xmath18 , we then move on to another @xmath314 , say , and find @xmath315 in the new interval @xmath316 $ ] .",
    "figure [ fig1 ] illustrates a typical example of the graphs of @xmath317 and @xmath318 in transformed space .",
    "fix @xmath319 .",
    "take the point @xmath320 on the horizontal axis and find @xmath321 that satisfies the above conditions .",
    "for this purpose , three vertical lines are drawn at @xmath322 , and @xmath320 from the left to right . starting with the point @xmath323 ,",
    "the concave majorant near that point is the line that is tangent to @xmath324 .",
    "the tangency point is @xmath325 . in the region",
    "@xmath326 $ ] , the value function is the reward function itself . on the other hand , the smallest concave majorant of @xmath324 on @xmath327 is the line , from the origin , tangent to @xmath324 at @xmath328 .",
    "for this @xmath329 , optimal strategy reads as follows : if it happens that @xmath330 belongs to @xmath331 , one should see if @xmath5 reaches @xmath332 or @xmath329 , whichever comes first .",
    "if the former point is the case , one should stop and receive the reward , otherwise one should continue with @xmath333 .",
    "if @xmath330 belongs to @xmath334 , one should immediately stop @xmath5 and receive @xmath335 .",
    "finally , in @xmath336 , one should wait until @xmath5 reaches @xmath337 .",
    "to illustrate how to implement the solution method for a problem that involves both @xmath6 and @xmath5 , we postulate the reward function as @xmath338 and @xmath339 .",
    "for concreteness , we set @xmath340 , and @xmath341 .",
    "we assume that the underlining process @xmath5 is geometric brownian motion : @xmath342 where @xmath343 and @xmath344 are constants and @xmath142 is a standard brownian motion under @xmath345 . in this case , @xmath346 where @xmath347 and @xmath348     +     +    for this reward @xmath349 , the value of @xmath350 in is zero for any @xmath351 .    it should be helpful to preview the entire state space at the beginning .",
    "see figure [ fig - example - design ] for optimal strategy : continuation and stopping region in the two - dimensional diagram .",
    "the left panel is for presenting in a schematic drawing . for different values of @xmath13",
    ", we see continuation regions @xmath352 and stopping region @xmath106 .",
    "the right panel is the real solution for this problem with parameters @xmath353 . according to the values of @xmath18 , we have four regions : ( i ) @xmath354 , ( iii ) @xmath355 , ( ii ) @xmath356 , and ( iv ) @xmath251 .",
    "we shall explain how to find the value function and optimal strategy for each region .",
    "note that for the ease of exposition , we handle @xmath356 before we do @xmath355 .",
    "\\(i ) let us start with @xmath354 .",
    "first we need to find @xmath19 .",
    "plug this @xmath18 in and examine the reward function in the transformed space : @xmath357 figure [ fig : example - region1 ] -(i ) shows the function @xmath358 on @xmath309 $ ] . for this @xmath18 ,",
    "@xmath162 is concave in the neighborhood of @xmath359 and case ( a ) in section [ sec : finding - v(s , s ) ] applies .",
    "the map @xmath360+f'(s)\\varphi'(s)}\\cdot g(s - l , s)\\ ] ] in is in figure [ fig : example - region1]-(ii ) and @xmath361 when @xmath362 .",
    "now we can find @xmath20 for @xmath363 $ ] . following section [ sec : method ]",
    ", we shall find the smallest concave majorant of @xmath364 that passes the origin and @xmath365 .",
    "for this particular @xmath18 , a diagram similar to figure [ fig1]-(b ) can be drawn : see figure [ fig : example - region1]-(iii ) .",
    "the value function on the continuation region @xmath366 ( red line in the graph ) is @xmath367 where @xmath368 .    in summary ,",
    "the value function is @xmath369 .",
    "\\end{cases}\\end{aligned}\\ ] ]     + ( i ) graph of @xmath162 when @xmath362     + ( ii ) the map @xmath370 to find @xmath371     + ( iii ) the value function @xmath20 ( red ) and @xmath162 ( blue )    \\(ii ) let us move on to the region @xmath356 ( before we examine @xmath355 ) .",
    "see figure [ fig : example - region3]-(i ) for the graph of @xmath162 in the transformed space . in the neighborhood of @xmath359 ,",
    "the reward @xmath162 is concave but we have @xmath372 for @xmath18 in this region , so that @xmath373 . on the other hand , for the reward function @xmath374 with",
    "this fixed @xmath375 $ ] , there is a point @xmath165 such that @xmath376 is the continuation region .",
    "let us see this situation in the transformed space .",
    "see figure [ fig : example - region3]-(i ) again . at the point @xmath377 ,",
    "the smallest concave majorant @xmath304 of @xmath162 is the line , from the origin , tangent to @xmath162 .",
    "hence the value function is @xmath378,\\\\ g(x , s ) , & x\\in ( x^*(s ) , s ] , \\end{cases}\\end{aligned}\\ ] ] where @xmath379 .",
    "hence @xmath380 is the value function in region @xmath241 in figure [ fig - example - design ] .",
    "\\(iii ) for @xmath355 , we have @xmath372 so that the point @xmath157 is in the stopping region .",
    "moreover , there exist no points @xmath165 where the line from the origin becomes tangent to @xmath162 .",
    "accordingly , the value function is @xmath381.\\ ] ] in our parameters , @xmath382 and @xmath383 is very close ; @xmath384 .",
    "\\(iv ) now we shall examine @xmath251 .",
    "as explained in case ( 3 ) in section [ sec : finding - v(s , s ) ] , this @xmath385 satisfies @xmath386 .",
    "following the argument there , @xmath387 .",
    "accordingly , the value function is @xmath388.\\ ] ] this corresponds to region @xmath389 in figure [ fig - example - design ] .",
    "+ ( i ) graph of @xmath162 and the tangent line @xmath304 when @xmath390 . @xmath391 .     + ( ii ) graph of @xmath392 and the tangent line @xmath393 with @xmath394",
    "lemma [ lem : epsilon ] is the following claim : _ under the assumption of proposition [ prop:2 ] with convex @xmath193 , we have @xmath395 _    ( of the lemma ) recall for the definition of @xmath396 . in view of ,",
    "the probabilistic meaning of is that @xmath397 is attained when one chooses the excursion level @xmath396 optimally in the following optimal stopping : @xmath398,\\ ] ] that is , if the excursion from @xmath18 does not reach the level of @xmath396 before @xmath5 reaches @xmath399 , one shall receive @xmath400 and otherwise , one shall receive the reward . by using the transformation",
    ", one needs to consider the function @xmath401 and the point @xmath402 in the @xmath403-plane",
    ". then the value function of in this plane is the smallest concave majorant of @xmath401 which passes through the point @xmath402 .",
    "it follows that @xmath404 . as @xmath209 ,",
    "it is clear that @xmath405 and @xmath406 .",
    "suppose , for a contradiction , that we have @xmath407 for all @xmath211 .",
    "this implies that the first term in goes to @xmath408 from below and the third term goes to the same limit from above .",
    "while the second inequality always hold , the first inequality leads to a contradiction to the fact that the function @xmath409 is continuous for all @xmath18 .    indeed , due to the monotonicity of @xmath410 in @xmath215",
    ", we would have @xmath411 for all @xmath211 .",
    "hence one can not make the distance between @xmath412 and @xmath410 arbitrarily small without violating .",
    "this shows that there exists an @xmath413 such that @xmath414 implies that @xmath415 .    on the other hand , in",
    ", one could choose a stopping time @xmath416 that visits the left boundary @xmath27 , then by reading with @xmath417 and @xmath418 , becomes @xmath419 for _ any _ @xmath211 .",
    "since @xmath192 is a regular point , the last expectation can be arbitrarily close to unity , monotonically in @xmath215 ( see page 89 @xcite ) .",
    "now suppose that there were no @xmath215 s such that @xmath420 .",
    "it follows that for any @xmath215 , we would have @xmath421 then by letting @xmath209 , it would be @xmath422 for all @xmath351 , which is absurd . since the convergence of @xmath423 is monotone in @xmath215 , there exists an @xmath424 such that @xmath425 implies that @xmath420 . by using the second assumption in the statement of proposition , in particular , for any @xmath18",
    ", we have @xmath426 for @xmath425 .",
    "this completes the proof of lemma [ lem : epsilon ] .",
    "reference is made to section [ sec : finding - v(s , s ) ] .",
    "another representation of @xmath19 is still possible . continue to fix @xmath351 .",
    "the smooth - fit principle is assumed to hold at an optimal point @xmath427 and we have @xmath428 as a continuation region with the line @xmath273 tangent to the function @xmath429 at @xmath430 .",
    "then we have a first - order approximation of @xmath412 : @xmath431 where @xmath432 the slope of @xmath433 at @xmath275 .",
    "equate equation with to obtain , for any @xmath215 sufficiently close to zero , @xmath434 since @xmath435 as @xmath436 , @xmath437 where the last equality is obtained by lhpital s rule . by multiplying @xmath181 on both sides and performing some algebra",
    ", we have @xmath438.\\end{aligned}\\ ] ]    let us mention some comments on the examples in section [ sec : finding - v(s , s ) ] . in section [ sec : perpetual ] of the perpetual put , for the @xmath197 , as can be seen from the figure [ fig - put ] , @xmath439 .",
    "then ( see also ) reduces to a very simple form @xmath440 which is the same as .    in the lookback option in section [ sec : lookback ] , the case of @xmath441 was solved in the well - known @xcite . for @xmath441 , the reward @xmath168 does not depend on @xmath442 , so that we have further simplification of @xmath85 . a straightforward computation from below yields @xmath443 where we write @xmath444 for simplicity .",
    "it can be confirmed that for @xmath445 is the same as @xmath446 in @xcite .",
    "we comment on the assumption of the smooth - fit .",
    "when the reward function @xmath168 is a _ nondecreasing function of the second argument and is differentiable in both arguments _ , we have @xmath447 and hence the approximation argument is valid .",
    "note that in figure [ fig - put ] , we have @xmath448 and the smooth - fit holds at @xmath427 in both cases ."
  ],
  "abstract_text": [
    "<S> we provide , in a general setting , explicit solutions for optimal stopping problems that involve diffusion process and its running maximum . </S>",
    "<S> our approach is to use the excursion theory for lvy processes . </S>",
    "<S> since general diffusions are , in particular , not of independent increments , we use an appropriate measure change to make the process have that property . </S>",
    "<S> then we rewrite the original two - dimensional problem as an infinite number of one - dimensional ones and complete the solution . </S>",
    "<S> we show general solution methods with explicit value functions and corresponding optimal strategies , illustrating them by some examples .     </S>"
  ]
}