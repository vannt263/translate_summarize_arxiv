{
  "article_text": [
    "simulations aiming to study the local behavior of ( magneto-)hydrodynamic flows usually invoke periodic boundary conditions .",
    "this accounts for the unboundedness of the flow and prevents the system from obtaining information about its surface .",
    "however , in the case of a shearing background flow periodicity is not strictly applicable .",
    "typical scenarios for this include differentially rotating gaseous accretion disks , which are encountered in many astrophysical contexts . such systems ( if sufficiently ionized ) are found to be unstable to the so - called magneto - rotational instability ( mri ) and have been successfully modeled during the past decade ( see @xcite and references therein ) .",
    "considerable progress in the field has been made using the local shearingbox approach , a detailed description of which can be found e.g. in @xcite .",
    "the two key issues to be addressed in the design of shearingbox boundary conditions are ( 1 ) the time - dependent shifted - periodic mapping of the dependent variables of mass density , momentum , energy and , in case of magnetohydrodynamic flows , the magnetic field and ( 2 ) the offset introduced in the velocity component parallel to the shearing background .",
    "the latter represents the global shear across the domain which is forced constant in time .",
    "both of these features and the numerical treatment of the resulting source terms arising in the local approximation have profound implications on the accuracy properties of the shearingbox advection / induction scheme .    in this paper",
    "we will deal with these implications in detail .",
    "first , section 2 gives a compact recollection of basic facts about the mhd scheme in nirvana necessary for a understanding of the following shearingbox implementation which is then described in section 3 .",
    "section 4 presents test cases to validate our approach .",
    "although the nirvana code can account for dissipative effects ( viscosity , diffusion , thermal heat conduction ) , multi - scale phenomena ( using adaptive mesh refinement , see ziegler @xcite ) as well as self - gravity ( multigrid - type poisson solver , see ziegler @xcite ) , we want to focus here on ideal mhd in three space dimensions described by the following set of coupled equations    @xmath0    where @xmath1 .",
    "the source term @xmath2 arises from non - inertial forces in the local frame ( rotating with @xmath3 relative to the inertial frame ) and will be discussed in detail in section [ sec : source ] .",
    "the flux functions @xmath4 , @xmath5 .",
    "@xmath6 are defined as :    @xmath7   m_xv_x+p+\\half{\\bf b}^2 - b_xb_x \\\\[-1ex ] m_yv_x - b_yb_x \\\\[-1ex ] m_zv_x - b_zb_x \\\\[-1ex ] ( e+p+\\half{\\bf b}^2)\\,v_x-({\\bf v}\\!\\cdot\\!{\\bf b})b_x \\end{array}\\right)\\,,\\label{eq : flux_x } \\\\ { \\bf f}^y & = & \\left(\\begin{array}{c } m_y \\\\[-1ex ] m_xv_y - b_xb_x \\\\[-1ex ] m_yv_y+p+\\half{\\bf b}^2 - b_yb_y \\\\[-1ex ] m_zv_y - b_zb_y \\\\[-1ex ] ( e+p+\\half{\\bf b}^2)\\,v_y-({\\bf v}\\!\\cdot\\!{\\bf b})b_y \\end{array}\\right)\\ , , \\\\ { \\bf f}^z & = & \\left(\\begin{array}{c } m_z \\\\[-1ex ] m_xv_z - b_xb_z \\\\[-1ex ] m_yv_z - b_yb_z \\\\[-1ex ] m_zv_z+p+\\half{\\bf b}^2 - b_zb_z \\\\[-1ex ] ( e+p+\\half{\\bf b}^2)\\,v_z-({\\bf v}\\!\\cdot\\!{\\bf b})b_z \\end{array}\\right)\\,.\\end{aligned}\\ ] ]    we adopt a notation where the magnetic permeability is set to unity .",
    "the equations are to be supplemented by the zero - divergence constraint @xmath8 for the magnetic field * b * and an equation of state @xmath9 with @xmath10 .",
    "other symbols have their usual meaning with @xmath11 denoting the mass density , @xmath12 the total energy density , @xmath13 the thermal energy density , @xmath14 the pressure , @xmath15 the velocity , @xmath16 the momentum , @xmath17 the electric field and @xmath18 the ratio of specific heats .    the numerical method used to solve",
    "the above system is a hybrid scheme combining the second - order version of the godunov - type central - upwind scheme of kurganov et al .",
    "@xcite with the constraint transport ( ct ) technique for divergence free magnetic field evolution ( see e.g. evans & hawley @xcite , tth @xcite ) . the original description of this hybrid approach can be found in ziegler @xcite . here , we compactly summarize the relevant knowledge necessary for constructing the shearingbox - implementation .    let the computational domain be subdivided in uniform cartesian cells @xmath19 \\times [ y_{j{\\!-\\!\\half}},y_{j{\\!+\\!\\half}}]\\times [ z_{k{\\!-\\!\\half}},z_{k{\\!+\\!\\half}}]$ ] with center @xmath20 and spacings @xmath21 , @xmath22 and @xmath23 . then , the scheme for eq .",
    "( [ eq : hydro ] ) in semi - discrete form reads    @xmath24    where the cell - centered @xmath25 is an approximation to the volume - averaged state @xmath26 in cell @xmath27 and the numerical fluxes are given by :    @xmath28    with @xmath29 .",
    "we apply the third - order strong - stability - preserving runge - kutta scheme in @xcite to integrate eq .",
    "( [ eq : hydro_sd ] ) in time ( see also eq .",
    "( [ eq : rk3 ] ) ) . at any stage in the runge - kutta scheme",
    "the evaluation of the flux functions at cell faces requires point values for the variables left / right to a cell interface which are obtained by piecewise linear reconstruction from @xmath30 applying the tvd slope - limiter of van leer @xcite .",
    "these point values are characterized in the following by superscripts w at cell interface @xmath31 , e at @xmath32 , s at @xmath33 , n at @xmath34 , b at @xmath35 and t at @xmath36 , respectively . with",
    "such notation @xmath37 stands for the reconstructed value within cell @xmath38 at @xmath32 and @xmath39 for the value within cell @xmath27 at the _ same _ position .",
    "in contrast to the _ cell - centered _ @xmath40 we use staggering for the magnetic field i.e. the _ face - centered _ finite - volume approximations to the face - averaged components are @xmath41 , @xmath42 and @xmath43 , respectively .",
    "it follows that in the reconstruction of * b * at e , w position the x - component is already properly located , i.e. @xmath44 , whereas other components are first reconstructed in @xmath45-direction and then spatially averaged in the transverse direction .",
    "reconstruction of @xmath46 at the other locations n , s , b , t is done in analogous fashion .",
    "the quantities @xmath47 in the flux formulae define the maximum ( plus sign ) respective minimum ( minus sign ) wave - propagation - direction - sensitive speed at the interface @xmath48 , i.e.    @xmath49    where @xmath50 is an upper limit for the fast magnetosonic speed including the sound speed @xmath51 and alfvn - speed @xmath52 .",
    "the corresponding speeds in the @xmath53(@xmath54)-direction are denoted by @xmath55 ( @xmath56 ) .",
    "the above method can be formally applied to the induction equation  ( [ eq : induction ] ) .",
    "writing the curl of the electric field as divergence of an antisymmetric tensor    @xmath57 -e_z & 0 & e_x \\\\[-1ex ] e_y & -e_x & 0 \\end{array } \\right)\\,,\\ ] ]    and utilizing the abbreviations @xmath58 , @xmath59 , and @xmath60 , in analogy to eqs .",
    "( 7)(9 ) one can derive electric field fluxes    @xmath61    these are , like the @xmath62-fluxes , defined at cell faces .",
    "as before , at any stage in the runge - kutta scheme , the electric field function @xmath63 ( @xmath64 , @xmath65 ) have to be evaluated at e , w ( n , s , t , b ) cell interfaces using reconstructed data , e.g. , @xmath66 .",
    "our ct scheme for the staggered magnetic field components finally reads in semi - discrete form    @xmath67    where @xmath68 , @xmath69 , @xmath70 are _ edge - centered _ approximations to the edge - averaged electric field components .",
    "these are computed by composition of the electric field fluxes obtained from the godunov - central scheme , i.e. ,    @xmath71    it is now easy to show from ( [ eq : ind_x_sd])([eq : ind_z_sd ] ) that @xmath72    thus , if @xmath73 initially , the system evolves divergence - free since this condition is fulfilled after each stage in the multi - stage runge - kutta scheme .    the full system of odes  ( [ eq : hydro_sd ] ) ,  ( [ eq : ind_x_sd])([eq : ind_z_sd ] ) including the source term is solved with the strong - stability - preserving third - order runge - kutta integration scheme given by ( dropping cell indices and writing the rhs of eq .",
    "[ eq : hydro_sd ] as @xmath74 and ( [ eq : ind_x_sd])([eq : ind_z_sd ] ) compactely as @xmath75 ) @xmath76 with the time - step @xmath77 restricted by the cfl condition .",
    "let us now consider a magnetohydrodynamic flow with a background profile of the form @xmath78 , with ( linear ) shear - parameter @xmath79 . the computational domain is a cartesian box with dimensions @xmath80 ,",
    "@xmath81 , @xmath82 and periodic boundaries in @xmath83 and @xmath84direction . to account for the background shear",
    "we introduce shearingbox boundary conditions in @xmath85direction .",
    "these can be expressed mathematically in the form ) , ( [ eq : map_e ] ) . ]",
    "( e.g. @xcite ) :    @xmath86    where @xmath87 represents the global velocity - offset across the box , as can be seen in figure  [ fig : shearing ] .",
    "because nirvana being a conservative code evolves the total energy ( rather than the internal energy @xmath13 ) we supplement the corresponding relation for the total energy density    @xmath88    which can be easily derived by separating the @xmath89 part from the total energy and then using  ( [ eq : map_my ] ) .",
    "as the @xmath53-coordinate of above mappings varies continously in time , there is some kind of interpolation necessary to map ghostzone values on a finite grid ( see e.g. @xcite for details ) . for our implementation",
    ", the same piecewise linear reconstruction is used as for the numerical scheme .    due to",
    "the shifted periodicity and the additional interpolation , ghost cells on opposing sides of the domain along with their adjoint regular zones are not redundant in the same sense as for strictly periodic boundary conditions .",
    "let us elucidate on that : in the case of regular periodicity every pair of cell and ghost cell ( separated by the domain boundary ) has an identical counterpart at the opposite boundary .",
    "therefore the total flux across the interface is conserved to machine accuracy .    for shifted periodicity at a given time @xmath90 this does no longer hold .",
    "thus the additional truncation error connected to the interpolation can lead to the buildup of considerable deviations in conserved quantities , as is shown in section  [ sec : adv_test ] . in the following we want to suggest a method to correct for this . since strict conservation only applies as long as there is no source on the rhs of ( [ eq : hydro ] ) , in the local shearingbox approach with source term ( [ eq : source_m])/([eq : source_e ] ) only the total z - momentum and mass",
    "are exactly conserved .",
    "we note that it is nevertheless desirable to preserve all variables as good as possible under advection .      as the numerical fluxes are nonlinear functions of the conserved quantities any form of interpolation for the ghost cells will lead to some small inconsistency in the fluxes .",
    "this can be avoided by matching the computed @xmath45-fluxes at the sheared domain boundaries .",
    "it is straightforward to map fluxes not containing @xmath91 .",
    "the quantities related to those fluxes , i.e. mass density , @xmath45- and @xmath54-momentum are then conserved to machine precision with respect to advection . for the @xmath53-momentum flux and total energy flux , applying the mappings  ( [ eq : map_my])/([eq : map_e ] ) to the third and fifth component of the flux function  ( [ eq : flux_x ] )",
    "yields :    @xmath92    in nice analogy to the original mappings .",
    "we want to point out that these relations consistently include the magnetic part of the fluxes due to the lorentz - force , although this is not directly visible in the above notation .",
    "also , the modifications to the fluxes can be solely expressed in terms of fluxes and the velocity offset @xmath93 .",
    "the recipe can then directly be carried over to the numerical fluxes  ( [ eq : flux_x ] ) : while the first term is just a linear combination of the flux - function ( evaluated at the adequate positions ) one has to apply ( [ eq : map_my])/([eq : map_e ] ) once again for the second term , which then gives :    @xmath94    where the hat stands for the piecewise linear interpolation procedure used , and tilde marks the corresponding indices of the zones to map from .",
    "relation  ( [ eq : map_fe ] ) expresses the fact that the total energy within the shearingbox is not conserved but can be altered by angular momentum transport through the radial boundaries . in integral formulation",
    "this corresponds to eq .",
    "( 8) ( cast into our notation ) of hawley et al .",
    "@xcite :    @xmath95    where @xmath96 is the volume integral of total energy and @xmath97 expresses the perturbed velocity .",
    "yields the additional @xmath98 term in  ( [ eq : map_fe ] ) .",
    "] when correcting the energy- and momentum - fluxes according to eqs .",
    "( [ eq : map_fmy ] ) , ( [ eq : map_fe ] ) one can satisfy this property more accurately which allows to trace the detailed evolution of energetics , e.g. in mri - simulations .      applying gau theorem to the integral form of the induction equation",
    ", one can show that the azimuthal field ( due to the shear ) grows linearly with the net radial magnetic field - flux through the radial boundaries :    @xmath99    for zero net radial field the mean magnetic flux through the shearingbox is conserved .",
    "our implementation satisfies this condition to machine accuracy for the @xmath45- and @xmath54-component of the magnetic field and to truncation error for the @xmath53-component ( see section  [ sec : adv_test ] ) .",
    "this corresponds to the amount of precision reported by @xcite .",
    "the seminal paper of hawley et .",
    "al @xcite discusses this topic rather briefly , mentioning that mapping the electromotive forces at the sheared interfaces conserves the vertical field to roundoff error .",
    "furthermore , the authors state that the spurious vertical field , that arises otherwise , is negligible as the associated mri growth rates are unresolved . considering the differences between mri - simulations with and without zero net vertical field",
    "( see e.g. @xcite ) leaves this somewhat questionable in the sense that a spurious field might lead to an overestimation of magnetic stresses in the latter case . one",
    "might further investigate this by a series of mri - simulations with initial vertical field of the form @xmath100 , where @xmath101 , i.e. , with a controlled `` spurious '' field .",
    "although from the physical point of view an exactly vanishing vertical flux is rather a question of academic nature , the issue of enhanced turbulent transport for net vertical field is still standing .",
    "in our implementation we apply additional boundary conditions to the electric field fluxes @xmath102 to assure conservation of mean magnetic fields . due to the different staggering of magnetic field components , which are face - centered",
    ", the method has to be applied for the fluxes in all three directions .",
    "the velocity offset @xmath93 enters the fluxes via the electromotive force :    @xmath103    for the @xmath45(@xmath54)-direction only the @xmath45(@xmath54)-component of the magnetic field is needed to evaluate the additional second term . as the staggering of the normal field component coincides with that of the fluxes no reconstruction is needed in this case . employing @xmath104 ( respectively @xmath105 ) the characteristic velocities",
    "cancel out and we yield    @xmath106    for the numerical electric fluxes in @xmath45/@xmath54-direction .",
    "for the remaining direction matters are a bit more complicated and we need the full reconstruction to be consistent with the underlying numerical scheme : @xmath107    to conclude the discussion of the boundary conditions we want to remark that the reconstruction of the magnetic field at the sheared interfaces preserves the @xmath108 constraint to roundoff error ( see section  [ sec : adv_test ] ) .",
    "the actual code is publicly available on the internet at ` www.aip.de/~gressel/index.php?id=code ` and can be embedded into the original nirvana package .",
    "the current implementation supports distributed memory parallelism in the form of blockwise domain decomposition along the z - coordinate . in this case",
    "all the information needed to reconstruct the boundary values is available locally , i.e. , without mpi communications .",
    "additional block distribution along the x- and y - coordinates would in principle improve the surface to volume ratio but would also add communication overhead .",
    "this is discussed in detail in sections 4.3 and 4.4 of @xcite .",
    "their figure 5 shows that block distribution along the x - coordinate is inefficient and performance gains for additional distribution along the y - direction are moderate .",
    "they argue that the poor performance for x - distribution might be a cache issue with the fortran column major ordering , which leaves this result marginally meaningful for our implementation . in the case of vertically elongated boxes ,",
    "like they are common for simulations in galactic environments , distribution along z even outperforms y- and y - z - distributions .",
    "the second substantial ingredient of the shearingbox formalism are the source terms in the so called hill system .",
    "this approximation is based on the local expansion of the equations of motion resulting in a tidal force @xmath109 where @xmath110 represents the ( angular ) shear parameter for a differential rotation of the form @xmath111 .",
    "together with the coriolis force the source terms for the momentum- and energy equation are :    @xmath112    equation  ( [ eq : s_m ] ) shows that the momentum source terms can be combined and act as an effective is not a function of radius here . ]",
    "coriolis force on the perturbed velocity @xmath113 .",
    "this would in principle allow for an exact coriolis - update in the form of an analytic rotation .",
    "numerical tests , however , show that such an update is not suitable for the multi - stage runge - kutta integration scheme . because operator - splitting is not favorable ( for reasons described in section  [ sec : epi ] below )",
    "we decide to implement the source terms unsplit , i.e. , as explicit forces within the runge - kutta time integration scheme ( see eq .",
    "( [ eq : rk3 ] ) ) .",
    "gardiner & stone @xcite stress the importance of conserving the energy contained in the _",
    "epicyclic mode_. this ideally conserved quantity can be derived from the energy budget in the limit of inviscid flow .",
    "the general expression reads :    @xmath114    with @xmath115 the epicyclic frequency .",
    "this formally looks like a kinetic energy but also includes the potential energy with respect to the epicyclic displacement . we have found that it is important to implement the source terms in an unsplit fashion to avoid oscillations in this energy that would otherwise arise from systematic splitting errors .",
    "this is discussed in more detail in section  [ sec : epi ] below .",
    "we have validated our implementation with various simple advection tests , i.e. , with source terms switched off , and have checked the mentioned conservation properties .",
    ".convergence study of the relative error in total mass : ( a ) without special treatment , ( b ) with the method described above . [",
    "cols=\"<,^,^,^,^,^,^\",options=\"header \" , ]      the most prominent application for the shearingbox model , of course , is the magneto - rotational instability ( mri ) .",
    "we chose model parameters according to previous simulations @xcite with the old ( non - conservative ) nirvana - code , that is very similar to the widely used zeus - code . for simplicity we neglect stratification in this paper . a more sophisticated model , including stratification and radiative cooling has been implemented and will be employed in future work to explore mri under conditions suitable to the interstellar medium .",
    "-components of reynolds- and maxwell - stresses ( bottom ) for the non - conservative scheme ( left ) and the conservative scheme ( right).,width=472 ]    for now we use non - dimensional quantities , i.e. , density is set to unity while the pressure is @xmath116 , such that the sound speed over the box dimension matches the angular velocity @xmath117 .",
    "the initial magnetic field is purely vertical and varies as @xmath118 , resulting in a vanishing net vertical flux .",
    "the field amplitude @xmath119 corresponds to a plasma parameter of @xmath120 at the peaks of the sine - profile .",
    ".,width=472 ]    we apply a box geometry of @xmath121\\times[0,4 ] \\times[-2,2]$ ] with a resolution of 64x128x128 grid cells and perform computations on the new and the old code version to compare the conservative vs. the non - conservative scheme .",
    "the results are directly compared in figure  [ fig : mri ] .",
    "the saturated stresses and energies are of comparable magnitude although the initial growth of the instability and the breakdown of the channel - solution into chaotic turbulence differs quite a bit .",
    "the breakdown of the linear solution is related to parasitic instabilities that seem to be resolved differently in the two codes .",
    "the weaker initial peak for the conservative scheme is consistent with the results in @xcite .",
    "saturation amplitudes are compatible with earlier results @xcite .",
    "although the codes compare quite well with respect to the kinematic quantities ( see figure  [ fig : mri ] ) , there is a major difference concerning the thermalization of the extracted turbulent energy .",
    "as can be seen in the right panel of figure  [ fig : mri - heating ] the conservative code efficiently transfers the released energy into thermal energy , which leads to a rapid heating of the gas .",
    "the non - conservative code shows much less heating .",
    "compared to the work exerted by the boundary - stresses ) .",
    "] , that is shown as a dashed line ( on top of the total energy ) in the left panel of figure  [ fig : mri - heating ] , there is a considerable amount of energy lost .",
    "this paper described the implementation of a shearingbox environment for the flux - conservative / constraint - transport mhd code nirvana . to our knowledge",
    "this is the first time such an implementation has been developed for a central - type numerical scheme .",
    "we showed that shift - periodic boundary conditions accounting for a prescribed linear shear flow across the computational domain can be handled within a conservative framework .",
    "this comes about by a proper modification of the hydrodynamical numerical fluxes with the mappings of @xmath53-momentum flux and total energy flux solely expressed in terms of known mapped fluxes and the velocity offset of the background shear flow .",
    "such mappings are , in principle , independent of the underlying numerical scheme , provided it is given in flux - conservation form .",
    "in contrast , our proposed mappings of the ( face - centered ) electric field fluxes contain explicit information on the magnetic field components at the boundary as well as on the characteristic speeds used by the numerical scheme . nevertheless , we demonstrated by numerical experiment that such a mapping is divergence - free , exactely conserves the @xmath45- and @xmath54-component of mean magnetic field and the corresponding @xmath53-component up to truncation error but , obviously , is scheme - dependent .",
    "an alternative method would be to directly map the edge - centered electric field fluxes , as those are the quantities which enter the constraint - transport equations .",
    "however , initial investigations of that approach have not been proven successful to date .        j.f .",
    "hawley , c.f .",
    "gammie , s.a .",
    "balbus , atsrophys .",
    "j. 440 ( 1995 ) 742 .",
    "balbus , j.f .",
    "hawley , rev . of mod .",
    "phys . 70/1 ( 1998 ) 1 - 53 .",
    "balbus , annual rev . of a&a 41 ( 2003 ) 555 - 597 .",
    "s.  e. caunt , m.  j. korpi , a&a . 369",
    "( 2001 ) 706 .",
    "evans , j.f .",
    "hawley , astrophys .",
    "j. 332 ( 1998 ) 659 .",
    "gardiner , j.m .",
    "stone , aip conference proceedings 784 ( 2005 ) 475 .",
    "s. gottlieb , c .- w .",
    "shu , e. tadmor , siam rev .",
    ", 43 ( 2001 ) 89 - 112 .",
    "a. kurganov , s. noelle , g. petrova , siam j. sci .",
    "comput . 23",
    "( 2001 ) 707 .",
    "b. van leer , j. comput .",
    "( 1977 ) 276 .",
    "g. tth , j. comput .",
    "161 ( 2000 ) 605 .",
    "u. ziegler , j. comput .",
    "( 2004 ) 393 .",
    "u. ziegler , comp .",
    "commun . 170 ( 2005 ) 153 .",
    "u. ziegler , astron .",
    "astrophys . 435",
    "( 2005 ) 385 .",
    "u. ziegler , g. r \" udiger , a&a 356 ( 2000 ) 1141 ."
  ],
  "abstract_text": [
    "<S> we describe the implementation of the shearingbox approach into the godunov - type central - upwind / constraint - transport magnetohydrodynamics code nirvana . this will allow for applications which require sheared - periodic boundary conditions as typically used in local cartesian simulations of differentially rotating systems . </S>",
    "<S> we present the algorithm in detail and discuss necessary modifications in the numerical fluxes in order to preserve conserved quantities and to fulfill other analytical constraints as good as seem feasible within the numerical scheme . </S>",
    "<S> we check the source terms which come with the shearingbox formulation by investigating the conservation of the epicyclic mode energy . </S>",
    "<S> we also perform more realistic simulations of the magneto - rotational instability with initial zero - net - flux vertical magnetic field and compare the obtained stresses and energetics with previous non - conservative results exploring the same parameter regime .    </S>",
    "<S> magnetohydrodynamics , numerics : shearingbox </S>"
  ]
}