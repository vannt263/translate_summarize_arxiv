{
  "article_text": [
    "the calculation of free energies , or free energy differences , is a difficult task for simulation .",
    "free energies can not be conveniently expressed as averages , and because of this specific answers have been proposed , including the well known thermodynamic perturbation and integration methods @xcite , but also biasing potentials @xcite and umbrella sampling @xcite , constraint dynamics in the so - called `` blue - moon '' ensemble @xcite , adiabatic switching @xcite and reversible - scaling @xcite , and the recent adiabatic molecular dynamics method @xcite .",
    "given two states a and b in configuration space , these techniques allows one to get a thermodynamic picture of the reaction pathway between a and b , but also to estimate transition rates . when the reaction coordinate is not well defined , it is still possible to calculate such rates using the transition path sampling approach @xcite .",
    "most of the above methods suffer from important limitations when it comes to a practical situation .",
    "one must either find by trial and error a suitable guiding potential ( the multicanonical ensemble sampling @xcite can help in this search ) , or deal with the specific transformation rules required by constraint dynamics , which can often be cumbersome in the case of angle coordinates .",
    "the adiabatic free energy dynamics method @xcite also makes use of variable transformation and particular integrators .",
    "recently , wang and landau have proposed a very simple algorithm to compute the density of states of spin systems @xcite .",
    "their multiple range random walk method has since been extended to spin glasses @xcite , continuous fluids @xcite , proteins @xcite and polymer fluids @xcite .",
    "a combination with the kinetic monte carlo algorithm has also been made by schulz , binder , and m \" uller @xcite .",
    "although this method was originally conceived to calculate a microcanonical quantity , constant temperature properties can be recovered using appropriate laplace transformations .",
    "the main interest of the algorithm is that it does not require any information _ a priori _ , other than a suitable choice of reaction coordinate .",
    "instead it converges to the expected solution with a greater accuracy at each new iteration .",
    "the goal of this paper is to propose a simple way to use the wang - landau method in the context of free energy profiles . as will be shown below ,",
    "the limitations mentioned earlier essentially vanish , making the method really useful in various statistical ensembles .",
    "the article is organised as follows . in the next section ,",
    "we give the main ideas of the wang - landau algorithm in the framework of free energy calculations . in section  [ sec : res ] , we illustrate this method on three examples .",
    "firstly , a simple analytical 10-dimensional potential energy surface is investigated and the simulation results are compared with analytical data . secondly , the free energy profile of the butane molecule along the dihedral angle coordinate is calculated in gas phase and ccl@xmath0 solvent , and compared with previous works on the same system @xcite .",
    "thirdly , we study the cube - ring isomerisation in a small rocksalt cluster , namely ( naf)@xmath0 , in the microcanonical ensemble .",
    "we briefly summarise and conclude in section  [ sec : ccl ] .",
    "we consider a classical n - dimensional system in a given statistical ensemble characterized by a equilibrium distribution @xmath1 .",
    "this distribution is a function of the cartesian coordinates @xmath2 , and also of external parameters such as temperature or total energy .",
    "a reaction coordinate @xmath3 is constructed , and we look for the probability density @xmath4 for the reaction coordinate to take the particular value @xmath5 : @xmath6 \\rangle .",
    "\\label{eq : pl0}\\ ] ] in this equation , @xmath7 denotes the average value of @xmath8 in the statistical ensemble characterised by @xmath1 : @xmath9 the original multiple range random walk method of wang and landau @xcite consists of performing a monte carlo simulation using a metropolis acceptance probability with a dynamical weight @xmath10 , where @xmath11 is the energy of configuration @xmath12 : @xmath13 .",
    "\\label{eq : wle}\\ ] ] for each visited state with energy @xmath14 , @xmath15 is scaled by a constant factor @xmath16 : @xmath17 .",
    "the scaling factor @xmath16 is initially quite large @xmath18@xmath19 , and is periodically reduced toward one .",
    "@xmath15 is initially set to one for all values of @xmath14 . as shown by wang and landau @xcite",
    ", this algorithm smoothly converges to a flat probability distribution when @xmath20 , meaning that the function @xmath15 converges to the density of states @xmath21 of the system .",
    "since @xmath22 and @xmath23 play similar roles , the same ideas can be applied to the problem of free energy profiles along reaction coordinates .",
    "let @xmath24 be a function initially set to one in the whole range of accessible values of @xmath25 . for practical and numerical purposes",
    ", it turns out that it is more convenient to work with @xmath26 instead of @xmath15 .",
    "we perform a monte carlo simulation using the following metropolis acceptance rule : @xmath27\\nonumber \\\\ & = & \\displaystyle \\min\\left [ 1 , \\frac{\\rho({\\bf r}_{\\rm new})}{\\rho({\\bf r}_{\\rm old } ) } \\times \\frac{e^{-s(\\lambda_{\\rm new})}}{e^{-s(\\lambda_{\\rm old } ) } } \\right ] , \\label{eq : ert}\\end{aligned}\\ ] ] with @xmath28 and @xmath29 . after the new configuration",
    "is visited , the corresponding @xmath30 is updated : @xmath31 .",
    "the parameter @xmath32 is progressively decreased to zero at each new iteration .",
    "the histogram @xmath33 of visited values of @xmath25 is considered flat when @xmath34 for all @xmath25 .",
    "the parameter @xmath35 is usually taken between 0.5 and 0.99 .",
    "after a large number of mc steps and some iterations , @xmath36 gets close to the probability density @xmath37 defined in equation ( [ eq : pl0 ] ) . as noted by wand and landau @xcite , the continuous change in the statistical weight in eqn .",
    "( [ eq : wle],[eq : ert ] ) strictly violates detailed balance .",
    "actually , detailed balance is satisfied only after the function @xmath38 becomes nearly constant , and within an accuracy of order of magnitude @xmath39 @xcite .",
    "in fact , as is well known in statistical mechanics , detailed balance in only a _ sufficient _",
    "condition for the monte carlo chain to be markovian @xcite .    in the canonical ensemble at temperature @xmath40 ,",
    "the equilibrium distribution is given by the boltzmann factor @xmath41 $ ] , where @xmath42 is the potential energy of configuration @xmath12 .",
    "introducing @xmath43 , equation ( [ eq : ert ] ) can be rewritten as @xmath44 , \\label{eq : bdf}\\ ] ] with @xmath45 , and the landau free energy @xmath46 $ ] .",
    "the function @xmath47 converges to the potential of mean force ( pmf ) w : @xmath48 in the microcanonical ensemble at total energy @xmath14 , the equilibrium density is @xmath49^{n/2 - 1}$ ] , and @xmath38 plays the role of a landau entropy .",
    "extra variables can be included , as in the isothermal - isobaric npt ensemble , or the grand - canonical @xmath50vt ensemble .",
    "expressions similar to equation ( [ eq : bdf ] ) are then found for the acceptance probability , based on their usual forms without reaction coordinates @xcite .",
    "there is no other input to this algorithm than the function @xmath15 , initially unknown and set to one . in order to illustrate its efficiency ,",
    "we have chosen to apply the method to a variety of molecular systems .",
    "following rosso and coworkers @xcite , we start to test our method on a simple potential energy surface ( pes ) for which exact results can be obtained .",
    "the expression for @xmath51 is that of a double - well potential @xmath52 the parameters are @xmath53 and @xmath54 for all @xmath55 .",
    "the reaction coordinate is @xmath56 , and the pmf at temperature @xmath57 is found to be @xmath58 therefore @xmath59 does not depend on @xmath57 .",
    "we have calculated the free energy profile @xmath59 along the reaction coordinate @xmath25 in the range @xmath60 using the wang - landau method , with 20 iterations of @xmath61 monte carlo steps , of which the first @xmath62 were removed for equilibration .",
    "the histogram in @xmath25 is made of 1000 bins . to illustrate the power of the algorithm , the temperature is chosen as only @xmath63 . in figure [ fig : pmft10 ]",
    "we have plotted the calculated pmf against the    analytical result of equation ( [ eq : w ] ) .",
    "the two curves are nearly indiscernable , and inspecting the error function @xmath64 in the inset of this figure reveals how accurate the computed free energy profile is . in the microcanonical ensemble , when the total energy @xmath14 is close to the saddle energy @xmath65 , the true dynamics is strongly slowed down and the crossing rate between the two wells drops to zero . the landau entropy @xmath30 associated with the microcanonical probability density can be easily calculated as @xmath66 , \\label{eq : sl}\\ ] ] up to an additive constant .",
    "the simulation was performed with the microcanonical distribution @xmath67 ^ 4 $ ] , with the same number of mc steps and iterations as above , at the total energies @xmath68 , 10 , and 5.5 , respectively .",
    "the results are represented in figure [ fig : pmfe10 ] .",
    "the agreement between the numerical experiment and the exact value is again very good , even for the most difficult case @xmath69 .",
    "therefore the wang - landau method seems very efficient for computing free energies and related quantities along reaction coordinates , at least in such low dimensional model problems .",
    "we turn now to a more realistic system and a more complex reaction coordinate .",
    "the _ cis - trans _ isomerisation in n - butane has previously been investigated by several authors @xcite .",
    "in particular , depaepe and coworkers have used this molecule as a benchmark for free energy calculations @xcite .",
    "the accurate results obtained by these authors using umbrella sampling and constrained dynamics in the blue - moon ensemble allow a stringent test of the present method .",
    "the butane molecule is modelled with a united - atom potential interacting with the solvent molecules via a simple lennard - jones ( lj ) potential .",
    "the total potential energy @xmath42 of the system having one solute molecule and @xmath70 solvent molecules is written in cartesian coordinates @xmath71 , where @xmath72 , label the ch@xmath73 and ch@xmath74 groups of the butane molecule , and @xmath75 , @xmath76 label the solvent molecules .",
    "the ch@xmath73 and ch@xmath74 groups are connected by harmonic c - c bonds and c - c - c bending forces .",
    "a torsion potential between the extremal methyl groups consists of a dihedral angle term and a lj interaction @xmath77 .",
    "the solvent is chosen as carbon tetrachloride , which is nonpolar and simple enough to allow for a simple united - atom description with the lj form .",
    "the expression for @xmath42 is @xmath78 with @xmath79 @xmath80 @xmath81 in equation ( [ eq : but ] ) , @xmath82 and @xmath83 are the c - c bond lengths and c - c - c bending angles , respectively : @xmath84 , @xmath85 .",
    "the dihedral angle @xmath39 is defined as zero in the _ cis _ conformation : @xmath86 all parameters are taken from ref .",
    "@xcite for sake of comparison .",
    "we recall them for clarity : @xmath87   , @xmath88   , @xmath89  kj  mol@xmath90  @xmath91 , @xmath92  rad , @xmath93  kj  mol@xmath90  rad@xmath91 , @xmath94  kj  mol@xmath90 .",
    "the lj parameters for the @xmath77 term in equation ( [ eq : but ] ) are",
    "@xmath95  kj  mol@xmath90 and @xmath96   . for ch@xmath73 , ch@xmath74 , and ccl@xmath0 , they are respectively @xmath97 , @xmath98 , and @xmath99 kj  mol@xmath90 , and @xmath100 , @xmath101 , and @xmath102   .",
    "the parameters for mixed interactions are obtained from the lorentz - berthelot combination rules .",
    "monte carlo simulations were carried out at room temperature @xmath103  k , for the n - butane molecule in gas phase and in ccl@xmath0 solvent at density @xmath104  g  @xmath105 . as in ref .",
    "@xcite , 123 carbon tetrachloride molecules were placed in a cubic box of side @xmath106   , periodic boundary conditions were implemented through the minimum image convention .",
    "all lj interactions were truncated at 11.75   .",
    "the reaction coordinate is the dihedral angle @xmath39 , and all simulations consisted of 20 iterations of @xmath61 mc cycles each , including @xmath62 initial thermalisation cycles .",
    "1000 bins were used for the histogram in @xmath39 . in the case of the solvated molecule",
    "we have supplemented the present algorithm with the preferential sampling scheme of owicki and scheraga @xcite as implemented by mehrotra and coworkers @xcite .",
    "each carbon group of the butane molecule was chosen for displacement with probability @xmath107 .",
    "the probability of choosing a solvent molecule @xmath55 decays with its distance from the centre of mass of the solute molecule @xmath108 as @xmath109 , where @xmath110 is determined by the normalisation of the total probabilities . because of this bias , the acceptance probability ( [ eq : bdf ] ) is modified and becomes @xcite @xmath111 .",
    "\\label{eq : bdfps}\\ ] ] preferential sampling is particularly useful in this problem , because we focus on a property of the solute molecule influenced by the solvent .",
    "the probability densities of the dihedral angle @xmath112 in gas phase and ccl@xmath0 solvent are plotted in figure [ fig : butane ] .",
    "the shape is very similar to the curves    reported by depaepe _",
    "@xcite , but quantitative comparison must be made on specific indicators .",
    "we have calculated the fraction of _ trans _ isomer , @xmath113 , and the absolute probability densities @xmath114 at the free energy barrier @xmath115 .",
    "the results are given in table [ table ] .",
    ".distribution of _ trans _ conformation of n - butane at equilibrium .",
    "@xmath116 is the fraction of _ trans _ isomer , @xmath114 is the absolute probability density of finding the system at the free energy barrier @xmath117 .",
    "the errors correspond to one standard deviation . [",
    "cols=\"<,^,^\",options=\"header \" , ]     the agreement between the work by depaepe and coworkers and the present results using the wang - landau method is quite remarkable , especially considering that the numerical cost of the monte carlo simulation is lower than the molecular dynamics simulation of ref .",
    "this quantitative agreement suggests that the wang - landau method is accurate even for large molecular systems .",
    "the previous results have shown that free energy profiles can be efficiently calculated with the multiple range random walk technique .",
    "data of comparable accuracy could be obtained with the adiabatic free energy dynamics of rosso and coworkers @xcite , which has been especially designed for use in the canonical ensemble .",
    "we now illustrate our method on another problem of molecular character , but in the microcanonical ensemble . the small ( naf)@xmath0 ionic cluster has two stable isomers , a cube ( @xmath118 symmetry , energy @xmath119  hartree ) , and an octogonal ring ( @xmath120 , @xmath121  hartree ) .",
    "the cube@xmath122ring isomerisation dynamics has been previously investigated in a similar ( nacl)@xmath0 cluster by heidenreich , oref , and jortner @xcite .",
    "this system is made of 8 na@xmath123 and f@xmath124 ions interacting via coulomb forces and born - mayer short - range repulsion : @xmath125 the parameters are taken from _",
    "_ calculations @xcite : @xmath126  hartree , @xmath127  bohr@xmath90 . a suitable reaction coordinate",
    "is required to distinguish the two isomers at a given total energy .",
    "after several attempts , we have found that the principal momenta of inertia could achieve this goal .",
    "we choose the following reaction coordinate : @xmath128 where @xmath129 is the position of the cluster centre of mass .",
    "@xmath25 has roughly the value 100  bohr@xmath130 in the cube isomer , and about 200  bohr@xmath130 in the ring isomer .",
    "the mc simulations were still performed for 20 iterations of @xmath61 cycles each , with 1000 bins in the range @xmath131 for the histograms .",
    "the probability densities of @xmath25 in the microcanonical ensembles at total energies @xmath132 , @xmath133 , @xmath134 , @xmath135 , @xmath136 , and @xmath137 hartree are plotted in figure  [ fig : naf1 ] .",
    "the    ring isomer is much more `` flexible '' than the cubic isomer , which is reflected in the relative widths of the two peaks in each of these distributions .",
    "the fraction of cubic isomers continuously decreases in this energy range , and this can be quantified using @xmath138 . in figure",
    "[ fig : naf2 ] we represent the variations of @xmath139 versus total energy . for    comparison ,",
    "we have also calculated @xmath139 from parallel tempering monte carlo @xcite in the microcanonical ensemble @xcite .",
    "for this , we also recorded the probability distributions of @xmath25 , and then we extracted @xmath139 .",
    "the two methods give very similar results , within the error bars , and show that the cube and ring isomers are in equal ratios at @xmath140 hartree . from this study , it could be also possible , in principle , to estimate transition rates that could be compared with actual molecular dynamics simulations . however , one must be careful that molecular dynamics simulations do not strictly sample the microcanonical ensemble .",
    "actually a geometrical factor , which depends on the inertia momenta , hence on @xmath25 , must be incorporated in the equilibrium statistical distribution @xmath141 @xcite . in order to compare with md ,",
    "the present mc simulations should be carried out again with this extra factor in the acceptance probabilities .",
    "the wang - landau method is successfully applied to the problem of calculating free energy profiles along reaction coordinates .",
    "this algorithm has several advantages over most other schemes currently in use .",
    "first , it does not require any use of constraints , which often imply complex variable transformations and the calculation of the associated jacobian .",
    "the method presented in this paper can be used with any kind of reaction coordinate , cartesian coordinates or angles .",
    "secondly , we do not have to guess the shape of the potential of mean force to guide the simulation with a biasing potential as in umbrella sampling . instead ,",
    "the method has its only input in the range of expected values of the reaction coordinate .",
    "it can subsequently provide the guiding potential which yields a uniform probability distribution .",
    "this `` flat histogram '' allows one to get accurate estimates of various properties using reweighting techniques , especially when large free energy barriers are present .",
    "thirdly , and in contrast with the adiabatic free energy dynamics of rosso and coworkers @xcite , no unknown parameter must be estimated for the method to work optimally .",
    "fourthly , because it is for use with monte carlo simulations , it can take benefit of many ideas aiming at accelerating convergence , such as the preferential sampling scheme employed here for a solvated molecule .",
    "lastly , but importantly , the method is not limited to any specific statistical ensemble , since it requires only the knowledge of the equilibrium statistical distribution .",
    "the very limited input of this algorithm makes it suitable for complex atomic and molecular systems , for which defining a suitable reaction coordinate can already be a difficult problem .",
    "we investigate three classes of model problems , namely a simple ten - dimensional double - well potential energy surface , the mean force of the dihedral angle in the gas phase and solvated n - butane molecule , and the cube@xmath122ring isomerisation of the rocksalt ( naf)@xmath0 cluster .",
    "we obtain good agreement with previous works , when published data are available .",
    "the method can be straightforwardly extended to treat free - energy hypersurfaces by considering multidimensional weighting functions @xmath142 and the corresponding histograms .",
    "this could also help in reaching equilibrium along coordinates , which are normal to the reaction coordinate .",
    "it is also a simple matter of algebra to generalise it to quantum free energy profiles by replacing the conventional boltzmann factors by feynman path integrals in the framework of quantum monte carlo ."
  ],
  "abstract_text": [
    "<S> the multiple range random walk algorithm recently proposed by wang and landau [ 2001 , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . , 86 </S>",
    "<S> , 2050 - 2053 ] is adapted to the computation of free energy profiles for molecular systems along reaction coordinates . </S>",
    "<S> more generally , we show how to extract partial averages in various statistical ensembles without invoking simulations with constraints , biasing potentials or unknown parameters . </S>",
    "<S> the method is illustrated on a model 10-dimensional potential energy surface , for which analytical results are obtained . </S>",
    "<S> it is then applied to the potential of mean force associated with the dihedral angle of the butane molecule in gas phase and in carbon tetrachloride solvent . </S>",
    "<S> finally , isomerisation in a small rocksalt cluster , ( naf)@xmath0 , is investigated in the microcanonical ensemble , and the results are compared to those of parallel tempering monte carlo . </S>"
  ]
}