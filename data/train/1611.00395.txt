{
  "article_text": [
    "the computational cost of the exact solution of the realistic extended many - electron problem is believed to be exponential in the number of degrees of freedom , necessitating the development of accurate approximate methods able to capture interacting electron physics.@xcite    while mature tools for obtaining ground state energetics for both molecular and solid state problems exist,@xcite solid state experiments are often performed at finite temperature and yield as the measured result not energy differences but single - and two - particle response functions , requiring a description of finite temperature excitations .",
    "many - body perturbation theory@xcite accurately describes these phenomena where interactions are weak .",
    "however , many systems of interest are believed to be outside the regime of validity of perturbative approximations . in these systems ,",
    "a non - perturbative solution is desired for a subset of the correlated degrees of freedom embedded into a background of more weakly correlated , perturbatively treated states .",
    "ideally such an embedding construct should be numerically tractable and defined in terms of one or more small parameters that allow its tuning from a crude but computationally cheap , approximate solution to the exact but exponentially expensive one .",
    "several such theories have been developed .",
    "they include the dynamical mean field theory ( dmft),@xcite its combination with electronic structure methods , such as lda+dmft  @xcite and gw+dmft  @xcite , the self - energy functional theory,@xcite and most recently the self - energy embedding theory ( seet).@xcite all of them require a compromise between accuracy and numerical tractability or time to solution .    in this paper , we show that seet can be understood as a conserving functional approximation to an exact luttinger - ward functional.@xcite this functional framework of seet allows us to compare this theory to other functional approximations , and show in particular that dmft , hf+dmft , and gw+dmft can be understood as a special case of seet and to illustrate how the additional freedom given by seet can be employed to systematically improve results .",
    "in particular , we focus on various aspects of electron ` screening ' and downfolding and how they are treated in various approximations .",
    "this paper proceeds as follows . in sec .",
    "[ sec : system ] , we introduce the system under study , the seet definition , dmft , and several combinations of dmft with many - body perturbation theory . in sec .",
    "[ sec : relationship ] , we compare the different approaches based on their functionals . in sec .",
    "[ sec : screening ] , we focus in detail on various aspects of electron screening .",
    "we form conclusions in sec .",
    "[ sec : conclusions ] .",
    "we consider a system described by a hamiltonian with full two - body interaction @xmath0 and one - body terms @xmath1 in a finite orbital basis : @xmath2 where the indices @xmath3 , @xmath4 , @xmath5 , and @xmath6 enumerate all @xmath7 basis orbitals present in the system . in case of a periodic system , eq .",
    "[ eqn : realistic_ham1 ] may in particular contain one - body terms connecting any orbital in any unit cell to any other orbital in any other unit cell , and general two - body integrals @xmath8 mixing interactions between any of the orbitals in any of the unit cells in the system .",
    "physical properties including thermodynamic quantities ( energies and entropies ) , frequency dependent single - particle ( green s functions and self - energies ) and two - particle quantities ( susceptibilities ) can be described in a functional approach .",
    "@xcite in this approach , a @xmath9- functional @xmath10 $ ] of the green s function @xmath11 , which contains all linked closed skeleton diagrams,@xcite is used to express the grand potential as @xmath12 and it satisfies @xmath13 , \\label{eq : dphidg}\\end{aligned}\\ ] ] where the self - energy @xmath14 is defined with respect to a non - interacting green s function @xmath15 via the dyson equation @xmath16 the functional formalism is useful because approximations to @xmath9 that can be formulated as a subset of the terms of the exact @xmath9 functional can be shown to respect the conservation laws of electron number , energy , momentum , and angular momentum by construction.@xcite in addition , @xmath9-derivability ensures that quantities obtained by thermodynamic or coupling constant integration from non - interacting limits are consistent.@xcite functional theory therefore provides a convenient framework for constructing perturbative @xcite and non - perturbative @xcite diagrammatic approximations .",
    "the approximations we discuss in the following sections are all expressed in the functional form , thus making them straightforward to discuss and compare their respective assumptions , limits , and strengths .        the self - energy embedding theory ( seet ) @xcite starts from the assumption that all orbitals present in the system can be separated into @xmath17 distinct orbital subsets @xmath18 , each containing @xmath19 orbitals , and a remainder @xmath20 with @xmath21 orbitals , such that @xmath22 , for each @xmath3 , and @xmath23 .",
    "we assume that the orbitals within each subset @xmath18 are more strongly correlated among each other than with other orbitals present in the system , so that their intra - subset correlations need to be obtained in a non - perturbative way .",
    "conversely , inter - set correlations between orbitals belonging to two different sets @xmath18 and @xmath24 , @xmath25 , and correlations belonging to the remainder @xmath20 are assumed to be weaker , such that they can be simulated perturbatively .",
    "the choice of orbital subsets and subset size @xmath19 is general and will be commented on in sec .",
    "[ sec : orbitalselec ] .",
    "seet first approximates the solution of the entire system using an affordable but potentially inaccurate @xmath9-derivable method ( weak coupling methods are a natural choice ) , and then corrects this approximation in the strongly correlated subspaces by a non - perturbative result .",
    "this is achieved by approximating the exact @xmath9-functional as @xmath26_i-[\\phi_\\text{weak}^a]_i\\big).\\end{aligned}\\ ] ] here , @xmath27 denotes a solution of the entire system using a conserving low - order approximation , for instance self - consistent second order perturbation theory ( gf2)@xcite or the gw method.@xcite @xmath28 denotes all those terms in @xmath9 where all four indices @xmath29 of @xmath0 are contained inside orbital subspace @xmath30 .",
    "@xmath31 is the approximation to @xmath28 within the weak coupling method used for solving the entire system , and @xmath32 the approximation or exact solution of @xmath28 obtained using the higher order method capable of describing ` strong correlation ' .",
    "since the self - energy is a functional derivative of the @xmath33-functional , the total self - energy @xmath14 contains diagrams from both the ` strong ' and ` weak ' coupling methods and can be written in a matrix form reflecting the system separation onto different correlated blocks @xmath34_{1 } & \\sigma^\\text{int } & \\dots & \\dots & \\dots\\\\         \\sigma^\\text{int }   &   [ \\sigma^\\text{a}]_{2 } & \\sigma^\\text{int } & \\dots & \\dots \\\\",
    "\\dots & \\dots &   \\dots &   \\dots & \\dots\\\\        \\dots &   \\dots & \\sigma^\\text{int } & [ \\sigma^\\text{a}]_{m } &   \\sigma^\\text{int } \\\\",
    "\\dots &   \\dots & \\dots &     \\sigma^\\text{int } & \\sigma^{r }   \\end{bmatrix }   \\end{aligned}\\ ] ] these blocks are obtained upon differentiation of the @xmath35 functional according to eq .",
    "[ eq : dphidg ] and have the following form @xmath36_{i}&=\\sigma^\\text{tot}_\\text{weak}+([\\sigma^{a}_\\text{strong}]_{i}-[\\sigma^{a}_\\text{weak}]_i),\\label{eq : seet}\\\\ \\sigma^r&=\\sigma^{r}_\\text{weak},\\\\ \\sigma^{int}&=\\sigma^{int}_\\text{weak}.\\end{aligned}\\ ] ] eq .",
    "[ eqn : sigma_seet ] describes a subspace self - energy consisting of a contribution from the strongly correlated subspace embedded into a weakly correlated self - energy generated by all orbitals outside the subspace .",
    "this embedding of the self - energy leads to the name ` self - energy embedding theory ' .",
    "seet satisfies the following limits :    * if the interaction @xmath0 is zero or the temperature is infinity , @xmath37 , the self - energy is zero and therefore the method becomes exact . * if @xmath38 and the only subspace @xmath30 includes all orbitals present in the system , @xmath39 , so that no orbitals are left in the perturbatively treated subspace , @xmath40 , then the entire system is solved using the strong correlation method and @xmath41 . consequently ,",
    "if the strong correlation method provides the exact solution , the exact solution of eq .",
    "[ eqn : realistic_ham1 ] is recovered . * in the limit of non - interacting subsystems , when the interactions between strongly correlated subspaces are zero , together with a condition @xmath40 and @xmath42 , seet recovers the solution of the system with the strong correlation method since @xmath43_i$ ] . * if the correlated subspaces are not treated exactly but using the same ` weak correlation ' method as the rest of the system , the weak correlation solution for the full system is recovered since @xmath44_i-[\\phi_\\text{weak}^a]_i\\big)$ ] .    while consideration of the exact limits is essential , the important practical question is whether ( and where ) one can expect seet to be accurate away from these exact limits . as is evident in eq .",
    "[ eq : seetphi ] , seet becomes accurate where the diagrams considered at the lower level method require no higher order corrections .",
    "this is the case in the high temperature , high energy , and high doping regimes where the self - energy is perturbative .",
    "additionally , seet is accurate if all non - perturbative correlations are restricted to the correlated subspaces , and its accuracy will therefore strongly depend on the choice of the correlated subspaces .",
    "consequently , choosing the correlated subspaces is an important step in any seet calculation .",
    "[ htb ] ) are included in the correlated subspace , any other contribution is excluded .",
    "bottom panel : selection of orbitals based on a localization criterion : sets of neighboring orbitals are chosen as the correlated subspace.,title=\"fig : \" ]    in many techniques , the ` strongly correlated ' and ` weakly correlated ' orbital subsets are chosen a priori .",
    "an example is dmft , where @xmath9 is truncated to local degrees of freedom,@xcite or lda+dmft methods@xcite where certain ` local ' orbitals ( usually orbitals with @xmath45 or @xmath46-like character ) are considered to be ` correlated ' , while ` wider ' @xmath47 and @xmath48 orbitals are considered to be non - interacting .",
    "while the same ad hoc orbital choice can be used for self - energy embedding theory , seet also offers a different approach to the selection of correlated orbitals and in particular makes an adaptive choice of correlated orbitals ` a posteriori ' possible , without the need to localize or ` downfold ' orbitals .",
    "a simple criterion for identifying the degree of orbital correlation is given by the frequency - dependence of the self - energy : the larger the frequency dependent part , the more ` non - hartree - fock ' like an orbital is , and therefore the more it needs to be treated at the ` strongly correlated ' level . since hartree - fock only yields orbital occupancies of 0 and 2 , then any partial occupancy of an orbital obtained from diagonalizing a one - body density matrix obtained using a perturbative approach ( used in the first step of seet ) indicates some degree of correlation .",
    "the larger the deviation from 0 or 2 the more `` strongly correlated '' an orbital is and the more likely it requires a non - perturbative treatment .",
    "consequently , the seet calculations in ref .   added orbitals to the strongly correlated subspace @xmath30 using a criterion based on diagonalization of the one - body density matrix : chosen were those @xmath49 orbitals with the largest deviation of the occupancy from @xmath50 and @xmath51 .",
    "this requires a basis transform of the hybridization function , non - interacting hamiltonian , and two - body integrals into the basis that diagonalizes the one - body density matrix . while basis transforms for the two - body integrals are generally expensive , the transformed integrals are only necessary inside the correlated subspace , making the transform affordable in practice , such that the orbital transformation step is not a computational bottleneck .",
    "two possible subset selection schemes are illustrated graphically in fig .",
    "[ fig : seet_separation ] .",
    "the @xmath33 functional of eq .",
    "[ eq : seetphi ] defines the seet approximation .",
    "it requires the specification of the @xmath17 correlated orbital subspaces @xmath18 and the subspace @xmath20 , in addition to the ` strong coupling ' and the perturbative weak coupling diagrams .",
    "we now describe a practical algorithm that generates such a solution self - consistently .",
    "first , the weak coupling method is used to self - consistently obtain the self - energy @xmath52 and functional @xmath27 of the entire system from a given initial green s function , _",
    "e.g. _ the hartree - fock ( hf ) or density functional theory ( dft ) solution .",
    "the self - consistency of the weakly correlated method eliminates all memory of the initial starting point in its convergence to a fixed point.upon convergence of the weakly correlated method , we choose the correlated subspaces according to sec .  [ sec : orbitalselec ] .",
    "we then compute @xmath53_i$ ] and @xmath54_i$ ] in every orbital subspace @xmath3 , _",
    "i.e. _ the weak correlation approximation obtained with vertex indices exclusively contained in the correlated orbital subsets @xmath18 .    in a next step , @xmath55_i$ ] needs to be obtained in each subspace @xmath3 . to simplify notation , we select one particular subspace @xmath56 and absorb all other subspaces @xmath57 , and the remaining weakly correlated orbitals in space @xmath20 . using the non - interacting green s function   here , where @xmath58 is the kinetic plus nuclear - electron attraction part of the hamiltonian , in general other definitions of the one - body hamiltonian are possible .",
    "one of the most commonly used definitions for realistic systems is @xmath59 , where @xmath60 is a fock matrix obtained from hf , gf2 , or gw . ] in a block form @xmath61 and the dyson equation @xmath62 we express the interacting green s function as @xmath63^{\\dagger } & ( g_0^{-1})^{r}-\\sigma^{r}\\end{pmatrix}^{-1},\\end{aligned}\\ ] ] where @xmath64 denotes the inverse of the non - interacting green s function restricted to the orbital subset @xmath30 .",
    "evaluation of @xmath65 in the subset @xmath30 yields @xmath66 where @xmath67 is defined as @xmath68^{\\dagger } \\times \\label{eq : hybfun}\\\\ \\nonumber & \\left[(g_0^{-1})^{r}-\\sigma^{r}\\right]^{-1}\\left[(g_0^{-1})^\\text{int}-\\sigma^\\text{int}\\right]\\big].\\end{aligned}\\ ] ] eq .",
    "[ eq : seetphi ] , eq .",
    "[ eq : subsetprop ] and eq .",
    "[ eq : hybfun ] show that the ` strongly correlated ' @xmath30-subspace problem can be entirely formulated in the strongly correlated subspace as a problem in which the original interactions @xmath0 have been restricted to the subspace @xmath30 , but for which the bare green s functions have been modified from @xmath15 to new propagators @xmath69 which contain a contribution from a frequency - dependent ` hybridization function ' @xmath67 .",
    "these propagators are defined as @xmath70 problems of this type are known as quantum impurity problems .",
    "a quantum impurity solver will obtain an expression for a correlated @xmath71 given @xmath67 ( eq .  [ eq : hybfun ] ) and @xmath15 ( eq .  [ eq : g0eq ] ) as well as a subset of interactions @xmath72 in either spatial or energy basis . using the impurity problem dyson equation ,",
    "the self - energy for a strongly correlated orbital subset is obtained as @xmath73_i=\\mathcal{g}_0^{-1}-((g^\\text{imp})^a)^{-1}.\\ ] ] once this strongly correlated @xmath74 is known , the total self - energy , @xmath75 , in subspace @xmath3 is evaluated as @xmath76_{i}&=\\sigma^\\text{tot}_\\text{weak}+([\\sigma^{a}_\\text{strong}]_{i}-[\\sigma^{a}_\\text{weak}]_i).\\end{aligned}\\ ] ] we note in particular that there are contributions to the @xmath30-subspace self - energy from vertices and propagators with some indices outside of subspace @xmath30 .",
    "these contributions are contained within @xmath77_i)$ ] and only treated at the perturbative level .",
    "we would like to stress that these contributions provide an effective adjustment caused by non - local interactions to the @xmath78_{i}$ ] that was evaluated using a subset of local interactions @xmath72 .    while quantum impurity models were originally formulated in the context of dilute impurities in a metal,@xcite they form the basis of many non - perturbative embedding schemes including dmft.@xcite impurity problems are numerically tractable , with accurate or numerically exact methods ranging from continuous - time quantum monte carlo@xcite to exact diagonalization @xcite , configuration - interaction @xcite , and numerical renormalization group theory @xcite methods .",
    "the requirements for seet impurity problems , _",
    "i.e. _ general ( ` non - diagonal ' ) hybridization functions @xmath67 , multiple impurity and bath orbitals , and general interactions @xmath0 currently make methods based on the configuration interaction hierarchy@xcite most suitable for this task , despite the necessity to approximate the continuous hybridization function @xmath67 by a set of discrete bath levels and bath couplings .",
    "if multiple correlated spaces are present , separate impurity problems need to be solved in each subspace @xmath18 , and correlated self - energies @xmath79_i$ ] obtained .",
    "these self - energies are then used to update each @xmath79_i$ ] block of the self - energy @xmath80 obtained with the weak coupling method according to eq .",
    "[ eqn : sigma_seet ] , and the green s function for the entire system is evaluated using the dyson equation .",
    "iteration of this procedure , alternating weak coupling steps to update @xmath81 with impurity solver steps to obtain @xmath82_i$ ] produces a converged @xmath33 and @xmath80 of the form of eq .",
    "[ eq : seetphi ] .",
    "appendix  [ app : seetalgo ] and refs .",
    "have detailed step - by - step instructions on the construction of the iterative procedure .",
    "dmft  @xcite is a @xmath9-derivable theory that can be cast as an approximation to the exact @xmath9 functional @xcite : @xmath83_j\\label{eq : phidmft}\\end{aligned}\\ ] ] where @xmath4 denotes unit cells , and @xmath84_j$ ] contains all those diagrams of @xmath9 where the interaction vertices have all four indices inside unit cell @xmath4 .",
    "all diagrams in @xmath9 connecting different unit cells , either via interactions or via propagators , are discarded . as a consequence , @xmath85 is purely local to every cell . in a translationally invariant system where all unit cells are equal , @xmath86 is independent of @xmath87 , and only one impurity problem exists . in analogy to eq .",
    "[ eq : subsetprop ] , an impurity model with @xmath88 , @xmath89 can be defined and the self - consistent solution of the dyson equation @xmath90 and the solution of the impurity problem leads to the dmft approximation of eq .",
    "[ eqn : realistic_ham1 ] .",
    "[ eq : phidmft ] shows that dmft can be understood as a special case of seet in which the orbital subspaces @xmath18 are chosen to be the orbitals local to a unit cell , the ` weak correlation ' method is skipped so that @xmath91 , and the strong - correlation problem is computed by the dmft impurity solver .",
    "correspondingly , dmft will provide a good approximation to the physics of a correlated system as long as the following two criteria are fulfilled : first , the interactions are predominantly local ; and second , self - energy contributions from non - local terms ( interactions or propagators ) are negligible .",
    "similarly , hf+dmft can be cast into this framework .",
    "the chosen correlated orbital subspaces @xmath92 are local to each unit cell , and the exact @xmath9 is approximated as @xmath93_j -   [ \\phi_\\text{hf}^i]_j\\right ) \\label{eq : phidmfthf},\\end{aligned}\\ ] ] where @xmath94_j$ ] is the hf @xmath9-functional with vertex indices restricted to unit cell @xmath4 . to obtain a self - consistent @xmath95 ,",
    "the hartree fock equations are solved for the entire system and subsequently some or all local orbitals are chosen to the correlated subspace @xmath92 .",
    "the impurity problem is then solved in the local subspace along the lines of dmft .",
    "note that all the non - local contributions to the self - energy of the unit cells that are frequency independent are generated by @xmath96 .",
    "any higher order contributions to the self - energy that are frequency dependent have purely local vertices and there are no non - local frequency dependent self - energy terms in the @xmath95 functional .",
    "additionally , in the non - empirically adjusted hf+dmft all impurity interactions remain the bare coulomb interactions @xmath97 and are local to the unit cell orbital subspaces @xmath92 .",
    "consequently , any adjustment or renormalization of the frequency dependent @xmath78_i$ ] term due to the non - local effects that is present in seet(ed - in - gf2 or ed - in - gw ) is absent in hf+dmft .",
    "this is the reason why many spectral features produced at the hf+dmft or lda+dmft level using bare local coulomb interactions without the adjusted effective interactions @xmath98 and @xmath99 are not recovered correctly .",
    "gw+dmft@xcite is based on the premise that both non - local interactions and non - local correlations are important and can not be discarded ; however , the non - local interactions can be treated perturbatively without a significant loss of accuracy .",
    "the starting point of the gw+dmft procedure is the gw approximation @xcite for which the @xmath9 functional consist of an infinite series of ` bubble ' polarization diagrams , @xmath100 , connected by bare interaction lines .",
    "this series of bubbles can be resumed into a frequency - dependent ` screened ' interaction @xmath101 , where @xmath8 is the bare coulomb interaction .",
    "the self - energy is approximated as @xmath102 , so that in the gw approximation @xmath10=-\\frac{1}{2}gwg$ ] .    as @xcite showed , it is convenient to define a functional @xmath103 , which is a functional both of the green s function @xmath11 and of the screened interaction @xmath104,@xcite as @xmath105 = \\phi - \\frac{1}{2}(pw-\\log(1+pw))\\end{aligned}\\ ] ] which satisfies @xmath106 together with the dyson equation that relates @xmath11 to @xmath14 , these expression form a closed set of equations that allow the self - consistent computation of @xmath14 and @xmath104 .",
    "we note that while these equations are @xmath9 ( and @xmath103)-derivable , and should be solved in a self - consistent manner , the size and complexity of @xmath104 as well as the difficulty in carrying out the self - consistency necessitates additional approximations  @xcite in the case of large realistic systems , which may not respect the conserving properties of hedin s approximation .",
    "notable cases where these equations have been solved self - consistently without any approximations are the electron gas,@xcite atoms and small molecules,@xcite and lattice model systems.@xcite    gw+dmft then makes use of the fact that , given @xmath104 in all orbitals , there is a natural way of defining an ` effective ' @xmath104 in a subset of orbitals:@xcite splitting the polarization into a contribution @xmath107 from the ` correlated ' orbitals and a contribution from all other orbitals , @xmath108 , one can define a screened interaction @xmath109 which does not contain any @xmath45-to-@xmath47 processes and reformulate @xmath104 as @xmath110^{-1}w_r,\\\\ w_r=[1-vp_r]^{-1}v.\\end{aligned}\\ ] ] this identity is general and independent of the gw approximation .",
    "it allows to formulate non - perturbative corrections containing contributions by orbitals exclusively in the @xmath45 -orbital subspace without any double counting . choosing as a subset of orbitals the ones that are local to the unit cell ( or , equivalently , a subset of those local to the unit cell )",
    ", it follows that@xcite    @xmath111_j-[\\psi^i_\\text{gw}(g_i , w_r)]_j\\right).\\end{aligned}\\ ] ]    this defines the gw+dmft approximation to the exact @xmath103 functional .",
    "the approximation is noteworthy because it is , as it is written , a diagrammatically sound method for solving realistic correlated many - body problems that includes renormalized interactions and non - perturbative local correlations . in practice ,",
    "numerous technical and theoretical limitations exist .",
    "a fully self - consistent solution of the gw problem is technically very challenging .",
    "the various approximations employed ( quasiparticles , no full self - consistency , etc ) at the level of gw along with the difficulty of numerically solving multi - orbital impurity problems with general non - local time - dependent interactions means that the rigorous diagrammatic footing described above is severely approximated in practical implementations of the gw+dmft method  * ? ? ? * .",
    "the methods outlined above have several important commonalities .",
    "first , they require the self - consistent solution of a @xmath9 ( or @xmath103)-derivable diagrammatic system .",
    "this implies that ( provided the equations are actually solved to self - consistency ) the important conservation laws are automatically fulfilled .",
    "they also consist of two - step procedures : an ` outer loop ' that entails the solution of a system using a ` cheap ' method ( e.g. gw , gf2 , or hf ) , and an ` inner ' loop that requires the solution of a quantum impurity problem using non - perturbative techniques . all methods become exact at infinite temperature , at zero interaction , and when the system decouples into separate impurity problems without any inter - impurity interactions .",
    "however , there are several important distinctions between these methods .",
    "the first is the choice of correlated orbital space . in dmft and its variants , correlated subspace orbitals",
    "are chosen _ a priori _ to be the local orbitals or a subset of the local orbitals .",
    "this was historically motivated by an exact limit of infinite coordination number , @xcite where the self - energy can be shown to reduce to the local form .",
    "the locality approximation can be controlled by systematically extending the size of the unit cell in the real@xcite or reciprocal space,@xcite or by introducing diagrammatic expansions in the non - local contributions.@xcite in contrast , seet uses insight from a low - order solution of the system to adaptively define the correlated subspace , _ e.g. _ via consideration of the elements of the diagonalized one - body density matrix that are different from 0 or 2 .",
    "the control parameter used to converge seet to the exact limit is the size of the correlated subspaces @xmath19 , which can be systematically increased .",
    "a second major difference between hf+dmft , gw+dmft , and seet(ed - in - gf2 or ed - in - gw ) is the way in which non - local interaction effects are treated .",
    "dmft neglects any contribution from non - local interactions to the self - energy , including contributions from non - local interactions to the local self - energy .",
    "hf+dmft evaluates the frequency - independent part of the non - local self - energy at the hf level , but any non - local frequency - dependent contribution to the self - energy is neglected , as both interactions and propagators in @xmath112 are chosen to be local .            both gw+dmft and seet(ed - in - gf2 or ed - in - gw ) include frequency - dependent non - local correlations to some extent . assuming that a local ( rather than an energy ) basis is chosen for seet ,",
    "the lowest order diagram contained in seet(ed - in - gf2 ) but not in gw+dmft is illustrated in the left panel of fig .",
    "[ fig : lowestseetnotgw ] . here , different indices are assumed to be in different unit cells .",
    "conversely , seet(ed - in - gf2 ) in a local basis would not include the diagram illustrated in the right panel of fig .",
    "[ fig : lowestseetnotgw ] .",
    "presumably dmft could be based on a technique that includes the second order exchange diagram to include the diagram in the left panel , while seet(ed - in - gw ) would include the right panel of fig .",
    "[ fig : lowestseetnotgw ] . as a commonly used basis for seet is an energy basis , rather than a local basis , a detailed comparison in the practically relevant case is not straightforward .    a third major difference consists of the selection of a basis .",
    "as dmft - type methods perform a local approximation , the choice of basis functions strongly influences the types of correlations that can be contained in dmft .",
    "in contrast , the adaptive choice of seet basis does not require a localization procedure .",
    "finally , the nature of the correlated impurity problem is rather different in seet and gw+dmft .",
    "gw+dmft , due to its construction of a screened interaction , requires impurity solvers able to evaluate problems with fully general frequency - dependent interactions .",
    "while efficient monte carlo methods exist that solve impurity problems with frequency - dependent density - density interactions,@xcite efficient impurity solvers able to treat general frequency - dependent four - fermion interactions do not yet exist .",
    "seet , on the other hand , due to the use of the @xmath9 functional , requires no frequency - dependence in the interactions .",
    "however , the rotation to the natural orbital basis in which the density matrix is diagonal usually mixes all orbitals and interactions , necessitating a treatment of the full four - fermion interaction terms ( rather than just density - density interactions ) with ` off - diagonal ' hybridization functions .",
    "non - local interactions and non - local dynamical correlations ( caused both by local and non - local interactions ) alter the local low - energy physics .",
    "a combination of these effects is colloquially summed up under the term ` screening ' , despite very different physical and diagrammatic origins . as the methods discussed above treat ` screening ' to a different extent",
    ", we briefly discuss various aspects of it .",
    "first , the ` screened interaction ' @xmath104 describes a way of re - summing certain classes of diagrams .",
    "@xmath104 then takes the role of the bare interaction @xmath8 in @xmath9 and removes diagrams with repeated insertion of polarization parts , at the cost of introducing a frequency dependence.@xcite the need for formulating perturbation theories in powers of @xmath104 is motivated by a divergence of the perturbation theory in @xmath8 , when truncated at any order , in the infinite system size ( momentum @xmath113 ) limit of the electron gas.@xcite in contrast , a perturbation theory in @xmath104 removes this divergence and stays finite.@xcite within gw and gw+dmft , as well as within seet(ed - in - gw ) , terms are included at least to lowest order in @xmath104 , and @xmath104 is approximated by the lowest order @xmath114 .    seet(ed - in - gf2 )",
    "is based on a gf2 starting point that is divergent for metallic systems in the thermodynamic limit , as it is formulated in terms of the bare @xmath8 .",
    "however , any finite system will yield a convergent answer .",
    "thus , for a finite system , in an energy basis , the identification of the correlated orbitals will add near - fermi - surface states to the correlated subspace and converge as the subspace is enlarged .",
    "a second , entirely different effect also commonly referred to as ` screening ' that leads to lowering of local bare coulomb interactions is generated by the effect of non - local interactions on the local self - energy.@xcite if the total orbital space is divided into a correlated subspace and the remainder , the correlated subspace self - energy acquires contributions due to non - local interactions with vertices and propagators in the remainder .",
    "this effect is general and present both for the frequency independent and dependent contribution to the self - energy .",
    "it is best illustrated for the frequency independent hartree - fock contribution @xmath115 that can be separated into the following contributions : @xmath116_{ij\\in a}&=&\\sum_{kl}\\gamma_{kl}(v_{ijkl}-0.5v_{ilkj})\\\\ \\nonumber & = & [ \\sigma_{\\infty}]_{ij\\in a}^\\text{embedded}+[\\sigma_{\\infty}]_{ij\\in a}^\\text{embedding},\\end{aligned}\\ ] ] @xmath116_{ij\\in a}^\\text{embedded}=\\sum_{kl \\in a}\\gamma_{kl}(v_{ijkl}-0.5v_{ilkj}),\\end{aligned}\\ ] ] @xmath116_{ij\\in a}^\\text{embedding}&= & \\sum_{kl \\in r } \\gamma_{kl } ( v_{ijkl}-0.5v_{ilkj})\\\\ \\nonumber & + & \\sum_{k \\in a}\\sum_{l \\in r}\\gamma_{kl}(v_{ijkl}-0.5v_{ilkj}).\\end{aligned}\\ ] ] here the matrix elements @xmath117_{ij\\in a}$ ] have an ` embedded ' contribution coming only from orbitals belonging to the subset @xmath30 and an ` embedding ' contribution where the summation runs over other orbitals @xmath20 that are not contained in the subset @xmath30 .",
    "a model with non - local interactions often appears to have a smaller local self - energy than the same model with only on - site interactions.@xcite similarly , a multi - orbital model where inter - orbital interactions are truncated to density - density interactions encounters its metal - to - insulator transition at a weaker interaction than one with the full interaction structure.@xcite as the dmft approximation neglects all inter - unit - cell interactions inside the correlated subspace , and as technical limitations of the impurity solvers require restriction to density - density terms , the effective dmft interactions are additionally lowered to account for these corrections .    in seet ,",
    "this method - dependent ` screening ' contribution that results in the lowering of the correlated orbital subspace self - energy is not caused by introducing effective interactions .",
    "rather , the ` embedded ' subspace self - energy @xmath82_{ij\\in a}^\\text{embedded}=[\\sigma^{a}_\\text{strong}]$ ] is evaluated using the bare coulomb interactions ( transformed to the appropriate basis ) and is ` screened ' due to the presence of the ` embedding ' self - energy , @xmath118_{ij\\in a}^\\text{embedding}=[\\sigma^\\text{tot}_\\text{weak}]_{ij\\in a}-[\\sigma^{a}_\\text{weak}]$ ] .",
    "note that the internal summations in @xmath119_{ij\\in a}$ ] extend over the orbitals that are not present in the correlated subspace , thus accounting for all the effects of the non - local interactions on the total frequency dependent subspace self - energy , @xmath82=[\\sigma^{a}]_{ij\\in a}^\\text{embedded}+[\\sigma]_{ij\\in a}^\\text{embedding}$ ] .",
    "we have discussed several diagrammatic approximations capable of describing a full coulomb hamiltonian .",
    "these approximate methods can then be used in _ ab initio _ calculations of realistic materials or molecular problems .",
    "we have paid particular attention to the functional interpretation and have shown that the dmft - type approximations , where the correlated subspace orbitals are chosen to be local to the unit cell , are a subclass of a wider class of self - energy embedding theories , which can deal with both local and non - local orbitals present in the correlated subspace .",
    "we have also shown that relaxing the locality approximation of the self - energy leads to additional freedom in choosing ` correlated ' orbitals , and introduces a systematic small parameter that can be controlled in practice .",
    "choosing the correlated orbital subspace as a set of one - body density matrix eigenvectors corresponding to eigenvalues with partial occupancy ( most different than 0 or 2 ) provides an adaptive selection procedure .",
    "while all the methods outlined here have a rigorous theoretical foundation , practical implementations of real - materials embedding calculations remain extremely difficult and the approximations needed to lower the computational cost typically break @xmath9-derivability . while some of these approximations have the potential to be removed with future increases of computational power , calculating frequency dependent renormalized interactions in gw+dmft for impurity models remains challenging .",
    "we therefore believe that embedding methods that do not rely on explicitly renormalized interactions in the correlated subspace , such as seet(ed - in - gw ) and seet(ed - in - gf2 ) , offer a promising route to the simulation of realistic materials with systematically improvable accuracy .",
    "dz and eg were supported by the simons foundation via the simons collaboration on the many - electron problem .",
    "76ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty http://www.jstor.org/stable/95222 [ * * ,   ( ) ] link:\\doibase 10.1103/physrev.140.a1133 [ * * , ( ) ] @noop _ _ ,  ed .",
    "( ,  , ) link:\\doibase    10.1103/revmodphys.68.13 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.78.865 [ * * ,   ( ) ] http://stacks.iop.org/0953-8984/9/i=35/a=010 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.57.6884 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.66.085120 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.90.086402 [ * * ,   ( ) ] `` , ''  in  link:\\doibase 10.1007/1 - 4020 - 2708 - 7_4 [ _ _ ] ,   ( ,  ,  )  pp .",
    "link:\\doibase 10.1140/epjb / e2003 - 00121 - 8 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.91.121111 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.4938562 [ * * ,   ( ) , http://dx.doi.org/10.1063/1.4938562 ] http://dx.doi.org/10.1021/acs.jctc.6b00638 [ * * ,   ( ) ] link:\\doibase 10.1103/physrev.118.1417 [ * * , ( ) ] link:\\doibase 10.1103/physrev.127.1391 [ * * , ( ) ] link:\\doibase 10.1142/s0217979299000436 [ * * ,   ( ) ] link:\\doibase 10.5488/cmp.9.3.557 [ * * ,   ( ) ] link:\\doibase 10.1103/physrev.124.287 [ * * , ( ) ] link:\\doibase 10.1103/physrev.139.a796 [ * * , ( ) ] \\doibase    http://dx.doi.org/10.1016/0003-4916(89)90359-x [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.43.8044 [ * * , ( ) ] \\doibase http://dx.doi.org/10.1063/1.1884965 [ * * ,   ( ) ,  http://dx.doi.org/10.1063/1.1884965 ] \\doibase http://dx.doi.org/10.1063/1.4884951 [ * * ,   ( ) ,  http://dx.doi.org/10.1063/1.4884951 ] \\doibase http://dx.doi.org/10.1063/1.4940900 [ * * ,   ( ) , http://dx.doi.org/10.1063/1.4940900 ] \\doibase http://dx.doi.org/10.1063/1.4921259 [ * * ,   ( ) ,  http://dx.doi.org/10.1063/1.4921259 ] link:\\doibase 10.1021/acs.jctc.5b00884 [ * * ,   ( ) ] ,   link:\\doibase    10.1021/acs.jctc.6b00178 [ * * , ( ) ] ,   \\doibase http://dx.doi.org/10.1063/1.1800733 [ * * ,   ( ) ] link:\\doibase 10.1103/physrev.124.41 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.72.035122 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.97.076405 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.74.155107 [ * * ,   ( ) ] http://stacks.iop.org/0295-5075/82/i=5/a=57003 [ * * ,   ( ) ] link:\\doibase    10.1103/revmodphys.83.349 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.72.1545 [ * * ,   ( ) ] http://stacks.iop.org/0953-8984/24/i=5/a=053201 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.86.165128 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.80.395 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.3556707 [ * * ,   ( ) ,  http://dx.doi.org/10.1063/1.3556707 ] link:\\doibase 10.1103/physrevlett.62.324 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.45.6479 [ * * , ( ) ] http://stacks.iop.org/0953-8984/28/i=38/a=383001 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.74.601 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.96.226402 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.66.195215 [ * * ,   ( ) ] link:\\doibase 10.1021/acs.jctc.6b00774 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physrevb.57.2108 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.69.195102 [ * * , ( ) ] http://stacks.iop.org/0295-5075/76/i=2/a=298 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.89.155417 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.91.235114 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.70.195104 [ * * ,   ( ) ] link:\\doibase 10.1007/bf01312686 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.62.r9283 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.87.186401 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.58.r7475 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.77.1027 [ * * ,   ( ) ] link:\\doibase 10.1143/jpsj.75.054713 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.75.045118 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.77.033101 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1016/j.aop.2012.01.002 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.94.035102 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.99.146404 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.104.146401 [ * * ,   ( ) ] https://books.google.com/books?id=xzsgz4-yymec[__ ] ,  physics of solids and liquids ( ,  ) \\doibase http://dx.doi.org/10.1063/1.4901432 [ * * ,   ( ) ,  http://dx.doi.org/10.1063/1.4901432 ] link:\\doibase 10.1103/physrevb.87.125149 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.235135 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.79.115119 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.107.256401 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.86.155107 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.114.156402 [ * * ,   ( ) ] @noop ( )",
    "the seet equations are formulated as a set of self - consistent equations that need to be solved iteratively .",
    "the iteration procedure consists of several parts : * ( i ) * the problem setup with construction of two - body interactions and one - body integrals ( hoppings ) , * ( ii ) * the solution of the entire system using a low - level , usually weak - coupling method ( gf2 , gw ) , * ( iii ) * the construction of the correlated subspace(s ) and impurity problem(s ) , * ( iv ) * the solution of the impurity problems using a high - level , usually non - perturbative , impurity solver method , and * ( v ) * the adjustment of the chemical potential to match the target particle number of the system .",
    "in1 : :    choose a basis set . in2",
    ": :    in the chosen basis evaluate @xmath58 , and @xmath8 to    represent the hamiltonian of interest . in3 : :    solve the hartree - fock or density functional theory equations to    obtain an initial bare green s function @xmath15 .",
    "ll0 : :    starting from a given @xmath15 , perform self - energy    evaluation for the total system with a low level method and obtain    @xmath52 ,    @xmath120_i$ ] ,    @xmath121 ,    @xmath122 , and    @xmath123 .",
    "ll3 : :    choose the most suitable basis for the subsystem @xmath18    that is physically motivated .",
    "it can be a energy , occupation , or a    local orbital basis . ll4",
    ": :    transform @xmath58 ,    @xmath52 ,    @xmath120_i$ ] ,    @xmath121 ,    @xmath122 , and    @xmath123 to the new basis .",
    "only a subset    of @xmath8 where all orbital indeces are belonging to subset    @xmath18 ( @xmath72 ) needs to be    transformed to the new basis .",
    "el1 : :    construct @xmath65 from eq .",
    "[ gweak ] with the    self - energy given by eq .",
    "[ eqn : sigma_seet ] .",
    "note , that in the first    iteration @xmath124_i=    [ \\sigma^\\text{a}_\\text{weak}]_i$ ] .",
    "el2 : :    if the particle number is different from the desired particle number ,    adjust the chemical potential until the desired particle number is    reached .",
    "el3 : :    find hybridization @xmath67 according to eq .  [ eq : hybfun ] .",
    "hl1 : :    define a non - interacting impurity green s function from eq .",
    "[ eqn : g0 ] .",
    "take care of possible double counting corrections .",
    "hl2 : :    evaluate @xmath124_i$ ] from    eq .",
    "[ eqn : dyson_imp ] using a high level solver .",
    "el4 : :    come back to * el1 * and use    @xmath124_i$ ] from the high level    solver .",
    "iterate until @xmath67 or the electronic energy    that can be evaluated at this point will stop to change .",
    "ll5 : :    go back to * ll0 * and use the resulting @xmath65 as    that starting green s function to perform a single update of all the    low level self - energies and return to  @xmath125 ."
  ],
  "abstract_text": [
    "<S> the cost of the exact solution of the many - electron problem is believed to be exponential in the number of degrees of freedom , necessitating approximations that are controlled and accurate but numerically tractable . in this paper </S>",
    "<S> , we show that one of these approximations , the self - energy embedding theory ( seet ) , is derivable from a universal functional and therefore implicitly satisfies conservation laws and thermodynamic consistency . </S>",
    "<S> we also show how other approximations , such as the dynamical mean field theory ( dmft ) and its combinations with many - body perturbation theory , can be understood as a special case of seet and discuss how the additional freedom present in seet can be used to obtain systematic convergence of results . </S>"
  ]
}