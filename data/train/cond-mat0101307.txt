{
  "article_text": [
    "the development of numerical methods of computing the free energy difference @xmath1 between two equilibrium states of a system , @xmath2 and @xmath3 , is a field of active research@xcite , of significant practical importance in chemistry , physics , and biology .",
    "one widely applicable method  often called _ slow growth _ or",
    "_ adiabatic switching _  utilizes a dynamical simulation during which the system evolves , maintained at a constant temperature , as an external parameter @xmath4 is slowly changed so as to drive the system from the initial to the final equilibrium state , @xmath5 .",
    "the evolution can occur as a sequence of discrete monte carlo steps , or as a time - continuous molecular dynamics trajectory .",
    "the slow growth method is often presented as a variant of _ thermodynamic integration_@xcite , with @xmath0 expressed as an integral over a continuous sequence of equilibrium states .",
    "however , slow growth can equally well be understood as the _ in silico _ exploitation of a basic result of statistical mechanics@xcite : @xmath6 which states that the external work performed on a system during a reversible , isothermal process connecting two equilibrium states , is equal to the free energy difference between them .",
    "the slow growth method amounts to simulating such a `` switching process '' numerically , then equating the work performed with the desired free energy difference .",
    "the subscript on @xmath7 emphasizes that the process carrying the system from @xmath2 to @xmath3 is reversible , hence ( in principle ) of infinite duration . during such a process",
    ", the system evolves through a continuum of equilibrium states connecting @xmath2 to @xmath3 . in practice , exact reversibility",
    "is never achieved , and one uses a finite - time simulation to estimate the free energy difference : @xmath8 where @xmath9 denotes the work performed during a simulation of duration @xmath10 .",
    "the accuracy of a slow growth computation depends on how close one is to the reversible limit ; for short switching times @xmath10 , the system can be driven far from equilibrium , resulting in a poor estimate of @xmath0 .    in recent years ,",
    "the following _ non - equilibrium work relation _ has been derived@xcite , suggesting an alternative prescription for computing @xmath0 : @xmath11 this result pertains to an _ ensemble _ of simulations of a switching process of _ arbitrary _ duration @xmath10 .",
    "the simulations are carried out independently , with initial conditions for the system sampled randomly from the canonical ensemble corresponding to the equilibrium state @xmath2 . the work @xmath12 is computed for each simulation , and the overbar on the right denotes an average over the ensemble .",
    "the factor @xmath13 is the inverse temperature of the initial equilibrium state , and also of the thermostat ( see section [ sec : review ] below ) .",
    "eq.[eq : noneq ] can be rewritten as : @xmath14 where @xmath15.\\ ] ] here , @xmath16 is the work performed during the @xmath17th of @xmath18 independent simulations",
    ". we will refer to @xmath19 as the _ exponential average _ of @xmath9 over the @xmath18 simulations ( in contrast with the ordinary average , which we will later introduce as @xmath20 ) .",
    "we stress that the non - equilibrium work relation is valid for arbitrary @xmath10 .",
    "this is perhaps surprising : even for short switching times  for which the system is driven far from equilibrium , and the work performed during a typical simulation gives a sorry estimate of the free energy difference  we can still compute @xmath0 from the set of work values @xmath21 obtained from an ensemble of simulations .    since @xmath22 as @xmath23 ( with",
    "@xmath10 fixed ) , we are led to the following large-@xmath18 approximation : @xmath24 thus , after running many simulations of a given switching process , we can estimate @xmath0 as the exponential average of the values of work performed .",
    "we will refer to this proposed method of computing free energy differences as the _ fast growth _",
    "method , to emphasize that it remains valid even for short switching times @xmath10 .",
    "the aim of this paper is a study of the fast growth method .",
    "we have performed numerous switching simulations of the insertion of a single particle into a lennard - jones fluid , at various switching times @xmath10 .",
    "we will use the results of these simulations both to present an illustration of principle , and to examine the utility of fast growth as a practical computational method .",
    "this paper is organized as follows . in section",
    "[ sec : review ] we briefly review the theoretical foundation of the fast growth method . in section [ sec : model ]",
    "we introduce our test case  the evaluation of the excess chemical potential of a lennard - jones fluid  and we present details of the computation . in section [ sec",
    ": results ] we use our numerical results to illustrate the validity of fast growth . in section [ sec : comparison ] we use the same results to compare the slow and fast growth methods , given a fixed amount of computer time .",
    "finally , in section [ sec : linresp ] we comment on the relationship between slow growth , fast growth , and a free energy formula based on the linear response approximation .",
    "here we introduce notation and briefly review the theoretical basis of the fast growth method . the emphasis will be on a presentation of the non - equilibrium work relation ( eq.[eq : noneq ] ) oriented specifically toward the numerical problem of computing free energy differences . for a more physical presentation ,",
    "see ref.@xcite .",
    "consider a system with a finite number of degrees of freedom , @xmath25 .",
    "let @xmath26 denote a point in the @xmath27-dimensional phase space of the system .",
    "next , let @xmath4 denote an externally controlled parameter ( for instance , an applied field ) , and let @xmath28 be the parameter - dependent hamiltonian which gives the internal energy of the system , in terms of its microstate @xmath26 .    now consider two equilibrium states of the system , @xmath2 and @xmath3 , defined at the same temperature , @xmath29 , but corresponding to different values of the external parameter , @xmath30 and @xmath31 .",
    "the partition function associated with state @xmath2 is given by the integral ( assumed finite ) @xmath32,\\ ] ] where @xmath33 , and @xmath34 ; and similarly for state @xmath3 .",
    "the free energy difference between the two states is then @xmath35 it is this quantity that we want to compute .",
    "next , suppose we choose a _ thermostating scheme _ , a numerical prescription for generating evolution under which our system samples the canonical ensemble associated with any equilibrium state @xmath36 .",
    "intuitively , we can view the thermostating scheme as a way of `` mocking up '' the evolution of a system in contact with a heat reservoir .",
    "this evolution might take the form of a continuous - time trajectory , or a discrete sequence of monte carlo steps .",
    "examples of such schemes include the metropolis monte carlo algorithm@xcite , langevin dynamics , the andersen thermostat@xcite , and the nos ' e - hoover thermostat@xcite .",
    "note that the thermostating scheme is itself parametrized by @xmath36 ( e.g.  the metropolis acceptance probability takes the form @xmath37 ) , and might be explicitly _ stochastic _ , relying on the generation of random numbers to produce the evolution .",
    "imagine that we now run a simulation , first sampling the initial microstate of our system from the canonical ensemble corresponding to state @xmath2 , then letting the system evolve in time under the thermostating scheme , as the value of @xmath4 is externally changed  or `` switched ''  from @xmath30 to @xmath31 , and the temperature of the thermostat is held fixed at @xmath29 . for continuous - time evolution , let @xmath10 denote the duration of the simulation ; let @xmath38 specify the ( externally imposed ) parametric time - dependence , from @xmath39 to @xmath40 ; and consider the integral @xmath41 where @xmath42 , and @xmath43 represents the evolution of the system . alternatively ,",
    "if the evolution is implemented with an explicitly discrete algorithm ( e.g.  metropolis monte carlo ) , then the corresponding quantity is @xmath44,\\ ] ] where @xmath45 is the microstate of the system and @xmath46 the value of the parameter , after @xmath47 steps ; and @xmath10 is the total number of steps in the simulation . in what follows , we will use the notation of continuous - time evolution , but the statements apply to explicitly discrete evolution as well .",
    "the quantity @xmath12 can be interpreted as the external _ work _ performed on the system over the course of the simulation.@xcite we will use this interpretation , though we warn the reader that eq.[eq : wcont ] ( or eq.[eq : wdisc ] ) is by no means an accepted , textbook definition of work , and the interpretation of @xmath12 as work may be subject to dispute .",
    "the results presented , however , do not depend on the validity of this interpretation .    the trajectory @xmath43 which emerges from our simulation ( and which in turn determines the value of @xmath12 ) depends on a string of random numbers : those involved in sampling the initial conditions , as well as those , if any , needed to generate the evolution itself .",
    "by repeating the simulation with different sets of random numbers , we obtain different _ realizations _ of the process we are simulating .",
    "we view these as representing independent samples from an infinite ensemble of all possible realizations.@xcite eq.[eq : noneq ] then states that the average value of @xmath48 over the ensemble of possible realizations is equal to @xmath49 , with @xmath0 as given by eq.[eq : dfdef ] . in other words",
    ", @xmath48 is an _ unbiased estimator _ of @xmath49 . by collecting sufficiently many samples from the ensemble of realizations ( i.e.  by repeatedly running simulations ) we can in principle compute the average of @xmath48 to the desired degree of accuracy .",
    "this is the essence of the fast growth method .    for a variety of thermostating schemes ,",
    "eq.[eq : noneq ] has been established as an exact result , valid for any finite switching time @xmath10 .",
    "precise conditions under which this result is rigorously true are presented in refs.@xcite . in particular , all four thermostating schemes mentioned earlier  metropolis , langevin , andersen , nos ' e - hoover  satisfy these conditions .",
    "note that we do not automatically gain something for nothing with the fast growth method : while it allows us to compute @xmath0 without the bother of running a very long simulation , the price paid is that many short simulations might be needed .",
    "finally , we mention that , in the limit @xmath50 , eq.[eq : noneq ] reduces to the well - known _ free energy perturbation _",
    "identity@xcite : @xmath51 where @xmath52 is the difference between the two hamiltonians , evaluated at a given microstate ; and @xmath53 denotes an average over microstates sampled from the canonical ensemble @xmath2 .",
    "to illustrate the fast growth method , we chose to compute the excess chemical potential of a three - dimensional lennard - jones fluid .",
    "this is equal to the free energy change associated with `` turning on '' the interactions between a single particle and the remainder of the fluid , at constant volume and temperature@xcite .",
    "this process can be viewed as the transfer of one particle from an ideal gas to the lennard - jones fluid ; the _ excess _ chemical potential is defined as the chemical potential of the fluid relative to that of the ideal gas . following the notation of mon and griffiths@xcite ,",
    "let @xmath54 denote the potential energy of @xmath55 identical , classical particles interacting pairwise : @xmath56 where @xmath57 is the interaction potential .",
    "now imagine a system of @xmath58 particles , and consider two hamiltonians : @xmath59 in both cases @xmath26 is the @xmath60-dimensional vector specifying the positions and momenta of all the particles .",
    "@xmath61 describes @xmath55 interacting particles , plus a `` tagged '' particle moving freely ; @xmath62 describes @xmath58 interacting particles .",
    "we take the positions @xmath63 to be confined within a cube of volume @xmath64 with periodic boundary conditions .",
    "note that the difference @xmath65 is just the interaction energy between the tagged particle and the others .    at a given temperature @xmath29 , eqs.[eq : partfndef ] and [ eq : dfdef ]",
    "define partitions functions @xmath66 and @xmath67 , and the free energy difference @xmath0 , for the hamiltonians @xmath61 and @xmath62 .",
    "this free energy difference , i.e.  the work associated with reversibly turning on the interaction @xmath68 at constant @xmath69 and @xmath29 , is the excess chemical potential : @xmath70    let us now parametrize a _",
    "family _ of hamiltonians , @xmath28 , interpolating linearly from @xmath61 to @xmath62 : @xmath71 so that @xmath72 and @xmath73 .",
    "the intermediate hamiltonians ( @xmath74 ) represent a partially interacting tagged particle .",
    "a switching simulation then proceeds as follows .",
    "we start by sampling initial conditions from the canonical ensemble corresponding to @xmath61 .",
    "we then allow the @xmath75-particle system to evolve in time under a chosen thermostating scheme , as @xmath4 is switched from 0 to 1 over a time @xmath10 , i.e.  from a non - interacting to a fully interacting tagged particle . by running either a single simulation with @xmath10 very large ( slow growth ) , or many simulations with smaller @xmath10 ( fast growth )",
    ", we can construct an estimate of @xmath76 from the value(s ) of external work , @xmath12 , performed during the simulation(s ) , using eq.[eq : slowgrowth ] or [ eq : fastgrowth ] .    at the end of section [ sec : review ] , we alluded to the fact that , in the limit @xmath50 , fast growth reduces to the free energy perturbation method of computing @xmath0 . for the particular case considered here ,",
    "this is equivalent to widom s _ particle insertion method_@xcite , which gives @xmath76 in terms of sampled values of the energy cost ( @xmath77 ) of suddenly materializing an additional particle at a randomly chosen location within the fluid .",
    "we performed switching simulations at various switching times @xmath10 .",
    "the results of these will be presented in the following section . here",
    "we describe the details and parameters of the simulations themselves .",
    "the usual lennard - jones interaction potential , for a pair of particles separated by a distance @xmath78 , is given by @xmath79,\\ ] ] where @xmath80 is the depth of the potential at its minimum , and @xmath81 is the van der waals diameter of the particle .",
    "we instead used a modified potential : @xmath82 here @xmath83 is a cutoff distance , which we took to be half the length of a side of the box : @xmath84 and the constants @xmath85 , @xmath86 , @xmath87 , and @xmath88 were chosen to preserve the continuity of @xmath57 and its derivative .",
    "we used @xmath89 rather than @xmath90 both to avoid the singularity at @xmath91 , and to impose a strict radius of interaction equal to @xmath92 .",
    "the need for the latter condition arose from our use of periodic boundary conditions , which is equivalent to an infinite lattice of identical cells : the requirement that @xmath57 vanish for @xmath93 guarantees that , given a pair of particles , each interacts only with a single image of the other .",
    "for the parameter values we have chosen , the difference between @xmath89 and @xmath90 is very small for @xmath94 .",
    "furthermore , we have found the core repulsion between particles to be sufficiently strong that two fully interacting particles will essentially never come closer than a distance @xmath95 of one another .",
    "these considerations suggest that the excess chemical potential @xmath76 which we plan to compute will differ little from that defined for the usual lennard - jones fluid . however , this issue is not particularly relevant for the central aim of this paper .    since the lennard - jones potential works especially well with inert gases , we modeled an argon fluid .",
    "the parameters associated with argon are@xcite @xmath96 we took these values to define the units of length , energy , and mass in our simulation .",
    "the units for time and temperature are then : @xmath97 and @xmath98 , respectively .",
    "henceforth , all values will be quoted in these units .",
    "we chose the _",
    "andersen thermostat_@xcite to simulate the effects of an external heat reservoir . in this scheme ,",
    "the evolution of the fluid is governed by newton s equations , supplemented by the forced thermalization of the momenta of randomly chosen particles , at regular intervals . specifically , at fixed time intervals @xmath99 ,",
    "a particle is chosen at random , and all three components of its momentum vector are replaced by _",
    "thermal _ values , sampled randomly from the maxwell - boltzmann momentum distribution at the thermostat temperature @xmath29 . to carry out the integration of newton s equations",
    ", we used the velocity - verlet algorithm@xcite .",
    "all of our simulations were run using @xmath100 untagged particles , plus one tagged particle , inside a box of sides @xmath101 , with the thermostat set at @xmath102 .    during each switching simulation ( following a relaxation interval at @xmath103 , to generate an initial equilibrium microstate ; see section [ sec : comparison ] ) , the interaction strength of the untagged particle was turned on according to the schedule : @xmath104 from @xmath105 to @xmath106 .",
    "the time step for the velocity - verlet integration was taken to be @xmath107 , and the andersen momentum thermalization was implemented at every time step : @xmath108 .",
    "we ran a varying number of simulations of the switching process , at seven different values of the switching time , from @xmath109 simulations at @xmath110 , to @xmath111 simulations at @xmath112 , keeping the total switching time devoted to each set of simulations , @xmath113 , fixed at ( approximately ) @xmath114 . for every simulation , we computed the work performed as a result of turning on the interactions between the tagged particle and the rest .",
    "we then calculated both the ordinary and exponential average of these values of work , over the simulations corresponding to each value of @xmath10 : @xmath115,\\end{aligned}\\ ] ] where @xmath16 denotes the work performed during the @xmath17th simulation of duration @xmath10 .",
    "the results are summarized in fig.[fig : principle ] .",
    "the error bars on the exponential averages ( circles ) were computed with the bootstrap method@xcite .",
    "error bars on the ordinary averages ( squares ) are not shown , but were typically the size of the squares themselves .",
    "additionally , we performed two very long simulations at @xmath116 , and used the average of these as our best estimate of the true value of @xmath0 ( defined by eq.[eq : dfdef ] ) .",
    "this is shown as the horizontal line at @xmath117 in fig.[fig : principle ] , and ",
    "judging from the difference between these two ( nearly quasi - static ) simulations  this value should be understood to have an uncertainty of @xmath118 .",
    "let us now consider the salient features of fig.[fig : principle ] , beginning with the values of @xmath20 .",
    "if we view the work performed during a single simulation , @xmath9 , to be an estimate of the free energy difference @xmath0 , then this estimate is subject to both statistical and systematic errors@xcite .",
    "the former reflect the _ spread _ in the distribution of @xmath9 values ( for a given @xmath10 ) , the latter a _ bias _ : @xmath9 tends to over - estimate @xmath0 .",
    "this bias follows rigorously from the non - equilibrium work relation@xcite , but can also be understood in terms of thermodynamic considerations@xcite ( e.g.  the second law ) , if one accepts the interpretation of @xmath12 as work . by averaging @xmath12 over infinitely many realizations ,",
    "the statistical error is removed , but the systematic error remains : @xmath119 thus , for any value of @xmath10 , the quantity @xmath120 represents the _ systematic error _ associated with using simulations of duration @xmath10 to estimate @xmath0 .",
    "as expected , this error ( approximated by @xmath121 in fig.[fig : principle ] ) is positive , but decreases as we approach the reversible limit , @xmath122 .",
    "the _ exponential average _ of @xmath9 over @xmath18 simulations of duration @xmath10 , viewed as an estimate of @xmath0 , also contains errors when @xmath18 is finite@xcite , but these are removed in the limit of infinitely many simulations : @xmath123 the values of @xmath19 shown in fig.[fig : principle ] are consistent with this statement .",
    "all of the exponential averages closely approximate ( our best estimate of ) the free energy difference , @xmath124 , illustrating the validity of the fast growth method .",
    "the histogram in fig.[fig : hist ] displays the distribution of work values for the set of simulations performed at @xmath110 .",
    "the three vertical lines show the locations of the ordinary average of the work values , @xmath125 , the exponential average , @xmath126 , and the free energy difference , @xmath127 , shown in fig.[fig : principle ] .",
    "( throughout the paper , we frequently suppress the subscript @xmath10 and/or the superscript @xmath18 . )",
    "note that @xmath128 and @xmath0 are quite close : despite values of @xmath129 ranging from @xmath130 to @xmath131 , the exponential average @xmath128 differs from @xmath0 by only @xmath132 , which is not much larger than our uncertainty in the value of @xmath0 itself !",
    "figs.[fig : principle ] and [ fig : hist ] are intended as an `` illustration of principle '' of the fast growth method , demonstrating that the value of @xmath0 can be extracted from an ensemble of finite - time switching simulations , during which the system is explicitly driven away from equilibrium .",
    "both slow and fast growth converge to the correct value of @xmath0 in the limit of infinite computational resource : @xmath122 for slow growth , @xmath23 for fast growth . in practice , of course",
    ", we can perform neither a single infinitely long simulation , nor infinitely many finite - time simulations , so it becomes interesting to pose the following question : given a _",
    "finite _ amount of computer time , which method is preferable ?",
    "we now consider this question empirically , in a manner relevant to the practical computation of free energy differences .",
    "specifically , we study how the accuracy of the predicted free energy difference depends on the choice of the switching time , @xmath10 , given a fixed amount of total computational time .",
    "imagine that we have been allotted @xmath133 units of simulation time . in this total",
    "we must include not only the time devoted to repetitions of the switching process itself , but also the time used to generate a microstate sampled from equilibrium , before the start of each process . if each switching realization is preceded by a relaxation interval of duration @xmath134 ( to generate the initial microstate ) , then the number of switching realizations possible is given by the largest integer @xmath18 satisfying the inequality : @xmath135    in the simulations described in section [ sec : results ] , for each value of @xmath10 the results were obtained from a single , long run , in which realizations of the switching process itself alternated with relaxation intervals of duration @xmath136 , during which the system evolved at fixed @xmath103 .",
    "( the final microstate at the end of a given switching simulation was taken as the seed for the following relaxation interval.@xcite the value of @xmath134 was chosen on the basis of simulations showing that correlations in our system decay to zero over @xmath137 time units . )",
    "we used these results to investigate predictions of @xmath0 for various switching times @xmath10 , given a total resource of @xmath138 time units of simulation . for each of the seven switching times",
    "considered , we generated ten predictions of @xmath0 using the data from the simulations .",
    "for instance , at @xmath139 , eq.[eq : n ] gives @xmath140 ; therefore , of the 2000 switching realizations performed at @xmath139 , we used the first 1750 to generate ten independent estimates of @xmath0 .",
    "the remaining 250 realizations were not used here .",
    "fig.[fig : comparison ] displays the results , for the various switching times .",
    "each circle represents an estimate of @xmath0 obtained from a total of ( no more than ) @xmath141 units of simulation time .",
    "the data at @xmath112 are slow growth estimates ( @xmath142 ) , whereas the remaining points make explicit use of the fast growth formula ( eq.[eq : expav ] ) .",
    "a striking feature of these results is that the accuracy of the predictions does not seem to depend drastically on @xmath10 .",
    "in other words , for the example considered in this paper , _ fast growth and slow growth yield comparably good estimates of @xmath0 for a fixed computational resource , over a wide range of switching times_.    additionally , we generated ten estimates of @xmath0 using the widom method  shown as crosses at @xmath143  again with a total of @xmath141 time units devoted to each estimate . here",
    ", however , we effectively took @xmath144 : after every time interval @xmath145 , we generated a random location for the @xmath75th particle , determined @xmath77 , and then continued with the simulation of @xmath100 mutually interacting particles .",
    "thus , @xmath146 samples of @xmath77 contributed to each of the ten widom estimates . as we made no attempt to optimize @xmath147",
    ", these results do not really represent a direct and fair comparison between fast growth and the widom method , and rather serve as an illustration of the latter .    in the asymptotic limit of large @xmath18 and large",
    "@xmath10 , crooks@xcite has shown that the size of errors in the estimate of @xmath0 depends only on @xmath113 . on the other hand ,",
    "for fast switching , the distribution of work values can become quite wide , resulting in slow convergence of @xmath19 with @xmath18 .",
    "this is a well - known problem associated with computing exponential averages ( as with the free energy perturbation method@xcite ) , which manifests itself both in large statistical errors , and  if the distribution is wide enough  as a significant bias toward over - estimation of @xmath0 .",
    "the widom data ( @xmath143 ) certainly shows these symptoms ; the somewhat wide scatter of predictions at @xmath110 is likely also evidence of this problem .",
    "we suspect that , generically , the expected error associated with fast growth decreases with increasing @xmath10 ( for fixed @xmath133 ) .",
    "if this is indeed the case , then fig.[fig : comparison ] suggests that for @xmath148 this trend is lost in the noise ; any gain in accuracy obtained by using one switching realization of duration @xmath149 rather than 175 realizations of duration @xmath150 , is likely to be smaller than the unavoidable statistical error associated with trying to compute @xmath0 with a finite resource of @xmath141 units of simulation time .",
    "the above , tentative conclusion  that for a given @xmath133 the accuracy does not depend strongly on @xmath10 , over a wide range of switching times  suggests a certain advantage of fast growth over slow growth as a practical computational tool .",
    "namely , fast growth allows for the immediate estimation of errors@xcite , both statistical and systematic . using the @xmath18 values of work obtained from different switching realizations , the statistical uncertainty in the average of @xmath48  the unbiased estimate of @xmath49 ",
    "can be ascertained in the usual way , in terms of the variance ; the resulting upper and lower bounds defining the error bar then translate immediately into lower and upper bounds on the estimate of @xmath0 itself .",
    "alternatively , one can use the bootstrap method@xcite , which is sensitive to the possibility that the exponential average might be dominated by one or a few particularly small values of work , out of the @xmath18 values obtained from the switching realizations .",
    "slow growth , by contrast , produces only a single value of work , which by itself provides no estimate of its own error !",
    "in addition to statistical errors , the fast growth estimate contains a systematic bias : for finite @xmath18 , @xmath151 tends to over - estimate @xmath0 , though to a lesser degree than @xmath152@xcite .",
    "this bias has the same origin as the `` sample - size hysteresis '' studied in the context of the free energy perturbation method , and eq.10 of ref.@xcite gives us a leading - order estimate of its size : @xmath153 here the overbar denotes an expectation value ( i.e.  the average over infinitely many attempts to estimate @xmath0 with @xmath18 values of @xmath129 , using fast growth ) , and @xmath154 is the variance in the work values .",
    "note that this bias vanishes as @xmath23 , as demanded by consistency with eq.[eq : dfwx ] .    for each of the fast growth estimates shown in fig.[fig : comparison ] ,",
    "we have estimated both the statistical uncertainty ( using the bootstrap method ) and the systematic bias ( using eq.[eq : expavsys ] ) .",
    "we found that the latter never exceeded 0.07 , and that the estimated statistical uncertainty was typically about an order of magnitude greater than the estimated bias .",
    "these conclusions are in agreement with fig.[fig : comparison ] , which visually suggests that statistical rather than systematic errors dominate our fast growth predictions .    with fast growth , the easy estimation of error bars can furthermore be harnessed to determine , `` on the fly '' , the optimal amount of computer time to devote to the estimation of @xmath0 : the user simply performs one simulation after another , updating both @xmath19 and its error bar after each simulation , and stops when the size of the error becomes satisfactorily small . with slow growth , one must estimate ahead of time how long the simulation needs to be , given the desired accuracy .",
    "our discussion so far has been implicitly oriented toward the computation of free energy differences on _ single - processor _ computers , where easy estimation of statistical errors seems to be the main advantage of fast growth over slow growth .",
    "however , on parallel machines another considerable advantage emerges : fast growth is _",
    "embarrassingly parallelizable_. given @xmath155 processors and a finite amount of dedicated run time , the user simply lets each processor perform one or more switching simulations , and at the end all the values of work are gathered and the exponential average is computed .",
    "this provides the maximal efficiency of parallelization , @xmath156 , as there is essentially no `` cross - talk '' between processors .",
    "furthermore , the additional programming effort is minimal : once a code has been written to perform switching simulations on a single processor , little more needs to be done to let @xmath155 copies of the code run independently on @xmath155 processors .",
    "by contrast , to efficiently distribute a single simulation over @xmath155 processors requires considerable programming skills and time , and the optimal parallelization scheme may well depend on details of the hardware  e.g.  are the processors divided into shared - memory clusters ? , how fast is the communication between different processors ? , etc .",
    " making it less portable .",
    "the fast growth method is particularly well - suited for beowulf - type clusters , built at relatively low cost with off - the - shelf hardware components .",
    "in such clusters , the processors typically do not share memory , and communication between them is often relatively slow .",
    "both drawbacks are avoided by any embarrassingly parallelizable method such as fast growth .",
    "the idea of computing @xmath0 from numerous values of @xmath12 is not new .",
    "indeed , it has been recognized for some time that , in the interest of having an estimate of statistical errors , several or more independent switching simulations should be carried out@xcite .    given a number of independent values of @xmath12 , the simplest imaginable approximation of @xmath0  though clearly not the best ( fig.[fig : principle ] )  is just the ordinary average of these values : @xmath157 this amounts to slow growth , with statistical errors reduced by averaging over samples . in 1991 , hermans@xcite suggested instead the following formula : @xmath158 where @xmath154 is the variance of the set of work values ( closely related results are found in wood _",
    "et al_@xcite , and  for isolated systems  in tsao _",
    "et al_@xcite ) .",
    "this result can be viewed as a fluctuation - dissipation relation , and therefore ought to be valid in the _ linear response _ regime , i.e.  when @xmath4 is switched slowly enough that the system remains near equilibrium for the duration of the process .",
    "eq.[eq : linresp ] represents a correction to eq.[eq : simplestapprox ] , aiming to compensate for the systematic error ( see section [ sec : results ] ) inherent in using @xmath12 as an estimate of @xmath0 .",
    "thus we can expect @xmath159 to give a better estimate of @xmath0 than @xmath160 , _ in the regime of validity of linear response_. using the work values obtained from the simulations described in section [ sec : results ] , we have compared  for various switching times  three estimates of @xmath0 : @xmath160 ( corresponding to slow growth , with the statistical error reduced by averaging ) , @xmath159 ( linear response ) , and @xmath161 ( fast growth ) .",
    "fig.[fig : linresp ] displays the results .",
    "as expected , there exists a near - equilibrium regime ( roughly , @xmath162 ) in which linear response does a good job of removing the systematic error inherent in using @xmath12 as an estimate of @xmath0 . for shorter times , however , linear response breaks down , as the system is driven significantly away from equilibrium .",
    "fig.[fig : linresp ] furthermore illustrates that the non - equilibrium work relation is truly a _",
    "far - from - equilibrium _",
    "result , remaining valid even outside the regime of validity of the near - equilibrium prediction ( eq.[eq : linresp ] ) .",
    "the relationship between the three estimates considered in fig.[fig : linresp ] can be understood by rewriting eq.[eq : noneq ] as follows@xcite : @xmath163 where @xmath164 is the @xmath17th cumulant of the distribution of values of @xmath129 .",
    "keeping only the first term on the right side gives us @xmath165 , whereas keeping two terms yields the linear response approximation , @xmath166 .",
    "therefore these approximations can be viewed as the first two in an expansion derived from the non - equilibrium work relation , eq.[eq : noneq ] .",
    "note that one can justify keeping only the first two terms in the cumulant expansion , by assuming a gaussian distribution of work values : since all higher ( @xmath167 ) cumulants vanish for a gaussian , eq.[eq : cumulants ] reduces to eq.[eq : linresp ] in that case .",
    "more directly ( i.e.  without resorting to a cumulant expansion ) , it is easily verified that for an assumed gaussian distribution of work values , eq.[eq : noneq ] implies a relationship between the mean and the variance of the distribution , namely @xmath168 .",
    "it is easy to argue heuristically that a gaussian distribution of work values emerges in the linear response regime , i.e.  when the switching is slow enough ( @xmath10 large enough ) to keep the system near equilibrium .",
    "namely , we can imagine that the work @xmath129 , for one simulation , becomes a sum of many independent contributions : if we break the long time interval @xmath169 into many shorter segments  each , however , longer than the correlation time associated with the dynamics of the system  then the contributions to @xmath12 from the various segments will be ( roughly ) independent . the central limit theorem ( clt )",
    "then leads us to expect that , given many realizations of this process , the distribution of work values , @xmath170 , will be approximately gaussian .",
    "however , this argument requires some care : if the spread in the values of @xmath129 is large ( @xmath171 ) , then the dominant contribution to @xmath172 comes from values in the ( lower ) _ tail _ of @xmath170 , precisely where the clt `` breaks down''@xcite .",
    "so a more careful justification invoking the clt ( to derive eq.[eq : linresp ] from eq.[eq : noneq ] ) requires also that @xmath173 be not much larger than @xmath174 .",
    "this will be satisfied for sufficiently slow switching , since @xmath175 as @xmath122 ( eq.[eq : basic ] ) .",
    "hence , the argument is ultimately justified .",
    "in this paper , we have studied the fast growth method , applying it to compute the excess chemical potential of a ( modified ) lennard - jones fluid .",
    "figs.[fig : principle ] and [ fig : hist ] illustrate the validity of the method , showing that it accurately estimates @xmath0 over a wide range of switching times , including short times for which the system is driven far from equilibrium .",
    "moreover , fig.[fig : comparison ] suggests that the accuracy of the prediction does not depend strongly on the choice of @xmath10 ( for a fixed total computational resource ) , again over a wide range of values .",
    "however , when @xmath10 is too short , then fast growth becomes susceptible to the problem of poor convergence of exponential averages , familiar to any practitioner of the free energy perturbation method ( which in the present context is the widom particle insertion method ) . finally , we have considered the relationship between fast growth and the linear response approximation .",
    "the natural question left open by our study is : how generally valid are the results which we have found empirically ?",
    "in particular , how robust is the conclusion about relative performance of slow and fast growth , i.e.  `` comparable accuracy for equal computational resource '' ? if this conclusion is indeed generally true , then it suggests certain advantages for fast growth ( easy estimation of errors , parallelizability ) .",
    "finally , it is likely that fast growth can be improved by combining it with strategies which have been studied in the context of the free energy perturbation ( eq.[eq : fep ] ) .",
    "suggestions to this end have included the overlapping distributions method@xcite , higher - order cumulant expansions@xcite , and averaging of forward and reverse processes@xcite .",
    "the authors are grateful for stimulating discussions with tanmoy bhattacharya , daan frenkel , angel garcia , jan hermans , gerhard hummer , lawrence pratt , mike warren , and robert wood , as well as scrupulous and useful commentary by an anonymous referee .",
    "this research is supported by the department of energy , under contract w-7405-eng-36 .",
    "d.a.h . furthermore acknowledges the support of the 1999 los alamos summer school program .      for a sampling of free energy methods developed during the 1990 s ,",
    "see m.watanabe and w.p.reinhardt , phys.rev.lett.*65 * , 3301 ( 1990 ) ; b.a.berg and t.neuhaus , phys.lett.b * 267 * , 249 ( 1991 ) ; b.l.holian , h.a.posch , and w.g.hoover , phys.rev.e * 47 * , 3852 ( 1993 ) ; t.c.beutler and w.f.van gunsteren , j.chem.phys.*101 * , 1417 ( 1994 ) ; x.kong and c.l.brooks iii , j.chem.phys.*105 * , 2414 ( 1996 ) ; a.d.bruce , n.b.wilding , and g.j.ackland , phys.rev.lett.*79 * , 302 ( 1997 ) ; r.j.radmer , p.a.kollman , j.comp.chem.*18 * , 902 ( 1997 ) ; m.deroning , a.antonelli , s.yip , phys.rev.lett.*83 * , 3973 ( 1999 ) ; j.r.gullingsrud , r.braun , k.schulten , j.comp.phys.*151 * , 190 ( 1999 ) ; r.h.wood _ et al _ , j.chem.phys.*110 * , 1329 ( 1999 ) ; as well as references listed below .                            in a laboratory experiment ( as opposed to a computer simulation )",
    "differences between one realization of the switching process and the next arise from differences in microscopic initial conditions sampled for both the system and the heat reservoir@xcite ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be the free energy difference between two equilibrium states of a system . </S>",
    "<S> an established method of numerically computing @xmath0 involves a single , long `` switching simulation '' , during which the system is driven reversibly from one state to the other ( _ slow growth _ , or _ adiabatic switching _ ) . </S>",
    "<S> here we study a method of obtaining the same result from numerous independent , _ </S>",
    "<S> irreversible _ simulations of much shorter duration ( _ fast growth _ ) . </S>",
    "<S> we illustrate the fast growth method , computing the excess chemical potential of a lennard - jones fluid as a test case , and we examine the performance of fast growth as a practical computational tool . </S>"
  ]
}