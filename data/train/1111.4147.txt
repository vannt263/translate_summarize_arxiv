{
  "article_text": [
    "* photon source : * entangled photon pairs , spectrally degenerate at 808 nm , were generated in a type 1 spontaneous parametric down conversion source , with a 404 nm cw laser was focused to a 40 @xmath56 m waist in a pair of crossed @xmath57 ( bismuth triborate ) non linear crystals @xcite .",
    "photons were spectrally filtered with high transmission interference filters of fwhm 3 nm , then collected into polarisation maintaining optical fibres ( pmfs ) .",
    "pmfs would normally decohere the polarisation of photons that are not aligned with the slow or fast axis of the fibre , as is the case for photons that are entangled .",
    "our fibres were cut at the midpoint and spliced together with a 90 degree twist such that the slow axis in the first length was aligned with the fast axis in the 2nd length . while this modified fibre imparts an unknown phase shift between the two polarisations , their coherence is preserved .",
    "the unknown unitary is pre - compensated with wave plates in the source .",
    "state tomography of the photon source , which drives the ecnot gate , revealed a highly entangled state with fidelity @xmath58 to the corresponding bell state @xcite . * optical circuit : * the optical circuit of fig .",
    "[ fgcirc]b was experimentally constructed using an architecture of calcite beam displacers ( bd ) , which separate the ordinary and extraordinary polarisations and can be used to form very stable jamin - lebedeff interferometers  polarisation interferometers with parallel light - paths that provide interferometric stability .",
    "the pbss and extended pbss in fig [ fgcirc ] were directly implemented with a single bd .",
    "the ecnot gate @xcite requires two non polarising @xmath59 reflectivity beam splitters ( bs in fig [ fgcirc ] ) the unitary operation of which was constructed with four bds and wave plates .",
    "the action of polarisers a1 and a2 was realised using beam stops after the first bd in the bss .",
    "the operation of the circuit is as follows :    _ stage 1 in fig .",
    "[ fgcirc]b _ : the experimental control and work registers are initialised within the ecnot gate by respectively configuring the @xmath60 and @xmath61 wave plates to output the desired states as if each of their inputs were the computational @xmath62 : @xmath60 is set to implement the hadamard and @xmath61 implements the identity operation .",
    "the ecnot gate is driven by pre - entanglement @xcite from the polarisation entangled spdc source in the state @xmath63 ( where @xmath64 denotes horizontally / vertically polarised light and u / l denotes upper / lower path ) which is then converted to path entanglement with polarisation beam splitters ( pbs ) and polarisation flips ( x ) . after combing the two double - rails on non - polarising beam splitters ( bs ) and post selecting on the cases where photons emerge in the two lower paths , the @xmath65 transition matrices of the optical elements @xmath66 combine as @xmath67 : choosing a vertical polariser for @xmath68 , a horizontal polariser for @xmath69 , the identity operation for @xmath70 , and a polarisation flip for @xmath71 , implements the cnot gate logic on the initialised states . in its general form",
    ", the ecnot gate can perform any controlled unitary operation ( by choosing appropriate optical elements for @xmath72 and @xmath71 ) , and the addition of a klm - like teleportation scheme @xcite allows the gate to work with non separable states .",
    "the polarisation modes within the control spatial mode correspond to the qubit computational states indicated by @xmath73 ; at this point the polarisation modes within the work spatial mode correspond to the @xmath62 and @xmath74 qutrit states , indicated by @xmath75 .",
    "_ stage 2 in fig .",
    "[ fgcirc]b _ : the control qubit is projected onto one of the computational states , dependent upon whether @xmath76 or @xmath77 is performed before the upper pbs .",
    "the lower pbs introduces the third mode for the work register so that the @xmath62 and @xmath78 states are polarisation encoded in the upper spatial mode of the work register ( though at this stage the @xmath78 state has zero probability amplitude , i.e. vacuum ) while the lower spatial mode contains only one polarisation and corresponds to the @xmath74 state .",
    "_ stage 3 in fig .",
    "[ fgcirc]b _ : the pcnot gate relies on photonic quantum interference tuned by the half wave plate @xmath79 which is set to @xmath80 .",
    "successful operation is heralded when one photon is present in the control modes and one photon is present in the work modes . here , further balancing loss is introduced into the @xmath43 mode .",
    "the output from @xmath43 and the usual pcnot work loss mode share the same spatial mode but different polarisations .",
    "the entangling capability of the pcnot gate was tested with a bell inequality violation ( while in situ ) recording a chsh value of @xmath81 ( violating the classical limit of 2 by @xmath82 standard deviations ) .",
    "_ stage 4 in fig .",
    "[ fgcirc]b _ : the control qubit is assigned a phase according to the projector in the first iteration , allowing implementation of the semi - classical fourier transform .",
    "the control qubit states are individually projected and provide the order finding results . at the final stage , the work qutrit plays no role in providing order finding information ( other than to herald the control qubit ) so individual computational states may be traced out in detection .",
    "the polarisations of the upper work spatial mode are not distinguished , but the remaining work mode is ; these two cases provide a useful method to confirm correct circuit operation .",
    "27 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    _ _ * * , ( ) .",
    "_ _ * * , ( ) .    _ _ ( , ) .",
    "_ _ * * , ( ) .",
    "_ _ * * , ( ) .    , , ,   _ _ * * , ( ) .",
    "_ _ * * , ( ) .",
    ", , _ _ * * , ( ) .",
    "_ _ * * , ( ) .    .",
    ", , _ _ * * , ( ) .",
    "_ _ * * , ( ) .    _ _ * * , ( ) .    ,",
    "_ _ * * , ( ) .    _ _ * * , ( )",
    ".    _ _ * * , ( ) .    , , _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .",
    "_ _ * * , ( ) .    , , _",
    "_ * * , ( ) .",
    "_ _ * * , ( ) .",
    ", , , _ _ * * , ( ) .",
    "_ _ * * , ( ) .    , , ,",
    "_ _ * * , ( ) .    ,",
    ",   _ _ * * , ( ) .",
    "we thank stephen bartlett , richard jozsa , gary mcconnell , tim ralph , terry rudolph and pete shadbolt for helpful discussions .",
    "this work was supported by the engineering and physical sciences research council ( epsrc ) , the european research council ( erc ) , phorbitech and the centre for nanoscience and quantum information ( nsqi ) .",
    "j.l.ob . acknowledges a royal society wolfson merit award .",
    "theory was developed by tl and al .",
    "theory was mapped to experimental circuit by al , tl , eml , xz , and job .",
    "experiment was performed by eml , tl , al , ra , and xz .",
    "data was analysed by al , eml , tl , xz , and job .",
    "manuscript was written by al , tl , eml , xz , and job .",
    "project was supervised by al and jlob .",
    "* standard protocol operation : * the quantum order finding circuit involves two registers : a work register and a control register . in the standard protocol , the work register performs modular arithmetic with @xmath7 qubits , enough to encode the number @xmath2 , and the @xmath0 qubit control register provides the algorithmic output , with @xmath0 bits of precision .",
    "the control register , @xmath83 , starts in a superposition over all logical states , @xmath84 .",
    "the states of the work register , @xmath85 , are then computed as a function of those in the control register @xmath86 , the coprime @xmath3 , and the number to be factored @xmath2 , @xmath87 , to produce a highly entangled state , @xmath88 .",
    "the condition @xmath89 induces a periodicity in the work register so that the logical states of the control register can be grouped into @xmath4 sets as @xmath90 ( states are not normalised here and throughout ) .",
    "crucially , the periodicity in control register states is exploited through a fourier transformation , which transforms a function with period @xmath4 into a new function with period @xmath91 . + * compiling the algorithm : * the circuit schematic shown in fig .",
    "2a is designed to perform factoring for the specific case of @xmath1 and @xmath22 .",
    "controlled unitary operations perform @xmath92 on the work register for each value of @xmath39 in the control register ; for @xmath1 and @xmath22 , the unitaries , their decompositions , and the full state evolution , can be calculated explicitly by hand and redundant elements of these unitaries are omitted ( see next section for further details ) . in the standard qubit encoding of fig .",
    "1a , the work register requires @xmath37 qubits to represent @xmath1 in binary .",
    "however , only three ( of the possible @xmath36 ) work register states are ever accessed since the function @xmath38 is a periodic repetition of @xmath93 .",
    "we implement the work register using a single qutrit , taking advantage of the further degrees of freedom available in photon path and polarisation encoding .",
    "the qutrit levels represent the active sates @xmath94 with the qutrit labels taking the @xmath95 , of these values .",
    "this replaces the @xmath37 qubits shown in fig .",
    "* unitary decomposition and algorithm operation : * the function @xmath38 is carried out on the work register through a sequence of controlled unitary transformations @xmath96 , with each unitary controlled from the ( j)th control qubit ( where @xmath97 is the final qubit , giving the most significant bit ) . with the the work register initialised in the @xmath98 state , @xmath41 should perform the mapping @xmath99 . therefore , @xmath92 is realised through a sequence of controlled permutations , and each controlled permutation may be realised with a sequence of controlled swaps . for @xmath1 and @xmath22 with two control bits , @xmath100",
    "is implemented first , followed by @xmath101 .",
    "it is shown in fig .",
    "2a that , since the standard work register starts in the state @xmath78 , only the mapping @xmath102 from @xmath40 is required ; with our relabelling for the work qutrit , the work register initialised as @xmath62 should be mapped to @xmath74 , which is realised with a cnot gate acting on a qubit subspace of the qutrit : @xmath103 .",
    "@xmath41 may be performed with two swaps : @xmath104 followed by @xmath105 .",
    "the first of these swaps is implemented as a cnot , while an uncontrolled swap , equivalent to a relabelling of two modes of the qutrit , is sufficient for the second ( see below for further details ) .",
    "the ( still unnormalised ) state of the qubit - qutrit system shown in fig .",
    "2a before the first projection is @xmath106 , so that selecting either the identity operation @xmath76 or the bit flip @xmath77 before the polariser @xmath107 post selects on to the first or second term respectively . ideally , there is an equal probability of observing @xmath62 or @xmath78 in the control register , which corresponds to the least significant digit in the final output . with @xmath62 post selected in the control register , the state after the second cnot is @xmath108",
    "; the state after the subsequent action of a controlled swap @xmath109 on work register modes @xmath10 and @xmath45 is found to be equivalent to that after an uncontrolled swap @xmath110 on the same modes : @xmath111 . when the first qubit is projected onto @xmath62 , the second qubit component of the fourier transform",
    "is applied by the identity operation @xmath76 followed by the hadamard so that the final state is @xmath112 .",
    "the crucial role of quantum interference in the fourier transform can now be seen : the probability of observing the @xmath10 term in the control register is boosted by constructive interference and is three times that of the probability of observing the @xmath48 term , which suffers destructive interference ; these terms are the digits @xmath31 and @xmath32 in the final probability distribution .",
    "therefore , contrast between these terms degrades with decoherence in the fourier transform .",
    "when the first control qubit has been projected onto @xmath78 , the state after the second cnot is @xmath113 .",
    "the subsequent action of a controlled swap is equivalent to that of an uncontrolled swap up to a phase flip on terms with a @xmath48 in the control register : @xmath114 .",
    "the phase flip is undone at the second qubit component the fourier transform by applying @xmath115 rather than @xmath116 so that the final state is @xmath117 . here",
    ", the fourier transform imparts phases such that there is an equal probability of observing @xmath10 or @xmath48 in the control register .",
    "these terms are the digits @xmath33 and @xmath34 in the final probability distribution ."
  ],
  "abstract_text": [
    "<S> quantum computational algorithms exploit quantum mechanics to solve problems exponentially faster than the best classical algorithms @xcite . </S>",
    "<S> shor s quantum algorithm @xcite for fast number factoring is a key example and the prime motivator in the international effort to realise a quantum computer @xcite . </S>",
    "<S> however , due to the substantial resource requirement , to date , there have been only four small - scale demonstrations @xcite . </S>",
    "<S> here we address this resource demand and demonstrate a scalable version of shor s algorithm in which the @xmath0 qubit control register is replaced by a single qubit that is recycled @xmath0 times : the total number of qubits is one third of that required in the standard protocol @xcite . encoding </S>",
    "<S> the work register in higher - dimensional states , we implement a two - photon compiled algorithm to factor @xmath1 . </S>",
    "<S> the algorithmic output is distinguishable from noise , in contrast to previous demonstrations . </S>",
    "<S> these results point to larger - scale implementations of shor s algorithm by harnessing scalable resource reductions applicable to all physical architectures .    </S>",
    "<S> shor s factoring algorithm consists of a quantum order finding algorithm , preceded and succeeded by various classical routines . </S>",
    "<S> while the classical tasks are known to be efficient on a classical computer , order finding is understood to be intractable classically . </S>",
    "<S> however , it is known that this part of the algorithm can be performed efficiently on a quantum computer . to determine the prime factors of an odd integer @xmath2 , </S>",
    "<S> one chooses a co - prime of @xmath2 , @xmath3 . </S>",
    "<S> the order @xmath4 relates @xmath3 to @xmath2 according to @xmath5 , and can be used to obtain the factors , given by the greatest common divisor @xmath6 .        </S>",
    "<S> the quantum order finding circuit involves two registers : a work register and a control register . in the standard protocol , </S>",
    "<S> the work register performs modular arithmetic with @xmath7 qubits , enough to encode the number @xmath2 , and the @xmath0 qubit control register provides the algorithmic output , with @xmath0 bits of precision .    </S>",
    "<S> measuring the control register in the computational basis will yield a result of @xmath8 where @xmath9 is an integer between @xmath10 and @xmath11 , with the value of @xmath9 occurring probabilistically . dividing the result by @xmath12 </S>",
    "<S> gives the first @xmath0 bits of @xmath13 and @xmath4 may be found with classical processing , using the continued fraction algorithm . for large @xmath0 , and a perfectly functioning circuit , </S>",
    "<S> the output probability distribution of the control register is a series of well defined peaks at values of @xmath8 ( fig .  </S>",
    "<S> [ fgtheory]b ) . </S>",
    "<S> ( see _ appendix _ for details . )    here we implement an iterative version of the order finding algorithm @xcite , in which the control register contains only a single qubit which is recycled @xmath0 times , using a sequence of measurement and feed - forward operations , with each step providing an additional bit of precision ( fig .  </S>",
    "<S> [ fgtheory]a ) . reducing the number of qubits in quantum simulations and quantum chemistry has been achieved with recursive phase estimation @xcite , while ground state projections have been demonstrated by exploiting similar techniques in nmr @xcite .    the iterative version of the order finding algorithm , displayed in fig .  [ fgtheory]a , </S>",
    "<S> is closely related to the semi - classical picture of the quantum fourier transform @xcite . rather than performing a fourier transformation across all control register qubits simultaneously , it is sufficient to measure the coherence between computational basis states of individual qubits in the control register ( from least significant bit to greatest significant bit ) deciding on the phase coherence of the next measurement depending on the previous result . </S>",
    "<S> in fact , the control register need not contain more than one qubit at any one time . </S>",
    "<S> this register begins in a product state and all unitaries controlled from the ( i)th control qubit are performed before those controlled from the ( i+1)th control qubit . </S>",
    "<S> this means that all operations on the ( i)th qubit can be performed before the ( i+1)th qubit is initialised and a single control qubit can be re - used , or recycled , with the state of the work register iteratively updated at each stage .    to guarantee a good level of precision in @xmath14 , </S>",
    "<S> a full scale implementation of shor s algorithm requires @xmath0 to be @xmath15 . </S>",
    "<S> so for full scale implementations , qubit recycling reduces the total number of qubits required from @xmath16 to @xmath17 ; the only penalty is a polynomial increase in computation time , while the exponential speedup is retained_i.e . </S>",
    "<S> _  it is scalable . in general , saving in qubits can be more than @xmath18 if more control qubits are required , or less than @xmath18 in smaller proof of principle demonstrations such as this .    as the number of control qubits , or iterations , @xmath0 is reduced , in general , the precision is reduced and the @xmath9 peaks in the probability distribution become smeared , as shown in fig .  </S>",
    "<S> [ fgtheory]b . </S>",
    "<S> however , in the special case where the order is a power of two and @xmath19 , the peaks correspond exactly to the logical states of @xmath20 qubits @xcite such that the output is equivalent to that of an incoherent mixture of @xmath20 qubits ( any additional control qubits remain unentangled throughout the algorithm and simply encode the trailing zeros in the uniform distribution ) . </S>",
    "<S> factoring @xmath21 gives either order 2 or order 4 for each of its co - primes @xcite ; independent verification of entanglement is therefore required @xcite . </S>",
    "<S> for this reason we focus on @xmath1 with the co - prime @xmath22 to give order @xcite @xmath23 .    to two bits of precision </S>",
    "<S> the expected outcomes @xmath24 , @xmath25 , @xmath26 and @xmath27 occur with probabilities @xmath28 , @xmath29 , @xmath30 and @xmath29 , respectively ( fig [ fgtheory]b ) . </S>",
    "<S> quantum interference in the fourier transform is constructive for states contributing to the @xmath31 term and boosts its probability of observation to three times that of the probability for observing the @xmath32 term , which experiences destructive quantum interference among its contributory states . </S>",
    "<S> decoherence in the fourier transform would degrade the contrast between these terms . for states contributing to the @xmath33 and @xmath34 terms </S>",
    "<S> , the fourier transform imparts phases to equalise the probability of observing these outcomes . </S>",
    "<S> therefore , the underlying periodic structure apparent in the two qubit probability distribution is susceptible to decoherence , and therefore distinguishable from noise ( see _ appendix _ for details ) .    </S>",
    "<S> we implement a scalable iterative quantum algorithm with a compiled version of the quantum order finding routine where the circuit is constructed for a particular factoring case ( here @xmath1 and @xmath22 ) admitting an experimentally tractable implementation , as shown in fig .  </S>",
    "<S> [ fgcirc]a . </S>",
    "<S> there are several steps to compilations , common to previous demonstrations @xcite . </S>",
    "<S> firstly , for @xmath1 and @xmath22 , unitaries and their decompositions can be calculated explicitly , as can the full state evolution ; secondly , redundant elements of these unitaries are omitted . finally , and specific to our own demonstration , since only @xmath35 of the possible @xmath36 levels of the conventional @xmath37 qubit work register are ever accessed , a single qutrit is used for the work register , instead of @xmath37 qubits , to realise a hybrid qubit - qutrit system @xcite . </S>",
    "<S> ( see _ appendix _ for details ) .        </S>",
    "<S> the controlled unitaries that apply the function @xmath38 ( where @xmath39 is a control register computational basis state ) to the work register may be realised with a sequence of controlled swaps . for our two qubit control </S>",
    "<S> register , the single swap of @xmath40 is implemented with a controlled - not ( cnot ) gate ; @xmath41 is realised with two swaps , the first of which is a cnot gate , while it is sufficient for the second swap to be uncontrolled . </S>",
    "<S> ( see _ appendix _ for details ) .    </S>",
    "<S> our scheme therefore requires two consecutive photonic cnot gates  something that has not previously been demonstrated  acting on qubit subspaces of the qutrit . in our experimental implementation </S>",
    "<S> we use the iterative approach with post - selection in place of measurement and feed - forward ; measurement and feed - forward operations have been achieved in the context of cluster state quantum computing with photons @xcite . the quantum order finding circuit of fig .  </S>",
    "<S> [ fgcirc]a was experimentally constructed using the optical circuit shown schematically in fig .  </S>",
    "<S> [ fgcirc]b . </S>",
    "<S> realising two consecutive cnot gates on two photons was achieved by using an entanglement driven cnot gate ( ecnot ) @xcite , followed by a post - selected cnot gate ( pcnot ) @xcite ( pcnot gates can not be used in series without the addition of ancilla photons ) . </S>",
    "<S> the circuit was constructed with jamin - lebedeff polarisation interferometers in a calcite beam displacer architecture , chosen to provide interferometric stability . </S>",
    "<S> photons were generated with a polarisation entangled spontaneous parametric down conversion source@xcite ( see _ methods _ for further experimental details ) .    </S>",
    "<S> the correct algorithmic output from the quantum order finding circuit for factoring @xmath1 is confirmed by the data shown in fig .  </S>",
    "<S> [ fgres]a . </S>",
    "<S> the two - qubit control register output probabilities for @xmath24 , @xmath25 , @xmath26 and @xmath27 were measured and found to have a fidelity of @xmath42 @xcite with the ideal probabilities @xmath28 , @xmath29 , @xmath30 and @xmath29 , respectively . the distribution on the first qubit , which determines the second bit in the total probability distribution , was measured by comparing total control register counts , heralded by the @xmath43 detector , for each setting of the first qubit projector ( stage ( 2 ) of the circuit in fig .  [ fgcirc]b ) and found to be uniform with fidelity @xmath44 ( fig .  </S>",
    "<S> [ fgres]b ) .    since the non - uniformity of the distribution of fig .  </S>",
    "<S> [ fgres]a arises from the second iteration of the algorithm when the first iteration gives output zero , we now focus on this case . </S>",
    "<S> analysis of the circuit and algorithm reveal a critical dependence on decoherence , particularly in the pcnot and the fourier transform phase : phase instability drives the output toward a uniform probability distribution . </S>",
    "<S> we confirmed this analysis experimentally , as described below .        with stage @xmath45 of the circuit set so that the first qubit is projected onto the computational zero state , figs .  </S>",
    "<S> [ fgres]c and [ fgres]d show @xmath46 probability distributions for the correct phase setting ( _ i.e. _  0 ) to implement the semiclassical fourier transform , and 15 incorrect settings of this phase @xcite . </S>",
    "<S> when heralded by @xmath47 , the detector that does not distinguish between the @xmath10 and @xmath48 states of the work qutrit , the control qubit should be in a maximal mixture and therefore insensitive to this phase_i.e . </S>",
    "<S> _  give a flat line response . </S>",
    "<S> in contrast , since mode @xmath45 of the qutrit is not involved in the final cnot gate , the control qubit is not entangled with it . </S>",
    "<S> therefore , when heralded by the work qutrit being in the @xmath45 state , the control photon should be in a pure state and should exhibit maximum sensitivity to the phase in the fourier transform_i.e . </S>",
    "<S> _  a unit visibility fringe . taking into account the relative probability amplitudes in the ideal output state , </S>",
    "<S> the ideal plot of probability distributions would show two sinusoidal curves of full visibility ( from detectors @xmath49 and @xmath50 ) each bisected by a flat line ( from detectors @xmath51 and @xmath52 ) . </S>",
    "<S> for the @xmath53 probability distributions between two settings of the fourier transform phase , @xmath10 and @xmath54 ( indicated by black vertical lines ) we find an average fidelity between this situation and our data of @xmath55 .    the data in figs .  </S>",
    "<S> [ fgres]c and [ fgres]d can be used to show the sensitivity of the circuit to decoherence : integrating the probability distribution over the range 0 to @xmath54 of the fourier transform phase simulates the effect of phase instability . </S>",
    "<S> the red distribution plotted in fig . </S>",
    "<S> [ fgres]e shows the near uniform distribution that results from this procedure , confirming susceptibility of this circuit to decoherence . </S>"
  ]
}