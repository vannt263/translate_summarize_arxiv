{
  "article_text": [
    "firewalls are the cornerstones of corporate intranet security .",
    "once a firewall is acquired , a firewall administrator has to configure and manage it to realize an appropriate security policy for the particular needs of the company .",
    "this is a crucial task ; quoting @xcite : `` the single most important factor of your firewall s security is how you configure it '' .",
    "it is generally accepted among network security experts that corporate firewalls are poorly configured .",
    "anecdotal evidence of this sentiment can be found in such mailing lists as the firewall wizards list @xcite .",
    "furthermore , the poor state of firewall configuration can be observed , indirectly , by the success of worms and viruses like blaster  @xcite and saphire  @xcite , which could have been easily blocked by a well configured firewall .",
    "this state of affairs was validated in a 2004 study @xcite , which for the first time provided a quantitative evaluation of the quality of corporate firewall configurations collected in 2001 .    however , firewall vendors regularly release new software versions for their products .",
    "in addition , the attention that is paid to firewall rule - set quality has increased , due to regulations such as the sarbanes - oxley act @xcite and the cobit framework @xcite ; the payment - card industry data security standard ( pci dss ) @xcite ; and the nist standard 800 - 41 @xcite .",
    "all these relatively new regulations include specific sections dealing with firewall configuration , management , and audit .",
    "thus , one may hypothesize , or hope , that the quality of corporate firewall configurations has improved over time .",
    "the goal of this work is to test this hypothesis , and to check whether the findings of @xcite are still valid .",
    "the data for the @xcite study was collected in 2001 , and clearly much has happened in the network security arena in later years .",
    "therefore , one may challenge the validity of @xcite claiming ( or hoping ) that the situation has improved over time .",
    "moreover , @xcite was fairly small in scope , covering only  37 rule - sets , all from check point firewalls , and considering only  12 possible errors , 8  of which were specific to check point firewall-1 .",
    "one could argue that the sample in @xcite was not indicative , and that the detected problems were specific only to that vendor .    to address these possible critiques",
    ", the current study has the following features : ( 1 ) it is based on newer configuration data , collected from firewalls running later firewall versions ; ( 2 ) it is significantly larger , covering more than twice as many rule - sets as @xcite ; ( 3 ) for the first time , this study includes rule - sets from _ two _ leading firewall vendors : check point firewall-1  ( cf.@xcite ) and cisco pix  ( cf .",
    "@xcite ) ; and ( 4 ) this study considers three times as many configuration errors , consisting of  36 vendor - neutral items instead of the  12 used in @xcite .",
    "the rule - sets were obtained from a variety of corporations that used the algosec firewall analyzer between 20032005 @xcite .",
    "note that corporate firewall rule - sets are considered to be highly sensitive , and were provided under non - disclosure agreements that limit or delay our ability to discuss them publicly .",
    "hence , publishing quantified statistics about these rule - sets may be viewed a contribution in itself .",
    "an important contribution of this work is the identification and selection of the  36 vendor - neutral firewall configuration errors to search for . in principle",
    ", errors should be defined in terms of each corporation s network security policy . however , our stance is that of an external auditor , and we do not really know these policies . therefore , the selected errors are all clear violations of well established practices and guidelines ( cf .",
    "@xcite , @xcite , @xcite ) .",
    "the study s first finding is that serious errors are still alarmingly frequent : for instance , the infamous microsoft services , that are a vector to numerous internet worms ( cf .",
    "@xcite ) , are allowed to _ enter _ organiztions networks from the outside in 42% of the surveyed firewalls . the most frequent error ( allowing outbound smtp from over 256 ip addresses )",
    "occured in over 80% of the surveyed firewalls .",
    "moreover , since we only consider violations of `` best practices '' and do not attempt to understand each network s semantics , the findings should be viewed as a rough baseline : the protection offered by the firewalls we surveyed may well be worse than suggested by this work .",
    "one of the findings of @xcite was that check point firewalls  with versions 4.1 or later had slightly fewer configuration errors than those with earlier software versions .",
    "in contrast , the current study does _ not _ show this effect  neither for check point firewalls  nor for cisco pix firewalls .",
    "the data shows that the distribution of the number of configuration errors is essentially independent of the firewall software version .",
    "probably the most important finding of @xcite was that rule - set complexity was positively correlated with the number of detected errors  and for this purpose @xcite defined a rule - set complexity measure denoted by @xmath1 .",
    "unfortunately , the @xmath1  measure is not suitable for cisco pix firewalls .",
    "therefore , in order to compare the complexity of configurations by two different vendors , this work introduces a novel complexity measure , called the _ firewall complexity _ ( @xmath0 ) , that applies to both types of firewalls , and should be suitable to other firewall vendors configuration languages as well .",
    "a key feature of the @xmath0  measure is that it produces comparable values between check point firewall-1  and cisco pix .",
    "furthermore , the @xmath0  values are comparable to the older @xmath1  values on check point firewall-1 .",
    "what we shall see is that a rule - set s complexity , as measured by the new @xmath0  measure , is ( still ) positively correlated with the number of detected configuration errors .",
    "these findings hold for rule - sets from both vendors . thus we validate and strengthen the finding of @xcite , that , for well - configured firewalls , `` small is ( still ) beautiful '' .",
    "the study also allows a preliminary investigation on whether the choice of vendor had an impact on the quality of the configuration .",
    "one finding is that check point firewall-1  configurations tend to be more complex than cisco pix firewalls .",
    "another finding is that in general cisco pix firewalls  have somewhat fewer errors than check point firewalls  of comparable @xmath0  complexity .",
    "however , the larger cisco pix firewalls  are essentially as poorly configured as the worst check point firewalls .",
    "* organization : * the next section describes the data collection , provides some basic statistics of the data , indicates some caveats in the methodology , and describes the new @xmath0  measure .",
    "section  [ sec : errors ] describes the selection criteria for the configuration errors used in this study .",
    "section  [ sec : analysis ] analyzes the data , describes the detected error frequencies , discusses the effects of the firewall s software version and rule - set complexity , and also compares the relative complexity and number of errors between the two vendors .",
    "we conclude in section  [ sec : conc ] .",
    "appendix  [ sec : list - of - errors ] includes the full list of possible configuration errors that were used .",
    "the data for this work includes 54 check point firewall-1  rule - sets that were collected between 20032005 .",
    "the rule - sets came from a variety of organizations , from the telecommunications , financial , energy , media , automotive , and healthcare market segments .",
    "some basic statistics of the rule - sets are shown in table  [ tbl : ckpstats ] .",
    ".statistical properties of the collected check point firewall-1  rule - sets .",
    "# rules counts the total number of rules in the rule - set ( including nat rules ) .",
    "# objects counts the number of network objects ( hosts , subnets , and groups of these ) defined in the database supporting the rules .",
    "# interfaces counts the number of network interface cards on the firewall . [",
    "cols=\"<,^,^,^\",options=\"header \" , ]        4.4 & 5.05.2 & 6.06.2 & 6.37.0 + 3 ( 10% ) & 7 ( 23.3% ) & 11 ( 36.7% ) & 9 ( 30% ) +      the data for this work also includes 30 cisco pix  rule - sets that were collected between 20032005 . some basic statistics of the rule - sets are shown in table  [ tbl : pixstats ] .",
    "the collected rule - sets include files from cisco pix  versions 4.47.0 .",
    "since there were very few rule - sets from version 7.0 i grouped the rule - sets into four categories : 4.4 , 5.05.2 , 6.06.2 , and 6.37.0 .",
    "table  [ tbl : pixver ] shows the distribution of rule - sets into versions .",
    "see section  [ sec : fwver ] for a discussion .",
    "when we consider the significance of the findings , we have to bear in mind several caveats .",
    "the current study includes a total of 84 rule - sets .",
    "this is more than double the sample of @xcite , but still a very small sample  the number of operational firewalls in the world is estimated to be hundreds of thousands .",
    "furthermore , these rule - sets were not selected randomly : they were provided by organizations that wanted to perform an audit of their firewall rule - set , and were willing to purchase software for this purpose .",
    "ancdotal evidence suggests that , in some cases , these organizations felt their firewall rule - sets were too complex to manage effectively without better software systems .",
    "therefore , our sample may be biased toward complex , badly configured , firewalls .    in defense ,",
    "i claim that the arguments of @xcite are still valid : the findings agree with the experience of many colleagues in the network security industry , and the poor state of firewall configuration can be observed , indirectly , by the huge proliferation of network worms like blaster  @xcite and saphire  @xcite that could have been easily blocked by a well configured firewall .    finally , obtaining and reporting on _ any _ number of real rule - sets from operational firewalls",
    "is extremely rare : these are considered to be highly sensitive files .",
    "so there is significant value in analyzing the data that _ can _ be obtained .",
    "one of the discoveries of @xcite was that more complex rule - sets have more errors in them . to make such statements precise ,",
    "in @xcite i introduced a measure of complexity defined as @xmath2 where # rules is the raw number of rules in the rule - set , # objects is the number of network objects , and # interfaces is the number of interfaces on the firewall .",
    "i believe that the @xmath1  measure was quite successful in capturing the essence of rule - set complexity . however , for this study i realized that i needed to improve upon it , for two reasons .",
    "first , i found that @xmath1  was not suitable for cisco pix firewalls , and second , i found that @xmath1  did nt discriminate between more and less complex rule - sets as well as i initially hoped .      in order to compare the complexities of cisco pix firewalls  to those of check point firewalls  i needed a measure that produced comparable values for the two vendors .",
    "however , i realized that @xmath1  can not be applied to cisco pix , since cisco pix  and check point firewall-1  are configured differently ( see @xcite for details ) . for the purpose of measuring complexity ,",
    "the most important differences are :    1 .",
    "a cisco pix  configuration includes a separate set of rules ( called an access - list ) for each _ interface _ , whereas a check point firewall-1  has a single set of rules that applies to all the interfaces  making # rules incomparable .",
    "cisco pix  configurations do not have a separate object database , and up to version 6.0 , cisco pix  configurations did not even allow the definition of non - trivial objects , such as objects containing anything other than a single subnet .",
    "thus # objects is ill - defined for cisco pix firewalls .      beyond the immediate need for a measure that is suitable for cisco pix firewalls",
    ", i realized that @xmath1  could be improved upon for check point firewalls  as well .",
    "specifically , i felt that @xmath1  did nt give enough weight to the number of interfaces : as table  [ tbl : ckpstats ] shows , none of the surveyed check point firewalls  has more than  18 interfaces ( the median number was 4 ) , yet it is not uncommon to find check point firewalls  with hundreds of rules and thousands of objects . since # interfaces is only _ added _ to the @xmath1 , albeit quadratically , its contribution is often dwarfed by the two other terms . for instance",
    ", i felt that a firewall with 12 interfaces is _ much _ more complex than one with 3  interfaces with the same numbers of rules and objects  and this intuition is not well captured by the old @xmath1  measure since the growth in the number of interfaces only contributes an extra @xmath3 points to the @xmath1  of the more complex firewall .",
    "for all these reasons i decided to design a new measure of complexity . to differentiate the new measure from the old i call the new measure the _ firewall complexity _ , denoted @xmath0 . of course , this new measure still had to be objective , intuitive , and simple to compute .    for cisco pix firewalls ,",
    "the simplest measure of complexity , and one which is often used in discussions with cisco pix  administrators , is the number of lines in the configuration file .",
    "this was my first attempt to pick a new measure of complexity .",
    "however , i found the raw number of lines to be slightly misleading , especially for very small configurations .",
    "this is because even the smallest cisco pix  configuration file includes a few tens of `` boilerplate '' lines that have little to do with traffic filtering . to compensate for this , i chose to use the following definition",
    ".    let # lines denote the number of lines in the ascii file containing the complete cisco pix  configuration file .",
    "then the _ firewall complexity _ of a cisco pix  firewall is : @xmath4    to define a comparable measure for check point firewalls , i tried to capture the results of an imaginary over - simplified `` check point - to - pix converter '' .",
    "such a convertor would need to replicate the single check point firewall-1rule - set and place a copy on each cisco pix  interface .",
    "therefore , for the @xmath0  measure i chose to _ multiply _ the number of rules by the number of interfaces .",
    "however , object definitions in ( newer versions of ) cisco pix  are global ( not per - interface ) , so @xmath0  only needs to _ add _ add the number of check point firewall-1  objects , once .",
    "these choices have the nice side - effect of giving much more weight to the number of interfaces than the old @xmath1  did , thereby addressing a shortcoming of the @xmath1  measure .",
    "thus , we arrive at the following definition .",
    "let # rules denote the raw number of rules in the check point firewall-1  rule - set , let # objects denote the number of network objects , and let # interfaces denote the number of interfaces on the firewall .",
    "then the _ firewall complexity _ of a check point firewall-1  firewall is : @xmath5    figure  [ fig : complexity - brand ] shows the distribution of the rule - set complexity as measured by @xmath0  over the surveyed check point firewall-1  and cisco pix  firewalls . while the precise value assigned by the new @xmath0  to a check point firewall-1  rule - set differs from the value computed by the old @xmath1  for the same rule - set , the figure shows that the genaral range of values remains the same : 1010,000 . but more importatly",
    ", the @xmath0  values assigned to cisco pix  rule - sets fall into the same range as well .",
    "the figure also shows that check point firewall-1  firewalls typically have a higher complexity : the median @xmath0  value for check point firewalls  is 1117 versus 315 for cisco pix  ( note that the y - axis is log - scaled ) .",
    "my interpretation is that this is a real finding rather than an artifact of the @xmath0  metric : from inspecting the configuration data directly , it seems to me that indeed check point firewall-1  configurations tend to be more complex .",
    "in @xcite i considered twelve configuration errors .",
    "however , eight of those errors were specific to check point firewalls , which makes them unsuitable in a multi - vendor study",
    ". therefore , in this study i used a different list of errors .",
    "the current list is much larger list , consisting of 36 errors .",
    "all the errors are vendor - neutral and create a risk to the network behind the firewall .",
    "the full list of errors appears in appendix  [ sec : list - of - errors ] .    as in @xcite",
    ", i took the stance of an external auditor .",
    "thus , the errors i counted are all violations of well established practices and guidelines ( cf .",
    "@xcite , @xcite , @xcite ) , that are independent of each organization s specific requirements and policies .",
    "as such , the findings should be viewed as a rough baseline : the protection offered by the surveyed firewalls may well be worse than suggested by this work .",
    "note that a single badly written rule may trigger multiple counted errors , since some errors contain other , more specific , errors .",
    "for instance , allowing telnet ( tcp on port 23 ) is a special case of allowing `` all tcp ports '' , which in turn is a special case of allowing `` any service '' . to avoid inflating the error counts because of this containment phenomenon ,",
    "a more specific error was only counted if it was triggered by some rule that does not trigger a more general error . continuing the previous example , a rule - set",
    "_ can _ trigger both the `` any service '' and the `` all tcp '' errors  but only if the configuration includes two separate rules , one allowing any service , and the other allowing all tcp ports .",
    "one may argue that not all the configuration errors in the list are equally severe : for instance , some services have a poorer security history than others ; also having all 65536 tcp ports open is probably more risky than having just the telnet port open .",
    "however , in order to arrive at a single , easy to understand , number , i did not take such fine - grain considerations into account .",
    "the simplicity of counting each error type once allowed me to avoid introducing severity levels , and let me side - step the question `` how many medium risk errors is one high risk error worth ? '' .",
    "furthermore , one may argue that a configuration with ten rules allowing any service is riskier than a configuration with just one such rule .",
    "my opinion is that the number of erroneous rules is a good measure for the level of effort that the firewall administator would need to spend _ fixing _ the configuration , but less indicative of the amount of _ risk _ : if an attacker can enter the network , then the network is at risk  and it is less important if the attacker has one or ten firewall rules that allow him in .",
    "therefore , again in the interest of simplicity , i ignored the number of rules contributing to each error , and opted for boolean indicators for each error .",
    "the counted configuration errors ( refer to appendix  [ sec : list - of - errors ] ) are organized into four categories : inbound traffic , outbound traffic , internal traffic , and inherently risky rules .",
    "the errors in each category have an identifying code with a leading letter indicating the category : `` i '' errors for inbound traffic , `` o '' errors for outbound traffic , `` d '' errors for internal , and `` r '' errors for risky rules .    the majority of configuration errors ( 21 of the  36 ) are for inbound traffic ( `` i '' errors ) .",
    "this is in line with the firewall s perceived primary job , which is to protect the internal resources from outsider attach .",
    "these errors cover things such as allowing any traffic inbound , or allowing services such as netbios , telnet , rpc , snmp , and several other known - risky services , through the firewall in the inbound direction .",
    "i also wanted to count errors that are related to services such as http , dns , and ftp .",
    "these are services that are often necessary to the running of business , so allowing then inbound should not be counted as an error _ per se_. for instance , http must be allowed to reach the organization s web servers . however , allowing http to reach machines that are not hardened web servers is risky  many sensitive machines ( like e - mail servers , phone switches , routers , and firewalls ) provide a web interface .",
    "the challenge is that we do not necessarily know which ip addresses belong to the relevant servers and which do not . to get around this challenge",
    ", i chose to use _",
    "thresholds_. the key idea is that it is very rare to find hundreds of different web servers on one network .",
    "thus , if http is allowed to reach over 256 ip addresses  more than a full class - c subnet  this is almost always the result of badly written rules .",
    "several of the inbound traffic configuration errors include such thresholds .",
    "configuration errors for outbound traffic ( `` o '' errors ) contribute 9  of the  36 items .",
    "most of these deal with services that are considered to be risky in all directions .",
    "in addition i counted errors for indiscriminate outbound e - mail traffic ( again using the notion of a thresholds ) and for irc , which is notorious for carrying the command - and - control channel of `` bot - nets '' .",
    "internal traffic through the firewall ( between separate internal network segments ) contributes  5 of the  36 items ( `` d '' errors ) : these all deal with services that are considered to be risky in all directions .",
    "finally , i also counted a special `` r '' error for the presence of rules that are inheretly problematic : an error is counted if the rule - set has `` to any allow any service '' rules .",
    "figure  [ fig : findings ] shows the raw distribution of configuration errors that were discovered in the data .",
    "the results are perhaps unsurprising in view of  @xcite : generally speaking , the surveyed firewalls are poorly configured .    in the inbound direction , over 45% of the firewalls allowed dns , or ftp , or smtp , to reach over 256 addresses ( items i10 , i11 , and i09 respectively ) . possibly more worrisome is that 42% of firewalls allowed inbound netbios traffic ( item i07 ) .    in the outbound direction",
    "the situation is apparently worse . over 80% of firewalls allow broad outbound smtp access ( item o02)and over",
    "60% of firewalls allow outbound p2p ( o08 ) , services which hardly ever have any business use .",
    "finally , over 60% of firewalls have rules of the form `` from somwhere to any allow any service '' ( r01 ) : very lax rules , which constitute gross mistakes by any account .",
    "one of the main findings of @xcite was that high rule - set complexity was positively correlated with the number of detected configuration errors .",
    "figure  [ fig : complexity ] shows a scatter plot of the number of errors versus @xmath0 , and demonstates the same phenomenon in the current survey .",
    "we can observe that there are very few high - complexity rule - sets that are well - configured ( the lower - right quadrant of the figure is very sparse ) .",
    "furthermore , the figure clearly shows a correlation between the rule - set complexity , as measured by @xmath0 , and the number of detected errors .",
    "in fact , the @xmath0  measure gives us a crude but fairly accurate prediction of the number of configuration errors : a linear regression ( the central line on figure  [ fig : complexity ] ) shows that the number of errors in a rule - set of complexity @xmath0  is roughly captured by the following formula : @xmath6    we can see that the current survey validates the finding of @xcite : it s safer to limit the complexity of a firewall rule - set .",
    "instead of connecting yet another subnet to the main firewall , and adding more rules and more objects , it seems preferable to install a new , dedicated , firewall to protect only that new subnet .",
    "complex firewall rule - sets are apparently too complex for their administrators to manage effectively .    as an aside , note that both check point and cisco ( and indeed other major firewall vendors ) are now offering virtualized solutions , in which a single piece of hardware can be set up to function as multiple separate firewalls .",
    "besides offering various operational and commercial advantages , our results suggest that using multiple small ( virtual ) firewalls is likely to be more secure than a single large firewall .",
    "one of the findings of @xcite was that check point firewalls  with versions 4.1 or later had slightly fewer configuration errors than those with earlier software versions .",
    "i wanted to test whether the same trend can be observed in this study as well .",
    "figures [ fig : risk - ckp ] and [ fig : risk - pix ] show the distribution of errors across the different versions , separately for check point firewall-1  and cisco pix .",
    "it is clear from both figures that , contrary to the findings of @xcite , the effect of the software version on the number of configuration errors is insignificant : the distribution of the number of errors is essentially independent of the firewall software version .",
    "the data does _ not _ support the hypothesis that later software versions are correlated with fewer errors ( for both vendors ) .",
    "i believe that @xcite detected such a trend because 8  of the configuration errors it considered were controlled by global options in the check point firewall-1  user interface ( rather than by explicit user - defined rules ) .",
    "the default settings for those gloal options were improved in v4.1 , producing the detected effect .",
    "however , all the configuration errors considered in this study are vendor - neutral and are controlled by explicit user - defined rules : i.e. , by the basic filtering functionality of the firewalls . this functionality has not changed syntactically or semantically , in neither vendor s products , during the period that data was collected .",
    "therefore we see that later software versions do not help users write better filtering rules .",
    "given the fact that the data includes rule - sets from two vendors , with rather different configuration languages and tools , i wanted to investigate whether the choice of vendor had an impact on the quality of the configuration .",
    "we already saw in figure  [ fig : complexity - brand ] that check point firewall-1configurations tended to be more complex than cisco pix firewalls  and from figure  [ fig : complexity ]",
    "we learned that more complex configurations typically have more errors .",
    "hence , we can expect check point firewalls  to have more errors than cisco pix firewallsjust because of their greater complexity . to test",
    "the extent of this phenomenon , figure  [ fig : separate - complexity ] repeats the data of figure  [ fig : complexity ] but with separate markers and regression lines for the two vendors .",
    "as expected , the figure shows that in general cisco pix firewalls  seem to exhibit fewer errors than check point firewalls : the median number of errors for the cisco pix firewalls  is 6 versus  14 for check point firewalls .",
    "furthermore , the vertical distance between the least - squares regression lines indicates that cisco pix firewalls  have approximately 5 errors less than check point firewalls  of comparable @xmath0  complexity . but",
    "a closer look reveals that small cisco pix firewalls , with @xmath0  @xmath7 , indeed have significantly fewer errors than small check point firewalls .",
    "however , the larger cisco pix firewalls , with @xmath0  @xmath8 , are essentially as poorly configured as the worst check point firewalls .",
    "note that this latter observation needs to be validated with more data : the surveyed firewalls only include  5 cisco pix firewallswith @xmath0  @xmath8 .",
    "as background for a possible explanation , other sources of information indicate that the cisco pix  configuration language and operational environment is more difficult to learn and use than check point firewall-1 : e.g. , cisco pixinvolves a complex notion of `` direction '' ( cf .",
    "@xcite ) ; cisco pix  mandates the use of network address translation ( nat ) statements  even in the case that no translation is needed ; finally , many cisco pix firewalls  are managed from the command line whereas check point firewalls  are managed using a graphical user interface . as a result ,",
    "one often sees questions on how to confiure the basic functionality of a cisco pix  on mailing lists such as firewall - wizards @xcite .    with this background ,",
    "my interpretation of figure  [ fig : separate - complexity ] is that , perhaps paradoxically , the steeper learning curve and harsher work environment of a cisco pixencourage administrators to produce smaller configurations  that are less error - prone than comparable check point firewalls .",
    "however , once the cisco pixconfiguration complexity becomes large ",
    "the number of errors seems similar to the numbers in comparable ( complex ) check point firewalls .",
    "as we ve seen , this work follows the methodology of @xcite .",
    "the current study is much larger , and is based on newer data , collected from firewalls made by two major vendors , running later firewall versions .",
    "finally , the study considers three times as many possible vendor - neutral configuration errors . in order to compare the complexity of configurations from different vendors ,",
    "this work also introduced a new uniform _ firewall complexity _",
    "( @xmath0 ) measure , that applies to both firewalls brands and probably to others as well .    unlike @xcite , the current study shows no significant indication that later software versions have fewer errors ( for either vendor)it seems that later software versions do not assist the administrators to make fewer errors .",
    "however , the findings do validate the main observations of @xcite : ( a ) firewalls are ( still ) poorly configured , and ( b ) a rule - set s complexity is ( still ) positively correlated with the number of detected configuration errors .",
    "these findings hold for rule - sets from both vendors .",
    "thus we can conclude that , for well - configured firewalls , `` small is ( still ) beautiful '' .",
    "san07    , 2009 .",
    "http://www.algosec.com .",
    "advisory ca-2003 - 20 : w32/blaster worm , 11 august 2003 .",
    "http://www.cert.org/advisories/ca-2003-20.html .",
    "d.  w. chapman and a.  fox . .",
    "cisco press , 2001 .",
    "control objectives for information and related technology ( cobit ) v4.1 . it governance institute ( itgi ) , 19922008 .",
    "http://www.isaca.org / cobit/.    . electronic mailing list , 19972008 .",
    "archived at https://listserv.icsalabs.com / pipermail / firewall - wizards/.    d.  moore , v.  paxson , s.  savage , c.  shannon , s.  staniford , and n.  weaver .",
    "the spread of the sapphire / slammer worm , 2003 .",
    "http://www.caida.org/outreach/papers/2003/sapphire/sapphire.html .",
    "a.  mayer , a.  wool , and e.  ziskind .",
    "offline firewall analysis . ,",
    "guidelines on firewalls and firewall policy .",
    "nist special publication 800 - 41 , 2002 .",
    "http://csrc.nist.gov/publications/nistpubs/800-41/sp800-41.pdf .",
    "data security standard ( pci dss ) v1.1 .",
    "payment card industry - security standards council , 2006 .",
    "https://www.pcisecuritystandards.org/.    a.  rubin , d.  geer , and m.  ranum .",
    "wiley computer publishing , 1997 .    .",
    "the twenty most critical internet security vulnerabilities , version 4.0 .",
    "http://www.sans.org/top20/ , 2007 .",
    "public company accounting reform and investor protection act of 2002 ( sarbanes - oxley act ) , 2002 .",
    "wikipedia article at http://en.wikipedia.org/wiki/sarbanes-oxley_act .",
    "d.  d. welch - abernathy . .",
    "addison - wesley , 2002 .",
    "a.  wool .",
    "a quantitative study of firewall configuration errors .",
    ", 37(6):6267 , 2004 .    a.  wool .",
    "the use and usability of direction - based filtering in firewalls .",
    ", 23(6):459468 , 2004 .",
    "i01 : inbound `` any '' service : :    allowing the `` any '' service to enter the network is extremely risky    since the `` any '' service includes many vulnerable services .",
    "i02 : inbound tcp on all ports : :    allowing tcp on all ports inbound is almost as risky as allowing any    service , since this includes many vulnerable tcp services . on pix    firewalls ,",
    "this risk is often the result of neglecting to specify a    port number on an access - list or conduit statement : omitting the port    number is interpreted as `` all ports '' .",
    "i03 : inbound udp on all ports : :    similar to allowing all tcp ports but for udp .",
    "i04 : inbound telnet : :    telnet is a remote - login service that is not encrypted . it is only    authenticated by simple passwords , that are transmitted in the clear .",
    "anyone snooping the traffic can read all the transmitted information .",
    "i05 : inbound rpc : :    the rpc service is a mechanism for remote procedure calls in unix    environments .",
    "it is implemented using the portmapper daemon , which    assigns tcp ports to the services .",
    "rpc services have a long history of    being insecure , and among others they include nfs ( which potentially    exposes all the organization s file system ) .",
    "i06 : inbound snmp : :    snmp is the simple network management protocol , which allows scanning    and identifying the network infrastructure",
    ". it is only authenticated    by a simple password , called the `` community string '' .",
    "the community    string is often left at its default setting of `` public '' , and    transmitted in the clear .",
    "several serious vulnerabilities have been    reported in snmp .",
    "i07 : inbound microsoft services : :    netbios is the name of a set of services that are used by the    microsoft windows family of operating systems to support network    functions such as file and printer sharing .",
    "these services are very    insecure , and include some of the most attacked services @xcite .",
    "i    counted an error if the firewall allowed any of these services to    cross it .",
    "i08 : inbound http to 256 + ips : :    http is the main protocol used for web browsing , so allowing it    inbound is not counted as an error _ per se_. however , allowing http    reach machines that are not hardened web servers is risky : many    sensitive machines provide a web interface : these include e - mail    servers , printers , phone switches , routers , and firewalls . therefore    allowing http to reach over 256 ip addresses",
    "is counted as an error    because it is very rare to find so many web servers on one    network ",
    "such access is almost always the result of badly written    rules .",
    "i09 : inbound smtp to 256 + ips : :    smtp is the main e - mail protocol  and e - mail is a vector for many    viruses and worms . nevertheless , allowing smtp inbound is a    requirement for many organizations , so inbound smtp is not counted as    an error .",
    "however , it is very rare to find more than 256 mail servers    on one network , so allowing smtp to reach over 256 ip addresses is    counted as an error .",
    "i10 : inbound dns / udp to 256 + ips : :    dns is the domain name service on udp port 53 or on tcp port 53 .",
    "dns    is one of the most attacked services in use @xcite .",
    "as before ,    inbound dns is often required  so it s not counted as a risk  but    allowing dns to reach over 256 dns servers on one network _",
    "i11 : inbound ftp to 256 + ips : :    ftp is the file transfer protocol , which is necessary for many    organizations .",
    "serious vulnerabilities have been found in many    versions of ftp server software .",
    "as before , an error is counted if ftp    is allowed to reach over 256 servers on one network .",
    "i12 : inbound icmp to 256 + ips : :    icmp is the internet control message protocol , which is necessary for    many network management tools ( like ping ) .",
    "full icmp access allows    outsiders to scan the network , it lets worm - generated traffic cross    the perimeter , and it can be used to mount denial - of - service attacks .    an error is counted if icmp can reach over 256 internal machines .",
    "i13 : inbound x11 : :    x11 is a popular graphical window system developed at mit and    implemented on unix systems to allow unix - based applications to be run    from multiple types of terminals , pcs , and workstations .",
    "x11 is not    encrypted and uses weak authentication .",
    "an error is counted if x11 is    allowed inbound .",
    "i14 : inbound tcp on 2000 + ports : :    allowing traffic over 2000 tcp ports inbound is almost as risky as    allowing all tcp ports ( item i02 ) , since this includes many vulnerable    tcp services .",
    "such access is usually the result of an `` permit all tcp    ports '' rule that is slightly mitigated by a few earlier `` deny tcp on    port x '' rules .",
    "i15 : inbound tftp : :    tftp is the trivial file transfer protocol .",
    "it is not encrypted and    not authenticated in any way .",
    "anyone who can use tftp inbound can    upload any file onto any device that responds to tftp , such as    routers , firewalls , and other communication equipment .",
    "i16 : inbound dns / tcp to 256 + ips : :    this is the same as item i10 except over tcp .",
    "i17 : inbound mssql : :    the microsoft sql server ( mssql ) contains several serious    vulnerabilities that allow remote attackers to obtain sensitive    information , alter database content , compromise sql servers , and , in    some configurations , compromise server hosts .",
    "it s in the sans top 20    list @xcite .",
    "i18 : inbound p2p : :    peer - to - peer services ( napster , edonkey , gnutella , kazaa ) are used to    download , and distribute many types of data ( e.g. , music , video ,    graphics , text , source code , and proprietary information to name a    few ) .",
    "these services are in the sans top 20 list @xcite .",
    "i19 : inbound instant - messaging : :    instant messaging services ( msn , yahoo , aol ) let users use text - based    chat , check remote web based email , do voice chat , perform video    communication , and send and share data files .",
    "these services are in    the sans top 20 list @xcite .",
    "i20 : inbound database access : :    database protocols ( sqlnet , mysql , postgresql ) provide remote access    to relational databases . allowing direct inbound access to your    corporate databases",
    "these services are in the sans top 20    list @xcite .",
    "i21 : inbound version control : :    version control systems ( cvs , subversion ) provide tools to manage    different versions of documents or source code .",
    "both systems have    serious known vulnerabilities .",
    "these services are in the sans top 20    list @xcite .",
    "o01 : outbound pop3 : :    pop3 is used to download e - mail from mail servers to desktop    computers . since e - mail is a vector for viruses and worms , many    organization only allow pop3 to reach their internal e - mail servers ,    and forbid any access to external e - mail servers .",
    "an error is counted    if pop3 is allowed outbound .",
    "o02 : outbound smtp from 256 + ips : :    outbound smtp ( e - mail ) should only originate from mail servers , not    from individual desktops .",
    "an error is counted if over 256 ip addresses    can send outbound smtp through the firewall .",
    "o03 : outbound irc : :    internet relay chat ( irc ) is an interactive chat service .",
    "many worms    and trojans use outbound irc as a communications vector .",
    "o04 : outbound `` any '' service : :    similar to the i01 item .",
    "o05 : outbound tcp on all ports : :    similar to the i02 item .",
    "o06 : outbound udp on all ports : :    similar to the i03 item .",
    "o07 : outbound tcp on 2000 + ports : :    similar to the i14 item .",
    "o08 : outbound p2p : :    similar to the i14 item .",
    "o09 : outbound instant - messaging : :    similar to the i19 item .",
    "d01 : internal `` any '' service : :    similar as the i01 item .",
    "d02 : internal tcp on all ports : :    similar as the i02 item .",
    "d03 : internal udp on all ports : :    similar as the i03 item .",
    "d04 : internal microsoft services : :    similar as the i07 item .",
    "d05 : internal x11 : :    similar as the i13 item .",
    "in addition to all the traffic - based errors described above , i also counted a special error for rules that are inheretly problematic , even if there are some other rules that mitigate some of their bad effects .",
    "an error is counted ( with code * r01 * ) if the rule - set has `` to any allow any service '' rules ."
  ],
  "abstract_text": [
    "<S> practically every corporation that is connected to the internet uses firewalls as the first line of its cyber - defense . </S>",
    "<S> however , the protection that these firewalls provide is only as good as the policy they are configured to implement . the first quantitative evaluation of the quality of corporate firewall configurations appeared in 2004 , based on check point firewall-1  rule - sets . in general </S>",
    "<S> that survey indicated that corporate firewalls were often enforcing poorly written rule - sets , containing many errors . </S>",
    "<S> one important finding was that high rule - set complexity was positively correlated with the number of detected configuration errors . </S>",
    "<S> another finding was an indication that rule - sets from later software versions had slightly fewer errors .    </S>",
    "<S> the goal of this work is to revisit the first survey , and to test whether its findings remain valid . </S>",
    "<S> the current study is much larger , and is based on newer data , collected from firewalls running later firewall versions . </S>",
    "<S> furthermore , for the first time the study includes configurations from two major vendors : both check point firewalls  and cisco pix firewalls . </S>",
    "<S> finally , the study considers three times as many possible configuration errors , consisting of  36 vendor - neutral errors instead of the  12 used in the 2004 study .    in order to compare the complexity of configurations from different vendors </S>",
    "<S> , this work also introduces a novel uniform complexity measure , called the _ firewall complexity _ ( @xmath0 ) , that applies to both types of firewalls .    </S>",
    "<S> the findings of the current study indeed validate the 2004 study s main observations : ( a ) firewalls are ( still ) poorly configured , and ( b ) a rule - set s complexity , as measured by the new @xmath0  measure , is ( still ) positively correlated with the number of detected configuration errors . </S>",
    "<S> these findings hold for rule - sets from both vendors . </S>",
    "<S> thus we can conclude that , for well - configured firewalls , `` small is ( still ) beautiful '' . </S>",
    "<S> however , unlike the 2004 study , there is no significant indication that later software versions have fewer errors ( for either vendor ) . </S>",
    "<S> this is apparently because the vendor - neutral errors that this study focuses on are all controlled by the firewall s basic filtering capability  which has not changed significantly between versions . </S>"
  ]
}