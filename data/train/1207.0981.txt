{
  "article_text": [
    "this paper describes an algorithm for quantifying dependencies in a multivariate data set . throughout this paper",
    "we will , in contrast to common jargon , strictly speak of correlation only in the context of linear correlation , whereas dependence is used for general , linear and also non - linear , correlation .",
    "understanding dependencies is especially useful and necessary in multidimensional likelihood analysis , a technique widely used in high energy physics ( hep ) .",
    "such analysis entails constructing a probability density function ( pdf ) describing the multivariate data set . in many analyses dependencies among different variables",
    "are neglected in the pdf .",
    "it is required to somehow prove that neglecting the dependencies is a valid procedure as e.g. they are small .    in section [ sec : maxlikelihood ] a brief introduction of the maximum likelihood method",
    "is given to illustrate the problems that arise from a data set with variables that are not independent .",
    "sections [ sec : linearcorrel ] and [ sec : projections ] will review existing methods and discuss their limitations . in section [",
    "sec : correlana ] a new algorithm for quantifying dependence is explained and section [ sec : cat ] presents cat , a fully automatic analysis tool .",
    "section [ sec : howto ] will briefly outline which possibilities exist to deal with dependencies in the data set .",
    "consider an unbinned extended maximum likelihood analysis of a data set with events of different categories @xmath0 ( e.g. signal and background ) .",
    "the log - likelihood function is expressed as : @xmath1 where    * @xmath2 is the total number of events in the data set , * @xmath3 is the number of different categories in the data set , * @xmath4 is the expected number of events for the @xmath5^th^ category , * @xmath6 is the pdf for the @xmath5^th^ category , * @xmath7 is the @xmath8-dimensional vector of variable values for the @xmath9^th^ event .    in the analysis",
    "the log - likelihood is maximized by changing the @xmath4 yields to extract the most likely set .",
    "if @xmath10 has more than one dimension , one usually speaks of a multidimensional analysis .",
    "the crucial point of a maximum likelihood analysis is to choose the model properly",
    ". such model might be either provided by theory or must be derived from simulated data and sideband studies .",
    "the latter is a common practice in hep . in case of a multidimensional analysis",
    "the model must also describe the dependencies among different variables correctly .",
    "if no theoretical model exists , e.g. for combinatorial background components , experimentalists usually start by describing the @xmath8-dimensional pdf as a product of marginal distributions : @xmath11 this procedure is entirely valid with no dependencies between different variables .",
    "indeed equation [ eqn : independence ] is the definition of independence among variables .",
    "if such a model @xmath6 shall be used for the @xmath5^th^ category , the @xmath4 events must have no dependencies among the different variables .",
    "it is the task of the experimentalist to prove that this assumption is valid and it is the aim of the following sections to provide assistance .",
    "one often used quantity to describe dependence among two variables @xmath12 and @xmath13 is the linear correlation coefficient @xmath14 . for a given sample of @xmath2 events ,",
    "it can be computed from the data by @xmath15 where @xmath16 and @xmath17 correspond to the sample mean .",
    "the values of @xmath14 are within the interval @xmath18 $ ] , where @xmath19 corresponds to @xmath20 ( anti-)linear correlation .",
    "@xmath21 corresponds to no linear correlation .",
    "figure [ fig : pearson0 ] shows an example of two variables with no linear correlation and figure [ fig : pearson1 ] shows an example of two variables with linear correlation .    in general",
    ", it is not possible to conclude from the absence of linear correlation that two variables are independent .",
    "for example in case of two variables that follow a circular distribution , thus @xmath22 and @xmath23 , the linear correlation coefficient is zero ( see figure [ fig : pearson2 ] ) .    in hep practice",
    "one should keep this limitation in mind as e.g. angular distributions can show a very small correlation coefficient to other variables but are not necessarily independent .",
    "to address the problem of dependencies between variables a common method in hep is to look at projections of one variable in subranges of the other . in figure",
    "[ fig : subrange ] three examples of this method are shown , using the same data sets that were introduced in figure [ fig : pearson ] . in case of independent variables",
    "the three projections follow the same distribution",
    ". however , in general this method does not allow to conclude independence .",
    "one has to be aware of symmetry axes in the distribution . by choosing two bins with @xmath24 and @xmath25 instead of three , figure [ fig : subrange2 ]",
    "would lead to two similar distributions . by using an adequate number of bins this problem",
    "can be avoided in practical applications .",
    "another problem in practice is , that it might be hard to judge whether two variables are independent or not .",
    "distributions might be very similar and compatible with each other within uncertainties or not .",
    "statistical tests might be necessary to estimate their compatibility . in case of more than two variables",
    "it is also difficult to compare dependence and , e.g. , sort them by their importance .",
    "the latter might be necessary to judge which dependencies should be described by a conditional pdf to improve the model . as these days multidimensional analyses with four , five or even more dimensions are becoming an important method , a reliable automatic procedure is desired .",
    "whereas the linear correlation coefficient is a quantitative measure of linear correlation , it can not be used to identify general dependence . on the other hand , projections in subranges can identify dependence but are difficult to compare or quantify without additional work .",
    "copulas have been introduces in 1959 by sklar to describe how a joint distribution function couples to its margins .",
    "sklar s theorem states :    _ let @xmath26 be a joint distribution function with margins @xmath27 and @xmath28 . then there exists a copula @xmath29 such that for all @xmath12,@xmath13 in @xmath30 , @xmath31 if @xmath27 and @xmath28 are continuous , then @xmath29 is unique ; otherwise , @xmath29 is uniquely determined on @xmath32 .",
    "conversely , if @xmath29 is a copula and @xmath27 and @xmath28 are distribution functions , then the function @xmath26 defined by equation ( [ eqn : sklar_theorem ] ) is a joint distribution function with margins @xmath27 and @xmath28 .",
    "_    sklar s theorem and more details on copulas can be found in @xcite .",
    "a special copula is the unit copula @xmath33 , which connects the marginal distributions of independent variables , as can be seen from equation ( [ eqn : independence ] ) .",
    "we therefore present an algorithm that performs a test of the hypothesis whether in a given data set with @xmath2 events , two variables @xmath12 and @xmath13 are independent .    1 .",
    "determine the probability integral transforms @xmath34 and @xmath35 of variables @xmath12 and @xmath13 .",
    "first sort the data in @xmath12 and @xmath13 .",
    "the values of @xmath36 @xmath37 , where @xmath38 is the index of @xmath39 in the sorted range , respectively , are then within the interval @xmath40 $ ] .",
    "this is sometimes referred to as flattening the distribution .",
    "2 .   create a @xmath41 histogram @xmath42 with bins of equal size and fill it with all events .",
    "the number of bins @xmath8 should be chosen such that @xmath43 is large enough ( @xmath44 ) .",
    "@xmath42 corresponds to the empirical copula density .",
    "3 .   in each bin of @xmath42 ,",
    "if @xmath12 and @xmath13 are independent , we expect @xmath45 entries and the statistical uncertainty can be approximated by @xmath46 if the binning was chosen as suggested in step  1 .",
    "compute the @xmath47 , where @xmath48 is the content of the @xmath49^th^ bin of @xmath42 .",
    "5 .   the probability of the data being consistent with a flat hypothesis and thus @xmath12 and @xmath13 being independent variables follows a @xmath50 distribution with @xmath51 degrees of freedom . by construction",
    "the number of degrees of freedom is reduced by @xmath52 due to the flatness of the two marginal distributions .    in short ,",
    "the algorithm performs a test of @xmath42 being consistent with the constant density @xmath53 expected from the unit copula .",
    "the algorithm is able to identify any linear or non - linear dependence .",
    "the probability of the hypothesis can easily be compared among different pairs of variables in a multivariate data set with more than two variables .",
    "it also can be translated into the unit of standard deviations significance for the hypothesis that @xmath12 and @xmath13 are independent .",
    "see the section about significance tests in @xcite .",
    "examples of the resulting deviations from a flat distribution for histogram @xmath42 are shown in figure [ fig : flat ] for the data sets introduced in figure [ fig : pearson ] .",
    "the algorithm is very robust and delivers reliable results no matter whether variable values are located on a small interval or reach over several orders of magnitude as it is based on rank statistics .",
    "another feature of this algorithm is the fact that its output scales with the size of the data set",
    ". a dependence might be negligible for low statistics but significant for higher statistics .",
    "imagine for example a chessboard like distribution . neither the algorithm nor the maximum likelihood fit will be sensitive to this dependence with low statistics and a simple product of marginal distributions will describe the data . with increasing statistics this dependence will become more and more significant as the size of the bins decreases .",
    "also the fit model will have to be adjusted once the dependence reaches a certain level .      in practical hep application of a multidimensional maximum likelihood analysis",
    "the output of the algorithm offers the experimentalist a reliable quantity for supporting the decision to choose a simple product approach in the construction of the pdf .    to verify that the approach is reasonable",
    ", a simulated data set with the same statistics as the real data set can be checked for any significant ( @xmath54 ) or evident ( @xmath55 ) , if conservative , dependence .",
    "if available , e.g. for signal events , a larger simulated data set with 10 times the statistics could be checked to not have any significant dependencies .",
    "what can be done in case of dependencies will be briefly discussed in section [ sec : howto ] .",
    "it is however not recommended to check simulated data sets with e.g. 100 or 1000 times the statistics of real data , as it is sometimes available for signal events .",
    "dependencies , which become significant only with these statistics , are negligible for a maximum likelihood analysis on real data statistics",
    ". furthermore at such high statistics it might be questionable if the simulation has the proper level of accuracy to describe dependencies to that detail .",
    "a careful study of dependencies requires a non negligible amount of work .",
    "as we have shown , simple and fast methods such as the linear correlation coefficient , do not deliver a reliable result .",
    "we therefore developed a fully automatic tool , cat , that performs an analysis for a given multivariate data set .",
    "including such tool into the work - flow of a multidimensional maximum likelihood analysis could significantly shorten the amount time , which is necessary to understand the data sample .",
    "currently the following methods , which partially have been discussed in this paper , are included :    1 .",
    "linear correlation coefficient 2 .",
    "profile plot of variable @xmath12 vs. variable @xmath13 and vice versa 3 .",
    "projections of variable @xmath12 in subranges of variable @xmath13 and vice versa 4 .",
    "hypothesis test of variable @xmath12 and @xmath13 being independent    for a given data set with @xmath8 variables all methods are computed for all pairs of variables automatically .",
    "an analysis report file is created , which provides a nice visual review and numeric results .",
    "cat can be downloaded from @xcite . as input",
    "a comma separated value ( csv ) file is used as such file can be produced easily from any type of user data format . a script to transform data from a flat root @xcite tuple to csv",
    "is provided as this is expected to be the most common case for application in hep . beside this",
    "a script to generate some example random data sets with different dependencies is provided .",
    "cat is licensed under the gplv3 @xcite .",
    "unfortunately , sometimes a product pdf is not a valid approach . assuming three variables @xmath12,@xmath13 and @xmath56 and a significant dependence between @xmath12 and @xmath13 , there are different possibilities .",
    "one simple possibility is of course to remove either @xmath12 or @xmath13 from the maximum likelihood analysis and perform e.g. a simple cut on it .",
    "a more complicated approach would be to perform the maximum likelihood analysis in bins of either @xmath12 or @xmath13 .",
    "the latter can also be a first step to understand the dependence better and to finally describe the probability density function as conditional pdf and thus the model becoming @xmath57 .",
    "whichever method is chosen , dealing with dependencies can be a more complicated problem than identifying them .",
    "even more important it is to be able to show that neglecting dependencies is a valid approach .",
    "in this paper we compare the empiric copula density against the expected density from the unit copula to search for dependence . in principle comparisons of the empiric copula density",
    "can also be made against other copulas , which e.g. describe the expected density from standard model physics .",
    "such an approach does not require any model assumptions about possible physics beyond the standard model .",
    "similar approaches have e.g. been made with the sleuth algorithm in @xcite .",
    "another possible application is the identification of good input variables for multivariate methods . a high dependence between the target variable and input variables is usually desired .",
    "depending on the problem it might also be that variables that have a large dependence on a certain variable shall be excluded such that the multivariate method can not influence this specific variable .",
    "a multivariate method should for example not produce a peak in the mass distribution of background events , which can be avoided by removing variables that have a strong dependence on the mass .",
    "a widely used multivariate data analysis package is tmva @xcite , which is included in root . beside this , the neurobayes @xcite package , which was developed in hep , has also found wide application among different experiments .",
    "a general review of multivariate methods and applications in hep can be found in @xcite .",
    "we have presented an algorithm that is able to quantify dependencies in multivariate data sets .",
    "the algorithm is able to deliver a reliable measure of dependence for supporting the product approach in multidimensional likelihood analyses .",
    "we have shown how to interpret its result in practice and we expect it to be a very useful method as these days more and more complicated and multidimensional analyses are carried out in hep .",
    "in addition a fully automatic tool , cat , was presented that performs a comprehensive analysis for a given multivariate data set and creates an analysis report .",
    "00 roger b. nelson , an introduction to copulas , springer ( 2006 )"
  ],
  "abstract_text": [
    "<S> we describe an algorithm to quantify dependence in a multivariate data set . the algorithm is able to identify any linear and non - linear dependence in the data set by performing a hypothesis test for two variables being independent . as a result </S>",
    "<S> we obtain a reliable measure of dependence .    in high energy physics understanding dependencies </S>",
    "<S> is especially important in multidimensional maximum likelihood analyses . </S>",
    "<S> we therefore describe the problem of a multidimensional maximum likelihood analysis applied on a multivariate data set with variables that are dependent on each other . </S>",
    "<S> we review common procedures used in high energy physics and show that general dependence is not the same as linear correlation and discuss their limitations in practical application .    </S>",
    "<S> finally we present the tool cat , which is able to perform all reviewed methods in a fully automatic mode and creates an analysis report document with numeric results and visual review .    </S>",
    "<S> = 1    correlation , dependence , multivariate data set , multidimensional likelihood analysis , cat </S>"
  ]
}