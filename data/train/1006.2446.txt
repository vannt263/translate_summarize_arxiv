{
  "article_text": [
    "there is a growing demand to include partial spatial coherence in optical design , not only because of classical areas of application such as microscopy and projection lithography , but also because of the increasing importance of partially coherent solid - state sources such as multimode lasers ( including excimers ) and leds .",
    "methods based on ray optics can not adequately describe all of the relevant issues related to coherence and polarization , which are intimately connected in electromagnetic coherence theory .",
    "thus wave - optical methods are required , which must be capable of dealing with non - paraxial fields and systems that may contain also micro- and nanostructures in objects and interfaces . to this end",
    ", one needs computationally efficient physical - optics - based representations of spatially partially coherent electromagnetic fields .",
    "apart from some specific models that allow analytic solutions , propagating spatially partially coherent light even in free space is a formidable numerical problem involving four - dimensional integrals  @xcite .",
    "the dimensionality of the propagation integrals can be decreased to two ( for planar sources ) if the partially coherent field is represented as an incoherent superposition of fully spatially coherent fields .",
    "the classical way to do this is the coherent - mode expansion of the cross - spectral density ( csd ) function by means of mercer s expansion  @xcite , which has recently been extended to electromagnetic fields  @xcite . in this representation",
    "the coherent modes are uniquely defined by the csd through a fredholm integral equation ; they form a complete and orthonormal set , in which the effective number of modes @xmath3 increases as the degree of coherence of the field is reduced  @xcite . thus , in free - space propagation , the original four - dimensional integral for csd is replaced by @xmath3 two - dimensional integrals for the coherent modes . in light - matter interaction analysis one solves the diffraction or scattering problem for @xmath3 coherent fields of different functional forms  @xcite .",
    "there is also an alternative representation of a partially coherent field in terms of uncorrelated , fully coherent fields  @xcite . here",
    "all coherent fields or ` elementary modes ' are of identical functional form but spatially ( or angularly ) shifted with respect to each other and weighted by a function determined by the csd . unlike the mercer expansion , the shifted - elementary - mode representation is applicable only to a specific class of genuine csds  @xcite .",
    "however , this class contains many of the fields of practical significance in optical design , including all quasihomogeneous fields ( leds , excimers , illumination in microscopy and projection lithography , etc . ) .",
    "since the elementary modes are identical , only a single 2d integral needs to be evaluated in free - space propagation problems . in interaction problems one needs to scan the elementary mode across the object and perform a set of independent diffraction calculations for coherent light .",
    "typically the elementary mode has a smooth functional form , at least compared to the higher - order modes in the mercer expansion , and is therefore easy to propagate numerically .",
    "another advantage of the shifted - mode model is that there is no need for numerical solution of the fredholm integral equation : the elementary mode and the associated weight function can be determined , e.g. , from far - zone properties of the field  @xcite .    in this paper",
    "we generalize the scalar shifted - elementary - mode representation to the vectorial case , which is necessary to adequately model partially spatially coherent , partially polarized sources .",
    "there are two major reasons why such a generalization is necessary : first , non - paraxial fields can not be adequately described by a scalar model and , second , optical components in the system can modify the polarization state of the field .",
    "it turns out that the vectorial nature of the field does not fundamentally complicate the numerical procedure .",
    "two elementary modes are needed to specify the state of polarization , but also in the electromagnetic case the modes and their weight functions can be determined from far - zone properties of the field .",
    "we begin the discussion by briefly reviewing the scalar model in sect .",
    "[ s : scalar ] to establish the notation and to simplify the interpretation of the main results .",
    "the extension to the electromagnetic case is outlined in sect .",
    "[ s : emext ] and the rigorous mathematical formulation is presented sections [ s : far ] and [ s : elementary ] .",
    "the important special case of rotationally symmetric and quasihomogeneous fields is discussed in sections [ s : rotsym ] and  [ s : quasihom ] , respectively .",
    "some numerical results are provided in sect .",
    "[ s : cosine ] . in sect .",
    "[ s : led ] we apply the model to a simple led geometry .",
    "finally , issues such as the measurements required to determine the elementary modes and their weight functions are discussed in sect .",
    "[ s : discussion ] .",
    "using the notations of fig .  [",
    "f : notations ] , we may write the well - known relationship  @xcite between the cross - spectral density function @xmath4 and the angular correlation function @xmath5 as ( we omit the dependence on the angular frequency @xmath6 for brevity thoughout the paper ) @xmath7 \\mathrm{d}^2\\kappa_1\\,\\mathrm{d}^2\\kappa_2 . \\label{angspecscalar}\\end{aligned}\\ ] ] here the asterisk indicates complex conjugation , @xmath8 with @xmath9 are position vectors , @xmath10 represent wave vectors , and @xmath11 are their transverse projections .",
    "restricting now to the specific class of fields mentioned in the introduction , we assume that the angular correlation function is of the schell - model form  @xcite @xmath12 the radiant intensity of a scalar field is defined as  @xcite @xmath13 where @xmath2 is the refractive index of the medium , @xmath14 with @xmath15 is a unit direction vector , @xmath16 is its transverse projection , @xmath1 is the angle between @xmath17 and the @xmath18 axis , and @xmath19 is the wave number . using eq .",
    ", we have @xmath20 thus the radiant intensity of a schell - model partially coherent field defined by eq .",
    "is the same as that produced by a coherent field with angular spectrum @xmath21 .",
    "let us introduce two - dimensional fourier - transform relations @xmath22 and @xmath23 where @xmath24 and @xmath25 is the transverse projection of the position vector .",
    "inserting eq .   into eq .   and using the fourier representation of @xmath26 obtained by inverting eq .  , we get the expression @xmath27 for the csd  @xcite .",
    "this result applies , in particular , at @xmath28 .",
    "thus @xmath29 is the coherent source - plane field with angular spectrum @xmath21 .",
    "the representation in eq .   expresses the partially coherent field as a weighted linear superposition of spatially shifted but identical fully coherent elementary ( scalar ) fields @xmath29 .",
    "as is evident from eq .  , the mathematical form of the elementary field mode @xmath29 can be determined from the knowledge of the radiant intensity ( at least apart from a phase factor , which can in fact be employed to model volume sources  @xcite ) . in general",
    ", the weight function @xmath30 can be determined from far - field coherence measurements using eqs .   and ,",
    "but often there are simpler ways to at least approximate it  @xcite .",
    "this is the case , in particular , if the field is quasihomogeneous , i.e. , if the coherence area in the source plane is much smaller than source area ; in this case the weight function comes out of the integral in eq .  . when @xmath29 and @xmath30 are known , coherent propagation techniques for @xmath29 and a linear superposition according to eq .",
    "suffice to propagate the entire spatially partially coherent field .",
    "the extension of the scalar shifted - mode model to the electromagnetic case is not trivial .",
    "one might be tempted to use some superpositions of , e.g. , locally linearly polarized modes of the scalar functional form to model partially polarized or unpolarized sources . however , such constructions seem hard to justify mathematically . the approach taken here",
    "is based on far - field information : in the far zone the field behaves as an outgoing spherical wave , and therefore it has a well - defined local polarization state .",
    "we employ this fact to separate the angular correlation tensor , which is the electromagnetic extension of the function @xmath5 , into two orthogonal parts [ see eq .   in sect .",
    "[ s : far ] ] .",
    "these represent the electromagnetic elementary modes ( or polarization modes ) in the far field",
    ". then the source - plane modes can be determined by fourier - transform techniques in analogy with the scalar case .    as a result of the construction process ( to be described mathematically in the following sections )",
    ", we obtain a vectorial shifted - mode expansion for the spatially partially coherent field everywhere in space [ see eqs .  , , and in sect .",
    "[ s : elementary ] ] . instead of propagating one fully coherent mode as in the scalar case",
    ", we now need to propagate two well - defined fully coherent vectorial field modes , and to form the generalized shifted - mode superposition , to govern the propagation of the electromagnetic spatially partially coherent field .",
    "thus the increase in computational complexity , compared to the scalar case , is essentially fourfold .",
    "a statistically stationary random electromagnetic field in the space  frequency domain is described by a csd matrix @xmath31 , which may be expressed as  @xcite @xmath32 here @xmath33 indicates the transpose , the brackets denote ensemble averaging , and the electric - field realizations @xmath34 are understood as appropriate random linear superpositions of the eigenfunctions of the fredholm integral equation satisfied by @xmath31  @xcite .",
    "the position - dependent spectral density of the field can be written , in analogy with scalar theory of partial coherence  @xcite , as @xmath35 , where tr stands for trace .",
    "the relation between the field at the ( secondary ) source plane @xmath36 and the far - field can be found , for example , using the angular spectrum representation of the csd matrix  @xcite .",
    "we thus have , at any plane @xmath37 , @xmath38 \\mathrm{d}^2\\kappa_1\\,\\mathrm{d}^2\\kappa_2 , \\label{angspecdef}\\end{aligned}\\ ] ] where the angular correlation matrix ( acm ) @xmath39 \\mathrm{d}^2\\rho_1\\,\\mathrm{d}^2\\rho_2 \\label{defangspec}\\end{aligned}\\ ] ] describes the correlations between vectorial plane - wave components . in the far zone  @xcite @xmath40}{r_1r_2",
    "} \\label{farfield}\\end{aligned}\\ ] ] and the poynting vector takes the form  @xcite @xmath41 where @xmath2 is the refractive index of the material , and @xmath42 and @xmath43 are the vacuum permittivity and permeability , respectively .",
    "furthermore , the radiant intensity is @xmath44\\nonumber\\\\ & = 2n \\pi^2 k^2    \\cos^2\\theta \\sqrt{\\frac{\\epsilon_0}{\\mu_0}}\\,\\mathrm{tr}\\,{\\boldsymbol{\\mathcal{a}}}(k\\boldsymbol{\\sigma } , k\\boldsymbol{\\sigma } ) .",
    "\\label{radiantintensity}\\end{aligned}\\ ] ]    owing to eqs .   and",
    ", also acm has a representation as a correlation matrix : @xmath45 where the components of @xmath46 represent , componentwise , the angular spectra  @xcite of the electric - field realizations .",
    "it follows from eq .   that @xmath47 is hermitian , satisfying @xmath48 where the dagger denotes the adjoint matrix .",
    "it is also non - negative definite in the sense that @xmath49 where @xmath50 is an arbitrary , sufficiently well - behaved vector function of the same size as the electric - field vector .",
    "the following argument is essential for the conclusions of this paper : the field in the far zone is well known to be a modulated outgoing spherical wave .",
    "thus , in spherical polar coordinates , the angular - spectrum vector is two - dimensional , i.e. , @xmath51 for every @xmath52 .",
    "hence @xmath53 is expressible as a @xmath54 matrix in these coordinates .",
    "since @xmath53 is a hermitian , non - negative definite @xmath54 matrix , it has two non - negative real - valued eigenfunctions . in view of eqs .   and",
    ", we have at @xmath55 the decomposition @xmath56 where @xmath57 are the eigenvalues and @xmath58 are the eigenvectors of @xmath47 .",
    "the eigenvectors may be assumed orthonormal , i.e. , @xmath59 in other words , the matrix @xmath47 can be diagonalized .",
    "evaluation of the trace in eq .",
    "yields the explicit form for the radiant intensity : @xmath60,\\label{radiantmodes}\\ ] ] where @xmath61 .",
    "thus it is proportional to the sum of the eigenvalues of the acm at @xmath62 .    the decomposition in eq .",
    "is , in fact , valid regardless of the chosen coordinate system ; the eigenvalues remain invariant in all unitary transformations , including simple coordinate transformations between , e.g. , cartesian and spherical polar coordinate systems . as explicitly expressed in eqs .",
    ", the polarization decomposition of acm is generally direction - dependent : the eigenvalues and/or the eigenvectors depend on @xmath52 .",
    "the physical meaning of eq .",
    "is clear : in each direction in the far - zone , we may decompose the single - point acm into two mutually uncorrelated , orthogonal polarization components . moreover ,",
    "owing to the factorized form @xmath63 of these components , they both represent fully polarized fields .",
    "this can be verified from the well - known formula for the ( space  frequency domain ) degree of polarization : @xmath64 ^ 2}\\right\\}^{1/2}.\\end{aligned}\\ ] ] in the far zone we have , using eq .",
    "( [ farfield ] ) , @xmath65 ^ 2}\\right\\}^{1/2}. \\label{farzoned}\\end{aligned}\\ ] ] with the aid of eqs .",
    "( [ decomposition ] ) and ( [ orthogonality ] ) , we then obtain @xmath66 thus @xmath67 for each individual polarization mode , i.e. , if either @xmath68 or @xmath69 .",
    "it is worth stressing that the polarization decomposition presented above is analogous with the well - known decomposition of a partially polarized plane wave into two polarization modes : in particular , eq .",
    "( [ idegpol ] ) is analogous with eq .",
    "( 6.331 ) in ref .  @xcite . in our case , however , the direction - dependent eigenvalues are those of a partially polarized and partially coherent field in the far zone .    to be able to include partial coherence ( in addition to partial polarization ) in the analysis , we now assume that also the two - point acm can be expressed in the form @xmath70 where @xmath71 have diagonal values @xmath72 . in other words , @xmath53 is assumed to be expressible as a sum of two mutually uncorrelated , but fully coherent and polarized modes even if @xmath73 .",
    "we stress that , while eq .",
    "( [ assumption ] ) does not follow from eq .",
    "( [ decomposition ] ) , it typically holds .",
    "we do not dwell into a detailed discussion of this point here , but note that it is a nontrivial task to find counterexamples .",
    "we proceed to investigate the angular correlation properties of the class of fields described by eq .  .",
    "without loss of generality , we may employ spherical polar coordinates in the far field , in which case @xmath71 is a @xmath54 matrix .",
    "let us denote by @xmath74 a unitary matrix whose columns are the eigenvectors @xmath75 of @xmath47 and by @xmath76 a diagonal matrix with elements equal to the eigenvalues @xmath57 of @xmath77 . then , equivalently with eq .  , we may write @xmath78 and consequently @xmath79 in view of eq .",
    "( [ assumption ] ) and the associated discussion , @xmath80 represents the angular correlation between two plane - wave components whose polarization states are described by deterministic vectors @xmath81 and @xmath82 .",
    "thus we may write , in analogy with eq .",
    "( [ decomposition ] ) , @xmath83 where @xmath84 are scalar ( angular correlation ) functions .",
    "it is seen by direct calculation that @xmath53 has a representation similar to eq .",
    "( [ singular11 ] ) , @xmath85 where @xmath86 is a diagonal matrix with elements @xmath84 .",
    "thus @xmath75 and @xmath84 can be determined by singular value decomposition of @xmath87 .",
    "it can be shown , e.g. , using eq .   that the singular values",
    "@xmath84 satisfy @xmath88 as a result , we may define the normalized angular correlation functions @xmath89^{1/2 } } \\label{normg}\\end{aligned}\\ ] ] satisfying the inequalities @xmath90 .",
    "if the correlations in the far zone are of ( generalized ) schell - model form , i.e. , @xmath91 , it follows from eqs .",
    "( [ decomposition2 ] ) and ( [ normg ] ) that @xmath92 with @xmath93^{1/2}\\mathbf{f}_j ( \\boldsymbol{\\kappa } ) .",
    "\\label{hf}\\ ] ] this is the electromagnetic extension of eq .  .",
    "it follows from eq .   and the linearity of eq .   that the csd has the decomposition @xmath94 let us define the inverse fourier transforms @xmath95 and @xmath96 of the functions @xmath97 and @xmath98 in analogy with eqs .   and .",
    "with a procedure similar to that used in derivation of eq .  , we can express the two terms in eq .",
    "( [ fieldsource ] ) in the form @xmath99 in the half - space @xmath100 . in particular , eq .",
    "( [ elementary ] ) is valid at the source plane @xmath28 , where @xmath101 .",
    "this result is the electromagnetic extension of the scalar elementary - mode decomposition in eq .  .",
    "let us next examine some general properties of eq .",
    "( [ elementary ] ) . equations and together with @xmath102 lead to @xmath103 because of the exponential factor in the integral , @xmath104 and @xmath105 are generally not orthogonal in a pointwise sense . for many paraxial fields , though , the functions @xmath106 and @xmath107 are globally orthogonal , i.e. , @xmath108 for all @xmath109 and @xmath110 . in this special case",
    "the pointwise orthogonality of @xmath104 and @xmath105 follows from eqs .  , , and .",
    "this property holds also for significant classes of non - paraxial fields , as will be demonstrated in sections [ s : rotsym ] and [ s : cosine ] .",
    "however , it is not essential for practical implementation of the propagation algorithm developed in this paper .    since the functions @xmath95 represent fully coherent fields , they obey the helmholtz equation @xmath111 furthermore , the csd matrix obeys the divergence equation  @xcite @xmath112 where the subscript 1 denotes differentiation with respect to @xmath113 . together with eqs .   and",
    ", this implies that @xmath114 in view of eqs .   and , the functions @xmath115 behave exactly as the electric field vector in the space  frequency domain .",
    "hence the matrix - functions @xmath116 may be called the _ elementary electric - field modes _ of the field . using these modes , we can write eqs .   and in a more compact form @xmath117 and express the spectral density of the field as @xmath118 where @xmath119 are the spectral densities of the two elementary electric - field modes .    in analogy with scalar theory  @xcite , the field in eq .",
    "is understood to consist of a weighted continuum of identical , laterally shifted elementary modes .",
    "the main difference between the scalar and electromagnetic descriptions is that the electromagnetic field consists of two ( uncorrelated ) sets of elementary modes , whose polarization states in the far - zone are orthogonal and whose radiant - intensity distributions are in general different .",
    "owing to the factorized form of @xmath120 in eq .  , each elementary mode is completely coherent  @xcite in the sense of the space ",
    "frequency analog of the degree of coherence for electromagnetic fields put forward in ref .",
    "@xcite : @xmath121\\}^{1/2}. \\label{scalarmu}\\end{aligned}\\ ] ] here @xmath122^{1/2 } } \\label{boldmu}\\end{aligned}\\ ] ] is the normalized csd matrix . in general , all @xmath123 matrix elements of @xmath120 are non - zero and spatially varying .",
    "analogously with eqs .   and",
    ", we can define the degree of angular coherence @xmath124\\}^{1/2 } \\label{scalaralpha}\\ ] ] where @xmath125^{1/2 } } \\label{boldalpha}\\ ] ] is normalized angular correlation matrix .    to conclude this section we provide a convenient , fully general series representation for the electric - field modes . in the far zone , where the field is transverse to the local propagation direction and thus fluctuates locally in the plane defined by the spherical polar unit vectors @xmath126 and @xmath127",
    ", it is natural to express the basis vectors in the form @xmath128 using spherical polar coordinates @xmath129 for the spatial frequencies and circular cylindrical coordinates @xmath130 for the position vector ( see fig .",
    "[ f : notations ] ) , we then have ( after somewhat lengthy calculations outlined in appendix [ a1 ] ) @xmath131\\nonumber\\\\ & \\qquad+ \\boldsymbol{\\hat{\\phi } } \\left [ \\frac { m}{\\rho}\\cos\\theta f_{j,\\theta , m}(\\theta ) -{\\rm i } f_{j,\\psi , m}(\\theta ) \\frac{\\mathrm{d}}{\\mathrm{d\\rho } } \\right]\\nonumber\\\\ & \\qquad- \\mathbf{\\hat{z } } k \\sin^2\\theta f_{j,\\theta , m}(\\theta ) \\biggr\\}j_m(k\\rho\\sin\\theta)\\,\\mathrm{d}\\theta , \\label{cylinder}\\end{aligned}\\ ] ] where @xmath132 are the azimuthal fourier coefficients of @xmath133 and @xmath134 stands for either @xmath1 or @xmath135 .",
    "note that the upper limit of the integral in eq .",
    "is set to @xmath136 .",
    "thus the elementary electric - field modes are taken to contain only propagating waves , i.e. , information that can be gathered from far - zone measurements . as a result ,",
    "the propagation method considered here is not suitable for modeling near - field phenomena ( fields at distances of the order of one wavelength from the plane @xmath36 ) .",
    "let us assume that the csd at @xmath28 is rotationally symmetric about the @xmath18 axis",
    ". then also the acm is rotationally symmetric and the polarization basis vectors @xmath106 and @xmath107 are rotationally invariant , i.e. , their @xmath1 and @xmath135 components @xmath137 and @xmath138 are independent on the azimuthal angle @xmath135 . hence only the zeroth - order fourier coefficients @xmath139 in eq .",
    "are non - zero and it follows from eqs .   and that @xmath140\\nonumber\\\\ & \\qquad- \\sin\\theta j_0(k\\rho\\sin\\theta)f_{j,\\theta,0}(\\theta)\\mathbf{\\hat{z } } \\biggr\\ } \\,\\mathrm{d}\\theta.\\end{aligned}\\ ] ] thus , as expected , the elementary electric - field modes are also rotationally symmetric about the @xmath18 axis .",
    "in particular , if the basis vectors are parallel to @xmath126 and @xmath127 ,    @xmath141 \\nonumber\\\\ & \\quad\\times\\exp\\left({\\rm i } kz\\cos\\theta \\right)\\,\\mathrm{d}\\theta,\\\\ \\mathbf{e}_2(\\mathbf{r } ) & = \\boldsymbol{\\hat{\\phi}}\\frac{{\\rm i}k^2}{2\\pi}\\int_0^{\\pi/2}f_{j,\\psi,0}(\\theta ) \\sin\\theta j_1(k\\rho\\sin\\theta ) \\nonumber\\\\ & \\quad\\times\\exp\\left({\\rm i } kz\\cos\\theta \\right)\\,\\mathrm{d}\\theta.\\end{aligned}\\ ] ]    [ generalradialazimuthal ]    the elementary modes @xmath142 and @xmath143 are now radially and azimuthally polarized fields , respectively .",
    "hence they are pointwise orthogonal , regardless of whether the field is paraxial or not .",
    "since these modes have no azimuthal phase variation , they possess no phase singularity ( vortex ) at @xmath144 .",
    "thus , even if the axial field vanished @xmath36 ( as turns out to be often the case for some of the field components ) , such a zero does not propagate .",
    "assume next that the variations of the spectral density @xmath145 at the source plane are slow compared to the variations of the degree of coherence @xmath146 .",
    "moreover , let the correlations at @xmath28 be of the schell - model form , i.e. , depend only on @xmath147 .",
    "such a planar source is said to be quasi - homogeneous  @xcite .",
    "we may then approximate @xmath148 , where @xmath149 , and write @xmath150 inserting eq .   into eq .",
    "and defining @xmath151 yields @xmath152 where @xmath153 and @xmath154 since @xmath155 it follows from eq .",
    "( [ radiantintensity ] ) that the radiant intensity produced by a quasihomogeneous electromagnetic source depends only on the correlation properties of the source field , in complete analogy with the scalar case  @xcite .",
    "inserting from eq .   into eq .   and",
    "recalling that @xmath156 is a wide function compared to @xmath157 , we have @xmath158 using eq .   and noting that @xmath157 is real because @xmath159 is non - negative , we obtain @xmath160 ^ 2\\right\\}^{1/2}}{{\\rm tr}\\,\\tilde{\\mu } ( \\bar{\\boldsymbol{\\kappa}})}. \\label{alpha-2}\\ ] ] this expression can be cast into a more transparent form using the far - zone degree of polarization defined in eq .  , which can be written equivalently in the form @xmath161 ^ 2 } { \\left[{\\rm tr}\\,\\tilde{\\boldsymbol{\\mu}}(\\boldsymbol{\\kappa})\\right]^2}-1\\right\\}^{1/2}.\\ ] ] we then have , from eq .  , @xmath162^{1/2}. \\label{qhffd}\\ ] ]",
    "the first fraction in this expression is equal to the scalar degree of angular coherence . the second fraction , however , is a polarization - dependent modulating term that depends on the source - plane correlations .",
    "the assumption that the source is quasihomogeneous simplifies decisively the elementary - mode decomposition of the field in the scalar case  @xcite , and the same is true in the electromagnetic case .",
    "it follows from eqs .",
    ", , and   that @xmath163 where , in the last step , we have used eq .  .",
    "comparing eqs .",
    "and   yields @xmath164 thus the weight function no longer appears inside the integral and , irrespective of the spatial distribution of the spectral density at the source plane , the field characteristics can be determined the propagating a convolution integral involving the elementary modes only .",
    "let us consider the rotationally symmetric case with radially and azimuthally polarized basis vectors @xmath165 , @xmath166 , and corresponding eigenvalues @xmath167 , @xmath168 , where @xmath169 and @xmath170 are arbitrary ( real ) functions of frequency .",
    "then , in view of eq .  , the radiant intensity is a superposition of two @xmath0 type contributions , one radially and the other azimuthally polarized : @xmath171.\\ ] ] the elementary electric - field modes in the far zone are , according to eq .  ,    @xmath172    using eqs .   and",
    "we see that the non - vanishing fourier coefficients are @xmath173 and @xmath174 . inserting these into eqs .   and",
    "applying   derived in appendix [ a2 ] , we obtain the source - plane elementary field modes in the form    @xmath175,\\\\ \\mathbf{e}_2(\\rho,0 ) & = \\boldsymbol{\\hat{\\phi}}a_2\\frac{{\\rm i}k^3\\rho}{16\\sqrt{\\pi } } \\gamma\\left(\\frac{b}{4}\\right)\\nonumber\\\\ & \\quad\\times \\sideset{_1}{_2}\\operatorname{\\widetilde{\\mathit{f}}}\\left(\\frac{3}{2};2,\\frac{3}{2}+\\frac{b}{4};-\\frac{k^2\\rho^2}{4}\\right),\\end{aligned}\\ ] ]    [ spcosmodes ]    where @xmath176 is the gamma function and @xmath177 is the regularized hypergeometric function ( see appendix [ a2 ] ) .    figures  [ cos1][cos3 ] illustrate the radial dependence of the elementary - field components and the function @xmath178^{1/2}\\ ] ] for different values of @xmath179 , with @xmath180 .    , as well as the function @xmath181 ( thick solid line ) for @xmath182 , which corresponds to a lambertian source . ]    , but with @xmath183 , which corresponds to an incoherent source in scalar theory . ]    , but with @xmath184 .",
    "thus the source has a somewhat directional radiation pattern . ]    , but with @xmath185 .",
    "the radiation pattern is increasingly directional and could be produced approximately by a led with an integrated collimating lens . ]",
    "let us consider a simple model for a rotationally symmetric surface - emitting led illustrated in fig .",
    "[ f : ledgeom]a , where the primary light - emitting region is planar ( such as a quantum well ) and buried inside a semiconductor material of refractive index @xmath186 .",
    "each primary source point is assumed to radiate ( independently ) a spherical wave .",
    "if we denote the propagation angle inside the semiconductor material by @xmath187 , the radiant intensity may be expressed as a sum of radially and azimuthally polarized contributions @xmath188 , @xmath9 : @xmath189 where @xmath190 is the complex amplitude of the plane wave in direction @xmath187 .",
    "if the distance between the pn plane and the semiconductor - air interface is large compared to @xmath191 , the local plane wave approximation is valid at the semiconductor - air interface .",
    "thus the output radiant intensity takes the form @xmath192 here @xmath193 , the angles @xmath1 and @xmath187 are related by snell s law @xmath194 , and @xmath195 , where @xmath196 are given by fresnel s equations @xmath197",
    "@xmath198 for radial ( tm ) and azimuthal ( te ) polarizations .",
    "because of the large refractive index @xmath186 of a semiconductor , only a narrow cone of plane waves with incident angles @xmath187 in the range @xmath199 .",
    "we may thus assume that the radial and azimuthal contributions to the radiant intensity of the primary source are equal , i.e. , @xmath200 , and hence we may denote @xmath201 and @xmath202 . then the degree of polarization given by eq",
    ".   is @xmath203 and the radiant intensity transforms at the interface according to @xmath204.\\ ] ] if we assume that the radiation pattern produced by the primary source is lambertian , with @xmath205 the radial and azimuthal contributions to the radiant intensity of the secondary source become @xmath206 these contributions @xmath207 and @xmath208 are shown by the dotted and dashed lines , respectively , in fig .",
    "[ f : ledgeom]b , where we have taken @xmath209 .",
    "the curves fit well the @xmath0 : we obtain @xmath210 for the azimuthally polarized contribution , @xmath211 for the radially polarized contribution , and @xmath212 for an equally weighted sum of the two contributions .",
    "thus the elementary electric - field modes given by eq .",
    "provide good approximations of the modes of the structure in fig .",
    "[ f : ledgeom]a .",
    "the degree of polarization , also plotted in fig .",
    "[ f : ledgeom]b , increases from a zero on - axis value ( unpolarized radiation in the paraxial domain ) to @xmath213 when @xmath214 , indicating partially polarized radiation in the non - paraxial domain .",
    "is the refractive index of the semiconductor material .",
    "the solid and dashed curves illustrate the azimuthally and radially polarized contributions to the radiant intensity distribution @xmath215 .",
    "( b )  geometrical - optics predictions of the azimuthally ( dashed curve ) and radially ( dotted curve ) polarized contributions to the radiant intensity , their average ( solid curve ) , and the degree of polarization @xmath216 in the far zone ( thick solid curve).,title=\"fig : \" ]   is the refractive index of the semiconductor material .",
    "the solid and dashed curves illustrate the azimuthally and radially polarized contributions to the radiant intensity distribution @xmath215 .",
    "( b )  geometrical - optics predictions of the azimuthally ( dashed curve ) and radially ( dotted curve ) polarized contributions to the radiant intensity , their average ( solid curve ) , and the degree of polarization @xmath216 in the far zone ( thick solid curve).,title=\"fig : \" ]",
    "the electromagnetic elementary - mode decomposition presented in this paper should prove useful in in optical system modeling by field tracing methods . to this end , it is necessary to determine elementary field modes and the weight functions of the source .",
    "the example presented above illustrates the possibility of doing this if there is sufficient a priori information about the structure of the source . if , however , the source properties are not known , it is necessary to determine the modal decomposition experimentally . as in the scalar case  @xcite",
    ", this can in principle be accomplished by far - field measurements . in general , the polarization basis vectors @xmath217 and the eigenvalues @xmath218 can be determined from the polarization matrix @xmath47 . this matrix can be determined by measuring , e.g. , the angular dependence of the stokes parameters of the field in the far zone .",
    "thus only single - point measurements across the radiation pattern are needed .",
    "determination of the weight functions requires , in general , two - point correlation measurements in the far zone , but this is avoided if the field is known to be quasihomogeneous .",
    "this work was supported by the academy of finland ( 118951 , 129155 , and 209806 ) .",
    "in this appendix we present some details of the derivation of eq .",
    "( [ cylinder ] ) , which is the general representation of the elementary electric - field modes . denoting the circular cylindrical coordinates by @xmath219 in the position - vector space and by @xmath220 in the wave vector space , and",
    "the spherical polar coordinates by @xmath221 in the wave vector space , we have the following relations between the unit vectors of these systems and the cartesian coordinates ( see fig .  [ f : notations ] ) : @xmath222 @xmath223 @xmath224 where @xmath225 is the rotation matrix and @xmath134 may stand for @xmath226 , @xmath135 , or @xmath1 . using eq .   and recognizing that @xmath227 and @xmath228 , we can write eq .   in circular cylindrical coordinates : @xmath229 using eqs .",
    "and one can establish the relation @xmath230 where @xmath231 , and express @xmath97 in the form @xmath232{\\rm",
    "e}^{{\\rm i}\\beta}\\left(\\boldsymbol{\\hat{\\rho } } + { \\rm i}\\boldsymbol{\\hat{\\psi}}\\right)\\nonumber\\\\ & + & \\frac{1}{2}\\left[\\cos\\theta f_{j,\\theta}(\\theta,\\psi)+{\\rm i } f_{j,\\psi}(\\theta,\\psi)\\right]{\\rm e}^{-{\\rm i}\\beta}\\left(\\boldsymbol{\\hat{\\rho } } - { \\rm i}\\boldsymbol{\\hat{\\psi}}\\right)\\nonumber\\\\ & - & \\sin\\theta f_{j,\\theta}(\\theta,\\psi)\\mathbf{\\hat{z}}. \\label{a6}\\end{aligned}\\ ] ] recognizing further that @xmath233 and that @xmath234 , we can expand the plane - wave term in eq .   in a series form",
    "@xmath235 where @xmath236 denotes the bessel function of the first kind and order @xmath237 .",
    "combining eqs .",
    "and we then have @xmath238 where @xmath239 performing the integration with respect to @xmath135 with the aid of the definition of the azimuthal fourier coefficients in eq .  , we obtain @xmath240\\nonumber\\\\ & & \\times { \\rm e}^{{\\rm i}(m+1)\\phi } j_m(k\\rho\\sin\\theta)k\\sin\\theta\\nonumber\\\\ & + & \\frac{1}{2}\\left(\\boldsymbol{\\hat{\\rho } } - { \\rm i}\\boldsymbol{\\hat{\\phi}}\\right)\\left[\\cos\\theta f_{j,\\theta , m-1}(\\theta)+{\\rm i}f_{j,\\psi , m-1}(\\theta)\\right]\\nonumber\\\\ & & \\times { \\rm e}^{{\\rm i}(m-1)\\phi}j_m(k\\rho\\sin\\theta)k\\sin\\theta\\nonumber\\\\ & - & \\mathbf{\\hat{z}}\\,{\\rm e}^{{\\rm i}m\\phi } j_m(k\\rho\\sin\\theta)k\\sin^2\\theta.\\end{aligned}\\ ] ] collecting terms in the summation of eq .   by replacements @xmath241 and employing the bessel - function identities  @xcite @xmath242 and @xmath243 we finally arrive at eq .  .",
    "let us first recall the series - representation of bessel functions  @xcite : @xmath244 on the other hand , we have the relation  @xcite @xmath245 where @xmath246 , @xmath247 , @xmath248 is the beta function , and @xmath249 is the gamma function  @xcite . combining eqs .   and  , and interchanging the order of summation and integration yields          \\10 .",
    "l. mandel and e. wolf , _ optical coherence and quantum optics _ ( cambridge university press , cambridge , uk , 1995 ) .",
    "e. wolf , `` new theory of partial coherence in the space ",
    "frequency domain .",
    "part i : spectra and cross spectra of steady - state sources , '' j. opt .",
    "* 72 , * 343351 ( 1982 ) .",
    "f. gori , m. santarsiero , r. simon , g. piquero , r. borghi , and g. guattari , `` coherent - mode decomposition of partially coherent , partially polarized sources , '' j. opt .",
    "am . a * 20 , * 7884 ( 2003 ) .",
    "j. tervo , t. setl , and a. t. friberg , `` theory of partially coherent electromagnetic fields in the space  frequency domain , '' j. opt .",
    ". am . a * 21 , * 22052215 ( 2004 ) .",
    "f. gori , `` collett - wolf sources and multimode lasers , '' opt .",
    "* 34 , * 301305 ( 1980 ) .",
    "f. gori , `` mode propagation of the light field generated by collett - wolf schell - model sources , '' opt .",
    "* 46 , * 149154 ( 1983 ) .",
    "a. starikov and e. wolf , `` coherent - mode representation of gaussian schell - model sources and of their radiation fields , '' j. opt .",
    "am . a * 72 , * 923928 ( 1982 ) .",
    "a. starikov , `` effective number of degrees of freedom of partially coherent sources , '' j. opt .",
    "* 73 , * 15381544 ( 1983 ) .",
    "j. huttunen , a. t. friberg , and j. turunen , `` diffraction of partially coherent electromagnetic fields by microstructured media , '' phys",
    "e * 52 , * 30813092 ( 1995 ) .",
    "p. vahimaa and j. turunen , `` bragg diffraction of spatially partially coherent fields , '' j. opt .",
    "am . a * 14 , * 5459 ( 1997 ) .",
    "f. gori and c. palma , `` partially coherent sources which give rise to highly directional laser beams , '' opt",
    "* 27 , * 185188 ( 1978 ) .",
    "f. gori , `` directionality and partial coherence , '' opt .",
    "acta * 27 , * 10251034 ( 1980 ) .",
    "p. vahimaa and j. turunen , `` finite - elementary - source model for partially coherent radiation , '' opt .",
    "express * 14 , * 13761381 ( 2006 ) . f. gori and m. santarsiero , `` devising genuine correlation functions , '' opt .",
    "* 32 , * 531 - 3533 ( 2007 ) .",
    "j. turunen and p. vahimaa , `` independent - elementary - field model for three - dimensional spatially partially coherent sources , '' opt .",
    "express * 16 , * 64336442 ( 2008 ) .",
    "m. a. alonso and e. wolf , `` the cross - spectral density matrix of a planar , electromagnetic stochastic source as a correlation matrix , '' opt .",
    "* 281 , * 23932396 ( 2008 ) .",
    "j. tervo and j. turunen , `` angular spectrum representation of partially coherent electromagnetic fields , '' opt . commun .",
    "* 209 , * 716 ( 2002 ) .",
    "t. setl , j. tervo , and a. t. friberg , `` complete electromagnetic coherence in space  frequency domain , '' opt . lett . * 29 , * 328330 ( 2004 )",
    ". j. tervo , t. setl , and a. t. friberg , `` degree of coherence for electromagnetic fields , '' opt .",
    "express * 11 , * 11371143 ( 2003 ) .",
    "g. b. arfken and h. j. weber , _ mathematical methods for physicists _",
    "( academic press , san diego , ca , 2001 ) . i. s. gradshteyn and i. m. ryzhik , _ table of integrals , series , and products _ , a. jeffrey , d. zwillinger , eds . , seventh edition .",
    "( academic press , orlando , 2007 ) . w. n. bailey , _ generalized hypergeometric series _ , vol .",
    "32 of cambridge tracts in mathematics and mathematical physics , g. h. hardy and e. cunningham , eds .",
    "( cambridge university press , cambridge , uk , 1935 ) ."
  ],
  "abstract_text": [
    "<S> a representation of partially spatially coherent and partially polarized stationary electromagnetic fields is given in terms of mutually uncorrelated , transversely shifted , fully coherent and polarized elementary electric - field modes . </S>",
    "<S> this representation allows one to propagate non - paraxial partially coherent vector fields using techniques for spatially fully coherent fields , which are numerically far more efficient than methods for propagating correlation functions . </S>",
    "<S> a procedure is given to determine the elementary modes from the radiant intensity and the far - zone polarization properties of the entire field . </S>",
    "<S> the method is applied to quasihomogeneous fields with rotationally symmetric @xmath0 radiant intensity distributions ( @xmath1 being the diffraction angle with respect to the optical axis and @xmath2 an integer ) . </S>",
    "<S> this is an adequate model for fields emitted by , e.g. , many light - emitting diodes . </S>"
  ]
}