{
  "article_text": [
    "the detection of cosmic microwave background ( cmb ) anisotropies on the sky has been over the past three decades subject of intense activity in the cosmology community .",
    "the cmb , discovered in 1965 by penzias and wilson , is a relic radiation emitted some 13 billion years ago , when the universe was about 370.000 years old .",
    "small fluctuations of this emission , tracing the seeds of the primordial homogeneities which gave rise to present large scale structures as galaxies and clusters of galaxies , have been observed by a number of experiments such as archeops @xcite , boomerang @xcite , maxima @xcite and wmap @xcite .",
    "the precise measurement of these fluctuations is of utmost importance for cosmology .",
    "their statistical properties ( spatial power spectrum , gaussianity ) strongly depend upon the cosmological scenarios describing the properties and evolution of our universe as a whole , and thus permit to constrain these models as well as to measure the cosmological parameters describing the matter content , the geometry , and the evolution of our universe @xcite .    accessing this information , however ,",
    "requires disentangling in the data the contribution of several distinct astrophysical sources , all of which emit radiation in the frequency range used for cmb observations @xcite .",
    "this problem of component separation , in the field of cmb studies , has thus been the object of many dedicated studies in the past .",
    "+ to first order , the total sky emission is modelled as a linear mixture of a few independent processes .",
    "the observation of the sky with detector @xmath0 is then a noisy linear mixture of @xmath1 components : @xmath2 where @xmath3 is the emission template for the @xmath4th astrophysical process , herein referred to as a _ source _ or a _",
    "component_. the coefficients @xmath5 reflect emission laws while @xmath6 accounts for noise .",
    "when @xmath7 detectors provide independent observations , this equation can be put in vector - matrix form : @xmath8 where @xmath9 and @xmath10 are vectors of length @xmath7 , @xmath11 is a vector of length @xmath1 , and a is the @xmath12 mixing matrix .",
    "given the observations of such a set of independent detectors , component separation consists in recovering estimates of the maps of the sources @xmath13 .",
    "explicit component separation has been investigated first in cmb applications by @xcite , @xcite , and @xcite . in these applications",
    ", recovering component maps is the primary target , and all the parameters of the model ( mixing matrix @xmath5 , noise levels , statistics of the components , including the spatial power spectra ) are assumed to be known and used as priors to invert the linear system .",
    "recent research has addressed the case of an imperfectly known mixing matrix .",
    "it is then necessary , to estimate it ( or at least some of its entries ) directly from the data .",
    "for instance , tegmark _ et al .",
    "_ assume power law emission spectra for all components except cmb and sz , and fit spectral indices to the observations @xcite .",
    "more recently , blind source separation or independent component analysis ( ica ) methods have been implemented specifically for cmb studies . the work of @xcite , further extended by @xcite implements a blind source separation method exploiting the non  gaussianity of the sources for their separation , which permits to recover the mixing matrix @xmath14 and the maps of the sources .",
    "delabrouille et al .",
    "@xcite propose an approach exploiting the spectral diversity of components , with the new point of view that spatial power spectra are actually the main unknown parameters of interest for cmb observations .",
    "the estimation of a set of parameters of the model , among which the spatial power spectra of the components , is made using a set of band - averaged spectral covariance matrices in fourier space .",
    "while working in the fourier domain has a number of advantages , it also has a number of drawbacks .",
    "when components or noise are strongly non - stationary , one may wish to avoid the averaging induced by fourier transforms .",
    "in addition , when dealing with real - life observations , quite often the coverage is incomplete for a reason or another .",
    "either the instrument observes only a fraction of the sky , or some regions of the sky have to be rejected due to localised strong astrophysical sources of contamination : compact radiosources or galaxies , strong emitting regions in the galactic plane .",
    "blind component separation ( and in particular estimation of the mixing matrix ) , as discussed by cardoso @xcite , can be achieved in several different ways .",
    "the first of these exploits non - gaussianity of all but possibly one components .",
    "however , this is not recommended for mixtures where one component is close to gaussian and all observations suffer from additive gaussian noise .",
    "the component separation method of baccigalupi @xcite and maino @xcite is based on this method .",
    "the second , which exploits spectral diversity ( or non - stationarity in fourier domain ) , has the advantage that detector ",
    "dependent beams can be handled easily , since the convolution with a point spread function in direct space becomes a simple product in fourier space .",
    "smica is an extension of this approach to noisy observations .",
    "finally , the third method exploits non - stationarity in real space .",
    "it is adapted to situations where components are strongly non - stationary in real space .    as an extension of these last two methods ,",
    "it is natural to investigate the possible benefits of exploiting both non - stationarity and spectral diversity for blind component separation using wavelets .",
    "indeed wavelets are powerful tools in revealing the spectral content of non - stationary data . in what follows , we first recall in section [ smica ] the fundamental principles of spectral matching ica .",
    "then , after a brief reminder of the _  trous _ wavelet transform , we discuss in section [ wavelets ] the extension of smica for component separation in wavelet space in order to deal with non - stationary data . considering the problem of incomplete data as a model case of practical significance for the comparison of smica and its extension wsmica , numerical experiments and results",
    "are reported in section [ simulations ] .",
    "from these , conclusions are drawn in section [ conclusion ] .",
    "this paragraph recalls the main hypotheses and equations of the smica algorithm which we actually extended to deal with gapped data .",
    "for ease of presentation , we concentrate on the 1d case since the extension to two dimensional data is straightforward . detailled descriptions and discussions of this method can be found in @xcite and results of previous applications to cmb analysis can be read in @xcite .",
    "spectral matching ica is a blind source separation technique that overcomes the inseparability of gaussian sources using standard ica methods by relying on their assumed spectral diversity : smica allows us to recover independent gaussian colored sources from observed noisy mixtures provided their spectra are substantially not proportional @xcite .",
    "+ considering the linear instantaneous mixing model with additive noise defined by ( [ model1 ] ) , with the assumption that noise and source processes are centered , stationary and independent , and denoting @xmath15 , @xmath16 and @xmath17 the spectral covariances of @xmath9 , @xmath11 and @xmath10 respectively , it follows from ( [ model1 ] ) that for any value of the reduced frequency @xmath18 $ ] , @xmath19 when we further assume independence between source and noise processes .",
    "clearly , independence also implies that @xmath16 and @xmath17 are diagonal matrices .",
    "+ given a batch of @xmath20 regularly spaced experimental data samples @xmath21 and a set @xmath22 of q different reduced frequencies chosen _ a priori _ , estimates @xmath23 of @xmath24 of the spectral covariance at these frequencies can be computed easily in a number of ways .",
    "the basic idea of spectral matching is to fit the model covariances of equation ( [ model2 ] ) to these experimental covariances by minimizing , over all or a subset of the model parameters @xmath25 , the functional @xmath26 where @xmath27 is a measure of the divergence between two covariance matrices , and @xmath28 are weights which depend on @xmath29 .",
    "this adjustment results in estimates @xmath30 of the model parameters and hence enables us to achieve the desired source separation .",
    "it is worth highlighting that resorting to covariances highly reduces data dimension , which is of great interest to astrophysical applications where data sets tend to become very large .",
    "moreover , it may be argued in the stationary gaussian case that this reduction is without significant loss of information @xcite .",
    "+ although any reasonable set of weights @xmath28 and divergence @xmath27 can be used in ( [ cost1 ] ) to assess spectral mismatch , this will affect the statistical properties of the estimated model parameters @xmath30 .",
    "deriving a mismatch criterion from higher statistical principles such as maximum likelihood should lead to better such estimates .",
    "+ in the smica method , the divergence @xmath31 used is given by @xmath32 which actually derives from the kullback - leibler divergence between two centered gaussian distributions with size @xmath33 covariance matrices @xmath34 and @xmath35 . moreover , assuming constant source @xmath36 and noise @xmath37 power spectra , over frequency domains @xmath38}$ ] , smica uses refined unbiased estimates @xmath39 of the mixture covariance matrices @xmath40 defined by : @xmath41 where @xmath42 is the discrete fourier transform of @xmath9 , @xmath43 the @xmath44 are non - overlapping domains in @xmath45 $ ] , symmetric with respect to zero , with their positive parts centered on @xmath46 , and @xmath47 is the number of @xmath48 that fall in @xmath44 .",
    "it follows from this definition that the entries of @xmath39 are in fact all real .",
    "the statistical grounds and implications of these choices are explored in @xcite where it is shown that smica can be derived asymptotically from the maximum likelihood principle in the particular case of stationary processes in the whittle approximation .",
    "this latter approximation asserts that the fourier coefficients @xmath49 of a stationary process @xmath50 are asymptotically gaussian , uncorrelated , centered with spectral covariance equal to @xmath51 .    as a result ,",
    "the model covariance ( [ model2 ] ) is finally rewritten as : @xmath52 and the derived spectral matching criterion is given by @xmath53 to be minimized with respect to the new set of parameters @xmath54 .",
    "+ the previous definitions are easily extended for the method to be applied to real images .",
    "the above @xmath44 are naturally replaced by 2d domains in the frequency plane @xcite .",
    "these are best chosen , based on available prior information relative to source spectra , to enhance spectral diversity @xcite .",
    "regarding our application to cmb analysis , the supposed spatial stationarity and isotropy of the sources strongly suggests taking rings centered on the null frequency which are finally simply described as 1d frequency bands .",
    "+ an especially important limiting case , for simulation purposes , is when the mixing matrix is square and invertible , and when the mixtures are assumed without noise .",
    "then , as shown in @xcite , the likelihood can be directly related to a joint diagonalization criterion of spectral covariance matrices for which an efficient optimization algorithm is actually available .",
    "+      finding the model closest to the data in the sense of smica s objective function benefits from the latter s connection to the maximum likelihood principle and indeed the em algorithm is shown to be a fruitful search method in @xcite where it is fully described . actually , this latter algorithm was slightly modified in order to deal with the case of colored noise @xmath10 in ( [ model1 ] ) .",
    "another useful enhancement was to allow for constraints to be set on the model parameters so that prior information such as bounds on some entries of the mixing matrix @xmath14 could be included .",
    "the details of this constrained em algorithm are given in appendix [ annexe1 ] .",
    "+ eventually , using the em algorithm in simulation , it appeared that after a quick start , convergence slowed down dramatically in a second stage possibly owing to poor signal to noise ratio in some frequency bands . in order to speed convergence back up ,",
    "it was found profitable to alternately use fixed numbers of em steps and bfgs steps @xcite in a heuristic procedure .",
    "+ an unavoidable issue in optimization is that of initiating the search method and this , obviously , is most critical when the function to be optimized is strongly suspected to be multimodal .",
    "such may very well be the case with ( [ cost1 ] ) .",
    "this point though is left aside in what follows since our prime interest is in the study of the statistical performances of different estimators of the model parameters @xmath55 . in the simulations discussed further down ,",
    "the optimal values of the parameters are sought starting from the true mixing matrix and the spectral covarinces estimated from the initial separate source and noise maps .",
    "+      as by - products of the smica method , estimates @xmath56 and @xmath57 of the different signal and noise covariances are obtained in the model fitting step and can be used for reconstructing the source maps _ via _ wiener filtering the data maps in fourier space , in each frequency band @xmath58 : @xmath59 in the limiting case where noise is small compared to signal components , @xmath60 is negligible and the above filter reduces to @xmath61 which is also the generalized least square solution under gaussian statistics .",
    "note however that the wiener filter is only one possibility among others for inverting ( [ model1 ] ) .",
    "its optimality is true in the restricted case of gaussian noise and signal processes . in real case applications , other inverting schemes",
    "should also be experimented @xcite .",
    "the smica method for spectral matching in fourier space has proven to be a very powerful tool for cmb spectral estimation in multidetector experiments .",
    "it is particularly useful to identify and remove residuals of poorly known correlated systematics and astrophysical foreground emissions contaminating cmb maps .",
    "however , smica suffers from several practical difficulties when dealing with real data .",
    "indeed , actual components are known to depart slightly from the ideal linear mixture of equation ( [ model1 ] ) .",
    "the mixing matrix ( in particular those columns of @xmath14 which correspond to galactic emissions ) is known to depend somewhat on the direction of observation or on spatial frequency .",
    "measuring the dependence @xmath62 is of interest for future experiments as planck , and can not be achieved directly with smica .",
    "further , the components are known to be both correlated and non stationary .",
    "for instance , galactic dust emissions are strongly peaked towards the galactic plane .",
    "a fourier ( or spherical harmonics ) transform inevitably mixes contributions from high galactic sky , nearly free of foreground contamination , and contributions from within the galactic plane .",
    "noise levels themselves may be quite non stationary , with high snr regions observed for a long time and low snr regions poorly observed .    when there are sharp edges on the maps or gaps in the data , corresponding to unobserved or masked regions , spectral estimation using the periodogram or the daniell - like smoothed periodogram as in ( [ esti1 ] ) is also not the most satisfactory procedure . although apodizing windows may help cope with edge effects in fourier analysis , they are not very straightforward to use in the case of arbitrarily shaped 2d maps with arbitrarily shaped 2d gaps , such as provided by the archeops experiment @xcite",
    ". clearly , the spectral analysis of gapped data requires tools different from those used to process full data sets , if only because the hypothesized stationarity of the data is greatly disturbed by the missing samples .",
    "+ common such methods often amount to first trying to fill the gaps with estimates of the missing samples and then using standard spectral estimators .",
    "however , the data interpolation stage is critical and can not be completed without prior assumptions on the data @xcite .",
    "we prefered to rely on methods intrinsically dedicated to the analysis of non - stationnary data such as the wavelet transform , widely used to reveal variations in the spectral content of time series or images , as they permit to single out regions in direct space while retaining localization in the frequency domain .",
    "we see next how to reformulate ( [ cost1 ] ) so to take advantage of wavelet transforms when dealing with non - stationary data .",
    "a particular case in which wavelets are shown to be an especially powerful tool is that of incomplete data .",
    "note that in what follows , the locations of the missing samples are always known .",
    "+      we give here the necessary background on the _  trous _ algorithm which , among the several possible wavelet transform implementations , is the one we retained in our simulations . with",
    "the compact supported cubic @xmath63 spline as scaling function @xmath64 , or its 2d quasi - isotropic extension @xmath65 , the _  trous _ algorithm has been shown to be well suited to the analysis of atrophysical data where translation invariance is desirable and the accent is seldom set on data compression @xcite . for",
    "this choice of scaling function , the scaling equation ( [ scalingequation ] ) is satisfied and therefore fast implementations of the decomposition and reconstruction steps of the _  trous _ tranform are available @xcite .",
    "+ consider for instance a sampled 1d signal @xmath66 of length @xmath20 .",
    "the _  trous _ algorithm recursively produces smoother approximations @xmath67 to @xmath68 on a dyadic resolution scale using a low - pass filter @xmath69 according to : @xmath70 where @xmath71 is actually the set of coefficients in the scaling equation for the cubic spline : @xmath72 we note that each @xmath67 is the same size as the original data @xmath68 and that the lowest resolution @xmath73 is obviously limited by data size @xmath20 .",
    "then , taking the difference between two consecutive approximations gives the details at that scale or the wavelet coefficients @xmath74 where the wavelet function @xmath75 is defined by : @xmath76 the @xmath77 s and @xmath67 s given using the _  trous _",
    "algorithm actually are obtained by passing the original signal @xmath68 through a set of finite impulse response ( fir ) filters @xmath78 .",
    "an essential property of these filters is that an inverse transform exists .",
    "in fact , reconstruction results simply from adding all the wavelet scales together with the last smooth approximation : @xmath79    the above _ ",
    "algorithm is easily extendable to two - dimensional images : @xmath80 and the reconstruction is still a simple co - addition of the wavelet scales and the smooth array : @xmath81    the use of the @xmath63 spline leads to a convolution with the @xmath82 mask @xmath69 : @xmath83 but it is faster to compute the convolution in a separable way ( first on rows , and then on the resulting columns ) .",
    "consider the set of ideal band pass filters @xmath84 associated with non - overlapping frequency domains @xmath44 as used by the fourier space implementation of smica .",
    "let @xmath85 denote the stationary gaussian random processes obtained by passing the observations @xmath9 of size @xmath86 through filter @xmath84 .",
    "let @xmath87 be their fourier coefficients .",
    "because of the unitary property of the fourier transform , considering a batch of @xmath20 samples @xmath88 , the following equality between joint probabilities holds : @xmath89 assuming uncorrelated fourier coefficients as in the above mentioned maximum likelihood derivation of smica based on the the whittle approximation , and because of the non - overlapping filters , it follows that the @xmath90 for different @xmath29 s are also decorrelated so that : @xmath91 and that @xmath92 : @xmath93    now define mixture , source and noise covariances @xmath94 , @xmath95 and @xmath96 in the time domain at the output of the above filters . the former matrices can be estimated from the available data using : @xmath97 and nothing opposes attempting component separation by spectral matching in the time domain using these latter covariances by minimizing @xmath98 with respect to @xmath99 , provided the estimated covariances are full rank matrices .",
    "however , deriving adequate weights @xmath28 in order to get a good approximation of the likelihood is not straightforward because of the correlations between the @xmath90 s at different @xmath100 s .",
    "in fact , owing to these correlations , the convergence of @xmath101 to @xmath94 can be very slow .",
    "the helpful point equation ( [ weights ] ) actually makes is that taking @xmath102 will correctly reflect our confidence in the estimated covariances @xmath101 .",
    "+ the next step is obviously to use another set of filters in place of the ideal band pass filters used by smica .",
    "in fact , in dealing with non stationary data or , as a special case , with gapped data , it is especially attractive to consider finite impulse response filters .",
    "indeed , provided the response of such a filter is short enough compared to data size @xmath20 and gap widths , not all the samples in the filtered signal will be affected by the gaps . therefore , using these latter samples exclusively , one may expect better estimation of the statistical properties of the original data _",
    "i.e. _ without the gaps .",
    "we choose in what follows to use filters @xmath78 ( see figure [ filtres2 ] ) and the wavelet _  trous _ algorithm described previously .",
    "an immediate consequence of this choice is that the decorrelation between the different filter outputs no longer holds , due to their overlapping responses in fourier space .",
    "however , we do benefit from the fast filtering algorithms and , which is quite significant , from the possibility of reconstructing estimated source templates .",
    "+ let us consider again a batch of @xmath20 regularly spaced data samples @xmath21 .",
    "possible gaps in the data are simply described with a mask @xmath103 _ i.e. _ a vector of zeroes and ones the same length as @xmath9 with ones corresponding to samples outside the gaps . denoting @xmath104 and @xmath105 the wavelet scales and smooth approximation of @xmath9 , obtained with",
    "the _  trous _ transform and @xmath106 the masks for the different scales determined from the original mask @xmath107 knowing the different filter lengths , wavelet covariances are estimated as follows : @xmath108 where @xmath109 is the number of non zero samples in @xmath110 .",
    "with source and noise covariances @xmath111 defined in a similar way , the covariance model in wavelet space becomes @xmath112 and minimizing @xmath113 with respect to the model parameters @xmath114 achieves the desired component separation .",
    "+ however , in order for @xmath115 to be a good approximation to the likelihood , the weights @xmath28 again have to be determined with care . these weights should account for the correlations between wavelet coefficients from different or the same scales , especially in the lower frequencies .",
    "actually , exagerating the so - called decorrelating property of the wavelet transform , we assume coefficients from different scales are uncorrelated .",
    "nevertheless , coefficients from one same scale are strongly correlated , especially with the adopted _  trous _ redundant transform . then , in the case of complete data sets",
    "i.e. _ without gaps , and because the 1d wavelet filter length in the time domain doubles from scale to scale , the transposition of equation ( [ weights ] ) leads to taking : @xmath116 in the 2d case , this becomes : @xmath117 however , when there are gaps in the data , the fourier modes can be strongly correlated and the whittle approximation is no longer appropriate . in order to derive an approximate likelihood function , consider the orthogonal discrete wavelet transform . in the 1d case",
    ", this is a non - redundant transform in which the number of coefficients is halved from scale to scale .",
    "it is common and quite convenient to assume these coefficients are uncorrelated . denoting @xmath118 the number of dwt coefficients unaffected by the gaps in scale @xmath119 ,",
    "these have the same statistical significance or information content as the @xmath120 coefficients in scale @xmath119 determined with the _  trous _ wavelet transform .",
    "finally , a good approximation to the likelihood is obtained taking @xmath121 or , in the 2d case , : @xmath122 in equation ( [ cost_wavelet ] ) .",
    "we will refer to this combination of principles from smica and wavelet transforms as wsmica .",
    "+ a point to be stressed here is that the number of bands in the case of wsmica is very much limited by the original data size , which is not as strongly the case with smica . but",
    "this limitation is mostly a requirement for reconstruction using ( [ wiener ] ) and ( [ iwt ] ) to make sense .",
    "if the mixing matrix @xmath14 is a parameter of greater interest and if there is no real need to estimate source maps @xmath11 , then there is no objection in principle to using more redundant transforms such as the continuous wavelet transform , or in fact any set of linear filters ( of finite impulse response to cope easily with edges and gaps ) .",
    "this in turn raises the question of optimally choosing this set of filters as in @xcite .",
    "used in the simulations described further down .",
    "the vertical dotted lines for @xmath123 delimit the five frequency bands used with smica in these simulations .",
    ", width=264 ]",
    "the methods described above were applied to synthetic observations consisting of @xmath124 mixtures of @xmath125 components namely cmb , galactic dust and sz emissions for which typical templates , shown on figure [ templates ] , were obtained as described in @xcite .",
    "+     +   +   +    the templates , and thus the mixtures in each simulated data set , consist of @xmath126 pixel maps corresponding to a @xmath127 field located at high galactic latitude .",
    "the six mixtures in each set mimic observations that will eventually be acquired in the six frequency channels of the planck - hfi on part - sky , local maps .",
    "the entries of the mixing matrix @xmath14 used in these simulations actually are estimated values of the electromagnetic emission laws of the original components at @xmath128 , @xmath129 , @xmath130 , @xmath131 , @xmath132 and @xmath133 .",
    "these values are grouped in table [ matrixa ] .",
    "+    white gaussian noise was added to the mixtures according to equation ( [ model1 ] ) in order to simulate instrumental noise . while the relative noise standard deviations between channels were set according to the nominal values of the planck hfi , we experimented five _ global _ noise levels at @xmath134 , @xmath135 , @xmath136 , @xmath137 and @xmath138  db from nominal values .",
    "table [ energie1 ] gives the typical energy fractions that are contributed by each of the @xmath139 original sources and noise , to the total energy of each of the @xmath140 mixtures , considering planck nominal noise variance .",
    "in fact , because smica and wsmica actually work on spectral bands , a much better indication of signal to noise ratio in these simulations is given by figure [ mixtures1 ] where it is shown how noise and source energy contributions distribute with respect to frequency in the six mixtures .",
    "+                 finally , in order to investigate the benefits of using wsmica in place of smica when gaps are inserted in the data , the mask shown on figure [ masks ] was applied onto the mixture maps .",
    "the case where no data is missing was also considered for the sake of comparison . in each of these two particular configurations , spectral matching was assessed and optimized both at the output of the five wavelet filters @xmath141 associated to higher frequency details , and on the corresponding five bands in fourier space , as shown on figure [ filtres2 ] .",
    "this latter choice of frequency bands is simply made to ease comparison between smica and wsmica .",
    "it may be argued that this choice is probably not optimal to run smica .",
    "but , in fact , the optimal selection of filters is clearly a meaningful question both for smica and wsmica .",
    "this will require further investigation .",
    "+                  preliminary experiments were conducted in the case of vanishing instrumental noise variance , with a square @xmath142 mixing matrix .",
    "it was mentioned before that in this limit , the spectral matching objective boils down to the joint diagonalization of covariance matrices .",
    "further , taking the mixing matrix to be the identity matrix ( _ i.e. _ try to separate sources which are not actually mixed ) , it is possible to gain some insight on the spectral diversity of the independent sources , for a given choice of bands or filters .",
    "indeed , the performance of the independent component separation methods based on spectral matching depend highly on spectral diversity .",
    "+   + the following steps were repeated 1000 times : +    *   randomly pick one of each component maps out of the available 200 cmb maps , 30 dust maps and 1500 sz maps . *   calculate covariance matrices in the five wavelet or fourier bands , both with and without masking part of the maps , as is all described above . *",
    "normalize each source so that its total energy over the five bands is equal to one .",
    "* use the algorithm in @xcite to jointly diagonalize the covariances in each configuration , and keep the resulting separating matrices .",
    "+    if the sources have satisfactory spectral properties , the obtained separating matrices should not depart drastically from the identity matrix . moreover , denoting @xmath143 any invertible @xmath142 mixing matrix , and @xmath144 the resulting separating matrix , it is shown in @xcite that the variances of the off - diagonal terms in @xmath145 depend only on spectral diversity , in the case of gaussian sources .",
    "in fact , to assess the effect of any non - gaussianity or non - stationarity in the source templates , the same experiment was repeated on gaussian maps generated with the same spectra as the cmb , dust and sz components . in any case , the independent source components are separated using : @xmath146 so that with the above normalization , the square of any off - diagonal term @xmath147 is directly related to the residual level of component @xmath4 in the recovered component @xmath119 .",
    "+        the histograms on figure [ histo_cmb ] are for the off diagonal term corresponding to the residual corruption of cmb by _ gaussian _ dust in the second set of experiments . in tables",
    "[ res2 ] and [ res3 ] , the results obtained with the synthetic component maps are given as well as those obtained with the gaussian maps , in terms of the standard deviations of the off - diagonal entries @xmath147 defined by ( [ sep1 ] ) .",
    "+ interestingly , when working on gaussian maps without masks , using covariances in fourier space or in wavelet space gives similar performances .",
    "it is also satisfactory , when covariances in wavelet space are used with gaussian maps , that each computed standard deviation only slightly increases when a mask is applied on the data . indeed , as a consequence of incomplete coverage , there are less samples from which to estimate the covariances .",
    "this increase is also observed when covariances in fourier space are used with the gaussian maps but it can be as high as five - fold and it does not affect all coefficients the same way .",
    "although this can again be attributed to the reduced data size , the lowered spectral diversity between components , because of the correlations and smoothing induced in fourier space by the mask , is also part of the explanation .",
    "in fact , as shown on figure [ mixtures1 ] , cmb and dust spatial power spectra are somewhat similar , _",
    "i.e. _ show low spectral diversity , and further smoothing can only degrade the performance of the source separation algorithm based on fourier covariances .",
    "+ in the case of realistic component maps , we note first that the comparison of the performance of component separation using wavelet covariances with and without mask again agrees with the different data sizes , which is not the case with covariances in fourier space .",
    "next , whether covariances in fourier or wavelet space are used , we note that the terms coupling cmb and dust are again much higher in magnitude , even on complete maps .",
    "it seems that the actual non - stationarity and non - gaussianity of the realistic component maps are relevant issues .",
    "another point is that the cmb and dust templates as in figure [ templates ] exhibit sharp edges compared to sz and this inevitably disturbs spectral estimation using a simple dft . to assess this effect ,",
    "simulations were also conducted where the covariances in fourier space were computed after an apodizing hanning window was applied on the complete data maps .",
    "the results reported in table [ res2 ] , to be compared to table [ res3 ] , do indicate a slightly positive effect of windowing , but still the separation using wavelet covariances appears better .",
    "+   +      the above preliminary results clearly point out in the noiseless case the advantageous use of wavelets to easily escape the very bad impact that gaps and sharp edges actually have on the performance of the source separation using covariances in fourier space .",
    "hence this is strong encouragement to move on to investigating the effect of additive noise on the mixture maps according to ( [ model1 ] ) , using smica and its extension wsmica .",
    "we note that although in the case of wsmica the link with maximum likelihood is not as strongly asserted as with smica , the optimization algorithm used in the simulations hereafter consists in both cases of the same heuristic succession of em and bfgs steps and initialization is done as discussed in paragraph [ optim ] .",
    "+ picking at random one of each component maps out of the available 200 cmb maps , 30 dust maps and 1500 sz maps , @xmath148 synthetic mixture maps were generated as previously described , for each of the 5 noise levels chosen .",
    "then , component separation was conducted using the spectral matching algorithms smica and wsmica both with and without part of the maps being masked .",
    "now , each run of smica and wsmica on the data returns estimates @xmath149 and @xmath150 of the mixing matrix",
    ". clearly , these estimates are subject to the indeterminacies inherent to the instantaneous linear mixture model ( [ model1 ] ) . indeed , in the case where optimization is over all parameters @xmath55 , it is obvious that any simultaneous permutation of the columns of @xmath14 and of the lines of @xmath11 leaves the model unchanged .",
    "the same occurs when exchanging a scalar possibly negative factor between any column in @xmath14 and the corresponding line in @xmath11 .",
    "therefore , columnwise comparison of @xmath149 and @xmath150 to the original mixing matrix @xmath14 requires first fixing these indeterminacies .",
    "this is done by hand after @xmath149 and @xmath150 have been normalized columnwise .",
    "+                the results we report next concentrate on the statistical properties of @xmath149 and @xmath150 as estimated from the 1000 runs of the two competing methods in the several configurations retained .",
    "in fact , the correct estimation of the mixing matrix in model ( [ model1 ] ) is a relevant issue for instance when it comes to dealing with the cross calibration of the different detectors .",
    "figures [ cmb_emis ] , [ dust_emis ] and [ sz_emis ] show the results obtained , using the quadratic norm @xmath151 with @xmath152 and @xmath153 , to assess the residual errors on the estimated emissivities of each component .",
    "the plotted curves show how the mean of the above positive error measure varies with increasing noise variance . for the particular case of cmb , table [ res4 ]",
    "gives the estimated standard deviations of the relative errors @xmath154 on the estimated cmb emissivity in the six channels of planck s hfi in the different configurations retained .",
    "+    closer to our source separation objective , a more significant way of assessing the quality of @xmath149 and @xmath150 as estimators of the mixing matrix @xmath14 , would be to use the following signal to interference ratio : @xmath155 where the @xmath156 are the source variances and @xmath157 with @xmath158 the noise covariance .",
    "the plots on figures [ cmb_res ] , [ dust_res ] and [ sz_res ] show how the mean isr from the 1000 runs of smica and wsmica in different configurations , varies with increasing noise .",
    "we note again that the performance of wsmica behaves as expected when noise increases and if part of the data is missing .",
    "however this is not always the case with smica .",
    "finally this set of simulations , conducted in a more realistic setting with respect to esa s planck mission , again confirms the higher performance , over fourier analysis , that we indeed expected from the use of wavelets .",
    "the latter are able to correctly grab the spectral content of partly masked data maps and from there allow for better component separation .",
    "this paper has presented an extension of the spectral matching ica algorithm to the case where the collected data is both correlated and non stationary , considering maps with gaps as a particular instance of practical significance .",
    "it was shown that simply substituting covariance matching in fourier space by covariance matching in wavelet space enables to cope in the most general and straightforward way with gaps of possibly any shape .",
    "mainly , it is the fir nature of the wavelet filters used that allows the impact of edges and gaps on the estimated covariances and hence on component separation to be lowered .",
    "optimally choosing the fir filter - bank regarding a particular application is a possible further enhancement .",
    "+ results obtained with simulated astrophysical data as expected from the planck mission were given and these confirm the benefits of correctly processing existing gaps .",
    "clearly , other possible types of non - stationarities in the collected data such as spatially varying noise or component variance , etc . can be dealt with very simply in a similar fashion using the wavelet extension of smica .",
    "+ in the cmb application , the mixed components have quite different statistical properties : some are expected to be very close to gaussian whereas others are strongly non gaussian .",
    "standard ica methods exploit the non gaussianity of the mixed components . however , it is not clear yet how best to combine non gaussianity and spectral diversity in order to perform better source separation .",
    "other features of wavelets which are known to be powerful tools for the analysis and sparse representation of structured data might reveal useful here .",
    "considering @xmath159 separate frequency bands of size @xmath47 with @xmath160 , the em functional derived for the instantaneous mixing model ( [ model1 ] ) with independent gaussian stationary sources @xmath11 and noise @xmath10 is : @xmath161 with @xmath162 and @xmath163 .",
    "the maximization step of the em algorithm seeks then to maximize @xmath164 with respect to @xmath165 and the optimal @xmath165 is used as the value for @xmath55 at the next em step , and so on until satisfactory convergence is reached .",
    "explicit expressions are easily derived for the optimal @xmath165 in the white noise case where an interesting decoupling occurs between the re - estimating equations for noise variances , source variances and the mixing matrix @xcite .",
    "+      when @xmath14 is subject to linear constraints , the joint maximization of the em functional with respect to all model parameters is no longer easily achieved in general .",
    "in fact , one can not simply decouple the re - estimating rules for the noise parameters and the mixing matrix and these have to be optimized separately .",
    "we give next the modified re - estimating equations for the mixing matrix and the source variances in the case of constant noise ( _ i.e. _ @xmath166 ) .",
    "+ first , let us exhibit the quadratic dependence of the em functional @xmath167 on @xmath168 : @xmath169 where @xmath170    * in the white noise case * , @xmath171 , equation ( [ em1 ] ) becomes : @xmath172 where : @xmath173 again , this can be re - written as : @xmath174 where : @xmath175 @xmath176 with `` @xmath177 '' , we build a column vector with the entries of a matrix taken along its lines .",
    "now let us consider linear constraints on the mixing matrix , specified as follows : @xmath178 where @xmath179 is a matrix with as many columns as constraints , and the columns of @xmath179 are the same size as @xmath143 .",
    "the maximum of the em functional with respect to @xmath165 subject to the specified linear constraints is then reached for : @xmath180 and @xmath181 where `` @xmath182 '' returns a matrix with the same diagonal entries as its input argument . + * in the free noise case * , things are quite similar except that the noise covariance matrices @xmath183 do not factorize out as nicely . the em functional",
    "is again expressed as : @xmath174 where in this case : @xmath184 and @xmath185 then , the maximum of the em functional with respect to @xmath165 subject to the specified linear constraints is again reached for : @xmath180 and @xmath181    these expressions of the re - estimates of the mixing matrix can become algorithmically very simple when for instance the linear constraints to be dealt with affect separate lines of @xmath14 , or even simpler when the constraints are such that the entries of @xmath14 are affected separately .",
    "suppose a subset of entries of @xmath14 are constrained to be positive .",
    "the maximization step of the em algorithm on @xmath14 alone , again has to be modified .",
    "we suggest dealing with such constraints in a combinatorial way rephrasing the problem in terms of equality constraints .",
    "if the unconstrained maximum of the em functional is not in the specified domain , then one has to look for a maximum on the borders of that domain : on a hyperplane , on the intersection of two , or three , or more hyperplanes .",
    "one important point is that the maximum of the em functional with respect to @xmath14 subject to a set of equality constraints will necessarily be lower than the maximum of the same functional considering any subset of these equality constraints . hence , not all combinations need be explored , and a branch and bound type algorithm is well suited @xcite .",
    "a straightforward extension allows to deal with the case where a set of entries of the mixing matrix are constrained by upper and lower bounds .",
    "j.  delabrouille , j .- f .  cardoso and g.  patanchon , `` multi - detector multi - component spectral matching and application for cmb data analysis '' , _",
    "mon . not .",
    "r. astron .",
    "_ , vol .  346 , no  4 , pp .  1089 - 1102 , 2003 .    c.  baccigalupi , l.  bedini et al .",
    ", `` neural networks and separation of cosmic microwave background and astrophysical signals in sky maps '' , _ mon . not .",
    "r. astron .",
    "soc . _ , vol .",
    "318 , no  3 , pp.769 - 780 , 2000 .",
    "cardoso , h.  snoussi et al .",
    ", `` blind separation of noisy gaussian stationary sources .",
    "application to cosmic microwave background imaging . '' _ proc .",
    "eusipco 2002 _ , pp .  561 - 564 , toulouse ( france ) , 2002 .",
    "a.  benoit et al .",
    ", `` archeops : a high resolution , large sky coverage balloon experiment for mapping cosmic microwave background anisotropies '' , _ astroparticle physics _ , vol .",
    "17 , no  2 , pp  101 - 124 , 2002 ."
  ],
  "abstract_text": [
    "<S> it is a recurrent issue in astronomical data analysis that observations are unevenly sampled or incomplete maps with missing patches or intentionaly masked parts . </S>",
    "<S> in addition , many astrophysical emissions are non stationary processes over the sky . hence spectral estimation using standard fourier transforms </S>",
    "<S> is no longer reliable . </S>",
    "<S> spectral matching ica ( smica ) is a source separation method based on covariance matching in fourier space which is successfully used for the separation of diffuse astrophysical emissions in cosmic microwave background observations . </S>",
    "<S> we show here that wavelets , which are standard tools in processing non stationary data , can profitably be used to extend smica . among possible applications </S>",
    "<S> , it is shown that gaps in data are dealt with more conveniently and with better results using this extension , wsmica , in place of the original smica . </S>",
    "<S> the performances of these two methods are compared on simulated cmb data sets , demonstrating the advantageous use of wavelets .     _ * keywords * : blind source separation , cosmic microwave background , wavelets , data analysis _ </S>"
  ]
}