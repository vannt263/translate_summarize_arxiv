{
  "article_text": [
    "in this paper a _ graph _ @xmath0 may have loops or multiple edges ; it may also contain free loops , which are connected components that contain neither vertices nor edges .",
    "a _ marked graph _ is a graph whose vertex - set has been partitioned into two subsets , either of which may be empty . the vertices in one cell of the partition are _ unmarked _ and the vertices in the other cell are _ marked _ ; in figures we indicate marked vertices with the letter _",
    "c_. if @xmath1 is a marked graph with @xmath2 then the _ boolean adjacency matrix _ @xmath3 is an @xmath4 matrix over the two - element field @xmath5 , with entries @xmath6 if @xmath7 is looped and for @xmath8 , @xmath9 if @xmath7 and @xmath10 are adjacent . for @xmath11",
    "we denote by @xmath12 the matrix obtained from @xmath3 by first changing the @xmath13 diagonal entry whenever @xmath14 , and then removing the @xmath13 row and column whenever @xmath7 is marked and the @xmath13 diagonal entry is 0 .",
    "the _ marked - graph bracket polynomial _ of @xmath1 is defined by the formula @xmath15=d^{\\phi}\\cdot\\sum_{t\\subseteq",
    "v(g)}a^{n-\\left\\vert t\\right\\vert } b^{\\left\\vert t\\right\\vert } d^{\\nu(\\mathcal{a}(g)_{t})},\\ ] ] where @xmath16 is the number of free loops in @xmath1 and @xmath17 is the @xmath5-nullity of a matrix @xcite .",
    "[ ptb ]    flyfig1.ps    an _ oriented regular link diagram _ @xmath18 consists of oriented , piecewise smooth , closed curves in the plane ; the curves intersect ( and self - intersect ) only at a finite number of transverse _ crossings_. there are two kinds of crossings , classical and virtual , with underpassing and overpassing arcs specified at the classical crossings .",
    "a classical crossing has two _ smoothings _ , one denoted @xmath19 and the other denoted @xmath20 , as in figure [ flyfig1 ] . if @xmath18 has @xmath21 classical crossings then it has @xmath22 _ kauffman states _ , obtained by applying either the @xmath19 or the @xmath20 smoothing at each classical crossing . given a state @xmath23 let @xmath24 denote the number of @xmath19 smoothings in @xmath23 , @xmath25 the number of @xmath20 smoothings in @xmath23 , and @xmath26 the number of closed curves in @xmath23 , including any crossing - free components that might appear in @xmath18 .",
    "then the ( three - variable ) _ kauffman bracket polynomial _ of @xmath18 @xcite is @xmath27=\\sum_{s}a^{a(s)}b^{b(s)}d^{c(s)-1}.\\ ] ] the fact that @xmath19 , @xmath20 and @xmath28 are independent variables is indicated by using @xmath29 $ ] rather than the more familiar notation @xmath30 .",
    "these two kinds of bracket polynomials are closely related . a link diagram @xmath31 has an associated _ directed universe _",
    "@xmath32 , a 2-in , 2-out digraph whose vertices correspond to the classical crossings of @xmath18 and whose edges correspond to the arcs of @xmath18 .",
    "( @xmath32 also contains a free loop for each link component that is crossing - free in @xmath18 . ) the undirected version of @xmath32 is denoted @xmath33 .",
    "let @xmath34 be a directed euler system for @xmath32 , i.e. , a set containing one directed euler circuit for each connected component of @xmath33 ; @xmath34 must also contain every free loop of @xmath33 .",
    "@xmath34 is completely determined by specifying the classical crossings at which it does not follow the incident link component(s ) .",
    "we say such crossings are _ marked _ , and we indicate them in figures with the letter _",
    "c_. the _ looped interlacement graph _",
    "@xmath35 @xcite is a marked graph with a vertex for each classical crossing of @xmath18 ; marked vertices correspond to marked crossings , and looped vertices correspond to negative crossings .",
    "two vertices @xmath36 and @xmath37 are adjacent in @xmath35 if and only if they are _ interlaced _ with respect to @xmath34 , i.e. , there is a circuit of @xmath34 on which they appear in the order @xmath38 @xcite .",
    "different choices of @xmath34 may give rise to different graphs @xmath35 , as in  figure [ borr3 ] , but every looped interlacement graph has marked - graph bracket @xmath39 $ ] equal to the kauffman bracket @xmath29 $ ] .    the identity @xmath39=[d]$ ]",
    "is derived from an equality connecting nullities of matrices over @xmath5 with circuits in 4-regular graphs : if @xmath23 is a kauffman state in a link diagram @xmath18 and @xmath40 consists of those vertices where @xmath23 involves the @xmath20 smoothing , then the equality tells us that @xmath41 .",
    "several similar equalities have been discovered independently over the years .",
    "this form of the equality originated as a result about permutations due to cohn and lempel @xcite , but related results appeared much earlier , in brahana s study of curves on surfaces @xcite . later authors worked in combinatorics @xcite or classical knot theory @xcite .",
    "see @xcite for a thorough account .",
    "[ h ]    borr3.ps    for alternating classical link diagrams , the equality connecting nullity and circuits appears implicitly in the relationship between the kauffman bracket and certain combinatorial invariants : the tutte polynomial @xcite , jaeger s transition polynomial @xcite , or the interlace polynomial @xcite .",
    "the tutte polynomial involves the checkerboard graph , and the latter two polynomials involve a directed graph obtained from the universe of a link diagram by reversing the orientation of every second edge .",
    "these relationships also hold for non - alternating classical diagrams , if weighted edges or vertices are used to distinguish between positive and negative classical crossings @xcite .",
    "since kauffman introduced virtual knot theory @xcite , the combinatorial theory associated with the kauffman bracket of classical link diagrams has been extended to virtual link diagrams in several ways . for checkerboard - colorable virtual links , little modification of the classical theory",
    "is needed @xcite . for general virtual links",
    "there is not a direct analogue of the checkerboard graph or the edge - reversed universe graph , but the standard tutte polynomial may be replaced by a `` topological ''  tutte polynomial @xcite , or by a `` relative ''  or `` ported ''  tutte polynomial @xcite .",
    "kauffman s bracket may also be analyzed combinatorially without using any version of the tutte polynomial ; ilyutko and manturov have developed a geometric approach involving atoms and rotating circuits @xcite , and zulli and the present author have developed a graph - theoretic approach using euler circuits , interlacement and marked graphs @xcite .",
    "marked graphs are subject to two important equivalence relations , which generalize natural equivalences between looped interlacement graphs .",
    "the finer of the two equivalence relations generalizes the equivalence between looped interlacement graphs @xmath42 and @xmath43 obtained from a single link diagram @xmath18 .",
    "this equivalence relation is generated by a graph - theoretic operation we call a _ marked pivot _ ; it is a modified version of the pivot operation that describes the effect on interlacement graphs of changing euler systems in 2-in , 2-out digraphs @xcite .",
    "marked pivots preserve the 3-variable marked - graph bracket polynomial .",
    "the coarser of the two equivalence relations generalizes the equivalence between looped interlacement graphs @xmath44 and @xmath45 obtained from different diagrams of the same link type .",
    "this equivalence relation is generated by graph - theoretic versions of the reidemeister moves .",
    "marked - graph reidemeister moves change the 3-variable marked - graph bracket , but they preserve the marked - graph analogue of the jones polynomial , which is obtained ( as usual ) by replacing @xmath19 with @xmath46 , replacing @xmath20 with @xmath47 , replacing @xmath28 with @xmath48 , and multiplying by a suitable factor .",
    "these two equivalence relations are certainly important , for they underlie the knot - theoretic significance of the marked - graph bracket .",
    "nevertheless we pay little attention to them in this paper , because our purpose is not to discuss the relationship between bracket polynomials of different graphs , but rather to discuss the efficient computation of the bracket polynomial of a given graph .",
    "the formulas that define the marked - graph bracket and the three - variable kauffman bracket are quite similar , so it may be surprising that recursive descriptions of the two bracket polynomials are quite different .",
    "the kauffman bracket of a link diagram @xmath18 can be calculated by repeatedly applying a single recursive step : choose a classical crossing in @xmath18 , let @xmath49 and @xmath50 be the two diagrams obtained by smoothing that crossing , and use the formula @xmath29=a[d_{a}]+b[d_{b}]$ ] .",
    "the recursive description of the marked - graph bracket given in @xcite is considerably more complicated ; four different recursive steps are used , in different situations .",
    "for instance , one step removes a loop on an unmarked vertex , at the cost of replacing the graph in question with two smaller graphs ; this particular step is related to the jones polynomial s fundamental identity @xmath51 @xcite .    if we rewrite the definition of the marked - graph bracket polynomial as @xmath15=d^{\\phi}\\cdot\\sum_{t\\subseteq v(g)}(\\prod_{v\\notin t}a)(\\prod_{t\\in t}b)d^{\\nu(\\mathcal{a}(g)_{t})},\\ ] ] then the variables @xmath19 and @xmath20 appear as vertex weights , similar to those that appear in many combinatorial contexts ranging from electrical circuit theory to statistical mechanics .",
    "( for instance , if @xmath52 then @xmath53 $ ] gives the expected value of @xmath54 under the presumption that @xmath55 is chosen by tossing a fair coin @xmath21 times , the @xmath13 toss deciding whether or not @xmath14 . )",
    "the following generalization suggests itself .",
    "[ bracweigh ] suppose @xmath1 is a weighted , marked graph , i.e. , a marked graph given with functions @xmath56 and @xmath57 mapping @xmath58 into some commutative ring @xmath59",
    ". then the _ weighted marked - graph bracket polynomial _ of @xmath1 is @xmath15=d^{\\phi}\\cdot\\sum_{t\\subseteq v(g)}(\\prod_{v\\notin t}% \\alpha(v))(\\prod_{t\\in t}\\beta(t))d^{\\nu(\\mathcal{a}(g)_{t})}%\\ ] ]    if @xmath60 has @xmath61 and @xmath62 then we say @xmath36 has _",
    "standard weights_. if @xmath18 is a link diagram then the vertices of @xmath63 correspond to the classical crossings of @xmath18 , so we may think of @xmath56 and @xmath57 as giving weights for the classical crossings of @xmath18 .",
    "the recursive description of the marked - graph bracket polynomial given in @xcite extends directly to the weighted version of the polynomial .",
    "vertex weights may be used to make the recursion more efficient in several ways .",
    "the most obvious simplification involves the recursive step mentioned above , used to eliminate loops on unmarked vertices ; it is completely unnecessary .",
    "[ loops ] suppose @xmath1 is a weighed , marked graph .",
    "let @xmath64 be the graph obtained by removing every loop from @xmath1 , and reversing the @xmath56 and @xmath57 weights of every looped vertex of @xmath1 .",
    "then @xmath53=[g^{\\prime}]$ ] .",
    "the value of theorem [ loops ] is easy to see : each time we use the theorem instead of a loop - removing recursive step , the recursion proceeds with only one graph to process rather than two .",
    "the weighted marked - graph bracket polynomial also satisfies several analogues of the series - parallel reductions of electrical circuit theory .",
    "these are operations which consolidate certain vertices without changing the value of the bracket . here",
    "is one of them .",
    "[ parallels ] suppose @xmath65 are unlooped twins that form a clique in @xmath1 , i.e. , @xmath65 all have the same neighbors outside @xmath66 and they are all adjacent to each other .",
    "let @xmath67 let @xmath68 be the graph obtained from @xmath69 by ( i ) marking @xmath70 if and only if @xmath71 is even , and ( ii ) changing the weights of @xmath70 to @xmath72 then @xmath53=[(g - v_{2}- ...",
    "-v_{k})^{\\prime}]$ ] .",
    "the value of theorem [ parallels ] is not quite as obvious as that of theorem [ loops ] .",
    "a first impression might be that we are simply replacing @xmath73 vertices with one vertex , but this impression is imprecise because the complicated values of @xmath74 and @xmath75 given in the theorem may be inconvenient .",
    "the computational cost of this inconvenience depends on the implementation of arithmetic operations in the particular ring being used for @xmath59 .",
    "for instance , a  natural example is a ring @xmath59 of polynomials in variables @xmath76 , with the variables used as vertex - weights ; arithmetic in this ring is very expensive because each polynomial involves coefficients of many different monomials .",
    "nevertheless , theorem [ parallels ] clearly has the potential to be of significant value in general .",
    "[ h ]    twins2.ps    the most familiar situation in which theorem [ parallels ] arises involves two coherently oriented strands of a link diagram , twisted around each other to produce @xmath73 classical crossings and some number of virtual crossings .",
    "although the theorem specifies that the vertices are unlooped , negative crossings may be handled simply by reversing their @xmath56 and @xmath57 weights .",
    "an example with @xmath77 appears in figure [ twins2 ] .",
    "( as usual , the circled crossings are virtual . )",
    "if these twisted strands appear in a link diagram @xmath18 with standard weights then the two negative crossings give rise to unlooped vertices of @xmath35 with @xmath78 and @xmath79 , while the positive crossing gives rise to an unlooped vertex with @xmath80 and @xmath81 .",
    "theorem [ parallels ] tells us that the bracket is unchanged if the three vertices of @xmath35 representing the portion of @xmath18  appearing in  figure [ twins2 ] are replaced with one unlooped , unmarked vertex whose weights are @xmath82 and @xmath83 .",
    "this new graph is the looped interlacement graph of a diagram @xmath84 obtained by replacing the pictured portion of @xmath18 with a single positive crossing carrying the indicated weights , and also a single virtual crossing ; the latter is needed whenever the total number of unmarked classical and virtual crossings is even , to ensure that @xmath85 gives rise to an euler system of @xmath84 .    in the classical case  or more generally ,",
    "the checkerboard - colorable case @xcite  twisting two strands around each other produces classical crossings that give rise to series - parallel edges in the checkerboard graphs .",
    "theorem [ parallels ] applies to all virtual link diagrams , not just the checkerboard - colorable ones , but the extra generality comes at a price : the theorem must be adjusted when there are marks on the vertices or non - adjacencies among them , and not all of the adjusted versions are quite so simple .",
    "for instance , if two oppositely oriented strands of a link diagram are twisted around each other to produce a set of @xmath73 unmarked , nonadjacent twins then a dual  of theorem [ parallels ] requires that @xmath73 be odd . see corollary [ parallelsdual ] .",
    "a third use for vertex weights is that graphs constructed from smaller graphs using an appropriate version of cunningham s _ composition _ operation @xcite have bracket polynomials that can be described by modifications of the weights .",
    "[ ptb ]    comp.ps    [ comp]a marked , weighted graph @xmath1 is the _ composition _ of marked , weighted graphs @xmath86 and @xmath87 , @xmath88 , if the following conditions hold .",
    "\\(a ) @xmath89 consists of a single unlooped , unmarked vertex @xmath90 that has standard weights in both @xmath86 and @xmath87 .",
    "\\(b ) the elements of @xmath91 inherit their loops , marks and weights from @xmath86 and @xmath87 .",
    "\\(c ) @xmath92 and @xmath93 .",
    "\\(d ) @xmath86 and @xmath87 do not share any free loop , and the free loops of @xmath1 are those of @xmath86 and @xmath87 .    requiring that @xmath90",
    "have standard weights and be unlooped and unmarked ensures that no significant information is lost when we remove @xmath90 in constructing @xmath94 .",
    "note that definition [ comp ] includes the situation of theorem [ parallels ] : if @xmath86 is a complete graph then @xmath95 is a clique of twins in @xmath94 .",
    "the construction given in definition [ comp ]  may seem to be merely a technical notion from graph theory , but in section 2 we show that it is related to an important knot - theoretic idea : if a link diagram contains a tangle , then the looped interlacement graph is a composition . recall that a subgraph of a graph @xmath1 is _ full _ or _ induced _ if it contains every edge of @xmath1 incident on its vertices .",
    "[ tangle ] suppose a link diagram @xmath18 contains a tangle , and let @xmath34 be any directed euler system for the universe of @xmath18 .",
    "then there are graphs @xmath86 and @xmath87 such that @xmath96 , @xmath95 is the subgraph of @xmath35 induced by the vertices corresponding to crossings outside the tangle , and @xmath97 is the subgraph of @xmath35 induced by the vertices corresponding to crossings inside the tangle . moreover ,",
    "it is possible to choose @xmath34 so that at least one of @xmath98 has no marked vertex adjacent to @xmath90 .",
    "[ tb ]    tanglex.ps    two instances of theorem [ tangle ] are pictured in  figure [ tanglex ] .",
    "observe that @xmath18 contains several tangles in addition to the one indicated by the dashed circle .",
    "the interlacement graph on the left satisfies the last sentence of the theorem for every tangle , as no vertex is marked . the interlacement graph on the right , instead , satisfies the last sentence for some tangles but not for others . for instance , it satisfies the last sentence of the theorem for the indicated tangle , but not for the tangle that contains the two crossings in the lower right - hand corner of the diagram .    for a fixed graph @xmath86 ,",
    "every composition @xmath94 is constructed from @xmath87 in much the same way . in section 5",
    "we prove that similarly , every weighted bracket polynomial @xmath99 $ ] is constructed from bracket polynomials associated with @xmath87 in much the same way .",
    "[ pjoin ] let @xmath86 be a marked , weighted graph with an unlooped , unmarked vertex @xmath90 that has standard weights .",
    "then there are weights @xmath100 , @xmath101 , and @xmath102 that depend only on @xmath86 and @xmath90 , and have the following universal  property : every composition @xmath94 obtained by applying definition [ comp ] to a graph @xmath87 in which no neighbor of @xmath90 is marked has @xmath103=[h^{\\prime}]+[h_{m}^{\\prime}],\\ ] ] where @xmath104 is obtained from @xmath87 by changing the weights of @xmath90 to @xmath105 and @xmath101 , and @xmath106 is obtained from @xmath87 by marking @xmath90 and changing its weights to @xmath102 and @xmath107 .",
    "choosing to have @xmath107 in theorem [ pjoin ] is a matter of convenience rather than necessity .",
    "the proof actually shows that the value of @xmath108 is arbitrary , but the sum @xmath109 must be correct .",
    "that is , for any @xmath110 the theorem still holds if we change @xmath108 from @xmath111 to @xmath112 , and also change @xmath101 to @xmath113 . in particular , theorem [ pjoin ] remains valid if @xmath101 and @xmath114 are interchanged .",
    "it is hard to assess the loss of generality associated with theorem [ pjoin ] s hypothesis that @xmath90 have no marked neighbor in @xmath87 , because vertex marks do not have a special significance in general . for tangles in link diagrams ,",
    "though , the last sentence of theorem [ tangle ] tells us that this hypothesis does not entail any loss of generality as long as we are willing to reverse the roles of @xmath86 and @xmath87 , i.e. , to reverse the inside  and outside  of the tangle .",
    "the idea that tangles are building blocks for classical link diagrams appears in conway s seminal paper @xcite .",
    "this idea leads naturally to the observation that a recursively defined classical link invariant can be calculated in a tangle - based  manner : first eliminate all the crossings inside a particular tangle and then collect like terms , before proceeding to eliminate the crossings inside another tangle .",
    "see @xcite for a detailed analysis of the computational complexity of such a tangle - based calculation of classical link invariants .",
    "the process of building up link diagrams from tangles corresponds to the process of building up checkerboard graphs as 2-sums of smaller graphs , and this correspondence is useful for the kauffman bracket because the tutte polynomial of a 2-sum can be described using the tutte polynomials of the smaller graphs @xcite . the correspondence between tangles and 2-sums was mentioned in @xcite , and its computational significance has recently been analyzed in @xcite .",
    "the result of a tangle - based calculation of the kauffman bracket of a classical diagram containing a tangle @xmath55 may be represented schematically as @xmath115=\\gamma_{1}[\\asymp]+\\gamma_{2}[)(]$ ] , where @xmath116 and @xmath117 are coefficients that result from the collection of terms .",
    "virtual crossings necessitate a third term ; schematically , @xmath115=\\gamma _ { 1}[\\asymp]+\\gamma_{2}[)(]+\\gamma_{3}[\\otimes]$ ] . at first glance",
    "this three - term schematic formula may seem different from the two - term formula of theorem [ pjoin ] , but they are actually quite similar ; each has three degrees of freedom , represented by @xmath118 in the schematic formula and @xmath119 in theorem [ pjoin ] .    formulas for @xmath120 , @xmath121 , and @xmath122 are presented in corollaries [ pjoin1 ] , [ pjoin3 ] and [ pjoin4 ] .",
    "the first two are obtained by using several specific graphs for @xmath87 , and then solving the resulting equations .",
    "the third breaks definition [ bracweigh ] into three sub - sums .",
    "suppose @xmath86 is a marked , weighted graph with an unlooped , unmarked vertex @xmath90 that has standard weights . for @xmath123 let @xmath124 be the graph obtained from @xmath86 by replacing @xmath90 with a vertex @xmath125 whose weights are @xmath126 and @xmath127 .",
    "then @xmath95 , @xmath128 and @xmath129 are compositions @xmath130 , @xmath131 and @xmath132 respectively , where @xmath133 is just @xmath90 and @xmath134 has the two adjacent , unlooped , unmarked vertices @xmath90 and @xmath125 . theorem [ pjoin ] gives three equations .",
    "@xmath135=[f\\ast h^{0}]=[h^{0\\prime}]+[h_{m}^{0\\prime}]=d\\alpha ( a)+\\beta(a)+\\alpha(a_{m})\\ ] ] @xmath136=[f\\ast h^{10}]=[h^{10\\prime}]+[h_{m}^{10\\prime}]=\\alpha ( a)+\\beta(a)+d\\alpha(a_{m})\\ ] ] @xmath137=[f\\ast h^{01}]=[h^{01\\prime}]+[h_{m}^{01\\prime}]=\\alpha ( a)+d\\beta(a)+\\alpha(a_{m})\\ ] ] we deduce the following .",
    "[ pjoin1 ] the weights mentioned in theorem [ pjoin ] are given by these formulas . @xmath138+[f^{10}]+[f^{01}]\\\\ ( 2-d - d^{2})\\beta(a )   & = [ f - a]+[f^{10}]-(d+1)[f^{01}]\\\\ ( 2-d - d^{2})\\alpha(a_{m } )   & = [ f - a]-(d+1)[f^{10}]+[f^{01}]\\end{aligned}\\ ] ]    to assess the computational significance of theorem [ pjoin ] and corollary [ pjoin1 ] , consider that the number of steps in an implementation of the recursive algorithm for calculating @xmath53 $ ] is roughly @xmath139 .",
    "( this is only a rough count rather than a precise determination of computational complexity , because it ignores both the computational cost of arithmetic in @xmath59 and the fact that different branches of a calculation may require different numbers of steps . )",
    "consequently the number of steps involved in a direct computation of @xmath99 $ ] is roughly the product of the numbers of steps involved in separate computations of @xmath140 $ ] and @xmath141 $ ] .",
    "corollary [ pjoin1 ] shows that the weights of @xmath90 and @xmath142 may be calculated using the bracket polynomials of @xmath95 and two graphs that have @xmath143 vertices apiece , so we may estimate the number of steps involved in finding these weights as roughly five times the number of steps involved in finding @xmath140 $ ] .",
    "theorem [ pjoin ] then expresses @xmath99 $ ] as the sum of the bracket polynomials of two @xmath144-vertex graphs ; computing each of these brackets takes roughly twice as many steps as computing @xmath141 $ ] .",
    "all in all , theorem [ pjoin ] and corollary [ pjoin1 ] tell us that a rough upper bound on the number of steps required to compute @xmath99 $ ] is on the order of five times the sum of the numbers of steps required to calculate @xmath140 $ ] and @xmath141 $ ] separately .",
    "five times the sum of two positive integers is generally considerably smaller than the product of the two integers , so  despite the rough counting it is clear that when they are applicable , theorem [ pjoin ] and corollary [ pjoin1 ] can be considerably  more efficient than direct computation .",
    "theorem [ pjoin ] focuses on @xmath86 , but compositions are symmetric and consequently the theorem may be applied to both @xmath86 and @xmath87 , so long as neither contains a marked neighbor of @xmath90 . unlike the hypothesis of theorem [ pjoin ] that only @xmath87 have no marked vertex adjacent to @xmath90 ,",
    "this double hypothesis is a significant restriction even for link diagrams .",
    "the result is still useful , though ; for instance , every classical or virtual knot diagram has an euler system with respect to which there are no marked vertices at all .",
    "[ pjoin2 ] let @xmath145 and @xmath146 be the new weighted vertices associated to @xmath86 and @xmath90 in theorem [ pjoin ] , and let @xmath147 and @xmath148 be the new vertices associated in the same way to @xmath87 and @xmath90 .",
    "( that is , they are obtained by interchanging @xmath86 and @xmath87 in theorem [ pjoin ] . )",
    "if neither @xmath86 nor @xmath87 contains a marked neighbor of @xmath90 then @xmath149=\\alpha(a(f))\\cdot(\\alpha(a(h))+\\beta(a(h)))+\\beta ( a(f))\\cdot(\\alpha(a(h))+\\beta(a(h))d)\\\\ + ( \\alpha(a(f))d+\\beta(a(f)))\\cdot\\alpha(a_{m}(h))\\\\ + \\alpha(a_{m}(f))\\cdot(\\alpha(a(h))d+\\beta(a(h)))+\\alpha(a_{m}(f))\\cdot \\alpha(a_{m}(h)).\\end{gathered}\\ ] ]    the corollary is proven as follows .",
    "let @xmath150 be the graph with two adjacent vertices @xmath90 and @xmath151 , with @xmath151 an unlooped , unmarked vertex carrying the weights of @xmath145 .",
    "let @xmath152 have two adjacent vertices @xmath90 and @xmath153 with @xmath153 an unlooped , marked vertex carrying the weights of @xmath146 .",
    "three applications of theorem [ pjoin ] tell us that @xmath154   & = [ h^{\\prime}]+[h_{m}^{\\prime}]=[h\\ast p_{1}]+[h\\ast p_{1m}]\\\\ & = [ p_{1}^{\\prime}]+[(p_{1}^{\\prime})_{m}]+[(p_{1m})^{\\prime}]+[(p_{1m}% ) _ { m}^{\\prime}].\\end{aligned}\\ ] ]    before proceeding we should express our gratitude to v. o. manturov for his comments and corrections regarding earlier versions of the paper .",
    "suppose @xmath18 is a diagram of a @xmath155-component link @xmath156 , and let @xmath157 denote the graph with @xmath158 and @xmath159 such that @xmath18 contains a classical crossing involving @xmath160 and @xmath161 .",
    "suppose @xmath34 is a directed euler system of @xmath32 .",
    "as we traverse one of the circuits of @xmath34 , we pass from one link component to another when we encounter a marked vertex representing a classical crossing involving those two link components",
    ". each circuit of @xmath34 must cover all the link components that appear together in a connected component of @xmath157 , so if @xmath157 has @xmath162 connected components then @xmath35 must have at least @xmath163 marked vertices .",
    "it is a simple matter to construct an euler circuit with precisely @xmath164 marked vertices : choose a spanning forest in @xmath157 , and mark one crossing of @xmath18 corresponding to each edge of the spanning forest .",
    "if @xmath35 has @xmath163 marked vertices then no two of them are adjacent to each other .",
    "if two marked vertices @xmath36 and @xmath37 are neighbors then they are interlaced on a circuit of @xmath34 .",
    "if the circuit is @xmath165 then @xmath166 @xmath167 is also an euler circuit of the same connected component of @xmath33 .",
    "if we replace @xmath168 with @xmath169 then we obtain an euler system @xmath170 which has precisely the same marked vertices as @xmath34 , except that @xmath36 and @xmath37 are no longer marked .",
    "this is impossible as @xmath163 is the minimum number of marked vertices .",
    "we are now ready to prove theorem [ tangle ] .",
    "suppose @xmath18 contains a tangle ( more precisely , a _",
    "2-tangle _ ) , i.e. , a portion of @xmath18 that can be enclosed by a circle which intersects @xmath18 in precisely four points , none of which is a crossing .",
    "let @xmath171 , @xmath172 , @xmath173 and @xmath174 be the four intersection points of @xmath18 and the tangle s boundary circle .",
    "let @xmath34 be a directed euler system for @xmath32 , and consider a circuit @xmath175 that passes through @xmath171 ; suppose @xmath168 is directed into the circle at @xmath171 .",
    "clearly @xmath168 must leave the circle , say at @xmath172 .",
    "there are two possibilities : either @xmath168 also passes through @xmath173 and @xmath174 , or a different circuit of @xmath34 passes through them .    in the first case ,",
    "suppose @xmath168 is @xmath176 , with @xmath177 and @xmath178 outside the circle .",
    "a vertex of @xmath35 corresponds to a classical crossing of @xmath18 ; either the crossing is inside the tangle , in which case the vertex can not appear on @xmath177 or @xmath178 , or else the crossing is outside the tangle , in which case the vertex can not appear on @xmath179 or @xmath180 .",
    "if the crossing appears on more than one arc @xmath181 , then , it must appear either on @xmath177 and @xmath178 or on @xmath179 and @xmath180 . clearly",
    "these two types of vertices are interlaced with respect to @xmath168 .",
    "also , a vertex that appears only on a single @xmath181 can not be interlaced with a vertex that does not appear on the same @xmath181 .",
    "consequently the first assertion of theorem [ tangle ] holds , with the vertices that appear on both @xmath179 and @xmath180 adjacent to @xmath90 in @xmath87 and the vertices that appear on both @xmath177 and @xmath178 adjacent to @xmath90 in @xmath86 .    in the second case ,",
    "no vertex corresponding to a crossing inside the tangle is interlaced with any vertex corresponding to a crossing outside the tangle .",
    "consequently @xmath35 is the disjoint union of @xmath95 and @xmath97 , so it is a composition with @xmath90 an isolated vertex .",
    "this completes the proof of the first assertion of theorem [ tangle ] . to prove the second assertion , note that the lemma tells us that it is possible to choose @xmath34 so that no two marked vertices of @xmath35 are neighbors . as every neighbor of @xmath90 in @xmath86 is adjacent in @xmath94 to every neighbor of @xmath90 in @xmath87",
    ", at least one of @xmath98 must contain no marked neighbor of @xmath90 .",
    "[ tangle1 ] if @xmath18 contains a tangle then theorem [ pjoin ] may be used to describe the kauffman bracket of @xmath18 using appropriately weighted versions of the subgraphs of @xmath35 induced by the vertices inside and outside the tangle .    as discussed above",
    ", it is always possible to choose @xmath34 so that no two marked vertices of @xmath35 are adjacent .",
    "then theorem [ tangle ] tells us that theorem [ pjoin ] applies , possibly with the names of @xmath86 and @xmath87 interchanged .",
    "[ h ]    tangles4.ps    in the situation of corollary [ tangle1 ] , theorem [ pjoin ] tells us that @xmath29 $ ] is equal to the sum of the bracket polynomials of two graphs with weighted vertices .",
    "it turns out that these two graphs are looped interlacement graphs , so @xmath29 $ ] is actually equal to the sum of the bracket polynomials of two link diagrams with weighted crossings .",
    "suppose @xmath18 contains a directed tangle as illustrated on the left - hand side of figure [ tangles4 ] , and an euler system @xmath34 has been chosen so that the @xmath98 notations of theorems [ tangle ] and [ pjoin ] agree .",
    "( the dashed arcs in the figure indicate the paths @xmath34 might follow as it leaves and re - enters the tangle . )",
    "then @xmath95 is the subgraph of @xmath35 induced by the vertices corresponding to the crossings outside the circle , @xmath97 is the subgraph of @xmath35 induced by the vertices corresponding to the crossings inside the circle , and the neighbors of @xmath90 are the vertices of @xmath95 and @xmath97 that correspond to crossings outside and inside the circle that are interlaced with each other .",
    "no neighbor of @xmath90 in @xmath87 is marked .",
    "the looped interlacement graphs of the diagrams shown in the center and on the right - hand side of each row of the figure are then isomorphic to the graphs @xmath104 and @xmath106 , with the new classical crossings corresponding to @xmath90 and @xmath142 respectively .",
    "( the figure does not completely specify these two weighted graphs , because the weights of @xmath90 and @xmath142 are not displayed . )",
    "observe that the portion of @xmath18 inside the circle is not disturbed in the two new diagrams .",
    "consequently if @xmath18 is obtained by substituting tangles for the vertices of a 4-regular graph @xmath182 ( i.e. , @xmath183 in the notation of @xcite ) , with @xmath184 containing the crossings outside the circle , then @xmath185 still appear as tangles in the two new diagrams , and theorem [ pjoin ] may be applied to @xmath186 in turn .",
    "the result of applying theorem [ pjoin ] repeatedly is to express @xmath29 $ ] as the sum of the bracket polynomials of @xmath187 crossing - weighted @xmath188-crossing diagrams .",
    "such a sum seems complicated but depending on the structure of @xmath18 , it may actually be considerably simpler than the definition of @xmath29 $ ] .",
    "[ t ]    tangles3.ps    we close this section with the observation that if @xmath86 arises from a tangle in a link diagram then it is possible to replace the graphs @xmath128 and @xmath129 of corollary [ pjoin1 ] with graphs that also arise from link diagrams .",
    "suppose we are given a directed tangle as on the left - hand side of figure [ tangles3 ] .",
    "note that the convention of the figure is the opposite of the usual one  the crossings of the tangle correspond to the vertices of the subgraph @xmath95 , so they are presumed to lie outside the circle ; the four segments inside the circle are the ends of arcs of the tangle .",
    "the dashes in the second picture of each row indicate the path followed by @xmath34 , and the third and fourth pictures in that row indicate virtual diagrams we denote @xmath189 and @xmath190 respectively .",
    "let @xmath191 and @xmath192 , where @xmath193 and @xmath194 are the euler systems obtained from @xmath34 in the obvious ways . also , let @xmath195 and @xmath196 be the vertices corresponding to the new classical crossings",
    "; then @xmath197 is looped and @xmath198 is unlooped .",
    "if we weight @xmath198 and @xmath197 with @xmath199 and @xmath200 , it follows that @xmath201=a[f^{10}]+b[f^{01}]$ ] and @xmath202=b[f^{10}]+a[f^{01}]$ ] .",
    "the formulas of corollary [ pjoin1 ] then imply the following .",
    "[ pjoin3 ] @xmath203+\\frac{[f_{+}]+[f_{-}]}{a+b}%\\ ] ]    @xmath204+\\frac{(a+b+bd)[f_{+}]-(a+ad+b)[f_{-}]}{a^{2}-b^{2}}%\\ ] ] @xmath205+\\frac{(a+b+bd)[f_{-}]-(a+ad+b)[f_{+}]}% { a^{2}-b^{2}}%\\ ] ]",
    "two edges of a graph incident on the same vertices are _ parallel _ , and two edges incident on a degree - two vertex are _ in series_. series and parallel edges in edge - weighted graphs can often be consolidated using some appropriate combination of weights ; for instance , in electrical circuit theory two parallel resistors are equivalent to a single resistor with @xmath206 . similarly , vertices @xmath36 and @xmath37 are called _ twins _ if they have the same neighbors outside @xmath207 .",
    "[ h ]    twins.ps    some twin vertices in interlacement graphs arise from simple configurations in link diagrams , like those pictured in figure [ twins ] .",
    "other twin vertices arise from more complicated configurations .",
    "for instance , let @xmath208 and @xmath209 be two link diagrams with connected universes , each marked to identify an euler circuit .",
    "suppose @xmath210 and @xmath209 are drawn together in the plane , with some finite , positive number of transverse intersections .",
    "let @xmath211 be a link diagram obtained by considering each of these transverse intersections to be a classical crossing .",
    "then the universe @xmath212 of @xmath211 is connected , but the marks on @xmath210 and @xmath209 do not describe an euler circuit in @xmath213 . if we locate a portion of @xmath211 where an arc of @xmath210 lies parallel to an arc of @xmath209 , and replace that portion of @xmath211 with the configuration pictured on the right in figure [ twinex ] , then the result is a marked link diagram @xmath18 whose marks do describe an euler circuit @xmath34 .",
    "the two new classical crossings correspond to marked , nonadjacent twins in @xmath35 .",
    "[ h ]    twinex.ps    in some situations , the weighted bracket polynomial allows for the consolidation of twin vertices into one vertex .",
    "[ lemma2 ] let @xmath214 be unlooped twins .    \\(a ) suppose @xmath36 and @xmath37 are marked and not adjacent .",
    "let @xmath215 be the graph obtained from @xmath216 by changing the weights of @xmath36 to @xmath217 and @xmath218 .",
    "then @xmath53=[(g - w)^{\\prime}].$ ]    \\(b ) suppose @xmath36 and @xmath37 are marked and adjacent .",
    "let @xmath215 be the graph obtained from @xmath216 by changing the weights of @xmath36 to @xmath219 and @xmath220 .",
    "then @xmath53=[(g - w)^{\\prime}].$ ]    \\(c ) suppose @xmath36 and @xmath37 are unmarked and adjacent .",
    "let @xmath215 be the graph obtained from @xmath216 by marking @xmath36 and changing the weights of @xmath36 to @xmath221 and @xmath222 .",
    "then @xmath53=[(g - w)^{\\prime}].$ ]    \\(d ) suppose @xmath36 and @xmath37 are adjacent , with @xmath36 unmarked and @xmath37 marked .",
    "let @xmath215 be the graph obtained from @xmath216 by changing the weights of @xmath36 to @xmath221 and @xmath223 .",
    "then @xmath53=[(g - w)^{\\prime}].$ ]    observe that @xmath36 and @xmath37 give rise to nearly identical rows and columns of @xmath3 ; they differ only in their common entries , and only if @xmath36 and @xmath37 are neighbors .",
    "the four parts of the lemma are all justified by applying to @xmath12 the following nullity calculations over @xmath5 .",
    "@xmath224 @xmath225 @xmath226    for instance , consider part ( c ) .",
    "as neither @xmath36 nor @xmath37 is marked , the definition of @xmath12 will not ever involve deleting the row and column corresponding to either .",
    "the second nullity calculation shows that if @xmath227 has @xmath228 then the  term in definition [ bracweigh ] s formula for @xmath53 $ ] corresponding to @xmath55 is the same as the term in definition [ bracweigh ] s formula for @xmath229 $ ] corresponding to @xmath55 .",
    "the third nullity calculation shows that sum of the  terms corresponding to @xmath230 , @xmath231 and @xmath232 in definition [ bracweigh ] s formula for @xmath53 $ ] coincides with the term in definition [ bracweigh ] s formula for @xmath229 $ ] corresponding to @xmath230 .",
    "observe that the reduced graphs @xmath215 in parts ( b ) and ( c ) of proposition [ lemma2 ] are the same ; this is not surprising , as the original graphs differ only by a marked pivot .",
    "also , parts ( b)-(d ) inductively imply theorem [ parallels ] of the introduction .",
    "two cases are missing from proposition [ lemma2 ] .",
    "these cases are not fully analogous to series - parallel reductions of edges , as they do not involve the consolidation of two vertices into one vertex of one graph .",
    "[ lemma3 ] let @xmath214 be nonadjacent , unlooped twins .",
    "\\(a ) suppose neither @xmath36 nor @xmath37 is marked .",
    "let @xmath215 be the graph obtained from @xmath216 by changing the weights of @xmath36 to @xmath233 and @xmath234 .",
    "then @xmath53=[(g - w)^{\\prime}]+\\beta(v)\\beta(w)[g - v - w].$ ]    \\(b ) suppose @xmath36 is unmarked and @xmath37 is marked .",
    "let @xmath215 be the graph obtained from @xmath216 by changing the weights of @xmath36 to @xmath235 and @xmath236 .",
    "then @xmath53=[(g - w)^{\\prime}]+\\beta(v)\\beta(w)[g - v - w].$ ]    the proofs use the same nullity calculations that appear in the proof of proposition [ lemma2 ] .",
    "these cases are more complicated because each one involves both the first nullity calculation and the second , and the corresponding matrices do not appear together in @xmath237 $ ] or @xmath238 $ ] .",
    "the inductive version of proposition [ lemma3 ] allow us to simplify a graph @xmath1 containing @xmath73 nonadjacent twins into one or two graphs with @xmath239 or @xmath240 vertices .",
    "a preliminary observation will be useful .",
    "[ lemma1 ] suppose two graphs @xmath241 and @xmath242 are identical except for the weights of a single vertex @xmath90 , and let @xmath1 be the graph that is identical to both @xmath241 and @xmath242 except for @xmath243 and @xmath244 .",
    "then @xmath53=r_{1}[g_{1}]+r_{2}[g_{2}]$ ] .",
    "this follows directly from definition [ bracweigh ] .",
    "let @xmath65 be nonadjacent , unlooped twins in @xmath1 .",
    "then there are weights @xmath245 and a coefficient @xmath246 so that @xmath53=[(g - v_{2}- ... -v_{k})^{\\prime}]+\\gamma\\cdot\\lbrack g - v_{1}- ... -v_{k}]$ ] .",
    "suppose first that @xmath65 are all unmarked and @xmath247 .",
    "part ( a ) of proposition [ lemma3 ] gives us @xmath53=[(g - v_{k})^{\\prime}]+\\beta ( v_{k-1})\\beta(v_{k})[g - v_{k-1}-v_{k}]$ ] .",
    "as @xmath248 , applying part ( a ) of proposition [ lemma3 ] to @xmath249 gives us @xmath250=[((g - v_{k})^{\\prime}-v_{k-1})^{\\prime}]$ ] , where the weights of @xmath251 in @xmath252 have been changed to @xmath253 and @xmath254 .",
    "lemma [ lemma1 ] tells us that @xmath53=[((g - v_{k}% ) ^{\\prime}-v_{k-1})^{\\prime}]+\\beta(v_{k-1})\\beta(v_{k})[g - v_{k-1}% -v_{k}]=[(g - v_{k}-v_{k-1})^{\\prime\\prime\\prime}]$ ] , where the only difference between @xmath255 and @xmath256 is that the weights of @xmath251 are different . repeating this process @xmath257 times will ultimately reduce @xmath1 to a version of @xmath69 or @xmath258 which has been modified only by changing the weights of @xmath70 or @xmath259 . in the former case @xmath260 , and in the latter case one more application of part ( a ) of proposition [ lemma3 ] is needed .",
    "suppose now that @xmath247 and @xmath261 is the only marked vertex among @xmath65 .",
    "part ( b ) of proposition [ lemma3 ] gives us @xmath53=[(g - v_{k})^{\\prime}]+\\beta(v_{k-1})\\beta(v_{k})[g - v_{k-1}-v_{k}]$ ] . applying part ( a ) of proposition [ lemma3 ] then tells us that @xmath53 $ ] is @xmath262+\\\\ \\lbrack((g - v_{k})^{\\prime}-v_{k-1})^{\\prime}]+\\beta(v_{k-1})\\beta ( v_{k})[g - v_{k-1}-v_{k}].\\end{gathered}\\ ] ] lemma [ lemma1 ] tells us that the sum of the second and third terms is the bracket polynomial of a graph that differs from @xmath263 only in the weights of @xmath251 .",
    "if @xmath264 then the paragraph above applies to this new graph and also to @xmath265 , as neither has any marked vertex among the remaining @xmath7 .",
    "the resulting expressions may be combined by using lemma [ lemma1 ] to get appropriate weights for @xmath70 and simply adding together the coefficients multiplying @xmath266 $ ] .",
    "if there are two or more marked vertices among @xmath65 , then we may apply part ( a ) of proposition [ lemma2 ] repeatedly to bring the number of marked vertices down to one .",
    "the first paragraph of the proof yields a partial dual  of theorem [ parallels ] .",
    "[ parallelsdual ] suppose @xmath247 is odd and @xmath65 are unmarked , nonadjacent , unlooped twins in @xmath1 .",
    "then @xmath53=[(g - v_{2}% - ... -v_{k})^{\\prime}]$ ] where @xmath267",
    "a recursion for the bracket polynomial of marked graphs was given in @xcite .",
    "modifying this recursion to describe the vertex - weighted version of the bracket is not difficult .",
    "recall that the _ open neighborhood _ @xmath268 of a vertex of a graph contains the vertices @xmath269 such that @xmath270 .",
    "if @xmath60 then the _ local complement _",
    "@xmath271 has @xmath272 and @xmath273 @xmath274 @xmath275 and @xmath276 @xmath277 @xmath278 @xmath274 @xmath279 and @xmath280 .",
    "that is , @xmath271 is obtained from @xmath1 by toggling loops and non - loop edges in the subgraph induced by @xmath268 .",
    "if @xmath214 then the _ pivot _ @xmath281 is obtained from @xmath1 by toggling every adjacency between vertices @xmath90 and @xmath151 such that @xmath282 , @xmath283 , and either @xmath284 or @xmath285 .    if @xmath214 are neighbors then the _ marked pivot _",
    "@xmath286 is obtained from @xmath281 by interchanging the neighbors of @xmath36 and @xmath37 and toggling the marks on @xmath36 and @xmath37 .",
    "none of these three operations affects free loops or the weights of any vertex .",
    "[ recursion ] the weighted bracket polynomial of @xmath1 satisfies the following .",
    "\\(a ) suppose @xmath1 has @xmath16 free loops , and let @xmath64 be the graph obtained from @xmath1 by removing the free loops .",
    "then @xmath53=d^{\\phi}\\cdot\\lbrack g^{\\prime}]$ ] .",
    "\\(b ) suppose @xmath36 is a looped vertex of @xmath1 , and let @xmath64 be the graph obtained from @xmath1 by removing the loop on @xmath36 and interchanging @xmath287 and @xmath288",
    ". then @xmath53=[g^{\\prime}]$ ] .",
    "\\(c ) if @xmath36 and @xmath37 are neighbors in @xmath1 then @xmath53=[g_{c}^{vw}]$ ] .",
    "\\(d ) suppose @xmath36 is unlooped and marked , and no neighbor of @xmath36 is marked .",
    "then @xmath15=\\alpha(v)[g - v]+\\beta(v)[g^{v}-v],\\ ] ] where @xmath289 is obtained from @xmath1 by removing @xmath36 and every edge incident on @xmath36 .",
    "\\(e ) let @xmath36 and @xmath37 be adjacent , unlooped , unmarked vertices .",
    "if no neighbor of @xmath36 is marked then @xmath15=\\alpha(v)\\alpha(w)[g^{vw}-v - w]+\\alpha(v)\\beta(w)[(g^{vw}% ) ^{v}-v - w]+\\beta(v)[g^{v}-v].\\ ] ]    \\(f ) if @xmath36 is an isolated , unlooped , unmarked vertex of @xmath1 then @xmath15=(\\alpha(v)d+\\beta(v))\\cdot\\lbrack g - v]\\text{.}%\\ ] ]    \\(g ) the empty graph @xmath290 has @xmath291=1 $ ] .",
    "parts ( a ) , ( b ) , ( f ) and ( g ) follow immediately from definition [ bracweigh ] .",
    "part ( c ) follows from the fact that for every @xmath227 , the @xmath5-nullities of @xmath12 and @xmath292 are the same ; see section 5 of @xcite .",
    "parts ( d ) and ( e ) are proven just as in the unweighted case ; see section 6 of @xcite .",
    "theorem [ recursion ] provides a recursive algorithm for the weighted bracket polynomial : first use ( a ) to eliminate free loops ; then use ( b ) to eliminate loops ; then use ( c ) to eliminate adjacencies between marked vertices ; then use ( d ) to eliminate marked vertices ; then use ( e ) to eliminate the remaining adjacencies ; and finally use ( f ) and ( g ) to calculate the bracket polynomials of the remaining edgeless , unmarked graphs .",
    "different individual implementations of the algorithm will involve applying parts ( c)-(e ) at different locations in @xmath1 , and just as in the unweighted case there is no canonical way to find the most efficient implementation .",
    "another property of the unweighted bracket that extends directly to the weighted version is this : if @xmath1 is the union of disjoint subgraphs @xmath241 and @xmath242 then @xmath53=[g_{1}]\\cdot\\lbrack g_{2}]$ ] .",
    "in outline , our proof of theorem [ pjoin ] is similar to the corresponding proof for vertex - weighted interlace polynomials @xcite . this similarity is not surprising as weighted interlace polynomials can also be calculated recursively using pivots and local complements .",
    "a more complicated argument is required here , however , because interlace polynomials have more convenient reductions for twin and pendant vertices , and do not involve marked vertices .",
    "suppose that @xmath88 , and @xmath90 has no marked neighbor in @xmath87 .",
    "consider the following calculation of @xmath53 $ ] .    first , unloop each looped vertex @xmath293 , and reverse @xmath287 and @xmath288 .",
    "this does not affect any edges other than loops in @xmath95 , so when we are done we have a composition @xmath294 with no loops in @xmath295 .",
    "second , eliminate adjacencies between marked vertices of @xmath296 using marked pivots .",
    "as no two vertices of @xmath87 have different nonempty sets of neighbors in @xmath295 , these marked pivots will not affect the internal structure of @xmath87 .",
    "however there may be extensive changes within @xmath295 .",
    "the graph @xmath297 resulting from this step is not unique ; but any two differ only by marked pivots , and have the same bracket polynomial as @xmath1 .    as no neighbor of @xmath90 in @xmath87",
    "is marked , no marked vertex of @xmath298 has a marked neighbor in @xmath297 .",
    "consequently part ( d ) of theorem [ recursion ] may be used to eliminate every marked vertex in @xmath298 .",
    "the result is a sum of terms , each of which is the product of an initial factor and some bracket polynomial @xmath299 $ ] or @xmath300 $ ] .",
    "fourth , eliminate all remaining adjacencies in each @xmath301 using part ( e ) of theorem [ recursion ] . as each resulting term",
    "is obtained by applying local complement or pivot operations , each term is the product of an initial factor and a bracket polynomial @xmath302 $ ] or @xmath303 $ ] , with @xmath304 unmarked and edgeless .",
    "consequently every vertex not adjacent to @xmath90 in any @xmath305 is now unmarked and isolated ; part ( f ) of theorem [ recursion ] tells us that each term is unchanged if we remove all such vertices from that term s @xmath305 and multiply the initial factor appropriately . if a term @xmath306 $ ] involves a graph @xmath305 in which no vertex neighbors @xmath90 , we may replace that term with a bracket polynomial @xmath307 $ ] , where @xmath308 , @xmath90 and @xmath142 are adjacent , and @xmath142 is a new marked vertex with @xmath309 and @xmath310 .",
    "similarly , any term @xmath303 $ ] in which @xmath305 contains no neighbor of @xmath90 may be replaced with a bracket polynomial @xmath311 $ ] , where @xmath312 , @xmath90 and @xmath313 are adjacent , and @xmath313 is a new marked vertex with @xmath314 and @xmath315 .",
    "after these manipulations @xmath53 $ ] is expressed as a sum of terms each of which is the product of an initial factor and a weighted bracket polynomial @xmath316 $ ] or @xmath317 $ ] in which @xmath318 is a nonempty collection of isolated unlooped neighbors of @xmath90 .",
    "fifth , apply proposition [ lemma3 ] and part ( a ) of proposition [ lemma2 ] repeatedly  to each term in which @xmath318 contains more than one vertex , ultimately obtaining an expression of @xmath53 $ ] as a sum of terms each of which is the product of an initial factor with a weighted bracket @xmath319 $ ] or @xmath320 $ ] where @xmath321 consists of a single unlooped neighbor of @xmath90 , denoted @xmath322 , @xmath142 , @xmath323 or @xmath313 according to whether that vertex is unmarked or marked ( subindex @xmath324 or @xmath325 ) and whether that term involves @xmath326 or @xmath327 ( the latter indicated by tilde ) .",
    "the value of an individual term is not changed if we multiply both the @xmath56 and @xmath57 weights of that term s vertex @xmath328 or @xmath329 by the initial factor , and then replace the initial factor with 1 ; consequently we may as well presume that the initial factors are all 1 . using lemma [ lemma1 ] , we see that if we sum the @xmath56 and @xmath57 weights of @xmath322 , @xmath323 , @xmath330 and @xmath313 in all the different terms involving each , then @xmath53 $ ] is equal to the total of four individual weighted bracket polynomials : @xmath15=[p_{1}\\ast h]+[\\tilde{p}_{1}\\ast h^{a}]+[p_{1m}\\ast h]+[\\tilde { p}_{1m}\\ast h^{a}].\\label{joine}%\\ ] ] here each of the graphs @xmath331 consists of @xmath90 and a single neighbor of @xmath90 , denoted @xmath322 , @xmath323 , @xmath332 , @xmath313 respectively as before .",
    "we now seem to have the job of determining eight unknowns , namely the @xmath56 and @xmath57 weights of the four vertices @xmath322 , @xmath323 , @xmath142 , @xmath313 .",
    "it turns out though that five of these unknowns are not necessary .",
    "for instance , @xmath333 appears in terms of @xmath334 $ ] that involve the @xmath5-nullities of matrices of the form @xmath335 as @xmath87 contains no marked neighbor of @xmath90 , for each such matrix @xmath336 where the overbar indicates that every entry of @xmath337 is different from the corresponding entry of @xmath338 .",
    ". if we did not know that the neighbors of @xmath90 in @xmath87 are unmarked , the last equality would be suspect as the definition of @xmath339 would involve removing some rows of @xmath337 and retaining some rows removed in the definition of @xmath340 . )",
    "consequently the contribution to the sum of ( [ joine ] ) made by the terms in which @xmath333 appears may be provided equally well by terms of @xmath307 $ ] in which @xmath122 appears .",
    "that is , the sum is unchanged if we replace @xmath122 by @xmath341 and replace @xmath333 by @xmath111 .",
    "the terms of @xmath342 $ ] in which @xmath343 appears involve the @xmath5-nullities of precisely the same matrices just discussed .",
    "consequently the contributions to the sum of ( [ joine ] ) made by the terms of @xmath342 $ ] in which @xmath343 appears may also be provided by the terms of @xmath307 $ ] in which @xmath122 appears ; that is , we may replace @xmath122 by @xmath344 and replace @xmath343 by @xmath111 .",
    "the equality @xmath345 tells us that the contributions of the terms in which @xmath346 appears can be duplicated by the terms in which @xmath347 appears , i.e. , the sum of ( [ joine ] ) is unchanged if we replace @xmath347 by @xmath348 and replace @xmath349 by @xmath111 . with both weights of @xmath313 now @xmath111 , @xmath334=0 $ ] makes no contribution to ( [ joine ] ) .    in the same way ,",
    "the equality @xmath350 tell us that @xmath323 is not needed : the contributions of the terms of ( [ joine ] ) involving @xmath351 may be provided by the terms involving @xmath352 .",
    "the terms of ( [ joine ] ) in which @xmath353 appears involve the same nullities @xmath354 that appear in the terms in which @xmath347 appears , so the sum of ( [ joine ] ) is unchanged if we replace @xmath347 with @xmath355 and replace @xmath353 with @xmath111 .",
    "@xmath356 and @xmath357 are isomorphic to @xmath104 and @xmath106 respectively , so the statement of theorem [ pjoin ] follows .",
    "in this section we use linear algebra over @xmath5 to derive formulas for the weights @xmath352 , @xmath347 and @xmath122 of theorem [ pjoin ] from definition [ bracweigh ] .",
    "suppose @xmath358 , and let @xmath359 be the indices of the rows and columns not removed from @xmath360 in obtaining @xmath361 .",
    "that is , @xmath362 ",
    "@xmath363marked @xmath364 either @xmath365 is looped or @xmath366 is not looped@xmath367 .",
    "let @xmath368 be the row vector with @xmath369 if @xmath370 is a neighbor of @xmath90 , and let @xmath371 be the column vector obtained by transposing @xmath71 . according to lemma 2 of @xcite , the three nullities @xmath372{cc}% \\mathcal{a}(f)_{t } & \\kappa\\\\ \\rho & 0 \\end{array } \\right )   , \\nu\\left ( \\begin{array } [ c]{cc}% \\mathcal{a}(f)_{t } & \\kappa\\\\ \\rho & 1 \\end{array } \\right )   , \\nu\\left (   \\mathcal{a}(f)_{t}\\right)\\ ] ] are of the form @xmath373 , @xmath17 , @xmath17 in some order .",
    "we say @xmath55 is of _ type _ 1 , 2 or 3 according to whether the nullity @xmath373 appears first , second or third .    if @xmath18 is a link diagram , then the three displayed matrices correspond to three circuit partitions in @xmath33 . at every vertex other than @xmath90",
    ", the three partitions have the same transition .",
    "in this situation lemma 2 of @xcite asserts that two of the partitions contain the same number of circuits , and the third contains one more circuit .",
    "an example of type 2 is illustrated schematically in figure [ nullity ] .",
    "[ ptb ]    nullity.ps    for each subset @xmath358 let @xmath374 denote the contribution of @xmath55 to definition [ bracweigh ] s formula for @xmath140 $ ] , @xmath375    if @xmath55 is of type 1 then the sum of the contributions of @xmath55 and @xmath376 to @xmath377 $ ] is @xmath378 , while the sum of the contributions of @xmath55 and @xmath379 to @xmath380 $ ] is @xmath374 .",
    "if @xmath55 is of type 2 then the sum of the contributions of @xmath55 and @xmath376 to @xmath377 $ ] is @xmath374 , and the sum of the contributions of @xmath55 and @xmath379 to @xmath380 $ ] is @xmath378 .",
    "if @xmath55 is of type 3 then the sum of the contributions of @xmath55 and @xmath376 to @xmath377 $ ] is @xmath381 , and the sum of the contributions of @xmath55 and @xmath379 to @xmath380 $ ] is also @xmath381 .",
    "as noted in the introduction , theorem [ pjoin ] implies these equations .",
    "@xmath138+[f^{10}]+[f^{01}]\\\\ ( 2-d - d^{2})\\beta(a )   & = [ f - a]+[f^{10}]-(d+1)[f^{01}]\\\\ ( 2-d - d^{2})\\alpha(a_{m } )   & = [ f - a]-(d+1)[f^{10}]+[f^{01}]\\end{aligned}\\ ] ] it follows that if we denote the total of the contributions of the sets of type @xmath382 to @xmath140 $ ] by @xmath383 , then these equalities hold .",
    "@xmath384    [ pjoin4 ] the weights of theorem [ pjoin ] are @xmath385 , @xmath386 and @xmath387 , where @xmath388",
    "the simplest example of theorem [ pjoin ] involves the two - vertex graph @xmath86 in which @xmath90 and @xmath36 are unlooped , unmarked neighbors .",
    "let @xmath389 and @xmath390 .",
    "for this graph corollary [ pjoin1 ] gives the following .",
    "@xmath391 the assertion of theorem 1 is then trivial , as @xmath94 and @xmath104 are identical graphs .",
    "a slightly more complicated example involves the same graph @xmath86 , but with @xmath36 marked ; corollary [ pjoin1 ] gives the following .",
    "@xmath392 this seems more interesting than the result of the first example , but it is just as trivial . in the last step of the proof of theorem [ pjoin ]",
    "we see that setting @xmath309 as in the statement of the theorem is arbitrary ; any choice of @xmath353 will satisfy the theorem , so long as the sum @xmath393 is correct . with @xmath394 instead",
    ", the assertion of theorem [ pjoin ] simply acknowledges that in this example , @xmath94 and @xmath106 are identical .",
    "let @xmath18 be the link diagram pictured in the middle of figure [ example1 ] .",
    "then @xmath96 , where @xmath395 are the pictured two - vertex graphs and @xmath90 is adjacent to all four of these vertices .",
    "consider both @xmath95 and @xmath97 to have the standard weight functions @xmath396 and @xmath397 .",
    "corollary [ pjoin1 ] tells us that @xmath398 , @xmath399 and @xmath400 .",
    "theorem [ pjoin ] then asserts that @xmath149=[h^{\\prime}]=\\\\ a^{2}\\cdot(a^{2}d+2ab+b^{2}d)+(2ab+b^{2}d)\\cdot(a^{2}d^{2}+2abd+b^{2}).\\end{gathered}\\ ] ] ( the same conclusion follows from theorem [ parallels ] . )",
    "the writhe of @xmath18 is @xmath111 , so this bracket polynomial determines the jones polynomial through the following two - stage evaluation .",
    "first @xmath401 and @xmath402 yield @xmath403 and then @xmath404 , as we would expect for the two - component unlink .",
    "suppose we modify the diagram in figure [ example1 ] by reversing the crossing on the right , effectively removing one loop from @xmath97 .",
    "then @xmath149=[h^{\\prime}]=\\\\ a^{2}\\cdot(a^{2}+2abd+b^{2})+(2ab+b^{2}d)\\cdot(a^{2}d+ab+abd^{2}+b^{2}d).\\end{gathered}\\ ] ] the writhe of the diagram is now 2 , so the jones polynomial is obtained by first calculating @xmath405 : @xmath406 and then evaluating @xmath407 , the correct value for the positive hopf link .",
    "suppose instead we modify the graph @xmath95  pictured in figure [ example1 ] by removing the mark .",
    "corollary [ pjoin1 ] tells us that @xmath408 , @xmath399 and @xmath409 . according to theorem",
    "[ pjoin ] , @xmath149=[h^{\\prime}]+[h_{m}^{\\prime}]=\\\\ ( 2ab+b^{2}d)\\cdot(a^{2}d^{2}+2abd+b^{2})+a^{2}\\cdot(a^{2}d+2ab+b^{2}).\\end{gathered}\\ ] ] as the writhe is 0 , this yields @xmath410 this seems incorrect at first glance , because figure [ example1 ] displays a two - component link .",
    "note however that although the graph obtained by removing the mark from @xmath95 is certainly a legitimate marked graph , we can not legitimately remove the mark from the link diagram in figure [ example1 ] , because the marks on a connected link diagram must identify an euler circuit .",
    "figure [ example3 ] exhibits an unmarked link diagram with the appropriate graphs @xmath95 and @xmath97 ; it is an unknot rather than a two - component unlink , so @xmath411 is indeed its jones polynomial .",
    "suppose we now modify the diagram in figure [ example1 ] by reversing the orientation of one component , as in figure [ example2 ] .",
    "the only vertex of @xmath86 adjacent to @xmath90 is the marked vertex , while both vertices of @xmath97 are neighbors of @xmath90 .",
    "corollary [ pjoin1 ] tells us that @xmath398 , @xmath394 and @xmath412 .",
    "then theorem [ pjoin ] asserts that @xmath149=[h^{\\prime}]+[h_{m}^{\\prime}]=\\\\ a^{2}\\cdot(a^{2}d+2ab+b^{2}d)+(2ab+b^{2}d)\\cdot(a^{2}d^{2}+2abd+b^{2}),\\end{gathered}\\ ] ] just as in the discussion of figure [ example1 ] above .",
    "this is not surprising , as the kauffman bracket of a link diagram is independent of the orientations of the link components .",
    "@xmath413   & = a^{4}d^{2}+4a^{3}bd+5a^{2}b^{2}+a^{2}b^{2}d^{2}% + 4ab^{3}d+b^{4}d^{2}\\\\ \\lbrack f^{01 } ]   & = a^{4}d+2a^{3}b+2a^{3}bd+5a^{2}b^{2}+a^{2}b^{2}% d^{2}+4ab^{3}d+b^{4}d^{2}\\\\ \\lbrack f^{10 } ]   & = a^{4}d+2a^{3}b+2a^{3}bd^{2}+5a^{2}b^{2}d+a^{2}b^{2}% d^{3}+4ab^{3}d^{2}+b^{4}d^{3}\\\\ \\lbrack h - a ]   & = a^{3}d+3a^{2}b+3ab^{2}d+b^{3}d^{2}\\\\ \\lbrack h^{01 } ]   & = a^{3}d+3a^{2}b+ab^{2}d+2ab^{2}+b^{3}d\\\\ \\lbrack h^{10 } ]   & = a^{3}d^{2}+3a^{2}bd+ab^{2}d^{2}+2ab^{2}+b^{3}d\\end{aligned}\\ ] ]    corollary [ pjoin1 ] gives us these weights .",
    "@xmath414 corollary [ pjoin2 ] tells us that @xmath149=(a^{4}d+2a^{3}b)\\cdot(2ab^{2}+b^{3}d)+0\\\\ + ( ( a^{4}d+2a^{3}b)d+0)\\cdot(a^{3}d+3a^{2}b+ab^{2}d)\\\\ + ( 2a^{3}bd+a^{2}b^{2}(5+d^{2})+4ab^{3}d+b^{4}d^{2})\\cdot((2ab^{2}% + b^{3}d)d+0)\\\\ + ( 2a^{3}bd+a^{2}b^{2}(5+d^{2})+4ab^{3}d+b^{4}d^{2})\\cdot(a^{3}d+3a^{2}% b+ab^{2}d).\\end{gathered}\\ ] ] the writhe of @xmath18 is 3 , so we calculate @xmath405 by multiplying by @xmath415 and evaluating @xmath401 and @xmath416 : @xmath417 we conclude that the jones polynomial of the knot of figure [ tanglex ] is @xmath418 .",
    "this identifies the knot as the mirror image of @xmath419 .",
    "r. c. read and p. rosenstiehl , on the gauss crossing problem , in _ combinatorics _ , keszthely ( 1976 ) , vol .",
    "ii , colloq . math .",
    "jnos bolyai , * 18 * ( north - holland , amsterdam - new york , 1978 ) , pp ."
  ],
  "abstract_text": [
    "<S> in earlier work the kauffman bracket polynomial was extended to an invariant of marked graphs , i.e. , looped graphs whose vertices have been partitioned into two classes ( marked and not marked ) . </S>",
    "<S> the marked - graph bracket polynomial is readily modified to handle graphs with weighted vertices . </S>",
    "<S> we present formulas that simplify the computation of this weighted bracket for graphs that contain twin vertices or are constructed using graph composition , and we show that graph composition corresponds to the construction of a link diagram from tangles </S>",
    "<S> .    _ keywords . </S>",
    "<S> _ graph , virtual link , kauffman bracket , vertex weight , series , parallel , twin vertex , tangle , graph composition    _ 2000 mathematics subject classification . </S>",
    "<S> _ 57m25 , 05c50 </S>"
  ]
}