{
  "article_text": [
    "let @xmath3 , @xmath4 , and @xmath5 be the fresnel integrals defined by @xmath6 and @xmath7 our definitions in are those of @xcite and @xcite ) , and @xmath8 , @xmath9 and @xmath10 are related through @xmath11    in this paper we derive new methods for computing these fresnel integrals @xmath5 , @xmath3 and @xmath4 .",
    "the derivation of our approximations makes use of the relationship between the fresnel integral and the error function , that @xmath12 where @xmath13 is the complementary error function , defined by @xmath14 and @xmath15 it also depends on the integral representation ( * ? ? ? * ( 7.1.4 ) ) that @xmath16 combining and gives an integral representation for @xmath5 , that @xmath17    fresnel integrals arise in applications throughout science and engineering , especially in problems of wave diffraction and scattering ( _ e.g. _ , @xcite , @xcite ) , so that methods for the efficient and accurate computation of these functions are of wide application .",
    "the purpose of this paper is to present new approximations for the fresnel integrals , based on @xmath0-point trapezium rule approximations to the integral representation for @xmath5 , these trapezium rules modified to take into account the poles of the integrand .",
    "these poles lie near the path of integration when @xmath18 is small .",
    "the observation that the trapezium rule is exponentially convergent when applied to integrals of the form @xmath19 with @xmath20 analytic in a strip surrounding the real axis , dates back at least to turing @xcite and goodwin @xcite .",
    "the derivation of this result uses contour integration and cauchy s residue theorem ; see  [ sec approx f ] below . applying the trapezium rule with step - length @xmath21 to leads to the approximation @xmath22 where @xmath23 when @xmath24 is large this approximation is very accurate .",
    "indeed , if we choose @xmath25 for some large integer @xmath0 , then this approximation is essentially identical to the approximation @xmath26 for @xmath5 that we propose in below .",
    "however , the approximation becomes increasingly poor as @xmath24 approaches zero .    in the context of developing methods for evaluating the complementary error function of complex argument ( by",
    ", evaluating @xmath5 for @xmath18 real is just a special case of this larger problem ) , chiarella and reichel @xcite , matta and reichel @xcite , and hunter and regan @xcite proposed modifications of the trapezium rule that follow naturally from the contour integration argument used to prove that the trapezium rule is exponentially convergent .",
    "the most appropriate form of this modification is that in @xcite where the modified trapezium rule approximation @xmath27 is proposed . here",
    "the correction term @xmath28 is defined by @xmath29 the approximation clearly coincides with @xmath26 , given by , for @xmath30 , if the range of summation in is truncated to @xmath31 and the choice for @xmath32 is made .",
    "hunter and regan prove that the magnitude of the error in is @xmath33 for @xmath24 , provided @xmath34 .",
    "similar estimates , it appears arrived at independently , are derived by mori @xcite , in which paper the emphasis is on computing @xmath35 for real @xmath18 .",
    "the approximation is the starting point for the method we propose in this paper .",
    "our main contributions ( see  [ sec results ] for detail ) are : ( i ) to point out that the approximation proposed in for @xmath36 in fact provides an accurate ( and real - analytic ) approximation to the entire function @xmath8 on the whole real line ; ( ii ) to provide an optimal formula for the choice of the step - size @xmath32 as a function of @xmath0 , the number of terms retained in the sum in ; ( iii ) to prove that , with this choice of @xmath32 , the resulting approximations are exponentially convergent as a function of @xmath0 , uniformly on the real line ( this in contrast to which blows up at @xmath37 ) .",
    "naturally , there exist already a number of effective schemes for computation of fresnel integrals , and we briefly summarise now the best of these .",
    "an effective computational method for smaller values of @xmath38 is to make use of the power series for @xmath3 and @xmath4 ( see below ) .",
    "these converge for all @xmath18 , and very rapidly for smaller @xmath18 , and so are widely used for computation . for example , the algorithm in the standard reference @xcite uses these power series for @xmath39 . for this range , after the first two terms , these series are alternating series of monotonically decreasing terms , and the error in truncation has magnitude smaller than the first neglected term . thus , for @xmath40 , the errors in computing @xmath3 and @xmath4 by these power series truncated to @xmath0 terms are @xmath41 and @xmath42 , respectively , for @xmath43 .",
    "for@xmath44 , @xcite recommends computation using the representations in terms of @xmath13 which follow from and , and the continued fraction representation for @xmath45 given as ( * ? ? ?",
    "* ( 7.9.2 ) ) .",
    "methods for evaluation of @xmath46 based on continued fractions for larger complex @xmath47 ( which can be used to evaluate @xmath5 and hence @xmath3 and @xmath4 ) are also discussed in gautschi @xcite and are finely tuned to form toms `` algorithm 680 '' in poppe and wijers @xcite .",
    "this algorithm achieves relative errors of @xmath48 over `` nearly all '' the complex plane by taylor expansions of degree up to 20 in an ellipse around the origin , convergents of up to order 20 of continued fractions outside a larger ellipse , and a more expensive mix of taylor expansion and continued fraction calculations in between .",
    "weideman @xcite presents an alternative method of computation ( the derivation starts from the integral representation ) which approximates @xmath46 , for @xmath49 , by the polynomial @xmath50 in the transformed variable @xmath51 . here",
    "@xmath52 and the coefficients @xmath53 can be viewed as fourier coefficients and efficiently computed by the fft .",
    "we will see in  [ sec nr ] that a polynomial degree @xmath54 in suffices to compute @xmath55 with relative error @xmath56 uniformly on the positive real axis .",
    "weideman @xcite argues carefully and persuasively that , for intermediate values of @xmath57 ( values in approximately the range @xmath58 for the case @xmath59 which we require ) , and as measured by operation counts , the work required to compute @xmath46 to @xmath48 relative accuracy is much smaller for the approximation than for algorithm 680 @xcite .",
    "all the approximations described above are polynomial or rational approximations ( or piecewise polynomial / rational approximations , proposing different approximations on different regions ) .",
    "many other authors describe approximations of these types for computing the fresnel integrals specifically with real arguments .",
    "the best of these in terms of accuracy is cody @xcite , where numerical coefficient values are given for piecewise rational approximations to @xmath3 and @xmath4 for @xmath60 , and for piecewise rational approximations to the related functions @xmath61 and @xmath62 ( see and below ) , for @xmath63 .",
    "these approximations , in their respective regions of validity , achieve relative errors @xmath64 , this using rational approximations which are ratios of polynomials of degree @xmath65 ; in total five different approximations are used on different subintervals of the real axis .",
    "single rational approximations , based on a `` polar '' version of and , are computed in @xcite , but these are of limited accuracy ( absolute errors @xmath66 ) .      the main result of this paper is to derive , with rigorous error bounds , a new family of approximations to @xmath5 based on modified trapezium rules , given by @xmath67 where @xmath68 the corresponding approximations to @xmath3 and @xmath4 that we propose ( obtained by substituting in and separating real and imaginary parts ) are @xmath69 and @xmath70 where @xmath71    these approximations , designed for computation of @xmath5 , @xmath3 and @xmath4 for all @xmath72 , are attractive in several respects .    *",
    "the approximation @xmath73 is proven in theorems [ thm : main_abs_bound ] and [ thm : rel ] to converge to @xmath8 approximately in proportion to @xmath74 , uniformly on the real line with respect to both absolute and relative error , and this predicted rate of exponential convergence is observed in numerical experiments ( see  [ sec nr ] ) . * the approximations @xmath75 , @xmath76 and @xmath77 to the entire functions @xmath8 , @xmath9 , and @xmath10 , are analytic in the strip @xmath78 and the error bounds we prove extend in modified form into this strip .",
    "this implies exponentially convergent error estimates , presented in ",
    "[ subsec : complex ] and  [ sec approx cs ] , for the difference between the coefficients in the maclaurin series of @xmath8 , @xmath9 , and @xmath10 and those in the corresponding series for @xmath73 , @xmath79 and @xmath80 . in turn",
    "( see  [ sec approx cs ] ) , this implies that the approximations all retain small relative error for @xmath38 small , and the computations in  [ sec nr ] demonstrate this .",
    "* these approximations inherit symmetries of the fresnel integrals .",
    "in particular , our normalisation of @xmath5 is such that @xmath81 so that , in particular , @xmath82 . it is clear from that the same holds for @xmath26 , _",
    "i.e. _ , @xmath83 similarly , where an overline denotes a complex conjugate , @xmath84 both these symmetries can be deduced from the structure of @xmath9 and @xmath10 and their approximations : by inspection of and we see that @xmath85 where @xmath86 and @xmath87 are analytic in a neighbourhood of the real line and are real - valued for real arguments .",
    "this is the same structure as @xmath9 and @xmath10 ( see ) .",
    "in particular , implies that @xmath79 and @xmath80 , like @xmath9 and @xmath10 , are odd functions .",
    "* these approximations are straightforward to code .",
    "tables [ matlab_code ] and [ matlab_codecs ] show the short matlab codes used to evaluate @xmath73 , @xmath79 and @xmath80 for all the computations in this paper .    .... function f = fresnel(x , n ) % evaluates the approximation f_n(x ) to the fresnel integral f(x ) .",
    "% x is a real scalar or matrix , %",
    "n is the positive integer controlling accuracy ( suggest n=12 ) , % f is the corresponding scalar or matrix of values of f_n(x ) .",
    "select = x>=0 ; f = zeros(size(x ) ) ; if any(select ) , f(select ) = f(x(select),n ) ; end if any(~select ) , f(~select ) = 1-f(-x(~select),n ) ; end    function f = f(x , n ) h = sqrt(pi/(n+0.5 ) ) ; t = h*((n:-1:1)-0.5 ) ;   an = pi / h ; t2 = t.*t ; t4 = t2.*t2 ; et2 = exp(-t2 ) ; rooti = exp(i*pi/4 ) ; z = rooti*x ; x2 = x.*x ;",
    "x4 = x2.*x2 ; z2 = i*x2 ; s = ( -et2(1)./(x4+t4(1))).*(z2+t2(1 ) ) ; for n = 2:n      s = s + ( -et2(n)./(x4+t4(n))).*(z2+t2(n ) ) ; end ez = exp((2*an*i*rooti)*x ) ; f =   ( i / an)*z.*exp(z2).*s + ez./(ez+1 ) ; ....    we end this introduction by outlining the remainder of the paper . in  [ sec approx f ] we derive the approximation to @xmath5 and prove rigorous bounds on @xmath88 . in  [ sec approx cs ] we deduce from this the approximations and and bounds on the errors @xmath89 and @xmath90 , especially bounds for @xmath18 small . in  [ sec nr ]",
    "we show numerical results , comparing our new approximations with the error bounds derived in the earlier sections and with certain rival methods for computing fresnel integrals .",
    "the appendix proves what appears to be a new , sharp lower bound on @xmath91 , for @xmath92 , of some independent interest , potentially useful for deriving rigorous upper bounds on the relative error in approximate methods for computing @xmath93 ( e.g. , the methods of @xcite ) .",
    "the relevance of this lower bound to the rest of the paper is that it implies , via , a new lower bound on @xmath94 for @xmath24 , of independent interest and a key component in our theoretical bounds on relative errors in  [ sec approx f ] .",
    "in this section we derive the approximation @xmath26 to @xmath5 and derive error bounds for this approximation demonstrating that both absolute and relative errors converge exponentially to zero as @xmath0 increases , uniformly on the real line , and that @xmath2 is enough to achieve errors @xmath95 .",
    "the first part of our derivation follows in large part matta and reichel @xcite and hunter and regan @xcite . from we have that , for @xmath24 , @xmath96 and",
    "we have suppressed in our notation the dependence of @xmath20 on @xmath18 .",
    "given @xmath21 let @xmath97 which is an odd meromorphic function with simple poles at the points @xmath98 , defined by , which has the property that , for @xmath99 with @xmath100 , @xmath101 , @xmath102 where the path of integration is from @xmath103 to @xmath104 along the real axis , except that the path makes small semicircular deformations to pass above each of the simple poles at the points @xmath98 , @xmath105 .",
    "explicitly , the @xmath106th deformation is the semicircle @xmath107 , with @xmath108 in the range @xmath109 small enough so that the simple pole singularity in @xmath110 at @xmath111 lies above @xmath112 .",
    "then , since @xmath113 is an odd function , we see that @xmath114 in the limit @xmath115 , @xmath116 , where @xmath117 denotes the residue of @xmath118 at @xmath98 .",
    "thus @xmath119 , where @xmath120 is a trapezium / midpoint rule approximation to @xmath121 .",
    "for @xmath101 let @xmath122 where the path of integration @xmath123 is the line @xmath124 , traversed in the direction of increasing @xmath125 .",
    "it follows from cauchy s residue theorem that @xmath126 where @xmath127 is the heaviside step function ( defined by @xmath128 , for @xmath129 , @xmath130 , and @xmath131 , for @xmath132 ) , and @xmath133 thus @xmath134 the point of this formula is that @xmath135 is a computable approximation to @xmath121 and the integral @xmath136 is small , as quantified in the following proposition .",
    "let @xmath137 denote the value of the integral @xmath136 when we choose @xmath138 .",
    "then , for @xmath24 , latexmath:[\\[\\label{main2 }     for @xmath99 , @xmath140 so , using and recalling that @xmath141 , we see that @xmath142 choosing @xmath138 , to minimise the exponent @xmath143 , the result follows .",
    "note that @xmath144 is precisely the approximation , and that the above bound on @xmath137 is precisely the bound from @xcite .",
    "[ thm : delta_h ] let @xmath145 and @xmath146 .",
    "then , for @xmath24 , @xmath147 where @xmath148 here @xmath149 is defined by , @xmath150 with @xmath151 , and @xmath152    the bound implies that @xmath153 the bound also implies that @xmath154 , for @xmath155 .",
    "setting @xmath138 , select @xmath108 in the range @xmath156 and consider the case that @xmath157 . in this case",
    "we observe that the derivation of can be modified to show that @xmath158 where the contour @xmath159 passes above the pole in @xmath160 at @xmath161 ; precisely , @xmath162 is the union of @xmath163 and @xmath164 , where @xmath165 and @xmath164 is the circular arc @xmath166 , where @xmath167 .",
    "for @xmath168 it holds that @xmath169 to bound the integral over @xmath164 we note that , for @xmath170 , is true and @xmath171 .",
    "further , @xmath172 , where @xmath173 since @xmath157 . from these bounds and , defining @xmath174 , we deduce that @xmath175 for @xmath18 in the range @xmath157 we can bound @xmath176 using , , , and the triangle inequality , to get that @xmath177 . noting that @xmath178 if and only if @xmath179 , where @xmath180 , we choose @xmath181 to be @xmath182 . with this choice it follows from that @xmath183 for @xmath184 , and the proof is complete .",
    "the approximation @xmath26 , given by , that we propose for @xmath185 is just @xmath186 with a particular choice of @xmath32 and with the range of summation in reduced to the finite range @xmath31 .",
    "this induces an additional error , @xmath187 that we bound in the next proposition .",
    "[ prop : tn ] for @xmath24 , @xmath188    to arrive at the last line we have used that , for @xmath24 , @xmath189    at this point we make a choice of @xmath32 to approximately equalise @xmath190 in theorem [ thm : delta_h ] ( which is approximately proportional to @xmath191 ) and the bound on @xmath192 in proposition [ prop : tn ] , choosing @xmath32 so that @xmath193 .",
    "in other words , we make the choice @xmath194 given by , in which case @xmath195 , and @xmath196 , where @xmath197 is defined by . making this choice of @xmath32",
    "we see that @xmath198 and that @xmath199 , we arrive at the following theorem which is our main pointwise error bound .",
    "theorem [ thm : delta_h ] , , and prove this theorem only for @xmath24 , but the symmetries and imply that @xmath200 , so that holds also for @xmath201 , and , by continuity , also for @xmath202 ( and in fact @xmath203 ) .",
    "[ thm : main_pw_error ] for @xmath204 , @xmath205    we will compare @xmath206 to the upper bound @xmath207 for @xmath208 in figure [ fig2 ] below .",
    "the following theorem estimates the maximum value of @xmath207 on the real line .",
    "[ thm : main_abs_bound ] for @xmath204 , @xmath209 which decreases as @xmath0 increases , with @xmath210    it is easy to see that @xmath190 is increasing on @xmath211 and decreasing on @xmath212 .",
    "further , where @xmath213 denotes the limiting value of @xmath190 as @xmath214 from below , since @xmath215 , @xmath216 similarly , @xmath217 is increasing on @xmath211 and decreasing on @xmath212 .",
    "thus , for @xmath218 , @xmath219 moreover , @xmath220 combining , and we reach the result .",
    "we can also bound the relative error in our approximation @xmath221 .",
    "the proof of theorem [ lemma ] is postponed to the appendix .",
    "[ lemma ] @xmath222 @xmath223 where @xmath224 which decreases as @xmath0 increases , with @xmath225 and @xmath226 @xmath227 .    combining , , , and",
    ", we see that , for @xmath218 , @xmath228 this implies the bound for @xmath218 .",
    "the bound for @xmath229 follows immediately from and .    in the above theorems we use and to bound the maximum absolute and relative errors in the approximation @xmath26 .",
    "these inequalities , additionally , imply that @xmath26 is particularly accurate for @xmath38 small . for @xmath230",
    ", it follows from and that @xmath231 which decreases as @xmath0 increases , with @xmath232 and @xmath233 .",
    "in  [ sec intro ] we have made claims regarding the analyticity of the approximation @xmath26 , considered as a function of @xmath18 in the complex plane .",
    "we justify these claims now",
    ". one attractive feature of the modified trapezium rule approximation @xmath234 is that , in contrast to @xmath235 , it is entire as a function of @xmath18 .",
    "this is not immediately obvious : @xmath186 , and @xmath236 has simple pole singularities at @xmath237 , @xmath238 . but",
    "@xmath235 also has simple poles at the same points and it is an easy calculation to see that the residues add to zero , so that the singularities cancel out . since @xmath239 , with @xmath32 given by , it follows that the singularities of @xmath26 are those of @xmath192 , _",
    "i.e. _ , simple poles at @xmath240 , for @xmath241 .",
    "thus @xmath26 is a meromorphic function and , in particular , is analytic in the strip @xmath242 and in the first and third quadrants of the complex plane .",
    "we will note two consequences of this analyticity and the bounds that we have already proved . in these arguments",
    "we will use an extension of the maximum principle for analytic functions to unbounded domains , that if @xmath46 is analytic in an open quadrant in the complex plane , let us say @xmath243 , and is continuous and bounded in its closure , then @xmath244 where @xmath245 denotes the boundary of the quadrant .",
    "( this sort of extension of the maximum principle to unbounded domains is due to phragmen and lindelf ; see , _ e.g.",
    "_ , @xcite . )",
    "the first consequence is that , from , , and , it follows that the bound holds on both the real and imaginary axes .",
    "further , from and the asymptotics of @xmath246 in the complex plane ( * ? ? ?",
    "* ( 7.1.23 ) ) , it follows that @xmath247 , uniformly in @xmath248 , for @xmath249 ; moreover , it is clear from that the same holds for @xmath75 and hence for @xmath250 .",
    "thus implies that holds for @xmath249 , and and then imply that holds also for @xmath251 .",
    "it is clear from the derivations above that , if @xmath32 is given by , then @xmath234 also satisfies the bound , _",
    "i.e. _ , latexmath:[\\[\\label{bb }    this holding in the first instance for real @xmath47 , then for imaginary @xmath47 , and finally for all @xmath47 in the first and third quadrants .",
    "the bound can not hold in the second or fourth quadrant because @xmath253 has poles there .",
    "this issue does not hold for @xmath254 , which is an entire function , but can not hold in the whole complex plane because this , by liouville s theorem @xcite , would imply that @xmath254 is a constant . what does hold is that @xmath255 is bounded in the second and fourth quadrants , this a consequence of the definition of @xmath234 and the asymptotics of @xmath256 at infinity .",
    "thus it follows from , and since @xmath257 if @xmath47 is real or pure imaginary , that @xmath258 in the second and fourth quadrants .",
    "we can use the bound to obtain a bound on @xmath259 in the second and fourth quadrants . clearly , where @xmath192 is defined by , with @xmath32 given by , for @xmath260 in the second and fourth quadrants , @xmath261 so that @xmath262 which implies that @xmath263 , then @xmath264 thus , for @xmath260 in the second and fourth quadrants with @xmath265 , @xmath266 which is decreasing with @xmath267 and @xmath268 .",
    "we observe above that the bound on @xmath253 holds for all complex @xmath47 in the first and third quadrants of the complex plane , and on the boundaries of those quadrants , the real and imaginary axes , while the bound holds in the second and fourth quadrants for @xmath269 .",
    "these bounds imply that the coefficients in the maclaurin series of @xmath75 are close to those of @xmath270 .",
    "precisely , at least for @xmath271 , @xmath272 with @xmath273 , @xmath274 .",
    "thus , where @xmath275 , it follows from cauchy s estimate ( * ? ? ?",
    "* theorem 10.26 ) and the bounds and that , for @xmath276 so that @xmath277 , @xmath278 approximating @xmath3 and @xmath4 -------------------------------------------------------    from we see that , for @xmath18 real , @xmath279 clearly , given the approximation @xmath26 to @xmath5 , these relationships can be used to generate approximations for the fresnels integrals @xmath3 and @xmath4 .",
    "these approximations are defined , for @xmath204 , by @xmath280 and are given explicitly in and .",
    "we note the similarity between and and the formulae ( * ? ? ?",
    "* ( 7.5.3)-(7.5.4 ) ) @xmath281 which express @xmath3 and @xmath4 in terms of the auxiliary functions , @xmath61 and @xmath62 , for the fresnel integrals @xcite ) .",
    "indeed , it follows from ( * ? ? ? * ( 7.7.10)-(7.7.11 ) ) that , for @xmath24 , @xmath61 and @xmath62 have the integral representations @xmath282 and , recalling that @xmath283 is linked to the quadrature step - size through , it is clear that , for @xmath24 , @xmath284 and @xmath285 can be viewed as quadrature approximations to these integrals .    the approximations and inherit the accuracy of @xmath26 on the real line : from and we see , for @xmath204 , that @xmath286 .",
    "thus the error bounds of the previous section can be applied . in particular , from and it follows that both @xmath287 and @xmath288 are @xmath289 and @xmath290 here @xmath291 and @xmath292 are the decreasing sequences of positive numbers defined by and , respectively .",
    "these bounds show that @xmath293 and @xmath294 are exponentially convergent as @xmath295 , uniformly on the real line , so that very accurate approximations can be obtained with very small values of @xmath0 ( shows that both @xmath296 and @xmath297 are @xmath298 on the real line for @xmath299 ) . in  [ sec nr ] we will confirm the effectiveness of these approximations by numerical experiments , checking the accuracy of and by comparison with the power series @xcite ) @xmath300    it follows from the analyticity of @xmath26 in the complex plane , discussed in ",
    "[ subsec : complex ] , that @xmath26 has a power series convergent in @xmath301 , and from that @xmath293 and @xmath294 have convergent power series representations in @xmath302 . from the observations below",
    "it is clear that , echoing , these take the form @xmath303 further , it follows from and that the coefficients @xmath304 and @xmath305 are close to the corresponding coefficients of @xmath3 and @xmath4 , with the difference having absolute value @xmath306 for @xmath276 , where @xmath307 is the decreasing sequence of positive numbers given by .",
    "this implies that , near zero , where @xmath3 has a simple zero and @xmath4 a zero of order three , the approximations @xmath293 and @xmath294 retain small relative error . for @xmath293",
    "this follows already from but to see this for @xmath294 we need the stronger bound implied by that , for @xmath308 , @xmath309 = fresnelcs(x , n ) % evaluates approximations to the fresnel integrals c(x ) and s(x ) .",
    "% x is a real scalar or matrix , % n is a positive integer controlling accuracy ( suggest n=12 ) , % c and s are the scalars / matrices of the same size as x approximating c(x ) and s(x ) .",
    "h = sqrt(pi/(n+0.5 ) ) ; t = h*((n:-1:1)-0.5 ) ;   an = pi / h ; rootpi = sqrt(pi ) ; t2 = t.*t ; t4 = t2.*t2 ; et2 = exp(-t2 ) ; x2pi2 = ( pi/2)*x.*x ; x4 = x2pi2.*x2pi2 ; a = et2(1)./(x4+t4(1 ) ) ; b = t2(1)*a ; for n = 2:n      term = et2(n)./(x4+t4(n ) ) ;      a = a + term ;   b = b + t2(n)*term ; end a = a.*x2pi2 ; mx = ( rootpi*an)*x ; mx = ( rootpi / an)*x ; chalf = 0.5*sign(mx ) ; shalf = chalf ; select = abs(mx)<39 ; if any(select )      mxs = mx(select ) ; shx = sinh(mxs ) ; sx = sin(mxs ) ;      den = 0.5./(cos(mxs)+cosh(mxs ) ) ;      chalf(select ) = ( shx+sx).*den ;      ssdiff = shx - sx ;      select2 = abs(mxs)<1 ;      if any(select2 )          mxs = mxs(select2 ) ; mxs3 = mxs.*mxs.*mxs ; mxs4 = mxs3.*mxs ;          ssdiff(select2 ) = mxs3.*(1/3 + mxs4.*(1/2520 ...              + mxs4.*((1/19958400)+(0.001/653837184)*mxs4 ) ) ) ;      end      shalf(select ) = ssdiff.*den ; end cx2 = cos(x2pi2 ) ; sx2 = sin(x2pi2 ) ; c = chalf + mx.*(a.*sx2-b.*cx2 ) ; s = shalf - mx.*(a.*cx2+b.*sx2 ) ; ....    table [ matlab_codecs ] shows the matlab implementing and that we use in the next section . to evaluate @xmath310 , with @xmath311 , in and",
    ", we note that , for @xmath312 , @xmath313 and @xmath314 have the same value in double precision arithmetic , as do @xmath315 and @xmath316 .",
    "thus this expression evaluates as @xmath317 in double precision arithmetic for @xmath318 . to avoid underflow and reduce computation time ,",
    "we evaluate it as @xmath317 for @xmath312 . for small @xmath319",
    "there is an additional issue of loss of precision in evaluating @xmath320 for @xmath321 small .",
    "this is avoided in table [ matlab_codecs ] by using @xmath322 for @xmath323 , truncating after four terms as the 5th term is negligible in double precision .",
    "in this section we show numerical computations that confirm and illustrate the theoretical error bounds in  [ sec approx f ] and  [ sec approx cs ] , and that explore the accuracy and efficiency of our new methods , through qualitative and quantitative comparisons with certain of the other computational methods described in  [ sec other ] .",
    ", and its upper bound ( ) , plotted against @xmath0 , in one case where @xmath5 is approximated by @xmath324 ( ) with @xmath325 defined by and computed by the function in table 1 of @xcite , and in the other case where @xmath5 is approximated by @xmath326 ( ) .",
    "right hand side : maximum relative error , @xmath327 , and its upper bound ( ) , plotted against @xmath0 , where @xmath5 is approximated in the two curves as on the left hand side .",
    "( all maximums are taken over 40,000 equally spaced points between 0 and 1,000 , and all values of @xmath26 are computed using the code in table [ matlab_code].),title=\"fig:\",width=221 ] , and its upper bound ( ) , plotted against @xmath0 , in one case where @xmath5 is approximated by @xmath324 ( ) with @xmath325 defined by and computed by the function in table 1 of @xcite , and in the other case where @xmath5 is approximated by @xmath326 ( ) .",
    "right hand side : maximum relative error , @xmath327 , and its upper bound ( ) , plotted against @xmath0 , where @xmath5 is approximated in the two curves as on the left hand side .",
    "( all maximums are taken over 40,000 equally spaced points between 0 and 1,000 , and all values of @xmath26 are computed using the code in table [ matlab_code].),title=\"fig:\",width=221 ]    in figure [ fig1 ] it can be seen that the exponential convergence predicted by the bounds and is achieved , indeed these bounds overestimate their respective maximum errors by at most a factor of 10 .",
    "further , with @xmath0 as small as 12 it appears that we achieve maximum absolute and relative errors in @xmath26 which are @xmath328 and @xmath329 , respectively ; these values are upper bounds whichever of the two methods for approximating @xmath5 accurately is used .",
    "( we should add a note of caution here : the different approximations agree to high accuracy , but the accuracy of each approximation is limited , for large @xmath18 , by the accuracy with which @xmath330 is computed . )",
    "these plots also verify the high accuracy of the approximation for @xmath46 from @xcite , at least for @xmath59 and if @xmath331 is large enough in .",
    "figure [ fig3 ] explores this in more detail : in each plot the trend is one of exponential convergence , but the convergence is not monotonic and is slower than that in figure [ fig1 ] .    , where @xmath332 with @xmath333 defined in .",
    "right hand side : same , but maximum relative error , @xmath334 , is plotted against @xmath331 . in each plot",
    "the two curves correspond to different methods for approximating the exact value of @xmath5 , either @xmath335 given by ( ) , or @xmath336 with @xmath337 ( ) .",
    "( the maximums , as in figure [ fig1 ] , are taken over 40,000 equally spaced points between 0 and 1,000.),title=\"fig:\",width=221 ] , where @xmath332 with @xmath333 defined in .",
    "right hand side : same , but maximum relative error , @xmath334 , is plotted against @xmath331 . in each plot",
    "the two curves correspond to different methods for approximating the exact value of @xmath5 , either @xmath335 given by ( ) , or @xmath336 with @xmath337 ( ) .",
    "( the maximums , as in figure [ fig1 ] , are taken over 40,000 equally spaced points between 0 and 1,000.),title=\"fig:\",width=221 ]     ( ) , and its upper bound @xmath207 given by ( ) , plotted against @xmath18 .",
    "right hand side : relative error , @xmath338 ( ) , and its upper bound @xmath339 ( ) , plotted against @xmath18 . in both plots",
    "@xmath208 and @xmath5 is approximated by @xmath326.,title=\"fig:\",width=221 ]   ( ) , and its upper bound @xmath207 given by ( ) , plotted against @xmath18 .",
    "right hand side : relative error , @xmath338 ( ) , and its upper bound @xmath339 ( ) , plotted against @xmath18 . in both plots @xmath208 and @xmath5 is approximated by @xmath326.,title=\"fig:\",width=221 ]    in figure [ fig2 ] we see that our pointwise theoretical error bounds are upper bounds as claimed , and that these bounds appear to capture the @xmath18-dependence of the errors fairly well , for example that @xmath340 as @xmath341 , @xmath342 as @xmath343 , and that @xmath259 reaches a maximum at about @xmath344 ( @xmath345 when @xmath208 ) .",
    "the above figures explore the accuracy of the approximation @xmath26 .",
    "let us comment on efficiency .",
    "most straightforward is a comparison of the matlab function ` f(x , n ) ` in table [ matlab_code ] with computation of @xmath5 via the matlab code ` fw(x , m)=exp(i*x.^2).*cef(exp(i*pi/4)*x , m)/2 ` that uses ` cef.m ` from @xcite implementing . both ` f(x , n ) ` and ` cef(x , m ) ` are optimised for efficiency when ` x ` is a large vector .",
    "the main cost in computation of @xmath5 via ` cef ` when @xmath18 is a large vector is a complex vector exponential ( for @xmath330 ) , and the @xmath331 complex vector multiplications and @xmath331 additions required to evaluate the polynomial using horner s algorithm . in comparison ,",
    "evaluation of @xmath5 using ` f(x , n ) ` in table [ matlab_code ] requires 2 complex vector exponentials , and slightly more than @xmath0 real vector multiplications / divisions , real vector additions , complex vector multiplications , and complex vector additions . from figures [ fig1 ] and [ fig3 ] we read off that to achieve absolute and relative errors below @xmath346 requires @xmath347 and @xmath348 ; to achieve errors below @xmath1 requires @xmath2 and @xmath54 .",
    "thus computing @xmath5 via ` f(x , n ) ` requires a substantially lower operation count than computing via ` cef ` .",
    "( we note , moreover , as discussed in ",
    "[ sec other ] and in  7 of @xcite , that , at least for intermediate values of @xmath18 ( @xmath349 ) , the operation counts for ` cef ` are lower than those of the method for @xmath46 of @xcite . )    to test whether ` f(x , n ) ` is faster we have compared computation times in matlab ( version 7.8.0.347 ( r2009a ) on a laptop with dual 2.4ghz p8600 intel processors ) between ` fw(x,36 ) ` and ` f(x,12 ) ` when ` x ` is a length @xmath350 vector of equally spaced numbers between 0 and 1,000 .",
    "the average elapsed times were 11.1 and 15.6 seconds , respectively , so that ` f(x,12 ) ` is almost 50% faster .    turning to @xmath3 and @xmath4 , in figure [ fig4 ] we have plotted the maximum values of the absolute and relative errors in @xmath294 and @xmath293 , computed using ` fresnelcs ` in table [ matlab_codecs ] .",
    "as accurate values for @xmath3 and @xmath4 we use @xmath351 and @xmath352 for @xmath353 while , for @xmath354 ( following @xcite ) we approximate by the series truncated after 15 terms , evaluated by the horner algorithm .",
    "exponential convergence is seen in figure [ fig4 ] : the absolute errors are @xmath355 for @xmath299 , the maximum relative error in @xmath293 is @xmath356 for @xmath357 but that in @xmath294 as large as @xmath358 .",
    "these errors may be entirely acceptable , but the truncated power series must achieve smaller errors for small @xmath18 and is cheaper to evaluate .",
    "( evaluating at @xmath350 equally spaced points between 0 and @xmath359 takes 2.9 times longer in matlab with ` fresnelcs ` than evaluating 15 terms of both the series via horner s algorithm . )     and @xmath297 on @xmath360 .",
    "right hand side : maximum values of @xmath361 and @xmath362 on @xmath360.,title=\"fig:\",width=221 ]   and @xmath297 on @xmath360 .",
    "right hand side : maximum values of @xmath361 and @xmath362 on @xmath360.,title=\"fig:\",width=221 ]",
    "to conclude , we have presented in this paper new approximations for the fresnel integrals , derived from and inspired by modified trapezium rule approximations previously suggested for the complementary error function of complex argument in @xcite .",
    "these approximations are simple to implement ( matlab codes are included in tables [ matlab_code ] and [ matlab_codecs ] ) : the computation of @xmath26 requires a couple of complex exponentiations and a short summation to compute a quadrature sum , and that of @xmath293 and @xmath294 evaluation of trigonometric and hyperbolic functions and a similar short summation . operation counts and timings suggest that @xmath26 with @xmath2 may be faster than previous methods , at least for intermediate values of @xmath38 . in particular , the matlab function in table [ matlab_code ] outperforms that in table 1 of @xcite for this application .",
    "the code for @xmath294 and @xmath293 is faster still , but the power series , truncated after 15 terms , are more accurate and efficient on the interval @xmath363 $ ] , this conclusion endorsing recommendations in @xcite .",
    "part of the motivation for this paper was a remark in weideman @xcite regarding the modified trapezium rule methods of @xcite for computing @xmath246 , that they are `` very accurate , provided for given @xmath47 and @xmath0 [ the finite number of quadrature points retained ] the optimal stepsize @xmath32 is selected .",
    "it is not easy , however , to determine this optimal @xmath32 a priori . ''",
    "at least as far as computing @xmath246 for @xmath364 is concerned ( which , by , is the same as computing @xmath5 ) this problem is solved in this paper , so that the effectiveness of the modified trapezium rule methods of @xcite is clearly demonstrated .",
    "we hope that the methodology and positive results of this paper will inspire further applications of this truncated , modified trapezium rule method .",
    "we finish by flagging that the modified trapezium rule method that we have used in this paper is applicable widely to the evaluation of integrals on the real line of functions that are analytic but with poles near the real axis .",
    "indeed , general theories of the method are presented in bialecki @xcite , hunter @xcite ( and see @xcite , @xcite ) , and in the thesis of one of the authors @xcite , where the emphasis is on the particular case , where the analytic function @xmath365 as @xmath366 .",
    "integrals of the form arise in probabilistic applications @xcite and as representations in integral form of solutions to linear pdes with constant coefficients , after solution by fourier transform methods and deformation of the path of integration to a steepest descent path .",
    "one example which continues to be the subject of computational studies",
    "@xcite is the green s function for the helmholtz equation @xmath367 in a half - space with an impedance boundary condition , @xmath368 . representations for this green s function in terms of a steepest descent path integral of the form , in both the 2d and 3d cases , are given in @xcite , and the application of the truncated modified trapezium rule method is discussed in @xcite .",
    "this paper is dedicated to david hunter , formerly of the university of bradford , uk , who celebrated his 80th birthday in april 2013 .",
    "sadly david passed away on 15 august 2013 .",
    "david was a kind and gentle man and a fine mathematician and teacher and the second author acknowledges his gratitude for david s contribution to his education as a numerical analyst at bradford in the 80s .",
    "we also acknowledge the very helpful and thorough comments of the two anonymous referees .",
    "99 igital library of mathematical functions",
    ". national institute of standards and technology , from http://dlmf.nist.gov/ , release date : 2010 - 05 - 07 ( 2010 ) arens , t. , sandfort , k. , schmitt , s. , lechleiter , a. : analysing ewald s method for the evaluation of green s functions for periodic media , i m a j. appl . math . * 78 * , 405431 ( 2013 ) abramowitz , m. , stegun , i.  a. : handbook of mathematical functions , dover , new york ( 1964 ) bialecki , b. : a modified sinc quadrature rule for functions with poles near the arc of integration , bit * 29 * , 464476 ( 1989 ) bowman , j.  j. , senior , t.  b.  a. , uslenghi , p.  l.  e. : electromagnetic and acoustic scattering by simple shapes , north - holland , amsterdam ( 1969 ) chandler - wilde , s.  n. , hewett , d.  p. , langdon , s. , twigger , a. : a high frequency boundary element method for scattering by a class of nonconvex obstacles .",
    "university of reading , department of mathematics and statistics preprint mps-2012 - 04 ( 2012 ) chandler - wilde , s.n . ,",
    "hothersall , d.  c. : efficient calculation of the green function for acoustic propagation above a homogeneous impedance plane , j. sound vib . *",
    "180 * , 705-724 ( 1995 ) chiarella , c. , reichel , a. : on the evaluation of integrals related to the error function , math . comp . * 22 * , 137143 ( 1968 ) cody , w.  j. : chebyshev approximations for the fresnel integrals , math .",
    "* 22 * , 450453 + s1s18 ( 1968 ) crouch , e.  a.  c. , spiegelman , d. : the evaluation of integrals of the form @xmath369 : application to logistic - normal models , j. amer .",
    ". assoc . * 85 * , 464469 ( 1990 ) durn , m. , hein , r. , ndlec , j .- c . :",
    "computing numerically the green s function of the half - plane helmholtz operator with impedance boundary conditions , numer . math . * 107 * , 295-314 ( 2007 ) fettis , h.  e. , caslin , j.  c. , cramer , k.  r. : complex zeros of the error function and of the complementary error function , math . comp .",
    "* 27 * , 401407 ( 1973 ) gautschi , w. : efficient computation of the complex error function , siam j. numer",
    "* 7 * , 187198 ( 1970 ) goodwin , e.  t. : the evaluation of integrals of the form @xmath370 , proc .",
    ". soc . * 45 * , 241245 ( 1949 ) heald , m.  a. : rational approximations for the fresnel integrals , math . comp . *",
    "44 * , 459461 ( 1985 ) hunter , d.  b. , regan , t. : a note on evaluation of the complementary error function , math",
    "* 26 * , 539541 ( 1972 ) hunter , d.  b. : the numerical evaluation of definite integrals affected by singularities near the interval of integration . in : numerical integration ,",
    ", * 357 * , pp .",
    "kluwer acad .",
    ", dordrecht ( 1992 ) kythe , p.  m. , schferkotter , m.  r. : handbook of computational methods for integration , chapman and hall / crc , boca raton , fl ( 2005 ) la porte , s. : modified trapezium rule methods for the effcient evaluation of green s functions in acoustics .",
    "phd thesis , brunel university , uk ( 2007 ) matta , f. , reichel , a. : uniform computation of the error function and other related functions , j. math .",
    "* 34 * , 298307 ( 1956 ) mori , m. : a method for evaluation of the error function of real and complex variable with high relative accuracy , publ .",
    "rims , kyoto univ . *",
    "19 * , 10811094 ( 1983 ) oneil , m. , greengard , l. , pataki , a. : on the efficient representation of the half - space impedance green s function for the helmholtz equation , wave motion , in press .",
    "poppe , g.  p. , wijers , c.  m. : more efficient computation of the complex error function , acm trans . math .",
    "software * 16 * , 3846 ( 1990 ) poppe , g.  p. , wijers , c.  m. : algorithm 680  evaluation of the complex error functon , acm trans .",
    "software * 16 * , 4747 ( 1990 ) . press , w.  h. , teukolsky , s.  a. , vetterling , w.  t. , flannery , b.  p. : numerical recipes 3rd edition : the art of scientific computing , cambridge university press ( 2007 ) rudin , w. : real and complex analysis , 3rd edition , mc - graw hill ( 1987 ) salzer , h. : formulas for computing the error function of a complex variable , mtac * 5 * , 6770 ( 1951 ) strand , o. : a method for the computation of the error function of a complex variable , math",
    ". comp . * 19 * , 127129 ( 1965 ) turing , a.  m. : a method for the calculation of the zeta - function , proc .",
    "london math .",
    "* s2 - 48 * , 180197 ( 1945 ) weideman , j.  a.  c. : computation of the complex error function , siam j. numer",
    ". anal . * 5 * , 14971518 ( 1994 )",
    "in this appendix we prove theorem [ lemma ] as a corollary of bounds on @xmath93 in the right hand complex plane contained in theorem [ thm : erfc ] below . in particular",
    "follows immediately from and the first bound in , while follows from , , and the second of the bounds .",
    "the bounds in theorem [ thm : erfc ] are well - known in the case @xmath371 ( * ? ? ?",
    "* ( 7.8.2)-(7.8.3 ) ) , and the second bound ( equivalent by to the bound @xmath372 for @xmath373 ) is recently proved by an alternative argument on p.  413 of @xcite .",
    "[ thm : erfc ] for @xmath260 with @xmath218 , @xmath374 , we have that @xmath375 is an entire function which has the properties that @xmath376 and @xmath377 as @xmath378 in the right hand plane , uniformly in @xmath248 ( * ? ? ?",
    "* ( 7.1.23 ) ) .",
    "( these properties imply that the first of the bounds is sharp for @xmath379 and in the limit @xmath378 . )",
    "we will show by showing that holds for all @xmath47 in the right hand plane if it holds on the imaginary axis , and then showing that holds on the imaginary axis .    to see that it is enough to prove that holds for imaginary @xmath47 , observe that , since @xmath246 has no zeros in the right hand complex plane @xcite ( or on the imaginary axis where @xmath380 , see ) , the function @xmath381 is also analytic in the right hand complex plane and is continuous up to the imaginary axis .",
    "moreover , @xmath382 is bounded in the right hand plane since , as observed above , @xmath377 as @xmath378 in the right hand plane ( uniformly in @xmath248 ) .",
    "since @xmath382 is bounded in the right hand plane , it follows from the maximum principle that @xmath383 to see this , note that this equality holds for @xmath384 , with @xmath385 , where @xmath386 with the branch cut taken as the negative real axis .",
    "this is clear since @xmath387 is analytic in the right half - plane , continuous up to the imaginary axis , and vanishes at infinity , so that the standard maximum principle implies that @xmath387 takes its maximum value on the imaginary axis . but then follows by taking the limit @xmath388 .    in view of , to establish we need only show that it holds for @xmath389 with @xmath374 ; indeed , establishing this bound for @xmath390 is sufficient since @xmath391 .",
    "now , for @xmath389 with @xmath390 , using ( * ? ? ?",
    "* ( 7.5.1 ) ) , which implies @xmath392 we see that @xmath393 it is an easy calculus exercise to show the right hand side takes its minimum value on @xmath394 $ ] at either 0 or 1 , and hence that @xmath395 , for @xmath396 , since @xmath397 .",
    "further , implies that @xmath398 , it follows on integrating by parts that @xmath399 since @xmath400 .",
    "thus @xmath401 on @xmath402 and the bound is proved ."
  ],
  "abstract_text": [
    "<S> in this paper we propose methods for computing fresnel integrals based on truncated trapezium rule approximations to integrals on the real line , these trapezium rules modified to take into account poles of the integrand near the real axis . </S>",
    "<S> our starting point is a method for computation of the error function of complex argument due to matta and reichel ( _ j . </S>",
    "<S> math . </S>",
    "<S> phys . _ </S>",
    "<S> * 34 * ( 1956 ) , 298307 ) and hunter and regan ( _ math . comp . _ </S>",
    "<S> * 26 * ( 1972 ) , 539541 ) . </S>",
    "<S> we construct approximations which we prove are exponentially convergent as a function of @xmath0 , the number of quadrature points , obtaining explicit error bounds which show that accuracies of @xmath1 uniformly on the real line are achieved with @xmath2 , this confirmed by computations . </S>",
    "<S> the approximations we obtain are attractive , additionally , in that they maintain small relative errors for small and large argument , are analytic on the real axis ( echoing the analyticity of the fresnel integrals ) , and are straightforward to implement . </S>"
  ]
}