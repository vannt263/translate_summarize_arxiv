{
  "article_text": [
    "the problem of reconstructing an evolutionary history from characters is a classical topic in computational biology  @xcite .",
    "the instance of the problem consists of a matrix @xmath0 where the rows corresponds to species ( or individuals / taxa ) and columns corresponds to characters .",
    "moreover , each entry @xmath1 $ ] is the _ state _ of species @xmath2 and character @xmath3 . notice that each character can be phenotypical ( i.e. ,  a species has wings ) or genotypical ( a cell has a certain mutation ) .",
    "a _ phylogeny _ is a tree @xmath4 where each input species is a node , a character @xmath3 can be gained or lost in each edge of @xmath4 : how a character can be gained or lost in the tree @xmath4 is called the evolution model .",
    "there is a contrast between different evolution models , as more restrictive models  such as the perfect phylogeny  are more informative , but are unable to give a tree consistent with all possible input matrices . on the other hand , more general models , such as camin - sokal  @xcite and dollo  @xcite are always able to produce a tree consistent with the input matrix , but",
    "such tree might not be informative on the actual evolutionary history .    in this paper we will focus on binary characters , that is the state @xmath5 means that a species does not have a character , while the state @xmath6 means that a species has a character .",
    "each edge represents a change of state for some characters during the evolution of the ancestral taxa : a change from @xmath5 to @xmath6 is the gain of a character , while a change from @xmath6 to @xmath5 is the loss of a character .",
    "two main general models have been introduced in the literature to describe character - based evolutions of taxa : the camin - sokal  @xcite and the dollo  @xcite model .",
    "the camin - sokal model assumes that each character may change state from @xmath5 to @xmath6 several times , but no change from @xmath6 to @xmath5 state is allowed .",
    "differently , in the dollo model , characters may change state from @xmath5 to @xmath6 only once in the tree , but they may change state from @xmath6 to @xmath5 multiple times .",
    "the dollo model appears appropriate for reconstructing the evolution of genes in eukaryotic organisms , mainly the gain and loss of genes modeled as change to @xmath6 and to @xmath5 respectively in the taxa .",
    "indeed , while multiple gains of the same gene in different lineages is improbable , multiple losses of a gene are more common  @xcite .",
    "the model recently gained a lot if interest in the context of reconstructing the clonal evolution in tumors due to mutation events taking into account copy number aberrations  @xcite . in this context characters",
    "are mutations that are gained or lost during the clonal evolution .",
    "it is assumed that a given mutation is acquired at most once in the tree , but it may be lost due to the loss of genes related to deletion events .    from the algorithmic point of view",
    ", the dollo model has a trivial decision problem  given a matrix @xmath0 , there is always a tree @xmath4 consistent with @xmath0  and an np - complete optimization problem  find a tree @xmath4 consistent with @xmath0 and minimizing the number of changes of state .    at the other end of the spectrum",
    "lies the perfect phylogeny problem  @xcite which is likely the most restrictive possible model : each character is acquired exactly once in the tree @xmath4 and is never lost . despite its relative simplicity , the perfect phylogeny model has found several applications in biology  @xcite and linguistics  @xcite .",
    "moreover the perfect phylogeny has been extensively studied from a computational point of view , starting from the seminal linear - time algorithm  @xcite for binary matrices , and going on with the np - completeness for the general case of unbounded number of states  @xcite , and the polynomial - time algorithms for any constant number of states  @xcite . moreover ,",
    "the algorithmic properties of some variants of the perfect phylogeny have been recently studied  @xcite restricting the possible state transitions or the topology of the tree .",
    "another result that is especially relevant for our paper is a polynomial - time algorithm for computing the directed perfect phylogeny with missing data  @xcite , where a first reframing of perfect phylogeny as a graph problem .",
    "still , some biological problems require a more general model than the perfect phylogeny model , but need an efficient algorithm to compute an informative tree  @xcite .",
    "in this direction , the notion of a _ persistent _ character have been proposed in  @xcite and later studied  @xcite : a persistent character can change state from @xmath5 to @xmath6 at most once during the evolution then change state from one to zero , again at most once in the entire tree .",
    "the computational problem of constructing a persistent phylogeny , albeit in a different context , has been introduced at least as early as 1996  @xcite , where it takes the name of @xmath7-phylogeny and the open problem of determining its computational complexity has been stated .",
    "recently some algorithms for the ppp have been introduced : more precisely , an algorithm whose time complexity is polynomial in the number of taxa , but exponential in the number of characters  @xcite , and an integer linear programming solution  @xcite .",
    "the ilp formulation uses a reformulation of the ppp as the problem of completing a matrix @xmath8 obtained by doubling columns of the input matrix @xmath0 of the ppp problem ( i.e. adding a persistent copy of the character ) and posing as unknown the state of characters that may be persistent  those characters that have entry @xmath5 in matrix @xmath0 . in",
    "@xcite the ppp problem is restated as a colored graph problem . in this paper",
    "we use this graph framework to design a polynomial time algorithm that solves the ppp problem , settling the question of  @xcite .",
    "an implementation of our algorithm is available at http://www.algolab.eu/persistent-phylogeny .",
    "the input of the ppp problem is an @xmath9 binary matrix @xmath0 whose columns are associated with the set @xmath10 of characters and whose rows are associated with the set @xmath11 of taxa also called _ species _ in the paper .",
    "then @xmath1 = 1 $ ] if and only if the species @xmath2 has character @xmath3 , otherwise @xmath1 = 0 $ ] .",
    "the character @xmath3 is _ gained _ in the only edge where its state goes from @xmath5 to @xmath6 or , more formally , in the edge @xmath12 such that @xmath13 is a child of @xmath14 and @xmath3 has state @xmath5 in @xmath14 and state @xmath6 in @xmath13 . in this case",
    "the edge @xmath12 is labeled by @xmath15 .",
    "conversely , @xmath3 is _ lost _ in the edge @xmath12 if @xmath13 is a child of @xmath14 and character @xmath3 has state @xmath6 in @xmath14 and state @xmath5 in @xmath13 . in the latter case the edge @xmath12 is labeled by @xmath16 . for each character @xmath3",
    ", we allow at most one edge labeled by @xmath16  @xcite .",
    "each character @xmath15 and @xmath17 is called a _ signed _ character .",
    "let @xmath3 be an unsigned character and let @xmath0 be an instance of the ppp problem .",
    "then @xmath18 is the set of species that have the character @xmath3 , that is the set @xmath19 = 1\\}$ ] . given two characters @xmath20 and @xmath21 , we will say that @xmath20 _ includes _",
    "@xmath21 if @xmath22 . then a character @xmath3 of @xmath0 is _ maximal in @xmath0 _ if @xmath23 for any character @xmath24 of @xmath0 .",
    "moreover two characters @xmath25 _ overlap _ if they share a common species but neither is included in the other .",
    "we now introduce the definition of persistent phylogeny used in the paper  @xcite .",
    "[ def : persistent - perfect - phylogeny ] let @xmath0 be an @xmath9 binary matrix over a set @xmath26 of characters and a set @xmath27 of species .",
    "let @xmath28 be a subset of its characters , called _ active _ characters . then",
    "a _ persistent phylogeny _ , in short _ p - pp _ , for the pair @xmath29 is a rooted tree @xmath4 such that :    1 .",
    "each node @xmath14 of @xmath4 is labeled by a vector @xmath30 of length @xmath26 ; 2 .",
    "the root @xmath31 of @xmath4 is labeled by a vector @xmath32 such that @xmath33 if and only if @xmath34 , while for each node @xmath14 of @xmath4 the value @xmath35\\in\\{0 , 1\\}$ ] represents the state of character @xmath36 in the node @xmath14 ; 3 .",
    "each edge @xmath37 is labeled by a character , 4 .",
    "for each character @xmath36 there are at most two edges @xmath38 and @xmath39 such that @xmath35 \\neq l_y[j]$ ] and @xmath40 \\neq l_v[j]$ ] ( representing a change in the state of @xmath36 ) . in that case @xmath41 , @xmath42 occur along the same path from the root of @xmath4 to a leaf of @xmath4 ; if @xmath41 is closer to the root than @xmath42 , then @xmath35=l_v[j]=0 $ ] , @xmath43=l_u[j]=1 $ ] , and the edge @xmath41 is labeled @xmath44 , while @xmath42 is labeled @xmath45 ; 5 .   for each row @xmath14 of @xmath0 there exists a node @xmath14 of @xmath4 labeled by row @xmath14 and such that vector @xmath46 is equal to the row @xmath14 .",
    "set @xmath28 is also called _ active set _ of matrix @xmath0 and we say that the matrix @xmath0 is solved by tree @xmath4 .",
    "observe that the definition of persistent phylogeny allows the internal nodes of @xmath4 to be labeled by species .",
    "the definition given in  @xcite corresponds to the case the set @xmath28 is empty , i.e. the root of a tree @xmath4 is labeled by the length @xmath26 zero vector .",
    "the above generalization allows to consider persistent phylogenies where the root state is not the zero vector .",
    "this fact is relevant when considering subtrees of the phylogenies as solutions of the same problem on subinstances of the input . indeed , notice that subtrees of the tree solving the instance @xmath0 have roots that are not labeled by the zero vector .",
    "if there exists an edge of @xmath4 labeled @xmath16 , then then the character @xmath3 is called _ persistent _ in @xmath4 . moreover , for each character @xmath47",
    "only the edge labeled @xmath16 might appear in the phylogeny .    a special case , called _ perfect phylogeny _ ,",
    "is when no character of @xmath4 is ever lost .",
    "[ def : perfect - phylogeny ] a persistent phylogeny @xmath4 is a _",
    "phylogeny if there are no persistent characters in tree @xmath4 .",
    "since no two edges share the same label of @xmath4 , we might use the label to identify and denote an edge .    given a tree @xmath4 and a node @xmath14",
    ", we say that a character @xmath3 occurs below node @xmath14 if @xmath3 labels an edge of a path from node @xmath14 to a leaf node of tree @xmath4 .",
    "similarly , we say that a node @xmath48 occurs below node @xmath14 if @xmath48 is along a path from node @xmath14 to a leaf of tree @xmath4 .",
    "moreover , we will say that the character @xmath3 is _ above _ the node @xmath14 if there is an edge of the path from @xmath14 to the root that is labeled by @xmath3 .      in this paper ,",
    "our algorithm is based on a graph called the _ red - black graph _ and denoted by @xmath49 .",
    "red - black graphs provide an equivalent representation of matrices that are solved by persistent phylogenies  @xcite .",
    "moreover , the iterative construction or visit of a tree can be restated as applying specific graph operations to the red - black graph . in this section",
    "we recall the main results that we use in our algorithm .",
    "a connected component is called _ nontrivial _ if it has more than one vertex .    [ cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     = [ circle , minimum size=20pt , draw ]     and with set @xmath50 of active characters . ]",
    "[ definition : red - black ] a _ red - black graph _ on a set @xmath51 of species and a set @xmath52 of characters , denoted by @xmath49 , is a bipartite graph whose vertex set is @xmath53 .",
    "moreover each character @xmath54 is incident only on black edges ( in this case @xmath3 is _ inactive _ ) , or it is incident only on red edges ( in this case @xmath3 is _ active _ ) .",
    "given @xmath28 an empty set of active characters and @xmath0 an instance of ppp , the red - black _ associated with @xmath0 _ is the graph @xmath55 that has black edges given by set @xmath56 = 1\\}$ ] .",
    "conversely , given a red - black graph , the following definition of a matrix associated with a red - black graph justifies our use of red - black graphs in place of binary matrices .    given a red - black graph @xmath55 , the matrix @xmath0 _ associated with @xmath57 _ has species @xmath51 and characters @xmath52 and active set @xmath28 given by the characters in @xmath52 with incident red edges .",
    "moreover @xmath1=1 $ ] iff ( 1 ) @xmath58 is a black edge of @xmath57 , or ( 2 ) @xmath3 is active and @xmath58 is not an edge of @xmath49 .",
    "in this paper we use extensively the following notion .    [ definition : red - black+matrix ] let @xmath57 be a red - black graph with active characters @xmath28 .",
    "let @xmath0 be the matrix associated with @xmath57 .",
    "then the persistent phylogeny for @xmath49is the persistent phylogeny for the pair @xmath29 .",
    "if @xmath4 is a persistent phylogeny for @xmath49we also say that @xmath57 is solved by tree @xmath4 .",
    "we recall that , given a vertex @xmath48 of a graph @xmath59 , the _ neighborhood _ of @xmath48 is the set of vertices of @xmath59 that are adjacent to @xmath48 , and it is denoted by @xmath60  @xcite . in a previous paper  @xcite it has been proved that given a persistent phylogeny @xmath4 solving red - black graph @xmath57 , then @xmath4 can be related to a sequence of graph operations on graph @xmath57 which are described in the following definition .",
    "[ definition : realizing - in - red - black - graph ] let @xmath57 be a red - black graph , and let @xmath3 be a character of @xmath49 .",
    "let @xmath61 be the set of species in the connected component of @xmath57 that contains @xmath3 .",
    "the result of the _ realization of @xmath15 on @xmath57 _ , which is defined only if @xmath3 is inactive , is a red - black graph obtained from @xmath49by adding a red edge between @xmath3 and each species in @xmath62 , deleting all black edges incident on @xmath3 , and finally deleting all isolated vertices .",
    "the _ realization of @xmath16 on @xmath57 _ is defined only if @xmath3 is active and there is no species in @xmath62 : in this case the results of the realization is obtained from @xmath57 by deleting all edges incident on @xmath3 , and then deleting all isolated vertices .",
    "the realization of a species @xmath2 is the realization of its set @xmath63 of characters in any order .",
    "an active character @xmath3 that is connected to all species of a graph @xmath57 by red edges is called _ free _ in @xmath57 and it is then deleted from @xmath57 .    the main relationship between a graph @xmath49and the tree solving @xmath49is given by the notion of _ c - reduction _ stated in  @xcite . a c - reduction",
    "@xmath64 is a sequence of positive characters .",
    "a c - reduction @xmath64 is _ feasible _ for @xmath57 if the realization of each character in the sequence @xmath64 one after the other is defined and the realization of a negative character @xmath16 must be applied whenever @xmath16 is free in @xmath49 .",
    "clearly a c - reduction also represents a sequence of graph operations on @xmath49 .",
    "then the _ application _ of a feasible c - reduction @xmath65 to red - black graph @xmath57 is the graph @xmath66 obtained as follows : @xmath67 is the red - black graph @xmath57 , while , when @xmath68 , @xmath69 is obtained from @xmath70 by realizing the character @xmath71 and , eventually all previous characters @xmath72 , for @xmath73 such that @xmath74 is free after the realization of @xmath75 .",
    "then the _ extended _ c - reduction of @xmath64  @xcite is the sequence of positive and negative characters obtained by the application of @xmath64 to @xmath49 .",
    "for example , the c - reduction @xmath76 corresponds to the extended c - reduction @xmath77 , since the character @xmath78 becomes free after the realization of @xmath79 ( see figure  [ fig : extended - reduction ] for the corresponding red - black graph ) .",
    "the following fact that we use in the paper is stated and proved in  @xcite .",
    "tree traversal _ of @xmath4 is a sequence of the nodes of @xmath4 where each node appears exactly once  @xcite and has the additional properties that a node always precedes all of its descendants .",
    "[ prop : traversal ] a tree traversal of the positive characters of a tree @xmath4 solving a graph @xmath57 is a c - reduction @xmath64 that is feasible for @xmath57 and its application to @xmath57 results in an empty graph .",
    "then @xmath64 is called a _",
    "successful reduction _ for @xmath49 .    in",
    "@xcite it has been proved that given a red - black graph @xmath49and a successful reduction @xmath64 , there exists a polynomial time algorithm that computes a persistent phylogeny solving @xmath49 .    based on proposition  [ prop : traversal ]",
    "we observe that a successful reduction for a red - black graph @xmath49can be characterized using the notion of red @xmath80-graph : this is a path of length four induced in @xmath49by a pair @xmath20 and @xmath21 of active characters and by three species @xmath81 and",
    "@xmath82 and @xmath83 . observe that @xmath20 and @xmath21 can not be free in the red - black graph as they can not be connected to all species of the red - black graph by red edges and thus @xmath84 and @xmath85 can not be realized .",
    "consequently , a red - black graph containing a red @xmath80-graph can not be reduced to an empty graph by a c - reduction .",
    "now , the notion of conflicting characters is used to detect candidate pairs of characters that may induce a red @xmath80-graph .",
    "let @xmath0 be a binary matrix and let @xmath20 , @xmath21 be two characters of @xmath0 .",
    "then the configurations induced by the pair @xmath86 in @xmath0 is the set of ordered pairs @xmath87 , m[s , c_{2}])$ ] over all species .",
    "two characters @xmath20 and @xmath21 of @xmath0 are _ conflicting _ if and only if the configurations induced by such pair of columns is the set of all possible pairs @xmath88 , @xmath89 , @xmath90 and @xmath91 .",
    "we say that characters @xmath25 in graph @xmath49are _ conflicting _ if they are conflicting in the matrix associated with @xmath49",
    ". then graph @xmath49contains a conflict if it has a conflicting pair of characters .",
    "the following two main observations  @xcite and lemma  [ lemma : connected - components - grb = children ] will be used in the next sections and are crucial in the polynomial time algorithm for computing a successful reduction for the red - black graph .",
    "[ observation1 ]    a c - reduction @xmath64 for graph @xmath49is successful if and only if @xmath64 includes all characters of the graph and each graph @xmath92 obtained after the realization of the first @xmath93-characters of sequence of @xmath64 does not contain red @xmath80-graphs .",
    "another important observation used in the paper and easy to prove by the definition of realization of a character is the following .",
    "[ observation2 ] a red - black graph consisting of @xmath94 distinct components has a successful reduction @xmath64 if and only if each component @xmath92 has a successful reduction @xmath95 .",
    "then @xmath64 consists of any concatenation of the @xmath94 sequences @xmath95 .",
    "[ lemma : connected - components - grb = children ] let @xmath49be a red - black graph solved by @xmath4 . if @xmath49is connected then the root @xmath31 of @xmath4 has only one child .",
    "we will assume that the instances of the ppp problem do not contain any free , null or universal characters ( a null character is an isolated vertex of the red - black graph , while a universal character is adjacent to all species of the red - black graph by black edges - ) , or a null species ( a species that possesses no characters ) .",
    "notice that the removal of null characters does not modify the phylogeny , while a null species can only be associated to the root of the phylogeny . removing a universal character",
    "trivially consists of fixing the first character of a c - reduction or , equivalently , determining the label of a topmost edge of the phylogeny .",
    "moreover , we will assume that the instances of the ppp problem do not have two identical columns .",
    "a _ reducible _ red - black graph @xmath49is an instance of the ppp problem that admits a successful reduction , i.e. it is solved by a persistent phylogeny , and @xmath49is a connected graph .",
    "the red - black graph _ induced in @xmath57 by a set @xmath96 of characters _ , denoted as @xmath97 , consists of the subgraph @xmath98 of @xmath57 induced by the set all characters in @xmath96 and the species of @xmath57 that are adjacent to @xmath96 .    given a red - black graph @xmath57 and its associated matrix @xmath0 , then a character @xmath3 of @xmath57 is _ maximal _ in @xmath57 if it is maximal among the inactive characters of @xmath0 .",
    "then we denote by @xmath99 the set of maximal characters for a red - black graph @xmath57 .",
    "a _ maximal reducible _ graph consists of a reducible red - black graph whose characters are all maximal and inactive in the graph .",
    "then @xmath100 is the maximal reducible graph induced by @xmath99 in graph @xmath49 . in the paper",
    "we denote by @xmath101a maximal reducible graph and by @xmath102 a tree solving a maximal reducible graph .    given a tree @xmath4 ,",
    "a path @xmath103 of the tree is _ simple _ if it consists of internal nodes of outdegree and indegree one .",
    "our polynomial time algorithm for solving the ppp problem computes a successful reduction of a red - black graph @xmath49associated to the input matrix @xmath0 in polynomial time , if it exists .",
    "then the algorithm in  @xcite can be used to build a tree @xmath4 from the successful reduction .",
    "the computation of a successful reduction for @xmath49is done by computing the hasse diagram @xmath104 of its maximal reducible graph @xmath101obtained as the restriction @xmath100 , where @xmath99 is the set of maximal characters of @xmath49 . in the following , given @xmath2 a species , by @xmath63 we denote the set of characters of @xmath2 .",
    "let @xmath105 be a maximal reducible graph .",
    "then the diagram @xmath104 for @xmath105 is the hasse diagram for the poset @xmath106 of all species of @xmath105 ordered by the relation @xmath107 , where @xmath108 if @xmath109 .",
    "given @xmath106 the poset of all inactive species of a red - black , we consider the representation of the poset @xmath106 by its hasse diagram ( or simply diagram ) , represented by a directed acyclic graph @xmath110  @xcite .",
    "more precisely , two species @xmath111 and @xmath112 are connected by the arc @xmath113 if @xmath114 and there does not exist a species @xmath115 such that @xmath116 .",
    "the definition of @xmath117can be immediately translated into a polynomial time construction algorithm  @xcite .",
    "the main notions that we use in the following related to a diagram @xmath104 are those of _ source _ , _ sink _ and _ chain_. a _ source _ is a node of indegree @xmath5 and a _ sink _ a node of out - degree @xmath5 . in particular , a _ chain _ of @xmath104 is a direct path of @xmath104 from a source to a sink of @xmath104 . observe that each edge @xmath118 of diagram @xmath104 is labeled by the set of positive characters that are in @xmath119 and not in @xmath120 .",
    "a chain is _ trivial _ if it consists of a singleton in the diagram .",
    "thus a diagram @xmath104 consisting only of trivial chains is called _",
    "degenerate_. given a chain @xmath121 of the diagram @xmath104 for a graph @xmath101 , we associate to it a c - reduction .    the c - reduction of the chain @xmath122 of the diagram @xmath104 for a graph @xmath101is the sequence of characters of @xmath111 and those labeling the arcs @xmath123 for @xmath124",
    ".    the following two notions of _ safe chain _ and _ safe source _ are crucial for building our algorithm .",
    "observe that the notion of safe chain is related to a maximal reducible graph @xmath100 while the notion of safe source is related to a reducible graph @xmath57 .",
    "some examples are in the appendix as figures  [ fig : maximal - reducible - grb ] and  [ fig : safe - chain ] .",
    "[ definition : safe - chain ] let @xmath101be a maximal reducible red - black graph , let @xmath104 be the diagram for @xmath101 , and let @xmath125 be a chain of @xmath104 .",
    "then @xmath125 is _ safe _ if the c - reduction @xmath126 of @xmath125 is feasible for the graph @xmath101and applying @xmath126 to @xmath101results in a graph that has no red @xmath80-graph .",
    "[ definition : safe - source ] let @xmath49be a red - black graph , let @xmath104 be the diagram for @xmath100 .",
    "a source @xmath2 of a chain @xmath125 of diagram @xmath104 is _ safe for @xmath57 _ if the realization of @xmath2 in @xmath57 does not induce red @xmath80-graphs in @xmath57 .",
    "the polynomial time algorithm for finding a successful reduction of a graph @xmath49starts with the detection in the graph of universal or free characters , which must be realized as the first characters in the graph",
    ".    then the algorithm applies observation  [ observation2 ] : if @xmath49is disconnected then we decompose a red - black graph into its connected components , solve recursively each component separately , and finally concatenate all successful reduction computed .",
    "therefore we focus only on instances corresponding to connected red - black graphs .",
    "by lemma  [ lemma : connected - components - grb = children ] any tree @xmath4 solving a connected @xmath49has a unique child of the root @xmath31 . moreover a direct consequence of the definition of maximal character in @xmath49is that the edge incident to @xmath31 is labeled by at least a maximal character .    clearly , given @xmath99 the set of maximal characters of @xmath49 , the tree @xmath4 contains a solution @xmath102 for the subgraph @xmath100 where @xmath102 is obtained from @xmath4 by contracting all edges that are not labeled by characters in @xmath99 .",
    "the first main results of our paper is that the tree @xmath102 has a very specific topology that is strictly related to the one of all other possible solutions for @xmath100 and this form is computed from the hasse diagram @xmath104 for @xmath100 .",
    "more precisely , if @xmath104 is not degenerate then there are at most two trees @xmath127 solving @xmath100 : in this case @xmath128 is obtained from @xmath129 by reversing a path form an internal node to a leaf of @xmath129 .",
    "if @xmath104 is degenerate , then there can be multiple solutions for @xmath100 , but again given two trees @xmath127 solving @xmath100 , @xmath128 is obtained from @xmath129 by reversing a path form an internal node to a leaf of @xmath129 .",
    "now , using the hasse diagram , we can compute in polynomial time for each tree @xmath102 solving @xmath100 the maximal characters that label the longest path of @xmath102 that starts from the root and is labeled by positive characters : such path is given by a safe chain of diagram @xmath104 . if the diagram @xmath104 has multiple safe chains , we are able to choose in polynomial time the correct chain , i.e. the correct tree @xmath102 , by testing the source of the chain using @xmath49 : this is given by the notion of safe source ( definition  [ definition : safe - source ] ) stated before . more precisely ,",
    "a tree @xmath4 solving @xmath49 , and equivalently a successful reduction of @xmath49 , starts with the sequence of maximal characters of a safe source of the diagram @xmath104 .",
    "the above observations are applied in the following two main steps of the algorithm used for computing a successful reduction of a reducible red - black graph @xmath49 .",
    "_ step 1 : _ compute the hasse diagram @xmath104 for the maximal reducible graph @xmath100 . then find a safe source @xmath2 of @xmath104 .",
    "theorems  [ theorem : any - initial - source ] and  [ theorem : any - source - degenerate ] show that there exists a tree @xmath4 for @xmath57 that starts with the characters of @xmath2 .",
    "_ step 2 : _ update graph @xmath49with the realization of the characters of the safe source @xmath2 . by theorem  [ main - characterization ]",
    "the updated graph @xmath49is still reducible and the algorithm is then applied recursively on @xmath49 .    finally , observe that the correctness of the algorithm is based on the above theorems stating characterizations of trees solving maximal reducible graphs and reducible graphs .",
    "whenever the input of the algorithm is a non reducible graph , the above two steps fail .",
    "the rest of the paper presents the arguments that algorithm  [ alg : reduction ] ( * reduce * ) that computes a successful reduction of a reducible graph .",
    "in this section we consider only maximal reducible graphs and give a characterization of the trees solving such graphs .",
    "observe that we assume that a simple path in a tree @xmath4 between two species may be contracted to a unique edge that is labeled by the sequence of characters occurring along the path .",
    "we distinguish three types of edges in a tree : _ positive edges _ that are only labeled by positive characters , _ negative edges _ that are only labeled by negated characters and _ mixed _ ones , where both positive and negative characters occur .    in the paper we consider two main types of trees representing the persistent phylogenies solving maximal reducible graphs : line - trees and branch - trees .",
    "a tree @xmath4 is a _ line - tree _ if it consists of a simple path .",
    "a tree @xmath4 is a _ branch - tree _ if it consists of a simple path from the root @xmath31 to a node @xmath14 that is the topmost node with more than one child , and no positive character occurs below node @xmath14 : in this case the path from @xmath31 to node @xmath14 is called the _ initial - path _ of the tree @xmath4 , and the node @xmath14 is called the _ branch - node _ of @xmath4 .",
    "[ lemma : tree - structure - max ] let @xmath101be a maximal reducible graph and let @xmath102 be a solution of graph @xmath101 . then @xmath102 is either a line - tree or a branch - tree .",
    "let @xmath102 be any solution of @xmath101and let @xmath14 be the topmost node of tree @xmath4 that has at least two children .",
    "if @xmath14 does not exist , then @xmath4 is a line - tree , and thus the lemma holds . by lemma  [ lemma : connected - components - grb = children ] ,",
    "@xmath14 is not the root , hence in the initial path there is an edge labeled by a positive character .",
    "in fact , if the first character of tree @xmath102 is a negated character , it means that @xmath101has an active character connected to all species of @xmath57 which is not possible as the graph @xmath57 is reduced .",
    "assume that below @xmath14 there exists an edge labeled @xmath130 .",
    "since graph @xmath101is connected , there must exist a positive character @xmath131 in the initial path of tree @xmath102 such that is negated below the node @xmath14 .",
    "indeed , if all characters are negated before node @xmath14 , it must be that all positive characters below node @xmath14 are disjoint from the other characters of the initial path which contradicts the assumption that the graph @xmath101is connected .",
    "assume that @xmath132 occurs along a branch distinct from the one having character @xmath133 .",
    "then @xmath134 is greater than @xmath135 and this contradicts the assumption that @xmath135 is a maximal character , i.e. all characters of @xmath102 are maximal in @xmath101 .",
    "indeed , observe that all species having @xmath135 have also character @xmath134 .",
    "otherwise , assume that @xmath132 and @xmath130 occur along the same branch of tree @xmath102 .    then let us consider the edge @xmath41 outgoing from @xmath14 that is not in the same branch as @xmath130 . if such edge @xmath41 is labeled by a positive edge @xmath136 , then @xmath137 is smaller than @xmath134 and is not maximal , which contradicts the initial assumption that characters are maximal ones .",
    "indeed , @xmath138 occurs along a branch distinct from the one having @xmath139 and thus all species with @xmath137 have also have character @xmath134 .",
    "otherwise edge @xmath41 is labeled by character @xmath140 .",
    "but then @xmath137 is greater than @xmath135 , contradicting the assumption that all characters are maximal .",
    "indeed , observe that all species including character @xmath135 have also character @xmath137 .    given a line - tree @xmath141",
    "whose sequence of species of a depth - first traversal is @xmath142 , the inverted tree @xmath143 has the sequence of species @xmath144 .",
    "moreover , the label of each edge @xmath145 in @xmath143 has the same characters as the edge @xmath123 in @xmath129 , but with opposite signs ( positive characters in @xmath129 are negative characters in @xmath143 and vice versa ) .",
    "[ lemma : invert - line - trees ] let @xmath101be a maximal reducible graph solved by a line - tree @xmath102 .",
    "then the line - tree @xmath141 obtained from @xmath102 inverting the entire tree is a solution for @xmath101 .",
    "it is an immediate consequence of the observation that @xmath146 has no active character , by our definition of maximal reducible graph .",
    "[ lemma : tree - structure - max1 ] let @xmath101be a maximal reducible graph , let @xmath102 be a solution of @xmath101 , and let @xmath25 be overlapping characters occurring in tree @xmath102 and inactive in @xmath101 .",
    "then one of the following cases hold :    * @xmath102 contains the sequence of edges @xmath15 @xmath147 , @xmath16 , @xmath148 , with @xmath148 eventually missing ; * @xmath102 contains the sequence of edges @xmath147 @xmath15 , @xmath148 , @xmath16 , with @xmath16 eventually missing ; * @xmath16 and @xmath148 appear in two distinct paths , and @xmath102 has a species preceding both @xmath15 and @xmath147 if they are conflicting in @xmath105 .",
    "since @xmath3 and @xmath149 are maximal characters , if all four edges @xmath15 , @xmath147 , @xmath16 , @xmath148 appear in the same path , the relative order of @xmath15 and @xmath147 must be the same as @xmath16 @xmath148 , otherwise there is a containment relation between characters , i.e. either @xmath3 includes @xmath149 or vice versa , contradicting the fact that characters are maximal ones .",
    "let us now consider the case that @xmath16 and @xmath148 appear in two distinct paths of @xmath102 . by lemma  [ lemma : tree - structure - max ] , @xmath4 is a branch - tree .",
    "if they are in conflict in @xmath105 , there must exists a species @xmath2 of such graph that induces the @xmath150 configuration in columns for characters @xmath25 and such species must occurs before @xmath3 , @xmath149 in tree @xmath4 .",
    "in fact , in the tree , since they are negated along distinct paths , it means that the only way to have a species with the @xmath150 configuration is just to have such species node before the occurrence of @xmath3 and @xmath149 .",
    "the following proposition is an immediate consequence of the definition of branch - tree and the fact that a maximal reducible graph contains no null character .",
    "[ proposition : branch - node - all - characters ] let @xmath101be a maximal reducible graph solved by a branch - tree @xmath102 , and let @xmath14 be the branch - node of @xmath102 . then the state of @xmath14 consists of all characters of @xmath101 .",
    "[ lemma : induced - subgraph ] let @xmath57 be a connected red - black graph and let @xmath101be the subgraph of @xmath57 induced by the maximal characters of @xmath57 .",
    "then @xmath151 is a connected graph .",
    "assume to the contrary that @xmath101is not connected .",
    "since @xmath57 is connected , there exists a character @xmath3 in @xmath57 that is adjacent to two species @xmath111 and @xmath112 belonging to two distinct connected components of the graph @xmath101 , but @xmath3 is not in the graph @xmath101 , i.e. , @xmath3 is not maximal .",
    "since @xmath3 is not maximal , it must be contained in a maximal character @xmath152 , hence @xmath152 is adjacent to both @xmath111 and @xmath112 in @xmath101 , contradicting the assumption that @xmath111 and @xmath112 belong to two different connected components of @xmath101 .",
    "thus given a character @xmath149 of a given component of @xmath105 either @xmath3 is disjoint from @xmath149 or share a common species with @xmath149 .",
    "but since @xmath3 is adjacent to a species @xmath153 such that @xmath153 is in a component that is distinct from the one having @xmath149 , and since @xmath149 is maximal in @xmath57 , it follows that @xmath3 and @xmath149 are not comparable .",
    "consequently , since @xmath3 is disjoint or is not comparable with any other character in @xmath57 , it follows that @xmath3 is also maximal , thus contradicting the initial assumption that @xmath105 is not connected .",
    "in this section we explore a characterization of the hasse diagram associated to maximal reducible graphs .    for our purposes we are interested only in solutions of a maximal reducible graph @xmath101that is in a special form that we call _ normal form_.",
    "such a form requires that a tree @xmath4 does not have two consecutive edges @xmath154 each labeled by @xmath155 and @xmath156 respectively .",
    "[ normal - form - maximal ] let @xmath102 be a tree solving a maximal reducible graph @xmath101 .",
    "then tree @xmath102 can be transformed into a tree @xmath157 that solves @xmath101and is in normal form .",
    "assume that tree @xmath102 has two consecutive edges @xmath154 each labeled by @xmath155 and @xmath156 respectively .",
    "we distinguish the case that @xmath158 ends before or in the branch - node or @xmath158 ends below the branch - node .",
    "observe that in the last case it must be that @xmath159 ends in the branch - node , as by definition of branch - tree no positive character can be below the branch - node .",
    "now , if the first case holds , then by construction of the tree @xmath102 , it must be that @xmath159 ends in a species @xmath81 . since the species @xmath81 is the first species having @xmath155 while soon after @xmath156 is introduced , it is immediate that @xmath3 is not a maximal character , which is a contradiction with the fact that @xmath102 solves @xmath57 . thus the only possible case occurs when @xmath159 ends in the branch - node @xmath14 of the tree @xmath102 and @xmath14 is not labeled by a species ,",
    "otherwise again @xmath3 is not a maximal character in @xmath101 .",
    "now , the species @xmath82 that is the end of @xmath158 does not have character @xmath3 , while all the other species @xmath2 below @xmath14 along the branches distinct from the one containing @xmath82 have character @xmath3 . observe that we can transform tree @xmath102 into a tree @xmath157 by introducing species @xmath82 above the branch - node @xmath14 .",
    "then @xmath155 is introduced below species @xmath82 along the edge @xmath160 .",
    "observe that this change is possible in tree @xmath102 , since if there exist a subtree with root @xmath82 , then @xmath3 is not maximal in tree @xmath102 .",
    "thus such subtree does not exist .",
    "then @xmath157 is in normal form .",
    "the following lemma shows that the hasse diagram for a maximal reducible graph @xmath100 contains a safe chain .",
    "[ lemma : initial - chain ] let @xmath104 be the diagram for a maximal reducible graph @xmath101 .",
    "let @xmath102 be a tree of @xmath101such that the child @xmath14 of the root @xmath31 is a source of the diagram @xmath104 .",
    "then the longest path @xmath161 of @xmath102 containing the root @xmath31 of @xmath102 and consisting only of positive edges corresponds to a safe chain of @xmath104 , called the _ initial chain _ of tree @xmath102 .",
    "consider a tree @xmath102 solving the maximal reducible graph @xmath101 .",
    "since @xmath101cannot have singletons , the edge of @xmath102 incident on the root must be positive , hence @xmath162 . by construction of tree",
    "@xmath4 solving @xmath57 , each node @xmath163 of tree @xmath102 is labeled by a species , while @xmath14 is not a species only if @xmath14 is the branch - node of @xmath102 .",
    "first consider the case that @xmath14 is not a species .",
    "then @xmath14 is the branch - node of @xmath102 . by proposition  [ proposition : branch - node - all - characters ] ,",
    "the state of @xmath14 consists of all characters of @xmath101 .",
    "assume that the path @xmath164 consists of the single edge @xmath165 , i.e no species is along the initial path of tree @xmath102 .",
    "then we show that tree @xmath4 can not be in normal form . since @xmath102 is a branch tree , and @xmath165 is the only edge of the initial path of a solution of @xmath101 , none of the species of @xmath101are comparable , hence the hasse diagram @xmath104 of @xmath101consists of singletons @xmath2 .",
    "clearly , the tree @xmath4 must have two consecutive edges one labeled @xmath155 and the other labeled @xmath156 which is not possible in the normal form .",
    "indeed , we can obtain a new solution @xmath141 from @xmath4 by replacing the edge @xmath165 with the path @xmath166 ( such replacement is always possible since the set of characters of @xmath2 is a subset of the characters of @xmath14 ) .",
    "it is immediate to notice that @xmath141 is a solution of @xmath101and the trivial chain of @xmath104 consisting of the singleton @xmath2 corresponds to the path @xmath167 which is the initial path of @xmath141 .",
    "thus this case proves the lemma .",
    "now consider the case that @xmath14 is a species .",
    "let @xmath168 be the path @xmath164 of @xmath102 , where all @xmath163 are species of @xmath49and @xmath169 , i.e. at least two species label the initial path of tree @xmath102 .",
    "notice that each edge @xmath170 of @xmath171 is either an arc of @xmath104 or a path of @xmath104 : in the latter case replace in @xmath102 the edge @xmath170 of @xmath4 with the corresponding path of @xmath104 .",
    "it is immediate to notice that the resulting tree is still a solution of @xmath49 .",
    "since @xmath171 is the longest path including positive edges , we show that @xmath172 must be a sink of the diagram @xmath104 .",
    "indeed , given a species @xmath2 that is a descendant of species @xmath172 , edges that follows @xmath172 in tree @xmath102 are mixed edges or negative edges .",
    "since it is not possible to have two consecutive edges with @xmath155 , @xmath156 , because of the normal form , it follows that any species @xmath2 does not include at least a character of @xmath173 . hence @xmath2 can not include species @xmath172 which must be a sink of the diagram",
    "if @xmath174 is not a source of @xmath104 , then @xmath175 is an edge of @xmath104 , hence the set of characters of @xmath176 is a subset of the set of characters of @xmath174 .",
    "since the edge @xmath177 of @xmath102 is labeled by the characters of @xmath174 , then we can replace the edge @xmath177 of @xmath102 with the path @xmath178 .",
    "we can iterate the process until the child of @xmath31 in the tree is the source of the chain .",
    "the chain is safe since the corresponding c - reduction is the initial portion of the c - reduction associated to the tree @xmath102 solving @xmath101 .    as a main consequence of lemma  [ lemma : initial - chain ] we are able to show that given @xmath49reducible there exists a tree @xmath4 solving @xmath57 such that it starts with the inactive characters of a source @xmath2 of a safe chain of diagram @xmath104 for @xmath100 .",
    "since such a safe source may not be unique in diagram @xmath104 , the rest of the section provides results that will be used to show that we can choose any safe source of the diagram @xmath104 to find the initial characters of a tree @xmath4 solving @xmath49 .",
    "[ lemma : initial - source ] let @xmath49be a reducible graph and @xmath104 the diagram for the graph @xmath100 .",
    "then there exists a solution @xmath4 of @xmath49and a child @xmath14 of the root @xmath31 of @xmath4 such that @xmath179 is the set of characters of a safe source @xmath2 of @xmath104 .",
    "the vertex @xmath14 is called the _ initial state _ of the tree @xmath4 .",
    "given a solution @xmath4 of @xmath49 , we denote with @xmath180 the least common ancestor of all species of @xmath49 in @xmath4 . without loss of generality",
    ", we can assume that there is a single edge from the root of @xmath4 to @xmath180 .",
    "let @xmath141 be a solution of @xmath49such that node @xmath180 minimizes the number of characters of @xmath181 .",
    "we distinguish two cases , according to whether @xmath180 is a species of @xmath49 .",
    "case 1 : assume initially that @xmath180 is a species , hence @xmath182 is a node of the diagram @xmath104 . by our construction , @xmath182 can not have an incoming arc in @xmath104 , otherwise we would contradict the minimality of @xmath141 .",
    "then we can split the edge @xmath183 of @xmath141 into two edges @xmath165 and @xmath184 where the label of @xmath165 is @xmath179 .",
    "clearly , by construction there exists a species @xmath2 of @xmath104 with the set @xmath179 of characters and @xmath2 is a source node of the diagram @xmath104 . consider the tree @xmath185 that is induced by the maximal characters of @xmath57 and such that @xmath2 is the child of the root of @xmath185 and is a source of diagram @xmath104 . by applying lemma  [ lemma : initial - chain ] ,",
    "tree @xmath185 has the initial - chain which is a safe chain of diagram @xmath104 .",
    "finally , since @xmath2 is obtained by the traversal of tree @xmath129 , @xmath2 is safe in @xmath57 and being the source of a safe chain of diagram @xmath104 is a safe source of @xmath57 , as desired .",
    "moreover , it must be that @xmath2 is the source of the safe chain of diagram @xmath104 which is the initial chain of tree @xmath186 , thus proving what is required .",
    "case 2 : assume now that @xmath180 is not a species .",
    "it is immediate to notice that the tree @xmath187 , which is a solution of @xmath188 must be a branch - tree , by lemma  [ lemma : tree - structure - max ] .",
    "moreover , by proposition  [ proposition : branch - node - all - characters ] , @xmath189 .",
    "let @xmath14 be any species of @xmath49such that the species @xmath2 with set of characters @xmath179 is a source of the diagram @xmath104 .",
    "just as for the previous case , we can split the edge @xmath183 of @xmath141 into two edges @xmath165 and @xmath184 where the label of @xmath165 is given by @xmath179 .",
    "then @xmath179 is the set of characters of a species @xmath2 of tree @xmath187 where @xmath2 is the source of the diagram @xmath104 of @xmath187 .",
    "similarly as above for case 1 , @xmath2 is a safe source of @xmath57 .",
    "the following technical lemma is used to characterize the safe chains of the diagram @xmath104 of a maximal reducible graph .",
    "[ lemma : prelim - inverted ] let @xmath101be a maximal reducible graph , let @xmath104 be the diagram for @xmath101 , and let @xmath102 be a tree solving @xmath101 . given a chain @xmath125 of the diagram @xmath104 , then one of the following statements holds :    1 .",
    "@xmath125 is a sequence of species that occur along a path @xmath103 of the tree @xmath102 , where @xmath103 has only positive edges , 2 .",
    "@xmath125 is a sequence of species that occur along a path @xmath103 of the tree @xmath102 , where @xmath103 has only negative edges , 3 .",
    "@xmath125 is a sequence of species that occur along a path @xmath190 consisting only of positive edges and along a path @xmath191 consisting only of negative edges , where paths @xmath190 and @xmath191 are subpaths of the same path and for any character @xmath156 of path @xmath191 @xmath155 occurs along the path that connects @xmath190 to @xmath191 .",
    "assume that chain @xmath125 has source @xmath2 and sink @xmath192 , let us first show that species of a chain are along the same path @xmath103 of tree @xmath102 that occurs from the root to a leaf of tree @xmath102 , by proving its contrapositive .",
    "let @xmath193 be two species that are not in the same path of @xmath4 . by the structure of tree @xmath102 stated in lemma  [ lemma : tree - structure - max ] ,",
    "then the least common ancestor @xmath14 of @xmath193 is neither @xmath2 nor @xmath153 , and the paths from @xmath14 to @xmath2 and @xmath153 contain only negative edges .",
    "those two facts imply @xmath2 and @xmath153 are not comparable , hence they can not be in a chain .",
    "thus a chain corresponds to a path of tree @xmath4 .",
    "assume first that tree @xmath102 is a line - tree : in this case we can prove that only cases ( 1 ) or ( 2 ) can happen .",
    "assume to the contrary that the path of @xmath102 connecting @xmath2 and @xmath192 contains both positive and negative edges ( or mixed edges ) .",
    "assume initially that @xmath2 is an ancestor of @xmath192 , and consider the negated character @xmath16 that is the first to appear in such path ( and let @xmath194 be the edge labeled by @xmath15 ) .",
    "observe that by lemma  [ lemma : tree - structure - max1 ] characters are negated in the same order as they are introduced , hence the edge @xmath15 either labels the first edge of the path or it does not label any edge of the path . in both cases , @xmath111 has the character @xmath3 , while @xmath112 has not , hence contradicting the assumption that @xmath194 is an edge of the hasse diagram .",
    "a similar argument holds when @xmath192 is an ancestor of @xmath2 and to show that a chain my label a path only consisting of negative edges .",
    "consider now the case when @xmath102 is a branch - tree .",
    "if the path connecting @xmath2 and @xmath192 in @xmath102 is entirely contained in the initial path or it is composed only of descendants of the branching node , then condition ( 1 ) and ( 2 ) respectively holds .",
    "hence we only have to consider the case when the @xmath195 path contains both ancestors and descendants of the branch node .",
    "we split this path into @xmath196 and @xmath197 which are the two subpaths of @xmath103 containing the ancestors and the descendants of the branch node , respectively , and from which species of chain @xmath125 are obtained .",
    "let @xmath198 be the last species of @xmath196 and let @xmath199 be the first species of @xmath197 : clearly @xmath200 is an edge of @xmath104 .",
    "the same argument used for the line - tree case also proves that @xmath196 does not contain any negated character @xmath16 .",
    "moreover , the edge @xmath201 of @xmath102 can not be labeled by a negated character @xmath16 , unless character @xmath155 is introduced after species @xmath202 along the path that connects @xmath202 to @xmath203 .",
    "indeed , if @xmath155 is on path @xmath190 no species of @xmath197 can have @xmath3 , while @xmath198 has @xmath3 , contradicting the fact that @xmath204 is an edge of @xmath104 . by lemma  [ lemma : tree - structure - max1 ]",
    "all edges of @xmath197 must be negative , completing the proof .",
    "now we are able to show the next lemma that gives a characterization of the safe chains of diagram @xmath104 of a maximal reducible graph and thus it allows to characterize the distinct safe sources of @xmath49 . in the next lemma",
    "we use the notion of inverted path :    a path @xmath205 from a node @xmath206 of @xmath4 to a node @xmath48 of @xmath4 is inverted in tree @xmath129 if the sequence @xmath207 of species of the path @xmath205 is replaced in @xmath129 by sequence @xmath208 .",
    "[ lemma : inverted - tree+safe ] let @xmath101be a maximal reducible graph and let @xmath125 and @xmath209 be two safe chains with distinct sources , where @xmath209 is not trivial .",
    "let @xmath102 be a tree solving @xmath101such that @xmath125 is the initial chain of @xmath102 .",
    "then @xmath102 is a line - tree and @xmath209 is the initial chain of a line - tree @xmath141 such that the path @xmath210 where @xmath31 is the root of @xmath102 and @xmath48 the leaf of @xmath102 is inverted in tree @xmath129 .    0.3     of case 1 of lemma  [ lemma : inverted - tree+safe ] induced by @xmath211    0.3     of case 1 of lemma  [ lemma : inverted - tree+safe ] induced by @xmath211    first observe that by definition of @xmath101the graph has no active characters . by lemma  [ lemma : prelim - inverted ] given chain @xmath212 , the following cases are possible : ( 1 ) the sequence @xmath212 labels a path of tree @xmath102 consisting of positive edges or ( 2 ) @xmath212 labels a path of tree @xmath102 consisting of negative edges ( 3 ) @xmath212 labels two paths @xmath190 and @xmath191 , where @xmath190 consists of positive edges and @xmath191 consists of negative edges of tree @xmath102 , and both paths occur along the same path of tree @xmath102 and for any character @xmath156 of @xmath191 , it holds that @xmath155 labels only edges of the path that connects the two paths",
    ".    case 1 .",
    "( figure  [ fig : chain1 ] ) .",
    "assume first that sequence @xmath212 consists of @xmath213 and labels a path in tree @xmath102 consisting of positive edges @xmath214 of the tree i.e. species @xmath215 is the end of a positive edge labeled @xmath216 .",
    "w.l.o.g .",
    "we assume that each edge is labeled by a single character ( the same argument applies in the case an edge is labeled by more than one character ) .",
    "now , since @xmath212 is not the initial chain of tree @xmath102 , it must be that it occurs after chain @xmath121 in tree @xmath102 .",
    "we distinguish two cases .",
    "now , let @xmath217 be a character of @xmath81 that is from a species @xmath218 that precedes @xmath81 along the initial path . we now show that @xmath219 and @xmath217 are in conflict in graph @xmath101",
    "observe that they are not comparable as they are maximal ones , but there exists also two species in graph @xmath101 , one that has both characters , which is the species @xmath81 and one that does not have both characters . since @xmath81 is the source of chain @xmath212 , then @xmath81 must be preceded by an edge labeled @xmath220 .",
    "but , @xmath133 precedes character @xmath221 as characters are negated in the order they are introduced ( see lemma  [ lemma : tree - structure - max1 ] ) and thus @xmath133 is introduced in a species @xmath82 distinct from @xmath218 and not having characters @xmath222 ( by the normal form of tree @xmath102 , @xmath133 and @xmath220 can not label two consecutive edges ) .",
    "this fact proves that in graph @xmath101species @xmath82 does not have @xmath222 .",
    "consequently , characters @xmath222 are in conflict in @xmath101 . then @xmath222 induce a red @xmath80-graph in @xmath101when the source species @xmath81 and @xmath219 are realized , since the species @xmath82 with configurations @xmath150 and species @xmath218 with configuration @xmath223 for the pair @xmath224 are not removed from graph @xmath101 .",
    "hence we obtain a contradiction with the fact that the chain @xmath212 is safe , i.e it has a safe source .",
    "assume that there does not exist any character @xmath225 of @xmath81 that belongs also to a species @xmath226 that precedes @xmath81 along the initial path , that is @xmath111 has none of the characters labeling the path of @xmath102 from the root to @xmath111 .",
    "hence we can obtain a new solution @xmath141 for @xmath101by regrafting the subtree of @xmath102 rooted at @xmath111 as a new child of the root . by lemma  [ lemma : connected - components - grb = children ] , the graph @xmath101is disconnected , which is a contradiction .",
    "since both cases 1.1 and 1.2 are not possible , then case 1 is not possible .",
    "( figure  [ fig : chain2 ] ) .",
    "assume that sequence @xmath212 consists of @xmath227 and is induced by a path in tree @xmath102 of negative edges @xmath228 of the tree @xmath102 , ( i.e. ,  each edge @xmath229 being labeled by @xmath230 )  by maximality of all characters of @xmath101 , no two negated characters can label the same edge . by lemma  [ lemma : tree - structure - max1 ] the sequence of characters @xmath231 appears in the initial path above the edge @xmath232",
    " notice that those positive characters might be interleaved with other characters .",
    "first we will prove that no such interleaving can happen , that is no positive character occurs between two consecutive characters @xmath233 , @xmath234 for @xmath235 .",
    "assume to the contrary that a character @xmath133 occurs between @xmath236 and @xmath237 in @xmath102 .",
    "then @xmath133 is in conflict with character @xmath238 in @xmath101 .",
    "indeed , @xmath133 and @xmath239 are not comparable ( being maximal characters ) and there exists a species of @xmath101that contains @xmath240 , which is species @xmath241 of chain @xmath212 .",
    "indeed , it must be that @xmath220 can not label an edge of chain @xmath212 ( otherwise @xmath212 is not the correct chain ) , and thus @xmath220 must occur on a path distinct from the one of @xmath212 , in virtue of lemma  [ lemma : tree - structure - max1 ] .",
    "moreover , there is also a species @xmath242 not having @xmath243 and @xmath135 , which is the one occurring before @xmath233 .",
    "observe that there is at least a species having @xmath135 and not @xmath243 which is the species @xmath244 that is the end of edge labeled @xmath133 along the path @xmath231 .",
    "since @xmath242 and @xmath244 are not realized before the species @xmath241 of chain @xmath212 , the conflict between @xmath240 can not be removed when the chain @xmath212 is realized , that is @xmath240 induce a red @xmath80-graph after the realization of the species @xmath245 of chain @xmath212 .",
    "it follows that chain @xmath212 can not be safe in @xmath101 , a contradiction with the initial assumption .",
    "thus it must be that no positive character occurs between two consecutive characters @xmath246 in tree @xmath102 .",
    "observe that the above argument showing that @xmath220 can not occur on a path distinct from the one having chain @xmath212 shows that the path labeled by @xmath228 does not have branches for characters introduced after @xmath247 .",
    "moreover , it can not have branches due to the negation of characters that precede character @xmath248 , since otherwise there exist a character @xmath3 that is negated after one that is introduced in the initial path after @xmath3 , contradicting lemma  [ lemma : tree - structure - max1 ] .",
    "it follows that the path labeled @xmath249 is simple .    to complete the proof of case 2",
    ", we show the following .",
    "claim ( 1 ) : the sequence of edges @xmath249 is not followed in tree @xmath102 by any other characters ( positive or negative ) .",
    "this fact shows that the tree @xmath102 is a line - tree since the edge labeled @xmath250 is preceded by an edge labeled by a positive character and thus no branch - node occurs before sequence @xmath249 and no branch - node occurs after being this path simple . in virtue of lemma  [ lemma : invert - line - trees ]",
    "it follows that we can build a tree @xmath157 by reading the tree @xmath102 in inverted order that is from the leaf to the root .",
    "thus this case proves that @xmath212 is the initial chain of the tree @xmath157 and this concludes the proof of the lemma .    in order to prove claim ( 1 ) we prove the following claim ( 2 ) : the path labeled @xmath251 is followed by a positive character @xmath133 before the occurrence of @xmath249 if @xmath133 can not be negated in the tree , that is the path labeled @xmath249 ends in a leaf of the tree .",
    "observe that if @xmath251 is followed only by negative characters , then the sequence @xmath249 does not induce a chain , since the chain ends in a different sink node .",
    "now , assume that a character @xmath133 follows sequence @xmath252 .",
    "let us recall that by lemma  [ lemma : tree - structure - max1 ] , positive characters are introduced in the same order they are negated if they occur negated along the same path .",
    "consequently , it must be that @xmath133 is negated along a path distinct from the one having chain @xmath212 ( i.e. @xmath102 is a branch - tree ) .",
    "assume that @xmath135 is negated below the negation of character @xmath216 of chain @xmath212 , where @xmath253 , ( otherwise if @xmath254 or then @xmath212 has a different source node ) and thus there exists a species @xmath242 having @xmath255 but not @xmath135 , where @xmath242 is the end of the branch having @xmath220 .",
    "observe that in chain @xmath212 the species @xmath256 contains characters @xmath255 and @xmath135 .",
    "these two characters share a common species , are not comparable and there exists clearly a species @xmath244 without both characters @xmath255 and @xmath135 , which is a species of chain @xmath251 .",
    "thus they are in conflict in @xmath101 .",
    "now , after the realization of @xmath256 it holds that @xmath255 and @xmath135 induces a red @xmath80-graph in @xmath101as the species @xmath244 with configuration @xmath150 for the pair @xmath257 is not realized before @xmath256 and similarly there are species with configuration @xmath223 and @xmath258 that are not realized before @xmath256 such as the species in which edge labeled @xmath259 ends .",
    "thus we obtain a contradiction with the fact the chain @xmath212 is safe .    as a consequence of claim ( 2 ) , either there is no character that follows path labeled @xmath249 proving claim ( 1 ) , otherwise there exists no character @xmath133 that follows the path labeled @xmath231 . thus if there exists a character @xmath3 that is after sequence @xmath249 , @xmath3 is disjoint from the other characters in @xmath101 , which contradicts the fact that @xmath101is connected .",
    "moreover , no negative character occurs after sequences @xmath252 @xmath249 because of the ordering of characters .",
    "thus claim ( 1 ) holds .",
    "( figure  [ fig : chain3 ] ) .",
    "assume that the sequence @xmath212 consists of sequence @xmath260 ( induced in tree @xmath102 by a path labeled by consecutive positive characters @xmath261 ) followed by sequence @xmath262 that is induced in tree @xmath102 by a path labeled by consecutive negative characters @xmath263 of the tree .",
    "more precisely , each edge @xmath123 is labeled @xmath264  by maximality of all characters of @xmath101 , no two negated characters can label the same edge , @xmath265 is the end of the edge labeled @xmath266 when @xmath267 .",
    "then we show the following claim ( 3 ) : there exists no character in tree @xmath102 that precedes sequence @xmath268 .",
    "this fact shows that chain @xmath212 share the same source node of chain @xmath121 thus contradicting the assumption that they have distinct sources .",
    "observe that case 3 implies that for each character @xmath269 , then @xmath233 occurs after @xmath261 .",
    "now , by lemma  [ lemma : prelim - inverted ] , it must be that the sequence of positive edges @xmath270 occurs before sequence @xmath249 and after sequence @xmath261 .",
    "this fact implies that path@xmath249 occurs below the branch - node as the negated characters @xmath271 must occur below the branch - node of tree @xmath102 .",
    "similarly , a positive character @xmath133 that occurs before @xmath271 must occur negated below the branch node .",
    "let us prove claim ( 3 ) .",
    "assume to the contrary that a character @xmath133 occurs before @xmath272 .",
    "since chain @xmath212 does not contain @xmath220 it must be that @xmath220 occurs along a distinct path of the one having @xmath212 and from the one having @xmath271 .",
    "but , then the species @xmath244 of @xmath212 has character @xmath133 .",
    "observe that since chain @xmath212 starts with the positive edge @xmath273 it must be that there exists a species before @xmath242 with a positive character distinct from @xmath133 that is then negated after @xmath133 .",
    "in other words there exists a species @xmath218 without the pair @xmath133 and @xmath274 .",
    "the two characters are not comparable ( they are maximal ones ) and they are in the same species @xmath244 , thus they are conflicting in @xmath101 .",
    "but , when @xmath244 is realized they induce a red @xmath80-graph as the species with configuration @xmath150 and @xmath223 are not all removed from @xmath101when realizing @xmath244 .",
    "thus this would contradict that @xmath212 is safe , thus proving that claim 3 holds .    a main consequence of the proof of the previous lemma  [ lemma : inverted - tree+safe ] is the fact that if the diagram of a maximal reducible graph is non degenerate then there are at most two trees solving the same maximal reducible graph such that the initial chain of such trees starts with distinct sources .    [ cons : inverted - tree+safe ] let @xmath57 be a reducible graph .",
    "let @xmath100 be a maximal reducible graph whose diagram @xmath104 is not degenerate",
    ". then diagram @xmath104 has at most two distinct safe chains and at most two safe sources for @xmath49 .    0.3     of case 2 of lemma  [ lemma : inverted - tree+safe ] induced by @xmath275    0.3     of case 2 of lemma  [ lemma : inverted - tree+safe ] induced by @xmath275    0.3     of case 2 of lemma  [ lemma : inverted - tree+safe ] induced by @xmath275    0.3     of case 3 of lemma  [ lemma : inverted - tree+safe ] induced by @xmath276 and @xmath277    0.3     of case 3 of lemma  [ lemma : inverted - tree+safe ] induced by @xmath276 and @xmath277    0.3     of case 3 of lemma  [ lemma : inverted - tree+safe ] induced by @xmath276 and @xmath277",
    "if the diagram @xmath104 for graph @xmath100 is degenerate , then the notion of safe source for @xmath57 is defined differently as follows .",
    "[ definition : safe - source - degenerate ] let @xmath57 be a reducible graph such that @xmath100 has a degenerate diagram .",
    "then a source @xmath2 of @xmath104 is safe for @xmath49if @xmath63 are realized in graph @xmath57 without inducing red @xmath80-graphs and either ( 1 ) @xmath2 is a species of @xmath57 or ( 2 ) @xmath2 is not a species of @xmath57 and none of the sources of @xmath104 is a species of @xmath57 .",
    "a _ degenerate tree _",
    "@xmath102 for a maximal reduced graph that is not in normal form is a branch - tree whose branches are single edges outgoing from the branch - node each labeled by a single negative character of the graph ; only the leaves are labeled by species .",
    "then a degenerate tree in normal form is obtained by moving one of the leaves in the initial path and then removing the edge labeled by the negated character that ends in the leaf .",
    "observe that given a degenerate tree @xmath102 solving @xmath101that is in normal form with @xmath2 the species of the initial path , then for each each leaf @xmath215 of tree @xmath102 there exists a tree @xmath278 solving @xmath101such that is obtained by inverting the species @xmath215 with the species @xmath2 ( see figure  [ fig : degenerate - solutions ] ) .",
    "[ lemma : degenerate - diagram ] let @xmath105 be a maximal reducible graph such that its diagram is degenerate and let @xmath102 be a tree solving @xmath105 .",
    "then the tree @xmath102 is a degenerate tree and the graph @xmath105 has no conflicting characters .",
    "assume first that the initial - path of the tree @xmath4 has more than one species .",
    "then the species are ends of mixed edges since they can not be included one in the other . in the following",
    "we show that there can not be two consecutive mixed edges in the tree @xmath4 .",
    "assume to the contrary that we have two consecutive mixed edges that negate the characters @xmath25 one after the other .",
    "it is not restrictive to assume that these two edges are the first ones to occur along the initial - path of tree @xmath4 .",
    "observe that the two characters must be introduced together otherwise there are species one included in the other . but as a consequence of this fact , character @xmath149 includes character @xmath3 , which is a contradiction . as a consequence of this fact",
    "there is at most one species @xmath2 along the initial path of tree @xmath4 .",
    "then we show that each branch of the tree consists of a single edge labeled only by a negated character .",
    "indeed , otherwise a branch may have at least two species @xmath193 one included in the other as they differ only by the negation of characters , which contradicts the fact that the diagram has only singletons .",
    "let us now show that each branch is labeled by a single character .",
    "otherwise , it is easy to show that the characters labeling a branch edge are identical characters in the graph , which contradicts the initial assumption , or they are not maximal ones . as a consequence of the above observations it follows that all the characters that are negated along the branches occur on the edge ending in species @xmath2 or they occur on the initial path which has no species .",
    "it follows that the tree is a degenerate one as required .",
    "it is immediate to show that the graph has no conflicting characters    [ theorem : any - source - degenerate ] let @xmath57 be a reducible graph .",
    "let @xmath100 be a maximal reducible graph whose diagram @xmath104 is degenerate and let @xmath2 be a safe source of @xmath57 .",
    "then there exists a solution @xmath4 of @xmath49such that the child @xmath14 of the root @xmath31 of @xmath4 is labeled by the characters of @xmath2 that are inactive in @xmath57 .    by definition of safe source for @xmath57",
    "we have to distinguish two cases .",
    "let @xmath4 be a tree solving @xmath57 and let @xmath279 be the tree solving @xmath100 .",
    "case 1 : assume first that @xmath2 is not a species of @xmath57 , i.e. , by definition any safe source of the diagram is safe for @xmath57 . then given @xmath102",
    "we need to consider two cases .",
    "case 1.1 assume that tree @xmath102 is not in normal form .",
    "this fact implies that if there exists a species @xmath81 below the root of tree @xmath4 which is on the path of tree @xmath4 including the initial path of tree @xmath102 , then @xmath81 includes all the characters of @xmath99 .",
    "then we can split the edge @xmath280 into two edges @xmath281 and @xmath282 , where the first is labeled by the characters of @xmath2 that are inactive in @xmath57 , thus proving the theorem .",
    "otherwise it means that no species is along the path that includes the initial path of tree @xmath102 , but then we can find a state @xmath2 of tree @xmath4 corresponding to the safe species @xmath2 of @xmath104 .    case 1.2 assume that tree @xmath102 is in normal form , i.e. , there exists a species @xmath48 along the initial path of tree @xmath102 . since by assumption @xmath2 is not a species of @xmath57 , there exists a species @xmath81 of graph @xmath49including @xmath2 such that @xmath81 also includes at least a non maximal character @xmath14 .",
    "let @xmath81 be the species with the minimum number of characters including @xmath2 .",
    "observe that such a species exists in tree @xmath4 . now ,",
    "if tree @xmath4 starts with species @xmath81 it is immediate that the theorem holds , since @xmath4 is the tree satisfying the theorem .",
    "thus we must consider the case that @xmath81 is a species of tree @xmath4 but @xmath81 is along a path of tree @xmath4 that is not the one including the initial path of tree @xmath102 , that is @xmath2 is a leaf of tree @xmath102 .",
    "moreover , observe that @xmath81 must be a leaf of tree @xmath4 because of the structure of degenerate trees .",
    "let us recall that by the structure of the degenerate tree it must be that @xmath2 consists of set @xmath283 .",
    "now , by theorem  [ lemma : degenerate - diagram ] we know that there exists another tree @xmath284 with species @xmath2 in the initial path and solving @xmath100 such that tree @xmath284 is obtained by inverting the path @xmath285 labeled @xmath286 of tree @xmath287 .",
    "now , it is easy to show that the tree @xmath284 can be extended to a solution @xmath129 for graph @xmath49 .",
    "indeed , we build tree @xmath129 from @xmath4 by inverting the species of the path of tree @xmath4 that includes path @xmath285 .",
    "we then show that tree @xmath129 represents all the species of graph @xmath49and hence is a solution of @xmath49and moreover @xmath129 is such that starts with species @xmath81 , consequently it is the tree that satisfies the theorem .",
    "first observe that the inverting the path is possible if there are no active characters in @xmath49otherwise , it is immediate to show that @xmath2 can not be a safe source of @xmath104 , as it can not have active characters in @xmath49which is not possible . indeed , observe that the path @xmath190 of tree @xmath129 that includes the initial path of tree @xmath284 includes the same set of maximal and non maximal characters of the path @xmath103 of tree @xmath4 that includes the initial path of tree @xmath102 .",
    "now , the species that are below the path @xmath190 in tree @xmath4 can be also represented in tree @xmath129 along the branches that are identical in the two trees @xmath129 and @xmath4 since such species derive by the negation of characters in @xmath103 or adding new characters . in particular notice that the characters that are negated along one branch of tree @xmath129 are the same to be negated along the same branch of tree @xmath4 .",
    "it follows that all species of the paths different from the inverted one are also represented in @xmath129 .",
    "case 2 : assume that @xmath2 is a species of @xmath57 . then given tree",
    "@xmath4 we must consider two cases .",
    "case 2.1 assume that @xmath2 occurs as the first species of tree @xmath4",
    ". then the lemma holds .",
    "case 2.2 assume that @xmath2 does not occur as the first species of tree @xmath4 .",
    "now , let @xmath288 be the tree induced by the maximal characters and let @xmath284 be the tree that is obtained from @xmath102 by inverting the path @xmath103 from the root @xmath31 to node @xmath48 such that @xmath103 ends in species @xmath2 , that is @xmath289 ( observe that such path exists ) . in the following we show that the tree @xmath129 obtained from tree @xmath4 inverting the path that includes",
    "@xmath103 is a tree solving @xmath57 .",
    "first observe that inverting the path is possible if there are no active characters in @xmath49otherwise , it is immediate to show that @xmath2 can not be a safe source of @xmath104 , as it can not have active characters in @xmath49which is not possible .",
    "now , we need to show that @xmath2 is a species of tree @xmath129 and is the first species of tree @xmath129 .",
    "but since @xmath2 is a species of tree @xmath4 and being @xmath2 the leaf of tree @xmath287 it follows that @xmath2 must be a leaf of tree @xmath4 .",
    "it is immediate that tree @xmath129 is the tree that satisfies the lemma thus proving what is required .",
    "in fact it is enough to observe that tree @xmath129 contains all the species of tree @xmath4 and thus by construction it solves @xmath57 as @xmath4 solves @xmath49 .      as a consequence of the lemma  [ lemma : initial - source ] we are able to show that there exists a tree @xmath4 for @xmath49such that the inactive characters of the first state below the root consists of the characters of a safe source of the diagram @xmath104 for @xmath100 .",
    "this result is a main consequence of the fact that a tree @xmath4 starts with the characters of a tree solving the maximal reducible @xmath100 and such set of characters correspond to those of a safe chain @xmath121 of diagram @xmath104 ( see lemma  [ lemma : initial - chain ] ) and clearly since these characters are obtained by a tree traversal of tree @xmath4 their realization does not induce red @xmath80-graphs in @xmath49 , i.e. , the source of the chain @xmath121 is safe in @xmath49 .    a stronger result states in theorem  [ theorem : any - initial - source ]",
    "can be proved : for any safe source @xmath2 of @xmath49 , there exists a tree @xmath4 solving @xmath49such that the set of characters of @xmath2 gives the inactive characters of the first state below the root @xmath31 of tree @xmath4 .",
    "thus we show that we are able to compute in polynomial time the first state of a tree @xmath4 solving a graph @xmath49 .",
    "observe that the result is a consequence of the previous characterization of trees solving a maximal reducible graph : there are at most two safe chains of diagram @xmath104 that have distinct sources and are the initial chains of two trees solving @xmath105 and such trees are two line - trees @xmath129 and @xmath128 , one tree being the inverted path of the other tree .",
    "[ theorem : any - initial - source ] let @xmath49be a reducible graph , let @xmath104 be the diagram for a maximal reducible graph @xmath100 that is not degenerate , and let @xmath2 be a safe source of @xmath49 .",
    "then there exists a solution @xmath4 of @xmath49such that the child @xmath14 of the root @xmath31 of @xmath4 is labeled by the characters of @xmath2 that are inactive in @xmath57 .",
    "the vertex @xmath14 is called the _ initial state _ of the tree @xmath4 .    by lemma  [ lemma : initial - source ]",
    "there exists a tree @xmath4 solving @xmath49such that its root has a child node @xmath14 such that @xmath14 is a safe source of diagram @xmath104 .",
    "let @xmath102 be the tree @xmath186 induced by the maximal characters of @xmath4 .",
    "since @xmath104 is not degenerate , by lemma  [ lemma : inverted - tree+safe ] there are at most two trees that solve the graph @xmath101and have distinct sources . if the diagram has a unique safe source the lemma follows since @xmath2 is the unique safe source .",
    "thus assume that there is another tree @xmath157 that solves the graph @xmath101 : by lemma  [ lemma : inverted - tree+safe ] such tree is obtained from tree @xmath102 which is a line - tree by reading it in inverted order .",
    "assume now that the graph @xmath49has no active characters .",
    "since tree @xmath4 is obtained by inserting characters in tree @xmath102 and adding subtrees to states of tree @xmath102 , it is immediate to show that a tree @xmath290 solving @xmath49can be also obtained from tree @xmath157 by reading the tree @xmath4 in inverted order from the leaf @xmath48 of tree @xmath102 .",
    "this fact proves the lemma in this case .",
    "assume now that the graph @xmath49has active characters .",
    "now , the other tree @xmath291 solving @xmath100 starts with a source that is the leaf @xmath48 of tree @xmath102 .",
    "observe that the smallest species of tree @xmath4 solving @xmath49and including @xmath48 does not have the active characters of @xmath57 . indeed , by lemma  [ lemma : tree - structure - max1 ] characters that occur negated along the same path must be introduced as positive ones in the same order they are negated .",
    "thus state @xmath48 can not be the initial state of another tree @xmath129 solving @xmath49 .",
    "we can now state the main lemma used in the recursive step of our algorithm  [ alg : reduction ] * reduce*.    [ main - characterization ] let @xmath57 be a reducible graph and let @xmath104 be the diagram for @xmath100 .",
    "let @xmath2 be a safe source of diagram @xmath104 .",
    "then the graph @xmath98 obtained after the realization of @xmath2 is reducible .    by theorem  [ theorem : any - initial - source ] , the source @xmath2 is the initial state of a tree @xmath4 solving graph @xmath57 .",
    "thus the realization of the sequence of characters of @xmath2 is the initial sequence of a successful reduction for graph @xmath49 .",
    "indeed , the tree traversal of tree @xmath4 produces a successful reduction in virtue of proposition  [ prop : traversal ] .",
    "consequently the realization of @xmath2 on graph @xmath57 produces a reducible graph .",
    "the following result is a natural consequence of the fact that the number of chains in a degenerate diagram for graph @xmath49is at most the number of characters of @xmath49 .",
    "[ lemma : chain - polynomial ] the total number of distinct chains in a diagram @xmath104 for a maximal reducible graph @xmath57 is polynomial in the number of characters of the diagram .    let @xmath4 be a tree solving @xmath57 .",
    "given a chain @xmath125 , then an internal node @xmath14 of the chain has outdegree greater than @xmath6 when @xmath14 is adjacent to a species obtained by the negation of some characters of the chain below the node @xmath14 .",
    "now , the negation of such characters occur only once in the tree @xmath4 producing a number of distinct chains that is linear in the number of characters .",
    "this observation is enough to prove the lemma .",
    "[ number - initial - polynomial ] let @xmath57 be a maximal reducible graph and let @xmath104 be the diagram for @xmath57 .",
    "then the number of safe chains in @xmath57 is polynomial in the number of characters and a safe chain is computed in polynomial time .    by lemma  [ lemma : chain - polynomial ]",
    "the number of distinct chains in diagrams @xmath104 that we need to test to be safe is polynomial in the number if characters .",
    "a chain @xmath125 is safe for a red - black graph if the realization of the sequence of characters labeling the edges of the chain does not induce a red @xmath80-graph .",
    "it is easy to verify that such test can be done in polynomial time .",
    "the following is a direct consequence of lemma  [ number - initial - polynomial ] .",
    "[ number - initial - polynomial2 ] let @xmath49be a reducible graph .",
    "the total number of distinct safe sources is polynomial in the number of characters of the diagram and a safe source is computed in polynomial time .",
    "algorithm  [ alg : reduction ] describes the procedure * * reduce**@xmath292 that given a red - black graph ( with active and non active characters ) computes an extended c - reduction that is a successful reduction of @xmath57 if @xmath57 can be solved by a tree @xmath4 .",
    "remove all singletons from @xmath49[alg : reduce : singletons ]    @xmath293 the maximal characters of @xmath49[alg : reduce : begin - safe - source ] @xmath294 the diagram for @xmath188 @xmath295 a safe source of the diagram @xmath104 @xmath296 the sequence of positive characters of @xmath2 that are inactive in @xmath49 @xmath297 realize@xmath298 @xmath299[alg : reduce : end - safe - source ]    notice that algorithm  [ alg : reduction ] , when applied to a graph @xmath49 , computes a successful reduction @xmath64 of @xmath49(if it exists ) .",
    "a successful reduction can then be transformed into a persistent phylogeny for @xmath49 see algorithm * reduction2phylogeny *  @xcite ) .",
    "let @xmath49be a reducible red - black graph .",
    "then algorithm  [ alg : reduction ] computes a tree @xmath4 solving @xmath49 in polynomial time .",
    "the correctness of algorithm  [ alg : reduction ] can be proved by induction on the length @xmath27 of the reduction found .",
    "if @xmath300 , then the red - black graph @xmath49must be edgeless , hence line  [ alg : reduce : singletons ] removes all vertices of @xmath49and the condition at line  [ alg : reduce : empty ] holds .",
    "the empty reduction that is computed is trivially correct .    if @xmath301 , then the reduction solving @xmath49is either @xmath15 or @xmath16 . in the both cases ,",
    "the character @xmath3 is the only character of @xmath49that is not a singleton .",
    "it is immediate to notice that in the first case @xmath3 is a universal character and in the second case @xmath3 is a free character , and the reduction that is computed is correct .",
    "let us now consider the case @xmath302 .",
    "if @xmath49is disconnected , by observation  [ observation2 ] , the reduction solving @xmath49is the concatenation of the reduction solving each connected component of @xmath49 . the correctness of lines  [ alg : reduce : disconnected ] ,  [ alg : reduce : disconnected - end ] is immediate .",
    "consider now the case when @xmath49is connected .",
    "if @xmath49has a universal or a free character , then the algorithm computes the correct reduction by inductive hypothesis .",
    "if @xmath49has no universal or free characters , then lines  [ alg : reduce : begin - safe - source][alg : reduce : end - safe - source ] are reached . by theorem  [ lemma : connected - components - grb = children ] and theorem  [ theorem : any - initial - source ] , if the diagram @xmath104 is degenerate , there exists a solution @xmath4 of @xmath49such that the topmost edge is labeled by the set @xmath303 of the characters of @xmath181 ( which are all inactive in @xmath49 ) that are possessed by a safe source @xmath2 of @xmath49 .",
    "notice that the reduction associated with @xmath4 begins with the characters @xmath303 , hence lines  [ alg : reduce : begin - safe - source][alg : reduce : end - safe - source ] of the algorithm correctly compute the reduction .",
    "a direct consequence of lemmas  [ cons : inverted - tree+safe ] is that either @xmath49has only a safe source , or @xmath49has two safe sources @xmath111 and @xmath112 , if the diagram @xmath104 is not degenerate . otherwise , if the diagram is degenerate by definition of safe source given in definition  [ definition : safe - source - degenerate ] it is immediate to compute the correct safe source for which theorem  [ theorem : any - source - degenerate ] holds . in the latter case ,",
    "there exist two solutions @xmath141 and @xmath143 of @xmath49such that @xmath111 is the topmost species of @xmath141 and @xmath112 is the topmost species of @xmath143 , hence choosing any of @xmath111 or @xmath112 is correct .",
    "since each invocation of algorithm  [ alg : reduction ] computes at least a signed character of the reduction and the reduction contains at most @xmath304 signed characters , the overall time complexity is polynomial , if computing a safe source has polynomial time complexity , which is a consequence of lemma  [ number - initial - polynomial ] .",
    "notice that the same argument shows that applying algorithm  [ alg : reduction ] to a red - black graph @xmath49that has no solution , then algorithm  [ alg : reduction ] requires polynomial time and either aborts or computes an incorrect tree  checking if a tree is actually a solution of @xmath49is immediate .",
    "the persistent phylogeny model has appeared many times in the literature under different formulations  @xcite , but its computational complexity has been open for 20 years . in this paper",
    "we have answered this question by providing a polynomial - time algorithm that determines if a binary matrix has a persistent phylogeny and constructs such a persistent phylogeny if it exists .",
    "a natural optimization criterion is to compute a tree with the smallest number of persistent characters  this is equivalent to computing the tree with the fewest edges .",
    "the computational complexity of this optimization problem is an open problem .",
    "we believe that the graph theoretic approach developed in the paper could shed some light into the solution of this problem .",
    "h.  l. bodlaender , m.  r. fellows , and t.  j. warnow .",
    "two strikes against perfect phylogeny . in _",
    "automata , languages and programming ( vienna , 1992 ) _ , volume 623 of _ lecture notes in comput .",
    "_ , pages 273283 .",
    "springer , berlin , 1992 .",
    "p.  bonizzoni , a.  p. carrieri , g.  della  vedova , r.  dondi , and t.  m. przytycka .",
    "when and how the perfect phylogeny model explains evolution . in n.",
    "jonoska and m.  saito , editors , _ discrete and topological models in molecular biology _ , natural computing series , pages 6783 .",
    "springer berlin heidelberg , berlin , germany , 2014 .",
    "d.  gusfield .",
    "persistent phylogeny : a galled - tree and integer linear programming approach . in _ proceedings of the 6th acm conference on bioinformatics , computational biology and health informatics _ , pages 443451 .",
    "acm , 2015 .",
    "a.  mcpherson , a.  roth , e.  laks , t.  masud , a.  bashashati , a.  w. zhang , g.  ha , j.  biele , d.  yap , a.  wan , l.  m. prentice , j.  khattra , m.  a. smith , c.  b. nielsen , s.  c. mullaly , s.  kalloger , a.  karnezis , k.  shumansky , c.  siu , j.  rosner , h.  l. chan , j.  ho , n.  melnyk , j.  senz , w.  yang , r.  moore , a.  j. mungall , m.  a. marra , a.  bouchard - cote , c.  b. gilks , d.  g. huntsman , j.  n. mcalpine , s.  aparicio , and s.  p. shah .",
    "divergent modes of clonal spread and intraperitoneal mixing in high - grade serous ovarian cancer .",
    ", 48(7):758767 , 2016 .",
    "i.  b. rogozin , y.  i. wolf , v.  n. babenko , and e.  v. koonin .",
    "dollo parsimony and the reconstruction of genome evolution . in i.",
    "v.  a. albert , editor , _ parsimony , phylogeny , and genomics_. oxford university press , 2006 .               and with set @xmath50 of active characters , after the realization of the sequence @xmath305 .",
    "the character @xmath21 is adjacent to the species @xmath306 which are all the species in the same connected components as @xmath21 . ]"
  ],
  "abstract_text": [
    "<S> the notion of a persistent phylogeny generalizes the well - known perfect phylogeny model that has been thoroughly investigated and is used to explain a wide range of evolutionary phenomena . </S>",
    "<S> more precisely , while the perfect phylogeny model allows each character to be acquired once in the entire evolutionary history while character losses are not allowed , the persistent phylogeny model allows each character to be both acquired and lost exactly once in the evolutionary history . </S>",
    "<S> the persistent phylogeny problem ( ppp ) is the problem of reconstructing a persistent phylogeny tree , if it exists , from a binary matrix where the rows represent the species ( or the individuals ) studied and the columns represent the characters that each species can have .    </S>",
    "<S> while the perfect phylogeny has a linear - time algorithm , the computational complexity of ppp has been posed , albeit in an equivalent formulation , 20 years ago . </S>",
    "<S> we settle the question by providing a polynomial time algorithm for the persistent phylogeny problem . </S>"
  ]
}