{
  "article_text": [
    "[ [ the - problem . ] ] the problem .",
    "+ + + + + + + + + + + +    let @xmath4 be a collection of @xmath0 non - vertical pairwise disjoint triangles in @xmath5 _ in general position_. in particular , we assume that the @xmath6-projections of the triangles are in general position , in the sense that no pair of projected edges overlap , no vertex is projected to a point that lies on a projected edge of another triangle , and no three projected edges are concurrent . for any pair @xmath7 of triangles in @xmath4 , we say that @xmath8 passes _ above _ @xmath9 ( equivalently , @xmath9 passes _ below _",
    "@xmath8 ) if any vertical line that meets both @xmath8 and @xmath9 intersects @xmath8 at a point that lies higher than its intersection with  @xmath9 ; this property is clearly independent of the choice of the vertical line meeting both triangles .",
    "we denote this relation by @xmath10 .",
    "the relation @xmath11 is a partial relation , and in general it may contain _ cycles _ of the form @xmath12 .",
    "we call this a _ @xmath13-cycle _ , and refer to @xmath13 as the _ length _ of the cycle .",
    "cycles of length three ( the minimum possible length ) are called _",
    "triangular_. see figure  [ tricyc ] .",
    "the problem of cycle elimination is to cut the triangles of @xmath4 into a finite number of connected pieces , each being semi - algebraic of constant description complexity ( that is , defined by a constant number of polynomial equalities and inequalities , each of degree bounded by some constant ) , so that the suitably extended depth relation among the new pieces is acyclic , in which case we call it a _ depth order_.    the simpler case , in which the triangles are replaced by lines or line segments , has been handled in the recent companion paper  @xcite ( and in earlier papers , cited therein ) .",
    "we note that eliminating cycles in a set of triangles adds , literally , a new dimension to the problem : whereas lines are cut at a discrete set of points , triangles have to be cut into pieces along curves , which makes the analysis considerably more involved  see below .",
    "we also observe that the binary space partition ( bsp ) technique of paterson and yao  @xcite constructs a depth order by cutting the triangles into @xmath14 pieces , but , as in the case of lines , we would like to use fewer cuts , ideally close to the lower bound of @xmath15 , which is an immediate extension of a similar lower bound , noted in @xcite , for the case of lines .",
    "a long - standing conjecture , open since 1980 , is that one can indeed always construct a depth order with a _",
    "number of cuts .",
    "see ( * ? ? ?",
    "* chapter  9 ) for a summary of the state of affairs circa 1990 . in the previous work  @xcite",
    "we have shown that @xmath16 cuts suffice to eliminate all cycles among @xmath0 lines in space . in this paper",
    "we obtain a similar , albeit slightly weaker , bound for the case of triangles , settling this conjecture , in a strong , almost worst - case tight manner ( with a few technical reservations , discussed below ) .",
    "[ [ background . ] ] background .",
    "+ + + + + + + + + + +    the main motivation for studying this problem comes from _ hidden surface removal _ in computer graphics .",
    "a detailed description of this motivation can be found , e.g. , in an earlier paper of aronov et al .",
    "briefly , a conceptually simple technique for rendering a scene in computer graphics is the so - called painter s algorithm , which places the objects in the scene on the screen in a back - to - front manner , painting each new object over the portions of earlier objects that it hides . for this , though , one needs an _ acyclic _",
    "depth relation among the objects with respect to the viewing point ( which we assume here , without loss of generality , to lie at @xmath17 ) .",
    "when there are cycles in the depth relation , one would like to cut the objects into a small number of pieces , so as to eliminate all cycles ( i.e. , have an acyclic depth relation among the resulting pieces ) , and then paint the pieces in the above manner , obtaining a correct rendering of the scene ; see @xcite for more details .",
    "assuming that the input objects are all given as triangulated polyhedral approximations , as is the case in most practical applications , we face exactly the problem addressed in this paper .",
    "the study of cycles in a set of lines or line segments in @xmath5 goes back to chazelle et  al .",
    "@xcite , who have shown that , if the @xmath6-projections of a collection of @xmath0 segments in 3-space form a `` grid '' ( of the form depicted in figure  [ grid ] ) ,        then all cycles defined by this collection can be eliminated with @xmath18 cuts .",
    "another significant development is due to aronov et al .",
    "@xcite , who have considered the problem of triangular cycles , and established the rather weak ( albeit subquadratic ) @xmath19 upper bound on the number of _ elementary triangular _ cycles ( namely , cycles whose @xmath6-projections form triangular faces in the arrangement of the projected lines ) .",
    "they also showed that @xmath20 cuts suffice to eliminate _ all _ triangular cycles .",
    "however , their results did not apply to general , non - triangular cycles .",
    "in the recent companion work  @xcite , we essentially settled the case of lines , by showing that @xmath16 cuts are sufficient to eliminate all cycles , which is close to the best possible due to a well known construction requiring @xmath15 cuts .",
    "in contrast , the case of triangles has barely been touched , except for the aforementioned bsp technique in  @xcite and several subsequent studies of this technique , where improved ( subquadratic ) bounds have been established for several special classes of objects in three dimensions , such as axis - parallel two - dimensional rectangles of bounded aspect ratio  @xcite or so - called uncluttered scenes  @xcite ; see @xcite for surveys of the bsp literature .    [",
    "[ our - contribution . ] ] our contribution .",
    "+ + + + + + + + + + + + + + + + +    in this paper we essentially settle the problem for the case of triangles , and show that _ all _ cycles in the depth relation in a set of @xmath0 triangles can be eliminated by cutting the triangles into @xmath2 connected pieces whose ( constant ) description complexity depends only on the choice of @xmath1 . as noted , our bound is best possible in the worst case , up to the @xmath21 factor .",
    "the proof of this bound follows the high - level approach in the previous analysis for the case of lines  @xcite , which uses the polynomial partitioning technique of guth  @xcite . roughly speaking",
    ", this technique spreads the _ edges _ of the triangles more or less evenly among the cells of the partition , which in turn provides a recursive divide - and - conquer mechanism for performing the cuts .",
    "however , the fact that we are dealing here with two - dimensional triangles , rather than with one - dimensional objects like lines or segments , raises substantial technical problems that need to be overcome .",
    "the two most significant issues that arise are :    \\(i ) in contrast with the case of lines , where the cuts are made at a discrete set of points , here we need to cut the triangles into two - dimensional regions .",
    "ideally , we would like to cut them into triangular pieces ( as does the bsp technique of @xcite ) , but our technique does not achieve this and instead cuts the triangles by a collection of constant - degree algebraic curves into semialgebraic regions of constant description complexity .",
    "\\(ii ) additional complications arise in controlling the recursive mechanism , to ensure that not too many triangles are passed to a recursive subproblem .",
    "as alluded to above , we can control the number of triangles that have an edge that crosses a cell , since the partition is based on the triangle edges , but we do not have a good bound on the number of triangles that `` fully slice '' through a cell ; see below for the precise description .",
    "one therefore needs to prune away the triangles that cross a cell in this slicing manner , in order to obtain a recurrence relationship similar to the one in @xcite for the case of lines , thereby achieving the desired near - optimal bound for the overall number of cuts ; see below for full details .    as in the case of lines ,",
    "our proof is constructive , and leads , in principle , to an efficient algorithm for performing the cuts ( assuming a suitable model of algebraic computation ) .",
    "the only ingredient currently missing is an efficient construction of guth s partitioning polynomial , a step that we leave as a topic for further research .",
    "( as also noted in @xcite , the problematic aspects of an efficient construction of a partitioning polynomial , for the simpler case of a set of points , and techniques for overcoming these issues , are discussed by agarwal et al .",
    "@xcite ; one hopes that variants of these techniques could also be used for effectively partitioning space with respect to higher - dimensional objects  the triangle edges in our case . )",
    "additional issues that arise here and were absent in the case of lines ( and are strongly related to item  ( ii ) above ) involve the analysis of the topology of the cells of the polynomial partitioning , and the way it is modified by the triangles that slice through the cells .",
    "handling these issues constitutes a novel , non - negligible portion of our analysis .",
    "we note that the previous study  @xcite proposes two other algorithmic approaches for computing the cuts , one using the algorithms of har - peled and sharir  @xcite or of solan  @xcite , and the other using the ( slower , albeit polynomial , but sharper ) approximation algorithm of aronov et al .",
    "unfortunately , neither of these alternative techniques seems ( so far ) applicable to the case of triangles .",
    "[ [ the - setup - and - some - notation . ] ] the setup and some notation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath22 be a collection of pairwise disjoint _",
    "objects _ in three dimensions , where each object is a path - connected set contained in a non - vertical plane ; in our analysis , these will be the triangles or the triangle pieces produced by our construction .",
    "clearly , each object in @xmath22 is _",
    "@xmath6-monotone _ , that is , its intersection with any vertical line is a single point or empty .",
    "we define a _ depth relation _",
    "@xmath23 on the objects of @xmath22 , in the following natural manner : we say that @xmath24 _ lies _ ( or _ passes ) below _",
    "@xmath25 ( in which case we also say that _ @xmath26 passes above @xmath27 _ ) , and write @xmath28 or @xmath29 , if there exists a vertical line @xmath30 that meets both @xmath27 and @xmath26 , and the @xmath31-coordinate of its intersection with @xmath27 is lower than that of its intersection with @xmath26 . for general planar connected regions ,",
    "this relation need not be well behaved , but , for connected pieces of pairwise disjoint triangles , the relation is well defined , in the sense that it is independent of the choice of the line  @xmath30 .",
    "the final pieces into which the triangles of @xmath4 will be cut will have _ constant description complexity _ , as defined above .",
    "however , until the very end of the construction , we will only generate certain constant - degree algebraic curves that are drawn on the respective triangles . only at the end we will use these curves to construct the desired output collection of constant - complexity pieces with the desired properties .",
    "a _ cycle _ in @xmath23 is a circular sequence of some @xmath13 objects from @xmath22 that satisfy @xmath32 .",
    "we refer to @xmath13 as the _ length _ of the cycle ; a cycle of length  @xmath13 is a _",
    "@xmath13-cycle_. note that self - loops and 2-cycles are not possible in @xmath22 under our assumptions ( although they may very well exist for more general objects ) , so we must have @xmath33 .",
    "[ [ the - problem - restated . ] ] the problem , restated .",
    "+ + + + + + + + + + + + + + + + + + + + + +    we are now ready to formally state the problem : let @xmath4 be a collection of @xmath0 non - vertical pairwise disjoint triangles in general position in @xmath5 . as already mentioned above and illustrated in figure  [ tricyc ] , @xmath34 may contain cycles .",
    "our goal is to cut the triangles of @xmath4 into a small number of path - connected pieces of constant description complexity , so that , for the collection @xmath22 of the resulting pieces , @xmath23 is acyclic  a _ depth order_. there is a straightforward way of achieving this : project all triangles of @xmath4 orthogonally to the @xmath6-plane and form the resulting arrangement of triangles , which consists of at most @xmath35 faces .",
    "extrude each face of this arrangement into an unbounded @xmath31-vertical prism , and cut each triangle @xmath36 into pieces along the polygonal curve of its intersection with the prism boundary .",
    "it is easy to see that the number of resulting pieces is @xmath37 , and that the pieces corresponding to a single prism form a linear order under @xmath11 , while the pieces from different prisms are unrelated by @xmath11 , so indeed there are no cycles .",
    "it is moreover easy to refine this decomposition so that the resulting pieces are triangles , with no asymptotic increase in the number of pieces .",
    "the cubic number of pieces obtained by this naive approach is excessive .",
    "a better bound on the number of pieces sufficient to eliminate all cycles is provided by the _ binary space partition _  ( bsp ) technique of paterson and yao  @xcite , which eliminates all cycles by cutting the triangles into @xmath14 ( triangular ) pieces .",
    "in fact , the construction in @xcite has a much stronger property : the resulting collection of triangular pieces has no cycles in the depth relation corresponding to _ any _ viewing direction , or , more generally , to the perspective view from an arbitrary point .    in this paper",
    "we show that cycles in the depth relation ( for a _ fixed _",
    "viewing direction , which , as already stated , is taken to be the view from @xmath17 ) can be eliminated by creating a significantly subquadratic number of pieces , while keeping the complexity of each piece constant .",
    "as already mentioned , the number of pieces that our technique yields , which is @xmath2 , for any prespecified @xmath1 , is nearly tight in the worst case .",
    "recall that we have assumed that the triangles of @xmath4 are in general position .",
    "we will cut the triangles by drawing curves on each triangle ; this will be performed in a hierarchical manner , by a recursive procedure .",
    "the triangle pieces will be defined implicitly as faces in the induced arrangement of curves in each triangle .",
    "we will deliver our promise of constant - description - complexity pieces at the very end of the argument , in section  [ sec : pieces ] .",
    "ideally , we would like the curves to be straight and the pieces to be triangular as in the bsp technique @xcite , but our argument can not achieve it , in its current form .",
    "so let @xmath22 denote the implicit collection of faces on the triangles .",
    "let @xmath38 be a cycle @xmath39 in  @xmath22 ( with  @xmath33 ) .",
    "we associate with @xmath38 a continuum @xmath40 of closed paths ( loops ) , where , informally , each path @xmath41 in @xmath42 traces the cycle along the objects .",
    "formally , each such @xmath41 is defined in terms of @xmath13 vertical lines @xmath43 , such that , for each @xmath44 , @xmath45 intersects both @xmath46 and @xmath47 ( where addition of indices is @xmath48 ) , at respective points and @xmath49 are a bit misleading if interpreted in terms of @xmath31-values ; they are intended to indicate progress along @xmath41 , in the sense that @xmath50 precedes @xmath51 along @xmath46 . ]",
    "@xmath51 , @xmath52 , so that @xmath51 lies below @xmath52 . for each @xmath44",
    ", we connect the two points @xmath53 by a jordan arc @xmath54 .",
    "the path @xmath41 is then the cyclic concatenation @xmath55 which is an alternation between the arcs @xmath56 along the objects , and the ( upward ) vertical jumps @xmath57 between them . as already said ,",
    "there is a continuum of possible paths , representing different choices of the vertical lines ( and thus points ) at which we decide to jump from object to object , and of the paths along which the `` landing '' and `` take - off '' points are connected along each object .    to eliminate all cycles , it suffices to cut all the associated closed paths .",
    "the following easy lemma states this precisely .",
    "[ cutpaths ] for each @xmath36 , let @xmath58 be a collection of curves drawn on @xmath8 , and let @xmath59 denote the relatively open two - dimensional faces of @xmath60 ; put @xmath61 and @xmath62 . then , to verify that the depth relation among the pieces in @xmath22 is acyclic , it is sufficient to ensure that , for each cycle @xmath38 in @xmath34 , and for each path @xmath63 , one of the arcs @xmath56 of @xmath41 has been cut by a curve in @xmath64 .",
    "notice that we require that _ all _ cyclic paths in @xmath65 be cut . for a specific path @xmath41",
    ", a subpath @xmath56 may be cut in such a way that it first leaves and then reenters the same piece of a triangle , thus keeping the cycle  @xmath38 alive .",
    "this would appear to be a problem , as @xmath56 can be replaced by a rerouted subpath @xmath66 that stays in the same piece . replacing @xmath56 by @xmath66 in @xmath41 , though",
    ", produces a _",
    "different _ cyclic path in @xmath65 , which we also require to be cut , and all these cuts will eventually eliminate @xmath38 .",
    "the following proof handles this issue appropriately .",
    "we proceed by contradiction : assume that all cyclic paths in  @xmath65 , for every cycle @xmath38 in  @xmath34 , have been cut , but nonetheless there remains a cycle @xmath67 in  @xmath23 . in this case",
    "the set @xmath68 of paths realizing @xmath69 is nonempty , and we pick a path @xmath70 , having the form , where each subpath @xmath56 is contained in the corresponding piece  @xmath71 , and each vertical jump  @xmath72 moves from  @xmath73 to  @xmath46 . each  @xmath46 is contained in some ( not necessarily distinct ) triangle @xmath74 , so @xmath56 is fully contained in @xmath75 , the jump @xmath72 can be viewed as a vertical jump from @xmath76 to @xmath75 , and therefore @xmath77 is a cycle in @xmath34 with a witness path @xmath41 that has not been cut , contradicting our assumption .",
    "our construction relies on the following result of guth  @xcite , which extends the earlier polynomial partitioning theorem of guth and katz  @xcite . for a non - zero polynomial",
    "@xmath78 $ ] , of degree @xmath79 , we let @xmath80 denote its zero set . removing @xmath81 from @xmath5",
    "creates @xmath82 open connected _ cells _ ( see , e.g. , warren  @xcite ) .",
    "the fact stated below is a special instance , tailored to our needs , of the considerably more general result in @xcite .",
    "[ fact : gut ] given a set of @xmath83 lines in @xmath5 and an integer @xmath84 , for a suitable absolute constant @xmath85 , there always exists a non - zero polynomial @xmath78 $ ] of degree at most @xmath79 , so that each cell of @xmath86 intersects at most @xmath87 of the given lines .",
    "the first step of our construction resembles that of the case of lines in  @xcite .",
    "specifically , let @xmath88 denote the set of the @xmath89 edges of the triangles in @xmath4 .",
    "let @xmath90 be a non - zero partitioning polynomial , of sufficiently large but _ constant _ degree @xmath79 , for the @xmath89 lines supporting the segments of @xmath88 , as provided by fact  [ fact : gut ] .",
    "that is , @xmath86 consists of @xmath91 open connected cells , each intersected by at most @xmath92 ( lines supporting ) segments of @xmath88 , for an absolute constant @xmath93 .",
    "we hereafter assume that @xmath81 does not fully contain any vertical line , which we can ensure ( as in the case of lines , treated in @xcite ) , by a sufficiently small generic tilting of the coordinate frame ; it can be argued ( we skip the details ) that the general position assumption ensures that such a tilting can be made without destroying any existing cycle as relatively open , as we have already indicated .",
    "this ensures that if @xmath94 is nonempty before the sufficiently small tilting , it will remain nonempty afterwards . ] in @xmath4 .",
    "we also assume , without loss of generality , that @xmath90 is square - free .",
    "for each of the @xmath13 ( open ) cells @xmath95 of @xmath86 , let @xmath96 denote the set of triangles of @xmath4 that intersect @xmath95 .",
    "[ [ an - overview - of - the - cycle - elimination - procedure . ] ] an overview of the cycle elimination procedure .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the general strategy is to construct a partitioning polynomial @xmath90 as in fact  [ fact : gut ] , to cut the triangles of @xmath4 into pieces , using @xmath81 in a manner detailed below , and then to recurse within each cell of the partition .",
    "each of the latter two phases , especially the third one , is more intricate here than in the case of lines , as detailed next .",
    "the setup at each recursive step , at some node @xmath97 of the recursion tree , is as follows .",
    "we have a subset @xmath98 of @xmath4 , and an open cell @xmath99 , which is a connected component of @xmath100 , where @xmath101 is the partitioning polynomial constructed at the parent step @xmath102 . in fact , we have a hierarchy of cells @xmath103 , each of which arises at some proper ancestor @xmath104 of @xmath97 ; the cell at the root is the entire 3-space .",
    "note that these cells need not be contained within one another .",
    "the procedure generates , at step @xmath97 , a constant number of constant - degree algebraic curves ( where the constants depend on the prespecified @xmath3 ) on each triangle @xmath105 , and clips each curve to the region @xmath106 .",
    "this may break a curve into several connected arcs ; the number of such subarcs , and their pattern of intersection , will be examined in section  [ sec : drawing ] .",
    "we now proceed to describe the process in full detail . as in  @xcite , define the _ level _ @xmath107 of a point @xmath108 with respect to @xmath81 to be the number of intersection points of @xmath81 with the relatively open downward - directed vertical ray @xmath109 emanating from  @xmath110 . formally , if @xmath111 , we consider the univariate polynomial @xmath112 , and the level @xmath107 of @xmath110 is the number of real zeros of @xmath113 in @xmath114 , counted with multiplicity .",
    "the procedure is recursive . at each step of the recursion",
    "we have a subset of the triangles , which we also call @xmath4 , to simplify the notation , and which is processed as follows .",
    "( a ) we construct a partitioning polynomial @xmath90 , as in fact  [ fact : gut ] , for ( the lines supporting ) the edges of the triangles of  @xmath4 ; the degree  @xmath79 of @xmath90 is a sufficiently large constant that depends on the prespecified @xmath3 ( in a manner detailed later ) .",
    "( b ) we generate curves on the triangles of   @xmath4 . for each @xmath36",
    ", we generate up to @xmath82 curves of degree  @xmath79 , and one curve of degree @xmath115 .",
    "( c ) we recurse within each cell  @xmath95 of @xmath86 with the subset of those triangles that have at least one edge that crosses @xmath95 .    in more detail ,",
    "the procedure consists of the following steps . in this description ,",
    "we completely ignore the issue of clipping the curves .",
    "it is irrelevant to the main part of the construction , and will be picked up only towards the end , when we construct the pieces into which the triangles are to be cut .    *",
    "( i ) * for each triangle @xmath116 , not fully contained in @xmath81 , we draw @xmath117 on @xmath8 .    *",
    "( ii ) * consider the set of points @xmath118 that are either singular or have a @xmath31-vertical tangent line .",
    "this set is contained in the common zero set @xmath119 of @xmath90 and @xmath120 , which is one - dimensional since , by assumption , @xmath90 is square - free .",
    "let @xmath121 denote the vertical `` curtain '' spanned by @xmath122 , namely , the union of all @xmath31-vertical lines that pass through points of @xmath122 . since @xmath122 is an algebraic curve of degree @xmath115 ( see , e.g. , @xcite ) , @xmath121 is a two - dimensional variety of the same degree .",
    "we then draw , on each triangle @xmath116 not fully contained in @xmath81 , the curve @xmath123 .    *",
    "( iii ) * if @xmath124 , that is , if the plane @xmath125 supporting @xmath8 is a component of @xmath81 , we do not draw any curve on @xmath8 .",
    "note though that other triangles will be cut , in step ( i ) , by @xmath125 , which will draw on each such triangle  @xmath9 the segment @xmath126 ( if nonempty ) .    *",
    "( iv ) * we now want to proceed recursively , within each cell @xmath95 of the partition .",
    "before doing so , we first need to draw additional curves on the triangles , as described below .",
    "let us consider the interaction of the triangles @xmath127 with the cells of the partition . by construction , each cell @xmath95 meets the edges of at most @xmath128 triangles .",
    "however , the plane spanned by such a triangle @xmath8 ( and therefore the relative interior of @xmath8 ) meets @xmath115 of the cells , a consequence of warren s theorem  @xcite .",
    "therefore , each cell @xmath95 meets @xmath128 triangle edges and , on average , @xmath129 triangle interiors ; in the worst case , the latter bound is tight .",
    "we say that a triangle @xmath8 _ pierces _",
    "@xmath95 if one or more of its edges intersects @xmath95 , and that it _ slices _",
    "@xmath95 if only its relative interior meets @xmath95 .",
    "a face @xmath130 of @xmath131 can be similarly classified as _ piercing _ if it touches an edge of @xmath8 , and _ slicing _ if it lies fully in the relative interior of @xmath8 ; the cell @xmath95 that @xmath130",
    "pierces or slices varies , in general , with @xmath130 .",
    "our plan now is to recurse , for each @xmath95 , only on the set @xmath132 of triangles that pierce  @xmath95 ( that is , triangles @xmath8 with at least one face @xmath130 of @xmath131 piercing @xmath95 ) , and disregard , for the purposes of recursion , the slicing triangles .",
    "however , we first want to ensure that the slicing triangles do not participate in any depth cycle within @xmath95 , and for this we need to draw additional curves , as described next .    let @xmath133 be the slicing faces ( or _ slices _ , for short ) of all triangles of @xmath4 .",
    "consider the effect of removing these slices from @xmath134 , one at a time . from @xmath86",
    "means that we _ insert _ @xmath130 as a `` membrane '' which locally separates the two sides of @xmath86 near @xmath130 . ]",
    "the first slice  @xmath135 is contained in some cell  @xmath136 of @xmath134 and cuts it locally in two .",
    "however , the removal of  @xmath135 may or may not disconnect @xmath136 : @xmath137 may have either one or two connected components ; see figure  [ fig : slices ] .",
    "analogously , when we remove @xmath138 from the current cell of @xmath139 containing it , this may or may not disconnect the cell .",
    "we call @xmath138 a _ disconnecting slice _ ( resp . , _ non - disconnecting slice _ ) in the former ( resp . ,",
    "latter ) case ; notice that this classification depends on the ordering of the slices . in appendix",
    "[ sec : later , later ] , we prove the following technical result , which is a crucial ingredient in our analysis and has no analogue in the case of lines :    [ lem : count - slices ] there is an ordering of the slices @xmath133 , so that the number of non - disconnecting slices is @xmath82 .    returning to our construction ,",
    "perform the following operation for every non - disconnecting slice  @xmath130 : let @xmath140 denote the unbounded @xmath31-vertical cylinder spanned by @xmath130 . for each triangle @xmath141 , form the curve @xmath142 , and add it to the curves already drawn .",
    "* ( v ) * we finally apply recursion , within each cell @xmath95 of the partition , with the subset @xmath143 of the piercing triangles of @xmath95 . recall that @xmath95 , as a spatial entity , is also crossed by additional slicing triangles , which will not be considered in the recursive subproblem ; this should be kept in mind when we address , in the next subsection , the correctness of the procedure .    as in the case of lines ,",
    "the bottom of the recursion is at cells @xmath95 for which @xmath144 . for such cells we apply the paterson - yao binary space partitioning  @xcite , which cuts the triangles into @xmath145 triangular pieces ,",
    "whose depth relation does not contain cycles .",
    "following our strategy , we do not really perform the cuts yet , but just add the straight segments that perform these cuts to the collections of curves on the triangles .",
    "let @xmath146 denote the set of all curves that have been generated throughout the recursion .",
    "as in lemma  [ cutpaths ] , we write @xmath146 as the disjoint union @xmath147 , where @xmath148 is the set of curves drawn on @xmath8 , for each @xmath36 .    recall that each curve @xmath149 is clipped to within the intersection of all the ancestral cells of the cell  @xmath136 associated with the recursive step at which @xmath150 is generated , starting with  @xmath136 . as already described , we clip each curve @xmath151 to within the intersection of all the ancestral cells that lead to the recursive step at which @xmath150 has been generated .",
    "this clipping is needed to control the number of pieces into which the triangles will eventually be cut . for each @xmath36",
    ", we let @xmath58 denote the collection of the clipped portions of the curves in @xmath148 , and let @xmath64 denote the union of these collections .",
    "[ tricutok ] the procedure described above eliminates all the depth cycles in @xmath4 , in the sense that , for each cycle @xmath38 in @xmath34 and for each path @xmath63 of the form , at least one of the `` on - triangle '' subpaths @xmath56 of @xmath41 is crossed by a curve of @xmath64 .",
    "the clipping of the curves makes the analysis rather intricate , because whenever we argue that some subpath of @xmath41 is cut by one of the generated curves , we also need to ensure that the cut point lies in all the ancestral cells of the node at which the cutting curve has been generated .",
    "fortunately , these two aspects of the analysis are rather independent of one another , so we prove the lemma in two respective steps .",
    "we first suppose that the generated curves are not clipped at all . ] and show that in that case all paths @xmath41 as in the lemma are cut by the unclipped curves ( that is , curves of @xmath146 ) .",
    "then we show that each of the cuts produced in the first step is made at a point that belongs to all the ancestral cells , implying that the cut lies on the corresponding clipped curve ( in @xmath64 ) as well .",
    "[ unclip ] for each @xmath38 and @xmath41 as in the premises of lemma  [ tricutok ] , one of the subpaths @xmath56 of @xmath41 is cut by a curve of @xmath146 .",
    "the proof is by a bottom - up induction on the recursion tree .",
    "specifically , let @xmath97 be a node of the tree , let @xmath98 be the set of triangles passed to the recursive step at @xmath97 , let @xmath152 be a cycle in @xmath153 , and let @xmath41 be a path in @xmath154 of the form .",
    "the inductive claim is that some subpath  @xmath56 of  @xmath41 will be cut by an _ unclipped _",
    "curve generated at @xmath97 or at some descendant thereof .",
    "the claim clearly holds when @xmath97 is a leaf , as the bsp constructed there eliminates all cycles ( in the sense of lemma  [ cutpaths ] ) .",
    "assume then that the claim holds at all proper descendants of some node @xmath97 , and consider the situation at @xmath97 .",
    "assume first that @xmath41 does not intersect @xmath81 .",
    "then @xmath41 is fully contained in some cell @xmath95 of @xmath134 , and therefore @xmath155 .",
    "if each @xmath75 pierces @xmath95 , then @xmath156 , all these triangles are passed to the recursive problem at @xmath95 , and the cycle @xmath157 , and therefore the cyclic path @xmath41 too , will be cut , by the inductive hypothesis , in the above sense , by some unclipped curve generated at the recursive call within @xmath95 .",
    "consider then the case where some of the triangles @xmath75 are slicing triangles for @xmath95 ; by definition , for such a triangle @xmath75 , every connected component of @xmath158 is a slice , fully contained in the relative interior of @xmath75 .",
    "since @xmath41 is fully contained in @xmath95 and visits each triangle in the cycle , it must visit at least one of these slices .",
    "assume first that it visits at least one non - disconnecting slice , call it  @xmath130",
    ". then @xmath41 intersects the ( solid ) vertical cylinder @xmath140 erected at step ( iv ) .",
    "if it crosses the boundary @xmath159 of @xmath140 , then any such crossing point @xmath110 must lie along one of the subpaths @xmath56 ( as the vertical jumps along @xmath41 are vertical and can not enter or leave @xmath140 ) , and then @xmath56 will be cut at @xmath110 , as desired .",
    "otherwise , @xmath41 is fully contained in the interior of @xmath140 , but then , once it leaves @xmath130 by a vertical jump upwards , it can not return to the portion of @xmath140 below @xmath130 , unless it crosses  @xmath130 again , from its top side to its bottom side , which contradicts the definition of the paths representing cycles .",
    "more specifically , @xmath41 either follows a triangle , or travels between triangles , which are pairwise disjoint , by vertical jumps _ upwards _ , which would make it impossible to return from the region above  @xmath130 back to  @xmath130 from below  @xmath130 , all within  @xmath140 , to complete the cyclic path @xmath41 .    since the above argument can be applied to any non - disconnecting slice belonging to any of the triangles @xmath160 ,  , @xmath161",
    ", we can now assume that @xmath41 meets no non - disconnecting slices .",
    "let @xmath130 be the _ first _ , necessarily disconnecting , slice that @xmath41 intersects , in the ordering provided by lemma  [ lem : count - slices ] ; without loss of generality , assume that @xmath162 .",
    "let @xmath163 be the connected component containing @xmath130 in the current state of refinement of the cell @xmath95 in that order , immediately before inserting @xmath130 ( recall that @xmath41 meets no slices of any kind that precede @xmath130 in the insertion order , so @xmath164 ) , and put @xmath165 . as @xmath130 is a disconnecting slice , @xmath166 consists of two connected components , @xmath167 , lying locally above @xmath130 , and @xmath168 , lying locally below it .",
    "recall that @xmath41 is fully contained in @xmath169 . by construction",
    ", @xmath41 enters @xmath130 from below by an upward jump @xmath170 , follows it along @xmath171 , and exits it by another upward jump @xmath172 ; so it locally goes from @xmath168 to @xmath130 to @xmath167 .",
    "since @xmath41 is a closed path , it must now go from @xmath167 back to @xmath168 , within @xmath169 .",
    "but , using exactly the same reasoning as before , this is impossible : the only way to return from @xmath167 to @xmath168 within @xmath169 is to cross @xmath130 again ( as it separates @xmath168 and @xmath167 ) , from its upper side to its lower side , which can not be done by any part of @xmath41 , as it either follows triangles ( which are pairwise disjoint , so none of them meets @xmath130 , except for @xmath160 itself ) or jumps between them in upward direction only .",
    "( note that in general @xmath41 may revisit the slice @xmath130 .",
    "then it crosses from below @xmath130 to above @xmath130 more than once , and still has no way to return to the bottom side , as previously argued . )",
    "we can thus assume that @xmath41 is contained within @xmath95 and does not use any slicing triangle , so , by the induction hypothesis , it will indeed be cut by the recursive step at @xmath95 , as claimed .",
    "this concludes the handling of the case when @xmath41 avoids @xmath81 .",
    "hereafter we assume that @xmath41 intersects @xmath81 .",
    "assume first that @xmath81 does not fully contain any of the triangles @xmath173 .",
    "if @xmath81 intersects one of the arcs @xmath56 , for @xmath174 , the arc has been cut and we are done ( the exceptional case when @xmath56 is partially or fully contained in @xmath81 is addressed in the full version of the paper ) . assume next that none of the triangles @xmath173 is fully contained in @xmath81 , and that none of the arcs @xmath175 is crossed by ( or contained in ) @xmath81 . in this case",
    ", the crossing points of @xmath41 with @xmath81 must all lie on the vertical edges of @xmath41 .",
    "recall that we have ensured that @xmath81 does not fully contain any such vertical segment .",
    "trace @xmath41 in a circular fashion , as in its definition , and keep track of the level @xmath107 in @xmath81 of the point @xmath110 being traced . by our general position assumption , and by the tilting performed above , @xmath107 is well defined , and it can change only either at a vertical jump of @xmath41 , in which case it can only increase , or at a point @xmath176 ( see step ( ii ) for the definition of @xmath121 ) . since the level goes up at least once ( at some vertical jump of @xmath41 , where it crosses @xmath81 ) , it must also go down , so at least one arc @xmath56 of @xmath41 must cross @xmath121 , and the claim holds in this case too .    finally , consider the case where one ( or more ) of the triangles @xmath173 is fully contained in @xmath81 ; say @xmath160 is such a triangle . in this case , we have generated , in step  ( i ) ( see a comment in step  ( iii ) ) , for each of the other triangles @xmath75 , the straight segment of intersection of @xmath75 with the plane @xmath177 ( if it exists ) .",
    "the path leaves @xmath160 by a vertical jump into the upper halfspace @xmath178 bounded by @xmath177 , and returns to @xmath160 by a vertical jump from the complementary lower halfspace @xmath179 .",
    "this however requires @xmath41 to cross @xmath177 again , from @xmath178 to @xmath179 .",
    "this can not be done by a vertical jump , since it may only cross from @xmath179 to @xmath178 , as it only moves upward , so it must occur while tracing some subpath @xmath180 ( with @xmath181 ) .",
    "but then @xmath56 must cross the segment @xmath182 , as asserted .",
    "having covered all cases , the lemma follows .    in summary ,",
    "if we stick to the set @xmath146 of unclipped curves , the previous lemma shows that every witness path @xmath41 of any cycle @xmath38 in @xmath34 is cut by a curve of @xmath146 along one of its on - triangle subpaths @xmath56 .",
    "the following lemma completes the picture by showing that this also holds for the clipped versions of the curves .    [ clip ]",
    "let @xmath38 be a cycle in @xmath34 and let @xmath41 be a path in @xmath65 .",
    "let @xmath97 be the highest node of the recursion tree at which @xmath41 has been cut by some unclipped curve of @xmath146 that has been generated during the non - recursive processing of @xmath97 , as in lemma  [ unclip ]",
    ". then any such cutting point belongs to all the cells associated with the ancestral nodes of @xmath97 , and thus belongs to the clipped version of the cutting curve .    by construction and by the proof of lemma  [ unclip ]",
    ", the fact that @xmath41 has been cut at @xmath97 means that it was fully contained in each of the ancestral cells of @xmath97 .",
    "in particular , any point at which @xmath41 has been cut belongs to all these cells .    in other words , if we actually draw all the ( clipped ) curves of @xmath64 on their respective triangles , all cycles will be eliminated .",
    "this completes the proof of lemma  [ tricutok ] .",
    "this finishes the proof of correctness of our procedure . we still need to fill three gaps : ( i )  we need an upper bound on @xmath183 , the number of ( unclipped ) curves that the procedure generates .",
    "( ii )  we need to bound the number of connected components of the clipped curves and the number of their intersection points .",
    "( iii )  we need to cut each triangle into pieces of constant description complexity ( and control their number ) .",
    "we now proceed to describe each step in detail .",
    "let @xmath184 denote the maximum number of ( unclipped ) algebraic curves that our procedure generates on the triangles of @xmath4 , for the fixed choice of @xmath79 that we use throughout the recursion .",
    "put @xmath185 , where the maximum is taken over all collections @xmath4 of @xmath0 non - vertical pairwise disjoint triangles in general position in @xmath5 . to estimate @xmath184",
    ", we collect the bounds from each step of our construction , and obtain the recurrence relation @xmath186 where @xmath187 and @xmath85 are suitable absolute constants ; the overhead term @xmath188 is due to the cuts made by the @xmath82 vertical cylinders erected over non - disconnecting slices , in step ( iv ) of the construction , and subsumes all other non - recursive cuts made at the present node . maximizing over @xmath4 produces the recurrence @xmath189 for @xmath190 , and @xmath191 otherwise . the solution of this recurrence is easily seen to be @xmath192 , where @xmath193 . specifically , we require @xmath3 and @xmath79 to satisfy the inequality @xmath194 so @xmath195 .",
    "conversely , when @xmath3 is prescribed , we need to choose @xmath196 , with a suitable constant of proportionality .      at any recursive step , within some cell @xmath95 , each triangle @xmath197 is a piercing triangle in at most @xmath198 subcells of @xmath95 . before sending @xmath8 down the recursion , we generate on it one curve of degree @xmath79 from step  ( i ) and one curve of degree @xmath115 from step  ( ii ) , when applicable . in addition ,",
    "in the preliminary part of step  ( iv ) , we generate @xmath82 curves , formed by the cylinders erected over the non - disconnecting slices , each of degree @xmath79 , and in step  ( iii ) , we generate one segment for each of the at most @xmath79 linear components of @xmath81 .",
    "altogether , we generate on @xmath8 up to @xmath82 curves of degree at most @xmath79 , and one curve of degree @xmath115 .",
    "we recall though that these drawings are only formed within the intersection @xmath199 of all cells associated with the ancestral steps of the current node @xmath97 of the recursion .",
    "this is important for controlling the complexity of the arrangement of the curves drawn on each triangle .",
    "concretely , upon termination of the entire recursive process , we take each triangle @xmath36 , and consider the planar map @xmath200 formed on @xmath8 by the hierarchy of drawings constructed on it .",
    "that is , we take each curve @xmath150 , generated at some recursive node @xmath97 , and draw only its portions that lie in the corresponding intersection cell @xmath199 .",
    "each vertex of @xmath200 is either ( a ) an endpoint of a connected component of the clipped portion of some curve  @xmath150 , or ( b ) an intersection point between two curves @xmath150 , @xmath201 , such that either ( i ) both arcs are generated at the same recursive step , within the same cell @xmath95 , or ( ii ) up to a swap between the arcs , @xmath150 , @xmath201 are generated within two respective cells @xmath95 , @xmath202 , such that the step that generated  @xmath202 is an ancestor of the step that generated  @xmath95 .",
    "these properties follow from the hierarchical nature of our drawings .",
    "note that most vertices of type ( a ) are actually also vertices of type ( b ) , because they are intersections of the full algebraic curve containing @xmath150 with the boundary of some ancestral cell , which is an intersection point of this curve with @xmath81 , for the corresponding partitioning polynomial @xmath90 .",
    "since we generate ( in step ( i ) of the construction ) the curves @xmath117 at each recursive step , the claim follows .",
    "the exceptions are endpoints of curves that lie on the edges of the corresponding triangles ; we may ignore these vertices , as their overall number is only @xmath203 , as is easily checked .",
    "it therefore suffices to bound the number of intersection points of arcs with arcs constructed at ( proper and improper ) ancestral recursive steps . for each arc @xmath150 ,",
    "formed along some triangle @xmath8 , within a cell @xmath95 at some recursive step , the number of the ancestral cells of @xmath95 is @xmath204 , and each of them generates on @xmath8 up to @xmath82 curves of degree at most @xmath79 , and one curve of degree @xmath115 . for the present argument , treat these curves as drawn in their entirety",
    " this will only increase the number of intersection points on @xmath150 . the number of intersection points of @xmath150 with a curve of the former ( resp .",
    ", latter ) kind is @xmath82 ( resp . ,",
    "@xmath191 ) ; this is a consequence of bzout s theorem , where we make the `` worst - case '' assumption that the degree of @xmath150 is @xmath115 .",
    "it follows that the number of vertices that can be formed along @xmath150 is at most @xmath205 , an obvious gross overestimate that we do not bother to optimize .    multiplying this bound by the number of curves",
    ", we get that the overall complexity of the maps @xmath200 , over all triangles @xmath8 , is @xmath206 where , as we recall , the prespecified @xmath1 can be chosen arbitrarily small , and where @xmath196 , with a suitable constant of proportionality .",
    "it then easily follows that , by slightly increasing @xmath3 , but keeping it sufficiently small , we can still write the bound as @xmath2 , with @xmath196 and slightly larger constants of proportionality .",
    "finally , we take the planar map @xmath200 , for each triangle @xmath8 , and decompose it into regions of constant description complexity , by constructing the _ trapezoidal decomposition _ @xcite of @xmath200 in some fixed , but arbitrarily ( and generically ) chosen `` vertical '' direction within @xmath8 ( where the complementary `` horizontal '' direction is chosen to be perpendicular to the vertical one within @xmath8 ) . each resulting piece is a `` pseudo - trapezoid , '' with ( at most ) two vertical sides , and `` top '' and `` bottom '' parts , each consisting of a monotone subarc of one of the curves we have drawn on @xmath8 , and thus having degree at most @xmath115 .",
    "the number of trapezoids is proportional to the complexity of @xmath200 , which in turn is proportional to the number of its vertices and the number of points on the drawn curves that are `` horizontally '' extreme ( as the curves have bounded complexity , each has only a constant number of such extreme points ) .",
    "using the analysis from the preceding subsection , this brings us to the main result of the paper .",
    "[ thm : main ] let @xmath4 be a collection of @xmath0 pairwise disjoint non - vertical triangles in @xmath5 .",
    "then , for any prescribed @xmath1 , we can cut the triangles of @xmath4 into @xmath2 pseudo - trapezoids , bounded by algebraic arcs of constant maximum degree @xmath207 , whose depth relation is acyclic ; here @xmath207 , and the constant of proportionality , depend on @xmath3 .",
    "our bound is slightly larger than that in @xcite due to our choice of a _ constant _ value , rather than a function of @xmath0 , for the degree  @xmath79 of the partitioning polynomials .",
    "in this paper we have essentially settled the long - standing problem of eliminating depth cycles in a set of triangles in @xmath5 . on the positive side ,",
    "our solution is almost optimal in the worst case , in terms of the number of pieces , as this number is only slightly larger than the worst - case lower bound @xmath15 .",
    "less impressively , the cuts are by constant - degree algebraic arcs , rather than , ideally , by straight segments .",
    "it is a natural open problem to determine whether a similar bound can be achieved with straight cuts ( as in the bsp technique of @xcite ) .",
    "even a weaker bound , as long as it is subquadratic and generally applicable , would be of great significance .",
    "another direction for further research is to further tighten the bound , removing the @xmath3 in the exponent and replacing it by a poly - logarithmic factor , as in @xcite ( while keeping the shape of the cut pieces simple ) .",
    "it seems likely that , with some care , our technique can be extended to collections of triangles that are only pairwise openly disjoint but may share edges , and to situations where the triangles are not in general position . extending the technique to curved objects ( e.g. , spheres or spherical patches ) is also a major challenge . finally ,",
    "as noted above , the bsp partition of @xcite has the stronger property that the depth relation of the resulting pieces is acyclic with respect to any viewing point or direction .",
    "our solution does not seem to have this property , so one could ask whether one can cut the triangles into a _ subquadratic _ number of simple pieces that have this stronger property , or whether @xmath208 pieces are required , in the worst case",
    ".    99    p.k .",
    "agarwal , e.f .",
    "grove , t.m .",
    "murali , and j.s .",
    "vitter , binary space partitions for fat rectangles ,",
    "_ siam j. comput . _ 29(5 ) ( 2000 ) , 1422 - 1448 .",
    "k.  agarwal , j.  matouek , and m.  sharir , on range searching with semialgebraic sets  ii , _",
    "siam j.  comput .",
    "_ 42 ( 2013 ) , 20392062 . also in arxiv:1208.3384 .",
    "b.  aronov , v.  koltun , and m.  sharir , cutting triangular cycles of lines in space , _ discrete comput",
    ". geom . _ 33 ( 2005 ) , 231247 .",
    "b.  aronov , m.  de berg , c.  gray , and e.  mumford , cutting cycles of rods in space : hardness results and approximation algorithms , _ proc .",
    "19th annu .",
    "acm - siam sympos .",
    "alg . _ , 2008 , 12411248 .",
    "b.  aronov and m.  sharir , almost tight bounds for eliminating depth cycles in three dimensions , _ proc .",
    "48th acm sympos .",
    "theory of computing _ , 2016 , 18 .",
    "also in arxiv:1512.00358 .",
    "b. aronov and m. sharir , on translational motion planning of a convex polyhedron in 3-space , _ siam j. comput . _ 26(6 ) ( 1997 ) , 17851803 .",
    "s. basu , r. pollack , and m .- f .",
    "roy , on the betti numbers of sign conditions , _ proc .",
    "ams _ 133 ( 2005 ) , 965974 .",
    "m. de berg .",
    "ray shooting , depth orders and hidden surface removal_. lecture notes in computer science 703 , springer - verlag , berlin , 1993 .",
    "m. de berg .",
    "linear size binary space partitions for uncluttered scenes .",
    "_ algorithmica _ 28 ( 2000 ) , 353366 .    m.  de  berg , o.  cheong , m.  van kreveld , and m.  overmars , _ computational geometry : algorithms and applications _",
    ", springer - verlag , berlin - heidelberg , 2008 .",
    "b.  chazelle , h.  edelsbrunner , l.  j.  guibas , r.  pollack , r.  seidel , m.  sharir , and j.  snoeyink , counting and cutting cycles of lines and rods in space , _ comput .",
    "theory appls .",
    "_ 1 ( 1992 ) , 305323 .",
    "a.  dumitrescu , c.d .",
    "tth , binary space partitions , in _ encyclopedia of algorithms _ , m .- y .",
    "kao , ed . ,",
    "springer , 2016 , 220 - 223 .",
    "w.  fulton , _ introduction to intersection theory in algebraic geometry _",
    ", expository lectures from the cbms regional conference held at george mason university , june 27july 1 , 1983 , vol .",
    "ams bookstore , 1984 .",
    "l.  guth , polynomial partitioning for a set of varieties , _ math .",
    "cambridge phil .",
    "_ 159 ( 2015 ) , 459469 . also in arxiv:1410.8871",
    ".    l.  guth and n.  h.  katz , on the erds distinct distances problem in the plane , _ annals math . _ 181 ( 2015 ) , 155190 .",
    "also in arxiv:1011.4105 .",
    "s.  har - peled and m.  sharir , online point location in planar arrangements and its applications , _ discrete comput .",
    "_ 26 ( 2001 ) , 1940 .",
    "a.  hatcher , _ algebraic topology _",
    ", cambridge university press , 2001 .",
    "see also http://www.math.cornell.edu/~hatcher/at/atpage.html .",
    "m.  s.  paterson and f.  f.  yao , efficient binary space partitions for hidden - surface removal and solid modeling , _ discrete comput .",
    "_ 5 ( 1990 ) , 485503 .",
    "m. sharir and p.  k.  agarwal , _ davenport - schinzel sequences and their geometric applications _ , cambridge university press , new york , 1995 .",
    "a.  solan , cutting cycles of rods in space , _ proc .",
    "14th annu .",
    "acm sympos .",
    "geom . _ , 1998 , 135142 .",
    "e. spanier , _ algebraic topology _ ,",
    "mcgraw hill , new york , 1966 .",
    "tth , binary space partitions for axis - aligned fat rectangles .",
    "_ siam j. comput . _",
    "38(1 ) ( 2008 ) , 429 - 447 .",
    "tth , binary space partitions : recent developments , in _ combinatorial and computational geometry _ , vol .",
    "52 of msri publications , cambridge university press , 2005 , 529 - 556 .",
    "h.  e. warren , lower bound for approximation by nonlinear manifolds , _ trans .",
    "_ 133 ( 1968 ) , 167178 .",
    "we will start , in section  [ sec : top ] , by proving a technical topological fact , and then use to prove lemma  [ lem : count - slices ] in section  [ sec : later , later ] .",
    "in this section we prove a technical result , namely lemma  [ lemmatech ] .",
    "it is a special case of a more general statement , but we only prove a version sufficient for our purposes .",
    "consider a finite simplicial complex @xmath209 which is a union of non - empty connected subcomplexes @xmath210 .",
    "let @xmath211 , @xmath212 denote the associated topological spaces .",
    "consider the simple intersection graph @xmath213 of @xmath214 .",
    "more formally , let @xmath215 , @xmath216 , be a set of distinct vertices ( points ) of @xmath213 , with @xmath217 associated with @xmath210 , and let @xmath218 be an edge of @xmath213 whenever @xmath219 .",
    "put @xmath220 , the set of ordered pairs corresponding to edges of @xmath213 .",
    "consider the graph @xmath221 obtained by subdividing each edge of @xmath213 once ( @xmath221 is directed for convenience , it does not affect the rest of the argument ) .",
    "formally , let @xmath222 be a new set of distinct points @xmath223 , one for each @xmath224 .",
    "the vertex set of @xmath221 is @xmath225 and the edge set is @xmath226 , where @xmath227 and @xmath228 .    since each @xmath210 is connected , we define a continuous mapping @xmath229 , as follows : for each space @xmath212 fix a point @xmath230 and for each pair @xmath231 pick a point @xmath232 .",
    "now let @xmath90 send @xmath217 to @xmath233 and @xmath234 to  @xmath235 .",
    "viewing @xmath221 as a one - dimensional simplicial complex , extend @xmath90 to all of @xmath221 by choosing for each @xmath224 a continuous directed path from @xmath236 to @xmath235 in @xmath212 and a continuous directed path from @xmath235 to @xmath237 in @xmath238 .",
    "let @xmath239 be mapped to @xmath240 by the first choice and @xmath241 to @xmath242 by the second choice .",
    "we are now ready to state our topological fact :    [ lemmatech ] suppose that the simplicial complex @xmath243 is a union of non - empty connected subcomplexes @xmath210 , @xmath216 , and that any triple intersection @xmath244 is empty for any choice of pairwise distinct indices @xmath245 .",
    "then the induced mapping on first homology @xmath246 with coefficients in any field @xmath113 , is one to one .",
    "in particular , @xmath247 .    the first equality is standard ; so it suffices to show that @xmath248 is one to one .",
    "the case @xmath249 is vacuously true , so we will assume @xmath250 hereafter .",
    "our proof proceeds as follows .",
    "one embeds @xmath211 into a suitable topological space @xmath251 $ ] , by an inclusion @xmath252 $ ] , and proves that the composite mapping @xmath253\\ ] ] induces an isomorphism in homology in all dimensions .",
    "that is , the composite on homology @xmath254 induces an isomorphism on homology in each dimension .",
    "so in particular , @xmath248 is one to one for induced mapping on the first homology @xmath255 as desired .",
    "recall that , for a topological space @xmath256 , the _ cone on @xmath256 with cone point @xmath257 _ , @xmath258 , is obtained from the topological product @xmath259= \\ { ( x , t ) \\mid   x \\in x,\\ 0 \\le t \\le 1\\}$ ] by identifying the subspace @xmath260 to the point  @xmath261 and giving the quotient space the quotient topology .",
    "the mapping @xmath262 defines a continuous embedding of @xmath256 into the cone @xmath258 : @xmath263 .",
    "the main proof will proceed by induction . before defining @xmath264",
    "$ ] , for @xmath265 , we construct an intermediate topological space , @xmath266 $ ] , as follows .",
    "fix distinct @xmath0 points @xmath267 disjoint from @xmath211 and form the identification space @xmath268 = ( \\cup_1^a   |k_i| ) \\",
    "( \\cup_{i=1}^a   c_{x_i}(|k_i|)\\ / \\   \\sim,\\ ] ] where @xmath269 is identified by @xmath270 with @xmath271 via @xmath272 for each  @xmath44 .",
    "that is , to form  @xmath266 $ ] , we `` cone off '' independently the subspace @xmath212 of @xmath273 by using the cone point  @xmath274 for each @xmath275 .    put @xmath276= \\ { ( i , j ) \\in e \\mid 1 \\le i < j \\le a\\ } \\subset e$ ] .",
    "note that , for each @xmath277 $ ] , two cones on @xmath278 given by @xmath279 are identified along @xmath280 ( this is often called the suspension of @xmath278 ) and so includes into @xmath266 $ ] via @xmath281.\\ ] ]    for each pair @xmath282 $ ] , fix a distinct point @xmath283 $ ] with all these choices distinct .",
    "we now form the space @xmath264 $ ] , for @xmath284 , from @xmath266 $ ] by `` coning off '' independently the suspension subspaces @xmath285 $ ] by using the cone point @xmath286 for each @xmath277 $ ] .",
    "this process defines @xmath264 $ ] and the inclusions @xmath287 =   ( \\cup_1 ^a |k_i| ) \\ \\cup \\",
    "( \\cup_{i=1}^a   c_{x_i}(|k_i| ) \\cup ( \\cup_{(i , j)\\in e[a ] } \\ c_{y_{i , j } } ( \\",
    "c_{x_i}(|k_i| \\cap |k_j| ) \\cup c_{x_j}(|k_i| \\cap",
    "|k_j|))\\ ) /\\sim.\\ ] ]    now introduce the subgraphs @xmath288 $ ] of @xmath221 , for @xmath289 , defined as follows : @xmath290 = g'$ ] ; while for @xmath291 let @xmath288 $ ] be the induced subgraph of @xmath221 with vertices @xmath292 union @xmath293 .",
    "the edges @xmath294 , with @xmath295 , are mapped by @xmath90 to the union @xmath273 , by construction .",
    "the edges @xmath296 for @xmath297 are also mapped to paths contained in @xmath212 , by our selection of the points @xmath298 and connecting paths .",
    "hence , restricted to @xmath299|$ ] the map @xmath90 sends this larger subgraph to the subset @xmath300 also .",
    "let the induced mapping be called @xmath301 : @xmath302| \\rightarrow ( \\cup_1^a |k_i|).\\ ] ]    the proof that @xmath303 \\rightarrow m[n]$ ] induces an isomorphism on homology is accomplished by induction on @xmath304 , showing that @xmath305 \\rightarrow m[a]$ ] induces an isomorphism on homology for @xmath306 .",
    "the base of the induction corresponds to @xmath307 .",
    "@xmath308 = \\{v_1\\}$ ] is a single point , which under @xmath90 is mapped to @xmath309= c_{x_1}(|k_1|)$ ] .",
    "this last cone has the homology of a point , so as desired @xmath310 induces an isomorphism on homology .",
    "now assume that @xmath311 induces an isomorphism on homology with @xmath312 .",
    "then @xmath313 = g'[a ] \\cup x[a+1]$ ] where @xmath314 $ ] is the subgraph of @xmath313 $ ] induced by vertices @xmath315 \\}$ ] .",
    "@xmath314 $ ] is a tree and as such contractible to the point @xmath316 and has homology of a point .    now",
    "in an analogous fashion , @xmath317 = m[a ] \\cup y[a+1]$ ] , where @xmath318 & = c_{x_{a+1}}(|k_{a+1}| ) \\cup   z[a+1 ] /\\sim , \\text { where}\\\\ z[a+1 ] & = \\bigcup_{(i , a+1 ) \\in e[a+1 ] } \\bigl [ c_{y_{i ,",
    "a+1}}(c_{x_{a+1}}(|k_i| \\cap |k_{a+1}| )   ) \\cup c_{x_i } ( |k_i| \\cap |k_{a+1}| ) \\bigr ] /\\sim.\\end{aligned}\\ ] ] note that by the empty - triple - intersection assumption , the union over pairs @xmath319 $ ] is a union of cones which all contain the cone point @xmath320 and the intersection of any two such is precisely this single point @xmath320 .",
    "hence , @xmath321 $ ] is a union of cones all meeting at the single point @xmath320 and has the homology of a point .",
    "from this fact , one may deduce that @xmath322 $ ] has the homology of a point as follows : the exact sequence for pair @xmath323,z[a+1])$ ] in reduced homology gives the short exact sequence , @xmath324 ) \\rightarrow \\tilde{h}_\\star(y[a+1 ] ) \\rightarrow h_\\star(y[a+1],z[a+1])$ ] @xcite .",
    "now by the above , @xmath324 ) = 0 $ ] , so by exactness @xmath325 ) = 0 $ ] will follow if one shows @xmath326 , z[a+1 ] ) = \\tilde{h}_\\star ( y[a+1]/z[a+1 ] ) = 0 $ ] .",
    "but the quotient space @xmath322/z[a+1]$ ] is identified with the cone @xmath327 } \\",
    "|k_i| \\cap |k_{a+1}|))$ ] which has vanishing reduced homology .",
    "hence , @xmath326)$ ] has vanishing reduced homology ; that is , @xmath322 $ ] has the homology of a point .",
    "the mapping @xmath328 carries @xmath288 $ ] to @xmath264 $ ] by @xmath311 ; it carries @xmath314 $ ] which has the homology of a point to @xmath322 $ ] which has the homology of a point , and it carries",
    "@xmath288 \\cap x[a+1]$ ] to @xmath264 \\cap y[a+1]$ ] .    by the induction hypothesis , the first map @xmath311 induces an isomorphism on homology ; by the above the second mapping induces an isomorphism on homology since both terms have the homology of a point .",
    "the third mapping is the inclusion of the intersection @xmath288",
    "\\cap x[a+1 ] = \\ { w_{i , a+1 } \\mid ( i , a+1 ) \\in e[a+1]\\}$ ] into the intersection @xmath264 \\cap y[a+1 ] = \\cup_{(i , a+1 ) \\in e[a+1 ] } c_{x_i } ( |k_i| \\cap |k_{a+1}| ) $ ] .",
    "note that by the triple intersection property these cones are mutually disjoint and @xmath329 restricted to this intersection decomposes into a disjoint union of inclusions of points into cones , @xmath330 for each @xmath319 $ ] .",
    "hence , the induced mapping",
    "@xmath288 \\cap x[a+1 ] \\rightarrow m[a ] \\cap y[a+1]$ ] induces an isomorphism on homology .",
    "recall @xcite that , if @xmath331 and @xmath332 are cell complexes with intersection @xmath333 a cell subcomplex , the mayer - vietoris sequence is a long exact sequence relating the homologies of @xmath333 , @xmath331 , @xmath332 , and @xmath333 .",
    "moreover , if @xmath334 and @xmath335 are cell complexes with intersection @xmath336 a cell subcomplex and @xmath337 is a continuous mapping of topological spaces carrying @xmath331 to @xmath334 and @xmath332 to @xmath335 and so necessarily @xmath333 to @xmath336 , then there are associated mappings of the homology groups which are compatible with the mayer - vietoris sequences of @xmath338 and @xmath339 .",
    "applied to the union @xmath313 = g'[a ] \\cup x[a+1]$ ] mapping compatibly by @xmath329 to the union @xmath317 = m[a ] \\cup y[a+1]$ ] , one obtains the following commutative diagram with rows long exact @xcite sequences on homology with field coefficients @xmath113 :    by the above discussion and inductive assumption , all the vertical arrows are isomorphims except possibly for the middle mapping @xmath340 ' ) \\rightarrow h_\\star(m[a+1])$ ] . therefore , by the standard 5-lemma @xcite , one concludes that this mapping is also an isomorphism , thereby completing the induction step and the proof of lemma  [ lemmatech ] .",
    "our goal is to deduce lemma  [ lem : count - slices ] from lemma  [ lemmatech ] .",
    "the high - level idea is the following : consider the set @xmath134 and cut it by all the slices @xmath133 into smaller subcells . now",
    "examine the intersection graph of these subcells and observe that ( a )  the number of non - disconnecting slices is related to the number of `` independent cycles '' in this graph ( see precise definitions below ) and ( b )  by lemma  [ lemmatech ] , the latter number is upper - bounded by the number of handles in @xmath134 , which in turn can be estimated based on the fact that @xmath90 has degree @xmath79 .",
    "unfortunately , there are some technical obstacles along this route .",
    "we will mention only two : ( i )  lemma  [ lemmatech ] is formulated for simplicial complexes , in particular for compact spaces , while @xmath134 is open and unbounded .",
    "( ii )  one has to be careful in how one defines the intersection graph . the easiest way to define the subcells produces open , disjoint subcells , so no intersections are present .",
    "encoding interactions of subcells along the slices that were used to separate them produces a more natural intersection graph , but allows multiple edges and self - loops , which are not permitted in lemma  [ lemmatech ] .",
    "we start by observing that our input triangles occupy some bounded region of space , so we can perform all of our reasoning in a sufficiently large bounding box  @xmath332 that fully contains all the triangles in its interior , in order to avoid dealing with unbounded sets ( alternatively , we could add some points to @xmath5 to compactify it ) .",
    "secondly , we replace @xmath81 , which is a two - dimensional algebraic variety , with a `` thickened '' version @xmath341 .",
    "it is well known that , for a sufficiently small @xmath207 , @xmath342 is an arbitrarily good approximation of @xmath81 , within @xmath332 .",
    "so we replace @xmath343 by @xmath344 , which is a compact semi - algebraic set and can be triangulated and represented by a simplicial complex that is a subcomplex of a suitable triangulation of @xmath332 .",
    "we now redefine the _ slices _",
    "@xmath133 , as the faces of @xmath345 fully contained in the relative interior of @xmath8 , for any @xmath36 .",
    "refine our triangulation of @xmath332 so that each slice appears in it as a subcomplex .",
    "our goal is to apply lemma  [ lemmatech ] along the following lines : let @xmath243 be the complex corresponding to @xmath344 .",
    "cut it into pieces by the slices and let the subcomplexes @xmath210 be ( the closures of ) the resulting pieces",
    ". we will need to work a little harder for the lemma to be applicable , as it requires that ( a )  the pieces be closed and connected , ( b )  they must not intersect in triples , and ( c )  the resulting intersection graph must be simple .    to achieve this , we make some further technical modifications .",
    "they can be achieved by a formal transformation of the complex representing @xmath344 , but are easier to visualize if described purely geometrically .",
    "replace each triangle @xmath346 by a `` puffy triangle '' @xmath9 : an object that can be visualized as an arbitrarily thin pillow , which shares vertices and edges with @xmath8 , but has two bounding surfaces : one on top and one on the bottom ( to realize this as a simplicial complex , we may need to take a baricentric subdivision ; we omit the standard details ) .",
    "the effect of replacing @xmath8 by @xmath9 locally is that each feature that intersected @xmath8 away from its relative boundary is now duplicated : there is a `` top '' and a `` bottom '' version of it .",
    "similarly , now each slice @xmath138 is transformed into a `` puffy slice '' @xmath347 which has a top face @xmath348 and a bottom one @xmath349 and some ( arbitrarily thin ) volume in between .",
    "we need another technicality : for reasons we will describe shortly , we cut every single `` puffy '' slice @xmath347 into two , by replacing it with two thinner `` puffy '' slices , @xmath350 ( top ) and @xmath351 ( bottom ) , separated by a two - dimensional membrane that is the original @xmath138 . to summarize , @xmath352 is a three - dimensional `` sandwich '' of two subcomplexes : @xmath350 delimited by @xmath138 on the bottom and @xmath348 on the top , and @xmath351  with @xmath349 on the bottom and @xmath138 on the top .",
    "now let @xmath353 be the connected components ( `` chunks '' ) of the closure of @xmath354 .",
    "consider the subcomplexes corresponding to @xmath355 .",
    "their union is the complex corresponding to @xmath344 .",
    "now we are ready to invoke lemma  [ lemmatech ] .",
    "each chunk is connected by definition .",
    "each half - a - thickened slice is as well ( it is a thickened version of a face of @xmath345 for some @xmath346 ) . the graph @xmath213 is defined as the intersection graph of sets @xmath356 , @xmath357 , and @xmath358 . by construction ,",
    "the bottom of @xmath357 touches only the top of @xmath359 ( along  @xmath360 ) , the top of @xmath357 is shared with some chunk  @xmath361 .",
    "similar reasoning applies to the bottom parts  @xmath358 of the slice `` sandwiches .",
    "'' chunks , by definition , only intersect top faces of top slices , or bottom faces of bottom slices .",
    "the graph is in fact tri - partite : objects from the same class do not intersect .",
    "hence the only danger of a triple intersection is one where a chunk , a top slice , and a bottom slice intersect . but",
    "a top and a bottom slice only intersect if they are part of a `` sandwich '' and their intersection is an original slice that is disjoint from any chunk ( as it is contained in the interior of a puffy triangle ) .",
    "to summarize , lemma  [ lemmatech ] is applicable now : the simplicial complex representing @xmath344 can be written as a union of connected subcomplexes representing the sets @xmath356 , @xmath357 , and @xmath358 , and the triple intersections are empty .",
    "the intersection graph @xmath213 is a proper simple graph , without multiple edges or self - loops ( we introduced a separate complex for each slice in order to eliminate self - loops , and had to replace each slice by a sandwich of two thinner slices to eliminate multiple edges in @xmath213 ) .",
    "as already mentioned , @xmath342 approximates @xmath81 well for @xmath207 sufficiently small , so in particular @xmath364 , which in turn is @xmath82 , by the following fact , which is a special instance of the much more general bound of basu et al .",
    "* theorem  1 ) .      therefore @xmath365 .",
    "this quantity is sometimes called the _ cyclomatic number _ of the graph @xmath213 ; it is the dimension of the vector space with coefficients in @xmath366 formed by sets of edges of @xmath213 representing formal sums of cycles ( or subgraphs of even degree , which is the same ) . in a sense",
    ", it is the number of `` independent cycles '' in @xmath213 , which we can compute in the following way : let @xmath367 be the number of connected components in @xmath213 ( it corresponds to the number of connected components of @xmath344 and therefore of @xmath343 ) , @xmath368 be the number of edges of @xmath213 and @xmath369 be the number of its vertices . then @xmath370 . indeed , construct a spanning forest @xmath113 of @xmath213 , it will have @xmath371 edges .",
    "intuitively , every additional edge in  @xmath213 ( and there are @xmath372 of them ) forms an independent cycle in  @xmath213 .",
    "the above argument is independent of the choice of the forest @xmath113 .",
    "we will constrain it , as follows : notice that each half - sandwich object @xmath350 , @xmath351 has degree two in @xmath213 , with one edge connecting it to the adjacent chunk and one to its twin half - sandwich object ; the latter corresponds to an adjacency across an original slice  @xmath138 .",
    "there always exists a spanning forest @xmath113 that includes _ all _ edges of the former type ( such edges form an imperfect matching and one can complete it to a spanning forest ) .",
    "we will now explain why @xmath373 a quantity relevant to us .",
    "order the edges of @xmath213 in the following manner : first the edges of @xmath374 and then the edges of @xmath113 .",
    "every edge corresponds to an intersection along ( a copy of ) a slice .",
    "imagine `` deconstructing '' @xmath344 , incrementally , one edge of @xmath213 at a time , in the order given above , by removing the adjacency corresponding to that edge ( or , equivalently , cutting along the corresponding copy of a slice ) .",
    "it is easy to check that the edges not in @xmath113 correspond exactly to non - disconnecting slices : the number of connected components of the graph remains the same , as the spanning forest is undisturbed .",
    "once only forest edges remain , every edge removal leads to a disconnecting cut ( note that some of these correspond to adjacencies along a real slice @xmath138 and some along its shifted copies @xmath348 and @xmath349 , but as we do not intend to count either type , this does not affect our analysis ) ."
  ],
  "abstract_text": [
    "<S> given @xmath0 non - vertical pairwise disjoint triangles in 3-space , their vertical depth ( above / below ) relation may contain cycles . we show that , for any @xmath1 , the triangles can be cut into @xmath2 pieces , where each piece is a connected semi - algebraic set whose description complexity depends only on the choice of @xmath3 , such that the depth relation among these pieces is now a proper partial order . </S>",
    "<S> this bound is nearly tight in the worst case . </S>",
    "<S> we are not aware of any previous study of this problem with a subquadratic bound on the number of pieces . </S>",
    "<S> this work extends the recent study by two of the authors on eliminating depth cycles among lines in 3-space . </S>",
    "<S> our approach is again algebraic , and makes use of a recent variant of the polynomial partitioning technique , due to guth , which leads to a recursive procedure for cutting the triangles . </S>",
    "<S> in contrast to the case of lines , our analysis here is considerably more involved , due to the two - dimensional nature of the objects being cut , so additional tools , from topology and algebra , need to be brought to bear .    </S>",
    "<S> our result essentially settles a 35-year - old open problem in computational geometry , motivated by hidden - surface removal in computer graphics .    </S>",
    "<S> = 1 </S>"
  ]
}