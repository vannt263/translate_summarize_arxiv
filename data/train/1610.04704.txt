{
  "article_text": [
    "new scientific challenges will become achievable thanks to the future 30 - 40 m class telescopes such as the eso european extremely large telescope ( e - elt ) @xcite .",
    "in particular , it will be possible to track properties of first galaxies at high red - shifts @xcite .",
    "such distant objects are smaller than the seeing disk , and so faint that they may require hours of integration time",
    ". they must be observable by integral field spectroscopy and statistics on these objects will be provided by a large multiplex system .",
    "such a statistical analysis requires the observation of the greatest possible number of galaxies distributed over a very large field of view ( fov ) .",
    "thanks to the large light - collecting power of the e - elt combined with an adaptive optics ( ao ) system having high sky coverage , such observations will be feasible .    to perform the multi - object correction ,",
    "an ao concept has been proposed @xcite  : multi - object adaptive optics ( moao ) .",
    "a moao system is composed of individual optical trains that split the fov into different scientific directions .",
    "each of these optical trains includes a single deformable mirror ( dm ) which corrects the turbulence over the small sub - field ( of the order of an arc - second ) encircling the galaxy .",
    "in addition in moao , objects to be observed are too faint to provide the number of photons required to measure the wave front ( wf ) .",
    "the wf sensing is thus achieved thanks to other natural guide stars  ( ngs ) within the field and laser guide stars  ( lgs ) .",
    "unfortunately , the turbulence measured by wf sensors ( wfs ) decorrelates with angular distance because of the anisoplanatism effect @xcite .",
    "the mitigation of this effect requires a tomographic approach  : the dms are driven from a combination of the off - axis wf measurements taking into account their angular correlation . using several ngs and lgs in the fov , moao estimates the wave - front in the scientific directions by a tomographic reconstruction to mitigate the anisoplanatism effect .",
    "eagle  @xcite is a moao - assisted multi - object spectrograph  ( mos ) , that has been proposed for the e - elt for the statistical study of the formation process of distant galaxies .",
    "the concept of eagle is to cover a 7 arc - minutes diameter fov and features 20 moao spectroscopic channels , working in parallel , and delivering a corrected wave - front for achieving an ensquared energy ( ee ) greater than 30  % in a resolution element of 75 mas .",
    "the ao study @xcite has demonstrated that the tomographic reconstruction must be based on a minimum of six lgs wfs and four to five ngs wfs in order to be able to reach the correction performance and the sky coverage requirement .",
    "today , a new multi - object spectrograph , mosaic , possibly equipped with moao , is entering in phase a study for the e - elt  @xcite .    to demonstrate the technical feasibility of moao sky observations , the pathfinder canary  @xcite has been developed by an international consortium .",
    "it began in 2007 , with first light in 2010 at the william herschel telescope  ( wht ) on la palma , in the canary islands ( spain )  @xcite .",
    "canary is also a platform where innovative techniques and algorithms can be tested on - sky for ao control techniques @xcite and shack - hartmann  ( sh ) centroiding @xcite for instance .    in this paper",
    ", we present the analysis of on - sky results acquired by canary in 2013 .",
    "we first describe the moao control and tomographic reconstruction with lgs in sect .",
    "[ s : phaseb ] , as used with canary .",
    "in particular , we discuss the implementation of the mixed ngs / lgs tomographic reconstruction .    in sect .",
    "[ s : tomoerror ] , we introduce the tomographic error in lgs moao and describe how its evaluation is achieved for canary . in sect .",
    "[ s3 ] , we present an analytic lgs moao error breakdown and describe how each term is derived . the variance of the residual phase taken in summing all terms , assumed to be independent , is compared to what we estimate from the truth sensor  ( ts ) .",
    "we show in sect .",
    "[ s4 ] the two methods lead to the same evaluation of the residual phase , with a 99  % correlation over a large set of 4,500 on - sky datasets .",
    "we also present an overview of the on - sky canary performance in single conjugate ao ( scao ) , moao , and open - loop ground layer ao ( glao ) .",
    "finally in sect .",
    "[ s5 ] , we focus on particular results acquired by canary running successively in scao , moao and glao modes . using tools introduced in sect .  [ s3 ] , we evaluate the canary error breakdown in these modes and analyze the improvement achieved using lgs / ngs tomography .",
    "we conclude in sect .",
    "the canary pathfinder is deployed on one of the nasmyth focii of the 4.2 m wht .",
    "the project has been planned with several phases of increasing system complexity @xcite to lead to a comprehensive demonstration of the moao configuration as foreseen for eagle on the e - elt  @xcite .",
    "the canary optical design during phase b @xcite includes up to eight sh wfs of 36 valid sub - apertures each ( @xmath0 ) , three being off - axis ngs wfs , four being off - axis rayleigh lgs wfs and one being an on - axis ngs wfs .",
    "they are installed behind an optical de - rotator ( k mirror ) placed at the entrance of the bench to compensate for the field rotation at the nasmyth focus .",
    "the three off - axis ngs wfs are installed on a target acquisition system  ( tas ) in the telescope focal plane which allows us to point at directions anywhere within a fov of @xmath1 diameter .",
    "the four rayleigh lgs wfs have a selectable range gate ( to tune the guide star height and depth ) , set to 21  km for the data presented in this paper , and are optically combined on a unique electronically time - gated ccd @xcite .",
    "the on - axis ts measures the wf corrected by the dm and tip - tilt  ( tt ) mirror for calibration procedures and for performance diagnostics .",
    "a dichroic plate splits the corrected wf beam into a visible part ( 400 - 900  nm ) for the ts and an infra - red part ( 900 - 2500  nm ) for an infra - red imaging camera , called camicaz , equipped with a nicmos detector and a filter wheel delivering j , h and k - band images @xcite .",
    "all the wfs cameras are triggered with a master clock derived from a sub - frequency of the laser pulses , leading to synchronous wfs measurements sampled at 150  hz for all cameras .",
    "the real - time computer ( rtc )  darc @xcite acquires synchronously the wfs data and provides the user with time series of wave - front slopes and dm and tt commands .",
    "c p6.cm * quantity * & * signification *    ' '' ''     + & + @xmath2 & temporal average of vector @xmath3 + @xmath4 & trace of the matrix @xmath3 + @xmath5 & @xmath6 identity matrix + @xmath7_{{\\text{n}_{\\text{s}}}}}$ ] & @xmath6 matrix full with 1",
    ". + @xmath8_{{\\text{n}_{\\text{s}}}}}$ ] & @xmath6 matrix full with 0 .",
    "+ @xmath9 & @xmath10 norm of vector @xmath3 + @xmath11 & tomographic reconstructor + @xmath12 & vector concatenating slopes measured by off - axis wfss + @xmath13 & vector concatenating slopes measured by on - axis wfs + @xmath14 & calibrated reconstruction matrix slopes to zernike + @xmath15 & number of measured slopes by a single wfs , @xmath16 in this paper + @xmath17 & number of acquired frames + @xmath18 & number of discrete turbulent layers + @xmath19 & number of wfs , @xmath20 in this paper + @xmath21 & number of ngs only wfs , @xmath22 in this paper + @xmath23 & number of lgs only wfs , @xmath24 in this paper +    [ t:1 ]    the rtc provides for each wfs a vector @xmath25 of @xmath15  ( see table  [ t:1 ] ) slopes  ( @xmath26 ) every wfs frame .",
    "the set of local wf slopes along x and y directions , measured by the @xmath27 wfs with @xmath28 sub - apertures , is collected into a global slope vector @xmath25  : @xmath29 where @xmath30 is the vector of the reference slopes , previously calibrated in the laboratory @xcite . to remove tip - tilt signal from lgs measurements ,",
    "we subtract the average slopes on both the x and y axis  : @xmath31 where @xmath5 is the identity matrix of size @xmath15 and @xmath32 is defined as  : @xmath33_{{\\text{n}_{\\text{s}}}/2 } } & { [ \\mathbf{0}]_{{\\text{n}_{\\text{s}}}/2}}\\\\ { [ \\mathbf{0}]_{{\\text{n}_{\\text{s}}}/2 } } & { [ \\mathbf{1}]_{{\\text{n}_{\\text{s}}}/2}}\\\\      \\end{bmatrix},\\ ] ] where @xmath7_{{\\text{n}_{\\text{s}}}/2}}$ ] and @xmath8_{{\\text{n}_{\\text{s}}}/2}}$ ] are squared matrices of size @xmath28 filled respectively with ones and zeros  ( see table  [ t:1 ] ) .",
    "we denote @xmath12 as the array resulting from the concatenation of slope measurements in the off - axis directions . this therefore includes the slopes coming from 4 lgs and 3 ngs , and is of size @xmath34 .",
    "likewise , we denote @xmath13 as the array of size @xmath35 that concatenates the ts measurements on the on - axis source .",
    "we have  : @xmath36 @xmath37 where the @xmath38 and @xmath39 are acquired according to eq .",
    "[ e : sp ] , while @xmath40 comes from eq .",
    "[ e : slgsi ] .",
    "in all the following , @xmath12 and @xmath13 will be wfs slopes measured with a disengaged loop , which are measurements of uncompensated phase .    we define @xmath41 as the ts measurements acquired when loop is engaged .",
    "this represents a measurement of the residual phase .",
    "each time series of @xmath42 gathers ts slopes following eq .",
    "[ e : sp ] .",
    "canary has a ground layer compensation mode  ( glao mode ) with open - loop correction .",
    "it is comparable to the moao mode , except the reconstructor is simplified .",
    "the glao reconstructor averages the wfs signals , ignoring the tip and tilt from the lasers . it is computed as a sum of a tip - tilt  ( tt ) reconstructor @xmath43 that averages the slopes on ngs wfs only , and a high order reconstructor @xmath44 that filters out the tip - tilt on all measurements and averages the slopes .",
    "mathematically we have  : @xmath45 where @xmath43 is the @xmath46  : @xmath47 } \\hspace{.1 cm } \\cdots { \\left[{\\mathbf{i}_{{\\text{n}_{\\text{s}}}}}-\\mathbf{f}\\right]}\\right]}_{{\\text{n}_{\\text{wfs } } } } , \\ ] ] and @xmath43 the matrix averaging the slopes on ngs wfs only is designated as  : @xmath48_{{\\text{n}_{\\text{s } } } } } \\hspace{.1 cm } \\cdots { [ \\mathbf{0}]_{{\\text{n}_{\\text{s}}}}}}_{{\\text{n}_{\\text{lgs } } } } ,   \\underbrace{\\mathbf{f } _ { } \\hspace{.1 cm } \\cdots \\mathbf{f}_{}}_{{\\text{n}_{\\text{ngs } } } } \\right]\\ ] ] calibration of references slopes , dm offsets , interaction and command matrices are described by @xcite .      the on - axis phase is determined by minimizing the distance between the on - axis measurements and the linear combination of off - axis measurements propagated through the reconstructor @xmath11  : @xmath49 where @xmath50 denotes the temporal average over a time series .",
    "ensuring @xmath51 with @xmath12 and @xmath13 assumed to be gaussian stochastic processes , we get  : @xmath52 with @xmath53 the @xmath46 spatial cross - covariance matrix between on / off measurements , while @xmath54 denotes the @xmath55 off - axis wfs spatial covariance matrix .",
    "they are defined by  : @xmath56 we note that the matrix @xmath57 in eq .  [ e2 ] is the generalized inverse of the covariance matrix @xmath54 .",
    "laser guide stars  ( lgs ) wfs do not properly measure the pupil average slope ( the overall angle of arrival ) , and we have explained that we subtract this from their measurements , as stated by eq .  [",
    "e : slgsi ] .",
    "the same filtering operation on the lasers needs to be taken into account in the tomographic reconstructor in order to get rid of undetermined modes .",
    "we use a global approach ( as opposed to techniques known as split tomography @xcite where the reconstruction is performed independently for lgs and ngs ) .    before applying eq .",
    "[ e2 ] , we rework the covariance matrix @xmath54 and apply on each of its blocks @xmath58_{pp'}$ ] between two wave - front sensors @xmath59 and @xmath60 the following filtering operation : @xmath61_{pp ' } \\ , a'\\ ] ] where @xmath62 when @xmath59 is a ngs wave - front sensor , and @xmath63 in the case of a lgs wave - front sensor ( and similarly for @xmath64 and @xmath60 ) . after filtering , the covariance matrix @xmath54 should be understood as the covariance of measurements excluding the undetermined modes .    as a comparison with other studies addressing the same problem",
    ", we find it interesting here to point out the method used by @xcite , who modifies the diagonal wave - front sensor blocks of the covariance matrix using @xmath65_{pp } + b\\ ] ] with b the covariance matrix of undetermined modes measurements for a given lgs wave - front sensor @xmath59 .",
    "this is equivalent to adding noise to the measured undetermined modes , which will automatically result in their filtering by the inversion process .",
    "the inversion process is interesting and can be compared between the two methods . in the case of tallon",
    ", the addition does not modify the rank of @xmath54 , while in our case filtering two degrees of freedom ( tip and tilt ) for each of our four lgs wfs creates eight null eigenvalues ( associated to eight eigenmodes that span the subspace of our filtered modes ) . therefore our matrix can not be inverted directly .",
    "instead , we perform a singular value decomposition ( svd ) ( which reduces to a diagonalization in this particular case of a square , symmetric , positive definite matrix ) , invert all non - zero eigenvalues , and set the inverse of null ones to zero .",
    "this is how the average slope of lgs wave - front gets filtered out in our case .",
    "we believe this approach is equivalent to tallon s approach with the coefficients of matrix @xmath66 tending towards infinity .    we have chosen this method because the coefficients on b would have been difficult to adjust experimentally .",
    "the positioning of our lgs suffers from drifts , possibly from rotations of the asterism , that translate into long - term drifts of the average slopes that are quite empirical to turn into a covariance noise .",
    "for this reason , we prefer to completely eliminate of those modes .",
    "in addition , we should mention that , in any case , the large dispersion of the eigenvalues of @xmath54 ( even before filtering of tilt ) makes a direct inversion numerically risky , and that is it preferable to filter out the weakest eigenmodes , instead of attempting to take the inverse of their eigenvalues .",
    "this still requires an svd .",
    "the matrix @xmath53 can not be determined on - sky when observing because the lack of photons forbids the use a ts in the scientific directions .",
    "in addition , empirical covariance matrices suffer from statistical convergence errors @xcite that make the tomographic reconstructor too specific to the particular time series from which it has been computed .    for these reasons ,",
    "we fit the on - sky measured @xmath54 to a model of this matrix detailed in appendix .",
    "it provides analytic values of @xmath53 and @xmath54 from a list of parameters  :    * @xmath18  : number of discrete layers , set ad hoc . *",
    "@xmath67  : altitude of layers * @xmath68  : strength of layers * @xmath69  : outer scale of layers * telescope tracking error and vibration  : adding of an isoplanatic tip - tilt over all ngs wfs * wfs angular positions  : they are sufficiently well known using encoders information from the target acquisition system * system mis - registration  ( pupil shifts , rotation and magnification )  : well calibrated on bench * centroid gain variations * noise slope variance for each wfs , separately identified on the @xmath12 time series by computing its temporal autocorrelation .    in the previous list ,",
    "only the altitude , strength and outer scale of layers are retrieved , along with the tracking error .",
    "other parameters are either set ad hoc or assumed to be known well enough .",
    "the retrieval of these parameters is ensured thanks to the learn&apply algorithm  @xcite .",
    "it is a least - square minimization of the distance between the empiric covariance and our model of that .",
    "the algorithm operates iteratively using a levenberg - marquardt method . for determining the turbulent profile on an engaged set of data , we estimate the disengaged ts measurements , @xmath13 from the measured ones @xmath41  ( see appendix  [ b:1 ] ) .",
    "we thus have an additional wfs , centred on - axis , that allows us to increase the maximum field of view covered by tomography .",
    "previously we have used a model @xcite based on a fourier transformation of the von - krmn spectrum to get the bi - dimensional ( 2d ) spatial covariance of the wave - front slopes .",
    "this algorithm was particularly efficient when coupled to wave - front sensors with fixed sub - aperture sizes , because the computation using fast fourier transforms ( fft ) could be used to extract all covariance values from the same 2d map between two wave - front sensors with arbitrary separation , without requiring any interpolation of the map and provided the sub - aperture size being a multiple of the fft sampling .",
    "however , the cone effect inherent to lgs induces layer - projected sub - aperture sizes and pupil sizes that vary with altitude , which breaks the efficiency of the implementation when it s a matter of computing covariances between lgs and ngs .",
    "an interpolation procedure could be implemented in order to access values that lay between covariance samples of the fft , but unfortunately this kind of approximation does not go integrate with a fitting procedure that internally requires the computation of derivatives as finite differences of the covariance function . for this reason , we have developed a new analytic way to compute the covariances as it is presented in appendix  [ a:1 ] .",
    "this method allows us to get each coefficient of the matrix independently , which is a great advantage for faster computation for parallel implementation @xcite .",
    "tomographic reconstruction introduces a tomographic error when compared to single conjugate ao , to be included in the moao residual phase variance .",
    "in addition , the calibrated reconstructor , applied on a given data set on - sky , is usually different from the mmse one given by eq .",
    "[ e2 ] , because the turbulence may evolve between the calibration time and the acquisition time .",
    "moreover , the identification of the model parameters assumes the turbulence is composed by a few discrete layers , which introduces additional errors .",
    "we define @xmath70 as the error between the on - axis measurement and its tomographic reconstruction from the off - axis measurements  : @xmath71 with @xmath11 the on - sky tomographic reconstructor .",
    "the tomographic error can be derived by computing the trace of the error covariance matrix @xmath72  : @xmath73 by replacing @xmath74 in eq .",
    "[ e : cee ] by its expression given in eq .",
    "[ e ] , the covariance matrix @xmath72 can be split into four terms as follows  : @xmath75 where @xmath76 is the @xmath77 spatial covariance matrix for the on - axis direction  : @xmath78 in eq .",
    "[ e : covmat ] , we define @xmath53 and @xmath54 .",
    "we see in eq .",
    "[ e : cee2 ] that the reduction of the tomographic error is given by the two terms involving the covariance matrix @xmath53 between the on - axis and the off - axis measurements .",
    "if the correlation is very low between these measurements , in the case of strong anisoplanatism , the on - axis error is not reduced by these two terms but instead increased by the term @xmath79 : the tomographic reconstruction should be avoided .",
    "this may appear when considering the highest altitude turbulence layers .",
    "on the contrary , for low altitude layers , wfs measurements are strongly correlated and we are able to significantly reduce the on - axis wf variance by the tomographic reconstruction .    for the purpose of the wf error breakdown analysis in this paper",
    ", we will reconstruct the slopes on the zernike basis .",
    "for canary , we consider a reconstruction of the polynomials 2 to 36 @xcite .",
    "we denote @xmath14 the corresponding reconstruction matrix .",
    "the wf error is then defined by the quadratic sum of the zernike coefficients .",
    "we get the wf error @xmath80 , denoted as the raw tomographic error , from the trace of the zernike coefficient covariance matrix given by  : @xmath81      in eq .",
    "[ e : cee2 ] , we compute the raw tomographic error covariance matrix which may include a number of error terms like noise , aliasing and tomography . in this section , we will focus on the two spatial error terms related to the turbulence : the first linked to the low spatial frequencies of the turbulence well measured by the wfs and well compensated by the dm and the second linked to the high frequencies aliased in the measurements because of the spatial sampling by the wfs .",
    "a detailed analysis of aliasing in tomography can be found in  @xcite . to build the error breakdown ,",
    "we want to separate the aliasing error from the tomographic one . for that purpose ,",
    "we compute the aliasing error covariance matrix as  : @xmath82 where the covariance matrices , @xmath83 , @xmath84 and @xmath85 , are derived by filtering in the turbulence spectrum all the low spatial frequencies below the dm cut - off frequency @xmath86 with @xmath87 the dm actuators pitch , as described in appendix  [ a:2 ] . in eq .",
    "[ e : c - alias ] , the first term is related to the wfs placed on axis , the ts for canary .",
    "the fourth term is the error due to the aliasing of the off - axis wfs propagated through the tomographic reconstruction .",
    "the two other terms are the correlation between the aliasing in the ts and in the off - axis wfs .",
    "this correlation is only significant for the ground layer where the same turbulence is sampled and measured by all the wfs .",
    "hence these two terms reduce the aliasing error in the measurement of the ts .",
    "we will make use of eq .",
    "[ e : c - alias ] to derive the aliasing contributors in the error breakdown established in the next section .",
    "we now derive the tomographic error subtracted by the aliasing error .",
    "we define the tomographic error covariance matrix expressed for the low spatial frequencies of the turbulence ( the wf low orders controlled by the dm ) as : @xmath88 and using eqs .",
    "[ e : cee2 ] and  [ e : c - alias ] , we find : @xmath89 all these new covariance matrices @xmath90 are deduced from the subtraction of the slope covariance matrices , defined in section  [ ss : rawtomo ] and computed as presented in appendix  [ a:1 ] , by the aliasing covariance matrices @xmath91 defined above .",
    "hence @xmath92 can be fully computed from the identified model of atmosphere , as presented in section  [ ident ] , here excluding the noise contributions .",
    "using eq .",
    "[ e : sigmatomoraw ] , we find the tomographic error of interest  : @xmath93    to further describe the tomographic error decomposition , @xcite has introduced the ved - for vertical error distribution - as the decomposition of the wf tomographic error with altitude .",
    "thanks to the statistical independence of the turbulent layers , the total tomographic error is the sum of the tomographic error on each turbulent layer at altitude @xmath94  : @xmath95 such a decomposition allows us to identify which altitude layer contributes mostly to the tomographic error , and gives us the ability to quantify the robustness of reconstructor to profile variability @xcite .",
    "the design of future ao - assisted mos for elts will require detailed numerical simulations of ao systems with a very large number of degrees of freedom . to prepare those simulations ,",
    "it is necessary to validate the current modelling of the moao systems and therefore to build an accurate wf error breakdown .",
    "canary provides two sources of performance diagnostics : the residual phase as measured by the ts and the sky point spread function ( psf ) as delivered by the imaging camera camicaz .",
    "we propose two methods to evaluate the wf variance @xmath96 as observed by the science camera .",
    "the first one as the independent terms  ( it ) method gives @xmath96 from canary telemetry data by splitting the residual phase into a sum of terms assumed to be uncorrelated .",
    "we compare the it approach with the ts method , as the direct evaluation of @xmath96 based on the ts measurements .",
    "our goal is then to compare the two methods on a large number of data sets acquired on - sky by canary and to demonstrate that each of them leads to a very close evaluation of @xmath96 .",
    "the it method consists of splitting the residual phase variance @xmath97 in a sum of error terms assumed to be statistically independent and coming from the ao system performance known limitations  : @xmath98 where  :    * @xmath99 is the tomographic error on the wf low orders compensated by the system * @xmath100 is the aliasing error from the off - axis wfs propagated through @xmath11 * @xmath101 is the noise error from the off - axis wfs propagated through @xmath11 and the moao loop * @xmath102 is the temporal error due to the system transfer function including all delay * @xmath103 is the uncorrected high order error * @xmath104 is the go - to error of the dm * @xmath105 is the on - axis uncontrolled and uncalibrated static , or quasi - static error * @xmath106 is the non common path aberrations  ( ncpa ) residuals    each of those variances involved in eq .  [",
    "e : dti ] are mostly computed using analytical equations , listed in the following subsections , depending on parameters deduced from the calibration data and the rtc telemetry data , which are @xmath107 and @xmath108 when the loop is engaged .",
    "the tomographic error is the error on the wf low orders compensated by the system , linked to the tomographic process , the used reconstructor @xmath11 and the @xmath109 profile encountered during the observation .",
    "this error @xmath99 is given by eq .",
    "[ e : tomoir ] .",
    "the interest of our approach is to evaluate it without limiting statistic convergence effects specific to the particular acquired time series involved .",
    "compared to @xcite , the ts measurement is no longer required .",
    "it is only needed to compute the error covariance matrix for the low order modes , @xmath92 , from the identified model of the atmosphere free from any noise and aliasing contribution  ( see sect .",
    "[ ss : aliastomo ] ) .",
    "to evaluate the aliasing term , we only need to consider the off - axis aliasing error propagation through the reconstructor on the wf observed by the ir camera . from eq .",
    "[ e : c - alias ] , we can extract this term , i.e. @xmath110 . the aliasing error variance is then given by  : @xmath111    the off - axis aliasing is also time - filtered by the system , which is filtering out the high temporal frequencies .",
    "it is reasonable , for a first approximation , to neglect the impact of the filtering on the aliasing error variance , which means to neglect the temporal high frequencies from the aliasing with regards to the others terms of the error breakdown .      as the aliasing ,",
    "the noise in the residual wf error is due to the noise of the off - axis wfs propagated through the reconstructor @xmath11 and the system . considering the noise as a white process",
    ", the propagation through the loop can be readily taken into account .",
    "we denote @xmath112 as the variance noise contribution in the residual error variance .",
    "@xmath112 is derived by : @xmath113 with  : @xmath114 where @xmath115 is the loop gain and @xmath116 the system latency additional to the wfs exposure - time , assumed to be varying between 0 and 1 frame . from bench calibration , we get @xmath117 frame .    the noise covariance matrix @xmath118 is assumed to be diagonal since the lgs spots elongation is negligible on canary  @xcite . it is identified slope by slope computing the temporal autocorrelation on the slope time series .",
    "we extract the noise variance as a dirac value at null delay through a parabolic fit of the turbulence contribution .",
    "@xcite has proposed to base the calculation of the servo - lag error on a end - to - end approach , particularly to take into account a fractional system delay , but it does not include the propagation of the off - axis wfs measurements through the reconstructor @xmath11 .",
    "we start by modelling the time - filtering process of the moao loop using the correction transfer function @xmath119 derived by a z - transform  ( see appendix .",
    "[ b:1 ] )  : @xmath120 with @xmath121 where @xmath122 is the time frequency sampling .",
    "the digital filter @xmath119 operates on the temporal spectrum @xmath123 .",
    "we note @xmath124 the atmospheric off - axis modes filtered by the tomographic reconstructor and the moao loop .",
    "its temporal spectrum is derived by  : @xmath125 in eq .",
    "[ e : sigdeuxbw ] , @xmath126 includes a noise contribution from the off - axis wfs through the reconstructor and the correction transfer function @xmath127 . for de -",
    "noising the variance of @xmath124 , we subtract the variance of the off - axis noise , @xmath128 , multiplied by a coefficient which is the modulus of the moao correction transfer function , integrated along temporal frequencies .",
    "it has been computed by @xcite to be @xmath129  ( see .",
    "[ e : eta ] ) .",
    "the servo - lag wf error is then derived by integrating the modal spectrum over temporal frequencies domain and modes , until the @xmath130 one considered as the higher order to be correctable by the system .",
    "we have  : @xmath131    in eq .",
    "[ e : servolag ] we do not extract the contribution of the off - axis aliasing .",
    "this term comes from the vector @xmath132 and is propagated through the tomographic reconstructor and then through the moao correction transfer function .",
    "this later behaves as a high - pass filter .",
    "it means we neglect the contribution from the high temporal frequencies of the aliasing . for a taylor - like turbulence",
    ", these frequencies are related to high spatial frequencies .",
    "considering the turbulence spatial psd is falling as @xmath133 , the high temporal frequency contribution of the aliasing we get in eq .",
    "[ e : servolag ] is negligible when compared to the parallel modes .      from end - to - end simulations ,",
    "@xcite has established for the dm of canary the fitting error expression versus the dm actuators pitch @xmath87 and the fried s parameter @xmath134  : @xmath135      go - to errors are produced because of the open - loop control of dms .",
    "generally , the dm behaviour is modelled using an interaction matrix .",
    "many ways exist to perform this calibration , and this has been investigated for the canary case  ( @xcite ) . in closed - loop ao systems ,",
    "the dn mis - registration or inaccuracies in the interaction matrix calibration are compensated iteratively by the ao loop , thanks to the feedback between wfs and dm . however",
    ", this is not the case for open - loop systems such as canary .",
    "we therefore have an additional wf error @xmath104 that contributes to the residual phase variance . in @xcite ,",
    "this go - to error is derived as a function of the commanded wf for several methods of computation of the interaction matrix .    in the canary case ,",
    "this matrix has been computed using a sinusoidal method and , from results of @xcite , we propose to define the go - to error in taking 5  % of the dm command .",
    "we have thus  : @xmath136 this error is very small compared to the other error terms as we will see in sect .",
    "[ s5 ] .",
    "differential quasi static aberrations may appear during an observation . a main reason is the optical beams to the wave - front sensors and to the ir camera do not exactly cross the same areas of the optical surfaces of , both the telescope and the canary bench .",
    "they include the field aberrations of the telescope and of the canary de - rotator and the creeping effect .",
    "this later is a drifting of the dm shape with time  @xcite .    in order to mitigate the effects of static aberration error",
    ", we could use a model of the telescope field aberrations and de - rotator optical aberrations , as well as a figure sensor to monitor the dm shape ; however this approach was deemed too challenging to be applied in canary .",
    "instead , we perform on - sky a number of calibrations and related pre - compensations of these static aberrations for the different channels both before and during the observation .",
    "the procedure is given in  @xcite .",
    "nevertheless in canary , the calibration is not perfect and we are not able to update the static aberration compensation during the observation . hence we have to include , in the wf error breakdown , a static aberration error term @xmath105 .",
    "we evaluate post - facto this error by computing  : @xmath137      non - common path aberrations ( ncpa ) are calibrated in closed loop on the ts and the bench artificial sources using a phase diversity algorithm processing the ir camera images @xcite .",
    "the measured ncpa are then applied on the dm offset voltages during the whole duration of the observation as explained by @xcite .",
    "the ncpa calibration errors are mainly dominated to the high spatial frequencies of the dm surface quality not correctable by the dm .",
    "they lead to a 80% best strehl ratio ( sr ) as measured in the 1550 nm image at the end of the phase diversity procedure .",
    "this corresponds to an error of 115 nm rms .",
    "the empirical method consists in considering the ts as the primary source of information for determining the system performance .",
    "we denote @xmath138 the variance of the ts wf engaged measurements that includes both static and dynamic terms  : @xmath139    we expect the ts method to give an accurate performance estimation when compared to the science image , since only a dichroic plate separates the ts from the science path .",
    "the differences between the science wave - front and that measured by the ts are the ts noise , the ts aliasing , the fitting errors due to the wave - front high frequencies and ncpa residual errors .",
    "we want to estimate the variance of the science wave - front , and it can be written as  : @xmath140 where @xmath141 is the variance of the noise and @xmath142 the variance of the aliasing , in the ts measurements .",
    "the parameter @xmath141 is estimated using the noise covariance matrix @xmath143 , identified using the method based on the temporal autocorrelation of the time series of @xmath144 .",
    "then , the ts noise variance term is given by  : @xmath145    the aliasing included into the ts measurements is firstly given by the conventional term linked to @xmath146 and is partially correlated to the off - axis aliasing propagated through the tomographic reconstructor . as presented in section  [ ss : tomo ] , the ts aliasing variance term is given by  : @xmath147 in this expression , the correlated part of the aliasing due to the ground layer is directly taken into account without any additional computation , compared to the previous approach given in @xcite .",
    "error breakdown in scao has been investigated for over 20 years  ( see @xcite ) . in scao ,",
    "the ts is obviously available and it makes sense to estimate the residual phase variance using the ts measurements .",
    "we can directly use eq .  [",
    "e : dmts ] , but here not subtracting the term @xmath142 which has to be kept in @xmath138 .",
    "in addition , we want to have the same breakdown as in eq .",
    "[ e : dti ] , but specific to scao . in scao , we will not have tomographic , static aberrations and go - to errors .",
    "the residual phase variance can be expressed as follows in scao mode  : @xmath148 values of the fitting error @xmath103 and ncpa error @xmath106 are discussed respectively in sect .",
    "[ ss : fitting ] and  [ ss : ncpa ] .",
    "we compute the aliasing error term @xmath142 by projecting the covariance matrix of the aliasing in open - loop , derived from known turbulence parameters , onto the zernike basis  : @xmath149 in eq .",
    "[ e : aliasscao ] , we neglect the propagation of the aliasing through the closed loop and the cross - correlation with parallel modes as well . but once again , a posteriori over the large amount of scao data we have processed , this approximation is not critical .",
    "the noise error @xmath141 is retrieved by the temporal auto - correlation function of the ts measurements . to make this estimation more accurate",
    ", we handle the estimation of the ts slopes in loop disengaged , @xmath13 from the engaged ones @xmath144  ( see appendix  [ b:2 ] ) . the value of the noise we estimate",
    "is then multiplied by a propagation factor @xmath150  ( @xcite ) to take into account both the noise level at the sequence @xmath151 , and the one from the sequence @xmath152 that has been propagating through the loop to be measured again by the ts .    finally , the servo - lag error @xmath102 is derived identically to that in eq .",
    "[ e : servolag ]  : @xmath153 where @xmath154 is estimated from the ts measurements  : @xmath155 where @xmath156 is the correction transfer function given by @xcite for scao systems .",
    "sr is known to be related to the phase variance by the marchal approximation  : @xmath157 where @xmath158 is the wavelength of the science image and @xmath96 can be either @xmath97 or @xmath159 .",
    "such an approximation is valid for small variance  @xmath160 ) , or high sr greater than 10 - 20% .",
    "moao is not designed to get very high performance and the marchal approximation is not be accurate enough for our purposes .",
    "we propose to use the @xcite heuristic formula  : @xmath161 where @xmath162 and @xmath163 are the residual wf error on respectively the tip - tilt only and the higher orders  ( tip - tilt removed ) .",
    "contrary to the marchal approach , the sr estimated from eq .  [ e : sr ] includes two terms .",
    "the first one is the contribution of the central core of the partially ao - corrected psf but broadened by the residual tt variance , while the second one is the contribution of the psf broad halo .",
    "the parenti approximation , as we will see , gives a better estimation for sr lower than 30  % than the marchal one , which is exactly the range of performance we have encountered with canary .",
    "we now focus on the canary on - sky results acquired during the observing runs of phase b. our purpose is firstly to prove the feasibility of managing a mixed lgs plus ngs moao system , secondly to evaluate the contribution of the tomographic reconstruction in the final performance of canary .",
    "we have compared sr and error breakdown between several ao modes  : scao ( closed - loop on ts ) , ngs moao , ngs plus lgs moao , tt plus lgs moao and glao ( ground layer compensation only ) .",
    "we have simultaneously recorded system telemetry ( 2048 frames at 150 hz ) and h - band images .",
    "each science image is the sum of 15 individual exposures of one second , with no recentring in order to keep tip - tilt errors between individual exposures .",
    "+ during the phase b runs , we have mostly observed three different ngs asterisms , that are presented in table  [ t : ast ] .",
    "in addition to the ngs , we also made use of four rayleigh lgs .",
    "they are placed on a square asterism centred on - axis .",
    "each lgs is located at 22.6 \" off - axis from the ts position .",
    "the distance of lgs , as defined by the range gate on the lgs wfs , is 21  km , regardless of the airmass , for all nights .",
    "the gate width corresponds to a depth of 1.5  km in the atmosphere .",
    "the number of detected photons per lgs beacon is of the order of 300 photons by sub - aperture and by frame  @xcite .",
    "the resolution in turbulence layer altitude and the maximum distance vary between the data sets depending on the asterism . in",
    "the phase b configuration , the minimum altitude resolution was varying between 1 and 1.5  km , while the maximum distance ranged from 18 to 28  km .",
    "this maximum distance is unaffected by the lgs asterism because of the cone effect and their relatively low altitude , but mostly determined by the off - axis distance of the ngs .",
    ".description of main asterism observed in canary phase b. the columns indicate the canary asterism reference number , the separation ( in arc - seconds ) of each off - axis star to the central one and the v band magnitudes of each .",
    "see @xcite for asterism illustration . [",
    "cols=\"^,^,^,^\",options=\"header \" , ]     we present in fig.[f : stat ] all the retrieved layers on - sky giving for each point their altitude layers versus their local seeing at 500  nm .",
    "each sample is a result from the l&a algorithm applied on a single data set , over 4,500 sets acquired by canary in 2013 .",
    "this figure shows the distribution of the turbulence along the altitude as a probability density .",
    "it makes a strong ground layer appear , which is mainly concentrated in the first kilometer .",
    "there is a significant strength of the turbulence between 1 and 5  km .",
    "we also find a group of high altitude layers , around 12  km spreading over 4  km .",
    "a strong layer is observed around 16  km , then the strength of the turbulence decreases at higher altitudes .",
    "we present in fig .",
    "[ f : histo ] histogram of the seeing for the ground layer  ( altitude below 1  km ) , for the altitude layer and for the total atmosphere .",
    "the ground is defined by the sum of the contributions of the layers between 0 and 1  km .",
    "we get an altitude seeing that is relatively stable , around 0.21 `` median with a standard deviation of 0.09 '' , while at the ground , the median seeing reaches 0.59 `` with a much larger standard deviation of 0.34 '' .",
    "the median total seeing is 0.66 `` with a standard deviation of 0.33 '' .",
    "we conclude that the variation of seeing during our nights was mostly dominated by the variation of the ground layer strength .",
    "the seeing in altitude remains quite constant during the night while the ground evolves quickly and strongly .",
    "it changes the weights between altitude and ground layers in terms of strength .",
    "this introduces an additional error propagating through the moao reconstructor that can be mitigated only by updating this as often as possible .",
    "we note the glao reconstructor , that averages directly off - axis wfs measurements  ( see eqs .  [",
    "e : rglao ] to  [ e : rglaott ] ) , is not required to be updated .    above 20  km ,",
    "we are not able to identify the altitude layers properly . in fig .",
    "[ f : stat ] , we have gathered all layers retrieved above 20  km at this maximal altitude .",
    "we can determine that we have around 0.089 \" seeing in median above 20  km , that corresponds to 240  nm on a 4.2  m telescope .",
    "however , we observe very high altitude layers only 34% of the time in all the phase b observations .",
    "it means such processes , quite strong but rare , exist above the wht and directly impact the tomographic performance of canary .",
    "we report in fig .",
    "[ f : sr ] h - band image sr measured with canary running in scao , moao and glao .",
    "we notice on sr three different performance regimes  : globally scao performs better than moao that performs better than glao .",
    "[ f : sr ] makes a large scattering of results in any modes appear .",
    "in scao , this scattering involves mainly the wind speed variability and stars magnitude difference between asterisms .    in moao and glao",
    ", the scattering is mainly due to the turbulence profile variability with time . for a given seeing",
    ", the turbulence could be characterized by very different layer relative strengths .",
    "since glao is compensating the ground layer only , for a given seeing , the sr will drop down if the turbulence in altitude become stronger.conversely , for the same seeing , the sr will increase if the ground layer dominates the turbulence .    in moao",
    ", this scattering is less expanded than in glao , as it is confirmed by table  [ t : perf ] , and this is what we should expect from a moao system  : if the tomographic reconstruction is properly achieved , the moao system must be robust to turbulent profile variability and provides the best reachable correction for a given @xmath109 profile .        in table",
    "[ t : perf ] , we give median values of sr for various ranges of seeing to illustrate what we have previously said .",
    "for each range , we get the best performance in scao and the worst in glao .",
    "in addition , results obtained with glao are more variable than moao and scao .    below 0.6 \" of seeing",
    ", we were working with good to exceptionally good conditions .",
    "the turbulence was not dominated by the ground layer and the tomographic reconstruction has operated well in comparing moao and glao . the difference between scao and moao comes essentially from the tomographic resolution we have . at this level of seeing , it becomes very important to identify accurately the @xmath109 profile to take into account weak layers , that are no more dominated by the most probable layers identified in fig .",
    "[ f : stat ] .    between 0.6 and 0.8 \"",
    ", we were observing in nominal observation conditions . table  [ t : perf ]",
    "gives nominal performance of canary on - sky .",
    "for seeing larger than 0.8 arcsec , the sr is dropping down drastically and for very bad conditions , seeing larger than 1.2 arcsec , scao , moao and glao perform at similar levels .",
    "it directly comes from our previous discussion on the seeing distribution  : when the seeing is so bad , it means the turbulence is dominated by the ground layer . the tomographic reconstruction can not provide a real improvement on performance as it does for better conditions .        ' '' ''     + < 0.6 & 37.3% @xmath164 0.7 & 30.5% @xmath164 1.2 & 22.1% @xmath164 1.8    ' '' ''     + 0.6 - 0.8 & 30.1% @xmath164 0.7 & 21.4% @xmath164 1.0 & 17.1% @xmath164 1.5    ' '' ''     + 0.8 - 1.2 & 20.6% @xmath164 0.5 & 15.6%",
    "@xmath164 0.9 & 11.0% @xmath164 1.5    ' '' ''     + > 1.2 & 11.5% @xmath164 0.3 & 10.2% @xmath164 1.3 & 9.0% @xmath164 1.9    ' '' ''     +      in fig .",
    "[ f : comparvar ] , we present the residual wf error @xmath165  ( see eq .  [ e : dti ] ) versus @xmath166  ( see eq .",
    "[ e : dmts ] ) . by comparing these two quantities",
    ", we quantify the accuracy of our error breakdown proposed in sect .",
    "we get about 99  % of correlation in all modes and less than 1  % of the total points are further than one sigma from the y = x line .",
    "we get a larger scattering in moao and glao since the error breakdown evaluation depends directly on the @xmath109 profile estimation .",
    "we accumulate more potential sources of error .",
    "a posteriori , the very high correlation between analytic calculations and measurements shows all the assumptions we have made in sect .",
    "[ s3 ] are not limiting results at this scale of atmosphere compensation .    on top of that , fig .",
    "[ f : comparvar ] illustrates the identification of the turbulence has been done properly , with enough accuracy and precision to get those fitting between calculations and observations .",
    "we do not observe any bias whatever the range of residual wf error as well .",
    "we are thus able to determine the turbulence characteristics , at a same level of accuracy , whatever the seeing conditions .",
    "these results make us confident in future developments for preparing the future mos design simulations , and especially for mosaic the next multi - object instrument proposed for the e - elt . +    ) , most of them in moao .",
    "coefficients given at the right - down corner are the estimation of the correlation factor  ( pearson coefficient ) between analytic sr and image sr .",
    "scao=@xmath167 , moao=@xmath168 , glao=@xmath169 .",
    "]    figs .",
    "[ f : srmar ] and  [ f : srpar ] show the h - band sr estimated using respectively eqs .",
    "[ e : srmar ] and  [ e : sr ] , versus the sky image sr . both of marchal and parenti approximations are using @xmath97 in eq .",
    "[ e : dti ] to estimate the sr .     versus h - band image sr .",
    "coefficients given at the right - down corner are the estimation of the correlation factor  ( pearson coefficient ) between analytic sr and image sr .",
    "scao=@xmath167 , moao=@xmath168 , glao=@xmath169 . ]     from @xmath97 versus image sr .",
    "coefficients given at the right - down corner are the results the estimation of the correlation factor  ( pearson coefficient ) between analytic sr and image sr .",
    "scao=@xmath167 , moao=@xmath168 , glao=@xmath169 . ]    the relation between the sr and the residual wf variance is not bijective  : for a given variance @xmath96 , several values of sr are possible .",
    "for instance , the tip - tilt modes make the psf core spread . for a given residual variance ,",
    "if there is more residual tip - tilt in a situation than in another , the first one will comes with a worse sr . the parenti formulation proposed in eq .",
    "[ f : srpar ] tries to take into account this modal weighting , but the real relation between sr and variance can not be given by a simple formula .    in fig .",
    "[ f : srmar ] , we observe a correlation between analytic and image sr for sr larger than 20% , but find a bias for lower values of image sr .",
    "for both methods , we get very similar pearson coefficient , but the parenti approximation makes the under - estimation of low sr disappear as shown in fig .  [",
    "f : srpar ] . the scattering we observe on figs .",
    "[ f : srmar ] and  [ f : srpar ] comes from the inaccuracy of marchal and parenti approximations , since we do not observe such a scattering in fig .",
    "[ f : comparvar ] .",
    "we focus in this section on the canary performance to target the improvement of the atmosphere compensation , achieved thanks to both tomographic reconstruction and lgs .",
    "we compare on - sky results acquired during what we call a script .",
    "a script is five data recordings of the same sequence made of three successive ao modes observation .",
    "a sequence lasts 45  s , 15  s per ao mode .",
    "this duration has been chosen to enable us to compare canary performance , running in different ao modes , in similar atmospheric conditions .",
    "we compare on - sky performance achieved by scao , glao and moao with and without lgs .",
    "we use the letters `` n '' and `` l '' following the ao modes to define respectively ngs and lgs sensors .",
    "for instance , `` moao4l3n '' means canary was compensating the turbulence in moao mode using the four lgs and three ngs .    in the following",
    ", we will present three of those scripts , numbered 274 , 292 and 275 . in table",
    "[ t : scriptconditions ] , we report observation conditions we have identified during those scripts .",
    "the seeing and outer scale values comes from the learn&apply algorithm .",
    "the wind speed has been retrieved from the full width at half maximum of the slope measurement temporal auto - correlation function , after subtraction of the noise contribution .",
    "this method provides an integrated value of the wind speed along the turbulence profile .",
    "these scripts have been selected because of their relatively close observing conditions . the observed asterism was a47 for scripts 274 and 275 and a53 for 292  @xcite .        ' '' ''     + & mode 1 & scao & scao & scao    ' '' ''     + ao modes & mode 2 & moao 4l3n & moao 4l3n & moao 4l3n    ' '' ''     + & mode 3 & glao 4l3n & glao 4l3n & moao 3n    ' '' ''     + & @xmath11 calibration & 21  h 23  m & 01  h 37  m & 21  h 23  m    ' '' ''     + local time & script start & 21  h 55  m & 02  h 30  m & 22  h 03  m    ' '' ''     + & script end & 22  h 01  m & 02  h 35  m & 22  h 08  m    ' '' ''     + asterism & & a47 & a53 & a47    ' '' ''     + airmass range & & 1.086 - 1.079 & 1.035 - 1.038 & 1.076 - 1.069    ' '' ''     + & total & 0.83 & 0.78 & 0.81    ' '' ''     + seeing [ \" ] & ground & 0.70 & 0.56 & 0.68    ' '' ''     + & altitude & 0.35 & 0.46 & 0.36    ' '' ''     + & total & 13.3 & 12.2 & 11.9    ' '' ''     + @xmath170 [ m ] & ground & 5.2 & 5.9 & 12.1    ' '' ''     + & altitude & 19.3 & 17.9 & 11.7    ' '' ''     + wind speed [ m / s ] & total & 3.0 & 2.9 & 3.1    ' '' ''     + & mode 1 & 28.3 & 30.0 & 29.0    ' '' ''     + image sr [ % ] & mode 2 & 21.0 & 16.0 & 18.1    ' '' ''     + & mode 3 & 12.9 & 9.2 & 14.6    ' '' ''     +      in fig .",
    "[ f : psf ] , we show three psfs averaged over five h - band images acquired during script 274 in scao , moao 4l3n and glao 4l3n , the september 13th 2013 night .",
    "thanks to the tomographic reconstruction , we make the sr improving from 12.9% in glao to 21.0% in moao , corresponding to a wave - front error reduction by an order of 190 nm rms between the two modes , using eq .",
    "[ e : srmar ] .",
    "the best sr is obtained by scao with a value of 28.3% .            in fig .",
    "[ f:274_sr ] , we highlight the evolution of both analytic and ir image sr with time . analytic sr have been derived from eq .  [",
    "e : sr ] using the residual phase variance developed in eq .",
    "[ e : dti ]  ( it method ) .",
    "the figure displays the five samples per ao mode , acquired successively and interlaced between each other .    by interlacing different ao modes ,",
    "we minimize the impact of the possible turbulence non - stationarity during the script .",
    "if a particular event happens during the script , we should observe it with each mode if it lasts for at least 45  s. this ensures that we are able to compare ao modes with nearly similar observational conditions .",
    "figure  [ f:274_sr ] shows that we are in the most able to reproduce analytically the sr in a satisfactory way .",
    "the evolution of the ir image sr with time is well reproduced , as the absolute value and the difference between modes .",
    "however , we have an under - estimation of the sr that becomes more severe when the sr becomes higher , especially for scao , thus implied by the parenti approximation according to fig .  [",
    "f : srpar ] .",
    "note from the same figure , the marchal approximation would give worse reproduction of low sr .    )",
    "sr versus local time for script 274 .",
    "scao=@xmath171 , moao lgs / ngs=@xmath169 , moao 3 ngs=@xmath168 . in moao and glao ,",
    "we have used the it approach to get the residual phase variance , while in scao we have used the ts approach . ]    for further performance analysis , we present in fig .  [ f:274_prof ] top , in the left panel , a comparison between the turbulent profile on which the sky reconstructor has been calibrated and the post - retrieved one on the script 274 data sets .",
    "these results are from an average of fifteen profiles , each of which has been retrieved on five layers on each data set .",
    "we obtain ( by post processing ) 75% of turbulence at the ground  ( below the first kilometer ) , against 70% expected by the sky reconstructor ( computed 20 min .",
    "before the script was run ) .",
    "in addition , the 11  km altitude layer observed during the script was quite well identified in the reconstructor .",
    "however , the observed 16  km altitude layer was partially identified thanks to the high altitude layers , between 14 and 18  km , as expected by the reconstructor .",
    "finally , it seems that our mmse reconstructor was still relevant for the turbulence profile encountered during the script .    in the middle , left panel of fig .",
    "[ f:274_prof ] , we present the full error breakdown for each ao mode",
    ". it clearly highlights the improvement coming from the tomographic reconstruction  : the term @xmath99 fell from 365  nm ( glao ) to 185  nm ( moao ) , while the other terms were very similar . the difference between scao and moao",
    "is also explained by the tomographic error and the static terms as well .",
    "the fluctuations of the fitting , aliasing , servo - lag and noise errors we observe are relatively small between ao modes and mainly due to the variance on the seeing estimation .",
    "they also depend on the system temporal transfer function including the loop gain and the reconstructor used .    in both moao and glao",
    ", we get 140  nm of static errors , despite the calibrations that have been done before the script  ( see sect .",
    "[ ss : static ] ) .",
    "it shows these calibrations are mandatory to operate the turbulence tomographic compensation properly .    in a further analysis of the tomographic error",
    ", we show the tomographic ved in fig .",
    "[ f:274_prof ] bottom , left panel .",
    "it becomes clear that the moao reconstructor allows better compensation of the altitude layers than the glao reconstructor .",
    "note we reduce the wf error by 170  nm on the 11  km layer by using moao .",
    "however , the glao reconstructor is better than the moao one at compensating the very low altitude layers , below 2  km , near to be the tomographic resolution with this asterism .",
    "this is due to the robustness of mmse reconstructor  : the more layers it predicts , the less efficiently it is able to compensate individual layers  @xcite .",
    "this is for the same reason that the glao reconstructor is the only one to get 0  nm rms at 0  km , predicting this unique layer .",
    "we discuss here the results from script 292 . in the same way as script 274 , we compared scao , moao and glao , but with a mis - calibration of the mmse reconstructor . we illustrate in fig .",
    "[ f:274_prof ] the turbulence profile used to compute the moao reconstructor , compared to the one retrieved during the script 292 . according to table  [ t : scriptconditions ] ,",
    "there was one hour between the calibration and the script . during this time",
    ", strong altitude layers were appeared at 10.5 and 13.5  km , accounting together for 35  % of the total turbulence and these are not expected by the moao reconstructor .",
    "the global observation conditions , between script 292 and 274 , was quite similar as given in table  [ t : scriptconditions ] .",
    "in addition , fig .",
    "[ f:274_prof ] allows us to compare error breakdown between these two scripts , to highlight that we obtained the same level on each error term except for tomography .",
    "we get 285  nm rms during script 292 against 185 during script 274 for moao .",
    "these values are comparable since the turbulence profiles during observations , as shown in fig .",
    "[ f:274_prof ] , were largely similar , with 60 - 70% of ground turbulence and the rest of the energy distributed into two altitude layers .",
    "the 215 nm rms difference in tomographic error is thus due to the mis - calibration of the tomographic reconstructor .",
    "it has led to a decrease of the ir image sr according to table  [ t : scriptconditions ] .",
    "vertical error distribution plots given in fig .",
    "[ f:274_prof ] also illustrate that the moao reconstructor has been mis - calibrated .",
    "however it still performs much better than the glao one , especially at high altitudes .",
    "for instance at the 11  km layer , we get similar performance in glao during the two scripts 274 and 292 , with 275  nm and 285  nm of error respectively .",
    "we underline the tomographic errors of moao in script 292 are very significant for the two high altitude layers at 11 and 13.5 km with 140 nm and 235 nm respectively . much poorer performance is shown when compared to the high altitude layers of script 274 .",
    "the moao reconstructor has to be calibrated several times each night .",
    "it is thus mandatory to propose innovative techniques to compute and update a mmse reconstructor for large number of degrees of freedom in order to prepare the e - elt .",
    "fast computation and data transfer are required .",
    "several works are on - going on that , in particular using gpus  @xcite .",
    "script 275 was obtained directly after script 274 .",
    "the turbulent profile did not evolve significantly between the two scripts .",
    "we were comparing scao with moao , with and without lgs .",
    "we aim to evaluate the impact of using lgs on the tomographic reconstruction for the canary case .",
    "we report in fig .",
    "[ f:275_budget ] the error breakdown we get during this script . in moao 4l3n",
    ", we get the same errors compared to script 274 in fig .",
    "[ f:274_prof ] , as we expect since the observational conditions were similar according to table  [ t : scriptconditions ] and the turbulent profile was similar as well .",
    "in addition , we get very similar error values between moao 4l3n and moao 3n .",
    "the main difference comes from the tomographic error with 260  nm rms against 185  nm rms respectively in moao 3n and moao 4l3n . ",
    "overall , we see an increase of nearly 4% in ir image sr  ( see table  [ t : scriptconditions ] ) when introducing lgs .",
    "[ f:275_ved ] gives the ved of the tomographic error .",
    "thanks to lgs , we reduce the error on every layer , even at the ground .",
    "the most substantial gain is obtained at 11 km because of the relatively compact lgs asterism ( lgs only 22.6 \" off - axis ) . while at 16 km , the low altitude of the lgs ( 21 km ) limits the gain .",
    "the ved curve , as explained in  @xcite , shows the distribution of the tomographic error along the altitude . in using more wfs",
    ", we should decrease the error level in this curve at any altitude .",
    "but , because of the cone effect , in adding lgs , the decrease of the tomographic error is not homogeneous over all altitudes , we so get a better relative improvement for low altitude layers than for high altitude ones .",
    "it is for this reason that we get such a gap for the 0 and 2  km layers between moao 4l3n and moao 3n . by using sodium lgs",
    ", we could expect to reduce this performance gap at higher altitudes .",
    "this paper gives a detailed analysis of canary sky performance in its phase b configuration , for data sets acquired in 2013 at the wht .",
    "in particular , we gave our method to manage the lgs tip - tilt filtering and how to compute mixed ngs plus lgs glao and moao reconstructors .",
    "we have showed the tomographic error can be computed from only a reconstructor and a covariance matrix of slopes , measured on uncompensated wave - fronts .",
    "this matrix can be produced either empirically or analytically  ( see .",
    "appendix  [ a:1 ] ) . we have also proposed an analytic formulation of the residual phase variance .",
    "it is split into several error terms , which are assumed to be independent .",
    "we have detailed the calculation of each terms based on either the off - axis measurements or analytic formulas .",
    "we gave also another method to get the residual phase variance directly from the ts measurements .",
    "using 4,500 data sets , we gave statistics of canary performance and presented average values of sr for different ranges of seeing , with 30.1 , 21.4 and 17.1  % of sr respectively in scao , moao and glao using 4 lgs and 3 ngs for median seeing .",
    "in addition , we have characterized the turbulence over the wht during canary on - sky observations .",
    "this was mostly dominated by the ground turbulence  ( h<1  km ) , which reaches 0.59 `` of seeing  ( 500  nm ) with a standard - deviation of 0.34 '' , compared with 0.21 `` and 0.09 '' rms for combined higher altitude layers .",
    "the total turbulence has reached 0.66 `` of median seeing and 0.33 '' in standard - deviation .",
    "in addition , we have 0.09 \" of seeing above 20  km where canary is not able to reconstruct the turbulence phase , but only for about 34% of the time .",
    "we have demonstrated that our analytic error breakdown computations follow the ir image measured sr fairly closely . between the two error computation approaches ( analytic and ts based )",
    ", we get a correlation of 99  % , for all ao modes .",
    "we have detailed the canary performance on particular data sets .",
    "we have showed the lgs can increase the sr by up to 4% compared to the using only the ngs , while the moao tomographic reconstructor allows a gain of 8.5 percentage points of sr , compared to glao compensation .",
    "we have also discussed the vertical error decomposition of the tomographic error , evaluating the gain brought by moao in altitude compared to glao , while the glao nulls the error in the ground layer .",
    "moreover , we have highlighted the static aberrations in moao that must be carefully calibrated and monitored during the observations .",
    "this work was supported by cnrs , insu , observatoire de paris and universit paris diderot - paris 7 in france , science and technology facilities council and univ .",
    "of durham in uk , and european commission ( fp7 infrastructures 2012 - 1 , opticon grant 312430 , wp1 ) .",
    "these projects have also received the support of the a*midex project ( no . anr-11-idex-0001 - 02 ) funded by the `` investissements davenir '' french government programme , managed by the french national research agency ( anr ) .",
    "this work was also funded by the uk science and technology facilities council , grants st / k003569/1 and st / l00075x/1 .",
    "the raw data used in this publication is available from the authors .",
    "we consider the @xmath172 sub - aperture of the @xmath27 wfs . in the pupil plane , we note @xmath173 the position of the @xmath172 sub - aperture than does not depend on the wfs that are all conjugated at the pupil plane",
    ". then , @xmath174 will be the angular position of the @xmath27 wfs from the center of the fov .",
    "we will finally denote @xmath175 the altitude focus of guide stars .",
    "we denote @xmath176 the coordinate of this sub - aperture at the @xmath177 layer in the cartesian coordinate system of the pupil plane .",
    "we have  : @xmath178 for the following theoretical developments , we define @xmath179 and @xmath180 the projection of @xmath176 on the pupil plane reference  : @xmath181 where @xmath182 and @xmath183 form an orthonormal basis along directions @xmath184 and @xmath185 . for a shack - hartmann wfs , the slopes 2d map comes from the average phase gradient over the lenslet  : @xmath186 where @xmath187 is the @xmath172 sub - aperture pitch and @xmath188 is the square integration domain comprised between @xmath189 and @xmath190 in @xmath184 and @xmath185 directions .",
    "the integration variables @xmath191 @xmath192 are related to the @xmath172 sub - aperture and are given by @xmath193 and @xmath194 .",
    "we define the x - axis and y - axis slopes as the scalar product between @xmath195 and respectively @xmath182 and @xmath183 . in projecting the slopes along",
    "x or y directions , the integral on sub - aperture surface in eq .",
    "[ e : sx0 ] becomes integrals along sub - aperture side  : @xmath196 we then define the spatial covariance @xmath197 , @xmath198 and @xmath199 as the following functions  : @xmath200 where @xmath201 is the separation between the @xmath172 sub - aperture of @xmath27 wfs and the @xmath202 sub - aperture of @xmath203 wfs , at altitude @xmath67 .",
    "we develop here the method to get @xmath204 only , both @xmath205 and @xmath206 are derived by the same way .",
    "the averaged gradient is the difference of phase along each side of the sub - aperture .",
    "we then get  : @xmath207 the trick to handle eq .",
    "[ e : sxsx ] is to use the following remarkable identity : @xmath208 that allows us to rewrite eq .",
    "[ e : sxsx ] as follows  : @xmath209 considering @xmath210 as the phase structure function  ( sf ) , we have the final expression of the x - axis slopes covariance  : @xmath211 we now consider @xmath212 as the von - krmn spatial power spectral density  ( psd ) given by  : @xmath213 the phase structure function  ( sf ) is related to the spatial psd @xmath212 by  : @xmath214 we commonly model the phase sf using the von - krmn expression  : @xmath215},\\\\ & k_1 = \\frac{2^{1/6 } \\gamma(11/6)}{\\pi^{8/3 } } { \\left[\\frac{24}{5}\\gamma(6/5)\\right]}^{5/6}\\\\ & k_2 =   \\frac{\\gamma(5/6)}{2^{1/6 } } , \\end{aligned}\\ ] ] with @xmath216 . by the same way , we get  : @xmath217 and  : @xmath218    integrals in eqs .",
    "[ e : gxx ] ,  [ e : gyy ] and  [ e : gxy ] must be discretized along the sub - aperture side . to speed up the computation",
    ", we assume a hudgin - like model  : the phase gradient is calculated in taking only the side - to - side phase difference at the middle of the sub - apertures .",
    "we have thus @xmath219 and @xmath220 forced to zero and the spatial covariance is obtained in summing the phase structure functions under integrals  ( @xcite ) .",
    "the covariance of the aliased phase can be derived using eqs .",
    "[ e : gxx ] ,  [ e : gyy ] and  [ e : gxy ] .",
    "these equations involve an expression of the phase sf , that depends on the turbulence characteristics and the geometry , according to eq .",
    "[ e : dphi ] . to get the aliasing contribution in the covariance",
    ", we have to split the phase into a parallel part , which is compensated by the system , and an orthogonal part  : @xmath221 the orthogonal phase contains only spatial frequencies higher than @xmath86 , the dm cut - off frequency . considering the quantity",
    "@xmath170 is large compared to @xmath222 , the aliasing sf @xmath223 is given by  : @xmath224 using eq .",
    "[ e : dphialias ] to replace the sf expression in eqs .",
    "[ e : gxx ] ,  [ e : gyy ] and  [ e : gxy ] , we get an analytic expression of the spatial covariance of the aliasing .",
    "the residual modes in science directions are split into a compensated , or _ parallel _",
    "part by the dm , @xmath225 and high frequencies non - reproducible , or _",
    ", by the dm , @xmath226  : @xmath227 the turbulence compensation achieved thanks to the dm results in that direction from the subtraction between the incoming parallel modes and the mirror modes @xmath228  : @xmath229 the moao controller determines the mirror modes @xmath228 to apply at a sequence @xmath151 from the previous sequence @xmath152 , the off - axis measurements @xmath12 and @xmath230 the modal command matrix used on - sky .",
    "this later includes both tomographic reconstruction and dm / wfs calibrations  ( @xcite ) . in order to get a system fractional delay @xmath231 , we combine off - axis measurements acquired at @xmath232 and @xmath152 in this way  : @xmath233 applying the z - transform to eq .  [",
    "e : v_bi ] , we get  : @xmath234 where @xmath235 and @xmath122 the sampling frequency .",
    "the transfer function @xmath236 is the moao controller transfer function defined as  : @xmath237 the moao correction transfer function of the atmospheric parallel modes , @xmath238 is given by  : @xmath239      we note @xmath108 the time series acquired by the ts in engaged loop .",
    "using the voltages vector @xmath240 , the interaction matrix @xmath241 and the calibrated the fractional delay @xmath242 , the disengaged ts slopes is estimated by  : @xmath243 we reproduce the filtering operated by the rtc , described in eq .  [ e : v_bi ] , on - sky to estimate what the ts would measure if the dm stayed flat .",
    "a. basden , d. geng , r. myers and e. younger , _ durham adaptive optics real - time controller _ , apply optics . 2010 . , _ experience with wavefront sensor and deformable mirror interfaces for wide - field adaptive optics systems _ , m.n.r.a.s , 2016 . , a.  g. and chemla , f. and dipper , n. and gendron , e. and henry , d. and morris , t. and rousset , g. and vidal , f. _ real - time correlation reference update for astronomical adaptive optics _ , m.n.r.a.s , 2014 .",
    ", a.  g. and myers , r.  m. and gendron , e. , _ wavefront sensing with a brightest pixel selection algorithm _ , m.n.r.a.s , 2012 . , _ on - sky tests of",
    "the cured and hwr fast wavefront reconstruction algorithms with canary _ , m.n.r.a.s , 2015 .",
    ", _ eagle : a moao fed multi - ifu nir workhorse for e - elt _ , proc .",
    "spie , 2010 .",
    ", c.  j. , lehnert , m.  d.,cuby , j .-",
    "g . , morris , s.  l. , swinbank , a.  m. , taylor , w.  d. , alexander , d.  m. , lorente , n.  p.  f. , clnet , y. and paumard , t. , _ science requirements for eagle for the e - elt _ , proc .",
    "spie , 2008 .",
    ", d.  l. , _ anisoplanatism in adaptive optics _ , journal of the optical society of america ( 1917 - 1983 ) , 1982 .",
    ", _ a novel fast and accurate pseudo - analytical simulation approach for moao _ proc .",
    "spie , 2014 .",
    ", e. and lna , p. , _ astronomical adaptive optics . 1 : modal control optimization _ , astron . & astrophys . , 1994 .",
    ", e. , morel , c. , osborn , j. , martin , o. , gratadour , d. , vidal , f. , le louarn , m. and rousset , g. , _ robustness of tomographic reconstructors versus real atmospheric profiles in the elt perspective _ , proc .",
    "spie , 2014 . ,",
    "e. , vidal , f. , brangier , m. , nd morris , t. , hubert , z. , basden , a. , rousset , g. , myers , r. , chemla , f. , longmore , a. , butterley , t. , dipper , n. , dunlop , c. , geng , d. , gratadour , d. , henry , d. , laporte , p. , looker , n. , perret , d. , sevin , a. , talbot , g. and younger , e. , _ moao first on - sky demonstration with canary _ , astron . & astrophys . , 2011 , , l. and ellerbroek , b.  l. , _ split atmospheric tomography using laser and natural guide stars _ , journal of the optical society of america a , 2008 . ,",
    "d. , gendron , e. and rousset , g. , _ practical issues with phase diversity for ncpa compensation resolved on the canary demonstrator _ , proceedings of the third ao4elt conference . , 2013 .",
    "gpus for adaptive optics : simulations and real - time control _ , proc .",
    "spie , , d , gendron , e , grosset , l , morris , t , osborn , j , basden , a , martin , o , rouan , d , myers , r and rousset , g , _ first demo science with moao : observations of distant merging galaxies with canary _ , proceedings of the third ao4elt conference . , 2013 .",
    ", _ mosaic at the e - elt : a multi - object spectrograph for astrophysics , igm and cosmology _ , proc .",
    "spie , 2014 . , f. and sayde , f. and gendron , e. and fusco , t. and burgarella , d. and cayatte , v. and conan , j .-",
    "m . and courbin , f. and flores , h. and guinouard , i. and jocou , l. and lanon , a. and monnet , g. and mouhcine , m. and rigaud , f. and rouan , d. and rousset , g. and buat , v. and zamkotsian , f. , the falcon concept : multi - object spectroscopy combined with mcao in near - ir , scientific drivers for eso future vlt / vlti instrumentation , 2002 .",
    "a. kellerer , f. vidal , e. gendron , z. hubert , d. perret and g. rousset , _",
    "deformable mirrors for open - loop adaptive optics _ , proc .",
    "spie , 2012 .",
    ", _ temporal convergence of phase spatial covariance matrix measurements in tomographic adaptive optics _ , proc .",
    "spie , 2012 .",
    ", _ e - elt update of project and effect of change to 39 m design _ , proc .",
    "spie , 2012 .",
    ", _ multiple object adaptive optics : mixed ngs / lgs tomography _ , proceedings of the third ao4elt conference , 2013 . , _ canary phase b : on - sky open - loop tomographic lgs ao results _ ,",
    "spie , 2014 . ,",
    "r.  m. and hubert , z. and morris , t.  j. and gendron , e. and dipper , n.  a. and kellerer , a. and goodsell , s.  j. and rousset , g. and younger , e. and marteaud , m. and basden , a.  g. and chemla , f. and guzman , c.  d. and fusco , t. and geng , d. and le roux , b. and harrison , m.  a. and longmore , a.  j. and young , l.  k. and vidal , f. and greenaway , a.  h. , _ canary : the on - sky ngs / lgs moao demonstrator for eagle _ , proc .",
    "spie , 2008 .",
    ", _ open - loop tomography with artificial neural networks on canary : on - sky results _ , m.n.r.a.s , 2014 .",
    ", _ laser guide - star systems for astronomical applications .",
    "_ , journal of the optical society of america a , 1994 . , f. and conan , j .-",
    "m . and petit , c. , _ generalized aliasing and its implications in modal gain optimization for multi - conjugate adaptive optics _ , journal of the optical society of america a , 2010 .",
    ", _ adaptive optics on a 3.6-m telescope - results and performance _ , astron . & astrophys . , 1991 .",
    ", g. and fusco , t. and assmat , f. and gendron , e. and morris , t. and robert , c. and myers , r. and cohen , m. and dipper , n. and evans , c. and gratadour , d. and jagourel , p. and laporte , p. and le mignant , d. and puech , m. and schnetler , h. and taylor , w. and vidal , f. and cuby , j .-",
    "g . and lehnert , m. and morris , s. and parr - burman , p. , _ eagle moao system conceptual design and related technologies _ , proc .",
    "spie , 2010 . ,",
    "g. and kulcsr , c. and conan , j .-",
    "raynaud , h .- f . and gendron ,  . and basden ,",
    "a. and vidal , f. and morris , t. and meimon , s. and petit , c. and gratadour , d. and martin , o. and hubert , z. and sevin , a. and perret , d. and chemla , f. and rousset , g. and dipper , n. and talbot , g. and younger , e. and myers , r. and henry , d. and todd , s. and atkinson , d. and dickson , c. and longmore , a. , _ first on - sky scao validation of full lqg control with vibration mitigation on the canary pathfinder _ , optics express , 2014 .",
    ", _ fractal iterative method for fast atmospheric tomography on extremely large telescopes _ , proc .",
    "spie , 2010 . , _",
    "tomography approach for multi - object adaptive optics _ , josa a , 2010 .",
    ", _ analysis of on - sky moao performance of canary using natural guide stars _ , astron .",
    "& astrophys . , 2014 ."
  ],
  "abstract_text": [
    "<S> canary is the multi - object adaptive optics ( moao ) on - sky pathfinder developed in the perspective of multi - object spectrograph on extremely large telescopes  ( elts ) . in 2013 </S>",
    "<S> , canary was operated on - sky at the william herschel telescope  ( wht ) , using three off - axis natural guide stars  ( ngs ) and four off - axis rayleigh laser guide stars  ( lgs ) , in open - loop , with the on - axis compensated turbulence observed with a h - band imaging camera and a truth wave - front sensor  ( ts ) for diagnostic purposes . our purpose is to establish a reliable and accurate wave - front error breakdown for lgs moao . </S>",
    "<S> this will enable a comprehensive analysis of canary on - sky results and provide tools for validating simulations of moao systems for elts . to evaluate the moao performance , we compared the canary on - sky results running in moao , in single conjugated adaptive optics  ( scao ) and in ground layer adaptive optics  ( glao ) modes , over a large set of data acquired in 2013 . </S>",
    "<S> we provide a statistical study of the seeing . </S>",
    "<S> we also evaluated the wave - front error breakdown from both analytic computations , one based on a moao system modelling and the other on the measurements from the canary ts . </S>",
    "<S> we have focussed especially on the tomographic error and we detail its vertical error decomposition  ( ved ) . </S>",
    "<S> we show that canary obtained 30.1% , 21.4% and 17.1% h - band strehl ratios in scao , moao and glao respectively , for median seeing conditions with 0.66 `` of total seeing including 0.59 '' at the ground . </S>",
    "<S> moreover , we get 99% of correlation over 4,500 samples , for any ao modes , between two analytic computations of residual phase variance . </S>",
    "<S> based on these variances , we obtain a reasonable strehl - ratio  ( sr ) estimation when compared to the measured ir image sr . </S>",
    "<S> we evaluate the gain in compensation for the altitude turbulence brought by moao when compared to glao . </S>"
  ]
}