{
  "article_text": [
    "the @xmath100 nuclear spin bath that has a natural abundance of @xmath101 effectively produces a random field with frequency set by the nuclear gyromagnetic ratio @xmath102  mhz / t and the dc bias field @xmath11 .",
    "this random field causes collapses and revivals in the cp signals . for best results in ac magnetometry",
    ", it is required to operate on a revival point and this constrains the workable ac field frequencies to be @xmath103 where , @xmath104 is an integer and @xmath105 is the larmor period of the nuclear bath field .",
    "having a larger bias magnetic fields could be useful for ac magnetometry due to the fast revival rates and thus giving more flexibility in terms of workable ac magnetic field frequencies .",
    "the enhancement of the coherence time with dd sequences has been extensively studied  @xcite .",
    "we use a fitting function , @xmath106 where the @xmath107 is the decay due to decoherence , @xmath108 , and both @xmath109 and @xmath110 are sample dependent numbers which turn out to be @xmath111 and @xmath112 in our case .",
    "the probability @xmath34 to be in @xmath35 and @xmath113 to be in @xmath114 is related to the signal due to the in - phase magnetic field @xmath33 by : @xmath115 where @xmath116 .",
    "thus , given a quantum measurement result @xmath117 the likelihood distribution for the @xmath40 is given by : @xmath118 where @xmath119 represents measuring @xmath120 state on the @xmath121 measurement . since our aim is to find the unknown phase @xmath40 given the measurement results , we can use bayes theorem , @xmath122 .",
    "if the _ a priori _ distribution of the phase @xmath123 is assumed to be flat , then @xmath124 , and we multiply together the probability distributions after each measurement result followed by a normalization step to obtain the conditional probability @xmath125 after all the measurements .",
    "the mle is found from the likelihood function ( @xmath126 ) .",
    "[ figlik](a ) shows the distribution of 1000 measurement results of each state @xmath35 and @xmath114 when a single pulse sequence is repeated r=15000 times .",
    "this leads to a fidelity @xmath127 in distinguishing the two states .",
    "[ figlik](b),(c ) shows the phase likelihood distribution for unknown quantum phase @xmath40 for field amplitudes @xmath128 44nt and 264nt respectively . here ,",
    "magnetic field phase @xmath129 and frequency @xmath130=12.55khz . fig .",
    "[ figlik](d ) show the distributions of mle s when the experiment is repeated 50 times for the above field amplitudes .",
    "[ [ lockin - magnetometer - detection - of - random - phase - jumps - of - any - magnitude ] ] lockin magnetometer : detection of random phase jumps of any magnitude ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    the pea parameters set here were @xmath131 and leads to a time constant @xmath132  sec of the lock - in , and the phase @xmath42 was held constant over this time but allowed to vary randomly between measurements .",
    "the red curve in fig .  [ figrnd3 ] shows the history of @xmath42 while the blue curve is the estimated phase @xmath133 from the lock - in .",
    "the average of the phase jumps from the estimates turned out to be @xmath134 with a smallest jump of @xmath135 .",
    "the above equation is plotted in fig .",
    "[ figtimeconst2](a ) for our experiments as a function of @xmath130 for different choices of @xmath140 , while keeping the longest pulse sequence length @xmath141sec a constant .",
    "the longest sequence ultimately limits the sensitivity of the quantum sensing , though of course various choices of pea parameters may result in not attaining this limit . therefore fixing this value gives us a good way to controllable change the parameters and observe the effect on the dynamic range dr and the minimum detectable field @xmath142 .",
    "these have to be obtained through numerical monte - carlo simulations that we will report in greater detail in future work , but the results are displayed in fig .",
    "[ figtimeconst2](b ) and ( c ) .",
    "as we can see there , above certain threshold measurement fidelity and choices of pea parameters @xmath61 , we obtain close to the decoherence limited sensitivity .",
    "by contrast , although cp can attain the decoherence limit , the dr is extremely limited .",
    "a second factor that limits our time constant above is the factor @xmath138 . as shown in fig .",
    "[ figlik](a ) , the number of repetitions of our pulse sequence will govern the fidelity with which we can make the bit measurements @xmath119 .",
    "this factor @xmath143 in our experiments is in turn governed by the photon collection efficiency @xmath51 and visibility @xmath144 of the fringes in our setup .",
    "recent improvements in these factors , e.g. through photonic nanostructures  @xcite or resonant excitation  @xcite can result in decreasing @xmath145 , while increasing the measurement time @xmath146  sec . correspondingly our time constant can thus be reduced by almost three orders of magnitude .",
    "we also note that to integrate for longer durations , our pea can simply be repeated more times , and the results averaged to obtain the usual improvement @xmath147 in @xmath142 .",
    "two different cases have been simulated .",
    "pea lock - in performed on a shifted frequency relative to the lock - in frequency @xmath148 is shown in fig .  [",
    "fig5](a ) .",
    "the shift is given as percentage of @xmath149 .",
    "the field amplitude was set to @xmath150 while the phase @xmath151 . in this condition ,",
    "the q - channel can detect a frequencies upto @xmath152 shift .",
    "[ fig5](b ) shows the case of two different signals one with a shifted frequency while the other on lock - in frequency given by expression : @xmath153 where @xmath154 is the frequency shift .",
    "the two in - phase signals with no frequency shift ( @xmath155 shift ) adds up to give a single signal with twice the amplitude .",
    "further we can see from the figure that the @xmath88 channel clearly shows the shift in the quadrature phase @xmath156 that is caused by the shifted frequency component . in future work , we hope to explore further the nature and magnitude of these shifts and to develop more detailed theory and simulations .",
    "46ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) , ,  and  ,  eds . ,  @noop _ _  ( ,  ,  ) http://dx.doi.org/10.1038/nphys1994 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.107.166802 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * , ( ) @noop * * , ( ) link:\\doibase 10.1038/nphys1969 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature10010 [ * * ,   ( ) ] http://arxiv.org/abs/1201.4420 [ * * ,   ( ) ] ,   http://dx.doi.org/10.1038/nmat2420 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nnano.2012.50 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nphys2543 [ * * ,   ( ) ] \\doibase    http://dx.doi.org/10.1021/nl300775c [ * * ,   ( ) ] http://dx.doi.org/10.1038/nphys2070 [ * * ,   ( ) ] link:\\doibase 10.1126/science.1216821 [ * * ,   ( ) ] @noop * * ,   ( ) http://dx.doi.org/10.1038/nnano.2012.152 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.109.137602 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.109.137601 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.86.195422 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1021/nl300964g [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.106.080802 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.83.081201 [ * * ,   ( ) ] @noop ( ) @noop * * ,   ( ) link:\\doibase    10.1103/physreva.80.052114 [ * * ,   ( ) ] link:\\doibase 10.1007/978 - 0 - 387 - 46312 - 4_5 [ _ _ ]  ( ,  )  pp",
    ".   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.99.250601 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.83.125410 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) \\doibase doi:10.1038/nnano.2010.6 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.102.057403 [ * * ,   ( ) ] link:\\doibase    10.1126/science.1192739 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.105.200402 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.86.045214 [ * * ,   ( ) ] \\doibase    doi:10.1038/nature10401 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we present an experimental method to perform dual - channel lock - in magnetometry of time - dependent magnetic fields using a single spin associated with a nitrogen - vacancy ( nv ) color center in diamond . </S>",
    "<S> we incorporate multi - pulse quantum sensing sequences with phase estimation algorithms to achieve linearized field readout and constant , nearly decoherence - limited sensitivity over a wide dynamic range . </S>",
    "<S> furthermore , we demonstrate unambiguous reconstruction of the amplitude and phase of the magnetic field . </S>",
    "<S> we show that our technique can be applied to measure random phase jumps in the magnetic field , as well as phase - sensitive readout of the frequency .    </S>",
    "<S> the coherent evolution of a quantum state interacting with its environment is the basis for understanding fundamental issues of open quantum systems  @xcite , as well as for applications in quantum information science and technology  @xcite . </S>",
    "<S> traditionally in these fields , the extreme sensitivity of coherent quantum dynamics to external perturbations has been viewed as a barrier to be surmounted . by contrast </S>",
    "<S> , quantum sensors have emerged that instead take advantage of this sensitivity ; recent examples include electrometers and magnetometers based on superconducting qubits  @xcite , quantum dots  @xcite , spins in diamond  @xcite and trapped ions  @xcite .    </S>",
    "<S> the nitrogen - vacancy ( nv ) defect center in diamond ( fig .  </S>",
    "<S> [ figexp](a ) ) shows great promise as an ultra - sensitive solid - state magnetometer and magnetic imager because it features potentially atomic - scale resolution  @xcite , wide temperature range operation from 4 k  700 k  @xcite , and long coherence times that allow for high magnetic field sensitivity  @xcite . </S>",
    "<S> recent demonstrations include nanoscale magnetic imaging  @xcite , coupling to nano - mechanical oscillators  @xcite , detection of single proximal nuclear spins  @xcite and nanoscale volumes of external electron and nuclear spins  @xcite .    </S>",
    "<S> magnetometry with diamond spin sensors detects the frequency shift of the nv spin resonance caused by the magnetic field via the zeeman effect . </S>",
    "<S> highly sensitive quantum sensing techniques use multi - pulse dynamical decoupling ( dd ) sequences  @xcite that are tuned to the frequency of a time - dependent field . the resulting fluctuating frequency shift is rectified and integrated by the pulse sequence to yield a detectable quantum phase , while effectively filtering out low frequency noise from the environment ( fig .  [ figexp](b ) ) . </S>",
    "<S> another advantage of these dd sequences is that they make the magnetometer insensitive to instabilities such as drifts in temperature or applied bias magnetic field .    </S>",
    "<S> [ 1 ]    however , these state of the art quantum sensing methods also have significant drawbacks : the dynamic range is limited by the quantum phase ambiguity  @xcite , the sensitivity is a highly nonlinear function of field amplitude requiring prior knowledge of a working point for accurate deconvolution , and the classical phase of the field has to be carefully controlled to obtain accurate field amplitude  @xcite .    in this work , we present an experimental method that incorporates the dd sequences with phase estimation algorithms ( pea ) to address these fundamental problems ( see fig .  [ figexp](c ) ) . </S>",
    "<S> our dual - channel lock - in magnetometer has linearized field readout and nearly decoherence - limited constant sensitivity , while offering significantly greater dynamic range . </S>",
    "<S> we demonstrate unambiguous reconstruction of the amplitude and phase of the magnetic field without prior knowledge of either value . </S>",
    "<S> finally , we show that our technique can be applied to measure random phase jumps in the magnetic field , and to obtain phase - sensitive field frequency readout .    </S>",
    "<S> as demonstrated by conventional electronic lock - in techniques , phase information is often extremely useful in measuring important physical processes such as relaxation life - times  @xcite , spectral and spatial diffusion  @xcite . </S>",
    "<S> dynamic range and constant sensitivity may be helpful in accurate measurements of small magnetic fields due to spins in nanoscale volumes  @xcite , and in measuring spin density of heterogenous samples at low magnetic fields , where different magnetic species are not well resolved in frequency space . </S>",
    "<S> observables like the field phase and frequency may also be useful in situations where the target spins are hard to polarize or to drive  @xcite . </S>",
    "<S> random phase and spin configuration approximations are often made to theoretically deal with this problem and thereby retrieve the field amplitude  @xcite , but it remains to be verified if these approximations are valid experimentally in samples of interest  @xcite . </S>",
    "<S> thus , our methods open up the potential for new modes of magnetometry with nv spin sensors , as well as for other quantum sensors .    </S>",
    "<S> the important feature of peas that permits this reconstruction is reminiscent of a fourier series in the quantum phase @xmath0 . </S>",
    "<S> indeed , peas were first introduced for the purpose of performing a quantum fourier transform in shor s algorithm . the quantum circuit representation of our pea is shown in fig .  [ figexp](c ) . </S>",
    "<S> the spin qubit is first initialized into the @xmath1 state , while the auxiliary qubit is initialized into the state @xmath2 where @xmath0 is the quantum phase to be estimated . </S>",
    "<S> the action of the controlled-@xmath3 gate on the auxiliary qubit register is @xmath4 , resulting in the combined state @xmath5 measurements are carried out in the set of basis states @xmath6 and the resulting probability distributions are combined using bayesian analysis to obtain an estimate for the state @xmath7 . </S>",
    "<S> since the auxiliary registers are not measured , they can be replaced by a classical drive field that causes the phase shift shown above on the control qubit , and the corresponding quantum phase allows us to estimate the classical drive field . </S>",
    "<S> our implementation of the pea is discussed below , after we introduce our experimental system and quantum sensing with dd sequences . </S>",
    "<S> the nv center is a spin-1 system in the ground state , quantized along the c@xmath8 symmetry axis , with the @xmath9 and @xmath10 levels split by 2.87  ghz at zero magnetic field . </S>",
    "<S> the spin state can be initialized by optical pumping with 532 nm laser excitation , and the spin polarization can be detected by measuring the spin - dependent fluorescence signal . </S>",
    "<S> our magnetometry setup is shown schematically in fig .  </S>",
    "<S> [ figexp](a ) . </S>",
    "<S> we use a single nv center in a type - iia bulk diamond sample , and apply a static magnetic field @xmath11 oriented along the nv centers @xmath12-axis , allowing us to form a pseudo - spin @xmath13 qubit system with the @xmath14 spin states . </S>",
    "<S> microwave pulses are applied to the nv center using a thin copper wire on the diamond surface , allowing us to attain a @xmath15 rotation in @xmath16  ns .    </S>",
    "<S> [ 1 ]    the hamiltonian for a spin-@xmath17 qubit interacting with an external magnetic field @xmath18 , while being driven with on - resonance electromagnetic fields is given in the rotating frame by @xmath19 . here </S>",
    "<S> @xmath20  </S>",
    "<S> ghz / t is the gyromagnetic ratio of the spin , @xmath21 is the rabi frequency of the on - resonance drive field and @xmath22 is an adjustable control phase of the microwave . </S>",
    "<S> an oscillating magnetic field @xmath23 can be measured by the carr - purcell @xmath24 ( @xmath25 ) sequence , as shown in fig .  </S>",
    "<S> [ figexp](b ) . here , @xmath26 is the dd filter function of the cp sequence  @xcite with reference frequency @xmath27 . the collapses and revivals in the signals due to @xmath28c nuclear spins in our sample , shown in supplementary information ( si ) fig .  </S>",
    "<S> s1 , restricts the allowable values of the filter reference frequency @xmath29 where @xmath30 is an integer , @xmath31 is the @xmath28c larmor frequency , @xmath32  mhz / t is the @xmath28c nuclear gyromagnetic ratio . </S>",
    "<S> we can then detect the in - phase magnetic field ( @xmath33 ) by measuring the probability @xmath34 to be in @xmath35 ; @xmath36 and the quantum phase @xmath37 where @xmath38 is the decoherence function ( see si fig .  </S>",
    "<S> s2 ) , and @xmath39 is the effective coherence time under the dd pulse sequence  @xcite .    the quantum phase @xmath40 is ambiguous due to the multi - valued inverse sine or cosine functions , requiring us to restrict its range to @xmath41 . </S>",
    "<S> we also need to know the classical phase @xmath42 to obtain @xmath43 or vice - versa . </S>",
    "<S> furthermore , even if the classical phase is known , the dynamic range is limited by the above restriction on @xmath40 , as shown in fig .  </S>",
    "<S> [ figpea](a ) . </S>",
    "<S> the sensitivity improves with higher number @xmath44 of @xmath45 pulses , but correspondingly only a small range of fields can be sensed . as shown by the data in fig .  </S>",
    "<S> [ figpea](b ) , when the classical phase @xmath42 is allowed to vary , magnetic field values that differ by factors of 2 ( or even 10 ) could yield the same signal . in a conventional electronic single channel lock - in amplifier , simply tuning the phase of the reference channel to minimize or maximize the signal would allow us to find the amplitude and phase of the input signal . </S>",
    "<S> however , that requires a linear readout of the quantum phase @xmath40 which is not available directly for the cp sequences . </S>",
    "<S> further , in quantum sensing , the relevant reference phase corresponds to that of the dd filter function @xmath26 , and one must adjust the timing offset of the sequence for each frequency that has to be detected . </S>",
    "<S> previous works such as refs .  </S>",
    "<S> @xcite carried out this phase adjustment , usually by carefully modulating the signal ac field , to @xmath46 prior to measurement . </S>",
    "<S> practical situations where the magnetic field arises from unknown samples may prevent this phase adjustment and result in inaccurate measurements which we address here .    </S>",
    "<S> linearizing the signal could be accomplished under the assumption that both @xmath43 and @xmath42 are small , and by choosing the control phase @xmath47 . </S>",
    "<S> alternately , one can choose a working point with finite @xmath43 and @xmath48 ( see fig .  </S>",
    "<S> [ figpea](a ) ) and look for deviations from this point . by recording and averaging the fluorescence measurements separately at these carefully adjusted working points we get the sensitivity , @xmath49 where @xmath50 is the fringe visibility , and @xmath51 is a factor that depends on the photon collection efficiency in our system  @xcite . through prior knowledge of the working point </S>",
    "<S> , it is assumed that @xmath52 and this requirement will be more stringent as @xmath44 increases  @xcite . </S>",
    "<S> thus , the minimum detectable field and corresponding deconvolution of the target spin positions will depend on this knowledge . </S>",
    "<S> lastly , we note ( and show below ) that the dependence on the frequency of @xmath53 for the cp pulse sequences is symmetric around the lock - in reference frequency @xmath54 , implying that frequency changes of the field are also ambiguous .    </S>",
    "<S> overcoming the multiple ambiguities of the quantum phase caused by uncertainty in the parameters of the external magnetic field is thus an important step . </S>",
    "<S> recently , phase estimation algorithms ( peas ) were introduced for dc magnetic field sensing with single spins in diamond  @xcite . </S>",
    "<S> we first extend these results and demonstrate significant improvement in the dynamic range and linearization of the field readout , by combining the dd pulse sequence ( @xmath55 ) with pea .    in our application , </S>",
    "<S> the dd pulse sequence times are first increased in powers of 2 ( i.e. @xmath56 with @xmath57 ) starting with an initial time that is determined by the fundamental reference frequency ( @xmath58 ) that one wishes to sense . </S>",
    "<S> this results in phase accumulations @xmath59 at each step of the pea , as shown in fig .  </S>",
    "<S> [ figexp](c ) . </S>",
    "<S> secondly , measurements with the smallest times ( low zeeman shift resolution ) are corrected by repeating them several times , analogous to the weighting coefficient in a fourier series with the weighting factors @xmath60 , with @xmath61 optimized through numerical simulations ( see si and refs .  </S>",
    "<S> @xcite ) . </S>",
    "<S> finally , the control phase of the readout pulse is cycled through several values to measure along different basis vectors , thus allowing to differentiate between quantum phases that differ by fractions of @xmath45 . </S>",
    "<S> these steps are combined with digitization of the signal levels , and bayesian maximum likelihood filtering to obtain unambiguous knowledge of the field value . </S>",
    "<S> see si fig .  </S>",
    "<S> s3 for description of the bayesian estimation process  @xcite .    the data in fig .  </S>",
    "<S> [ figpea](c ) shows that our pea unambiguously measures the value of the magnetic field with a linear readout over a wide range , and is also able to resolve phase shifts of @xmath45 . </S>",
    "<S> we now turn to the comparison of the minimum detectable field @xmath62 obtained in both approaches for some fixed averaging time @xmath63 , where we chose @xmath64  sec as a typical time used in sensitive experiments  @xcite . as expected from eq .  </S>",
    "<S> , the cp sequences show rapid degradation in @xmath65 as soon as we deviate from the working point , for instance due to imperfect knowledge of @xmath42 . </S>",
    "<S> by contrast , fig .  </S>",
    "<S> [ figpea](d ) shows that the sensitivity achieved by pea remains almost a constant over a wide range of @xmath43 and is comparable to the longest cp sequence used in our work . the maximum detectable field ( @xmath66 ) of the pea </S>",
    "<S> is obtained by setting @xmath67 in eq .  , </S>",
    "<S> @xmath68 which in principle has no fundamental limit except for the restriction @xmath29 mentioned previously for our samples . the dynamic range ( dr ) is given by , @xmath69 and from the data in fig .  </S>",
    "<S> [ figpea](c ) , we obtain @xmath70 , while @xmath71 . as shown in the si ( fig .  </S>",
    "<S> s5 ) , @xmath72 keeps increasing at higher frequencies , while by contrast , the @xmath73 is essentially unchanged .    </S>",
    "<S> our dual - channel quantum lock - in magnetometer scheme , shown schematically in fig .  </S>",
    "<S> [ figlockin](a ) , detects both in - phase @xmath74 and quadrature components @xmath75 of the magnetic field . as noted above , </S>",
    "<S> using cp sequences alone does not allow us to obtain both components unless we have excellent knowledge of both @xmath43 and @xmath42 . </S>",
    "<S> we further modify the pea algorithm for lock - in detection by using both the cp-@xmath76 and cp-@xmath77 pulse sequence depicted in fig .  </S>",
    "<S> [ figlockin](b ) to obtain unambiguous information about the magnetic field quadratures . </S>",
    "<S> the former case is sensitive to @xmath78 , whereas the latter case is sensitive to @xmath79 . as shown in fig .  </S>",
    "<S> [ figlockin](c ) , we can determine for various @xmath43 , the estimators @xmath80 where @xmath81 and thus reconstruct @xmath82 independent of the value of @xmath42 .    [ 1 ]    the phase resolution of our lock - in magnetometer is given by the sample standard error of our estimator @xmath83 from the actual value @xmath42 used in the experiment , @xmath84 which evaluates to @xmath85 for @xmath86  nt . </S>",
    "<S> for ease of data analysis in our experiments , we carried out @xmath87 and @xmath88 pea routines successively , however this can easily be modified to have both sequences alternated within one pea routine for near - simultaneous detection of the quadratures .    </S>",
    "<S> we now demonstrate two important applications of our dual - channel lock - in magnetometer . earlier work has studied the effect of random classical phase on the magnetometry performance of dd sequences  @xcite . however , these methods require theoretical assumptions on the nature of the random phase e.g. uniformly or normally distributed . in fig .  </S>",
    "<S> [ figfreq](a ) , we show that by monitoring the @xmath40 channel of our lock - in , we can observe random telegraph phase flips @xmath89 of the magnetic field . </S>",
    "<S> one physical scenario where such jumps might occur in the phase would be for measurements of single electron or nuclear spins where the spins can not be easily polarized , but will be present in one state or the other for each measurement shot . </S>",
    "<S> similarly , when nanoscale volumes of spins are measured experimentally  @xcite , one could use this protocol to verify that we sample all possible spin configurations by either periodically randomizing the ensemble or simply by waiting for long enough durations  @xcite . </S>",
    "<S> see si fig .  </S>",
    "<S> s4 for data similar to such situations .    </S>",
    "<S> [ 1 ]    our second application is for measurement of the frequency changes from the central working frequency @xmath90 . as shown in the inset to fig .  </S>",
    "<S> [ figfreq](b ) , the in - phase response of the cp sequences is symmetric around @xmath58 . </S>",
    "<S> this is a fundamental feature of the corresponding filter functions @xmath91 of these sequences in the frequency domain  @xcite . </S>",
    "<S> however , when the frequency of the magnetic field changes , we can monitor the quadrature field component and obtain phase - sensitive readout of the change . </S>",
    "<S> this occurs because for small changes in frequency @xmath92 , the field @xmath93 , and the corresponding quadrature component @xmath94 changes linearly with @xmath92 . </S>",
    "<S> normally as @xmath95 increases in the longest cp sequences , this phase change and corresponding component would be unrecoverable ( see fig .  </S>",
    "<S> [ figpea](b ) ) , but the excellent dynamic range of our method allows us to track the frequency as seen in fig .  </S>",
    "<S> [ figfreq](b ) . </S>",
    "<S> si fig .  </S>",
    "<S> s6 shows simulations of the pea when signals with equal amplitude but slightly different frequencies are used , demonstrating in principle that the pea can distinguish such signals .    </S>",
    "<S> the typical relaxation time for target nuclear spins in fluid samples at room temperature is @xmath96  secs  @xcite . </S>",
    "<S> the time constant @xmath63 for our lock - in magnetometer can be adjusted through different choices of parameters to fall within this range , as shown in the si ( fig . </S>",
    "<S> s5 ) . </S>",
    "<S> however , previously demonstrated technical improvements such as nano - fabricated photonic structures can greatly improve collection efficiency  @xcite and allow us to tune the time constant down to milleseconds , as discussed in the si .    </S>",
    "<S> lastly , we discuss again the importance of linear readout and dynamic range improvements of our technique </S>",
    "<S> . in nanoscale magnetometry and imaging , it may be possible to have some prior knowledge on the field amplitude @xmath43 , from estimates of the average number of spins and the distance from the nv sensor . </S>",
    "<S> recently , refs .  </S>",
    "<S> @xcite have reported breakthrough results in detecting nanoscale volumes of nuclear spins through dd noise spectroscopy with nv quantum sensors . </S>",
    "<S> these authors have estimated rms field amplitudes @xmath97  nt for their samples and compared the estimates with nv sensor field measurements . ref .  </S>",
    "<S> @xcite observed significant discrepancy between the measured field compared to the estimate ( @xmath98 ) , while ref .  </S>",
    "<S> @xcite used numerical modeling of the nuclear spin volumes with `` typical '' proton concentrations and other assumptions and obtained agreement at the @xmath99 level . </S>",
    "<S> it is still unclear what causes the discrepancies , although the authors postulate uncertainty in either the nv position or the number of nuclear spins in the target volume leading to imperfect knowledge of the working point . </S>",
    "<S> while a direct comparison between our work and these results is not possible , the estimated fields are close to the maximum field amplitudes sensed in our work ( see fig .  </S>",
    "<S> [ figpea](d ) ) , and certainly well above that of the much longer dd sequences used by those authors . </S>",
    "<S> since the sensitivity of the sequences crucially depends on this knowledge of the working point , we speculate that our methods might help in resolving some of these uncertainties . </S>",
    "<S> further , since there is no restriction on the phase @xmath42 of the magnetic field , the reconstruction of the field amplitude may also have significant error if the dynamic range is limited , as we showed in fig .  </S>",
    "<S> [ figpea](b ) . </S>",
    "<S> our method simultaneously resolves both the working point and phase measurement problem .    in conclusion </S>",
    "<S> , we have reported a new quantum sensing method for magnetometry with phase estimation algorithms . </S>",
    "<S> our results show significantly improved dynamic range and linearity of the readout for time - dependent magnetic fields , while preserving the increased sensitivity of dd pulse sequences . </S>",
    "<S> our method also allows for unambiguous reconstruction of the amplitude , phase , and frequency of the oscillating field , and allows us to track the phase in each measurement shot . </S>",
    "<S> this may open up the capability to study the spin configuration changes of nanoscale volumes of spins with unprecedented resolution , and also allow for the study of systems where the spins are hard to polarize and drive due to spectral and spatial diffusion .    </S>",
    "<S> this work was supported by nsf career ( dmr-0847195 ) , nsf phy-100534 , doe early career ( de - sc 0006638)and the alfred p. sloan research fellowship . </S>"
  ]
}