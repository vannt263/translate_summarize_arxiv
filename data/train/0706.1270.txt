{
  "article_text": [
    "the last three decades have seen the emergence of cosmology as `` precision science '' , moving from order of magnitude estimates , to predictions and measurements at accuracy levels better than 10% .",
    "cosmic microwave background observations and large galaxy surveys have led this advance in the understanding of the origin and evolution of the universe .",
    "future surveys promise even higher accuracy , at the one percent level , over a considerably wider dynamic range than probed earlier . in order to fully utilize the wealth of upcoming data and to address burning questions such as the dynamical nature of dark energy ( specified by the equation of state parameter @xmath0 , @xmath1 being the pressure , and @xmath2 the density )",
    ", theoretical predictions must attain at least the same level of accuracy as the observations , even higher accuracy being certainly preferable .",
    "the highly nonlinear physics at the length scales probed , combined with complicated gas physics and astrophysical feedback processes at these scales , make this endeavor a daunting task .    as a first step towards achieving the final goal ,",
    "a necessary requirement is to reach the desired accuracy for gravitational interactions alone , down to the relevant nonlinear scales .",
    "tests with exact solutions such as pancake collapse  @xcite are valuable for this task , but as shown in ref .",
    "@xcite the results do not easily translate into statements about the accuracy of different simulation algorithms in realistic cosmological simulations .",
    "exactly solvable problems are typically highly symmetric and hence somewhat artificial .",
    "codes optimized for realistic situations can break down in certain tests even if their results appear to converge in physically relevant settings .",
    "therefore , in order to evaluate the accuracy of simulation codes , a broad suite of convergence and direct code comparison tests must be carried out .",
    "the codes used in this comparison project are all well - established , and have been key drivers in obtaining numerous scientific results .",
    "they are based on different algorithms and employ different methods for error control .",
    "the code developers have already carried out careful convergence tests themselves and verified to their satisfaction that the codes yield reliable results .",
    "but because of the multi - scale complexity of the dynamical problem itself , as well as the incompleteness of most convergence tests , it is necessary to do much more . therefore , the aim here is to focus on comparing results from a suite of different codes for realistic cosmological simulations . in order to avoid uncertainties from statistical sampling",
    ", all codes are run with exactly the same initial conditions , and all results are analyzed using the same diagnostic tools .",
    "the paper is organized as follows . in section  [ codes ]",
    "we describe the ten simulation codes used for the comparison study . in section  [ sim ] we briefly describe the simulations carried out for this project .",
    "next , we introduce paraview in section  [ tools ] , one of the main analysis tools used in this work .",
    "we present our results in section  [ results ] and conclude in section  [ conclusions ] .",
    "the ten codes used in this paper cover a variety of methods and application arenas .",
    "the simulation methods employed include parallel particle - in - cell ( pic ) techniques ( the pm codes mc@xmath3 and pmm , the pm / amr codes enzo and flash ) , a hybrid of pic and direct n - body ( the ap@xmath4 m code hydra ) , tree algorithms ( the treecodes pkdgrav and hot ) , and hybrid tree - pm algorithms ( gadget-2 , tpm , and treepm ) .",
    "the pic method models many - body evolution problems by solving the equations of motion of a set of tracer particles which represent a sampling of the system phase space distribution function .",
    "a computational grid is used to increase the efficiency of the self - consistent inter - particle force calculation . to increase dynamic range , local force computations ( e.g. , p@xmath4 m , tree - pm ) and amr",
    "are often used .",
    "the grid also provides a natural basis for coupling to hydro - solvers .",
    "treecodes are based on the idea that the gravitational potential of a far - away group of particles is accurately given by a low - order multipole expansion .",
    "particles are first arranged in a hierarchical system of groups in a tree structure .",
    "computing the potential at a point turns into a descent through the tree .",
    "treecodes naturally embody an adaptive force resolution scheme without the overhead of a computational grid .",
    "tree - pm is a hybrid algorithm that combines a long - range force computation using a grid - based technique , with shorter - range force computation handled by a tree algorithm . in the following we give a brief description of each code used in this comparison study .",
    "the multi - species * m*esh - based * c*osmology * c*ode mc@xmath3 code suite includes a parallel pm solver for application to large scale structure formation problems in cosmology . in part , the code descended from parallel space - charge solvers for studying high - current charged - particle beams developed at los alamos national laboratory under a doe grand challenge  @xcite .",
    "mc@xmath3 solves the vlasov - poisson system of equations for an expanding universe using standard mass deposition and force interpolation methods allowing for periodic or open boundary conditions with second and fourth - order ( global ) symplectic time - stepping and a fast fourier transform ( fft)-based poisson solver .",
    "the results reported in this paper were obtained using cloud - in - cell ( cic ) deposition / interpolation .",
    "the overall computational scheme has proven to be remarkably accurate and efficient : relatively large time - steps are possible with exceptional energy conservation being achieved .",
    "particle - multi - mesh ( pmm )  @xcite is an improved pm algorithm that combines high mass resolution with moderate spatial resolution while being computationally fast and memory friendly .",
    "the current version utilizes a two - level mesh fft - based gravity solver where the gravitational forces are separated into long - range and short - range components .",
    "the long - range force is computed on the root - level , global mesh , much like in a pm code . to obtain higher spatial resolution ,",
    "the domain is decomposed into cubical regions and the short - range force is computed on a refinement - level , local mesh .",
    "this algorithm achieves a spatial resolution of 4 times better than a standard one - level mesh pm code at the same cost in memory . in  @xcite",
    ", pmm is shown to achieve very similar accuracy to that of mc@xmath3 when run with the same minimum grid spacing .",
    "enzo is a publicly available , extensively tested adaptive mesh refinement ( amr ) , grid - based hybrid code ( hydro + n - body ) which was originally written by greg bryan , and is now maintained by the laboratory for computational astrophysics at uc san diego  @xcite .",
    "the code was originally designed to do simulations of cosmological structure formation , but has been modified to examine turbulence , galactic star formation , and other topics of interest .",
    "enzo uses the berger & colella method of block - structured adaptive mesh refinement  @xcite .",
    "it couples an adaptive particle - mesh method for solving the equations of dark matter dynamics  @xcite with a hydro solver using the piecewise parabolic method ( ppm ) , which has been modified for cold , hypersonic astrophysical flows by the addition of a dual - energy formalism  @xcite .",
    "in addition , the code has physics packages for radiative cooling , a metagalactic ultraviolet background , star formation and feedback , primordial gas chemistry , and turbulent driving .",
    "flash  @xcite originated as an amr hydrodynamics code designed to study x - ray bursts , novae , and type  ia supernovae as part of the doe asci alliances program .",
    "block - structured adaptive mesh refinement is provided via the paramesh library  @xcite .",
    "flash uses an oct - tree refinement scheme similar to  @xcite and  @xcite .",
    "each mesh block contains the same number of zones ( @xmath5 for the runs in this paper ) , and its neighbors must be at the same level of refinement or one level higher or lower ( mesh consistency criterion ) .",
    "adjacent refinement levels are separated by a factor of two in spatial resolution .",
    "the refinement criterion used is based upon logarithmic density thresholds .",
    "numerous extensions to flash have been developed , including solvers for thermal conduction , magnetohydrodynamics , radiative cooling , self - gravity , and particle dynamics .",
    "in particular , flash now includes a multigrid solver for self - gravity and an adaptive particle - mesh solver for particle dynamics .",
    "together with the ppm hydrodynamics module , these provide the core of flash s cosmological simulation capabilities .",
    "flash uses a variable time step leapfrog integrator .",
    "in addition to other time step limiters , the flash particle module requires that particles travel no more than a fraction of a zone during a time step .",
    "this parallel tree code  @xcite has been evolving for over a decade on many platforms .",
    "the basic algorithm may be divided into several stages ( the method of error tolerance is described in  ref .",
    "first , particles are domain decomposed into spatial groups .",
    "second , a distributed tree data structure is constructed . in the main stage of the algorithm ,",
    "this tree is traversed independently in each processor , with requests for nonlocal data being generated as needed .",
    "a ` key ` is assigned to each particle , which is based on morton ordering .",
    "this maps the points in 3-dimensional space to a 1-dimensional list , maintaining as much spatial locality as possible .",
    "the domain decomposition is obtained by splitting this list into @xmath6 ( number of processors ) pieces . an efficient mechanism for latency - hiding in the tree traversal phase of",
    "the algorithm is critical . to avoid stalls during nonlocal data access ,",
    "effectively explicit ` context switching ' is done using a software queue to keep track of which computations have been put aside waiting for messages to arrive .",
    "this code architecture allows hot to perform efficiently on parallel machines with fairly high communication latencies  @xcite .",
    "hot has a global time stepping scheme .",
    "the code was among the ones used for the original santa barbara cluster comparison project  @xcite and also supports gas dynamics simulations via a smoothed particle hydrodynamics ( sph ) module  @xcite .",
    "the central data structure in pkdgrav  @xcite is a tree structure which forms the hierarchical representation of the mass distribution . unlike the more traditional oct - tree which is used in the barnes - hut algorithm  @xcite and is implemented in hot",
    ", pkdgrav uses a k - d tree , which is a binary tree .",
    "the root - cell of this tree represents the entire simulation volume .",
    "other cells represent rectangular sub - volumes that contain the mass , center - of - mass , and moments up to hexadecapole order of their enclosed regions .",
    "pkdgrav calculates the gravitational accelerations using the well known tree - walking procedure of the barnes - hut algorithm .",
    "periodic boundary conditions are implemented via the ewald summation technique  @xcite .",
    "pkdgrav uses adaptive time stepping .",
    "it runs efficiently on very large parallel computers and has produced some of the world s highest resolution simulations of cosmic structures . a hydrodynamics extension called gasoline exists .",
    "hydra  @xcite is an adaptive p@xmath4 m ( ap@xmath4 m ) code with additional sph capability . in this paper",
    "we use hydra only in the collisionless mode by switching off gas dynamics .",
    "the p@xmath4 m method combines mesh force calculations with direct summation of inter - particle forces on scales of two to three grid spacings . in regions of strong clustering",
    ", the direct force calculations can become significantly expensive . in ap@xmath4 m",
    ", this problem is tackled by utilizing multiple levels of subgrids in these high density regions , with direct force computations carried out on two to three spacings of the higher - resolution meshes .",
    "two different boundary conditions are implemented in hydra , periodic and isolated .",
    "the time step algorithm in the dark matter - only mode is equivalent to a leapfrog algorithm .",
    "the n - body / sph code gadget-2 @xcite employs a tree method @xcite , to calculate gravitational forces .",
    "optionally , the code uses a tree - pm algorithm based on an explicit split in fourier space between long - range and short - range forces @xcite .",
    "this combination provides high performance while still retaining the full spatial adaptivity of the tree algorithm , allowing the code to reach high spatial resolution throughout a large volume . by default",
    ", gadget-2 expands the tree multipoles only to monopole order , in favor of a compact tree storage , a cache - optimized tree - walk , and consistent and efficient dynamic tree updates . the cell - opening criterion used in the tree walk is based on an estimator for the relative force error introduced by a given particle - cell interaction , such that the tree force is accurate up to a prescribed maximum relative force error .",
    "the latter can be lowered arbitrarily , if desired , at the expense of higher calculation times .",
    "the pm part of gadget-2 solves poisson s equation on a mesh with standard fast fourier transforms , based on a cic mass assignment and a four - point finite differencing scheme to compute the gravitational forces from the potential .",
    "the smoothing effects of grid assignment and interpolation are corrected by an appropriate deconvolution in fourier space .",
    "the time - stepping of gadget-2 uses a leap - frog integrator which is symplectic in case constant timesteps ( in the log of the expansion factor ) are employed for all particles .",
    "however , the code is normally run in a mode where individual and adaptive timesteps are used to speed up the calculation time . to this end",
    ", the timesteps for the short - range dynamics are allowed to freely adapt to any power of two subdivision of the long - range timestep .",
    "gadget-2 is fully parallelized for massively parallel computers with distributed memory , based on the mpi standard .",
    "the code can also be used to simulate hydrodynamical processes using the particle - based smoothed particles hydrodynamics ( sph ) method ( e.g.  @xcite ) , in an entropy conserving formulation @xcite , a feature which is however not exercised in the simulations considered in this paper .",
    "tpm  @xcite is a publicly - available hybrid code combining a pm and a tree algorithm .",
    "the density field is broken down into many isolated high - density regions using a density threshold criterion .",
    "these contain most of the mass in the simulation but only a small fraction of the volume . in these regions ,",
    "the gravitational forces are computed with the tree algorithm while for the bulk of the volume the forces are calculated via a pm algorithm , the pm time steps being large compared to the time - steps for the tree - algorithm .",
    "the pm algorithm uses the cic deposition / interpolation scheme and solves the poisson equation using ffts.the time integrator in tpm is a standard leap - frog scheme : the pm time steps are fixed whereas tree particles have individual time steps , half of the pm step or smaller .",
    "the algorithmic structure of the treepm code  @xcite is very similar to gadget-2 .",
    "the particles are integrated using a second - order leap - frog method , with position and canonical momentum as the variables .",
    "the time step is dynamically chosen as a small fraction ( depending on the smoothing length ) of the local free - fall time and particles have individual time steps .",
    "the force on any given particle is computed in two stages .",
    "the long - range component of the force is computed using the pm method , while the short range component is computed from a global tree .",
    "a spline softened force law is used .",
    "the tree expands forces to monopole order only , and cells are opened based upon the more conservative of a geometric and relative force error criterion .",
    "the pm force is computed by direct fft of the density grid obtained from cic mass assignment .",
    "a previous code comparison suite  @xcite considered three cosmological test problems : the santa barbara cluster  @xcite , and two large - scale structure simulations of @xmath7cdm models in a 64@xmath8mpc box and a 256@xmath8mpc box . in the latter two cases , the primary target of this previous work was to investigate results in a medium resolution regime , addressing statistical quantities such as the two - point correlation function , the density fluctuation power spectrum , and the dark matter halo mass function .    in this paper",
    "we focus further attention on one of these tests , the smaller of the @xmath7cdm boxes . due to the small box size ,",
    "the force resolution of all codes  including the pure mesh codes  is in principle sufficient to analyze properties of individual halos themselves .",
    "this allows us to extend the dynamic range of the code comparison to higher resolution than studied earlier . in this new regime",
    ", we expect to see a much broader divergence of results because of the more demanding nature of the test .",
    "( even in the previous analysis  @xcite , the power spectrum was unexpectedly deviant at the larger wavenumbers considered . ) our aim is to characterize the discrepancies and attempt to understand the underlying causes .",
    "all codes were given exactly the same particle initial conditions at a redshift @xmath9 .",
    "the initial linear power spectrum was generated using a fit to the transfer function  @xcite , a modification of the bbks fit  @xcite .",
    "this fit does not capture baryon oscillations but takes baryonic suppression into account ( these details are of only limited relevance for the test ) .",
    "the cosmology underlying the simulations is given by @xmath10 , @xmath11 , @xmath12 , @xmath13 , @xmath14 , and @xmath15 .",
    "the simulation was run with 256@xmath4 particles , which leads to an individual particle mass of @xmath16=1.362@xmath17m@xmath18 .    while performing a comprehensive code comparison study which involves very different algorithms  such as grid and particle - based methods in the present case ",
    "a central and difficult question immediately arises : what is the most informative way to compare the codes and learn from the results ?",
    "the difficulty is compounded by the fact that codes are often optimized under different criteria and controlling numerical error is a complex multi - parameter problem in any case , even for codes that share the same general underlying algorithm .    as a case in point ,",
    "let us consider the choice of force resolution for each code .",
    "( since the volume and number of particles are fixed , the mass resolution is the same for each run . )",
    "one option would be to run all codes with the same formal force resolution but this , aside from wasting resolution for the high - resolution codes , also suffers from the problem that it is not easy to compare resolutions across different algorithms ; moreover , time - stepping errors also must be folded into these sorts of estimates .",
    "finally , such a comparison would be rather uninteresting , because realistic cosmological simulations are run with higher resolutions than would be possible in a conservative test of this type : interesting effects on small scales would be missed .",
    "a more uncontrolled , but nevertheless useful option is to allow every simulator to run her or his code with close to the optimal settings they would also use for a scientific run ( given the other restrictions imposed by the test problem ) . in this case",
    ", a more realistic comparison can be performed in which we can access the robustness of conclusions from cosmological simulations . here , while our approach adheres more closely to the second strategy , we do try to assess at what length scales one should expect a specific code to break down assuming that the resolution of the code is accurately estimated by the simulator .",
    "cccccccccc mc@xmath3 & pmm & enzo & flash & hot & pkdgrav & hydra & gadget-2 & tpm & treepm + 62.5 & 62.5 & 62.5 & 62.5 & 7.1 & 1.6 & 28.4 & 7.1 & 5.1 & 5.7 +    the nominal resolutions for the different codes for the performed runs are as given in table  [ tab1 ] .",
    "we have converted the different softening kernels into plummer equivalents following the normalization conventions of ref .",
    "we have matched the different softening kernels @xmath19 at zero and compared them at this point . with the normalization conventions in ref .",
    "@xcite , we find : @xmath20 where @xmath21 is the softening length .",
    "the grid resolution of the pm and amr codes is roughly equivalent to the plummer softening .",
    "hot and hydra have plummer force kernels implemented , pkdgrav uses dehnen s k@xmath22 kernel  @xcite and the three tree - pm codes use spline kernels . with the above definitions , it is easy to convert the spline and k@xmath22 kernels into plummer via @xmath23 which we used to standardize the force resolution quotes in table  [ tab1 ] .",
    "we note that some of the codes below could have been run at higher resolution , and the values below should not be thought of as resolution limits .",
    "in fact , the choices of these values represent compromises due to run time considerations as well as a ( loosely ) pre - planned scatter to try and determine the effects of force resolution on the simulation results .",
    "broadly speaking , the major aim of our code comparison project is to characterize differences in results from large cosmological simulation codes , identify the causes underlying these differences , and , if possible , develop strategies to reduce or eliminate the differences in order to obtain reliable results over large length and mass scales . if it is not possible to eliminate some of the differences , e.g. due to insufficient force resolution in grid codes , it is still important to provide robust criteria that correctly determine the scales at which the code can be trusted , and with what accuracy .",
    "the identification and characterization of differences in code results is not as straightforward as it first appears .",
    "certainly we may , and do , compare standard statistical quantities such as low - order correlation functions . however , there is much more information in the data beyond this , e.g. , large - scale structure morphology , substructure in the density field , and subtle features such as the variation in halo bias as a function of the local environment . for these reasons , it is often very useful to simply _ look _ at the region or object of interest in the simulation and compare it across the different codes . following this qualitative comparison ",
    "perhaps even inspired by it ",
    "the aim is to construct a hypothesis about the cause for the perceived difference which then has to be carefully tested with quantitative measures .",
    "it is very desirable to have a framework which combines these two steps in a convenient , and eventually seamless , manner .",
    "the framework should allow differences and anomalies picked up by eye from data sets to be immediately queried and quantified using a programmable toolkit .",
    "an example relevant to cosmological simulations is the following .",
    "suppose we `` see '' fewer halos in one simulation compared to another .",
    "the analysis tool should then provide quantitative information of the following type : in what areas is the difference larger , what is the exact number count of the halos in this region , what is the difference in the environment ( e.g. by comparing the local density in the two codes ) , what is the halo history in the region , and so on .    as part of this paper",
    "we include an introduction of paraview  @xcite   to the cosmology and the wider computational communities .",
    "paraview has some of the features discussed above built in and allows the user to implement additional analysis tools .",
    "paraview is an open - source , scalable visualization tool which is designed as a layered architecture .",
    "the foundation and first layer of paraview is the visualization toolkit ( vtk ) .",
    "vtk provides data representations , algorithms , and a mechanism to interconnect these to form a working program .",
    "the second layer is a parallel extension to the visualization toolkit which supports streaming of all data types and parallel execution on shared and distributed memory machines .",
    "the third layer is paraview itself .",
    "paraview provides a graphical user interface and transparently supports the visualization and rendering of large datasets via hardware acceleration , parallelism , and level - of - detail techniques .",
    "for the code comparison project we have implemented a particle reader which works with the data format used throughout this paper .",
    "this allows other simulators who wish to test their codes against our results to use exactly the same analysis tool .",
    "as explained later , we have also implemented a diverse set of diagnostic tools relevant for cosmological simulations . these help to ease the analysis of large simulation data sets and make it more efficient .",
    "we plan to extend the set of available analysis features in the near future .",
    "as an initial test , a simple view of the simulation output at @xmath24 proves to be very useful .",
    "paraview offers a comparative visualization option in which the results from different simulations can be shown simultaneously .",
    "manipulation on any one output in this mode results in the same manipulation for all the others .",
    "paraview allows fly - ins , rotation of the box , projections , and has many more features which make it convenient to inspect the outcome of the simulation .",
    "a screenshot of the comparative visualization manager is displayed in figure  [ snap ]  a zoom into an arbitrary region of the simulation box showing simultaneous results from four different codes . in the upper row",
    "a subset of the particles is shown as arrow glyphs , colored by velocity magnitude , the lower row shows the particles as dots with the same coloring scheme .",
    "a quick inspection of these snapshots reveals that the code 2 run had a problem with the velocities and code 4 had slightly incorrect boundary conditions ( the whole picture being shifted upward ) .",
    "( of course these initial bugs were fixed before going on to the final results discussed below ! )    figure  [ fig : box ] shows a comparison of the final gadget-2 and enzo outputs .",
    "we show a subsample of 20,000 particles , each displayed with vector arrow glyphs , sized and colored by their velocity magnitude .",
    "the arrow glyphs nicely represent the flows in the box to the major mass concentrations . as to be expected , particles in the field are slow ( blue ) , while the particles in the halos have the largest velocities ( yellow to red ) .",
    "while the overall appearance of both simulations shown is very similar , subtle differences can be seen ( e.g. , there are no small structures in the flow regions in the enzo simulations ) , indicating the higher resolution employed in the gadget-2 run .",
    "( five of the biggest halos in the simulation will be examined in more detail below , the resolution differences becoming significantly more apparent . )",
    "the halo paradigm is central to any large - scale structure analysis ; dark matter in simulations , discretized in the form of heavy collisionless particles , forms clearly visible filaments ( stripes ) and halos ( clumps of dark matter ) through the process of gravitational instability .",
    "figure  [ fig : box ] shows these structures clearly for the simulations studied in this paper .",
    "this picture agrees well with observations of galaxy rotation curves , and velocity dispersions of galaxies in clusters which favor scenarios where luminous , baryonic matter is embedded in massive , extended , and close to spherical conglomerates of dark matter . in simulations , dark matter halos can be identified and `` weighed '' in different ways .",
    "we can measure overdensities ( see e.g.  @xcite ) or use group finding algorithms such as friend - of - friend ( fof ) algorithms  @xcite to find halos .",
    "a remarkable feature of halos was found by navarro , frenk , and white  @xcite : dark matter halos of all masses , from dwarf galaxies to the largest clusters of galaxies , have spherically - averaged density profiles that are well - described by a single , `` universal '' formula @xmath25 the scaling radius , @xmath26 , and characteristic overdensity , @xmath27 , are free parameters of the model , while @xmath28 is the critical density for closure of the universe . even though a theoretical explanation for this universal profile has not been found",
    ", the nature of the profile itself has received extensive support from simulations carried out by many different groups  @xcite ( there do remain questions about the behavior at very small radii , but these are not relevant here ) .",
    "here we are interested in the variation of the profiles produced by the different codes , tending towards the outer region of the halo .",
    "this variation may be significant for determining halo masses via the often used fof algorithm .",
    "the mass that the halo finder will `` see '' , strongly depends on the density and density gradient close to the virial radius ( @xmath29 ) of a halo . on the other hand , accurately reproducing the inner slope of a halo profile is the prime test of the code s force resolution . on scales below this resolution",
    "limit , particle positions get randomized , resulting in a flattened density profile ( numerical errors can also lead to a sharpening of the profile due to an associated unphysical damping ) .",
    "we first compare the five heaviest halos from the simulations ; their masses range between approximately 2 to @xmath30 , thus each halo is sampled with 150,000 or more particles .",
    "the individual halo masses ( as found by the fof algorithm ) are in agreement within 3% for all ten codes .",
    "note that the fof masses found for the grid codes are slightly higher .",
    "this is presumably due to their lower resolution in this comparison , resulting in less tight halos .",
    "the fof halo finder can identify more particles in the fuzzier outskirts of lower resolution simulations as belonging to the halo than in the high resolution runs .",
    "the centers of the halos are defined by the minimum of the local potential of the halo . here",
    "the agreement among the codes is even better than for the masses  the difference is less than 0.5% of the box size . in table",
    "[ tab2 ] we show the center and mass of one of the halos , halo 3 .",
    "this halo ( also shown in figure  [ halo3d ] ) has the size and mass of a group of galaxies .",
    "the dispersion in the mass and position of the center is similar for the other halos , whose profiles we investigate next .",
    "c | c c c c code & @xmath31 [ kpc / h ] & @xmath32 [ kpc / h ] & @xmath33 [ kpc / h ] & mass [ @xmath34 m@xmath35/h ] + mc@xmath3 & -86.23 & 158.81 & -14.68 & 2.749 + pmm & 201.68 & 33.90 & 10.24 & 2.757 + enzo & -21.36 & 45.16 & 11.36 & 2.745 + flash & -41.66 & -22.56 & -23.10 & 2.726 + hot & -30.02 & -120.54 & 43.99 & 2.720 + pkdgrav & 38.58 & 52.19 & -43.98 & 2.679 + hydra & 19.91 & -28.29 & 0.77 & 2.721 + & -27.08 & -59.00 & -0.70 & 2.705 + tpm & -36.37 & -35.09 & 1.04 & 2.697 + treepm & -17.45 & -24.62 & 13.63 & 2.727 +    in figure  [ profiles ] we present the spherically averaged density profiles for the five heaviest halos in the simulation . as an arbitrary reference",
    ", the black line represents the best nfw fit ( equation  [ eqn : nfw ] ) for the tpm data .",
    "the fit is shown up to the inner 10 @xmath8kpc of each halo .",
    "in addition , we show two residual panels for each halo profile . the upper panel shows the ratio of all codes with respect to gadget-2 , while the lower panel shows only the four grid codes and ratios with respect to mc@xmath3 .",
    "the agreement in the outer part of the halos is excellent .",
    "as expected , the codes exhibit different behaviors on small scales ( depending on their force resolution and time - stepping ) , thus the inner parts of halos are not always the same .",
    "while the high resolution codes successfully track the profile all the way in to the plotting limits of figure  [ profiles ] , the profiles from the mesh codes depart much earlier ( 60 - 100 @xmath8kpc ) , with approximately constant density in the core .",
    "the onset of the flattening is consistent with the nominal resolution of the grid codes , which is given in table .",
    "note that among the mesh codes there is no significant difference between the fixed mesh codes which ran at the highest resolution throughout the whole simulation volume , and the amr codes whose base mesh spacing is a factor of 4 times lower .",
    "we now study three of the five halos in more detail , restricting attention to particles within a sphere of radius @xmath36 .",
    "the profiles of the largest halo , halo 1 , shown in figure  [ profiles ] , agree well down to @xmath37mpc ; at smaller scales the finite resolution of the grid codes becomes apparent .",
    "nevertheless , the grid codes and the high - resolution codes among themselves yield very consistent results .",
    "figure  [ halo1 ] shows the density of halo 1 for the lower resolution code pmm and the higher resolution code treepm in two - dimensional projection .",
    "the two - dimensional density field is computed on a 100@xmath38100 grid within the @xmath36 region , projected onto the @xmath39-direction ( another projection along the @xmath40-direction is also shown ) .",
    "the projected density field has been normalized by dividing out the mean density in this area .",
    "the mean density is very close across the different codes , hence the normalization allows for direct comparisons of the projected density fields .",
    "as mentioned earlier , the positions of the halo centers ( density peaks ) are in remarkably good agreement . due to its higher resolution , the density in the center of the halo from the treepm run is slightly higher ( as to be expected from the profiles ) .",
    "in addition , treepm shows slightly more substructure on the outskirts of the halo , displayed by the small `` hills '' .",
    "overall , the halo is very smooth and well defined , which is reflected in the good agreement of the profiles .",
    "the density plots for the four grid codes are very similar .",
    "the small structures around the halo in the other codes also show only very minor variations , thus the pmm and treepm results can be considered to be representative .",
    "the profiles of halo 3 show substantially more variation among the different codes in the inner region , relative to the other four halos . studying it in more detail",
    ", we first investigate a subset of four codes : mc@xmath3 , flash , gadget-2 , and hot , covering a wide range of force resolutions . in figure  [ halo3b ]",
    "we show a zoom into the center of the halo .",
    "the particles are shown in white .",
    "superimposed on the particle distribution is a 2-dimensional density contour evaluated on a 100@xmath38100 grid and smoothed with a gaussian filter , projected along the @xmath39-direction .",
    "( the contouring and filtering are intrinsic functions in paraview . around a given splat point",
    "@xmath1 is given by @xmath41 where @xmath40 is the current voxel sample point ; @xmath42 is the distance @xmath43 , exponentfactor @xmath44 0.0 , and scalefactor can be multiplied by the scalar value of the point @xmath1 that is currently being splatted .",
    "if points normals are present ( and normalwarping is on ) , then the splat function becomes elliptical ( as compared to the spherical one described by the previous equation ) .",
    "the gaussian distribution function then becomes : @xmath45 where @xmath46 is a user - defined eccentricity factor that controls the elliptical shape of the splat ; @xmath39 is the distance of the current voxel sample point along normal @xmath47 ; and @xmath48 is the distance of @xmath40 in the direction perpendicular to @xmath47 .",
    "this class is typically used to convert point - valued distributions into a volume representation .",
    "the volume is then usually iso - surfaced or volume rendered to generate a visualization .",
    "it can be used to create surfaces from point distributions , or to create structure ( i.e. , topology ) when none exists . ] )    the overall appearance of the halo is remarkably similar between the codes , a major feature of the halo being its irregular shape .",
    "the left side of the halo is elongated and a second major peak has developed on the right , leading o a triangular shape in this projection .",
    "this irregularity ( seen also very clearly in figure  [ halo3splash ] ) is most likely the reason for the disagreement in the inner part of the profiles .",
    "the halo has probably undergone a recent merger or is in the process of merging .",
    "comparing the lower resolution runs from mc@xmath3 and flash with gadget-2 and hot , the effect of force resolution is very apparent , the high resolution runs producing significantly more substructure .",
    "gadget-2 shows slightly more substructure than hot , which could be due to the adaptive time stepping used in the gadget-2 run relative to hot s global time - step .",
    "figure  [ halo3d ] shows halo 3 from the remaining six runs . as in figure",
    "[ halo1 ] , the two - dimensional density is shown on a 100@xmath38100 grid .",
    "the three - dimensional view underlines the rather complicated structure of the halo .",
    "pmm and enzo show the elongated structure with two maxima , whereas the hydra and pkdgrav results differ somewhat from the other codes . they have a more well defined peak and do not exhibit much of the second structure .",
    "treepm and tpm are very similar to gadget-2 and hot .",
    "overall , halo 3 has much more interesting features than halo 1 , which leads to slight discrepancies in the halo profiles among the codes .",
    "last , we study halo 4 from a subset of the codes : mc@xmath3 , gadget-2 , pkdgrav , and hot , covering the grid , tree - pm , and tree codes . the results are shown in figure  [ halo4 ] .",
    "as before , the lower density of the pm code is due to its restricted resolution .",
    "overall , the agreement is again very satisfying .",
    "the centers of the halos are in excellent agreement , and all four runs show a smaller structure on the left of the main halo .",
    "the exact details of the smallest structures are different which could be due to inaccurate time - stepping and discrepancies in the codes output redshifts .",
    "overall , the comparison of the largest halos in the box is very satisfactory .",
    "the halo profiles agree on the scales expected from the code resolutions .",
    "differences of the inner parts can be explained due to very irregular shapes as in halo 3 .",
    "the reader should keep in mind that we did not resimulate the halos with higher resolution , and that these halos ere extracted straight out of a cosmological volume simulation .",
    "therefore , the level of agreement is in accord with theoretical expectations .",
    "an important statistic in cosmology is the number count of halos as a function of mass , the so - called mass function .",
    "the mass function of clusters of galaxies from ongoing and upcoming surveys can provide strong constraints on dark energy  @xcite .",
    "numerous studies have been carried out to predict the mass function theoretically  @xcite . because halo formation is a strongly nonlinear dynamical process , the approximations underlying analytic predictions limit the attainable accuracy for constraining cosmological parameters .",
    "nevertheless , some of these analyses can help to understand the origin and qualitative behavior of the mass function .    in order to obtain more precise predictions ,",
    "several groups have carried out large n - body simulations to find accurate fits for the mass function  @xcite .",
    "in addition , the evolution of the mass function has been studied in detail  @xcite .",
    "the numerical study of the mass function poses several challenges to the simulation code , especially if one wants to obtain reliable results at the few percent accuracy level : the number of particles in a halo has to be sufficient in order to prevent systematic biases in determinations of the halo mass  @xcite , the force resolution has to be adequate to capture the halos of interest  @xcite , the simulation has to be started at sufficiently high redshift  @xcite , and finite box corrections might have to be considered if the simulation box is small  @xcite ( for a comprehensive study of possible systematic errors in simulating the mass function and its evolution , see  @xcite )",
    ".    mass function at @xmath24 , simulation results and the warren fit ( red line ) .",
    "lower panel : residuals with respect to the warren fit . for clarity we only show the error bars for one code .",
    "the dashed line indicates the threshold for 40 particles ( force resolution limit for the pm codes , according to equation  ( [ resol ] ) ) , the dotted - dashed line for 2500 particles ( force resolution limit for the base grid of the amr codes ) . ,",
    "width=264 ]    in this paper we study the mass function at @xmath24 .",
    "we identify halos with a friends - of - friends ( fof ) algorithm  @xcite with linking length of @xmath49 .",
    "the smallest halo we consider has 10 particles , not because this is physically reasonable ( usually the minimum number of particles is several times bigger ) , but because we are interested in cross - code comparison .",
    "we follow the suggestions by warren et al .",
    "@xcite and correct the halo mass for possible undersampling via : @xmath50 where @xmath51 is the number of particles in a halo .",
    "this correction lowers the masses of small mass halos considerably .",
    "in order for small halos to be resolved , both mass and force resolution must be adequate . in ref .",
    "@xcite , resolution criteria for the force resolution are derived : @xmath52^{1/3},\\ ] ] with @xmath53 being the force resolution , @xmath54 being the interparticle spacing , and @xmath55 the matter content of the universe at a given redshift .",
    "equation  ( [ resol ] ) predicts that all the non - grid codes have enough force resolution to resolve the smallest halos considered , while the two pm codes , mc@xmath3 and pmm , have sufficient force resolution to resolve halos with more than 40 particles , and that the base grid of the two amr codes restricts them to capturing halos with more than 2500 particles .",
    "of course this is only a rough estimate in principle since the amr codes increase their local resolution as a function of density threshold , the question is whether the criteria used for this is sufficient to resolve halos starting at 40 particles / halo .",
    "we have indicated the resolution restrictions in figure  [ massf ] by vertical lines ( dashed : 40 particles , dashed - dotted : 2500 particles ) .",
    "the predictions are good indicators of actual code results .",
    "the amr codes fall off at slightly lower masses than given by 2500 particles .",
    "this shows that the resolution which determines the smallest halos being captured is dictated by the base grid of the amr codes and not by the highest resolution achieved after refinement .",
    "thus , for the amr codes to achieve good results , significantly more aggressive density thresholding appears to be indicated .",
    "( similar results were found in refs .",
    "as predicted , the mass functions of the pm codes start to deviate at around 40 particles from the other codes .",
    "overall the agreement among the codes is very good . for comparison",
    ", we show the warren fit  @xcite in red . due to limited statistics imposed by the small box - size ,",
    "the purpose here is not to check the accuracy of the fitting function . at the high mass end ,",
    "the scatter is as expected due to the rareness of high - mass halos . in the medium mass range between @xmath56 and @xmath57m@xmath18",
    "all codes agree remarkably well , down to the percent level . in the small halo regime with as low as 40 particles , the agreement of the codes  besides the amr codes as explained above",
    " stays at this level .",
    "this indicates that the halo mass function is a very robust statistic and the simple resolution arguments given above can reliably predict the halo mass limits of the individual simulations .",
    "the comparison yields one surprising result , however : the tpm code simulation has far fewer halos in the regime below 40 particles per halo than the other high resolution codes .",
    "this finding was already pointed out in ref .",
    "@xcite . in order to understand this deficit of halos in more detail we investigate the halo count as a function of environment in the following .      in this section",
    "we use paraview again as the main analysis tool .",
    "one very attractive feature of paraview is a suite of filter functions .",
    "these filters allow direct manipulation of the data that is visualized .",
    "they include functions such as fast fourier transforms , smoothing routines via gaussian filtering ( which we used in the previous section ) , and tesselation routines , to name a few .",
    "we have implemented additional routines to find halos ( a fully parallel fof halo finder integrated into paraview is under development ) and to calculate densities from the particle distribution in order to cross - correlate density with halo counts .",
    "we have also added an interface to the plotting program gnuplot .    in the last section we investigated the mass function and discovered a discrepancy of small halos in the two amr codes and tpm .",
    "the hypothesis for the halo deficit in the amr codes is , as discussed above , that the base grid resolution is too low and allows us only to catch halos with more than 2500 particles accurately .",
    "the coarse base grid in the initial state of the simulation does not allow for small halos to form and these halos can not be recovered in the end .",
    "this would imply that the amr simulations should have a deficit of small halos more or less independent of density : small halos should be missing everywhere , even in the highest refinement regions .",
    "a possible explanation for the missing halos in the tpm simulation could be a hand - over problem between the pm and the tree code .",
    "in this case , the number of small halos in high density regions should be correct .",
    "a qualitative comparison of three codes ( hot , mc@xmath3 , and tpm ) is shown in figure  [ fig : smallhalos ] .",
    "the red points show halos with 10 particles , the white dots are a subset of the simulation particles .",
    "it is immediately obvious , that the halo counts in different environments , close to the large halo on the right , or on in the lower density regions on the left , are different . after this qualitative result",
    ", we have to quantify this finding in order to come to a reliable conclusion about the cause for the halo deficits .",
    "we use the vtk toolkit to implement a routine that calculates the density field on a ( variable ) grid from the particle distribution via a nearest grid point ( ngp ) algorithm . the grid size for the density field",
    "is usually set by the requirement that the density field be not too noisy . as a first check",
    "we compare the density probability distribution function ( pdf ) for the different codes .",
    "it is clear that , if the grid for calculating the density is chosen coarse enough , details should be smoothed out and the pdfs for the different codes should be in good agreement . in figure",
    "[ fig : pdf ] we show the pdfs for all codes calculated on a @xmath58 grid ( left panel ) corresponding to a smoothing scale of 2@xmath8mpc and a @xmath59 grid ( right panel ) corresponding to a smoothing scale of 1@xmath8mpc . in both cases",
    "all codes agree extremely well , as to be expected since the smoothing scales are well beyond the code resolutions .",
    "we confirmed that this result holds also for finer grids , up to 256@xmath4 , which corresponds to the lowest resolution in the amr codes enzo and flash .",
    "the average number of particles in a grid cell @xmath60 on the left panel is 512 particles per cell , in the right panel 64 particles per cell .",
    "if we define the density contrast @xmath61 and define void ( highly underdense ) regions as regions with a density contrast @xmath62 , we find @xmath63 for the left panel and @xmath64 for the right panel . in both cases ,",
    "this threshold is on the right of the maximum of the curves  a large fraction of the simulation volume is underdense .",
    "next we investigate the correlation of the numbers of halos with density ( measured by the number of particles per grid cell on a @xmath58 grid ) .",
    "the results for six codes are shown in figure  [ corr ] .",
    "the results for the four other codes are very similar compared to the codes using the same algorithm ( e.g. the flash result is very close to the enzo result ) .",
    "the scatter plots show three different mass bins : very light halos ( 10 - 40 particles ) in red , medium mass halos ( 41 - 2500 particles ) in green , and the heaviest halos in the simulations ( 2500 and more particles ) in blue .",
    "these thresholds were chosen because , as discussed earlier , the force resolution of mc@xmath3 and pmm should be sufficient to resolve halos with more than 40 particles , while enzo s and flash s base grid set this limit to more than 2500 particles .",
    "the green and blue crosses are slightly shifted upward to make all points visible .",
    "the cut - offs on the left of the scatter plots are easy to understand : a certain minimum density is required to have a halo of a certain size and a certain number of halos , e.g. 50 small halos can not live in an underdense cell .",
    "enzo and tpm show the largest deficit of halos , confirming the mass function results .",
    "the small halos in enzo are mainly missing in the low density regions , and below @xmath65 there are almost no halos .",
    "tpm has a very large deficit between 1,000 - 10,000 particles per cell , corresponding to a density contrast @xmath66 between 1 and 20 .",
    "this confirms the visual impression from figure  [ fig : smallhalos ] .",
    "the overall agreement especially for the larger halos is very good .",
    "the largest halo ( blue cross on the far right ) seems to be surrounded by a large number of small halos , consistent among all codes .    to cast the results from figure  [ corr ] in a more quantitative light , figure  [ fig : histo ]",
    "displays the distribution of halos with respect to density for the two lower mass bins . from figure  [ corr ]",
    "we can read off the density range of interest for each mass bin , i.e. the density range with the largest halo population .",
    "we restrict our investigations to a density threshold of up to 100,000 particles per cell .",
    "figure  [ fig : histo ] shows the results for 10 - 40 particle ( left panel ) and 41 - 2500 particle halos ( right panel ) .",
    "the lower panels show the residuals with respect to gadget-2 .",
    "( we have verified that the agreement for larger halos between the ten codes is very good as expected from figure  [ corr ] . )",
    "the two amr codes enzo and flash have a deficit for both halo sizes over most of the density region .",
    "they only catch up with the other codes at around 10,000 particles per cell , in agreement with the our previous argument that whether halos are resolvable by the amr codes or not is dictated by the size of the base grid . in terms of capturing smaller halos , the refinement only helps in very high density regions .",
    "the result for the tpm simulation is somewhat paradoxical : in the low density region the result for the small halos agrees well with the other high - resolution codes , however , tpm misses a very large number of small halos in the region between 200 and 10,000 particles per cell , the curve falling even below the amr codes .",
    "this suggests that the problem of the tpm code is not due to the threshold criterion for the tree but perhaps due to a hand - over problem between the grid and the tree .",
    "the two pm codes have slightly lower numbers of very small halos , in good agreement with the prediction that they only resolve halos with more than 40 particles .",
    "the agreement between mc@xmath3 and pmm itself is excellent .",
    "the treepm code shows a slight excess of small halos compared to the other high - resolution codes .",
    "this excess vanishes completely if the cut for the small halos is chosen to be 20 particles instead of 10 particles for the smallest allowed halo .",
    "this indicates a slightly higher force resolution in the treepm run compared to the other runs .",
    "the agreement for the medium size halos ( left panel ) is very good , except for the amr codes . for the medium size halos ,",
    "the tpm code again shows a slight deficit of halos in the medium density regime , but far less pronounced than for the small halos .",
    "the overall agreement of the high - resolution codes is very good , as is to be expected from the mass function results .",
    "the matter power spectrum is one of the most important statistics for precision cosmology . upcoming weak lensing surveys promise measurements of the power spectrum at the one percent accuracy level out to length scales of @xmath67mpc@xmath68 ( for an overview of the requirements for the accuracy of predictions for future lensing surveys , see , e.g. , ref .",
    "this poses a severe theoretical challenge : predicting the matter power spectrum at the same level of accuracy . a first step for showing that this is possible is to investigate",
    "how well the matter power spectrum can be predicted from pure dark matter simulations , baryonic physics being included as a second step .",
    "it has already been shown that at the length scales of interest , hydrodynamic effects can alter the matter power spectrum at up to 10 percent  @xcite . in this paper",
    "we concentrate on the first step and determine how well a diverse set of n - body codes agree with each other for the prediction of the matter power spectrum . in future work we aim to predict the dark matter power spectrum at @xmath69mpc@xmath68 at the level of one percent accuracy or better .",
    "this will include a detailed analysis of the accuracy of the initial conditions as well as of the nonlinear evolution , a task beyond the scope of the current paper .",
    "power spectrum results and the residuals for the different codes .",
    "upper panel : comparison of the different power spectra .",
    "middle panel : residuals of all codes with respect to gadget-2 .",
    "lower panel : residuals of the mesh codes with respect to mc@xmath3.,width=453 ]    we determine the matter power spectrum by generating the density field from the particles via a cloud - in - cell ( cic ) routine on a 1024@xmath4 spatial grid and then obtain the density in @xmath70-space by applying a 1024@xmath4 fft .",
    "the square of the @xmath70-space density yields the power spectrum : @xmath71 .",
    "the cic routine introduces a filter at small length scale .",
    "we compensate for this filtering artifact by deconvolving the @xmath70-space density with a cic window function .",
    "the results for the different codes are shown in figure  [ pow ] .",
    "note that the box size of @xmath72mpc is too small for a realistic cosmological power spectrum calculation , as the largest modes in the box no longer evolve linearly .",
    "this leads to an incorrect onset of the nonlinear turn - over in the power spectrum .",
    "nevertheless , the comparison of the different codes is very informative .",
    "the upper panel in figure  [ pow ] shows the results for the power spectra themselves .",
    "the lower resolution of the grid codes is very apparent , their results falling away at @xmath73mpc@xmath68 .",
    "the middle panel shows the residuals of all codes with respect to gadget-2 .",
    "all codes agree at roughly 1% out to @xmath74mpc@xmath68 .",
    "pkdgrav shows small scatter in the linear regime .",
    "this might be caused by imprecise periodic boundary conditions , which are not as easy to implement in tree codes as they are for grid codes .",
    "the high - resolution codes agree to better than 5% out to @xmath67mpc@xmath68 . at that point",
    "hot and hydra lose power , while pkdgrav , tpm , and treepm show slightly enhanced power compared to the gadget-2 run .",
    "the formal force resolutions of the codes would suggest that the different runs ( including the grid runs ) should agree much better at the wavenumbers shown .",
    "the 1024@xmath4 fft used to generate the power spectra is far below the resolution of the non - grid codes and at the resolution limit of the amr and pm codes . the discrepancy might be due to several reasons : the number of time steps , the accuracy of the force solvers , the accuracy of reaching @xmath24 at the end of each run , just to suggest a few . a more detailed study of the power spectrum including larger simulation boxes is certainly required to obtain the desired accuracy for upcoming surveys . in the lower panel we show a comparison of the grid codes only , with respect to mc@xmath3 .",
    "the two pure pm codes , mc@xmath3 and pmm agree remarkably well over the whole @xmath70-range under consideration , the difference being below 1% .",
    "the two amr codes , flash and enzo , deviate considerably , most likely due to different refinement criteria .",
    "it is somewhat surprising that enzo has larger power than the two pm codes , which have the same resolution in the whole box that enzo has only in high density regions .",
    "this could be the result of an algorithmic artifact in the amr implementation .    to summarize , the agreement for the matter power spectrum is at the 5% level over a large range in length scale .",
    "the early deviation of the grid codes is surprising , as the nominal resolution of all codes should have been sufficient to generate agreement over a wider @xmath70-range . in order to be able to obtain more cosmologically relevant results at @xmath75mpc@xmath68 , much larger simulation boxes have to be compared . at higher wavenumbers ,",
    "baryonic effects become important leading to the necessity of a much more involved comparison set - up .",
    "the new era of precision cosmology requires new standards for the reach and accuracy of large cosmological simulations .",
    "while previously , qualitative answers and quantitative results at the 20% accuracy level were sufficient , we now need to robustly predict nonlinear physics at the 1% accuracy level .",
    "this demanding task can only be achieved by rigorous code verification and error control .    in this paper",
    "we have carried out a comprehensive code comparison project with 10 state - of - the - art cosmological simulation codes .",
    "paraview was introduced as a powerful analysis tool which should make it more convenient for code developers to compare results . in particular",
    ", results from the current suite of simulations can function as a good database for reference purposes and benchmarking .",
    "the initial conditions are publicly available",
    ".    the results from the code comparisons are satisfactory and not unexpected , but also show that much more work is needed in order to attain the required accuracy for upcoming surveys .",
    "the halo mass function is a very stable statistic , the agreement over wide ranges of mass being better than 5% .",
    "additionally , the low mass cutoff for individual codes can be reliably predicted by a simple criterion .",
    "the internal structure of halos in the outer regions of @xmath76 also appears to be very similar between different simulation codes .",
    "larger differences between the codes in the inner region of the halos occur if the halo is not in a relaxed state : in this case , time stepping issues might also play an important role ( e.g. particle orbit phase errors , global time mismatches ) . for halos with a clear single center , the agreement is very good and predictions for the fall - off of the profiles from resolution criteria hold as expected . the investigation of the halo counts as a function of density revealed an interesting problem with the tpm code , the simulation suffering from a large deficit in medium density regimes .",
    "the amr codes showed a large deficit of small halos over almost the entire density regime , as the base grid of the amr simulation set too low a resolution limit for the halos .",
    "the power spectrum measurements revealed definitely more scatter among the different codes than expected .",
    "the agreement in the nonlinear regime is at the 5 - 10% level , even on moderate spatial scales around @xmath77mpc@xmath68 .",
    "this disagreement on small scales is connected to differences of the codes in the inner regions of the halos .",
    "the calculations described herein were performed in part using the computational resources of los alamos national laboratory .",
    "a special acknowledgment is due to supercomputing time awarded to us under the lanl institutional computing initiative .",
    "99        ryne ,  r.d . , habib ,  s. , qiang ,  j. , ko ,  k. , li ,  z. , mccandless ,  b. , mi ,  w. , ng ,  c .- k . , saparov ,  m. , srinivas ,  v. , sun ,  y. , zhan ,  x. , decyk ,  v. , & golub ,  g.  1998 , the us doe grand challenge in computational accelerator physics , proceedings linac98 ( chicago , il ) .",
    "zhan , h. and knox , l. 2004 , apjl , 616 , l75 ; white , m. 2004 , astropart .",
    "phys . , 22 , 211 ; jing , y.p . , zhang , p. , lin , w.p . , gao , l. , and springel , v. 2006 , apjl , 640 , 119 ; rudd , d.h . ,",
    "zentner , a.r . , and kravtsov , a. 2007 , astro - ph/0703741 ."
  ],
  "abstract_text": [
    "<S> current and upcoming cosmological observations allow us to probe structures on smaller and smaller scales , entering highly nonlinear regimes . in order to obtain theoretical predictions in these regimes , </S>",
    "<S> large cosmological simulations have to be carried out . the promised high accuracy from observations </S>",
    "<S> make the simulation task very demanding : the simulations have to be at least as accurate as the observations . </S>",
    "<S> this requirement can only be fulfilled by carrying out an extensive code validation program . </S>",
    "<S> the first step of such a program is the comparison of different cosmology codes including gravitation interactions only . in this paper </S>",
    "<S> we extend a recently carried out code comparison project to include five more simulation codes . </S>",
    "<S> we restrict our analysis to a small cosmological volume which allows us to investigate properties of halos . </S>",
    "<S> for the matter power spectrum and the mass function , the previous results hold , with the codes agreeing at the 10% level over wide dynamic ranges . </S>",
    "<S> we extend our analysis to the comparison of halo profiles and investigate the halo count as a function of local density . </S>",
    "<S> we introduce and discuss paraview as a flexible analysis tool for cosmological simulations , the use of which immensely simplifies the code comparison task .    to 0pt to 0ptla - ur-07 - 1953 </S>"
  ]
}