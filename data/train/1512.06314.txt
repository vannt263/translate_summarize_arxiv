{
  "article_text": [
    "for decades , ecologists have used entropy - like quantities as measures of biological diversity .",
    "the basic premise is that given a biological community or ecosystem containing @xmath2 species in proportions @xmath3 , the entropy of the probability distribution @xmath4 indicates the extent to which the community is balanced or ` diverse ' .",
    "shannon entropy itself is often used ; so too are many variants , as we shall see .",
    "but almost all of them share the property that for a fixed number @xmath2 of species , the entropy is maximized by the uniform distribution @xmath5 .",
    "however , there is a growing appreciation that this crude model of a biological community is too far from reality , in that it takes no notice of the varying similarities between species .",
    "for instance , we would intuitively judge a meadow to be more diverse if it consisted of ten dramatically different plant species than if it consisted of ten species of grass .",
    "this has led to the introduction of measures that do take into account inter - species similarities  @xcite . in mathematical terms , making this refinement essentially means extending the classical notion of entropy from probability distributions on a finite set to probability distributions on a finite metric space .",
    "the maximum entropy problem now becomes more interesting .",
    "consider , for instance , a pond community consisting of two very similar species of frog and one species of newt .",
    "we would not expect the maximum entropy ( or diversity ) to be achieved by the uniform distribution @xmath6 , since the community would then be @xmath7 frog and only @xmath8 newt .",
    "we might expect the maximizing distribution to be closer to @xmath9 ; the exact answer should depend on the degrees of similarity of the species involved .",
    "we return to this scenario in example  [ eg : three ] .    for the sake of concreteness , this paper is written in terms of an ecological scenario : a community of organisms classified into species .",
    "however , nothing that we do is intrinsically ecological , or indeed connected to any specific branch of science .",
    "our results apply equally to any collection of objects classified into types .",
    "it is well understood that shannon entropy is just one point ( albeit a special one ) on a continuous spectrum of entropies , indexed by a parameter @xmath10 $ ] .",
    "this spectrum has been presented in at least two ways : as the rnyi entropies @xmath11  @xcite and as the so - called tsallis entropies @xmath12 ( actually introduced as biodiversity measures by patil and taillie prior to tsallis s work in physics , and earlier still in information theory @xcite ) : @xmath13 both @xmath11 and @xmath12 converge to shannon entropy as @xmath14 .",
    "moreover , @xmath11 and @xmath12 can be obtained from one another by an increasing invertible transformation , and in this sense are interchangeable .",
    "when @xmath11 or @xmath12 is used as a diversity measure , @xmath0 controls the weight attached to rare species , with @xmath15 giving as much importance to rare species as common ones , and the limiting case @xmath16 reflecting only the prevalence of the most common species .",
    "different values of @xmath0 produce genuinely different judgements on which of two distributions is the more diverse .",
    "for instance , if over time a community loses some species but becomes more balanced , then the rnyi and tsallis entropies decrease for @xmath15 but increase for @xmath16 .",
    "varying @xmath0 therefore allows us to incorporate a spectrum of viewpoints on the meaning of the word ` diversity ' .",
    "here we use the diversity measures introduced by leinster and cobbold  @xcite , which both ( i )  reflect this spectrum of viewpoints by including the variable parameter @xmath0 , and ( ii )  take into account the varying similarities between species .",
    "we review these measures in sections [ sec : spectrum][sec : measures ] . in the extreme case",
    "where different species are assumed to have nothing whatsoever in common , they reduce to the exponentials of the rnyi entropies , and in other special cases they reduce to other diversity measures used by ecologists . in practical terms , the measures of  @xcite have been used to assess a variety of ecological systems , from communities of microbes  @xcite and crustacean zooplankton  @xcite to alpine plants  @xcite and arctic predators  @xcite , as well as being applied in non - biological contexts such as computer network security  @xcite .    mathematically , the set - up is as follows .",
    "a biological community is modelled as a probability distribution @xmath17 ( representing the proportions of species ) together with an @xmath18 matrix @xmath19 ( whose @xmath20-entry represents the similarity between species @xmath21 and @xmath22 ) . from this data , a formula gives a real number @xmath23 for each @xmath10 $ ] , called the ` diversity of order @xmath0 ' of the community . as for the rnyi entropies , different values of @xmath0 make different judgements : for instance , it may be that for two distributions @xmath24 and @xmath25 , @xmath26    now consider the maximum diversity problem . fix a list of species whose similarities to one another are known ; that is , fix a matrix @xmath19 ( subject to hypotheses to be discussed ) .",
    "the two basic questions are :    * which distribution(s ) @xmath24 maximize the diversity @xmath23 of order @xmath0 ? * what is the value of the maximum diversity @xmath27 ?",
    "this can be interpreted ecologically as follows : if we have a fixed list of species and complete control over their abundances within our community , how should we choose those abundances in order to maximize the diversity , and how large can we make that diversity ?    in principle , both answers depend on @xmath0 .",
    "after all , we have seen that if distributions are ranked by diversity then the ranking varies according to the value of @xmath0 chosen .",
    "but our main theorem is that , in fact , both answers are _ independent _ of @xmath0 :    * * theorem  [ thm : main ] ( main theorem)**__there exists a probability distribution on @xmath28 that maximizes @xmath29 for all @xmath10 $ ] .",
    "moreover , the maximum diversity @xmath27 is independent of @xmath10 $ ] . _ _",
    "so , there is a ` best of all possible worlds ' : a distribution that maximizes diversity no matter what viewpoint one takes on the relative importance of rare and common species .",
    "this theorem merely asserts the _ existence _ of a maximizing distribution .",
    "however , a second theorem describes how to _ compute _ all maximizing distributions , and the maximum diversity , in a finite number of steps ( theorem  [ thm : comp ] ) .",
    "better still , if by some means we have found a distribution @xmath24 that maximizes the diversity of _ some _ order @xmath1 , then a further result asserts that @xmath24 maximizes diversity of _ all _ orders ( corollary  [ cor : irrelevance ] ) .",
    "for instance , it is often easiest to find a maximizing distribution for diversity of order @xmath30 ( as in example  [ eg : naive ] and proposition  [ propn : graph - main ] ) , and it is then automatic that this distribution maximizes diversity of all orders .",
    "let us put these results into context .",
    "first , they belong to the huge body of work on maximum entropy problems . for example",
    ", the normal distribution has the maximum entropy among all probability distributions on @xmath31 with a given mean and variance , a property which is intimately connected with its appearance in the central limit theorem .",
    "this alone would be enough motivation to seek maximum entropy distributions in other settings ( such as the one at hand ) , quite apart from the importance of maximum entropy in thermodynamics , machine learning , macroecology , and so on .",
    "second , we will see that maximum diversity is very closely related to the emerging invariant known as magnitude .",
    "this is defined in the extremely wide generality of enriched category theory ( * ? ? ?",
    "* section  1 ) , and specializes in interesting ways in a variety of mathematical fields . for instance , it automatically produces a notion of the euler characteristic of an ( ordinary ) category , closely related to topological euler characteristic  @xcite ; in the context of metric spaces , magnitude encodes geometric information such as volume and dimension @xcite ; in graph theory , magnitude is a new invariant that turns out to be related to a graded homology theory for graphs  @xcite ; and in algebra , magnitude produces an invariant of associative algebras that can be understood as a homological euler characteristic  @xcite .",
    "this work is self - contained . to that end , we begin by explaining and defining the diversity measures in  @xcite ( sections [ sec : spectrum][sec : measures ] ) .",
    "then come the results : preparatory lemmas in section  [ sec : invt ] , and the main results in sections  [ sec : main ] and  [ sec : comp ] .",
    "examples are given in sections [ sec : examples - simple][sec : examples - pos - def ] , including results on special cases such as when the similarity matrix @xmath19 is either the adjacency matrix of a graph or positive definite .",
    "perhaps counterintuitively , a distribution that maximizes diversity can eliminate some species entirely .",
    "this is addressed in section  [ sec : elim ] , where we derive necessary and sufficient conditions on @xmath19 for maximization to preserve all species . finally , we state some open questions ( section  [ sec : questions ] )",
    ".    the main results of this paper previously appeared in a preprint of leinster  @xcite , but the proofs we present here are substantially simpler . of the new results , lemma  [ lemma : elim - main ] ( the key to our results on preservation of species by maximizing distributions ) borrows heavily from an argument of fremlin and talagrand  @xcite .    [",
    "[ p : conventions ] ] conventions + + + + + + + + + + +    a vector @xmath32 is * nonnegative * if @xmath33 for all @xmath21 , and * positive * if @xmath34 for all @xmath21 .",
    "the * support * of @xmath35 is @xmath36 and @xmath37 has * full support * if @xmath38 .",
    "a real symmetric @xmath18 matrix @xmath19 is * positive semidefinite * if @xmath39 for all @xmath40 , and * positive definite * if this inequality is strict .",
    "ecologists began to propose quantitative definitions of biological diversity in the mid - twentieth century @xcite , setting in motion more than fifty years of heated debate , dozens of further proposed diversity measures , hundreds of scholarly papers , at least one book devoted to the subject  @xcite , and consequently , for some , despair ( already expressed by 1971 in a famously - titled paper of hurlbert  @xcite ) .",
    "meanwhile , parallel discussions were taking place in disciplines such as genetics  @xcite , economists were using the same formulas to measure wealth inequality and industrial concentration  @xcite , and information theorists were developing the mathematical theory of such quantities under the name of entropy rather than diversity .    obtaining accurate data about an ecosystem",
    "is beset with practical and statistical problems , but that is not the reason for the prolonged debate . even assuming that complete information is available , there are genuine differences of opinion about what the word ` diversity ' should mean .",
    "we focus here on one particular axis of disagreement , illustrated by the examples in figure  [ fig : birds ] .",
    "( 120,38 ) ( 30,0)(0,0)[b ] ( 30,-1)(0,0)[t](a ) ( 95,0)(0,0)[b ] ( 95,-1)(0,0)[t](b )    one extreme viewpoint on diversity is that preservation of species is all that matters : ` biodiversity ' simply means the number of species present ( as is common in the ecological literature as well as the media ) .",
    "since no attention is paid to the abundances of the species present , rare species count for exactly as much as common species . from this viewpoint , community  ( a ) of figure  [ fig : birds ]",
    "is more diverse than community  ( b ) , simply because it contains more species .",
    "the opposite extreme is to ignore rare species altogether and consider only those that are most common .",
    "( this might be motivated by a focus on overall ecosystem function . ) from this viewpoint , community  ( b ) is more diverse than community  ( a ) , because it is better - balanced : ( a )  is dominated by a single common species , whereas ( b )  has three common species in equal proportions .    between these two extremes , there is a spectrum of intermediate viewpoints , attaching more or less weight to rare species .",
    "different scientists have found it appropriate to adopt different positions on this spectrum for different purposes , as the literature amply attests .    rather than attempting to impose one particular viewpoint",
    ", we will consider all equally .",
    "thus , we use a one - parameter family of diversity measures , with the ` viewpoint parameter ' @xmath10 $ ] controlling one s position on the spectrum . taking @xmath15 will give rare species as much importance as common species , while taking @xmath16 will give rare species no importance at all .",
    "there is one important dimension missing from the discussion so far .",
    "we will consider not only the varying abundances of the species , but also the varying similarities between them .",
    "this is addressed in the next section .",
    "in this section and the next , we give a brief introduction to the diversity measures of leinster and cobbold  @xcite .",
    "we have two tasks .",
    "we must build a mathematical model of the notion of ` biological community ' ( this section ) .",
    "then , we must define and explain the diversity measures themselves ( next section ) .    in brief",
    ", a biological community will be modelled as a finite set ( whose elements are the species ) equipped with both a probability distribution ( indicating the relative abundances of the species ) and , for each pair of elements of the set , a similarity coefficient ( reflecting the similarities between species ) .",
    "let us now consider each of these aspects in turn .",
    "first , we assume a community or system of individuals , partitioned into @xmath41 species .",
    "the word ` species ' need not have its standard meaning : it can denote any unit thought meaningful , such as genus , serotype ( in the case of viruses ) , or the class of organisms having a particular type of diet .",
    "it need not even be a biological grouping ; for instance , in  @xcite the units are soil types . for concreteness , however , we write in terms of an ecological community divided into species",
    ". the division of a system into species or types may be somewhat artificial , but this is mitigated by the introduction of the similarity coefficients ( as shown in  @xcite , p.482 ) .",
    "second , each species has a relative abundance , the proportion of organisms in the community belonging to that species .",
    "thus , listing the species in order as @xmath42 , the relative abundances determine a vector @xmath43 .",
    "this is a probability distribution : @xmath44 for each species @xmath21 , and @xmath45 .",
    "abundance can be measured in any way thought relevant , e.g.  number of individuals , biomass , or ( in the case of plants ) ground coverage .",
    "critically , the word ` diversity ' refers only to the _ relative _ , not absolute , abundances .",
    "if half of a forest burns down , or if a patient loses @xmath46 of their gut bacteria , then it may be an ecological or medical disaster ; but assuming that the system is well - mixed , the diversity does not change . in the language of physics",
    ", diversity is an intensive quantity ( like density or temperature ) rather than an extensive quantity ( like mass or heat ) , meaning that it is independent of the system s size .",
    "the third and final aspect of the model is inter - species similarity .",
    "for each pair @xmath20 of species , we specify a real number @xmath47 representing the similarity between species @xmath21 and @xmath22 .",
    "this defines an @xmath18 matrix @xmath48 . in  @xcite",
    ", similarity is taken to be measured on a scale of @xmath49 to @xmath50 , with @xmath49 meaning total dissimilarity and @xmath50 that the species are identical .",
    "thus , it is assumed there that@xmath51 in fact , our maximization theorems will only require the weaker hypotheses @xmath52 together with the requirement that @xmath19 is a symmetric matrix .",
    "( in the appendix to  @xcite , matrices satisfying   were called ` relatedness matrices ' . )    just as the meanings of ` species ' and ` abundance ' are highly flexible , so too is the meaning of ` similarity ' :    the simplest similarity matrix @xmath19 is the identity matrix @xmath53 .",
    "this is called the * naive model * in  @xcite , since it embodies the assumption that distinct species have nothing in common .",
    "crude though this assumption is , it is implicit in the diversity measures most popular in the ecological literature ( * ? ? ?",
    "* table  1 ) .    with the rapid fall in the cost of dna sequencing , it is increasingly common to measure similarity genetically ( in any of several ways ) .",
    "thus , the coefficients @xmath47 may be chosen to represent percentage genetic similarities between species .",
    "this is an effective strategy even when the taxonomic classification is unclear or incomplete  @xcite , as is often the case for microbial communities  @xcite .",
    "[ eg : sim - phylo ] given a suitable phylogenetic tree , we may define the similarity between two present - day species as the proportion of evolutionary time before the point at which the species diverged .",
    "[ eg : sim - taxo ] in the absence of more refined data , we can measure species similarity according to a taxonomic tree .",
    "for instance , we might define @xmath54    [ eg : sim - metric ] in purely mathematical terms , an important case is where the similarity matrix arises from a metric @xmath55 on the set @xmath28 via the formula @xmath56 .",
    "thus , the community is modelled as a probability distribution on a finite metric space .",
    "( the naive model corresponds to the metric defined by @xmath57 for all @xmath58 . )",
    "the diversity measures that we will shortly define can be understood as ( the exponentials of ) rnyi - like entropies for such distributions .",
    "here we state the definition of the diversity measures of  @xcite , which we will later seek to maximize .",
    "we then explain the reasons for this particular definition .    as in section",
    "[ sec : model ] , we take a biological community modelled as a finite probability distribution @xmath17 together with an @xmath18 matrix @xmath19 satisfying  . as explained in section  [ sec : spectrum ] , we define not one diversity measure but a family of them , indexed by a parameter @xmath10 $ ] controlling the emphasis placed on rare species .",
    "the * diversity of order @xmath0 * of the community is @xmath59 ( @xmath60 ) . here",
    "@xmath61 is the support of @xmath24 ( conventions , p. ) , @xmath62 is the column vector obtained by multiplying the matrix @xmath19 by the column vector @xmath24 , and @xmath63 is its @xmath21th entry . the hypotheses   imply that @xmath64 whenever @xmath65 , and so @xmath23 is well - defined .",
    "although this formula is invalid for @xmath66 , it converges as @xmath14 , and @xmath67 is defined to be the limit .",
    "the same is true for @xmath68 .",
    "explicitly , @xmath69    the applicability , context and meaning of definition   are discussed at length in  @xcite . here",
    "we briefly review the principal points .",
    "first , the definition includes as special cases many existing quantities going by the name of diversity or entropy .",
    "for instance , in the naive model @xmath70 , the diversity @xmath71 is the exponential of the rnyi entropy of order @xmath0 , and is also known in ecology as the hill number of order @xmath0 .",
    "( references for this and the next two paragraphs are given in ( * ? ? ?",
    "* table  1 ) . )    continuing in the naive model @xmath70 and specializing further to particular values of @xmath0 , we obtain other known quantities : @xmath72 is species richness ( the number of species present ) , @xmath73 is the exponential of shannon entropy , @xmath74 is the gini ",
    "simpson index ( the reciprocal of the probability that two randomly - chosen individuals are of the same species ) , and @xmath75 is the berger  parker index ( a measure of the dominance of the most abundant species ) .    now allowing a general @xmath19 ,",
    "the diversity of order @xmath76 is @xmath77 .",
    "thus , diversity of order @xmath76 is the reciprocal of the expected similarity between a random pair of individuals .",
    "( the meaning given to ` similarity ' will determine the meaning of the diversity measure : taking the coefficients @xmath47 to be genetic similarities produces a genetic notion of diversity , and similarly phylogenetic , taxonomic , and so on . ) up to an increasing , invertible transformation , this is the well - studied quantity known as rao s quadratic entropy .",
    "given distributions @xmath24 and @xmath25 on the same list of species , different values of @xmath0 may make different judgements on which of @xmath24 and @xmath25 is the more diverse .",
    "for instance , with @xmath70 and the two distributions shown in figure  [ fig : birds ] , taking @xmath15 makes community  ( a ) more diverse and embodies the first ` extreme viewpoint ' described in section  [ sec : spectrum ] , whereas @xmath16 makes  ( b ) more diverse and embodies the opposite extreme .",
    "it is therefore most informative if we calculate the diversity of _ all _ orders @xmath10 $ ] .",
    "the graph of @xmath23 against @xmath0 is called the * diversity profile * of @xmath24 .",
    "two distributions @xmath24 and @xmath25 can be compared by plotting their diversity profiles on the same axes .",
    "if one curve is wholly above the other then the corresponding distribution is unambiguously more diverse .",
    "if they cross ( as in figure  [ fig : main](b ) , p. ) , then the judgement as to which is the more diverse depends on how much importance is attached to rare species .",
    "the formula for @xmath23 can be understood as follows .",
    "first , for a given species @xmath21 , the quantity @xmath78 is the expected similarity between species @xmath21 and an individual chosen at random .",
    "differently put , @xmath63 measures the ordinariness of the @xmath21th species witin the community ; in  @xcite , it is called the ` relative abundance of species similar to the @xmath21th ' . hence the mean ordinariness of an individual in the community",
    "is @xmath79 .",
    "this measures the _ lack _ of diversity of the community , so its reciprocal is a measure of diversity .",
    "this is exactly @xmath80 .",
    "to explain the diversity of orders @xmath81 , we recall the classical notion of power mean .",
    "let @xmath17 be a finite probability distribution and let @xmath82 , with @xmath34 whenever @xmath83 . for real @xmath84 , the * power mean * of @xmath37 of order @xmath85 , weighted by @xmath24 , is @xmath86 (",
    "* chapter  ii ) .",
    "this definition is extended to @xmath87 and @xmath88 by taking limits in @xmath85 , which gives @xmath89 now , when we take the ` mean ordinariness ' in the previous paragraph , we can replace the ordinary arithmetic mean ( the case @xmath90 ) by the power mean of order @xmath91 . again taking the reciprocal , we obtain exactly  .",
    "that is , @xmath92 for all @xmath24 , @xmath19 , and @xmath10 $ ] .",
    "so in all cases , diversity is the reciprocal mean ordinariness of an individual within the community , for varying interpretations of ` mean ' .",
    "the diversity measures @xmath23 have many good properties , discussed in  @xcite .",
    "crucially , they are * effective numbers * : that is , @xmath93 for all @xmath0 and @xmath2 .",
    "this gives meaning to the quantities @xmath23 : if @xmath94 , say , then the community is nearly as diverse as a community of @xmath95 completely dissimilar species in equal proportions . with the stronger assumptions   on @xmath19",
    ", the value of @xmath23 always lies between @xmath50 and @xmath2 .",
    "diversity profiles are decreasing : as less emphasis is given to rare species , perceived diversity drops . more precisely :    [ propn : div - dichotomy ]",
    "let @xmath24 be a probability distribution on @xmath28 and let @xmath19 be an @xmath18 matrix satisfying  . if @xmath63 has the same value @xmath96 for all @xmath65 then @xmath97 for all @xmath10 $ ] .",
    "otherwise , @xmath23 is strictly decreasing in @xmath10 $ ] .",
    "this is immediate from equation   and a classical result on power means  ( * ? ? ?",
    "* theorem  16 ) : @xmath98 is increasing in @xmath85 , strictly so unless @xmath99 has the same value @xmath96 for all @xmath100 , in which case it has constant value @xmath96 .",
    "so , any diversity profile is either constant or strictly decreasing . the first part of the next lemma states that diversity profiles are also continuous :    [ lemma : div - cts ] fix an @xmath18 matrix @xmath19 satisfying  . then :    1 .",
    "[ part : cts - q ] @xmath23 is continuous in @xmath10 $ ] for each distribution @xmath24 ; 2 .   [ part : cts - p ] @xmath23 is continuous in @xmath24 for each @xmath101 .    see propositions  a1 and  a2 of the appendix of  @xcite .    finally , the measures have the sensible property that if some species have zero abundance , then the diversity is the same as if they were not mentioned at all . to express this",
    ", we introduce some notation : given a subset @xmath102 , we denote by @xmath103 the submatrix @xmath104 of @xmath19 .",
    "[ lemma : abs ] let @xmath19 be an @xmath18 matrix satisfying  .",
    "let @xmath102 , and let @xmath24 be a probability distribution on @xmath28 such that @xmath105 for all @xmath106 .",
    "then , writing @xmath25 for the restriction of @xmath24 to @xmath107 , @xmath108 for all @xmath10 $ ] .",
    "this is trivial , and is also an instance of a more general naturality property ( lemma  a13 in the appendix of  @xcite ) .",
    "* for the rest of this work , fix an integer @xmath41 and an @xmath109 symmetric matrix @xmath19 of nonnegative reals whose diagonal entries are positive * ( that is , _ strictly _ greater than zero ) . also write @xmath110 for the set of probability distributions on @xmath28 .    to prove the main theorem , we begin by making two apparent digressions .",
    "let @xmath111 be any matrix .",
    "a * weighting * on @xmath111 is a column vector @xmath112 such that @xmath113 is the column vector whose every entry is @xmath50 .",
    "it is trivial to check that if both @xmath111 and its transpose have at least one weighting , then the quantity @xmath114 is independent of the choice of weighting @xmath112 on @xmath111 ; this quantity is called the * magnitude * @xmath115 of @xmath111 ( * ? ? ?",
    "* section  1.1 ) .    when @xmath111 is symmetric ( the case of interest here ) , @xmath115 is defined just as long as @xmath111 has at least one weighting . when @xmath111 is invertible , @xmath111 has exactly one weighting and @xmath115 is the sum of all the entries of @xmath116 .",
    "the second digression concerns the dichotomy expressed in proposition  [ propn : div - dichotomy ] : every diversity profile is either constant or strictly decreasing .",
    "we now ask : which distributions have constant diversity profile ?",
    "this question turns out to have a clean answer in terms of weightings and magnitude . to state it",
    ", we make some further definitions .",
    "a probability distribution @xmath24 on @xmath28 is * invariant * if @xmath117 for all @xmath118 $ ] .",
    "let @xmath102 , and let @xmath119 be a nonnegative vector .",
    "then there is a probability distribution @xmath120 on @xmath28 defined by @xmath121 in particular , let @xmath107 be a nonempty subset of @xmath28 and @xmath112 a nonnegative weighting on @xmath122 .",
    "then @xmath123 , so @xmath120 is defined , and @xmath124 for all @xmath125 .",
    "[ lemma : invt ] the following are equivalent for @xmath126 :    1 .",
    "[ part : invt - invt ] @xmath24 is invariant ; 2 .",
    "[ part : invt - supp ] @xmath127 for all @xmath128 ; 3 .",
    "[ part : invt - ext ] @xmath129 for some nonnegative weighting @xmath112 on @xmath103 and some nonempty subset @xmath102 .",
    "moreover , in the situation of  ( [ part : invt - ext ] ) , @xmath130 for all @xmath10 $ ] .",
    "( [ part : invt - invt])@xmath131([part : invt - supp ] ) is immediate from proposition  [ propn : div - dichotomy ] .    for ( [ part : invt - supp])@xmath132([part : invt - ext ] ) ,",
    "assume  ( [ part : invt - supp ] ) . put @xmath133 and write @xmath134 for any @xmath125 .",
    "then @xmath135 , so we may define @xmath136 by @xmath137  ( @xmath125 ) .",
    "evidently @xmath129 and @xmath112 is nonnegative .",
    "furthermore , @xmath112 is a weighting on @xmath103 , since whenever @xmath125 , @xmath138    finally , for ( [ part : invt - ext])@xmath132([part : invt - supp ] ) and ` moreover ' , take @xmath107 and @xmath112 as in  ( [ part : invt - ext ] ) .",
    "then @xmath139 , so for all @xmath140 , @xmath141 hence @xmath142 for all @xmath10 $ ] by proposition  [ propn : div - dichotomy ] .",
    "we now prove a result that is much weaker than the main theorem , but will act as a stepping stone in the proof .",
    "[ lemma:01 ] for each @xmath143 , there exists an invariant distribution that maximizes @xmath29 .",
    "let @xmath143 .",
    "then @xmath29 is continuous on the compact space @xmath144 ( lemma  [ lemma : div - cts]([part : cts - p ] ) ) , so attains a maximum at some point @xmath24 .",
    "take @xmath145 such that @xmath146 is least and @xmath147 is greatest . by lemma  [ lemma : invt ] , it is enough to prove that @xmath148 .",
    "define @xmath149 by taking @xmath150 to be the kronecker delta @xmath151 , and @xmath152 similarly .",
    "then @xmath153 for all real @xmath85 sufficiently close to @xmath49 , and @xmath154 where   holds because @xmath24 is a supremum ,  is a routine computation ,  and  follow from the defining properties of @xmath22 and @xmath155 , and   uses the symmetry of @xmath19 .",
    "equality therefore holds throughout , and in particular in  .",
    "hence @xmath148 , as required .",
    "an alternative proof uses lagrange multipliers , but is complicated by the possibility that @xmath29 attains its maximum on the boundary of @xmath144 .",
    "the result we have just proved only concerns the maximization of @xmath29 for specific values of @xmath0 , but the following lemma will allow us to deduce results about maximization for all @xmath0 simultaneously .",
    "a probability distribution on @xmath28 is * maximizing * if it maximizes @xmath29 for all @xmath10 $ ] .",
    "[ lemma : invt - varying - q ] for @xmath156 , any invariant distribution that maximizes @xmath157 also maximizes @xmath29 . in particular , any invariant distribution that maximizes @xmath158 is maximizing .",
    "let @xmath156 and let @xmath24 be an invariant distribution that maximizes @xmath157 .",
    "then for all @xmath159 , @xmath160 since diversity profiles are decreasing ( proposition  [ propn : div - dichotomy ] ) .",
    "[ thm : main ] there exists a probability distribution on @xmath28 that maximizes @xmath29 for all @xmath10 $ ] .",
    "moreover , the maximum diversity @xmath161 is independent of @xmath162 $ ] .",
    "an equivalent statement is that there exists an invariant maximizing distribution . to prove this ,",
    "choose a decreasing sequence @xmath163 in @xmath164 converging to @xmath49 .",
    "by lemma  [ lemma:01 ] , we can choose for each @xmath165 an invariant distribution @xmath166 that maximizes @xmath167 .",
    "since @xmath144 is compact , we may assume ( by passing to a subsequence if necessary ) that the sequence @xmath168 converges to some point @xmath169 .",
    "we will show that @xmath24 is invariant and maximizing .",
    "we show that @xmath24 is invariant using lemma  [ lemma : invt ] .",
    "let @xmath170 .",
    "then @xmath171 for all @xmath172 , so @xmath173 for all @xmath172 , and letting @xmath174 gives @xmath127 .    to show that @xmath24 is maximizing , first note that @xmath175 maximizes @xmath167 whenever @xmath176 ( by lemma  [ lemma : invt - varying - q ] ) . fixing @xmath177 and letting @xmath178 , this implies that @xmath24 maximizes @xmath167 , since @xmath167 is continuous ( lemma  [ lemma : div - cts]([part : cts - p ] ) ) .",
    "thus , @xmath24 maximizes @xmath167 for all @xmath177 . but @xmath179 as @xmath174 , and diversity is continuous in its order ( lemma  [ lemma : div - cts]([part : cts - q ] ) ) , so @xmath24 maximizes @xmath158 .",
    "since @xmath24 is invariant , lemma  [ lemma : invt - varying - q ] implies that @xmath24 is maximizing .",
    "the theorem can be understood as follows ( figure  [ fig : main](a ) ) .",
    "each particular value of the viewpoint parameter @xmath0 ranks the set of all distributions @xmath24 in order of diversity , with @xmath24 placed above @xmath25 when @xmath180 .",
    "different values of @xmath0 rank the set of distributions differently .",
    "nevertheless , there is a distribution @xmath181 that is at the top of every ranking .",
    "this is the content of the first half of theorem  [ thm : main ] .",
    "alternatively , we can visualize the theorem in terms of diversity profiles ( figure  [ fig : main](b ) ) .",
    "diversity profiles may cross , reflecting the different priorities embodied by different values of @xmath0 .",
    "but there is at least one distribution @xmath181 whose profile is above every other profile ; moreover , its profile is constant .",
    "( 50,37 ) ( 25,-2)(0,0)[t](a ) ( 10,0)(0,0)[b]@xmath15 ( 10,5)(0,0)[b ] rank the set of distributions , and ( b )  in terms of diversity profiles.,title=\"fig : \" ] ( 10,35.2)(0,0)[c]@xmath181 ( 10,28.9)(0,0)[c]@xmath24 ( 10,22.0)(0,0)[c]@xmath182 ( 40,0)(0,0)[b]@xmath183 ( 40,5)(0,0)[b ] rank the set of distributions , and ( b )  in terms of diversity profiles.,title=\"fig : \" ] ( 40,35.2)(0,0)[c]@xmath181 ( 40,26.5)(0,0)[c]@xmath182 ( 40,14.5)(0,0)[c]@xmath24    ( 60,37 ) ( 30,-2)(0,0)[t](b ) ( 30,5)(0,0)[b ] rank the set of distributions , and ( b )  in terms of diversity profiles.,title=\"fig : \" ] ( 1,15)(0,0)[r]@xmath29 ( 30,5)(0,0)[t]@xmath0 ( 10,18.5)(0,0)[c]@xmath24 ( 6,14)(0,0)[c]@xmath182 ( 16,23)(0,0)[c]@xmath181    theorem  [ thm : main ] immediately implies :    [ cor : max - invt ] every maximizing distribution is invariant .",
    "this result can be partially understood as follows . for shannon entropy , and more generally any of the rnyi entropies ,",
    "the maximizing distribution is obtained by taking the relative abundance @xmath184 to be the same for all species @xmath21 .",
    "this is no longer true when inter - species similarities are taken into account .",
    "however , what is approximately true is that diversity is maximized when @xmath63 , the relative abundance of species _ similar _ to the @xmath21th , is the same for all species @xmath21 .",
    "this follows from corollary  [ cor : max - invt ] together with the characterization of invariant distributions in lemma  [ lemma : invt]([part : invt - supp ] ) ; but it is only ` approximately true ' because it is only guaranteed that @xmath127 when @xmath21 and @xmath22 both belong to the support of @xmath24 , not for all @xmath21 and @xmath22",
    ". it may in fact be that some or all maximizing distributions do not have full support , a phenomenon we examine in section  [ sec : elim ] .",
    "the second half of theorem  [ thm : main ] tells us that associated with the matrix @xmath19 is a numerical invariant , the constant value of a maximizing distribution :    the * maximum diversity * of @xmath19 is @xmath185 , for any @xmath10 $ ] .",
    "we show how to compute @xmath186 in the next section .",
    "if a distribution @xmath24 maximizes diversity of order @xmath76 , say , must it also maximize diversity of orders @xmath50 and @xmath30 ?",
    "the answer turns out to be yes :    [ cor : irrelevance ] let @xmath24 be a probability distribution on @xmath28 . if @xmath24 maximizes @xmath29 for some @xmath187 $ ] then @xmath24 maximizes @xmath29 for all @xmath10 $ ] .",
    "let @xmath187 $ ] and let @xmath24 be a distribution maximizing @xmath29",
    ". then @xmath188 where the first inequality holds because diversity profiles are decreasing .",
    "so equality holds throughout .",
    "now @xmath189 with @xmath190 , so proposition  [ propn : div - dichotomy ] implies that @xmath24 is invariant .",
    "but also @xmath191 , so @xmath24 maximizes @xmath158 .",
    "hence by lemma  [ lemma : invt - varying - q ] , @xmath24 is maximizing .",
    "the significance of this corollary is that if we wish to find a distribution that maximizes diversity of all orders @xmath0 , it suffices to find a distribution that maximizes diversity of a single nonzero order .",
    "the hypothesis that @xmath1 in corollary  [ cor : irrelevance ] can not be dropped .",
    "indeed , take @xmath70 .",
    "then @xmath72 is species richness ( the cardinality of @xmath61 ) , which is maximized by any distribution @xmath24 of full support , whereas @xmath73 is the exponential of shannon entropy , which is maximized only when @xmath24 is uniform .",
    "the main theorem guarantees the existence of a maximizing distribution @xmath181 , but does not tell us how to find it .",
    "it also states that @xmath192 is independent of @xmath0 , but does not tell us what its value is .",
    "the following result repairs both omissions .",
    "[ thm : comp ]    1 .",
    "[ part : comp - value ] for all @xmath10 $ ] , @xmath193 where the maximum is over all @xmath102 such that @xmath103 admits a nonnegative weighting .",
    "[ part : comp - dist ] the maximizing distributions are precisely those of the form @xmath120 where @xmath112 is a nonnegative weighting on @xmath103 for some @xmath107 attaining the maximum in  .",
    "let @xmath10 $ ] .",
    "then @xmath194 where   follows from the fact that there is an invariant maximizing distribution ( theorem  [ thm : main ] ) ,  follows from lemma  [ lemma : invt ] , and   follows from the trivial fact that @xmath195 whenever @xmath103 admits a nonnegative weighting .",
    "this proves  ( [ part : comp - value ] ) .",
    "every maximizing distribution is invariant ( corollary  [ cor : max - invt ] ) , so  ( [ part : comp - dist ] ) follows from lemma  [ lemma : invt ] .",
    "[ rmk : algorithm ] the theorem provides a finite - time algorithm for finding all the maximizing distributions and computing @xmath186 , as follows . for each of the @xmath196 subsets @xmath107 of @xmath28 , perform some simple linear algebra to find the space of nonnegative weightings on @xmath103 ; if this space is nonempty , call @xmath107 * feasible * and record the magnitude @xmath197 .",
    "then @xmath186 is the maximum of all the recorded magnitudes . for each feasible @xmath107 such that @xmath198 , and each nonnegative weighting @xmath112 on @xmath103 , the distribution @xmath120 is maximizing .",
    "this generates all of the maximizing distributions .",
    "this algorithm takes exponentially many steps in @xmath2 , and remark  [ rmk : no - quick - clique ] provides strong evidence that the time taken can not be reduced to a polynomial in @xmath2 .",
    "but the situation is not as hopeless as it might appear , for two reasons .",
    "first , each step of the algorithm is fast , consisting as it does of solving a system of linear equations .",
    "for instance , in an implementation in matlab on a standard laptop , with no attempt at optimization , the maximizing distributions of @xmath199 matrices were computed in a few seconds .",
    "second , for certain classes of matrices @xmath19 , we can make substantial improvements in computing time , as observed in section  [ sec : examples - pos - def ] .",
    "the next three sections give examples of the main results , beginning here with some simple , specific examples .",
    "[ eg : naive ] first consider the naive model @xmath70 , in which different species are deemed to be entirely dissimilar . as noted in section  [ sec : measures ] , @xmath71 is the exponential of the rnyi entropy of order @xmath0 .",
    "it is well - known that rnyi entropy of any order @xmath1 is maximized uniquely by the uniform distribution .",
    "this result also follows trivially from corollary  [ cor : irrelevance ] : for clearly @xmath200 is uniquely maximized by the uniform distribution , and the corollary implies that the same is true for all values of @xmath1 .",
    "moreover , @xmath201 .",
    "[ eg : three ] for a general matrix @xmath19 satisfying  , a two - species system is always maximized by the uniform distribution @xmath202 . when @xmath203 , however , nontrivial examples arise .",
    "for instance , take the system shown in figure  [ fig : three ] , consisting of one species of newt and two species of frog .",
    "let us first consider intuitively what we expect the maximizing distribution to be , then compare this with the answer given by theorem  [ thm : comp ] .",
    "( 120,16)(0,-1 ) ( 0,7)(0,0)[l]@xmath204 ( 41,-1.5 ) ( 48,7)(0,0)[c]newt ( 117,12)(0,0)[r]frog species a ( 117,2)(0,0)[r]frog species b ( 108.5,7)(0,0)[l]0.9 ( 73,12)(0,0)[c]0.4 ( 73,2)(0,0)[c]0.4    if we ignore the fact that the two frog species are more similar to each other than they are to the newt , then ( as in example  [ eg : naive ] ) the maximizing distribution is @xmath6 . at the other extreme ,",
    "if we regard the two frog species as essentially identical then effectively there are only two species , newts and frogs , so the maximizing distribution gives relative abundance @xmath205 to the newt and @xmath205 to the frogs .",
    "so with this assumption , we expect diversity to be maximized by the distribution @xmath206 .",
    "intuitively , then , the maximizing distribution should lie between these two extremes . and",
    "indeed , it does : implementing the algorithm in remark  [ rmk : algorithm ] ( or using proposition  [ propn : pos - def - max ] below ) reveals that the unique maximizing distribution is @xmath207 .",
    "one of our standing hypotheses on @xmath19 is symmetry .",
    "the last of our simple examples shows that if @xmath19 is no longer assumed to be symmetric , then the main theorem fails in every respect .",
    "[ eg : nonsym ] let @xmath208 , which satisfies all of our standing hypotheses except symmetry .",
    "consider a distribution @xmath209 . if @xmath24 is @xmath210 or @xmath164 then @xmath211 for all @xmath0 .",
    "otherwise , @xmath212 from   it follows that @xmath213 .",
    "however , this supremum is not attained ; @xmath214 as @xmath215 , but @xmath216 .",
    "equations   and   imply that @xmath217 with unique maximizing distributions @xmath218 and @xmath219 respectively .",
    "thus , when @xmath19 is not symmetric , the main theorem fails comprehensively : the supremum @xmath220 may not be attained ; there may be no distribution maximizing @xmath221 for all @xmath0 simultaneously ; and that supremum may vary with @xmath0 .    perhaps surprisingly ,",
    "nonsymmetric similarity matrices @xmath19 do have practical uses .",
    "for example , it is shown in ( * ? ? ?",
    "* proposition  a7 ) that the mean phylogenetic diversity measures of chao , chiu and jost  @xcite are a special case of the measures @xmath23 , obtained by taking a particular @xmath19 depending on the phylogenetic tree concerned .",
    "this @xmath19 is usually nonsymmetric , reflecting the asymmetry of evolutionary time .",
    "more generally , the case for dropping the symmetry axiom for metric spaces was made in  @xcite , and gromov has argued that symmetry ` unpleasantly limits many applications ' @xcite .",
    "so the fact that our maximization theorem fails for nonsymmetric @xmath19 is an important restriction .",
    "consider those matrices @xmath19 for which each similarity coefficient @xmath47 is either @xmath49 or @xmath50 .",
    "a matrix @xmath19 of this form amounts to a ( finite , undirected ) reflexive graph with vertex - set @xmath28 , with an edge between @xmath21 and @xmath22 if and only if @xmath222 .",
    "( that is , @xmath19 is the * adjacency matrix * of the graph . )",
    "our standing hypotheses on @xmath19 then imply that @xmath223 for all @xmath21 , so every vertex has a loop on it ; this is the meaning of * reflexive*.    what is the maximum diversity of the adjacency matrix of a graph ?    to state the answer , we recall some terminology . vertices @xmath224 and @xmath225 of a graph are * adjacent * , written",
    "@xmath226 , if there is an edge between them .",
    "( in particular , every vertex of a reflexive graph is adjacent to itself . )",
    "a set of vertices is * independent * if no two distinct vertices are adjacent .",
    "the * independence number * @xmath227 of a graph @xmath228 is the maximal cardinality of an independent set of vertices of @xmath228 .",
    "[ propn : graph - main ] let @xmath228 be a reflexive graph with adjacency matrix @xmath19 . then the maximum diversity @xmath186 is equal to the independence number @xmath227",
    ".    we will maximize the diversity of order @xmath30 and apply theorem  [ thm : main ] .",
    "for any probability distribution @xmath24 on the vertex - set @xmath28 , we have @xmath229    first we show that @xmath230 .",
    "choose an independent set @xmath107 of maximal cardinality , and define @xmath126 by @xmath231 for each @xmath65 , the sum on the right - hand side of equation   is @xmath232 .",
    "hence @xmath233 , and so @xmath234 .",
    "now we show that @xmath235 .",
    "let @xmath126 .",
    "choose an independent set @xmath236 with maximal cardinality among all independent subsets of @xmath61 .",
    "then every vertex of @xmath61 is adjacent to at least one vertex in @xmath107 , otherwise we could adjoin it to @xmath107 to make a larger independent subset .",
    "hence @xmath237 so there exists @xmath125 such that @xmath238 , where @xmath239 denotes the cardinality of @xmath107 .",
    "but @xmath240 , so @xmath241 as required .",
    "[ rmk : graph - proof ] the first part of the proof ( together with corollary  [ cor : irrelevance ] ) shows that a maximizing distribution can be constructed by taking the uniform distribution on some independent set of largest cardinality , then extending by zero to the whole vertex - set . except in the trivial case",
    "@xmath70 , this maximizing distribution never has full support .",
    "we return to this point in section  [ sec : elim ] .",
    "[ eg : graph - lin3 ] the reflexive graph @xmath242 ( loops not shown ) has adjacency matrix @xmath243 .",
    "the independence number of @xmath228 is @xmath76 ; this , then , is the maximum diversity of @xmath19 .",
    "there is a unique independent set of cardinality @xmath76 , and a unique maximizing distribution , @xmath244 .",
    "[ eg : graph - lin4 ] the reflexive graph @xmath245 again has independence number @xmath76 .",
    "there are three independent sets of maximal cardinality , so by remark  [ rmk : graph - proof ] , there are at least three maximizing distributions , @xmath246 all with different supports .",
    "( the possibility of multiple maximizing distributions was also observed in the case @xmath183 by pavoine and bonsall  @xcite . ) in fact , there are further maximizing distributions not constructed in the proof of proposition  [ propn : graph - main ] , namely , @xmath247 and @xmath248 for any @xmath249 .",
    "let @xmath55 be a metric on @xmath250 .",
    "for a given @xmath251 , the * covering number * @xmath252 is the minimum cardinality of a subset @xmath253 such that @xmath254 where @xmath255 . the number @xmath256 is known as the * @xmath257-entropy * of @xmath55  @xcite .",
    "now define a matrix @xmath258 by @xmath259 then @xmath258 is the adjacency matrix of the reflexive graph @xmath228 with vertices @xmath250 and @xmath260 if and only if @xmath261 .",
    "thus , a subset of @xmath262 is independent in @xmath228 if and only if @xmath263 for every @xmath264 .",
    "it is a consequence of the triangle inequality that @xmath265 and so by proposition  [ propn : graph - main ] , @xmath266 recalling that @xmath267 extends the classical notion of rnyi entropy , this thoroughly justifies the name of @xmath257-entropy ( which was originally justified by vague analogy ) .",
    "the moral of the proof of proposition  [ propn : graph - main ] is that by performing the simple task of maximizing diversity of order @xmath30 , we automatically maximize diversity of all other orders . here is an example of how this can be exploited .",
    "recall that every graph @xmath228 has a * complement * @xmath268 , with the same vertex - set as @xmath228 ; two vertices are adjacent in @xmath268 if and only if they are not adjacent in @xmath228 .",
    "thus , the complement of a reflexive graph is irreflexive ( has no loops ) , and vice versa .",
    "a set @xmath107 of vertices in an irreflexive graph @xmath269 is a * clique * if all pairs of distinct elements of @xmath107 are adjacent in @xmath269 .",
    "the * clique number * @xmath270 of @xmath269 is the maximal cardinality of a clique in @xmath269 .",
    "thus , @xmath271 .",
    "we now recover a result of berarducci , majer and novaga ( * ? ? ?",
    "* proposition  5.10 ) .",
    "[ cor : capacity ] let @xmath269 be an irreflexive graph .",
    "then @xmath272 where the supremum is over probability distributions @xmath24 on the vertex - set of @xmath269 , and the sum is over pairs of adjacent vertices of @xmath269 .",
    "write @xmath28 for the vertex - set of @xmath269 , and @xmath19 for the adjacency matrix of the reflexive graph @xmath273 .",
    "then for all @xmath169 , @xmath274hence by theorem  [ thm : main ] and proposition  [ propn : graph - main ] , @xmath275    it follows from this proof and remark  [ rmk : graph - proof ] that @xmath276 can be maximized as follows : take the uniform distribution on some clique in @xmath269 of maximal cardinality , then extend by zero to the whole vertex - set .",
    "[ rmk : no - quick - clique ] proposition  [ propn : graph - main ] implies that computationally , finding the maximum diversity of an arbitrary @xmath19 is at least as hard as finding the independence number of a reflexive graph .",
    "this is a very well - studied problem , usually presented in its dual form ( find the clique number of an irreflexive graph ) and called the maximum clique problem  @xcite .",
    "it is @xmath277-hard , so on the assumption that @xmath278 , there is no polynomial - time algorithm for computing maximum diversity , nor even for computing the support of a maximizing distribution .",
    "the theory of magnitude of metric spaces runs most smoothly when the matrices @xmath19 concerned are positive definite  @xcite .",
    "we will see that positive ( semi)definiteness is also an important condition when maximizing diversity .",
    "any positive definite matrix is invertible and therefore has a unique weighting .",
    "( a positive semidefinite matrix need not have a weighting at all . ) now the crucial fact about magnitude is :    [ lemma : pos - def - variational ] let @xmath111 be a positive semidefinite @xmath18 real matrix admitting a weighting .",
    "then @xmath279 if @xmath111 is positive definite then the supremum is attained by exactly the nonzero scalar multiples @xmath37 of the unique weighting on @xmath111 .",
    "this is a small extension of ( * ? ? ?",
    "* proposition  2.4.3 ) .",
    "choose a weighting @xmath112 on @xmath111 . by the cauchy ",
    "schwarz inequality , @xmath280 or equivalently @xmath281 for all @xmath35 .",
    "equality holds when @xmath37 is a scalar multiple of @xmath112 , and if @xmath111 is positive definite , it holds only then .",
    "finally , taking @xmath282 in   and using positive semidefiniteness gives @xmath283 .",
    "from this , we deduce :    [ lemma : pos - def - sub ] let @xmath284 .",
    "if @xmath19 is positive semidefinite and both @xmath19 and @xmath103 admit a weighting , then @xmath285 .",
    "moreover , if @xmath19 is positive definite and the unique weighting on @xmath19 has full support , then @xmath286 .",
    "the first statement follows from lemma  [ lemma : pos - def - variational ] and the fact that @xmath103 is positive semidefinite .",
    "the second is trivial if @xmath287 . assuming not ,",
    "let @xmath288 be the unique weighting on @xmath103 ( which is positive definite ) , and write @xmath35 for the extension of @xmath289 by zero to @xmath28 .",
    "then @xmath290 , @xmath291 , and @xmath292 but @xmath37 does not have full support , so by hypothesis , it is not a scalar multiple of the unique weighting on @xmath19 .",
    "hence by lemma  [ lemma : pos - def - variational ] , @xmath293 .",
    "we now apply this result on magnitude to the maximization of diversity .",
    "[ propn : pos - def - max ] suppose that @xmath19 is positive semidefinite . if @xmath19 has a nonnegative weighting @xmath112 , then @xmath294 and @xmath295 is a maximizing distribution .",
    "moreover , if @xmath19 is positive definite and its unique weighting @xmath112 is positive then @xmath295 is the unique maximizing distribution .",
    "this follows from theorem  [ thm : comp ] and lemma  [ lemma : pos - def - sub ] .",
    "in particular , if @xmath19 is positive semidefinite and has a nonnegative weighting , then its maximum diversity can be computed in polynomial time .",
    "[ cor : pos - def - support ]",
    "if @xmath19 is positive definite with positive weighting , then its unique maximizing distribution has full support .    in other words , when @xmath19 has these properties , its maximizing distribution eliminates no species . here",
    "are three classes of such matrices @xmath19 .",
    "[ eg : ultra ] call @xmath19 * ultrametric * if @xmath296 for all @xmath297 and @xmath298 for all @xmath21 .",
    "( under the assumptions   on @xmath19 , the latter condition just states that distinct species are not completely similar . )",
    "if @xmath19 is ultrametric then @xmath19 is positive definite with positive weighting , by ( * ? ? ?",
    "* proposition  2.4.18 ) .",
    "such matrices arise in practice : for instance , @xmath19 is ultrametric if it is defined from a phylogenetic or taxonomic tree as in examples  [ eg : sim - phylo ] and  [ eg : sim - taxo ] .",
    "let @xmath299 be a probability distribution of full support , and write @xmath19 for the diagonal matrix with entries @xmath300 .",
    "then for @xmath301 , @xmath302 the right - hand side is the * rnyi relative entropy * or * rnyi divergence * @xmath303 ( * ? ? ?",
    "* section  3 ) . evidently @xmath19 is positive definite , and its unique weighting @xmath304 is positive .",
    "( in fact , @xmath19 is ultrametric . )",
    "so proposition  [ propn : pos - def - max ] applies ; in fact , it gives the classical result that @xmath305 with equality if and only if @xmath306 .",
    "[ eg : id - pos - def ] the identity matrix @xmath70 is certainly positive definite with positive weighting . by topological arguments ,",
    "there is a neighbourhood @xmath307 of @xmath53 in the space of symmetric matrices such that every matrix in @xmath307 also has these properties .",
    "( see the proofs of ( * ? ? ? * propositions  2.2.6 and  2.4.6 ) . )",
    "quantitative versions of this result are also available . for instance , in  ( * ? ? ?",
    "* proposition  2.4.17 ) it was shown that @xmath19 is positive definite with positive weighting if @xmath223 for all @xmath21 and @xmath308 for all @xmath309 .",
    "in fact , this result can be improved :    suppose that @xmath223 for all @xmath310 and that @xmath19 is * strictly diagonally dominant * ( that is , @xmath311 for all @xmath21 ) .",
    "then @xmath19 is positive definite with positive weighting .    since @xmath19 is real symmetric , it is diagonalizable with real eigenvalues . by the hypotheses on @xmath19 and",
    "the gershgorin disc theorem  ( * ? ? ?",
    "* theorem 6.1.1 ) , every eigenvalue of @xmath19 is in the interval @xmath312 .",
    "it follows that @xmath19 is positive definite and that every eigenvalue of @xmath313 is in @xmath314 .",
    "hence @xmath315 is similar to a diagonal matrix with entries in @xmath314 , and so @xmath316 converges to @xmath317 .",
    "thus , @xmath318 writing @xmath319 , the unique weighting on @xmath19 is @xmath320 .",
    "the hypotheses on @xmath19 imply that @xmath321 has nonnegative entries and @xmath322 has positive entries .",
    "hence by  , @xmath323 entrywise , and so @xmath112 is positive .",
    "thus , a matrix @xmath19 that is ultrametric , or satisfies   and is strictly diagonally dominant , has many special properties : the maximum diversity is equal to the magnitude , there is a unique maximizing distribution , the maximizing distribution has full support , and both the maximizing distribution and the maximum diversity can be computed in polynomial time .",
    "we saw in examples  [ eg : graph - lin3 ] and  [ eg : graph - lin4 ] that for certain similarity matrices @xmath19 , none of the maximizing distributions has full support .",
    "mathematically , this simply means that maximizing distributions sometimes lie on the boundary of @xmath144 . but ecologically , it may sound shocking : is it reasonable that diversity can be increased by _ eliminating _ some species ?",
    "we argue that it is .",
    "consider , for instance , a forest consisting of one species of oak and ten species of pine , with each species equally abundant .",
    "suppose that an eleventh species of pine is added , again with equal abundance ( figure  [ fig : pine ] ) .",
    "this makes the forest even more heavily dominated by pine , so it is intuitively reasonable that the diversity should decrease . but now running time backwards , the conclusion is that if we start with a forest containing the oak and all eleven pine species , eliminating the eleventh should _ increase _ diversity .",
    "( 110,31 ) ( 55,-1)(0,0)[b ] ) and ten species of pine ( @xmath324 ) , to which one further species of pine is then added ( @xmath325 ) .",
    "distances between species indicate degrees of dissimilarity ( not to scale).,title=\"fig : \" ] ( 11.2,24.5)(0,0)[c]oak ( 87,28.5)(0,0)[c]pine    to clarify further , recall from section  [ sec : model ] that diversity is defined in terms of the _ relative _ abundances only . thus , eliminating species @xmath21 causes not only a decrease in @xmath184 , but also an increase in the other relative abundances @xmath326 .",
    "if the @xmath21th species is particularly ordinary within the community ( like the eleventh species of pine ) , then eliminating it makes way for less ordinary species , resulting in a more diverse community .    the instinct that maximizing diversity should not eliminate any species",
    "is based on the assumption that the distinction between species is of high value .",
    "( after all , if two species were very nearly identical  or in the extreme , actually identical  then losing one would be of little importance . ) if one wishes to make that assumption , one must build it into the model .",
    "this is done by choosing a similarity matrix @xmath19 with a low similarity coefficient @xmath47 for each @xmath309 .",
    "thus , @xmath19 is close to the identity matrix @xmath53 ( assuming that similarity is measured on a scale of @xmath49 to @xmath50 ) .",
    "example  [ eg : id - pos - def ] guarantees that in this case , there is a unique maximizing distribution and it does not , in fact , eliminate any species .",
    "( the fact that maximizing distributions can eliminate some species has previously been discussed in the ecological literature in the case @xmath183 ; see pavoine and bonsall  @xcite and references therein . )",
    "we now derive necessary and sufficient conditions for a similarity matrix @xmath19 to admit at least one maximizing distribution of full support , and also necessary and sufficient conditions for _ every _ maximizing distribution to have full support .",
    "the latter conditions are genuinely more restrictive ; for instance , if @xmath327 then some but not all maximizing distributions have full support .    [ lemma : elim - main ] if at least one maximizing distribution for @xmath19 has full support then @xmath19 is positive semidefinite and admits a positive weighting . moreover , if every maximizing distribution for @xmath19 has full support then @xmath19 is positive definite .",
    "fix a maximizing distribution @xmath24 of full support . maximizing distributions",
    "are invariant ( corollary  [ cor : max - invt ] ) , so by ( [ part : invt - invt])@xmath132([part : invt - ext ] ) of lemma  [ lemma : invt ] , @xmath328 is a weighting of @xmath19 and @xmath329 .",
    "in particular , @xmath19 has a positive weighting .",
    "now we imitate the proof of proposition  3b of  @xcite . for each @xmath330 such that @xmath331 , define a function @xmath332 by @xmath333 using the symmetry of @xmath19 and the fact that @xmath328 is a weighting , we obtain @xmath334 now @xmath335 and @xmath24 has full support , so @xmath336 for all real @xmath85 sufficiently close to zero . but @xmath337 for such @xmath85 , so @xmath338 has a local minimum at @xmath49 . hence @xmath339 .",
    "it follows that @xmath338 is everywhere positive .",
    "we have shown that @xmath339 whenever @xmath340 with @xmath335 . now take @xmath35 with @xmath341 .",
    "put @xmath342 .",
    "then @xmath335 , and @xmath343 hence @xmath19 is positive semidefinite .    for ` moreover ' , assume that every maximizing distribution for @xmath19 has full support . by  ,",
    "we need only show that @xmath344 whenever @xmath345 with @xmath335 .",
    "given such an @xmath346 , choose @xmath347 such that @xmath348 lies on the boundary of @xmath144 .",
    "then @xmath348 does not have full support , so is not maximizing , so does not maximize @xmath349 ( by corollary  [ cor : irrelevance ] ) .",
    "hence @xmath350 , which by   implies that @xmath344 .",
    "we can now prove the two main results of this section .",
    "[ propn : semi ] the following are equivalent :    1 .",
    "[ part : semivec ] there exists a maximizing distribution for @xmath19 of full support ; 2 .",
    "[ part : semidef ] @xmath19 is positive semidefinite and admits a positive weighting .",
    "( [ part : semivec])@xmath132([part : semidef ] ) is the first part of lemma  [ lemma : elim - main ] . for the converse , assume  ( [ part : semidef ] ) and",
    "choose a positive weighting @xmath112 . then @xmath351 , so @xmath352 is a probability distribution of full support .",
    "we have @xmath353 for all @xmath0 , by lemma  [ lemma : invt ] .",
    "but the computation theorem implies that @xmath354 for some @xmath102 such that @xmath103 admits a weighting , so @xmath355 by lemma  [ lemma : pos - def - sub ] .",
    "hence @xmath24 is maximizing .",
    "the following are equivalent :    1 .",
    "[ part : vec ] every maximizing distribution for @xmath19 has full support ; 2 .",
    "[ part : unique ] @xmath19 has exactly one maximizing distribution , which has full support ; 3 .",
    "[ part : def ] @xmath19 is positive definite with positive weighting ; 4 .",
    "[ part : crit ] @xmath356 for every nonempty proper subset @xmath107 of @xmath357 .",
    "( the weak inequality @xmath358 holds for any @xmath19 , by the absent species lemma ( lemma  [ lemma : abs ] ) . )    ( [ part : vec])@xmath132([part : def ] ) and ( [ part : def])@xmath132([part : unique ] ) are immediate from lemma  [ lemma : elim - main ] and proposition  [ propn : pos - def - max ] respectively , while ( [ part : unique])@xmath132([part : vec ] ) is trivial .    for ( [ part : vec])@xmath132([part : crit ] ) , assume  ( [ part : vec ] ) .",
    "let @xmath359 .",
    "choose a maximizing distribution @xmath25 for @xmath103 , and denote by @xmath24 its extension by zero to @xmath28 .",
    "then @xmath24 does not have full support , so there is some @xmath10 $ ] such that @xmath24 fails to maximize @xmath29 .",
    "hence @xmath360 where the second equality is by the absent species lemma .    for ( [ part : crit])@xmath132([part : vec ] ) ,",
    "assume  ( [ part : crit ] ) .",
    "let @xmath24 be a maximizing distribution for @xmath19 .",
    "write @xmath133 , and denote by @xmath25 the restriction of @xmath24 to @xmath107 . then for any @xmath0 , @xmath361 again by the absent species lemma .",
    "hence by  ( [ part : crit ] ) , @xmath362 .",
    "the main theorem , the computation theorem and corollary  [ cor : irrelevance ] answer all the principal questions about maximizing the diversities  @xmath29 . nevertheless , certain questions remain .",
    "first , there are computational questions .",
    "we have found two classes of matrix @xmath19 for which the maximum diversity and maximizing distributions can be computed in polynomial time : ultrametric matrices ( example  [ eg : ultra ] ) and those close to the identity matrix @xmath53 ( example  [ eg : id - pos - def ] ) . both are biologically significant . are there other classes of similarity matrix for which the computation can be performed in less than exponential time ?",
    "second , we may seek results on maximization of @xmath23 under constraints on @xmath24 .",
    "there are certainly some types of constraint under which both parts of theorem  [ thm : main ] fail , for trivial reasons : if we choose two distributions @xmath24 and @xmath25 whose diversity profiles cross ( figure  [ fig : main](b ) ) and constrain our distribution to lie in the set @xmath363 , then there is no distribution that maximizes @xmath29 for all @xmath0 simultaneously , and the maximum value of @xmath29 also depends on @xmath0 . but are there other types of constraint under which the main theorem still holds ?    in particular , the distribution might be constrained to lie close to a given distribution @xmath24 .",
    "the question then becomes : if we start with a distribution @xmath24 and have the resources to change it by only a given small amount , what should we do in order to maximize the diversity ?",
    "third , we have seen that every symmetric matrix @xmath19 satisfying   ( for instance , every symmetric matrix of positive reals ) has attached to it a real number , the maximum diversity @xmath186 .",
    "what is the significance of this invariant ?",
    "we know that it is closely related to the magnitude of matrices .",
    "this has been most intensively studied in the context of metric spaces . by definition ,",
    "the magnitude of a finite metric space @xmath269 is the magnitude of the matrix @xmath364 ; see @xcite , for instance . in the metric context ,",
    "the meaning of magnitude becomes clearer after one extends the definition from finite to compact spaces ( which is done by approximating them by finite subspaces ) .",
    "magnitude for compact metric spaces has recognizable geometric content : for example , the magnitude of a 3-dimensional ball is a cubic polynomial in its radius ( * ? ? ?",
    "* theorem  2 ) , and the magnitude of a homogeneous riemannian manifold is closely related to its total scalar curvature  ( * ? ? ?",
    "* theorem  11 ) .",
    "thus , it is natural to ask : can one extend theorem  [ thm : main ] to some class of ` infinite matrices ' @xmath19 ? ( for instance , @xmath19 might be the form @xmath365 arising from a compact metric space . in this case , the maximum diversity of order @xmath76 is a kind of capacity , analogous to classical definitions in potential theory ; for a compact subset of @xmath366 , it coincides with the bessel capacity of an appropriate order  @xcite . ) and if so , what is the geometric significance of maximum diversity in that context ?",
    "there is already evidence that this is a fruitful line of enquiry . in  @xcite , meckes gave a definition of the maximum diversity of order @xmath76 of a compact metric space , and used it to prove a purely geometric theorem relating magnitude to fractional dimensions of subsets of @xmath366 . if this maximum diversity can be shown to be equal to the maximum diversity of all other orders then further geometric results may come within reach .    the fourth and final question concerns interpretation .",
    "throughout , we have interpreted @xmath23 in terms of ecological diversity . however , there is nothing intrinsically biological about any of our results .",
    "for example , in an information - theoretic context , the ` species ' might be the code symbols , with two symbols seen as similar if one is easily mistaken for the other ; or if one wishes to transmit an image , the ` species ' might be the colours , with two colours seen as similar if one is an acceptable substitute for the other ( much as in rate distortion theory  @xcite ) . under these or other interpretations ,",
    "what is the significance of the theorem that the diversities of all orders can be maximized simultaneously ?",
    "we thank christina cobbold , ciaran mccreesh and richard reeve for helpful discussions .",
    "this work was supported by the carnegie trust for the universities of scotland , the centre de recerca matemtica , an epsrc advanced research fellowship , the national institute for mathematical and biological synthesis , the national science foundation , and the simons foundation .",
    "a.  jeziorski , a.  j. tanentzap , n.  d. yan , a.  m. paterson , m.  e. palmer , j.  b. korosi , j.  a. rusak , m.  t. arts , w.  keller , r.  ingram , a.  cairns , and j.  p. smol .",
    "the jellification of north temperate lakes .",
    ", 282:20142449 , 2015 .",
    "a.  rnyi . on measures of entropy and information . in j.",
    "neymann , editor , _",
    "4th berkeley symposium on mathematical statistics and probability _ , volume  1 , pages 547561 .",
    "university of california press , 1961 .",
    "l.  wang , m.  zhang , s.  jajodia , a.  singhal , and m.  albanese . modeling network diversity for evaluating the robustness of networks against zero - day attacks . in",
    "_ proceedings of the 19th european symposium on research in computer security ( esorics 2014 ) _ , pages 494511 , 2014 ."
  ],
  "abstract_text": [
    "<S> entropy , under a variety of names , has long been used as a measure of diversity in ecology , as well as in genetics , economics and other fields . </S>",
    "<S> there is a spectrum of viewpoints on diversity , indexed by a real parameter @xmath0 giving greater or lesser importance to rare species . </S>",
    "<S> leinster and cobbold  @xcite proposed a one - parameter family of diversity measures taking into account both this variation and the varying similarities between species . </S>",
    "<S> because of this latter feature , diversity is not maximized by the uniform distribution on species . </S>",
    "<S> so it is natural to ask : which distributions maximize diversity , and what is its maximum value ? + in principle , both answers depend on @xmath0 , but our main theorem is that neither does . </S>",
    "<S> thus , there is a single distribution that maximizes diversity from all viewpoints simultaneously , and any list of species has an unambiguous maximum diversity value . </S>",
    "<S> furthermore , the maximizing distribution(s ) can be computed in finite time , and any distribution maximizing diversity from some particular viewpoint @xmath1 actually maximizes diversity for all @xmath0 . </S>",
    "<S> + although we phrase our results in ecological terms , they apply very widely , with applications in graph theory and metric geometry . </S>"
  ]
}