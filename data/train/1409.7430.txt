{
  "article_text": [
    "tropical geometry is a piecewise - linear shadow of algebraic geometry that preserves important geometric invariants .",
    "often , we can derive statements about algebraic varieties by means of these ( easier ) combinatorial objects .",
    "one general difficulty in this approach is that the tropicalization strongly depends on the embedding of the algebraic variety .",
    "thus , the task of finding a suitable embedding or repairing a given `` bad '' embedding to obtain a nicer tropicalization becomes essential for many applications .",
    "the purpose of this paper is to advertise tropical modifications as a tool to locally repair embeddings of plane curves , as suggested by mikhalkin in his icm 2006 lecture  @xcite .",
    "an important and motivating example is the case of elliptic curves . in ( * ? ? ?",
    "* example 3.15 ) , mikhalkin proposed the cycle length of a tropical plane elliptic cubic to be the tropical counterpart of the classical @xmath0-invariant . inspired by this remark and using grbner fan techniques , katz , markwig and the second author proved that when the elliptic cubic is defined over the puiseux series field , the valuation of the @xmath0-invariant is generically reflected on the cycle length of the tropical curve  @xcite . for special choices of coefficients ,",
    "this length can be shorter than expected .",
    "these non - generic situations have a very explicit characterization .",
    "first , the cycle in the tropical curve must contain a vertex of valency at least four , and second , the initial form of the discriminant of the cubic must vanish .",
    "thus , in the case of plane elliptic cubics , or more generally , for elliptic curves embedded smoothly into a toric surface , the question of what constitutes a good embedding from the tropical perspective has a precise answer : the cycle length should reflect the negative valuation of the @xmath0-invariant .",
    "one of the main contributions of the present paper is an algorithm that recursively repairs bad embeddings when the tropical plane elliptic cubic contains a cycle .",
    "the power of algorithm  [ alg : repairelliptic ] lies in its simplicity : it only uses linear tropical modifications of the plane , and linear re - embeddings of the original curve .",
    "furthermore , this result is achieved in dimension 4 .",
    "this approach has an additional advantage . rather than drastically changing the polyhedral structure of the input tropical curve",
    ", it keeps its relevant features .",
    "it only adds missing edges and changes tropical multiplicities .",
    "the output tropical curve has the expected cycle length .",
    "we view this as a possibility to `` locally repair '' the problematic initial embedding .",
    "the case of elliptic curves suggests itself as a playground for uncovering the deep connections between berkovich s theory , tropicalizations , and re - embeddings . more concretely ,",
    "let @xmath2 be a smooth elliptic curve and @xmath3 be a semistable regular model of @xmath2 over a discrete valuation ring .",
    "let us assume that @xmath2 has bad reduction .",
    "then , the minimal berkovich skeleton of the complete analytic curve @xmath4 is homotopic to a circle and it can be obtained from the dual graph of the special fiber of @xmath3 .",
    "foundational work of baker , payne and rabinoff proves that when the embedding induces a faithful tropicalization on the cycle , the length appearing in the minimal berkovich skeleton induced by its canonical metric equals the corresponding lattice length in the tropicalization of @xmath2  ( * ? ? ?",
    "* section 6 ) .",
    "notably , ( * ? ? ?",
    "* section 7 ) provides examples where the cycle in a tropicalization of a smoothly embedded elliptic curve is shorter , or longer , than the negative valuation of the @xmath0-invariant .",
    "good embeddings of elliptic curves with bad reduction are those where the minimal skeleton of the complete analytic curve is reflected in the associated tropical curve .",
    "characterizing good embeddings of curves in terms of their minimal berkovich skeleta has one clear advantage compared to the study of tropicalizations : it is intrinsic to the curve .",
    "work of payne shows that the berkovich space @xmath5 is the limit of all tropicalizations of @xmath2 with respect to closed embeddings into quasiprojective toric varieties ( see  ( * ? ? ?",
    "* theorem 4.2 ) ) .",
    "we view @xmath5 as a topological object incorporating all choices of embeddings .    after the investigation by baker , payne and rabinoff  @xcite , the meaning of suitable embeddings of curves for tropicalization purposes becomes precise : they should induce _",
    "faithful tropicalizations_. that is , the corresponding tropical curve must be realized as a closed subset of @xmath5 , and this identification should preserve both metric structures .",
    "faithful tropicalizations of mumfurd curves of genus 2 have been recently studied by wagner in  @xcite . in the case of plane",
    "elliptic cubics , we can reinterpret the main result of  @xcite in the language of berkovich s theory by saying that the tropicalization to a @xmath6-valent cubic is always faithful on the cycle .",
    "this follows from the fact that all edges in a tropical cubic with a cycle have multiplicity @xmath7 , see  ( * ? ? ?",
    "* theorem 6.24 and 6.25 ) .",
    "two natural questions arise from the previous discussion .",
    "first , can we effectively construct embeddings of a given curve that induce faithful tropicalizations ?",
    "can we do so without computing a minimal berkovich skeleton of the complete curve ?",
    "again , the case of elliptic cubics is a fantastic playground for exploring this question , since the faithfulness on its cycle can easily be characterized in terms of the @xmath0-invariant . following this approach , chan and sturmfels described a procedure to put any given plane elliptic cubic with bad reduction into honeycomb form  @xcite .",
    "the honeycomb form is @xmath6-valent and has edges of multiplicity @xmath7 , hence it induces a faithful tropicalization and the cycle has the expected length . although running in exact arithmetic , their method involves the resolution of a univariate degree 6 equation . each solution is expressed as a laurent series in the sixth root of the multiplicative inverse of the @xmath0-invariant .",
    "the solution is constructed recursively , one term at a time .",
    "this re - embedding completely alters the structure of the original tropical curve .",
    "in contrast , our approach allows us to give a positive and effective answer to the questions above .",
    "our algorithm to repair embeddings of plane elliptic cubics relies on methods we develop in section  [ sec : repa - trop ] for arbitrary plane curves .",
    "theorems  [ thm : redvertex ] and  [ thm : fatedge ] allow us to locally repair certain embeddings of curves using a linear tropical modification of the plane .",
    "they should be viewed as a partial answer to the questions above .",
    "they hold under certain constraints imposed by the local topology of the input tropical curve .",
    "nonetheless , these two technical results suffice to completely handle the case of plane elliptic cubics . as a byproduct ,",
    "we enrich payne s result ( * ? ? ?",
    "* theorem 4.2 ) for plane elliptic cubics connecting the berkovich space to the limit of all tropicalizations by a concrete procedure that gives the desired tropically faithful embedding using only linear tropical modifications of the plane .",
    "our experiments in section  [ sec : experiments ] suggest that the techniques introduced in this paper may be extended to other combinatorial types of tropical curves , although new ideas will be required to generalize theorems  [ thm : redvertex ] and  [ thm : fatedge ] .",
    "we have mentioned already that @xmath1-discriminants of cubic polynomials play a key role when studying the @xmath0-invariant of a plane elliptic cubic . in the same spirit , theorems  [ thm : redvertex ] and  [ thm : fatedge ] also involve `` local discriminants '' associated to certain maximal cells in the newton subdivision of the input plane curve . in section  [ sec : repa - ellipt - cubics ] we derive algorithm  [ alg : repairelliptic ] in an elementary fashion , by relating the global discriminant of the cubic to the local discriminants mentioned above .",
    "this is the content of corollary  [ cor : initialdiscriminant ] .",
    "theorem  [ thm : factorizationformula ] provides a factorization formula for initial forms of discriminants of planar configurations .",
    "we expect this result to have further applications besides algorithm  [ alg : repairelliptic ] .",
    "the rest of the paper is organized as follows . in section  [ sec : trop - modif - line ] , we introduce notation and discuss background on tropicalizations , modifications and linear re - embeddings . in lemma",
    "[ lem : modifviaprojections ] , we characterize linear re - embeddings of plane curve induced by tropical modifications along straight lines in terms of charts and coordinates changes of @xmath8 .",
    "thus , we can visualize the repaired embeddings by means of collections of tropical plane curves . in sections",
    "[ sec : berk - skel - curv ] and  [ sec : discriminants ] we discuss preliminaries involving berkovich skeleta and @xmath1-discriminants , which play a prominent role in our study .    in section  [ sec : repa - trop ] , we present our two main technical tools to locally repair embeddings of smooth plane curves by linear re - embeddings .",
    "our proof builds upon berkovich s theory , @xmath1-discriminants of plane configurations , and lemma  [ lem : modifviaprojections ] . by using linear tropical modifications and",
    "coordinate changes of @xmath8 , the tropical re - embedded curve will faithfully represent a subgraph of a skeleton of the analytic curve induced by its set of punctures .    in section  [ sec : trop - ellipt - curv ] , we focus our attention on plane elliptic curves and present algorithm  [ alg : repairelliptic ] .",
    "we provide two independent proofs of its correctness .",
    "the first one relies on the techniques developed in section  [ sec : repa - trop ] and is discussed in section  [ sec : repair - elliptic ] .",
    "the second one is elementary : it is based purely on discriminants of plane configurations .",
    "we present it in section  [ sec : repa - ellipt - cubics ] .",
    "the main result of this section is theorem  [ thm : factorizationformula ] , which relates global and local discriminants of planar point configurations .    in section  [ sec : experiments ] we provide several experimental evidence to support the use of our repairing techniques in examples that are not covered by theorems  [ thm : redvertex ] and  [ thm : fatedge ] .",
    "we view this last section as a motivation to further study this topic .",
    "we work with ideals @xmath9 defining irreducible subvarieties of a torus and denote their _ tropicalizations _ by @xmath10 ( see e.g.  @xcite ) . throughout this paper",
    "we often work with complete curves and their minimal berkovich skeleta . for this reason",
    ", we always consider our ideals inside honest polynomial rings rather than laurent polynomial rings . for tropicalization",
    ", we consider the intersection of the curve with the algebraic torus in the given embedding .    for concrete computations , we fix the field of _ generalized puiseux - series _",
    "@xmath11 , with valuation taking a series to its leading exponent . for tropicalizations ,",
    "we use the negative of the valuation , i.e.  the _ max - convention_. we denote our algebraic coordinates by @xmath12 , whereas we indicate the tropical coordinates by @xmath13 .",
    "we use analogous conventions in higher dimensions .",
    "tropical modifications appeared in @xcite and have since then found several interesting applications , e.g.  @xcite . here , we concentrate on modifications of the plane @xmath8 along linear divisors .",
    "let @xmath14 be a linear tropical polynomial with @xmath15 and @xmath16 in @xmath17 .",
    "the graph of @xmath18 considered as a function on @xmath8 consists of at most three linear pieces . at each break line , we attach two - dimensional cells spanned in addition by the vector @xmath19 ( see e.g.  ( * ? ? ?",
    "* construction 3.3 ) ) .",
    "we assign multiplicity @xmath7 to each cell and obtain a balanced fan in @xmath20 .",
    "it is called the _ modification of @xmath8 along @xmath18_.    let @xmath21 $ ] be a lift of @xmath18 , i.e.  @xmath22 , @xmath23 and @xmath24 .",
    "we fix an irreducible polynomial @xmath25 $ ] defining a curve in the torus @xmath26 .",
    "the tropicalization of @xmath27 $ ] is a tropical curve in the modification of @xmath8 along @xmath18 .",
    "we call it the _ linear re - embedding _ of the tropical curve @xmath28 _ with respect to @xmath29_.    for almost all lifts @xmath29 , the linear re - embedding coincides with the modification of @xmath28 along @xmath18 , i.e.  we only bend @xmath28 so that it fits on the graph of @xmath18 and attach some downward ends",
    ". however , for some choices of lifts @xmath29 , the part of @xmath30 in the cells of the modification attached to the graph of @xmath18 contains more attractive features .",
    "we are most interested in these special linear re - embeddings .",
    "the following example illustrates this phenomenon .",
    "we fix a plane elliptic cubic defined by @xmath31 we aim to modify the tropical curve @xmath28 along the vertical line @xmath32 in @xmath8 .",
    "this line corresponds to a tropical polynomial @xmath33 .",
    "its lifting @xmath29 is of the form @xmath34 where @xmath35 has valuation 0 .",
    "the tropicalization @xmath30 depends only on the initial coefficient of @xmath36 .",
    "indeed , unless this coefficient is one , this tropical curve coincides with the modification of @xmath28 along @xmath18 .",
    "figure  [ fig : originalellipticmodification ] shows the special linear re - embedding when @xmath37 .     with respect to @xmath38 together with the projections @xmath39 and @xmath40 .",
    "the original curve is drawn at the bottom , whereas a new curve @xmath41 appears on the right .",
    "the central picture shows the tropical curve @xmath30 in the modified plane . ]",
    "our main focus in section  [ sec : repa - trop ] will be on modifications of @xmath8 along vertical lines .",
    "these modifications are induced by tropical polynomials of the form @xmath42 , with @xmath43 .",
    "their liftings are of the form @xmath44 where @xmath35 has valuation 0 .",
    "as we see in figure  [ fig : originalellipticmodification ] , the modified plane contains three maximal cells : @xmath45 by construction , @xmath46 is the unique cell of the modification of @xmath8 attached to the graph of @xmath18 .",
    "we let @xmath47 denote the relative interior of the cell @xmath48 , for @xmath49 .",
    "we describe @xmath30 by means of two projections :    1 .",
    "the projection @xmath39 to the coordinates @xmath50 produces the original curve @xmath28 , 2 .",
    "the projection @xmath40 gives a new tropical plane curve @xmath41 inside the cells @xmath51 and @xmath46 , where @xmath52 .",
    "the polynomial @xmath53 generates the elimination ideal @xmath54 $ ] .",
    "notice that the projection @xmath55 gives no information about @xmath30 since it maps any tropical curve to the tropical line with vertex @xmath56 .",
    "the following lemma explains how to reconstruct the curve @xmath30 inside this modified plane using the two relevant projections above .",
    "[ lem : modifviaprojections ] the linear re - embedding @xmath57 in the modification of @xmath8 along the linear tropical polynomial @xmath58 is completely determined by the two tropical plane curves @xmath28 and @xmath41 , where @xmath59 . in particular , the vertices of @xmath60 along the line @xmath61 are the endpoints of the connected components of @xmath62 .",
    "first , we fix a point @xmath63 with either @xmath64 or @xmath65 , thus in the relative interior of one of the cells @xmath48 , for @xmath66 .",
    "we claim that @xmath63 belongs to @xmath57 if and only if one of the following two conditions hold : @xmath67 the first implication follows directly from the fundamental theorem of tropical algebraic geometry ( see e.g.  ( * ? ? ?",
    "* theorem 3.2.5 ) ) and the fact that @xmath68 . for the converse",
    ", we use the same result to lift a point @xmath69 with @xmath65 to a unique point @xmath63 in @xmath70 .",
    "this point satisfies @xmath71 .",
    "analogously , any point @xmath72 lifts uniquely to a point @xmath63 in @xmath73 , where @xmath74 .",
    "it follows that the set of points in @xmath57 outside the line @xmath61 is completely determined by the two projections @xmath28 and @xmath41 .",
    "it remains to prove that we can also detect the tropical multiplicities and all points in @xmath75 from these two projections . to see this ,",
    "notice first that the multiplicities of all edges of @xmath57 whose relative interior lies in @xmath47 for @xmath66 coincide with the corresponding multiplicities of the projected edges in @xmath28 or @xmath41 , respectively .",
    "this follows from the unique lifting property discussed above and the generalized push - forward formula for multiplicities of sturmfels - tevelev in the non - constant coefficients case  ( * ? ? ?",
    "* theorem  8.4 ) .",
    "we can also compute the multiplicity of an edge on the line @xmath61 by comparing the multiplicities of the preimages of the edge in the two charts .",
    "an edge of multiplicity zero should be interpreted as a phantom edge .",
    "this concludes our proof .",
    "using the previous result we can visualize the modification of @xmath8 along a vertical line and the effect of the linear re - embedding on the tropical curve @xmath28 by means of the two relevant projections .",
    "the colors and cell labels on the projections and the modified plane in figure  [ fig : originalellipticmodification ] indicate the nature of the fibers of each projection .",
    "the dashed line on each projection represents the image of the vertical line used to modify @xmath8 .",
    "we keep these conventions throughout this paper .    by lemma  [ lem : modifviaprojections ]",
    "we know that the features of @xmath76 are encoded in the polynomial @xmath77 . for special values of @xmath36 ,",
    "the newton subdivision of @xmath53 is unexpected and yields an interesting behavior in @xmath78 .",
    "we observe this phenomenon in figure  [ fig : originalellipticmodification ] : the cycle on the tropical curve @xmath28 was placed to the right of the vertical line @xmath32 , but in @xmath41 this cycle has been prolonged and its leftmost vertical edge has been pushed from the line @xmath79 to the line @xmath80 .",
    "this example illustrates the general principle described in the title of this paper .",
    "we discuss it further in section  [ sec : repa - trop ] .",
    "as we mention earlier , our goal is to use linear tropical modifications to repair embeddings of plane curves .",
    "let @xmath81 $ ] be a linear ideal defining a plane in @xmath82 .",
    "we re - embed the curve @xmath83 via the ideal @xmath84 . as in lemma",
    "[ lem : modifviaprojections ] , we can construct @xmath85 from suitable 2-dimensional projections .    in order to do so",
    ", we find generators of @xmath86 adapted to a fixed 2-cell @xmath87 of @xmath88 . we let @xmath89 be the local coordinates of @xmath87 .",
    "then , the corresponding variables @xmath90 must be linearly independent on @xmath86 and we can find unique polynomials @xmath91 $ ] for @xmath92 such that @xmath93    [ pr : projectionsj ] le @xmath94 and fix a two - dimensional cell @xmath87 of @xmath88 with local coordinates @xmath89 containing @xmath95 .",
    "then , the ideal @xmath96/\\operatorname{in}_{{\\omega}}(j)$ ] is isomorphic to the localization @xmath97\\subset    { \\mathbb{c}}[z_i^{\\pm } , z_j^{\\pm}][s^{-1}]$ ] , where @xmath98 $ ] and @xmath99 is the the multiplicatively closed set generated by all @xmath100 , @xmath92 .    to simplify notation , we consider all initial ideals in the statement defined by @xmath95 , rather than by the projection @xmath101 . by definition ,",
    "@xmath102 .",
    "for each @xmath92 we write @xmath103 for suitable @xmath104 . in order to prove the statement , we study the interplay of @xmath105 with @xmath106 . by  , any point @xmath107 in the plane defined by @xmath86 with @xmath108",
    "is uniquely determined by its @xmath109 coordinates . since @xmath110",
    ", the fundamental theorem of tropical algebraic geometry ensures that @xmath111 hence , @xmath112 and we conclude that @xmath113\\cap \\operatorname{in}_{{\\omega } } j = 0 $ ] because @xmath114 .",
    "therefore , the generators from   give a basis to compute @xmath115 , i.e.@xmath116 , in particular , all elements of @xmath99 are units in @xmath117/\\operatorname{in}_{{\\omega}}j$ ] .",
    "as a consequence , we construct an isomorphism @xmath118/\\operatorname{in}_{{\\omega}}j \\to { \\mathbb{c}}[z_i^{\\pm 1 } , z_j^{\\pm } ] [ s^{-1}]$ ] by @xmath119 this map induces an isomorphism between the ideals @xmath120 and @xmath121 $ ] . to prove the statement , we show that @xmath122 generates the quotient ideal @xmath123 .",
    "recall that @xmath90 and the elements of @xmath99 are units in the domain of @xmath124 .",
    "we pick a @xmath95-homogeneous polynomial @xmath125 $ ] and show that @xmath126 . by",
    "( * ? ? ? * lemma 2.12 ) , we know that @xmath127 is the initial form of an element @xmath128 .",
    "we write @xmath129 .",
    "since @xmath130 contains @xmath131 in its support but @xmath132 $ ] , an easy induction on @xmath133 ensures that @xmath134 .",
    "thus , @xmath135 , as we wanted to show .",
    "this concludes our proof .      in this section ,",
    "we outline the required background on berkovich analytic curves , their skeleta and their relationship with tropicalizations of curves . for the sake of brevity and simplicity ,",
    "we restrict our exposition to the topological aspects of analytic curves .",
    "these features are captured by skeleta of curves .",
    "we follow the approach developed by baker , payne and rabinoff in  @xcite .",
    "let @xmath136 be an algebraically closed , complete non - archimedean valued field @xmath136 with absolute value @xmath137 .",
    "our main example of interest is @xmath138 , i.e.  the field of generalized puiseux series .",
    "given an algebraic curve @xmath16 defined over @xmath136 we let @xmath139 denote its analytification .",
    "the analytification @xmath140 of an affine curve @xmath141 is the space of multiplicative seminorms @xmath142 that satisfy the non - archimedean triangle inequality @xmath143 and extend the absolute value on @xmath136 .",
    "its topology is the coarsest one such that all evaluation maps @xmath144 @xmath145 are continuous for @xmath146 .",
    "the analytification @xmath139 of a general curve @xmath16 is glued from the analytification of an affine open cover .",
    "it can be shown that @xmath139 possesses a piecewise linear structure and it is locally modeled on an @xmath147-tree  ( * ? ? ?",
    "* @xmath148 ) .",
    "the @xmath136-points of @xmath16 are embedded as a subset of the leaves of this tree .",
    "the complement of the set of leaves carries a canonical metric given by shortest paths .    in  @xcite ,",
    "berkovich introduced the notion of _ skeleta _ of an analytic space as suitable polyhedral subsets that capture the topology of the whole space .",
    "they are constructed from semistable formal models .",
    "equivalently , they can be defined by means of semistable vertex sets @xmath149 of @xmath139  ( * ? ? ?",
    "* @xmath150 , theorem  1.3 ) .",
    "they have the structure of a finite metric graph with vertex set @xmath149 . we denote them by @xmath151 . for any choice of @xmath149",
    ", there exists a deformation retract @xmath152 ( see  @xcite ) .",
    "semistable vertex sets form a poset under inclusion and induce refinement of the corresponding skeleta  ( * ? ? ?",
    "* proposition  3.13(1 ) ) .",
    "we say @xmath151 is a _ minimal skeleton _ of @xmath139 if @xmath149 is minimal .",
    "such minimal skeletons exist by",
    "* @xmath153 ) .",
    "the stable reduction theorem ensures that if the euler characteristic of @xmath16 is at most 0 , then there is a unique set - theoretic minimal skeleton of @xmath139  ( * ? ? ?",
    "* theorem 4.22 ) .",
    "this is the case when @xmath16 is smooth and non - rational . in this situation ,",
    "we write @xmath154 , or @xmath155 whenever @xmath16 is defined by the ideal @xmath9 .    from now on , let us assume that @xmath16 is a smooth connected algebraic curve over @xmath136 and let @xmath156 denote its smooth completion .",
    "let @xmath157 be its set of punctures .",
    "these punctures are contained in distinct connected components of @xmath158 . by construction ,",
    "a semistable vertex set @xmath149 of @xmath139 is also a semistable vertex set of @xmath159 .",
    "in particular , by  ( * ? ? ?",
    "* proposition  3.13 ) we know that @xmath160 .",
    "the closure of @xmath151 in @xmath159 equals @xmath161 .",
    "we call it the _ extended skeleton _ of @xmath159 with respect to @xmath149 and the punctures @xmath162 and we denote it by @xmath163 .",
    "whenever the minimal skeleton of @xmath159 is unique , as in example  [ ex : ellipticskeleta ] below , the extended skeleton depends solely on the set of punctures .",
    "following the previous notation , when the smooth , non - rational curve @xmath156 is defined by an ideal @xmath9 , we write @xmath164 for the complete extended skeleton .",
    "[ elliptic curves][ex : ellipticskeleta ] let @xmath16 be a smooth elliptic curve defined over @xmath136 .",
    "if @xmath156 has good reduction , then the minimal skeleton of @xmath159 is a point .",
    "if @xmath156 has bad reduction , then the minimal skeleton of @xmath156 is homeomorphic to a circle : its corresponding semistable vertex set is a point  ( * ? ? ?",
    "* @xmath165 ) .",
    "larger semistable vertex sets @xmath149 will yield larger skeleta obtained from @xmath166 by attaching finite trees to this circle along points in @xmath167 .    from the previous discussion",
    ", it is clear that skeleta of analytic curves share many properties with tropicalizations of algebraic curves .",
    "their interplay was studied in depth by baker , payne and rabinoff in  @xcite . as we next discuss ,",
    "the precise relationship is captured by the tropicalization map and thuillier s non - archimedean poincar - lelong formula  ( * ? ? ?",
    "* theorem 5.15 ) .",
    "let @xmath168 be an embedded curve , and fix a basis @xmath169 of the character lattice of the torus .",
    "let @xmath170 be the image of @xmath171 for @xmath172 .",
    "the tropicalization map @xmath173 given by @xmath174 extends naturally to a continuous map @xmath175 the image of this map is precisely the tropical curve @xmath176  ( * ? ? ?",
    "* @xmath177 ) . given any semistable vertex set @xmath149 of @xmath139 , the map   factors through the retraction @xmath178 by  ( * ? ? ? * theorem 5.15 ( 1 ) ) .",
    "in particular , the resulting map @xmath179 is a surjection",
    ". this last map will be our main focus of interest .    by the poincar - lelong formula  ( * ? ? ?",
    "* theorem 5.15 ) , the maps @xmath180 from   and   are piecewise affine , with integer slopes .",
    "furthermore , they are affine on each edge of the skeleton @xmath151 .",
    "the stretching factor on each edge is known as its _ relative multiplicity_. if an edge @xmath181 gets contracted to a single point in @xmath176 , we set @xmath182 . the map @xmath180 is _ harmonic _",
    ", i.e.  the image of every point in @xmath139 and @xmath151 under @xmath180 is _ balanced _ in the following sense : only finitely many edges in the star of a point @xmath183 in @xmath139 ( resp .",
    "@xmath151 ) are not contracted by @xmath180 , and these edges satisfy the identity @xmath184 here , @xmath185 denote the tangent directions of @xmath183 , i.e.  the nontrivial geodesic segments starting at @xmath183 , up to equivalence at @xmath183 ( as in  ( * ? ? ? * @xmath186 ) ) .",
    "the outgoing slope @xmath187 is @xmath188 if @xmath180 contracts @xmath181 and it equals @xmath189 times the primitive direction of the edge @xmath190 of @xmath176 that contains the ( possibly unbounded ) segment @xmath191 .    by refining the polyhedral structure of @xmath176 we may assume that the map from   is a morphism of 1-dimensional complexes .",
    "the balancing condition yields the following identity between tropical and relative multiplicities , as in  ( * ? ? ?",
    "* proposition  4.24 ) : @xmath192    by  ( * ? ? ?",
    "* proposition  4.24 ) , this formula can also be used to relate tropical and relative multiplicities of vertices @xmath190 on tropical curves and vertices @xmath181 of skeleta of analytic curves , when the map @xmath180 from   is a morphism of 1-dimensional complexes . as in the case of edges ,",
    "the tropical multiplicity of a vertex @xmath95 of @xmath176 counts the number of irreducible components ( with multiplicities ) in the initial degenerations of the input ideal defining @xmath9 with respect @xmath95 . rather than giving the precise definition for the relative multiplicity of a vertex @xmath193 in @xmath151 ,",
    "we present two of its crucial properties , as in  ( * ? ? ?",
    "* corollary 6.12 ) .",
    "namely , @xmath194 is a non - negative integer and @xmath195 if and only if @xmath193 belongs to an edge of @xmath151 mapping homeomorphically onto its image via @xmath180 .",
    "consider a skeleton @xmath151 of @xmath139 and a finite subgraph @xmath196 on it .",
    "we say a closed embedding @xmath197 _ faithfully represents _",
    "@xmath196 if @xmath180 maps @xmath196 homeomorphically and isometrically onto its image in @xmath198 .",
    "using embeddings of curves in proper toric varieties @xmath199 that meet the dense torus , we can extend the previous definition to complete curves .",
    "we consider those toric varieties @xmath199 for which the morphism @xmath200 is a closed immersion and use the _ extended tropicalization maps _ from  @xcite , obtained by gluing the previous constructions on each toric strata along open inclusions , with the convention that @xmath201 .",
    "we say that @xmath202 is _ faithful _ if it faithfully represents a skeleton of @xmath156 . by definition",
    ", a faithful tropicalization of @xmath16 restricts to a homeomorphism from a suitable skeleton of @xmath139 to a subgraph of the tropical curve @xmath176 .",
    "thus , constructing an embedding of the given curve that yields such a homeomorphism can be viewed as a first step towards a faithful tropicalization of curves .",
    "relative multiplicities on edges and the isometric requirements should be address in a second step .    in section  [ sec : trop - ellipt - curv ] , we focus our attention on tropical faithfulness of plane elliptic cubics with bad reduction , embedded in @xmath203 or in a surface in @xmath204 .",
    "their completions admit a closed embedding @xmath205 .",
    "the minimal skeleton @xmath206 of @xmath159 lies in @xmath139 and is homeomorphic to a circle .",
    "our goal is to find a linear re - embedding of a given curve that faithfully represents @xmath206 .",
    "we first discuss how to detect non - closed embeddings of skeleta by looking at the tropical curve .",
    "let @xmath28 be a tropicalization of the plane curve defined by @xmath207 , and @xmath193 a vertex of @xmath28 .",
    "we say that @xmath193 is _ locally reducible _ if the star of @xmath193 in @xmath28 is a reducible @xmath7-dimensional complex that is balanced at @xmath193 , i.e.  if it can be written as the union of two non - zero complexes with multiplicities that are balanced @xmath193 .",
    "in particular , if @xmath208 is the union of @xmath209 edges @xmath210 adjacent to @xmath193 with multiplicities @xmath211 , we can find @xmath212 with @xmath213 for all @xmath214 such that the resulting complex with multiplicities is balanced at @xmath193 , contains an edge of positive multiplicity and it does not agree with @xmath208 as complexes with multiplicities .    [",
    "lem : nonhomeo ] consider a non - rational smooth curve @xmath16 defined by an ideal @xmath9 and let @xmath164 be extended skeleton defined with respect to the set of punctures @xmath215 .",
    "assume that @xmath216 is not a closed embedding .",
    "then one of the following conditions hold :    1 .",
    "@xmath10 has an edge of higher multiplicity , or a locally reducible vertex @xmath193 with @xmath217 ; 2 .",
    "@xmath10 faithfully represents a unique subgraph @xmath196 of @xmath218 .    to simplify notation , write @xmath219 . after refining the structure of @xmath206 and @xmath10",
    ", we may assume without loss of generality that @xmath206 has no loop edges and that @xmath180 is a map of connected 1-dimensional abstract complexes .",
    "since @xmath180 is not a closed embedding , one of the following conditions hold :    a.   the images of several edges intersect in more than a point ; b.   there exists a vertex @xmath193 of @xmath10 where the fiber @xmath220 in @xmath206 is not connected ; c.   there exists a vertex @xmath193 of @xmath10 such that @xmath220 is connected and it is not a singleton .",
    "first , assume that ( i ) holds and let @xmath181 be a segment of an edge of @xmath10 where the images of several edges overlap .",
    "we conclude from   that @xmath181 lies in an edge of @xmath10 of higher multiplicity .",
    "we now analyze conditions ( ii ) and ( iii ) .",
    "we consider the stars of all vertices @xmath221 in the abstract cell complex @xmath206 . by   we know that the images of all stars @xmath222 under the tropicalization map are balanced at @xmath193 . in particular , @xmath223 the decomposition in the right - hand side of   contains at least one non - singleton component . in order to show that @xmath193 is a locally reducible vertex , we seek to find two vertices",
    "@xmath224 where @xmath225 and @xmath226 are both nontrivial . in this situation ,  ( *",
    "* proposition 4.24 , corollary 6.12 ) ensure that @xmath227 .    to simplify notation , fix @xmath228 .",
    "assume ( ii ) holds , and decompose @xmath220 into its connected components @xmath229 , where @xmath230 .",
    "each component is closed in @xmath206 .",
    "since @xmath206 is connected , we conclude that @xmath231 for all @xmath232 . since @xmath180 is a morphism of complexes , we can pick a vertex @xmath233 in @xmath234 for each @xmath235 . by construction , @xmath236 for all @xmath232 .",
    "we conclude that @xmath193 is locally reducible and @xmath237 .",
    "finally , assume ( iii ) holds .",
    "then the fiber @xmath220 in @xmath206 is a connected graph with at least two vertices .",
    "if @xmath193 is not locally reducible , then the decomposition   is trivial , and so there is a unique vertex @xmath238 of @xmath220 whose star in @xmath206 does not map entirely to @xmath193 under @xmath180 .",
    "we conclude that @xmath239 and @xmath240 is connected and surjects onto @xmath10 via @xmath180 .",
    "we conclude that each edge @xmath181 in @xmath241 is the image of at least one edge @xmath190 in @xmath242 .",
    "thus , we can construct a subgraph @xmath196 in @xmath243 that is homeomorphic to @xmath241 by @xmath180 .",
    "in addition , assuming condition ( i ) does not occur , we know that @xmath244 and @xmath180 induces an isometry between @xmath196 and @xmath241 .    as a consequence , if condition _",
    "( 1 ) _ in the statement fails , by iterating the previous construction over all vertices of @xmath10 , we can find a unique subgraph @xmath196 of @xmath218 that maps isometrically to @xmath10 under the map @xmath180 .",
    "this concludes our proof .    from the proof of lemma  [ lem : nonhomeo ]",
    "we can also extract the following information .",
    "assume that the images under @xmath180 of two adjacent edges @xmath181 and @xmath190 of @xmath206 with a unique common endpoint @xmath245 are two line segments that partially overlap . call @xmath238 and @xmath246 the non - common endpoints of @xmath181 and @xmath190 , and assume @xmath247 . then",
    ", the point @xmath248 will be a locally reducible vertex of @xmath10 and its star contains the straight line with direction @xmath191 . in the case of complete overlap , the vertex @xmath249 will also be locally reducible . we know that @xmath250 contains the high multiplicity edge @xmath191 , but we can not guarantee that it contains a straight line . finally , when the edges @xmath181 and @xmath190 of @xmath206 have two common endpoints and do not get contracted by @xmath180 , their image @xmath191 will be contained in an edge of @xmath10 of multiplicity @xmath251",
    ".    the following special instance of lemma  [ lem : nonhomeo ] will be useful in section  [ sec : repair - elliptic ] , were we discuss elliptic plane cubics with bad reduction .",
    "[ cor : nonhomeocycle ] let @xmath16 be an elliptic cubic curve over @xmath252 with bad reduction , embedded linearly by an ideal @xmath9 .",
    "assume @xmath10 contains a cycle but @xmath253 is not faithful on the cycle .",
    "then , the cycle contains a locally reducible vertex @xmath193 and @xmath254 .",
    "we write @xmath219 , and assume that @xmath180 is a morphism of 1-dimensional complexes . since @xmath16 has bad reduction , we know that @xmath255 contains a unique cycle @xmath196 . the tropical cycle is contained in @xmath256 , but the latter may also contain other edges of @xmath10 .    next , we analyze @xmath256 . since @xmath16 is defined by a cubic polynomial @xmath207 in the plane , all the edges in the cycle of @xmath176 have multiplicity 1 .",
    "given an edge @xmath181 of the cycle of @xmath10 , expression   ensures that exactly one edge @xmath190 of @xmath206 lies in @xmath257 and , moreover , this edge lies in @xmath196 and @xmath258 induces an isometry between @xmath181 and @xmath190 . since @xmath180 is not faithful on the cycle of @xmath10 , we know that @xmath196 contains at least one edge that either gets contracted by @xmath180 or that map to an edge of @xmath10 outside the cycle . in both cases ,",
    "we can find two distinct vertices @xmath259 of @xmath196 that map to the same vertex @xmath193 in the cycle of @xmath10 and are contained in two edges of @xmath196 that are mapped isometrically to edges in the cycle of @xmath10 . by  ( * ? ? ?",
    "* corollary 6.12 ) , @xmath260 .",
    "the decomposition ensures that @xmath193 is locally reducible , as desired .    for the reverse inequality",
    ", we analyze the combinatorics of the support of @xmath261 , i.e. of the dual cell to @xmath193 in the newton subdivision of @xmath207 . by figure",
    "[ fig : shapesandfeeding ] , this support is a trapezoid of height 1 and one of whose basis has length 1 .",
    "therefore , @xmath261 has at most two components , i.e.@xmath262 .",
    "this concludes our proof .    consider a smooth non - rational plane curve in @xmath263 defined by an irreducible polynomial @xmath264 $ ] and its linear re - embedding via the ideal @xmath265 $ ] as in section  [ sec : trop - modif - line ]",
    "this re - embedding alters the skeleton of the analytic curve in a concrete way .",
    "consider completions of these two curves , their sets of punctures @xmath266 and @xmath267 and the corresponding extended skeleta @xmath268 and @xmath269 .",
    "notice that @xmath270 .",
    "these skeleta only differ by some additional ends that we attach to @xmath268 to obtain @xmath269 ( see figure  [ fig : originalellipticmodification ] ) .",
    "the bounded part of @xmath268 can be identified with the corresponding bounded part of @xmath269 using the following commutative diagram : @xmath271 ^ -{\\tau_{{\\widehat{\\sigma}}(i_{g , f})}}\\ar[drr]_-{\\tau_{{\\widehat{\\sigma}(g ) } } }      & & { \\widehat{\\sigma}(i_{g , f})}\\smallsetminus d_{i_{g , f } } \\ar@{>>}[r]^-{\\operatorname{trop}}\\ar[d ] & \\operatorname{trop}(i_{g , f } ) \\ar@{>>}[d]^{\\pi_{xy}}\\\\      & & { \\widehat { \\sigma}(g ) } \\smallsetminus { d_g }      \\ar@{>>}[r]^{\\operatorname{trop } } & \\operatorname{trop}(g ) .",
    "} \\label{eq : contr / fold}\\ ] ] this diagram allows us to define two key notions : decontraction and unfolding of edges via linear re - embeddings .",
    "if @xmath272 contracts a fixed bounded edge but @xmath273 does not , we say that the linear re - embedding _ decontracts _ this edge .",
    "assume next that a segment in a bounded edge @xmath181 of @xmath28 is obtained by overlapping the images of several edges of @xmath274 in more than one point .",
    "refine the structure of @xmath28 and let @xmath181 be this segment . if @xmath275 is the union of images of finitely many edges from @xmath276 that pairwise intersect in at most one point , we say that the linear re - embedding _ unfolds _ the edge @xmath181 .    the union of edges that unfolds @xmath181 need not be connected .",
    "example  [ ex : twostepsexample ] and figure  [ fig : twosteppart1 ] show the decontraction of an edge .",
    "example  [ ex:64a ] and figure  [ fig:64atropical ] illustrate the unfolding phenomenon . in both cases ,",
    "we recover the curve @xmath30 from the drawn projections @xmath39 and @xmath40 using lemma  [ lem : modifviaprojections ] .",
    "the notion of @xmath1-discriminants for configurations of points in @xmath277 was introduced and further developed by gelfand , kapranov and zelevinsky in  @xcite .",
    "we present the theory in its original formulation for laurent polynomials . in our applications",
    "we only deal with polynomials with non - negative exponents defined over @xmath252 .    throughout this section , we let @xmath136 be an algebraically closed field .",
    "we fix a configuration @xmath1 of @xmath278 points in @xmath277 , and a laurent polynomial supported on @xmath1 : @xmath279.\\ ] ] we use the multiplicative notation @xmath280 if @xmath281 .    for generic choices of coefficients @xmath282 , the polynomial",
    "@xmath207 has no singularities in the algebraic torus @xmath283 .",
    "however , for special choices of coefficients , singularities do appear .",
    "such special situations ( and their algebraic closure ) are determined by the ideal @xmath284 $ ] , where @xmath285[x_1^{\\pm},\\ldots , x_k^{\\pm}].\\ ] ] it can be shown that whenever @xmath286 is a principal ideal , its unique generator is irreducible and can be defined over @xmath287 .",
    "the _ @xmath1-discriminant _",
    "@xmath288 is the unique ( up to sign ) irreducible polynomial with integer coefficients in the unknowns @xmath289 defining @xmath286 . if @xmath286 is not principal , we set @xmath290 and refer to @xmath1 as a _ defective _ configuration .    as an example",
    ", we compute the @xmath1-discriminant of the trapezoid in figure  [ fig : trapezoid ] , which plays a key role in section  [ sec : repa - trop ] .",
    "[ lm : trapezoiddiscriminant ] assume @xmath291 .",
    "then , the discriminant of the trapezoid @xmath292 in figure  [ fig : trapezoid ] equals the sylvester resultant @xmath293 of the univariate polynomials @xmath294 and @xmath295 .",
    "in particular , when @xmath296 we obtain @xmath297    the same formulas hold if we pick any configuration @xmath1 of lattice points in @xmath292 containing all four vertices of the trapezoid , after replacing the corresponding variables among @xmath298 by zero .",
    "since @xmath1-discriminants are invariant under affine transformations of the lattice @xmath299 , we may assume that the trapezoid has vertices @xmath300 and @xmath301 .",
    "furthermore , @xmath292 is not a pyramid , so we know the planar configuration @xmath1 is not defective .",
    "we fix a polynomial @xmath127 with support on the given trapezoid , and compute its two partial derivatives : @xmath302 let @xmath303 be a general point where the discriminant vanishes .",
    "then , @xmath127 admits a singular point @xmath304 in the torus @xmath203 .",
    "in particular , @xmath305 and so @xmath306 .",
    "thus , both @xmath307 and @xmath308 have a common solution @xmath309 , so @xmath310 .",
    "we conclude that @xmath293 divides @xmath311 .",
    "since both polynomials are irreducible over @xmath312 $ ] , the result follows .",
    "now , let @xmath296 and write @xmath313 .",
    "assume @xmath304 is a singular point of @xmath127 in the torus @xmath203 . from   we",
    "conclude that @xmath314 and we can use the equation @xmath315 to find the value of @xmath316 . since , in addition , @xmath317 we obtain @xmath318 as we wanted to show .",
    "conversely , if the right - hand side of   vanishes , then any point @xmath304 constructed from the vanishing of the partials   is a singularity of @xmath319 .",
    "the singularity lies in the torus if and only if @xmath320 . the latter is an open condition in the coefficients @xmath321 , and it is independent on the variable @xmath322 .",
    "since the bottom expression in   has degree 1 in @xmath322 , we can find a unique @xmath323 that solves the equation   for a generic point @xmath324 .",
    "for this choice , the unique solution @xmath304 is a singularity of @xmath127 in the torus .    for the third claim in the statement",
    ", it suffices to notice that all the arguments stated above hold if we replace any of the coefficients @xmath298 in @xmath127 by zero .",
    "this concludes our proof .",
    "[ cor : highmultanddiscrim ] fix a polynomial @xmath127 with support contained in the trapezoid @xmath292 in figure  [ fig : trapezoid ] where @xmath325 .",
    "then , @xmath127 is reducible over @xmath326 $ ] if and only if @xmath327 .",
    "the result is an easy consequence of lemma  [ lm : trapezoiddiscriminant ] .",
    "since @xmath127 has degree 1 in @xmath328 , a simple calculation shows that @xmath127 factorizes over @xmath326 $ ] if and only if @xmath307 and @xmath308 have a common solution in @xmath329 , that is , if @xmath330 .",
    "plane tropical curves are dual to coherent ( or regular ) subdivisions of lattice polygons in @xmath8 .",
    "each vertex or edge @xmath331 in the tropical curve @xmath28 is dual to a marked 2-dimensional polytope or marked edge @xmath332 in the newton subdivision of @xmath207 . by abuse of notation",
    ", we define the discriminant of @xmath331 as the discriminant of its marked dual cell , i.e. @xmath333.\\ ] ] in section  [ sec : repa - trop ] we use these polynomials to measure local faithfulness of the tropicalization map .",
    "in this section , we present our two main technical tools for repairing embedding of plane curves whose tropicalization maps are non - closed embeddings of berkovich skeleta , as in lemma  [ lem : nonhomeo ]",
    ". theorems  [ thm : redvertex ] and  [ thm : fatedge ] explain how to locally repair these bad behaviors by linear re - embeddings while preserving the structure elsewhere under some restriction on the locally reducible vertices or high multiplicity bounded edges .",
    "remark  [ rem : disclaimerthmdecontracting ] discusses possible extensions to other types of locally reducible vertices . in section  [ sec : repair - elliptic ] we combine these two theorems to give a symbolic algorithm to repair the cycle of a plane tropical elliptic cubic ( see theorem  [ thm : repairell ] and algorithm  [ alg : repairelliptic ] ) .    throughout this section , we assume our input to be a smooth non - rational curve defined by a polynomial @xmath334 $ ] , and we consider its tropicalization @xmath28 as a subvariety of the torus @xmath335 .",
    "we base change the algebraic curve to @xmath336 , and consider the set of punctures @xmath266 in a smooth completion of the new curve .",
    "we write @xmath268 for the extended skeleton of the complete analytic curve with respect to the set of punctures @xmath266 , as defined in section  [ sec : berk - skel - curv ] .",
    "notice that the base change operation does not affect the tropical curve @xmath28 by  ( * ? ? ?",
    "* proposition 3.7 ) .",
    "we make the following genericity assumption on @xmath207 :    [ genericityassumption ] we assume @xmath207 is _ generic _ in the sense that if a non - trivial linear combination of its puiseux series coefficients does not have the expected valuation because the initial term cancels , then the valuation does not reach @xmath337 , i.e.  the linear combination does not cancel completely .    for simplicity ,",
    "we choose to formulate theorems  [ thm : redvertex ] and  [ thm : fatedge ] for embedded plane curves in @xmath335 .",
    "since both theorems are local in nature , they also hold if we embed @xmath28 linearly in @xmath338 and the locally reducible vertex @xmath193 or the edge of high multiplicity , respectively , is contained in the interior of a top - dimensional cone of the tropical plane in @xmath338 . these more general versions and lemma  [",
    "lem : modifviaprojections ] will enable us to iterate this procedure if one linear tropical modification does not suffice to locally repair the input tropical curve .    by refining structures",
    ", we always assume that @xmath272 is a morphism of 1-dimensional polyhedral complexes .",
    "our first result concerns a special class of locally reducible vertices of @xmath28 .",
    "it can be further extended by unimodular transformations ( see remark  [ rem : unimodular ] ) .",
    "[ thm : redvertex ] let @xmath193 be a locally reducible vertex of @xmath28 which is dual to figure  [ fig : trapezoid ] .",
    "we assume that @xmath207 satisfies the genericity assumption [ genericityassumption ] .",
    "then , @xmath339 vanishes at @xmath340 if and only if there exist two points @xmath259 of @xmath341 satisfying the following conditions :    a.   the stars of @xmath238 and @xmath246 in @xmath274 are not contracted by @xmath180 , b.   there exists a subgraph @xmath196 of @xmath274 containing the points @xmath238 and @xmath246 that is partially contracted and/or folded by @xmath180 .",
    "moreover , in this situation , there is a linear re - embedding @xmath342 of the curve corresponding to the tropical modification along the vertical line @xmath343 through @xmath193 that decontracts / unfolds edges of @xmath344 mapping to @xmath345 under @xmath180 .",
    "theorem  [ thm : redvertex ] should be interpreted as follows .",
    "assume @xmath28 contains a locally reducible four - valent vertex @xmath193 whose star contains a line and two other non - parallel rays of multiplicity one .",
    "then the local faithfulness of @xmath28 at @xmath193 is measured by the discriminant of @xmath193 .",
    "if this discriminant vanishes , we can use a linear tropical modification of the ambient space to find a subgraph of @xmath268 that is homeomorphic to the star of @xmath193 in @xmath28 via the tropicalization map .",
    "that can be repaired with a linear tropical modification . the labels @xmath346 correspond to the coefficients of @xmath340 .",
    "with the exception of the four vertices , the remaining coefficients are allowed to be 0 .",
    "the two bases of the trapezoid define two univariate polynomials @xmath347 and @xmath348 of degrees @xmath349 and @xmath209 , respectively .",
    "the arrows indicate the feeding process in the @xmath107 variable induced by the linear re - embedding @xmath350 with @xmath35 . ]",
    "[ rem : unimodular ] a _ unimodular transformation _ of @xmath299 is a linear @xmath287-invertible map @xmath351 associated to a monomial change of coordinates @xmath352 in @xmath353 $ ] . using the maps @xmath1 and @xmath352",
    "we can make other locally reducible vertices dual to figure  [ fig : trapezoid ] , and apply theorem  [ thm : redvertex ] to repair the corresponding tropical curve locally around @xmath193 .",
    "we compose the linear re - embedding and its lifting function @xmath29 and use the ideal @xmath354 $ ] to give new coordinates to our curve .",
    "we can view @xmath28 inside the two charts @xmath355 of @xmath356 by means of the inverse of the linear map @xmath357 . for an illustration , see example  [ ex : non - ellipticdecontraction ] .",
    "notice that , with few exceptions , these re - embeddings are non - linear and the same outcome can not be achieved by using only linear tropical modification .",
    "namely , only when the line through @xmath193 has slopes @xmath188 or @xmath7 , the corresponding monomial changes of coordinates are linear themselves , and so @xmath358 gives a linear re - embedding .",
    "furthermore , in these two cases , we can easily adapt the techniques of theorem  [ thm : redvertex ] to modify along these lines directly without the need of precomposing with these monomial map ( see figure  [ fig : shapesandfeeding ] ) .",
    "we use this strategy in theorem  [ thm : repairell ] to repair bad embeddings of plane elliptic cubics .",
    "our second result concerns the unfolding of edges of high multiplicity . as opposed to theorem  [ thm : redvertex ] , the non - vanishing of the discriminant of the edge @xmath181 at @xmath359 detects non - faithfulness .",
    "[ thm : fatedge ] let @xmath181 be a vertical bounded edge of @xmath28 of multiplicity @xmath360 whose endpoints have valency 3 .",
    "if the discriminant of @xmath181 does not vanish at @xmath359 , then the tropicalization map is not faithful at @xmath181 and we can unfold this edge with a linear re - embedding @xmath342 of the curve determined by a tropical modification . the new curve @xmath30 contains a cycle that maps to @xmath181 via @xmath39 .",
    "it is worth pointing out that the previous statement gives no information regarding the reverse implication .",
    "we refer to remark  [ rem : fatedgeconverse ] for more details .",
    "[ rem : disclaimerthmdecontracting ] at first glance , the statement of theorem  [ thm : redvertex ] seems a bit restricted and it would be desirable to treat more general reducible vertices that those dual to figure  [ fig : trapezoid ] ( possibly , after a unimodular transformation ) .",
    "we choose to avoid the general case for three concrete reasons .",
    "first , working with the general case will force the use of multivariate resultants rather than discriminants , even for those vertices traversed by a straight line .",
    "secondly , figure  [ fig : trapezoid ] is the only one where the reducibility of a polynomial supported on it is equivalent to the vanishing of the discriminant .",
    "third , for reducible vertices of arbitrary shape whose components have valency strictly greater than @xmath6 , linear modifications are no longer helpful to repair bad embeddings . in section  [ sec : experiments ] we present an example of a reducible vertex @xmath193 with two valency-3 components that can be repaired by a linear modification ( see example  [ ex : otherredvertex ] ) .",
    "the presence of these components forces us to modify @xmath8 along a tropical line with vertex @xmath193 .",
    "consequently , we have to use more charts to characterize the linear re - embedding .",
    "these projections are harder to describe in terms of a coordinate change .",
    "likewise , the valency - three condition imposed in the statement of theorem  [ thm : fatedge ] allows us to stay in the world of discriminants for all our computations .",
    "examples  [ ex : cyleappears ] and  [ ex : unfoldimpossible ] in section  [ sec : experiments ] give two instances where we drop the valency - three condition and our methods have different outcomes .",
    "the remainder of this section is devoted to the proofs of theorems  [ thm : redvertex ] and  [ thm : fatedge ] .",
    "a series of lemmas facilitate the exposition .",
    "we make the following simplifications .",
    "let @xmath193 be a locally reducible vertex dual to the trapezoid @xmath292 from figure  [ fig : trapezoid ] traversed by a vertical line @xmath361 .",
    "our tropical linear modification has the form @xmath42 and its lifting equals @xmath362 $ ] where @xmath363 .",
    "furthermore , after rescaling the variables @xmath183 and @xmath328 by appropriate powers of @xmath364 and rescaling the resulting polynomial @xmath365 by a suitable power of @xmath364 , we may assume that in the newton subdivision of @xmath207 , the trapezoid @xmath292 has height 0 and all other monomials have negative height .",
    "here , the _ height _ of a monomial @xmath366 appearing in @xmath207 equals @xmath367 , the negative valuation of the corresponding coefficient . as a result",
    ", we can take @xmath368 .    with a similar technique",
    ", we can assume the newton subdivision of the polynomial @xmath207 in theorem  [ thm : fatedge ] has height @xmath188 at the dual edge @xmath369 , while all other monomials in @xmath207 have negative height . in this case ,",
    "we unfold the edge @xmath181 by means of the linear tropical modification along @xmath370 and a suitable lifting @xmath371 $ ] with @xmath363 .    in the following lemmas",
    ", we keep the previous assumptions .",
    "we use the notation @xmath46 for the attached cell in the linear tropical modification @xmath370 , discussed at the end of section  [ sec : trop - modif - line ] .",
    "the heart of these technical results lies in lemma  [ lem : modifviaprojections ] .",
    "we study the expected valuations of the coefficients @xmath372 of @xmath373 for appropriate values of @xmath374 and choose @xmath36 s that make their valuations higher than expected .",
    "this ensures that @xmath375 does not consist only of downward ends attached to @xmath376 .",
    "[ lm : expectedheights ] let @xmath109 and @xmath377 be the left vertices of the trapezoid @xmath292 from figure  [ fig : trapezoid ] , and let @xmath307 and @xmath308 be the univariate polynomials of degree @xmath349 and @xmath209 induced by the two bases of the trapezoid .",
    "assume that the newton subdivision of @xmath207 achieves its maximum height ( zero ) at @xmath292 .",
    "then , for any given @xmath35 with @xmath363 , the coefficients of all monomials @xmath378 and @xmath379 in @xmath380 have expected valuations @xmath381 and @xmath382 , respectively .",
    "the valuation of the coefficients of the monomials @xmath383 and @xmath384 equals the expected one .",
    "moreover , the valuations of @xmath385 and @xmath386 are higher than expected if and only if @xmath387 is a common solution of @xmath307 and @xmath308 , and the discriminant of @xmath292 vanishes at the point @xmath388 . for such choice , @xmath389 has the expected valuation if and",
    "only if @xmath390 .    following the notation of figure  [ fig : trapezoid ] , we let @xmath391 be the constant terms of the coefficients @xmath392 from @xmath207 , with @xmath393 .",
    "the binomial expansion of each factor @xmath394 yields : @xmath395 since @xmath396 and all terms in @xmath207 have height at most 0 , we conclude that all the coefficients @xmath397 with @xmath398 , and @xmath399 with @xmath400 have expected valuation 0",
    ". moreover , @xmath401 by construction .",
    "in particular , we can compute the constant terms of @xmath385 , @xmath386 and @xmath389 : @xmath402 thus , @xmath385 and @xmath386 have strictly positive valuation if and only if @xmath403 is a nonzero common solution of @xmath307 and @xmath308 . by lemma  [ lm : trapezoiddiscriminant ] , such @xmath403 exists if and only if @xmath327 .",
    "furthermore by   we deduce that @xmath404 , so @xmath405 if and only if @xmath390 .    [ rem : unimodulartransformationsforellipticcase ] the statement of lemma  [ lm : expectedheights ] also holds for any locally reducible vertex @xmath193 with a line through it of slope @xmath188 or @xmath7 , and whose dual cell is a trapezoid @xmath292 of height one , as we now explain . as usual ,",
    "assume that the trapezoid @xmath292 has maximal height 0 .",
    "by symmetry between @xmath183 and @xmath328 we need only consider the case of slope one , namely , when the parallel lines containing the bases of @xmath292 are @xmath406 and @xmath407 .",
    "let @xmath408 be the initial terms of the coefficients of the monomials in @xmath343 , and @xmath409 be the ones contained in @xmath410 .",
    "we let @xmath307 and @xmath308 be the polynomials supported on the two bases of @xmath292 .",
    "the @xmath1-discriminant of the trapezoid is the same as the one for figure  [ fig : trapezoid ] since these two polygons are related by a unimodular transformation of @xmath299 .",
    "we write @xmath411 .",
    "the linear re - embedding induced by the tropical modification along @xmath412 is determined by the function @xmath413 with @xmath363 .",
    "the plane curve @xmath414 is obtain by projecting @xmath342 to the @xmath415-plane . in the feeding process",
    ", a monomial @xmath416 in @xmath207 contributes to all monomials @xmath417 in @xmath53 for @xmath418 . in particular ,",
    "if a point @xmath419 lies to the left of the vertices with coefficients @xmath420 , then the coefficient @xmath421 has expected valuation 0 .",
    "we are interested in increasing the valuation of the coefficients of @xmath53 associated to the intersection points @xmath422 and @xmath423 of the @xmath328-axis with the lines @xmath343 and @xmath410 , respectively .    by lemma  [ lm : trapezoiddiscriminant ] , the vanishing of @xmath311 ensures that @xmath307 and @xmath308 have a common solution @xmath403 in @xmath424 .",
    "the feeding process ensures that @xmath425 and @xmath426 have negative valuation if and only if @xmath427 .",
    "[ lm : vanishingdecontractsvertex ] let @xmath193 be a locally reducible vertex of @xmath28 dual to the trapezoid @xmath292 in figure  [ fig : trapezoid ] , contained in the line @xmath428 .",
    "suppose that the discriminant of @xmath292 vanishes at @xmath340 and let @xmath403 be a common solution of @xmath429 and @xmath430 in @xmath424 .",
    "let @xmath431 be a lifting function with @xmath363 and @xmath427 .",
    "then , the linear re - embedding @xmath342 produces a decontraction / unfolding of some edges of @xmath274 that map to @xmath432 .",
    "furthermore , @xmath433 is a vertex of @xmath30 and its multiplicity is strictly smaller than @xmath434 .",
    "the claim follows from lemma  [ lm : expectedheights ] . as usual , assume that the trapezoid @xmath292 has height zero , and all coefficients of @xmath207 have non - negative valuation , so @xmath368 and @xmath435 .",
    "set @xmath436 .",
    "the given hypotheses ensure that the coefficients of @xmath437 and @xmath438 in @xmath53 have strictly positive valuation and all other coefficients have non - negative valuation .    by our genericity condition  [ genericityassumption ] , the coefficients @xmath385 and @xmath386 of @xmath53 are non - zero and have positive valuation .",
    "let @xmath439 and @xmath440 be minimal with the property that @xmath441 and @xmath442 have valuation zero .",
    "we let @xmath443 be the edge in the newton subdivision of @xmath53 determined by @xmath444 and @xmath445 .",
    "notice that @xmath446 has multiplicity 1 , and so it is faithfully represented in @xmath274 by a unique edge @xmath447 that maps to @xmath443 under @xmath180 .",
    "different values of @xmath374 and @xmath448 yield different polyhedral structures on @xmath449 and thus in @xmath450 by lemma  [ lem : modifviaprojections ] . in turn",
    ", they produce the decontraction or unfolding of edges , as we now explain .    by symmetry ,",
    "we assume @xmath451 .",
    "we claim that the point @xmath452 lies in @xmath41 : it is a vertex when @xmath453 or @xmath454 , and otherwise lies in the relative interior of the edge @xmath446 in @xmath41 ( see figures  [ fig:64atropical ] and  [ fig : twosteppart1 ] ) . in both cases ,",
    "a segment of @xmath446 connects @xmath452 to a vertex @xmath455 in @xmath456 as in figure  [ fig : folding ] .",
    "the vertex @xmath455 can be described as follows .",
    "our genericity condition  [ genericityassumption ] ensures that there is a polygon @xmath457 in the newton subdivision of @xmath53 containing @xmath443 and a vertex @xmath458 where @xmath459 , i.e.  @xmath460 lies below the line with direction @xmath443 passing through @xmath444 .",
    "the polygon @xmath457 is dual to a vertex @xmath455 of @xmath449 .",
    "the combinatorics of the stars of @xmath452 in @xmath28 and @xmath41 and lemma  [ lem : modifviaprojections ] ensure that @xmath461 is a vertex of @xmath462 .",
    "let @xmath99 be the multiplicative closed set generated by @xmath463 .",
    "our choice of @xmath403 guarantees that the localized initial ideal @xmath464\\subset { \\mathbb{c}}[x^{\\pm } , y^{\\pm } ] [ s^{-1}]$ ] has length strictly smaller than the length of the ideal @xmath465 $ ] .",
    "proposition  [ pr : projectionsj ] implies that the multiplicity of @xmath461 in @xmath462 is bounded above by @xmath466 .    when @xmath467 , the edge @xmath446 has direction @xmath19 and it connects the vertex @xmath455 of @xmath450 to the point @xmath461 .",
    "the map @xmath468 contracts this bounded edge and all downward ends in @xmath469 . bounded edges with other directions project homeomorphically to segments inside @xmath470 . by lemma  [ lem : modifviaprojections ] and",
    "we conclude that the linear re - embedding @xmath471 decontracts the edge @xmath446 in @xmath472 , so it decontracts the edge @xmath447 in @xmath473 .",
    "example  [ ex : twostepsexample ] and figure  [ fig : twosteppart1 ] exhibit this behavior .    on the contrary ,",
    "assume @xmath474 .",
    "this situation leads to an unfolding of edges , as sketched in figure  [ fig : folding ] .",
    "assume the vertex @xmath460 constructed above has @xmath475 .",
    "then , the 2-cell @xmath457 in the newton subdivision of @xmath53 contains a vertex @xmath476 with @xmath477 and adjacent to @xmath445 by an edge @xmath478 .",
    "notice that we allow the possibility that @xmath479 and @xmath460 agree .",
    "the edges @xmath480 and @xmath446 share the endpoint @xmath455 . when viewed in @xmath481 using lemma  [ lem : modifviaprojections ] , the same holds true for a segment of these two edges .",
    "the projection @xmath39 overlaps these two edges along an edge of @xmath28 contained in the line @xmath482 .",
    "diagram   implies that the linear re - embedding @xmath471 unfolds some edges of @xmath483 .",
    "finally , suppose @xmath484 .",
    "by convexity , we construct a ( possibly empty ) maximal collection of vertices @xmath485 with @xmath486 and @xmath487 for all @xmath488 such that    1 .   @xmath489 and @xmath490 are connected by an edge @xmath491 , 2 .   for all @xmath492",
    ", @xmath493 are vertices of a polygon @xmath494 in the newton subdivision of @xmath53 .    by the genericity assumption  [ genericityassumption ]",
    "we can find a vertex @xmath495 with @xmath496 in the newton subdivision of @xmath497 , connected to @xmath445 by an edge @xmath498 and such that @xmath498 and @xmath499 are edges of a polygon @xmath500 in the subdivision .",
    "we let @xmath501 be the corresponding vertex in @xmath456 .",
    "the edges @xmath502 of @xmath41 have directions @xmath503 for @xmath504 .",
    "they form a chain that links the vertices @xmath501 and @xmath455 , as in figure  [ fig : folding ] . using lemma  [ lem : modifviaprojections ] and the convexity of the newton subdivision of @xmath53 ,",
    "we conclude that the projection @xmath39 maps these edges ( and their linking chain ) to overlapping edges in @xmath505 . using diagram  ,",
    "we conclude that the linear re - embedding @xmath471 unfolds some edges of @xmath506 .",
    "example  [ ex:64a ] and figure  [ fig:64atropical ] capture this phenomenon .     and the projection @xmath39 folding edges of @xmath375 .",
    "the dashed segments describe a potential scheme of edges in the subdivision .",
    "the red dotted lines indicate the image of the projection . ]",
    "[ lem : nodecontractioniflocallysmooth ] let @xmath193 be a locally reducible vertex @xmath193 in @xmath28 and assume that the discriminant @xmath339 does not vanish at @xmath340 .",
    "then , there exists a unique vertex @xmath238 in @xmath507 and a subgraph @xmath196 of @xmath222 that maps homeomorphically to @xmath208 . for any other vertex @xmath508 in @xmath206",
    ", we have @xmath509 .",
    "if the discriminant @xmath339 does not vanish at @xmath340 , then by corollary  [ cor : highmultanddiscrim ] , we know that @xmath340 is irreducible and generically reduced , thus @xmath510 . by  ( * ? ? ?",
    "* corollary 6.12 ) and formula , all but one vertex in @xmath220 map their stars to @xmath193 .",
    "we let @xmath238 be this special vertex .",
    "the proof of lemma  [ lem : nonhomeo ] shows that we can construct @xmath196 in @xmath222 satisfying the desired property .",
    "[ rem : localfaithfulnessaroundv ] notice that by construction , the multiplicity of two of the edges adjacent to a locally reducible vertex @xmath193 dual to figure  [ fig : trapezoid ] is one , and so the tropicalization is faithful on these edges by  ( * ? ? ?",
    "* theorem 6.23 ) .",
    "the only exceptions are the edges dual to the two bases of the trapezoid in figure  [ fig : trapezoid ] , whose multiplicities are @xmath209 and @xmath349 .",
    "we can not guarantee faithfulness of the tropicalization map over these edges unless @xmath511 .",
    "furthermore , corollary  [ cor : highmultanddiscrim ] ensures that @xmath217 if and only if @xmath512 vanishes at @xmath340 .",
    "when @xmath339 does not vanish at @xmath340 , the multiplicity one edges in @xmath208 are faithfully represented as a subgraph @xmath196 of @xmath222 , where @xmath238 is the vertex of lemma  [ lem : nodecontractioniflocallysmooth ] .",
    "this graph is a star tree . if @xmath513 , then @xmath180 maps each of the edges in @xmath514 outside @xmath196 either to @xmath193 or homeomorphically to the corresponding high multiplicity edge in @xmath28 . the proof of lemma  [",
    "lem : nonhomeo ] show that the previous statements remain true if we replace @xmath206 by the connected 1-dimensional complex @xmath515 .    to simplify notation , write @xmath516 for the embedding induced by an ideal @xmath9 .",
    "assume the discriminant @xmath339 does not vanish at @xmath340 .",
    "the result follows by lemma  [ lem : nodecontractioniflocallysmooth ] .",
    "conversely , suppose that the discriminant @xmath339 vanishes at @xmath340 .",
    "then , by lemma  [ lm : vanishingdecontractsvertex ] we can decontract / unfold edges of @xmath517 that map to @xmath432 using a linear re - embedding induced by a tropical modification along @xmath343 .",
    "we analyze the different combinatorial structures that appear in the proof of the lemma to construct @xmath238 and @xmath246 .",
    "we keep the notation used in the latter .",
    "suppose the linear re - embedding produces a decontraction of an edge @xmath181 adjacent to @xmath193 in @xmath30 , i.e.  @xmath467 .",
    "since the trapezoid @xmath518 has height 1 , we conclude that @xmath181 has a unique preimage @xmath190 in @xmath519 .",
    "call @xmath238 and @xmath246 its ends and let @xmath520 . by construction ,",
    "@xmath521 and their stars in @xmath519 contain @xmath190 .",
    "their stars are not contracted in @xmath30 and each one contains at least three edges , since @xmath248 and @xmath522 are two distinct non - bivalent vertices . by balancing , one edge from each star in @xmath30 maps to a segment in the line @xmath343 under the projection @xmath39 . by diagram",
    ", we conclude that the stars of @xmath238 and @xmath246 are not contracted by @xmath180 , while the path between them is .    on the contrary",
    "assume @xmath523 .",
    "then , lemma  [ lm : vanishingdecontractsvertex ] produces a chain of edges @xmath524 in @xmath525 containing @xmath193 as one of its vertices .",
    "we see @xmath524 in the right of figure  [ fig : folding ] .",
    "notice that @xmath193 lies on an edge @xmath181 of @xmath525 , and @xmath181 has multiplicity 1 . by construction @xmath519 contains a unique edge @xmath190 mapping to @xmath181 under @xmath180 . in particular , it contains a unique point @xmath246 mapping to @xmath193 under @xmath180 .",
    "the chain @xmath524 maps to @xmath343 under @xmath39 . by convexity",
    ", this chain contains a point @xmath526 of @xmath527 that maps to @xmath193 under @xmath39 .",
    "furthermore , we can choose @xmath526 to be a vertex of @xmath30 or a point in the interior of an edge whose direction is not @xmath19 . in both cases",
    ", @xmath39 does not contract the star of @xmath526 in @xmath30 .",
    "we define @xmath528 , so @xmath529 .",
    "this graph contains the preimage of @xmath526 .",
    "since @xmath530 , implies the existence of a point @xmath246 in @xmath196 mapping to @xmath526 but whose star is not contracted by @xmath180 .    by further refining the structure of @xmath519 , we may assume @xmath238 and @xmath246 are vertices of @xmath519 , and hence of @xmath196 .",
    "diagram   guarantees that the stars of @xmath238 and @xmath246 in @xmath196 are not contracted in @xmath28 .",
    "moreover , @xmath180 folds and/or contracts some edges of @xmath196 : its image lies on @xmath343 .    for simplicity , we suppose that the dual cell to the vertical edge @xmath181 in the newton subdivision of @xmath207 is the horizontal edge with endpoints @xmath109 and @xmath531 . without loss of generality , we further assume all coefficients of @xmath207 have non - negative valuation and @xmath532 , so @xmath181 lies in the line @xmath533 .",
    "we write @xmath534 and @xmath535 with @xmath536 for the trivalent endpoints of @xmath181 .",
    "figure  [ fig : twotriangles ] depicts the dual cells to @xmath537 and @xmath526 .     in @xmath28 and its 3-valent endpoints",
    "@xmath193 and @xmath526 in the newton subdivision of @xmath373 for a suitable @xmath36 with @xmath363 the arrows on the right indicate the direction of the feeding process from @xmath207 to @xmath53 .",
    "the left picture shows the 2-cells dual to three vertices @xmath95 , @xmath193 and @xmath526 forming part of a cycle in @xmath41.,title=\"fig : \" ]   in @xmath28 and its 3-valent endpoints @xmath193 and",
    "@xmath526 in the newton subdivision of @xmath373 for a suitable @xmath36 with @xmath363 the arrows on the right indicate the direction of the feeding process from @xmath207 to @xmath53 .",
    "the left picture shows the 2-cells dual to three vertices @xmath95 , @xmath193 and @xmath526 forming part of a cycle in @xmath41.,title=\"fig : \" ]    we let @xmath409 be the initial terms of the coefficients of @xmath538 in @xmath207 , and @xmath539 be the initial terms of the coefficients of @xmath540 and @xmath541 in @xmath207 , respectively . in particular , we know that @xmath542 . we define @xmath543.\\ ] ] as in the proof of lemma  [ lm : expectedheights ] , we work with a tropical modification of @xmath8 along @xmath544 , and we let @xmath373 , where @xmath363 .",
    "write @xmath545 .",
    "expression  ( [ eq : expvalfeeding ] ) shows that all coefficients @xmath546 with @xmath547 have expected valuation 0 .",
    "a similar direct calculation proves that the constant term of @xmath385 equals @xmath548 , and the constant term of @xmath549 equals @xmath550 since @xmath551 is the discriminant of the univariate polynomial @xmath127 of degree @xmath552 , we know that @xmath553 and @xmath554 have no common solution in @xmath424 .",
    "thus , we can pick @xmath403 to be any of the @xmath349 simple roots of @xmath555 in @xmath424 .",
    "this choice ensures that the valuation of @xmath385 is strictly positive while @xmath556 .",
    "therefore , the edge with endpoints @xmath557 and @xmath531 lies in the newton subdivision of @xmath53 and at height 0 . by construction , we have @xmath558 and @xmath559 . combining these facts with the previous arguments",
    "ensures that @xmath193 and @xmath526 are vertices of @xmath41 .",
    "the feeding process described above can also be applied to determine the valuations of the coefficients @xmath560 and @xmath561 .",
    "we argue for the point @xmath562 . by construction ,",
    "the highest point of the newton subdivision of @xmath207 along the horizontal line @xmath563 is @xmath564 . as we illustrate with the red dashed lines in figure  [ fig : twotriangles ] , our choice of @xmath36 above and a direct calculation",
    "ensure that the height of the point @xmath562 in the newton subdivision of @xmath53 equals @xmath565 , as expected .",
    "similarly , the points @xmath566 have expected height induced by the height function of the dual cell @xmath518 .",
    "their actual heights can be lower .",
    "this ensures that the points @xmath567 , and @xmath562 are part of the vertex set of a polygon in the newton subdivision of @xmath53 dual to @xmath193 .",
    "this polygon contains at most one extra vertex @xmath568 , with @xmath569 .    by symmetry between the endpoints @xmath193 and @xmath526 , we can also find @xmath570 with the property that the polygon with vertices @xmath571 lies in the newton subdivision of @xmath53 and is dual to @xmath572 .",
    "in addition , our choice of @xmath573 ensures that the triangle with vertices @xmath574 is a polygon in the newton subdivision of @xmath53 .",
    "it is dual to a vertex @xmath95 in @xmath41 .",
    "y the points @xmath575 and @xmath526 induce a cycle in @xmath41 , as we see in the left of figure  [ fig : twotriangles ] .",
    "we now use lemma  [ lem : modifviaprojections ] to deduce that the linear re - embedding @xmath462 unfolds edges mapping to @xmath181 by the projection @xmath39 , as in figure  [ fig : unfoldingdoubleedge ] . by construction , we know that @xmath534 and @xmath535 are vertices of @xmath462 and lie in the line @xmath505 .",
    "furthermore , we can find @xmath576 so that both open segments @xmath577 and @xmath578 inside @xmath505 do not meet @xmath462 . if this were not the case , the intersection points would be part of the projection @xmath579 .",
    "we claim that the open segment @xmath580 lies in @xmath581 and has multiplicity @xmath582 . from the projection @xmath583 , we know that this segment contains no vertex of @xmath462 .",
    "we certify our claim by computing the star of @xmath193 in @xmath462 on each open cell @xmath47 , @xmath66 from figure  [ fig : twotriangles ] , and using the balancing condition . on the cells @xmath584 ,",
    "the star contains only two edges ( with multiplicity ) , with directions @xmath585 ( in @xmath586 ) and @xmath587 ( in @xmath588 ) .",
    "similarly , the cell @xmath589 contains two edges of the star : their directions are @xmath590 and @xmath591 and .",
    "the last one is nothing but the lifting of the edge @xmath592 from @xmath41 .",
    "the union of these four edges with multiplicities is not balanced at @xmath193 .",
    "an edge with direction @xmath593 and multiplicity @xmath594 solves this issue .    by diagram   and",
    "lemma  [ lem : modifviaprojections ] we see that @xmath595 maps the bounded edges @xmath592 and @xmath596 in @xmath597 to the edge @xmath181 in @xmath28 with relative multiplicity 1 .",
    "the map keeps their images disjoint away from the vertex @xmath95 .",
    "hence , the linear re - embedding @xmath471 unfolds the corresponding edges , as desired .",
    "[ rem : fatedgeconverse ] notice that the arguments in the proof of theorem  [ thm : fatedge ] can not be reversed .",
    "indeed , pick any point @xmath598 in the relative interior of @xmath181 . then @xmath599 is supported on an edge of length @xmath552 , so it is a zero - dimensional scheme of length @xmath349 . if @xmath551 vanishes at @xmath600 , then this scheme is non - reduced , and provides no information to determine the value of the relative multiplicities .",
    "[ rem : unfoldingandtrivalentoutcome ] from the proof of theorem  [ thm : fatedge ] we see that the unfolding procedure improves the situation : the multiplicity of the vertical edge @xmath181 has decreased by 1 in @xmath462 . in particular , if @xmath601 , our method produces a cycle in @xmath462 with vertices @xmath602 and @xmath245 and multiplicity 1 on all its edges .",
    "example  [ ex : unfoldingdoubleedge ] illustrates this phenomenon .",
    "when @xmath603 we would like to iterate this process and unfolds further the edge @xmath181 in @xmath462 when @xmath604 .",
    "for this , we require @xmath193 and @xmath526 to remain trivalent vertices in @xmath462",
    ". this will indeed be the case when @xmath605 , @xmath606 and @xmath607 ( see figure  [ fig : twotriangles ] ) .",
    "this trivalent condition on @xmath193 and @xmath526 need to be essential in concrete examples : the method will carry through whenever the special linear re - embedding induced by the iterated tropical modification returns a newton subdivision as in the left of figure  [ fig : twotriangles ] .    [",
    "ex : unfoldingdoubleedge ] we consider a plane elliptic cubic curve @xmath16 whose tropicalization contains a vertical double edge @xmath181 with trivalent endpoints in place of a cycle .",
    "it is given by the equation @xmath608 the tropical curve is depicted on the right of figure  [ fig : unfoldingdoubleedge ] .",
    "the dual edge to @xmath181 in the newton subdivision of @xmath207 has lattice length 2 and contains the lattice points @xmath609 , @xmath610 and @xmath611 .",
    "its discriminant equals @xmath612 , so @xmath613 .",
    "we use theorem  [ thm : fatedge ] and the vertical line @xmath533 to unfold the double edge @xmath181 and produce a cycle in the re - embedded tropical curve .",
    "notice that @xmath614 .",
    "we pick a special lifting @xmath615 with @xmath363 and @xmath616 , satisfying @xmath617 .",
    "the function @xmath618 produces the desired unfolding as we see on the left side of figure  [ fig : unfoldingdoubleedge ] .",
    "remark  [ rem : unfolddoubleedgeelliptic ] will show that this re - embedding induces an isometry between the cycle in @xmath30 and the circle corresponding to the minimal skeleton of the complete curve @xmath159 .    .",
    "]    . ]",
    "[ ex:64a ] we consider the cubic curve with defining equation @xmath619 its tropicalization is depicted in the right of figure  [ fig:64atropical ] .",
    "the 4-valent vertex @xmath452 lies in the cycle in @xmath28 and it is locally reducible .",
    "it is dual to a height 1 trapezoid and @xmath620 vanishes at @xmath621 .    using theorem  [ thm : redvertex ] we unfold edges mapping to the straight line through this reducible vertex .",
    "we view the re - embedded curve @xmath30 using the projections @xmath39 and @xmath40 in figure  [ fig:64atropical ] , the leftmost being the tropicalization of the plane curve @xmath622 .",
    "-valent reducible vertex traversed by a vertical line .",
    "the corresponding image under @xmath40 has equation @xmath623 .",
    "the endmost pictures correspond to the newton subdivisions of @xmath53 and @xmath207 , respectively .",
    "the integer numbers adjacent to each lattice point indicate the negative valuation of the corresponding coefficients .",
    "the linear re - embedding lowers the red points . ]",
    "[ ex : non - ellipticdecontraction ] we consider a smooth degree @xmath624 plane curve of genus @xmath6 with defining equation : @xmath625 the induced newton subdivision is depicted in the right of figure  [ fig : mumford ] ( the missing height values can be taken to be @xmath626 ) .",
    "the point @xmath452 is the unique locally reducible vertex of the tropical curve @xmath28 in the right of figure  [ fig : mumfordtrop ] .",
    "its star is the union of two skew lines : @xmath627 and @xmath628 .",
    "the local discriminant @xmath620 vanishes at @xmath621 . by remark  [ rem : unimodular ] , the line @xmath627 gives us two ways to locally repair the tropical curve around @xmath452 by a linear re - embedding .",
    "we obtain two distinct yet isometric tropical curves in @xmath20 that map to @xmath28 under the projection @xmath39 .",
    "first , we aim to apply the technique described in theorem  [ thm : redvertex ] . in order to do so",
    ", we must perform a unimodular transformation on the tropical curve to fall into our standard trapezoid from figure  [ fig : trapezoid ] . via a monomial change of coordinates @xmath352 and a translation",
    ", we make the vertex @xmath452 dual to a unit square as in the right of figure  [ fig : mumford ] . the skew line @xmath627 maps to the vertical line @xmath629 in the @xmath630-plane .",
    "the corresponding linear tropical modification induces a linear re - embedding by @xmath631 . in order to see the effect of this change in",
    "the original coordinates @xmath183 and @xmath328 , we apply the inverse monomial map @xmath632 as in the left of figure  [ fig : mumford ] .",
    "this procedure yields the desired re - embedding by the ideal @xmath633 .",
    "this result can not solely be obtained with linear tropical modifications .     to decontract an edge of a degree 4 plane tropical curve of genus 3 with a @xmath624-valent reducible vertex traversed by a skew line .",
    "the corresponding image under @xmath634 has equation @xmath635 . ]     to decontract an edge of a degree 4 plane tropical curve of genus 3 with a @xmath624-valent reducible vertex traversed by a skew line .",
    "the corresponding image under @xmath634 has equation @xmath635 . ]",
    "the projection of @xmath636 under @xmath40 is the curve @xmath41 in the left of figure  [ fig : mumfordtrop ] , where @xmath635 .",
    "we can recover @xmath636 by gluing @xmath41 and @xmath28 together with the following rules : points on @xmath46 and @xmath637 are of the form @xmath638 and @xmath639 , respectively , and all points in @xmath51 satisfy @xmath640 .",
    "the projection @xmath39 contracts the edge from @xmath19 to @xmath461 in the re - embedded tropical curve .",
    "notice that the tropical curve @xmath636 has three cycles containing only trivalent vertices and multiplicity one edges . by  (",
    "* theorem 6.23 ) , the tropicalization map is faithful on these three cycles . since the original curve is smooth and non - rational , we know that its completion admits a unique minimal skeleton with three cycles ( see section  [ sec : berk - skel - curv ] ) .",
    "this skeleton is the complete graph @xmath641 on 4 nodes and we can see an isometric copy of it in the re - embedded tropical curve @xmath356 via the map @xmath180",
    ".     contained in a skew line by conjugating a linear tropical modification of @xmath8 ( middle map ) by monomial change of coordinates .",
    "the corresponding dual plane tropical curve to the endmost newton subdivisions are depicted in figure  [ fig : mumfordtrop ] . ]",
    "our second possibility for locally repairing @xmath28 around the vertex @xmath452 is by employing a single a linear tropical modification along the skew line @xmath642 and using the special lifting @xmath643 .",
    "figure  [ fig : nomonomial ] shows the image of @xmath644 under @xmath40 and the impact of this linear change of coordinates on the newton subdivisions of @xmath645 and @xmath646 . by construction , the projection @xmath39 sends a point @xmath647 in @xmath648 to @xmath649 , so it contracts the edge with endpoints @xmath19 and @xmath461 , as well as the three ends with directions @xmath19 .     and its effect on the newton subdivisions of @xmath207 and @xmath53 .",
    "the left most picture is the tropical curve @xmath650 and it should be compared with the leftmost tropical curve in figure  [ fig : mumford ] . ]     and its effect on the newton subdivisions of @xmath207 and @xmath53 .",
    "the left most picture is the tropical curve @xmath650 and it should be compared with the leftmost tropical curve in figure  [ fig : mumford ] . ]",
    "throughout this section , we fix an equation @xmath334 $ ] defining a plane elliptic cubic , and we fix the valuation of its coefficients .",
    "this data determines a unique tropical elliptic cubic @xmath28 .",
    "this tropical curve contains a cycle only when the interior point @xmath610 is visible in the newton subdivision of @xmath207 .",
    "it is this case that interests us the most .",
    "our starting point is the well - known formula to compute the @xmath0-invariant from @xmath207 : @xmath651    we view @xmath652 as a degree zero rational function in the coefficients of @xmath207 , defined over @xmath653 .",
    "the denominator @xmath654 is the discriminant of the cubic polynomial @xmath207 .",
    "the @xmath0-invariant has expected valuation @xmath655 called the _ generic valuation _ of the @xmath0-invariant .    in this situation , (",
    "* theorem 11 ) ensures that @xmath656 gives the cycle length of the tropical curve @xmath28 .",
    "furthermore , ( * ? ? ?",
    "* lemma 23 ) shows that in this case , failure to have the expected valuation of @xmath652 is caused exclusively by an increment in the valuation of @xmath654 .",
    "this means two things : first , the length of the cycle in @xmath28 is bounded above by @xmath657 and second , the initial form in the @xmath364-expansion of @xmath654 vanishes at @xmath207 . in the remainder of this section",
    ", we use these two facts to repair the cycle of tropical plane elliptic cubic using linear re - embeddings .",
    "the goal of this section is to proof the following theorem .",
    "its proof will yield a symbolic algorithm for repairing the cycle of a tropical plane elliptic cubic in dimension 4 ( see algorithm  [ alg : repairelliptic ] ) .",
    "[ thm : repairell ] consider a plane elliptic cubic in @xmath335 defined by @xmath658 $ ] .",
    "assume @xmath659 and that @xmath28 contains a cycle whose length does not reflect the @xmath0-invariant .",
    "then , we can recursively repair it with linear tropical modifications of the ambient space .",
    "the resulting ambient space has dimension at most 4 .",
    "as mentioned in the introduction , our main tool to prove this result will be a mild adaptation of theorem  [ thm : redvertex ] .",
    "a series of lemmas simplifies the exposition .",
    "the heart of these technical statements will allow us to bound the ambient dimension of the linear re - embedding after suitable projections .",
    "our goal is to recursively unfold and decontract edges of the tropical curve until we obtain the correct cycle length by a linear re - embedding .",
    "since we aim at a recursive procedure , we abstain from applying a monomial coordinate change to @xmath207 as in remark  [ rem : unimodular ] to put any locally reducible vertex into our standard trapezoid dual cell from figure  [ fig : trapezoid ] .",
    "instead , we use modification along horizontal , vertical or slope 1 `` skew '' lines , thus ensuring that each step of the linear re - embedding gives us back a plane cubic equation @xmath53 .",
    "we let @xmath29 be an algebraic lift of the tropical polynomial defining the vertical , horizontal or skew line we use to modify the plane .",
    "notice that all trapezoids in figure  [ fig : trapezoid ] have a basis of length one , hence the @xmath364-initial coefficient of @xmath36 in the lifting @xmath29 producing unfold or decontraction of edges ( as in lemma  [ lm : vanishingdecontractsvertex ] ) will be unique . when considering the linearly re - embedded ideal @xmath342 and the projections to different charts , we obtain coordinate changes of the form @xmath660 for vertical lines , @xmath661 for horizontal lines and @xmath662 for skew lines , as indicated in figure  [ fig : shapesandfeeding ] .    for the remaining of this section",
    ", we let @xmath663 be the common denominator of all puiseux series coefficients of @xmath207 .",
    "then the coefficients of @xmath207 are laurent series in @xmath664 , and the coordinates of vertices and edge lengths in @xmath28 are in @xmath665 .",
    "the proof of theorem  [ thm : redvertex ] shows that we can always pick @xmath666 , thus the same holds true for @xmath41 and @xmath667 .",
    "each step of our recursion will increase the cycle length by a positive number in @xmath665 .     for @xmath668 .",
    "the remaining cases can be obtained by reflections along each modifying lines determined by each row , i.e. @xmath669 , @xmath670 and @xmath671 , respectively . the coordinate change needed to describe the linear re - embedding via projections as in lemma  [ lem : modifviaprojections ] and the feeding process in the newton subdivision of @xmath53",
    "are indicated on the right - hand side of the picture . ]    in order to iteratively apply theorem  [ thm : redvertex ] , we need to make sure that the requirements are satisfied at each step .",
    "we claim that the cycle contains a locally reducible vertex with vanishing local discriminant . indeed , since the cycle is shorter than expected ,  ( * ?",
    "* theorem 11 ) ensures that the newton subdivision of @xmath207 can not be a triangulation .",
    "figure  [ fig : shapesandfeeding ] shows all possible non - simplicial 2-cells in the newton subdivision of @xmath207 , up to reflection .",
    "all theses cells are equivalent to the trapezoid in figure  [ fig : trapezoid ] by a unimodular transformation , and @xmath296 .",
    "the corresponding dual vertices in @xmath28 are locally reducible .",
    "corollaries  [ cor : nonhomeocycle ] and  [ cor : highmultanddiscrim ] guarantee that the discriminant of one of these locally reducible vertices vanishes . by remark  [ rem : unimodulartransformationsforellipticcase ]",
    "the feeding process for any of these locally reducible vertices is verbatim to the one we considered in detail in theorem  [ thm : redvertex ] .",
    "furthermore , in the notation of lemma  [ lm : vanishingdecontractsvertex ] , we conclude that @xmath672 for all such vertices .    the second hypothesis deals with the genericity convention  [ genericityassumption ] .",
    "in section  [ sec : repa - trop ] we formulated a strong condition to simplify the notation and arguments in the proof of theorem  [ thm : redvertex ] .",
    "however , when restricted to the case of elliptic cubics with a visible cycle in their tropicalizations , the arguments still carry along even when some cancellations occur among the coefficients of @xmath53 .",
    "[ lm : toomanycancellations ] assume too many cancellations occur to prevent a decontraction or unfolding in the cycle of @xmath28 .",
    "then the tropical curve @xmath30 breaks the visible cycle of @xmath28 and we conclude that @xmath207 defines a rational curve .",
    "[ ex : unfoldcycle ] consider the plane cubic with defining equation : @xmath673 its newton subdivision is depicted on the right of figure  [ fig : unfoldcycle ] .",
    "we let @xmath292 be the trapezoid with vertices @xmath674 and @xmath675 . we modify @xmath8 along a vertical line passing through the locally reducible vertex dual to @xmath292 . by lemma  [ lm : expectedheights ] , the coefficients @xmath676 and @xmath677 in @xmath380 will have strictly positive ( unexpected ) valuation only when the initial term of @xmath36 is @xmath678 .",
    "a simple calculation reveals @xmath679 in particular , we obtain @xmath680 .",
    "the projection @xmath681 is shown in the left of figure  [ fig : unfoldcycle ] . using lemma  [ lem : modifviaprojections ]",
    "we conclude that @xmath682 consists of three points : @xmath683 and @xmath461 .",
    "furthermore , @xmath684 is the union of three ends , and thus @xmath685 contains no cycle .",
    "the linear re - embedded curve is then rational and this procedure unfolds the cycle in @xmath28 .",
    "we describe which cancellations can prevent a decontraction or unfolding of the cycle from @xmath28 .",
    "since the feeding process is symmetric for the three families of straight lines along which we modify , it is sufficient to prove our claim for a locally reducible vertex @xmath193 dual to the trapezoid @xmath292 from figure  [ fig : trapezoid ] and for tropical modifications along vertical lines .",
    "we stick to the notation used in the proof of lemma  [ lm : vanishingdecontractsvertex ] . henceforth , the interior point @xmath610 is a vertex of the newton subdivision of @xmath53 and it corresponds to the one of the two points @xmath557 or @xmath686 in the previous notation .",
    "let us first assume it equals @xmath686 . in this case , @xmath292 has top vertices @xmath687 and @xmath610 . in the proof of lemma  [ lm :",
    "vanishingdecontractsvertex ] , we argued that the newton subdivision of @xmath53 contains either the edge with vertices @xmath610 and @xmath609 ( responsible for a decontraction of a bounded edge ) , or that the subdivision contains an edge connecting @xmath610 to @xmath688 for @xmath689 ( responsible for an unfolding ) .",
    "notice that if certain monomials from @xmath53 vanish , the previous two cells need not be in the subdivision .",
    "a case - by - case analysis when @xmath207 is a cubic shows that no unfolding or decontraction of edges occurs if and only if none the three monomials @xmath7 , @xmath107 and @xmath328 are present in @xmath53 .",
    "but in this case , @xmath690 would not be connected , and we would unfold the cycle of @xmath28 in the linear re - embedding @xmath30 . by diagram  , this contradicts our hypothesis that @xmath207 is an elliptic cubic with bad reduction .    similarly , if @xmath691 we know that @xmath292 has top vertices @xmath610 and @xmath692 .",
    "the only situation in which a violation of the genericity assumption prevents an unfolding or decontraction of bounded edges is when all monomials @xmath693 in @xmath53 with @xmath694 cancel completely .",
    "this would again lead to an unfolding of the cycle , so @xmath207 can not be an elliptic cubic .",
    "the following definition allows us to simplify our repairing techniques :    [ def : visibleside ] assume the tropical plane elliptic cubic @xmath28 contains a cycle and a locally reducible vertex @xmath193 with vanishing discriminant , and let @xmath343 be a straight line in @xmath208 . if @xmath343 is vertical ( resp .",
    ", horizontal ) with equation @xmath428 ( resp . , @xmath695 ) , we say that the cycle of @xmath28 is _ on the visible side _ of @xmath343 if it lies on the halfspace @xmath696 ( resp . , @xmath697 ) .",
    "by convexity , we know that the cycle lies entirely on one of the halfspaces induced by @xmath343 .",
    "the definition is motivated by lemma  [ lem : modifviaprojections ] : under the given conditions , the cycle of @xmath30 is visible in @xmath41 , and its length is strictly larger than the length of the cycle of @xmath28 .",
    "the equation @xmath53 gives a planar linear re - embedding of the elliptic cubic that improves the embedding induced by @xmath207 .",
    "[ rem : skewsarespecial ] notice that if @xmath343 is the skew line @xmath698 , we can always exchange @xmath699 and @xmath2 so that the cycle of @xmath28 lies in @xmath700 . in that case , the cycle of @xmath30 is visible in @xmath701 and we improve the embedding of the curve by replacing @xmath207 with @xmath702 . in this sense , skew lines are special : the cycle of @xmath28 is always on the visible side of @xmath343 .",
    "our next result shows that the combinatorics of the cycle in @xmath28 can be simplified by means of affine changes of coordinates constructed from tropical modifications of @xmath8 along straight lines .",
    "[ lem : atmosttwo ] consider a plane elliptic cubic in @xmath335 with bad reduction defined by @xmath703 $ ] .",
    "assume that @xmath28 contains a cycle .",
    "then , there exists an affine change of coordinates @xmath704\\to    { { \\mathbb{c}}(\\!(t^{1/n})\\!)}[x_1,x_2]$ ] such that @xmath705 contains a cycle and the following conditions hold :    a.   the length of the cycle of @xmath705 is bounded below by the length of the cycle of @xmath28 ; b.   if @xmath193 is a locally reducible vertex on the cycle of @xmath705 with vanishing discriminant , then no skew lines traverses @xmath193 and no horizontal or vertical line through @xmath193 contains the cycle of @xmath705 on its visible side .",
    "the affine map @xmath1 is constructed by means of tropical modifications of @xmath8 along straight lines .",
    "we proceed by induction on @xmath706 , where @xmath707 denotes the length of the cycle in @xmath28 . if @xmath708 , the cycle in @xmath28 contains no locally reducible vertex with vanishing discriminant by corollary  [ cor : highmultanddiscrim ] .",
    "we take @xmath709}$ ] .",
    "assume @xmath710 and that the result is true for all @xmath711 with @xmath712 .",
    "since @xmath710 we know that @xmath28 does not reflect the @xmath0-invariant of @xmath207 , and so the cycle of @xmath207 contains a locally reducible vertex . if @xmath207 satisfies _",
    "( ii ) _ , we take @xmath713}$ ] . if condition _",
    "( ii ) _ fails , there are two reasons for this .",
    "we analyze each case separately .",
    "first , assume the cycle of @xmath28 contains a locally reducible vertex @xmath193 traversed by a skew line @xmath714 .",
    "by symmetry we may assume that the cycle of @xmath28 lies in @xmath715 .",
    "let @xmath716 be as in lemma  [ lm : vanishingdecontractsvertex ] and remark  [ rem : unimodulartransformationsforellipticcase ] with @xmath363 , and write @xmath717 .",
    "remark  [ rem : skewsarespecial ] ensures that the cycle of @xmath30 is visible in @xmath41 . by construction , @xmath718 and @xmath719 thus @xmath720 and @xmath721 . by the inductive hypothesis",
    ", we can find an affine transformation @xmath722\\to { { \\mathbb{c}}\\{\\!\\{t\\}\\!\\}}[z , y]$ ] satisfying conditions _ ( i ) _ and _ ( ii ) _ for @xmath53 . the map @xmath723 verifies the desired requirements .",
    "finally , suppose no skew line traverses any locally reducible vertex in @xmath28 with vanishing discriminant , but the cycle of @xmath28 is on the visible side of a horizontal or vertical line @xmath343 through one of these vertices . by symmetry",
    ", we can assume @xmath724 .",
    "let @xmath725 be as in lemma  [ lm : vanishingdecontractsvertex ] with @xmath726 and @xmath363 .",
    "write @xmath727 . as in the previous case",
    ", our choice ensures that @xmath718 and @xmath720 with @xmath712 .",
    "we use the inductive hypothesis to construct an affine map @xmath728 for @xmath53 . the map @xmath729 satisfies both conditions in the statement .",
    "[ rem - v0v1v2 ] assume the cubic polynomial @xmath207 satisfies the conditions of lemma  [ lem : atmosttwo ] .",
    "a simple calculation shows that the cycle in @xmath28 admits only seven possible shapes for locally reducible vertices and their dual cells in the newton subdivision of @xmath207 .",
    "they are depicted in figure  [ fig : shapesandfeeding ] .",
    "we conclude that at most two of these vertices will have vanishing discriminants .",
    "we call them @xmath455 and @xmath730 .",
    "furthermore , we assume that @xmath455 is traversed by the horizontal line @xmath731 , and @xmath730 ( if it exists ) is traversed by the vertical line @xmath732 with @xmath733 .",
    "the cycle of @xmath28 is not on the visible side of @xmath734 nor @xmath735 .     and @xmath455 . here ,",
    "@xmath736 and we disallow the combination @xmath737 . ]    let @xmath738 be the vertex in the cycle of @xmath28 adjacent to @xmath455 and lying on @xmath734 .",
    "figure  [ fig : figuresalgorithm ] shows the combinatorics of the distinguished dual cells @xmath739 and @xmath740 in the newton subdivision of @xmath207 and the corresponding heights , where @xmath741 . notice that condition _",
    "( ii ) _ from lemma  [ lem : atmosttwo ] ensures that @xmath736 and for both @xmath742 and @xmath740 .",
    "we disallow the combination @xmath737 .",
    "furthermore , the cycle of @xmath28 lies on the halfspace @xmath743 .",
    "our proof strategy for theorem  [ thm : repairell ] will consist on repairing the vertices @xmath455 and @xmath730 separately .",
    "the following result allows us to repair the cycle of the curve locally around @xmath455 by a linear re - embedding in dimension 3 .",
    "we will use a variant of this result when dealing with @xmath730 .",
    "[ lm : repairv_1indim3 ] let @xmath744 $ ] define a plane elliptic cubic with bad reduction , satisfying the conditions of lemma  [ lem : atmosttwo ] for @xmath745}$ ] .",
    "assume @xmath746 contains a locally reducible vertex @xmath455 with vanishing discriminant , traversed by the line @xmath747 .",
    "then , there exists an affine map @xmath748\\to { { \\mathbb{c}}(\\!(t^{1/n})\\!)}[x , y]$ ] with @xmath749 , @xmath750 and @xmath751 , and a polynomial @xmath752 $ ] with @xmath753 and @xmath754 satisfying the following conditions :    1 .",
    "@xmath755 $ ] is a linear re - embedding of @xmath756 constructed from a linear tropical modification of @xmath8 adapted to @xmath756 as in lemma  [ lm : vanishingdecontractsvertex ] ; 2 .   the weighted sets @xmath757 and @xmath758 agree ; 3 .",
    "@xmath759 contains no locally reducible vertex with vanishing discriminant in @xmath46 .",
    "furthermore , assume @xmath207 contains a second locally reducible vertex @xmath730 with vanishing discriminant , traversed by the @xmath732 with @xmath733 .",
    "then , the cycle of @xmath760 lies on the halfspace @xmath761 and it meets the hyperplane @xmath762 only along the edge joining @xmath738 and @xmath730 in @xmath637 .",
    "we pick a suitable function @xmath763 where @xmath764 as in lemma  [ lm : vanishingdecontractsvertex ] .",
    "we set @xmath765 .",
    "the induced linear re - embedding @xmath766 decontract / unfolds edges of @xmath274 mapping to @xmath734 in @xmath28 . in particular , @xmath767 . by lemma  [ lem : modifviaprojections ]",
    ", we know that the cycle of @xmath766 lies in the cells @xmath768 . the point @xmath738 is a vertex of @xmath41 and its dual cell has four possible shapes , namely all polygons in the center of figure  [ fig : figuresalgorithm ] except for the triangle with vertices @xmath769 and @xmath692 .",
    "notice that @xmath455 is also a vertex of @xmath41 .",
    "it can be trivalent or locally reducible , with or without vanishing discriminant .",
    "lemma  [ lm : vanishingdecontractsvertex ] ensures that when viewed in @xmath770 , the multiplicity of @xmath771 is 1 , even though its multiplicity on @xmath41 can be 2 .",
    "similarly , the vertex @xmath772 in @xmath773 has multiplicity 1 .    by construction",
    ", the curve @xmath41 contains at most one locally reducible vertex @xmath774 with vanishing discriminant in the cell @xmath589 .",
    "furthermore , such vertex is traversed by a horizontal or vertical line @xmath775 , with equations @xmath776 or @xmath777 , and @xmath778 satisfy @xmath779 and @xmath780 . in both cases , the cycle of @xmath30 lies on the hyperplane @xmath781 .",
    "we construct both elements @xmath782 and @xmath783 in a recursive fashion , by performing tropical modifications of @xmath784 along @xmath133 horizontal and @xmath209 vertical lines of the form @xmath785 or @xmath786 for suitable @xmath787 in @xmath665 and @xmath788 .",
    "we proceed by induction on @xmath789 .",
    "notice that @xmath790 .",
    "if @xmath708 , ( * ? ? ?",
    "* theorem 11 ) ensures that the vertex @xmath791 does not exist .",
    "our statement is satisfied by the choice @xmath792}$ ] and @xmath793 .",
    "next , we assume the statement holds for all @xmath794 in @xmath665 and that the problematic vertex @xmath774 does indeed exist .",
    "we use @xmath775 and lemma  [ lm : vanishingdecontractsvertex ] to repair the embedding around @xmath774 , by working with the plane with coordinates @xmath795 . in principle",
    ", this produces a linear re - embedding @xmath796 $ ] of the curve @xmath53 , and in turn , a new linear re - embedding @xmath797 $ ] of the input curve @xmath207 .",
    "we claim that we can simplify the situation by a linear projection , and produce a linear re - embedding of @xmath207 in dimension @xmath6 that preserves the cycle of @xmath798 .",
    "the projection depends on the nature of @xmath775 .    if @xmath799 , our lifting function has the form @xmath800 with @xmath801 .",
    "we collect @xmath802 and @xmath803 , and define @xmath804 the function @xmath805 belongs to the ideal @xmath806 .",
    "the given two generators of @xmath86 form a tropical basis .",
    "the tropical plane @xmath88 contains @xmath807 edges and 5 two - dimensional cells @xmath808 and @xmath809 .",
    "each @xmath810 is obtained by intersecting the 2-cell @xmath48 corresponding to @xmath811 and the 2-cell @xmath812 of @xmath813 ( each viewed in @xmath814 ) .",
    "for example , @xmath815 .    by proposition",
    "[ pr : projectionsj ] , we recover @xmath816 from the three projections @xmath28 , @xmath817 and @xmath818 .",
    "notice that @xmath41 lies in the visible side of @xmath819 , so the cycle of @xmath820 is visible on @xmath821 .",
    "thus , the cycle of @xmath798 lies on the union @xmath822 .",
    "these cells are parametrized by the pairs @xmath823 , @xmath823 and @xmath50 , respectively .",
    "the linear re - embedding @xmath824 $ ] contains a cycle isometric to the cycle in @xmath825 .",
    "it is induced by the lifting @xmath805 , i.e. by the linear tropical modification of @xmath8 ( with coordinates @xmath50 ) along @xmath533 .",
    "we take @xmath826}$ ] .",
    "on the other hand , assume @xmath827 .",
    "we proceed in a similar fashion to the previous case .",
    "we work with the curve @xmath41 , a linear tropical modification of @xmath784 along @xmath775 and a lifting @xmath828 with @xmath829 as in lemma  [ lm : vanishingdecontractsvertex ] that prolongs the cycle of @xmath41 in @xmath820 . as before ,",
    "the plane @xmath806 is generated by a tropical basis , and the cycle of @xmath798 lies in the union of the cells @xmath830 , @xmath831 and @xmath809 .",
    "furthermore , it lies on the hyperplanes @xmath761 and @xmath832 .",
    "we define @xmath833 $ ] .",
    "the lifting @xmath803 defines an affine map @xmath834\\to { { \\mathbb{c}}(\\!(t^{1/n})\\!)}[x , y]$ ] with @xmath835 and @xmath836 .    in both cases ,",
    "the points @xmath837 are vertices on the cycle of @xmath838 .",
    "furthermore , our hypotheses ensure that the cycles of @xmath839 and @xmath28 agree , and @xmath840 $ ] is obtained by a tropical modification of @xmath8 along @xmath533 adapted to the curve @xmath841 as in lemma  [ lm : vanishingdecontractsvertex ] . in particular , @xmath842 .",
    "in addition to the potential vertex @xmath730 , the cycle of @xmath843 contains at most one other locally reducible vertex @xmath844 with vanishing discriminant .",
    "this vertex lies in @xmath589 and it is traversed by a straight line of the form @xmath845 or @xmath846 where @xmath847 satisfy @xmath848 and @xmath849 , whenever applicable .    if no such vertex @xmath844 exists , the functions @xmath850 and @xmath851 satisfy the requirements of the statement .",
    "in the presence of the problematic vertex @xmath844 , we define @xmath852 . by the inductive hypothesis",
    ", there exists @xmath853 , an affine map @xmath854\\to { { \\mathbb{c}}(\\!(t^{1/n})\\!)}[x , y]$ ] with @xmath855 and @xmath856 with @xmath751 , and a polynomial @xmath783 of the form @xmath857 satisfying the conditions of the statement for the curve @xmath841 .",
    "the function @xmath858 and the polynomial @xmath783 verify the result .",
    "finally , assume @xmath28 contains the problematic vertex @xmath730 .",
    "write @xmath859 $ ] .",
    "an easy convexity argument shows that the dual cell to @xmath738 in the newton subdivision of @xmath860 is the parallelogram or the trapezoid in the center of figure  [ fig : figuresalgorithm ] .",
    "it follows that @xmath861 .",
    "the last claim in the statement follows from lemma  [ lem : modifviaprojections ] and condition _ ( 2)_. this concludes our proof .",
    "[ proof of theorem  [ thm : repairell ] ] fix @xmath663 such that @xmath744 $ ] . since the cycle of @xmath28 does not reflect the @xmath0-invariant of @xmath207 , by theorem  [ thm : redvertex ] we know that the cycle of @xmath28 contains a locally reducible vertex with vanishing discriminant . after applying an affine change of coordinates in @xmath862 as in lemma  [ lem : atmosttwo ]",
    ", we may assume that @xmath207 satisfies the conditions of the lemma for @xmath863}$ ] .",
    "furthermore , by remark  [ rem - v0v1v2 ] , we know that @xmath28 contains a vertex @xmath455 with vanishing discriminant traversed by the vertical line @xmath482 and a potential vertex @xmath730 with vanishing discriminant traversed by the horizontal line @xmath864 , where @xmath733 .    following earlier notation , we let @xmath865 be the length of the cycle of @xmath10 induced by a linear re - embedding @xmath866 $ ] of the input plane elliptic cubic @xmath207 .",
    "the ideal @xmath9 will be constructed by iterative applications of theorem  [ thm : redvertex ] and lemma  [ lm : vanishingdecontractsvertex ] .",
    "using lemma  [ lm : repairv_1indim3 ] , we repair the cycle locally around @xmath455 via the linear re - embedding @xmath867 $ ] in dimension 3 .",
    "lemma  [ lem : modifviaprojections ] ensures that the points @xmath772 and @xmath868 are vertices of @xmath869 and their multiplicity is 1 .    first , suppose that the potential problematic vertex @xmath730 does not exist .",
    "proposition  [ pr : projectionsj ] then ensures that all remaining vertices in the cycle of @xmath870 have multiplicity 1 .",
    "indeed , the vertices of the cycle in in the relative interior of each chart @xmath48 ( @xmath66 ) are either irreducible or locally reducible and with non - vanishing discriminant .",
    "all edges in the cycle have multiplicity 1 .",
    "the map @xmath180 is faithful on the cycle of @xmath871 .",
    "thus , the cycle has the expected length and witnesses the prolongation of the cycle in @xmath28 .",
    "finally , assume the vertex @xmath730 does exist .",
    "write @xmath872 $ ] .",
    "the vertex @xmath730 is contained in the cycle of @xmath28 , thus also in @xmath873 and in @xmath874 .",
    "figure  [ fig : figuresalgorithm ] ensures that the cycle of @xmath28 lies on @xmath875 . in order to repair the embedding locally around @xmath730 we must work with two charts of @xmath871 : the one containing the cycle in @xmath876 and the one including the cycle in @xmath877 .",
    "we claim that we can disregard the latter .",
    "indeed , by lemma  [ lm : repairv_1indim3 ] , the vertex @xmath738 in @xmath878 is not traversed by the line @xmath864 .",
    "suppose we perform a tropical modification of @xmath879 along this line .",
    "any choice of lifting function @xmath880 with @xmath881 has the same effect on the curve @xmath882 : it induces a tropical modification of the curve .",
    "the cycle remains unchanged in @xmath883 , we see in the right most picture in figure  [ fig : dualexamplealgorithm ] . in conclusion",
    ", we can disregard the charts with coordinates @xmath795 when repairing the curve @xmath884 locally around @xmath730 .    using the notation of figure  [ fig : figuresalgorithm ] , we write @xmath885 , and @xmath886 .",
    "we work with the line @xmath732 , the vertex @xmath730 and the input curve @xmath887 . by lemma  [ lm : repairv_1indim3 ]",
    "we can find @xmath888 and a map @xmath889\\to { { \\mathbb{c}}(\\!(t^{1/n})\\!)}[x , y]$ ] with @xmath890 and @xmath891 , where @xmath892 , @xmath881 and @xmath893 such that the ideal @xmath894 satisfies the conditions of lemma  [ lm : repairv_1indim3 ] .    if @xmath895}$ ] , we conclude that the ideal @xmath896 $ ] induces a faithful linear re - embedding of the input curve in dimension 4 and its tropicalization has the expected cycle length . on the contrary ,",
    "assume @xmath897}$ ] .",
    "the proof of lemma  [ lm : repairv_1indim3 ] shows that @xmath898 is constructed from a vertical modification along a line @xmath899 with @xmath900 .",
    "we write @xmath901 and consider the ideal @xmath902 $ ] . the variables @xmath903 and @xmath904 are related by the linear forms @xmath905 and @xmath906 .",
    "they are liftings of linear tropical modifications along two parallel hyperplanes : @xmath482 and @xmath907 .",
    "we think of them as two vertical modifications that can be merged together .",
    "more precisely , the cycle of @xmath10 is contained in the cells @xmath908 , which can be parametrized without using the coordinate @xmath2 .",
    "therefore , we can project the ideal to the variables @xmath909 and obtain a new linear re - embedding of the curve in dimension 4 by the ideal @xmath910 $ ] .",
    "example  [ ex : dim4example ] shows an instance of such projection and the resulting linear re - embedding of @xmath207 .",
    "the corresponding tropical curve in @xmath814 contains a cycle which is isometric to the cycle of @xmath911 , and all its vertices and edges have multiplicity 1 by proposition  [ pr : projectionsj ] .",
    "therefore , it prolongs the cycle in @xmath28 and it has the expected cycle length .",
    "this concludes our proof .",
    "@xmath912 $ ] ; @xmath913 $ ] ; @xmath914 @xmath915 on @xmath916 $ ] ; @xmath917 length of the cycle in @xmath10 @xmath918 $ ] ; @xmath919 $ ] .",
    "+ @xmath9 .",
    "the following two examples illustrate the two key steps involved in the proof of theorem  [ thm : repairell ] :    [ ex : twostepsexample ] consider the plane elliptic cubic with defining equation : @xmath920 its @xmath0-invariant has valuation -8 .",
    "the tropical curve is depicted on the right of figure  [ fig : twosteppart1 ] .",
    "it contains a cycle of length 6 that needs to be prolonged .",
    "we do so in two steps .",
    "the bottom picture shows the newton subdivision of the input curve and the output linear re - embedding on each iteration .    in the first step ,",
    "we modify the plane @xmath8 along the vertical line @xmath533 , corresponding to the tropical function @xmath370 .",
    "the vertex @xmath452 has valency four and lies on this vertical line .",
    "its discriminant equals @xmath921 and it vanishes at @xmath621 . by choosing the special lifting @xmath922 and the curve @xmath923 ,",
    "we prolong our cycle by decontracting a bounded edge in @xmath469 , as we see in the center of figure  [ fig : twosteppart1 ] .",
    "viewed in the projection @xmath924 , the new cycle has length seven , so it is still too short .                for our second iteration , we start with the tropical curve @xmath925 in the @xmath415-plane and the locally reducible vertex @xmath926 , whose discriminant vanishes on @xmath927 .",
    "the @xmath928-plane is given as the union of the cells @xmath929 .",
    "we modify it along the vertical line @xmath79 corresponding to the tropical polynomial @xmath930 , depicted on the center of figure  [ fig : twosteppart1 ] .",
    "we choose the lifting @xmath931 , a new variable @xmath209 and tropicalize the ideal @xmath932 .",
    "write @xmath933 $ ] . when projected to the @xmath934-plane we observe the curve @xmath935 , living in the union of the cells @xmath936 and @xmath937 in the modified plane , as in the left of figure  [ fig : twosteppart1 ] .",
    "the re - embedded and projected curve @xmath925 from our first iteration lies in the cells @xmath938 and @xmath937 , as in the center of figure  [ fig : twosteppart1 ] .",
    "we combine the two modifications in one step and make the corresponding affine coordinate change to give the desired special linear re - embedding of @xmath16 in dimension 2 , namely @xmath939 .",
    "the cycle in the new tropical curve has length 8 , as desired .",
    "the next example illustrates the behavior of algorithm  [ alg : repairelliptic ] in the presence of two locally reducible vertices with vanishing discriminants on the top left and bottom right of the cycle of @xmath28 , and when more than two linear tropical modifications are required to achieve the desired cycle length .",
    "[ ex : dim4example ] consider the plane elliptic cubic with bad reduction defined by the equation @xmath940 its @xmath0-invariant has valuation -15 .",
    "the corresponding tropical curve has a cycle of lattice length @xmath941 and is depicted at the curve of figure  [ fig : algorithmexample ] .",
    "it contains two locally reducible vertices with vanishing discriminant , namely @xmath452 and @xmath942 . as in the proof of theorem  [ thm : repairell ] , we repair the embeddings by treating these two vertices independently .",
    "we will need three linear tropical modifications , namely along the lines @xmath533 , @xmath943 and @xmath944 .",
    "their 2-dimensional charts are depicted in figure  [ fig : algorithmexample ] .",
    "we choose the special liftings induced by the functions @xmath945 , @xmath946 and @xmath947 .",
    "figure  [ fig : dualexamplealgorithm ] shows the newton subdivision of five planar projections .",
    "notice that @xmath610 is not a vertex of the leftmost subdivision .",
    "even though the vertex @xmath948 in the projection of the curve to the @xmath949-coordinates is locally reducible , its local discriminant does not vanish , so its multiplicity in @xmath950 equals 1 . by proposition  [ pr : projectionsj ] ,",
    "its multiplicity in @xmath951 is also 1 .",
    "we reconstruct the tropical curve @xmath951 by looking at the tropical plane curves @xmath28 , @xmath817 and @xmath952 and using lemma  [ lem : modifviaprojections ] .",
    "the cycle of this curve in @xmath953 is on the visible side of the hyperplane @xmath944 .",
    "thus , we can project the curve and the ambient plane to the space corresponding to the variables @xmath954 , and still repair the embedding of the original plane elliptic curve . the resulting ideal is @xmath955 .",
    "its tropicalization in @xmath814 is shown in figure  [ fig : makedualgraphalgorithm ] .",
    "its cycle reflects the @xmath0-invariant of the input curve .",
    "repair the middle tropical elliptic cubic .",
    "we draw the relevant four projections in @xmath951 , indicating the corresponding images of all the vertices of @xmath956)$ ] . ]    . ]     using algorithm  [ alg : repairelliptic ] .",
    "the coordinates are labeled @xmath957 and the color coding agrees with figure  [ fig : algorithmexample ] . ]",
    "[ rem : unfolddoubleedgeelliptic ] assume @xmath16 is a plane elliptic cubic @xmath16 with bad reduction defined by @xmath207 .",
    "suppose that its tropicalization @xmath28 contains no cycle but one of its bounded edges @xmath181 has tropical multiplicity @xmath958 and non - vanishing discriminant .",
    "then the combinatorics of the newton polygon of @xmath207 ensure that @xmath959 .",
    "theorem  [ thm : fatedge ] guarantees that we can unfold this double edge and produce a cycle by a special linear re - embedding .    for simplicity , assume that the double edge @xmath181 of @xmath28 is vertical .",
    "then the push - forward formula for multiplicities  ( * ? ? ?",
    "* theorem 8.4 ) applied to the projection @xmath40 ensures that the cycle in the re - embedded curve contains only multiplicity one edges , and so does its projection @xmath41 .",
    "if , in addition , the cycle in @xmath41 is trivalent , we conclude by  ( * ? ? ?",
    "* theorems 6.23 and 6.24 ) that this cycle is isometric to the minimal skeleton of the complete analytic elliptic curve @xmath159 under the tropicalization map  .",
    "example  [ ex : unfoldingdoubleedge ] illustrates this phenomenon .",
    "we end this section with an easy characterization of tropical faithfulness on cycles of tropical plane elliptic cubics whose @xmath0-invariant has negative valuation . as expected",
    ", this result also follows from  ( * ? ? ?",
    "* section 6 ) , but our approach makes it easier to verify in concrete examples .",
    "let @xmath16 be a plane elliptic cubic with defining equation @xmath207 whose @xmath0-invariant has negative valuation .",
    "then its tropicalization faithfully represents the minimal skeleton of the complete curve @xmath159 if and only if it contains a cycle and when restricted to this cycle the following hold :    a.   all edges have multiplicity one , b.   all vertices are either locally irreducible or they are locally reducible and with non - vanishing discriminant .",
    "furthermore , the cycle in @xmath28 has length @xmath657 .",
    "since the newton polygon of @xmath207 equals 3 times the unit two - simplex , and @xmath28 contains a cycle , we know that the only locally reducible vertices in its cycle are dual to those in figure  [ fig : shapesandfeeding ] ( up to reflections ) . by corollary  [ cor : highmultanddiscrim ] ,",
    "any such locally reducible vertex with @xmath960 must have a vanishing discriminant .",
    "the result follows from theorem  [ thm : repairell ] and lemma  [ lem : nonhomeo ] .      in this section ,",
    "we show how we can repair bad embeddings of plane elliptic cubics in an elementary way , without relying on their berkovich skeleta .",
    "our goal is to reprove theorem  [ thm : repairell ] by combinatorial means , and in particular to show how we can use linear re - embeddings to ensure that the length of the cycle of the re - embedded tropical curve equals the negative valuation of the @xmath0-invariant ( see  @xcite ) .",
    "our main tool will be the theory of @xmath1-discriminants , introduced in section  [ sec : discriminants ] .",
    "the results presented here hold for arbitrary planar configurations and might be of independent interest .    as a motivation , we start with a configuration in the dilated 2-simplex corresponding to a plane elliptic cubic .",
    "we keep the notation from section  [ ssec : known - results - about ] , and fix a defining equation @xmath207 for @xmath16 with prescribed valuations of coefficients inducing a tropical plane elliptic curve @xmath28 containing a cycle .",
    "we assume the cycle is shorter than expected . as we saw in section  [ ssec : known - results - about ] , this is caused by the cancellation of an initial form of the discriminant polynomial @xmath654 , when evaluated at the coefficients of @xmath207 .",
    "algorithm  [ alg : repairelliptic ] uses the vanishing of a local discriminant to repair the cycle .",
    "corollary  [ cor : initialdiscriminant ] explains the connection between these two facts through a factorization formula to describe initial forms of @xmath1-discriminants in terms of discriminants of an induced marked coherent subdivision of the convex hull of @xmath1 , i.e.the newton subdivision of @xmath207 .",
    "let us fix a full - dimensional point configuration @xmath1 in @xmath277 , and let @xmath961 be the convex hull of @xmath1 .",
    "given any subset @xmath962 of @xmath1 we denote by @xmath963 , respectively @xmath964 , the linear span of @xmath962 over @xmath287 , respectively over @xmath147 .",
    "in addition , we define the lattice index @xmath965.\\label{eq : latticeindex}\\ ] ] we write @xmath966 .",
    "we work with both discriminant cycles and principal determinants of the configuration @xmath1 as defined in  ( * ? ? ?",
    "* chapter 10 ) and discussed further in  @xcite . rather than defining the principal determinant",
    "@xmath967 $ ] and the corresponding cycle @xmath968 for a configuration @xmath969 on its own , we choose to present it in terms of the prime factorization formula from  ( * ? ? ?",
    "* theorem 1.2 , @xmath970  10.1.b ) adapted to the case when the condition @xmath971 is not required ( as in esterov  ( * ? ? ?",
    "* proposition 3.10 ) ) : @xmath972 here , @xmath973 denotes a marked proper face of the polytope @xmath961 and @xmath207 represents a bivariate laurent polynomial supported on @xmath1 . the lattice indices @xmath974 and @xmath975 are defined as in  . the exponents @xmath976 refer to the _ generalized subdiagram volume _ associated to @xmath18 and @xmath1 viewed in the ambient lattice @xmath277 .",
    "they are computed as follows .",
    "we fix the linear projection @xmath977 and let @xmath978 be the normalized volume form on @xmath979 .",
    "the normalization is performed with respect to the lattice @xmath980 , so that the fundamental domain @xmath981 has volume @xmath982 .",
    "we set @xmath983    [ rem : gkzvsesterov ] the positive integers @xmath984 are denoted by @xmath985 in  ( * ? ? ?",
    "* @xmath986 ) .",
    "when @xmath971 , the definition of @xmath984 from   agrees with the subdiagram volume form @xmath987 defined in  ( * ? ? ?",
    "* chapter 5 , theorem  2.8 ) . for arbitrary @xmath1",
    "we recover the latter by renormalizing the volume form in @xmath979 with respect to the lattice @xmath988 and replacing @xmath978 in   by this new volume form .",
    "the subdiagram volume forms @xmath984 from   and @xmath987 from  ( * ? ? ?",
    "* chapter 5 ) are related by the following identity over @xmath287 .",
    "[ lm : subdiagramvolidentities ] let @xmath969 be a full - dimensional point configuration and @xmath18 be a face of the polytope @xmath989 .",
    "then : @xmath990    since all vertices of @xmath961 lie in @xmath1 , we know that @xmath991 for every face @xmath18 of @xmath961 .",
    "the result follows from remark  [ rem : gkzvsesterov ] and the identity @xmath992.\\qedhere\\ ] ]    from now on , we fix a full - dimensional planar configuration @xmath993 with @xmath278 points .",
    "we pick a tuple @xmath994 giving a height for every point in @xmath1 .",
    "the tuple @xmath95 induces a marked subdivision @xmath995 of the marked pair @xmath996 . here",
    ", @xmath997 for all @xmath998 are the maximal cells in the subdivision @xmath292 .",
    "we aim to compute the initial form of @xmath288 with respect to @xmath95 .",
    "we let @xmath999 denote the set of edges of @xmath1000 for each @xmath1001 , and let @xmath1002 be the set of edges of @xmath961 .",
    "let @xmath1003 be the set of edges of @xmath1000 that lie entirely in the boundary of the polytope @xmath961 and set @xmath1004 to be the complementary set of internal edges in @xmath999 .",
    "for @xmath1005 we set @xmath1006 .",
    "the following result is reminiscent of the combinatorial formula from  ( * ? ? ?",
    "* theorem 4.1 ) . that computes initial forms of resultants as products of powers of smaller resultants .",
    "[ thm : factorizationformula ] let @xmath1 be a full - dimensional configuration in @xmath299 .",
    "then , @xmath1007}\\!\\!\\ !       \\prod_{\\substack{j\\in i\\\\e\\in          \\mathcal{e}^{\\operatorname{out}}_j}}\\!\\!\\!\\delta_{e\\cap a_j}^{i(e\\cap",
    "a_j )        ( u(e\\cap a_j , a_j)-u({\\mathbb{r}}\\cdot e\\cap a , a))/i(a ) }      \\!\\!\\!\\prod_{\\substack{j < l\\\\e\\in          \\mathcal{e}^{\\operatorname{int}}_{j ,",
    "l}\\!}}\\!\\!\\!\\delta_{e\\cap a_j}^{i(e\\cap        a_j )        ( u(e\\cap a_j , a_j)+u(e\\cap a_l , a_l))/i(a)}. \\label{eq : factorization}\\ ] ] all exponents are nonnegative integers , @xmath1008 is a laurent monomial and the constant @xmath1009 and can be computed as @xmath1010^{\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}\\cdot\\ !",
    "a}(q_j)}\\big(\\prod_{\\substack{e\\in\\mathcal{e}\\\\ \\dim(e\\cap q_j)=1 } } [ { \\mathbb{z}}{\\!\\cdot\\!}(e\\cap a ) , { \\mathbb{z}}{\\!\\cdot\\!}(e\\cap a_j)]^{u(e\\cap a , a)\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}^2\\cap { \\mathbb{r}}\\cdot e}(e\\cap q_j)/i(a)}\\big)^{-1},\\ ] ] where the volume forms are normalized with respect to the indicated lattices .    theorem  [ thm : factorizationformula ] is the main result in this section",
    ". we shall derive it by means of the following characterization from  ( * ? ? ? * chapter 10.1.e , theorem @xmath1011 ) of initial forms of principal determinants of full - dimensional configurations @xmath969 , adapted to the case when @xmath971 is not required .",
    "@xmath1012^{\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}^k}(q_j ) } e_{a_j}^{i(a_j)}.\\ ] ] here , @xmath1008 is a laurent monomial and the principal determinant @xmath1013 is evaluated at the restriction of @xmath207 to those monomials supported on @xmath1014 . combining   and the product formula   for each @xmath1014 ( @xmath1015 ) gives the identity @xmath1016^{\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}^k}(q_j ) } \\prod_{j\\in i}\\delta_{a_j}^{i(a_j)}\\\\      \\prod_{j\\in i}\\prod_{f_j\\prec q_j } \\delta_{f_j\\cap a_j}^{i(f_j\\cap        a_j , { \\mathbb{z}}^k)u(f_j\\cap a_j , a_j ) } ,    \\end{split}\\ ] ] where the product on the right - hand side runs over all proper faces @xmath1017 of @xmath1018",
    ".    we shall prove theorem  [ thm : factorizationformula ] by studying each initial form @xmath1019 on the left - hand side of   when @xmath1020 , one dimension at a time . by definition , we know that @xmath1021 whenever @xmath18 is a vertex of a polytope and @xmath1022 is its corresponding coefficient",
    ". thus , we can incorporate all these laurent monomials to @xmath1008 and assume that @xmath1020 and all faces @xmath18 and @xmath1017 in   are edges of @xmath961 and @xmath1018 , respectively .",
    "the following lemmas simplify the exposition .",
    "[ lm : valueedges ] let @xmath1023 be an edge of @xmath961",
    ". then @xmath1024^{\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}^2\\cap { \\mathbb{r}}\\cdot e}(e\\cap q_j ) } \\delta _ { e\\cap a_j}^{i(e \\cap a_j , { \\mathbb{z}}^2)},\\ ] ] where @xmath1025 is a laurent monomial with support contained in @xmath1026 .",
    "the result is an immediate consequence of   where we replace the starting configuration @xmath1 by @xmath1026 and the induced subdivision @xmath1027 by @xmath1028 .",
    "[ lm : exponents ] for every @xmath1015 and every @xmath1029 , the quantities @xmath1030 and @xmath1031 are integer multiples of @xmath974 .",
    "if @xmath1032 , then @xmath1033 also lies in @xmath1034 .",
    "a simple calculation shows that @xmath1035 $ ] for all @xmath1015 .",
    "our claim follows from lemma  [ lm : subdiagramvolidentities ]",
    ". indeed , if @xmath1036 , then @xmath1037 thus , @xmath1031 divides @xmath1030 over @xmath287 , and hence so does @xmath974 .    finally ,",
    "if @xmath1032 , then @xmath1038 for a unique edge @xmath18 of @xmath961 .",
    "notice that @xmath1039 .",
    "lemma  [ lm : subdiagramvolidentities ] implies that @xmath974 divides @xmath1040 over @xmath287 . since @xmath1041 $ ]",
    ", we conclude that @xmath1042 .    by combining lemma  [ lm : valueedges ] with expression",
    "we conclude that @xmath1043^{\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}^2\\cap { \\mathbb{r}}{\\!\\cdot\\!}e}(q_j\\cap f)u(e\\cap a , a ) }        \\delta_{e\\cap a_j}^{i(e\\cap a_j , { \\mathbb{z}}^2 ) u(e\\cap a , a)}\\\\        = \\pm \\,\\mu'\\,\\prod_{j\\in i}[{\\mathbb{z}}{\\!\\cdot\\!}a : { \\mathbb{z}}{\\!\\cdot\\!}a_j]^{\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}^2}(q_j ) } \\prod_{j\\in i}\\delta_{a_j}^{i(a_j ) }        \\prod_{j\\in i } \\prod_{e\\in \\mathcal{e}_j } \\delta_{e\\cap          a_j}^{i(e \\cap a_j , { \\mathbb{z}}^2 ) u(e\\cap a_j , a_j ) } ,      \\end{split}\\ ] ] where @xmath1044 is a laurent monomial .",
    "all polynomials in are irreducible over @xmath287 . rearranging the terms ,",
    "we obtain the desired factorization of @xmath1045 .",
    "this follows by analyzing the edges @xmath1036 .",
    "if @xmath1046 , then @xmath181 lies in the boundary of exactly one other polytope , say @xmath494 , so @xmath1047 and @xmath1048 .",
    "the polynomial @xmath1049 appears only on the right - hand side of   and its exponent equals @xmath1050 . on the contrary , if @xmath1032 , then @xmath1051 for any @xmath1052 . rearranging terms in  ,",
    "we conclude that the exponent of @xmath1049 in the factorization of @xmath1053 equals @xmath1054 . since @xmath1055 , this quantity is non - negative by .",
    "lemma  [ lm : exponents ] ensures that all exponents in   are non - negative integers divisible by @xmath974 . since all discriminants in   have content one , we know that the rational number @xmath1056^{\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}^2}(q_j ) } \\big ( \\prod_{\\substack{e\\in \\mathcal{e},j\\in i\\\\ \\dim(q_j\\cap e)=1 } }        \\!\\!\\![{\\mathbb{z}}{\\!\\cdot\\!}(e\\cap a ) : { \\mathbb{z}}{\\!\\cdot\\!}(e \\cap        a_j)]^{\\operatorname{\\operatorname{vol}}_{{\\mathbb{z}}^2\\cap { \\mathbb{r}}{\\!\\cdot\\!}e}(q_j\\cap f)u(e\\cap a , a)}\\big)^{-1}\\ ] ] is in fact an integer number and its @xmath974-th root also lies in @xmath287 .",
    "the latter is precisely the quantity @xmath1057 in the statement.this concludes our proof .",
    "theorem  [ thm : factorizationformula ] is particularly enlightening when @xmath1 defines a cubic equation @xmath207 , as in the case of plane elliptic cubics . as usual ,",
    "we write @xmath1058 for the coefficients of @xmath207 .",
    "[ cor : initialdiscriminant ] let @xmath207 be a cubic bivariate polynomial and let @xmath1 be the configuration of points that supports @xmath207 .",
    "let @xmath95 be the weight vector corresponding to the valuation of all coefficient of @xmath207 .",
    "let @xmath1059 be the maximal cells in the newton subdivision of @xmath207 .",
    "assume @xmath610 is a vertex of this subdivision .",
    "then @xmath1060 where @xmath1061 , @xmath1062 is a laurent monomial , and the product runs over all non - defective @xmath1014 s .",
    "the discriminant @xmath1063 is evaluated on the restriction of @xmath207 to those monomials supported on @xmath1014 .",
    "the result follows from theorem  [ thm : factorizationformula ] after the following observations .",
    "first , note that any pyramid is a defective configuration .",
    "all internal edges in the newton subdivision of @xmath207 have lattice length one , hence @xmath1064 for all @xmath1046 . finally , assume @xmath1032 is not a pyramid .",
    "an easy calculation shows that @xmath1065 because @xmath610 is an internal edge of @xmath207 .    as a consequence",
    ", we give an alternative elementary proof of theorem  [ thm : repairell ] .",
    "indeed , write @xmath654 for the discriminant of the elliptic cubic equation evaluated at the coefficients of @xmath207 .",
    "we view @xmath654 as an element of @xmath252 . by corollary  [ cor : initialdiscriminant ] , the initial form of @xmath654 factors as the product  .",
    "we write @xmath1066 for the restriction of @xmath207 to those monomials supported on @xmath1014 .",
    "notice that our first proof of theorem  [ thm : repairell ] relied on an iterative usage theorem  [ thm : redvertex ] , where both implications are needed .",
    "going back to theorem  [ thm : redvertex ] , we see that one implication , namely the one proved in lemma  [ lem : nodecontractioniflocallysmooth ] , relies on berkovich theory .",
    "the other , lemma  [ lm : vanishingdecontractsvertex ] , is purely combinatorial , but requires a vanishing local discriminant as input , in order to repair a problematic vertex . in our first proof , we have deduced the local vanishing discriminant again using arguments from berkovich theory , more precisely , corollaries [ cor : nonhomeocycle ] and [ cor : highmultanddiscrim ] . in the elliptic cubic case , we can guarantee the vanishing of the local discriminant by means of corollary  [ cor : initialdiscriminant ] , without relying on lemma  [ lem : nodecontractioniflocallysmooth ] .",
    "assume @xmath28 has a visible cycle but the @xmath0-invariant of @xmath207 does not have the expected valuation .",
    "then , @xmath610 is a vertex in the newton subdivision of @xmath207 and ( * ? ? ?",
    "* lemma 23 ) ensures that the expected initial form of @xmath654 vanishes at @xmath207 .",
    "we conclude that @xmath1067 for some @xmath1015 .",
    "in particular , @xmath1014 is non - defective so @xmath1018 can not be a pyramid .",
    "the cubic condition implies that @xmath1018 is a trapezoid of height 1 with a base of length 1 .",
    "the corresponding vertex @xmath193 dual to @xmath1014 lies in the cycle of @xmath28 and is locally reducible . using lemma  [ lm : expectedheights ] and the proof of lemma  [ lm : vanishingdecontractsvertex ] we can prolong the cycle of the tropical elliptic cubic by a linear re - embedding induced by a linear tropical modification of the ambient space .",
    "conversely , assume none of the local discriminants @xmath1063 vanish when evaluated at @xmath1066 .",
    "corollary  [ cor : initialdiscriminant ] ensures that @xmath654 has the expected initial form .",
    "we conclude that the @xmath0-invariant of @xmath207 has the expected valuation and so the cycle in the tropical elliptic cubic has the expected length .",
    "the polyhedral nature of tropical plane curves allows for many experimentations to devise algorithms to locally repair non - faithful tropicalizations by means of tropical modifications . in this section",
    "we provide three examples that shed light on some of the open questions discussed earlier in this paper . we view them as starting points for further investigations in this area .",
    "our first example extends the conclusion of theorem [ thm : redvertex ] to a local reducible vertex of valency 6 , which locally is the union of a tropical line with a reflected tropical line .",
    "[ ex : otherredvertex]consider the plane curve in @xmath335 with defining equation @xmath1068 the corresponding tropical plane curve is depicted in the left of figure  [ fig : projectionsspecialredvertex ] .",
    "the vertex @xmath1069 is locally reducible .",
    "one of its components is the tropical line @xmath1070 .",
    "we perform a linear tropical modification of @xmath8 along @xmath18 .",
    "we pick a lifting @xmath1071 determined by special choices of @xmath1072 with valuation 0 adapted to the curve @xmath28 .",
    "this modification produces six two - dimensional cones in @xmath20 , spanned by the rays of @xmath18 and @xmath1073 .",
    "we label them @xmath1074 as in figure  [ fig : specialredvertex ] .",
    "the cells @xmath1075 and @xmath1076 are the ones attached to the tropical line @xmath18 .",
    "for example , @xmath637 is defined by the system @xmath1077 and @xmath1078 , whereas @xmath1079 is determined by @xmath533 and @xmath1080 .",
    "as figure  [ fig : specialredvertex ] illustrates , we assign different colors to the intersection of @xmath30 with each cone @xmath48 for @xmath1081 .",
    "this helps us see the image of each piece under the three projections @xmath1082 and @xmath40 , given in the top row of figure  [ fig : projectionsspecialredvertex ] . from left to right , these projections are defined by the polynomials @xmath645 , @xmath1083 and @xmath1084 , respectively .",
    "we need all three projections in order to reconstruction @xmath30 . as in the proof of lemma  [ lem : modifviaprojections ] , the multiplicities on the edges of @xmath30 mapping to the tropical line defined by @xmath18 on each of the three projections are determined by the push - forward formula for multiplicities .",
    "( indicated with a dashed line ) , its lifting @xmath1085 and its effect on a given tropical plane curve . ]",
    "the choice of scalars @xmath1086 is done to emulate the conclusions of lemmas  [ lm : expectedheights ] and  [ lm : vanishingdecontractsvertex ] .",
    "we analyze the contribution of the terms @xmath1087 coming from all marked points in the the cell dual to @xmath193 , in all the monomials @xmath1088 of @xmath1089 , for @xmath1090 .",
    "we proceed analogously with the curve defined by @xmath1091 and see the contribution of @xmath1092 to the monomials @xmath1093 with @xmath1094 .",
    "the coefficients of these monomials have expected valuation 0 .",
    "our choice of @xmath1086 must be such that some of them have strictly positive valuation . to achieve this",
    ", we use the local discriminant @xmath1095 .",
    "an easy calculation shows that this local discriminant vanishes at @xmath261 , as in the situations covered in section  [ sec : repa - trop ] .",
    "therefore , we have a chance of having a non - faithful tropicalization locally around @xmath452 .",
    "indeed , by choosing @xmath1096 we see that this is the case : we manage to make the initial term of all monomials @xmath1088 ( @xmath1090 ) in @xmath1089 and @xmath1093 ( @xmath1097 ) in @xmath1091 drop together .",
    "these monomials are the red points in figure  [ fig : projectionsspecialredvertex ] . as a consequence , a bounded edge in @xmath30 with direction @xmath1073 maps to @xmath452 under the projection @xmath39 .",
    "we see this phenomenon in figure  [ fig : specialredvertex ] .     to the planes @xmath1098 , @xmath1099 and @xmath415-respectively .",
    "]     to the planes @xmath1098 , @xmath1099 and @xmath415-respectively . ]     to the planes @xmath1098 , @xmath1099 and @xmath415-respectively . ]     to the planes @xmath1098 , @xmath1099 and @xmath415-respectively .",
    "]     to the planes @xmath1098 , @xmath1099 and @xmath415-respectively . ]     to the planes @xmath1098 , @xmath1099 and @xmath415-respectively . ]",
    "a second natural question that arises from our results from section  [ sec : repa - trop ] is the following .",
    "consider a plane elliptic cubic with bad reduction defined by @xmath207 , but whose tropicalization @xmath28 contains no cycle .",
    "can we use linear tropical modifications to make this cycle appear via a special linear re - embedding ?",
    "if so , does this method generalize to other mumford curves ?",
    "a positive answer to this question would provide a combinatorial effective way to test if a plane curve is mumford .    as observed in remark  [ rem : unfoldingandtrivalentoutcome ] , theorem  [ thm : fatedge ] gives a positive answer to the above question when @xmath28 contains a bounded edge of multiplicity @xmath807 with non - vanishing discriminant ( as we saw in example  [ ex : unfoldingdoubleedge ] ) .",
    "our next example produces a cycle by modifying @xmath8 along a high - multiplicity end .",
    "[ ex : cyleappears ] we consider the smooth plane elliptic cubic @xmath16 with defining equation @xmath1100 its @xmath0-invariant has valuation @xmath1101 .",
    "the tropical curve @xmath28 is depicted in the top - right corner of figure  [ fig : makevisible ] .",
    "it contains no cycle and no bounded edge of high multiplicity .",
    "the induced newton subdivision of @xmath207 appears on the top - right of figure  [ fig : makevisible ] .",
    "the triangle containing @xmath610 in its interior is dual to the vertex @xmath452 of @xmath28 . since the discriminant @xmath1102 vanishes at @xmath621 , we know the tropicalization map may not be faithful locally around @xmath452 .",
    "indeed , using three consecutive linear tropical modifications we can find a linear re - embedding of @xmath16 where the curve @xmath951 in the bottom - left of figure  [ fig : skeletonmakecyclevisible ] contains a cycle of length @xmath1103 .",
    "the three projections used to reconstruct @xmath951 are described in figure  [ fig : makevisible ] , with the following convention .",
    "each cell @xmath1104 with @xmath1105 encodes the intersection of the cells @xmath1106 , @xmath1107 and @xmath1108 corresponding to each one of the three linear tropical modifications .",
    "the three tropical modifications are chosen as follows .",
    "first , we attempt to add a downward end @xmath181 of multiplicity 2 to the vertex @xmath452 in the cell @xmath469 .",
    "we do so by means of a modification along @xmath533 , picking a lifting function @xmath1109 with @xmath764 .",
    "our choice of @xmath1110 must be such that the discriminant of the attached edge @xmath181 vanishes when evaluated at @xmath1111 , to have a chance for the map @xmath180 to be non - faithful on @xmath181 . indeed ,",
    "if this were not the case , the end @xmath181 will be the image of two ends in @xmath166 by  ( * ? ? ?",
    "* proposition 4.24 ) and the procedure will not yield a bounded edge of higher multiplicity .",
    "we find @xmath1112 using the well - known quadratic formula @xmath1113 we choose @xmath1114 . as a result ,",
    "the newton subdivision of @xmath1115 contains a quadrilateral with @xmath610 as its unique interior point .",
    "this quadrilateral is dual to the vertex @xmath452 in @xmath925 . for this lifting @xmath802 ( and no other ) , both discriminants @xmath1102 and @xmath1116 vanish at @xmath1117 and @xmath1118 , respectively .",
    "the curve @xmath925 is depicted in the top - left of figure  [ fig : makevisible ] .    next , we aim to transform our horizontal multiplicity 2 end @xmath181 in @xmath925 into a bounded edge of multiplicity 2 , and use theorem  [ thm : fatedge ] to unfold it .",
    "we modify the @xmath415-plane along the horizontal line @xmath1119 , picking a new variable @xmath193 and a lifting @xmath1120 , with @xmath1121 .",
    "our choice of @xmath1122 is subject to the constraint that the coefficients of @xmath7 , @xmath107 and @xmath193 in @xmath1123 have higher valuation than expected .",
    "our choice of @xmath1110 imposed by condition   allows us to find the desired value for @xmath1124 . in this particular example",
    ", the value @xmath1125 satisfies all three requirements .",
    "its initial term is completely determined by the initial term of the constant coefficient of @xmath1091 , namely @xmath1126 .",
    "the tropical curve @xmath935 is depicted on the lower - right of figure  [ fig : makevisible ] .",
    "it contains a bounded , multiplicity 2 edge @xmath190 inside the line @xmath1127 .    in our final step ,",
    "we look at the discriminant associated to the edge @xmath190 . by construction",
    ", @xmath1128 does not vanish at @xmath1129 . even though the vertex @xmath452 has degree 4 in @xmath1091",
    ", we can mimic the proof of theorem  [ thm : fatedge ] to conclude that we can unfold @xmath190 via a tropical modification .",
    "indeed , the linear tropical modification along the line @xmath1127 with lifting @xmath1130 unfolds the edge @xmath190 and yields a faithful embedding on the visible cycle of @xmath1131 .",
    "the projection to the @xmath630-plane contains this cycle and is depicted in the bottom - left of figure  [ fig : makevisible ] .     and @xmath1132 , and the monomials affected by each coordinate change .",
    "]     repairs the tropical plane elliptic cubic by three linear tropical modifications of @xmath8 ( adding variables @xmath1133 , respectively ) . here , @xmath945 , @xmath1134 and @xmath1135 .",
    "we label the coordinates in @xmath953 by @xmath1136 .",
    "the color coding matches that of figure  [ fig : makevisible ] . ]",
    "it is worth noticing that no other choice of @xmath1137 in our lifting function @xmath802 for our first modification allows us to produce a bounded multiplicity 2 edge in the tropical curve @xmath925 with a second linear tropical modification .",
    "as we mentioned earlier , if we choose @xmath1138 , any subsequent linear tropical modification will split the multiplicity 2 end on the top - left of figure  [ fig : makevisible ] into two multiplicity 1 ends after shifting the endpoint @xmath452 in the southwest direction .    as we saw in the previous example ,",
    "linear tropical modifications can help us draw some conclusions about the tropicalization map  . in figure",
    "[ fig : skeletonmakecyclevisible ] , the extended skeleton @xmath1139 contains a subgraph homeomorphic to @xmath951 via the map @xmath180 .",
    "furthermore , the map @xmath180 is an isometry over the bounded part of @xmath951 .",
    "unfortunately , this procedure does not always yield a complete description of these skeleta .",
    "our last shows that linear tropical modifications may not suffice to unfold an end of a tropical plane elliptic cubic to produce a cycle .",
    "[ ex : unfoldimpossible ] we consider the plane elliptic cubic @xmath16 defined by the equation @xmath1140 this cubic satisfies @xmath1141 .",
    "as we can see from the right side of figure  [ fig : unfoldimpossible ] , the tropical curve @xmath28 contains no cycle and has no bounded edge of higher multiplicity .",
    "the triangle dual to the vertex @xmath452 has discriminant @xmath1142 , which vanishes at @xmath621 .",
    "likewise , the discriminant of the end @xmath181 adjacent to @xmath452 equal @xmath1143 and also vanishes at @xmath1144 .",
    "thus , @xmath359 has a unique component of multiplicity 2 . since the end @xmath181 has multiplicity two , ( * ? ? ?",
    "* proposition 4.24 ) and   imply that the fiber of @xmath180 over a generic point in @xmath181 has either size 2 ( with relative multiplicities @xmath7 ) or size 1 ( with relative multiplicity 2 ) .",
    "we attempt to unfold the edge @xmath181 by a linear tropical modification along the vertical line @xmath533 .",
    "we want the coefficient @xmath676 to have strictly positive valuation .",
    "therefore , our lifting function @xmath1145 must satisfy @xmath363 and @xmath1146 for @xmath545 .",
    "there is a unique choice for such @xmath403 , namely @xmath1147 .",
    "unfortunately , the coefficient @xmath1148 also has strictly positive valuation and the method fails to produce a bounded weight two edge , as we see on the left of figure  [ fig : unfoldimpossible ] .     and @xmath53 , respectively .",
    "the coefficients @xmath1149 on the rightmost polytope give the unknowns in the @xmath1-discriminant of the interior triangle . ]     and @xmath53 , respectively .",
    "the coefficients @xmath1149 on the rightmost polytope give the unknowns in the @xmath1-discriminant of the interior triangle . ]",
    "we wish to thank erwan brugall , arne buchholz , ilia itenberg , diane maclagan , thomas markwig , ralph morrison , bernd sturmfels , till wagner and annette werner for very fruitful conversations .",
    "all the computations in this paper were done using the ` tropical.lib ` library for ` singular `  @xcite .",
    "the first author was supported by an alexander von humboldt postdoctoral research fellowship ( germany ) and by an nsf postdoctoral fellowship dms-1103857 ( usa ) .",
    "the second author was supported by dfg - grant 4797/5 - 1 and by gif - grant 1174 - 197.6/2011 .",
    "part of this project was carried out during the 2013 program on _ tropical geometry and topology _ at the max - planck institut fr mathematik in bonn , where the second author was in residence .",
    "we thank mpi for their hospitality .",
    "m.  baker , s.  payne , and j.  rabinoff . on the structure of non - archimedean analytic curves . in _ tropical and non - archimedean geometry _ ,",
    "volume 605 of _ contemp .",
    "_ , pages 93121 .",
    "ams , providence , ri , 2013 ."
  ],
  "abstract_text": [
    "<S> tropical geometry is sensitive to embeddings of algebraic varieties inside toric varieties . </S>",
    "<S> the purpose of this paper is to advertise tropical modifications as a tool to locally repair bad embeddings of plane curves , allowing the re - embedded tropical curve to better reflect the geometry of the input curve . </S>",
    "<S> our approach is based on the close connection between analytic curves ( in the sense of berkovich ) and tropical curves . </S>",
    "<S> we investigate the effect of these tropical modifications on the tropicalization map defined on the analytification of the given curve .    </S>",
    "<S> our study is motivated by the case of plane elliptic cubics , where good embeddings are characterized in terms of the @xmath0-invariant . </S>",
    "<S> given a plane elliptic cubic whose tropicalization contains a cycle , we present an effective algorithm , based on non - archimedean methods , to linearly re - embed the curve in dimension 4 so that its tropicalization reflects the @xmath0-invariant . </S>",
    "<S> we give an alternative elementary proof of this result by interpreting the initial terms of the @xmath1-discriminant of the defining equation as a local discriminant in the newton subdivision . </S>"
  ]
}